*%! Codigo adicional para archivo LDCBMARC
*% IF FIN_PUT_CLF_ARC
      *<<<< FIN_PUT_CLF_ARC
           IF CLF-COD-AOCF IN ARC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN ARC-FLD TO
                                        WSS-COD-TOPE IN WSS-VARI
               MOVE CLF-COD-AOCF IN ARC-FLD TO
                                        WSS-COD-AOPE IN WSS-VARI
               MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOCF IN ARC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOCF IN ARC-FLD.
      *>>>>
*% END
*% IF LDC_NUM_ILDC
      *<<<< LDC_NUM_ILDC
           IF LDC-NUM-ILDC IN ARC-FLD NOT > ZEROES AND
              SCR-CMND = 'ACT'
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'LDC    BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-NUM-ILDC.
      *>>>>
*% END
*% IF FIN_DBC_VRF_ICLI
      *<<<< FIN_DBC_VRF_ICLI
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN ARC-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN ARC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *>>>>
*% END
*% IF FIN_DBC_IND_ICLI
      *<<<< FIN_DBC_IND_ICLI
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN ARC-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN ARC-FLD.
      *>>>>
*% END
*% IF INI_VAL_FLD_ARC
      *<<<< INI_VAL_FLD_ARC
      *FLB CST   13-DEC-1993
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-OCAI
           ELSE
               MOVE 'N' TO WSS-VSN-OCAI.

      *FLB CST  6-OCT-1994 TRASLADADO AQUI
      *SMC-INI 26-10-1993 LEE TABLA VSN PARA DETERMINAR SI SE
      *                   USO DE FUNCIONALIDADES DE CTE, CEX
      *                   LEA, TCR.
      * BUSCA REGISTRO CTE.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE 'LDCCTE      '       TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VCTE IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VCTE IN WSS-VARI.

      * BUSCA REGISTRO CEX.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE 'LDCCEX      '       TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VCEX IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VCEX IN WSS-VARI.

      * BUSCA REGISTRO LEA.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'LDCLEA      '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VLEA IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VLEA IN WSS-VARI.

      * BUSCA REGISTRO TCR.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'LDCTCR      '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VTCR IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VTCR IN WSS-VARI.

      *SMC-FIN 26-10-1993

      * ASIGNA O NO EL NUMERO DE CREDITO
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'ASIGNAOPC   '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-AOPC IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-AOPC IN WSS-VARI.

      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               MOVE 'N' TO TLC-VSN-TIPO IN TLC-VARI
           ELSE
               MOVE 'S' TO TLC-VSN-TIPO IN TLC-VARI
      *FLB CST  24-NOV-1994
               MOVE LDC-CAI-ICLF IN ARC-FLD TO LDC-CAI-ICLF IN LDC
               MOVE LDC-IIC-ICLF IN ARC-FLD TO LDC-IIC-ICLF IN LDC
               MOVE LDC-NUM-ILDC IN ARC-FLD TO LDC-NUM-ILDC IN LDC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM LDC-FIO-LDC
               IF NOT FIO-STAT-OKS
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'DATERR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FLD-ARC
               ELSE
                   MOVE 'DEU' TO TAB-COD-SIST
                   MOVE 'TLC'               TO TAB-COD-TTAB IN TAB
                   MOVE LDC-COD-TIPO IN LDC TO TAB-COD-CTAB IN TAB
                   PERFORM VAL-COD
                   IF MSG-COD-MENS = 'COD    NEX' OR
                      LDC-COD-TIPO IN LDC NOT > SPACES
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'LDCTIPBLK' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FLD-ARC
                   ELSE
                       MOVE TAB-CIC-CTAB IN TAB TO
                            TLC-CIC-LDIS IN TLC-VARI.

      *FLB CST  17-OCT-1994
      * Permite o no TIO sin AUX
           MOVE 'DEU'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE  'TIO+AUX OBL '      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-AXOB IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-AXOB IN WSS-VARI.

      *FLB CST  24-NOV-1994 MODIFICADO POR LINEA LIBRE DISPONIBILIDAD
           MOVE 'N' TO WSS-EXI-ARC.
      *FLB CST  6-OCT-1994
           PERFORM VAL-FLD-IDX
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > WSS-IMAX
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                GO TO FIN-VAL-FLD-ARC.

      *FLB CST  24-NOV-1994 MODIFICADO POR LINEA LIBRE DISPONIBILIDAD
           IF WSS-EXI-ARC = 'N' AND
              TLC-CIC-LDIS IN TLC-VARI NOT = 'LIBRE'
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'LDCNOARC'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(1)
               GO TO FIN-VAL-FLD-ARC.

           GO TO FIN-VAL-FLD-ARC.
      *>>>>
*% END
*% IF FRM_COD_VCOC
      *<<<< FRM_COD_VCOC
           IF FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(FRM-IFLD)
               GO TO FIN-VAL-FRM-COD-VCOC.
      *VAL-COD Valida Cod. Moneda de Tabla
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) TO
                                       TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(FRM-IFLD)
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                              FRM-GLS-VCOC IN ARC-FLD(FRM-IFLD).
      *>>>>
*% END
*% IF FRM_COD_TOOC
      *<<<< FRM_COD_TOOC
           IF FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(FRM-IFLD)
      *FLB CST  6-OCT-1994
               MOVE SPACES TO WSS-CIC-TOOC
               GO TO FIN-VAL-FRM-COD-TOOC.
      *VAL-COD Valida Cod. Tipo de Operacion de Tabla
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) TO
                                       TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *FLB CST  10-OCT-1994 Modificado por Codificacion Tipo de Linea
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(FRM-IFLD)
               GO TO FIN-VAL-FRM-COD-TOOC.

           MOVE TAB-GLS-ABRV IN TAB TO
                              FRM-GLS-TOOC IN ARC-FLD(FRM-IFLD).
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOOC.
           IF ( TAB-CIC-CTAB IN TAB = 'CGE' )
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CODTIOINVL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-TOOC.

           MOVE TAB TO TIO.
           IF NOT ( ( USA-CEX AND TIO-GLS-SIST IN TIO = 'CEX' )
                 OR ( USA-CTE AND TIO-GLS-SIST IN TIO = 'CTE' )
                 OR ( USA-LEA AND TIO-GLS-SIST IN TIO = 'LEA' )
                 OR ( USA-TCR AND TIO-GLS-SIST IN TIO = 'TCR' )
                 OR ( TIO-GLS-SIST IN TIO = 'COL' ) )

               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-TOOC.

      *>>>>
*% END
*% IF FRM_COD_AOOC
      *<<<< FRM_COD_AOOC
           IF FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(FRM-IFLD)
               GO TO FIN-VAL-FRM-COD-AOOC.

      *SMC-INI 22-11-1993

      * VALIDA C. AUX CONTRA COL/AUX, CUANDO TIPO DE OPERACION SEA
      * DE 'COL' ( TIO-GLS-SIST = 'COL') SI NO CONTRA TAB/AUX.

           IF TIO-GLS-SIST IN TIO = 'COL'
              MOVE 'COL'               TO TAB-COD-SIST
              MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) TO
                                          WSS-COD-TOPE IN WSS-VARI
              MOVE FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) TO
                                          WSS-COD-AOPE IN WSS-VARI
              MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
           ELSE
      *VAL-COD Valida Cod. Auxiliar de Operacion de Tabla TAB/AUX
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) TO
                                          WSS-COD-TOPE IN WSS-VARI
              MOVE FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) TO
                                          WSS-COD-AOPE IN WSS-VARI
              MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.

      *SMC-FIN 22-11-1993

           PERFORM VAL-COD.
      *FLB CST  10-OCT-1994 Modificado por Codificacion Tipo de Linea
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(FRM-IFLD)
               GO TO FIN-VAL-FRM-COD-AOOC.

           MOVE TAB-GLS-ABRV IN TAB TO
                              FRM-GLS-AOOC IN ARC-FLD(FRM-IFLD).

      *>>>>
*% END
*% IF FRM_CAI_IOPC
      *<<< FRM_CAI_IOPC
      *FLB CST  6-OCT-1994 PARA CTA CTE PUEDE ESTAR LLENA LA CLAVE
           IF WSS-CIC-TOOC = 'CTE' AND USA-CTE
               GO TO FIN-VAL-FRM-CAI-IOPC.

      * PARA NO CTA CTE NO DEBE ESTAR LLENO EL NRO CREDITO
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
              ( FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES
              )
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'IICIOPC>0'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-CAI-IOPC.

      *FLB CST  26-OCT-1993
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES AND
              WSS-VSN-OCAI = 'S'
               MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO
                    CIC-CAI-ICIC IN CIC
               IF NOT ( CIC-COD-TCIC IN CIC = 'C' OR
                        CIC-COD-TCIC IN CIC = 'D' )
                   MOVE 'TAB'    TO MSG-COD-SIST
                   MOVE 'CAIINV' TO MSG-COD-TMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-CAI-IOPC
               ELSE
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-CIC
                   IF NOT FIO-STAT-OKS
                       MOVE 'GNS' TO MSG-COD-SIST
                       MOVE 'CICSTAT' TO MSG-COD-TMSG
                       MOVE CIC-STAT-NEX TO MSG-COD-CMSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FRM-CAI-IOPC.
      *>>>>
*% END
*% IF FRM_IIC_IOPC
      *<<< FRM_IIC_IOPC

      *     IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
      *        FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES
      *         PERFORM ERR-GLS
      *         GO TO FIN-VAL-FRM-IIC-IOPC.

           IF NOT (
              FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES
                  )
               GO TO FIN-VAL-FRM-IIC-IOPC.

           PERFORM VAL-CON-ARC.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-FRM-IIC-IOPC.

           PERFORM VAL-ARC-IGUA VARYING WSS-IFLD FROM 1 BY 1
                      UNTIL WSS-IFLD > WSS-IMAX OR
                            MSG-COD-MENS > SPACES.

           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'   TO MSG-COD-SIST
               MOVE 'ARC=S' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-IIC-IOPC.

      * ASIGNA NRO CREDITO
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES
      *FLB CST  6-OCT-1994
                  AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR
                NOT USA-CTE
              )
      *FLB CST  6-OCT-1994
               MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO
                    CIC-CAI-ICIC IN CIC
               PERFORM PRO-CIC-OPC
               PERFORM LEE-QUE
      * ISP-INI 16-07-1998 ERROR AL MANIPULAR 9 ARC GRAFICAS
               IF QUE-STAT = QUE-STAT-OKS
      * ISP-FIN 16-07-1998 ERROR AL MANIPULAR 9 ARC GRAFICAS
               MOVE 'A' TO QUE-ARC-IND-IOPC
                                     IN QUE-ARC-VARI(FRM-IFLD)
               MOVE FRM-CAI-IOPC     IN ARC-FLD(FRM-IFLD) TO
                    QUE-ARC-CAI-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE FRM-IIC-IOPC     IN ARC-FLD(FRM-IFLD) TO
                    QUE-ARC-IIC-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE QUE-ARC-VARI TO QUE-ITEM
               IF QUE-STAT NOT = QUE-STAT-OKS
                   MOVE QUE-PUT TO QUE-CMND
                   PERFORM GNS-PRO-QUE
                   GO TO FIN-VAL-FRM-IIC-IOPC
               ELSE
                   MOVE QUE-MOD TO QUE-CMND
                   PERFORM GNS-PRO-QUE
                   GO TO FIN-VAL-FRM-IIC-IOPC.

      * DIGITA NRO CREDITO O CAMBIO EL NUMERO ASIGNADO
           PERFORM LEE-QUE.

      * ISP-INI 16-07-1998 ERROR AL MANIPULAR 9 ARC GRAFICAS
               IF QUE-STAT = QUE-STAT-OKS
      * ISP-FIN 16-07-1998 ERROR AL MANIPULAR 9 ARC GRAFICAS
           IF QUE-ARC-IND-IOPC IN QUE-ARC-VARI(FRM-IFLD) NOT = 'A' AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES OR
              ( FRM-CAI-IOPC     IN ARC-FLD(FRM-IFLD) NOT =
                QUE-ARC-CAI-IOPC IN QUE-ARC-VARI(FRM-IFLD) OR
                FRM-IIC-IOPC     IN ARC-FLD(FRM-IFLD) NOT =
                QUE-ARC-IIC-IOPC IN QUE-ARC-VARI(FRM-IFLD)
              )
               MOVE 'D' TO QUE-ARC-IND-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE FRM-CAI-IOPC     IN ARC-FLD(FRM-IFLD) TO
                    QUE-ARC-CAI-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE FRM-IIC-IOPC     IN ARC-FLD(FRM-IFLD) TO
                    QUE-ARC-IIC-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE QUE-ARC-VARI TO QUE-ITEM
               MOVE QUE-MOD TO QUE-CMND
               PERFORM GNS-PRO-QUE.

      * VALIDA QUE NRO CREDITO DIGITADO (NO PARA ASIGNADO) EXISTA Y ESTE
      * VIGENTE
      *AMP-INI   3-NOV-1993
           MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO
                CIC-CAI-ICIC IN CIC.
      *AMP-FIN   3-NOV-1993
           IF QUE-ARC-IND-IOPC IN QUE-ARC-VARI(FRM-IFLD) = 'D' AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES
      *FLB CST  6-OCT-1994
      *AMP-INI   3-NOV-1993
      *       AND ( CIC-COD-TCIC IN CIC = 'C' OR 'D' )
              AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR NOT USA-CTE )
      *AMP-FIN   3-NOV-1993
               MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO
                    OPC-CAI-IOPC IN OPC
               MOVE FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) TO
                    OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPC    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPC
               ELSE
               IF OPC-VAL-SCRE IN OPC NOT > ZEROES
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPC    YACAN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPC
               ELSE
                   GO TO FIN-VAL-FRM-IIC-IOPC.

      *FIN IAS

      *AMP-INI  9-OCT-1993
      * VALIDA LA CTA-CTE
      *FLB CST  6-OCT-1994
      *     IF ( FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
            IF ( FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
      *SMC-INI 26-10-1993
                WSS-CIC-TOOC = 'CTE' AND USA-CTE )
      *SMC-FIN 26-10-1993
               PERFORM BUSCO-CTA-CTE
               IF WSS-CTA-CTE > ZEROES
                   IF NOT ( RCO-COD-TOPR IN RCO =
                            FRM-COD-TOOC IN ARC-FLD (FRM-IFLD) AND
                            RCO-COD-AOPR IN RCO =
                            FRM-COD-AOOC IN ARC-FLD (FRM-IFLD) )
                       MOVE 'TIORCO<>ARC' TO MSG-COD-MENS
                   ELSE
                       MOVE 'TAB' TO TAB-COD-SIST
                       MOVE 'TIO' TO TAB-COD-TTAB IN TAB
                       MOVE RCO-COD-TOPR IN RCO TO
                            TAB-COD-CTAB IN TAB
                       PERFORM BUS-TAB
                       MOVE TAB TO TIO
                       IF TIO-GLS-SIST IN TIO NOT = 'CTE'
                           MOVE 'CICTIOPNOSIS' TO MSG-COD-MENS
                       ELSE
                           PERFORM VAL-CTA-CTE
                           IF CTE-STAT-OKS
                               IF ( OPE-COD-VCOP IN OPE NOT =
                                  FRM-COD-VCOC IN ARC-FLD (FRM-IFLD) )
                                   MOVE 'TIORCO<>ARC' TO MSG-COD-MENS
                               ELSE
                                   NEXT SENTENCE
                           ELSE
                               IF MSG-COD-MENS > SPACES
                                   NEXT SENTENCE
                               ELSE
                                   MOVE 'IFBCPFAIL' TO MSG-COD-MENS
               ELSE
                   MOVE 'RCO    NEX' TO MSG-COD-MENS
           ELSE
               NEXT SENTENCE.
      *SMC-FIN 26-10-1993 INDENTADO OK POR FLB  6-OCT-1994
           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'         TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-IIC-IOPC.
      *>>>>
*% END
*% IF VAL_CON_ARC
      *<<<< VAL_CON_ARC
      *FLB CST  6-OCT-1994 REVISADA TODA LA SECCION
      * PARA NO CTA CTE NO DEBE ESTAR LLENO EL NRO CREDITO
           IF FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
              ( FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES
              ) AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR
                NOT USA-CTE
              )
               MOVE 'IICIOPC>0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-ARC.

           IF FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES
               GO TO FIN-VAL-CON-ARC.

      * FALTA IIC
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES AND
              ( WSS-VSN-AOPC NOT = 'S' OR WSS-CIC-TOOC = 'CTE' AND
                USA-CTE )
*% IF PGM_PER
      *<<<< PGM_PER
                  OR
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES
              AND FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) = 'CTE'
              AND FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) = 'ORD'
      *>>>>
*% END
               PERFORM ERR-GLS
               GO TO FIN-VAL-CON-ARC.

      * OTORGARA EL IIC
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES AND
              WSS-VSN-AOPC = 'S'
*% IF PGM_PER
      *<<<< PGM_PER
                  OR
      * ESTA LLENO EL IIC
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) = 'CTE' AND
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) = 'ORD'
      *>>>>
*% END
               GO TO FIN-VAL-CON-ARC.

      *FLB CST  6-OCT-1994 PARECE REDUNDANTE
           IF FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) = SPACES AND
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) = SPACES AND
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) = SPACES
               GO TO FIN-VAL-CON-ARC.

           IF FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) > SPACES
               GO TO FIN-VAL-CON-ARC.

           IF FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES
               MOVE 'ERRCONARC'  TO MSG-COD-MENS
               MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(FRM-IFLD)
               MOVE 'S' TO FRM-UCUR
               GO TO ERR-VAL-CON-ARC.

      *FLB CST  17-OCT-1994
      *    IF FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES
           IF FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES AND
              WSS-VSN-AXOB NOT = 'S'
               GO TO FIN-VAL-CON-ARC.

           MOVE 'ERRCONARC'  TO MSG-COD-MENS.
           MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(FRM-IFLD).
           MOVE 'S' TO FRM-UCUR.
       ERR-VAL-CON-ARC.
           MOVE 'DEU'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF EOF_BU OR PGM_VMS
      *<<<< EOF_BU OR PGM_VMS

       VAL-FLD-IDX SECTION.
       INI-VAL-FLD-IDX.
           PERFORM VAL-FRM-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.
           PERFORM VAL-FRM-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-COD-TOOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.
           PERFORM VAL-FRM-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-COD-AOOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.
           PERFORM VAL-FRM-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-CAI-IOPC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.
           PERFORM VAL-FRM-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.

           PERFORM VAL-CON-ARC-LDC.
       FIN-VAL-FLD-IDX.
           EXIT.

      * INI IAS

       PRO-CIC-OPC SECTION.
       INI-PRO-CIC-OPC.

           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PRO-CIC-OPC
           ELSE
              MOVE CIC-CAI-ICIC TO OPC-CAI-IOPC IN OPC
              MOVE CIC-IIC-ICIC TO OPC-IIC-IOPC IN OPC
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-OPC
              IF FIO-STAT-OKS
                  GO TO INI-PRO-CIC-OPC
              ELSE
                  MOVE CIC-CAI-ICIC TO FRM-CAI-IOPC
                                         IN ARC-FLD(FRM-IFLD)
                  MOVE CIC-IIC-ICIC TO FRM-IIC-IOPC
                                         IN ARC-FLD(FRM-IFLD).
       FIN-PRO-CIC-OPC.
           EXIT.

      *FIN IAS
      *AMP-INI  9-OCT-1993
       BUSCO-CTA-CTE SECTION.
       INI-BUSCO-CTA-CTE.
           MOVE ZEROES TO WSS-CTA-CTE.
           MOVE LDC-CAI-ICLF IN ARC-FLD TO RDC-CAI-ICLF IN RDC.
           MOVE LDC-IIC-ICLF IN ARC-FLD TO RDC-IIC-ICLF IN RDC.
           MOVE SPACES                  TO RDC-CIC-ICLI IN RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              LDC-CAI-ICLF IN ARC-FLD = RDC-CAI-ICLF IN RDC AND
              LDC-IIC-ICLF IN ARC-FLD = RDC-IIC-ICLF IN RDC )
               MOVE 'RDC    NEX' TO MSG-COD-MENS
               GO TO FIN-BUSCO-CTA-CTE.
       LUP-BUSCO-CTA-CTE.
           MOVE RDC-CIC-ICLI IN RDC     TO RCO-CIC-ICLI IN RCO.
           MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO
                RCO-CAI-IOPE IN RCO.
           MOVE FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) TO
                RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'RCO    NEX' TO MSG-COD-MENS
               GO TO NXT-BUSCO-CTA-CTE
           ELSE
               IF RCO-COD-STAT IN RCO NOT = 'VIG'
                   MOVE 'RCO    NEX' TO MSG-COD-MENS
                   GO TO NXT-BUSCO-CTA-CTE
               ELSE
                   MOVE 99 TO WSS-CTA-CTE.
           IF WSS-CTA-CTE > ZEROES
               GO TO FIN-BUSCO-CTA-CTE.
       NXT-BUSCO-CTA-CTE.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF ( FIO-STAT-OKS AND
              LDC-CAI-ICLF IN ARC-FLD = RDC-CAI-ICLF IN RDC AND
              LDC-IIC-ICLF IN ARC-FLD = RDC-IIC-ICLF IN RDC )
                   GO TO LUP-BUSCO-CTA-CTE.
       FIN-BUSCO-CTA-CTE.
           EXIT.

       VAL-CTA-CTE SECTION.
       INI-VAL-CTA-CTE.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS
              NEXT SENTENCE
           ELSE
              MOVE 'OSCTOPEINEX'    TO MSG-COD-MENS
              GO TO FIN-VAL-CTA-CTE.

           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'VLR '               TO TAB-COD-TTAB IN TAB.
           MOVE  OPE-COD-VCOP IN OPE TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              NEXT SENTENCE
           ELSE
              MOVE 'OSCVLRINEX'      TO MSG-COD-MENS
              GO TO FIN-VAL-CTA-CTE.

           MOVE TAB-EXT-CTAB IN TAB TO CTE-MONE.
           MOVE 'READ'              TO CTE-TOPE.
           MOVE RCO-CIC-IOPE IN RCO TO CTE-NCTA.

           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'AUX '               TO TAB-COD-TTAB IN TAB.
           MOVE  RCO-COD-COPR IN RCO TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              NEXT SENTENCE
           ELSE
              MOVE 'OSCAUXINEX'      TO MSG-COD-MENS
              GO TO FIN-VAL-CTA-CTE.

           MOVE TAB-EXT-CTAB IN TAB TO CTE-TAUX.

*% IF PGM_PER
      *SMC-INI 25-10-1993
      *<<<< PGM_PER
           MOVE 'BCCRTP01' TO SYS-PROG
      *>>>>
*% ELSE
      *<<<< NOT PGM_PER
           MOVE 'LDCPSCTE' TO SYS-PROG
      *>>>>
*% END
           MOVE CTE-CMMA   TO SYS-CMMA.
           MOVE CTE-TCMA   TO SYS-TCMA.
           MOVE SYS-LINK   TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA TO CTE-CMMA.
       FIN-VAL-CTA-CTE.
           EXIT.
      *AMP-FIN  9-OCT-1993

      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
       VAL-CON-ARC-LDC SECTION.
       INI-VAL-CON-ARC-LDC.
      * ISP-INI 16-07-1998 ERROR AL MANIPULAR 9 ARC GRAFICAS
           IF NOT ( FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                    FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                    FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                    FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES OR
                    FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES )
               GO TO NO-LDC-TIPO.
      * ISP-FIN 16-07-1998 ERROR AL MANIPULAR 9 ARC GRAFICAS
           PERFORM LEE-QUE.
      * ISP-INI 16-07-1998 ERROR AL MANIPULAR 9 ARC GRAFICAS
               IF QUE-STAT = QUE-STAT-OKS
      * ISP-FIN 16-07-1998 ERROR AL MANIPULAR 9 ARC GRAFICAS
           IF TLC-VSN-TIPO IN TLC-VARI NOT = 'S' OR
              NOT (
              FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES
                  ) OR
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES AND
              WSS-VSN-AOPC = 'S' AND
              QUE-ARC-IND-IOPC IN QUE-ARC-VARI(FRM-IFLD) = 'A'
               GO TO NO-LDC-TIPO.

      *VALIDA ARC EN FAMILIA
      *FLB CST  24-NOV-1994 LINEA DE LIBRE DISPONIBILIDAD
           IF ( FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES )
                  AND
              TLC-CIC-LDIS IN TLC-VARI = 'LIBRE'
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'LDCEXIARC'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(FRM-IFLD)
               GO TO FIN-VAL-CON-ARC-LDC.

           IF ( FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES )
               MOVE 'S' TO WSS-EXI-ARC.
      *FLB CST  24-NOV-1994 LINEA DE LIBRE DISPONIBILIDAD

           MOVE LDC-COD-TIPO IN ARC-FLD           TO TLC-CODG.
           MOVE FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) TO TLC-TOOC.
           MOVE FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) TO TLC-AOOC.

           IF FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
              TLC-TOOC NOT > SPACES
               MOVE OPC-COD-TOOC IN OPC TO TLC-TOOC
               MOVE OPC-COD-AOOC IN OPC TO TLC-AOOC.

           PERFORM LDC-VAL-TLC.
           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'          TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               IF FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
                  TLC-TOOC NOT > SPACES
                   MOVE -1 TO FRM-CAI-IOPC-LEN IN ARC-FLD(FRM-IFLD)
                   GO TO FIN-VAL-CON-ARC-LDC
               ELSE
               IF FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) > SPACES
                   MOVE -1 TO FRM-COD-AOOC-LEN IN ARC-FLD(FRM-IFLD)
                   GO TO FIN-VAL-CON-ARC-LDC
               ELSE
                   MOVE -1 TO FRM-COD-TOOC-LEN IN ARC-FLD(FRM-IFLD)
                   GO TO FIN-VAL-CON-ARC-LDC.

       NO-LDC-TIPO.
       FIN-VAL-CON-ARC-LDC.
           EXIT.
      *>>>>
*% END
