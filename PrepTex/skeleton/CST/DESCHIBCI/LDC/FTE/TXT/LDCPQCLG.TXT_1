*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% PGM_STAT_CLF = TRUE
*% IF CMT_ID
      *<<<<
      *XON-INI 02-JUN-2008                                              
      *        modifica filtro para que muestre ultima clf 'A' o 'R'.   
      *XON-FIN 02-JUN-2008                                              
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY LDCBRRDC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.        
       COPY SGCBRDBC.                                                   
       COPY SGCBRREC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.        
       COPY BGLBRGDD.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.        
       COPY BGLBRGDG.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.        
       COPY BGLBRGVT.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.        
       COPY BGLBRTAG.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.        
       COPY GNSWGCPT.                                                   
       COPY GNSWGSTR.                                                   
       COPY LDCWXCLG.                                                   
       COPY LDCWGMPC.                                                   
       COPY LDCBRSLC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SLC-REQA==.        
       COPY LDCWGCCU.                                                   
       COPY TABWGTVC.                                                   
       COPY TABBRCAM.                                                   
      * GVI-INI mod. MEC 30-OCT-2006                                    
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITK-REQA==.        
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTK-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RTK-REQA==.        
      * GVI-FIN                                                         
*% IF NOT PGM_MCP AND NOT PGM_PTC
       COPY GNSWGQUE.
*% END
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.        
      *>>>>
       01  CLG-VARI.                                                    
      *XON-INI 02-JUN-2008                                              
           03  WSS-IND-RENO         VALUE SPACES       PIC X(001).      
           03  WSS-IND-ING          VALUE SPACES       PIC X(001).      
           03  WSS-IND-ACT          VALUE SPACES       PIC X(001).      
           03  WSS-IND-CER          VALUE SPACES       PIC X(001).      
           03  WSS-IND-VRF          VALUE SPACES       PIC X(001).      
           03  WSS-GLS-CLFR         VALUE SPACES       PIC X(183).      
           03  WSS-GLS-CLFI         VALUE SPACES       PIC X(183).      
           03  WSS-GLS-CLFC         VALUE SPACES       PIC X(183).      
           03  WSS-GLS-CLFV         VALUE SPACES       PIC X(183).      
      *XON-FIN 02-JUN-2008                                              
      *MHM-INI 02-OCT-2008                                              
           03  WSS-IND-CLNA         VALUE SPACES       PIC X(01).       
           03  WSS-GLS-NOMC.                                            
               05 WSS-GLS-NOM1      VALUE SPACES       PIC X(57).       
               05 WSS-GLS-NOM2      VALUE SPACES       PIC X(03).       
      *MHM-FIN 02-OCT-2008                                              
      *MHM-INI 07-OCT-2008                                              
           03  WSS-IND-LEN0         VALUE SPACES       PIC X(01).       
      *MHM-FIN 07-OCT-2008                                              
      *AFRI-INI/OCT-2006                                                
           03  WSS-CLI.                                                 
               05  WSS-ETIQ                            PIC X(03).       
               05  WSS-NOMB                            PIC X(60).       
      *AFRI-FIN/OCT-2006                                                
      *AFRI-INI/MAYO-2007 (MAE - ALD)                                   
          03  WSS-IND-SGLB     VALUE SPACES             PIC X(01).      
          03  WSS-IND-SOCU     VALUE SPACES             PIC X(01).      
      *AFRI-FIN/MAYO-2007 (MAE - ALD)                                   
           03 WSS-NUM-CCUR.                                             
              05 WSS-NUM-ICUR-EDT                      PIC   ZZ9.       
              05 WSS-NUM-ICUR-ALF                      PIC X(03).       
              05 WSS-NUM-ICUR      REDEFINES                            
                 WSS-NUM-ICUR-ALF                      PIC 9(03).       
           03  WSS-MONE.                                                
               05  WSS-COD-UEFES VALUE SPACES          PIC X(06).       
               05  WSS-SGV-UEFES       COMP-3          PIC S9(09)V9(9). 
               05  WSS-COD-PESOS VALUE SPACES          PIC X(06).       
           03  WSS-IND-VBEE      VALUE 'N'             PIC X(01).       
           03  MPC-NUM-DELAY     VALUE SPACES          PIC X(01).       
           03  WSS-CIC-IGRP      VALUE SPACES          PIC X(12).       
           03  WSS-VAL-UTL-E    COMP-3 VALUE ZEROES    PIC S9(11)V9(4). 
           03  WSS-CYF.                                                 
               05  WSS-F01             VALUE 1         PIC 9(03).       
               05  WSS-F02             VALUE 1         PIC 9(03).       
               05  WSS-F03             VALUE 1         PIC 9(03).       
               05  WSS-F04             VALUE 1         PIC 9(03).       
               05  WSS-F05             VALUE 1         PIC 9(03).       
               05  WSS-F06             VALUE 1         PIC 9(03).       
               05  WSS-F07             VALUE 1         PIC 9(03).       
               05  WSS-F08             VALUE 1         PIC 9(03).       
               05  WSS-F09             VALUE 1         PIC 9(03).       
               05  WSS-F10             VALUE 1         PIC 9(03).       
               05  WSS-F11             VALUE 1         PIC 9(03).       
               05  WSS-F12             VALUE 1         PIC 9(03).       
               05  WSS-F13             VALUE 1         PIC 9(03).       
               05  WSS-F14             VALUE 1         PIC 9(03).       
               05  WSS-F15             VALUE 1         PIC 9(03).       
               05  WSS-F16             VALUE 1         PIC 9(03).       
               05  WSS-F17             VALUE 1         PIC 9(03).       
               05  WSS-F18             VALUE 1         PIC 9(03).       
               05  WSS-F19             VALUE 1         PIC 9(03).       
               05  WSS-F20             VALUE 1         PIC 9(03).       
      * GVI-INI Mod. MEC 30-oct-2006                                    
       COPY GNSWGTCK.                                                   
       COPY GNSWGTPK.                                                   
       77  SXI-NUM-L6                         PIC 9(006).               
       01  SXI-GNSPPSXI VALUE SPACES.                                   
           03 SXI-GLS-DRIVE                   PIC X(031).               
           03 SXI-COD-TCPIP                   PIC X(006).               
           03 SXI-COD-ISGMT                   PIC X(001).               
           03 SXI-PT.                                                   
              05 SXI-GLS-HDR                  PIC X(100).               
              05 SXI-GLS-PT-CREQ              PIC X(003).               
              05 SXI-GLS-PT-DMSG              PIC X(859).               
       COPY GNSWGAMB.                                                   
       COPY GNSMXWS1.                                                   
       COPY GNSBRITK.                                                   
      *COPY GNSBRPTK.                                                   
       COPY GNSBRRTK.                                                   
      * GVI-FIN                                                                                                                                 

*% END
*% IF FIN_PGM_STAT
              05 PGM-STAT-RDC.
                 88 PGM-STAT-RDC-NUL    VALUE '  '.
                 07 PGM-STT1-RDC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RDC-OKS VALUE '0'.
                 07 PGM-STT2-RDC        VALUE '3' PIC X(01).
              05 PGM-STAT-REC.
                 88 PGM-STAT-REC-NUL    VALUE '  '.
                 07 PGM-STT1-REC        VALUE '2' PIC X(01).
                    88 PGM-STAT-REC-OKS VALUE '0'.
                 07 PGM-STT2-REC        VALUE '3' PIC X(01).
              05 PGM-STAT-GDD.
                 88 PGM-STAT-GDD-NUL    VALUE '  '.
                 07 PGM-STT1-GDD        VALUE '2' PIC X(01).
                    88 PGM-STAT-GDD-OKS VALUE '0'.
                 07 PGM-STT2-GDD        VALUE '3' PIC X(01).
*% END
*% IF FIN_SCR_VARI
           03 SCR-NUM-PANT               PIC 9(0002).
           03 SCR-CLG-FLD                PIC X(1150).
*% END
*% IF INI_FIO
      *<<<< INI_FIO
                                                                        
           MOVE TSK-TERM-NUM   TO SXI-NUM-L6.                           
                                                                        
           IF SCR-OFRM-SRV
                MOVE TSK-TERM-ALF TO MPC-NUM-TASK-K                     
                MOVE TSK-TERM-ALF TO MPC-NUM-TASK                       
                MOVE TSK-TERM-ALF TO CLG-COD-TERM
                MOVE TSK-TERM-ALF TO CLG-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO MPC-NUM-TASK-K                     
                MOVE EIBTRMID     TO MPC-NUM-TASK                       
                MOVE EIBTRMID     TO CLG-COD-TERM
                MOVE EIBTRMID     TO CLG-COD-TERM-MAS.
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )
               MOVE SCR-CLG-FLD TO CLG-FLD
               GO TO FIN-INI.

           IF ( FRM-FFLD = FRM-FFLD-PF6 )
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
               ADD 1              TO QUE-NITM
               MOVE CLG-NOM-TSCLG TO QUE-COLA
               MOVE CLG-LEN-TSCLG TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                  MOVE SCR-CLG-FLD TO CLG-FLD
                  GO TO FIN-INI.
      * OBTIENE CODIGO VALOR DE CAMBIO DE PESOS MEDIANTE CIC DE LA MONED
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               PERFORM PRG-ABT.
           MOVE TAB-COD-CTAB IN TAB TO CCU-COD-PESO IN CCU-VARI.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESOS TVC-MNAC.

           PERFORM GET-FHOY.                                            
           MOVE HOY-SHOY                 TO CAM-NUM-SCAM IN CAM(1).     
           MOVE HOY-AHOY                 TO CAM-NUM-ACAM IN CAM(1).     
           MOVE HOY-MHOY                 TO CAM-NUM-MCAM IN CAM(1).     
           MOVE HOY-DHOY                 TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE CCU-COD-PESO IN CCU-VARI TO CAM-COD-VCAM IN CAM(2).     
                                                                        
      *VALOR DE CAMBIO PARA UF                                          
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB.                         
           MOVE '0998'         TO TAB-CIC-CTAB.                         
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-INI.                                           
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFES.                   
                                                                        
           MOVE WSS-COD-UEFES TO CAM-COD-VCAM IN CAM(1).                
           MOVE FIO-GET-KEY   TO FIO-CMND.                              
           PERFORM TAB-FIO-CAM.                                         
           IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S')          
               MOVE 1 TO WSS-SGV-UEFES                                  
           ELSE                                                         
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-UEFES.               
                                                                        
      * Obtiene cic de garantia real                                    
           MOVE 'BGL'          TO FIO-SIST.
           MOVE 'RAL'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'R'            TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-REAL IN WSS-VARI.

           MOVE ZEROES TO MPC-LMAX.                                     
           MOVE ZEROES TO MPC-LFAC.                                     
           MOVE ZEROES TO MPC-TMAX.                                     
      * Obtiene Tipo de Realacion valida proyecto MEC
           MOVE 'DEU'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'TRECMEC     ' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-MSC-STAT = 'S'
              MOVE TAB-COD-DAT2(1) TO WSS-COD-TREC IN WSS-VARI
              MOVE TAB-COD-DAT2(2) TO WSS-COD-RELI IN WSS-VARI
              MOVE TAB-COD-DAT3(1) TO MPC-LMAX-ALF                      
              MOVE TAB-COD-DAT1(1) TO MPC-NUM-DELAY                     
           ELSE
              MOVE 'CD'            TO WSS-COD-TREC IN WSS-VARI
              MOVE 'DC'            TO WSS-COD-RELI IN WSS-VARI.
                                                                        
           IF MPC-LMAX NOT > ZEROES                                     
              MOVE 10 TO MPC-LMAX.                                      
           IF MPC-NUM-DELAY NOT > SPACES                                
              MOVE '2' TO MPC-NUM-DELAY.                                
                                                                        
           MOVE ZEROES TO WSS-VAL-MTSM IN WSS-VARI.                     
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      * GVI-INI                                                         
            SET WSS-NO-TIMEOUT TO TRUE.                                 
            SET SCR-IERR-NOT   TO TRUE.                                 
            IF WSS-IND-SWT3 = 'S'                   AND                 
               FRM-GLS-TICK IN CLG-FLD > SPACES     AND                 
               DBC-NUM-ICLI IN CLG-FLD = ZEROES     AND                 
               DBC-GLS-NOMC IN CLG-FLD = SPACES                         
                                                                        
               GO TO FIN-BUS-CLI-KEY.                                   
      * GVI-FIN                                                         
           IF DBC-NUM-ICLI IN CLG-FLD NOT = ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN CLG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN CLG-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN CLG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS NOT > SPACES
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN CLG-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN CLG-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN CLG-FLD
                   MOVE '00' TO PGM-STAT-DBC
                   GO TO FIN-BUS-CLI-KEY
               ELSE
                   MOVE MSG-GLS-DESC TO FRM-MENS CLG-GLS-MENS
                   MOVE 'S' TO SCR-IERR.

           IF DBC-GLS-NOMC IN CLG-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre
               MOVE DBC-GLS-NOMC IN CLG-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS NOT > SPACES
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN CLG-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN CLG-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN CLG-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN CLG-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN CLG-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN CLG-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN CLG-FLD
                   MOVE '00' TO PGM-STAT-DBC
                   GO TO FIN-BUS-CLI-KEY
               ELSE
                   MOVE MSG-GLS-DESC TO FRM-MENS CLG-GLS-MENS
                   MOVE 'S' TO SCR-IERR.

           IF DBC-CAI-ICLI IN CLG-FLD > SPACES OR
              DBC-IIC-ICLI IN CLG-FLD > SPACES
              MOVE DBC-CAI-ICLI IN CLG-FLD TO DBC-CAI-ICLI IN DBC
              MOVE DBC-IIC-ICLI IN CLG-FLD TO DBC-IIC-ICLI IN DBC
              MOVE FIO-GET-KEY    TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF FIO-STAT-OKS
                 MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN CLG-FLD
                 MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN CLG-FLD
                 MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN CLG-FLD
                 MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN CLG-FLD
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                 PERFORM CPT-BLKS
                 MOVE CPT-STRN            TO DBC-GLS-NOMC IN CLG-FLD
                 MOVE '00' TO PGM-STAT-DBC
                 GO TO FIN-BUS-CLI-KEY
              ELSE
                 MOVE 'CLI    NEX' TO MSG-COD-MENS                           
                 MOVE MSG-GLS-DESC TO FRM-MENS CLG-GLS-MENS
                 MOVE 'S' TO SCR-IERR.

       FIN-BUS-CLI-KEY.
           IF MSG-COD-MENS > SPACES
              GO TO MSG-FND-KEY.

           MOVE '00' TO PGM-STAT-DBC.
           GO TO CON-FND-KEY.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-CLG
               PERFORM VAL-NUM-FLD-CLG
               PERFORM SCRL-TAB-CLG
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CON-FND-KEY.
      * GVI-INI mod. MEC 30-OCT-2006                                    
           IF WSS-NO-TIMEOUT                                            
              SET WSS-CLI-NORMAL TO TRUE                                
           ELSE                                                         
              SET WSS-NO-TIMEOUT TO TRUE                                
              SET WSS-CLI-PESADO TO TRUE.                               
                                                                        
      * Solo si NO estamos en simulacisn se evaluan los Switch.         
      *    IF FRM-IIC-ISLC IN CLG-FLD > SPACES                          
      *       PERFORM FIN-BUS-TICK.                                     
                                                                        
      * SI ES SIMULACION SW1 Y SW2 SON FORZADOS A N                     
ZX         IF FRM-IIC-ISLC IN CLG-FLD > SPACES                          
ZX            MOVE 'N' TO WSS-IND-SWT1                                  
ZX                        WSS-IND-SWT2.                                 
                                                                        
      * Solo si algun Switch esta = S y NO es Cliente Pesado se evaluan 
      * los Switch                                                      
           IF (WSS-IND-SWT1 = 'S' OR                                    
               WSS-IND-SWT2 = 'S' OR                                    
      *        WSS-IND-SWT3 = 'S' OR                                    
               WSS-IND-SWT4 = 'S')  AND                                 
               WSS-CLI-NORMAL                                           
           THEN                                                         
              MOVE 'TAB'                    TO TAB-COD-SIST             
              MOVE 'RPE'                    TO TAB-COD-TTAB IN TAB      
              MOVE  DBC-NUM-ICLI IN CLG-FLD TO WSS-NUM-ICLI             
              MOVE  DBC-VRF-ICLI IN CLG-FLD TO WSS-VRF-ICLI             
              MOVE  DBC-IND-ICLI IN CLG-FLD TO WSS-IND-ICLI             
              MOVE  DBC-GLS-ICLI IN CLG-FLD TO WSS-GLS-ICLI             
              MOVE  WSS-COD-ICLI            TO TAB-COD-CTAB IN TAB      
              MOVE TAB-COD-SIST TO FIO-SIST                             
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS                                           
                 IF TAB-IND-VIGE IN TAB = 'S'                           
                    SET WSS-CLI-PESADO TO TRUE                          
                 ELSE                                                   
                    GO TO FIN-BUS-TICK.                                 
                                                                        
                                                                        
      * Busca el ticket indicado y que sea completado                   
           IF WSS-IND-SWT3 = 'S'     AND                                
              FRM-GLS-TICK IN CLG-FLD > SPACES                          
           THEN                                                         
              SET WSS-CLI-PESADO TO TRUE                                
              PERFORM FND-ITK-TICK                                      
              IF MSG-COD-MENS NOT > SPACES                              
                 PERFORM GET-RUT-ICLI                                   
              ELSE                                                      
                 MOVE 'S' TO SCR-IERR                                   
                 MOVE MSG-GLS-DESC TO FRM-MENS CLG-GLS-MENS             
                 GO TO MSG-FND-KEY.                                     
                                                                        
      * Busca el ticket en fecha y hora indicadas y que sea completado  
           IF WSS-IND-SWT3 = 'S'              AND                       
              FRM-FEC-FECH IN CLG-FLD > ZEROS AND                       
              FRM-HRA-HORA IN CLG-FLD > ZEROS AND                       
              FRM-GLS-TICK IN CLG-FLD = SPACES                          
           THEN                                                         
              PERFORM FND-ITK-FECH                                      
              IF WSS-TICKET-OK                                          
                 SET WSS-CLI-PESADO TO TRUE                             
              ELSE                                                      
                 MOVE 'S' TO SCR-IERR                                   
                 MOVE 'TICK   NEX' TO MSG-COD-MENS                      
                 GO TO MSG-FND-KEY.                                     
                                                                        
           PERFORM VAL-SWITCH.                                          
                                                                        
       FIN-BUS-TICK.                                                    
      * GVI-FIN                                                         
      ********************************************
           IF FRM-IIC-ISLC IN CLG-FLD > SPACES                          
              PERFORM LEE-SLC-CCU                                       
              IF MSG-COD-MENS > SPACES                                  
                 MOVE 'S' TO SCR-IERR                                   
                 GO TO MSG-FND-KEY.                                     
                                                                        
           MOVE DBC-CIC-ICLI IN DBC TO WSS-CIC-ICLI-CLG.                
           PERFORM CRG-CIC-NIVEL.                                       
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'S' TO SCR-IERR                                      
              GO TO MSG-FND-KEY.                                        
                                                                        
      * GVI-INI mod. MEC 30-OCT-2006                                    
      * Si corresponde, despues de insertar los registros PTK, se llama 
      * programa que ejecuta el batch.                                  
           IF MPC-NMAX NOT > ZEROS                                      
              SET WSS-CLI-NORMAL TO TRUE.                               
                                                                        
           IF WSS-PUT-PTK AND WSS-CLI-PESADO                            
              PERFORM SUB-ITK-BATCH                                     
              MOVE 'TICK   INS' TO MSG-COD-MENS                         
              GO TO MSG-FND-KEY.                                        
                                                                        
           IF WSS-CLI-NORMAL                                            
      * GVI-FIN                                                         
                                                                        
              PERFORM LEE-TOT-DMPC.                                     
                                                                        
      * GVI-INI                                                         
           IF WSS-SI-TIMEOUT AND                                        
              (WSS-IND-SWT1 = 'S' OR                                    
               WSS-IND-SWT2 = 'S' OR                                    
               WSS-IND-SWT3 = 'S' OR                                    
               WSS-IND-SWT4 = 'S')                                      
              MOVE SPACES TO MSG-COD-MENS                               
              GO TO CON-FND-KEY.                                        
      * GVI-FIN                                                         
                                                                        
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'S' TO SCR-IERR                                      
              GO TO MSG-FND-KEY.                                        
                                                                        
           PERFORM CRG-TOT-CAPR.                                        
      ********************************************
           PERFORM PUT-TAB.

           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *----------------------------------------------------------
       MSG-FND-KEY.
           IF FRM-MENS NOT > SPACES                                     
              MOVE 'DEU' TO MSG-COD-SIST                                
              PERFORM GET-MSG                                           
           MOVE MSG-GLS-DESC TO FRM-MENS.

           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<<
      * GVI-INI mod. MEC 30-OCT-2006                                    
           MOVE 'NNNN'     TO FRM-COD-SWIX IN CLG-FLD.                  
      * GVI-FIN                                                         
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
        COPY LDCBFRDC.                                                   
       COPY GNSBPFEC.                                                   
                                                                        
      * GVI-INI mod. MEC 30-OCT-2006                                    
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBGVSM.                                                   
       COPY GNSBFITK.                                                   
      *COPY GNSBFPTK.                                                   
       COPY GNSBFRTK.                                                   
      * GVI-FIN                                                         
                                                                        
       PUT-TAB SECTION.                                                 
       INI-PUT-TAB.                                                     
           MOVE CLG-NOM-TSCLG TO QUE-COLA.                              
           MOVE QUE-DEL       TO QUE-CMND.                              
           PERFORM GNS-PRO-QUE.                                         
                                                                        
           MOVE CLG-TSCLG-MAS    TO QUE-COLA.                           
           MOVE QUE-DEL          TO QUE-CMND.                           
           PERFORM GNS-PRO-QUE.                                         
                                                                        
           PERFORM CLR-TOT-GRP.                                         
           MOVE 1 TO SCR-NUM-PANT.                                      
           MOVE LOW-VALUES TO WSS-IND-TCLI-IDX.                         
      *                                                                 
           MOVE 1 TO FRM-IFLD.                                          
           MOVE ZEROES  TO WSS-NITM IN WSS-VARI.                        
                                                                        
           MOVE 1 TO WSS-J IN WSS-VARI.                                 
       LUP-PUT-TAB.                                                     
           IF WSS-J IN WSS-VARI > WSS-FMAX IN WSS-VARI                  
              GO TO FIN-PUT-TAB.                                        
           IF WSS-CIC-NODO-CLG(WSS-J) > SPACES                          
              PERFORM PUT-TAB-CLG                                       
              PERFORM PUT-CLG-QUE                                       
              PERFORM SET-FRM-IFLD                                      
           ELSE                                                         
           IF FRM-IFLD = 1 AND                                          
              FRM-IIC-ICLI IN CLG-FLD(FRM-IFLD) NOT > SPACES            
              MOVE 'DEU' TO MSG-COD-SIST                                
              MOVE 'CLG    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE '00' TO FIO-STAT                                     
              MOVE 'S' TO SCR-IERR                                      
              GO TO FIN-PUT-TAB                                         
           ELSE                                                         
              MOVE '00' TO FIO-STAT                                     
              GO TO FIN-PUT-TAB.                                        
                                                                        
           ADD 1 TO WSS-J IN WSS-VARI.                                  
           GO TO LUP-PUT-TAB.                                           
       FIN-PUT-TAB.                                                     
                                                                        
           MOVE HOY-DHOY TO FEC-ITM1.                                   
           MOVE HOY-MHOY TO FEC-ITM2.                                   
           MOVE HOY-SHOY TO FEC-ITM3.                                   
           MOVE HOY-AHOY TO FEC-ITM4.                                   
           MOVE 1            TO FEC-NDIA.                               
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-RST-DIA  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           MOVE FEC-ITM1 TO FRM-NUM-DINF.                               
           MOVE FEC-ITM2 TO FRM-NUM-MINF.                               
           MOVE FEC-ITM3 TO FRM-NUM-SINF.                               
           MOVE FEC-ITM4 TO FRM-NUM-AINF.                               
                                                                        
      *INI-MARGEN GRUPO                                                 
           MOVE DBC-CAI-ICLI IN CLG-FLD TO DBC-CAI-ICLI IN DBC.         
           MOVE DBC-IIC-ICLI IN CLG-FLD TO DBC-IIC-ICLI IN DBC.         
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM SGC-FIO-DBC.                                         
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                        
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC.             
           MOVE FIO-STAT TO PGM-STAT-DBC.                               
           MOVE DBC-CIC-ICLI IN DBC TO CCU-CIC-ICLI IN CCU-VARI.        
           MOVE 'G' TO WSS-IND-GRPO IN WSS-VARI.                        
           PERFORM BUS-CLI-CLF.                                         
           IF CCU-COD-MENS > SPACES                                     
              MOVE ZEROES                  TO WSS-VAL-MNAC-CLG          
           ELSE                                                         
              MOVE CLF-VAL-CMAX IN CLF TO WSS-VAL-MONE-CLG              
              MOVE CLF-COD-VCCF IN CLF TO WSS-VCAM-CLG                  
              PERFORM OBT-VAL-MNAC-CLG.                                 
      *FIN-MARGEN SUBGRUPO                                              
      *PVG INI 11-MAY-2004 SOLICITUD BANCO (ESPECIAL)                   
           IF WSS-VAL-APRB IN WSS-VARI > WSS-VAL-MNAC-CLG               
              MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-APRB IN WSS-VARI         
              SUBTRACT WSS-VAL-UTLB IN WSS-VARI FROM                    
                       WSS-VAL-APRB IN WSS-VARI GIVING                  
                       WSS-VAL-DISB IN WSS-VARI.                        
           IF WSS-VAL-APRF IN WSS-VARI > WSS-VAL-MNAC-CLG               
              MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-APRF IN WSS-VARI         
              SUBTRACT WSS-VAL-UTLF IN WSS-VARI FROM                    
                       WSS-VAL-APRF IN WSS-VARI GIVING                  
                       WSS-VAL-DISF IN WSS-VARI.                        
                                                                        
           IF WSS-VAL-APRL IN WSS-VARI > WSS-VAL-MNAC-CLG               
              MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-APRL IN WSS-VARI         
              SUBTRACT WSS-VAL-UTLL IN WSS-VARI FROM                    
                       WSS-VAL-APRL IN WSS-VARI GIVING                  
                       WSS-VAL-DISL IN WSS-VARI.                        
                                                                        
           IF WSS-VAL-APRM IN WSS-VARI > WSS-VAL-MNAC-CLG               
              MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-APRM IN WSS-VARI         
              SUBTRACT WSS-VAL-UTLM IN WSS-VARI FROM                    
                       WSS-VAL-APRM IN WSS-VARI GIVING                  
                       WSS-VAL-DISM IN WSS-VARI.                        
                                                                        
           IF WSS-VAL-APRA IN WSS-VARI > WSS-VAL-MNAC-CLG               
              MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-APRA IN WSS-VARI         
              SUBTRACT WSS-VAL-UTLA IN WSS-VARI FROM                    
                       WSS-VAL-APRA IN WSS-VARI GIVING                  
                       WSS-VAL-DISA IN WSS-VARI.                        
                                                                        
           IF WSS-VAL-APRI IN WSS-VARI > WSS-VAL-MNAC-CLG               
              MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-APRI IN WSS-VARI         
              SUBTRACT WSS-VAL-UTLI IN WSS-VARI FROM                    
                       WSS-VAL-APRI IN WSS-VARI GIVING                  
                       WSS-VAL-DISI IN WSS-VARI.                        
      *PVG FIN 11-MAY-2004 SOLICITUD BANCO (ESPECIAL)                   
                                                                        
           DIVIDE WSS-VAL-MNAC-CLG BY 1000 GIVING                       
                  FRM-VAL-APRG IN CLG-FLD ROUNDED.                      
      *SUMA MONTO SIMULADO A MARGEN GRUPO                               
              ADD WSS-VAL-MTSM IN WSS-VARI TO WSS-VAL-MNAC-CLG.         
              DIVIDE WSS-VAL-MNAC-CLG BY 1000 GIVING                    
                     FRM-VAL-MARG IN CLG-FLD ROUNDED.                   
      *SUMA MONTO SIMULADO A UTILIZADO GRUPO                            
           ADD WSS-VAL-MTSM IN WSS-VARI TO WSS-VAL-UTLG IN WSS-VARI.    
                                                                        
           DIVIDE WSS-VAL-DISG IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-DISG IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-UTLG IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-UTLG IN CLG-FLD ROUNDED.                      
                                                                        
           MOVE   WSS-VAL-UTPR IN WSS-VARI TO FRM-VAL-UTPR IN CLG-FLD.  
                                                                        
           DIVIDE WSS-VAL-GARG IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-GARG IN CLG-FLD ROUNDED.                      
                                                                        
           SUBTRACT FRM-VAL-UTLG IN CLG-FLD FROM                        
                    FRM-VAL-MARG IN CLG-FLD GIVING                      
                    FRM-VAL-DISG IN CLG-FLD ROUNDED.                    
                                                                        
           DIVIDE WSS-VAL-APRI IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-APRI IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-DISI IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-DISI IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-UTLI IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-UTLI IN CLG-FLD ROUNDED.                      
                                                                        
           DIVIDE WSS-VAL-APRA IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-APRA IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-DISA IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-DISA IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-UTLA IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-UTLA IN CLG-FLD ROUNDED.                      
                                                                        
           DIVIDE WSS-VAL-UTLB IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-UTLB IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-DISB IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-DISB IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-APRB IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-APRB IN CLG-FLD ROUNDED.                      
                                                                        
           DIVIDE WSS-VAL-APRF IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-APRF IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-DISF IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-DISF IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-UTLF IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-UTLF IN CLG-FLD ROUNDED.                      
                                                                        
           DIVIDE WSS-VAL-DISL IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-DISL IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-APRL IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-APRL IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-UTLL IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-UTLL IN CLG-FLD ROUNDED.                      
                                                                        
           DIVIDE WSS-VAL-APRM IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-APRM IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-UTLM IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-UTLM IN CLG-FLD ROUNDED.                      
           DIVIDE WSS-VAL-DISM IN WSS-VARI BY 1000 GIVING               
                  FRM-VAL-DISM IN CLG-FLD ROUNDED.                      
                                                                        
           IF FRM-IIC-ISLC IN CLG-FLD NOT > SPACES                      
              GO TO CON-PUT-TAB.                                        
                                                                        
      *SIMULACION                                                       
           MOVE HOY-DHOY               TO CAM-NUM-DCAM IN CAM(1).       
           MOVE HOY-MHOY               TO CAM-NUM-MCAM IN CAM(1).       
           MOVE HOY-SHOY               TO CAM-NUM-SCAM IN CAM(1).       
           MOVE HOY-AHOY               TO CAM-NUM-ACAM IN CAM(1).       
           MOVE ZEROES                 TO WSS-NUM-CAMB IN WSS-VARI.     
           GO TO LUP-LLENA-VALORES.                                     
                                                                        
       LUP-FECHA-ANTERIOR.                                              
           MOVE CAM-NUM-DCAM IN CAM(1) TO FEC-ITM1.                     
           MOVE CAM-NUM-MCAM IN CAM(1) TO FEC-ITM2.                     
           MOVE CAM-NUM-SCAM IN CAM(1) TO FEC-ITM3.                     
           MOVE CAM-NUM-ACAM IN CAM(1) TO FEC-ITM4.                     
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-RST-DIA  TO FEC-CMND.                               
           MOVE 1            TO FEC-NDIA.                               
           PERFORM CAL-FEC.                                             
           MOVE FEC-ITM1               TO CAM-NUM-DCAM IN CAM(1).       
           MOVE FEC-ITM2               TO CAM-NUM-MCAM IN CAM(1).       
           MOVE FEC-ITM3               TO CAM-NUM-SCAM IN CAM(1).       
           MOVE FEC-ITM4               TO CAM-NUM-ACAM IN CAM(1).       
                                                                        
       LUP-LLENA-VALORES.                                               
           ADD 1                       TO WSS-NUM-CAMB IN WSS-VARI.     
           MOVE 'UCAP01'               TO CAM-COD-VCAM IN CAM(1).       
           MOVE '0999  '               TO CAM-COD-VCAM IN CAM(2).       
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).       
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')                
               IF WSS-NUM-CAMB IN WSS-VARI NOT > 61                     
                  GO TO LUP-FECHA-ANTERIOR                              
               ELSE                                                     
                  MOVE ZEROES TO FRM-SGV-MGRP IN CLG-FLD                
                  MOVE ZEROES TO FRM-SGV-UTRP IN CLG-FLD                
           ELSE                                                         
              COMPUTE FRM-SGV-MGRP IN CLG-FLD ROUNDED =                 
              ( FRM-VAL-MARG IN CLG-FLD * 100 / CAM-SGV-VCAM IN CAM )   
                                                                        
              COMPUTE FRM-SGV-UTRP IN CLG-FLD ROUNDED =                 
              ( FRM-VAL-UTLG IN CLG-FLD * 100 / CAM-SGV-VCAM IN CAM ).  
                                                                        
                                                                        
       CON-PUT-TAB.                                                     
           MOVE PGM-STAT-DBC TO FIO-STAT.                               
           MOVE 1                  TO QUE-NITM.                         
           MOVE CLG-LEN-TSCLG-MAS  TO QUE-LITM.                         
           MOVE CLG-TSCLG-MAS      TO QUE-COLA.                         
                                                                        
           IF WSS-NITM > CLG-TOT-OCC-CLG                                
              MOVE 'S'           TO CLG-MAS-IND-HMAS                    
           ELSE                                                         
              MOVE 'N'           TO CLG-MAS-IND-HMAS.                   
                                                                        
           MOVE WSS-NITM         TO WSS-NUM-ICUR.                       
           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.                   
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.                   
           MOVE WSS-NUM-ICUR-ALF TO CLG-MAS-NUM-TOCC.                   
           MOVE CLG-MAS-ITEM     TO QUE-ITEM.                           
           MOVE QUE-PUT          TO QUE-CMND.                           
           PERFORM GNS-PRO-QUE.                                         
           IF WSS-NITM > WSS-IMAX                                       
               MOVE 'DEU' TO MSG-COD-SIST                               
               MOVE 'CLGMECDMAS' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN2.                           
       EXT-PUT-TAB.                                                     
           EXIT.                                                        
                                                                        
       SET-FRM-IFLD SECTION.                                            
       INI-SET-FRM-IFLD.                                                
           IF SCR-OFRM-SRV                                              
                MOVE 1 TO FRM-IFLD                                      
           ELSE                                                         
                ADD 1 TO FRM-IFLD.                                      
       FIN-SET-FRM-IFLD.                                                
           EXIT.                                                        
      *--------------------------------------------                     
       SCRL-TAB-CLG SECTION.                                            
       INI-SCRL-TAB-CLG.                                                
           MOVE SPACES TO MSG-COD-MENS.                                 
                                                                        
           IF FRM-FFLD = FRM-FFLD-PF6                                   
               PERFORM PUT-TAB-ASC                                      
           ELSE                                                         
               PERFORM PUT-TAB-DSC.                                     
           IF MSG-COD-MENS > SPACES                                     
               MOVE 'DEU' TO MSG-COD-SIST                               
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN2.                           
       FIN-SCRL-TAB-CLG.                                                
           EXIT.                                                        
                                                                        
      *--------------------------------------------                     
       PUT-TAB-CLG SECTION.                                             
       INI-PUT-TAB-CLG.                                                 
           PERFORM CLR-WSS.                                             
           MOVE WSS-IND-TLNK-CLG(WSS-J) TO WSS-IND-TCLI-G IN WSS-VARI.  
           MOVE WSS-CIC-NODO-CLG(WSS-J) TO DBC-CIC-ICLI IN DBC.         
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM SGC-FIO-DBC.                                         
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                         
           PERFORM CPT-BLKS                                             
           MOVE CPT-STRN            TO WSS-GLS-NOMB IN WSS-VARI.        
      *AFRI-INI/OCT-2006                                                
      *    MOVE DBC-CIC-ICLI IN DBC TO WSS-CIC-ICLI-ALE.                
           IF WSS-CIC-ISLC        = DBC-CIC-ICLI IN DBC                 
                MOVE '(*)'                    TO WSS-ETIQ IN CLG-VARI   
                MOVE WSS-GLS-NOMB IN WSS-VARI TO WSS-NOMB IN CLG-VARI   
                MOVE WSS-CLI IN CLG-VARI TO                             
                  WSS-GLS-NOMB IN WSS-VARI.                             
      *AFRI-FIN/OCT-2006                                                
      *MHM-INI 02-OCT-2008                                              
           IF WSS-IND-CLNA-CLG(WSS-J) = 'S'                             
              MOVE WSS-GLS-NOMB TO WSS-GLS-NOM1                         
              MOVE '(*)'        TO WSS-GLS-NOM2                         
              MOVE WSS-GLS-NOMC TO WSS-GLS-NOMB.                        
      *MHM-FIN 02-OCT-2008                                              
                                                                        
      *PVG INI 14-ABR-2004 CLIENTE QUE GENERO GRUPO                     
           IF WSS-IND-TLNK-CLG(WSS-J) = 'X'                             
              MOVE 'E'    TO WSS-IND-TLNK-CLG(WSS-J)                    
              MOVE WSS-IND-TLNK-CLG(WSS-J)                              
                                  TO WSS-IND-TCLI-G IN WSS-VARI.        
      *PVG FIN 14-ABR-2004                                              
           MOVE WSS-CAI-PDRE-CLG(WSS-J) TO WSS-CAI-IPRD IN WSS-VARI.    
           MOVE WSS-IIC-PDRE-CLG(WSS-J) TO WSS-IIC-IPRD IN WSS-VARI.    
                                                                        
           MOVE WSS-CAI-NODO-CLG(WSS-J) TO WSS-CAI-ICLI-G IN WSS-VARI.  
           MOVE WSS-IIC-NODO-CLG(WSS-J) TO WSS-IIC-ICLI-G IN WSS-VARI.  
                                                                        
           IF WSS-IND-NVLN-CLG(WSS-J) = 1                               
              MOVE SPACES     TO WSS-CAI-IPRD   IN WSS-VARI             
              MOVE 'TREENODO' TO WSS-IIC-IPRD   IN WSS-VARI.            
                                                                        
           DIVIDE WSS-VAL-MAPR-CLG(WSS-J) BY 1000 GIVING                
                  WSS-VAL-MARS IN WSS-VARI ROUNDED.                     
                                                                        
           DIVIDE WSS-VAL-CAPR-CLG(WSS-J) BY 1000 GIVING                
                  WSS-VAL-APRS IN WSS-VARI ROUNDED.                     
                                                                        
           DIVIDE WSS-VAL-CUTI-CLG(WSS-J) BY 1000 GIVING                
                  WSS-VAL-UTLS IN WSS-VARI ROUNDED.                     
                                                                        
           DIVIDE WSS-VAL-CDIS-CLG(WSS-J) BY 1000 GIVING                
                  WSS-VAL-DISS IN WSS-VARI ROUNDED.                     
                                                                        
           DIVIDE WSS-VAL-GARS-CLG(WSS-J) BY 1000 GIVING                
                  WSS-VAL-GARS IN WSS-VARI ROUNDED.                     
                                                                        
      *MHM-INI 07-OCT-2008                                              
           IF WSS-IND-LEN0-CLG(WSS-J) = 'S'                             
              MOVE ZEROES TO WSS-VAL-MARS IN WSS-VARI                   
              MOVE ZEROES TO WSS-VAL-APRS IN WSS-VARI                   
              MOVE ZEROES TO WSS-VAL-UTLS IN WSS-VARI                   
              MOVE ZEROES TO WSS-VAL-DISS IN WSS-VARI                   
              MOVE ZEROES TO WSS-VAL-GARS IN WSS-VARI.                  
      *MHM-FIN 07-OCT-2008                                              
      *CALCULO DISPONIBLE = MARGEN - UTILIZADO                          
           SUBTRACT WSS-VAL-UTLS IN WSS-VARI FROM                       
                    WSS-VAL-MARS IN WSS-VARI GIVING                     
                    WSS-VAL-DISS IN WSS-VARI ROUNDED.                   
                                                                        
           MOVE ZEROES TO WSS-SGV-PROP IN WSS-VARI.                     
           ADD WSS-VAL-PROP-CLG(WSS-J) TO                               
               WSS-SGV-PROP IN WSS-VARI ROUNDED.                        
                                                                        
           IF WSS-COD-ADMI-CLG(WSS-J) > SPACES                          
              GO TO CON-PUT-TAB-CLG-1.                                  
                                                                        
           IF WSS-SGV-PROP IN WSS-VARI < 10                             
              MOVE ZEROES TO WSS-SGV-PROR IN WSS-VARI                   
           ELSE                                                         
           IF WSS-SGV-PROP IN WSS-VARI < 50 OR                          
              WSS-SGV-PROP IN WSS-VARI = 50                             
              MOVE WSS-SGV-PROP IN WSS-VARI TO                          
                   WSS-SGV-PROR IN WSS-VARI                             
           ELSE                                                         
              MOVE 100    TO WSS-SGV-PROR IN WSS-VARI.                  
           GO TO CON-PUT-TAB-CLG-2.                                     
                                                                        
       CON-PUT-TAB-CLG-1.                                               
              PERFORM OBT-VAL-ADMI.                                     
       CON-PUT-TAB-CLG-2.                                               
                                                                        
           COMPUTE WSS-VAL-UTLP IN WSS-VARI ROUNDED =                   
           (WSS-VAL-UTLS IN WSS-VARI * WSS-SGV-PROR IN WSS-VARI / 100). 
                                                                        
           IF WSS-IND-TLNK-CLG(WSS-J) = 'E' OR 'X'                      
              PERFORM ACU-UTLP-GRP.                                     
                                                                        
      *EDITA CAMPOS SOLO EN VERSION BEE                                 
      *MHM-INI 17-NOV-2008 AHORA SE EDITAN LOS CAMPOS                   
      *    IF SCR-OFRM-SRV AND WSS-IND-VBEE = 'S'                       
           IF SCR-OFRM-SRV                                              
      *MHM-FIN 17-NOV-2008                                              
              PERFORM EDT-VAL-CLG.                                      
                                                                        
           IF FRM-IFLD > WSS-IMAX                                       
              GO TO FIN-PUT-TAB-CLG.                                    
                                                                        
           MOVE WSS-IND-TCLI-G IN WSS-VARI TO                           
                FRM-IND-TCLI IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-GLS-NOMB IN WSS-VARI TO                             
                FRM-GLS-NOMB IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-VAL-MARS IN WSS-VARI TO                             
                FRM-VAL-MARS IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-VAL-APRS IN WSS-VARI TO                             
                FRM-VAL-APRS IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-VAL-UTLS IN WSS-VARI TO                             
                FRM-VAL-UTLS IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-VAL-DISS IN WSS-VARI TO                             
                FRM-VAL-DISS IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-VAL-GARS IN WSS-VARI TO                             
                FRM-VAL-GARS IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-SGV-PROP IN WSS-VARI TO                             
                FRM-SGV-PROP IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-COD-ADMI IN WSS-VARI TO                             
                FRM-COD-ADMI IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-SGV-PROR IN WSS-VARI TO                             
                FRM-SGV-PROR IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-VAL-UTLP IN WSS-VARI TO                             
                FRM-VAL-UTLP IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-CAI-IPRD IN WSS-VARI TO                             
                FRM-CAI-IPRD IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-IIC-IPRD IN WSS-VARI TO                             
                FRM-IIC-IPRD IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-CAI-ICLI-G IN WSS-VARI TO                           
                FRM-CAI-ICLI IN CLG-FLD(FRM-IFLD).                      
           MOVE WSS-IIC-ICLI-G IN WSS-VARI TO                           
                FRM-IIC-ICLI IN CLG-FLD(FRM-IFLD).                      
       FIN-PUT-TAB-CLG.                                                 
           EXIT.                                                        
                                                                        
      *----------------------------------------------------             
       PUT-CLG-QUE SECTION.                                             
       INI-PUT-CLG-QUE.                                                 
           ADD 1 TO WSS-NITM.                                           
           MOVE CLG-NOM-TSCLG    TO QUE-COLA.                           
           MOVE CLG-LEN-TSCLG    TO QUE-LITM.                           
           MOVE WSS-NITM         TO QUE-NITM.                           
           MOVE SPACES           TO QUE-ITEM.                           
           MOVE WSS-IND-TCLI-IDX TO QUE-ITEM.                           
           MOVE QUE-PUT          TO QUE-CMND.                           
           PERFORM GNS-PRO-QUE.                                         
       FIN-PUT-CLG-QUE.                                                 
           EXIT.                                                        
      *----------------------------------------------------             
                                                                        
       PUT-TAB-ASC SECTION.                                             
       INI-PUT-TAB-ASC.                                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.           
           MOVE 0 TO FRM-IFLD.                                          
       LUP-PUT-TAB-ASC.                                                 
           ADD 1              TO QUE-NITM.                              
           MOVE CLG-NOM-TSCLG TO QUE-COLA.                              
           MOVE CLG-LEN-TSCLG TO QUE-LITM.                              
           MOVE QUE-GET       TO QUE-CMND.                              
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT NOT = QUE-STAT-OKS                               
               IF FRM-IFLD = 0                                          
                   MOVE 'CLGMECNONXT' TO MSG-COD-MENS                   
                   GO TO FIN-PUT-TAB-ASC                                
               ELSE                                                     
                   GO TO FIN-PUT-TAB-ASC.                               
           ADD 1 TO FRM-IFLD.                                           
           MOVE QUE-ITEM TO FRM-IND-TCLI-IDX(FRM-IFLD).                 
           IF FRM-IFLD < WSS-IMAX                                       
               GO TO LUP-PUT-TAB-ASC.                                   
       FIN-PUT-TAB-ASC.                                                 
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX                      
               ADD 1 FRM-IFLD GIVING WSS-I                              
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1            
                                 UNTIL WSS-I > WSS-IMAX.                
           IF FRM-IFLD > 0                                              
               ADD 1 TO SCR-NUM-PANT.                                   
           IF FRM-IFLD = WSS-IMAX                                       
               ADD 1              TO QUE-NITM                           
               MOVE CLG-NOM-TSCLG TO QUE-COLA                           
               MOVE CLG-LEN-TSCLG TO QUE-LITM                           
               MOVE QUE-GET       TO QUE-CMND                           
               PERFORM GNS-PRO-QUE                                      
               IF QUE-STAT = QUE-STAT-OKS                               
                   MOVE 'DEU'        TO MSG-COD-SIST                    
                   MOVE 'CLGMECDMAS' TO MSG-COD-MENS.                   
       EXT-PUT-TAB-ASC.                                                 
           EXIT.                                                        
                                                                        
       PUT-TAB-DSC SECTION.                                             
       INI-PUT-TAB-DSC.                                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
           IF SCR-NUM-PANT = 1                                          
               MOVE 'CLGMECNOPRV' TO MSG-COD-MENS                       
               GO TO EXT-PUT-TAB-DSC.                                   
                                                                        
           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.                
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.               
           ADD 1 TO QUE-NITM.                                           
           ADD 1 WSS-IMAX GIVING FRM-IFLD.                              
       LUP-PUT-TAB-DSC.                                                 
           SUBTRACT  1 FROM QUE-NITM.                                   
           MOVE CLG-NOM-TSCLG TO QUE-COLA                               
           MOVE CLG-LEN-TSCLG TO QUE-LITM                               
           MOVE QUE-GET       TO QUE-CMND.                              
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT NOT = QUE-STAT-OKS                               
               IF FRM-IFLD > WSS-IMAX                                   
                   MOVE 'CLGMECNOPRV' TO MSG-COD-MENS                   
                   GO TO FIN-PUT-TAB-DSC                                
               ELSE                                                     
                   GO TO FIN-PUT-TAB-DSC.                               
           SUBTRACT 1 FROM FRM-IFLD.                                    
           MOVE QUE-ITEM TO FRM-IND-TCLI-IDX(FRM-IFLD).                 
           IF FRM-IFLD > 1                                              
               GO TO LUP-PUT-TAB-DSC.                                   
       FIN-PUT-TAB-DSC.                                                 
                                                                        
           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1                  
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I                    
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1           
                                 UNTIL WSS-I < 1.                       
                                                                        
           IF FRM-IFLD NOT > WSS-IMAX                                   
               SUBTRACT 1 FROM SCR-NUM-PANT                             
               MOVE 'DEU'        TO MSG-COD-SIST                        
               MOVE 'CLGMECDMAS' TO MSG-COD-MENS.                       
       EXT-PUT-TAB-DSC.                                                 
           EXIT.                                                        
      *--------------------------------------------                     
       COPY SGCBFDBC.                                                   
       COPY SGCBFREC.                                                   
       COPY SGCBGCLI.                                                   
                                                                        
       COPY GNSBGCPT.                                                   
       COPY GNSBGSTR.                                                   
      *--------------------------------------------                     
       EDT-VAL-CLG SECTION.                                             
       INI-EDT-VAL-CLG.                                                 
           MOVE WSS-SGV-PROP     IN WSS-VARI TO                         
                FRM-SGV-PROP-EDT IN CLG-EDT.                            
           MOVE FRM-SGV-PROP-EDT IN CLG-EDT TO                          
                WSS-SGV-PROP-ALF IN WSS-VARI.                           
                                                                        
           MOVE WSS-SGV-PROR     IN WSS-VARI TO                         
                FRM-SGV-PROR-EDT IN CLG-EDT.                            
           MOVE FRM-SGV-PROR-EDT IN CLG-EDT TO                          
                WSS-SGV-PROR-ALF IN WSS-VARI.                           
                                                                        
      *MHM-INI 17-NOV-2008 AHORA SE EDITAN LOS CAMPOS                   
      *    MOVE WSS-VAL-MARS     IN WSS-VARI TO                         
      *         FRM-VAL-MARS-EDT IN CLG-EDT.                            
      *    MOVE FRM-VAL-MARS-EDT IN CLG-EDT TO                          
      *         WSS-VAL-MARS-ALF IN WSS-VARI.                           
      *                                                                 
      *    MOVE WSS-VAL-APRS     IN WSS-VARI TO                         
      *         FRM-VAL-APRS-EDT IN CLG-EDT.                            
      *    MOVE FRM-VAL-APRS-EDT IN CLG-EDT TO                          
      *         WSS-VAL-APRS-ALF IN WSS-VARI.                           
      *                                                                 
      *    MOVE WSS-VAL-UTLS     IN WSS-VARI TO                         
      *         FRM-VAL-UTLS-EDT IN CLG-EDT.                            
      *    MOVE FRM-VAL-UTLS-EDT IN CLG-EDT TO                          
      *         WSS-VAL-UTLS-ALF IN WSS-VARI.                           
      *                                                                 
      *    MOVE WSS-VAL-DISS     IN WSS-VARI TO                         
      *         FRM-VAL-DISS-EDT IN CLG-EDT.                            
      *    MOVE FRM-VAL-DISS-EDT IN CLG-EDT TO                          
      *         WSS-VAL-DISS-ALF IN WSS-VARI.                           
      *                                                                 
      *    MOVE WSS-VAL-GARS     IN WSS-VARI TO                         
      *         FRM-VAL-GARS-EDT IN CLG-EDT.                            
      *    MOVE FRM-VAL-GARS-EDT IN CLG-EDT TO                          
      *         WSS-VAL-GARS-ALF IN WSS-VARI.                           
      *                                                                 
      *    MOVE WSS-VAL-UTLP     IN WSS-VARI TO                         
      *         FRM-VAL-UTLP-EDT IN CLG-EDT.                            
      *    MOVE FRM-VAL-UTLP-EDT IN CLG-EDT TO                          
      *         WSS-VAL-UTLP-ALF IN WSS-VARI.                           
       FIN-EDT-VAL-CLG.                                                 
           EXIT.                                                        
                                                                        
       COPY LDCBKCCU.                                                   
       COPY TABBFCAM.                                                   
                                                                        
       VAL-REC SECTION.                                                 
       INI-VAL-REC.                                                     
           MOVE 'N' TO WSS-IND-STAT IN WSS-VARI.                        
           IF ( REC-IND-VIGE IN REC = 'S' AND                           
               (REC-FEC-FINI IN REC < HOY-FHOY OR                       
                REC-FEC-FINI IN REC = HOY-FHOY OR                       
                REC-FEC-FINI IN REC NOT > ZEROES ) AND                  
               (REC-FEC-FTER IN REC > HOY-FHOY OR                       
                REC-FEC-FTER IN REC = HOY-FHOY OR                       
                REC-FEC-FTER IN REC NOT > ZEROES ) )                    
                MOVE 'S' TO WSS-IND-STAT IN WSS-VARI.                   
       FIN-VAL-REC.                                                     
           EXIT.                                                        
                                                                        
       CRG-CIC-NIVEL SECTION.                                           
       INI-CRG-CIC-NIVEL.                                               
           MOVE ZEROES TO MPC-N.                                        
           MOVE ZEROES TO WSS-ACT.                                      
           MOVE 1      TO WSS-C.                                        
           MOVE ZEROES TO WSS-F IN WSS-VARI.                            
           PERFORM CRG-CIC-NVLA.                                        
           IF WSS-F IN WSS-VARI NOT > ZEROES                            
              MOVE 'REC    NEX' TO MSG-COD-MENS                         
              GO TO FIN-CRG-CIC-NIVEL.                                  
       LUP-CRG-CIC-NIVEL.                                               
           IF WSS-C IN WSS-VARI > WSS-CMAX IN WSS-VARI                  
              GO TO CON-CRG-CIC-NIVEL.                                  
                                                                        
           ADD 1 TO WSS-ACT IN WSS-VARI.                                
           ADD 1 TO WSS-C   IN WSS-VARI.                                
           PERFORM CRG-CIC-NVLN.                                        
           GO TO LUP-CRG-CIC-NIVEL.                                     
       CON-CRG-CIC-NIVEL.                                               
           PERFORM CRG-VAL-VEC.                                         
ZX         IF SCR-IERR = 'S'                                            
ZX            GO TO FIN-CRG-CIC-NIVEL.                                  
           IF WSS-I IN WSS-VARI = 1 AND MPC-N = ZEROES                  
              MOVE 'REC    NEX' TO MSG-COD-MENS                         
              GO TO FIN-CRG-CIC-NIVEL.                                  
       FIN-CRG-CIC-NIVEL.                                               
           EXIT.                                                        
                                                                        
       CRG-CIC-NVLA SECTION.                                            
       INI-CRG-CIC-NVLA.                                                
           MOVE ZEROES                   TO WSS-F IN WSS-VARI.          
           PERFORM CRG-CIC-NVLA-IDC.                                    
                                                                        
           MOVE WSS-CIC-ICLI-CLG IN WSS-VARI TO REC-CIC-ICLI IN REC.    
           MOVE WSS-COD-TREC IN WSS-VARI TO REC-COD-TREC IN REC.        
           MOVE SPACES                   TO REC-CIC-IREL IN REC.        
           MOVE ZEROES                   TO REC-NUM-TREC IN REC.        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-CRG-CIC-NVLA.                                                
           PERFORM SGC-FIO-REC.                                         
           MOVE FIO-STAT TO PGM-STAT-REC.                               
           IF NOT ( FIO-STAT-OKS AND                                    
              REC-CIC-ICLI IN REC = WSS-CIC-ICLI-CLG IN WSS-VARI AND    
              REC-COD-TREC IN REC = WSS-COD-TREC IN WSS-VARI )          
              GO TO EXT-CRG-CIC-NVLA.                                   
                                                                        
           PERFORM VAL-REC.                                             
           IF WSS-IND-STAT IN WSS-VARI = 'N'                            
              GO TO NXT-CRG-CIC-NVLA.                                   
                                                                        
      *CARGA CIC SUBGRUPO/GRUPO/EMPRESA                                 
           ADD 1 TO WSS-F IN WSS-VARI.                                  
           IF WSS-F IN WSS-VARI > WSS-FMAX IN WSS-VARI                  
              GO TO EXT-CRG-CIC-NVLA.                                   
                                                                        
           MOVE WSS-C                  TO WSS-IND-NVLN(WSS-C,WSS-F).    
           MOVE 'E'                    TO WSS-IND-TCLI(WSS-C,WSS-F).    
           MOVE WSS-CIC-ICLI-CLG       TO WSS-CIC-PDRE(WSS-C,WSS-F).    
           MOVE REC-CIC-IREL IN REC    TO WSS-CIC-NODO(WSS-C,WSS-F).    
           MOVE REC-COD-AREC IN REC    TO WSS-COD-ADMI-M(WSS-C,WSS-F).  
           MOVE ZEROES                 TO WSS-VAL-PROP(WSS-C,WSS-F).    
           ADD  REC-SGV-AREC IN REC    TO WSS-VAL-PROP(WSS-C,WSS-F).    
                                                                        
           MOVE WSS-CIC-NODO(WSS-C,WSS-F) TO  WSS-CIC-ICLI-RDC.         
           MOVE 'CLF'                     TO WSS-COD-TOCF.              
           PERFORM VAL-CLF-IDC.                                         
           IF WSS-IND-STAT IN WSS-VARI = 'N'                            
              MOVE ZEROES TO WSS-VAL-MARC-M(WSS-C,WSS-F)                
              MOVE SPACES TO WSS-CIC-ICLF-M(WSS-C,WSS-F)                
           ELSE                                                         
              MOVE CLF-CIC-ICLF IN CLF TO WSS-CIC-ICLF-M(WSS-C,WSS-F)   
              MOVE CLF-VAL-CMAX IN CLF TO WSS-VAL-MONE-CLG              
              MOVE CLF-COD-VCCF IN CLF TO WSS-VCAM-CLG                  
              PERFORM OBT-VAL-MNAC-CLG                                  
              MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-MARC-M(WSS-C,WSS-F).     
      *MHM-INI 02-OCT-2008                                              
           MOVE WSS-IND-CLNA        TO WSS-IND-CLNA-M(WSS-C,WSS-F).     
      *MHM-FIN 02-OCT-2008                                              
      *MHM-INI 07-OCT-2008                                              
           MOVE WSS-IND-LEN0        TO WSS-IND-LEN0-M(WSS-C,WSS-F).     
      *MHM-FIN 07-OCT-2008                                              
                                                                        
       NXT-CRG-CIC-NVLA.                                                
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-CRG-CIC-NVLA.                                      
       EXT-CRG-CIC-NVLA.                                                
           IF PGM-STAT-REC-OKS                                          
              MOVE FIO-END-BRW TO FIO-CMND                              
              PERFORM SGC-FIO-REC.                                      
       FIN-CRG-CIC-NVLA.                                                
           EXIT.                                                        
                                                                        
       CRG-CIC-NVLA-IDC SECTION.                                        
       INI-CRG-CIC-NVLA-IDC.                                            
           MOVE WSS-CIC-ICLI-CLG IN WSS-VARI TO WSS-CIC-ICLI-RDC.       
           MOVE 'CLF'                        TO WSS-COD-TOCF.           
           PERFORM VAL-CLF-IDC.                                         
           IF WSS-IND-STAT IN WSS-VARI = 'N'                            
              GO TO FIN-CRG-CIC-NVLA-IDC.                               
                                                                        
           MOVE WSS-CIC-ICLI-CLG IN WSS-VARI TO REC-CIC-ICLI IN REC.    
           MOVE WSS-COD-TREC IN WSS-VARI     TO REC-COD-TREC IN REC.    
           MOVE SPACES                       TO REC-CIC-IREL IN REC.    
           MOVE ZEROES                       TO REC-NUM-TREC IN REC.    
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-CRG-CIC-NVLA-IDC.                                            
           PERFORM SGC-FIO-REC.                                         
           MOVE FIO-STAT TO PGM-STAT-REC.                               
           IF NOT ( FIO-STAT-OKS AND                                    
              REC-CIC-ICLI IN REC = WSS-CIC-ICLI-CLG IN WSS-VARI AND    
              REC-COD-TREC IN REC = WSS-COD-TREC IN WSS-VARI )          
              GO TO EXT-CRG-CIC-NVLA-IDC.                               
                                                                        
           PERFORM VAL-REC.                                             
           IF WSS-IND-STAT IN WSS-VARI = 'N'                            
              GO TO NXT-CRG-CIC-NVLA-IDC.                               
                                                                        
           ADD 1 TO WSS-F IN WSS-VARI.                                  
           IF WSS-F IN WSS-VARI > WSS-FMAX IN WSS-VARI                  
              GO TO EXT-CRG-CIC-NVLA-IDC.                               
                                                                        
           MOVE WSS-C               TO WSS-IND-NVLN(WSS-C,WSS-F).       
           MOVE 'X'                 TO WSS-IND-TCLI(WSS-C,WSS-F).       
           MOVE WSS-CIC-ICLI-CLG    TO WSS-CIC-PDRE(WSS-C,WSS-F).       
           MOVE WSS-CIC-ICLI-CLG    TO WSS-CIC-NODO(WSS-C,WSS-F).       
           MOVE SPACES              TO WSS-COD-ADMI-M(WSS-C,WSS-F).     
           MOVE 100                 TO WSS-VAL-PROP(WSS-C,WSS-F).       
           MOVE CLF-CIC-ICLF IN CLF TO WSS-CIC-ICLF-M(WSS-C,WSS-F).     
      *MHM-INI 02-OCT-2008                                              
           MOVE WSS-IND-CLNA        TO WSS-IND-CLNA-M(WSS-C,WSS-F).     
      *MHM-FIN 02-OCT-2008                                              
      *MHM-INI 07-OCT-2008                                              
           MOVE WSS-IND-LEN0        TO WSS-IND-LEN0-M(WSS-C,WSS-F).     
      *MHM-FIN 07-OCT-2008                                              
           MOVE CLF-VAL-CMAX IN CLF TO WSS-VAL-MONE-CLG.                
           MOVE CLF-COD-VCCF IN CLF TO WSS-VCAM-CLG.                    
           PERFORM OBT-VAL-MNAC-CLG.                                    
           MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-MARC-M(WSS-C,WSS-F).        
           GO TO EXT-CRG-CIC-NVLA-IDC.                                  
       NXT-CRG-CIC-NVLA-IDC.                                            
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-CRG-CIC-NVLA-IDC.                                  
       EXT-CRG-CIC-NVLA-IDC.                                            
           IF PGM-STAT-REC-OKS                                          
              MOVE FIO-END-BRW TO FIO-CMND                              
              PERFORM SGC-FIO-REC.                                      
       FIN-CRG-CIC-NVLA-IDC.                                            
           EXIT.                                                        
                                                                        
       VAL-CLF-IDC SECTION.                                             
       INI-VAL-CLF-IDC.                                                 
      *MHM-INI 02-OCT-2008                                              
           MOVE SPACES TO WSS-IND-CLNA.                                 
      *MHM-FIN 02-OCT-2008                                              
      *MHM-INI 07-OCT-2008                                              
           MOVE SPACES TO WSS-IND-LEN0.                                 
      *MHM-FIN 07-OCT-2008                                              
           MOVE 'N'              TO WSS-IND-STAT IN WSS-VARI.           
      *XON-INI 02-JUN-2008                                              
           MOVE  SPACES          TO WSS-IND-RENO IN CLG-VARI.           
           MOVE  SPACES          TO WSS-IND-ING  IN CLG-VARI.           
           MOVE  SPACES          TO WSS-IND-ACT  IN CLG-VARI.           
           MOVE  SPACES          TO WSS-IND-CER  IN CLG-VARI.           
           MOVE  SPACES          TO WSS-IND-VRF  IN CLG-VARI.           
      *XON-FIN 02-JUN-2008                                              
           MOVE WSS-CIC-ICLI-RDC TO RDC-CIC-ICLI IN RDC.                
           MOVE SPACES           TO RDC-CIC-ICLF IN RDC.                
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM LDC-FIO-RDC.                                         
           MOVE FIO-STAT TO PGM-STAT-RDC.                               
           IF NOT ( FIO-STAT-OKS AND                                    
                    WSS-CIC-ICLI-RDC = RDC-CIC-ICLI IN RDC)             
               MOVE 'N' TO WSS-IND-STAT IN WSS-VARI                     
      *MHM-INI 07-OCT-2008                                              
               MOVE 'S' TO WSS-IND-LEN0                                 
      *MHM-FIN 07-OCT-2008                                              
               GO TO BRW-VAL-CLF-IDC.                                   
       LUP-VAL-CLF-IDC.                                                 
           MOVE RDC-CIC-ICLF IN RDC TO CLF-CIC-ICLF IN CLF.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM LDC-FIO-CLF.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO NXT-VAL-CLF-IDC.                                   
                                                                        
      *XON-INI 07-OCT-2008                                              
           IF  CLF-COD-TOCF IN CLF = 'CLF' AND                          
               WSS-COD-TOCF = 'CLF'  AND                                
              (CLF-MSC-STAT IN CLF = 'I' OR 'V' OR 'C')                 
               MOVE 'S' TO  WSS-IND-STAT IN WSS-VARI.                   
      *XON-FIN 07-OCT-2008                                              
      *XON-INI 02-JUN-2008                                              
      *CLF ACTIVADA-VIGENTE-CODIGO=CLF-CGE                              
      *    IF (CLF-MSC-STAT IN CLF = 'A' AND                            
      *        CLF-COD-TOCF IN CLF = WSS-COD-TOCF AND                   
      *       (CLF-FEC-FVEN IN CLF > HOY-FHOY OR                        
      *        CLF-FEC-FVEN IN CLF = HOY-FHOY OR                        
      *        CLF-FEC-FVEN IN CLF NOT > ZEROES ))                      
      *        MOVE 'S' TO WSS-IND-STAT IN WSS-VARI                     
      *        GO TO BRW-VAL-CLF-IDC.                                   
                                                                        
           IF CLF-MSC-STAT IN CLF = 'A' AND                             
              CLF-COD-TOCF IN CLF = WSS-COD-TOCF                        
               MOVE 'S' TO WSS-IND-STAT IN WSS-VARI                     
               MOVE 'S' TO WSS-IND-ACT  IN CLG-VARI                     
               GO TO BRW-VAL-CLF-IDC.                                   
                                                                        
           IF CLF-COD-TOCF IN CLF = 'CLF' AND WSS-COD-TOCF = 'CLF'      
               IF CLF-MSC-STAT IN CLF = 'C'                             
                   MOVE CLF TO WSS-GLS-CLFC IN CLG-VARI                 
                   MOVE 'S' TO WSS-IND-CER  IN CLG-VARI                 
               ELSE                                                     
               IF CLF-MSC-STAT IN CLF = 'R'                             
                   MOVE CLF TO WSS-GLS-CLFR IN CLG-VARI                 
                   MOVE 'S' TO WSS-IND-RENO IN CLG-VARI                 
               ELSE                                                     
               IF CLF-MSC-STAT IN CLF = 'I'                             
                   MOVE CLF TO WSS-GLS-CLFI IN CLG-VARI                 
                   MOVE 'S' TO WSS-IND-ING  IN CLG-VARI                 
               ELSE                                                     
               IF CLF-MSC-STAT IN CLF = 'V'                             
                   MOVE CLF TO WSS-GLS-CLFV IN CLG-VARI                 
                   MOVE 'S' TO WSS-IND-VRF  IN CLG-VARI.                
                                                                        
      *XON-FIN 02-JUN-2008                                              
                                                                        
       NXT-VAL-CLF-IDC.                                                 
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM LDC-FIO-RDC.                                         
           MOVE FIO-STAT TO PGM-STAT-RDC.                               
           IF FIO-STAT-OKS AND WSS-CIC-ICLI-RDC = RDC-CIC-ICLI IN RDC   
              GO TO LUP-VAL-CLF-IDC.                                    
                                                                        
      *XON-INI 02-JUN-2008                                              
           IF WSS-COD-TOCF NOT = 'CLF'                                  
               GO TO BRW-VAL-CLF-IDC.                                   
                                                                        
           IF WSS-IND-VRF IN CLG-VARI = 'S'                             
               MOVE  WSS-GLS-CLFV IN CLG-VARI TO CLF                    
               IF CLF-CIC-CREN IN CLF NOT > SPACES                      
                  MOVE 'S' TO WSS-IND-LEN0                              
                  GO TO BRW-VAL-CLF-IDC                                 
               ELSE                                                     
                  MOVE CLF-CIC-CREN IN CLF TO CLF-CIC-ICLF              
                  MOVE FIO-GET-KEY TO FIO-CMND                          
                  PERFORM LDC-FIO-CLF                                   
                  GO TO BRW-VAL-CLF-IDC.                                
                                                                        
           IF WSS-IND-ING IN CLG-VARI = 'S'                             
               MOVE  WSS-GLS-CLFI IN CLG-VARI TO CLF                    
               IF CLF-CIC-CREN IN CLF NOT > SPACES                      
                  MOVE 'S' TO WSS-IND-LEN0                              
                  GO TO BRW-VAL-CLF-IDC                                 
               ELSE                                                     
                  MOVE CLF-CIC-CREN IN CLF TO CLF-CIC-ICLF              
                  MOVE FIO-GET-KEY TO FIO-CMND                          
                  PERFORM LDC-FIO-CLF                                   
                  GO TO BRW-VAL-CLF-IDC.                                
                                                                        
           IF WSS-IND-CER IN CLG-VARI = 'S'                             
               MOVE 'S' TO WSS-IND-LEN0                                 
               MOVE  WSS-GLS-CLFC IN CLG-VARI TO CLF.                   
                                                                        
      *XON-FIN 02-JUN-2008                                              
       BRW-VAL-CLF-IDC.                                                 
           IF PGM-STAT-RDC-OKS                                          
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM LDC-FIO-RDC.                                     
      *MHM-INI 02-OCT-2008                                              
           IF CLF-MSC-STAT IN CLF NOT = 'A' AND                         
              CLF-MSC-STAT IN CLF NOT = 'C'                             
               MOVE 'S' TO WSS-IND-CLNA.                                
      *MHM-FIN 02-OCT-2008                                              
       FIN-VAL-CLF-IDC.                                                 
           EXIT.                                                        
                                                                        
                                                                        
       CRG-CIC-NVLN SECTION.                                            
       INI-CRG-CIC-NVLN.                                                
           MOVE ZEROES TO WSS-F IN WSS-VARI.                            
           MOVE ZEROES TO WSS-D IN WSS-VARI.                            
       LUP-CRG-CIC-NVLN.                                                
           ADD 1 TO WSS-D IN WSS-VARI.                                  
           IF WSS-CIC-NODO(WSS-ACT, WSS-D) NOT > SPACES                 
              GO TO FIN-CRG-CIC-NVLN.                                   
           IF WSS-CIC-NODO(WSS-ACT,WSS-D) = WSS-CIC-PDRE(WSS-ACT,WSS-D) 
              GO TO LUP-CRG-CIC-NVLN.                                   
                                                                        
           MOVE WSS-CIC-NODO(WSS-ACT, WSS-D) TO                         
                WSS-CIC-ICLI-CLG IN WSS-VARI.                           
                                                                        
           PERFORM CRG-CIC-NVLA-IDC.                                    
                                                                        
           MOVE WSS-CIC-ICLI-CLG IN WSS-VARI TO REC-CIC-ICLI IN REC.    
           MOVE WSS-COD-TREC IN WSS-VARI TO REC-COD-TREC IN REC.        
           MOVE SPACES                   TO REC-CIC-IREL IN REC.        
           MOVE ZEROES                   TO REC-NUM-TREC IN REC.        
           MOVE FIO-GET-NLS  TO FIO-CMND.                               
       LUP-CRG-CIC-ICLI.                                                
           PERFORM SGC-FIO-REC.                                         
           MOVE FIO-STAT TO PGM-STAT-REC.                               
           IF NOT ( FIO-STAT-OKS AND                                    
              REC-CIC-ICLI IN REC = WSS-CIC-ICLI-CLG IN WSS-VARI AND    
              REC-COD-TREC IN REC = WSS-COD-TREC IN WSS-VARI )          
              GO TO EXT-CRG-CIC-ICLI.                                   
                                                                        
           PERFORM VAL-REC.                                             
           IF WSS-IND-STAT IN WSS-VARI = 'N'                            
              GO TO NXT-CRG-CIC-ICLI.                                   
                                                                        
           ADD 1 TO WSS-F IN WSS-VARI.                                  
           IF WSS-F IN WSS-VARI > WSS-FMAX IN WSS-VARI                  
              GO TO EXT-CRG-CIC-NVLN.                                   
                                                                        
           MOVE WSS-C                  TO WSS-IND-NVLN(WSS-C,WSS-F).    
           MOVE 'E'                    TO WSS-IND-TCLI(WSS-C,WSS-F).    
           MOVE WSS-CIC-ICLI-CLG    TO WSS-CIC-PDRE(WSS-C,WSS-F).       
           MOVE REC-CIC-IREL IN REC    TO WSS-CIC-NODO(WSS-C,WSS-F).    
                                                                        
           MOVE WSS-CIC-NODO(WSS-C,WSS-F) TO  WSS-CIC-ICLI-RDC.         
           MOVE 'CLF'                     TO WSS-COD-TOCF.              
           PERFORM VAL-CLF-IDC.                                         
           IF WSS-IND-STAT IN WSS-VARI = 'N'                            
              MOVE ZEROES TO WSS-VAL-MARC-M(WSS-C,WSS-F)                
              MOVE SPACES TO WSS-CIC-ICLF-M(WSS-C,WSS-F)                
           ELSE                                                         
              MOVE CLF-CIC-ICLF IN CLF TO WSS-CIC-ICLF-M(WSS-C,WSS-F)   
              MOVE CLF-VAL-CMAX IN CLF TO WSS-VAL-MONE-CLG              
              MOVE CLF-COD-VCCF IN CLF TO WSS-VCAM-CLG                  
              PERFORM OBT-VAL-MNAC-CLG                                  
              MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-MARC-M(WSS-C,WSS-F).     
      *MHM-INI 02-OCT-2008                                              
           MOVE WSS-IND-CLNA        TO WSS-IND-CLNA-M(WSS-C,WSS-F).     
      *MHM-FIN 02-OCT-2008                                              
      *MHM-INI 07-OCT-2008                                              
           MOVE WSS-IND-LEN0        TO WSS-IND-LEN0-M(WSS-C,WSS-F).     
      *MHM-FIN 07-OCT-2008                                              
                                                                        
           IF WSS-CIC-NODO(WSS-C,WSS-F) =  WSS-CIC-ISLC IN WSS-VARI     
              MOVE WSS-CIC-PDRE(WSS-C,WSS-F) TO WSS-CIC-IGRP.           
                                                                        
           MOVE REC-COD-AREC IN REC    TO WSS-COD-ADMI-M(WSS-C,WSS-F).  
           MOVE ZEROES                 TO WSS-VAL-PROP(WSS-C,WSS-F).    
           ADD  REC-SGV-AREC IN REC    TO WSS-VAL-PROP(WSS-C,WSS-F).    
           MOVE 'S'                    TO WSS-IND-TCLI(WSS-ACT,WSS-D).  
       NXT-CRG-CIC-ICLI.                                                
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-CRG-CIC-ICLI.                                      
       EXT-CRG-CIC-ICLI.                                                
           IF PGM-STAT-REC-OKS                                          
              MOVE FIO-END-BRW TO FIO-CMND                              
              PERFORM SGC-FIO-REC.                                      
                                                                        
       NXT-CRG-CIC-NVLN.                                                
           GO TO LUP-CRG-CIC-NVLN.                                      
       EXT-CRG-CIC-NVLN.                                                
           IF PGM-STAT-REC-OKS                                          
              MOVE FIO-END-BRW TO FIO-CMND                              
              PERFORM SGC-FIO-REC.                                      
       FIN-CRG-CIC-NVLN.                                                
           EXIT.                                                        
                                                                        
       CRG-VAL-VEC SECTION.                                             
       INI-CRG-VAL-VEC.                                                 
           MOVE 1 TO WSS-I.                                             
       LUP-NVL-01.                                                      
           IF WSS-IND-TCLI(01,WSS-F01) = 'E' OR 'X'                     
              MOVE 1       TO WSS-C                                     
              MOVE WSS-F01 TO WSS-F                                     
              MOVE WSS-CIC-NODO(01,WSS-F01)   TO CCU-CIC-ICLI           
              MOVE WSS-CIC-ICLF-M(01,WSS-F01) TO CCU-CIC-ICLF           
              PERFORM CRG-VAL-PCCU                                      
                                                                        
ZX            IF SCR-IERR = 'S'                                         
ZX               GO TO EXT-CRG-VAL-VEC                                  
ZX            ELSE                                                      
                                                                        
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-01                                       
           ELSE                                                         
              MOVE 1       TO WSS-C                                     
              MOVE WSS-F01 TO WSS-F                                     
              PERFORM CRG-VEC-FRM.                                      
                                                                        
       LUP-NVL-02.                                                      
           IF WSS-CIC-PDRE(02,WSS-F02) = WSS-CIC-NODO(01,WSS-F01)       
              MOVE 2       TO WSS-C                                     
              MOVE WSS-F02 TO WSS-F                                     
              IF WSS-IND-TCLI(02,WSS-F02) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(02,WSS-F02)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(02,WSS-F02) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-02                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-01.                                         
                                                                        
       LUP-NVL-03.                                                      
           IF WSS-CIC-PDRE(03,WSS-F03) = WSS-CIC-NODO(02,WSS-F02)       
              MOVE 3       TO WSS-C                                     
              MOVE WSS-F03 TO WSS-F                                     
              IF WSS-IND-TCLI(03,WSS-F03) = 'E'  OR 'X'                 
                 MOVE WSS-CIC-NODO(03,WSS-F03)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(03,WSS-F03) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-03                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-02.                                         
                                                                        
       LUP-NVL-04.                                                      
           IF WSS-CIC-PDRE(04,WSS-F04) = WSS-CIC-NODO(03,WSS-F03)       
              MOVE 4       TO WSS-C                                     
              MOVE WSS-F04 TO WSS-F                                     
              IF WSS-IND-TCLI(04,WSS-F04) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(04,WSS-F04)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(04,WSS-F04) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-04                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-03.                                         
                                                                        
       LUP-NVL-05.                                                      
           IF WSS-CIC-PDRE(05,WSS-F05) = WSS-CIC-NODO(04,WSS-F04)       
              MOVE 5       TO WSS-C                                     
              MOVE WSS-F05 TO WSS-F                                     
              IF WSS-IND-TCLI(05,WSS-F05) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(05,WSS-F05)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(05,WSS-F05) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-05                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-04.                                         
                                                                        
       LUP-NVL-06.                                                      
           IF WSS-CIC-PDRE(06,WSS-F06) = WSS-CIC-NODO(05,WSS-F05)       
              MOVE 6       TO WSS-C                                     
              MOVE WSS-F06 TO WSS-F                                     
              IF WSS-IND-TCLI(06,WSS-F06) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(06,WSS-F06)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(06,WSS-F06) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-06                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-05.                                         
                                                                        
       LUP-NVL-07.                                                      
           IF WSS-CIC-PDRE(07,WSS-F07) = WSS-CIC-NODO(06,WSS-F06)       
              MOVE 7       TO WSS-C                                     
              MOVE WSS-F07 TO WSS-F                                     
              IF WSS-IND-TCLI(07,WSS-F07) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(07,WSS-F07)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(07,WSS-F07) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-07                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-06.                                         
                                                                        
       LUP-NVL-08.                                                      
           IF WSS-CIC-PDRE(08,WSS-F08) = WSS-CIC-NODO(07,WSS-F07)       
              MOVE 8       TO WSS-C                                     
              MOVE WSS-F08 TO WSS-F                                     
              IF WSS-IND-TCLI(08,WSS-F08) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(08,WSS-F08)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(08,WSS-F08) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-08                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-07.                                         
                                                                        
       LUP-NVL-09.                                                      
           IF WSS-CIC-PDRE(09,WSS-F09) = WSS-CIC-NODO(08,WSS-F08)       
              MOVE 9       TO WSS-C                                     
              MOVE WSS-F09 TO WSS-F                                     
              IF WSS-IND-TCLI(09,WSS-F09) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(09,WSS-F09)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(09,WSS-F09) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-09                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-08.                                         
                                                                        
       LUP-NVL-10.                                                      
           IF WSS-CIC-PDRE(10,WSS-F10) = WSS-CIC-NODO(09,WSS-F09)       
              MOVE 10      TO WSS-C                                     
              MOVE WSS-F10 TO WSS-F                                     
              IF WSS-IND-TCLI(10,WSS-F10) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(10,WSS-F10)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(10,WSS-F10) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-10                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-09.                                         
                                                                        
       LUP-NVL-11.                                                      
           IF WSS-CIC-PDRE(11,WSS-F11) = WSS-CIC-NODO(10,WSS-F10)       
              MOVE 11      TO WSS-C                                     
              MOVE WSS-F11 TO WSS-F                                     
              IF WSS-IND-TCLI(11,WSS-F11) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(11,WSS-F11)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(11,WSS-F11) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-11                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-10.                                         
                                                                        
       LUP-NVL-12.                                                      
           IF WSS-CIC-PDRE(12,WSS-F12) = WSS-CIC-NODO(11,WSS-F11)       
              MOVE 12      TO WSS-C                                     
              MOVE WSS-F12 TO WSS-F                                     
              IF WSS-IND-TCLI(12,WSS-F12) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(12,WSS-F12)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(12,WSS-F12) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-12                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-11.                                         
                                                                        
       LUP-NVL-13.                                                      
           IF WSS-CIC-PDRE(13,WSS-F13) = WSS-CIC-NODO(12,WSS-F12)       
              MOVE 13      TO WSS-C                                     
              MOVE WSS-F13 TO WSS-F                                     
              IF WSS-IND-TCLI(13,WSS-F13) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(13,WSS-F13)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(13,WSS-F13) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-13                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-12.                                         
                                                                        
       LUP-NVL-14.                                                      
           IF WSS-CIC-PDRE(14,WSS-F14) = WSS-CIC-NODO(13,WSS-F13)       
              MOVE 14      TO WSS-C                                     
              MOVE WSS-F14 TO WSS-F                                     
              IF WSS-IND-TCLI(14,WSS-F14) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(14,WSS-F14)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(14,WSS-F14) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-14                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-13.                                         
                                                                        
       LUP-NVL-15.                                                      
           IF WSS-CIC-PDRE(15,WSS-F15) = WSS-CIC-NODO(14,WSS-F14)       
              MOVE 15      TO WSS-C                                     
              MOVE WSS-F15 TO WSS-F                                     
              IF WSS-IND-TCLI(15,WSS-F15) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(15,WSS-F15)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(15,WSS-F15) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                    GO TO NXT-NVL-15                                    
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-14.                                         
                                                                        
       LUP-NVL-16.                                                      
           IF WSS-CIC-PDRE(16,WSS-F16) = WSS-CIC-NODO(15,WSS-F15)       
              MOVE 16      TO WSS-C                                     
              MOVE WSS-F16 TO WSS-F                                     
              IF WSS-IND-TCLI(16,WSS-F16) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(16,WSS-F16)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(16,WSS-F16) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-16                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-15.                                         
                                                                        
       LUP-NVL-17.                                                      
           IF WSS-CIC-PDRE(17,WSS-F17) = WSS-CIC-NODO(16,WSS-F16)       
              MOVE 17      TO WSS-C                                     
              MOVE WSS-F17 TO WSS-F                                     
              IF WSS-IND-TCLI(17,WSS-F17) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(17,WSS-F17)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(17,WSS-F17) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-17                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-16.                                         
                                                                        
       LUP-NVL-18.                                                      
           IF WSS-CIC-PDRE(18,WSS-F18) = WSS-CIC-NODO(17,WSS-F17)       
              MOVE 18      TO WSS-C                                     
              MOVE WSS-F18 TO WSS-F                                     
              IF WSS-IND-TCLI(18,WSS-F18) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(18,WSS-F18)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(18,WSS-F18) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-18                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-17.                                         
                                                                        
       LUP-NVL-19.                                                      
           IF WSS-CIC-PDRE(19,WSS-F19) = WSS-CIC-NODO(18,WSS-F18)       
              MOVE 19      TO WSS-C                                     
              MOVE WSS-F19 TO WSS-F                                     
              IF WSS-IND-TCLI(19,WSS-F19) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(19,WSS-F19)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(19,WSS-F19) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-19                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-18.                                         
                                                                        
       LUP-NVL-20.                                                      
           IF WSS-CIC-PDRE(20,WSS-F20) = WSS-CIC-NODO(19,WSS-F19)       
              MOVE 20      TO WSS-C                                     
              MOVE WSS-F20 TO WSS-F                                     
              IF WSS-IND-TCLI(20,WSS-F20) = 'E' OR 'X'                  
                 MOVE WSS-CIC-NODO(20,WSS-F20)   TO CCU-CIC-ICLI        
                 MOVE WSS-CIC-ICLF-M(20,WSS-F20) TO CCU-CIC-ICLF        
                 PERFORM CRG-VAL-PCCU                                   
                 PERFORM CRG-VEC-FRM                                    
                 GO TO NXT-NVL-20                                       
              ELSE                                                      
                 PERFORM CRG-VEC-FRM                                    
           ELSE                                                         
              GO TO NXT-NVL-19.                                         
                                                                        
       NXT-NVL-20.                                                      
           ADD 1 TO WSS-F20.                                            
           IF WSS-F20 > WSS-FMAX OR                                     
              WSS-CIC-NODO(20,WSS-F20) NOT > SPACES                     
              GO TO FIN-NVL-20.                                         
           GO TO LUP-NVL-20.                                            
       FIN-NVL-20.                                                      
                                                                        
       NXT-NVL-19.                                                      
           ADD 1 TO WSS-F19.                                            
           IF WSS-F19 > WSS-FMAX OR                                     
              WSS-CIC-NODO(19,WSS-F19) NOT > SPACES                     
              GO TO FIN-NVL-19.                                         
           GO TO LUP-NVL-19.                                            
       FIN-NVL-19.                                                      
                                                                        
       NXT-NVL-18.                                                      
           ADD 1 TO WSS-F18.                                            
           IF WSS-F18 > WSS-FMAX OR                                     
              WSS-CIC-NODO(18,WSS-F18) NOT > SPACES                     
              GO TO FIN-NVL-18.                                         
           GO TO LUP-NVL-18.                                            
       FIN-NVL-18.                                                      
                                                                        
       NXT-NVL-17.                                                      
           ADD 1 TO WSS-F17.                                            
           IF WSS-F17 > WSS-FMAX OR                                     
              WSS-CIC-NODO(17,WSS-F17) NOT > SPACES                     
              GO TO FIN-NVL-17.                                         
           GO TO LUP-NVL-17.                                            
       FIN-NVL-17.                                                      
                                                                        
       NXT-NVL-16.                                                      
           ADD 1 TO WSS-F16.                                            
           IF WSS-F16 > WSS-FMAX OR                                     
              WSS-CIC-NODO(16,WSS-F16) NOT > SPACES                     
              GO TO FIN-NVL-16.                                         
           GO TO LUP-NVL-16.                                            
       FIN-NVL-16.                                                      
                                                                        
       NXT-NVL-15.                                                      
           ADD 1 TO WSS-F15.                                            
           IF WSS-F15 > WSS-FMAX OR                                     
              WSS-CIC-NODO(15,WSS-F15) NOT > SPACES                     
              GO TO FIN-NVL-15.                                         
           GO TO LUP-NVL-15.                                            
       FIN-NVL-15.                                                      
                                                                        
       NXT-NVL-14.                                                      
           ADD 1 TO WSS-F14.                                            
           IF WSS-F14 > WSS-FMAX OR                                     
              WSS-CIC-NODO(14,WSS-F14) NOT > SPACES                     
              GO TO FIN-NVL-14.                                         
           GO TO LUP-NVL-14.                                            
       FIN-NVL-14.                                                      
                                                                        
       NXT-NVL-13.                                                      
           ADD 1 TO WSS-F13.                                            
           IF WSS-F13 > WSS-FMAX OR                                     
              WSS-CIC-NODO(13,WSS-F13) NOT > SPACES                     
              GO TO FIN-NVL-13.                                         
           GO TO LUP-NVL-13.                                            
       FIN-NVL-13.                                                      
                                                                        
       NXT-NVL-12.                                                      
           ADD 1 TO WSS-F12.                                            
           IF WSS-F12 > WSS-FMAX OR                                     
              WSS-CIC-NODO(12,WSS-F12) NOT > SPACES                     
              GO TO FIN-NVL-12.                                         
           GO TO LUP-NVL-12.                                            
       FIN-NVL-12.                                                      
                                                                        
       NXT-NVL-11.                                                      
           ADD 1 TO WSS-F11.                                            
           IF WSS-F11 > WSS-FMAX OR                                     
              WSS-CIC-NODO(11,WSS-F11) NOT > SPACES                     
              GO TO FIN-NVL-11.                                         
           GO TO LUP-NVL-11.                                            
       FIN-NVL-11.                                                      
                                                                        
       NXT-NVL-10.                                                      
           ADD 1 TO WSS-F10.                                            
           IF WSS-F10 > WSS-FMAX OR                                     
              WSS-CIC-NODO(10,WSS-F10) NOT > SPACES                     
              GO TO FIN-NVL-10.                                         
           GO TO LUP-NVL-10.                                            
       FIN-NVL-10.                                                      
                                                                        
       NXT-NVL-09.                                                      
           ADD 1 TO WSS-F09.                                            
           IF WSS-F09 > WSS-FMAX OR                                     
              WSS-CIC-NODO(9,WSS-F09) NOT > SPACES                      
              GO TO FIN-NVL-09.                                         
           GO TO LUP-NVL-09.                                            
       FIN-NVL-09.                                                      
                                                                        
       NXT-NVL-08.                                                      
           ADD 1 TO WSS-F08.                                            
           IF WSS-F08 > WSS-FMAX OR                                     
              WSS-CIC-NODO(8,WSS-F08) NOT > SPACES                      
              GO TO FIN-NVL-08.                                         
           GO TO LUP-NVL-08.                                            
       FIN-NVL-08.                                                      
                                                                        
       NXT-NVL-07.                                                      
           ADD 1 TO WSS-F07.                                            
           IF WSS-F07 > WSS-FMAX OR                                     
              WSS-CIC-NODO(7,WSS-F07) NOT > SPACES                      
              GO TO FIN-NVL-07.                                         
           GO TO LUP-NVL-07.                                            
       FIN-NVL-07.                                                      
                                                                        
       NXT-NVL-06.                                                      
           ADD 1 TO WSS-F06.                                            
           IF WSS-F06 > WSS-FMAX OR                                     
              WSS-CIC-NODO(6,WSS-F06) NOT > SPACES                      
              GO TO FIN-NVL-06.                                         
           GO TO LUP-NVL-06.                                            
       FIN-NVL-06.                                                      
                                                                        
       NXT-NVL-05.                                                      
           ADD 1 TO WSS-F05.                                            
           IF WSS-F05 > WSS-FMAX OR                                     
              WSS-CIC-NODO(5,WSS-F05) NOT > SPACES                      
              GO TO FIN-NVL-05.                                         
           GO TO LUP-NVL-05.                                            
       FIN-NVL-05.                                                      
                                                                        
       NXT-NVL-04.                                                      
           ADD 1 TO WSS-F04.                                            
           IF WSS-F04 > WSS-FMAX OR                                     
              WSS-CIC-NODO(4,WSS-F04) NOT > SPACES                      
              GO TO FIN-NVL-04.                                         
           GO TO LUP-NVL-04.                                            
       FIN-NVL-04.                                                      
                                                                        
       NXT-NVL-03.                                                      
           ADD 1 TO WSS-F03.                                            
           IF WSS-F03 > WSS-FMAX OR                                     
              WSS-CIC-NODO(3,WSS-F03) NOT > SPACES                      
              GO TO FIN-NVL-03.                                         
           GO TO LUP-NVL-03.                                            
       FIN-NVL-03.                                                      
                                                                        
       NXT-NVL-02.                                                      
           ADD 1 TO WSS-F02.                                            
           IF WSS-F02 > WSS-FMAX OR                                     
              WSS-CIC-NODO(2,WSS-F02) NOT > SPACES                      
              GO TO FIN-NVL-02.                                         
           GO TO LUP-NVL-02.                                            
       FIN-NVL-02.                                                      
                                                                        
       NXT-NVL-01.                                                      
           ADD 1 TO WSS-F01.                                            
           IF WSS-F01 > WSS-FMAX OR                                     
              WSS-CIC-NODO(1,WSS-F01) NOT > SPACES                      
              GO TO FIN-CRG-VAL-VEC.                                    
           GO TO LUP-NVL-01.                                            
       FIN-CRG-VAL-VEC.                                                 
           MOVE MPC-N TO MPC-NMAX.                                      
       EXT-CRG-VAL-VEC.                                                 
           EXIT.                                                        
                                                                        
       CRG-VAL-PCCU SECTION.                                            
       INI-CRG-VAL-PCCU.                                                
GGG        MOVE 'N' TO WSS-IND-SOCU                                     
           IF WSS-CIC-ISLC IN WSS-VARI = CCU-CIC-ICLI IN CCU-VARI       
              PERFORM CRG-SLC-CCU                                       
              MOVE 'S' TO MPC-IND-CGAR                                  
      *INI AFRI MAY 2007                                                
              MOVE 'S' TO WSS-IND-SOCU                                  
      *FIN AFRI MYT 2007                                                
              PERFORM CRG-VEC-CLG                                       
      *AFRI-ini OCT 2006                                                
      *       PERFORM CRG-VEC-FRM                                       
      *AFRI-FIN OCT 2006                                                
              GO TO FIN-CRG-VAL-PCCU.                                   
                                                                        
           IF CCU-CIC-ICLF IN CCU-VARI > SPACES                         
              PERFORM PRO-CCU-MULT                                      
           ELSE                                                         
              MOVE ZEROES TO CTOT-MPC(1)                                
              MOVE 'S'    TO MPC-IND-CGAR                               
      *INI AFRI MAY 2007                                                
              MOVE 'N' TO WSS-IND-SOCU                                  
      *FIN AFRI MYT 2007                                                
              PERFORM CRG-VEC-CLG.                                      
                                                                        
       FIN-CRG-VAL-PCCU.                                                
           EXIT.                                                        
                                                                        
       CRG-VEC-CLG SECTION.                                             
       INI-CRG-VEC-CLG.                                                 
           MOVE ZEROES TO WSS-VAL-UTL-E.                                
           MOVE ZEROES TO WSS-K IN WSS-VARI.                            
       LUP-CRG-VEC-CLG.                                                 
           ADD 1 TO WSS-K IN WSS-VARI.                                  
           IF WSS-K IN WSS-VARI > WSS-KMAX IN WSS-VARI OR               
              CTOT-MPC(WSS-K) NOT > ZEROES OR                           
              CTOT-MPC(WSS-K) NOT NUMERIC                               
              GO TO CNT-CRG-VEC-CLG.                                    
                                                                        
           ADD CTOT-MPC(WSS-K) TO WSS-VAL-CAPR(WSS-C,WSS-F).            
           ADD CUTI-MPC(WSS-K) TO WSS-VAL-CUTI(WSS-C,WSS-F).            
           ADD CDIS-MPC(WSS-K) TO WSS-VAL-CDIS(WSS-C,WSS-F).            
                                                                        
      *AFRI-INI/MAYO-2007 (MAE - ALD)                                   
GGX                                                                     
           IF WSS-IND-SOCU = 'S'                                        
              IF TIPO-MPC(WSS-K) = 'GLB'                                
                 MOVE 'LBR' TO TIPO-MPC(WSS-K)                          
              END-IF                                                    
              IF TIPO-MPC(WSS-K) NOT > SPACES                           
                 MOVE 'LBR' TO TIPO-MPC(WSS-K)                          
              END-IF                                                    
              MOVE 'LDC'           TO FIO-SIST                          
              MOVE 'TLC'           TO TAB-COD-TTAB IN TAB               
              MOVE TIPO-MPC(WSS-K) TO TAB-COD-CTAB IN TAB               
              MOVE FIO-GET-KEY     TO FIO-CMND                          
              PERFORM GNS-FIO-TAB                                       
              MOVE TAB-COD-DAT3(10) TO TIPO-MPC(WSS-K).                 
      *AFRI-FIN/MAYO-2007 (MAE - ALD)                                   
      *TOTALES SEGUN UNIDAD DE NEGOCIO                                  
           IF TIPO-MPC(WSS-K) = 'CDB'                                   
              ADD CTOT-MPC(WSS-K) TO WSS-VAL-APRI IN WSS-VARI           
              ADD CUTI-MPC(WSS-K) TO WSS-VAL-UTLI IN WSS-VARI           
              ADD CDIS-MPC(WSS-K) TO WSS-VAL-DISI IN WSS-VARI           
           ELSE                                                         
           IF TIPO-MPC(WSS-K) = 'AFM'                                   
              ADD CTOT-MPC(WSS-K) TO WSS-VAL-APRA IN WSS-VARI           
              ADD CUTI-MPC(WSS-K) TO WSS-VAL-UTLA IN WSS-VARI           
              ADD CDIS-MPC(WSS-K) TO WSS-VAL-DISA IN WSS-VARI           
           ELSE                                                         
           IF TIPO-MPC(WSS-K) = 'MDD'                                   
              ADD CTOT-MPC(WSS-K) TO WSS-VAL-APRM IN WSS-VARI           
              ADD CUTI-MPC(WSS-K) TO WSS-VAL-UTLM IN WSS-VARI           
              ADD CDIS-MPC(WSS-K) TO WSS-VAL-DISM IN WSS-VARI           
           ELSE                                                         
           IF TIPO-MPC(WSS-K) = 'LSG'                                   
              ADD CTOT-MPC(WSS-K) TO WSS-VAL-APRL IN WSS-VARI           
              ADD CUTI-MPC(WSS-K) TO WSS-VAL-UTLL IN WSS-VARI           
              ADD CDIS-MPC(WSS-K) TO WSS-VAL-DISL IN WSS-VARI           
           ELSE                                                         
           IF TIPO-MPC(WSS-K) = 'FAC'                                   
              ADD CTOT-MPC(WSS-K) TO WSS-VAL-APRF IN WSS-VARI           
              ADD CUTI-MPC(WSS-K) TO WSS-VAL-UTLF IN WSS-VARI           
              ADD CDIS-MPC(WSS-K) TO WSS-VAL-DISF IN WSS-VARI           
           ELSE                                                         
              ADD CTOT-MPC(WSS-K) TO WSS-VAL-APRB IN WSS-VARI           
              ADD CUTI-MPC(WSS-K) TO WSS-VAL-UTLB IN WSS-VARI           
              ADD CDIS-MPC(WSS-K) TO WSS-VAL-DISB IN WSS-VARI.          
                                                                        
           ADD CUTI-MPC(WSS-K) TO WSS-VAL-UTL-E.                        
           ADD CDIS-MPC(WSS-K) TO WSS-VAL-DISG IN WSS-VARI.             
       NXT-CRG-VEC-CLG.                                                 
           GO TO LUP-CRG-VEC-CLG.                                       
       CNT-CRG-VEC-CLG.                                                 
           PERFORM ACU-TOT-UTL-CLG.                                     
           IF MPC-IND-CGAR = 'N'                                        
              MOVE MPC-VAL-GARE TO WSS-VAL-GARE IN WSS-VARI             
           ELSE                                                         
              MOVE ZEROES       TO WSS-VAL-GARE IN WSS-VARI             
              PERFORM CARGA-GAR.                                        
           MOVE WSS-VAL-GARE IN WSS-VARI TO WSS-VAL-TGAR(WSS-C,WSS-F).  
      *SUMA MONTO SIMULADO A UTILIZADO POR EMPRESA                      
           IF WSS-CIC-ISLC IN WSS-VARI = CCU-CIC-ICLI IN CCU-VARI       
              ADD WSS-VAL-MTSM IN WSS-VARI TO WSS-VAL-CUTI(WSS-C,WSS-F).
       FIN-CRG-VEC-CLG.                                                 
           EXIT.                                                        
                                                                        
       PRO-CCU-MULT SECTION.                                            
       INI-PRO-CCU-MULT.                                                
           ADD 1    TO MPC-N.                                           
           MOVE 'N' TO MPC-STAT(MPC-N).                                 
                                                                        
           MOVE CCU-CIC-ICLF IN CCU-VARI TO MPC-CIC-ICLF.               
           MOVE CCU-CIC-ICLI IN CCU-VARI TO MPC-CIC-CLIC.               
           MOVE WSS-C        TO MPC-NUM-COLC.                           
           MOVE WSS-F        TO MPC-NUM-FILC.                           
           MOVE WSS-I        TO MPC-NUM-POSC.                           
           MOVE CCU-COD-PESO IN CCU-VARI TO MPC-COD-PESO.               
           MOVE WSS-COD-UEFES            TO MPC-COD-UEFE.               
           MOVE WSS-SGV-UEFES            TO MPC-SGV-UEFE.               
           MOVE WSS-COD-REAL IN WSS-VARI TO MPC-COD-REAL.               
           MOVE SPACES                   TO MPC-IND-TPRO                
           MOVE ZEROES                   TO MPC-NUM-TPRO                
           MOVE SPACES                   TO MPC-GLS-DISP.               
           MOVE MPC-N                    TO MPC-NUM-CORR.               
                                                                        
           MOVE MPC-N        TO MPC-NUM-CORR-K.                         
      * GVI-INI mod. MEC 30-OCT-2006                                    
           IF WSS-CLI-PESADO  AND WSS-GET-RTK                           
              PERFORM CRG-RTK-MPC                                       
              IF WSS-RTK-OK                                             
                 MOVE WSS-I TO WSS-G                                    
                 PERFORM TOT-RTK-DMPC                                   
                 MOVE WSS-G TO WSS-I                                    
                 GO TO FIN-PRO-CCU-MULT                                 
              ELSE                                                      
                 GO TO FIN-PRO-CCU-MULT.                                
                                                                        
           IF WSS-CLI-PESADO  AND WSS-PUT-PTK AND MPC-N = 1             
              PERFORM ACT-ITK-TCKT.                                     
                                                                        
ZX         IF SCR-IERR = 'S'                                            
ZX            GO TO FIN-PRO-CCU-MULT.                                   
                                                                        
           IF WSS-CLI-PESADO  AND WSS-PUT-PTK                           
              PERFORM INS-PTK-CCU                                       
              GO TO FIN-PRO-CCU-MULT.                                   
      * GVI-FIN                                                         
           MOVE MPC-NOM-KMPC TO QUE-COLA.                               
           MOVE +1           TO QUE-LITM.                               
           MOVE +1           TO QUE-NITM.                               
           MOVE 'S'          TO QUE-ITEM.                               
           MOVE QUE-PUT      TO QUE-CMND.                               
           PERFORM GNS-PRO-QUE.                                         
           MOVE SCR-QIDD                 TO MPC-QIDD.                   
           MOVE SCR-LIDD                 TO MPC-LIDD.                   
           MOVE FIO-MSFL                 TO MPC-MSFL.                   
           MOVE MPC-CMMA                 TO SYS-CMMA.                   
           MOVE MPC-TCMA                 TO SYS-TCMA.                   
      *PROGRAMA=LDCPPMPC                                                
           EXEC CICS START                                              
                TRANSID( 'DQ71' )                                       
                FROM   ( SYS-CMMA )                                     
                LENGTH ( SYS-TCMA )                                     
           END-EXEC.                                                    
       FIN-PRO-CCU-MULT.                                                
           EXIT.                                                        
                                                                        
       CRG-VEC-FRM SECTION.                                             
       INI-CRG-VEC-FRM.                                                 
           MOVE WSS-I TO WSS-IND-SGRP(WSS-C,WSS-F).                     
           MOVE WSS-IND-NVLN(WSS-C,WSS-F)   TO WSS-IND-NVLN-CLG(WSS-I). 
           MOVE WSS-IND-TCLI(WSS-C,WSS-F)   TO WSS-IND-TLNK-CLG(WSS-I). 
           MOVE WSS-CIC-PDRE(WSS-C,WSS-F)   TO WSS-CIC-PDRE-CLG(WSS-I). 
           MOVE WSS-CIC-NODO(WSS-C,WSS-F)   TO WSS-CIC-NODO-CLG(WSS-I). 
           MOVE WSS-VAL-PROP(WSS-C,WSS-F)   TO WSS-VAL-PROP-CLG(WSS-I). 
           MOVE WSS-COD-ADMI-M(WSS-C,WSS-F) TO WSS-COD-ADMI-CLG(WSS-I). 
           MOVE WSS-VAL-MARC-M(WSS-C,WSS-F) TO WSS-VAL-MARC-CLG(WSS-I). 
           IF WSS-IND-TCLI(WSS-C,WSS-F) = 'E' OR 'X'                    
              MOVE WSS-VAL-CAPR(WSS-C,WSS-F) TO WSS-VAL-CAPR-CLG(WSS-I) 
              MOVE WSS-VAL-CUTI(WSS-C,WSS-F) TO WSS-VAL-CUTI-CLG(WSS-I) 
              MOVE WSS-VAL-CDIS(WSS-C,WSS-F) TO WSS-VAL-CDIS-CLG(WSS-I) 
              MOVE WSS-VAL-TGAR(WSS-C,WSS-F) TO WSS-VAL-GARS-CLG(WSS-I) 
      *MHM-INI 02-OCT-2008                                              
              MOVE WSS-IND-CLNA-M(WSS-C,WSS-F)                          
                                             TO WSS-IND-CLNA-CLG(WSS-I) 
      *MHM-FIN 02-OCT-2008                                              
      *MHM-INI 07-OCT-2008                                              
              MOVE WSS-IND-LEN0-M(WSS-C,WSS-F)                          
                                             TO WSS-IND-LEN0-CLG(WSS-I) 
      *MHM-FIN 07-OCT-2008                                              
              GO TO FIN-CRG-VEC-FRM.                                    
                                                                        
           MOVE WSS-CIC-NODO-CLG(WSS-I) TO WSS-CIC-ICLI-RDC.            
           MOVE 'CGE'                   TO WSS-COD-TOCF.                
           PERFORM VAL-CLF-IDC.                                         
           IF WSS-IND-STAT IN WSS-VARI = 'N'                            
              MOVE ZEROES TO WSS-VAL-MARC-CLG(WSS-I)                    
           ELSE                                                         
              MOVE CLF-VAL-CMAX IN CLF TO WSS-VAL-MONE-CLG              
              MOVE CLF-COD-VCCF IN CLF TO WSS-VCAM-CLG                  
              PERFORM OBT-VAL-MNAC-CLG                                  
              MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-MARC-CLG(WSS-I).         
       FIN-CRG-VEC-FRM.                                                 
           ADD 1 TO WSS-I.                                              
       EXT-CRG-VEC-FRM.                                                 
           EXIT.                                                        
                                                                        
       OBT-CLF-ICLI SECTION.                                            
       INI-OBT-CLF-ICLI.                                                
           MOVE WSS-CAI-ICLI-G IN WSS-VARI TO                           
                CCU-CAI-ICLI IN CCU-VARI.                               
           MOVE WSS-IIC-ICLI-G IN WSS-VARI TO                           
                CCU-IIC-ICLI IN CCU-VARI.                               
           PERFORM BUS-CLI-CLF.                                         
           IF CCU-COD-MENS > SPACES                                     
              MOVE ZEROES TO WSS-VAL-MNAC-CLG IN WSS-VARI               
           ELSE                                                         
              MOVE CLF-VAL-CMAX IN CLF TO WSS-VAL-MONE-CLG              
              MOVE CLF-COD-VCCF IN CLF TO WSS-VCAM-CLG                  
              PERFORM OBT-VAL-MNAC-CLG.                                 
       FIN-OBT-CLF-ICLI.                                                
           EXIT.                                                        
                                                                        
       BUS-CLI-CLF SECTION.                                             
       INI-BUS-CLI-CLF.                                                 
           MOVE 99      TO CCU-NUM-MENS.                                
           MOVE 99      TO CCU-NUM-MEN2.                                
                                                                        
           MOVE SPACES  TO CCU-COD-MENS                                 
                           CCU-COD-MEN2                                 
                           CCU-COD-SIST.                                
                                                                        
           MOVE CCU-CIC-ICLI IN CCU-VARI TO RDC-CIC-ICLI IN RDC.        
           MOVE LOW-VALUES               TO RDC-KEY-ICLF IN RDC.        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM LDC-FIO-RDC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    RDC-CIC-ICLI IN RDC = CCU-CIC-ICLI IN CCU-VARI )    
              MOVE 'RDC    NEX' TO CCU-COD-MENS                         
              MOVE 20           TO CCU-NUM-MENS                         
              IF FIO-STAT-OKS                                           
                 MOVE FIO-END-BRW TO FIO-CMND                           
                 PERFORM LDC-FIO-RDC.                                   
                                                                        
           IF CCU-COD-MENS NOT = 'RDC    NEX'                           
              GO TO LUP-BUS-CLI-CLF.                                    
           IF CCU-CAI-IOPC IN CCU-VARI(1) NOT > SPACES OR               
              CCU-IIC-IOPC IN CCU-VARI(1) = ZEROES                      
              GO TO FIN-BUS-CLI-CLF.                                    
       NO-ERROR-CLF-NEX.                                                
           MOVE 51 TO CCU-NUM-MENS.                                     
           GO TO FIN-BUS-CLI-CLF.                                       
       LUP-BUS-CLI-CLF.                                                 
           MOVE RDC-KEY-ICLF IN RDC TO CCU-CIC-ICLF IN CCU-VARI.        
           PERFORM BUS-CLF.                                             
           IF NOT FIO-STAT-OKS OR                                       
              FIO-STAT-OKS AND CCU-NUM-MENS = 99                        
               GO TO FIN-BUS-CLI-CLF.                                   
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM LDC-FIO-RDC.                                         
           IF FIO-STAT-OKS AND                                          
              RDC-CIC-ICLI IN RDC = CCU-CIC-ICLI IN CCU-VARI            
               GO TO LUP-BUS-CLI-CLF.                                   
       FIN-BUS-CLI-CLF.                                                 
           EXIT.                                                        
                                                                        
       BUS-CLF SECTION.                                                 
       INI-BUS-CLF.                                                     
           MOVE CCU-CIC-ICLF IN CCU-VARI TO CLF-KEY-ICLF IN CLF.        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM LDC-FIO-CLF.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'CLF    NEX' TO CCU-COD-MENS                        
               MOVE 1            TO CCU-NUM-MENS                        
               GO TO FIN-BUS-CLF.                                       
                                                                        
           IF ( CLF-COD-STAT IN CLF = 'M' OR 'X' )                      
              AND CCU-IIC-IOPC(1) > ZEROES                              
                   OR                                                   
              ( CLF-COD-STAT IN CLF = 'M' OR 'X' ) AND                  
              CCU-IIC-IOPC(1) NOT > ZEROES AND CLF-MSC-STAT NOT = 'V'   
               MOVE CLF-CIC-CREN IN CLF TO CLF-KEY-ICLF IN CLF          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM LDC-FIO-CLF                                      
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'CLF    NEX' TO CCU-COD-MENS                    
                   MOVE 1            TO CCU-NUM-MENS                    
                   GO TO FIN-BUS-CLF                                    
               ELSE                                                     
                   MOVE 'A' TO CLF-MSC-STAT IN CLF                      
                   MOVE 'CLFREN-' TO CCU-COD-TMSG                       
                   MOVE 'M'       TO CCU-COD-CMSG                       
                   MOVE 51        TO CCU-NUM-MENS.                      
                                                                        
           IF CLF-FEC-FVEN IN CLF NOT > HOY-FHOY                        
               MOVE 'CLF    NOVIG' TO CCU-COD-MENS                      
               MOVE 2              TO CCU-NUM-MENS                      
               GO TO FIN-BUS-CLF.                                       
                                                                        
           IF CLF-MSC-STAT IN CLF = 'V' AND                             
              CCU-IIC-IOPC(1) NOT > ZEROES                              
               MOVE 'CLF    NOACA' TO CCU-COD-MENS                      
               MOVE 51             TO CCU-NUM-MENS                      
               GO TO FIN-BUS-CLF.                                       
                                                                        
           IF CLF-MSC-STAT IN CLF NOT = 'A'                             
               AND CCU-ESTA NOT > SPACES                                
      *XON-INI 02-JUN-2008                                              
               AND CLF-MSC-STAT IN CLF NOT = 'R'                        
      *XON-FIN 02-JUN-2008                                              
               MOVE 'CLF    NOVIG' TO CCU-COD-MENS                      
               MOVE 2              TO CCU-NUM-MENS                      
               GO TO FIN-BUS-CLF.                                       
                                                                        
           IF CCU-ESTA > SPACES AND                                     
              CLF-MSC-STAT IN CLF NOT = CCU-ESTA                        
               MOVE 'CLFSTATNOVAL' TO CCU-COD-MENS                      
               MOVE 2              TO CCU-NUM-MENS                      
               GO TO FIN-BUS-CLF.                                       
                                                                        
      *MHM-INI 20-ABR-2004                                              
           IF ( WSS-IND-GRPO IN WSS-VARI = 'G' OR                       
                WSS-IND-TLNK-CLG(WSS-J) = 'S' OR                        
                WSS-IND-TLNK-CLG(WSS-J) = 'G' ) AND                     
                CLF-COD-TOCF IN CLF NOT = 'CGE'                         
               MOVE 'CLF    NOACA' TO CCU-COD-MENS                      
               MOVE 2              TO CCU-NUM-MENS                      
               GO TO FIN-BUS-CLF.                                       
      *MHM-FIN 20-ABR-2004                                              
                                                                        
           MOVE 99     TO CCU-NUM-MENS.                                 
           MOVE SPACES TO CCU-COD-MENS.                                 
       FIN-BUS-CLF.                                                     
           EXIT.                                                        
                                                                        
       OBT-VAL-MNAC-CLG SECTION.                                        
       INI-OBT-VAL-MNAC-CLG.                                            
      * Transforma monto a moneda corriente del dia                     
           MOVE WSS-VAL-MONE-CLG TO WSS-VAL-MNAC-CLG.                   
           IF WSS-VCAM-CLG > SPACES AND                                 
              WSS-VCAM-CLG NOT = WSS-COD-PESOS AND                      
              WSS-VAL-MONE-CLG > ZEROES AND                             
              WSS-VCAM-CLG NOT = 'P'                                    
               MOVE WSS-VCAM-CLG TO CAM-COD-VCAM IN CAM(1)              
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
               IF NOT (                                                 
                  FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'            
                     )                                                  
                   MOVE 'CAM    NEX' TO CCU-COD-MENS                    
                   MOVE 20           TO CCU-NUM-MENS                    
                   MOVE CAM-KEY-CAMB IN CAM TO CCU-CAMB                 
               ELSE                                                     
                   MULTIPLY CAM-SGV-VCAM IN CAM BY                      
                            WSS-VAL-MONE-CLG GIVING                     
                            WSS-VAL-MNAC-CLG ROUNDED.                   
       FIN-OBT-VAL-MNAC-CLG.                                            
           EXIT.                                                        
                                                                        
       CLR-FRM SECTION.                                                 
       INI-CLR-FRM.                                                     
           MOVE SPACES TO FRM-IND-TCLI   IN CLG-FLD(WSS-I).             
           MOVE SPACES TO FRM-GLS-NOMB   IN CLG-FLD(WSS-I).             
           MOVE ZEROES TO FRM-VAL-MARS   IN CLG-FLD(WSS-I).             
           MOVE ZEROES TO FRM-VAL-APRS   IN CLG-FLD(WSS-I).             
           MOVE ZEROES TO FRM-VAL-UTLS   IN CLG-FLD(WSS-I).             
           MOVE ZEROES TO FRM-VAL-DISS   IN CLG-FLD(WSS-I).             
           MOVE ZEROES TO FRM-VAL-GARS   IN CLG-FLD(WSS-I).             
           MOVE ZEROES TO FRM-SGV-PROP   IN CLG-FLD(WSS-I).             
           MOVE SPACES TO FRM-COD-ADMI   IN CLG-FLD(WSS-I).             
           MOVE ZEROES TO FRM-SGV-PROR   IN CLG-FLD(WSS-I).             
           MOVE ZEROES TO FRM-VAL-UTLP   IN CLG-FLD(WSS-I).             
           MOVE SPACES TO FRM-CAI-IPRD   IN CLG-FLD(WSS-I).             
           MOVE SPACES TO FRM-IIC-IPRD   IN CLG-FLD(WSS-I).             
           MOVE SPACES TO FRM-CAI-ICLI   IN CLG-FLD(WSS-I).             
           MOVE SPACES TO FRM-IIC-ICLI   IN CLG-FLD(WSS-I).             
       FIN-CLR-FRM.                                                     
           EXIT.                                                        
                                                                        
       CLR-WSS SECTION.                                                 
       INI-CLR-WSS.                                                     
           MOVE SPACES TO WSS-IND-TCLI-G IN WSS-VARI.                   
           MOVE SPACES TO WSS-GLS-NOMB   IN WSS-VARI.                   
           MOVE ZEROES TO WSS-VAL-MARS   IN WSS-VARI.                   
           MOVE ZEROES TO WSS-VAL-APRS   IN WSS-VARI.                   
           MOVE ZEROES TO WSS-VAL-UTLS   IN WSS-VARI.                   
           MOVE ZEROES TO WSS-VAL-DISS   IN WSS-VARI.                   
           MOVE ZEROES TO WSS-VAL-GARS   IN WSS-VARI.                   
           MOVE ZEROES TO WSS-SGV-PROP   IN WSS-VARI.                   
           MOVE SPACES TO WSS-COD-ADMI   IN WSS-VARI.                   
           MOVE ZEROES TO WSS-SGV-PROR   IN WSS-VARI.                   
           MOVE ZEROES TO WSS-VAL-UTLP   IN WSS-VARI.                   
           MOVE SPACES TO WSS-CAI-IPRD   IN WSS-VARI.                   
           MOVE SPACES TO WSS-IIC-IPRD   IN WSS-VARI.                   
           MOVE SPACES TO WSS-CAI-ICLI-G IN WSS-VARI.                   
           MOVE SPACES TO WSS-IIC-ICLI-G IN WSS-VARI.                   
           IF SCR-OFRM-SRV                                              
               PERFORM CLR-FRM-MTX.                                     
       FIN-CLR-WSS.                                                     
           EXIT.                                                        
                                                                        
       CLR-FRM-MTX SECTION.                                             
       INI-CLR-FRM-MTX.                                                 
           MOVE SPACES TO FRM-IND-TCLI   IN CLG-FLD(1).                 
           MOVE SPACES TO FRM-GLS-NOMB   IN CLG-FLD(1).                 
           MOVE ZEROES TO FRM-VAL-MARS   IN CLG-FLD(1).                 
           MOVE ZEROES TO FRM-VAL-APRS   IN CLG-FLD(1).                 
           MOVE ZEROES TO FRM-VAL-UTLS   IN CLG-FLD(1).                 
           MOVE ZEROES TO FRM-VAL-DISS   IN CLG-FLD(1).                 
           MOVE ZEROES TO FRM-VAL-GARS   IN CLG-FLD(1).                 
           MOVE ZEROES TO FRM-SGV-PROP   IN CLG-FLD(1).                 
           MOVE SPACES TO FRM-COD-ADMI   IN CLG-FLD(1).                 
           MOVE ZEROES TO FRM-SGV-PROR   IN CLG-FLD(1).                 
           MOVE ZEROES TO FRM-VAL-UTLP   IN CLG-FLD(1).                 
           MOVE SPACES TO FRM-CAI-IPRD   IN CLG-FLD(1).                 
           MOVE SPACES TO FRM-IIC-IPRD   IN CLG-FLD(1).                 
           MOVE SPACES TO FRM-CAI-ICLI   IN CLG-FLD(1).                 
           MOVE SPACES TO FRM-IIC-ICLI   IN CLG-FLD(1).                 
       FIN-CLR-FRM-MTX.                                                 
           EXIT.                                                        
                                                                        
       OBT-VAL-ADMI SECTION.                                            
       INI-OBT-VAL-ADMI.                                                
           MOVE ZEROES                   TO WSS-SGV-PROR IN WSS-VARI.   
           MOVE WSS-COD-ADMI-CLG(WSS-J)  TO WSS-IND-ADMI IN WSS-VARI.   
           MOVE WSS-IND-FIL1 IN WSS-VARI TO WSS-COD-ADMI IN WSS-VARI.   
           IF WSS-IND-FIL2 IN WSS-VARI = 'PA'                           
              MOVE 'PA'                  TO WSS-COD-ADMI IN WSS-VARI.   
           IF WSS-SGV-PROP IN WSS-VARI < 10                             
              MOVE ZEROES                TO WSS-SGV-PROR IN WSS-VARI    
           ELSE                                                         
              MOVE 100                   TO WSS-SGV-PROR IN WSS-VARI.   
       FIN-OBT-VAL-ADMI.                                                
           EXIT.                                                        
                                                                        
       LEE-SLC-CCU SECTION.                                             
       INI-LEE-SLC-CCU.                                                 
           MOVE FRM-CAI-ISLC IN CLG-FLD TO SLC-CAI-ISLC IN SLC.         
           MOVE FRM-IIC-ISLC IN CLG-FLD TO SLC-IIC-ISLC IN SLC.         
           MOVE 1                       TO SLC-NUM-ISLC IN SLC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM LDC-FIO-SLC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'SLC    NEX' TO MSG-COD-MENS                        
           ELSE                                                         
           MOVE SLC-CIC-ICLI IN SLC TO WSS-CIC-ISLC IN WSS-VARI.        
       FIN-LEE-SLC-CCU.                                                 
           EXIT.                                                        
                                                                        
       CRG-SLC-CCU SECTION.                                             
       INI-CRG-SLC-CCU.                                                 
           MOVE ZEROES TO WSS-M.                                        
           MOVE FRM-CAI-ISLC IN CLG-FLD TO SLC-CAI-ISLC IN SLC.         
           MOVE FRM-IIC-ISLC IN CLG-FLD TO SLC-IIC-ISLC IN SLC.         
           MOVE ZEROES                  TO SLC-NUM-ISLC IN SLC.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM LDC-FIO-SLC.                                         
       LUP-CRG-SLC-CCU.                                                 
           ADD 1 TO WSS-M.                                              
                                                                        
      *AFRI-INI/MAYO-2007 (MAE - ALD)                                   
      *    MOVE SLC-TIPO-LCR IN SLC TO TIPO-MPC(WSS-M).                 
      *    MOVE SLC-CAPR-LCR IN SLC TO CTOT-MPC(WSS-M).                 
      *    MOVE SLC-CTOT-LCR IN SLC TO CTOT-MPC(WSS-M).                 
      *    MOVE SLC-CUTI-LCR IN SLC TO CUTI-MPC(WSS-M).                 
      *    MOVE SLC-CDIS-LCR IN SLC TO CDIS-MPC(WSS-M).                 
      *    ADD  SLC-VAL-MNTO IN SLC TO WSS-VAL-MTSM IN WSS-VARI.        
           IF SLC-TIPO-LCR IN SLC = 'GLB'                               
               MOVE 'S'    TO WSS-IND-SGLB                              
               MOVE SLC-TIPO-LCR IN SLC TO TIPO-MPC(WSS-M)              
               MOVE SLC-CAPR-LCR IN SLC TO CTOT-MPC(WSS-M)              
               MOVE SLC-CTOT-LCR IN SLC TO CTOT-MPC(WSS-M)              
               MOVE SLC-CUTI-LCR IN SLC TO CUTI-MPC(WSS-M)              
               MOVE SLC-CDIS-LCR IN SLC TO CDIS-MPC(WSS-M)              
               ADD  SLC-VAL-MNTO IN SLC TO WSS-VAL-MTSM IN WSS-VARI     
           ELSE                                                         
               MOVE 'N'    TO WSS-IND-SGLB                              
               MOVE SLC-TIPO-LCR IN SLC TO TIPO-MPC(WSS-M)              
               MOVE SLC-CAPR-LCR IN SLC TO CTOT-MPC(WSS-M)              
               MOVE SLC-CTOT-LCR IN SLC TO CTOT-MPC(WSS-M)              
               MOVE SLC-CUTI-LCR IN SLC TO CUTI-MPC(WSS-M)              
               MOVE SLC-CDIS-LCR IN SLC TO CDIS-MPC(WSS-M)              
               ADD  SLC-VAL-MNTO IN SLC TO CUTI-MPC(WSS-M)              
               SUBTRACT SLC-VAL-MNTO IN SLC FROM                        
                        CDIS-MPC(WSS-M)     GIVING                      
                        CDIS-MPC(WSS-M)     ROUNDED.                    
      *AFRI-FIN/MAYO-2007 (MAE - ALD)                                   
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM LDC-FIO-SLC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              SLC-CAI-ISLC IN SLC = FRM-CAI-ISLC IN CLG-FLD AND         
              SLC-IIC-ISLC IN SLC = FRM-IIC-ISLC IN CLG-FLD )           
              GO TO EXT-CRG-SLC-CCU                                     
           ELSE                                                         
           GO TO LUP-CRG-SLC-CCU.                                       
       EXT-CRG-SLC-CCU.                                                 
           IF FIO-STAT-OKS                                              
              MOVE FIO-END-BRW TO FIO-CMND                              
              PERFORM LDC-FIO-SLC.                                      
                                                                        
           ADD 1 TO WSS-M.                                              
           IF WSS-M > WSS-MMAX                                          
               GO TO FIN-CRG-SLC-CCU.                                   
                                                                        
           MOVE ZEROES TO CMAJ-MPC(WSS-M).                              
           MOVE ZEROES TO CTOT-MPC(WSS-M).                              
           MOVE ZEROES TO CUTI-MPC(WSS-M).                              
           MOVE ZEROES TO CDIS-MPC(WSS-M).                              
       FIN-CRG-SLC-CCU.                                                 
           EXIT.                                                        
                                                                        
       COPY LDCBFSLC.                                                   
                                                                        
       CRG-TOT-CAPR SECTION.                                            
       INI-CRG-TOT-CAPR.                                                
           PERFORM CLR-TOT-GRP.                                         
           MOVE WSS-FMAX TO WSS-J IN WSS-VARI.                          
       LUP-CRG-TOT-CAPR.                                                
           IF WSS-J IN WSS-VARI = ZEROES                                
              GO TO FIN-CRG-TOT-CAPR.                                   
           IF WSS-CIC-NODO-CLG(WSS-J) NOT > SPACES                      
              GO TO NXT-CRG-TOT-CAPR.                                   
                                                                        
           MOVE WSS-CAI-PDRE-CLG(WSS-J) TO WSS-CAI-IPRD IN WSS-VARI.    
           MOVE WSS-IIC-PDRE-CLG(WSS-J) TO WSS-IIC-IPRD IN WSS-VARI.    
           MOVE WSS-CAI-NODO-CLG(WSS-J) TO WSS-CAI-ICLI-G IN WSS-VARI.  
           MOVE WSS-IIC-NODO-CLG(WSS-J) TO WSS-IIC-ICLI-G IN WSS-VARI.  
           MOVE WSS-VAL-MARC-CLG(WSS-J) TO WSS-VAL-MNAC-CLG.            
           IF WSS-CIC-ISLC IN WSS-VARI = WSS-CIC-NODO-CLG(WSS-J) OR     
              WSS-CIC-IGRP             = WSS-CIC-NODO-CLG(WSS-J)        
              ADD WSS-VAL-MTSM IN WSS-VARI TO WSS-VAL-MNAC-CLG.         
                                                                        
           MOVE WSS-VAL-MNAC-CLG TO WSS-VAL-MAPR-CLG(WSS-J).            
           IF WSS-IND-TLNK-CLG(WSS-J) = 'E' OR 'X'                      
              PERFORM ACU-TOT-GRP                                       
            ELSE                                                        
               MOVE ZEROES TO WSS-VAL-CAPR-CLG(WSS-J)                   
               MOVE ZEROES TO WSS-VAL-CUTI-CLG(WSS-J)                   
               MOVE ZEROES TO WSS-VAL-GARS-CLG(WSS-J)                   
               PERFORM CAL-APR-UTL-SGP.                                 
                                                                        
       NXT-CRG-TOT-CAPR.                                                
           SUBTRACT 1 FROM WSS-J IN WSS-VARI.                           
           GO TO LUP-CRG-TOT-CAPR.                                      
       FIN-CRG-TOT-CAPR.                                                
           EXIT.                                                        
                                                                        
       ACU-TOT-GRP SECTION.                                             
       INI-ACU-TOT-GRP.                                                 
           MOVE 1 TO WSS-NG.                                            
       LUP-ACU-TOT-GRP.                                                 
           IF WSS-CIC-NODO-GRP(WSS-NG) = WSS-CIC-NODO-CLG(WSS-J)        
              GO TO FIN-ACU-TOT-GRP.                                    
           IF WSS-CIC-NODO-GRP(WSS-NG) NOT >  SPACES                    
              ADD WSS-VAL-GARS-CLG(WSS-J) TO WSS-VAL-GARG IN WSS-VARI   
              MOVE WSS-CIC-NODO-CLG(WSS-J) TO WSS-CIC-NODO-GRP(WSS-NG)  
              GO TO FIN-ACU-TOT-GRP.                                    
                                                                        
           ADD 1 TO WSS-NG.                                             
           IF WSS-NG NOT > 200                                          
              GO TO LUP-ACU-TOT-GRP.                                    
       FIN-ACU-TOT-GRP.                                                 
           EXIT.                                                        
                                                                        
       ACU-TOT-UTL-CLG SECTION.                                         
       INI-ACU-TOT-UTL-CLG.                                             
           MOVE 1 TO WSS-NG.                                            
       LUP-ACU-TOT-UTL-CLG.                                             
           IF WSS-CIC-NODO-GRP(WSS-NG) = CCU-CIC-ICLI IN CCU-VARI       
              GO TO FIN-ACU-TOT-UTL-CLG.                                
                                                                        
           IF WSS-CIC-NODO-GRP(WSS-NG) NOT >  SPACES                    
              ADD WSS-VAL-UTL-E             TO WSS-VAL-UTLG IN WSS-VARI 
              MOVE CCU-CIC-ICLI IN CCU-VARI TO WSS-CIC-NODO-GRP(WSS-NG) 
              GO TO FIN-ACU-TOT-UTL-CLG.                                
                                                                        
           ADD 1 TO WSS-NG.                                             
           IF WSS-NG NOT > 200                                          
              GO TO LUP-ACU-TOT-UTL-CLG.                                
       FIN-ACU-TOT-UTL-CLG.                                             
           EXIT.                                                        
                                                                        
                                                                        
       CAL-APR-UTL-SGP SECTION.                                         
       INI-CAL-APR-UTL-SGP.                                             
           PERFORM CLR-TOT-SGP.                                         
           ADD 1 TO WSS-J GIVING WSS-NS.                                
       LUP-CAL-APR-UTL-SGP.                                             
           IF WSS-NS > 200                                              
              GO TO FIN-CAL-APR-UTL-SGP.                                
           IF WSS-CIC-NODO-CLG(WSS-NS) NOT > SPACES                     
              GO TO FIN-CAL-APR-UTL-SGP.                                
                                                                        
           IF WSS-IND-NVLN-CLG(WSS-NS) = WSS-IND-NVLN-CLG(WSS-J) OR     
              WSS-IND-NVLN-CLG(WSS-NS) < WSS-IND-NVLN-CLG(WSS-J)        
              GO TO FIN-CAL-APR-UTL-SGP.                                
                                                                        
           IF WSS-IND-TLNK-CLG(WSS-NS) = 'S'                            
              GO TO NXT-CAL-APR-UTL-SGP.                                
      *SUMA APROBADO Y UTILIZADO DE EMPRESA A SUBGRUPO                  
           PERFORM ACU-TOT-SGP.                                         
       NXT-CAL-APR-UTL-SGP.                                             
           ADD 1 TO WSS-NS.                                             
           GO TO LUP-CAL-APR-UTL-SGP.                                   
       FIN-CAL-APR-UTL-SGP.                                             
           EXIT.                                                        
                                                                        
       ACU-TOT-SGP SECTION.                                             
       INI-ACU-TOT-SGP.                                                 
           MOVE 1 TO WSS-NG.                                            
       LUP-ACU-TOT-SGP.                                                 
           IF WSS-CIC-NODO-SGP(WSS-NG) = WSS-CIC-NODO-CLG(WSS-NS)       
              GO TO FIN-ACU-TOT-SGP.                                    
           IF WSS-CIC-NODO-SGP(WSS-NG) NOT >  SPACES                    
              ADD WSS-VAL-CAPR-CLG(WSS-NS) TO WSS-VAL-CAPR-CLG(WSS-J)   
              ADD WSS-VAL-CUTI-CLG(WSS-NS) TO WSS-VAL-CUTI-CLG(WSS-J)   
              ADD WSS-VAL-GARS-CLG(WSS-NS) TO WSS-VAL-GARS-CLG(WSS-J)   
              MOVE WSS-CIC-NODO-CLG(WSS-NS) TO WSS-CIC-NODO-SGP(WSS-NG) 
              GO TO FIN-ACU-TOT-SGP.                                    
                                                                        
           ADD 1 TO WSS-NG.                                             
           IF WSS-NG NOT > 200                                          
              GO TO LUP-ACU-TOT-SGP.                                    
       FIN-ACU-TOT-SGP.                                                 
           EXIT.                                                        
                                                                        
       CLR-TOT-GRP SECTION.                                             
       INI-CLR-TOT-GRP.                                                 
           MOVE 1 TO WSS-NG.                                            
       LUP-CLR-TOT-GRP.                                                 
           IF WSS-NG > 200                                              
              GO TO FIN-CLR-TOT-GRP.                                    
           MOVE SPACES TO WSS-CIC-NODO-GRP(WSS-NG).                     
           ADD 1 TO WSS-NG.                                             
           GO TO LUP-CLR-TOT-GRP.                                       
       FIN-CLR-TOT-GRP.                                                 
           EXIT.                                                        
                                                                        
       CLR-TOT-SGP SECTION.                                             
       INI-CLR-TOT-SGP.                                                 
           MOVE 1 TO WSS-NG.                                            
       LUP-CLR-TOT-SGP.                                                 
           IF WSS-NG > 200                                              
              GO TO FIN-CLR-TOT-SGP.                                    
           MOVE SPACES TO WSS-CIC-NODO-SGP(WSS-NG).                     
           ADD 1 TO WSS-NG.                                             
           GO TO LUP-CLR-TOT-SGP.                                       
       FIN-CLR-TOT-SGP.                                                 
           EXIT.                                                        
                                                                        
       ACU-UTLP-GRP SECTION.                                            
       INI-ACU-UTLP-GRP.                                                
           MOVE 1 TO WSS-NG.                                            
       LUP-ACU-UTLP-GRP.                                                
           IF WSS-CIC-NODO-GRP(WSS-NG) = WSS-CIC-NODO-CLG(WSS-J)        
              GO TO FIN-ACU-UTLP-GRP.                                   
                                                                        
           IF WSS-CIC-NODO-GRP(WSS-NG) NOT >  SPACES                    
              ADD WSS-VAL-UTLP IN WSS-VARI TO WSS-VAL-UTPR IN WSS-VARI  
              MOVE WSS-CIC-NODO-CLG(WSS-J) TO WSS-CIC-NODO-GRP(WSS-NG)  
              GO TO FIN-ACU-UTLP-GRP.                                   
                                                                        
           ADD 1 TO WSS-NG.                                             
           IF WSS-NG NOT > 200                                          
              GO TO LUP-ACU-UTLP-GRP.                                   
       FIN-ACU-UTLP-GRP.                                                
           EXIT.                                                        
                                                                        
       LEE-TOT-DMPC SECTION.                                            
       INI-LEE-TOT-DMPC.                                                
           PERFORM DELAY-QMPC-N.                                        
           MOVE ZEROES TO MPC-L.                                        
           MOVE ZEROES TO MPC-NCLI.                                     
       LUP-LEE-TOT-DMPC.                                                
           ADD 1 TO MPC-L.                                              
           IF MPC-L > MPC-LMAX                                          
              GO TO FIN-LEE-TOT-DMPC.                                   
                                                                        
           PERFORM LEE-QUE-DMPC.                                        
           IF ( MSG-COD-MENS > SPACES OR MPC-NCLI = MPC-NMAX )          
              GO TO FIN-LEE-TOT-DMPC.                                   
                                                                        
       NXT-LEE-TOT-DMPC.                                                
           PERFORM DELAY-QMPC-1.                                        
           GO TO LUP-LEE-TOT-DMPC.                                      
       FIN-LEE-TOT-DMPC.                                                
           PERFORM DEL-ALL-MPC.                                         
           IF (MSG-COD-MENS NOT > SPACES AND MPC-NCLI NOT = MPC-NMAX)   
                                                                        
      * GVI-INI                                                         
              SET WSS-SI-TIMEOUT TO TRUE                                
RF2910        PERFORM INS-RUT-TBRPE                                     
      * GVI-FIN                                                         
                                                                        
              MOVE 'TIMEOUT  MEC' TO MSG-COD-MENS.                      
       EXT-LEE-TOT-DMPC.                                                
           EXIT.                                                        
                                                                        
      *---------  INSERTA RUT DE LA EMPRESA EN TABLA RPE ---------*     
RF2910 INS-RUT-TBRPE SECTION.                                           
RF2910 INI-INS-RUT-TBRPE.                                               
RF2910     MOVE SPACES                   TO TAB.                        
RF2910     MOVE 'TAB'                    TO TAB-COD-SIST.               
RF2910     MOVE 'RPE'                    TO TAB-COD-TTAB IN TAB.        
RF2910     MOVE  DBC-NUM-ICLI IN CLG-FLD TO WSS-NUM-ICLI.               
RF2910     MOVE  DBC-VRF-ICLI IN CLG-FLD TO WSS-VRF-ICLI.               
RF2910     MOVE  DBC-IND-ICLI IN CLG-FLD TO WSS-IND-ICLI.               
RF2910     MOVE  DBC-GLS-ICLI IN CLG-FLD TO WSS-GLS-ICLI.               
RF2910     MOVE  WSS-COD-ICLI            TO TAB-COD-CTAB IN TAB.        
RF2910     MOVE  WSS-COD-ICLI            TO TAB-CIC-CTAB IN TAB.        
RF2910     MOVE  'CLI.PESA.MEC'          TO TAB-GLS-DCOR IN TAB.        
RF2910     MOVE  'CLIPE'                 TO TAB-GLS-ABRV IN TAB.        
RF2910     MOVE  'CLIENTE PESADO MEC'    TO TAB-GLS-DESC IN TAB.        
RF2910     MOVE  'S'                     TO TAB-IND-VIGE.               
RF2910     MOVE HOY-SHOY                 TO TAB-NUM-STRN.               
RF2910     MOVE HOY-AHOY                 TO TAB-NUM-ATRN.               
RF2910     MOVE HOY-MHOY                 TO TAB-NUM-MTRN.               
RF2910     MOVE HOY-DHOY                 TO TAB-NUM-DTRN.               
RF2910     MOVE TAB-COD-SIST TO FIO-SIST.                               
RF2910     MOVE FIO-PUT TO FIO-CMND.                                    
RF2910     PERFORM GNS-FIO-TAB.                                         
RF2910 FIN-INS-RUT-TBRPE.                                               
RF2910     EXIT.                                                        
                                                                        
       LEE-QUE-DMPC SECTION.                                            
       INI-LEE-QUE-DMPC.                                                
           MOVE ZEROES TO MPC-N.                                        
       LUP-LEE-QUE-DMPC.                                                
           ADD 1 TO MPC-N.                                              
           IF MPC-N > MPC-NMAX                                          
              GO TO FIN-LEE-QUE-DMPC.                                   
                                                                        
           IF MPC-STAT(MPC-N) = 'S' OR MPC-STAT(MPC-N) NOT > SPACES     
              GO TO NXT-LEE-QUE-DMPC.                                   
                                                                        
           MOVE MPC-N  TO MPC-NUM-CORR.                                 
           PERFORM GET-MPC-RESP.                                        
           IF (MSG-COD-MENS > SPACES OR MPC-NCLI = MPC-NMAX)            
              GO TO FIN-LEE-QUE-DMPC.                                   
                                                                        
       NXT-LEE-QUE-DMPC.                                                
           GO TO LUP-LEE-QUE-DMPC.                                      
       FIN-LEE-QUE-DMPC.                                                
           EXIT.                                                        
                                                                        
       GET-MPC-RESP SECTION.                                            
       INI-GET-MPC-RESP.                                                
           PERFORM LEE-TS-DMPC.                                         
           IF QUE-STAT NOT = QUE-STAT-OKS                               
              GO TO FIN-GET-MPC-RESP.                                   
                                                                        
           MOVE QUE-ITEM TO MPC-ITEM.                                   
           IF MPC-IND-STAT = 'E'                                        
              MOVE MPC-COD-MENS TO MSG-COD-MENS                         
              MOVE MPC-MENS     TO FRM-MENS                             
              GO TO FIN-GET-MPC-RESP.                                   
                                                                        
           MOVE 'S' TO MPC-STAT(MPC-N).                                 
           ADD 1    TO MPC-NCLI.                                        
           PERFORM PRO-VEC-FRM.                                         
       FIN-GET-MPC-RESP.                                                
           EXIT.                                                        
                                                                        
       LEE-TS-DMPC SECTION.                                             
       INI-LEE-TS-DMPC.                                                 
           MOVE MPC-NOM-DMPC  TO QUE-COLA.                              
           MOVE MPC-LITM      TO QUE-LITM.                              
           MOVE +1            TO QUE-NITM.                              
           MOVE QUE-GET       TO QUE-CMND.                              
           PERFORM GNS-PRO-QUE.                                         
       FIN-LEE-TS-DMPC.                                                 
           EXIT.                                                        
                                                                        
       PRO-VEC-FRM SECTION.                                             
       INI-PRO-VEC-FRM.                                                 
           MOVE SPACES       TO CCU-COD-MENS IN CCU-VARI.               
           MOVE MPC-CIC-CLIQ TO CCU-CIC-ICLI IN CCU-VARI.               
           MOVE MPC-NUM-COLQ TO WSS-C.                                  
           MOVE MPC-NUM-FILQ TO WSS-F.                                  
           MOVE MPC-NUM-POSQ TO WSS-I.                                  
           MOVE 'N'          TO MPC-IND-CGAR.                           
           PERFORM CRG-VEC-CLG.                                         
           PERFORM CRG-VEC-FRM.                                         
       FIN-PRO-VEC-FRM.                                                 
           EXIT.                                                        
                                                                        
       DEL-ALL-MPC SECTION.                                             
       INI-DEL-ALL-MPC.                                                 
           MOVE 'E'      TO MPC-IND-TPRO.                               
           MOVE MPC-NMAX TO MPC-NUM-TPRO.                               
           MOVE ZEROES   TO MPC-NUM-CORR.                               
                                                                        
           MOVE SCR-QIDD TO MPC-QIDD.                                   
           MOVE SCR-LIDD TO MPC-LIDD.                                   
           MOVE FIO-MSFL TO MPC-MSFL.                                   
           MOVE MPC-CMMA TO SYS-CMMA.                                   
           MOVE MPC-TCMA TO SYS-TCMA.                                   
           EXEC CICS START                                              
                TRANSID( 'DQ71' )                                       
                FROM   ( SYS-CMMA )                                     
                LENGTH ( SYS-TCMA )                                     
           END-EXEC.                                                    
       FIN-DEL-ALL-MPC.                                                 
           EXIT.                                                        
                                                                        
       DELAY-QMPC-1 SECTION.                                            
       INI-DELAY-QMPC-1.                                                
           EXEC CICS DELAY INTERVAL(000001)                             
           END-EXEC.                                                    
       FIN-DELAY-QMPC-1.                                                
           EXIT.                                                        
                                                                        
       DELAY-QMPC-N SECTION.                                            
       INI-DELAY-QMPC-N.                                                
           IF MPC-NUM-DELAY = '1'                                       
              GO TO PRO-DELAY-1.                                        
           IF MPC-NUM-DELAY = '2'                                       
              GO TO PRO-DELAY-2.                                        
           IF MPC-NUM-DELAY = '3'                                       
              GO TO PRO-DELAY-3.                                        
           IF MPC-NUM-DELAY = '4'                                       
              GO TO PRO-DELAY-4.                                        
       PRO-DELAY-1.                                                     
           EXEC CICS DELAY INTERVAL(000001)                             
           END-EXEC.                                                    
           GO TO FIN-DELAY-QMPC-N.                                      
       PRO-DELAY-2.                                                     
           EXEC CICS DELAY INTERVAL(000002)                             
           END-EXEC.                                                    
           GO TO FIN-DELAY-QMPC-N.                                      
       PRO-DELAY-3.                                                     
           EXEC CICS DELAY INTERVAL(000003)                             
           END-EXEC.                                                    
           GO TO FIN-DELAY-QMPC-N.                                      
       PRO-DELAY-4.                                                     
           EXEC CICS DELAY INTERVAL(000004)                             
           END-EXEC.                                                    
           GO TO FIN-DELAY-QMPC-N.                                      
       FIN-DELAY-QMPC-N.                                                
           EXIT.                                                        
                                                                        
       CARGA-GAR SECTION.                                               
       INI-CARGA-GAR.                                                   
           MOVE CCU-CIC-ICLI IN CCU-VARI TO GDD-CIC-DCLI IN GDD.        
           MOVE LOW-VALUES               TO GDD-KEY-AGDD IN GDD.        
           MOVE FIO-GET-NLS  TO FIO-CMND.                               
           PERFORM BGL-FIO-GDD.                                         
           MOVE FIO-STAT TO PGM-STAT-GDD.                               
           IF NOT (FIO-STAT-OKS AND                                     
                   GDD-CIC-DCLI IN GDD = CCU-CIC-ICLI IN CCU-VARI)      
               GO TO BRW-CARGA-GAR.                                     
                                                                        
       LUP-CARGA-GAR.                                                   
           PERFORM CARGA-GVT.                                           
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           MOVE FIO-STAT TO PGM-STAT-GDD.                               
           IF FIO-STAT-OKS AND                                          
              GDD-CIC-DCLI IN GDD = CCU-CIC-ICLI IN CCU-VARI            
               GO TO LUP-CARGA-GAR.                                     
       BRW-CARGA-GAR.                                                   
           MOVE PGM-STAT-GDD TO FIO-STAT.                               
           IF FIO-STAT-OKS                                              
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GDD.                                     
       FIN-CARGA-GAR.                                                   
           EXIT.                                                        
                                                                        
       CARGA-GVT SECTION.                                               
       INI-CARGA-GVT.                                                   
           MOVE GDD-KEY-AGDD IN GDD TO GDG-CIC-GTIA IN GDG.             
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM BGL-FIO-GDG.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    GDG-IND-GTAC IN GDG = 'S' AND                       
                    GDG-FEC-FALZ IN GDG NOT > ZEROES )                  
               GO TO FIN-CARGA-GVT.                                     
                                                                        
           MOVE GDG-COD-CGTA IN GDG TO TAG-COD-AGTA IN TAG.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.                                         
           IF TAG-IND-TREA IN TAG NOT = WSS-COD-REAL IN WSS-VARI        
               GO TO FIN-CARGA-GVT.                                     
                                                                        
           MOVE GDD-KEY-AGDD IN GDD TO GVT-KEY-IGVT IN GVT.             
           MOVE GDG-COD-TSCN IN GDG TO GVT-COD-TASN IN GVT.             
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM BGL-FIO-GVT.                                         
           IF NOT ( FIO-STAT-OKS AND GVT-SGV-VPND IN GVT > ZEROES )     
               GO TO FIN-CARGA-GVT.                                     
                                                                        
           MOVE GVT-SGV-VCTS IN GVT TO WSS-VAL-MONE-CLG.                
           MOVE GDG-COD-VCAM IN GDG TO WSS-VCAM-CLG.                    
           PERFORM OBT-VAL-MNAC-CLG.                                    
GGX        IF WSS-CLI-PESADO                                            
GGX           ADD WSS-VAL-MNAC-CLG TO MPC-VAL-GARE                      
GGX        ELSE                                                         
              ADD WSS-VAL-MNAC-CLG TO WSS-VAL-GARE IN WSS-VARI.         
       FIN-CARGA-GVT.                                                   
           EXIT.                                                        
                                                                        
       COPY BGLBFGDD.                                                   
       COPY BGLBFGDG.                                                   
       COPY BGLBFGVT.                                                   
       COPY BGLBFTAG.                                                   
      * GVI-INI mod. MEC 30-OCT-2006                                    
       VAL-SWITCH SECTION.                                              
       INI-VAL-SWITCH.                                                  
                                                                        
           IF WSS-IND-SWT1 = 'S'                                        
                                                                        
      * Consulta BD Intermedia de Ticket.                               
      * Tomar la mas reciente consulta terminada                        
              PERFORM FND-ITK-RCNT                                      
              IF WSS-TICKET-OK                                          
                 SET WSS-GET-RTK TO TRUE                                
                                                                        
              ELSE                                                      
                                                                        
                 IF WSS-IND-SWT2 = 'S'                                  
                                                                        
      * Generar un nzmero de ticket, actualizar Base de Datos de Ticket 
      * Llamar ls rutina que ejecutara el pedido batch y informar Ticket
      *             PERFORM ACT-ITK-TCKT                                
                    SET WSS-PUT-PTK TO TRUE                             
                 ELSE                                                   
                    IF WSS-IND-SWT3 = 'S'                               
                                                                        
      * Con el Rut principal, armar el arbol.                           
      * Luego con Rut-Ticket consultar la BD y armar respuesta          
                       SET WSS-GET-RTK TO TRUE                          
                                                                        
                    ELSE                                                
                                                                        
                       IF WSS-IND-SWT4 = 'S'                            
                                                                        
      * Generar un nzmero de ticket, actualizar Base de Datos de Ticket 
      * Llamar ls rutina que ejecutara el pedido batch y informar Ticket
                                                                        
      *                   PERFORM ACT-ITK-TCKT                          
                          SET WSS-PUT-PTK TO TRUE                       
                                                                        
                       ELSE                                             
                                                                        
      * No se trabaja con ticket                                        
                          SET WSS-CLI-NORMAL TO TRUE.                   
                                                                        
           IF WSS-IND-SWT1 = 'N'                                        
                                                                        
                 IF WSS-IND-SWT2 = 'S'                                  
                                                                        
      * GENERAR UN NUMERO DE TICKET, ACTUALIZAR BASE DE DATOS DE TICKET 
      * Llamar ls rutina que ejecutara el pedido batch y informar Ticket
      *             PERFORM ACT-ITK-TCKT                                
                    SET WSS-PUT-PTK TO TRUE                             
                 ELSE                                                   
                    IF WSS-IND-SWT3 = 'S'                               
                                                                        
      * Con el Rut principal, armar el arbol.                           
      * Luego con Rut-Ticket consultar la BD y armar respuesta          
                       SET WSS-GET-RTK TO TRUE                          
                                                                        
                    ELSE                                                
                                                                        
                       IF WSS-IND-SWT4 = 'S'                            
                                                                        
      * Generar un nzmero de ticket, actualizar Base de Datos de Ticket 
      * Llamar ls rutina que ejecutara el pedido batch y informar Ticket
                                                                        
      *                   PERFORM ACT-ITK-TCKT                          
                          SET WSS-PUT-PTK TO TRUE                       
                                                                        
                       ELSE                                             
                                                                        
      * No se trabaja con ticket                                        
                          SET WSS-CLI-NORMAL TO TRUE.                   
       FIN-VAL-SWITCH.                                                  
           EXIT.                                                        
                                                                        
       FND-ITK-TICK SECTION.                                            
      * Busca el Ticket indicado en pantalla y que sea completado       
       INI-FND-ITK-TICK.                                                
           MOVE FRM-GLS-TICK IN CLG-FLD TO ITK-KEY-IITK IN ITK.         
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM GNS-FIO-ITK.                                         
           IF     FIO-STAT-OKS        AND                               
                  ITK-IND-RESP IN ITK  = '1'                            
               MOVE ITK-FEC-FPRO IN ITK  TO WSS-FEC-FECH                
               MOVE WSS-NUM-DFEC         TO FRM-NUM-DECH IN CLG-FLD     
               MOVE WSS-NUM-MFEC         TO FRM-NUM-MECH IN CLG-FLD     
               MOVE WSS-NUM-SFEC         TO FRM-NUM-SECH IN CLG-FLD     
               MOVE WSS-NUM-AFEC         TO FRM-NUM-AECH IN CLG-FLD     
               MOVE ITK-HRA-HRPR IN ITK  TO FRM-HRA-HORA IN CLG-FLD     
           ELSE                                                         
              MOVE 'TICK   NEX'          TO MSG-COD-MENS.               
       FIN-FND-ITK-TICK.                                                
           EXIT.                                                        
                                                                        
       GET-RUT-ICLI SECTION.                                            
       INI-GET-RUT-ICLI.                                                
      * Busca Cliente indicado en el ticket                             
           MOVE ITK-COD-ENTI IN ITK(1:8) TO DBC-NUM-ICLI IN DBC         
           MOVE SPACES                   TO DBC-IND-ICLI IN DBC         
           MOVE SPACES                   TO DBC-GLS-ICLI IN DBC         
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY                              
           MOVE FIO-GET-KEY    TO FIO-CMND                              
           PERFORM GET-CLI                                              
           IF MSG-COD-MENS NOT > SPACES                                 
              MOVE DBC-NUM-ICLI IN DBC   TO DBC-NUM-ICLI IN CLG-FLD     
              MOVE DBC-VRF-ICLI IN DBC   TO DBC-VRF-ICLI IN CLG-FLD     
              MOVE DBC-GLS-NOMC IN DBC   TO CPT-STRN                    
              PERFORM CPT-BLKS                                          
              MOVE CPT-STRN              TO DBC-GLS-NOMC IN CLG-FLD     
              MOVE DBC-CAI-ICLI IN DBC   TO DBC-CAI-ICLI IN CLG-FLD     
              MOVE DBC-IIC-ICLI IN DBC   TO DBC-IIC-ICLI IN CLG-FLD     
              MOVE '00' TO PGM-STAT-DBC                                 
           ELSE                                                         
              MOVE MSG-GLS-DESC TO FRM-MENS CLG-GLS-MENS                
              MOVE 'S' TO SCR-IERR.                                     
       FIN-GET-RUT-ICLI.                                                
           EXIT.                                                        
                                                                        
                                                                        
                                                                        
       FND-ITK-FECH SECTION.                                            
      * Busca el Ticket por RUT y FECHA indicados en pantalla           
      * y que sea completado                                            
       INI-FND-ITK-FECH.                                                
           MOVE WSS-COD-SIST            TO ITK-COD-SIST IN ITK.         
           MOVE WSS-COD-TPRO            TO ITK-COD-TPRO IN ITK.         
           MOVE DBC-NUM-ICLI IN CLG-FLD TO WSS-NUM-ICLI                 
           MOVE DBC-VRF-ICLI IN CLG-FLD TO WSS-VRF-ICLI                 
           MOVE DBC-IND-ICLI IN CLG-FLD TO WSS-IND-ICLI                 
           MOVE DBC-GLS-ICLI IN CLG-FLD TO WSS-GLS-ICLI                 
           MOVE WSS-COD-ENTI            TO ITK-COD-ENTI IN ITK.         
           MOVE FRM-NUM-DECH IN CLG-FLD TO WSS-NUM-DFEC                 
           MOVE FRM-NUM-MECH IN CLG-FLD TO WSS-NUM-MFEC                 
           MOVE FRM-NUM-SECH IN CLG-FLD TO WSS-NUM-SFEC                 
           MOVE FRM-NUM-AECH IN CLG-FLD TO WSS-NUM-AFEC                 
           MOVE WSS-FEC-FECH            TO ITK-FEC-FPRO IN ITK.         
           MOVE FRM-HRA-HORA IN CLG-FLD TO ITK-HRA-HRPR IN ITK.         
           MOVE HIGH-VALUE              TO ITK-NUM-UNIC IN ITK.         
           MOVE FIO-GET-LEQ             TO FIO-CMND.                    
       LUP-FND-ITK-FECH.                                                
           MOVE 'ITK-KEY-AITK'          TO FIO-AKEY                     
           PERFORM GNS-FIO-ITK                                          
                                                                        
           IF NOT (FIO-STAT-OKS                              AND        
                   ITK-COD-SIST IN ITK   = WSS-COD-SIST      AND        
                   ITK-COD-TPRO IN ITK   = WSS-COD-TPRO      AND        
                   ITK-COD-ENTI IN ITK (1:13) = WSS-COD-ENTI AND        
                   ITK-FEC-FPRO IN ITK   = WSS-FEC-FECH      AND        
                   ITK-HRA-HRPR IN ITK   = FRM-HRA-HORA IN CLG-FLD )    
                                                                        
              SET WSS-TICKET-KO TO TRUE                                 
           ELSE                                                         
              IF  ITK-IND-RESP IN ITK   = '1'                           
                 MOVE ITK-CIC-IITK IN ITK  TO FRM-GLS-TICK IN CLG-FLD   
                 SET WSS-TICKET-OK TO TRUE                              
              ELSE                                                      
                 MOVE FIO-GET-PRV       TO FIO-CMND                     
                 GO TO LUP-FND-ITK-FECH.                                
       FIN-FND-ITK-FECH.                                                
           EXIT.                                                        
                                                                        
       FND-ITK-RCNT SECTION.                                            
      * Busca el mas reciente Ticket completado                         
       INI-FND-ITK-RCNT.                                                
           MOVE WSS-COD-SIST            TO ITK-COD-SIST IN ITK.         
           MOVE WSS-COD-TPRO            TO ITK-COD-TPRO IN ITK.         
           MOVE DBC-IND-ICLI IN CLG-FLD TO WSS-IND-ICLI                 
           MOVE DBC-GLS-ICLI IN CLG-FLD TO WSS-GLS-ICLI                 
           MOVE WSS-COD-ENTI            TO ITK-COD-ENTI IN ITK.         
           MOVE WSS-FEC-FPRO            TO ITK-FEC-FPRO IN ITK.         
           MOVE WSS-HRA-HRPR            TO ITK-HRA-HRPR IN ITK.         
           MOVE HIGH-VALUE              TO ITK-NUM-UNIC IN ITK          
                                                                        
           MOVE FIO-GET-LEQ             TO FIO-CMND.                    
       LUP-FND-ITK-RCNT.                                                
           MOVE 'ITK-KEY-AITK'          TO FIO-AKEY                     
           PERFORM GNS-FIO-ITK                                          
           IF NOT ( FIO-STAT-OKS                             AND        
                   ITK-COD-SIST IN ITK        = WSS-COD-SIST AND        
                   ITK-COD-TPRO IN ITK        = WSS-COD-TPRO AND        
                   ITK-COD-ENTI IN ITK (1:13) = WSS-COD-ENTI )          
              SET WSS-TICKET-KO TO TRUE                                 
           ELSE                                                         
              IF ITK-IND-RESP IN ITK        = '1'                       
                 MOVE ITK-CIC-IITK IN ITK  TO FRM-GLS-TICK IN CLG-FLD   
                 MOVE ITK-FEC-FPRO IN ITK  TO WSS-FEC-FECH              
                 MOVE WSS-NUM-DFEC         TO FRM-NUM-DECH IN CLG-FLD   
                 MOVE WSS-NUM-MFEC         TO FRM-NUM-MECH IN CLG-FLD   
                 MOVE WSS-NUM-SFEC         TO FRM-NUM-SECH IN CLG-FLD   
                 MOVE WSS-NUM-AFEC         TO FRM-NUM-AECH IN CLG-FLD   
                 MOVE ITK-HRA-HRPR IN ITK  TO FRM-HRA-HORA IN CLG-FLD   
                 SET WSS-TICKET-OK TO TRUE                              
              ELSE                                                      
                 MOVE FIO-GET-PRV       TO FIO-CMND                     
                 GO TO LUP-FND-ITK-RCNT.                                
       FIN-FND-ITK-RCNT.                                                
           EXIT.                                                        
                                                                        
       ACT-ITK-TCKT SECTION.                                            
       INI-ACT-ITK-TCKT.                                                
           MOVE SPACES       TO TCK-CMMA.                               
           MOVE WSS-COD-IITK TO TCK-CAI-ITCK.                           
           MOVE WSS-COD-SIST TO TCK-COD-SIST.                           
           MOVE WSS-COD-TPRO TO TCK-COD-TPRO.                           
           MOVE WSS-COD-ENTI TO TCK-COD-ENTI.                           
           MOVE WSS-NUM-SECU TO TCK-NUM-SECU                            
           MOVE WSS-COD-WITK TO TCK-COD-WITK.                           
                                                                        
           MOVE WSS-GNSPPADT TO SYS-PROG.                               
           MOVE TCK-TCMA     TO SYS-TCMA.                               
           MOVE TCK-CMMA     TO SYS-CMMA.                               
           MOVE SYS-LINK     TO SYS-CMND.                               
           PERFORM GNS-PRO-SYS.                                         
                                                                        
GGG        MOVE SYS-CMMA      TO TCK-CMMA                               
                                                                        
           MOVE TCK-COD-MENS  TO MSG-COD-MENS                           
           MOVE TCK-GLS-MENS  TO MSG-GLS-DESC                           
                                                                        
           IF MSG-COD-MENS NOT > SPACES                                 
              MOVE TCK-CIC-ITCK TO ITK-CIC-IITK                         
           ELSE                                                         
              MOVE MSG-GLS-DESC TO FRM-MENS CLG-GLS-MENS                
              MOVE 'S' TO SCR-IERR.                                     
ZX    *       GO TO MSG-FND-KEY.                                        
                                                                        
       FIN-ACT-ITK-TCKT.                                                
           EXIT.                                                        
                                                                        
                                                                        
      *  Valoriza el area MPC                                           
      *  Primero se lee la respuesta CCU (3 registros RTK).             
       CRG-RTK-MPC SECTION.                                             
           MOVE ITK-CAI-IITK IN ITK      TO RTK-CAI-IITK IN RTK         
           MOVE ITK-IIC-IITK IN ITK      TO RTK-IIC-IITK IN RTK.        
           MOVE 1                        TO RTK-NUM-SECT IN RTK.        
           MOVE CCU-CIC-ICLF IN CCU-VARI TO WSS-CIC-ICLF IN WSS-VARI    
           MOVE CCU-CIC-ICLI IN CCU-VARI TO WSS-CIC-CLIC IN WSS-VARI.   
           MOVE WSS-COD-ENTT IN WSS-VARI TO RTK-COD-ENTT IN RTK.        
                                                                        
           MOVE 1                        TO RTK-NUM-CORT IN RTK.        
           MOVE FIO-GET-KEY              TO FIO-CMND                    
           PERFORM GNS-FIO-RTK                                          
           IF FIO-STAT-OKS                                              
              SET WSS-RTK-OK             TO TRUE                        
              MOVE RTK-GLS-RESP IN RTK   TO WSS-CCU-RTK1 IN WSS-VARI    
           ELSE                                                         
              SET WSS-RTK-KO             TO TRUE                        
              GO TO FIN-CRG-RTK-MPC.                                    
      *       MOVE 'S'                   TO SCR-IERR                    
      *       MOVE 'RTK    NEX'          TO MSG-COD-MENS                
      *       GO TO MSG-FND-KEY.                                        
                                                                        
           MOVE 2                        TO RTK-NUM-CORT IN RTK.        
           MOVE FIO-GET-KEY              TO FIO-CMND                    
           PERFORM GNS-FIO-RTK                                          
           IF FIO-STAT-OKS                                              
              MOVE RTK-GLS-RESP IN RTK   TO WSS-CCU-RTK2 IN WSS-VARI    
           ELSE                                                         
              MOVE 'S'                   TO SCR-IERR                    
              MOVE 'RTK    NEX'          TO MSG-COD-MENS                
ZX            GO TO FIN-CRG-RTK-MPC.                                    
ZX    *       GO TO MSG-FND-KEY.                                        
                                                                        
           MOVE 3                        TO RTK-NUM-CORT IN RTK.        
           MOVE FIO-GET-KEY              TO FIO-CMND                    
           PERFORM GNS-FIO-RTK                                          
           IF FIO-STAT-OKS                                              
              MOVE RTK-GLS-RESP IN RTK   TO WSS-CCU-RTK3 IN WSS-VARI    
           ELSE                                                         
              MOVE 'S'                   TO SCR-IERR                    
              MOVE 'RTK    NEX'          TO MSG-COD-MENS                
ZX            GO TO FIN-CRG-RTK-MPC.                                    
ZX    *       GO TO MSG-FND-KEY.                                        
      *  Sumariza la respuesta CCU en el area MPC (clon de LDCPPMPC)    
       INI-LDCPPMPC.                                                    
           MOVE ZEROES       TO MPC-VAL-GARE.                           
           MOVE ZEROES       TO CTOT-MPC(1).                            
                                                                        
           MOVE WSS-CCU-RTK IN WSS-VARI TO CCU-CMMA IN CCU-VARI.        
                                                                        
           MOVE 'S'          TO MPC-IND-STAT.                           
           MOVE SPACES       TO MPC-MENS.                               
           IF OK-OPCS-ANTIGUAS AND OK-OPC-EN-CURSE                      
               GO TO CNT-MAIN.                                          
                                                                        
      *    PERFORM ANL-CCU-MENS.                                        
       CNT-MAIN.                                                        
           IF MPC-IND-STAT = 'S'                                        
              PERFORM CRG-MPC-VEC                                       
GGX           MOVE MPC-CIC-CLIC TO CCU-CIC-ICLI IN CCU-VARI             
              PERFORM CARGA-GAR                                         
           ELSE                                                         
              MOVE CCU-COD-MENS TO MPC-COD-MENS.                        
                                                                        
           MOVE MPC-CIC-CLIC   TO MPC-CIC-CLIQ.                         
           MOVE MPC-NUM-COLC   TO MPC-NUM-COLQ.                         
           MOVE MPC-NUM-FILC   TO MPC-NUM-FILQ.                         
           MOVE MPC-NUM-POSC   TO MPC-NUM-POSQ.                         
       FIN-LDCPPMPC.                                                    
       FIN-CRG-RTK-MPC.                                                 
           EXIT.                                                        
                                                                        
                                                                        
       CRG-MPC-VEC SECTION.                                             
       INI-CRG-MPC-VEC.                                                 
           MOVE ZEROES TO MPC-I.                                        
       LUP-CRG-MPC-VEC.                                                 
           ADD 1 TO MPC-I.                                              
           IF MPC-I > MPC-TLCR                                          
              GO TO FIN-CRG-MPC-VEC.                                    
                                                                        
      *MHM-INI 05-ENE-2008 MEC                                          
      *    IF CTOT-LCR(MPC-I) NOT > ZEROES OR                           
      *       CTOT-LCR(MPC-I) NOT NUMERIC                               
      *       MOVE ZEROES TO CTOT-MPC(MPC-I)                            
      *       GO TO FIN-CRG-MPC-VEC.                                    
           IF CTOT-LCR(MPC-I) NOT NUMERIC                               
              MOVE ZEROES TO CTOT-MPC(MPC-I)                            
              GO TO FIN-CRG-MPC-VEC.                                    
           IF CTOT-LCR(MPC-I) NOT > ZEROES                              
              MOVE ZEROES TO CTOT-MPC(MPC-I)                            
              GO TO FIN-CRG-MPC-VEC.                                    
      *MHM-INI 05-ENE-2008 MEC                                          
                                                                        
      *TRASPASA VECTOR DE LCR(CCU) A VEC(MPC).                          
           MOVE CMAJ-LCR(MPC-I) TO CMAJ-MPC(MPC-I).                     
           MOVE CTOT-LCR(MPC-I) TO CTOT-MPC(MPC-I).                     
           MOVE CUTI-LCR(MPC-I) TO CUTI-MPC(MPC-I).                     
           MOVE CDIS-LCR(MPC-I) TO CDIS-MPC(MPC-I).                     
           MOVE MENS-LCR(MPC-I) TO MENS-MPC(MPC-I).                     
           MOVE MEN2-LCR(MPC-I) TO MEN2-MPC(MPC-I).                     
           MOVE NMSG-LCR(MPC-I) TO NMSG-MPC(MPC-I).                     
           MOVE NMS2-LCR(MPC-I) TO NMS2-MPC(MPC-I).                     
                                                                        
           IF TIPO-MPC(MPC-I) NOT > SPACES                              
              MOVE 'LBR' TO TIPO-MPC(MPC-I).                            
           MOVE 'LDC'           TO FIO-SIST.                            
           MOVE 'TLC'           TO TAB-COD-TTAB IN TAB.                 
           MOVE TIPO-MPC(MPC-I) TO TAB-COD-CTAB IN TAB.                 
           MOVE FIO-GET-KEY     TO FIO-CMND.                            
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-COD-DAT3(10) TO TIPO-MPC(MPC-I).                    
           GO TO LUP-CRG-MPC-VEC.                                       
       FIN-CRG-MPC-VEC.                                                 
           EXIT.                                                        
                                                                        
       ANL-CCU-MENS SECTION.                                            
       INI-ANL-CCU-MENS.                                                
           MOVE CCU-COD-SIST IN CCU-VARI TO MSG-COD-SIST.               
           IF CCU-NUM-MENS > ZEROES AND                                 
              ( CCU-NUM-MEN2 > ZEROES OR CCU-CAMB > SPACES )            
               MOVE CCU-COD-MENS IN CCU-VARI TO MSG-COD-MENS            
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO CCU-MEN1                            
               IF CCU-CAMB > SPACES                                     
                   MOVE CCU-CAMB TO CCU-MEN2                            
               ELSE                                                     
                   MOVE CCU-COD-MEN2 IN CCU-VARI TO MSG-COD-MENS        
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO CCU-MEN2                        
           ELSE                                                         
           IF CCU-NUM-MENS > ZEROES                                     
               MOVE CCU-COD-MENS IN CCU-VARI TO MSG-COD-MENS            
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO CCU-MEN2                            
           ELSE                                                         
               MOVE CCU-COD-MEN2 IN CCU-VARI TO MSG-COD-MENS            
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO CCU-MEN2.                           
      *                                                                 
           IF CCU-NUM-MENS < CCU-NUM-CALC AND CCU-NUM-MENS > ZEROES     
              IF CCU-MEN1 > SPACES AND CCU-MEN2 > SPACES                
                 MOVE CCU-MENS TO MPC-MENS                              
                 MOVE 'E' TO MPC-IND-STAT                               
              ELSE                                                      
                 IF CCU-MEN1 > SPACES                                   
                    MOVE CCU-MEN1 TO MPC-MEN1                           
                    MOVE 'E' TO MPC-IND-STAT                            
                 ELSE                                                   
                 IF CCU-MEN2 > SPACES                                   
                    MOVE CCU-MEN2 TO MPC-MEN2.                          
       FIN-ANL-CCU-MENS.                                                
           EXIT.                                                        
                                                                        
       OBT-VAL-MNAC SECTION.                                            
       INI-OBT-VAL-MNAC.                                                
      * Transforma monto a moneda corriente del dia                     
           MOVE MPC-VAL-MONE TO MPC-VAL-MNAC.                           
           IF (MPC-VCAM > SPACES AND MPC-VCAM NOT = MPC-COD-PESO AND    
               MPC-VAL-MONE > ZEROES AND MPC-VCAM NOT = 'P')            
              IF MPC-VCAM = MPC-COD-UEFE                                
                 MULTIPLY MPC-SGV-UEFE BY MPC-VAL-MONE                  
                                   GIVING MPC-VAL-MNAC ROUNDED          
              ELSE                                                      
               MOVE MPC-VCAM TO CAM-COD-VCAM IN CAM(1)                  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
                 IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S')    
                   MOVE 'CAM    NEX' TO CCU-COD-MENS                    
                   MOVE 20           TO CCU-NUM-MENS                    
                   MOVE CAM-KEY-CAMB IN CAM TO CCU-CAMB                 
               ELSE                                                     
                    MULTIPLY CAM-SGV-VCAM IN CAM BY MPC-VAL-MONE        
                                     GIVING MPC-VAL-MNAC ROUNDED.       
       FIN-OBT-VAL-MNAC.                                                
           EXIT.                                                        
                                                                        
       TOT-RTK-DMPC SECTION.                                            
           IF MPC-IND-STAT = 'E'                                        
              MOVE MPC-COD-MENS TO MSG-COD-MENS                         
              MOVE MPC-MENS     TO FRM-MENS                             
              GO TO FIN-GET-MPC-RESP.                                   
                                                                        
           MOVE 'S' TO MPC-STAT(MPC-N).                                 
           ADD 1    TO MPC-NCLI.                                        
           PERFORM PRO-VEC-FRM.                                         
       FIN-TOT-RTK-DMPC.                                                
           EXIT.                                                        
                                                                        
      * Por cada par de cic ICLI y ICLF se inserta un registro PTK      
       INS-PTK-CCU SECTION.                                             
       INI-INS-PTK-CCU.                                                 
           MOVE SPACES                   TO TPK-CMMA.                   
                                                                        
           MOVE ITK-KEY-IITK IN ITK      TO TPK-CIC-IITK                
           MOVE 1                        TO TPK-NUM-SECU                
           MOVE MPC-N                    TO TPK-NUM-CORP                
           MOVE CCU-CIC-ICLF IN CCU-VARI TO WSS-CIC-ICLF IN WSS-VARI    
           MOVE CCU-CIC-ICLI IN CCU-VARI TO WSS-CIC-CLIC IN WSS-VARI    
           MOVE WSS-COD-ENTT IN WSS-VARI TO TPK-GLS-PARA                
                                                                        
           MOVE WSS-GNSPPPDT             TO SYS-PROG.                   
           MOVE TPK-TCMA                 TO SYS-TCMA.                   
           MOVE TPK-CMMA                 TO SYS-CMMA.                   
           MOVE SYS-LINK                 TO SYS-CMND.                   
           PERFORM GNS-PRO-SYS.                                         
                                                                        
GGG        MOVE SYS-CMMA                 TO TPK-CMMA.                   
           MOVE 'LDCPQCLG' TO QUE-COLA.                                 
           MOVE +1000 TO QUE-LITM.                                      
           MOVE QUE-PUT  TO QUE-CMND.                                   
           MOVE TPK-CMMA TO QUE-ITEM.                                   
           PERFORM GNS-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE TPK-COD-MENS             TO MSG-COD-MENS                
           MOVE TPK-GLS-MENS             TO MSG-GLS-DESC                
           IF MSG-COD-MENS     > SPACES                                 
              MOVE 'S'                   TO SCR-IERR                    
              MOVE MSG-GLS-DESC          TO FRM-MENS CLG-GLS-MENS.      
ZX    *       GO TO MSG-FND-KEY.                                        
       FIN-INS-PTK-CCU.                                                 
           EXIT.                                                        
                                                                        
       SUB-ITK-BATCH SECTION.                                           
       INI-SUB-ITK-BATCH.                                               
                                                                        
           MOVE SPACES     TO WSS-HDR.                                  
           MOVE SPACES     TO PT-010.                                   
           MOVE 'HV01'     TO WSS-HDR-VERS.                             
           MOVE 'BCI'      TO WSS-HDR-BNCO.                             
           MOVE 'BCI'      TO WSS-HDR-MRCA.                             
           MOVE 'BEE'      TO WSS-HDR-CART.                             
           MOVE 'ES'       TO WSS-HDR-LENG.                             
           MOVE 'CL'       TO WSS-HDR-PAIS.                             
           MOVE 'GNSPPTPG' TO WSS-HDR-PROG.                             
                                                                        
           MOVE WSS-HDR    TO PT-010-AHDR.                              
           MOVE '010'      TO PT-010-CREQ.                              
           MOVE 'GMEC'     TO PT-010-01-BCH-COD-PROC.                   
           MOVE 'LDC'      TO PT-010-05-APT-COD-SIST.                   
                                                                        
           MOVE SXI-NUM-L6 TO SXI-COD-TCPIP.                            
           MOVE 'X'        TO SXI-COD-ISGMT.                            
           MOVE ITK-CIC-IITK IN ITK TO                                  
                PT-010-02-FRM-DAT-DATO IN PT-010(1).                    
           MOVE '0001' TO                                               
                PT-010-02-FRM-DAT-DATO IN PT-010(2).                    
           MOVE PT-010     TO SXI-PT.                                   
                                                                        
           MOVE 'GNSPPSXY' TO SYS-PROG.                                 
           MOVE +1000 TO SYS-TCMA.                                      
           MOVE SXI-GNSPPSXI TO SYS-CMMA.                               
           MOVE SYS-LINK TO SYS-CMND.                                   
           PERFORM GNS-PRO-SYS.                                         
???   *   MSG-COD-MENS, MSG-GLS-DESC                                    
                                                                        
           IF MSG-COD-MENS NOT > SPACES                                 
              MOVE TCK-CIC-ITCK IN TCK-CMMA TO FRM-GLS-TICK IN CLG-FLD  
              MOVE TCK-FEC-FPRO IN TCK-CMMA TO WSS-FEC-FECH             
              MOVE WSS-NUM-DFEC             TO FRM-NUM-DECH IN CLG-FLD  
              MOVE WSS-NUM-MFEC             TO FRM-NUM-MECH IN CLG-FLD  
              MOVE WSS-NUM-SFEC             TO FRM-NUM-SECH IN CLG-FLD  
              MOVE WSS-NUM-AFEC             TO FRM-NUM-AECH IN CLG-FLD  
              MOVE TCK-HRA-HRPR IN TCK-CMMA TO FRM-HRA-HORA IN CLG-FLD  
           ELSE                                                         
              MOVE MSG-GLS-DESC TO FRM-MENS CLG-GLS-MENS                
              MOVE 'S' TO SCR-IERR                                      
              GO TO MSG-FND-KEY.                                        
       FIN-SUB-ITK-BATCH.                                               
           EXIT.                                                        
                                                                        
      * GVI-FIN                                                         
      *>>>> EOF
*% END
