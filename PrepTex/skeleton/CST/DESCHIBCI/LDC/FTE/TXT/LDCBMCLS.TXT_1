*%! Codigo adicional
*% IF FIN_EDT_FLD_CLS
      *<<<< FIN_EDT_FLD_CLS
           MOVE CLS-FLD TO SCR-CLS-FLD.
      *>>>>
*% END
*% IF INI_FST_KEY_CLS
      *<<<< INI_FST_KEY_CLS
           MOVE -1 TO DBC-NUM-ICLI-LEN IN CLS-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_CLS
      *<<<< FIN_PUT_DBC_CLS
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN CLS-FLD.
      * GVI-INI mod. MEC 30-OCT-2006                                    
           IF FRM-IIC-ISLC   IN CLS-FLD > SPACES                        
              MOVE 'N'              TO WSS-IND-SWT1                     
                                       WSS-IND-SWT2.                    
           MOVE WSS-GLS-SWIX        TO FRM-COD-SWIX IN CLS-FLD.         
      * GVI-FIN                                                         
      *>>>>
*% END
*% IF FIN_CLR_KEY_CLS
      *<<<< FIN_CLR_KEY_CLS                                             
      * GVI-INI Mod. MEC 30-OCT-2006                                    
           MOVE 'NNNN' TO FRM-COD-SWIX IN CLS-FLD.                      
      * GVI-FIN                                                         
      *>>>>                                                             
*% END
*% IF FIN_VAL_CON_KEY_CLS
      *<<<< FIN_VAL_CON_KEY_CLS                                         
      * GVI-INI mod. MEC 30-OCT-2006                                    
           MOVE FRM-COD-SWIX   IN CLS-FLD TO WSS-GLS-SWIX.              
                                                                        
           IF   WSS-IND-SWT3    = 'S'  AND                              
                FRM-GLS-TICK IN CLS-FLD     > SPACES                    
               GO TO FIN-OBL-KEY.                                       
                                                                        
           IF   WSS-IND-SWT3    = 'S'  AND                              
              ( FRM-FEC-FECH IN CLS-FLD NOT > ZEROES                    
                OR                                                      
                FRM-HRA-HORA IN CLS-FLD NOT > ZEROES )                  
               PERFORM ERR-KEY                                          
               PERFORM FST-KEY-CLS.                                     
PVG        IF NOT SCR-OFRM-SRV                                          
           IF    DBC-GLS-NOMC IN CLS-FLD  NOT > SPACES                  
             AND DBC-NUM-ICLI IN CLS-FLD  NOT > ZEROES                  
               PERFORM ERR-KEY                                          
               PERFORM FST-KEY-CLS.                                     
                                                                        
        FIN-OBL-KEY.                                                    
      * GVI-FIN                                                         
      *>>>>                                                             
*% END
*% IF INI_VAL_CON_IKY_CLS
      *>>>>
PVG        IF     DBC-GLS-NOMC IN CLS-FLD NOT > SPACES                  
PVG   * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON                          
PVG           AND DBC-NUM-ICLI IN CLS-FLD NOT > ZEROES                  
PVG           AND DBC-VRF-ICLI IN CLS-FLD NOT > SPACES                  
PVG           AND DBC-IND-ICLI IN CLS-FLD NOT > SPACES                  
PVG           AND DBC-GLS-ICLI IN CLS-FLD NOT > IDC-INIC-GLS            
PVG   * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON                          
PVG           AND FRM-CAI-ISLC IN CLS-FLD NOT > SPACES                  
PVG           AND FRM-IIC-ISLC IN CLS-FLD NOT > SPACES                  
PVG           AND FRM-COD-SWIX IN CLS-FLD NOT > SPACES                  
PVG           AND FRM-GLS-TICK IN CLS-FLD NOT > SPACES                  
PVG           AND FRM-FEC-FECH IN CLS-FLD NOT > ZEROES                  
PVG           AND FRM-HRA-HORA IN CLS-FLD NOT > ZEROES                  
PVG           AND DBC-CAI-ICLI IN CLS-FLD NOT > SPACES                  
PVG           AND DBC-IIC-ICLI IN CLS-FLD NOT > SPACES                  
      *>>>>
*% END
