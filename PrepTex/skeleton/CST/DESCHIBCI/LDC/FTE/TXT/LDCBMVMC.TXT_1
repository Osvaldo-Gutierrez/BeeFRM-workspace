*% IF INI_PUT_DBC_VMC
      *<<<< INI_PUT_DBC_VMC
           IF SCR-IND-MCLI = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN VMC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN VMC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN VMC-FLD
      *        CLF con multiples clientes
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLF    MDEU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE 'M' TO DBC-IND-ICLI IN VMC-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN VMC-FLD
               GO TO FIN-PUT-DBC-VMC.
           IF SCR-IND-MCLI NOT = 'M'
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.

           IF DBC-FEC-FINP IN DBC = ZEROES
               IF DBC-MSC-TACC = 'I'
                   MOVE DBC-FEC-FTRN IN DBC TO DBC-FEC-FINP IN DBC.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_VMC
      *<<<< FIN_VAL_CON_KEY_VMC
           IF NOT ( DBC-NUM-ICLI IN VMC-FLD NOT = ZEROES OR
                    DBC-GLS-NOMC IN VMC-FLD > SPACES OR
                    CLF-IIC-ICLF IN VMC-FLD > ZEROES )
                      MOVE 'GNS' TO MSG-COD-SIST
                      MOVE 'VALCONKEY' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO FIN-VAL-CON-KEY-VMC.
           IF ( DBC-NUM-ICLI IN VMC-FLD NOT = ZEROES OR
                DBC-GLS-NOMC IN VMC-FLD > SPACES ) AND
                CLF-IIC-ICLF IN VMC-FLD > ZEROES
                  MOVE 'GNS' TO MSG-COD-SIST
                  MOVE 'VALCONKEY' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-CON-KEY-VMC.
           IF NOT (( OPC-COD-VCOC IN VMC-FLD = SPACES AND
                     OPC-COD-TOOC IN VMC-FLD = SPACES AND
                     OPC-COD-AOOC IN VMC-FLD = SPACES AND
                     FRM-NUM-MESC IN VMC-FLD = ZEROES AND
                     OPC-VAL-CRED IN VMC-FLD = ZEROES ) OR
                   ( OPC-COD-VCOC IN VMC-FLD > SPACES AND   
                     OPC-COD-TOOC IN VMC-FLD > SPACES AND
                     OPC-COD-AOOC IN VMC-FLD > SPACES AND
                     FRM-NUM-MESC IN VMC-FLD > ZEROES AND
                     OPC-VAL-CRED IN VMC-FLD > ZEROES ))
                       MOVE 'GNS' TO MSG-COD-SIST
                       MOVE 'VALCONKEY' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-KEY-VMC.
      *>>>>
*% END
*% IF FIN_PUT_CLF_VMC
      *<<<< FIN_PUT_CLF_VMC
      *BUS-OFI busca oficina en tablas
           IF CLF-COD-OFIC IN CLF > SPACES
               MOVE CLF-COD-OFIC IN CLF TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN VMC-FLD.
      *BUS-USR busca usuario en tablas
           IF CLF-COD-EJEC IN CLF > SPACES
               MOVE CLF-COD-EJEC IN CLF TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DCOR IN USR TO FRM-GLS-EJEC IN VMC-FLD.
      *>>>>
*% END
*% IF INI_OPC_COD_VCOC
      *<<<< INI_OPC_COD_VCOC
           IF OPC-COD-VCOC IN VMC-FLD NOT > SPACES
              GO TO FIN-VAL-OPC-COD-VCOC.
      *>>>>
*% END
*% IF INI_OPC_COD_TOOC
      *<<<< INI_OPC_COD_TOOC
           IF OPC-COD-TOOC IN VMC-FLD NOT > SPACES
              GO TO FIN-VAL-OPC-COD-TOOC.
      *>>>>
*% END
*% IF INI_OPC_COD_AOOC
      *<<<< INI_OPC_COD_AOOC
           IF OPC-COD-AOOC IN VMC-FLD NOT > SPACES
              GO TO FIN-VAL-OPC-COD-AOOC.
      *>>>>
*% END
*% IF OPC_COD_AOOC
      *<<<< OPC_COD_AOOC
           MOVE 'COL'                    TO TAB-COD-SIST.
           MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN VMC-FLD  TO WSS-COD-TOOC IN WSS-VARI.
           MOVE OPC-COD-AOOC IN VMC-FLD  TO WSS-COD-AOOC IN WSS-VARI.
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OPC-COD-AOOC IN VMC-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN VMC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOOC IN VMC-FLD.
      *>>>>
*% END
*% IF INI_OPC_VAL_CRED
      *<<<< INI_OPC_VAL_CRED
           IF OPC-VAL-CRED IN VMC-FLD NOT > SPACES
              GO TO FIN-VAL-OPC-VAL-CRED.
      *>>>>
*% END
