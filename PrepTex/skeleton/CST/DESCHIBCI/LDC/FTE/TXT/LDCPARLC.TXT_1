*%! Codigo adicional para archivo LDCPQRLC
*% IF SETTAG
*% FNCPQ = " "
*% VSNPQ = " "
*% FNCPU = " "
*% VSNPU = " "
*% END
*% LARGO_MI_COMMAREA = 56
*% PGM_PTC = TRUE
*% IF PGM_PU
*% IF CMT_ID
      *<<<<
      * Nuevo Requerimiento
      * Objetivo:
      * Incorporar generacion de movimientos contables en entidad LMO
      * Nombre Proyecto: Contabilidad Inmobiliaria
      * Fecha: Noviembre 2008
      * Programador: EVA-AFRI / MAE-AFRI
      *>>>>
*% END
*% END
*% IF MI_COMMAREA                                                 
      *<<<< MI_COMMAREA                                                 
           03 CMA-VARI.
              05 WSS-FEC-FOPE.
                 07  WSS-NUM-SOPE                       PIC 9(02).
                 07  WSS-NUM-AOPE                       PIC 9(02).
                 07  WSS-NUM-MOPE                       PIC 9(02).
                 07  WSS-NUM-DOPE                       PIC 9(02).

              05 WSS-FEC-FIDE.
                 07  WSS-NUM-DIDE                       PIC 9(02).
                 07  WSS-NUM-MIDE                       PIC 9(02).
                 07  WSS-NUM-SIDE                       PIC 9(02).
                 07  WSS-NUM-AIDE                       PIC 9(02).

              05 WSS-FEC-FRLC.
                 07  WSS-NUM-SRLC                       PIC 9(02).
                 07  WSS-NUM-ARLC                       PIC 9(02).
                 07  WSS-NUM-MRLC                       PIC 9(02).
                 07  WSS-NUM-DRLC                       PIC 9(02).

              05 WSS-COD-VCOC                           PIC X(06).
              05 WSS-COD-VCAM                           PIC X(06).
      *>>>>
*% END
*% IF WSS                                                         
      *<<<< WSS                                                         
       COPY GNSWGPES.
       COPY GNSWGCPT.
       COPY TABBRCAM.
       COPY LDCBRRDC REPLACING RDC BY RDL.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDL-REQA==.
       COPY COLBROPC.
       COPY COLBRRDC.
*% IF PGM_PU
       COPY COLBRRCV.
       COPY COLBRCAN.
*% END
       COPY LDCBRCLF.
       COPY LDCBRLDC.
       COPY LDCBRLCC.
       COPY LDCBRACG.
       COPY LDCBRACL.
       COPY SGCBRDBC.
       COPY LDCWGLIC.
*% IF PGM_PU
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       COPY LDCBRLMO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LMO-REQA==.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
*% END
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
*% IF PGM_PU
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
*% END
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACG-REQA==.
*% IF PGM_PQ
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACL-REQA==.
*% END
       01 WSS.
*% IF PGM_PQ
          03  WSS-IFIN      VALUE SPACES   PIC X(01).
          03  WSS-IFLD       VALUE ZEROES        PIC 9(02).
          03  WSS-IMAX       VALUE ZEROES        PIC 9(02).
          03  WSS-MOV        VALUE ZEROES        PIC 9(02).
          03  ACG-KEY-IACG.
               05  ACG-KEY-ILDC.
                   07  ACG-CAI-ICLF               PIC X(04).
                   07  ACG-IIC-ICLF               PIC X(08).
                   07  ACG-NUM-ILDC               PIC 9(02).
          03  WSS-GLS-DATA.
               05  WSS-GLS-FIL1                   PIC X(03).
               05  WSS-GLS-ENTI                   PIC X(05).
               05  WSS-GLS-FIL2                   PIC X(52).

       01 WSS-VARI.
          03  WSS-IND-RLDC                        PIC X(01).
          03  WSS-IND-ROPC                        PIC X(01).
          03  WSS-VAL-DISP                        PIC S9(11)V9(04).
          03  WSS-VAL-MACU                        PIC S9(11)V9(04).
          03  WSS-VAL-SOPC                        PIC  9(11)V9(04).
          03  WSS-COD-PESO                        PIC X(06).
          03  WSS-COD-UEFE                        PIC X(06).

          03  WSS-IND-TIPO                        PIC X(03).
          03  WSS-COD-TIPO                        PIC X(03).
          03  WSS-COD-LTIP                        PIC X(03).

          03  WSS-CIC-ICLI                        PIC X(12).

          03  WSS-GLS-DAT1.
              05  WSS-COD-DAT1                          PIC X(51).
              05  WSS-COD-DATA                          PIC X(03).
              05  WSS-COD-DAT5                          PIC X(06).
*% END
*% IF PGM_PU
          03  WSS-IFIN      VALUE SPACES   PIC X(01).
          03  WSS-IFLD       VALUE ZEROES        PIC 9(02).
          03  WSS-IMAX       VALUE ZEROES        PIC 9(02).
          03  WSS-MOV        VALUE ZEROES        PIC 9(02).
          03  ACG-KEY-IACG.
               05  ACG-KEY-ILDC.
                   07  ACG-CAI-ICLF               PIC X(04).
                   07  ACG-IIC-ICLF               PIC X(08).
                   07  ACG-NUM-ILDC               PIC 9(02).
          03  WSS-GLS-DATA.
               05  WSS-GLS-FIL1            PIC X(03).
               05  WSS-GLS-ENTI            PIC X(05).
               05  WSS-GLS-FIL2            PIC X(52).

       01 WSS-VARI.
          03 WSS-FEC-FNVA.
              05  WSS-NUM-SNVA                    PIC 9(02).
              05  WSS-NUM-ANVA                    PIC 9(02).
              05  WSS-NUM-MNVA                    PIC 9(02).
              05  WSS-NUM-DNVA                    PIC 9(02).

          03 WSS-NUM-IRLC                         PIC 9(03).

          03 WSS-FEC-FELI.
              05  WSS-NUM-SELI                    PIC 9(02).
              05  WSS-NUM-AELI                    PIC 9(02).
              05  WSS-NUM-MELI                    PIC 9(02).
              05  WSS-NUM-DELI                    PIC 9(02).

          03 WSS-FEC-FDEL.
              05  WSS-NUM-SDEL                    PIC 9(02).
              05  WSS-NUM-ADEL                    PIC 9(02).
              05  WSS-NUM-MDEL                    PIC 9(02).
              05  WSS-NUM-DDEL                    PIC 9(02).

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
          03 WSS-IND-RRLC       VALUE SPACES      PIC X(01).
          03 WSS-IND-REXI       VALUE SPACES      PIC X(01).
          03 WSS-IND-RDES       VALUE SPACES      PIC X(01).
          03 WSS-IND-SOPC       VALUE SPACES      PIC X(01).
          03 WSS-IND-CMAX       VALUE SPACES      PIC X(01).
          03 WSS-IND-MTO2       VALUE SPACES      PIC X(01).
          03 WSS-COD-OFIC       VALUE SPACES      PIC X(03).
          03 WSS-COD-TOOC       VALUE SPACES      PIC X(03).
          03 WSS-COD-AOOC       VALUE SPACES      PIC X(03).
          03 WSS-TAB-VCAM       VALUE SPACES      PIC X(06).
          03 WSS-LDC-VCAM       VALUE SPACES      PIC X(06).
          03 WSS-LCC-VCAM       VALUE SPACES      PIC X(06).
          03 WSS-SGV-MTO2       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-VAL-MTO2       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-VAL-CMAX       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-VAL-MUTI       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-IND-EOPC       VALUE ZEROES      PIC 9(02).
      * EVA-FIN  11/08
      *MAE
          03 WSS-CIC-ILDC.
             05 WSS-CAI-ILDC                      PIC X(04).
             05 WSS-IIC-ILDC                      PIC X(08).
          03 WSS-NUM-ILDC                         PIC 9(02).
          03 WSS-IND-ERRO                         PIC X(01).
          03 WSS-SAL-MTO2       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-VAL-VCAM       VALUE ZEROES      PIC 9(11)V9(04).
      *MAE
          03 WSS-VAL-CRED                         PIC 9(11)V9(04).
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
          03 WSS-CAI-ICLF                         PIC X(04).
          03 WSS-IIC-ICLF                         PIC X(08).
          03 WSS-CAI-IOPC                         PIC X(04).
          03 WSS-IIC-IOPC                         PIC X(08).
          03 WSS-NUM-IOPC                         PIC X(03).
          03 WSS-COD-PESO                         PIC X(06).
          03 WSS-COD-UEFE                         PIC X(06).
          03 WSS-VAL-SOPC                         PIC 9(11)V9(04).
*% END
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<<

           PERFORM KEY-ALL-RLC.
           IF RLC-CAI-ICLF IN RLC-FLD NOT > SPACES AND                  
              RLC-IIC-ICLF IN RLC-FLD NOT > ZEROES AND                  
              RLC-CAI-IOPC IN RLC-FLD > SPACES AND                      
              RLC-IIC-IOPC IN RLC-FLD > ZEROES                          
              MOVE 'RLC-KEY-IOPC' TO FIO-AKEY                           
           ELSE
              IF RLC-CAI-IOPC IN RLC-FLD NOT > SPACES AND               
                 RLC-IIC-IOPC IN RLC-FLD NOT > ZEROES                   
                 MOVE FIO-GET-NLS TO FIO-CMND                           
                 PERFORM LDC-FIO-RLC
                 IF FIO-STAT-OKS AND
                    RLC-CAI-ICLF IN RLC-FLD = RLC-CAI-ICLF IN RLC AND
                    RLC-IIC-ICLF IN RLC-FLD = RLC-IIC-ICLF IN RLC
                    MOVE RLC-STP-ITRN IN RLC TO SCR-UMOD
                    MOVE RLC-CAI-IOPC IN RLC TO RLC-CAI-IOPC IN RLC-FLD
                    MOVE RLC-IIC-IOPC IN RLC TO RLC-IIC-IOPC IN RLC-FLD
                    MOVE RLC-NUM-IOPC IN RLC TO RLC-NUM-IOPC IN RLC-FLD
                    GO TO RLC-FND-KEY.

      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       RLC-FND-KEY.
           MOVE FIO-STAT TO PGM-STAT-RLC.
           IF (SCR-CCPP = 'ING') OR (SCR-CCPP = 'ACT' AND               
               NOT PGM-STAT-RLC-OKS)                                    
               PERFORM BUS-ENT-ANEX                                     
               IF WSS-IFIN = 'S'                                        
                   GO TO FIN-FND-KEY.                                   
           IF SCR-CMND = 'ELI' AND PGM-STAT-RLC-OKS AND
               RLC-MSC-STAT IN RLC NOT = 'I'
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CMNDELINEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           MOVE PGM-STAT-RLC TO FIO-STAT.
      *>>>>
*% END
*% IF FIN_PUT_SCR
      *<<<<
           PERFORM BUS-ENT-ANEX.
           PERFORM PUT-ALL-RLC.
      *>>>>
*% END
*% IF PGM_PQ
*% IF FIN_HBL_FLD
      *<<<<
           IF SCR-CMND = 'RBJ'
              MOVE FRM-CPIM-AEY TO FRM-VAL-MLIB-ATR IN RLC-FLD.
           IF SCR-CMND = 'ING'
              MOVE FRM-CPIM-AEY TO RLC-COD-CGTA-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO RLC-COD-DENV-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO FRM-VAL-MLIB-ATR IN RLC-FLD
              MOVE 0            TO RLC-COD-CGTA-LEN IN RLC-FLD
              MOVE -1           TO RLC-NUM-IOPC-LEN IN RLC-FLD.
           IF SCR-CMND = 'LIB'
              MOVE FRM-CPIM-AEY TO RLC-COD-CGTA-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO RLC-COD-DENV-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO RLC-COD-CGAR-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO RLC-COD-DESO-ATR IN RLC-FLD
              MOVE 0            TO RLC-COD-CGTA-LEN IN RLC-FLD
              MOVE -1           TO FRM-VAL-MLIB-LEN IN RLC-FLD
              MOVE FRM-CPIM-UBY TO FRM-VAL-MLIB-ATR IN RLC-FLD.
           IF SCR-CMND = 'ANC'
              MOVE FRM-CPIM-AEY TO RLC-COD-CGTA-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO RLC-COD-DENV-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO RLC-COD-CGAR-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO RLC-COD-DESO-ATR IN RLC-FLD
              MOVE 0            TO RLC-COD-CGTA-LEN IN RLC-FLD
              MOVE -1           TO FRM-VAL-MLIB-LEN IN RLC-FLD
              MOVE FRM-CPIM-UBY TO FRM-VAL-MLIB-ATR IN RLC-FLD.

      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBBTAB.
       COPY GNSBGCPT.
       COPY SGCBFDBC.
       COPY LDCBFLDC.
       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY TABBFCAM.
       COPY LDCBFLCC.
       COPY LDCBFRDC REPLACING RDC BY RDL
                    ==ADR-RDC-REQA== BY ==ADR-RDL-REQA==.
       COPY LDCBFCLF.
       COPY LDCBFACG.
       COPY LDCBFACL.
      *>>>>
      *<<<< EOF_PQ
       COPY GNSBGPES.
       BUS-ENT-ANEX SECTION.
       INI-BUS-ENT-ANEX.
           MOVE RLC-CAI-ICLF IN RLC TO CLF-CAI-ICLF IN CLF.             
           MOVE RLC-IIC-ICLF IN RLC TO CLF-IIC-ICLF IN CLF.             
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU' TO MSG-COD-SIST                               
               MOVE 'CLF    NOEXI' TO MSG-COD-MENS                      
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX
           ELSE
               MOVE 'DEU'                  TO FIO-SIST
               MOVE 'CNT'                  TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN CLF    TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY            TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
                 MOVE 'DEU'             TO MSG-COD-SIST
                 MOVE 'TIONOCONST'      TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE '00' TO FIO-STAT
                 MOVE SCR-STAT-CON TO SCR-STAT
                 MOVE 'S'          TO WSS-IFIN
                 GO TO FIN-BUS-ENT-ANEX.

           IF CLF-MSC-STAT IN CLF = 'I' OR
              CLF-MSC-STAT IN CLF = 'T' OR
              CLF-MSC-STAT IN CLF = 'R'
               MOVE 'DEU' TO MSG-COD-SIST                               
               MOVE 'CLF    NOACA' TO MSG-COD-MENS                      
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           MOVE CLF-NUM-SAPE IN CLF TO WSS-NUM-SRLC IN CMA-VARI.
           MOVE CLF-NUM-AAPE IN CLF TO WSS-NUM-ARLC IN CMA-VARI.
           MOVE CLF-NUM-MAPE IN CLF TO WSS-NUM-MRLC IN CMA-VARI.
           MOVE CLF-NUM-DAPE IN CLF TO WSS-NUM-DRLC IN CMA-VARI.

           MOVE CLF-CIC-ICLF IN CLF TO LCC-CIC-ICLF IN LCC.
           MOVE RLC-NUM-ILDC IN RLC TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
      *        RLC NO TIENE LCC ASOCIADO
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'LCC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           IF LCC-VAL-MADJ IN LCC NOT > ZEROES  AND
              SCR-CMND = 'ING'
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'MLIB NO> 0' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           MOVE LCC-CAI-ICLF IN LCC TO LDC-CAI-ICLF IN LDC.
           MOVE LCC-IIC-ICLF IN LCC TO LDC-IIC-ICLF IN LDC.
           MOVE RLC-NUM-ILDC IN RLC TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT FIO-STAT-OKS
      *        LDC no tiene CLF asociado
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'LDC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           IF LDC-MSC-STAT IN LDC = 'R'
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'LDC    REC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

      * EVA-INI   ABR-2009  MANTENCION INGRESO RLC
           IF LDC-MSC-STAT IN LDC = 'I'
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'LDC NO ACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.
      * EVA-FIN   ABR-2009  MANTENCION INGRESO RLC

           MOVE LDC-COD-VCLC IN LDC TO WSS-COD-VCAM IN CMA-VARI.
           MOVE LDC-NUM-SINI IN LDC TO WSS-NUM-SIDE IN CMA-VARI.
           MOVE LDC-NUM-AINI IN LDC TO WSS-NUM-AIDE IN CMA-VARI.
           MOVE LDC-NUM-MINI IN LDC TO WSS-NUM-MIDE IN CMA-VARI.
           MOVE LDC-NUM-DINI IN LDC TO WSS-NUM-DIDE IN CMA-VARI.

           COMPUTE WSS-VAL-DISP IN WSS-VARI =
                   LCC-VAL-MADJ IN LCC -
                   LCC-VAL-MUTI IN LCC.

           MOVE CLF-CAI-ICLF IN CLF TO RDC-CAI-ICLF IN RDL.
           MOVE CLF-IIC-ICLF IN CLF TO RDC-IIC-ICLF IN RDL.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        CLF no tiene RDC asociado
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'RDC    NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           MOVE RDC-CIC-ICLI IN RDL TO WSS-CIC-ICLI IN WSS-VARI.

           MOVE RDC-CIC-ICLI IN RDL  TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
      *     RDC NO TIENE DBC ASOCIADO
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'DBC    NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           MOVE DBC-GLS-NOMC IN DBC  TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.

           MOVE LDC-COD-TIPO IN LDC TO WSS-COD-LTIP IN WSS-VARI.
           MOVE LDC-COD-TIPO IN LDC TO FRM-COD-TIPO IN RLC-FLD.
           MOVE LDC-GLS-DESC IN LDC TO FRM-GLS-DESC IN RLC-FLD.
           MOVE DBC-GLS-NOMC IN DBC TO FRM-GLS-NOMB IN RLC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-CLIE IN RLC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-CLIE IN RLC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-CLIE IN RLC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-CLIE IN RLC-FLD.


           IF RLC-NUM-IOPC IN RLC-FLD > ZEROES
               PERFORM BUSCA-DAT-LDC
           ELSE
               PERFORM BUSCA-DAT-COL.

           IF WSS-IFIN = 'S'                                            
              GO TO FIN-BUS-ENT-ANEX.                                   

           MOVE FRM-VAL-SOPC IN RLC-FLD TO WSS-VAL-SOPC IN WSS-VARI.
           IF RLC-NUM-IOPC IN RLC NOT > ZEROES
               IF WSS-COD-VCOC IN CMA-VARI NOT = LCC-COD-VCOC IN LCC
                   PERFORM CONVIERTE-VCOC
               ELSE
                    NEXT SENTENCE
           ELSE
               IF WSS-COD-VCOC IN CMA-VARI NOT = LCC-COD-VCOC IN LCC
                   PERFORM CONVIERTE-VCOC.

           IF SCR-CMND NOT = 'ING'
              GO TO NXT-BUS-ENT.

           IF WSS-VAL-DISP IN WSS-VARI < WSS-VAL-SOPC IN WSS-VARI
              MOVE 'DEU'           TO MSG-COD-SIST
              MOVE 'VAL  DIS>MAX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUS-ENT-ANEX.

              COMPUTE WSS-VAL-MACU IN WSS-VARI =
                      WSS-VAL-SOPC IN WSS-VARI +
                      LCC-VAL-MUTI IN LCC.

           IF LCC-VAL-MADJ IN LCC < WSS-VAL-MACU IN WSS-VARI
              MOVE 'DEU'           TO MSG-COD-SIST
              MOVE 'LIB<ACU+OPC ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUS-ENT-ANEX.

           IF WSS-FEC-FOPE IN CMA-VARI NOT > ZEROES
              MOVE 'DEU'         TO MSG-COD-SIST                        
              MOVE 'FEC OPCLDC0' TO MSG-COD-MENS                        
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUS-ENT-ANEX.

           IF WSS-FEC-FOPE IN CMA-VARI < WSS-FEC-FRLC IN CMA-VARI
              MOVE 'DEU'         TO MSG-COD-SIST                        
              MOVE 'ERR  FECMEN' TO MSG-COD-MENS                        
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUS-ENT-ANEX.

           IF CLF-MSC-STAT IN CLF = 'C'
      *        LDC eliminada
              MOVE 'DEU'           TO MSG-COD-SIST
              MOVE 'CLF    EXTING' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUS-ENT-ANEX.

       NXT-BUS-ENT.
           IF SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON
              MOVE PGM-STAT-RLC TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUS-ENT-ANEX.

           IF SCR-CCPP = 'ING'
              MOVE PGM-STAT-RLC TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUS-ENT-ANEX.


       FIN-BUS-ENT-ANEX.
           EXIT.

       BUSCA-DAT-COL SECTION.
       INI-BUSCA-DAT-COL.
           MOVE RLC-CAI-IOPC IN RLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE RLC-IIC-IOPC IN RLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
              MOVE 'DEU'           TO MSG-COD-SIST
              MOVE 'OPC     NEX'   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-COL.

           IF NOT (OPC-MSC-STAT IN OPC = 'A')
              MOVE 'DEU'         TO MSG-COD-SIST                        
              MOVE 'OPC   NOACA' TO MSG-COD-MENS                        
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-COL.

           IF OPC-IND-RENO IN OPC = 'REN' OR
              OPC-IND-RENO IN OPC = 'PRO'
              MOVE 'DEU'         TO MSG-COD-SIST                        
              MOVE 'OPC  ERRREN' TO MSG-COD-MENS                        
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-COL.

           MOVE 'DEU'          TO FIO-SIST.                             
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'LDC  OPC/LDC' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS AND                                         
              TAB-IND-VIGE IN TAB = 'S')                                
              MOVE 'COL'                  TO FIO-SIST                   
              MOVE 'AUX'                  TO TAB-COD-TTAB IN TAB        
              MOVE OPC-COD-COOC IN OPC    TO TAB-COD-CTAB IN TAB        
              MOVE FIO-GET-KEY            TO FIO-CMND                   
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS AND                                       
                 TAB-IND-VIGE IN TAB = 'S'                              
                 MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DAT1 IN WSS-VARI
                 IF NOT (WSS-COD-LTIP IN WSS-VARI =
                    WSS-COD-DATA IN WSS-VARI)
                    MOVE 'DEU'          TO MSG-COD-SIST
                    MOVE 'ERR     TIPO' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE SCR-STAT-CON TO SCR-STAT
                    MOVE '00' TO FIO-STAT
                    MOVE 'S'          TO WSS-IFIN
                    GO TO FIN-BUSCA-DAT-COL.

           MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SIDE IN CMA-VARI.
           MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AIDE IN CMA-VARI.
           MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MIDE IN CMA-VARI.
           MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DIDE IN CMA-VARI.

           MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SOPE IN CMA-VARI.
           MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AOPE IN CMA-VARI.
           MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MOPE IN CMA-VARI.
           MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DOPE IN CMA-VARI.

           MOVE OPC-COD-VCOC IN OPC TO WSS-COD-VCOC IN CMA-VARI.

           MOVE OPC-IND-GARA IN OPC TO RLC-COD-CGAR IN RLC-FLD.
           MOVE OPC-COD-CDOC IN OPC TO RLC-COD-DESO IN RLC-FLD.
           MOVE OPC-IND-GARA IN OPC TO RLC-COD-CGAR IN RLC-FLD.
           MOVE OPC-VAL-CRED IN OPC TO FRM-VAL-MOPC IN RLC-FLD.
           MOVE OPC-VAL-SCRE IN OPC TO FRM-VAL-SOPC IN RLC-FLD.


           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
              MOVE 'DEU'           TO MSG-COD-SIST
              MOVE 'OPC SIN CLI'   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-COL.

           IF SCR-CMND = 'ING' AND
              NOT (RDC-CIC-ICLI IN RDC = WSS-CIC-ICLI IN WSS-VARI)
              MOVE 'DEU'           TO MSG-COD-SIST
              MOVE 'DIF      CIC'  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-COL.

           MOVE RDC-CIC-ICLI  IN RDC  TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'DEU'         TO MSG-COD-SIST
              MOVE 'DBC    NEX'  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE '00'          TO FIO-STAT
              MOVE SCR-STAT-CON  TO SCR-STAT
              MOVE 'S'           TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-COL.

           MOVE DBC-GLS-NOMC IN DBC  TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NOMC IN RLC-FLD.

           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN RLC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN RLC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN RLC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN RLC-FLD.

           IF SCR-CMND = 'ING'
              MOVE DBC-COD-ACTI IN DBC TO RLC-COD-ACTI IN RLC-FLD.

       FIN-BUSCA-DAT-COL.
           EXIT.

       BUSCA-DAT-LDC SECTION.
       INI-BUSCA-DAT-LDC.
           MOVE RLC-CAI-IOPC IN RLC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE RLC-IIC-IOPC IN RLC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE RLC-NUM-IOPC IN RLC-FLD TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'           TO MSG-COD-SIST
               MOVE 'LDC SIN LIC'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE '00' TO FIO-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUSCA-DAT-LDC.

           MOVE 'DEU'          TO FIO-SIST.                             
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'LDC  OPC/LDC' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS AND                                         
              TAB-IND-VIGE IN TAB = 'S')                                
              IF NOT (LDC-COD-TIPO IN LDC =
                 WSS-COD-LTIP IN WSS-VARI)
                 MOVE 'DEU'          TO MSG-COD-SIST
                 MOVE 'ERR     TIPO' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE SCR-STAT-CON TO SCR-STAT
                 MOVE '00' TO FIO-STAT
                 MOVE 'S'          TO WSS-IFIN
                 GO TO FIN-BUSCA-DAT-LDC.

           MOVE SPACES              TO RLC-COD-DESO IN RLC-FLD.
           MOVE SPACES              TO RLC-COD-CGAR IN RLC-FLD.
           MOVE LDC-VAL-CMAX IN LDC TO FRM-VAL-MOPC IN RLC-FLD.
           MOVE LDC-VAL-CMAX IN LDC TO FRM-VAL-SOPC IN RLC-FLD.

           MOVE LDC-NUM-SINI IN LDC TO WSS-NUM-SIDE IN CMA-VARI.
           MOVE LDC-NUM-AINI IN LDC TO WSS-NUM-AIDE IN CMA-VARI.
           MOVE LDC-NUM-MINI IN LDC TO WSS-NUM-MIDE IN CMA-VARI.
           MOVE LDC-NUM-DINI IN LDC TO WSS-NUM-DIDE IN CMA-VARI.

           MOVE LDC-NUM-SINI IN LDC TO WSS-NUM-SOPE IN CMA-VARI.
           MOVE LDC-NUM-AINI IN LDC TO WSS-NUM-AOPE IN CMA-VARI.
           MOVE LDC-NUM-MINI IN LDC TO WSS-NUM-MOPE IN CMA-VARI.
           MOVE LDC-NUM-DINI IN LDC TO WSS-NUM-DOPE IN CMA-VARI.

           MOVE LDC-COD-VCLC IN LDC TO WSS-COD-VCOC IN CMA-VARI.
           MOVE LDC-COD-TIPO IN LDC TO WSS-IND-TIPO IN WSS-VARI.

           MOVE LDC-CAI-ICLF IN LDC TO CLF-CAI-ICLF IN CLF.
           MOVE LDC-IIC-ICLF IN LDC TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'CLF    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE '00' TO FIO-STAT
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-LDC.

           IF CLF-MSC-STAT IN CLF = 'I' OR
              CLF-MSC-STAT IN CLF = 'T' OR
              CLF-MSC-STAT IN CLF = 'R'
              MOVE 'DEU' TO MSG-COD-SIST                                
              MOVE 'CLF    NOACA' TO MSG-COD-MENS                       
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE '00' TO FIO-STAT
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-LDC.

           MOVE LDC-CAI-ICLF IN LDC TO RDC-CAI-ICLF IN RDL.
           MOVE LDC-IIC-ICLF IN LDC TO RDC-IIC-ICLF IN RDL.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
            IF NOT ( FIO-STAT-OKS AND
               LDC-CAI-ICLF IN LDC = RDC-CAI-ICLF IN RDL AND
               LDC-IIC-ICLF IN LDC = RDC-IIC-ICLF IN RDL )
                MOVE 'DEU'         TO MSG-COD-SIST
                MOVE 'RDC    NEX'  TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC  TO FRM-MENS
                MOVE '00'          TO FIO-STAT
                MOVE SCR-STAT-CON  TO SCR-STAT
                MOVE 'S'           TO WSS-IFIN
                GO TO FIN-BUSCA-DAT-LDC.

           IF SCR-CMND = 'ING' AND
              NOT (RDC-CIC-ICLI IN RDL = WSS-CIC-ICLI IN WSS-VARI)
              MOVE 'DEU'           TO MSG-COD-SIST
              MOVE 'DIF      CIC'  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE '00' TO FIO-STAT
              MOVE 'S'          TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-LDC.

           MOVE RDC-CIC-ICLI  IN RDL  TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'DEU'         TO MSG-COD-SIST
              MOVE 'DBC    NEX'  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE '00'          TO FIO-STAT
              MOVE SCR-STAT-CON  TO SCR-STAT
              MOVE 'S'           TO WSS-IFIN
              GO TO FIN-BUSCA-DAT-LDC.

           MOVE DBC-GLS-NOMC IN DBC  TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NOMC IN RLC-FLD.

           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN RLC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN RLC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN RLC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN RLC-FLD.

           IF SCR-CMND = 'ING'
              MOVE DBC-COD-ACTI IN DBC TO RLC-COD-ACTI IN RLC-FLD.

       FIN-BUSCA-DAT-LDC.
           EXIT.
      *>>>>                                                             
       CONVIERTE-VCOC SECTION.
       INI-CONVIERTE-VCOC.

           IF WSS-COD-VCOC IN CMA-VARI = LCC-COD-VCOC IN LCC
              GO TO FIN-CONVIERTE-VCOC.

           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.                     
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.        

           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.                     
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.        

           IF WSS-COD-VCOC IN CMA-VARI = WSS-COD-PESO IN WSS-VARI AND
              LCC-COD-VCOC IN LCC NOT  = WSS-COD-PESO IN WSS-VARI
               MOVE LCC-COD-VCOC IN LCC      TO CAM-COD-VCAM IN CAM(1)  
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)  
               MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1)  
               MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1)  
               MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1)  
               MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1)  
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
               IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')   
                    MOVE 'DEU' TO MSG-COD-SIST
                    MOVE 'CAM    NEX' TO MSG-COD-MENS                   
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC  TO FRM-MENS
                    MOVE '00'          TO FIO-STAT
                    MOVE SCR-STAT-CON  TO SCR-STAT
                    MOVE 'S'           TO WSS-IFIN
                    GO TO FIN-CONVIERTE-VCOC
               ELSE
                    COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
                    FRM-VAL-SOPC IN RLC-FLD / CAM-SGV-VCAM IN CAM
                    GO TO FIN-CONVIERTE-VCOC.

           IF LCC-COD-VCOC IN LCC      = WSS-COD-PESO IN WSS-VARI AND
              WSS-COD-VCOC IN CMA-VARI NOT = WSS-COD-PESO IN WSS-VARI
               MOVE WSS-COD-VCOC IN CMA-VARI TO CAM-COD-VCAM IN CAM(1)  
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)  
               MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1)  
               MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1)  
               MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1)  
               MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1)  
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
               IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')   
                    MOVE 'DEU' TO MSG-COD-SIST
                    MOVE 'CAM    NEX' TO MSG-COD-MENS                   
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC  TO FRM-MENS
                    MOVE '00'          TO FIO-STAT
                    MOVE SCR-STAT-CON  TO SCR-STAT
                    MOVE 'S'           TO WSS-IFIN
                    GO TO FIN-CONVIERTE-VCOC
               ELSE
                    COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
                    FRM-VAL-SOPC IN RLC-FLD * CAM-SGV-VCAM IN CAM
                    MOVE WSS-VAL-SOPC IN WSS-VARI TO
                         PES-SGV-DECI IN PES-VARI
                    PERFORM PES-SCTV
                    MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-VAL-SOPC IN WSS-VARI
                    GO TO FIN-CONVIERTE-VCOC.

           MOVE WSS-COD-VCOC IN CMA-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1).     
           MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1).     
           MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1).     
           MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')       
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               GO TO FIN-CONVIERTE-VCOC.

              COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
              FRM-VAL-SOPC IN RLC-FLD * CAM-SGV-VCAM IN CAM.

           MOVE LCC-COD-VCOC IN LCC      TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1).     
           MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1).     
           MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1).     
           MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')       
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               GO TO FIN-CONVIERTE-VCOC.

              COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
              WSS-VAL-SOPC IN WSS-VARI / CAM-SGV-VCAM IN CAM.

      *    IF LCC-COD-VCOC IN LCC = WSS-COD-UEFE IN WSS-VARI
      *       COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
      *       FRM-VAL-SOPC IN RLC-FLD / CAM-SGV-VCAM IN CAM
      *    ELSE
      *       COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
      *       FRM-VAL-SOPC IN RLC-FLD * CAM-SGV-VCAM IN CAM
      *       MOVE WSS-VAL-SOPC IN WSS-VARI TO
      *            PES-SGV-DECI IN PES-VARI
      *       PERFORM PES-SCTV
      *       MOVE PES-SGV-ENTE IN PES-VARI TO
      *            WSS-VAL-SOPC IN WSS-VARI.

       FIN-CONVIERTE-VCOC.
           EXIT.
      *>>>>
*% END
*% END
*% IF INI_CMN_ING
      *<<<<
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      * Inicializa Variables
           MOVE ZEROES TO WSS-NUM-IRLC IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-MTO2 IN WSS-VARI.
           MOVE RLC-CAI-IOPC IN RLC-FLD TO WSS-CAI-IOPC IN WSS-VARI.
           MOVE RLC-IIC-IOPC IN RLC-FLD TO WSS-IIC-IOPC IN WSS-VARI.

      * Busca datos en CLF para grabar entidad LMO
           PERFORM LEE-CLF.
      * Busca registros existentes
           PERFORM BUS-REG-RLC.
      * Busca ultima linea ingresada
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
           PERFORM BUS-LEQ-RLC.
           MOVE SPACES TO RLC.

      *>>>>
*% END
*% IF CMN_ING
      *<<<<
      * Busca existencia de Operacion
           MOVE RLC-CAI-IOPC IN RLC-FLD TO RLC-CAI-IOPC IN RLC.
           MOVE RLC-IIC-IOPC IN RLC-FLD TO RLC-IIC-IOPC IN RLC.
           IF RLC-NUM-IOPC IN RLC-FLD > ZEROES
              MOVE RLC-NUM-IOPC IN RLC-FLD TO RLC-NUM-IOPC IN RLC
           ELSE
              MOVE ZEROES                  TO RLC-NUM-IOPC IN RLC.

           MOVE 'RLC-KEY-IOPC' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'RLC    EXI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO FIN-CMN-ING.

           ADD 1 TO WSS-NUM-IRLC IN WSS-VARI.
           MOVE WSS-NUM-IRLC IN WSS-VARI TO RLC-NUM-IRLC IN RLC.
           MOVE WSS-NUM-SIDE IN CMA-VARI TO RLC-NUM-SIDE IN RLC.
           MOVE WSS-NUM-AIDE IN CMA-VARI TO RLC-NUM-AIDE IN RLC.
           MOVE WSS-NUM-MIDE IN CMA-VARI TO RLC-NUM-MIDE IN RLC.
           MOVE WSS-NUM-DIDE IN CMA-VARI TO RLC-NUM-DIDE IN RLC.

      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<<
           IF NOT FIO-STAT-OKS
              MOVE FIO-MENS TO FRM-MENS
              GO TO FIN-CMN-ING.
      * Actualiza fecha de desembolso (DLO) para la primera RLC
           IF WSS-NUM-IRLC IN WSS-VARI = 1 AND
              WSS-FEC-FIDE IN CMA-VARI > ZEROES
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
              PERFORM ACT-FEC-DES
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
              MOVE RLC-CAI-ICLF IN RLC-FLD TO ACL-CAI-ICLF IN ACL
              MOVE RLC-IIC-ICLF IN RLC-FLD TO ACL-IIC-ICLF IN ACL
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM LDC-FIO-ACL
              IF FIO-STAT-OKS
                 MOVE WSS-NUM-SIDE IN CMA-VARI TO ACL-NUM-SIDE IN ACL
                 MOVE WSS-NUM-AIDE IN CMA-VARI TO ACL-NUM-AIDE IN ACL
                 MOVE WSS-NUM-MIDE IN CMA-VARI TO ACL-NUM-MIDE IN ACL
                 MOVE WSS-NUM-DIDE IN CMA-VARI TO ACL-NUM-DIDE IN ACL
                 MOVE FIO-MOD TO FIO-CMND
                 PERFORM LDC-FIO-ACL.
      *<<<<
           MOVE RLC-CAI-ICLF IN RLC-FLD TO LCC-CAI-ICLF IN LCC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO LCC-IIC-ICLF IN LCC.
           MOVE RLC-NUM-ILDC IN RLC-FLD TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD     TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           MOVE FRM-VAL-SOPC IN RLC-FLD TO WSS-VAL-SOPC IN WSS-VARI.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE FRM-VAL-MOPC IN RLC-FLD TO WSS-VAL-CRED IN WSS-VARI.
      *    IF WSS-COD-VCOC IN CMA-VARI NOT = LCC-COD-VCOC IN LCC
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA


           PERFORM CONVIERTE-VCOC.

      *    COMPUTE LCC-VAL-MUTI IN LCC = LCC-VAL-MUTI IN LCC -
           COMPUTE LCC-VAL-MUTI IN LCC = LCC-VAL-MUTI IN LCC +
                   WSS-VAL-SOPC IN WSS-VARI.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE LCC-VAL-MUTI IN LCC TO WSS-VAL-MUTI IN WSS-VARI.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           IF NOT FIO-STAT-OKS
              MOVE FIO-MENS TO FRM-MENS
              GO TO FIN-CMN-ING.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA

           MOVE RLC-CAI-ICLF IN RLC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-CMN-ING.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
                RLC-CAI-ICLF IN RLC-FLD = LDC-CAI-ICLF IN LDC AND
                RLC-IIC-ICLF IN RLC-FLD = LDC-IIC-ICLF IN LDC)
                GO TO FIN-CMN-ING.

           MOVE FIO-GET-KEY-UPD     TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE 'N' TO WSS-IND-RDES IN WSS-VARI.
           IF LDC-MSC-STAT IN LDC = 'D'
               IF RLC-NUM-ILDC IN RLC-FLD = LDC-NUM-ILDC IN LDC
                 MOVE 'N' TO WSS-IND-RRLC IN WSS-VARI
                 MOVE 'S' TO WSS-IND-RDES IN WSS-VARI
                 PERFORM INI-LMO
               ELSE
                 NEXT SENTENCE
           ELSE
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
           IF LDC-MSC-STAT IN LDC = 'A'
               MOVE 'D' TO LDC-MSC-STAT IN LDC
               MOVE FIO-MOD TO FIO-CMND
               PERFORM LDC-FIO-LDC
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               IF FIO-STAT-OKS
                 PERFORM INI-LMO.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
       NXT-CMN-ING.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CMN-ING.
      *<<<<
*% END
*% IF INI_CMN_ELI
      *>>>>
           PERFORM KEY-ALL-RLC.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      * Inicializa Variables
           MOVE SPACES TO WSS-CAI-IOPC IN WSS-VARI.
           MOVE SPACES TO WSS-IIC-IOPC IN WSS-VARI.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA

           MOVE RLC-NUM-SACT IN RLC-FLD TO WSS-NUM-SELI IN WSS-VARI.
           MOVE RLC-NUM-AACT IN RLC-FLD TO WSS-NUM-AELI IN WSS-VARI.
           MOVE RLC-NUM-MACT IN RLC-FLD TO WSS-NUM-MELI IN WSS-VARI.
           MOVE RLC-NUM-DACT IN RLC-FLD TO WSS-NUM-DELI IN WSS-VARI.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE RLC-NUM-ILDC IN RLC-FLD TO WSS-NUM-ILDC IN WSS-VARI.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           PERFORM GET-FHOY.
           MOVE HOY-SHOY TO WSS-NUM-SDEL IN WSS-VARI.
           MOVE HOY-AHOY TO WSS-NUM-ADEL IN WSS-VARI.
           MOVE HOY-MHOY TO WSS-NUM-MDEL IN WSS-VARI.
           MOVE HOY-DHOY TO WSS-NUM-DDEL IN WSS-VARI.
      * Solo permite eliminar RLC ingresadas durante el dia
           IF NOT
              (WSS-FEC-FELI IN WSS-VARI = WSS-FEC-FDEL IN WSS-VARI)
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'ERR  FECELI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.

      *>>>>
*% END
*% IF CMN_ELI
      *<<<<

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA

      *     MOVE RLC-CAI-ICLF IN RLC-FLD TO WSS-CAI-ICLF IN WSS-VARI.
      *     MOVE RLC-IIC-ICLF IN RLC-FLD TO WSS-IIC-ICLF IN WSS-VARI.
      *     MOVE FIO-DEL TO FIO-CMND.
      *     PERFORM LDC-FIO-RLC.
      *     MOVE RLC-CAI-ICLF IN RLC-FLD TO LCC-CAI-ICLF IN LCC.
      *     MOVE RLC-IIC-ICLF IN RLC-FLD TO LCC-IIC-ICLF IN LCC.
      *     MOVE RLC-NUM-ILDC IN RLC-FLD TO LCC-NUM-ILCC IN LCC.
      *     MOVE FIO-GET-KEY-UPD     TO FIO-CMND.
      *     PERFORM LDC-FIO-LCC.

      *     MOVE FRM-VAL-SOPC IN RLC-FLD TO WSS-VAL-SOPC IN WSS-VARI.

      *     IF WSS-COD-VCOC IN CMA-VARI NOT = LCC-COD-VCOC IN LCC
      *        PERFORM CONVIERTE-VCOC.

      *     COMPUTE LCC-VAL-MUTI IN LCC = LCC-VAL-MUTI IN LCC -
      *             WSS-VAL-SOPC IN WSS-VARI.
      *     IF (LCC-VAL-MUTI IN LCC NOT > ZEROES)
      *          MOVE ZEROES TO LCC-VAL-MUTI IN LCC.

      *      MOVE FIO-MOD TO FIO-CMND.
      *     PERFORM LDC-FIO-LCC.

      *     PERFORM BUS-NLS-RLC.

      *     MOVE WSS-CAI-ICLF IN WSS-VARI TO ACL-CAI-ICLF IN ACL
      *     MOVE WSS-IIC-ICLF IN WSS-VARI TO ACL-IIC-ICLF IN ACL
      *     MOVE FIO-GET-KEY-UPD TO FIO-CMND
      *     PERFORM LDC-FIO-ACL
      *     IF FIO-STAT-OKS
      *          MOVE WSS-FEC-FNVA IN WSS-VARI TO
      *                ACL-FEC-FIDE IN ACL
      *           MOVE FIO-MOD TO FIO-CMND
      *           PERFORM LDC-FIO-ACL.

      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<<<
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           MOVE FIO-STAT TO PGM-STAT-RLC.
           PERFORM UPD-LDC-LCC.

       NXT-CMN-ELI.
           IF WSS-IND-REXI IN WSS-VARI = 'S'
              PERFORM BUS-ULT-RLC.

      * Actualiza Fecha Ini Des (LOM)
           MOVE RLC-CAI-ICLF IN RLC-FLD  TO ACL-CAI-ICLF IN ACL.
           MOVE RLC-IIC-ICLF IN RLC-FLD  TO ACL-IIC-ICLF IN ACL.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           IF WSS-IND-REXI IN WSS-VARI = 'S'
               MOVE WSS-FEC-FNVA IN WSS-VARI TO ACL-FEC-FIDE IN ACL
           ELSE
               MOVE ZEROES                   TO ACL-FEC-FIDE IN ACL

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

      * Elimina movimientos contables
           PERFORM ELI-RLC-LMO.
           MOVE PGM-STAT-RLC TO FIO-STAT.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
      *>>>>
*% END
*% IF PGM_PU
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'ING'
              MOVE FRM-CPIM-AEY TO RLC-COD-CGTA-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO RLC-COD-DENV-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO FRM-VAL-MLIB-ATR IN RLC-FLD
              MOVE 0            TO RLC-COD-CGTA-LEN IN RLC-FLD
              MOVE -1           TO RLC-NUM-IOPC-LEN IN RLC-FLD.
      *>>>>
*% END
*% IF RETHDR
           MOVE HOY-FHOY TO RLC-FEC-FING IN RLC.
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBGPES.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
       COPY SGCBFDBC.
       COPY TABBFCAM.
       COPY LDCBFLDC.
       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY COLBFCAN.
       COPY COLBFRCV.
       COPY LDCBFLCC.
       COPY LDCBFACL.
       COPY LDCBFRDC REPLACING RDC BY RDL
                    ==ADR-RDC-REQA== BY ==ADR-RDL-REQA==.
       COPY LDCBFCLF.
       COPY LDCBFACG.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       COPY LDCBFLMO.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *>>>>
       CONVIERTE-VCOC SECTION.
       INI-CONVIERTE-VCOC.


           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               GO TO FIN-CONVIERTE-VCOC.
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.        

           IF WSS-COD-VCOC IN CMA-VARI = LCC-COD-VCOC IN LCC
              GO TO FIN-CONVIERTE-VCOC.

           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               GO TO FIN-CONVIERTE-VCOC.
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.        

           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               GO TO FIN-CONVIERTE-VCOC.
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.        

           IF WSS-COD-VCOC IN CMA-VARI = WSS-COD-PESO IN WSS-VARI AND
              LCC-COD-VCOC IN LCC NOT  = WSS-COD-PESO IN WSS-VARI
               MOVE LCC-COD-VCOC IN LCC      TO CAM-COD-VCAM IN CAM(1)  
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)  
               MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1)  
               MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1)  
               MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1)  
               MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1)  
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
               IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')   
                    MOVE 'DEU' TO MSG-COD-SIST
                    MOVE 'CAM    NEX' TO MSG-COD-MENS                   
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC  TO FRM-MENS
                    MOVE '00'          TO FIO-STAT
                    MOVE SCR-STAT-CON  TO SCR-STAT
                    MOVE 'S'           TO WSS-IFIN
                    GO TO FIN-CONVIERTE-VCOC
               ELSE
                    COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
                    FRM-VAL-SOPC IN RLC-FLD / CAM-SGV-VCAM IN CAM
                    GO TO FIN-CONVIERTE-VCOC.

           IF LCC-COD-VCOC IN LCC      = WSS-COD-PESO IN WSS-VARI AND
              WSS-COD-VCOC IN CMA-VARI NOT = WSS-COD-PESO IN WSS-VARI
               MOVE WSS-COD-VCOC IN CMA-VARI TO CAM-COD-VCAM IN CAM(1)  
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)  
               MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1)  
               MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1)  
               MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1)  
               MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1)  
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
               IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')   
                    MOVE 'DEU' TO MSG-COD-SIST
                    MOVE 'CAM    NEX' TO MSG-COD-MENS                   
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC  TO FRM-MENS
                    MOVE '00'          TO FIO-STAT
                    MOVE SCR-STAT-CON  TO SCR-STAT
                    MOVE 'S'           TO WSS-IFIN
                    GO TO FIN-CONVIERTE-VCOC
               ELSE
                    COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
                    FRM-VAL-SOPC IN RLC-FLD * CAM-SGV-VCAM IN CAM
                    MOVE WSS-VAL-SOPC IN WSS-VARI TO
                         PES-SGV-DECI IN PES-VARI
                    PERFORM PES-SCTV
                    MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-VAL-SOPC IN WSS-VARI
                    GO TO FIN-CONVIERTE-VCOC.

           MOVE WSS-COD-VCOC IN CMA-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1).     
           MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1).     
           MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1).     
           MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')       
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               GO TO FIN-CONVIERTE-VCOC.

              COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
              FRM-VAL-SOPC IN RLC-FLD * CAM-SGV-VCAM IN CAM.

           MOVE LCC-COD-VCOC IN LCC      TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1).     
           MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1).     
           MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1).     
           MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')       
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               GO TO FIN-CONVIERTE-VCOC.

              COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
              WSS-VAL-SOPC IN WSS-VARI / CAM-SGV-VCAM IN CAM.


      *    MOVE 'TAB'          TO FIO-SIST.                             
      *    MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
      *    MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.                  
      *    MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
      *    MOVE FIO-GET-KEY    TO FIO-CMND.                             
      *    PERFORM GNS-FIO-TAB.                                         
      *    IF NOT FIO-STAT-OKS                                          
      *        MOVE 'TAB'          TO MSG-COD-SIST                      
      *        MOVE 'CIC0998  NEX' TO MSG-COD-MENS                      
      *        PERFORM GET-MSG                                          
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.                     
      *                                                                 
      *    MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.        
      *
      *    MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).     
      *    MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
      *    MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1).     
      *    MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1).     
      *    MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1).     
      *    MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1).     
      *    MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM TAB-FIO-CAM.                                         
      *    IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')       
      *        MOVE 'DEU' TO MSG-COD-SIST
      *        MOVE 'CAM    NEX' TO MSG-COD-MENS                        
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        GO TO FIN-CONVIERTE-VCOC.
      *
      *    IF LCC-COD-VCOC IN LCC = WSS-COD-UEFE IN WSS-VARI
      *       COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
      *       FRM-VAL-SOPC IN RLC-FLD / CAM-SGV-VCAM IN CAM
      *    ELSE
      *       COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
      *       FRM-VAL-SOPC IN RLC-FLD * CAM-SGV-VCAM IN CAM
      *       MOVE WSS-VAL-SOPC IN WSS-VARI TO
      *            PES-SGV-DECI IN PES-VARI
      *       PERFORM PES-SCTV
      *       MOVE PES-SGV-ENTE IN PES-VARI TO
      *            WSS-VAL-SOPC IN WSS-VARI.
       FIN-CONVIERTE-VCOC.
           EXIT.

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       BUS-REG-RLC SECTION.
       INI-BUS-REG-RLC.
      * Busca existencia de registros anteriores
           MOVE 'S' TO WSS-IND-RRLC IN WSS-VARI.

           MOVE RLC-CAI-ICLF IN RLC-FLD TO RLC-CAI-ICLF IN RLC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO RLC-IIC-ICLF IN RLC.
           MOVE RLC-NUM-ILDC IN RLC-FLD TO RLC-NUM-ILDC IN RLC.
           MOVE SPACES                  TO RLC-CAI-IOPC IN RLC.
           MOVE ZEROES                  TO RLC-IIC-IOPC IN RLC.
           MOVE ZEROES                  TO RLC-NUM-IOPC IN RLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUSCA-RLC.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = RLC-CAI-ICLF IN RLC AND
              RLC-IIC-ICLF IN RLC-FLD = RLC-IIC-ICLF IN RLC AND
              RLC-NUM-ILDC IN RLC-FLD = RLC-NUM-ILDC IN RLC
              GO TO FIN-BUS-REG-RLC
           ELSE
              MOVE 'N' TO WSS-IND-RRLC IN WSS-VARI.

       FIN-BUS-REG-RLC.
           EXIT.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

       BUS-LEQ-RLC SECTION.
       INI-BUS-LEQ-RLC.
           MOVE ZEROES TO WSS-NUM-IRLC IN WSS-VARI.
           MOVE RLC-CAI-ICLF IN RLC-FLD TO RLC-CAI-ICLF IN RLC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO RLC-IIC-ICLF IN RLC.
           MOVE ZEROES                  TO RLC-NUM-ILDC IN RLC.
           MOVE SPACES                  TO RLC-CAI-IOPC IN RLC.
           MOVE ZEROES                  TO RLC-IIC-IOPC IN RLC.
           MOVE ZEROES                  TO RLC-NUM-IOPC IN RLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUSCA-MAX.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = RLC-CAI-ICLF IN RLC AND
              RLC-IIC-ICLF IN RLC-FLD = RLC-IIC-ICLF IN RLC
              IF RLC-NUM-IRLC IN RLC > WSS-NUM-IRLC IN WSS-VARI
                  MOVE RLC-NUM-IRLC IN RLC TO WSS-NUM-IRLC IN WSS-VARI
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-BUSCA-MAX
              ELSE
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-BUSCA-MAX.
       FIN-BUS-LEQ-RLC.
           EXIT.

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *BUS-NLS-RLC SECTION.
      *INI-BUS-NLS-RLC.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

       BUS-ULT-RLC SECTION.
       INI-BUS-ULT-RLC.
      * Busca ultima RLC asociada para actualizar fecha ini Des (LMO)
           MOVE 999 TO WSS-NUM-IRLC IN WSS-VARI.
           MOVE RLC-CAI-ICLF IN RLC-FLD  TO RLC-CAI-ICLF IN RLC.
           MOVE RLC-IIC-ICLF IN RLC-FLD  TO RLC-IIC-ICLF IN RLC.
           MOVE ZEROES                   TO RLC-NUM-ILDC IN RLC.
           MOVE SPACES                   TO RLC-CAI-IOPC IN RLC.
           MOVE ZEROES                   TO RLC-IIC-IOPC IN RLC.
           MOVE ZEROES                   TO RLC-NUM-IOPC IN RLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUSCA-MIN.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = RLC-CAI-ICLF IN RLC AND
              RLC-IIC-ICLF IN RLC-FLD = RLC-IIC-ICLF IN RLC
              IF RLC-NUM-IRLC IN RLC < WSS-NUM-IRLC IN WSS-VARI
                  MOVE RLC-NUM-IRLC IN RLC TO WSS-NUM-IRLC IN WSS-VARI
                  MOVE RLC-FEC-FIDE IN RLC TO WSS-FEC-FNVA IN WSS-VARI
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-BUSCA-MIN
              ELSE
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-BUSCA-MIN.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      * FIN-BUS-NLS-RLC.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

       FIN-BUS-ULT-RLC.
           EXIT.


      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       ACT-FEC-DES SECTION.
       INI-ACT-FEC-DES.
      * Actualiza Fecha Desembolso DLO
           MOVE RLC-CAI-ICLF IN RLC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-ACT-FEC.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = LDC-CAI-ICLF IN LDC AND
              RLC-IIC-ICLF IN RLC-FLD = LDC-IIC-ICLF IN LDC)
              GO TO FIN-ACT-FEC-DES.

           IF LDC-MSC-STAT IN LDC = 'I'
              GO TO NXT-ACT-FEC-DES.

           MOVE LDC-CAI-ICLF IN LDC TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF FIO-STAT-OKS
              MOVE WSS-NUM-SIDE IN CMA-VARI TO LCC-NUM-SDES IN LCC
              MOVE WSS-NUM-AIDE IN CMA-VARI TO LCC-NUM-ADES IN LCC
              MOVE WSS-NUM-MIDE IN CMA-VARI TO LCC-NUM-MDES IN LCC
              MOVE WSS-NUM-DIDE IN CMA-VARI TO LCC-NUM-DDES IN LCC
              MOVE WSS-NUM-SIDE IN CMA-VARI TO LCC-NUM-SCTB IN LCC
              MOVE WSS-NUM-AIDE IN CMA-VARI TO LCC-NUM-ACTB IN LCC
              MOVE WSS-NUM-MIDE IN CMA-VARI TO LCC-NUM-MCTB IN LCC
              MOVE WSS-NUM-DIDE IN CMA-VARI TO LCC-NUM-DCTB IN LCC
              MOVE FIO-MOD TO FIO-CMND
              PERFORM LDC-FIO-LCC.

       NXT-ACT-FEC-DES.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-ACT-FEC.
       FIN-ACT-FEC-DES.
           EXIT.

       INI-LMO SECTION.
       INI-INI-LMO.
           IF LDC-MSC-STAT IN LDC = 'I'
              GO TO FIN-INI-LMO.
           MOVE 'N' TO WSS-IND-SOPC IN WSS-VARI.
           MOVE SPACES TO LMO-GLS-FLAG IN LMO.
           MOVE SPACES TO LMO-FEC-FMOV IN LMO.
           MOVE SPACES TO LMO-HRA-HMOV IN LMO.
           MOVE SPACES TO LMO-CAI-ICLF IN LMO.
           MOVE SPACES TO LMO-IIC-ICLF IN LMO.
           MOVE ZEROES TO LMO-NUM-ILDC IN LMO.
           MOVE ZEROES TO LMO-STP-ITRN IN LMO.
           MOVE SPACES TO LMO-MSC-TACC IN LMO.
           MOVE SPACES TO LMO-MSC-STAT IN LMO.
           MOVE SPACES TO LMO-COD-OTRN IN LMO.
           MOVE SPACES TO LMO-COD-TIPO IN LMO.
           MOVE SPACES TO LMO-COD-VCLC IN LMO.
           MOVE ZEROES TO LMO-VAL-MORI IN LMO.
           MOVE ZEROES TO LMO-VAL-MPES IN LMO.
           MOVE SPACES TO LMO-CAI-IOPC IN LMO.
           MOVE SPACES TO LMO-IIC-IOPC IN LMO.
           MOVE SPACES TO LMO-COD-CLVA IN LMO.
           MOVE SPACES TO LMO-GLS-CMPA IN LMO.
           MOVE ZEROES TO LMO-SGV-CMPA IN LMO.
           MOVE SPACES TO LMO-COD-NCLV IN LMO.
           MOVE SPACES TO LMO-GLS-NCMP IN LMO.
           MOVE ZEROES TO LMO-SGV-NCMP IN LMO.
           MOVE SPACES TO LMO-COD-OFMV IN LMO.
           MOVE ZEROES TO LMO-FEC-FING IN LMO.
           MOVE SPACES TO LMO-GLS-DISP IN LMO.

           PERFORM GET-FHOY.
           MOVE HOY-FHOY                 TO LMO-FEC-FMOV IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HMOV IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FING IN LMO.
           MOVE LDC-CAI-ICLF IN LDC      TO LMO-CAI-ICLF IN LMO.
           MOVE LDC-IIC-ICLF IN LDC      TO LMO-IIC-ICLF IN LMO.
           MOVE LDC-NUM-ILDC IN LDC      TO LMO-NUM-ILDC IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FTRN IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HRTR IN LMO.
           MOVE 'LDCPURLC'               TO LMO-COD-ATRN IN LMO.
           MOVE SCR-USER                 TO LMO-CIC-UING IN LMO.
           MOVE SCR-OTRN                 TO LMO-COD-OTRN IN LMO.
           MOVE WSS-CAI-IOPC IN WSS-VARI TO LMO-CAI-IOPC IN LMO.
           MOVE WSS-IIC-IOPC IN WSS-VARI TO LMO-IIC-IOPC IN LMO.
           MOVE WSS-COD-OFIC IN WSS-VARI TO LMO-COD-OFMV IN LMO.
           MOVE WSS-COD-TOOC IN WSS-VARI TO LMO-COD-TOOC IN LMO.
           MOVE WSS-COD-AOOC IN WSS-VARI TO LMO-COD-AOOC IN LMO.
           MOVE LDC-COD-VCLC IN LDC      TO LMO-COD-VCLC IN LMO.
           MOVE LDC-COD-TIPO IN LDC      TO LMO-COD-TIPO IN LMO.
           IF WSS-IND-RRLC IN WSS-VARI = 'N'
              MOVE ZEROES                   TO LMO-NUM-IMOV IN LMO
              MOVE 1                        TO LMO-NUM-IMOV IN LMO
              MOVE 'RLO'                    TO LMO-COD-ECTB IN LMO
              MOVE WSS-VAL-CRED IN WSS-VARI TO LMO-VAL-MORI IN LMO
              MOVE 'S' TO WSS-IND-SOPC IN WSS-VARI
              MOVE LDC-COD-VCLC IN LDC TO WSS-LDC-VCAM IN WSS-VARI
              PERFORM VALOR-CAM
              MOVE WSS-VAL-SOPC IN WSS-VARI TO LMO-VAL-MPES IN LMO
              PERFORM GRABA-MTO2
           ELSE
              MOVE LDC-CAI-ICLF IN LDC TO WSS-CAI-ILDC IN WSS-VARI
              MOVE LDC-IIC-ICLF IN LDC TO WSS-IIC-ILDC IN WSS-VARI
              MOVE LDC-NUM-ILDC IN LDC TO WSS-NUM-ILDC IN WSS-VARI
              PERFORM GEN-LMO-DES
              MOVE 'S' TO WSS-IND-CMAX IN WSS-VARI
              MOVE 2                        TO LMO-NUM-IMOV IN LMO
              MOVE LDC-VAL-CMAX IN LDC      TO LMO-VAL-MORI IN LMO
              MOVE LDC-COD-VCLC IN LDC TO WSS-LDC-VCAM IN WSS-VARI
              PERFORM VALOR-CAM
              MOVE WSS-VAL-CMAX IN WSS-VARI TO LMO-VAL-MPES IN LMO
              MOVE 'DES'  TO LMO-COD-ECTB IN LMO.

           IF WSS-IND-RDES IN WSS-VARI = 'S'
              MOVE 'S' TO WSS-IND-RRLC IN WSS-VARI.

           IF HOY-HHOY > 075959 AND HOY-HHOY < 140000
              MOVE 'M'                   TO LMO-IND-MODO IN LMO
           ELSE
              MOVE 'T'                   TO LMO-IND-MODO IN LMO.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-LMO.
           IF FIO-STAT-OKS AND
              WSS-IND-RRLC IN WSS-VARI = 'N'
              MOVE 'S' TO WSS-IND-RRLC IN WSS-VARI
              GO TO INI-INI-LMO.
       FIN-INI-LMO.
           EXIT.

       LEE-CLF SECTION.
       INI-LEE-CLF.

           MOVE SPACES TO WSS-COD-OFIC IN WSS-VARI.
           MOVE SPACES TO WSS-COD-TOOC IN WSS-VARI.
           MOVE SPACES TO WSS-COD-AOOC IN WSS-VARI.

           MOVE RLC-CAI-ICLF IN RLC-FLD TO CLF-CAI-ICLF IN CLF.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF FIO-STAT-OKS
              MOVE CLF-COD-OFIC IN CLF TO WSS-COD-OFIC IN WSS-VARI
              MOVE CLF-COD-TOCF IN CLF TO WSS-COD-TOOC IN WSS-VARI
              MOVE CLF-COD-AOCF IN CLF TO WSS-COD-AOOC IN WSS-VARI.
       FIN-LEE-CLF.
           EXIT.

       GRABA-MTO2 SECTION.
       INI-GRABA-MTO2.
           MOVE ZEROES TO WSS-SGV-MTO2 IN WSS-VARI.
           MOVE 'S' TO WSS-IND-CMAX IN WSS-VARI.
           MOVE 'N' TO WSS-IND-MTO2 IN WSS-VARI.
           PERFORM VALOR-CAM.
           MOVE 'S' TO WSS-IND-MTO2 IN WSS-VARI.
           MOVE LDC-CAI-ICLF IN LDC TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           MOVE LCC-COD-VCOC IN LCC TO WSS-LCC-VCAM IN WSS-VARI.
           PERFORM VALOR-CAM.
           COMPUTE WSS-SGV-MTO2 = WSS-VAL-CMAX IN WSS-VARI -
                   WSS-VAL-MUTI IN WSS-VARI.
           IF WSS-NUM-IRLC IN WSS-VARI = 1
              MOVE ZEROES                   TO LCC-VAL-MTO1 IN LCC
              MOVE WSS-SGV-MTO2 IN WSS-VARI TO LCC-VAL-MTO2 IN LCC
           ELSE
              MOVE LCC-VAL-MTO2 IN LCC      TO LCC-VAL-MTO1 IN LCC
              MOVE WSS-SGV-MTO2 IN WSS-VARI TO LCC-VAL-MTO2 IN LCC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
       FIN-GRABA-MTO2.
           EXIT.

       VALOR-CAM SECTION.
       INI-VALOR-CAM.
           MOVE SPACES TO WSS-TAB-VCAM IN WSS-VARI.
           MOVE SPACES TO WSS-COD-UEFE IN WSS-VARI.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               GO TO FIN-VALOR-CAM.

           MOVE TAB-COD-CTAB IN TAB TO WSS-TAB-VCAM IN WSS-VARI.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               GO TO FIN-VALOR-CAM.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.

           IF WSS-IND-SOPC IN WSS-VARI = 'S'

              IF WSS-COD-VCOC IN CMA-VARI =
                 WSS-TAB-VCAM IN WSS-VARI
                 MOVE WSS-VAL-CRED IN WSS-VARI TO
                 WSS-VAL-SOPC IN WSS-VARI
                 MOVE 'N' TO WSS-IND-SOPC IN WSS-VARI
                 GO TO FIN-VALOR-CAM
              ELSE
                 MOVE WSS-COD-VCOC IN CMA-VARI TO
                     CAM-COD-VCAM IN CAM(1).
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *       END-IF

      *    END-IF.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           IF WSS-IND-CMAX IN WSS-VARI = 'S'

              IF WSS-LDC-VCAM IN WSS-VARI =
                 WSS-TAB-VCAM IN WSS-VARI
                 MOVE LDC-VAL-CMAX IN LDC TO
                      WSS-VAL-CMAX IN WSS-VARI
                 MOVE 'N' TO WSS-IND-CMAX IN WSS-VARI
                 GO TO FIN-VALOR-CAM
              ELSE
                 MOVE WSS-LDC-VCAM IN WSS-VARI TO
                     CAM-COD-VCAM IN CAM(1).
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *       END-IF

      *    END-IF.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           IF WSS-IND-MTO2 IN WSS-VARI = 'S'

              IF WSS-LCC-VCAM IN WSS-VARI =
                 WSS-TAB-VCAM IN WSS-VARI
                 MOVE LCC-VAL-MUTI IN LCC TO
                      WSS-VAL-MUTI IN WSS-VARI
                 MOVE 'N' TO WSS-IND-MTO2 IN WSS-VARI
                 GO TO FIN-VALOR-CAM
              ELSE
                 MOVE WSS-LCC-VCAM IN WSS-VARI TO
                     CAM-COD-VCAM IN CAM(1).
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *       END-IF

      *    END-IF.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           MOVE WSS-TAB-VCAM IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE HOY-SHOY                 TO CAM-NUM-SCAM IN CAM(1).
           MOVE HOY-AHOY                 TO CAM-NUM-ACAM IN CAM(1).
           MOVE HOY-MHOY                 TO CAM-NUM-MCAM IN CAM(1).
           MOVE HOY-DHOY                 TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               GO TO FIN-VALOR-CAM.

           IF WSS-IND-SOPC IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-IND-SOPC IN WSS-VARI
               COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
                    WSS-VAL-CRED IN WSS-VARI * CAM-SGV-VCAM IN CAM
               MOVE WSS-VAL-SOPC IN WSS-VARI TO
                         PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-VAL-SOPC IN WSS-VARI.

           IF WSS-IND-CMAX IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-IND-CMAX IN WSS-VARI
               COMPUTE WSS-VAL-CMAX IN WSS-VARI ROUNDED =
                    LDC-VAL-CMAX IN LDC * CAM-SGV-VCAM IN CAM
               MOVE WSS-VAL-CMAX IN WSS-VARI TO
                         PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-VAL-CMAX IN WSS-VARI.

           IF WSS-IND-MTO2 IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-IND-MTO2 IN WSS-VARI
               COMPUTE WSS-VAL-MUTI IN WSS-VARI ROUNDED =
                    LCC-VAL-MUTI IN LCC * CAM-SGV-VCAM IN CAM
               MOVE WSS-VAL-MUTI IN WSS-VARI TO
                         PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-VAL-MUTI IN WSS-VARI.

       FIN-VALOR-CAM.
           EXIT.
      * EVA-FIN  11/08

      *MAE
      *----------------------------------------------------------
       GEN-LMO-DES SECTION.
       INI-GEN-LMO-DES.

           PERFORM BUS-COD-PESO.
           IF (WSS-IND-ERRO = 'S')
                GO TO FIN-GEN-LMO-DES.

      *    BUSCA LINEAS EN DESEMBOLSO
           MOVE WSS-CIC-ILDC IN WSS-VARI TO LDC-CIC-ICLF IN LDC.
           MOVE ZEROES                   TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GEN-LMO-DES.
           PERFORM LDC-FIO-LDC.
           IF (NOT FIO-STAT-OKS OR
               WSS-CIC-ILDC IN WSS-VARI NOT = LDC-CIC-ICLF IN LDC)
                GO TO FIN-GEN-LMO-DES.

           IF WSS-NUM-ILDC IN WSS-VARI = LDC-NUM-ILDC IN LDC
                GO TO NXT-GEN-LMO-DES.

           PERFORM UPD-LCC.
           IF (WSS-IND-ERRO = 'S')
                GO TO NXT-GEN-LMO-DES.
           PERFORM GRB-LMO.

       NXT-GEN-LMO-DES.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GEN-LMO-DES.

       FIN-GEN-LMO-DES.
           MOVE WSS-CIC-ILDC IN WSS-VARI TO LDC-CIC-ICLF IN LDC.
           MOVE WSS-NUM-ILDC IN WSS-VARI TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           EXIT.
      *----------------------------------------------------------
       UPD-LCC SECTION.
       INI-UPD-LCC.

      *    Actualiza monto y fecha de LCC

           MOVE 'N' TO WSS-IND-ERRO.
           MOVE LDC-CAI-ICLF IN LDC     TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC     TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC     TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD     TO FIO-CMND.
           PERFORM LDC-FIO-LCC.

           COMPUTE WSS-SAL-MTO2 IN WSS-VARI =
                   LDC-VAL-CMAX IN LDC  -
                   LCC-VAL-MUTI IN LCC.

           PERFORM BUS-VCAM-MTO2.
           IF (WSS-IND-ERRO = 'S')
                GO TO FIN-UPD-LCC.

           MOVE WSS-SAL-MTO2 IN WSS-VARI TO LCC-VAL-MTO2 IN LCC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
              MOVE 'S' TO WSS-IND-ERRO.

       FIN-UPD-LCC.
           EXIT.
      *----------------------------------------------------------
       GRB-LMO SECTION.
       INI-GRB-LMO.

      *    CREA LMO PARA LINEAS
           IF LDC-MSC-STAT IN LDC = 'I'
              GO TO FIN-GRB-LMO.

           PERFORM LIMP-LMO.

           PERFORM GET-FHOY.
           MOVE HOY-FHOY                 TO LMO-FEC-FMOV IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HMOV IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FING IN LMO.
           MOVE LDC-CAI-ICLF IN LDC      TO LMO-CAI-ICLF IN LMO.
           MOVE LDC-IIC-ICLF IN LDC      TO LMO-IIC-ICLF IN LMO.
           MOVE LDC-NUM-ILDC IN LDC      TO LMO-NUM-ILDC IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FTRN IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HRTR IN LMO.
           MOVE 'LDCPURLC'               TO LMO-COD-ATRN IN LMO.
           MOVE SCR-USER                 TO LMO-CIC-UING IN LMO.
           MOVE SCR-OTRN                 TO LMO-COD-OTRN IN LMO.
           MOVE WSS-CAI-IOPC IN WSS-VARI TO LMO-CAI-IOPC IN LMO.
           MOVE WSS-IIC-IOPC IN WSS-VARI TO LMO-IIC-IOPC IN LMO.
           MOVE WSS-COD-OFIC IN WSS-VARI TO LMO-COD-OFMV IN LMO.
           MOVE WSS-COD-TOOC IN WSS-VARI TO LMO-COD-TOOC IN LMO.
           MOVE WSS-COD-AOOC IN WSS-VARI TO LMO-COD-AOOC IN LMO.
           MOVE LDC-COD-VCLC IN LDC      TO LMO-COD-VCLC IN LMO.
           MOVE LDC-COD-TIPO IN LDC      TO LMO-COD-TIPO IN LMO.
           MOVE LDC-VAL-CMAX IN LDC      TO LMO-VAL-MORI IN LMO.
           MOVE 2                        TO LMO-NUM-IMOV IN LMO.
           MOVE 'S'                      TO WSS-IND-CMAX IN WSS-VARI.
           MOVE LDC-COD-VCLC IN LDC      TO WSS-LDC-VCAM IN WSS-VARI.
           PERFORM VALOR-CAM.
           MOVE WSS-VAL-CMAX IN WSS-VARI TO LMO-VAL-MPES IN LMO.
           MOVE 'DES'  TO LMO-COD-ECTB IN LMO.

           IF HOY-HHOY > 075959 AND HOY-HHOY < 140000
              MOVE 'M'                   TO LMO-IND-MODO IN LMO
           ELSE
              MOVE 'T'                   TO LMO-IND-MODO IN LMO.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-LMO.


       FIN-GRB-LMO.
           EXIT.
      *----------------------------------------------------------
       LIMP-LMO SECTION.
       INI-LIMP-LMO.

      *    LIMPIA LMO

           MOVE SPACES TO LMO-GLS-FLAG IN LMO.
           MOVE SPACES TO LMO-FEC-FMOV IN LMO.
           MOVE SPACES TO LMO-HRA-HMOV IN LMO.
           MOVE SPACES TO LMO-CAI-ICLF IN LMO.
           MOVE SPACES TO LMO-IIC-ICLF IN LMO.
           MOVE ZEROES TO LMO-NUM-ILDC IN LMO.
           MOVE ZEROES TO LMO-STP-ITRN IN LMO.
           MOVE SPACES TO LMO-MSC-TACC IN LMO.
           MOVE SPACES TO LMO-MSC-STAT IN LMO.
           MOVE SPACES TO LMO-COD-OTRN IN LMO.
           MOVE SPACES TO LMO-COD-TIPO IN LMO.
           MOVE SPACES TO LMO-COD-VCLC IN LMO.
           MOVE ZEROES TO LMO-VAL-MORI IN LMO.
           MOVE ZEROES TO LMO-VAL-MPES IN LMO.
           MOVE SPACES TO LMO-CAI-IOPC IN LMO.
           MOVE SPACES TO LMO-IIC-IOPC IN LMO.
           MOVE SPACES TO LMO-COD-CLVA IN LMO.
           MOVE SPACES TO LMO-GLS-CMPA IN LMO.
           MOVE ZEROES TO LMO-SGV-CMPA IN LMO.
           MOVE SPACES TO LMO-COD-NCLV IN LMO.
           MOVE SPACES TO LMO-GLS-NCMP IN LMO.
           MOVE ZEROES TO LMO-SGV-NCMP IN LMO.
           MOVE SPACES TO LMO-COD-OFMV IN LMO.
           MOVE ZEROES TO LMO-FEC-FING IN LMO.
           MOVE SPACES TO LMO-GLS-DISP IN LMO.


       FIN-LIMP-LMO.
           EXIT.
      *----------------------------------------------------------
       BUS-VCAM-MTO2 SECTION.
       INI-BUS-VCAM-MTO2.

      *    CAMBIO SALDO DISPONIBLE A PESOS

           MOVE 'N' TO WSS-IND-ERRO.
           IF LCC-COD-VCOC IN LCC = WSS-COD-PESO IN WSS-VARI
               GO TO FIN-BUS-VCAM-MTO2.

           MOVE LCC-COD-VCOC IN LCC      TO CAM-COD-VCAM IN CAM(1)
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
           MOVE HOY-SHOY                 TO CAM-NUM-SCAM IN CAM(1)
           MOVE HOY-AHOY                 TO CAM-NUM-ACAM IN CAM(1)
           MOVE HOY-MHOY                 TO CAM-NUM-MCAM IN CAM(1)
           MOVE HOY-DHOY                 TO CAM-NUM-DCAM IN CAM(1)
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')
                MOVE 'DEU' TO MSG-COD-SIST
                MOVE 'CAM    NEX' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC  TO FRM-MENS
                MOVE '00'          TO FIO-STAT
                MOVE SCR-STAT-CON  TO SCR-STAT
                MOVE 'S'           TO WSS-IND-ERRO
                GO TO FIN-BUS-VCAM-MTO2.

           COMPUTE WSS-VAL-VCAM IN WSS-VARI ROUNDED =
                   WSS-SAL-MTO2 IN WSS-VARI * CAM-SGV-VCAM IN CAM.


           MOVE WSS-VAL-VCAM IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SAL-MTO2 IN WSS-VARI.


       FIN-BUS-VCAM-MTO2.
           EXIT.
      *----------------------------------------------------------
       BUS-COD-PESO SECTION.
       INI-BUS-COD-PESO.

      *    BUSCA CODIGO DE MONEDA PESOS

           MOVE 'N'            TO WSS-IND-ERRO.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IND-ERRO
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               GO TO FIN-BUS-COD-PESO.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

       FIN-BUS-COD-PESO.
           EXIT.
      *----------------------------------------------------------
       LEE-RLC-RLC SECTION.
       INI-LEE-RLC-RLC.
      * Busca RLC existentes de la Linea eliminada
           MOVE 'S' TO WSS-IND-REXI IN WSS-VARI.

           MOVE RLC-CAI-ICLF IN RLC-FLD  TO RLC-CAI-ICLF IN RLC.
           MOVE RLC-IIC-ICLF IN RLC-FLD  TO RLC-IIC-ICLF IN RLC.
           MOVE ZEROES                   TO RLC-NUM-ILDC IN RLC.
           MOVE SPACES                   TO RLC-CAI-IOPC IN RLC.
           MOVE ZEROES                   TO RLC-IIC-IOPC IN RLC.
           MOVE ZEROES                   TO RLC-NUM-IOPC IN RLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
           IF (FIO-STAT-OKS AND
               RLC-CAI-ICLF IN RLC-FLD  = RLC-CAI-ICLF IN RLC AND
               RLC-IIC-ICLF IN RLC-FLD  = RLC-IIC-ICLF IN RLC AND
               RLC-NUM-ILDC IN RLC-FLD  = RLC-NUM-ILDC IN RLC)
               GO TO FIN-LEE-RLC-RLC.

           MOVE 'N' TO WSS-IND-REXI IN WSS-VARI.

       FIN-LEE-RLC-RLC.
           EXIT.

       UPD-LDC-LCC SECTION.
       INI-UPD-LDC-LCC.
      * Busca existencia de mas rlc asociadas a la linea eliminada
           PERFORM LEE-RLC-RLC.

           MOVE RLC-CAI-ICLF IN RLC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-UPD-DLO.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = LDC-CAI-ICLF IN LDC AND
              RLC-IIC-ICLF IN RLC-FLD = LDC-IIC-ICLF IN LDC)
              GO TO FIN-UPD-LDC-LCC.

      * Actualiza estado de la DLO (Desembolso -> Activada)
           IF WSS-IND-REXI IN WSS-VARI = 'S'
              GO TO NXT-UPD-LDC-LCC.

           IF FIO-STAT-OKS AND LDC-MSC-STAT IN LDC = 'D'
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM LDC-FIO-LDC
              MOVE 'A' TO LDC-MSC-STAT IN LDC
              MOVE FIO-MOD TO FIO-CMND
              PERFORM LDC-FIO-LDC.

      * Actualiza monto LCC
           MOVE LDC-CAI-ICLF IN LDC  TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC  TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC  TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
       LOOP-UPD-LCC.
           PERFORM LDC-FIO-LCC.
           IF NOT (FIO-STAT-OKS)
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-UPD-LDC-LCC.

           IF WSS-NUM-ILDC IN WSS-VARI = LCC-NUM-ILCC IN LCC
               MOVE FRM-VAL-SOPC IN RLC-FLD TO
                    WSS-VAL-SOPC IN WSS-VARI

               PERFORM CONVIERTE-VCOC
               IF WSS-IND-REXI IN WSS-VARI = 'N'
                  MOVE ZEROES TO LCC-VAL-MUTI IN LCC
               ELSE
                  COMPUTE LCC-VAL-MUTI IN LCC = LCC-VAL-MUTI IN LCC -
                       WSS-VAL-SOPC IN WSS-VARI.

           IF WSS-IND-REXI IN WSS-VARI = 'S'
              MOVE LCC-VAL-MTO1 IN LCC TO LCC-VAL-MTO2 IN LCC
              MOVE ZEROES              TO LCC-VAL-MTO1 IN LCC
           ELSE
              MOVE ZEROES              TO LCC-VAL-MTO2 IN LCC
              MOVE ZEROES              TO LCC-VAL-MTO1 IN LCC
              MOVE ZEROES              TO LCC-FEC-FCTB IN LCC
              MOVE ZEROES              TO LCC-FEC-FDES IN LCC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-UPD-LDC-LCC.
       NXT-UPD-LDC-LCC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-UPD-DLO.
       FIN-UPD-LDC-LCC.
           EXIT.

       ELI-RLC-LMO SECTION.
       INI-ELI-RLC-LMO.
           MOVE RLC-CAI-ICLF IN RLC-FLD  TO LMO-CAI-ICLF IN LMO.
           MOVE RLC-IIC-ICLF IN RLC-FLD  TO LMO-IIC-ICLF IN LMO.
           MOVE ZEROES                   TO LMO-NUM-ILDC IN LMO.
           MOVE 'LMO-KEY-ILDC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
       LOOP-UPD-LMO.
           PERFORM LDC-FIO-LMO.
           IF NOT (FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD  = LMO-CAI-ICLF IN LMO AND
              RLC-IIC-ICLF IN RLC-FLD  = LMO-IIC-ICLF IN LMO)
              GO TO FIN-ELI-RLC-LMO.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LMO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-ELI-RLC-LMO.

           IF WSS-IND-REXI IN WSS-VARI = 'S' AND
              RLC-CAI-IOPC IN RLC-FLD = LMO-CAI-IOPC IN LMO AND
              RLC-IIC-IOPC IN RLC-FLD = LMO-IIC-IOPC IN LMO
              IF LMO-COD-ECTB IN LMO = 'DES'
                 GO TO NXT-UPD-LMO
              ELSE
                 NEXT SENTENCE.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-LMO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-ELI-RLC-LMO.

       NXT-UPD-LMO.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-UPD-LMO.
       FIN-ELI-RLC-LMO.
           EXIT.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
      *>>>>
*% END
*% END
