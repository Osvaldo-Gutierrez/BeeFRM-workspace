*%! Codigo adicional para archivo
*% IF INI_PUT_DBC_CLN
      *<<<< INI_PUT_DBC_CLN
           IF SCR-IND-MCLI = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN CLN-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN CLN-FLD
*% IF NOT PGM_ARG
               MOVE SPACES TO DBC-GLS-ICLI IN CLN-FLD
*% ELSE
               MOVE ZEROES TO DBC-GLS-ICLI IN CLN-FLD
*% END
      * JVM: CLF con multiples clientes
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLF    MDEU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE 'M' TO DBC-IND-ICLI IN CLN-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN CLN-FLD
               GO TO FIN-PUT-DBC-CLN.
           IF SCR-IND-MCLI NOT = 'M'
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      * FMR:
           IF DBC-FEC-FINP IN DBC = ZEROES
               IF DBC-MSC-TACC = 'I'
                   MOVE DBC-FEC-FTRN IN DBC TO DBC-FEC-FINP IN DBC.
      *>>>>
*% END
*% IF FIN_PUT_DBC_CLN
      *<<<< FIN_PUT_DBC_CLN

           MOVE DBC-CIC-ICLI IN DBC TO CRI-CIC-ICLI IN CRI.
           MOVE 'C' TO CRI-IND-TCAR IN CRI.
           MOVE '99999999' TO CRI-FEC-FCLA IN CRI.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-CRI.
           IF NOT (FIO-STAT-OKS AND
               CRI-CIC-ICLI IN CRI = DBC-CIC-ICLI IN DBC)
               MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-CRI.
      * FMR:
           MOVE DBC-CIC-ICLI IN DBC TO REC-CIC-ICLI IN REC.
           MOVE 'PG' TO REC-COD-TREC IN REC.
           MOVE '999999999999' TO REC-CIC-IREL IN REC.
           MOVE 99 TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF NOT (FIO-STAT-OKS AND REC-CIC-ICLI IN REC =
                                    DBC-CIC-ICLI IN DBC )
               MOVE DBC-CIC-ICLI IN DBC TO REC-CIC-ICLI IN REC
               MOVE 'GC' TO REC-COD-TREC IN REC
               MOVE '999999999999' TO REC-CIC-IREL IN REC
               MOVE 99 TO REC-NUM-TREC IN REC
               MOVE FIO-GET-LEQ TO FIO-CMND
               PERFORM SGC-FIO-REC
               IF NOT (FIO-STAT-OKS AND REC-CIC-ICLI IN REC =
                                        DBC-CIC-ICLI IN DBC)
      * AMP-INI 09-OCT-1993
      *             MOVE 'DEU' TO MSG-COD-SIST
      *             MOVE 'CLCCLIGRUPO' TO MSG-COD-MENS
      *             PERFORM GET-MSG
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE SPACES TO FRM-GLS-NOMC IN CLN-FLD
      * AMP-FIN 09-OCT-1993
                   GO TO FIN-PUT-DBC-CLN.                                     
      * AMP-INI 09-OCT-1993
           IF NOT ( REC-COD-TREC IN REC = 'GC' OR
                    REC-COD-TREC IN REC = 'PG' )
               MOVE SPACES TO FRM-GLS-NOMC IN CLN-FLD
               GO TO FIN-PUT-DBC-CLN.                                     
      * AMP-FIN 09-OCT-1993
           IF REC-COD-TREC IN REC = 'GC'
      * AMP-INI 09-OCT-1993
               MOVE SPACES TO FRM-GLS-NOMC IN CLN-FLD
      *         MOVE 'DEU' TO MSG-COD-SIST
      *         MOVE 'CLCCLIGRUPO' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PUT-DBC-CLN.
           IF REC-IND-VIGE IN REC = 'N'
               MOVE SPACES TO FRM-GLS-NOMC IN CLN-FLD
      * AMP-INI 09-OCT-1993
      *         MOVE 'DEU' TO MSG-COD-SIST
      *         MOVE 'CLCCLIGRUPO' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      * AMP-FIN 09-OCT-1993
               GO TO FIN-PUT-DBC-CLN.
           MOVE REC-CIC-IREL IN REC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO FRM-GLS-NOMC IN CLN-FLD
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NOMC IN CLN-FLD.
      *>>>>
*% END
*% IF FIN_PUT_CLF_CLN
      *<<<< FIN_PUT_CLF_CLN
      *BUS-MSC busca glosa de miscelaneo en tabla                       
           IF CLF-MSC-STAT IN CLN-FLD > SPACES                          
               MOVE 'DEU' TO MSC-COD-SIST                               
               MOVE 'STA ' TO MSC-COD-TMSC IN MSC                       
               MOVE CLF-MSC-STAT IN CLN-FLD TO MSC-COD-CMSC IN MSC      
               PERFORM BUS-MSC                                          
               MOVE MSC-GLS-ABRV IN MSC TO                              
                    FRM-GLS-STAT IN CLN-FLD                             
           ELSE                                                         
               MOVE SPACES TO                                           
                    FRM-GLS-STAT IN CLN-FLD.                            
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-VCCF IN CLF > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-VCCF IN CLF TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-VCCF IN CLN-FLD.
      *BUS-TAB busca glosa de codigo en tabla
      *     IF CLF-COD-TOCF IN CLF > SPACES
      *         MOVE 'TAB' TO TAB-COD-SIST
      *         MOVE 'TIO' TO TAB-COD-TTAB IN TAB
      *         MOVE CLF-COD-TOCF IN CLF TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-ABRV IN TAB TO
      *              FRM-GLS-TOCF IN CLN-FLD.
      *BUS-OFI busca oficina en tablas
           IF CLF-COD-OFIC IN CLF > SPACES
               MOVE CLF-COD-OFIC IN CLF TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN CLN-FLD.
      *BUS-USR busca usuario en tablas
           IF CLF-COD-EJEC IN CLF > SPACES
               MOVE CLF-COD-EJEC IN CLF TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DCOR IN USR TO FRM-GLS-EJEC IN CLN-FLD.
      * FMR:
           IF USR-COD-AGES IN USR > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ADG' TO TAB-COD-TTAB IN TAB
               MOVE USR-COD-AGES IN USR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AGES IN CLN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AGES IN CLN-FLD. 
      *BUS-MSC busca glosa de codigo en tabla
           IF CLF-IND-PREV IN CLF > SPACES
               MOVE 'TAB'  TO MSC-COD-SIST
               MOVE 'IPER' TO MSC-COD-TMSC IN MSC
               MOVE CLF-IND-PREV IN CLF TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-PREV IN CLN-FLD.
      *BUS-MSC busca glosa de codigo en tabla
           IF CLF-MSC-STAT IN CLF > SPACES
               MOVE 'DEU'  TO MSC-COD-SIST
               MOVE 'STA ' TO MSC-COD-TMSC IN MSC
               MOVE CLF-MSC-STAT IN CLF TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-STAT IN CLN-FLD.
      *BUS-MSC busca glosa de codigo en tabla
           IF CLF-COD-RAZC IN CLF > SPACES
               MOVE 'DEU'  TO TAB-COD-SIST
               MOVE 'RZC ' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-RAZC IN CLF TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-RAZC IN CLN-FLD.

      *BUS-TAB busca glosa de codigo auxiliar de la CLF en tabla
      *     IF CLF-COD-AOCF IN CLF > SPACES
      *         MOVE 'TAB' TO TAB-COD-SIST
      *         MOVE 'AUX' TO TAB-COD-TTAB IN TAB
      *         MOVE CLF-COD-COCF IN CLF TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-ABRV IN TAB TO FRM-GLS-AOCF IN CLN-FLD.
      *>>>>
*% END
*% IF INI_CLR_FLD_CLN
      *<<<< INI_CLR_FLD_CLN
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               MOVE SPACES TO FRM-COD-TINF IN CLN-FLD(1)
               MOVE SPACES TO FRM-COD-TINF IN CLN-FLD(2)
               MOVE SPACES TO FRM-COD-TINF IN CLN-FLD(3)
               MOVE ZEROES TO FRM-NUM-ILDC IN CLN-FLD(1)
               MOVE ZEROES TO FRM-NUM-ILDC IN CLN-FLD(2)
               MOVE ZEROES TO FRM-NUM-ILDC IN CLN-FLD(3)
               MOVE ZEROES TO FRM-NUM-CORR IN CLN-FLD(1)
               MOVE ZEROES TO FRM-NUM-CORR IN CLN-FLD(2)
               MOVE ZEROES TO FRM-NUM-CORR IN CLN-FLD(3)
               MOVE SPACES TO FRM-IND-VIGE IN CLN-FLD(1)
               MOVE SPACES TO FRM-IND-VIGE IN CLN-FLD(2)
               MOVE SPACES TO FRM-IND-VIGE IN CLN-FLD(3)
               MOVE SPACES TO FRM-COD-TIPO IN CLN-FLD(1)
               MOVE SPACES TO FRM-COD-TIPO IN CLN-FLD(2)
               MOVE SPACES TO FRM-COD-TIPO IN CLN-FLD(3)
               MOVE SPACES TO FRM-GLS-TIPO IN CLN-FLD(1)
               MOVE SPACES TO FRM-GLS-TIPO IN CLN-FLD(2)
               MOVE SPACES TO FRM-GLS-TIPO IN CLN-FLD(3)
               MOVE SPACES TO FRM-COD-MLDC IN CLN-FLD(1)
               MOVE SPACES TO FRM-COD-MLDC IN CLN-FLD(2)
               MOVE SPACES TO FRM-COD-MLDC IN CLN-FLD(3)
               MOVE SPACES TO FRM-GLS-MLDC IN CLN-FLD(1)
               MOVE SPACES TO FRM-GLS-MLDC IN CLN-FLD(2)
               MOVE SPACES TO FRM-GLS-MLDC IN CLN-FLD(3)
               MOVE ZEROES TO FRM-FEC-FVEN IN CLN-FLD(1)
               MOVE ZEROES TO FRM-FEC-FVEN IN CLN-FLD(2)
               MOVE ZEROES TO FRM-FEC-FVEN IN CLN-FLD(3)
               MOVE ZEROES TO FRM-VAL-CMLC IN CLN-FLD(1)
               MOVE ZEROES TO FRM-VAL-CMLC IN CLN-FLD(2)
               MOVE ZEROES TO FRM-VAL-CMLC IN CLN-FLD(3)
               MOVE ZEROES TO FRM-VAL-CDLC IN CLN-FLD(1)
               MOVE ZEROES TO FRM-VAL-CDLC IN CLN-FLD(2)
               MOVE ZEROES TO FRM-VAL-CDLC IN CLN-FLD(3)
               MOVE SPACES TO FRM-IND-MGAR IN CLN-FLD(1)
               MOVE SPACES TO FRM-IND-MGAR IN CLN-FLD(2)
               MOVE SPACES TO FRM-IND-MGAR IN CLN-FLD(3)
               MOVE SPACES TO FRM-COD-SGAR IN CLN-FLD(1)
               MOVE SPACES TO FRM-COD-SGAR IN CLN-FLD(2)
               MOVE SPACES TO FRM-COD-SGAR IN CLN-FLD(3)
               MOVE SPACES TO FRM-COD-TOOP IN CLN-FLD(1)
               MOVE SPACES TO FRM-COD-TOOP IN CLN-FLD(2)
               MOVE SPACES TO FRM-COD-TOOP IN CLN-FLD(3)
               MOVE SPACES TO FRM-COD-AOOP IN CLN-FLD(1)
               MOVE SPACES TO FRM-COD-AOOP IN CLN-FLD(2)
               MOVE SPACES TO FRM-COD-AOOP IN CLN-FLD(3)
               MOVE SPACES TO FRM-GLS-TOOP IN CLN-FLD(1)
               MOVE SPACES TO FRM-GLS-TOOP IN CLN-FLD(2)
               MOVE SPACES TO FRM-GLS-TOOP IN CLN-FLD(3)
               MOVE SPACES TO FRM-GLS-AOOP IN CLN-FLD(1)
               MOVE SPACES TO FRM-GLS-AOOP IN CLN-FLD(2)
               MOVE SPACES TO FRM-GLS-AOOP IN CLN-FLD(3)
               MOVE SPACES TO FRM-CAI-IOPR IN CLN-FLD(1)
               MOVE SPACES TO FRM-CAI-IOPR IN CLN-FLD(2)
               MOVE SPACES TO FRM-CAI-IOPR IN CLN-FLD(3)
               MOVE SPACES TO FRM-IIC-IOPR IN CLN-FLD(1)
               MOVE SPACES TO FRM-IIC-IOPR IN CLN-FLD(2)
               MOVE SPACES TO FRM-IIC-IOPR IN CLN-FLD(3)
               MOVE SPACES TO FRM-COD-VARC IN CLN-FLD(1)
               MOVE SPACES TO FRM-COD-VARC IN CLN-FLD(2)
               MOVE SPACES TO FRM-COD-VARC IN CLN-FLD(3)
               MOVE SPACES TO FRM-GLS-VARC IN CLN-FLD(1)
               MOVE SPACES TO FRM-GLS-VARC IN CLN-FLD(2)
               MOVE SPACES TO FRM-GLS-VARC IN CLN-FLD(3)
               MOVE ZEROES TO FRM-NUM-PORG IN CLN-FLD(1)
               MOVE ZEROES TO FRM-NUM-PORG IN CLN-FLD(2)
               MOVE ZEROES TO FRM-NUM-PORG IN CLN-FLD(3)
               MOVE ZEROES TO FRM-VAL-CACT IN CLN-FLD(1)
               MOVE ZEROES TO FRM-VAL-CACT IN CLN-FLD(2)
               MOVE ZEROES TO FRM-VAL-CACT IN CLN-FLD(3)
               GO TO FIN-CLR-FLD-CLN.
      *>>>>
*% END
*% IF INI_CLR_DBC_CLN
      *<<<< INI_CLR_DBC_CLN
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
              GO TO FIN-CLR-DBC-CLN.
      *>>>>
*% END
*% IF INI_CLR_CLF_CLN
      *<<<< INI_CLR_CLF_CLN
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
              GO TO FIN-CLR-CLF-CLN.
      *>>>>
*% END
*% IF DBC_NUM_ICLI
      *<<<< DBC_NUM_ICLI
           IF DBC-IND-ICLI IN CLN-FLD = 'M'
               GO TO FIN-VAL-DBC-NUM-ICLI.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
      *>>>>
*% END
*% IF DBC_IND_ICLI
      *<<<< DBC_IND_ICLI
      *>>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_CLN
      *<<<< INI_VAL_CON_KEY_CLN
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-CLN.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_CLN
      *<<<< FIN_VAL_CON_KEY_CLN
           IF NOT ( DBC-NUM-ICLI IN CLN-FLD NOT = ZEROES OR
                    DBC-GLS-NOMC IN CLN-FLD > SPACES OR
                    CLF-IIC-ICLF IN CLN-FLD > ZEROES )
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-CLN.
      *>>>>
*% END
