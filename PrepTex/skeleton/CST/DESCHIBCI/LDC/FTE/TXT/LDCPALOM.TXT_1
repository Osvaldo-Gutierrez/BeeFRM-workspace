*%! Codigo adicional para archivo LDCPQLOM
*% IF SETTAG
*% FNCPQ = " "
*% VSNPQ = " "
*% FNCPU = " "
*% VSNPU = " "
*% END
*% LARGO_MI_COMMAREA = 20
*% PGM_PTC = TRUE
*% IF MI_COMMAREA                                                 
      *<<<< MI_COMMAREA                                                 
           03 SCR-IND-MCLI  VALUE SPACES          PIC X(01).            
      *>>>>
*% END
*% IF CMT_ID_PQ
      *<<<<
      * ***************************************** *                             
      * Programador: EVA-AFRI                     *                             
      * Fecha: 21/07/09                           *                             
      * Mantencion: Consulta por Pantalla         *                             
      * Solo se permiten Consultas para tipos de  *                             
      * Operacion PRY                             *                             
      * ***************************************** *                             
      *>>>>
*% END
*% IF WSS                                                         
      *<<<< WSS                                                         
       COPY LDCBRCLF.                                                   
       COPY LDCBRACL.                                                   
       COPY LDCBRRCL.                                                   
       COPY SGCBRDBC.                                                   
       COPY LDCBRRDC.                                                   
       COPY LDCBRLCC.
       COPY LDCBRRLC.
       COPY LDCBRARG.
       COPY LDCBRARC.
       COPY LDCBRACG.
       COPY COLBROPC.
       COPY TABBRTIO.
       COPY LDCBRLMO.
                                                                 
       COPY LDCWGPRY.                                                   
       COPY LDCBRLDC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.        
       COPY TABBRCAM.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.        
       COPY GNSWGPES.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACL-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCL-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSBRCIC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.        
       COPY GNSWGCPT.                                                   
       COPY GNSWGCIC.                                                   
       COPY GNSWGSTR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.        

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RLC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACG-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LMO-REQA==.        

       COPY TABBRCOM.                                                   
                                                                 
       01  WSS-VARI.                                                    
           03 WSS-CLA-OPER.                                             
               05 WSS-TIP-OPER                          PIC X(03).      
               05 WSS-STP-OPER                          PIC X(03).      
           03 WSS-COD-COGA.                                             
               05 WSS-COD-TGAR                          PIC X(03).      
               05 WSS-GLS-TGAR                          PIC X(03).      
                                                                        
*% IF PGM_PQ
           03 WSS-FEC-FCIE     VALUE 0            PIC 9(08).            
           03 WSS-CIC-ICLF                        PIC X(12).            
           03 WSS-TOT-CLI      VALUE ZEROES       PIC 9(02).            
*% END
*% IF PGM_PU
           03 WSS-VSN-OCAI                        PIC X(01).            
           03 SCR-IND-OCIC  VALUE SPACES                PIC X(01).
           03 WSS-IND-ERCL  VALUE SPACES                PIC X(01).
           03 WSS-IND-ERLC  VALUE SPACES                PIC X(01).
           03 WSS-IND-EDLO  VALUE SPACES                PIC X(01).
           03 WSS-CAI-ICLF  VALUE SPACES                PIC X(04).
           03 WSS-IIC-ICLF  VALUE SPACES                PIC X(08).
      *    FECHA INICIO LDC
           03 WSS-FEC-FINI.
               05 WSS-NUM-SINI                       PIC 9(02).
               05 WSS-NUM-AINI                       PIC 9(02).
               05 WSS-NUM-MINI                       PIC 9(02).
               05 WSS-NUM-DINI                       PIC 9(02).

      *    FECHA VENCIMIENTO LDC
           03 WSS-FEC-TRN.
               05 FEC-TRN1                           PIC 9(02).
               05 FEC-TRN2                           PIC 9(02).
               05 FEC-TRN3                           PIC 9(02).
               05 FEC-TRN4                           PIC 9(02).

      *    FECHA VENCIMIENTO LDC
           03 WSS-FEC-FVEN.
               05 WSS-NUM-SVEN                       PIC 9(02).
               05 WSS-NUM-AVEN                       PIC 9(02).
               05 WSS-NUM-MVEN                       PIC 9(02).
               05 WSS-NUM-DVEN                       PIC 9(02).

           03 WSS-FEC-FFDE.
               05 WSS-NUM-SFDE                       PIC 9(02).
               05 WSS-NUM-AFDE                       PIC 9(02).
               05 WSS-NUM-MFDE                       PIC 9(02).
               05 WSS-NUM-DFDE                       PIC 9(02).

           03 WSS-FEC-FFFE.
               05 WSS-NUM-SFFE                       PIC 9(02).
               05 WSS-NUM-AFFE                       PIC 9(02).
               05 WSS-NUM-MFFE                       PIC 9(02).
               05 WSS-NUM-DFFE                       PIC 9(02).

           03 WSS-FEC-FING.
               05 WSS-NUM-SING                       PIC 9(02).
               05 WSS-NUM-AING                       PIC 9(02).
               05 WSS-NUM-MING                       PIC 9(02).
               05 WSS-NUM-DING                       PIC 9(02).

           03 WSS-FEC-FAPE.
               05 WSS-NUM-SAPE                       PIC 9(02).
               05 WSS-NUM-AAPE                       PIC 9(02).
               05 WSS-NUM-MAPE                       PIC 9(02).
               05 WSS-NUM-DAPE                       PIC 9(02).

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           03 WSS-COD-TOOC                           PIC X(03).
           03 WSS-COD-AOOC                           PIC X(03).
           03 WSS-IND-MLDC                           PIC X(01).
           03 WSS-COD-OFIC                           PIC X(03).
           03 WSS-COD-VCLC                           PIC X(06).
           03 WSS-NUM-ILDC   VALUE ZEROES            PIC 9(02).
           03 WSS-VAL-MORI   VALUE ZEROES      PIC 9(11)V9(04).
           03 WSS-SGV-MUTI   VALUE ZEROES      PIC 9(11)V9(04).
           03 WSS-SGV-MTO2   VALUE ZEROES      PIC 9(11)V9(04).
           03 WSS-SGV-CMAX   VALUE ZEROES      PIC 9(11)V9(04).

           03 WSS-FEC-FACV.
               05 WSS-NUM-SACV                       PIC 9(02).
               05 WSS-NUM-AACV                       PIC 9(02).
               05 WSS-NUM-MACV                       PIC 9(02).
               05 WSS-NUM-DACV                       PIC 9(02).
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

      *    INDICADOR ERROR
           03 WSS-IND-ERRO                           PIC X(01).
*% END
           03 WSS-IND-ICLF     VALUE SPACES       PIC X(01).            
*% IF PGM_PU
       01  WSS-FRM-MEN2.
           03 WSS-CAI-MEN2                  PIC X(04).
           03 WSS-BLK1       VALUE SPACES   PIC X(03).
           03 WSS-NUM-MEN2                  PIC 9(08).
           03 WSS-BLK2       VALUE SPACES   PIC X(24).
*% END
      *>>>>
*% END
*% IF FIN_PGM_STAT
      *<<<<
              05 PGM-STAT-RDC.                                          
                 88 PGM-STAT-RDC-NUL    VALUE '  '.                     
                 07 PGM-STT1-RDC        VALUE '2' PIC X(01).            
                    88 PGM-STAT-RDC-OKS VALUE '0'.                      
                 07 PGM-STT2-RDC        VALUE '3' PIC X(01).            
      *>>>>
*% END
*% IF FND_KEY
      *<<<<
          IF SCR-CMND = 'VRF'                                          
              PERFORM KEY-ALL-LOM                                       
              MOVE CLF-CAI-ICLF IN LOM-FLD TO CLF-CAI-ICLF IN PRY-VARI  
              MOVE CLF-IIC-ICLF IN LOM-FLD TO CLF-IIC-ICLF IN PRY-VARI  
              MOVE ZEROES                  TO LDC-NUM-ILDC IN PRY-VARI  
              MOVE 'VRF'                   TO PRY-IND-IFLD IN PRY-VARI  
              PERFORM BUS-VAL-ACU-LOM                                   
              IF (PRY-IND-CMND NOT = 'S' OR                             
                  PRY-IND-ERRO     = 'S')                               
                   MOVE 'DEU'                    TO MSG-COD-SIST        
                   MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS        
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC             TO FRM-MENS            
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR            
                   MOVE '00' TO FIO-STAT                                
                   MOVE SCR-STAT-CON      TO SCR-STAT                   
                   PERFORM KEY-ALL-LOM                                  
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM LDC-FIO-CLF                                  
                   MOVE FIO-STAT TO PGM-STAT-CLF                        
                   GO TO FIN-FND-KEY.                                   
                                                                        
           IF SCR-CMND = 'ACA'                                          
              PERFORM KEY-ALL-LOM                                       
              MOVE CLF-CAI-ICLF IN LOM-FLD TO CLF-CAI-ICLF IN PRY-VARI  
              MOVE CLF-IIC-ICLF IN LOM-FLD TO CLF-IIC-ICLF IN PRY-VARI  
              MOVE ZEROES                  TO LDC-NUM-ILDC IN PRY-VARI  
              MOVE 'LOM'                   TO PRY-IND-IFLD IN PRY-VARI  
              PERFORM BUS-VAL-ACU-LOM                                   
              IF (PRY-IND-CMND NOT = 'S' OR                             
                  PRY-IND-ERRO     = 'S')                               
                   MOVE 'DEU'                    TO MSG-COD-SIST        
                   MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS        
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC             TO FRM-MENS            
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR            
                   MOVE '00' TO FIO-STAT                                
                   MOVE SCR-STAT-CON      TO SCR-STAT                   
                   PERFORM KEY-ALL-LOM                                  
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM LDC-FIO-CLF                                  
                   MOVE FIO-STAT TO PGM-STAT-CLF                        
                   GO TO FIN-FND-KEY.                                   
                                                                        
           IF SCR-CCPP = 'ING'                                          
               PERFORM FND-DIRECTO                                      
               GO TO FIN-FND-KEY.                                       
                                                                        
           MOVE ZEROES TO WSS-TOT-CLI.                                  
           IF CLF-IIC-ICLF IN LOM-FLD > ZEROES                          
               PERFORM FND-DIRECTO                                      
               IF FIO-STAT-OKS                                          
                  PERFORM GET-CUR-RDC                                   
                  IF NOT PGM-STAT-RDC-OKS                               
                     MOVE 'DEU' TO MSG-COD-SIST                         
                     MOVE 'CLF    NORDC' TO MSG-COD-MENS                
                     MOVE SCR-STAT-CON TO SCR-STAT                      
                     GO TO ERR-FND-KEY                                  
                  ELSE                                                  
                    MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC     
                    MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY                    
                    MOVE FIO-GET-KEY TO FIO-CMND                        
                    PERFORM SGC-FIO-DBC                                 
                    MOVE FIO-STAT TO PGM-STAT-DBC                       
                    IF NOT FIO-STAT-OKS                                 
                       MOVE 'TAB'        TO MSG-COD-SIST                
                       MOVE 'CLI    NEX' TO MSG-COD-MENS                
                       PERFORM GET-MSG                                  
                       MOVE MSG-GLS-DESC TO FRM-MENS                    
                       MOVE FIO-STAT-NEX TO PGM-STAT-DBC                
                       MOVE SCR-STAT-CON TO SCR-STAT                    
                       GO TO FIN-FND-KEY                                
                    ELSE                                                
                       PERFORM GET-NXT-RDC                              
                       GO TO EXA-COM-STAT                               
               ELSE                                                     
                   MOVE 'CLF    NEX' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY.                                   
                                                                        
      *    BUSCA EL PADRE POR ALGUNA DE LAS LLAVES (LA DIGITADA)        
           IF DBC-NUM-ICLI IN LOM-FLD NOT = ZEROES                      
               MOVE DBC-NUM-ICLI IN LOM-FLD TO DBC-NUM-ICLI IN DBC      
               MOVE DBC-IND-ICLI IN LOM-FLD TO DBC-IND-ICLI IN DBC      
               MOVE DBC-GLS-ICLI IN LOM-FLD TO DBC-GLS-ICLI IN DBC      
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DBC                                      
               MOVE FIO-STAT TO PGM-STAT-DBC                            
               IF FIO-STAT-OKS                                          
                   MOVE DBC-COD-OFIC IN DBC TO                          
                        CLF-COD-OFIC IN LOM-FLD                         
                   MOVE DBC-COD-EJEC IN DBC TO                          
                        CLF-COD-EJEC IN LOM-FLD                         
                   GO TO CON-BUS-DBC.                                   
                                                                        
           IF DBC-GLS-NOMC IN LOM-FLD > SPACES                          
               MOVE DBC-GLS-NOMC IN LOM-FLD TO STR-GLS-GSTR             
               PERFORM STR-UNS                                          
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO                      
                    DBC-GLS-APAT IN DBC                                 
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO                      
                    DBC-GLS-AMAT IN DBC                                 
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO                      
                    DBC-GLS-NOMB IN DBC                                 
               MOVE 'DBC-GLS-NOMC'   TO FIO-AKEY                        
               MOVE FIO-GET-NLS TO FIO-CMND                             
               PERFORM SGC-FIO-DBC                                      
               MOVE FIO-STAT TO PGM-STAT-DBC                            
               IF FIO-STAT-OKS                                          
                   GO TO CON-BUS-DBC.                                   
                                                                        
           MOVE 'TAB'        TO MSG-COD-SIST.                           
           MOVE 'CLI    NEX' TO MSG-COD-MENS.                           
           GO TO AFT-SIS-ERR-FND-KEY.                                   
                                                                        
       CON-BUS-DBC.                                                     
      *BUSCA-CLF                                                        
      * EVA-INI  07/09 Mantencion Consulta                              
      *    MOVE CLF-CAI-ICLF IN LOM-FLD TO                              
      *         ACL-CAI-ICLF IN ACL.                                    
      *    MOVE CLF-IIC-ICLF IN LOM-FLD TO                              
      *         ACL-IIC-ICLF IN ACL.                                    
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM LDC-FIO-ACL.                                         
      *    IF NOT FIO-STAT-OKS                                          
      *        MOVE 'DEU'        TO MSG-COD-SIST                        
      *        MOVE 'ACL    NEX' TO MSG-COD-MENS                        
      *    ELSE                                                         
      *        PERFORM PUT-ACL-LOM.                                     
      * EVA-FIN  07/09 Mantencion Consulta                              
      *    SE ENCONTRO EL DBC Y BUSCA EL CLF                            
           MOVE '00' TO PGM-STAT-DBC.                                   
           PERFORM BUS-CLF.                                             
           IF MSG-COD-MENS > SPACES                                     
               GO TO ERR-FND-KEY                                        
           ELSE                                                         
               GO TO EXA-COM-STAT.                                      
                                                                        
       FND-DIRECTO.                                                     
           PERFORM KEY-ALL-LOM.                                         
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF FIO-STAT-OKS
               MOVE CLF-STP-ITRN IN CLF TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-CLF.
           GO TO EXA-COM-STAT.
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       EXA-COM-STAT.                                                    
      *    VALIDA POR TABLA (DEU-CNT)                                   
           MOVE 'DEU'                  TO FIO-SIST.                     
           MOVE 'CNT'                  TO TAB-COD-TTAB IN TAB.          
           MOVE CLF-COD-TOCF IN CLF    TO TAB-COD-CTAB IN TAB.          
           MOVE FIO-GET-KEY            TO FIO-CMND.                     
           PERFORM GNS-FIO-TAB.                                         
           IF (NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT = 'S' )      
                MOVE 'DEU'             TO MSG-COD-SIST                  
      *         MOVE 'TIONOCONST'       TO MSG-COD-MENS                 
                MOVE 'TIO  NOPRY'       TO MSG-COD-MENS                 
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC      TO FRM-MENS                      
                MOVE '00' TO FIO-STAT                                   
                MOVE SCR-STAT-CON      TO SCR-STAT                      
      * EVA-INI  07/09 Mantencion Consulta                              
      *         GO TO FIN-FND-KEY.                                      
                GO TO ERR-FND-KEY.                                      
      * EVA-FIN  07/09 Mantencion Consulta                              
           IF SCR-CCPP NOT = 'ING'                                      
              MOVE CLF-CAI-ICLF IN LOM-FLD TO ACL-CAI-ICLF IN ACL       
              MOVE CLF-IIC-ICLF IN LOM-FLD TO ACL-IIC-ICLF IN ACL       
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM LDC-FIO-ACL                                       
              IF NOT FIO-STAT-OKS                                       
                 MOVE 'DEU'        TO MSG-COD-SIST                      
                 MOVE 'ACL    NEX' TO MSG-COD-MENS                      
              ELSE                                                      
                 MOVE FIO-STAT TO PGM-STAT-ACL                          
                 PERFORM PUT-ACL-LOM.                                   
           IF SCR-CMND = 'MCA' OR                                       
              SCR-CMND = 'MDF'                                          
               IF NOT ( CLF-MSC-STAT IN CLF = 'A' OR                    
                        CLF-MSC-STAT IN CLF = 'F' )                     
                   MOVE 'DEU'             TO MSG-COD-SIST               
                   MOVE 'CLFNOACA  '       TO MSG-COD-MENS              
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC      TO FRM-MENS                   
                   MOVE '00' TO FIO-STAT                                
                   MOVE SCR-STAT-CON      TO SCR-STAT                   
                   GO TO FIN-FND-KEY.                                   
           IF SCR-CMND = 'ACA' OR                                       
              SCR-CMND = 'ELI' OR                                       
              SCR-CMND = 'MOD'                                          
               IF CLF-MSC-STAT IN CLF = 'A' OR                          
                  CLF-MSC-STAT IN CLF = 'F'                             
                   MOVE 'DEU'             TO MSG-COD-SIST               
                   MOVE 'CLFYAACA  '       TO MSG-COD-MENS              
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC      TO FRM-MENS                   
                   MOVE '00' TO FIO-STAT                                
                   MOVE SCR-STAT-CON      TO SCR-STAT                   
                   GO TO FIN-FND-KEY.                                   
                                                                        
           IF SCR-CMND = 'ACA' AND                                      
              CLF-MSC-STAT IN CLF NOT = 'V'                             
                   MOVE 'DEU'             TO MSG-COD-SIST               
                   MOVE 'CLFNOVRF  '       TO MSG-COD-MENS              
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC      TO FRM-MENS                   
                   MOVE '00' TO FIO-STAT                                
                   MOVE SCR-STAT-CON      TO SCR-STAT                   
                   GO TO FIN-FND-KEY.                                   
                                                                        
           IF SCR-CMND = 'VRF' AND                                      
              CLF-MSC-STAT IN CLF = 'F'                                 
                   MOVE 'DEU'             TO MSG-COD-SIST               
                   MOVE 'CLFYAACA  '       TO MSG-COD-MENS              
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC      TO FRM-MENS                   
                   MOVE '00' TO FIO-STAT                                
                   MOVE SCR-STAT-CON      TO SCR-STAT                   
                   GO TO FIN-FND-KEY.                                   
           IF SCR-CMND = 'VRF' AND                                      
              CLF-MSC-STAT IN CLF = 'V'                                 
                   MOVE 'DEU'             TO MSG-COD-SIST               
                   MOVE 'CLFYAVRF  '       TO MSG-COD-MENS              
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC      TO FRM-MENS                   
                   MOVE '00' TO FIO-STAT                                
                   MOVE SCR-STAT-CON      TO SCR-STAT                   
                   GO TO FIN-FND-KEY.                                   
       FIN-ANL-CLF.                                                     
           MOVE PGM-STAT-CLF TO FIO-STAT.                               
           GO TO FIN-FND-KEY.                                           
       ERR-FND-KEY.                                                     
           MOVE 'DEU' TO MSG-COD-SIST.                                  
       AFT-SIS-ERR-FND-KEY.                                             
           MOVE 'S' TO SCR-IERR.                                        
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
                                                                        
           IF SCR-CCPP = 'ING'                                          
               MOVE '00' TO PGM-STAT-CLF                                
               MOVE '00' TO FIO-STAT                                    
           ELSE                                                         
               MOVE '23' TO PGM-STAT-CLF                                
               MOVE '23' TO FIO-STAT.                                   
                                                                        
           IF NOT (                                                     
                   PGM-STAT-DBC-OKS OR                                  
                   PGM-STAT-CLF-OKS                                     
                  )                                                     
               MOVE SCR-STAT-ABT TO SCR-STAT                            
               GO TO FIN-FND-KEY.                                       
                                                                        
                                                                        
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.                        
           IF PGM-STAT-DBC-OKS                                          
               PERFORM PUT-DBC-LOM.                                     
                                                                        
           IF PGM-STAT-CLF-OKS                                          
               PERFORM PUT-CLF-LOM.                                     
                                                                        
           GO TO FIN-FND-KEY. 
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<<
           IF SCR-CMND = 'ING' OR SCR-CMND = 'MOD'
                MOVE FRM-CPIM-AEY TO CLF-VAL-CMAX-ATR IN LOM-FLD
                MOVE FRM-CPIM-AEY TO ACL-FEC-FFDE-ATR IN LOM-FLD
                MOVE FRM-CPIM-AEY TO ACL-FEC-FIDE-ATR IN LOM-FLD.

*% IF PGM_PQ
           IF SCR-CMND  = 'ACA' OR 'VRF'
              PERFORM PRO-MKY-DBC
              PERFORM PRO-FLD-LOM.


           IF SCR-CMND = 'TER'
                PERFORM PRO-MKY-DBC
                PERFORM PRO-FLD-LOM
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD.

           IF SCR-CMND = 'RCH'
                PERFORM PRO-MKY-DBC
                PERFORM PRO-FLD-LOM
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD.

           IF SCR-CMND = 'MDF'
                PERFORM PRO-MKY-DBC
                PERFORM PRO-FLD-LOM
                MOVE FRM-CPIM-UBY TO ACL-GLS-DES1-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DES2-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DES3-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DIRE-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-COD-LUGA-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO CLF-COD-EJEC-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-MAIL-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-COD-COGA-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DGAR-ATR IN LOM-FLD
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD
                MOVE -1 TO ACL-GLS-DES1-LEN IN LOM-FLD.

           IF SCR-CMND = 'MOD'
               PERFORM PRO-MKY-DBC.

           IF SCR-CMND = 'MCA'
                PERFORM PRO-MKY-DBC
                PERFORM PRO-FLD-LOM
                MOVE FRM-CPIM-UBY TO ACL-NUM-PVIG-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-IND-PVIG-ATR IN LOM-FLD
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD
                MOVE -1 TO ACL-NUM-PVIG-LEN IN LOM-FLD.
*% END
*% IF PGM_PU
           IF SCR-CMND  = 'ACA' OR 'VRF'
              PERFORM PRO-FLD-LOM.

           IF SCR-CMND = 'VRF'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD.

           IF SCR-CMND = 'TER'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD.

           IF SCR-CMND = 'RCH'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD.

           IF SCR-CMND = 'MDF'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE FRM-CPIM-UBY TO ACL-GLS-DES1-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DES2-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DES3-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DIRE-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-COD-LUGA-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO CLF-COD-EJEC-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-MAIL-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-COD-COGA-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DGAR-ATR IN LOM-FLD
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD
                MOVE -1 TO ACL-GLS-DES1-LEN IN LOM-FLD.

           IF SCR-CMND = 'MCA'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE FRM-CPIM-UBY TO ACL-NUM-PVIG-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-IND-PVIG-ATR IN LOM-FLD
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD
                MOVE -1 TO ACL-NUM-PVIG-LEN IN LOM-FLD.
*% END
      *>>>>
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
           IF SCR-CMND = 'MOD'
              IF NOT (CLF-MSC-STAT IN LOM-FLD = 'I')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
           MOVE ACL-NUM-SFDE IN LOM-FLD TO CLF-NUM-SVEN IN CLF.
           MOVE ACL-NUM-AFDE IN LOM-FLD TO CLF-NUM-AVEN IN CLF.
           MOVE ACL-NUM-MFDE IN LOM-FLD TO CLF-NUM-MVEN IN CLF.
           MOVE ACL-NUM-DFDE IN LOM-FLD TO CLF-NUM-DVEN IN CLF.

           IF SCR-CMND = 'ACA'
              IF NOT (CLF-MSC-STAT IN LOM-FLD = 'V')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD
              ELSE
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *         MOVE 'F' TO CLF-MSC-STAT IN CLF.
                MOVE 'F' TO CLF-MSC-STAT IN CLF
                MOVE 'LOM' TO PRY-IND-IFLD IN PRY-VARI
                MOVE HOY-SHOY TO WSS-NUM-SACV IN WSS-VARI
                MOVE HOY-AHOY TO WSS-NUM-AACV IN WSS-VARI
                MOVE HOY-MHOY TO WSS-NUM-MACV IN WSS-VARI
                MOVE HOY-DHOY TO WSS-NUM-DACV IN WSS-VARI.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           IF SCR-CMND = 'VRF' AND
              (CLF-MSC-STAT IN LOM-FLD NOT = 'I')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD.

           IF SCR-CMND = 'VRF' AND
              (CLF-MSC-STAT IN LOM-FLD = 'F')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'CLF    ACAYA' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD.

           IF SCR-CMND = 'VRF' AND
              (CLF-MSC-STAT IN LOM-FLD = 'I')
                MOVE 'V' TO CLF-MSC-STAT IN LOM-FLD
                MOVE 'V' TO CLF-MSC-STAT IN CLF.

           IF SCR-CMND = 'RCH'
              IF NOT
                (CLF-MSC-STAT IN LOM-FLD = 'I' OR
                 CLF-MSC-STAT IN LOM-FLD = 'V')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD
              ELSE
                MOVE 'R' TO CLF-MSC-STAT IN CLF.

           IF SCR-CMND = 'TER'
              IF NOT (CLF-MSC-STAT IN LOM-FLD = 'F')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD
              ELSE
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
                MOVE CLF-COD-OFIC IN LOM-FLD TO
                     WSS-COD-OFIC IN WSS-VARI
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                MOVE 'T' TO CLF-MSC-STAT IN CLF
                MOVE CLF-CAI-ICLF IN LOM-FLD TO
                     WSS-CAI-ICLF IN WSS-VARI
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
                MOVE CLF-COD-TOCF IN LOM-FLD TO
                     WSS-COD-TOOC IN WSS-VARI
                MOVE CLF-COD-AOCF IN LOM-FLD TO
                     WSS-COD-AOOC IN WSS-VARI
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                MOVE CLF-IIC-ICLF IN LOM-FLD TO
                     WSS-IIC-ICLF IN WSS-VARI.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLFUPDNOMOD ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           IF SCR-CMND NOT = 'ACA'
               GO TO CNT-CMN-MOD.

           MOVE CLF-CAI-ICLF IN LOM-FLD TO LCC-CAI-ICLF IN LCC.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO LCC-IIC-ICLF IN LCC.
           MOVE ZEROES                  TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-CMN-MOD.
           PERFORM LDC-FIO-LCC.
           IF NOT (FIO-STAT-OKS AND
               CLF-CAI-ICLF IN LOM-FLD = LCC-CAI-ICLF IN LCC AND
               CLF-IIC-ICLF IN LOM-FLD = LCC-IIC-ICLF IN LCC)
               GO TO CNT-CMN-MOD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF FIO-STAT-OKS
              MOVE WSS-NUM-SACV IN WSS-VARI TO LCC-NUM-SACV IN LCC
              MOVE WSS-NUM-AACV IN WSS-VARI TO LCC-NUM-AACV IN LCC
              MOVE WSS-NUM-MACV IN WSS-VARI TO LCC-NUM-MACV IN LCC
              MOVE WSS-NUM-DACV IN WSS-VARI TO LCC-NUM-DACV IN LCC
              MOVE FIO-MOD TO FIO-CMND
              PERFORM LDC-FIO-LCC
              IF NOT FIO-STAT-OKS
                  MOVE 'DEU' TO MSG-COD-SIST
                  MOVE 'LCCUPDNOMOD ' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  GO TO FIN-CMN-MOD
              ELSE
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LOOP-CMN-MOD.

       CNT-CMN-MOD.

      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           IF SCR-CMND = 'TER'
                PERFORM BUS-DLO-DEM.
           MOVE CLF-CAI-ICLF IN LOM-FLD TO ACL-CAI-ICLF IN ACL.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO ACL-IIC-ICLF IN ACL.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLFNOMOD    ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.
           PERFORM RET-ACL-LOM.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLFNOMOD    ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.

           IF SCR-CMND = 'ACA'
               MOVE CLF-CIC-ICLF IN CLF TO CLF-CIC-ICLF IN PRY-VARI
               MOVE CLF-COD-VCCF IN CLF TO CLF-COD-VCCF IN PRY-VARI
               MOVE CLF-FEC-FAPE IN CLF TO WSS-FEC-FAPE IN PRY-VARI
               MOVE CLF-MSC-STAT IN CLF TO CLF-MSC-STAT IN PRY-VARI
               MOVE 'LOM'               TO PRY-IND-IFLD IN PRY-VARI
               PERFORM UPD-CMAX-LOM
               IF(PRY-IND-ERRO     = 'S')
                   MOVE 'DEU'                    TO MSG-COD-SIST
                   MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC             TO FRM-MENS
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR
                   MOVE '00' TO FIO-STAT
                   MOVE 'S' TO SCR-IERR.

      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
       CIC-GET-CIC-ING.
           IF CLF-IIC-ICLF IN LOM-FLD > ZEROES
               MOVE 'N' TO SCR-IND-OCIC
           ELSE
               MOVE 'S' TO SCR-IND-OCIC
               MOVE CLF-CAI-ICLF IN LOM-FLD TO CIC-CAI-ICIC IN CIC
               MOVE CIC-GET TO CIC-CMND
               PERFORM PRO-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE CIC-MENS TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-CMN-ING
               ELSE
                   MOVE CIC-CIC-ICIC TO CLF-CIC-ICLF IN CLF
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM LDC-FIO-CLF
                   IF FIO-STAT-OKS
                       GO TO CIC-GET-CIC-ING
                   ELSE
                       MOVE CIC-CAI-ICIC TO CLF-CAI-ICLF IN LOM-FLD
                       MOVE CIC-IIC-ICIC TO CLF-IIC-ICLF IN LOM-FLD.
                       MOVE 'GNS' TO MSG-COD-SIST
                       MOVE 'INGYES' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE CIC-CAI-ICIC TO WSS-CAI-MEN2
                       MOVE CIC-NUM-ICIC TO WSS-NUM-MEN2 IN WSS-FRM-MEN2
                       MOVE WSS-FRM-MEN2 TO FRM-MEN2.

           MOVE SPACES TO CLF-GLS-FLAG IN CLF.
           MOVE SPACES TO CLF-CAI-CREN IN CLF.
           MOVE ZEROES TO CLF-IIC-CREN IN CLF.
           MOVE ZEROES TO CLF-NUM-PREV IN CLF.
           MOVE ZEROES TO CLF-VAL-COMI IN CLF.
           MOVE ZEROES TO CLF-NUM-SOL  IN CLF.
           MOVE ZEROES TO CLF-IND-PREV IN CLF.
           MOVE ZEROES TO CLF-FEC-FCIE IN CLF.
           MOVE SPACES TO CLF-COD-RAZC IN CLF.
           MOVE ZEROES TO CLF-FEC-FPRV IN CLF.
           MOVE ACL-NUM-SFDE IN LOM-FLD TO CLF-NUM-SVEN IN CLF.
           MOVE ACL-NUM-AFDE IN LOM-FLD TO CLF-NUM-AVEN IN CLF.
           MOVE ACL-NUM-MFDE IN LOM-FLD TO CLF-NUM-MVEN IN CLF.
           MOVE ACL-NUM-DFDE IN LOM-FLD TO CLF-NUM-DVEN IN CLF.

           MOVE 'I'      TO CLF-MSC-TACC IN CLF.

      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           MOVE FIO-STAT TO PGM-STAT-CLF.
           IF NOT FIO-STAT-OKS
      *        ERROR INCONSISTENCIA EN EL INGRESO : INFORMAR
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
      *<<<< FIN_CMN_ING
           IF DBC-IND-ICLI IN LOM-FLD NOT = 'M'
              PERFORM PUT-RDC
              IF NOT FIO-STAT-OKS
                 MOVE 'DEU'        TO MSG-COD-SIST
                 MOVE 'RDC    PUT' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 GO TO FIN-CMN-ING.

           PERFORM PUT-ACL.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'ACL    PUT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ING.
      *>>>>
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI
           PERFORM REL-ENT.
           IF WSS-IND-ERCL IN WSS-VARI = 'S' OR
              WSS-IND-EDLO IN WSS-VARI = 'S'
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'ELI    INVAL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE 'S' TO SCR-IERR
              GO TO FIN-CMN-ELI.

           IF NOT
             (CLF-MSC-STAT IN LOM-FLD = 'I' OR
              CLF-MSC-STAT IN LOM-FLD = 'V')
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'MSC    INVAL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE 'S' TO SCR-IERR
              GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'CLFNOELI    ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.

           PERFORM DEL-ARC.
           PERFORM DEL-ARG.
           PERFORM DEL-LDC.
           PERFORM DEL-RDC.
           PERFORM DEL-LCC.
           PERFORM DEL-ACL.
           IF MSG-COD-MENS > SPACES
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'ACLNOELI    ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE 'S' TO SCR-IERR
               GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF EOF_PQ 
      *<<<< PGM_PQ                                                      
       BUS-CLF SECTION.                                                 
       INI-BUS-CLF.                                                     
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.             
           MOVE SPACES              TO RDC-CIC-ICLF IN RDC.             
                                                                        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM LDC-FIO-RDC.                                         
           MOVE FIO-STAT TO PGM-STAT-RDC.                               
           IF NOT ( FIO-STAT-OKS AND                                    
                    DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDC )         
               MOVE 'DEU'          TO MSG-COD-SIST                      
               MOVE 'CLF    NORDC' TO MSG-COD-MENS                      
               GO TO BRW-BUS-CLF.                                       
                                                                        
           MOVE ZEROES TO WSS-FEC-FCIE.                                 
           MOVE RDC-CIC-ICLF IN RDC TO WSS-CIC-ICLF IN WSS-VARI.        
       LUP-BUS-CLF.                                                     
           MOVE RDC-CIC-ICLF IN RDC TO CLF-CIC-ICLF IN CLF.             
           MOVE CLF-CAI-ICLF IN CLF TO CLF-CAI-ICLF IN LOM-FLD.         
           MOVE CLF-IIC-ICLF IN CLF TO CLF-IIC-ICLF IN LOM-FLD.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           MOVE FIO-STAT TO PGM-STAT-CLF.                               
           PERFORM LDC-FIO-CLF.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'CLF    NEX' TO MSG-COD-MENS                        
               GO TO BRW-BUS-CLF.                                       
                                                                        
           MOVE 'DEU'                  TO FIO-SIST.                     
           MOVE 'CNT'                  TO TAB-COD-TTAB IN TAB.          
           MOVE CLF-COD-TOCF IN CLF    TO TAB-COD-CTAB IN TAB.          
           MOVE FIO-GET-KEY            TO FIO-CMND.                     
           PERFORM GNS-FIO-TAB.                                         
           IF (NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT = 'S' )      
               GO TO NXT-BUS-CLF.                                       
                                                                        
           IF NOT ( CLF-MSC-STAT IN CLF = 'C' OR 'R' OR 'N' )           
               GO TO BRW-BUS-CLF.                                       
                                                                        
      *    IF CLF-FEC-FCIE IN CLF > WSS-FEC-FCIE                        
      *       AND CLF-MSC-STAT IN CLF NOT = 'R'                         
      *        MOVE CLF-CIC-ICLF IN CLF TO WSS-CIC-ICLF                 
      *        MOVE CLF-FEC-FCIE IN CLF TO WSS-FEC-FCIE.                
                                                                        
       NXT-BUS-CLF.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM LDC-FIO-RDC.                                         
           MOVE FIO-STAT TO PGM-STAT-RDC.                               
           IF FIO-STAT-OKS AND                                          
              DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDC                 
               GO TO LUP-BUS-CLF.                                       
                                                                        
           MOVE WSS-CIC-ICLF IN WSS-VARI TO CLF-CIC-ICLF IN CLF.        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM LDC-FIO-CLF.                                         
           MOVE FIO-STAT TO PGM-STAT-CLF.                               
           MOVE CLF-CAI-ICLF IN CLF TO CLF-CAI-ICLF IN LOM-FLD.         
           MOVE CLF-IIC-ICLF IN CLF TO CLF-IIC-ICLF IN LOM-FLD.         
       BRW-BUS-CLF.                                                     
           IF PGM-STAT-RDC-OKS                                          
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM LDC-FIO-RDC.                                     
       FIN-BUS-CLF.                                                     
           EXIT.                                                        
                                                                        
       GET-CUR-RDC SECTION.                                             
       INI-GET-CUR-RDC.                                                 
           MOVE CLF-CIC-ICLF IN CLF TO RDC-CIC-ICLF IN RDC.             
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS    TO FIO-CMND.                             
           PERFORM LDC-FIO-RDC.                                         
           IF FIO-STAT-CDK                                              
               MOVE '00' TO FIO-STAT.                                   
           IF NOT ( FIO-STAT-OKS AND                                    
                    CLF-CIC-ICLF IN CLF = RDC-CIC-ICLF IN RDC )         
               MOVE '23' TO PGM-STAT-RDC                                
               IF FIO-STAT-OKS                                          
                   MOVE 'RDC-KEY-ICLF' TO FIO-AKEY                      
                   MOVE FIO-END-BRW TO FIO-CMND                         
                   PERFORM LDC-FIO-RDC                                  
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
               MOVE '00' TO PGM-STAT-RDC                                
               MOVE 1 TO WSS-TOT-CLI.                                   
                                                                        
       FIN-GET-CUR-RDC.                                                 
           EXIT.                                                        
                                                                        
       GET-NXT-RDC SECTION.                                             
       INI-GET-NXT-RDC.                                                 
           MOVE SPACES TO MSG-COD-SIST.                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.                             
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM LDC-FIO-RDC.                                         
           IF FIO-STAT-OKS AND                                          
              CLF-CIC-ICLF IN CLF = RDC-CIC-ICLF IN RDC                 
                ADD 1 TO WSS-TOT-CLI                                    
                MOVE 'M' TO SCR-IND-MCLI                                
           ELSE                                                         
                MOVE SPACES TO SCR-IND-MCLI.                            
       FIN-GET-NXT-RDC.                                                 
           EXIT.                                                        
                                                                        
       PRO-FLD-LOM SECTION.                                             
       INI-PRO-FLD-LOM.                                                 
           PERFORM PRO-CLF-LOM.                                         
           PERFORM PRO-DBC-LOM.                                         
           PERFORM PRO-ACL-LOM.                                         
       FIN-PRO-FLD-LOM.                                                 
           EXIT.                                                        
                                                                        
       PRO-CLF-LOM SECTION.                                             
       INI-PRO-CLF-LOM.                                                 
           MOVE FRM-CPIM-AEY TO CLF-COD-VCCF-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO CLF-COD-TOCF-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO CLF-COD-AOCF-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO CLF-MSC-STAT-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO CLF-COD-OFIC-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO CLF-COD-EJEC-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO CLF-VAL-CMAX-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-NUM-PVIG-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-IND-PVIG-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO CLF-FEC-FING-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN LOM-FLD.            
       FIN-PRO-CLF-LOM.                                                 
           EXIT.                                                        
                                                                        
       PRO-DBC-LOM SECTION.                                             
       INI-PRO-DBC-LOM.                                                 
       FIN-PRO-DBC-LOM.                                                 
           EXIT.                                                        
                                                                        
       PRO-ACL-LOM SECTION.                                             
       INI-PRO-ACL-LOM.                                                 
           MOVE FRM-CPIM-AEY TO ACL-GLS-NOMB-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-GLS-DES1-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-GLS-DES2-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-GLS-DES3-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-GLS-DIRE-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-COD-LUGA-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-VAL-MCON-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-VAL-MSOL-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-FEC-FINI-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-FEC-FIDE-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-FEC-FFDE-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-GLS-MAIL-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-COD-COGA-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO ACL-GLS-DGAR-ATR IN LOM-FLD.            
       FIN-PRO-ACL-LOM.                                                 
           EXIT.                                                        
       PRO-MKY-DBC SECTION.                                             
       INI-PRO-MKY-DBC.                                                 
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN LOM-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN LOM-FLD.            
       FIN-PRO-MKY-DBC.                                                 
           EXIT.                                                        
                                                                        
      *>>>>                                                             
*% END
*% IF EOF
      *<<<< EOF
       COPY LDCBFCLF
       COPY COLBFOPC.
       COPY LDCBFACL.                                                   
       COPY LDCBFRCL.                                                   
       COPY LDCBFRDC.                                                   
       COPY SGCBFDBC.                                                   
       COPY LDCBFARC.
       COPY LDCBFLCC.
       COPY LDCBFARG.
       COPY LDCBFACG.
       COPY LDCBFRLC.
       COPY LDCBGPRY.                                                   
       COPY LDCBFLDC.                                                   
       COPY TABBFCAM.                                                   
       COPY GNSBGPES.                                                   
       COPY GNSBFCIC.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBPFEC.                                                   
       COPY TABBFCOM.                                                   
       COPY GNSBGSTR.                                                   
       COPY GNSBGCIC.                                                   
       COPY GNSBGCPT.                                                   
      *>>>>                                                             
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       PUT-RDC SECTION.
       INI-PUT-RDC.
           IF DBC-IND-ICLI IN LOM-FLD = 'M'
               GO TO FIN-PUT-RDC.
           MOVE SPACES TO  RDC.
           MOVE ZEROES TO  RDC-VAL-PRDC IN RDC.
           MOVE SPACES TO  RDC-GLS-FLAG IN RDC.
           MOVE 100                     TO RDC-VAL-PRDC IN RDC.
           MOVE SPACES                  TO RDC-COD-RDCF IN RDC.
           MOVE ZEROES                  TO RDC-GLS-DISP IN RDC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RDC-FEC-FTRN IN RDC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RDC-HRA-HRTR IN RDC.

           MOVE DBC-CAI-ICLI IN LOM-FLD TO RDC-CAI-ICLI IN RDC.
           MOVE DBC-IIC-ICLI IN LOM-FLD TO RDC-IIC-ICLI IN RDC.
           MOVE CLF-CAI-ICLF IN LOM-FLD TO RDC-CAI-ICLF IN RDC.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO RDC-IIC-ICLF IN RDC.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-RDC.
           EXIT.

       PUT-ACL SECTION.
       INI-PUT-ACL.
           IF DBC-IND-ICLI IN LOM-FLD = 'M'
               GO TO FIN-PUT-RDC.
           MOVE SPACES TO  ACL-GLS-FLAG IN ACL.
           MOVE SPACES                  TO ACL-GLS-DISP IN ACL.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO ACL-FEC-FTRN IN ACL.
      *    Hora Transaccion
           MOVE HOY-HHOY TO ACL-HRA-HRTR IN ACL.

           MOVE CLF-CAI-ICLF IN LOM-FLD TO ACL-CAI-ICLF IN ACL.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO ACL-IIC-ICLF IN ACL.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-ACL.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
       FIN-BCK-OUT.
           EXIT.

       REL-ENT SECTION.
       INI-REL-ENT.
           MOVE 'N' TO WSS-IND-ERCL IN WSS-VARI.
           MOVE 'N' TO WSS-IND-EDLO IN WSS-VARI.

           MOVE CLF-CAI-ICLF IN LOM-FLD TO RCL-CAI-ICLF IN RCL.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO RCL-IIC-ICLF IN RCL.
           MOVE 'RCL-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-RCL.
           IF FIO-STAT-OKS
              MOVE 'S' TO WSS-IND-ERCL IN WSS-VARI.

           MOVE CLF-CAI-ICLF IN LOM-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              CLF-CAI-ICLF IN LOM-FLD = LDC-CAI-ICLF IN LDC AND
              CLF-IIC-ICLF IN LOM-FLD = LDC-IIC-ICLF IN LDC)
              GO TO FIN-REL-ENT
           ELSE
              MOVE 'S' TO WSS-IND-EDLO IN WSS-VARI.

       FIN-REL-ENT.
           EXIT.

       DEL-ARG SECTION.
       INI-DEL-ARG.
           MOVE SPACES TO ARG-KEY-IARG IN ARG.
           MOVE CLF-KEY-ICLF IN CLF TO ARG-CIC-ICLF IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ARG.
           PERFORM LDC-FIO-ARG.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARG.

           IF NOT ( FIO-STAT-OKS AND
              ARG-CIC-ICLF IN ARG = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-ARG.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ARG.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'ARG    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-ARG.

           MOVE CLF-KEY-ICLF IN CLF TO ARG-CIC-ICLF IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-ARG.
       FIN-DEL-ARG.
           EXIT.

       DEL-RDC SECTION.
       INI-DEL-RDC.
           MOVE SPACES                TO RDC-CIC-ICLI IN RDC.
           MOVE CLF-KEY-ICLF IN CLF   TO RDC-KEY-ICLF IN RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-RDC.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-RDC.

           IF NOT ( FIO-STAT-OKS AND
              RDC-KEY-ICLF IN RDC = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-RDC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
              GO TO FIN-DEL-RDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'RDC    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-RDC.

           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE CLF-KEY-ICLF IN CLF TO RDC-KEY-ICLF IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-RDC.
       FIN-DEL-RDC.
           EXIT.

       DEL-ACG SECTION.
       INI-DEL-ACG.
           MOVE SPACES TO ACG-KEY-IACG IN ACG.
           MOVE CLF-KEY-ICLF IN CLF TO ACG-CIC-ICLF IN ACG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ACG.
           PERFORM LDC-FIO-ACG.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ACG.

           IF NOT ( FIO-STAT-OKS AND
              ACG-CIC-ICLF IN ACG = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-ACG.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ACG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ACG.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ACG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ACG.

           MOVE CLF-KEY-ICLF IN CLF TO ACG-CIC-ICLF IN ACG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-ACG.
       FIN-DEL-ACG.
           EXIT.

       DEL-LCC SECTION.
       INI-DEL-LCC.
           MOVE SPACES              TO LCC-KEY-ILCC IN LCC.
           MOVE CLF-KEY-ICLF IN CLF TO LCC-CIC-ICLF IN LCC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-LCC.
           PERFORM LDC-FIO-LCC.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LCC.

           IF NOT ( FIO-STAT-OKS AND
              CLF-KEY-ICLF IN CLF = LCC-CIC-ICLF IN LCC )
               GO TO FIN-DEL-LCC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-LCC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-LCC.

           MOVE CLF-KEY-ICLF IN CLF TO LCC-CIC-ICLF IN LCC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-LCC.
       FIN-DEL-LCC.
           EXIT.

       DEL-LDC SECTION.
       INI-DEL-LDC.
           MOVE SPACES TO LDC-KEY-ILDC IN LDC.
           MOVE CLF-KEY-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-LDC.
           PERFORM LDC-FIO-LDC.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LDC.

           IF NOT ( FIO-STAT-OKS AND
              CLF-KEY-ICLF IN CLF = LDC-CIC-ICLF IN LDC )
               GO TO FIN-DEL-LDC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-LDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-LDC.

           MOVE CLF-KEY-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-LDC.
       FIN-DEL-LDC.
           EXIT.

       DEL-ACL SECTION.
       INI-DEL-ACL.
           MOVE SPACES              TO ACL-KEY-IACL IN ACL.
           MOVE CLF-KEY-ICLF IN CLF TO ACL-CIC-ICLF IN ACL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ACL.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ACL.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'ACL    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-ACL.

       FIN-DEL-ACL.
           EXIT.

       DEL-ARC SECTION.
       INI-DEL-ARC.
           MOVE SPACES TO ARC-KEY-IARC IN ARC.
           MOVE CLF-KEY-ICLF IN CLF TO ARC-CIC-ICLF IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ARC.
           PERFORM LDC-FIO-ARC.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARC.

           IF NOT ( FIO-STAT-OKS AND
              ARC-CIC-ICLF IN ARC = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-ARC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ARC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ARC.

           MOVE CLF-KEY-ICLF IN CLF TO ARC-CIC-ICLF IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-ARC.
       FIN-DEL-ARC.
           EXIT.

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       COPY LDCBFLMO.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

       BUS-DLO-DEM SECTION.
       INI-BUS-DLO.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE 'N'    TO WSS-IND-MLDC IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-CMAX IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-MUTI IN WSS-VARI.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE WSS-CAI-ICLF IN WSS-VARI TO LDC-CAI-ICLF IN LDC.
           MOVE WSS-IIC-ICLF IN WSS-VARI TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                   TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-DLO-DEM.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              WSS-CAI-ICLF IN WSS-VARI = LDC-CAI-ICLF IN LDC AND
              WSS-IIC-ICLF IN WSS-VARI = LDC-IIC-ICLF IN LDC)
              GO TO FIN-BUS-DLO.
           IF NOT (LDC-MSC-STAT IN LDC = 'D')

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *       GO TO NXT-DLO-DEM
              GO TO NXT-DLO-DEM.
      *     ELSE
      *        MOVE FIO-GET-KEY-UPD TO FIO-CMND
      *        PERFORM LDC-FIO-LDC
      *        MOVE 'R' TO LDC-MSC-STAT IN LDC
      *        MOVE FIO-MOD TO FIO-CMND
      *        PERFORM LDC-FIO-LDC

           MOVE LDC-VAL-CMAX IN LDC TO WSS-SGV-CMAX IN WSS-VARI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           MOVE 'R' TO LDC-MSC-STAT IN LDC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF FIO-STAT-OKS
              PERFORM INI-LMO.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
       NXT-DLO-DEM.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-DLO-DEM.
       FIN-BUS-DLO.
           EXIT.

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       INI-LMO SECTION.
       INI-INI-LMO.

           PERFORM ACT-FEC-FREC.
           MOVE ZEROES TO WSS-VAL-MORI IN WSS-VARI.

           COMPUTE WSS-VAL-MORI IN WSS-VARI = WSS-SGV-CMAX -
                   WSS-SGV-MUTI.

           MOVE SPACES TO LMO-GLS-FLAG IN LMO.
           MOVE SPACES TO LMO-FEC-FMOV IN LMO.
           MOVE SPACES TO LMO-HRA-HMOV IN LMO.
           MOVE SPACES TO LMO-CAI-ICLF IN LMO.
           MOVE SPACES TO LMO-IIC-ICLF IN LMO.
           MOVE ZEROES TO LMO-NUM-ILDC IN LMO.
           MOVE ZEROES TO LMO-STP-ITRN IN LMO.
           MOVE SPACES TO LMO-MSC-TACC IN LMO.
           MOVE SPACES TO LMO-MSC-STAT IN LMO.
           MOVE SPACES TO LMO-COD-OTRN IN LMO.
           MOVE SPACES TO LMO-COD-TIPO IN LMO.
           MOVE SPACES TO LMO-COD-VCLC IN LMO.
           MOVE ZEROES TO LMO-VAL-MORI IN LMO.
           MOVE ZEROES TO LMO-VAL-MPES IN LMO.
           MOVE SPACES TO LMO-CAI-IOPC IN LMO.
           MOVE SPACES TO LMO-IIC-IOPC IN LMO.
           MOVE SPACES TO LMO-COD-CLVA IN LMO.
           MOVE SPACES TO LMO-GLS-CMPA IN LMO.
           MOVE ZEROES TO LMO-SGV-CMPA IN LMO.
           MOVE SPACES TO LMO-COD-NCLV IN LMO.
           MOVE SPACES TO LMO-GLS-NCMP IN LMO.
           MOVE ZEROES TO LMO-SGV-NCMP IN LMO.
           MOVE SPACES TO LMO-COD-OFMV IN LMO.
           MOVE ZEROES TO LMO-FEC-FING IN LMO.
           MOVE SPACES TO LMO-GLS-DISP IN LMO.

           PERFORM GET-FHOY.
           MOVE HOY-FHOY                 TO LMO-FEC-FMOV IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HMOV IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FING IN LMO.
           MOVE LDC-CAI-ICLF IN LDC      TO LMO-CAI-ICLF IN LMO.
           MOVE LDC-IIC-ICLF IN LDC      TO LMO-IIC-ICLF IN LMO.
           MOVE LDC-NUM-ILDC IN LDC      TO LMO-NUM-ILDC IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FTRN IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HRTR IN LMO.
           MOVE 'LDCPULOM'               TO LMO-COD-ATRN IN LMO.
           MOVE 1                        TO LMO-NUM-IMOV IN LMO.
           MOVE SCR-USER                 TO LMO-CIC-UING IN LMO.
           MOVE SCR-OTRN                 TO LMO-COD-OTRN IN LMO.
           MOVE WSS-SGV-MTO2 IN WSS-VARI TO LMO-VAL-MPES IN LMO.
           MOVE WSS-VAL-MORI IN WSS-VARI TO LMO-VAL-MORI IN LMO.
           MOVE WSS-COD-OFIC IN WSS-VARI TO LMO-COD-OFMV IN LMO.
           MOVE LDC-COD-TIPO IN LDC      TO LMO-COD-TIPO IN LMO.
           MOVE LDC-COD-VCLC IN LDC      TO LMO-COD-VCLC IN LMO.
           MOVE 'TER'                    TO LMO-COD-ECTB IN LMO.
           IF HOY-HHOY > 075959 AND HOY-HHOY < 140000
              MOVE 'M'                   TO LMO-IND-MODO IN LMO
           ELSE
              MOVE 'T'                   TO LMO-IND-MODO IN LMO.
           MOVE WSS-COD-TOOC IN WSS-VARI TO LMO-COD-TOOC IN LMO.
           MOVE WSS-COD-AOOC IN WSS-VARI TO LMO-COD-AOOC IN LMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-LMO.

           MOVE LDC-CIC-ICLF IN LDC TO LCC-CIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-INI-LMO.

           MOVE WSS-SGV-MTO2 IN WSS-VARI TO
               LCC-VAL-MTO1 IN LCC
           MOVE ZEROES                   TO
               LCC-VAL-MTO2 IN LCC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
       FIN-INI-LMO.
           EXIT.

       ACT-FEC-FREC SECTION.
       INI-ACT-FEC-FREC.
           MOVE LDC-CAI-ICLF IN LDC TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
              GO TO FIN-ACT-FEC-FREC
           ELSE
              MOVE LCC-VAL-MUTI IN LCC TO WSS-SGV-MUTI IN WSS-VARI
              MOVE LCC-VAL-MTO2 IN LCC TO WSS-SGV-MTO2 IN WSS-VARI
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM LDC-FIO-LCC
              IF FIO-STAT-OKS
                 MOVE HOY-SHOY TO LCC-NUM-SREC IN LCC
                 MOVE HOY-AHOY TO LCC-NUM-AREC IN LCC
                 MOVE HOY-MHOY TO LCC-NUM-MREC IN LCC
                 MOVE HOY-DHOY TO LCC-NUM-DREC IN LCC
                 MOVE FIO-MOD TO FIO-CMND
                 PERFORM LDC-FIO-LCC.
       FIN-ACT-FEC-FREC.
           EXIT.

      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
      *>>>>                                                             
*% END
