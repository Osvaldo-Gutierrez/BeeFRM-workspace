*% FRM = 'GSE'
*% REG = 'GSE'
*% VSNBQ = "06.06.29"
*% FNCBQ = "OWFBGL"
*% VSNBU = "06.06.29"
*% FNCBU = "OWFBGL"
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF CMT_ID
*% IF PGM_BU
      *-----------------------------------------------------------------
      *PROYECTO: VALIDACION PANTALLA GSE
      *OBJETIVO: VALIDAR MONTO SEGURO V/S GVT Y SOLO FVEN PARA MOD
      *FECHA   : JUN-2016
      *AUTOR   : AFRI
      *ETIQUETA: AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
      *-----------------------------------------------------------------
      *-----------------------------------------------------------------
      *  Autor     : BEE-MPB
      *  Fecha     : 16-10-2018
      *  NUB       : 54009
      *  Proyecto  : CORRECCION PANTALLA GSE
      *  ID        : MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE
      *  Cambios   : CORREGIR CONVERSION DE MONEDA DE VALOR SEGURO
      *              DEJAR CONVERSION Y VALIDACION EN BASE A TABLA PVT
      *----------------------------------------------------------------
*% END
*% END
*% IF GSE_CAI_GTIA
      *<<<< GSE_CAI_GTIA
              IF GSE-CAI-GTIA IN GSE-FLD NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-GSE-CAI-GTIA.
      *>>>>
*% END
*% IF INI_VAL_FLD_GSE
      *<<<< INI_VAL_FLD_GSE
      *AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
            IF SCR-CMND = WSE-GLS-CMOD
                MOVE GSE-CAI-GTIA IN GSE-FLD TO GDG-CAI-GTIA IN GDG
                MOVE GSE-IIC-GTIA IN GSE-FLD TO GDG-IIC-GTIA IN GDG
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM BGL-FIO-GDG
                IF FIO-STAT-OKS AND
                   GDG-IND-EST1 IN GDG > WSE-GLS-NU09 AND
                   GDG-IND-EST1 IN GDG < WSE-GLS-NU20
                    PERFORM VAL-GSE-FEC-FVTS
                     IF FRM-SUAR = FRM-SUAR-MAL OR
                        FRM-SUAR = FRM-SUAR-CLR
                         MOVE FRM-IND-ERRO TO
                              GSE-FEC-FVTS-LEN IN GSE-FLD
                         GO TO FIN-VAL-FLD-GSE
                     ELSE
                         GO TO FIN-VAL-FLD-GSE.
      *AFRI-FIN /062016  VALIDACION MONTO SEGURO / CMN-MOD
      *>>>>
*% END
*% IF FIN_PUT_GSE_GSE
      *<<<< FIN_PUT_GSE_GSE
      *MHM-INI 29-OCT-2003
           MOVE GSE-CIC-UING IN GSE TO CMA-CIC-UING IN CMA-VARI.
      * EVA-INI  11/08                                                  
           PERFORM LEE-GDG.                                             
           IF WSS-IND-GTIA IN WSS-VARI = WSS-N                            
              GO TO FIN-PUT-GSE-GSE.                                    
      * EVA-FIN  11/08                                                  
      *MHM-FIN 29-OCT-2003
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-CGTA IN GSE-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'AUX'                   TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-CGTA IN GDG     TO WSS-TIP-CGTA IN WSS-VARI
               MOVE GDG-STP-CGTA IN GDG     TO WSS-STP-CGTA IN WSS-VARI
               MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-CGTA IN GSE-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GSE-FLD.
               MOVE TAB-COD-DAT1 IN TAB-GLS-DAT1(2)                     
                                        TO CMA-IND-APLI IN CMA-VARI     
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

      *PVG INI 15-OCT-2003 VALIDACION INDICADOR UCG                     
           IF SCR-CMND = 'CON' AND                                      
              TAB-COD-DAT1 IN TAB(2) = WSS-A                              
              MOVE 'S' TO WSS-IND-AREN IN WSS-VARI.                     
                                                                        
      *PVG FIN 15-OCT-2003                                              
           IF GDG-TIP-CGTA IN GDG > SPACES                              
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GSE-FLD.
      *MHM-FIN 23-OCT-2003
*% IF GEN_BCI
      *<<<< GEN_BCI
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-ICCS IN GSE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'CSE ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-ICCS IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ICCS IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ICCS IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-CORS IN GSE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'SEG ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-CORS IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CORS IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD.

      *PVG INI 14-OCT-2003
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-ESTA IN GSE-FLD > SPACES
               MOVE 'BGL'                   TO TAB-COD-SIST
               MOVE 'ESS '                  TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-ESTA IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-ESTA IN GSE-FLD
           ELSE
               MOVE SPACES                  TO FRM-GLS-ESTA IN GSE-FLD.
      *PVG FIN 14-OCT-2003
      *MHM-INI 7-OCT-2003
           IF SCR-CMND NOT = 'CON'
               GO TO CNT-PUT-GSE-GSE.
           PERFORM GET-FHOY. 
      *PVG FIN 15-OCT-2003

           MOVE GSE-NUM-SVTS IN GSE-FLD TO WSS-NUM-SVTS IN WSS-VARI.
           MOVE GSE-NUM-AVTS IN GSE-FLD TO WSS-NUM-AVTS IN WSS-VARI.
           MOVE GSE-NUM-MVTS IN GSE-FLD TO WSS-NUM-MVTS IN WSS-VARI.
           MOVE GSE-NUM-DVTS IN GSE-FLD TO WSS-NUM-DVTS IN WSS-VARI.
      *PVG INI 15-OCT-2003                                              
                                                                        
      *    IF WSS-IND-AREN IN WSS-VARI NOT = 'S' OR                     
      *       GDG-IND-EST1 IN GDG > '19' OR                             
      *       GDG-IND-EST1 IN GDG < '10'                                
      *       MOVE 'NO APLICA RENOVAR' TO FRM-GLS-ESTD IN GSE-FLD       
      *       GO TO CNT-PUT-GSE-GSE.                                    
      *EVA-AFRI **                                                      
      *    IF WSS-IND-AREN IN WSS-VARI = 'S' AND                        
      *       GDG-IND-EST1 IN GDG > '09' AND                            
      *       GDG-IND-EST1 IN GDG < '20' AND                            
      *       WSS-IND-RNOV NOT = 'N'                                    
      *       MOVE 'APLICA RENOVAR' TO FRM-GLS-ESTD IN GSE-FLD          
      *       GO TO CNT-PUT-GSE-GSE.                                    
      *EVA-AFRI **                                                      
                                                                        
      *    IF WSS-FEC-FVTS IN WSS-VARI > HOY-FHOY                       
      *        MOVE 'AL DIA' TO FRM-GLS-ESTD IN GSE-FLD                 
      *        GO TO CNT-PUT-GSE-GSE.                                   
                                                                        
      *    IF GDG-IND-ECRS IN GDG = 'S'                                 
      *        MOVE 'VENCIDA CON EXCEPCION COMERCIAL'                   
      *                                     TO FRM-GLS-ESTD IN GSE-FLD  
      *        GO TO CNT-PUT-GSE-GSE.                                   
                                                                        
      *    PERFORM EXC-NOR-SEG.                                         
      *    IF WSS-IND-ENS1 = 'S'                                        
      *       MOVE 'VENCIDA EXCP.NORMATIVA, AMPARA CREDITOS VIGENTES'   
      *                                     TO FRM-GLS-ESTD IN GSE-FLD  
      *    ELSE                                                         
      *    IF WSS-IND-ENS2 NOT = 'S'                                    
      *       MOVE 'VENCIDA EXCP.NORMATIVA, LINEAS DE CREDITOS VIGENTES'
      *                                     TO FRM-GLS-ESTD IN GSE-FLD  
      *    ELSE                                                         
      *JRF-INI 20-OCT-2003                                              
      *       MOVE 'SEGURO VENCIDO, NO ES NECESARIO RENOVAR            '
      *JRF-FIN 20-OCT-2003                                              
      *                                     TO FRM-GLS-ESTD IN GSE-FLD. 
      * EVA-INI  08/07                                                  
      *    PERFORM LEE-GDG.                                             
      *    PERFORM BUS-RNOV.                                            
      *    IF WSS-IND-RNOV = 'S' AND                                    
      *       WSS-IND-RSEG = 'S' AND                                    
      *       WSS-FEC-FVTS IN WSS-VARI < HOY-FHOY                       
      *       MOVE 'SEGURO VENCIDO, DEBE RENOVAR' TO                    
      *            FRM-GLS-ESTD IN GSE-FLD.                             
                                                                        
      *    IF WSS-IND-RNOV = 'S' AND                                    
      *       WSS-IND-RSEG = 'N' AND                                    
      *       WSS-FEC-FVTS IN WSS-VARI < HOY-FHOY                       
      *       MOVE 'SEGURO VIGENTE EN CURSE' TO                         
      *            FRM-GLS-ESTD IN GSE-FLD.                             
                                                                        
      *    IF WSS-IND-ASEG = 'N' OR                                     
      *       GDG-FEC-FVES IN GDG > HOY-FHOY                            
      *       MOVE 'NO APLICA RENOVAR' TO FRM-GLS-ESTD IN GSE-FLD.      
                                                                        
      *    IF WSS-FEC-FVTS IN WSS-VARI > HOY-FHOY AND                   
      *       WSS-IND-RNOV = 'N'                                        
      *        MOVE 'AL DIA' TO FRM-GLS-ESTD IN GSE-FLD.                
                                                                        
           PERFORM BUS-RNOV.                                            
           IF WSS-IND-GTAC IN WSS-VARI = WSS-N OR                         
              WSS-IND-ARNV IN WSS-VARI = WSS-N                            
      *PVC-INI 28-FEB-2012                                              
      *       MOVE 'NO APLICA RENOVAR' TO FRM-GLS-ESTD IN GSE-FLD       
              MOVE 'BGL'        TO FIO-SIST                             
              MOVE 'MSG'        TO TAB-COD-TTAB IN TAB                  
              MOVE 'NOREN'      TO TAB-COD-CTAB IN TAB                  
              MOVE FIO-GET-KEY  TO FIO-CMND                             
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S             
                  MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESTD IN GSE-FLD   
                  GO TO CNT-PUT-GSE-GSE                                 
              ELSE
                  MOVE 'NOREN'  TO FRM-GLS-ESTD IN GSE-FLD              
      *PVC-FIN 28-FEB-2012                                              
                  GO TO CNT-PUT-GSE-GSE.                                

           IF WSS-IND-GDIA IN WSS-VARI = WSS-S                            
      *PVC-INI 28-FEB-2012                                              
      *       MOVE 'AL DIA' TO FRM-GLS-ESTD IN GSE-FLD
              MOVE 'BGL'        TO FIO-SIST                             
              MOVE 'MSG'        TO TAB-COD-TTAB IN TAB                  
              MOVE 'ALDIA'      TO TAB-COD-CTAB IN TAB                  
              MOVE FIO-GET-KEY  TO FIO-CMND                             
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S             
                  MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESTD IN GSE-FLD   
                  GO TO CNT-PUT-GSE-GSE                                 
              ELSE
                  MOVE 'ALDIA' TO FRM-GLS-ESTD IN GSE-FLD               
      *PVC-FIN 28-FEB-2012                                              
              GO TO CNT-PUT-GSE-GSE.                                    
                                                                        
           IF WSS-IND-ECRS IN WSS-VARI = WSS-S                            
      *PVC-INI 28-FEB-2012                                              
      *       MOVE 'VENCIDO CON EXCEPCION COMERCIAL' TO                 
      *                                FRM-GLS-ESTD IN GSE-FLD          
              MOVE 'BGL'        TO FIO-SIST                             
              MOVE 'MSG'        TO TAB-COD-TTAB IN TAB                  
              MOVE 'VENEXCCOM'  TO TAB-COD-CTAB IN TAB                  
              MOVE FIO-GET-KEY  TO FIO-CMND                             
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S             
                  MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESTD IN GSE-FLD   
                  GO TO CNT-PUT-GSE-GSE                                 
              ELSE
                  MOVE 'VENEXCCOM' TO FRM-GLS-ESTD IN GSE-FLD           
      *PVC-FIN 28-FEB-2012                                              
              GO TO CNT-PUT-GSE-GSE.                                    
                                                                        
           IF WSS-IND-RSEG IN WSS-VARI = WSS-S                            
      *PVC-INI 28-FEB-2012                                              
      *       MOVE 'SEGURO VIGENTE EN CURSE' TO                         
      *             FRM-GLS-ESTD IN GSE-FLD
              MOVE 'BGL'        TO FIO-SIST                             
              MOVE 'MSG'        TO TAB-COD-TTAB IN TAB                  
              MOVE 'SEGVIGCUR'  TO TAB-COD-CTAB IN TAB                  
              MOVE FIO-GET-KEY  TO FIO-CMND                             
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S             
                  MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESTD IN GSE-FLD   
                  GO TO CNT-PUT-GSE-GSE                                 
              ELSE
                  MOVE 'SEGVIGCUR' TO FRM-GLS-ESTD IN GSE-FLD           
      *PVC-FIN 28-FEB-2012                                              
              GO TO CNT-PUT-GSE-GSE.                                    
                                                                        
           IF WSS-IND-RNOV IN WSS-VARI = WSS-S                            
      *PVC-INI 28-FEB-2012                                              
      *       MOVE 'SEGURO VENCIDO, DEBE RENOVAR' TO                    
      *             FRM-GLS-ESTD IN GSE-FLD.                            
              MOVE 'BGL'        TO FIO-SIST                             
              MOVE 'MSG'        TO TAB-COD-TTAB IN TAB                  
              MOVE 'SEGVENREN'  TO TAB-COD-CTAB IN TAB                  
              MOVE FIO-GET-KEY  TO FIO-CMND                             
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S             
                  MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESTD IN GSE-FLD   
                  GO TO CNT-PUT-GSE-GSE                                 
              ELSE
                  MOVE 'SEGVENREN' TO FRM-GLS-ESTD IN GSE-FLD           
                  GO TO CNT-PUT-GSE-GSE.                                
                                                                        
           IF WSS-IND-REPA IN WSS-VARI = WSS-S                            
              MOVE 'BGL'        TO FIO-SIST                             
              MOVE 'MSG'        TO TAB-COD-TTAB IN TAB                  
              MOVE 'REPARO'     TO TAB-COD-CTAB IN TAB                  
              MOVE FIO-GET-KEY  TO FIO-CMND                             
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S             
                  MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESTD IN GSE-FLD   
              ELSE
                  MOVE 'REPARO' TO FRM-GLS-ESTD IN GSE-FLD.             
      *PVC-FIN 28-FEB-2012                                              
                                                                        
       CNT-PUT-GSE-GSE.
      * EVA-FIN  08/07                                                  
                                                                        
      * EVA-FIN  11/08                                                  
                                                                        
      *MHM-FIN 7-OCT-2003
      *>>>>
*% ELSE
           IF GSE-COD-ICCS IN GSE-FLD > SPACES
               MOVE 'CSE'                    TO IVB-COD-TTAB IN IVB
               MOVE GSE-COD-ICCS IN GSE-FLD  TO IVB-COD-EIVB IN IVB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-IVB
               IF NOT FIO-STAT-OKS
                   MOVE 'CODICCSNEX' TO MSG-COD-MENS
                   MOVE 'BGL' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-GLS-ICCS IN GSE-FLD
               ELSE
                   MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-ICCS IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ICCS IN GSE-FLD.

           IF GSE-COD-CORS IN GSE-FLD > SPACES
               MOVE 'SEG'                    TO IVB-COD-TTAB IN IVB
               MOVE GSE-COD-CORS IN GSE-FLD  TO IVB-COD-EIVB IN IVB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-IVB
               IF NOT FIO-STAT-OKS
                   MOVE 'CODCORSNEX' TO MSG-COD-MENS
                   MOVE 'BGL' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-GLS-CORS IN GSE-FLD
               ELSE
                   MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-CORS IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD.

*% END
      *>>>>
*% END
*% IF FIN_UNP_IKY_GSE 
      *<<<< FIN_UNP_IKY_GSE 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GSE-NUM-IGSE-ATR IN GSE-FLD
               MOVE FRM-CPIM-AEY TO GSE-NUM-IGSE-STP.
      *RRM-FIN 16-APR-2002
      *>>>>
*% END
*% IF FIN_GSE_FEC_FVSG AND NOT PGM_MCP
      *<<<< FIN_GSE_FEC_VIG_SEG
            IF GSE-FEC-FVSG IN GSE-FLD  NOT > SPACES
              MOVE ZEROES TO GSE-FEC-FVSG IN GSE-FLD.
      *VAL-FEC Validar Fecha
           MOVE GSE-FEC-FVSG IN GSE-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
              MOVE FEC-CHOY-N TO FEC-CHOY.                              
      *AFRI-FIN/JUL2005
           PERFORM PRO-FEC.
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
               IF FEC-STAT-FER                                          
                   MOVE FEC-FORM-FEC TO FEC-FORM                        
                   MOVE FEC-FBLK-N  TO FEC-FBLK
                   MOVE FEC-CHOY-N  TO FEC-CHOY                         
                   MOVE FEC-SIG-HBL TO FEC-CMND
                   PERFORM CAL-FEC                                      
                   MOVE  '00' TO FEC-STAT.                              
      *AFRI-FIN/JUL2005
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GSE-FEC-FVSG IN GSE-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GSE-FEC-FVSG.
      *
      *>>>>
*% END
*% IF FIN_PUT_GDG_GSE
      *<<<< FIN_PUT_GDG_GSE

           MOVE GDG-CAI-GTIA IN GDG TO GVT-CAI-GTIA IN GVT.
           MOVE GDG-IIC-GTIA IN GDG TO GVT-IIC-GTIA IN GVT.
           MOVE GDG-COD-TSCN IN GDG TO GVT-COD-TASN IN GVT.

           MOVE 'GVT-KEY-IGVT'  TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GVT.
           MOVE FIO-STAT TO PGM-STAT-GVT IN CMA-VARI.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO GAR-SGV-VPND IN CMA-VARI
               GO TO EXA-VEN-SEG.

           MOVE GVT-SGV-VPND IN GVT TO GAR-SGV-VPND IN CMA-VARI.
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE GVT-SGV-LTSN IN GVT TO GAR-SGV-LTSN IN CMA-VARI.
      *>>>>
*% END
      * Se determina si la tasacion esta vencida o no

*% FIN_EXA_VTO_TAS = 'EXA-VEN-SEG'
*% FEC_FVTA = 'WSS-FEC-FVTA'
*% FEC_DVTA = 'WSS-FEC-DVTA'
*% FEC_MVTA = 'WSS-FEC-MVTA'
*% FEC_AVTA = 'WSS-FEC-AVTA'
*% FEC_SVTA = 'WSS-FEC-SVTA'
*% FEC_FCTA = 'HOY-FHOY'
*% LEE_HOY = TRUE
*%! * Se determina si la tasacion esta vencida o no

           MOVE WSS-NO-EXA-VENC TO WSS-IND-EXAV.
      * Excluye los Subtipos de Garantia que no requieren Tasacion Efect
           IF TAG-NUM-PVTS IN TAG NOT > ZEROES
               GO TO EXA-VEN-SEG.

      * Excluye los Creditos Hipotecarios
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.
           MOVE ZEROES              TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GES.
           IF NOT FIO-STAT-OKS OR
              GDG-CAI-GTIA IN GDG NOT = GES-CAI-GTIA IN GES OR
              GDG-IIC-GTIA IN GDG NOT = GES-IIC-GTIA IN GES
               MOVE SPACES TO GES
               MOVE ZEROES TO GES-IIC-GTIA IN GES
                              GES-FEC-FVCR IN GES
                              GES-NUM-IGES IN GES
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM BGL-FIO-GES
               ELSE
                   NEXT SENTENCE
           ELSE 
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM BGL-FIO-GES
               IF GES-COD-SIST IN GES > SPACES
                   MOVE 'TAB'                  TO TAB-COD-SIST
                   MOVE 'SIS'                  TO TAB-COD-TTAB IN TAB
                   MOVE GES-COD-SIST IN GES TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS = SPACES AND TAB-CIC-CTAB = 'HIP'
                       GO TO EXA-VEN-SEG.

           MOVE WSS-SI-EXA-VENC TO WSS-IND-EXAV.
           PERFORM GET-FHOY.

           IF TAG-COD-TPVT IN TAG = 'D'
              MOVE FEC-SUM-DIA TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NDIA
           ELSE
           IF TAG-COD-TPVT IN TAG = WSS-M
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NMES
           ELSE
           IF TAG-COD-TPVT IN TAG = WSS-A
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NANO.

           MOVE GVT-FEC-FTSN IN GVT TO FEC-FVLD.
           MOVE FEC-DVLD TO FEC-ITM1.
           MOVE FEC-MVLD TO FEC-ITM2.
           MOVE FEC-AVLD TO FEC-ITM4.
           MOVE FEC-SVLD TO FEC-ITM3.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF MSG-COD-MENS = SPACES
               MOVE FEC-ITM1 TO WSS-FEC-DVTA IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-FEC-MVTA IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-FEC-AVTA IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-FEC-SVTA IN WSS-VARI
           ELSE
               GO TO EXA-VEN-SEG.

      * Tasacion Vencida
           IF WSS-FEC-FVTA IN WSS-VARI > HOY-FHOY
               GO TO EXA-VEN-SEG.

      *JRF INI 20-OCT-2003
      *     MOVE 'BGL' TO MSG-COD-SIST.
      *     MOVE 'FECTSN<HOY' TO MSG-COD-MENS.
      *     PERFORM GET-MSG.
      *     MOVE MSG-GLS-DESC TO FRM-MEN1.
      *JRF FIN 20-OCT-20003
       EXA-VEN-SEG.
      *
      * Se determina si el seguro esta vencido o no
*% FIN_EXA_VTO_SEG = 'FIN-EXA-VEN-SEG'
*% LEE_GSE = FALSE
*% PGM_GSE = TRUE
*% FEC_FCSE = 'HOY-FHOY'
      * Excluye los Creditos Hipotecarios
           IF WSS-IND-EXAV = WSS-NO-EXA-VENC 
               GO TO FIN-EXA-VEN-SEG.

      * Seguro Vigente
           IF SCR-CCPP = 'ING'
               GO TO FIN-EXA-VEN-SEG.

           IF GSE-FEC-FVTS IN GSE > HOY-FHOY
               GO TO FIN-EXA-VEN-SEG.

      *PVG INI 15-OCT-2003 Segun JRF
      *    MOVE 'BGL' TO MSG-COD-SIST.
      *    MOVE 'FECSEG<HOY' TO MSG-COD-MENS.
      *    PERFORM GET-MSG.
      *    MOVE MSG-GLS-DESC TO FRM-MEN2.
      *PVG FIN 15-OCT-20003

       FIN-EXA-VEN-SEG.

      *>>>>
*% END
*% IF FIN_PUT_TAG_GSE
      *<<<< FIN_PUT_TAG_GSE
      *PVG INI 14-OCT-2003
           IF TAG-COD-TPOL IN TAG > SPACES
              MOVE 'BGL'               TO TAB-COD-SIST
              MOVE 'POL'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-TPOL IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TPOL IN GSE-FLD
              ELSE
                 MOVE SPACES              TO FRM-GLS-TPOL IN GSE-FLD.
      *PVG FIN 14-OCT-2003
      *>>>>
*% END
*% IF GSE_SGV_SEGU
      *<<<<AFRI-INI/24-05-2006                                          
           IF NOT (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')                
               GO TO SIG-VAL-GSE-SGV-SEGU.
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-VAL-GSE-SGV-SEGU.                              
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GVT-CAI-GTIA IN GVT.
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GVT-IIC-GTIA IN GVT.         
           MOVE 999                     TO GVT-COD-TASN IN GVT.         
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM BGL-FIO-GVT.                                         
           IF NOT (FIO-STAT-OKS AND
            GSE-CAI-GTIA IN GSE-FLD = GVT-CAI-GTIA IN GVT AND           
            GSE-IIC-GTIA IN GSE-FLD = GVT-IIC-GTIA IN GVT)              
               GO TO FIN-VAL-GSE-SGV-SEGU.                              
           IF GDG-COD-VCAM IN GDG = GSE-COD-VCMS IN GSE-FLD             
              MOVE GVT-SGV-VCTS IN GVT TO WSS-VAR-VCTS IN WSS-VARI
              MOVE GVT-SGV-VSIN IN GVT TO WSS-VAR-VSIN IN WSS-VARI      
              MOVE GSE-SGV-SEGU IN GSE-FLD TO WSS-VAR-SEGU IN WSS-VARI  
              GO TO CON-VAL-GSE-SGV-SEGU.                               
      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE              
      *CONVERSION                                                       
      *     IF NOT GSE-COD-VCMS IN GSE-FLD = '0998  '                   
      *       MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1)   
      *       MOVE GSE-COD-VCMS IN GSE-FLD  TO CAM-COD-VCAM IN CAM(2)   
      *       MOVE GSE-NUM-DVSG IN GSE-FLD  TO CAM-NUM-DCAM IN CAM(1)   
      *       MOVE GSE-NUM-MVSG IN GSE-FLD  TO CAM-NUM-MCAM IN CAM(1)   
      *       MOVE GSE-NUM-SVSG IN GSE-FLD  TO CAM-NUM-SCAM IN CAM(1)   
      *       MOVE GSE-NUM-AVSG IN GSE-FLD  TO CAM-NUM-ACAM IN CAM(1)   
      *       MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)   
      *       MOVE FIO-GET-KEY TO FIO-CMND                              
      *       PERFORM TAB-FIO-CAM                                       
      *       IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')              
      *         MOVE 'BGL'        TO MSG-COD-SIST                       
      *         MOVE 'T/VIGE=N'   TO MSG-COD-MENS                       
      *         PERFORM GET-MSG                                         
      *         MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD            
      *         MOVE MSG-GLS-DESC TO FRM-MENS                           
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR                           
      *         GO TO FIN-VAL-GSE-SGV-SEGU                              
      *       ELSE                                                      
      *         COMPUTE WSS-VAR-SEGU IN WSS-VARI ROUNDED =              
      *         (GSE-SGV-SEGU IN GSE-FLD/CAM-SGV-VCAM IN CAM)           
      *         GO TO IRA-VAL-GSE-SGV-SEGU.                             

      *CONVERSION MULTIMONEDA 1                                         
      *SI MONEDA DE GSE Y GDG ES LA MISMA NO HAY CONVERSION
      *SI MONEDA NO ES IGUAL SE LLEVA DESDE MONEDA GSE A MONEDA DE GDG
      *    Otra Moneda 
           MOVE GSE-NUM-SVSG IN GSE-FLD TO NVC-SCAM.
           MOVE GSE-NUM-AVSG IN GSE-FLD TO NVC-ACAM.
           MOVE GSE-NUM-MVSG IN GSE-FLD TO NVC-MCAM.
           MOVE GSE-NUM-DVSG IN GSE-FLD TO NVC-DCAM.
           MOVE GSE-SGV-SEGU IN GSE-FLD TO NVC-VALO.
           MOVE GSE-COD-VCMS IN GSE-FLD TO NVC-MON1.           
           MOVE GDG-COD-VCAM IN GDG     TO NVC-MON2.
           MOVE WSS-4                   TO NVC-NUM-DECI.
           MOVE WSS-C                   TO NVC-IND-ACCI.

           PERFORM PRO-NVC-NCD.
           IF NVC-CMSG > SPACES
               MOVE 'BGL'        TO MSG-COD-SIST      
               MOVE 'CAM    NEX' TO MSG-COD-MENS   
               PERFORM GET-MSG                        
               MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS          
               MOVE FRM-SUAR-MAL TO FRM-SUAR          
               GO TO FIN-VAL-GSE-SGV-SEGU             
           ELSE                              
               MOVE NVC-RESU TO WSS-VAR-SEGU IN WSS-VARI.   

      *MPB-FIN                 
              
       IRA-VAL-GSE-SGV-SEGU.                                            
           MOVE GVT-SGV-VCTS IN GVT TO WSS-VAR-VCTS IN WSS-VARI.        
           MOVE GVT-SGV-VSIN IN GVT TO WSS-VAR-VSIN IN WSS-VARI.
           
      *FIN CONVERSION                                                   
      
       CON-VAL-GSE-SGV-SEGU.                  
      *AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
      *    IF WSS-VAR-SEGU IN WSS-VARI > WSS-VAR-VSIN IN WSS-VARI
           IF WSS-VAR-SEGU IN WSS-VARI < WSS-VAR-VSIN IN WSS-VARI
      *AFRI-FIN /062016  VALIDACION MONTO SEGURO / CMN-MOD
              MOVE 'BGL'        TO MSG-COD-SIST
      *AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
      *       MOVE 'VSEG>VSIN'  TO MSG-COD-MENS
              MOVE 'VSEG<VSIN'  TO MSG-COD-MENS
      *AFRI-FIN /062016  VALIDACION MONTO SEGURO / CMN-MOD
              PERFORM GET-MSG
              MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
             GO TO FIN-VAL-GSE-SGV-SEGU.
       SIG-VAL-GSE-SGV-SEGU.                                            
      *>>>>AFRI-FIN/24-05-2006                                          
      * EVA-AFRI/MAY2006                                                
           IF NOT (SCR-CMND = 'MOD' OR SCR-CMND = 'ING')                
              GO TO BUS-SIG-REG.
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           IF NOT FIO-STAT-OKS
               GO TO FIN-VAL-GSE-SGV-SEGU.                              
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GVT-CAI-GTIA IN GVT.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GVT-IIC-GTIA IN GVT.         
           MOVE 999                     TO GVT-COD-TASN IN GVT.         
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM BGL-FIO-GVT.                                         
           IF NOT (FIO-STAT-OKS AND                                     
            GSE-CAI-GTIA IN GSE-FLD = GVT-CAI-GTIA IN GVT AND           
            GSE-IIC-GTIA IN GSE-FLD = GVT-IIC-GTIA IN GVT)              
               GO TO FIN-VAL-GSE-SGV-SEGU.
           IF GDG-COD-VCAM IN GDG = GSE-COD-VCMS IN GSE-FLD             
              MOVE GVT-SGV-VCTS IN GVT TO WSS-NUM-VCTS IN WSS-VARI      
              MOVE GVT-SGV-VSIN IN GVT TO WSS-NUM-VSIN IN WSS-VARI      
              MOVE GSE-SGV-SEGU IN GSE-FLD TO WSS-NUM-SEGU IN WSS-VARI  
              GO TO CNT-VAL-GSE-SGV-SEGU.
      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE                     
      *CONVERSION                                                       
      *     IF NOT GSE-COD-VCMS IN GSE-FLD = '0998  '                   
      *       MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1)   
      *       MOVE GSE-COD-VCMS IN GSE-FLD  TO CAM-COD-VCAM IN CAM(2)   
      *       MOVE GSE-NUM-DVSG IN GSE-FLD  TO CAM-NUM-DCAM IN CAM(1)   
      *       MOVE GSE-NUM-MVSG IN GSE-FLD  TO CAM-NUM-MCAM IN CAM(1)   
      *       MOVE GSE-NUM-SVSG IN GSE-FLD  TO CAM-NUM-SCAM IN CAM(1)   
      *       MOVE GSE-NUM-AVSG IN GSE-FLD  TO CAM-NUM-ACAM IN CAM(1)   
      *       MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)   
      *       MOVE FIO-GET-KEY TO FIO-CMND                              
      *       PERFORM TAB-FIO-CAM                                       
      *       IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')              
      *         MOVE 'BGL'        TO MSG-COD-SIST                       
      *         MOVE 'T/VIGE=N'   TO MSG-COD-MENS                       
      *         PERFORM GET-MSG                                         
      *         MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD            
      *         MOVE MSG-GLS-DESC TO FRM-MENS                           
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR                           
      *         GO TO FIN-VAL-GSE-SGV-SEGU                              
      *       ELSE                                                      
      *         COMPUTE WSS-NUM-SEGU IN WSS-VARI ROUNDED =              
      *         (GSE-SGV-SEGU IN GSE-FLD/CAM-SGV-VCAM IN CAM)           
      *         GO TO CNT-VAL-GSE-SGV-SEGU.                             
      *     MOVE GSE-SGV-SEGU IN GSE-FLD TO WSS-NUM-SEGU IN WSS-VARI.   
           

      *CONVERSION MULTIMONEDA 2                                          
      *SI MONEDA DE GSE Y GDG ES LA MISMA NO HAY CONVERSION
      *SI MONEDA NO ES IGUAL SE LLEVA DESDE MONEDA GSE A MONEDA DE GDG
      *    Otra Moneda 
           MOVE GSE-NUM-SVSG IN GSE-FLD TO NVC-SCAM.
           MOVE GSE-NUM-AVSG IN GSE-FLD TO NVC-ACAM.
           MOVE GSE-NUM-MVSG IN GSE-FLD TO NVC-MCAM.
           MOVE GSE-NUM-DVSG IN GSE-FLD TO NVC-DCAM.
           MOVE GSE-SGV-SEGU IN GSE-FLD TO NVC-VALO.
           MOVE GSE-COD-VCMS IN GSE-FLD TO NVC-MON1.           
           MOVE GDG-COD-VCAM IN GDG     TO NVC-MON2.
           MOVE WSS-4                   TO NVC-NUM-DECI.
           MOVE WSS-C                   TO NVC-IND-ACCI.

           PERFORM PRO-NVC-NCD.

           IF NVC-CMSG > SPACES
               MOVE 'BGL'        TO MSG-COD-SIST    
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG                      
               MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD   
               MOVE MSG-GLS-DESC TO FRM-MENS         
               MOVE FRM-SUAR-MAL TO FRM-SUAR         
               GO TO FIN-VAL-GSE-SGV-SEGU            
           ELSE                                   
               MOVE NVC-RESU TO WSS-NUM-SEGU IN WSS-VARI.             

      *MPB-FIN                 
              
      *COMPARA CON TABLA
       CNT-VAL-GSE-SGV-SEGU.                                            
           MOVE 'BGL' TO TAB-COD-SIST FIO-SIST.                         
           MOVE 'MAQ' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-COD-CGTA IN GDG TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS                                              
               GO TO FIN-VAL-GSE-SGV-SEGU                               
           ELSE                                                         
               MOVE 'BGL'     TO TAB-COD-SIST FIO-SIST
               MOVE 'PVT'     TO TAB-COD-TTAB IN TAB                    
               MOVE 'BGLPGSE' TO TAB-COD-CTAB IN TAB                    
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF NOT (FIO-STAT-OKS AND                                 
                  TAB-IND-VIGE IN TAB = 'S')                            
                  GO TO FIN-VAL-GSE-SGV-SEGU                            
               ELSE                                                     
                  MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA              
      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE 
      *SE LE AGREGAN DECIMALES A PCTJ Y NO SE REDONDEA      
      *            COMPUTE WSS-VAL-PCTJ ROUNDED =                        
                  COMPUTE WSS-VAL-PCTJ =                        
      *MPB-FIN            
                     ((WSS-VAR-VCTS IN WSS-VARI * WSS-NUM-PVTA)/100)    
                  IF (WSS-VAR-SEGU IN WSS-VARI > WSS-VAL-PCTJ)          
                     MOVE 'BGL'           TO MSG-COD-SIST               
                     MOVE 'V.TSC>%V.TSA' TO MSG-COD-MENS                
                     PERFORM GET-MSG 
                     MOVE MSG-GLS-DESC TO FRM-MENS                      
                     MOVE FRM-SUAR-MAL TO FRM-SUAR                      
                     GO TO FIN-VAL-GSE-SGV-SEGU.                        
      * FIN-AFRI/MAY2006
      BUS-SIG-REG.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-SGV-SEGU
           ELSE
*% IF PGM_ARG
      *<<<< PGM_ARG
               MOVE GSE-COD-VCMS IN GSE-FLD TO WSS-COD-PESO
               IF WSS-IND-TMON NOT = '0'
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
               IF GSE-COD-VCMS IN GSE-FLD = TAB-COD-CTAB IN TAB
      *>>>>
*% END
                  MOVE GSE-SGV-SEGU IN GSE-FLD TO
                                       PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                                        GSE-SGV-SEGU IN GSE-FLD.
      *
           IF NOT PGM-STAT-GVT-OKS
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE 'GSEGVTNEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-SGV-SEGU.  
      *
           MOVE  'TAB'                  TO TAB-COD-SIST.                
           MOVE  'NVA'                  TO TAB-COD-TTAB IN TAB.         
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GSE-FLD TO WSS-TIP-CGTA IN WSS-VARI.    
           MOVE GDG-STP-CGTA IN GSE-FLD TO WSS-STP-CGTA IN WSS-VARI.    
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
      *>>>>                                                             
           PERFORM BUS-TAB.                                             
      *MHM-INI 01-DIC-2004                                              
      *    IF MSG-COD-MENS NOT > SPACES                                 
           IF MSG-COD-MENS > SPACES                                     
      *MHM-FIN 01-DIC-2004                                              
               GO TO FIN-VAL-GSE-SGV-SEGU.
      *                                                                 
                                                                        
           IF GSE-COD-VCMS IN GSE-FLD = GDG-COD-VCAM IN GSE-FLD AND     
              GSE-SGV-SEGU IN GSE-FLD < GAR-SGV-VPND IN CMA-VARI        
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSESEG<LIQ' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GSE-SGV-SEGU.                              
                                                                        
      *                                                                 
      *>>>>
*% END
*% IF INI_GSE_COD_ESTA
      *<<<< INI_GSE_COD_ESTA
           IF SCR-CMND = 'ING'
               MOVE '01' TO GSE-COD-ESTA IN GSE-FLD.
      *PVG INI 14-OCT-2003
      *    IF GSE-COD-ESTA IN GSE-FLD > SPACES
      *        MOVE 'BGL'                   TO TAB-COD-SIST
      *        MOVE 'ESS '                  TO TAB-COD-TTAB IN TAB
      *        MOVE GSE-COD-ESTA IN GSE-FLD TO TAB-COD-CTAB IN TAB
      *        PERFORM VAL-COD
      *        IF MSG-COD-MENS NOT > SPACES
      *           MOVE TAB-GLS-DESC IN TAB  TO FRM-GLS-ESTA IN GSE-FLD
      *        ELSE
      *           MOVE SPACES               TO FRM-GLS-ESTA IN GSE-FLD.
      *PVG FIN 14-OCT-2003
      *>>>>
*% END
*% IF INI_GSE_FEC_FVTS
      *<<<< INI_GSE_FEC_VTO_SEG
      *PVC-INI 28-FEB-2012
           IF GSE-FEC-FVTS IN GSE-FLD  = WSS-99999999                     
               GO TO FIN-VAL-GSE-FEC-FVTS.                              
      *PVC-FIN 28-FEB-2012
           IF GSE-FEC-FVTS IN GSE-FLD  NOT > ZEROES
              MOVE ZEROES TO GSE-FEC-FVTS IN GSE-FLD.
      *VAL-FEC Validar Fecha
           MOVE GSE-FEC-FVTS IN GSE-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GSE_FEC_VTO_SEG
      
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-FBLK-S TO FEC-FBLK.

           MOVE GSE-NUM-SVTS IN GSE-FLD TO FEC-SEC2.
           MOVE GSE-NUM-AVTS IN GSE-FLD TO FEC-AEC2.
           MOVE GSE-NUM-MVTS IN GSE-FLD TO FEC-MEC2.
           MOVE GSE-NUM-DVTS IN GSE-FLD TO FEC-DEC2.
           GO TO FEC_VIGE.
      *>>>>
*% END
*% IF GSE_FEC_FVTS
      *<<<< GSE_FEC_VTO_SEG
      FEC_VIGE.
      *Fecha vigencia
           MOVE GSE-NUM-SVSG IN GSE-FLD TO FEC-SEC1.
           MOVE GSE-NUM-AVSG IN GSE-FLD TO FEC-AEC1.
           MOVE GSE-NUM-MVSG IN GSE-FLD TO FEC-MEC1.
           MOVE GSE-NUM-DVSG IN GSE-FLD TO FEC-DEC1.
      *Fecha vencimiento
           MOVE GSE-NUM-SVTS IN GSE-FLD TO FEC-SEC2.
           MOVE GSE-NUM-AVTS IN GSE-FLD TO FEC-AEC2.
           MOVE GSE-NUM-MVTS IN GSE-FLD TO FEC-MEC2.
           MOVE GSE-NUM-DVTS IN GSE-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'VTO<=VIG' TO MSG-COD-MENS
               GO TO ERR-VAL-FEC-FVTS.

      *<<<<AFRI-INI MAYO-2006                                           
           IF NOT (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')                
               GO TO FIN-VAL-GSE-FEC-FVTS.                              
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'PRD'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'FECVIGVTO'  TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S)          
               MOVE 'BGL'            TO MSG-COD-SIST
               MOVE 'TABPRDVIGVTO'   TO MSG-COD-MENS     
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC     TO FRM-MENS                        
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-GSE-FEC-FVTS.
           MOVE TAB-GLS-DATA IN TAB  TO WSS-PER-PERI IN WSS-VARI.       
           IF WSS-GLS-CANT IS NOT NUMERIC                               
               MOVE 'BGL'            TO MSG-COD-SIST                    
               MOVE 'CANTPRDNONUM'   TO MSG-COD-MENS                    
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC     TO FRM-MENS                        
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-GSE-FEC-FVTS.                              
           IF WSS-GLS-PERI = WSS-M                                        
               MOVE GSE-NUM-DVSG IN GSE-FLD TO FEC-DEC1                 
               MOVE GSE-NUM-MVSG IN GSE-FLD TO FEC-MEC1                 
               MOVE GSE-NUM-SVSG IN GSE-FLD TO FEC-SEC1                 
               MOVE GSE-NUM-AVSG IN GSE-FLD TO FEC-AEC1                 
               MOVE GSE-NUM-DVTS IN GSE-FLD TO FEC-DEC2
               MOVE GSE-NUM-MVTS IN GSE-FLD TO FEC-MEC2                 
               MOVE GSE-NUM-SVTS IN GSE-FLD TO FEC-SEC2                 
               MOVE GSE-NUM-AVTS IN GSE-FLD TO FEC-AEC2                 
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-DIF-MES             TO FEC-CMND                 
               PERFORM CAL-FEC
               IF (FEC-NDIA > ZEROES )                                  
                   ADD 1 TO FEC-NMES
           END-IF                                                   
               IF FEC-NMES NOT > WSS-GLS-CANT IN WSS-VARI               
                   GO TO FIN-VAL-GSE-FEC-FVTS                           
               ELSE
                   MOVE 'BGL'            TO MSG-COD-SIST                
                   MOVE 'DIFANONOVALI'   TO MSG-COD-MENS                
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC     TO FRM-MENS                    
                   MOVE FRM-SUAR-MAL     TO FRM-SUAR
                   GO TO FIN-VAL-GSE-FEC-FVTS                           
           ELSE                                                         
               MOVE 'BGL'            TO MSG-COD-SIST                    
               MOVE 'TIPOPRDNOVAL'   TO MSG-COD-MENS                    
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC     TO FRM-MENS                        
               MOVE FRM-SUAR-MAL     TO FRM-SUAR                        
               GO TO FIN-VAL-GSE-FEC-FVTS.                              
      *>>>>AFRI-FIN MAYO-2006                                           
                                                                        
           GO TO FIN-VAL-GSE-FEC-FVTS.
       ERR-VAL-FEC-FVTS.
           MOVE 'BGL'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.


      *>>>>
*% END
*% LBL = ''
*% IF GSE_IND_ENDS
      *<<<< GSE_IND_ENDS
      *PVG INI 14-OCT-2003
           IF SCR-CMND = 'ING'
              MOVE 'S' TO GSE-IND-ENDS IN GSE-FLD.
      *PVG FIN 14-OCT-2003
      *INI-AFRI/JUN2005                                                 
           IF SCR-CMND = 'ING'      AND                                 
              GSE-CAI-GTIA IN GSE-FLD = WSS-0800                          
              MOVE 'N' TO GSE-IND-ENDS IN GSE-FLD.                      
      *FIN-AFRI/JUN2005
      *ISP-INI 18-06-2005                                               
           IF SCR-HDR-MRCA = 'BCS' AND                                  
              GSE-NUM-IGSE IN GSE-FLD = WSS-CTE-2                               
                MOVE 'S' TO GSE-IND-ENDS IN GSE-FLD.
      *ISP-FIN 18-06-2005
*% IF FMT_CHI
      *<<<<
           IF GSE-IND-ENDS IN GSE-FLD NOT > SPACES                      
              GO TO FIN-VAL-GSE-IND-ENDS.                               
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GSE-IND-ENDS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GSE-IND-ENDS.
      *>>>>
*% ELSE
           IF NOT (GSE-IND-ENDS IN GSE-FLD = 'S' OR 'N')
               MOVE 'DEBE SER S o N ' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
*% END
      *>>>>
*% END
*% IF GSE_IND_PCUO
      *<<<< GSE_IND_PCUO
*% IF FMT_CHI
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GSE-IND-PCUO IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GSE-IND-PCUO.
      *>>>>
*% ELSE
           IF NOT (GSE-IND-PCUO IN GSE-FLD = 'S' OR 'N')
               MOVE 'DEBE SER S o N ' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
*% END
      *>>>>
*% END
*% IF GSE_NUM_CUOT
      *<<<< GSE_NUM_CUOT
      *PVG INI 14-OCT-2003
           IF GSE-IND-PCUO IN GSE-FLD = 'N'
              MOVE ZEROES TO GSE-NUM-CUOT IN GSE-FLD.
           IF GSE-IND-PCUO IN GSE-FLD = 'S' AND
              GSE-NUM-CUOT IN GSE-FLD NOT > ZEROES
              MOVE 'BGL'          TO MSG-COD-SIST
              MOVE 'GSO NCUOOBLI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *PVG FIN 14-OCT-2003
      *AFRI-INI JUL/2004
           IF SCR-HDR-MRCA = 'BCS'                                      
              MOVE 'BGL'          TO TAB-COD-SIST FIO-SIST              
              MOVE 'VGA'          TO TAB-COD-TTAB IN TAB                
              MOVE 'GSECUOTBCS'      TO TAB-COD-CTAB IN TAB             
              MOVE FIO-GET-KEY    TO FIO-CMND
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS AND TAB-IND-VIGE = WSS-S                    
                 MOVE TAB-GLS-DATA TO WSS-GLS-CUOT                      
                 IF WSS-NUM-CUOT IS NUMERIC                             
                    IF GSE-NUM-CUOT IN GSE-FLD NOT > WSS-NUM-CUOT AND   
                       WSS-NUM-CUOT > ZEROES                            
                       GO TO FIN-VAL-GSE-NUM-CUOT                       
                    ELSE                                                
                       MOVE 'BGL'          TO MSG-COD-SIST              
                       MOVE 'GSO NCUO<TAB' TO MSG-COD-MENS
                       PERFORM GET-MSG                                  
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD 
                       MOVE MSG-GLS-DESC TO FRM-MENS                    
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                 ELSE
                       MOVE 'BGL'          TO MSG-COD-SIST              
                       MOVE 'GSO NCUONONU' TO MSG-COD-MENS                
                       PERFORM GET-MSG 
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD   
                       MOVE MSG-GLS-DESC TO FRM-MENS                      
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                      
              ELSE                                                      
                  IF GSE-NUM-CUOT IN GSE-FLD > 99
                       MOVE 'BGL'          TO MSG-COD-SIST              
                       MOVE 'GSO NCUO>99' TO MSG-COD-MENS               
                       PERFORM GET-MSG                                  
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD 
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR.                   
           IF SCR-HDR-MRCA NOT = 'BCS'                                  
              MOVE 'BGL'          TO TAB-COD-SIST FIO-SIST              
              MOVE 'VGA'          TO TAB-COD-TTAB IN TAB                
              MOVE 'GSECUOT'      TO TAB-COD-CTAB IN TAB
              MOVE FIO-GET-KEY    TO FIO-CMND                           
              PERFORM GNS-FIO-TAB
              IF FIO-STAT-OKS AND TAB-IND-VIGE = WSS-S
                 MOVE TAB-GLS-DATA TO WSS-GLS-CUOT
                 IF WSS-NUM-CUOT IS NUMERIC
                    IF GSE-NUM-CUOT IN GSE-FLD NOT > WSS-NUM-CUOT AND
                       WSS-NUM-CUOT > ZEROES
                       GO TO FIN-VAL-GSE-NUM-CUOT
                    ELSE
                       MOVE 'BGL'          TO MSG-COD-SIST
                       MOVE 'GSO NCUO<TAB' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                 ELSE
                     MOVE 'BGL'          TO MSG-COD-SIST
                     MOVE 'GSO NCUONONU' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                  IF GSE-NUM-CUOT IN GSE-FLD > 11
                       MOVE 'BGL'          TO MSG-COD-SIST
                       MOVE 'GSO NCUO>11' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *AFRI-FIN JUL/2004
      *>>>>
*% END
*% IF GSE_COD_ICCS
      *<<<< GSE_COD_ICCS
*% IF GEN_BCI
      *<<<< GEN_BCI
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CSE ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-ICCS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-ICCS IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ICCS IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ICCS IN GSE-FLD.
      *>>>>
*% ELSE
           MOVE 'CSE'                    TO IVB-COD-TTAB IN IVB.
           MOVE GSE-COD-ICCS IN GSE-FLD  TO IVB-COD-EIVB IN IVB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-IVB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODICCSNEX' TO MSG-COD-MENS
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-COD-ICCS
           ELSE
               IF IVB-IND-VIGE IN IVB NOT = WSS-S
                  MOVE 'COD    NVG' TO MSG-COD-MENS
                  MOVE 'GNS' TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                  MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-ICCS IN GSE-FLD.
      *<<<<
*% END
      *<<<<
*% END
*% IF GSE_COD_CORS
      *<<<< GSE_COD_CORS
*% IF GEN_BCI
      *<<<< GEN_BCI
           IF GSE-COD-RTSE IN GSE-FLD NOT = WSS-3
               MOVE SPACES TO GSE-COD-CORS IN GSE-FLD
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD
               GO TO FIN-VAL-GSE-COD-CORS.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'SEG ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-CORS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-CORS IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CORS IN GSE-FLD.
      *>>>>
*% ELSE
           IF GSE-COD-CORS IN GSE-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD
              GO TO FIN-VAL-GSE-COD-CORS.
           MOVE 'SEG'                    TO IVB-COD-TTAB IN IVB.
           MOVE GSE-COD-CORS IN GSE-FLD  TO IVB-COD-EIVB IN IVB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-IVB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODCORSNEX' TO MSG-COD-MENS
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-COD-CORS
           ELSE
               IF IVB-IND-VIGE IN IVB NOT = WSS-S
                  MOVE 'COD    NVG' TO MSG-COD-MENS
                  MOVE 'GNS' TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                  MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-CORS IN GSE-FLD.
      *>>>>
*% END
      *>>>>
*% END
*% IF VAL_CON_FLD_GSE
      *<<<< VAL_CON_FLD_GSE
           IF NOT PGM-STAT-GVT-OKS
      *MHM-INI 01-DIC-2004                                              
      *        MOVE 'GSEGVTNEX' TO MSG-COD-MENS                         
               MOVE 'GSEGVTNEX' TO MSG-COD-MENS.                        
      *    ELSE                                                         
      *    IF GSE-COD-VCMS IN GSE-FLD = GDG-COD-VCAM IN GSE-FLD AND     
      *       GSE-SGV-SEGU IN GSE-FLD < GAR-SGV-LTSN IN CMA-VARI        
      *        MOVE 'GSESEG<LIQ' TO MSG-COD-MENS.                       
      *MHM-FIN 01-DIC-2004                                              
      *>>>>
*% END
*% IF INI_GSE_VAL_MPRI
      *<<<< INI_GSE_VAL_MPRI
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = WSS-MIGRACION AND
              GSE-VAL-MPRI IN GSE-FLD NOT > ZEROES
               GO TO FIN-VAL-GSE-VAL-MPRI.
      *MHM-FIN 29-OCT-2003
                                                                        
      *AFRI-INI/SEP2007(MAE)                                            
           IF GSE-IND-SEG IN GSE-FLD = WSS-C AND                          
              SCR-HDR-MRCA  = 'BCS' AND                                 
              GSE-VAL-MPRI IN GSE-FLD = ZEROES                          
                PERFORM  CAL-MPRIMA-COMP                                
                IF GSE-IND-ERRO IN GSE-VARI = 'S'                       
                    MOVE 'BGL'            TO MSG-COD-SIST               
                    MOVE GSE-COD-MENS IN GSE-VARI TO MSG-COD-MENS       
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC     TO FRM-MENS                   
                    MOVE FRM-SUAR-MAL     TO FRM-SUAR                   
                       GO TO FIN-VAL-GSE-VAL-MPRI                       
                    ELSE                                                
                       MOVE GSE-VAL-MPRI IN GSE-VARI TO                 
                            GSE-VAL-MPRI IN GSE-FLD                     
                       GO TO FIN-VAL-GSE-VAL-MPRI.                      
                                                                        
      *AFRI-FIN/SEP2007(MAE)                                            
      *AFRI-INI/ENE2007(MAE)                                            
           IF (( SCR-HDR-MRCA NOT = 'BCS'  OR                           
                 GSE-IND-SEG IN GSE-FLD NOT = WSS-T ) AND                 
                 GSE-VAL-MPRI IN GSE-FLD = ZEROES)                      
                  PERFORM ERR-GLS                                       
                  GO TO FIN-VAL-GSE-VAL-MPRI.                           
                                                                        
      *    VALIDACION TABLA VERSIONES (SEG TOTAL )                      
           IF ( SCR-HDR-MRCA = 'BCS'  AND                               
                GSE-IND-SEG IN GSE-FLD = WSS-T )                          
                 MOVE 'BGL'           TO  TAB-COD-SIST FIO-SIST       
                 MOVE 'BGL'           TO  TAB-COD-SIST FIO-SIST         
                 MOVE 'VSN'           TO  TAB-COD-TTAB IN TAB           
                 MOVE 'TIPSEGTOT'     TO  TAB-COD-CTAB IN TAB           
                 PERFORM GNS-FIO-TAB                                    
                 IF ((NOT FIO-STAT-OKS OR  TAB-IND-VIGE NOT = WSS-S) AND  
                     GSE-VAL-MPRI IN GSE-FLD = ZEROES)                  
                     PERFORM ERR-GLS                              
                      GO TO FIN-VAL-GSE-VAL-MPRI.                       
                                                                        
           IF GSE-IND-SEG IN GSE-FLD = WSS-T AND                          
              FIO-STAT-OKS AND TAB-IND-VIGE = WSS-S  AND                  
              SCR-HDR-MRCA  = 'BCS' AND                                 
                    GSE-VAL-MPRI IN GSE-FLD = ZEROES                          
                    PERFORM  CAL-MPRIMA                                 
                    IF GSE-IND-ERRO IN GSE-VARI = 'S'                   
                       MOVE 'BGL'            TO MSG-COD-SIST            
                       MOVE GSE-COD-MENS IN GSE-VARI TO MSG-COD-MENS    
                       PERFORM GET-MSG                                  
                       MOVE MSG-GLS-DESC     TO FRM-MENS                
                       MOVE FRM-SUAR-MAL     TO FRM-SUAR                
      *                MOVE 777    TO GSE-VAL-MPRI  IN GSE-FLD          
                       GO TO FIN-VAL-GSE-VAL-MPRI                       
                    ELSE                                                
                       MOVE GSE-VAL-MPRI IN GSE-VARI TO                 
                            GSE-VAL-MPRI IN GSE-FLD                     
                       GO TO FIN-VAL-GSE-VAL-MPRI.                      
                                                                        
                                                                        
                                                                        
      *    IF GSE-IND-SEG IN GSE-FLD = 'T' AND                          
      *       SCR-HDR-MRCA  = 'BCS' AND                                 
      *       GSE-VAL-MPRI IN GSE-FLD = ZEROES                          
      *        PERFORM  CAL-MPRIMA                                      
      *        IF GSE-IND-ERRO IN GSE-VARI = 'S'                        
      *            MOVE 'BGL'            TO MSG-COD-SIST                
      *            MOVE GSE-COD-MENS IN GSE-VARI TO MSG-COD-MENS        
      *            PERFORM GET-MSG                                      
      *            MOVE MSG-GLS-DESC     TO FRM-MENS                    
      *            MOVE FRM-SUAR-MAL     TO FRM-SUAR                    
      *            MOVE 777    TO GSE-VAL-MPRI  IN GSE-FLD              
      *            GO TO FIN-VAL-GSE-VAL-MPRI                           
      *        ELSE                                                     
      *            MOVE GSE-VAL-MPRI IN GSE-VARI TO                     
      *                 GSE-VAL-MPRI IN GSE-FLD                         
      *            GO TO FIN-VAL-GSE-VAL-MPRI.                          
                                                                        
      *AFRI-FIN/ENE2007(MAE)                                            
                                                                        
                                                                        
      *>>>>
*% END
*% IF INI_GSE_NUM_CUOT
      *<<<< INI_GSE_NUM_CUOT
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = WSS-MIGRACION AND
              GSE-NUM-CUOT IN GSE-FLD NOT > ZEROES
               GO TO FIN-VAL-GSE-NUM-CUOT.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF EOF_BQ
      *<<<<
                                                                        
      * EVA-INI  08/07                                                  
                                                                        
       BUS-RNOV SECTION.                                                
       INI-BUS-RNOV.                                                    
      * EVA-INI  11/08                                                  
      *    MOVE SPACES TO WSS-IND-RSEG.                                 
      *    MOVE 'S' TO WSS-IND-ASEG.                                    
      *    MOVE 'N' TO WSS-IND-RNOV.                                    
                                                                        
      *    IF WSS-IND-AREN NOT = 'S'                                    
      *       GO TO FIN-BUS-RNOV.                                       
                                                                        
      *    IF (GDG-IND-EST1 IN GDG < '10' OR                            
      *        GDG-IND-EST1 IN GDG > '19')                              
      *        GO TO FIN-BUS-RNOV.                                      
                                                                        
      *    IF NOT (GSE-SGV-SEGU IN GSE-FLD > 1)                         
      *       MOVE 'N' TO WSS-IND-ASEG                                  
      *       GO TO FIN-BUS-RNOV.                                       
                                                                        
      *    MOVE GSE-CAI-GTIA IN GSE-FLD TO GVT-CAI-GTIA IN GVT.         
      *    MOVE GSE-IIC-GTIA IN GSE-FLD TO GVT-IIC-GTIA IN GVT.         
      *    MOVE 999                 TO GVT-COD-TASN IN GVT.             
      *    MOVE FIO-GET-LEQ TO FIO-CMND.                                
      *    PERFORM BGL-FIO-GVT.                                         
      *    IF NOT (FIO-STAT-OKS AND                                     
      *       GSE-CAI-GTIA IN GSE-FLD = GVT-CAI-GTIA IN GVT AND         
      *       GSE-IIC-GTIA IN GSE-FLD = GVT-IIC-GTIA IN GVT)            
      *       GO TO FIN-BUS-RNOV.                                       
                                                                        
      *    IF NOT (GVT-SGV-VCTS IN GVT > 1)                             
      *       MOVE 'N' TO WSS-IND-ASEG                                  
      *       GO TO FIN-BUS-RNOV.                                       
                                                                        
      *    PERFORM LEE-VCTO.                                            
      *    IF NOT (WSS-GLS-DAT1  > ZEROES)                              
      *       GO TO FIN-BUS-RNOV.                                       
                                                                        
      *    MOVE GSE-CAI-GTIA IN GSE-FLD TO POL-CAI-GTIA IN POL.         
      *    MOVE GSE-IIC-GTIA IN GSE-FLD TO POL-IIC-GTIA IN POL.         
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM BGL-FIO-POL.                                         
      *    IF NOT (FIO-STAT-OKS)                                        
      *       MOVE 'S' TO WSS-IND-RSEG                                  
      *       PERFORM PROC-VCTO                                         
      *       GO TO FIN-BUS-RNOV.                                       
                                                                        
      *    IF NOT (POL-COD-ESGE IN POL = '01' OR                        
      *        POL-COD-ESGE IN POL = '50' OR                            
      *        POL-COD-ESGE IN POL = '51' OR                            
      *        POL-COD-ESGE IN POL = '53')                              
      *        MOVE 'N' TO WSS-IND-RSEG                                 
      *    ELSE                                                         
      *        MOVE 'S' TO WSS-IND-RSEG.                                
      *                                                                 
      *    PERFORM PROC-VCTO.                                           
      *                                                                 
                                                                        
           PERFORM GET-FHOY.                                            
           MOVE 'S' TO WSS-IND-GTAC IN WSS-VARI.                        
           MOVE 'S' TO WSS-IND-ARNV IN WSS-VARI.                        
           MOVE 'N' TO WSS-IND-GDIA IN WSS-VARI.                        
           MOVE 'N' TO WSS-IND-ECRS IN WSS-VARI.                        
           MOVE 'N' TO WSS-IND-RSEG IN WSS-VARI.                        
           MOVE 'N' TO WSS-IND-RNOV IN WSS-VARI.                        
      *PVC-INI 28-FEB-2012                                              
           MOVE 'N' TO WSS-IND-REPA IN WSS-VARI.
      *PVC-FIN 28-FEB-2012                                              
                                                                        
           IF (GDG-IND-EST1 IN GDG < '10' OR                            
               GDG-IND-EST1 IN GDG > '19')                              
               MOVE 'N' TO WSS-IND-GTAC IN WSS-VARI                     
               GO TO FIN-BUS-RNOV.                                      
                                                                        
           IF CMA-IND-APLI IN CMA-VARI NOT = WSS-A                        
               MOVE 'N' TO WSS-IND-ARNV IN WSS-VARI                     
               GO TO FIN-BUS-RNOV.                                      
                                                                        
           IF WSS-FEC-FVTS IN WSS-VARI > HOY-FHOY                       
              MOVE 'S' TO WSS-IND-GDIA IN WSS-VARI                      
              GO TO FIN-BUS-RNOV.                                       
                                                                        
           IF GDG-IND-ECRS IN GDG = WSS-S AND                             
              GDG-FEC-FVES IN GDG > HOY-FHOY                            
               MOVE 'S' TO WSS-IND-ECRS IN WSS-VARI                     
              GO TO FIN-BUS-RNOV.                                       
                                                                        
           MOVE GSE-CAI-GTIA IN GSE-FLD TO POL-CAI-GTIA IN POL.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO POL-IIC-GTIA IN POL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-POL.                                         
           IF FIO-STAT-OKS AND                                          
              (POL-COD-ESGE IN POL = '11' OR                            
               POL-COD-ESGE IN POL = '21' OR                            
               POL-COD-ESGE IN POL = '31' OR                            
               POL-COD-ESGE IN POL = '41' OR                            
               POL-COD-ESGE IN POL = '53')                              
              MOVE 'S' TO WSS-IND-RSEG IN WSS-VARI                      
              GO TO FIN-BUS-RNOV.                                       

      *PVC-INI 28-FEB-2012
           IF FIO-STAT-OKS AND                                          
              POL-COD-ESGE IN POL = '13'                                
               MOVE 'S' TO WSS-IND-REPA IN WSS-VARI
               GO TO FIN-BUS-RNOV.
      *PVC-FIN 28-FEB-2012                                              
                                                                        
           IF NOT (GSE-SGV-SEGU IN GSE-FLD > 1)                         
              MOVE 'N' TO WSS-IND-ARNV IN WSS-VARI                      
              GO TO FIN-BUS-RNOV.                                       
                                                                        
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GVT-CAI-GTIA IN GVT.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GVT-IIC-GTIA IN GVT.         
           MOVE 999                     TO GVT-COD-TASN IN GVT.         
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM BGL-FIO-GVT.                                         
           IF (FIO-STAT-OKS AND                                         
               GSE-CAI-GTIA IN GSE-FLD = GVT-CAI-GTIA IN GVT AND        
               GSE-IIC-GTIA IN GSE-FLD = GVT-IIC-GTIA IN GVT)           
              IF NOT (GVT-SGV-VCTS IN GVT > 1)                          
                 MOVE 'N' TO WSS-IND-ARNV IN WSS-VARI                   
                 GO TO FIN-BUS-RNOV.                                    
                                                                        
           MOVE 'S' TO WSS-IND-RNOV IN WSS-VARI.                        
      * EVA-FIN  11/08                                                  
       FIN-BUS-RNOV.                                                    
           EXIT.                                                        
                                                                        
       LEE-VCTO SECTION.                                                
       INI-LEE-VCTO.                                                    
      *Lee Tabla de Fechas de Proceso                                   
           MOVE 'BGL' TO TAB-COD-SIST FIO-SIST.                         
           MOVE 'TFP' TO TAB-COD-TTAB IN TAB.                           
           MOVE '03'  TO TAB-COD-CTAB IN TAB.                           
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND  
               TAB-IND-VIGE IN TAB = WSS-S)
               MOVE ZEROES TO WSS-GLS-DAT1                              
               GO TO FIN-LEE-VCTO                                       
           ELSE                                                         
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DAT1.                
       FIN-LEE-VCTO.                                                    
           EXIT.                                                        
                                                                        
       PROC-VCTO SECTION.                                               
       INI-PROC-VCTO.                                                   
           MOVE 'N' TO WSS-IND-RNOV.                                    
           MOVE HOY-DHOY TO FEC-ITM1.                                   
           MOVE HOY-MHOY TO FEC-ITM2.                                   
           MOVE HOY-SHOY TO FEC-ITM3.                                   
           MOVE HOY-AHOY TO FEC-ITM4.                                   
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE WSS-NUM-DSEG TO FEC-NDIA.                               
           MOVE FEC-SUM-DIA  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           MOVE FEC-ITM3     TO WSS-NUM-STM3.                           
           MOVE FEC-ITM4     TO WSS-NUM-ATM4.                           
           MOVE FEC-ITM2     TO WSS-NUM-MTM2.                           
           MOVE FEC-ITM1     TO WSS-NUM-DTM1.                           
                                                                        
           IF NOT (GDG-IND-ECRS IN GDG > SPACES AND                     
               GDG-FEC-FVES IN GDG > ZEROES)                            
               GO TO CNT-PROC-VCTO.                                     
                                                                        
           IF (GDG-IND-ECRS IN GDG = WSS-S AND                            
               GDG-FEC-FVES IN GDG > WSS-FEC-FECH)                      
               MOVE 'N' TO WSS-IND-RNOV                                 
               GO TO FIN-PROC-VCTO.                                     
                                                                        
       CNT-PROC-VCTO.                                                   
                                                                        
           IF (WSS-FEC-FVTS IN WSS-VARI < WSS-FEC-FECH OR               
               WSS-FEC-FVTS IN WSS-VARI = WSS-FEC-FECH)                 
               MOVE 'S' TO WSS-IND-RNOV                                 
           ELSE                                                         
               MOVE 'N' TO WSS-IND-RNOV.                                       

       FIN-PROC-VCTO.                                                   
           EXIT.                                                        
                                                                        
       LEE-GDG SECTION.                                                 
       INI-LEE-GDG.                                                     
           MOVE 'N' TO WSS-IND-GTIA IN WSS-VARI.                        
           MOVE GSE-CAI-GTIA IN GSE TO GDG-CAI-GTIA IN GDG.             
           MOVE GSE-IIC-GTIA IN GSE TO GDG-IIC-GTIA IN GDG.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           IF NOT (FIO-STAT-OKS)                                        
              GO TO FIN-LEE-GDG                                         
           ELSE                                                         
              MOVE 'S' TO WSS-IND-GTIA IN WSS-VARI.                     
       FIN-LEE-GDG.                                                     
           EXIT.                                                        
      **EVA-FIN  08/07                                                  
      *>>>>
*% END
*% IF GSE_GLS_IMPR
      *<<<<
           IF ((GSE-GLS-IMPR IN GSE-FLD) > SPACES AND                   
               (GSE-GLS-IMPR IN GSE-FLD = WSS-S OR                        
                GSE-GLS-IMPR IN GSE-FLD = WSS-N))                         
                GO TO FIN-VAL-GSE-GLS-IMPR                              
           ELSE                                                         
                MOVE SPACES TO GSE-GLS-IMPR IN GSE-FLD.                 
      *>>>>
*% END
*% IF GSE_IND_SEGU
      *<<<<
           IF (GSE-IND-SEGU IN GSE-FLD) > SPACES                        
              IF GSE-IND-SEGU IN GSE-FLD = WSS-S OR                       
                 GSE-IND-SEGU IN GSE-FLD = WSS-N                          
                 GO TO FIN-VAL-GSE-IND-SEGU                             
              ELSE                                                      
                  MOVE 'BGL'        TO MSG-COD-SIST                     
                  MOVE 'SEG NO VALI' TO MSG-COD-MENS                    
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-GSE-IND-SEGU                            
           ELSE                                                         
                MOVE SPACES TO GSE-IND-SEGU IN GSE-FLD.                 
      *>>>>
*% END
*% IF GSE_IND_GENE
      *<<<<
           IF ((GSE-IND-GENE IN GSE-FLD) > SPACES AND                   
                (GSE-IND-GENE IN GSE-FLD = WSS-S OR                       
                 GSE-IND-GENE IN GSE-FLD = WSS-N))                        
                 GO TO FIN-VAL-GSE-IND-GENE                             
           ELSE                                                         
                MOVE SPACES TO GSE-IND-GENE IN GSE-FLD.                 
      *>>>>
*% END
*% IF GSE_IND_SEG
      *<<<<
                                                                        
           IF GSE-IND-SEG IN GSE-FLD > SPACES                           
              IF ((GSE-IND-SEG IN GSE-FLD = WSS-T) OR                     
                 (GSE-IND-SEG IN GSE-FLD = WSS-C))                        
                  GO TO CON-VAL-IND-SEG                                 
              ELSE                                                      
                  MOVE 'BGL'        TO MSG-COD-SIST                     
                  MOVE 'IND NO VALI' TO MSG-COD-MENS                    
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-GSE-IND-SEG                             
           ELSE                                                         
                  NEXT SENTENCE.                                        
      *AFRI-INI                                                         
      *    IF SCR-HDR-MRCA NOT = 'BCS'                                  
      *        GO TO CON-VAL-IND-SEG.                                   
      *    MOVE GSE-NUM-IGSE IN GSE-FLD TO GSE-NUM-IGSE IN GSE.         
      *LUP-VAL-IND-SEG.                                                 
      *    COMPUTE GSE-NUM-IGSE IN GSE = GSE-NUM-IGSE IN GSE - 1        
      *    IF GSE-NUM-IGSE IN GSE NOT > ZEROES AND                      
      *       GSE-IND-SEG IN GSE-FLD = 'C'                              
      *           MOVE 'BGL'        TO MSG-COD-SIST                     
      *           MOVE 'GSEINSEGNOT' TO MSG-COD-MENS                    
      *           PERFORM GET-MSG                                       
      *           MOVE MSG-GLS-DESC TO FRM-MENS                         
      *           MOVE FRM-SUAR-MAL TO FRM-SUAR                         
      *           GO TO FIN-VAL-GSE-IND-SEG.                            
      *    MOVE GSE-CAI-GTIA IN GSE-FLD TO GSE-CAI-GTIA IN GSE.         
      *    MOVE GSE-IIC-GTIA IN GSE-FLD TO GSE-IIC-GTIA IN GSE.         
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM BGL-FIO-GSE.                                         
      *    IF NOT FIO-STAT-OKS                                          
      *        MOVE 'BGL'        TO MSG-COD-SIST                        
      *        MOVE 'GSEINSEGNOT' TO MSG-COD-MENS                       
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC TO FRM-MENS                            
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
      *        GO TO FIN-VAL-GSE-IND-SEG.                               
      *    IF GSE-IND-SEG IN GSE-FLD = 'T'                              
      *       IF GSE-FEC-FVSG IN GSE > HOY-FHOY                         
      *           GO TO CON-VAL-IND-SEG.                                
      *    GO TO LUP-VAL-IND-SEG.                                       
                                                                        
       CON-VAL-IND-SEG.                                                 
      *AFRI-INI/DIC2007(MAE)                                            
           IF GSE-IND-SEG IN GSE-FLD = WSS-C AND                          
              SCR-HDR-MRCA  = 'BCS'                                     
                PERFORM  DET-SEG-COMP                                   
                IF GSE-IND-ERRO IN GSE-VARI = WSS-S                       
                    MOVE 'BGL'            TO MSG-COD-SIST               
                    MOVE GSE-COD-MENS IN GSE-VARI TO MSG-COD-MENS       
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC     TO FRM-MENS                   
                    MOVE FRM-SUAR-MAL     TO FRM-SUAR                   
                       GO TO FIN-VAL-GSE-IND-SEG.                       
      *AFRI-FIN/DIC2007(MAE)                                            
                                                                        
           IF SCR-HDR-MRCA = 'BCI' AND                                  
              GSE-IND-SEG IN GSE-FLD NOT > SPACES                       
              GO TO FIN-VAL-GSE-IND-SEG                                 
           ELSE                                                         
           IF GSE-IND-SEG IN GSE-FLD NOT > SPACES                       
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GSE-IND-SEG.                                
      *>>>>
*% END
