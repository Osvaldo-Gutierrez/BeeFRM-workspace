*%! Codigo adicional para archivo BGLBMSEG
*% IF SETTAG
*% FNCBQ = "OWFBGL"
*% VSNBQ = "06.06.29"
*% FNCBU = "OWFBGL"
*% VSNBU = "06.06.29"
*% END

*% IF FIN_PUT_POL_SEG
      *<<<< FIN-PUT-POL-SEG
      *BUS-TAB busca glosa de codigo en tabla                        
           IF POL-COD-ESGE IN SEG-FLD > SPACES                          
              MOVE 'BGL' TO TAB-COD-SIST                               
              MOVE 'SPO ' TO TAB-COD-TTAB IN TAB                       
              MOVE POL-COD-ESGE IN SEG-FLD TO TAB-COD-CTAB IN TAB      
              PERFORM BUS-TAB                                          
              MOVE TAB-GLS-DESC IN TAB TO                              
                   FRM-GLS-ESGE IN SEG-FLD                             
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-ESGE IN SEG-FLD. 
      *BUS-TAB busca glosa de codigo en tabla                           
           IF POL-COD-SEGU IN SEG-FLD > SPACES                          
              MOVE 'BGL' TO TAB-COD-SIST                               
              MOVE 'RSE ' TO TAB-COD-TTAB IN TAB                       
              MOVE POL-COD-SEGU IN SEG-FLD TO TAB-COD-CTAB IN TAB      
              PERFORM BUS-TAB                                          
              MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-SEGU IN SEG-FLD                             
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-SEGU IN SEG-FLD.                  
      *BUS-TAB busca glosa de codigo en tabla                           
           IF POL-COD-VCAM IN SEG-FLD > SPACES                          
              MOVE 'TAB' TO TAB-COD-SIST                               
              MOVE 'VLR ' TO TAB-COD-TTAB IN TAB                       
              MOVE POL-COD-VCAM IN SEG-FLD TO TAB-COD-CTAB IN TAB      
              PERFORM BUS-TAB                                          
              MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-VCAM IN SEG-FLD                             
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-VCAM IN SEG-FLD.                  
      *BUS-TAB busca glosa de codigo en tabla                           
           IF POL-COD-EPRO IN SEG-FLD > ZEROES                          
              MOVE 'BGL' TO TAB-COD-SIST                               
              MOVE 'ESP ' TO TAB-COD-TTAB IN TAB                       
              MOVE POL-COD-EPRO IN SEG-FLD TO TAB-COD-CTAB IN TAB      
              PERFORM BUS-TAB                                          
              MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-EPRO IN SEG-FLD                             
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-EPRO IN SEG-FLD.                  

      *>>>>
*% END
*% IF FIN_KEY_POL_SEG AND PGM_BU
      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE'                                          
              MOVE POL-CAI-GTIA IN SEG-FLD TO POL-CAI-GTIA IN POL       
              MOVE POL-IIC-GTIA IN SEG-FLD TO POL-IIC-GTIA IN POL       
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM BGL-FIO-POL                                       
              IF FIO-STAT-OKS                                           
                 PERFORM ERR-GLS.                                       
      *MAE                                                           
                                                                        
      *>>>>
*% END
*% IF FIN_PUT_GDG_SEG
      *<<<< FIN-PUT-GDG-SEG
      *BUS-TAB busca glosa de codigo en tabla                           
           IF GDG-TIP-CGTA IN SEG-FLD > SPACES                          
               MOVE 'TAB' TO TAB-COD-SIST                               
               MOVE 'AUX ' TO TAB-COD-TTAB IN TAB                       
               MOVE GDG-TIP-CGTA IN SEG-FLD TO WSS-TIP-CGTA IN WSS-VARI 
               MOVE GDG-STP-CGTA IN SEG-FLD TO WSS-STP-CGTA IN WSS-VARI 
               MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB     
               PERFORM BUS-TAB                                          
      *MHM-INI 23-OCT-2003                                              
      *         MOVE TAB-GLS-DESC IN TAB TO                             
      *              FRM-GLS-CGTA IN SEG-FLD                            
      *    ELSE                                                        
      *        MOVE SPACES TO FRM-GLS-CGTA IN SEG-FLD.                 
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.                 
                                                                        
           IF GDG-TIP-CGTA IN SEG-FLD > SPACES                          
               MOVE 'TAB'                   TO TAB-COD-SIST             
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB      
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB      
               MOVE GDG-TIP-CGTA IN SEG-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.                 
                                                                        
           MOVE WSS-GLS-CGTA TO CPT-STRN.                               
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-CGTA IN SEG-FLD.                       
      *>>>>
*% END
*% IF FIN_PUT_DBC_SEG
      *<<<< FIN-PUT-DBC-SEG
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                    
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO DBC-GLS-NOMC IN SEG-FLD.                    
      *>>>>  
*% END
*% IF FIN_POL_COD_ESGE
      *<<<< FIN-VAL-POL-COD-ESGE
      *MAE                                                              
           IF SCR-CMND = 'INE' OR SCR-CMND = 'ING'                      
              MOVE '01'   TO POL-COD-ESGE IN SEG-FLD                    
              GO TO CON-VAL-COD.                                        
      *MAE                                                              
                                                                        
           MOVE POL-CAI-GTIA IN SEG-FLD TO POL-CAI-GTIA IN POL.         
           MOVE POL-IIC-GTIA IN SEG-FLD TO POL-IIC-GTIA IN POL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-POL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-VAL-POL-COD-ESGE.                               
                                                                        
           IF (POL-COD-ESGE IN SEG-FLD = '10' OR
               POL-COD-ESGE IN SEG-FLD = '20' OR
               POL-COD-ESGE IN SEG-FLD = '30' OR                         
               POL-COD-ESGE IN SEG-FLD = '40')                          
                MOVE 'BGL'            TO MSG-COD-SIST                   
                MOVE 'ERROR ESTADO'   TO MSG-COD-MENS                   
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR.                          
                                                                        
           IF POL-COD-ESGE IN POL = '11'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '11' OR                 
                      POL-COD-ESGE IN SEG-FLD = '12' OR                 
                      POL-COD-ESGE IN SEG-FLD = '21' OR                 
                      POL-COD-ESGE IN SEG-FLD = '50')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '12'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '12' OR                 
                      POL-COD-ESGE IN SEG-FLD = '11' OR                 
                      POL-COD-ESGE IN SEG-FLD = '50')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '21'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '21' OR                 
                      POL-COD-ESGE IN SEG-FLD = '12' OR                 
                      POL-COD-ESGE IN SEG-FLD = '31' OR                 
                      POL-COD-ESGE IN SEG-FLD = '13')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '31'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '31' OR                 
                      POL-COD-ESGE IN SEG-FLD = '41' OR                 
                      POL-COD-ESGE IN SEG-FLD = '42')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '41'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '41' OR                 
                      POL-COD-ESGE IN SEG-FLD = '42' OR                 
                      POL-COD-ESGE IN SEG-FLD = '53')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '42'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '42' OR                 
                      POL-COD-ESGE IN SEG-FLD = '41' OR                 
                      POL-COD-ESGE IN SEG-FLD = '50')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '53'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '53' OR                 
                      POL-COD-ESGE IN SEG-FLD = '51')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '13'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '13' OR                 
                      POL-COD-ESGE IN SEG-FLD = '51')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
           
           IF (POL-COD-ESGE IN POL = '51' AND                          
               POL-COD-ESGE IN SEG-FLD NOT = '51')                     
                  MOVE 'BGL'            TO MSG-COD-SIST                
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                
                  PERFORM GET-MSG                                      
                  MOVE MSG-GLS-DESC TO FRM-MENS                        
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
                                                                       
           IF (POL-COD-ESGE IN POL = '50' AND                          
               POL-COD-ESGE IN SEG-FLD NOT = '50')                     
                  MOVE 'BGL'            TO MSG-COD-SIST                
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                
                  PERFORM GET-MSG                                      
                  MOVE MSG-GLS-DESC TO FRM-MENS                        
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
      *MAE                                                              
       CON-VAL-COD.                                                     
      *MAE                                                              
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'SPO ' TO TAB-COD-TTAB IN TAB.                          
           MOVE POL-COD-ESGE IN SEG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-ESGE IN SEG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-ESGE IN SEG-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-ESGE IN SEG-FLD.         

      *>>>>
*% END
*% IF INI_POL_GLS_MEST
      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE'                                          
              MOVE SPACES TO POL-GLS-MEST IN SEG-FLD                    
              GO TO FIN-VAL-POL-GLS-MEST.                               
      *MAE                                                              
                                                                        
      *>>>>
*% END
*% IF INI_POL_GLS_REAN
      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE'                                          
              MOVE SPACES TO POL-GLS-REAN IN SEG-FLD                    
              GO TO FIN-VAL-POL-GLS-REAN.                               
      *MAE                                                              
      *>>>>
*% END
*% IF INI_POL_GLS_RAMO
      *<<<<
      *MAE                                                              
           IF SCR-CMND NOT = 'INE'                                      
              GO TO FIN-VAL-POL-GLS-RAMO.                               
                                                                        
           MOVE POL-CAI-GTIA IN SEG-FLD TO GSE-CAI-GTIA IN GSE.         
           MOVE POL-IIC-GTIA IN SEG-FLD TO GSE-IIC-GTIA IN GSE.         
           MOVE 999                     TO GSE-NUM-IGSE IN GSE.         
           MOVE FIO-GET-LEQ             TO FIO-CMND.                    
           PERFORM BGL-FIO-GSE.                                         
           IF (NOT FIO-STAT-OKS   OR                                    
               POL-CAI-GTIA IN SEG-FLD NOT = GSE-CAI-GTIA IN GSE  OR    
               POL-IIC-GTIA IN SEG-FLD NOT = GSE-IIC-GTIA IN GSE)       
                MOVE SPACES TO POL-GLS-RAMO IN SEG-FLD                  
                GO TO FIN-VAL-POL-GLS-RAMO.                             
                                                                        
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'CBS ' TO TAB-COD-TTAB IN TAB.                          
           MOVE GSE-COD-COB1 IN GSE TO TAB-COD-CTAB IN TAB.             
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              GSE-COD-COB1 IN GSE NOT > SPACES                          
               MOVE FRM-SUAR-OKS TO FRM-SUAR                            
               MOVE SPACES TO MSG-COD-MENS                              
               MOVE SPACES TO POL-GLS-RAMO IN SEG-FLD                   
           ELSE                                                         
               MOVE FRM-SUAR-OKS TO FRM-SUAR                            
               MOVE TAB-GLS-DESC IN TAB TO                              
                    POL-GLS-RAMO IN SEG-FLD.                            
      *MAE                                                              
      *>>>>
*% END
*% IF INI_POL_COD_PLZA
      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND                                      
              POL-COD-PLZA IN SEG-FLD NOT > SPACES                      
              PERFORM ERR-GLS.                                          
      *MAE                                                              
      *>>>>
*% END
*% IF INI_POL_FEC_FVPL
      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND
              POL-FEC-FVPL IN SEG-FLD  NOT > ZEROES
              PERFORM ERR-GLS.
           GO TO FIN-POL-FEC-FVPL.     
      *>>>>
*% END
*% IF POL_FEC_FVPL
      *<<<<
           MOVE POL-FEC-FVPL IN SEG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO POL-FEC-FVPL IN SEG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-POL-FEC-FVPL.
            IF POL-FEC-FVPL IN SEG-FLD  NOT > SPACES
              MOVE ZEROES TO POL-FEC-FVPL IN SEG-FLD.
      *VAL-FEC Validar Fecha
           MOVE POL-FEC-FVPL IN SEG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           IF SCR-HDR-MRCA = 'BCS'
              MOVE FEC-CHOY-N TO FEC-CHOY.
           PERFORM PRO-FEC.
           IF SCR-HDR-MRCA = 'BCS'
               IF FEC-STAT-FER
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-FBLK-N  TO FEC-FBLK
                   MOVE FEC-CHOY-N  TO FEC-CHOY
                   MOVE FEC-SIG-HBL TO FEC-CMND
                   PERFORM CAL-FEC
                   MOVE  '00' TO FEC-STAT.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO POL-FEC-FVPL IN SEG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-POL-FEC-FVPL.
      *>>>>
*% END
*% IF INI_POL_FEC_FTPL
      *<<<<
      *MAE
           IF SCR-CMND = 'INE' AND
              POL-FEC-FTPL IN SEG-FLD  NOT > ZEROES
              PERFORM ERR-GLS.
           GO TO FIN-POL-FEC-FTPL.
      *>>>>
*% END
*% IF FIN_POL_FEC_FTPL
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO POL-FEC-FTPL IN SEG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-POL-FEC-FTPL.
      *<<<<
      *Fecha vigencia
           MOVE POL-NUM-SVPL IN SEG-FLD TO FEC-SEC1.
           MOVE POL-NUM-AVPL IN SEG-FLD TO FEC-AEC1.
           MOVE POL-NUM-MVPL IN SEG-FLD TO FEC-MEC1.
           MOVE POL-NUM-DVPL IN SEG-FLD TO FEC-DEC1.
      *Fecha vencimiento
           MOVE POL-NUM-STPL IN SEG-FLD TO FEC-SEC2.
           MOVE POL-NUM-ATPL IN SEG-FLD TO FEC-AEC2.
           MOVE POL-NUM-MTPL IN SEG-FLD TO FEC-MEC2.
           MOVE POL-NUM-DTPL IN SEG-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'VTO<=VIG' TO MSG-COD-MENS
               GO TO ERR-VAL-FEC-FVTS.

           IF NOT (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')
               GO TO FIN-VAL-POL-FEC-FTPL.
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.
           MOVE 'PRD'        TO TAB-COD-TTAB IN TAB.
           MOVE 'FECVIGVTO'  TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
               MOVE 'BGL'            TO MSG-COD-SIST
               MOVE 'TABPRDVIGVTO'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC     TO FRM-MENS
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-POL-FEC-FTPL.
           MOVE TAB-GLS-DATA IN TAB  TO WSS-PER-PERI IN WSS-VARI.
           IF WSS-GLS-CANT IS NOT NUMERIC
               MOVE 'BGL'            TO MSG-COD-SIST
               MOVE 'CANTPRDNONUM'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC     TO FRM-MENS
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-POL-FEC-FTPL.
           IF WSS-GLS-PERI = 'M'
               MOVE POL-NUM-DVPL IN SEG-FLD TO FEC-DEC1
               MOVE POL-NUM-MVPL IN SEG-FLD TO FEC-MEC1
               MOVE POL-NUM-SVPL IN SEG-FLD TO FEC-SEC1
               MOVE POL-NUM-AVPL IN SEG-FLD TO FEC-AEC1
               MOVE POL-NUM-DTPL IN SEG-FLD TO FEC-DEC2
               MOVE POL-NUM-MTPL IN SEG-FLD TO FEC-MEC2
               MOVE POL-NUM-STPL IN SEG-FLD TO FEC-SEC2
               MOVE POL-NUM-ATPL IN SEG-FLD TO FEC-AEC2
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-DIF-MES             TO FEC-CMND
               PERFORM CAL-FEC
               IF (FEC-NDIA > ZEROES )
                   ADD 1 TO FEC-NMES
           END-IF
               IF FEC-NMES NOT > WSS-GLS-CANT IN WSS-VARI
                   GO TO FIN-VAL-POL-FEC-FTPL
               ELSE
                   MOVE 'BGL'            TO MSG-COD-SIST
                   MOVE 'DIFANONOVALI'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC     TO FRM-MENS
                   MOVE FRM-SUAR-MAL     TO FRM-SUAR
                   GO TO FIN-VAL-POL-FEC-FTPL
           ELSE
               MOVE 'BGL'            TO MSG-COD-SIST
               MOVE 'TIPOPRDNOVAL'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC     TO FRM-MENS
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-POL-FEC-FTPL.

           GO TO FIN-VAL-POL-FEC-FTPL.
       ERR-VAL-FEC-FVTS.
           MOVE 'BGL'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.


      *>>>>
*% END
*% IF POL_FEC_FTPL
      *<<<<
           MOVE POL-FEC-FTPL IN SEG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GSE_FEC_VTO_SEG
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-FBLK-S TO FEC-FBLK.

           MOVE POL-NUM-STPL IN SEG-FLD TO FEC-SEC2.
           MOVE POL-NUM-ATPL IN SEG-FLD TO FEC-AEC2.
           MOVE POL-NUM-MTPL IN SEG-FLD TO FEC-MEC2.
           MOVE POL-NUM-DTPL IN SEG-FLD TO FEC-DEC2.
           GO TO FIN-POL-FEC-FTPL.     
      *>>>>
*% END
*% IF GSE_FEC_VTO_SEG
      *<<<< GSE_FEC_VTO_SEG                                             
      *Fecha vigencia                                               
           MOVE POL-NUM-SVPL IN SEG-FLD TO FEC-SEC1.                    
           MOVE POL-NUM-AVPL IN SEG-FLD TO FEC-AEC1.                    
           MOVE POL-NUM-MVPL IN SEG-FLD TO FEC-MEC1.                    
           MOVE POL-NUM-DVPL IN SEG-FLD TO FEC-DEC1.                    
      *Fecha vencimiento                                                
           MOVE POL-NUM-STPL IN SEG-FLD TO FEC-SEC2.                    
           MOVE POL-NUM-ATPL IN SEG-FLD TO FEC-AEC2.                    
           MOVE POL-NUM-MTPL IN SEG-FLD TO FEC-MEC2.                    
           MOVE POL-NUM-DTPL IN SEG-FLD TO FEC-DEC2.                    
                                                                        
           MOVE FEC-FORM-FEC TO FEC-FORM.                            
           MOVE FEC-CMP-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-LES                                          
               MOVE 'VTO<=VIG' TO MSG-COD-MENS                          
               GO TO ERR-VAL-FEC-FVTS.                                  
                                                                        
           IF NOT (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')                
               GO TO FIN-VAL-POL-FEC-FTPL.                              
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'PRD'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'FECVIGVTO'  TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')          
               MOVE 'BGL'            TO MSG-COD-SIST                    
               MOVE 'TABPRDVIGVTO'   TO MSG-COD-MENS                    
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC     TO FRM-MENS                        
               MOVE FRM-SUAR-MAL     TO FRM-SUAR                        
               GO TO FIN-VAL-POL-FEC-FTPL.                              
           MOVE TAB-GLS-DATA IN TAB  TO WSS-PER-PERI IN WSS-VARI.       
           IF WSS-GLS-CANT IS NOT NUMERIC                               
               MOVE 'BGL'            TO MSG-COD-SIST                    
               MOVE 'CANTPRDNONUM'   TO MSG-COD-MENS                    
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC     TO FRM-MENS                        
               MOVE FRM-SUAR-MAL     TO FRM-SUAR                        
               GO TO FIN-VAL-POL-FEC-FTPL.                              
           IF WSS-GLS-PERI = 'M'                                        
               MOVE POL-NUM-DVPL IN SEG-FLD TO FEC-DEC1                 
               MOVE POL-NUM-MVPL IN SEG-FLD TO FEC-MEC1                 
               MOVE POL-NUM-SVPL IN SEG-FLD TO FEC-SEC1                 
               MOVE POL-NUM-AVPL IN SEG-FLD TO FEC-AEC1                 
               MOVE POL-NUM-DTPL IN SEG-FLD TO FEC-DEC2                 
               MOVE POL-NUM-MTPL IN SEG-FLD TO FEC-MEC2                 
               MOVE POL-NUM-STPL IN SEG-FLD TO FEC-SEC2                 
               MOVE POL-NUM-ATPL IN SEG-FLD TO FEC-AEC2                 
               MOVE FEC-FORM-FEC            TO FEC-FORM                 
               MOVE FEC-DIF-MES             TO FEC-CMND                 
               PERFORM CAL-FEC                                          
               IF (FEC-NDIA > ZEROES )                                  
                   ADD 1 TO FEC-NMES                                    
           END-IF                                                       
               IF FEC-NMES NOT > WSS-GLS-CANT IN WSS-VARI               
                   GO TO FIN-VAL-POL-FEC-FTPL                           
               ELSE                                                     
                   MOVE 'BGL'            TO MSG-COD-SIST                
                   MOVE 'DIFANONOVALI'   TO MSG-COD-MENS                
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC     TO FRM-MENS                    
                   MOVE FRM-SUAR-MAL     TO FRM-SUAR                    
                   GO TO FIN-VAL-POL-FEC-FTPL                           
           ELSE                                                         
               MOVE 'BGL'            TO MSG-COD-SIST                    
               MOVE 'TIPOPRDNOVAL'   TO MSG-COD-MENS                    
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC     TO FRM-MENS                        
               MOVE FRM-SUAR-MAL     TO FRM-SUAR                        
               GO TO FIN-VAL-POL-FEC-FTPL.                              
                                                                        
           GO TO FIN-VAL-POL-FEC-FTPL.       
      ERR-VAL-FEC-FVTS.                                                
           MOVE 'BGL'     TO MSG-COD-SIST.                              
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                     
           MOVE FRM-SUAR-MAL TO FRM-SUAR.                               
                                                                        
                                                                        
      *>>>>                                                             
*% END
*% IF INI_GSE_FEC_VTO_SEG
      *<<<< INI_GSE_FEC_VTO_SEG                                         
           MOVE FEC-CHOY-GE TO FEC-CHOY.                                
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
           MOVE FEC-FBLK-S TO FEC-FBLK.                                 
                                                                        
           MOVE POL-NUM-STPL IN SEG-FLD TO FEC-SEC2.                    
           MOVE POL-NUM-ATPL IN SEG-FLD TO FEC-AEC2.                    
           MOVE POL-NUM-MTPL IN SEG-FLD TO FEC-MEC2.                    
           MOVE POL-NUM-DTPL IN SEG-FLD TO FEC-DEC2.                    
      *>>>>                                                             
*% END
*% IF FIN_POL_COD_VCAM
      *<<<<
      *MAE                                                              
           IF SCR-CMND NOT = 'INE'                                      
              GO TO FIN-VAL-POL-COD-VCAM.                               
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.                          
           MOVE POL-COD-VCAM IN SEG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-VCAM IN SEG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-VCAM IN SEG-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-VCAM IN SEG-FLD.                            
      *MAE                                                              
      *>>>>
*% END
*% IF INI_POL_VAL_PRIN
      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND                                      
              POL-VAL-PRIN IN SEG-FLD NOT > ZEROES                      
              PERFORM ERR-GLS.                                          
      *MAE                                                              
      *>>>>
*% END
*% IF INI_POL_VAL_PRIB
      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND                                      
              POL-VAL-PRIB IN SEG-FLD NOT > ZEROES                      
              PERFORM ERR-GLS.                                          
      *MAE                                                              
      *>>>>
*% END
*% IF INI_POL_NUM_ENDS
      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND                                      
              POL-NUM-ENDS IN SEG-FLD NOT > ZEROES                      
              PERFORM ERR-GLS.                                          
      *MAE                                                              
      *>>>>
*% END
*% IF FIN_POL_COD_SEGU
      *<<<< FIN-VAL-POL-COD-SEGU
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'RSE ' TO TAB-COD-TTAB IN TAB.                          
           MOVE POL-COD-SEGU IN SEG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-SEGU IN SEG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-SEGU IN SEG-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-SEGU IN SEG-FLD.               
      *>>>>
*% END
*% IF FIN_POL_COD_EPRO
      *<<<< FIN-VAL-POL-COD-EPRO
      *MAE                                                              
           IF SCR-CMND = 'INE'                                          
              MOVE '01'   TO POL-COD-EPRO IN SEG-FLD                    
              GO TO VAL-COD-EPRO.                                       
      *MAE                                                              

           MOVE POL-CAI-GTIA IN SEG-FLD TO POL-CAI-GTIA IN POL.         
           MOVE POL-IIC-GTIA IN SEG-FLD TO POL-IIC-GTIA IN POL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-POL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-VAL-POL-COD-EPRO.                               
                                                                        
           IF POL-COD-EPRO IN POL = '01'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '01' OR                 
                      POL-COD-EPRO IN SEG-FLD = '02')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '02'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '02' OR                 
                      POL-COD-EPRO IN SEG-FLD = '03' OR                 
                      POL-COD-EPRO IN SEG-FLD = '11')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '03'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '03' OR                 
                      POL-COD-EPRO IN SEG-FLD = '04' OR                 
                      POL-COD-EPRO IN SEG-FLD = '06')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '04'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '04' OR                 
                      POL-COD-EPRO IN SEG-FLD = '05')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '05'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '05' OR                 
                      POL-COD-EPRO IN SEG-FLD = '06')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '06'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '06' OR                 
                      POL-COD-EPRO IN SEG-FLD = '07')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '13'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '13' OR                 
                      POL-COD-EPRO IN SEG-FLD = '07')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '11'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '11' OR                 
                      POL-COD-EPRO IN SEG-FLD = '12')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '12'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '12' OR                 
                      POL-COD-EPRO IN SEG-FLD = '13')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        

           IF (POL-COD-EPRO IN POL = '07' AND                          
               POL-COD-EPRO IN SEG-FLD NOT = '07')                     
                  MOVE 'BGL'            TO MSG-COD-SIST                
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                
                  PERFORM GET-MSG                                      
                  MOVE MSG-GLS-DESC TO FRM-MENS                        
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
      *MAE                                                              
       VAL-COD-EPRO.                                                    
      *MAE                                                              
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'ESP ' TO TAB-COD-TTAB IN TAB.                          
           MOVE POL-COD-EPRO IN SEG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-EPRO IN SEG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-EPRO IN SEG-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-EPRO IN SEG-FLD.                            
                                                                        
           IF POL-COD-EPRO IN SEG-FLD NOT > ZEROES                      
              MOVE ZEROES TO POL-COD-EPRO IN SEG-FLD.                   
      *>>>>
*% END
*% IF INI_DBC_GLS_ICLI
      *<<<< INI_VAL_DBC_GLS_ICLI
           IF DBC-GLS-ICLI IN SEG-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN SEG-FLD.
           GO TO FIN-VAL-DBC-GLS-ICLI.
      *>>>>
*% END
