*%! Codigo adicional para archivo
*% FRM = 'PXI'
*% VSNBQ = "06.06.29"
*% FNCBQ = "OWFBGL"
*% VSNBU = "06.06.29"
*% FNCBU = "OWFBGL"
*% IF FIN_PUT_GDG_PXI
      *<<<< FIN_PUT_GDG_PXI

           MOVE ZEROES TO WSS-OPIN, WSS-OPXI.
           MOVE SPACES TO FRM-GLS-AUXI IN PXI-FLD.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDG' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDGNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
           ADD 1 TO WSS-OPIN.
           MOVE MNU-COD-OPCI IN MNU TO FRM-COD-OPIN 
                                                 IN PXI-FLD(WSS-OPIN).
           MOVE MNU-GLS-FMEN IN MNU TO FRM-GLS-PING 
                                                 IN PXI-FLD(WSS-OPIN).

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDD' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDDNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE '00' TO PGM-STAT-DBC.
      *CGL-INI                                                          
      *    MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDD.               
      *    MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDD.               
      *    MOVE 'GAR-CLV-GDD-2' TO FIO-AKEY.                            
           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.             
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
      *CGL-FIN                                                          
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GDD.
      *CGL-INI                                                          
      *     IF NOT ( FIO-STAT-OKS AND                                   
      *              GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GDD AND        
      *              GAR-COD-CRR IN GDG = GAR-COD-CRR IN GDD )          
           IF NOT ( FIO-STAT-OKS AND
                     GDG-CAI-GTIA IN GDG = GDD-CAI-GTIA IN GDD AND      
                     GDG-IIC-GTIA IN GDG = GDD-IIC-GTIA IN GDD )        
      *CGL-FIN                                                          
               MOVE '23' TO PGM-STAT-DBC
               MOVE '23' TO FIO-STAT.
           MOVE 'S' TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      *    Busca DBC
           IF PGM-STAT-DBC NOT = '23'
               MOVE GDD-CIC-DCLI IN GDD TO DBC-KEY-IDBC IN DBC            
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GVT' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGVTNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
      *CGL-INI                                                          
      *    MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GVT.               
      *    MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GVT.               
      *    MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GVT.               
           MOVE GDG-CAI-GTIA IN GDG TO GVT-CAI-GTIA IN GVT.             
           MOVE GDG-IIC-GTIA IN GDG TO GVT-IIC-GTIA IN GVT.             
           MOVE GDG-COD-TSCN IN GDG TO GVT-COD-TASN IN GVT.             
      *CGL-FIN                                                          
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GVT.
           MOVE 'S' TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GAP' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGAPNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
      *CGL-INI                                                          
      *      IF GAR-COD-GRA IN GDG > '1'                                
      *         MOVE 'S' TO GAR-IND-EXG-GAP IN TAG                      
      *     ELSE                                                        
      *         MOVE 'N' TO GAR-IND-EXG-GAP IN TAG.                     

           MOVE 'S' TO TAG-IND-EGAP IN TAG.     

      *    MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GAP.               
      *    MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GAP.               
      *    MOVE ZEROES             TO GAR-COD-PRD-ACR IN GAP.           
           MOVE GDG-CAI-GTIA IN GDG TO GAP-CAI-GTIA IN GAP.             
           MOVE GDG-IIC-GTIA IN GDG TO GAP-IIC-GTIA IN GAP.             
           MOVE ZEROES TO GAP-COD-PACR IN GAP.                          
      *CGL-FIN                                                          
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GAP.
      *CGL-INI                                                          
      *     IF NOT ( FIO-STAT-OKS AND                                   
      *              GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GAP AND        
      *              GAR-COD-CRR IN GDG = GAR-COD-CRR IN GAP )          
            IF NOT (FIO-STAT-OKS AND                                    
                    GDG-CAI-GTIA IN GDG = GAP-CAI-GTIA IN GAP AND       
                    GDG-IIC-GTIA IN GDG = GAP-IIC-GTIA IN GAP)          
      *CGL-FIN                                                          
                     MOVE '23' TO FIO-STAT.
      *CGL-INI                                                          
           MOVE TAG-IND-EGAP IN TAG TO WSS-IND-EXIG.                    
      *     MOVE GAR-IND-EXG-GAP IN TAG TO WSS-IND-EXIG.                
      *CGL-FIN            
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDO' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDONEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
      *CGL-INI                                                          
      *     MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDO.              
      *     MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDO.              
           MOVE GDG-CAI-GTIA IN GDG TO GDO-CAI-GTIA IN GDO.             
           MOVE GDG-IIC-GTIA IN GDG TO GDO-IIC-GTIA IN GDO.             
      *CGL-FIN                                                          
      *MHM-INI 03-DIC-2003                                              
      *     MOVE FIO-GET-KEY TO FIO-CMND.                               
           MOVE ZEROES TO GDO-NUM-IGDO IN GDO.                          
           MOVE FIO-GET-NLS TO FIO-CMND.                                
      *MHM-FIN 03-DIC-2003         
           PERFORM BGL-FIO-GDO.
      *MHM-INI 03-DIC-2003                                              
           IF NOT ( FIO-STAT-OKS AND                                    
                    GDG-CAI-GTIA IN GDG = GDO-CAI-GTIA IN GDO AND       
                    GDG-IIC-GTIA IN GDG = GDO-IIC-GTIA IN GDO )         
               MOVE '23' TO FIO-STAT.                                   
      *MHM-FIN 03-DIC-2003                                              
      *CGL-INI                                                          
           MOVE TAG-IND-EGDO IN TAG TO WSS-IND-EXIG.                    
      *     MOVE GAR-IND-EXG-GDO IN TAG TO WSS-IND-EXIG.                
      *CGL-FIN 
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDP' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDPNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
      *CGL-INI                                                          
      *     MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDP.              
      *     MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDP.              
           MOVE GDG-CAI-GTIA IN GDG TO GDP-CAI-GTIA IN GDP.             
           MOVE GDG-IIC-GTIA IN GDG TO GDP-IIC-GTIA IN GDP.             
      *CGL-FIN            
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDP.
      *CGL-INI                                                          
      *     MOVE GAR-IND-EXG-GDP IN TAG TO WSS-IND-EXIG.                
           MOVE TAG-IND-EGDP IN TAG TO WSS-IND-EXIG.                    
      *CGL-FIN   
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GES' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGESNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
      *CGL-INI                                                          
      *     IF GAR-COD-LIM  IN GDG = 'E'                                
      *         MOVE 'S' TO GAR-IND-EXG-GES IN TAG                      
      *     ELSE                                                        
      *         MOVE 'N' TO GAR-IND-EXG-GES IN TAG.                     
            IF GDG-COD-LGTA IN GDG = 'E'                                
               MOVE 'S' TO TAG-IND-EGES IN TAG                          
            ELSE                                                        
               MOVE 'N' TO TAG-IND-EGES IN TAG.                         
                                                                        
      *     MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GES.              
      *     MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GES.              
      *     MOVE ZEROES             TO GAR-COD-ESP IN GES.              
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.             
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.             
           MOVE ZEROES TO GES-NUM-IGES IN GES.                          
      *CGL-FIN        
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GES.
      *CGL-INI                                                          
      *     IF NOT ( FIO-STAT-OKS AND                                   
      *              GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GES AND        
      *              GAR-COD-CRR IN GDG = GAR-COD-CRR IN GES )          
            IF NOT ( FIO-STAT-OKS AND                                   
                     GDG-CAI-GTIA IN GDG = GES-CAI-GTIA IN GES AND      
                     GDG-IIC-GTIA IN GDG = GES-IIC-GTIA IN GES )        
      *CGL-FIN                                                          
               MOVE '23' TO FIO-STAT.                                   
      *CGL-INI                                                          
           MOVE TAG-IND-EGES IN TAG TO WSS-IND-EXIG.                    
      *     MOVE GAR-IND-EXG-GES IN TAG TO WSS-IND-EXIG.                
      *CGL-FIN              
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GIN' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGINNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
      *CGL-INI                                                          
      *    IF GAR-IND-OBL-INS IN GDG = 'S'                              
      *        MOVE 'S' TO GAR-IND-EXG-GIN IN TAG                       
      *    ELSE                                                         
      *        MOVE 'N' TO GAR-IND-EXG-GIN IN TAG.                      
                                                                        
            IF GDG-IND-INOB IN GDG = 'S'                                
               MOVE 'S' TO TAG-IND-EGIN IN TAG                          
            ELSE                                                        
               MOVE 'N' TO TAG-IND-EGIN IN TAG.                         
      	
      *CGL-INI                                                          
      *     MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GIN.              
      *     MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GIN.              
      *     MOVE FIO-GET-KEY TO FIO-CMND.                               
           MOVE GDG-CAI-GTIA IN GDG TO GIN-CAI-GTIA IN GIN.             
           MOVE GDG-IIC-GTIA IN GDG TO GIN-IIC-GTIA IN GIN.             
           MOVE ZEROES TO GIN-NUM-IGIN IN GIN.                          
           MOVE FIO-GET-NLS TO FIO-CMND.                                
      *CGL-FIN                                                          
           PERFORM BGL-FIO-GIN.                                         
      *MHM-INI 03-DIC-2003                                              
           IF NOT ( FIO-STAT-OKS AND                                    
                    GDG-CAI-GTIA IN GDG = GIN-CAI-GTIA IN GIN AND       
                    GDG-IIC-GTIA IN GDG = GIN-IIC-GTIA IN GIN )         
               MOVE '23' TO FIO-STAT.                                   
      *MHM-FIN 03-DIC-2003                                              
      *CGL-INI                                                          
           MOVE TAG-IND-EGIN IN TAG TO WSS-IND-EXIG.                    
      *      MOVE GAR-IND-EXG-GIN IN TAG TO WSS-IND-EXIG.                 
      *CGL-FIN    
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GLE' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGLENEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
     *CGL-INI                                                          
      *    MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GLE.               
      *    MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GLE.               
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
           MOVE GDG-CAI-GTIA IN GDG TO GLE-CAI-GTIA IN GLE.             
           MOVE GDG-IIC-GTIA IN GDG TO GLE-IIC-GTIA IN GLE.             
           MOVE SPACES TO GLE-COD-PACR IN GLE.                          
           MOVE FIO-GET-NLS TO FIO-CMND.         
      *CGL-FIN                                                          
           PERFORM BGL-FIO-GLE.                                         
      *MHM-INI 03-DIC-2003                                              
           IF NOT ( FIO-STAT-OKS AND                                    
                    GDG-CAI-GTIA IN GDG = GLE-CAI-GTIA IN GLE AND       
                    GDG-IIC-GTIA IN GDG = GLE-IIC-GTIA IN GLE )         
               MOVE '23' TO FIO-STAT.                                   
      *MHM-FIN 03-DIC-2003                                              
      *CGL-INI                                                          
           MOVE TAG-IND-EGLE IN TAG TO WSS-IND-EXIG.                    
      *    MOVE GAR-IND-EXG-GLE IN TAG TO WSS-IND-EXIG.                 
      *CGL-FIN                                          
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GSE' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGSENEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
      *CGL-INI                                                          
      *     MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GSE.              
      *     MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GSE.              
      *     MOVE FIO-GET-KEY TO FIO-CMND.                               
           MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE.             
           MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE.             
           MOVE ZEROES TO GSE-NUM-IGSE IN GSE.                          
           MOVE FIO-GET-NLS TO FIO-CMND.                                
      *CGL-FIN                                                          
           PERFORM BGL-FIO-GSE.                                         
      *MHM-INI 03-DIC-2003                                              
           IF NOT ( FIO-STAT-OKS AND                                    
                    GDG-CAI-GTIA IN GDG = GSE-CAI-GTIA IN GSE AND       
                    GDG-IIC-GTIA IN GDG = GSE-IIC-GTIA IN GSE )         
               MOVE '23' TO FIO-STAT.                                   
      *MHM-FIN 03-DIC-2003                                              
      *CGL-INI                                                          
      *     MOVE GAR-IND-EXG-GSE IN TAG TO WSS-IND-EXIG.                
           MOVE TAG-IND-EGSE IN TAG TO WSS-IND-EXIG.                    
      *CGL-FIN                                                          
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GSI' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGSINEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
 *CGL-INI                                                          
      *     MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GSI.              
      *     MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GSI.              
      *     MOVE FIO-GET-KEY TO FIO-CMND.                               
           MOVE GDG-CAI-GTIA IN GDG TO GSI-CAI-GTIA IN GSI.             
           MOVE GDG-IIC-GTIA IN GDG TO GSI-IIC-GTIA IN GSI.             
           MOVE ZEROES TO GSI-NUM-IGSI IN GSI.                          
           MOVE FIO-GET-NLS TO FIO-CMND.                                
      *CGL-FIN                                                          
           PERFORM BGL-FIO-GSI.                                         
      *MHM-INI 03-DIC-2003                                              
           IF NOT ( FIO-STAT-OKS AND                                    
                    GDG-CAI-GTIA IN GDG = GSI-CAI-GTIA IN GSI AND       
                    GDG-IIC-GTIA IN GDG = GSI-IIC-GTIA IN GSI )         
               MOVE '23' TO FIO-STAT.                                   
      *MHM-FIN 03-DIC-2003                                              
      *CGL-INI                                                          
      *     MOVE GAR-IND-EXG-GSI IN TAG TO WSS-IND-EXIG.                
           MOVE TAG-IND-EGSI IN TAG TO WSS-IND-EXIG.                    
      *CGL-FIN                                                          
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GTP' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGTPNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
      *CGL-INI                                                          
      *     MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GTP.              
      *     MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GTP.              
      *     MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GTP.              
      *     MOVE ZEROES             TO GAR-COD-ITM-TSN IN GTP.          
           MOVE GDG-CAI-GTIA IN GDG TO GTP-CAI-GTIA IN GTP.             
           MOVE GDG-IIC-GTIA IN GDG TO GTP-IIC-GTIA IN GTP.             
           MOVE GDG-COD-TSCN IN GDG TO GTP-NUM-ITSN IN GTP.             
           MOVE ZEROES TO GTP-COD-ITSN IN GTP.                          
      *CGL-FIN                                                          
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GTP.                                         
      *CGL-INI                                                          
      *     IF NOT ( FIO-STAT-OKS AND                                   
      *              GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GTP AND        
      *              GAR-COD-CRR IN GDG = GAR-COD-CRR IN GTP AND        
      *              GAR-COD-TSN IN GDG = GAR-COD-TSN IN GTP            
      *            )                                                    
           IF NOT ( FIO-STAT-OKS AND                                    
                    GDG-CAI-GTIA IN GDG = GTP-CAI-GTIA IN GTP AND       
                    GDG-IIC-GTIA IN GDG = GTP-IIC-GTIA IN GTP AND       
                    GDG-COD-TSCN IN GDG = GTP-NUM-ITSN IN GTP           
                  )                                                     
      *CGL-FIN                                                          
               MOVE '23' TO FIO-STAT.                                   
      *CGL-INI                                                          
      *     MOVE GAR-IND-EXG-GTP IN TAG TO WSS-IND-EXIG.                
           MOVE TAG-IND-EGTP IN TAG TO WSS-IND-EXIG.                    
      *CGL-FIN                                                          
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GUB' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGUBNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
      *CGL-INI                                                          
      *     MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GUB.              
      *     MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GUB.              
           MOVE GDG-CAI-GTIA IN GDG TO GUB-CAI-GTIA IN GUB.             
           MOVE GDG-IIC-GTIA IN GDG TO GUB-IIC-GTIA IN GUB.             
      *CGL-FIN                                                          
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GUB.                                         
      *CGL-INI                                                          
      *     MOVE GAR-IND-EXG-GUB IN TAG TO WSS-IND-EXIG.                
           MOVE TAG-IND-EGUB IN TAG TO WSS-IND-EXIG.                    
      *CGL-FIN                                                          
           PERFORM DIS-FMEN.
    
      *MHM-INI 05-DIC-2003                                              
      * Obtiene Opcion y NEMO de MNU                                    
           MOVE 'GIM' TO TAB-CIC-CTAB IN TAB.                           
           MOVE 'CICGIMNEX' TO MSG-COD-MENS.                            
           PERFORM BUS-OPC-MNU.                                         
           IF MSG-COD-MENS > SPACES                                     
               GO TO ERR-PUT-GDG-PXI.                                   
           MOVE GDG-CAI-GTIA IN GDG TO GIM-CAI-GTIA IN GIM.             
           MOVE GDG-IIC-GTIA IN GDG TO GIM-IIC-GTIA IN GIM.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GIM.                                         
           MOVE TAG-IND-EGIM IN TAG TO WSS-IND-EXIG.                    
           PERFORM DIS-FMEN.                                            
                                                                        
      * Obtiene Opcion y NEMO de MNU                                    
           MOVE 'GVE' TO TAB-CIC-CTAB IN TAB.                           
           MOVE 'CICGVENEX' TO MSG-COD-MENS.                            
           PERFORM BUS-OPC-MNU.                                         
           IF MSG-COD-MENS > SPACES                                     
               GO TO ERR-PUT-GDG-PXI.                                   
           MOVE GDG-CAI-GTIA IN GDG TO GVE-CAI-GTIA IN GVE.             
           MOVE GDG-IIC-GTIA IN GDG TO GVE-IIC-GTIA IN GVE.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GVE.                                         
           MOVE TAG-IND-EGVE IN TAG TO WSS-IND-EXIG.                    
           PERFORM DIS-FMEN.                                            
      *MHM-FIN 05-DIC-2003                                              
    
      * Limpia COD-NEMO no desplegados
               MOVE WSS-OPXI TO FRM-IFLD.
               PERFORM LIM-RES-LIN UNTIL FRM-IFLD > WSS-IMAX.

           GO TO FIN-PUT-GDG-PXI.
       ERR-PUT-GDG-PXI.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_PUT_DBC_{FRM}
      *<<<< FIN_PUT_DBC_{FRM}
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN {FRM}-FLD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-OPC-MNU SECTION.
       INI-BUS-OPC-MNU.
           MOVE 'BGL'          TO FIO-SIST.
           MOVE 'PXI'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL' TO MSG-COD-SIST
               GO TO FIN-BUS-OPC-MNU.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE TAB-COD-CTAB IN TAB TO MNU-COD-OPCI IN MNU.
           MOVE 'BGL' TO FIO-SIST.
           MOVE 'MNU-COD-OPCI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MNU.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'MNU    NEX' TO MSG-COD-MENS
               GO TO FIN-BUS-OPC-MNU.
       FIN-BUS-OPC-MNU.
           EXIT.

       DIS-FMEN SECTION.
       INI-DIS-FMEN.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-OPIN
               MOVE MNU-COD-OPCI IN MNU TO FRM-COD-OPIN 
                                                 IN PXI-FLD(WSS-OPIN)
               MOVE MNU-GLS-FMEN IN MNU TO FRM-GLS-PING 
                                                 IN PXI-FLD(WSS-OPIN)
           ELSE
               IF WSS-IND-EXIG = 'S'
                   ADD 1 TO WSS-OPXI
                   MOVE MNU-COD-OPCI IN MNU TO FRM-COD-OPXI 
                                                 IN PXI-FLD(WSS-OPXI)
                   MOVE MNU-GLS-FMEN IN MNU TO FRM-GLS-PXIN
                                                 IN PXI-FLD(WSS-OPXI)
                   MOVE MNU-COD-NEMO IN MNU TO FRM-COD-NEMO
                                                 IN PXI-FLD(WSS-OPXI).
       FIN-DIS-FMEN.
           EXIT.

       LIM-RES-LIN SECTION.
       INI-LIM-RES-LIN.
           IF FRM-IFLD > WSS-OPXI
                MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(FRM-IFLD)
                MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(FRM-IFLD)
                MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(FRM-IFLD).
           ADD 1 TO FRM-IFLD.
       FIN-LIM-RES-LIN.
           EXIT.
      *>>>>
*% END
