*%! Codigo adicional para archivo
*% IF FIN_PUT_TAS_TAS
      *<<<< FIN_PUT_TAS_TAS
      *>>>>
*% END
*% IF INI_FST_FLD_TAS
      *<<<< INI_FST_FLD_TAS
           IF NOT SCR-CMND = 'ING'
              MOVE -1 TO TAS-IND-ESTA-LEN IN TAS-FLD.
           GO TO FIN-FST-FLD-TAS.
      *>>>>
*% END
*% IF FIN_UNP_TAS_TAS
      *<<<< FIN_UNP_TAS_TAS
           IF SCR-CMND = 'ING'
               MOVE FRM-CPIM-AEY TO TAS-IND-ESTA-ATR IN TAS-FLD.
      *>>>>
*% END
*% IF FIN_PUT_GDG_TAS
      *<<<< FIN_PUT_GDG_TAS
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN TAS-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN TAS-FLD TO TAG-STP-AGTA IN TAG.
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.
      
           IF GDG-TIP-CGTA IN TAS-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN TAS-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
      
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN TAS-FLD.
      
           IF SCR-CMND = 'ING '
               MOVE '11'                  TO TAS-IND-ESTA IN TAS-FLD
      
               MOVE GVT-NUM-STSN IN GVT   TO TAS-NUM-STSN IN TAS-FLD
               MOVE GVT-NUM-ATSN IN GVT   TO TAS-NUM-ATSN IN TAS-FLD
               MOVE GVT-NUM-MTSN IN GVT   TO TAS-NUM-MTSN IN TAS-FLD
               MOVE GVT-NUM-DTSN IN GVT   TO TAS-NUM-DTSN IN TAS-FLD
      
               MOVE GVT-SGV-VCTS IN GVT   TO TAS-VAL-MNTO IN TAS-FLD
      
               MOVE GDG-NUM-SVET IN GDG   TO TAS-NUM-SVEX IN TAS-FLD
               MOVE GDG-NUM-AVET IN GDG   TO TAS-NUM-AVEX IN TAS-FLD
               MOVE GDG-NUM-MVET IN GDG   TO TAS-NUM-MVEX IN TAS-FLD
               MOVE GDG-NUM-DVET IN GDG   TO TAS-NUM-DVEX IN TAS-FLD
      
               MOVE 'DEBEN SER RETASADAS' TO TAS-GLS-EXCE IN TAS-FLD.
      
      
      *BUS-TAB busca glosa de codigo en tabla
           IF TAS-IND-ESTA IN TAS-FLD > SPACES
               MOVE 'BGL' TO TAB-COD-SIST
               MOVE 'EST' TO TAB-COD-TTAB IN TAB
               MOVE TAS-IND-ESTA IN TAS-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ESTA IN TAS-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ESTA IN TAS-FLD.
      *>>>>
*% END
*% IF FIN_RET_TAS_TAS
      *<<<< FIN_RET_TAS_TAS
           MOVE GDG-TIP-CGTA IN TAS-FLD TO TAS-COD-TOPE IN TAS.
           MOVE GDG-STP-CGTA IN TAS-FLD TO TAS-COD-SOPE IN TAS.
      *>>>>
*% END
*% IF TAS_IND_ESTA
      *<<<< TAS_IND_ESTA
           MOVE TAS-CAI-GTIA IN TAS-FLD TO TAS-CAI-GTIA IN TAS.
           MOVE TAS-IIC-GTIA IN TAS-FLD TO TAS-IIC-GTIA IN TAS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-TAS.
           IF NOT FIO-STAT-OKS
              GO TO FIN-VAL-TAS-IND-ESTA.
      
           PERFORM LEE-GSO.
      
           IF SCR-CMND = 'MOD' AND
              CMA-IND-LGSO IN CMA-VARI = 'S'
      
              IF TAS-IND-ESTA IN TAS = '11'
                 IF NOT (TAS-IND-ESTA IN TAS-FLD = '11' OR
                    TAS-IND-ESTA IN TAS-FLD = '09')
                    MOVE 'BGL' TO MSG-COD-SIST
                    MOVE 'MODNOPERMITI' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                 ELSE
                    GO TO NXT-VAL-TAS-IND-ESTA
                 END-IF
              ELSE
      
                 IF TAS-IND-ESTA IN TAS = '09'
                    IF NOT (TAS-IND-ESTA IN TAS-FLD = '09' OR
                       TAS-IND-ESTA IN TAS-FLD = '13')
                       MOVE 'BGL' TO MSG-COD-SIST
                       MOVE 'MODNOPERMITI' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                    ELSE
                       GO TO NXT-VAL-TAS-IND-ESTA
                    END-IF
                  ELSE
      
                    IF TAS-IND-ESTA IN TAS = '13'
                       IF NOT (TAS-IND-ESTA IN TAS-FLD = '13' OR
                          TAS-IND-ESTA IN TAS-FLD = '14')
                           MOVE 'BGL' TO MSG-COD-SIST
                           MOVE 'MODNOPERMITI' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                    ELSE
                       GO TO NXT-VAL-TAS-IND-ESTA
                    END-IF
                  END-IF
              END-IF
           END-IF.
      
           IF SCR-CMND = 'MOD' AND
              CMA-IND-LGSO IN CMA-VARI = 'N'
      
              IF  TAS-IND-ESTA IN TAS = '11'
                  IF NOT (TAS-IND-ESTA IN TAS-FLD = '11' OR
                     TAS-IND-ESTA IN TAS-FLD = '12' OR
      *EVA-AFRI/AGOST2007
                     TAS-IND-ESTA IN TAS-FLD = '09')
      *FIN-AFRI/AGOST2007
                     MOVE 'BGL'            TO MSG-COD-SIST
                     MOVE 'EST INVALIDO'   TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                  ELSE
                     NEXT SENTENCE
              ELSE
              IF TAS-IND-ESTA IN TAS = '12'
                 IF NOT (TAS-IND-ESTA IN TAS-FLD = '12' OR
                      TAS-IND-ESTA IN TAS-FLD = '11')
                      MOVE 'BGL'            TO MSG-COD-SIST
                      MOVE 'EST INVALIDO'   TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
      *EVA-AFRI/AGOST2007
              ELSE
              IF TAS-IND-ESTA IN TAS = '09'
                 IF (TAS-IND-ESTA IN TAS-FLD = '11' OR
                     TAS-IND-ESTA IN TAS-FLD = '12')
                      MOVE 'BGL'            TO MSG-COD-SIST
                      MOVE 'EST INVALIDO'   TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *FIN-AFRI/AGOST2007
       NXT-VAL-TAS-IND-ESTA.
      *>>>>
*% END
*% IF INI_TAS_GLS_EXCE
      *<<<< INI_TAS_GLS_EXCE
            IF TAS-IND-ESTA IN TAS-FLD = '11'
               MOVE 'DEBEN SER RETASADAS' TO TAS-GLS-EXCE IN TAS-FLD
             ELSE
               IF TAS-IND-ESTA IN TAS-FLD = '12'
                   MOVE 'NO RETASAR'      TO TAS-GLS-EXCE IN TAS-FLD.
      *>>>>
*% END
*% IF EOF AND PGM_BU
      *<<<< EOF
      *EVA-INI/2008
       LEE-GSO SECTION.
       INI-LEE-GSO.
           MOVE ZEROES TO WSS-NUM-MAUX.
           MOVE ZEROES TO WSS-NUM-MGSO.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'N' TO CMA-IND-LGSO IN CMA-VARI.
           MOVE TAS-CAI-GTIA IN TAS-FLD TO GSO-CAI-GTIA IN GSO.
           MOVE TAS-IIC-GTIA IN TAS-FLD TO GSO-IIC-GTIA IN GSO.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-SIG-MOD.
           MOVE 'GSO-KEY-IGDG' TO FIO-AKEY.
           PERFORM BGL-FIO-GSO.
           IF (FIO-STAT-OKS AND
               TAS-CAI-GTIA IN TAS-FLD = GSO-CAI-GTIA IN GSO AND
               TAS-IIC-GTIA IN TAS-FLD = GSO-IIC-GTIA IN GSO)
               MOVE GSO-KEY-IGSO IN GSO TO WSS-KEY-MGSO
               IF WSS-NUM-MGSO > WSS-NUM-MAUX
                  MOVE WSS-NUM-MGSO TO WSS-NUM-MAUX
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-SIG-MOD
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-SIG-MOD.

           MOVE WSS-NUM-MGSO TO GSL-KEY-IGSL IN GSL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GSL.
           IF NOT FIO-STAT-OKS
              GO TO FIN-LEE-GSO.

           IF GSL-COD-TSOL IN GSL = 'R'
               MOVE 'S' TO CMA-IND-LGSO IN CMA-VARI.
       FIN-LEE-GSO.
           EXIT.
      *EVA-FIN/2008
      *>>>>
*% END
