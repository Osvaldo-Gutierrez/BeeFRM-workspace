*%! Codigo adicional para archivo
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% VSNBQ = "06.06.22"
*% FNCBQ = "OWFBGL"
*% VSNBU = "06.06.22"
*% FNCBU = "OWFBGL"
*% IF FIN_FRM_GLS_EJOR
      *<<<< FIN_VAL-GDG-CIC-EJOR
      *>>>> 
*% END
*% IF FIN_UNP_GDG_GDG
      *<<<< FIN_UNP_GDG_GDG
      *
           IF SCR-CMND NOT = 'EJE' AND
              SCR-CMND NOT = 'CAD' AND
              SCR-CMND NOT = 'CAN'
*% IF FMT_CHI
      *<<<< FMT_CHI
              AND SCR-CMND NOT = 'ALZ'
      *>>>> 
*% END      
              MOVE FRM-CPIM-AEY TO GDG-COD-EST1-ATR IN GDG-FLD
              MOVE FRM-CPIM-AEY TO GDG-COD-EST1-STP.
      
           IF SCR-CMND = 'ING'
               MOVE '05'         TO GDG-IND-EST1 IN GDG-FLD
      *
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-ATR IN GDG-FLD
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-STP
      *RRM-INI 31-MAY-2002
              IF GDG-COD-CGTA IN GDG-FLD > 100 AND
                 GDG-COD-CGTA IN GDG-FLD < 130
                  MOVE 'S' TO GDG-IND-INOB IN GDG-FLD
                  MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD
                  MOVE FRM-CPIM-AEY TO GDG-IND-INOB-STP.
      *RRM-INI 27-SEP-2002
      *    IF SCR-CMND = 'MGA'
           IF SCR-CMND NOT = 'MOD' AND SCR-CMND NOT = 'ING'           
      *RRM-INI 28-SEP-2002
                  MOVE FRM-CPIM-AEY TO GDG-COD-UNIC-ATR IN GDG-FLD
                  MOVE FRM-CPIM-AEY TO GDG-COD-UNIC-STP.
      *RRM-FIN 31-MAY-2002
      *>>>>
*% ELSE
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-STP.
*% END    
      *>>>> 
*% END      
*% IF FIN_PUT_GDG_GDG
      *<<<< FIN_PUT_GDG_GDG
*% IF FMT_CHI
      *<<<< FMT_CHI
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-CGTA IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-CGTA IN GDG-FLD TO WSS-TIP-CGTA IN WSS-VARI
               MOVE GDG-STP-CGTA IN GDG-FLD TO WSS-STP-CGTA IN WSS-VARI
               MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GDG-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GDG-FLD.
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GDG-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GDG-FLD.
      *MHM-FIN 23-OCT-2003
      *>>>>
*% ELSE
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-CGTA IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'GTA ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CGTA IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CGTA IN GDG-FLD.
*% END
      *BUS-USR busca usuario en tablas
           IF GDG-CIC-EJOR IN GDG-FLD > SPACES
               MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN GDG-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-EJOR IN GDG-FLD.
      *-------------------------------------------------------------*
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-IND-EST1 IN GDG-FLD > SPACES
             MOVE 'BGL' TO TAB-COD-SIST
             MOVE 'ES1'                   TO TAB-COD-TTAB IN TAB
             MOVE GDG-IND-EST1 IN GDG-FLD TO TAB-COD-CTAB IN TAB
             PERFORM BUS-TAB
             MOVE TAB-COD-DAT2 IN TAB(1) TO WSS-ES1-1 IN CMA-VARI
             MOVE TAB-COD-DAT2 IN TAB(2) TO WSS-ES1-2 IN CMA-VARI
             MOVE TAB-COD-DAT2 IN TAB(3) TO WSS-ES1-3 IN CMA-VARI
             MOVE TAB-COD-DAT2 IN TAB(4) TO WSS-ES1-4 IN CMA-VARI
             MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-IND-EST1 IN GDG-FLD.
      
      
      
           MOVE GDG-IND-EGAP IN GDG TO GAR-IND-EGAP IN CMA-VARI.
           MOVE GDG-IND-GTAC IN GDG TO GAR-IND-GTAC IN CMA-VARI.
           MOVE GDG-COD-EST2 IN GDG TO WSS-ES2-ANT  IN CMA-VARI.
           MOVE GDG-IND-EST1 IN GDG TO WSS-EST-ANT  IN CMA-VARI.
      *MHM-INI 29-OCT-2003
           MOVE GDG-CIC-UING IN GDG TO CMA-CIC-UING IN CMA-VARI.
      *MHM-INI 29-OCT-2003
      
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'BGL' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
               MOVE SPACES  TO MSG-COD-MENS
               MOVE 'BGL'   TO TAB-COD-SIST
               MOVE 'RAL'   TO TAB-COD-TTAB IN TAB
               MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB
      
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO
                         FRM-GLS-TREA IN GDG-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TREA IN GDG-FLD.

*% IF GEN_BCI
      *<<<< GEN_BCI
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-CGTA IN GDG-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-CGTA IN GDG-FLD
      *       Es Dep Plazo Propio
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
               PERFORM BUS-GDO-OPD
               MOVE OPD-CAI-IOPD IN DAP-VARI TO FRM-CAI-IOPD IN GDG-FLD
               MOVE OPD-IIC-IOPD IN DAP-VARI TO FRM-IIC-IOPD IN GDG-FLD
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI
               MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD
               MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD,
                          FRM-GLS-DEUD IN GDG-FLD.

           IF GDG-IND-EST1 IN GDG-FLD > '19'
               MOVE GDG-COD-ATRN IN GDG TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-ATRN IN GDG-FLD.

      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-MALZ IN GDG-FLD > SPACES
               MOVE 'BGL' TO TAB-COD-SIST
               MOVE 'MAL' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-MALZ IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-MALZ IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-MALZ IN GDG-FLD.

      *BUS-USR busca usuario en tablas
           IF GDG-COD-RERS IN GDG-FLD > SPACES
               MOVE GDG-COD-RERS IN GDG-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RERS IN GDG-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-RERS IN GDG-FLD.

      *BUS-USR busca usuario en tablas
           IF GDG-COD-RERT IN GDG-FLD > SPACES
               MOVE GDG-COD-RERT IN GDG-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RERT IN GDG-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-RERT IN GDG-FLD.
      *>>>>
*% END
           MOVE TAG-IND-SVTO IN TAG TO GAR-IND-SVTO IN CMA-VARI.
      *
      *AFRI-INI-MAR2007    [EVA]                                        
      * Mover nombre propietario.
           IF GDG-IIC-ICLI IN GDG > ZEROES
               MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
*% IF FMT_CHI
      *<<<< FMT_CHI
                  MOVE DBC-NUM-ICLI IN DBC TO GDG-NUM-IPRO IN GDG-FLD   
                  MOVE DBC-VRF-ICLI IN DBC TO GDG-VRF-IPRO IN GDG-FLD   
*% ELSE
                  MOVE DBC-IDC-ICLI IN DBC TO FRM-IDC-ICLI IN GDG-FLD
*% END
                  MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI
                  MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI
      
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO GDG-GLS-NOMP IN GDG-FLD              
                  MOVE CPT-STRN TO CNE-GDG-GLS-NOMP                     
                ELSE                                                    
                  MOVE SPACES TO GDG-GLS-NOMP IN GDG-FLD                
                  MOVE SPACES  TO CNE-GDG-GLS-NOMP                      
           ELSE                                                         
              MOVE GDG-GLS-NOMP IN GDG TO GDG-GLS-NOMP IN GDG-FLD       
              MOVE GDG-GLS-NOMP IN GDG TO CNE-GDG-GLS-NOMP.             
      *AFRI-FIN-MAR2007                                                 
      *>>>>
*% IF PGM_PER
      *<<<< PGM_PER

      *LAV CST  22-JUL-1993 
      *    Es Documento que requiere accesar archivos del BCP 
           IF CMA-CIC-TGAR IN CMA-VARI = 'DOCFCC' OR 
                                         'DOCDPN' OR 
                                         'DOCVAL' OR 
                                         'DOCCBR' OR
                                         'DOCCEX'
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
               PERFORM BUS-GDO-OPD
               MOVE OPD-IIC-IOPD IN DAP-VARI TO FRM-IIC-IOPD IN GDG-FLD
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI
               MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_PUT_DBC_GDG
      *<<<< INI_PUT_DBC_GDG
           IF DBC-IIC-ICLI IN CMA-VARI > ZEROES
               MOVE DBC-KEY-IDBC IN CMA-VARI TO DBC-CIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
           ELSE
               MOVE FIO-STAT-NEX TO PGM-STAT-DBC.
      *>>>>
*% END
*% IF FIN_PUT_DBC_GDG
      *<<<< FIN_PUT_DBC_GDG
      *
           MOVE DBC-CAI-ICLI IN DBC TO CNE-DBC-CAI-ICLI.
           MOVE DBC-IIC-ICLI IN DBC TO CNE-DBC-IIC-ICLI.

           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *
           PERFORM GET-CUR-GDD-MUL.
           IF WSS-IND-CMUL = 'M'
      *RRM    IF SCR-CMND NOT = 'ING'  AND SCR-CMND NOT = 'MOD'
              IF SCR-CMND NOT = 'ING'
                 MOVE 'MULTIPLES DEUDORES ' TO DBC-GLS-NOMC IN GDG-FLD
*% IF FMT_CHI
      *<<<<
                 MOVE ZEROES                TO DBC-NUM-ICLI IN GDG-FLD
                 MOVE 'M'                   TO DBC-IND-ICLI IN GDG-FLD
                 MOVE SPACES                TO DBC-GLS-ICLI IN GDG-FLD
                 MOVE SPACES                TO DBC-VRF-ICLI IN GDG-FLD
      *>>>>
*% ELSE
                 MOVE ZEROES                TO DBC-IDC-ICLI IN GDG-FLD
*% END
              GO TO FIN-PUT-DBC-GDG.
      *>>>>
*% END
*% IF INI_FST_FLD_GDG
      *<<<< INI_FST_FLD_GDG
*% IF NOT GEN_BCI
      *<<<< NOT GEN_BCI
*% IF FMT_CHI
      *<<<< FMT_CHI
           IF SCR-CMND = 'ALZ'
              MOVE FRM-POS-CURS TO GDG-FEC-FALZ-LEN IN GDG-FLD
              GO TO FIN-FST-FLD-GDG.
      *>>>>
*% END
           IF (SCR-CMND = 'CAN' OR SCR-CMND = 'EJE'
                                OR SCR-CMND = 'CAD')
              MOVE FRM-POS-CURS TO GDG-IND-EST1-LEN IN GDG-FLD
              GO TO FIN-FST-FLD-GDG.

           IF SCR-CMND = 'MGA'
              MOVE FRM-POS-CURS TO GDG-GLS-DGTA-LEN IN GDG-FLD
              GO TO FIN-FST-FLD-GDG.
      *>>>>
*% ELSE
           MOVE 0 TO DBC-NUM-ICLI-LEN IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FALZ-ATR IN GDG-FLD.             
           MOVE FRM-CPIM-AEY TO GDG-COD-EST1-ATR IN GDG-FLD.         
           MOVE FRM-CPIM-AEY TO GDG-COD-EST2-ATR IN GDG-FLD.
           IF NOT (CMA-IND-DAP IN CMA-VARI = 'S' AND                    
                   SCR-CCPP = 'ING')                                    
      *       No Es o No Ingresa Dep Plazo Propio 
               MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-DEUD-ATR IN GDG-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD.

           IF SCR-CCPP = 'ING'
               MOVE SPACES TO WSS-EST-ANT IN CMA-VARI
      *         PERFORM ANL-HBL-COD-GRA
               PERFORM ANL-HBL-FEC-VTO
               MOVE -1           TO DBC-NUM-ICLI-LEN    IN GDG-FLD
               GO TO FIN-FST-FLD-GDG.

           IF SCR-CCPP = 'MOD'
               PERFORM ANL-HBL-DBC-ICLI
               PERFORM ANL-HBL-FEC-VTO
               IF SCR-CMND = 'MOD'
      *MHM-INI 16-OCT-2003
      *             MOVE -1 TO GDG-COD-OFIC-LEN IN GDG-FLD
                   MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
      *MHM-INI 16-OCT-2003
                   GO TO FIN-FST-FLD-GDG.

      *     MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FSOL-ATR IN GDG-FLD.

           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.

           IF SCR-CMND = 'ALZ' OR SCR-CMND = 'EJE'
      *MHM-INI 13-OCT-2003
               MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-RLCM-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-RLUN-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-RLVR-ATR IN GDG-FLD
      *MHM-FIN 13-OCT-2003
               MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-ATR IN GDG-FLD
      *ADA-INI 20-DIC-2002
               MOVE FRM-CPIM-AEY TO GDG-COD-TGCM-ATR IN GDG-FLD
      *ADA-FIN 20-DIC-2002
               MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-NUM-IPRO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-IND-IPRO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-GLS-IPRO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-VRF-IPRO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD
               IF SCR-CMND = 'ALZ'
      * FLB
                   MOVE FRM-CPIM-UBY TO GDG-FEC-FALZ-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-COD-EST1-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD
      * FIN
      *MHM-INI 15-OCT-2003
      *             MOVE -1 TO GDG-IND-EST1-LEN IN GDG-FLD              
                   MOVE -1 TO GDG-FEC-FALZ-LEN IN GDG-FLD               
      *MHM-FIN 15-OCT-2003
               ELSE
               IF SCR-CMND = 'EJE'
                   MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD
                   MOVE -1 TO GDG-COD-EST2-LEN IN GDG-FLD
               ELSE
                   NEXT SENTENCE
           ELSE
           IF SCR-CMND = 'MGA'
      *MHM-INI 14-OCT-2003
      *         MOVE -1 TO GDG-GLS-DGTA-LEN IN GDG-FLD
               MOVE -1 TO GDG-COD-RLCM-LEN IN GDG-FLD
      *MHM-FIN 14-OCT-2003
      *MHM-INI 13-OCT-2003
               MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-IND-IPRO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UBY TO GDG-GLS-IPRO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UBY TO GDG-NUM-IPRO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UBY TO GDG-VRF-IPRO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UBY TO GDG-IND-ECRS-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-COD-RERS-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-FEC-FVES-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-IND-ECRT-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-COD-RERT-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-FEC-FVET-ATR IN GDG-FLD
      *MHM-FIN 13-OCT-2003
           ELSE
           IF (SCR-CMND = 'AGA' OR SCR-CMND = 'ACE')
               MOVE -1 TO GDG-GLS-MENS-LEN IN GDG-FLD.

           GO TO FIN-FST-FLD-GDG.
       ANL-HBL-DBC-ICLI.
           IF MULTIPLES-GDD

               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       ANL-HBL-COD-GRA.
      *         IF GAR-COD-GRA IN TAG = 'N'
      *             MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR IN GDG-FLD
      *             IF SCR-CCPP = 'ING'
      *                 MOVE SPACES TO GDG-COD-GRA IN GDG-FLD.
       ANL-HBL-FEC-VTO.
           IF GAR-IND-SVTO IN CMA-VARI = 'N'
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD
               IF SCR-CCPP = 'ING'
                   MOVE ZEROES TO GDG-NUM-SVTO IN GDG-FLD
                   MOVE ZEROES TO GDG-NUM-AVTO IN GDG-FLD
                   MOVE ZEROES TO GDG-NUM-MVTO IN GDG-FLD
                   MOVE ZEROES TO GDG-NUM-DVTO IN GDG-FLD.
       FIN-ANL-HBL-FEC-VTO.
      *>>>>
*% END
      *>>>>
*% END
*% IF FIN_FST_FLD_GDG
      *<<<< FIN_FST_FLD_GDG
      *>>>>
*% END
*% IF INI_DBC_VRF_ICLI
      *<<<< INI_DBC_VRF_ICLI
               MOVE SPACES TO MSG-COD-MENS.
      *>>>>
*% END
*% IF DBC_NUM_ICLI
      *<<<< DBC_NUM_ICLI
      *MHM-INI 19-OCT-2002
           IF SCR-CMND = 'ING'
      *MHM-FIN 19-OCT-2002
             IF DBC-NUM-ICLI IN GDG-FLD NOT > ZEROES

                   PERFORM ERR-GLS
                   GO TO FIN-VAL-DBC-NUM-ICLI.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
*% IF FMT_CHI
      *<<<< FMT_CHI
           IF SCR-CMND = 'ING'
      *>>>>
*% END
           IF DBC-IND-ICLI IN GDG-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'GDGMDDIRNO'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE FRM-POS-CURS TO DBC-IND-ICLI-LEN IN GDG-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF MSG-COD-MENS NOT > SPACES AND
              DBC-NUM-ICLI IN GDG-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GET-CLI
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF MSG-GLS-DESC > SPACES
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                      PERFORM CPT-BLKS
                      MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD
                      GO TO FIN-VAL-DBC-VRF-ICLI                    
               ELSE
*% IF GEN_BCI
      *<<<< GEN_BCI
                   IF SCR-CMND NOT = 'ING' AND                          
                      SCR-CMND NOT = 'MOD' AND                          
                      SCR-CMND NOT = 'MGA'                              
                      GO TO FIN-VAL-DBC-VRF-ICLI                        
                   ELSE                                                 
                      MOVE DBC-COD-OFIC IN DBC TO                       
                           GDG-COD-OFIC IN GDG-FLD                      
                      MOVE DBC-COD-EJEC IN DBC TO                       
                           GDG-CIC-EJOR IN GDG-FLD                      
      *>>>>                                                             
                   MOVE DBC-CAI-ICLI IN DBC TO                          
                        CNE-DBC-CAI-ICLI                                
                   MOVE DBC-IIC-ICLI IN DBC TO                          
                        CNE-DBC-IIC-ICLI                                
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.            
      *>>>>
*% END
*% END
*% IF GDG_COD_TOPE
      *<<<< GDG_TIP_OPE
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-GDG-COD-TOPE.
      *>>>>
*% END
*% IF GDG_STP_CGTA
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-GDG-STP-CGTA.
      
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'  TO TAB-COD-SIST.
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GDG-FLD  TO WSS-TIP-CGTA IN WSS-VARI.
           MOVE GDG-STP-CGTA IN GDG-FLD  TO WSS-STP-CGTA IN WSS-VARI.
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAG-COD-AGTA IN TAG.
           MOVE TAG-COD-AGTA IN TAG      TO TAB-COD-CTAB IN TAB.

           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              MOVE SPACES TO CMA-CIC-TGAR IN CMA-VARI
              MOVE SPACES TO FRM-GLS-CGTA IN GDG-FLD
                GO TO FIN-VAL-GDG-STP-CGTA.
      
           MOVE TAB-CIC-CTAB IN TAB TO CMA-CIC-TGAR IN CMA-VARI.
      *MHM-INI 23-OCT-2003
      *     MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CGTA IN GDG-FLD.
           MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI.

           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.
           MOVE SPACES                  TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GDG-FLD.
      *MHM-FIN 23-OCT-2003
      
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'BGL' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GDG-STP-CGTA.
      *Valida indicador Tipo
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'BGL'               TO TAB-COD-SIST.
           MOVE 'RAL'               TO TAB-COD-TTAB IN TAB.
           MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TREA IN GDG-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-TREA IN GDG-FLD.

*% END
*% IF INI_GDG_COD_CGTA
      *
      *<<<< GDG_STP_OPE
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-GDG-COD-CGTA.
      
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'  TO TAB-COD-SIST.
           MOVE 'GTA'  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
      
           MOVE GDG-COD-CGTA IN GDG-FLD TO TAG-COD-AGTA IN TAG.
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              MOVE SPACES TO CMA-CIC-TGAR IN CMA-VARI
              MOVE SPACES TO FRM-GLS-CGTA IN GDG-FLD
                GO TO FIN-VAL-GDG-COD-CGTA.
      
           MOVE TAB-CIC-CTAB IN TAB TO CMA-CIC-TGAR IN CMA-VARI.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CGTA IN GDG-FLD.
      
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'BGL' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GDG-COD-CGTA.
      *Valida indicador Tipo
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'BGL'               TO TAB-COD-SIST.
           MOVE 'RAL'               TO TAB-COD-TTAB IN TAB.
           MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TREA IN GDG-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-TREA IN GDG-FLD.


*% END
*% IF INI_VAL_CON_KEY_GDG AND ( NOT PGM_CLB AND NOT PGM_MEX)
      *<<<< INI_VAL_CON_KEY_GDG
           IF FRM-FFLD = FRM-FFLD-PF8 OR
              FRM-FFLD = FRM-FFLD-PF7 OR
              FRM-FFLD = FRM-FFLD-PF5 OR
              FRM-FFLD = FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-GDG.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_GDG
      *<<<< INI_VAL_CON_IKY_GDG
 
           MOVE TAG-IND-SVTO IN TAG TO GAR-IND-SVTO IN CMA-VARI.
*% IF GEN_BCI
      *<<<< GEN_BCI

           MOVE TAG-SGV-PPON IN TAG TO GAR-SGV-PPCT IN CMA-VARI.
           MOVE TAG-SGV-PAJU IN TAG TO GAR-SGV-PAJU IN CMA-VARI.
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-CGTA IN GDG-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-CGTA IN GDG-FLD
      *       Ingresa Dep Plazo Propio 
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI.

      *>>>>
*% END
*% IF ( PGM_PER OR PGM_CLB OR PGM_MEX)
      *<<<< ( PGM_PER OR PGM_CLB OR PGM_MEX)
      *JAC
           MOVE TAG-SGV-PPON IN TAG TO GAR-SGV-PPCT IN CMA-VARI.
           MOVE TAG-SGV-PAJU IN TAG TO GAR-SGV-PAJU IN CMA-VARI.

           IF CMA-CIC-TGAR IN CMA-VARI = 'DOCFCC' OR 
                                         'DOCDPN' OR
                                         'DOCVAL' OR 
                                         'DOCCBR' OR 
                                         'DOCCEX'
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI.
      *>>>>
*% END
      *>>>>
*% END
*%! ---------------------------------------------------------------------------
*% IF INI_RET_GDG_GDG
      *>>>> INI_RET_GDG_GDG
      *<<<<
*% END
*% IF FIN_RET_GDG_GDG
      *<<<< FIN_RET_GDG_GDG
      *  GDG-IND_EST1 = 05 --> En tramite
      *                 10 --> Constituida
      *                 20 --> Levantada
      *
           IF SCR-CMND = 'ING'
              MOVE '05' TO GDG-IND-EST1 IN GDG-FLD
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
      *RRM-INI 31-MAY-2002
              IF GDG-COD-CGTA IN GDG-FLD > 100 AND 
                 GDG-COD-CGTA IN GDG-FLD < 130
                  MOVE 'S' TO GDG-IND-INOB IN GDG-FLD.
      *RRM-FIN 31-MAY-2002
      *
      *>>>>
*% END
           MOVE GDG-COD-VCAM IN GDG-FLD TO WSS-VCB.
           IF WSS-TIP-VCB = '1'
              MOVE GDG-COD-VCAM IN GDG-FLD TO GDG-COD-VCON IN GDG
              GO TO NTX-RET-GDG-GDG.
      
      *    Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de Moned
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE 'TAB'          TO MSG-COD-SIST
              MOVE 'CIC0999  NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE SPACES         TO GDG-COD-VCON IN GDG
               GO TO NTX-RET-GDG-GDG.
      
           MOVE TAB-COD-CTAB IN TAB TO GDG-COD-VCON IN GDG.
      
       NTX-RET-GDG-GDG.
           IF GDG-IND-EST1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI
               MOVE WSS-EST-ANT IN CMA-VARI TO GDG-COD-ESTA IN GDG.
      
*% IF FMT_CHI
      *<<<< FMT_CHI
      *AFRI-EVA /ABR2007                                                
      *    IF FRM-NUM-ICLI IN GDG-FLD = ZEROES                          
           IF ((GDG-NUM-IPRO IN GDG-FLD NOT > ZEROES) OR                
               (GDG-NUM-IPRO IN GDG-FLD > ZEROES AND                    
                GDG-IND-CBAN IN GDG-FLD = 'N'))                         
      *FIN-EVA /ABR2007                                                 
      *>>>>
*% ELSE
           IF FRM-IDC-ICLI IN GDG-FLD = ZEROES
*% END
      *AFRI-INI JUL/2004
               MOVE SPACES TO CNE-GDG-CAI-ICLI
               MOVE ZEROES TO CNE-GDG-IIC-ICLI
      *AFRI-FIN JUL/2004
               MOVE SPACES TO GDG-CAI-ICLI IN GDG
               MOVE ZEROES TO GDG-IIC-ICLI IN GDG.
      
           IF SCR-CMND = 'EJE' OR
              SCR-CMND = 'CAD' OR
              SCR-CMND = 'MGA'
              GO TO FIN-RET-GDG-GDG.
      
           MOVE ZEROES  TO GDG-VAL-CCON IN GDG.
           MOVE ZEROES  TO GDG-VAL-CCOM IN GDG.
      *>>>>
*% END
*% IF INI_RET_DBC_GDG
      *>>>> INI_RET_GDG_GDG
           MOVE CNE-GDG-CAI-ICLI  TO GDG-CAI-ICLI IN GDG.
           MOVE CNE-GDG-IIC-ICLI  TO GDG-IIC-ICLI IN GDG.
           MOVE CNE-GDG-GLS-NOMP  TO GDG-GLS-NOMP IN GDG.
      *>>>>
*% END
*% IF GDG_COD_UNIC AND PGM_MEX
      *<<<< GDG_COD_UNIC AND PGM_MEX  (FRM_IIC_IOPD)
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
      *RRM-INI 31-MAY-2002
      
           IF SCR-CMND NOT = 'ING' AND SCR-CMND NOT = 'MOD'
               GO TO FIN-VAL-GDG-COD-UNIC.
      
           IF ( SCR-CMND = 'ING' OR SCR-CMND = 'MOD') AND
                GDG-COD-CGTA IN GDG-FLD > 100 AND
                GDG-COD-CGTA IN GDG-FLD < 130
                IF GDG-COD-UNIC IN GDG-FLD NOT > SPACES
                   MOVE 'BGL'          TO MSG-COD-SIST
                   MOVE 'ID FIS OBLIG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-GDG-COD-UNIC.
      
           IF GDG-COD-UNIC IN GDG-FLD NOT > SPACES
               GO TO FIN-VAL-GDG-COD-UNIC.
      
           MOVE GDG-COD-UNIC IN GDG-FLD TO GDG-COD-UNIC IN GDG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LEE-GDG-UNIC.
           MOVE 'GDG-COD-UNIC' TO FIO-AKEY.
           PERFORM BGL-FIO-GDG.
           IF NOT FIO-STAT-OKS OR
              GDG-COD-UNIC IN GDG NOT = GDG-COD-UNIC IN GDG-FLD
               MOVE '00' TO FIO-STAT
               GO TO OBT-GDG-OLD.
      
           IF GDG-COD-CGTA IN GDG NOT = GDG-COD-CGTA IN GDG-FLD OR
              GDG-IND-EST1 IN GDG = '20' OR
              ( GDG-CAI-GTIA IN GDG = GDG-CAI-GTIA IN GDG-FLD AND
                GDG-IIC-GTIA IN GDG = GDG-IIC-GTIA IN GDG-FLD )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LEE-GDG-UNIC
            ELSE
               MOVE 'ID. FISICA EXISTE EN ' TO WSS-FRM-MENS1
               MOVE  GDG-CIC-GTIA IN GDG    TO WSS-FRM-MENS2
               MOVE  WSS-FRM-MENS           TO FRM-MENS
               MOVE  FRM-SUAR-MAL TO FRM-SUAR
               GO TO OBT-GDG-OLD.
       OBT-GDG-OLD.
      *RRM-FIN 31-MAY-2002
      *>>>>
*% END
      *>>>>
*% END
*% IF FRM_IIC_IOPD AND ( PGM_PER OR PGM_VMS )
      *<<<< FRM_IIC_IOPD AND ( PGM_PER OR PGM_VMS )

           IF CMA-IND-DAP IN CMA-VARI NOT = 'S' OR
              SCR-CCPP NOT = 'ING'
              GO TO FIN-VAL-FRM-IIC-IOPD.

           IF FRM-IIC-IOPD IN GDG-FLD NOT > SPACES
               MOVE 'BGL'         TO MSG-COD-SIST
               MOVE 'DOCNOVAL'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-VAL-FRM-IIC-IOPD.

           IF CMA-CIC-TGAR IN CMA-VARI   = 'DOCCBR' OR 'DOCFCC'

               MOVE FRM-IIC-IOPD IN GDG-FLD TO BCP-VAL-NUME IN BCP-VARI
               IF BCP-VAL-NU06 > SPACES
                   MOVE 'BGL'         TO MSG-COD-SIST
                   MOVE 'ERRORLONKEY' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC  TO FRM-MENS
                   MOVE FRM-SUAR-MAL  TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
                   MOVE BCP-VAL-NU10 IN BCP-VARI TO NUM-NUME
                   MOVE NUM-ZERO-N               TO NUM-ZERO
                   MOVE NUM-SGNO-N               TO NUM-SGNO
                   MOVE 10                       TO NUM-NENT
                   MOVE 0                        TO NUM-NDCM
                   PERFORM VAL-NUM
                   IF NUM-STAT-OKS
                       MOVE ZEROES   TO BCP-NUM-IFCC IN BCP-VARI
                       MOVE NUM-NN9N TO BCP-NUM-IFCC IN BCP-VARI
                   ELSE
                       MOVE 'BGL'         TO MSG-COD-SIST
                       MOVE 'KEYNONUMERI' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC  TO FRM-MENS
                       MOVE FRM-SUAR-MAL  TO FRM-SUAR
                       GO TO FIN-VAL-FRM-IIC-IOPD
           ELSE
           IF CMA-CIC-TGAR IN CMA-VARI = 'DOCDPN'
               MOVE FRM-IIC-IOPD IN GDG-FLD TO BCP-VAL-NUME IN BCP-VARI
               IF BCP-VAL-NU04 > SPACES
                   MOVE 'BGL'         TO MSG-COD-SIST
                   MOVE 'ERRORLONKEY' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC  TO FRM-MENS
                   MOVE FRM-SUAR-MAL  TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
                   MOVE BCP-VAL-NU12 IN BCP-VARI TO NUM-NUME
                   MOVE NUM-ZERO-N               TO NUM-ZERO
                   MOVE NUM-SGNO-N               TO NUM-SGNO
                   MOVE 12                       TO NUM-NENT
                   MOVE 0                        TO NUM-NDCM
                   PERFORM VAL-NUM
                   IF NUM-STAT-OKS
                       MOVE ZEROES   TO BCP-NUM-IDPN IN BCP-VARI
                       MOVE NUM-NN9N TO BCP-NUM-IDPN IN BCP-VARI
                   ELSE
                       MOVE 'BGL'         TO MSG-COD-SIST
                       MOVE 'KEYNONUMERI' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC  TO FRM-MENS
                       MOVE FRM-SUAR-MAL  TO FRM-SUAR
                       GO TO FIN-VAL-FRM-IIC-IOPD.


      *LAV CST 22-JUL-1993 - Acceso a archivos del BCP
           IF CMA-CIC-TGAR IN CMA-VARI = 'DOCCBR'
               PERFORM LEE-FCC-CBR
               IF MSG-COD-MENS > SPACES
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'DOCNEX'     TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
                   MOVE WSS-NOMB-FCC TO FRM-GLS-NOM-INT IN GDG-FLD
                   MOVE CBR-SGV-SCBR IN CBR TO CMA-DOC-SALD IN CMA-VARI
                   MOVE ZEROES              TO CMA-FEC-FAPE IN CMA-VARI
                   PERFORM GET-FHOY
                   MOVE HOY-FHOY   TO CMA-FEC-FTSN IN CMA-VARI
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'VLR'               TO TAB-EXT-TTAB IN TAB
                   MOVE CBR-NUM-MONE IN CBR TO TAB-EXT-CTAB IN TAB
                   MOVE 'TAB-EXT-TABL'      TO FIO-AKEY
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS > SPACES
                       MOVE 'TAB'           TO MSG-COD-SIST
                       MOVE 'VLR    NEX'  TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FRM-IIC-IOPD
                   ELSE
                   MOVE TAB-COD-CTAB IN TAB TO GDG-COD-VCAM IN GDG-FLD
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCAM IN GDG-FLD
           ELSE
           IF CMA-CIC-TGAR IN CMA-VARI = 'DOCVAL'
               MOVE FRM-IIC-IOPD IN GDG-FLD  TO BCP-NUM-IVAL IN BCP-VARI
               MOVE BCP-NUM-IVAL IN BCP-VARI TO VAL-KEY-IVAL IN VAL
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-VAL
               IF NOT FIO-STAT-OKS
                   MOVE 'BGL'                   TO FIO-SIST
                   MOVE 'SVM'                   TO TAB-COD-TTAB IN TAB
                   MOVE BCP-SUC-VAL IN BCP-VARI TO TAB-COD-CTAB IN TAB
                   MOVE FIO-GET-KEY             TO FIO-CMND
                   PERFORM GNS-FIO-TAB
                   IF FIO-STAT-OKS
                       MOVE FRM-CPIM-UBY TO GDG-VCB-ATR IN GDG-FLD
                       MOVE FRM-CPIM-UST TO GDG-VCB-STP

                       MOVE 'N' TO CMA-IND-DAP IN CMA-VARI
                       GO TO FIN-VAL-FRM-IIC-IOPD
                   ELSE
                       MOVE 'TAB'        TO MSG-COD-SIST
                       MOVE 'DOCNEX'     TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
                   IF BCP-SUF-VAL NOT = 2
                       MOVE 'BGL'        TO MSG-COD-SIST
                       MOVE 'DOCNOGAR'   TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FRM-IIC-IOPD
                   ELSE
                       MOVE VAL-SGV-SALD IN VAL TO CMA-DOC-SALD
                                                         IN CMA-VARI
                       MOVE '03'  TO CMA-TIP-DOC IN CMA-VARI
                       MOVE VAL-NUM-DAPE IN VAL TO FEC-DIA IN BCP-VARI
                       MOVE VAL-NUM-MAPE IN VAL TO FEC-MES IN BCP-VARI
                       MOVE VAL-NUM-SAPE IN VAL TO FEC-SGL IN BCP-VARI
                       MOVE VAL-NUM-AAPE IN VAL TO FEC-ANO IN BCP-VARI
                       MOVE BCP-NUM-FECH TO CMA-FEC-FAPE IN CMA-VARI
                       MOVE BCP-NUM-FECH TO CMA-FEC-FTSN IN CMA-VARI
                       MOVE VAL-GLS-NOMC TO FRM-GLS-NOM-INT IN GDG-FLD
      * BUSCA MONEDA POR CODIGO EXTERNO
                       MOVE 'TAB'           TO TAB-COD-SIST
                       MOVE 'VLR'           TO TAB-EXT-TTAB IN TAB
                       MOVE VAL-GLS-MONE IN VAL TO TAB-EXT-CTAB IN TAB
                       MOVE 'TAB-EXT-TABL'  TO FIO-AKEY
                       PERFORM BUS-TAB
                       IF MSG-COD-MENS > SPACES
                           MOVE 'TAB'           TO MSG-COD-SIST
                           MOVE 'VLR    NEX'  TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           GO TO FIN-VAL-FRM-IIC-IOPD
                       ELSE
                       MOVE TAB-COD-CTAB IN TAB TO GDG-COD-VCAM
                                                           IN GDG-FLD
                       MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCAM
                                                           IN GDG-FLD
           ELSE
           IF CMA-CIC-TGAR IN CMA-VARI = 'DOCCEX'
               MOVE FRM-IIC-IOPD IN GDG-FLD  TO BCP-NUM-ICEX IN BCP-VARI
               MOVE BCP-KEY-ICEX IN BCP-VARI TO CEX-KEY-ICEX IN CEX
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CEX
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'DOCNEX'     TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
                   ADD CEX-SGV-SLD1 CEX-SGV-SLD2 GIVING
                                            CMA-DOC-SALD IN CMA-VARI
                   MOVE CEX-GLS-FAPE IN CEX TO BCP-FEC-COMP3
                                                         IN BCP-VARI
                   PERFORM OBT-FEC-COMP3
                   MOVE BCP-NUM-FECH IN BCP-VARI TO
                                CMA-FEC-FAPE IN CMA-VARI
                   MOVE BCP-NUM-FECH IN BCP-VARI TO
                                CMA-FEC-FTSN IN CMA-VARI
                   MOVE CEX-GLS-FVTO IN CEX TO BCP-FEC-COMP3
                                                         IN BCP-VARI
                   PERFORM OBT-FEC-COMP3
                   MOVE BCP-NUM-DFEC IN BCP-VARI TO
                                GDG-FD-VTO IN GDG-FLD
                   MOVE BCP-NUM-MFEC IN BCP-VARI TO
                                GDG-FM-VTO IN GDG-FLD
                   MOVE BCP-NUM-AFE4 IN BCP-VARI TO
                                GDG-FA-VTO IN GDG-FLD

      *ASC  08-MAY-1994 OBTIENE MONEDA DE CARTA DE CREDITO
                   MOVE SPACES       TO WSS-TF-KEY
                   MOVE '104'        TO WSS-TF-NUM
                   MOVE CEX-SIM-MONE TO WSS-TF-ID
                   MOVE WSS-TF-KEY   TO TF-KEY IN TF-RECORD
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM TAB-FIO-CE1
                   IF NOT FIO-STAT-OKS
                       MOVE 'TAB'        TO MSG-COD-SIST
                       MOVE 'CEXMONNEX'  TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FRM-IIC-IOPD
                   ELSE
                       MOVE TF-DESCRIPTION (3) TO WSS-MON-DESCRI
      * BUSCA MONEDA POR CODIGO EXTERNO EN TABLA CONSIST
                       MOVE 'TAB'           TO TAB-COD-SIST
                       MOVE 'VLR'           TO TAB-EXT-TTAB IN TAB
                       MOVE WSS-CE1-MONEDA  TO TAB-EXT-CTAB IN TAB
                       MOVE 'TAB-EXT-TABL'  TO FIO-AKEY
                       PERFORM BUS-TAB
                       IF MSG-COD-MENS > SPACES
                           MOVE 'TAB'           TO MSG-COD-SIST
                           MOVE 'VLR    NEX'  TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           GO TO FIN-VAL-FRM-IIC-IOPD
                       ELSE
                           MOVE TAB-COD-CTAB IN TAB TO GDG-COD-VCAM
                                                           IN GDG-FLD
                           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCAM
                                                           IN GDG-FLD
      *ASC  08-MAY-1994 OBTIENE NOMBRE DE CARTA DE CREDITO
                          MOVE CEX-BEN-DDA-ACCT TO AM-ACCOUNT-NUMBER-00
                          MOVE     '00'         TO AM-RECORD-TYPE-00
                          MOVE    SPACES        TO AM-CITY-CODE-00
                          MOVE FIO-GET-KEY TO FIO-CMND
                          PERFORM TAB-FIO-CE2
                          IF NOT FIO-STAT-OKS
                             MOVE 'TAB'        TO MSG-COD-SIST
                             MOVE 'CEXCLINEX'  TO MSG-COD-MENS
                             PERFORM GET-MSG
                             MOVE MSG-GLS-DESC TO FRM-MENS
                             MOVE FRM-SUAR-MAL TO FRM-SUAR
                             GO TO FIN-VAL-FRM-IIC-IOPD
                          ELSE
                             MOVE AM-NAME-AND-ADDRESS-LINE (1) TO
                                           FRM-GLS-NOM-INT IN GDG-FLD
                             IF CEX-GLS-GRPO = 'E' AND
                                                  CEX-GLS-NUM(1) = '2'
                                MOVE '06' TO CMA-TIP-DOC IN CMA-VARI
                             ELSE
                                IF CEX-GLS-GRPO = 'O' AND
                                                CEX-GLS-NUM(1) = '4'
                                   MOVE '07' TO CMA-TIP-DOC IN CMA-VARI
                                ELSE
                                   MOVE 'BGL'         TO MSG-COD-SIST
                                   MOVE 'DOCNOCCCBRE' TO MSG-COD-MENS
                                   PERFORM GET-MSG
                                   MOVE MSG-GLS-DESC TO FRM-MENS
                                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                                   GO TO FIN-VAL-FRM-IIC-IOPD
           ELSE
           IF CMA-CIC-TGAR IN CMA-VARI = 'DOCFCC'
               PERFORM LEE-FILE-CENTRAL
               IF MSG-COD-MENS > SPACES
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'DOCNEX'     TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
                   PERFORM OBT-BITS-DE-BYTE
                   IF BCP-NUM-BITS(1) NOT = '1'
                       MOVE 'BGL'        TO MSG-COD-SIST
                       MOVE 'DOCNOVIG'   TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FRM-IIC-IOPD
                   ELSE
                       MOVE '01' TO CMA-TIP-DOC IN CMA-VARI
                       MOVE BCP-SGV-SALD IN BCP-VARI TO
                                CMA-DOC-SALD IN CMA-VARI
                       MOVE BCP-GLS-FAPE IN BCP-VARI TO
                                BCP-GLS-FECH IN BCP-VARI
                       PERFORM DESQ-NUM-FECH
                       MOVE BCP-NUM-FECH IN BCP-VARI TO
                                CMA-FEC-FAPE IN CMA-VARI
                       MOVE BCP-NUM-FECH IN BCP-VARI TO
                                CMA-FEC-FTSN IN CMA-VARI
                       MOVE BCP-GLS-FVTO IN BCP-VARI TO
                                BCP-GLS-FECH IN BCP-VARI
                       PERFORM DESQ-NUM-FECH
                       MOVE BCP-NUM-DFEC IN BCP-VARI TO
                                GDG-FD-VTO IN GDG-FLD
                       MOVE BCP-NUM-MFEC IN BCP-VARI TO
                                GDG-FM-VTO IN GDG-FLD
                       MOVE BCP-NUM-AFE4 IN BCP-VARI TO
                                GDG-FA-VTO IN GDG-FLD
                       MOVE WSS-NOMB-FCC TO FRM-GLS-NOM-INT IN GDG-FLD
                       PERFORM DESQ-UN-BYTE
                       MOVE 'TAB'               TO TAB-COD-SIST
                       MOVE 'VLR'               TO TAB-EXT-TTAB IN TAB
                       MOVE BCP-NUM-UNBY IN BCP-VARI TO
                                                   TAB-EXT-CTAB IN TAB
                       MOVE 'TAB-EXT-TABL'      TO FIO-AKEY
                       PERFORM BUS-TAB
                       IF MSG-COD-MENS > SPACES
                           MOVE 'TAB'           TO MSG-COD-SIST
                           MOVE 'VLR    NEX'  TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           GO TO FIN-VAL-FRM-IIC-IOPD
                       ELSE
                           MOVE TAB-COD-CTAB IN TAB TO GDG-COD-VCAM
                                                             IN GDG-FLD
                           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCAM
                                                             IN GDG-FLD
           ELSE
           IF CMA-CIC-TGAR IN CMA-VARI = 'DOCDPN'
               MOVE 'ING'  TO BCP-GLS-FUNC IN BCP-VARI
               PERFORM TAB-PRO-DPN
               IF DPN-RSLT IN DPN-VARI = '00'
                   MOVE '02'                TO CMA-TIP-DOC  IN CMA-VARI
                   MOVE DPN-NUM-SALD IN DPN-VARI TO CMA-DOC-SALD
                                                       IN CMA-VARI
                   MOVE DPN-FEC-FAPE IN DPN-VARI TO CMA-FEC-FAPE
                                                       IN CMA-VARI
                   MOVE DPN-FEC-FAPE IN DPN-VARI TO CMA-FEC-FTSN
                                                       IN CMA-VARI
                   MOVE DPN-NOMBRE TO FRM-GLS-NOM-INT IN GDG-FLD
      *ASC CST 01-MAY-1994 - BUSCA MONEDA POR CODIGO EXTERNO
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'VLR'               TO TAB-EXT-TTAB IN TAB
                   MOVE  00                 TO TAB-EXT-CTAB IN TAB
                   MOVE 'TAB-EXT-TABL'      TO FIO-AKEY
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS > SPACES
                       MOVE 'TAB'           TO MSG-COD-SIST
                       MOVE 'VLR    NEX'  TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FRM-IIC-IOPD
                   ELSE
                   MOVE TAB-COD-CTAB IN TAB TO GDG-COD-VCAM IN GDG-FLD
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCAM IN GDG-FLD
                                                           
               ELSE
               IF DPN-RSLT IN DPN-VARI = '01'
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'DOCNEX'     TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
               IF DPN-RSLT IN DPN-VARI = '02'
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'DPNCLIMUERTO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
               IF DPN-RSLT IN DPN-VARI = '03'
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'DPNEXTRAVIAD' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
               IF DPN-RSLT IN DPN-VARI = '04'
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'DPNBLOQUEADO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
               IF DPN-RSLT IN DPN-VARI = '90' OR '92'
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'DPNCOMMERR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
               IF DPN-RSLT IN DPN-VARI = '91'
                   MOVE 'TAB'       TO MSG-COD-SIST
                   MOVE 'DPNSISERR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD
               ELSE
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'DPNRSLTINV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPD.

           IF CMA-DOC-SALD IN CMA-VARI NOT > ZEROES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'BCPSALD=0'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-IIC-IOPD.

      *LAV CST 20-JUL-1993 - VALIDA DOCTO NO EXISTA COMO GARANTIA

           MOVE FRM-IIC-IOPD IN GDG-FLD TO GDO-COD-DOCU IN VDO-VARI.
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GAR-CAI-GTIA IN VDO-VARI.
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GAR-IIC-GTIA IN VDO-VARI.
           MOVE 'BGLPUGDG'              TO VDO-PROG IN VDO-VARI.
           PERFORM GAR-PRO-VDO.
           IF MSG-COD-MENS > SPACES
               MOVE 'BGL'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-IIC-IOPD.
      *>>>>
*% END
*% IF FIN_GDG_COD_OFIC AND ( PGM_PER OR PGM_CLB OR PGM_MEX )
      *<<<< FIN_GDG_COD_OFI AND ( PGM_PER OR PGM_CLB OR PGM_MEX )
           IF SCR-CMND = 'ING'
              MOVE 'TAB'                TO FIO-SIST
              MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
              MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF FIO-STAT-OKS AND
                 TAB-IND-VIGE IN TAB = 'S'
                 MOVE 'G'                    TO CIC-COD-TCIC IN CIC
                 MOVE GDG-COD-OFIC IN GDG-FLD TO CIC-COD-CCIC IN CIC
              ELSE
                 MOVE GDG-CAI-GTIA IN GDG-FLD TO CIC-CAI-ICIC IN CIC.
*% IF GEN_BCI
      *<<<< GEN_BCI
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-OFIC.
      *ALD-ADA-INI
           IF GDG-COD-OFIC IN GDG-FLD < '010'
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODOFIC<10' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-OFIC.
      *ALD-ADA-FIN

      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-VAL-OFIC-USP-GDG-BU.
      *ALD-BCI-INI/07032000
           PERFORM VAL-PTA-USR.
           IF USP-PERMISO = 'P'
               GO TO FIN-VAL-GDG-COD-OFIC.
      *ALD-BCI-FIN/07032000
           PERFORM VAL-USR-OFI.
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG-FLD
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'USRNODEOFI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-OFIC.

       FIN-VAL-OFI-USP-GDG-BU.
      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA
      *>>>>
*% END
      *>>>>
*% END
*% IF GDG_COD_GGTA
      *<<<< GDG_COD_GRA
      *Grado de la garantia.
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.
            IF SCR-OFRM-SRV AND
               SCR-CMND = 'ING' AND 
               GDG-COD-GGTA IN GDG-FLD NOT > ZEROES
                GO TO FIN-VAL-GDG-COD-GGTA.
      *RRM-FIN 3-JUL-2002

           IF GDG-COD-GGTA IN GDG-FLD = ZEROES OR
              GAR-IND-EGAP IN CMA-VARI = 'N'
               MOVE '1' TO GDG-COD-GGTA IN GDG-FLD.

           IF GDG-COD-GGTA IN GDG-FLD = '1' AND 
              GAR-IND-EGAP IN CMA-VARI = 'S'

               MOVE 'BGL'       TO MSG-COD-SIST
               MOVE 'GRAEXIGAP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-GGTA.
      *>>>>
*% END
*% IF GDG_COD_MALZ
      *<<<< GDG_COD_MALZ
           IF SCR-CMND NOT = 'ALZ'
               GO TO FIN-VAL-GDG-COD-MALZ.

           IF GDG-COD-MALZ IN GDG-FLD NOT > SPACES AND SCR-CMND = 'ALZ' 
               PERFORM ERR-GLS
               GO TO FIN-VAL-GDG-COD-MALZ.

      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'MAL' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-MALZ IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-MALZ IN GDG-FLD
               GO TO FIN-VAL-GDG-COD-MALZ.

           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-MALZ IN GDG-FLD.
      *>>>>
*% END
*% IF FRM_GLS_ATRN
           IF SCR-CMND = 'ALZ' AND SCR-HDR-MRCA = 'BCS'                 
              MOVE 'CONOSUR'  TO FRM-GLS-ATRN IN GDG-FLD.               
*% END
*% IF GDG_VAL_MNTO
      *<<<< GDG_VAL_MNTO
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.
           IF SCR-OFRM-SRV AND
              SCR-CMND = 'ING' AND 
              GDG-VAL-MNTO IN GDG-FLD = ZEROES
                GO TO FIN-VAL-GDG-VAL-MNTO.

           IF GDG-VAL-MNTO IN GDG-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-VAL-MNTO.
      *RRM-FIN 3-JUL-2002
      *>>>>
*% END
*% IF GDG_IND_EST1
      *<<<< GDG_IND-EST1
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'ES1' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IND-EST1 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-IND-EST1 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-IND-EST1 IN GDG-FLD
               GO TO FIN-VAL-GDG-IND-EST1.

           MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-IND-EST1 IN GDG-FLD.
      *-----------------------------------------------------------*
      *MHM-INI 14-OCT-2003
           IF SCR-CMND = 'EJE' AND GDG-IND-EST1 IN GDG-FLD > '19'
               MOVE 'GDGES1NPEJE' TO MSG-COD-MENS
               GO TO ERR-VAL-GDG-IND-EST1.
      *MHM-FIN 14-OCT-2003
           IF SCR-CCPP = 'ING'  OR 
              GAR-IND-GTAC IN CMA-VARI NOT = 'S'

               IF GDG-IND-EST1 IN GDG-FLD > '05'
                   MOVE 'GDGES1NOVIG' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-IND-EST1
               ELSE
                   GO TO FIN-VAL-GDG-IND-EST1.
      *-----------------------------------------------------------*
      * CAMBIOS DE ESTADO
           IF GDG-IND-EST1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI

               IF NOT (GDG-IND-EST1 IN GDG-FLD = 
                                    WSS-ES1-1 IN CMA-VARI OR
                  GDG-IND-EST1 IN GDG-FLD = WSS-ES1-2 IN CMA-VARI OR
                  GDG-IND-EST1 IN GDG-FLD = WSS-ES1-3 IN CMA-VARI OR
                  GDG-IND-EST1 IN GDG-FLD = WSS-ES1-4 IN CMA-VARI)
                  MOVE 'ES1NVOANT' TO MSG-COD-MENS
                  GO TO ERR-VAL-GDG-IND-EST1.

*% IF GEN_BCI
      *<<<< GEN_BCI

      * ALZAMIENTO
           IF SCR-CMND = 'ALZ' AND GDG-IND-EST1 IN GDG-FLD < '20'
                   MOVE 'GDGALZES1' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-IND-EST1.

           GO TO FIN-VAL-GDG-IND-EST1.

      *>>>>
*% ELSE
      * EJECUCION
           IF SCR-CMND = 'EJE'
              IF (GDG-IND-EST1 IN GDG-FLD NOT = 10 AND
                  GDG-IND-EST1 IN GDG-FLD NOT = 20)
              OR (GDG-COD-EST2 IN GDG-FLD = 05 AND
                  GDG-IND-EST1 IN GDG-FLD > 10)
              OR (GDG-COD-EST2 IN GDG-FLD = 10 AND
                  GDG-IND-EST1 IN GDG-FLD < 20)
                  MOVE 'EST1   INCON' TO MSG-COD-MENS
                  GO TO ERR-VAL-GDG-IND-EST1.

      * CANCELACION DIRECTA (CAD)
           IF (SCR-CMND = 'CAD' AND
               GDG-IND-EST1 IN GDG-FLD < 20)
               MOVE 'GDGCADNOPERM' TO MSG-COD-MENS
               GO TO ERR-VAL-GDG-IND-EST1.

      * ALZAMIENTO
           IF ( SCR-CMND = 'ALZ' OR = 'CAN' ) AND
              ( GDG-IND-EST1 IN GDG-FLD < '15')
                MOVE 'GDGALZES1' TO MSG-COD-MENS
                GO TO ERR-VAL-GDG-IND-EST1.

           GO TO FIN-VAL-GDG-IND-EST1.

      *>>>>
*% END
       ERR-VAL-GDG-IND-EST1.
           MOVE 'BGL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GDG_COD_EST1
      *<<<< GDG_COD_EST1
*% IF GEN_BCI
      *<<<< GEN_BCI
           IF GDG-IND-EST1 IN GDG-FLD < '20'
               MOVE SPACES TO GDG-COD-EST1 IN GDG-FLD
               MOVE SPACES TO FRM-GLS-EST1 IN GDG-FLD
               GO TO FIN-VAL-GDG-COD-EST1.

           IF GDG-COD-EST1 IN GDG-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-GDG-COD-EST1.
      *>>>>
*% ELSE
           IF SCR-CMND = 'ING' 
              MOVE FRM-CPIM-AEY TO GDG-COD-EST1-ATR IN GDG-FLD
              MOVE FRM-CPIM-AEY TO GDG-COD-EST1-STP
               GO TO FIN-VAL-GDG-COD-EST1.

           IF SCR-CMND = 'ALZ' OR = 'CAN' OR
              SCR-CMND = 'EJE' OR = 'CAD'

               IF ( GDG-IND-EST1 IN GDG-FLD NOT > SPACES AND
                    GDG-IND-EST1 IN GDG-FLD = '20' )

                  PERFORM ERR-GLS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GDG-COD-EST1.

           IF GDG-IND-EST1 IN GDG-FLD < '20'
               MOVE SPACES TO GDG-COD-EST1 IN GDG-FLD
               MOVE SPACES TO FRM-GLS-EST1 IN GDG-FLD
               GO TO FIN-VAL-GDG-COD-EST1.
      *>>>>
*% END
      *>>>>
*% END
*% IF GDG_COD_EST2
      *<<<< GDG_ES2
           IF (SCR-CCPP = 'ING') OR
              (SCR-CMND NOT = 'EJE') AND
              (GDG-COD-EST2 IN GDG-FLD NOT > SPACES)

                MOVE SPACES TO GDG-COD-EST2 IN GDG-FLD
                MOVE SPACES TO FRM-GLS-EST2 IN GDG-FLD
                GO TO FIN-VAL-GDG-COD-EST2.

      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'ES2' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-EST2 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.

           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-COD-EST2 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-EST2 IN GDG-FLD
               GO TO FIN-VAL-GDG-COD-EST2
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-EST2 IN GDG-FLD.
      *
           IF (GDG-COD-EST2 IN GDG-FLD NOT = WSS-ES2-ANT IN CMA-VARI)
               IF  GDG-COD-EST2 IN GDG-FLD > 10  OR
                   (WSS-ES2-ANT IN CMA-VARI = SPACES AND
                    GDG-COD-EST2  IN GDG-FLD  > 05)

               OR (WSS-ES2-ANT IN CMA-VARI = 05     AND
                   GDG-COD-EST2     IN GDG-FLD  NOT > 05)
                  MOVE 'BGL' TO MSG-COD-SIST
                  MOVE 'GDGEJENOPERM' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GDG-COD-EST2.
      *
      *>>>>
*% END
*% IF INI_GDG_FEC_FALZ
      *<<<< INI_GDG_FEC_ALZ

           IF GDG-IND-EST1 IN GDG-FLD < '20'
      *MHM-INI 14-OCT-2003
              OR SCR-CMND = 'EJE'
      *MHM-FIN 14-OCT-2003
               MOVE 0 TO GDG-NUM-SALZ IN GDG-FLD
               MOVE 0 TO GDG-NUM-AALZ IN GDG-FLD
               MOVE 0 TO GDG-NUM-MALZ IN GDG-FLD
               MOVE 0 TO GDG-NUM-DALZ IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-FALZ.

      * ALZAMIENTO
           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *>>>>
*% END
*% IF GDG_FEC_FALZ
      *<<<< GDG_FEC_ALZ
           
           IF NOT FEC-STAT-OKS
               GO TO FIN-VAL-GDG-FEC-FALZ.

           MOVE FEC-CHOY-N TO FEC-CHOY.

           MOVE GDG-NUM-SEST IN GDG-FLD TO FEC-SEC1.
           MOVE GDG-NUM-AEST IN GDG-FLD TO FEC-AEC1.
           MOVE GDG-NUM-MEST IN GDG-FLD TO FEC-MEC1.
           MOVE GDG-NUM-DEST IN GDG-FLD TO FEC-DEC1.


           MOVE GDG-NUM-SALZ IN GDG-FLD TO FEC-SEC2.
           MOVE GDG-NUM-AALZ IN GDG-FLD TO FEC-AEC2.
           MOVE GDG-NUM-MALZ IN GDG-FLD TO FEC-MEC2.
           MOVE GDG-NUM-DALZ IN GDG-FLD TO FEC-DEC2.


           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ALZ<CNS' TO MSG-COD-MENS
               MOVE 'BGL'     TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_GDG_FEC_FVTO
      *<<<< INI_GDG_FEC_FVTO
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.
            IF SCR-OFRM-SRV AND
               SCR-CMND = 'ING' AND 
               GDG-FEC-FVTO IN GDG-FLD NOT > ZEROES
                GO TO FIN-VAL-GDG-FEC-FVTO.
      *RRM-FIN 3-JUL-2002
      *------------------------------------------------*
      *MHM-INI 13-AUG-2003
           IF GDG-COD-LGTA IN GDG-FLD NOT = 'E'
               GO TO CNT-VAL-GDG-FEC-FVTO.

           IF GAR-IND-SVTO IN CMA-VARI = 'N'
               GO TO CNT-VAL-GDG-FEC-FVTO.

      *MHM-INI 30-SEP-2003
      *     IF SCR-CMND NOT = 'ING' AND SCR-CMND = 'MOD'
      *         GO TO FIN-VAL-GDG-FEC-FVTO.
      *MHM-FIN 30-SEP-2003

           IF (((SCR-CMND NOT = 'AGA')  AND                             
               ((SCR-CMND NOT = 'MGA')) AND                             
                (SCR-CMND NOT = 'ACE')))                                
               GO TO CNT-VAL-GDG-FEC-FVTO.

           MOVE ZEROES TO WSS-NUM-SVTO IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-AVTO IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-MVTO IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-DVTO IN WSS-VARI.

           MOVE GDG-CAI-GTIA IN GDG-FLD TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GES-IIC-GTIA IN GES.
           MOVE ZEROES              TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-GES.
           PERFORM BGL-FIO-GES.
           IF NOT ( FIO-STAT-OKS AND
              GES-CAI-GTIA IN GES = GDG-CAI-GTIA IN GDG-FLD AND
              GES-IIC-GTIA IN GES = GDG-IIC-GTIA IN GDG-FLD )
               GO TO FIN-VAL-GDG-FEC-FVTO.

           MOVE GES-CAI-IOPC IN GES TO DLC-CAI-IOPC IN DLC.
           MOVE GES-IIC-IOPC IN GES TO DLC-IIC-IOPC IN DLC.
           MOVE GES-NUM-IDLC IN GES TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NEX' TO MSG-COD-MENS
               GO TO ERR-VAL-GDG-FEC-FVTO.
           
           IF DLC-FEC-FMAV IN DLC > WSS-FEC-FVTO IN WSS-VARI
              MOVE DLC-FEC-FMAV IN DLC TO WSS-FEC-FVTO IN WSS-VARI
              MOVE WSS-NUM-SVTO IN WSS-VARI TO GDG-NUM-SVTO IN GDG-FLD
              MOVE WSS-NUM-AVTO IN WSS-VARI TO GDG-NUM-AVTO IN GDG-FLD
              MOVE WSS-NUM-MVTO IN WSS-VARI TO GDG-NUM-MVTO IN GDG-FLD
              MOVE WSS-NUM-DVTO IN WSS-VARI TO GDG-NUM-DVTO IN GDG-FLD.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-LEE-GES.
 
       CNT-VAL-GDG-FEC-FVTO.
      *MHM-FIN 13-AUG-2003
           MOVE FEC-VHBL-N    TO FEC-VHBL.

           MOVE GDG-NUM-SVTO IN GDG-FLD TO FEC-SVLD.
           MOVE GDG-NUM-AVTO IN GDG-FLD TO FEC-AVLD.
           MOVE GDG-NUM-MVTO IN GDG-FLD TO FEC-MVLD.
           MOVE GDG-NUM-DVTO IN GDG-FLD TO FEC-DVLD.

*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE FEC-VHBL-N TO FEC-VHBL.

           MOVE GDG-NUM-SVTO IN GDG-FLD TO FEC-SVLD.
           MOVE GDG-NUM-AVTO IN GDG-FLD TO FEC-AVLD.
           MOVE GDG-NUM-MVTO IN GDG-FLD TO FEC-MVLD.
           MOVE GDG-NUM-DVTO IN GDG-FLD TO FEC-DVLD.
           IF GAR-IND-SVTO IN CMA-VARI = 'S'
      *MHM-INI 27-DIC-2004                                              
      *        IF FEC-FVLD = '00000000' OR > '20201231'                 
               IF FEC-FVLD = '00000000' OR > '20991231'                 
      *MHM-FIN 27-DIC-2004                                              
                   MOVE 'VTO=0' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-FEC-FVTO
               ELSE
                   NEXT SENTENCE
           ELSE
           IF GAR-IND-SVTO IN CMA-VARI = 'N'
      *MHM-INI 29-SEP-2003
               OR ( GAR-IND-SVTO IN CMA-VARI = 'O' AND
                    FEC-FVLD = '00000000' )
      *MHM-FIN 29-SEP-2003
               MOVE 20 TO GDG-NUM-SVTO IN GDG-FLD
               MOVE 99 TO GDG-NUM-AVTO IN GDG-FLD
               MOVE 12 TO GDG-NUM-MVTO IN GDG-FLD
               MOVE 31 TO GDG-NUM-DVTO IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-FVTO.
      *>>>>
*% ELSE
           IF GAR-IND-SVTO IN CMA-VARI = 'N' OR 
             ( GAR-IND-SVTO IN CMA-VARI = 'O' AND
               FEC-FVLD = '00000000')         
               MOVE 20 TO GDG-NUM-SVTO IN GDG-FLD
               MOVE 99 TO GDG-NUM-AVTO IN GDG-FLD
               MOVE 12 TO GDG-NUM-MVTO IN GDG-FLD
               MOVE 31 TO GDG-NUM-DVTO IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-FVTO.

           IF GAR-IND-SVTO IN CMA-VARI  = 'S'
              IF FEC-FVLD = '00000000'
                 MOVE 'VTO=0' TO MSG-COD-MENS
                 GO TO ERR-VAL-GDG-FEC-FVTO.

      *>>>>
*% END
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF GDG_FEC_FVTO
      *<<<< GDG_FEC_VTO
           
           MOVE GDG-NUM-SSOL IN GDG-FLD TO FEC-SEC1.
           MOVE GDG-NUM-ASOL IN GDG-FLD TO FEC-AEC1.
           MOVE GDG-NUM-MSOL IN GDG-FLD TO FEC-MEC1.
           MOVE GDG-NUM-DSOL IN GDG-FLD TO FEC-DEC1.
      *-----------------------------------------------*
           MOVE GDG-NUM-SVTO IN GDG-FLD TO FEC-SEC2.
           MOVE GDG-NUM-AVTO IN GDG-FLD TO FEC-AEC2.
           MOVE GDG-NUM-MVTO IN GDG-FLD TO FEC-MEC2.
           MOVE GDG-NUM-DVTO IN GDG-FLD TO FEC-DEC2.
      *-----------------------------------------------*
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'VTO<=SOL' TO MSG-COD-MENS
               GO TO ERR-VAL-GDG-FEC-FVTO.

*% IF ( PGM_PER OR PGM_CLB OR PGM_MEX )
      *<<<< ( PGM_PER OR PGM_CLB OR PGM_MEX )
           IF ( SCR-CMND = 'MGA')
               MOVE GDG-FEC-FVTO IN GDG-FLD TO FEC-FEC1.
               GO TO VAL-MGA.

           IF NOT ( SCR-CCPP = 'ING' OR SCR-CMND = 'MOD' )
               GO TO FIN-VAL-GDG-FEC-FVTO.

           MOVE GDG-FEC-FVTO IN GDG-FLD TO FEC-FEC1.
           IF SCR-CCPP = 'ING' 
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO FEC-DEC2
               MOVE HOY-MHOY TO FEC-MEC2         
               MOVE HOY-SHOY TO FEC-SEC2         
               MOVE HOY-AHOY TO FEC-AEC2         
           ELSE
               MOVE GDG-NUM-DING IN GDG-FLD TO FEC-DEC2
               MOVE GDG-NUM-MING IN GDG-FLD TO FEC-MEC2
               MOVE GDG-NUM-AING IN GDG-FLD TO FEC-AEC2
               MOVE GDG-NUM-SING IN GDG-FLD TO FEC-SEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-GRT
               MOVE 'FVTO<=FING' TO MSG-COD-MENS
               GO TO ERR-VAL-GDG-FEC-FVTO.

       VAL-MGA.
           IF SCR-CMND = 'MGA' 
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO FEC-DEC2
               MOVE HOY-MHOY TO FEC-MEC2         
               MOVE HOY-SHOY TO FEC-SEC2         
               MOVE HOY-AHOY TO FEC-AEC2         
           ELSE
               GO TO FIN-VAL-GDG-FEC-FVTO.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-GRT
               MOVE 'FVTO<=FHOY' TO MSG-COD-MENS
               GO TO ERR-VAL-GDG-FEC-FVTO.
      *>>>>
*% END
           GO TO FIN-VAL-GDG-FEC-FVTO.
       ERR-VAL-GDG-FEC-FVTO.
           MOVE 'BGL'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_GDG_FEC_FSOL
      *<<<< INI_GDG_FEC_SOL_CNS
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
              MOVE FEC-CHOY-N TO FEC-CHOY.                              
      *AFRI-FIN/JUL2005                                                 
           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *>>>>
*% END
*% IF FRM_NUM_ICLI
      *<<<< FRM_NUM_ICLI
      *AFRI-INI/JUL2004
           IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND
              GDG-IND-CBAN IN GDG-FLD = 'S'
               PERFORM ERR-GLS.
      *AFRI-FIN/JUL2004
      *>>>>
*% END
*% IF FRM_VRF_ICLI
      *<<<< FRM_VRF_ICLI
           IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES
               MOVE FRM-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE FRM-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC
               MOVE FRM-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI
                   MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.
      *>>>>
*% END
*% IF INI_GDG_FEC_FEST
      *<<<< INI_GDG_FEC_ESC_CNS

           IF GDG-IND-EST1 IN GDG-FLD < '10'
               MOVE 0 TO GDG-NUM-SEST IN GDG-FLD
               MOVE 0 TO GDG-NUM-AEST IN GDG-FLD
               MOVE 0 TO GDG-NUM-MEST IN GDG-FLD
               MOVE 0 TO GDG-NUM-DEST IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-FEST.

           IF GDG-IND-EST1 IN GDG-FLD > '19'
               GO TO FIN-VAL-GDG-FEC-FEST.
      *>>>>
*% END
*% IF GDG_FEC_FEST
      *<<<< GDG_FEC_ESC_CNS

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GDG-NUM-SEST IN GDG-FLD TO FEC-SEC1.
           MOVE GDG-NUM-AEST IN GDG-FLD TO FEC-AEC1.
           MOVE GDG-NUM-MEST IN GDG-FLD TO FEC-MEC1.
           MOVE GDG-NUM-DEST IN GDG-FLD TO FEC-DEC1.
      *------------------------------------------------------*
           MOVE GDG-NUM-SEST IN GDG-FLD TO FEC-SEC2.
           MOVE GDG-NUM-AEST IN GDG-FLD TO FEC-AEC2.
           MOVE GDG-NUM-MEST IN GDG-FLD TO FEC-MEC2.
           MOVE GDG-NUM-DEST IN GDG-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ESC<SOL' TO MSG-COD-MENS
               PERFORM ERR-VAL-GDG-FEC-FVTO
               GO TO FIN-VAL-GDG-FEC-FEST.

           PERFORM GET-FHOY.
           MOVE HOY-SHOY TO FEC-SEC1.
           MOVE HOY-AHOY TO FEC-AEC1.
           MOVE HOY-MHOY TO FEC-MEC1.
           MOVE HOY-DHOY TO FEC-DEC1.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'ESC>HOY' TO MSG-COD-MENS
               PERFORM ERR-VAL-GDG-FEC-FVTO
               GO TO FIN-VAL-GDG-FEC-FEST.

*% IF ( PGM_PER OR PGM_CLB OR PGM_MEX )
      *<<<< ( PGM_PER OR PGM_CLB OR PGM_MEX )
      * 
           MOVE GDG-FEC-FVTO IN GDG-FLD TO FEC-FEC1.
           MOVE GDG-FEC-FEST IN GDG-FLD TO FEC-FEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-GRT
               MOVE 'VTO<=CNS' TO MSG-COD-MENS
               PERFORM ERR-VAL-GDG-FEC-FVTO
               GO TO FIN-VAL-GDG-FEC-FEST.
      *>>>>
*% END
      *>>>>
*% END
*% IF GDG_IND_INOB
      *<<<< GDG_IND_OBL_INS
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-IND-INOB.

           IF TAG-IND-EGIN IN TAG = 'N' OR
              GDG-IND-INOB IN GDG-FLD NOT > SPACES
               MOVE 'N' TO GDG-IND-INOB IN GDG-FLD.

      *VAL-COD Valida codigo de tabla
        *EVA-AFRI/ABR2007                                                 
      *    MOVE 'BGL' TO TAB-COD-SIST.                                  
      *    MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.                          
      *    MOVE GDG-IND-INOB IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
      *    PERFORM VAL-COD.                                             
      *FIN-AFRI/ABR2007                                                 
      *>>>>
*% ELSE
      *RRM-INI 31-MAY-2002
           IF SCR-CCPP = 'MGA'
               GO TO FIN-VAL-GDG-IND-INOB.
      *RRM-FIN 31-MAY-2002

           IF GDG-IND-INOB IN GDG-FLD NOT > SPACES
           IF TAG-IND-EGIN IN TAG = 'O'
              MOVE SPACES TO GDG-IND-INOB IN GDG-FLD
           ELSE
             MOVE TAG-IND-EGIN IN TAG TO GDG-IND-INOB IN GDG-FLD.

      *VAL-COD Valida codigo de tabla
       VALIDA-GDG-IND-INOB.
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IND-INOB IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           GO TO FIN-VAL-GDG-IND-INOB.

      *RRM-INI 31-MAY-2002
       ERR-VAL-GDG-IND-INOB.
           MOVE 'BGL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-GDG-IND-INOB.
      *RRM-FIN 31-MAY-2002
      *>>>>
*% END
      *>>>>
*% END
*% IF GDG_IND_GTAC
      *<<<< GDG_IND_CPL
      *FLB CST  22-NOV-1993
           IF GDG-IND-GTAC IN GDG-FLD NOT > SPACES
              MOVE 'N' TO GDG-IND-GTAC IN GDG-FLD.
      *>>>>
*% END
*% IF INI_KEY_DBC_GDG
      *<<<< INI_KEY_DBC_GDG
      *
           MOVE CNE-GDD-CIC-ICLI TO DBC-IDC-ICLI IN DBC.
           MOVE CNE-DBC-GLS-NOMC TO DBC-GLS-NOMC IN DBC.
           GO TO FIN-KEY-DBC-GDG. 
      *>>>>
*% END
*% IF FIN_CLR_KEY_GDG
      *<<<< FIN_CLR_KEY_GDG
*% IF GEN_BCI
      *<<<< GEN_BCI
      *MHM-INI 03-NOV-2004                                              
           IF SCR-CMND NOT = 'ING'                                      
               GO TO CNT-CLR-KEY-GDG.                                   
      *MHM-FIN 03-NOV-2004                                              
           MOVE 'BGL' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE '001' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-IND-VIGE IN TAB NOT = 'S'
      *        FLB: version 'B'anco
      *         MOVE 'B' TO SCR-IND-V001
               MOVE SPACES TO MSG-COD-MENS
               MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD
      *INI-AFRI/MAY-2005                                                
               IF SCR-HDR-MRCA = 'BCS'                                  
                  MOVE '0800' TO GDG-CAI-GTIA IN GDG-FLD                
               ELSE                                                     
                  MOVE '0500' TO GDG-CAI-GTIA IN GDG-FLD                
      *        MOVE '0500' TO GDG-CAI-GTIA IN GDG-FLD                   
               END-IF                                                   
      *FIN-AFRI/MAY-2005                                                
               MOVE 0  TO GDG-CAI-GTIA-LEN IN GDG-FLD
               MOVE -1 TO GDG-IIC-GTIA-LEN IN GDG-FLD.
      *     ELSE
      *        FLB: version 'C'onsist
      *         MOVE 'C' TO SCR-IND-V001.
      *>>>>
      *MHM-INI 03-NOV-2004                                              
       CNT-CLR-KEY-GDG.                                                 
      *MHM-FIN 03-NOV-2004                                             
            MOVE SPACES TO CNE-DBC-GLS-NOMC.                            
            MOVE SPACES TO CNE-DBC-CAI-ICLI.                            
            MOVE ZEROES TO CNE-DBC-IIC-ICLI.                            
            MOVE SPACES TO CNE-GDG-GLS-NOMP.                            
            MOVE SPACES TO CNE-GDG-CAI-ICLI.                            
            MOVE ZEROES TO CNE-GDG-IIC-ICLI.                            
      *>>>>
*% END
*% END
*% IF GDG_IND_UTIL
      *<<<< GDG_ING_UTIL
           IF ( GDG-IND-UTIL IN GDG-FLD = SPACES )
               MOVE 'N' TO GDG-IND-UTIL IN GDG-FLD.
      *>>>>
*% END
*% IF INI_VAL_GDG_IND_CBAN
      *<<<<< INI_GDG_IND_CBAN
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.
           IF SCR-OFRM-SRV AND
              SCR-CMND = 'ING' AND 
              GDG-IND-CBAN IN GDG-FLD NOT > SPACES
                MOVE SPACES TO GDG-IND-CBAN IN GDG-FLD
                GO TO FIN-VAL-GDG-IND-CBAN.
      *RRM-FIN 3-JUL-2002

           IF ( GDG-IND-CBAN IN GDG-FLD NOT > SPACES )
               MOVE SPACES TO GDG-IND-CBAN IN GDG-FLD.
      
           IF  GDG-IND-CBAN IN GDG-FLD NOT = 'N' AND NOT = 'S'
               MOVE 'BGL'         TO MSG-COD-SIST
               MOVE 'ICBAN   N/S' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *
           IF GDG-IND-CBAN IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-IND-CBAN.
      *
      
      * EVA-AFRI/ABR2007                                                
      *    IF  GDG-IND-CBAN IN GDG-FLD = 'N'                            
      *<<<< FMT_CHI                                                     
      *          MOVE ZEROES TO FRM-NUM-ICLI IN GDG-FLD                 
      *         MOVE SPACES TO FRM-IND-ICLI IN GDG-FLD                  
      *         MOVE SPACES TO FRM-GLS-ICLI IN GDG-FLD                  
      * AFRI-INI (14-07-04)                                             
      *         MOVE SPACES TO FRM-VRF-ICLI IN GDG-FLD                  
      * AFRI-FIN (14-07-04)                                             
      *         MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD.       
      *FIN-AFRI/ABR2007                                                 
      *>>>>                                                             
      *EVA-AFRI/ABR2007                                                 
      *     IF  GDG-IND-CBAN IN GDG-FLD = 'S'                           
      *         MOVE SPACES TO  FRM-GLS-NOMC IN GDG-FLD                 
      *         MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-STP.                  
      *     IF GDG-IND-CBAN IN GDG-FLD NOT > SPACES                     
      *          PERFORM ERR-GLS                                        
      *          GO TO FIN-VAL-GDG-IND-CBAN.                            
                                                                        
           IF  GDG-IND-CBAN IN GDG-FLD = 'S'                            
               MOVE SPACES TO  GDG-GLS-NOMP IN GDG-FLD                  
               MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-STP                    
           ELSE                                                         
               MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-STP.                   
      *>>>>                                                             
      *     IF GDG-IND-CBAN IN GDG-FLD NOT > SPACES                     
      *          PERFORM ERR-GLS                                        
      *          GO TO FIN-VAL-GDG-IND-CBAN.                            
      *FIN-AFRI/ABR2007                                                 
*% END
*% IF INI_GDG_COD_DESP
      *<<<< INI_GDG_COD_DESP
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.
           IF SCR-OFRM-SRV AND
              SCR-CMND = 'ING' AND 
              GDG-COD-DESP IN GDG-FLD NOT > SPACES
                MOVE SPACES TO GDG-COD-DESP IN GDG-FLD
                MOVE SPACES TO FRM-GLS-DESP IN GDG-FLD
                GO TO FIN-VAL-GDG-COD-DESP.
      *RRM-FIN 3-JUL-2002

           IF GDG-COD-DESP IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-DESP IN GDG-FLD
              MOVE SPACES TO FRM-GLS-DESP IN GDG-FLD
              GO TO FIN-VAL-GDG-COD-DESP.
      *>>>>
*% END
*% IF GDG_CIC_EJOR AND GEN_BCI
      *<<<< GDG_CIC_EJOR AND GEN_BCI
           IF GDG-CIC-EJOR IN GDG-FLD = SPACES AND
              CMA-IND-DAP IN CMA-VARI = 'S'
               MOVE OPD-COD-EJEC IN OPD TO GDG-CIC-EJOR IN GDG-FLD.

           IF SCR-CMND = 'ALZ'
               GO TO FIN-VAL-GDG-CIC-EJOR.

      *>>>>                                                             
      * EVA-INI   07/08                                                 
      *AFRI-INI                                                         
      *    IF SCR-HDR-MRCA = 'BCS'                                      
      *        MOVE OFI-COD-JFOF IN OFI TO                              
      *             GDG-CIC-EJOR IN GDG-FLD                             
      *        GO TO VAL-SOL-USR.                                       
      *AFRI-FIN                                                         
      * EVA-FIN   07/08                                                 
      * EVA-INI   07/08                                                 
           IF SCR-HDR-MRCA = 'BCS' AND                                  
              WSS-IND-TVSN IN WSS-VARI = 'N'                            
              MOVE DBC-COD-OFIC IN DBC TO GDG-COD-OFIC IN GDG-FLD       
              MOVE DBC-COD-EJEC IN DBC TO GDG-CIC-EJOR IN GDG-FLD.      
      * EVA-FIN   07/08                                                 
      *>>>>
*% END
*% IF FIN_GDG_CIC_EJOR
      *<<<< FIN_GDG_CIC_EJOR 
      *AFRI-INI                                                         
       VAL-SOL-USR.                                                     
      *AFRI-FIN                                                         
      *BUS-USR busca usuario en tablas
           IF GDG-CIC-EJOR IN GDG-FLD > SPACES
               MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN GDG-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-EJOR IN GDG-FLD.
      *>>>>
*% END
*% IF GDG_COD_RFCP
      *<<<< GDG_COD_RFCP
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.
           IF SCR-OFRM-SRV AND
              SCR-CMND = 'ING' AND 
              GDG-COD-RFCP IN GDG-FLD NOT > SPACES
                GO TO FIN-VAL-GDG-COD-RFCP.
      *RRM-FIN 3-JUL-2002
      *>>>>
*% END
*% IF FRM_IDC_ICLI
      *<<<< FRM_IDC_ICLI
      *Num.Propietario
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.
           IF SCR-OFRM-SRV AND
              SCR-CMND = 'ING' AND 
              FRM-IDC-ICLI IN GDG-FLD = ZEROES
                GO TO FIN-VAL-FRM-IDC-ICLI.
      *RRM-FIN 3-JUL-2002

           IF FRM-IDC-ICLI IN GDG-FLD = ZEROES AND
              GDG-IND-CBAN IN GDG-FLD = 'S'
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'CLI X  NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-IDC-ICLI.
      
      
           IF FRM-IDC-ICLI IN GDG-FLD NOT = ZEROES AND
              GDG-IND-CBAN IN GDG-FLD = 'N'
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'CLI Y NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-IDC-ICLI.
      
            IF FRM-IDC-ICLI IN GDG-FLD NOT = ZEROES
               MOVE FRM-IDC-ICLI IN GDG-FLD TO DBC-IDC-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'CLI    NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI
                 MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                 PERFORM CPT-BLKS
                 MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.

      *>>>>
*% END 
*% IF FRM_GLS_NOMC
      *<<<< FRM_GLS_NOMC Nombre prorietario
      *MHM-INI 29-OCT-2003
      *INI-AFRI/MAY-2005                                                
      *    IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND                
           IF (CMA-CIC-UING IN CMA-VARI = 'MIGRACION' OR                
              GDG-CAI-GTIA IN GDG-FLD = '0800') AND                     
      *FIN-AFRI/MAY-2005                                                
              FRM-GLS-NOMC IN GDG-FLD NOT > SPACES
               GO TO FIN-VAL-FRM-GLS-NOMC.
      *MHM-FIN 29-OCT-2003
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.
      *     IF SCR-OFRM-SRV AND
      *        SCR-CMND = 'ING' AND 
      *        FRM-GLS-NOMC IN GDG-FLD NOT > SPACES
      *         GO TO FIN-VAL-FRM-GLS-NOMC.
      *RRM-FIN 3-JUL-2002

*% IF FMT_CHI
      *<<<<
           IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND
      *>>>>
*% ELSE
           IF FRM-IDC-ICLI IN GDG-FLD = ZEROES AND
*% END
              GDG-IND-CBAN IN GDG-FLD = 'N'  AND
              FRM-GLS-NOMC IN GDG-FLD NOT > SPACES
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'CLI-NOM-NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-GLS-NOMC.
      
            MOVE FRM-GLS-NOMC IN GDG-FLD TO CNE-GDG-GLS-NOMP.

*% END 
*% IF DBC_IDC_ICLI
      *<<<< DBC_IDC_ICLI
      *LOP-INI VERSION 0 BANAMEX
            IF DBC-IDC-ICLI IN GDG-FLD = 'M'
               MOVE ZEROES TO DBC-IDC-ICLI IN GDG-FLD
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'GDGMDDIRNO'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE FRM-POS-CURS TO DBC-IDC-ICLI-LEN IN GDG-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DBC-IDC-ICLI.

           IF DBC-IDC-ICLI IN GDG-FLD NOT > ZEROES
              MOVE ZEROES TO DBC-IDC-ICLI IN GDG-FLD
              IF SCR-CMND = 'ING'
                 MOVE 'SGC'        TO MSG-COD-SIST
                 MOVE 'INDNUMICLII' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE FRM-POS-CURS TO DBC-IDC-ICLI-LEN IN GDG-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-DBC-IDC-ICLI.

           IF MSG-COD-MENS NOT > SPACES AND
              DBC-IDC-ICLI IN GDG-FLD NOT = ZEROES
              MOVE DBC-IDC-ICLI IN GDG-FLD TO DBC-IDC-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GET-CLI
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-IDC-ICLI
               ELSE
               IF MSG-GLS-DESC > SPACES
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                      PERFORM CPT-BLKS
                      MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD
                      GO TO FIN-VAL-DBC-IDC-ICLI
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO CNE-DBC-CAI-ICLI
                   MOVE DBC-IIC-ICLI IN DBC TO CNE-DBC-IIC-ICLI
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *>>>> 
*% END
*% IF EOF
      *<<<< EOF
*% IF GEN_BCI
      *<<<< GEN_BCI
       BUS-RCC SECTION.
       INI-BUS-RCC.
      * Muestra Primer Cliente del OPD de DAP mediante RCC
           MOVE FRM-CAI-IOPD IN GDG-FLD TO RCC-CAI-IOPD IN RCC.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (
                  FIO-STAT-OKS AND
                  FRM-CAI-IOPD IN GDG-FLD = RCC-CAI-IOPD IN RCC AND
                  FRM-IIC-IOPD IN GDG-FLD = RCC-IIC-IOPD IN RCC
                  )
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'RCC    NEX'   TO MSG-COD-MENS
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-RCC.
       FIN-BUS-RCC.
           EXIT.
      *>>>>
*% END
*% IF EOF_BU
      *<<<<
      *EVA-AFRI/ABR2007                                                 
       CLI-NEX SECTION.                                                 
       INI-CLI-NEX.                                                     
           MOVE IDC-ZERO-S TO IDC-ZERO.                                 
           MOVE GDG-NUM-IPRO IN GDG-FLD TO IDC-NUM-RUTV.                
           MOVE GDG-VRF-IPRO IN GDG-FLD TO IDC-VRF-RUTV.                
           PERFORM VAL-RUT.                                             
           MOVE GDG-NUM-IPRO IN GDG-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE GDG-IND-IPRO IN GDG-FLD TO DBC-IND-ICLI IN DBC.         
           MOVE GDG-GLS-IPRO IN GDG-FLD TO DBC-GLS-ICLI IN DBC.         
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.                            
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF FIO-STAT-OKS                                              
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'CLI    EXI' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE SPACES       TO GDG-GLS-NOMP IN GDG-FLD              
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
              MOVE SPACES TO GDG-CAI-ICLI IN GDG                        
              MOVE ZEROES TO GDG-IIC-ICLI IN GDG                        
              PERFORM VAL-RUT.                                          
       FIN-CLI-NEX.                                                     
           EXIT.                                                        
      *FIN-AFRI/ABR2007                                                 
      *>>>> 
      * EVA-INI  07/08                                                  
       VAL-VSN SECTION.                                                 
       INI-VAL-VSN.                                                     
                                                                        
           MOVE 'S' TO WSS-IND-TVSN IN WSS-VARI.                        
                                                                        
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'VSN'               TO TAB-COD-TTAB IN TAB.             
           MOVE '01'                TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
              MOVE 'N' TO WSS-IND-TVSN IN WSS-VARI.                     
                                                                        
       FIN-VAL-VSN.                                                     
           EXIT.                                                        
                                                                        
       VAL-CEN SECTION.                                                 
       INI-VAL-CEN.                                                     
                                                                        
           MOVE 'S' TO WSS-IND-OCEN IN WSS-VARI.                        
                                                                        
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'CEN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE USR-COD-OFUS IN USR TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                  TAB-IND-VIGE IN TAB = 'S')                            
              MOVE 'N' TO WSS-IND-OCEN IN WSS-VARI.                     
                                                                        
       FIN-VAL-CEN.                                                     
           EXIT.                                                        
                                                                        
       VAL-EJC SECTION.                                                 
       INI-VAL-EJC.                                                     
                                                                        
           MOVE 'S' TO WSS-IND-EJEC IN WSS-VARI.                        
                                                                        
           MOVE 'EJC '                  TO USR-COD-TTAB IN USR.         
           MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'N' TO WSS-IND-EJEC IN WSS-VARI.                     
                                                                        
           MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN GDG-FLD.         
                                                                        
       FIN-VAL-EJC.                                                     
           EXIT.                                                        
                                                                        
      * EVA-FIN  07/08                                                  
*% END
      *>>>> 
*% END
*% IF FIN_GDG_GLS_NOMP
      *<<<<
           IF GDG-IND-CBAN IN GDG-FLD = 'N' AND                         
              GDG-NUM-IPRO IN GDG-FLD > SPACES AND                      
              GDG-GLS-NOMP IN GDG-FLD = SPACES                          
              PERFORM ERR-GLS.                                          
                                                                        
      *EVA-AFRI/ABR2007                                                 
      *<<<< FRM_GLS_NOMC Nombre prorietario                             
      *MHM-INI 29-OCT-2003                                              
      *INI-AFRI/MAY-2005                                                
      *    IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND                
      *     IF (CMA-CIC-UING IN CMA-VARI = 'MIGRACION' OR               
      *        GDG-CAI-GTIA IN GDG-FLD = '0800') AND                    
      *FIN-AFRI/MAY-2005                                                
      *        FRM-GLS-NOMC IN GDG-FLD NOT > SPACES                     
      *         GO TO FIN-VAL-FRM-GLS-NOMC.                             
      *MHM-FIN 29-OCT-2003                                              
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.     
      *     IF SCR-OFRM-SRV AND                                         
      *        SCR-CMND = 'ING' AND                                     
      *        FRM-GLS-NOMC IN GDG-FLD NOT > SPACES                     
      *         GO TO FIN-VAL-FRM-GLS-NOMC.                             
      *RRM-FIN 3-JUL-2002                                               
                                                                        
      *<<<<                                                             
      *     IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND                     
      *>>>>                                                             
      *        GDG-IND-CBAN IN GDG-FLD = 'N'  AND                       
      *        FRM-GLS-NOMC IN GDG-FLD NOT > SPACES                     
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI-NOM-NEX' TO MSG-COD-MENS                   
      *            PERFORM GET-MSG                                      
      *            MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD         
      *            MOVE MSG-GLS-DESC TO FRM-MENS                        
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR                        
      *            GO TO FIN-VAL-FRM-GLS-NOMC.                          
                                                                        
      *      MOVE FRM-GLS-NOMC IN GDG-FLD TO CNE-GDG-GLS-NOMP.          
      *FIN-AFRI/ABR2007                                                 
                                                                        
      *>>>>
*% END
*% IF FRM_IIC_IOPD
      *<<<< FRM_IIC_IOPD
*% IF GEN_BCI
      *<<<< GEN_BCI
           IF CMA-IND-DAP IN CMA-VARI NOT = 'S' 
               GO TO FIN-VAL-FRM-IIC-IOPD.

           MOVE FRM-CAI-IOPD IN GDG-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               IF SCR-CMND = 'ALZ' AND WSS-ALZ-DAP IN WSS-VARI = 'S'
      *EVA-AFRI/ABR2007                                                 
                   MOVE 'BGL'          TO MSG-COD-SIST                  
      *FIN-AFRI/ABR2007                                                 
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
               ELSE
                   MOVE 'BGL'          TO MSG-COD-SIST
                   MOVE 'OPD    NEX'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF OPD-COD-STAT IN OPD NOT = 'G'
               IF SCR-CMND = 'ALZ' AND
                  WSS-ALZ-DAP IN WSS-VARI = 'S' AND
                  OPD-COD-STAT IN OPD = 'L'
                   MOVE 'OPD    YALIQ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
               ELSE
                   MOVE 'BGL'            TO MSG-COD-SIST
                   MOVE 'OPD    NOVIG'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF OPD-COD-GPOD IN OPD = 'N'
                MOVE 'BGL'            TO MSG-COD-SIST
                MOVE 'OPDNOPERMITI'   TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
      * EVA-INI  07/08                                                  
           IF OPD-VAL-SCAP IN OPD NOT > ZEROES                          
                MOVE 'BGL'            TO MSG-COD-SIST                   
                MOVE 'OPD    CAP=0'   TO MSG-COD-MENS                   
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
           ELSE                                                         
      * EVA-FIN  07/08                                                  
               MOVE 'N'              TO GDG-IND-INOB IN GDG-FLD
               IF OPD-MSC-TVAL IN OPD = '1'
                   MOVE 'BGL'        TO FIO-SIST
                   MOVE 'VSN'        TO TAB-COD-TTAB IN TAB
                   MOVE 'GDGVCB DAP' TO TAB-COD-CTAB IN TAB
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-TAB
                   IF FIO-STAT-OKS AND
                      TAB-IND-VIGE IN TAB = 'S'
      *            Version 'BCI'
                       MOVE OPD-COD-VCAM IN OPD TO GDG-COD-VCAM IN GDG
      *MHM-INI 29-DIC-2004                                              
      *                MOVE '01'                TO GDG-COD-TVCM IN GDG  
                       MOVE '01'                TO GDG-COD-TCGT IN GDG  
      *MHM-FIN 29-DIC-2004                                              
                       MOVE GDG-COD-VCAM IN GDG TO 
                                               GDG-COD-VCAM IN GDG-FLD
                   ELSE
      *            Version 'CST'
                       MOVE OPD-COD-VCAM IN OPD TO 
                                               GDG-COD-VCAM IN GDG-FLD
               ELSE
                   MOVE OPD-COD-VCAM IN OPD TO GDG-COD-VCAM IN GDG-FLD.
      *>>>> 
*% END
      *>>>> 
*% END
*% IF GDG_COD_VCAM AND GEN_BCI
      *<<<< GDG_COD_VCAM AND GEN_BCI
           IF MSG-COD-MENS = 'COD    NEX'
               GO TO FIN-VAL-GDG-COD-VCAM.
      * Busca Tabla TAG
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAG-COD-TOPE IN TAG.
           MOVE GDG-STP-CGTA IN GDG-FLD TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-VCAM.
      *MHM-INI 30-SEP-2003
           MOVE TAG-IND-SVTO IN TAG TO GAR-IND-SVTO IN CMA-VARI.
      *MHM-FIN 30-SEP-2003

      * Busca Codigo Cuenta Contable en Tabla DCC de GAR
           MOVE 'BGL'                TO TAB-COD-SIST.
           MOVE 'DCC'                TO TAB-COD-TTAB IN TAB.
           MOVE TAG-COD-CGTA IN TAG  TO WSS-COD-CGTA IN WSS-VARI-ADI.
           MOVE GDG-COD-VCAM IN GDG-FLD TO WSS-VCB.
           MOVE WSS-COD-CTA          TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE 'DCC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-VCAM.
      *>>>> 
*% END
*% IF GDG_COD_RLCM AND GEN_BCI
      *<<<< GDG_COD_RLCM AND GEN_BCI
      *MHM-INI 29-OCT-2003
      *INI-AFRI/MAY-2005                                                
      *    IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND                
           IF (CMA-CIC-UING IN CMA-VARI = 'MIGRACION' OR                
              GDG-CAI-GTIA IN GDG-FLD = '0800') AND                     
      *FIN-AFRI/MAY-2005                                                
              GDG-COD-RLCM IN GDG-FLD NOT > SPACES
               GO TO FIN-VAL-GDG-COD-RLCM.
      *MHM-FIN 29-OCT-2003
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-GDG-COD-RLCM.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI.
           IF WSS-CIC-CTAB IN WSS-VARI = '951' AND
              GDG-COD-RLCM IN GDG-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-GDG-COD-RLCM.

      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-RLCM IN GDG-FLD > SPACES
               MOVE 'TAB'  TO TAB-COD-SIST
               MOVE 'COM'  TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-RLCM IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS IN MSG > SPACES
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-GDG-COD-RLCM.
      *>>>> 
*% END
*% IF GDG_COD_RLUN AND GEN_BCI
      *<<<< GDG_COD_RLUN AND GEN_BCI
      *MHM-INI 29-OCT-2003
      *INI-AFRI/MAY-2005                                                
      *    IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND                
           IF (CMA-CIC-UING IN CMA-VARI = 'MIGRACION' OR                
               GDG-CAI-GTIA IN GDG-FLD = '0800' ) AND                   
      *FIN-AFRI/MAY-2005                                                
              GDG-COD-RLUN IN GDG-FLD NOT > SPACES
               GO TO FIN-VAL-GDG-COD-RLUN.
      *MHM-FIN 29-OCT-2003
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-GDG-COD-RLUN.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI.
           IF WSS-CIC-CTAB IN WSS-VARI = '951' AND
              GDG-COD-RLUN IN GDG-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-GDG-COD-RLUN.
      *>>>> 
*% END
*% IF GDG_GLS_RLVR AND GEN_BCI
      *<<<< GDG_GLS_RLVR AND GEN_BCI
      *MHM-INI 29-OCT-2003
      *INI-AFRI/MAY-2005                                                
      *    IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND                
           IF (CMA-CIC-UING IN CMA-VARI = 'MIGRACION' OR                
               GDG-CAI-GTIA IN GDG-FLD = '0800' ) AND                   
      *FIN-AFRI/MAY-2005                                                
              GDG-GLS-RLVR IN GDG-FLD NOT > SPACES
               GO TO FIN-VAL-GDG-GLS-RLVR.
      *MHM-FIN 29-OCT-2003
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-GDG-GLS-RLVR.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI.
           IF WSS-CIC-CTAB IN WSS-VARI = '951' AND
              GDG-GLS-RLVR IN GDG-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-GDG-GLS-RLVR.
      *>>>> 
*% END
*% IF FIN_GDG_COD_OFIC
      *AFRI-INI                                                         
           IF SCR-HDR-MRCA = 'BCS'                                      
               IF GDG-COD-OFIC IN GDG-FLD NOT > SPACES                  
                   PERFORM ERR-GLS                                      
                   GO TO FIN-VAL-GDG-COD-OFIC.                          
      *AFRI-FIN                                                         
*% END
*% IF GDG_COD_OFIC
      *AFRI-INI                                                         
           IF SCR-HDR-MRCA = 'BCS'                                      
               MOVE OFI-COD-JFOF IN OFI TO                              
                    GDG-CIC-EJOR IN GDG-FLD.                            
      *AFRI-FIN                                                         
*% END 
*% IF GDG_IND_ECRS AND GEN_BCI
      *<<<< GDG_IND_ECRS AND GEN_BCI
           IF SCR-CMND NOT = 'MGA'
               GO TO FIN-VAL-GDG-IND-ECRS.

           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IND-ECRS IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           GO TO FIN-VAL-GDG-IND-ECRS.
      *>>>> 
*% END
*% IF GDG_IND_ECRT AND GEN_BCI
      *<<<< GDG_IND_ECRT AND GEN_BCI
           IF SCR-CMND NOT = 'MGA'
               GO TO FIN-VAL-GDG-IND-ECRT.

           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IND-ECRT IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           GO TO FIN-VAL-GDG-IND-ECRT.
      *>>>> 
*% END
*% IF GDG_COD_RERS AND GEN_BCI
      *<<<< GDG_COD_RERS AND GEN_BCI
           IF SCR-CMND NOT = 'MGA'
               GO TO FIN-VAL-GDG-COD-RERS.

           IF GDG-IND-ECRS IN GDG-FLD NOT = 'S'
               MOVE SPACES TO GDG-COD-RERS IN GDG-FLD
               MOVE SPACES TO FRM-GLS-RERS IN GDG-FLD
               GO TO FIN-VAL-GDG-COD-RERS.

      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.
           MOVE GDG-COD-RERS IN GDG-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *BUS-USR busca usuario en tablas
           IF GDG-COD-RERS IN GDG-FLD > SPACES
               MOVE GDG-COD-RERS IN GDG-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RERS IN GDG-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-RERS IN GDG-FLD.
      *>>>>
*% END
*% IF INI_GDG_FEC_FVES AND GEN_BCI
      *<<<< INI_GDG_FEC_FVES AND GEN_BCI
           IF GDG-IND-ECRS IN GDG-FLD NOT = 'S'
               MOVE ZEROES TO GDG-FEC-FVES IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-FVES.

           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *MHM-INI 21-OCT-2003
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *MHM-FIN 21-OCT-2003
      *>>>>
*% END
*% IF GDG_COD_RERT AND GEN_BCI
      *<<<< GDG_COD_RERT AND GEN_BCI
           IF SCR-CMND NOT = 'MGA'
               GO TO FIN-VAL-GDG-COD-RERT.

           IF GDG-IND-ECRT IN GDG-FLD NOT = 'S'
               MOVE SPACES TO GDG-COD-RERT IN GDG-FLD
               MOVE SPACES TO FRM-GLS-RERT IN GDG-FLD
               GO TO FIN-VAL-GDG-COD-RERT.

      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.
           MOVE GDG-COD-RERT IN GDG-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *BUS-USR busca usuario en tablas
           IF GDG-COD-RERT IN GDG-FLD > SPACES
               MOVE GDG-COD-RERT IN GDG-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RERT IN GDG-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-RERT IN GDG-FLD.
      *>>>>
*% END
*% IF INI_GDG_FEC_FVET AND GEN_BCI
      *<<<< INI_GDG_FEC_FVET AND GEN_BCI
           IF GDG-IND-ECRT IN GDG-FLD NOT = 'S'
               MOVE ZEROES TO GDG-FEC-FVET IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-FVET.

           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *MHM-INI 21-OCT-2003
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *MHM-FIN 21-OCT-2003
      *>>>>
*% END
*% IF FIN_UNP_IKY_GDG
      *<<<< FIN_UNP_IKY_GDG
      *MHM-INI 04-NOV-2004                                              
      **MHM-INI 12-NOV-2003                                             
      *     MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR.                      
      **MHM-FIN 12-NOV-2003                                             
      *MHM-FIN 04-NOV-2004                                              
      *>>>>
*% END
*% IF EOF_BU
      *<<<<
      *EVA-AFRI/ABR2007                                                 
       CLI-NEX SECTION.                                                 
       INI-CLI-NEX.                                                     
           MOVE IDC-ZERO-S TO IDC-ZERO.                                 
           MOVE GDG-NUM-IPRO IN GDG-FLD TO IDC-NUM-RUTV.                
           MOVE GDG-VRF-IPRO IN GDG-FLD TO IDC-VRF-RUTV.                
           PERFORM VAL-RUT.                                             
           MOVE GDG-NUM-IPRO IN GDG-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE GDG-IND-IPRO IN GDG-FLD TO DBC-IND-ICLI IN DBC.         
           MOVE GDG-GLS-IPRO IN GDG-FLD TO DBC-GLS-ICLI IN DBC.         
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.                            
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF FIO-STAT-OKS                                              
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'CLI    EXI' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE SPACES       TO GDG-GLS-NOMP IN GDG-FLD              
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
              MOVE SPACES TO GDG-CAI-ICLI IN GDG                        
              MOVE ZEROES TO GDG-IIC-ICLI IN GDG                        
              PERFORM VAL-RUT.                                          
       FIN-CLI-NEX.                                                     
           EXIT.                                                        
      *FIN-AFRI/ABR2007                                                 
      *>>>>                                                             
      * EVA-INI  07/08                                                  
       VAL-VSN SECTION.                                                 
       INI-VAL-VSN.                                                     
                                                                        
           MOVE 'S' TO WSS-IND-TVSN IN WSS-VARI.                        
                                                                        
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'VSN'               TO TAB-COD-TTAB IN TAB.             
           MOVE '01'                TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
              MOVE 'N' TO WSS-IND-TVSN IN WSS-VARI.                     
                                                                        
       FIN-VAL-VSN.                                                     
           EXIT.                                                        
                                                                        
       VAL-CEN SECTION.                                                 
       INI-VAL-CEN.                                                     
                                                                        
           MOVE 'S' TO WSS-IND-OCEN IN WSS-VARI.                        
                                                                        
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'CEN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE USR-COD-OFUS IN USR TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                  TAB-IND-VIGE IN TAB = 'S')                            
              MOVE 'N' TO WSS-IND-OCEN IN WSS-VARI.                     
                                                                        
       FIN-VAL-CEN.                                                     
           EXIT.                                                        
                                                                        
       VAL-EJC SECTION.                                                 
       INI-VAL-EJC.                                                     
                                                                        
           MOVE 'S' TO WSS-IND-EJEC IN WSS-VARI.                        
                                                                        
           MOVE 'EJC '                  TO USR-COD-TTAB IN USR.         
           MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'N' TO WSS-IND-EJEC IN WSS-VARI.                     
                                                                        
           MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN GDG-FLD.         
                                                                        
       FIN-VAL-EJC.                                                     
           EXIT.                                                        
                                                                        
      * EVA-FIN  07/08                                                  
      *>>>>                                                             
*% END
*% IF INI_GDG_GLS_IPRO
      *<<<<
           GO TO FIN-VAL-GDG-GLS-IPRO.
      *>>>>
*% END
*% IF FIN_GDG_VRF_IPRO
      *<<<<
      *<<<< GDG_VRF_IPRO                                                
      *EVA-AFRI/ABR2007                                                 
      *     IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES                     
      *         MOVE FRM-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC     
      *         MOVE FRM-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC     
      *         MOVE FRM-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC     
      *         MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                        
      *         MOVE FIO-GET-KEY TO FIO-CMND                            
      *         PERFORM SGC-FIO-DBC                                     
      *         IF NOT FIO-STAT-OKS                                     
      *             MOVE 'TAB'        TO MSG-COD-SIST                   
      *             MOVE 'CLI    NEX' TO MSG-COD-MENS                   
      *             PERFORM GET-MSG                                     
      *             MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD        
      *             MOVE MSG-GLS-DESC TO FRM-MENS                       
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR                       
      *         ELSE                                                    
      *             MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI        
      *             MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI        
      *             MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                
      *             PERFORM CPT-BLKS                                    
      *             MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.           
                                                                        
                                                                        
           IF GDG-NUM-IPRO IN GDG-FLD > ZEROES AND                      
              GDG-IND-CBAN IN GDG-FLD = 'S'                             
               MOVE GDG-NUM-IPRO IN GDG-FLD TO DBC-NUM-ICLI IN DBC      
               MOVE SPACES                  TO DBC-IND-ICLI IN DBC      
               MOVE SPACES                  TO DBC-GLS-ICLI IN DBC      
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DBC                                      
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'TAB'        TO MSG-COD-SIST                    
                   MOVE 'CLI    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE SPACES       TO GDG-GLS-NOMP IN GDG-FLD         
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-VAL-GDG-VRF-IPRO                           
               ELSE                                                     
                   MOVE DBC-CAI-ICLI IN DBC TO GDG-CAI-ICLI IN GDG      
                   MOVE DBC-IIC-ICLI IN DBC TO GDG-IIC-ICLI IN GDG      
                   MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI         
                   MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI         
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN TO GDG-GLS-NOMP IN GDG-FLD             
           ELSE                                                         
               IF GDG-NUM-IPRO IN GDG-FLD > ZEROES AND                  
                  GDG-IND-CBAN IN GDG-FLD = 'N'                         
                  PERFORM CLI-NEX.                                      
      *>>>>                                                             
*% END
*% IF GDG-NUM-IPRO
      *<<<<
           IF GDG-NUM-IPRO IN GDG-FLD = ZEROES AND                      
             (GDG-IND-CBAN IN GDG-FLD = 'S' OR                          
              GDG-IND-CBAN IN GDG-FLD = 'N')                            
              PERFORM ERR-GLS.                                          
      *>>>>
*% END
*% IF INI_GDG_FEC_FSOL
      *<<<<
           GO TO CNT-FEC-FSOL.
      *>>>>
*% END
*% IF FIN_GDG_FEC_FSOL
      *<<<<
       CNT-FEC-FSOL.
      *VAL-FEC Validar Fecha                                            
           MOVE GDG-NUM-DSOL IN GDG-FLD TO FEC-ITM1.                    
           MOVE GDG-NUM-MSOL IN GDG-FLD TO FEC-ITM2.                    
           MOVE GDG-NUM-SSOL IN GDG-FLD TO FEC-ITM3.                    
           MOVE GDG-NUM-ASOL IN GDG-FLD TO FEC-ITM4.                    
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-S  TO FEC-FBLK.                                
           MOVE FEC-CHOY-LE TO FEC-CHOY.                                
           MOVE FEC-VHBL-S TO FEC-VHBL.                                 
      *<<<< INI_GDG_FEC_SOL_CNS                                         
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
              MOVE FEC-CHOY-N TO FEC-CHOY.                              
      *AFRI-FIN/JUL2005                                                 
           MOVE FEC-FBLK-N  TO FEC-FBLK.                                
      *>>>>                                                             
           MOVE FEC-VAL-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
      *AFRI-INI/JUL2005                                                 
           IF FEC-STAT-FER                                              
              MOVE FEC-FORM-FEC TO FEC-FORM                             
              MOVE FEC-FBLK-N  TO FEC-FBLK                              
              MOVE FEC-CHOY-N  TO FEC-CHOY                              
              MOVE FEC-SIG-HBL TO FEC-CMND                              
              PERFORM CAL-FEC                                           
              MOVE '00'  TO FEC-STAT.                                   
      *AFRI-FIN/JUL2005                                                 
           IF FEC-STAT-OKS                                              
               MOVE FEC-FECH TO GDG-FEC-FSOL IN GDG-FLD                 
           ELSE                                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE FEC-MENS     TO FRM-MENS                            
               GO TO FIN-VAL-GDG-FEC-FSOL.                              
      *>>>>
*% END
*% IF INI_GDG_IND_CBAN
      *<<<<
      *<<<<< INI_GDG_IND_CBAN                                           
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.     
           IF SCR-OFRM-SRV AND                                          
              SCR-CMND = 'ING' AND                                      
              GDG-IND-CBAN IN GDG-FLD NOT > SPACES                      
                MOVE SPACES TO GDG-IND-CBAN IN GDG-FLD                  
                GO TO FIN-VAL-GDG-IND-CBAN.                             
      *RRM-FIN 3-JUL-2002                                               
                                                                        
           IF ( GDG-IND-CBAN IN GDG-FLD NOT > SPACES )                  
               MOVE SPACES TO GDG-IND-CBAN IN GDG-FLD.                  
                                                                        
           IF  GDG-IND-CBAN IN GDG-FLD NOT = 'N' AND NOT = 'S'          
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'ICBAN   N/S' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
      *                                                                 
      *>>>>
*% END
*% IF FIN_GDG_IND_CBAN
      *<<<<
      *                                                                 
      * EVA-AFRI/ABR2007                                                
      *    IF  GDG-IND-CBAN IN GDG-FLD = 'N'                            
      *<<<< FMT_CHI                                                     
      *          MOVE ZEROES TO FRM-NUM-ICLI IN GDG-FLD                 
      *         MOVE SPACES TO FRM-IND-ICLI IN GDG-FLD                  
      *         MOVE SPACES TO FRM-GLS-ICLI IN GDG-FLD                  
      * AFRI-INI (14-07-04)                                             
      *         MOVE SPACES TO FRM-VRF-ICLI IN GDG-FLD                  
      * AFRI-FIN (14-07-04)                                             
      *         MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD.       
      *FIN-AFRI/ABR2007                                                 
      *>>>>                                                             
      *EVA-AFRI/ABR2007                                                 
      *     IF  GDG-IND-CBAN IN GDG-FLD = 'S'                           
      *         MOVE SPACES TO  FRM-GLS-NOMC IN GDG-FLD                 
      *         MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-STP.                  
      *>>>>                                                             
      *     IF GDG-IND-CBAN IN GDG-FLD NOT > SPACES                     
      *          PERFORM ERR-GLS                                        
      *          GO TO FIN-VAL-GDG-IND-CBAN.                            
                                                                        
           IF  GDG-IND-CBAN IN GDG-FLD = 'S'                            
               MOVE SPACES TO  GDG-GLS-NOMP IN GDG-FLD                  
               MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-STP                    
           ELSE                                                         
               MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-STP.                   
      *>>>>                                                             
      *     IF GDG-IND-CBAN IN GDG-FLD NOT > SPACES                     
      *          PERFORM ERR-GLS                                        
      *          GO TO FIN-VAL-GDG-IND-CBAN.                            
      *FIN-AFRI/ABR2007                                                 
      *>>>>
*% END
