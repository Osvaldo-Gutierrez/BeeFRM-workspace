*%! NO_TIENE_TIMESTAMP = TRUE
*%! NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% VSNPQ = "06.06.29"
*% FNCPQ = "OWFBGL"
*% VSNPU = "06.06.29"
*% FNCPU = "OWFBGL"
*% FRM = 'GSE'
*% REG = 'GSE'
*% HIJ = 'GDG'
*% IF NOT PGM_CLB AND NOT PGM_MEX AND PGM_PQ
*%     ! Codigo adicional para Funcion BGLPPVCG = PF5
*%      INCLUDE 'BGLSRC:PFALL5.SRC'
*%     ! Codigo adicional para archivo
*% END
*% IF CMT_ID
*% IF PGM_PQ
      *<<<<CMT_ID
      * Requerimiento                                            *
      * Integracion Politicas de Renovacion Seguros y Tasaciones *
      * AFRI - EVA  08/07                                        *
      *-----------------------------------------------------------------
      *PROYECTO: POLIZAS CON REPARO SEGUROS
      *OBJETIVO: Cargar glosa de Estado
      *FECHA   : 28-FEB-2012
      *AUTOR   : BEE-TEAM (PVC)
      *ETIQUETA: PVC-INI 28-FEB-2012 Carga glosa de Estado
*% END
      *-----------------------------------------------------------------   
      *PROYECTO: VALIDACION PANTALLA GSE
      *OBJETIVO: VALIDAR MONTO SEGURO V/S GVT Y SOLO FVEN PARA MOD
      *FECHA   : JUN-2016
      *AUTOR   : AFRI
      *ETIQUETA: AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
      *-----------------------------------------------------------------
*% IF PGM_PU
      *  AUTOR      : BEE-MPS
      *  FECHA      : SEP-2016
      *  ETIQUETA   : *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *  PROYECTO   : ARCHIVO CON REVALORIZACIONES DE GARANTIAS
      *  OBJETIVO   : GRABAR LOG DE NEGOCIO EN ENTIDAD GNS-LGN
      *-----------------------------------------------------------------
      *  AUTOR      : BEE-MPS
      *  FECHA      : JUN-2017
      *  ETIQUETA   : *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *  PROYECTO   : ARCHIVO CON REVALORIZACIONES DE GARANTIAS FASE 2
      *  OBJETIVO   : GRABAR LOG DE COMANDO ING EN ENTIDAD GNS-LGN
      *-----------------------------------------------------------------
      *  Autor     : BEE-MPB
      *  Fecha     : ENE-2018
      *  NUB       : 53820                                             
      *  Proyecto  : LIMPIEZA CAMPO COD-OTRN
      *  ID        : *MPB-INI 31-ENE-2018 LIMPIEZA CAMPO COD-OTRN
      *  Objetivo  : COMPLETAR CAMPO COD-OTRN CON CANAL
      *              PARA EVITAR INCONSISTENCIAS
      *----------------------------------------------------------------
      *-----------------------------------------------------------------
      *  Autor     : BEE-MPB
      *  Fecha     : 16-10-2018
      *  NUB       : 54009
      *  Proyecto  : CORRECCION PANTALLA GSE
      *  ID        : MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE
      *  Cambios   : CORREGIR CONVERSION DE MONEDA DE VALOR SEGURO
      *              DEJAR CONVERSION Y VALIDACION EN BASE A TABLA PVT
      *---------------------------------------------------------------- 
      *>>>>
*% END
*% END
*% IF EOF AND PGM_DTC
      *<<<< EOF AND PGM_DTC
       COPY GNSBPFEC.
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 CMA-VARI.
               05 GAR-CAI-GTIA                     PIC X(04).
               05 GAR-IIC-GTIA                     PIC X(08).
               05 PGM-STAT-GVT                     PIC X(02).
                  88 PGM-STAT-GVT-OKS VALUE '00'.
               05 GAR-SGV-VPND          COMP       PIC S9(11)V9(4).
               05 GAR-SGV-LTSN          COMP       PIC S9(11)V9(4).
      *MHM-INI 29-OCT-2003
               05 CMA-CIC-UING                     PIC X(12).
*% IF PGM_PQ
               05 CMA-IND-APLI                     PIC X(01).
*% END
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF WSS

*% IF PGM_PU
      *<<<AFRI-INI/ENE2007 (MAE)
       COPY BGLWGGSE.
       COPY BGLBRGVE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVE-REQA==.
      *>>>AFRI-FIN/ENE2007 (MAE)
      *>>>AFRI-INI/SEP2007 (MAE)
       COPY BGLBRSIN.
       COPY SGCBRDCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>AFRI-FIN/SEP2007 (MAE)
*% END
      *<<<AFRI-INI MAYO-2006                                            
       COPY TABBRCAM.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.        
      *>>>AFRI-FIN MAYO-2006
      *<<<< WSS
      *MHM-INI 7-OCT-2003
       COPY LDCBRCLF.
       COPY LDCBRLDC.
       COPY LDCBRARG.
       COPY LDCBRRDC REPLACING RDC BY RDL.
       COPY COLBROPC.
       COPY COLBRRDC.
       COPY BGLBRPOL. 
       COPY BGLBRGDD.
      *PVG INI 15-OCT-2003
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POL-REQA==.
      *PVG FIN 15-OCT-2003
      *MHM-FIN 7-OCT-2003
       COPY BGLBRGDG.
       COPY BGLBRGSO.
       COPY BGLBRGES.
       COPY BGLBRGVT.
       COPY BGLBRTAG.
       COPY BGLWGVCG.
       
*% IF PGM_PU       
      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE
      *Rutina CAM
       COPY GNSWINVC.         
      *MPB-FIN
*% END       
*% IF PGM_CLB OR PGM_MEX
       COPY BGLBRGAP.
       COPY BGLBRGDO.
       COPY BGLBRGDP.
       COPY BGLBRGIN.
       COPY BGLBRGLE.
       COPY BGLBRGMO.
       COPY BGLBRGSI.
       COPY BGLBRGTP.
       COPY BGLBRGUB.
       COPY BGLBRGVE.
       COPY BGLBRGIM.
       COPY BGLWGVDO.
       COPY BGLWVVCG.
       COPY TABBRIVB.
*% END
*% IF PGM_VAX
      *<<<< PGM_VAX
           03 WSS-REG                          PIC X(03).
      *>>>>
*% END
       01  WSS-VARI.
      *AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
           03 WSE-GLS-INSI         VALUE 'S'    PIC X(01).
           03 WSE-GLS-NU09         VALUE '09'   PIC X(02).
           03 WSE-GLS-NU20         VALUE '20'   PIC X(02).
           03 WSE-GLS-NU00         VALUE 0      PIC 9(01).
           03 WSE-GLS-NU-1         VALUE -1     PIC S9(01).
           03 WSE-GLS-CMOD         VALUE 'MOD'  PIC X(03).
      *<<<AFRI-INI MAYO-2006                                            
           03 WSS-VAR-VCAM                      PIC S9(11)V9(4).        
           03 WSS-VAR-SEGU                      PIC S9(11)V9(4).        
           03 WSS-VAR-VCTS                      PIC S9(11)V9(4).        
           03 WSS-VAR-VSIN                      PIC S9(11)V9(4).
           03 WSS-NUM-VCAM                      PIC S9(11)V9(4).        
           03 WSS-NUM-SEGU                      PIC S9(11)V9(4).        
           03 WSS-NUM-VCTS                      PIC S9(11)V9(4).        
           03 WSS-NUM-VSIN                      PIC S9(11)V9(4).        
           03 WSS-PER-PERI.                                             
              05 WSS-GLS-CANT                   PIC 9(02).              
              05 WSS-GLS-PERI                   PIC X(01).              
              05 WSS-GLS-REST                   PIC X(57).              
           03 WSS-FEC-PERI.                                             
              05 WSS-NUM-SPER                   PIC 9(02).
              05 WSS-NUM-APER                   PIC 9(02).              
              05 WSS-NUM-MPER                   PIC 9(02).              
              05 WSS-NUM-DPER                   PIC 9(02).              
      *>>>AFRI-FIN MAYO-2006
           03 GAR-VCB                         PIC X(06).
              88 MONEDA-SIN-DECIMALES VALUE '0999  '.
           03 WSS-TSG-OPE.                              
              05 WSS-COD-TOPE                  PIC X(03).
              05 WSS-COD-SOPE                  PIC X(03).
      *AFRI-INI JUL/2004                                                
           03 WSS-GLS-CUOT.                                             
              05 WSS-NUM-CUOT                  PIC 9(03).               
              05 WSS-GLS-DISP                  PIC X(57).               
      *AFRI-FIN JUL/2004
*% IF (NOT PGM_PQ) OR (PGM_CLB) OR (PGM_MEX)
      *<<<< NOT PGM_PQ
           03 WSS-COD-PESO.
              05 WSS-IND-TMON                 PIC X(01).
              05 WSS-COD-REST                 PIC X(05).
      *>>>>
*% END
*% IF FMT_CHI
      *<<<< FMT_CHI
           03 WSS-COD-CGTA.
              05 WSS-TIP-CGTA                 PIC X(03).
              05 WSS-STP-CGTA                 PIC X(03).
      *>>>>
*% END
*% IF GEN_BCI
      *<<<< GEN_BCI
      *PVG INI 15-OCT-2003 DATO ADICIONAL 2 DE TAB/AUX
           03 WSS-IND-AREN  VALUE 'N'           PIC X(01).
      *PVG FIN 15-OCT-2003
      *    INDICADOR DE EXCEPCION NORMATIVA DE SEGUROS UNO
           03 WSS-IND-ENS1    VALUE SPACES      PIC X(01).
      *    INDICADOR DE EXCEPCION NORMATIVA DE SEGUROS DOS
           03 WSS-IND-ENS2    VALUE SPACES      PIC X(01).
           03 WSS-VAL-SCRE    VALUE ZEROES      PIC 9(13)V9(04).
           03 WSS-FEC-FVTS.
              05 WSS-NUM-SVTS                   PIC 9(02).
              05 WSS-NUM-AVTS                   PIC 9(02).
              05 WSS-NUM-MVTS                   PIC 9(02).
              05 WSS-NUM-DVTS                   PIC 9(02).
      *MHM-INI 23-OCT-2003
           03 WSS-GLS-CGTA.
              05 WSS-GLS-TOPE                   PIC X(40).
              05 WSS-GLS-SOPE                   PIC X(40).
      *MHM-FIN 23-OCT-2003
      *EVA-AFRI/MAYO2006                                                
           03  WSS-GLS-DATA.                                            
              05 WSS-NUM-PVTA   VALUE ZEROES    PIC 9(03).              
              05 WSS-GLS-EXCD   VALUE SPACES    PIC X(57).
*% IF PGM_PU  
      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE
      *SE LE AGREGAN DECIMALES A PCTJ Y NO SE REDONDEA            

      *     03 WSS-VAL-PCTJ                      PIC 9(15).
           03 WSS-VAL-PCTJ                      PIC S9(11)V9(4).
      *MPB-FIN
      *FIN-AFRI/MAYO2006

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           03 WSS-CTE-ING      VALUE 'ING'      PIC X(03).
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

           03 WSS-CTE-BGL      VALUE 'BGL'      PIC X(03).
           03 WSS-CTE-GSE      VALUE 'GSE'      PIC X(03).
           03 WSS-CTE-ELI      VALUE 'ELI'      PIC X(03).
           03 WSS-CTE-MOD      VALUE 'MOD'      PIC X(03).
           03 WSS-CTE-ANT      VALUE 'ANT'      PIC X(03).
           03 WSS-CTE-DES      VALUE 'DES'      PIC X(03).
           03 WSS-CTE-M        VALUE 'M'        PIC X(01).
           03 WSS-CTE-E        VALUE 'E'        PIC X(01).
           03 WSS-CTE-I        VALUE 'I'        PIC X(01).
           03 WSS-CTE-V10      VALUE '1.0'      PIC X(03).
           03 WSS-CTE-1        VALUE  1         PIC 9(01).
           03 WSS-CTE-2        VALUE  2         PIC 9(01).

           03 WSS-SGV-SEGU      PIC  Z.ZZZ.ZZZ.ZZZ.ZZZ,ZZ.
           03 WSS-VAL-MPRI      PIC  Z.ZZZ.ZZZ.ZZZ.ZZZ,ZZ.
           03 WSS-NUM-DEDU      PIC  Z.ZZZ.

      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE
           03 WSS-S            VALUE 'S'        PIC X(01).
           03 WSS-N            VALUE 'N'        PIC X(01).
           03 WSS-4            VALUE  4         PIC 9(01).
           03 WSS-C            VALUE 'C'        PIC X(01).
      *VARIABLES REG VAX BU GSE
           03 WSS-A            VALUE 'A'        PIC X(01).
           03 WSS-M            VALUE 'M'            PIC X(01).
           03 WSS-99999999     VALUE '99999999'     PIC X(08).
           03 WSS-0800         VALUE '0800'         PIC X(04).
           03 WSS-3            VALUE '3'            PIC X(01).
           03 WSS-MIGRACION    VALUE 'MIGRACION'    PIC X(09).
           03 WSS-T            VALUE 'T'            PIC X(01).

       77  WSS-LGM-ABSTIME                  PIC S9(15) COMP-3.

       COPY GNSBRLGN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LGN-REQA==.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *MPB-FIN  
*% END
*% IF PGM_PQ  
      * EVA-INI  08/07
           03 WSS-IND-RSEG      VALUE SPACES    PIC X(01).
           03 WSS-IND-ASEG      VALUE SPACES    PIC X(01).
      *PVC-INI 28-FEB-2012
           03 WSS-IND-REPA      VALUE SPACES    PIC X(01).
      *PVC-FIN
      *    03 WSS-GLS-APLI.
      *       05 WSS-IND-IND1                   PIC X(01).
      *       05 WSS-IND-APLI                   PIC X(01).
      *       05 WSS-IND-IND3                   PIC X(01).
      *       05 WSS-IND-DATA                   PIC X(57).
      * EVA-FIN  08/07
           03 WSS-VAL-PCTJ                      PIC 9(15).      

           03 WSS-IND-RNOV   VALUE 'N'          PIC X(01).

           03 WSS-GLS-DAT1.
              05 WSS-NUM-DSEG  VALUE ZEROES     PIC 9(03).
              05 WSS-NUM-DRST  VALUE ZEROES     PIC 9(07).

           03 WSS-FEC-FECH.
              05 WSS-NUM-STM3                   PIC 9(02).
              05 WSS-NUM-ATM4                   PIC 9(02).
              05 WSS-NUM-MTM2                   PIC 9(02).
              05 WSS-NUM-DTM1                   PIC 9(02).

      ** EVA-INI  11/08
           03 WSS-IND-GTIA     VALUE SPACES       PIC X(01).
           03 WSS-IND-GTAC     VALUE SPACES       PIC X(01).
           03 WSS-IND-ARNV     VALUE SPACES       PIC X(01).
           03 WSS-IND-ECRS     VALUE SPACES       PIC X(01).
           03 WSS-IND-GDIA     VALUE SPACES       PIC X(01).
      ** EVA-FIN  11/08
      *FIN-AFRI/MAYO2006
      *>>>>
*% END
*% END
       COPY BGLWGEXV.

      *MHM-INI 23-OCT-2003
       COPY GNSWGCPT.
      *MHM-FIN 23-OCT-2003
       COPY GNSWGPES.
*% IF PGM_CHI AND PGM_PQ
      *<<<< PGM_CHI AND PGM_PQ
                                                                        
      *********************************************                     
      *           MODULO   USPC113                *                     
      *********************************************                     
      *       DEFINICION IDENTIFICACION TS        *                     
      *********************************************                     
                                                                        
       01  UIB.                                                         
           02  FILLER                  PIC X(32) VALUE 'USPR002'.       
       01  USP-LARGO-TS                PIC S9(4) COMP VALUE +150.       
       01  USP-IDENTIFICACION.                                          
           05  USP-TERMINAL            PIC X(04).                       
           05  USP-OPID-USU            PIC X(03).                       
           05  FILLER                  PIC X(01)  VALUE ' '.            
       01  USP-LLENA-VECTOR            PIC X(1)   VALUE ' '.            
       01  USP-USA-VECTOR              PIC X(1)   VALUE ' '.            
                                                                        
      *********************************************                     
      *       DEFINICION AREA DE TRASPASO         *                     
      *********************************************                     
                                                                        
       01  AREA-TRASPASO.                                               
           05  USP-PERMISO             PIC X(01).                       
           05  USP-PTA-NUM             PIC 9(03)  VALUE 0.              
           05  USP-PTA-STR             PIC X(12)  VALUE SPACES.         
           05  USP-AREA-COMUN.                                          
               10  USP-TIPO-USUARIO.                                    
                   15  USP-IDENT-TU    PIC X(03).                       
      *                TIPO DE USUARIO                                  
                                                                        
                   15  USP-MODO-OP     PIC X(01).                       
      *                MODO OPERACION (CONSULTA/ACTUALIZACION)          
                                                                        
               10  USP-SISTEMA.                                         
                   15  USP-IDENT-SIS   PIC X(03).                       
      *                IDENTIFICACION DEL SISTEMA QUE SE ESTA PROCE_    
      *                SANDO SEGUN USUARIOS Y PRIVILEGIOS               
                                                                        
                   15  USP-GRUPO       PIC X(03).                       
      *                IDENTIFICACION DEL GRUPO DE SISTEMA QUE SE ESTA  
      *                PROCESANDO SEGUN USUARIOS Y PRIVILEGIOS          
      *                                                                 
                                                                        
               10  USP-INDIC-PROCESO   PIC X(01).                       
      *            INDICADOR DE SISTEMA USUARIO Y PRIVILEGIO  ACTIVO    
                                                                        
               10  USP-COD-OFICINA     PIC X(03).                       
      *            CODIGO DE LA OFICINA DEL USUARIO                     
                                                                        
               10  USP-COD-DEPTO       PIC X(03).                       
      *            CODIGO DEL DEPTO DEL USUARIO                         
                                                                        
               10  USP-COD-USUARIO     PIC X(12).                       
      *            CODIGO USUARIO (TABLA USR)                           
                                                                        
               10  USP-COD-TERMINAL    PIC X(04).                       
      *            CODIGO DE TERMINAL                                   
                                                                        
               10  USP-OPID            PIC X(03).                       
      *            OPID DE USUARIO                                      
                                                                        
               10  USP-FECHA.                                           
      *            FECHA                                                
                   15  USP-ANO         PIC X(02).                       
                   15  USP-MES         PIC X(02).                       
                   15  USP-DIA         PIC X(02).                       
                                                                        
               10  USP-HORA            PIC X(06).                       
      *            HORA                                                 
                                                                        
               10  USP-PASSWORD        PIC X(08).                       
      *            PASSWORD DE USUARIO(SOLO PARA CONECCION VIA RUTINA)  
                                                                        
               10  USP-INDICADORES.                                     
                   15  USP-USU-CMN1    PIC X(01).                       
      *            1   */CON       CONSULTA                             
      *            2   */MAN       CONSULTA Y MANTENCION                
      *            3   */*         TODO                                 
      *                                                                 
                   15  USP-USU-CMN2    PIC X(01).                       
      *            P   *           PERMISO AL MENU                      
      *                                                                 
                   15  USP-USU-CMN3    PIC X(01).                       
      *            P   */OFI       OTRAS OFICINAS                       
      *                                                                 
                   15  USP-USU-CMN4    PIC X(01).                       
                   15  USP-USU-CMN5    PIC X(01).                       
                   15  USP-USU-CMN6    PIC X(01).                       
                   15  USP-USU-CMN7    PIC X(01).                       
                   15  USP-USU-CMN8    PIC X(01).                       
                   15  USP-USU-CMN9    PIC X(01).                       
                   15  USP-USU-CMN10   PIC X(01).                       
                   15  USP-USU-CMN11   PIC X(01).                       
                   15  USP-USU-CMN12   PIC X(01).                       
                   15  USP-USU-CMN13   PIC X(01).                       
                   15  USP-USU-CMN14   PIC X(01).                       
                   15  USP-USU-CMN15   PIC X(01).                       
                   15  USP-USU-CMN16   PIC X(01).                       
               10  USP-INDICADORES-RED REDEFINES USP-INDICADORES.       
                   15  USP-USU-CMN-ARR OCCURS 16 TIMES   PIC X(01).     
      *                                                                 
      *            INDICADORES QUE  INDICAN PRIVILEGIO DE USUARIOS      
      *                                                                 
               10  FILLER              PIC X(78).                       
      *            DISPONIBLE USO FUTURO                                
      *                                                                 
      *********************************************                     
      *     AREAS PARA LECTURA DE TABLA "STR"     *                     
      *********************************************                     
      *                                                                 
      *01  COPYDD USP-R-STR.USP-E-STR01(PROD).                          
       01  USP-E-STR01.
           02  USP-CLV-STR-1.
               03  USP-COD-GST     PICTURE X(3).
               03  USP-COD-STR     PICTURE X(12).
           02  USP-COD-PTA         PICTURE X(3).
      *                                                                 
       01  REQ-AREA.                                                    
               05  COD-CMND            PIC X(005).                      
               05  NOM-TABL            PIC X(003).                      
               05  NOM-CLAV            PIC X(005).                      
               05  RET-CODI            PIC X(002).                      
               05  RET-INTE            PIC X(001).                      
               05  NUM-BASE            PIC S9(004) COMP VALUE +120.     
               05  NOM-REGI            PIC X(007).                      
               05  FILLER              PIC X(025).                      
               05  MAX-CONT            PIC S9(004) COMP.                
               05  NOM-CONT            PIC S9(004) COMP.                
               05  FILLER              PIC X(022).                      
               05  VAL-CLAV.                                            
                   10  FECHA           PIC 9(008).                      
                   10  HORA            PIC 9(006).                      
      *                                                                 
       01  ELEM-LIST.                                                   
               05  NOM-ELEM            PIC X(011).                      
               05  SEC-CODI            PIC X(001).                      
               05  FILLER              PIC X(005) VALUE SPACES.         
      *                                                                 
       01  REQ-AREA-STR.                                                
               05  COD-CMND-STR        PIC X(005).                      
               05  NOM-TABL-STR        PIC X(003).                      
               05  NOM-CLAV-STR        PIC X(005).                      
               05  RET-CODI-STR        PIC X(002).                      
               05  RET-INTE-STR        PIC X(001).                      
               05  NUM-BASE-STR        PIC S9(004) COMP VALUE +120.     
               05  NOM-REGI-STR        PIC X(007).                      
               05  FILLER              PIC X(025).                      
               05  MAX-CONT-STR        PIC S9(004) COMP.                
               05  NOM-CONT-STR        PIC S9(004) COMP.                
               05  FILLER              PIC X(022).                      
               05  VAL-CLAV-STR.                                        
                   10  USP-COD-GST     PIC X(003).                      
                   10  USP-COD-STR     PIC X(012).                      
      *                                                                 
       01  ELEM-LIST-STR.                                               
               05  NOM-ELEM-STR        PIC X(011).                      
               05  SEC-CODI-STR        PIC X(001).                      
               05  FILLER              PIC X(005) VALUE SPACES.         
      *                                                                 
      *********************************************                     
      *           FIN   MODULO   USPC113          *                     
      *********************************************                     
                                                                        
      *>>>>
*% END
*% IF PGM_DTC
      *<<<< PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
      *MHM-INI 7-OCT-2003
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
      *MHM-FIN 7-OCT-2003
      *>>>>
*% END
*% END
*% CMA_USR = TRUE
*% IF CMA AND NOT PGM_VAX
*% IF NOT PGM_MCP
      *MHM-INI 02-DIC-2003
      *     02 FILLER                       PIC X(284).
           02 FILLER                       PIC X(300).
      *MHM-FIN 02-DIC-2003
*% ELSE
           01 FILLER                       PIC X(300).
*% END
*% END
*% IF INI_FIO AND NOT PGM_VAX
      *<<<< INI_FIO
*% IF PGM_PU
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           IF SCR-SISG NOT > SPACES
              MOVE SCR-SIST TO SCR-SISG.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
*% END
      *MHM-INI 02-DIC-2003
      *     MOVE +284 TO SCR-TCMA.
           MOVE +300 TO SCR-TCMA.
      *MHM-FIN 02-DIC-2003
      *>>>>
*% END
*% IF INI_FIO AND PGM_VAX
      *<<<< INI_FIO
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'BGL'        TO FIO-SIST.
           PERFORM BGL-FIO-GDG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'BGL'        TO FIO-SIST.
           PERFORM BGL-FIO-GES.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GES.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'BGL'        TO FIO-SIST.
           PERFORM BGL-FIO-GVT.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GVT.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'BGL'        TO FIO-SIST.
           PERFORM BGL-FIO-TAG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
      *>>>> INI_FIO
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *MHM-INI 23-MAY-2006                                              
      ** LLAMA A SUBRUTINA VALIDACION CONSISTENCIA GARANTIA             
      *    IF FRM-FFLD = FRM-FFLD-PF5                                   
      *        PERFORM GAR-PRO-VCG                                      
      *        GO TO FIN-FND-KEY.
      *MHM-FIN 23-MAY-2006
      *MAE                                                              
           IF SCR-CMND = WSS-CTE-ING AND                                      
              SCR-HDR-MRCA = WSS-BCS                                      
              MOVE WSS-T TO GSE-IND-SEG IN GSE-FLD.                       
      *MAE                                                              
*% FIN_BUS_HIJ = TRUE
       BUS-GDG.
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDG.

           MOVE FIO-STAT TO PGM-STAT-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
*% IF PGM_CHI
      *<<<< PGM_CHI
      *
           IF SCR-CCPP = 'ACC' AND 
              SCR-STAT = SCR-STAT-CON
              GO TO FIN-VAL-OFI-USP-GSE.
           IF SCR-OFRM-SRV                                              
              GO TO FIN-VAL-OFI-USP-GSE.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-VAL-OFI-USP-GSE.
      *ALD-BCI-INI/07032000
                                                                        
      **********************************                                
      *            MODULO  USPC143     *                                
      **********************************                                
       USP-CHEQUEO-TS.                                                  
           EXEC CICS HANDLE CONDITION                                   
                              QIDERR(USP-IR-MENU-GENERAL)               
           END-EXEC.                                                    
           EXEC CICS ASSIGN OPID(USP-OPID-USU)                          
           END-EXEC.                                                    
           MOVE EIBTRMID   TO USP-TERMINAL.                             
           EXEC CICS READQ TS QUEUE(USP-IDENTIFICACION)                 
                              INTO(USP-AREA-COMUN)                      
                              LENGTH(USP-LARGO-TS)                      
                              ITEM(+1)                                  
           END-EXEC.                                                    
           GO TO USP-INICIO-PROGRAMA.                                   
       USP-IR-MENU-GENERAL.                                             
           EXEC CICS XCTL PROGRAM('USDP930')                            
           END-EXEC.                                                    
       USP-INICIO-PROGRAMA.                                             
      ***************************************                           
      *            FIN  MODULO  USPC143     *                           
      ***************************************                           
      *  
           MOVE 'BGLGTUCG/CEN' TO USP-PTA-STR.
           COPY USPC103.
           IF USP-PERMISO = 'P'
               GO TO FIN-VAL-OFI-USP-GSE.
      *    COPY USPC143.
      *ALD-BCI-FIN/07032000
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG 
               MOVE 'USRNODEOFI' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

       FIN-VAL-OFI-USP-GSE.
      *
      *>>>>
*% END
*% IF PGM_PER AND PGM_GVT
      *<<<< PGM_PER AND PGM_GVT
       COPY BGLBVUOF.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-FND-KEY.
      *>>>>
*% END

       FIN-BUS-GDG.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GSE-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GSE-FLD.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GDG TO GDG-COD-CGTA IN GSE-FLD.
*% END
      *
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB'  TO TAB-COD-SIST.
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
      *
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GSE-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GSE-FLD TO TAG-STP-AGTA IN TAG.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GSE-FLD TO TAG-COD-AGTA IN TAG.
*% END
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GSE-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GSE-FLD.
      * EVA-INI  11/08                                                  
               MOVE TAB-COD-DAT1 IN TAB-GLS-DAT1(2)                     
                                        TO CMA-IND-APLI IN CMA-VARI     
      * EVA-FIN  11/08                                                  
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GSE-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GSE-FLD.
      *MHM-FIN 23-OCT-2003

      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           MOVE FIO-STAT TO PGM-STAT-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'BGL' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'BGL' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB
                     
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TREA IN GSE-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TREA IN GSE-FLD.
      *PVG INI 14-OCT-2003
           IF TAG-COD-TPOL IN TAG > SPACES
              MOVE TAG-COD-TPOL IN TAG TO TAG-COD-TPOL IN GSE-FLD
              MOVE 'BGL'               TO TAB-COD-SIST
              MOVE 'POL'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-TPOL IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TPOL IN GSE-FLD
              ELSE
                 MOVE SPACES              TO FRM-GLS-TPOL IN GSE-FLD.
      *PVG FIN 14-OCT-2003

           MOVE GDG-CAI-GTIA IN GDG TO GAR-CAI-GTIA IN CMA-VARI.
           MOVE GDG-IIC-GTIA IN GDG TO GAR-IIC-GTIA IN CMA-VARI.
           IF SCR-CMND = 'ING'
               PERFORM PUT-GDG-GSE.

      * Valida Este permitido esta Entidad para Tipo-Subtipo
           IF TAG-IND-EGSE IN TAG = 'N'
               MOVE 'TAG    NOPGM' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
               PERFORM BUS-COR-GSE
      * EVA-AFRI                                                        
               PERFORM BUS-GSE-POL                                      
               GO TO CON-FND-KEY.
           IF GSE-NUM-IGSE IN GSE NOT > ZEROES
               PERFORM BUS-COR-GSE.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      * Comando Consulta Error lo trata el GENESIS
           IF SCR-CCPP = 'ACC' AND SCR-STPP = SCR-STAT-CON
               GO TO FIN-FND-KEY.

      * Garantia Alzada
           IF GDG-IND-EST1 IN GDG > '19'
               MOVE 'GDGALZ' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      * Garantia Completa
           IF SCR-CCPP = 'ELI' AND
              GDG-IND-GTAC IN GDG = 'S'
               MOVE 'GAR    CPL' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           GO TO FIN-FND-KEY.

       ERR-FND-KEY.
           MOVE 'BGL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE SCR-STAT-ABT TO SCR-STAT.
           IF SCR-CCPP = 'ING'
               MOVE '00' TO FIO-STAT
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT.

      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE SPACES TO GSE.
           MOVE SPACES TO GSE-GLS-FLAG IN GSE.
           MOVE SPACES TO GSE-MSC-TACC IN GSE.
           MOVE 'I' TO GSE-MSC-STAT IN GSE.
           MOVE SPACES TO GSE-COD-ICCS IN GSE.
           MOVE SPACES TO GSE-COD-CORS IN GSE.
           MOVE SPACES TO GSE-COD-RTSE IN GSE.
           MOVE SPACES TO GSE-COD-COB1 IN GSE.
           MOVE SPACES TO GSE-COD-COB2 IN GSE.
           MOVE SPACES TO GSE-COD-COB3 IN GSE.
           MOVE SPACES TO GSE-COD-COB4 IN GSE.
           MOVE SPACES TO GSE-COD-COB5 IN GSE.
           MOVE SPACES TO GSE-IND-ENDS IN GSE.
           MOVE SPACES TO GSE-IND-PCUO IN GSE.
           MOVE ZEROES TO GSE-FEC-FVTS IN GSE.
           MOVE ZEROES TO GSE-FEC-FVSG IN GSE.
      *>>>>
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LEE-GDD.
           PERFORM LLENAR-ANTES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING'
              OR SCR-CMND = 'COP'
               MOVE 'I' TO GSE-MSC-TACC IN GSE

               MOVE HOY-FHOY TO GSE-FEC-FING IN GSE
*% IF PGM_MVS
               MOVE SCR-USER TO GSE-CIC-UING IN GSE
*% END
           ELSE
*% IF PGM_MVS
*% END
               MOVE 'M'      TO GSE-MSC-TACC IN GSE.
      * EVA/AFRI                                                        
           IF SCR-HDR-MRCA = 'BCS'
              GO TO NXT-CMN-MOD.                                        
           MOVE GSE-CAI-GTIA IN GSE-FLD TO POL-CAI-GTIA IN POL.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO POL-IIC-GTIA IN POL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-POL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO NXT-CMN-MOD                                         
           ELSE                                                         
              IF GSE-COD-PLZA IN GSE-FLD = POL-COD-PLZA IN POL AND          
                 POL-COD-EPRO IN POL = 06                               
                 MOVE FIO-GET-KEY-UPD TO FIO-CMND                       
                 PERFORM BGL-FIO-POL                                    
                 IF NOT FIO-STAT-OKS                                    
                    GO TO FIN-CMN-MOD                                   
                 ELSE                                                   
                    MOVE 07 TO POL-COD-EPRO IN POL                      
                    MOVE FIO-MOD TO FIO-CMND                            
                    PERFORM BGL-FIO-POL                                 
                    IF NOT FIO-STAT-OKS                                 
                       GO TO FIN-CMN-MOD                                
                    ELSE                                                
                       NEXT SENTENCE                                    
                    END-IF                                              
                 END-IF          
              ELSE                                                      
                MOVE 'BGL' TO MSG-COD-SIST                              
                MOVE 'ERRPOL   MOD' TO MSG-COD-MENS                     
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE GSE-CAI-GTIA IN GSE TO GSE-CAI-GTIA IN GSE-FLD     
                MOVE GSE-IIC-GTIA IN GSE TO GSE-IIC-GTIA IN GSE-FLD
                GO TO FIN-CMN-MOD                                       
              END-IF                                                    
           END-IF.                                   
       NXT-CMN-MOD.                                                     
*% IF PGM_MVS
*% END
      *>>>>
*% END
*% IF CMN_ING
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING'
              OR SCR-CMND = 'COP'
               MOVE 'I' TO GSE-MSC-TACC IN GSE

               MOVE HOY-FHOY TO GSE-FEC-FING IN GSE
*% IF PGM_MVS
               MOVE SCR-USER TO GSE-CIC-UING IN GSE
*% END
           ELSE
*% IF PGM_MVS
*% END
               MOVE 'M' TO GSE-MSC-TACC IN GSE.
      * EVA/AFRI                                                        
           IF SCR-HDR-MRCA = 'BCS'                                      
              GO TO NXT-CMN-ING.                                        
           MOVE GSE-CAI-GTIA IN GSE-FLD TO POL-CAI-GTIA IN POL.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO POL-IIC-GTIA IN POL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-POL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO NXT-CMN-ING                                         
           ELSE                                                         
              IF GSE-COD-PLZA IN GSE-FLD = POL-COD-PLZA IN POL AND          
                 POL-COD-EPRO IN POL = 06                               
                 MOVE FIO-GET-KEY-UPD TO FIO-CMND                       
                 PERFORM BGL-FIO-POL                                    
                 IF NOT FIO-STAT-OKS                                    
                    GO TO FIN-CMN-ING                                   
                 ELSE                                                   
                    MOVE 07 TO POL-COD-EPRO IN POL                      
                    MOVE FIO-MOD TO FIO-CMND                            
                    PERFORM BGL-FIO-POL                                 
                    IF NOT FIO-STAT-OKS                                 
                       GO TO FIN-CMN-ING                                
                    ELSE                                                
                       NEXT SENTENCE                                    
                    END-IF                                              
                 END-IF          
              ELSE                                                      
                MOVE 'BGL' TO MSG-COD-SIST                              
                MOVE 'INGNOPERMITI' TO MSG-COD-MENS                     
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE GSE-CAI-GTIA IN GSE TO GSE-CAI-GTIA IN GSE-FLD     
                MOVE GSE-IIC-GTIA IN GSE TO GSE-IIC-GTIA IN GSE-FLD     
                GO TO FIN-CMN-ING                                       
              END-IF                                                    
           END-IF.                                                      
       NXT-CMN-ING.                                                     
*% IF PGM_MVS
*% END
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en la modificacion : informar               
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS 
      *MHM-INI 6-OCT-2003
           MOVE GSE-CAI-GTIA IN GSE TO GDG-CAI-GTIA IN GDG.
           MOVE GSE-IIC-GTIA IN GSE TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE GDG-IND-INOB IN GSE-FLD TO GDG-IND-INOB IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM BGL-FIO-GDG.
      *MHM-FIN 6-OCT-2003
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en el ingreso : informar                    
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING. 

           MOVE GSE-CAI-GTIA IN GSE TO GDG-CAI-GTIA IN GDG.
           MOVE GSE-IIC-GTIA IN GSE TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF FIO-STAT-OKS
      *MHM-INI 6-OCT-2003
               MOVE GDG-IND-INOB IN GSE-FLD TO GDG-IND-INOB IN GDG
      *MHM-FIN 6-OCT-2003
               MOVE 'S' TO GDG-IND-EGSE IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM BGL-FIO-GDG.
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           PERFORM LEE-GDD. 
           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LEE-GDD.
           PERFORM LLENAR-ANTES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           MOVE GSE-CAI-GTIA IN GSE TO GDG-CAI-GTIA IN GDG.
           MOVE GSE-IIC-GTIA IN GSE TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE ' ' TO GDG-IND-EGSE IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM BGL-FIO-GDG.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
      *AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
           IF SCR-CMND = WSE-GLS-CMOD
               MOVE GSE-CAI-GTIA IN GSE-FLD TO GDG-CAI-GTIA IN GDG
               MOVE GSE-IIC-GTIA IN GSE-FLD TO GDG-IIC-GTIA IN GDG
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM BGL-FIO-GDG
               IF FIO-STAT-OKS AND
                  GDG-IND-EST1 IN GDG > WSE-GLS-NU09 AND
                  GDG-IND-EST1 IN GDG < WSE-GLS-NU20
                   MOVE FRM-CPIM-AEY TO GSE-IND-SEG-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-IND-GENE-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-RTSE-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-PLZA-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-NUM-PROP-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-ICCS-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-FEC-FVSG-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-CORS-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-VCMS-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-NUM-DEDU-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-SGV-SEGU-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-VAL-MPRI-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-COB1-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-IND-PCUO-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-COB2-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-NUM-CUOT-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-COB3-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-COB4-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-IND-SEGU-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-COD-COB5-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GSE-GLS-IMPR-ATR IN GSE-FLD
                   MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GSE-FLD
                   MOVE WSE-GLS-NU00 TO GSE-IND-SEG-LEN IN GSE-FLD
                   MOVE WSE-GLS-NU-1 TO GSE-FEC-FVTS-LEN IN GSE-FLD
                   GO TO FIN-HBL-FLD.
      *AFRI-FIN /062016  VALIDACION MONTO SEGURO / CMN-MOD
           IF SCR-CMND NOT = 'ING'
              GO TO FIN-HBL-FLD-GSO.
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GSO-CAI-GTIA IN GSO.
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GSO-IIC-GTIA IN GSO.
           MOVE 'GSO-KEY-IGDG' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM BGL-FIO-GSO.
           IF NOT FIO-STAT-OKS
              GO TO FIN-HBL-FLD-GSO.

           IF GSO-COD-RSEG IN GSO > SPACES
               MOVE GSO-COD-RSEG IN GSO TO GSE-COD-RTSE IN GSE-FLD
               MOVE FRM-CPIM-AEY        TO GSE-COD-RTSE-ATR IN GSE-FLD
               MOVE ZEROES              TO GSE-COD-RTSE-LEN IN GSE-FLD
               MOVE FRM-POS-CURS        TO GSE-COD-PLZA-LEN IN GSE-FLD
               MOVE 'BGL'               TO TAB-COD-SIST
               MOVE 'RPB '              TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-RTSE IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-RTSE IN GSE-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-RTSE IN GSE-FLD.

           IF GSO-IND-PCUO IN GSO > SPACES
               MOVE GSO-IND-PCUO IN GSO TO GSE-IND-PCUO IN GSE-FLD
               MOVE FRM-CPIM-AEY        TO GSE-IND-PCUO-ATR IN GSE-FLD

           IF GSO-NUM-CUOT IN GSO > ZEROES
               MOVE GSO-NUM-CUOT IN GSO TO GSE-NUM-CUOT IN GSE-FLD
               MOVE FRM-CPIM-AEY        TO GSE-NUM-CUOT-ATR IN GSE-FLD.
                                                                        
           IF GSE-COD-PLZA IN GSE-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO GSE-COD-PLZA-ATR IN GSE-FLD          
              MOVE 0  TO GSE-COD-PLZA-LEN IN GSE-FLD          
              MOVE -1 TO GSE-COD-ICCS-LEN IN GSE-FLD.        
      FIN-HBL-FLD-GSO.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-COR-GSE SECTION.
       INI-BUS-COR-GSE.
           MOVE 999 TO GSE-NUM-IGSE IN GSE.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM BGL-FIO-GSE.
           IF NOT ( FIO-STAT-OKS AND
                    GSE-CAI-GTIA IN GSE-FLD = GSE-CAI-GTIA IN GSE AND
                    GSE-IIC-GTIA IN GSE-FLD = GSE-IIC-GTIA IN GSE )
               PERFORM KEY-ALL-GSE
               MOVE ZEROES TO GSE-NUM-IGSE IN GSE.
           IF SCR-CCPP = 'ING'
               ADD 1 TO GSE-NUM-IGSE IN GSE
               MOVE GSE-NUM-IGSE IN GSE TO GSE-NUM-IGSE IN GSE-FLD
           ELSE
               MOVE GSE-NUM-IGSE IN GSE TO GSE-NUM-IGSE IN GSE-FLD.
       FIN-BUS-COR-GSE.
           EXIT.

      *MHM-INI 7-OCT-2003
       EXC-NOR-SEG SECTION.
       INI-EXC-NOR-SEG.
           MOVE 'N' TO WSS-IND-ENS1 IN WSS-VARI.
           MOVE 'N' TO WSS-IND-ENS2 IN WSS-VARI.

           IF GDG-COD-LGTA IN GDG = WSS-CTE-E
               PERFORM GAR-ESP
           ELSE
               PERFORM GAR-GRL.
           
           IF WSS-VAL-SCRE IN WSS-VARI > ZEROES
               MOVE 'S' TO WSS-IND-ENS1 IN WSS-VARI
               GO TO FIN-EXC-NOR-SEG.
           
           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GDD-EXC-SEG.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           PERFORM BGL-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
              GDD-CAI-GTIA IN GDD = GDG-CAI-GTIA IN GDG AND
              GDD-IIC-GTIA IN GDD = GDG-IIC-GTIA IN GDG)
               GO TO FIN-EXC-NOR-SEG.

           MOVE GDD-CAI-DCLI IN GDD TO RDC-CAI-ICLI IN RDL.
           MOVE GDD-IIC-DCLI IN GDD TO RDC-IIC-ICLI IN RDL.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-RDC-EXC-SEG.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-CAI-ICLI IN RDL = GDD-CAI-DCLI IN GDD AND
              RDC-IIC-ICLI IN RDL = GDD-IIC-DCLI IN GDD )
               GO TO NXT-GDD-EXC-SEG.

           MOVE RDC-CAI-ICLF IN RDL TO CLF-CAI-ICLF IN CLF.
           MOVE RDC-IIC-ICLF IN RDL TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               GO TO NXT-RDC-EXC-SEG.
               
           MOVE CLF-CAI-ICLF IN CLF TO LDC-CAI-ICLF IN LDC.
           MOVE CLF-IIC-ICLF IN CLF TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES              TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LDC-EXC-SEG.
           PERFORM LDC-FIO-LDC.
           IF NOT ( FIO-STAT-OKS AND
              LDC-CAI-ICLF IN LDC = CLF-CAI-ICLF IN CLF AND
              LDC-IIC-ICLF IN LDC = CLF-IIC-ICLF IN CLF )
               GO TO NXT-RDC-EXC-SEG.
               
           IF LDC-IND-VIGE IN LDC NOT = WSS-S
               GO TO NXT-LDC-EXC-SEG.
           
           MOVE LDC-CAI-ICLF IN LDC TO ARG-CAI-ICLF IN ARG.
           MOVE LDC-IIC-ICLF IN LDC TO ARG-IIC-ICLF IN ARG.
           MOVE LDC-NUM-ILDC IN LDC TO ARG-NUM-ILDC IN ARG.
           MOVE ZEROES              TO ARG-NUM-IARG IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-ARG-EXC-SEG.
           PERFORM LDC-FIO-ARG.
           IF NOT ( FIO-STAT-OKS AND
              ARG-CAI-ICLF IN ARG = LDC-CAI-ICLF IN LDC AND
              ARG-IIC-ICLF IN ARG = LDC-IIC-ICLF IN LDC AND
              ARG-NUM-ILDC IN ARG = LDC-NUM-ILDC IN LDC )
               GO TO NXT-LDC-EXC-SEG.

           IF GDG-CIC-GTIA IN GDG = ARG-CIC-IGAR IN ARG
               MOVE 'S' TO WSS-IND-ENS2 IN WSS-VARI.
               
           IF GDG-COD-CGTA = ARG-COD-COGA IN ARG
               MOVE 'S' TO WSS-IND-ENS2 IN WSS-VARI.
               
           IF GDG-COD-TOPE = ARG-COD-TOGA IN ARG
               MOVE 'S' TO WSS-IND-ENS2 IN WSS-VARI.

           IF GDG-COD-SOPE = ARG-COD-AOGA IN ARG
               MOVE 'S' TO WSS-IND-ENS2 IN WSS-VARI.
               
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-ARG-EXC-SEG.

       NXT-LDC-EXC-SEG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-LDC-EXC-SEG.

       NXT-RDC-EXC-SEG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-RDC-EXC-SEG.

       NXT-GDD-EXC-SEG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GDD-EXC-SEG.

       FIN-EXC-NOR-SEG.
           EXIT.

       GAR-ESP SECTION.
       INI-GAR-ESP.
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.
           
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.
           MOVE ZEROES TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GAR-ESP.
           PERFORM BGL-FIO-GES.
           IF NOT ( FIO-STAT-OKS AND
              GES-CAI-GTIA IN GES = GDG-CAI-GTIA AND
              GES-IIC-GTIA IN GES = GDG-IIC-GTIA )
               GO TO FIN-GAR-ESP.
           
           MOVE GES-CAI-IOPC IN GES TO OPC-CAI-IOPC IN OPC.
           MOVE GES-IIC-IOPC IN GES TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GAR-ESP.
               
           IF OPC-MSC-STAT IN OPC = WSS-A
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
               
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GAR-ESP.
           
       FIN-GAR-ESP.
           EXIT.
           
       GAR-GRL SECTION.
       INI-GAR-GRL.
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.

           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GDD-GAR-GRL.
           PERFORM BGL-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
              GDD-CAI-GTIA IN GDD = GDG-CAI-GTIA AND
              GDD-IIC-GTIA IN GDD = GDG-IIC-GTIA )
               GO TO FIN-GAR-GRL.

           MOVE GDD-CAI-DCLI IN GDD TO RDC-CAI-ICLI IN RDC.
           MOVE GDD-IIC-DCLI IN GDD TO RDC-IIC-ICLI IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-RDC-GAR-GRL.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-CAI-ICLI IN RDC = GDD-CAI-DCLI IN GDD AND
              RDC-IIC-ICLI IN RDC = GDD-IIC-DCLI IN GDD )
               GO TO NXT-GDD-GRL.
               
           MOVE RDC-CAI-IOPC IN RDC TO OPC-CAI-IOPC IN OPC.
           MOVE RDC-IIC-IOPC IN RDC TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-RDC-GRL.
               
           IF OPC-MSC-STAT IN OPC = WSS-A
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
               
       NXT-RDC-GRL.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-RDC-GAR-GRL.
           
       NXT-GDD-GRL.
      *PVG INI 15-OCT-2003
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
      *PVG FIN 15-OCT-2003
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GDD-GAR-GRL.

       FIN-GAR-GRL.
           EXIT.
      *MHM-FIN 7-OCT-2003

*% IF PGM_CLB OR PGM_MEX
       COPY TABBFIVB.
       COPY BGLBFGAP.
       COPY BGLBFGDO.
       COPY BGLBFGDP.
       COPY BGLBFGIN.
       COPY BGLBFGLE.
       COPY BGLBFGMO.
       COPY BGLBFGSI.
       COPY BGLBFGTP.
       COPY BGLBFGUB.
       COPY BGLBFGVE.
       COPY BGLBFGIM.
       COPY BGLBGVC2.
       COPY BGLBGVDO.
       COPY BGLBVVCG.
*% END
       COPY BGLBFPOL.
       COPY BGLBFGDG.
       COPY BGLBFGSO.
       COPY BGLBFGES.
       COPY BGLBFGVT.
       COPY BGLBFTAG.
      *MHM-INI 7-OCT-2003
       COPY LDCBFRDC REPLACING RDC BY RDL
                  ==ADR-RDC-REQA== BY ==ADR-RDL-REQA==.
       COPY LDCBFCLF.
       COPY LDCBFLDC.
       COPY LDCBFARG.
       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY BGLBFGDD.       
      *MHM-FIN 7-OCT-2003
*% IF PGM_PU
      *<<<AFRI-INI/ENE2007 (MAE)
       COPY BGLBFGVE.
       COPY BGLBGGSE.
      *>>>AFRI-FIN/ENE2007 (MAE)
      *>>>AFRI-INI/SEP2007 (MAE)
       COPY BGLBFSIN.
       COPY SGCBFDCP.
       COPY SGCBFDBC.
      *>>>AFRI-FIN/SEP2007 (MAE)
*% END
      *<<<AFRI-INI MAYO-2006                                            
       COPY TABBFCAM.                                                   
      *>>>AFRI-INI MAYO-2006
       COPY BGLBGVCG.
       COPY BGLBKVCG.
      *MHM-INI 23-OCT-2003
       COPY GNSBGCPT.
      *MHM-FIN 23-OCT-2003

       COPY GNSBGPES.
       
*% IF PGM_PU
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

       COPY GNSBFLGN.

       LEE-GDD SECTION.
      *===================
       INI-LEE-GDD.

           MOVE GSE-CAI-GTIA IN GSE   TO GDD-CAI-GTIA IN GDD.
           MOVE GSE-IIC-GTIA IN GSE   TO GDD-IIC-GTIA IN GDD.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM BGL-FIO-GDD.

       FIN-LEE-GDD.
           EXIT.


       LLENAR-ANTES SECTION.
       INI-LLENAR-ANTES.
      *------------------
           MOVE SPACES TO LGN.

           IF SCR-CMND = WSS-CTE-MOD
              MOVE WSS-CTE-MOD        TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M          TO LGN-COD-TACC IN LGN
                                         LGN-COD-STAT IN LGN.
           IF SCR-CMND = WSS-CTE-ELI
              MOVE WSS-CTE-ELI        TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-E          TO LGN-COD-TACC IN LGN
                                         LGN-COD-STAT IN LGN.

           MOVE WSS-CTE-ANT           TO LGN-COD-INST IN LGN.
           MOVE WSS-CTE-1             TO LGN-NUM-CLGN IN LGN
                                         LGN-NUM-COPE IN LGN
                                         LGN-NUM-CCLI IN LGN
                                         LGN-NUM-CEVE IN LGN
                                         LGN-NUM-CAUT IN LGN.

           MOVE GSE-NUM-IGSE IN GSE      TO LGN-COD-LN01 IN LGN.
           MOVE GSE-FEC-FTRN IN GSE      TO LGN-COD-LN02 IN LGN.
           MOVE GSE-HRA-HRTR IN GSE      TO LGN-COD-LN02 IN LGN(11:6).
           MOVE GSE-MSC-TTRN IN GSE      TO LGN-COD-LN03 IN LGN.
           MOVE GSE-COD-TTRN IN GSE      TO LGN-COD-LN04 IN LGN.
           MOVE GSE-COD-ATRN IN GSE      TO LGN-COD-LN05 IN LGN.
           MOVE GSE-COD-PLZA IN GSE      TO LGN-COD-LN06 IN LGN.
           MOVE GSE-COD-ICCS IN GSE      TO LGN-COD-LN07 IN LGN.
           MOVE GSE-COD-CORS IN GSE      TO LGN-COD-LN08 IN LGN.

           MOVE GSE-SGV-SEGU IN GSE      TO WSS-SGV-SEGU IN WSS-VARI.
           MOVE WSS-SGV-SEGU IN WSS-VARI TO LGN-COD-LN09 IN LGN.

           MOVE GSE-COD-VCMS IN GSE      TO LGN-COD-LN10 IN LGN.
           MOVE GSE-COD-COB1 IN GSE      TO LGN-COD-LN11 IN LGN.
           MOVE GSE-COD-COB2 IN GSE      TO LGN-COD-LN12 IN LGN.
           MOVE GSE-COD-COB3 IN GSE      TO LGN-COD-LN13 IN LGN.
           MOVE GSE-COD-COB4 IN GSE      TO LGN-COD-LN14 IN LGN.
           MOVE GSE-COD-COB5 IN GSE      TO LGN-COD-LN15 IN LGN.
           MOVE GSE-COD-RTSE IN GSE      TO LGN-COD-LN16 IN LGN.
           MOVE GSE-IND-ENDS IN GSE      TO LGN-COD-LN17 IN LGN.
           MOVE GSE-FEC-FVSG IN GSE      TO LGN-COD-LN18 IN LGN.
           MOVE GSE-FEC-FVTS IN GSE      TO LGN-COD-LN19 IN LGN.
           MOVE GSE-IND-PCUO IN GSE      TO LGN-COD-LN20 IN LGN.
           MOVE GSE-FEC-FING IN GSE      TO LGN-COD-LN21 IN LGN.
           MOVE GSE-CIC-UING IN GSE      TO LGN-COD-LN22 IN LGN.
           MOVE GSE-COD-ESTA IN GSE      TO LGN-COD-LN23 IN LGN.

           MOVE GSE-VAL-MPRI IN GSE      TO WSS-VAL-MPRI IN WSS-VARI.
           MOVE WSS-VAL-MPRI IN WSS-VARI TO LGN-COD-LN24 IN LGN.

           MOVE GSE-NUM-CUOT IN GSE      TO LGN-COD-LN25 IN LGN.
           MOVE GSE-IND-SEGU IN GSE      TO LGN-COD-LN26 IN LGN.

           MOVE GSE-NUM-DEDU IN GSE      TO WSS-NUM-DEDU IN WSS-VARI.
           MOVE WSS-NUM-DEDU IN WSS-VARI TO LGN-COD-LN27 IN LGN.

           MOVE GSE-IND-SEG  IN GSE      TO LGN-COD-LN28 IN LGN.
           MOVE GSE-NUM-PROP IN GSE      TO LGN-COD-LN29 IN LGN.

       FIN-LLENAR-ANTES.
           EXIT.

       LLENAR-DESPUES SECTION.
       INI-LLENAR-DESPUES.
      *------------------
           MOVE SPACES               TO  LGN.

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-MOD
      *    MOVE WSS-CTE-MOD          TO  LGN-COD-EVEN IN LGN.
           MOVE WSS-CTE-MOD          TO  LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           MOVE WSS-CTE-M            TO  LGN-COD-TACC IN LGN
                                         LGN-COD-STAT IN LGN.
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-ING
              MOVE WSS-CTE-ING        TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-I          TO LGN-COD-TACC IN LGN
                                         LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           MOVE WSS-CTE-DES          TO  LGN-COD-INST IN LGN.
           MOVE WSS-CTE-2            TO  LGN-NUM-CLGN IN LGN
                                         LGN-NUM-COPE IN LGN
                                         LGN-NUM-CCLI IN LGN
                                         LGN-NUM-CEVE IN LGN
                                         LGN-NUM-CAUT IN LGN.

           MOVE GSE-NUM-IGSE IN GSE      TO LGN-COD-LN01 IN LGN.
           MOVE GSE-FEC-FTRN IN GSE      TO LGN-COD-LN02 IN LGN.
           MOVE GSE-HRA-HRTR IN GSE      TO LGN-COD-LN02 IN LGN(11:6).
           MOVE GSE-MSC-TTRN IN GSE      TO LGN-COD-LN03 IN LGN.
           MOVE GSE-COD-TTRN IN GSE      TO LGN-COD-LN04 IN LGN.
           MOVE GSE-COD-ATRN IN GSE      TO LGN-COD-LN05 IN LGN.
           MOVE GSE-COD-PLZA IN GSE      TO LGN-COD-LN06 IN LGN.
           MOVE GSE-COD-ICCS IN GSE      TO LGN-COD-LN07 IN LGN.
           MOVE GSE-COD-CORS IN GSE      TO LGN-COD-LN08 IN LGN.

           MOVE GSE-SGV-SEGU IN GSE      TO WSS-SGV-SEGU IN WSS-VARI.
           MOVE WSS-SGV-SEGU IN WSS-VARI TO LGN-COD-LN09 IN LGN.

           MOVE GSE-COD-VCMS IN GSE      TO LGN-COD-LN10 IN LGN.
           MOVE GSE-COD-COB1 IN GSE      TO LGN-COD-LN11 IN LGN.
           MOVE GSE-COD-COB2 IN GSE      TO LGN-COD-LN12 IN LGN.
           MOVE GSE-COD-COB3 IN GSE      TO LGN-COD-LN13 IN LGN.
           MOVE GSE-COD-COB4 IN GSE      TO LGN-COD-LN14 IN LGN.
           MOVE GSE-COD-COB5 IN GSE      TO LGN-COD-LN15 IN LGN.
           MOVE GSE-COD-RTSE IN GSE      TO LGN-COD-LN16 IN LGN.
           MOVE GSE-IND-ENDS IN GSE      TO LGN-COD-LN17 IN LGN.
           MOVE GSE-FEC-FVSG IN GSE      TO LGN-COD-LN18 IN LGN.
           MOVE GSE-FEC-FVTS IN GSE      TO LGN-COD-LN19 IN LGN.
           MOVE GSE-IND-PCUO IN GSE      TO LGN-COD-LN20 IN LGN.
           MOVE GSE-FEC-FING IN GSE      TO LGN-COD-LN21 IN LGN.
           MOVE GSE-CIC-UING IN GSE      TO LGN-COD-LN22 IN LGN.
           MOVE GSE-COD-ESTA IN GSE      TO LGN-COD-LN23 IN LGN.

           MOVE GSE-VAL-MPRI IN GSE      TO WSS-VAL-MPRI IN WSS-VARI.
           MOVE WSS-VAL-MPRI IN WSS-VARI TO LGN-COD-LN24 IN LGN.

           MOVE GSE-NUM-CUOT IN GSE      TO LGN-COD-LN25 IN LGN.
           MOVE GSE-IND-SEGU IN GSE      TO LGN-COD-LN26 IN LGN.

           MOVE GSE-NUM-DEDU IN GSE      TO WSS-NUM-DEDU IN WSS-VARI.
           MOVE WSS-NUM-DEDU IN WSS-VARI TO LGN-COD-LN27 IN LGN.

           MOVE GSE-IND-SEG  IN GSE      TO LGN-COD-LN28 IN LGN.
           MOVE GSE-NUM-PROP IN GSE      TO LGN-COD-LN29 IN LGN.


       FIN-LLENAR-DESPUES.
           EXIT.


       GRABAR-LGN SECTION.
      *===================
       INI-GRABAR-LGN.

           MOVE SCR-SISG TO FIO-SIST.

           EXEC CICS ASKTIME ABSTIME(WSS-LGM-ABSTIME)
           END-EXEC.

           PERFORM GET-FHOY.

           MOVE WSS-CTE-V10         TO LGN-COD-VERS IN LGN.
           MOVE WSS-CTE-GSE         TO LGN-COD-ENTF IN LGN
                                       LGN-COD-ENTO IN LGN
                                       LGN-COD-ENTE IN LGN
                                       LGN-COD-ENTC IN LGN
                                       LGN-COD-ENTA IN LGN.
           MOVE HOY-FHOY            TO LGN-FEC-FTRN IN LGN
                                       LGN-FEC-FLGN IN LGN
                                       LGN-FEC-FOPE IN LGN
                                       LGN-FEC-FEVE IN LGN
                                       LGN-FEC-FCLI IN LGN
                                       LGN-FEC-FAUT IN LGN.
           MOVE HOY-HHOY            TO LGN-HRA-HRTR IN LGN
                                       LGN-HRA-HLGN IN LGN
                                       LGN-HRA-HOPE IN LGN
                                       LGN-HRA-HEVE IN LGN
                                       LGN-HRA-HCLI IN LGN
                                       LGN-HRA-HAUT IN LGN.
           MOVE TSK-TERM-NUM        TO LGN-TSK-NUMF IN LGN
                                       LGN-TSK-NUMO IN LGN
                                       LGN-TSK-NUME IN LGN
                                       LGN-TSK-NUMC IN LGN
                                       LGN-TSK-NUMA IN LGN.
           MOVE WSS-LGM-ABSTIME     TO LGN-NUM-ABSF IN LGN
                                       LGN-NUM-ABSO IN LGN
                                       LGN-NUM-ABSE IN LGN
                                       LGN-NUM-ABSC IN LGN
                                       LGN-NUM-ABSA IN LGN.
           MOVE GSE-CIC-GTIA IN GSE TO LGN-CIC-IOPE IN LGN.
           MOVE GDD-CIC-DCLI IN GDD TO LGN-CIC-ICLI IN LGN.
      *MPB-INI 31-ENE-2018 LIMPIEZA CAMPO COD-OTRN
      *     MOVE EIBTRMID            TO LGN-COD-OTRN IN LGN.
           IF SCR-OFRM-SRV
               MOVE SCR-ORIG TO LGN-COD-OTRN IN LGN
           ELSE
               IF NOT SCR-OFRM-SRV
                   MOVE SPACES TO LGN-COD-OTRN IN LGN.
      *MPB-FIN
           MOVE SCR-USER            TO LGN-COD-ATRN IN LGN
                                       LGN-COD-AUTO IN LGN.
           MOVE EIBTRNID            TO LGN-COD-TCIC IN LGN.

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-ING
              MOVE WSS-CTE-ING  TO LGN-COD-CMND IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-MOD
              MOVE WSS-CTE-MOD  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = WSS-CTE-ELI
              MOVE WSS-CTE-ELI  TO LGN-COD-CMND IN LGN.
            MOVE FIO-PUT TO FIO-CMND.

           PERFORM GNS-FIO-LGN.

       FIN-GRABAR-LGN.
           EXIT.
*% END
*% IF PGM_PU
      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE
      *Rutina CAM
       COPY GNSBINVC.               
      *MPB-FIN
*% END
*% IF (PGM_CLB OR PGM_MVS OR PGM_MEX) AND PGM_PQ

      *COPY GNSBPFEC.
                                                                        
      *EVA-AFRI/AGO2007                                                 
       BUS-GSE-POL SECTION.                                             
       INI-BUS-GSE-POL.                                                 
           MOVE GSE-CAI-GTIA IN GSE-FLD TO POL-CAI-GTIA IN POL.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO POL-IIC-GTIA IN POL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-POL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-BUS-GSE-POL                                     
           ELSE                                                         
              IF NOT (POL-COD-ESGE IN POL = '53' AND                    
                 POL-COD-EPRO IN POL = 06)                              
                 GO TO FIN-BUS-GSE-POL                                  
              ELSE                                                      
                  MOVE POL-COD-PLZA IN POL TO                           
                  GSE-COD-PLZA IN GSE-FLD.                              
       FIN-BUS-GSE-POL.                                                 
           EXIT.                                                        
      *FIN-AFRI/AGO2007                                                 
*% END
*% END
*% IF SETTAG
      *<<<<
       77  WSS-IDN-BGLPUGSE-SKL            PIC X(0010)                  
            VALUE 'V:SKL V06+'.                                         
       77  WSS-IDN-BGLPUGSE-CDA            PIC X(0040)                  
            VALUE 'V:BGLPUGSE {vsnpgm}'.
      *>>>>
*% END
