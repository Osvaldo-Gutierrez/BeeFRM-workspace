*%! NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% PGM_GDG = TRUE
*% PGM_PTC = TRUE
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% VSNPQ = "06.06.22"
*% FNCPQ = "OWFBGL"
*% VSNPU = "06.06.22"
*% FNCPU = "OWFBGL"
*% IF NOT PGM_BFA
*% LDC_SI = TRUE
*% ELSE
*% LDC_SI = FALSE
*% END
*% IF LDC_SI AND PGM_MVS 
*% LARGO_TOTAL_COMMAREA = 1200
*% ELSE
*% LARGO_TOTAL_COMMAREA = 430
*% END
*%! LARGO_TOTAL_COMMAREA = 783
*% IF CMT_ID_PQ
      *<<<<
      **************************************************************    
      * MANTENCIONES:                                                   
      * AFRI-INI/SEP2009: NO VALIDA EXISTENCIA DE GSO PARA COMANDO      
      *                   MST.                                          
      **************************************************************    
      *>>>>
*% END
*% IF CMT_ID_PU
      *>>>>
      *=============================================================*   
      * Mantencion   25/06/2009                                         
      * EVA-AFRI                                                        
      * Se elimina tabla de excepcion BGLGLEGAP por falta de espacio.   
      * Se crea nueva tabla EDL que contiene los Tipo de Productos      
      * que administran la norma de excepcion de ingreso de GLE,        
      * funcion que cumplia la tabla eliminada.                         
      *-------------------------------------------------------------    
      **AFRI-INI/SEP2009: GUARDA ULTIMO USUARIO QUE MODIFICO SUBTIPO    
      *                   DE LA GDG CON COMANDO MST.                    
      *=============================================================*   
      * ETIQUETA   : *OGB-INI 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
      * OBJETIVO   : AGREGAR VALIDACION DE MODIFICACION DE VARIABLE 
      *              OPD-COD-GARA (INDICADOR DE GARANTIA EN DAP)
      * FECHA      : MARZO-2015
      * RESPONSABLE: CIMA-OGB
      * MANTENCION : ACTIVACION DE GARANTIA NO BLOQUEA DAP
      *=============================================================*
      * ETIQUETA   : *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
      * OBJETIVO   : AGREGAR CAMPOS MONTO LIMITE, MONEDA MONTO LIMITE
      *              Y FECHA DE CAMBIO
      * FECHA      : OCTUBRE-2015
      * RESPONSABLE: CIMA-OGB
      * MANTENCION : LIMITE DE GARANTIAS
      *=============================================================*
      *  AUTOR      : BEE-MPS
      *  FECHA      : SEP-2016
      *  ETIQUETA   : *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *  PROYECTO   : ARCHIVO CON REVALORIZACIONES DE GARANTIAS
      *  OBJETIVO   : GRABAR LOG DE NEGOCIO EN ENTIDAD GNS-LGN
      *---------------------------------------------------------------
      *OBJETIVO: DESACOPLAR RUTINA DE MARGENES
      *PROYECTO: LIMITE DE CREDITO SEGUN ARTICULO 84
      *FECHA   : MAYO 2015
      *AUTOR   : AFRI-CGC
      *ETIQUETA:
      *      AFRI-INI 05-MAY-2015 LIMITE DE CREDITO SEGUN ARTICULO 84
      *---------------------------------------------------------------
      *  AUTOR      : BEE-MPS-AFRI
      *  FECHA      : JUN-2017
      *  ETIQUETA   : *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *  PROYECTO   : ARCHIVO CON REVALORIZACIONES DE GARANTIAS FASE 2
      *  OBJETIVO   : GRABAR LOG DE COMANDO ING EN ENTIDAD GNS-LGN
      *-----------------------------------------------------------------
      *  Autor     : BEE-MPB
      *  Fecha     : 03-11-2017
      *  NUB       : 53722
      *  Proyecto  : DPM Correccion Liquidacion DPI a Cuenta Corriente
      *  ID        : MPB-INI  03-NOV-2017 Correccion Liquidacion DPI
      *  Cambios   : Reversar EPD para DAP de Gtia al activar
      *----------------------------------------------------------------
      *  Autor     : BEE-MPB
      *  Fecha     : ENE-2018
      *  NUB       : 53820
      *  Proyecto  : LIMPIEZA CAMPO COD-OTRN
      *  ID        : *MPB-INI 31-ENE-2018 LIMPIEZA CAMPO COD-OTRN
      *  Objetivo  : COMPLETAR CAMPO COD-OTRN CON CANAL
      *              PARA EVITAR INCONSISTENCIAS
      *----------------------------------------------------------------
      *>>>>
*% END
*% IF CMT_ID_PQ
      *>>>>
      *-------------------------------------------------------------
      * PROYECTO: ADMINISTRACION DE PRENDAS WARRANTS
      * OBJETIVO: ALERTA GARANTIA VENCIDA
      * FECHA   : 19-OCT-2012
      * AUTOR   : BEE-TEAM (PVC)
      * ETIQUETA: PVC-INI 19-OCT-2012 - ADMINISTRACION PRENDAS WARRANTS
      *-------------------------------------------------------------
      *-------------------------------------------------------------
      *  AUTOR      : BEE-MPS-AFRI
      *  FECHA      : JUN-2017
      *  ETIQUETA   : *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *  PROYECTO   : ARCHIVO CON REVALORIZACIONES DE GARANTIAS FASE 2
      *  OBJETIVO   : GRABAR LOG DE COMANDO ING EN ENTIDAD GNS-LGN
      *-----------------------------------------------------------------      
*% END
*% IF FIN_PGM_STAT
      *<<<< FIN_PGM_STAT                                                         
      *>>>>
*% END
*% IF FIN_SCR_VARI                                          
      *<<<<  LDC_SI AND PGM_MVS AND FIN_SCR_VARI                        
       COPY LDCWGENG.                                                   
           03 SCR-CLF     VALUE SPACES            PIC X(64).            
           03 SCR-LDC     VALUE SPACES            PIC X(100).           
           03 SCR-ARG     VALUE SPACES            PIC X(50).            
      *>>>>                                                             
                                                                        
      *<<<< CMAVARI OF PGMMAN                                           
           03 CMA-VARI.                                                 
              05 WSS-IND-CMUL                       PIC X(01).          
              05 GAR-CIC-OFIC     VALUE '0000'      PIC X(04).          
              05 SCR-IND-MGDD     VALUE SPACES      PIC X(01).          
                 88 MULTIPLES-GDD      VALUE 'M'.                       
                                                                        
              05 DBC-KEY-IDBC.                                          
                 07 DBC-CAI-ICLI  VALUE SPACES      PIC X(04).          
                 07 DBC-IIC-ICLI  VALUE ZEROES      PIC 9(08).          
                                                                        
              05 CMA-IND-KPAD     VALUE SPACES      PIC X(01).          
              05 GAR-KEY-IGDD.                                          
                 07 GAR-CIC-DCLI  VALUE SPACES      PIC X(12).          
                 07 GAR-KEY-AGDD  VALUE SPACES      PIC X(12).          
      *>>>>                                                             
      *<<<< FIN_SCR_VARI                                                
              05 GAR-CAI-GTIA                        PIC X(04).         
              05 GAR-IIC-GTIA                        PIC X(08).         
              05 GAR-IND-GTAC                        PIC X(01).         
              05 GAR-IND-EGAP                        PIC X(01).         
              05 GAR-IND-SVTO                        PIC X(01).         
              05 GAR-SGV-PPCT                        PIC S9(03)V9(02).  
              05 GAR-SGV-PAJU                        PIC S9(03)V9(02).  
              05 WSS-EST-ANT                         PIC X(02).         
              05 WSS-ES1-1                           PIC X(02).         
              05 WSS-ES1-2                           PIC X(02).         
              05 WSS-ES1-3                           PIC X(02).         
              05 WSS-ES1-4                           PIC X(02).         
      *                                                                 
              05 CMA-IND-DAP                         PIC X(01).         
              05 FRM-CAI-IOPD                        PIC X(04).         
              05 FRM-IIC-IOPD                        PIC X(08).         
              05 SCR-IND-V001      VALUE SPACES      PIC X(01).         
              05 CMA-CIC-TGAR                        PIC X(06).         
              05 CMA-FEC-FAPE                        PIC X(08).         
              05 CMA-FEC-FTSN                        PIC X(08).         
              05 CMA-TIP-DOC                        PIC X(03).          
              05 CMA-DOC-SALD           VALUE 0     PIC 9(13)V99.       
      *                                                                 
              05 CNE-GDD-CIC-ICLI.                                      
                 07 CNE-DBC-CAI-ICLI                PIC X(04).          
                 07 CNE-DBC-IIC-ICLI                PIC X(08).          
              05 CNE-DBC-GLS-NOMC                   PIC X(50).          
              05 CNE-GDG-CIC-ICLI.                                      
                 07 CNE-GDG-CAI-ICLI                PIC X(04).          
                 07 CNE-GDG-IIC-ICLI                PIC X(08).          
              05 CNE-GDG-GLS-NOMP                   PIC X(50).          
              05 CMA-GLS-DISP                       PIC X(34).          
              05 WSS-ES2-ANT                        PIC X(02).          
      *MHM-INI 29-OCT-2003                                              
              05 CMA-CIC-UING                       PIC X(12).          
      *MHM-INI 29-OCT-2003                                              
      ********************************                                  
      *RET-STT-GDG. section aasteri                                     
      ********************************                                  
       01  SCR-VARI-RED REDEFINES SCR-VARI.                             
           03 SCR-DFH    OCCURS 1200 PIC X(01).                         
                                                                             
      *>>>>
*% END
*% IF WSS_PU
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *    03 WSS-CTE-ING      VALUE 'ING'      PIC X(03).
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *    03 WSS-CTE-MULTDEU  VALUE 'MULTIPLES DEUDORES '  PIC X(19).
      *    03 WSS-CTE-GSE      VALUE 'GSE'                  PIC X(03).
      *    03 WSS-CTE-ELI      VALUE 'ELI'                  PIC X(03).
      *    03 WSS-CTE-MOD      VALUE 'MOD'                  PIC X(03).
      *    03 WSS-CTE-ANT      VALUE 'ANT'                  PIC X(03).
      *    03 WSS-CTE-DES      VALUE 'DES'                  PIC X(03).
      *    03 WSS-CTE-M        VALUE 'M'                    PIC X(01).
      *    03 WSS-CTE-E        VALUE 'E'                    PIC X(01).
      *    03 WSS-CTE-V10      VALUE '1.0'                  PIC X(03).
      *    03 WSS-CTE-1        VALUE  1                     PIC 9(01).
      *    03 WSS-CTE-2        VALUE  2                     PIC 9(01).
       77  WSS-LGM-ABSTIME                  PIC S9(15) COMP-3.
       COPY GNSBRLGN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LGN-REQA==.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
*% END
*% IF WSS
      *<<<<
      *<<<< LDC_SI AND PGM_MVS AND WSS                                  
      *PTC-INI-MAN                                                      
      *PTC-SUB                                                          
       COPY BGLWXGDG.                                                   
       COPY BGLMXW01.                                                   
      *PTC-FIN-MAN                                                      
                                                                        
       COPY LDCWGPMP.                                                   
      *>>>> WSS           
                                                
                                                                        
      *<<<< WSS                                                         
      *<<<< WSS OF PGMMAN                                               
       01  PGM-VAR-ADIC.                                                
           03 PGM-STAT-ADIC.                                            
              05 PGM-STAT-GDD.                                          
                 88 PGM-STAT-GDD-NUL VALUE '  '.                        
                 07 PGM-STT1-GDD        VALUE '2' PIC X(01).            
                    88 PGM-STAT-GDD-OKS VALUE '0'.                      
                 07 PGM-STT2-GDD        VALUE '3' PIC X(01).            
                                                                        
      *                                                                 
       01  WSS-VARI-GDG.                                                
           03 WSS-IND-ECRS             PIC X(01).                       
           03 WSS-IND-ECRT             PIC X(01).                       
      *                                                                 
       01  WSS-BUS-VARI.                                                
           03 WSS-IBUS                 VALUE 0      PIC 9(01).          
           03 WSS-IBUS-GDG           VALUE 0      PIC 9(01).            
       01  WSS-GDD-VARI.                                                
              03 WSS-MGDD              VALUE 0      PIC 9(01).          
                 88 WSS-MISMO-GDD      VALUE 0.                         
                 88 WSS-OTRO-GDD       VALUE 1.                         
                 88 WSS-PRIMER-GDD     VALUE 2.                         
              03 WSS-MISMO               VALUE 0    PIC 9(01).          
              03 WSS-OTRO                VALUE 1    PIC 9(01).          
              03 WSS-PRIMER              VALUE 2    PIC 9(01).          
                                                                        
      *COPY SGCWGICB.                                                   
       COPY SGCBRDBC.                                                   
       COPY BGLBRGDD.                                                   
*% IF PGM_PU
       COPY BGLBRPOL.                                                   
*% END
      *MHM-INI 30-JUL-2003                                              
       COPY BGLBRGDO.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDO-REQA==.        
*% IF PGM_PU
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POL-REQA==.                                                
*% END
       COPY COLBROPC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
       COPY COLBRDLC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.        
      *MHM-FIN 30-JUL-2003                                              
      *<<<< PGM_PU OR NOT NO_CIC_PQ                                     
       COPY GNSBRCIC.                                                   
       COPY GNSWGCIC.                                                   
      *<<<< PGM_DTC                                                     
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.        
      *>>>>                                                             
      *>>>>                                                             
      *<<<< UNS_FLD                                                     
       COPY GNSWGCPT.                                                   
       COPY GNSWGSTR.                                                   
      *>>>>                                                             
      *<<<< PGM_DTC                                                     
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
      *>>>>                                                             
      *>>>>                                                             
       01  WSS-VARI.                                                    
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           03 WSS-CTE-ALZ      VALUE 'ALZ'                  PIC X(03).
           03 WSS-CTE-M1           VALUE -1                PIC S9(01).
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

*% IF PGM_PU
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           03 WSS-CTE-ING      VALUE 'ING'                  PIC X(03).
           03 WSS-CTE-MGA      VALUE 'MGA'                  PIC X(03).
           03 WSS-CTE-AGA      VALUE 'AGA'                  PIC X(03).
           03 WSS-CTE-ACE      VALUE 'ACE'                  PIC X(03).
           03 WSS-CTE-EJE      VALUE 'EJE'                  PIC X(03).
           03 WSS-CTE-MST      VALUE 'MST'                  PIC X(03).
           03 WSS-CTE-GUI      VALUE '-'                    PIC X(01).
           03 WSS-CTE-A        VALUE 'A'                    PIC X(01).
           03 WSS-CTE-I        VALUE 'I'                    PIC X(01).
           03 WSS-CTE-ENE      VALUE ZEROES                 PIC 9(03).
           03 WSS-CTE-RNE  VALUE 'RUT NO ENCONTRADO' PIC X(17).
           03 WSS-CTE-GDD      VALUE 'GDD'      PIC X(03).
           03 WSS-CTE-ATA      VALUE 'ATA'      PIC X(03).
           03 WSS-CTE-MTA      VALUE 'MTA'      PIC X(03).
           03 WSS-CTE-RTA      VALUE 'RTA'      PIC X(03).
           03 WSS-CTE-RVL      VALUE 'RVL'      PIC X(03).
           03 WSS-CTE-RTF      VALUE 'RTF'      PIC X(03).
           03 WSS-SGV-VLIM       PIC  ZZ.ZZZ.ZZZ.ZZ9,9999.
           03 WSS-SGV-PLIM       PIC  ZZZ,ZZ.
           03 WSS-SGV-VALR       PIC  ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

           03 WSS-CTE-MULTDEU  VALUE 'MULTIPLES DEUDORES '  PIC X(19).
           03 WSS-CTE-GSE      VALUE 'GSE'                  PIC X(03).
           03 WSS-CTE-ELI      VALUE 'ELI'                  PIC X(03).
           03 WSS-CTE-MOD      VALUE 'MOD'                  PIC X(03).
           03 WSS-CTE-ANT      VALUE 'ANT'                  PIC X(03).
           03 WSS-CTE-DES      VALUE 'DES'                  PIC X(03).
           03 WSS-CTE-M        VALUE 'M'                    PIC X(01).
           03 WSS-CTE-E        VALUE 'E'                    PIC X(01).
           03 WSS-CTE-V10      VALUE '1.0'                  PIC X(03).
           03 WSS-CTE-1        VALUE  1                     PIC 9(01).
           03 WSS-CTE-2        VALUE  2                     PIC 9(01).

      * EVA-INI  07/08                                                  
           03  WSS-IND-TVSN      VALUE SPACES          PIC X(01).       
           03  WSS-IND-OCEN      VALUE SPACES          PIC X(01).       
           03  WSS-IND-EJEC      VALUE SPACES          PIC X(01).       
      * EVA-FIN  07/08                                                  
      *EVA-AFRI/MAYO2006                                                
           03  WSS-EXT-PNTL                            PIC X(02).       
           03  WSS-I     VALUE ZEROES                  PIC 9(02).       
           03  WSS-GLS-DATA.                                            
               05  WSS-VEC-PNTL OCCURS 20 TIMES.                        
                   07 WSS-COD-PNTL                     PIC X(03).       
      *AFRI-INI/DIC-2007                                                
      * EVA-INI  12/08
           03  WSS-COD-OFIC        VALUE SPACES        PIC X(03).
      * EVA-FIN  12/08
           03 GOR-VARI.                                                 
              05 GOR-NUM-CALC.                                          
                 07 GOR-NUM-OFIC  VALUE ZEROES      PIC 9(03).          
                 07 GOR-NUM-PROD  VALUE ZEROES      PIC 9(02).          
                 07 GOR-NUM-CORR  VALUE ZEROES      PIC 9(06).          
              05 GOR-NUM-DIGV     VALUE ZEROES      PIC 9(01).          
           03 GOR-NUM-VRF.                                              
                 07 GOR-VRF-FRST  VALUE SPACES      PIC X(01).          
                 07 GOR-VRF-CALC  VALUE SPACES      PIC X(11).          
           03 GDG-IIC-NGTA        VALUE ZEROES      PIC 9(08).          
           03 WSS-GDG-CIC-TTAB    VALUE SPACES      PIC X(03).          
           03 GDG-KEY.                                                  
              05 GDG-KEY-CAII     VALUE SPACES      PIC X(04).          
              05 GDG-KEY-NUMI     VALUE SPACES      PIC X(08).          
           03 WSS-OFI.                                                  
              05 WSS-OFI-NBCS     VALUE ZEROES      PIC X(01).          
              05 WSS-OFI-NOVA     VALUE ZEROES      PIC X(02).          
           03 WSS-GDG-OFI.                                              
              05 WSS-GDG-NUM-TABL     VALUE SPACES  PIC X(03).          
              05 WSS-GDG-NUM-OFIC     VALUE ZEROES  PIC X(09).          
      *AFRI-FIN/DIC-2007                                                
      *EVA-AFRI/JUN2006                                                 
           03  PTT-COD-PTLL                            PIC X(06).       
           03  PTT-EXT-PNTL   VALUE 'NO'               PIC X(02).       
           03  PTT-I     VALUE ZEROES                  PIC 9(02).       
           03  PTT-GLS-DATA.                                            
               05  PTT-VEC-PNTL OCCURS 10 TIMES.                        
                   07 PTT-COD-PNTL                     PIC X(06).       
      *FIN-AFRI/MAYO2006  
*% END
           03 WSS-ANT                                   PIC X(02).      
           03 WSS-MARC-4                                PIC X(01).      
           03 WSS-CIC-ICLI-GDG.                                         
              05 WSS-CAI-ICLI                           PIC X(04).      
              05 WSS-IIC-ICLI                           PIC X(08).      
           03  WSS-IND-EXI-GDO                          PIC X(01).      
           03  WSS-ALZ-DAP           VALUE SPACES       PIC X(01).      
           03  WSS-FEC-ULT-ACT                          PIC X(08).      
           03  WSS-IND-CCAD                             PIC X(01).      
           03  WSS-NUM-TIPO-ALF                         PIC X(06).      
           03  WSS-NUM-TIPO  REDEFINES WSS-NUM-TIPO-ALF PIC 9(06).      
           03  WSS-KEY-IGDG.                                            
               05 WSS-CAI-GTIA                          PIC X(04).      
               05 WSS-IIC-GTIA                          PIC X(08).      
           03  WSS-FRM-MENS.                                            
               05 WSS-FRM-MENS1                         PIC X(21).      
               05 WSS-FRM-MENS2                         PIC X(12).      
           03  WSS-FRM-IIC-IOPD      VALUE SPACES       PIC X(18).      
*% IF PGM_PU
      *AFRI-INI JUL/2004                                                
           03  WSS-GLS-TGAR.                                            
               05 WSS-VEC-TGAR   OCCURS 10 TIMES.                       
                  07 WSS-IND-TGAR                      PIC X(06).       
      *AFRI-FIN JUL/2004                                                
*% END
      *<<<< FMT_IDC                                                     
           03 WSS-COD-CGTA.                                             
               05 WSS-TIP-CGTA                          PIC X(03).      
               05 WSS-STP-CGTA                          PIC X(03).      
      *<<<< GEN_BCI                                                     
           03  WSS-FEC-FVTO.                                            
               05 WSS-NUM-SVTO                          PIC X(02).      
               05 WSS-NUM-AVTO                          PIC X(02).      
               05 WSS-NUM-MVTO                          PIC X(02).      
               05 WSS-NUM-DVTO                          PIC X(02).      
                                                                        
*% IF PGM_PQ
      * EVA-INI  12/08                                                  
           03 WSS-COD-OFIC          VALUE SPACES        PIC X(03).      
           03 WSS-IND-OCEN          VALUE SPACES        PIC X(03).      
      * EVA-FIN  12/08                                                  
*% END
           03  WSS-CIC-CTAB         VALUE SPACES        PIC X(03).      
           03 WSS-IND-ALZA          VALUE SPACES        PIC X(03).      
           03 WSS-FIO-STAT-BKP      VALUE SPACES        PIC X(02).      
      *MHM-INI 23-OCT-2003                                              
           03 WSS-GLS-CGTA.                                             
              05 WSS-GLS-TOPE                   PIC X(40).              
              05 WSS-GLS-SOPE                   PIC X(40).              
      *MHM-FIN 23-OCT-2003                                              
      *MHM-INI 03-DIC-2003                                              
           03 WSS-IND-EGAP          VALUE SPACES       PIC X(01).       
           03 WSS-IND-GAPB          VALUE SPACES       PIC X(01).       
      *MHM-FIN 03-DIC-2003                                              
*% IF PGM_PQ
           03 WSS-IND-TVSN          VALUE SPACES       PIC X(01).       
*% END
*% IF PGM_PU
      *LOP-INI 6-DIC-2002                                               
           03 WSS-COD-CVMC.                                             
              05  WSS-COD-MENS                         PIC X(12).       
              05  WSS-COD-MEN2                         PIC X(12).       
              05  WSS-NUM-MENS                         PIC 9(02).       
              05  WSS-NUM-MEN2                         PIC 9(02).       
              05  WSS-CAMB                             PIC X(28).       
           03 WSS-FEC-FCIE     VALUE 0                 PIC 9(08).       
           03 WSS-CIC-ICLF                             PIC X(12).       
           03 WSS-T                    VALUE ZEROES    PIC 9(02).       
      *LOP-FIN 6-DIC-2002                                               
      *OGB-INI 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
           03 WSS-CTE-MSG1     VALUE 'DAPNOGARA   '    PIC X(12).
           03 WSS-CTE-MSG2     VALUE 'DAPNOALZADO '    PIC X(12).
           03 WSS-CTE-BGL      VALUE 'BGL'             PIC X(03).
      *OGB-FIN 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
      *MPB-INI  03-NOV-2017 Correccion Liquidacion DPI
           03 WSS-CTE-OPGA VALUE 'OPERACION EN GARANTIA' PIC X(21).
           03  WSS-DAP                  VALUE 'DAP'     PIC X(03).
           03  WSS-IN1                  VALUE 'IN1'     PIC X(03).
           03  WSS-AUT                  VALUE 'AUT'     PIC X(03).
           03  WSS-ONP                  VALUE 'ONP '    PIC X(04).
           03  WSS-E                    VALUE 'E'       PIC X(01).
           03  WSS-S                    VALUE 'S'       PIC X(01).
           03  WSS-N                    VALUE 'N'       PIC X(01).
           03  WSS-R                    VALUE 'R'       PIC X(01).
           03  WSS-II                   VALUE 'I'       PIC X(01).
           03  WSS-PTOC                 VALUE ';'       PIC X(01).
           03  WSS-SPC                  VALUE ' '       PIC X(01).
           03  WSS-OPDNX       VALUE 'OPD    NEX'       PIC X(12).
           03  WSS-CADKEY      VALUE 'CAD-KEY-ICAD'     PIC X(12).
           03  WSS-OPDMOD      VALUE 'X'                PIC X(01).


           03 WSS-GLS-DGT.
               05 WSS-GLS-DGT01                        PIC X(01).
               05 WSS-GLS-DGT02                        PIC X(01).
               05 WSS-GLS-DGT03                        PIC X(01).
               05 WSS-GLS-DGT04                        PIC X(01).
               05 WSS-GLS-DGT05                        PIC X(01).
               05 WSS-GLS-DGT06                        PIC X(01).
               05 WSS-GLS-DGT07                        PIC X(01).
               05 WSS-GLS-DGT08                        PIC X(01).
               05 WSS-GLS-DGT09                        PIC X(01).
               05 WSS-GLS-DGT10                        PIC X(01).
               05 WSS-GLS-DGT11                        PIC X(01).
               05 WSS-GLS-DGT12                        PIC X(01).
               05 WSS-GLS-DGT13                        PIC X(01).
               05 WSS-GLS-DGT14                        PIC X(01).
               05 WSS-GLS-DGT15                        PIC X(01).
               05 WSS-GLS-DGT16                        PIC X(01).
               05 WSS-GLS-DGT17                        PIC X(01).
               05 WSS-GLS-DGT18                        PIC X(01).
               05 WSS-GLS-DGT19                        PIC X(01).
               05 WSS-GLS-DGT20                        PIC X(01).
               05 WSS-GLS-DGT21                        PIC X(01).
               05 WSS-GLS-DGT22                        PIC X(01).
               05 WSS-GLS-DGT23                        PIC X(01).
               05 WSS-GLS-DGT24                        PIC X(01).
               05 WSS-GLS-DGT25                        PIC X(01).
               05 WSS-GLS-DGT26                        PIC X(01).
               05 WSS-GLS-DGT27                        PIC X(01).
               05 WSS-GLS-DGT28                        PIC X(01).
               05 WSS-GLS-DGT29                        PIC X(01).
               05 WSS-GLS-DGT30                        PIC X(01).
               05 WSS-GLS-DGT31                        PIC X(01).
               05 WSS-GLS-DGT32                        PIC X(01).
               05 WSS-GLS-DGT33                        PIC X(01).
               05 WSS-GLS-DGT34                        PIC X(01).
               05 WSS-GLS-DGT35                        PIC X(01).
               05 WSS-GLS-DGT36                        PIC X(01).
               05 WSS-GLS-DGT37                        PIC X(01).
               05 WSS-GLS-DGT38                        PIC X(01).
               05 WSS-GLS-DGT39                        PIC X(01).
               05 WSS-GLS-DGT40                        PIC X(01).
      *MPB-FIN
      *LOP-INI 6-DIC-2002                                               
       COPY LDCWGCCU.                                                   
       COPY LDCWGCEG.                                                   
       COPY LDCBRCLF.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.        
       COPY LDCBRRDC REPLACING RDC BY RDL.                              
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.        
      *LOP-FIN 6-DIC-2002                                               
*% END
                                                                        
       COPY BGLWGDAP.                                                   
       COPY DAPBROPD.                                                   
       COPY DAPBRRCC.                                                   
*% IF PGM_PU
           COPY USPC113.                                                
*% END
*% IF PGM_PQ
                                                                        
      *********************************************                     
      *           MODULO   USPC113                *                     
      *********************************************                     
      *       DEFINICION IDENTIFICACION TS        *                     
      *********************************************                     
                                                                        
       01  UIB.                                                         
           02  FILLER                  PIC X(32) VALUE 'USPR002'.       
       01  USP-LARGO-TS                PIC S9(4) COMP VALUE +150.       
       01  USP-IDENTIFICACION.                                          
           05  USP-TERMINAL            PIC X(04).                       
           05  USP-OPID-USU            PIC X(03).                       
           05  FILLER                  PIC X(01)  VALUE ' '.            
       01  USP-LLENA-VECTOR            PIC X(1)   VALUE ' '.            
       01  USP-USA-VECTOR              PIC X(1)   VALUE ' '.            
                                                                        
      *********************************************                     
      *       DEFINICION AREA DE TRASPASO         *                     
      *********************************************                     
                                                                        
       01  AREA-TRASPASO.                                               
           05  USP-PERMISO             PIC X(01).                       
           05  USP-PTA-NUM             PIC 9(03)  VALUE 0.              
           05  USP-PTA-STR             PIC X(12)  VALUE SPACES.         
           05  USP-AREA-COMUN.                                          
               10  USP-TIPO-USUARIO.                                    
                   15  USP-IDENT-TU    PIC X(03).                       
      *                TIPO DE USUARIO                                  
                                                                        
                   15  USP-MODO-OP     PIC X(01).                       
      *                MODO OPERACION (CONSULTA/ACTUALIZACION)          
                                                                        
               10  USP-SISTEMA.                                         
                   15  USP-IDENT-SIS   PIC X(03).                       
      *                IDENTIFICACION DEL SISTEMA QUE SE ESTA PROCE_    
      *                SANDO SEGUN USUARIOS Y PRIVILEGIOS               
                                                                        
                   15  USP-GRUPO       PIC X(03).                       
      *                IDENTIFICACION DEL GRUPO DE SISTEMA QUE SE ESTA  
      *                PROCESANDO SEGUN USUARIOS Y PRIVILEGIOS          
      *                                                                 
                                                                        
               10  USP-INDIC-PROCESO   PIC X(01).                       
      *            INDICADOR DE SISTEMA USUARIO Y PRIVILEGIO  ACTIVO    
                                                                        
               10  USP-COD-OFICINA     PIC X(03).                       
      *            CODIGO DE LA OFICINA DEL USUARIO                     
                                                                        
               10  USP-COD-DEPTO       PIC X(03).                       
      *            CODIGO DEL DEPTO DEL USUARIO                         
                                                                        
               10  USP-COD-USUARIO     PIC X(12).                       
      *            CODIGO USUARIO (TABLA USR)                           
                                                                        
               10  USP-COD-TERMINAL    PIC X(04).                       
      *            CODIGO DE TERMINAL                                   
                                                                        
               10  USP-OPID            PIC X(03).                       
      *            OPID DE USUARIO                                      
                                                                        
               10  USP-FECHA.                                           
      *            FECHA                                                
                   15  USP-ANO         PIC X(02).                       
                   15  USP-MES         PIC X(02).                       
                   15  USP-DIA         PIC X(02).                       
                                                                        
               10  USP-HORA            PIC X(06).                       
      *            HORA                                                 
                                                                        
               10  USP-PASSWORD        PIC X(08).                       
      *            PASSWORD DE USUARIO(SOLO PARA CONECCION VIA RUTINA)  
                                                                        
               10  USP-INDICADORES.                                     
                   15  USP-USU-CMN1    PIC X(01).                       
      *            1   */CON       CONSULTA                             
      *            2   */MAN       CONSULTA Y MANTENCION                
      *            3   */*         TODO                                 
      *                                                                 
                   15  USP-USU-CMN2    PIC X(01).                       
      *            P   *           PERMISO AL MENU                      
      *                                                                 
                   15  USP-USU-CMN3    PIC X(01).                       
      *            P   */OFI       OTRAS OFICINAS                       
      *                                                                 
                   15  USP-USU-CMN4    PIC X(01).                       
                   15  USP-USU-CMN5    PIC X(01).                       
                   15  USP-USU-CMN6    PIC X(01).                       
                   15  USP-USU-CMN7    PIC X(01).                       
                   15  USP-USU-CMN8    PIC X(01).                       
                   15  USP-USU-CMN9    PIC X(01).                       
                   15  USP-USU-CMN10   PIC X(01).                       
                   15  USP-USU-CMN11   PIC X(01).                       
                   15  USP-USU-CMN12   PIC X(01).                       
                   15  USP-USU-CMN13   PIC X(01).                       
                   15  USP-USU-CMN14   PIC X(01).                       
                   15  USP-USU-CMN15   PIC X(01).                       
                   15  USP-USU-CMN16   PIC X(01).                       
               10  USP-INDICADORES-RED REDEFINES USP-INDICADORES.       
                   15  USP-USU-CMN-ARR OCCURS 16 TIMES   PIC X(01).     
      *                                                                 
      *            INDICADORES QUE  INDICAN PRIVILEGIO DE USUARIOS      
      *                                                                 
               10  FILLER              PIC X(78).                       
      *            DISPONIBLE USO FUTURO                                
      *                                                                 
      *********************************************                     
      *     AREAS PARA LECTURA DE TABLA "STR"     *                     
      *********************************************                     
      *                                                                 
      *01  COPYDD USP-R-STR.USP-E-STR01(PROD).                          
       01  USP-E-STR01.                                                 
           02  USP-CLV-STR-1.                                           
               03  USP-COD-GST     PICTURE X(3).                        
               03  USP-COD-STR     PICTURE X(12).                       
           02  USP-COD-PTA         PICTURE X(3).                        
      *                                                                 
       01  REQ-AREA.                                                    
               05  COD-CMND            PIC X(005).                      
               05  NOM-TABL            PIC X(003).                      
               05  NOM-CLAV            PIC X(005).                      
               05  RET-CODI            PIC X(002).                      
               05  RET-INTE            PIC X(001).                      
               05  NUM-BASE            PIC S9(004) COMP VALUE +120.     
               05  NOM-REGI            PIC X(007).                      
               05  FILLER              PIC X(025).                      
               05  MAX-CONT            PIC S9(004) COMP.                
               05  NOM-CONT            PIC S9(004) COMP.                
               05  FILLER              PIC X(022).                      
               05  VAL-CLAV.                                            
                   10  FECHA           PIC 9(008).                      
                   10  HORA            PIC 9(006).                      
      *                                                                 
       01  ELEM-LIST.                                                   
               05  NOM-ELEM            PIC X(011).                      
               05  SEC-CODI            PIC X(001).                      
               05  FILLER              PIC X(005) VALUE SPACES.         
      *                                                                 
       01  REQ-AREA-STR.                                                
               05  COD-CMND-STR        PIC X(005).                      
               05  NOM-TABL-STR        PIC X(003).                      
               05  NOM-CLAV-STR        PIC X(005).                      
               05  RET-CODI-STR        PIC X(002).                      
               05  RET-INTE-STR        PIC X(001).                      
               05  NUM-BASE-STR        PIC S9(004) COMP VALUE +120.     
               05  NOM-REGI-STR        PIC X(007).                      
               05  FILLER              PIC X(025).                      
               05  MAX-CONT-STR        PIC S9(004) COMP.                
               05  NOM-CONT-STR        PIC S9(004) COMP.                
               05  FILLER              PIC X(022).                      
               05  VAL-CLAV-STR.                                        
                   10  USP-COD-GST     PIC X(003).                      
                   10  USP-COD-STR     PIC X(012).                      
      *                                                                 
       01  ELEM-LIST-STR.                                               
               05  NOM-ELEM-STR        PIC X(011).                      
               05  SEC-CODI-STR        PIC X(001).                      
               05  FILLER              PIC X(005) VALUE SPACES.         
      *                                                                 
      *********************************************                     
      *           FIN   MODULO   USPC113          *                     
      *********************************************                     
*% END
                                                                        
      *>>>>                                                             
      *>>>>                                                             
       01  WSS-FRM-MEN2.                                                
           03 WSS-CAI-MEN2                  PIC X(04).                  
           03 WSS-BLK1       VALUE SPACES   PIC X(03).                  
           03 WSS-NUM-MEN2                  PIC 9(08).                  
           03 WSS-BLK2       VALUE SPACES   PIC X(24).                  
      *<<<< PGM_MEX                                                     
       COPY BGLBRGSL.                                                   
       COPY BGLBRGSO.                                                   
      *>>>>                                                             
      *<<<< PGM_VMS OR PGM_DTC                                          
       COPY BGLBRGMO.                                                   
       COPY BGLBRTAG.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GMO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GAP-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GLE-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIN-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDP-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSE-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSI-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GTP-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GUB-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSL-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVE-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIM-REQA==.    
      *<<<< PGM_VSI OR PGM_DB2                                          
       COPY BGLBRGAP.                                                   
       COPY BGLBRGDP.                                                   
       COPY BGLBRGES.                                                   
       COPY BGLBRGIN.                                                   
       COPY BGLBRGLE.                                                   
       COPY BGLBRGSE.                                                   
       COPY BGLBRGSI.                                                   
       COPY BGLBRGTP.                                                   
       COPY BGLBRGUB.                                                   
       COPY BGLBRGVT.                                                   
       COPY BGLBRGIM.                                                   
       COPY BGLBRGVE.
      *MPB-INI  03-NOV-2017 Correccion Liquidacion DPI
       COPY DAPBRCAD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAD-REQA==.
       COPY DAPBREPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EPD-REQA==.
      *MPB-FIN
      *>>>>                                                             
      *<<<< PGM_PU OR PGM_PQ                                            
       COPY BGLWGVCG.                                                   
      *<<<< GEN_BCI                                                     
       COPY BGLWGIDP.                                                   
      *>>>>                                                             
      *<<<< NOT ( PGM_VSI OR PGM_DB2 )                                  
       COPY BGLWGELI.                                                   
      *>>>>                                                             
       01  WSS-VARI-ADI.                                                
           03 WSS-REG                             PIC X(03).            
           03 WSS-COD-CTA.                                              
              05 WSS-COD-CGTA                     PIC X(03).            
              05 WSS-VCB.                                               
                 07 WSS-TIP-VCB                   PIC X(01).            
                 07 WSS-COD-VCB                   PIC X(03).            
                 07 WSS-TIP-CMB                   PIC X(02).            
*% IF PGM_PU
      *EVA-AFRI/JUL2007    [RVL]                                        
           03 WSS-FEC-FURV.                                             
              05 WSS-NUM-SURV                   PIC 9(02).              
              05 WSS-NUM-AURV                   PIC 9(02).              
              05 WSS-NUM-MURV                   PIC 9(02).              
              05 WSS-NUM-DURV                   PIC 9(02).              
           03 WSS-FEC-URVL.                                             
              05 WSS-NUM-SRVL                   PIC 9(02).              
              05 WSS-NUM-ARVL                   PIC 9(02).              
              05 WSS-NUM-MRVL                   PIC 9(02).              
              05 WSS-NUM-DRVL                   PIC 9(02).              
*% END
                                                                        
      *>>>>                                                             
      *>>>>                                                             
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
      *>>>>
*% END
*% IF PGM_PQ
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD                                                 
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR              
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND           
              SCR-STAT = SCR-STAT-CON                                   
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG.                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM RST-STAT                                         
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY                     
               IF SCR-STAT NOT = SCR-STAT-ABT                           
                   PERFORM SCR-TRL                                      
               ELSE                                                     
                   PERFORM DESSCRTRL                                    
                   GO TO FIN-SCR-MOD.                                   
      *>>>>                                                             
*% END
*% END
*% IF PFS_SCR_ACC            
      *<<<< PFS_SCR_ACC                                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG                                  
               PERFORM RST-STAT                                         
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY                     
               IF SCR-STAT NOT = SCR-STAT-ABT                           
                   PERFORM SCR-TRL                                      
               ELSE                                                     
                   PERFORM DESSCRTRL                                    
                   GO TO FIN-SCR-ACC.                                   
      *>>>>                                                             
*% END           
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI                                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG                                  
               PERFORM RST-STAT                                         
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY                     
               IF SCR-STAT NOT = SCR-STAT-ABT                           
                   PERFORM SCR-TRL                                      
               ELSE                                                     
                   PERFORM DESSCRTRL                                    
                   GO TO FIN-SCR-ELI.                                   
      *>>>>                                                             
*% END
*% IF PFS_SCR_ACT                                                 
      *<<<< PFS_SCR_ACT                                                 
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR              
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND           
              SCR-STAT = SCR-STAT-CON                                   
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG.                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM RST-STAT                                         
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY                     
               IF SCR-STAT NOT = SCR-STAT-ABT                           
                   PERFORM SCR-TRL                                      
               ELSE                                                     
                   PERFORM DESSCRTRL                                    
                   GO TO FIN-SCR-ACT.                                   
      *>>>>                                                             
*% END
*% IF INI_FND_KEY
      *>>>>
      * EVA-INI  12/08                                                  
           MOVE GDG-COD-OFIC IN GDG-FLD TO WSS-COD-OFIC IN WSS-VARI.    
      * EVA-FIN  12/08                                                  
      * EVA-INI-AFRI/ENERO2006                                          
           IF SCR-CMND = 'MST'                                          
              MOVE GDG-CAI-GTIA IN GDG-FLD TO                           
                   GDG-CAI-GTIA IN GDG                                  
              MOVE GDG-IIC-GTIA IN GDG-FLD TO                           
                   GDG-IIC-GTIA IN GDG                                  
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM BGL-FIO-GDG                                       
              IF NOT (FIO-STAT-OKS                                      
                 AND GDG-IND-EST1 IN GDG  = '05')                       
                  MOVE 'GDGNOTRAMITE' TO MSG-COD-MENS                   
      **AFRI-INI/SEP2009                                                
                  GO TO ERR-FND-KEY.                                    
      *       ELSE                                                      
      *           PERFORM VAL-IND-GSO                                   
      *           IF MSG-COD-MENS > SPACES                              
      *               GO TO ERR-FND-KEY.                                
      **AFRI-INI/SEP2009                                                
      * EVA-FIN-AFRI/ENERO2006                                          
      *<<<< EVP-INI INGFNDKEY                                           
      *<<<< GEN_BCI                                                     
      *CGL-INI 07-06-2003                                               
      * CODIGO AGREGADO PARA M:N                                        
           IF SCR-CCPP = 'ING'                                          
               IF GDG-IIC-GTIA IN GDG-FLD > ZEROES                      
                   MOVE 1 TO WSS-IBUS-GDG                               
                   MOVE GDG-CAI-GTIA IN GDG-FLD TO                      
                        GDG-CAI-GTIA IN GDG                             
                   MOVE GDG-IIC-GTIA IN GDG-FLD TO                      
                        GDG-IIC-GTIA IN GDG                             
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM BGL-FIO-GDG                                  
                   IF FIO-STAT-OKS                                      
      *<<<< NOT ING_SBR_HIJ                                             
      *            se encontro el hijo : error                          
      *            no ingresa sobre el hijo encontrado                  
                       MOVE '00' TO PGM-STAT-GDG                        
                       MOVE 'GDG    EXT' TO MSG-COD-MENS                
                       GO TO ERR-FND-KEY                                
                   ELSE                                                 
                       MOVE '23' TO FIO-STAT                            
                       GO TO FIN-FND-KEY                                
      *>>>>                                                             
                 ELSE                                                   
                   PERFORM FND-DIRECTO                                  
                   GO TO FIN-FND-KEY.                                   

      *PVC-INI 19-OCT-2012  -  ADMINISTRACION PRENDAS WARRANTS 
           PERFORM GET-FHOY                                             
           MOVE GDG-CAI-GTIA IN GDG-FLD TO                              
                GDG-CAI-GTIA IN GDG                                     
           MOVE GDG-IIC-GTIA IN GDG-FLD TO                              
                GDG-IIC-GTIA IN GDG                                     
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM BGL-FIO-GDG                                          
           IF FIO-STAT-OKS                                              
               IF GDG-FEC-FVTO IN GDG < HOY-FHOY AND
                 ( GDG-IND-EST1 IN GDG > '09' AND
                   GDG-IND-EST1 IN GDG < '20' )
                   MOVE 'BGL'        TO MSG-COD-SIST
                   MOVE 'GDGVEN    ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00' TO FIO-STAT.
      *>>>>
      *PVC-FIN 19-OCT-2012
      *>>>>                                                             
      * CODIGO AGREGADO PARA M:N                                        
                                                                        
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE 0      TO WSS-IBUS.                                     
           MOVE 0      TO WSS-IBUS-GDG.                                 
           MOVE '23'   TO PGM-STAT-GDD.                                 
                                                                        
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND           
                GAR-KEY-AGDD IN CMA-VARI > SPACES                       
                PERFORM LEE-NXT-PRV-XGDD                                
                IF WSS-IBUS = 3                                         
                   PERFORM SCR-CLRA-GDG                                 
                   GO TO EXA-COM-STAT                                   
                ELSE                                                    
                   MOVE PGM-SNUL TO PGM-STAT-GDG                        
                   MOVE PGM-SNUL TO PGM-STAT-DBC                        
                   IF FRM-FFLD = FRM-FFLD-PF5                           
                       MOVE 'GDD    NOPRV' TO MSG-COD-MENS              
                       GO TO ERR-FND-KEY                                
                   ELSE                                                 
                       MOVE 'GDD    NONXT' TO MSG-COD-MENS              
                       GO TO ERR-FND-KEY                                
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5                   
               MOVE 'GDD    NEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF FRM-FFLD = FRM-FFLD-PF8                                   
              OR FRM-FFLD-PF7                                           
               PERFORM LEE-NXT-PRV-XDBC                                 
               IF WSS-IBUS = 1                                          
                   GO TO CON-BUS-DBC                                    
               ELSE                                                     
                   MOVE PGM-SNUL TO PGM-STAT-GDG                        
                   MOVE PGM-SNUL TO PGM-STAT-DBC                        
                   IF FRM-FFLD = FRM-FFLD-PF7                           
                       MOVE 'DBC    NOPRV' TO MSG-COD-MENS              
                       GO TO ERR-FND-KEY                                
                   ELSE                                                 
                       MOVE 'DBC    NONXT' TO MSG-COD-MENS              
                       GO TO ERR-FND-KEY.                               
           IF GDG-IIC-GTIA IN GDG-FLD > ZEROES AND                      
      *<<<< FMT_CHI                                                     
              DBC-NUM-ICLI IN GDG-FLD = ZEROES AND                      
      *>>>>                                                             
              DBC-GLS-NOMC IN GDG-FLD NOT > SPACES                      
                                                                        
               MOVE 'N' TO CMA-IND-KPAD IN CMA-VARI                     
               PERFORM FND-DIRECTO                                      
               IF FIO-STAT-OKS                                          
                   MOVE 2 TO WSS-IBUS                                   
      *            para buscar RPH y PAD                                
                   PERFORM GET-CUR-GDD                                  
                   IF FIO-STAT-OKS                                      
                       MOVE 3 TO WSS-IBUS                               
                       MOVE GDD-CIC-DCLI IN GDD TO DBC-KEY-IDBC IN DBC  
                        MOVE FIO-GET-KEY TO FIO-CMND                    
                        PERFORM SGC-FIO-DBC                             
                        MOVE FIO-STAT TO PGM-STAT-DBC                   
                        IF FIO-STAT-OKS                                 
                            GO TO EXA-COM-STAT                          
                        ELSE                                            
                            MOVE 'GDD    NODBC' TO MSG-COD-MENS         
                            GO TO EXA-COM-STAT                          
                   ELSE                                                 
                       MOVE 'GDD    NEX' TO MSG-COD-MENS                
                       GO TO EXA-COM-STAT                               
               ELSE                                                     
                   MOVE SPACES TO GAR-KEY-AGDD IN CMA-VARI              
                   MOVE SPACES TO GAR-CIC-DCLI IN CMA-VARI              
                   MOVE SPACES TO DBC-KEY-IDBC IN CMA-VARI              
                   MOVE 'GDG    NEX' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY.                                   
                                                                        
      *                                                                 
           MOVE SPACES TO GAR-KEY-AGDD IN CMA-VARI.                     
           MOVE SPACES TO GAR-CIC-DCLI IN CMA-VARI.                     
           MOVE SPACES TO DBC-KEY-IDBC IN CMA-VARI.                     
                                                                        
      *<<<< FMT_CHI                                                     
            IF DBC-NUM-ICLI IN GDG-FLD NOT = ZEROES                     
      *>>>>                                                             
               MOVE 'I' TO CMA-IND-KPAD IN CMA-VARI                     
               MOVE 1 TO WSS-IBUS                                       
               GO TO CON-BUS-DBC.                                       
           IF DBC-GLS-NOMC IN GDG-FLD > SPACES                          
      *NOM-CLI Busca Cliente por medio del Nombre                       
                                                                        
               MOVE 'N' TO CMA-IND-KPAD IN CMA-VARI                     
               MOVE DBC-GLS-NOMC IN GDG-FLD TO DBC-GLS-NOMC IN DBC      
               MOVE 'DBC-GLS-NOMC'   TO FIO-AKEY                        
               MOVE FIO-GET-NLS TO FIO-CMND                             
               PERFORM GET-CLI                                          
               IF MSG-COD-MENS NOT > SPACES                             
                   MOVE 1 TO WSS-IBUS.                                  
                                                                        
      * SI SE PROCESA SUBENTIDAD, LA BUSQUEDA POR LLAVE ALTERNATIVA     
      *  DEBE SER UN PARRAFO CON LOOP                                   
                                                                        
           IF WSS-IBUS = 0                                              
               MOVE 'DBC    NEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
       CON-BUS-DBC.                                                     
      *    se encontro el padre y busca el GDG                          
           MOVE '00' TO PGM-STAT-DBC.                                   
                                                                        
      * Para permitir Ant/Sig aunque padre no tenga operaciones         
           MOVE DBC-KEY-IDBC IN DBC TO DBC-KEY-IDBC IN CMA-VARI.        
                                                                        
      *    se digito tambien el hijo, se busca directamente GDD         
           IF GDG-IIC-GTIA IN GDG-FLD > ZEROES                          
              AND NOT (FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7)         
      *        Buscara Cliente por medio de NOM cuando PF7 O PF8        
               MOVE 'N' TO CMA-IND-KPAD IN CMA-VARI                     
               PERFORM GET-GDD                                          
               IF WSS-IBUS = 1                                          
                   MOVE 'GDD    NEX' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY                                    
               ELSE                                                     
               IF WSS-IBUS = 2                                          
                   MOVE 'GDG    NEX' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY                                    
               ELSE                                                     
      *            se encontro el hijo                                  
                   GO TO EXA-COM-STAT                                   
           ELSE                                                         
      *    no se digito el hijo, se busca el ultimo                     
               MOVE DBC-KEY-IDBC IN DBC TO GDD-CIC-DCLI IN GDD          
               MOVE '999999999999'      TO GDD-KEY-AGDD IN GDD          
               MOVE 'GDD-KEY-IGDD' TO FIO-AKEY                          
               MOVE FIO-GET-LEQ TO FIO-CMND                             
               PERFORM BGL-FIO-GDD                                      
               IF NOT (FIO-STAT-OKS AND                                 
                       DBC-KEY-IDBC IN DBC = GDD-CIC-DCLI IN GDD)       
                  MOVE 'GDD    NEX' TO MSG-COD-MENS                     
                  GO TO ERR-FND-KEY                                     
               ELSE                                                     
                MOVE 3 TO WSS-IBUS                                      
      *CGL-FIN 25-06-98                                                 
               PERFORM BUS-ULT-GDG                                      
               IF WSS-IBUS = 3                                          
      *            se encontro el hijo                                  
                   GO TO EXA-COM-STAT                                   
               ELSE                                                     
                   MOVE 'GDD    NEX' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY.                                   
                                                                        
       FND-DIRECTO.                                                     
           MOVE 1 TO WSS-IBUS-GDG.                                      
                                                                        
      *>>>> EVP-FIN BUSPADHIJ                                           
*% END
*% IF FIN_FND_KEY
      *<<<<
      * ISP INI  28-JAN-2004 13:37:42                                   
           IF SCR-HDR-MRCA = 'BCS' AND                                  
              NOT FIO-STAT-OKS AND                                      
              WSS-LEYO-GORI = 'N'                                       
                   MOVE 'S' TO WSS-LEYO-GORI                            
                   MOVE GDG-CIC-GTIA IN GDG TO GDG-COD-GORI IN GDG      
                   MOVE 'GDG-COD-GORI' TO FIO-AKEY                      
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM BGL-FIO-GDG                                  
                   IF FIO-STAT-OKS                                      
                       MOVE GDG-CAI-GTIA IN GDG TO                      
                            GDG-CAI-GTIA IN GDG-FLD                     
                       MOVE GDG-IIC-GTIA IN GDG TO                      
                            GDG-IIC-GTIA IN GDG-FLD                     
                       GO TO INI-FND-KEY.                               
                                                                        
       EXA-COM-STAT.                                                    
      * EVA-INI  12/08                                                  
                                                                        
           IF (SCR-HDR-MRCA = 'BCS')                                    
              PERFORM VAL-VSN                                           
              IF WSS-IND-TVSN IN WSS-VARI = 'S' AND                     
                 SCR-CMND NOT = 'CON' AND SCR-CMND NOT = 'ING'          
                 PERFORM VAL-CEN-GDG                                    
                 IF (GDG-COD-OFIC IN GDG NOT =                          
                     USR-COD-OFUS IN USR) AND                           
                     WSS-IND-OCEN IN WSS-VARI = 'N'                     
                     MOVE 'ERR MOD' TO MSG-COD-MENS                     
                     GO TO ERR-FND-KEY.                                 
      * EVA-FIN  12/08                                                  
      *<<<< EVP-INI FINFNDKEY                                           
                                                                        
           MOVE GDG-FEC-FTRN IN GDG TO SCR-UMOD.                        
           IF WSS-IBUS = 2 OR 3                                         
      *        se encontro el hijo                                      
               MOVE '00' TO PGM-STAT-GDG                                
               MOVE GDG-KEY-IGDG IN GDG TO GAR-KEY-AGDD IN CMA-VARI.    
                                                                        
           IF WSS-IBUS = 3                                              
      *        se encontro la relacion completa                         
               MOVE '00' TO PGM-STAT-GDD                                
               MOVE GDD-CIC-DCLI IN GDD TO GAR-CIC-DCLI IN CMA-VARI     
               MOVE '00' TO PGM-STAT-DBC                                
               MOVE GDD-CIC-DCLI IN GDD TO DBC-KEY-IDBC IN CMA-VARI     
           ELSE                                                         
      *       GDG incompleto                                            
               MOVE '23' TO PGM-STAT-GDD                                
               MOVE '23' TO PGM-STAT-DBC                                
               MOVE SPACES TO DBC-CAI-ICLI IN CMA-VARI                  
               MOVE ZEROES TO DBC-IIC-ICLI IN CMA-VARI                  
               MOVE DBC-KEY-IDBC IN CMA-VARI TO GAR-CIC-DCLI IN CMA-VARI
               GO TO ANL-GDG.                                           
                                                                        
      * Determina si tiene multiples padres para comando consulta       
           IF NOT ( SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON )      
               GO TO ANL-GDG.                                           
                                                                        
           MOVE SPACES TO MSG-COD-SIST.                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
                                                                        
      * Se posiciona por la llave del hijo                              
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
                                                                        
      *    Busca siguiente por la llave del hijo                        
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NXT TO FIO-CMND.                                
                                                                        
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS AND                                          
              GDG-KEY-IGDG  IN GDG = GDD-KEY-AGDD  IN GDD               
                MOVE 'M' TO SCR-IND-MGDD                                
      *<<<< GEN_BCI                                                     
                MOVE 'BGL'      TO MSG-COD-SIST                         
                MOVE 'GDGMDDIR' TO MSG-COD-MENS                         
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MEN2                           
      *>>>>                                                             
           ELSE                                                         
                MOVE SPACES TO SCR-IND-MGDD.                            
                                                                        
           IF FIO-STAT-OKS                                              
               MOVE 'GDD-KEY-AGDD' TO FIO-AKEY                          
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GDD.                                     
                                                                        
           MOVE GAR-CIC-DCLI IN CMA-VARI TO GDD-CIC-DCLI IN GDD.        
           MOVE GAR-KEY-AGDD IN CMA-VARI TO GDD-KEY-AGDD IN GDD.        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
                                                                        
       ANL-GDG.                                                         
       FIN-ANL-GDG.                                                     
                                                                        
                                                                        
           MOVE PGM-STAT-GDG TO FIO-STAT.                               
                                                                        
           IF SCR-CCPP = 'ACC' AND SCR-STPP = SCR-STAT-CON              
               GO TO FIN-FND-KEY.                                       
      *<<<< GEN_BCI                                                     
      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA                   
           IF SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON              
               GO TO FIN-VAL-OFI-USP-GDG.                               
           IF SCR-OFRM-SRV                                              
              GO TO FIN-VAL-OFI-USP-GDG.                                
                                                                        
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )        
               GO TO FIN-VAL-OFI-USP-GDG.                               
      *ALD-BCI-INI/07032000                                             
                                                                        
      **********************************                                
      *            MODULO  USPC143     *                                
      **********************************                                
       USP-CHEQUEO-TS.                                                  
           EXEC CICS HANDLE CONDITION                                   
                              QIDERR(USP-IR-MENU-GENERAL)               
           END-EXEC.                                                    
           EXEC CICS ASSIGN OPID(USP-OPID-USU)                          
           END-EXEC.                                                    
           MOVE EIBTRMID   TO USP-TERMINAL.                             
           EXEC CICS READQ TS QUEUE(USP-IDENTIFICACION)                 
                              INTO(USP-AREA-COMUN)                      
                              LENGTH(USP-LARGO-TS)                      
                              ITEM(+1)                                  
           END-EXEC.                                                    
           GO TO USP-INICIO-PROGRAMA.                                   
       USP-IR-MENU-GENERAL.                                             
           EXEC CICS XCTL PROGRAM('USDP930')                            
           END-EXEC.                                                    
       USP-INICIO-PROGRAMA.                                             
      ***************************************                           
      *            FIN  MODULO  USPC143     *                           
      ***************************************                           
      *                                                                 
           MOVE 'BGLGTUCG/CEN' TO USP-PTA-STR.                          
                                                                        
      ****************************************                          
      *             MODULO  USPC103          *                          
      ****************************************                          
           IF USP-PTA-STR = '*/*         ' THEN                         
            IF USP-USU-CMN-ARR(1) = '3' THEN                            
               MOVE 'P' TO USP-PERMISO                                  
            ELSE                                                        
               MOVE 'N' TO USP-PERMISO                                  
           ELSE                                                         
            IF USP-PTA-STR = '*/MAN       ' THEN                        
             IF USP-USU-CMN-ARR(1) NOT < '2' THEN                       
               MOVE 'P' TO USP-PERMISO                                  
             ELSE                                                       
               MOVE 'N' TO USP-PERMISO                                  
            ELSE                                                        
             IF USP-PTA-STR = '*/CON       ' THEN                       
              IF USP-USU-CMN-ARR(1) NOT < '1' THEN                      
                 MOVE 'P' TO USP-PERMISO                                
              ELSE                                                      
                 MOVE 'N' TO USP-PERMISO                                
             ELSE                                                       
              IF USP-PTA-STR = '*           ' THEN                      
                 MOVE USP-USU-CMN-ARR(2) TO USP-PERMISO                 
              ELSE                                                      
               IF USP-PTA-STR = '*/OFI       ' THEN                     
                 MOVE USP-USU-CMN-ARR(3) TO USP-PERMISO                 
               ELSE                                                     
                 MOVE 'S' TO USP-USA-VECTOR.                            
           IF USP-LLENA-VECTOR = 'S' OR USP-USA-VECTOR = 'S' THEN       
            IF  USP-PTA-NUM = ZEROS                                     
            THEN MOVE  USP-PTA-STR   TO   USP-COD-STR IN USP-E-STR01    
             MOVE  USP-PTA-STR   TO   USP-COD-STR IN REQ-AREA-STR       
             MOVE  USP-GRUPO     TO   USP-COD-GST IN USP-E-STR01        
             MOVE  USP-GRUPO     TO   USP-COD-GST IN REQ-AREA-STR       
             MOVE  'REDKY'       TO   COD-CMND-STR                      
             MOVE  'STR01'       TO   NOM-CLAV-STR  NOM-ELEM-STR        
             MOVE  'STR'         TO   NOM-TABL-STR                      
             CALL 'DBNTRY' USING UIB REQ-AREA-STR USP-E-STR01           
                                ELEM-LIST-STR                           
             IF RET-CODI-STR NOT = SPACES                               
                   MOVE  ' ' TO   USP-PERMISO                           
             ELSE                                                       
                   MOVE USP-COD-PTA IN USP-E-STR01 TO   USP-PTA-NUM     
                   EXEC CICS LINK PROGRAM ('USDR100')                   
                                COMMAREA (AREA-TRASPASO)                
                                LENGTH (166)                            
                   END-EXEC                                             
            ELSE                                                        
                   EXEC CICS LINK PROGRAM ('USDR100')                   
                                  COMMAREA (AREA-TRASPASO)              
                                  LENGTH (166)                          
                   END-EXEC.                                            
           MOVE  ZEROS  TO  USP-PTA-NUM.                                
           MOVE  SPACES TO  USP-PTA-STR.                                
           MOVE  SPACES TO  USP-USA-VECTOR.                             
      *                                                                 
      *                                                                 
      ****************************************                          
      *          FIN   MODULO  USPC103       *                          
      ****************************************                          
           IF USP-PERMISO = 'P'                                         
               GO TO FIN-VAL-OFI-USP-GDG.                               
      *    COPY USPC143.                                                
      *ALD-BCI-FIN/07032000                                             
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG                 
               MOVE 'USRNODEOFI' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
       FIN-VAL-OFI-USP-GDG.                                             
           MOVE PGM-STAT-GDG TO FIO-STAT.                               
      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA                   
      *>>>>                                                             
      * Garantia Alzada                                                 
           IF GDG-IND-EST1 IN GDG > '19'                                
               MOVE 'GDGALZ' TO MSG-COD-MENS                            
               GO TO ERR-FND-KEY.                                       
      *                                                                 
      *INI-AFRI/MAY-2005                                                
           IF SCR-CMND = 'ALC' AND GDG-CAI-GTIA IN GDG NOT = '0800'     
               MOVE 'CMNDALCINV' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-IND-EST1 IN GDG NOT = '05' AND                        
              SCR-CMND = 'ALC'                                          
               MOVE 'GDGNOALC' TO MSG-COD-MENS                          
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-IND-EST1 IN GDG = '07'                                
              IF NOT (SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON)     
                 MOVE 'GDG SOLO CON' TO MSG-COD-MENS                    
                 GO TO ERR-FND-KEY.                                     
      *FIN-AFRI/MAY-2005                                                
      *                                                                 
      * EVA-AFRI/MAYO2006                                               
           IF (SCR-CMND = 'AGA' OR SCR-CMND = 'ACE')                    
               MOVE SCR-STAT-SON TO SCR-STAT.                           
      * FIN-AFRI                                                        
           IF GDG-MSC-STAT IN GDG = 'E'                                 
               MOVE 'GDG   EXTING' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
      *                                                                 
      *<<<< GEN_BCI                                                     
      *MHM-INI 16-OCT-2003                                              
           IF SCR-CMND = 'EJE' AND GDG-COD-EST2 IN GDG = '10'           
               MOVE 'GDG    EJEYA' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-IND-GTAC IN GDG NOT = 'S' AND                         
              ( SCR-CMND = 'MOD' OR SCR-CMND = 'ELI' )                  
               MOVE FIO-STAT TO WSS-FIO-STAT-BKP                        
               MOVE GDG-CAI-GTIA IN GDG TO GSO-CAI-GTIA IN GSO          
               MOVE GDG-IIC-GTIA IN GDG TO GSO-IIC-GTIA IN GSO          
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GSO                                      
               IF FIO-STAT-OKS                                          
                   MOVE GSO-NUM-SBGL IN GSO TO GSL-NUM-SBGL IN GSL      
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM BGL-FIO-GSL                                  
                   IF FIO-STAT-OKS AND GSL-COD-ESOL IN GSL NOT < '05'   
                       MOVE 'GSLESOL>05' TO MSG-COD-MENS                
                       GO TO ERR-FND-KEY                                
                   ELSE                                                 
                       MOVE WSS-FIO-STAT-BKP TO FIO-STAT                
               ELSE                                                     
                   MOVE WSS-FIO-STAT-BKP TO FIO-STAT.                   
                                                                        
      *MHM-FIN 16-OCT-2003                                              
                                                                        
           IF GDG-MSC-STAT IN GDG = 'A' AND SCR-CMND = 'MGA'            
           OR GDG-MSC-STAT IN GDG = 'A' AND SCR-CMND = 'ALZ'            
           OR GDG-MSC-STAT IN GDG = 'A' AND SCR-CMND = 'EJE'            
                   GO TO FIN-FND-KEY.                                   
                                                                        
           IF GDG-MSC-STAT IN GDG = 'A'                                 
               MOVE 'GDG    AGAYA' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'MOD'            
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'AGA'            
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'ACE'            
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CCPP = 'ELI'            
      *INI-AFRI/MAY-2005                                                
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'ALC'            
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'MST'            
      *FIN-AFRI/MAY-2005                                                
                   GO TO FIN-FND-KEY.                                   
                                                                        
           IF GDG-MSC-STAT IN GDG = 'I'                                 
               MOVE 'GDG    NOAGA' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
      *>>>>                                                             
                                                                        
           IF GDG-MSC-STAT IN GDG = 'E'                                 
               MOVE 'GDG    EXTGD' TO MSG-COD-MENS                      
           ELSE                                                         
               MOVE 'GDG    NOEST' TO MSG-COD-MENS.                     
                                                                        
       ERR-FND-KEY.                                                     
           MOVE 'S' TO SCR-IERR.                                        
                                                                        
           IF WSS-IBUS = 0 AND WSS-IBUS-GDG = 0                         
      *        busco por padre y no encontro padre                      
               MOVE SPACES TO PGM-STAT                                  
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE '23' TO PGM-STAT-DBC                                
           ELSE                                                         
               MOVE 'BGL' TO MSG-COD-SIST.                              
                                                                        
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
                                                                        
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           MOVE '00' TO FIO-STAT.                                       
           IF FRM-FFLD = FRM-FFLD-PF6 OR                                
              FRM-FFLD = FRM-FFLD-PF5 OR                                
              SCR-CCPP = 'ING'                                          
               GO TO FIN-FND-KEY.                                       
                                                                        
           IF PGM-STAT-DBC-OKS                                          
      *        Despliega solo datos del DBC                             
                                                                        
               PERFORM SCR-CLRA-GDG                                     
               MOVE '23' TO FIO-STAT                                    
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PF8                                   
              OR FRM-FFLD-PF7                                           
               GO TO FIN-FND-KEY                                        
           ELSE                                                         
           IF PGM-STAT-GDG-OKS                                          
               MOVE PGM-SNUL TO PGM-STAT-GDG                            
               MOVE '23' TO FIO-STAT                                    
           ELSE                                                         
               MOVE '23' TO FIO-STAT.                                   
                                                                        
           MOVE 'S' TO SCR-IERR.                                        
           GO TO FIN-FND-KEY.                                           
      *>>>> EVP-FIN FINFNDKEY2                                          
*% END
*% IF INI_SCR_PUTA
      *<<<< INI_SCR_PUTA AND GEN_BCI                                    
      *LOP-INI 12-12-2002                                               
           IF WSS-IND-ALZA IN WSS-VARI = 'ALS'                          
              MOVE 'ALS' TO SCR-CMND.                                   
      *LOP-FIN 12-12-2002                                               
      *>>>>                                                             
*% END
*% IF SCR_GIKY
      *<<<< SCR_GIKY_VAL_IKY AND GEN_BCI                                
      *PTC-INI-MAN                                                      
           IF SCR-OFRM-SRV AND SCR-CMND = 'ING'                         
               MOVE 'BGL' TO FIO-SIST                                   
               MOVE 'VSN' TO TAB-COD-TTAB IN TAB                        
               MOVE '001' TO TAB-COD-CTAB IN TAB                        
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF NOT FIO-STAT-OKS OR                                   
                  TAB-IND-VIGE IN TAB NOT = 'S'                         
      *        FLB: version 'B'anco                                     
      *             MOVE 'B' TO SCR-IND-V001                            
                   MOVE SPACES TO MSG-COD-MENS                          
                   MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD     
      *AFRI-INI/MAYO2005                                                
                   IF SCR-HDR-MRCA = 'BCS'                              
                      MOVE '0800' TO GDG-CAI-GTIA IN GDG-FLD            
                   ELSE                                                 
                      MOVE '0500' TO GDG-CAI-GTIA IN GDG-FLD            
                   END-IF                                               
      *AFRI-FIN/MAYO2005                                                
                   MOVE 0  TO GDG-CAI-GTIA-LEN IN GDG-FLD               
                   MOVE -1 TO GDG-IIC-GTIA-LEN IN GDG-FLD.              
      *         ELSE                                                    
      *        FLB: version 'C'onsist                                   
      *             MOVE 'C' TO SCR-IND-V001.                           
                                                                        
      *PTC-FIN-MAN                                                      
      *>>>>                                                             
*% END
*% IF INI_HBL_KEY
      *<<<<
      *EVA-INI-AFRI/ENERO2006                                           
           IF SCR-CMND = 'MST'                                          
              MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-TIP-CGTA-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UBY TO GDG-STP-CGTA-ATR IN GDG-FLD          
              MOVE FRM-POS-CURS TO GDG-STP-CGTA-LEN IN GDG-FLD.         
      *EVA-FIN-AFRI/ENERO2006                                           
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY                                                 
           IF SCR-CCPP NOT = 'ING'                                      
      *<<<< FMT_CHI                                                     
               MOVE FRM-CPIM-AEY TO GDG-TIP-CGTA-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-TIP-CGTA-STP                    
               MOVE FRM-CPIM-AEY TO GDG-STP-CGTA-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-STP-CGTA-STP.                   
      *>>>>                                                             
      *JGM()                                                            
      *>>>>                                                             
*% END
*% IF FIN_HBL_FLD
      * EVA-INI-AFRI/ENERO2006                                          
           IF SCR-CMND = 'MST'                                          
              MOVE FRM-CPIM-AEY TO GDG-COD-RLCM-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-COD-RLUN-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-RLVR-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-COD-TGCM-ATR IN GDG-FLD          
      *EVA-AFRI/ABR2007                                                 
      *        MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN GDG-FLD         
              MOVE FRM-CPIM-AEY TO GDG-VRF-IPRO-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-IPRO-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-IPRO-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-NUM-IPRO-ATR IN GDG-FLD          
*% IF PGM_PQ
      *FIN-AFRI/ABR2007                                                 
              MOVE FRM-CPIM-UBY TO GDG-STP-CGTA-ATR IN GDG-FLD          
              MOVE FRM-POS-CURS TO GDG-STP-CGTA-LEN IN GDG-FLD.         
*% END
      * EVA-FIN-AFRI/ENERO2006                                          
                                                                        
      * JGM-ini codigo que se agrega del BM                             
           MOVE FRM-CPIM-AEY TO GDG-FEC-FALZ-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-FEC-FALZ-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-IND-EST1-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IND-EST1-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-COD-EST2-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-COD-EST2-STP.                       
                                                                        
      *GDG-IND-EST1 = 05, 19                                            
           IF SCR-CMND NOT = 'ING'  AND SCR-CMND NOT = 'MOD'            
      *MHM-INI 7-AUG-2003                                               
      *        MOVE FRM-CPIM-AEY TO GDG-IND-CLAS-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-IND-CLAS-STP                    
                                                                        
      *        MOVE FRM-CPIM-AEY TO GDG-VAL-MNTO-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-VAL-MNTO-STP                    
      *        MOVE FRM-CPIM-AEY TO GDG-COD-GORI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-COD-GORI-STP                    
                                                                        
      *        MOVE FRM-CPIM-AEY TO GDG-COD-RFCP-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-COD-RFCP-STP                    
      *MHM-FIN 7-AUG-2003                                               
                                                                        
              MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-STP                     
                                                                        
              MOVE FRM-CPIM-AEY TO GDG-IND-CBAN-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-CBAN-STP.                    
                                                                        
      *MHM-INI 13-AUG-2003                                              
           IF SCR-CMND = 'MGA'                                          
              MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD.         
      *MHM-FIN 13-AUG-2003                                              
      *MHM-INI 7-AUG-2003                                               
      *        MOVE FRM-CPIM-AEY TO GDG-COD-DESP-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-COD-DESP-STP.                   
           IF SCR-CMND NOT = 'ALZ'                                      
               MOVE FRM-CPIM-AEY TO GDG-COD-MALZ-ATR IN GDG-FLD.        
      *MHM-INI 21-AUG-2003                                              
      *     IF SCR-CMND = 'ING' OR SCR-CMND = 'MOD'                     
      *         MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD.       
      *MHM-FIN 21-AUG-2003                                              
           IF SCR-CMND NOT = 'MCA' AND SCR-CMND NOT = 'MGA'             
               MOVE FRM-CPIM-AEY TO GDG-IND-ECRS-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-COD-RERS-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVES-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-IND-ECRT-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-COD-RERT-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVET-ATR IN GDG-FLD.        
      *MHM-INI 21-AUG-2003                                              
      *     IF SCR-CMND = 'ING' OR SCR-CMND = 'MOD'                     
      *         MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD.       
      *MHM-FIN 7-AUG-2003                                               
      *<<<< NOT PGM_ARG                                                 
      *>>>>                                                             
           IF SCR-CCPP = 'ING'                                          
      *MHM-INI 16-OCT-2003                                              
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD         
      *MHM-FIN 16-OCT-2003                                              
               MOVE SPACES TO WSS-EST-ANT IN CMA-VARI                   
               MOVE SPACES TO WSS-ES2-ANT IN CMA-VARI                   
               PERFORM ANL-HBL-FEC-VTO                                  
               GO TO INI-FECHA-HOY.                                     
                                                                        
           IF SCR-CCPP = 'MOD'                                          
      *MHM-INI 12-NOV-2003                                              
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD         
      *MHM-FIN 12-NOV-2003                                              
               PERFORM ANL-HBL-DBC-ICLI                                 
               PERFORM ANL-HBL-FEC-VTO                                  
               IF SCR-CMND = 'MOD'                                      
      *           MOVE FRM-POS-CURS TO GDG-COD-OFIC-LEN IN GDG-FLD      
                  GO TO INI-FECHA-HOY.                                  
                                                                        
      *MHM-INI 21-AUG-2003                                              
      *     MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD.           
      *     MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-STP.                      
      *MHM-FIN 21-AUG-2003                                              
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-COD-LGTA-ATR  IN GDG-FLD.           
           MOVE FRM-CPIM-AEY TO GDG-COD-LGTA-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-FEC-FSOL-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-FEC-FSOL-STP.                       
                                                                        
      *<<<< FMT_CHI                                                     
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.            
      *>>>>                                                             
                                                                        
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-STP.                       
                                                                        
      *                                                                 
      *------------------------------------------------*                
           IF SCR-CMND = 'MGA'                                          
      *RRM-INI                                                          
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-STP                    
              MOVE FRM-POS-CURS TO GDG-GLS-DGTA-LEN IN GDG-FLD          
                                                                        
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-STP                     
      *                                                                 
                                                                        
      *<<<< FMT_CHI                                                     
      *MHM-INI 13-OCT-2003                                              
      *        MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD         
      *MHM-FIN 13-OCT-2003                                              
      *>>>>                                                             
      *                                                                 
      *MHM-INI 13-OCT-2003                                              
      *        MOVE FRM-CPIM-AEY  TO FRM-GLS-NOMC-ATR IN GDG-FLD        
      *        MOVE FRM-CPIM-AEY  TO FRM-GLS-NOMC-STP                   
      *MHM-FIN 13-OCT-2003                                              
      *                                                                 
              GO TO ANL-HBL-FECHA-HOY.                                  
      *--------------------------------------------------*              
*% IF PGM_PU
           IF (SCR-CMND = 'AGA' OR SCR-CMND = 'ACE')                    
               MOVE FRM-POS-CURS TO GDG-GLS-MENS-LEN IN GDG-FLD         
              GO TO ANL-HBL-FECHA-HOY.                                  
*% END
*% IF PGM_PQ
      * EVA-AFRI/MAYO2006                                               
           IF SCR-CMND = 'AGA' OR SCR-CMND = 'ACE'                      
               MOVE FRM-POS-CURS TO GDG-GLS-MENS-LEN IN GDG-FLD         
              GO TO ANL-HBL-FECHA-HOY.                                  
      * FIN-AFRI                                                        
*% END
      *--------------------------------------------------*              
           IF SCR-CMND NOT = 'ALZ' AND                                  
                       NOT = 'EJE' AND                                  
                       NOT = 'CAN' AND                                  
                       NOT = 'CAD'                                      
              GO TO ANL-HBL-FECHA-HOY.                                  
      *------------------------------------------------*                
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-STP.                       
                                                                        
      *MHM-INI 21-AUG-2003                                              
      *     MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD.           
      *     MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-STP.                      
      *MHM-FIN 21-AUG-2003                                              
*% IF PGM_PU
      *EVA-AFRI/ABR2007                                                 
      *     MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN GDG-FLD.           
      *     MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD.           
      *     MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD.           
      *     MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD.           
      *FIN-AFRI/ABR2007                                                 
*% END
                                                                        
      *<<<< FMT_CHI                                                     
           MOVE FRM-CPIM-AEY TO GDG-NUM-IPRO-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-VRF-IPRO-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IND-IPRO-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-GLS-IPRO-ATR IN GDG-FLD.            
      *>>>>                                                             
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IND-INOB-STP.

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-ALZ
               PERFORM GET-FHOY
               MOVE HOY-SHOY TO GDG-NUM-SALZ IN GDG-FLD
               MOVE HOY-AHOY TO GDG-NUM-AALZ IN GDG-FLD
               MOVE HOY-MHOY TO GDG-NUM-MALZ IN GDG-FLD
               MOVE HOY-DHOY TO GDG-NUM-DALZ IN GDG-FLD.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = 'ALZ' OR = 'CAN' OR SCR-CMND = 'CAD'           
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              IF SCR-CMND = WSS-CTE-ALZ
                   MOVE FRM-CPIM-UBY TO GDG-IND-EST1-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UST TO GDG-IND-EST1-STP
                  GO TO ANL-HBL-FECHA-HOY
              ELSE
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2                       
              MOVE FRM-CPIM-UBY TO GDG-FEC-FALZ-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UST TO GDG-FEC-FALZ-STP                     
                                                                        
              MOVE FRM-CPIM-UBY TO GDG-IND-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UST TO GDG-IND-EST1-STP                     
              GO TO ANL-HBL-FECHA-HOY.                                  
                                                                        
           IF SCR-CMND = 'EJE'                                          
              MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UST TO GDG-COD-EST2-STP                     
                                                                        
      *MHM-INI 14-OCT-2003                                              
      *        MOVE FRM-CPIM-UBY TO GDG-FEC-FALZ-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-UST TO GDG-FEC-FALZ-STP                    
      *MHM-FIN 14-OCT-2003                                              
                                                                        
              MOVE FRM-CPIM-UBY TO GDG-IND-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UST TO GDG-IND-EST1-STP.                    
                                                                        
       ANL-HBL-FECHA-HOY.                                               
           GO TO INI-FECHA-HOY.                                         
                                                                        
                                                                        
       ANL-HBL-DBC-ICLI.                                                
           IF MULTIPLES-GDD                                             
      *<<<< FMT_CHI                                                     
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD         
      *>>>>                                                             
                                                                        
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-STP.                   
       ANL-HBL-COD-GRA.                                                 
       ANL-HBL-FEC-VTO.                                                 
           IF GAR-IND-SVTO IN CMA-VARI = 'N'                            
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-STP                    
                                                                        
               IF SCR-CCPP = 'ING'                                      
                   MOVE ZEROES TO GDG-NUM-SVTO IN GDG-FLD               
                   MOVE ZEROES TO GDG-NUM-AVTO IN GDG-FLD               
                   MOVE ZEROES TO GDG-NUM-MVTO IN GDG-FLD               
                   MOVE ZEROES TO GDG-NUM-DVTO IN GDG-FLD.              
                                                                        
      *RRM-INI 3-JUL-2002                                               
           IF SCR-CCPP = 'MOD' AND SCR-OFRM-SRV                         
               MOVE FRM-CPIM-UBY TO GDG-FEC-FVTO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UST TO GDG-FEC-FVTO-STP.                   
      *RRM-FIN 3-JUL-2002                                               
                                                                        
      *                                                                 
        INI-FECHA-HOY.                                                  
           IF SCR-CCPP =  'ING'                                         
               PERFORM GET-FHOY                                         
               MOVE HOY-FHOY TO GDG-FEC-FING IN GDG                     
               MOVE GDG-NUM-SING IN GDG TO GDG-NUM-SING IN GDG-FLD      
               MOVE GDG-NUM-AING IN GDG TO GDG-NUM-AING IN GDG-FLD      
               MOVE GDG-NUM-MING IN GDG TO GDG-NUM-MING IN GDG-FLD      
               MOVE GDG-NUM-DING IN GDG TO GDG-NUM-DING IN GDG-FLD.     
      *                                                                 
      *fin-JGM.                                                         
      *>>>>                                                            
*% END 
*% IF EOF_PQ
      *<<<<
      *<<<< LDC_SI AND PGM_MVS AND EOF                                  
       MSG-PF10 SECTION.                                                
       INI-MSG-PF10.                                                    
           MOVE 'DEU' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MEN2.                               
           MOVE FRM-MEN2     TO GDG-GLS-MEN2 IN GDG-FLD.                
       FIN-MSG-PF10.                                                    
           EXIT.                                                        
                                                                        
       HBL-KEY-GDG SECTION.                                             
       INI-HBL-KEY-GDG.                                                 
           MOVE SCR-INST-GKY TO SCR-INST.                               
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-STP.                       
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
      * EN MTX DEBE CAPTURAR LLAVES DE USUARIO EN PANTALLA              
           IF SCR-OFRM-SRV                                              
               MOVE SCR-NMAP TO FRM-NAME                                
               MOVE SCR-NLIB TO FRM-NLIB                                
               MOVE FRM-GET-ALL TO FRM-CMND                             
               PERFORM GNS-PRO-FRM                                      
               MOVE FRM-DFLD TO GDG-FLD                                 
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG                                  
           ELSE                                                         
      *>>>> ISP-INI  24-JAN-1996 11:35:48                               
      *>>>>                                                             
                                                                        
           PERFORM SCR-CLRA-GDG.                                        
                                                                        
      *                                                                 
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.                        
                                                                        
           MOVE SCR-CAI-IGAR IN SCR-VARI TO GDG-CAI-GTIA IN GDG-FLD.    
           MOVE SCR-IIC-IGAR IN SCR-VARI TO GDG-IIC-GTIA IN GDG-FLD.    
                                                                        
           MOVE +4           TO GDG-CAI-GTIA-LEN IN GDG-FLD.            
      *<<<< FMT_CHI                                                     
           MOVE FRM-POS-CURS TO GDG-TIP-CGTA-LEN IN GDG-FLD.            
      *>>>>                                                             
                                                                        
      *                                                                 
           PERFORM EDT-KEY-GDG.                                         
           PERFORM EDT-FLD-GDG.                                         
           MOVE 'F10GDGNINFIA' TO MSG-COD-MENS.                         
           PERFORM MSG-PF10.                                            
                                                                        
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
      * BAJO MTX DEBE REGRABAR PANTALLA Y LLAMAR A SCR-ING              
                                                                        
           IF SCR-OFRM-SRV                                              
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'                
                                                                        
               MOVE GDG-FLD TO FRM-DFLD                                 
                                                                        
      * INI - COPY - GNSBGFRM                                           
               MOVE SCR-OTRN TO QUE-TERM                                
               MOVE 'TSI'    TO QUE-TYPE                                
               MOVE 1        TO QUE-NITM                                
               MOVE +2014    TO QUE-LITM                                
               MOVE QUE-DEL  TO QUE-CMND                                
               PERFORM GNS-PRO-QUE                                      
               MOVE SCR-OTRN TO QUE-TERM                                
               MOVE 'TSI'    TO QUE-TYPE                                
               MOVE 1        TO QUE-NITM                                
               MOVE +2014    TO QUE-LITM                                
               MOVE FRM-DFLD TO FRM-AUXI                                
      * NO DEBE GRABAR TSI EN FORMATO MTX, SI NO QUE EN FORMATO         
      * PROGRAMA. ESTE PROGRAMA RELEERA TSI SIN PASAR POR MTX           
      *         MOVE MSG-COD-MENS TO FRM-COD-MENS                       
      *         MOVE FRM-MENS     TO FRM-GLS-MENS                       
      *         MOVE FRM-AUXI     TO FRM-DATA                           
      *         MOVE FRM-NAME TO FRM-NAME-IDEN                          
               MOVE FRM-DFLD TO QUE-DATA                                
               MOVE QUE-PUT  TO QUE-CMND                                
               PERFORM GNS-PRO-QUE                                      
      * FIN - COPY - GNSBGFRM                                           
                                                                        
               PERFORM SCR-ING.                                         
                                                                        
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
      *>>>>                                                             
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'                
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)      
               PERFORM SCR-INIT                                         
               PERFORM SCR-EXIT                                         
           ELSE                                                         
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
                EXEC CICS                                               
                 RETURN                                                 
                END-EXEC.                                               
      *<<<< ISP-FIN  24-JAN-1996 11:35:48                               
      *>>>>                                                             
               PERFORM SCR-PUTA.                                        
       FIN-HBL-KEY-CLF.                                                 
           EXIT.                                                        
                                                                        
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS                       
       ING-FPEN-CIC SECTION.                                            
       INI-ING-FPEN-CIC.                                                
           PERFORM ING-SETE.                                            
           PERFORM SCR-CLRA-GDG.                                        
           MOVE SCR-MENS-EXT TO GDG-GLS-MENS.                           
           PERFORM HBL-IKY.                                             
       FIN-ING-FPEN-CIC.                                                
           EXIT.                                                        
                                                                        
       ING-SETE SECTION.                                                
       INI-ING-SETE.                                                    
           PERFORM CRG-TBL-ENG.                                         
           MOVE WSS-NTRN(SCR-IPRO)     TO SCR-NTRN.                     
           MOVE WSS-PROG(SCR-IPRO)     TO SCR-PROG.                     
           MOVE WSS-NMAP(SCR-IPRO)     TO SCR-NMAP.                     
           MOVE WSS-NLIB(SCR-IPRO)     TO SCR-NLIB.                     
                                                                        
           MOVE WSS-NTRV(SCR-IPRO)     TO SCR-NTRV.                     
           MOVE WSS-PROV(SCR-IPRO)     TO SCR-PROV.                     
       FIN-ING-SETE.                                                    
           EXIT.                                                        
                                                                        
       EGR-FPEN-CIC SECTION.                                            
       INI-EGR-FPEN-CIC.                                                
           PERFORM CRG-TBL-ENG.                                         
           ADD 1 TO SCR-IPRO.                                           
           IF SCR-IPRO > WSS-TOT-IIDX                                   
                  PERFORM EGR-FTER-CIC                                  
                  GO TO FIN-EGR-FPEN-CIC.                               
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES             
               GO TO INI-EGR-FPEN-CIC.                                  
                                                                        
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.                      
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.                         
           MOVE SCR-VARI TO SYS-CMMA.                                   
           MOVE SCR-TCMA TO SYS-TCMA.                                   
           MOVE SYS-XCTL TO SYS-CMND.                                   
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
               MOVE WSS-IDX-IGDG TO SCR-IPRO                            
           ELSE                                                         
      *>>>> ISP-FIN  24-JAN-1996 11:35:48                               
      *>>>>                                                             
           PERFORM GNS-PRO-SYS.                                         
       FIN-EGR-FPEN-CIC.                                                
           EXIT.                                                        
                                                                        
       EGR-FTER-CIC SECTION.                                            
       INI-EGR-FTER-CIC.                                                
           PERFORM CRG-TBL-ENG.                                         
           MOVE WSS-IDX-ILDC TO SCR-IPRO.                               
           MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO).            
           MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO).            
                                                                        
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.                      
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.                         
                                                                        
           MOVE SCR-VARI TO SYS-CMMA.                                   
           MOVE SCR-TCMA TO SYS-TCMA.                                   
           MOVE SYS-XCTL TO SYS-CMND.                                   
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
               MOVE WSS-IDX-IGDG TO SCR-IPRO                            
           ELSE                                                         
      *>>>> ISP-FIN  24-JAN-1996 11:35:48                               
      *>>>>                                                             
           PERFORM GNS-PRO-SYS.                                         
       FIN-EGR-FTER-CIC.                                                
           EXIT.                                                        
                                                                        
       SCR-INIT SECTION.                                                
       INI-SCR-INIT.                                                    
           MOVE 3  TO FRM-PLIN.                                         
           MOVE 19 TO FRM-NLIN.                                         
           MOVE FRM-CLR-FRM TO FRM-CMND.                                
           PERFORM GNS-PRO-FRM.                                         
           MOVE FRM-SINI-DBNF TO FRM-SINI.                              
           MOVE SCR-NMAP TO FRM-NAME.                                   
           MOVE SCR-NLIB TO FRM-NLIB.                                   
           MOVE GDG-FLD TO FRM-DFLD.                                    
           MOVE FRM-INI TO FRM-CMND.                                    
           PERFORM GNS-PRO-FRM.                                         
       FIN-SCR-INIT.                                                    
           EXIT.                                                        
                                                                        
       COPY LDCBGMPT.                                                   
                                                                        
      *>>>>                                                             
      *<<<< EOF                                                         
       RST-STAT SECTION.                                                
       INI-RST-STAT.                                                    
           MOVE SCR-STPP     TO SCR-STAT.                               
           MOVE SCR-MFLD-NOT TO SCR-MFLD.                               
       FIN-RST-STAT.                                                    
           EXIT.                                                        
                                                                        
      *<<<< EOF                                                         
      *Buscar tabla en garantia el CIC.                                 
       BUS-CIC-GAR SECTION.                                             
       INI-BUS-CIC-GAR.                                                 
      *BUS-TAB Busca codigo de tabla                                    
           MOVE 'BGL'     TO TAB-COD-SIST.                              
           MOVE 'CIC'     TO TAB-COD-TTAB IN TAB.                       
           MOVE 'PROCIC'  TO TAB-COD-CTAB IN TAB.                       
                                                                        
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
              MOVE TAB-GLS-DAT1 IN TAB TO GAR-CIC-OFIC IN CMA-VARI      
           ELSE                                                         
               MOVE SPACES TO GAR-CIC-OFIC IN CMA-VARI.                 
       FIN-BUS-CIC-GAR.                                                 
           EXIT.                                                        
                                                                        
      *<<<< EOFPQPU                                                     
                                                                        
       GET-GDD SECTION.                                                 
       INI-GET-GDD.                                                     
           MOVE DBC-KEY-IDBC IN DBC     TO GDD-CIC-DCLI IN GDD.         
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDD-CAI-GTIA IN GDD.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDD-IIC-GTIA IN GDD.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS AND                                          
              GDD-CIC-DCLI IN GDD = DBC-KEY-IDBC IN DBC                 
               MOVE GDD-KEY-AGDD IN GDD TO GDG-KEY-IGDG IN GDG          
               MOVE 2 TO WSS-IBUS                                       
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GDG                                      
               IF FIO-STAT-OKS                                          
                   MOVE 3 TO WSS-IBUS.                                  
       FIN-GET-GDD.                                                     
           EXIT.                                                        
                                                                        
       GET-CUR-GDD SECTION.                                             
       INI-GET-CUR-GDD.                                                 
           MOVE GDG-KEY-IGDG IN GDG TO GDD-KEY-AGDD IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS                                              
               MOVE 'GDD-KEY-AGDD' TO FIO-AKEY                          
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GDD.                                     
           IF NOT                                                       
              GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD                 
               MOVE '23' TO FIO-STAT.                                   
       FIN-GET-CUR-GDD.                                                 
           EXIT.                                                        
       GET-CUR-GDD-MUL SECTION.                                         
       INI-GET-CUR-GDD-MUL.                                             
           MOVE SPACES   TO WSS-IND-CMUL IN CMA-VARI.                   
           MOVE GDG-KEY-IGDG IN GDG TO GDD-KEY-AGDD IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
      *                                                                 
           IF FIO-STAT-OKS   AND                                        
              GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD                 
                MOVE 'GDD-KEY-AGDD' TO FIO-AKEY                         
                MOVE FIO-GET-NXT TO FIO-CMND                            
                PERFORM BGL-FIO-GDD                                     
                IF FIO-STAT-OKS AND                                     
                   GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD            
                   MOVE 'M' TO WSS-IND-CMUL.                            
                                                                        
       FIN-GET-CUR-GDD-MUL.                                             
           EXIT.                                                        
                                                                        
       COPY SGCBFDBC.                                                   
       COPY BGLBFGDD.                                                   
       COPY SGCBGCLI.                                                   
      *<<<< PGM_MEX OR GEN_BCI                                          
       COPY BGLBFGSL.                                                   
       COPY BGLBFGSO.                                                   
      *>>>>                                                             
      *<<<< PGM_PU OR NOT NO_CIC_PQ                                     
       COPY GNSBFCIC.                                                   
      *>>>>                                                             
      *<<<< UNS_FLD                                                     
       COPY GNSBGCPT.                                                   
       COPY GNSBGSTR.                                                   
      *>>>>                                                             
      *>>>>                                                             
      *<<<< EOF AND PGM_PQ                                              
      *<<<< EOFPQ                                                       
       LEE-NXT-PRV-XGDD SECTION.                                        
       INI-LEE-NXT-PRV-XGDD.                                            
           MOVE GAR-KEY-IGDD IN CMA-VARI TO GDD-KEY-IGDD IN GDD.        
           IF FRM-FFLD = FRM-FFLD-PF5                                   
      *<<<< NOT PGM_VMS                                                 
               MOVE FIO-GET-LEQ TO FIO-CMND                             
      *>>>>                                                             
               PERFORM BGL-FIO-GDD                                      
               MOVE FIO-GET-PRV TO FIO-CMND                             
           ELSE                                                         
               MOVE FIO-GET-NLS TO FIO-CMND                             
               PERFORM BGL-FIO-GDD                                      
               MOVE FIO-GET-NXT TO FIO-CMND.                            
                                                                        
           PERFORM BGL-FIO-GDD.                                         
           MOVE FIO-STAT TO PGM-STAT-GDD.                               
           IF FIO-STAT-OKS                                              
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GDD.                                     
           IF PGM-STAT-GDD-OKS AND                                      
              GDD-CIC-DCLI IN GDD = DBC-KEY-IDBC IN CMA-VARI            
               MOVE GDD-KEY-AGDD IN GDD TO GDG-KEY-IGDG IN GDG          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GDG                                      
               IF FIO-STAT-OKS                                          
                   MOVE 3 TO WSS-IBUS                                   
                   MOVE GDG-CAI-GTIA IN GDG TO GDG-CAI-GTIA IN GDG-FLD  
                   MOVE GDG-IIC-GTIA IN GDG TO GDG-IIC-GTIA IN GDG-FLD  
               ELSE                                                     
                   MOVE 'DAT ERR' TO MSG-COD-MENS                       
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
           ELSE                                                         
               MOVE '23' TO FIO-STAT.                                   
                                                                        
       FIN-LEE-NXT-PRV-XGDD.                                            
           EXIT.                                                        
                                                                        
       LEE-NXT-PRV-XDBC SECTION.                                        
       INI-LEE-NXT-PRV-XDBC.                                            
           MOVE DBC-KEY-IDBC IN CMA-VARI TO DBC-KEY-IDBC IN DBC.        
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM SGC-FIO-DBC.                                         
           IF CMA-IND-KPAD IN CMA-VARI = 'I'                            
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
           ELSE                                                         
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.                        
                                                                        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
      * BUSCA POR LLAVE SECUNDARIA EL REGISTRO DE PANTALLA ANTERIOR     
           PERFORM BUS-DBC-ANT UNTIL                                    
                FIO-STAT-OKS AND                                        
                DBC-KEY-IDBC IN DBC = DBC-KEY-IDBC IN CMA-VARI OR       
                NOT FIO-STAT-OKS.                                       
                                                                        
           MOVE 0 TO WSS-IBUS.                                          
           MOVE '23' TO PGM-STAT-DBC.                                   
           IF FIO-STAT-OKS                                              
               PERFORM LEE-NXT-PRV-DBC                                  
               IF FRM-FFLD = FRM-FFLD-PF7                               
                   MOVE 'BGL'      TO FIO-SIST                          
                   MOVE 'VSN '     TO TAB-COD-TTAB IN TAB               
      *<<<< NOT PGM_ARG                                                 
                   MOVE 'SISVSI'   TO TAB-COD-CTAB IN TAB               
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM GNS-FIO-TAB                                  
                   IF FIO-STAT-OKS AND                                  
                      TAB-IND-VIGE IN TAB = 'S'                         
                       MOVE 0 TO WSS-IBUS                               
                       MOVE '23' TO PGM-STAT-DBC                        
                       PERFORM LEE-NXT-PRV-DBC.                         
      *>>>>                                                             
       FIN-LEE-NXT-PRV-XDBC.                                            
           EXIT.                                                        
       BUS-DBC-ANT SECTION.                                             
       INI-BUS-DBC-ANT.                                                 
           IF CMA-IND-KPAD IN CMA-VARI = 'I'                            
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
           ELSE                                                         
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
       FIN-BUS-DBC-ANT.                                                 
           EXIT.                                                        
                                                                        
       LEE-NXT-PRV-DBC SECTION.                                         
       INI-LEE-NXT-PRV-DBC.                                             
           IF FRM-FFLD = FRM-FFLD-PF7                                   
               MOVE FIO-GET-PRV TO FIO-CMND                             
           ELSE                                                         
               MOVE FIO-GET-NXT TO FIO-CMND.                            
           IF CMA-IND-KPAD IN CMA-VARI = 'I'                            
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
           ELSE                                                         
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.                        
           PERFORM SGC-FIO-DBC.                                         
           MOVE FIO-STAT TO PGM-STAT-DBC.                               
           IF FIO-STAT-OKS                                              
               MOVE 1 TO WSS-IBUS.                                      
       FIN-LEE-NXT-PRV-DBC.                                             
           EXIT.                                                        
       BUS-ULT-GDG SECTION.                                             
       INI-BUS-ULT-GDG.                                                 
      *<<<< PGM_DTC OR PGM_DB2                                          
           MOVE DBC-KEY-IDBC IN DBC TO GDD-CIC-DCLI IN GDD.             
      *    se busca el ultimo hijo, luego de encontrar el padre         
           MOVE '999999999999' TO GDD-KEY-AGDD IN GDD.                  
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
      *>>>>                                                             
      *<<<< NOT PGM_VSI                                                 
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS AND                                          
              GDD-CIC-DCLI IN GDD = DBC-KEY-IDBC IN DBC                 
               MOVE GDD-KEY-AGDD IN GDD TO GDG-KEY-IGDG IN GDG          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GDG                                      
               IF FIO-STAT-OKS                                          
                   MOVE 3 TO WSS-IBUS                                   
                   MOVE GDG-CAI-GTIA IN GDG TO GDG-CAI-GTIA IN GDG-FLD  
                   MOVE GDG-IIC-GTIA IN GDG TO GDG-IIC-GTIA IN GDG-FLD. 
      *>>>>                                                             
       FIN-BUS-ULT-GDG.                                                 
           EXIT.                                                        
      *>>>>                                                             
                                                                        
      *>>>>                                                             
                                                                        
      *<<<< EOF                                                         
      *<<<< GEN_BCI                                                     
       COPY BGLBGEDP.                                                   
                                                                        
       COPY DAPBFRCC.                                                   
      *>>>>                                                             
       COPY BGLBFTAG.                                                   
                                                                        
      *RRM-INI 3-JUN-2002                                               
       LECTURA-TAG SECTION.                                             
       INI-LECTURA-TAG.                                                 
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GDG  TO WSS-TIP-CGTA IN WSS-VARI.       
           MOVE GDG-STP-CGTA IN GDG  TO WSS-STP-CGTA IN WSS-VARI.       
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAG-COD-AGTA IN TAG.        
      *>>>>                                                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM BGL-FIO-TAG.                                         
       FIN-LECTURA-TAG.                                                 
           EXIT.                                                        
                                                                        
      *<<<< GEN_BCI                                                     
       BUS-GDO-OPD SECTION.                                             
       INI-BUS-GDO-OPD.                                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDO-CAI-GTIA IN GDO.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDO-IIC-GTIA IN GDO.         
           MOVE 1                       TO GDO-NUM-IGDO IN GDO.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'          TO MSG-COD-SIST                      
               MOVE 'GDO    NEX'   TO MSG-COD-MENS                      
           ELSE                                                         
               MOVE GDO-COD-DOCU IN GDO TO OPD-CIC-IOPD IN DAP-VARI     
               MOVE OPD-CAI-IOPD IN DAP-VARI TO OPD-CAI-IOPD IN OPD     
               MOVE OPD-IIC-IOPD IN DAP-VARI TO OPD-IIC-IOPD IN OPD     
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM DAP-FIO-OPD                                      
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'BGL'          TO MSG-COD-SIST                  
                   MOVE 'OPD    NEX'   TO MSG-COD-MENS                  
               ELSE                                                     
               IF OPD-COD-STAT IN OPD NOT = 'G'                         
                   MOVE 'BGL'            TO MSG-COD-SIST                
                   MOVE 'OPD    NOVIG'   TO MSG-COD-MENS.               
       FIN-BUS-GDO-OPD.                                                 
           EXIT.                                                        
      *>>>>                                                             
                                                                        
       VRF-MOD-GSO SECTION.                                             
       INI-VRF-MOD-GSO.                                                 
           IF NOT ( FIO-STAT-OKS AND                                    
              GDG-CAI-GTIA IN GDG-FLD = GES-CAI-GTIA IN GES AND         
              GDG-IIC-GTIA IN GDG-FLD = GES-IIC-GTIA IN GES)            
               MOVE '00' TO FIO-STAT                                    
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE GDG-CIC-GTIA IN GDG TO GSO-CIC-GTIA IN GSO.             
           MOVE GES-KEY-IGSL IN GES TO GSO-NUM-SBGL IN GSO.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSO    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSO  NOUPD' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE '11' TO GSO-COD-ESGA IN GSO.                            
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSO  NOMOD' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM BGL-FIO-GES.                                         
           GO TO INI-VRF-MOD-GSO.                                       
       FIN-VRF-MOD-GSO.                                                 
           EXIT.                                                        
                                                                        
                                                                        
       VRF-IND-TAG SECTION.                                             
       INI-VRF-IND-TAG.                                                 
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GDG  TO WSS-TIP-CGTA IN WSS-VARI.       
           MOVE GDG-STP-CGTA IN GDG  TO WSS-STP-CGTA IN WSS-VARI.       
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAG-COD-AGTA IN TAG.        
      *>>>>                                                             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'TAG    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-IND-TAG.                                   
                                                                        
           IF NOT ( TAG-IND-EGSL IN TAG = 'S' AND TAG-IND-EGSO = 'S' )  
               GO TO FIN-VRF-IND-TAG.                                   
                                                                        
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GES-CAI-GTIA IN GES.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GES-IIC-GTIA IN GES.         
           MOVE ZEROES                  TO GES-NUM-IGES IN GES.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GES.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GDG-CAI-GTIA IN GDG-FLD = GES-CAI-GTIA IN GES AND         
              GDG-IIC-GTIA IN GDG-FLD = GES-IIC-GTIA IN GES)            
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GES    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-IND-TAG                                    
           ELSE                                                         
               PERFORM VRF-MOD-GSO.                                     
                                                                        
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-VRF-IND-TAG.                                   
       FIN-VRF-IND-TAG.                                                 
           EXIT.                                                        
      *RRM-FIN 3-JUN-2002                                               
      *RRM-INI 4-JUL-2002                                               
       VAL-CIM-AGA SECTION.                                             
       INI-VAL-CIM-AGA.                                                 
           PERFORM VAL-GDG-FEC-FVTO-CIM.                                
           PERFORM VAL-GDG-IND-CBAN-CIM.                                
           PERFORM VAL-GDG-IDC-IPRO-CIM.                                
           PERFORM VAL-DBC-GLS-NOMC-CIM.                                
       FIN-VAL-CIM-AGA.                                                 
           EXIT.                                                        
                                                                        
       VAL-GDG-FEC-FVTO-CIM SECTION.                                    
       INI-VAL-GDG-FEC-FVTO-CIM.                                        
      *VAL-FEC Validar Fecha                                            
           MOVE GDG-FEC-FVTO IN GDG TO FEC-FECH.                        
           MOVE FEC-FORM-FEC        TO FEC-FORM.                        
           MOVE FEC-FBLK-S          TO FEC-FBLK.                        
           MOVE FEC-CHOY-LE         TO FEC-CHOY.                        
           MOVE FEC-VHBL-S          TO FEC-VHBL.                        
           MOVE FEC-VHBL-N          TO FEC-VHBL.                        
                                                                        
           MOVE GDG-NUM-SVTO IN GDG TO FEC-SVLD.                        
           MOVE GDG-NUM-AVTO IN GDG TO FEC-AVLD.                        
           MOVE GDG-NUM-MVTO IN GDG TO FEC-MVLD.                        
           MOVE GDG-NUM-DVTO IN GDG TO FEC-DVLD.                        
                                                                        
           MOVE TAG-IND-SVTO IN TAG TO GAR-IND-SVTO IN CMA-VARI.        
                                                                        
           IF GAR-IND-SVTO IN CMA-VARI  = 'S'                           
              IF FEC-FVLD = '00000000'                                  
                 MOVE 'VTO=0' TO MSG-COD-MENS                           
                 GO TO ERR-VAL-GDG-FEC-FVTO-CIM.                        
                                                                        
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           MOVE FEC-VAL-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
           IF  NOT FEC-STAT-OKS                                         
               MOVE 'FVEN  NOVAL' TO MSG-COD-MENS                       
               GO TO FIN-VAL-GDG-FEC-FVTO-CIM.                          
                                                                        
                                                                        
           MOVE GDG-NUM-SSOL IN GDG TO FEC-SEC1.                        
           MOVE GDG-NUM-ASOL IN GDG TO FEC-AEC1.                        
           MOVE GDG-NUM-MSOL IN GDG TO FEC-MEC1.                        
           MOVE GDG-NUM-DSOL IN GDG TO FEC-DEC1.                        
                                                                        
           MOVE GDG-NUM-SVTO IN GDG TO FEC-SEC2.                        
           MOVE GDG-NUM-AVTO IN GDG TO FEC-AEC2.                        
           MOVE GDG-NUM-MVTO IN GDG TO FEC-MEC2.                        
           MOVE GDG-NUM-DVTO IN GDG TO FEC-DEC2.                        
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-CMP-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-LES                                          
               MOVE 'VTO<=SOL' TO MSG-COD-MENS                          
               GO TO ERR-VAL-GDG-FEC-FVTO-CIM.                          
                                                                        
           MOVE GDG-FEC-FVTO IN GDG TO FEC-FEC1.                        
                                                                        
           MOVE GDG-NUM-DING IN GDG TO FEC-DEC2.                        
           MOVE GDG-NUM-MING IN GDG TO FEC-MEC2.                        
           MOVE GDG-NUM-AING IN GDG TO FEC-AEC2.                        
           MOVE GDG-NUM-SING IN GDG TO FEC-SEC2.                        
           MOVE FEC-FORM-FEC        TO FEC-FORM.                        
           MOVE FEC-CMP-FEC         TO FEC-CMND.                        
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-GRT                                          
               MOVE 'FVTO<=FING' TO MSG-COD-MENS                        
               GO TO ERR-VAL-GDG-FEC-FVTO-CIM.                          
                                                                        
           GO TO FIN-VAL-GDG-FEC-FVTO-CIM.                              
                                                                        
       ERR-VAL-GDG-FEC-FVTO-CIM.                                        
           MOVE 'BGL'     TO MSG-COD-SIST.                              
       FIN-VAL-GDG-FEC-FVTO-CIM.                                        
           EXIT.                                                        
                                                                        
                                                                        
       VAL-GDG-VAL-MNTO-CIM SECTION.                                    
       INI-VAL-GDG-VAL-MNTO-CIM.                                        
           IF GDG-VAL-MNTO IN GDG = ZEROES                              
               MOVE 'BGL'       TO MSG-COD-SIST                         
               MOVE 'MNTO=0' TO MSG-COD-MENS                            
               GO TO FIN-VAL-GDG-VAL-MNTO-CIM.                          
       FIN-VAL-GDG-VAL-MNTO-CIM.                                        
           EXIT.                                                        
                                                                        
       VAL-GDG-IND-CBAN-CIM SECTION.                                    
       INI-VAL-GDG-IND-CBAN-CIM.                                        
           IF  GDG-IND-CBAN IN GDG NOT = 'N' AND NOT = 'S'              
                MOVE 'BGL'         TO MSG-COD-SIST                      
                MOVE 'ICBAN   N/S' TO MSG-COD-MENS                      
                GO TO FIN-VAL-GDG-IND-CBAN-CIM.                         
       FIN-VAL-GDG-IND-CBAN-CIM.                                        
           EXIT.                                                        
                                                                        
      * EVA-AFRI/2007                                                   
                                                                        
      * VAL-FRM-IDC-ICLI-CIM SECTION.                                   
      * INI-VAL-FRM-IDC-ICLI-CIM.                                       
      * Mover nombre propietario.                                       
      *     IF GDG-IIC-ICLI IN GDG > ZEROES                             
      *         MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC         
      *         MOVE FIO-GET-KEY TO FIO-CMND                            
      *         PERFORM SGC-FIO-DBC                                     
      *         IF FIO-STAT-OKS                                         
      *<<<< FMT_CHI                                                     
      *            MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN GDG-FLD  
      *            MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN GDG-FLD  
      *            MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN GDG-FLD  
      *            MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN GDG-FLD  
      *>>>>                                                             
      *            MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI         
      *            MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI         
                                                                        
      *            MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
      *            PERFORM CPT-BLKS                                     
      *            MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD             
      *            MOVE CPT-STRN TO CNE-GDG-GLS-NOMP                    
      *          ELSE                                                   
      *            MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD               
      *            MOVE SPACES  TO CNE-GDG-GLS-NOMP                     
      *     ELSE                                                        
      *        MOVE GDG-GLS-NOMP IN GDG TO FRM-GLS-NOMC IN GDG-FLD      
      *        MOVE GDG-GLS-NOMP IN GDG TO CNE-GDG-GLS-NOMP.            
                                                                        
      *<<<< FMT_CHI                                                     
      *     IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND                     
      *>>>>                                                             
      *        GDG-IND-CBAN IN GDG     = 'S'                            
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI X  NEX' TO MSG-COD-MENS                    
      *            GO TO FIN-VAL-FRM-IDC-ICLI-CIM.                      
                                                                        
      *<<<< FMT_CHI                                                     
      *     IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES AND                 
      *>>>>                                                             
      *        GDG-IND-CBAN IN GDG         = 'N'                        
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI Y NEX' TO MSG-COD-MENS                     
      *            PERFORM GET-MSG                                      
      *            GO TO FIN-VAL-FRM-IDC-ICLI-CIM.                      
                                                                        
                                                                        
      *<<<< FMT_CHI                                                     
      *      IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES                    
      *>>>>                                                             
                                                                        
      *<<<< FMT_CHI                                                     
      *         MOVE FRM-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC     
      *         MOVE FRM-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC     
      *         MOVE FRM-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC     
      *>>>>                                                             
      *         MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                        
      *         MOVE FIO-GET-KEY TO FIO-CMND                            
      *         PERFORM SGC-FIO-DBC                                     
      *         IF NOT FIO-STAT-OKS                                     
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI    NEX' TO MSG-COD-MENS                    
      *        ELSE                                                     
      *           MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI          
      *           MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI          
      *           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                  
      *           PERFORM CPT-BLKS                                      
      *           MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.             
      * FIN-VAL-FRM-IDC-ICLI-CIM.                                       
      *     EXIT.                                                       
                                                                        
                                                                        
       VAL-GDG-IDC-IPRO-CIM SECTION.                                    
       INI-VAL-GDG-IDC-IPRO-CIM.                                        
      * Mover nombre propietario.                                       
           IF GDG-IIC-ICLI IN GDG > ZEROES AND                          
              GDG-IND-CBAN IN GDG = 'S'                                 
                 MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC        
                 MOVE FIO-GET-KEY TO FIO-CMND                           
                 PERFORM SGC-FIO-DBC                                    
                 IF FIO-STAT-OKS                                        
                   MOVE DBC-NUM-ICLI IN DBC TO GDG-NUM-IPRO IN GDG-FLD  
                   MOVE DBC-VRF-ICLI IN DBC TO GDG-VRF-IPRO IN GDG-FLD  
                   MOVE DBC-IND-ICLI IN DBC TO GDG-IND-IPRO IN GDG-FLD  
                   MOVE DBC-GLS-ICLI IN DBC TO GDG-GLS-IPRO IN GDG-FLD  
      *>>>>                                                             
                   MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI         
                   MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI         
                                                                        
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN TO GDG-GLS-NOMP IN GDG-FLD             
                   MOVE CPT-STRN TO CNE-GDG-GLS-NOMP                    
                 ELSE                                                   
                   MOVE SPACES TO GDG-GLS-NOMP IN GDG-FLD               
                   MOVE SPACES  TO CNE-GDG-GLS-NOMP                     
           ELSE                                                         
              MOVE GDG-NUM-IPRO IN GDG TO GDG-NUM-IPRO IN GDG-FLD       
              MOVE GDG-VRF-IPRO IN GDG TO GDG-VRF-IPRO IN GDG-FLD       
              MOVE GDG-GLS-NOMP IN GDG TO GDG-GLS-NOMP IN GDG-FLD       
              MOVE GDG-GLS-NOMP IN GDG TO CNE-GDG-GLS-NOMP.             
       FIN-VAL-GDG-IDC-IPRO-CIM.                                        
           EXIT.                                                        
      *FIN-AFRI/ABR2007                                                 
                                                                        
       VAL-DBC-GLS-NOMC-CIM SECTION.                                    
       INI-VAL-DBC-GLS-NOMC-CIM.                                        
      *<<<< FMT_CHI                                                     
      *EVA-AFRI/ABR2007                                                 
      *    IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND                      
      *>>>>                                                             
      *       GDG-IND-CBAN IN GDG     = 'N'    AND                      
      *       FRM-GLS-NOMC IN GDG-FLD NOT > SPACES                      
      *           MOVE 'TAB'         TO MSG-COD-SIST                    
      *           MOVE 'CLI-NOM-NEX' TO MSG-COD-MENS                    
      *           PERFORM GET-MSG                                       
      *           MOVE SPACES        TO FRM-GLS-NOMC IN GDG-FLD         
      *           MOVE MSG-GLS-DESC  TO FRM-MENS                        
      *           MOVE FRM-SUAR-MAL  TO FRM-SUAR.                       
      *            GO TO FIN-VAL-FRM-GLS-NOMC.                          
      *FIN-AFRI/ABR2007                                                 
       FIN-VAL-DBC-GLS-NOMC-CIM.                                        
           EXIT.                                                        
      *RRM-FIN 4-JUL-2002                                               
       COPY BGLBFGIM.                                                   
       COPY BGLBFGVE.                                                   
       COPY BGLBFGAP.                                                   
       COPY BGLBFGDP.                                                   
       COPY BGLBFGES.                                                   
       COPY BGLBFGIN.                                                   
       COPY BGLBFGLE.                                                   
       COPY BGLBFGSE.                                                   
       COPY BGLBFGSI.                                                   
       COPY BGLBFGTP.                                                   
       COPY BGLBFGUB.                                                   
       COPY BGLBFGVT.                                                   
       COPY BGLBFGMO.                                                   
      *MHM-INI 30-JUL-2003                                              
      * COPY BGLBVVCG.                                                  
       COPY DAPBFOPD.                                                   
       COPY BGLBFGDO.                                                   
       COPY COLBFOPC.                                                   
       COPY COLBFDLC.                                                   
       COPY GNSBGVSM.                                                   
      *MHM-FIN 30-JUL-2003                                              
       COPY BGLBSELI.                                                   
       COPY BGLBGVC2.                                                   
      * COPY BGLBVUOF.                                                  
      *                                                                 
       COPY TABBBUSR.                                                   
      *EVA-INI-AFRI/ENERO2006                                           
       VAL-IND-GSO SECTION.                                             
       INI-VAL-IND-GSO.                                                 
           MOVE GDG-CAI-GTIA IN GDG TO GSO-CAI-GTIA IN GSO.             
           MOVE GDG-IIC-GTIA IN GDG TO GSO-IIC-GTIA IN GSO.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-VAL-IND-GSO.                                                 
           MOVE 'GSO-KEY-IGDG' TO FIO-AKEY.                             
           PERFORM BGL-FIO-GSO.                                         
           IF  NOT (FIO-STAT-OKS AND                                    
              GDG-CAI-GTIA IN GDG = GSO-CAI-GTIA IN GSO AND             
              GDG-IIC-GTIA IN GDG = GSO-IIC-GTIA IN GSO)                
               MOVE 'GSOSINGSLT' TO MSG-COD-MENS                        
               GO TO FIN-VAL-IND-GSO.                                   
           MOVE GSO-NUM-SBGL IN GSO TO GSL-NUM-SBGL IN GSL              
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM BGL-FIO-GSL                                          
           IF NOT FIO-STAT-OKS                                          
               MOVE 'GSOSINGSL' TO MSG-COD-MENS                         
               GO TO FIN-VAL-IND-GSO.                                   
           IF NOT (GSL-COD-TSOL IN GSL = 'T' AND                        
              GSO-COD-ESGA IN GSO = '03' AND                            
              GSO-COD-EST2 IN GSO = '05')                               
               MOVE 'GDGSINGSOVAL' TO MSG-COD-MENS                      
               MOVE FIO-GET-NXT TO FIO-CMND                             
               GO TO LUP-VAL-IND-GSO.                                   
       FIN-VAL-IND-GSO.                                                 
           EXIT.                                                        
      *EVA-FIN-AFRI/ENERO2006                                           
      *>>>>                                                             
      * EVA-INI  12/08                                                  
                                                                        
       VAL-CEN-GDG SECTION.                                             
       INI-VAL-CEN-GDG.                                                 
                                                                        
           MOVE 'S' TO WSS-IND-OCEN IN WSS-VARI.                        
                                                                        
           MOVE 'EJC ' TO USR-COD-TTAB IN USR.                          
           MOVE GDG-CIC-EJOR IN GDG TO USR-COD-USER IN USR.             
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'N' TO WSS-IND-OCEN IN WSS-VARI                      
              GO TO FIN-VAL-CEN-GDG.                                    
                                                                        
           IF GDG-CIC-EJOR IN GDG > SPACES                              
               MOVE GDG-CIC-EJOR IN GDG TO USR-COD-USER IN USR          
               PERFORM BUS-USR                                          
           ELSE                                                         
              MOVE 'N' TO WSS-IND-OCEN IN WSS-VARI                      
              GO TO FIN-VAL-CEN-GDG.                                    
                                                                        
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'CEN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE USR-COD-OFUS IN USR TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                  TAB-IND-VIGE IN TAB = 'S')                            
              MOVE 'N' TO WSS-IND-OCEN IN WSS-VARI.                     
                                                                        
       FIN-VAL-CEN-GDG.                                                 
           EXIT.                                                        
                                                                        
       VAL-VSN SECTION.                                                 
       INI-VAL-VSN.                                                     
           MOVE 'S' TO WSS-IND-TVSN IN WSS-VARI.                        
                                                                        
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'VSN'               TO TAB-COD-TTAB IN TAB.             
           MOVE '01'                TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
              MOVE 'N' TO WSS-IND-TVSN IN WSS-VARI.                     
                                                                        
       FIN-VAL-VSN.                                                     
           EXIT.                                                        
      * EVA-FIN  12/08                                                  
*% END
*% IF FIN_SCR_TRL
      *<<<< LDC_SI AND PGM_MVS AND FIN_SCR_TRL                          
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               MOVE 'F10GDGNINFIA' TO MSG-COD-MENS                      
               PERFORM MSG-PF10.                                        
      *>>>>                                                             
*% END
*% IF FIN_HBL_IKY
      *<<<< LDC_SI AND PGM_MVS AND FIN_HBL_IKY                          
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM HBL-KEY-GDG.                                     
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-STP.                       
                                                                        
           MOVE +0           TO GDG-CAI-GTIA-LEN IN GDG-FLD.            
      *<<<< FMT_CHI                                                     
           MOVE -1           TO GDG-TIP-CGTA-LEN IN GDG-FLD.            
      *>>>>                                                             
      *>>>>                                                             
*% END
*% IF PGM_PQ
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON OR PFS_GET_ACC                                  
           IF NOT                                                       
              ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD = FRM-FFLD-PF6 OR   
                FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD = FRM-FFLD-PF8 )    
      *>>>>
*% END
*% END
*% IF FIN_SCR_GIKY                                                             
      *<<<< LDC_SI AND PGM_MVS AND (FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_
           IF FRM-FFLD = FRM-FFLD-PF3 AND                               
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
      *       AND SCR-IND-COL = 'C'                                     
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
*% END
*% IF INI_FIO
      *<<<< LDC_SI AND PGM_MVS AND INI_FIO AND PGM_BMS                  
      *<<<< GEN_BCI                                                     
      *PTC ini                                                          
           PERFORM GNS-ERR-QUE.                                         
      *PTC fin                                                          
*% IF PGM_PU
      *<<<< PGM_PU                                                      
      *PTC-INI-MAN
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           IF SCR-SISG NOT > SPACES
              MOVE SCR-SIST TO SCR-SISG.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS                                                      
      *     IF SCR-OFRM-SRV                                             
      * ESTA ANTES DE OBTENER CMMA                                      
              MOVE TSK-TERM-ALF TO WSX-COD-TERM.                        
      *PTC-FIN-MAN                                                      
      *>>>>                                                             
*% END
      *LOP-INI 12-12-2002                                               
           MOVE SPACES TO WSS-IND-ALZA IN WSS-VARI.                     
           IF SCR-CMND = 'ALS'                                          
              MOVE 'ALZ' TO SCR-CMND                                    
              MOVE 'ALS' TO WSS-IND-ALZA IN WSS-VARI.                   
      *LOP-FIN 12-12-2002                                               
           IF SCR-CMND = 'ALZ'                                          
*% IF PGM_PU
      *EVA-AFRI/ABR2007                                                 
               MOVE 'BGL'       TO TAB-COD-SIST FIO-SIST                
      *FIN-AFRI/ABR2007                                                 
*% END
*% IF PGM_PQ
               MOVE 'BGL'       TO FIO-SIST                             
*% END
               MOVE 'VSN '      TO TAB-COD-TTAB IN TAB                  
               MOVE 'ALZDAPESP' TO TAB-COD-CTAB IN TAB                  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF FIO-STAT-OKS                                          
                   MOVE TAB-IND-VIGE IN TAB TO WSS-ALZ-DAP IN WSS-VARI  
               ELSE                                                     
                   MOVE 'N' TO WSS-ALZ-DAP IN WSS-VARI.                 
      *>>>>                                                             
      *<<<< LDC_SI AND PGM_IBM AND INI_FIO AND PGM_BMS                  
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
              MOVE WSS-IDX-IGDG TO SCR-IPRO                             
           ELSE                                                         
      *<<<< ISP-FIN  24-JAN-1996 11:35:48                               
           IF SCR-DESDE-CMN                                             
               MOVE SPACES TO SCR-VEC-ENG                               
               MOVE 1 TO SCR-IPRO                                       
               GO TO FIN-INI-FIO.                                       
                                                                        
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC                          
               MOVE WSS-INST-NULL TO SCR-INST-EXT                       
               MOVE 'GNS' TO MSG-COD-SIST                               
               MOVE 'FLDING' TO MSG-COD-MENS                            
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO SCR-MENS-EXT                        
               PERFORM ING-FPEN-CIC.                                    
       FIN-INI-FIO.                                                     
      *>>>>                                                             
*% END
*% IF SCR_GIKY
      *<<<< SCR_GIKY_VAL_IKY AND GEN_BCI                                
      *PTC-INI-MAN                                                      
           IF SCR-OFRM-SRV AND SCR-CMND = 'ING'                         
               MOVE 'BGL' TO FIO-SIST                                   
               MOVE 'VSN' TO TAB-COD-TTAB IN TAB                        
               MOVE '001' TO TAB-COD-CTAB IN TAB                        
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF NOT FIO-STAT-OKS OR                                   
                  TAB-IND-VIGE IN TAB NOT = 'S'                         
      *        FLB: version 'B'anco                                     
      *             MOVE 'B' TO SCR-IND-V001                            
                   MOVE SPACES TO MSG-COD-MENS                          
                   MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD     
      *AFRI-INI/MAYO2005                                                
                   IF SCR-HDR-MRCA = 'BCS'                              
                      MOVE '0800' TO GDG-CAI-GTIA IN GDG-FLD            
                   ELSE                                                 
                      MOVE '0500' TO GDG-CAI-GTIA IN GDG-FLD            
                   END-IF                                               
      *AFRI-FIN/MAYO2005                                                
                   MOVE 0  TO GDG-CAI-GTIA-LEN IN GDG-FLD               
                   MOVE -1 TO GDG-IIC-GTIA-LEN IN GDG-FLD.              
      *         ELSE                                                    
      *        FLB: version 'C'onsist                                   
      *             MOVE 'C' TO SCR-IND-V001.                           
                                                                        
      *PTC-FIN-MAN                                                      
      *>>>>                                                             
*% END
*% IF SCR_GIKY_VAL_IKY
      *<<<< SCR_GIKY_VAL_IKY AND GEN_BCI                                
      *PTC-INI-MAN                                                      
           IF SCR-OFRM-SRV AND SCR-CMND = 'ING'                         
               MOVE 'BGL' TO FIO-SIST                                   
               MOVE 'VSN' TO TAB-COD-TTAB IN TAB                        
               MOVE '001' TO TAB-COD-CTAB IN TAB                        
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF NOT FIO-STAT-OKS OR                                   
                  TAB-IND-VIGE IN TAB NOT = 'S'                         
      *        FLB: version 'B'anco                                     
      *             MOVE 'B' TO SCR-IND-V001                            
                   MOVE SPACES TO MSG-COD-MENS                          
                   MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD     
      *AFRI-INI/MAYO2005                                                
                   IF SCR-HDR-MRCA = 'BCS'                              
                      MOVE '0800' TO GDG-CAI-GTIA IN GDG-FLD            
                   ELSE                                                 
                      MOVE '0500' TO GDG-CAI-GTIA IN GDG-FLD            
                   END-IF                                               
      *AFRI-FIN/MAYO2005                                                
                   MOVE 0  TO GDG-CAI-GTIA-LEN IN GDG-FLD               
                   MOVE -1 TO GDG-IIC-GTIA-LEN IN GDG-FLD.              
      *         ELSE                                                    
      *        FLB: version 'C'onsist                                   
      *             MOVE 'C' TO SCR-IND-V001.                           
                                                                        
      *PTC-FIN-MAN                                                      
      *>>>>                                                             
*% END
*% IF EOF_PU
       RET-HDR-GDG SECTION.
       INI-RET-HDR-GDG.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO GDG-FEC-FTRN IN GDG.
      *    Hora Transaccion
           MOVE HOY-HHOY TO GDG-HRA-HRTR IN GDG.
      *    Codigo Origen transaccion
      *<<<< NOT PGM_VMS
      *MPB-INI 31-ENE-2018 LIMPIEZA CAMPO COD-OTRN
           MOVE SCR-OTRN TO GDG-COD-OTRN IN GDG.
           IF SCR-OFRM-SRV
               MOVE SCR-ORIG TO GDG-COD-OTRN  IN GDG
           ELSE
               IF NOT SCR-OFRM-SRV
                   MOVE SPACES TO GDG-COD-OTRN IN GDG.
      *MPB-FIN

      *    Autor Transaccion
           MOVE SCR-USER TO GDG-COD-ATRN IN GDG.
      *>>>>
       FIN-RET-HDR-GDG.
           EXIT.

      *<<<< LDC_SI AND PGM_MVS AND EOF                                  
       COPY GNSBPFEC.                                                   
      *EVA-INI-AFRI/ENERO2006                                           
       ACT-IND-GDG SECTION.                                             
       INI-ACT-IND-GDG.                                                 
           MOVE GDG-TIP-CGTA IN GDG TO TAG-TIP-AGTA IN TAG.             
           MOVE GDG-STP-CGTA IN GDG TO TAG-STP-AGTA IN TAG.             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAGNOEXISTE' TO MSG-COD-MENS                       
               GO TO FIN-ACT-IND-GDG.                                   
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM BGL-FIO-GDG.

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LEE-GDD.
           PERFORM LLENAR-ANTES.
           PERFORM GRABAR-LGN.


           MOVE HOY-FHOY TO GDG-FEC-FTRN IN GDG.
           MOVE HOY-HHOY TO GDG-HRA-HRTR IN GDG.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS                                         
           MOVE GDG-STP-CGTA IN GDG-FLD TO GDG-STP-CGTA IN GDG.         
           MOVE TAG-IND-EGDG IN TAG TO GDG-IND-EGDG IN GDG.             
           MOVE TAG-IND-EGDD IN TAG TO GDG-IND-EGDD IN GDG.             
           MOVE TAG-IND-EGES IN TAG TO GDG-IND-EGES IN GDG.             
           MOVE TAG-IND-EGLE IN TAG TO GDG-IND-EGLE IN GDG.             
           MOVE TAG-IND-EGDO IN TAG TO GDG-IND-EGDO IN GDG.             
           MOVE TAG-IND-EGSE IN TAG TO GDG-IND-EGSE IN GDG.             
           MOVE TAG-IND-EGVT IN TAG TO GDG-IND-EGVT IN GDG.             
           MOVE TAG-IND-EGTP IN TAG TO GDG-IND-EGTP IN GDG.             
           MOVE TAG-IND-EGUB IN TAG TO GDG-IND-EGUB IN GDG.             
           MOVE TAG-IND-EGAP IN TAG TO GDG-IND-EGAP IN GDG.             
           MOVE TAG-IND-EGIN IN TAG TO GDG-IND-EGIN IN GDG.             
           MOVE TAG-IND-EGSI IN TAG TO GDG-IND-EGSI IN GDG.             
           MOVE TAG-IND-EGDP IN TAG TO GDG-IND-EGDP IN GDG.             
           MOVE TAG-IND-EGIM IN TAG TO GDG-IND-EGIM IN GDG.             
           MOVE TAG-IND-EGVE IN TAG TO GDG-IND-EGVE IN GDG.             
                                                                        
      *AFRI-INI/SEP2009                                                 
           MOVE SCR-USER            TO GDG-COD-ATRN IN GDG.             
      *AFRI-FIN/SEP2009                                                 
                                                                        
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM BGL-FIO-GDG.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'GDGNOACTMST' TO MSG-COD-MENS                       
               GO TO FIN-ACT-IND-GDG.
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS                                   
       FIN-ACT-IND-GDG.                                                 
           EXIT.                                                        
      *EVA-FIN-AFRI/ENERO2006                                           
       MSG-PF10 SECTION.                                                
       INI-MSG-PF10.                                                    
           MOVE 'DEU' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MEN2.                               
           MOVE FRM-MEN2     TO GDG-GLS-MEN2 IN GDG-FLD.                
       FIN-MSG-PF10.                                                    
           EXIT.                                                        
                                                                        
       HBL-KEY-GDG SECTION.                                             
       INI-HBL-KEY-GDG.                                                 
           MOVE SCR-INST-GKY TO SCR-INST.                               
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-STP.                       
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
      * EN MTX DEBE CAPTURAR LLAVES DE USUARIO EN PANTALLA              
           IF SCR-OFRM-SRV                                              
               MOVE SCR-NMAP TO FRM-NAME                                
               MOVE SCR-NLIB TO FRM-NLIB                                
               MOVE FRM-GET-ALL TO FRM-CMND                             
               PERFORM GNS-PRO-FRM                                      
               MOVE FRM-DFLD TO GDG-FLD                                 
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG                                  
           ELSE                                                         
      *>>>> ISP-INI  24-JAN-1996 11:35:48                               
      *>>>>                                                             
                                                                        
           PERFORM SCR-CLRA-GDG.                                        
                                                                        
      *                                                                 
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.                        
                                                                        
           MOVE SCR-CAI-IGAR IN SCR-VARI TO GDG-CAI-GTIA IN GDG-FLD.    
           MOVE SCR-IIC-IGAR IN SCR-VARI TO GDG-IIC-GTIA IN GDG-FLD.    
                                                                        
           MOVE +4           TO GDG-CAI-GTIA-LEN IN GDG-FLD.            
      *<<<< FMT_CHI                                                     
           MOVE FRM-POS-CURS TO GDG-TIP-CGTA-LEN IN GDG-FLD.            
      *>>>>                                                             
                                                                        
      *                                                                 
           PERFORM EDT-KEY-GDG.                                         
           PERFORM EDT-FLD-GDG.                                         
           MOVE 'F10GDGNINFIA' TO MSG-COD-MENS.                         
           PERFORM MSG-PF10.                                            
                                                                        
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
      * BAJO MTX DEBE REGRABAR PANTALLA Y LLAMAR A SCR-ING              
                                                                        
           IF SCR-OFRM-SRV                                              
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'                
                                                                        
               MOVE GDG-FLD TO FRM-DFLD                                 
                                                                        
      * INI - COPY - GNSBGFRM                                           
               MOVE SCR-OTRN TO QUE-TERM                                
               MOVE 'TSI'    TO QUE-TYPE                                
               MOVE 1        TO QUE-NITM                                
               MOVE +2014    TO QUE-LITM                                
               MOVE QUE-DEL  TO QUE-CMND                                
               PERFORM GNS-PRO-QUE                                      
               MOVE SCR-OTRN TO QUE-TERM                                
               MOVE 'TSI'    TO QUE-TYPE                                
               MOVE 1        TO QUE-NITM                                
               MOVE +2014    TO QUE-LITM                                
               MOVE FRM-DFLD TO FRM-AUXI                                
      * NO DEBE GRABAR TSI EN FORMATO MTX, SI NO QUE EN FORMATO         
      * PROGRAMA. ESTE PROGRAMA RELEERA TSI SIN PASAR POR MTX           
      *         MOVE MSG-COD-MENS TO FRM-COD-MENS                       
      *         MOVE FRM-MENS     TO FRM-GLS-MENS                       
      *         MOVE FRM-AUXI     TO FRM-DATA                           
      *         MOVE FRM-NAME TO FRM-NAME-IDEN                          
               MOVE FRM-DFLD TO QUE-DATA                                
               MOVE QUE-PUT  TO QUE-CMND                                
               PERFORM GNS-PRO-QUE                                      
      * FIN - COPY - GNSBGFRM                                           
                                                                        
               PERFORM SCR-ING.                                         
                                                                        
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
      *>>>>                                                             
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'                
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)      
               PERFORM SCR-INIT                                         
               PERFORM SCR-EXIT                                         
           ELSE                                                         
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
                EXEC CICS                                               
                 RETURN                                                 
                END-EXEC.                                               
      *<<<< ISP-FIN  24-JAN-1996 11:35:48                               
      *>>>>                                                             
               PERFORM SCR-PUTA.                                        
       FIN-HBL-KEY-CLF.                                                 
           EXIT.                                                        
                                                                        
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS                       
       ING-FPEN-CIC SECTION.                                            
       INI-ING-FPEN-CIC.                                                
           PERFORM ING-SETE.                                            
           PERFORM SCR-CLRA-GDG.                                        
           MOVE SCR-MENS-EXT TO GDG-GLS-MENS.                           
           PERFORM HBL-IKY.                                             
       FIN-ING-FPEN-CIC.                                                
           EXIT.                                                        
                                                                        
       ING-SETE SECTION.                                                
       INI-ING-SETE.                                                    
           PERFORM CRG-TBL-ENG.                                         
           MOVE WSS-NTRN(SCR-IPRO)     TO SCR-NTRN.                     
           MOVE WSS-PROG(SCR-IPRO)     TO SCR-PROG.                     
           MOVE WSS-NMAP(SCR-IPRO)     TO SCR-NMAP.                     
           MOVE WSS-NLIB(SCR-IPRO)     TO SCR-NLIB.                     
                                                                        
           MOVE WSS-NTRV(SCR-IPRO)     TO SCR-NTRV.                     
           MOVE WSS-PROV(SCR-IPRO)     TO SCR-PROV.                     
       FIN-ING-SETE.                                                    
           EXIT.                                                        
                                                                        
       EGR-FPEN-CIC SECTION.                                            
       INI-EGR-FPEN-CIC.                                                
           PERFORM CRG-TBL-ENG.                                         
           ADD 1 TO SCR-IPRO.                                           
           IF SCR-IPRO > WSS-TOT-IIDX                                   
                  PERFORM EGR-FTER-CIC                                  
                  GO TO FIN-EGR-FPEN-CIC.                               
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES             
               GO TO INI-EGR-FPEN-CIC.                                  
                                                                        
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.                      
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.                         
           MOVE SCR-VARI TO SYS-CMMA.                                   
           MOVE SCR-TCMA TO SYS-TCMA.                                   
           MOVE SYS-XCTL TO SYS-CMND.                                   
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
               MOVE WSS-IDX-IGDG TO SCR-IPRO                            
           ELSE                                                         
      *>>>> ISP-FIN  24-JAN-1996 11:35:48                               
      *>>>>                                                             
           PERFORM GNS-PRO-SYS.                                         
       FIN-EGR-FPEN-CIC.                                                
           EXIT.                                                        
                                                                        
       EGR-FTER-CIC SECTION.                                            
       INI-EGR-FTER-CIC.                                                
           PERFORM CRG-TBL-ENG.                                         
           MOVE WSS-IDX-ILDC TO SCR-IPRO.                               
           MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO).            
           MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO).            
                                                                        
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.                      
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.                         
                                                                        
           MOVE SCR-VARI TO SYS-CMMA.                                   
           MOVE SCR-TCMA TO SYS-TCMA.                                   
           MOVE SYS-XCTL TO SYS-CMND.                                   
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
               MOVE WSS-IDX-IGDG TO SCR-IPRO                            
           ELSE                                                         
      *>>>> ISP-FIN  24-JAN-1996 11:35:48                               
      *>>>>                                                             
           PERFORM GNS-PRO-SYS.                                         
       FIN-EGR-FTER-CIC.                                                
           EXIT.                                                        
                                                                        
       SCR-INIT SECTION.                                                
       INI-SCR-INIT.                                                    
           MOVE 3  TO FRM-PLIN.                                         
           MOVE 19 TO FRM-NLIN.                                         
           MOVE FRM-CLR-FRM TO FRM-CMND.                                
           PERFORM GNS-PRO-FRM.                                         
           MOVE FRM-SINI-DBNF TO FRM-SINI.                              
           MOVE SCR-NMAP TO FRM-NAME.                                   
           MOVE SCR-NLIB TO FRM-NLIB.                                   
           MOVE GDG-FLD TO FRM-DFLD.                                    
           MOVE FRM-INI TO FRM-CMND.                                    
           PERFORM GNS-PRO-FRM.                                         
       FIN-SCR-INIT.                                                    
           EXIT.                                                        
                                                                        
       COPY LDCBGMPT.                                                   
                                                                        
      *>>>>                                                             
      *<<<< EOF                                                         
      *Buscar tabla en garantia el CIC.                                 
       BUS-CIC-GAR SECTION.                                             
       INI-BUS-CIC-GAR.                                                 
      *BUS-TAB Busca codigo de tabla                                    
           MOVE 'BGL'     TO TAB-COD-SIST.                              
           MOVE 'CIC'     TO TAB-COD-TTAB IN TAB.                       
           MOVE 'PROCIC'  TO TAB-COD-CTAB IN TAB.                       
                                                                        
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
              MOVE TAB-GLS-DAT1 IN TAB TO GAR-CIC-OFIC IN CMA-VARI      
           ELSE                                                         
               MOVE SPACES TO GAR-CIC-OFIC IN CMA-VARI.                 
       FIN-BUS-CIC-GAR.                                                 
           EXIT.                                                        
                                                                        
      *<<<< EOFPQPU                                                     
                                                                        
       GET-GDD SECTION.                                                 
       INI-GET-GDD.                                                     
           MOVE DBC-KEY-IDBC IN DBC     TO GDD-CIC-DCLI IN GDD.         
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDD-CAI-GTIA IN GDD.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDD-IIC-GTIA IN GDD.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS AND                                          
              GDD-CIC-DCLI IN GDD = DBC-KEY-IDBC IN DBC                 
               MOVE GDD-KEY-AGDD IN GDD TO GDG-KEY-IGDG IN GDG          
               MOVE 2 TO WSS-IBUS                                       
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GDG                                      
               IF FIO-STAT-OKS                                          
                   MOVE 3 TO WSS-IBUS.                                  
       FIN-GET-GDD.                                                     
           EXIT.                                                        
                                                                        
       GET-CUR-GDD SECTION.                                             
       INI-GET-CUR-GDD.                                                 
           MOVE GDG-KEY-IGDG IN GDG TO GDD-KEY-AGDD IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS                                              
               MOVE 'GDD-KEY-AGDD' TO FIO-AKEY                          
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GDD.                                     
           IF NOT                                                       
              GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD                 
               MOVE '23' TO FIO-STAT.                                   
       FIN-GET-CUR-GDD.                                                 
           EXIT.                                                        
       GET-CUR-GDD-MUL SECTION.                                         
       INI-GET-CUR-GDD-MUL.                                             
           MOVE SPACES   TO WSS-IND-CMUL IN CMA-VARI.                   
           MOVE GDG-KEY-IGDG IN GDG TO GDD-KEY-AGDD IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
      *                                                                 
           IF FIO-STAT-OKS   AND                                        
              GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD                 
                MOVE 'GDD-KEY-AGDD' TO FIO-AKEY                         
                MOVE FIO-GET-NXT TO FIO-CMND                            
                PERFORM BGL-FIO-GDD                                     
                IF FIO-STAT-OKS AND                                     
                   GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD            
                   MOVE 'M' TO WSS-IND-CMUL.                            
                                                                        
       FIN-GET-CUR-GDD-MUL.                                             
           EXIT.                                                        
                                                                        
       COPY SGCBFDBC.                                                   
       COPY BGLBFGDD.                                                   
       COPY SGCBGCLI.                                                   
      *<<<< PGM_MEX OR GEN_BCI                                          
       COPY BGLBFGSL.                                                   
       COPY BGLBFGSO.                                                   
      *>>>>                                                             
      *<<<< PGM_PU OR NOT NO_CIC_PQ                                     
       COPY GNSBFCIC.                                                   
      *>>>>                                                             
      *<<<< PGM_PU                                                      
       COPY GNSBGCIC.                                                   
      *>>>>                                                             
      *<<<< UNS_FLD                                                     
       COPY GNSBGCPT.                                                   
       COPY GNSBGSTR.                                                   
      *>>>>                                                             
      *>>>>                                                             
      *<<<< EOF AND PGM_PU                                              
      *<<<< GEN_BCI                                                     
                                                                        
      * SOLO POR DEP A PLAZO PROPIO                                     
       PUT-DBC-GDG SECTION.                                             
       INI-PUT-DBC-GDG.                                                 
           IF DBC-KEY-IDBC IN CMA-VARI > SPACES                         
               MOVE DBC-KEY-IDBC IN CMA-VARI TO DBC-CIC-ICLI IN DBC     
               MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY                         
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DBC                                      
               MOVE FIO-STAT TO PGM-STAT-DBC                            
           ELSE                                                         
               MOVE FIO-STAT-NEX TO PGM-STAT-DBC.                       
           IF PGM-STAT-DBC-NUL                                          
               GO TO FIN-PUT-DBC-GDG.                                   
           IF NOT PGM-STAT-DBC-OKS                                      
               PERFORM CLR-DBC-GDG                                      
               GO TO FIN-PUT-DBC-GDG.                                   
           MOVE DBC-CAI-ICLI IN DBC TO CNE-DBC-CAI-ICLI IN SCR-VARI.    
           MOVE DBC-IIC-ICLI IN DBC TO CNE-DBC-IIC-ICLI IN SCR-VARI.    
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN GDG-FLD.         
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN GDG-FLD.         
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN GDG-FLD.         
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN GDG-FLD.         
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GDG-FLD.         
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                        
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.                    
       FIN-PUT-DBC-GDG.                                                 
           EXIT.                                                        
      *>>>>                                                             
      *<<<< ( PGM_VSI OR PGM_DB2 )                                      
      * COPY BGLBFGMO.                                                  
      *>>>>                                                             
      *>>>>                                                             
      *<<<< EOF AND PGM_PU                                              
                                                                        
       ANL-KEY-ALL SECTION.                                             
       INI-ANL-KEY-ALL.                                                 
       FIN-ANL-KEY-ALL.                                                 
           EXIT.                                                        
                                                                        
       BCK-OUT SECTION.                                                 
       INI-BCK-OUT.                                                     
           MOVE FIO-BCK-OUT TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS                                              
      *        Para informar que el backout se realizo con exito        
               MOVE '49' TO FIO-STAT.                                   
       FIN-BCK-OUT.                                                     
           EXIT.                                                        
                                                                        
      * INIT                                                            
      * ====                                                            
                                                                        
       INI-REG-GDD SECTION.                                             
       INI-INI-REG-GDD.                                                 
           MOVE SPACES   TO GDD-GLS-FLAG IN GDD.                        
           MOVE 100      TO GDD-SGV-PLIM IN GDD.                        
           MOVE ZEROES   TO GDD-SGV-VLIM IN GDD.                        
           MOVE SPACES   TO GDD-GLS-DISP IN GDD.
      *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
           MOVE ZEROES   TO GDD-SGV-VALR IN GDD.
           MOVE SPACES   TO GDD-COD-VCAM IN GDD.
      *OGB-FIN 08-OCT-2015 LIMITE DE GARANTIAS                        
       FIN-INI-REG-GDD.                                                 
           EXIT.                                                        
                                                                        
      * GET-UPD                                                         
      * =======                                                         
                                                                        
       GET-UPD-GDD SECTION.                                             
       INI-GET-UPD-GDD.                                                 
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDD-CAI-GTIA IN GDD.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDD-IIC-GTIA IN GDD.         
           MOVE 'GDD-KEY-AGDD'  TO FIO-AKEY.                            
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF NOT FIO-STAT-OKS                                          
                MOVE WSS-PRIMER TO WSS-MGDD                             
      *FLB CST 22-SEP-1993                                              
      *         MOVE FIO-MENS TO FRM-MENS                               
                GO TO FIN-GET-UPD-GDD.                                  
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM BGL-FIO-GDD.                                         
                                                                        
           IF CNE-DBC-CAI-ICLI = GDD-CAI-DCLI IN GDD AND                
              CNE-DBC-IIC-ICLI = GDD-IIC-DCLI IN GDD                    
               MOVE WSS-MISMO TO WSS-MGDD                               
               MOVE FIO-ULK-REC TO FIO-CMND                             
               PERFORM BGL-FIO-GDD                                      
           ELSE                                                         
               MOVE WSS-OTRO  TO WSS-MGDD.                              
       FIN-GET-UPD-GDD.                                                 
           EXIT.                                                        
                                                                        
      * PUT                                                             
      * ===                                                             
                                                                        
       PUT-GDD SECTION.                                                 
       INI-PUT-GDD.                                                     
      *<<<< FMT_CHI                                                     
           IF DBC-IND-ICLI IN GDG-FLD NOT = 'M'                         
      *>>>>                                                             
               PERFORM INI-REG-GDD                                      
               MOVE SCR-USER TO GDD-CIC-UING IN GDD                     
               MOVE HOY-FHOY TO GDD-FEC-FING IN GDD                     
               MOVE 'I'      TO GDD-MSC-TACC IN GDD
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
               MOVE SCR-USER TO GDD-COD-ATRN IN GDD.
      *MPB-INI 31-ENE-2018 LIMPIEZA CAMPO COD-OTRN
               MOVE SCR-OTRN TO GDD-COD-OTRN IN GDD.
               IF SCR-OFRM-SRV
                   MOVE SCR-ORIG TO GDD-COD-OTRN IN GDD
               ELSE
                   IF NOT SCR-OFRM-SRV
                       MOVE SPACES TO GDD-COD-OTRN IN GDD.
      *MPB-FIN

               MOVE HOY-STP-ITRN TO GDD-STP-ITRN IN GDD.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
               MOVE CNE-DBC-CAI-ICLI TO GDD-CAI-DCLI IN GDD             
               MOVE CNE-DBC-IIC-ICLI TO GDD-IIC-DCLI IN GDD             
               MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD          
               MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD          
               MOVE FIO-PUT TO FIO-CMND                                 
               PERFORM BGL-FIO-GDD                                      
               IF NOT FIO-STAT-OKS                                      
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
                   MOVE FIO-MENS TO FRM-MENS                            
                   PERFORM BCK-OUT.
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF DBC-IND-ICLI IN GDG-FLD NOT = WSS-CTE-M  
               PERFORM LLENAR-DESPUES-GDD
               PERFORM GRABAR-LGN-GDD.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
       FIN-PUT-GDD.                                                     
           EXIT.                                                        
                                                                        
      * MOD                                                             
      * ===                                                             
                                                                        
       MOD-GDD SECTION.                                                 
       INI-MOD-GDD.                                                     
      *<<<< FMT_CHI                                                     
           IF DBC-IND-ICLI IN GDG-FLD = 'M' OR                          
      *>>>>                                                             
              WSS-MISMO-GDD                                             
               GO TO FIN-MOD-GDD.                                       
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           MOVE WSS-CTE-1 TO WSS-CTE-ENE.
           PERFORM LLENAR-ANTES-GDD.
           PERFORM GRABAR-LGN-GDD.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           MOVE FIO-DEL TO FIO-CMND.                                    
           PERFORM BGL-FIO-GDD.                                         
           IF NOT FIO-STAT-OKS                                          
      *    Error inconsistencia en la eliminacion : hacer               
      *    LOGTB e informar                                             
               MOVE FIO-MENS TO FRM-MENS                                
               PERFORM BCK-OUT                                          
               GO TO FIN-MOD-GDD                                        
           ELSE                                                         
               PERFORM PUT-GDD.                                         
           IF NOT FIO-STAT-OKS                                          
      *        Error inconsistencia en la eliminacion : hacer           
      *        LOGTB e informar                                         
               MOVE FIO-MENS TO FRM-MENS                                
               PERFORM BCK-OUT                                          
               GO TO FIN-MOD-GDD.                                       
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           PERFORM LLENAR-DESPUES-GDD.
           PERFORM GRABAR-LGN-GDD.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

       FIN-MOD-GDD.                                                     
           EXIT.                                                        
                                                                        
       VRF-GAR-DGP SECTION.                                             
       INI-VRF-GAR-DGP.                                                 
           MOVE 'N' TO WSS-MARC-4 IN WSS-VARI.                          
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GES-CAI-GTIA IN GES.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GES-IIC-GTIA IN GES.         
           MOVE ZEROES                  TO GES-NUM-IGES IN GES.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GES.                                         
       LEE-GES-1.                                                       
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-VRF-GAR-DGP.                                    
                                                                        
           IF NOT (GDG-CAI-GTIA IN GDG-FLD = GES-CAI-GTIA IN GES AND    
                   GDG-IIC-GTIA IN GDG-FLD = GES-IIC-GTIA IN GES)       
              MOVE FIO-GET-NXT TO FIO-CMND                              
              PERFORM BGL-FIO-GES                                       
              GO TO LEE-GES-1.                                          
                                                                        
           MOVE GES-CIC-IOPC IN GES TO OPC-CIC-IOPC IN OPC              
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM COL-FIO-OPC                                          
           IF FIO-STAT-OKS                                              
              IF OPC-MSC-STAT IN OPC = 'A' AND                          
                 OPC-VAL-SCRE IN OPC > ZEROES                           
                    MOVE 'S' TO WSS-MARC-4 IN WSS-VARI.                 
       FIN-VRF-GAR-DGP.                                                 
           EXIT.                                                        
                                                                        
                                                                        
      *DELETE                                                           
      *======                                                           
       DEL-GDD SECTION.                                                 
       INI-DEL-GDD. 
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           MOVE WSS-CTE-1 TO WSS-CTE-ENE.
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           MOVE GDG-KEY-IGDG IN GDG TO GDD-KEY-AGDD IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GDD-KEY-AGDD IN GDD = GDG-KEY-IGDG IN GDG )               
               MOVE '00' TO FIO-STAT                                    
               IF FIO-STAT-OKS                                          
                   MOVE 'GDD-KEY-AGDD' TO FIO-AKEY                      
                   MOVE FIO-END-BRW TO FIO-CMND                         
                   PERFORM BGL-FIO-GDD                                  
                   GO TO FIN-DEL-GDD                                    
               ELSE                                                     
                   GO TO FIN-DEL-GDD.                                   
       LUP-DEL-GDD.                                                     
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-END-BRW TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           PERFORM LLENAR-ANTES-GDD.
           PERFORM GRABAR-LGN-GDD.
           ADD WSS-CTE-1 TO WSS-CTE-ENE.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM BGL-FIO-GDD.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-DEL-GDD.                                       
           MOVE FIO-DEL TO FIO-CMND.                                    
           PERFORM BGL-FIO-GDD.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-DEL-GDD.                                       
                                                                        
           MOVE GAR-CIC-DCLI IN CMA-VARI TO GDD-CIC-DCLI IN GDD.        
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS AND                                          
              GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD                 
               GO TO LUP-DEL-GDD.                                       
           MOVE '00' TO FIO-STAT.                                       
       FIN-DEL-GDD.                                                     
           EXIT.                                                        
                                                                        
      *<<<< GEN_BCI                                                     
      *AFRI-INI 05-MAY-2015 LIMITE DE CREDITO SEGUN ARTICULO 84
      *LOP-INI 6-DIC-2002                                               
      *ANL-LDC-GDD SECTION.
      *INI-ANL-LDC-GDD.
      *    MOVE SPACES               TO MSG-COD-MENS
      *    MOVE GDG-KEY-IGDG IN GDG TO GDD-KEY-AGDD IN GDD.
      *    MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
      *    MOVE FIO-GET-NLS TO FIO-CMND.
      *    PERFORM BGL-FIO-GDD.
      *    IF NOT ( FIO-STAT-OKS AND
      *       GDD-KEY-AGDD IN GDD = GDG-KEY-IGDG IN GDG )
      *        MOVE '00' TO FIO-STAT
      *        IF FIO-STAT-OKS
      *            MOVE 'GDD-KEY-AGDD' TO FIO-AKEY
      *            MOVE FIO-END-BRW TO FIO-CMND
      *            PERFORM BGL-FIO-GDD
      *            GO TO FIN-ANL-LDC-GDD
      *        ELSE
      *            GO TO FIN-ANL-LDC-GDD.
                                                                        
      *LUP-ANL-LDC-GDD.
                                                                        
      *    MOVE GDD-CIC-DCLI IN GDD  TO DBC-CIC-ICLI IN DBC.
      *    MOVE GDD-CIC-DCLI IN GDD  TO CCU-CIC-ICLI IN CCU-VARI.
      *    MOVE GDG-KEY-IGDG IN GDG TO CCU-KEY-IGDG IN CCU-VARI.
      *    PERFORM CCU-POR-MAR.
      *    IF MSG-COD-MENS > SPACES
      *       MOVE 'GDD-KEY-AGDD' TO FIO-AKEY
      *       MOVE FIO-END-BRW TO FIO-CMND
      *       PERFORM BGL-FIO-GDD
      *       GO TO FIN-ANL-LDC-GDD.
                                                                        
      *    IF WSS-IND-ALZA NOT = 'ALS'
      *    PERFORM LLAMA-CCU-LDC
      *    IF MSG-COD-MENS > SPACES
      *       MOVE 'GDD-KEY-AGDD' TO FIO-AKEY
      *       MOVE FIO-END-BRW TO FIO-CMND
      *       PERFORM BGL-FIO-GDD
      *       GO TO FIN-ANL-LDC-GDD.
                                                                        
      *    MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
      *    MOVE FIO-GET-NXT     TO FIO-CMND.
      *    PERFORM BGL-FIO-GDD.
      *    IF FIO-STAT-OKS AND
      *       GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD
      *        GO TO LUP-ANL-LDC-GDD.
                                                                        
      *    IF FIO-STAT-OKS
      *       MOVE FIO-END-BRW TO FIO-CMND
      *       PERFORM BGL-FIO-GDD.
                                                                        
      *    MOVE '00' TO FIO-STAT.
      *FIN-ANL-LDC-GDD.
      *    EXIT.
      *LOP-FIN 6-DIC-2002                                               
      *AFRI-FIN 05-MAY-2015 LIMITE DE CREDITO SEGUN ARTICULO 84
                                                                        
       VAL-USR-OFI SECTION.                                             
       INI-VAL-USR-OFI.                                                 
           IF SCR-OFRM-SRV                                              
              MOVE 'P'    TO USP-PERMISO                                
              MOVE SPACES TO USP-COD-USUARIO                            
              GO TO FIN-VAL-USR-OFI.                                    
      *ALD-BCI-INI/07032000                                             
      *    COPY USPC143.                                                
      *ALD-BCI-FIN/07032000                                             
       FIN-VAL-USR-OFI.                                                 
           EXIT.                                                        
      *ALD-BCI-INI/07032000                                             
       VAL-PTA-USR SECTION.                                             
       INI-VAL-PTA-USR.                                                 
           IF SCR-OFRM-SRV                                              
              MOVE 'P'    TO USP-PERMISO                                
              MOVE SPACES TO USP-COD-USUARIO                            
              GO TO FIN-VAL-PTA-USR.                                    
           COPY USPC143.                                                
           MOVE 'BGLGTUCG/CEN' TO USP-PTA-STR.                          
           COPY USPC103.                                                
       FIN-VAL-PTA-USR.                                                 
           EXIT.                                                        
      *ALD-BCI-FIN/07032000                                             
      *>>>>                                                             
      *>>>>                                                             
       COPY BGLBGVCG.                                                   
       COPY BGLBKVCG.                                                   
      *<<<< GEN_BCI AND PGM_PU                                          
       COPY BGLBGIDP.                                                   
       COPY BGLBKIDP.                                                   
      *>>>>                                                             
      *<<<< NOT ( PGM_VSI OR PGM_DB2 ) AND PGM_PU                       
       COPY BGLBGELI.                                                   
       COPY BGLBKELI.                                                   
      *AFRI/INI-FIN/07                                                  
      *COPY BGLBGGOR.                                                   
      *>>>>                                                             
      *>>>>                                                             
                                                                        
      *<<<< EOF                                                         
      *<<<< GEN_BCI                                                     
       COPY BGLBGEDP.                                                   
                                                                        
      *LOP-INI 6-DIC-2002                                               
       COPY LDCBKCEG.                                                   
       COPY LDCBKCCU.                                                   
       COPY LDCBGCC1.                                                   
       COPY LDCBFCLF.                                                   
       COPY LDCBFRDC REPLACING RDC BY RDL.                              
      *AFRI-INI 05-MAY-2015 LIMITE DE CREDITO SEGUN ARTICULO 84
      *COPY BGLBGMAR.
      *AFRI-FIN 05-MAY-2015 LIMITE DE CREDITO SEGUN ARTICULO 84
       COPY LDCBGCCU.                                                   
      *LOP-FIN 6-DIC-2002                                               
       COPY DAPBFRCC.                                                   
      *>>>>                                                             
       COPY BGLBFTAG.                                                   
                                                                        
      *RRM-INI 3-JUN-2002                                               
       LECTURA-TAG SECTION.                                             
       INI-LECTURA-TAG.                                                 
      *<<<< FMT_CHI                                                     
           IF SCR-CMND = 'ACE'                                          
              GO TO FIN-LECTURA-TAG.                                    
           MOVE GDG-TIP-CGTA IN GDG  TO WSS-TIP-CGTA IN WSS-VARI.       
           MOVE GDG-STP-CGTA IN GDG  TO WSS-STP-CGTA IN WSS-VARI.       
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAG-COD-AGTA IN TAG.        
      *>>>>                                                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM BGL-FIO-TAG.                                         
       FIN-LECTURA-TAG.                                                 
           EXIT.                                                        
                                                                        
      *<<<< GEN_BCI                                                     
       BUS-GDO-OPD SECTION.                                             
       INI-BUS-GDO-OPD.                                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDO-CAI-GTIA IN GDO.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDO-IIC-GTIA IN GDO.         
           MOVE 1                       TO GDO-NUM-IGDO IN GDO.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'          TO MSG-COD-SIST                      
               MOVE 'GDO    NEX'   TO MSG-COD-MENS                      
           ELSE                                                         
               MOVE GDO-COD-DOCU IN GDO TO OPD-CIC-IOPD IN DAP-VARI     
               MOVE OPD-CAI-IOPD IN DAP-VARI TO OPD-CAI-IOPD IN OPD     
               MOVE OPD-IIC-IOPD IN DAP-VARI TO OPD-IIC-IOPD IN OPD     
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM DAP-FIO-OPD                                      
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'BGL'          TO MSG-COD-SIST                  
                   MOVE 'OPD    NEX'   TO MSG-COD-MENS                  
               ELSE                                                     
               IF OPD-COD-STAT IN OPD NOT = 'G'                         
                   MOVE 'BGL'            TO MSG-COD-SIST                
                   MOVE 'OPD    NOVIG'   TO MSG-COD-MENS.               
       FIN-BUS-GDO-OPD.                                                 
           EXIT.                                                        
      *>>>>                                                             
                                                                        
       VRF-MOD-GSO SECTION.                                             
       INI-VRF-MOD-GSO.                                                 
           IF NOT ( FIO-STAT-OKS AND                                    
              GDG-CAI-GTIA IN GDG-FLD = GES-CAI-GTIA IN GES AND         
              GDG-IIC-GTIA IN GDG-FLD = GES-IIC-GTIA IN GES)            
               MOVE '00' TO FIO-STAT                                    
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE GDG-CIC-GTIA IN GDG TO GSO-CIC-GTIA IN GSO.             
           MOVE GES-KEY-IGSL IN GES TO GSO-NUM-SBGL IN GSO.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSO    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSO  NOUPD' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE '11' TO GSO-COD-ESGA IN GSO.                            
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSO  NOMOD' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM BGL-FIO-GES.                                         
           GO TO INI-VRF-MOD-GSO.                                       
       FIN-VRF-MOD-GSO.                                                 
           EXIT.                                                        
                                                                        
                                                                        
       VRF-IND-TAG SECTION.                                             
       INI-VRF-IND-TAG.                                                 
      *<<<< FMT_CHI                                                     
           IF SCR-CMND = 'ACE'                                          
              GO TO FIN-VRF-IND-TAG.                                    
           MOVE GDG-TIP-CGTA IN GDG  TO WSS-TIP-CGTA IN WSS-VARI.       
           MOVE GDG-STP-CGTA IN GDG  TO WSS-STP-CGTA IN WSS-VARI.       
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAG-COD-AGTA IN TAG.        
      *>>>>                                                             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'TAG    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-IND-TAG.                                   
                                                                        
           IF NOT ( TAG-IND-EGSL IN TAG = 'S' AND TAG-IND-EGSO = 'S' )  
               GO TO FIN-VRF-IND-TAG.                                   
                                                                        
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GES-CAI-GTIA IN GES.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GES-IIC-GTIA IN GES.         
           MOVE ZEROES                  TO GES-NUM-IGES IN GES.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GES.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GDG-CAI-GTIA IN GDG-FLD = GES-CAI-GTIA IN GES AND         
              GDG-IIC-GTIA IN GDG-FLD = GES-IIC-GTIA IN GES)            
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GES    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-IND-TAG                                    
           ELSE                                                         
               PERFORM VRF-MOD-GSO.                                     
                                                                        
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-VRF-IND-TAG.                                   
       FIN-VRF-IND-TAG.                                                 
           EXIT.                                                        
      *RRM-FIN 3-JUN-2002                                               
      *RRM-INI 4-JUL-2002                                               
       VAL-CIM-AGA SECTION.                                             
       INI-VAL-CIM-AGA.                                                 
           PERFORM VAL-GDG-FEC-FVTO-CIM.                                
           PERFORM VAL-GDG-IND-CBAN-CIM.                                
           PERFORM VAL-GDG-IDC-IPRO-CIM.                                
           PERFORM VAL-DBC-GLS-NOMC-CIM.                                
       FIN-VAL-CIM-AGA.                                                 
           EXIT.                                                        
                                                                        
       VAL-GDG-FEC-FVTO-CIM SECTION.                                    
       INI-VAL-GDG-FEC-FVTO-CIM.                                        
      *VAL-FEC Validar Fecha                                            
           MOVE GDG-FEC-FVTO IN GDG TO FEC-FECH.                        
           MOVE FEC-FORM-FEC        TO FEC-FORM.                        
           MOVE FEC-FBLK-S          TO FEC-FBLK.                        
           MOVE FEC-CHOY-LE         TO FEC-CHOY.                        
           MOVE FEC-VHBL-S          TO FEC-VHBL.                        
           MOVE FEC-VHBL-N          TO FEC-VHBL.                        
                                                                        
           MOVE GDG-NUM-SVTO IN GDG TO FEC-SVLD.                        
           MOVE GDG-NUM-AVTO IN GDG TO FEC-AVLD.                        
           MOVE GDG-NUM-MVTO IN GDG TO FEC-MVLD.                        
           MOVE GDG-NUM-DVTO IN GDG TO FEC-DVLD.                        
                                                                        
           MOVE TAG-IND-SVTO IN TAG TO GAR-IND-SVTO IN CMA-VARI.        
                                                                        
           IF GAR-IND-SVTO IN CMA-VARI  = 'S'                           
              IF FEC-FVLD = '00000000'                                  
                 MOVE 'VTO=0' TO MSG-COD-MENS                           
                 GO TO ERR-VAL-GDG-FEC-FVTO-CIM.                        
                                                                        
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           MOVE FEC-VAL-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
           IF  NOT FEC-STAT-OKS                                         
               MOVE 'FVEN  NOVAL' TO MSG-COD-MENS                       
               GO TO FIN-VAL-GDG-FEC-FVTO-CIM.                          
                                                                        
                                                                        
           MOVE GDG-NUM-SSOL IN GDG TO FEC-SEC1.                        
           MOVE GDG-NUM-ASOL IN GDG TO FEC-AEC1.                        
           MOVE GDG-NUM-MSOL IN GDG TO FEC-MEC1.                        
           MOVE GDG-NUM-DSOL IN GDG TO FEC-DEC1.                        
                                                                        
           MOVE GDG-NUM-SVTO IN GDG TO FEC-SEC2.                        
           MOVE GDG-NUM-AVTO IN GDG TO FEC-AEC2.                        
           MOVE GDG-NUM-MVTO IN GDG TO FEC-MEC2.                        
           MOVE GDG-NUM-DVTO IN GDG TO FEC-DEC2.                        
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-CMP-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-LES                                          
               MOVE 'VTO<=SOL' TO MSG-COD-MENS                          
               GO TO ERR-VAL-GDG-FEC-FVTO-CIM.                          
                                                                        
           MOVE GDG-FEC-FVTO IN GDG TO FEC-FEC1.                        
                                                                        
           MOVE GDG-NUM-DING IN GDG TO FEC-DEC2.                        
           MOVE GDG-NUM-MING IN GDG TO FEC-MEC2.                        
           MOVE GDG-NUM-AING IN GDG TO FEC-AEC2.                        
           MOVE GDG-NUM-SING IN GDG TO FEC-SEC2.                        
           MOVE FEC-FORM-FEC        TO FEC-FORM.                        
           MOVE FEC-CMP-FEC         TO FEC-CMND.                        
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-GRT                                          
               MOVE 'FVTO<=FING' TO MSG-COD-MENS                        
               GO TO ERR-VAL-GDG-FEC-FVTO-CIM.                          
                                                                        
           GO TO FIN-VAL-GDG-FEC-FVTO-CIM.                              
                                                                        
       ERR-VAL-GDG-FEC-FVTO-CIM.                                        
           MOVE 'BGL'     TO MSG-COD-SIST.                              
       FIN-VAL-GDG-FEC-FVTO-CIM.                                        
           EXIT.                                                        
                                                                        
                                                                        
       VAL-GDG-VAL-MNTO-CIM SECTION.                                    
       INI-VAL-GDG-VAL-MNTO-CIM.                                        
           IF GDG-VAL-MNTO IN GDG = ZEROES                              
               MOVE 'BGL'       TO MSG-COD-SIST                         
               MOVE 'MNTO=0' TO MSG-COD-MENS                            
               GO TO FIN-VAL-GDG-VAL-MNTO-CIM.                          
       FIN-VAL-GDG-VAL-MNTO-CIM.                                        
           EXIT.                                                        
                                                                        
       VAL-GDG-IND-CBAN-CIM SECTION.                                    
       INI-VAL-GDG-IND-CBAN-CIM.                                        
           IF  GDG-IND-CBAN IN GDG NOT = 'N' AND NOT = 'S'              
                MOVE 'BGL'         TO MSG-COD-SIST                      
                MOVE 'ICBAN   N/S' TO MSG-COD-MENS                      
                GO TO FIN-VAL-GDG-IND-CBAN-CIM.                         
       FIN-VAL-GDG-IND-CBAN-CIM.                                        
           EXIT.                                                        
                                                                        
      *EVA-AFRI/ABR2007                                                 
      * VAL-FRM-IDC-ICLI-CIM SECTION.                                   
      * INI-VAL-FRM-IDC-ICLI-CIM.                                       
      * Mover nombre propietario.                                       
      *     IF GDG-IIC-ICLI IN GDG > ZEROES                             
      *         MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC         
      *         MOVE FIO-GET-KEY TO FIO-CMND                            
      *         PERFORM SGC-FIO-DBC                                     
      *         IF FIO-STAT-OKS                                         
      *<<<< FMT_CHI                                                     
      *            MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN GDG-FLD  
      *            MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN GDG-FLD  
      *            MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN GDG-FLD  
      *            MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN GDG-FLD  
      *>>>>                                                             
      *            MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI         
      *            MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI         
                                                                        
      *            MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
      *            PERFORM CPT-BLKS                                     
      *            MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD             
      *            MOVE CPT-STRN TO CNE-GDG-GLS-NOMP                    
      *          ELSE                                                   
      *            MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD               
      *            MOVE SPACES  TO CNE-GDG-GLS-NOMP                     
      *     ELSE                                                        
      *        MOVE GDG-GLS-NOMP IN GDG TO FRM-GLS-NOMC IN GDG-FLD      
      *        MOVE GDG-GLS-NOMP IN GDG TO CNE-GDG-GLS-NOMP.            
                                                                        
      *<<<< FMT_CHI                                                     
      *     IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND                     
      *>>>>                                                             
      *        GDG-IND-CBAN IN GDG     = 'S'                            
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI X  NEX' TO MSG-COD-MENS                    
      *            GO TO FIN-VAL-FRM-IDC-ICLI-CIM.                      
                                                                        
      *<<<< FMT_CHI                                                     
      *     IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES AND                 
      *>>>>                                                             
      *        GDG-IND-CBAN IN GDG         = 'N'                        
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI Y NEX' TO MSG-COD-MENS                     
      *            PERFORM GET-MSG                                      
      *            GO TO FIN-VAL-FRM-IDC-ICLI-CIM.                      
                                                                        
                                                                        
      *<<<< FMT_CHI                                                     
      *      IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES                    
      *>>>>                                                             
                                                                        
      *<<<< FMT_CHI                                                     
      *         MOVE FRM-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC     
      *         MOVE FRM-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC     
      *         MOVE FRM-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC     
      *>>>>                                                             
      *         MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                        
      *         MOVE FIO-GET-KEY TO FIO-CMND                            
      *         PERFORM SGC-FIO-DBC                                     
      *         IF NOT FIO-STAT-OKS                                     
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI    NEX' TO MSG-COD-MENS                    
      *        ELSE                                                     
      *           MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI          
      *           MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI          
      *           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                  
      *           PERFORM CPT-BLKS                                      
      *           MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.             
      * FIN-VAL-FRM-IDC-ICLI-CIM.                                       
      *     EXIT.                                                       
                                                                        
                                                                        
       VAL-GDG-IDC-IPRO-CIM SECTION.                                    
       INI-VAL-GDG-IDC-IPRO-CIM.                                        
      * Mover nombre propietario.                                       
           IF GDG-IIC-ICLI IN GDG > ZEROES AND                          
              GDG-IND-CBAN IN GDG = 'S'                                 
                 MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC        
                 MOVE FIO-GET-KEY TO FIO-CMND                           
                 PERFORM SGC-FIO-DBC                                    
                 IF FIO-STAT-OKS                                        
                   MOVE DBC-NUM-ICLI IN DBC TO GDG-NUM-IPRO IN GDG-FLD  
                   MOVE DBC-VRF-ICLI IN DBC TO GDG-VRF-IPRO IN GDG-FLD  
                   MOVE DBC-IND-ICLI IN DBC TO GDG-IND-IPRO IN GDG-FLD  
                   MOVE DBC-GLS-ICLI IN DBC TO GDG-GLS-IPRO IN GDG-FLD  
                   MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI         
                   MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI         
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN TO GDG-GLS-NOMP IN GDG-FLD             
                   MOVE CPT-STRN TO CNE-GDG-GLS-NOMP                    
                 ELSE                                                   
                   MOVE SPACES TO GDG-GLS-NOMP IN GDG-FLD               
                   MOVE SPACES  TO CNE-GDG-GLS-NOMP                     
           ELSE                                                         
              MOVE GDG-NUM-IPRO IN GDG TO GDG-NUM-IPRO IN GDG-FLD       
              MOVE GDG-VRF-IPRO IN GDG TO GDG-VRF-IPRO IN GDG-FLD       
              MOVE GDG-GLS-NOMP IN GDG TO GDG-GLS-NOMP IN GDG-FLD       
              MOVE GDG-GLS-NOMP IN GDG TO CNE-GDG-GLS-NOMP.             
                                                                        
       FIN-VAL-GDG-IDC-IPRO-CIM.                                        
           EXIT.                                                        
                                                                        
       VAL-DBC-GLS-NOMC-CIM SECTION.                                    
       INI-VAL-DBC-GLS-NOMC-CIM.                                        
      *EVA-AFRI/ABR2007                                                 
      *<<<< FMT_CHI                                                     
      *    IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND                      
      *>>>>                                                             
      *       GDG-IND-CBAN IN GDG     = 'N'    AND                      
      *       FRM-GLS-NOMC IN GDG-FLD NOT > SPACES                      
      *           MOVE 'TAB'         TO MSG-COD-SIST                    
      *           MOVE 'CLI-NOM-NEX' TO MSG-COD-MENS                    
      *           PERFORM GET-MSG                                       
      *           MOVE SPACES        TO FRM-GLS-NOMC IN GDG-FLD         
      *           MOVE MSG-GLS-DESC  TO FRM-MENS                        
      *           MOVE FRM-SUAR-MAL  TO FRM-SUAR.                       
      *            GO TO FIN-VAL-FRM-GLS-NOMC.                          
      *FIN-AFRI/AB2007                                                  
       FIN-VAL-DBC-GLS-NOMC-CIM.                                        
           EXIT.                                                        
                                                                        
      *RRM-FIN 4-JUL-2002                                               
       COPY BGLBFPOL.                                                   
       COPY BGLBFGIM.                                                   
       COPY BGLBFGVE.                                                   
       COPY BGLBFGAP.                                                   
       COPY BGLBFGDP.                                                   
       COPY BGLBFGES.                                                   
       COPY BGLBFGIN.                                                   
       COPY BGLBFGLE.                                                   
       COPY BGLBFGSE.                                                   
       COPY BGLBFGSI.                                                   
       COPY BGLBFGTP.                                                   
       COPY BGLBFGUB.                                                   
       COPY BGLBFGVT.                                                   
       COPY BGLBFGMO.                                                   
      *MHM-INI 30-JUL-2003                                              
      *COPY BGLBVVCG.                                                   
       COPY DAPBFOPD.                                                   
       COPY BGLBFGDO.                                                   
       COPY COLBFOPC.                                                   
       COPY COLBFDLC.                                                   
       COPY GNSBGVSM.                                                   
      *MHM-FIN 30-JUL-2003                                              
       COPY BGLBSELI.                                                   
       COPY BGLBGVC2.                                                   
      * COPY BGLBVUOF.                                                  
      *                                                                 
       COPY TABBBUSR.                                                   

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
       COPY GNSBFLGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS 
                                                                        
      *MPB-INI  20-OCT-2017 Correccion Liquidacion DPI
       COPY DAPBFCAD.
       COPY DAPBFEPD.
      *MPB-FIN
      
      *AFRI-INI /JUL2004                                                
       GRABAR-GAP SECTION.                                              
       INI-GRABAR-GAP.                                                  
           MOVE SPACES        TO GAP-GLS-FLAG IN GAP.                   
           MOVE GDG-CAI-GTIA IN GDG  TO GAP-CAI-GTIA IN GAP.            
           MOVE GDG-IIC-GTIA IN GDG  TO GAP-IIC-GTIA IN GAP.            
           MOVE '1'           TO GAP-COD-PACR IN GAP.                   
           MOVE  HOY-FHOY     TO GAP-FEC-FTRN IN GAP.                   
           MOVE  HOY-HHOY     TO GAP-HRA-HRTR IN GAP.                   
           MOVE 'I'           TO GAP-MSC-TACC IN GAP.                   
           MOVE 'I'           TO GAP-MSC-STAT IN GAP.                   
           MOVE SPACES        TO GAP-COD-OTRN IN GAP.                   
           MOVE 'BGLPUGDG'    TO GAP-COD-ATRN IN GAP.                   
           MOVE 'S'           TO GAP-IND-ESBA IN GAP.                   
           MOVE 'N'           TO GAP-IND-ESCL IN GAP.                   
           MOVE 'S'           TO GAP-IND-MASC IN GAP.                   
           MOVE SPACES        TO GAP-CAI-ICLI IN GAP.                   
           MOVE ZEROES        TO GAP-IIC-ICLI IN GAP.                   
           MOVE SPACES        TO GAP-GLS-NOMA IN GAP.                   
           MOVE 'BGL'         TO TAB-COD-SIST FIO-SIST.                 
           MOVE 'IDC'         TO TAB-COD-TTAB IN TAB.                   
           MOVE 'IDCBCO'      TO TAB-COD-CTAB IN TAB.                   
           IF GDG-COD-LGTA IN GDG = 'G'                                 
              MOVE 'G' TO GAP-COD-GPRE IN GAP.                          
           IF GDG-COD-LGTA IN GDG = 'E'                                 
              MOVE 'E' TO GAP-COD-GPRE IN GAP.                          
           MOVE FIO-GET-KEY   TO FIO-CMND.                              
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS AND TAB-IND-VIGE = 'S'                       
               MOVE TAB-GLS-DCOR   TO DBC-NUM-ICLI IN DBC               
               MOVE SPACES         TO DBC-IND-ICLI IN DBC               
               MOVE SPACES         TO DBC-GLS-ICLI IN DBC               
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY                          
               MOVE FIO-GET-KEY    TO FIO-CMND                          
               PERFORM SGC-FIO-DBC                                      
               IF FIO-STAT-OKS                                          
                   MOVE DBC-CAI-ICLI IN DBC TO GAP-CAI-ICLI IN GAP      
                   MOVE DBC-IIC-ICLI IN DBC TO GAP-IIC-ICLI IN GAP      
                   MOVE DBC-GLS-NOMC IN DBC TO GAP-GLS-NOMA IN GAP.     
           MOVE SPACES        TO GAP-COD-RFCA IN GAP                    
           MOVE 'P'           TO GAP-IND-MACR IN GAP                    
           MOVE '100'         TO GAP-SGV-MACR IN GAP                    
           MOVE SPACES        TO GAR-FOJ-ICR-ACR IN GAP                 
           MOVE ZEROES        TO GAR-NUM-ICR-ACR IN GAP                 
           MOVE ZEROES        TO GAR-ANO-ICR-ACR IN GAP                 
           MOVE HOY-FHOY      TO GAP-FEC-FING IN GAP                    
           MOVE 'BGLPUGDG'    TO GAP-CIC-UING IN GAP                    
           MOVE SPACES        TO GAP-GLS-DISP IN GAP.                   
           MOVE FIO-PUT       TO FIO-CMND.                              
           PERFORM BGL-FIO-GAP.                                         
       FIN-GRABAR-GAP.                                                  
           EXIT.                                                        
      *AFRI-FIN /JUL2004                                                
      *>>>>                                                             
       BUS-PTT SECTION.                                                 
       INI-BUS-PTT.                                                     
           MOVE 'NO'         TO PTT-EXT-PNTL.                           
           MOVE 1 TO PTT-I.                                             
       LUP-SIG-PTT.                                                     
           IF PTT-COD-PNTL(PTT-I) = PTT-COD-PTLL                        
              MOVE 'SI' TO PTT-EXT-PNTL                                 
              GO TO FIN-BUS-PTT.                                        
       NXT-SIG-PTT.                                                     
           ADD 1 TO PTT-I.                                              
           IF PTT-I > 20                                                
               GO TO FIN-BUS-PTT                                        
           ELSE                                                         
               GO TO LUP-SIG-PTT.                                       
       FIN-BUS-PTT.                                                     
           EXIT.                                                        
       GDG-GORI SECTION.                                                
      *AFRI-INI/DIC-2007                                                
      *INI-GDG-GORI.                                                    
      *    PERFORM BUSCA-OFIC.                                          
      *    MOVE ZEROES           TO WSS-OFI-NBCS IN WSS-OFI.            
      *    MOVE WSS-GDG-NUM-OFIC TO WSS-OFI-NOVA IN WSS-OFI.            
      *    MOVE WSS-OFI          TO GOR-NUM-OFIC IN GOR-VARI.           
      *    MOVE 7                TO GOR-NUM-PROD IN GOR-VARI.           
      *    MOVE '0'              TO GOR-VRF-FRST IN GOR-NUM-VRF.        
      *    MOVE GOR-NUM-CALC     TO GOR-VRF-CALC IN GOR-NUM-VRF.        
      *    PERFORM CAL-VRF.                                             
      *    MOVE GOR-VARI TO GDG-COD-GORI IN GDG.                        
                                                                        
      *FIN-GDG-GORI.                                                    
      *    EXIT.                                                        
      *AFRI-INI/DIC-2007                                                

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

       LEE-GDD SECTION.
      *===================
       INI-LEE-GDD.

           MOVE GDG-CAI-GTIA IN GDG   TO GDD-CAI-GTIA IN GDD.       
           MOVE GDG-IIC-GTIA IN GDG   TO GDD-IIC-GTIA IN GDD.       
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-KEY  TO FIO-CMND.                           
           PERFORM BGL-FIO-GDD.

       FIN-LEE-GDG.
           EXIT.


       LLENAR-ANTES SECTION.
       INI-LLENAR-ANTES.
      *------------------
           MOVE SPACES TO LGN.

           IF SCR-CMND = 'MOD'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'MOD'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-MOD  TO LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'ALZ'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'ALZ'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-ALZ  TO LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'EJE'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'EJE'  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-EJE  TO LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'MGA'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'MGA'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-MGA  TO LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'MST'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'MST'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-MST  TO LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'AGA'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'AGA'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-AGA  TO LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              MOVE 'A'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'ACE'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'ACE'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-ACE  TO LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              MOVE 'A'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'ELI'
              MOVE 'ELI'  TO LGN-COD-EVEN IN LGN.
              MOVE 'E'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.

           MOVE 'ANT'     TO LGN-COD-INST IN LGN.
           MOVE 1         TO LGN-NUM-CLGN IN LGN
                             LGN-NUM-COPE IN LGN
                             LGN-NUM-CCLI IN LGN
                             LGN-NUM-CEVE IN LGN
                             LGN-NUM-CAUT IN LGN.

           MOVE GDG-FEC-FTRN IN GDG        TO LGN-COD-LN01 IN LGN.
           MOVE GDG-HRA-HRTR IN GDG        TO LGN-COD-LN01 IN LGN(11:6).
           MOVE GDG-MSC-TTRN IN GDG        TO LGN-COD-LN02 IN LGN.
           MOVE GDG-COD-TTRN IN GDG        TO LGN-COD-LN03 IN LGN.
           MOVE GDG-COD-ATRN IN GDG        TO LGN-COD-LN04 IN LGN.
           MOVE GDG-COD-OFIC IN GDG        TO LGN-COD-LN05 IN LGN.
           MOVE GDG-COD-TOPE IN GDG        TO LGN-COD-LN06 IN LGN.
           MOVE GDG-COD-SOPE IN GDG        TO LGN-COD-LN07 IN LGN.
           MOVE GDG-FEC-FSOL IN GDG        TO LGN-COD-LN08 IN LGN.
           MOVE GDG-FEC-FEST IN GDG        TO LGN-COD-LN09 IN LGN.
           MOVE GDG-FEC-FVTO IN GDG        TO LGN-COD-LN10 IN LGN.
           MOVE GDG-COD-LGTA IN GDG        TO LGN-COD-LN11 IN LGN.
           MOVE GDG-IND-CBAN IN GDG        TO LGN-COD-LN12 IN LGN.
           MOVE GDG-NUM-IPRO IN GDG        TO LGN-COD-LN13 IN LGN.
           MOVE GDG-VRF-IPRO IN GDG        TO LGN-COD-LN13 IN LGN(11:1).
           MOVE GDG-GLS-NOMP IN GDG(1:20)  TO LGN-COD-LN14 IN LGN.
           MOVE GDG-GLS-NOMP IN GDG(21:20) TO LGN-COD-LN15 IN LGN.
           MOVE GDG-GLS-NOMP IN GDG(41:10) TO LGN-COD-LN16 IN LGN.
           MOVE GDG-IND-EST1 IN GDG        TO LGN-COD-LN17 IN LGN.
           MOVE GDG-COD-EST1 IN GDG        TO LGN-COD-LN18 IN LGN.
           MOVE GDG-COD-EST2 IN GDG        TO LGN-COD-LN19 IN LGN.
           MOVE GDG-FEC-FALZ IN GDG        TO LGN-COD-LN20 IN LGN.
           MOVE GDG-IND-GTAC IN GDG        TO LGN-COD-LN21 IN LGN.
           MOVE GDG-COD-TSCN IN GDG        TO LGN-COD-LN22 IN LGN.
           MOVE GDG-GLS-DGTA IN GDG(1:20)  TO LGN-COD-LN23 IN LGN.
           MOVE GDG-GLS-DGTA IN GDG(21:20) TO LGN-COD-LN24 IN LGN.
           MOVE GDG-GLS-DGT1 IN GDG(1:20)  TO LGN-COD-LN25 IN LGN.
           MOVE GDG-GLS-DGT1 IN GDG(21:20) TO LGN-COD-LN26 IN LGN.
           MOVE GDG-CIC-UING IN GDG        TO LGN-COD-LN27 IN LGN.
           MOVE GDG-COD-MALZ IN GDG        TO LGN-COD-LN28 IN LGN.
           MOVE GDG-COD-CROL IN GDG        TO LGN-COD-LN29 IN LGN.
           MOVE GDG-COD-GACS IN GDG        TO LGN-COD-LN30 IN LGN.

       FIN-LLENAR-ANTES.
           EXIT.

       LLENAR-DESPUES SECTION.
       INI-LLENAR-DESPUES.
      *------------------
           MOVE SPACES               TO  LGN.

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-ING
              MOVE WSS-CTE-ING TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-I   TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'MOD'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'MOD'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-MOD  TO LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.

           IF SCR-CMND = 'ALZ'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'ALZ'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-ALZ  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                                   LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'EJE'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'EJE'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-EJE  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'MGA'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'MGA'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-MGA  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'MST'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'MST'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-MST  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'AGA'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'AGA'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-AGA  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-A  TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'ACE'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'ACE'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-ACE  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-A    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'ELI'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'ELI'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-ELI  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-E   TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           MOVE 'DES'     TO LGN-COD-INST IN LGN.
           MOVE 2         TO LGN-NUM-CLGN IN LGN
                             LGN-NUM-COPE IN LGN
                             LGN-NUM-CCLI IN LGN
                             LGN-NUM-CEVE IN LGN
                             LGN-NUM-CAUT IN LGN.

           MOVE GDG-FEC-FTRN IN GDG        TO LGN-COD-LN01 IN LGN.
           MOVE GDG-HRA-HRTR IN GDG        TO LGN-COD-LN01 IN LGN(11:6).
           MOVE GDG-MSC-TTRN IN GDG        TO LGN-COD-LN02 IN LGN.
           MOVE GDG-COD-TTRN IN GDG        TO LGN-COD-LN03 IN LGN.
           MOVE GDG-COD-ATRN IN GDG        TO LGN-COD-LN04 IN LGN.
           MOVE GDG-COD-OFIC IN GDG        TO LGN-COD-LN05 IN LGN.
           MOVE GDG-COD-TOPE IN GDG        TO LGN-COD-LN06 IN LGN.
           MOVE GDG-COD-SOPE IN GDG        TO LGN-COD-LN07 IN LGN.
           MOVE GDG-FEC-FSOL IN GDG        TO LGN-COD-LN08 IN LGN.
           MOVE GDG-FEC-FEST IN GDG        TO LGN-COD-LN09 IN LGN.
           MOVE GDG-FEC-FVTO IN GDG        TO LGN-COD-LN10 IN LGN.
           MOVE GDG-COD-LGTA IN GDG        TO LGN-COD-LN11 IN LGN.
           MOVE GDG-IND-CBAN IN GDG        TO LGN-COD-LN12 IN LGN.
           MOVE GDG-NUM-IPRO IN GDG        TO LGN-COD-LN13 IN LGN.
           MOVE GDG-VRF-IPRO IN GDG        TO LGN-COD-LN13 IN LGN(11:1).
           MOVE GDG-GLS-NOMP IN GDG(1:20)  TO LGN-COD-LN14 IN LGN.
           MOVE GDG-GLS-NOMP IN GDG(21:20) TO LGN-COD-LN15 IN LGN.
           MOVE GDG-GLS-NOMP IN GDG(41:10) TO LGN-COD-LN16 IN LGN.
           MOVE GDG-IND-EST1 IN GDG        TO LGN-COD-LN17 IN LGN.
           MOVE GDG-COD-EST1 IN GDG        TO LGN-COD-LN18 IN LGN.
           MOVE GDG-COD-EST2 IN GDG        TO LGN-COD-LN19 IN LGN.
           MOVE GDG-FEC-FALZ IN GDG        TO LGN-COD-LN20 IN LGN.
           MOVE GDG-IND-GTAC IN GDG        TO LGN-COD-LN21 IN LGN.
           MOVE GDG-COD-TSCN IN GDG        TO LGN-COD-LN22 IN LGN.
           MOVE GDG-GLS-DGTA IN GDG(1:20)  TO LGN-COD-LN23 IN LGN.
           MOVE GDG-GLS-DGTA IN GDG(21:20) TO LGN-COD-LN24 IN LGN.
           MOVE GDG-GLS-DGT1 IN GDG(1:20)  TO LGN-COD-LN25 IN LGN.
           MOVE GDG-GLS-DGT1 IN GDG(21:20) TO LGN-COD-LN26 IN LGN.
           MOVE GDG-CIC-UING IN GDG        TO LGN-COD-LN27 IN LGN.
           MOVE GDG-COD-MALZ IN GDG        TO LGN-COD-LN28 IN LGN.
           MOVE GDG-COD-CROL IN GDG        TO LGN-COD-LN29 IN LGN.
           MOVE GDG-COD-GACS IN GDG        TO LGN-COD-LN30 IN LGN.

       FIN-LLENAR-DESPUES.
           EXIT.


       GRABAR-LGN SECTION.
      *===================
       INI-GRABAR-LGN.

           MOVE SCR-SISG TO FIO-SIST.

           EXEC CICS ASKTIME ABSTIME(WSS-LGM-ABSTIME)
           END-EXEC.
           PERFORM GET-FHOY.
           MOVE '1.0'               TO LGN-COD-VERS IN LGN.
           MOVE 'GDG'               TO LGN-COD-ENTF IN LGN
                                       LGN-COD-ENTO IN LGN
                                       LGN-COD-ENTE IN LGN
                                       LGN-COD-ENTC IN LGN
                                       LGN-COD-ENTA IN LGN.
           MOVE HOY-FHOY            TO LGN-FEC-FTRN IN LGN
                                       LGN-FEC-FLGN IN LGN
                                       LGN-FEC-FOPE IN LGN
                                       LGN-FEC-FEVE IN LGN
                                       LGN-FEC-FCLI IN LGN
                                       LGN-FEC-FAUT IN LGN.
           MOVE HOY-HHOY            TO LGN-HRA-HRTR IN LGN
                                       LGN-HRA-HLGN IN LGN
                                       LGN-HRA-HOPE IN LGN
                                       LGN-HRA-HEVE IN LGN
                                       LGN-HRA-HCLI IN LGN
                                       LGN-HRA-HAUT IN LGN.
           MOVE TSK-TERM-NUM        TO LGN-TSK-NUMF IN LGN
                                       LGN-TSK-NUMO IN LGN
                                       LGN-TSK-NUME IN LGN
                                       LGN-TSK-NUMC IN LGN
                                       LGN-TSK-NUMA IN LGN.
           MOVE WSS-LGM-ABSTIME     TO LGN-NUM-ABSF IN LGN
                                       LGN-NUM-ABSO IN LGN
                                       LGN-NUM-ABSE IN LGN
                                       LGN-NUM-ABSC IN LGN
                                       LGN-NUM-ABSA IN LGN.
           MOVE GDG-CIC-GTIA IN GDG TO LGN-CIC-IOPE IN LGN.
           MOVE GDD-CIC-DCLI IN GDD TO LGN-CIC-ICLI IN LGN.
      *MPB-INI 31-ENE-2018 LIMPIEZA CAMPO LGN-COD-OTRN
      *     MOVE EIBTRMID            TO LGN-COD-OTRN IN LGN.
           IF SCR-OFRM-SRV
               MOVE SCR-ORIG TO LGN-COD-OTRN IN LGN
           ELSE
               IF NOT SCR-OFRM-SRV
                   MOVE SPACES TO LGN-COD-OTRN IN LGN.
      *MPB-FIN
           MOVE SCR-USER            TO LGN-COD-ATRN IN LGN
                                       LGN-COD-AUTO IN LGN.
           MOVE EIBTRNID            TO LGN-COD-TCIC IN LGN.
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-ING
              MOVE WSS-CTE-ING  TO LGN-COD-CMND IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = 'MOD'
              MOVE 'MOD'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'ALZ'
              MOVE 'ALZ'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'EJE'
              MOVE 'EJE'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'MGA'
              MOVE 'MGA'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'MST'
              MOVE 'MST'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'AGA'
              MOVE 'AGA'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'ACE'
              MOVE 'ACE'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'ELI'
              MOVE 'ELI'  TO LGN-COD-CMND IN LGN.
            MOVE FIO-PUT TO FIO-CMND.
            PERFORM GNS-FIO-LGN.
       FIN-GRABAR-LGN.
           EXIT.

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
       LLENAR-ANTES-GDD SECTION.
       INI-LLENAR-ANTES-GDD.
      *------------------
           MOVE SPACES TO LGN.

           IF SCR-CMND = WSS-CTE-MOD
              MOVE WSS-CTE-MOD  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.

           IF SCR-CMND = WSS-CTE-ELI
              MOVE WSS-CTE-ELI TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-E    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.

           MOVE WSS-CTE-ANT  TO LGN-COD-INST IN LGN.
           MOVE WSS-CTE-ENE    TO LGN-NUM-CLGN IN LGN
                          LGN-NUM-COPE IN LGN
                          LGN-NUM-CCLI IN LGN
                          LGN-NUM-CEVE IN LGN
                          LGN-NUM-CAUT IN LGN.

           MOVE GDD-CIC-DCLI IN GDD TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
                MOVE WSS-CTE-RNE         TO LGN-COD-LN01 IN LGN
           ELSE
                MOVE DBC-IDC-ICLI IN DBC TO LGN-COD-LN01 IN LGN
                MOVE WSS-CTE-GUI         TO LGN-COD-LN01 IN LGN(9:1)
                MOVE DBC-VRF-ICLI IN DBC TO LGN-COD-LN01 IN LGN(10:1).

           MOVE GDD-FEC-FTRN IN GDD      TO LGN-COD-LN02 IN LGN.
           MOVE GDD-HRA-HRTR IN GDD      TO LGN-COD-LN02 IN LGN(11:6).
           MOVE GDD-MSC-TTRN IN GDD      TO LGN-COD-LN03 IN LGN.
           MOVE GDD-COD-TTRN IN GDD      TO LGN-COD-LN04 IN LGN.
           MOVE GDD-COD-ATRN IN GDD      TO LGN-COD-LN05 IN LGN.

           MOVE GDD-SGV-VLIM IN GDD      TO WSS-SGV-VLIM IN WSS-VARI.
           MOVE WSS-SGV-VLIM IN WSS-VARI TO LGN-COD-LN06 IN LGN.

           MOVE GDD-SGV-PLIM IN GDD      TO WSS-SGV-PLIM IN WSS-VARI.
           MOVE WSS-SGV-PLIM IN WSS-VARI TO LGN-COD-LN07 IN LGN.

           MOVE GDD-SGV-VALR IN GDD      TO WSS-SGV-VALR IN WSS-VARI.
           MOVE WSS-SGV-VALR IN WSS-VARI TO LGN-COD-LN08 IN LGN.
           MOVE GDD-COD-VCAM IN GDD      TO LGN-COD-LN09 IN LGN.
           MOVE GDD-FEC-FING IN GDD      TO LGN-COD-LN10 IN LGN.
           MOVE GDD-CIC-UING IN GDD      TO LGN-COD-LN11 IN LGN.



       FIN-LLENAR-ANTES-GDD.
           EXIT.

       LLENAR-DESPUES-GDD SECTION.
       INI-LLENAR-DESPUES-GDD.
      *------------------
           MOVE SPACES               TO  LGN.

           IF SCR-CMND = WSS-CTE-ING
              MOVE WSS-CTE-ING  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-I    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.

           IF SCR-CMND = WSS-CTE-MOD
              MOVE WSS-CTE-MOD  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.

           IF SCR-CMND = WSS-CTE-ELI
              MOVE WSS-CTE-ELI  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-E    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.


           MOVE WSS-CTE-DES          TO  LGN-COD-INST IN LGN.
           MOVE WSS-CTE-2                TO  LGN-NUM-CLGN IN LGN
                                         LGN-NUM-COPE IN LGN
                                         LGN-NUM-CCLI IN LGN
                                         LGN-NUM-CEVE IN LGN
                                         LGN-NUM-CAUT IN LGN.


           MOVE GDD-CIC-DCLI IN GDD TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
                MOVE WSS-CTE-RNE         TO LGN-COD-LN01 IN LGN
           ELSE
                MOVE DBC-IDC-ICLI IN DBC TO LGN-COD-LN01 IN LGN
                MOVE WSS-CTE-GUI         TO LGN-COD-LN01 IN LGN(9:1)
                MOVE DBC-VRF-ICLI IN DBC TO LGN-COD-LN01 IN LGN(10:1).


           MOVE GDD-FEC-FTRN IN GDD      TO LGN-COD-LN02 IN LGN.
           MOVE GDD-HRA-HRTR IN GDD      TO LGN-COD-LN02 IN LGN(11:6).
           MOVE GDD-MSC-TTRN IN GDD      TO LGN-COD-LN03 IN LGN.
           MOVE GDD-COD-TTRN IN GDD      TO LGN-COD-LN04 IN LGN.
           MOVE GDD-COD-ATRN IN GDD      TO LGN-COD-LN05 IN LGN.

           MOVE GDD-SGV-VLIM IN GDD      TO WSS-SGV-VLIM IN WSS-VARI.
           MOVE WSS-SGV-VLIM IN WSS-VARI TO LGN-COD-LN06 IN LGN.

           MOVE GDD-SGV-PLIM IN GDD      TO WSS-SGV-PLIM IN WSS-VARI.
           MOVE WSS-SGV-PLIM IN WSS-VARI TO LGN-COD-LN07 IN LGN.

           MOVE GDD-SGV-VALR IN GDD      TO WSS-SGV-VALR IN WSS-VARI.
           MOVE WSS-SGV-VALR IN WSS-VARI TO LGN-COD-LN08 IN LGN.
           MOVE GDD-COD-VCAM IN GDD      TO LGN-COD-LN09 IN LGN.
           MOVE GDD-FEC-FING IN GDD      TO LGN-COD-LN10 IN LGN.
           MOVE GDD-CIC-UING IN GDD      TO LGN-COD-LN11 IN LGN.




       FIN-LLENAR-DESPUES-GDD.
           EXIT.


       GRABAR-LGN-GDD SECTION.
      *===================
       INI-GRABAR-LGN-GDD.

           MOVE SCR-SISG TO FIO-SIST.

           EXEC CICS ASKTIME ABSTIME(WSS-LGM-ABSTIME)
           END-EXEC.
           PERFORM GET-FHOY.
           MOVE WSS-CTE-V10         TO LGN-COD-VERS IN LGN.
           MOVE WSS-CTE-GDD         TO LGN-COD-ENTF IN LGN
                                       LGN-COD-ENTO IN LGN
                                       LGN-COD-ENTE IN LGN
                                       LGN-COD-ENTC IN LGN
                                       LGN-COD-ENTA IN LGN.
           MOVE HOY-FHOY            TO LGN-FEC-FTRN IN LGN
                                       LGN-FEC-FLGN IN LGN
                                       LGN-FEC-FOPE IN LGN
                                       LGN-FEC-FEVE IN LGN
                                       LGN-FEC-FCLI IN LGN
                                       LGN-FEC-FAUT IN LGN.
           MOVE HOY-HHOY            TO LGN-HRA-HRTR IN LGN
                                       LGN-HRA-HLGN IN LGN
                                       LGN-HRA-HOPE IN LGN
                                       LGN-HRA-HEVE IN LGN
                                       LGN-HRA-HCLI IN LGN
                                       LGN-HRA-HAUT IN LGN.
           MOVE TSK-TERM-NUM        TO LGN-TSK-NUMF IN LGN
                                       LGN-TSK-NUMO IN LGN
                                       LGN-TSK-NUME IN LGN
                                       LGN-TSK-NUMC IN LGN
                                       LGN-TSK-NUMA IN LGN.
           MOVE WSS-LGM-ABSTIME     TO LGN-NUM-ABSF IN LGN
                                       LGN-NUM-ABSO IN LGN
                                       LGN-NUM-ABSE IN LGN
                                       LGN-NUM-ABSC IN LGN
                                       LGN-NUM-ABSA IN LGN.
           MOVE GDD-CIC-GTIA IN GDD TO LGN-CIC-IOPE IN LGN.
           MOVE GDD-CIC-DCLI IN GDD TO LGN-CIC-ICLI IN LGN.
      *MPB-INI 31-ENE-2018 LIMPIEZA CAMPO COD-OTRN
      *     MOVE EIBTRMID            TO LGN-COD-OTRN IN LGN.
           IF SCR-OFRM-SRV
               MOVE SCR-ORIG TO LGN-COD-OTRN IN LGN
           ELSE
               IF NOT SCR-OFRM-SRV
                   MOVE SPACES TO LGN-COD-OTRN IN LGN.
      *MPB-FIN
           MOVE SCR-USER            TO LGN-COD-ATRN IN LGN
                                       LGN-COD-AUTO IN LGN.
           MOVE EIBTRNID            TO LGN-COD-TCIC IN LGN.


           IF SCR-CMND = WSS-CTE-ING
              MOVE WSS-CTE-ING  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = WSS-CTE-MOD
              MOVE WSS-CTE-MOD  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = WSS-CTE-ELI
              MOVE WSS-CTE-ELI  TO LGN-COD-CMND IN LGN.

            MOVE FIO-PUT TO FIO-CMND.
            PERFORM GNS-FIO-LGN.

       FIN-GRABAR-LGN-GDD.
           EXIT.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      
      *MPB-INI 03-NOV-2017 DPM Correccion Liquidacion DPI
       REV-EPD SECTION.
       INI-REV-EPD.

           MOVE SPACES TO EPD.

           MOVE FRM-CAI-IOPD IN GDG-FLD TO EPD-CAI-IOPD IN EPD.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO EPD-IIC-IOPD IN EPD.
           MOVE 999 TO EPD-NUM-IEPD IN EPD.
           MOVE 999 TO EPD-NUM-IVEN IN EPD.
           MOVE WSS-IN1 TO EPD-COD-IEPD IN EPD.
           MOVE FIO-GET-LEQ TO FIO-CMND.

           PERFORM DAP-FIO-EPD.


           IF NOT (FIO-STAT-OKS)

               GO TO FIN-REV-EPD.





           IF ( FIO-STAT-OKS AND
                    FRM-CAI-IOPD IN GDG-FLD = EPD-CAI-IOPD IN EPD AND
                    FRM-IIC-IOPD IN GDG-FLD = EPD-IIC-IOPD IN EPD AND
                    WSS-IN1 = EPD-COD-IEPD IN EPD AND
                    EPD-COD-SEPD IN EPD = WSS-II)

               ADD 1 TO EPD-NUM-IEPD IN EPD
               MOVE WSS-R TO EPD-COD-SEPD IN EPD
               MOVE WSS-CTE-OPGA TO EPD-GLS-REFE IN EPD
               PERFORM PUT-FTRN


               MOVE FIO-PUT TO FIO-CMND
               PERFORM DAP-FIO-EPD
               IF FIO-STAT-OKS

                  PERFORM GET-PRV-EPD
                  PERFORM SET-CAD-EPD-REV
               ELSE
                  GO TO FIN-REV-EPD
           ELSE
               GO TO FIN-REV-EPD.

       FIN-REV-EPD.
           EXIT.

       PUT-FTRN SECTION.
       INI-PUT-FTRN.
           MOVE HOY-DHOY TO EPD-NUM-DTRN IN EPD.
           MOVE HOY-MHOY TO EPD-NUM-MTRN IN EPD.
           MOVE HOY-SHOY TO EPD-NUM-STRN IN EPD.
           MOVE HOY-AHOY TO EPD-NUM-ATRN IN EPD.
           MOVE HOY-HHOY TO EPD-HRA-HRTR IN EPD.

       FIN-PUT-FTRN.
           EXIT.

       SET-CAD-EPD-REV SECTION.
       INI-SET-CAD-EPD-REV.

           PERFORM OBT-OPD.
           PERFORM GET-CUR-AUT.

           IF FIO-STAT-OKS
                IF EPD-CAI-IOLD IN EPD NOT > SPACES OR
                   OPD-COD-RENO = WSS-S

                    MOVE FIO-DEL TO FIO-CMND
                    PERFORM DAP-FIO-CAD

                ELSE

                    MOVE EPD-COD-IOLD IN EPD TO CAD-IND-TCAD IN CAD
                    MOVE EPD-CIC-IOLD IN EPD TO CAD-CIC-ICAD IN CAD
                    MOVE FIO-MOD TO FIO-CMND
                    PERFORM DAP-FIO-CAD.


       FIN-SET-CAD-EPD-REV.
           EXIT.


       GET-CUR-AUT SECTION.
       INI-GET-CUR-AUT.

           MOVE EPD-CAI-IOPD IN EPD TO CAD-CAI-IOPD IN CAD.
           MOVE EPD-IIC-IOPD IN EPD TO CAD-IIC-IOPD IN CAD.
           MOVE WSS-AUT                 TO CAD-NUM-ILIQ IN CAD.
           MOVE 1                       TO CAD-NUM-ICAD IN CAD.
           MOVE WSS-CADKEY TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
       FIN-GET-CUR-AUT.
           EXIT.

       GET-PRV-EPD SECTION.
       INI-GET-PRV-EPD.

           SUBTRACT 1 FROM EPD-NUM-IEPD IN EPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-EPD.

       FIN-GET-PRV-EPD.
           EXIT.

       OBT-OPD SECTION.
       INI-OBT-OPD.
           MOVE FRM-CAI-IOPD IN GDG-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
                 MOVE WSS-OPDNX TO MSG-COD-MENS.

       FIN-OBT-OPD.
           EXIT.



       GDG-PTOC SECTION.
       INI-GDG-PTOC.

           IF (WSS-GLS-DGT01 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT01.
           IF (WSS-GLS-DGT02 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT02.
           IF (WSS-GLS-DGT03 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT03.
           IF (WSS-GLS-DGT04 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT04.
           IF (WSS-GLS-DGT05 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT05.
           IF (WSS-GLS-DGT06 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT06.
           IF (WSS-GLS-DGT07 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT07.
           IF (WSS-GLS-DGT08 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT08.
           IF (WSS-GLS-DGT09 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT09.
           IF (WSS-GLS-DGT10 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT10.
           IF (WSS-GLS-DGT11 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT11.
           IF (WSS-GLS-DGT12 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT12.
           IF (WSS-GLS-DGT13 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT13.
           IF (WSS-GLS-DGT14 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT14.
           IF (WSS-GLS-DGT15 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT15.
           IF (WSS-GLS-DGT16 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT16.
           IF (WSS-GLS-DGT17 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT17.
           IF (WSS-GLS-DGT18 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT18.
           IF (WSS-GLS-DGT19 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT19.
           IF (WSS-GLS-DGT20 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT20.
           IF (WSS-GLS-DGT21 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT21.
           IF (WSS-GLS-DGT22 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT22.
           IF (WSS-GLS-DGT23 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT23.
           IF (WSS-GLS-DGT24 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT24.
           IF (WSS-GLS-DGT25 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT25.
           IF (WSS-GLS-DGT26 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT26.
           IF (WSS-GLS-DGT27 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT27.
           IF (WSS-GLS-DGT28 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT28.
           IF (WSS-GLS-DGT29 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT29.
           IF (WSS-GLS-DGT30 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT30.
           IF (WSS-GLS-DGT31 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT31.
           IF (WSS-GLS-DGT32 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT32.
           IF (WSS-GLS-DGT33 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT33.
           IF (WSS-GLS-DGT34 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT34.
           IF (WSS-GLS-DGT35 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT35.
           IF (WSS-GLS-DGT36 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT36.
           IF (WSS-GLS-DGT37 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT37.
           IF (WSS-GLS-DGT38 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT38.
           IF (WSS-GLS-DGT39 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT39.
           IF (WSS-GLS-DGT40 = WSS-PTOC)
               MOVE WSS-SPC TO WSS-GLS-DGT40.

       FIN-GDG-PTOC.
           EXIT.
      *MPB-FIN
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LEE-GDD.
           PERFORM LLENAR-ANTES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI                                                 
           IF NOT FIO-STAT-OKS                                          
      *        Error inconsistencia en la eliminacion : informar        
               MOVE FIO-MENS TO FRM-MENS                                
               GO TO FIN-CMN-ELI.                                       
                                                                        
           PERFORM DEL-GDD.                                             
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-ELI.                                       
      *>>>>                                                             
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI                                                     
      *<<<< NOT (( PGM_VSI OR PGM_DB2 ) AND PGM_PU AND NOT PGM_VMS )    
      *RRM-INI 31-MAY-2002                                              
           IF GDG-IND-EST1 IN GDG NOT = '05'                            
               MOVE 'BGL' TO MSG-COD-SIST                               
               MOVE 'GDG NOELI' TO MSG-COD-MENS                         
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-ELI.                                       
                                                                        
                                                                        
       SIGUE-COMANDO-ELI.                                               
      *RRM-FIN 31-MAY-2002                                              
                                                                        
           PERFORM GAR-PRO-ELI.                                         
      *>>>>                                                             
      *>>>>                                                             
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD AND GEN_BCI                                     
      * EVA-INI  12/08                                                  
           MOVE GDG-COD-OFIC IN GDG-FLD TO WSS-COD-OFIC IN WSS-VARI.    
      * EVA-FIN  12/08                                                  
           PERFORM KEY-ALL-GDG.                                         
      * EVA-INI-AFRI/ENERO2006                                          
           IF SCR-CMND = 'MST'                                          
              PERFORM ACT-IND-GDG                                       
              IF MSG-COD-MENS > SPACES                                  
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-CMN-MOD                                      
              ELSE                                                      
                 GO TO FIN-CMN-MOD.                                     
      * EVA-FIN-AFRI/ENERO/2006                                         
      *MHM-INI 14-OCT-2003 FALTA REGULARIZAR VERSION MARGENES BCI       
      **LOP-INI 20-DIC-2002                                             
      *     IF SCR-CMND = 'ALZ'                                         
      *        PERFORM ANL-LDC-GDD                                      
      *        IF MSG-COD-MENS > SPACES                                 
      *           MOVE MSG-GLS-DESC TO FRM-MENS                         
      *           MOVE FRM-SUAR-MAL TO FRM-SUAR                         
      *           GO TO FIN-CMN-MOD.                                    
      **LOP-FIN 20-DIC-2002                                             
      *MHM-FIN 14-OCT-2003                                              
      *>>>>                                                             
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD                                                 
                                                                        
           IF NOT FIO-STAT-OKS                                          
      *        Error inconsistencia en la modificacion : informar       
               MOVE FIO-MENS TO FRM-MENS                                
               GO TO FIN-CMN-MOD.
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS                                       
      *<<<< GEN_BCI                                                     
      *EVA-INI-AFRI/FEB 2006                                            
           MOVE GDG-CAI-GTIA IN GDG-FLD TO                              
                POL-CAI-GTIA IN POL.                                    
           MOVE GDG-IIC-GTIA IN GDG-FLD TO                              
                POL-IIC-GTIA IN POL.                                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-POL.                                         
           IF FIO-STAT-OKS                                              
             IF                                                         
             ((GDG-IND-ECRS IN GDG-FLD NOT = WSS-IND-ECRS  OR           
               GDG-IND-ECRT IN GDG-FLD NOT = WSS-IND-ECRT ) AND         
              (POL-COD-ESGE IN POL = '11'))                             
                MOVE FIO-GET-KEY-UPD TO FIO-CMND                        
                PERFORM BGL-FIO-POL                                     
                MOVE '50' TO POL-COD-ESGE IN POL                        
                MOVE FIO-MOD TO FIO-CMND                                
                PERFORM BGL-FIO-POL.                                    
           MOVE '00' TO FIO-STAT.                                       
      *EVA-FIN-AFRI/FEB 2006                                            
      *PTC-INI-MAN                                                      
           IF NOT ( SCR-OFRM-SRV AND                                    
                    SCR-CMND = 'MOD' )                                  
      *PTC-FIN-MAN                                                      
      *>>>>                                                             
           IF WSS-OTRO-GDD                                              
               PERFORM MOD-GDD                                          
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'GDDMODERR' TO MSG-COD-MENS                     
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-MENS TO FRM-MENS                        
                   GO TO FIN-CMN-MOD                                    
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
           IF WSS-PRIMER-GDD                                            
               PERFORM PUT-GDD                                          
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'GDDINGERR' TO MSG-COD-MENS                     
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-MENS TO FRM-MENS                        
                   GO TO FIN-CMN-MOD.                                   
      *                                                                 
           IF SCR-CMND = 'CAN'                                          
              IF GDG-IND-EST1 IN GDG-FLD = '20'                         
                 MOVE 'CANOK ' TO MSG-COD-MENS                          
              ELSE                                                      
                 MOVE 'CANOKTRAM ' TO MSG-COD-MENS.                     
      *                                                                 
           IF SCR-CMND = 'CAN'                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS.                           
      *>>>>                                                             
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING                                                 
           MOVE SPACES TO GDG-GLS-FLAG IN GDG.                          
           MOVE SPACES TO GDG-MSC-TACC IN GDG.                          
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *     MOVE SPACES TO GDG-CIC-UING IN GDG.
           MOVE SCR-USER TO GDG-CIC-UING IN GDG.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS                         
           MOVE 'I'    TO GDG-MSC-STAT IN GDG.                          
      *<<<< GEN_BCI                                                     
      *PTC-INI-MAN                                                      
           IF SCR-OFRM-SRV AND                                          
              SCR-CCPP = 'ING'                                          
              MOVE PTC-GDG-TYPE TO QUE-TYPE                             
              MOVE TSK-TERM-ALF TO QUE-TERM                             
              MOVE PTC-GDG-LENG TO QUE-LITM                             
              MOVE 1            TO  QUE-NITM                            
              MOVE QUE-GET      TO QUE-CMND                             
              PERFORM GNS-PRO-QUE                                       
              IF QUE-STAT = QUE-STAT-OKS                                
                  MOVE QUE-ITEM TO PTC-GDG-ITEM                         
                  MOVE PTC-GDG-GDG-CAI-IGAR TO GDG-CAI-GTIA IN GDG-FLD  
                  MOVE PTC-GDG-GDG-IIC-IGAR TO GDG-IIC-GTIA IN GDG-FLD  
                  MOVE QUE-DEL      TO QUE-CMND                         
                  PERFORM GNS-PRO-QUE.                                  
      *PTC-FIN-MAN                                                      
      *>>>>                                                             
           PERFORM GET-FHOY.                                            
           IF SCR-CCPP = 'ING' OR SCR-CMND = 'COP'                      
               MOVE 'I'      TO GDG-MSC-TACC    IN GDG                  
               MOVE HOY-FHOY TO GDG-FEC-FING IN GDG                     
           ELSE                                                         
               MOVE 'M'      TO GDG-MSC-TACC IN GDG.                    
                                                                        
           MOVE SPACES TO GDG-COD-EST2 IN GDG.                          
           MOVE SPACES TO GDG-IND-GTAC IN GDG.                          
           MOVE SPACES TO GDG-IND-RALZ IN GDG.                          
           MOVE SPACES TO GDG-IND-EST1 IN GDG.                          
           MOVE SPACES TO GDG-IND-EGDG IN GDG.                          
           MOVE SPACES TO GDG-IND-EGDD IN GDG.                          
           MOVE SPACES TO GDG-IND-EGES IN GDG.                          
           MOVE SPACES TO GDG-IND-EGLE IN GDG.                          
           MOVE SPACES TO GDG-IND-EGDO IN GDG.                          
           MOVE SPACES TO GDG-IND-EGSE IN GDG.                          
           MOVE SPACES TO GDG-IND-EGVT IN GDG.                          
           MOVE SPACES TO GDG-IND-EGTP IN GDG.                          
           MOVE SPACES TO GDG-IND-EGUB IN GDG.                          
           MOVE SPACES TO GDG-IND-EGAP IN GDG.                          
           MOVE SPACES TO GDG-IND-EGIN IN GDG.                          
           MOVE SPACES TO GDG-IND-EGSI IN GDG.                          
           MOVE SPACES TO GDG-IND-EGDP IN GDG.                          
           MOVE SPACES TO GDG-IND-TESP IN GDG.                          
           MOVE ZEROES TO GDG-FEC-FALZ IN GDG.                          
           MOVE ZEROES TO GDG-COD-TSCN IN GDG.                          
           MOVE SPACES TO GDG-GLS-DISP IN GDG.                          
      *<<<< GEN_BCI                                                     
           PERFORM RET-ALL-GDG.                                         
      *>>>>                                                             
      *FLB CST 22-09-1993                                               
       GET-CIC-GDG.                                                     
      *FLB CST 22-09-1993                                               
           IF GDG-IIC-GTIA IN GDG-FLD NOT > ZEROES                      
              PERFORM BUS-CIC-GAR                                       
      *MHM-INI 21-AGO-2003                                              
      *        MOVE GAR-CIC-OFIC IN CMA-VARI TO CIC-CAI-ICIC IN CIC     
              MOVE GDG-CAI-GTIA IN GDG-FLD TO CIC-CAI-ICIC IN CIC       
      *MHM-FIN 21-AGO-2003                                              
              MOVE CIC-GET TO CIC-CMND                                  
              PERFORM PRO-CIC                                           
              IF CIC-STAT NOT = CIC-STAT-OKS                            
                   MOVE CIC-MENS TO FRM-MENS                            
                   MOVE FIO-STAT-NEX TO FIO-STAT                        
                   GO TO FIN-CMN-ING                                    
              ELSE                                                      
                   MOVE CIC-CAI-ICIC TO GDG-CAI-GTIA IN GDG             
                   MOVE CIC-IIC-ICIC TO GDG-IIC-GTIA IN GDG             
      *<<<<                                                             
      *FLB CST 22-09-1993                                               
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM BGL-FIO-GDG                                  
                   IF FIO-STAT-OKS                                      
                       GO TO GET-CIC-GDG                                
                   ELSE                                                 
      *FLB CST 22-09-1993                                               
      *>>>>                                                             
                   MOVE GDG-CAI-GTIA IN GDG TO GDG-CAI-GTIA IN GDG-FLD  
                   MOVE GDG-IIC-GTIA IN GDG TO GDG-IIC-GTIA IN GDG-FLD  
                   MOVE 'GNS' TO MSG-COD-SIST                           
                   MOVE 'INGYES' TO MSG-COD-MENS                        
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE CIC-CAI-ICIC TO WSS-CAI-MEN2                    
                   MOVE CIC-NUM-ICIC TO WSS-NUM-MEN2 IN WSS-FRM-MEN2    
                   MOVE WSS-FRM-MEN2 TO FRM-MEN2.                       
      *AFRI-INI/DIC-2007                                                
                   MOVE CIC-NUM-ICIC TO GDG-IIC-NGTA.                   
                   MOVE GDG-IIC-NGTA TO GOR-NUM-CORR.                   
      *AFRI-FIN/DIC-2007                                                
                                                                        
      *>>>>                                                             
*% END
*% IF CMN_ING
      *<<<< CMN_ING                                                     
      *<<<< EVP-INI CMN_ING                                             
      *<<<< FMT_CHI                                                     
           IF NOT ( DBC-IND-ICLI IN GDG-FLD = 'M' OR                    
      *>>>>                                                             
               ( CNE-DBC-CAI-ICLI NOT > SPACES AND                      
                 CNE-DBC-IIC-ICLI NOT > ZEROES )                        
                  )                                                     
      *<<<< GEN_BCI                                                     
                AND                                                     
      *       no se ingreso el cliente en GAR-PRO-IDP                   
              NOT ( CMA-IND-DAP IN CMA-VARI = 'S' AND                   
                    FRM-COD-DEUD IN GDG-FLD = 'S' )                     
      *>>>>                                                             
               PERFORM PUT-GDD                                          
               IF NOT FIO-STAT-OKS                                      
                   GO TO FIN-CMN-ING.                                   
                                                                        
           MOVE GDG-IND-EST1 IN GDG TO GDG-COD-ESTA IN GDG.             
      *<<<< FMT_CHI                                                     
      *AFRI-INI/JUL2004                                                 
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'VGA'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'GDGFMUTUO'  TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS AND TAB-IND-VIGE = 'S'                       
              MOVE TAB-GLS-DATA             TO WSS-GLS-TGAR             
              MOVE GDG-TIP-CGTA IN GDG-FLD  TO WSS-TIP-CGTA             
              MOVE GDG-STP-CGTA IN GDG-FLD  TO WSS-STP-CGTA             
              IF( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(1) AND        
                 WSS-IND-TGAR(1) > SPACES) OR                           
                ( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(2) AND        
                 WSS-IND-TGAR(2) > SPACES) OR                           
                ( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(3) AND        
                 WSS-IND-TGAR(3) > SPACES) OR                           
                ( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(4) AND        
                 WSS-IND-TGAR(4) > SPACES) OR                           
                ( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(5) AND        
                 WSS-IND-TGAR(5) > SPACES) OR                           
                ( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(6) AND        
                 WSS-IND-TGAR(6) > SPACES) OR                           
                ( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(7) AND        
                 WSS-IND-TGAR(7) > SPACES) OR                           
                ( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(8) AND        
                 WSS-IND-TGAR(8) > SPACES) OR                           
                ( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(9) AND        
                 WSS-IND-TGAR(9) > SPACES) OR                           
                ( WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(10) AND       
                 WSS-IND-TGAR(10) > SPACES)                             
                  PERFORM GRABAR-GAP                                    
      *AFRI-DIC2004                                                     
                  IF NOT FIO-STAT-OKS                                   
                      GO TO FIN-CMN-ING                                 
                  ELSE                                                  
                      MOVE 'S' TO GDG-IND-EGAP IN GDG.                  
      *AFRI-DIC2004                                                     
                                                                        
                                                                        
      *AFRI-FIN/JUL2004                                                 
           IF DBC-NUM-ICLI IN GDG-FLD NOT = ZEROES                      
      *>>>>                                                             
               MOVE 'S' TO GDG-IND-EGDD IN GDG.                         
                                                                        
      *>>>> EVP-FIN CMN_ING                                             
      *<<<<                                                             
           IF CMA-IND-DAP IN CMA-VARI = 'S'                             
               MOVE SPACES TO MSG-COD-MENS                              
               MOVE GDG-CAI-GTIA IN GDG-FLD TO GAR-CAI-GTIA             
                                               IN CMA-VARI              
               MOVE GDG-IIC-GTIA IN GDG-FLD TO GAR-IIC-GTIA             
                                               IN CMA-VARI              
               MOVE FRM-CAI-IOPD IN GDG-FLD TO FRM-CAI-IOPD             
                                               IN CMA-VARI              
               MOVE FRM-IIC-IOPD IN GDG-FLD TO FRM-IIC-IOPD             
                                               IN CMA-VARI              
               PERFORM GAR-PRO-IDP                                      
               IF MSG-COD-MENS > SPACES                                 
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MEN1                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-CMN-ING                                    
               ELSE                                                     
                   MOVE 1   TO GDG-COD-TSCN IN GDG                      
                   MOVE 'S' TO GDG-IND-EGDO IN GDG                      
                   MOVE 'S' TO GDG-IND-EGVT IN GDG.                     
      *>>>>                                                             
      *>>>>                                                             
      *EVA-AFRI/ABR2007                                                 
           MOVE GDG-NUM-IPRO IN GDG-FLD TO GDG-NUM-IPRO IN GDG.         
           MOVE GDG-VRF-IPRO IN GDG-FLD TO GDG-VRF-IPRO IN GDG.         
           MOVE GDG-IND-IPRO IN GDG-FLD TO GDG-IND-IPRO IN GDG.         
           MOVE GDG-GLS-IPRO IN GDG-FLD TO GDG-GLS-IPRO IN GDG.         
           MOVE GDG-GLS-NOMP IN GDG-FLD TO GDG-GLS-NOMP IN GDG.         
      *FIN-AFRI/ABR2007                                                 
      *    IF SCR-HDR-MRCA = 'BCS'                                      
      *        PERFORM GDG-GORI.                                        
      *ALD     MOVE GOR-NUM-CALC TO FRM-MEN1                            
      *ALD     MOVE GOR-NUM-DIGV TO FRM-MEN2                            
      *ALD     MOVE FIO-STAT-NEX TO FIO-STAT                            
      *ALD     GO TO FIN-CMN-ING.                                       
      *>>>>
*% END                                                                        
*% IF FIN_CMN_ING
      *<<<< LDC_SI AND PGM_MVS AND FIN_CMN_ING                          
      *<<<< GEN_BCI                                                     
      * PTC-INI-MAN                                                     
           IF SCR-OFRM-SRV AND                                          
              FIO-STAT-OKS                                              
               MOVE TSK-TERM-ALF TO WXGDG-FIGA-COD-TERM                 
               MOVE WXGDG-FIGA-COLA TO QUE-COLA                         
               MOVE WXGDG-FIGA-LITM TO QUE-LITM                         
               MOVE GDG-KEY-IGDG IN GDG TO QUE-ITEM                     
               MOVE QUE-PUT TO QUE-CMND                                 
               PERFORM GNS-PRO-QUE.                                     
      * PTC-FIN-MAN                                                     
      *>>>>                                                             
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
                PERFORM EGR-FPEN-CIC.                                   
      *>>>>                                                             
      *<<<< EVP-INI FINCMNING                                           
      *<<<< FIN_CMN_ING                                                 
           IF NOT FIO-STAT-OKS                                          
      *        Error inconsistencia en el ingreso : informar            
               MOVE FIO-MENS TO FRM-MENS                                
               GO TO FIN-CMN-ING.                                       
      *>>>>                                                             
      *>>>> EVP-FIN FINCMNING                                           
      *<<<< GEN_BCI                                                     
      *PTC-INI-MAN                                                      
           IF SCR-OFRM-SRV AND FIO-STAT-OKS AND SCR-IERR = 'N'          
              MOVE WSX-NOM-TSGDG  TO QUE-COLA                           
              MOVE QUE-DEL        TO QUE-CMND                           
              PERFORM GNS-PRO-QUE                                       
              MOVE GDG-KEY-IGDG IN GDG TO WSX-CIC-NGAR                  
              MOVE WSX-NOM-TSGDG  TO QUE-COLA                           
              MOVE WSX-LEN-TSGDG  TO QUE-LITM                           
              MOVE WSX-TAB-GDG    TO QUE-ITEM                           
              MOVE QUE-PUT        TO QUE-CMND                           
              PERFORM GNS-PRO-QUE.                                      
       FIN-CMN-ING-2. 
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *>>>>                                                             
*% END                                                                        
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC                                                 
      *<<<< GEN_BCI                                                     
      *AFRI-INI/MAY-2005                                                
           IF SCR-CMND = 'ALC'                                          
               MOVE GDG-CAI-GTIA IN GDG-FLD TO GDG-CAI-GTIA IN GDG      
               MOVE GDG-IIC-GTIA IN GDG-FLD TO GDG-IIC-GTIA IN GDG      
               MOVE FIO-GET-KEY-UPD  TO FIO-CMND                        
               PERFORM BGL-FIO-GDG                                      
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'S' TO SCR-IERR                                 
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   MOVE 'GDG   NOEXI'   TO MSG-COD-MENS                 
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   GO TO FIN-CMN-ACC                                    
               ELSE                                                     
                    MOVE '07'  TO GDG-IND-EST1 IN GDG                   
                    MOVE '005' TO GDG-COD-EST1 IN GDG                   
                    MOVE FIO-MOD TO FIO-CMND                            
                    PERFORM BGL-FIO-GDG                                 
                    IF FIO-STAT-OKS                                     
      *                MOVE 'S' TO SCR-IERR                             
                       MOVE 'BGL' TO MSG-COD-SIST                       
                       MOVE 'GDG   ALC'   TO MSG-COD-MENS               
                       PERFORM GET-MSG                                  
                       MOVE MSG-GLS-DESC TO FRM-MENS                    
                       GO TO FIN-CMN-ACC.                               
      *AFRI-FIN/MAY-2005                                                
           IF ((SCR-CMND = 'AGA' OR                                     
              SCR-CMND = 'ACE') AND GAR-IND-GTAC IN CMA-VARI NOT = 'S') 
               MOVE GDG-CAI-GTIA IN GDG-FLD TO GSO-CAI-GTIA IN GSO      
               MOVE GDG-IIC-GTIA IN GDG-FLD TO GSO-IIC-GTIA IN GSO      
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GSO                                      
               IF (FIO-STAT-OKS AND GSO-COD-ESGA IN GSO < '07' OR       
                   FIO-STAT-OKS AND GSO-COD-ESGA IN GSO = '11')         
                   MOVE 'S' TO SCR-IERR                                 
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   MOVE 'GDG NOAGAGSO' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   GO TO FIN-CMN-ACC.                                   
                                                                        
           IF NOT (SCR-CMND = 'AGA' OR SCR-CMND = 'ACE')                
               GO TO CNT-SIN-GAP.                                       
                                                                        
      * EVA-INI  25/06/2009   TIPOS DE GARANTIA SIN GLE                 
      * EVA                                                             
      *    IF SCR-CMND = 'AGA'                                          
      *       MOVE 'NO'         TO PTT-EXT-PNTL.                        
      *       MOVE GDG-COD-CGTA IN GDG TO PTT-COD-PTLL.                 
      *       MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.               
      *       MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.                 
      *       MOVE 'BGLGLEGAP'  TO TAB-COD-CTAB IN TAB.                 
      *       MOVE FIO-GET-KEY TO FIO-CMND.                             
      *       PERFORM GNS-FIO-TAB.                                      
      *       IF NOT ( FIO-STAT-OKS AND                                 
      *             TAB-IND-VIGE IN TAB = 'S')                          
      *            GO TO FIN-CMN-ACC.                                   
      *       MOVE TAB-GLS-DATA IN TAB TO PTT-GLS-DATA.                 
      *       MOVE 'SI'         TO PTT-EXT-PNTL                         
      *       PERFORM BUS-PTT.                                          
      *       IF PTT-EXT-PNTL = 'SI'                                    
      *          GO TO CNT-SIN-GAP.                                     
                                                                        
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'EDL'               TO TAB-COD-TTAB IN TAB.             
           MOVE GDG-TIP-CGTA IN GDG-FLD  TO WSS-TIP-CGTA.               
           MOVE GDG-STP-CGTA IN GDG-FLD  TO WSS-STP-CGTA.               
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')              
               GO TO CNT-SIN-GAP.                                       
      * EVA-FIN  25/06/2009   TIPOS DE GARANTIA SIN GLE                 
                                                                        
      *MHM-INI 20-DIC-2004                                              
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'VGD'        TO TAB-COD-TTAB IN TAB.                    
           MOVE GDG-TIP-CGTA IN GDG-FLD  TO WSS-TIP-CGTA.               
           MOVE GDG-STP-CGTA IN GDG-FLD  TO WSS-STP-CGTA.               
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS AND TAB-IND-VIGE = 'S'                       
               GO TO CNT-DAP.                                           
      *MHM-FIN 20-DIC-2004                                              
      *MHM-INI 03-DIC-2003                                              
           MOVE SPACES TO WSS-IND-EGAP IN WSS-VARI.                     
           MOVE SPACES TO WSS-IND-GAPB IN WSS-VARI.                     
      *MHM-FIN 03-DIC-2003                                              
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GAP-CAI-GTIA IN GAP.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GAP-IIC-GTIA IN GAP.         
           MOVE ZEROES                  TO GAP-COD-PACR IN GAP.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-LEE-GAP.                                                     
           PERFORM BGL-FIO-GAP.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GAP-CAI-GTIA IN GAP = GDG-CAI-GTIA IN GDG-FLD AND         
              GAP-IIC-GTIA IN GAP = GDG-IIC-GTIA IN GDG-FLD )           
               GO TO CNT-SIN-GAP.                                       
      *MHM-INI 03-DIC-2003                                              
           MOVE 'S' TO WSS-IND-EGAP IN WSS-VARI.                        
      *MHM-FIN 03-DIC-2003                                              
           IF GAP-IND-ESBA IN GAP = 'S'                                 
      *MHM-INI 03-DIC-2003                                              
               MOVE 'S' TO WSS-IND-GAPB IN WSS-VARI                     
      *MHM-FIN 03-DIC-2003                                              
               MOVE GAP-CAI-GTIA IN GAP TO GLE-CAI-GTIA IN GLE          
               MOVE GAP-IIC-GTIA IN GAP TO GLE-IIC-GTIA IN GLE          
               MOVE GAP-COD-PACR IN GAP TO GLE-COD-PACR IN GLE          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GLE                                      
               IF NOT FIO-STAT-OKS                                      
                  MOVE 'S' TO SCR-IERR                                  
                  MOVE 'BGL' TO MSG-COD-SIST                            
                  MOVE 'GDG NOAGAGLE' TO MSG-COD-MENS                   
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  GO TO FIN-CMN-ACC.                                    
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-LEE-GAP.                                           
                                                                        
       CNT-SIN-GAP.                                                     
      *MHM-INI 03-DIC-2003                                              
           IF WSS-IND-EGAP IN WSS-VARI = 'S' AND                        
              WSS-IND-GAPB IN WSS-VARI NOT = 'S'                        
               MOVE 'S' TO SCR-IERR                                     
               MOVE 'BGL' TO MSG-COD-SIST                               
               MOVE 'GDG GAPNOBCO' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-ACC.                                       
                                                                        
      *MHM-FIN 03-DIC-2003                                              
      *MHM-INI 20-DIC-2004                                              
       CNT-DAP.                                                         
      *MHM-FIN 20-DIC-2004                                              
      *MHM-INI 21-OCT-2003                                              
           MOVE SPACES TO VCG-FEC-FVTO IN VCG-VARI.                     
           MOVE SCR-CMND    TO VCG-CMND IN VCG-VARI.                    
           IF GDG-COD-LGTA IN GDG-FLD NOT = 'E'                         
               GO TO CNT-NO-ESPECIFICA.                                 
                                                                        
           IF NOT (SCR-CMND = 'AGA' OR SCR-CMND = 'ACE')                
               GO TO CNT-NO-ESPECIFICA.                                 
                                                                        
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAG-COD-TOPE IN TAG.         
           MOVE GDG-STP-CGTA IN GDG-FLD TO TAG-COD-SOPE IN TAG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.                                         
           IF TAG-IND-SVTO IN TAG NOT = 'S'                             
               GO TO CNT-NO-ESPECIFICA.                                 
                                                                        
           MOVE ZEROES TO WSS-NUM-SVTO IN WSS-VARI.                     
           MOVE ZEROES TO WSS-NUM-AVTO IN WSS-VARI.                     
           MOVE ZEROES TO WSS-NUM-MVTO IN WSS-VARI.                     
           MOVE ZEROES TO WSS-NUM-DVTO IN WSS-VARI.                     
                                                                        
                                                                        
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GES-CAI-GTIA IN GES.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GES-IIC-GTIA IN GES.         
           MOVE ZEROES              TO GES-NUM-IGES IN GES.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-LEE-GES-AGA.                                                 
           PERFORM BGL-FIO-GES.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GES-CAI-GTIA IN GES = GDG-CAI-GTIA IN GDG-FLD AND         
              GES-IIC-GTIA IN GES = GDG-IIC-GTIA IN GDG-FLD )           
      *MHM-INI 21-OCT-2003                                              
              IF FIO-STAT-OKS OR FIO-STAT-EOF                           
                 MOVE FIO-END-BRW TO FIO-CMND                           
                 PERFORM BGL-FIO-GES                                    
                 GO TO CNT-NO-ESPECIFICA                                
              ELSE                                                      
      *MHM-FIN 21-OCT-2003                                              
               GO TO CNT-NO-ESPECIFICA.                                 
                                                                        
           MOVE GES-CAI-IOPC IN GES TO DLC-CAI-IOPC IN DLC.             
           MOVE GES-IIC-IOPC IN GES TO DLC-IIC-IOPC IN DLC.             
           MOVE GES-NUM-IDLC IN GES TO DLC-NUM-IDLC IN DLC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-DLC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL' TO MSG-COD-SIST                               
               MOVE 'DLC    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-ACC.                                       
                                                                        
           IF DLC-FEC-FMAV IN DLC > WSS-FEC-FVTO IN WSS-VARI            
              MOVE DLC-FEC-FMAV IN DLC TO WSS-FEC-FVTO IN WSS-VARI      
              MOVE WSS-NUM-SVTO TO VCG-NUM-SVTO IN VCG-VARI             
              MOVE WSS-NUM-AVTO TO VCG-NUM-AVTO IN VCG-VARI             
              MOVE WSS-NUM-MVTO TO VCG-NUM-MVTO IN VCG-VARI             
              MOVE WSS-NUM-DVTO TO VCG-NUM-DVTO IN VCG-VARI.            
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-LEE-GES-AGA.                                       
                                                                        
       CNT-NO-ESPECIFICA.                                               
      *MHM-FIN 21-OCT-2003                                              
      *>>>>                                                             
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GAR-CAI-GTIA IN CMA-VARI.    
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GAR-IIC-GTIA IN CMA-VARI.    
      * EVA-INI   07-10-08                                              
      *    IF SCR-HDR-MRCA = 'BCS'                                      
      *       MOVE 'S' TO VCG-MRCA                                      
      *    ELSE                                                         
      *       MOVE 'N' TO VCG-MRCA.                                     
      * EVA-FIN   07-10-08         

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDG-CAI-GTIA IN GDG.    
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDG.  

           PERFORM LEE-GDD.
           PERFORM LLENAR-ANTES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

           PERFORM GAR-PRO-VCG.                                         
           IF MSG-COD-MENS NOT = 'GAR    CPLOK'                         
      *<<<< GEN_BCI                                                     
      *FLB CST  17-FEB-1995                                             
               MOVE FIO-BCK-OUT TO FIO-CMND                             
               PERFORM BGL-FIO-GDG                                      
               GO TO FIN-CMN-ACC.

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDG-CAI-GTIA IN GDG.    
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDG.  

           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS 
                                                           
           IF FRM-IIC-IOPD IN GDG-FLD > ZEROES                          
               MOVE FRM-CAI-IOPD IN GDG-FLD TO OPD-CAI-IOPD IN OPD      
               MOVE FRM-IIC-IOPD IN GDG-FLD TO OPD-IIC-IOPD IN OPD      
               MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
               PERFORM DAP-FIO-OPD
      *OGB-INI 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
               IF NOT FIO-STAT-OKS
                  PERFORM BCK-OUT
                  MOVE WSS-CTE-MSG1 TO MSG-COD-MENS
                  MOVE WSS-CTE-BGL  TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
      *OGB-FIN 11-MAR-2015 ACTIVACION NO BLOQUEA DAP                                      
               MOVE 'S' TO OPD-COD-GARA IN OPD                          
               MOVE FIO-MOD TO FIO-CMND                                 
      *OGB-INI 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
      *        PERFORM DAP-FIO-OPD.
               PERFORM DAP-FIO-OPD
      *MPB-INI  03-NOV-2017 Correccion Liquidacion DPI
               MOVE WSS-S TO WSS-OPDMOD


               IF NOT FIO-STAT-OKS

                  MOVE WSS-N TO WSS-OPDMOD

      *MPB-FIN
                  PERFORM BCK-OUT
                  MOVE WSS-CTE-MSG1 TO MSG-COD-MENS
                  MOVE WSS-CTE-BGL  TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-CMN-ACC.
      *MPB-INI  03-NOV-2017 Correccion Liquidacion DPI
           IF FRM-IIC-IOPD IN GDG-FLD > ZEROES AND
              WSS-OPDMOD = WSS-S
                  PERFORM REV-EPD.
      *MPB-FIN
      *OGB-FIN 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
      *FLB CST  17-FEB-1995                                             
      *MHM-INI 14-AUG-2003                                              
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GSO-CAI-GTIA IN GSO.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GSO-IIC-GTIA IN GSO.         
           MOVE 'GSO-KEY-IGDG' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO ERR-CMN-ACC.                                       
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM BGL-FIO-GSO.                                         
           MOVE '10' TO GSO-COD-ESGA IN GSO.                            
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO ERR-CMN-ACC.                                       
                                                                        
           MOVE GSO-NUM-SBGL IN GSO TO GSL-NUM-SBGL IN GSL.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSL.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO ERR-CMN-ACC.                                       
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM BGL-FIO-GSL.                                         
           MOVE '10' TO GSL-COD-ESOL IN GSL.                            
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM BGL-FIO-GSL.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO ERR-CMN-ACC.                                       
                                                                        
       ERR-CMN-ACC.                                                     
      *MHM-FIN 14-AUG-2003                                              
           GO TO FIN-CMN-ACC.                                           
      *>>>>
*% END 
*% IF INI_RET_STT_GDG
      *<<<<
           GO TO FIN-RET-STT-GDG.
      *>>>>
*% END
*% IF FIN_SCR_GCNF
      *<<<< LDC_SI AND PGM_MVS AND (FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_
           IF FRM-FFLD = FRM-FFLD-PF3 AND                               
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
      *       AND SCR-IND-COL = 'C'                                     
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
*% END
*% IF INI_PRO_CONF
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
               IF SCR-CONF NOT > SPACES                                 
                   GO TO FIN-PRO-CONF.                                  
      *<<<< ISP-FIN  24-JAN-1996 11:35:48                               
      *<<<< LDC_SI AND PGM_MVS AND INI_PRO_CONF                         
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               MOVE 'F10GDGSINFIA' TO MSG-COD-MENS                      
               PERFORM MSG-PF10.                                        
      *>>>>                                                             
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD                                                     
      *<<<< GEN_BCI                                                     
      *CGL-INI 07-05-2003                                               
           PERFORM GET-FHOY.                                            
           MOVE HOY-FHOY TO GDG-FEC-FTRN IN GDG.                        
           MOVE HOY-HHOY TO GDG-HRA-HRTR IN GDG.                        
           IF SCR-CCPP = 'ING'                                          
              OR SCR-CMND = 'COP'                                       
               MOVE 'I'      TO GDG-MSC-TACC IN GDG                     
               MOVE HOY-FHOY TO GDG-FEC-FING IN GDG                     
               MOVE SCR-USER TO GDG-CIC-UING IN GDG                     
           ELSE                                                         
               MOVE SCR-USER TO GDG-COD-ATRN IN GDG                     
               MOVE 'M'      TO GDG-MSC-TACC IN GDG.                    
                                                                        
      *MPB-INI 31-ENE-2018 LIMPIEZA CAMPO COD-OTRN
           MOVE SCR-OTRN     TO GDG-COD-OTRN  IN GDG.                   
           IF SCR-OFRM-SRV
               MOVE SCR-ORIG TO GDG-COD-OTRN  IN GDG
           ELSE
               IF NOT SCR-OFRM-SRV
                   MOVE SPACES TO GDG-COD-OTRN IN GDG.


      *MPB-FIN
           IF SCR-CMND NOT = 'ALZ'                                      
               GO TO SIG-FIN-CMN-MOD.                                   
                                                                        
      *<<<< PGM_CHI                                                     
      *DAD ini  16-JAN-1995                                             
           IF CMA-IND-DAP IN CMA-VARI = 'S'                             
      *    IF CMA-IND-DAP IN CMA-VARI = 'S' AND                         
      *       GDG-FEC-ING-SIS IN GDG > '19950115'                       
      *DAD fin  16-JAN-1995                                             
               PERFORM BUS-GDO-OPD                                      
               IF MSG-COD-MENS = SPACES                                 
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND                     
                   PERFORM DAP-FIO-OPD                                  
                   MOVE 'N' TO OPD-COD-GARA IN OPD                      
                   MOVE FIO-MOD TO FIO-CMND                             
                   PERFORM DAP-FIO-OPD                                  
                   IF NOT FIO-STAT-OKS                                  
      *EVA-AFRI/ABR2007                                                 
                       PERFORM GET-MSG                                  
      *FIN-AFRI/ABR2007                                                 
                       MOVE FIO-MENS TO FRM-MENS                        
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                       GO TO FIN-CMN-MOD                                
                   ELSE                                                 
                       NEXT SENTENCE                                    
               ELSE                                                     
      *RVM-CST-INI 1-APR-1996                                           
                   IF MSG-COD-MENS = 'OPD    NEX'    AND                
                      SCR-CMND = 'ALZ'               AND                
                      WSS-ALZ-DAP IN WSS-VARI = 'S'                     
                       PERFORM GET-MSG                                  
                       MOVE MSG-GLS-DESC TO FRM-MEN2                    
                       MOVE SPACES TO MSG-COD-MENS                      
                   ELSE                                                 
                   IF MSG-COD-MENS = 'OPD    NOVIG'  AND                
                      SCR-CMND = 'ALZ'               AND                
                      WSS-ALZ-DAP IN WSS-VARI = 'S'                     
                       IF OPD-COD-STAT IN OPD = 'L'                     
      *RVM-CST-INI 16-APR-1996                                          
                           MOVE FIO-GET-KEY-UPD TO FIO-CMND             
                           PERFORM DAP-FIO-OPD                          
                           MOVE 'N' TO OPD-COD-GARA IN OPD              
                           MOVE FIO-MOD TO FIO-CMND                     
                           PERFORM DAP-FIO-OPD                          
      *RVM-CST-FIN 16-APR-1996                                          
      *OGB-INI 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
                           IF FIO-STAT-OKS
      *OGB-FIN 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
                              MOVE 'OPD    YALIQ' TO MSG-COD-MENS          
                              PERFORM GET-MSG                              
                              MOVE MSG-GLS-DESC TO FRM-MEN2                
                              MOVE SPACES TO MSG-COD-MENS                  
      *OGB-INI 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
                           ELSE
                              PERFORM BCK-OUT
                              MOVE WSS-CTE-MSG2 TO MSG-COD-MENS
                              MOVE WSS-CTE-BGL  TO MSG-COD-SIST
                              PERFORM GET-MSG
                              MOVE MSG-GLS-DESC TO FRM-MENS
                              MOVE FRM-SUAR-MAL TO FRM-SUAR
                              GO TO FIN-CMN-MOD
      *OGB-FIN 11-MAR-2015 ACTIVACION NO BLOQUEA DAP
                       ELSE                                             
                           MOVE SPACES TO MSG-COD-MENS                  
                   ELSE                                                 
      *RVM-CST-FIN 1-APR-1996                                           
      *FLB CST  21-FEB-1995                                             
                   IF MSG-COD-MENS NOT = 'OPD    NOVIG'                 
                       PERFORM GET-MSG                                  
                       MOVE MSG-GLS-DESC TO FRM-MENS                    
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                       GO TO FIN-CMN-MOD                                
                   ELSE                                                 
                       MOVE SPACES TO MSG-COD-MENS.                     
      *FLB CST  21-FEB-1995 FIN                                         
      *>>>>                                                             
                                                                        
      *ALD-ADA-INI/08112001                                             
           MOVE GDG-TIP-CGTA IN GDG TO TAG-COD-TOPE IN TAG.             
           MOVE GDG-STP-CGTA IN GDG TO TAG-COD-SOPE IN TAG.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.                                         
           IF FIO-STAT-OKS                                              
      *INI-AFRI/MAY-2005                                                
      *         IF TAG-IND-CTBL IN TAG = 'N'                            
              IF TAG-IND-CTBL IN TAG = 'N'                              
      *EVA-AFRI/JUL2007    CBTL NOVA                                    
      *          GDG-CAI-GTIA IN GDG = '0800'                           
      *FIN-AFRI/JUL2007    CBTL NOVA                                    
      *FIN-AFRI/MAY-2005                                                
                   GO TO CON-SIN-GRB-GMO.                               
      *ALD-ADA-FIN/08112001                                             
           MOVE HOY-FHOY TO GMO-FEC-FMOV IN GMO.                        
           MOVE HOY-HHOY TO GMO-HRA-HMOV IN GMO.                        
      *FLB CST  13-OCT-1993                                             
           MOVE SCR-OTRN TO GMO-TML-TMOV IN GMO.                        
           MOVE SCR-USER TO GMO-CIC-UING IN GMO.                        
                                                                        
           MOVE HOY-FHOY TO GMO-FEC-FING IN GMO.                        
           MOVE GDG-CAI-GTIA IN GDG TO GMO-CAI-GTIA IN GMO.             
           MOVE GDG-IIC-GTIA IN GDG TO GMO-IIC-GTIA IN GMO.             
           MOVE ZEROES              TO GMO-NUM-IMOV IN GMO.             
           MOVE '3'                 TO GMO-COD-MOVI IN GMO.             
           MOVE GDG-COD-TSCN IN GDG TO GMO-NUM-TASN IN GMO.             
           MOVE 'GDG001'            TO GMO-COD-CMPO IN GMO.             
           MOVE 'N'                 TO GMO-IND-VALO IN GMO.             
           MOVE 'S'                 TO GMO-IND-CLVE IN GMO.             
           MOVE SPACES              TO GMO-GLS-CMPA IN GMO.             
           MOVE ZEROES              TO GMO-SGV-CMPA IN GMO.             
           MOVE GDG-IND-EST1 IN GDG TO GMO-COD-NCLV IN GMO.             
           MOVE SPACES              TO GMO-GLS-NCMP IN GMO.             
           MOVE ZEROES              TO GMO-SGV-NCMP IN GMO.             
           MOVE GDG-COD-OFIC IN GDG TO GMO-COD-OFMV IN GMO.             
           MOVE SPACES              TO GMO-COD-CLVA IN GMO.             
           MOVE SPACES              TO GMO-COD-TMOV IN GMO.             
           MOVE SPACES              TO GMO-GLS-DISP IN GMO.             
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM BGL-FIO-GMO.                                         
      *ALD-ADA-INI/08112001                                             
       CON-SIN-GRB-GMO.                                                 
      *ALD-ADA-FIN/08112001                                             
                                                                        
       SIG-FIN-CMN-MOD.                                                 
      *>>>>                                                             
      *CGL-FIN 07-05-2003                                               
      *>>>>                                                             
      *>>>>                                                             
      *EVA-AFRI/AB2007                                                  
           MOVE GDG-NUM-IPRO IN GDG-FLD TO GDG-NUM-IPRO IN GDG.         
           MOVE GDG-VRF-IPRO IN GDG-FLD TO GDG-VRF-IPRO IN GDG.         
           MOVE GDG-IND-IPRO IN GDG-FLD TO GDG-IND-IPRO IN GDG.         
           MOVE GDG-GLS-IPRO IN GDG-FLD TO GDG-GLS-IPRO IN GDG.         
           MOVE GDG-GLS-NOMP IN GDG-FLD TO GDG-GLS-NOMP IN GDG.         
      *FIN-AFRI/ABR2007                                                 
      *>>>>
*% END
*% IF CMN_MOD_RET
      *<<<< EVP-INI CMNMODRET 
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LEE-GDD.
           PERFORM LLENAR-ANTES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS                                        
      *EVA-INI-AFRI/FEB 2006                                            
           MOVE GDG-IND-ECRS IN GDG TO WSS-IND-ECRS.                    
           MOVE GDG-IND-ECRT IN GDG TO WSS-IND-ECRT.                    
      *EVA-FIN-AFRI/FEB 2006                                            
      *<<<< GEN_BCI                                                     
      *PTC-INI-MAN                                                      
           IF SCR-OFRM-SRV AND                                          
              SCR-CMND = 'MOD'                                          
                PERFORM DEL-GDD                                         
           ELSE                                                         
      *PTC-FIN-MAN                                                      
      *>>>>                                                             
           IF NOT (                                                     
      *<<<< FMT_CHI                                                     
              DBC-IND-ICLI IN GDG-FLD = 'M' OR                          
      *>>>>                                                             
              ( CNE-DBC-CAI-ICLI = SPACES AND                           
                CNE-DBC-IIC-ICLI = ZEROES ) OR                          
              ( GDG-CAI-GTIA IN GDG-FLD = SPACES AND                    
                GDG-IIC-GTIA IN GDG-FLD = ZEROES ))                     
                                                                        
               PERFORM GET-UPD-GDD                                      
               MOVE 'S' TO GDG-IND-EGDD IN GDG                          
           ELSE                                                         
      *        No modifica ni ingresa porque no hay GDD                 
               MOVE WSS-MISMO TO WSS-MGDD.                              
      *>>>> EVP-FIN CMNMODRET                                           
*% END
*% IF FIN_SCR_GFLD
      *<<<< LDC_SI AND PGM_MVS AND (FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_
           IF FRM-FFLD = FRM-FFLD-PF3 AND                               
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
      *       AND SCR-IND-COL = 'C'                                     
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
*% END
*% IF RET_STT_GDG
      *<<<<
           GO TO FIN-RET-STT-GDG
      *>>>>
*% END
