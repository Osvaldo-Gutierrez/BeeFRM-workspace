*%! NO_TIENE_TIMESTAMP = TRUE
*%! NO_HDR_CST = TRUE
*%! PARA MANEJAT DATACOM DESDE AMBIENTE VSAM INTERACTIVO
*%! INCLUDE 'BGLSRC:GNSVSIDTC.SRC'
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% FRM = 'TAG'
*% REG = 'TAG'
*% VSNPQ = "06.06.29"
*% FNCPQ = "OWFBGL"
*% VSNPU = "06.06.29"
*% FNCPU = "OWFBGL"
*%!IF NOT PGM_MCP
*% PGM_PTC = TRUE
*%!END
*% IF WSS
      *<<<< WSS
       COPY GNSWGCVT.                                                   
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.  
      *>>>>
*% END
*% IF WSS AND PGM_DTC
      *<<<< WSS AND PGM_DTC
       COPY GNSWGHOY.
      *>>>>
*% END
*% IF PGM_DTC AND EOF
      *<<<< PGM_DTC AND EOF
       COPY GNSBGHOY.
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
      *>>>>
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 CMA-VARI.
      *RRM-INI 10-SEP-2001
      *       05 TAG-COD-TOPE                    PIC X(03).
      *       05 TAG-COD-SOPE                    PIC X(03).
              05 TAG-COD-AGTA.
                 07 TAG-COD-TOPE                 PIC X(03).
                 07 TAG-COD-SOPE                 PIC X(03).
      *RRM-FIN 10-SEP-2001
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA AND PGM_MVS
           02 FILLER                       PIC X(265).
*% END
*% IF INI_FIO AND PGM_MVS
      *<<<< INI_FIO
           MOVE +265 TO SCR-TCMA.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB'   TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

*% IF PGM_MVS OR PGM_MCP
           IF SCR-DESDE-CMN
               MOVE SPACES TO TAG-COD-TOPE IN CMA-VARI
               MOVE SPACES TO TAG-COD-SOPE IN CMA-VARI.
*% ELSE
           MOVE SPACES TO TAG-COD-TOPE IN CMA-VARI.
           MOVE SPACES TO TAG-COD-SOPE IN CMA-VARI.
           MOVE ZEROES TO TAG-NUM-PVTS IN TAG-FLD.
*% END
      *>>>>
*% END
*% IF PGM_VAX AND FIN_LUP_MAIN
      *<<<< FIN_LUP_MAIN
           IF SCR-INST = SCR-INST-HCM
               MOVE SPACES TO TAG-COD-TOPE IN CMA-VARI
               MOVE SPACES TO TAG-COD-SOPE IN CMA-VARI.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
*% IF NOT GEN_BCI
      *<<<< NOT GEN_BCI
           MOVE ZEROES              TO TAG-SGV-PAJU IN TAG-FLD.
           MOVE ZEROES              TO TAG-SGV-PPON IN TAG-FLD.

           MOVE FRM-CPIM-AEY        TO TAG-SGV-PAJU-ATR.
           MOVE FRM-CPIM-AEY        TO TAG-SGV-PAJU-STP.

           MOVE FRM-CPIM-AEY        TO TAG-SGV-PPON-ATR.
           MOVE FRM-CPIM-AEY        TO TAG-SGV-PPON-STP.

      *>>>>
*% END
           IF SCR-CMND = 'COP'
               PERFORM UNP-IKY-TAG
               PERFORM FST-KEY-TAG.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP NOT = 'ING' AND
      *RRM-INI 10-SEP-2001
*% IF FMT_CHI
      *<<<<
               TAG-COD-TOPE IN TAG-FLD = SPACES AND
               TAG-COD-SOPE IN TAG-FLD = SPACES
      *>>>>
*% ELSE
               TAG-COD-AGTA IN TAG-FLD = SPACES
      *        TAG-COD-TOPE IN TAG-FLD = SPACES AND
      *        TAG-COD-SOPE IN TAG-FLD = SPACES
*% END
      *RRM-FIN 10-SEP-2001
                MOVE TAG-COD-TOPE IN CMA-VARI TO TAG-COD-TOPE IN TAG
                MOVE TAG-COD-SOPE IN CMA-VARI TO TAG-COD-SOPE IN TAG.
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF SCR-CCPP NOT = 'ING' AND
      *RRM-INI 10-SEP-2001
*% IF FMT_CHI
      *<<<<
               TAG-COD-TOPE IN TAG-FLD = SPACES AND
               TAG-COD-SOPE IN TAG-FLD = SPACES
      *>>>>
*% ELSE
               TAG-COD-AGTA IN TAG-FLD = SPACES
      *        TAG-COD-TOPE IN TAG-FLD = SPACES AND
      *        TAG-COD-SOPE IN TAG-FLD = SPACES
*% END
      *RRM-FIN 10-SEP-2001

               IF FIO-STAT-OKS
                   MOVE FIO-GET-NLS TO FIO-CMND
                   PERFORM BGL-FIO-TAG
                   MOVE FIO-GET-NXT TO FIO-CMND
                   PERFORM BGL-FIO-TAG
                   MOVE FIO-STAT TO PGM-STAT-TAG
      *RRM-INI 10-SEP-2001
*% IF FMT_CHI
      *<<<<
                   MOVE TAG-COD-TOPE IN TAG TO TAG-COD-TOPE IN TAG-FLD
                   MOVE TAG-COD-SOPE IN TAG TO TAG-COD-SOPE IN TAG-FLD
      *>>>>
*% ELSE
                   MOVE TAG-COD-AGTA IN TAG TO TAG-COD-AGTA IN TAG-FLD
      *            MOVE TAG-COD-TOPE IN TAG TO TAG-COD-TOPE IN TAG-FLD
      *            MOVE TAG-COD-SOPE IN TAG TO TAG-COD-SOPE IN TAG-FLD
*% END
      *RRM-FIN 10-SEP-2001
               ELSE
                   MOVE FIO-GET-FST TO FIO-CMND
                   PERFORM BGL-FIO-TAG
                   MOVE FIO-STAT TO PGM-STAT-TAG

      *RRM-INI 10-SEP-2001
*% IF FMT_CHI
      *<<<<
                   MOVE TAG-COD-TOPE IN TAG TO TAG-COD-TOPE IN TAG-FLD
                   MOVE TAG-COD-SOPE IN TAG TO TAG-COD-SOPE IN TAG-FLD
      *>>>>
*% ELSE
                   MOVE TAG-COD-AGTA IN TAG TO TAG-COD-AGTA IN TAG-FLD
      *            MOVE TAG-COD-TOPE IN TAG TO TAG-COD-TOPE IN TAG-FLD
      *            MOVE TAG-COD-SOPE IN TAG TO TAG-COD-SOPE IN TAG-FLD
*% END
      *RRM-FIN 10-SEP-2001

           MOVE TAG-COD-TOPE IN TAG TO TAG-COD-TOPE IN CMA-VARI.
           MOVE TAG-COD-SOPE IN TAG TO TAG-COD-SOPE IN CMA-VARI.

*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
               IF SCR-CMND = 'COP'
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    NOCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'COP'
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    SICOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    ERCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC.
      *>>>>
*% END
