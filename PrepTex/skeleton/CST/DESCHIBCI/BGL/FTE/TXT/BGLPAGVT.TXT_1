*%! IF NOT PGM_MCP
*% largo_mi_commarea = 251
*% VSNPQ = "06.06.29"
*% FNCPQ = "OWFBGL"
*% VSNPU = "06.06.29"
*% FNCPU = "OWFBGL"
*% PGM_PTC = TRUE
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*%! END
*%! HASTA AQUI PARA MANEJAR VSAM EN AMBIENTE DTC
*% FRM = 'GVT'
*% PGM_GVT = TRUE
*% GRA_GMO = TRUE
*% IF NOT PGM_CLB AND NOT PGM_MEX AND PGM_PQ
*%     ! CODIGO ADICIONAL PARA FUNCION BGLPPVCG = PF5 DESDE BGLPAGVT
*%      INCLUDE 'BGLSRC:PFALL5.SRC'
*%     ! CODIGO ADICIONAL PROGRAMA BGLPAGVT
*% END
*% MOD_ADI_GVT = TRUE
*% REG = 'GVT'
*% HIJ = 'GDG'
*% IF EOF AND PGM_DTC
      *<<<< EOF AND PGM_DTC
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
*% END
*% IF CMT_ID
      *-----------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: REGULARIZAR MENSAJE EXCEPCION DE LA GVT
      *PROYECTO: ACT. DE EXC.PARA PREPAGOS DE OPERACIONES HIPOT. PREP.
      *FECHA   : ENERO DE 2012
      *AUTOR   : CHC
      *ETIQUETA:
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      *-----------------------------------------------------------------
      *PROYECTO: MENSAJE TASACION VENCIDA
      *OBJETIVO: VALIDAR QUE MONTO TASACION NO SEA MAYOR A 10000 UF 
      *AUTOR   : BEE-TEAM (PVC)
      *ETIQUETA: PVC-INI 29-Julio-2012 
*% END
*% IF CMT_ID_PQ
      *-----------------------------------------------------------------
      *PROYECTO: ADMINISTRACION DE PRENDAS WARRANTS		
      *OBJETIVO: VALOR LIQUIDACION AUTOMATICO	
      *AUTOR   : BEE-TEAM (PVC)
      *ETIQUETA: PVC-INI 19-OCT-2012 
      *-----------------------------------------------------------------
      *PROYECTO: DESVALORIZACION - 51921
      *OBJETIVO: CONTADOR DE RETASACION CON AVALUO FISCAL
      *AUTOR   : BEE-TEAM (PVC)
      *ETIQUETA:
      *PVC-INI 19-NOV-2012  DESVALORIZACION
      *-----------------------------------------------------------------
*% END
*% IF FIN_SCR_VARI
           03 CMA-VARI.
              05 GAR-CAI-GTIA                     PIC X(04).
              05 GAR-IIC-GTIA                     PIC X(08).
              05 GAR-IND-TPRE                     PIC X(01).
              05 GAR-IND-OMCT                     PIC X(01).
              05 GAR-SGV-PPON     COMP-3          PIC 9(03)V9(2).
              05 GAR-SGV-PAJU     COMP-3          PIC 9(03)V9(2).
              05 GAR-NUM-PVTS                     PIC 9(03).
              05 GAR-COD-TPVT                     PIC X(01).
              05 GAR-IND-GTAC                     PIC X(01). 
              05 GAR-COD-TASN                     PIC 9(03). 
      *<<<< NOT PGM_ARG
              05 WSS-SGV-VCTS     COMP-3           PIC S9(11)V9(4).
              05 WSS-SGV-LTSN     COMP-3           PIC S9(11)V9(4).
              05 WSS-SGV-VPND     COMP-3           PIC S9(11)V9(4).
              05 WSS-SGV-VGAS     COMP-3           PIC S9(11)V9(4).
              05 WSS-VALOR-LIQ    COMP-3           PIC S9(11)V9(4).
      *>>>>
              05 WSS-FEC-FRVL                       PIC 9(08).
              05 WSS-FEC-FTSN                       PIC 9(08).
      ** EVA-INI  10/07
              05 WSS-FEC-FURV                       PIC 9(08).
              05 WSS-FEC-FANR                       PIC 9(08).
      ** EVA-FIN  10/07
              05 WSS-LIQ-CML      COMP-3           PIC S9(1)V9(14).
              05 CMA-CIC-TGAR                      PIC X(06).
              05 CMA-IND-SMEC                      PIC X(01).
      *<<<< GEN_BCI
              05 CMA-IND-APLI                      PIC X(01).
              05 CMA-IND-TSWT                      PIC X(01).
      *>>>>
      *MHM-INI 29-OCT-2003
              05 CMA-CIC-UING                      PIC X(12).
      *MHM-FIN 29-OCT-2003
      ** EVA-INI  10/07
              05 WSS-IND-TASV       VALUE 'N'      PIC X(01).
      ** EVA-FIN  10/07
      *>>>>                                                             
*% END
*% IF WSS_DTC
*% IF PGM_PQ
      *PVC-INI 29-JUL-2012 - Mensaje de tasacion Vencida                
           03 WSS-IND-TASC                     PIC X(01).
           03 WSS-GLS-DAT1.
              05 WSS-VAL-TASC                  PIC  9(05).
              05 WSS-RES-DAT1                  PIC  X(05).

           03 WSS-VAL-UF                       PIC S9(11).              
           03 WSS-COD-UF.                                               
              05 WSS-IND-TMUF                  PIC X(01).               
              05 WSS-COD-REUF                  PIC X(05).               
      *PVC-FIN 29-JUL-2012                                              
      *PVC-INI 19-NOV-2012 - DESVALORIZACION
           03 WSS-NUM-FISC    VALUE ZEROES     PIC 9(03).
           03 I               VALUE ZEROES     PIC 9(02).
           03 WSS-GLS-DANE.
              05 WSS-COD-DATA OCCURS 20 TIMES  PIC X(03).
      *PVC-FIN 19-NOV-2012
*% IF PGM_PU
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           03 WSS-CTE-ING     VALUE 'ING'      PIC X(03).
           03 WSS-CTE-MTA     VALUE 'MTA'      PIC X(03).
           03 WSS-CTE-ATA     VALUE 'ATA'      PIC X(03).
           03 WSS-CTE-RTA     VALUE 'RTA'      PIC X(03).
           03 WSS-CTE-RVL     VALUE 'RVL'      PIC X(03).
           03 WSS-CTE-RTF     VALUE 'RTF'      PIC X(03).
           03 WSS-CTE-I       VALUE 'I'        PIC X(01).
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
           03 WSS-VAR-LTSN    VALUE ZEROES   COMP-3  PIC S9(11)V9(4).
      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1


      *OGB-INI VALIDACIONES VALORES EN GVT 03-MAY-2017
           03 WSS-CTE-MSG01  VALUE 'VLIQ > MLEG ' PIC X(12).
      *OGB-FIN VALIDACIONES VALORES EN GVT 03-MAY-2017

      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
           03 WSS-IND-FFMM        VALUE SPACES    PIC X(01).
           03 WSS-S               VALUE 'S'       PIC X(01).
           03 WSS-100             VALUE 100       PIC 9(03).
           03 WSS-GTP-ITSN                        PIC S9(11)V9(04).
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

           03 WSS-CTE-BGL      VALUE 'BGL'      PIC X(03).
           03 WSS-CTE-GSE      VALUE 'GSE'      PIC X(03).
           03 WSS-CTE-ELI      VALUE 'ELI'      PIC X(03).
           03 WSS-CTE-MOD      VALUE 'MOD'      PIC X(03).
           03 WSS-CTE-ANT      VALUE 'ANT'      PIC X(03).
           03 WSS-CTE-DES      VALUE 'DES'      PIC X(03).
           03 WSS-CTE-M        VALUE 'M'        PIC X(01).
           03 WSS-CTE-E        VALUE 'E'        PIC X(01).
           03 WSS-CTE-V10      VALUE '1.0'      PIC X(03).
           03 WSS-CTE-1        VALUE  1         PIC 9(01).
           03 WSS-CTE-2        VALUE  2         PIC 9(01).

           03 WSG-SGV-LTSN        PIC  ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
           03 WSG-SGV-VCTS        PIC  ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
           03 WSG-SGV-PPCT                   PIC  ZZZ,ZZZZ.
           03 WSG-SGV-VPND        PIC  ZZ.ZZZ.ZZZ.ZZ9,9999.
           03 WSG-SGV-PAJU                   PIC  ZZZ,ZZZZ.
           03 WSG-SGV-VGAS        PIC  ZZ.ZZZ.ZZZ.ZZ9,9999.
           03 WSG-SGV-VSIN        PIC  ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
           03 WSG-SGV-FISI        PIC  ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
           03 WSG-SGV-FISC        PIC  ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
           03 WSG-SGV-VTTL        PIC  ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.

       77  WSS-LGM-ABSTIME                  PIC S9(15) COMP-3.

       COPY GNSBRLGN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LGN-REQA==.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

*% END
*% END
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY                                                 
      *<<<< GEN_BCI                                                     
           IF GVT-COD-SDAG IN GVT-FLD > SPACES AND                      
              GVT-IIC-GTIA IN GVT-FLD NOT > ZEROES                      
               MOVE GVT-COD-SDAG IN GVT-FLD TO GVT-COD-SDAG IN GVT      
               MOVE 'GVT-COD-SDAG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GVT                                      
               IF NOT FIO-STAT-OKS                                      
                  MOVE FIO-STAT TO PGM-STAT-GVT                         
                  GO TO FIN-FND-KEY                                     
               ELSE                                                     
                  MOVE GVT-CAI-GTIA IN GVT TO GVT-CAI-GTIA IN GVT-FLD   
                  MOVE GVT-IIC-GTIA IN GVT TO GVT-IIC-GTIA IN GVT-FLD.  
                                                                        
      *RRM-INI 12-MAY-2003  ACTULAZACION COD. ADIC. (PQ)                
      *MHM-INI 23-MAY-2006                                              
      * Llama a Subrutina Validacion Consistencia Garantia              
      *    IF FRM-FFLD = FRM-FFLD-PF5                                   
      *        PERFORM GAR-PRO-VCG                                      
      *        GO TO FIN-FND-KEY.                                       
      *MHM-FIN 23-MAY-2006                                              
                                                                        
      *>>>>                                                             
       BUS-GDG.                                                         
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           MOVE FIO-STAT TO PGM-STAT-GDG.                               
           IF NOT FIO-STAT-OKS                                          
               MOVE 'GDG    NEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
      *<<<< PGM_CHI                                                     
           IF SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON              
               GO TO FIN-VAL-OFI-USP-GVT.                               
           IF SCR-OFRM-SRV                                              
               GO TO FIN-VAL-OFI-USP-GVT.                               
                                                                        
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )        
               GO TO FIN-VAL-OFI-USP-GVT.                               
      *ALD-BCI-INI/07032000                                             
           COPY USPC143.                                                
           MOVE 'BGLGTUCG/CEN' TO USP-PTA-STR.                          
           COPY USPC103.                                                
           IF USP-PERMISO = 'P'                                         
               GO TO FIN-VAL-OFI-USP-GVT.                               
      *    COPY USPC143.                                                
      *ALD-BCI-FIN/07032000                                             
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG                 
               MOVE 'USRNODEOFI' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
       FIN-VAL-OFI-USP-GVT.                                             
      *>>>>                                                             
                                                                        
       FIN-BUS-GDG.                                                     
           IF SCR-CMND = 'RTA' AND                                      
              GDG-IND-EST1 IN GDG = '15'                                
              MOVE 'CMNDNPPG' TO MSG-COD-MENS                           
              GO TO ERR-FND-KEY.                                        
                                                                        
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GVT-FLD.         
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GVT-FLD.         
      *>>>>                                                             
      *BUS-TAB Busca codigo de tabla                                    
           MOVE 'TAB' TO TAB-COD-SIST.                                  
      *     MOVE 'GTA' TO TAB-COD-TTAB IN TAB.                          
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.                           
           MOVE SPACES TO TAB-COD-CTAB IN TAB.                          
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GVT-FLD TO TAG-TIP-AGTA IN TAG.         
           MOVE GDG-STP-CGTA IN GVT-FLD TO TAG-STP-AGTA IN TAG.         
      *>>>>                                                             
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.         
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
               MOVE TAB-CIC-CTAB IN TAB TO CMA-CIC-TGAR IN CMA-VARI     
      *<<<< GEN_BCI                                                     
               MOVE TAB-COD-DAT1 IN TAB-GLS-DAT1(1)                     
                                        TO CMA-IND-APLI IN CMA-VARI     
               MOVE TAB-COD-DAT1 IN TAB-GLS-DAT1(3)                     
                                        TO CMA-IND-TSWT IN CMA-VARI     
      *>>>>                                                             
      *MHM-INI 23-OCT-2003                                              
      *         MOVE TAB-GLS-DESC IN TAB TO                             
      *              FRM-GLS-CGTA IN GVT-FLD                            
      *     ELSE                                                        
      *         MOVE SPACES TO FRM-GLS-CGTA IN GVT-FLD.                 
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.                 
                                                                        
           IF GDG-TIP-CGTA IN GVT-FLD > SPACES                          
               MOVE 'TAB'                   TO TAB-COD-SIST             
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB      
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB      
               MOVE GDG-TIP-CGTA IN GVT-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.                 
                                                                        
           MOVE WSS-GLS-CGTA TO CPT-STRN.                               
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GVT-FLD.                    
      *MHM-FIN 23-OCT-2003                                              
                                                                        
      * Busca Glosa Tabla Real/no Real                                  
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
                MOVE 'TAG    NEX' TO MSG-COD-MENS                       
                MOVE 'BGL' TO MSG-COD-SIST                              
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
           ELSE                                                         
           MOVE TAG-IND-TPRE IN TAG TO GAR-IND-TPRE IN CMA-VARI         
           MOVE TAG-IND-OMCT IN TAG TO GAR-IND-OMCT IN CMA-VARI         
           MOVE TAG-SGV-PPON IN TAG TO GAR-SGV-PPON IN CMA-VARI         
           MOVE TAG-SGV-PAJU IN TAG TO GAR-SGV-PAJU IN CMA-VARI         
           MOVE TAG-NUM-PVTS IN TAG TO GAR-NUM-PVTS IN CMA-VARI         
           MOVE TAG-COD-TPVT IN TAG TO GAR-COD-TPVT IN CMA-VARI         
                                                                        
           MOVE SPACES              TO MSG-COD-MENS                     
           MOVE 'BGL'               TO TAB-COD-SIST                     
           MOVE 'RAL'               TO TAB-COD-TTAB IN TAB              
           MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB              
           PERFORM BUS-TAB                                              
           IF MSG-COD-MENS = SPACES                                     
              MOVE TAB-GLS-DESC IN TAB TO                               
                                   FRM-GLS-TREA IN GVT-FLD              
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-TREA IN GVT-FLD.                   
                                                                        
                                                                        
      * No encontro TAG o Tabla RAL                                     
           IF MSG-COD-MENS > SPACES                                     
               GO TO ERR-FND-KEY.                                       
                                                                        
           MOVE GDG-CAI-GTIA IN GDG TO GAR-CAI-GTIA IN CMA-VARI.        
           MOVE GDG-IIC-GTIA IN GDG TO GAR-IIC-GTIA IN CMA-VARI.        
           MOVE GDG-IND-GTAC IN GDG TO GAR-IND-GTAC IN CMA-VARI.        
           MOVE GDG-COD-TSCN IN GDG TO GAR-COD-TASN IN CMA-VARI.        
           IF (SCR-CMND = 'ING' OR SCR-CMND = 'INE')                    
               PERFORM PUT-GDG-GVT.                                     
                                                                        
      * Valida Este permitido esta Entidad para Tipo-Subtipo            
           IF TAG-IND-EGVT IN TAG = 'N'                                 
               MOVE 'TAG    NOPGM' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
      * Busca ultima Tasacion                                           
           IF SCR-CCPP NOT = 'ING'                                      
               IF GVT-COD-TASN IN GVT-FLD < 1                           
                   MOVE GAR-COD-TASN IN CMA-VARI TO                     
                        GVT-COD-TASN IN GVT-FLD                         
                                                                        
      *            Busca ultimo Item                                    
                   PERFORM BUS-ULT-GTP                                  
               ELSE                                                     
                   PERFORM BUS-ULT-GTP.                                 
      *<<<< GEN_BCI                                                     
           IF ((SCR-CMND = 'ING' OR SCR-CMND = 'INE') AND               
              (GAR-IND-GTAC IN CMA-VARI NOT = 'S'))                     
               MOVE GVT-CAI-GTIA IN GVT-FLD TO GSO-CAI-GTIA IN GSO      
               MOVE GVT-IIC-GTIA IN GVT-FLD TO GSO-IIC-GTIA IN GSO      
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GSO                                      
               IF FIO-STAT-OKS AND GSO-COD-ESGA IN GSO NOT < '06'       
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   MOVE 'GVTNIGSO>=06' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY.                                   
                                                                        
           IF SCR-CMND = 'MOD' AND GAR-IND-GTAC IN CMA-VARI NOT = 'S'   
               MOVE GVT-CAI-GTIA IN GVT-FLD TO GSO-CAI-GTIA IN GSO      
               MOVE GVT-IIC-GTIA IN GVT-FLD TO GSO-IIC-GTIA IN GSO      
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GSO                                      
               IF FIO-STAT-OKS                                          
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   MOVE 'GVT  NMGSO' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY.                                   
                                                                        
           IF SCR-CMND = 'ELI' AND GAR-IND-GTAC IN CMA-VARI NOT = 'S'   
               MOVE GVT-CAI-GTIA IN GVT-FLD TO GSO-CAI-GTIA IN GSO      
               MOVE GVT-IIC-GTIA IN GVT-FLD TO GSO-IIC-GTIA IN GSO      
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GSO                                      
               IF FIO-STAT-OKS AND GSO-COD-ESGA IN GSO NOT < '06'       
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   MOVE 'GVTNEGSO>=06' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY.                                   
      *>>>>                                                             
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY                                                 
       EXA-COM-STAT.                                                    
      * Comando consulta error lo trata el genesis                      
           IF SCR-CCPP = 'ACC' AND                                      
              SCR-STPP = SCR-STAT-CON                                   
              GO TO FIN-FND-KEY.                                        
                                                                        
      * Garantia alzada                                                 
           IF GDG-IND-EST1 IN GDG > '19'                                
              MOVE 'GDGALZ' TO MSG-COD-MENS                             
              GO TO ERR-FND-KEY.                                        
                                                                        
      *MHM-INI 14-OCT-2003                                              
      * Solo Garantias Activadas                                        
           IF SCR-CMND = 'MTA' AND                                      
             ( GDG-IND-EST1 IN GDG < '10' OR                            
               GDG-IND-GTAC IN GDG NOT = 'S' )                          
               MOVE 'GDG    NOAGA' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
      *MHM-FIN 14-OCT-2003                                              
                                                                        
      * Comando ingreso se valido en fin-val-con-iky                    
      * Error lo trata el genesis                                       
           IF SCR-CCPP = 'ING'                                          
              GO TO FIN-FND-KEY.                                        
                                                                        
      * Comandos no ingreso, no encontro registro                       
      * Error lo trata el genesis                                       
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-FND-KEY.                                        
                                                                        
      * Comando modificacion datos informativos ultima tasacion         
           IF SCR-CMND = 'MTA' AND                                      
              GVT-COD-TASN IN GVT-FLD = GDG-COD-TSCN IN GDG             
               GO TO FIN-FND-KEY.                                       
                                                                        
      * No permite actuar sobre tasacion antigua                        
           IF GVT-COD-TASN IN GVT-FLD < GDG-COD-TSCN IN GDG             
               MOVE 'TSNNOVIG' TO MSG-COD-MENS                          
               GO TO ERR-FND-KEY.                                       
                                                                        
      * Se intenta modificar, no activar                                
           IF SCR-CCPP = 'MOD' AND SCR-CMND = 'MOD'                     
               IF GDG-IND-GTAC IN GDG NOT = 'S'                         
      *            SE PERMITE MODIFICAR GARANTIA NO ACTIVADA            
                   GO TO FIN-FND-KEY                                    
               ELSE                                                     
                   MOVE 'GDG    AGAYA' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY.                                   
                                                                        
      *MHM-INI 14-OCT-2003                                              
           IF SCR-CMND NOT = 'RTF'                                      
               GO TO CNT-CMN-RTF.                                       
                                                                        
           PERFORM OBT-VALOR-MONNAC.                                    
           IF MSG-COD-MENS > SPACES                                     
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-COD-VCAM IN GDG = WSS-COD-PESO IN WSS-VARI            
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'RTF NOPESO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF FRM-IND-GTP IN GVT-FLD = 'S'                              
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'RTF  NOGTP'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO ERR-FND-KEY.                                       
                                                                        
       CNT-CMN-RTF.                                                     
      *MHM-FIN 14-OCT-2003                                              
      *MHM-INI 11-SEP-2003                                              
      *     IF SCR-CMND = 'RTA' OR SCR-CMND = 'RVL'                     
           IF SCR-CMND = 'RTA' OR SCR-CMND = 'RVL' OR SCR-CMND = 'RTF'  
      *MHM-FIN 11-SEP-2003                                              
               IF GVT-MSC-STAT IN GVT NOT = 'A'                         
                 IF FRM-IND-GTP IN GVT-FLD = 'N'                        
                   MOVE 'GTP    NOING' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY                                    
                 ELSE                                                   
                   MOVE 'ATANO' TO MSG-COD-MENS                         
                   GO TO ERR-FND-KEY                                    
               ELSE                                                     
               IF GDG-IND-GTAC IN GDG = 'S'                             
                   PERFORM SLV-VAL-ANT                                  
      *MHM-INI 10-OCT-2003                                              
                   GO TO FIN-FND-KEY                                    
      *MHM-FIN 10-OCT-2003                                              
                                                                        
               ELSE                                                     
                   MOVE 'GDG    NOAGA' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY.                                   
                                                                        
      * Examina si tiene tasaciones parciales                           
           IF FRM-IND-GTP IN GVT-FLD = 'S'                              
               GO TO EXA-SI-GTP.                                        
                                                                        
      * No tiene tasaciones parciales ya ingresadas                     
      * Se intenta activar                                              
           IF SCR-CMND = 'ATA'                                          
      *        comando solo para tasaciones parciales                   
               MOVE 'ATASINGTP' TO MSG-COD-MENS                         
               GO TO ERR-FND-KEY                                        
           ELSE                                                         
      *    Se intenta eliminar                                          
           IF SCR-CMND = 'ELI'                                          
               IF GDG-IND-GTAC IN GDG NOT = 'S'                         
      *        se permite eliminar, garantia no activada                
                   GO TO FIN-FND-KEY                                    
               ELSE                                                     
                   MOVE 'GDG    AGAYA' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY                                    
           ELSE                                                         
      *        comando desconocido                                      
               MOVE 'CMNOSITNEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
      * Si tiene tasaciones parciales                                   
       EXA-SI-GTP.                                                      
                                                                        
      *    se intenta activar                                           
           IF SCR-CMND = 'ATA'                                          
                                                                        
      *        se permite activar, tasacion no activada                 
               IF GVT-MSC-STAT IN GVT NOT = 'A'                         
                                                                        
      *            si garantia completa se salva campos anteriores      
                   IF GDG-IND-GTAC IN GDG = 'S'                         
                       PERFORM SLV-VAL-ANT                              
                       GO TO FIN-FND-KEY                                
                   ELSE                                                 
                       GO TO FIN-FND-KEY                                
               ELSE                                                     
                   MOVE 'ATAYA' TO MSG-COD-MENS                         
                   GO TO ERR-FND-KEY                                    
           ELSE                                                         
           IF SCR-CMND = 'ELI'                                          
               IF GDG-IND-GTAC IN GDG NOT = 'S'                         
      *            se permite eliminar, garantia no activada            
                   GO TO FIN-FND-KEY                                    
               ELSE                                                     
      *            no permite eliminar por garantia y tasacion activadas
                   MOVE 'ATAYA' TO MSG-COD-MENS                         
                   GO TO ERR-FND-KEY                                    
           ELSE                                                         
      *        comando desconocido                                      
               MOVE 'CMNOSITNEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
       ERR-CMN-STAT.                                                    
           MOVE 'CMNOSITNEX' TO MSG-COD-MENS.                           
           GO TO ERR-FND-KEY.                                           
                                                                        
       ERR-FND-KEY.                                                     
           MOVE 'BGL' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE SCR-STAT-ABT TO SCR-STAT.                               
           IF SCR-CCPP = 'ING'                                          
               MOVE '00' TO FIO-STAT                                    
           ELSE                                                         
               MOVE FIO-STAT-NEX TO FIO-STAT.                           
                                                                        
      *>>>>                                                             
*% END
*% IF FIN_PUT_SCR
      *<<<< FIN_PUT_SCR                                                 
      *PTC-INI-MAN                                                      
           MOVE SPACES TO WSX-TAB-GTP.                                  
           IF NOT SCR-OFRM-SRV                                          
              GO TO LUP-PUT-GTP-SIN-PTC.                                
           MOVE ZEROES TO WSX-IDX-GTP.                                  
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP.         
      *     MOVE ZEROES                 TO GAR-COD-TSN  IN GTP.         
           MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP.         
           MOVE ZEROES                  TO GTP-COD-ITSN IN GTP.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-PUT-ALL-GTP-PTC.                                             
      *  Se posiciona por la llave del hijo                             
      *     MOVE 'GAR-CLV-GTP-1' TO FIO-AKEY.                           
           PERFORM BGL-FIO-GTP.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                 GVT-CAI-GTIA IN GVT-FLD = GTP-CAI-GTIA IN GTP AND      
                 GVT-IIC-GTIA IN GVT-FLD = GTP-IIC-GTIA IN GTP AND      
                 GVT-COD-TASN IN GVT-FLD = GTP-NUM-ITSN IN GTP)         
                GO TO END-PUT-ALL-GTP-PTC.                              
                                                                        
                                                                        
           ADD 1 TO WSX-IDX-GTP                                         
                                                                        
           MOVE GTP-COD-ITSN IN GTP TO                                  
                   WSX-COD-ITSN IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-NUM-DCES IN GTP TO                                  
                   WSX-NUM-DCES IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-NUM-MCES IN GTP TO                                  
                   WSX-NUM-MCES IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-NUM-SCES IN GTP TO                                  
                   WSX-NUM-SCES IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-NUM-ACES IN GTP TO                                  
                   WSX-NUM-ACES IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-SGV-ITSN IN GTP TO                                  
                   WSX-SGV-ITSN IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-COD-IITS IN GTP TO                                  
                   WSX-COD-IITS IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-SGV-VTSN IN GTP TO                                  
               WSX-SGV-VTSN-RED IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-COD-EITS IN GTP TO                                  
                   WSX-COD-EITS IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
                                                                        
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-PUT-ALL-GTP-PTC.                                   
                                                                        
       END-PUT-ALL-GTP-PTC.                                             
                                                                        
                                                                        
           MOVE WSX-NOM-TSGTP  TO QUE-COLA.                             
           MOVE QUE-DEL        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
                                                                        
           MOVE WSX-NOM-TSGTP  TO QUE-COLA.                             
           MOVE WSX-LEN-TSGTP  TO QUE-LITM.                             
           MOVE WSX-TAB-GTP    TO QUE-ITEM.                             
           MOVE QUE-PUT        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
                                                                        
       LUP-PUT-GTP-SIN-PTC.                                             
      *PTC-FIN-MAN                                                      
*% END
*% IF FIN_HBL_FLD
      *>>>> FIN_HBL_FLD                                                 
           IF SCR-CMND = 'RTA'                                          
           MOVE FRM-CPIM-UBY TO GVT-COD-SDAG-ATR.                       
*% END
*% IF EOF_PQ
      *<<<< EOF                                                         
      *MHM-INI 11-SEP-2003                                              
       OBT-VALOR-MONNAC SECTION.                                        
       OBT-VALOR-MONNAC-INI.                                            
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'CICPESONEX'   TO MSG-COD-MENS IN MSG               
               GO TO OBT-VALOR-MONNAC-FIN.                              
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.        
       OBT-VALOR-MONNAC-FIN.                                            
           EXIT.                                                        
      *MHM-FIN 11-SEP-2003                                              
      *<<<< PGM_PQ                                                      
       BUS-ULT-GTP SECTION.                                             
       INI-BUS-ULT-GTP.                                                 
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP.         
           MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP.         
           MOVE 'GTP-KEY-IGTP' TO FIO-AKEY.                             
           MOVE '00' TO FIO-STAT.                                       
           MOVE 9999        TO GTP-COD-ITSN IN GTP.                     
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM BGL-FIO-GTP.                                         
           IF FIO-STAT-OKS AND                                          
              GVT-CAI-GTIA IN GVT-FLD = GTP-CAI-GTIA IN GTP AND         
              GVT-IIC-GTIA IN GVT-FLD = GTP-IIC-GTIA IN GTP AND         
              GVT-COD-TASN IN GVT-FLD = GTP-NUM-ITSN IN GTP             
                                                                        
               MOVE GTP-COD-ITSN IN GTP TO                              
                              FRM-NUM-GTP IN GVT-FLD                    
               MOVE 'S'    TO FRM-IND-GTP IN GVT-FLD                    
           ELSE                                                         
               MOVE SPACES TO FRM-IND-GTP IN GVT-FLD                    
               MOVE ZEROES TO FRM-NUM-GTP IN GVT-FLD.                   
       FIN-BUS-ULT-GTP.                                                 
           EXIT.                                                        
                                                                        
       SLV-VAL-ANT SECTION.                                             
       INI-SLV-VAL-ANT.                                                 
           MOVE GVT-SGV-LTSN IN GVT TO WSS-SGV-LTSN IN CMA-VARI.        
           MOVE GVT-SGV-VCTS IN GVT TO WSS-SGV-VCTS IN CMA-VARI.        
           MOVE GVT-SGV-VPND IN GVT TO WSS-SGV-VPND IN CMA-VARI.        
           MOVE GVT-FEC-FRVL IN GVT TO WSS-FEC-FRVL IN CMA-VARI.        
      *MHM-INI 17-OCT-2003                                              
      *     MOVE GVT-SGV-VPND IN GVT TO WSS-SGV-VGAS IN CMA-VARI.       
           MOVE GVT-SGV-VGAS IN GVT TO WSS-SGV-VGAS IN CMA-VARI.        
      *MHM-FIN 17-OCT-2003                                              
           MOVE GVT-FEC-FTSN IN GVT TO WSS-FEC-FTSN IN CMA-VARI.        
      *EVA-INI  09/07                                                   
                                                                        
           MOVE GVT-FEC-FURV IN GVT TO WSS-FEC-FURV IN CMA-VARI.        
           IF WSS-FEC-FTSN IN CMA-VARI > WSS-FEC-FRVL IN CMA-VARI       
              MOVE WSS-FEC-FTSN IN CMA-VARI TO                          
                   WSS-FEC-FANR IN CMA-VARI                             
           ELSE                                                         
              MOVE WSS-FEC-FRVL IN CMA-VARI TO                          
                   WSS-FEC-FANR IN CMA-VARI.                            
                                                                        
           IF WSS-FEC-FURV IN CMA-VARI > WSS-FEC-FANR IN CMA-VARI       
              MOVE WSS-FEC-FURV IN CMA-VARI TO                          
                   WSS-FEC-FANR IN CMA-VARI.                            
                                                                        
      *EVA-FIN  09/07                                                   
                                                                        
       FIN-SLV-VAL-ANT.                                                 
           EXIT.                                                        
                                                                        
      *>>>>                                                             
      *<<<< GEN_BCI                                                     
       OBT-VAL-RTF SECTION.                                             
       INI-OBT-VAL-RTF.                                                 
      ** EVA-INI  09/07
           IF GVT-FEC-FTSN IN GVT > GVT-FEC-FRVL IN GVT                 
              MOVE GVT-FEC-FTSN IN GVT TO WSS-FEC-FULR                  
           ELSE                                                         
              MOVE GVT-FEC-FRVL IN GVT TO WSS-FEC-FULR.                 
                                                                        
           IF GVT-FEC-FURV IN GVT > WSS-FEC-FULR                        
              MOVE GVT-FEC-FURV IN GVT TO WSS-FEC-FULR.                 
                                                                        
           MOVE WSS-NUM-SULR   TO CAM-NUM-SCAM IN CAM(1).               
           MOVE WSS-NUM-AULR   TO CAM-NUM-ACAM IN CAM(1).               
           MOVE WSS-NUM-MULR   TO CAM-NUM-MCAM IN CAM(1).               
           MOVE WSS-NUM-DULR   TO CAM-NUM-DCAM IN CAM(1).               
      ** EVA-FIN  09/07
                                                                        
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE GDG-COD-VCAM IN GVT-FLD  TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT (                                                     
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'                
              )                                                         
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-OBT-VAL-RTF.                                   
                                                                        
           MULTIPLY GVT-SGV-LTSN IN GVT-FLD                             
                     BY CAM-SGV-VCAM    IN CAM                          
                 GIVING WSS-VAL-PESO ROUNDED.                           
           MOVE WSS-VAL-PESO TO GVT-SGV-LTSN IN GVT.                    
                                                                        
           MULTIPLY GVT-SGV-VCTS IN GVT-FLD                             
                     BY CAM-SGV-VCAM    IN CAM                          
                 GIVING WSS-VAL-PESO ROUNDED.                           
           MOVE WSS-VAL-PESO TO GVT-SGV-VCTS IN GVT.                    
                                                                        
           MULTIPLY GVT-SGV-VPND IN GVT-FLD                             
                     BY CAM-SGV-VCAM    IN CAM                          
                 GIVING WSS-VAL-PESO ROUNDED.                           
           MOVE WSS-VAL-PESO TO GVT-SGV-VPND IN GVT.                    
                                                                        
           MULTIPLY GVT-SGV-VGAS IN GVT-FLD                             
                     BY CAM-SGV-VCAM    IN CAM                          
                 GIVING WSS-VAL-PESO ROUNDED.                           
           MOVE WSS-VAL-PESO TO GVT-SGV-VGAS IN GVT.                    
       FIN-OBT-VAL-RTF.                                                 
           EXIT.                                                        
                                                                        
       EXC-NOR-TAS SECTION.                                             
       INI-EXC-NOR-TAS.                                                 
           IF GDG-COD-LGTA IN GDG = 'E'                                 
               PERFORM GAR-ESP                                          
           ELSE                                                         
               PERFORM GAR-GRL.                                         
       FIN-EXC-NOR-TAS.                                                 
           EXIT.                                                        
                                                                        
       GAR-ESP SECTION.                                                 
       INI-GAR-ESP.                                                     
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.                     
           MOVE 'S'    TO WSS-IND-HIPT IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENFE IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT1 IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT2 IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT3 IN WSS-VARI.                     
                                                                        
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.             
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.             
           MOVE ZEROES TO GES-NUM-IGES IN GES.                          
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-GAR-ESP.                                                     
           PERFORM BGL-FIO-GES.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GES-CAI-GTIA IN GES = GDG-CAI-GTIA AND                    
              GES-IIC-GTIA IN GES = GDG-IIC-GTIA )                      
      ***********************************
              IF FIO-STAT-OKS OR FIO-STAT-EOF
                 MOVE FIO-END-BRW TO FIO-CMND
                 PERFORM BGL-FIO-GES
                 GO TO CNT-GAR-ESP
              ELSE
      ***********************************
               GO TO CNT-GAR-ESP.                                       
                                                                        
           MOVE GES-CAI-IOPC IN GES TO OPC-CAI-IOPC IN OPC.             
           MOVE GES-IIC-IOPC IN GES TO OPC-IIC-IOPC IN OPC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-GAR-ESP.                                       
                                                                        
      *MHM-INI 22-OCT-2003                                              
           IF OPC-MSC-STAT IN OPC NOT = 'A' OR                          
              OPC-VAL-SCRE IN OPC NOT > ZEROES                          
               GO TO NXT-GAR-ESP.                                       
      *MHM-FIN 22-OCT-2003                                              
                                                                        
           IF OPC-MSC-STAT IN OPC = 'A'                                 
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.     
                                                                        
           IF OPC-COD-TOPC IN OPC NOT = 'F'                             
               MOVE 'N' TO WSS-IND-HIPT IN WSS-VARI                     
               PERFORM CMP-FEC.                                         
                                                                        
       NXT-GAR-ESP.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-GAR-ESP.                                           
                                                                        
       CNT-GAR-ESP.                                                     
           IF WSS-VAL-SCRE IN WSS-VARI NOT > ZEROES                     
               MOVE 'S' TO WSS-IND-ENT1 IN WSS-VARI.                    
                                                                        
           IF WSS-IND-HIPT IN WSS-VARI = 'S'                            
               MOVE 'S' TO WSS-IND-ENT2 IN WSS-VARI.                    
                                                                        
           IF WSS-IND-ENFE IN WSS-VARI = 'S'                            
               MOVE 'S' TO WSS-IND-ENT3 IN WSS-VARI.                    
                                                                        
       FIN-GAR-ESP.                                                     
           EXIT.                                                        
                                                                        
       CMP-FEC SECTION.                                                 
       INI-CMP-FEC.                                                     
           PERFORM LEE-TIO.                                             
           IF WSS-CIC-TOPE IN WSS-VARI = '951'                          
               MOVE 2 TO FEC-NANO                                       
           ELSE                                                         
               MOVE 1 TO FEC-NANO.                                      
           PERFORM LEE-GVT.                                             
           IF WSS-FEC-FTSN IN WSS-VARI NOT > SPACES                     
               GO TO FIN-CMP-FEC.                                       
           PERFORM RST-FECHA.                                           
           IF WSS-FEC-FTRA IN WSS-VARI NOT < OPC-FEC-FINP IN OPC AND    
              OPC-VAL-SCRE IN OPC > ZEROES                              
               MOVE 'S' TO WSS-IND-ENFE IN WSS-VARI.                    
       FIN-CMP-FEC.                                                     
           EXIT.                                                        
                                                                        
       LEE-TIO SECTION.                                                 
       INI-LEE-TIO.                                                     
           MOVE SPACES              TO WSS-CIC-TOPE IN WSS-VARI.        
           MOVE 'TAB'               TO TAB-COD-SIST.                    
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.             
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.             
           MOVE GDG-COD-TOPE IN GDG TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOPE IN WSS-VARI.    
       FIN-LEE-TIO.                                                     
           EXIT.                                                        
                                                                        
       LEE-GVT SECTION.                                                 
       INI-LEE-GVT.                                                     
           MOVE GVT-NUM-STSN IN GVT-FLD TO WSS-NUM-STSN IN WSS-VARI.    
           MOVE GVT-NUM-ATSN IN GVT-FLD TO WSS-NUM-ATSN IN WSS-VARI.    
           MOVE GVT-NUM-MTSN IN GVT-FLD TO WSS-NUM-MTSN IN WSS-VARI.    
           MOVE GVT-NUM-DTSN IN GVT-FLD TO WSS-NUM-DTSN IN WSS-VARI.    
       FIN-LEE-GVT.                                                     
           EXIT.                                                        
                                                                        
                                                                        
       RST-FECHA SECTION.                                               
       INI-RST-FECHA.                                                   
           MOVE SPACES TO WSS-FEC-FTRA IN WSS-VARI.                     
           MOVE WSS-NUM-DTSN IN WSS-VARI TO FEC-ITM1.                   
           MOVE WSS-NUM-MTSN IN WSS-VARI TO FEC-ITM2.                   
           MOVE WSS-NUM-STSN IN WSS-VARI TO FEC-ITM3.                   
           MOVE WSS-NUM-ATSN IN WSS-VARI TO FEC-ITM4.                   
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-SUM-ANO  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           IF FEC-STAT-OKS                                              
               MOVE FEC-ITM1 TO WSS-NUM-DTRA IN WSS-VARI                
               MOVE FEC-ITM2 TO WSS-NUM-MTRA IN WSS-VARI                
               MOVE FEC-ITM3 TO WSS-NUM-STRA IN WSS-VARI                
               MOVE FEC-ITM4 TO WSS-NUM-ATRA IN WSS-VARI.               
       FIN-RST-FECHA.                                                   
           EXIT.                                                        
                                                                        
       GAR-GRL SECTION.                                                 
       INI-GAR-GRL.                                                     
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.                     
           MOVE 'S'    TO WSS-IND-HIPT IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENFE IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT1 IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT2 IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT3 IN WSS-VARI.                     
                                                                        
           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.             
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-GDD-GAR-GRL.                                                 
           PERFORM BGL-FIO-GDD.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GDD-CAI-GTIA IN GDD = GDG-CAI-GTIA AND                    
              GDD-IIC-GTIA IN GDD = GDG-IIC-GTIA )                      
               GO TO CNT-GAR-GRL.                                       
                                                                        
           MOVE GDD-CAI-DCLI IN GDD TO RDC-CAI-ICLI IN RDC.             
           MOVE GDD-IIC-DCLI IN GDD TO RDC-IIC-ICLI IN RDC.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-RDC-GAR-GRL.                                                 
           PERFORM COL-FIO-RDC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              RDC-CAI-ICLI IN RDC = GDD-CAI-DCLI IN GDD AND             
              RDC-IIC-ICLI IN RDC = GDD-IIC-DCLI IN GDD )               
               GO TO NXT-GDD-GRL.                                       
                                                                        
           MOVE RDC-CAI-IOPC IN RDC TO OPC-CAI-IOPC IN OPC.             
           MOVE RDC-IIC-IOPC IN RDC TO OPC-IIC-IOPC IN OPC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO NXT-RDC-GRL.                                       
                                                                        
      *MHM-INI 22-OCT-2003                                              
           IF OPC-MSC-STAT IN OPC NOT = 'A' OR                          
              OPC-VAL-SCRE IN OPC NOT > ZEROES                          
               GO TO NXT-RDC-GRL.                                       
      *MHM-FIN 22-OCT-2003                                              
                                                                        
           IF OPC-MSC-STAT IN OPC = 'A'                                 
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.     
                                                                        
           IF OPC-COD-TOPC IN OPC NOT = 'F'                             
               MOVE 'N' TO WSS-IND-HIPT IN WSS-VARI                     
               PERFORM CMP-FEC.                                         
                                                                        
       NXT-RDC-GRL.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-RDC-GAR-GRL.                                       
                                                                        
       NXT-GDD-GRL.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           GO TO LUP-GDD-GAR-GRL.                                       
                                                                        
       CNT-GAR-GRL.                                                     
           IF WSS-VAL-SCRE IN WSS-VARI NOT > ZEROES                     
               MOVE 'S' TO WSS-IND-ENT1 IN WSS-VARI.                    
                                                                        
           IF WSS-IND-HIPT IN WSS-VARI = 'S'                            
               MOVE 'S' TO WSS-IND-ENT2 IN WSS-VARI.                    
                                                                        
           IF WSS-IND-ENFE IN WSS-VARI = 'S'                            
               MOVE 'S' TO WSS-IND-ENT3 IN WSS-VARI.                    
                                                                        
       FIN-GAR-GRL.                                                     
           EXIT.                                                        
                                                                        
       COPY BGLBKVCG.                                                   
       COPY BGLBGVCG.                                                   
      *MHM-INI 16-OCT-2003                                              
       REST-VAL-GVT SECTION.                                            
       INI-REST-VAL-GVT.                                                
           MOVE WSS-SGV-LTSN IN CMA-VARI TO GVT-SGV-LTSN IN GVT.        
           MOVE WSS-SGV-VCTS IN CMA-VARI TO GVT-SGV-VCTS IN GVT.        
           MOVE WSS-SGV-VPND IN CMA-VARI TO GVT-SGV-VPND IN GVT.        
           MOVE WSS-SGV-VGAS IN CMA-VARI TO GVT-SGV-VGAS IN GVT.        
       FIN-REST-VAL-GVT.                                                
           EXIT.                                                        
      *MHM-FIN 16-OCT-2003                                              
      *>>>>                                                            
      ** EVA-INI  10/07
       COPY BGLBFGSL.
       COPY BGLBFTAS.
       COPY BGLBFGIM.
       COPY SGCBFDBC.
      ** EVA-FIN  10/07
       COPY BGLBFGDG.                                                   
       COPY BGLBFACC.                                                   
       COPY BGLBFGDP.                                                   
      *<<<< GEN_BCI                                                     
       COPY BGLBFGSO.                                                   
      *>>>>                                                             
       COPY TABBFIVB.                                                   
       COPY TABBFUSR.                                                   
      *<<<< GEN_BCI                                                     
       COPY BGLBFGDD.                                                   
       COPY COLBFRDC.                                                   
       COPY COLBFOPC.                                                   
      *>>>>                                                             
       COPY BGLBFGES.                                                   
       COPY BGLBFGSE.                                                   
       COPY BGLBFGTP.                                                   
       COPY BGLBFTAG.                                                   
       COPY TABBFCAM.                                                   
       COPY GNSBGPES.                                                   
      *MHM-INI 23-OCT-2003                                              
       COPY GNSBGCPT.                                                   
      *MHM-FIN 23-OCT-2003                                              

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
       COPY GNSBFLGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

      *<<<< PGM_PQ                                                      
       EXA-VEN-TSN SECTION.                                             
       INI-EXA-VEN-TSN.                                                 
                                                                        
      * Se determina si la tasacion esta vencida o no                   
                                                                        
                                                                        
      *    MOVE 'N' TO WSS-IND-TASV IN WSS-VARI.
           MOVE 'N' TO WSS-IND-TASV IN CMA-VARI.
           MOVE WSS-NO-EXA-VENC TO WSS-IND-EXAV.                        
      * Excluye los Subtipos de Garantia que no requieren Tasacion Efect
           IF TAG-NUM-PVTS IN TAG NOT > ZEROES                          
               GO TO EXA-VEN-SEG.                                       
                                                                        
      * Excluye los Creditos Hipotecarios                               
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.             
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.             
           MOVE ZEROES              TO GES-NUM-IGES IN GES.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GES.                                         
           IF NOT FIO-STAT-OKS OR                                       
              GDG-CAI-GTIA IN GDG NOT = GES-CAI-GTIA IN GES OR          
              GDG-IIC-GTIA IN GDG NOT = GES-IIC-GTIA IN GES             
               MOVE SPACES TO GES                                       
               MOVE ZEROES TO GES-IIC-GTIA IN GES                       
                              GES-FEC-FVCR IN GES                       
                              GES-NUM-IGES IN GES                       
               IF FIO-STAT-OKS                                          
                   MOVE FIO-END-BRW TO FIO-CMND                         
                   PERFORM BGL-FIO-GES                                  
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GES                                      
               IF GES-COD-SIST IN GES > SPACES                          
                   MOVE 'TAB'               TO TAB-COD-SIST             
                   MOVE 'SIS'               TO TAB-COD-TTAB IN TAB      
                   MOVE GES-COD-SIST IN GES TO TAB-COD-CTAB IN TAB      
                   PERFORM BUS-TAB                                      
                   IF MSG-COD-MENS = SPACES AND TAB-CIC-CTAB = 'HIP'    
                       GO TO EXA-VEN-SEG.                               
                                                                        
           MOVE WSS-SI-EXA-VENC TO WSS-IND-EXAV.                        
           IF TAG-COD-TPVT IN TAG = 'D'                                 
              MOVE FEC-SUM-DIA TO FEC-CMND                              
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NDIA                      
           ELSE                                                         
           IF TAG-COD-TPVT IN TAG = 'M'                                 
              MOVE FEC-SUM-MES TO FEC-CMND                              
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NMES                      
           ELSE                                                         
           IF TAG-COD-TPVT IN TAG = 'A'                                 
              MOVE FEC-SUM-ANO TO FEC-CMND                              
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NANO.                     
                                                                        
           MOVE GVT-FEC-FTSN IN GVT TO FEC-FVLD.                        
           MOVE FEC-DVLD TO FEC-ITM1.                                   
           MOVE FEC-MVLD TO FEC-ITM2.                                   
           MOVE FEC-AVLD TO FEC-ITM4.                                   
           MOVE FEC-SVLD TO FEC-ITM3.                                   
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           PERFORM CAL-FEC.                                             
           IF MSG-COD-MENS = SPACES                                     
               MOVE FEC-ITM1 TO WSS-FEC-DVTA IN WSS-VARI                
               MOVE FEC-ITM2 TO WSS-FEC-MVTA IN WSS-VARI                
               MOVE FEC-ITM4 TO WSS-FEC-AVTA IN WSS-VARI                
               MOVE FEC-ITM3 TO WSS-FEC-SVTA IN WSS-VARI                
           ELSE                                                         
               GO TO EXA-VEN-SEG.                                       
                                                                        
      * Tasacion Vencida                                                
           IF WSS-FEC-FVTA IN WSS-VARI > HOY-FHOY                       
               GO TO EXA-VEN-SEG.                                       
      *                                                                 
      *    MOVE 'S' TO WSS-IND-TASV IN WSS-VARI.
           MOVE 'S' TO WSS-IND-TASV IN CMA-VARI.
      *MHM-INI 21-OCT-2003                                              
      *     MOVE 'BGL'         TO MSG-COD-SIST.                         
      *     MOVE 'FECTSN<HOY'  TO MSG-COD-MENS.                         
      *     PERFORM GET-MSG.                                            
      *     MOVE MSG-GLS-DESC  TO FRM-MEN1.                             
      *MHM-INI 21-OCT-2003                                              
       EXA-VEN-SEG.                                                     
           MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE.             
           MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSE.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-EXA-VEN-SEG.                                   
                                                                        
      * Se determina si el seguro esta vencido o no                     
                                                                        
                                                                        
      * Excluye los Creditos Hipotecarios.                              
           IF WSS-IND-EXAV = WSS-NO-EXA-VENC                            
               GO TO FIN-EXA-VEN-SEG.                                   
                                                                        
      * Seguro Vigente.                                                 
           IF GSE-FEC-FVTS IN GSE > HOY-FHOY                            
               GO TO FIN-EXA-VEN-SEG.                                   
                                                                        
      *MHM-INI 21-OCT-2003                                              
      *     MOVE 'SEGURO VENCIDO' TO FRM-MEN2.                          
      *MHM-FIN 21-OCT-2003                                              
                                                                        
       FIN-EXA-VEN-SEG.                                                 
       FIN-EXA-VEN-TSN.                                                 
           EXIT.                                                        
                                                                        
      *>>>>                                                             
      *>>>>                                                             
       COPY GNSBPFEC.                                                   
      * COPY BGLBVUOF.                                                  
      *>>>>                                                             
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF
      *MHM-INI 11-SEP-2003
       OBT-VALOR-MONNAC SECTION.
       OBT-VALOR-MONNAC-INI.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICPESONEX'   TO MSG-COD-MENS IN MSG
               GO TO OBT-VALOR-MONNAC-FIN.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
       OBT-VALOR-MONNAC-FIN.
           EXIT.
      *MHM-FIN 11-SEP-2003
      *<<<< PGM_PU
       ESC-MOD-GVT SECTION.
       INI-ESC-MOD-GVT.
      *<<<< GEN_BCI
      *RRM-INI ACTUALIZACION   COD. ADIC. (PU)
      *ALD-ADA-INI/08112001
           MOVE GVT-CAI-GTIA IN GVT TO GDG-CAI-GTIA IN GDG.
           MOVE GVT-IIC-GTIA IN GVT TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF NOT (FIO-STAT-OKS)
               GO TO FIN-ESC-MOD-GVT.
           MOVE GDG-COD-TOPE IN GDG TO TAG-COD-TOPE IN TAG.
           MOVE GDG-COD-SOPE IN GDG TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT (FIO-STAT-OKS)
               GO TO FIN-ESC-MOD-GVT.
      *INI-AFRI/MAY-2005
      *             IF TAG-IND-CTBL IN TAG = 'N'
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-MOD-GVT.
      *EVA-AFRI/JUL2007   CTBL NOVA
      *               GDG-CAI-GTIA IN GDG = '0800'
      *FIN-AFRI/JUL2007   CTBL NOVA
      *FIN-AFRI/MAY-2005
      *                GO TO FIN-ESC-MOD-GVT.
      *ALD-ADA-FIN/08112001
      *RRM-FIN ACTUALIZACION   COD. ADIC.
      *>>>>
           MOVE ZEROES TO GMO-NUM-IMOV IN GMO.
           PERFORM INI-GMO.
           SUBTRACT 1 FROM GVT-COD-TASN IN GVT GIVING
                       GMO-NUM-TASN IN GMO.

           MOVE '2' TO GMO-COD-MOVI IN GMO.

      *MHM-INI 11-SEP-2003
      *     IF SCR-CMND = 'RTA'
           IF SCR-CMND = 'RTA' OR SCR-CMND = 'RTF'
      *MHM-FIN 11-SEP-2003
               MOVE 'R' TO GMO-COD-TMOV IN GMO
           ELSE
           IF SCR-CMND = 'RVL'
               MOVE 'V' TO GMO-COD-TMOV IN GMO
           ELSE
           IF SCR-CMND = 'ATA'
               MOVE 'A' TO GMO-COD-TMOV IN GMO
           ELSE
               MOVE SPACES TO GMO-COD-TMOV IN GMO.
      *
           MOVE FIO-PUT TO FIO-CMND.

           IF GVT-SGV-LTSN IN GVT NOT = WSS-SGV-LTSN
               MOVE 'GVT001'            TO GMO-COD-CMPO IN GMO
               MOVE WSS-SGV-LTSN        TO GMO-SGV-CMPA IN GMO
               MOVE GVT-SGV-LTSN IN GVT TO GMO-SGV-NCMP IN GMO
               PERFORM BGL-FIO-GMO
               IF NOT FIO-STAT-OKS
                   MOVE 'GMOMODGVT' TO MSG-COD-MENS
                   GO TO FIN-ESC-MOD-GVT.

           IF GVT-SGV-VCTS IN GVT NOT = WSS-SGV-VCTS
               MOVE 'GVT002'            TO GMO-COD-CMPO IN GMO
               MOVE WSS-SGV-VCTS        TO GMO-SGV-CMPA IN GMO
               MOVE GVT-SGV-VCTS IN GVT TO GMO-SGV-NCMP IN GMO
               ADD 1                    TO GMO-NUM-IMOV IN GMO
               PERFORM BGL-FIO-GMO
               IF NOT FIO-STAT-OKS
                   MOVE 'GMOMODGVT' TO MSG-COD-MENS
                   GO TO FIN-ESC-MOD-GVT.

           IF GVT-SGV-VPND IN GVT NOT = WSS-SGV-VPND
               MOVE 'GVT003'            TO GMO-COD-CMPO IN GMO
               MOVE WSS-SGV-VPND        TO GMO-SGV-CMPA IN GMO
               MOVE GVT-SGV-VPND IN GVT TO GMO-SGV-NCMP IN GMO
               ADD 1                    TO GMO-NUM-IMOV IN GMO
               PERFORM BGL-FIO-GMO
               IF NOT FIO-STAT-OKS
                   MOVE 'GMOMODGVT' TO MSG-COD-MENS
                   GO TO FIN-ESC-MOD-GVT.

           IF GVT-FEC-FTSN IN GVT NOT = WSS-FEC-FTSN IN WSS-VARI
               MOVE 'GVT004'           TO GMO-COD-CMPO IN GMO
               MOVE 'N'                TO GMO-IND-VALO IN GMO
               MOVE ZEROES             TO GMO-SGV-CMPA IN GMO
               MOVE ZEROES             TO GMO-SGV-NCMP IN GMO
               MOVE WSS-FEC-FRVL       TO GMO-GLS-CMPA IN GMO
               MOVE GVT-FEC-FRVL IN GVT TO GMO-GLS-NCMP IN GMO
               ADD 1                    TO GMO-NUM-IMOV IN GMO
               PERFORM BGL-FIO-GMO
               IF NOT FIO-STAT-OKS
                   MOVE 'GMOMODGVT' TO MSG-COD-MENS
                   GO TO FIN-ESC-MOD-GVT.

      *    Se escribe siempre para reflejar contablemente la accion
      ** EVA-INI  09/07

           PERFORM LEE-GVT-RVL.

           MOVE 'GVT005'            TO GMO-COD-CMPO IN GMO.
           MOVE 'S'                 TO GMO-IND-VALO IN GMO.
           MOVE WSS-FEC-FANR        TO GMO-GLS-CMPA IN GMO.
           MOVE WSS-FEC-FULR        TO GMO-GLS-NCMP IN GMO.

      ** EVA-FIN  09/07

           MOVE WSS-SGV-VGAS        TO GMO-SGV-CMPA IN GMO.
           MOVE GVT-SGV-VGAS IN GVT TO GMO-SGV-NCMP IN GMO.
           ADD 1                    TO GMO-NUM-IMOV IN GMO.

           IF (SCR-CMND = 'RVL' OR SCR-CMND = 'RTA')
              MOVE GVT-CAI-GTIA IN GVT-FLD TO GDG-CAI-GTIA IN GDG
              MOVE GVT-IIC-GTIA IN GVT-FLD TO GDG-IIC-GTIA IN GDG
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM BGL-FIO-GDG
              MOVE FIO-PUT TO FIO-CMND.

           MOVE GDG-VAL-CCON IN GDG TO GMO-VAL-CCON IN GMO.
           MOVE GDG-VAL-CCOM IN GDG TO GMO-VAL-CCOM IN GMO.
           PERFORM BGL-FIO-GMO.
           IF NOT FIO-STAT-OKS
               MOVE 'GMOMODGVT' TO MSG-COD-MENS
               GO TO FIN-ESC-MOD-GVT.
       FIN-ESC-MOD-GVT.
           EXIT.

       INI-GMO SECTION.
       INI-INI-GMO.
               MOVE SPACES   TO GMO-GLS-FLAG IN GMO.
               MOVE ZEROES   TO GMO-NUM-TASN IN GMO.
               MOVE SPACES   TO GMO-COD-CMPO IN GMO.
               MOVE SPACES   TO GMO-COD-CLVA IN GMO.
               MOVE SPACES   TO GMO-GLS-CMPA IN GMO.
               MOVE ZEROES   TO GMO-SGV-CMPA IN GMO.
               MOVE SPACES   TO GMO-COD-NCLV IN GMO.
               MOVE SPACES   TO GMO-GLS-NCMP IN GMO.
               MOVE ZEROES   TO GMO-SGV-NCMP IN GMO.
               MOVE SPACES   TO GMO-COD-TMOV IN GMO.
               MOVE SPACES   TO GMO-GLS-DISP IN GMO.

               PERFORM GET-FHOY.
               MOVE HOY-FHOY TO GMO-FEC-FMOV IN GMO.
               MOVE HOY-HHOY TO GMO-HRA-HMOV IN GMO.
      *<<<< PGM_MVS OR PGM_DOS
               MOVE SCR-OTRN TO GMO-TML-TMOV IN GMO.
               MOVE SCR-USER TO GMO-CIC-UING IN GMO.
      *<<<<
               MOVE HOY-FHOY                TO GMO-FEC-FING IN GMO.
               MOVE GVT-CAI-GTIA IN GVT     TO GMO-CAI-GTIA IN GMO.
               MOVE GVT-IIC-GTIA IN GVT     TO GMO-IIC-GTIA IN GMO.
               MOVE GDG-COD-OFIC IN GVT-FLD TO GMO-COD-OFMV IN GMO.
               ADD 1                        TO GMO-NUM-IMOV IN GMO.
               MOVE 'S'                     TO GMO-IND-VALO IN GMO.
               MOVE 'N'                     TO GMO-IND-CLVE IN GMO.
       FIN-INI-GMO.
           EXIT.


       ELI-GTP SECTION.
       INI-ELI-GTP.
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP.
           MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP.
           MOVE 1                       TO GTP-COD-ITSN IN GTP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GTP.
           IF FIO-STAT-OKS AND
              GVT-CAI-GTIA IN GVT-FLD = GTP-CAI-GTIA IN GTP AND
              GVT-IIC-GTIA IN GVT-FLD = GTP-IIC-GTIA IN GTP AND
              GVT-COD-TASN IN GVT-FLD = GTP-NUM-ITSN IN GTP
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM BGL-FIO-GTP
               MOVE FIO-DEL TO FIO-CMND
               PERFORM BGL-FIO-GTP
               GO TO INI-ELI-GTP.
       FIN-ELI-GTP.
           EXIT.

       COP-GTP SECTION.
       INI-COP-GTP.
           MOVE SPACES TO MSG-COD-MENS.
           IF FRM-IND-GTP IN GVT-FLD NOT = 'S'
               GO TO FIN-COP-GTP.

           MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP.

           SUBTRACT 1 FROM GVT-COD-TASN IN GVT-FLD GIVING
                          GTP-NUM-ITSN IN GTP.

           MOVE 1      TO GTP-COD-ITSN IN GTP.
           MOVE FIO-GET-KEY TO FIO-CMND.
       LUP-COP-GTP.
           PERFORM BGL-FIO-GTP.
           IF NOT (FIO-STAT-OKS AND
              GVT-CAI-GTIA IN GVT-FLD = GTP-CAI-GTIA IN GTP AND
              GVT-IIC-GTIA IN GVT-FLD = GTP-IIC-GTIA IN GTP AND
              (GVT-COD-TASN IN GVT-FLD - 1 ) = GTP-NUM-ITSN IN GTP)
               GO TO FIN-COP-GTP
           ELSE
               MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP
               MOVE FIO-PUT TO FIO-CMND
               PERFORM BGL-FIO-GTP
               IF NOT FIO-STAT-OKS
                   MOVE 'GTP    PUTNO' TO MSG-COD-MENS
                   MOVE FIO-MENS       TO FRM-MENS
               ELSE
                   SUBTRACT 1 FROM GVT-COD-TASN IN GVT-FLD GIVING
                            GTP-NUM-ITSN IN GTP
                   ADD 1 TO GTP-COD-ITSN IN GTP
                   MOVE FIO-GET-KEY TO FIO-CMND
                   GO TO LUP-COP-GTP.
       FIN-COP-GTP.
           EXIT.

       REV-GDG-GTP SECTION.
       INI-REV-GDG-GTP.
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF GDG-IND-GTAC IN GDG NOT = 'S'
              MOVE 'A' TO GVT-MSC-STAT IN GVT
              GO TO FIN-REV-GDG-GTP.

           IF GDG-IND-EGTP IN GDG = 'S'
              MOVE 'I' TO GVT-MSC-STAT IN GVT
           ELSE
              MOVE 'A' TO GVT-MSC-STAT IN GVT.

       FIN-REV-GDG-GTP.
           EXIT.
      *>>>>
      *<<<< GEN_BCI
       OBT-VAL-RTF SECTION.
       INI-OBT-VAL-RTF.
           PERFORM LEE-GVT-RVL.
           MOVE WSS-NUM-SULR   TO CAM-NUM-SCAM IN CAM(1).
           MOVE WSS-NUM-AULR   TO CAM-NUM-ACAM IN CAM(1).
           MOVE WSS-NUM-MULR   TO CAM-NUM-MCAM IN CAM(1).
           MOVE WSS-NUM-DULR   TO CAM-NUM-DCAM IN CAM(1).

           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE GDG-COD-VCAM IN GVT-FLD  TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
              )
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-OBT-VAL-RTF.

           MULTIPLY GVT-SGV-LTSN IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED.
           MOVE WSS-VAL-PESO TO GVT-SGV-LTSN IN GVT.

           MULTIPLY GVT-SGV-VCTS IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED.
           MOVE WSS-VAL-PESO TO GVT-SGV-VCTS IN GVT.

           MULTIPLY GVT-SGV-VPND IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED.
           MOVE WSS-VAL-PESO TO GVT-SGV-VPND IN GVT.

           MULTIPLY GVT-SGV-VGAS IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED.
           MOVE WSS-VAL-PESO TO GVT-SGV-VGAS IN GVT.
       FIN-OBT-VAL-RTF.
           EXIT.

       EXC-NOR-TAS SECTION.
       INI-EXC-NOR-TAS.
           IF GDG-COD-LGTA IN GDG = 'E'
               PERFORM GAR-ESP
           ELSE
               PERFORM GAR-GRL.
       FIN-EXC-NOR-TAS.
           EXIT.

       GAR-ESP SECTION.
       INI-GAR-ESP.
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.
           MOVE 'S'    TO WSS-IND-HIPT IN WSS-VARI.
           MOVE 'N'    TO WSS-IND-ENFE IN WSS-VARI.
           MOVE 'N'    TO WSS-IND-ENT1 IN WSS-VARI.
           MOVE 'N'    TO WSS-IND-ENT2 IN WSS-VARI.
           MOVE 'N'    TO WSS-IND-ENT3 IN WSS-VARI.

           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.
           MOVE ZEROES TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GAR-ESP.
           PERFORM BGL-FIO-GES.
           IF NOT ( FIO-STAT-OKS AND
              GES-CAI-GTIA IN GES = GDG-CAI-GTIA AND
              GES-IIC-GTIA IN GES = GDG-IIC-GTIA )
               GO TO CNT-GAR-ESP.

           MOVE GES-CAI-IOPC IN GES TO OPC-CAI-IOPC IN OPC.
           MOVE GES-IIC-IOPC IN GES TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GAR-ESP.

      *MHM-INI 22-OCT-2003
           IF OPC-MSC-STAT IN OPC NOT = 'A' OR
              OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO NXT-GAR-ESP.
      *MHM-FIN 22-OCT-2003

           IF OPC-MSC-STAT IN OPC = 'A'
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.

           IF OPC-COD-TOPC IN OPC NOT = 'F'
               MOVE 'N' TO WSS-IND-HIPT IN WSS-VARI
               PERFORM CMP-FEC.

       NXT-GAR-ESP.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GAR-ESP.

       CNT-GAR-ESP.
           IF WSS-VAL-SCRE IN WSS-VARI NOT > ZEROES
               MOVE 'S' TO WSS-IND-ENT1 IN WSS-VARI.

           IF WSS-IND-HIPT IN WSS-VARI = 'S'
               MOVE 'S' TO WSS-IND-ENT2 IN WSS-VARI.

           IF WSS-IND-ENFE IN WSS-VARI = 'S'
               MOVE 'S' TO WSS-IND-ENT3 IN WSS-VARI.

       FIN-GAR-ESP.
           EXIT.

       CMP-FEC SECTION.
       INI-CMP-FEC.
           PERFORM LEE-TIO.
           IF WSS-CIC-TOPE IN WSS-VARI = '951'
               MOVE 2 TO FEC-NANO
           ELSE
               MOVE 1 TO FEC-NANO.
           PERFORM LEE-GVT.
           IF WSS-FEC-FTSN IN WSS-VARI NOT > SPACES
               GO TO FIN-CMP-FEC.
           PERFORM RST-FECHA.
           IF WSS-FEC-FTRA IN WSS-VARI NOT < OPC-FEC-FINP IN OPC AND
              OPC-VAL-SCRE IN OPC > ZEROES
               MOVE 'S' TO WSS-IND-ENFE IN WSS-VARI.
       FIN-CMP-FEC.
           EXIT.

       LEE-TIO SECTION.
       INI-LEE-TIO.
           MOVE SPACES              TO WSS-CIC-TOPE IN WSS-VARI.
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE GDG-COD-TOPE IN GDG TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOPE IN WSS-VARI.
       FIN-LEE-TIO.
           EXIT.

       LEE-GVT SECTION.
       INI-LEE-GVT.
           MOVE GVT-NUM-STSN IN GVT-FLD TO WSS-NUM-STSN IN WSS-VARI.
           MOVE GVT-NUM-ATSN IN GVT-FLD TO WSS-NUM-ATSN IN WSS-VARI.
           MOVE GVT-NUM-MTSN IN GVT-FLD TO WSS-NUM-MTSN IN WSS-VARI.
           MOVE GVT-NUM-DTSN IN GVT-FLD TO WSS-NUM-DTSN IN WSS-VARI.
       FIN-LEE-GVT.
           EXIT.


       RST-FECHA SECTION.
       INI-RST-FECHA.
           MOVE SPACES TO WSS-FEC-FTRA IN WSS-VARI.
           MOVE WSS-NUM-DTSN IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MTSN IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-STSN IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ATSN IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-ANO  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-ITM1 TO WSS-NUM-DTRA IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-NUM-MTRA IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-NUM-STRA IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-NUM-ATRA IN WSS-VARI.
       FIN-RST-FECHA.
           EXIT.

       GAR-GRL SECTION.
       INI-GAR-GRL.
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.
           MOVE 'S'    TO WSS-IND-HIPT IN WSS-VARI.
           MOVE 'N'    TO WSS-IND-ENFE IN WSS-VARI.
           MOVE 'N'    TO WSS-IND-ENT1 IN WSS-VARI.
           MOVE 'N'    TO WSS-IND-ENT2 IN WSS-VARI.
           MOVE 'N'    TO WSS-IND-ENT3 IN WSS-VARI.

           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GDD-GAR-GRL.
           PERFORM BGL-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
              GDD-CAI-GTIA IN GDD = GDG-CAI-GTIA AND
              GDD-IIC-GTIA IN GDD = GDG-IIC-GTIA )
               GO TO CNT-GAR-GRL.

           MOVE GDD-CAI-DCLI IN GDD TO RDC-CAI-ICLI IN RDC.
           MOVE GDD-IIC-DCLI IN GDD TO RDC-IIC-ICLI IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-RDC-GAR-GRL.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-CAI-ICLI IN RDC = GDD-CAI-DCLI IN GDD AND
              RDC-IIC-ICLI IN RDC = GDD-IIC-DCLI IN GDD )
               GO TO NXT-GDD-GRL.

           MOVE RDC-CAI-IOPC IN RDC TO OPC-CAI-IOPC IN OPC.
           MOVE RDC-IIC-IOPC IN RDC TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-RDC-GRL.

      *MHM-INI 22-OCT-2003
           IF OPC-MSC-STAT IN OPC NOT = 'A' OR
              OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO NXT-RDC-GRL.
      *MHM-FIN 22-OCT-2003

           IF OPC-MSC-STAT IN OPC = 'A'
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.

           IF OPC-COD-TOPC IN OPC NOT = 'F'
               MOVE 'N' TO WSS-IND-HIPT IN WSS-VARI
               PERFORM CMP-FEC.

       NXT-RDC-GRL.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-RDC-GAR-GRL.

       NXT-GDD-GRL.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           GO TO LUP-GDD-GAR-GRL.

       CNT-GAR-GRL.
           IF WSS-VAL-SCRE IN WSS-VARI NOT > ZEROES
               MOVE 'S' TO WSS-IND-ENT1 IN WSS-VARI.

           IF WSS-IND-HIPT IN WSS-VARI = 'S'
               MOVE 'S' TO WSS-IND-ENT2 IN WSS-VARI.

           IF WSS-IND-ENFE IN WSS-VARI = 'S'
               MOVE 'S' TO WSS-IND-ENT3 IN WSS-VARI.

       FIN-GAR-GRL.
           EXIT.


      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

       LEE-GDD SECTION.
      *===================
       INI-LEE-GDD.

           MOVE GVT-CAI-GTIA IN GVT   TO GDD-CAI-GTIA IN GDD.
           MOVE GVT-IIC-GTIA IN GVT   TO GDD-IIC-GTIA IN GDD.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM BGL-FIO-GDD.

       FIN-LEE-GDD.
           EXIT.


       LLENAR-ANTES SECTION.
       INI-LLENAR-ANTES.
      *------------------
           MOVE SPACES TO LGN.
           IF SCR-CMND = 'MOD'
              MOVE 'MOD'  TO LGN-COD-EVEN IN LGN
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'ATA'
              MOVE 'ATA'  TO LGN-COD-EVEN IN LGN
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'MTA'
              MOVE 'MTA'  TO LGN-COD-EVEN IN LGN
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'RTA'
              MOVE 'RTA'  TO LGN-COD-EVEN IN LGN
              MOVE 'A'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'RVL'
              MOVE 'RVL'  TO LGN-COD-EVEN IN LGN
              MOVE 'A'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'RTF'
              MOVE 'RTF'  TO LGN-COD-EVEN IN LGN
              MOVE 'A'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           IF SCR-CMND = 'ELI'
              MOVE 'ELI'  TO LGN-COD-EVEN IN LGN
              MOVE 'E'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
           MOVE 'ANT'  TO LGN-COD-INST IN LGN.
           MOVE 1      TO LGN-NUM-CLGN IN LGN
                          LGN-NUM-COPE IN LGN
                          LGN-NUM-CCLI IN LGN
                          LGN-NUM-CEVE IN LGN
                          LGN-NUM-CAUT IN LGN.

           MOVE GVT-COD-TASN IN GVT      TO LGN-COD-LN01 IN LGN.
           MOVE GVT-FEC-FTRN IN GVT      TO LGN-COD-LN02 IN LGN.
           MOVE GVT-HRA-HRTR IN GVT      TO LGN-COD-LN02 IN LGN(11:6).
           MOVE GVT-MSC-TTRN IN GVT      TO LGN-COD-LN03 IN LGN.
           MOVE GVT-COD-TTRN IN GVT      TO LGN-COD-LN04 IN LGN.
           MOVE GVT-COD-ATRN IN GVT      TO LGN-COD-LN05 IN LGN.
           MOVE GVT-FEC-FTSN IN GVT      TO LGN-COD-LN06 IN LGN.

           MOVE GVT-SGV-LTSN IN GVT      TO WSG-SGV-LTSN IN WSS-VARI.
           MOVE WSG-SGV-LTSN IN WSS-VARI TO LGN-COD-LN07 IN LGN.

           MOVE GVT-SGV-VCTS IN GVT      TO WSG-SGV-VCTS IN WSS-VARI.
           MOVE WSG-SGV-VCTS IN WSS-VARI TO LGN-COD-LN08 IN LGN.

           MOVE GVT-SGV-PPCT IN GVT      TO WSG-SGV-PPCT IN WSS-VARI.
           MOVE WSG-SGV-PPCT IN WSS-VARI TO LGN-COD-LN09 IN LGN.

           MOVE GVT-SGV-VPND IN GVT      TO WSG-SGV-VPND IN WSS-VARI.
           MOVE WSG-SGV-VPND IN WSS-VARI TO LGN-COD-LN10 IN LGN.

           MOVE GVT-SGV-PAJU IN GVT      TO WSG-SGV-PAJU IN WSS-VARI.
           MOVE WSG-SGV-PAJU IN WSS-VARI TO LGN-COD-LN11 IN LGN.

           MOVE GVT-SGV-VGAS IN GVT      TO WSG-SGV-VGAS IN WSS-VARI.
           MOVE WSG-SGV-VGAS IN WSS-VARI TO LGN-COD-LN12 IN LGN.

           MOVE GVT-SGV-VSIN IN GVT      TO WSG-SGV-VSIN IN WSS-VARI.
           MOVE WSG-SGV-VSIN IN WSS-VARI TO LGN-COD-LN13 IN LGN.

           MOVE GVT-COD-ITSD IN GVT      TO LGN-COD-LN14 IN LGN.
           MOVE GVT-COD-ISVS IN GVT      TO LGN-COD-LN15 IN LGN.
           MOVE GVT-FEC-FRVL IN GVT      TO LGN-COD-LN16 IN LGN.
           MOVE GVT-COD-CRIT IN GVT      TO LGN-COD-LN17 IN LGN.
           MOVE GVT-COD-OAVA IN GVT      TO LGN-COD-LN18 IN LGN.

           MOVE GVT-SGV-FISI IN GVT      TO WSG-SGV-FISI IN WSS-VARI.
           MOVE WSG-SGV-FISI IN WSS-VARI TO LGN-COD-LN19 IN LGN.

           MOVE GVT-FEC-FING IN GVT      TO LGN-COD-LN20 IN LGN.
           MOVE GVT-CIC-UING IN GVT      TO LGN-COD-LN21 IN LGN.

           MOVE GVT-SGV-FISC IN GVT      TO WSG-SGV-FISC IN WSS-VARI.
           MOVE WSG-SGV-FISC IN WSS-VARI TO LGN-COD-LN22 IN LGN.

           MOVE GVT-FEC-FURV IN GVT      TO LGN-COD-LN23 IN LGN.

           MOVE GVT-SGV-VTTL IN GVT      TO WSG-SGV-VTTL IN WSS-VARI.
           MOVE WSG-SGV-VTTL IN WSS-VARI TO LGN-COD-LN24 IN LGN.

       FIN-LLENAR-ANTES.
           EXIT.

       LLENAR-DESPUES SECTION.
       INI-LLENAR-DESPUES.
      *------------------
           MOVE SPACES               TO  LGN.

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-ING
      *       MOVE WSS-CTE-ING  TO LGN-COD-CMND IN LGN
              MOVE WSS-CTE-ING  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-I    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'MOD'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'MOD'  TO LGN-COD-EVEN IN LGN.
              MOVE  WSS-CTE-MOD TO LGN-COD-EVEN IN LGN
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              MOVE 'M'    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.

           IF SCR-CMND = 'ATA'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'ATA'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-ATA  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'MTA'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'MTA'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-MTA  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'RTA'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'RTA'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-RTA  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'RVL'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'RVL'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-RVL  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'RTF'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'RTF'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-RTF  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-M    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           IF SCR-CMND = 'ELI'
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *       MOVE 'ELI'  TO LGN-COD-EVEN IN LGN.
              MOVE WSS-CTE-ELI  TO LGN-COD-EVEN IN LGN
              MOVE WSS-CTE-E    TO LGN-COD-TACC IN LGN
                             LGN-COD-STAT IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2


           MOVE 'DES'                TO  LGN-COD-INST IN LGN.
           MOVE 2                    TO  LGN-NUM-CLGN IN LGN
                                         LGN-NUM-COPE IN LGN
                                         LGN-NUM-CCLI IN LGN
                                         LGN-NUM-CEVE IN LGN
                                         LGN-NUM-CAUT IN LGN.

           MOVE GVT-COD-TASN IN GVT      TO LGN-COD-LN01 IN LGN.
           MOVE GVT-FEC-FTRN IN GVT      TO LGN-COD-LN02 IN LGN.
           MOVE GVT-HRA-HRTR IN GVT      TO LGN-COD-LN02 IN LGN(11:6).
           MOVE GVT-MSC-TTRN IN GVT      TO LGN-COD-LN03 IN LGN.
           MOVE GVT-COD-TTRN IN GVT      TO LGN-COD-LN04 IN LGN.
           MOVE GVT-COD-ATRN IN GVT      TO LGN-COD-LN05 IN LGN.
           MOVE GVT-FEC-FTSN IN GVT      TO LGN-COD-LN06 IN LGN.

           MOVE GVT-SGV-LTSN IN GVT      TO WSG-SGV-LTSN IN WSS-VARI.
           MOVE WSG-SGV-LTSN IN WSS-VARI TO LGN-COD-LN07 IN LGN.

           MOVE GVT-SGV-VCTS IN GVT      TO WSG-SGV-VCTS IN WSS-VARI.
           MOVE WSG-SGV-VCTS IN WSS-VARI TO LGN-COD-LN08 IN LGN.

           MOVE GVT-SGV-PPCT IN GVT      TO WSG-SGV-PPCT IN WSS-VARI.
           MOVE WSG-SGV-PPCT IN WSS-VARI TO LGN-COD-LN09 IN LGN.

           MOVE GVT-SGV-VPND IN GVT      TO WSG-SGV-VPND IN WSS-VARI.
           MOVE WSG-SGV-VPND IN WSS-VARI TO LGN-COD-LN10 IN LGN.

           MOVE GVT-SGV-PAJU IN GVT      TO WSG-SGV-PAJU IN WSS-VARI.
           MOVE WSG-SGV-PAJU IN WSS-VARI TO LGN-COD-LN11 IN LGN.

           MOVE GVT-SGV-VGAS IN GVT      TO WSG-SGV-VGAS IN WSS-VARI.
           MOVE WSG-SGV-VGAS IN WSS-VARI TO LGN-COD-LN12 IN LGN.

           MOVE GVT-SGV-VSIN IN GVT      TO WSG-SGV-VSIN IN WSS-VARI.
           MOVE WSG-SGV-VSIN IN WSS-VARI TO LGN-COD-LN13 IN LGN.

           MOVE GVT-COD-ITSD IN GVT      TO LGN-COD-LN14 IN LGN.
           MOVE GVT-COD-ISVS IN GVT      TO LGN-COD-LN15 IN LGN.
           MOVE GVT-FEC-FRVL IN GVT      TO LGN-COD-LN16 IN LGN.
           MOVE GVT-COD-CRIT IN GVT      TO LGN-COD-LN17 IN LGN.
           MOVE GVT-COD-OAVA IN GVT      TO LGN-COD-LN18 IN LGN.

           MOVE GVT-SGV-FISI IN GVT      TO WSG-SGV-FISI IN WSS-VARI.
           MOVE WSG-SGV-FISI IN WSS-VARI TO LGN-COD-LN19 IN LGN.

           MOVE GVT-FEC-FING IN GVT      TO LGN-COD-LN20 IN LGN.

           MOVE GVT-CIC-UING IN GVT      TO LGN-COD-LN21 IN LGN.

           MOVE GVT-SGV-FISC IN GVT      TO WSG-SGV-FISC IN WSS-VARI.
           MOVE WSG-SGV-FISC IN WSS-VARI TO LGN-COD-LN22 IN LGN.

           MOVE GVT-FEC-FURV IN GVT      TO LGN-COD-LN23 IN LGN.

           MOVE GVT-SGV-VTTL IN GVT      TO WSG-SGV-VTTL IN WSS-VARI.
           MOVE WSG-SGV-VTTL IN WSS-VARI TO LGN-COD-LN24 IN LGN.


       FIN-LLENAR-DESPUES.
           EXIT.


       GRABAR-LGN SECTION.
      *===================
       INI-GRABAR-LGN.

           MOVE SCR-SISG TO FIO-SIST.

           EXEC CICS ASKTIME ABSTIME(WSS-LGM-ABSTIME)
           END-EXEC.
           PERFORM GET-FHOY.
           MOVE '1.0'               TO LGN-COD-VERS IN LGN.
           MOVE 'GVT'               TO LGN-COD-ENTF IN LGN
                                       LGN-COD-ENTO IN LGN
                                       LGN-COD-ENTE IN LGN
                                       LGN-COD-ENTC IN LGN
                                       LGN-COD-ENTA IN LGN.
           MOVE HOY-FHOY            TO LGN-FEC-FTRN IN LGN
                                       LGN-FEC-FLGN IN LGN
                                       LGN-FEC-FOPE IN LGN
                                       LGN-FEC-FEVE IN LGN
                                       LGN-FEC-FCLI IN LGN
                                       LGN-FEC-FAUT IN LGN.
           MOVE HOY-HHOY            TO LGN-HRA-HRTR IN LGN
                                       LGN-HRA-HLGN IN LGN
                                       LGN-HRA-HOPE IN LGN
                                       LGN-HRA-HEVE IN LGN
                                       LGN-HRA-HCLI IN LGN
                                       LGN-HRA-HAUT IN LGN.
           MOVE TSK-TERM-NUM        TO LGN-TSK-NUMF IN LGN
                                       LGN-TSK-NUMO IN LGN
                                       LGN-TSK-NUME IN LGN
                                       LGN-TSK-NUMC IN LGN
                                       LGN-TSK-NUMA IN LGN.
           MOVE WSS-LGM-ABSTIME     TO LGN-NUM-ABSF IN LGN
                                       LGN-NUM-ABSO IN LGN
                                       LGN-NUM-ABSE IN LGN
                                       LGN-NUM-ABSC IN LGN
                                       LGN-NUM-ABSA IN LGN.
           MOVE GVT-CIC-GTIA IN GVT TO LGN-CIC-IOPE IN LGN.
           MOVE GDD-CIC-DCLI IN GDD TO LGN-CIC-ICLI IN LGN.
      *MPB-INI  31-ENE-2018 LIMPIEZA CAMPO COD-OTRN
      *    MOVE EIBTRMID            TO LGN-COD-OTRN IN LGN.
           IF SCR-OFRM-SRV
               MOVE SCR-ORIG TO LGN-COD-OTRN IN LGN
           ELSE
               IF NOT SCR-OFRM-SRV
           MOVE SPACES              TO LGN-COD-OTRN IN LGN.
      *MPB-FIN
           MOVE SCR-USER            TO LGN-COD-ATRN IN LGN
                                       LGN-COD-AUTO IN LGN.
           MOVE EIBTRNID            TO LGN-COD-TCIC IN LGN.

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-ING
              MOVE WSS-CTE-ING  TO LGN-COD-CMND IN LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = 'MOD'
              MOVE 'MOD'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'ATA'
              MOVE 'ATA'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'MTA'
              MOVE 'MTA'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'RTA'
              MOVE 'RTA'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'RVL'
              MOVE 'RVL'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'RTF'
              MOVE 'RTF'  TO LGN-COD-CMND IN LGN.
           IF SCR-CMND = 'ELI'
              MOVE 'ELI'  TO LGN-COD-CMND IN LGN.
            MOVE FIO-PUT TO FIO-CMND.
            PERFORM GNS-FIO-LGN.
       FIN-GRABAR-LGN.
           EXIT.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

       COPY BGLBKVCG.
       COPY BGLBGVCG.
      *MHM-INI 16-OCT-2003
       REST-VAL-GVT SECTION.
       INI-REST-VAL-GVT.
           MOVE WSS-SGV-LTSN IN CMA-VARI TO GVT-SGV-LTSN IN GVT.
           MOVE WSS-SGV-VCTS IN CMA-VARI TO GVT-SGV-VCTS IN GVT.
           MOVE WSS-SGV-VPND IN CMA-VARI TO GVT-SGV-VPND IN GVT.
           MOVE WSS-SGV-VGAS IN CMA-VARI TO GVT-SGV-VGAS IN GVT.
       FIN-REST-VAL-GVT.
           EXIT.
      *MHM-FIN 16-OCT-2003
      *>>>>
       COPY BGLBFGDG.
       COPY BGLBFACC.
       COPY BGLBFGDP.
      *<<<< GEN_BCI
       COPY BGLBFGSO.
      *>>>>
       COPY TABBFIVB.
       COPY TABBFUSR.
      *<<<< GEN_BCI
       COPY BGLBFGDD.
       COPY COLBFRDC.
       COPY COLBFOPC.
      *>>>>
       COPY BGLBFGES.
*% IF PGM_PU
      *<<<< PGM_PU
       COPY BGLBFGMO.
      *>>>>
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
       COPY BGLBFETP.
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
*% END
       COPY BGLBFGSE.
       COPY BGLBFGTP.
       COPY BGLBFTAG.
       COPY TABBFCAM.
       COPY GNSBGPES.
      *MHM-INI 23-OCT-2003
       COPY GNSBGCPT.
      *MHM-FIN 23-OCT-2003
       COPY GNSBPFEC.
      *>>>>

      ** EVA-INI  09/07

       LEE-GVT-RVL SECTION.
       INI-LEE-GVT-RVL.

           IF GVT-FEC-FTSN IN GVT > GVT-FEC-FRVL IN GVT
              MOVE GVT-NUM-STSN IN GVT TO WSS-NUM-SULR
              MOVE GVT-NUM-ATSN IN GVT TO WSS-NUM-AULR
              MOVE GVT-NUM-MTSN IN GVT TO WSS-NUM-MULR
              MOVE GVT-NUM-DTSN IN GVT TO WSS-NUM-DULR
           ELSE
              MOVE GVT-NUM-SRVL IN GVT TO WSS-NUM-SULR
              MOVE GVT-NUM-ARVL IN GVT TO WSS-NUM-AULR
              MOVE GVT-NUM-MRVL IN GVT TO WSS-NUM-MULR
              MOVE GVT-NUM-DRVL IN GVT TO WSS-NUM-DULR.

           IF GVT-FEC-FURV IN GVT > WSS-FEC-FULR
              MOVE GVT-NUM-SURV IN GVT TO WSS-NUM-SULR
              MOVE GVT-NUM-AURV IN GVT TO WSS-NUM-AULR
              MOVE GVT-NUM-MURV IN GVT TO WSS-NUM-MULR
              MOVE GVT-NUM-DURV IN GVT TO WSS-NUM-DULR.

       FIN-LEE-GVT-RVL.
           EXIT.

      ** EVA-FIN  09/07

      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
       PRO-GRB-ETP SECTION.
       INI-PRO-GRB-ETP.
           PERFORM LEE-ULT-ETP.
           IF WSS-NUM-CONT IN WSS-VARI = ZEROES
               GO TO FIN-PRO-GRB-ETP.

           MOVE SPACES                   TO ETP.
           MOVE GVT-CIC-GTIA IN GVT      TO ETP-CIC-GTIA IN ETP.
           MOVE WSS-NUM-CONT IN WSS-VARI TO ETP-NUM-CONT IN ETP.
           MOVE HOY-FHOY                 TO ETP-FEC-FTRN IN ETP.
           MOVE HOY-HHOY                 TO ETP-HRA-HRTR IN ETP.
           MOVE SPACES                   TO ETP-MSC-TACC IN ETP.
           MOVE SPACES                   TO ETP-MSC-STAT IN ETP.
           MOVE SPACES                   TO ETP-COD-OTRN IN ETP.
           MOVE 'BGLPUGVT'               TO ETP-COD-ATRN IN ETP.
           MOVE GDG-COD-CGTA IN GDG      TO ETP-COD-CGTA IN ETP.
           MOVE GVT-FEC-FTSN IN GVT      TO ETP-FEC-FTAS IN ETP.
           MOVE GVT-COD-TASN IN GVT      TO ETP-COD-TASN IN ETP.
           MOVE GVT-COD-SDAG IN GVT      TO ETP-NUM-SOLI IN ETP.
           MOVE GVT-IND-IEXC IN GVT      TO ETP-IND-IEXC IN ETP.
           MOVE SPACES                   TO ETP-GLS-DISP IN ETP.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM BGL-FIO-ETP.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE 'ETP NO UPD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-PRO-GRB-ETP.
           EXIT.

       LEE-ULT-ETP SECTION.
       INI-LEE-ULT-ETP.
           MOVE ZEROES TO WSS-NUM-CONT IN WSS-VARI.
           MOVE GVT-CAI-GTIA IN GVT-FLD TO ETP-CAI-GTIA IN ETP.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO ETP-IIC-GTIA IN ETP.
           MOVE 999                 TO ETP-NUM-CONT IN ETP.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM BGL-FIO-ETP.
           IF NOT FIO-STAT-OKS OR
            (GVT-CAI-GTIA IN GVT-FLD NOT = ETP-CAI-GTIA IN ETP
             AND GVT-IIC-GTIA IN GVT-FLD NOT = ETP-IIC-GTIA IN ETP)
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'ETP      NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-LEE-ULT-ETP
           ELSE
               MOVE ETP-NUM-CONT IN ETP TO WSS-NUM-CONT IN WSS-VARI
               ADD 1 TO WSS-NUM-CONT IN WSS-VARI.

       FIN-LEE-ULT-ETP.
           EXIT.
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
*% END
*% IF CMN_ELI
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LEE-GDD.
           PERFORM LLENAR-ANTES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        ERROR INCONSISTENCIA EN LA ELIMINACION : INFORMAR
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           IF FRM-IND-GTP IN GVT-FLD = 'S'
               PERFORM ELI-GTP.

           MOVE GAR-CAI-GTIA IN CMA-VARI TO GDG-CAI-GTIA IN GDG.
           MOVE GAR-IIC-GTIA IN CMA-VARI TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

      * Para saber si queda o no un hijo y grabar el Indicador en GDG
           MOVE SPACES                   TO GVT-KEY-IGVT IN GVT.
           MOVE GAR-CAI-GTIA IN CMA-VARI TO GVT-CAI-GTIA IN GVT.
           MOVE GAR-IIC-GTIA IN CMA-VARI TO GVT-IIC-GTIA IN GVT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'GVT-KEY-IGVT' TO FIO-AKEY.
           PERFORM BGL-FIO-GVT.
           IF NOT (
                   FIO-STAT-OKS AND
                   GVT-CAI-GTIA IN GVT = GAR-CAI-GTIA IN CMA-VARI AND
                   GVT-IIC-GTIA IN GVT = GAR-IIC-GTIA IN CMA-VARI
                  )
      *        No quedo ningun hijo
               MOVE ' ' TO GDG-IND-EGVT IN GDG.

           SUBTRACT 1
               FROM GVT-COD-TASN IN GVT-FLD
             GIVING GDG-COD-TSCN IN GDG.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS.
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
      *MHM-INI 11-SEP-2003
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'         TO MSG-COD-SIST
               MOVE 'GDG    NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.

      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
           PERFORM KEY-ALL-GVT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GVT.
           MOVE GVT-IND-IEXC IN GVT TO WSS-IND-IEXC IN WSS-VARI.
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      *MHM-FIN 11-SEP-2003
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           PERFORM LEE-GDD.
           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CCPP = 'ACC' AND SCR-STPP NOT = SCR-STAT-CON
               PERFORM CMN-ING
               IF FIO-STAT-OKS
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *        PERFORM LLENAR-DESPUES
      *        PERFORM GRABAR-LGN
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *MHM-INI 11-SEP-2003
               IF SCR-CMND = 'RTF'
                   MOVE 'BGL'        TO MSG-COD-SIST
                   MOVE 'RTF    SI'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *MHM-FIN 11-SEP-2003
                   MOVE 'BGL'        TO MSG-COD-SIST
                   MOVE 'RTARVL SI'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    ERCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
           ELSE
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'REG    ERCOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF FIN_CMN_ACC
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
      *MHM-INI 11-SEP-2003
               IF SCR-CMND = 'RTF'
                   MOVE 'BGL'        TO MSG-COD-SIST
                   MOVE 'RTF    NO'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *MHM-FIN 11-SEP-2003
               IF SCR-CCPP = 'ACC' AND SCR-STPP NOT = SCR-STAT-CON
                   MOVE 'BGL'        TO MSG-COD-SIST
                   MOVE 'RTARVL NO'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
      *<<<< GEN_BCI
           IF SCR-CMND = 'RTF'
               PERFORM OBT-VALOR-MONNAC
               PERFORM OBT-VAL-RTF.
      *>>>>
           MOVE SPACES TO GVT-GLS-FLAG IN GVT.
           MOVE SPACES TO GVT-MSC-TACC IN GVT.
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *     MOVE SPACES TO GVT-CIC-UING IN GVT.
           MOVE SCR-USER TO GVT-CIC-UING IN GVT.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           MOVE 'I'    TO GVT-MSC-STAT IN GVT.

      *>>>>
*% END
*% IF INI_CMN_MOD
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LEE-GDD.
           PERFORM LLENAR-ANTES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
      *        ERROR INCONSISTENCIA EN LA MODIFICACION : INFORMAR
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           IF SCR-CMND = 'ATA'
               MOVE GVT-CAI-GTIA IN GVT TO GDG-CAI-GTIA IN GDG
               MOVE GVT-IIC-GTIA IN GVT TO GDG-IIC-GTIA IN GDG
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM BGL-FIO-GDG
               IF FIO-STAT-OKS
                   MOVE 'S'                 TO GDG-IND-EGVT IN GDG
                   MOVE 'S'                 TO GDG-IND-EGTP IN GDG
                   MOVE GVT-COD-TASN IN GVT TO GDG-COD-TSCN IN GDG
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM BGL-FIO-GDG.
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *>>>>
      * PTC-INI-MAN
      *    IF SCR-OFRM-SRV AND SCR-CMND = 'MOD'
      *       PERFORM ELI-GTP.
      * PTC-FIN-MAN
*% END
*% IF CMN_MOD
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING'
              OR SCR-CMND = 'COP'
               MOVE 'I'      TO GVT-MSC-TACC IN GVT
               MOVE HOY-FHOY TO GVT-FEC-FING IN GVT
               MOVE SCR-USER TO GVT-CIC-UING IN GVT
           ELSE
               MOVE 'M'      TO GVT-MSC-TACC    IN GVT.
      *>>>>
      *<<<< CMN_MOD
           IF SCR-CMND = 'ATA'
               MOVE 'A' TO GVT-MSC-STAT IN GVT
               IF GAR-IND-GTAC IN CMA-VARI = 'S'
                   PERFORM ESC-MOD-GVT
                   IF MSG-COD-MENS > SPACES
                       GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF CMN_ING
       NO-CMN-ING.
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING'
              OR SCR-CMND = 'COP'
               MOVE 'I'      TO GVT-MSC-TACC IN GVT
               MOVE HOY-FHOY TO GVT-FEC-FING IN GVT
               MOVE SCR-USER TO GVT-CIC-UING IN GVT
           ELSE
               MOVE 'M'      TO GVT-MSC-TACC    IN GVT.
      *>>>>
      *<<<< CMN_ING
           IF SCR-CCPP = 'ING'
               IF FRM-IND-GTP IN GVT-FLD = 'S'
                   MOVE 'I' TO GVT-MSC-STAT IN GVT
               ELSE
                   MOVE 'A' TO GVT-MSC-STAT IN GVT
           ELSE
               PERFORM REV-GDG-GTP
               ADD 1  TO GVT-COD-TASN  IN GVT-FLD
               MOVE GVT-COD-TASN IN GVT-FLD TO GVT-COD-TASN IN GVT
               PERFORM COP-GTP
               IF MSG-COD-MENS = SPACES
                   PERFORM ESC-MOD-GVT
                   IF MSG-COD-MENS > SPACES
                       GO TO FIN-CMN-ING
                   ELSE
      *MHM-INI 16-OCT-2003
      *                 NEXT SENTENCE
                      IF SCR-CMND = 'RTF'
                          PERFORM REST-VAL-GVT
                      ELSE
                          NEXT SENTENCE
      *MHM-FIN 16-OCT-2003
               ELSE
                   GO TO FIN-CMN-ING.
      *>>>>
      ** EVA-INI  10/07
           MOVE ZEROES TO GVT-SGV-FISI IN GVT.
      ** EVA-FIN  10/07
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
           IF SCR-CMND = 'RTA' OR SCR-CMND = 'RTF' OR SCR-CMND = 'RVL'
              IF WSS-IND-IEXC IN WSS-VARI = 'N'
                 MOVE 'S' TO GVT-IND-IEXC IN GVT
                 PERFORM PRO-GRB-ETP.
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING

           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           PERFORM LEE-GDD.
           PERFORM LLENAR-DESPUES.
           PERFORM GRABAR-LGN.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           MOVE GVT-CAI-GTIA IN GVT TO GDG-CAI-GTIA IN GDG.
           MOVE GVT-IIC-GTIA IN GVT TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE GVT-COD-TASN IN GVT TO GDG-COD-TSCN IN GDG
               IF FRM-IND-GTP IN GVT-FLD = 'S' AND
                  GVT-SGV-VGAS IN GVT NOT > ZEROES
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM BGL-FIO-GDG
                   GO TO FIN-CMN-ING
               ELSE
                   MOVE 'S' TO GDG-IND-EGVT IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM BGL-FIO-GDG.
      *>>>>
*% END
*% IF PGM_PQ
*% IF INI_FIO
      *<<<< INI_FIO                                                     
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           IF SCR-SISG NOT > SPACES
              MOVE SCR-SIST TO SCR-SISG.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGTP.              
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGVT.              
           MOVE +401 TO SCR-TCMA.
           IF SCR-DESDE-CMN                                             
               MOVE ZEROES TO WSS-FEC-FTSN IN CMA-VARI,                 
                              WSS-FEC-FRVL IN CMA-VARI,                 
      ** EVA-INI  09/07
                              WSS-FEC-FURV IN CMA-VARI,                 
                              WSS-FEC-FANR IN CMA-VARI,                 
      ** EVA-FIN  09/07
                              WSS-LIQ-CML  IN CMA-VARI.                 
      *>>>>                                                             
*% END
*% END
*% IF PGM_PU
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGTP.
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGVT.
           MOVE +372 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE ZEROES TO WSS-FEC-FTSN IN CMA-VARI,
                              WSS-FEC-FRVL IN CMA-VARI,
      ** EVA-INI  10/07
                              WSS-FEC-FURV IN CMA-VARI,
                              WSS-FEC-FANR IN CMA-VARI,
      ** EVA-FIN  10/07
                              WSS-LIQ-CML  IN CMA-VARI.
      *>>>>
*% END
*% END
*% IF WSS_IBM
      ** EVA-INI  10/07
       COPY BGLBRGIM.
       COPY BGLBRTAS.
       COPY BGLBRGSL.
       COPY SGCBRDBC.
      ** EVA-FIN  10/07 
       COPY BGLBRGDG.                                                   
       COPY BGLBRACC.                                                   
       COPY BGLBRGDP.                                                   
      *<<<< GEN_BCI                                                     
       COPY BGLBRGSO.                                                   
      *>>>>                                                             
       COPY TABBRIVB.                                                   
       COPY TABBRUSR. 
*% IF PGM_PQ                                                  
      *<<<< GEN_BCI AND PGM_PQ                                          
      *PTC-INI-MAN                                                      
      *COPY BGLWXGVT.                                                   
      *COPY BGLWXGTP.                                                   
      *PTC-FIN-MAN                                                      
      *>>>>  
*% END                                                           
      *<<<< GEN_BCI                                                     
       COPY BGLWXGTP.                                                   
       COPY BGLWXGVT.                                                   
       COPY BGLBRGDD.                                                   
       COPY COLBROPC.                                                   
       COPY COLBRRDC.                                                   
      *>>>>                                                             
       COPY BGLBRGES.                                                   
       COPY BGLBRGSE.                                                   
       COPY BGLBRGTP.                                                   
       COPY BGLBRTAG.                                                   
       COPY TABBRCAM.                                                   
      *   
*% IF PGM_PU
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
       COPY BGLBRETP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ETP-REQA==.
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      *<<<< PGM_PU
       COPY BGLBRGMO.
      *>>>>
*% END                                                     
       01  WSS-VARI.   
*% IF PGM_PU


      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
           03 WSS-NUM-CONT                      PIC 9(08).
           03 WSS-IND-IEXC                      PIC X(01).
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012

      *      ** Correccion Monetaria - Revalorizador **      *
      *               SEPTIEMBRE 2007  -  AFRI *             *


      ** EVA-INI  09/07

           03 WSS-FEC-FULR.
              05 WSS-NUM-SULR                   PIC 9(02).
              05 WSS-NUM-AULR                   PIC 9(02).
              05 WSS-NUM-MULR                   PIC 9(02).
              05 WSS-NUM-DULR                   PIC 9(02).

*% END
      *AFRI-INI/JUN2006  
*% IF PGM_PU
           03 WSS-VAL-DIFE                      PIC 9(03).
           03 WSS-VAL-PCTJ                      PIC 9(03).
           03 WSS-AUX-DIFE                      PIC 9(03).
           03 WSS-AUX-PCTJ                      PIC 9(03).
      ** EVA-FIN  09/07
*% END
           03 WSS-LST-GLOSA.                                            
              05 WSS-LST-PPON                  PIC X(05).               
              05 WSS-LST-RSTO                  PIC X(55).               
           03 WSS-NUM-PPON                     PIC 9(05).               
           03 WSS-VAL-PPON                     PIC S9(03)V9(02).        
           03 WSS-NEM-GLOSA.                                            
              05 WSS-NEM-ACCN                  PIC X(01).               
              05 WSS-NEM-RSTO                  PIC X(59).               
      *AFRI-FIN/JUN2006                                                 
*% IF PGM_PQ                                                                        
      ** EVA-INI  09/07                                                 
                                                                        
           03 WSS-FEC-FULR.                                             
              05 WSS-NUM-SULR                   PIC 9(02).              
              05 WSS-NUM-AULR                   PIC 9(02).              
              05 WSS-NUM-MULR                   PIC 9(02).              
              05 WSS-NUM-DULR                   PIC 9(02).              
                                                                        
           03 WSS-FEC-FANR.                                             
              05 WSS-NUM-SANR                   PIC 9(02).              
              05 WSS-NUM-AANR                   PIC 9(02).              
              05 WSS-NUM-MANR                   PIC 9(02).              
              05 WSS-NUM-DANR                   PIC 9(02).              
                                                                        
           03 WSS-FEC-FURV.                                             
              05 WSS-NUM-SURV                   PIC 9(02).              
              05 WSS-NUM-AURV                   PIC 9(02).              
              05 WSS-NUM-MURV                   PIC 9(02).              
              05 WSS-NUM-DURV                   PIC 9(02).              
                                                                        
      ** EVA-FIN  09/07                                                 
                                                                        
      ** EVA-INI  10/07

           03 WSS-GLS-APLI.
              05 WSS-IND-TAPL                   PIC X(01).
              05 WSS-IND-SAPL                   PIC X(01).
              05 WSS-IND-IND3                   PIC X(01).
              05 WSS-IND-DAUX                   PIC X(57).

           03 WSS-IND-TNOV   VALUE 'N'          PIC X(01).
           03 WSS-IND-RTAS   VALUE SPACES       PIC X(01).
           03 WSS-IND-ATAS   VALUE SPACES       PIC X(01).

           03 WSS-GLS-VCTO    VALUE SPACES        PIC X(03).
           03 WSS-IND-GSO     VALUE ZEROES        PIC 9(01).
           03 WSS-IND-PVTS                        PIC 9(03).
           03 WSS-IND-TPVT                        PIC X(01).

           03 WSS-COD-CGTA.
              05 WSS-TIP-CGTA                     PIC X(03).
              05 WSS-STP-CGTA                     PIC X(03).

           03 WSS-FEC-FGVT.
              05 WSS-NUM-SGVT        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AGVT        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MGVT        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-DGVT        VALUE ZEROS  PIC 9(02).

           03 WSS-FEC-FVEN.
              05 WSS-NUM-SVEN        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AVEN        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MVEN        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-DVEN        VALUE ZEROS  PIC 9(02).

      ** EVA-FIN  10/07
      ** EVA-INI  11/08
           03 WSS-IND-GTIA     VALUE SPACES       PIC X(01).
           03 WSS-IND-GTAC     VALUE SPACES       PIC X(01).
           03 WSS-IND-ARET     VALUE SPACES       PIC X(01).
           03 WSS-IND-ECRT     VALUE SPACES       PIC X(01).
           03 WSS-IND-GDIA     VALUE SPACES       PIC X(01).
      ** EVA-FIN  11/08
*% END
           03 WSS-CIC-TIAU                        PIC X(06).            
           03 WSS-TIPO-AUX.                                             
              05 WSS-TIPO-1                       PIC X(03).            
              05 WSS-AUX-1                        PIC X(03).            
           03 WSS-TIPO-DIV.                                             
              05 WSS-TIPO                          PIC X(03).           
              05 WSS-DIV                           PIC X(03).           
           03 WSS-TSG-OPE.                                              
              05 WSS-COD-TOPE                   PIC X(03).              
              05 WSS-COD-SOPE                   PIC X(03).              
      *                                                                 
           03 WSS-COD-PESO.                                             
              05 WSS-IND-TMON                  PIC X(01).               
              05 WSS-COD-REST                  PIC X(05).               
      *<<<< NOT PGM_ARG                                                 
           03 WSS-VAL-PESO                     PIC S9(11).              
           03 WSS-SGV-VCTS-AUX COMP-3          PIC S9(11)V9(04).        
      *>>>>                                                             
           03 GAR-COD-ITSN                     PIC 9(03).               
           03 WSS-AUX         COMP-3           PIC S9(03)V9(12).        
           03 WSS-IMAL                         PIC 9(01).               
      * EVA-AFRI/MAY2006                                                
           03 WSS-GLS-DATA.                                             
              05 WSS-NUM-FVCT                     PIC 9(03).            
              05 WSS-COD-FVCT                     PIC X(01).            
                                                                        
           03 WSS-NUM-PVTS                     PIC 9(03).               
           03 WSS-COD-TPVT                     PIC X(01).               
           03 WSS-FEC-FECH.                                             
              05 WSS-NUM-STM3                   PIC 9(02).              
              05 WSS-NUM-ATM4                   PIC 9(02).              
              05 WSS-NUM-MTM2                   PIC 9(02).              
              05 WSS-NUM-DTM1                   PIC 9(02).              
           03 WSS-FEC-FTSC.                                             
              05 WSS-NUM-STSC                   PIC 9(02).              
              05 WSS-NUM-ATSC                   PIC 9(02).              
              05 WSS-NUM-MTSC                   PIC 9(02).              
              05 WSS-NUM-DTSC                   PIC 9(02).              
*% IF PGM_PU
           03 WSS-FEC-FTSN.
              05 WSS-NUM-STSN                   PIC 9(02).
              05 WSS-NUM-ATSN                   PIC 9(02).
              05 WSS-NUM-MTSN                   PIC 9(02).
              05 WSS-NUM-DTSN                   PIC 9(02).
*% END
      * FIN-AFRI/MAY2006                                                
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
           03 WSS-COD-CMSG                      PIC X(12).
           03 WSS-GLS-CMSG                      PIC X(50).
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012                                                                       
      *<<<< GEN_BCI                                                     
           03 WSS-CIC-TOPE    VALUE SPACES      PIC X(03).              
           03 WSS-IND-HIPT    VALUE SPACES      PIC X(01).              
           03 WSS-IND-ENFE    VALUE SPACES      PIC X(01).              
      *    INDICADOR DE EXCEPCION NORMATIVA DE TASACION UNO             
           03 WSS-IND-ENT1    VALUE SPACES      PIC X(01).              
      *    INDICADOR DE EXCEPCION NORMATIVA DE TASACION DOS             
           03 WSS-IND-ENT2    VALUE SPACES      PIC X(01).              
      *    INDICADOR DE EXCEPCION NORMATIVA DE TASACION TRES            
           03 WSS-IND-ENT3    VALUE SPACES      PIC X(01).              
           03 WSS-VAL-SCRE    VALUE ZEROES      PIC 9(13)V9(04).        
*% IF PGM_PQ
      ** EVA-INI  09/07
           03 WSS-FEC-FRVL.                                             
              05 WSS-NUM-SRVL                   PIC 9(02).              
              05 WSS-NUM-ARVL                   PIC 9(02).              
              05 WSS-NUM-MRVL                   PIC 9(02).              
              05 WSS-NUM-DRVL                   PIC 9(02).              
      ** EVA-FIN  09/07
           03 WSS-FEC-FTSN.                                             
              05 WSS-NUM-STSN                   PIC 9(02).              
              05 WSS-NUM-ATSN                   PIC 9(02).              
              05 WSS-NUM-MTSN                   PIC 9(02).              
              05 WSS-NUM-DTSN                   PIC 9(02).              
*% END                                                                        
                                                                        
           03 WSS-FEC-FTRA.                                             
              05 WSS-NUM-STRA                   PIC 9(02).              
              05 WSS-NUM-ATRA                   PIC 9(02).              
              05 WSS-NUM-MTRA                   PIC 9(02).              
              05 WSS-NUM-DTRA                   PIC 9(02).              
      *    03 WSS-IND-TASV       VALUE 'N'      PIC X(01).
      *MHM-INI 23-OCT-2003                                              
           03 WSS-GLS-CGTA.                                             
              05 WSS-GLS-TOPE                   PIC X(40).              
              05 WSS-GLS-SOPE                   PIC X(40).              
      *MHM-FIN 23-OCT-2003                                              
*% IF PGM_PU
      * EVA-INI  06/08
           03 WSS-COD-CGTA.
              05 WSS-STP-CGTA                   PIC X(03).
              05 WSS-TIP-CGTA                   PIC X(03).
      * EVA-FIN  06/08
*% END      
      *>>>>                                                             
      * Variables para determinar vigencia de Tasacion                  
      * deben estar bajo WSS-VARI                                       
       COPY BGLWGEXV.                                                   
       COPY GNSWGPES.                                                   
      *MHM-INI 23-OCT-2003                                              
       COPY GNSWGCPT.                                                   
      *MHM-FIN 23-OCT-2003  
*% IF PGM_PQ                                            
      *<<<< PGM_CHI AND PGM_PQ                                          
       COPY USPC113.   
*% END                                                 
      *<<<< GEN_BCI                                                     
       COPY BGLWGVCG.                                                   
      *>>>>                                                             
      *<<<< PGM_DTC 
*% IF PGM_PU
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GMO-REQA==.
*% END                                                    
      ** EVA-INI  10/07
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      ** EVA-FIN  10/07
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IVB-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDP-REQA==.        
      *<<<< GEN_BCI                                                     
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.        
      *>>>>                                                             
      *<<<< PGM_PQ                                                      
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.        
      *>>>>                                                             
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSE-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GTP-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.        
      *                                                                 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.        
      *>>>>                                                       
*% IF PGM_PQ      
       01 WSS-VARI.
           03 WSS-FEC-FORI.
              05 WSS-NUM-SORI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-AORI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-MORI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-DORI           VALUE ZEROES    PIC 9(02).

           03 WSS-FEC-FMAV.
              05 WSS-NUM-SMAV           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-AMAV           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-MMAV           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-DMAV           VALUE ZEROES    PIC 9(02).

           03 WSS-FEC-FINI.
              05 WSS-NUM-SINI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-AINI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-MINI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-DINI           VALUE ZEROES    PIC 9(02).

           03 WSS-FEC-FTER.
              05 WSS-NUM-STER           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-ATER           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-MTER           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-DTER           VALUE ZEROES    PIC 9(02).

           03 WSS-SGV-TINT              VALUE ZEROES    PIC 9(03)V9(04).
           03 WSS-SGV-MNTO              VALUE ZEROES    PIC 9(11)V9(04).
      *    03 WSS-GLS-DATO.
      *       05 WSS-NUM-MAXI           VALUE ZEROES    PIC 9(02).
      *       05 WSS-GLS-DISP           VALUE SPACES    PIC X(08).
*% END
*% END
