*%! Codigo adicional para archivo
*% VSNBQ = "06.06.29"
*% FNCBQ = "OWFBGL"
*% VSNBU = "06.06.29"
*% FNCBU = "OWFBGL"
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF SETTAG
      *<<<<
      *-----------------------------------------------------------------
      * MANTENCION
      * OBJETIVO: MODIFICAR VALIDACIONES - QUITAR VLIM > LTSN
      * RESPONSABLE: MVG
      * ETIQUETA: *MVG-INI 09-ENE-2018 MOD VALIDACION QUITAR VLIM > LTSN
      *-----------------------------------------------------------------
      *>>>>
*% END
*% IF GDD_FEC_FING
      *<<<<
           IF GDD-FEC-FING IN GDD-FLD  NOT > ZEROES
              MOVE GDD-CAI-GTIA IN GDD-FLD TO GDG-CAI-GTIA IN GDG
              MOVE GDD-IIC-GTIA IN GDD-FLD TO GDG-IIC-GTIA IN GDG
              MOVE FIO-GET-KEY  TO FIO-CMND
              PERFORM BGL-FIO-GDG
              IF NOT FIO-STAT-OKS
                 MOVE WSS-CTE-BGL        TO MSG-COD-SIST
                 MOVE WSS-CTE-GDGNEX     TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GDD-FEC-FING
              ELSE
                 MOVE GDG-NUM-SING IN GDG TO GDD-NUM-SING IN GDD-FLD
                 MOVE GDG-NUM-AING IN GDG TO GDD-NUM-AING IN GDD-FLD
                 MOVE GDG-NUM-MING IN GDG TO GDD-NUM-MING IN GDD-FLD
                 MOVE GDG-NUM-DING IN GDG TO GDD-NUM-DING IN GDD-FLD.
      *>>>>
*% END
*% IF DBC_IDC_ICLI
      *<<<<
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-DBC-IDC-ICLI.

           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-DBC-IDC-ICLI.

           IF DBC-IDC-ICLI IN GDD-FLD NOT = ZEROES
              MOVE DBC-IDC-ICLI IN GDD-FLD TO DBC-IDC-ICLI IN DBC
              MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
              MOVE FIO-GET-KEY     TO FIO-CMND
              PERFORM GET-CLI
              MOVE FIO-STAT TO PGM-STAT-DBC
              IF NOT FIO-STAT-OKS
                 MOVE SPACES       TO DBC-GLS-NOMC IN GDD-FLD
                 MOVE 'SGC'        TO MSG-COD-SIST
                 MOVE 'CLI    NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
              IF MSG-GLS-DESC > SPACES
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                 PERFORM CPT-BLKS
                 MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD
                 GO TO FIN-VAL-DBC-IDC-ICLI
              ELSE
                 MOVE DBC-CAI-ICLI IN DBC TO
                      CNE-GDD-CAI-DCLI
                 MOVE DBC-IIC-ICLI IN DBC TO
                      CNE-GDD-IIC-DCLI
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                 PERFORM CPT-BLKS
                 MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD.
      *>>>>
*% END
*% IF INI_PUT_GDD_GDD
      *<<<<
           MOVE GDD-CAI-DCLI IN GDD TO CNE-GDD-CAI-DCLI.
           MOVE GDD-IIC-DCLI IN GDD TO CNE-GDD-IIC-DCLI.
      *>>>>
*% END
*% IF GDD_COD_VCAM
      *<<<<
      *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
      
           IF  GDD-SGV-VALR  IN GDD-FLD > ZEROES AND
               GDD-COD-VCAM  IN GDD-FLD NOT > SPACES
               MOVE WSS-CTE-GNS        TO MSG-COD-SIST
               MOVE WSS-CTE-CODVIG     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDD-COD-VCAM.
      
           IF (GDD-COD-VCAM  IN GDD-FLD > SPACES OR
               GDD-SGV-VALR  IN GDD-FLD > ZEROES ) AND
               GDD-SGV-PLIM  IN GDD-FLD > ZEROES
               MOVE WSS-CTE-S          TO WSS-IND-ERR
               MOVE WSS-CTE-BGL        TO MSG-COD-SIST
               MOVE WSS-CTE-ERROR1     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDD-COD-VCAM.

           IF GDD-SGV-PLIM IN GDD-FLD > ZEROES
              MOVE SPACES TO FRM-GLS-MONE IN GDD-FLD
              MOVE SPACES TO GDD-COD-VCAM IN GDD-FLD
              GO TO FIN-VAL-GDD-COD-VCAM.
      *VAL-COD Valida codigo de tabla
           MOVE WSS-CTE-TAB TO TAB-COD-SIST.
           MOVE WSS-CTE-VLR TO TAB-COD-TTAB IN TAB.
           MOVE GDD-COD-VCAM IN GDD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CTE-CODNEX OR
              GDD-COD-VCAM IN GDD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-MONE IN GDD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-MONE IN GDD-FLD.
      *OGB-FIN 08-OCT-2015 LIMITE DE GARANTIAS
      *>>>>
*% END
*% IF FIN_PUT_GDG_GDD
      *<<<<
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
      *MHM-INI 25-SEP-2003
      *     MOVE GDG-COD-TOPE IN GDG TO WSS-COD-TOPE IN WSS-VARI.
      *     MOVE GDG-COD-SOPE IN GDG TO WSS-COD-SOPE IN WSS-VARI.
           MOVE GDG-TIP-CGTA IN GDD-FLD TO WSS-COD-TOPE IN WSS-VARI.
           MOVE GDG-STP-CGTA IN GDD-FLD TO WSS-COD-SOPE IN WSS-VARI.
      *MHM-FIN 25-SEP-2003
      *-----------------------------------------------------*
           MOVE WSS-CLA-OPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
      *    PERFORM VAL-COD.
           PERFORM BUS-TAB.
      *MHM-INI 23-OCT-2003
      *     MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-CGTA IN GDD-FLD.
           MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI.
      *MHM-FIN 23-OCT-2003

      *MHM-INI 12-NOV-2003
      *     IF MSG-COD-MENS = SPACES
      *        MOVE TAB-GLS-DATA IN TAB TO WSS-DATOS-ADICIONALES
      *        MOVE WSS-CLASE-GARANTIA TO FRM-COD-CGAR IN GDD-FLD
      *     ELSE
      *        MOVE SPACES TO FRM-COD-CGAR IN GDD-FLD.
      *MHM-FIN 12-NOV-2003
      
      *MHM-INI 23-OCT-2003
           IF GDG-TIP-CGTA IN GDD-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GDD-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GDD-FLD.
      *MHM-FIN 23-OCT-2003
      *MHM-INI 12-NOV-2003
           MOVE GDG-TIP-CGTA IN GDD-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GDD-FLD TO TAG-STP-AGTA IN TAG.
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'BGL' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'BGL' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
      
                MOVE TAG-IND-TREA IN TAG TO 
                     TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TREA IN GDD-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TREA IN GDD-FLD.
      *MHM-FIN 12-NOV-2003

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CLA' TO TAB-COD-TTAB IN TAB.
           MOVE WSS-CLASE-GARANTIA TO TAB-COD-CTAB IN TAB.
      *    PERFORM VAL-COD.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
              MOVE TAB-GLS-DESC TO FRM-GLS-CGAR IN GDD-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-CGAR IN GDD-FLD.

      *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
           IF GDD-COD-VCAM IN GDD-FLD > SPACES                     
               MOVE 'TAB'  TO TAB-COD-SIST                                
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB                        
               MOVE GDD-COD-VCAM IN GDD-FLD TO TAB-COD-CTAB IN TAB       
               PERFORM BUS-TAB                                           
               MOVE TAB-GLS-DESC IN TAB TO                               
                    FRM-GLS-MONE IN GDD-FLD
           ELSE                                       
               MOVE SPACES TO FRM-GLS-MONE IN GDD-FLD.
               
           IF SCR-CCPP = 'ING'
              MOVE GDD-CAI-GTIA IN GDD-FLD TO GDG-CAI-GTIA IN GDG
              MOVE GDD-IIC-GTIA IN GDD-FLD TO GDG-IIC-GTIA IN GDG
              MOVE FIO-GET-KEY  TO FIO-CMND
              PERFORM BGL-FIO-GDG
              IF NOT FIO-STAT-OKS
                 MOVE WSS-CTE-BGL        TO MSG-COD-SIST
                 MOVE WSS-CTE-GDGNEX     TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-PUT-GDG-GDD
              ELSE
                 MOVE GDG-NUM-SING IN GDG TO GDD-NUM-SING IN GDD-FLD
                 MOVE GDG-NUM-AING IN GDG TO GDD-NUM-AING IN GDD-FLD
                 MOVE GDG-NUM-MING IN GDG TO GDD-NUM-MING IN GDD-FLD
                 MOVE GDG-NUM-DING IN GDG TO GDD-NUM-DING IN GDD-FLD.
      *OGB-FIN 08-OCT-2015 LIMITE DE GARANTIAS

      *>>>>
*% END
*% IF FIN_UNP_GDD_GDD
      *>>>> FIN_UNP_GDD_GDD
      *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
           MOVE FRM-CPIM-AEY TO GDD-FEC-FING-ATR IN GDD-FLD.
      *OGB-FIN 08-OCT-2015 LIMITE DE GARANTIAS
      *<<<<
*% END
*% IF INI_KEY_GDD_GDD
      *<<<<
           MOVE CNE-GDD-CAI-DCLI TO GDD-CAI-DCLI IN GDD.
           MOVE CNE-GDD-IIC-DCLI TO GDD-IIC-DCLI IN GDD.
      *>>>>
*% END
*% IF FIN_CLR_KEY_GDD
      *<<<<
      *>>>>
*% END
*% IF PGM_VMS AND FIN_RET_GDD_GDD
      *<<<< FIN_RET_GDD_GDD
           MOVE GDD-KEY-IGDD IN GDD TO GDD-KEY-PRV.
      *>>>>
*% END
*% IF FIN_PUT_ALL_GDD
      *<<<< FIN_PUT_ALL_GDD
      *    Cuenta numero de deudores de la garantia
           PERFORM CUENTA-GDD.
           PERFORM KEY-GDD-GDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDD.
           MOVE FIO-STAT TO PGM-STAT-GDD.
      *>>>> 
*% END
*% IF GDD_SGV_VALR
      *<<<<
      *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
           PERFORM CAL-VALOR-LIMITE.
           
           IF GDD-SGV-VLIM IN GDD-FLD > ZEROES
              PERFORM LEE-GDD-VLIM
              IF MSG-COD-MENS > SPACES
                 GO TO FIN-VAL-GDD-SGV-VALR.
      *OGB-FIN 08-OCT-2015 LIMITE DE GARANTIAS
      *>>>> 
*% END
*% IF FRM_GLS_TREA
      *<<<< FRM_GLS_TREA 
      *    MOVE GDG-COD-CGTA IN GDD-FLD TO TAG-COD-AGTA IN TAG.
      *    MOVE FIO-GET-KEY    TO FIO-CMND.                    
      *    PERFORM BGL-FIO-TAG.                                
      *    IF NOT FIO-STAT-OKS                                 
      *       GO TO FIN-VAL-FRM-GLS-TREA
      *    MOVE "BGL" TO TAB-COD-SIST.
      *    MOVE "RAL " TO TAB-COD-TTAB IN TAB.
      *    MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB.
      *    PERFORM BUS-TAB.
      *    MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TREA IN GDD-FLD.
      *>>>> 
*% END
*% IF FRM_NUM_QDEU
      *<<<< FRM_NUM_QDEU
      *    Cuenta numero de deudores de la garantia
           PERFORM CUENTA-GDD.
           PERFORM KEY-GDD-GDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDD.
           MOVE FIO-STAT TO PGM-STAT-GDD.
      *>>>> 
*% END
*% IF INI_VAL_CON_IKY_GDD
      *<<<< INI_VAL_CON_IKY_GDD
      *    TODO LLENO ( CLI + GDG )
*% IF PGM_MEX
           IF NOT (( DBC-IDC-ICLI IN GDD-FLD NOT = SPACES OR
                     DBC-GLS-NOMC IN GDD-FLD > SPACES ) AND
                     GDD-IIC-GTIA IN GDD-FLD > ZEROES )
*% ELSE
           IF NOT (( DBC-NUM-ICLI IN GDD-FLD NOT = ZEROES OR
                     DBC-GLS-NOMC IN GDD-FLD > SPACES ) AND
                     GDD-IIC-GTIA IN GDD-FLD > ZEROES )
*% END
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-IKY-GDD.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_GDD
      *<<<< INI_VAL_CON_KEY_GDD
*% IF PGM_MEX
           IF SCR-CCPP = 'ELI' AND
              NOT (( DBC-IDC-ICLI IN GDD-FLD NOT = SPACES OR
                     DBC-GLS-NOMC IN GDD-FLD > SPACES ) AND
                     GDD-IIC-GTIA IN GDD-FLD > ZEROES )
*% ELSE
           IF SCR-CCPP = 'ELI' AND
              NOT (( DBC-NUM-ICLI IN GDD-FLD NOT = ZEROES OR
                     DBC-GLS-NOMC IN GDD-FLD > SPACES ) AND
                     GDD-IIC-GTIA IN GDD-FLD > ZEROES )
*% END

               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
*% IF PGM_MEX
           IF     GDD-IIC-GTIA IN GDD-FLD NOT > ZEROES 
              AND DBC-GLS-NOMC IN GDD-FLD NOT > SPACES 
              AND DBC-IDC-ICLI IN GDD-FLD = SPACES 
*% ELSE
           IF     GDD-IIC-GTIA IN GDD-FLD NOT > ZEROES 
              AND DBC-GLS-NOMC IN GDD-FLD NOT > SPACES 
              AND DBC-NUM-ICLI IN GDD-FLD = ZEROES 
*% END
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDD.
           GO TO FIN-VAL-CON-KEY-GDD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_GDD
      *<<<< FIN_PUT_DBC_GDD
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF MSG-COD-MENS > SPACES 
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-DBC-VRF-ICLI.
*% IF PGM_MEX
           IF DBC-IDC-ICLI IN GDD-FLD NOT = SPACES
               MOVE DBC-IDC-ICLI IN GDD-FLD TO DBC-IDC-ICLI IN DBC
*% ELSE
           IF DBC-NUM-ICLI IN GDD-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN GDD-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN GDD-FLD TO DBC-IND-ICLI IN DBC
*% END
               MOVE DBC-GLS-ICLI IN GDD-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY     TO FIO-CMND
               PERFORM GET-CLI
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDD-FLD
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE 
               IF MSG-GLS-DESC > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO
                        CNE-GDD-CAI-DCLI
                   MOVE DBC-IIC-ICLI IN DBC TO 
                        CNE-GDD-IIC-DCLI
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD.
*% END
*% IF GDD_SGV_VLIM
      *<<<< GDD_VAL_LIM_DDR

           IF GDG-COD-VCAM IN GDD-FLD = WSS-COD-PESO IN CMA-VARI AND
              GDD-SGV-VLIM IN GDD-FLD > ZEROES
               MOVE GDD-SGV-VLIM  IN GDD-FLD TO 
                    PES-SGV-DECI  IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GDD-SGV-VLIM IN GDD-FLD.
                                                                        
      * AFRI-EVA/MAYO2007 (PRELACION)                                   
      *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
      *     IF GDD-SGV-VLIM IN GDD-FLD > ZEROES                          
      *        PERFORM LEE-GDD-VLIM                                      
      *        IF MSG-COD-MENS > SPACES                                  
      *           GO TO FIN-VAL-GDD-SGV-VLIM                             
      *        END-IF                                                    
      *     ELSE                                                         
      *        GO TO FIN-VAL-GDD-SGV-VLIM.                               
      *OGB-FIN 08-OCT-2015 LIMITE DE GARANTIAS
      * FIN-EVA/MAYO2007 (PRELACION)                                    
      *>>>>
*% END
*% IF GDD_SGV_PLIM
      *<<<< GDD_PCT_LIM_DDR
      *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
      *    IF NOT ( GDD-SGV-VLIM  IN GDD-FLD > ZEROES OR
           IF NOT ( GDD-SGV-VALR  IN GDD-FLD > ZEROES OR 
                    GDD-SGV-PLIM  IN GDD-FLD > ZEROES )
      *OGB-FIN 08-OCT-2015 LIMITE DE GARANTIA 
      * AFRI-EVA/MAYO2007 (PRELACION)                                   
               PERFORM ERR-GLS                                          
               GO TO FIN-VAL-GDD-SGV-PLIM                               
      *        MOVE 100 TO GDD-SGV-PLIM IN GDD-FLD                      
      * AFRI-FIN/MAYO2007 (PRELACION)                                   
           ELSE
           IF GDD-SGV-PLIM  IN GDD-FLD > 100
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE '%>100'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
                                                                        
      * AFRI-EVA/MAYO2007 (PRELACION)                                   
           IF GDD-SGV-PLIM IN GDD-FLD > ZEROES                          
              PERFORM LEE-GDD-PLIM                                      
              IF MSG-COD-MENS > SPACES                                  
                 GO TO FIN-VAL-GDD-SGV-PLIM                             
              END-IF                                                    
           END-IF.                                                      
      * FIN-EVA/MAYO2007 (PRELACION)                                    
                                                                        
      *>>>>
*% END
*% IF FIN_GDD_CAI_GTIA
      *<<<<
      *MHM-INI 04-NOV-2004                                              
           IF GDD-CAI-GTIA IN GDD-FLD NOT > SPACES AND
              SCR-CMND = 'ING'                                          
               PERFORM ERR-KEY                                          
               PERFORM FST-KEY-GDD.                                     
      *MHM-FIN 04-NOV-2004                                              
      *>>>>
*% END
*% IF EOF_BU
      *<<<<
                                                                        
      * AFRI-EVA/MAYO2007 (PRELACION)                                   
       LEE-GDD-VLIM SECTION.                                            
       INI-LEE-GDD-VLIM.                                                
           MOVE 1 TO WSS-CONT.                                          
           MOVE SPACES TO GDD-KEY-IGDD IN GDD.                          
           MOVE GDD-CAI-GTIA IN GDD-FLD TO GDD-CAI-GTIA IN GDD.         
           MOVE GDD-IIC-GTIA IN GDD-FLD TO GDD-IIC-GTIA IN GDD.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-LEE-GDD-VLIM.                                                
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           PERFORM BGL-FIO-GDD.                                         
                                                                        
           IF NOT ( FIO-STAT-OKS AND                                    
              GDD-CAI-GTIA IN GDD = GDD-CAI-GTIA IN GDD-FLD AND         
              GDD-IIC-GTIA IN GDD = GDD-IIC-GTIA IN GDD-FLD )           
              IF WSS-CONT = 1                                           
                  GO TO FIN-LEE-GDD-VLIM                                
              ELSE                                                      
                  PERFORM VAL-VLIM                                      
                  GO TO FIN-LEE-GDD-VLIM.                               
                                                                        
           MOVE GDD-CIC-DCLI IN GDD TO DBC-CIC-ICLI IN DBC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-LEE-GDD-VLIM.                                   
                                                                        
           ADD 1 TO WSS-CONT                                            
           IF GDD-SGV-PLIM IN GDD > ZEROES AND                          
              DBC-NUM-ICLI IN GDD-FLD NOT = DBC-NUM-ICLI IN DBC         
              MOVE 'BGL'       TO MSG-COD-SIST                          
              MOVE 'NO MEZCLA' TO MSG-COD-MENS                          
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-LEE-GDD-VLIM                                    
           ELSE                                                         
      *OGB-INI 25-ABR-2017 VALIDACION MLIM - LTSN
           IF GDD-SGV-VLIM IN GDD > ZEROES
      *    IF GDD-SGV-VLIM IN GDD > ZEROES AND                          
      *     DBC-NUM-ICLI IN GDD-FLD NOT = DBC-NUM-ICLI IN DBC           
      *OGB-FIN 25-ABR-2017 VALIDACION MLIM - LTSN
              MOVE GDD-SGV-VLIM IN GDD-FLD TO WSS-NUM-VLIM              
              MOVE GDD-SGV-VLIM IN GDD TO WSS-AUX-VLIM                  
              COMPUTE WSS-VAR-VLIM IN WSS-VARI =                        
              (WSS-AUX-VLIM IN WSS-VARI + WSS-VAR-VLIM IN WSS-VARI)     
      *OGB-INI 25-ABR-2017 VALIDACION MLIM - LTSN
      *       IF DBC-NUM-ICLI IN GDD-FLD = DBC-NUM-ICLI IN DBC
      *          MOVE ZEROES TO WSS-NUM-VLIM
      *          GO TO NXT-LEE-GDD-VLIM
      *       ELSE
      *OGB-FIN 25-ABR-2017 VALIDACION MLIM - LTSN
              GO TO NXT-LEE-GDD-VLIM.                                   
                                                                        
       NXT-LEE-GDD-VLIM.                                               
           MOVE GDD-CIC-GTIA IN GDD TO WSS-CIC-GTIA IN WSS-VARI.        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-LEE-GDD-VLIM.                                      
       FIN-LEE-GDD-VLIM.                                                
           EXIT.                                                        
                                                                        
       LEE-GDD-PLIM SECTION.                                            
       INI-LEE-GDD-PLIM.                                                
           MOVE GDD-SGV-PLIM IN GDD-FLD TO WSS-NUM-PLIM.                
           MOVE SPACES TO GDD-KEY-IGDD IN GDD.                          
           MOVE GDD-CAI-GTIA IN GDD-FLD TO GDD-CAI-GTIA IN GDD.         
           MOVE GDD-IIC-GTIA IN GDD-FLD TO GDD-IIC-GTIA IN GDD.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-LEE-GDD-PLIM.                                                
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           PERFORM BGL-FIO-GDD.                                         
                                                                        
           IF NOT ( FIO-STAT-OKS AND                                    
              GDD-CAI-GTIA IN GDD = GDD-CAI-GTIA IN GDD-FLD AND         
              GDD-IIC-GTIA IN GDD = GDD-IIC-GTIA IN GDD-FLD )           
              GO TO FIN-LEE-GDD-PLIM.                                   
                                                                        
           MOVE GDD-CIC-DCLI IN GDD TO DBC-CIC-ICLI IN DBC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-LEE-GDD-PLIM.                                   
                                                                        
           IF GDD-SGV-PLIM IN GDD > ZEROES AND                          
              DBC-NUM-ICLI IN GDD-FLD NOT = DBC-NUM-ICLI IN DBC         
                MOVE GDD-SGV-PLIM IN GDD TO WSS-AUX-PLIM                
                ADD WSS-AUX-PLIM TO WSS-NUM-PLIM                        
                IF WSS-NUM-PLIM > 100                                   
                   MOVE 'BGL'       TO MSG-COD-SIST                     
                   MOVE 'NO > 100%' TO MSG-COD-MENS                     
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-LEE-GDD-PLIM                               
                ELSE                                                    
                   GO TO NXT-LEE-GDD-PLIM                               
                END-IF                                                  
           ELSE 
      *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
      *      IF GDD-SGV-VLIM IN GDD > ZEROES
             IF DBC-NUM-ICLI IN GDD-FLD NOT = DBC-NUM-ICLI IN DBC AND
               (GDD-SGV-PLIM IN GDD-FLD > ZEROES AND
                GDD-SGV-VALR IN GDD     > ZEROES) OR
               (GDD-SGV-PLIM IN GDD     > ZEROES AND
                GDD-SGV-VALR IN GDD-FLD > ZEROES)
      *OGB-FIN 08-OCT-2015 LIMITE DE GARANTIAS  
                MOVE 'BGL'       TO MSG-COD-SIST                        
                MOVE 'NO MEZCLA' TO MSG-COD-MENS                        
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
                GO TO FIN-LEE-GDD-PLIM                                  
             END-IF                                                     
           END-IF.                                                      
       NXT-LEE-GDD-PLIM.                                                
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-LEE-GDD-PLIM.                                      
       FIN-LEE-GDD-PLIM.                                                
           EXIT.                                                        
                                                                        
       VAL-VLIM SECTION.                                                
       INI-VAL-VLIM.                                                    
           MOVE WSS-CIC-GTIA IN WSS-VARI TO GVT-CIC-GTIA IN GVT.        
           MOVE ZEROES                   TO GVT-COD-TASN IN GVT.        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GVT.                                         
                                                                        
           IF NOT (FIO-STAT-OKS AND                                     
              GVT-CIC-GTIA IN GVT = WSS-CIC-GTIA IN WSS-VARI)           
              MOVE 'BGL'       TO MSG-COD-SIST                          
              MOVE 'GDD SIN GVT' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-VLIM.                                       
                                                                        
           MOVE GVT-SGV-LTSN IN GVT TO WSS-AUX-LTSN IN WSS-VARI.        
           COMPUTE WSS-VAR-VLIM IN WSS-VARI =                           
              (WSS-VAR-VLIM IN WSS-VARI + WSS-NUM-VLIM IN WSS-VARI).    
      *MVG-INI 09-ENE-2018 MOD VALIDACION QUITAR VLIM > LTSN
      *COMENTAR VALIDACION PARA QUE VALOR LIMITE PUEDA SER MAYOR AL
      *VALOR DE LA GARANTIA
      *     IF WSS-VAR-VLIM IN WSS-VARI > WSS-AUX-LTSN IN WSS-VARI
      *OGB-INI 25-ABR-2017 VALIDACION MLIM - LTSN
      *        AND DBC-NUM-ICLI IN GDD-FLD NOT = DBC-NUM-ICLI IN DBC
      *        OR
      *       (DBC-NUM-ICLI IN GDD-FLD = DBC-NUM-ICLI IN DBC AND
      *        GDD-SGV-VLIM IN GDD-FLD > WSS-AUX-LTSN IN WSS-VARI)
      *OGB-FIN 25-ABR-2017 VALIDACION MLIM - LTSN
      *         MOVE 'BGL'       TO MSG-COD-SIST
      *         MOVE 'GDD > GVT' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-VLIM.
      *MVG-FIN 09-ENE-2018 MOD VALIDACION QUITAR VLIM > LTSN
       FIN-VAL-VLIM.                                                    
           EXIT.                                                        
                                                                        
      * FIN-EVA/MAYO2007 (PRELACION)                                    
      *OGB-INI 08-OCT-2015 LIMITE DE GARANTIAS
       CAL-VALOR-LIMITE SECTION.
       INI-CAL-VALOR-LIMITE.
      *REALIZO CONVERSION PARA DISTINTAS MONEDAS

           IF GDD-COD-VCAM IN GDD-FLD =
              GDG-COD-VCAM IN GDD-FLD
              MOVE GDD-SGV-VALR IN GDD-FLD TO GDD-SGV-VLIM IN GDD-FLD
              GO TO FIN-CAL-VALOR-LIMITE.

           IF GDD-COD-VCAM IN GDD-FLD NOT > SPACES OR
              GDD-SGV-VALR IN GDD-FLD NOT > ZEROES
              MOVE ZEROES TO GDD-SGV-VLIM IN GDD-FLD
              GO TO FIN-CAL-VALOR-LIMITE.

           MOVE GDD-CAI-GTIA IN GDD-FLD TO GDG-CAI-GTIA IN GDG
           MOVE GDD-IIC-GTIA IN GDD-FLD TO GDG-IIC-GTIA IN GDG
           MOVE FIO-GET-KEY  TO FIO-CMND
           PERFORM BGL-FIO-GDG
           IF NOT FIO-STAT-OKS
              MOVE WSS-CTE-BGL        TO MSG-COD-SIST
              MOVE WSS-CTE-GDGNEX     TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GDD-FEC-FING
           ELSE
              MOVE GDG-NUM-SING IN GDG TO GDD-NUM-SING IN GDD-FLD
              MOVE GDG-NUM-AING IN GDG TO GDD-NUM-AING IN GDD-FLD
              MOVE GDG-NUM-MING IN GDG TO GDD-NUM-MING IN GDD-FLD
              MOVE GDG-NUM-DING IN GDG TO GDD-NUM-DING IN GDD-FLD.

           IF GDG-COD-VCAM IN GDD-FLD = WSS-COD-PESO
              PERFORM VALOR-LIMITE-A-PESO
           ELSE
              PERFORM VALOR-LIMITE-NO-PESO.

       FIN-CAL-VALOR-LIMITE.
           EXIT.
      *----------------------------
      *----------------------------
       VALOR-LIMITE-A-PESO SECTION.
       INI-VALOR-LIMITE-A-PESO.
      *CAMBIO CUANDO VALOR GTIA ES PESO
           MOVE GDD-COD-VCAM IN GDD-FLD  TO CAM-COD-VCAM IN CAM(1)
           MOVE GDG-COD-VCAM IN GDD-FLD  TO CAM-COD-VCAM IN CAM(2)
           MOVE GDD-NUM-DING IN GDD-FLD  TO CAM-NUM-DCAM IN CAM(1)
           MOVE GDD-NUM-MING IN GDD-FLD  TO CAM-NUM-MCAM IN CAM(1)
           MOVE GDD-NUM-SING IN GDD-FLD  TO CAM-NUM-SCAM IN CAM(1)
           MOVE GDD-NUM-AING IN GDD-FLD  TO CAM-NUM-ACAM IN CAM(1)
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = WSS-CTE-S)
               MOVE WSS-CTE-COL    TO MSG-COD-SIST
               MOVE WSS-CTE-CAMNEX TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VALOR-LIMITE-A-PESO.

           COMPUTE GDD-SGV-VLIM IN GDD-FLD = GDD-SGV-VALR IN GDD-FLD *
                                             CAM-SGV-VCAM IN CAM.

       FIN-VALOR-LIMITE-A-PESO.
           EXIT.
      *----------------------------
      *----------------------------
       VALOR-LIMITE-NO-PESO SECTION.
       INI-VALOR-LIMITE-NO-PESO.
      *CAMBIO CUANDO VALOR GTIA NO ES PESO, SE PASA AMBOS VALORES A PESO
      *Y SE CALCULA EQUIVALENCIA
           MOVE GDG-COD-VCAM IN GDD-FLD  TO CAM-COD-VCAM IN CAM(1)
           MOVE WSS-COD-PESO             TO CAM-COD-VCAM IN CAM(2)
           MOVE GDD-NUM-DING IN GDD-FLD  TO CAM-NUM-DCAM IN CAM(1)
           MOVE GDD-NUM-MING IN GDD-FLD  TO CAM-NUM-MCAM IN CAM(1)
           MOVE GDD-NUM-SING IN GDD-FLD  TO CAM-NUM-SCAM IN CAM(1)
           MOVE GDD-NUM-AING IN GDD-FLD  TO CAM-NUM-ACAM IN CAM(1)
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = WSS-CTE-S)
               MOVE WSS-CTE-COL    TO MSG-COD-SIST
               MOVE WSS-CTE-CAMNEX TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VALOR-LIMITE-NO-PESO.

           MOVE  CAM-SGV-VCAM IN CAM TO WSS-NUM-MGDG.

           IF GDD-COD-VCAM IN GDD-FLD = WSS-COD-PESO
              MOVE WSS-CTE-1 TO WSS-NUM-MGDD
              GO TO CON-VALOR-LIMITE-NO-PESO.

           MOVE GDD-COD-VCAM IN GDD-FLD  TO CAM-COD-VCAM IN CAM(1)
           MOVE WSS-COD-PESO             TO CAM-COD-VCAM IN CAM(2)
           MOVE GDD-NUM-DING IN GDD-FLD  TO CAM-NUM-DCAM IN CAM(1)
           MOVE GDD-NUM-MING IN GDD-FLD  TO CAM-NUM-MCAM IN CAM(1)
           MOVE GDD-NUM-SING IN GDD-FLD  TO CAM-NUM-SCAM IN CAM(1)
           MOVE GDD-NUM-AING IN GDD-FLD  TO CAM-NUM-ACAM IN CAM(1)
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = WSS-CTE-S)
               MOVE WSS-CTE-COL    TO MSG-COD-SIST
               MOVE WSS-CTE-CAMNEX TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VALOR-LIMITE-NO-PESO.

           MOVE  CAM-SGV-VCAM IN CAM TO WSS-NUM-MGDD.

       CON-VALOR-LIMITE-NO-PESO.

           COMPUTE WSS-NUM-CONV = WSS-NUM-MGDD /
                                  WSS-NUM-MGDG.

           COMPUTE GDD-SGV-VLIM IN GDD-FLD ROUNDED =  
                                              GDD-SGV-VALR IN GDD-FLD *
                                              WSS-NUM-CONV.

       FIN-VALOR-LIMITE-NO-PESO.
           EXIT.
      *OGB-FIN 08-OCT-2015 LIMITE DE GARANTIAS
      *>>>>
*% END
