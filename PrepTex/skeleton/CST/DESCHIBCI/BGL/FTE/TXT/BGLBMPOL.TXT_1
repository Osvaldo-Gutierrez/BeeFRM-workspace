*%! Codigo adicional para archivo BGLBMPOL
*% IF SETTAG
*% FNCBQ = "OWFBGL"
*% VSNBQ = "06.06.29"
*% FNCBU = "OWFBGL"
*% VSNBU = "06.06.29"
*% END
*% IF FIN_FRM_IND_HMAS
      *<<<<
                                                                        
           IF (FRM-CAI-GRTA IN POL-FLD NOT > SPACES OR                  
               FRM-IIC-GRTA IN POL-FLD NOT > SPACES)                    
               MOVE SPACES TO FRM-IND-HMAS IN POL-FLD                   
               GO TO FIN-VAL-FRM-IND-HMAS.                              
      *EVA                                                              
           IF FRM-IND-HMAS IN POL-FLD > SPACES AND                      
             NOT (FRM-IND-HMAS IN POL-FLD = '+' OR                      
                  FRM-IND-HMAS IN POL-FLD = '-')                        
                 MOVE 'BGL'   TO MSG-COD-SIST                           
                 MOVE 'CODNOVALI' TO MSG-COD-MENS                       
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.                         
      *>>>>
*% END
*% IF FIN_PUT_POL_POL
      *<<<< FIN-PUT-POL-POL
      *BUS-TAB busca glosa de codigo en tabla                           
           IF POL-COD-SEGU IN POL-FLD > SPACES                          
               MOVE 'BGL' TO TAB-COD-SIST                               
               MOVE 'RSE ' TO TAB-COD-TTAB IN TAB                       
               MOVE POL-COD-SEGU IN POL-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-SEGU IN POL-FLD                             
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-SEGU IN POL-FLD.                  
      *>>>>
*% END
*% IF INI_FRM_FEC_FINI
      *<<<<
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO FRM-FEC-FINI IN POL-FLD.
           GO TO FIN-VAL-FRM-FEC-FINI.                              
      *>>>>
*% END
*% IF INI_FRM_FEC_FFIN
      *<<<<
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
              MOVE FEC-FECH TO FRM-FEC-FFIN IN POL-FLD.
           GO TO FIN-VAL-FRM-FEC-FFIN.
      *>>>>
*% END
*% IF FIN_POL_COD_ESGE
      *<<<< FIN_VAL_POL_COD_ESGE
           IF POL-COD-ESGE IN POL-FLD NOT > SPACES                      
      *       PERFORM ERR-GLS                                           
              GO TO FIN-VAL-POL-COD-ESGE.                               
           IF SCR-CMND = 'ACT'                                          
              IF NOT (POL-COD-ESGE IN POL-FLD = '10' OR  
                 POL-COD-ESGE IN POL-FLD = '40' OR               
                 POL-COD-ESGE IN POL-FLD NOT > SPACES)                   
                 MOVE 'BGL'            TO MSG-COD-SIST                   
                 MOVE 'SOLO 10 O 40'   TO MSG-COD-MENS                   
                 PERFORM GET-MSG                                         
                 MOVE MSG-GLS-DESC TO FRM-MENS                           
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.                          
       *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'SPO ' TO TAB-COD-TTAB IN TAB.                          
           MOVE POL-COD-ESGE IN POL-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-ESGE IN POL-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-ESGE IN POL-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-ESGE IN POL-FLD.           
      *>>>>
*% END
*% IF FIN_POL_COD_SEGU
      *<<<< FIN_VAL_POL_COD_SEGU
           IF POL-COD-SEGU IN POL-FLD NOT > SPACES                      
      *         PERFORM ERR-GLS                                         
                GO TO FIN-VAL-POL-COD-SEGU.                             
      *VAL-COD VALIDA CODIGO EN TABLA                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'RSE' TO TAB-COD-TTAB IN TAB.
           MOVE POL-COD-SEGU IN POL-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-SEGU IN POL-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-SEGU IN POL-FLD                   
           ELSE   
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-SEGU IN POL-FLD.    
      *>>>>
*% END
*% IF INI_PUT_GDG_POL
      *<<<< INI-PUT-GDG-POL                                             
           IF GDG-CIC-EJOR IN POL-FLD > SPACES                          
              MOVE GDG-CIC-EJOR IN POL-FLD TO USR-COD-USER IN USR
              PERFORM BUS-USR                                           
              MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN POL-FLD       
           ELSE                                             
              MOVE SPACES TO FRM-GLS-EJOR IN POL-FLD.                   
           GO TO FIN-PUT-GDG-POL.                        
      *>>>>                                           
*% END
