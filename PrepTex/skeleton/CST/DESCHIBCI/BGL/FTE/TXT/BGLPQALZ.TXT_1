*%! Codigo adicional para archivo BGLPQALZ
*% IF SETTAG
*% FNCPQ = "OWFBGL"
*% VSNPQ = "06.06.29"
*% FNCPU = "OWFBGL"
*% VSNPU = "06.06.29"
*% END
*% PGM_PTC = TRUE
*% IF WSS
      *<<<< WSS
       COPY GNSWGCPT.                                                  
       COPY TABBRCAM.                                                  
       COPY SGCBRDBC.                                                  
       COPY BGLBRGTP.
       COPY BGLBRGVT.
       COPY BGLBRGDG.                                                  
       COPY BGLBRGDD.                                                  
       COPY GNSWGPES.                                                  
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.       
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.       
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.       
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GTP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.       

       01 WSS-VARI.                                                    
           03 WSS-COD-CGTA.                                            
              05 WSS-TIP-CGTA                   PIC X(03).             
              05 WSS-STP-CGTA                   PIC X(03).      
                                                                       
           03 WSS-GLS-CGTA.                                            
              05 WSS-GLS-TOPE                   PIC X(10).             
              05 WSS-GLS-SOPE                   PIC X(15).        
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           MOVE ALZ-CAI-GTIA IN ALZ-FLD TO GDG-CAI-GTIA IN GDG.        
           MOVE ALZ-IIC-GTIA IN ALZ-FLD TO GDG-IIC-GTIA IN GDG.        
           MOVE FIO-GET-KEY TO FIO-CMND.                               
           PERFORM BGL-FIO-GDG.                                        
           MOVE FIO-STAT TO PGM-STAT-GDG.                              
           IF NOT (FIO-STAT-OKS)                                       
              MOVE 'GTIA NO EXI' TO MSG-COD-MENS                       
              GO TO ERR-FND-KEY.                                       
           PERFORM PUT-GDG-ALZ.                                        
                                                                       
           IF SCR-CMND = 'ING'                                         
              IF (GDG-IND-EST1 IN GDG > '19' OR                        
                  GDG-IND-EST1 IN GDG < '10')                          
                   MOVE 'GTIANOCONSTI' TO MSG-COD-MENS                 
                   GO TO ERR-FND-KEY.   
       CON-FND-KEY.
           MOVE ALZ-CAI-GTIA IN ALZ-FLD TO GDD-CAI-GTIA IN GDD.        
           MOVE ALZ-IIC-GTIA IN ALZ-FLD TO GDD-IIC-GTIA IN GDD.        
           MOVE FIO-GET-NLS         TO FIO-CMND.                       
           MOVE 'GDD-KEY-AGDD'      TO FIO-AKEY.                       
           PERFORM BGL-FIO-GDD.     
           IF NOT ( FIO-STAT-OKS AND                                   
              ALZ-CAI-GTIA IN ALZ-FLD = GDD-CAI-GTIA IN GDD AND        
              ALZ-IIC-GTIA IN ALZ-FLD = GDD-IIC-GTIA IN GDD )          
                MOVE 'GDD    NEX'     TO MSG-COD-MENS                  
                GO TO ERR-FND-KEY.                                     
                                                  
           MOVE GDD-CIC-DCLI IN GDD TO DBC-CIC-ICLI IN DBC.            
           MOVE FIO-GET-KEY         TO FIO-CMND.                       
           PERFORM SGC-FIO-DBC.                                        
           IF NOT FIO-STAT-OKS                                         
              MOVE 'CLI   INEX'     TO MSG-COD-MENS                    
                GO TO ERR-FND-KEY.                                 
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                       
           PERFORM CPT-BLKS.                                           
           MOVE CPT-STRN TO FRM-GLS-NDBC IN ALZ-FLD.                   
           IF ALZ-NUM-CORR IN ALZ-FLD NOT > ZEROES                      
               PERFORM BUS-COR-ALZ                                      
               IF MSG-COD-MENS > SPACES                                 
                   GO TO ERR-FND-KEY.                                   
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-ALZ.                                         
           GO TO SIG-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       SIG-FND-KEY.
           IF FIO-STAT-OKS 
               IF (SCR-CMND = 'MOD' AND                                     
                   ALZ-NUM-ESTA IN ALZ NOT = '01')                           
                   MOVE 'EST NOT = 01' TO MSG-COD-MENS                       
                   GO TO ERR-FND-KEY                                         
               ELSE                                                         
               IF (SCR-CMND = 'ELI' AND                                     
                   ALZ-NUM-ESTA IN ALZ NOT = '01')                         
                   MOVE 'EST NOT = 01' TO MSG-COD-MENS                       
                   GO TO ERR-FND-KEY                                         
               ELSE                                                         
               IF (SCR-CMND = 'CAN' AND                                     
                   ALZ-NUM-ESTA IN ALZ NOT = '02')                           
                   MOVE 'EST NOT = 02' TO MSG-COD-MENS                       
                   GO TO ERR-FND-KEY                                         
               ELSE                                                         
               IF (SCR-CMND = 'ACA' AND                                     
                   ALZ-NUM-ESTA IN ALZ NOT = '01')                           
                   MOVE 'ESTAD NOT=01' TO MSG-COD-MENS                       
                   GO TO ERR-FND-KEY                                         
               ELSE                                                         
               IF (SCR-CMND = 'MGA' AND                                     
                   ALZ-NUM-ESTA IN ALZ NOT = '02')                           
                   MOVE 'ESTADO NO=02' TO MSG-COD-MENS                       
                   GO TO ERR-FND-KEY
               MOVE ALZ-STP-ITRN IN ALZ TO SCR-UMOD.                     
           MOVE FIO-STAT TO PGM-STAT-ALZ.                               
      *    MOVE PGM-STAT-ALZ TO FIO-STAT.                               
           GO TO FIN-FND-KEY.                                           
                                                                       
       ERR-FND-KEY.                                                    
           MOVE 'BGL' TO MSG-COD-SIST.                                 
           PERFORM GET-MSG.                                            
           MOVE MSG-GLS-DESC TO FRM-MENS.                              
           MOVE SCR-STAT-ABT TO SCR-STAT.                              
           IF SCR-CCPP = 'ING'                                         
              MOVE '00'      TO FIO-STAT                               
           ELSE                                                        
              MOVE FIO-STAT-NEX TO FIO-STAT.  
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'ING'                                         
              MOVE -1           TO ALZ-IND-TALZ-LEN IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-COD-ABGD-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-FLIO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FASG-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-LIBR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-CMTE-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FRCO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OBCM-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-IDRC-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FCNF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-NOCB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FFIR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FNTF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ESTA-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-VRF-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-IND-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-MCAN-ATR IN ALZ-FLD.        

           IF SCR-CMND = 'MOD'                                         
              MOVE -1           TO ALZ-IND-TALZ-LEN IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-COD-ABGD-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-FLIO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FASG-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-LIBR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FCNF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-NOCB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FFIR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FNTF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-VRF-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-IND-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-MCAN-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ESTA-ATR IN ALZ-FLD.        

          IF SCR-CMND = 'ELI'                                         
              MOVE FRM-CPIM-AEY TO ALZ-IND-TALZ-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ITSN-ATR IN ALZ-FLD          
              MOVE FRM-CPIM-AEY TO ALZ-COD-ITSN-ATR IN ALZ-FLD          
              MOVE FRM-CPIM-AEY TO ALZ-IND-ITRA-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-IND-APRC-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-COD-ABGD-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-FLIO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FASG-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-LIBR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-CMTE-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FRCO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OBCM-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-IDRC-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FCNF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-NOCB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FFIR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-VRF-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-IND-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FNTF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ESTA-ATR IN ALZ-FLD.        

         IF SCR-CMND = 'MGA'                                         
              MOVE FRM-CPIM-AEY TO ALZ-IND-TALZ-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ITSN-ATR IN ALZ-FLD          
              MOVE FRM-CPIM-AEY TO ALZ-COD-ITSN-ATR IN ALZ-FLD          
              MOVE FRM-CPIM-AEY TO ALZ-IND-ITRA-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-IND-APRC-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-CMTE-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FRCO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OBCM-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-IDRC-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ESTA-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-MCAN-ATR IN ALZ-FLD         
              MOVE 0            TO ALZ-IND-TALZ-LEN IN ALZ-FLD          
              MOVE -1           TO ALZ-COD-ABGD-LEN IN ALZ-FLD.        

           IF SCR-CMND = 'ACA'                                         
              MOVE FRM-CPIM-AEY TO ALZ-IND-TALZ-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ITSN-ATR IN ALZ-FLD          
              MOVE FRM-CPIM-AEY TO ALZ-COD-ITSN-ATR IN ALZ-FLD          
              MOVE FRM-CPIM-AEY TO ALZ-IND-ITRA-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-IND-APRC-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-COD-ABGD-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-FLIO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FASG-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-LIBR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-VRF-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-IND-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-CMTE-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FRCO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OBCM-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-IDRC-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FCNF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-NOCB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FFIR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FNTF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ESTA-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-MCAN-ATR IN ALZ-FLD        
              MOVE 0            TO ALZ-IND-TALZ-LEN IN ALZ-FLD          
              MOVE -1           TO ALZ-GLS-MENS-LEN.                   

          IF SCR-CMND = 'CAN'                                         
              MOVE FRM-CPIM-AEY TO ALZ-IND-TALZ-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ITSN-ATR IN ALZ-FLD          
              MOVE FRM-CPIM-AEY TO ALZ-COD-ITSN-ATR IN ALZ-FLD          
              MOVE FRM-CPIM-AEY TO ALZ-IND-ITRA-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-IND-APRC-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-COD-ABGD-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-FLIO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FASG-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-VRF-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-IND-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-ICLI-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-LIBR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-CMTE-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FRCO-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OBCM-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-IDRC-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FCNF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-OVIB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-GLS-NOCB-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FFIR-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-FEC-FNTF-ATR IN ALZ-FLD         
              MOVE FRM-CPIM-AEY TO ALZ-NUM-ESTA-ATR IN ALZ-FLD         
              MOVE 0            TO ALZ-IND-TALZ-LEN IN ALZ-FLD          
              MOVE -1           TO ALZ-GLS-MCAN-LEN IN ALZ-FLD.        
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
           IF SCR-CMND = 'ACA'                                          
              MOVE '02' TO ALZ-NUM-ESTA IN ALZ                          
           ELSE                                                         
           IF SCR-CMND = 'CAN'                                          
              MOVE '03' TO ALZ-NUM-ESTA IN ALZ.                         
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE '01' TO ALZ-NUM-ESTA IN ALZ-FLD.                        
           MOVE ALZ-NUM-ESTA IN ALZ-FLD TO ALZ-NUM-ESTA IN ALZ.         
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       BUS-ULT-ALZ SECTION.                                             
       INI-BUS-ULT-ALZ.                                                 
           MOVE ALZ-CAI-GTIA IN ALZ-FLD TO ALZ-CAI-GTIA IN ALZ.         
           MOVE ALZ-IIC-GTIA IN ALZ-FLD TO ALZ-IIC-GTIA IN ALZ.         
           MOVE ALZ-NUM-CORR IN ALZ-FLD TO ALZ-NUM-CORR IN ALZ.         
           MOVE ALZ-NUM-ITSN IN ALZ-FLD TO ALZ-NUM-ITSN IN ALZ.         
           MOVE '00' TO FIO-STAT.                                       
           MOVE 999  TO ALZ-COD-ITSN IN ALZ.                            
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM BGL-FIO-ALZ.                                         
           IF FIO-STAT-OKS AND                                          
              ALZ-CAI-GTIA IN ALZ-FLD = ALZ-CAI-GTIA IN ALZ AND         
              ALZ-IIC-GTIA IN ALZ-FLD = ALZ-IIC-GTIA IN ALZ AND         
              ALZ-NUM-CORR IN ALZ-FLD = ALZ-NUM-CORR IN ALZ AND         
              ALZ-NUM-ITSN IN ALZ-FLD = ALZ-NUM-ITSN IN ALZ             
               NEXT SENTENCE                                            
           ELSE                                                         
               MOVE ZEROES TO ALZ-COD-ITSN IN ALZ.                      
       FIN-BUS-ULT-ALZ.
           EXIT.                                                        
       BUS-COR-ALZ SECTION.                                             
       INI-BUS-COR-ALZ.                                                 
           MOVE ALZ-CAI-GTIA IN ALZ-FLD TO ALZ-CAI-GTIA IN ALZ.         
           MOVE ALZ-IIC-GTIA IN ALZ-FLD TO ALZ-IIC-GTIA IN ALZ.         
           MOVE 999 TO ALZ-NUM-CORR IN ALZ.                             
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM BGL-FIO-ALZ.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    ALZ-CAI-GTIA IN ALZ-FLD = ALZ-CAI-GTIA IN ALZ AND   
                    ALZ-IIC-GTIA IN ALZ-FLD = ALZ-IIC-GTIA IN ALZ )     
               PERFORM KEY-ALL-ALZ                                      
               MOVE ZEROES TO ALZ-NUM-CORR IN ALZ.                      
           IF SCR-CCPP = 'ING' OR 'ACT'                                 
               IF ALZ-NUM-CORR IN ALZ > ZEROES                          
                   IF ALZ-NUM-ESTA IN ALZ NOT = '03'                    
                       MOVE 'ALZANTNOTCAN' TO MSG-COD-MENS              
                       GO TO FIN-BUS-COR-ALZ.                           
           IF SCR-CCPP = 'ING' OR 'ACT'                                 
               ADD 1 TO ALZ-NUM-CORR IN ALZ.                            
           MOVE ALZ-NUM-CORR IN ALZ TO ALZ-NUM-CORR IN ALZ-FLD.         
       FIN-BUS-COR-ALZ.                                                 
           EXIT.                                                        
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY BGLBFGDG.                                                  
       COPY BGLBFGTP.                                                   
       COPY BGLBFGVT.                                                   
       COPY BGLBFGDD.                                                  
       COPY SGCBFDBC.
       COPY GNSBVCOD.                                                  
       COPY GNSBVTAB.                                                  
       COPY GNSBBTAB.     
       COPY GNSBGCPT.                                                  
      *>>>>
*% END
