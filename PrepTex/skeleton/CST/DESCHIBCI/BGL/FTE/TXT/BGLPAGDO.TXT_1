*%! NO_TIENE_TIMESTAMP = TRUE
*%! NO_HDR_CST = TRUE
*%! PGM_GDO = TRUE
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*%! IF PGM_DTC
*%! INCLUDE 'BGLSRC:GNSVSIDTC.SRC'
*%! END
*%! HASTA AQUI PARA MANEJAR VSAM EN AMBIENTE DTC
*%! IF NOT PGM_MCP
*% PGM_PTC = TRUE
*%! END
*% FRM = 'GDO'
*% REG = 'GDO'
*% HIJ = 'GDG'
*% CAIREG = 'GDO-CAI-GTIA'
*% IICREG = 'GDO-IIC-GTIA'
*% CAIFLD = 'GDO-CAI-GTIA'
*% IICFLD = 'GDO-IIC-GTIA'
*% SISREG = 'BGL'
*% VSNPQ = "06.06.29"
*% FNCPQ = "OWFBGL"
*% VSNPU = "06.06.29"
*% FNCPU = "OWFBGL"
*% IF NOT PGM_MCP AND PGM_PQ
*%! Codigo adicional para Funcion BGLPPVCG = PF5
*% INCLUDE 'BGLSRC:PFALL5.SRC'
*%! Codigo adicional para archivo
*% END
*% IF PGM_DTC
*% IF EOF
      *<<<< EOF
       COPY GNSBFMSC.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBVMSC.                                                   
      *MHM-INI 23-OCT-2003
       COPY GNSBGCPT.
      *MHM-FIN 23-OCT-2003
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>> END EOF
*% END
*% END
*% IF CMT_ID
      *-----------------------------------------------------------------
      * MODIFICACIONES:
      *-----------------------------------------------------------------
      *  AUTOR      : BEE-RRM
      *  FECHA      : JUL-2018
      *  ETIQUETA   : *RRM-INI JUL-2018 REVALORIZACION DE FFMM
      *  PROYECTO   : AUDITORIA REVALORIZACION FFMM (LIDER: JRF)
      *  OBJETIVO   : AUTOMATIZAR LA VALORIZACION DE FFMM.
      *               ESPECIFICAMENTE EN ESTE PROGRAMA SE MODIFICO PARA
      *               A TRAVES DE LA PANTALLA GDO SE PUEDA ASOCIAR LA 
      *               PRENDA FFMM CON EL FFMM RESPECTIVO, RECONOCIENDO 
      *               ESTE TIPO DE PRODUCTO.
      *-----------------------------------------------------------------
*% END
*% IF FIN_SCR_VARI
           03 CMA-VARI.
               05 GAR-CAI-GTIA                     PIC X(04).
               05 GAR-IIC-GTIA                     PIC X(08).
               05 GDG-FEC-FSOL.
                  07 GDG-NUM-SSOL                  PIC 9(02).
                  07 GDG-NUM-ASOL                  PIC 9(02).
                  07 GDG-NUM-MSOL                  PIC 9(02).
                  07 GDG-NUM-DSOL                  PIC 9(02).
               05 CMA-CIC-TGAR                     PIC X(06).
*% END
*% IF WSS
      *MHM-INI 23-OCT-2003
       COPY GNSWGCPT.
      *MHM-FIN 23-OCT-2003
       COPY BGLBRGDG.
       COPY BGLBRTAG.
       COPY BGLWGVCG.
      *MHM-INI 31-JUL-2003
           COPY USPC113.
      *MHM-FIN 31-JUL-2003
*% IF PGM_CLB OR PGM_MEX
       COPY TABBRIVB.
       COPY BGLBRGAP.
       COPY BGLBRGDD.
       COPY BGLBRGDP.
       COPY BGLBRGES.
       COPY BGLBRGIN.
       COPY BGLBRGLE.
       COPY BGLBRGMO.
       COPY BGLBRGSE.
       COPY BGLBRGSI.
       COPY BGLBRGTP.
       COPY BGLBRGUB.
       COPY BGLBRGVT.
       COPY BGLBRGIM.
       COPY BGLBRGVE.
       COPY BGLWVVCG.
*% END
      *REGISTRADO YA COMO GARANTIA. 
       COPY BGLWGVDO.
      *
*% IF PGM_DTC
      *<<<< WSS AND PGM_DTC
*% IF PGM_PU                                
      * EVA-INI  06/08                                                  
       COPY DAPBROPD.                                                   
      * EVA-FIN  06/08                                                  
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.        
       COPY GNSBRMSC.                                                   
      * EVA-INI  06/08                                                  
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.        
      * EVA-FIN  06/08                                                  
*% END
*% IF PGM_PQ
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
*% END
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
      *>>>>
*% END
*% IF PGM_VAX
           03 WSS-REG                          PIC X(03).
*% END
      *RRM-INI 8-SEP-2001 
      *01  WSS-COD-SOPE                        PIC X(03).
       01  WSS-COD-CGTA.
           03  WSS-COD-TOPE                            PIC X(03).
           03  WSS-COD-SOPE                            PIC X(03).
               88 DEPOSITO-A-PLAZO  VALUE '080'.
      *RRM-FIN 8-SEP-2001 
       01  WSS-VARI.
           03 WSS-CIV-SIV.
              05 WSS-COD-INEM                     PIC X(03).
              05 WSS-COD-SIEM                     PIC X(03).
           03 WSS-COD-DOC-VAL.
              05 WSS-SUC-VAL                      PIC 9(03).
              05 WSS-SUF-VAL                      PIC 9(01).
              05 WSS-COD-VAL                      PIC 9(06).
              05 WSS-TIT-VAL                      PIC 9(06).
      *MHM-INI 23-OCT-2003
           03 WSS-GLS-CGTA.
              05 WSS-GLS-TOPE                   PIC X(40).
              05 WSS-GLS-SOPE                   PIC X(40).
      *MHM-FIN 23-OCT-2003
*% IF PGM_PU                                
      * EVA-INI  06/08                                                  
                                                                        
           03 WSS-IND-AMTM       VALUE SPACES   PIC X(01).              
                                                                        
           03 WSS-GLS-DATA.                                             
              05 WSS-IND-DBCI    VALUE SPACES   PIC X(01).              
              05 WSS-IND-DISP    VALUE SPACES   PIC X(09).              
                                                                        
           03 WSS-GLS-NEMO.                                             
              05 WSS-IND-NEMO    VALUE SPACES   PIC X(02).              
              05 WSS-IND-NDIS    VALUE SPACES   PIC X(08).              
                                                                        
           03 WSS-COD-VCAM       VALUE SPACES   PIC X(04).              
                                                                        
           03 WSS-COD-NEMO.                                             
              05 WSS-IND-NCAM     VALUE SPACES    PIC X(02).            
              05 WSS-IND-NBCO     VALUE 'BCI'     PIC X(03).            
              05 WSS-IND-NSEP     VALUE '-'       PIC X(01).            
              05 WSS-FEC-NDEP.                                          
                 07 WSS-NUM-DDEP  VALUE ZEROES    PIC 9(02).            
                 07 WSS-NUM-MDEP  VALUE ZEROES    PIC 9(02).            
                 07 WSS-NUM-ADEP  VALUE ZEROES    PIC 9(02).            
                                                                        
      * EVA-FIN  06/08                        
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM      
           03 WSS-IND-FFMM        VALUE SPACES    PIC X(01).
           03 WSS-S               VALUE 'S'       PIC X(01).
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM
*% END
*% IF PGM_PQ
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM      
           03 WSS-IND-FFMM        VALUE SPACES    PIC X(01).
           03 WSS-S               VALUE 'S'       PIC X(01).
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM
*% END
*% END
*% CMA_USR = TRUE
*% IF CMA AND NOT PGM_VAX
*% IF NOT PGM_MCP
           02 FILLER                       PIC X(276).
*% ELSE
       01 FILLER                           PIC X(276).
*% END
*% END
*% IF INI_FIO AND NOT PGM_VAX
      *<<<< INI_FIO
           MOVE +276 TO SCR-TCMA.
      *>>>>
*% END
*% IF INI_FIO AND PGM_VAX
      *<<<< INI_FIO

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'BGL'        TO FIO-SIST.
           PERFORM BGL-FIO-GDG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'BGL'        TO FIO-SIST.
           PERFORM BGL-FIO-TAG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM BGL-FIO-TAG.

      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *MHM-INI 23-MAY-2006                                             
      **MHM-INI 31-JUL-2003                                            
      ** LLAMA A SUBRUTINA VALIDACION CONSISTENCIA GARANTIA            
      *    IF FRM-FFLD = FRM-FFLD-PF5                                  
      *        PERFORM GAR-PRO-VCG                                     
      *        GO TO FIN-FND-KEY.                                      
      *                                                                
      **MHM-FIN 31-JUL-2003                                            
      *MHM-FIN 23-MAY-2006                                             
*% FIN_BUS_HIJ = TRUE
       BUS-GDG.
           MOVE GDO-CAI-GTIA IN GDO-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GDO-IIC-GTIA IN GDO-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           MOVE FIO-STAT TO PGM-STAT-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
*% IF PGM_CHI
      *<<<< PGM_CHI
           IF SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON
               GO TO FIN-VAL-OFI-USP-GDO.
           IF SCR-OFRM-SRV                                             
              GO TO FIN-VAL-OFI-USP-GDO.                               

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-VAL-OFI-USP-GDO.
      *MHM-INI 31-JUL-2003
      *ALD-BCI-INI/07032000
           COPY USPC143.
           MOVE 'BGLGTUCG/CEN' TO USP-PTA-STR.
           COPY USPC103.
           IF USP-PERMISO = 'P'
               GO TO FIN-VAL-OFI-USP-GDO.
      *    COPY USPC143.
      *ALD-BCI-FIN/07032000
      *MHM-FIN 31-JUL-2003
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG 
               MOVE 'USRNODEOFI' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

       FIN-VAL-OFI-USP-GDO.
      *>>>>
*% END
*% IF PGM_PER AND PGM_GVT
      *<<<< PGM_PER AND PGM_GVT
       COPY BGLBVUOF.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-FND-KEY.
      *>>>>
*% END

       FIN-BUS-GDG.
      *RRM-INI 8-SEP-2001
      *    MOVE GDG-COD-TOPE IN GDG TO GDG-COD-TOPE IN GDO-FLD.
      *    MOVE GDG-COD-SOPE IN GDG TO GDG-COD-SOPE IN GDO-FLD.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GDO-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GDO-FLD.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GDG TO GDG-COD-CGTA IN GDO-FLD.
*% END
      *RRM-INI 8-SEP-2001

      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
      *>>>>
*% ELSE
           MOVE 'GTA' TO TAB-COD-TTAB IN TAB.
*% END
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
      *RRM-FIN 8-SEP-2001
      *    MOVE GDG-COD-TOPE IN GDO-FLD TO TAG-COD-TOPE IN TAG.
      *    MOVE GDG-COD-SOPE IN GDO-FLD TO TAG-COD-SOPE IN TAG.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GDO-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GDO-FLD TO TAG-STP-AGTA IN TAG.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GDO-FLD TO TAG-COD-AGTA IN TAG.
*% END
      *RRM-INI 8-SEP-2001
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
      *         MOVE TAB-CIC-CTAB IN TAB TO CMA-CIC-TGAR IN CMA-VARI
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CGTA IN GDO-FLD
           ELSE
      *         MOVE SPACES TO CMA-CIC-TGAR IN CMA-VARI
               MOVE SPACES TO FRM-GLS-CGTA IN GDO-FLD.

      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'BGL' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'BGL' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB
                     
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TREA IN GDO-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TREA IN GDO-FLD.


           MOVE GDG-CAI-GTIA IN GDG TO GAR-CAI-GTIA IN CMA-VARI.
           MOVE GDG-IIC-GTIA IN GDG TO GAR-IIC-GTIA IN CMA-VARI.
           IF SCR-CMND = 'ING'
               PERFORM PUT-GDG-GDO.

      * Valida Este permitido esta Entidad para Tipo-Subtipo
           IF TAG-IND-EGDO IN TAG = 'N'
               MOVE 'TAG    NOPGM' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           MOVE GDG-FEC-FSOL IN GDG TO GDG-FEC-FSOL IN CMA-VARI.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
*% IF PGM_PER
           IF CMA-CIC-TGAR IN CMA-VARI = 'DOCVAL'
              AND ( SCR-CCPP = 'MOD' OR 'ELI' )
               MOVE GDO-COD-DOCU IN GDO TO WSS-COD-DOC-VAL IN WSS-VARI
               MOVE 'BGL'                   TO FIO-SIST
               MOVE 'SVM'                   TO TAB-COD-TTAB IN TAB
               MOVE WSS-SUC-VAL IN WSS-VARI TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                   MOVE 'BGL'      TO MSG-COD-SIST
                   MOVE 'BCPDOCNO' TO MSG-COD-MENS 
                   GO TO ERR-FND-KEY.

           IF CMA-CIC-TGAR IN CMA-VARI = ( 'DOCCBR' OR 'DOCCEX' OR 
              'DOCDPN' OR 'DOCFCC' )
                 AND (SCR-CCPP = 'ING'  OR  'MOD')
              MOVE 'BGL'      TO MSG-COD-SIST
              MOVE 'BCPDOCNO' TO MSG-COD-MENS 
              GO TO ERR-FND-KEY.
*% END
      * Comando Consulta Error lo trata el GENESIS
           IF SCR-CCPP = 'ACC' AND SCR-STPP = SCR-STAT-CON
               GO TO FIN-FND-KEY.

      * Garantia Alzada
           IF GDG-IND-EST1 IN GDG > '19'
               MOVE 'GDGALZ' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      * Garantia Completa
           IF SCR-CCPP = 'ELI' AND
              GDG-IND-GTAC IN GDG = 'S'
               MOVE 'GAR    CPL' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           GO TO FIN-FND-KEY.
       ERR-FND-KEY.
           MOVE 'BGL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE SCR-STAT-ABT TO SCR-STAT.
           IF SCR-CCPP = 'ING'
               MOVE '00' TO FIO-STAT
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT.

      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
               PERFORM BUS-COR-GDO
               GO TO CON-FND-KEY.

           IF GDO-NUM-IGDO IN GDO NOT > ZEROES
               PERFORM BUS-COR-GDO.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_HBL_FLD                                                 
      *<<<< FIN_HBL_FLD                                                 
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM                          
           MOVE GDO-CAI-GTIA IN GDO-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GDO-IIC-GTIA IN GDO-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
      *SI PRODUCTO (TIPO-SUBTIPO) ES FFMM, DEBE PROTEGER                
      *Nemotecnico (GDO-COD-NEMO)                                       
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'PFM'               TO TAB-COD-TTAB IN TAB.             
           MOVE GDG-COD-CGTA IN GDG TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S              
               MOVE WSS-S TO WSS-IND-FFMM                               
               MOVE FRM-CPIM-AEY TO GDO-COD-NEMO-ATR IN GDO-FLD.        
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM                          
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE SPACES TO GDO-GLS-FLAG IN GDO.
           MOVE SPACES TO GDO-MSC-TACC IN GDO.
           MOVE SPACES TO GDO-CIC-UING IN GDO.
      *    MOVE SPACES TO GDO-CIC-UACT IN GDO.
           MOVE 'I'    TO GDO-MSC-STAT IN GDO.


      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING'
              OR SCR-CMND = 'COP'
               MOVE 'I'      TO GDO-MSC-TACC    IN GDO

               MOVE HOY-FHOY TO GDO-FEC-FING IN GDO
*% IF PGM_MVS
               MOVE SCR-USER TO GDO-CIC-UING IN GDO
*% END
           ELSE
*% IF PGM_MVS
      *         MOVE SCR-USER TO GDO-CIC-UACT IN GDO
*% END
               MOVE 'M'      TO GDO-MSC-TACC    IN GDO.
*% IF PGM_MVS
*% END
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en la modificacion : informar               
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en el ingreso : informar                    
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING. 

           MOVE GDO-CAI-GTIA IN GDO TO GDG-CAI-GTIA IN GDG.
           MOVE GDO-IIC-GTIA IN GDO TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE 'S' TO GDG-IND-EGDO IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM BGL-FIO-GDG.

      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           MOVE GDO-CAI-GTIA IN GDO TO GDG-CAI-GTIA IN GDG.
           MOVE GDO-IIC-GTIA IN GDO TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE ' ' TO GDG-IND-EGDO IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM BGL-FIO-GDG.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-COR-GDO SECTION.
       INI-BUS-COR-GDO.
           MOVE 999 TO GDO-NUM-IGDO IN GDO.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM BGL-FIO-GDO.
           IF NOT ( FIO-STAT-OKS AND
                    GDO-CAI-GTIA IN GDO-FLD = GDO-CAI-GTIA IN GDO AND
                    GDO-IIC-GTIA IN GDO-FLD = GDO-IIC-GTIA IN GDO )
               PERFORM KEY-ALL-GDO
               MOVE ZEROES TO GDO-NUM-IGDO IN GDO.
           IF SCR-CCPP = 'ING'
               ADD 1 TO GDO-NUM-IGDO IN GDO
               MOVE GDO-NUM-IGDO IN GDO TO GDO-NUM-IGDO IN GDO-FLD
           ELSE
               MOVE GDO-NUM-IGDO IN GDO TO GDO-NUM-IGDO IN GDO-FLD.
       FIN-BUS-COR-GDO.
           EXIT.
      *************
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBVIND.                                                   
      ***************
*% IF PGM_PU                                
      * EVA-INI  06/08                                                  
       COPY DAPBFOPD.                                                   
      * EVA-FIN  06/08                                                  
*% END
       COPY BGLBFGDG.
       COPY BGLBFTAG.
*% IF PGM_CLB OR PGM_MEX
       COPY TABBFIVB.
       COPY BGLBFGAP.
       COPY BGLBFGSE.
       COPY BGLBFGDD.
       COPY BGLBFGES.
       COPY BGLBFGDP.
       COPY BGLBFGIN.
       COPY BGLBFGLE.
       COPY BGLBFGMO.
       COPY BGLBFGSI.
       COPY BGLBFGTP.
       COPY BGLBFGUB.
       COPY BGLBFGVT.
       COPY BGLBFGIM.
       COPY BGLBFGVE.
       COPY BGLBGVC2.
*% END
*% IF PGM_PU 
      *<<<< PGM_PU
       COPY BGLBGVDO.
      *>>>>
*% END
      *>>>>
       COPY BGLBKVCG.
       COPY BGLBGVCG.
*% END
