*% FRM = 'GIM'
*% REG = 'GIM'
*% VSNBQ = "06.06.29"
*% FNCBQ = "OWFBGL"
*% VSNBU = "06.06.29"
*% FNCBU = "OWFBGL"
*% IF GIM_VAL_COIM
      *<<<< GIM_VAL_COIM
      *AFRI-INI JUL/2004
           IF GIM-VAL-COIM IN GIM-FLD NOT > ZEROES
               MOVE ZEROES TO GIM-VAL-COIM IN GIM-FLD.
      *AFRI-FIN JUL/2004
      *MHM-INI 10-MAR-2004
      *    IF NOT ( WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'A' ) 
      *        MOVE ZEROES TO GIM-VAL-COIM IN GIM-FLD
           IF ( WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'A' ) AND          
               GIM-VAL-COIM IN GIM-FLD NOT > ZEROES 
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'M2CTR BLK'  TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *MHM-FIN 10-MAR-2004
                GO TO FIN-VAL-GIM-VAL-COIM. 
      *MHM-INI 10-MAR-2004
           IF ( WSS-IND-OBL2 IN WSS-VARI = 'N' OR 'T' ) AND
               GIM-VAL-COIM IN GIM-FLD > ZEROES
                MOVE ZEROES TO GIM-VAL-COIM IN GIM-FLD.

      *    IF GIM-VAL-COIM IN GIM-FLD = ZEROES
      *        MOVE 'BGL'        TO MSG-COD-SIST
      *        MOVE 'M2CTR BLK'  TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *MHM-FIN 10-MAR-2004
      *>>>>
*% END
*% IF GIM_VAL_TEIM
      *<<<< GIM_VAL_TEIM
      *AFRI-INI JUL/2004
           IF ((GIM-VAL-TEIM IN GIM-FLD NOT > ZEROES) AND
               (WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'N'))
                MOVE ZEROES TO GIM-VAL-TEIM IN GIM-FLD 
                GO TO FIN-VAL-GIM-VAL-TEIM.
      *AFRI-FIN JUL/2004
      *MHM-INI 10-MAR-2004
      *    IF NOT ( WSS-IND-OBL2 IN WSS-VARI = 'T' OR 'A' )   
      *        MOVE ZEROES TO GIM-VAL-TEIM IN GIM-FLD     
           IF ( WSS-IND-OBL2 IN WSS-VARI = 'T' OR 'A' ) AND     
                GIM-VAL-TEIM IN GIM-FLD NOT > ZEROES              
               MOVE 'BGL'        TO MSG-COD-SIST          
               MOVE 'M2TRR BLK'  TO MSG-COD-MENS          
               PERFORM GET-MSG                            
               MOVE MSG-GLS-DESC TO FRM-MENS              
               MOVE FRM-SUAR-MAL TO FRM-SUAR    
      *MHM-FIN 10-MAR-2004 
               GO TO FIN-VAL-GIM-VAL-TEIM.

      *MHM-INI 10-MAR-2004
           IF ( WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'N' ) AND
               GIM-VAL-TEIM IN GIM-FLD > ZEROES
                MOVE ZEROES TO GIM-VAL-TEIM IN GIM-FLD
                GO TO FIN-VAL-GIM-VAL-TEIM.
      *    IF GIM-VAL-TEIM IN GIM-FLD = ZEROES
      *        MOVE 'BGL'        TO MSG-COD-SIST
      *        MOVE 'M2TRR BLK'  TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *MHM-FIN 10-MAR-2004
      *>>>>
*% END
*% IF GIM_COD_TCNS
      *<<<< GIM_COD_TCNS
           MOVE GDG-TIP-CGTA IN GIM-FLD TO WSS-COD-TOPE IN WSS-VARI.
           MOVE GDG-STP-CGTA IN GIM-FLD TO WSS-COD-SOPE IN WSS-VARI.
           MOVE WSS-COD-TOPE IN WSS-VARI TO TAG-COD-TOPE IN TAG.
           MOVE WSS-COD-SOPE IN WSS-VARI TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
              MOVE SPACES TO GIM-COD-TCNS IN GIM-FLD                
              MOVE SPACES TO FRM-GLS-TCNS IN GIM-FLD                
              GO TO FIN-VAL-GIM-COD-TCNS.   

           MOVE TAG-IND-TPRE IN TAG TO WSS-IND-OBL1 IN WSS-VARI. 
           MOVE TAG-IND-OMCT IN TAG TO WSS-IND-OBL2 IN WSS-VARI.
           
           IF WSS-IND-OBL1 IN WSS-VARI = 'N' OR                      
              WSS-IND-OBL1 IN WSS-VARI = 'E'                         
               MOVE SPACES TO GIM-COD-TCNS IN GIM-FLD                
               MOVE SPACES TO FRM-GLS-TCNS IN GIM-FLD                
               GO TO FIN-VAL-GIM-COD-TCNS.                               
                                                                        
           IF GIM-COD-TCNS IN GIM-FLD = SPACES                           
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'TIPCTR BLK' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *VAL-COD Valida codigo de tabla            
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'CTR ' TO TAB-COD-TTAB IN TAB.
           MOVE GIM-COD-TCNS IN GIM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GIM-COD-TCNS IN GIM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TCNS IN GIM-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TCNS IN GIM-FLD.
      *>>>>
*% END
*% IF GIM_COD_UMDI
      *<<<< GIM_COD_UMDI
           IF NOT ( WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'T' OR 'A' )   
               MOVE SPACES TO GIM-COD-UMDI IN GIM-FLD               
               GO TO FIN-VAL-GIM-COD-UMDI.                          
                                                                   
           IF GIM-COD-UMDI IN GIM-FLD = ZEROES                      
               MOVE 'BGL'        TO MSG-COD-SIST 
               MOVE 'CODUMD BLK' TO MSG-COD-MENS 
               PERFORM GET-MSG                   
               MOVE MSG-GLS-DESC TO FRM-MENS     
               MOVE FRM-SUAR-MAL TO FRM-SUAR.    

      *VAL-COD Valida codigo de tabla            
           MOVE 'BGL' TO TAB-COD-SIST.           
           MOVE 'UMD ' TO TAB-COD-TTAB IN TAB. 
           MOVE GIM-COD-UMDI IN GIM-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GIM-COD-UMDI IN GIM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-UMDI IN GIM-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO           
                    FRM-GLS-UMDI IN GIM-FLD.         
      *>>>>
*% END
*% IF GIM_GLS_NOAR
      *<<<< GIM_GLS_NOAR
           IF GIM-COD-STIM IN GIM-FLD = '6' AND
              GIM-GLS-NOAR IN GIM-FLD = SPACES
               MOVE 'GLSOBLINOAR' TO MSG-COD-MENS
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GIM-GLS-NOAR.
      *<<<<
*% END
*% IF GIM_VAL_MOAR
      *<<<< GIM_VAL_MOAR
           IF GIM-COD-STIM IN GIM-FLD = '6' AND
              GIM-VAL-MOAR IN GIM-FLD = ZEROES
               MOVE 'VALOBLIMOAR' TO MSG-COD-MENS
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GIM-VAL-MOAR.
      *<<<<
*% END
*% IF INI_GIM_FEC_FVAR
      *<<<< INI_GIM_FEC_FVAR
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N  TO FEC-VHBL.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
      *<<<<
*% END
*% IF GIM_FEC_FVAR
      *<<<< GIM_FEC_FVAR
           IF GIM-COD-STIM IN GIM-FLD = '6' AND
              GIM-FEC-FVAR IN GIM-FLD = ZEROES
               MOVE 'FECOBLIFVAR' TO MSG-COD-MENS
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GIM-FEC-FVAR.
      *<<<<
*% END
*% IF FIN_PUT_GDG_GIM
      *<<<< FIN_PUT_GDG_GIM
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GIM-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GIM-FLD TO TAG-STP-AGTA IN TAG.
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GIM-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GIM-FLD.
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GIM-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GIM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GIM-FLD.
      *MHM-FIN 23-OCT-2003
      *<<<<
*% END
*% IF FIN_PUT_GDG_GIM
      *<<<< FIN_PUT_GDG_GIM
      *BUS-TAB busca glosa de codigo en tabla                           
           IF GIM-COD-TCNS IN GIM-FLD > SPACES                           
               MOVE 'BGL' TO TAB-COD-SIST                               
               MOVE 'CTR ' TO TAB-COD-TTAB IN TAB                       
               MOVE GIM-COD-TCNS IN GIM-FLD TO TAB-COD-CTAB IN TAB       
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-TCNS IN GIM-FLD                          
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-TCNS IN GIM-FLD.

      *BUS-TAB busca glosa de codigo en tabla                           
           IF GIM-COD-UMDI IN GIM-FLD > SPACES                           
               MOVE 'BGL' TO TAB-COD-SIST
               MOVE 'UMD ' TO TAB-COD-TTAB IN TAB
               MOVE GIM-COD-UMDI IN GIM-FLD TO TAB-COD-CTAB IN TAB 
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO           
                    FRM-GLS-UMDI IN GIM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UMDI IN GIM-FLD.
      *<<<<
*% END
*% IF FIN_PUT_GIM_GIM
      *<<<< FIN_PUT_GIM_GIM
      *BUS-TAB busca glosa de codigo en tabla                           
           IF GIM-IND-GASC IN GIM-FLD > SPACES                          
               MOVE 'BGL' TO TAB-COD-SIST                               
               MOVE 'HIP ' TO TAB-COD-TTAB IN TAB                       
               MOVE GIM-IND-GASC IN GIM-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-GASC IN GIM-FLD                             
           ELSE                                                         
               MOVE 'CREDITO NO CHIP' TO FRM-GLS-GASC IN GIM-FLD.       
      *MHM-INI 29-OCT-2003
           MOVE GIM-CIC-UING IN GIM TO CMA-CIC-UING IN CMA-VARI.
      *MHM-FIN 29-OCT-2003
      *<<<<
*% END
*% IF FIN_GIM_IND_GASC
      *<<<<
      *EVA-AFRI/AGOST2007                                               
           MOVE GIM-CAI-GTIA IN GIM-FLD TO GDD-CAI-GTIA IN GDD.         
           MOVE GIM-IIC-GTIA IN GIM-FLD TO GDD-IIC-GTIA IN GDD.         
           MOVE 'GDD-KEY-AGDD'       TO FIO-AKEY.                       
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
                                                                        
           PERFORM BGL-FIO-GDD.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-VAL-GIM-IND-GASC.                              
                                                                        
           MOVE GDD-CIC-DCLI IN GDD  TO  DBC-KEY-IDBC IN DBC.           
           MOVE FIO-GET-KEY          TO  FIO-CMND.                      
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
                GO TO FIN-CMN-ING.                                      
                                                                        
           IF DBC-NUM-ICLI IN DBC > '50000000'                          
              MOVE SPACES TO GIM-IND-GASC IN GIM-FLD.                   
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'HIP ' TO TAB-COD-TTAB IN TAB.                          
           MOVE GIM-IND-GASC IN GIM-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
              IF MSG-COD-MENS = 'COD    NEX' OR                         
              GIM-IND-GASC IN GIM-FLD NOT > SPACES                      
              MOVE 'CREDITO NO CHIP' TO FRM-GLS-GASC IN GIM-FLD         
              ELSE                                                      
                 MOVE TAB-GLS-DESC IN TAB TO                            
                 FRM-GLS-GASC IN GIM-FLD.                               
      *>>>>
*% END
*% IF FIN_GVT_SGV_FISI
      *<<<<
      ** EVA-INI                                                        
           IF GVT-SGV-FISI IN GIM-FLD NOT > ZEROES                      
              MOVE ZEROES TO GVT-SGV-FISI IN GIM-FLD.                   
      ** EVA-FIN                                                        
      *>>>>
*% END
*% IF GIM_COD_DEST
      *<<<<
           IF GIM-COD-DEST IN GIM-FLD NOT > SPACES                      
              MOVE '0' TO GIM-COD-DEST IN GIM-FLD.                      
      *>>>>
*% END
*% IF INI_GIM_COD_STIM
      *<<<< INI_GIM_COD_STIM
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GIM-COD-STIM IN GIM-FLD NOT > SPACES
               GO TO FIN-VAL-GIM-COD-STIM.
      *MHM-FIN 29-OCT-2003
      *<<<<
*% END
*% IF INI_GIM_NUM_EDIM
      *<<<< INI_GIM_NUM_EDIM
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GIM-NUM-EDIM IN GIM-FLD NOT > ZEROES
               GO TO FIN-VAL-GIM-NUM-EDIM.
      *MHM-FIN 29-OCT-2003
      *AFRI-INI/JUL2004
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.
           MOVE 'VGA'        TO TAB-COD-TTAB IN TAB.
           MOVE 'GIMEDIM'    TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE = 'S'
              MOVE TAB-GLS-DATA TO WSS-GLS-TGAR
              MOVE GDG-TIP-CGTA IN GIM-FLD TO WSS-COD-TOPE
              MOVE GDG-STP-CGTA IN GIM-FLD TO WSS-COD-SOPE 
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(1) AND
                 WSS-IND-TGAR(1) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(2) AND
                 WSS-IND-TGAR(2) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(3) AND
                 WSS-IND-TGAR(3) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(4) AND
                 WSS-IND-TGAR(4) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(5) AND
                 WSS-IND-TGAR(5) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(6) AND
                 WSS-IND-TGAR(6) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(7) AND
                 WSS-IND-TGAR(7) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(8) AND
                 WSS-IND-TGAR(8) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(9) AND
                 WSS-IND-TGAR(9) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(10) AND
                 WSS-IND-TGAR(10) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM.
      *AFRI-FIN/JUL2004
      *AFRI-INI/ENE2005                                                 
           GO TO FIN-VAL-GIM-NUM-EDIM.                             
      *AFRI-FIN/ENE2005                                                 
      *<<<<
*% END
