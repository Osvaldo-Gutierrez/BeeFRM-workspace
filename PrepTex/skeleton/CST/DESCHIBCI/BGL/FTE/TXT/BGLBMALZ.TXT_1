*%! Codigo adicional para archivo
*% IF SETTAG
*% FNCBQ = "OWFBGL"
*% VSNBQ = "06.06.29"
*% FNCBU = "OWFBGL"
*% VSNBU = "06.06.29"
*% END
*% IF FIN_PUT_ALZ_ALZ
      *<<<< FIN_PUT_ALZ_ALZ
      *BUS-TAB busca glosa de codigo en tabla                           
           IF ALZ-IND-TALZ IN ALZ-FLD > SPACES                          
               MOVE 'BGL' TO TAB-COD-SIST                               
               MOVE 'TAL ' TO TAB-COD-TTAB IN TAB                       
               MOVE ALZ-IND-TALZ IN ALZ-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-TALZ IN ALZ-FLD 
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-TALZ IN ALZ-FLD.                  
      *BUS-TAB busca glosa de codigo en tabla                           
           IF ALZ-NUM-ESTA IN ALZ-FLD > SPACES                          
               MOVE 'BGL' TO TAB-COD-SIST                               
               MOVE 'EDO ' TO TAB-COD-TTAB IN TAB                       
               MOVE ALZ-NUM-ESTA IN ALZ-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB 
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-ESTA IN ALZ-FLD                             
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-ESTA IN ALZ-FLD.   
      *BUS-TAB busca glosa de codigo en tabla                           
           IF ALZ-COD-ABGD IN ALZ-FLD > SPACES                          
               MOVE 'TAB' TO TAB-COD-SIST                               
               MOVE 'ABG ' TO TAB-COD-TTAB IN TAB                       
               MOVE ALZ-COD-ABGD IN ALZ-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-ABGD IN ALZ-FLD                             
           ELSE                                 
           MOVE SPACES TO FRM-GLS-ABGD IN ALZ-FLD.                  
           IF ALZ-NUM-ICLI IN ALZ-FLD > SPACES                          
              MOVE ALZ-NUM-ICLI IN ALZ-FLD TO DBC-NUM-ICLI IN DBC       
              MOVE ALZ-VRF-ICLI IN ALZ-FLD TO DBC-VRF-ICLI IN DBC       
              MOVE SPACES                  TO DBC-IND-ICLI IN DBC       
              MOVE SPACES                  TO DBC-GLS-ICLI IN DBC       
              MOVE 'DBC-IDC-ICLI' TO FIO-AKEY                           
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM SGC-FIO-DBC   
           IF FIO-STAT-OKS                                           
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                   
                 PERFORM CPT-BLKS                                       
                 MOVE CPT-STRN TO FRM-GLS-NALZ IN ALZ-FLD.                   
      *>>>>
*% END
*% IF FIN_PUT_GDG_ALZ
      *<<<< FIN_PUT_GDG_ALZ
      *BUS-TAB busca glosa de codigo en tabla                           
           IF GDG-TIP-CGTA IN ALZ-FLD > SPACES                          
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX ' TO TAB-COD-TTAB IN TAB   
               MOVE GDG-TIP-CGTA IN ALZ-FLD TO WSS-TIP-CGTA IN WSS-VARI
               MOVE GDG-STP-CGTA IN ALZ-FLD TO WSS-STP-CGTA IN WSS-VARI   
               MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB  
               PERFORM BUS-TAB                         
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.
           IF GDG-TIP-CGTA IN ALZ-FLD > SPACES                          
               MOVE 'TAB'                   TO TAB-COD-SIST             
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB      
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB      
               MOVE GDG-TIP-CGTA IN ALZ-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                 
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.                 
           MOVE WSS-GLS-CGTA TO CPT-STRN.                               
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-CGTA IN ALZ-FLD.                    
      *>>>>
*% END
*% IF FIN_GDG_STP_CGTA
      *<<<< FIN_GDG_STP_CGTA
           IF GDG-STP-CGTA IN ALZ-FLD > SPACES                          
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB'  TO TAB-COD-SIST                                  
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB                           
           MOVE GDG-TIP-CGTA IN ALZ-FLD  TO WSS-TIP-CGTA IN WSS-VARI    
           MOVE GDG-STP-CGTA IN ALZ-FLD  TO WSS-STP-CGTA IN WSS-VARI    
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB     
           PERFORM VAL-COD                                              
           IF MSG-COD-MENS NOT = SPACES                                 
              MOVE SPACES TO FRM-GLS-CGTA IN ALZ-FLD                    
                GO TO FIN-VAL-GDG-STP-CGTA.               
           MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI.    
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.         
           MOVE SPACES                  TO TAB-COD-CTAB IN TAB.         
           MOVE GDG-TIP-CGTA IN ALZ-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOPE IN WSS-VARI     
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
           MOVE WSS-GLS-CGTA TO CPT-STRN.                               
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-CGTA IN ALZ-FLD.         
      *>>>>
*% END
*% IF FIN_ALZ_IND_TALZ
      *<<<< FIN_VAL_ALZ_IND_TALZ
           IF ALZ-IND-TALZ IN ALZ-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-ALZ-IND-TALZ.      
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'TAL ' TO TAB-COD-TTAB IN TAB.                          
           MOVE ALZ-IND-TALZ IN ALZ-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              ALZ-IND-TALZ IN ALZ-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-TALZ IN ALZ-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-TALZ IN ALZ-FLD.   
      *>>>>
*% END
*% IF INI_ALZ_NUM_CORR
*% IF PGM_BQ
      *    IF ALZ-NUM-CORR IN ALZ-FLD = ZEROES
      *         PERFORM ERR-GLS
      *         GO TO FIN-VAL-ALZ-NUM-CORR.
*% END
      *<<<< INI_VAL_ALZ_NUM_CORR
           IF ALZ-NUM-CORR IN ALZ-FLD = ZEROES                         
              GO TO FIN-VAL-ALZ-NUM-CORR.
      *>>>>
*% END
*% IF INI_ALZ_GLS_ICLI
      *<<<< INI_VAL_ALZ_GLS_ICLI
           IF ALZ-GLS-ICLI IN ALZ-FLD NOT > IDC-INIC-GLS                
              MOVE IDC-INIC-GLS TO ALZ-GLS-ICLI IN ALZ-FLD.             
           GO TO FIN-VAL-ALZ-GLS-ICLI.
      *>>>>
*% END
*% IF FIN_ALZ_COD_ABGD
      *<<<< FIN_VAL_ALZ_COD_ABGD
         IF SCR-CMND = 'MGA'                                          
      *VAL-COD Valida codigo de tabla                                   
             MOVE 'TAB' TO TAB-COD-SIST                                 
             MOVE 'ABG ' TO TAB-COD-TTAB IN TAB                         
             MOVE ALZ-COD-ABGD IN ALZ-FLD TO TAB-COD-CTAB IN TAB        
             PERFORM VAL-COD          
             IF MSG-COD-MENS = 'COD    NEX' OR                          
                ALZ-COD-ABGD IN ALZ-FLD NOT > SPACES                    
                MOVE SPACES TO FRM-GLS-ABGD IN ALZ-FLD                  
             ELSE                                                       
                 MOVE TAB-GLS-DESC IN TAB TO                            
                    FRM-GLS-ABGD IN ALZ-FLD.     
      *>>>>
*% END
*% IF FIN_ALZ_IND_TASA
      *<<<< FIN_VAL_ALZ_IND_TASA
          IF ALZ-IND-TALZ IN ALZ-FLD = 'P'                             
           IF ALZ-IND-TASA IN ALZ-FLD NOT > SPACES                      
                 PERFORM ERR-GLS                                        
                 GO TO FIN-VAL-ALZ-IND-TASA.                            
           IF ALZ-IND-TALZ IN ALZ-FLD = 'P' AND                         
              ALZ-IND-TASA IN ALZ-FLD NOT = 'S'                
                MOVE 'BGL'            TO MSG-COD-SIST 
                MOVE 'ACEP SOLO  S'   TO MSG-COD-MENS                   
                PERFORM GET-MSG   
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR.                          
           IF ALZ-IND-TALZ IN ALZ-FLD = 'G' AND                         
              ALZ-IND-TASA IN ALZ-FLD  > SPACES                         
              MOVE SPACES TO ALZ-IND-TASA IN ALZ-FLD.                     
      *>>>>
*% END
*% IF FIN_ALZ_IND_ITRA
      *<<<< FIN_VAL_ALZ_IND_ITRA
           IF ALZ-IND-ITRA IN ALZ-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-ALZ-IND-ITRA.                               
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'ITR ' TO TAB-COD-TTAB IN TAB.                          
           MOVE ALZ-IND-ITRA IN ALZ-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
      *>>>>
*% END
*% IF FIN_ALZ_IND_APRC
      *<<<< FIN_VAL_ALZ_IND_APRC
           IF ALZ-IND-APRC IN ALZ-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-ALZ-IND-APRC.                               
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'APC ' TO TAB-COD-TTAB IN TAB.                          
           MOVE ALZ-IND-APRC IN ALZ-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.     
      *>>>>
*% END
*% IF FIN_ALZ_GLS_CMTE
      *<<<< FIN_VAL_ALZ_GLS_CMTE
            IF SCR-CMND = 'MOD' AND                                     
               NOT( ALZ-GLS-CMTE IN ALZ-FLD = 'ACEPTA' OR  
               ALZ-GLS-CMTE IN ALZ-FLD = 'RECHAZO')           
               MOVE 'BGL'            TO MSG-COD-SIST      
               MOVE 'ACEPTARECHAZO'  TO MSG-COD-MENS    
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS    
               MOVE FRM-SUAR-MAL TO FRM-SUAR.   
      *>>>>
*% END
*% IF FIN_ALZ_NUM_ESTA
      *<<<< FIN_VAL_ALZ_NUM_ESTA
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'EDO ' TO TAB-COD-TTAB IN TAB.                          
           MOVE ALZ-NUM-ESTA IN ALZ-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              ALZ-NUM-ESTA IN ALZ-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-ESTA IN ALZ-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-ESTA IN ALZ-FLD.       
      *>>>>
*% END
*% IF FIN_ALZ_NUM_ICLI
      *<<<< FIN_VAL_ALZ_NUM_ICLI
           IF ALZ-NUM-ICLI IN ALZ-FLD > SPACES                          
              MOVE ALZ-NUM-ICLI IN ALZ-FLD TO DBC-NUM-ICLI IN DBC       
              MOVE ALZ-VRF-ICLI IN ALZ-FLD TO DBC-VRF-ICLI IN DBC       
              MOVE SPACES                  TO DBC-IND-ICLI IN DBC       
              MOVE SPACES                  TO DBC-GLS-ICLI IN DBC       
              MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM SGC-FIO-DBC                                       
              IF FIO-STAT-OKS                                           
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                   
                 PERFORM CPT-BLKS                                       
                 MOVE CPT-STRN TO FRM-GLS-NALZ IN ALZ-FLD.            
      *>>>>
*% END
*% IF FIN_ALZ_GLS_MCAN
      *<<<< FIN_VAL_ALZ_GLS_MCAN
           IF SCR-CMND = 'CAN'                                          
              IF ALZ-GLS-MCAN IN ALZ-FLD NOT > SPACES                   
                 PERFORM ERR-GLS                                        
                 GO TO FIN-VAL-ALZ-GLS-MCAN.       
      *>>>>
*% END
*% IF INI_ALZ_NUM_ITSN
           IF ALZ-NUM-ITSN IN ALZ-FLD NOT > ZEROES
              MOVE ZEROES TO ALZ-NUM-ITSN IN ALZ-FLD.
*% END
*% IF FIN_ALZ_NUM_ITSN
      *<<<< FIN_VAL_ALZ_NUM_ITSN
           IF ALZ-IND-TALZ IN ALZ-FLD = 'P'                             
            IF ALZ-NUM-ITSN IN ALZ-FLD NOT > ZEROES                     
               MOVE ALZ-CAI-GTIA IN ALZ-FLD TO GVT-CAI-GTIA IN GVT      
               MOVE ALZ-IIC-GTIA IN ALZ-FLD TO GVT-IIC-GTIA IN GVT      
               MOVE 999                     TO GVT-COD-TASN IN GVT      
               MOVE FIO-GET-LEQ TO FIO-CMND                             
               PERFORM BGL-FIO-GVT                                      
               IF FIO-STAT-OKS AND                                      
                  ALZ-CAI-GTIA IN ALZ-FLD = GVT-CAI-GTIA IN GVT AND     
                  ALZ-IIC-GTIA IN ALZ-FLD = GVT-IIC-GTIA IN GVT         
                   MOVE GVT-COD-TASN IN GVT TO ALZ-NUM-ITSN IN ALZ-FLD  
               ELSE                                                     
                   PERFORM ERR-GLS                                      
                   GO TO FIN-VAL-ALZ-NUM-ITSN.                          
           IF ALZ-IND-TALZ IN ALZ-FLD = 'G' AND                         
               ALZ-NUM-ITSN IN ALZ-FLD  > ZEROES                         
               MOVE ZEROES TO ALZ-NUM-ITSN IN ALZ-FLD.                   
           IF ALZ-NUM-ITSN IN ALZ-FLD > ZEROES                          
               MOVE ALZ-CAI-GTIA IN ALZ-FLD TO GVT-CAI-GTIA IN GVT      
               MOVE ALZ-IIC-GTIA IN ALZ-FLD TO GVT-IIC-GTIA IN GVT      
               MOVE ALZ-NUM-ITSN IN ALZ-FLD TO GVT-COD-TASN IN GVT      
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GVT                                      
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'BGL'            TO MSG-COD-SIST                
                   MOVE 'GVT    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
      *>>>>
*% END
*% IF INI_ALZ_COD_ITSN
           IF ALZ-COD-ITSN IN ALZ-FLD NOT > ZEROES
              MOVE ZEROES TO ALZ-COD-ITSN IN ALZ-FLD.
*% END
*% IF FIN_ALZ_COD_ITSN
      *<<<< FIN_VAL_ALZ_COD_ITSN
           IF ALZ-IND-TALZ IN ALZ-FLD = 'P'                             
            IF ALZ-COD-ITSN IN ALZ-FLD NOT > ZEROES                     
                 PERFORM ERR-GLS                                        
                 GO TO FIN-VAL-ALZ-COD-ITSN.                            
           IF ALZ-IND-TALZ IN ALZ-FLD = 'G' AND                         
              ALZ-COD-ITSN IN ALZ-FLD  > ZEROES                         
              MOVE ZEROES TO ALZ-COD-ITSN IN ALZ-FLD.                   
           IF ALZ-COD-ITSN IN ALZ-FLD > ZEROES                          
               MOVE ALZ-CAI-GTIA IN ALZ-FLD TO GTP-CAI-GTIA IN GTP      
               MOVE ALZ-IIC-GTIA IN ALZ-FLD TO GTP-IIC-GTIA IN GTP      
               MOVE ALZ-NUM-ITSN IN ALZ-FLD TO GTP-NUM-ITSN IN GTP      
               MOVE ALZ-COD-ITSN IN ALZ-FLD TO GTP-COD-ITSN IN GTP      
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GTP                                      
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'BGL'            TO MSG-COD-SIST                
                   MOVE 'GTP    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
      *>>>>
*% END
