*% IF FIN_PUT_DBC_GBN
      *<<<<
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                        
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-NOMC IN GBN-FLD.                    
      *>>>>
*% END
*% IF FIN_PUT_GDG_GBN
      *<<<<
      *                                                                 
           MOVE GDG-CAI-GTIA IN GDG TO GDG-CAI-GTIA IN GBN-FLD.         
           MOVE GDG-IIC-GTIA IN GDG TO GDG-IIC-GTIA IN GBN-FLD.         
           MOVE GDG-GLS-DGTA IN GDG TO FRM-GLS-DGTA IN GBN-FLD.         
           MOVE GDG-COD-CGTA IN GDG TO FRM-COD-CGTA IN GBN-FLD.         
           MOVE 'TAB'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'AUX '              TO TAB-COD-TTAB IN TAB.             
           MOVE GDG-TIP-CGTA IN GDG TO WSS-TIP-CGTA.                    
           MOVE GDG-STP-CGTA IN GDG TO WSS-STP-CGTA.                    
           MOVE WSS-COD-CGTA        TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-SOPE.                    
                                                                        
           MOVE 'TAB'                   TO TAB-COD-SIST FIO-SIST.       
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.         
           MOVE SPACES                  TO TAB-COD-CTAB IN TAB.         
           MOVE GDG-TIP-CGTA IN GDG     TO TAB-COD-CTAB IN TAB.         
           PERFORM BUS-TAB                                              
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-GLS-DESC IN TAB  TO WSS-GLS-TOPE.                   
                                                                        
           MOVE WSS-GLS-CGTA TO CPT-STRN.                               
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GBN-FLD.                    
                                                                        
      *VALIDA CODIGO ESTADO BCI                                         
           MOVE GDG-IND-EST1 IN GDG TO FRM-IND-EST1 IN GBN-FLD.         
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'ES1 '              TO TAB-COD-TTAB IN TAB              
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.             
           MOVE GDG-IND-EST1 IN GDG TO TAB-COD-CTAB.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS)                                            
               MOVE GDG-IND-EST1 IN GDG TO FRM-IND-EST1 IN GBN-FLD      
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-EST1 IN GBN-FLD      
           ELSE                                                         
               MOVE SPACES              TO FRM-IND-EST1 IN GBN-FLD      
               MOVE SPACES              TO FRM-GLS-EST1 IN GBN-FLD      
               MOVE SPACES              TO FRM-IND-ESTN IN GBN-FLD      
               MOVE SPACES              TO FRM-GLS-ESTN IN GBN-FLD      
               GO TO VAL-INSTANCIA.                                     
                                                                        
      *VALIDA CODIGO ESTADO NOVA                                        
           IF (FIO-STAT-OKS  AND                                        
              (GDG-IND-EST1 IN GDG = '05'  OR                           
               (GDG-MSC-STAT IN GDG = 'A' AND                           
               (GDG-IND-EST1 IN GDG = '07' OR                           
                GDG-IND-EST1 IN GDG = '22' OR                           
                GDG-IND-EST1 IN GDG = '20' OR                           
                (GDG-IND-EST1 IN GDG > '09' AND                         
                 GDG-IND-EST1 IN GDG < '20')))))                        
               MOVE TAB-GLS-DAT1 IN TAB TO FRM-IND-ESTN IN GBN-FLD      
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESTN IN GBN-FLD      
               GO TO VAL-INSTANCIA                                      
           ELSE                                                         
               MOVE SPACES              TO FRM-IND-ESTN IN GBN-FLD      
               MOVE SPACES              TO FRM-GLS-ESTN IN GBN-FLD      
               GO TO VAL-INSTANCIA.                                     
                                                                        
                                                                        
       VAL-INSTANCIA.                                                   
           MOVE GDG-FEC-FFES IN GDG TO FRM-FEC-FEST IN GBN-FLD.         
           MOVE 'BGL' TO TAB-COD-SIST FIO-SIST.                         
           MOVE 'INS'  TO TAB-COD-TTAB IN TAB.                          
           MOVE GDG-COD-INST IN GBN-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS)                                            
               MOVE GDG-COD-INST IN GDG TO GDG-COD-INST IN GBN-FLD      
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-INST IN GBN-FLD      
           ELSE                                                         
               MOVE ZEROES              TO GDG-COD-INST IN GBN-FLD      
               MOVE SPACES              TO FRM-GLS-INST IN GBN-FLD.     
                                                                        
      *VALIDA INDICADOR NUEVO USADO                                     
           MOVE 'BGL' TO TAB-COD-SIST FIO-SIST.                         
           MOVE 'CGT' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-IND-NUSA IN GBN-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS)                                            
               MOVE GDG-IND-NUSA IN GDG TO                              
                    GDG-IND-NUSA IN GBN-FLD                            
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-NUSA IN GBN-FLD                             
           ELSE                                                         
               MOVE SPACES  TO  GDG-IND-NUSA IN GBN-FLD                 
               MOVE SPACES  TO  FRM-GLS-NUSA IN GBN-FLD.                
                                                                        
      *VALIDA CODIGO COBERTURA                                          
           MOVE 'BGL'                  TO TAB-COD-SIST FIO-SIST.        
           MOVE 'LIM'                  TO TAB-COD-TTAB IN TAB.          
           MOVE GDG-COD-LGTA IN GDG    TO TAB-COD-CTAB IN TAB.          
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS AND TAB-GLS-DAT1 > SPACES)                  
               MOVE TAB-GLS-DAT1 IN TAB TO                              
                    FRM-COD-LGTA IN GBN-FLD                             
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-LGTA IN GBN-FLD                             
           ELSE                                                         
               MOVE SPACES  TO  FRM-COD-LGTA IN GBN-FLD                 
               MOVE SPACES  TO  FRM-GLS-LGTA IN GBN-FLD.                
                                                                        
      *VALIDA TIPO GARANTIA NOVA                                        
           MOVE 'TAB'                  TO CNS-COD-SIST IN CNS-VARI.     
           MOVE 'AUX'                  TO CNS-CIC-TTAB IN CNS-VARI.     
           MOVE GDG-COD-CGTA IN GDG    TO CNS-COD-CBCI IN CNS-VARI.     
                                                                        
           PERFORM BUS-TAB-BVC.                                         
           IF (MSG-COD-MENS IN MSG > SPACES)                            
                MOVE SPACES              TO FRM-GLS-CGTN IN GBN-FLD     
                MOVE SPACES              TO FRM-IND-CGTA IN GBN-FLD     
           ELSE                                                         
                MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CGTN IN GBN-FLD     
                MOVE CNS-COD-CTAB        TO FRM-IND-CGTA IN GBN-FLD.    
                                                                        
      *BUSCA COMUNA NOVA                                                
       VAL-COMUNA.                                                      
           MOVE GDG-CIC-GTIA IN GDG TO GUB-CIC-GTIA IN GUB.             
           MOVE FIO-GET-KEY        TO FIO-CMND.                         
           PERFORM BGL-FIO-GUB.                                         
                                                                        
           IF (NOT FIO-STAT-OKS )                                       
                MOVE SPACES           TO FRM-COD-COMU IN GBN-FLD        
                MOVE SPACES           TO FRM-GLS-COMU IN GBN-FLD        
                GO TO VAL-CONSTRUCCION.                                 
                                                                        
           MOVE 'TAB'                  TO CNS-COD-SIST IN CNS-VARI.     
           MOVE 'COM'                  TO CNS-CIC-TTAB IN CNS-VARI.     
           MOVE GUB-COD-COMU IN GUB    TO CNS-COD-CBCI IN CNS-VARI.     
                                                                        
           PERFORM BUS-TAB-BVC.                                         
           IF (MSG-COD-MENS IN MSG > SPACES)                            
                MOVE SPACES              TO FRM-COD-COMU IN GBN-FLD     
                MOVE SPACES              TO FRM-GLS-COMU IN GBN-FLD     
           ELSE                                                         
                MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-COMU IN GBN-FLD     
                MOVE CNS-COD-CTAB        TO FRM-COD-COMU IN GBN-FLD.    
                                                                        
       VAL-CONSTRUCCION.                                                
           MOVE GDG-CIC-GTIA IN GDG TO GIM-CIC-GTIA IN GIM.             
           MOVE FIO-GET-KEY        TO FIO-CMND.                         
           PERFORM BGL-FIO-GIM.                                         
                                                                        
           IF (NOT FIO-STAT-OKS )                                       
                MOVE SPACES           TO FRM-COD-TCNS IN GBN-FLD        
                MOVE SPACES           TO FRM-GLS-TCNS IN GBN-FLD        
                GO TO VAL-SEGURO.                                       
                                                                        
                                                                        
           MOVE 'BGL'                  TO CNS-COD-SIST IN CNS-VARI.     
           MOVE 'CTR'                  TO CNS-CIC-TTAB IN CNS-VARI.     
           MOVE GIM-COD-TCNS IN GIM    TO CNS-COD-CBCI IN CNS-VARI.     
                                                                        
           PERFORM BUS-TAB-BVC.                                         
           IF (MSG-COD-MENS IN MSG > SPACES)                            
                MOVE SPACES              TO FRM-COD-TCNS IN GBN-FLD     
                MOVE SPACES              TO FRM-GLS-TCNS IN GBN-FLD     
           ELSE                                                         
                MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TCNS IN GBN-FLD     
                MOVE CNS-COD-CTAB        TO FRM-COD-TCNS IN GBN-FLD.    
                                                                        
       VAL-SEGURO.                                                      
           IF (GSE-IND-SEG IN GSE = 'T')                                
               MOVE GSE-NUM-IGSE IN GSE    TO GSE-NUM-IGSE IN GBN-FLD   
               MOVE ZEROES                 TO FRM-NUM-IGSE IN GBN-FLD   
               MOVE 'TAB'                  TO CNS-COD-SIST IN CNS-VARI  
               MOVE 'CSE'                  TO CNS-CIC-TTAB IN CNS-VARI  
               MOVE GSE-COD-ICCS IN GSE    TO CNS-COD-CBCI IN CNS-VARI  
                                                                        
               PERFORM BUS-TAB-BVC.                                     
               IF (MSG-COD-MENS IN MSG > SPACES)                        
                   MOVE SPACES              TO FRM-COD-ICCS IN GBN-FLD  
                   MOVE SPACES              TO FRM-GLS-ICCS IN GBN-FLD  
               ELSE                                                     
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ICCS IN GBN-FLD  
                   MOVE CNS-COD-CTAB        TO FRM-COD-ICCS IN GBN-FLD. 
                                                                        
           IF (GSE-IND-SEG IN GSE = 'C')                                
                MOVE GSE-NUM-IGSE IN GSE TO FRM-NUM-IGSE IN GBN-FLD     
                MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE         
                MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE         
                COMPUTE GSE-NUM-IGSE IN GSE = GSE-NUM-IGSE IN GSE - 1   
                MOVE GSE-NUM-IGSE IN GSE    TO GSE-NUM-IGSE IN GBN-FLD  
                MOVE FIO-GET-KEY TO FIO-CMND                            
                PERFORM BGL-FIO-GSE                                     
                MOVE 'TAB'               TO CNS-COD-SIST IN CNS-VARI    
                MOVE 'CSE'               TO CNS-CIC-TTAB IN CNS-VARI    
                MOVE GSE-COD-ICCS IN GSE TO CNS-COD-CBCI IN CNS-VARI    
                                                                        
                PERFORM BUS-TAB-BVC                                     
                IF (MSG-COD-MENS IN MSG > SPACES)                       
                    MOVE SPACES          TO FRM-COD-ICCS IN GBN-FLD     
                    MOVE SPACES          TO FRM-GLS-ICCS IN GBN-FLD     
               ELSE                                                     
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ICCS IN GBN-FLD  
                   MOVE CNS-COD-CTAB     TO FRM-COD-ICCS IN GBN-FLD.    
                                                                        
           IF (GSE-IND-SEG IN GSE NOT = 'C' AND                         
               GSE-IND-SEG IN GSE NOT = 'T')                            
               MOVE SPACES              TO FRM-COD-ICCS IN GBN-FLD      
               MOVE SPACES              TO FRM-GLS-ICCS IN GBN-FLD      
               MOVE ZEROES              TO GSE-NUM-IGSE IN GBN-FLD      
               MOVE ZEROES              TO FRM-NUM-IGSE IN GBN-FLD.     
                                                                        
      *>>>>
*% END
*% IF GDG_COD_INST
      *<<<<
           IF GDG-COD-INST IN GBN-FLD NOT > SPACES                      
               MOVE ZEROES TO GDG-COD-INST IN GBN-FLD.                  
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'INS'  TO TAB-COD-TTAB IN TAB.                          
           MOVE GDG-COD-INST IN GBN-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              GDG-COD-INST IN GBN-FLD NOT > ZEROES                      
               MOVE SPACES TO FRM-GLS-INST IN GBN-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-INST IN GBN-FLD.                            
      *>>>>
*% END
*% IF GDG_IND_NUSA
      *<<<<
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'CGT' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-IND-NUSA IN GBN-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              GDG-IND-NUSA IN GBN-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-NUSA IN GBN-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-NUSA IN GBN-FLD.                            
      *>>>>
*% END
*% IF FIN_RET_DBC_GBN
      *<<<<
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL             
           MOVE DBC-NUM-ICLI IN GBN-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE DBC-VRF-ICLI IN GBN-FLD TO DBC-VRF-ICLI IN DBC.         
           MOVE DBC-IND-ICLI IN GBN-FLD TO DBC-IND-ICLI IN DBC.         
           MOVE DBC-GLS-ICLI IN GBN-FLD TO DBC-GLS-ICLI IN DBC.         
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL             
      *>>>>
*% END
