      *
      * BGLBUSEG
      * Version 3.0.1 Nov-2005
      * 16-Jan-19 02:14 PM
      *

       SET-TAG-BGLBUSEG SECTION.
       INI-SET-TAG-BGLBUSEG.
           MOVE
           '<IDNMOD NOM=$BGLBUSEG$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$16-Jan-19 02:14 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUSEG.
           EXIT.
           
       RET-ALL-SEG SECTION.
       INI-RET-ALL-SEG.

           PERFORM KEY-ALL-SEG.
           PERFORM RET-POL-SEG.
           PERFORM RET-GDG-SEG.
           PERFORM RET-DBC-SEG.

       FIN-RET-ALL-SEG.
           EXIT.
       
       RET-POL-SEG SECTION.
       INI-RET-POL-SEG.

           MOVE POL-COD-ESGE IN SEG-FLD TO POL-COD-ESGE IN POL.
           MOVE POL-COD-SEGU IN SEG-FLD TO POL-COD-SEGU IN POL.
           MOVE POL-GLS-MEST IN SEG-FLD TO POL-GLS-MEST IN POL.
           MOVE POL-GLS-REAN IN SEG-FLD TO POL-GLS-REAN IN POL.
           MOVE POL-GLS-RAMO IN SEG-FLD TO POL-GLS-RAMO IN POL.
           MOVE POL-COD-PLZA IN SEG-FLD TO POL-COD-PLZA IN POL.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE POL-NUM-DVPL IN SEG-FLD TO POL-NUM-DVPL IN POL.
           MOVE POL-NUM-MVPL IN SEG-FLD TO POL-NUM-MVPL IN POL.
           MOVE POL-NUM-SVPL IN SEG-FLD TO POL-NUM-SVPL IN POL.
           MOVE POL-NUM-AVPL IN SEG-FLD TO POL-NUM-AVPL IN POL.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE POL-NUM-DTPL IN SEG-FLD TO POL-NUM-DTPL IN POL.
           MOVE POL-NUM-MTPL IN SEG-FLD TO POL-NUM-MTPL IN POL.
           MOVE POL-NUM-STPL IN SEG-FLD TO POL-NUM-STPL IN POL.
           MOVE POL-NUM-ATPL IN SEG-FLD TO POL-NUM-ATPL IN POL.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE POL-COD-VCAM IN SEG-FLD TO POL-COD-VCAM IN POL.
           MOVE POL-VAL-PRIN IN SEG-FLD TO POL-VAL-PRIN IN POL.
           MOVE POL-VAL-PRIB IN SEG-FLD TO POL-VAL-PRIB IN POL.
           MOVE POL-NUM-ENDS IN SEG-FLD TO POL-NUM-ENDS IN POL.
           MOVE POL-COD-EPRO IN SEG-FLD TO POL-COD-EPRO IN POL.

       FIN-RET-POL-SEG.
           EXIT.
       
       RET-GDG-SEG SECTION.
       INI-RET-GDG-SEG.

           MOVE GDG-TIP-CGTA IN SEG-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN SEG-FLD TO GDG-STP-CGTA IN GDG.

       FIN-RET-GDG-SEG.
           EXIT.
       
       RET-DBC-SEG SECTION.
       INI-RET-DBC-SEG.

      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN SEG-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN SEG-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN SEG-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN SEG-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-GLS-NOMC IN SEG-FLD TO DBC-GLS-NOMC IN DBC.

       FIN-RET-DBC-SEG.
           EXIT.
       
       KEY-ALL-SEG SECTION.
       INI-KEY-ALL-SEG.

           PERFORM KEY-POL-SEG.
           PERFORM KEY-GDG-SEG.
           PERFORM KEY-DBC-SEG.

       FIN-KEY-ALL-SEG.
           EXIT.
       
       KEY-POL-SEG SECTION.
       INI-KEY-POL-SEG.

           MOVE POL-CAI-GTIA IN SEG-FLD TO POL-CAI-GTIA IN POL.
           MOVE POL-IIC-GTIA IN SEG-FLD TO POL-IIC-GTIA IN POL.

      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE'                                          
              MOVE POL-CAI-GTIA IN SEG-FLD TO POL-CAI-GTIA IN POL       
              MOVE POL-IIC-GTIA IN SEG-FLD TO POL-IIC-GTIA IN POL       
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM BGL-FIO-POL                                       
              IF FIO-STAT-OKS                                           
                 PERFORM ERR-GLS.                                       
      *MAE                                                           
                                                                        
      *>>>>
       FIN-KEY-POL-SEG.
           EXIT.
       
       KEY-GDG-SEG SECTION.
       INI-KEY-GDG-SEG.


       FIN-KEY-GDG-SEG.
           EXIT.
       
       KEY-DBC-SEG SECTION.
       INI-KEY-DBC-SEG.


       FIN-KEY-DBC-SEG.
           EXIT.
       
       SCR-CLRA-SEG SECTION.
       INI-SCR-CLRA-SEG.

           PERFORM CLR-KEY-SEG.
           PERFORM CLR-FLD-SEG.

       FIN-SCR-CLRA-SEG.
           EXIT.
       
       CLR-KEY-SEG SECTION.
       INI-CLR-KEY-SEG.

           MOVE SPACES TO POL-CAI-GTIA IN SEG-FLD.
           MOVE ZEROES TO POL-IIC-GTIA IN SEG-FLD.

       FIN-CLR-KEY-SEG.
           EXIT.
       
       CLR-FLD-SEG SECTION.
       INI-CLR-FLD-SEG.

           MOVE SPACES TO FRM-GLS-CGTA IN SEG-FLD.
           MOVE SPACES TO FRM-GLS-ESGE IN SEG-FLD.
           MOVE SPACES TO FRM-GLS-SEGU IN SEG-FLD.
           MOVE SPACES TO FRM-GLS-REAN IN SEG-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN SEG-FLD.
           MOVE SPACES TO FRM-GLS-EPRO IN SEG-FLD.
           PERFORM CLR-POL-SEG.
           PERFORM CLR-GDG-SEG.
           PERFORM CLR-DBC-SEG.

       FIN-CLR-FLD-SEG.
           EXIT.
       
       CLR-POL-SEG SECTION.
       INI-CLR-POL-SEG.

           MOVE SPACES TO POL-COD-ESGE IN SEG-FLD.
           MOVE SPACES TO POL-COD-SEGU IN SEG-FLD.
           MOVE SPACES TO POL-GLS-MEST IN SEG-FLD.
           MOVE SPACES TO POL-GLS-REAN IN SEG-FLD.
           MOVE SPACES TO POL-GLS-RAMO IN SEG-FLD.
           MOVE SPACES TO POL-COD-PLZA IN SEG-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO POL-FEC-FVPL IN SEG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO POL-FEC-FTPL IN SEG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO POL-COD-VCAM IN SEG-FLD.
           MOVE ZEROES TO POL-VAL-PRIN IN SEG-FLD.
           MOVE ZEROES TO POL-VAL-PRIB IN SEG-FLD.
           MOVE ZEROES TO POL-NUM-ENDS IN SEG-FLD.
           MOVE SPACES TO POL-COD-EPRO IN SEG-FLD.

       FIN-CLR-POL-SEG.
           EXIT.
       
       CLR-GDG-SEG SECTION.
       INI-CLR-GDG-SEG.

           MOVE SPACES TO GDG-TIP-CGTA IN SEG-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN SEG-FLD.

       FIN-CLR-GDG-SEG.
           EXIT.
       
       CLR-DBC-SEG SECTION.
       INI-CLR-DBC-SEG.

      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN SEG-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN SEG-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN SEG-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN SEG-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO DBC-GLS-NOMC IN SEG-FLD.

       FIN-CLR-DBC-SEG.
           EXIT.
       
       FST-KEY-SEG SECTION.
       INI-FST-KEY-SEG.

           MOVE -1 TO POL-CAI-GTIA-LEN IN SEG-FLD.

       FIN-FST-KEY-SEG.
           EXIT.
       
       FST-FLD-SEG SECTION.
       INI-FST-FLD-SEG.

           MOVE -1 TO POL-COD-ESGE-LEN IN SEG-FLD.

       FIN-FST-FLD-SEG.
           EXIT.
       
       PRO-KEY-SEG SECTION.
       INI-PRO-KEY-SEG.

           PERFORM PRO-MKY-SEG.

       FIN-PRO-KEY-SEG.
           EXIT.
       
       PRO-MKY-SEG SECTION.
       INI-PRO-MKY-SEG.


       FIN-PRO-MKY-SEG.
           EXIT.
       
       PRO-FLD-SEG SECTION.
       INI-PRO-FLD-SEG.

           PERFORM PRO-POL-SEG.
           PERFORM PRO-GDG-SEG.
           PERFORM PRO-DBC-SEG.

       FIN-PRO-FLD-SEG.
           EXIT.
       
       PRO-POL-SEG SECTION.
       INI-PRO-POL-SEG.

           MOVE FRM-CPIM-AEY TO POL-COD-ESGE-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-COD-SEGU-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-GLS-MEST-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-GLS-REAN-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-COD-PLZA-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-FEC-FVPL-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-FEC-FTPL-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-COD-VCAM-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-VAL-PRIN-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-VAL-PRIB-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-NUM-ENDS-ATR IN SEG-FLD.
           MOVE FRM-CPIM-AEY TO POL-COD-EPRO-ATR IN SEG-FLD.

       FIN-PRO-POL-SEG.
           EXIT.
       
       PRO-GDG-SEG SECTION.
       INI-PRO-GDG-SEG.


       FIN-PRO-GDG-SEG.
           EXIT.
       
       PRO-DBC-SEG SECTION.
       INI-PRO-DBC-SEG.


       FIN-PRO-DBC-SEG.
           EXIT.
       
       UNP-KEY-SEG SECTION.
       INI-UNP-KEY-SEG.

           PERFORM UNP-IKY-SEG.
           PERFORM UNP-AKY-SEG.
           PERFORM UNP-MKY-SEG.

       FIN-UNP-KEY-SEG.
           EXIT.
       
       UNP-IKY-SEG SECTION.
       INI-UNP-IKY-SEG.

           MOVE FRM-CPIM-UBY TO POL-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO POL-IIC-GTIA-ATR.

       FIN-UNP-IKY-SEG.
           EXIT.
       
       UNP-MKY-SEG SECTION.
       INI-UNP-MKY-SEG.


       FIN-UNP-MKY-SEG.
           EXIT.
       
       UNP-AKY-SEG SECTION.
       INI-UNP-AKY-SEG.


       FIN-UNP-AKY-SEG.
           EXIT.
       
       UNP-FLD-SEG SECTION.
       INI-UNP-FLD-SEG.

           PERFORM UNP-POL-SEG.
           PERFORM UNP-GDG-SEG.
           PERFORM UNP-DBC-SEG.

       FIN-UNP-FLD-SEG.
           EXIT.
       
       UNP-POL-SEG SECTION.
       INI-UNP-POL-SEG.

           MOVE FRM-CPIM-UBY TO POL-COD-ESGE-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-COD-SEGU-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-GLS-MEST-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-GLS-REAN-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-COD-PLZA-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-FEC-FVPL-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-FEC-FTPL-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-COD-VCAM-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-VAL-PRIN-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-VAL-PRIB-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-NUM-ENDS-ATR IN SEG-FLD.
           MOVE FRM-CPIM-UBY TO POL-COD-EPRO-ATR IN SEG-FLD.

       FIN-UNP-POL-SEG.
           EXIT.
       
       UNP-GDG-SEG SECTION.
       INI-UNP-GDG-SEG.


       FIN-UNP-GDG-SEG.
           EXIT.
       
       UNP-DBC-SEG SECTION.
       INI-UNP-DBC-SEG.


       FIN-UNP-DBC-SEG.
           EXIT.
       
       VAL-MKY-SEG SECTION.
       INI-VAL-MKY-SEG.


       FIN-VAL-MKY-SEG.
           EXIT.
       
       VAL-FLD-SEG SECTION.
       INI-VAL-FLD-SEG.

           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-TIP-CGTA-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-STP-CGTA-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-COD-ESGE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-COD-ESGE-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-FRM-GLS-ESGE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ESGE-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-COD-SEGU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-COD-SEGU-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-FRM-GLS-SEGU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SEGU-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-GLS-MEST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-GLS-MEST-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-GLS-REAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-GLS-REAN-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-FRM-GLS-REAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-REAN-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-GLS-RAMO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-GLS-RAMO-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-COD-PLZA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-COD-PLZA-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-POL-FEC-FVPL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                POL-FEC-FVPL-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-POL-FEC-FTPL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                POL-FEC-FTPL-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-POL-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-COD-VCAM-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-VAL-PRIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-VAL-PRIN-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-VAL-PRIB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-VAL-PRIB-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-NUM-ENDS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-NUM-ENDS-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-POL-COD-EPRO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POL-COD-EPRO-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.
           PERFORM VAL-FRM-GLS-EPRO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EPRO-LEN IN SEG-FLD
                GO TO FIN-VAL-FLD-SEG.

       FIN-VAL-FLD-SEG.
           EXIT.
       
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.



       FIN-VAL-GDG-TIP-CGTA.
           EXIT.
       
       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.



       FIN-VAL-GDG-STP-CGTA.
           EXIT.
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.



       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.



       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.

           IF DBC-VRF-ICLI IN SEG-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN SEG-FLD.


       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.

           IF DBC-IND-ICLI IN SEG-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN SEG-FLD.


       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.

      *<<<< INI_VAL_DBC_GLS_ICLI
           IF DBC-GLS-ICLI IN SEG-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN SEG-FLD.
           GO TO FIN-VAL-DBC-GLS-ICLI.
      *>>>>
           IF DBC-GLS-ICLI IN SEG-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN SEG-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN SEG-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN SEG-FLD.


       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.



       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-POL-COD-ESGE SECTION.
       INI-VAL-POL-COD-ESGE.

           IF POL-COD-ESGE IN SEG-FLD NOT > SPACES
              MOVE SPACES TO POL-COD-ESGE IN SEG-FLD.


      *<<<< FIN-VAL-POL-COD-ESGE
      *MAE                                                              
           IF SCR-CMND = 'INE' OR SCR-CMND = 'ING'                      
              MOVE '01'   TO POL-COD-ESGE IN SEG-FLD                    
              GO TO CON-VAL-COD.                                        
      *MAE                                                              
                                                                        
           MOVE POL-CAI-GTIA IN SEG-FLD TO POL-CAI-GTIA IN POL.         
           MOVE POL-IIC-GTIA IN SEG-FLD TO POL-IIC-GTIA IN POL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-POL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-VAL-POL-COD-ESGE.                               
                                                                        
           IF (POL-COD-ESGE IN SEG-FLD = '10' OR
               POL-COD-ESGE IN SEG-FLD = '20' OR
               POL-COD-ESGE IN SEG-FLD = '30' OR                         
               POL-COD-ESGE IN SEG-FLD = '40')                          
                MOVE 'BGL'            TO MSG-COD-SIST                   
                MOVE 'ERROR ESTADO'   TO MSG-COD-MENS                   
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR.                          
                                                                        
           IF POL-COD-ESGE IN POL = '11'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '11' OR                 
                      POL-COD-ESGE IN SEG-FLD = '12' OR                 
                      POL-COD-ESGE IN SEG-FLD = '21' OR                 
                      POL-COD-ESGE IN SEG-FLD = '50')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '12'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '12' OR                 
                      POL-COD-ESGE IN SEG-FLD = '11' OR                 
                      POL-COD-ESGE IN SEG-FLD = '50')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '21'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '21' OR                 
                      POL-COD-ESGE IN SEG-FLD = '12' OR                 
                      POL-COD-ESGE IN SEG-FLD = '31' OR                 
                      POL-COD-ESGE IN SEG-FLD = '13')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '31'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '31' OR                 
                      POL-COD-ESGE IN SEG-FLD = '41' OR                 
                      POL-COD-ESGE IN SEG-FLD = '42')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '41'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '41' OR                 
                      POL-COD-ESGE IN SEG-FLD = '42' OR                 
                      POL-COD-ESGE IN SEG-FLD = '53')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '42'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '42' OR                 
                      POL-COD-ESGE IN SEG-FLD = '41' OR                 
                      POL-COD-ESGE IN SEG-FLD = '50')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '53'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '53' OR                 
                      POL-COD-ESGE IN SEG-FLD = '51')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-ESGE IN POL = '13'                                
              IF NOT (POL-COD-ESGE IN SEG-FLD = '13' OR                 
                      POL-COD-ESGE IN SEG-FLD = '51')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
           
           IF (POL-COD-ESGE IN POL = '51' AND                          
               POL-COD-ESGE IN SEG-FLD NOT = '51')                     
                  MOVE 'BGL'            TO MSG-COD-SIST                
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                
                  PERFORM GET-MSG                                      
                  MOVE MSG-GLS-DESC TO FRM-MENS                        
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
                                                                       
           IF (POL-COD-ESGE IN POL = '50' AND                          
               POL-COD-ESGE IN SEG-FLD NOT = '50')                     
                  MOVE 'BGL'            TO MSG-COD-SIST                
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                
                  PERFORM GET-MSG                                      
                  MOVE MSG-GLS-DESC TO FRM-MENS                        
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
      *MAE                                                              
       CON-VAL-COD.                                                     
      *MAE                                                              
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'SPO ' TO TAB-COD-TTAB IN TAB.                          
           MOVE POL-COD-ESGE IN SEG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-ESGE IN SEG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-ESGE IN SEG-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-ESGE IN SEG-FLD.         

      *>>>>
       FIN-VAL-POL-COD-ESGE.
           EXIT.
       
       VAL-FRM-GLS-ESGE SECTION.
       INI-VAL-FRM-GLS-ESGE.



       FIN-VAL-FRM-GLS-ESGE.
           EXIT.
       
       VAL-POL-COD-SEGU SECTION.
       INI-VAL-POL-COD-SEGU.

           IF POL-COD-SEGU IN SEG-FLD NOT > SPACES
              MOVE SPACES TO POL-COD-SEGU IN SEG-FLD.


      *<<<< FIN-VAL-POL-COD-SEGU
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'RSE ' TO TAB-COD-TTAB IN TAB.                          
           MOVE POL-COD-SEGU IN SEG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-SEGU IN SEG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-SEGU IN SEG-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-SEGU IN SEG-FLD.               
      *>>>>
       FIN-VAL-POL-COD-SEGU.
           EXIT.
       
       VAL-FRM-GLS-SEGU SECTION.
       INI-VAL-FRM-GLS-SEGU.



       FIN-VAL-FRM-GLS-SEGU.
           EXIT.
       
       VAL-POL-GLS-MEST SECTION.
       INI-VAL-POL-GLS-MEST.

      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE'                                          
              MOVE SPACES TO POL-GLS-MEST IN SEG-FLD                    
              GO TO FIN-VAL-POL-GLS-MEST.                               
      *MAE                                                              
                                                                        
      *>>>>
           IF POL-GLS-MEST IN SEG-FLD NOT > SPACES
              MOVE SPACES TO POL-GLS-MEST IN SEG-FLD.


       FIN-VAL-POL-GLS-MEST.
           EXIT.
       
       VAL-POL-GLS-REAN SECTION.
       INI-VAL-POL-GLS-REAN.

      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE'                                          
              MOVE SPACES TO POL-GLS-REAN IN SEG-FLD                    
              GO TO FIN-VAL-POL-GLS-REAN.                               
      *MAE                                                              
      *>>>>
           IF POL-GLS-REAN IN SEG-FLD NOT > SPACES
              MOVE SPACES TO POL-GLS-REAN IN SEG-FLD.


       FIN-VAL-POL-GLS-REAN.
           EXIT.
       
       VAL-FRM-GLS-REAN SECTION.
       INI-VAL-FRM-GLS-REAN.



       FIN-VAL-FRM-GLS-REAN.
           EXIT.
       
       VAL-POL-GLS-RAMO SECTION.
       INI-VAL-POL-GLS-RAMO.

      *<<<<
      *MAE                                                              
           IF SCR-CMND NOT = 'INE'                                      
              GO TO FIN-VAL-POL-GLS-RAMO.                               
                                                                        
           MOVE POL-CAI-GTIA IN SEG-FLD TO GSE-CAI-GTIA IN GSE.         
           MOVE POL-IIC-GTIA IN SEG-FLD TO GSE-IIC-GTIA IN GSE.         
           MOVE 999                     TO GSE-NUM-IGSE IN GSE.         
           MOVE FIO-GET-LEQ             TO FIO-CMND.                    
           PERFORM BGL-FIO-GSE.                                         
           IF (NOT FIO-STAT-OKS   OR                                    
               POL-CAI-GTIA IN SEG-FLD NOT = GSE-CAI-GTIA IN GSE  OR    
               POL-IIC-GTIA IN SEG-FLD NOT = GSE-IIC-GTIA IN GSE)       
                MOVE SPACES TO POL-GLS-RAMO IN SEG-FLD                  
                GO TO FIN-VAL-POL-GLS-RAMO.                             
                                                                        
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'CBS ' TO TAB-COD-TTAB IN TAB.                          
           MOVE GSE-COD-COB1 IN GSE TO TAB-COD-CTAB IN TAB.             
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              GSE-COD-COB1 IN GSE NOT > SPACES                          
               MOVE FRM-SUAR-OKS TO FRM-SUAR                            
               MOVE SPACES TO MSG-COD-MENS                              
               MOVE SPACES TO POL-GLS-RAMO IN SEG-FLD                   
           ELSE                                                         
               MOVE FRM-SUAR-OKS TO FRM-SUAR                            
               MOVE TAB-GLS-DESC IN TAB TO                              
                    POL-GLS-RAMO IN SEG-FLD.                            
      *MAE                                                              
      *>>>>


       FIN-VAL-POL-GLS-RAMO.
           EXIT.
       
       VAL-POL-COD-PLZA SECTION.
       INI-VAL-POL-COD-PLZA.

      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND                                      
              POL-COD-PLZA IN SEG-FLD NOT > SPACES                      
              PERFORM ERR-GLS.                                          
      *MAE                                                              
      *>>>>
           IF POL-COD-PLZA IN SEG-FLD NOT > SPACES
              MOVE SPACES TO POL-COD-PLZA IN SEG-FLD.


       FIN-VAL-POL-COD-PLZA.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-POL-FEC-FVPL SECTION.
       INI-VAL-POL-FEC-FVPL.
           IF POL-FEC-FVPL IN SEG-FLD  NOT > ZEROES
              MOVE ZEROES TO POL-FEC-FVPL IN SEG-FLD.
      *VAL-FEC Validar Fecha
           MOVE POL-FEC-FVPL IN SEG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.

      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND
              POL-FEC-FVPL IN SEG-FLD  NOT > ZEROES
              PERFORM ERR-GLS.
           GO TO FIN-POL-FEC-FVPL.     
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO POL-FEC-FVPL IN SEG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-POL-FEC-FVPL.

      *<<<<
           MOVE POL-FEC-FVPL IN SEG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO POL-FEC-FVPL IN SEG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-POL-FEC-FVPL.
            IF POL-FEC-FVPL IN SEG-FLD  NOT > SPACES
              MOVE ZEROES TO POL-FEC-FVPL IN SEG-FLD.
      *VAL-FEC Validar Fecha
           MOVE POL-FEC-FVPL IN SEG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           IF SCR-HDR-MRCA = 'BCS'
              MOVE FEC-CHOY-N TO FEC-CHOY.
           PERFORM PRO-FEC.
           IF SCR-HDR-MRCA = 'BCS'
               IF FEC-STAT-FER
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-FBLK-N  TO FEC-FBLK
                   MOVE FEC-CHOY-N  TO FEC-CHOY
                   MOVE FEC-SIG-HBL TO FEC-CMND
                   PERFORM CAL-FEC
                   MOVE  '00' TO FEC-STAT.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO POL-FEC-FVPL IN SEG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-POL-FEC-FVPL.
      *>>>>

       FIN-VAL-POL-FEC-FVPL.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-POL-FEC-FTPL SECTION.
       INI-VAL-POL-FEC-FTPL.
           IF POL-FEC-FTPL IN SEG-FLD  NOT > ZEROES
              MOVE ZEROES TO POL-FEC-FTPL IN SEG-FLD.
      *VAL-FEC Validar Fecha
           MOVE POL-FEC-FTPL IN SEG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.

      *<<<<
      *MAE
           IF SCR-CMND = 'INE' AND
              POL-FEC-FTPL IN SEG-FLD  NOT > ZEROES
              PERFORM ERR-GLS.
           GO TO FIN-POL-FEC-FTPL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO POL-FEC-FTPL IN SEG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-POL-FEC-FTPL.

      *<<<<
           MOVE POL-FEC-FTPL IN SEG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GSE_FEC_VTO_SEG
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-FBLK-S TO FEC-FBLK.

           MOVE POL-NUM-STPL IN SEG-FLD TO FEC-SEC2.
           MOVE POL-NUM-ATPL IN SEG-FLD TO FEC-AEC2.
           MOVE POL-NUM-MTPL IN SEG-FLD TO FEC-MEC2.
           MOVE POL-NUM-DTPL IN SEG-FLD TO FEC-DEC2.
           GO TO FIN-POL-FEC-FTPL.     
      *>>>>

           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO POL-FEC-FTPL IN SEG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-POL-FEC-FTPL.
      *<<<<
      *Fecha vigencia
           MOVE POL-NUM-SVPL IN SEG-FLD TO FEC-SEC1.
           MOVE POL-NUM-AVPL IN SEG-FLD TO FEC-AEC1.
           MOVE POL-NUM-MVPL IN SEG-FLD TO FEC-MEC1.
           MOVE POL-NUM-DVPL IN SEG-FLD TO FEC-DEC1.
      *Fecha vencimiento
           MOVE POL-NUM-STPL IN SEG-FLD TO FEC-SEC2.
           MOVE POL-NUM-ATPL IN SEG-FLD TO FEC-AEC2.
           MOVE POL-NUM-MTPL IN SEG-FLD TO FEC-MEC2.
           MOVE POL-NUM-DTPL IN SEG-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'VTO<=VIG' TO MSG-COD-MENS
               GO TO ERR-VAL-FEC-FVTS.

           IF NOT (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')
               GO TO FIN-VAL-POL-FEC-FTPL.
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.
           MOVE 'PRD'        TO TAB-COD-TTAB IN TAB.
           MOVE 'FECVIGVTO'  TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
               MOVE 'BGL'            TO MSG-COD-SIST
               MOVE 'TABPRDVIGVTO'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC     TO FRM-MENS
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-POL-FEC-FTPL.
           MOVE TAB-GLS-DATA IN TAB  TO WSS-PER-PERI IN WSS-VARI.
           IF WSS-GLS-CANT IS NOT NUMERIC
               MOVE 'BGL'            TO MSG-COD-SIST
               MOVE 'CANTPRDNONUM'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC     TO FRM-MENS
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-POL-FEC-FTPL.
           IF WSS-GLS-PERI = 'M'
               MOVE POL-NUM-DVPL IN SEG-FLD TO FEC-DEC1
               MOVE POL-NUM-MVPL IN SEG-FLD TO FEC-MEC1
               MOVE POL-NUM-SVPL IN SEG-FLD TO FEC-SEC1
               MOVE POL-NUM-AVPL IN SEG-FLD TO FEC-AEC1
               MOVE POL-NUM-DTPL IN SEG-FLD TO FEC-DEC2
               MOVE POL-NUM-MTPL IN SEG-FLD TO FEC-MEC2
               MOVE POL-NUM-STPL IN SEG-FLD TO FEC-SEC2
               MOVE POL-NUM-ATPL IN SEG-FLD TO FEC-AEC2
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-DIF-MES             TO FEC-CMND
               PERFORM CAL-FEC
               IF (FEC-NDIA > ZEROES )
                   ADD 1 TO FEC-NMES
           END-IF
               IF FEC-NMES NOT > WSS-GLS-CANT IN WSS-VARI
                   GO TO FIN-VAL-POL-FEC-FTPL
               ELSE
                   MOVE 'BGL'            TO MSG-COD-SIST
                   MOVE 'DIFANONOVALI'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC     TO FRM-MENS
                   MOVE FRM-SUAR-MAL     TO FRM-SUAR
                   GO TO FIN-VAL-POL-FEC-FTPL
           ELSE
               MOVE 'BGL'            TO MSG-COD-SIST
               MOVE 'TIPOPRDNOVAL'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC     TO FRM-MENS
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-POL-FEC-FTPL.

           GO TO FIN-VAL-POL-FEC-FTPL.
       ERR-VAL-FEC-FVTS.
           MOVE 'BGL'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.


      *>>>>
       FIN-VAL-POL-FEC-FTPL.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-POL-COD-VCAM SECTION.
       INI-VAL-POL-COD-VCAM.

           IF POL-COD-VCAM IN SEG-FLD NOT > SPACES
              MOVE SPACES TO POL-COD-VCAM IN SEG-FLD.


      *<<<<
      *MAE                                                              
           IF SCR-CMND NOT = 'INE'                                      
              GO TO FIN-VAL-POL-COD-VCAM.                               
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.                          
           MOVE POL-COD-VCAM IN SEG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-VCAM IN SEG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-VCAM IN SEG-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-VCAM IN SEG-FLD.                            
      *MAE                                                              
      *>>>>
       FIN-VAL-POL-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.



       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-POL-VAL-PRIN SECTION.
       INI-VAL-POL-VAL-PRIN.

      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND                                      
              POL-VAL-PRIN IN SEG-FLD NOT > ZEROES                      
              PERFORM ERR-GLS.                                          
      *MAE                                                              
      *>>>>


       FIN-VAL-POL-VAL-PRIN.
           EXIT.
       
       VAL-POL-VAL-PRIB SECTION.
       INI-VAL-POL-VAL-PRIB.

      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND                                      
              POL-VAL-PRIB IN SEG-FLD NOT > ZEROES                      
              PERFORM ERR-GLS.                                          
      *MAE                                                              
      *>>>>


       FIN-VAL-POL-VAL-PRIB.
           EXIT.
       
       VAL-POL-NUM-ENDS SECTION.
       INI-VAL-POL-NUM-ENDS.

      *<<<<
      *MAE                                                              
           IF SCR-CMND = 'INE' AND                                      
              POL-NUM-ENDS IN SEG-FLD NOT > ZEROES                      
              PERFORM ERR-GLS.                                          
      *MAE                                                              
      *>>>>


       FIN-VAL-POL-NUM-ENDS.
           EXIT.
       
       VAL-POL-COD-EPRO SECTION.
       INI-VAL-POL-COD-EPRO.

           IF POL-COD-EPRO IN SEG-FLD NOT > SPACES
              MOVE SPACES TO POL-COD-EPRO IN SEG-FLD.


      *<<<< FIN-VAL-POL-COD-EPRO
      *MAE                                                              
           IF SCR-CMND = 'INE'                                          
              MOVE '01'   TO POL-COD-EPRO IN SEG-FLD                    
              GO TO VAL-COD-EPRO.                                       
      *MAE                                                              

           MOVE POL-CAI-GTIA IN SEG-FLD TO POL-CAI-GTIA IN POL.         
           MOVE POL-IIC-GTIA IN SEG-FLD TO POL-IIC-GTIA IN POL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-POL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-VAL-POL-COD-EPRO.                               
                                                                        
           IF POL-COD-EPRO IN POL = '01'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '01' OR                 
                      POL-COD-EPRO IN SEG-FLD = '02')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '02'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '02' OR                 
                      POL-COD-EPRO IN SEG-FLD = '03' OR                 
                      POL-COD-EPRO IN SEG-FLD = '11')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '03'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '03' OR                 
                      POL-COD-EPRO IN SEG-FLD = '04' OR                 
                      POL-COD-EPRO IN SEG-FLD = '06')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '04'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '04' OR                 
                      POL-COD-EPRO IN SEG-FLD = '05')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '05'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '05' OR                 
                      POL-COD-EPRO IN SEG-FLD = '06')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '06'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '06' OR                 
                      POL-COD-EPRO IN SEG-FLD = '07')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '13'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '13' OR                 
                      POL-COD-EPRO IN SEG-FLD = '07')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '11'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '11' OR                 
                      POL-COD-EPRO IN SEG-FLD = '12')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
                                                                        
           IF POL-COD-EPRO IN POL = '12'                                
              IF NOT (POL-COD-EPRO IN SEG-FLD = '12' OR                 
                      POL-COD-EPRO IN SEG-FLD = '13')                   
                  MOVE 'BGL'            TO MSG-COD-SIST                 
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                 
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        

           IF (POL-COD-EPRO IN POL = '07' AND                          
               POL-COD-EPRO IN SEG-FLD NOT = '07')                     
                  MOVE 'BGL'            TO MSG-COD-SIST                
                  MOVE 'NO PERMITIDO'   TO MSG-COD-MENS                
                  PERFORM GET-MSG                                      
                  MOVE MSG-GLS-DESC TO FRM-MENS                        
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
      *MAE                                                              
       VAL-COD-EPRO.                                                    
      *MAE                                                              
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'ESP ' TO TAB-COD-TTAB IN TAB.                          
           MOVE POL-COD-EPRO IN SEG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              POL-COD-EPRO IN SEG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-EPRO IN SEG-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-EPRO IN SEG-FLD.                            
                                                                        
           IF POL-COD-EPRO IN SEG-FLD NOT > ZEROES                      
              MOVE ZEROES TO POL-COD-EPRO IN SEG-FLD.                   
      *>>>>
       FIN-VAL-POL-COD-EPRO.
           EXIT.
       
       VAL-FRM-GLS-EPRO SECTION.
       INI-VAL-FRM-GLS-EPRO.



       FIN-VAL-FRM-GLS-EPRO.
           EXIT.
       
       VAL-CON-FLD-SEG SECTION.
       INI-VAL-CON-FLD-SEG.

       FIN-VAL-CON-FLD-SEG.
           EXIT.
       
       VAL-CON-SEG SECTION.
       INI-VAL-CON-SEG.

       FIN-VAL-CON-SEG.
           EXIT.
       
       VAL-NUM-KEY-SEG SECTION.
       INI-VAL-NUM-KEY-SEG.
           PERFORM VAL-NUM-IKY-SEG.
           PERFORM VAL-NUM-MKY-SEG.
           PERFORM VAL-NUM-AKY-SEG.
       FIN-VAL-NUM-KEY-SEG.
           EXIT.
       
       VAL-NUM-IKY-SEG SECTION.
       INI-VAL-NUM-IKY-SEG.

       VAL-NUM-POL-IIC-GTIA.
           MOVE POL-IIC-GTIA-ALF IN SEG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POL-IIC-GTIA IN SEG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POL-IIC-GTIA-LEN IN SEG-FLD
                GO TO FIN-VAL-NUM-IKY-SEG.

       FIN-VAL-NUM-IKY-SEG.
           EXIT.
       
       VAL-NUM-MKY-SEG SECTION.
       INI-VAL-NUM-MKY-SEG.


       FIN-VAL-NUM-MKY-SEG.
           EXIT.
       
       VAL-NUM-AKY-SEG SECTION.
       INI-VAL-NUM-AKY-SEG.


       FIN-VAL-NUM-AKY-SEG.
           EXIT.
       
       VAL-NUM-FLD-SEG SECTION.
       INI-VAL-NUM-FLD-SEG.

      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN SEG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN SEG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN SEG-FLD
                GO TO FIN-VAL-NUM-FLD-SEG.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-POL-VAL-PRIN.
           MOVE POL-VAL-PRIN-ALF IN SEG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO POL-VAL-PRIN IN SEG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POL-VAL-PRIN-LEN IN SEG-FLD
                GO TO FIN-VAL-NUM-FLD-SEG.
       VAL-NUM-POL-VAL-PRIB.
           MOVE POL-VAL-PRIB-ALF IN SEG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO POL-VAL-PRIB IN SEG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POL-VAL-PRIB-LEN IN SEG-FLD
                GO TO FIN-VAL-NUM-FLD-SEG.
       VAL-NUM-POL-NUM-ENDS.
           MOVE POL-NUM-ENDS-ALF IN SEG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POL-NUM-ENDS IN SEG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POL-NUM-ENDS-LEN IN SEG-FLD
                GO TO FIN-VAL-NUM-FLD-SEG.

       FIN-VAL-NUM-FLD-SEG.
           EXIT.
       
       EDT-KEY-SEG SECTION.
       INI-EDT-KEY-SEG.
           PERFORM EDT-IKY-SEG.
           PERFORM EDT-MKY-SEG.
           PERFORM EDT-AKY-SEG.

       FIN-EDT-KEY-SEG.
           EXIT.
       
       EDT-IKY-SEG SECTION.
       INI-EDT-IKY-SEG.

           IF POL-IIC-GTIA-LEN IN SEG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POL-IIC-GTIA-LEN IN SEG-FLD
                GO TO FIN-EDT-IKY-SEG.
           MOVE POL-IIC-GTIA IN SEG-FLD TO POL-IIC-GTIA-EDT IN SEG-EDT.
           MOVE POL-IIC-GTIA-EDT IN SEG-EDT TO 
                POL-IIC-GTIA-ALF IN SEG-FLD.

       FIN-EDT-IKY-SEG.
           EXIT.
       
       EDT-MKY-SEG SECTION.
       INI-EDT-MKY-SEG.


       FIN-EDT-MKY-SEG.
           EXIT.
       
       EDT-AKY-SEG SECTION.
       INI-EDT-AKY-SEG.


       FIN-EDT-AKY-SEG.
           EXIT.
       
       EDT-FLD-SEG SECTION.
       INI-EDT-FLD-SEG.

      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN SEG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN SEG-FLD
                GO TO FIN-EDT-FLD-SEG.
           MOVE DBC-NUM-ICLI IN SEG-FLD TO
                DBC-NUM-ICLI-EDT IN SEG-EDT.
           MOVE DBC-NUM-ICLI-EDT IN SEG-EDT TO
                DBC-NUM-ICLI-ALF IN SEG-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF POL-VAL-PRIN-LEN IN SEG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POL-VAL-PRIN-LEN IN SEG-FLD
                GO TO FIN-EDT-FLD-SEG.
           MOVE POL-VAL-PRIN IN SEG-FLD TO POL-VAL-PRIN-EDT IN SEG-EDT.
           MOVE POL-VAL-PRIN-EDT IN SEG-EDT TO 
                POL-VAL-PRIN-ALF IN SEG-FLD.
           IF POL-VAL-PRIB-LEN IN SEG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POL-VAL-PRIB-LEN IN SEG-FLD
                GO TO FIN-EDT-FLD-SEG.
           MOVE POL-VAL-PRIB IN SEG-FLD TO POL-VAL-PRIB-EDT IN SEG-EDT.
           MOVE POL-VAL-PRIB-EDT IN SEG-EDT TO 
                POL-VAL-PRIB-ALF IN SEG-FLD.
           IF POL-NUM-ENDS-LEN IN SEG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POL-NUM-ENDS-LEN IN SEG-FLD
                GO TO FIN-EDT-FLD-SEG.
           MOVE POL-NUM-ENDS IN SEG-FLD TO POL-NUM-ENDS-EDT IN SEG-EDT.
           MOVE POL-NUM-ENDS-EDT IN SEG-EDT TO 
                POL-NUM-ENDS-ALF IN SEG-FLD.

       FIN-EDT-FLD-SEG.
           EXIT.



