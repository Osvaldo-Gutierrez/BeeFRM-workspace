      *
      * BGLBUGDO
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 04:51 PM
      *
       SET-TAG-BGLBUGDO SECTION.
       INI-SET-TAG-BGLBUGDO.
           MOVE
           '<IDNMOD NOM=$BGLBUGDO$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 04:51 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGDO.
           EXIT.
           
       RET-ALL-GDO SECTION.
       INI-RET-ALL-GDO.
           PERFORM KEY-ALL-GDO.
           PERFORM RET-GDO-GDO.
           PERFORM RET-GDG-GDO.
       FIN-RET-ALL-GDO.
           EXIT.
       
       RET-GDO-GDO SECTION.
       INI-RET-GDO-GDO.
           MOVE GDO-COD-DOCU IN GDO-FLD TO GDO-COD-DOCU IN GDO.
           MOVE GDO-COD-TDOC IN GDO-FLD TO GDO-COD-TDOC IN GDO.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDO-NUM-DCAP IN GDO-FLD TO GDO-NUM-DCAP IN GDO.
           MOVE GDO-NUM-MCAP IN GDO-FLD TO GDO-NUM-MCAP IN GDO.
           MOVE GDO-NUM-SCAP IN GDO-FLD TO GDO-NUM-SCAP IN GDO.
           MOVE GDO-NUM-ACAP IN GDO-FLD TO GDO-NUM-ACAP IN GDO.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDO-COD-TIEM IN GDO-FLD TO GDO-COD-TIEM IN GDO.
           MOVE GDO-COD-INEM IN GDO-FLD TO GDO-COD-INEM IN GDO.
           MOVE GDO-COD-SIEM IN GDO-FLD TO GDO-COD-SIEM IN GDO.
           MOVE GDO-COD-NEMO IN GDO-FLD TO GDO-COD-NEMO IN GDO.
           MOVE GDO-COD-RENO IN GDO-FLD TO GDO-COD-RENO IN GDO.
           MOVE GDO-NUM-SEVE IN GDO-FLD TO GDO-NUM-SEVE IN GDO.
           MOVE GDO-IND-SEVE IN GDO-FLD TO GDO-IND-SEVE IN GDO.
           MOVE GDO-SGV-TINT IN GDO-FLD TO GDO-SGV-TINT IN GDO.
           MOVE GDO-COD-TIPT IN GDO-FLD TO GDO-COD-TIPT IN GDO.
           MOVE GDO-SGV-TCGT IN GDO-FLD TO GDO-SGV-TCGT IN GDO.
           MOVE GDO-COD-TCGT IN GDO-FLD TO GDO-COD-TCGT IN GDO.
       FIN-RET-GDO-GDO.
           EXIT.
       
       RET-GDG-GDO SECTION.
       INI-RET-GDG-GDO.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GDO-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GDO-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
      * OFI-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-OFIC IN GDO-FLD TO GDG-COD-OFIC IN GDG.
      * OFI-FIN --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-VCAM IN GDO-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-GLS-DGTA IN GDO-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-GLS-DGT1 IN GDO-FLD TO GDG-GLS-DGT1 IN GDG.
       FIN-RET-GDG-GDO.
           EXIT.
       
       KEY-ALL-GDO SECTION.
       INI-KEY-ALL-GDO.
           PERFORM KEY-GDO-GDO.
           PERFORM KEY-GDG-GDO.
       FIN-KEY-ALL-GDO.
           EXIT.
       
       KEY-GDO-GDO SECTION.
       INI-KEY-GDO-GDO.
           MOVE GDO-CAI-GTIA IN GDO-FLD TO GDO-CAI-GTIA IN GDO.
           MOVE GDO-IIC-GTIA IN GDO-FLD TO GDO-IIC-GTIA IN GDO.
           MOVE GDO-NUM-IGDO IN GDO-FLD TO GDO-NUM-IGDO IN GDO.
       FIN-KEY-GDO-GDO.
           EXIT.
       
       KEY-GDG-GDO SECTION.
       INI-KEY-GDG-GDO.
       FIN-KEY-GDG-GDO.
           EXIT.
       
       SCR-CLRA-GDO SECTION.
       INI-SCR-CLRA-GDO.
           PERFORM CLR-KEY-GDO.
           PERFORM CLR-FLD-GDO.
       FIN-SCR-CLRA-GDO.
           EXIT.
       
       CLR-KEY-GDO SECTION.
       INI-CLR-KEY-GDO.
           MOVE SPACES TO GDO-CAI-GTIA IN GDO-FLD.
           MOVE ZEROES TO GDO-IIC-GTIA IN GDO-FLD.
           MOVE ZEROES TO GDO-NUM-IGDO IN GDO-FLD.
       FIN-CLR-KEY-GDO.
           EXIT.
       
       CLR-FLD-GDO SECTION.
       INI-CLR-FLD-GDO.
           MOVE SPACES TO FRM-GLS-TREA IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-TDOC IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-IEMI IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-RENO IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-SEVE IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-TIPT IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-TCGT IN GDO-FLD.
           PERFORM CLR-GDO-GDO.
           PERFORM CLR-GDG-GDO.
       FIN-CLR-FLD-GDO.
           EXIT.
       
       CLR-GDO-GDO SECTION.
       INI-CLR-GDO-GDO.
           MOVE SPACES TO GDO-COD-DOCU IN GDO-FLD.
           MOVE SPACES TO GDO-COD-TDOC IN GDO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDO-FEC-FCAP IN GDO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDO-COD-TIEM IN GDO-FLD.
           MOVE SPACES TO GDO-COD-INEM IN GDO-FLD.
           MOVE SPACES TO GDO-COD-SIEM IN GDO-FLD.
           MOVE SPACES TO GDO-COD-NEMO IN GDO-FLD.
           MOVE SPACES TO GDO-COD-RENO IN GDO-FLD.
           MOVE ZEROES TO GDO-NUM-SEVE IN GDO-FLD.
           MOVE SPACES TO GDO-IND-SEVE IN GDO-FLD.
           MOVE ZEROES TO GDO-SGV-TINT IN GDO-FLD.
           MOVE SPACES TO GDO-COD-TIPT IN GDO-FLD.
           MOVE ZEROES TO GDO-SGV-TCGT IN GDO-FLD.
           MOVE SPACES TO GDO-COD-TCGT IN GDO-FLD.
       FIN-CLR-GDO-GDO.
           EXIT.
       
       CLR-GDG-GDO SECTION.
       INI-CLR-GDG-GDO.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GDO-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GDO-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GDO-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GDO-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GDO-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GDO-FLD.
       FIN-CLR-GDG-GDO.
           EXIT.
       
       FST-KEY-GDO SECTION.
       INI-FST-KEY-GDO.
           MOVE -1 TO GDO-CAI-GTIA-LEN IN GDO-FLD.
       FIN-FST-KEY-GDO.
           EXIT.
       
       FST-FLD-GDO SECTION.
       INI-FST-FLD-GDO.
           MOVE -1 TO GDO-COD-DOCU-LEN IN GDO-FLD.
       FIN-FST-FLD-GDO.
           EXIT.
       
       PRO-KEY-GDO SECTION.
       INI-PRO-KEY-GDO.
           PERFORM PRO-MKY-GDO.
       FIN-PRO-KEY-GDO.
           EXIT.
       
       PRO-MKY-GDO SECTION.
       INI-PRO-MKY-GDO.
       FIN-PRO-MKY-GDO.
           EXIT.
       
       PRO-FLD-GDO SECTION.
       INI-PRO-FLD-GDO.
           PERFORM PRO-GDO-GDO.
           PERFORM PRO-GDG-GDO.
       FIN-PRO-FLD-GDO.
           EXIT.
       
       PRO-GDO-GDO SECTION.
       INI-PRO-GDO-GDO.
           MOVE FRM-CPIM-AEY TO GDO-COD-DOCU-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-COD-TDOC-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-FEC-FCAP-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-COD-TIEM-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-COD-INEM-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-COD-SIEM-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-COD-NEMO-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-COD-RENO-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-NUM-SEVE-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-IND-SEVE-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-SGV-TINT-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-COD-TIPT-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-SGV-TCGT-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-COD-TCGT-ATR IN GDO-FLD.
       FIN-PRO-GDO-GDO.
           EXIT.
       
       PRO-GDG-GDO SECTION.
       INI-PRO-GDG-GDO.
       FIN-PRO-GDG-GDO.
           EXIT.
       
       UNP-KEY-GDO SECTION.
       INI-UNP-KEY-GDO.
           PERFORM UNP-IKY-GDO.
           PERFORM UNP-AKY-GDO.
           PERFORM UNP-MKY-GDO.
       FIN-UNP-KEY-GDO.
           EXIT.
       
       UNP-IKY-GDO SECTION.
       INI-UNP-IKY-GDO.
           MOVE FRM-CPIM-UBY TO GDO-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GDO-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GDO-NUM-IGDO-ATR.
      *<<<< FIN_UNP_IKY_GDO 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = "ING"
               MOVE FRM-CPIM-AEY TO GDO-NUM-IGDO-ATR IN GDO-FLD
               MOVE FRM-CPIM-AEY TO GDO-NUM-IGDO-STP.
      *RRM-FIN 16-APR-2002
      *>>>>
       FIN-UNP-IKY-GDO.
           EXIT.
       
       UNP-MKY-GDO SECTION.
       INI-UNP-MKY-GDO.
       FIN-UNP-MKY-GDO.
           EXIT.
       
       UNP-AKY-GDO SECTION.
       INI-UNP-AKY-GDO.
       FIN-UNP-AKY-GDO.
           EXIT.
       
       UNP-FLD-GDO SECTION.
       INI-UNP-FLD-GDO.
           PERFORM UNP-GDO-GDO.
           PERFORM UNP-GDG-GDO.
       FIN-UNP-FLD-GDO.
           EXIT.
       
       UNP-GDO-GDO SECTION.
       INI-UNP-GDO-GDO.
           MOVE FRM-CPIM-UBY TO GDO-COD-DOCU-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-TDOC-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-FEC-FCAP-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-TIEM-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-INEM-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-SIEM-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-NEMO-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-RENO-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-NUM-SEVE-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-IND-SEVE-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-SGV-TINT-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-TIPT-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-SGV-TCGT-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-TCGT-ATR IN GDO-FLD.
       FIN-UNP-GDO-GDO.
           EXIT.
       
       UNP-GDG-GDO SECTION.
       INI-UNP-GDG-GDO.
       FIN-UNP-GDG-GDO.
           EXIT.
       
       VAL-MKY-GDO SECTION.
       INI-VAL-MKY-GDO.
       FIN-VAL-MKY-GDO.
           EXIT.
       
       VAL-FLD-GDO SECTION.
       INI-VAL-FLD-GDO.
      *<<<< INI_VAL_FLD_GDO                                             
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM                          
           MOVE GDO-CAI-GTIA IN GDO-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GDO-IIC-GTIA IN GDO-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
      *VERIFICA SI PRODUCTO (TIPO-SUBTIPO) ES FFMM                      
           MOVE SPACES              TO WSS-IND-FFMM.                    
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'PFM'               TO TAB-COD-TTAB IN TAB.             
           MOVE GDG-COD-CGTA IN GDG TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S              
               MOVE WSS-S TO WSS-IND-FFMM.                              
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM                          
      *>>>> INI_VAL_FLD_GDO 
           PERFORM VAL-FRM-GLS-TREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TREA-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
      * IDG-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-TIP-CGTA-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-STP-CGTA-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
      * IDG-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
      * OFI-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-COD-OFIC-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
      * OFI-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-COD-DOCU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-COD-DOCU-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-COD-TDOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-COD-TDOC-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-FRM-GLS-TDOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TDOC-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDO-FEC-FCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDO-FEC-FCAP-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDO-COD-TIEM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-COD-TIEM-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-COD-INEM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-COD-INEM-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-COD-SIEM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-COD-SIEM-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-FRM-GLS-IEMI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-IEMI-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-COD-NEMO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-COD-NEMO-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-COD-RENO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-COD-RENO-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-FRM-GLS-RENO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RENO-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-NUM-SEVE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-NUM-SEVE-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-IND-SEVE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-IND-SEVE-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-FRM-GLS-SEVE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SEVE-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-SGV-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-SGV-TINT-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-COD-TIPT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-COD-TIPT-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-FRM-GLS-TIPT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TIPT-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-SGV-TCGT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-SGV-TCGT-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-GDO-COD-TCGT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-COD-TCGT-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
           PERFORM VAL-FRM-GLS-TCGT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TCGT-LEN IN GDO-FLD
                GO TO FIN-VAL-FLD-GDO.
       FIN-VAL-FLD-GDO.
           EXIT.
       
       VAL-FRM-GLS-TREA SECTION.
       INI-VAL-FRM-GLS-TREA.
       FIN-VAL-FRM-GLS-TREA.
           EXIT.
      * IDG-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.
           IF GDG-TIP-CGTA IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-CGTA IN GDO-FLD.
       FIN-VAL-GDG-TIP-CGTA.
           EXIT.

       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.
           IF GDG-STP-CGTA IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-CGTA IN GDO-FLD.
       FIN-VAL-GDG-STP-CGTA.
           EXIT.
      * IDG-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * OFI-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
           IF GDG-COD-OFIC IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GDO-FLD.
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
      * OFI-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
       
       VAL-GDO-COD-DOCU SECTION.
       INI-VAL-GDO-COD-DOCU.
           IF GDO-COD-DOCU IN GDO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDO-COD-DOCU.
      *<<<< GDO_COD_DOC
      *>>>>
      *<<<<<                                                                  
      * EVA-INI  06/08                                                  
                                                                        
           MOVE 'N' TO WSS-IND-AMTM IN WSS-VARI.                        
                                                                        
           MOVE GDO-CAI-GTIA IN GDO-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GDO-IIC-GTIA IN GDO-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
                                                                        
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'MTM'               TO TAB-COD-TTAB IN TAB.             
           MOVE GDG-COD-CGTA IN GDG TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
              GO TO FIN-VAL-GDO-COD-DOCU                                
           ELSE                                                         
              MOVE 'S' TO WSS-IND-AMTM IN WSS-VARI                      
              MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.     
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI NOT = 'S' OR                     
              WSS-IND-AMTM IN WSS-VARI = 'N'                            
              GO TO FIN-VAL-GDO-COD-DOCU                                
           ELSE                                                         
              MOVE GDO-COD-DOCU IN GDO-FLD TO OPD-KEY-IOPD IN OPD       
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM DAP-FIO-OPD                                       
              IF NOT FIO-STAT-OKS                                       
                 MOVE 'DAP' TO MSG-COD-SIST                             
                 MOVE 'OPD    NEX' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
              ELSE                                                      
                 IF OPD-COD-STAT IN OPD NOT = 'G'                       
                    MOVE 'BGL'            TO MSG-COD-SIST               
                    MOVE 'OPD    NOVIG'   TO MSG-COD-MENS               
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC TO FRM-MENS                       
                    MOVE FRM-SUAR-MAL TO FRM-SUAR                       
                 ELSE                                                   
                    IF OPD-VAL-SCAP IN OPD NOT > ZEROES                 
                       MOVE 'BGL'            TO MSG-COD-SIST            
                       MOVE 'OPD    CAP=0'   TO MSG-COD-MENS            
                       PERFORM GET-MSG                                  
                       MOVE MSG-GLS-DESC TO FRM-MENS                    
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                    END-IF                                              
                 END-IF                                                 
              END-IF                                                    
           END-IF.                                                      
      * EVA-FIN  06/08                                                  
      *<<<<
       FIN-VAL-GDO-COD-DOCU.
           EXIT.
       
       VAL-GDO-COD-TDOC SECTION.
       INI-VAL-GDO-COD-TDOC.
      *>>>> INI_GTO_TIP_DOCU
           IF GDO-COD-TDOC IN GDO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDO-COD-TDOC.

      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
      *VERIFICA SI PRODUCTO (TIPO-SUBTIPO) ES FFMM
           IF WSS-IND-FFMM NOT = WSS-S
               GO TO GDO-COD-TDOC-NO-FFMM.
      *FFMM SE VALIDA EN LA TABLA TDO    
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.          
           MOVE 'TDO'               TO TAB-COD-TTAB IN TAB.            
           MOVE GDO-COD-TDOC IN GDO-FLD TO TAB-COD-CTAB IN TAB.        
           MOVE FIO-GET-KEY TO FIO-CMND.                               
           PERFORM GNS-FIO-TAB.                                        
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S)         
               MOVE SPACES TO FRM-GLS-TDOC IN GDO-FLD
               MOVE 'BGL' TO MSG-COD-SIST
               MOVE 'CODTDO NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR                         
               GO TO FIN-VAL-GDO-COD-TDOC.           

           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TDOC IN GDO-FLD.
           GO TO FIN-VAL-GDO-COD-TDOC.             
       GDO-COD-TDOC-NO-FFMM.                 
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM               

      *VAL-COD Valida codigo de tabla
      *<<<< GEN_BCI
           MOVE 'TAB'           TO TAB-COD-SIST.
           MOVE 'TIO'           TO TAB-COD-TTAB IN TAB.
      *>>>>
           MOVE GDO-COD-TDOC IN GDO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDO-COD-TDOC IN GDO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TDOC IN GDO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TDOC IN GDO-FLD.

           GO TO FIN-VAL-GDO-COD-TDOC.
      *<<<<
           IF GDO-COD-TDOC IN GDO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDO-COD-TDOC.
      *<<<< GDO_COD_TDOC
      *>>>>
       FIN-VAL-GDO-COD-TDOC.
           EXIT.
       
       VAL-FRM-GLS-TDOC SECTION.
       INI-VAL-FRM-GLS-TDOC.
       FIN-VAL-FRM-GLS-TDOC.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDO-FEC-FCAP SECTION.
       INI-VAL-GDO-FEC-FCAP.
           IF GDO-FEC-FCAP IN GDO-FLD  NOT > ZEROES
              MOVE ZEROES TO GDO-FEC-FCAP IN GDO-FLD.
      *VAL-FEC Validar Fecha
           MOVE GDO-FEC-FCAP IN GDO-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDO_FEC_CAP
           MOVE FEC-FBLK-S TO FEC-FBLK.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDO-FEC-FCAP IN GDO-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDO-FEC-FCAP.
      *<<<< GDO_FEC_CAP

      *RRM-INI 8-SEP-2001
      *    MOVE GDG-COD-SOPE IN GDO-FLD TO WSS-COD-SOPE.
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GDO-FLD TO WSS-COD-TOPE.
           MOVE GDG-STP-CGTA IN GDO-FLD TO WSS-COD-SOPE.
      *>>>>
      *RRM-FIN 8-SEP-2001
           IF NOT DEPOSITO-A-PLAZO
               GO TO FIN-VAL-GDO-FEC-FCAP.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GDG-FEC-FSOL IN CMA-VARI TO FEC-FVLD IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.
      *--------------------------------------------------------*
      *MHM-INI 04-JUN-2007                                              
      *    MOVE GDO-FEC-FCAP IN GDO-FLD TO FEC-FVLD IN FEC-VARI.        
           MOVE GDO-NUM-DCAP IN GDO-FLD TO FEC-DVLD IN FEC-VARI.        
           MOVE GDO-NUM-MCAP IN GDO-FLD TO FEC-MVLD IN FEC-VARI.        
           MOVE GDO-NUM-SCAP IN GDO-FLD TO FEC-SVLD IN FEC-VARI.        
           MOVE GDO-NUM-ACAP IN GDO-FLD TO FEC-AVLD IN FEC-VARI.        
      *MHM-FIN 04-JUN-2007                                              
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'CAP>SOL' TO MSG-COD-MENS
               MOVE 'BGL'     TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDO-FEC-FCAP.

      *>>>>
       FIN-VAL-GDO-FEC-FCAP.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GDO-COD-TIEM SECTION.
       INI-VAL-GDO-COD-TIEM.
           IF GDO-COD-TIEM IN GDO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDO-COD-TIEM.
       FIN-VAL-GDO-COD-TIEM.
           EXIT.
       
       VAL-GDO-COD-INEM SECTION.
       INI-VAL-GDO-COD-INEM.
           IF GDO-COD-INEM IN GDO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDO-COD-INEM.
       FIN-VAL-GDO-COD-INEM.
           EXIT.
       
       VAL-GDO-COD-SIEM SECTION.
       INI-VAL-GDO-COD-SIEM.
           IF GDO-COD-SIEM IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDO-COD-SIEM IN GDO-FLD.
      *<<<< GDO_SIV_EMI
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
      *VERIFICA SI PRODUCTO (TIPO-SUBTIPO) ES FFMM
           IF WSS-IND-FFMM NOT = WSS-S
               GO TO GDO-COD-SIEM-NO-FFMM.
               
      *SI ES FFMM DEBE ESTAR CONSISTENTE CON Tpo Documento ("FMT")
           IF GDO-COD-TDOC IN GDO-FLD NOT = GDO-COD-TIEM IN GDO-FLD
               MOVE 'NOVAL FMT' TO MSG-COD-MENS                           
               MOVE 'BGL'       TO MSG-COD-SIST                           
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE  0 TO GDO-COD-SIEM-LEN IN GDO-FLD                   
               MOVE -1 TO GDO-COD-TIEM-LEN IN GDO-FLD                   
               MOVE SPACES TO FRM-GLS-IEMI IN GDO-FLD                   
               GO TO FIN-VAL-GDO-COD-SIEM.
               
       GDO-COD-SIEM-NO-FFMM. 
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM  

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE GDO-COD-TIEM IN GDO-FLD TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDO-COD-INEM IN GDO-FLD TO WSS-COD-INEM
           MOVE GDO-COD-SIEM IN GDO-FLD TO WSS-COD-SIEM
           MOVE WSS-CIV-SIV TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
      *        MOVE TAB-GLS-DESC IN TAB TO 
      *             FRM-GLS-IEMI IN GDO-FLD
               IF WSS-IND-FFMM = WSS-S
                   MOVE TAB-GLS-DESC IN TAB TO 
                            FRM-GLS-IEMI IN GDO-FLD
                   MOVE TAB-GLS-DCOR IN TAB TO 
                            GDO-COD-NEMO IN GDO-FLD
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO 
                       FRM-GLS-IEMI IN GDO-FLD
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM
           ELSE
               MOVE  0 TO GDO-COD-SIEM-LEN IN GDO-FLD
               MOVE -1 TO GDO-COD-TIEM-LEN IN GDO-FLD
               MOVE SPACES TO FRM-GLS-IEMI IN GDO-FLD
               GO TO FIN-VAL-GDO-COD-SIEM.
       FIN-VAL-GDO-COD-SIEM.
           EXIT.
       
       VAL-FRM-GLS-IEMI SECTION.
       INI-VAL-FRM-GLS-IEMI.
       FIN-VAL-FRM-GLS-IEMI.
           EXIT.
       
       VAL-GDO-COD-NEMO SECTION.
       INI-VAL-GDO-COD-NEMO.
      *<<<< INI_GDO_COD_NEMO
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
      *VERIFICA SI PRODUCTO (TIPO-SUBTIPO) ES FFMM
           IF WSS-IND-FFMM = WSS-S
               GO TO FIN-VAL-GDO-COD-NEMO.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM
      *>>>> INI_GDO_COD_NEMO
           IF GDO-COD-NEMO IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDO-COD-NEMO IN GDO-FLD.
      *<<<<
      * EVA-INI  06/08                                                  
           IF SCR-HDR-MRCA = 'BCS' OR                                   
              WSS-IND-AMTM IN WSS-VARI = 'N'                            
              GO TO FIN-VAL-GDO-COD-NEMO.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'N' AND                        
              GDO-COD-NEMO IN GDO-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GDO-COD-NEMO.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'S'                            
              MOVE FRM-CPIM-AEY TO GDO-COD-NEMO-ATR IN GDO-FLD          
              PERFORM BUS-COD-NEMO                                      
              MOVE WSS-COD-NEMO IN WSS-VARI TO GDO-COD-NEMO IN GDO-FLD. 
      * EVA-FIN  06/08                                                  
                                                                        
      *>>>>
       FIN-VAL-GDO-COD-NEMO.
           EXIT.
       
       VAL-GDO-COD-RENO SECTION.
       INI-VAL-GDO-COD-RENO.
           IF GDO-COD-RENO IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDO-COD-RENO IN GDO-FLD.
      *<<<<
                                                                        
      * EVA-INI  06/08                                                  
           IF SCR-HDR-MRCA = 'BCS' OR                                   
              WSS-IND-AMTM IN WSS-VARI = 'N'                            
              GO TO FIN-VAL-GDO-COD-RENO.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'N' AND                        
              GDO-COD-RENO IN GDO-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GDO-COD-RENO.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'S'                            
              IF OPD-COD-RENO IN OPD = 'N'                              
                 MOVE 'F' TO GDO-COD-RENO IN GDO-FLD                    
              ELSE                                                      
                 MOVE 'R' TO GDO-COD-RENO IN GDO-FLD.                   
                                                                        
           IF GDO-COD-RENO IN GDO-FLD > SPACES                          
              MOVE 'BGL'                   TO TAB-COD-SIST FIO-SIST     
              MOVE 'PFR'                   TO TAB-COD-TTAB IN TAB       
              MOVE GDO-COD-RENO IN GDO-FLD TO TAB-COD-CTAB IN TAB       
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM GNS-FIO-TAB                                       
              IF NOT (FIO-STAT-OKS AND                                  
                 TAB-IND-VIGE IN TAB = 'S')                             
                 MOVE 'BGL' TO MSG-COD-SIST                             
                 MOVE 'CODPFR NEX' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
              ELSE                                                      
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-RENO IN GDO-FLD    
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-RENO IN GDO-FLD.                   
                                                                        
      * EVA-FIN  06/08                                                  
      *>>>>
       FIN-VAL-GDO-COD-RENO.
           EXIT.
       
       VAL-FRM-GLS-RENO SECTION.
       INI-VAL-FRM-GLS-RENO.
       FIN-VAL-FRM-GLS-RENO.
           EXIT.
       
       VAL-GDO-NUM-SEVE SECTION.
       INI-VAL-GDO-NUM-SEVE.
      *<<<<
      * EVA-INI  06/08                                                  
                                                                        
           IF GDO-NUM-SEVE IN GDO-FLD NOT > ZEROES                      
              MOVE ZEROES TO GDO-NUM-SEVE IN GDO-FLD.                   
                                                                        
           IF SCR-HDR-MRCA = 'BCS' OR                                   
              WSS-IND-AMTM IN WSS-VARI = 'N'                            
              GO TO FIN-VAL-GDO-NUM-SEVE.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'N' AND                        
              GDO-NUM-SEVE IN GDO-FLD NOT > ZEROES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GDO-NUM-SEVE.                               
                                                                        
           IF GDO-NUM-SEVE IN GDO-FLD NOT > ZEROES AND                  
              GDO-IND-SEVE IN GDO-FLD > SPACES                          
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GDO-NUM-SEVE.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'S'                            
              MOVE OPD-NUM-PVEN IN OPD TO GDO-NUM-SEVE IN GDO-FLD       
              MOVE OPD-IND-PVEN IN OPD TO GDO-IND-SEVE IN GDO-FLD.      
                                                                        
      * EVA-FIN  06/08                                                  
      *>>>>
       FIN-VAL-GDO-NUM-SEVE.
           EXIT.
       
       VAL-GDO-IND-SEVE SECTION.
       INI-VAL-GDO-IND-SEVE.
           IF GDO-IND-SEVE IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDO-IND-SEVE IN GDO-FLD.
      *<<<<
      * EVA-INI  06/08                                                  
                                                                        
           IF SCR-HDR-MRCA = 'BCS' OR                                   
              WSS-IND-AMTM IN WSS-VARI = 'N'                            
              GO TO FIN-VAL-GDO-IND-SEVE.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'N' AND                        
              GDO-IND-SEVE IN GDO-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GDO-IND-SEVE.                               
                                                                        
           IF GDO-NUM-SEVE IN GDO-FLD > ZEROES AND                      
              GDO-IND-SEVE IN GDO-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GDO-IND-SEVE.                               
                                                                        
           IF GDO-IND-SEVE IN GDO-FLD > SPACES                          
              MOVE 'TAB'                   TO MSC-COD-SIST              
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC       
              MOVE GDO-IND-SEVE IN GDO-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND                                           
              IF MSG-COD-MENS = 'COD    NEX'                            
                 MOVE SPACES TO FRM-GLS-SEVE IN GDO-FLD                 
              ELSE                                                      
                 MOVE MSC-GLS-DCOR IN MSC TO                            
                 FRM-GLS-SEVE IN GDO-FLD                                
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-SEVE IN GDO-FLD.                   
                                                                        
                                                                        
      * EVA-FIN  06/08                                                  
      *>>>>
       FIN-VAL-GDO-IND-SEVE.
           EXIT.
       
       VAL-FRM-GLS-SEVE SECTION.
       INI-VAL-FRM-GLS-SEVE.
       FIN-VAL-FRM-GLS-SEVE.
           EXIT.
       
       VAL-GDO-SGV-TINT SECTION.
       INI-VAL-GDO-SGV-TINT.
      *<<<<
      * EVA-INI  06/08                                                  
                                                                        
           IF GDO-SGV-TINT IN GDO-FLD NOT > ZEROES                      
              MOVE ZEROES TO GDO-SGV-TINT IN GDO-FLD.                   
                                                                        
           IF SCR-HDR-MRCA = 'BCS' OR                                   
              WSS-IND-AMTM IN WSS-VARI = 'N'                            
              GO TO FIN-VAL-GDO-SGV-TINT.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'N' AND                        
              GDO-SGV-TINT IN GDO-FLD NOT > ZEROES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GDO-SGV-TINT.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'S'                            
              MOVE OPD-SGV-TINT IN OPD TO GDO-SGV-TINT IN GDO-FLD.      
                                                                        
      * EVA-FIN  06/08                                                  
      *>>>>
       FIN-VAL-GDO-SGV-TINT.
           EXIT.
       
       VAL-GDO-COD-TIPT SECTION.
       INI-VAL-GDO-COD-TIPT.
           IF GDO-COD-TIPT IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDO-COD-TIPT IN GDO-FLD.
      *<<<<
      * EVA-INI  06/08                                                  
                                                                        
           IF SCR-HDR-MRCA = 'BCS' OR                                   
              WSS-IND-AMTM IN WSS-VARI = 'N'                            
              GO TO FIN-VAL-GDO-COD-TIPT.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'N' AND                        
              GDO-COD-TIPT IN GDO-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GDO-COD-TIPT.                               
                                                                        
           IF WSS-IND-DBCI IN WSS-VARI = 'S'                            
              MOVE OPD-COD-TINT IN OPD TO GDO-COD-TIPT IN GDO-FLD.      
                                                                        
           IF GDO-COD-TIPT IN GDO-FLD > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'INT'                   TO TAB-COD-TTAB IN TAB       
              MOVE GDO-COD-TIPT IN GDO-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD                                           
              IF MSG-COD-MENS = 'COD    NEX'                            
                 MOVE SPACES TO FRM-GLS-TIPT IN GDO-FLD                 
              ELSE                                                      
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TIPT IN GDO-FLD    
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-TIPT IN GDO-FLD.                  
                                                                        
      * EVA-FIN  06/08                                                  
      *>>>>
       FIN-VAL-GDO-COD-TIPT.
           EXIT.
       
       VAL-FRM-GLS-TIPT SECTION.
       INI-VAL-FRM-GLS-TIPT.
       FIN-VAL-FRM-GLS-TIPT.
           EXIT.
       
       VAL-GDO-SGV-TCGT SECTION.
       INI-VAL-GDO-SGV-TCGT.
      *<<<<
      * EVA-INI  06/08                                                  
                                                                        
           IF GDO-SGV-TCGT IN GDO-FLD NOT > ZEROES                      
              MOVE ZEROES TO GDO-SGV-TCGT IN GDO-FLD.                   
                                                                        
      * EVA-FIN  06/08                                                  
      *>>>>
       FIN-VAL-GDO-SGV-TCGT.
           EXIT.
       
       VAL-GDO-COD-TCGT SECTION.
       INI-VAL-GDO-COD-TCGT.
           IF GDO-COD-TCGT IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDO-COD-TCGT IN GDO-FLD.
      *<<<<<
      * EVA-INI  06/08                                                  
                                                                        
           IF GDO-COD-TCGT IN GDO-FLD > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'INT'                   TO TAB-COD-TTAB IN TAB       
              MOVE GDO-COD-TCGT IN GDO-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD                                           
              IF MSG-COD-MENS = 'COD    NEX'                            
                 MOVE SPACES TO FRM-GLS-TCGT IN GDO-FLD                 
              ELSE                                                      
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TCGT IN GDO-FLD    
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-TCGT IN GDO-FLD.                   
                                                                        
      * EVA-FIN  06/08                                                  
      *>>>>
       FIN-VAL-GDO-COD-TCGT.
           EXIT.
       
       VAL-FRM-GLS-TCGT SECTION.
       INI-VAL-FRM-GLS-TCGT.
       FIN-VAL-FRM-GLS-TCGT.
           EXIT.
       
       VAL-CON-FLD-GDO SECTION.
       INI-VAL-CON-FLD-GDO.
       FIN-VAL-CON-FLD-GDO.
           EXIT.
       
       VAL-CON-GDO SECTION.
       INI-VAL-CON-GDO.
       FIN-VAL-CON-GDO.
           EXIT.
       
       VAL-NUM-KEY-GDO SECTION.
       INI-VAL-NUM-KEY-GDO.
           PERFORM VAL-NUM-IKY-GDO.
           PERFORM VAL-NUM-MKY-GDO.
           PERFORM VAL-NUM-AKY-GDO.
       FIN-VAL-NUM-KEY-GDO.
           EXIT.
       
       VAL-NUM-IKY-GDO SECTION.
       INI-VAL-NUM-IKY-GDO.
       VAL-NUM-GDO-IIC-GTIA.
           MOVE GDO-IIC-GTIA-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDO-IIC-GTIA IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-IIC-GTIA-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-IKY-GDO.
       VAL-NUM-GDO-NUM-IGDO.
           MOVE GDO-NUM-IGDO-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDO-NUM-IGDO IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-NUM-IGDO-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-IKY-GDO.
       FIN-VAL-NUM-IKY-GDO.
           EXIT.
       
       VAL-NUM-MKY-GDO SECTION.
       INI-VAL-NUM-MKY-GDO.
       FIN-VAL-NUM-MKY-GDO.
           EXIT.
       
       VAL-NUM-AKY-GDO SECTION.
       INI-VAL-NUM-AKY-GDO.
       FIN-VAL-NUM-AKY-GDO.
           EXIT.
       
       VAL-NUM-FLD-GDO SECTION.
       INI-VAL-NUM-FLD-GDO.
       VAL-NUM-GDO-NUM-SEVE.
           MOVE GDO-NUM-SEVE-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDO-NUM-SEVE IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-NUM-SEVE-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-FLD-GDO.
       VAL-NUM-GDO-SGV-TINT.
           MOVE GDO-SGV-TINT-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GDO-SGV-TINT IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-SGV-TINT-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-FLD-GDO.
       VAL-NUM-GDO-SGV-TCGT.
           MOVE GDO-SGV-TCGT-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GDO-SGV-TCGT IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-SGV-TCGT-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-FLD-GDO.
       FIN-VAL-NUM-FLD-GDO.
           EXIT.
       
       EDT-KEY-GDO SECTION.
       INI-EDT-KEY-GDO.
           PERFORM EDT-IKY-GDO.
           PERFORM EDT-MKY-GDO.
           PERFORM EDT-AKY-GDO.
       FIN-EDT-KEY-GDO.
           EXIT.
       
       EDT-IKY-GDO SECTION.
       INI-EDT-IKY-GDO.
           IF GDO-IIC-GTIA-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-IIC-GTIA-LEN IN GDO-FLD
                GO TO FIN-EDT-IKY-GDO.
           MOVE GDO-IIC-GTIA IN GDO-FLD TO GDO-IIC-GTIA-EDT IN GDO-EDT.
           MOVE GDO-IIC-GTIA-EDT IN GDO-EDT TO 
                GDO-IIC-GTIA-ALF IN GDO-FLD.
           IF GDO-NUM-IGDO-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-NUM-IGDO-LEN IN GDO-FLD
                GO TO FIN-EDT-IKY-GDO.
           MOVE GDO-NUM-IGDO IN GDO-FLD TO GDO-NUM-IGDO-EDT IN GDO-EDT.
           MOVE GDO-NUM-IGDO-EDT IN GDO-EDT TO 
                GDO-NUM-IGDO-ALF IN GDO-FLD.
       FIN-EDT-IKY-GDO.
           EXIT.
       
       EDT-MKY-GDO SECTION.
       INI-EDT-MKY-GDO.
       FIN-EDT-MKY-GDO.
           EXIT.
       
       EDT-AKY-GDO SECTION.
       INI-EDT-AKY-GDO.
       FIN-EDT-AKY-GDO.
           EXIT.
       
       EDT-FLD-GDO SECTION.
       INI-EDT-FLD-GDO.
           IF GDO-NUM-SEVE-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-NUM-SEVE-LEN IN GDO-FLD
                GO TO FIN-EDT-FLD-GDO.
           MOVE GDO-NUM-SEVE IN GDO-FLD TO GDO-NUM-SEVE-EDT IN GDO-EDT.
           MOVE GDO-NUM-SEVE-EDT IN GDO-EDT TO 
                GDO-NUM-SEVE-ALF IN GDO-FLD.
           IF GDO-SGV-TINT-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-SGV-TINT-LEN IN GDO-FLD
                GO TO FIN-EDT-FLD-GDO.
           MOVE GDO-SGV-TINT IN GDO-FLD TO GDO-SGV-TINT-EDT IN GDO-EDT.
           MOVE GDO-SGV-TINT-EDT IN GDO-EDT TO 
                GDO-SGV-TINT-ALF IN GDO-FLD.
           IF GDO-SGV-TCGT-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-SGV-TCGT-LEN IN GDO-FLD
                GO TO FIN-EDT-FLD-GDO.
           MOVE GDO-SGV-TCGT IN GDO-FLD TO GDO-SGV-TCGT-EDT IN GDO-EDT.
           MOVE GDO-SGV-TCGT-EDT IN GDO-EDT TO 
                GDO-SGV-TCGT-ALF IN GDO-FLD.
       FIN-EDT-FLD-GDO.
           EXIT.
      *<<<<                                                                  
      *                                                                 
      * EVA-INI  06/08                                                  
       BUS-COD-NEMO SECTION.                                            
       INI-BUS-COD-NEMO.                                                
                                                                        
           MOVE 'BGL'                    TO TAB-COD-SIST FIO-SIST.      
           MOVE 'NMT'                    TO TAB-COD-TTAB IN TAB.        
           MOVE OPD-COD-VCAM IN OPD      TO WSS-COD-VCAM IN WSS-VARI.   
           MOVE WSS-COD-VCAM IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
                                                                        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
              MOVE SPACES TO WSS-GLS-NEMO IN WSS-VARI                   
              GO TO FIN-BUS-COD-NEMO                                    
           ELSE                                                         
              MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-NEMO IN WSS-VARI.     
                                                                        
           MOVE WSS-IND-NEMO IN WSS-VARI TO                             
                    WSS-IND-NCAM IN WSS-VARI.                           
           MOVE OPD-NUM-DREA IN OPD TO WSS-NUM-DDEP IN WSS-VARI.        
           MOVE OPD-NUM-MREA IN OPD TO WSS-NUM-MDEP IN WSS-VARI.        
           MOVE OPD-NUM-AREA IN OPD TO WSS-NUM-ADEP IN WSS-VARI.        
                                                                        
       FIN-BUS-COD-NEMO.                                                
           EXIT.                                                        
                                                                        
      * EVA-FIN  06/08                                                  
      *>>>>
