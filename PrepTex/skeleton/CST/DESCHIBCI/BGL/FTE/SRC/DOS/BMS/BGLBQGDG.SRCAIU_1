      *
      * BGLBQGDG
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 04:48 PM
      *
      *<<<< 
      *********************************************************
      *MANTENCIONES
      **AFRI-INI/SEP2009: NO VALIDA SI EL USUARIO ESTA VIGENTE
      *                   EN INGRESO DE UNA GARANTIA.
      *********************************************************
      **PVC-INI/MAR-2013: GARANTIAS ACTIVADAS SIN FECHA DE              
      *                   Vencimiento (52427)                           
      *********************************************************   
      *---------------------------------------------------------------
      *  AUTOR      : BEE-MPS-AFRI
      *  FECHA      : JUN-2017
      *  ETIQUETA   : *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *  PROYECTO   : ARCHIVO CON REVALORIZACIONES DE GARANTIAS FASE 2
      *  OBJETIVO   : GRABAR LOG DE COMANDO ING EN ENTIDAD GNS-LGN
      *-----------------------------------------------------------------
      *>>>>
       SET-TAG-BGLBQGDG SECTION.
       INI-SET-TAG-BGLBQGDG.
           MOVE
           '<IDNMOD NOM=$BGLBQGDG$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 04:48 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBQGDG.
           EXIT.
           
       PUT-ALL-GDG SECTION.
       INI-PUT-ALL-GDG.
           PERFORM PUT-GDG-GDG.
           PERFORM PUT-DBC-GDG.
       FIN-PUT-ALL-GDG.
           EXIT.
       
       PUT-GDG-GDG SECTION.
       INI-PUT-GDG-GDG.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GDG.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GDG
               GO TO FIN-PUT-GDG-GDG.
           MOVE GDG-CAI-GTIA IN GDG TO GDG-CAI-GTIA IN GDG-FLD.
           MOVE GDG-IIC-GTIA IN GDG TO GDG-IIC-GTIA IN GDG-FLD.
      * IDG-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GDG-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GDG-FLD.
      * IDG-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-RLCM IN GDG TO GDG-COD-RLCM IN GDG-FLD.
           MOVE GDG-COD-RLUN IN GDG TO GDG-COD-RLUN IN GDG-FLD.
           MOVE GDG-GLS-RLVR IN GDG TO GDG-GLS-RLVR IN GDG-FLD.
      * OFI-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-OFIC IN GDG TO GDG-COD-OFIC IN GDG-FLD.
      * OFI-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-VCAM IN GDG TO GDG-COD-VCAM IN GDG-FLD.
           MOVE GDG-IND-INOB IN GDG TO GDG-IND-INOB IN GDG-FLD.
           MOVE GDG-GLS-DGTA IN GDG TO GDG-GLS-DGTA IN GDG-FLD.
           MOVE GDG-IND-CBAN IN GDG TO GDG-IND-CBAN IN GDG-FLD.
           MOVE GDG-GLS-DGT1 IN GDG TO GDG-GLS-DGT1 IN GDG-FLD.
           MOVE GDG-COD-TSCN IN GDG TO GDG-COD-TSCN IN GDG-FLD.
           MOVE GDG-CIC-EJOR IN GDG TO GDG-CIC-EJOR IN GDG-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-NUM-DALZ IN GDG TO GDG-NUM-DALZ IN GDG-FLD.
           MOVE GDG-NUM-MALZ IN GDG TO GDG-NUM-MALZ IN GDG-FLD.
           MOVE GDG-NUM-SALZ IN GDG TO GDG-NUM-SALZ IN GDG-FLD.
           MOVE GDG-NUM-AALZ IN GDG TO GDG-NUM-AALZ IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-NUM-DING IN GDG TO GDG-NUM-DING IN GDG-FLD.
           MOVE GDG-NUM-MING IN GDG TO GDG-NUM-MING IN GDG-FLD.
           MOVE GDG-NUM-SING IN GDG TO GDG-NUM-SING IN GDG-FLD.
           MOVE GDG-NUM-AING IN GDG TO GDG-NUM-AING IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-NUM-DVTO IN GDG TO GDG-NUM-DVTO IN GDG-FLD.
           MOVE GDG-NUM-MVTO IN GDG TO GDG-NUM-MVTO IN GDG-FLD.
           MOVE GDG-NUM-SVTO IN GDG TO GDG-NUM-SVTO IN GDG-FLD.
           MOVE GDG-NUM-AVTO IN GDG TO GDG-NUM-AVTO IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-NUM-DEST IN GDG TO GDG-NUM-DEST IN GDG-FLD.
           MOVE GDG-NUM-MEST IN GDG TO GDG-NUM-MEST IN GDG-FLD.
           MOVE GDG-NUM-SEST IN GDG TO GDG-NUM-SEST IN GDG-FLD.
           MOVE GDG-NUM-AEST IN GDG TO GDG-NUM-AEST IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-EST2 IN GDG TO GDG-COD-EST2 IN GDG-FLD.
           MOVE GDG-IND-GTAC IN GDG TO GDG-IND-GTAC IN GDG-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-NUM-DSOL IN GDG TO GDG-NUM-DSOL IN GDG-FLD.
           MOVE GDG-NUM-MSOL IN GDG TO GDG-NUM-MSOL IN GDG-FLD.
           MOVE GDG-NUM-SSOL IN GDG TO GDG-NUM-SSOL IN GDG-FLD.
           MOVE GDG-NUM-ASOL IN GDG TO GDG-NUM-ASOL IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-IND-EST1 IN GDG TO GDG-IND-EST1 IN GDG-FLD.
           MOVE GDG-COD-TGCM IN GDG TO GDG-COD-TGCM IN GDG-FLD.
           MOVE GDG-COD-LGTA IN GDG TO GDG-COD-LGTA IN GDG-FLD.
           MOVE GDG-COD-EST1 IN GDG TO GDG-COD-EST1 IN GDG-FLD.
           MOVE GDG-COD-MALZ IN GDG TO GDG-COD-MALZ IN GDG-FLD.
           MOVE GDG-IND-ECRS IN GDG TO GDG-IND-ECRS IN GDG-FLD.
           MOVE GDG-COD-RERS IN GDG TO GDG-COD-RERS IN GDG-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-NUM-DVES IN GDG TO GDG-NUM-DVES IN GDG-FLD.
           MOVE GDG-NUM-MVES IN GDG TO GDG-NUM-MVES IN GDG-FLD.
           MOVE GDG-NUM-SVES IN GDG TO GDG-NUM-SVES IN GDG-FLD.
           MOVE GDG-NUM-AVES IN GDG TO GDG-NUM-AVES IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-IND-ECRT IN GDG TO GDG-IND-ECRT IN GDG-FLD.
           MOVE GDG-COD-RERT IN GDG TO GDG-COD-RERT IN GDG-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-NUM-DVET IN GDG TO GDG-NUM-DVET IN GDG-FLD.
           MOVE GDG-NUM-MVET IN GDG TO GDG-NUM-MVET IN GDG-FLD.
           MOVE GDG-NUM-SVET IN GDG TO GDG-NUM-SVET IN GDG-FLD.
           MOVE GDG-NUM-AVET IN GDG TO GDG-NUM-AVET IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-NUM-IPRO IN GDG TO GDG-NUM-IPRO IN GDG-FLD.
           MOVE GDG-VRF-IPRO IN GDG TO GDG-VRF-IPRO IN GDG-FLD.
           MOVE GDG-IND-IPRO IN GDG TO GDG-IND-IPRO IN GDG-FLD.
           MOVE GDG-GLS-IPRO IN GDG TO GDG-GLS-IPRO IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-GLS-NOMP IN GDG TO GDG-GLS-NOMP IN GDG-FLD.
           MOVE GDG-COD-GACS IN GDG TO GDG-COD-GACS IN GDG-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFIC IN GDG-FLD > SPACES
               MOVE GDG-COD-OFIC IN GDG-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-VCAM IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-VCAM IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCAM IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-EST2 IN GDG-FLD > SPACES
               MOVE 'BGL' TO TAB-COD-SIST
               MOVE 'ES2 ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-EST2 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-EST2 IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EST2 IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-TGCM IN GDG-FLD > SPACES
               MOVE 'BGL' TO TAB-COD-SIST
               MOVE 'GCM ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-TGCM IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TGCM IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TGCM IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-LGTA IN GDG-FLD > SPACES
               MOVE 'BGL' TO TAB-COD-SIST
               MOVE 'LIM ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-LGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-LGTA IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LGTA IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-EST1 IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ALZ ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-EST1 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-EST1 IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EST1 IN GDG-FLD.
      *<<<< FIN_PUT_GDG_GDG                                             
      *<<<< FMT_CHI                                                     
      *BUS-TAB busca glosa de codigo en tabla                           
           IF GDG-TIP-CGTA IN GDG-FLD > SPACES                          
               MOVE 'TAB' TO TAB-COD-SIST                               
               MOVE 'AUX ' TO TAB-COD-TTAB IN TAB                       
               MOVE GDG-TIP-CGTA IN GDG-FLD TO WSS-TIP-CGTA IN WSS-VARI 
               MOVE GDG-STP-CGTA IN GDG-FLD TO WSS-STP-CGTA IN WSS-VARI 
               MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB     
               PERFORM BUS-TAB                                          
      *MHM-INI 23-OCT-2003                                              
      *         MOVE TAB-GLS-DESC IN TAB TO                             
      *              FRM-GLS-CGTA IN GDG-FLD                            
      *     ELSE                                                        
      *         MOVE SPACES TO FRM-GLS-CGTA IN GDG-FLD.                 
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.                 
                                                                        
           IF GDG-TIP-CGTA IN GDG-FLD > SPACES                          
               MOVE 'TAB'                   TO TAB-COD-SIST             
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB      
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB      
               MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.                 
                                                                        
           MOVE WSS-GLS-CGTA TO CPT-STRN.                               
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GDG-FLD.                    
      *MHM-FIN 23-OCT-2003                                              
      *>>>>                                                             
      *BUS-USR busca usuario en tablas                                  
           IF GDG-CIC-EJOR IN GDG-FLD > SPACES                          
               MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR      
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN GDG-FLD      
           ELSE                                                         
               MOVE SPACES              TO FRM-GLS-EJOR IN GDG-FLD.     
      *-------------------------------------------------------------*   
      *BUS-TAB busca glosa de codigo en tabla                           
           IF GDG-IND-EST1 IN GDG-FLD > SPACES                          
             MOVE 'BGL' TO TAB-COD-SIST                                 
             MOVE 'ES1'                   TO TAB-COD-TTAB IN TAB        
             MOVE GDG-IND-EST1 IN GDG-FLD TO TAB-COD-CTAB IN TAB        
             PERFORM BUS-TAB                                            
             MOVE TAB-COD-DAT2 IN TAB(1) TO WSS-ES1-1 IN CMA-VARI       
             MOVE TAB-COD-DAT2 IN TAB(2) TO WSS-ES1-2 IN CMA-VARI       
             MOVE TAB-COD-DAT2 IN TAB(3) TO WSS-ES1-3 IN CMA-VARI       
             MOVE TAB-COD-DAT2 IN TAB(4) TO WSS-ES1-4 IN CMA-VARI       
             MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-IND-EST1 IN GDG-FLD.   
                                                                        
                                                                        
                                                                        
           MOVE GDG-IND-EGAP IN GDG TO GAR-IND-EGAP IN CMA-VARI.        
           MOVE GDG-IND-GTAC IN GDG TO GAR-IND-GTAC IN CMA-VARI.        
           MOVE GDG-COD-EST2 IN GDG TO WSS-ES2-ANT  IN CMA-VARI.        
           MOVE GDG-IND-EST1 IN GDG TO WSS-EST-ANT  IN CMA-VARI.        
      *MHM-INI 29-OCT-2003                                              
           MOVE GDG-CIC-UING IN GDG TO CMA-CIC-UING IN CMA-VARI.        
      *MHM-INI 29-OCT-2003                                              
                                                                        
      * Busca Glosa Tabla Real/no Real                                  
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
                MOVE 'TAG    NEX' TO MSG-COD-MENS                       
                MOVE 'BGL' TO MSG-COD-SIST                              
                PERFORM GET-MSG                                         
           ELSE                                                         
               MOVE SPACES  TO MSG-COD-MENS                             
               MOVE 'BGL'   TO TAB-COD-SIST                             
               MOVE 'RAL'   TO TAB-COD-TTAB IN TAB                      
               MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB          
                                                                        
                PERFORM BUS-TAB                                         
                IF MSG-COD-MENS = SPACES                                
                    MOVE TAB-GLS-DESC IN TAB TO                         
                         FRM-GLS-TREA IN GDG-FLD                        
                ELSE                                                    
                    MOVE SPACES TO FRM-GLS-TREA IN GDG-FLD.             
                                                                        
      *<<<< GEN_BCI                                                     
           PERFORM EXA-DAP.                                             
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND                           
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-CGTA IN GDG-FLD AND    
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-CGTA IN GDG-FLD        
      *       Es Dep Plazo Propio                                       
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI                      
               PERFORM BUS-GDO-OPD                                      
               MOVE OPD-CAI-IOPD IN DAP-VARI TO FRM-CAI-IOPD IN GDG-FLD 
               MOVE OPD-IIC-IOPD IN DAP-VARI TO FRM-IIC-IOPD IN GDG-FLD 
           ELSE                                                         
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI                      
               MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD                   
               MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.                  
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD,                      
                          FRM-GLS-DEUD IN GDG-FLD.                      
                                                                        
           IF GDG-IND-EST1 IN GDG-FLD > '19'                            
               MOVE GDG-COD-ATRN IN GDG TO USR-COD-USER IN USR          
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-ATRN IN GDG-FLD.     
                                                                        
      *BUS-TAB busca glosa de codigo en tabla                           
           IF GDG-COD-MALZ IN GDG-FLD > SPACES                          
               MOVE 'BGL' TO TAB-COD-SIST                               
               MOVE 'MAL' TO TAB-COD-TTAB IN TAB                        
               MOVE GDG-COD-MALZ IN GDG-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-MALZ IN GDG-FLD                             
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-MALZ IN GDG-FLD.                  
                                                                        
      *BUS-USR busca usuario en tablas                                  
           IF GDG-COD-RERS IN GDG-FLD > SPACES                          
               MOVE GDG-COD-RERS IN GDG-FLD TO USR-COD-USER IN USR      
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RERS IN GDG-FLD      
           ELSE                                                         
               MOVE SPACES              TO FRM-GLS-RERS IN GDG-FLD.     
                                                                        
      *BUS-USR busca usuario en tablas                                  
           IF GDG-COD-RERT IN GDG-FLD > SPACES                          
               MOVE GDG-COD-RERT IN GDG-FLD TO USR-COD-USER IN USR      
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RERT IN GDG-FLD      
           ELSE                                                         
               MOVE SPACES              TO FRM-GLS-RERT IN GDG-FLD.     
      *>>>>                                                             
           MOVE TAG-IND-SVTO IN TAG TO GAR-IND-SVTO IN CMA-VARI.        
      *                                                                 
      *AFRI-INI-MAR2007    [EVA]                                        
      * Mover nombre propietario.                                       
           IF GDG-IIC-ICLI IN GDG > ZEROES                              
               MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DBC                                      
               IF FIO-STAT-OKS                                          
      *<<<< FMT_CHI                                                     
                  MOVE DBC-NUM-ICLI IN DBC TO GDG-NUM-IPRO IN GDG-FLD   
                  MOVE DBC-VRF-ICLI IN DBC TO GDG-VRF-IPRO IN GDG-FLD   
      *>>>>                                                             
                  MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI          
                  MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI          
                                                                        
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                  
                  PERFORM CPT-BLKS                                      
                  MOVE CPT-STRN TO GDG-GLS-NOMP IN GDG-FLD              
                  MOVE CPT-STRN TO CNE-GDG-GLS-NOMP                     
                ELSE                                                    
                  MOVE SPACES TO GDG-GLS-NOMP IN GDG-FLD                
                  MOVE SPACES  TO CNE-GDG-GLS-NOMP                      
           ELSE                                                         
              MOVE GDG-GLS-NOMP IN GDG TO GDG-GLS-NOMP IN GDG-FLD       
              MOVE GDG-GLS-NOMP IN GDG TO CNE-GDG-GLS-NOMP.             
      *AFRI-FIN-MAR2007                                                 
      *>>>>                                                             
       FIN-PUT-GDG-GDG.
           EXIT.
       
       PUT-DBC-GDG SECTION.
       INI-PUT-DBC-GDG.
      *<<<< INI_PUT_DBC_GDG
           IF DBC-IIC-ICLI IN CMA-VARI > ZEROES
               MOVE DBC-KEY-IDBC IN CMA-VARI TO DBC-CIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
           ELSE
               MOVE FIO-STAT-NEX TO PGM-STAT-DBC.
      *>>>>
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-GDG.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-GDG
               GO TO FIN-PUT-DBC-GDG.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN GDG-FLD.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN GDG-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GDG-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN GDG-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
      *<<<< FIN_PUT_DBC_GDG
      *
           MOVE DBC-CAI-ICLI IN DBC TO CNE-DBC-CAI-ICLI.
           MOVE DBC-IIC-ICLI IN DBC TO CNE-DBC-IIC-ICLI.

           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *
           PERFORM GET-CUR-GDD-MUL.
           IF WSS-IND-CMUL = 'M'
      *RRM    IF SCR-CMND NOT = 'ING'  AND SCR-CMND NOT = 'MOD'
              IF SCR-CMND NOT = 'ING'
                 MOVE 'MULTIPLES DEUDORES ' TO DBC-GLS-NOMC IN GDG-FLD
      *<<<<
                 MOVE ZEROES                TO DBC-NUM-ICLI IN GDG-FLD
                 MOVE 'M'                   TO DBC-IND-ICLI IN GDG-FLD
                 MOVE SPACES                TO DBC-GLS-ICLI IN GDG-FLD
                 MOVE SPACES                TO DBC-VRF-ICLI IN GDG-FLD
      *>>>>
              GO TO FIN-PUT-DBC-GDG.                                    
      *>>>>                                                             
       FIN-PUT-DBC-GDG.
           EXIT.
       
       KEY-ALL-GDG SECTION.
       INI-KEY-ALL-GDG.
           PERFORM KEY-GDG-GDG.
           PERFORM KEY-DBC-GDG.
       FIN-KEY-ALL-GDG.
           EXIT.
       
       KEY-GDG-GDG SECTION.
       INI-KEY-GDG-GDG.
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDG-IIC-GTIA IN GDG.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GDG-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GDG-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
       FIN-KEY-GDG-GDG.
           EXIT.
       
       KEY-DBC-GDG SECTION.
       INI-KEY-DBC-GDG.
      *<<<< INI_KEY_DBC_GDG
      *
           MOVE CNE-GDD-CIC-ICLI TO DBC-IDC-ICLI IN DBC.
           MOVE CNE-DBC-GLS-NOMC TO DBC-GLS-NOMC IN DBC.
           GO TO FIN-KEY-DBC-GDG.
      *>>>>
           MOVE DBC-GLS-NOMC IN GDG-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-GDG.
           EXIT.
       
       SCR-CLRA-GDG SECTION.
       INI-SCR-CLRA-GDG.
           PERFORM CLR-KEY-GDG.
           PERFORM CLR-FLD-GDG.
       FIN-SCR-CLRA-GDG.
           EXIT.
       
       CLR-KEY-GDG SECTION.
       INI-CLR-KEY-GDG.
           MOVE SPACES TO GDG-CAI-GTIA IN GDG-FLD.
           MOVE ZEROES TO GDG-IIC-GTIA IN GDG-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN GDG-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GDG-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GDG-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      *<<<< FIN_CLR_KEY_GDG
      *<<<< GEN_BCI
      *MHM-INI 03-NOV-2004
           IF SCR-CMND NOT = 'ING'
               GO TO CNT-CLR-KEY-GDG.
      *MHM-FIN 03-NOV-2004
           MOVE 'BGL' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE '001' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-IND-VIGE IN TAB NOT = 'S'
      *        FLB: version 'B'anco
      *         MOVE 'B' TO SCR-IND-V001
               MOVE SPACES TO MSG-COD-MENS
               MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD
      *INI-AFRI/MAY-2005
               IF SCR-HDR-MRCA = 'BCS'
                  MOVE '0800' TO GDG-CAI-GTIA IN GDG-FLD
               ELSE
                  MOVE '0500' TO GDG-CAI-GTIA IN GDG-FLD
               END-IF
      *FIN-AFRI/MAY-2005
               MOVE 0  TO GDG-CAI-GTIA-LEN IN GDG-FLD
               MOVE -1 TO GDG-IIC-GTIA-LEN IN GDG-FLD.
      *     ELSE
      *        FLB: version 'C'onsist
      *         MOVE 'C' TO SCR-IND-V001.
      *>>>>
      *MHM-INI 03-NOV-2004                                              
       CNT-CLR-KEY-GDG.                                                 
      *MHM-FIN 03-NOV-2004                                              
            MOVE SPACES TO CNE-DBC-GLS-NOMC.                            
            MOVE SPACES TO CNE-DBC-CAI-ICLI.                            
            MOVE ZEROES TO CNE-DBC-IIC-ICLI.                            
            MOVE SPACES TO CNE-GDG-GLS-NOMP.                            
            MOVE SPACES TO CNE-GDG-CAI-ICLI.                            
            MOVE ZEROES TO CNE-GDG-IIC-ICLI.                            
      *>>>>                                                             
       FIN-CLR-KEY-GDG.
           EXIT.
       
       CLR-FLD-GDG SECTION.
       INI-CLR-FLD-GDG.
           MOVE SPACES TO FRM-GLS-TREA IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GDG-FLD.
           MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD.
           MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-EJOR IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-EST2 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-IND-EST1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-TGCM IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-LGTA IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-EST1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-MALZ IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ATRN IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-RERS IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-RERT IN GDG-FLD.
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-DEUD IN GDG-FLD.
           PERFORM CLR-GDG-GDG.
           PERFORM CLR-DBC-GDG.
       FIN-CLR-FLD-GDG.
           EXIT.
       
       CLR-GDG-GDG SECTION.
       INI-CLR-GDG-GDG.
           MOVE SPACES TO GDG-COD-RLCM IN GDG-FLD.
           MOVE SPACES TO GDG-COD-RLUN IN GDG-FLD.
           MOVE SPACES TO GDG-GLS-RLVR IN GDG-FLD.
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GDG-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GDG-FLD.
           MOVE SPACES TO GDG-IND-INOB IN GDG-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GDG-FLD.
           MOVE SPACES TO GDG-IND-CBAN IN GDG-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-TSCN IN GDG-FLD.
           MOVE SPACES TO GDG-CIC-EJOR IN GDG-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FALZ IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FING IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FVTO IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FEST IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-EST2 IN GDG-FLD.
           MOVE SPACES TO GDG-IND-GTAC IN GDG-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FSOL IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-IND-EST1 IN GDG-FLD.
           MOVE SPACES TO GDG-COD-TGCM IN GDG-FLD.
           MOVE SPACES TO GDG-COD-LGTA IN GDG-FLD.
           MOVE SPACES TO GDG-COD-EST1 IN GDG-FLD.
           MOVE SPACES TO GDG-COD-MALZ IN GDG-FLD.
           MOVE SPACES TO GDG-IND-ECRS IN GDG-FLD.
           MOVE SPACES TO GDG-COD-RERS IN GDG-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FVES IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-IND-ECRT IN GDG-FLD.
           MOVE SPACES TO GDG-COD-RERT IN GDG-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FVET IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-NUM-IPRO IN GDG-FLD.
           MOVE SPACES TO GDG-VRF-IPRO IN GDG-FLD.
           MOVE SPACES TO GDG-IND-IPRO IN GDG-FLD.
           MOVE SPACES TO GDG-GLS-IPRO IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-GLS-NOMP IN GDG-FLD.
           MOVE SPACES TO GDG-COD-GACS IN GDG-FLD.
       FIN-CLR-GDG-GDG.
           EXIT.
       
       CLR-DBC-GDG SECTION.
       INI-CLR-DBC-GDG.
       FIN-CLR-DBC-GDG.
           EXIT.
       
       FST-KEY-GDG SECTION.
       INI-FST-KEY-GDG.
           MOVE -1 TO GDG-CAI-GTIA-LEN IN GDG-FLD.
       FIN-FST-KEY-GDG.
           EXIT.
       
       FST-FLD-GDG SECTION.
       INI-FST-FLD-GDG.
      *<<<< INI_FST_FLD_GDG
           MOVE 0 TO DBC-NUM-ICLI-LEN IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-EST1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-EST2-ATR IN GDG-FLD.
           IF NOT (CMA-IND-DAP IN CMA-VARI = 'S' AND
                   SCR-CCPP = 'ING')
      *       No Es o No Ingresa Dep Plazo Propio
               MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-DEUD-ATR IN GDG-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD.

           IF SCR-CCPP = 'ING'
               MOVE SPACES TO WSS-EST-ANT IN CMA-VARI
      *         PERFORM ANL-HBL-COD-GRA
               PERFORM ANL-HBL-FEC-VTO
               MOVE -1           TO DBC-NUM-ICLI-LEN    IN GDG-FLD
               GO TO FIN-FST-FLD-GDG.

           IF SCR-CCPP = 'MOD'
               PERFORM ANL-HBL-DBC-ICLI
               PERFORM ANL-HBL-FEC-VTO
               IF SCR-CMND = 'MOD'
      *MHM-INI 16-OCT-2003
      *             MOVE -1 TO GDG-COD-OFIC-LEN IN GDG-FLD
                   MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
      *MHM-INI 16-OCT-2003
                   GO TO FIN-FST-FLD-GDG.

      *     MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FSOL-ATR IN GDG-FLD.

           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.

           IF SCR-CMND = 'ALZ' OR SCR-CMND = 'EJE'
      *MHM-INI 13-OCT-2003
               MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-RLCM-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-RLUN-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-RLVR-ATR IN GDG-FLD
      *MHM-FIN 13-OCT-2003
               MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-ATR IN GDG-FLD
      *ADA-INI 20-DIC-2002
               MOVE FRM-CPIM-AEY TO GDG-COD-TGCM-ATR IN GDG-FLD
      *ADA-FIN 20-DIC-2002
               MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-NUM-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-VRF-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD
               IF SCR-CMND = 'ALZ'
      * FLB
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *            MOVE FRM-CPIM-UBY TO GDG-FEC-FALZ-ATR IN GDG-FLD
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
                   MOVE FRM-CPIM-UBY TO GDG-COD-EST1-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD
      * FIN
      *MHM-INI 15-OCT-2003
      *             MOVE -1 TO GDG-IND-EST1-LEN IN GDG-FLD
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *            MOVE -1 TO GDG-FEC-FALZ-LEN IN GDG-FLD
                   MOVE WSS-CTE-M1 TO GDG-IND-EST1-LEN IN GDG-FLD
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *MHM-INI 15-OCT-2003
      *             MOVE -1 TO GDG-IND-EST1-LEN IN GDG-FLD              
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *            MOVE -1 TO GDG-FEC-FALZ-LEN IN GDG-FLD               
                   MOVE WSS-CTE-M1 TO GDG-IND-EST1-LEN IN GDG-FLD       
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *MHM-FIN 15-OCT-2003
               ELSE
               IF SCR-CMND = 'EJE'
                   MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD
                   MOVE -1 TO GDG-COD-EST2-LEN IN GDG-FLD
               ELSE
                   NEXT SENTENCE
           ELSE
           IF SCR-CMND = 'MGA'
      *MHM-INI 14-OCT-2003
      *         MOVE -1 TO GDG-GLS-DGTA-LEN IN GDG-FLD
               MOVE -1 TO GDG-COD-RLCM-LEN IN GDG-FLD
      *MHM-FIN 14-OCT-2003
      *MHM-INI 13-OCT-2003
               MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-IND-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-GLS-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-NUM-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-VRF-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-IND-ECRS-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-COD-RERS-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-FEC-FVES-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-IND-ECRT-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-COD-RERT-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-FEC-FVET-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-COD-GACS-ATR IN GDG-FLD
      *MHM-FIN 13-OCT-2003
           ELSE
           IF (SCR-CMND = 'AGA' OR SCR-CMND = 'ACE')
               MOVE -1 TO GDG-GLS-MENS-LEN IN GDG-FLD.

           GO TO FIN-FST-FLD-GDG.
       ANL-HBL-DBC-ICLI.
           IF MULTIPLES-GDD

               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       ANL-HBL-COD-GRA.
      *         IF GAR-COD-GRA IN TAG = 'N'
      *             MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR IN GDG-FLD
      *             IF SCR-CCPP = 'ING'
      *                 MOVE SPACES TO GDG-COD-GRA IN GDG-FLD.
       ANL-HBL-FEC-VTO.
           IF GAR-IND-SVTO IN CMA-VARI = 'N'
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD
               IF SCR-CCPP = 'ING'
                   MOVE ZEROES TO GDG-NUM-SVTO IN GDG-FLD
                   MOVE ZEROES TO GDG-NUM-AVTO IN GDG-FLD
                   MOVE ZEROES TO GDG-NUM-MVTO IN GDG-FLD
                   MOVE ZEROES TO GDG-NUM-DVTO IN GDG-FLD.
       FIN-ANL-HBL-FEC-VTO.
      *>>>>
      *>>>>                                                             
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN GDG-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
      *<<<< FIN_FST_FLD_GDG
      *>>>>
       FIN-FST-FLD-GDG.
           EXIT.
       
       PRO-KEY-GDG SECTION.
       INI-PRO-KEY-GDG.
           PERFORM PRO-IKY-GDG.
           PERFORM PRO-AKY-GDG.
           PERFORM PRO-MKY-GDG.
       FIN-PRO-KEY-GDG.
           EXIT.
       
       PRO-IKY-GDG SECTION.
       INI-PRO-IKY-GDG.
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-ATR IN GDG-FLD.
      * IDG-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO GDG-TIP-CGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-STP-CGTA-ATR IN GDG-FLD.
      * IDG-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-IKY-GDG.
           EXIT.
       
       PRO-MKY-GDG SECTION.
       INI-PRO-MKY-GDG.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-MKY-GDG.
           EXIT.
       
       PRO-AKY-GDG SECTION.
       INI-PRO-AKY-GDG.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       FIN-PRO-AKY-GDG.
           EXIT.
       
       UNP-KEY-GDG SECTION.
       INI-UNP-KEY-GDG.
           PERFORM UNP-IKY-GDG.
           PERFORM UNP-AKY-GDG.
           PERFORM UNP-MKY-GDG.
       FIN-UNP-KEY-GDG.
           EXIT.
       
       UNP-IKY-GDG SECTION.
       INI-UNP-IKY-GDG.
           MOVE FRM-CPIM-UBY TO GDG-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GDG-IIC-GTIA-ATR.
      * IDG-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-TIP-CGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-STP-CGTA-ATR IN GDG-FLD.
      * IDG-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
      *<<<< FIN_UNP_IKY_GDG
      *MHM-INI 04-NOV-2004
      **MHM-INI 12-NOV-2003
      *     MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR.
      **MHM-FIN 12-NOV-2003
      *MHM-FIN 04-NOV-2004
      *>>>>
       FIN-UNP-IKY-GDG.
           EXIT.
       
       UNP-MKY-GDG SECTION.
       INI-UNP-MKY-GDG.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-MKY-GDG.
           EXIT.
       
       UNP-AKY-GDG SECTION.
       INI-UNP-AKY-GDG.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-GDG.
           EXIT.
       
       UNP-FLD-GDG SECTION.
       INI-UNP-FLD-GDG.
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-DEUD-ATR IN GDG-FLD.
           PERFORM UNP-GDG-GDG.
           PERFORM UNP-DBC-GDG.
       FIN-UNP-FLD-GDG.
           EXIT.
       
       UNP-GDG-GDG SECTION.
       INI-UNP-GDG-GDG.
           MOVE FRM-CPIM-UBY TO GDG-COD-RLCM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-RLUN-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-GLS-RLVR-ATR IN GDG-FLD.
      * OFI-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-COD-OFIC-ATR IN GDG-FLD.
      * OFI-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-COD-VCAM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-INOB-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-GLS-DGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-CBAN-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-GLS-DGT1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-CIC-EJOR-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FVTO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FEST-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FSOL-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-EST1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-TGCM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-LGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-EST1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-MALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-ECRS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-RERS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FVES-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-ECRT-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-RERT-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FVET-ATR IN GDG-FLD.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-NUM-IPRO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-VRF-IPRO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-IPRO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-GLS-IPRO-ATR IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-GACS-ATR IN GDG-FLD.
      *<<<< FIN_UNP_GDG_GDG
      *
           IF SCR-CMND NOT = 'EJE' AND
              SCR-CMND NOT = 'CAD' AND
              SCR-CMND NOT = 'CAN'
      *<<<< FMT_CHI
              AND SCR-CMND NOT = 'ALZ'
      *>>>>
              MOVE FRM-CPIM-AEY TO GDG-COD-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-COD-EST1-STP.                    
                                                                        
           IF SCR-CMND = 'ING'                                          
               MOVE '05'         TO GDG-IND-EST1 IN GDG-FLD             
      *                                                                 
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-STP.                    
      *>>>>                                                             
       FIN-UNP-GDG-GDG.
           EXIT.
       
       UNP-DBC-GDG SECTION.
       INI-UNP-DBC-GDG.
       FIN-UNP-DBC-GDG.
           EXIT.
       
       VAL-KEY-GDG SECTION.
       INI-VAL-KEY-GDG.
           PERFORM VAL-IKY-GDG.
           PERFORM VAL-MKY-GDG.
           PERFORM VAL-AKY-GDG.
       FIN-VAL-KEY-GDG.
           EXIT.
       
       VAL-IKY-GDG SECTION.
       INI-VAL-IKY-GDG.
           PERFORM VAL-GDG-CAI-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-CAI-GTIA-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
           PERFORM VAL-GDG-IIC-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IIC-GTIA-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
      * IDG-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-TIP-CGTA-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-STP-CGTA-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
      * IDG-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-IKY-GDG.
           EXIT.
       
       VAL-MKY-GDG SECTION.
       INI-VAL-MKY-GDG.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-MKY-GDG.
           EXIT.
       
       VAL-AKY-GDG SECTION.
       INI-VAL-AKY-GDG.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN GDG-FLD
                GO TO FIN-VAL-AKY-GDG.
       FIN-VAL-AKY-GDG.
           EXIT.
       
       VAL-GDG-CAI-GTIA SECTION.
       INI-VAL-GDG-CAI-GTIA.
           IF GDG-CAI-GTIA IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-CAI-GTIA IN GDG-FLD.
       FIN-VAL-GDG-CAI-GTIA.
           EXIT.
       
       VAL-GDG-IIC-GTIA SECTION.
       INI-VAL-GDG-IIC-GTIA.
       FIN-VAL-GDG-IIC-GTIA.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
           IF DBC-GLS-NOMC IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-NOMC IN GDG-FLD.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
      *<<<< DBC_NUM_ICLI
      *MHM-INI 19-OCT-2002
           IF SCR-CMND = 'ING'
      *MHM-FIN 19-OCT-2002
             IF DBC-NUM-ICLI IN GDG-FLD NOT > ZEROES

                   PERFORM ERR-GLS
                   GO TO FIN-VAL-DBC-NUM-ICLI.
      *>>>>
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
      *<<<< INI_DBC_VRF_ICLI
               MOVE SPACES TO MSG-COD-MENS.
      *>>>>
           IF DBC-VRF-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI                                                
      *<<<< FMT_CHI                                                     
           IF SCR-CMND = 'ING'                                          
      *>>>>                                                             
           IF DBC-IND-ICLI IN GDG-FLD = 'M'                             
               MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD                   
               MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD                   
               MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD                   
               MOVE 'BGL'          TO MSG-COD-SIST                      
               MOVE 'GDGMDDIRNO'   TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE FRM-POS-CURS TO DBC-IND-ICLI-LEN IN GDG-FLD         
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DBC-VRF-ICLI.                              
                                                                        
           IF MSG-COD-MENS NOT > SPACES AND                             
              DBC-NUM-ICLI IN GDG-FLD NOT = ZEROES                      
               MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC      
               MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC      
               MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC      
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GET-CLI                                          
               MOVE FIO-STAT TO PGM-STAT-DBC                            
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'TAB'        TO MSG-COD-SIST                    
                   MOVE 'CLI    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDG-FLD         
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
               ELSE                                                     
               IF MSG-GLS-DESC > SPACES                                 
                      MOVE MSG-GLS-DESC TO FRM-MENS                     
                      MOVE FRM-SUAR-MAL TO FRM-SUAR                     
                      MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN              
                      PERFORM CPT-BLKS                                  
                      MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD          
                      GO TO FIN-VAL-DBC-VRF-ICLI      
               ELSE                                                     
      *<<<< GEN_BCI                                                     
                   IF SCR-CMND NOT = 'ING' AND
                      SCR-CMND NOT = 'MOD' AND
                      SCR-CMND NOT = 'MGA'
                      GO TO FIN-VAL-DBC-VRF-ICLI
                   ELSE
                      MOVE DBC-COD-OFIC IN DBC TO                       
                           GDG-COD-OFIC IN GDG-FLD                      
                      MOVE DBC-COD-EJEC IN DBC TO                       
                           GDG-CIC-EJOR IN GDG-FLD                      
      *>>>>                                                             
                   MOVE DBC-CAI-ICLI IN DBC TO                          
                        CNE-DBC-CAI-ICLI                                
                   MOVE DBC-IIC-ICLI IN DBC TO                          
                        CNE-DBC-IIC-ICLI                                
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.            
      *>>>>                                                             
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN GDG-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN GDG-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN GDG-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN GDG-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN GDG-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN GDG-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDG-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.
           IF GDG-TIP-CGTA IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-CGTA IN GDG-FLD.
       FIN-VAL-GDG-TIP-CGTA.
           EXIT.

       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.
           IF GDG-STP-CGTA IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-CGTA IN GDG-FLD.
      *<<<<
           IF SCR-CCPP NOT = 'ING'                                      
               GO TO FIN-VAL-GDG-STP-CGTA.                              
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB'  TO TAB-COD-SIST.                                 
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.                          
           MOVE GDG-TIP-CGTA IN GDG-FLD  TO WSS-TIP-CGTA IN WSS-VARI.   
           MOVE GDG-STP-CGTA IN GDG-FLD  TO WSS-STP-CGTA IN WSS-VARI.   
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAG-COD-AGTA IN TAG.        
           MOVE TAG-COD-AGTA IN TAG      TO TAB-COD-CTAB IN TAB.        
                                                                        
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT = SPACES                                 
              MOVE SPACES TO CMA-CIC-TGAR IN CMA-VARI                   
              MOVE SPACES TO FRM-GLS-CGTA IN GDG-FLD                    
                GO TO FIN-VAL-GDG-STP-CGTA.                             
                                                                        
           MOVE TAB-CIC-CTAB IN TAB TO CMA-CIC-TGAR IN CMA-VARI.        
      *MHM-INI 23-OCT-2003                                              
      *     MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CGTA IN GDG-FLD.        
           MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI.    
                                                                        
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.         
           MOVE SPACES                  TO TAB-COD-CTAB IN TAB.         
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOPE IN WSS-VARI     
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.                 
                                                                        
           MOVE WSS-GLS-CGTA TO CPT-STRN.                               
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GDG-FLD.                    
      *MHM-FIN 23-OCT-2003                                              
                                                                        
      * Busca Glosa Tabla Real/no Real                                  
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
                MOVE 'TAG    NEX' TO MSG-COD-MENS                       
                MOVE 'BGL' TO MSG-COD-SIST                              
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
                GO TO FIN-VAL-GDG-STP-CGTA.                             
      *Valida indicador Tipo                                            
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE 'BGL'               TO TAB-COD-SIST.                    
           MOVE 'RAL'               TO TAB-COD-TTAB IN TAB.             
           MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TREA IN GDG-FLD       
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-TREA IN GDG-FLD.                   
                                                                        
      *>>>>
       FIN-VAL-GDG-STP-CGTA.
           EXIT.
      * IDG-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CON-KEY-GDG SECTION.
       INI-VAL-CON-KEY-GDG.
      *<<<< INI_VAL_CON_KEY_GDG
           IF FRM-FFLD = FRM-FFLD-PF8 OR
              FRM-FFLD = FRM-FFLD-PF7 OR
              FRM-FFLD = FRM-FFLD-PF5 OR
              FRM-FFLD = FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-GDG.
      *>>>>
           IF     GDG-CAI-GTIA IN GDG-FLD NOT > SPACES 
              AND GDG-IIC-GTIA IN GDG-FLD NOT > ZEROES 
              AND DBC-GLS-NOMC IN GDG-FLD NOT > SPACES 
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
              AND DBC-NUM-ICLI IN GDG-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN GDG-FLD NOT > SPACES
              AND DBC-IND-ICLI IN GDG-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN GDG-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
              AND GDG-TIP-CGTA IN GDG-FLD NOT > SPACES
              AND GDG-STP-CGTA IN GDG-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDG.
       FIN-VAL-CON-KEY-GDG.
           EXIT.
       
       VAL-CON-IKY-GDG SECTION.
       INI-VAL-CON-IKY-GDG.
      *<<<< INI_VAL_CON_IKY_GDG

           MOVE TAG-IND-SVTO IN TAG TO GAR-IND-SVTO IN CMA-VARI.
      *<<<< GEN_BCI

           MOVE TAG-SGV-PPON IN TAG TO GAR-SGV-PPCT IN CMA-VARI.
           MOVE TAG-SGV-PAJU IN TAG TO GAR-SGV-PAJU IN CMA-VARI.
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-CGTA IN GDG-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-CGTA IN GDG-FLD
      *       Ingresa Dep Plazo Propio
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI.

      *>>>>
      *>>>>                                                             
           IF     GDG-CAI-GTIA IN GDG-FLD NOT > SPACES 
              AND GDG-IIC-GTIA IN GDG-FLD NOT > ZEROES 
              AND GDG-TIP-CGTA IN GDG-FLD NOT > SPACES
              AND GDG-STP-CGTA IN GDG-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDG.
       FIN-VAL-CON-IKY-GDG.
           EXIT.
       
       VAL-NUM-KEY-GDG SECTION.
       INI-VAL-NUM-KEY-GDG.
           PERFORM VAL-NUM-IKY-GDG.
           PERFORM VAL-NUM-MKY-GDG.
           PERFORM VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-KEY-GDG.
           EXIT.
       
       VAL-NUM-IKY-GDG SECTION.
       INI-VAL-NUM-IKY-GDG.
       VAL-NUM-GDG-IIC-GTIA.
           MOVE GDG-IIC-GTIA-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDG-IIC-GTIA IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDG-IIC-GTIA-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-IKY-GDG.
       FIN-VAL-NUM-IKY-GDG.
           EXIT.
       
       VAL-NUM-MKY-GDG SECTION.
       INI-VAL-NUM-MKY-GDG.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-MKY-GDG.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-MKY-GDG.
           EXIT.
       
       VAL-NUM-AKY-GDG SECTION.
       INI-VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-AKY-GDG.
           EXIT.
       
       VAL-NUM-FLD-GDG SECTION.
       INI-VAL-NUM-FLD-GDG.
       VAL-NUM-FRM-IIC-IOPD.
           MOVE FRM-IIC-IOPD-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-IIC-IOPD IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-GDG-COD-TSCN.
           MOVE GDG-COD-TSCN-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDG-COD-TSCN IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDG-COD-TSCN-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-GDG-NUM-IPRO.
           MOVE GDG-NUM-IPRO-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDG-NUM-IPRO IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDG-NUM-IPRO-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-FLD-GDG.
           EXIT.
       
       EDT-KEY-GDG SECTION.
       INI-EDT-KEY-GDG.
           PERFORM EDT-IKY-GDG.
           PERFORM EDT-MKY-GDG.
           PERFORM EDT-AKY-GDG.
       FIN-EDT-KEY-GDG.
           EXIT.
       
       EDT-IKY-GDG SECTION.
       INI-EDT-IKY-GDG.
           IF GDG-IIC-GTIA-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDG-IIC-GTIA-LEN IN GDG-FLD
                GO TO FIN-EDT-IKY-GDG.
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDG-IIC-GTIA-EDT IN GDG-EDT.
           MOVE GDG-IIC-GTIA-EDT IN GDG-EDT TO 
                GDG-IIC-GTIA-ALF IN GDG-FLD.
       FIN-EDT-IKY-GDG.
           EXIT.
       
       EDT-MKY-GDG SECTION.
       INI-EDT-MKY-GDG.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-MKY-GDG.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO
                DBC-NUM-ICLI-EDT IN GDG-EDT.
           MOVE DBC-NUM-ICLI-EDT IN GDG-EDT TO
                DBC-NUM-ICLI-ALF IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-MKY-GDG.
           EXIT.
       
       EDT-AKY-GDG SECTION.
       INI-EDT-AKY-GDG.
       FIN-EDT-AKY-GDG.
           EXIT.
       
       EDT-FLD-GDG SECTION.
       INI-EDT-FLD-GDG.
           IF FRM-IIC-IOPD-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO FRM-IIC-IOPD-EDT IN GDG-EDT.
           MOVE FRM-IIC-IOPD-EDT IN GDG-EDT TO 
                FRM-IIC-IOPD-ALF IN GDG-FLD.
           IF GDG-COD-TSCN-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDG-COD-TSCN-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-COD-TSCN IN GDG-FLD TO GDG-COD-TSCN-EDT IN GDG-EDT.
           MOVE GDG-COD-TSCN-EDT IN GDG-EDT TO 
                GDG-COD-TSCN-ALF IN GDG-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF GDG-NUM-IPRO-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDG-NUM-IPRO-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-NUM-IPRO IN GDG-FLD TO
                GDG-NUM-IPRO-EDT IN GDG-EDT.
           MOVE GDG-NUM-IPRO-EDT IN GDG-EDT TO
                GDG-NUM-IPRO-ALF IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-FLD-GDG.
           EXIT.
      *<<<< EOF
      *<<<< GEN_BCI
       BUS-RCC SECTION.
       INI-BUS-RCC.
      * Muestra Primer Cliente del OPD de DAP mediante RCC
           MOVE FRM-CAI-IOPD IN GDG-FLD TO RCC-CAI-IOPD IN RCC.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (
                  FIO-STAT-OKS AND
                  FRM-CAI-IOPD IN GDG-FLD = RCC-CAI-IOPD IN RCC AND
                  FRM-IIC-IOPD IN GDG-FLD = RCC-IIC-IOPD IN RCC
                  )
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'RCC    NEX'   TO MSG-COD-MENS
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-RCC.
       FIN-BUS-RCC.
           EXIT.
