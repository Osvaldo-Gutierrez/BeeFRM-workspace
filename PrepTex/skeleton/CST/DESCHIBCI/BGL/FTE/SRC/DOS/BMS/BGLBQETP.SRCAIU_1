      *
      * BGLBQETP
      * Version 3.0.1 Nov-2005
      * 01-Mar-19 12:58 PM
      *
       SET-TAG-BGLBQETP SECTION.
       INI-SET-TAG-BGLBQETP.
           MOVE
           '<IDNMOD NOM=$BGLBQETP$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$01-Mar-19 12:58 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBQETP.
           EXIT.
           
       PUT-ALL-ETP SECTION.
       INI-PUT-ALL-ETP.
           PERFORM PUT-ETP-ETP.
       FIN-PUT-ALL-ETP.
           EXIT.
       
       PUT-ETP-ETP SECTION.
       INI-PUT-ETP-ETP.
           IF PGM-STAT-ETP-NUL
               GO TO FIN-PUT-ETP-ETP.
           IF NOT PGM-STAT-ETP-OKS
               PERFORM CLR-ETP-ETP
               GO TO FIN-PUT-ETP-ETP.
           MOVE ETP-CAI-GTIA IN ETP TO ETP-CAI-GTIA IN ETP-FLD.
           MOVE ETP-IIC-GTIA IN ETP TO ETP-IIC-GTIA IN ETP-FLD.
           MOVE ETP-NUM-CONT IN ETP TO ETP-NUM-CONT IN ETP-FLD.
           MOVE ETP-COD-CGTA IN ETP TO ETP-COD-CGTA IN ETP-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE ETP-NUM-DTAS IN ETP TO ETP-NUM-DTAS IN ETP-FLD.
           MOVE ETP-NUM-MTAS IN ETP TO ETP-NUM-MTAS IN ETP-FLD.
           MOVE ETP-NUM-STAS IN ETP TO ETP-NUM-STAS IN ETP-FLD.
           MOVE ETP-NUM-ATAS IN ETP TO ETP-NUM-ATAS IN ETP-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE ETP-NUM-SOLI IN ETP TO ETP-NUM-SOLI IN ETP-FLD.
           MOVE ETP-COD-TASN IN ETP TO ETP-COD-TASN IN ETP-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE ETP-NUM-DTRN IN ETP TO ETP-NUM-DTRN IN ETP-FLD.
           MOVE ETP-NUM-MTRN IN ETP TO ETP-NUM-MTRN IN ETP-FLD.
           MOVE ETP-NUM-STRN IN ETP TO ETP-NUM-STRN IN ETP-FLD.
           MOVE ETP-NUM-ATRN IN ETP TO ETP-NUM-ATRN IN ETP-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE ETP-IND-IEXC IN ETP TO ETP-IND-IEXC IN ETP-FLD.
       FIN-PUT-ETP-ETP.
           EXIT.
       
       KEY-ALL-ETP SECTION.
       INI-KEY-ALL-ETP.
           PERFORM KEY-ETP-ETP.
       FIN-KEY-ALL-ETP.
           EXIT.
       
       KEY-ETP-ETP SECTION.
       INI-KEY-ETP-ETP.
           MOVE ETP-CAI-GTIA IN ETP-FLD TO ETP-CAI-GTIA IN ETP.
           MOVE ETP-IIC-GTIA IN ETP-FLD TO ETP-IIC-GTIA IN ETP.
           MOVE ETP-NUM-CONT IN ETP-FLD TO ETP-NUM-CONT IN ETP.
       FIN-KEY-ETP-ETP.
           EXIT.
       
       SCR-CLRA-ETP SECTION.
       INI-SCR-CLRA-ETP.
           PERFORM CLR-KEY-ETP.
           PERFORM CLR-FLD-ETP.
       FIN-SCR-CLRA-ETP.
           EXIT.
       
       CLR-KEY-ETP SECTION.
       INI-CLR-KEY-ETP.
           MOVE SPACES TO ETP-CAI-GTIA IN ETP-FLD.
           MOVE ZEROES TO ETP-IIC-GTIA IN ETP-FLD.
           MOVE ZEROES TO ETP-NUM-CONT IN ETP-FLD.
       FIN-CLR-KEY-ETP.
           EXIT.
       
       CLR-FLD-ETP SECTION.
       INI-CLR-FLD-ETP.
           MOVE SPACES TO FRM-GLS-CGTA IN ETP-FLD.
           MOVE SPACES TO FRM-GLS-EXCP IN ETP-FLD.
           PERFORM CLR-ETP-ETP.
       FIN-CLR-FLD-ETP.
           EXIT.
       
       CLR-ETP-ETP SECTION.
       INI-CLR-ETP-ETP.
           MOVE SPACES TO ETP-COD-CGTA IN ETP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO ETP-FEC-FTAS IN ETP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO ETP-NUM-SOLI IN ETP-FLD.
           MOVE ZEROES TO ETP-COD-TASN IN ETP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO ETP-FEC-FTRN IN ETP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO ETP-IND-IEXC IN ETP-FLD.
       FIN-CLR-ETP-ETP.
           EXIT.
       
       FST-KEY-ETP SECTION.
       INI-FST-KEY-ETP.
           MOVE -1 TO ETP-CAI-GTIA-LEN IN ETP-FLD.
       FIN-FST-KEY-ETP.
           EXIT.
       
       FST-FLD-ETP SECTION.
       INI-FST-FLD-ETP.
           MOVE FRM-POS-CURS TO ETP-FEC-FTAS-LEN IN ETP-FLD.
       FIN-FST-FLD-ETP.
           EXIT.
       
       PRO-KEY-ETP SECTION.
       INI-PRO-KEY-ETP.
           PERFORM PRO-IKY-ETP.
           PERFORM PRO-AKY-ETP.
           PERFORM PRO-MKY-ETP.
       FIN-PRO-KEY-ETP.
           EXIT.
       
       PRO-IKY-ETP SECTION.
       INI-PRO-IKY-ETP.
           MOVE FRM-CPIM-AEY TO ETP-CAI-GTIA-ATR IN ETP-FLD.
           MOVE FRM-CPIM-AEY TO ETP-IIC-GTIA-ATR IN ETP-FLD.
           MOVE FRM-CPIM-AEY TO ETP-NUM-CONT-ATR IN ETP-FLD.
       FIN-PRO-IKY-ETP.
           EXIT.
       
       PRO-MKY-ETP SECTION.
       INI-PRO-MKY-ETP.
       FIN-PRO-MKY-ETP.
           EXIT.
       
       PRO-AKY-ETP SECTION.
       INI-PRO-AKY-ETP.
       FIN-PRO-AKY-ETP.
           EXIT.
       
       UNP-KEY-ETP SECTION.
       INI-UNP-KEY-ETP.
           PERFORM UNP-IKY-ETP.
           PERFORM UNP-AKY-ETP.
           PERFORM UNP-MKY-ETP.
       FIN-UNP-KEY-ETP.
           EXIT.
       
       UNP-IKY-ETP SECTION.
       INI-UNP-IKY-ETP.
           MOVE FRM-CPIM-UBY TO ETP-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO ETP-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO ETP-NUM-CONT-ATR.
       FIN-UNP-IKY-ETP.
           EXIT.
       
       UNP-MKY-ETP SECTION.
       INI-UNP-MKY-ETP.
       FIN-UNP-MKY-ETP.
           EXIT.
       
       UNP-AKY-ETP SECTION.
       INI-UNP-AKY-ETP.
       FIN-UNP-AKY-ETP.
           EXIT.
       
       UNP-FLD-ETP SECTION.
       INI-UNP-FLD-ETP.
           PERFORM UNP-ETP-ETP.
       FIN-UNP-FLD-ETP.
           EXIT.
       
       UNP-ETP-ETP SECTION.
       INI-UNP-ETP-ETP.
           MOVE FRM-CPIM-UBY TO ETP-FEC-FTAS-ATR IN ETP-FLD.
           MOVE FRM-CPIM-UBY TO ETP-NUM-SOLI-ATR IN ETP-FLD.
           MOVE FRM-CPIM-UBY TO ETP-FEC-FTRN-ATR IN ETP-FLD.
           MOVE FRM-CPIM-UBY TO ETP-IND-IEXC-ATR IN ETP-FLD.
       FIN-UNP-ETP-ETP.
           EXIT.
       
       VAL-KEY-ETP SECTION.
       INI-VAL-KEY-ETP.
           PERFORM VAL-IKY-ETP.
           PERFORM VAL-MKY-ETP.
           PERFORM VAL-AKY-ETP.
       FIN-VAL-KEY-ETP.
           EXIT.
       
       VAL-IKY-ETP SECTION.
       INI-VAL-IKY-ETP.
           PERFORM VAL-ETP-CAI-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ETP-CAI-GTIA-LEN IN ETP-FLD
                GO TO FIN-VAL-IKY-ETP.
           PERFORM VAL-ETP-IIC-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ETP-IIC-GTIA-LEN IN ETP-FLD
                GO TO FIN-VAL-IKY-ETP.
           PERFORM VAL-ETP-NUM-CONT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ETP-NUM-CONT-LEN IN ETP-FLD
                GO TO FIN-VAL-IKY-ETP.
       FIN-VAL-IKY-ETP.
           EXIT.
       
       VAL-MKY-ETP SECTION.
       INI-VAL-MKY-ETP.
       FIN-VAL-MKY-ETP.
           EXIT.
       
       VAL-AKY-ETP SECTION.
       INI-VAL-AKY-ETP.
       FIN-VAL-AKY-ETP.
           EXIT.
       
       VAL-ETP-CAI-GTIA SECTION.
       INI-VAL-ETP-CAI-GTIA.
           IF ETP-CAI-GTIA IN ETP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-ETP-CAI-GTIA.
       FIN-VAL-ETP-CAI-GTIA.
           EXIT.
       
       VAL-ETP-IIC-GTIA SECTION.
       INI-VAL-ETP-IIC-GTIA.
           IF ETP-IIC-GTIA IN ETP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-ETP-IIC-GTIA.
       FIN-VAL-ETP-IIC-GTIA.
           EXIT.
       
       VAL-ETP-NUM-CONT SECTION.
       INI-VAL-ETP-NUM-CONT.
           IF ETP-NUM-CONT IN ETP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-ETP-NUM-CONT.
       FIN-VAL-ETP-NUM-CONT.
           EXIT.
       
       VAL-CON-KEY-ETP SECTION.
       INI-VAL-CON-KEY-ETP.
           IF     ETP-CAI-GTIA IN ETP-FLD NOT > SPACES 
              AND ETP-IIC-GTIA IN ETP-FLD NOT > ZEROES 
              AND ETP-NUM-CONT IN ETP-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-ETP.
       FIN-VAL-CON-KEY-ETP.
           EXIT.
       
       VAL-CON-IKY-ETP SECTION.
       INI-VAL-CON-IKY-ETP.
           IF     ETP-CAI-GTIA IN ETP-FLD NOT > SPACES 
              AND ETP-IIC-GTIA IN ETP-FLD NOT > ZEROES 
              AND ETP-NUM-CONT IN ETP-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-ETP.
       FIN-VAL-CON-IKY-ETP.
           EXIT.
       
       VAL-NUM-KEY-ETP SECTION.
       INI-VAL-NUM-KEY-ETP.
           PERFORM VAL-NUM-IKY-ETP.
           PERFORM VAL-NUM-MKY-ETP.
           PERFORM VAL-NUM-AKY-ETP.
       FIN-VAL-NUM-KEY-ETP.
           EXIT.
       
       VAL-NUM-IKY-ETP SECTION.
       INI-VAL-NUM-IKY-ETP.
       VAL-NUM-ETP-IIC-GTIA.
           MOVE ETP-IIC-GTIA-ALF IN ETP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ETP-IIC-GTIA IN ETP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ETP-IIC-GTIA-LEN IN ETP-FLD
                GO TO FIN-VAL-NUM-IKY-ETP.
       VAL-NUM-ETP-NUM-CONT.
           MOVE ETP-NUM-CONT-ALF IN ETP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ETP-NUM-CONT IN ETP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ETP-NUM-CONT-LEN IN ETP-FLD
                GO TO FIN-VAL-NUM-IKY-ETP.
       FIN-VAL-NUM-IKY-ETP.
           EXIT.
       
       VAL-NUM-MKY-ETP SECTION.
       INI-VAL-NUM-MKY-ETP.
       FIN-VAL-NUM-MKY-ETP.
           EXIT.
       
       VAL-NUM-AKY-ETP SECTION.
       INI-VAL-NUM-AKY-ETP.
       FIN-VAL-NUM-AKY-ETP.
           EXIT.
       
       VAL-NUM-FLD-ETP SECTION.
       INI-VAL-NUM-FLD-ETP.
       VAL-NUM-ETP-COD-TASN.
           MOVE ETP-COD-TASN-ALF IN ETP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ETP-COD-TASN IN ETP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ETP-COD-TASN-LEN IN ETP-FLD
                GO TO FIN-VAL-NUM-FLD-ETP.
       FIN-VAL-NUM-FLD-ETP.
           EXIT.
       
       EDT-KEY-ETP SECTION.
       INI-EDT-KEY-ETP.
           PERFORM EDT-IKY-ETP.
           PERFORM EDT-MKY-ETP.
           PERFORM EDT-AKY-ETP.
       FIN-EDT-KEY-ETP.
           EXIT.
       
       EDT-IKY-ETP SECTION.
       INI-EDT-IKY-ETP.
           IF ETP-IIC-GTIA-LEN IN ETP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ETP-IIC-GTIA-LEN IN ETP-FLD
                GO TO FIN-EDT-IKY-ETP.
           MOVE ETP-IIC-GTIA IN ETP-FLD TO ETP-IIC-GTIA-EDT IN ETP-EDT.
           MOVE ETP-IIC-GTIA-EDT IN ETP-EDT TO 
                ETP-IIC-GTIA-ALF IN ETP-FLD.
           IF ETP-NUM-CONT-LEN IN ETP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ETP-NUM-CONT-LEN IN ETP-FLD
                GO TO FIN-EDT-IKY-ETP.
           MOVE ETP-NUM-CONT IN ETP-FLD TO ETP-NUM-CONT-EDT IN ETP-EDT.
           MOVE ETP-NUM-CONT-EDT IN ETP-EDT TO 
                ETP-NUM-CONT-ALF IN ETP-FLD.
       FIN-EDT-IKY-ETP.
           EXIT.
       
       EDT-MKY-ETP SECTION.
       INI-EDT-MKY-ETP.
       FIN-EDT-MKY-ETP.
           EXIT.
       
       EDT-AKY-ETP SECTION.
       INI-EDT-AKY-ETP.
       FIN-EDT-AKY-ETP.
           EXIT.
       
       EDT-FLD-ETP SECTION.
       INI-EDT-FLD-ETP.
           IF ETP-COD-TASN-LEN IN ETP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ETP-COD-TASN-LEN IN ETP-FLD
                GO TO FIN-EDT-FLD-ETP.
           MOVE ETP-COD-TASN IN ETP-FLD TO ETP-COD-TASN-EDT IN ETP-EDT.
           MOVE ETP-COD-TASN-EDT IN ETP-EDT TO 
                ETP-COD-TASN-ALF IN ETP-FLD.
       FIN-EDT-FLD-ETP.
           EXIT.
