      *
      * BGLBUGAP
      * Version 3.0.1 Nov-2005
      * 16-Jan-19 02:11 PM
      *
       SET-TAG-BGLBUGAP SECTION.
       INI-SET-TAG-BGLBUGAP.
           MOVE
           '<IDNMOD NOM=$BGLBUGAP$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$16-Jan-19 02:11 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGAP.
           EXIT.
           
       RET-ALL-GAP SECTION.
       INI-RET-ALL-GAP.
           PERFORM KEY-ALL-GAP.
           PERFORM RET-GAP-GAP.
           PERFORM RET-GDG-GAP.
           PERFORM RET-DBC-GAP.
       FIN-RET-ALL-GAP.
           EXIT.
       
       RET-GAP-GAP SECTION.
       INI-RET-GAP-GAP.
           MOVE CNE-GAP-CAI-ICLI  TO GAP-CAI-ICLI IN GAP.
           MOVE CNE-GAP-IIC-ICLI  TO GAP-IIC-ICLI IN GAP.
           MOVE CNE-GAP-GLS-NOMA  TO GAP-GLS-NOMA IN GAP.
      *>>>> INI_RET_GDG_GDG
      *>>>> FMT_CHI
      *     MOVE DBC-NUM-ICLI IN GAP-FLD  TO WSS-NUM-ICLI IN WSS-VARI.
      *     MOVE DBC-VRF-ICLI IN GAP-FLD  TO WSS-IND-ICLI IN WSS-VARI.
      *     MOVE DBC-GLS-ICLI IN GAP-FLD  TO WSS-GLS-ICLI IN WSS-VARI.
      *     MOVE WSS-IDC-ICLI IN WSS-VARI TO GAP-CIC-ICLI IN GAP.

      *IDC-CLI Busca Cliente por medio de IdC.
           MOVE DBC-NUM-ICLI IN GAP-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GAP-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GAP-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-CAI-ICLI IN DBC TO GAP-CAI-ICLI IN GAP
               MOVE DBC-IIC-ICLI IN DBC TO GAP-IIC-ICLI IN GAP.

      *<<<<
           MOVE DBC-GLS-NOMC IN GAP-FLD  TO GAP-GLS-NOMA IN GAP.
      *<<<<
           MOVE GAP-IND-ESBA IN GAP-FLD TO GAP-IND-ESBA IN GAP.
           MOVE GAP-IND-ESCL IN GAP-FLD TO GAP-IND-ESCL IN GAP.
           MOVE GAP-IND-MACR IN GAP-FLD TO GAP-IND-MACR IN GAP.
           MOVE GAP-SGV-MACR IN GAP-FLD TO GAP-SGV-MACR IN GAP.
           MOVE GAP-IND-MASC IN GAP-FLD TO GAP-IND-MASC IN GAP.
           MOVE GAP-COD-GPRE IN GAP-FLD TO GAP-COD-GPRE IN GAP.
       FIN-RET-GAP-GAP.
           EXIT.
       
       RET-GDG-GAP SECTION.
       INI-RET-GDG-GAP.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GAP-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GAP-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
      * OFI-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-OFIC IN GAP-FLD TO GDG-COD-OFIC IN GDG.
      * OFI-FIN --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-VCAM IN GAP-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-GLS-DGTA IN GAP-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-GLS-DGT1 IN GAP-FLD TO GDG-GLS-DGT1 IN GDG.
       FIN-RET-GDG-GAP.
           EXIT.
       
       RET-DBC-GAP SECTION.
       INI-RET-DBC-GAP.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN GAP-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN GAP-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GAP-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GAP-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-GLS-NOMC IN GAP-FLD TO DBC-GLS-NOMC IN DBC.
       FIN-RET-DBC-GAP.
           EXIT.
       
       KEY-ALL-GAP SECTION.
       INI-KEY-ALL-GAP.
           PERFORM KEY-GAP-GAP.
           PERFORM KEY-GDG-GAP.
           PERFORM KEY-DBC-GAP.
       FIN-KEY-ALL-GAP.
           EXIT.
       
       KEY-GAP-GAP SECTION.
       INI-KEY-GAP-GAP.
           MOVE GAP-CAI-GTIA IN GAP-FLD TO GAP-CAI-GTIA IN GAP.
           MOVE GAP-IIC-GTIA IN GAP-FLD TO GAP-IIC-GTIA IN GAP.
           MOVE GAP-COD-PACR IN GAP-FLD TO GAP-COD-PACR IN GAP.
       FIN-KEY-GAP-GAP.
           EXIT.
       
       KEY-GDG-GAP SECTION.
       INI-KEY-GDG-GAP.
       FIN-KEY-GDG-GAP.
           EXIT.
       
       KEY-DBC-GAP SECTION.
       INI-KEY-DBC-GAP.
       FIN-KEY-DBC-GAP.
           EXIT.
       
       SCR-CLRA-GAP SECTION.
       INI-SCR-CLRA-GAP.
           PERFORM CLR-KEY-GAP.
           PERFORM CLR-FLD-GAP.
       FIN-SCR-CLRA-GAP.
           EXIT.
       
       CLR-KEY-GAP SECTION.
       INI-CLR-KEY-GAP.
           MOVE SPACES TO GAP-CAI-GTIA IN GAP-FLD.
           MOVE ZEROES TO GAP-IIC-GTIA IN GAP-FLD.
           MOVE ZEROES TO GAP-COD-PACR IN GAP-FLD.
       FIN-CLR-KEY-GAP.
           EXIT.
       
       CLR-FLD-GAP SECTION.
       INI-CLR-FLD-GAP.
           MOVE SPACES TO FRM-GLS-TREA IN GAP-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GAP-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GAP-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GAP-FLD.
           MOVE SPACES TO FRM-GLS-MACR IN GAP-FLD.
           MOVE SPACES TO FRM-GLS-GPRE IN GAP-FLD.
           PERFORM CLR-GAP-GAP.
           PERFORM CLR-GDG-GAP.
           PERFORM CLR-DBC-GAP.
       FIN-CLR-FLD-GAP.
           EXIT.
       
       CLR-GAP-GAP SECTION.
       INI-CLR-GAP-GAP.
           MOVE SPACES TO GAP-IND-ESBA IN GAP-FLD.
           MOVE SPACES TO GAP-IND-ESCL IN GAP-FLD.
           MOVE SPACES TO GAP-IND-MACR IN GAP-FLD.
           MOVE ZEROES TO GAP-SGV-MACR IN GAP-FLD.
           MOVE SPACES TO GAP-IND-MASC IN GAP-FLD.
           MOVE SPACES TO GAP-COD-GPRE IN GAP-FLD.
       FIN-CLR-GAP-GAP.
           EXIT.
       
       CLR-GDG-GAP SECTION.
       INI-CLR-GDG-GAP.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GAP-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GAP-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GAP-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GAP-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GAP-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GAP-FLD.
       FIN-CLR-GDG-GAP.
           EXIT.
       
       CLR-DBC-GAP SECTION.
       INI-CLR-DBC-GAP.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN GAP-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN GAP-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN GAP-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN GAP-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO DBC-GLS-NOMC IN GAP-FLD.
       FIN-CLR-DBC-GAP.
           EXIT.
       
       FST-KEY-GAP SECTION.
       INI-FST-KEY-GAP.
           MOVE -1 TO GAP-CAI-GTIA-LEN IN GAP-FLD.
      *<<<< FIN_FST_KEY_GAP
      *MHM-INI 30-SEP-2003
      *     IF SCR-CCPP = 'ING'
      *         MOVE FRM-CPIM-AEY TO GAP-COD-PACR-ATR IN GAP-FLD
      *         MOVE FRM-CPIM-AEY TO GAP-COD-PACR-STP.
      *MHM-FIN 30-SEP-2003
      *>>>>
       FIN-FST-KEY-GAP.
           EXIT.
       
       FST-FLD-GAP SECTION.
       INI-FST-FLD-GAP.
           MOVE -1 TO GAP-IND-ESBA-LEN IN GAP-FLD.
       FIN-FST-FLD-GAP.
           EXIT.
       
       PRO-KEY-GAP SECTION.
       INI-PRO-KEY-GAP.
           PERFORM PRO-MKY-GAP.
       FIN-PRO-KEY-GAP.
           EXIT.
       
       PRO-MKY-GAP SECTION.
       INI-PRO-MKY-GAP.
       FIN-PRO-MKY-GAP.
           EXIT.
       
       PRO-FLD-GAP SECTION.
       INI-PRO-FLD-GAP.
           PERFORM PRO-GAP-GAP.
           PERFORM PRO-GDG-GAP.
           PERFORM PRO-DBC-GAP.
       FIN-PRO-FLD-GAP.
           EXIT.
       
       PRO-GAP-GAP SECTION.
       INI-PRO-GAP-GAP.
           MOVE FRM-CPIM-AEY TO GAP-IND-ESBA-ATR IN GAP-FLD.
           MOVE FRM-CPIM-AEY TO GAP-IND-ESCL-ATR IN GAP-FLD.
           MOVE FRM-CPIM-AEY TO GAP-IND-MACR-ATR IN GAP-FLD.
           MOVE FRM-CPIM-AEY TO GAP-SGV-MACR-ATR IN GAP-FLD.
           MOVE FRM-CPIM-AEY TO GAP-IND-MASC-ATR IN GAP-FLD.
           MOVE FRM-CPIM-AEY TO GAP-COD-GPRE-ATR IN GAP-FLD.
       FIN-PRO-GAP-GAP.
           EXIT.
       
       PRO-GDG-GAP SECTION.
       INI-PRO-GDG-GAP.
       FIN-PRO-GDG-GAP.
           EXIT.
       
       PRO-DBC-GAP SECTION.
       INI-PRO-DBC-GAP.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GAP-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GAP-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GAP-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GAP-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GAP-FLD.
       FIN-PRO-DBC-GAP.
           EXIT.
       
       UNP-KEY-GAP SECTION.
       INI-UNP-KEY-GAP.
           PERFORM UNP-IKY-GAP.
           PERFORM UNP-AKY-GAP.
           PERFORM UNP-MKY-GAP.
       FIN-UNP-KEY-GAP.
           EXIT.
       
       UNP-IKY-GAP SECTION.
       INI-UNP-IKY-GAP.
           MOVE FRM-CPIM-UBY TO GAP-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GAP-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GAP-COD-PACR-ATR.
      *<<<< FIN_UNP_IKY_GAP 
      *MHM-INI 30-SEP-2003
      **RRM-INI 26-SEP-2002
      *     IF SCR-CCPP = "ING"
      *         MOVE FRM-CPIM-AEY TO GAP-COD-PACR-ATR IN GAP-FLD
      *         MOVE FRM-CPIM-AEY TO GAP-COD-PACR-STP.
      **RRM-FIN 16-APR-2002
      *MHM-FIN 30-SEP-2003
      *>>>>
       FIN-UNP-IKY-GAP.
           EXIT.
       
       UNP-MKY-GAP SECTION.
       INI-UNP-MKY-GAP.
       FIN-UNP-MKY-GAP.
           EXIT.
       
       UNP-AKY-GAP SECTION.
       INI-UNP-AKY-GAP.
       FIN-UNP-AKY-GAP.
           EXIT.
       
       UNP-FLD-GAP SECTION.
       INI-UNP-FLD-GAP.
           PERFORM UNP-GAP-GAP.
           PERFORM UNP-GDG-GAP.
           PERFORM UNP-DBC-GAP.
       FIN-UNP-FLD-GAP.
           EXIT.
       
       UNP-GAP-GAP SECTION.
       INI-UNP-GAP-GAP.
           MOVE FRM-CPIM-UBY TO GAP-IND-ESBA-ATR IN GAP-FLD.
           MOVE FRM-CPIM-UBY TO GAP-IND-ESCL-ATR IN GAP-FLD.
           MOVE FRM-CPIM-UBY TO GAP-IND-MACR-ATR IN GAP-FLD.
           MOVE FRM-CPIM-UBY TO GAP-SGV-MACR-ATR IN GAP-FLD.
           MOVE FRM-CPIM-UBY TO GAP-IND-MASC-ATR IN GAP-FLD.
           MOVE FRM-CPIM-UBY TO GAP-COD-GPRE-ATR IN GAP-FLD.
      *<<<< FIN_UNP_GAP_GAP
           IF SCR-CCPP = 'ING'
              MOVE FRM-CPIM-AEY TO GAP-IND-MASC-STP
              MOVE FRM-CPIM-AEY TO GAP-IND-MASC-ATR IN GAP-FLD
              MOVE 'S' TO GAP-IND-MASC IN GAP-FLD.
       FIN-UNP-GAP-GAP.
           EXIT.
       
       UNP-GDG-GAP SECTION.
       INI-UNP-GDG-GAP.
       FIN-UNP-GDG-GAP.
           EXIT.
       
       UNP-DBC-GAP SECTION.
       INI-UNP-DBC-GAP.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN GAP-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN GAP-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN GAP-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN GAP-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR IN GAP-FLD.
       FIN-UNP-DBC-GAP.
           EXIT.
       
       VAL-MKY-GAP SECTION.
       INI-VAL-MKY-GAP.
       FIN-VAL-MKY-GAP.
           EXIT.
       
       VAL-FLD-GAP SECTION.
       INI-VAL-FLD-GAP.
           PERFORM VAL-FRM-GLS-TREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TREA-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
      * IDG-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-TIP-CGTA-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-STP-CGTA-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
      * IDG-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
      * OFI-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-COD-OFIC-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
      * OFI-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GAP-IND-ESBA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GAP-IND-ESBA-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GAP-IND-ESCL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GAP-IND-ESCL-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GAP-IND-MACR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GAP-IND-MACR-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-FRM-GLS-MACR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-MACR-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GAP-SGV-MACR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GAP-SGV-MACR-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GAP-IND-MASC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GAP-IND-MASC-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-GAP-COD-GPRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GAP-COD-GPRE-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
           PERFORM VAL-FRM-GLS-GPRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-GPRE-LEN IN GAP-FLD
                GO TO FIN-VAL-FLD-GAP.
       FIN-VAL-FLD-GAP.
           EXIT.
       
       VAL-FRM-GLS-TREA SECTION.
       INI-VAL-FRM-GLS-TREA.
       FIN-VAL-FRM-GLS-TREA.
           EXIT.
      * IDG-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.
           IF GDG-TIP-CGTA IN GAP-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-CGTA IN GAP-FLD.
       FIN-VAL-GDG-TIP-CGTA.
           EXIT.

       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.
           IF GDG-STP-CGTA IN GAP-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-CGTA IN GAP-FLD.
       FIN-VAL-GDG-STP-CGTA.
           EXIT.
      * IDG-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * OFI-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
           IF GDG-COD-OFIC IN GAP-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GAP-FLD.
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
      * OFI-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
       
       VAL-GAP-IND-ESBA SECTION.
       INI-VAL-GAP-IND-ESBA.
      *Si GAP-IND-ESBA = 'S' (Cliente Banco)
      *Busar IDC BCO en tabla y desplegra nombre

      *Si GAP-IND-ESBA = 'N' (Cliente No Banco)

           IF GAP-IND-ESBA IN GAP-FLD NOT > SPACES
               MOVE 'N'   TO GAP-IND-ESBA IN GAP-FLD.
             
      *RRM-INI 15-APR-2002
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GAP-IND-ESBA IN GAP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
      *    IF NOT ( GAP-IND-ESBA IN GAP-FLD = 'N' OR 'S' )
      *        MOVE 'BGL'         TO MSG-COD-SIST
      *        MOVE 'IESBA    N/S' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RRM-FIN 15-APR-2002
               GO TO FIN-VAL-GAP-IND-ESBA.

           IF GAP-IND-ESBA IN GAP-FLD = 'S' AND
              GAP-IND-ESCL IN GAP-FLD = 'S'
               MOVE 'BGL'         TO MSG-COD-SIST
               MOVE 'ESBA<>ESCLI ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GAP-IND-ESBA.

      *------------------------------------------------------*
      *Validar que la Prioridad sea Igual al grado de la GDG
      *Criente preferencial tiene que se BCO.
           IF GAP-COD-PACR IN GAP-FLD = GAR-COD-GGTA IN CMA-VARI AND
              GAP-IND-ESBA IN GAP-FLD NOT = 'S'
               MOVE 'BGL'         TO MSG-COD-SIST
               MOVE 'ESBA=BCO   ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GAP-IND-ESBA.

           IF GAP-COD-PACR IN GAP-FLD < GAR-COD-GGTA IN CMA-VARI AND
              GAP-IND-ESBA IN GAP-FLD  = 'S'
               MOVE 'BGL'         TO MSG-COD-SIST
               MOVE 'ESBA<>BCO  ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GAP-IND-ESBA.

           IF GAP-IND-ESBA IN GAP-FLD = 'S'
      *<<<< FMT_CHI
              MOVE ZEROES       TO DBC-NUM-ICLI IN GAP-FLD
              MOVE SPACES       TO DBC-IND-ICLI IN GAP-FLD
              MOVE SPACES       TO DBC-GLS-ICLI IN GAP-FLD
              MOVE SPACES       TO DBC-VRF-ICLI IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GAP-FLD
      *>>>>

              MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-STP.

           IF GAP-IND-ESBA IN GAP-FLD  = 'S'
               MOVE 'BGL'     TO TAB-COD-SIST
               MOVE 'IDC '    TO TAB-COD-TTAB IN TAB
      *INI-AFRI/MAY-2005                                                
               IF (GAP-IND-ESBA IN GAP-FLD  = 'S' AND                   
                  GAP-CAI-GTIA IN GAP-FLD = '0800')                     
                   MOVE 'IDCBCS'  TO TAB-COD-CTAB IN TAB                
               ELSE                                                     
                   MOVE 'IDCBCO'  TO TAB-COD-CTAB IN TAB
               END-IF                                                   
      *        MOVE 'IDCBCO'  TO TAB-COD-CTAB IN TAB                    
      *FIN-AFRI/MAY-2005                                                
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO DBC-GLS-NOMC IN GAP-FLD
      
      *<<<< FMT_CHI
               MOVE TAB-GLS-DCOR IN TAB TO WSS-IDC-ICLI IN WSS-VARI
               MOVE WSS-NUM-ICLI IN WSS-VARI TO DBC-NUM-ICLI IN GAP-FLD
               MOVE WSS-IND-ICLI IN WSS-VARI TO DBC-IND-ICLI IN GAP-FLD
               MOVE WSS-GLS-ICLI IN WSS-VARI TO DBC-GLS-ICLI IN GAP-FLD
      *<<<< GEN_BCI
               PERFORM VAL-NUM-ICLI
      *>>>>
               MOVE TAB-COD-DAT1 IN TAB(1)   TO DBC-VRF-ICLI IN GAP-FLD.
      *>>>>
           IF GAP-IND-ESBA IN GAP-FLD NOT > SPACES
              MOVE SPACES TO GAP-IND-ESBA IN GAP-FLD.
       FIN-VAL-GAP-IND-ESBA.
           EXIT.
       
       VAL-GAP-IND-ESCL SECTION.
       INI-VAL-GAP-IND-ESCL.
           IF GAP-IND-ESCL IN GAP-FLD NOT > SPACES
              MOVE 'N'  TO GAP-IND-ESCL IN GAP-FLD.

      *RRM-INI 15-APR-2002
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GAP-IND-ESCL IN GAP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
      *    IF NOT ( GAP-IND-ESCL IN GAP-FLD = 'N' OR 'S' )
      *       MOVE 'BGL'         TO MSG-COD-SIST
      *       MOVE 'IESCL    S/N' TO MSG-COD-MENS
      *       PERFORM GET-MSG
      *       MOVE MSG-GLS-DESC TO FRM-MENS
      *       MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RRM-FIN 15-APR-2002
              GO TO FIN-VAL-GAP-IND-ESCL.
         
           IF  GAP-IND-ESCL IN GAP-FLD = 'N' 
      *<<<< FMT_CHI
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GAP-FLD.
      *>>>>

           IF  GAP-IND-ESCL IN GAP-FLD = 'S'
      *<<<< FMT_CHI
               MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN GAP-FLD
      *>>>>
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GAP-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-STP. 

           IF GAP-IND-ESCL IN GAP-FLD NOT > SPACES
              MOVE SPACES TO GAP-IND-ESCL IN GAP-FLD.
       FIN-VAL-GAP-IND-ESCL.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
      *<<<<
           IF MSG-COD-MENS > SPACES
              GO TO FIN-VAL-DBC-NUM-ICLI.
      
      *Buscar tabla no se ingresa
           IF GAP-IND-ESBA IN GAP-FLD = 'S'
              GO TO FIN-VAL-DBC-NUM-ICLI.
      *JGM
      *Se ingresa solo nombre
           IF GAP-IND-ESBA IN GAP-FLD = 'N' AND
              GAP-IND-ESCL IN GAP-FLD = 'N'
              MOVE ZEROES TO DBC-NUM-ICLI IN GAP-FLD
              MOVE SPACES TO DBC-IND-ICLI IN GAP-FLD
              MOVE SPACES TO DBC-GLS-ICLI IN GAP-FLD
              MOVE SPACES TO DBC-VRF-ICLI IN GAP-FLD
              GO TO FIN-VAL-DBC-NUM-ICLI.
      *JGM
      *Se tiene que ingresar IDC
           IF  GAP-IND-ESCL IN GAP-FLD = 'S' AND
               DBC-NUM-ICLI IN GAP-FLD = ZEROES
      
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'INGIDC' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-NUM-ICLI.
      
           IF   GAP-IND-ESCL IN GAP-FLD = 'N' AND
                DBC-NUM-ICLI IN GAP-FLD NOT = ZEROES
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'NOINGIDC'   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-NUM-ICLI.
      
           MOVE DBC-NUM-ICLI IN GAP-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GAP-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GAP-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DBC-NUM-ICLI.

           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GAP-FLD.
      
           PERFORM VAL-ACR-GDD.
           IF MSG-COD-MENS > SPACES
              MOVE 'BGL'        TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DBC-NUM-ICLI.
      
           MOVE DBC-CAI-ICLI IN DBC TO CNE-GAP-CAI-ICLI.
           MOVE DBC-IIC-ICLI IN DBC TO CNE-GAP-IIC-ICLI.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GAP-FLD.
           MOVE CPT-STRN TO CNE-GAP-GLS-NOMA.
      *>>>>       
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN GAP-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN GAP-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN GAP-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN GAP-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI
      *<<<< NOT PGM_MEX
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-DBC-VRF-ICLI.
      *<<<<
           IF GAP-IND-ESBA IN GAP-FLD = 'N' AND
              GAP-IND-ESCL IN GAP-FLD = 'N'
               GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
           MOVE DBC-NUM-ICLI IN GAP-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GAP-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GAP-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DBC-VRF-ICLI.

           PERFORM VAL-ACR-GDD.
           IF MSG-COD-MENS > SPACES
               MOVE 'BGL'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DBC-VRF-ICLI.

           MOVE DBC-CAI-ICLI IN DBC TO CNE-GAP-CAI-ICLI.
           MOVE DBC-IIC-ICLI IN DBC TO CNE-GAP-IIC-ICLI.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GAP-FLD.
           MOVE CPT-STRN TO CNE-GAP-GLS-NOMA.
      *>>>>
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN GAP-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN GAP-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN GAP-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN GAP-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN GAP-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN GAP-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN GAP-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN GAP-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
      *<<<<
           IF GAP-IND-ESBA IN GAP-FLD = 'S'  
               GO TO FIN-VAL-DBC-GLS-NOMC.

           IF  GAP-IND-ESCL IN GAP-FLD = 'S'  
               GO TO FIN-VAL-DBC-GLS-NOMC.

           IF  DBC-GLS-NOMC IN GAP-FLD NOT > SPACES AND
               GAP-IND-ESCL IN GAP-FLD = 'N'  

                  MOVE 'TAB'        TO MSG-COD-SIST                     
                  MOVE 'ACR-NOM-NEX' TO MSG-COD-MENS                     
                  PERFORM GET-MSG                                       
                  MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD          
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-GLS-NOMC.

           IF DBC-GLS-NOMC IN GAP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DBC-GLS-NOMC.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-GAP-IND-MACR SECTION.
       INI-VAL-GAP-IND-MACR.
           IF GAP-IND-MACR IN GAP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GAP-IND-MACR.
           IF ( GAP-IND-MACR IN GAP-FLD NOT > SPACES)
                MOVE SPACES TO GAP-IND-MACR IN GAP-FLD.

      *VAL-IND Valida miscelaneo de tabla
           MOVE 'BGL' TO MSC-COD-SIST.
           MOVE 'MACR' TO MSC-COD-TMSC IN MSC.
           MOVE GAP-IND-MACR IN GAP-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GAP-IND-MACR IN GAP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-MACR IN GAP-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-MACR IN GAP-FLD.
       FIN-VAL-GAP-IND-MACR.
           EXIT.
       
       VAL-FRM-GLS-MACR SECTION.
       INI-VAL-FRM-GLS-MACR.
       FIN-VAL-FRM-GLS-MACR.
           EXIT.
       
       VAL-GAP-SGV-MACR SECTION.
       INI-VAL-GAP-SGV-MACR.
           IF GAP-SGV-MACR IN GAP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GAP-SGV-MACR.
      *<<<< GAP_SGV_MACR

      * Obtiene Codigo Valor de Cambio de Pesos
      * Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF GDG-COD-VCAM IN GAP-FLD = TAB-COD-CTAB AND
              GAP-SGV-MACR IN GAP-FLD > ZEROES
               MOVE GAP-SGV-MACR IN GAP-FLD TO 
                    PES-SGV-DECI IN PES-VARI

               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GAP-SGV-MACR IN GAP-FLD.
      *>>>>
       FIN-VAL-GAP-SGV-MACR.
           EXIT.
       
       VAL-GAP-IND-MASC SECTION.
       INI-VAL-GAP-IND-MASC.
      *<<<< INI_GAP_IND_MASC
      *RRM-INI 15-APR-2002
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GAP-IND-MASC IN GAP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GAP-IND-MASC.
      *RRM-FIN 15-APR-2002
      *>>>>
           IF GAP-IND-MASC IN GAP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GAP-IND-MASC.
       FIN-VAL-GAP-IND-MASC.
           EXIT.
       
       VAL-GAP-COD-GPRE SECTION.
       INI-VAL-GAP-COD-GPRE.
      *<<<<
           IF GAP-COD-GPRE IN GAP-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GAP-COD-GPRE.                                                                                                      
           IF GAP-COD-GPRE IN GAP-FLD NOT > SPACES
              MOVE SPACES TO GAP-COD-GPRE IN GAP-FLD.
      *<<<<
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'GRP ' TO TAB-COD-TTAB IN TAB.                          
           MOVE GAP-COD-GPRE IN GAP-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              GAP-COD-GPRE IN GAP-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-GPRE IN GAP-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-GPRE IN GAP-FLD.                            
           PERFORM LEE-GDG.                                             
           IF GAP-COD-GPRE IN GAP-FLD = 'E'                             
              MOVE 'S' TO TAG-IND-EGES IN TAG                           
           ELSE                                                         
              MOVE 'N' TO TAG-IND-EGES IN TAG.                          
      *>>>>
       FIN-VAL-GAP-COD-GPRE.
           EXIT.
       
       VAL-FRM-GLS-GPRE SECTION.
       INI-VAL-FRM-GLS-GPRE.
       FIN-VAL-FRM-GLS-GPRE.
           EXIT.
       
       VAL-CON-FLD-GAP SECTION.
       INI-VAL-CON-FLD-GAP.
       FIN-VAL-CON-FLD-GAP.
           EXIT.
       
       VAL-CON-GAP SECTION.
       INI-VAL-CON-GAP.
       FIN-VAL-CON-GAP.
           EXIT.
       
       VAL-NUM-KEY-GAP SECTION.
       INI-VAL-NUM-KEY-GAP.
           PERFORM VAL-NUM-IKY-GAP.
           PERFORM VAL-NUM-MKY-GAP.
           PERFORM VAL-NUM-AKY-GAP.
       FIN-VAL-NUM-KEY-GAP.
           EXIT.
       
       VAL-NUM-IKY-GAP SECTION.
       INI-VAL-NUM-IKY-GAP.
       VAL-NUM-GAP-IIC-GTIA.
           MOVE GAP-IIC-GTIA-ALF IN GAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GAP-IIC-GTIA IN GAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GAP-IIC-GTIA-LEN IN GAP-FLD
                GO TO FIN-VAL-NUM-IKY-GAP.
       VAL-NUM-GAP-COD-PACR.
           MOVE GAP-COD-PACR-ALF IN GAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GAP-COD-PACR IN GAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GAP-COD-PACR-LEN IN GAP-FLD
                GO TO FIN-VAL-NUM-IKY-GAP.
       FIN-VAL-NUM-IKY-GAP.
           EXIT.
       
       VAL-NUM-MKY-GAP SECTION.
       INI-VAL-NUM-MKY-GAP.
       FIN-VAL-NUM-MKY-GAP.
           EXIT.
       
       VAL-NUM-AKY-GAP SECTION.
       INI-VAL-NUM-AKY-GAP.
       FIN-VAL-NUM-AKY-GAP.
           EXIT.
       
       VAL-NUM-FLD-GAP SECTION.
       INI-VAL-NUM-FLD-GAP.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN GAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN GAP-FLD
                GO TO FIN-VAL-NUM-FLD-GAP.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-GAP-SGV-MACR.
           MOVE GAP-SGV-MACR-ALF IN GAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GAP-SGV-MACR IN GAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GAP-SGV-MACR-LEN IN GAP-FLD
                GO TO FIN-VAL-NUM-FLD-GAP.
       FIN-VAL-NUM-FLD-GAP.
           EXIT.
       
       EDT-KEY-GAP SECTION.
       INI-EDT-KEY-GAP.
           PERFORM EDT-IKY-GAP.
           PERFORM EDT-MKY-GAP.
           PERFORM EDT-AKY-GAP.
       FIN-EDT-KEY-GAP.
           EXIT.
       
       EDT-IKY-GAP SECTION.
       INI-EDT-IKY-GAP.
           IF GAP-IIC-GTIA-LEN IN GAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GAP-IIC-GTIA-LEN IN GAP-FLD
                GO TO FIN-EDT-IKY-GAP.
           MOVE GAP-IIC-GTIA IN GAP-FLD TO GAP-IIC-GTIA-EDT IN GAP-EDT.
           MOVE GAP-IIC-GTIA-EDT IN GAP-EDT TO 
                GAP-IIC-GTIA-ALF IN GAP-FLD.
           IF GAP-COD-PACR-LEN IN GAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GAP-COD-PACR-LEN IN GAP-FLD
                GO TO FIN-EDT-IKY-GAP.
           MOVE GAP-COD-PACR IN GAP-FLD TO GAP-COD-PACR-EDT IN GAP-EDT.
           MOVE GAP-COD-PACR-EDT IN GAP-EDT TO 
                GAP-COD-PACR-ALF IN GAP-FLD.
       FIN-EDT-IKY-GAP.
           EXIT.
       
       EDT-MKY-GAP SECTION.
       INI-EDT-MKY-GAP.
       FIN-EDT-MKY-GAP.
           EXIT.
       
       EDT-AKY-GAP SECTION.
       INI-EDT-AKY-GAP.
       FIN-EDT-AKY-GAP.
           EXIT.
       
       EDT-FLD-GAP SECTION.
       INI-EDT-FLD-GAP.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN GAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN GAP-FLD
                GO TO FIN-EDT-FLD-GAP.
           MOVE DBC-NUM-ICLI IN GAP-FLD TO
                DBC-NUM-ICLI-EDT IN GAP-EDT.
           MOVE DBC-NUM-ICLI-EDT IN GAP-EDT TO
                DBC-NUM-ICLI-ALF IN GAP-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF GAP-SGV-MACR-LEN IN GAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GAP-SGV-MACR-LEN IN GAP-FLD
                GO TO FIN-EDT-FLD-GAP.
           MOVE GAP-SGV-MACR IN GAP-FLD TO GAP-SGV-MACR-EDT IN GAP-EDT.
           MOVE GAP-SGV-MACR-EDT IN GAP-EDT TO 
                GAP-SGV-MACR-ALF IN GAP-FLD.
       FIN-EDT-FLD-GAP.
           EXIT.
      *<<<< EOF AND PGM_VAX OR EOF_BU
       VAL-ACR-GDD SECTION.
       INI-VAL-ACR-GDD.
           MOVE DBC-KEY-IDBC IN DBC     TO GDD-CIC-DCLI IN GDD.
           MOVE GAP-CAI-GTIA IN GAP-FLD TO GDD-CAI-GTIA IN GDD.
           MOVE GAP-IIC-GTIA IN GAP-FLD TO GDD-IIC-GTIA IN GDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDD.
           IF FIO-STAT-OKS
      *<<<< NOT PGM_ARG
               MOVE 'GAPACR=CLI' TO MSG-COD-MENS.
      *>>>>
       FIN-VAL-ACR-GDD.
           EXIT.
      *>>>>
      *<<<<
       VAL-NUM-ICLI SECTION.                                            
       INI-VAL-NUM-ICLI.                                                
           MOVE DBC-NUM-ICLI-ALF IN GAP-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN GAP-FLD                 
           ELSE                                                         
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'NUMICLINONU' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
       FIN-VAL-NUM-ICLI.                                                
           EXIT.                                                        
                                                                        
      * EVA-AFRI/JUN2007   (PRELACION)                                  
       LEE-GDG SECTION.                                                 
       INI-LEE-GDG.                                                     
           MOVE GAP-CAI-GTIA IN GAP-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GAP-IIC-GTIA IN GAP-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           IF NOT (GDG-COD-LGTA IN GDG = 'A')                           
              GO TO FIN-LEE-GDG                                         
           ELSE                                                         
              IF GAP-COD-GPRE IN GAP-FLD = 'G' AND                      
                 GAP-COD-PACR IN GAP-FLD NOT > 1                        
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'ERROR COD G' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
       FIN-LEE-GDG.                                                     
           EXIT.                                                        
      * FIN-AFRI/JUN2007   (PRELACION)                                  
      *>>>>
