      *
      * BGLBUGVT
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 05:00 PM
      *
      *-----------------------------------------------------------------
      *  AUTOR      : AFRI
      *  FECHA      : NOV-2016
      *  ETIQUETA   : *AFRI-INI / NOV 2016 REDONDEAR VALOR TASACION
      *  OBJETIVO   : REDONDEAR VALOR TASACION
      *-----------------------------------------------------------------
      * MANTENCION
      * OBJETIVO   : MODIFICAR VALIDACION PARA INCLUIR LTSN Y VCTS = 1
      *              TASACIONES PARCIALES Y COMPLETAS
      * RESPONSABLE: MVG
      * ETIQUETA   : *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
      *-----------------------------------------------------------------
       SET-TAG-BGLBUGVT SECTION.
       INI-SET-TAG-BGLBUGVT.
           MOVE
           '<IDNMOD NOM=$BGLBUGVT$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 05:00 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGVT.
           EXIT.
           
       RET-ALL-GVT SECTION.
       INI-RET-ALL-GVT.
           PERFORM KEY-ALL-GVT.
           PERFORM RET-GVT-GVT.
           PERFORM RET-GDG-GVT.
       FIN-RET-ALL-GVT.
           EXIT.
       
       RET-GVT-GVT SECTION.
       INI-RET-GVT-GVT.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GVT-NUM-DTSN IN GVT-FLD TO GVT-NUM-DTSN IN GVT.
           MOVE GVT-NUM-MTSN IN GVT-FLD TO GVT-NUM-MTSN IN GVT.
           MOVE GVT-NUM-STSN IN GVT-FLD TO GVT-NUM-STSN IN GVT.
           MOVE GVT-NUM-ATSN IN GVT-FLD TO GVT-NUM-ATSN IN GVT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-VCTS IN GVT.
           MOVE GVT-SGV-LTSN IN GVT-FLD TO GVT-SGV-LTSN IN GVT.
           MOVE GVT-SGV-PPCT IN GVT-FLD TO GVT-SGV-PPCT IN GVT.
           MOVE GVT-SGV-VPND IN GVT-FLD TO GVT-SGV-VPND IN GVT.
           MOVE GVT-SGV-PAJU IN GVT-FLD TO GVT-SGV-PAJU IN GVT.
           MOVE GVT-SGV-VGAS IN GVT-FLD TO GVT-SGV-VGAS IN GVT.
           MOVE GVT-SGV-VSIN IN GVT-FLD TO GVT-SGV-VSIN IN GVT.
           MOVE GVT-MSC-STAT IN GVT-FLD TO GVT-MSC-STAT IN GVT.
           MOVE GVT-COD-EITS IN GVT-FLD TO GVT-COD-EITS IN GVT.
           MOVE GVT-COD-ISVS IN GVT-FLD TO GVT-COD-ISVS IN GVT.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GVT-NUM-DRVL IN GVT-FLD TO GVT-NUM-DRVL IN GVT.
           MOVE GVT-NUM-MRVL IN GVT-FLD TO GVT-NUM-MRVL IN GVT.
           MOVE GVT-NUM-SRVL IN GVT-FLD TO GVT-NUM-SRVL IN GVT.
           MOVE GVT-NUM-ARVL IN GVT-FLD TO GVT-NUM-ARVL IN GVT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GVT-NUM-DING IN GVT-FLD TO GVT-NUM-DING IN GVT.
           MOVE GVT-NUM-MING IN GVT-FLD TO GVT-NUM-MING IN GVT.
           MOVE GVT-NUM-SING IN GVT-FLD TO GVT-NUM-SING IN GVT.
           MOVE GVT-NUM-AING IN GVT-FLD TO GVT-NUM-AING IN GVT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GVT-SGV-FISC IN GVT-FLD TO GVT-SGV-FISC IN GVT.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GVT-NUM-DURV IN GVT-FLD TO GVT-NUM-DURV IN GVT.
           MOVE GVT-NUM-MURV IN GVT-FLD TO GVT-NUM-MURV IN GVT.
           MOVE GVT-NUM-SURV IN GVT-FLD TO GVT-NUM-SURV IN GVT.
           MOVE GVT-NUM-AURV IN GVT-FLD TO GVT-NUM-AURV IN GVT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GVT-SGV-VTTL IN GVT-FLD TO GVT-SGV-VTTL IN GVT.
           MOVE GVT-COD-ATRN IN GVT-FLD TO GVT-COD-ATRN IN GVT.
       FIN-RET-GVT-GVT.
           EXIT.
       
       RET-GDG-GVT SECTION.
       INI-RET-GDG-GVT.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GVT-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GVT-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
      * OFI-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-OFIC IN GVT-FLD TO GDG-COD-OFIC IN GDG.
      * OFI-FIN --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-VCAM IN GVT-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-GLS-DGTA IN GVT-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-GLS-DGT1 IN GVT-FLD TO GDG-GLS-DGT1 IN GDG.
           MOVE GDG-COD-VCON IN GVT-FLD TO GDG-COD-VCON IN GDG.
       FIN-RET-GDG-GVT.
           EXIT.
       
       KEY-ALL-GVT SECTION.
       INI-KEY-ALL-GVT.
           PERFORM KEY-GVT-GVT.
           PERFORM KEY-GDG-GVT.
       FIN-KEY-ALL-GVT.
           EXIT.
       
       KEY-GVT-GVT SECTION.
       INI-KEY-GVT-GVT.
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GVT-CAI-GTIA IN GVT.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GVT-IIC-GTIA IN GVT.
           MOVE GVT-COD-TASN IN GVT-FLD TO GVT-COD-TASN IN GVT.
           MOVE GVT-COD-SDAG IN GVT-FLD TO GVT-COD-SDAG IN GVT.
       FIN-KEY-GVT-GVT.
           EXIT.
       
       KEY-GDG-GVT SECTION.
       INI-KEY-GDG-GVT.
       FIN-KEY-GDG-GVT.
           EXIT.
       
       SCR-CLRA-GVT SECTION.
       INI-SCR-CLRA-GVT.
           PERFORM CLR-KEY-GVT.
           PERFORM CLR-FLD-GVT.
       FIN-SCR-CLRA-GVT.
           EXIT.
       
       CLR-KEY-GVT SECTION.
       INI-CLR-KEY-GVT.
           MOVE SPACES TO GVT-CAI-GTIA IN GVT-FLD.
           MOVE ZEROES TO GVT-IIC-GTIA IN GVT-FLD.
           MOVE ZEROES TO GVT-COD-TASN IN GVT-FLD.
           MOVE SPACES TO GVT-COD-SDAG IN GVT-FLD.
       FIN-CLR-KEY-GVT.
           EXIT.
       
       CLR-FLD-GVT SECTION.
       INI-CLR-FLD-GVT.
           MOVE SPACES TO FRM-IND-GTP IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TREA IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-VCON IN GVT-FLD.
           MOVE ZEROES TO FRM-VAL-ULT-CON IN GVT-FLD.
           MOVE ZEROES TO FRM-NUM-GTP IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-EITS IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-ISVS IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-EXCE IN GVT-FLD.
           MOVE ZEROES TO FRM-NUM-FISC IN GVT-FLD.
           PERFORM CLR-GVT-GVT.
           PERFORM CLR-GDG-GVT.
       FIN-CLR-FLD-GVT.
           EXIT.
       
       CLR-GVT-GVT SECTION.
       INI-CLR-GVT-GVT.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FTSN IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-SGV-VCTS IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-LTSN IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-PPCT IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-VPND IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-PAJU IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-VGAS IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-VSIN IN GVT-FLD.
           MOVE SPACES TO GVT-MSC-STAT IN GVT-FLD.
           MOVE SPACES TO GVT-COD-EITS IN GVT-FLD.
           MOVE SPACES TO GVT-COD-ISVS IN GVT-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FRVL IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FING IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-SGV-FISC IN GVT-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FURV IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-SGV-VTTL IN GVT-FLD.
           MOVE SPACES TO GVT-COD-ATRN IN GVT-FLD.
       FIN-CLR-GVT-GVT.
           EXIT.
       
       CLR-GDG-GVT SECTION.
       INI-CLR-GDG-GVT.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GVT-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GVT-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GVT-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GVT-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GVT-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GVT-FLD.
           MOVE SPACES TO GDG-COD-VCON IN GVT-FLD.
       FIN-CLR-GDG-GVT.
           EXIT.
       
       FST-KEY-GVT SECTION.
       INI-FST-KEY-GVT.
           MOVE -1 TO GVT-CAI-GTIA-LEN IN GVT-FLD.
       FIN-FST-KEY-GVT.
           EXIT.
       
       FST-FLD-GVT SECTION.
       INI-FST-FLD-GVT.
      *<<<< INI_FST_FLD_GVT
      *<<<< GEN_BCI
           MOVE -1 TO FRM-IND-GTP-LEN IN GVT-FLD.

           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

      *MHM-INI 14-OCT-2003
           IF SCR-CMND = 'MTA'
               PERFORM PRO-FLD-GVT
               MOVE FRM-CPIM-UBY TO GVT-COD-EITS-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-COD-ISVS-ATR IN GVT-FLD
               MOVE  0 TO FRM-IND-GTP-LEN  IN GVT-FLD
               MOVE -1 TO GVT-COD-EITS-LEN IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

      *MHM-FIN 14-OCT-2003

           IF SCR-CCPP = 'MOD'
               MOVE  0 TO FRM-IND-GTP-LEN  IN GVT-FLD
               MOVE -1 TO GVT-FEC-FTSN-LEN IN GVT-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD
      *MHM-INI 14-OCT-2003
               MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD
      *MHM-FIN 14-OCT-2003
               GO TO FIN-FST-FLD-GVT.

           MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.

      *MHM-INI 11-SEP-2003
           IF SCR-CMND = 'RTF'
               PERFORM PRO-FLD-GVT
               MOVE FRM-CPIM-UBY TO GVT-FEC-FTSN-ATR IN GVT-FLD
               MOVE  0 TO FRM-IND-GTP-LEN  IN GVT-FLD
               MOVE -1 TO GVT-FEC-FTSN-LEN IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

      *MHM-FIN 11-SEP-2003
           IF SCR-CMND = 'RVL'
               MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD
      *MHM-INI 14-OCT-2003
      *         MOVE -1 TO GVT-FEC-FRVL-LEN IN GVT-FLD
                MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD
                MOVE -1 TO GVT-SGV-VCTS-LEN IN GVT-FLD
      *MHM-FIN 14-OCT-2003
           ELSE
               MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD
               MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD
               MOVE -1 TO GVT-FEC-FTSN-LEN IN GVT-FLD.
            
           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.

           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDP-CAI-GTIA IN GDP.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDP-IIC-GTIA IN GDP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDP.
           IF FIO-STAT-OKS
               MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.

      *MHM-INI 15-OCT-2003
           GO TO FIN-FST-FLD-GVT.
      *MHM-FIN 15-OCT-2003
      *>>>>
      *>>>> INI_FST_FLD_GVT
           MOVE -1 TO FRM-IND-GTP-LEN IN GVT-FLD.
       FIN-FST-FLD-GVT.
           EXIT.
       
       PRO-KEY-GVT SECTION.
       INI-PRO-KEY-GVT.
           PERFORM PRO-MKY-GVT.
       FIN-PRO-KEY-GVT.
           EXIT.
       
       PRO-MKY-GVT SECTION.
       INI-PRO-MKY-GVT.
       FIN-PRO-MKY-GVT.
           EXIT.
       
       PRO-FLD-GVT SECTION.
       INI-PRO-FLD-GVT.
      *<<<< INI_PRO_FLD_GVT
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-STP.

           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-STP.

           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-STP.
      *>>>>
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.
           PERFORM PRO-GVT-GVT.
           PERFORM PRO-GDG-GVT.
      *<<<< FIN_PRO_FLD_GVT
           IF SCR-CMND = 'ING' OR                                       
              SCR-CMND = 'INE' OR                                       
              SCR-CMND = 'MOD' OR
              SCR-CMND = 'RTA'                                         
              MOVE FRM-CPIM-AEY TO GVT-COD-SDAG-ATR IN GVT-FLD.
      *>>>>
       FIN-PRO-FLD-GVT.
           EXIT.
       
       PRO-GVT-GVT SECTION.
       INI-PRO-GVT-GVT.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-PPCT-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VSIN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-EITS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-ISVS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-FISC-ATR IN GVT-FLD.
       FIN-PRO-GVT-GVT.
           EXIT.
       
       PRO-GDG-GVT SECTION.
       INI-PRO-GDG-GVT.
       FIN-PRO-GDG-GVT.
           EXIT.
       
       UNP-KEY-GVT SECTION.
       INI-UNP-KEY-GVT.
           PERFORM UNP-IKY-GVT.
           PERFORM UNP-AKY-GVT.
           PERFORM UNP-MKY-GVT.
       FIN-UNP-KEY-GVT.
           EXIT.
       
       UNP-IKY-GVT SECTION.
       INI-UNP-IKY-GVT.
           MOVE FRM-CPIM-UBY TO GVT-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GVT-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GVT-COD-TASN-ATR.
      *<<<< FIN_UNP_IKY_GVT 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = 'ING'
           MOVE FRM-CPIM-AEY TO GVT-COD-TASN-ATR IN GVT-FLD
           MOVE FRM-CPIM-AEY TO GVT-COD-TASN-STP.
      *RRM-FIN 16-APR-2002
      *>>>>      
       FIN-UNP-IKY-GVT.
           EXIT.
       
       UNP-MKY-GVT SECTION.
       INI-UNP-MKY-GVT.
       FIN-UNP-MKY-GVT.
           EXIT.
       
       UNP-AKY-GVT SECTION.
       INI-UNP-AKY-GVT.
           MOVE FRM-CPIM-UBY TO GVT-COD-SDAG-ATR.
       FIN-UNP-AKY-GVT.
           EXIT.
       
       UNP-FLD-GVT SECTION.
       INI-UNP-FLD-GVT.
           MOVE FRM-CPIM-UBY TO FRM-IND-GTP-ATR IN GVT-FLD.
           PERFORM UNP-GVT-GVT.
           PERFORM UNP-GDG-GVT.
      *<<<< FIN_UNP_FLD_GVT
           IF SCR-CMND = 'ING' OR                                       
              SCR-CMND = 'INE' OR                                       
              SCR-CMND = 'MOD'                                          
              MOVE FRM-CPIM-UBY TO GVT-COD-SDAG-ATR IN GVT-FLD.         
      *>>>>
       FIN-UNP-FLD-GVT.
           EXIT.
       
       UNP-GVT-GVT SECTION.
       INI-UNP-GVT-GVT.
           MOVE FRM-CPIM-UBY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-PPCT-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-PAJU-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-VSIN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-COD-EITS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-COD-ISVS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-FEC-FRVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-FISC-ATR IN GVT-FLD.
       FIN-UNP-GVT-GVT.
           EXIT.
       
       UNP-GDG-GVT SECTION.
       INI-UNP-GDG-GVT.
       FIN-UNP-GDG-GVT.
           EXIT.
       
       VAL-MKY-GVT SECTION.
       INI-VAL-MKY-GVT.
       FIN-VAL-MKY-GVT.
           EXIT.
       
       VAL-FLD-GVT SECTION.
       INI-VAL-FLD-GVT.
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
      *VERIFICA SI PRODUCTO (TIPO-SUBTIPO) ES FFMM
           MOVE SPACES              TO WSS-IND-FFMM.
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'PFM'               TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-CGTA IN GDG TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S
               MOVE WSS-S TO WSS-IND-FFMM.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM
           PERFORM VAL-FRM-IND-GTP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-GTP-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * IDG-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-TIP-CGTA-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-STP-CGTA-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * IDG-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * OFI-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-COD-OFIC-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * OFI-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-TREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TREA-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GVT-FEC-FTSN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GVT-FEC-FTSN-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GVT-SGV-VCTS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-VCTS-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-SGV-LTSN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-LTSN-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-SGV-PPCT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-PPCT-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-SGV-VPND.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-VPND-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-SGV-PAJU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-PAJU-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-SGV-VGAS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-VGAS-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-SGV-VSIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-VSIN-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-COD-VCON.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCON-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-VCON.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCON-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-VAL-ULT-CON.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-ULT-CON-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-NUM-GTP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-NUM-GTP-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-MSC-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-MSC-STAT-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-STAT-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-COD-EITS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-COD-EITS-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-EITS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EITS-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-COD-ISVS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-COD-ISVS-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-ISVS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ISVS-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GVT-FEC-FRVL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GVT-FEC-FRVL-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GVT-FEC-FING.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GVT-FEC-FING-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-EXCE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EXCE-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-SGV-FISC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-FISC-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GVT-FEC-FURV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GVT-FEC-FURV-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GVT-SGV-VTTL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-VTTL-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-COD-ATRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-COD-ATRN-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-NUM-FISC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-NUM-FISC-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
       FIN-VAL-FLD-GVT.
           EXIT.
       
       VAL-FRM-IND-GTP SECTION.
       INI-VAL-FRM-IND-GTP.
           IF FRM-IND-GTP IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-GTP IN GVT-FLD.
      *<<<< FRM_IND_GTP
           IF FRM-IND-GTP IN GVT-FLD NOT > SPACES
               MOVE 'N' TO FRM-IND-GTP IN GVT-FLD.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-IND-GTP IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-IND-GTP.
           EXIT.
      * IDG-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.
           IF GDG-TIP-CGTA IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-CGTA IN GVT-FLD.
       FIN-VAL-GDG-TIP-CGTA.
           EXIT.

       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.
           IF GDG-STP-CGTA IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-CGTA IN GVT-FLD.
       FIN-VAL-GDG-STP-CGTA.
           EXIT.
      * IDG-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * OFI-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
           IF GDG-COD-OFIC IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GVT-FLD.
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
      * OFI-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-FRM-GLS-TREA SECTION.
       INI-VAL-FRM-GLS-TREA.
       FIN-VAL-FRM-GLS-TREA.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GVT-FEC-FTSN SECTION.
       INI-VAL-GVT-FEC-FTSN.
           IF GVT-FEC-FTSN IN GVT-FLD  NOT > ZEROES
              MOVE ZEROES TO GVT-FEC-FTSN IN GVT-FLD.
      *VAL-FEC Validar Fecha
           MOVE GVT-FEC-FTSN IN GVT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GVT_FEC_TSN
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
              MOVE FEC-CHOY-N TO FEC-CHOY.                              
      *AFRI-FIN/JUL2005                                                 
           IF SCR-CMND = 'RVL'
               GO TO FIN-VAL-GVT-FEC-FTSN.
           MOVE GVT-FEC-FTSN IN GVT-FLD TO GVT-FEC-FRVL IN GVT-FLD.
      *    GO TO CON-FEC-FTSN.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GVT-FEC-FTSN IN GVT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GVT-FEC-FTSN.
      *<<<< GVT_FEC_TSN
      *
      *CON-FEC-FTSN.
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
               IF FEC-STAT-FER                                          
                   MOVE FEC-FORM-FEC TO FEC-FORM                        
                   MOVE FEC-FBLK-N  TO FEC-FBLK                         
                   MOVE FEC-CHOY-N  TO FEC-CHOY                         
                   MOVE FEC-SIG-HBL TO FEC-CMND                         
                   PERFORM CAL-FEC                                      
                   MOVE  '00' TO FEC-STAT.                              

      *AFRI-FIN/JUL2005                                                 
           IF FEC-STAT-OKS                                              
               MOVE FEC-FECH TO GVT-FEC-FTSN IN GVT-FLD                 
           ELSE                                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE FEC-MENS     TO FRM-MENS                            
               GO TO FIN-VAL-GVT-FEC-FTSN.                              
      *<<<< GVT_FEC_TSN                                                 
      *                                                                 

           MOVE FEC-FBLK-S TO FEC-FBLK.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           IF WSS-FEC-FTSN IN CMA-VARI > ZEROES
               MOVE WSS-FEC-FTSN IN CMA-VARI TO FEC-FVLD IN FEC-VARI
           ELSE
               MOVE 1937 TO FEC-FANO IN FEC-VARI
               MOVE   01 TO FEC-FMES IN FEC-VARI
               MOVE   01 TO FEC-FDIA IN FEC-VARI.

           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GVT-NUM-STSN IN GVT-FLD TO FEC-SEC2.
           MOVE GVT-NUM-ATSN IN GVT-FLD TO FEC-AEC2.
           MOVE GVT-NUM-MTSN IN GVT-FLD TO FEC-MEC2.
           MOVE GVT-NUM-DTSN IN GVT-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'GVTTSNANTIGU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-FTSN.

      * EVA-AFRI/MAY2006                                                
                                                                        
           IF ((SCR-CMND = 'ING' OR SCR-CMND = 'MOD') AND               
               (GDG-TIP-CGTA IN GVT-FLD = '951' OR                      
                GDG-TIP-CGTA IN GVT-FLD = '952'))                       
                MOVE GDG-TIP-CGTA IN GVT-FLD TO TAG-COD-TOPE IN TAG     
                MOVE GDG-STP-CGTA IN GVT-FLD TO TAG-COD-SOPE IN TAG     
                MOVE FIO-GET-KEY TO FIO-CMND                            
                PERFORM BGL-FIO-TAG                                     
                IF NOT FIO-STAT-OKS                                     
                   GO TO FIN-VAL-GVT-FEC-FTSN                           
                ELSE                                                    
                  MOVE TAG-NUM-PVTS IN TAG TO WSS-NUM-PVTS              
                  MOVE TAG-COD-TPVT IN TAG TO WSS-COD-TPVT              
                  IF WSS-COD-TPVT = 'A'                                 
                     MOVE HOY-DHOY TO FEC-ITM1                          
                     MOVE HOY-MHOY TO FEC-ITM2                          
                     MOVE HOY-SHOY TO FEC-ITM3                          
                     MOVE HOY-AHOY TO FEC-ITM4                          
                     MOVE FEC-FORM-FEC TO FEC-FORM                      
                     MOVE WSS-NUM-PVTS TO FEC-NANO                      
                     MOVE FEC-RST-ANO  TO FEC-CMND                     
                     PERFORM CAL-FEC                                    
                     MOVE GVT-NUM-STSN IN GVT-FLD TO WSS-NUM-STSC       
                     MOVE GVT-NUM-ATSN IN GVT-FLD TO WSS-NUM-ATSC       
                     MOVE GVT-NUM-MTSN IN GVT-FLD TO WSS-NUM-MTSC       
                     MOVE GVT-NUM-DTSN IN GVT-FLD TO WSS-NUM-DTSC       
                     MOVE FEC-ITM3                TO WSS-NUM-STM3       
                     MOVE FEC-ITM4                TO WSS-NUM-ATM4       
                     MOVE FEC-ITM2                TO WSS-NUM-MTM2       
                     MOVE FEC-ITM1                TO WSS-NUM-DTM1       
                     IF WSS-FEC-FTSC < WSS-FEC-FECH                     
                         MOVE 'BGL'            TO MSG-COD-SIST          
                         MOVE 'FEC > LIMTAG'   TO MSG-COD-MENS          
                         PERFORM GET-MSG                                
                         MOVE MSG-GLS-DESC     TO FRM-MENS              
                         MOVE FRM-SUAR-MAL     TO FRM-SUAR              
                         GO TO FIN-VAL-GVT-FEC-FTSN                     
                ELSE                                                    
                IF WSS-COD-TPVT = 'M'                                   
                     MOVE HOY-DHOY TO FEC-ITM1                          
                     MOVE HOY-MHOY TO FEC-ITM2                          
                     MOVE HOY-SHOY TO FEC-ITM3                          
                     MOVE HOY-AHOY TO FEC-ITM4                          
                     MOVE FEC-FORM-FEC TO FEC-FORM                      
                     MOVE WSS-NUM-PVTS TO FEC-NMES                      
                     MOVE FEC-RST-MES  TO FEC-CMND                      
                     PERFORM CAL-FEC                                    
                     MOVE GVT-NUM-STSN IN GVT-FLD TO WSS-NUM-STSC       
                     MOVE GVT-NUM-ATSN IN GVT-FLD TO WSS-NUM-ATSC       
                     MOVE GVT-NUM-MTSN IN GVT-FLD TO WSS-NUM-MTSC       
                     MOVE GVT-NUM-DTSN IN GVT-FLD TO WSS-NUM-DTSC       
                     MOVE FEC-ITM3                TO WSS-NUM-STM3       
                     MOVE FEC-ITM4                TO WSS-NUM-ATM4       
                     MOVE FEC-ITM2                TO WSS-NUM-MTM2       
                     MOVE FEC-ITM1                TO WSS-NUM-DTM1       
                     IF WSS-FEC-FTSC < WSS-FEC-FECH                     
                         MOVE 'BGL'            TO MSG-COD-SIST          
                         MOVE 'FEC > LIMTAG'   TO MSG-COD-MENS          
                         PERFORM GET-MSG                                
                         MOVE MSG-GLS-DESC     TO FRM-MENS              
                         MOVE FRM-SUAR-MAL     TO FRM-SUAR              
                         GO TO FIN-VAL-GVT-FEC-FTSN                     
                ELSE                                                    
                IF WSS-COD-TPVT = 'D'                                   
                     MOVE HOY-DHOY TO FEC-ITM1                          
                     MOVE HOY-MHOY TO FEC-ITM2                          
                     MOVE HOY-SHOY TO FEC-ITM3                          
                     MOVE HOY-AHOY TO FEC-ITM4                          
                     MOVE FEC-FORM-FEC TO FEC-FORM                      
                     MOVE WSS-NUM-PVTS TO FEC-NDIA                      
                     MOVE FEC-RST-DIA  TO FEC-CMND                      
                     PERFORM CAL-FEC                                    
                     MOVE GVT-NUM-STSN IN GVT-FLD TO WSS-NUM-STSC       
                     MOVE GVT-NUM-ATSN IN GVT-FLD TO WSS-NUM-ATSC       
                     MOVE GVT-NUM-MTSN IN GVT-FLD TO WSS-NUM-MTSC       
                     MOVE GVT-NUM-DTSN IN GVT-FLD TO WSS-NUM-DTSC       
                     MOVE FEC-ITM3                TO WSS-NUM-STM3       
                     MOVE FEC-ITM4                TO WSS-NUM-ATM4       
                     MOVE FEC-ITM2                TO WSS-NUM-MTM2       
                     MOVE FEC-ITM1                TO WSS-NUM-DTM1       
                     IF WSS-FEC-FTSC < WSS-FEC-FECH                     
                         MOVE 'BGL'            TO MSG-COD-SIST          
                         MOVE 'FEC > LIMTAG'   TO MSG-COD-MENS          
                         PERFORM GET-MSG                                
                         MOVE MSG-GLS-DESC     TO FRM-MENS              
                         MOVE FRM-SUAR-MAL     TO FRM-SUAR              
                         GO TO FIN-VAL-GVT-FEC-FTSN.                    
      * FIN-AFRI/MAY2006                                                
      *>>>>
       FIN-VAL-GVT-FEC-FTSN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GVT-SGV-VCTS SECTION.
       INI-VAL-GVT-SGV-VCTS.
           IF GVT-SGV-VCTS IN GVT-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GVT-SGV-VCTS.
      *<<<< GVT_VAL_CML_TSN
      * EVA-INI/MAY2006                                                 
           IF (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')                    
      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
      *        IF (GVT-SGV-VCTS IN GVT-FLD NOT > 1)
              IF (GVT-SGV-VCTS IN GVT-FLD < 1)
      *MVG-FIN 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
                 MOVE 'BGL'          TO MSG-COD-SIST                    
                 MOVE 'VLRNOPERM'    TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-GVT-SGV-VCTS.                            
      *FIN-AFRI/MAY2006                                                 

      *CGL-INI
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GVT-FLD TO WSS-TIPO-1 IN WSS-VARI.
           MOVE GDG-STP-CGTA IN GVT-FLD TO WSS-AUX-1 IN WSS-VARI.
           MOVE WSS-TIPO-AUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TIAU IN WSS-VARI.

           PERFORM OBT-COD-MNAC.
           IF SCR-CCPP = 'ING' AND
              FRM-IND-GTP IN GVT-FLD = 'S'
               GO TO FIN-VAL-GVT-SGV-VCTS.

           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO WSS-SGV-VCTS-AUX
      *MHM-INI 07-ENE-2004
               MOVE ZEROES TO WSS-VALOR-LIQ IN CMA-VARI
      *MHM-FIN 07-ENE-2004

               MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP
               MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP
               MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP
               MOVE '00' TO FIO-STAT

      *        Suma las tasaciones parciales para llenar valores CML y LIQ
               PERFORM TOT-GTP
               VARYING GAR-COD-ITSN IN WSS-VARI
                     FROM 1 
                     BY   1 
                     UNTIL ( NOT FIO-STAT-OKS) OR 
                           ( MSG-COD-MENS > SPACES)
      * 
      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
           IF WSS-VALOR-LIQ NOT > 1
                  MOVE 1 TO WSS-VALOR-LIQ
                  IF MSG-COD-MENS > SPACES
                      GO TO FIN-VAL-GVT-SGV-VCTS
                  ELSE
                      IF WSS-SGV-VCTS-AUX NOT > ZEROES
                          MOVE 1 TO GVT-SGV-VCTS IN GVT-FLD
                      ELSE
                      MOVE WSS-SGV-VCTS-AUX TO GVT-SGV-VCTS IN GVT-FLD
               ELSE
      *MVG-FIN 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1

               IF MSG-COD-MENS > SPACES
                  GO TO FIN-VAL-GVT-SGV-VCTS
               ELSE
      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
               IF WSS-SGV-VCTS-AUX NOT > ZEROES
                  MOVE 1 TO GVT-SGV-VCTS IN GVT-FLD
               ELSE
      *MVG-FIN 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
                  MOVE WSS-SGV-VCTS-AUX TO GVT-SGV-VCTS IN GVT-FLD.

      * Obtiene valor sin decimales
           IF FIO-STAT-OKS AND 
              GDG-COD-VCAM  IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-SGV-VCTS IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-SGV-VCTS IN GVT-FLD.
      *>>>>
       FIN-VAL-GVT-SGV-VCTS.
           EXIT.
       
       VAL-GVT-SGV-LTSN SECTION.
       INI-VAL-GVT-SGV-LTSN.
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
           IF WSS-IND-FFMM = WSS-S AND SCR-CMND = 'ATA'
               MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-LTSN IN GVT-FLD
               GO TO FIN-VAL-GVT-SGV-LTSN.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM
      *<<<< GVT_SGV_LTSN
      *<<<< GEN_BCI
      * EVA-INI   10/07                                                 
                                                                        
           IF NOT (SCR-CMND = 'RTA' OR SCR-CMND = 'RVL')                
              GO TO VAL-COD-FISCO.                                      
                                                                        
           MOVE ZEROES TO WSS-VAL-PCTJ.                                 
           MOVE ZEROES TO WSS-AUX-PCTJ.                                 
                                                                        
           IF GVT-COD-EITS IN GVT-FLD NOT = '900'                       
              GO TO VAL-COD-FISCO.                                      
                                                                        
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GVT-CAI-GTIA IN GVT.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GVT-IIC-GTIA IN GVT.         
           MOVE 999                     TO GVT-COD-TASN IN GVT.         
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
       LUP-COD-FISCO.                                                   
           PERFORM BGL-FIO-GVT.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               GVT-CAI-GTIA IN GVT-FLD = GVT-CAI-GTIA IN GVT AND        
               GVT-IIC-GTIA IN GVT-FLD = GVT-IIC-GTIA IN GVT)           
               GO TO FIN-VAL-GVT-SGV-LTSN.                              
                                                                        
           IF GVT-COD-EITS IN GVT = '900'                               
              MOVE FIO-GET-PRV TO FIO-CMND                              
              GO TO LUP-COD-FISCO.                                      
                                                                        
           IF GVT-SGV-VCTS IN GVT = GVT-SGV-LTSN IN GVT AND             
              GVT-SGV-VCTS IN GVT-FLD NOT = GVT-SGV-LTSN IN GVT-FLD     
               MOVE 'TAB'     TO MSG-COD-SIST                           
               MOVE 'VAL LIQ<>TAS' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GVT-SGV-LTSN.                              
                                                                        
           IF GVT-SGV-VCTS IN GVT > GVT-SGV-LTSN IN GVT                 
              COMPUTE WSS-VAL-PCTJ ROUNDED =                            
             (GVT-SGV-VCTS IN GVT * 100 / GVT-SGV-LTSN IN GVT)          
           ELSE                                                         
              COMPUTE WSS-VAL-PCTJ ROUNDED =                            
             (GVT-SGV-LTSN IN GVT * 100 / GVT-SGV-VCTS IN GVT).         
                                                                        
           IF GVT-SGV-VCTS IN GVT-FLD > GVT-SGV-LTSN IN GVT-FLD         
              COMPUTE WSS-AUX-PCTJ ROUNDED =                            
             (GVT-SGV-VCTS IN GVT-FLD * 100 / GVT-SGV-LTSN IN GVT-FLD)  
           ELSE                                                         
              COMPUTE WSS-AUX-PCTJ ROUNDED =                            
             (GVT-SGV-LTSN IN GVT-FLD * 100 / GVT-SGV-VCTS IN GVT-FLD). 
                                                                        
           IF NOT (WSS-VAL-PCTJ = WSS-AUX-PCTJ)                         
               MOVE 'TAB'     TO MSG-COD-SIST                           
               MOVE 'PCTJLIQ<>TAS' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GVT-SGV-LTSN.                              
       VAL-COD-FISCO.                                                   
      * EVA-FIN   10/07                                                 
      *FLB CST  4-MAY-1994 ARREGLADO MEJOR QUE ARGENTINA
           IF FRM-IND-GTP IN GVT-FLD = 'S' AND
              WSS-LIQ-CML IN CMA-VARI > ZEROES AND
              WSS-SGV-LTSN IN CMA-VARI =
              GVT-SGV-LTSN IN GVT-FLD
      *CGL-INI
      *AFRI-INI / JUN2006                                               
      *       IF WSS-CIC-TIAU IN WSS-VARI NOT = '952086'                
              IF NOT(WSS-CIC-TIAU IN WSS-VARI  = '952086' OR            
                     WSS-CIC-TIAU IN WSS-VARI  = '952686')              
      *AFRI-FIN / JUN2006                                               
      *CGL-FIN
                 MULTIPLY WSS-LIQ-CML     IN CMA-VARI BY
                        GVT-SGV-VCTS IN GVT-FLD GIVING
                        GVT-SGV-LTSN IN GVT-FLD ROUNDED
      *CGL-INI
              ELSE    
                 COMPUTE WSS-VALOR-LIQ IN CMA-VARI ROUNDED =
                         WSS-VALOR-LIQ IN CMA-VARI * 1
                 MOVE WSS-VALOR-LIQ IN CMA-VARI TO 
                      GVT-SGV-LTSN IN GVT-FLD.
      *CGL-FIN

           IF GDG-COD-VCAM IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-SGV-LTSN IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-SGV-LTSN IN GVT-FLD.

            IF NOT (
                    SCR-CCPP = 'ING' AND
                    FRM-IND-GTP IN GVT-FLD = 'S'
                   ) AND
               GVT-SGV-LTSN IN GVT-FLD NOT > ZEROES
      *        Solo puede ser 0 al Ingresar GVT con Tasaciones Parciales

                MOVE 'BGL'      TO MSG-COD-SIST
                MOVE 'GVTLIQ=0' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GVT-SGV-LTSN.

      *EVA-AFRI/MAY2006                                                 
           IF (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')                    
      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
      *        IF (GVT-SGV-LTSN IN GVT-FLD NOT > 1) AND
              IF (GVT-SGV-LTSN IN GVT-FLD < 1) AND
      *MVG-FIN 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
              FRM-IND-GTP IN GVT-FLD = 'N'                              
                 MOVE 'BGL'          TO MSG-COD-SIST                    
                 MOVE 'VLRNOPERM'    TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-GVT-SGV-LTSN.                            
      *FIN-AFRI/MAY2006                                                 

           IF GVT-SGV-LTSN IN GVT-FLD >
              GVT-SGV-VCTS IN GVT-FLD AND
              NOT (
                  SCR-CCPP = 'ING' AND FRM-IND-GTP IN GVT-FLD = 'S'
                  )
      *MHM-INI 07-ENE-2004
      *AFRI-INI /JUN2006                                                
      *        AND NOT ( SCR-CMND = 'ATA' AND WSS-CIC-TIAU = '952086' ) 
               AND NOT ( SCR-CMND = 'ATA' AND                           
                             (WSS-CIC-TIAU = '952086' OR                
                              WSS-CIC-TIAU = '952686'))                 
      *AFRI-FIN /JUN2006                                                
      *MHM-FIN 07-ENE-2004
               MOVE 'BGL'     TO MSG-COD-SIST
               MOVE 'GVTLIQ>CML' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-SGV-LTSN.
      *>>>>
      *>>>>
      *PVC-INI 19-OCT-2012  -  ADMINISTRACION DE PRENDAS WARRANTS
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST
           MOVE 'MHW'               TO TAB-COD-TTAB IN TAB
           MOVE WSS-CIC-TIAU        TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               COMPUTE  GVT-SGV-LTSN IN GVT-FLD ROUNDED =
                        GVT-SGV-VCTS IN GVT-FLD -
                       (GVT-SGV-VCTS IN GVT-FLD *
                        GAR-SGV-PAJU IN CMA-VARI / 100)
                   GO TO FIN-VAL-GVT-SGV-LTSN.
           MOVE '*' TO WSS-AUX-1
           MOVE WSS-TIPO-AUX     TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               COMPUTE  GVT-SGV-LTSN IN GVT-FLD ROUNDED =
                        GVT-SGV-VCTS IN GVT-FLD -
                       (GVT-SGV-VCTS IN GVT-FLD *
                        GAR-SGV-PAJU IN CMA-VARI / 100).
      *PVC-FIN 19-OCT-2012
      *>>>>
      *>>>>
       FIN-VAL-GVT-SGV-LTSN.
           EXIT.
       
       VAL-GVT-SGV-PPCT SECTION.
       INI-VAL-GVT-SGV-PPCT.
      *
      *<<<< GVT_PCT_PON
           IF GVT-SGV-PPCT IN GVT-FLD = ZEROES
               MOVE GAR-SGV-PPON IN CMA-VARI TO GVT-SGV-PPCT IN GVT-FLD
           ELSE
           IF GVT-SGV-PPCT IN GVT-FLD > 100
               MOVE '% > 100' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GVT-SGV-PPCT.
           EXIT.
       
       VAL-GVT-SGV-VPND SECTION.
       INI-VAL-GVT-SGV-VPND.
      *<<<< GVT_VAL_CML_TSN
      *>>>>
      *<<<< GVT_SGV_VPND
      *<<<< GEN_BCI
           COMPUTE GVT-SGV-VPND IN GVT-FLD ROUNDED =
                   GVT-SGV-LTSN IN GVT-FLD *
                   GVT-SGV-PPCT IN GVT-FLD / 100.

           IF GDG-COD-VCAM IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-SGV-VPND  IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-SGV-VPND  IN GVT-FLD.
      *>>>>
      *>>>>
       FIN-VAL-GVT-SGV-VPND.
           EXIT.
       
       VAL-GVT-SGV-PAJU SECTION.
       INI-VAL-GVT-SGV-PAJU.
      *<<<< GVT_SGV_PAJU
           MOVE GAR-SGV-PAJU IN CMA-VARI TO GVT-SGV-PAJU IN GVT-FLD.
      *>>>>
       FIN-VAL-GVT-SGV-PAJU.
           EXIT.
       
       VAL-GVT-SGV-VGAS SECTION.
       INI-VAL-GVT-SGV-VGAS.
      *<<<< GVT_VAL_AJT_SUP
      *<<<< GEN_BCI
      *AFRI-INI                                                         
           IF SCR-HDR-MRCA = 'BCS'                                      
               IF GVT-SGV-VCTS IN GVT-FLD NOT >                         
                  GVT-SGV-LTSN IN GVT-FLD                               
                   COMPUTE   GVT-SGV-VGAS IN GVT-FLD ROUNDED =          
                     GVT-SGV-VCTS IN GVT-FLD -                          
                     ( GVT-SGV-VCTS IN GVT-FLD *                        
                     GAR-SGV-PAJU     IN CMA-VARI / 100 )               
               ELSE                                                     
                   COMPUTE   GVT-SGV-VGAS IN GVT-FLD ROUNDED =          
                     GVT-SGV-LTSN IN GVT-FLD -                          
                     ( GVT-SGV-LTSN IN GVT-FLD *                        
                     GAR-SGV-PAJU     IN CMA-VARI / 100 )               
           ELSE                                                         
      *AFRI-INI/ JUN2006                                                
      *    IF WSS-CIC-TIAU IN WSS-VARI = '952086'                       
      *OGB-INI VALIDACIONES VALORES EN GVT 03-MAY-2017
      *    IF ( WSS-CIC-TIAU IN WSS-VARI = '952086'  OR
      *         WSS-CIC-TIAU IN WSS-VARI = '952686' )
           IF ( WSS-CIC-TIAU IN WSS-VARI = '952086'  OR
                WSS-CIC-TIAU IN WSS-VARI = '952686' ) OR
                FRM-IND-GTP IN GVT-FLD = 'S'
      *OGB-FIN VALIDACIONES VALORES EN GVT 03-MAY-2017
      *AFRI-FIN/ JUN2006                                                
              MOVE GVT-SGV-LTSN IN GVT-FLD TO GVT-SGV-VGAS IN GVT-FLD   
           ELSE                                                         
      *AFRI-FIN                                                         

           COMPUTE   GVT-SGV-VGAS IN GVT-FLD ROUNDED =
                     GVT-SGV-VCTS IN GVT-FLD -
                   ( GVT-SGV-VCTS IN GVT-FLD *
                     GAR-SGV-PAJU     IN CMA-VARI / 100 ).

           IF GDG-COD-VCAM IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-SGV-VGAS IN GVT-FLD TO 
                    PES-SGV-DECI    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE    IN PES-VARI TO
                    GVT-SGV-VGAS IN GVT-FLD.
      * EVA-AFRI/MAY2006                                                
           IF ((SCR-CMND = 'ING' OR SCR-CMND = 'MOD') AND               
      *AFRI-INI/JUN2006                                                 
      *       (WSS-CIC-TIAU IN WSS-VARI NOT = '952086'))                
              (WSS-CIC-TIAU IN WSS-VARI NOT = '952086'  OR              
               WSS-CIC-TIAU IN WSS-VARI NOT = '952686'))                
      *AFRI-FIN/JUN2006                                                 
               IF NOT ((GVT-SGV-VGAS IN GVT-FLD <                       
                        GVT-SGV-VCTS IN GVT-FLD) OR                     
                       (GVT-SGV-VGAS IN GVT-FLD =                       
                        GVT-SGV-VCTS IN GVT-FLD))                       
                  MOVE 'BGL'       TO MSG-COD-SIST                      
                  MOVE 'M.LEG>V.TSC' TO MSG-COD-MENS                    
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-GVT-SGV-VGAS.                           
      * FIN-AFRI/MAY2006                                                
      *>>>>

      * Se contabiliza por valor ajustado, luego debe ser > 0
      *    salvo en el ingreso con Tasaciones Parciales
           IF NOT (
                   SCR-CCPP = 'ING' AND 
                   FRM-IND-GTP IN GVT-FLD = 'S'
                  ) AND
                   GVT-SGV-VGAS IN GVT-FLD NOT > ZEROES

                MOVE 'BGL'     TO MSG-COD-SIST
                MOVE 'GVTAJT=0' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
           IF GVT-SGV-LTSN IN GVT-FLD = 1 AND
              GVT-SGV-VCTS IN GVT-FLD = 1
                GO TO FIN-VAL-GVT-SGV-VGAS.
      *MVG-FIN 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1

      *OGB-INI VALIDACIONES VALORES EN GVT 03-MAY-2017
           IF SCR-CMND NOT = 'MTA' AND FRM-IND-GTP IN GVT-FLD NOT = 'S'
           IF GVT-SGV-LTSN IN GVT-FLD > GVT-SGV-VGAS IN GVT-FLD
                MOVE WSS-CTE-BGL    TO MSG-COD-SIST
                MOVE WSS-CTE-MSG01  TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR.
                
      *OGB-FIN VALIDACIONES VALORES EN GVT 03-MAY-2017
           PERFORM OBT-VAL-CON.
      *>>>>
       FIN-VAL-GVT-SGV-VGAS.
           EXIT.
       
       VAL-GVT-SGV-VSIN SECTION.
       INI-VAL-GVT-SGV-VSIN.
      *<<<< GVT_SGV_VSIN
      *MHM-INI 17-OCT-2003
           IF SCR-CMND = 'ATA'
               MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-VSIN IN GVT-FLD.

      *MHM-FIN 17-OCT-2003
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GVT-SGV-VSIN IN GVT-FLD NOT > ZEROES
               GO TO FIN-VAL-GVT-SGV-VSIN.
      *MHM-FIN 29-OCT-2003
      *    IF CMA-IND-TSWT IN CMA-VARI NOT = 'N' AND                    
      *       GVT-SGV-VSIN IN GVT-FLD NOT > ZEROES                      
      *        PERFORM ERR-GLS                                          
      *        GO TO FIN-VAL-GVT-SGV-VSIN.                              
      *    IF CMA-IND-TSWT IN CMA-VARI = 'N'                            
      *         MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-VSIN IN GVT-FLD. 
      *>>>>

      *AFRI-INI 07-JUNIO-2006                                           
           IF GVT-SGV-VSIN IN GVT-FLD = ZEROES                          
               MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-VSIN IN GVT-FLD  
               GO TO FIN-VAL-GVT-SGV-VSIN.                              
      *AFRI-FIN 07-JUNIO-2006                                           
      *>>>>
       FIN-VAL-GVT-SGV-VSIN.
           EXIT.
       
       VAL-GDG-COD-VCON SECTION.
       INI-VAL-GDG-COD-VCON.
       FIN-VAL-GDG-COD-VCON.
           EXIT.
       
       VAL-FRM-GLS-VCON SECTION.
       INI-VAL-FRM-GLS-VCON.
       FIN-VAL-FRM-GLS-VCON.
           EXIT.
       
       VAL-FRM-VAL-ULT-CON SECTION.
       INI-VAL-FRM-VAL-ULT-CON.
       FIN-VAL-FRM-VAL-ULT-CON.
           EXIT.
       
       VAL-FRM-NUM-GTP SECTION.
       INI-VAL-FRM-NUM-GTP.
       FIN-VAL-FRM-NUM-GTP.
           EXIT.
       
       VAL-GVT-MSC-STAT SECTION.
       INI-VAL-GVT-MSC-STAT.
       FIN-VAL-GVT-MSC-STAT.
           EXIT.
       
       VAL-FRM-GLS-STAT SECTION.
       INI-VAL-FRM-GLS-STAT.
       FIN-VAL-FRM-GLS-STAT.
           EXIT.
       
       VAL-GVT-COD-EITS SECTION.
       INI-VAL-GVT-COD-EITS.
           IF GVT-COD-EITS IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-COD-EITS IN GVT-FLD.
      *<<<< FIN_GVT_COD_EITS
           IF GVT-COD-EITS IN GVT-FLD NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-GVT-COD-EITS.
      *<<<< FMT_CHI
           MOVE 'TAB'  TO TAB-COD-SIST.
           MOVE 'TAS'  TO TAB-COD-TTAB IN TAB.
           MOVE GVT-COD-EITS IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES       TO FRM-GLS-EITS IN GVT-FLD
              MOVE 'TAB' TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-EITS IN GVT-FLD.
                                                                        
      * EVA-INI   10/07                                                 
                                                                        
           IF SCR-CMND = 'ING' AND                                      
              GVT-COD-EITS IN GVT-FLD = '900'                           
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'ING  NOFISCO' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GVT-COD-EITS.                              
                                                                        
      * EVA-FIN   10/07                                                 
      *>>>>
      *>>>>
       FIN-VAL-GVT-COD-EITS.
           EXIT.
       
       VAL-FRM-GLS-EITS SECTION.
       INI-VAL-FRM-GLS-EITS.
       FIN-VAL-FRM-GLS-EITS.
           EXIT.
       
       VAL-GVT-COD-ISVS SECTION.
       INI-VAL-GVT-COD-ISVS.
           IF GVT-COD-ISVS IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-COD-ISVS IN GVT-FLD.
      *<<<< GVT_COD_ISVS
      *MHM-INI 9-MAR-2004                                               
      *        MOVE SPACES TO GVT-COD-ISVS IN GVT-FLD.                  
              MOVE SPACES TO GVT-COD-ISVS IN GVT-FLD                    
              MOVE SPACES TO FRM-GLS-ISVS IN GVT-FLD                    
              GO TO FIN-VAL-GVT-COD-ISVS.                               
      *MHM-FIN 9-MAR-2004                                               
           MOVE 'TAB'  TO TAB-COD-SIST.
      *<<<< GEN_BCI
           MOVE 'TAS'  TO TAB-COD-TTAB IN TAB.
      *>>>>
           MOVE GVT-COD-ISVS IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES       TO FRM-GLS-ISVS IN GVT-FLD
              MOVE 'TAB' TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ISVS IN GVT-FLD.
      *>>>>
       FIN-VAL-GVT-COD-ISVS.
           EXIT.
       
       VAL-FRM-GLS-ISVS SECTION.
       INI-VAL-FRM-GLS-ISVS.
       FIN-VAL-FRM-GLS-ISVS.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GVT-FEC-FRVL SECTION.
       INI-VAL-GVT-FEC-FRVL.
           IF GVT-FEC-FRVL IN GVT-FLD  NOT > ZEROES
              MOVE ZEROES TO GVT-FEC-FRVL IN GVT-FLD.
      *VAL-FEC Validar Fecha
           MOVE GVT-FEC-FRVL IN GVT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<<                               
           MOVE FEC-VAL-FEC TO FEC-CMND.                                
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
              MOVE FEC-CHOY-N TO FEC-CHOY.                              
      *AFRI-FIN/JUL2005  
           PERFORM PRO-FEC.                                               
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
               IF FEC-STAT-FER                                          
                   MOVE FEC-FORM-FEC TO FEC-FORM                        
                   MOVE FEC-FBLK-N  TO FEC-FBLK                         
                   MOVE FEC-CHOY-N  TO FEC-CHOY                         
                   MOVE FEC-SIG-HBL TO FEC-CMND                         
                   PERFORM CAL-FEC                                      
                   MOVE  '00' TO FEC-STAT.                              
           GO TO CNT-FEC-FRVL.
      *AFRI-FIN/JUL2005                                                 
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GVT-FEC-FRVL IN GVT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GVT-FEC-FRVL.
      *<<<< GVT_FEC_FRVL
       CNT-FEC-FRVL.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GVT-FEC-FRVL IN GVT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GVT-FEC-FRVL.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GVT-NUM-STSN IN GVT-FLD TO FEC-SEC1.
           MOVE GVT-NUM-ATSN IN GVT-FLD TO FEC-AEC1.
           MOVE GVT-NUM-MTSN IN GVT-FLD TO FEC-MEC1.
           MOVE GVT-NUM-DTSN IN GVT-FLD TO FEC-DEC1.

           MOVE GVT-NUM-SRVL IN GVT-FLD TO FEC-SEC2.
           MOVE GVT-NUM-ARVL IN GVT-FLD TO FEC-AEC2.
           MOVE GVT-NUM-MRVL IN GVT-FLD TO FEC-MEC2.
           MOVE GVT-NUM-DRVL IN GVT-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'GVTRVLANTIGU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-FRVL.

           IF GAR-NUM-PVTS IN CMA-VARI NOT > ZEROES
               GO TO FIN-VAL-VIG-RVL.

      * Suma periodo de vigencia a Fecha Tasacion

           MOVE GVT-NUM-STSN IN GVT-FLD TO FEC-ITM3.
           MOVE GVT-NUM-ATSN IN GVT-FLD TO FEC-ITM4.
           MOVE GVT-NUM-MTSN IN GVT-FLD TO FEC-ITM2.
           MOVE GVT-NUM-DTSN IN GVT-FLD TO FEC-ITM1.

           IF GAR-COD-TPVT IN CMA-VARI = 'A'
               MOVE GAR-NUM-PVTS IN CMA-VARI TO FEC-NANO
               MOVE FEC-SUM-ANO              TO FEC-CMND
           ELSE
           IF GAR-COD-TPVT IN CMA-VARI = 'M'
               MOVE GAR-NUM-PVTS IN CMA-VARI TO FEC-NMES
               MOVE FEC-SUM-MES              TO FEC-CMND
           ELSE
           IF GAR-COD-TPVT IN CMA-VARI = 'D'
               MOVE GAR-NUM-PVTS IN CMA-VARI TO FEC-NDIA
               MOVE FEC-SUM-DIA              TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
      *<<<< NOT PGM_VMS
           PERFORM CAL-FEC.
      *>>>>
           
      * Usa fecha resultante como Fecha Maxima de Revalorizacion
           MOVE FEC-ITM1 TO FEC-DEC1.
           MOVE FEC-ITM2 TO FEC-MEC1.
           MOVE FEC-ITM3 TO FEC-SEC1.
           MOVE FEC-ITM4 TO FEC-AEC1.

           MOVE GVT-NUM-SRVL IN GVT-FLD TO FEC-SEC2.
           MOVE GVT-NUM-ARVL IN GVT-FLD TO FEC-AEC2.
           MOVE GVT-NUM-MRVL IN GVT-FLD TO FEC-MEC2.
           MOVE GVT-NUM-DRVL IN GVT-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'GVTRVL>VIG'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-FRVL.
       FIN-VAL-VIG-RVL.
      *>>>>
       FIN-VAL-GVT-FEC-FRVL.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GVT-FEC-FING SECTION.
       INI-VAL-GVT-FEC-FING.
           IF GVT-FEC-FING IN GVT-FLD  NOT > ZEROES
              MOVE ZEROES TO GVT-FEC-FING IN GVT-FLD.
       FIN-VAL-GVT-FEC-FING.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-EXCE SECTION.
       INI-VAL-FRM-GLS-EXCE.
       FIN-VAL-FRM-GLS-EXCE.
           EXIT.
       
       VAL-GVT-SGV-FISC SECTION.
       INI-VAL-GVT-SGV-FISC.
       FIN-VAL-GVT-SGV-FISC.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GVT-FEC-FURV SECTION.
       INI-VAL-GVT-FEC-FURV.
           IF GVT-FEC-FURV IN GVT-FLD  NOT > ZEROES
              MOVE ZEROES TO GVT-FEC-FURV IN GVT-FLD.
       FIN-VAL-GVT-FEC-FURV.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GVT-SGV-VTTL SECTION.
       INI-VAL-GVT-SGV-VTTL.
      *<<<<
      * EVA-INI  06/08                                                  
           IF SCR-HDR-MRCA = 'BCS'                                      
              GO TO FIN-VAL-GVT-SGV-VTTL.                               
                                                                        
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
                                                                        
           MOVE GDG-COD-CGTA IN GDG TO WSS-COD-CGTA IN WSS-VARI.        
                                                                        
           MOVE 'BGL'                    TO TAB-COD-SIST FIO-SIST.      
           MOVE 'MTM'                    TO TAB-COD-TTAB IN TAB.        
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
              MOVE ZEROES TO GVT-SGV-VTTL IN GVT-FLD                    
           ELSE                                                         
              MOVE GVT-SGV-VCTS IN GVT-FLD TO                           
                   GVT-SGV-VTTL IN GVT-FLD.                             
      * EVA-FIN  06/08                                                  
      *>>>>
       FIN-VAL-GVT-SGV-VTTL.
           EXIT.
       
       VAL-GVT-COD-ATRN SECTION.
       INI-VAL-GVT-COD-ATRN.
       FIN-VAL-GVT-COD-ATRN.
           EXIT.
       
       VAL-FRM-NUM-FISC SECTION.
       INI-VAL-FRM-NUM-FISC.
       FIN-VAL-FRM-NUM-FISC.
           EXIT.
       
       VAL-CON-FLD-GVT SECTION.
       INI-VAL-CON-FLD-GVT.
       FIN-VAL-CON-FLD-GVT.
           EXIT.
       
       VAL-CON-GVT SECTION.
       INI-VAL-CON-GVT.
       FIN-VAL-CON-GVT.
           EXIT.
       
       VAL-NUM-KEY-GVT SECTION.
       INI-VAL-NUM-KEY-GVT.
           PERFORM VAL-NUM-IKY-GVT.
           PERFORM VAL-NUM-MKY-GVT.
           PERFORM VAL-NUM-AKY-GVT.
       FIN-VAL-NUM-KEY-GVT.
           EXIT.
       
       VAL-NUM-IKY-GVT SECTION.
       INI-VAL-NUM-IKY-GVT.
       VAL-NUM-GVT-IIC-GTIA.
           MOVE GVT-IIC-GTIA-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GVT-IIC-GTIA IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-IIC-GTIA-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-IKY-GVT.
       VAL-NUM-GVT-COD-TASN.
           MOVE GVT-COD-TASN-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GVT-COD-TASN IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-COD-TASN-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-IKY-GVT.
       FIN-VAL-NUM-IKY-GVT.
           EXIT.
       
       VAL-NUM-MKY-GVT SECTION.
       INI-VAL-NUM-MKY-GVT.
       FIN-VAL-NUM-MKY-GVT.
           EXIT.
       
       VAL-NUM-AKY-GVT SECTION.
       INI-VAL-NUM-AKY-GVT.
       FIN-VAL-NUM-AKY-GVT.
           EXIT.
       
       VAL-NUM-FLD-GVT SECTION.
       INI-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VCTS.
           MOVE GVT-SGV-VCTS-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VCTS IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VCTS-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-LTSN.
           MOVE GVT-SGV-LTSN-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-LTSN IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-LTSN-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-PPCT.
           MOVE GVT-SGV-PPCT-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-PPCT IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-PPCT-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VPND.
           MOVE GVT-SGV-VPND-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VPND IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VPND-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-PAJU.
           MOVE GVT-SGV-PAJU-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-PAJU IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-PAJU-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VGAS.
           MOVE GVT-SGV-VGAS-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VGAS IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VGAS-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VSIN.
           MOVE GVT-SGV-VSIN-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VSIN IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VSIN-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-FRM-VAL-ULT-CON.
           MOVE FRM-VAL-ULT-CON-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-ULT-CON IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-ULT-CON-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-FRM-NUM-GTP.
           MOVE FRM-NUM-GTP-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-GTP IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-GTP-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-FISC.
           MOVE GVT-SGV-FISC-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-FISC IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-FISC-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VTTL.
           MOVE GVT-SGV-VTTL-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VTTL IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VTTL-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-FRM-NUM-FISC.
           MOVE FRM-NUM-FISC-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-FISC IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-FISC-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       FIN-VAL-NUM-FLD-GVT.
           EXIT.
       
       EDT-KEY-GVT SECTION.
       INI-EDT-KEY-GVT.
           PERFORM EDT-IKY-GVT.
           PERFORM EDT-MKY-GVT.
           PERFORM EDT-AKY-GVT.
       FIN-EDT-KEY-GVT.
           EXIT.
       
       EDT-IKY-GVT SECTION.
       INI-EDT-IKY-GVT.
           IF GVT-IIC-GTIA-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-IIC-GTIA-LEN IN GVT-FLD
                GO TO FIN-EDT-IKY-GVT.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GVT-IIC-GTIA-EDT IN GVT-EDT.
           MOVE GVT-IIC-GTIA-EDT IN GVT-EDT TO 
                GVT-IIC-GTIA-ALF IN GVT-FLD.
           IF GVT-COD-TASN-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-COD-TASN-LEN IN GVT-FLD
                GO TO FIN-EDT-IKY-GVT.
           MOVE GVT-COD-TASN IN GVT-FLD TO GVT-COD-TASN-EDT IN GVT-EDT.
           MOVE GVT-COD-TASN-EDT IN GVT-EDT TO 
                GVT-COD-TASN-ALF IN GVT-FLD.
       FIN-EDT-IKY-GVT.
           EXIT.
       
       EDT-MKY-GVT SECTION.
       INI-EDT-MKY-GVT.
       FIN-EDT-MKY-GVT.
           EXIT.
       
       EDT-AKY-GVT SECTION.
       INI-EDT-AKY-GVT.
       FIN-EDT-AKY-GVT.
           EXIT.
       
       EDT-FLD-GVT SECTION.
       INI-EDT-FLD-GVT.
           IF GVT-SGV-VCTS-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VCTS-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-VCTS-EDT IN GVT-EDT.
           MOVE GVT-SGV-VCTS-EDT IN GVT-EDT TO 
                GVT-SGV-VCTS-ALF IN GVT-FLD.
           IF GVT-SGV-LTSN-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-LTSN-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-LTSN IN GVT-FLD TO GVT-SGV-LTSN-EDT IN GVT-EDT.
           MOVE GVT-SGV-LTSN-EDT IN GVT-EDT TO 
                GVT-SGV-LTSN-ALF IN GVT-FLD.
           IF GVT-SGV-PPCT-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-PPCT-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-PPCT IN GVT-FLD TO GVT-SGV-PPCT-EDT IN GVT-EDT.
           MOVE GVT-SGV-PPCT-EDT IN GVT-EDT TO 
                GVT-SGV-PPCT-ALF IN GVT-FLD.
           IF GVT-SGV-VPND-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VPND-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VPND IN GVT-FLD TO GVT-SGV-VPND-EDT IN GVT-EDT.
           MOVE GVT-SGV-VPND-EDT IN GVT-EDT TO 
                GVT-SGV-VPND-ALF IN GVT-FLD.
           IF GVT-SGV-PAJU-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-PAJU-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-PAJU IN GVT-FLD TO GVT-SGV-PAJU-EDT IN GVT-EDT.
           MOVE GVT-SGV-PAJU-EDT IN GVT-EDT TO 
                GVT-SGV-PAJU-ALF IN GVT-FLD.
           IF GVT-SGV-VGAS-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VGAS-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VGAS IN GVT-FLD TO GVT-SGV-VGAS-EDT IN GVT-EDT.
           MOVE GVT-SGV-VGAS-EDT IN GVT-EDT TO 
                GVT-SGV-VGAS-ALF IN GVT-FLD.
           IF GVT-SGV-VSIN-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VSIN-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VSIN IN GVT-FLD TO GVT-SGV-VSIN-EDT IN GVT-EDT.
           MOVE GVT-SGV-VSIN-EDT IN GVT-EDT TO 
                GVT-SGV-VSIN-ALF IN GVT-FLD.
           IF FRM-VAL-ULT-CON-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-ULT-CON-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE FRM-VAL-ULT-CON IN GVT-FLD TO 
                FRM-VAL-ULT-CON-EDT IN GVT-EDT.
           MOVE FRM-VAL-ULT-CON-EDT IN GVT-EDT TO 
                FRM-VAL-ULT-CON-ALF IN GVT-FLD.
           IF FRM-NUM-GTP-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-GTP-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE FRM-NUM-GTP IN GVT-FLD TO FRM-NUM-GTP-EDT IN GVT-EDT.
           MOVE FRM-NUM-GTP-EDT IN GVT-EDT TO 
                FRM-NUM-GTP-ALF IN GVT-FLD.
           IF GVT-SGV-FISC-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-FISC-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-FISC IN GVT-FLD TO GVT-SGV-FISC-EDT IN GVT-EDT.
           MOVE GVT-SGV-FISC-EDT IN GVT-EDT TO 
                GVT-SGV-FISC-ALF IN GVT-FLD.
           IF GVT-SGV-VTTL-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VTTL-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VTTL IN GVT-FLD TO GVT-SGV-VTTL-EDT IN GVT-EDT.
           MOVE GVT-SGV-VTTL-EDT IN GVT-EDT TO 
                GVT-SGV-VTTL-ALF IN GVT-FLD.
           IF FRM-NUM-FISC-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-FISC-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE FRM-NUM-FISC IN GVT-FLD TO FRM-NUM-FISC-EDT IN GVT-EDT.
           MOVE FRM-NUM-FISC-EDT IN GVT-EDT TO 
                FRM-NUM-FISC-ALF IN GVT-FLD.
       FIN-EDT-FLD-GVT.
           EXIT.
      *<<<< EOF_VAX OR EOF_BU
       TOT-GTP SECTION.
       INI-TOT-GTP.
      *    Devuelve Sumatoria Tasaciones Parciales en WSS-SGV-VCTS-AUX

           MOVE GAR-COD-ITSN IN WSS-VARI TO
                GTP-COD-ITSN IN GTP.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GTP.
      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
           MOVE GTP-SGV-VTSN IN GTP TO WSS-VAR-LTSN.
           IF WSS-VAR-LTSN = 1
              MOVE ZEROES TO WSS-VAR-LTSN.
      *MVG-FIN 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1

      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
           IF WSS-IND-FFMM = WSS-S
              COMPUTE WSS-GTP-ITSN ROUNDED
                                    = GTP-SGV-ITSN IN GTP / WSS-100
           ELSE
              MOVE GTP-SGV-ITSN IN GTP TO WSS-GTP-ITSN.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM

           IF FIO-STAT-OKS AND
              GTP-COD-EITS IN GTP > '09' AND < '15'
              COMPUTE
                 WSS-SGV-VCTS-AUX ROUNDED = WSS-SGV-VCTS-AUX +
      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
      *AFRI-INI / NOV 2016 REDONDEAR VALOR TASACION
      **          GTP-SGV-ITSN IN GTP * GTP-SGV-VTSN IN GTP.
      *           GTP-SGV-ITSN IN GTP * GTP-SGV-VTSN IN GTP
      *        IF GDG-COD-VCAM  IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
      *              MOVE WSS-SGV-VCTS-AUX        TO
      *                   PES-SGV-DECI IN PES-VARI
      *              PERFORM PES-SCTV
      *              MOVE PES-SGV-ENTE IN PES-VARI TO
      *                   WSS-SGV-VCTS-AUX.
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
      *          GTP-SGV-ITSN IN GTP * WSS-VAR-LTSN
                 WSS-GTP-ITSN        * WSS-VAR-LTSN
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM

              IF GDG-COD-VCAM  IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
                    MOVE WSS-SGV-VCTS-AUX        TO
                         PES-SGV-DECI IN PES-VARI
                    PERFORM PES-SCTV
                    MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-SGV-VCTS-AUX.
      *AFRI-FIN / NOV 2016 REDONDEAR VALOR TASACION
      *MVG-FIN 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
      *CGL-INI
      *MHM-INI 07-ENE-2004
      *    IF WSS-CIC-TIAU IN WSS-VARI = '952086'
                   IF FIO-STAT-OKS AND
              GTP-COD-EITS IN GTP > '09' AND < '15' AND
      *AFRI-INI /JUN2006                                                
      *       WSS-CIC-TIAU IN WSS-VARI = '952086'                       
             (WSS-CIC-TIAU IN WSS-VARI = '952086'  OR  = '952686')      
      *       WSS-CIC-TIAU IN WSS-VARI = '952686')                      
      *AFRI-FIN /JUN2006                                                
      *MHM-FIN 07-ENE-2004
      *AFRI-INI /JUN2006                                                
      *       MOVE GTP-COD-IITS IN GTP     TO ACC-COD-NEMO IN ACC       
      *       MOVE 99                      TO ACC-NUM-SPRO IN ACC       
      *       MOVE 99                      TO ACC-NUM-APRO IN ACC       
      *       MOVE 99                      TO ACC-NUM-MPRO IN ACC       
      *       MOVE 99                      TO ACC-NUM-DPRO IN ACC       
      *       MOVE FIO-GET-LEQ TO FIO-CMND                              
      *       PERFORM BGL-FIO-ACC                                       
      *       IF NOT (FIO-STAT-OKS AND                                  
      *               ACC-COD-NEMO IN ACC = GTP-COD-IITS IN GTP)        
      *          NEXT SENTENCE                                          
      *           MOVE 'BGL'       TO MSG-COD-SIST                      
      *           MOVE 'ACC   NEX' TO MSG-COD-MENS                      
      *           PERFORM GET-MSG                                       
      *           MOVE MSG-GLS-DESC TO FRM-MENS                         
      *           MOVE FRM-SUAR-MAL TO FRM-SUAR                         
      *       ELSE                                                      
      *                                                                 
               MOVE 'BGL'                   TO TAB-COD-SIST FIO-SIST    
               MOVE 'NEM'                   TO TAB-COD-TTAB IN TAB      
               MOVE GTP-COD-IITS IN GTP     TO TAB-COD-CTAB IN TAB      
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF NOT (FIO-STAT-OKS AND   TAB-IND-VIGE IN TAB ='S')     
                  GO TO FIN-TOT-GTP                                     
               ELSE                                                     
                 MOVE TAB-GLS-DATA IN TAB  TO WSS-NEM-GLOSA IN WSS-VARI 
                 MOVE 'BGL'                TO TAB-COD-SIST FIO-SIST     
                 MOVE 'LST'                TO TAB-COD-TTAB IN TAB       
                 MOVE WSS-NEM-ACCN IN WSS-VARI  TO TAB-COD-CTAB IN TAB  
                 MOVE FIO-GET-KEY TO FIO-CMND                           
                 PERFORM GNS-FIO-TAB                                    
                 IF NOT (FIO-STAT-OKS AND   TAB-IND-VIGE IN TAB ='S')   
                     GO TO FIN-TOT-GTP                                  
                 ELSE                                                   
                     MOVE TAB-GLS-DATA IN TAB  TO                       
                                          WSS-LST-GLOSA IN WSS-VARI     
      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
                     IF WSS-LST-PPON IN WSS-VARI NOT > SPACES
                         GO TO FIN-TOT-GTP
                     ELSE
      *MVG-FIN 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
                     MOVE WSS-LST-PPON IN WSS-VARI TO                   
                                          WSS-NUM-PPON IN WSS-VARI      
                     COMPUTE WSS-VAL-PPON IN WSS-VARI=                  
                            WSS-NUM-PPON / 10000                        
                                                                        
                     COMPUTE WSS-VALOR-LIQ IN CMA-VARI=                 
      *MHM-INI 07-ENE-2004
      *AFRI MAYO 2006                                                   
      *          ((GTP-SGV-ITSN IN GTP * GTP-SGV-VTSN IN GTP  *         
      *                 ACC-SGV-PPON IN ACC ) / 100) +                  
      *          ((GTP-SGV-ITSN IN GTP * GTP-SGV-VTSN IN GTP ) /        
      *                  (ACC-SGV-PPON IN ACC * 100 ) +                 
      *                                                                 
      *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
      *          (((GTP-SGV-ITSN IN GTP * GTP-SGV-VTSN IN GTP ) /
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
      *         (((GTP-SGV-ITSN IN GTP * WSS-VAR-LTSN ) /
                (((WSS-GTP-ITSN        * WSS-VAR-LTSN ) /
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM
      *MVG-FIN 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
                          WSS-VAL-PPON IN WSS-VARI ) +                  
                                                                        
      *AFRI MAYO 2006                                                   
      *          ((WSS-SGV-VCTS-AUX * ACC-SGV-PPON IN ACC)/100) +
      *MHM-FIN 07-ENE-2004
                   WSS-VALOR-LIQ).
      *AFRI-FIN /JUN2006                                                
      *CGL-FIN
           IF  NOT GTP-COD-EITS IN GTP > '09'
               MOVE 'BGL'      TO MSG-COD-SIST
               MOVE 'ESAP NOV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

       FIN-TOT-GTP.
           EXIT.
      *>>>>
      *<<<< EOF_VAX 
       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       PRO-RTA-RDO SECTION.
       INI-PRO-RTA-RDO.
      *GET-HOY Otiene Fecha actual
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO GVT-FEC-FTSN IN GVT-FLD.
      *PROTEJE CAMPOS
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-STP.

       FIN-PRO-RTA-RDO.
           EXIT.


       OBT-VAL-CON SECTION.
       INI-OBT-VAL-CON.
           MOVE GDG-COD-VCAM IN GVT-FLD TO GDG-COD-VCAM IN GDG.
           IF NOT (
              GDG-COD-TVCM IN GDG = '0' AND
              GDG-COD-VCAM IN GVT-FLD NOT = WSS-COD-PESO IN WSS-VARI
              )
               MOVE GVT-SGV-VGAS IN GVT-FLD TO
                    FRM-VAL-ULT-CON IN GVT-FLD

               GO TO FIN-OBT-VAL-CON.

                                                                        
      *      ** Correcciln Monetaria - Revalorizador **      *          
      *               SEPTIEMBRE 2007  -  AFRI *             *          
                                                                        
      ** EVA-INI  09/07                                                 
                                                                        
           MOVE ZEROES TO WSS-FEC-FULR.                                 
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GVT-CAI-GTIA IN GVT.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GVT-IIC-GTIA IN GVT.         
           MOVE GVT-COD-TASN IN GVT-FLD TO GVT-COD-TASN IN GVT.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GVT.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-OBT-VAL-CON.                                    
                                                                        
           IF NOT (GVT-FEC-FURV IN GVT > ZEROES)                        
              GO TO CON-OBT-VAL.                                        
                
           IF GVT-FEC-FTSN IN GVT > GVT-FEC-FRVL IN GVT                 
              MOVE GVT-FEC-FTSN IN GVT TO WSS-FEC-FULR                  
           ELSE                                                         
              MOVE GVT-FEC-FRVL IN GVT TO WSS-FEC-FULR.                 
                                                                        
           IF GVT-FEC-FURV IN GVT > WSS-FEC-FULR                        
              MOVE GVT-FEC-FURV IN GVT TO WSS-FEC-FULR.                 
                                                                        
           MOVE WSS-NUM-SULR TO CAM-NUM-SCAM IN CAM(1).                 
           MOVE WSS-NUM-AULR TO CAM-NUM-ACAM IN CAM(1).                 
           MOVE WSS-NUM-MULR TO CAM-NUM-MCAM IN CAM(1).                 
           MOVE WSS-NUM-DULR TO CAM-NUM-DCAM IN CAM(1).                 
           GO TO NXT-OBT-VAL.                                           
                                                                        
       CON-OBT-VAL.                                                     
           MOVE GVT-NUM-SRVL IN GVT TO CAM-NUM-SCAM IN CAM(1).          
           MOVE GVT-NUM-ARVL IN GVT TO CAM-NUM-ACAM IN CAM(1).          
           MOVE GVT-NUM-MRVL IN GVT TO CAM-NUM-MCAM IN CAM(1).          
           MOVE GVT-NUM-DRVL IN GVT TO CAM-NUM-DCAM IN CAM(1).          
       NXT-OBT-VAL.                                                     
                                                                        
      ** EVA-FIN  09/07                                                 

           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE GDG-COD-VCAM IN GVT-FLD  TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
              )
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MULTIPLY GVT-SGV-VGAS IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED
               MOVE WSS-VAL-PESO TO FRM-VAL-ULT-CON IN GVT-FLD.
       FIN-OBT-VAL-CON.
           EXIT.

      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
       PRO-LEE-MSG SECTION.                                             
       INI-PRO-LEE-MSG.                                                 
           MOVE SPACES TO WSS-GLS-CMSG IN WSS-VARI.
           MOVE 'BGL'                    TO TAB-COD-SIST FIO-SIST.      
           MOVE 'MSG'                    TO TAB-CIC-TTAB IN TAB.        
           MOVE WSS-COD-CMSG IN WSS-VARI TO TAB-CIC-CTAB IN TAB.        
           MOVE 'TAB-CIC-TABL'           TO FIO-AKEY.                   
           MOVE FIO-GET-KEY              TO FIO-CMND.                   
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S') OR
            TAB-COD-CTAB IN TAB = SPACES
               MOVE 'BGL'          TO MSG-COD-SIST                      
               MOVE 'MSGEXCEP NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-PRO-LEE-MSG
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CMSG IN WSS-VARI.    
       FIN-PRO-LEE-MSG.                                                 
           EXIT.                                                        
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012 
      *>>>> 
