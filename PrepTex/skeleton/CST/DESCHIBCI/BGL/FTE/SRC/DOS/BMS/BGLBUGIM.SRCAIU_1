      *
      * BGLBUGIM
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 04:55 PM
      *
       SET-TAG-BGLBUGIM SECTION.
       INI-SET-TAG-BGLBUGIM.
           MOVE
           '<IDNMOD NOM=$BGLBUGIM$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 04:55 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGIM.
           EXIT.
           
       RET-ALL-GIM SECTION.
       INI-RET-ALL-GIM.
           PERFORM KEY-ALL-GIM.
           PERFORM RET-GIM-GIM.
           PERFORM RET-GDG-GIM.
           PERFORM RET-GVT-GIM.
       FIN-RET-ALL-GIM.
           EXIT.
       
       RET-GIM-GIM SECTION.
       INI-RET-GIM-GIM.
           MOVE GIM-COD-STIM IN GIM-FLD TO GIM-COD-STIM IN GIM.
           MOVE GIM-NUM-EDIM IN GIM-FLD TO GIM-NUM-EDIM IN GIM.
           MOVE GIM-COD-TCNS IN GIM-FLD TO GIM-COD-TCNS IN GIM.
           MOVE GIM-COD-UMDI IN GIM-FLD TO GIM-COD-UMDI IN GIM.
           MOVE GIM-VAL-COIM IN GIM-FLD TO GIM-VAL-COIM IN GIM.
           MOVE GIM-VAL-TEIM IN GIM-FLD TO GIM-VAL-TEIM IN GIM.
           MOVE GIM-GLS-NOAR IN GIM-FLD TO GIM-GLS-NOAR IN GIM.
           MOVE GIM-VAL-MOAR IN GIM-FLD TO GIM-VAL-MOAR IN GIM.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GIM-NUM-DVAR IN GIM-FLD TO GIM-NUM-DVAR IN GIM.
           MOVE GIM-NUM-MVAR IN GIM-FLD TO GIM-NUM-MVAR IN GIM.
           MOVE GIM-NUM-SVAR IN GIM-FLD TO GIM-NUM-SVAR IN GIM.
           MOVE GIM-NUM-AVAR IN GIM-FLD TO GIM-NUM-AVAR IN GIM.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GIM-IND-GASC IN GIM-FLD TO GIM-IND-GASC IN GIM.
           MOVE GIM-COD-DEST IN GIM-FLD TO GIM-COD-DEST IN GIM.
       FIN-RET-GIM-GIM.
           EXIT.
       
       RET-GDG-GIM SECTION.
       INI-RET-GDG-GIM.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GIM-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GIM-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
      * OFI-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-OFIC IN GIM-FLD TO GDG-COD-OFIC IN GDG.
      * OFI-FIN --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-VCAM IN GIM-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-GLS-DGTA IN GIM-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-GLS-DGT1 IN GIM-FLD TO GDG-GLS-DGT1 IN GDG.
       FIN-RET-GDG-GIM.
           EXIT.
       
       RET-GVT-GIM SECTION.
       INI-RET-GVT-GIM.
           MOVE GVT-SGV-FISI IN GIM-FLD TO GVT-SGV-FISI IN GVT.
       FIN-RET-GVT-GIM.
           EXIT.
       
       KEY-ALL-GIM SECTION.
       INI-KEY-ALL-GIM.
           PERFORM KEY-GIM-GIM.
           PERFORM KEY-GDG-GIM.
           PERFORM KEY-GVT-GIM.
       FIN-KEY-ALL-GIM.
           EXIT.
       
       KEY-GIM-GIM SECTION.
       INI-KEY-GIM-GIM.
           MOVE GIM-CAI-GTIA IN GIM-FLD TO GIM-CAI-GTIA IN GIM.
           MOVE GIM-IIC-GTIA IN GIM-FLD TO GIM-IIC-GTIA IN GIM.
       FIN-KEY-GIM-GIM.
           EXIT.
       
       KEY-GDG-GIM SECTION.
       INI-KEY-GDG-GIM.
       FIN-KEY-GDG-GIM.
           EXIT.
       
       KEY-GVT-GIM SECTION.
       INI-KEY-GVT-GIM.
       FIN-KEY-GVT-GIM.
           EXIT.
       
       SCR-CLRA-GIM SECTION.
       INI-SCR-CLRA-GIM.
           PERFORM CLR-KEY-GIM.
           PERFORM CLR-FLD-GIM.
       FIN-SCR-CLRA-GIM.
           EXIT.
       
       CLR-KEY-GIM SECTION.
       INI-CLR-KEY-GIM.
           MOVE SPACES TO GIM-CAI-GTIA IN GIM-FLD.
           MOVE ZEROES TO GIM-IIC-GTIA IN GIM-FLD.
       FIN-CLR-KEY-GIM.
           EXIT.
       
       CLR-FLD-GIM SECTION.
       INI-CLR-FLD-GIM.
           MOVE SPACES TO FRM-GLS-TREA IN GIM-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GIM-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GIM-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GIM-FLD.
           MOVE SPACES TO FRM-GLS-STIM IN GIM-FLD.
           MOVE SPACES TO FRM-GLS-TCNS IN GIM-FLD.
           MOVE SPACES TO FRM-GLS-UMDI IN GIM-FLD.
           MOVE SPACES TO FRM-GLS-GASC IN GIM-FLD.
           MOVE SPACES TO FRM-GLS-DEST IN GIM-FLD.
           PERFORM CLR-GIM-GIM.
           PERFORM CLR-GDG-GIM.
           PERFORM CLR-GVT-GIM.
       FIN-CLR-FLD-GIM.
           EXIT.
       
       CLR-GIM-GIM SECTION.
       INI-CLR-GIM-GIM.
           MOVE SPACES TO GIM-COD-STIM IN GIM-FLD.
           MOVE ZEROES TO GIM-NUM-EDIM IN GIM-FLD.
           MOVE SPACES TO GIM-COD-TCNS IN GIM-FLD.
           MOVE SPACES TO GIM-COD-UMDI IN GIM-FLD.
           MOVE ZEROES TO GIM-VAL-COIM IN GIM-FLD.
           MOVE ZEROES TO GIM-VAL-TEIM IN GIM-FLD.
           MOVE SPACES TO GIM-GLS-NOAR IN GIM-FLD.
           MOVE ZEROES TO GIM-VAL-MOAR IN GIM-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GIM-FEC-FVAR IN GIM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GIM-IND-GASC IN GIM-FLD.
           MOVE SPACES TO GIM-COD-DEST IN GIM-FLD.
       FIN-CLR-GIM-GIM.
           EXIT.
       
       CLR-GDG-GIM SECTION.
       INI-CLR-GDG-GIM.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GIM-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GIM-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GIM-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GIM-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GIM-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GIM-FLD.
       FIN-CLR-GDG-GIM.
           EXIT.
       
       CLR-GVT-GIM SECTION.
       INI-CLR-GVT-GIM.
           MOVE ZEROES TO GVT-SGV-FISI IN GIM-FLD.
       FIN-CLR-GVT-GIM.
           EXIT.
       
       FST-KEY-GIM SECTION.
       INI-FST-KEY-GIM.
           MOVE -1 TO GIM-CAI-GTIA-LEN IN GIM-FLD.
       FIN-FST-KEY-GIM.
           EXIT.
       
       FST-FLD-GIM SECTION.
       INI-FST-FLD-GIM.
           MOVE -1 TO GIM-COD-STIM-LEN IN GIM-FLD.
       FIN-FST-FLD-GIM.
           EXIT.
       
       PRO-KEY-GIM SECTION.
       INI-PRO-KEY-GIM.
           PERFORM PRO-MKY-GIM.
       FIN-PRO-KEY-GIM.
           EXIT.
       
       PRO-MKY-GIM SECTION.
       INI-PRO-MKY-GIM.
       FIN-PRO-MKY-GIM.
           EXIT.
       
       PRO-FLD-GIM SECTION.
       INI-PRO-FLD-GIM.
           PERFORM PRO-GIM-GIM.
           PERFORM PRO-GDG-GIM.
           PERFORM PRO-GVT-GIM.
       FIN-PRO-FLD-GIM.
           EXIT.
       
       PRO-GIM-GIM SECTION.
       INI-PRO-GIM-GIM.
           MOVE FRM-CPIM-AEY TO GIM-COD-STIM-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-NUM-EDIM-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-COD-TCNS-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-COD-UMDI-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-VAL-COIM-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-VAL-TEIM-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-GLS-NOAR-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-VAL-MOAR-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-FEC-FVAR-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-IND-GASC-ATR IN GIM-FLD.
           MOVE FRM-CPIM-AEY TO GIM-COD-DEST-ATR IN GIM-FLD.
       FIN-PRO-GIM-GIM.
           EXIT.
       
       PRO-GDG-GIM SECTION.
       INI-PRO-GDG-GIM.
       FIN-PRO-GDG-GIM.
           EXIT.
       
       PRO-GVT-GIM SECTION.
       INI-PRO-GVT-GIM.
           MOVE FRM-CPIM-AEY TO GVT-SGV-FISI-ATR IN GIM-FLD.
       FIN-PRO-GVT-GIM.
           EXIT.
       
       UNP-KEY-GIM SECTION.
       INI-UNP-KEY-GIM.
           PERFORM UNP-IKY-GIM.
           PERFORM UNP-AKY-GIM.
           PERFORM UNP-MKY-GIM.
       FIN-UNP-KEY-GIM.
           EXIT.
       
       UNP-IKY-GIM SECTION.
       INI-UNP-IKY-GIM.
           MOVE FRM-CPIM-UBY TO GIM-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GIM-IIC-GTIA-ATR.
       FIN-UNP-IKY-GIM.
           EXIT.
       
       UNP-MKY-GIM SECTION.
       INI-UNP-MKY-GIM.
       FIN-UNP-MKY-GIM.
           EXIT.
       
       UNP-AKY-GIM SECTION.
       INI-UNP-AKY-GIM.
       FIN-UNP-AKY-GIM.
           EXIT.
       
       UNP-FLD-GIM SECTION.
       INI-UNP-FLD-GIM.
           PERFORM UNP-GIM-GIM.
           PERFORM UNP-GDG-GIM.
           PERFORM UNP-GVT-GIM.
       FIN-UNP-FLD-GIM.
           EXIT.
       
       UNP-GIM-GIM SECTION.
       INI-UNP-GIM-GIM.
           MOVE FRM-CPIM-UBY TO GIM-COD-STIM-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-NUM-EDIM-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-COD-TCNS-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-COD-UMDI-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-VAL-COIM-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-VAL-TEIM-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-GLS-NOAR-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-VAL-MOAR-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-FEC-FVAR-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-IND-GASC-ATR IN GIM-FLD.
           MOVE FRM-CPIM-UBY TO GIM-COD-DEST-ATR IN GIM-FLD.
       FIN-UNP-GIM-GIM.
           EXIT.
       
       UNP-GDG-GIM SECTION.
       INI-UNP-GDG-GIM.
       FIN-UNP-GDG-GIM.
           EXIT.
       
       UNP-GVT-GIM SECTION.
       INI-UNP-GVT-GIM.
           MOVE FRM-CPIM-UBY TO GVT-SGV-FISI-ATR IN GIM-FLD.
       FIN-UNP-GVT-GIM.
           EXIT.
       
       VAL-MKY-GIM SECTION.
       INI-VAL-MKY-GIM.
       FIN-VAL-MKY-GIM.
           EXIT.
       
       VAL-FLD-GIM SECTION.
       INI-VAL-FLD-GIM.
           PERFORM VAL-FRM-GLS-TREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TREA-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
      * IDG-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-TIP-CGTA-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-STP-CGTA-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
      * IDG-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
      * OFI-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-COD-OFIC-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
      * OFI-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GIM-COD-STIM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-COD-STIM-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-FRM-GLS-STIM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-STIM-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GIM-NUM-EDIM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-NUM-EDIM-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GIM-COD-TCNS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-COD-TCNS-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-FRM-GLS-TCNS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TCNS-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GIM-COD-UMDI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-COD-UMDI-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-FRM-GLS-UMDI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-UMDI-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GIM-VAL-COIM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-VAL-COIM-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GIM-VAL-TEIM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-VAL-TEIM-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GIM-GLS-NOAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-GLS-NOAR-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GIM-VAL-MOAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-VAL-MOAR-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GIM-FEC-FVAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GIM-FEC-FVAR-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GIM-IND-GASC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-IND-GASC-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-FRM-GLS-GASC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-GASC-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GVT-SGV-FISI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-SGV-FISI-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-GIM-COD-DEST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GIM-COD-DEST-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
           PERFORM VAL-FRM-GLS-DEST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-DEST-LEN IN GIM-FLD
                GO TO FIN-VAL-FLD-GIM.
       FIN-VAL-FLD-GIM.
           EXIT.
       
       VAL-FRM-GLS-TREA SECTION.
       INI-VAL-FRM-GLS-TREA.
       FIN-VAL-FRM-GLS-TREA.
           EXIT.
      * IDG-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.
           IF GDG-TIP-CGTA IN GIM-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-CGTA IN GIM-FLD.
       FIN-VAL-GDG-TIP-CGTA.
           EXIT.

       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.
           IF GDG-STP-CGTA IN GIM-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-CGTA IN GIM-FLD.
       FIN-VAL-GDG-STP-CGTA.
           EXIT.
      * IDG-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * OFI-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
           IF GDG-COD-OFIC IN GIM-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GIM-FLD.
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
      * OFI-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
       
       VAL-GIM-COD-STIM SECTION.
       INI-VAL-GIM-COD-STIM.
      *<<<< INI_GIM_COD_STIM
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GIM-COD-STIM IN GIM-FLD NOT > SPACES
               GO TO FIN-VAL-GIM-COD-STIM.
      *MHM-FIN 29-OCT-2003
      *<<<<
           IF GIM-COD-STIM IN GIM-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GIM-COD-STIM.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'BGL' TO MSC-COD-SIST.
           MOVE 'SINM' TO MSC-COD-TMSC IN MSC.
           MOVE GIM-COD-STIM IN GIM-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GIM-COD-STIM IN GIM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-STIM IN GIM-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-STIM IN GIM-FLD.
       FIN-VAL-GIM-COD-STIM.
           EXIT.
       
       VAL-FRM-GLS-STIM SECTION.
       INI-VAL-FRM-GLS-STIM.
       FIN-VAL-FRM-GLS-STIM.
           EXIT.
       
       VAL-GIM-NUM-EDIM SECTION.
       INI-VAL-GIM-NUM-EDIM.
      *<<<< INI_GIM_NUM_EDIM
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GIM-NUM-EDIM IN GIM-FLD NOT > ZEROES
               GO TO FIN-VAL-GIM-NUM-EDIM.
      *MHM-FIN 29-OCT-2003
      *AFRI-INI/JUL2004
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.
           MOVE 'VGA'        TO TAB-COD-TTAB IN TAB.
           MOVE 'GIMEDIM'    TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE = 'S'
              MOVE TAB-GLS-DATA TO WSS-GLS-TGAR
              MOVE GDG-TIP-CGTA IN GIM-FLD TO WSS-COD-TOPE
              MOVE GDG-STP-CGTA IN GIM-FLD TO WSS-COD-SOPE 
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(1) AND
                 WSS-IND-TGAR(1) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(2) AND
                 WSS-IND-TGAR(2) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(3) AND
                 WSS-IND-TGAR(3) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(4) AND
                 WSS-IND-TGAR(4) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(5) AND
                 WSS-IND-TGAR(5) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(6) AND
                 WSS-IND-TGAR(6) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(7) AND
                 WSS-IND-TGAR(7) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(8) AND
                 WSS-IND-TGAR(8) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(9) AND
                 WSS-IND-TGAR(9) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM
              ELSE
              IF WSS-COD-CGTA IN WSS-VARI = WSS-IND-TGAR(10) AND
                 WSS-IND-TGAR(10) > SPACES
                  GO TO FIN-VAL-GIM-NUM-EDIM.
      *AFRI-FIN/JUL2004
      *AFRI-INI/ENE2005                                                 
           GO TO FIN-VAL-GIM-NUM-EDIM.                             
      *AFRI-FIN/ENE2005                                                 
      *<<<<
           IF GIM-NUM-EDIM IN GIM-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GIM-NUM-EDIM.
       FIN-VAL-GIM-NUM-EDIM.
           EXIT.
       
       VAL-GIM-COD-TCNS SECTION.
       INI-VAL-GIM-COD-TCNS.
           IF GIM-COD-TCNS IN GIM-FLD NOT > SPACES
              MOVE SPACES TO GIM-COD-TCNS IN GIM-FLD.
      *<<<< GIM_COD_TCNS
           MOVE GDG-TIP-CGTA IN GIM-FLD TO WSS-COD-TOPE IN WSS-VARI.
           MOVE GDG-STP-CGTA IN GIM-FLD TO WSS-COD-SOPE IN WSS-VARI.
           MOVE WSS-COD-TOPE IN WSS-VARI TO TAG-COD-TOPE IN TAG.
           MOVE WSS-COD-SOPE IN WSS-VARI TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
              MOVE SPACES TO GIM-COD-TCNS IN GIM-FLD                
              MOVE SPACES TO FRM-GLS-TCNS IN GIM-FLD                
              GO TO FIN-VAL-GIM-COD-TCNS.   

           MOVE TAG-IND-TPRE IN TAG TO WSS-IND-OBL1 IN WSS-VARI. 
           MOVE TAG-IND-OMCT IN TAG TO WSS-IND-OBL2 IN WSS-VARI.
           
           IF WSS-IND-OBL1 IN WSS-VARI = 'N' OR                      
              WSS-IND-OBL1 IN WSS-VARI = 'E'                         
               MOVE SPACES TO GIM-COD-TCNS IN GIM-FLD                
               MOVE SPACES TO FRM-GLS-TCNS IN GIM-FLD                
               GO TO FIN-VAL-GIM-COD-TCNS.                               
                                                                        
           IF GIM-COD-TCNS IN GIM-FLD = SPACES                           
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'TIPCTR BLK' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *VAL-COD Valida codigo de tabla            
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'CTR ' TO TAB-COD-TTAB IN TAB.
           MOVE GIM-COD-TCNS IN GIM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GIM-COD-TCNS IN GIM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TCNS IN GIM-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TCNS IN GIM-FLD.
      *>>>>
       FIN-VAL-GIM-COD-TCNS.
           EXIT.
       
       VAL-FRM-GLS-TCNS SECTION.
       INI-VAL-FRM-GLS-TCNS.
       FIN-VAL-FRM-GLS-TCNS.
           EXIT.
       
       VAL-GIM-COD-UMDI SECTION.
       INI-VAL-GIM-COD-UMDI.
           IF GIM-COD-UMDI IN GIM-FLD NOT > SPACES
              MOVE SPACES TO GIM-COD-UMDI IN GIM-FLD.
      *<<<< GIM_COD_UMDI
           IF NOT ( WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'T' OR 'A' )   
               MOVE SPACES TO GIM-COD-UMDI IN GIM-FLD               
               GO TO FIN-VAL-GIM-COD-UMDI.                          
                                                                   
           IF GIM-COD-UMDI IN GIM-FLD = ZEROES                      
               MOVE 'BGL'        TO MSG-COD-SIST 
               MOVE 'CODUMD BLK' TO MSG-COD-MENS 
               PERFORM GET-MSG                   
               MOVE MSG-GLS-DESC TO FRM-MENS     
               MOVE FRM-SUAR-MAL TO FRM-SUAR.    

      *VAL-COD Valida codigo de tabla            
           MOVE 'BGL' TO TAB-COD-SIST.           
           MOVE 'UMD ' TO TAB-COD-TTAB IN TAB. 
           MOVE GIM-COD-UMDI IN GIM-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GIM-COD-UMDI IN GIM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-UMDI IN GIM-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO           
                    FRM-GLS-UMDI IN GIM-FLD.         
      *>>>>
       FIN-VAL-GIM-COD-UMDI.
           EXIT.
       
       VAL-FRM-GLS-UMDI SECTION.
       INI-VAL-FRM-GLS-UMDI.
       FIN-VAL-FRM-GLS-UMDI.
           EXIT.
       
       VAL-GIM-VAL-COIM SECTION.
       INI-VAL-GIM-VAL-COIM.
           IF GIM-VAL-COIM IN GIM-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GIM-VAL-COIM.
      *<<<< GIM_VAL_COIM
      *AFRI-INI JUL/2004
           IF GIM-VAL-COIM IN GIM-FLD NOT > ZEROES
               MOVE ZEROES TO GIM-VAL-COIM IN GIM-FLD.
      *AFRI-FIN JUL/2004
      *MHM-INI 10-MAR-2004
      *    IF NOT ( WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'A' ) 
      *        MOVE ZEROES TO GIM-VAL-COIM IN GIM-FLD
           IF ( WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'A' ) AND          
               GIM-VAL-COIM IN GIM-FLD NOT > ZEROES 
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'M2CTR BLK'  TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *MHM-FIN 10-MAR-2004
                GO TO FIN-VAL-GIM-VAL-COIM. 
      *MHM-INI 10-MAR-2004
           IF ( WSS-IND-OBL2 IN WSS-VARI = 'N' OR 'T' ) AND
               GIM-VAL-COIM IN GIM-FLD > ZEROES
                MOVE ZEROES TO GIM-VAL-COIM IN GIM-FLD.

      *    IF GIM-VAL-COIM IN GIM-FLD = ZEROES
      *        MOVE 'BGL'        TO MSG-COD-SIST
      *        MOVE 'M2CTR BLK'  TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *MHM-FIN 10-MAR-2004
      *>>>>
       FIN-VAL-GIM-VAL-COIM.
           EXIT.
       
       VAL-GIM-VAL-TEIM SECTION.
       INI-VAL-GIM-VAL-TEIM.
           IF GIM-VAL-TEIM IN GIM-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GIM-VAL-TEIM.
      *<<<< GIM_VAL_TEIM
      *AFRI-INI JUL/2004
           IF ((GIM-VAL-TEIM IN GIM-FLD NOT > ZEROES) AND
               (WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'N'))
                MOVE ZEROES TO GIM-VAL-TEIM IN GIM-FLD 
                GO TO FIN-VAL-GIM-VAL-TEIM.
      *AFRI-FIN JUL/2004
      *MHM-INI 10-MAR-2004
      *    IF NOT ( WSS-IND-OBL2 IN WSS-VARI = 'T' OR 'A' )   
      *        MOVE ZEROES TO GIM-VAL-TEIM IN GIM-FLD     
           IF ( WSS-IND-OBL2 IN WSS-VARI = 'T' OR 'A' ) AND     
                GIM-VAL-TEIM IN GIM-FLD NOT > ZEROES              
               MOVE 'BGL'        TO MSG-COD-SIST          
               MOVE 'M2TRR BLK'  TO MSG-COD-MENS          
               PERFORM GET-MSG                            
               MOVE MSG-GLS-DESC TO FRM-MENS              
               MOVE FRM-SUAR-MAL TO FRM-SUAR    
      *MHM-FIN 10-MAR-2004 
               GO TO FIN-VAL-GIM-VAL-TEIM.

      *MHM-INI 10-MAR-2004
           IF ( WSS-IND-OBL2 IN WSS-VARI = 'C' OR 'N' ) AND
               GIM-VAL-TEIM IN GIM-FLD > ZEROES
                MOVE ZEROES TO GIM-VAL-TEIM IN GIM-FLD
                GO TO FIN-VAL-GIM-VAL-TEIM.
      *    IF GIM-VAL-TEIM IN GIM-FLD = ZEROES
      *        MOVE 'BGL'        TO MSG-COD-SIST
      *        MOVE 'M2TRR BLK'  TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *MHM-FIN 10-MAR-2004
      *>>>>
       FIN-VAL-GIM-VAL-TEIM.
           EXIT.
       
       VAL-GIM-GLS-NOAR SECTION.
       INI-VAL-GIM-GLS-NOAR.
           IF GIM-GLS-NOAR IN GIM-FLD NOT > SPACES
              MOVE SPACES TO GIM-GLS-NOAR IN GIM-FLD.
      *<<<< GIM_GLS_NOAR
           IF GIM-COD-STIM IN GIM-FLD = '6' AND
              GIM-GLS-NOAR IN GIM-FLD = SPACES
               MOVE 'GLSOBLINOAR' TO MSG-COD-MENS
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GIM-GLS-NOAR.
      *<<<<
       FIN-VAL-GIM-GLS-NOAR.
           EXIT.
       
       VAL-GIM-VAL-MOAR SECTION.
       INI-VAL-GIM-VAL-MOAR.
      *<<<< GIM_VAL_MOAR
           IF GIM-COD-STIM IN GIM-FLD = '6' AND
              GIM-VAL-MOAR IN GIM-FLD = ZEROES
               MOVE 'VALOBLIMOAR' TO MSG-COD-MENS
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GIM-VAL-MOAR.
      *<<<<
       FIN-VAL-GIM-VAL-MOAR.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GIM-FEC-FVAR SECTION.
       INI-VAL-GIM-FEC-FVAR.
           IF GIM-FEC-FVAR IN GIM-FLD  NOT > ZEROES
              MOVE ZEROES TO GIM-FEC-FVAR IN GIM-FLD.
      *VAL-FEC Validar Fecha
           MOVE GIM-FEC-FVAR IN GIM-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GIM_FEC_FVAR
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N  TO FEC-VHBL.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
      *<<<<
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GIM-FEC-FVAR IN GIM-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GIM-FEC-FVAR.
      *<<<< GIM_FEC_FVAR
           IF GIM-COD-STIM IN GIM-FLD = '6' AND
              GIM-FEC-FVAR IN GIM-FLD = ZEROES
               MOVE 'FECOBLIFVAR' TO MSG-COD-MENS
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GIM-FEC-FVAR.
      *<<<<
       FIN-VAL-GIM-FEC-FVAR.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GIM-IND-GASC SECTION.
       INI-VAL-GIM-IND-GASC.
           IF GIM-IND-GASC IN GIM-FLD NOT > SPACES
              MOVE SPACES TO GIM-IND-GASC IN GIM-FLD.
      *<<<<
      *EVA-AFRI/AGOST2007                                               
           MOVE GIM-CAI-GTIA IN GIM-FLD TO GDD-CAI-GTIA IN GDD.         
           MOVE GIM-IIC-GTIA IN GIM-FLD TO GDD-IIC-GTIA IN GDD.         
           MOVE 'GDD-KEY-AGDD'       TO FIO-AKEY.                       
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
                                                                        
           PERFORM BGL-FIO-GDD.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-VAL-GIM-IND-GASC.                              
                                                                        
           MOVE GDD-CIC-DCLI IN GDD  TO  DBC-KEY-IDBC IN DBC.           
           MOVE FIO-GET-KEY          TO  FIO-CMND.                      
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
                GO TO FIN-CMN-ING.                                      
                                                                        
           IF DBC-NUM-ICLI IN DBC > '50000000'                          
              MOVE SPACES TO GIM-IND-GASC IN GIM-FLD.                   
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'HIP ' TO TAB-COD-TTAB IN TAB.                          
           MOVE GIM-IND-GASC IN GIM-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
              IF MSG-COD-MENS = 'COD    NEX' OR                         
              GIM-IND-GASC IN GIM-FLD NOT > SPACES                      
              MOVE 'CREDITO NO CHIP' TO FRM-GLS-GASC IN GIM-FLD         
              ELSE                                                      
                 MOVE TAB-GLS-DESC IN TAB TO                            
                 FRM-GLS-GASC IN GIM-FLD.                               
      *>>>>
       FIN-VAL-GIM-IND-GASC.
           EXIT.
       
       VAL-FRM-GLS-GASC SECTION.
       INI-VAL-FRM-GLS-GASC.
       FIN-VAL-FRM-GLS-GASC.
           EXIT.
       
       VAL-GVT-SGV-FISI SECTION.
       INI-VAL-GVT-SGV-FISI.
      *<<<<
      ** EVA-INI                                                        
           IF GVT-SGV-FISI IN GIM-FLD NOT > ZEROES                      
              MOVE ZEROES TO GVT-SGV-FISI IN GIM-FLD.                   
      ** EVA-FIN                                                        
      *>>>>
       FIN-VAL-GVT-SGV-FISI.
           EXIT.
       
       VAL-GIM-COD-DEST SECTION.
       INI-VAL-GIM-COD-DEST.
           IF GIM-COD-DEST IN GIM-FLD NOT > SPACES
              MOVE SPACES TO GIM-COD-DEST IN GIM-FLD.
      *<<<<
           IF GIM-COD-DEST IN GIM-FLD NOT > SPACES                      
              MOVE '0' TO GIM-COD-DEST IN GIM-FLD.                      
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'USD ' TO TAB-COD-TTAB IN TAB.
           MOVE GIM-COD-DEST IN GIM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GIM-COD-DEST IN GIM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-DEST IN GIM-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-DEST IN GIM-FLD.
       FIN-VAL-GIM-COD-DEST.
           EXIT.
       
       VAL-FRM-GLS-DEST SECTION.
       INI-VAL-FRM-GLS-DEST.
       FIN-VAL-FRM-GLS-DEST.
           EXIT.
       
       VAL-CON-FLD-GIM SECTION.
       INI-VAL-CON-FLD-GIM.
       FIN-VAL-CON-FLD-GIM.
           EXIT.
       
       VAL-CON-GIM SECTION.
       INI-VAL-CON-GIM.
       FIN-VAL-CON-GIM.
           EXIT.
       
       VAL-NUM-KEY-GIM SECTION.
       INI-VAL-NUM-KEY-GIM.
           PERFORM VAL-NUM-IKY-GIM.
           PERFORM VAL-NUM-MKY-GIM.
           PERFORM VAL-NUM-AKY-GIM.
       FIN-VAL-NUM-KEY-GIM.
           EXIT.
       
       VAL-NUM-IKY-GIM SECTION.
       INI-VAL-NUM-IKY-GIM.
       VAL-NUM-GIM-IIC-GTIA.
           MOVE GIM-IIC-GTIA-ALF IN GIM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GIM-IIC-GTIA IN GIM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GIM-IIC-GTIA-LEN IN GIM-FLD
                GO TO FIN-VAL-NUM-IKY-GIM.
       FIN-VAL-NUM-IKY-GIM.
           EXIT.
       
       VAL-NUM-MKY-GIM SECTION.
       INI-VAL-NUM-MKY-GIM.
       FIN-VAL-NUM-MKY-GIM.
           EXIT.
       
       VAL-NUM-AKY-GIM SECTION.
       INI-VAL-NUM-AKY-GIM.
       FIN-VAL-NUM-AKY-GIM.
           EXIT.
       
       VAL-NUM-FLD-GIM SECTION.
       INI-VAL-NUM-FLD-GIM.
       VAL-NUM-GIM-NUM-EDIM.
           MOVE GIM-NUM-EDIM-ALF IN GIM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GIM-NUM-EDIM IN GIM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GIM-NUM-EDIM-LEN IN GIM-FLD
                GO TO FIN-VAL-NUM-FLD-GIM.
       VAL-NUM-GIM-VAL-COIM.
           MOVE GIM-VAL-COIM-ALF IN GIM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GIM-VAL-COIM IN GIM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GIM-VAL-COIM-LEN IN GIM-FLD
                GO TO FIN-VAL-NUM-FLD-GIM.
       VAL-NUM-GIM-VAL-TEIM.
           MOVE GIM-VAL-TEIM-ALF IN GIM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GIM-VAL-TEIM IN GIM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GIM-VAL-TEIM-LEN IN GIM-FLD
                GO TO FIN-VAL-NUM-FLD-GIM.
       VAL-NUM-GIM-VAL-MOAR.
           MOVE GIM-VAL-MOAR-ALF IN GIM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GIM-VAL-MOAR IN GIM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GIM-VAL-MOAR-LEN IN GIM-FLD
                GO TO FIN-VAL-NUM-FLD-GIM.
       VAL-NUM-GVT-SGV-FISI.
           MOVE GVT-SGV-FISI-ALF IN GIM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-FISI IN GIM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-FISI-LEN IN GIM-FLD
                GO TO FIN-VAL-NUM-FLD-GIM.
       FIN-VAL-NUM-FLD-GIM.
           EXIT.
       
       EDT-KEY-GIM SECTION.
       INI-EDT-KEY-GIM.
           PERFORM EDT-IKY-GIM.
           PERFORM EDT-MKY-GIM.
           PERFORM EDT-AKY-GIM.
       FIN-EDT-KEY-GIM.
           EXIT.
       
       EDT-IKY-GIM SECTION.
       INI-EDT-IKY-GIM.
           IF GIM-IIC-GTIA-LEN IN GIM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GIM-IIC-GTIA-LEN IN GIM-FLD
                GO TO FIN-EDT-IKY-GIM.
           MOVE GIM-IIC-GTIA IN GIM-FLD TO GIM-IIC-GTIA-EDT IN GIM-EDT.
           MOVE GIM-IIC-GTIA-EDT IN GIM-EDT TO 
                GIM-IIC-GTIA-ALF IN GIM-FLD.
       FIN-EDT-IKY-GIM.
           EXIT.
       
       EDT-MKY-GIM SECTION.
       INI-EDT-MKY-GIM.
       FIN-EDT-MKY-GIM.
           EXIT.
       
       EDT-AKY-GIM SECTION.
       INI-EDT-AKY-GIM.
       FIN-EDT-AKY-GIM.
           EXIT.
       
       EDT-FLD-GIM SECTION.
       INI-EDT-FLD-GIM.
           IF GIM-NUM-EDIM-LEN IN GIM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GIM-NUM-EDIM-LEN IN GIM-FLD
                GO TO FIN-EDT-FLD-GIM.
           MOVE GIM-NUM-EDIM IN GIM-FLD TO GIM-NUM-EDIM-EDT IN GIM-EDT.
           MOVE GIM-NUM-EDIM-EDT IN GIM-EDT TO 
                GIM-NUM-EDIM-ALF IN GIM-FLD.
           IF GIM-VAL-COIM-LEN IN GIM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GIM-VAL-COIM-LEN IN GIM-FLD
                GO TO FIN-EDT-FLD-GIM.
           MOVE GIM-VAL-COIM IN GIM-FLD TO GIM-VAL-COIM-EDT IN GIM-EDT.
           MOVE GIM-VAL-COIM-EDT IN GIM-EDT TO 
                GIM-VAL-COIM-ALF IN GIM-FLD.
           IF GIM-VAL-TEIM-LEN IN GIM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GIM-VAL-TEIM-LEN IN GIM-FLD
                GO TO FIN-EDT-FLD-GIM.
           MOVE GIM-VAL-TEIM IN GIM-FLD TO GIM-VAL-TEIM-EDT IN GIM-EDT.
           MOVE GIM-VAL-TEIM-EDT IN GIM-EDT TO 
                GIM-VAL-TEIM-ALF IN GIM-FLD.
           IF GIM-VAL-MOAR-LEN IN GIM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GIM-VAL-MOAR-LEN IN GIM-FLD
                GO TO FIN-EDT-FLD-GIM.
           MOVE GIM-VAL-MOAR IN GIM-FLD TO GIM-VAL-MOAR-EDT IN GIM-EDT.
           MOVE GIM-VAL-MOAR-EDT IN GIM-EDT TO 
                GIM-VAL-MOAR-ALF IN GIM-FLD.
           IF GVT-SGV-FISI-LEN IN GIM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-FISI-LEN IN GIM-FLD
                GO TO FIN-EDT-FLD-GIM.
           MOVE GVT-SGV-FISI IN GIM-FLD TO GVT-SGV-FISI-EDT IN GIM-EDT.
           MOVE GVT-SGV-FISI-EDT IN GIM-EDT TO 
                GVT-SGV-FISI-ALF IN GIM-FLD.
       FIN-EDT-FLD-GIM.
           EXIT.
