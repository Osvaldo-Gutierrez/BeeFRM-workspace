      *
      * BGLBQGSO
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 04:57 PM
      *
       SET-TAG-BGLBQGSO SECTION.
       INI-SET-TAG-BGLBQGSO.
           MOVE
           '<IDNMOD NOM=$BGLBQGSO$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 04:57 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBQGSO.
           EXIT.
           
       PUT-ALL-GSO SECTION.
       INI-PUT-ALL-GSO.
           PERFORM PUT-GSO-GSO.
           PERFORM PUT-DBC-GSO.
       FIN-PUT-ALL-GSO.
           EXIT.
       
       PUT-GSO-GSO SECTION.
       INI-PUT-GSO-GSO.
           IF PGM-STAT-GSO-NUL
               GO TO FIN-PUT-GSO-GSO.
           IF NOT PGM-STAT-GSO-OKS
               PERFORM CLR-GSO-GSO
               GO TO FIN-PUT-GSO-GSO.
           MOVE GSO-CAI-GTIA IN GSO TO GSO-CAI-GTIA IN GSO-FLD.
           MOVE GSO-IIC-GTIA IN GSO TO GSO-IIC-GTIA IN GSO-FLD.
           MOVE GSO-NUM-SBGL IN GSO TO GSO-NUM-SBGL IN GSO-FLD.
           MOVE GSO-COD-ESGA IN GSO TO GSO-COD-ESGA IN GSO-FLD.
           MOVE GSO-COD-EST2 IN GSO TO GSO-COD-EST2 IN GSO-FLD.
           MOVE GSO-COD-USER IN GSO TO GSO-COD-USER IN GSO-FLD.
           MOVE GSO-COD-RSEG IN GSO TO GSO-COD-RSEG IN GSO-FLD.
           MOVE GSO-IND-PCUO IN GSO TO GSO-IND-PCUO IN GSO-FLD.
           MOVE GSO-NUM-CUOT IN GSO TO GSO-NUM-CUOT IN GSO-FLD.
      *<<<< FIN_PUT_GSO_GSO 
      *PVG INI 14-OCT-2003
           IF GSO-IND-PCUO IN GSO-FLD > SPACES
              MOVE 'BGL' TO TAB-COD-SIST
              MOVE 'SIN ' TO TAB-COD-TTAB IN TAB
              MOVE GSO-IND-PCUO IN GSO-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB 
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-PCUO IN GSO-FLD.
      *PVG FIN 14-OCT-2003

      *CGL-INI  7-SEP-2003 15:31:13 
           MOVE GSO-CAI-GTIA IN GSO-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDG.

      *PVG INI 14-OCT-2003
           MOVE SPACES                 TO FRM-GLS-CLAS IN GSO-FLD.
           MOVE SPACES                 TO FRM-GLS-TPOL IN GSO-FLD.

           MOVE GDG-COD-TOPE IN GDG    TO TAG-COD-TOPE IN TAG.
           MOVE GDG-COD-SOPE IN GDG    TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
              GO TO CON-PUT-GSO-GSO.

           IF TAG-COD-CLAS IN TAG > SPACES
              MOVE 'BGL'               TO TAB-COD-SIST
              MOVE 'CLA'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-CLAS IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-CLAS IN GSO-FLD.

           IF TAG-COD-TPOL IN TAG > SPACES
              MOVE 'BGL'               TO TAB-COD-SIST
              MOVE 'POL'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-TPOL IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TPOL IN GSO-FLD.
       CON-PUT-GSO-GSO.
      *PVG FIN 14-OCT-2003
           
           MOVE 'TAB'  TO TAB-COD-SIST                 
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB         
           MOVE GDG-COD-TOPE IN GDG TO TAB-COD-CTAB IN TAB 
           PERFORM BUS-TAB                                    
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOPE IN GSO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOPE IN GSO-FLD.

      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.

           MOVE GDG-COD-TOPE IN GDG TO WSS-COD-TOPE IN WSS-VARI.
           MOVE GDG-COD-SOPE IN GDG TO WSS-COD-SOPE IN WSS-VARI.
           MOVE WSS-TSG-OPE IN WSS-VARI  TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SOPE IN GSO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-SOPE IN GSO-FLD.
      *CGL-FIN  7-SEP-2003 15:15:16 
       CONTINUA-NOMC.
      *Busca nombre del cliente.
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-NUM-SBGL IN GSL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GSL.
           IF NOT FIO-STAT-OKS
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'SOL  NOEXI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
              GO TO CONTINUA-USR.
       
           MOVE GSL-CIC-DCLI IN GSL TO DBC-CIC-ICLI IN DBC.
           MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
              MOVE '00' TO PGM-STAT-DBC
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN            TO DBC-GLS-NOMC IN GSO-FLD
           ELSE
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
              GO TO CONTINUA-USR.
       

       CONTINUA-USR.
      *Nombre de ejecutivo.
           IF GSO-COD-USER IN GSO > SPACES                      
               MOVE GSO-COD-USER IN GSO TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-USER IN GSO-FLD  
           ELSE                                                     
               MOVE SPACES              TO GSO-COD-USER IN GSO-FLD
               MOVE SPACES              TO FRM-GLS-USER IN GSO-FLD. 

       CONTINUA-EST1.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-IND-EST1 IN GDG > SPACES
             MOVE 'BGL' TO TAB-COD-SIST
             MOVE 'ES1'                TO TAB-COD-TTAB IN TAB
             MOVE GDG-IND-EST1 IN GDG  TO TAB-COD-CTAB IN TAB
             PERFORM BUS-TAB
             MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EST1 IN GSO-FLD.

       CONTINUA-ESGA.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSO-COD-ESGA IN GSO > SPACES
               MOVE 'BGL'  TO TAB-COD-SIST
               MOVE 'EGS ' TO TAB-COD-TTAB IN TAB
               MOVE GSO-COD-ESGA IN GSO TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESGA IN GSO-FLD.

       CONTINUA-EST2.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSO-COD-EST2 IN GSO > SPACES
              MOVE 'BGL'  TO TAB-COD-SIST
              MOVE 'ET2 ' TO TAB-COD-TTAB IN TAB
              MOVE GSO-COD-EST2 IN GSO TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-EST2 IN GSO-FLD.

       CONTINUA-FEC.
           IF SCR-CMND NOT = 'ING' AND
              SCR-CMND NOT = 'AEG'
      *MHM-INI 27-ENE-2004
      **CGL-INI  11-SEP-2003 12:14:25  
      *        SCR-CMND NOT = 'AEJ'
      *        MOVE GSO-NUM-DSO2 IN GSO TO WSS-NUM-DEDII IN WSS-VARI
      *        MOVE GSO-NUM-MSO2 IN GSO TO WSS-NUM-MEDII IN WSS-VARI
      *        MOVE GSO-NUM-SSO2 IN GSO TO WSS-NUM-SEDII IN WSS-VARI
      *        MOVE GSO-NUM-ASO2 IN GSO TO WSS-NUM-AEDII IN WSS-VARI
      *        MOVE WSS-FEC-EDII IN WSS-VARI TO FRM-FEC-ESO2 IN GSO-FLD
      **CGL-FIN  11-SEP-2003 12:14:32 
      *MHM-FIN 27-ENE-2004
              MOVE GSO-NUM-DSOL IN GSO TO WSS-NUM-DEDIT IN WSS-VARI
              MOVE GSO-NUM-MSOL IN GSO TO WSS-NUM-MEDIT IN WSS-VARI
              MOVE GSO-NUM-SSOL IN GSO TO WSS-NUM-SEDIT IN WSS-VARI
              MOVE GSO-NUM-ASOL IN GSO TO WSS-NUM-AEDIT IN WSS-VARI
              MOVE WSS-FEC-EDIT IN WSS-VARI TO FRM-FEC-ESGA IN GSO-FLD.

      *MHM-INI 27-ENE-2004
           IF SCR-CMND NOT = 'ING' AND
              SCR-CMND NOT = 'AEJ'
               MOVE GSO-NUM-DSO2 IN GSO TO WSS-NUM-DEDII IN WSS-VARI
               MOVE GSO-NUM-MSO2 IN GSO TO WSS-NUM-MEDII IN WSS-VARI
               MOVE GSO-NUM-SSO2 IN GSO TO WSS-NUM-SEDII IN WSS-VARI
               MOVE GSO-NUM-ASO2 IN GSO TO WSS-NUM-AEDII IN WSS-VARI
               MOVE WSS-FEC-EDII IN WSS-VARI TO FRM-FEC-ESO2 IN GSO-FLD.
      *MHM-FIN 27-ENE-2004

              IF GSO-COD-RSEG IN GSO-FLD > SPACES
                 MOVE 'BGL' TO TAB-COD-SIST
                 MOVE 'RPB ' TO TAB-COD-TTAB IN TAB
                 MOVE GSO-COD-RSEG IN GSO-FLD TO TAB-COD-CTAB IN TAB
                 PERFORM BUS-TAB
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-RSEG IN GSO-FLD.
      *>>>>
       FIN-PUT-GSO-GSO.
           EXIT.
       
       PUT-DBC-GSO SECTION.
       INI-PUT-DBC-GSO.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-GSO.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-GSO
               GO TO FIN-PUT-DBC-GSO.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN GSO-FLD.
      *<<<< FIN_PUT_DBC_GSO
      *PVG INI 14-OCT-2003
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN GSO-FLD.
      *PVG INI 14-OCT-2003
      *>>>>
       FIN-PUT-DBC-GSO.
           EXIT.
       
       KEY-ALL-GSO SECTION.
       INI-KEY-ALL-GSO.
           PERFORM KEY-GSO-GSO.
           PERFORM KEY-DBC-GSO.
       FIN-KEY-ALL-GSO.
           EXIT.
       
       KEY-GSO-GSO SECTION.
       INI-KEY-GSO-GSO.
           MOVE GSO-CAI-GTIA IN GSO-FLD TO GSO-CAI-GTIA IN GSO.
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GSO-IIC-GTIA IN GSO.
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSO-NUM-SBGL IN GSO.
       FIN-KEY-GSO-GSO.
           EXIT.
       
       KEY-DBC-GSO SECTION.
       INI-KEY-DBC-GSO.
       FIN-KEY-DBC-GSO.
           EXIT.
       
       SCR-CLRA-GSO SECTION.
       INI-SCR-CLRA-GSO.
           PERFORM CLR-KEY-GSO.
           PERFORM CLR-FLD-GSO.
       FIN-SCR-CLRA-GSO.
           EXIT.
       
       CLR-KEY-GSO SECTION.
       INI-CLR-KEY-GSO.
           MOVE SPACES TO GSO-CAI-GTIA IN GSO-FLD.
           MOVE ZEROES TO GSO-IIC-GTIA IN GSO-FLD.
           MOVE ZEROES TO GSO-NUM-SBGL IN GSO-FLD.
       FIN-CLR-KEY-GSO.
           EXIT.
       
       CLR-FLD-GSO SECTION.
       INI-CLR-FLD-GSO.
           MOVE SPACES TO FRM-GLS-CLAS IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-TOPE IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-SOPE IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-EST1 IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-ESGA IN GSO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-ESGA IN GSO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-EST2 IN GSO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-ESO2 IN GSO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-USER IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-RSEG IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-TPOL IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-PCUO IN GSO-FLD.
           PERFORM CLR-GSO-GSO.
           PERFORM CLR-DBC-GSO.
       FIN-CLR-FLD-GSO.
           EXIT.
       
       CLR-GSO-GSO SECTION.
       INI-CLR-GSO-GSO.
           MOVE SPACES TO GSO-COD-ESGA IN GSO-FLD.
           MOVE SPACES TO GSO-COD-EST2 IN GSO-FLD.
           MOVE SPACES TO GSO-COD-USER IN GSO-FLD.
           MOVE SPACES TO GSO-COD-RSEG IN GSO-FLD.
           MOVE SPACES TO GSO-IND-PCUO IN GSO-FLD.
           MOVE ZEROES TO GSO-NUM-CUOT IN GSO-FLD.
       FIN-CLR-GSO-GSO.
           EXIT.
       
       CLR-DBC-GSO SECTION.
       INI-CLR-DBC-GSO.
           MOVE SPACES TO DBC-GLS-NOMC IN GSO-FLD.
       FIN-CLR-DBC-GSO.
           EXIT.
       
       FST-KEY-GSO SECTION.
       INI-FST-KEY-GSO.
           MOVE -1 TO GSO-CAI-GTIA-LEN IN GSO-FLD.
       FIN-FST-KEY-GSO.
           EXIT.
       
       FST-FLD-GSO SECTION.
       INI-FST-FLD-GSO.
      *<<<< INI_FST_FLD_GSO
      *PVG INI 14-PCT-2003
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-KEY-IGSL IN GSL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-FST-FLD-GSO.                                     
      * EVA-INI  11/08                                                  
      *    ELSE                                                         
      *    IF SCR-CMND = 'ING' AND                                      
      *    GSL-COD-TSOL IN GSL = 'R'                                    
      *       MOVE -1 TO GSO-GLS-MENS-LEN IN GSO-FLD.                   
                                                                        
           IF SCR-CMND = 'ING' OR SCR-CMND = 'INE' AND                  
              GSL-COD-TSOL IN GSL = 'R'                                 
              MOVE -1 TO GSO-GLS-MENS-LEN IN GSO-FLD.                   
                                                                        
      *    IF SCR-CMND = 'ING'                                          
           IF SCR-CMND = 'ING' OR SCR-CMND = 'INE'                      
      * EVA-FIN  11/08                                                  
              MOVE FRM-POS-CURS TO GSO-COD-RSEG-LEN IN GSO-FLD          
           ELSE                                                         
           IF SCR-CMND = 'AEJ'                                          
              MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD          
           ELSE                                                         
      *PVG FIN 14-PCT-2003
      *>>>>
           MOVE -1 TO GSO-COD-ESGA-LEN IN GSO-FLD.
       FIN-FST-FLD-GSO.
           EXIT.
       
       PRO-KEY-GSO SECTION.
       INI-PRO-KEY-GSO.
           PERFORM PRO-IKY-GSO.
           PERFORM PRO-AKY-GSO.
           PERFORM PRO-MKY-GSO.
       FIN-PRO-KEY-GSO.
           EXIT.
       
       PRO-IKY-GSO SECTION.
       INI-PRO-IKY-GSO.
           MOVE FRM-CPIM-AEY TO GSO-CAI-GTIA-ATR IN GSO-FLD.
           MOVE FRM-CPIM-AEY TO GSO-IIC-GTIA-ATR IN GSO-FLD.
       FIN-PRO-IKY-GSO.
           EXIT.
       
       PRO-MKY-GSO SECTION.
       INI-PRO-MKY-GSO.
       FIN-PRO-MKY-GSO.
           EXIT.
       
       PRO-AKY-GSO SECTION.
       INI-PRO-AKY-GSO.
           MOVE FRM-CPIM-AEY TO GSO-NUM-SBGL-ATR IN GSO-FLD.
       FIN-PRO-AKY-GSO.
           EXIT.
       
       UNP-KEY-GSO SECTION.
       INI-UNP-KEY-GSO.
           PERFORM UNP-IKY-GSO.
           PERFORM UNP-AKY-GSO.
           PERFORM UNP-MKY-GSO.
       FIN-UNP-KEY-GSO.
           EXIT.
       
       UNP-IKY-GSO SECTION.
       INI-UNP-IKY-GSO.
           MOVE FRM-CPIM-UBY TO GSO-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GSO-IIC-GTIA-ATR.
       FIN-UNP-IKY-GSO.
           EXIT.
       
       UNP-MKY-GSO SECTION.
       INI-UNP-MKY-GSO.
       FIN-UNP-MKY-GSO.
           EXIT.
       
       UNP-AKY-GSO SECTION.
       INI-UNP-AKY-GSO.
           MOVE FRM-CPIM-UBY TO GSO-NUM-SBGL-ATR.
       FIN-UNP-AKY-GSO.
           EXIT.
       
       UNP-FLD-GSO SECTION.
       INI-UNP-FLD-GSO.
           PERFORM UNP-GSO-GSO.
           PERFORM UNP-DBC-GSO.
       FIN-UNP-FLD-GSO.
           EXIT.
       
       UNP-GSO-GSO SECTION.
       INI-UNP-GSO-GSO.
           MOVE FRM-CPIM-UBY TO GSO-COD-ESGA-ATR IN GSO-FLD.
           MOVE FRM-CPIM-UBY TO GSO-COD-EST2-ATR IN GSO-FLD.
           MOVE FRM-CPIM-UBY TO GSO-COD-RSEG-ATR IN GSO-FLD.
           MOVE FRM-CPIM-UBY TO GSO-IND-PCUO-ATR IN GSO-FLD.
           MOVE FRM-CPIM-UBY TO GSO-NUM-CUOT-ATR IN GSO-FLD.
      *<<<< FIN_UNP_GSO_GSO
           IF SCR-CMND = 'AEG'
              MOVE FRM-CPIM-AEY TO GSO-COD-EST2-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-COD-RSEG-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-IND-PCUO-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-NUM-CUOT-ATR IN GSO-FLD
              GO TO FIN-UNP-GSO-GSO.
              
           IF SCR-CMND = 'AEJ'
              MOVE FRM-CPIM-AEY TO GSO-COD-ESGA-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-COD-RSEG-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-IND-PCUO-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-NUM-CUOT-ATR IN GSO-FLD
              GO TO FIN-UNP-GSO-GSO.
      *>>>>
       FIN-UNP-GSO-GSO.
           EXIT.
       
       UNP-DBC-GSO SECTION.
       INI-UNP-DBC-GSO.
       FIN-UNP-DBC-GSO.
           EXIT.
       
       VAL-KEY-GSO SECTION.
       INI-VAL-KEY-GSO.
           PERFORM VAL-IKY-GSO.
           PERFORM VAL-MKY-GSO.
           PERFORM VAL-AKY-GSO.
       FIN-VAL-KEY-GSO.
           EXIT.
       
       VAL-IKY-GSO SECTION.
       INI-VAL-IKY-GSO.
           PERFORM VAL-GSO-CAI-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSO-CAI-GTIA-LEN IN GSO-FLD
                GO TO FIN-VAL-IKY-GSO.
           PERFORM VAL-GSO-IIC-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSO-IIC-GTIA-LEN IN GSO-FLD
                GO TO FIN-VAL-IKY-GSO.
       FIN-VAL-IKY-GSO.
           EXIT.
       
       VAL-MKY-GSO SECTION.
       INI-VAL-MKY-GSO.
       FIN-VAL-MKY-GSO.
           EXIT.
       
       VAL-AKY-GSO SECTION.
       INI-VAL-AKY-GSO.
           PERFORM VAL-GSO-NUM-SBGL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSO-NUM-SBGL-LEN IN GSO-FLD
                GO TO FIN-VAL-AKY-GSO.
       FIN-VAL-AKY-GSO.
           EXIT.
       
       VAL-GSO-CAI-GTIA SECTION.
       INI-VAL-GSO-CAI-GTIA.
           IF GSO-CAI-GTIA IN GSO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSO-CAI-GTIA.
       FIN-VAL-GSO-CAI-GTIA.
           EXIT.
       
       VAL-GSO-IIC-GTIA SECTION.
       INI-VAL-GSO-IIC-GTIA.
           IF GSO-IIC-GTIA IN GSO-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSO-IIC-GTIA.
       FIN-VAL-GSO-IIC-GTIA.
           EXIT.
       
       VAL-GSO-NUM-SBGL SECTION.
       INI-VAL-GSO-NUM-SBGL.
      *<<<< GSO_NUM_SBGL
      *CGL-FIN  12-SEP-2003 11:40:12 
            IF SCR-CMND NOT = 'CON'
               IF GSO-NUM-SBGL IN GSO-FLD NOT > ZEROES
                  MOVE FRM-POS-CURS TO GSO-NUM-SBGL-LEN IN GSO-FLD
                  MOVE 'BGL'          TO MSG-COD-SIST
                  MOVE 'GSO CORRNE'  TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GSO-NUM-SBGL.
      *CGL-FIN  12-SEP-2003 11:40:05 
      *>>>>
       FIN-VAL-GSO-NUM-SBGL.
           EXIT.
       
       VAL-CON-KEY-GSO SECTION.
       INI-VAL-CON-KEY-GSO.
           IF     GSO-CAI-GTIA IN GSO-FLD NOT > SPACES 
              AND GSO-IIC-GTIA IN GSO-FLD NOT > ZEROES 
              AND GSO-NUM-SBGL IN GSO-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GSO.
       FIN-VAL-CON-KEY-GSO.
           EXIT.
       
       VAL-CON-IKY-GSO SECTION.
       INI-VAL-CON-IKY-GSO.
           IF     GSO-CAI-GTIA IN GSO-FLD NOT > SPACES 
              AND GSO-IIC-GTIA IN GSO-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GSO.
       FIN-VAL-CON-IKY-GSO.
           EXIT.
       
       VAL-NUM-KEY-GSO SECTION.
       INI-VAL-NUM-KEY-GSO.
           PERFORM VAL-NUM-IKY-GSO.
           PERFORM VAL-NUM-MKY-GSO.
           PERFORM VAL-NUM-AKY-GSO.
       FIN-VAL-NUM-KEY-GSO.
           EXIT.
       
       VAL-NUM-IKY-GSO SECTION.
       INI-VAL-NUM-IKY-GSO.
       VAL-NUM-GSO-IIC-GTIA.
           MOVE GSO-IIC-GTIA-ALF IN GSO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSO-IIC-GTIA IN GSO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSO-IIC-GTIA-LEN IN GSO-FLD
                GO TO FIN-VAL-NUM-IKY-GSO.
       FIN-VAL-NUM-IKY-GSO.
           EXIT.
       
       VAL-NUM-MKY-GSO SECTION.
       INI-VAL-NUM-MKY-GSO.
       FIN-VAL-NUM-MKY-GSO.
           EXIT.
       
       VAL-NUM-AKY-GSO SECTION.
       INI-VAL-NUM-AKY-GSO.
       VAL-NUM-GSO-NUM-SBGL.
           MOVE GSO-NUM-SBGL-ALF IN GSO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSO-NUM-SBGL IN GSO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSO-NUM-SBGL-LEN IN GSO-FLD
                GO TO FIN-VAL-NUM-AKY-GSO.
       FIN-VAL-NUM-AKY-GSO.
           EXIT.
       
       VAL-NUM-FLD-GSO SECTION.
       INI-VAL-NUM-FLD-GSO.
       VAL-NUM-GSO-NUM-CUOT.
           MOVE GSO-NUM-CUOT-ALF IN GSO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSO-NUM-CUOT IN GSO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSO-NUM-CUOT-LEN IN GSO-FLD
                GO TO FIN-VAL-NUM-FLD-GSO.
       FIN-VAL-NUM-FLD-GSO.
           EXIT.
       
       EDT-KEY-GSO SECTION.
       INI-EDT-KEY-GSO.
           PERFORM EDT-IKY-GSO.
           PERFORM EDT-MKY-GSO.
           PERFORM EDT-AKY-GSO.
       FIN-EDT-KEY-GSO.
           EXIT.
       
       EDT-IKY-GSO SECTION.
       INI-EDT-IKY-GSO.
           IF GSO-IIC-GTIA-LEN IN GSO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSO-IIC-GTIA-LEN IN GSO-FLD
                GO TO FIN-EDT-IKY-GSO.
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GSO-IIC-GTIA-EDT IN GSO-EDT.
           MOVE GSO-IIC-GTIA-EDT IN GSO-EDT TO 
                GSO-IIC-GTIA-ALF IN GSO-FLD.
       FIN-EDT-IKY-GSO.
           EXIT.
       
       EDT-MKY-GSO SECTION.
       INI-EDT-MKY-GSO.
       FIN-EDT-MKY-GSO.
           EXIT.
       
       EDT-AKY-GSO SECTION.
       INI-EDT-AKY-GSO.
           IF GSO-NUM-SBGL-LEN IN GSO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSO-NUM-SBGL-LEN IN GSO-FLD
                GO TO FIN-EDT-AKY-GSO.
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSO-NUM-SBGL-EDT IN GSO-EDT.
           MOVE GSO-NUM-SBGL-EDT IN GSO-EDT TO 
                GSO-NUM-SBGL-ALF IN GSO-FLD.
       FIN-EDT-AKY-GSO.
           EXIT.
       
       EDT-FLD-GSO SECTION.
       INI-EDT-FLD-GSO.
           IF GSO-NUM-CUOT-LEN IN GSO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSO-NUM-CUOT-LEN IN GSO-FLD
                GO TO FIN-EDT-FLD-GSO.
           MOVE GSO-NUM-CUOT IN GSO-FLD TO GSO-NUM-CUOT-EDT IN GSO-EDT.
           MOVE GSO-NUM-CUOT-EDT IN GSO-EDT TO 
                GSO-NUM-CUOT-ALF IN GSO-FLD.
       FIN-EDT-FLD-GSO.
           EXIT.
