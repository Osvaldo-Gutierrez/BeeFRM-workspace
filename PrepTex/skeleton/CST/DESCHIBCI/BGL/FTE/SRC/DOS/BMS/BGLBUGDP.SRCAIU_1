      *
      * BGLBUGDP
      * Version 3.0.1 Nov-2005
      * 16-Jan-19 02:12 PM
      *
       SET-TAG-BGLBUGDP SECTION.
       INI-SET-TAG-BGLBUGDP.
           MOVE
           '<IDNMOD NOM=$BGLBUGDP$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$16-Jan-19 02:12 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGDP.
           EXIT.
           
       RET-ALL-GDP SECTION.
       INI-RET-ALL-GDP.
           PERFORM KEY-ALL-GDP.
           PERFORM RET-GDP-GDP.
           PERFORM RET-GDG-GDP.
       FIN-RET-ALL-GDP.
           EXIT.
       
       RET-GDP-GDP SECTION.
       INI-RET-GDP-GDP.
           MOVE GDP-COD-TDPN IN GDP-FLD TO GDP-COD-TDPN IN GDP.
           MOVE GDP-IND-PDPN IN GDP-FLD TO GDP-IND-PDPN IN GDP.
           MOVE GDP-NUM-PDPN IN GDP-FLD TO GDP-NUM-PDPN IN GDP.
           MOVE GDP-IND-VDPN IN GDP-FLD TO GDP-IND-VDPN IN GDP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDP-NUM-DTSO IN GDP-FLD TO GDP-NUM-DTSO IN GDP.
           MOVE GDP-NUM-MTSO IN GDP-FLD TO GDP-NUM-MTSO IN GDP.
           MOVE GDP-NUM-STSO IN GDP-FLD TO GDP-NUM-STSO IN GDP.
           MOVE GDP-NUM-ATSO IN GDP-FLD TO GDP-NUM-ATSO IN GDP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDP-SGV-TSNO IN GDP-FLD TO GDP-SGV-TSNO IN GDP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDP-NUM-DUDP IN GDP-FLD TO GDP-NUM-DUDP IN GDP.
           MOVE GDP-NUM-MUDP IN GDP-FLD TO GDP-NUM-MUDP IN GDP.
           MOVE GDP-NUM-SUDP IN GDP-FLD TO GDP-NUM-SUDP IN GDP.
           MOVE GDP-NUM-AUDP IN GDP-FLD TO GDP-NUM-AUDP IN GDP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDP-SGV-UDPN IN GDP-FLD TO GDP-SGV-UDPN IN GDP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDP-NUM-DPDP IN GDP-FLD TO GDP-NUM-DPDP IN GDP.
           MOVE GDP-NUM-MPDP IN GDP-FLD TO GDP-NUM-MPDP IN GDP.
           MOVE GDP-NUM-SPDP IN GDP-FLD TO GDP-NUM-SPDP IN GDP.
           MOVE GDP-NUM-APDP IN GDP-FLD TO GDP-NUM-APDP IN GDP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDP-SGV-PDPN IN GDP-FLD TO GDP-SGV-PDPN IN GDP.
           MOVE GDP-NUM-UDPN IN GDP-FLD TO GDP-NUM-UDPN IN GDP.
       FIN-RET-GDP-GDP.
           EXIT.
       
       RET-GDG-GDP SECTION.
       INI-RET-GDG-GDP.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GDP-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GDP-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
      * OFI-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-OFIC IN GDP-FLD TO GDG-COD-OFIC IN GDG.
      * OFI-FIN --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-VCAM IN GDP-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-GLS-DGTA IN GDP-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-GLS-DGT1 IN GDP-FLD TO GDG-GLS-DGT1 IN GDG.
       FIN-RET-GDG-GDP.
           EXIT.
       
       KEY-ALL-GDP SECTION.
       INI-KEY-ALL-GDP.
           PERFORM KEY-GDP-GDP.
           PERFORM KEY-GDG-GDP.
       FIN-KEY-ALL-GDP.
           EXIT.
       
       KEY-GDP-GDP SECTION.
       INI-KEY-GDP-GDP.
           MOVE GDP-CAI-GTIA IN GDP-FLD TO GDP-CAI-GTIA IN GDP.
           MOVE GDP-IIC-GTIA IN GDP-FLD TO GDP-IIC-GTIA IN GDP.
       FIN-KEY-GDP-GDP.
           EXIT.
       
       KEY-GDG-GDP SECTION.
       INI-KEY-GDG-GDP.
       FIN-KEY-GDG-GDP.
           EXIT.
       
       SCR-CLRA-GDP SECTION.
       INI-SCR-CLRA-GDP.
           PERFORM CLR-KEY-GDP.
           PERFORM CLR-FLD-GDP.
       FIN-SCR-CLRA-GDP.
           EXIT.
       
       CLR-KEY-GDP SECTION.
       INI-CLR-KEY-GDP.
           MOVE SPACES TO GDP-CAI-GTIA IN GDP-FLD.
           MOVE ZEROES TO GDP-IIC-GTIA IN GDP-FLD.
       FIN-CLR-KEY-GDP.
           EXIT.
       
       CLR-FLD-GDP SECTION.
       INI-CLR-FLD-GDP.
           MOVE SPACES TO FRM-GLS-TREA IN GDP-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GDP-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GDP-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GDP-FLD.
           MOVE SPACES TO FRM-GLS-TDPN IN GDP-FLD.
           MOVE SPACES TO FRM-GLS-PDPN IN GDP-FLD.
           PERFORM CLR-GDP-GDP.
           PERFORM CLR-GDG-GDP.
       FIN-CLR-FLD-GDP.
           EXIT.
       
       CLR-GDP-GDP SECTION.
       INI-CLR-GDP-GDP.
           MOVE SPACES TO GDP-COD-TDPN IN GDP-FLD.
           MOVE SPACES TO GDP-IND-PDPN IN GDP-FLD.
           MOVE ZEROES TO GDP-NUM-PDPN IN GDP-FLD.
           MOVE SPACES TO GDP-IND-VDPN IN GDP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDP-FEC-FTSO IN GDP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDP-SGV-TSNO IN GDP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDP-FEC-FUDP IN GDP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDP-SGV-UDPN IN GDP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDP-FEC-FPDP IN GDP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDP-SGV-PDPN IN GDP-FLD.
           MOVE ZEROES TO GDP-NUM-UDPN IN GDP-FLD.
       FIN-CLR-GDP-GDP.
           EXIT.
       
       CLR-GDG-GDP SECTION.
       INI-CLR-GDG-GDP.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GDP-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GDP-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GDP-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GDP-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GDP-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GDP-FLD.
       FIN-CLR-GDG-GDP.
           EXIT.
       
       FST-KEY-GDP SECTION.
       INI-FST-KEY-GDP.
           MOVE -1 TO GDP-CAI-GTIA-LEN IN GDP-FLD.
       FIN-FST-KEY-GDP.
           EXIT.
       
       FST-FLD-GDP SECTION.
       INI-FST-FLD-GDP.
           MOVE -1 TO GDP-COD-TDPN-LEN IN GDP-FLD.
      *<<<< FIN_FST_FLD_GDP
           IF SCR-CCPP = 'ING'
               GO TO FIN-FST-FLD-GDP.

           IF GAR-IND-GTAC IN CMA-VARI = 'S'
               MOVE FRM-CPIM-AEY TO GDP-COD-TDPN-ATR IN GDP-FLD
               MOVE FRM-CPIM-AEY TO GDP-COD-TDPN-STP

               MOVE FRM-CPIM-AEY TO GDP-IND-PDPN-ATR IN GDP-FLD
               MOVE FRM-CPIM-AEY TO GDP-IND-PDPN-STP

               MOVE FRM-CPIM-AEY TO GDP-NUM-PDPN-ATR IN GDP-FLD
               MOVE FRM-CPIM-AEY TO GDP-NUM-PDPN-STP

               MOVE 0            TO GDP-COD-TDPN-LEN IN GDP-FLD
               MOVE FRM-POS-CURS TO GDP-IND-VDPN-LEN IN GDP-FLD.
      *>>>>
       FIN-FST-FLD-GDP.
           EXIT.
       
       PRO-KEY-GDP SECTION.
       INI-PRO-KEY-GDP.
           PERFORM PRO-MKY-GDP.
       FIN-PRO-KEY-GDP.
           EXIT.
       
       PRO-MKY-GDP SECTION.
       INI-PRO-MKY-GDP.
       FIN-PRO-MKY-GDP.
           EXIT.
       
       PRO-FLD-GDP SECTION.
       INI-PRO-FLD-GDP.
           PERFORM PRO-GDP-GDP.
           PERFORM PRO-GDG-GDP.
       FIN-PRO-FLD-GDP.
           EXIT.
       
       PRO-GDP-GDP SECTION.
       INI-PRO-GDP-GDP.
           MOVE FRM-CPIM-AEY TO GDP-COD-TDPN-ATR IN GDP-FLD.
           MOVE FRM-CPIM-AEY TO GDP-IND-PDPN-ATR IN GDP-FLD.
           MOVE FRM-CPIM-AEY TO GDP-NUM-PDPN-ATR IN GDP-FLD.
           MOVE FRM-CPIM-AEY TO GDP-IND-VDPN-ATR IN GDP-FLD.
       FIN-PRO-GDP-GDP.
           EXIT.
       
       PRO-GDG-GDP SECTION.
       INI-PRO-GDG-GDP.
       FIN-PRO-GDG-GDP.
           EXIT.
       
       UNP-KEY-GDP SECTION.
       INI-UNP-KEY-GDP.
           PERFORM UNP-IKY-GDP.
           PERFORM UNP-AKY-GDP.
           PERFORM UNP-MKY-GDP.
       FIN-UNP-KEY-GDP.
           EXIT.
       
       UNP-IKY-GDP SECTION.
       INI-UNP-IKY-GDP.
           MOVE FRM-CPIM-UBY TO GDP-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GDP-IIC-GTIA-ATR.
       FIN-UNP-IKY-GDP.
           EXIT.
       
       UNP-MKY-GDP SECTION.
       INI-UNP-MKY-GDP.
       FIN-UNP-MKY-GDP.
           EXIT.
       
       UNP-AKY-GDP SECTION.
       INI-UNP-AKY-GDP.
       FIN-UNP-AKY-GDP.
           EXIT.
       
       UNP-FLD-GDP SECTION.
       INI-UNP-FLD-GDP.
           PERFORM UNP-GDP-GDP.
           PERFORM UNP-GDG-GDP.
       FIN-UNP-FLD-GDP.
           EXIT.
       
       UNP-GDP-GDP SECTION.
       INI-UNP-GDP-GDP.
           MOVE FRM-CPIM-UBY TO GDP-COD-TDPN-ATR IN GDP-FLD.
           MOVE FRM-CPIM-UBY TO GDP-IND-PDPN-ATR IN GDP-FLD.
           MOVE FRM-CPIM-UBY TO GDP-NUM-PDPN-ATR IN GDP-FLD.
           MOVE FRM-CPIM-UBY TO GDP-IND-VDPN-ATR IN GDP-FLD.
       FIN-UNP-GDP-GDP.
           EXIT.
       
       UNP-GDG-GDP SECTION.
       INI-UNP-GDG-GDP.
       FIN-UNP-GDG-GDP.
           EXIT.
       
       VAL-MKY-GDP SECTION.
       INI-VAL-MKY-GDP.
       FIN-VAL-MKY-GDP.
           EXIT.
       
       VAL-FLD-GDP SECTION.
       INI-VAL-FLD-GDP.
           PERFORM VAL-FRM-GLS-TREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TREA-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * IDG-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-TIP-CGTA-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-STP-CGTA-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * IDG-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * OFI-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-COD-OFIC-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * OFI-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-GDP-COD-TDPN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDP-COD-TDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-FRM-GLS-TDPN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-GDP-IND-PDPN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDP-IND-PDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-FRM-GLS-PDPN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-GDP-NUM-PDPN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDP-NUM-PDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-GDP-IND-VDPN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDP-IND-VDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDP-FEC-FTSO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDP-FEC-FTSO-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDP-SGV-TSNO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDP-SGV-TSNO-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDP-FEC-FUDP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDP-FEC-FUDP-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDP-SGV-UDPN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDP-SGV-UDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDP-FEC-FPDP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDP-FEC-FPDP-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDP-SGV-PDPN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDP-SGV-PDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
           PERFORM VAL-GDP-NUM-UDPN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDP-NUM-UDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-FLD-GDP.
       FIN-VAL-FLD-GDP.
           EXIT.
       
       VAL-FRM-GLS-TREA SECTION.
       INI-VAL-FRM-GLS-TREA.
       FIN-VAL-FRM-GLS-TREA.
           EXIT.
      * IDG-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.
           IF GDG-TIP-CGTA IN GDP-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-CGTA IN GDP-FLD.
       FIN-VAL-GDG-TIP-CGTA.
           EXIT.

       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.
           IF GDG-STP-CGTA IN GDP-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-CGTA IN GDP-FLD.
       FIN-VAL-GDG-STP-CGTA.
           EXIT.
      * IDG-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * OFI-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
           IF GDG-COD-OFIC IN GDP-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GDP-FLD.
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
      * OFI-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
       
       VAL-GDP-COD-TDPN SECTION.
       INI-VAL-GDP-COD-TDPN.
           IF GDP-COD-TDPN IN GDP-FLD NOT > SPACES
              MOVE SPACES TO GDP-COD-TDPN IN GDP-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'DPN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDP-COD-TDPN IN GDP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDP-COD-TDPN IN GDP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TDPN IN GDP-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TDPN IN GDP-FLD.
       FIN-VAL-GDP-COD-TDPN.
           EXIT.
       
       VAL-FRM-GLS-TDPN SECTION.
       INI-VAL-FRM-GLS-TDPN.
       FIN-VAL-FRM-GLS-TDPN.
           EXIT.
       
       VAL-GDP-IND-PDPN SECTION.
       INI-VAL-GDP-IND-PDPN.
           IF GDP-IND-PDPN IN GDP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDP-IND-PDPN.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'PDP ' TO TAB-COD-TTAB IN TAB.
           MOVE GDP-IND-PDPN IN GDP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDP-IND-PDPN IN GDP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PDPN IN GDP-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-PDPN IN GDP-FLD.
       FIN-VAL-GDP-IND-PDPN.
           EXIT.
       
       VAL-FRM-GLS-PDPN SECTION.
       INI-VAL-FRM-GLS-PDPN.
       FIN-VAL-FRM-GLS-PDPN.
           EXIT.
       
       VAL-GDP-NUM-PDPN SECTION.
       INI-VAL-GDP-NUM-PDPN.
           IF GDP-NUM-PDPN IN GDP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDP-NUM-PDPN.
       FIN-VAL-GDP-NUM-PDPN.
           EXIT.
       
       VAL-GDP-IND-VDPN SECTION.
       INI-VAL-GDP-IND-VDPN.
           IF GDP-IND-VDPN IN GDP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDP-IND-VDPN.
      *<<<< GDP_IND_VIG_DPN
           IF GDP-IND-VDPN IN GDP-FLD NOT > SPACES
               MOVE 'S' TO GDP-IND-VDPN IN GDP-FLD
               GO TO FIN-VAL-GDP-IND-VDPN.

      *VAL-COD Valida codigo de tabla
           MOVE 'BGL'  TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDP-IND-VDPN IN GDP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-GDP-IND-VDPN.

           IF SCR-CCPP = 'MOD' AND
              GDP-IND-VDPN IN GDP-FLD  = 'N' AND
              GAR-IND-GTAC IN CMA-VARI NOT = 'S'
               MOVE 'BGL' TO MSG-COD-SIST
               MOVE 'GDP    NOAGA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDP-IND-VDPN.
      *>>>>
       FIN-VAL-GDP-IND-VDPN.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDP-FEC-FTSO SECTION.
       INI-VAL-GDP-FEC-FTSO.
           IF GDP-FEC-FTSO IN GDP-FLD  NOT > ZEROES
              MOVE ZEROES TO GDP-FEC-FTSO IN GDP-FLD.
       FIN-VAL-GDP-FEC-FTSO.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GDP-SGV-TSNO SECTION.
       INI-VAL-GDP-SGV-TSNO.
       FIN-VAL-GDP-SGV-TSNO.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDP-FEC-FUDP SECTION.
       INI-VAL-GDP-FEC-FUDP.
           IF GDP-FEC-FUDP IN GDP-FLD  NOT > ZEROES
              MOVE ZEROES TO GDP-FEC-FUDP IN GDP-FLD.
       FIN-VAL-GDP-FEC-FUDP.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GDP-SGV-UDPN SECTION.
       INI-VAL-GDP-SGV-UDPN.
       FIN-VAL-GDP-SGV-UDPN.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDP-FEC-FPDP SECTION.
       INI-VAL-GDP-FEC-FPDP.
           IF GDP-FEC-FPDP IN GDP-FLD  NOT > ZEROES
              MOVE ZEROES TO GDP-FEC-FPDP IN GDP-FLD.
       FIN-VAL-GDP-FEC-FPDP.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GDP-SGV-PDPN SECTION.
       INI-VAL-GDP-SGV-PDPN.
       FIN-VAL-GDP-SGV-PDPN.
           EXIT.
       
       VAL-GDP-NUM-UDPN SECTION.
       INI-VAL-GDP-NUM-UDPN.
       FIN-VAL-GDP-NUM-UDPN.
           EXIT.
       
       VAL-CON-FLD-GDP SECTION.
       INI-VAL-CON-FLD-GDP.
      *<<<< VAL_CON_FLD_GDP
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-CON-FLD-GDP.

      * Busca GVT
           MOVE GDP-CAI-GTIA IN GDP-FLD  TO GVT-CAI-GTIA IN GVT.
           MOVE GDP-IIC-GTIA IN GDP-FLD  TO GVT-IIC-GTIA IN GVT.
           MOVE GAR-COD-TASN IN CMA-VARI TO GVT-COD-TASN IN GVT.
           MOVE 'GVT-KEY-IGVT' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GVT.
           IF NOT FIO-STAT-OKS
               MOVE 'GVT    NEX' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.
      *PVG INI 15-OCT-2003
      *    MOVE GVT-SGV-VPND IN GVT TO GDP-SGV-TSNO IN GDP-FLD.
           MOVE GVT-SGV-LTSN IN GVT TO GDP-SGV-TSNO IN GDP-FLD.
      *PVG FIN 15-OCT-2003
           IF GDP-SGV-TSNO IN GDP-FLD = ZEROES
               MOVE 'GDPVALORI=0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

           MOVE GVT-NUM-STSN IN GVT TO GDP-NUM-STSO IN GDP-FLD.
           MOVE GVT-NUM-ATSN IN GVT TO GDP-NUM-ATSO IN GDP-FLD.
           MOVE GVT-NUM-MTSN IN GVT TO GDP-NUM-MTSO IN GDP-FLD.
           MOVE GVT-NUM-DTSN IN GVT TO GDP-NUM-DTSO IN GDP-FLD.

           IF GDP-FEC-FTSO IN GDP-FLD NOT > ZEROES
               MOVE 'GDPFECORI=0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

      * Obtiene Fecha Proxima Depreciacion
      *<<<< NOT PGM_ARG
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO FEC-ITM1.
           MOVE HOY-MHOY TO FEC-ITM2.
           MOVE HOY-SHOY TO FEC-ITM3.
           MOVE HOY-AHOY TO FEC-ITM4.
      *>>>>
           IF GDP-IND-PDPN IN GDP-FLD NOT = 'A' AND
              GDP-IND-PDPN IN GDP-FLD NOT = 'M'
               MOVE 'GDPPDPNMAL' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

           IF GDP-IND-PDPN IN GDP-FLD = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE 1 TO FEC-NANO
           ELSE
           IF GDP-IND-PDPN IN GDP-FLD = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE 1 TO FEC-NMES.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.

           MOVE FEC-ITM1 TO GDP-NUM-DPDP IN GDP-FLD.
           MOVE FEC-ITM2 TO GDP-NUM-MPDP IN GDP-FLD.
           MOVE FEC-ITM3 TO GDP-NUM-SPDP IN GDP-FLD.
           MOVE FEC-ITM4 TO GDP-NUM-APDP IN GDP-FLD.

           IF FEC-FVLD NOT > HOY-FHOY
               MOVE 'GDPFECPXM<HY' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

      * Obtiene Valor Proxima Depreciacion
           IF GDP-COD-TDPN IN GDP-FLD = 'L'
               COMPUTE GDP-SGV-PDPN IN GDP-FLD ROUNDED =
      *MHM-INI 8-SEP-2003
      *                 GVT-SGV-VPND IN GVT /
                       GVT-SGV-LTSN IN GVT /
      *MHM-FIN 8-SEP-2003
                       GDP-NUM-PDPN IN GDP-FLD
           ELSE
           IF GDP-COD-TDPN IN GDP-FLD = 'D'
               COMPUTE GDP-SGV-PDPN IN GDP-FLD ROUNDED =
      *MHM-INI 8-SEP-2003
      *                 GVT-SGV-VPND IN GVT /
                       GVT-SGV-LTSN IN GVT /
      *MHM-FIN 8-SEP-2003
                       GDP-NUM-PDPN IN GDP-FLD * 2
           ELSE
           IF GDP-COD-TDPN IN GDP-FLD = 'A'
               MOVE ZEROES TO WSS-FACT
               PERFORM CAL-TASA-DPN VARYING I FROM 1 BY 1
                       UNTIL I > GDP-NUM-PDPN IN GDP-FLD

               COMPUTE GDP-SGV-PDPN IN GDP-FLD ROUNDED =
      *MHM-INI 8-SEP-2003
      *                 GVT-SGV-VPND IN GVT *
                       GVT-SGV-LTSN IN GVT *
      *MHM-FIN 8-SEP-2003
                       GDP-NUM-PDPN IN GDP-FLD / WSS-FACT
           ELSE
               MOVE ZEROES TO GDP-SGV-PDPN IN GDP-FLD.

           IF GDP-SGV-PDPN IN GDP-FLD = ZEROES
               MOVE 'GDPVALPXM=0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moned
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF GDG-COD-VCAM IN GDP-FLD = TAB-COD-CTAB IN TAB

               MOVE GDG-COD-VCAM IN GDP-FLD TO PES-COD-VCAM
               MOVE GDP-SGV-PDPN IN GDP-FLD TO PES-SGV-DECI
                    
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE TO GDP-SGV-PDPN IN GDP-FLD.
                    
           GO TO FIN-VAL-CON-FLD-GDP.

       ERR-VAL-CON-FLD-GDP.
           MOVE 'BGL'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-FLD-GDP.
           EXIT.
       
       VAL-CON-GDP SECTION.
       INI-VAL-CON-GDP.
       FIN-VAL-CON-GDP.
           EXIT.
       
       VAL-NUM-KEY-GDP SECTION.
       INI-VAL-NUM-KEY-GDP.
           PERFORM VAL-NUM-IKY-GDP.
           PERFORM VAL-NUM-MKY-GDP.
           PERFORM VAL-NUM-AKY-GDP.
       FIN-VAL-NUM-KEY-GDP.
           EXIT.
       
       VAL-NUM-IKY-GDP SECTION.
       INI-VAL-NUM-IKY-GDP.
       VAL-NUM-GDP-IIC-GTIA.
           MOVE GDP-IIC-GTIA-ALF IN GDP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDP-IIC-GTIA IN GDP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDP-IIC-GTIA-LEN IN GDP-FLD
                GO TO FIN-VAL-NUM-IKY-GDP.
       FIN-VAL-NUM-IKY-GDP.
           EXIT.
       
       VAL-NUM-MKY-GDP SECTION.
       INI-VAL-NUM-MKY-GDP.
       FIN-VAL-NUM-MKY-GDP.
           EXIT.
       
       VAL-NUM-AKY-GDP SECTION.
       INI-VAL-NUM-AKY-GDP.
       FIN-VAL-NUM-AKY-GDP.
           EXIT.
       
       VAL-NUM-FLD-GDP SECTION.
       INI-VAL-NUM-FLD-GDP.
       VAL-NUM-GDP-NUM-PDPN.
           MOVE GDP-NUM-PDPN-ALF IN GDP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDP-NUM-PDPN IN GDP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDP-NUM-PDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-NUM-FLD-GDP.
       VAL-NUM-GDP-SGV-TSNO.
           MOVE GDP-SGV-TSNO-ALF IN GDP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GDP-SGV-TSNO IN GDP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDP-SGV-TSNO-LEN IN GDP-FLD
                GO TO FIN-VAL-NUM-FLD-GDP.
       VAL-NUM-GDP-SGV-UDPN.
           MOVE GDP-SGV-UDPN-ALF IN GDP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GDP-SGV-UDPN IN GDP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDP-SGV-UDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-NUM-FLD-GDP.
       VAL-NUM-GDP-SGV-PDPN.
           MOVE GDP-SGV-PDPN-ALF IN GDP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GDP-SGV-PDPN IN GDP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDP-SGV-PDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-NUM-FLD-GDP.
       VAL-NUM-GDP-NUM-UDPN.
           MOVE GDP-NUM-UDPN-ALF IN GDP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDP-NUM-UDPN IN GDP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDP-NUM-UDPN-LEN IN GDP-FLD
                GO TO FIN-VAL-NUM-FLD-GDP.
       FIN-VAL-NUM-FLD-GDP.
           EXIT.
       
       EDT-KEY-GDP SECTION.
       INI-EDT-KEY-GDP.
           PERFORM EDT-IKY-GDP.
           PERFORM EDT-MKY-GDP.
           PERFORM EDT-AKY-GDP.
       FIN-EDT-KEY-GDP.
           EXIT.
       
       EDT-IKY-GDP SECTION.
       INI-EDT-IKY-GDP.
           IF GDP-IIC-GTIA-LEN IN GDP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDP-IIC-GTIA-LEN IN GDP-FLD
                GO TO FIN-EDT-IKY-GDP.
           MOVE GDP-IIC-GTIA IN GDP-FLD TO GDP-IIC-GTIA-EDT IN GDP-EDT.
           MOVE GDP-IIC-GTIA-EDT IN GDP-EDT TO 
                GDP-IIC-GTIA-ALF IN GDP-FLD.
       FIN-EDT-IKY-GDP.
           EXIT.
       
       EDT-MKY-GDP SECTION.
       INI-EDT-MKY-GDP.
       FIN-EDT-MKY-GDP.
           EXIT.
       
       EDT-AKY-GDP SECTION.
       INI-EDT-AKY-GDP.
       FIN-EDT-AKY-GDP.
           EXIT.
       
       EDT-FLD-GDP SECTION.
       INI-EDT-FLD-GDP.
           IF GDP-NUM-PDPN-LEN IN GDP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDP-NUM-PDPN-LEN IN GDP-FLD
                GO TO FIN-EDT-FLD-GDP.
           MOVE GDP-NUM-PDPN IN GDP-FLD TO GDP-NUM-PDPN-EDT IN GDP-EDT.
           MOVE GDP-NUM-PDPN-EDT IN GDP-EDT TO 
                GDP-NUM-PDPN-ALF IN GDP-FLD.
           IF GDP-SGV-TSNO-LEN IN GDP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDP-SGV-TSNO-LEN IN GDP-FLD
                GO TO FIN-EDT-FLD-GDP.
           MOVE GDP-SGV-TSNO IN GDP-FLD TO GDP-SGV-TSNO-EDT IN GDP-EDT.
           MOVE GDP-SGV-TSNO-EDT IN GDP-EDT TO 
                GDP-SGV-TSNO-ALF IN GDP-FLD.
           IF GDP-SGV-UDPN-LEN IN GDP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDP-SGV-UDPN-LEN IN GDP-FLD
                GO TO FIN-EDT-FLD-GDP.
           MOVE GDP-SGV-UDPN IN GDP-FLD TO GDP-SGV-UDPN-EDT IN GDP-EDT.
           MOVE GDP-SGV-UDPN-EDT IN GDP-EDT TO 
                GDP-SGV-UDPN-ALF IN GDP-FLD.
           IF GDP-SGV-PDPN-LEN IN GDP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDP-SGV-PDPN-LEN IN GDP-FLD
                GO TO FIN-EDT-FLD-GDP.
           MOVE GDP-SGV-PDPN IN GDP-FLD TO GDP-SGV-PDPN-EDT IN GDP-EDT.
           MOVE GDP-SGV-PDPN-EDT IN GDP-EDT TO 
                GDP-SGV-PDPN-ALF IN GDP-FLD.
           IF GDP-NUM-UDPN-LEN IN GDP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDP-NUM-UDPN-LEN IN GDP-FLD
                GO TO FIN-EDT-FLD-GDP.
           MOVE GDP-NUM-UDPN IN GDP-FLD TO GDP-NUM-UDPN-EDT IN GDP-EDT.
           MOVE GDP-NUM-UDPN-EDT IN GDP-EDT TO 
                GDP-NUM-UDPN-ALF IN GDP-FLD.
       FIN-EDT-FLD-GDP.
           EXIT.
      *<<<< EOF
       CAL-TASA-DPN SECTION.
       INI-CAL-TASA-DPN.
               COMPUTE WSS-FACT = WSS-FACT + I.
       FIN-CAL-TASA-DPN.
           EXIT.
      *>>>>
