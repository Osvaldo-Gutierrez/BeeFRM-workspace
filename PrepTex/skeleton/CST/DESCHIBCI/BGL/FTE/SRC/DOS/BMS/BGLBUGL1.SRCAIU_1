      *
      * BGLBUGL1
      * Version 3.0.1 Nov-2005
      * 14-Apr-10 10:49 AM
      *
       SET-TAG-BGLBUGL1 SECTION.
       INI-SET-TAG-BGLBUGL1.
           MOVE
           '<IDNMOD NOM=$BGLBUGL1$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$14-Apr-10 10:49 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGL1.
           EXIT.
           
       RET-ALL-GL1 SECTION.
       INI-RET-ALL-GL1.
           PERFORM KEY-ALL-GL1.
           PERFORM RET-GL1-GL1.
           PERFORM RET-GDG-GL1.
           PERFORM RET-DBC-GL1.
       FIN-RET-ALL-GL1.
           EXIT.
       
       RET-GL1-GL1 SECTION.
       INI-RET-GL1-GL1.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GL1-NUM-DINS IN GL1-FLD TO GL1-NUM-DINS IN GL1.
           MOVE GL1-NUM-MINS IN GL1-FLD TO GL1-NUM-MINS IN GL1.
           MOVE GL1-NUM-SINS IN GL1-FLD TO GL1-NUM-SINS IN GL1.
           MOVE GL1-NUM-AINS IN GL1-FLD TO GL1-NUM-AINS IN GL1.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GL1-NUM-DNOT IN GL1-FLD TO GL1-NUM-DNOT IN GL1.
           MOVE GL1-NUM-MNOT IN GL1-FLD TO GL1-NUM-MNOT IN GL1.
           MOVE GL1-NUM-SNOT IN GL1-FLD TO GL1-NUM-SNOT IN GL1.
           MOVE GL1-NUM-ANOT IN GL1-FLD TO GL1-NUM-ANOT IN GL1.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GL1-CAI-FNZA IN GL1-FLD TO GL1-CAI-FNZA IN GL1.
           MOVE GL1-IIC-FNZA IN GL1-FLD TO GL1-IIC-FNZA IN GL1.
           MOVE GL1-GLS-NOTI IN GL1-FLD TO GL1-GLS-NOTI IN GL1.
           MOVE GL1-GLS-DBI1 IN GL1-FLD TO GL1-GLS-DBI1 IN GL1.
           MOVE GL1-GLS-DBI2 IN GL1-FLD TO GL1-GLS-DBI2 IN GL1.
           MOVE GL1-GLS-DBI3 IN GL1-FLD TO GL1-GLS-DBI3 IN GL1.
           MOVE GL1-GLS-DBI4 IN GL1-FLD TO GL1-GLS-DBI4 IN GL1.
           MOVE GL1-GLS-OBS1 IN GL1-FLD TO GL1-GLS-OBS1 IN GL1.
           MOVE GL1-GLS-OBS2 IN GL1-FLD TO GL1-GLS-OBS2 IN GL1.
           MOVE GL1-GLS-OBS3 IN GL1-FLD TO GL1-GLS-OBS3 IN GL1.
           MOVE GL1-GLS-OBS4 IN GL1-FLD TO GL1-GLS-OBS4 IN GL1.
           MOVE GL1-GLS-OBS5 IN GL1-FLD TO GL1-GLS-OBS5 IN GL1.
       FIN-RET-GL1-GL1.
           EXIT.
       
       RET-GDG-GL1 SECTION.
       INI-RET-GDG-GL1.
           MOVE GDG-COD-CGTA IN GL1-FLD TO GDG-COD-CGTA IN GDG.
           MOVE GDG-COD-OFIC IN GL1-FLD TO GDG-COD-OFIC IN GDG.
           MOVE GDG-COD-VCAM IN GL1-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-GLS-DGTA IN GL1-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-GLS-DGT1 IN GL1-FLD TO GDG-GLS-DGT1 IN GDG.
       FIN-RET-GDG-GL1.
           EXIT.
       
       RET-DBC-GL1 SECTION.
       INI-RET-DBC-GL1.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN GL1-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN GL1-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GL1-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GL1-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-RET-DBC-GL1.
           EXIT.
       
       KEY-ALL-GL1 SECTION.
       INI-KEY-ALL-GL1.
           PERFORM KEY-GL1-GL1.
           PERFORM KEY-GDG-GL1.
           PERFORM KEY-DBC-GL1.
       FIN-KEY-ALL-GL1.
           EXIT.
       
       KEY-GL1-GL1 SECTION.
       INI-KEY-GL1-GL1.
           MOVE GL1-CAI-GTIA IN GL1-FLD TO GL1-CAI-GTIA IN GL1.
           MOVE GL1-IIC-GTIA IN GL1-FLD TO GL1-IIC-GTIA IN GL1.
           MOVE GL1-COD-PACR IN GL1-FLD TO GL1-COD-PACR IN GL1.
       FIN-KEY-GL1-GL1.
           EXIT.
       
       KEY-GDG-GL1 SECTION.
       INI-KEY-GDG-GL1.
       FIN-KEY-GDG-GL1.
           EXIT.
       
       KEY-DBC-GL1 SECTION.
       INI-KEY-DBC-GL1.
       FIN-KEY-DBC-GL1.
           EXIT.
       
       SCR-CLRA-GL1 SECTION.
       INI-SCR-CLRA-GL1.
           PERFORM CLR-KEY-GL1.
           PERFORM CLR-FLD-GL1.
       FIN-SCR-CLRA-GL1.
           EXIT.
       
       CLR-KEY-GL1 SECTION.
       INI-CLR-KEY-GL1.
           MOVE SPACES TO GL1-CAI-GTIA IN GL1-FLD.
           MOVE ZEROES TO GL1-IIC-GTIA IN GL1-FLD.
           MOVE ZEROES TO GL1-COD-PACR IN GL1-FLD.
       FIN-CLR-KEY-GL1.
           EXIT.
       
       CLR-FLD-GL1 SECTION.
       INI-CLR-FLD-GL1.
           MOVE SPACES TO FRM-GLS-PACR IN GL1-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GL1-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GL1-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GL1-FLD.
           MOVE SPACES TO FRM-GLS-NOMC IN GL1-FLD.
           PERFORM CLR-GL1-GL1.
           PERFORM CLR-GDG-GL1.
           PERFORM CLR-DBC-GL1.
       FIN-CLR-FLD-GL1.
           EXIT.
       
       CLR-GL1-GL1 SECTION.
       INI-CLR-GL1-GL1.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GL1-FEC-FINS IN GL1-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GL1-FEC-FNOT IN GL1-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GL1-CAI-FNZA IN GL1-FLD.
           MOVE ZEROES TO GL1-IIC-FNZA IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-NOTI IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-DBI1 IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-DBI2 IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-DBI3 IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-DBI4 IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-OBS1 IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-OBS2 IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-OBS3 IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-OBS4 IN GL1-FLD.
           MOVE SPACES TO GL1-GLS-OBS5 IN GL1-FLD.
       FIN-CLR-GL1-GL1.
           EXIT.
       
       CLR-GDG-GL1 SECTION.
       INI-CLR-GDG-GL1.
           MOVE SPACES TO GDG-COD-CGTA IN GL1-FLD.
           MOVE SPACES TO GDG-COD-OFIC IN GL1-FLD.
           MOVE SPACES TO GDG-COD-VCAM IN GL1-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GL1-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GL1-FLD.
       FIN-CLR-GDG-GL1.
           EXIT.
       
       CLR-DBC-GL1 SECTION.
       INI-CLR-DBC-GL1.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN GL1-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN GL1-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN GL1-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN GL1-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-DBC-GL1.
           EXIT.
       
       FST-KEY-GL1 SECTION.
       INI-FST-KEY-GL1.
           MOVE -1 TO GL1-CAI-GTIA-LEN IN GL1-FLD.
       FIN-FST-KEY-GL1.
           EXIT.
       
       FST-FLD-GL1 SECTION.
       INI-FST-FLD-GL1.
           MOVE FRM-POS-CURS TO GL1-FEC-FINS-LEN IN GL1-FLD.
       FIN-FST-FLD-GL1.
           EXIT.
       
       PRO-KEY-GL1 SECTION.
       INI-PRO-KEY-GL1.
           PERFORM PRO-MKY-GL1.
       FIN-PRO-KEY-GL1.
           EXIT.
       
       PRO-MKY-GL1 SECTION.
       INI-PRO-MKY-GL1.
       FIN-PRO-MKY-GL1.
           EXIT.
       
       PRO-FLD-GL1 SECTION.
       INI-PRO-FLD-GL1.
           PERFORM PRO-GL1-GL1.
           PERFORM PRO-GDG-GL1.
           PERFORM PRO-DBC-GL1.
       FIN-PRO-FLD-GL1.
           EXIT.
       
       PRO-GL1-GL1 SECTION.
       INI-PRO-GL1-GL1.
           MOVE FRM-CPIM-AEY TO GL1-FEC-FINS-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-FEC-FNOT-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-CAI-FNZA-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-IIC-FNZA-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-NOTI-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-DBI1-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-DBI2-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-DBI3-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-DBI4-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-OBS1-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-OBS2-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-OBS3-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-OBS4-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO GL1-GLS-OBS5-ATR IN GL1-FLD.
       FIN-PRO-GL1-GL1.
           EXIT.
       
       PRO-GDG-GL1 SECTION.
       INI-PRO-GDG-GL1.
       FIN-PRO-GDG-GL1.
           EXIT.
       
       PRO-DBC-GL1 SECTION.
       INI-PRO-DBC-GL1.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GL1-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GL1-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-DBC-GL1.
           EXIT.
       
       UNP-KEY-GL1 SECTION.
       INI-UNP-KEY-GL1.
           PERFORM UNP-IKY-GL1.
           PERFORM UNP-AKY-GL1.
           PERFORM UNP-MKY-GL1.
       FIN-UNP-KEY-GL1.
           EXIT.
       
       UNP-IKY-GL1 SECTION.
       INI-UNP-IKY-GL1.
           MOVE FRM-CPIM-UBY TO GL1-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GL1-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GL1-COD-PACR-ATR.
       FIN-UNP-IKY-GL1.
           EXIT.
       
       UNP-MKY-GL1 SECTION.
       INI-UNP-MKY-GL1.
       FIN-UNP-MKY-GL1.
           EXIT.
       
       UNP-AKY-GL1 SECTION.
       INI-UNP-AKY-GL1.
       FIN-UNP-AKY-GL1.
           EXIT.
       
       UNP-FLD-GL1 SECTION.
       INI-UNP-FLD-GL1.
           PERFORM UNP-GL1-GL1.
           PERFORM UNP-GDG-GL1.
           PERFORM UNP-DBC-GL1.
       FIN-UNP-FLD-GL1.
           EXIT.
       
       UNP-GL1-GL1 SECTION.
       INI-UNP-GL1-GL1.
           MOVE FRM-CPIM-UBY TO GL1-FEC-FINS-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-FEC-FNOT-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-CAI-FNZA-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-IIC-FNZA-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-NOTI-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-DBI1-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-DBI2-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-DBI3-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-DBI4-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-OBS1-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-OBS2-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-OBS3-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-OBS4-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO GL1-GLS-OBS5-ATR IN GL1-FLD.
       FIN-UNP-GL1-GL1.
           EXIT.
       
       UNP-GDG-GL1 SECTION.
       INI-UNP-GDG-GL1.
       FIN-UNP-GDG-GL1.
           EXIT.
       
       UNP-DBC-GL1 SECTION.
       INI-UNP-DBC-GL1.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN GL1-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN GL1-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-DBC-GL1.
           EXIT.
       
       VAL-MKY-GL1 SECTION.
       INI-VAL-MKY-GL1.
       FIN-VAL-MKY-GL1.
           EXIT.
       
       VAL-FLD-GL1 SECTION.
       INI-VAL-FLD-GL1.
      *<<<<                                                                 
           MOVE GDG-COD-CGTA IN GL1-FLD TO WSS-COD-CGTA IN WSS-VARI.            
           IF WSS-TIP-CGTA IN WSS-VARI NOT = '952'                              
               GO TO NXT-VAL-FLD-GL1.                                           
                                                                                
           MOVE 'N' TO WSS-IND-CIND IN WSS-VARI.                                
           MOVE 'N' TO WSS-IND-CMER IN WSS-VARI.                                
           MOVE 'N' TO WSS-IND-CDES IN WSS-VARI.                                
           MOVE 'N' TO WSS-IND-CMOB IN WSS-VARI.                                
           MOVE 'N' TO WSS-IND-CAGR IN WSS-VARI.                                
           MOVE 'N' TO WSS-IND-COTR IN WSS-VARI.                                
           MOVE GDG-COD-CGTA IN GL1-FLD TO WSS-TBL-CGTA IN WSS-VARI.            
           MOVE 'IND'                   TO WSS-COD-TTAB IN WSS-VARI.            
           PERFORM LEE-TBL-CMPO.                                                
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
               MOVE 'S' TO WSS-IND-CIND IN WSS-VARI                             
               GO TO NXT-VAL-FLD-GL1.                                           
           MOVE 'MER'                   TO WSS-COD-TTAB IN WSS-VARI.            
           PERFORM LEE-TBL-CMPO.                                                
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
               MOVE 'S' TO WSS-IND-CMER IN WSS-VARI                             
               GO TO NXT-VAL-FLD-GL1.                                           
           MOVE 'DES'                   TO WSS-COD-TTAB IN WSS-VARI.            
           PERFORM LEE-TBL-CMPO.                                                
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
               MOVE 'S' TO WSS-IND-CDES IN WSS-VARI                             
               GO TO NXT-VAL-FLD-GL1.                                           
           MOVE 'MOB'                   TO WSS-COD-TTAB IN WSS-VARI.            
           PERFORM LEE-TBL-CMPO.                                                
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
               MOVE 'S' TO WSS-IND-CMOB IN WSS-VARI                             
               GO TO NXT-VAL-FLD-GL1.                                           
           MOVE 'AGR'                   TO WSS-COD-TTAB IN WSS-VARI.            
           PERFORM LEE-TBL-CMPO.                                                
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
               MOVE 'S' TO WSS-IND-CAGR IN WSS-VARI                             
               GO TO NXT-VAL-FLD-GL1.                                           
           MOVE 'OTR'                   TO WSS-COD-TTAB IN WSS-VARI.            
           PERFORM LEE-TBL-CMPO.                                                
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
               MOVE 'S' TO WSS-IND-COTR IN WSS-VARI.                            
       NXT-VAL-FLD-GL1.                                                         
      *>>>>                                                                   
           PERFORM VAL-FRM-GLS-PACR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PACR-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GDG-COD-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-CGTA-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-OFIC-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GL1-FEC-FINS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GL1-FEC-FINS-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GL1-FEC-FNOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GL1-FEC-FNOT-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GL1-CAI-FNZA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-CAI-FNZA-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-IIC-FNZA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-IIC-FNZA-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMC-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-NOTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-NOTI-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-DBI1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-DBI1-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-DBI2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-DBI2-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-DBI3.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-DBI3-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-DBI4.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-DBI4-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-OBS1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-OBS1-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-OBS2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-OBS2-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-OBS3.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-OBS3-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-OBS4.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-OBS4-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
           PERFORM VAL-GL1-GLS-OBS5.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GL1-GLS-OBS5-LEN IN GL1-FLD
                GO TO FIN-VAL-FLD-GL1.
       FIN-VAL-FLD-GL1.
           EXIT.
       
       VAL-FRM-GLS-PACR SECTION.
       INI-VAL-FRM-GLS-PACR.
       FIN-VAL-FRM-GLS-PACR.
           EXIT.
       
       VAL-GDG-COD-CGTA SECTION.
       INI-VAL-GDG-COD-CGTA.
       FIN-VAL-GDG-COD-CGTA.
           EXIT.
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
       
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GL1-FEC-FINS SECTION.
       INI-VAL-GL1-FEC-FINS.
           IF GL1-FEC-FINS IN GL1-FLD  NOT > ZEROES
              MOVE ZEROES TO GL1-FEC-FINS IN GL1-FLD.
      *VAL-FEC Validar Fecha
           MOVE GL1-FEC-FINS IN GL1-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<<                                                                
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT1 IN TAB-GLS-DAT1(6) = 'S' AND                      
                 GL1-FEC-FINS IN GL1-FLD NOT > ZEROES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-GL1-FEC-FINS.                                   
                                                                                
                                                                                
           IF WSS-IND-CMER IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT3 IN TAB-GLS-DAT3(10) = 'S' AND                     
                 GL1-FEC-FINS IN GL1-FLD NOT > ZEROES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-GL1-FEC-FINS.                                   
                                                                                
           MOVE GL1-NUM-SINS IN GL1-FLD TO WSS-NUM-SINS IN WSS-VARI.            
           MOVE GL1-NUM-AINS IN GL1-FLD TO WSS-NUM-AINS IN WSS-VARI.            
           MOVE GL1-NUM-MINS IN GL1-FLD TO WSS-NUM-MINS IN WSS-VARI.            
           MOVE GL1-NUM-DINS IN GL1-FLD TO WSS-NUM-DINS IN WSS-VARI.            
                                                                                
           IF GL1-FEC-FINS IN GL1-FLD > ZEROES                                  
               PERFORM GET-FHOY                                                 
               MOVE HOY-SHOY TO WSS-NUM-SHOY IN WSS-VARI                        
               MOVE HOY-AHOY TO WSS-NUM-AHOY IN WSS-VARI                        
               MOVE HOY-MHOY TO WSS-NUM-MHOY IN WSS-VARI                        
               MOVE HOY-DHOY TO WSS-NUM-DHOY IN WSS-VARI                        
               IF WSS-FEC-FINS IN WSS-VARI > WSS-FEC-FHOY IN WSS-VARI           
                  MOVE 'BGL' TO MSG-COD-SIST                            
                  MOVE 'FESCMAYING' TO MSG-COD-MENS                     
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC  TO FRM-MEN1                        
                  MOVE FRM-SUAR-MAL  TO FRM-SUAR                        
                  GO TO FIN-VAL-GL1-FEC-FINS                            
              ELSE                                                              
                  MOVE 19 TO WSS-NUM-SMEN IN WSS-VARI                           
                  MOVE 80 TO WSS-NUM-AMEN IN WSS-VARI                           
                  MOVE 01 TO WSS-NUM-MMEN IN WSS-VARI                           
                  MOVE 01 TO WSS-NUM-DMEN IN WSS-VARI                           
                  IF WSS-FEC-FINS IN WSS-VARI <                                 
                     WSS-FEC-FMEN IN WSS-VARI                                   
                      MOVE 'BGL' TO MSG-COD-SIST                        
                      MOVE 'FESCMENLIM' TO MSG-COD-MENS                 
                      PERFORM GET-MSG                                   
                      MOVE MSG-GLS-DESC  TO FRM-MEN1                    
                      MOVE FRM-SUAR-MAL  TO FRM-SUAR                    
                      GO TO FIN-VAL-GL1-FEC-FINS.                       
                                                                                
      *VAL-FEC Validar Fecha                                                    
           MOVE GL1-FEC-FINS IN GL1-FLD TO FEC-FECH.                            
           MOVE FEC-FORM-FEC TO FEC-FORM.                                       
           MOVE FEC-FBLK-S  TO FEC-FBLK.                                        
           MOVE FEC-CHOY-LE TO FEC-CHOY.                                        
           MOVE FEC-VHBL-S TO FEC-VHBL.                                         
           MOVE FEC-VAL-FEC TO FEC-CMND.                                        
      *>>>>                                                                 
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GL1-FEC-FINS IN GL1-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GL1-FEC-FINS.
       FIN-VAL-GL1-FEC-FINS.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GL1-FEC-FNOT SECTION.
       INI-VAL-GL1-FEC-FNOT.
           IF GL1-FEC-FNOT IN GL1-FLD  NOT > ZEROES
              MOVE ZEROES TO GL1-FEC-FNOT IN GL1-FLD.
      *VAL-FEC Validar Fecha
           MOVE GL1-FEC-FNOT IN GL1-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<<                                                                 
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT1 IN TAB-GLS-DAT1(7) = 'S' AND                      
                 GL1-FEC-FNOT IN GL1-FLD NOT > ZEROES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-GL1-FEC-FNOT.                                   
                                                                                
           MOVE GL1-NUM-SNOT IN GL1-FLD TO WSS-NUM-SNOT IN WSS-VARI.            
           MOVE GL1-NUM-ANOT IN GL1-FLD TO WSS-NUM-ANOT IN WSS-VARI.            
           MOVE GL1-NUM-MNOT IN GL1-FLD TO WSS-NUM-MNOT IN WSS-VARI.            
           MOVE GL1-NUM-DNOT IN GL1-FLD TO WSS-NUM-DNOT IN WSS-VARI.            
                                                                                
           IF WSS-IND-CMOB IN WSS-VARI = 'S'                                    
               PERFORM GET-FHOY                                                 
               MOVE HOY-SHOY TO WSS-NUM-SHOY IN WSS-VARI                        
               MOVE HOY-AHOY TO WSS-NUM-AHOY IN WSS-VARI                        
               MOVE HOY-MHOY TO WSS-NUM-MHOY IN WSS-VARI                        
               MOVE HOY-DHOY TO WSS-NUM-DHOY IN WSS-VARI                        
               IF WSS-FEC-FNOT IN WSS-VARI > WSS-FEC-FHOY IN WSS-VARI           
                  MOVE 'BGL' TO MSG-COD-SIST                            
                  MOVE 'FESCMAYING' TO MSG-COD-MENS                     
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC  TO FRM-MEN1                        
                  MOVE FRM-SUAR-MAL  TO FRM-SUAR                        
                  GO TO FIN-VAL-GL1-FEC-FNOT                            
              ELSE                                                              
                  MOVE 19 TO WSS-NUM-SMEN IN WSS-VARI                           
                  MOVE 80 TO WSS-NUM-AMEN IN WSS-VARI                           
                  MOVE 01 TO WSS-NUM-MMEN IN WSS-VARI                           
                  MOVE 01 TO WSS-NUM-DMEN IN WSS-VARI                           
                  IF WSS-FEC-FNOT IN WSS-VARI <                                 
                     WSS-FEC-FMEN IN WSS-VARI                                   
                      MOVE 'BGL' TO MSG-COD-SIST                        
                      MOVE 'FESCMENLIM' TO MSG-COD-MENS                 
                      PERFORM GET-MSG                                   
                      MOVE MSG-GLS-DESC  TO FRM-MEN1                    
                      MOVE FRM-SUAR-MAL  TO FRM-SUAR                    
                      GO TO FIN-VAL-GL1-FEC-FNOT.                       
                                                                                
       NXT-FEC-FNOT.                                                            
      *VAL-FEC Validar Fecha                                                    
           MOVE GL1-FEC-FNOT IN GL1-FLD TO FEC-FECH.                            
           MOVE FEC-FORM-FEC TO FEC-FORM.                                       
           MOVE FEC-FBLK-S  TO FEC-FBLK.                                        
           MOVE FEC-CHOY-LE TO FEC-CHOY.                                        
           MOVE FEC-VHBL-S TO FEC-VHBL.                                         
           MOVE FEC-VAL-FEC TO FEC-CMND.                                        
      *>>>>                                                                  
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GL1-FEC-FNOT IN GL1-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GL1-FEC-FNOT.
       FIN-VAL-GL1-FEC-FNOT.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GL1-CAI-FNZA SECTION.
       INI-VAL-GL1-CAI-FNZA.
           IF GL1-CAI-FNZA IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-CAI-FNZA IN GL1-FLD.
      *<<<<                                                               
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT1 IN TAB-GLS-DAT1(8) = 'S' AND                      
                 GL1-CAI-FNZA IN GL1-FLD NOT > SPACES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-GL1-CAI-FNZA.                                   
      *>>>>                                                                   
       FIN-VAL-GL1-CAI-FNZA.
           EXIT.
       
       VAL-GL1-IIC-FNZA SECTION.
       INI-VAL-GL1-IIC-FNZA.
      *<<<<                                                                   
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT1 IN TAB-GLS-DAT1(8) = 'S' AND                      
                 GL1-IIC-FNZA IN GL1-FLD NOT > ZEROES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-GL1-IIC-FNZA.                                   
                                                                                
           IF GL1-CAI-FNZA IN GL1-FLD NOT > SPACES AND                          
              GL1-IIC-FNZA IN GL1-FLD NOT > ZEROES                              
              GO TO FIN-VAL-GL1-IIC-FNZA.                                       
                                                                                
           MOVE GL1-CAI-FNZA IN GL1-FLD TO FIA-CAI-IESC IN FIA.                 
           MOVE GL1-IIC-FNZA IN GL1-FLD TO FIA-IIC-IESC IN FIA.                 
           MOVE ZEROES                  TO FIA-NUM-IFIA IN FIA.                 
           MOVE ZEROES                  TO FIA-STP-ITRN IN FIA.                 
           MOVE FIO-GET-NLS TO FIO-CMND.                                        
           PERFORM DEU-FIO-FIA.                                                 
           IF NOT (FIO-STAT-OKS AND                                             
               GL1-CAI-FNZA IN GL1-FLD = FIA-CAI-IESC IN FIA AND                
               GL1-IIC-FNZA IN GL1-FLD = FIA-IIC-IESC IN FIA)                   
                MOVE 'DEU' TO MSG-COD-SIST                                      
                MOVE 'FIA    NEX' TO MSG-COD-MENS                               
                PERFORM GET-MSG                                                 
                MOVE MSG-GLS-DESC  TO FRM-MEN1                                  
                MOVE FRM-SUAR-MAL  TO FRM-SUAR                                  
                GO TO FIN-VAL-GL1-IIC-FNZA.                                     
                                                                                
           MOVE FIA-CIC-ICLI IN FIA TO DBC-CIC-ICLI IN DBC.                     
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM SGC-FIO-DBC.                                                 
           IF NOT FIO-STAT-OKS                                                  
               MOVE 'TAB' TO MSG-COD-SIST                                       
               MOVE 'CLI    NEX' TO MSG-COD-MENS                                
               PERFORM GET-MSG                                                  
               MOVE MSG-GLS-DESC  TO FRM-MEN1                                   
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                                   
               GO TO FIN-VAL-GL1-IIC-FNZA.                                      
                                                                                
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN GL1-FLD.                 
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GL1-FLD.                 
           PERFORM LEE-GDD.                                                     
           IF DBC-NUM-ICLI IN GL1-FLD = GDG-NUM-IPRO IN GDG AND                 
              DBC-VRF-ICLI IN GL1-FLD = GDG-VRF-IPRO IN GDG                     
               GO TO FIN-VAL-GL1-IIC-FNZA.                                      
                                                                                
           IF WSS-IND-EGDD IN WSS-VARI = 'N'                                    
               MOVE 'TAB' TO MSG-COD-SIST                                       
               MOVE 'GDD    NEX' TO MSG-COD-MENS                                
               PERFORM GET-MSG                                                  
               MOVE MSG-GLS-DESC  TO FRM-MEN1                                   
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                                   
               GO TO FIN-VAL-GL1-IIC-FNZA.                                      
      *>>>>                                                                  
       FIN-VAL-GL1-IIC-FNZA.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
      *<<<<                                                                  
           IF DBC-NUM-ICLI IN GL1-FLD NOT > ZEROES                              
              MOVE SPACES TO FRM-GLS-NOMC IN GL1-FLD.                           
                                                                                
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT1 IN TAB-GLS-DAT1(9) = 'S' AND                      
                 DBC-NUM-ICLI IN GL1-FLD NOT > ZEROES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-DBC-NUM-ICLI.                                   
                                                                                
           IF DBC-NUM-ICLI IN GL1-FLD > ZEROES                                  
              PERFORM BUS-CLI.                                                  
      *>>>>                                                              
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN GL1-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN GL1-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN GL1-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN GL1-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN GL1-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN GL1-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN GL1-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN GL1-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN GL1-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN GL1-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN GL1-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN GL1-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
      *<<<<                                                                
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT1 IN TAB-GLS-DAT1(10) = 'S' AND                     
                 FRM-GLS-NOMC IN GL1-FLD NOT > SPACES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-FRM-GLS-NOMC.                                   
                                                                                
           IF FRM-GLS-NOMC IN GL1-FLD NOT > SPACES                              
              MOVE SPACES TO FRM-GLS-NOMC IN GL1-FLD.                           
                                                                                
           IF DBC-NUM-ICLI IN GL1-FLD NOT > ZEROES                              
              GO TO FIN-VAL-FRM-GLS-NOMC.                                       
                                                                                
           PERFORM BUS-CLI.                                                     
           IF WSS-IND-ECLI IN WSS-VARI = 'S'                                    
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                             
               PERFORM CPT-BLKS                                                 
               MOVE CPT-STRN            TO FRM-GLS-NOMC IN GL1-FLD.             
      *>>>>                                                               
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-GL1-GLS-NOTI SECTION.
       INI-VAL-GL1-GLS-NOTI.
           IF GL1-GLS-NOTI IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-NOTI IN GL1-FLD.
      *<<<<                                                                 
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT2 IN TAB-GLS-DAT2(1) = 'S' AND                      
                 GL1-GLS-NOTI IN GL1-FLD NOT > SPACES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-GL1-GLS-NOTI.                                   
      *>>>>                                                                
       FIN-VAL-GL1-GLS-NOTI.
           EXIT.
       
       VAL-GL1-GLS-DBI1 SECTION.
       INI-VAL-GL1-GLS-DBI1.
           IF GL1-GLS-DBI1 IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-DBI1 IN GL1-FLD.
      *<<<<                                                                 
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT2 IN TAB-GLS-DAT2(2) = 'S' AND                      
                 GL1-GLS-DBI1 IN GL1-FLD NOT > SPACES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-GL1-GLS-DBI1.                                   
      *>>>>                                                          
       FIN-VAL-GL1-GLS-DBI1.
           EXIT.
       
       VAL-GL1-GLS-DBI2 SECTION.
       INI-VAL-GL1-GLS-DBI2.
           IF GL1-GLS-DBI2 IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-DBI2 IN GL1-FLD.
       FIN-VAL-GL1-GLS-DBI2.
           EXIT.
       
       VAL-GL1-GLS-DBI3 SECTION.
       INI-VAL-GL1-GLS-DBI3.
           IF GL1-GLS-DBI3 IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-DBI3 IN GL1-FLD.
       FIN-VAL-GL1-GLS-DBI3.
           EXIT.
       
       VAL-GL1-GLS-DBI4 SECTION.
       INI-VAL-GL1-GLS-DBI4.
           IF GL1-GLS-DBI4 IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-DBI4 IN GL1-FLD.
       FIN-VAL-GL1-GLS-DBI4.
           EXIT.
       
       VAL-GL1-GLS-OBS1 SECTION.
       INI-VAL-GL1-GLS-OBS1.
           IF GL1-GLS-OBS1 IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-OBS1 IN GL1-FLD.
      *<<<<                                                                 
           IF WSS-IND-TBLA IN WSS-VARI = 'S'                                    
              IF TAB-COD-DAT2 IN TAB-GLS-DAT2(3) = 'S' AND                      
                 GL1-GLS-OBS1 IN GL1-FLD NOT > SPACES                           
                  PERFORM ERR-GLS                                               
                  GO TO FIN-VAL-GL1-GLS-OBS1.                                   
      *>>>>                                                              
       FIN-VAL-GL1-GLS-OBS1.
           EXIT.
       
       VAL-GL1-GLS-OBS2 SECTION.
       INI-VAL-GL1-GLS-OBS2.
           IF GL1-GLS-OBS2 IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-OBS2 IN GL1-FLD.
       FIN-VAL-GL1-GLS-OBS2.
           EXIT.
       
       VAL-GL1-GLS-OBS3 SECTION.
       INI-VAL-GL1-GLS-OBS3.
           IF GL1-GLS-OBS3 IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-OBS3 IN GL1-FLD.
       FIN-VAL-GL1-GLS-OBS3.
           EXIT.
       
       VAL-GL1-GLS-OBS4 SECTION.
       INI-VAL-GL1-GLS-OBS4.
           IF GL1-GLS-OBS4 IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-OBS4 IN GL1-FLD.
       FIN-VAL-GL1-GLS-OBS4.
           EXIT.
       
       VAL-GL1-GLS-OBS5 SECTION.
       INI-VAL-GL1-GLS-OBS5.
           IF GL1-GLS-OBS5 IN GL1-FLD NOT > SPACES
              MOVE SPACES TO GL1-GLS-OBS5 IN GL1-FLD.
       FIN-VAL-GL1-GLS-OBS5.
           EXIT.
       
       VAL-CON-FLD-GL1 SECTION.
       INI-VAL-CON-FLD-GL1.
       FIN-VAL-CON-FLD-GL1.
           EXIT.
       
       VAL-CON-GL1 SECTION.
       INI-VAL-CON-GL1.
       FIN-VAL-CON-GL1.
           EXIT.
       
       VAL-NUM-KEY-GL1 SECTION.
       INI-VAL-NUM-KEY-GL1.
           PERFORM VAL-NUM-IKY-GL1.
           PERFORM VAL-NUM-MKY-GL1.
           PERFORM VAL-NUM-AKY-GL1.
       FIN-VAL-NUM-KEY-GL1.
           EXIT.
       
       VAL-NUM-IKY-GL1 SECTION.
       INI-VAL-NUM-IKY-GL1.
       VAL-NUM-GL1-IIC-GTIA.
           MOVE GL1-IIC-GTIA-ALF IN GL1-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GL1-IIC-GTIA IN GL1-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GL1-IIC-GTIA-LEN IN GL1-FLD
                GO TO FIN-VAL-NUM-IKY-GL1.
       VAL-NUM-GL1-COD-PACR.
           MOVE GL1-COD-PACR-ALF IN GL1-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GL1-COD-PACR IN GL1-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GL1-COD-PACR-LEN IN GL1-FLD
                GO TO FIN-VAL-NUM-IKY-GL1.
       FIN-VAL-NUM-IKY-GL1.
           EXIT.
       
       VAL-NUM-MKY-GL1 SECTION.
       INI-VAL-NUM-MKY-GL1.
       FIN-VAL-NUM-MKY-GL1.
           EXIT.
       
       VAL-NUM-AKY-GL1 SECTION.
       INI-VAL-NUM-AKY-GL1.
       FIN-VAL-NUM-AKY-GL1.
           EXIT.
       
       VAL-NUM-FLD-GL1 SECTION.
       INI-VAL-NUM-FLD-GL1.
       VAL-NUM-GL1-IIC-FNZA.
           MOVE GL1-IIC-FNZA-ALF IN GL1-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GL1-IIC-FNZA IN GL1-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GL1-IIC-FNZA-LEN IN GL1-FLD
                GO TO FIN-VAL-NUM-FLD-GL1.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GL1-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN GL1-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN GL1-FLD
                GO TO FIN-VAL-NUM-FLD-GL1.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-FLD-GL1.
           EXIT.
       
       EDT-KEY-GL1 SECTION.
       INI-EDT-KEY-GL1.
           PERFORM EDT-IKY-GL1.
           PERFORM EDT-MKY-GL1.
           PERFORM EDT-AKY-GL1.
       FIN-EDT-KEY-GL1.
           EXIT.
       
       EDT-IKY-GL1 SECTION.
       INI-EDT-IKY-GL1.
           IF GL1-IIC-GTIA-LEN IN GL1-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GL1-IIC-GTIA-LEN IN GL1-FLD
                GO TO FIN-EDT-IKY-GL1.
           MOVE GL1-IIC-GTIA IN GL1-FLD TO GL1-IIC-GTIA-EDT IN GL1-EDT.
           MOVE GL1-IIC-GTIA-EDT IN GL1-EDT TO 
                GL1-IIC-GTIA-ALF IN GL1-FLD.
           IF GL1-COD-PACR-LEN IN GL1-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GL1-COD-PACR-LEN IN GL1-FLD
                GO TO FIN-EDT-IKY-GL1.
           MOVE GL1-COD-PACR IN GL1-FLD TO GL1-COD-PACR-EDT IN GL1-EDT.
           MOVE GL1-COD-PACR-EDT IN GL1-EDT TO 
                GL1-COD-PACR-ALF IN GL1-FLD.
       FIN-EDT-IKY-GL1.
           EXIT.
       
       EDT-MKY-GL1 SECTION.
       INI-EDT-MKY-GL1.
       FIN-EDT-MKY-GL1.
           EXIT.
       
       EDT-AKY-GL1 SECTION.
       INI-EDT-AKY-GL1.
       FIN-EDT-AKY-GL1.
           EXIT.
       
       EDT-FLD-GL1 SECTION.
       INI-EDT-FLD-GL1.
           IF GL1-IIC-FNZA-LEN IN GL1-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GL1-IIC-FNZA-LEN IN GL1-FLD
                GO TO FIN-EDT-FLD-GL1.
           MOVE GL1-IIC-FNZA IN GL1-FLD TO GL1-IIC-FNZA-EDT IN GL1-EDT.
           MOVE GL1-IIC-FNZA-EDT IN GL1-EDT TO 
                GL1-IIC-FNZA-ALF IN GL1-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN GL1-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN GL1-FLD
                GO TO FIN-EDT-FLD-GL1.
           MOVE DBC-NUM-ICLI IN GL1-FLD TO
                DBC-NUM-ICLI-EDT IN GL1-EDT.
           MOVE DBC-NUM-ICLI-EDT IN GL1-EDT TO
                DBC-NUM-ICLI-ALF IN GL1-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-FLD-GL1.
           EXIT.
      *<<<<                                                        
       LEE-TBL-CMPO SECTION.                                                    
       INI-LEE-TBL-CMPO.                                                        
           MOVE 'S'                     TO WSS-IND-TBLA IN WSS-VARI.            
           MOVE 'BGL'                    TO TAB-COD-SIST FIO-SIST.              
           MOVE WSS-COD-TTAB IN WSS-VARI TO TAB-COD-TTAB IN TAB.                
           MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB.                
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM GNS-FIO-TAB.                                                 
           IF NOT ( FIO-STAT-OKS AND                                            
               TAB-IND-VIGE IN TAB = 'S')                                       
               MOVE 'N' TO WSS-IND-TBLA IN WSS-VARI                             
               GO TO FIN-LEE-TBL-CMPO.                                          
       FIN-LEE-TBL-CMPO.                                                        
           EXIT.                                                                
                                                                                
       BUS-CLI SECTION.                                                         
       INI-BUS-CLI.                                                             
           MOVE 'S' TO WSS-IND-ECLI IN WSS-VARI.                                
           MOVE DBC-NUM-ICLI IN GL1-FLD TO DBC-NUM-ICLI IN DBC.                 
           MOVE DBC-IND-ICLI IN GL1-FLD TO DBC-IND-ICLI IN DBC.                 
           MOVE DBC-GLS-ICLI IN GL1-FLD TO DBC-GLS-ICLI IN DBC.                 
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.                                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM GET-CLI.                                                     
           IF NOT FIO-STAT-OKS                                                  
               MOVE 'N' TO WSS-IND-ECLI IN WSS-VARI                             
               MOVE 'TAB' TO MSG-COD-SIST                                       
               MOVE 'CLI    NEX' TO MSG-COD-MENS                                
               PERFORM GET-MSG                                                  
               MOVE MSG-GLS-DESC  TO FRM-MEN1                                   
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                                   
               GO TO FIN-BUS-CLI.                                               
           MOVE DBC-CIC-ICLI IN DBC TO WSS-CIC-ICLI IN WSS-VARI.                
       FIN-BUS-CLI.                                                             
           EXIT.                                                                
                                                                                
       LEE-GDD SECTION.                                                         
       INI-LEE-GDD.                                                             
           MOVE 'S' TO WSS-IND-EGDD IN WSS-VARI.                                
           MOVE DBC-CIC-ICLI IN DBC     TO GDD-CIC-DCLI IN GDD.                 
           MOVE GL1-CAI-GTIA IN GL1-FLD TO GDD-CAI-GTIA IN GDD.                 
           MOVE GL1-IIC-GTIA IN GL1-FLD TO GDD-IIC-GTIA IN GDD.                 
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM BGL-FIO-GDD.                                                 
           IF NOT FIO-STAT-OKS                                                  
               MOVE 'N' TO WSS-IND-EGDD IN WSS-VARI.                            
                                                                                
           MOVE GL1-CAI-GTIA IN GL1-FLD TO GDG-CAI-GTIA IN GDG.                 
           MOVE GL1-IIC-GTIA IN GL1-FLD TO GDG-IIC-GTIA IN GDG.                 
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM BGL-FIO-GDG.                                                 
                                                                                
       FIN-LEE-GDD.                                                             
           EXIT.                                                                
      *>>>>                                                                    
