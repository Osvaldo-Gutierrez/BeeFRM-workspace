      *
      * BGLBQGVT
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 05:00 PM
      *
      *-----------------------------------------------------------------
      *  AUTOR      : AFRI
      *  FECHA      : NOV-2016
      *  ETIQUETA   : *AFRI-INI / NOV 2016 REDONDEAR VALOR TASACION
      *  OBJETIVO   : REDONDEAR VALOR TASACION
      *-----------------------------------------------------------------
      * MANTENCION
      * OBJETIVO   : MODIFICAR VALIDACION PARA INCLUIR LTSN Y VCTS = 1
      *              TASACIONES PARCIALES Y COMPLETAS
      * RESPONSABLE: MVG
      * ETIQUETA   : *MVG-INI 09-ENE-2018 MODIFICAR VALIDACION LTSN = 1
      *-----------------------------------------------------------------
       SET-TAG-BGLBQGVT SECTION.
       INI-SET-TAG-BGLBQGVT.
           MOVE
           '<IDNMOD NOM=$BGLBQGVT$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 05:00 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBQGVT.
           EXIT.
           
       PUT-ALL-GVT SECTION.
       INI-PUT-ALL-GVT.
           PERFORM PUT-GVT-GVT.
           PERFORM PUT-GDG-GVT.
      *<<<< FIN_PUT_ALL_GVT
           PERFORM OBT-COD-MNAC.

      *<<<< NOT (PGM_PER OR PGM_CLB OR PGM_MEX)
           PERFORM OBT-VAL-CON.
      *>>>>
      *>>>>
       FIN-PUT-ALL-GVT.
           EXIT.
       
       PUT-GVT-GVT SECTION.
       INI-PUT-GVT-GVT.
           IF PGM-STAT-GVT-NUL
               GO TO FIN-PUT-GVT-GVT.
           IF NOT PGM-STAT-GVT-OKS
               PERFORM CLR-GVT-GVT
               GO TO FIN-PUT-GVT-GVT.
           MOVE GVT-CAI-GTIA IN GVT TO GVT-CAI-GTIA IN GVT-FLD.
           MOVE GVT-IIC-GTIA IN GVT TO GVT-IIC-GTIA IN GVT-FLD.
           MOVE GVT-COD-TASN IN GVT TO GVT-COD-TASN IN GVT-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GVT-NUM-DTSN IN GVT TO GVT-NUM-DTSN IN GVT-FLD.
           MOVE GVT-NUM-MTSN IN GVT TO GVT-NUM-MTSN IN GVT-FLD.
           MOVE GVT-NUM-STSN IN GVT TO GVT-NUM-STSN IN GVT-FLD.
           MOVE GVT-NUM-ATSN IN GVT TO GVT-NUM-ATSN IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GVT-COD-SDAG IN GVT TO GVT-COD-SDAG IN GVT-FLD.
           MOVE GVT-SGV-VCTS IN GVT TO GVT-SGV-VCTS IN GVT-FLD.
           MOVE GVT-SGV-LTSN IN GVT TO GVT-SGV-LTSN IN GVT-FLD.
           MOVE GVT-SGV-PPCT IN GVT TO GVT-SGV-PPCT IN GVT-FLD.
           MOVE GVT-SGV-VPND IN GVT TO GVT-SGV-VPND IN GVT-FLD.
           MOVE GVT-SGV-PAJU IN GVT TO GVT-SGV-PAJU IN GVT-FLD.
           MOVE GVT-SGV-VGAS IN GVT TO GVT-SGV-VGAS IN GVT-FLD.
           MOVE GVT-SGV-VSIN IN GVT TO GVT-SGV-VSIN IN GVT-FLD.
           MOVE GVT-MSC-STAT IN GVT TO GVT-MSC-STAT IN GVT-FLD.
           MOVE GVT-COD-EITS IN GVT TO GVT-COD-EITS IN GVT-FLD.
           MOVE GVT-COD-ISVS IN GVT TO GVT-COD-ISVS IN GVT-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GVT-NUM-DRVL IN GVT TO GVT-NUM-DRVL IN GVT-FLD.
           MOVE GVT-NUM-MRVL IN GVT TO GVT-NUM-MRVL IN GVT-FLD.
           MOVE GVT-NUM-SRVL IN GVT TO GVT-NUM-SRVL IN GVT-FLD.
           MOVE GVT-NUM-ARVL IN GVT TO GVT-NUM-ARVL IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GVT-NUM-DING IN GVT TO GVT-NUM-DING IN GVT-FLD.
           MOVE GVT-NUM-MING IN GVT TO GVT-NUM-MING IN GVT-FLD.
           MOVE GVT-NUM-SING IN GVT TO GVT-NUM-SING IN GVT-FLD.
           MOVE GVT-NUM-AING IN GVT TO GVT-NUM-AING IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GVT-SGV-FISC IN GVT TO GVT-SGV-FISC IN GVT-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GVT-NUM-DURV IN GVT TO GVT-NUM-DURV IN GVT-FLD.
           MOVE GVT-NUM-MURV IN GVT TO GVT-NUM-MURV IN GVT-FLD.
           MOVE GVT-NUM-SURV IN GVT TO GVT-NUM-SURV IN GVT-FLD.
           MOVE GVT-NUM-AURV IN GVT TO GVT-NUM-AURV IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GVT-SGV-VTTL IN GVT TO GVT-SGV-VTTL IN GVT-FLD.
           MOVE GVT-COD-ATRN IN GVT TO GVT-COD-ATRN IN GVT-FLD.
      *<<<< FIN_PUT_GVT_GVT
      *MHM-INI 29-OCT-2003
           MOVE GVT-CIC-UING IN GVT TO CMA-CIC-UING IN CMA-VARI.
      *MHM-FIN 29-OCT-2003
      *<<<< FMT_CHI
           IF GVT-COD-ISVS IN GVT-FLD > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
      *<<<< GEN_BCI
              MOVE 'TAS'               TO TAB-COD-TTAB IN TAB
      *>>>>
              MOVE GVT-COD-ISVS IN GVT TO TAB-COD-CTAB IN TAB
      * EVA-INI  01/09                                                  
      *       PERFORM VAL-COD                                           
              PERFORM BUS-TAB                                           
      * EVA-FIN  01/09                                                  
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ISVS IN GVT-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-ISVS IN GVT-FLD.
      *>>>>
      *CGL-INI  19-AUG-2003 18:07:25    
      *     IF GVT-COD-CRIT IN GVT-FLD > SPACES
      *        MOVE 'BGL'                   TO TAB-COD-SIST
      *        MOVE 'CRI'                   TO TAB-COD-TTAB IN TAB
      *        MOVE GVT-COD-CRIT IN GVT     TO TAB-COD-CTAB IN TAB
      *        PERFORM VAL-COD
      *        MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-CRIT IN GVT-FLD
      *     ELSE
      *        MOVE SPACES TO FRM-GLS-CRIT IN GVT-FLD.
      *CGL-FIN  19-AUG-2003 18:07:44 
      * CGL-INI  19-AUG-2003 18:09:33 
      *     IF GVT-COD-OAVA IN GVT-FLD > SPACES
      *        MOVE 'BGL'               TO TAB-COD-SIST
      *        MOVE 'ORA'               TO TAB-COD-TTAB IN TAB
      *        MOVE GVT-COD-OAVA IN GVT TO TAB-COD-CTAB IN TAB
      *        PERFORM VAL-COD
      *        MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-OAVA IN GVT-FLD
      *     ELSE
      *        MOVE SPACES TO FRM-GLS-OAVA IN GVT-FLD.
      *CGL-FIN  19-AUG-2003 18:09:51 
      
           IF GVT-MSC-STAT IN GVT-FLD = 'I'
              MOVE 'INGRESADO'       TO FRM-GLS-STAT IN GVT-FLD
           ELSE
           IF GVT-MSC-STAT IN GVT-FLD = 'M'
              MOVE 'MODIFICADO'      TO FRM-GLS-STAT IN GVT-FLD
           ELSE
           IF GVT-MSC-STAT IN GVT-FLD = 'A'
              MOVE 'ACTIVADO'        TO FRM-GLS-STAT IN GVT-FLD
           ELSE
              MOVE 'OTRO'            TO FRM-GLS-STAT IN GVT-FLD.
      *<<<< FMT_CHI
           IF GVT-COD-EITS IN GVT-FLD > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'TAS'               TO TAB-COD-TTAB IN TAB
              MOVE GVT-COD-EITS IN GVT TO TAB-COD-CTAB IN TAB
      * EVA-INI  01/09                                                  
      *       PERFORM VAL-COD                                           
              PERFORM BUS-TAB                                           
      * EVA-FIN  01/09                                                  
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-EITS IN GVT-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-EITS IN GVT-FLD.
      *>>>>
           MOVE GVT-SGV-LTSN IN GVT-FLD TO
                WSS-SGV-LTSN IN CMA-VARI.

           IF ( SCR-CCPP = 'ACC' AND
                SCR-STPP NOT = SCR-STAT-CON OR
                SCR-CMND = 'ATA' ) AND

               GVT-SGV-LTSN IN GVT-FLD > ZEROES AND
               GVT-SGV-VCTS IN GVT-FLD > ZEROES

                COMPUTE WSS-LIQ-CML IN CMA-VARI ROUNDED =
                               GVT-SGV-LTSN IN GVT-FLD /
                               GVT-SGV-VCTS IN GVT-FLD

           ELSE
               MOVE ZEROES TO WSS-LIQ-CML IN CMA-VARI.

       OBT-VEN-TSN.
           PERFORM EXA-VEN-TSN.
      *MHM-INI 16-SEP-2003
           IF SCR-CMND NOT = 'CON'
               GO TO CNT-PUT-GVT-GVT.
      ** EVA-INI  10/07                                                 
           PERFORM LEE-GDG.                                             
           IF WSS-IND-GTIA IN WSS-VARI = 'N'                            
              GO TO FIN-PUT-GVT-GVT.                                    
                                                                        
           PERFORM BUS-TNOV.                                            
                                                                        
      *PVC-INI 20-JUL-2012 - MENSAJE DE TASACION VENCIDA
      *    IF WSS-IND-GTAC IN WSS-VARI = 'N' OR                         
      *       WSS-IND-ARET IN WSS-VARI = 'N'                            

           IF (WSS-IND-GTAC IN WSS-VARI = 'N' OR
               WSS-IND-ARET IN WSS-VARI = 'N') AND
               WSS-IND-TASC IN WSS-VARI NOT = 'S'
      *PVC-FIN 20-JUL-2012

      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      *        MOVE 'NO APLICA RETASAR' TO FRM-GLS-EXCE IN GVT-FLD      
               MOVE 'NORET' TO WSS-COD-CMSG IN WSS-VARI
               PERFORM PRO-LEE-MSG
               IF WSS-GLS-CMSG IN WSS-VARI NOT = SPACES
                MOVE WSS-GLS-CMSG IN WSS-VARI TO FRM-GLS-EXCE IN GVT-FLD
                GO TO CNT-PUT-GVT-GVT
               ELSE
                NEXT SENTENCE
           ELSE
               NEXT SENTENCE.
      *        GO TO CNT-PUT-GVT-GVT.                                   
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012

           IF WSS-IND-GDIA IN WSS-VARI = 'S'
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      *        MOVE 'AL DIA' TO FRM-GLS-EXCE IN GVT-FLD                 
               MOVE 'ALDIA' TO WSS-COD-CMSG IN WSS-VARI
               PERFORM PRO-LEE-MSG
               IF WSS-GLS-CMSG IN WSS-VARI NOT = SPACES
                MOVE WSS-GLS-CMSG IN WSS-VARI TO FRM-GLS-EXCE IN GVT-FLD
                GO TO CNT-PUT-GVT-GVT
               ELSE
                NEXT SENTENCE
           ELSE
               NEXT SENTENCE.
      *        GO TO CNT-PUT-GVT-GVT.                                   
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012

           IF WSS-IND-ECRT IN WSS-VARI = 'S'
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      *        MOVE 'VENCIDA CON EXCEPCION COMERCIAL'                   
      *                                     TO FRM-GLS-EXCE IN GVT-FLD  
               MOVE 'VENEXCCOM' TO WSS-COD-CMSG IN WSS-VARI
               PERFORM PRO-LEE-MSG
               IF WSS-GLS-CMSG IN WSS-VARI NOT = SPACES
                MOVE WSS-GLS-CMSG IN WSS-VARI TO FRM-GLS-EXCE IN GVT-FLD
                GO TO CNT-PUT-GVT-GVT
               ELSE
                NEXT SENTENCE
           ELSE
               NEXT SENTENCE.
      *        GO TO CNT-PUT-GVT-GVT.                                   
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      ** EVA-INI  10/07                                                 
      *    PERFORM EXC-NOR-TAS.                                         
      *    IF WSS-IND-ENT1 = 'S'                                        
      *       MOVE 'VENCIDA EXCP.NORMATIVA, NO PRESENTA DEUDAS VIGENTES'
      *                                     TO FRM-GLS-EXCE IN GVT-FLD  
      *    ELSE                                                         
      *    IF WSS-IND-ENT2 = 'S'                                        
      *       MOVE 'VENCIDA EXCP.NORMATIVA, UNICA DEUDA HIPOTECARIA'    
      *                                     TO FRM-GLS-EXCE IN GVT-FLD  
      *    ELSE                                                         
      *    IF WSS-IND-ENT3 = 'S'                                        
      *       MOVE 'VENCIDA EXCP.NORMATIVA, TASACION VIGENTE EN CURSE'  
      *                                     TO FRM-GLS-EXCE IN GVT-FLD  
      *    ELSE                                                         
      *       MOVE 'TASACION VENCIDA, DEBE RETASAR'                     
      *                                     TO FRM-GLS-EXCE IN GVT-FLD. 
      ** EVA-FIN  10/07                                                 
                                                                        
      ** EVA-INI  11/08                                                 
           IF WSS-IND-RTAS IN WSS-VARI = 'S'                            
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      *       MOVE 'TASACION VIGENTE EN CURSE' TO
      *             FRM-GLS-EXCE IN GVT-FLD
               MOVE 'VIGCUR' TO WSS-COD-CMSG IN WSS-VARI
               PERFORM PRO-LEE-MSG
               IF WSS-GLS-CMSG IN WSS-VARI NOT = SPACES
                MOVE WSS-GLS-CMSG IN WSS-VARI TO FRM-GLS-EXCE IN GVT-FLD
                GO TO CNT-PUT-GVT-GVT
               ELSE
                NEXT SENTENCE
           ELSE
               NEXT SENTENCE.
      *        GO TO CNT-PUT-GVT-GVT.                                   
                                                                        
           IF GVT-IND-IEXC IN GVT = 'S'
      * TASACION VENCIDA                                                
               MOVE 'VENNORET' TO WSS-COD-CMSG IN WSS-VARI
               PERFORM PRO-LEE-MSG
               IF WSS-GLS-CMSG IN WSS-VARI NOT = SPACES
                MOVE WSS-GLS-CMSG IN WSS-VARI TO FRM-GLS-EXCE IN GVT-FLD
                GO TO CNT-PUT-GVT-GVT
               ELSE
                NEXT SENTENCE
           ELSE
               NEXT SENTENCE.
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
                                                                        
           IF WSS-IND-TNOV IN WSS-VARI = 'S'                            
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      *       MOVE 'TASACION VENCIDA, DEBE RETASAR' TO                  
      *             FRM-GLS-EXCE IN GVT-FLD.                            
               MOVE 'VENRET' TO WSS-COD-CMSG IN WSS-VARI
               PERFORM PRO-LEE-MSG
               IF WSS-GLS-CMSG IN WSS-VARI NOT = SPACES
                MOVE WSS-GLS-CMSG IN WSS-VARI TO FRM-GLS-EXCE IN GVT-FLD
                GO TO CNT-PUT-GVT-GVT
               ELSE
                NEXT SENTENCE
           ELSE
               NEXT SENTENCE.                                  
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
                                                                        
      ** EVA-FIN  11/08                                                 

      *PVC-INI 20-JUL-2012 - Mensaje de Tasacion Vencida
           IF WSS-IND-TASC IN WSS-VARI = 'S'
               MOVE 'TADIA' TO WSS-COD-CMSG IN WSS-VARI
               PERFORM PRO-LEE-MSG
               IF WSS-GLS-CMSG IN WSS-VARI NOT = SPACES
                MOVE WSS-GLS-CMSG IN WSS-VARI TO FRM-GLS-EXCE IN GVT-FLD
                GO TO CNT-PUT-GVT-GVT
               ELSE
                NEXT SENTENCE
           ELSE
               NEXT SENTENCE.
      *PVC-FIN 20-JUL-2012

       CNT-PUT-GVT-GVT.
      *MHM-FIN 16-SEP-2003
      ** EVA-FIN  10/07                                                 

           MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP.
           MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP.
           MOVE ZEROES                  TO GTP-COD-ITSN IN GTP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GTP.
           IF FIO-STAT-OKS AND
              GTP-CAI-GTIA IN GTP = GVT-CAI-GTIA IN GVT-FLD AND
              GTP-IIC-GTIA IN GTP = GVT-IIC-GTIA IN GVT-FLD AND
              GTP-NUM-ITSN IN GTP = GVT-COD-TASN IN GVT-FLD
               MOVE 'S' TO FRM-IND-GTP IN GVT-FLD
           ELSE
               MOVE 'N' TO FRM-IND-GTP IN GVT-FLD.

           IF FIO-STAT-OKS 
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM BGL-FIO-GTP.

      *PVC-INI 19-NOV-2012 - DESVALORIZACION
           PERFORM CONT-AVALUOS.
           MOVE WSS-NUM-FISC IN WSS-VARI TO FRM-NUM-FISC IN GVT-FLD.
      *PVC-FIN 19-NOV-2012
      *>>>>
       FIN-PUT-GVT-GVT.
           EXIT.
       
       PUT-GDG-GVT SECTION.
       INI-PUT-GDG-GVT.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GVT.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GVT
               GO TO FIN-PUT-GDG-GVT.
      * IDG-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GVT-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GVT-FLD.
      * IDG-FIN --> BMCHIBCI001210.SRCAIU 
      * OFI-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-OFIC IN GDG TO GDG-COD-OFIC IN GVT-FLD.
      * OFI-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-VCAM IN GDG TO GDG-COD-VCAM IN GVT-FLD.
           MOVE GDG-GLS-DGTA IN GDG TO GDG-GLS-DGTA IN GVT-FLD.
           MOVE GDG-GLS-DGT1 IN GDG TO GDG-GLS-DGT1 IN GVT-FLD.
           MOVE GDG-COD-VCON IN GDG TO GDG-COD-VCON IN GVT-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFIC IN GVT-FLD > SPACES
               MOVE GDG-COD-OFIC IN GVT-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-VCAM IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-VCAM IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCAM IN GVT-FLD.
      *<<<< FIN_PUT_GDG_GVT
           IF GDG-COD-VCON IN GVT-FLD > SPACES
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
              MOVE GDG-COD-VCON IN GVT-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCON IN GVT-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-VCON IN GVT-FLD.
      *>>>>
       FIN-PUT-GDG-GVT.
           EXIT.
       
       KEY-ALL-GVT SECTION.
       INI-KEY-ALL-GVT.
           PERFORM KEY-GVT-GVT.
           PERFORM KEY-GDG-GVT.
       FIN-KEY-ALL-GVT.
           EXIT.
       
       KEY-GVT-GVT SECTION.
       INI-KEY-GVT-GVT.
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GVT-CAI-GTIA IN GVT.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GVT-IIC-GTIA IN GVT.
           MOVE GVT-COD-TASN IN GVT-FLD TO GVT-COD-TASN IN GVT.
           MOVE GVT-COD-SDAG IN GVT-FLD TO GVT-COD-SDAG IN GVT.
       FIN-KEY-GVT-GVT.
           EXIT.
       
       KEY-GDG-GVT SECTION.
       INI-KEY-GDG-GVT.
       FIN-KEY-GDG-GVT.
           EXIT.
       
       SCR-CLRA-GVT SECTION.
       INI-SCR-CLRA-GVT.
           PERFORM CLR-KEY-GVT.
           PERFORM CLR-FLD-GVT.
       FIN-SCR-CLRA-GVT.
           EXIT.
       
       CLR-KEY-GVT SECTION.
       INI-CLR-KEY-GVT.
           MOVE SPACES TO GVT-CAI-GTIA IN GVT-FLD.
           MOVE ZEROES TO GVT-IIC-GTIA IN GVT-FLD.
           MOVE ZEROES TO GVT-COD-TASN IN GVT-FLD.
           MOVE SPACES TO GVT-COD-SDAG IN GVT-FLD.
       FIN-CLR-KEY-GVT.
           EXIT.
       
       CLR-FLD-GVT SECTION.
       INI-CLR-FLD-GVT.
           MOVE SPACES TO FRM-IND-GTP IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TREA IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-VCON IN GVT-FLD.
           MOVE ZEROES TO FRM-VAL-ULT-CON IN GVT-FLD.
           MOVE ZEROES TO FRM-NUM-GTP IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-EITS IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-ISVS IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-EXCE IN GVT-FLD.
           MOVE ZEROES TO FRM-NUM-FISC IN GVT-FLD.
           PERFORM CLR-GVT-GVT.
           PERFORM CLR-GDG-GVT.
       FIN-CLR-FLD-GVT.
           EXIT.
       
       CLR-GVT-GVT SECTION.
       INI-CLR-GVT-GVT.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FTSN IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-SGV-VCTS IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-LTSN IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-PPCT IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-VPND IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-PAJU IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-VGAS IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-VSIN IN GVT-FLD.
           MOVE SPACES TO GVT-MSC-STAT IN GVT-FLD.
           MOVE SPACES TO GVT-COD-EITS IN GVT-FLD.
           MOVE SPACES TO GVT-COD-ISVS IN GVT-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FRVL IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FING IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-SGV-FISC IN GVT-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FURV IN GVT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-SGV-VTTL IN GVT-FLD.
           MOVE SPACES TO GVT-COD-ATRN IN GVT-FLD.
       FIN-CLR-GVT-GVT.
           EXIT.
       
       CLR-GDG-GVT SECTION.
       INI-CLR-GDG-GVT.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GVT-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GVT-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GVT-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GVT-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GVT-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GVT-FLD.
           MOVE SPACES TO GDG-COD-VCON IN GVT-FLD.
       FIN-CLR-GDG-GVT.
           EXIT.
       
       FST-KEY-GVT SECTION.
       INI-FST-KEY-GVT.
           MOVE -1 TO GVT-CAI-GTIA-LEN IN GVT-FLD.
       FIN-FST-KEY-GVT.
           EXIT.
       
       FST-FLD-GVT SECTION.
       INI-FST-FLD-GVT.
      *<<<< INI_FST_FLD_GVT
      *<<<< GEN_BCI
           MOVE -1 TO FRM-IND-GTP-LEN IN GVT-FLD.

           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

      *MHM-INI 14-OCT-2003
           IF SCR-CMND = 'MTA'
               PERFORM PRO-FLD-GVT
               MOVE FRM-CPIM-UBY TO GVT-COD-EITS-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-COD-ISVS-ATR IN GVT-FLD
               MOVE  0 TO FRM-IND-GTP-LEN  IN GVT-FLD
               MOVE -1 TO GVT-COD-EITS-LEN IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

      *MHM-FIN 14-OCT-2003

           IF SCR-CCPP = 'MOD'
               MOVE  0 TO FRM-IND-GTP-LEN  IN GVT-FLD
               MOVE -1 TO GVT-FEC-FTSN-LEN IN GVT-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD
      *MHM-INI 14-OCT-2003
               MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD
      *MHM-FIN 14-OCT-2003
               GO TO FIN-FST-FLD-GVT.

           MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.

      *MHM-INI 11-SEP-2003
           IF SCR-CMND = 'RTF'
               PERFORM PRO-FLD-GVT
               MOVE FRM-CPIM-UBY TO GVT-FEC-FTSN-ATR IN GVT-FLD
               MOVE  0 TO FRM-IND-GTP-LEN  IN GVT-FLD
               MOVE -1 TO GVT-FEC-FTSN-LEN IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

      *MHM-FIN 11-SEP-2003
           IF SCR-CMND = 'RVL'
               MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD
      *MHM-INI 14-OCT-2003
      *         MOVE -1 TO GVT-FEC-FRVL-LEN IN GVT-FLD
                MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD
                MOVE -1 TO GVT-SGV-VCTS-LEN IN GVT-FLD
      *MHM-FIN 14-OCT-2003
           ELSE
               MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD
               MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD
               MOVE -1 TO GVT-FEC-FTSN-LEN IN GVT-FLD.
            
           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.

           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDP-CAI-GTIA IN GDP.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDP-IIC-GTIA IN GDP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDP.
           IF FIO-STAT-OKS
               MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.

      *MHM-INI 15-OCT-2003
           GO TO FIN-FST-FLD-GVT.
      *MHM-FIN 15-OCT-2003
      *>>>>
      *>>>> INI_FST_FLD_GVT
           MOVE -1 TO FRM-IND-GTP-LEN IN GVT-FLD.
       FIN-FST-FLD-GVT.
           EXIT.
       
       PRO-KEY-GVT SECTION.
       INI-PRO-KEY-GVT.
           PERFORM PRO-IKY-GVT.
           PERFORM PRO-AKY-GVT.
           PERFORM PRO-MKY-GVT.
       FIN-PRO-KEY-GVT.
           EXIT.
       
       PRO-IKY-GVT SECTION.
       INI-PRO-IKY-GVT.
           MOVE FRM-CPIM-AEY TO GVT-CAI-GTIA-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-IIC-GTIA-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-TASN-ATR IN GVT-FLD.
       FIN-PRO-IKY-GVT.
           EXIT.
       
       PRO-MKY-GVT SECTION.
       INI-PRO-MKY-GVT.
       FIN-PRO-MKY-GVT.
           EXIT.
       
       PRO-AKY-GVT SECTION.
       INI-PRO-AKY-GVT.
           MOVE FRM-CPIM-AEY TO GVT-COD-SDAG-ATR IN GVT-FLD.
       FIN-PRO-AKY-GVT.
           EXIT.
       
       UNP-KEY-GVT SECTION.
       INI-UNP-KEY-GVT.
           PERFORM UNP-IKY-GVT.
           PERFORM UNP-AKY-GVT.
           PERFORM UNP-MKY-GVT.
       FIN-UNP-KEY-GVT.
           EXIT.
       
       UNP-IKY-GVT SECTION.
       INI-UNP-IKY-GVT.
           MOVE FRM-CPIM-UBY TO GVT-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GVT-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GVT-COD-TASN-ATR.
      *<<<< FIN_UNP_IKY_GVT 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = 'ING'
           MOVE FRM-CPIM-AEY TO GVT-COD-TASN-ATR IN GVT-FLD
           MOVE FRM-CPIM-AEY TO GVT-COD-TASN-STP.
      *RRM-FIN 16-APR-2002
      *>>>>      
       FIN-UNP-IKY-GVT.
           EXIT.
       
       UNP-MKY-GVT SECTION.
       INI-UNP-MKY-GVT.
       FIN-UNP-MKY-GVT.
           EXIT.
       
       UNP-AKY-GVT SECTION.
       INI-UNP-AKY-GVT.
           MOVE FRM-CPIM-UBY TO GVT-COD-SDAG-ATR.
       FIN-UNP-AKY-GVT.
           EXIT.
       
       UNP-FLD-GVT SECTION.
       INI-UNP-FLD-GVT.
           MOVE FRM-CPIM-UBY TO FRM-IND-GTP-ATR IN GVT-FLD.
           PERFORM UNP-GVT-GVT.
           PERFORM UNP-GDG-GVT.
      *<<<< FIN_UNP_FLD_GVT
           IF SCR-CMND = 'ING' OR                                       
              SCR-CMND = 'INE' OR                                       
              SCR-CMND = 'MOD'                                          
              MOVE FRM-CPIM-UBY TO GVT-COD-SDAG-ATR IN GVT-FLD.         
      *>>>>
       FIN-UNP-FLD-GVT.
           EXIT.
       
       UNP-GVT-GVT SECTION.
       INI-UNP-GVT-GVT.
           MOVE FRM-CPIM-UBY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-PPCT-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-PAJU-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-VSIN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-COD-EITS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-COD-ISVS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-FEC-FRVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-SGV-FISC-ATR IN GVT-FLD.
       FIN-UNP-GVT-GVT.
           EXIT.
       
       UNP-GDG-GVT SECTION.
       INI-UNP-GDG-GVT.
       FIN-UNP-GDG-GVT.
           EXIT.
       
       VAL-KEY-GVT SECTION.
       INI-VAL-KEY-GVT.
           PERFORM VAL-IKY-GVT.
           PERFORM VAL-MKY-GVT.
           PERFORM VAL-AKY-GVT.
       FIN-VAL-KEY-GVT.
           EXIT.
       
       VAL-IKY-GVT SECTION.
       INI-VAL-IKY-GVT.
           PERFORM VAL-GVT-CAI-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-CAI-GTIA-LEN IN GVT-FLD
                GO TO FIN-VAL-IKY-GVT.
           PERFORM VAL-GVT-IIC-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-IIC-GTIA-LEN IN GVT-FLD
                GO TO FIN-VAL-IKY-GVT.
           PERFORM VAL-GVT-COD-TASN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-COD-TASN-LEN IN GVT-FLD
                GO TO FIN-VAL-IKY-GVT.
       FIN-VAL-IKY-GVT.
           EXIT.
       
       VAL-MKY-GVT SECTION.
       INI-VAL-MKY-GVT.
       FIN-VAL-MKY-GVT.
           EXIT.
       
       VAL-AKY-GVT SECTION.
       INI-VAL-AKY-GVT.
           PERFORM VAL-GVT-COD-SDAG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GVT-COD-SDAG-LEN IN GVT-FLD
                GO TO FIN-VAL-AKY-GVT.
       FIN-VAL-AKY-GVT.
           EXIT.
       
       VAL-GVT-CAI-GTIA SECTION.
       INI-VAL-GVT-CAI-GTIA.
      *<<<<
           IF GVT-CAI-GTIA IN GVT-FLD NOT > SPACES                      
              MOVE SPACES TO GVT-CAI-GTIA IN GVT-FLD.                   
      *MHM-INI 03-NOV-2004                                              
           IF ((SCR-CMND = 'ING' OR SCR-CMND = 'INE') AND               
               (GVT-CAI-GTIA IN GVT-FLD NOT > SPACES))                  
                PERFORM ERR-KEY                                         
                PERFORM FST-KEY-GVT.                                    
      *MHM-FIN 03-NOV-2004                                              
      *>>>>
           IF GVT-CAI-GTIA IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-CAI-GTIA IN GVT-FLD.
       FIN-VAL-GVT-CAI-GTIA.
           EXIT.
       
       VAL-GVT-IIC-GTIA SECTION.
       INI-VAL-GVT-IIC-GTIA.
       FIN-VAL-GVT-IIC-GTIA.
           EXIT.
       
       VAL-GVT-COD-TASN SECTION.
       INI-VAL-GVT-COD-TASN.
       FIN-VAL-GVT-COD-TASN.
           EXIT.
       
       VAL-GVT-COD-SDAG SECTION.
       INI-VAL-GVT-COD-SDAG.
           IF GVT-COD-SDAG IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-COD-SDAG IN GVT-FLD.
      *<<<< GVT_COD_SGAG
      *>>>>
       FIN-VAL-GVT-COD-SDAG.
           EXIT.
       
       VAL-CON-KEY-GVT SECTION.
       INI-VAL-CON-KEY-GVT.
      *<<<< INI_VAL_CON_KEY_GVT
           IF FRM-FFLD = FRM-FFLD-PF5
               GO TO FIN-VAL-CON-KEY-GVT.

      *>>>>
           IF     GVT-CAI-GTIA IN GVT-FLD NOT > SPACES 
              AND GVT-IIC-GTIA IN GVT-FLD NOT > ZEROES 
              AND GVT-COD-TASN IN GVT-FLD NOT > ZEROES 
              AND GVT-COD-SDAG IN GVT-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GVT.
       FIN-VAL-CON-KEY-GVT.
           EXIT.
       
       VAL-CON-IKY-GVT SECTION.
       INI-VAL-CON-IKY-GVT.
           IF     GVT-CAI-GTIA IN GVT-FLD NOT > SPACES 
              AND GVT-IIC-GTIA IN GVT-FLD NOT > ZEROES 
              AND GVT-COD-TASN IN GVT-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GVT.
      *<<<< FIN_VAL_CON_IKY_GVT
           IF GVT-COD-TASN IN GVT-FLD < 1
               MOVE 1 TO GVT-COD-TASN IN GVT-FLD
           ELSE
           IF GVT-COD-TASN IN GVT-FLD > 1
      *        Comando Ingreso
               MOVE 'BGL'      TO MSG-COD-SIST
               MOVE 'GVTIKY>1' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-IKY-GVT.

      *>>>>
       FIN-VAL-CON-IKY-GVT.
           EXIT.
       
       VAL-NUM-KEY-GVT SECTION.
       INI-VAL-NUM-KEY-GVT.
           PERFORM VAL-NUM-IKY-GVT.
           PERFORM VAL-NUM-MKY-GVT.
           PERFORM VAL-NUM-AKY-GVT.
       FIN-VAL-NUM-KEY-GVT.
           EXIT.
       
       VAL-NUM-IKY-GVT SECTION.
       INI-VAL-NUM-IKY-GVT.
       VAL-NUM-GVT-IIC-GTIA.
           MOVE GVT-IIC-GTIA-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GVT-IIC-GTIA IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-IIC-GTIA-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-IKY-GVT.
       VAL-NUM-GVT-COD-TASN.
           MOVE GVT-COD-TASN-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GVT-COD-TASN IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-COD-TASN-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-IKY-GVT.
       FIN-VAL-NUM-IKY-GVT.
           EXIT.
       
       VAL-NUM-MKY-GVT SECTION.
       INI-VAL-NUM-MKY-GVT.
       FIN-VAL-NUM-MKY-GVT.
           EXIT.
       
       VAL-NUM-AKY-GVT SECTION.
       INI-VAL-NUM-AKY-GVT.
       FIN-VAL-NUM-AKY-GVT.
           EXIT.
       
       VAL-NUM-FLD-GVT SECTION.
       INI-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VCTS.
           MOVE GVT-SGV-VCTS-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VCTS IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VCTS-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-LTSN.
           MOVE GVT-SGV-LTSN-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-LTSN IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-LTSN-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-PPCT.
           MOVE GVT-SGV-PPCT-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-PPCT IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-PPCT-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VPND.
           MOVE GVT-SGV-VPND-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VPND IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VPND-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-PAJU.
           MOVE GVT-SGV-PAJU-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-PAJU IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-PAJU-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VGAS.
           MOVE GVT-SGV-VGAS-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VGAS IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VGAS-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VSIN.
           MOVE GVT-SGV-VSIN-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VSIN IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VSIN-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-FRM-VAL-ULT-CON.
           MOVE FRM-VAL-ULT-CON-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-ULT-CON IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-ULT-CON-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-FRM-NUM-GTP.
           MOVE FRM-NUM-GTP-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-GTP IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-GTP-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-FISC.
           MOVE GVT-SGV-FISC-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-FISC IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-FISC-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-SGV-VTTL.
           MOVE GVT-SGV-VTTL-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GVT-SGV-VTTL IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GVT-SGV-VTTL-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-FRM-NUM-FISC.
           MOVE FRM-NUM-FISC-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-FISC IN GVT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-FISC-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       FIN-VAL-NUM-FLD-GVT.
           EXIT.
       
       EDT-KEY-GVT SECTION.
       INI-EDT-KEY-GVT.
           PERFORM EDT-IKY-GVT.
           PERFORM EDT-MKY-GVT.
           PERFORM EDT-AKY-GVT.
       FIN-EDT-KEY-GVT.
           EXIT.
       
       EDT-IKY-GVT SECTION.
       INI-EDT-IKY-GVT.
           IF GVT-IIC-GTIA-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-IIC-GTIA-LEN IN GVT-FLD
                GO TO FIN-EDT-IKY-GVT.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GVT-IIC-GTIA-EDT IN GVT-EDT.
           MOVE GVT-IIC-GTIA-EDT IN GVT-EDT TO 
                GVT-IIC-GTIA-ALF IN GVT-FLD.
           IF GVT-COD-TASN-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-COD-TASN-LEN IN GVT-FLD
                GO TO FIN-EDT-IKY-GVT.
           MOVE GVT-COD-TASN IN GVT-FLD TO GVT-COD-TASN-EDT IN GVT-EDT.
           MOVE GVT-COD-TASN-EDT IN GVT-EDT TO 
                GVT-COD-TASN-ALF IN GVT-FLD.
       FIN-EDT-IKY-GVT.
           EXIT.
       
       EDT-MKY-GVT SECTION.
       INI-EDT-MKY-GVT.
       FIN-EDT-MKY-GVT.
           EXIT.
       
       EDT-AKY-GVT SECTION.
       INI-EDT-AKY-GVT.
       FIN-EDT-AKY-GVT.
           EXIT.
       
       EDT-FLD-GVT SECTION.
       INI-EDT-FLD-GVT.
           IF GVT-SGV-VCTS-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VCTS-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-VCTS-EDT IN GVT-EDT.
           MOVE GVT-SGV-VCTS-EDT IN GVT-EDT TO 
                GVT-SGV-VCTS-ALF IN GVT-FLD.
           IF GVT-SGV-LTSN-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-LTSN-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-LTSN IN GVT-FLD TO GVT-SGV-LTSN-EDT IN GVT-EDT.
           MOVE GVT-SGV-LTSN-EDT IN GVT-EDT TO 
                GVT-SGV-LTSN-ALF IN GVT-FLD.
           IF GVT-SGV-PPCT-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-PPCT-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-PPCT IN GVT-FLD TO GVT-SGV-PPCT-EDT IN GVT-EDT.
           MOVE GVT-SGV-PPCT-EDT IN GVT-EDT TO 
                GVT-SGV-PPCT-ALF IN GVT-FLD.
           IF GVT-SGV-VPND-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VPND-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VPND IN GVT-FLD TO GVT-SGV-VPND-EDT IN GVT-EDT.
           MOVE GVT-SGV-VPND-EDT IN GVT-EDT TO 
                GVT-SGV-VPND-ALF IN GVT-FLD.
           IF GVT-SGV-PAJU-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-PAJU-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-PAJU IN GVT-FLD TO GVT-SGV-PAJU-EDT IN GVT-EDT.
           MOVE GVT-SGV-PAJU-EDT IN GVT-EDT TO 
                GVT-SGV-PAJU-ALF IN GVT-FLD.
           IF GVT-SGV-VGAS-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VGAS-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VGAS IN GVT-FLD TO GVT-SGV-VGAS-EDT IN GVT-EDT.
           MOVE GVT-SGV-VGAS-EDT IN GVT-EDT TO 
                GVT-SGV-VGAS-ALF IN GVT-FLD.
           IF GVT-SGV-VSIN-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VSIN-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VSIN IN GVT-FLD TO GVT-SGV-VSIN-EDT IN GVT-EDT.
           MOVE GVT-SGV-VSIN-EDT IN GVT-EDT TO 
                GVT-SGV-VSIN-ALF IN GVT-FLD.
           IF FRM-VAL-ULT-CON-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-ULT-CON-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE FRM-VAL-ULT-CON IN GVT-FLD TO 
                FRM-VAL-ULT-CON-EDT IN GVT-EDT.
           MOVE FRM-VAL-ULT-CON-EDT IN GVT-EDT TO 
                FRM-VAL-ULT-CON-ALF IN GVT-FLD.
           IF FRM-NUM-GTP-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-GTP-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE FRM-NUM-GTP IN GVT-FLD TO FRM-NUM-GTP-EDT IN GVT-EDT.
           MOVE FRM-NUM-GTP-EDT IN GVT-EDT TO 
                FRM-NUM-GTP-ALF IN GVT-FLD.
           IF GVT-SGV-FISC-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-FISC-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-FISC IN GVT-FLD TO GVT-SGV-FISC-EDT IN GVT-EDT.
           MOVE GVT-SGV-FISC-EDT IN GVT-EDT TO 
                GVT-SGV-FISC-ALF IN GVT-FLD.
           IF GVT-SGV-VTTL-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VTTL-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-SGV-VTTL IN GVT-FLD TO GVT-SGV-VTTL-EDT IN GVT-EDT.
           MOVE GVT-SGV-VTTL-EDT IN GVT-EDT TO 
                GVT-SGV-VTTL-ALF IN GVT-FLD.
           IF FRM-NUM-FISC-LEN IN GVT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-FISC-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE FRM-NUM-FISC IN GVT-FLD TO FRM-NUM-FISC-EDT IN GVT-EDT.
           MOVE FRM-NUM-FISC-EDT IN GVT-EDT TO 
                FRM-NUM-FISC-ALF IN GVT-FLD.
       FIN-EDT-FLD-GVT.
           EXIT.
      *<<<<
      ** EVA-INI  10/07                                                 

      *PVC-INI 20-JUL-2012 - Mensaje de Tasacion Vencida
       OBT-COD-UF SECTION.
       INI-OBT-COD-UF.
      * OBTIENE Codigo valor de cambio de UF mediante CIC de la moneda  
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI.
       FIN-OBT-COD-UF.
           EXIT.
      *PVC-FIN 20-JUL-2012
                                                                        
       BUS-TNOV SECTION.                                                
       INI-BUS-TNOV.                                                    
                                                                        
      * EVA-INI  11/08                                                  
           MOVE 'S' TO WSS-IND-GTAC IN WSS-VARI.                        
           MOVE 'S' TO WSS-IND-ARET IN WSS-VARI.                        
           MOVE 'N' TO WSS-IND-GDIA IN WSS-VARI.                        
           MOVE 'N' TO WSS-IND-ECRT IN WSS-VARI.                        
           MOVE 'N' TO WSS-IND-RTAS IN WSS-VARI.                        
           MOVE 'N' TO WSS-IND-TNOV IN WSS-VARI.                        
      *PVC-INI 20-JUL-2012 - MENSAJE DE TASACION VENCIDA
           MOVE SPACES TO WSS-IND-TASC IN WSS-VARI.
      *PVC-INI 20-JUL-2012
                                                                        
           IF (GDG-IND-EST1 IN GDG < '10' OR                            
               GDG-IND-EST1 IN GDG > '19')                              
               MOVE 'N' TO WSS-IND-GTAC IN WSS-VARI                     
               GO TO FIN-BUS-TNOV.                                      
                                                                        
           IF CMA-IND-APLI IN CMA-VARI NOT = 'A'                        
               MOVE 'N' TO WSS-IND-ARET IN WSS-VARI                     
               GO TO FIN-BUS-TNOV.                                      
                                                                        
           PERFORM LEE-TSOL.                                            
           IF WSS-FEC-FGVT IN WSS-VARI > HOY-FHOY                       
              MOVE 'S' TO WSS-IND-GDIA IN WSS-VARI                      
              GO TO FIN-BUS-TNOV.                                       
                                                                        
           IF GDG-IND-ECRT IN GDG = 'S' AND                             
              GDG-FEC-FVET IN GDG > HOY-FHOY                            
               MOVE 'S' TO WSS-IND-ECRT IN WSS-VARI                     
              GO TO FIN-BUS-TNOV.                                       
                                                                        
           MOVE GVT-CAI-GTIA IN GVT-FLD TO TAS-CAI-GTIA IN TAS.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO TAS-IIC-GTIA IN TAS.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-TAS.                                         
           IF FIO-STAT-OKS AND                                          
              TAS-IND-ESTA IN TAS = '13' OR                             
              TAS-IND-ESTA IN TAS = '09'                                
              MOVE 'S' TO WSS-IND-RTAS IN WSS-VARI                      
              GO TO FIN-BUS-TNOV.                                       
                                                                        
           IF NOT (GVT-SGV-VCTS IN GVT-FLD > 1)                         
               MOVE 'N' TO WSS-IND-ARET IN WSS-VARI                     
               GO TO FIN-BUS-TNOV.                                      
                                                                        
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GIM-CAI-GTIA IN GIM.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GIM-IIC-GTIA IN GIM.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GIM.                                         
           IF NOT (FIO-STAT-OKS)                                        
              GO TO CNT-BUS-TNOV.                                       
                                                                        
           PERFORM LEE-GDD-DBC.                                         
                                                                        
           IF (DBC-NUM-ICLI IN DBC > '50000000')                        
              GO TO CNT-BUS-TNOV.                                       

      *PVC-INI 20-JUL-2012 - MENSAJE DE TASACION VENCIDA
           PERFORM OBT-VAL-VCT.
           IF WSS-VAL-UF IN WSS-VARI NOT < WSS-VAL-TASC IN WSS-VARI
               MOVE 'N' TO WSS-IND-TASC IN WSS-VARI
           ELSE
           IF WSS-IND-TASC IN WSS-VARI NOT = 'N'
               MOVE 'S' TO WSS-IND-TASC IN WSS-VARI.
      *PVC-FIN 20-JUL-2012
                                                                        
           IF (GIM-IND-GASC IN GIM = 'V' OR                             
               GIM-IND-GASC IN GIM = 'F' AND                            
               DBC-NUM-ICLI IN DBC < '50000000')                        
               MOVE 'N' TO WSS-IND-ARET IN WSS-VARI                     
               GO TO FIN-BUS-TNOV.                                      
                                                                        
       CNT-BUS-TNOV.                                                    
           MOVE 'S' TO WSS-IND-TNOV IN WSS-VARI.                        
                                                                        
      * EVA-FIN  11/08                                                  
       FIN-BUS-TNOV.                                                    
           EXIT.                                                        
                                                                        
       LEE-VCTO-TAS SECTION.                                            
       INI-LEE-VCTO-TAS.                                                
      *Lee Tabla de Fechas de Proceso                                   
           MOVE ZEROES TO WSS-NUM-FVCT.                                 
           MOVE 'BGL' TO TAB-COD-SIST FIO-SIST.                         
           MOVE 'TFP' TO TAB-COD-TTAB IN TAB.                           
           MOVE '11'  TO TAB-COD-CTAB IN TAB.                           
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               TAB-IND-VIGE IN TAB = 'S')                               
               MOVE SPACES TO WSS-GLS-DATA                              
               GO TO FIN-LEE-VCTO-TAS                                   
           ELSE                                                         
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA.                
       FIN-LEE-VCTO-TAS.                                                
           EXIT.                                                        
                                                                        
       LEE-GDD-DBC SECTION.                                             
       INI-LEE-GDD-DBC.                                                 
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDD-CAI-GTIA IN GDD.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDD-IIC-GTIA IN GDD.         
           MOVE FIO-GET-NLS  TO FIO-CMND.                               
           MOVE 'GDD-KEY-AGDD'       TO  FIO-AKEY.                      
                                                                        
           PERFORM BGL-FIO-GDD.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               GDG-CIC-GTIA IN GDG = GDD-CIC-GTIA IN GDD)               
               GO TO FIN-LEE-GDD-DBC.                                   
                                                                        
           MOVE GDD-CIC-DCLI IN GDD  TO  DBC-CIC-ICLI IN DBC.           
           MOVE FIO-GET-KEY          TO  FIO-CMND.                      
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
                GO TO FIN-LEE-GDD-DBC.                                  
       FIN-LEE-GDD-DBC.                                                 
           EXIT.                                                        
                                                                        
       LEE-TSOL SECTION.                                                
       INI-LEE-TSOL.                                                    
                                                                        
           PERFORM LEE-GSO.                                             
           IF (WSS-IND-GSO = '0')                                       
               PERFORM PROC-VIGENCIA                                    
      * EVA-INI  11/08                                                  
               GO TO FIN-LEE-TSOL.                                      
      *        GO TO CNT-LEE-TSOL.                                      
      * EVA-FIN  11/08                                                  
                                                                        
           MOVE GSO-NUM-SBGL IN GSO TO GSL-NUM-SBGL IN GSL.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSL.                                         
           IF NOT (FIO-STAT-OKS)                                        
      * EVA-INI  11/08                                                  
              PERFORM PROC-VIGENCIA                                     
              GO TO FIN-LEE-TSOL.                                       
      *       GO TO CNT-LEE-TSOL.                                       
      * EVA-FIN  11/08                                                  
                                                                        
           IF NOT (GSL-COD-TSOL IN GSL = 'I' OR                         
                   GSL-COD-TSOL IN GSL = 'D')                           
              PERFORM PROC-VIGENCIA                                     
           ELSE                                                         
              PERFORM PROC-INDIR.                                       
                                                                        
      * EVA-INI  11/08                                                  
      *CNT-LEE-TSOL.                                                    
                                                                        
      *    PERFORM CALC-FVEN.                                           
                                                                        
      * EVA-FIN  11/08                                                  
       FIN-LEE-TSOL.                                                    
           EXIT.                                                        
                                                                        
       LEE-GSO SECTION.                                                 
       INI-LEE-GSO.                                                     
           MOVE 999999999999        TO GSO-NUM-SBGL IN GSO.             
           MOVE GVT-CAI-GTIA IN GVT TO GSO-CAI-GTIA IN GSO.             
           MOVE GVT-IIC-GTIA IN GVT TO GSO-IIC-GTIA IN GSO.             
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
       LUP-LEE-GSO.                                                     
           MOVE 'GSO-KEY-IGDG' TO FIO-AKEY.                             
           PERFORM BGL-FIO-GSO.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                GVT-CAI-GTIA IN GVT = GSO-CAI-GTIA IN GSO AND           
                GVT-IIC-GTIA IN GVT = GSO-IIC-GTIA IN GSO)              
                MOVE '0' TO WSS-IND-GSO IN WSS-VARI                     
                GO TO FIN-LEE-GSO.                                      
                                                                        
           IF (GSO-COD-ESGA IN GSO > '02')                              
               MOVE '1' TO WSS-IND-GSO IN WSS-VARI                      
               GO TO FIN-LEE-GSO                                        
           ELSE                                                         
              MOVE FIO-GET-PRV TO FIO-CMND.                             
              GO TO LUP-LEE-GSO.                                        
       FIN-LEE-GSO.                                                     
           EXIT.                                                        
                                                                        
       PROC-VIGENCIA SECTION.                                           
       INI-PROC-VIGENCIA.                                               
           MOVE ZEROES TO WSS-FEC-FGVT.                                 
           MOVE GDG-TIP-CGTA IN GVT-FLD TO TAG-COD-TOPE IN TAG.         
           MOVE GDG-STP-CGTA IN GVT-FLD TO TAG-COD-SOPE IN TAG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.                                         
           IF NOT (FIO-STAT-OKS)                                        
              GO TO FIN-PROC-VIGENCIA.                                  
                                                                        
           MOVE TAG-NUM-PVTS IN TAG TO WSS-NUM-PVTS.                    
           MOVE TAG-COD-TPVT IN TAG TO WSS-COD-TPVT.                    
           IF WSS-COD-TPVT = 'A'                                        
              MOVE GVT-NUM-DTSN IN GVT TO FEC-ITM1                      
              MOVE GVT-NUM-MTSN IN GVT TO FEC-ITM2                      
              MOVE GVT-NUM-STSN IN GVT TO FEC-ITM3                      
              MOVE GVT-NUM-ATSN IN GVT TO FEC-ITM4                      
              MOVE FEC-FORM-FEC TO FEC-FORM                             
              MOVE WSS-NUM-PVTS TO FEC-NANO                             
              MOVE FEC-SUM-ANO  TO FEC-CMND                             
              PERFORM CAL-FEC                                           
              MOVE FEC-ITM3     TO WSS-NUM-SGVT                         
              MOVE FEC-ITM4     TO WSS-NUM-AGVT                         
              MOVE FEC-ITM2     TO WSS-NUM-MGVT                         
              MOVE FEC-ITM1     TO WSS-NUM-DGVT.                        
           IF WSS-COD-TPVT = 'M'                                        
              MOVE GVT-NUM-DTSN IN GVT TO FEC-ITM1                      
              MOVE GVT-NUM-MTSN IN GVT TO FEC-ITM2                      
              MOVE GVT-NUM-STSN IN GVT TO FEC-ITM3                      
              MOVE GVT-NUM-ATSN IN GVT TO FEC-ITM4                      
              MOVE FEC-FORM-FEC TO FEC-FORM                             
              MOVE WSS-NUM-PVTS TO FEC-NMES                             
              MOVE FEC-SUM-MES  TO FEC-CMND                             
              PERFORM CAL-FEC                                           
              MOVE FEC-ITM3     TO WSS-NUM-SGVT                         
              MOVE FEC-ITM4     TO WSS-NUM-AGVT                         
              MOVE FEC-ITM2     TO WSS-NUM-MGVT                         
              MOVE FEC-ITM1     TO WSS-NUM-DGVT.                        
           IF WSS-COD-TPVT = 'D'                                        
              MOVE GVT-NUM-DTSN IN GVT TO FEC-ITM1                      
              MOVE GVT-NUM-MTSN IN GVT TO FEC-ITM2                      
              MOVE GVT-NUM-STSN IN GVT TO FEC-ITM3                      
              MOVE GVT-NUM-ATSN IN GVT TO FEC-ITM4                      
              MOVE FEC-FORM-FEC TO FEC-FORM                             
              MOVE WSS-NUM-PVTS TO FEC-NDIA                             
              MOVE FEC-SUM-DIA  TO FEC-CMND                             
              PERFORM CAL-FEC                                           
              MOVE FEC-ITM3     TO WSS-NUM-SGVT                         
              MOVE FEC-ITM4     TO WSS-NUM-AGVT                         
              MOVE FEC-ITM2     TO WSS-NUM-MGVT                         
              MOVE FEC-ITM1     TO WSS-NUM-DGVT.                        
       FIN-PROC-VIGENCIA.                                               
           EXIT.                                                        
                                                                        
       PROC-INDIR SECTION.                                              
       INI-PROC-INDIR.                                                  
           MOVE ZEROES TO WSS-FEC-FGVT.                                 
           MOVE GVT-NUM-DTSN IN GVT TO FEC-ITM1.                        
           MOVE GVT-NUM-MTSN IN GVT TO FEC-ITM2.                        
           MOVE GVT-NUM-STSN IN GVT TO FEC-ITM3.                        
           MOVE GVT-NUM-ATSN IN GVT TO FEC-ITM4.                        
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE '24'         TO FEC-NMES.                               
           MOVE FEC-SUM-MES  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           MOVE FEC-ITM3            TO WSS-NUM-SGVT.                    
           MOVE FEC-ITM4            TO WSS-NUM-AGVT.                    
           MOVE FEC-ITM2            TO WSS-NUM-MGVT.                    
           MOVE FEC-ITM1            TO WSS-NUM-DGVT.                    
       FIN-PROC-INDIR.                                                  
           EXIT.                                                        
                                                                        
       CALC-FVEN SECTION.                                               
       INI-CALC-FVEN.                                                   
           MOVE HOY-DHOY     TO FEC-ITM1.                               
           MOVE HOY-MHOY     TO FEC-ITM2.                               
           MOVE HOY-SHOY     TO FEC-ITM3.                               
           MOVE HOY-AHOY     TO FEC-ITM4.                               
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE WSS-NUM-FVCT TO FEC-NDIA.                               
           MOVE FEC-SUM-DIA  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           MOVE FEC-ITM1            TO WSS-NUM-DVEN.                    
           MOVE FEC-ITM2            TO WSS-NUM-MVEN.                    
           MOVE FEC-ITM3            TO WSS-NUM-SVEN.                    
           MOVE FEC-ITM4            TO WSS-NUM-AVEN.                    
       FIN-CALC-FVEN.                                                   
           EXIT.                                                        
                                                                        
       LEE-GDG SECTION.                                                 
       INI-LEE-GDG.                                                     
           MOVE 'N' TO WSS-IND-GTIA IN WSS-VARI.                        
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           IF FIO-STAT-OKS                                              
              MOVE 'S' TO WSS-IND-GTIA IN WSS-VARI.                     
       FIN-LEE-GDG.                                                     
           EXIT.                                                        
      ** EVA-FIN  10/07                                                 

      *PVC-INI  Jul-2012  -  Mensaje de Tasacion Vencida
       OBT-VAL-VCT SECTION.                                             
       INI-OBT-VAL-VCT.                                                 
           MOVE ZEROES TO WSS-VAL-UF IN WSS-VARI.                       
           PERFORM OBT-VAL-TASC.
           IF WSS-IND-TASC IN WSS-VARI NOT = SPACES
               GO TO FIN-OBT-VAL-VCT.

           PERFORM OBT-COD-MNAC.
           PERFORM OBT-COD-UF.
           IF GDG-COD-VCAM IN GDG = WSS-COD-UF IN WSS-VARI
               MOVE GVT-SGV-VCTS IN GVT-FLD TO                          
                    WSS-VAL-UF IN WSS-VARI                              
               GO TO FIN-OBT-VAL-VCT.

           PERFORM GET-FHOY.
           MOVE HOY-FHOY                  TO CAM-FEC-FCAM IN CAM(1).    
           MOVE CAM-FEC-FCAM IN CAM(1)    TO CAM-FEC-FCAM IN CAM(2).    
           IF GDG-COD-VCAM IN GDG NOT = WSS-COD-PESO IN WSS-VARI
              MOVE GDG-COD-VCAM IN GDG    TO CAM-COD-VCAM IN CAM(1)     
           ELSE
              MOVE WSS-COD-UF IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).    
           MOVE WSS-COD-PESO IN WSS-VARI  TO CAM-COD-VCAM IN CAM(2).    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              CAM-IND-VIGE IN CAM = 'S' )                               
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE 'N' TO WSS-IND-TASC IN WSS-VARI
               GO TO FIN-OBT-VAL-VCT.                                   

           IF GDG-COD-VCAM IN GDG = WSS-COD-PESO IN WSS-VARI
               COMPUTE WSS-VAL-UF IN WSS-VARI ROUNDED =                 
                       GVT-SGV-VCTS IN GVT-FLD /                        
                       CAM-SGV-VCAM IN CAM                              
                                                                        
               GO TO FIN-OBT-VAL-VCT.

           COMPUTE WSS-VAL-UF IN WSS-VARI ROUNDED =                     
                   GVT-SGV-VCTS IN GVT-FLD *                            
                   CAM-SGV-VCAM IN CAM                                  

           MOVE HOY-FHOY                 TO CAM-FEC-FCAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE WSS-COD-UF   IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              CAM-IND-VIGE IN CAM = 'S' )                               
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE 'N' TO WSS-IND-TASC IN WSS-VARI
               GO TO FIN-OBT-VAL-VCT.                                   
                                                                        
           COMPUTE WSS-VAL-UF IN WSS-VARI ROUNDED =                     
                   WSS-VAL-UF IN WSS-VARI /                             
                   CAM-SGV-VCAM IN CAM.                                 

       FIN-OBT-VAL-VCT.                                                 
           EXIT.                                                        

       OBT-VAL-TASC SECTION.
       INI-OBT-VAL-TASC.
           MOVE ZEROES         TO WSS-VAL-TASC IN WSS-VARI.
           MOVE SPACES         TO TAB-COD-CTAB IN TAB.
           MOVE 'BGL'          TO FIO-SIST.
           MOVE 'MON'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'MON'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT  FIO-STAT-OKS
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE 'N' TO WSS-IND-TASC IN WSS-VARI
               GO TO FIN-OBT-VAL-TASC.                                  
           IF TAB-IND-VIGE IN TAB NOT = 'S'
               MOVE 'N' TO WSS-IND-TASC IN WSS-VARI
               GO TO FIN-OBT-VAL-TASC.                                  
           MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-DAT1 IN WSS-VARI.
           IF WSS-VAL-TASC IN WSS-VARI IS NOT NUMERIC
               MOVE 'N' TO WSS-IND-TASC IN WSS-VARI
               GO TO FIN-OBT-VAL-TASC.                                  
           IF WSS-VAL-TASC IN WSS-VARI NOT > ZEROES
               MOVE 'N' TO WSS-IND-TASC IN WSS-VARI.
       FIN-OBT-VAL-TASC.
           EXIT.
      *PVC-FIN Jul-2012

      *PVC-INI 19-NOV-2012  DESVALORIZACION
       CONT-AVALUOS SECTION.
       INI-CONT-AVALUOS.
           MOVE ZEROES       TO WSS-NUM-FISC IN WSS-VARI.
           MOVE SPACES       TO WSS-GLS-DANE IN WSS-VARI.
           MOVE 'BGL'        TO FIO-SIST.
           MOVE 'FIS'        TO TAB-COD-TTAB IN TAB.
           MOVE 'FIS'        TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CONT-AVALUOS.                                  

           IF TAB-IND-VIGE IN TAB NOT = 'S'
               GO TO FIN-CONT-AVALUOS.                                  

           IF TAB-GLS-DATA IN TAB NOT > SPACES
               GO TO FIN-CONT-AVALUOS.

           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DANE IN WSS-VARI.

           MOVE GVT-CAI-GTIA IN GVT-FLD TO GVT-CAI-GTIA IN GVT.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GVT-IIC-GTIA IN GVT.         
           MOVE ZEROES                  TO GVT-COD-TASN IN GVT.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GVT.
           PERFORM BGL-FIO-GVT.
           IF NOT ( FIO-STAT-OKS AND
              GVT-CAI-GTIA IN GVT-FLD = GVT-CAI-GTIA IN GVT AND
              GVT-IIC-GTIA IN GVT-FLD = GVT-IIC-GTIA IN GVT )
               GO TO FIN-CONT-AVALUOS.

           IF GVT-COD-EITS IN GVT NOT > SPACES
               GO TO NXT-GVT.                                           

           MOVE 1 TO I.
       LUP-FIS.
           IF I > 20
               GO TO NXT-GVT.                                           

           IF WSS-COD-DATA(I) NOT > SPACES
               GO TO NXT-GVT.

           IF GVT-COD-EITS IN GVT = WSS-COD-DATA(I)
               ADD 1 TO WSS-NUM-FISC IN WSS-VARI
               GO TO NXT-GVT.                                           

           ADD 1 TO I.
           GO TO LUP-FIS.
       NXT-GVT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GVT.
       FIN-CONT-AVALUOS.
           EXIT.
      *PVC-FIN 19-NOV-2012
      *<<<< EOF_BQ AND NOT PGM_BM
       PRO-FLD-GVT SECTION.
       INI-PRO-FLD-GVT.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-STP.

           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-STP.

           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-STP.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VGAS-ATR IN GVT-FLD.
           PERFORM PRO-GVT-GVT.
           PERFORM PRO-GDG-GVT.
           IF SCR-CMND = 'ING' OR                                       
              SCR-CMND = 'INE' OR                                       
              SCR-CMND = 'MOD'                                          
               MOVE FRM-CPIM-AEY TO GVT-COD-SDAG-ATR IN GVT-FLD.
       FIN-PRO-FLD-GVT.
           EXIT.
       
       PRO-GVT-GVT SECTION.
       INI-PRO-GVT-GVT.
      * IDC-FIN --> BMMEXBNM005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
      *CGL-INI  19-AUG-2003 18:08:08 
      *     MOVE FRM-CPIM-AEY TO GVT-COD-CRIT-ATR IN GVT-FLD.
      *     MOVE FRM-CPIM-AEY TO GVT-COD-OAVA-ATR IN GVT-FLD.
      *     MOVE FRM-CPIM-AEY TO GVT-COD-ADAG-ATR IN GVT-FLD.
      *CGL-FIN  19-AUG-2003 18:11:33 
           MOVE FRM-CPIM-AEY TO GVT-COD-SDAG-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
      *CGL-INI  19-AUG-2003 18:12:21 
      *     MOVE FRM-CPIM-AEY TO GVT-SGV-FISI-ATR IN GVT-FLD.
      *CGL-FIN  19-AUG-2003 18:12:29 
      *MHM-INI 15-OCT-2003
           MOVE FRM-CPIM-AEY TO GVT-SGV-PPCT-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VSIN-ATR IN GVT-FLD.
      *MHM-FIN 15-OCT-2003
           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-EITS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-ISVS-ATR IN GVT-FLD.
      * IDC-FIN --> BMMEXBNM005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD.
       FIN-PRO-GVT-GVT.
           EXIT.
       
       PRO-GDG-GVT SECTION.
       INI-PRO-GDG-GVT.
       FIN-PRO-GDG-GVT.
           EXIT.
      *>>>>
      *<<<< EOF_VAX 
       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       PRO-RTA-RDO SECTION.
       INI-PRO-RTA-RDO.
      *GET-HOY Otiene Fecha actual
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO GVT-FEC-FTSN IN GVT-FLD.
      *PROTEJE CAMPOS
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-STP.

       FIN-PRO-RTA-RDO.
           EXIT.


       OBT-VAL-CON SECTION.
       INI-OBT-VAL-CON.
           MOVE GDG-COD-VCAM IN GVT-FLD TO GDG-COD-VCAM IN GDG.
           IF NOT (
              GDG-COD-TVCM IN GDG = '0' AND
              GDG-COD-VCAM IN GVT-FLD NOT = WSS-COD-PESO IN WSS-VARI
              )
               MOVE GVT-SGV-VGAS IN GVT-FLD TO
                    FRM-VAL-ULT-CON IN GVT-FLD

               GO TO FIN-OBT-VAL-CON.

                                                                        
      *      ** Correcciln Monetaria - Revalorizador **      *          
      *               SEPTIEMBRE 2007  -  AFRI *             *          
                                                                        
      ** EVA-INI  09/07                                                 
                                                                        
           MOVE ZEROES TO WSS-FEC-FULR.                                 
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GVT-CAI-GTIA IN GVT.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GVT-IIC-GTIA IN GVT.         
           MOVE GVT-COD-TASN IN GVT-FLD TO GVT-COD-TASN IN GVT.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GVT.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-OBT-VAL-CON.                                    
                                                                        
           IF NOT (GVT-FEC-FURV IN GVT > ZEROES)                        
              GO TO CON-OBT-VAL.                                        
                
           IF GVT-FEC-FTSN IN GVT > GVT-FEC-FRVL IN GVT                 
              MOVE GVT-FEC-FTSN IN GVT TO WSS-FEC-FULR                  
           ELSE                                                         
              MOVE GVT-FEC-FRVL IN GVT TO WSS-FEC-FULR.                 
                                                                        
           IF GVT-FEC-FURV IN GVT > WSS-FEC-FULR                        
              MOVE GVT-FEC-FURV IN GVT TO WSS-FEC-FULR.                 
                                                                        
           MOVE WSS-NUM-SULR TO CAM-NUM-SCAM IN CAM(1).                 
           MOVE WSS-NUM-AULR TO CAM-NUM-ACAM IN CAM(1).                 
           MOVE WSS-NUM-MULR TO CAM-NUM-MCAM IN CAM(1).                 
           MOVE WSS-NUM-DULR TO CAM-NUM-DCAM IN CAM(1).                 
           GO TO NXT-OBT-VAL.                                           
                                                                        
       CON-OBT-VAL.                                                     
           MOVE GVT-NUM-SRVL IN GVT TO CAM-NUM-SCAM IN CAM(1).          
           MOVE GVT-NUM-ARVL IN GVT TO CAM-NUM-ACAM IN CAM(1).          
           MOVE GVT-NUM-MRVL IN GVT TO CAM-NUM-MCAM IN CAM(1).          
           MOVE GVT-NUM-DRVL IN GVT TO CAM-NUM-DCAM IN CAM(1).          
       NXT-OBT-VAL.                                                     
                                                                        
      ** EVA-FIN  09/07                                                 

           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE GDG-COD-VCAM IN GVT-FLD  TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
              )
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MULTIPLY GVT-SGV-VGAS IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED
               MOVE WSS-VAL-PESO TO FRM-VAL-ULT-CON IN GVT-FLD.
       FIN-OBT-VAL-CON.
           EXIT.

      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
       PRO-LEE-MSG SECTION.                                             
       INI-PRO-LEE-MSG.                                                 
           MOVE SPACES TO WSS-GLS-CMSG IN WSS-VARI.
           MOVE 'BGL'                    TO TAB-COD-SIST FIO-SIST.      
           MOVE 'MSG'                    TO TAB-CIC-TTAB IN TAB.        
           MOVE WSS-COD-CMSG IN WSS-VARI TO TAB-CIC-CTAB IN TAB.        
           MOVE 'TAB-CIC-TABL'           TO FIO-AKEY.                   
           MOVE FIO-GET-KEY              TO FIO-CMND.                   
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S') OR
            TAB-COD-CTAB IN TAB = SPACES
               MOVE 'BGL'          TO MSG-COD-SIST                      
               MOVE 'MSGEXCEP NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-PRO-LEE-MSG
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CMSG IN WSS-VARI.    
       FIN-PRO-LEE-MSG.                                                 
           EXIT.                                                        
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012 
      *>>>> 
