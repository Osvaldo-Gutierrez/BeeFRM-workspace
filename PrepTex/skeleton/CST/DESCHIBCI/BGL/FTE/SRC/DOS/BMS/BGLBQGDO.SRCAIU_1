      *
      * BGLBQGDO
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 04:51 PM
      *
       SET-TAG-BGLBQGDO SECTION.
       INI-SET-TAG-BGLBQGDO.
           MOVE
           '<IDNMOD NOM=$BGLBQGDO$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 04:51 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBQGDO.
           EXIT.
           
       PUT-ALL-GDO SECTION.
       INI-PUT-ALL-GDO.
           PERFORM PUT-GDO-GDO.
           PERFORM PUT-GDG-GDO.
       FIN-PUT-ALL-GDO.
           EXIT.
       
       PUT-GDO-GDO SECTION.
       INI-PUT-GDO-GDO.
           IF PGM-STAT-GDO-NUL
               GO TO FIN-PUT-GDO-GDO.
           IF NOT PGM-STAT-GDO-OKS
               PERFORM CLR-GDO-GDO
               GO TO FIN-PUT-GDO-GDO.
           MOVE GDO-CAI-GTIA IN GDO TO GDO-CAI-GTIA IN GDO-FLD.
           MOVE GDO-IIC-GTIA IN GDO TO GDO-IIC-GTIA IN GDO-FLD.
           MOVE GDO-NUM-IGDO IN GDO TO GDO-NUM-IGDO IN GDO-FLD.
           MOVE GDO-COD-DOCU IN GDO TO GDO-COD-DOCU IN GDO-FLD.
           MOVE GDO-COD-TDOC IN GDO TO GDO-COD-TDOC IN GDO-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDO-NUM-DCAP IN GDO TO GDO-NUM-DCAP IN GDO-FLD.
           MOVE GDO-NUM-MCAP IN GDO TO GDO-NUM-MCAP IN GDO-FLD.
           MOVE GDO-NUM-SCAP IN GDO TO GDO-NUM-SCAP IN GDO-FLD.
           MOVE GDO-NUM-ACAP IN GDO TO GDO-NUM-ACAP IN GDO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDO-COD-TIEM IN GDO TO GDO-COD-TIEM IN GDO-FLD.
           MOVE GDO-COD-INEM IN GDO TO GDO-COD-INEM IN GDO-FLD.
           MOVE GDO-COD-SIEM IN GDO TO GDO-COD-SIEM IN GDO-FLD.
           MOVE GDO-COD-NEMO IN GDO TO GDO-COD-NEMO IN GDO-FLD.
           MOVE GDO-COD-RENO IN GDO TO GDO-COD-RENO IN GDO-FLD.
           MOVE GDO-NUM-SEVE IN GDO TO GDO-NUM-SEVE IN GDO-FLD.
           MOVE GDO-IND-SEVE IN GDO TO GDO-IND-SEVE IN GDO-FLD.
           MOVE GDO-SGV-TINT IN GDO TO GDO-SGV-TINT IN GDO-FLD.
           MOVE GDO-COD-TIPT IN GDO TO GDO-COD-TIPT IN GDO-FLD.
           MOVE GDO-SGV-TCGT IN GDO TO GDO-SGV-TCGT IN GDO-FLD.
           MOVE GDO-COD-TCGT IN GDO TO GDO-COD-TCGT IN GDO-FLD.
      *<<<< FIN_PUT_GDO_GDO
      *BUS-TAB busca glosa de codigo en tabla
           IF GDO-COD-TDOC IN GDO-FLD > SPACES
      *<<<< GEN_BCI
               MOVE 'TAB'  TO TAB-COD-SIST
               MOVE 'TIO'  TO TAB-COD-TTAB IN TAB
      *>>>>
               MOVE GDO-COD-TDOC IN GDO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TDOC IN GDO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TDOC IN GDO-FLD.

      *RRM-INI JUL-2018 REVALORIZACION DE FFMM                          
           IF PGM-STAT-GDG-OKS                                                      
               MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST        
               MOVE 'PFM'               TO TAB-COD-TTAB IN TAB          
               MOVE GDG-COD-CGTA IN GDG TO TAB-COD-CTAB IN TAB          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S          
                  AND GDO-COD-TDOC IN GDO-FLD > SPACES                  
                   MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST    
                   MOVE 'TDO'               TO TAB-COD-TTAB IN TAB      
                   MOVE GDO-COD-TDOC IN GDO-FLD TO TAB-COD-CTAB IN TAB  
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM GNS-FIO-TAB                                  
                   IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S)
                      MOVE SPACES              TO                       
                                               FRM-GLS-TDOC IN GDO-FLD  
                   ELSE                                                 
                      MOVE TAB-GLS-DESC IN TAB TO                       
                                               FRM-GLS-TDOC IN GDO-FLD. 
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM 

      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE GDO-COD-TIEM IN GDO-FLD TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDO-COD-INEM IN GDO-FLD TO WSS-COD-INEM
           MOVE GDO-COD-SIEM IN GDO-FLD TO WSS-COD-SIEM
           MOVE WSS-CIV-SIV TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IEMI IN GDO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IEMI IN GDO-FLD.
      *>>>>
      *<<<<
      * EVA-INI  06/08                                                  
           IF GDO-COD-RENO IN GDO-FLD > SPACES                          
              MOVE 'BGL'                   TO TAB-COD-SIST FIO-SIST     
              MOVE 'PFR'                   TO TAB-COD-TTAB IN TAB       
              MOVE GDO-COD-RENO IN GDO-FLD TO TAB-COD-CTAB IN TAB       
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM GNS-FIO-TAB                                       
              IF NOT (FIO-STAT-OKS AND                                  
                 TAB-IND-VIGE IN TAB = 'S')                             
                 MOVE SPACES TO FRM-GLS-RENO IN GDO-FLD                 
              ELSE                                                      
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-RENO IN GDO-FLD    
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-RENO IN GDO-FLD.                   
                                                                        
           IF GDO-IND-SEVE IN GDO-FLD > SPACES                          
              MOVE 'TAB' TO MSC-COD-SIST                                
              MOVE 'IPER' TO MSC-COD-TMSC IN MSC                        
              MOVE GDO-IND-SEVE IN GDO-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND                                           
              IF MSG-COD-MENS = 'COD    NEX'                            
                 MOVE SPACES TO FRM-GLS-SEVE IN GDO-FLD                 
              ELSE                                                      
                 MOVE MSC-GLS-DCOR IN MSC TO                            
                    FRM-GLS-SEVE IN GDO-FLD                             
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-SEVE IN GDO-FLD.                   
                                                                        
           IF GDO-COD-TIPT IN GDO-FLD > SPACES                          
               MOVE 'TAB'                   TO TAB-COD-SIST             
               MOVE 'INT'                   TO TAB-COD-TTAB IN TAB      
               MOVE GDO-COD-TIPT IN GDO-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               IF MSG-COD-MENS = 'COD    NEX'                           
                  MOVE SPACES TO FRM-GLS-TIPT IN GDO-FLD                
               ELSE                                                     
                  MOVE TAB-GLS-DESC IN TAB TO                           
                   FRM-GLS-TIPT IN GDO-FLD                              
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-TIPT IN GDO-FLD.                  
                                                                        
           IF GDO-COD-TCGT IN GDO-FLD > SPACES                          
               MOVE 'TAB'                   TO TAB-COD-SIST             
               MOVE 'INT'                   TO TAB-COD-TTAB IN TAB      
               MOVE GDO-COD-TCGT IN GDO-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               IF MSG-COD-MENS = 'COD    NEX'                           
                  MOVE SPACES TO FRM-GLS-TCGT IN GDO-FLD                
               ELSE                                                     
                  MOVE TAB-GLS-DESC IN TAB TO                           
                  FRM-GLS-TCGT IN GDO-FLD                               
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-TCGT IN GDO-FLD.                  
      * EVA-FIN  06/08
      *<<<<                                                  
       FIN-PUT-GDO-GDO.
           EXIT.
       
       PUT-GDG-GDO SECTION.
       INI-PUT-GDG-GDO.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GDO.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GDO
               GO TO FIN-PUT-GDG-GDO.
      * IDG-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GDO-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GDO-FLD.
      * IDG-FIN --> BMCHIBCI001210.SRCAIU 
      * OFI-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-OFIC IN GDG TO GDG-COD-OFIC IN GDO-FLD.
      * OFI-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-VCAM IN GDG TO GDG-COD-VCAM IN GDO-FLD.
           MOVE GDG-GLS-DGTA IN GDG TO GDG-GLS-DGTA IN GDO-FLD.
           MOVE GDG-GLS-DGT1 IN GDG TO GDG-GLS-DGT1 IN GDO-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFIC IN GDO-FLD > SPACES
               MOVE GDG-COD-OFIC IN GDO-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN GDO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN GDO-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-VCAM IN GDO-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-VCAM IN GDO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN GDO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCAM IN GDO-FLD.
      *<<<< FIN_PUT_GDG_GDO
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GDO-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GDO-FLD TO TAG-STP-AGTA IN TAG.
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
      *MHM-INI 23-OCT-2003
      *     MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CGTA IN GDO-FLD.
           MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GDO-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GDO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GDO-FLD.
      *MHM-FIN 23-OCT-2003
      *<<<<
       FIN-PUT-GDG-GDO.
           EXIT.
       
       KEY-ALL-GDO SECTION.
       INI-KEY-ALL-GDO.
           PERFORM KEY-GDO-GDO.
           PERFORM KEY-GDG-GDO.
       FIN-KEY-ALL-GDO.
           EXIT.
       
       KEY-GDO-GDO SECTION.
       INI-KEY-GDO-GDO.
           MOVE GDO-CAI-GTIA IN GDO-FLD TO GDO-CAI-GTIA IN GDO.
           MOVE GDO-IIC-GTIA IN GDO-FLD TO GDO-IIC-GTIA IN GDO.
           MOVE GDO-NUM-IGDO IN GDO-FLD TO GDO-NUM-IGDO IN GDO.
       FIN-KEY-GDO-GDO.
           EXIT.
       
       KEY-GDG-GDO SECTION.
       INI-KEY-GDG-GDO.
       FIN-KEY-GDG-GDO.
           EXIT.
       
       SCR-CLRA-GDO SECTION.
       INI-SCR-CLRA-GDO.
           PERFORM CLR-KEY-GDO.
           PERFORM CLR-FLD-GDO.
       FIN-SCR-CLRA-GDO.
           EXIT.
       
       CLR-KEY-GDO SECTION.
       INI-CLR-KEY-GDO.
           MOVE SPACES TO GDO-CAI-GTIA IN GDO-FLD.
           MOVE ZEROES TO GDO-IIC-GTIA IN GDO-FLD.
           MOVE ZEROES TO GDO-NUM-IGDO IN GDO-FLD.
       FIN-CLR-KEY-GDO.
           EXIT.
       
       CLR-FLD-GDO SECTION.
       INI-CLR-FLD-GDO.
           MOVE SPACES TO FRM-GLS-TREA IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-TDOC IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-IEMI IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-RENO IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-SEVE IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-TIPT IN GDO-FLD.
           MOVE SPACES TO FRM-GLS-TCGT IN GDO-FLD.
           PERFORM CLR-GDO-GDO.
           PERFORM CLR-GDG-GDO.
       FIN-CLR-FLD-GDO.
           EXIT.
       
       CLR-GDO-GDO SECTION.
       INI-CLR-GDO-GDO.
           MOVE SPACES TO GDO-COD-DOCU IN GDO-FLD.
           MOVE SPACES TO GDO-COD-TDOC IN GDO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDO-FEC-FCAP IN GDO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDO-COD-TIEM IN GDO-FLD.
           MOVE SPACES TO GDO-COD-INEM IN GDO-FLD.
           MOVE SPACES TO GDO-COD-SIEM IN GDO-FLD.
           MOVE SPACES TO GDO-COD-NEMO IN GDO-FLD.
           MOVE SPACES TO GDO-COD-RENO IN GDO-FLD.
           MOVE ZEROES TO GDO-NUM-SEVE IN GDO-FLD.
           MOVE SPACES TO GDO-IND-SEVE IN GDO-FLD.
           MOVE ZEROES TO GDO-SGV-TINT IN GDO-FLD.
           MOVE SPACES TO GDO-COD-TIPT IN GDO-FLD.
           MOVE ZEROES TO GDO-SGV-TCGT IN GDO-FLD.
           MOVE SPACES TO GDO-COD-TCGT IN GDO-FLD.
       FIN-CLR-GDO-GDO.
           EXIT.
       
       CLR-GDG-GDO SECTION.
       INI-CLR-GDG-GDO.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GDO-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GDO-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GDO-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GDO-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GDO-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GDO-FLD.
       FIN-CLR-GDG-GDO.
           EXIT.
       
       FST-KEY-GDO SECTION.
       INI-FST-KEY-GDO.
           MOVE -1 TO GDO-CAI-GTIA-LEN IN GDO-FLD.
       FIN-FST-KEY-GDO.
           EXIT.
       
       FST-FLD-GDO SECTION.
       INI-FST-FLD-GDO.
           MOVE -1 TO GDO-COD-DOCU-LEN IN GDO-FLD.
       FIN-FST-FLD-GDO.
           EXIT.
       
       PRO-KEY-GDO SECTION.
       INI-PRO-KEY-GDO.
           PERFORM PRO-IKY-GDO.
           PERFORM PRO-AKY-GDO.
           PERFORM PRO-MKY-GDO.
       FIN-PRO-KEY-GDO.
           EXIT.
       
       PRO-IKY-GDO SECTION.
       INI-PRO-IKY-GDO.
           MOVE FRM-CPIM-AEY TO GDO-CAI-GTIA-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-IIC-GTIA-ATR IN GDO-FLD.
           MOVE FRM-CPIM-AEY TO GDO-NUM-IGDO-ATR IN GDO-FLD.
       FIN-PRO-IKY-GDO.
           EXIT.
       
       PRO-MKY-GDO SECTION.
       INI-PRO-MKY-GDO.
       FIN-PRO-MKY-GDO.
           EXIT.
       
       PRO-AKY-GDO SECTION.
       INI-PRO-AKY-GDO.
       FIN-PRO-AKY-GDO.
           EXIT.
       
       UNP-KEY-GDO SECTION.
       INI-UNP-KEY-GDO.
           PERFORM UNP-IKY-GDO.
           PERFORM UNP-AKY-GDO.
           PERFORM UNP-MKY-GDO.
       FIN-UNP-KEY-GDO.
           EXIT.
       
       UNP-IKY-GDO SECTION.
       INI-UNP-IKY-GDO.
           MOVE FRM-CPIM-UBY TO GDO-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GDO-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GDO-NUM-IGDO-ATR.
      *<<<< FIN_UNP_IKY_GDO 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = "ING"
               MOVE FRM-CPIM-AEY TO GDO-NUM-IGDO-ATR IN GDO-FLD
               MOVE FRM-CPIM-AEY TO GDO-NUM-IGDO-STP.
      *RRM-FIN 16-APR-2002
      *>>>>
       FIN-UNP-IKY-GDO.
           EXIT.
       
       UNP-MKY-GDO SECTION.
       INI-UNP-MKY-GDO.
       FIN-UNP-MKY-GDO.
           EXIT.
       
       UNP-AKY-GDO SECTION.
       INI-UNP-AKY-GDO.
       FIN-UNP-AKY-GDO.
           EXIT.
       
       UNP-FLD-GDO SECTION.
       INI-UNP-FLD-GDO.
           PERFORM UNP-GDO-GDO.
           PERFORM UNP-GDG-GDO.
       FIN-UNP-FLD-GDO.
           EXIT.
       
       UNP-GDO-GDO SECTION.
       INI-UNP-GDO-GDO.
           MOVE FRM-CPIM-UBY TO GDO-COD-DOCU-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-TDOC-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-FEC-FCAP-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-TIEM-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-INEM-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-SIEM-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-NEMO-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-RENO-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-NUM-SEVE-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-IND-SEVE-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-SGV-TINT-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-TIPT-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-SGV-TCGT-ATR IN GDO-FLD.
           MOVE FRM-CPIM-UBY TO GDO-COD-TCGT-ATR IN GDO-FLD.
       FIN-UNP-GDO-GDO.
           EXIT.
       
       UNP-GDG-GDO SECTION.
       INI-UNP-GDG-GDO.
       FIN-UNP-GDG-GDO.
           EXIT.
       
       VAL-KEY-GDO SECTION.
       INI-VAL-KEY-GDO.
           PERFORM VAL-IKY-GDO.
           PERFORM VAL-MKY-GDO.
           PERFORM VAL-AKY-GDO.
       FIN-VAL-KEY-GDO.
           EXIT.
       
       VAL-IKY-GDO SECTION.
       INI-VAL-IKY-GDO.
           PERFORM VAL-GDO-CAI-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-CAI-GTIA-LEN IN GDO-FLD
                GO TO FIN-VAL-IKY-GDO.
           PERFORM VAL-GDO-IIC-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-IIC-GTIA-LEN IN GDO-FLD
                GO TO FIN-VAL-IKY-GDO.
           PERFORM VAL-GDO-NUM-IGDO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDO-NUM-IGDO-LEN IN GDO-FLD
                GO TO FIN-VAL-IKY-GDO.
       FIN-VAL-IKY-GDO.
           EXIT.
       
       VAL-MKY-GDO SECTION.
       INI-VAL-MKY-GDO.
       FIN-VAL-MKY-GDO.
           EXIT.
       
       VAL-AKY-GDO SECTION.
       INI-VAL-AKY-GDO.
       FIN-VAL-AKY-GDO.
           EXIT.
       
       VAL-GDO-CAI-GTIA SECTION.
       INI-VAL-GDO-CAI-GTIA.
      *>>>>
           IF GDO-CAI-GTIA IN GDO-FLD NOT > SPACES     
              MOVE SPACES TO GDO-CAI-GTIA IN GDO-FLD
              PERFORM ERR-GLS             
              GO TO FIN-VAL-GDO-CAI-GTIA. 
      *<<<<
           IF GDO-CAI-GTIA IN GDO-FLD NOT > SPACES
              MOVE SPACES TO GDO-CAI-GTIA IN GDO-FLD.
       FIN-VAL-GDO-CAI-GTIA.
           EXIT.
       
       VAL-GDO-IIC-GTIA SECTION.
       INI-VAL-GDO-IIC-GTIA.
           IF GDO-IIC-GTIA IN GDO-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDO-IIC-GTIA.
       FIN-VAL-GDO-IIC-GTIA.
           EXIT.
       
       VAL-GDO-NUM-IGDO SECTION.
       INI-VAL-GDO-NUM-IGDO.
       FIN-VAL-GDO-NUM-IGDO.
           EXIT.
       
       VAL-CON-KEY-GDO SECTION.
       INI-VAL-CON-KEY-GDO.
           IF     GDO-CAI-GTIA IN GDO-FLD NOT > SPACES 
              AND GDO-IIC-GTIA IN GDO-FLD NOT > ZEROES 
              AND GDO-NUM-IGDO IN GDO-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDO.
       FIN-VAL-CON-KEY-GDO.
           EXIT.
       
       VAL-CON-IKY-GDO SECTION.
       INI-VAL-CON-IKY-GDO.
           IF     GDO-CAI-GTIA IN GDO-FLD NOT > SPACES 
              AND GDO-IIC-GTIA IN GDO-FLD NOT > ZEROES 
              AND GDO-NUM-IGDO IN GDO-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDO.
       FIN-VAL-CON-IKY-GDO.
           EXIT.
       
       VAL-NUM-KEY-GDO SECTION.
       INI-VAL-NUM-KEY-GDO.
           PERFORM VAL-NUM-IKY-GDO.
           PERFORM VAL-NUM-MKY-GDO.
           PERFORM VAL-NUM-AKY-GDO.
       FIN-VAL-NUM-KEY-GDO.
           EXIT.
       
       VAL-NUM-IKY-GDO SECTION.
       INI-VAL-NUM-IKY-GDO.
       VAL-NUM-GDO-IIC-GTIA.
           MOVE GDO-IIC-GTIA-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDO-IIC-GTIA IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-IIC-GTIA-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-IKY-GDO.
       VAL-NUM-GDO-NUM-IGDO.
           MOVE GDO-NUM-IGDO-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDO-NUM-IGDO IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-NUM-IGDO-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-IKY-GDO.
       FIN-VAL-NUM-IKY-GDO.
           EXIT.
       
       VAL-NUM-MKY-GDO SECTION.
       INI-VAL-NUM-MKY-GDO.
       FIN-VAL-NUM-MKY-GDO.
           EXIT.
       
       VAL-NUM-AKY-GDO SECTION.
       INI-VAL-NUM-AKY-GDO.
       FIN-VAL-NUM-AKY-GDO.
           EXIT.
       
       VAL-NUM-FLD-GDO SECTION.
       INI-VAL-NUM-FLD-GDO.
       VAL-NUM-GDO-NUM-SEVE.
           MOVE GDO-NUM-SEVE-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDO-NUM-SEVE IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-NUM-SEVE-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-FLD-GDO.
       VAL-NUM-GDO-SGV-TINT.
           MOVE GDO-SGV-TINT-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GDO-SGV-TINT IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-SGV-TINT-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-FLD-GDO.
       VAL-NUM-GDO-SGV-TCGT.
           MOVE GDO-SGV-TCGT-ALF IN GDO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GDO-SGV-TCGT IN GDO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDO-SGV-TCGT-LEN IN GDO-FLD
                GO TO FIN-VAL-NUM-FLD-GDO.
       FIN-VAL-NUM-FLD-GDO.
           EXIT.
       
       EDT-KEY-GDO SECTION.
       INI-EDT-KEY-GDO.
           PERFORM EDT-IKY-GDO.
           PERFORM EDT-MKY-GDO.
           PERFORM EDT-AKY-GDO.
       FIN-EDT-KEY-GDO.
           EXIT.
       
       EDT-IKY-GDO SECTION.
       INI-EDT-IKY-GDO.
           IF GDO-IIC-GTIA-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-IIC-GTIA-LEN IN GDO-FLD
                GO TO FIN-EDT-IKY-GDO.
           MOVE GDO-IIC-GTIA IN GDO-FLD TO GDO-IIC-GTIA-EDT IN GDO-EDT.
           MOVE GDO-IIC-GTIA-EDT IN GDO-EDT TO 
                GDO-IIC-GTIA-ALF IN GDO-FLD.
           IF GDO-NUM-IGDO-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-NUM-IGDO-LEN IN GDO-FLD
                GO TO FIN-EDT-IKY-GDO.
           MOVE GDO-NUM-IGDO IN GDO-FLD TO GDO-NUM-IGDO-EDT IN GDO-EDT.
           MOVE GDO-NUM-IGDO-EDT IN GDO-EDT TO 
                GDO-NUM-IGDO-ALF IN GDO-FLD.
       FIN-EDT-IKY-GDO.
           EXIT.
       
       EDT-MKY-GDO SECTION.
       INI-EDT-MKY-GDO.
       FIN-EDT-MKY-GDO.
           EXIT.
       
       EDT-AKY-GDO SECTION.
       INI-EDT-AKY-GDO.
       FIN-EDT-AKY-GDO.
           EXIT.
       
       EDT-FLD-GDO SECTION.
       INI-EDT-FLD-GDO.
           IF GDO-NUM-SEVE-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-NUM-SEVE-LEN IN GDO-FLD
                GO TO FIN-EDT-FLD-GDO.
           MOVE GDO-NUM-SEVE IN GDO-FLD TO GDO-NUM-SEVE-EDT IN GDO-EDT.
           MOVE GDO-NUM-SEVE-EDT IN GDO-EDT TO 
                GDO-NUM-SEVE-ALF IN GDO-FLD.
           IF GDO-SGV-TINT-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-SGV-TINT-LEN IN GDO-FLD
                GO TO FIN-EDT-FLD-GDO.
           MOVE GDO-SGV-TINT IN GDO-FLD TO GDO-SGV-TINT-EDT IN GDO-EDT.
           MOVE GDO-SGV-TINT-EDT IN GDO-EDT TO 
                GDO-SGV-TINT-ALF IN GDO-FLD.
           IF GDO-SGV-TCGT-LEN IN GDO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDO-SGV-TCGT-LEN IN GDO-FLD
                GO TO FIN-EDT-FLD-GDO.
           MOVE GDO-SGV-TCGT IN GDO-FLD TO GDO-SGV-TCGT-EDT IN GDO-EDT.
           MOVE GDO-SGV-TCGT-EDT IN GDO-EDT TO 
                GDO-SGV-TCGT-ALF IN GDO-FLD.
       FIN-EDT-FLD-GDO.
           EXIT.
