       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   BGLPQGDG.
       AUTHOR.       BEE.
       DATE-WRITTEN. 15-Jan-19 05:25 PM.

      * NOMBRE PROGRAMA                   BGLPQGDG
      * VERSION PGM                       3.1
      * VERSION SKL                       07.08.21
      * OPCION                            CON
      * ARCHIVO BASE                      BGLGDG
      * PANTALLA                          BGLGDG
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *<<<<
      **************************************************************    
      * MANTENCIONES:                                                   
      * AFRI-INI/SEP2009: NO VALIDA EXISTENCIA DE GSO PARA COMANDO      
      *                   MST.                                          
      **************************************************************    
      *>>>>
      *>>>>
      *-------------------------------------------------------------
      * PROYECTO: ADMINISTRACION DE PRENDAS WARRANTS
      * OBJETIVO: ALERTA GARANTIA VENCIDA
      * FECHA   : 19-OCT-2012
      * AUTOR   : BEE-TEAM (PVC)
      * ETIQUETA: PVC-INI 19-OCT-2012 - ADMINISTRACION PRENDAS WARRANTS
      *-------------------------------------------------------------
      *-------------------------------------------------------------
      *  AUTOR      : BEE-MPS-AFRI
      *  FECHA      : JUN-2017
      *  ETIQUETA   : *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *  PROYECTO   : ARCHIVO CON REVALORIZACIONES DE GARANTIAS FASE 2
      *  OBJETIVO   : GRABAR LOG DE COMANDO ING EN ENTIDAD GNS-LGN
      *-----------------------------------------------------------------      

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-BGLPQGDG-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$BGLPQGDG$ SKL=$07.08.21$ VSN=$06.06.22$        
      -    'GEN=$15-Jan-19 05:25 PM$ FNC=$OWFBGL$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<<  LDC_SI AND PGM_MVS AND FIN_SCR_VARI                        
       COPY LDCWGENG.                                                   
           03 SCR-CLF     VALUE SPACES            PIC X(64).            
           03 SCR-LDC     VALUE SPACES            PIC X(100).           
           03 SCR-ARG     VALUE SPACES            PIC X(50).            
      *>>>>                                                             
                                                                        
      *<<<< CMAVARI OF PGMMAN                                           
           03 CMA-VARI.                                                 
              05 WSS-IND-CMUL                       PIC X(01).          
              05 GAR-CIC-OFIC     VALUE '0000'      PIC X(04).          
              05 SCR-IND-MGDD     VALUE SPACES      PIC X(01).          
                 88 MULTIPLES-GDD      VALUE 'M'.                       
                                                                        
              05 DBC-KEY-IDBC.                                          
                 07 DBC-CAI-ICLI  VALUE SPACES      PIC X(04).          
                 07 DBC-IIC-ICLI  VALUE ZEROES      PIC 9(08).          
                                                                        
              05 CMA-IND-KPAD     VALUE SPACES      PIC X(01).          
              05 GAR-KEY-IGDD.                                          
                 07 GAR-CIC-DCLI  VALUE SPACES      PIC X(12).          
                 07 GAR-KEY-AGDD  VALUE SPACES      PIC X(12).          
      *>>>>                                                             
      *<<<< FIN_SCR_VARI                                                
              05 GAR-CAI-GTIA                        PIC X(04).         
              05 GAR-IIC-GTIA                        PIC X(08).         
              05 GAR-IND-GTAC                        PIC X(01).         
              05 GAR-IND-EGAP                        PIC X(01).         
              05 GAR-IND-SVTO                        PIC X(01).         
              05 GAR-SGV-PPCT                        PIC S9(03)V9(02).  
              05 GAR-SGV-PAJU                        PIC S9(03)V9(02).  
              05 WSS-EST-ANT                         PIC X(02).         
              05 WSS-ES1-1                           PIC X(02).         
              05 WSS-ES1-2                           PIC X(02).         
              05 WSS-ES1-3                           PIC X(02).         
              05 WSS-ES1-4                           PIC X(02).         
      *                                                                 
              05 CMA-IND-DAP                         PIC X(01).         
              05 FRM-CAI-IOPD                        PIC X(04).         
              05 FRM-IIC-IOPD                        PIC X(08).         
              05 SCR-IND-V001      VALUE SPACES      PIC X(01).         
              05 CMA-CIC-TGAR                        PIC X(06).         
              05 CMA-FEC-FAPE                        PIC X(08).         
              05 CMA-FEC-FTSN                        PIC X(08).         
              05 CMA-TIP-DOC                        PIC X(03).          
              05 CMA-DOC-SALD           VALUE 0     PIC 9(13)V99.       
      *                                                                 
              05 CNE-GDD-CIC-ICLI.                                      
                 07 CNE-DBC-CAI-ICLI                PIC X(04).          
                 07 CNE-DBC-IIC-ICLI                PIC X(08).          
              05 CNE-DBC-GLS-NOMC                   PIC X(50).          
              05 CNE-GDG-CIC-ICLI.                                      
                 07 CNE-GDG-CAI-ICLI                PIC X(04).          
                 07 CNE-GDG-IIC-ICLI                PIC X(08).          
              05 CNE-GDG-GLS-NOMP                   PIC X(50).          
              05 CMA-GLS-DISP                       PIC X(34).          
              05 WSS-ES2-ANT                        PIC X(02).          
      *MHM-INI 29-OCT-2003                                              
              05 CMA-CIC-UING                       PIC X(12).          
      *MHM-INI 29-OCT-2003                                              
      ********************************                                  
      *RET-STT-GDG. section aasteri                                     
      ********************************                                  
       01  SCR-VARI-RED REDEFINES SCR-VARI.                             
           03 SCR-DFH    OCCURS 1200 PIC X(01).                         
                                                                             
      *>>>>
       COPY BGLWIGDG.

       COPY BGLBRGDG.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<<
      *<<<< LDC_SI AND PGM_MVS AND WSS                                  
      *PTC-INI-MAN                                                      
      *PTC-SUB                                                          
       COPY BGLWXGDG.                                                   
       COPY BGLMXW01.                                                   
      *PTC-FIN-MAN                                                      
                                                                        
       COPY LDCWGPMP.                                                   
      *>>>> WSS           
                                                
                                                                        
      *<<<< WSS                                                         
      *<<<< WSS OF PGMMAN                                               
       01  PGM-VAR-ADIC.                                                
           03 PGM-STAT-ADIC.                                            
              05 PGM-STAT-GDD.                                          
                 88 PGM-STAT-GDD-NUL VALUE '  '.                        
                 07 PGM-STT1-GDD        VALUE '2' PIC X(01).            
                    88 PGM-STAT-GDD-OKS VALUE '0'.                      
                 07 PGM-STT2-GDD        VALUE '3' PIC X(01).            
                                                                        
      *                                                                 
       01  WSS-VARI-GDG.                                                
           03 WSS-IND-ECRS             PIC X(01).                       
           03 WSS-IND-ECRT             PIC X(01).                       
      *                                                                 
       01  WSS-BUS-VARI.                                                
           03 WSS-IBUS                 VALUE 0      PIC 9(01).          
           03 WSS-IBUS-GDG           VALUE 0      PIC 9(01).            
       01  WSS-GDD-VARI.                                                
              03 WSS-MGDD              VALUE 0      PIC 9(01).          
                 88 WSS-MISMO-GDD      VALUE 0.                         
                 88 WSS-OTRO-GDD       VALUE 1.                         
                 88 WSS-PRIMER-GDD     VALUE 2.                         
              03 WSS-MISMO               VALUE 0    PIC 9(01).          
              03 WSS-OTRO                VALUE 1    PIC 9(01).          
              03 WSS-PRIMER              VALUE 2    PIC 9(01).          
                                                                        
      *COPY SGCWGICB.                                                   
       COPY SGCBRDBC.                                                   
       COPY BGLBRGDD.                                                   
      *MHM-INI 30-JUL-2003                                              
       COPY BGLBRGDO.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDO-REQA==.        
       COPY COLBROPC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
       COPY COLBRDLC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.        
      *MHM-FIN 30-JUL-2003                                              
      *<<<< PGM_PU OR NOT NO_CIC_PQ                                     
       COPY GNSBRCIC.                                                   
       COPY GNSWGCIC.                                                   
      *<<<< PGM_DTC                                                     
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.        
      *>>>>                                                             
      *>>>>                                                             
      *<<<< UNS_FLD                                                     
       COPY GNSWGCPT.                                                   
       COPY GNSWGSTR.                                                   
      *>>>>                                                             
      *<<<< PGM_DTC                                                     
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
      *>>>>                                                             
      *>>>>                                                             
       01  WSS-VARI.                                                    
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           03 WSS-CTE-ALZ      VALUE 'ALZ'                  PIC X(03).
           03 WSS-CTE-M1           VALUE -1                PIC S9(01).
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2

           03 WSS-ANT                                   PIC X(02).      
           03 WSS-MARC-4                                PIC X(01).      
           03 WSS-CIC-ICLI-GDG.                                         
              05 WSS-CAI-ICLI                           PIC X(04).      
              05 WSS-IIC-ICLI                           PIC X(08).      
           03  WSS-IND-EXI-GDO                          PIC X(01).      
           03  WSS-ALZ-DAP           VALUE SPACES       PIC X(01).      
           03  WSS-FEC-ULT-ACT                          PIC X(08).      
           03  WSS-IND-CCAD                             PIC X(01).      
           03  WSS-NUM-TIPO-ALF                         PIC X(06).      
           03  WSS-NUM-TIPO  REDEFINES WSS-NUM-TIPO-ALF PIC 9(06).      
           03  WSS-KEY-IGDG.                                            
               05 WSS-CAI-GTIA                          PIC X(04).      
               05 WSS-IIC-GTIA                          PIC X(08).      
           03  WSS-FRM-MENS.                                            
               05 WSS-FRM-MENS1                         PIC X(21).      
               05 WSS-FRM-MENS2                         PIC X(12).      
           03  WSS-FRM-IIC-IOPD      VALUE SPACES       PIC X(18).      
      *<<<< FMT_IDC                                                     
           03 WSS-COD-CGTA.                                             
               05 WSS-TIP-CGTA                          PIC X(03).      
               05 WSS-STP-CGTA                          PIC X(03).      
      *<<<< GEN_BCI                                                     
           03  WSS-FEC-FVTO.                                            
               05 WSS-NUM-SVTO                          PIC X(02).      
               05 WSS-NUM-AVTO                          PIC X(02).      
               05 WSS-NUM-MVTO                          PIC X(02).      
               05 WSS-NUM-DVTO                          PIC X(02).      
                                                                        
      * EVA-INI  12/08                                                  
           03 WSS-COD-OFIC          VALUE SPACES        PIC X(03).      
           03 WSS-IND-OCEN          VALUE SPACES        PIC X(03).      
      * EVA-FIN  12/08                                                  
           03  WSS-CIC-CTAB         VALUE SPACES        PIC X(03).      
           03 WSS-IND-ALZA          VALUE SPACES        PIC X(03).      
           03 WSS-FIO-STAT-BKP      VALUE SPACES        PIC X(02).      
      *MHM-INI 23-OCT-2003                                              
           03 WSS-GLS-CGTA.                                             
              05 WSS-GLS-TOPE                   PIC X(40).              
              05 WSS-GLS-SOPE                   PIC X(40).              
      *MHM-FIN 23-OCT-2003                                              
      *MHM-INI 03-DIC-2003                                              
           03 WSS-IND-EGAP          VALUE SPACES       PIC X(01).       
           03 WSS-IND-GAPB          VALUE SPACES       PIC X(01).       
      *MHM-FIN 03-DIC-2003                                              
           03 WSS-IND-TVSN          VALUE SPACES       PIC X(01).       
                                                                        
       COPY BGLWGDAP.                                                   
       COPY DAPBROPD.                                                   
       COPY DAPBRRCC.                                                   
                                                                        
      *********************************************                     
      *           MODULO   USPC113                *                     
      *********************************************                     
      *       DEFINICION IDENTIFICACION TS        *                     
      *********************************************                     
                                                                        
       01  UIB.                                                         
           02  FILLER                  PIC X(32) VALUE 'USPR002'.       
       01  USP-LARGO-TS                PIC S9(4) COMP VALUE +150.       
       01  USP-IDENTIFICACION.                                          
           05  USP-TERMINAL            PIC X(04).                       
           05  USP-OPID-USU            PIC X(03).                       
           05  FILLER                  PIC X(01)  VALUE ' '.            
       01  USP-LLENA-VECTOR            PIC X(1)   VALUE ' '.            
       01  USP-USA-VECTOR              PIC X(1)   VALUE ' '.            
                                                                        
      *********************************************                     
      *       DEFINICION AREA DE TRASPASO         *                     
      *********************************************                     
                                                                        
       01  AREA-TRASPASO.                                               
           05  USP-PERMISO             PIC X(01).                       
           05  USP-PTA-NUM             PIC 9(03)  VALUE 0.              
           05  USP-PTA-STR             PIC X(12)  VALUE SPACES.         
           05  USP-AREA-COMUN.                                          
               10  USP-TIPO-USUARIO.                                    
                   15  USP-IDENT-TU    PIC X(03).                       
      *                TIPO DE USUARIO                                  
                                                                        
                   15  USP-MODO-OP     PIC X(01).                       
      *                MODO OPERACION (CONSULTA/ACTUALIZACION)          
                                                                        
               10  USP-SISTEMA.                                         
                   15  USP-IDENT-SIS   PIC X(03).                       
      *                IDENTIFICACION DEL SISTEMA QUE SE ESTA PROCE_    
      *                SANDO SEGUN USUARIOS Y PRIVILEGIOS               
                                                                        
                   15  USP-GRUPO       PIC X(03).                       
      *                IDENTIFICACION DEL GRUPO DE SISTEMA QUE SE ESTA  
      *                PROCESANDO SEGUN USUARIOS Y PRIVILEGIOS          
      *                                                                 
                                                                        
               10  USP-INDIC-PROCESO   PIC X(01).                       
      *            INDICADOR DE SISTEMA USUARIO Y PRIVILEGIO  ACTIVO    
                                                                        
               10  USP-COD-OFICINA     PIC X(03).                       
      *            CODIGO DE LA OFICINA DEL USUARIO                     
                                                                        
               10  USP-COD-DEPTO       PIC X(03).                       
      *            CODIGO DEL DEPTO DEL USUARIO                         
                                                                        
               10  USP-COD-USUARIO     PIC X(12).                       
      *            CODIGO USUARIO (TABLA USR)                           
                                                                        
               10  USP-COD-TERMINAL    PIC X(04).                       
      *            CODIGO DE TERMINAL                                   
                                                                        
               10  USP-OPID            PIC X(03).                       
      *            OPID DE USUARIO                                      
                                                                        
               10  USP-FECHA.                                           
      *            FECHA                                                
                   15  USP-ANO         PIC X(02).                       
                   15  USP-MES         PIC X(02).                       
                   15  USP-DIA         PIC X(02).                       
                                                                        
               10  USP-HORA            PIC X(06).                       
      *            HORA                                                 
                                                                        
               10  USP-PASSWORD        PIC X(08).                       
      *            PASSWORD DE USUARIO(SOLO PARA CONECCION VIA RUTINA)  
                                                                        
               10  USP-INDICADORES.                                     
                   15  USP-USU-CMN1    PIC X(01).                       
      *            1   */CON       CONSULTA                             
      *            2   */MAN       CONSULTA Y MANTENCION                
      *            3   */*         TODO                                 
      *                                                                 
                   15  USP-USU-CMN2    PIC X(01).                       
      *            P   *           PERMISO AL MENU                      
      *                                                                 
                   15  USP-USU-CMN3    PIC X(01).                       
      *            P   */OFI       OTRAS OFICINAS                       
      *                                                                 
                   15  USP-USU-CMN4    PIC X(01).                       
                   15  USP-USU-CMN5    PIC X(01).                       
                   15  USP-USU-CMN6    PIC X(01).                       
                   15  USP-USU-CMN7    PIC X(01).                       
                   15  USP-USU-CMN8    PIC X(01).                       
                   15  USP-USU-CMN9    PIC X(01).                       
                   15  USP-USU-CMN10   PIC X(01).                       
                   15  USP-USU-CMN11   PIC X(01).                       
                   15  USP-USU-CMN12   PIC X(01).                       
                   15  USP-USU-CMN13   PIC X(01).                       
                   15  USP-USU-CMN14   PIC X(01).                       
                   15  USP-USU-CMN15   PIC X(01).                       
                   15  USP-USU-CMN16   PIC X(01).                       
               10  USP-INDICADORES-RED REDEFINES USP-INDICADORES.       
                   15  USP-USU-CMN-ARR OCCURS 16 TIMES   PIC X(01).     
      *                                                                 
      *            INDICADORES QUE  INDICAN PRIVILEGIO DE USUARIOS      
      *                                                                 
               10  FILLER              PIC X(78).                       
      *            DISPONIBLE USO FUTURO                                
      *                                                                 
      *********************************************                     
      *     AREAS PARA LECTURA DE TABLA "STR"     *                     
      *********************************************                     
      *                                                                 
      *01  COPYDD USP-R-STR.USP-E-STR01(PROD).                          
       01  USP-E-STR01.                                                 
           02  USP-CLV-STR-1.                                           
               03  USP-COD-GST     PICTURE X(3).                        
               03  USP-COD-STR     PICTURE X(12).                       
           02  USP-COD-PTA         PICTURE X(3).                        
      *                                                                 
       01  REQ-AREA.                                                    
               05  COD-CMND            PIC X(005).                      
               05  NOM-TABL            PIC X(003).                      
               05  NOM-CLAV            PIC X(005).                      
               05  RET-CODI            PIC X(002).                      
               05  RET-INTE            PIC X(001).                      
               05  NUM-BASE            PIC S9(004) COMP VALUE +120.     
               05  NOM-REGI            PIC X(007).                      
               05  FILLER              PIC X(025).                      
               05  MAX-CONT            PIC S9(004) COMP.                
               05  NOM-CONT            PIC S9(004) COMP.                
               05  FILLER              PIC X(022).                      
               05  VAL-CLAV.                                            
                   10  FECHA           PIC 9(008).                      
                   10  HORA            PIC 9(006).                      
      *                                                                 
       01  ELEM-LIST.                                                   
               05  NOM-ELEM            PIC X(011).                      
               05  SEC-CODI            PIC X(001).                      
               05  FILLER              PIC X(005) VALUE SPACES.         
      *                                                                 
       01  REQ-AREA-STR.                                                
               05  COD-CMND-STR        PIC X(005).                      
               05  NOM-TABL-STR        PIC X(003).                      
               05  NOM-CLAV-STR        PIC X(005).                      
               05  RET-CODI-STR        PIC X(002).                      
               05  RET-INTE-STR        PIC X(001).                      
               05  NUM-BASE-STR        PIC S9(004) COMP VALUE +120.     
               05  NOM-REGI-STR        PIC X(007).                      
               05  FILLER              PIC X(025).                      
               05  MAX-CONT-STR        PIC S9(004) COMP.                
               05  NOM-CONT-STR        PIC S9(004) COMP.                
               05  FILLER              PIC X(022).                      
               05  VAL-CLAV-STR.                                        
                   10  USP-COD-GST     PIC X(003).                      
                   10  USP-COD-STR     PIC X(012).                      
      *                                                                 
       01  ELEM-LIST-STR.                                               
               05  NOM-ELEM-STR        PIC X(011).                      
               05  SEC-CODI-STR        PIC X(001).                      
               05  FILLER              PIC X(005) VALUE SPACES.         
      *                                                                 
      *********************************************                     
      *           FIN   MODULO   USPC113          *                     
      *********************************************                     
                                                                        
      *>>>>                                                             
      *>>>>                                                             
       01  WSS-FRM-MEN2.                                                
           03 WSS-CAI-MEN2                  PIC X(04).                  
           03 WSS-BLK1       VALUE SPACES   PIC X(03).                  
           03 WSS-NUM-MEN2                  PIC 9(08).                  
           03 WSS-BLK2       VALUE SPACES   PIC X(24).                  
      *<<<< PGM_MEX                                                     
       COPY BGLBRGSL.                                                   
       COPY BGLBRGSO.                                                   
      *>>>>                                                             
      *<<<< PGM_VMS OR PGM_DTC                                          
       COPY BGLBRGMO.                                                   
       COPY BGLBRTAG.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GMO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GAP-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GLE-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIN-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDP-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSE-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSI-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GTP-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GUB-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSL-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVE-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIM-REQA==.    
      *<<<< PGM_VSI OR PGM_DB2                                          
       COPY BGLBRGAP.                                                   
       COPY BGLBRGDP.                                                   
       COPY BGLBRGES.                                                   
       COPY BGLBRGIN.                                                   
       COPY BGLBRGLE.                                                   
       COPY BGLBRGSE.                                                   
       COPY BGLBRGSI.                                                   
       COPY BGLBRGTP.                                                   
       COPY BGLBRGUB.                                                   
       COPY BGLBRGVT.                                                   
       COPY BGLBRGIM.                                                   
       COPY BGLBRGVE.
      *MPB-INI  03-NOV-2017 Correccion Liquidacion DPI
       COPY DAPBRCAD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAD-REQA==.
       COPY DAPBREPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EPD-REQA==.
      *MPB-FIN
      *>>>>                                                             
      *<<<< PGM_PU OR PGM_PQ                                            
       COPY BGLWGVCG.                                                   
      *<<<< GEN_BCI                                                     
       COPY BGLWGIDP.                                                   
      *>>>>                                                             
      *<<<< NOT ( PGM_VSI OR PGM_DB2 )                                  
       COPY BGLWGELI.                                                   
      *>>>>                                                             
       01  WSS-VARI-ADI.                                                
           03 WSS-REG                             PIC X(03).            
           03 WSS-COD-CTA.                                              
              05 WSS-COD-CGTA                     PIC X(03).            
              05 WSS-VCB.                                               
                 07 WSS-TIP-VCB                   PIC X(01).            
                 07 WSS-COD-VCB                   PIC X(03).            
                 07 WSS-TIP-CMB                   PIC X(02).            
                                                                        
      *>>>>                                                             
      *>>>>                                                             
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-GDG.
                 88 PGM-STAT-GDG-NUL    VALUE '  '.
                 07 PGM-STT1-GDG        VALUE '2' PIC X(01).
                    88 PGM-STAT-GDG-OKS VALUE '0'.
                 07 PGM-STT2-GDG        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
      *<<<< FIN_PGM_STAT                                                         
      *>>>>
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).
           03 PGM-CMMA.
              05 PGM-CMMA-CHR OCCURS 1200 PIC X(01).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 DFH-CMMA OCCURS 1200 PIC X(01).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO GDG-FLD.
           MOVE LOW-VALUES TO GDG-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +1200 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'BGLPQGDG' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< LDC_SI AND PGM_MVS AND INI_FIO AND PGM_BMS                  
      *<<<< GEN_BCI                                                     
      *PTC ini                                                          
           PERFORM GNS-ERR-QUE.                                         
      *PTC fin                                                          
      *LOP-INI 12-12-2002                                               
           MOVE SPACES TO WSS-IND-ALZA IN WSS-VARI.                     
           IF SCR-CMND = 'ALS'                                          
              MOVE 'ALZ' TO SCR-CMND                                    
              MOVE 'ALS' TO WSS-IND-ALZA IN WSS-VARI.                   
      *LOP-FIN 12-12-2002                                               
           IF SCR-CMND = 'ALZ'                                          
               MOVE 'BGL'       TO FIO-SIST                             
               MOVE 'VSN '      TO TAB-COD-TTAB IN TAB                  
               MOVE 'ALZDAPESP' TO TAB-COD-CTAB IN TAB                  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF FIO-STAT-OKS                                          
                   MOVE TAB-IND-VIGE IN TAB TO WSS-ALZ-DAP IN WSS-VARI  
               ELSE                                                     
                   MOVE 'N' TO WSS-ALZ-DAP IN WSS-VARI.                 
      *>>>>                                                             
      *<<<< LDC_SI AND PGM_IBM AND INI_FIO AND PGM_BMS                  
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
              MOVE WSS-IDX-IGDG TO SCR-IPRO                             
           ELSE                                                         
      *<<<< ISP-FIN  24-JAN-1996 11:35:48                               
           IF SCR-DESDE-CMN                                             
               MOVE SPACES TO SCR-VEC-ENG                               
               MOVE 1 TO SCR-IPRO                                       
               GO TO FIN-INI-FIO.                                       
                                                                        
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC                          
               MOVE WSS-INST-NULL TO SCR-INST-EXT                       
               MOVE 'GNS' TO MSG-COD-SIST                               
               MOVE 'FLDING' TO MSG-COD-MENS                            
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO SCR-MENS-EXT                        
               PERFORM ING-FPEN-CIC.                                    
       FIN-INI-FIO.                                                     
      *>>>>                                                             
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       GNS-BUS-VCA SECTION.
       INI-GNS-BUS-VCA.
           MOVE 0 TO FRM-IFLD.
       LUP-GNS-BUS-VCA.
           ADD 1 TO FRM-IFLD.
           IF FRM-IFLD NOT > EIBCALEN AND
              FRM-IFLD NOT > 1200
                MOVE DFH-CMMA(FRM-IFLD) TO PGM-CMMA-CHR(FRM-IFLD)
                GO TO LUP-GNS-BUS-VCA.
           MOVE PGM-CMMA TO SCR-VARI.
       FIN-GNS-BUS-VCA.
           EXIT.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-GDG.
           PERFORM EDT-KEY-GDG.
           PERFORM EDT-FLD-GDG.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-MOD.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_MOD                                                 
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR              
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND           
              SCR-STAT = SCR-STAT-CON                                   
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG.                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM RST-STAT                                         
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY                     
               IF SCR-STAT NOT = SCR-STAT-ABT                           
                   PERFORM SCR-TRL                                      
               ELSE                                                     
                   PERFORM DESSCRTRL                                    
                   GO TO FIN-SCR-MOD.                                   
      *>>>>                                                             
       MSG-SCR-MOD.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       BRW-SCR-MOD SECTION.
       INI-BRW-SCR-MOD.
       FIN-BRW-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-GDG
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
      *PTC-INI
                        MOVE 'S' TO SCR-IERR
      *PTC-FIN
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC                                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG                                  
               PERFORM RST-STAT                                         
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY                     
               IF SCR-STAT NOT = SCR-STAT-ABT                           
                   PERFORM SCR-TRL                                      
               ELSE                                                     
                   PERFORM DESSCRTRL                                    
                   GO TO FIN-SCR-ACC.                                   
      *>>>>                                                             
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ELI.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ELI                                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG                                  
               PERFORM RST-STAT                                         
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY                     
               IF SCR-STAT NOT = SCR-STAT-ABT                           
                   PERFORM SCR-TRL                                      
               ELSE                                                     
                   PERFORM DESSCRTRL                                    
                   GO TO FIN-SCR-ELI.                                   
      *>>>>                                                             
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       BRW-SCR-ELI SECTION.
       INI-BRW-SCR-ELI.
       FIN-BRW-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF FIO-STAT-OKS
                            MOVE SCR-ACTU-MOD TO SCR-ACTU
                            PERFORM PUT-SCR
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FIO-STAT-EOF
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGEOF    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                        IF FIO-STAT = FIO-STAT-NEX
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGNEX    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                            MOVE SCR-ACTU-ING TO SCR-ACTU
      *JSS                  PERFORM CLR-FLD-GDG
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACT
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACT.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACT                                                 
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR              
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND           
              SCR-STAT = SCR-STAT-CON                                   
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG.                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM RST-STAT                                         
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY                     
               IF SCR-STAT NOT = SCR-STAT-ABT                           
                   PERFORM SCR-TRL                                      
               ELSE                                                     
                   PERFORM DESSCRTRL                                    
                   GO TO FIN-SCR-ACT.                                   
      *>>>>                                                             
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACT.
           EXIT.

       BRW-SCR-ACT SECTION.
       INI-BRW-SCR-ACT.
       FIN-BRW-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF FRM-STAT-ABT
                    MOVE SPACES TO FRM-MENS
                    PERFORM SCR-MSSG
                    PERFORM DESSCRTRL
                    GO TO FIN-SCR-PGM
                ELSE
                    MOVE SPACES TO FRM-MENS
                    PERFORM FND-KEY
                    IF FIO-STAT = FIO-STAT-NEX
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGNEX    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                    ELSE
                        MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                        PERFORM SCR-TRL
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       BRW-SCR-PGM SECTION.
       INI-BRW-SCR-PGM.
       FIN-BRW-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-GDG
               PERFORM EDT-KEY-GDG
               PERFORM EDT-FLD-GDG
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-GDG
               PERFORM EDT-KEY-GDG
           ELSE
               PERFORM CLR-FLD-GDG
               PERFORM EDT-FLD-GDG.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-GDG.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO GDG-FLD.
           MOVE LOW-VALUES TO GDG-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *>>>>
      * EVA-INI  12/08                                                  
           MOVE GDG-COD-OFIC IN GDG-FLD TO WSS-COD-OFIC IN WSS-VARI.    
      * EVA-FIN  12/08                                                  
      * EVA-INI-AFRI/ENERO2006                                          
           IF SCR-CMND = 'MST'                                          
              MOVE GDG-CAI-GTIA IN GDG-FLD TO                           
                   GDG-CAI-GTIA IN GDG                                  
              MOVE GDG-IIC-GTIA IN GDG-FLD TO                           
                   GDG-IIC-GTIA IN GDG                                  
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM BGL-FIO-GDG                                       
              IF NOT (FIO-STAT-OKS                                      
                 AND GDG-IND-EST1 IN GDG  = '05')                       
                  MOVE 'GDGNOTRAMITE' TO MSG-COD-MENS                   
      **AFRI-INI/SEP2009                                                
                  GO TO ERR-FND-KEY.                                    
      *       ELSE                                                      
      *           PERFORM VAL-IND-GSO                                   
      *           IF MSG-COD-MENS > SPACES                              
      *               GO TO ERR-FND-KEY.                                
      **AFRI-INI/SEP2009                                                
      * EVA-FIN-AFRI/ENERO2006                                          
      *<<<< EVP-INI INGFNDKEY                                           
      *<<<< GEN_BCI                                                     
      *CGL-INI 07-06-2003                                               
      * CODIGO AGREGADO PARA M:N                                        
           IF SCR-CCPP = 'ING'                                          
               IF GDG-IIC-GTIA IN GDG-FLD > ZEROES                      
                   MOVE 1 TO WSS-IBUS-GDG                               
                   MOVE GDG-CAI-GTIA IN GDG-FLD TO                      
                        GDG-CAI-GTIA IN GDG                             
                   MOVE GDG-IIC-GTIA IN GDG-FLD TO                      
                        GDG-IIC-GTIA IN GDG                             
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM BGL-FIO-GDG                                  
                   IF FIO-STAT-OKS                                      
      *<<<< NOT ING_SBR_HIJ                                             
      *            se encontro el hijo : error                          
      *            no ingresa sobre el hijo encontrado                  
                       MOVE '00' TO PGM-STAT-GDG                        
                       MOVE 'GDG    EXT' TO MSG-COD-MENS                
                       GO TO ERR-FND-KEY                                
                   ELSE                                                 
                       MOVE '23' TO FIO-STAT                            
                       GO TO FIN-FND-KEY                                
      *>>>>                                                             
                 ELSE                                                   
                   PERFORM FND-DIRECTO                                  
                   GO TO FIN-FND-KEY.                                   

      *PVC-INI 19-OCT-2012  -  ADMINISTRACION PRENDAS WARRANTS 
           PERFORM GET-FHOY                                             
           MOVE GDG-CAI-GTIA IN GDG-FLD TO                              
                GDG-CAI-GTIA IN GDG                                     
           MOVE GDG-IIC-GTIA IN GDG-FLD TO                              
                GDG-IIC-GTIA IN GDG                                     
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM BGL-FIO-GDG                                          
           IF FIO-STAT-OKS                                              
               IF GDG-FEC-FVTO IN GDG < HOY-FHOY AND
                 ( GDG-IND-EST1 IN GDG > '09' AND
                   GDG-IND-EST1 IN GDG < '20' )
                   MOVE 'BGL'        TO MSG-COD-SIST
                   MOVE 'GDGVEN    ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00' TO FIO-STAT.
      *>>>>
      *PVC-FIN 19-OCT-2012
      *>>>>                                                             
      * CODIGO AGREGADO PARA M:N                                        
                                                                        
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE 0      TO WSS-IBUS.                                     
           MOVE 0      TO WSS-IBUS-GDG.                                 
           MOVE '23'   TO PGM-STAT-GDD.                                 
                                                                        
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND           
                GAR-KEY-AGDD IN CMA-VARI > SPACES                       
                PERFORM LEE-NXT-PRV-XGDD                                
                IF WSS-IBUS = 3                                         
                   PERFORM SCR-CLRA-GDG                                 
                   GO TO EXA-COM-STAT                                   
                ELSE                                                    
                   MOVE PGM-SNUL TO PGM-STAT-GDG                        
                   MOVE PGM-SNUL TO PGM-STAT-DBC                        
                   IF FRM-FFLD = FRM-FFLD-PF5                           
                       MOVE 'GDD    NOPRV' TO MSG-COD-MENS              
                       GO TO ERR-FND-KEY                                
                   ELSE                                                 
                       MOVE 'GDD    NONXT' TO MSG-COD-MENS              
                       GO TO ERR-FND-KEY                                
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5                   
               MOVE 'GDD    NEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF FRM-FFLD = FRM-FFLD-PF8                                   
              OR FRM-FFLD-PF7                                           
               PERFORM LEE-NXT-PRV-XDBC                                 
               IF WSS-IBUS = 1                                          
                   GO TO CON-BUS-DBC                                    
               ELSE                                                     
                   MOVE PGM-SNUL TO PGM-STAT-GDG                        
                   MOVE PGM-SNUL TO PGM-STAT-DBC                        
                   IF FRM-FFLD = FRM-FFLD-PF7                           
                       MOVE 'DBC    NOPRV' TO MSG-COD-MENS              
                       GO TO ERR-FND-KEY                                
                   ELSE                                                 
                       MOVE 'DBC    NONXT' TO MSG-COD-MENS              
                       GO TO ERR-FND-KEY.                               
           IF GDG-IIC-GTIA IN GDG-FLD > ZEROES AND                      
      *<<<< FMT_CHI                                                     
              DBC-NUM-ICLI IN GDG-FLD = ZEROES AND                      
      *>>>>                                                             
              DBC-GLS-NOMC IN GDG-FLD NOT > SPACES                      
                                                                        
               MOVE 'N' TO CMA-IND-KPAD IN CMA-VARI                     
               PERFORM FND-DIRECTO                                      
               IF FIO-STAT-OKS                                          
                   MOVE 2 TO WSS-IBUS                                   
      *            para buscar RPH y PAD                                
                   PERFORM GET-CUR-GDD                                  
                   IF FIO-STAT-OKS                                      
                       MOVE 3 TO WSS-IBUS                               
                       MOVE GDD-CIC-DCLI IN GDD TO DBC-KEY-IDBC IN DBC  
                        MOVE FIO-GET-KEY TO FIO-CMND                    
                        PERFORM SGC-FIO-DBC                             
                        MOVE FIO-STAT TO PGM-STAT-DBC                   
                        IF FIO-STAT-OKS                                 
                            GO TO EXA-COM-STAT                          
                        ELSE                                            
                            MOVE 'GDD    NODBC' TO MSG-COD-MENS         
                            GO TO EXA-COM-STAT                          
                   ELSE                                                 
                       MOVE 'GDD    NEX' TO MSG-COD-MENS                
                       GO TO EXA-COM-STAT                               
               ELSE                                                     
                   MOVE SPACES TO GAR-KEY-AGDD IN CMA-VARI              
                   MOVE SPACES TO GAR-CIC-DCLI IN CMA-VARI              
                   MOVE SPACES TO DBC-KEY-IDBC IN CMA-VARI              
                   MOVE 'GDG    NEX' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY.                                   
                                                                        
      *                                                                 
           MOVE SPACES TO GAR-KEY-AGDD IN CMA-VARI.                     
           MOVE SPACES TO GAR-CIC-DCLI IN CMA-VARI.                     
           MOVE SPACES TO DBC-KEY-IDBC IN CMA-VARI.                     
                                                                        
      *<<<< FMT_CHI                                                     
            IF DBC-NUM-ICLI IN GDG-FLD NOT = ZEROES                     
      *>>>>                                                             
               MOVE 'I' TO CMA-IND-KPAD IN CMA-VARI                     
               MOVE 1 TO WSS-IBUS                                       
               GO TO CON-BUS-DBC.                                       
           IF DBC-GLS-NOMC IN GDG-FLD > SPACES                          
      *NOM-CLI Busca Cliente por medio del Nombre                       
                                                                        
               MOVE 'N' TO CMA-IND-KPAD IN CMA-VARI                     
               MOVE DBC-GLS-NOMC IN GDG-FLD TO DBC-GLS-NOMC IN DBC      
               MOVE 'DBC-GLS-NOMC'   TO FIO-AKEY                        
               MOVE FIO-GET-NLS TO FIO-CMND                             
               PERFORM GET-CLI                                          
               IF MSG-COD-MENS NOT > SPACES                             
                   MOVE 1 TO WSS-IBUS.                                  
                                                                        
      * SI SE PROCESA SUBENTIDAD, LA BUSQUEDA POR LLAVE ALTERNATIVA     
      *  DEBE SER UN PARRAFO CON LOOP                                   
                                                                        
           IF WSS-IBUS = 0                                              
               MOVE 'DBC    NEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
       CON-BUS-DBC.                                                     
      *    se encontro el padre y busca el GDG                          
           MOVE '00' TO PGM-STAT-DBC.                                   
                                                                        
      * Para permitir Ant/Sig aunque padre no tenga operaciones         
           MOVE DBC-KEY-IDBC IN DBC TO DBC-KEY-IDBC IN CMA-VARI.        
                                                                        
      *    se digito tambien el hijo, se busca directamente GDD         
           IF GDG-IIC-GTIA IN GDG-FLD > ZEROES                          
              AND NOT (FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7)         
      *        Buscara Cliente por medio de NOM cuando PF7 O PF8        
               MOVE 'N' TO CMA-IND-KPAD IN CMA-VARI                     
               PERFORM GET-GDD                                          
               IF WSS-IBUS = 1                                          
                   MOVE 'GDD    NEX' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY                                    
               ELSE                                                     
               IF WSS-IBUS = 2                                          
                   MOVE 'GDG    NEX' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY                                    
               ELSE                                                     
      *            se encontro el hijo                                  
                   GO TO EXA-COM-STAT                                   
           ELSE                                                         
      *    no se digito el hijo, se busca el ultimo                     
               MOVE DBC-KEY-IDBC IN DBC TO GDD-CIC-DCLI IN GDD          
               MOVE '999999999999'      TO GDD-KEY-AGDD IN GDD          
               MOVE 'GDD-KEY-IGDD' TO FIO-AKEY                          
               MOVE FIO-GET-LEQ TO FIO-CMND                             
               PERFORM BGL-FIO-GDD                                      
               IF NOT (FIO-STAT-OKS AND                                 
                       DBC-KEY-IDBC IN DBC = GDD-CIC-DCLI IN GDD)       
                  MOVE 'GDD    NEX' TO MSG-COD-MENS                     
                  GO TO ERR-FND-KEY                                     
               ELSE                                                     
                MOVE 3 TO WSS-IBUS                                      
      *CGL-FIN 25-06-98                                                 
               PERFORM BUS-ULT-GDG                                      
               IF WSS-IBUS = 3                                          
      *            se encontro el hijo                                  
                   GO TO EXA-COM-STAT                                   
               ELSE                                                     
                   MOVE 'GDD    NEX' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY.                                   
                                                                        
       FND-DIRECTO.                                                     
           MOVE 1 TO WSS-IBUS-GDG.                                      
                                                                        
      *>>>> EVP-FIN BUSPADHIJ                                           
           PERFORM KEY-ALL-GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE GDG-STP-ITRN IN GDG TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-GDG.
      *<<<<
      * ISP INI  28-JAN-2004 13:37:42                                   
           IF SCR-HDR-MRCA = 'BCS' AND                                  
              NOT FIO-STAT-OKS AND                                      
              WSS-LEYO-GORI = 'N'                                       
                   MOVE 'S' TO WSS-LEYO-GORI                            
                   MOVE GDG-CIC-GTIA IN GDG TO GDG-COD-GORI IN GDG      
                   MOVE 'GDG-COD-GORI' TO FIO-AKEY                      
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM BGL-FIO-GDG                                  
                   IF FIO-STAT-OKS                                      
                       MOVE GDG-CAI-GTIA IN GDG TO                      
                            GDG-CAI-GTIA IN GDG-FLD                     
                       MOVE GDG-IIC-GTIA IN GDG TO                      
                            GDG-IIC-GTIA IN GDG-FLD                     
                       GO TO INI-FND-KEY.                               
                                                                        
       EXA-COM-STAT.                                                    
      * EVA-INI  12/08                                                  
                                                                        
           IF (SCR-HDR-MRCA = 'BCS')                                    
              PERFORM VAL-VSN                                           
              IF WSS-IND-TVSN IN WSS-VARI = 'S' AND                     
                 SCR-CMND NOT = 'CON' AND SCR-CMND NOT = 'ING'          
                 PERFORM VAL-CEN-GDG                                    
                 IF (GDG-COD-OFIC IN GDG NOT =                          
                     USR-COD-OFUS IN USR) AND                           
                     WSS-IND-OCEN IN WSS-VARI = 'N'                     
                     MOVE 'ERR MOD' TO MSG-COD-MENS                     
                     GO TO ERR-FND-KEY.                                 
      * EVA-FIN  12/08                                                  
      *<<<< EVP-INI FINFNDKEY                                           
                                                                        
           MOVE GDG-FEC-FTRN IN GDG TO SCR-UMOD.                        
           IF WSS-IBUS = 2 OR 3                                         
      *        se encontro el hijo                                      
               MOVE '00' TO PGM-STAT-GDG                                
               MOVE GDG-KEY-IGDG IN GDG TO GAR-KEY-AGDD IN CMA-VARI.    
                                                                        
           IF WSS-IBUS = 3                                              
      *        se encontro la relacion completa                         
               MOVE '00' TO PGM-STAT-GDD                                
               MOVE GDD-CIC-DCLI IN GDD TO GAR-CIC-DCLI IN CMA-VARI     
               MOVE '00' TO PGM-STAT-DBC                                
               MOVE GDD-CIC-DCLI IN GDD TO DBC-KEY-IDBC IN CMA-VARI     
           ELSE                                                         
      *       GDG incompleto                                            
               MOVE '23' TO PGM-STAT-GDD                                
               MOVE '23' TO PGM-STAT-DBC                                
               MOVE SPACES TO DBC-CAI-ICLI IN CMA-VARI                  
               MOVE ZEROES TO DBC-IIC-ICLI IN CMA-VARI                  
               MOVE DBC-KEY-IDBC IN CMA-VARI TO GAR-CIC-DCLI IN CMA-VARI
               GO TO ANL-GDG.                                           
                                                                        
      * Determina si tiene multiples padres para comando consulta       
           IF NOT ( SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON )      
               GO TO ANL-GDG.                                           
                                                                        
           MOVE SPACES TO MSG-COD-SIST.                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
                                                                        
      * Se posiciona por la llave del hijo                              
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
                                                                        
      *    Busca siguiente por la llave del hijo                        
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NXT TO FIO-CMND.                                
                                                                        
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS AND                                          
              GDG-KEY-IGDG  IN GDG = GDD-KEY-AGDD  IN GDD               
                MOVE 'M' TO SCR-IND-MGDD                                
      *<<<< GEN_BCI                                                     
                MOVE 'BGL'      TO MSG-COD-SIST                         
                MOVE 'GDGMDDIR' TO MSG-COD-MENS                         
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MEN2                           
      *>>>>                                                             
           ELSE                                                         
                MOVE SPACES TO SCR-IND-MGDD.                            
                                                                        
           IF FIO-STAT-OKS                                              
               MOVE 'GDD-KEY-AGDD' TO FIO-AKEY                          
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GDD.                                     
                                                                        
           MOVE GAR-CIC-DCLI IN CMA-VARI TO GDD-CIC-DCLI IN GDD.        
           MOVE GAR-KEY-AGDD IN CMA-VARI TO GDD-KEY-AGDD IN GDD.        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
                                                                        
       ANL-GDG.                                                         
       FIN-ANL-GDG.                                                     
                                                                        
                                                                        
           MOVE PGM-STAT-GDG TO FIO-STAT.                               
                                                                        
           IF SCR-CCPP = 'ACC' AND SCR-STPP = SCR-STAT-CON              
               GO TO FIN-FND-KEY.                                       
      *<<<< GEN_BCI                                                     
      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA                   
           IF SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON              
               GO TO FIN-VAL-OFI-USP-GDG.                               
           IF SCR-OFRM-SRV                                              
              GO TO FIN-VAL-OFI-USP-GDG.                                
                                                                        
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )        
               GO TO FIN-VAL-OFI-USP-GDG.                               
      *ALD-BCI-INI/07032000                                             
                                                                        
      **********************************                                
      *            MODULO  USPC143     *                                
      **********************************                                
       USP-CHEQUEO-TS.                                                  
           EXEC CICS HANDLE CONDITION                                   
                              QIDERR(USP-IR-MENU-GENERAL)               
           END-EXEC.                                                    
           EXEC CICS ASSIGN OPID(USP-OPID-USU)                          
           END-EXEC.                                                    
           MOVE EIBTRMID   TO USP-TERMINAL.                             
           EXEC CICS READQ TS QUEUE(USP-IDENTIFICACION)                 
                              INTO(USP-AREA-COMUN)                      
                              LENGTH(USP-LARGO-TS)                      
                              ITEM(+1)                                  
           END-EXEC.                                                    
           GO TO USP-INICIO-PROGRAMA.                                   
       USP-IR-MENU-GENERAL.                                             
           EXEC CICS XCTL PROGRAM('USDP930')                            
           END-EXEC.                                                    
       USP-INICIO-PROGRAMA.                                             
      ***************************************                           
      *            FIN  MODULO  USPC143     *                           
      ***************************************                           
      *                                                                 
           MOVE 'BGLGTUCG/CEN' TO USP-PTA-STR.                          
                                                                        
      ****************************************                          
      *             MODULO  USPC103          *                          
      ****************************************                          
           IF USP-PTA-STR = '*/*         ' THEN                         
            IF USP-USU-CMN-ARR(1) = '3' THEN                            
               MOVE 'P' TO USP-PERMISO                                  
            ELSE                                                        
               MOVE 'N' TO USP-PERMISO                                  
           ELSE                                                         
            IF USP-PTA-STR = '*/MAN       ' THEN                        
             IF USP-USU-CMN-ARR(1) NOT < '2' THEN                       
               MOVE 'P' TO USP-PERMISO                                  
             ELSE                                                       
               MOVE 'N' TO USP-PERMISO                                  
            ELSE                                                        
             IF USP-PTA-STR = '*/CON       ' THEN                       
              IF USP-USU-CMN-ARR(1) NOT < '1' THEN                      
                 MOVE 'P' TO USP-PERMISO                                
              ELSE                                                      
                 MOVE 'N' TO USP-PERMISO                                
             ELSE                                                       
              IF USP-PTA-STR = '*           ' THEN                      
                 MOVE USP-USU-CMN-ARR(2) TO USP-PERMISO                 
              ELSE                                                      
               IF USP-PTA-STR = '*/OFI       ' THEN                     
                 MOVE USP-USU-CMN-ARR(3) TO USP-PERMISO                 
               ELSE                                                     
                 MOVE 'S' TO USP-USA-VECTOR.                            
           IF USP-LLENA-VECTOR = 'S' OR USP-USA-VECTOR = 'S' THEN       
            IF  USP-PTA-NUM = ZEROS                                     
            THEN MOVE  USP-PTA-STR   TO   USP-COD-STR IN USP-E-STR01    
             MOVE  USP-PTA-STR   TO   USP-COD-STR IN REQ-AREA-STR       
             MOVE  USP-GRUPO     TO   USP-COD-GST IN USP-E-STR01        
             MOVE  USP-GRUPO     TO   USP-COD-GST IN REQ-AREA-STR       
             MOVE  'REDKY'       TO   COD-CMND-STR                      
             MOVE  'STR01'       TO   NOM-CLAV-STR  NOM-ELEM-STR        
             MOVE  'STR'         TO   NOM-TABL-STR                      
             CALL 'DBNTRY' USING UIB REQ-AREA-STR USP-E-STR01           
                                ELEM-LIST-STR                           
             IF RET-CODI-STR NOT = SPACES                               
                   MOVE  ' ' TO   USP-PERMISO                           
             ELSE                                                       
                   MOVE USP-COD-PTA IN USP-E-STR01 TO   USP-PTA-NUM     
                   EXEC CICS LINK PROGRAM ('USDR100')                   
                                COMMAREA (AREA-TRASPASO)                
                                LENGTH (166)                            
                   END-EXEC                                             
            ELSE                                                        
                   EXEC CICS LINK PROGRAM ('USDR100')                   
                                  COMMAREA (AREA-TRASPASO)              
                                  LENGTH (166)                          
                   END-EXEC.                                            
           MOVE  ZEROS  TO  USP-PTA-NUM.                                
           MOVE  SPACES TO  USP-PTA-STR.                                
           MOVE  SPACES TO  USP-USA-VECTOR.                             
      *                                                                 
      *                                                                 
      ****************************************                          
      *          FIN   MODULO  USPC103       *                          
      ****************************************                          
           IF USP-PERMISO = 'P'                                         
               GO TO FIN-VAL-OFI-USP-GDG.                               
      *    COPY USPC143.                                                
      *ALD-BCI-FIN/07032000                                             
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG                 
               MOVE 'USRNODEOFI' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
       FIN-VAL-OFI-USP-GDG.                                             
           MOVE PGM-STAT-GDG TO FIO-STAT.                               
      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA                   
      *>>>>                                                             
      * Garantia Alzada                                                 
           IF GDG-IND-EST1 IN GDG > '19'                                
               MOVE 'GDGALZ' TO MSG-COD-MENS                            
               GO TO ERR-FND-KEY.                                       
      *                                                                 
      *INI-AFRI/MAY-2005                                                
           IF SCR-CMND = 'ALC' AND GDG-CAI-GTIA IN GDG NOT = '0800'     
               MOVE 'CMNDALCINV' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-IND-EST1 IN GDG NOT = '05' AND                        
              SCR-CMND = 'ALC'                                          
               MOVE 'GDGNOALC' TO MSG-COD-MENS                          
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-IND-EST1 IN GDG = '07'                                
              IF NOT (SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON)     
                 MOVE 'GDG SOLO CON' TO MSG-COD-MENS                    
                 GO TO ERR-FND-KEY.                                     
      *FIN-AFRI/MAY-2005                                                
      *                                                                 
      * EVA-AFRI/MAYO2006                                               
           IF (SCR-CMND = 'AGA' OR SCR-CMND = 'ACE')                    
               MOVE SCR-STAT-SON TO SCR-STAT.                           
      * FIN-AFRI                                                        
           IF GDG-MSC-STAT IN GDG = 'E'                                 
               MOVE 'GDG   EXTING' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
      *                                                                 
      *<<<< GEN_BCI                                                     
      *MHM-INI 16-OCT-2003                                              
           IF SCR-CMND = 'EJE' AND GDG-COD-EST2 IN GDG = '10'           
               MOVE 'GDG    EJEYA' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-IND-GTAC IN GDG NOT = 'S' AND                         
              ( SCR-CMND = 'MOD' OR SCR-CMND = 'ELI' )                  
               MOVE FIO-STAT TO WSS-FIO-STAT-BKP                        
               MOVE GDG-CAI-GTIA IN GDG TO GSO-CAI-GTIA IN GSO          
               MOVE GDG-IIC-GTIA IN GDG TO GSO-IIC-GTIA IN GSO          
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GSO                                      
               IF FIO-STAT-OKS                                          
                   MOVE GSO-NUM-SBGL IN GSO TO GSL-NUM-SBGL IN GSL      
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM BGL-FIO-GSL                                  
                   IF FIO-STAT-OKS AND GSL-COD-ESOL IN GSL NOT < '05'   
                       MOVE 'GSLESOL>05' TO MSG-COD-MENS                
                       GO TO ERR-FND-KEY                                
                   ELSE                                                 
                       MOVE WSS-FIO-STAT-BKP TO FIO-STAT                
               ELSE                                                     
                   MOVE WSS-FIO-STAT-BKP TO FIO-STAT.                   
                                                                        
      *MHM-FIN 16-OCT-2003                                              
                                                                        
           IF GDG-MSC-STAT IN GDG = 'A' AND SCR-CMND = 'MGA'            
           OR GDG-MSC-STAT IN GDG = 'A' AND SCR-CMND = 'ALZ'            
           OR GDG-MSC-STAT IN GDG = 'A' AND SCR-CMND = 'EJE'            
                   GO TO FIN-FND-KEY.                                   
                                                                        
           IF GDG-MSC-STAT IN GDG = 'A'                                 
               MOVE 'GDG    AGAYA' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'MOD'            
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'AGA'            
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'ACE'            
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CCPP = 'ELI'            
      *INI-AFRI/MAY-2005                                                
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'ALC'            
           OR GDG-MSC-STAT IN GDG = 'I' AND SCR-CMND = 'MST'            
      *FIN-AFRI/MAY-2005                                                
                   GO TO FIN-FND-KEY.                                   
                                                                        
           IF GDG-MSC-STAT IN GDG = 'I'                                 
               MOVE 'GDG    NOAGA' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
      *>>>>                                                             
                                                                        
           IF GDG-MSC-STAT IN GDG = 'E'                                 
               MOVE 'GDG    EXTGD' TO MSG-COD-MENS                      
           ELSE                                                         
               MOVE 'GDG    NOEST' TO MSG-COD-MENS.                     
                                                                        
       ERR-FND-KEY.                                                     
           MOVE 'S' TO SCR-IERR.                                        
                                                                        
           IF WSS-IBUS = 0 AND WSS-IBUS-GDG = 0                         
      *        busco por padre y no encontro padre                      
               MOVE SPACES TO PGM-STAT                                  
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE '23' TO PGM-STAT-DBC                                
           ELSE                                                         
               MOVE 'BGL' TO MSG-COD-SIST.                              
                                                                        
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
                                                                        
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           MOVE '00' TO FIO-STAT.                                       
           IF FRM-FFLD = FRM-FFLD-PF6 OR                                
              FRM-FFLD = FRM-FFLD-PF5 OR                                
              SCR-CCPP = 'ING'                                          
               GO TO FIN-FND-KEY.                                       
                                                                        
           IF PGM-STAT-DBC-OKS                                          
      *        Despliega solo datos del DBC                             
                                                                        
               PERFORM SCR-CLRA-GDG                                     
               MOVE '23' TO FIO-STAT                                    
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PF8                                   
              OR FRM-FFLD-PF7                                           
               GO TO FIN-FND-KEY                                        
           ELSE                                                         
           IF PGM-STAT-GDG-OKS                                          
               MOVE PGM-SNUL TO PGM-STAT-GDG                            
               MOVE '23' TO FIO-STAT                                    
           ELSE                                                         
               MOVE '23' TO FIO-STAT.                                   
                                                                        
           MOVE 'S' TO SCR-IERR.                                        
           GO TO FIN-FND-KEY.                                           
      *>>>> EVP-FIN FINFNDKEY2                                          
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-GDG-OKS
               MOVE GDG-STP-ITRN IN GDG TO SCR-UMOD.
           PERFORM PUT-ALL-GDG.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *<<<< INI_SCR_PUTA AND GEN_BCI                                    
      *LOP-INI 12-12-2002                                               
           IF WSS-IND-ALZA IN WSS-VARI = 'ALS'                          
              MOVE 'ALS' TO SCR-CMND.                                   
      *LOP-FIN 12-12-2002                                               
      *>>>>                                                             
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE GDG-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO GDG-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-GDG
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO GDG-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-GDG.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-GDG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-GDG.
           PERFORM VAL-IKY-GDG.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-GDG.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-GDG.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-GDG.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-GDG.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-GDG.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-GDG
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO GDG-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-GDG.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-GDG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-GDG.
      *<<<< SCR_GIKY_VAL_IKY AND GEN_BCI                                
      *PTC-INI-MAN                                                      
           IF SCR-OFRM-SRV AND SCR-CMND = 'ING'                         
               MOVE 'BGL' TO FIO-SIST                                   
               MOVE 'VSN' TO TAB-COD-TTAB IN TAB                        
               MOVE '001' TO TAB-COD-CTAB IN TAB                        
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF NOT FIO-STAT-OKS OR                                   
                  TAB-IND-VIGE IN TAB NOT = 'S'                         
      *        FLB: version 'B'anco                                     
      *             MOVE 'B' TO SCR-IND-V001                            
                   MOVE SPACES TO MSG-COD-MENS                          
                   MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD     
      *AFRI-INI/MAYO2005                                                
                   IF SCR-HDR-MRCA = 'BCS'                              
                      MOVE '0800' TO GDG-CAI-GTIA IN GDG-FLD            
                   ELSE                                                 
                      MOVE '0500' TO GDG-CAI-GTIA IN GDG-FLD            
                   END-IF                                               
      *AFRI-FIN/MAYO2005                                                
                   MOVE 0  TO GDG-CAI-GTIA-LEN IN GDG-FLD               
                   MOVE -1 TO GDG-IIC-GTIA-LEN IN GDG-FLD.              
      *         ELSE                                                    
      *        FLB: version 'C'onsist                                   
      *             MOVE 'C' TO SCR-IND-V001.                           
                                                                        
      *PTC-FIN-MAN                                                      
      *>>>>                                                             
           PERFORM VAL-IKY-GDG.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-GDG.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-GDG.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-GDG.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
      *<<<< LDC_SI AND PGM_MVS AND (FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_
           IF FRM-FFLD = FRM-FFLD-PF3 AND                               
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
      *       AND SCR-IND-COL = 'C'                                     
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC                                  
           IF NOT                                                       
              ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD = FRM-FFLD-PF6 OR   
                FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD = FRM-FFLD-PF8 )    
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO GDG-GLS-MEN2
               MOVE SCR-PRMT     TO GDG-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO GDG-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO GDG-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE GDG-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO GDG-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-GDG

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO GDG-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO GDG-GLS-MENS.
           PERFORM PRO-MKY-GDG.
           PERFORM PRO-AKY-GDG.
           PERFORM UNP-IKY-GDG.
           PERFORM FST-KEY-GDG.
      *<<<< LDC_SI AND PGM_MVS AND FIN_HBL_IKY                          
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM HBL-KEY-GDG.                                     
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-STP.                       
                                                                        
           MOVE +0           TO GDG-CAI-GTIA-LEN IN GDG-FLD.            
      *<<<< FMT_CHI                                                     
           MOVE -1           TO GDG-TIP-CGTA-LEN IN GDG-FLD.            
      *>>>>                                                             
      *>>>>                                                             
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *<<<<
      *EVA-INI-AFRI/ENERO2006                                           
           IF SCR-CMND = 'MST'                                          
              MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-TIP-CGTA-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UBY TO GDG-STP-CGTA-ATR IN GDG-FLD          
              MOVE FRM-POS-CURS TO GDG-STP-CGTA-LEN IN GDG-FLD.         
      *EVA-FIN-AFRI/ENERO2006                                           
      *>>>>
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE GDG-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO GDG-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO GDG-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO GDG-GLS-MENS.
           PERFORM UNP-KEY-GDG.
           PERFORM FST-KEY-GDG.
      *<<<< FIN_HBL_KEY                                                 
           IF SCR-CCPP NOT = 'ING'                                      
      *<<<< FMT_CHI                                                     
               MOVE FRM-CPIM-AEY TO GDG-TIP-CGTA-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-TIP-CGTA-STP                    
               MOVE FRM-CPIM-AEY TO GDG-STP-CGTA-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-STP-CGTA-STP.                   
      *>>>>                                                             
      *JGM()                                                            
      *>>>>                                                             
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-GDG.
           PERFORM PRO-AKY-GDG.
           PERFORM UNP-MKY-GDG.
           PERFORM UNP-FLD-GDG.
           PERFORM FST-FLD-GDG.
      * EVA-INI-AFRI/ENERO2006                                          
           IF SCR-CMND = 'MST'                                          
              MOVE FRM-CPIM-AEY TO GDG-COD-RLCM-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-COD-RLUN-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-RLVR-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-COD-TGCM-ATR IN GDG-FLD          
      *EVA-AFRI/ABR2007                                                 
      *        MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN GDG-FLD         
              MOVE FRM-CPIM-AEY TO GDG-VRF-IPRO-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-IPRO-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-IPRO-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-NUM-IPRO-ATR IN GDG-FLD          
      *FIN-AFRI/ABR2007                                                 
              MOVE FRM-CPIM-UBY TO GDG-STP-CGTA-ATR IN GDG-FLD          
              MOVE FRM-POS-CURS TO GDG-STP-CGTA-LEN IN GDG-FLD.         
      * EVA-FIN-AFRI/ENERO2006                                          
                                                                        
      * JGM-ini codigo que se agrega del BM                             
           MOVE FRM-CPIM-AEY TO GDG-FEC-FALZ-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-FEC-FALZ-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-IND-EST1-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IND-EST1-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-COD-EST2-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-COD-EST2-STP.                       
                                                                        
      *GDG-IND-EST1 = 05, 19                                            
           IF SCR-CMND NOT = 'ING'  AND SCR-CMND NOT = 'MOD'            
      *MHM-INI 7-AUG-2003                                               
      *        MOVE FRM-CPIM-AEY TO GDG-IND-CLAS-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-IND-CLAS-STP                    
                                                                        
      *        MOVE FRM-CPIM-AEY TO GDG-VAL-MNTO-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-VAL-MNTO-STP                    
      *        MOVE FRM-CPIM-AEY TO GDG-COD-GORI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-COD-GORI-STP                    
                                                                        
      *        MOVE FRM-CPIM-AEY TO GDG-COD-RFCP-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-COD-RFCP-STP                    
      *MHM-FIN 7-AUG-2003                                               
                                                                        
              MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-STP                     
                                                                        
              MOVE FRM-CPIM-AEY TO GDG-IND-CBAN-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-CBAN-STP.                    
                                                                        
      *MHM-INI 13-AUG-2003                                              
           IF SCR-CMND = 'MGA'                                          
              MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD.         
      *MHM-FIN 13-AUG-2003                                              
      *MHM-INI 7-AUG-2003                                               
      *        MOVE FRM-CPIM-AEY TO GDG-COD-DESP-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO GDG-COD-DESP-STP.                   
           IF SCR-CMND NOT = 'ALZ'                                      
               MOVE FRM-CPIM-AEY TO GDG-COD-MALZ-ATR IN GDG-FLD.        
      *MHM-INI 21-AUG-2003                                              
      *     IF SCR-CMND = 'ING' OR SCR-CMND = 'MOD'                     
      *         MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD.       
      *MHM-FIN 21-AUG-2003                                              
           IF SCR-CMND NOT = 'MCA' AND SCR-CMND NOT = 'MGA'             
               MOVE FRM-CPIM-AEY TO GDG-IND-ECRS-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-COD-RERS-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVES-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-IND-ECRT-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-COD-RERT-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVET-ATR IN GDG-FLD.        
      *MHM-INI 21-AUG-2003                                              
      *     IF SCR-CMND = 'ING' OR SCR-CMND = 'MOD'                     
      *         MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD.       
      *MHM-FIN 7-AUG-2003                                               
      *<<<< NOT PGM_ARG                                                 
      *>>>>                                                             
           IF SCR-CCPP = 'ING'                                          
      *MHM-INI 16-OCT-2003                                              
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD         
      *MHM-FIN 16-OCT-2003                                              
               MOVE SPACES TO WSS-EST-ANT IN CMA-VARI                   
               MOVE SPACES TO WSS-ES2-ANT IN CMA-VARI                   
               PERFORM ANL-HBL-FEC-VTO                                  
               GO TO INI-FECHA-HOY.                                     
                                                                        
           IF SCR-CCPP = 'MOD'                                          
      *MHM-INI 12-NOV-2003                                              
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD         
      *MHM-FIN 12-NOV-2003                                              
               PERFORM ANL-HBL-DBC-ICLI                                 
               PERFORM ANL-HBL-FEC-VTO                                  
               IF SCR-CMND = 'MOD'                                      
      *           MOVE FRM-POS-CURS TO GDG-COD-OFIC-LEN IN GDG-FLD      
                  GO TO INI-FECHA-HOY.                                  
                                                                        
      *MHM-INI 21-AUG-2003                                              
      *     MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD.           
      *     MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-STP.                      
      *MHM-FIN 21-AUG-2003                                              
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-COD-LGTA-ATR  IN GDG-FLD.           
           MOVE FRM-CPIM-AEY TO GDG-COD-LGTA-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-FEC-FSOL-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-FEC-FSOL-STP.                       
                                                                        
      *<<<< FMT_CHI                                                     
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.            
      *>>>>                                                             
                                                                        
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-STP.                       
                                                                        
      *                                                                 
      *------------------------------------------------*                
           IF SCR-CMND = 'MGA'                                          
      *RRM-INI                                                          
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-STP                    
              MOVE FRM-POS-CURS TO GDG-GLS-DGTA-LEN IN GDG-FLD          
                                                                        
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-STP                     
      *                                                                 
                                                                        
      *<<<< FMT_CHI                                                     
      *MHM-INI 13-OCT-2003                                              
      *        MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD         
      *MHM-FIN 13-OCT-2003                                              
      *>>>>                                                             
      *                                                                 
      *MHM-INI 13-OCT-2003                                              
      *        MOVE FRM-CPIM-AEY  TO FRM-GLS-NOMC-ATR IN GDG-FLD        
      *        MOVE FRM-CPIM-AEY  TO FRM-GLS-NOMC-STP                   
      *MHM-FIN 13-OCT-2003                                              
      *                                                                 
              GO TO ANL-HBL-FECHA-HOY.                                  
      *--------------------------------------------------*              
      * EVA-AFRI/MAYO2006                                               
           IF SCR-CMND = 'AGA' OR SCR-CMND = 'ACE'                      
               MOVE FRM-POS-CURS TO GDG-GLS-MENS-LEN IN GDG-FLD         
              GO TO ANL-HBL-FECHA-HOY.                                  
      * FIN-AFRI                                                        
      *--------------------------------------------------*              
           IF SCR-CMND NOT = 'ALZ' AND                                  
                       NOT = 'EJE' AND                                  
                       NOT = 'CAN' AND                                  
                       NOT = 'CAD'                                      
              GO TO ANL-HBL-FECHA-HOY.                                  
      *------------------------------------------------*                
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-STP.                       
                                                                        
      *MHM-INI 21-AUG-2003                                              
      *     MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD.           
      *     MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-STP.                      
      *MHM-FIN 21-AUG-2003                                              
                                                                        
      *<<<< FMT_CHI                                                     
           MOVE FRM-CPIM-AEY TO GDG-NUM-IPRO-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-VRF-IPRO-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IND-IPRO-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-GLS-IPRO-ATR IN GDG-FLD.            
      *>>>>                                                             
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IND-INOB-STP.

      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-ALZ
               PERFORM GET-FHOY
               MOVE HOY-SHOY TO GDG-NUM-SALZ IN GDG-FLD
               MOVE HOY-AHOY TO GDG-NUM-AALZ IN GDG-FLD
               MOVE HOY-MHOY TO GDG-NUM-MALZ IN GDG-FLD
               MOVE HOY-DHOY TO GDG-NUM-DALZ IN GDG-FLD.
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = 'ALZ' OR = 'CAN' OR SCR-CMND = 'CAD'           
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
              IF SCR-CMND = WSS-CTE-ALZ
                   MOVE FRM-CPIM-UBY TO GDG-IND-EST1-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UST TO GDG-IND-EST1-STP
                  GO TO ANL-HBL-FECHA-HOY
              ELSE
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2                       
              MOVE FRM-CPIM-UBY TO GDG-FEC-FALZ-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UST TO GDG-FEC-FALZ-STP                     
                                                                        
              MOVE FRM-CPIM-UBY TO GDG-IND-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UST TO GDG-IND-EST1-STP                     
              GO TO ANL-HBL-FECHA-HOY.                                  
                                                                        
           IF SCR-CMND = 'EJE'                                          
              MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UST TO GDG-COD-EST2-STP                     
                                                                        
      *MHM-INI 14-OCT-2003                                              
      *        MOVE FRM-CPIM-UBY TO GDG-FEC-FALZ-ATR IN GDG-FLD         
      *        MOVE FRM-CPIM-UST TO GDG-FEC-FALZ-STP                    
      *MHM-FIN 14-OCT-2003                                              
                                                                        
              MOVE FRM-CPIM-UBY TO GDG-IND-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-UST TO GDG-IND-EST1-STP.                    
                                                                        
       ANL-HBL-FECHA-HOY.                                               
           GO TO INI-FECHA-HOY.                                         
                                                                        
                                                                        
       ANL-HBL-DBC-ICLI.                                                
           IF MULTIPLES-GDD                                             
      *<<<< FMT_CHI                                                     
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD         
      *>>>>                                                             
                                                                        
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-STP.                   
       ANL-HBL-COD-GRA.                                                 
       ANL-HBL-FEC-VTO.                                                 
           IF GAR-IND-SVTO IN CMA-VARI = 'N'                            
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-STP                    
                                                                        
               IF SCR-CCPP = 'ING'                                      
                   MOVE ZEROES TO GDG-NUM-SVTO IN GDG-FLD               
                   MOVE ZEROES TO GDG-NUM-AVTO IN GDG-FLD               
                   MOVE ZEROES TO GDG-NUM-MVTO IN GDG-FLD               
                   MOVE ZEROES TO GDG-NUM-DVTO IN GDG-FLD.              
                                                                        
      *RRM-INI 3-JUL-2002                                               
           IF SCR-CCPP = 'MOD' AND SCR-OFRM-SRV                         
               MOVE FRM-CPIM-UBY TO GDG-FEC-FVTO-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UST TO GDG-FEC-FVTO-STP.                   
      *RRM-FIN 3-JUL-2002                                               
                                                                        
      *                                                                 
        INI-FECHA-HOY.                                                  
           IF SCR-CCPP =  'ING'                                         
               PERFORM GET-FHOY                                         
               MOVE HOY-FHOY TO GDG-FEC-FING IN GDG                     
               MOVE GDG-NUM-SING IN GDG TO GDG-NUM-SING IN GDG-FLD      
               MOVE GDG-NUM-AING IN GDG TO GDG-NUM-AING IN GDG-FLD      
               MOVE GDG-NUM-MING IN GDG TO GDG-NUM-MING IN GDG-FLD      
               MOVE GDG-NUM-DING IN GDG TO GDG-NUM-DING IN GDG-FLD.     
      *                                                                 
      *fin-JGM.                                                         
      *>>>>                                                            
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO GDG-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-GDG.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
      *<<<< LDC_SI AND PGM_MVS AND FIN_SCR_TRL                          
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               MOVE 'F10GDGNINFIA' TO MSG-COD-MENS                      
               PERFORM MSG-PF10.                                        
      *>>>>                                                             
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-GDG
               PERFORM EDT-FLD-GDG
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-GDG
               PERFORM EDT-FLD-GDG
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-GDG.
           PERFORM EDT-FLD-GDG.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY BGLBQGDG.
       COPY GNSBVNUM.
       COPY BGLBFGDG.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBVTDU.
       COPY TABBFUSR.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<<
      *<<<< LDC_SI AND PGM_MVS AND EOF                                  
       MSG-PF10 SECTION.                                                
       INI-MSG-PF10.                                                    
           MOVE 'DEU' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MEN2.                               
           MOVE FRM-MEN2     TO GDG-GLS-MEN2 IN GDG-FLD.                
       FIN-MSG-PF10.                                                    
           EXIT.                                                        
                                                                        
       HBL-KEY-GDG SECTION.                                             
       INI-HBL-KEY-GDG.                                                 
           MOVE SCR-INST-GKY TO SCR-INST.                               
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-STP.                       
                                                                        
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-ATR IN GDG-FLD.            
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-STP.                       
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
      * EN MTX DEBE CAPTURAR LLAVES DE USUARIO EN PANTALLA              
           IF SCR-OFRM-SRV                                              
               MOVE SCR-NMAP TO FRM-NAME                                
               MOVE SCR-NLIB TO FRM-NLIB                                
               MOVE FRM-GET-ALL TO FRM-CMND                             
               PERFORM GNS-PRO-FRM                                      
               MOVE FRM-DFLD TO GDG-FLD                                 
               PERFORM VAL-NUM-KEY-GDG                                  
               PERFORM VAL-NUM-FLD-GDG                                  
           ELSE                                                         
      *>>>> ISP-INI  24-JAN-1996 11:35:48                               
      *>>>>                                                             
                                                                        
           PERFORM SCR-CLRA-GDG.                                        
                                                                        
      *                                                                 
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.                        
                                                                        
           MOVE SCR-CAI-IGAR IN SCR-VARI TO GDG-CAI-GTIA IN GDG-FLD.    
           MOVE SCR-IIC-IGAR IN SCR-VARI TO GDG-IIC-GTIA IN GDG-FLD.    
                                                                        
           MOVE +4           TO GDG-CAI-GTIA-LEN IN GDG-FLD.            
      *<<<< FMT_CHI                                                     
           MOVE FRM-POS-CURS TO GDG-TIP-CGTA-LEN IN GDG-FLD.            
      *>>>>                                                             
                                                                        
      *                                                                 
           PERFORM EDT-KEY-GDG.                                         
           PERFORM EDT-FLD-GDG.                                         
           MOVE 'F10GDGNINFIA' TO MSG-COD-MENS.                         
           PERFORM MSG-PF10.                                            
                                                                        
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
      * BAJO MTX DEBE REGRABAR PANTALLA Y LLAMAR A SCR-ING              
                                                                        
           IF SCR-OFRM-SRV                                              
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'                
                                                                        
               MOVE GDG-FLD TO FRM-DFLD                                 
                                                                        
      * INI - COPY - GNSBGFRM                                           
               MOVE SCR-OTRN TO QUE-TERM                                
               MOVE 'TSI'    TO QUE-TYPE                                
               MOVE 1        TO QUE-NITM                                
               MOVE +2014    TO QUE-LITM                                
               MOVE QUE-DEL  TO QUE-CMND                                
               PERFORM GNS-PRO-QUE                                      
               MOVE SCR-OTRN TO QUE-TERM                                
               MOVE 'TSI'    TO QUE-TYPE                                
               MOVE 1        TO QUE-NITM                                
               MOVE +2014    TO QUE-LITM                                
               MOVE FRM-DFLD TO FRM-AUXI                                
      * NO DEBE GRABAR TSI EN FORMATO MTX, SI NO QUE EN FORMATO         
      * PROGRAMA. ESTE PROGRAMA RELEERA TSI SIN PASAR POR MTX           
      *         MOVE MSG-COD-MENS TO FRM-COD-MENS                       
      *         MOVE FRM-MENS     TO FRM-GLS-MENS                       
      *         MOVE FRM-AUXI     TO FRM-DATA                           
      *         MOVE FRM-NAME TO FRM-NAME-IDEN                          
               MOVE FRM-DFLD TO QUE-DATA                                
               MOVE QUE-PUT  TO QUE-CMND                                
               PERFORM GNS-PRO-QUE                                      
      * FIN - COPY - GNSBGFRM                                           
                                                                        
               PERFORM SCR-ING.                                         
                                                                        
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
      *>>>>                                                             
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'                
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)      
               PERFORM SCR-INIT                                         
               PERFORM SCR-EXIT                                         
           ELSE                                                         
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
                EXEC CICS                                               
                 RETURN                                                 
                END-EXEC.                                               
      *<<<< ISP-FIN  24-JAN-1996 11:35:48                               
      *>>>>                                                             
               PERFORM SCR-PUTA.                                        
       FIN-HBL-KEY-CLF.                                                 
           EXIT.                                                        
                                                                        
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS                       
       ING-FPEN-CIC SECTION.                                            
       INI-ING-FPEN-CIC.                                                
           PERFORM ING-SETE.                                            
           PERFORM SCR-CLRA-GDG.                                        
           MOVE SCR-MENS-EXT TO GDG-GLS-MENS.                           
           PERFORM HBL-IKY.                                             
       FIN-ING-FPEN-CIC.                                                
           EXIT.                                                        
                                                                        
       ING-SETE SECTION.                                                
       INI-ING-SETE.                                                    
           PERFORM CRG-TBL-ENG.                                         
           MOVE WSS-NTRN(SCR-IPRO)     TO SCR-NTRN.                     
           MOVE WSS-PROG(SCR-IPRO)     TO SCR-PROG.                     
           MOVE WSS-NMAP(SCR-IPRO)     TO SCR-NMAP.                     
           MOVE WSS-NLIB(SCR-IPRO)     TO SCR-NLIB.                     
                                                                        
           MOVE WSS-NTRV(SCR-IPRO)     TO SCR-NTRV.                     
           MOVE WSS-PROV(SCR-IPRO)     TO SCR-PROV.                     
       FIN-ING-SETE.                                                    
           EXIT.                                                        
                                                                        
       EGR-FPEN-CIC SECTION.                                            
       INI-EGR-FPEN-CIC.                                                
           PERFORM CRG-TBL-ENG.                                         
           ADD 1 TO SCR-IPRO.                                           
           IF SCR-IPRO > WSS-TOT-IIDX                                   
                  PERFORM EGR-FTER-CIC                                  
                  GO TO FIN-EGR-FPEN-CIC.                               
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES             
               GO TO INI-EGR-FPEN-CIC.                                  
                                                                        
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.                      
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.                         
           MOVE SCR-VARI TO SYS-CMMA.                                   
           MOVE SCR-TCMA TO SYS-TCMA.                                   
           MOVE SYS-XCTL TO SYS-CMND.                                   
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
               MOVE WSS-IDX-IGDG TO SCR-IPRO                            
           ELSE                                                         
      *>>>> ISP-FIN  24-JAN-1996 11:35:48                               
      *>>>>                                                             
           PERFORM GNS-PRO-SYS.                                         
       FIN-EGR-FPEN-CIC.                                                
           EXIT.                                                        
                                                                        
       EGR-FTER-CIC SECTION.                                            
       INI-EGR-FTER-CIC.                                                
           PERFORM CRG-TBL-ENG.                                         
           MOVE WSS-IDX-ILDC TO SCR-IPRO.                               
           MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO).            
           MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO).            
                                                                        
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.                      
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.                         
                                                                        
           MOVE SCR-VARI TO SYS-CMMA.                                   
           MOVE SCR-TCMA TO SYS-TCMA.                                   
           MOVE SYS-XCTL TO SYS-CMND.                                   
      *<<<< GEN_BCI                                                     
      *<<<< ISP-INI  24-JAN-1996 11:35:48                               
           IF SCR-OFRM-SRV                                              
               MOVE WSS-IDX-IGDG TO SCR-IPRO                            
           ELSE                                                         
      *>>>> ISP-FIN  24-JAN-1996 11:35:48                               
      *>>>>                                                             
           PERFORM GNS-PRO-SYS.                                         
       FIN-EGR-FTER-CIC.                                                
           EXIT.                                                        
                                                                        
       SCR-INIT SECTION.                                                
       INI-SCR-INIT.                                                    
           MOVE 3  TO FRM-PLIN.                                         
           MOVE 19 TO FRM-NLIN.                                         
           MOVE FRM-CLR-FRM TO FRM-CMND.                                
           PERFORM GNS-PRO-FRM.                                         
           MOVE FRM-SINI-DBNF TO FRM-SINI.                              
           MOVE SCR-NMAP TO FRM-NAME.                                   
           MOVE SCR-NLIB TO FRM-NLIB.                                   
           MOVE GDG-FLD TO FRM-DFLD.                                    
           MOVE FRM-INI TO FRM-CMND.                                    
           PERFORM GNS-PRO-FRM.                                         
       FIN-SCR-INIT.                                                    
           EXIT.                                                        
                                                                        
       COPY LDCBGMPT.                                                   
                                                                        
      *>>>>                                                             
      *<<<< EOF                                                         
       RST-STAT SECTION.                                                
       INI-RST-STAT.                                                    
           MOVE SCR-STPP     TO SCR-STAT.                               
           MOVE SCR-MFLD-NOT TO SCR-MFLD.                               
       FIN-RST-STAT.                                                    
           EXIT.                                                        
                                                                        
      *<<<< EOF                                                         
      *Buscar tabla en garantia el CIC.                                 
       BUS-CIC-GAR SECTION.                                             
       INI-BUS-CIC-GAR.                                                 
      *BUS-TAB Busca codigo de tabla                                    
           MOVE 'BGL'     TO TAB-COD-SIST.                              
           MOVE 'CIC'     TO TAB-COD-TTAB IN TAB.                       
           MOVE 'PROCIC'  TO TAB-COD-CTAB IN TAB.                       
                                                                        
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
              MOVE TAB-GLS-DAT1 IN TAB TO GAR-CIC-OFIC IN CMA-VARI      
           ELSE                                                         
               MOVE SPACES TO GAR-CIC-OFIC IN CMA-VARI.                 
       FIN-BUS-CIC-GAR.                                                 
           EXIT.                                                        
                                                                        
      *<<<< EOFPQPU                                                     
                                                                        
       GET-GDD SECTION.                                                 
       INI-GET-GDD.                                                     
           MOVE DBC-KEY-IDBC IN DBC     TO GDD-CIC-DCLI IN GDD.         
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDD-CAI-GTIA IN GDD.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDD-IIC-GTIA IN GDD.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS AND                                          
              GDD-CIC-DCLI IN GDD = DBC-KEY-IDBC IN DBC                 
               MOVE GDD-KEY-AGDD IN GDD TO GDG-KEY-IGDG IN GDG          
               MOVE 2 TO WSS-IBUS                                       
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GDG                                      
               IF FIO-STAT-OKS                                          
                   MOVE 3 TO WSS-IBUS.                                  
       FIN-GET-GDD.                                                     
           EXIT.                                                        
                                                                        
       GET-CUR-GDD SECTION.                                             
       INI-GET-CUR-GDD.                                                 
           MOVE GDG-KEY-IGDG IN GDG TO GDD-KEY-AGDD IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS                                              
               MOVE 'GDD-KEY-AGDD' TO FIO-AKEY                          
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GDD.                                     
           IF NOT                                                       
              GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD                 
               MOVE '23' TO FIO-STAT.                                   
       FIN-GET-CUR-GDD.                                                 
           EXIT.                                                        
       GET-CUR-GDD-MUL SECTION.                                         
       INI-GET-CUR-GDD-MUL.                                             
           MOVE SPACES   TO WSS-IND-CMUL IN CMA-VARI.                   
           MOVE GDG-KEY-IGDG IN GDG TO GDD-KEY-AGDD IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GDD.                                         
      *                                                                 
           IF FIO-STAT-OKS   AND                                        
              GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD                 
                MOVE 'GDD-KEY-AGDD' TO FIO-AKEY                         
                MOVE FIO-GET-NXT TO FIO-CMND                            
                PERFORM BGL-FIO-GDD                                     
                IF FIO-STAT-OKS AND                                     
                   GDG-KEY-IGDG IN GDG = GDD-KEY-AGDD IN GDD            
                   MOVE 'M' TO WSS-IND-CMUL.                            
                                                                        
       FIN-GET-CUR-GDD-MUL.                                             
           EXIT.                                                        
                                                                        
       COPY SGCBFDBC.                                                   
       COPY BGLBFGDD.                                                   
       COPY SGCBGCLI.                                                   
      *<<<< PGM_MEX OR GEN_BCI                                          
       COPY BGLBFGSL.                                                   
       COPY BGLBFGSO.                                                   
      *>>>>                                                             
      *<<<< PGM_PU OR NOT NO_CIC_PQ                                     
       COPY GNSBFCIC.                                                   
      *>>>>                                                             
      *<<<< UNS_FLD                                                     
       COPY GNSBGCPT.                                                   
       COPY GNSBGSTR.                                                   
      *>>>>                                                             
      *>>>>                                                             
      *<<<< EOF AND PGM_PQ                                              
      *<<<< EOFPQ                                                       
       LEE-NXT-PRV-XGDD SECTION.                                        
       INI-LEE-NXT-PRV-XGDD.                                            
           MOVE GAR-KEY-IGDD IN CMA-VARI TO GDD-KEY-IGDD IN GDD.        
           IF FRM-FFLD = FRM-FFLD-PF5                                   
      *<<<< NOT PGM_VMS                                                 
               MOVE FIO-GET-LEQ TO FIO-CMND                             
      *>>>>                                                             
               PERFORM BGL-FIO-GDD                                      
               MOVE FIO-GET-PRV TO FIO-CMND                             
           ELSE                                                         
               MOVE FIO-GET-NLS TO FIO-CMND                             
               PERFORM BGL-FIO-GDD                                      
               MOVE FIO-GET-NXT TO FIO-CMND.                            
                                                                        
           PERFORM BGL-FIO-GDD.                                         
           MOVE FIO-STAT TO PGM-STAT-GDD.                               
           IF FIO-STAT-OKS                                              
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GDD.                                     
           IF PGM-STAT-GDD-OKS AND                                      
              GDD-CIC-DCLI IN GDD = DBC-KEY-IDBC IN CMA-VARI            
               MOVE GDD-KEY-AGDD IN GDD TO GDG-KEY-IGDG IN GDG          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GDG                                      
               IF FIO-STAT-OKS                                          
                   MOVE 3 TO WSS-IBUS                                   
                   MOVE GDG-CAI-GTIA IN GDG TO GDG-CAI-GTIA IN GDG-FLD  
                   MOVE GDG-IIC-GTIA IN GDG TO GDG-IIC-GTIA IN GDG-FLD  
               ELSE                                                     
                   MOVE 'DAT ERR' TO MSG-COD-MENS                       
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
           ELSE                                                         
               MOVE '23' TO FIO-STAT.                                   
                                                                        
       FIN-LEE-NXT-PRV-XGDD.                                            
           EXIT.                                                        
                                                                        
       LEE-NXT-PRV-XDBC SECTION.                                        
       INI-LEE-NXT-PRV-XDBC.                                            
           MOVE DBC-KEY-IDBC IN CMA-VARI TO DBC-KEY-IDBC IN DBC.        
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM SGC-FIO-DBC.                                         
           IF CMA-IND-KPAD IN CMA-VARI = 'I'                            
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
           ELSE                                                         
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.                        
                                                                        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
      * BUSCA POR LLAVE SECUNDARIA EL REGISTRO DE PANTALLA ANTERIOR     
           PERFORM BUS-DBC-ANT UNTIL                                    
                FIO-STAT-OKS AND                                        
                DBC-KEY-IDBC IN DBC = DBC-KEY-IDBC IN CMA-VARI OR       
                NOT FIO-STAT-OKS.                                       
                                                                        
           MOVE 0 TO WSS-IBUS.                                          
           MOVE '23' TO PGM-STAT-DBC.                                   
           IF FIO-STAT-OKS                                              
               PERFORM LEE-NXT-PRV-DBC                                  
               IF FRM-FFLD = FRM-FFLD-PF7                               
                   MOVE 'BGL'      TO FIO-SIST                          
                   MOVE 'VSN '     TO TAB-COD-TTAB IN TAB               
      *<<<< NOT PGM_ARG                                                 
                   MOVE 'SISVSI'   TO TAB-COD-CTAB IN TAB               
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM GNS-FIO-TAB                                  
                   IF FIO-STAT-OKS AND                                  
                      TAB-IND-VIGE IN TAB = 'S'                         
                       MOVE 0 TO WSS-IBUS                               
                       MOVE '23' TO PGM-STAT-DBC                        
                       PERFORM LEE-NXT-PRV-DBC.                         
      *>>>>                                                             
       FIN-LEE-NXT-PRV-XDBC.                                            
           EXIT.                                                        
       BUS-DBC-ANT SECTION.                                             
       INI-BUS-DBC-ANT.                                                 
           IF CMA-IND-KPAD IN CMA-VARI = 'I'                            
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
           ELSE                                                         
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
       FIN-BUS-DBC-ANT.                                                 
           EXIT.                                                        
                                                                        
       LEE-NXT-PRV-DBC SECTION.                                         
       INI-LEE-NXT-PRV-DBC.                                             
           IF FRM-FFLD = FRM-FFLD-PF7                                   
               MOVE FIO-GET-PRV TO FIO-CMND                             
           ELSE                                                         
               MOVE FIO-GET-NXT TO FIO-CMND.                            
           IF CMA-IND-KPAD IN CMA-VARI = 'I'                            
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
           ELSE                                                         
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.                        
           PERFORM SGC-FIO-DBC.                                         
           MOVE FIO-STAT TO PGM-STAT-DBC.                               
           IF FIO-STAT-OKS                                              
               MOVE 1 TO WSS-IBUS.                                      
       FIN-LEE-NXT-PRV-DBC.                                             
           EXIT.                                                        
       BUS-ULT-GDG SECTION.                                             
       INI-BUS-ULT-GDG.                                                 
      *<<<< PGM_DTC OR PGM_DB2                                          
           MOVE DBC-KEY-IDBC IN DBC TO GDD-CIC-DCLI IN GDD.             
      *    se busca el ultimo hijo, luego de encontrar el padre         
           MOVE '999999999999' TO GDD-KEY-AGDD IN GDD.                  
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
      *>>>>                                                             
      *<<<< NOT PGM_VSI                                                 
           PERFORM BGL-FIO-GDD.                                         
           IF FIO-STAT-OKS AND                                          
              GDD-CIC-DCLI IN GDD = DBC-KEY-IDBC IN DBC                 
               MOVE GDD-KEY-AGDD IN GDD TO GDG-KEY-IGDG IN GDG          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GDG                                      
               IF FIO-STAT-OKS                                          
                   MOVE 3 TO WSS-IBUS                                   
                   MOVE GDG-CAI-GTIA IN GDG TO GDG-CAI-GTIA IN GDG-FLD  
                   MOVE GDG-IIC-GTIA IN GDG TO GDG-IIC-GTIA IN GDG-FLD. 
      *>>>>                                                             
       FIN-BUS-ULT-GDG.                                                 
           EXIT.                                                        
      *>>>>                                                             
                                                                        
      *>>>>                                                             
                                                                        
      *<<<< EOF                                                         
      *<<<< GEN_BCI                                                     
       COPY BGLBGEDP.                                                   
                                                                        
       COPY DAPBFRCC.                                                   
      *>>>>                                                             
       COPY BGLBFTAG.                                                   
                                                                        
      *RRM-INI 3-JUN-2002                                               
       LECTURA-TAG SECTION.                                             
       INI-LECTURA-TAG.                                                 
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GDG  TO WSS-TIP-CGTA IN WSS-VARI.       
           MOVE GDG-STP-CGTA IN GDG  TO WSS-STP-CGTA IN WSS-VARI.       
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAG-COD-AGTA IN TAG.        
      *>>>>                                                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM BGL-FIO-TAG.                                         
       FIN-LECTURA-TAG.                                                 
           EXIT.                                                        
                                                                        
      *<<<< GEN_BCI                                                     
       BUS-GDO-OPD SECTION.                                             
       INI-BUS-GDO-OPD.                                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDO-CAI-GTIA IN GDO.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDO-IIC-GTIA IN GDO.         
           MOVE 1                       TO GDO-NUM-IGDO IN GDO.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'          TO MSG-COD-SIST                      
               MOVE 'GDO    NEX'   TO MSG-COD-MENS                      
           ELSE                                                         
               MOVE GDO-COD-DOCU IN GDO TO OPD-CIC-IOPD IN DAP-VARI     
               MOVE OPD-CAI-IOPD IN DAP-VARI TO OPD-CAI-IOPD IN OPD     
               MOVE OPD-IIC-IOPD IN DAP-VARI TO OPD-IIC-IOPD IN OPD     
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM DAP-FIO-OPD                                      
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'BGL'          TO MSG-COD-SIST                  
                   MOVE 'OPD    NEX'   TO MSG-COD-MENS                  
               ELSE                                                     
               IF OPD-COD-STAT IN OPD NOT = 'G'                         
                   MOVE 'BGL'            TO MSG-COD-SIST                
                   MOVE 'OPD    NOVIG'   TO MSG-COD-MENS.               
       FIN-BUS-GDO-OPD.                                                 
           EXIT.                                                        
      *>>>>                                                             
                                                                        
       VRF-MOD-GSO SECTION.                                             
       INI-VRF-MOD-GSO.                                                 
           IF NOT ( FIO-STAT-OKS AND                                    
              GDG-CAI-GTIA IN GDG-FLD = GES-CAI-GTIA IN GES AND         
              GDG-IIC-GTIA IN GDG-FLD = GES-IIC-GTIA IN GES)            
               MOVE '00' TO FIO-STAT                                    
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE GDG-CIC-GTIA IN GDG TO GSO-CIC-GTIA IN GSO.             
           MOVE GES-KEY-IGSL IN GES TO GSO-NUM-SBGL IN GSO.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSO    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSO  NOUPD' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE '11' TO GSO-COD-ESGA IN GSO.                            
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM BGL-FIO-GSO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSO  NOMOD' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-MOD-GSO.                                   
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM BGL-FIO-GES.                                         
           GO TO INI-VRF-MOD-GSO.                                       
       FIN-VRF-MOD-GSO.                                                 
           EXIT.                                                        
                                                                        
                                                                        
       VRF-IND-TAG SECTION.                                             
       INI-VRF-IND-TAG.                                                 
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GDG  TO WSS-TIP-CGTA IN WSS-VARI.       
           MOVE GDG-STP-CGTA IN GDG  TO WSS-STP-CGTA IN WSS-VARI.       
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAG-COD-AGTA IN TAG.        
      *>>>>                                                             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'TAG    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-IND-TAG.                                   
                                                                        
           IF NOT ( TAG-IND-EGSL IN TAG = 'S' AND TAG-IND-EGSO = 'S' )  
               GO TO FIN-VRF-IND-TAG.                                   
                                                                        
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GES-CAI-GTIA IN GES.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GES-IIC-GTIA IN GES.         
           MOVE ZEROES                  TO GES-NUM-IGES IN GES.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GES.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GDG-CAI-GTIA IN GDG-FLD = GES-CAI-GTIA IN GES AND         
              GDG-IIC-GTIA IN GDG-FLD = GES-IIC-GTIA IN GES)            
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GES    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-VRF-IND-TAG                                    
           ELSE                                                         
               PERFORM VRF-MOD-GSO.                                     
                                                                        
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-VRF-IND-TAG.                                   
       FIN-VRF-IND-TAG.                                                 
           EXIT.                                                        
      *RRM-FIN 3-JUN-2002                                               
      *RRM-INI 4-JUL-2002                                               
       VAL-CIM-AGA SECTION.                                             
       INI-VAL-CIM-AGA.                                                 
           PERFORM VAL-GDG-FEC-FVTO-CIM.                                
           PERFORM VAL-GDG-IND-CBAN-CIM.                                
           PERFORM VAL-GDG-IDC-IPRO-CIM.                                
           PERFORM VAL-DBC-GLS-NOMC-CIM.                                
       FIN-VAL-CIM-AGA.                                                 
           EXIT.                                                        
                                                                        
       VAL-GDG-FEC-FVTO-CIM SECTION.                                    
       INI-VAL-GDG-FEC-FVTO-CIM.                                        
      *VAL-FEC Validar Fecha                                            
           MOVE GDG-FEC-FVTO IN GDG TO FEC-FECH.                        
           MOVE FEC-FORM-FEC        TO FEC-FORM.                        
           MOVE FEC-FBLK-S          TO FEC-FBLK.                        
           MOVE FEC-CHOY-LE         TO FEC-CHOY.                        
           MOVE FEC-VHBL-S          TO FEC-VHBL.                        
           MOVE FEC-VHBL-N          TO FEC-VHBL.                        
                                                                        
           MOVE GDG-NUM-SVTO IN GDG TO FEC-SVLD.                        
           MOVE GDG-NUM-AVTO IN GDG TO FEC-AVLD.                        
           MOVE GDG-NUM-MVTO IN GDG TO FEC-MVLD.                        
           MOVE GDG-NUM-DVTO IN GDG TO FEC-DVLD.                        
                                                                        
           MOVE TAG-IND-SVTO IN TAG TO GAR-IND-SVTO IN CMA-VARI.        
                                                                        
           IF GAR-IND-SVTO IN CMA-VARI  = 'S'                           
              IF FEC-FVLD = '00000000'                                  
                 MOVE 'VTO=0' TO MSG-COD-MENS                           
                 GO TO ERR-VAL-GDG-FEC-FVTO-CIM.                        
                                                                        
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           MOVE FEC-VAL-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
           IF  NOT FEC-STAT-OKS                                         
               MOVE 'FVEN  NOVAL' TO MSG-COD-MENS                       
               GO TO FIN-VAL-GDG-FEC-FVTO-CIM.                          
                                                                        
                                                                        
           MOVE GDG-NUM-SSOL IN GDG TO FEC-SEC1.                        
           MOVE GDG-NUM-ASOL IN GDG TO FEC-AEC1.                        
           MOVE GDG-NUM-MSOL IN GDG TO FEC-MEC1.                        
           MOVE GDG-NUM-DSOL IN GDG TO FEC-DEC1.                        
                                                                        
           MOVE GDG-NUM-SVTO IN GDG TO FEC-SEC2.                        
           MOVE GDG-NUM-AVTO IN GDG TO FEC-AEC2.                        
           MOVE GDG-NUM-MVTO IN GDG TO FEC-MEC2.                        
           MOVE GDG-NUM-DVTO IN GDG TO FEC-DEC2.                        
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-CMP-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-LES                                          
               MOVE 'VTO<=SOL' TO MSG-COD-MENS                          
               GO TO ERR-VAL-GDG-FEC-FVTO-CIM.                          
                                                                        
           MOVE GDG-FEC-FVTO IN GDG TO FEC-FEC1.                        
                                                                        
           MOVE GDG-NUM-DING IN GDG TO FEC-DEC2.                        
           MOVE GDG-NUM-MING IN GDG TO FEC-MEC2.                        
           MOVE GDG-NUM-AING IN GDG TO FEC-AEC2.                        
           MOVE GDG-NUM-SING IN GDG TO FEC-SEC2.                        
           MOVE FEC-FORM-FEC        TO FEC-FORM.                        
           MOVE FEC-CMP-FEC         TO FEC-CMND.                        
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-GRT                                          
               MOVE 'FVTO<=FING' TO MSG-COD-MENS                        
               GO TO ERR-VAL-GDG-FEC-FVTO-CIM.                          
                                                                        
           GO TO FIN-VAL-GDG-FEC-FVTO-CIM.                              
                                                                        
       ERR-VAL-GDG-FEC-FVTO-CIM.                                        
           MOVE 'BGL'     TO MSG-COD-SIST.                              
       FIN-VAL-GDG-FEC-FVTO-CIM.                                        
           EXIT.                                                        
                                                                        
                                                                        
       VAL-GDG-VAL-MNTO-CIM SECTION.                                    
       INI-VAL-GDG-VAL-MNTO-CIM.                                        
           IF GDG-VAL-MNTO IN GDG = ZEROES                              
               MOVE 'BGL'       TO MSG-COD-SIST                         
               MOVE 'MNTO=0' TO MSG-COD-MENS                            
               GO TO FIN-VAL-GDG-VAL-MNTO-CIM.                          
       FIN-VAL-GDG-VAL-MNTO-CIM.                                        
           EXIT.                                                        
                                                                        
       VAL-GDG-IND-CBAN-CIM SECTION.                                    
       INI-VAL-GDG-IND-CBAN-CIM.                                        
           IF  GDG-IND-CBAN IN GDG NOT = 'N' AND NOT = 'S'              
                MOVE 'BGL'         TO MSG-COD-SIST                      
                MOVE 'ICBAN   N/S' TO MSG-COD-MENS                      
                GO TO FIN-VAL-GDG-IND-CBAN-CIM.                         
       FIN-VAL-GDG-IND-CBAN-CIM.                                        
           EXIT.                                                        
                                                                        
      * EVA-AFRI/2007                                                   
                                                                        
      * VAL-FRM-IDC-ICLI-CIM SECTION.                                   
      * INI-VAL-FRM-IDC-ICLI-CIM.                                       
      * Mover nombre propietario.                                       
      *     IF GDG-IIC-ICLI IN GDG > ZEROES                             
      *         MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC         
      *         MOVE FIO-GET-KEY TO FIO-CMND                            
      *         PERFORM SGC-FIO-DBC                                     
      *         IF FIO-STAT-OKS                                         
      *<<<< FMT_CHI                                                     
      *            MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN GDG-FLD  
      *            MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN GDG-FLD  
      *            MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN GDG-FLD  
      *            MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN GDG-FLD  
      *>>>>                                                             
      *            MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI         
      *            MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI         
                                                                        
      *            MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
      *            PERFORM CPT-BLKS                                     
      *            MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD             
      *            MOVE CPT-STRN TO CNE-GDG-GLS-NOMP                    
      *          ELSE                                                   
      *            MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD               
      *            MOVE SPACES  TO CNE-GDG-GLS-NOMP                     
      *     ELSE                                                        
      *        MOVE GDG-GLS-NOMP IN GDG TO FRM-GLS-NOMC IN GDG-FLD      
      *        MOVE GDG-GLS-NOMP IN GDG TO CNE-GDG-GLS-NOMP.            
                                                                        
      *<<<< FMT_CHI                                                     
      *     IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND                     
      *>>>>                                                             
      *        GDG-IND-CBAN IN GDG     = 'S'                            
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI X  NEX' TO MSG-COD-MENS                    
      *            GO TO FIN-VAL-FRM-IDC-ICLI-CIM.                      
                                                                        
      *<<<< FMT_CHI                                                     
      *     IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES AND                 
      *>>>>                                                             
      *        GDG-IND-CBAN IN GDG         = 'N'                        
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI Y NEX' TO MSG-COD-MENS                     
      *            PERFORM GET-MSG                                      
      *            GO TO FIN-VAL-FRM-IDC-ICLI-CIM.                      
                                                                        
                                                                        
      *<<<< FMT_CHI                                                     
      *      IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES                    
      *>>>>                                                             
                                                                        
      *<<<< FMT_CHI                                                     
      *         MOVE FRM-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC     
      *         MOVE FRM-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC     
      *         MOVE FRM-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC     
      *>>>>                                                             
      *         MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                        
      *         MOVE FIO-GET-KEY TO FIO-CMND                            
      *         PERFORM SGC-FIO-DBC                                     
      *         IF NOT FIO-STAT-OKS                                     
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI    NEX' TO MSG-COD-MENS                    
      *        ELSE                                                     
      *           MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI          
      *           MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI          
      *           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                  
      *           PERFORM CPT-BLKS                                      
      *           MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.             
      * FIN-VAL-FRM-IDC-ICLI-CIM.                                       
      *     EXIT.                                                       
                                                                        
                                                                        
       VAL-GDG-IDC-IPRO-CIM SECTION.                                    
       INI-VAL-GDG-IDC-IPRO-CIM.                                        
      * Mover nombre propietario.                                       
           IF GDG-IIC-ICLI IN GDG > ZEROES AND                          
              GDG-IND-CBAN IN GDG = 'S'                                 
                 MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC        
                 MOVE FIO-GET-KEY TO FIO-CMND                           
                 PERFORM SGC-FIO-DBC                                    
                 IF FIO-STAT-OKS                                        
                   MOVE DBC-NUM-ICLI IN DBC TO GDG-NUM-IPRO IN GDG-FLD  
                   MOVE DBC-VRF-ICLI IN DBC TO GDG-VRF-IPRO IN GDG-FLD  
                   MOVE DBC-IND-ICLI IN DBC TO GDG-IND-IPRO IN GDG-FLD  
                   MOVE DBC-GLS-ICLI IN DBC TO GDG-GLS-IPRO IN GDG-FLD  
      *>>>>                                                             
                   MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI         
                   MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI         
                                                                        
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN TO GDG-GLS-NOMP IN GDG-FLD             
                   MOVE CPT-STRN TO CNE-GDG-GLS-NOMP                    
                 ELSE                                                   
                   MOVE SPACES TO GDG-GLS-NOMP IN GDG-FLD               
                   MOVE SPACES  TO CNE-GDG-GLS-NOMP                     
           ELSE                                                         
              MOVE GDG-NUM-IPRO IN GDG TO GDG-NUM-IPRO IN GDG-FLD       
              MOVE GDG-VRF-IPRO IN GDG TO GDG-VRF-IPRO IN GDG-FLD       
              MOVE GDG-GLS-NOMP IN GDG TO GDG-GLS-NOMP IN GDG-FLD       
              MOVE GDG-GLS-NOMP IN GDG TO CNE-GDG-GLS-NOMP.             
       FIN-VAL-GDG-IDC-IPRO-CIM.                                        
           EXIT.                                                        
      *FIN-AFRI/ABR2007                                                 
                                                                        
       VAL-DBC-GLS-NOMC-CIM SECTION.                                    
       INI-VAL-DBC-GLS-NOMC-CIM.                                        
      *<<<< FMT_CHI                                                     
      *EVA-AFRI/ABR2007                                                 
      *    IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND                      
      *>>>>                                                             
      *       GDG-IND-CBAN IN GDG     = 'N'    AND                      
      *       FRM-GLS-NOMC IN GDG-FLD NOT > SPACES                      
      *           MOVE 'TAB'         TO MSG-COD-SIST                    
      *           MOVE 'CLI-NOM-NEX' TO MSG-COD-MENS                    
      *           PERFORM GET-MSG                                       
      *           MOVE SPACES        TO FRM-GLS-NOMC IN GDG-FLD         
      *           MOVE MSG-GLS-DESC  TO FRM-MENS                        
      *           MOVE FRM-SUAR-MAL  TO FRM-SUAR.                       
      *            GO TO FIN-VAL-FRM-GLS-NOMC.                          
      *FIN-AFRI/ABR2007                                                 
       FIN-VAL-DBC-GLS-NOMC-CIM.                                        
           EXIT.                                                        
      *RRM-FIN 4-JUL-2002                                               
       COPY BGLBFGIM.                                                   
       COPY BGLBFGVE.                                                   
       COPY BGLBFGAP.                                                   
       COPY BGLBFGDP.                                                   
       COPY BGLBFGES.                                                   
       COPY BGLBFGIN.                                                   
       COPY BGLBFGLE.                                                   
       COPY BGLBFGSE.                                                   
       COPY BGLBFGSI.                                                   
       COPY BGLBFGTP.                                                   
       COPY BGLBFGUB.                                                   
       COPY BGLBFGVT.                                                   
       COPY BGLBFGMO.                                                   
      *MHM-INI 30-JUL-2003                                              
      * COPY BGLBVVCG.                                                  
       COPY DAPBFOPD.                                                   
       COPY BGLBFGDO.                                                   
       COPY COLBFOPC.                                                   
       COPY COLBFDLC.                                                   
       COPY GNSBGVSM.                                                   
      *MHM-FIN 30-JUL-2003                                              
       COPY BGLBSELI.                                                   
       COPY BGLBGVC2.                                                   
      * COPY BGLBVUOF.                                                  
      *                                                                 
       COPY TABBBUSR.                                                   
      *EVA-INI-AFRI/ENERO2006                                           
       VAL-IND-GSO SECTION.                                             
       INI-VAL-IND-GSO.                                                 
           MOVE GDG-CAI-GTIA IN GDG TO GSO-CAI-GTIA IN GSO.             
           MOVE GDG-IIC-GTIA IN GDG TO GSO-IIC-GTIA IN GSO.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-VAL-IND-GSO.                                                 
           MOVE 'GSO-KEY-IGDG' TO FIO-AKEY.                             
           PERFORM BGL-FIO-GSO.                                         
           IF  NOT (FIO-STAT-OKS AND                                    
              GDG-CAI-GTIA IN GDG = GSO-CAI-GTIA IN GSO AND             
              GDG-IIC-GTIA IN GDG = GSO-IIC-GTIA IN GSO)                
               MOVE 'GSOSINGSLT' TO MSG-COD-MENS                        
               GO TO FIN-VAL-IND-GSO.                                   
           MOVE GSO-NUM-SBGL IN GSO TO GSL-NUM-SBGL IN GSL              
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM BGL-FIO-GSL                                          
           IF NOT FIO-STAT-OKS                                          
               MOVE 'GSOSINGSL' TO MSG-COD-MENS                         
               GO TO FIN-VAL-IND-GSO.                                   
           IF NOT (GSL-COD-TSOL IN GSL = 'T' AND                        
              GSO-COD-ESGA IN GSO = '03' AND                            
              GSO-COD-EST2 IN GSO = '05')                               
               MOVE 'GDGSINGSOVAL' TO MSG-COD-MENS                      
               MOVE FIO-GET-NXT TO FIO-CMND                             
               GO TO LUP-VAL-IND-GSO.                                   
       FIN-VAL-IND-GSO.                                                 
           EXIT.                                                        
      *EVA-FIN-AFRI/ENERO2006                                           
      *>>>>                                                             
      * EVA-INI  12/08                                                  
                                                                        
       VAL-CEN-GDG SECTION.                                             
       INI-VAL-CEN-GDG.                                                 
                                                                        
           MOVE 'S' TO WSS-IND-OCEN IN WSS-VARI.                        
                                                                        
           MOVE 'EJC ' TO USR-COD-TTAB IN USR.                          
           MOVE GDG-CIC-EJOR IN GDG TO USR-COD-USER IN USR.             
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'N' TO WSS-IND-OCEN IN WSS-VARI                      
              GO TO FIN-VAL-CEN-GDG.                                    
                                                                        
           IF GDG-CIC-EJOR IN GDG > SPACES                              
               MOVE GDG-CIC-EJOR IN GDG TO USR-COD-USER IN USR          
               PERFORM BUS-USR                                          
           ELSE                                                         
              MOVE 'N' TO WSS-IND-OCEN IN WSS-VARI                      
              GO TO FIN-VAL-CEN-GDG.                                    
                                                                        
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'CEN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE USR-COD-OFUS IN USR TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                  TAB-IND-VIGE IN TAB = 'S')                            
              MOVE 'N' TO WSS-IND-OCEN IN WSS-VARI.                     
                                                                        
       FIN-VAL-CEN-GDG.                                                 
           EXIT.                                                        
                                                                        
       VAL-VSN SECTION.                                                 
       INI-VAL-VSN.                                                     
           MOVE 'S' TO WSS-IND-TVSN IN WSS-VARI.                        
                                                                        
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'VSN'               TO TAB-COD-TTAB IN TAB.             
           MOVE '01'                TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
              MOVE 'N' TO WSS-IND-TVSN IN WSS-VARI.                     
                                                                        
       FIN-VAL-VSN.                                                     
           EXIT.                                                        
      * EVA-FIN  12/08                                                  
