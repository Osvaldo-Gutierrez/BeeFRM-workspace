      *
      * BGLBUGDG
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 04:48 PM
      *
      *<<<< 
      *********************************************************
      *MANTENCIONES
      **AFRI-INI/SEP2009: NO VALIDA SI EL USUARIO ESTA VIGENTE
      *                   EN INGRESO DE UNA GARANTIA.
      *********************************************************
      **PVC-INI/MAR-2013: GARANTIAS ACTIVADAS SIN FECHA DE              
      *                   Vencimiento (52427)                           
      *********************************************************   
      *---------------------------------------------------------------
      *  AUTOR      : BEE-MPS-AFRI
      *  FECHA      : JUN-2017
      *  ETIQUETA   : *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *  PROYECTO   : ARCHIVO CON REVALORIZACIONES DE GARANTIAS FASE 2
      *  OBJETIVO   : GRABAR LOG DE COMANDO ING EN ENTIDAD GNS-LGN
      *-----------------------------------------------------------------
      *>>>>
       SET-TAG-BGLBUGDG SECTION.
       INI-SET-TAG-BGLBUGDG.
           MOVE
           '<IDNMOD NOM=$BGLBUGDG$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 04:48 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGDG.
           EXIT.
           
       RET-ALL-GDG SECTION.
       INI-RET-ALL-GDG.
           PERFORM KEY-ALL-GDG.
           PERFORM RET-GDG-GDG.
           PERFORM RET-DBC-GDG.
       FIN-RET-ALL-GDG.
           EXIT.
       
       RET-GDG-GDG SECTION.
       INI-RET-GDG-GDG.
           MOVE GDG-COD-RLCM IN GDG-FLD TO GDG-COD-RLCM IN GDG.
           MOVE GDG-COD-RLUN IN GDG-FLD TO GDG-COD-RLUN IN GDG.
           MOVE GDG-GLS-RLVR IN GDG-FLD TO GDG-GLS-RLVR IN GDG.
      * OFI-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-OFIC IN GDG-FLD TO GDG-COD-OFIC IN GDG.
      * OFI-FIN --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-VCAM IN GDG-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-IND-INOB IN GDG-FLD TO GDG-IND-INOB IN GDG.
           MOVE GDG-GLS-DGTA IN GDG-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-IND-CBAN IN GDG-FLD TO GDG-IND-CBAN IN GDG.
           MOVE GDG-GLS-DGT1 IN GDG-FLD TO GDG-GLS-DGT1 IN GDG.
           MOVE GDG-COD-TSCN IN GDG-FLD TO GDG-COD-TSCN IN GDG.
           MOVE GDG-CIC-EJOR IN GDG-FLD TO GDG-CIC-EJOR IN GDG.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-NUM-DALZ IN GDG-FLD TO GDG-NUM-DALZ IN GDG.
           MOVE GDG-NUM-MALZ IN GDG-FLD TO GDG-NUM-MALZ IN GDG.
           MOVE GDG-NUM-SALZ IN GDG-FLD TO GDG-NUM-SALZ IN GDG.
           MOVE GDG-NUM-AALZ IN GDG-FLD TO GDG-NUM-AALZ IN GDG.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-NUM-DING IN GDG-FLD TO GDG-NUM-DING IN GDG.
           MOVE GDG-NUM-MING IN GDG-FLD TO GDG-NUM-MING IN GDG.
           MOVE GDG-NUM-SING IN GDG-FLD TO GDG-NUM-SING IN GDG.
           MOVE GDG-NUM-AING IN GDG-FLD TO GDG-NUM-AING IN GDG.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-NUM-DVTO IN GDG-FLD TO GDG-NUM-DVTO IN GDG.
           MOVE GDG-NUM-MVTO IN GDG-FLD TO GDG-NUM-MVTO IN GDG.
           MOVE GDG-NUM-SVTO IN GDG-FLD TO GDG-NUM-SVTO IN GDG.
           MOVE GDG-NUM-AVTO IN GDG-FLD TO GDG-NUM-AVTO IN GDG.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-NUM-DEST IN GDG-FLD TO GDG-NUM-DEST IN GDG.
           MOVE GDG-NUM-MEST IN GDG-FLD TO GDG-NUM-MEST IN GDG.
           MOVE GDG-NUM-SEST IN GDG-FLD TO GDG-NUM-SEST IN GDG.
           MOVE GDG-NUM-AEST IN GDG-FLD TO GDG-NUM-AEST IN GDG.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-COD-EST2 IN GDG-FLD TO GDG-COD-EST2 IN GDG.
           MOVE GDG-IND-GTAC IN GDG-FLD TO GDG-IND-GTAC IN GDG.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-NUM-DSOL IN GDG-FLD TO GDG-NUM-DSOL IN GDG.
           MOVE GDG-NUM-MSOL IN GDG-FLD TO GDG-NUM-MSOL IN GDG.
           MOVE GDG-NUM-SSOL IN GDG-FLD TO GDG-NUM-SSOL IN GDG.
           MOVE GDG-NUM-ASOL IN GDG-FLD TO GDG-NUM-ASOL IN GDG.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-IND-EST1 IN GDG-FLD TO GDG-IND-EST1 IN GDG.
           MOVE GDG-COD-TGCM IN GDG-FLD TO GDG-COD-TGCM IN GDG.
           MOVE GDG-COD-LGTA IN GDG-FLD TO GDG-COD-LGTA IN GDG.
           MOVE GDG-COD-EST1 IN GDG-FLD TO GDG-COD-EST1 IN GDG.
           MOVE GDG-COD-MALZ IN GDG-FLD TO GDG-COD-MALZ IN GDG.
           MOVE GDG-IND-ECRS IN GDG-FLD TO GDG-IND-ECRS IN GDG.
           MOVE GDG-COD-RERS IN GDG-FLD TO GDG-COD-RERS IN GDG.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-NUM-DVES IN GDG-FLD TO GDG-NUM-DVES IN GDG.
           MOVE GDG-NUM-MVES IN GDG-FLD TO GDG-NUM-MVES IN GDG.
           MOVE GDG-NUM-SVES IN GDG-FLD TO GDG-NUM-SVES IN GDG.
           MOVE GDG-NUM-AVES IN GDG-FLD TO GDG-NUM-AVES IN GDG.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-IND-ECRT IN GDG-FLD TO GDG-IND-ECRT IN GDG.
           MOVE GDG-COD-RERT IN GDG-FLD TO GDG-COD-RERT IN GDG.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-NUM-DVET IN GDG-FLD TO GDG-NUM-DVET IN GDG.
           MOVE GDG-NUM-MVET IN GDG-FLD TO GDG-NUM-MVET IN GDG.
           MOVE GDG-NUM-SVET IN GDG-FLD TO GDG-NUM-SVET IN GDG.
           MOVE GDG-NUM-AVET IN GDG-FLD TO GDG-NUM-AVET IN GDG.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-NUM-IPRO IN GDG-FLD TO GDG-NUM-IPRO IN GDG.
           MOVE GDG-VRF-IPRO IN GDG-FLD TO GDG-VRF-IPRO IN GDG.
           MOVE GDG-IND-IPRO IN GDG-FLD TO GDG-IND-IPRO IN GDG.
           MOVE GDG-GLS-IPRO IN GDG-FLD TO GDG-GLS-IPRO IN GDG.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GDG-GLS-NOMP IN GDG-FLD TO GDG-GLS-NOMP IN GDG.
           MOVE GDG-COD-GACS IN GDG-FLD TO GDG-COD-GACS IN GDG.
      *<<<< FIN_RET_GDG_GDG                                             
      *  GDG-IND_EST1 = 05 --> En tramite                               
      *                 10 --> Constituida                              
      *                 20 --> Levantada                                
      *                                                 

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           INSPECT GDG-GLS-DGTA IN GDG REPLACING ALL ';' BY ' '.
           INSPECT GDG-GLS-DGT1 IN GDG REPLACING ALL ';' BY ' '.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

           IF SCR-CMND = 'ING'                                          
              MOVE '05' TO GDG-IND-EST1 IN GDG-FLD                      
           MOVE GDG-COD-VCAM IN GDG-FLD TO WSS-VCB.                     
           IF WSS-TIP-VCB = '1'                                         
              MOVE GDG-COD-VCAM IN GDG-FLD TO GDG-COD-VCON IN GDG       
              GO TO NTX-RET-GDG-GDG.                                    
                                                                        
      *    Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de Mone 
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'CIC0999  NEX' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              MOVE SPACES         TO GDG-COD-VCON IN GDG                
               GO TO NTX-RET-GDG-GDG.                                   
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO GDG-COD-VCON IN GDG.             
                                                                        
       NTX-RET-GDG-GDG.                                                 
           IF GDG-IND-EST1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI     
               MOVE WSS-EST-ANT IN CMA-VARI TO GDG-COD-ESTA IN GDG.     
                                                                        
      *<<<< FMT_CHI                                                     
      *AFRI-EVA /ABR2007                                                
      *    IF FRM-NUM-ICLI IN GDG-FLD = ZEROES                          
           IF ((GDG-NUM-IPRO IN GDG-FLD NOT > ZEROES) OR                
               (GDG-NUM-IPRO IN GDG-FLD > ZEROES AND                    
                GDG-IND-CBAN IN GDG-FLD = 'N'))                         
      *FIN-EVA /ABR2007                                                 
      *>>>>                                                             
      *AFRI-INI JUL/2004                                                
               MOVE SPACES TO CNE-GDG-CAI-ICLI                          
               MOVE ZEROES TO CNE-GDG-IIC-ICLI                          
      *AFRI-FIN JUL/2004                                                
               MOVE SPACES TO GDG-CAI-ICLI IN GDG                       
               MOVE ZEROES TO GDG-IIC-ICLI IN GDG.                      
                                                                        
           IF SCR-CMND = 'EJE' OR                                       
              SCR-CMND = 'CAD' OR                                       
              SCR-CMND = 'MGA'                                          
              GO TO FIN-RET-GDG-GDG.                                    
                                                                        
           MOVE ZEROES  TO GDG-VAL-CCON IN GDG.                         
           MOVE ZEROES  TO GDG-VAL-CCOM IN GDG.                         
      *>>>>                                                             
       FIN-RET-GDG-GDG.
           EXIT.
       
       RET-DBC-GDG SECTION.
       INI-RET-DBC-GDG.
      *>>>> INI_RET_GDG_GDG                                             
           MOVE CNE-GDG-CAI-ICLI  TO GDG-CAI-ICLI IN GDG.               
           MOVE CNE-GDG-IIC-ICLI  TO GDG-IIC-ICLI IN GDG.               
           MOVE CNE-GDG-GLS-NOMP  TO GDG-GLS-NOMP IN GDG.               
      *>>>>                                                             
       FIN-RET-DBC-GDG.
           EXIT.
       
       KEY-ALL-GDG SECTION.
       INI-KEY-ALL-GDG.
           PERFORM KEY-GDG-GDG.
           PERFORM KEY-DBC-GDG.
       FIN-KEY-ALL-GDG.
           EXIT.
       
       KEY-GDG-GDG SECTION.
       INI-KEY-GDG-GDG.
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDG-IIC-GTIA IN GDG.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GDG-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GDG-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
       FIN-KEY-GDG-GDG.
           EXIT.
       
       KEY-DBC-GDG SECTION.
       INI-KEY-DBC-GDG.
      *<<<< INI_KEY_DBC_GDG
      *
           MOVE CNE-GDD-CIC-ICLI TO DBC-IDC-ICLI IN DBC.
           MOVE CNE-DBC-GLS-NOMC TO DBC-GLS-NOMC IN DBC.
           GO TO FIN-KEY-DBC-GDG.
      *>>>>
           MOVE DBC-GLS-NOMC IN GDG-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-GDG.
           EXIT.
       
       SCR-CLRA-GDG SECTION.
       INI-SCR-CLRA-GDG.
           PERFORM CLR-KEY-GDG.
           PERFORM CLR-FLD-GDG.
       FIN-SCR-CLRA-GDG.
           EXIT.
       
       CLR-KEY-GDG SECTION.
       INI-CLR-KEY-GDG.
           MOVE SPACES TO GDG-CAI-GTIA IN GDG-FLD.
           MOVE ZEROES TO GDG-IIC-GTIA IN GDG-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN GDG-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GDG-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GDG-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      *<<<< FIN_CLR_KEY_GDG
      *<<<< GEN_BCI
      *MHM-INI 03-NOV-2004
           IF SCR-CMND NOT = 'ING'
               GO TO CNT-CLR-KEY-GDG.
      *MHM-FIN 03-NOV-2004
           MOVE 'BGL' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE '001' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-IND-VIGE IN TAB NOT = 'S'
      *        FLB: version 'B'anco
      *         MOVE 'B' TO SCR-IND-V001
               MOVE SPACES TO MSG-COD-MENS
               MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN GDG-FLD
      *INI-AFRI/MAY-2005
               IF SCR-HDR-MRCA = 'BCS'
                  MOVE '0800' TO GDG-CAI-GTIA IN GDG-FLD
               ELSE
                  MOVE '0500' TO GDG-CAI-GTIA IN GDG-FLD
      *        MOVE '0500' TO GDG-CAI-GTIA IN GDG-FLD                   
               END-IF
      *FIN-AFRI/MAY-2005
               MOVE 0  TO GDG-CAI-GTIA-LEN IN GDG-FLD
               MOVE -1 TO GDG-IIC-GTIA-LEN IN GDG-FLD.
      *     ELSE
      *        FLB: version 'C'onsist
      *         MOVE 'C' TO SCR-IND-V001.
      *>>>>
      *MHM-INI 03-NOV-2004                                              
       CNT-CLR-KEY-GDG.                                                 
      *MHM-FIN 03-NOV-2004                                              
            MOVE SPACES TO CNE-DBC-GLS-NOMC.                            
            MOVE SPACES TO CNE-DBC-CAI-ICLI.                            
            MOVE ZEROES TO CNE-DBC-IIC-ICLI.                            
            MOVE SPACES TO CNE-GDG-GLS-NOMP.                            
            MOVE SPACES TO CNE-GDG-CAI-ICLI.                            
            MOVE ZEROES TO CNE-GDG-IIC-ICLI.                            
      *>>>>                                                             
       FIN-CLR-KEY-GDG.
           EXIT.
       
       CLR-FLD-GDG SECTION.
       INI-CLR-FLD-GDG.
           MOVE SPACES TO FRM-GLS-TREA IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GDG-FLD.
           MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD.
           MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-EJOR IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-EST2 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-IND-EST1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-TGCM IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-LGTA IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-EST1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-MALZ IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ATRN IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-RERS IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-RERT IN GDG-FLD.
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-DEUD IN GDG-FLD.
           PERFORM CLR-GDG-GDG.
           PERFORM CLR-DBC-GDG.
       FIN-CLR-FLD-GDG.
           EXIT.
       
       CLR-GDG-GDG SECTION.
       INI-CLR-GDG-GDG.
           MOVE SPACES TO GDG-COD-RLCM IN GDG-FLD.
           MOVE SPACES TO GDG-COD-RLUN IN GDG-FLD.
           MOVE SPACES TO GDG-GLS-RLVR IN GDG-FLD.
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GDG-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GDG-FLD.
           MOVE SPACES TO GDG-IND-INOB IN GDG-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GDG-FLD.
           MOVE SPACES TO GDG-IND-CBAN IN GDG-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-TSCN IN GDG-FLD.
           MOVE SPACES TO GDG-CIC-EJOR IN GDG-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FALZ IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FING IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FVTO IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FEST IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-EST2 IN GDG-FLD.
           MOVE SPACES TO GDG-IND-GTAC IN GDG-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FSOL IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-IND-EST1 IN GDG-FLD.
           MOVE SPACES TO GDG-COD-TGCM IN GDG-FLD.
           MOVE SPACES TO GDG-COD-LGTA IN GDG-FLD.
           MOVE SPACES TO GDG-COD-EST1 IN GDG-FLD.
           MOVE SPACES TO GDG-COD-MALZ IN GDG-FLD.
           MOVE SPACES TO GDG-IND-ECRS IN GDG-FLD.
           MOVE SPACES TO GDG-COD-RERS IN GDG-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FVES IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-IND-ECRT IN GDG-FLD.
           MOVE SPACES TO GDG-COD-RERT IN GDG-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FVET IN GDG-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-NUM-IPRO IN GDG-FLD.
           MOVE SPACES TO GDG-VRF-IPRO IN GDG-FLD.
           MOVE SPACES TO GDG-IND-IPRO IN GDG-FLD.
           MOVE SPACES TO GDG-GLS-IPRO IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-GLS-NOMP IN GDG-FLD.
           MOVE SPACES TO GDG-COD-GACS IN GDG-FLD.
       FIN-CLR-GDG-GDG.
           EXIT.
       
       CLR-DBC-GDG SECTION.
       INI-CLR-DBC-GDG.
       FIN-CLR-DBC-GDG.
           EXIT.
       
       FST-KEY-GDG SECTION.
       INI-FST-KEY-GDG.
           MOVE -1 TO GDG-CAI-GTIA-LEN IN GDG-FLD.
       FIN-FST-KEY-GDG.
           EXIT.
       
       FST-FLD-GDG SECTION.
       INI-FST-FLD-GDG.
      *<<<< INI_FST_FLD_GDG
           MOVE 0 TO DBC-NUM-ICLI-LEN IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-EST1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-EST2-ATR IN GDG-FLD.
           IF NOT (CMA-IND-DAP IN CMA-VARI = 'S' AND
                   SCR-CCPP = 'ING')
      *       No Es o No Ingresa Dep Plazo Propio
               MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-DEUD-ATR IN GDG-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD.

           IF SCR-CCPP = 'ING'
               MOVE SPACES TO WSS-EST-ANT IN CMA-VARI
      *         PERFORM ANL-HBL-COD-GRA
               PERFORM ANL-HBL-FEC-VTO
               MOVE -1           TO DBC-NUM-ICLI-LEN    IN GDG-FLD
               GO TO FIN-FST-FLD-GDG.

           IF SCR-CCPP = 'MOD'
               PERFORM ANL-HBL-DBC-ICLI
               PERFORM ANL-HBL-FEC-VTO
               IF SCR-CMND = 'MOD'
      *MHM-INI 16-OCT-2003
      *             MOVE -1 TO GDG-COD-OFIC-LEN IN GDG-FLD
                   MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
      *MHM-INI 16-OCT-2003
                   GO TO FIN-FST-FLD-GDG.

      *     MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FSOL-ATR IN GDG-FLD.

           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.

           IF SCR-CMND = 'ALZ' OR SCR-CMND = 'EJE'
      *MHM-INI 13-OCT-2003
               MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-RLCM-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-RLUN-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-RLVR-ATR IN GDG-FLD
      *MHM-FIN 13-OCT-2003
               MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-ATR IN GDG-FLD
      *ADA-INI 20-DIC-2002
               MOVE FRM-CPIM-AEY TO GDG-COD-TGCM-ATR IN GDG-FLD
      *ADA-FIN 20-DIC-2002
               MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-NUM-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-VRF-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD
               IF SCR-CMND = 'ALZ'
      * FLB
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *            MOVE FRM-CPIM-UBY TO GDG-FEC-FALZ-ATR IN GDG-FLD
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
                   MOVE FRM-CPIM-UBY TO GDG-COD-EST1-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD
      * FIN
      *MHM-INI 15-OCT-2003
      *             MOVE -1 TO GDG-IND-EST1-LEN IN GDG-FLD
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *            MOVE -1 TO GDG-FEC-FALZ-LEN IN GDG-FLD
                   MOVE WSS-CTE-M1 TO GDG-IND-EST1-LEN IN GDG-FLD
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      *MHM-INI 15-OCT-2003
      *EVA-AFRI/ABR2007                                                 
                    MOVE -1 TO GDG-IND-EST1-LEN IN GDG-FLD              
      *            MOVE -1 TO GDG-FEC-FALZ-LEN IN GDG-FLD               
      *FIN-AFRI/ABR2007                                                 
      *MHM-FIN 15-OCT-2003
               ELSE
               IF SCR-CMND = 'EJE'
                   MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD
                   MOVE -1 TO GDG-COD-EST2-LEN IN GDG-FLD
               ELSE
                   NEXT SENTENCE
           ELSE
           IF SCR-CMND = 'MGA'
      *MHM-INI 14-OCT-2003
      *         MOVE -1 TO GDG-GLS-DGTA-LEN IN GDG-FLD
               MOVE -1 TO GDG-COD-RLCM-LEN IN GDG-FLD
      *MHM-FIN 14-OCT-2003
      *MHM-INI 13-OCT-2003
               MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-IND-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-GLS-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-NUM-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-VRF-IPRO-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-IND-ECRS-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-COD-RERS-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-FEC-FVES-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-IND-ECRT-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-COD-RERT-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-FEC-FVET-ATR IN GDG-FLD
               MOVE FRM-CPIM-UBY TO GDG-COD-GACS-ATR IN GDG-FLD
      *MHM-FIN 13-OCT-2003
           ELSE
           IF (SCR-CMND = 'AGA' OR SCR-CMND = 'ACE')
               MOVE -1 TO GDG-GLS-MENS-LEN IN GDG-FLD.

           GO TO FIN-FST-FLD-GDG.
       ANL-HBL-DBC-ICLI.
           IF MULTIPLES-GDD

               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       ANL-HBL-COD-GRA.
      *         IF GAR-COD-GRA IN TAG = 'N'
      *             MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR IN GDG-FLD
      *             IF SCR-CCPP = 'ING'
      *                 MOVE SPACES TO GDG-COD-GRA IN GDG-FLD.
       ANL-HBL-FEC-VTO.
           IF GAR-IND-SVTO IN CMA-VARI = 'N'
               MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD
               IF SCR-CCPP = 'ING'
                   MOVE ZEROES TO GDG-NUM-SVTO IN GDG-FLD
                   MOVE ZEROES TO GDG-NUM-AVTO IN GDG-FLD
                   MOVE ZEROES TO GDG-NUM-MVTO IN GDG-FLD
                   MOVE ZEROES TO GDG-NUM-DVTO IN GDG-FLD.
       FIN-ANL-HBL-FEC-VTO.
      *>>>>
      *>>>>                                                             
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN GDG-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
      *<<<< FIN_FST_FLD_GDG
      *>>>>
       FIN-FST-FLD-GDG.
           EXIT.
       
       PRO-KEY-GDG SECTION.
       INI-PRO-KEY-GDG.
           PERFORM PRO-MKY-GDG.
       FIN-PRO-KEY-GDG.
           EXIT.
       
       PRO-MKY-GDG SECTION.
       INI-PRO-MKY-GDG.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-MKY-GDG.
           EXIT.
       
       PRO-FLD-GDG SECTION.
       INI-PRO-FLD-GDG.
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD.
           PERFORM PRO-GDG-GDG.
           PERFORM PRO-DBC-GDG.
       FIN-PRO-FLD-GDG.
           EXIT.
       
       PRO-GDG-GDG SECTION.
       INI-PRO-GDG-GDG.
           MOVE FRM-CPIM-AEY TO GDG-COD-RLCM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-RLUN-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-GLS-RLVR-ATR IN GDG-FLD.
      * OFI-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO GDG-COD-OFIC-ATR IN GDG-FLD.
      * OFI-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO GDG-COD-VCAM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IND-CBAN-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-GLS-DGT1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-CIC-EJOR-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FVTO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FEST-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-EST2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FSOL-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IND-EST1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-TGCM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-EST1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-MALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IND-ECRS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-RERS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FVES-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IND-ECRT-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-RERT-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-FVET-ATR IN GDG-FLD.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO GDG-NUM-IPRO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-VRF-IPRO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IND-IPRO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-GLS-IPRO-ATR IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-GACS-ATR IN GDG-FLD.
       FIN-PRO-GDG-GDG.
           EXIT.
       
       PRO-DBC-GDG SECTION.
       INI-PRO-DBC-GDG.
       FIN-PRO-DBC-GDG.
           EXIT.
       
       UNP-KEY-GDG SECTION.
       INI-UNP-KEY-GDG.
           PERFORM UNP-IKY-GDG.
           PERFORM UNP-AKY-GDG.
           PERFORM UNP-MKY-GDG.
       FIN-UNP-KEY-GDG.
           EXIT.
       
       UNP-IKY-GDG SECTION.
       INI-UNP-IKY-GDG.
           MOVE FRM-CPIM-UBY TO GDG-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GDG-IIC-GTIA-ATR.
      * IDG-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-TIP-CGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-STP-CGTA-ATR IN GDG-FLD.
      * IDG-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
      *<<<< FIN_UNP_IKY_GDG
      *MHM-INI 04-NOV-2004
      **MHM-INI 12-NOV-2003
      *     MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR.
      **MHM-FIN 12-NOV-2003
      *MHM-FIN 04-NOV-2004
      *>>>>
       FIN-UNP-IKY-GDG.
           EXIT.
       
       UNP-MKY-GDG SECTION.
       INI-UNP-MKY-GDG.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-MKY-GDG.
           EXIT.
       
       UNP-AKY-GDG SECTION.
       INI-UNP-AKY-GDG.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-GDG.
           EXIT.
       
       UNP-FLD-GDG SECTION.
       INI-UNP-FLD-GDG.
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-DEUD-ATR IN GDG-FLD.
           PERFORM UNP-GDG-GDG.
           PERFORM UNP-DBC-GDG.
       FIN-UNP-FLD-GDG.
           EXIT.
       
       UNP-GDG-GDG SECTION.
       INI-UNP-GDG-GDG.
           MOVE FRM-CPIM-UBY TO GDG-COD-RLCM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-RLUN-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-GLS-RLVR-ATR IN GDG-FLD.
      * OFI-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-COD-OFIC-ATR IN GDG-FLD.
      * OFI-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-COD-VCAM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-INOB-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-GLS-DGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-CBAN-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-GLS-DGT1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-CIC-EJOR-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FVTO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FEST-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-EST2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FSOL-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-EST1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-TGCM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-LGTA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-EST1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-MALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-ECRS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-RERS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FVES-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-ECRT-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-RERT-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-FVET-ATR IN GDG-FLD.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-NUM-IPRO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-VRF-IPRO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-IPRO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-GLS-IPRO-ATR IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-GACS-ATR IN GDG-FLD.
      *<<<< FIN_UNP_GDG_GDG
      *
           IF SCR-CMND NOT = 'EJE' AND
              SCR-CMND NOT = 'CAD' AND
              SCR-CMND NOT = 'CAN'
      *<<<< FMT_CHI
              AND SCR-CMND NOT = 'ALZ'
      *>>>>
              MOVE FRM-CPIM-AEY TO GDG-COD-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-COD-EST1-STP.                    
                                                                        
           IF SCR-CMND = 'ING'                                          
               MOVE '05'         TO GDG-IND-EST1 IN GDG-FLD             
      *                                                                 
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-ATR IN GDG-FLD          
              MOVE FRM-CPIM-AEY TO GDG-IND-EST1-STP.                    
      *>>>>                                                             
       FIN-UNP-GDG-GDG.
           EXIT.
       
       UNP-DBC-GDG SECTION.
       INI-UNP-DBC-GDG.
       FIN-UNP-DBC-GDG.
           EXIT.
       
       VAL-MKY-GDG SECTION.
       INI-VAL-MKY-GDG.
       FIN-VAL-MKY-GDG.
           EXIT.
       
       VAL-FLD-GDG SECTION.
       INI-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-TREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TREA-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-CAI-IOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-CAI-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-IIC-IOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-RLCM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-RLCM-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-RLUN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-RLUN-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-GLS-RLVR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-RLVR-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * OFI-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-COD-OFIC-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * OFI-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IND-INOB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IND-INOB-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IND-CBAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IND-CBAN-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-TSCN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-TSCN-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-CIC-EJOR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-CIC-EJOR-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-EJOR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EJOR-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-FEC-FALZ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-FEC-FALZ-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-FEC-FING.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-FEC-FING-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-FEC-FVTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-FEC-FVTO-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-FEC-FEST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-FEC-FEST-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-EST2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-EST2-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-EST2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EST2-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IND-GTAC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IND-GTAC-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-FEC-FSOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-FEC-FSOL-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-IND-EST1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IND-EST1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-IND-EST1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-IND-EST1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-TGCM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-TGCM-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-TGCM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TGCM-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-LGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-LGTA-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-LGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-LGTA-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-EST1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-EST1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-EST1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EST1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-MALZ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-MALZ-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-MALZ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-MALZ-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-ATRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ATRN-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IND-ECRS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IND-ECRS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-RERS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-RERS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-RERS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RERS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-FEC-FVES.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-FEC-FVES-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-IND-ECRT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IND-ECRT-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-RERT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-RERT-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-RERT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RERT-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-FEC-FVET.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-FEC-FVET-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-IND-IPRO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-IND-IPRO-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-GLS-IPRO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-GLS-IPRO-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-NUM-IPRO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-NUM-IPRO-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-VRF-IPRO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-VRF-IPRO-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-COD-DEUD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-DEUD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-DEUD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-DEUD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-GLS-NOMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-NOMP-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-GACS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-GACS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
       FIN-VAL-FLD-GDG.
           EXIT.
       
       VAL-FRM-GLS-TREA SECTION.
       INI-VAL-FRM-GLS-TREA.
       FIN-VAL-FRM-GLS-TREA.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
      *<<<< DBC_NUM_ICLI
      *MHM-INI 19-OCT-2002
           IF SCR-CMND = 'ING'
      *MHM-FIN 19-OCT-2002
             IF DBC-NUM-ICLI IN GDG-FLD NOT > ZEROES

                   PERFORM ERR-GLS
                   GO TO FIN-VAL-DBC-NUM-ICLI.
      *>>>>
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
      *<<<< INI_DBC_VRF_ICLI
               MOVE SPACES TO MSG-COD-MENS.
      *>>>>
           IF DBC-VRF-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI                                                
      *<<<< FMT_CHI                                                     
           IF SCR-CMND = 'ING'                                          
      *>>>>                                                             
           IF DBC-IND-ICLI IN GDG-FLD = 'M'                             
               MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD                   
               MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD                   
               MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD                   
               MOVE 'BGL'          TO MSG-COD-SIST                      
               MOVE 'GDGMDDIRNO'   TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE FRM-POS-CURS TO DBC-IND-ICLI-LEN IN GDG-FLD         
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DBC-VRF-ICLI.                              
                                                                        
           IF MSG-COD-MENS NOT > SPACES AND                             
              DBC-NUM-ICLI IN GDG-FLD NOT = ZEROES                      
               MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC      
               MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC      
               MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC      
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GET-CLI                                          
               MOVE FIO-STAT TO PGM-STAT-DBC                            
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'TAB'        TO MSG-COD-SIST                    
                   MOVE 'CLI    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDG-FLD         
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
               ELSE                                                     
               IF MSG-GLS-DESC > SPACES                                 
                      MOVE MSG-GLS-DESC TO FRM-MENS                     
                      MOVE FRM-SUAR-MAL TO FRM-SUAR                     
                      MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN              
                      PERFORM CPT-BLKS                                  
                      MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD          
                      GO TO FIN-VAL-DBC-VRF-ICLI.      
      *        ELSE                                                     
      *<<<< GEN_BCI                                                     
      *AFRI-INI                                                         
           IF SCR-CMND NOT = 'ING' AND
              SCR-CMND NOT = 'MOD' AND
              SCR-CMND NOT = 'MGA'
              GO TO FIN-VAL-DBC-VRF-ICLI.

           IF SCR-HDR-MRCA NOT = 'BCS'
      *AFRI-FIN                                                         
              MOVE DBC-COD-OFIC IN DBC TO GDG-COD-OFIC IN GDG-FLD
              MOVE DBC-COD-EJEC IN DBC TO GDG-CIC-EJOR IN GDG-FLD.
      *>>>>                                                             
      *AFRI-INI                                                         
           IF SCR-HDR-MRCA = 'BCS'
      * EVA-INI  07/08
              PERFORM VAL-VSN
              IF WSS-IND-TVSN IN WSS-VARI = 'N'
                 MOVE DBC-COD-OFIC IN DBC TO
                      GDG-COD-OFIC IN GDG-FLD
                 MOVE DBC-COD-EJEC IN DBC TO
                      GDG-CIC-EJOR IN GDG-FLD
              ELSE
                 MOVE SCR-USER TO GDG-CIC-EJOR IN GDG-FLD
                 PERFORM VAL-EJC
                 IF WSS-IND-EJEC IN WSS-VARI = 'N'
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                 ELSE
                    PERFORM VAL-CEN
                    IF WSS-IND-OCEN IN WSS-VARI = 'N' AND
                       SCR-CMND = 'ING'
                       MOVE USR-COD-OFUS TO
                            GDG-COD-OFIC IN GDG-FLD.
      * EVA-FIN  07/08
           MOVE DBC-CAI-ICLI IN DBC TO
                      CNE-DBC-CAI-ICLI.
           MOVE DBC-IIC-ICLI IN DBC TO
                      CNE-DBC-IIC-ICLI.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *AFRI-FIN
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           IF ( DBC-IND-ICLI IN GDG-FLD = WSS-CTE-M AND
                SCR-CCPP = WSS-CTE-MOD )
              MOVE WSS-CTE-MULTDEU TO DBC-GLS-NOMC IN GDG-FLD.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS                                                         
      *>>>>                                                             
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN GDG-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN GDG-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN GDG-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN GDG-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN GDG-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN GDG-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
       
       VAL-FRM-CAI-IOPD SECTION.
       INI-VAL-FRM-CAI-IOPD.
           IF FRM-CAI-IOPD IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD.
       FIN-VAL-FRM-CAI-IOPD.
           EXIT.
       
       VAL-FRM-IIC-IOPD SECTION.
       INI-VAL-FRM-IIC-IOPD.
      *<<<< GEN_BCI                                                     
           IF CMA-IND-DAP IN CMA-VARI NOT = 'S'                         
               GO TO FIN-VAL-FRM-IIC-IOPD.                              
                                                                        
           MOVE FRM-CAI-IOPD IN GDG-FLD TO OPD-CAI-IOPD IN OPD.         
           MOVE FRM-IIC-IOPD IN GDG-FLD TO OPD-IIC-IOPD IN OPD.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM DAP-FIO-OPD.                                         
           IF NOT FIO-STAT-OKS                                          
               IF SCR-CMND = 'ALZ' AND WSS-ALZ-DAP IN WSS-VARI = 'S'    
      *EVA-AFRI/ABR2007                                                 
                   MOVE 'BGL'          TO MSG-COD-SIST                  
      *FIN-AFRI/ABR2007                                                 
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MEN2                        
               ELSE                                                     
                   MOVE 'BGL'          TO MSG-COD-SIST                  
                   MOVE 'OPD    NEX'   TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
           ELSE                                                         
           IF OPD-COD-STAT IN OPD NOT = 'G'                             
               IF SCR-CMND = 'ALZ' AND                                  
                  WSS-ALZ-DAP IN WSS-VARI = 'S' AND                     
                  OPD-COD-STAT IN OPD = 'L'                             
                   MOVE 'OPD    YALIQ' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MEN2                        
               ELSE                                                     
                   MOVE 'BGL'            TO MSG-COD-SIST                
                   MOVE 'OPD    NOVIG'   TO MSG-COD-MENS                
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
           ELSE                                                         
           IF OPD-COD-GPOD IN OPD = 'N'                                 
                MOVE 'BGL'            TO MSG-COD-SIST                   
                MOVE 'OPDNOPERMITI'   TO MSG-COD-MENS                   
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
           ELSE                                                         
      * EVA-INI  07/08
           IF OPD-VAL-SCAP IN OPD NOT > ZEROES
                MOVE 'BGL'            TO MSG-COD-SIST
                MOVE 'OPD    CAP=0'   TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
      * EVA-FIN  07/08
               MOVE 'N'              TO GDG-IND-INOB IN GDG-FLD         
               IF OPD-MSC-TVAL IN OPD = '1'                             
                   MOVE 'BGL'        TO FIO-SIST                        
                   MOVE 'VSN'        TO TAB-COD-TTAB IN TAB             
                   MOVE 'GDGVCB DAP' TO TAB-COD-CTAB IN TAB             
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM GNS-FIO-TAB                                  
                   IF FIO-STAT-OKS AND                                  
                      TAB-IND-VIGE IN TAB = 'S'                         
      *            Version 'BCI'                                        
                       MOVE OPD-COD-VCAM IN OPD TO GDG-COD-VCAM IN GDG  
      *MHM-INI 29-DIC-2004                                              
      *                MOVE '01'                TO GDG-COD-TVCM IN GDG  
                       MOVE '01'                TO GDG-COD-TCGT IN GDG  
      *MHM-FIN 29-DIC-2004                                              
                       MOVE GDG-COD-VCAM IN GDG TO                      
                                               GDG-COD-VCAM IN GDG-FLD  
                   ELSE                                                 
      *            Version 'CST'                                        
                       MOVE OPD-COD-VCAM IN OPD TO                      
                                               GDG-COD-VCAM IN GDG-FLD  
               ELSE                                                     
                   MOVE OPD-COD-VCAM IN OPD TO GDG-COD-VCAM IN GDG-FLD. 
      *>>>>                                                             
      *>>>>                                                             
       FIN-VAL-FRM-IIC-IOPD.
           EXIT.
       
       VAL-GDG-COD-RLCM SECTION.
       INI-VAL-GDG-COD-RLCM.
           IF GDG-COD-RLCM IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-RLCM IN GDG-FLD.
      *<<<< GDG_COD_RLCM AND GEN_BCI                                    
      *MHM-INI 29-OCT-2003                                              
      *INI-AFRI/MAY-2005                                                
      *    IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND                
           IF (CMA-CIC-UING IN CMA-VARI = 'MIGRACION' OR                
              GDG-CAI-GTIA IN GDG-FLD = '0800') AND                     
      *FIN-AFRI/MAY-2005                                                
              GDG-COD-RLCM IN GDG-FLD NOT > SPACES                      
               GO TO FIN-VAL-GDG-COD-RLCM.                              
      *MHM-FIN 29-OCT-2003                                              
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-VAL-GDG-COD-RLCM.                              
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI.        
           IF WSS-CIC-CTAB IN WSS-VARI = '951' AND                      
              GDG-COD-RLCM IN GDG-FLD NOT > SPACES                      
               PERFORM ERR-GLS                                          
               GO TO FIN-VAL-GDG-COD-RLCM.                              
                                                                        
      *BUS-TAB busca glosa de codigo en tabla                           
           IF GDG-COD-RLCM IN GDG-FLD > SPACES                          
               MOVE 'TAB'  TO TAB-COD-SIST                              
               MOVE 'COM'  TO TAB-COD-TTAB IN TAB                       
               MOVE GDG-COD-RLCM IN GDG-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               IF MSG-COD-MENS IN MSG > SPACES                          
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-VAL-GDG-COD-RLCM.                          
      *>>>>                                                             
       FIN-VAL-GDG-COD-RLCM.
           EXIT.
       
       VAL-GDG-COD-RLUN SECTION.
       INI-VAL-GDG-COD-RLUN.
           IF GDG-COD-RLUN IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-RLUN IN GDG-FLD.
      *<<<< GDG_COD_RLUN AND GEN_BCI                                    
      *MHM-INI 29-OCT-2003                                              
      *INI-AFRI/MAY-2005                                                
      *    IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND                
           IF (CMA-CIC-UING IN CMA-VARI = 'MIGRACION' OR                
               GDG-CAI-GTIA IN GDG-FLD = '0800' ) AND                   
      *FIN-AFRI/MAY-2005                                                
              GDG-COD-RLUN IN GDG-FLD NOT > SPACES                      
               GO TO FIN-VAL-GDG-COD-RLUN.                              
      *MHM-FIN 29-OCT-2003                                              
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-VAL-GDG-COD-RLUN.                              
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI.        
           IF WSS-CIC-CTAB IN WSS-VARI = '951' AND                      
              GDG-COD-RLUN IN GDG-FLD NOT > SPACES                      
               PERFORM ERR-GLS                                          
               GO TO FIN-VAL-GDG-COD-RLUN.                              
      *>>>>                                                             
       FIN-VAL-GDG-COD-RLUN.
           EXIT.
       
       VAL-GDG-GLS-RLVR SECTION.
       INI-VAL-GDG-GLS-RLVR.
           IF GDG-GLS-RLVR IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-GLS-RLVR IN GDG-FLD.
      *<<<< GDG_GLS_RLVR AND GEN_BCI                                    
      *MHM-INI 29-OCT-2003                                              
      *INI-AFRI/MAY-2005                                                
      *    IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND                
           IF (CMA-CIC-UING IN CMA-VARI = 'MIGRACION' OR                
               GDG-CAI-GTIA IN GDG-FLD = '0800' ) AND                   
      *FIN-AFRI/MAY-2005                                                
               GDG-GLS-RLVR IN GDG-FLD NOT > SPACES                     
                GO TO FIN-VAL-GDG-GLS-RLVR.                             
      *MHM-FIN 29-OCT-2003                                              
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-VAL-GDG-GLS-RLVR.                              
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI.        
           IF WSS-CIC-CTAB IN WSS-VARI = '951' AND                      
              GDG-GLS-RLVR IN GDG-FLD NOT > SPACES                      
               PERFORM ERR-GLS                                          
               GO TO FIN-VAL-GDG-GLS-RLVR.                              
      *>>>>                                                             
       FIN-VAL-GDG-GLS-RLVR.
           EXIT.
      * OFI-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
           IF GDG-COD-OFIC IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GDG-FLD.
      *AFRI-INI                                                         
           IF SCR-HDR-MRCA = 'BCS'                                      
               IF GDG-COD-OFIC IN GDG-FLD NOT > SPACES                  
                   PERFORM ERR-GLS                                      
                   GO TO FIN-VAL-GDG-COD-OFIC.                          
      *AFRI-FIN
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           IF ( DBC-IND-ICLI IN GDG-FLD = WSS-CTE-M AND
                SCR-CCPP = WSS-CTE-MOD )
              MOVE GDG-CAI-GTIA IN GDG-FLD TO GDG-CAI-GTIA IN GDG
              MOVE GDG-IIC-GTIA IN GDG-FLD TO GDG-IIC-GTIA IN GDG
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM BGL-FIO-GDG
              IF FIO-STAT-OKS
                 MOVE GDG-COD-OFIC IN GDG TO OFI-COD-OFIC IN OFI
              ELSE
                 MOVE SPACES TO OFI-COD-OFIC IN OFI.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS                                                         
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE GDG-COD-OFIC IN GDG-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFIC IN GDG-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN GDG-FLD.
           IF GDG-COD-OFIC IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GDG-FLD.


      * EVA-INI  07/08
           IF  SCR-CMND = 'ING' OR
               SCR-CMND = 'MOD'

             IF SCR-HDR-MRCA = 'BCS' AND
                OFI-COD-MODL IN OFI NOT = '8'
                MOVE 'BGL'        TO MSG-COD-SIST
                MOVE 'ERR OFINOV' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GDG-COD-OFIC.

      * EVA-FIN  07/08
      * EVA-INI  07/08
      *AFRI-INI                                                         
      *    IF SCR-HDR-MRCA = 'BCS'
      *        MOVE OFI-COD-JFOF IN OFI TO
      *             GDG-CIC-EJOR IN GDG-FLD.
      *AFRI-FIN                                                         
      * EVA-FIN  07/08
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
      * OFI-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
           IF GDG-COD-VCAM IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-COD-VCAM.
      *<<<< GDG_COD_VCAM AND GEN_BCI                                    
           IF MSG-COD-MENS = 'COD    NEX'                               
               GO TO FIN-VAL-GDG-COD-VCAM.                              
      * Busca Tabla TAG                                                 
           MOVE GDG-TIP-CGTA IN GDG-FLD TO TAG-COD-TOPE IN TAG.         
           MOVE GDG-STP-CGTA IN GDG-FLD TO TAG-COD-SOPE IN TAG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'TAG    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GDG-COD-VCAM.                              
      *MHM-INI 30-SEP-2003                                              
           MOVE TAG-IND-SVTO IN TAG TO GAR-IND-SVTO IN CMA-VARI.        
      *MHM-FIN 30-SEP-2003                                              
                                                                        
      * Busca Codigo Cuenta Contable en Tabla DCC de GAR                
           MOVE 'BGL'                TO TAB-COD-SIST.                   
           MOVE 'DCC'                TO TAB-COD-TTAB IN TAB.            
           MOVE TAG-COD-CGTA IN TAG  TO WSS-COD-CGTA IN WSS-VARI-ADI.   
           MOVE GDG-COD-VCAM IN GDG-FLD TO WSS-VCB.                     
           MOVE WSS-COD-CTA          TO TAB-COD-CTAB IN TAB.            
           PERFORM BUS-TAB.                                             
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'DCC    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GDG-COD-VCAM.                              
      *>>>>                                                             
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-VCAM IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-COD-VCAM IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCAM IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN GDG-FLD.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-IND-INOB SECTION.
       INI-VAL-GDG-IND-INOB.
           IF GDG-IND-INOB IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-IND-INOB IN GDG-FLD.
      *<<<< GDG_IND_OBL_INS                                             
      *<<<< GEN_BCI                                                     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAG    NEX' TO MSG-COD-MENS                        
               MOVE 'BGL' TO MSG-COD-SIST                               
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GDG-IND-INOB.                              
                                                                        
           IF TAG-IND-EGIN IN TAG = 'N' OR                              
              GDG-IND-INOB IN GDG-FLD NOT > SPACES                      
               MOVE 'N' TO GDG-IND-INOB IN GDG-FLD.                     
                                                                        
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IND-INOB IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>                                                             
      *>>>>                                                             
      *VAL-COD Valida codigo de tabla                                   
      *EVA-AFRI/ABR2007                                                 
      *    MOVE 'BGL' TO TAB-COD-SIST.                                  
      *    MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.                          
      *    MOVE GDG-IND-INOB IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
      *    PERFORM VAL-COD.                                             
      *FIN-AFRI/ABR2007                                                 
       FIN-VAL-GDG-IND-INOB.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
           IF GDG-GLS-DGTA IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GDG-IND-CBAN SECTION.
       INI-VAL-GDG-IND-CBAN.
      *<<<<< INI_GDG_IND_CBAN                                           
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.     
           IF SCR-OFRM-SRV AND                                          
              SCR-CMND = 'ING' AND                                      
              GDG-IND-CBAN IN GDG-FLD NOT > SPACES                      
                MOVE SPACES TO GDG-IND-CBAN IN GDG-FLD                  
                GO TO FIN-VAL-GDG-IND-CBAN.                             
      *RRM-FIN 3-JUL-2002                                               
                                                                        
           IF ( GDG-IND-CBAN IN GDG-FLD NOT > SPACES )                  
               MOVE SPACES TO GDG-IND-CBAN IN GDG-FLD.                  
                                                                        
           IF  GDG-IND-CBAN IN GDG-FLD NOT = 'N' AND NOT = 'S'          
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'ICBAN   N/S' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
      *                                                                 
           IF GDG-IND-CBAN IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-IND-CBAN.
      *                                                                 
      * EVA-AFRI/ABR2007                                                
      *    IF  GDG-IND-CBAN IN GDG-FLD = 'N'                            
      *<<<< FMT_CHI                                                     
      *          MOVE ZEROES TO FRM-NUM-ICLI IN GDG-FLD                 
      *         MOVE SPACES TO FRM-IND-ICLI IN GDG-FLD                  
      *         MOVE SPACES TO FRM-GLS-ICLI IN GDG-FLD                  
      * AFRI-INI (14-07-04)                                             
      *         MOVE SPACES TO FRM-VRF-ICLI IN GDG-FLD                  
      * AFRI-FIN (14-07-04)                                             
      *         MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD.       
      *FIN-AFRI/ABR2007                                                 
      *>>>>                                                             
      *EVA-AFRI/ABR2007                                                 
      *     IF  GDG-IND-CBAN IN GDG-FLD = 'S'                           
      *         MOVE SPACES TO  FRM-GLS-NOMC IN GDG-FLD                 
      *         MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-ATR IN GDG-FLD        
      *         MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-STP.                  
      *>>>>                                                             
      *     IF GDG-IND-CBAN IN GDG-FLD NOT > SPACES                     
      *          PERFORM ERR-GLS                                        
      *          GO TO FIN-VAL-GDG-IND-CBAN.                            
                                                                        
           IF  GDG-IND-CBAN IN GDG-FLD = 'S'                            
               MOVE SPACES TO  GDG-GLS-NOMP IN GDG-FLD                  
               MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-ATR IN GDG-FLD         
               MOVE FRM-CPIM-AEY TO GDG-GLS-NOMP-STP                    
           ELSE                                                         
               MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-ATR IN GDG-FLD         
               MOVE FRM-CPIM-UBY TO GDG-GLS-NOMP-STP.                   
      *>>>>                                                             
      *     IF GDG-IND-CBAN IN GDG-FLD NOT > SPACES                     
      *          PERFORM ERR-GLS                                        
      *          GO TO FIN-VAL-GDG-IND-CBAN.                            
      *FIN-AFRI/ABR2007                                                 
       FIN-VAL-GDG-IND-CBAN.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
           IF GDG-GLS-DGT1 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-GLS-DGT1 IN GDG-FLD.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
       
       VAL-GDG-COD-TSCN SECTION.
       INI-VAL-GDG-COD-TSCN.
       FIN-VAL-GDG-COD-TSCN.
           EXIT.
       
       VAL-GDG-CIC-EJOR SECTION.
       INI-VAL-GDG-CIC-EJOR.
           IF GDG-CIC-EJOR IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-CIC-EJOR IN GDG-FLD.
      *<<<< GDG_CIC_EJOR AND GEN_BCI                                    
           IF GDG-CIC-EJOR IN GDG-FLD = SPACES AND                      
              CMA-IND-DAP IN CMA-VARI = 'S'                             
               MOVE OPD-COD-EJEC IN OPD TO GDG-CIC-EJOR IN GDG-FLD.     
                                                                        
           IF SCR-CMND = 'ALZ'                                          
               GO TO FIN-VAL-GDG-CIC-EJOR.                              
      *>>>>                                                             
      * EVA-INI   07/08                                                 
      *AFRI-INI                                                         
      *    IF SCR-HDR-MRCA = 'BCS'                                      
      *        MOVE OFI-COD-JFOF IN OFI TO                              
      *             GDG-CIC-EJOR IN GDG-FLD                             
      *        GO TO VAL-SOL-USR.                                       
      *AFRI-FIN                                                         
      * EVA-FIN   07/08                                                 
      * EVA-INI   07/08                                                 
           IF SCR-HDR-MRCA = 'BCS' AND                                  
              WSS-IND-TVSN IN WSS-VARI = 'N'                            
              MOVE DBC-COD-OFIC IN DBC TO GDG-COD-OFIC IN GDG-FLD       
              MOVE DBC-COD-EJEC IN DBC TO GDG-CIC-EJOR IN GDG-FLD.      
      * EVA-FIN   07/08
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           IF ( DBC-IND-ICLI IN GDG-FLD = WSS-CTE-M AND
                SCR-CCPP = WSS-CTE-MOD )
              MOVE GDG-COD-OFIC IN GDG TO GDG-COD-OFIC IN GDG-FLD
              MOVE GDG-CIC-EJOR IN GDG TO GDG-CIC-EJOR IN GDG-FLD.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
      *VAL-TDU Valida Tipo de Usuario                                   
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.                   
           MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
      **AFRI-INI/SEP2009
           IF USR-IND-VIGE IN USR = 'N'                                 
               GO TO VAL-SOL-USR.                                       
      **AFRI-FIN/SEP2009
           IF MSG-COD-MENS > SPACES                                     
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
      *<<<< FIN_GDG_CIC_EJOR                                            
      *AFRI-INI                                                         
       VAL-SOL-USR.                                                     
      *AFRI-FIN                                                         
      *BUS-USR busca usuario en tablas                                  
           IF GDG-CIC-EJOR IN GDG-FLD > SPACES                          
               MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR      
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN GDG-FLD      
           ELSE                                                         
               MOVE SPACES              TO FRM-GLS-EJOR IN GDG-FLD.  
           GO TO FIN-VAL-GDG-CIC-EJOR.       
      *>>>>         
      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.
           MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *<<<< FIN_GDG_CIC_EJOR                                            
      *AFRI-INI                                                         
       VAL-SOL-USR.                                                     
      *AFRI-FIN                                                         
      *BUS-USR busca usuario en tablas                                  
           IF GDG-CIC-EJOR IN GDG-FLD > SPACES                          
               MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR      
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN GDG-FLD      
           ELSE                                                         
               MOVE SPACES              TO FRM-GLS-EJOR IN GDG-FLD.     
       FIN-VAL-GDG-CIC-EJOR.
           EXIT.
       
       VAL-FRM-GLS-EJOR SECTION.
       INI-VAL-FRM-GLS-EJOR.
       FIN-VAL-FRM-GLS-EJOR.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-FEC-FALZ SECTION.
       INI-VAL-GDG-FEC-FALZ.
           IF GDG-FEC-FALZ IN GDG-FLD  NOT > ZEROES
              MOVE ZEROES TO GDG-FEC-FALZ IN GDG-FLD.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-FALZ IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_ALZ                                             
      *MPS-INI 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
           IF SCR-CMND = WSS-CTE-ALZ AND
              GDG-FEC-FALZ IN GDG-FLD = ZEROES                          
               PERFORM GET-FHOY
               MOVE HOY-SHOY TO GDG-NUM-SALZ IN GDG-FLD                 
               MOVE HOY-AHOY TO GDG-NUM-AALZ IN GDG-FLD                 
               MOVE HOY-MHOY TO GDG-NUM-MALZ IN GDG-FLD                 
               MOVE HOY-DHOY TO GDG-NUM-DALZ IN GDG-FLD.                
      *MPS-FIN 05-JUN-2017 REVALORIZACIONES GARANTIAS 2
      
           IF GDG-IND-EST1 IN GDG-FLD < '20'                            
      *MHM-INI 14-OCT-2003                                              
              OR SCR-CMND = 'EJE'                                       
      *MHM-FIN 14-OCT-2003                                              
               MOVE 0 TO GDG-NUM-SALZ IN GDG-FLD                        
               MOVE 0 TO GDG-NUM-AALZ IN GDG-FLD                        
               MOVE 0 TO GDG-NUM-MALZ IN GDG-FLD                        
               MOVE 0 TO GDG-NUM-DALZ IN GDG-FLD                        
               GO TO FIN-VAL-GDG-FEC-FALZ.                              
                                                                        
      * ALZAMIENTO                                                      
           MOVE FEC-FBLK-N  TO FEC-FBLK.                                
      *>>>>                                                             
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-FALZ IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-FALZ.
      *<<<< GDG_FEC_ALZ                                                 
                                                                        
           IF NOT FEC-STAT-OKS                                          
               GO TO FIN-VAL-GDG-FEC-FALZ.                              
                                                                        
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
                                                                        
           MOVE GDG-NUM-SEST IN GDG-FLD TO FEC-SEC1.                    
           MOVE GDG-NUM-AEST IN GDG-FLD TO FEC-AEC1.                    
           MOVE GDG-NUM-MEST IN GDG-FLD TO FEC-MEC1.                    
           MOVE GDG-NUM-DEST IN GDG-FLD TO FEC-DEC1.                    
                                                                        
                                                                        
           MOVE GDG-NUM-SALZ IN GDG-FLD TO FEC-SEC2.                    
           MOVE GDG-NUM-AALZ IN GDG-FLD TO FEC-AEC2.                    
           MOVE GDG-NUM-MALZ IN GDG-FLD TO FEC-MEC2.                    
           MOVE GDG-NUM-DALZ IN GDG-FLD TO FEC-DEC2.                    
                                                                        
                                                                        
           MOVE FEC-CMP-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
           IF FEC-STAT-GRT                                              
               MOVE 'ALZ<CNS' TO MSG-COD-MENS                           
               MOVE 'BGL'     TO MSG-COD-SIST                           
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS                     
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
      *>>>>                                                             
       FIN-VAL-GDG-FEC-FALZ.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-FEC-FING SECTION.
       INI-VAL-GDG-FEC-FING.
           IF GDG-FEC-FING IN GDG-FLD  NOT > ZEROES
              MOVE ZEROES TO GDG-FEC-FING IN GDG-FLD.
       FIN-VAL-GDG-FEC-FING.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-FEC-FVTO SECTION.
       INI-VAL-GDG-FEC-FVTO.
           IF GDG-FEC-FVTO IN GDG-FLD  NOT > ZEROES
              MOVE ZEROES TO GDG-FEC-FVTO IN GDG-FLD.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-FVTO IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_FVTO
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.     
            IF SCR-OFRM-SRV AND                                         
               SCR-CMND = 'ING' AND                                     
               GDG-FEC-FVTO IN GDG-FLD NOT > ZEROES                     
      *PVC-INI/MAR-2013 - Gtias Activadas Sin Fecha Venc. (52427)       
      *         GO TO FIN-VAL-GDG-FEC-FVTO.                             
                MOVE ZEROES TO GDG-FEC-FVTO IN GDG-FLD.                 
            IF SCR-OFRM-SRV AND                                         
               SCR-CMND = 'ING' AND                                     
               GDG-FEC-FVTO IN GDG-FLD > ZEROES                         
      *PVC-FIN/MAR-2013                                                 
                GO TO FIN-VAL-GDG-FEC-FVTO.                             
      *RRM-FIN 3-JUL-2002                                               
      *------------------------------------------------*                
      *MHM-INI 13-AUG-2003                                              
           IF GDG-COD-LGTA IN GDG-FLD NOT = 'E'                         
               GO TO CNT-VAL-GDG-FEC-FVTO.                              
                                                                        
           IF GAR-IND-SVTO IN CMA-VARI = 'N'                            
               GO TO CNT-VAL-GDG-FEC-FVTO.                              
                                                                        
      *MHM-INI 30-SEP-2003                                              
      *     IF SCR-CMND NOT = 'ING' AND SCR-CMND = 'MOD'                
      *         GO TO FIN-VAL-GDG-FEC-FVTO.                             
      *MHM-FIN 30-SEP-2003                                              
                                                                        
           IF (((SCR-CMND NOT = 'AGA')  AND                             
               ((SCR-CMND NOT = 'MGA')) AND                             
                (SCR-CMND NOT = 'ACE')))                                
               GO TO CNT-VAL-GDG-FEC-FVTO.                              
                                                                        
           MOVE ZEROES TO WSS-NUM-SVTO IN WSS-VARI.                     
           MOVE ZEROES TO WSS-NUM-AVTO IN WSS-VARI.                     
           MOVE ZEROES TO WSS-NUM-MVTO IN WSS-VARI.                     
           MOVE ZEROES TO WSS-NUM-DVTO IN WSS-VARI.                     
                                                                        
           MOVE GDG-CAI-GTIA IN GDG-FLD TO GES-CAI-GTIA IN GES.         
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GES-IIC-GTIA IN GES.         
           MOVE ZEROES              TO GES-NUM-IGES IN GES.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-LEE-GES.                                                     
           PERFORM BGL-FIO-GES.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GES-CAI-GTIA IN GES = GDG-CAI-GTIA IN GDG-FLD AND         
              GES-IIC-GTIA IN GES = GDG-IIC-GTIA IN GDG-FLD )           
               GO TO FIN-VAL-GDG-FEC-FVTO.                              
                                                                        
           MOVE GES-CAI-IOPC IN GES TO DLC-CAI-IOPC IN DLC.             
           MOVE GES-IIC-IOPC IN GES TO DLC-IIC-IOPC IN DLC.             
           MOVE GES-NUM-IDLC IN GES TO DLC-NUM-IDLC IN DLC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-DLC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'DLC    NEX' TO MSG-COD-MENS                        
               GO TO ERR-VAL-GDG-FEC-FVTO.                              
                                                                        
           IF DLC-FEC-FMAV IN DLC > WSS-FEC-FVTO IN WSS-VARI            
              MOVE DLC-FEC-FMAV IN DLC TO WSS-FEC-FVTO IN WSS-VARI      
              MOVE WSS-NUM-SVTO IN WSS-VARI TO GDG-NUM-SVTO IN GDG-FLD  
              MOVE WSS-NUM-AVTO IN WSS-VARI TO GDG-NUM-AVTO IN GDG-FLD  
              MOVE WSS-NUM-MVTO IN WSS-VARI TO GDG-NUM-MVTO IN GDG-FLD  
              MOVE WSS-NUM-DVTO IN WSS-VARI TO GDG-NUM-DVTO IN GDG-FLD. 
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-LEE-GES.                                           
                                                                        
       CNT-VAL-GDG-FEC-FVTO.                                            
      *MHM-FIN 13-AUG-2003                                              
           MOVE FEC-VHBL-N    TO FEC-VHBL.                              
                                                                        
           MOVE GDG-NUM-SVTO IN GDG-FLD TO FEC-SVLD.                    
           MOVE GDG-NUM-AVTO IN GDG-FLD TO FEC-AVLD.                    
           MOVE GDG-NUM-MVTO IN GDG-FLD TO FEC-MVLD.                    
           MOVE GDG-NUM-DVTO IN GDG-FLD TO FEC-DVLD.                    
                                                                        
      *<<<< GEN_BCI                                                     
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
                                                                        
           MOVE GDG-NUM-SVTO IN GDG-FLD TO FEC-SVLD.                    
           MOVE GDG-NUM-AVTO IN GDG-FLD TO FEC-AVLD.                    
           MOVE GDG-NUM-MVTO IN GDG-FLD TO FEC-MVLD.                    
           MOVE GDG-NUM-DVTO IN GDG-FLD TO FEC-DVLD.                    
           IF GAR-IND-SVTO IN CMA-VARI = 'S'                            
      *MHM-INI 27-DIC-2004                                              
      *        IF FEC-FVLD = '00000000' OR > '20201231'                 
               IF FEC-FVLD = '00000000' OR > '20991231'                 
      *MHM-FIN 27-DIC-2004                                              
                   MOVE 'VTO=0' TO MSG-COD-MENS                         
                   GO TO ERR-VAL-GDG-FEC-FVTO                           
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
           IF GAR-IND-SVTO IN CMA-VARI = 'N'                            
      *MHM-INI 29-SEP-2003                                              
               OR ( GAR-IND-SVTO IN CMA-VARI = 'O' AND                  
                    FEC-FVLD = '00000000' )                             
      *MHM-FIN 29-SEP-2003                                              
               MOVE 20 TO GDG-NUM-SVTO IN GDG-FLD                       
               MOVE 99 TO GDG-NUM-AVTO IN GDG-FLD                       
               MOVE 12 TO GDG-NUM-MVTO IN GDG-FLD                       
               MOVE 31 TO GDG-NUM-DVTO IN GDG-FLD                       
               GO TO FIN-VAL-GDG-FEC-FVTO.                              
      *>>>>                                                             
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
      *>>>>                                                             
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-FVTO IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-FVTO.
      *<<<< GDG_FEC_VTO                                                 
                                                                        
           MOVE GDG-NUM-SSOL IN GDG-FLD TO FEC-SEC1.                    
           MOVE GDG-NUM-ASOL IN GDG-FLD TO FEC-AEC1.                    
           MOVE GDG-NUM-MSOL IN GDG-FLD TO FEC-MEC1.                    
           MOVE GDG-NUM-DSOL IN GDG-FLD TO FEC-DEC1.                    
      *-----------------------------------------------*                 
           MOVE GDG-NUM-SVTO IN GDG-FLD TO FEC-SEC2.                    
           MOVE GDG-NUM-AVTO IN GDG-FLD TO FEC-AEC2.                    
           MOVE GDG-NUM-MVTO IN GDG-FLD TO FEC-MEC2.                    
           MOVE GDG-NUM-DVTO IN GDG-FLD TO FEC-DEC2.                    
      *-----------------------------------------------*                 
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-CMP-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-LES                                          
               MOVE 'VTO<=SOL' TO MSG-COD-MENS                          
               GO TO ERR-VAL-GDG-FEC-FVTO.                              
                                                                        
           GO TO FIN-VAL-GDG-FEC-FVTO.                                  
       ERR-VAL-GDG-FEC-FVTO.                                            
           MOVE 'BGL'     TO MSG-COD-SIST.                              
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE FRM-SUAR-MAL TO FRM-SUAR.                               
      *>>>>      
       FIN-VAL-GDG-FEC-FVTO.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-FEC-FEST SECTION.
       INI-VAL-GDG-FEC-FEST.
           IF GDG-FEC-FEST IN GDG-FLD  NOT > ZEROES
              MOVE ZEROES TO GDG-FEC-FEST IN GDG-FLD.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-FEST IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_ESC_CNS                                         
                                                                        
           IF GDG-IND-EST1 IN GDG-FLD < '10'                            
               MOVE 0 TO GDG-NUM-SEST IN GDG-FLD                        
               MOVE 0 TO GDG-NUM-AEST IN GDG-FLD                        
               MOVE 0 TO GDG-NUM-MEST IN GDG-FLD                        
               MOVE 0 TO GDG-NUM-DEST IN GDG-FLD                        
               GO TO FIN-VAL-GDG-FEC-FEST.                              
                                                                        
           IF GDG-IND-EST1 IN GDG-FLD > '19'                            
               GO TO FIN-VAL-GDG-FEC-FEST.                              
      *>>>>                                                             
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-FEST IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-FEST.
      *<<<< GDG_FEC_ESC_CNS                                             
                                                                        
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           MOVE GDG-NUM-SEST IN GDG-FLD TO FEC-SEC1.                    
           MOVE GDG-NUM-AEST IN GDG-FLD TO FEC-AEC1.                    
           MOVE GDG-NUM-MEST IN GDG-FLD TO FEC-MEC1.                    
           MOVE GDG-NUM-DEST IN GDG-FLD TO FEC-DEC1.                    
      *------------------------------------------------------*          
           MOVE GDG-NUM-SEST IN GDG-FLD TO FEC-SEC2.                    
           MOVE GDG-NUM-AEST IN GDG-FLD TO FEC-AEC2.                    
           MOVE GDG-NUM-MEST IN GDG-FLD TO FEC-MEC2.                    
           MOVE GDG-NUM-DEST IN GDG-FLD TO FEC-DEC2.                    
                                                                        
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-CMP-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
           IF FEC-STAT-GRT                                              
               MOVE 'ESC<SOL' TO MSG-COD-MENS                           
               PERFORM ERR-VAL-GDG-FEC-FVTO                             
               GO TO FIN-VAL-GDG-FEC-FEST.                              
                                                                        
           PERFORM GET-FHOY.                                            
           MOVE HOY-SHOY TO FEC-SEC1.                                   
           MOVE HOY-AHOY TO FEC-AEC1.                                   
           MOVE HOY-MHOY TO FEC-MEC1.                                   
           MOVE HOY-DHOY TO FEC-DEC1.                                   
                                                                        
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-CMP-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
           IF FEC-STAT-LES                                              
               MOVE 'ESC>HOY' TO MSG-COD-MENS                           
               PERFORM ERR-VAL-GDG-FEC-FVTO                             
               GO TO FIN-VAL-GDG-FEC-FEST.                              
                                                                        
      *>>>>  
       FIN-VAL-GDG-FEC-FEST.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GDG-COD-EST2 SECTION.
       INI-VAL-GDG-COD-EST2.
           IF GDG-COD-EST2 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-EST2 IN GDG-FLD.
      *<<<< GDG_ES2                                                     
           IF (SCR-CCPP = 'ING') OR                                     
              (SCR-CMND NOT = 'EJE') AND                                
              (GDG-COD-EST2 IN GDG-FLD NOT > SPACES)                    
                                                                        
                MOVE SPACES TO GDG-COD-EST2 IN GDG-FLD                  
                MOVE SPACES TO FRM-GLS-EST2 IN GDG-FLD                  
                GO TO FIN-VAL-GDG-COD-EST2.                             
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'ES2' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-COD-EST2 IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
                                                                        
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              GDG-COD-EST2 IN GDG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-EST2 IN GDG-FLD                   
               GO TO FIN-VAL-GDG-COD-EST2                               
           ELSE                                                         
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-EST2 IN GDG-FLD.                            
      *                                                                 
           IF (GDG-COD-EST2 IN GDG-FLD NOT = WSS-ES2-ANT IN CMA-VARI)   
               IF  GDG-COD-EST2 IN GDG-FLD > 10  OR                     
                   (WSS-ES2-ANT IN CMA-VARI = SPACES AND                
                    GDG-COD-EST2  IN GDG-FLD  > 05)                     
                                                                        
               OR (WSS-ES2-ANT IN CMA-VARI = 05     AND                 
                   GDG-COD-EST2     IN GDG-FLD  NOT > 05)               
                  MOVE 'BGL' TO MSG-COD-SIST                            
                  MOVE 'GDGEJENOPERM' TO MSG-COD-MENS                   
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-GDG-COD-EST2.                           
      *                                                                 
      *>>>>                                                             
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'ES2 ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-EST2 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-COD-EST2 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-EST2 IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-EST2 IN GDG-FLD.
       FIN-VAL-GDG-COD-EST2.
           EXIT.
       
       VAL-FRM-GLS-EST2 SECTION.
       INI-VAL-FRM-GLS-EST2.
       FIN-VAL-FRM-GLS-EST2.
           EXIT.
       
       VAL-GDG-IND-GTAC SECTION.
       INI-VAL-GDG-IND-GTAC.
      *<<<< GDG_IND_CPL                                                 
      *FLB CST  22-NOV-1993                                             
           IF GDG-IND-GTAC IN GDG-FLD NOT > SPACES                      
              MOVE 'N' TO GDG-IND-GTAC IN GDG-FLD.                      
      *>>>>                                                             
       FIN-VAL-GDG-IND-GTAC.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-FEC-FSOL SECTION.
       INI-VAL-GDG-FEC-FSOL.
           IF GDG-FEC-FSOL IN GDG-FLD  NOT > ZEROES
              MOVE ZEROES TO GDG-FEC-FSOL IN GDG-FLD.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-FSOL IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_SOL_CNS                                         
           MOVE GDG-NUM-DSOL IN GDG-FLD TO FEC-ITM1.                    
           MOVE GDG-NUM-MSOL IN GDG-FLD TO FEC-ITM2.                    
           MOVE GDG-NUM-SSOL IN GDG-FLD TO FEC-ITM3.                    
           MOVE GDG-NUM-ASOL IN GDG-FLD TO FEC-ITM4.                    
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
              MOVE FEC-CHOY-N TO FEC-CHOY.                              
      *AFRI-FIN/JUL2005                                                 
           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *>>>>                                                             
           MOVE FEC-VAL-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
      *AFRI-INI/JUL2005                                                 
           IF FEC-STAT-FER                                              
              MOVE FEC-FORM-FEC TO FEC-FORM                             
              MOVE FEC-FBLK-N  TO FEC-FBLK                              
              MOVE FEC-CHOY-N  TO FEC-CHOY                              
              MOVE FEC-SIG-HBL TO FEC-CMND                              
              PERFORM CAL-FEC                                           
              MOVE '00'  TO FEC-STAT.                                   
      *AFRI-FIN/JUL2005                                                 
           IF FEC-STAT-OKS                                              
               MOVE FEC-FECH TO GDG-FEC-FSOL IN GDG-FLD                 
           ELSE                                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE FEC-MENS     TO FRM-MENS                            
               GO TO FIN-VAL-GDG-FEC-FSOL.

           GO TO FIN-VAL-GDG-FEC-FSOL.                           
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-FSOL IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-FSOL.
       FIN-VAL-GDG-FEC-FSOL.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GDG-IND-EST1 SECTION.
       INI-VAL-GDG-IND-EST1.
           IF GDG-IND-EST1 IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-IND-EST1.
      *<<<< GDG_IND-EST1                                                
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'ES1' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-IND-EST1 IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              GDG-IND-EST1 IN GDG-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-IND-EST1 IN GDG-FLD               
               GO TO FIN-VAL-GDG-IND-EST1.                              
                                                                        
           MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-IND-EST1 IN GDG-FLD.     
      *-----------------------------------------------------------*     
      *MHM-INI 14-OCT-2003                                              
           IF SCR-CMND = 'EJE' AND GDG-IND-EST1 IN GDG-FLD > '19'       
               MOVE 'GDGES1NPEJE' TO MSG-COD-MENS                       
               GO TO ERR-VAL-GDG-IND-EST1.                              
      *MHM-FIN 14-OCT-2003                                              
           IF SCR-CCPP = 'ING'  OR                                      
              GAR-IND-GTAC IN CMA-VARI NOT = 'S'                        
                                                                        
               IF GDG-IND-EST1 IN GDG-FLD > '05'                        
                   MOVE 'GDGES1NOVIG' TO MSG-COD-MENS                   
                   GO TO ERR-VAL-GDG-IND-EST1                           
               ELSE                                                     
                   GO TO FIN-VAL-GDG-IND-EST1.                          
      *-----------------------------------------------------------*     
      * CAMBIOS DE ESTADO                                               
           IF GDG-IND-EST1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI     
                                                                        
               IF NOT (GDG-IND-EST1 IN GDG-FLD =                        
                                    WSS-ES1-1 IN CMA-VARI OR            
                  GDG-IND-EST1 IN GDG-FLD = WSS-ES1-2 IN CMA-VARI OR    
                  GDG-IND-EST1 IN GDG-FLD = WSS-ES1-3 IN CMA-VARI OR    
                  GDG-IND-EST1 IN GDG-FLD = WSS-ES1-4 IN CMA-VARI)      
                  MOVE 'ES1NVOANT' TO MSG-COD-MENS                      
                  GO TO ERR-VAL-GDG-IND-EST1.                           
                                                                        
      *<<<< GEN_BCI                                                     
                                                                        
      * ALZAMIENTO                                                      
           IF SCR-CMND = 'ALZ' AND GDG-IND-EST1 IN GDG-FLD < '20'       
                   MOVE 'GDGALZES1' TO MSG-COD-MENS                     
                   GO TO ERR-VAL-GDG-IND-EST1.                          
                                                                        
           GO TO FIN-VAL-GDG-IND-EST1.                                  
                                                                        
      *>>>>                                                             
       ERR-VAL-GDG-IND-EST1.                                            
           MOVE 'BGL' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE FRM-SUAR-MAL TO FRM-SUAR.                               
      *>>>>                                                             
       FIN-VAL-GDG-IND-EST1.
           EXIT.
       
       VAL-FRM-GLS-IND-EST1 SECTION.
       INI-VAL-FRM-GLS-IND-EST1.
       FIN-VAL-FRM-GLS-IND-EST1.
           EXIT.
       
       VAL-GDG-COD-TGCM SECTION.
       INI-VAL-GDG-COD-TGCM.
           IF GDG-COD-TGCM IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-TGCM IN GDG-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'GCM ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-TGCM IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-COD-TGCM IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TGCM IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TGCM IN GDG-FLD.
       FIN-VAL-GDG-COD-TGCM.
           EXIT.
       
       VAL-FRM-GLS-TGCM SECTION.
       INI-VAL-FRM-GLS-TGCM.
       FIN-VAL-FRM-GLS-TGCM.
           EXIT.
       
       VAL-GDG-COD-LGTA SECTION.
       INI-VAL-GDG-COD-LGTA.
           IF GDG-COD-LGTA IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-COD-LGTA.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'LIM ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-LGTA IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-COD-LGTA IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-LGTA IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-LGTA IN GDG-FLD.
       FIN-VAL-GDG-COD-LGTA.
           EXIT.
       
       VAL-FRM-GLS-LGTA SECTION.
       INI-VAL-FRM-GLS-LGTA.
       FIN-VAL-FRM-GLS-LGTA.
           EXIT.
       
       VAL-GDG-COD-EST1 SECTION.
       INI-VAL-GDG-COD-EST1.
           IF GDG-COD-EST1 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-EST1 IN GDG-FLD.
      *<<<< GDG_COD_EST1                                                
      *<<<< GEN_BCI                                                     
           IF GDG-IND-EST1 IN GDG-FLD < '20'                            
               MOVE SPACES TO GDG-COD-EST1 IN GDG-FLD                   
               MOVE SPACES TO FRM-GLS-EST1 IN GDG-FLD                   
               GO TO FIN-VAL-GDG-COD-EST1.                              
                                                                        
           IF GDG-COD-EST1 IN GDG-FLD NOT > SPACES                      
               PERFORM ERR-GLS                                          
               GO TO FIN-VAL-GDG-COD-EST1.                              
      *>>>>                                                             
      *>>>>                                                             
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ALZ ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-EST1 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-COD-EST1 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-EST1 IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-EST1 IN GDG-FLD.
       FIN-VAL-GDG-COD-EST1.
           EXIT.
       
       VAL-FRM-GLS-EST1 SECTION.
       INI-VAL-FRM-GLS-EST1.
       FIN-VAL-FRM-GLS-EST1.
           EXIT.
       
       VAL-GDG-COD-MALZ SECTION.
       INI-VAL-GDG-COD-MALZ.
           IF GDG-COD-MALZ IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-MALZ IN GDG-FLD.
      *<<<< GDG_COD_MALZ                                                
           IF SCR-CMND NOT = 'ALZ'                                      
               GO TO FIN-VAL-GDG-COD-MALZ.                              
                                                                        
           IF GDG-COD-MALZ IN GDG-FLD NOT > SPACES AND SCR-CMND = 'ALZ' 
               PERFORM ERR-GLS                                          
               GO TO FIN-VAL-GDG-COD-MALZ.                              
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'MAL' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-COD-MALZ IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX'                               
               MOVE SPACES TO FRM-GLS-MALZ IN GDG-FLD                   
               GO TO FIN-VAL-GDG-COD-MALZ.                              
                                                                        
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-MALZ IN GDG-FLD.         
      *>>>>                                                             
       FIN-VAL-GDG-COD-MALZ.
           EXIT.
       
       VAL-FRM-GLS-MALZ SECTION.
       INI-VAL-FRM-GLS-MALZ.
       FIN-VAL-FRM-GLS-MALZ.
           EXIT.
       
       VAL-FRM-GLS-ATRN SECTION.
       INI-VAL-FRM-GLS-ATRN.
      *<<<<
           IF SCR-CMND = 'ALZ' AND SCR-HDR-MRCA = 'BCS'                 
              MOVE 'CONOSUR'  TO FRM-GLS-ATRN IN GDG-FLD.               
      *>>>>
       FIN-VAL-FRM-GLS-ATRN.
           EXIT.
       
       VAL-GDG-IND-ECRS SECTION.
       INI-VAL-GDG-IND-ECRS.
           IF GDG-IND-ECRS IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-IND-ECRS IN GDG-FLD.
      *<<<< GDG_IND_ECRS AND GEN_BCI                                    
           IF SCR-CMND NOT = 'MGA'                                      
               GO TO FIN-VAL-GDG-IND-ECRS.                              
                                                                        
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.                          
           MOVE GDG-IND-ECRS IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           GO TO FIN-VAL-GDG-IND-ECRS.                                  
                                                                        
      *>>>>                                                             
       FIN-VAL-GDG-IND-ECRS.
           EXIT.
       
       VAL-GDG-COD-RERS SECTION.
       INI-VAL-GDG-COD-RERS.
           IF GDG-COD-RERS IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-RERS IN GDG-FLD.
      *<<<< GDG_COD_RERS AND GEN_BCI                                    
           IF SCR-CMND NOT = 'MGA'                                      
               GO TO FIN-VAL-GDG-COD-RERS.                              
                                                                        
           IF GDG-IND-ECRS IN GDG-FLD NOT = 'S'                         
               MOVE SPACES TO GDG-COD-RERS IN GDG-FLD                   
               MOVE SPACES TO FRM-GLS-RERS IN GDG-FLD                   
               GO TO FIN-VAL-GDG-COD-RERS.                              
                                                                        
      *VAL-TDU Valida Tipo de Usuario                                   
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.                   
           MOVE GDG-COD-RERS IN GDG-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
                                                                        
      *BUS-USR busca usuario en tablas                                  
           IF GDG-COD-RERS IN GDG-FLD > SPACES                          
               MOVE GDG-COD-RERS IN GDG-FLD TO USR-COD-USER IN USR      
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RERS IN GDG-FLD      
           ELSE                                                         
               MOVE SPACES              TO FRM-GLS-RERS IN GDG-FLD.     
      *>>>>                                                             
       FIN-VAL-GDG-COD-RERS.
           EXIT.
       
       VAL-FRM-GLS-RERS SECTION.
       INI-VAL-FRM-GLS-RERS.
       FIN-VAL-FRM-GLS-RERS.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-FEC-FVES SECTION.
       INI-VAL-GDG-FEC-FVES.
           IF GDG-FEC-FVES IN GDG-FLD  NOT > ZEROES
              MOVE ZEROES TO GDG-FEC-FVES IN GDG-FLD.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-FVES IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_FVES AND GEN_BCI                                
           IF GDG-IND-ECRS IN GDG-FLD NOT = 'S'                         
               MOVE ZEROES TO GDG-FEC-FVES IN GDG-FLD                   
               GO TO FIN-VAL-GDG-FEC-FVES.                              
                                                                        
           MOVE FEC-FBLK-N  TO FEC-FBLK.                                
      *MHM-INI 21-OCT-2003                                              
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
      *MHM-FIN 21-OCT-2003                                              
      *>>>>                                                             
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-FVES IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-FVES.
       FIN-VAL-GDG-FEC-FVES.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GDG-IND-ECRT SECTION.
       INI-VAL-GDG-IND-ECRT.
           IF GDG-IND-ECRT IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-IND-ECRT IN GDG-FLD.
      *<<<< GDG_IND_ECRT AND GEN_BCI                                    
           IF SCR-CMND NOT = 'MGA'                                      
               GO TO FIN-VAL-GDG-IND-ECRT.                              
                                                                        
           MOVE 'BGL' TO TAB-COD-SIST.                                  
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.                          
           MOVE GDG-IND-ECRT IN GDG-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           GO TO FIN-VAL-GDG-IND-ECRT.                                  
      *>>>>                                                             
       FIN-VAL-GDG-IND-ECRT.
           EXIT.
       
       VAL-GDG-COD-RERT SECTION.
       INI-VAL-GDG-COD-RERT.
           IF GDG-COD-RERT IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-RERT IN GDG-FLD.
      *<<<< GDG_COD_RERT AND GEN_BCI                                    
           IF SCR-CMND NOT = 'MGA'                                      
               GO TO FIN-VAL-GDG-COD-RERT.                              
                                                                        
           IF GDG-IND-ECRT IN GDG-FLD NOT = 'S'                         
               MOVE SPACES TO GDG-COD-RERT IN GDG-FLD                   
               MOVE SPACES TO FRM-GLS-RERT IN GDG-FLD                   
               GO TO FIN-VAL-GDG-COD-RERT.                              
                                                                        
      *VAL-TDU Valida Tipo de Usuario                                   
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.                   
           MOVE GDG-COD-RERT IN GDG-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
                                                                        
      *BUS-USR busca usuario en tablas                                  
           IF GDG-COD-RERT IN GDG-FLD > SPACES                          
               MOVE GDG-COD-RERT IN GDG-FLD TO USR-COD-USER IN USR      
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RERT IN GDG-FLD      
           ELSE                                                         
               MOVE SPACES              TO FRM-GLS-RERT IN GDG-FLD.     
      *>>>>                                                             
       FIN-VAL-GDG-COD-RERT.
           EXIT.
       
       VAL-FRM-GLS-RERT SECTION.
       INI-VAL-FRM-GLS-RERT.
       FIN-VAL-FRM-GLS-RERT.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-FEC-FVET SECTION.
       INI-VAL-GDG-FEC-FVET.
           IF GDG-FEC-FVET IN GDG-FLD  NOT > ZEROES
              MOVE ZEROES TO GDG-FEC-FVET IN GDG-FLD.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-FVET IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_FVET AND GEN_BCI                                
           IF GDG-IND-ECRT IN GDG-FLD NOT = 'S'                         
               MOVE ZEROES TO GDG-FEC-FVET IN GDG-FLD                   
               GO TO FIN-VAL-GDG-FEC-FVET.                              
                                                                        
           MOVE FEC-FBLK-N  TO FEC-FBLK.                                
      *MHM-INI 21-OCT-2003                                              
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
      *MHM-FIN 21-OCT-2003                                              
      *>>>>                                                             
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-FVET IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-FVET.
       FIN-VAL-GDG-FEC-FVET.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-GDG-NUM-IPRO SECTION.
       INI-VAL-GDG-NUM-IPRO.
      *<<<<
           IF GDG-NUM-IPRO IN GDG-FLD = ZEROES AND                      
             (GDG-IND-CBAN IN GDG-FLD = 'S' OR                          
              GDG-IND-CBAN IN GDG-FLD = 'N')                            
              PERFORM ERR-GLS.                                          
      *>>>>
       FIN-VAL-GDG-NUM-IPRO.
           EXIT.

       VAL-GDG-VRF-IPRO SECTION.
       INI-VAL-GDG-VRF-IPRO.
           IF GDG-VRF-IPRO IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-VRF-IPRO IN GDG-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE GDG-NUM-IPRO IN GDG-FLD TO IDC-NUM-RUTV.
           MOVE GDG-VRF-IPRO IN GDG-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< GDG_VRF_IPRO                                                
      *EVA-AFRI/ABR2007                                                 
      *     IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES                     
      *         MOVE FRM-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC     
      *         MOVE FRM-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC     
      *         MOVE FRM-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC     
      *         MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                        
      *         MOVE FIO-GET-KEY TO FIO-CMND                            
      *         PERFORM SGC-FIO-DBC                                     
      *         IF NOT FIO-STAT-OKS                                     
      *             MOVE 'TAB'        TO MSG-COD-SIST                   
      *             MOVE 'CLI    NEX' TO MSG-COD-MENS                   
      *             PERFORM GET-MSG                                     
      *             MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD        
      *             MOVE MSG-GLS-DESC TO FRM-MENS                       
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR                       
      *         ELSE                                                    
      *             MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI        
      *             MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI        
      *             MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                
      *             PERFORM CPT-BLKS                                    
      *             MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.           
                                                                        
                                                                        
           IF GDG-NUM-IPRO IN GDG-FLD > ZEROES AND                      
              GDG-IND-CBAN IN GDG-FLD = 'S'                             
               MOVE GDG-NUM-IPRO IN GDG-FLD TO DBC-NUM-ICLI IN DBC      
               MOVE SPACES                  TO DBC-IND-ICLI IN DBC      
               MOVE SPACES                  TO DBC-GLS-ICLI IN DBC      
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DBC                                      
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'TAB'        TO MSG-COD-SIST                    
                   MOVE 'CLI    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE SPACES       TO GDG-GLS-NOMP IN GDG-FLD         
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-VAL-GDG-VRF-IPRO                           
               ELSE                                                     
                   MOVE DBC-CAI-ICLI IN DBC TO GDG-CAI-ICLI IN GDG      
                   MOVE DBC-IIC-ICLI IN DBC TO GDG-IIC-ICLI IN GDG      
                   MOVE DBC-CAI-ICLI IN DBC TO CNE-GDG-CAI-ICLI         
                   MOVE DBC-IIC-ICLI IN DBC TO CNE-GDG-IIC-ICLI         
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN TO GDG-GLS-NOMP IN GDG-FLD             
           ELSE                                                         
               IF GDG-NUM-IPRO IN GDG-FLD > ZEROES AND                  
                  GDG-IND-CBAN IN GDG-FLD = 'N'                         
                  PERFORM CLI-NEX.                                      
      *>>>>                                                             
       FIN-VAL-GDG-VRF-IPRO.
           EXIT.
       VAL-GDG-IND-IPRO SECTION.
       INI-VAL-GDG-IND-IPRO.
           IF GDG-IND-IPRO IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-IND-IPRO IN GDG-FLD.
      *VAL-IDC Valida identificador
           MOVE GDG-IND-IPRO IN GDG-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO GDG-IND-IPRO IN GDG-FLD.
       FIN-VAL-GDG-IND-IPRO.
           EXIT.

       VAL-GDG-GLS-IPRO SECTION.
       INI-VAL-GDG-GLS-IPRO.
           IF GDG-GLS-IPRO IN GDG-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO GDG-GLS-IPRO IN GDG-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE GDG-GLS-IPRO IN GDG-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO GDG-GLS-IPRO IN GDG-FLD.
       FIN-VAL-GDG-GLS-IPRO.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-COD-DEUD SECTION.
       INI-VAL-FRM-COD-DEUD.
           IF FRM-COD-DEUD IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD.
       FIN-VAL-FRM-COD-DEUD.
           EXIT.
       
       VAL-FRM-GLS-DEUD SECTION.
       INI-VAL-FRM-GLS-DEUD.
       FIN-VAL-FRM-GLS-DEUD.
           EXIT.
       
       VAL-GDG-GLS-NOMP SECTION.
       INI-VAL-GDG-GLS-NOMP.
           IF GDG-GLS-NOMP IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-GLS-NOMP IN GDG-FLD.
      *<<<<
           IF GDG-IND-CBAN IN GDG-FLD = 'N' AND                         
              GDG-NUM-IPRO IN GDG-FLD > SPACES AND                      
              GDG-GLS-NOMP IN GDG-FLD = SPACES                          
              PERFORM ERR-GLS.                                          
                                                                        
      *EVA-AFRI/ABR2007                                                 
      *<<<< FRM_GLS_NOMC Nombre prorietario                             
      *MHM-INI 29-OCT-2003                                              
      *INI-AFRI/MAY-2005                                                
      *    IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND                
      *     IF (CMA-CIC-UING IN CMA-VARI = 'MIGRACION' OR               
      *        GDG-CAI-GTIA IN GDG-FLD = '0800') AND                    
      *FIN-AFRI/MAY-2005                                                
      *        FRM-GLS-NOMC IN GDG-FLD NOT > SPACES                     
      *         GO TO FIN-VAL-FRM-GLS-NOMC.                             
      *MHM-FIN 29-OCT-2003                                              
      *RRM-INI 3-JUL-2002 Campo no obligatorio para CIM, si es ING.     
      *     IF SCR-OFRM-SRV AND                                         
      *        SCR-CMND = 'ING' AND                                     
      *        FRM-GLS-NOMC IN GDG-FLD NOT > SPACES                     
      *         GO TO FIN-VAL-FRM-GLS-NOMC.                             
      *RRM-FIN 3-JUL-2002                                               
                                                                        
      *<<<<                                                             
      *     IF FRM-NUM-ICLI IN GDG-FLD = ZEROES AND                     
      *>>>>                                                             
      *        GDG-IND-CBAN IN GDG-FLD = 'N'  AND                       
      *        FRM-GLS-NOMC IN GDG-FLD NOT > SPACES                     
      *            MOVE 'TAB'        TO MSG-COD-SIST                    
      *            MOVE 'CLI-NOM-NEX' TO MSG-COD-MENS                   
      *            PERFORM GET-MSG                                      
      *            MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD         
      *            MOVE MSG-GLS-DESC TO FRM-MENS                        
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR                        
      *            GO TO FIN-VAL-FRM-GLS-NOMC.                          
                                                                        
      *      MOVE FRM-GLS-NOMC IN GDG-FLD TO CNE-GDG-GLS-NOMP.          
      *FIN-AFRI/ABR2007                                                 
                                                                        
      *>>>>
       FIN-VAL-GDG-GLS-NOMP.
           EXIT.
       
       VAL-GDG-COD-GACS SECTION.
       INI-VAL-GDG-COD-GACS.
           IF GDG-COD-GACS IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-GACS IN GDG-FLD.
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'GCS ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-GACS IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-GDG-COD-GACS.
           EXIT.
       
       VAL-CON-FLD-GDG SECTION.
       INI-VAL-CON-FLD-GDG.
       FIN-VAL-CON-FLD-GDG.
           EXIT.
       
       VAL-CON-GDG SECTION.
       INI-VAL-CON-GDG.
       FIN-VAL-CON-GDG.
           EXIT.
       
       VAL-NUM-KEY-GDG SECTION.
       INI-VAL-NUM-KEY-GDG.
           PERFORM VAL-NUM-IKY-GDG.
           PERFORM VAL-NUM-MKY-GDG.
           PERFORM VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-KEY-GDG.
           EXIT.
       
       VAL-NUM-IKY-GDG SECTION.
       INI-VAL-NUM-IKY-GDG.
       VAL-NUM-GDG-IIC-GTIA.
           MOVE GDG-IIC-GTIA-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDG-IIC-GTIA IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDG-IIC-GTIA-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-IKY-GDG.
       FIN-VAL-NUM-IKY-GDG.
           EXIT.
       
       VAL-NUM-MKY-GDG SECTION.
       INI-VAL-NUM-MKY-GDG.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-MKY-GDG.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-MKY-GDG.
           EXIT.
       
       VAL-NUM-AKY-GDG SECTION.
       INI-VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-AKY-GDG.
           EXIT.
       
       VAL-NUM-FLD-GDG SECTION.
       INI-VAL-NUM-FLD-GDG.
       VAL-NUM-FRM-IIC-IOPD.
           MOVE FRM-IIC-IOPD-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-IIC-IOPD IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-GDG-COD-TSCN.
           MOVE GDG-COD-TSCN-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDG-COD-TSCN IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDG-COD-TSCN-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-GDG-NUM-IPRO.
           MOVE GDG-NUM-IPRO-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDG-NUM-IPRO IN GDG-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDG-NUM-IPRO-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-FLD-GDG.
           EXIT.
       
       EDT-KEY-GDG SECTION.
       INI-EDT-KEY-GDG.
           PERFORM EDT-IKY-GDG.
           PERFORM EDT-MKY-GDG.
           PERFORM EDT-AKY-GDG.
       FIN-EDT-KEY-GDG.
           EXIT.
       
       EDT-IKY-GDG SECTION.
       INI-EDT-IKY-GDG.
           IF GDG-IIC-GTIA-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDG-IIC-GTIA-LEN IN GDG-FLD
                GO TO FIN-EDT-IKY-GDG.
           MOVE GDG-IIC-GTIA IN GDG-FLD TO GDG-IIC-GTIA-EDT IN GDG-EDT.
           MOVE GDG-IIC-GTIA-EDT IN GDG-EDT TO 
                GDG-IIC-GTIA-ALF IN GDG-FLD.
       FIN-EDT-IKY-GDG.
           EXIT.
       
       EDT-MKY-GDG SECTION.
       INI-EDT-MKY-GDG.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-MKY-GDG.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO
                DBC-NUM-ICLI-EDT IN GDG-EDT.
           MOVE DBC-NUM-ICLI-EDT IN GDG-EDT TO
                DBC-NUM-ICLI-ALF IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-MKY-GDG.
           EXIT.
       
       EDT-AKY-GDG SECTION.
       INI-EDT-AKY-GDG.
       FIN-EDT-AKY-GDG.
           EXIT.
       
       EDT-FLD-GDG SECTION.
       INI-EDT-FLD-GDG.
           IF FRM-IIC-IOPD-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO FRM-IIC-IOPD-EDT IN GDG-EDT.
           MOVE FRM-IIC-IOPD-EDT IN GDG-EDT TO 
                FRM-IIC-IOPD-ALF IN GDG-FLD.
           IF GDG-COD-TSCN-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDG-COD-TSCN-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-COD-TSCN IN GDG-FLD TO GDG-COD-TSCN-EDT IN GDG-EDT.
           MOVE GDG-COD-TSCN-EDT IN GDG-EDT TO 
                GDG-COD-TSCN-ALF IN GDG-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF GDG-NUM-IPRO-LEN IN GDG-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDG-NUM-IPRO-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-NUM-IPRO IN GDG-FLD TO
                GDG-NUM-IPRO-EDT IN GDG-EDT.
           MOVE GDG-NUM-IPRO-EDT IN GDG-EDT TO
                GDG-NUM-IPRO-ALF IN GDG-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-FLD-GDG.
           EXIT.
      *<<<< EOF
      *<<<< GEN_BCI
       BUS-RCC SECTION.
       INI-BUS-RCC.
      * Muestra Primer Cliente del OPD de DAP mediante RCC
           MOVE FRM-CAI-IOPD IN GDG-FLD TO RCC-CAI-IOPD IN RCC.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (
                  FIO-STAT-OKS AND
                  FRM-CAI-IOPD IN GDG-FLD = RCC-CAI-IOPD IN RCC AND
                  FRM-IIC-IOPD IN GDG-FLD = RCC-IIC-IOPD IN RCC
                  )
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'RCC    NEX'   TO MSG-COD-MENS
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-RCC.
       FIN-BUS-RCC.
           EXIT.
      *EVA-AFRI/ABR2007                                                 
       CLI-NEX SECTION.                                                 
       INI-CLI-NEX.                                                     
           MOVE IDC-ZERO-S TO IDC-ZERO.                                 
           MOVE GDG-NUM-IPRO IN GDG-FLD TO IDC-NUM-RUTV.                
           MOVE GDG-VRF-IPRO IN GDG-FLD TO IDC-VRF-RUTV.                
           PERFORM VAL-RUT.                                             
           MOVE GDG-NUM-IPRO IN GDG-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE GDG-IND-IPRO IN GDG-FLD TO DBC-IND-ICLI IN DBC.         
           MOVE GDG-GLS-IPRO IN GDG-FLD TO DBC-GLS-ICLI IN DBC.         
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.                            
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF FIO-STAT-OKS                                              
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'CLI    EXI' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE SPACES       TO GDG-GLS-NOMP IN GDG-FLD              
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
              MOVE SPACES TO GDG-CAI-ICLI IN GDG                        
              MOVE ZEROES TO GDG-IIC-ICLI IN GDG                        
              PERFORM VAL-RUT.                                          
       FIN-CLI-NEX.                                                     
           EXIT.                                                        
      *FIN-AFRI/ABR2007                                                 
      *>>>>                                                             
      * EVA-INI  07/08                                                  
       VAL-VSN SECTION.                                                 
       INI-VAL-VSN.                                                     
                                                                        
           MOVE 'S' TO WSS-IND-TVSN IN WSS-VARI.                        
                                                                        
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'VSN'               TO TAB-COD-TTAB IN TAB.             
           MOVE '01'                TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
              MOVE 'N' TO WSS-IND-TVSN IN WSS-VARI.                     
                                                                        
       FIN-VAL-VSN.                                                     
           EXIT.                                                        
                                                                        
       VAL-CEN SECTION.                                                 
       INI-VAL-CEN.                                                     
                                                                        
           MOVE 'S' TO WSS-IND-OCEN IN WSS-VARI.                        
                                                                        
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'CEN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE USR-COD-OFUS IN USR TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                  TAB-IND-VIGE IN TAB = 'S')                            
              MOVE 'N' TO WSS-IND-OCEN IN WSS-VARI.                     
                                                                        
       FIN-VAL-CEN.                                                     
           EXIT.                                                        
                                                                        
       VAL-EJC SECTION.                                                 
       INI-VAL-EJC.                                                     
                                                                        
           MOVE 'S' TO WSS-IND-EJEC IN WSS-VARI.                        
                                                                        
           MOVE 'EJC '                  TO USR-COD-TTAB IN USR.         
           MOVE GDG-CIC-EJOR IN GDG-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'N' TO WSS-IND-EJEC IN WSS-VARI.                     
                                                                        
           MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN GDG-FLD.         
                                                                        
       FIN-VAL-EJC.                                                     
           EXIT.                                                        
                                                                        
      * EVA-FIN  07/08                                                  
      *>>>>
