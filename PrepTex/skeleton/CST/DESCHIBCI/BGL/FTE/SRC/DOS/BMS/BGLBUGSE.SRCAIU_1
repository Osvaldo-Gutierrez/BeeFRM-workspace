      *
      * BGLBUGSE
      * Version 3.0.1 Nov-2005
      * 18-Jan-19 04:17 PM
      *
       SET-TAG-BGLBUGSE SECTION.
       INI-SET-TAG-BGLBUGSE.
           MOVE
           '<IDNMOD NOM=$BGLBUGSE$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$18-Jan-19 04:17 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGSE.
           EXIT.
           
       RET-ALL-GSE SECTION.
       INI-RET-ALL-GSE.
           PERFORM KEY-ALL-GSE.
           PERFORM RET-GSE-GSE.
           PERFORM RET-GDG-GSE.
           PERFORM RET-TAG-GSE.
       FIN-RET-ALL-GSE.
           EXIT.
       
       RET-GSE-GSE SECTION.
       INI-RET-GSE-GSE.
           MOVE GSE-IND-SEG IN GSE-FLD TO GSE-IND-SEG IN GSE.
           MOVE GSE-IND-GENE IN GSE-FLD TO GSE-IND-GENE IN GSE.
           MOVE GSE-COD-RTSE IN GSE-FLD TO GSE-COD-RTSE IN GSE.
           MOVE GSE-COD-PLZA IN GSE-FLD TO GSE-COD-PLZA IN GSE.
           MOVE GSE-NUM-PROP IN GSE-FLD TO GSE-NUM-PROP IN GSE.
           MOVE GSE-COD-ICCS IN GSE-FLD TO GSE-COD-ICCS IN GSE.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GSE-NUM-DVSG IN GSE-FLD TO GSE-NUM-DVSG IN GSE.
           MOVE GSE-NUM-MVSG IN GSE-FLD TO GSE-NUM-MVSG IN GSE.
           MOVE GSE-NUM-SVSG IN GSE-FLD TO GSE-NUM-SVSG IN GSE.
           MOVE GSE-NUM-AVSG IN GSE-FLD TO GSE-NUM-AVSG IN GSE.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GSE-COD-CORS IN GSE-FLD TO GSE-COD-CORS IN GSE.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GSE-NUM-DVTS IN GSE-FLD TO GSE-NUM-DVTS IN GSE.
           MOVE GSE-NUM-MVTS IN GSE-FLD TO GSE-NUM-MVTS IN GSE.
           MOVE GSE-NUM-SVTS IN GSE-FLD TO GSE-NUM-SVTS IN GSE.
           MOVE GSE-NUM-AVTS IN GSE-FLD TO GSE-NUM-AVTS IN GSE.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GSE-COD-VCMS IN GSE-FLD TO GSE-COD-VCMS IN GSE.
           MOVE GSE-NUM-DEDU IN GSE-FLD TO GSE-NUM-DEDU IN GSE.
           MOVE GSE-SGV-SEGU IN GSE-FLD TO GSE-SGV-SEGU IN GSE.
           MOVE GSE-VAL-MPRI IN GSE-FLD TO GSE-VAL-MPRI IN GSE.
           MOVE GSE-COD-ESTA IN GSE-FLD TO GSE-COD-ESTA IN GSE.
           MOVE GSE-IND-ENDS IN GSE-FLD TO GSE-IND-ENDS IN GSE.
           MOVE GSE-COD-COB1 IN GSE-FLD TO GSE-COD-COB1 IN GSE.
           MOVE GSE-IND-PCUO IN GSE-FLD TO GSE-IND-PCUO IN GSE.
           MOVE GSE-COD-COB2 IN GSE-FLD TO GSE-COD-COB2 IN GSE.
           MOVE GSE-NUM-CUOT IN GSE-FLD TO GSE-NUM-CUOT IN GSE.
           MOVE GSE-COD-COB3 IN GSE-FLD TO GSE-COD-COB3 IN GSE.
           MOVE GSE-COD-COB4 IN GSE-FLD TO GSE-COD-COB4 IN GSE.
           MOVE GSE-IND-SEGU IN GSE-FLD TO GSE-IND-SEGU IN GSE.
           MOVE GSE-COD-COB5 IN GSE-FLD TO GSE-COD-COB5 IN GSE.
           MOVE GSE-GLS-IMPR IN GSE-FLD TO GSE-GLS-IMPR IN GSE.
       FIN-RET-GSE-GSE.
           EXIT.
       
       RET-GDG-GSE SECTION.
       INI-RET-GDG-GSE.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GSE-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GSE-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
      * OFI-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-OFIC IN GSE-FLD TO GDG-COD-OFIC IN GDG.
      * OFI-FIN --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-VCAM IN GSE-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-GLS-DGTA IN GSE-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-GLS-DGT1 IN GSE-FLD TO GDG-GLS-DGT1 IN GDG.
           MOVE GDG-IND-INOB IN GSE-FLD TO GDG-IND-INOB IN GDG.
       FIN-RET-GDG-GSE.
           EXIT.
       
       RET-TAG-GSE SECTION.
       INI-RET-TAG-GSE.
           MOVE TAG-COD-TPOL IN GSE-FLD TO TAG-COD-TPOL IN TAG.
       FIN-RET-TAG-GSE.
           EXIT.
       
       KEY-ALL-GSE SECTION.
       INI-KEY-ALL-GSE.
           PERFORM KEY-GSE-GSE.
           PERFORM KEY-GDG-GSE.
           PERFORM KEY-TAG-GSE.
       FIN-KEY-ALL-GSE.
           EXIT.
       
       KEY-GSE-GSE SECTION.
       INI-KEY-GSE-GSE.
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GSE-CAI-GTIA IN GSE.
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GSE-IIC-GTIA IN GSE.
           MOVE GSE-NUM-IGSE IN GSE-FLD TO GSE-NUM-IGSE IN GSE.
       FIN-KEY-GSE-GSE.
           EXIT.
       
       KEY-GDG-GSE SECTION.
       INI-KEY-GDG-GSE.
       FIN-KEY-GDG-GSE.
           EXIT.
       
       KEY-TAG-GSE SECTION.
       INI-KEY-TAG-GSE.
       FIN-KEY-TAG-GSE.
           EXIT.
       
       SCR-CLRA-GSE SECTION.
       INI-SCR-CLRA-GSE.
           PERFORM CLR-KEY-GSE.
           PERFORM CLR-FLD-GSE.
       FIN-SCR-CLRA-GSE.
           EXIT.
       
       CLR-KEY-GSE SECTION.
       INI-CLR-KEY-GSE.
           MOVE SPACES TO GSE-CAI-GTIA IN GSE-FLD.
           MOVE ZEROES TO GSE-IIC-GTIA IN GSE-FLD.
           MOVE ZEROES TO GSE-NUM-IGSE IN GSE-FLD.
       FIN-CLR-KEY-GSE.
           EXIT.
       
       CLR-FLD-GSE SECTION.
       INI-CLR-FLD-GSE.
           MOVE SPACES TO FRM-GLS-TREA IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-RTSE IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-TPOL IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-ICCS IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-VCMS IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-ESTA IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB1 IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB2 IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB3 IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB4 IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB5 IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-ESTD IN GSE-FLD.
           PERFORM CLR-GSE-GSE.
           PERFORM CLR-GDG-GSE.
           PERFORM CLR-TAG-GSE.
       FIN-CLR-FLD-GSE.
           EXIT.
       
       CLR-GSE-GSE SECTION.
       INI-CLR-GSE-GSE.
           MOVE SPACES TO GSE-IND-SEG IN GSE-FLD.
           MOVE SPACES TO GSE-IND-GENE IN GSE-FLD.
           MOVE SPACES TO GSE-COD-RTSE IN GSE-FLD.
           MOVE SPACES TO GSE-COD-PLZA IN GSE-FLD.
           MOVE ZEROES TO GSE-NUM-PROP IN GSE-FLD.
           MOVE SPACES TO GSE-COD-ICCS IN GSE-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GSE-FEC-FVSG IN GSE-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GSE-COD-CORS IN GSE-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GSE-FEC-FVTS IN GSE-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GSE-COD-VCMS IN GSE-FLD.
           MOVE ZEROES TO GSE-NUM-DEDU IN GSE-FLD.
           MOVE ZEROES TO GSE-SGV-SEGU IN GSE-FLD.
           MOVE ZEROES TO GSE-VAL-MPRI IN GSE-FLD.
           MOVE SPACES TO GSE-COD-ESTA IN GSE-FLD.
           MOVE SPACES TO GSE-IND-ENDS IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB1 IN GSE-FLD.
           MOVE SPACES TO GSE-IND-PCUO IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB2 IN GSE-FLD.
           MOVE ZEROES TO GSE-NUM-CUOT IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB3 IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB4 IN GSE-FLD.
           MOVE SPACES TO GSE-IND-SEGU IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB5 IN GSE-FLD.
           MOVE SPACES TO GSE-GLS-IMPR IN GSE-FLD.
       FIN-CLR-GSE-GSE.
           EXIT.
       
       CLR-GDG-GSE SECTION.
       INI-CLR-GDG-GSE.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GSE-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GSE-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GSE-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GSE-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GSE-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GSE-FLD.
           MOVE SPACES TO GDG-IND-INOB IN GSE-FLD.
       FIN-CLR-GDG-GSE.
           EXIT.
       
       CLR-TAG-GSE SECTION.
       INI-CLR-TAG-GSE.
           MOVE SPACES TO TAG-COD-TPOL IN GSE-FLD.
       FIN-CLR-TAG-GSE.
           EXIT.
       
       FST-KEY-GSE SECTION.
       INI-FST-KEY-GSE.
           MOVE -1 TO GSE-CAI-GTIA-LEN IN GSE-FLD.
       FIN-FST-KEY-GSE.
           EXIT.
       
       FST-FLD-GSE SECTION.
       INI-FST-FLD-GSE.
           MOVE -1 TO GSE-IND-SEG-LEN IN GSE-FLD.
       FIN-FST-FLD-GSE.
           EXIT.
       
       PRO-KEY-GSE SECTION.
       INI-PRO-KEY-GSE.
           PERFORM PRO-MKY-GSE.
       FIN-PRO-KEY-GSE.
           EXIT.
       
       PRO-MKY-GSE SECTION.
       INI-PRO-MKY-GSE.
       FIN-PRO-MKY-GSE.
           EXIT.
       
       PRO-FLD-GSE SECTION.
       INI-PRO-FLD-GSE.
           PERFORM PRO-GSE-GSE.
           PERFORM PRO-GDG-GSE.
           PERFORM PRO-TAG-GSE.
       FIN-PRO-FLD-GSE.
           EXIT.
       
       PRO-GSE-GSE SECTION.
       INI-PRO-GSE-GSE.
           MOVE FRM-CPIM-AEY TO GSE-IND-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-IND-GENE-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-RTSE-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-PLZA-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-NUM-PROP-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-ICCS-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-FEC-FVSG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-CORS-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-FEC-FVTS-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-VCMS-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-NUM-DEDU-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-SGV-SEGU-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-VAL-MPRI-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-COB1-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-IND-PCUO-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-COB2-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-NUM-CUOT-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-COB3-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-COB4-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-IND-SEGU-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-COB5-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-GLS-IMPR-ATR IN GSE-FLD.
       FIN-PRO-GSE-GSE.
           EXIT.
       
       PRO-GDG-GSE SECTION.
       INI-PRO-GDG-GSE.
           MOVE FRM-CPIM-AEY TO GDG-IND-INOB-ATR IN GSE-FLD.
       FIN-PRO-GDG-GSE.
           EXIT.
       
       PRO-TAG-GSE SECTION.
       INI-PRO-TAG-GSE.
       FIN-PRO-TAG-GSE.
           EXIT.
       
       UNP-KEY-GSE SECTION.
       INI-UNP-KEY-GSE.
           PERFORM UNP-IKY-GSE.
           PERFORM UNP-AKY-GSE.
           PERFORM UNP-MKY-GSE.
       FIN-UNP-KEY-GSE.
           EXIT.
       
       UNP-IKY-GSE SECTION.
       INI-UNP-IKY-GSE.
           MOVE FRM-CPIM-UBY TO GSE-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GSE-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GSE-NUM-IGSE-ATR.
      *<<<< FIN_UNP_IKY_GSE 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GSE-NUM-IGSE-ATR IN GSE-FLD
               MOVE FRM-CPIM-AEY TO GSE-NUM-IGSE-STP.
      *RRM-FIN 16-APR-2002
      *>>>>
       FIN-UNP-IKY-GSE.
           EXIT.
       
       UNP-MKY-GSE SECTION.
       INI-UNP-MKY-GSE.
       FIN-UNP-MKY-GSE.
           EXIT.
       
       UNP-AKY-GSE SECTION.
       INI-UNP-AKY-GSE.
       FIN-UNP-AKY-GSE.
           EXIT.
       
       UNP-FLD-GSE SECTION.
       INI-UNP-FLD-GSE.
           PERFORM UNP-GSE-GSE.
           PERFORM UNP-GDG-GSE.
           PERFORM UNP-TAG-GSE.
       FIN-UNP-FLD-GSE.
           EXIT.
       
       UNP-GSE-GSE SECTION.
       INI-UNP-GSE-GSE.
           MOVE FRM-CPIM-UBY TO GSE-IND-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-IND-GENE-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-RTSE-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-PLZA-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-NUM-PROP-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-ICCS-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-FEC-FVSG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-CORS-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-FEC-FVTS-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-VCMS-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-NUM-DEDU-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-SGV-SEGU-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-VAL-MPRI-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB1-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-IND-PCUO-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB2-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-NUM-CUOT-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB3-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB4-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-IND-SEGU-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB5-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-GLS-IMPR-ATR IN GSE-FLD.
       FIN-UNP-GSE-GSE.
           EXIT.
       
       UNP-GDG-GSE SECTION.
       INI-UNP-GDG-GSE.
           MOVE FRM-CPIM-UBY TO GDG-IND-INOB-ATR IN GSE-FLD.
       FIN-UNP-GDG-GSE.
           EXIT.
       
       UNP-TAG-GSE SECTION.
       INI-UNP-TAG-GSE.
       FIN-UNP-TAG-GSE.
           EXIT.
       
       VAL-MKY-GSE SECTION.
       INI-VAL-MKY-GSE.
       FIN-VAL-MKY-GSE.
           EXIT.
       
       VAL-FLD-GSE SECTION.
       INI-VAL-FLD-GSE.
      *<<<< INI_VAL_FLD_GSE
      *AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
            IF SCR-CMND = WSE-GLS-CMOD
                MOVE GSE-CAI-GTIA IN GSE-FLD TO GDG-CAI-GTIA IN GDG
                MOVE GSE-IIC-GTIA IN GSE-FLD TO GDG-IIC-GTIA IN GDG
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM BGL-FIO-GDG
                IF FIO-STAT-OKS AND
                   GDG-IND-EST1 IN GDG > WSE-GLS-NU09 AND
                   GDG-IND-EST1 IN GDG < WSE-GLS-NU20
                    PERFORM VAL-GSE-FEC-FVTS
                     IF FRM-SUAR = FRM-SUAR-MAL OR
                        FRM-SUAR = FRM-SUAR-CLR
                         MOVE FRM-IND-ERRO TO
                              GSE-FEC-FVTS-LEN IN GSE-FLD
                         GO TO FIN-VAL-FLD-GSE
                     ELSE
                         GO TO FIN-VAL-FLD-GSE.
      *AFRI-FIN /062016  VALIDACION MONTO SEGURO / CMN-MOD
      *>>>>
           PERFORM VAL-FRM-GLS-TREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TREA-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
      * IDG-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-TIP-CGTA-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-STP-CGTA-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
      * IDG-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
      * OFI-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-COD-OFIC-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
      * OFI-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-IND-SEG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-IND-SEG-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-IND-GENE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-IND-GENE-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-COD-RTSE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-RTSE-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-RTSE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RTSE-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-TAG-COD-TPOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TAG-COD-TPOL-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-TPOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TPOL-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-COD-PLZA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-PLZA-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-NUM-PROP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-NUM-PROP-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-COD-ICCS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-ICCS-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-ICCS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ICCS-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GSE-FEC-FVSG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GSE-FEC-FVSG-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GSE-COD-CORS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-CORS-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-CORS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CORS-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GSE-FEC-FVTS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GSE-FEC-FVTS-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GSE-COD-VCMS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-VCMS-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-VCMS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCMS-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-NUM-DEDU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-NUM-DEDU-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-SGV-SEGU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-SGV-SEGU-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-VAL-MPRI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-VAL-MPRI-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-COD-ESTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-ESTA-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-ESTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ESTA-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-IND-ENDS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-IND-ENDS-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-COD-COB1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-COB1-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-COB1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-COB1-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-IND-PCUO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-IND-PCUO-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-COD-COB2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-COB2-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-COB2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-COB2-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-NUM-CUOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-NUM-CUOT-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-COD-COB3.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-COB3-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-COB3.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-COB3-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GDG-IND-INOB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IND-INOB-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-COD-COB4.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-COB4-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-COB4.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-COB4-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-IND-SEGU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-IND-SEGU-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-COD-COB5.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-COD-COB5-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-COB5.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-COB5-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-GSE-GLS-IMPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSE-GLS-IMPR-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
           PERFORM VAL-FRM-GLS-ESTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ESTD-LEN IN GSE-FLD
                GO TO FIN-VAL-FLD-GSE.
       FIN-VAL-FLD-GSE.
           EXIT.
       
       VAL-FRM-GLS-TREA SECTION.
       INI-VAL-FRM-GLS-TREA.
       FIN-VAL-FRM-GLS-TREA.
           EXIT.
      * IDG-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.
           IF GDG-TIP-CGTA IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-CGTA IN GSE-FLD.
       FIN-VAL-GDG-TIP-CGTA.
           EXIT.

       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.
           IF GDG-STP-CGTA IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-CGTA IN GSE-FLD.
       FIN-VAL-GDG-STP-CGTA.
           EXIT.
      * IDG-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * OFI-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
           IF GDG-COD-OFIC IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GSE-FLD.
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
      * OFI-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GSE-IND-SEG SECTION.
       INI-VAL-GSE-IND-SEG.
           IF GSE-IND-SEG IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-IND-SEG IN GSE-FLD.
      *<<<<
                                                                        
           IF GSE-IND-SEG IN GSE-FLD > SPACES                           
              IF ((GSE-IND-SEG IN GSE-FLD = WSS-T) OR                     
                 (GSE-IND-SEG IN GSE-FLD = WSS-C))                        
                  GO TO CON-VAL-IND-SEG                                 
              ELSE                                                      
                  MOVE 'BGL'        TO MSG-COD-SIST                     
                  MOVE 'IND NO VALI' TO MSG-COD-MENS                    
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-GSE-IND-SEG                             
           ELSE                                                         
                  NEXT SENTENCE.                                        
      *AFRI-INI                                                         
      *    IF SCR-HDR-MRCA NOT = 'BCS'                                  
      *        GO TO CON-VAL-IND-SEG.                                   
      *    MOVE GSE-NUM-IGSE IN GSE-FLD TO GSE-NUM-IGSE IN GSE.         
      *LUP-VAL-IND-SEG.                                                 
      *    COMPUTE GSE-NUM-IGSE IN GSE = GSE-NUM-IGSE IN GSE - 1        
      *    IF GSE-NUM-IGSE IN GSE NOT > ZEROES AND                      
      *       GSE-IND-SEG IN GSE-FLD = 'C'                              
      *           MOVE 'BGL'        TO MSG-COD-SIST                     
      *           MOVE 'GSEINSEGNOT' TO MSG-COD-MENS                    
      *           PERFORM GET-MSG                                       
      *           MOVE MSG-GLS-DESC TO FRM-MENS                         
      *           MOVE FRM-SUAR-MAL TO FRM-SUAR                         
      *           GO TO FIN-VAL-GSE-IND-SEG.                            
      *    MOVE GSE-CAI-GTIA IN GSE-FLD TO GSE-CAI-GTIA IN GSE.         
      *    MOVE GSE-IIC-GTIA IN GSE-FLD TO GSE-IIC-GTIA IN GSE.         
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM BGL-FIO-GSE.                                         
      *    IF NOT FIO-STAT-OKS                                          
      *        MOVE 'BGL'        TO MSG-COD-SIST                        
      *        MOVE 'GSEINSEGNOT' TO MSG-COD-MENS                       
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC TO FRM-MENS                            
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
      *        GO TO FIN-VAL-GSE-IND-SEG.                               
      *    IF GSE-IND-SEG IN GSE-FLD = 'T'                              
      *       IF GSE-FEC-FVSG IN GSE > HOY-FHOY                         
      *           GO TO CON-VAL-IND-SEG.                                
      *    GO TO LUP-VAL-IND-SEG.                                       
                                                                        
       CON-VAL-IND-SEG.                                                 
      *AFRI-INI/DIC2007(MAE)                                            
           IF GSE-IND-SEG IN GSE-FLD = WSS-C AND                          
              SCR-HDR-MRCA  = 'BCS'                                     
                PERFORM  DET-SEG-COMP                                   
                IF GSE-IND-ERRO IN GSE-VARI = WSS-S                       
                    MOVE 'BGL'            TO MSG-COD-SIST               
                    MOVE GSE-COD-MENS IN GSE-VARI TO MSG-COD-MENS       
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC     TO FRM-MENS                   
                    MOVE FRM-SUAR-MAL     TO FRM-SUAR                   
                       GO TO FIN-VAL-GSE-IND-SEG.                       
      *AFRI-FIN/DIC2007(MAE)                                            
                                                                        
           IF SCR-HDR-MRCA = 'BCI' AND                                  
              GSE-IND-SEG IN GSE-FLD NOT > SPACES                       
              GO TO FIN-VAL-GSE-IND-SEG                                 
           ELSE                                                         
           IF GSE-IND-SEG IN GSE-FLD NOT > SPACES                       
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GSE-IND-SEG.                                
      *>>>>
       FIN-VAL-GSE-IND-SEG.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
       
       VAL-GSE-IND-GENE SECTION.
       INI-VAL-GSE-IND-GENE.
           IF GSE-IND-GENE IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-IND-GENE IN GSE-FLD.
      *<<<<
           IF ((GSE-IND-GENE IN GSE-FLD) > SPACES AND                   
                (GSE-IND-GENE IN GSE-FLD = WSS-S OR                       
                 GSE-IND-GENE IN GSE-FLD = WSS-N))                        
                 GO TO FIN-VAL-GSE-IND-GENE                             
           ELSE                                                         
                MOVE SPACES TO GSE-IND-GENE IN GSE-FLD.                 
      *>>>>
       FIN-VAL-GSE-IND-GENE.
           EXIT.
       
       VAL-GSE-COD-RTSE SECTION.
       INI-VAL-GSE-COD-RTSE.
           IF GSE-COD-RTSE IN GSE-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSE-COD-RTSE.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'RPB ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-RTSE IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-RTSE IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-RTSE IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-RTSE IN GSE-FLD.
       FIN-VAL-GSE-COD-RTSE.
           EXIT.
       
       VAL-FRM-GLS-RTSE SECTION.
       INI-VAL-FRM-GLS-RTSE.
       FIN-VAL-FRM-GLS-RTSE.
           EXIT.
       
       VAL-TAG-COD-TPOL SECTION.
       INI-VAL-TAG-COD-TPOL.
       FIN-VAL-TAG-COD-TPOL.
           EXIT.
       
       VAL-FRM-GLS-TPOL SECTION.
       INI-VAL-FRM-GLS-TPOL.
       FIN-VAL-FRM-GLS-TPOL.
           EXIT.
       
       VAL-GSE-COD-PLZA SECTION.
       INI-VAL-GSE-COD-PLZA.
           IF GSE-COD-PLZA IN GSE-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSE-COD-PLZA.
       FIN-VAL-GSE-COD-PLZA.
           EXIT.
       
       VAL-GSE-NUM-PROP SECTION.
       INI-VAL-GSE-NUM-PROP.
       FIN-VAL-GSE-NUM-PROP.
           EXIT.
       
       VAL-GSE-COD-ICCS SECTION.
       INI-VAL-GSE-COD-ICCS.
           IF GSE-COD-ICCS IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-COD-ICCS IN GSE-FLD.
      *<<<< GSE_COD_ICCS
      *<<<< GEN_BCI
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CSE ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-ICCS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-ICCS IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ICCS IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ICCS IN GSE-FLD.
      *>>>>
      *<<<<
       FIN-VAL-GSE-COD-ICCS.
           EXIT.
       
       VAL-FRM-GLS-ICCS SECTION.
       INI-VAL-FRM-GLS-ICCS.
       FIN-VAL-FRM-GLS-ICCS.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GSE-FEC-FVSG SECTION.
       INI-VAL-GSE-FEC-FVSG.
           IF GSE-FEC-FVSG IN GSE-FLD  NOT > ZEROES
              MOVE ZEROES TO GSE-FEC-FVSG IN GSE-FLD.
      *VAL-FEC Validar Fecha
           MOVE GSE-FEC-FVSG IN GSE-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GSE-FEC-FVSG IN GSE-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GSE-FEC-FVSG.
      *<<<< FIN_GSE_FEC_VIG_SEG
            IF GSE-FEC-FVSG IN GSE-FLD  NOT > SPACES
              MOVE ZEROES TO GSE-FEC-FVSG IN GSE-FLD.
      *VAL-FEC Validar Fecha
           MOVE GSE-FEC-FVSG IN GSE-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
              MOVE FEC-CHOY-N TO FEC-CHOY.                              
      *AFRI-FIN/JUL2005
           PERFORM PRO-FEC.
      *AFRI-INI/JUL2005                                                 
           IF SCR-HDR-MRCA = 'BCS'                                      
               IF FEC-STAT-FER                                          
                   MOVE FEC-FORM-FEC TO FEC-FORM                        
                   MOVE FEC-FBLK-N  TO FEC-FBLK
                   MOVE FEC-CHOY-N  TO FEC-CHOY                         
                   MOVE FEC-SIG-HBL TO FEC-CMND
                   PERFORM CAL-FEC                                      
                   MOVE  '00' TO FEC-STAT.                              
      *AFRI-FIN/JUL2005
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GSE-FEC-FVSG IN GSE-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GSE-FEC-FVSG.
      *
      *>>>>
       FIN-VAL-GSE-FEC-FVSG.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GSE-COD-CORS SECTION.
       INI-VAL-GSE-COD-CORS.
           IF GSE-COD-CORS IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-COD-CORS IN GSE-FLD.
      *<<<< GSE_COD_CORS
      *<<<< GEN_BCI
           IF GSE-COD-RTSE IN GSE-FLD NOT = WSS-3
               MOVE SPACES TO GSE-COD-CORS IN GSE-FLD
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD
               GO TO FIN-VAL-GSE-COD-CORS.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'SEG ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-CORS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-CORS IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CORS IN GSE-FLD.
      *>>>>
      *>>>>
       FIN-VAL-GSE-COD-CORS.
           EXIT.
       
       VAL-FRM-GLS-CORS SECTION.
       INI-VAL-FRM-GLS-CORS.
       FIN-VAL-FRM-GLS-CORS.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GSE-FEC-FVTS SECTION.
       INI-VAL-GSE-FEC-FVTS.
           IF GSE-FEC-FVTS IN GSE-FLD  NOT > ZEROES
              MOVE ZEROES TO GSE-FEC-FVTS IN GSE-FLD.
      *VAL-FEC Validar Fecha
           MOVE GSE-FEC-FVTS IN GSE-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GSE_FEC_VTO_SEG
      *PVC-INI 28-FEB-2012
           IF GSE-FEC-FVTS IN GSE-FLD  = WSS-99999999                     
               GO TO FIN-VAL-GSE-FEC-FVTS.                              
      *PVC-FIN 28-FEB-2012
           IF GSE-FEC-FVTS IN GSE-FLD  NOT > ZEROES
              MOVE ZEROES TO GSE-FEC-FVTS IN GSE-FLD.
      *VAL-FEC Validar Fecha
           MOVE GSE-FEC-FVTS IN GSE-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GSE_FEC_VTO_SEG
      
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-FBLK-S TO FEC-FBLK.

           MOVE GSE-NUM-SVTS IN GSE-FLD TO FEC-SEC2.
           MOVE GSE-NUM-AVTS IN GSE-FLD TO FEC-AEC2.
           MOVE GSE-NUM-MVTS IN GSE-FLD TO FEC-MEC2.
           MOVE GSE-NUM-DVTS IN GSE-FLD TO FEC-DEC2.
           GO TO FEC_VIGE.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GSE-FEC-FVTS IN GSE-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GSE-FEC-FVTS.
      *<<<< GSE_FEC_VTO_SEG
      FEC_VIGE.
      *Fecha vigencia
           MOVE GSE-NUM-SVSG IN GSE-FLD TO FEC-SEC1.
           MOVE GSE-NUM-AVSG IN GSE-FLD TO FEC-AEC1.
           MOVE GSE-NUM-MVSG IN GSE-FLD TO FEC-MEC1.
           MOVE GSE-NUM-DVSG IN GSE-FLD TO FEC-DEC1.
      *Fecha vencimiento
           MOVE GSE-NUM-SVTS IN GSE-FLD TO FEC-SEC2.
           MOVE GSE-NUM-AVTS IN GSE-FLD TO FEC-AEC2.
           MOVE GSE-NUM-MVTS IN GSE-FLD TO FEC-MEC2.
           MOVE GSE-NUM-DVTS IN GSE-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'VTO<=VIG' TO MSG-COD-MENS
               GO TO ERR-VAL-FEC-FVTS.

      *<<<<AFRI-INI MAYO-2006                                           
           IF NOT (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')                
               GO TO FIN-VAL-GSE-FEC-FVTS.                              
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'PRD'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'FECVIGVTO'  TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S)          
               MOVE 'BGL'            TO MSG-COD-SIST
               MOVE 'TABPRDVIGVTO'   TO MSG-COD-MENS     
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC     TO FRM-MENS                        
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-GSE-FEC-FVTS.
           MOVE TAB-GLS-DATA IN TAB  TO WSS-PER-PERI IN WSS-VARI.       
           IF WSS-GLS-CANT IS NOT NUMERIC                               
               MOVE 'BGL'            TO MSG-COD-SIST                    
               MOVE 'CANTPRDNONUM'   TO MSG-COD-MENS                    
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC     TO FRM-MENS                        
               MOVE FRM-SUAR-MAL     TO FRM-SUAR
               GO TO FIN-VAL-GSE-FEC-FVTS.                              
           IF WSS-GLS-PERI = WSS-M                                        
               MOVE GSE-NUM-DVSG IN GSE-FLD TO FEC-DEC1                 
               MOVE GSE-NUM-MVSG IN GSE-FLD TO FEC-MEC1                 
               MOVE GSE-NUM-SVSG IN GSE-FLD TO FEC-SEC1                 
               MOVE GSE-NUM-AVSG IN GSE-FLD TO FEC-AEC1                 
               MOVE GSE-NUM-DVTS IN GSE-FLD TO FEC-DEC2
               MOVE GSE-NUM-MVTS IN GSE-FLD TO FEC-MEC2                 
               MOVE GSE-NUM-SVTS IN GSE-FLD TO FEC-SEC2                 
               MOVE GSE-NUM-AVTS IN GSE-FLD TO FEC-AEC2                 
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-DIF-MES             TO FEC-CMND                 
               PERFORM CAL-FEC
               IF (FEC-NDIA > ZEROES )                                  
                   ADD 1 TO FEC-NMES
           END-IF                                                   
               IF FEC-NMES NOT > WSS-GLS-CANT IN WSS-VARI               
                   GO TO FIN-VAL-GSE-FEC-FVTS                           
               ELSE
                   MOVE 'BGL'            TO MSG-COD-SIST                
                   MOVE 'DIFANONOVALI'   TO MSG-COD-MENS                
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC     TO FRM-MENS                    
                   MOVE FRM-SUAR-MAL     TO FRM-SUAR
                   GO TO FIN-VAL-GSE-FEC-FVTS                           
           ELSE                                                         
               MOVE 'BGL'            TO MSG-COD-SIST                    
               MOVE 'TIPOPRDNOVAL'   TO MSG-COD-MENS                    
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC     TO FRM-MENS                        
               MOVE FRM-SUAR-MAL     TO FRM-SUAR                        
               GO TO FIN-VAL-GSE-FEC-FVTS.                              
      *>>>>AFRI-FIN MAYO-2006                                           
                                                                        
           GO TO FIN-VAL-GSE-FEC-FVTS.
       ERR-VAL-FEC-FVTS.
           MOVE 'BGL'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.


      *>>>>
       FIN-VAL-GSE-FEC-FVTS.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GSE-COD-VCMS SECTION.
       INI-VAL-GSE-COD-VCMS.
           IF GSE-COD-VCMS IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-COD-VCMS IN GSE-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-VCMS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-VCMS IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCMS IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCMS IN GSE-FLD.
       FIN-VAL-GSE-COD-VCMS.
           EXIT.
       
       VAL-FRM-GLS-VCMS SECTION.
       INI-VAL-FRM-GLS-VCMS.
       FIN-VAL-FRM-GLS-VCMS.
           EXIT.
       
       VAL-GSE-NUM-DEDU SECTION.
       INI-VAL-GSE-NUM-DEDU.
       FIN-VAL-GSE-NUM-DEDU.
           EXIT.
       
       VAL-GSE-SGV-SEGU SECTION.
       INI-VAL-GSE-SGV-SEGU.
           IF GSE-SGV-SEGU IN GSE-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSE-SGV-SEGU.
      *<<<<AFRI-INI/24-05-2006                                          
           IF NOT (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')                
               GO TO SIG-VAL-GSE-SGV-SEGU.
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-VAL-GSE-SGV-SEGU.                              
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GVT-CAI-GTIA IN GVT.
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GVT-IIC-GTIA IN GVT.         
           MOVE 999                     TO GVT-COD-TASN IN GVT.         
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM BGL-FIO-GVT.                                         
           IF NOT (FIO-STAT-OKS AND
            GSE-CAI-GTIA IN GSE-FLD = GVT-CAI-GTIA IN GVT AND           
            GSE-IIC-GTIA IN GSE-FLD = GVT-IIC-GTIA IN GVT)              
               GO TO FIN-VAL-GSE-SGV-SEGU.                              
           IF GDG-COD-VCAM IN GDG = GSE-COD-VCMS IN GSE-FLD             
              MOVE GVT-SGV-VCTS IN GVT TO WSS-VAR-VCTS IN WSS-VARI
              MOVE GVT-SGV-VSIN IN GVT TO WSS-VAR-VSIN IN WSS-VARI      
              MOVE GSE-SGV-SEGU IN GSE-FLD TO WSS-VAR-SEGU IN WSS-VARI  
              GO TO CON-VAL-GSE-SGV-SEGU.                               
      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE              
      *CONVERSION                                                       
      *     IF NOT GSE-COD-VCMS IN GSE-FLD = '0998  '                   
      *       MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1)   
      *       MOVE GSE-COD-VCMS IN GSE-FLD  TO CAM-COD-VCAM IN CAM(2)   
      *       MOVE GSE-NUM-DVSG IN GSE-FLD  TO CAM-NUM-DCAM IN CAM(1)   
      *       MOVE GSE-NUM-MVSG IN GSE-FLD  TO CAM-NUM-MCAM IN CAM(1)   
      *       MOVE GSE-NUM-SVSG IN GSE-FLD  TO CAM-NUM-SCAM IN CAM(1)   
      *       MOVE GSE-NUM-AVSG IN GSE-FLD  TO CAM-NUM-ACAM IN CAM(1)   
      *       MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)   
      *       MOVE FIO-GET-KEY TO FIO-CMND                              
      *       PERFORM TAB-FIO-CAM                                       
      *       IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')              
      *         MOVE 'BGL'        TO MSG-COD-SIST                       
      *         MOVE 'T/VIGE=N'   TO MSG-COD-MENS                       
      *         PERFORM GET-MSG                                         
      *         MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD            
      *         MOVE MSG-GLS-DESC TO FRM-MENS                           
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR                           
      *         GO TO FIN-VAL-GSE-SGV-SEGU                              
      *       ELSE                                                      
      *         COMPUTE WSS-VAR-SEGU IN WSS-VARI ROUNDED =              
      *         (GSE-SGV-SEGU IN GSE-FLD/CAM-SGV-VCAM IN CAM)           
      *         GO TO IRA-VAL-GSE-SGV-SEGU.                             

      *CONVERSION MULTIMONEDA 1                                         
      *SI MONEDA DE GSE Y GDG ES LA MISMA NO HAY CONVERSION
      *SI MONEDA NO ES IGUAL SE LLEVA DESDE MONEDA GSE A MONEDA DE GDG
      *    Otra Moneda 
           MOVE GSE-NUM-SVSG IN GSE-FLD TO NVC-SCAM.
           MOVE GSE-NUM-AVSG IN GSE-FLD TO NVC-ACAM.
           MOVE GSE-NUM-MVSG IN GSE-FLD TO NVC-MCAM.
           MOVE GSE-NUM-DVSG IN GSE-FLD TO NVC-DCAM.
           MOVE GSE-SGV-SEGU IN GSE-FLD TO NVC-VALO.
           MOVE GSE-COD-VCMS IN GSE-FLD TO NVC-MON1.           
           MOVE GDG-COD-VCAM IN GDG     TO NVC-MON2.
           MOVE WSS-4                   TO NVC-NUM-DECI.
           MOVE WSS-C                   TO NVC-IND-ACCI.

           PERFORM PRO-NVC-NCD.
           IF NVC-CMSG > SPACES
               MOVE 'BGL'        TO MSG-COD-SIST      
               MOVE 'CAM    NEX' TO MSG-COD-MENS   
               PERFORM GET-MSG                        
               MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS          
               MOVE FRM-SUAR-MAL TO FRM-SUAR          
               GO TO FIN-VAL-GSE-SGV-SEGU             
           ELSE                              
               MOVE NVC-RESU TO WSS-VAR-SEGU IN WSS-VARI.   

      *MPB-FIN                 
              
       IRA-VAL-GSE-SGV-SEGU.                                            
           MOVE GVT-SGV-VCTS IN GVT TO WSS-VAR-VCTS IN WSS-VARI.        
           MOVE GVT-SGV-VSIN IN GVT TO WSS-VAR-VSIN IN WSS-VARI.
           
      *FIN CONVERSION                                                   
      
       CON-VAL-GSE-SGV-SEGU.                  
      *AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
      *    IF WSS-VAR-SEGU IN WSS-VARI > WSS-VAR-VSIN IN WSS-VARI
           IF WSS-VAR-SEGU IN WSS-VARI < WSS-VAR-VSIN IN WSS-VARI
      *AFRI-FIN /062016  VALIDACION MONTO SEGURO / CMN-MOD
              MOVE 'BGL'        TO MSG-COD-SIST
      *AFRI-INI /062016  VALIDACION MONTO SEGURO / CMN-MOD
      *       MOVE 'VSEG>VSIN'  TO MSG-COD-MENS
              MOVE 'VSEG<VSIN'  TO MSG-COD-MENS
      *AFRI-FIN /062016  VALIDACION MONTO SEGURO / CMN-MOD
              PERFORM GET-MSG
              MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
             GO TO FIN-VAL-GSE-SGV-SEGU.
       SIG-VAL-GSE-SGV-SEGU.                                            
      *>>>>AFRI-FIN/24-05-2006                                          
      * EVA-AFRI/MAY2006                                                
           IF NOT (SCR-CMND = 'MOD' OR SCR-CMND = 'ING')                
              GO TO BUS-SIG-REG.
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           IF NOT FIO-STAT-OKS
               GO TO FIN-VAL-GSE-SGV-SEGU.                              
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GVT-CAI-GTIA IN GVT.         
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GVT-IIC-GTIA IN GVT.         
           MOVE 999                     TO GVT-COD-TASN IN GVT.         
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM BGL-FIO-GVT.                                         
           IF NOT (FIO-STAT-OKS AND                                     
            GSE-CAI-GTIA IN GSE-FLD = GVT-CAI-GTIA IN GVT AND           
            GSE-IIC-GTIA IN GSE-FLD = GVT-IIC-GTIA IN GVT)              
               GO TO FIN-VAL-GSE-SGV-SEGU.
           IF GDG-COD-VCAM IN GDG = GSE-COD-VCMS IN GSE-FLD             
              MOVE GVT-SGV-VCTS IN GVT TO WSS-NUM-VCTS IN WSS-VARI      
              MOVE GVT-SGV-VSIN IN GVT TO WSS-NUM-VSIN IN WSS-VARI      
              MOVE GSE-SGV-SEGU IN GSE-FLD TO WSS-NUM-SEGU IN WSS-VARI  
              GO TO CNT-VAL-GSE-SGV-SEGU.
      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE                     
      *CONVERSION                                                       
      *     IF NOT GSE-COD-VCMS IN GSE-FLD = '0998  '                   
      *       MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1)   
      *       MOVE GSE-COD-VCMS IN GSE-FLD  TO CAM-COD-VCAM IN CAM(2)   
      *       MOVE GSE-NUM-DVSG IN GSE-FLD  TO CAM-NUM-DCAM IN CAM(1)   
      *       MOVE GSE-NUM-MVSG IN GSE-FLD  TO CAM-NUM-MCAM IN CAM(1)   
      *       MOVE GSE-NUM-SVSG IN GSE-FLD  TO CAM-NUM-SCAM IN CAM(1)   
      *       MOVE GSE-NUM-AVSG IN GSE-FLD  TO CAM-NUM-ACAM IN CAM(1)   
      *       MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)   
      *       MOVE FIO-GET-KEY TO FIO-CMND                              
      *       PERFORM TAB-FIO-CAM                                       
      *       IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')              
      *         MOVE 'BGL'        TO MSG-COD-SIST                       
      *         MOVE 'T/VIGE=N'   TO MSG-COD-MENS                       
      *         PERFORM GET-MSG                                         
      *         MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD            
      *         MOVE MSG-GLS-DESC TO FRM-MENS                           
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR                           
      *         GO TO FIN-VAL-GSE-SGV-SEGU                              
      *       ELSE                                                      
      *         COMPUTE WSS-NUM-SEGU IN WSS-VARI ROUNDED =              
      *         (GSE-SGV-SEGU IN GSE-FLD/CAM-SGV-VCAM IN CAM)           
      *         GO TO CNT-VAL-GSE-SGV-SEGU.                             
      *     MOVE GSE-SGV-SEGU IN GSE-FLD TO WSS-NUM-SEGU IN WSS-VARI.   
           

      *CONVERSION MULTIMONEDA 2                                          
      *SI MONEDA DE GSE Y GDG ES LA MISMA NO HAY CONVERSION
      *SI MONEDA NO ES IGUAL SE LLEVA DESDE MONEDA GSE A MONEDA DE GDG
      *    Otra Moneda 
           MOVE GSE-NUM-SVSG IN GSE-FLD TO NVC-SCAM.
           MOVE GSE-NUM-AVSG IN GSE-FLD TO NVC-ACAM.
           MOVE GSE-NUM-MVSG IN GSE-FLD TO NVC-MCAM.
           MOVE GSE-NUM-DVSG IN GSE-FLD TO NVC-DCAM.
           MOVE GSE-SGV-SEGU IN GSE-FLD TO NVC-VALO.
           MOVE GSE-COD-VCMS IN GSE-FLD TO NVC-MON1.           
           MOVE GDG-COD-VCAM IN GDG     TO NVC-MON2.
           MOVE WSS-4                   TO NVC-NUM-DECI.
           MOVE WSS-C                   TO NVC-IND-ACCI.

           PERFORM PRO-NVC-NCD.

           IF NVC-CMSG > SPACES
               MOVE 'BGL'        TO MSG-COD-SIST    
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG                      
               MOVE ZEROES       TO GSE-SGV-SEGU IN GSE-FLD   
               MOVE MSG-GLS-DESC TO FRM-MENS         
               MOVE FRM-SUAR-MAL TO FRM-SUAR         
               GO TO FIN-VAL-GSE-SGV-SEGU            
           ELSE                                   
               MOVE NVC-RESU TO WSS-NUM-SEGU IN WSS-VARI.             

      *MPB-FIN                 
              
      *COMPARA CON TABLA
       CNT-VAL-GSE-SGV-SEGU.                                            
           MOVE 'BGL' TO TAB-COD-SIST FIO-SIST.                         
           MOVE 'MAQ' TO TAB-COD-TTAB IN TAB.                           
           MOVE GDG-COD-CGTA IN GDG TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS                                              
               GO TO FIN-VAL-GSE-SGV-SEGU                               
           ELSE                                                         
               MOVE 'BGL'     TO TAB-COD-SIST FIO-SIST
               MOVE 'PVT'     TO TAB-COD-TTAB IN TAB                    
               MOVE 'BGLPGSE' TO TAB-COD-CTAB IN TAB                    
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF NOT (FIO-STAT-OKS AND                                 
                  TAB-IND-VIGE IN TAB = 'S')                            
                  GO TO FIN-VAL-GSE-SGV-SEGU                            
               ELSE                                                     
                  MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA              
      *MPB-INI 16-OCT-2018 CORRECCION PANTALLA GSE 
      *SE LE AGREGAN DECIMALES A PCTJ Y NO SE REDONDEA      
      *            COMPUTE WSS-VAL-PCTJ ROUNDED =                        
                  COMPUTE WSS-VAL-PCTJ =                        
      *MPB-FIN            
                     ((WSS-VAR-VCTS IN WSS-VARI * WSS-NUM-PVTA)/100)    
                  IF (WSS-VAR-SEGU IN WSS-VARI > WSS-VAL-PCTJ)          
                     MOVE 'BGL'           TO MSG-COD-SIST               
                     MOVE 'V.TSC>%V.TSA' TO MSG-COD-MENS                
                     PERFORM GET-MSG 
                     MOVE MSG-GLS-DESC TO FRM-MENS                      
                     MOVE FRM-SUAR-MAL TO FRM-SUAR                      
                     GO TO FIN-VAL-GSE-SGV-SEGU.                        
      * FIN-AFRI/MAY2006
      BUS-SIG-REG.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-SGV-SEGU
           ELSE
      *<<<< NOT PGM_ARG
               IF GSE-COD-VCMS IN GSE-FLD = TAB-COD-CTAB IN TAB
      *>>>>
                  MOVE GSE-SGV-SEGU IN GSE-FLD TO
                                       PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                                        GSE-SGV-SEGU IN GSE-FLD.
      *
           IF NOT PGM-STAT-GVT-OKS
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE 'GSEGVTNEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-SGV-SEGU.  
      *
           MOVE  'TAB'                  TO TAB-COD-SIST.                
           MOVE  'NVA'                  TO TAB-COD-TTAB IN TAB.         
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GSE-FLD TO WSS-TIP-CGTA IN WSS-VARI.    
           MOVE GDG-STP-CGTA IN GSE-FLD TO WSS-STP-CGTA IN WSS-VARI.    
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
      *>>>>                                                             
           PERFORM BUS-TAB.                                             
      *MHM-INI 01-DIC-2004                                              
      *    IF MSG-COD-MENS NOT > SPACES                                 
           IF MSG-COD-MENS > SPACES                                     
      *MHM-FIN 01-DIC-2004                                              
               GO TO FIN-VAL-GSE-SGV-SEGU.
      *                                                                 
                                                                        
           IF GSE-COD-VCMS IN GSE-FLD = GDG-COD-VCAM IN GSE-FLD AND     
              GSE-SGV-SEGU IN GSE-FLD < GAR-SGV-VPND IN CMA-VARI        
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'GSESEG<LIQ' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GSE-SGV-SEGU.                              
                                                                        
      *                                                                 
      *>>>>
       FIN-VAL-GSE-SGV-SEGU.
           EXIT.
       
       VAL-GSE-VAL-MPRI SECTION.
       INI-VAL-GSE-VAL-MPRI.
      *<<<< INI_GSE_VAL_MPRI
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = WSS-MIGRACION AND
              GSE-VAL-MPRI IN GSE-FLD NOT > ZEROES
               GO TO FIN-VAL-GSE-VAL-MPRI.
      *MHM-FIN 29-OCT-2003
                                                                        
      *AFRI-INI/SEP2007(MAE)                                            
           IF GSE-IND-SEG IN GSE-FLD = WSS-C AND                          
              SCR-HDR-MRCA  = 'BCS' AND                                 
              GSE-VAL-MPRI IN GSE-FLD = ZEROES                          
                PERFORM  CAL-MPRIMA-COMP                                
                IF GSE-IND-ERRO IN GSE-VARI = 'S'                       
                    MOVE 'BGL'            TO MSG-COD-SIST               
                    MOVE GSE-COD-MENS IN GSE-VARI TO MSG-COD-MENS       
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC     TO FRM-MENS                   
                    MOVE FRM-SUAR-MAL     TO FRM-SUAR                   
                       GO TO FIN-VAL-GSE-VAL-MPRI                       
                    ELSE                                                
                       MOVE GSE-VAL-MPRI IN GSE-VARI TO                 
                            GSE-VAL-MPRI IN GSE-FLD                     
                       GO TO FIN-VAL-GSE-VAL-MPRI.                      
                                                                        
      *AFRI-FIN/SEP2007(MAE)                                            
      *AFRI-INI/ENE2007(MAE)                                            
           IF (( SCR-HDR-MRCA NOT = 'BCS'  OR                           
                 GSE-IND-SEG IN GSE-FLD NOT = WSS-T ) AND                 
                 GSE-VAL-MPRI IN GSE-FLD = ZEROES)                      
                  PERFORM ERR-GLS                                       
                  GO TO FIN-VAL-GSE-VAL-MPRI.                           
                                                                        
      *    VALIDACION TABLA VERSIONES (SEG TOTAL )                      
           IF ( SCR-HDR-MRCA = 'BCS'  AND                               
                GSE-IND-SEG IN GSE-FLD = WSS-T )                          
                 MOVE 'BGL'           TO  TAB-COD-SIST FIO-SIST       
                 MOVE 'BGL'           TO  TAB-COD-SIST FIO-SIST         
                 MOVE 'VSN'           TO  TAB-COD-TTAB IN TAB           
                 MOVE 'TIPSEGTOT'     TO  TAB-COD-CTAB IN TAB           
                 PERFORM GNS-FIO-TAB                                    
                 IF ((NOT FIO-STAT-OKS OR  TAB-IND-VIGE NOT = WSS-S) AND  
                     GSE-VAL-MPRI IN GSE-FLD = ZEROES)                  
                     PERFORM ERR-GLS                              
                      GO TO FIN-VAL-GSE-VAL-MPRI.                       
                                                                        
           IF GSE-IND-SEG IN GSE-FLD = WSS-T AND                          
              FIO-STAT-OKS AND TAB-IND-VIGE = WSS-S  AND                  
              SCR-HDR-MRCA  = 'BCS' AND                                 
                    GSE-VAL-MPRI IN GSE-FLD = ZEROES                          
                    PERFORM  CAL-MPRIMA                                 
                    IF GSE-IND-ERRO IN GSE-VARI = 'S'                   
                       MOVE 'BGL'            TO MSG-COD-SIST            
                       MOVE GSE-COD-MENS IN GSE-VARI TO MSG-COD-MENS    
                       PERFORM GET-MSG                                  
                       MOVE MSG-GLS-DESC     TO FRM-MENS                
                       MOVE FRM-SUAR-MAL     TO FRM-SUAR                
      *                MOVE 777    TO GSE-VAL-MPRI  IN GSE-FLD          
                       GO TO FIN-VAL-GSE-VAL-MPRI                       
                    ELSE                                                
                       MOVE GSE-VAL-MPRI IN GSE-VARI TO                 
                            GSE-VAL-MPRI IN GSE-FLD                     
                       GO TO FIN-VAL-GSE-VAL-MPRI.                      
                                                                        
                                                                        
                                                                        
      *    IF GSE-IND-SEG IN GSE-FLD = 'T' AND                          
      *       SCR-HDR-MRCA  = 'BCS' AND                                 
      *       GSE-VAL-MPRI IN GSE-FLD = ZEROES                          
      *        PERFORM  CAL-MPRIMA                                      
      *        IF GSE-IND-ERRO IN GSE-VARI = 'S'                        
      *            MOVE 'BGL'            TO MSG-COD-SIST                
      *            MOVE GSE-COD-MENS IN GSE-VARI TO MSG-COD-MENS        
      *            PERFORM GET-MSG                                      
      *            MOVE MSG-GLS-DESC     TO FRM-MENS                    
      *            MOVE FRM-SUAR-MAL     TO FRM-SUAR                    
      *            MOVE 777    TO GSE-VAL-MPRI  IN GSE-FLD              
      *            GO TO FIN-VAL-GSE-VAL-MPRI                           
      *        ELSE                                                     
      *            MOVE GSE-VAL-MPRI IN GSE-VARI TO                     
      *                 GSE-VAL-MPRI IN GSE-FLD                         
      *            GO TO FIN-VAL-GSE-VAL-MPRI.                          
                                                                        
      *AFRI-FIN/ENE2007(MAE)                                            
                                                                        
                                                                        
      *>>>>
           IF GSE-VAL-MPRI IN GSE-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSE-VAL-MPRI.
       FIN-VAL-GSE-VAL-MPRI.
           EXIT.
       
       VAL-GSE-COD-ESTA SECTION.
       INI-VAL-GSE-COD-ESTA.
      *<<<< INI_GSE_COD_ESTA
           IF SCR-CMND = 'ING'
               MOVE '01' TO GSE-COD-ESTA IN GSE-FLD.
      *PVG INI 14-OCT-2003
      *    IF GSE-COD-ESTA IN GSE-FLD > SPACES
      *        MOVE 'BGL'                   TO TAB-COD-SIST
      *        MOVE 'ESS '                  TO TAB-COD-TTAB IN TAB
      *        MOVE GSE-COD-ESTA IN GSE-FLD TO TAB-COD-CTAB IN TAB
      *        PERFORM VAL-COD
      *        IF MSG-COD-MENS NOT > SPACES
      *           MOVE TAB-GLS-DESC IN TAB  TO FRM-GLS-ESTA IN GSE-FLD
      *        ELSE
      *           MOVE SPACES               TO FRM-GLS-ESTA IN GSE-FLD.
      *PVG FIN 14-OCT-2003
      *>>>>
       FIN-VAL-GSE-COD-ESTA.
           EXIT.
       
       VAL-FRM-GLS-ESTA SECTION.
       INI-VAL-FRM-GLS-ESTA.
       FIN-VAL-FRM-GLS-ESTA.
           EXIT.
       
       VAL-GSE-IND-ENDS SECTION.
       INI-VAL-GSE-IND-ENDS.
      *<<<< GSE_IND_ENDS
      *PVG INI 14-OCT-2003
           IF SCR-CMND = 'ING'
              MOVE 'S' TO GSE-IND-ENDS IN GSE-FLD.
      *PVG FIN 14-OCT-2003
      *INI-AFRI/JUN2005                                                 
           IF SCR-CMND = 'ING'      AND                                 
              GSE-CAI-GTIA IN GSE-FLD = WSS-0800                          
              MOVE 'N' TO GSE-IND-ENDS IN GSE-FLD.                      
      *FIN-AFRI/JUN2005
      *ISP-INI 18-06-2005                                               
           IF SCR-HDR-MRCA = 'BCS' AND                                  
              GSE-NUM-IGSE IN GSE-FLD = WSS-CTE-2                               
                MOVE 'S' TO GSE-IND-ENDS IN GSE-FLD.
      *ISP-FIN 18-06-2005
      *<<<<
           IF GSE-IND-ENDS IN GSE-FLD NOT > SPACES                      
              GO TO FIN-VAL-GSE-IND-ENDS.                               
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GSE-IND-ENDS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GSE-IND-ENDS.
      *>>>>
      *>>>>
       FIN-VAL-GSE-IND-ENDS.
           EXIT.
       
       VAL-GSE-COD-COB1 SECTION.
       INI-VAL-GSE-COD-COB1.
           IF GSE-COD-COB1 IN GSE-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSE-COD-COB1.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'CBS ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-COB1 IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-COB1 IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COB1 IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB1 IN GSE-FLD.
       FIN-VAL-GSE-COD-COB1.
           EXIT.
       
       VAL-FRM-GLS-COB1 SECTION.
       INI-VAL-FRM-GLS-COB1.
       FIN-VAL-FRM-GLS-COB1.
           EXIT.
       
       VAL-GSE-IND-PCUO SECTION.
       INI-VAL-GSE-IND-PCUO.
           IF GSE-IND-PCUO IN GSE-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSE-IND-PCUO.
      *<<<< GSE_IND_PCUO
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GSE-IND-PCUO IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GSE-IND-PCUO.
      *>>>>
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-IND-PCUO IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-GSE-IND-PCUO.
           EXIT.
       
       VAL-GSE-COD-COB2 SECTION.
       INI-VAL-GSE-COD-COB2.
           IF GSE-COD-COB2 IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-COD-COB2 IN GSE-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'CBS ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-COB2 IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-COB2 IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COB2 IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB2 IN GSE-FLD.
       FIN-VAL-GSE-COD-COB2.
           EXIT.
       
       VAL-FRM-GLS-COB2 SECTION.
       INI-VAL-FRM-GLS-COB2.
       FIN-VAL-FRM-GLS-COB2.
           EXIT.
       
       VAL-GSE-NUM-CUOT SECTION.
       INI-VAL-GSE-NUM-CUOT.
      *<<<< INI_GSE_NUM_CUOT
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = WSS-MIGRACION AND
              GSE-NUM-CUOT IN GSE-FLD NOT > ZEROES
               GO TO FIN-VAL-GSE-NUM-CUOT.
      *MHM-FIN 29-OCT-2003
      *>>>>
      *<<<< GSE_NUM_CUOT
      *PVG INI 14-OCT-2003
           IF GSE-IND-PCUO IN GSE-FLD = 'N'
              MOVE ZEROES TO GSE-NUM-CUOT IN GSE-FLD.
           IF GSE-IND-PCUO IN GSE-FLD = 'S' AND
              GSE-NUM-CUOT IN GSE-FLD NOT > ZEROES
              MOVE 'BGL'          TO MSG-COD-SIST
              MOVE 'GSO NCUOOBLI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *PVG FIN 14-OCT-2003
      *AFRI-INI JUL/2004
           IF SCR-HDR-MRCA = 'BCS'                                      
              MOVE 'BGL'          TO TAB-COD-SIST FIO-SIST              
              MOVE 'VGA'          TO TAB-COD-TTAB IN TAB                
              MOVE 'GSECUOTBCS'      TO TAB-COD-CTAB IN TAB             
              MOVE FIO-GET-KEY    TO FIO-CMND
              PERFORM GNS-FIO-TAB                                       
              IF FIO-STAT-OKS AND TAB-IND-VIGE = WSS-S                    
                 MOVE TAB-GLS-DATA TO WSS-GLS-CUOT                      
                 IF WSS-NUM-CUOT IS NUMERIC                             
                    IF GSE-NUM-CUOT IN GSE-FLD NOT > WSS-NUM-CUOT AND   
                       WSS-NUM-CUOT > ZEROES                            
                       GO TO FIN-VAL-GSE-NUM-CUOT                       
                    ELSE                                                
                       MOVE 'BGL'          TO MSG-COD-SIST              
                       MOVE 'GSO NCUO<TAB' TO MSG-COD-MENS
                       PERFORM GET-MSG                                  
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD 
                       MOVE MSG-GLS-DESC TO FRM-MENS                    
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                 ELSE
                       MOVE 'BGL'          TO MSG-COD-SIST              
                       MOVE 'GSO NCUONONU' TO MSG-COD-MENS                
                       PERFORM GET-MSG 
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD   
                       MOVE MSG-GLS-DESC TO FRM-MENS                      
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                      
              ELSE                                                      
                  IF GSE-NUM-CUOT IN GSE-FLD > 99
                       MOVE 'BGL'          TO MSG-COD-SIST              
                       MOVE 'GSO NCUO>99' TO MSG-COD-MENS               
                       PERFORM GET-MSG                                  
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD 
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR.                   
           IF SCR-HDR-MRCA NOT = 'BCS'                                  
              MOVE 'BGL'          TO TAB-COD-SIST FIO-SIST              
              MOVE 'VGA'          TO TAB-COD-TTAB IN TAB                
              MOVE 'GSECUOT'      TO TAB-COD-CTAB IN TAB
              MOVE FIO-GET-KEY    TO FIO-CMND                           
              PERFORM GNS-FIO-TAB
              IF FIO-STAT-OKS AND TAB-IND-VIGE = WSS-S
                 MOVE TAB-GLS-DATA TO WSS-GLS-CUOT
                 IF WSS-NUM-CUOT IS NUMERIC
                    IF GSE-NUM-CUOT IN GSE-FLD NOT > WSS-NUM-CUOT AND
                       WSS-NUM-CUOT > ZEROES
                       GO TO FIN-VAL-GSE-NUM-CUOT
                    ELSE
                       MOVE 'BGL'          TO MSG-COD-SIST
                       MOVE 'GSO NCUO<TAB' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                 ELSE
                     MOVE 'BGL'          TO MSG-COD-SIST
                     MOVE 'GSO NCUONONU' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                  IF GSE-NUM-CUOT IN GSE-FLD > 11
                       MOVE 'BGL'          TO MSG-COD-SIST
                       MOVE 'GSO NCUO>11' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *AFRI-FIN JUL/2004
      *>>>>
       FIN-VAL-GSE-NUM-CUOT.
           EXIT.
       
       VAL-GSE-COD-COB3 SECTION.
       INI-VAL-GSE-COD-COB3.
           IF GSE-COD-COB3 IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-COD-COB3 IN GSE-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'CBS ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-COB3 IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-COB3 IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COB3 IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB3 IN GSE-FLD.
       FIN-VAL-GSE-COD-COB3.
           EXIT.
       
       VAL-FRM-GLS-COB3 SECTION.
       INI-VAL-FRM-GLS-COB3.
       FIN-VAL-FRM-GLS-COB3.
           EXIT.
       
       VAL-GDG-IND-INOB SECTION.
       INI-VAL-GDG-IND-INOB.
           IF GDG-IND-INOB IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GDG-IND-INOB IN GSE-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IND-INOB IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-GDG-IND-INOB.
           EXIT.
       
       VAL-GSE-COD-COB4 SECTION.
       INI-VAL-GSE-COD-COB4.
           IF GSE-COD-COB4 IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-COD-COB4 IN GSE-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'CBS ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-COB4 IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-COB4 IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COB4 IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB4 IN GSE-FLD.
       FIN-VAL-GSE-COD-COB4.
           EXIT.
       
       VAL-FRM-GLS-COB4 SECTION.
       INI-VAL-FRM-GLS-COB4.
       FIN-VAL-FRM-GLS-COB4.
           EXIT.
       
       VAL-GSE-IND-SEGU SECTION.
       INI-VAL-GSE-IND-SEGU.
           IF GSE-IND-SEGU IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-IND-SEGU IN GSE-FLD.
      *<<<<
           IF (GSE-IND-SEGU IN GSE-FLD) > SPACES                        
              IF GSE-IND-SEGU IN GSE-FLD = WSS-S OR                       
                 GSE-IND-SEGU IN GSE-FLD = WSS-N                          
                 GO TO FIN-VAL-GSE-IND-SEGU                             
              ELSE                                                      
                  MOVE 'BGL'        TO MSG-COD-SIST                     
                  MOVE 'SEG NO VALI' TO MSG-COD-MENS                    
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-GSE-IND-SEGU                            
           ELSE                                                         
                MOVE SPACES TO GSE-IND-SEGU IN GSE-FLD.                 
      *>>>>
       FIN-VAL-GSE-IND-SEGU.
           EXIT.
       
       VAL-GSE-COD-COB5 SECTION.
       INI-VAL-GSE-COD-COB5.
           IF GSE-COD-COB5 IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-COD-COB5 IN GSE-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'CBS ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-COB5 IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-COB5 IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COB5 IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB5 IN GSE-FLD.
       FIN-VAL-GSE-COD-COB5.
           EXIT.
       
       VAL-FRM-GLS-COB5 SECTION.
       INI-VAL-FRM-GLS-COB5.
       FIN-VAL-FRM-GLS-COB5.
           EXIT.
       
       VAL-GSE-GLS-IMPR SECTION.
       INI-VAL-GSE-GLS-IMPR.
           IF GSE-GLS-IMPR IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-GLS-IMPR IN GSE-FLD.
      *<<<<
           IF ((GSE-GLS-IMPR IN GSE-FLD) > SPACES AND                   
               (GSE-GLS-IMPR IN GSE-FLD = WSS-S OR                        
                GSE-GLS-IMPR IN GSE-FLD = WSS-N))                         
                GO TO FIN-VAL-GSE-GLS-IMPR                              
           ELSE                                                         
                MOVE SPACES TO GSE-GLS-IMPR IN GSE-FLD.                 
      *>>>>
       FIN-VAL-GSE-GLS-IMPR.
           EXIT.
       
       VAL-FRM-GLS-ESTD SECTION.
       INI-VAL-FRM-GLS-ESTD.
       FIN-VAL-FRM-GLS-ESTD.
           EXIT.
       
       VAL-CON-FLD-GSE SECTION.
       INI-VAL-CON-FLD-GSE.
      *<<<< VAL_CON_FLD_GSE
           IF NOT PGM-STAT-GVT-OKS
      *MHM-INI 01-DIC-2004                                              
      *        MOVE 'GSEGVTNEX' TO MSG-COD-MENS                         
               MOVE 'GSEGVTNEX' TO MSG-COD-MENS.                        
      *    ELSE                                                         
      *    IF GSE-COD-VCMS IN GSE-FLD = GDG-COD-VCAM IN GSE-FLD AND     
      *       GSE-SGV-SEGU IN GSE-FLD < GAR-SGV-LTSN IN CMA-VARI        
      *        MOVE 'GSESEG<LIQ' TO MSG-COD-MENS.                       
      *MHM-FIN 01-DIC-2004                                              
      *>>>>
       FIN-VAL-CON-FLD-GSE.
           EXIT.
       
       VAL-CON-GSE SECTION.
       INI-VAL-CON-GSE.
       FIN-VAL-CON-GSE.
           EXIT.
       
       VAL-NUM-KEY-GSE SECTION.
       INI-VAL-NUM-KEY-GSE.
           PERFORM VAL-NUM-IKY-GSE.
           PERFORM VAL-NUM-MKY-GSE.
           PERFORM VAL-NUM-AKY-GSE.
       FIN-VAL-NUM-KEY-GSE.
           EXIT.
       
       VAL-NUM-IKY-GSE SECTION.
       INI-VAL-NUM-IKY-GSE.
       VAL-NUM-GSE-IIC-GTIA.
           MOVE GSE-IIC-GTIA-ALF IN GSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSE-IIC-GTIA IN GSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSE-IIC-GTIA-LEN IN GSE-FLD
                GO TO FIN-VAL-NUM-IKY-GSE.
       VAL-NUM-GSE-NUM-IGSE.
           MOVE GSE-NUM-IGSE-ALF IN GSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSE-NUM-IGSE IN GSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSE-NUM-IGSE-LEN IN GSE-FLD
                GO TO FIN-VAL-NUM-IKY-GSE.
       FIN-VAL-NUM-IKY-GSE.
           EXIT.
       
       VAL-NUM-MKY-GSE SECTION.
       INI-VAL-NUM-MKY-GSE.
       FIN-VAL-NUM-MKY-GSE.
           EXIT.
       
       VAL-NUM-AKY-GSE SECTION.
       INI-VAL-NUM-AKY-GSE.
       FIN-VAL-NUM-AKY-GSE.
           EXIT.
       
       VAL-NUM-FLD-GSE SECTION.
       INI-VAL-NUM-FLD-GSE.
       VAL-NUM-GSE-NUM-PROP.
           MOVE GSE-NUM-PROP-ALF IN GSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSE-NUM-PROP IN GSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSE-NUM-PROP-LEN IN GSE-FLD
                GO TO FIN-VAL-NUM-FLD-GSE.
       VAL-NUM-GSE-NUM-DEDU.
           MOVE GSE-NUM-DEDU-ALF IN GSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSE-NUM-DEDU IN GSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSE-NUM-DEDU-LEN IN GSE-FLD
                GO TO FIN-VAL-NUM-FLD-GSE.
       VAL-NUM-GSE-SGV-SEGU.
           MOVE GSE-SGV-SEGU-ALF IN GSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GSE-SGV-SEGU IN GSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSE-SGV-SEGU-LEN IN GSE-FLD
                GO TO FIN-VAL-NUM-FLD-GSE.
       VAL-NUM-GSE-VAL-MPRI.
           MOVE GSE-VAL-MPRI-ALF IN GSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GSE-VAL-MPRI IN GSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSE-VAL-MPRI-LEN IN GSE-FLD
                GO TO FIN-VAL-NUM-FLD-GSE.
       VAL-NUM-GSE-NUM-CUOT.
           MOVE GSE-NUM-CUOT-ALF IN GSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSE-NUM-CUOT IN GSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSE-NUM-CUOT-LEN IN GSE-FLD
                GO TO FIN-VAL-NUM-FLD-GSE.
       FIN-VAL-NUM-FLD-GSE.
           EXIT.
       
       EDT-KEY-GSE SECTION.
       INI-EDT-KEY-GSE.
           PERFORM EDT-IKY-GSE.
           PERFORM EDT-MKY-GSE.
           PERFORM EDT-AKY-GSE.
       FIN-EDT-KEY-GSE.
           EXIT.
       
       EDT-IKY-GSE SECTION.
       INI-EDT-IKY-GSE.
           IF GSE-IIC-GTIA-LEN IN GSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSE-IIC-GTIA-LEN IN GSE-FLD
                GO TO FIN-EDT-IKY-GSE.
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GSE-IIC-GTIA-EDT IN GSE-EDT.
           MOVE GSE-IIC-GTIA-EDT IN GSE-EDT TO 
                GSE-IIC-GTIA-ALF IN GSE-FLD.
           IF GSE-NUM-IGSE-LEN IN GSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSE-NUM-IGSE-LEN IN GSE-FLD
                GO TO FIN-EDT-IKY-GSE.
           MOVE GSE-NUM-IGSE IN GSE-FLD TO GSE-NUM-IGSE-EDT IN GSE-EDT.
           MOVE GSE-NUM-IGSE-EDT IN GSE-EDT TO 
                GSE-NUM-IGSE-ALF IN GSE-FLD.
       FIN-EDT-IKY-GSE.
           EXIT.
       
       EDT-MKY-GSE SECTION.
       INI-EDT-MKY-GSE.
       FIN-EDT-MKY-GSE.
           EXIT.
       
       EDT-AKY-GSE SECTION.
       INI-EDT-AKY-GSE.
       FIN-EDT-AKY-GSE.
           EXIT.
       
       EDT-FLD-GSE SECTION.
       INI-EDT-FLD-GSE.
           IF GSE-NUM-PROP-LEN IN GSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSE-NUM-PROP-LEN IN GSE-FLD
                GO TO FIN-EDT-FLD-GSE.
           MOVE GSE-NUM-PROP IN GSE-FLD TO GSE-NUM-PROP-EDT IN GSE-EDT.
           MOVE GSE-NUM-PROP-EDT IN GSE-EDT TO 
                GSE-NUM-PROP-ALF IN GSE-FLD.
           IF GSE-NUM-DEDU-LEN IN GSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSE-NUM-DEDU-LEN IN GSE-FLD
                GO TO FIN-EDT-FLD-GSE.
           MOVE GSE-NUM-DEDU IN GSE-FLD TO GSE-NUM-DEDU-EDT IN GSE-EDT.
           MOVE GSE-NUM-DEDU-EDT IN GSE-EDT TO 
                GSE-NUM-DEDU-ALF IN GSE-FLD.
           IF GSE-SGV-SEGU-LEN IN GSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSE-SGV-SEGU-LEN IN GSE-FLD
                GO TO FIN-EDT-FLD-GSE.
           MOVE GSE-SGV-SEGU IN GSE-FLD TO GSE-SGV-SEGU-EDT IN GSE-EDT.
           MOVE GSE-SGV-SEGU-EDT IN GSE-EDT TO 
                GSE-SGV-SEGU-ALF IN GSE-FLD.
           IF GSE-VAL-MPRI-LEN IN GSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSE-VAL-MPRI-LEN IN GSE-FLD
                GO TO FIN-EDT-FLD-GSE.
           MOVE GSE-VAL-MPRI IN GSE-FLD TO GSE-VAL-MPRI-EDT IN GSE-EDT.
           MOVE GSE-VAL-MPRI-EDT IN GSE-EDT TO 
                GSE-VAL-MPRI-ALF IN GSE-FLD.
           IF GSE-NUM-CUOT-LEN IN GSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSE-NUM-CUOT-LEN IN GSE-FLD
                GO TO FIN-EDT-FLD-GSE.
           MOVE GSE-NUM-CUOT IN GSE-FLD TO GSE-NUM-CUOT-EDT IN GSE-EDT.
           MOVE GSE-NUM-CUOT-EDT IN GSE-EDT TO 
                GSE-NUM-CUOT-ALF IN GSE-FLD.
       FIN-EDT-FLD-GSE.
           EXIT.
