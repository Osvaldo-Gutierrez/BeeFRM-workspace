      *
      * BGLBUGES
      * Version 3.0.1 Nov-2005
      * 06-Mar-19 12:55 PM
      *
      *-----------------------------------------------------------------
      *  Autor     : BEE-MPB
      *  Fecha     : 01-02-2019
      *  NUB       : 54088
      *  Proyecto  : MODIFICACION PANTALLA GES
      *  ID        : MPB-INI 01-FEB-2019 MODIFICACION PANTALLA GES
      *  Cambios   : QUE INFORMACION DEL CREDITO NO SE GRABE EN GES
      *              QUE TODA LA INFORMACION EN PANTALLA DEL CREDITO 
      *              SEA EN LINEA DESDE OPC/DLC
      *---------------------------------------------------------------- 
       SET-TAG-BGLBUGES SECTION.
       INI-SET-TAG-BGLBUGES.
           MOVE
           '<IDNMOD NOM=$BGLBUGES$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$06-Mar-19 12:55 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGES.
           EXIT.
           
       RET-ALL-GES SECTION.
       INI-RET-ALL-GES.
           PERFORM KEY-ALL-GES.
           PERFORM RET-GES-GES.
           PERFORM RET-GDG-GES.
       FIN-RET-ALL-GES.
           EXIT.
       
       RET-GES-GES SECTION.
       INI-RET-GES-GES.
           MOVE GES-COD-PACR IN GES-FLD TO GES-COD-PACR IN GES.
           MOVE GES-COD-SIST IN GES-FLD TO GES-COD-SIST IN GES.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GES-NUM-DVCR IN GES-FLD TO GES-NUM-DVCR IN GES.
           MOVE GES-NUM-MVCR IN GES-FLD TO GES-NUM-MVCR IN GES.
           MOVE GES-NUM-SVCR IN GES-FLD TO GES-NUM-SVCR IN GES.
           MOVE GES-NUM-AVCR IN GES-FLD TO GES-NUM-AVCR IN GES.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GES-IND-SCRE IN GES-FLD TO GES-IND-SCRE IN GES.
           MOVE GES-COD-MVLC IN GES-FLD TO GES-COD-MVLC IN GES.
           MOVE GES-SGV-VLCR IN GES-FLD TO GES-SGV-VLCR IN GES.
           MOVE GES-SGV-PLCR IN GES-FLD TO GES-SGV-PLCR IN GES.
           MOVE GES-COD-TVCC IN GES-FLD TO GES-COD-TVCC IN GES.
           MOVE GES-COD-TOPE IN GES-FLD TO GES-COD-TOPE IN GES.
           MOVE GES-COD-SOPE IN GES-FLD TO GES-COD-SOPE IN GES.
           MOVE GES-COD-VCMC IN GES-FLD TO GES-COD-VCMC IN GES.
           MOVE GES-COD-DCRE IN GES-FLD TO GES-COD-DCRE IN GES.
           MOVE GES-IND-TDEU IN GES-FLD TO GES-IND-TDEU IN GES.
           MOVE GES-KEY-IDGP IN GES-FLD TO GES-KEY-IDGP IN GES.
       FIN-RET-GES-GES.
           EXIT.
       
       RET-GDG-GES SECTION.
       INI-RET-GDG-GES.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GES-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GES-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
      * OFI-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-OFIC IN GES-FLD TO GDG-COD-OFIC IN GDG.
      * OFI-FIN --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-VCAM IN GES-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-GLS-DGTA IN GES-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-GLS-DGT1 IN GES-FLD TO GDG-GLS-DGT1 IN GDG.
       FIN-RET-GDG-GES.
           EXIT.
       
       KEY-ALL-GES SECTION.
       INI-KEY-ALL-GES.
           PERFORM KEY-GES-GES.
           PERFORM KEY-GDG-GES.
       FIN-KEY-ALL-GES.
           EXIT.
       
       KEY-GES-GES SECTION.
       INI-KEY-GES-GES.
           MOVE GES-CAI-GTIA IN GES-FLD TO GES-CAI-GTIA IN GES.
           MOVE GES-IIC-GTIA IN GES-FLD TO GES-IIC-GTIA IN GES.
           MOVE GES-NUM-IGES IN GES-FLD TO GES-NUM-IGES IN GES.
           MOVE GES-CAI-IOPC IN GES-FLD TO GES-CAI-IOPC IN GES.
           MOVE GES-IIC-IOPC IN GES-FLD TO GES-IIC-IOPC IN GES.
           MOVE GES-NUM-IDLC IN GES-FLD TO GES-NUM-IDLC IN GES.
       FIN-KEY-GES-GES.
           EXIT.
       
       KEY-GDG-GES SECTION.
       INI-KEY-GDG-GES.
       FIN-KEY-GDG-GES.
           EXIT.
       
       SCR-CLRA-GES SECTION.
       INI-SCR-CLRA-GES.
           PERFORM CLR-KEY-GES.
           PERFORM CLR-FLD-GES.
       FIN-SCR-CLRA-GES.
           EXIT.
       
       CLR-KEY-GES SECTION.
       INI-CLR-KEY-GES.
           MOVE SPACES TO GES-CAI-GTIA IN GES-FLD.
           MOVE ZEROES TO GES-IIC-GTIA IN GES-FLD.
           MOVE ZEROES TO GES-NUM-IGES IN GES-FLD.
           MOVE SPACES TO GES-CAI-IOPC IN GES-FLD.
           MOVE ZEROES TO GES-IIC-IOPC IN GES-FLD.
           MOVE ZEROES TO GES-NUM-IDLC IN GES-FLD.
       FIN-CLR-KEY-GES.
           EXIT.
       
       CLR-FLD-GES SECTION.
       INI-CLR-FLD-GES.
           MOVE SPACES TO FRM-GLS-TREA IN GES-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GES-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GES-FLD.
           MOVE SPACES TO FRM-GLS-SIST IN GES-FLD.
           MOVE SPACES TO FRM-GLS-MVLC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TVCC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TOPE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-SOPE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCMC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-DCRE IN GES-FLD.
           PERFORM CLR-GES-GES.
           PERFORM CLR-GDG-GES.
       FIN-CLR-FLD-GES.
           EXIT.
       
       CLR-GES-GES SECTION.
       INI-CLR-GES-GES.
           MOVE ZEROES TO GES-COD-PACR IN GES-FLD.
           MOVE SPACES TO GES-COD-SIST IN GES-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GES-FEC-FVCR IN GES-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GES-IND-SCRE IN GES-FLD.
           MOVE SPACES TO GES-COD-MVLC IN GES-FLD.
           MOVE ZEROES TO GES-SGV-VLCR IN GES-FLD.
           MOVE ZEROES TO GES-SGV-PLCR IN GES-FLD.
           MOVE SPACES TO GES-COD-TVCC IN GES-FLD.
           MOVE SPACES TO GES-COD-TOPE IN GES-FLD.
           MOVE SPACES TO GES-COD-SOPE IN GES-FLD.
           MOVE SPACES TO GES-COD-VCMC IN GES-FLD.
           MOVE SPACES TO GES-COD-DCRE IN GES-FLD.
           MOVE SPACES TO GES-IND-TDEU IN GES-FLD.
           MOVE SPACES TO GES-KEY-IDGP IN GES-FLD.
       FIN-CLR-GES-GES.
           EXIT.
       
       CLR-GDG-GES SECTION.
       INI-CLR-GDG-GES.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GES-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GES-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GES-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GES-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GES-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GES-FLD.
       FIN-CLR-GDG-GES.
           EXIT.
       
       FST-KEY-GES SECTION.
       INI-FST-KEY-GES.
           MOVE -1 TO GES-CAI-GTIA-LEN IN GES-FLD.
       FIN-FST-KEY-GES.
           EXIT.
       
       FST-FLD-GES SECTION.
       INI-FST-FLD-GES.
           MOVE -1 TO GES-COD-PACR-LEN IN GES-FLD.
      *<<<< FIN_FST_FLD_GES
      *<<<< FMT_CHI
           IF GES-IIC-IOPC IN GES-FLD > ZEROES
      *>>>>
               MOVE FRM-CPIM-AEY TO GES-FEC-FVCR-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-FEC-FVCR-STP

               MOVE FRM-CPIM-AEY TO GES-COD-TVCC-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-TVCC-STP

      *<<<< GEN_BCI
      *JRF-INI 29-JUL-2003
               MOVE FRM-CPIM-AEY TO GES-COD-TOPE-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-TOPE-STP
               MOVE FRM-CPIM-AEY TO GES-COD-SOPE-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-SOPE-STP
      *JRF-FIN 29-JUL-2003
      *>>>>
               MOVE FRM-CPIM-AEY TO GES-COD-VCMC-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-VCMC-STP

               MOVE FRM-CPIM-AEY TO GES-COD-DCRE-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-DCRE-STP

               MOVE FRM-CPIM-AEY TO GES-IND-TDEU-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-IND-TDEU-STP.
      *>>>>
       FIN-FST-FLD-GES.
           EXIT.
       
       PRO-KEY-GES SECTION.
       INI-PRO-KEY-GES.
           PERFORM PRO-MKY-GES.
       FIN-PRO-KEY-GES.
           EXIT.
       
       PRO-MKY-GES SECTION.
       INI-PRO-MKY-GES.
           MOVE FRM-CPIM-AEY TO GES-CAI-IOPC-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-IIC-IOPC-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-NUM-IDLC-ATR IN GES-FLD.
       FIN-PRO-MKY-GES.
           EXIT.
       
       PRO-FLD-GES SECTION.
       INI-PRO-FLD-GES.
           PERFORM PRO-GES-GES.
           PERFORM PRO-GDG-GES.
       FIN-PRO-FLD-GES.
           EXIT.
       
       PRO-GES-GES SECTION.
       INI-PRO-GES-GES.
           MOVE FRM-CPIM-AEY TO GES-COD-PACR-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-SIST-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-FEC-FVCR-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-IND-SCRE-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-MVLC-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-SGV-VLCR-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-SGV-PLCR-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-TVCC-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-TOPE-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-SOPE-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-VCMC-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-DCRE-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-IND-TDEU-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-KEY-IDGP-ATR IN GES-FLD.
       FIN-PRO-GES-GES.
           EXIT.
       
       PRO-GDG-GES SECTION.
       INI-PRO-GDG-GES.
       FIN-PRO-GDG-GES.
           EXIT.
       
       UNP-KEY-GES SECTION.
       INI-UNP-KEY-GES.
           PERFORM UNP-IKY-GES.
           PERFORM UNP-AKY-GES.
           PERFORM UNP-MKY-GES.
       FIN-UNP-KEY-GES.
           EXIT.
       
       UNP-IKY-GES SECTION.
       INI-UNP-IKY-GES.
           MOVE FRM-CPIM-UBY TO GES-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GES-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GES-NUM-IGES-ATR.
      *<<<< FIN_UNP_IKY_GES 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GES-NUM-IGES-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-NUM-IGES-STP.
      *RRM-FIN 16-APR-2002
      *>>>>
       FIN-UNP-IKY-GES.
           EXIT.
       
       UNP-MKY-GES SECTION.
       INI-UNP-MKY-GES.
           MOVE FRM-CPIM-UBY TO GES-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO GES-IIC-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO GES-NUM-IDLC-ATR.
       FIN-UNP-MKY-GES.
           EXIT.
       
       UNP-AKY-GES SECTION.
       INI-UNP-AKY-GES.
       FIN-UNP-AKY-GES.
           EXIT.
       
       UNP-FLD-GES SECTION.
       INI-UNP-FLD-GES.
           PERFORM UNP-GES-GES.
           PERFORM UNP-GDG-GES.
       FIN-UNP-FLD-GES.
           EXIT.
       
       UNP-GES-GES SECTION.
       INI-UNP-GES-GES.
           MOVE FRM-CPIM-UBY TO GES-COD-PACR-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-SIST-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-FEC-FVCR-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-IND-SCRE-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-MVLC-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-SGV-VLCR-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-SGV-PLCR-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-TVCC-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-TOPE-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-SOPE-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-VCMC-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-DCRE-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-IND-TDEU-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-KEY-IDGP-ATR IN GES-FLD.
      *<<<< FIN_UNP_GES_GES
           IF SCR-CCPP = 'ING'
              MOVE 'S'          TO GES-IND-SCRE     IN GES-FLD
              MOVE FRM-CPIM-AEY TO GES-IND-SCRE-ATR IN GES-FLD
              MOVE FRM-CPIM-AEY TO GES-IND-SCRE-STP.
      
           MOVE 'BGL'               TO FIO-SIST.              
           MOVE 'VSN'               TO TAB-COD-TTAB IN TAB.   
           MOVE 'SOLOESPECOPE'      TO TAB-COD-CTAB IN TAB.   

           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              IF TAB-IND-VIGE IN TAB = 'S'
      *RRM-INI 16-APR-2002
                 MOVE FRM-CPIM-AEY TO GES-FEC-FVCR-ATR IN GES-FLD
                 MOVE FRM-CPIM-AEY TO GES-FEC-FVCR-STP
      *RRM-FIN 16-APR-2002
                 MOVE FRM-CPIM-AEY TO GES-COD-TVCC-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-TVCC-STP 
      *<<<< GEN_BCI
      *JRF-INI 29-JUL-2003
                 MOVE FRM-CPIM-AEY TO GES-COD-TOPE-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-TOPE-STP 
                 MOVE FRM-CPIM-AEY TO GES-COD-SOPE-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-SOPE-STP 
      *JRF-FIN 29-JUL-2003
      *>>>>
                 MOVE FRM-CPIM-AEY TO GES-COD-VCMC-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-VCMC-STP 
                 MOVE FRM-CPIM-AEY TO GES-COD-DCRE-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-DCRE-STP 
                 MOVE FRM-CPIM-AEY TO GES-IND-TDEU-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-IND-TDEU-STP.

      *>>>>
       FIN-UNP-GES-GES.
           EXIT.
       
       UNP-GDG-GES SECTION.
       INI-UNP-GDG-GES.
       FIN-UNP-GDG-GES.
           EXIT.
       
       VAL-MKY-GES SECTION.
       INI-VAL-MKY-GES.
      *<<<<INI_VAL_MKY_GES
           GO TO FIN-VAL-MKY-GES.
      *>>>>
       FIN-VAL-MKY-GES.
           EXIT.
       
       VAL-FLD-GES SECTION.
       INI-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-TREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TREA-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
      * IDG-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-TIP-CGTA-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-STP-CGTA-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
      * IDG-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
      * OFI-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-COD-OFIC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
      * OFI-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-PACR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-COD-PACR-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-SIST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-COD-SIST-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-SIST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SIST-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-CAI-IOPC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-IIC-IOPC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GES-FEC-FVCR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GES-FEC-FVCR-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GES-NUM-IDLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-NUM-IDLC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-IND-SCRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-IND-SCRE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-MVLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-COD-MVLC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-MVLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-MVLC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-SGV-VLCR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-SGV-VLCR-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-SGV-PLCR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-SGV-PLCR-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-TVCC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-COD-TVCC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-TVCC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TVCC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-TOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-COD-TOPE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-TOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOPE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-SOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-COD-SOPE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-SOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SOPE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-VCMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-COD-VCMC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-VCMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCMC-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-DCRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-COD-DCRE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-DCRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-DCRE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-IND-TDEU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-IND-TDEU-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-KEY-IDGP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-KEY-IDGP-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
       FIN-VAL-FLD-GES.
           EXIT.
       
       VAL-FRM-GLS-TREA SECTION.
       INI-VAL-FRM-GLS-TREA.
       FIN-VAL-FRM-GLS-TREA.
           EXIT.
      * IDG-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.
           IF GDG-TIP-CGTA IN GES-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-CGTA IN GES-FLD.
       FIN-VAL-GDG-TIP-CGTA.
           EXIT.

       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.
           IF GDG-STP-CGTA IN GES-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-CGTA IN GES-FLD.
       FIN-VAL-GDG-STP-CGTA.
           EXIT.
      * IDG-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * OFI-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
           IF GDG-COD-OFIC IN GES-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GES-FLD.
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
      * OFI-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
       
       VAL-GES-COD-PACR SECTION.
       INI-VAL-GES-COD-PACR.
           IF GES-COD-PACR IN GES-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GES-COD-PACR.
      *<<<< FIN_GES_COD_PACR

           MOVE GES-CAI-GTIA IN GES-FLD  TO GAP-CAI-GTIA IN GAP.
           MOVE GES-IIC-GTIA IN GES-FLD  TO GAP-IIC-GTIA IN GAP.
           MOVE GES-COD-PACR IN GES-FLD  TO GAP-COD-PACR IN GAP.
           MOVE FIO-GET-KEY  TO  FIO-CMND.                      
           PERFORM BGL-FIO-GAP.                                 
           IF NOT FIO-STAT-OKS                                  
              MOVE 'BGL'          TO MSG-COD-SIST               
              MOVE 'NOEXISTEGAP ' TO MSG-COD-MENS               
              PERFORM GET-MSG                                   
              MOVE MSG-GLS-DESC TO FRM-MENS                     
              MOVE FRM-SUAR-MAL TO FRM-SUAR                     
              GO TO FIN-VAL-GES-COD-PACR.                       
                                                                
           IF GAP-IND-ESBA IN GAP = 'N'                         
              MOVE 'BGL'          TO MSG-COD-SIST               
              MOVE 'ACRENOBANCO ' TO MSG-COD-MENS               
              PERFORM GET-MSG                                   
              MOVE MSG-GLS-DESC TO FRM-MENS                     
              MOVE FRM-SUAR-MAL TO FRM-SUAR                     
              GO TO FIN-VAL-GES-COD-PACR.                       
                                                                
           IF GAP-IND-MASC IN GAP = 'N'                         
              MOVE 'BGL'          TO MSG-COD-SIST              
              MOVE 'NOACEPTACRE ' TO MSG-COD-MENS              
              PERFORM GET-MSG                                  
              MOVE MSG-GLS-DESC TO FRM-MENS                    
              MOVE FRM-SUAR-MAL TO FRM-SUAR                    
              GO TO FIN-VAL-GES-COD-PACR.                      
                                                               
      *<<<< FMT_CHI
           MOVE GAP-CAI-GTIA IN GAP TO GDG-CAI-GTIA IN GDG.             
           MOVE GAP-IIC-GTIA IN GAP TO GDG-IIC-GTIA IN GDG.             
           MOVE FIO-GET-KEY  TO  FIO-CMND.                              
           PERFORM BGL-FIO-GDG.                                         
           IF GDG-COD-LGTA IN GDG = 'A' AND                             
              GAP-COD-GPRE IN GAP NOT = 'E'                             
              MOVE 'BGL'          TO MSG-COD-SIST                       
              MOVE 'GTIANOESPEC ' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-GES-COD-PACR.                               
                                                                        
           MOVE GDG-TIP-CGTA IN GES-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GES-FLD TO TAG-STP-AGTA IN TAG.
      *>>>>
           MOVE FIO-GET-KEY    TO FIO-CMND.                    
           PERFORM BGL-FIO-TAG.                                
           IF NOT FIO-STAT-OKS                                 
              MOVE 'TAG    NEX' TO MSG-COD-MENS                
              MOVE 'BGL' TO MSG-COD-SIST                       
              PERFORM GET-MSG                                  
              MOVE MSG-GLS-DESC TO FRM-MENS                    
              MOVE FRM-SUAR-MAL TO FRM-SUAR                    
              GO TO FIN-VAL-GES-COD-PACR.                      
                                                               
           IF TAG-IND-EGLE IN TAG NOT = 'S'                    
              GO TO FIN-VAL-GES-COD-PACR.                      
                                                               
           MOVE GES-CAI-GTIA IN GES-FLD TO GLE-CAI-GTIA IN GLE.
           MOVE GES-IIC-GTIA IN GES-FLD TO GLE-IIC-GTIA IN GLE.
           MOVE GES-COD-PACR IN GES-FLD TO GLE-COD-PACR IN GLE.
           MOVE FIO-GET-KEY    TO FIO-CMND.                    
           PERFORM BGL-FIO-GLE.                                
           IF NOT FIO-STAT-OKS                                 
              MOVE 'GLE    NEX' TO MSG-COD-MENS                
              MOVE 'BGL' TO MSG-COD-SIST                       
              PERFORM GET-MSG                                  
              MOVE MSG-GLS-DESC TO FRM-MENS                    
              MOVE FRM-SUAR-MAL TO FRM-SUAR                    
              GO TO FIN-VAL-GES-COD-PACR.                      

      *>>>>
       FIN-VAL-GES-COD-PACR.
           EXIT.
       
       VAL-GES-COD-SIST SECTION.
       INI-VAL-GES-COD-SIST.
      *<<<< INI_GES_COD_SIST                               
           MOVE 'BGL'               TO FIO-SIST.           
           MOVE 'VSN'               TO TAB-COD-TTAB IN TAB.
           MOVE 'SOLOESPECOPE'      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY         TO FIO-CMND.           
           PERFORM GNS-FIO-TAB.                            
           IF NOT FIO-STAT-OKS                             
              MOVE 'N' TO WSS-IND-VIGE                     
           ELSE                                            
              MOVE TAB-IND-VIGE IN TAB TO WSS-IND-VIGE.    
                                                           
           IF WSS-IND-VIGE = 'N' AND                       

      *RRM-INI 16-APR-2002
      *       GES-COD-SIST IN GES-FLD NOT > SPACES
              GES-COD-SIST IN GES-FLD NOT > SPACES AND
      *<<<< FMT_CHI
              GES-IIC-IOPC IN GES-FLD NOT > ZEROES AND    
      *>>>>
              GES-NUM-IDLC IN GES-FLD NOT > ZEROES 
      *RRM-FIN 16-APR-2002
               MOVE SPACES TO GES-COD-SIST IN GES-FLD
               GO TO FIN-VAL-GES-COD-SIST.
      *>>>>                                                
           IF GES-COD-SIST IN GES-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GES-COD-SIST.
      *<<<< GES_COD_SIST
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'SIS ' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-SIST IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-COD-SIST IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SIST IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SIST IN GES-FLD.
      *<<<< FIN_GES_COD_SIST                               
      *>>>>                                                
       FIN-VAL-GES-COD-SIST.
           EXIT.
       
       VAL-FRM-GLS-SIST SECTION.
       INI-VAL-FRM-GLS-SIST.
       FIN-VAL-FRM-GLS-SIST.
           EXIT.
       
       VAL-GES-CAI-IOPC SECTION.
       INI-VAL-GES-CAI-IOPC.
      *<<<<
      *AFRI-INI/MARZO2007 (MAE)                                         
      *    IF GES-CAI-IOPC IN GES-FLD NOT > SPACES                      
      *       MOVE SPACES TO GES-CAI-IOPC IN GES-FLD.                   
           IF SCR-HDR-MRCA NOT = 'BCS'  AND                             
              GES-CAI-IOPC IN GES-FLD NOT > SPACES                      
              MOVE SPACES TO GES-CAI-IOPC IN GES-FLD.                   
      *AFRI-FIN/MARZO2007 (MAE)   
           GO TO FIN-VAL-GES-CAI-IOPC.                                      
      *>>>>
           IF GES-CAI-IOPC IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-CAI-IOPC IN GES-FLD.
       FIN-VAL-GES-CAI-IOPC.
           EXIT.
       
       VAL-GES-IIC-IOPC SECTION.
       INI-VAL-GES-IIC-IOPC.
      *<<<< GES_IIC_IOPC
      *RRM-INI 16-APR-2002
           IF WSS-IND-VIGE = 'N' AND
              GES-IIC-IOPC IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-IIC-IOPC IN GES-FLD
               GO TO FIN-VAL-GES-IIC-IOPC.
      *RRM-FIN 16-APR-2002

      *>>>>
      *<<<<
      *AFRI-INI/MARZO2007 (MAE)                                         
      *    IF GES-IIC-IOPC IN GES-FLD NOT > ZEROES                      
      *        MOVE ZEROES TO GES-IIC-IOPC IN GES-FLD.                  
           IF SCR-HDR-MRCA NOT = 'BCS'                                  
               GO TO FIN-VAL-GES-IIC-IOPC.                              
                                                                        
           IF SCR-HDR-MRCA = 'BCS' AND                                  
              GES-IIC-IOPC IN GES-FLD NOT > ZEROES                      
               GO TO FIN-VAL-GES-IIC-IOPC.                              
                                                                        
      *    IF SCR-HDR-MRCA = 'BCS'                                      
           MOVE SPACES TO WSS-IND-IOPC.                                 
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'VALOPC'     TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
      *        MOVE 'BGL'         TO MSG-COD-SIST                       
      *        MOVE 'TABLA NOVIG' TO MSG-COD-MENS                       
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC TO FRM-MENS                            
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE 'N'          TO WSS-IND-IOPC                        
           ELSE                                                         
               MOVE 'S'           TO WSS-IND-IOPC.                      
                                                                        
                                                                        
           IF  (WSS-IND-IOPC = 'N' OR                                   
                WSS-IND-IOPC = SPACES )                                 
                 GO TO FIN-VAL-GES-IIC-IOPC.                            
                                                                        
           IF (WSS-IND-IOPC NOT = 'S')                                  
                 GO TO FIN-VAL-GES-IIC-IOPC.                            
                                                                        
      *    IF WSS-IND-IOPC = 'S'                                        
           MOVE GES-CAI-IOPC IN GES-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE GES-IIC-IOPC IN GES-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY    TO  FIO-CMND.                            
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'OPC NOVALI' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GES-IIC-IOPC.                              
                                                                        
           IF (FIO-STAT-OKS AND                                         
               GES-KEY-IDGP IN GES-FLD > SPACES  AND                    
               GES-KEY-IDGP IN GES-FLD NOT = OPC-CIC-ICEN)              
                MOVE 'BGL'         TO MSG-COD-SIST                      
                MOVE 'OPC NO=GES' TO MSG-COD-MENS                       
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
                GO TO FIN-VAL-GES-IIC-IOPC.                             
                                                                        
           IF (FIO-STAT-OKS AND                                         
               GES-KEY-IDGP IN GES-FLD > SPACES  AND                    
               GES-KEY-IDGP IN GES-FLD = OPC-CIC-ICEN)                  
                GO TO FIN-VAL-GES-IIC-IOPC.                             
                                                                        
           IF (FIO-STAT-OKS AND                                         
              GES-KEY-IDGP IN GES-FLD NOT > SPACES)                     
               MOVE OPC-CIC-ICEN IN OPC TO GES-KEY-IDGP IN GES-FLD      
               GO TO FIN-VAL-GES-IIC-IOPC.                              
                                                                        
                                                                        
                                                                        
      *AFRI-FIN/MARZO2007 (MAE)                                         
      *>>>>

       FIN-VAL-GES-IIC-IOPC.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GES-FEC-FVCR SECTION.
       INI-VAL-GES-FEC-FVCR.
           IF GES-FEC-FVCR IN GES-FLD  NOT > ZEROES
              MOVE ZEROES TO GES-FEC-FVCR IN GES-FLD.
      *VAL-FEC Validar Fecha
           MOVE GES-FEC-FVCR IN GES-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GES_FEC_VTO_CDT
           IF GES-FEC-FVCR IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-FEC-FVCR IN GES-FLD
               GO TO FIN-VAL-GES-FEC-FVCR.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-FBLK-N TO FEC-FBLK.

           MOVE GES-NUM-SVCR IN GES-FLD TO FEC-SEC1.
           MOVE GES-NUM-AVCR IN GES-FLD TO FEC-AEC1.
           MOVE GES-NUM-MVCR IN GES-FLD TO FEC-MEC1.
           MOVE GES-NUM-DVCR IN GES-FLD TO FEC-DEC1.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GES-FEC-FVCR IN GES-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GES-FEC-FVCR.
       FIN-VAL-GES-FEC-FVCR.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GES-NUM-IDLC SECTION.
       INI-VAL-GES-NUM-IDLC.
      *<<<< GES_NUM_IDLC
           IF SCR-HDR-MRCA NOT = 'BCS' AND                              
              GES-NUM-IDLC IN GES-FLD NOT > ZEROES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GES-NUM-IDLC.                               
      *RRM-INI 16-APR-2002

           IF WSS-IND-VIGE = 'N' AND
              GES-NUM-IDLC IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-NUM-IDLC IN GES-FLD
               GO TO FIN-VAL-GES-NUM-IDLC.
      *RRM-FIN 16-APR-2002
      
           IF GES-NUM-IDLC IN GES-FLD NOT > ZEROES 
               MOVE ZEROES TO GES-NUM-IDLC IN GES-FLD.

      *<<<< FMT_CHI
           IF ( GES-IIC-IOPC IN GES-FLD     > ZEROES AND
                GES-NUM-IDLC IN GES-FLD NOT > ZEROES ) 
      *AFRI-INI /JUL2004
              AND (GES-COD-SIST IN GES-FLD = 'COL' OR                   
                   GES-COD-SIST IN GES-FLD = 'CRE')   
      *AFRI-FIN /JUL2004
      *>>>>
               MOVE 'BGL'          TO MSG-COD-SIST      
               MOVE 'GESIICCDTBLK' TO MSG-COD-MENS      
               PERFORM GET-MSG                          
               MOVE MSG-GLS-DESC TO FRM-MENS            
               MOVE FRM-SUAR-MAL TO FRM-SUAR            
               GO TO FIN-VAL-GES-NUM-IDLC.              

           IF GES-NUM-IDLC IN GES-FLD NOT > ZEROES
               GO TO FIN-VAL-GES-NUM-IDLC.

      *FLB CST  9-MAY-1994 DLC NO DEBE REPETIRSE
           PERFORM VAL-DLC-IGUA.
           IF MSG-COD-MENS > SPACES
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-IDLC.

           PERFORM BUS-COL.
           IF MSG-COD-MENS > SPACES
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-IDLC.

      *<<<< PGM_CHI
      *>>>>
      *>>>>
       FIN-VAL-GES-NUM-IDLC.
           EXIT.
       
       VAL-GES-IND-SCRE SECTION.
       INI-VAL-GES-IND-SCRE.
           IF GES-IND-SCRE IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-IND-SCRE IN GES-FLD.
      *<<<< GES_IND_SCRE
           MOVE 'BGL'                    TO TAB-COD-SIST.
           MOVE 'SIN'                    TO TAB-COD-TTAB IN TAB.
           MOVE GES-IND-SCRE IN GES-FLD  TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.
      *>>>>
       FIN-VAL-GES-IND-SCRE.
           EXIT.
       
       VAL-GES-COD-MVLC SECTION.
       INI-VAL-GES-COD-MVLC.
           IF GES-COD-MVLC IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-COD-MVLC IN GES-FLD.
      *<<<< GES_VCB_LIM_CDT

           IF ( GES-SGV-VLCR IN GES-FLD     > ZEROES AND
                GES-COD-MVLC IN GES-FLD NOT > SPACES ) OR
              ( GES-SGV-VLCR IN GES-FLD NOT > ZEROES AND
                GES-COD-MVLC IN GES-FLD     > SPACES )
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'GESVALVCBCDT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-COD-MVLC.

           IF GES-COD-MVLC IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-COD-MVLC IN GES-FLD
               MOVE SPACES TO FRM-GLS-MVLC IN GES-FLD
               GO TO FIN-VAL-GES-COD-MVLC.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-MVLC IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-COD-MVLC IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-MVLC IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-MVLC IN GES-FLD.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-MVLC IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-COD-MVLC IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-MVLC IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-MVLC IN GES-FLD.
       FIN-VAL-GES-COD-MVLC.
           EXIT.
       
       VAL-FRM-GLS-MVLC SECTION.
       INI-VAL-FRM-GLS-MVLC.
       FIN-VAL-FRM-GLS-MVLC.
           EXIT.
       
       VAL-GES-SGV-VLCR SECTION.
       INI-VAL-GES-SGV-VLCR.
      *<<<< GES_VAL_LIM_CDT
           IF NOT ( GES-SGV-VLCR IN GES-FLD > ZEROES OR
                    GES-SGV-PLCR IN GES-FLD > ZEROES )
               MOVE 100 TO GES-SGV-PLCR IN GES-FLD
           ELSE

           IF GES-COD-MVLC IN GES-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GES-SGV-VLCR IN GES-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GES-SGV-VLCR IN GES-FLD.
      *>>>>
       FIN-VAL-GES-SGV-VLCR.
           EXIT.
       
       VAL-GES-SGV-PLCR SECTION.
       INI-VAL-GES-SGV-PLCR.
      *<<<< GES_PCT_LIM_CDT
           IF GES-SGV-PLCR IN GES-FLD NOT > ZEROES AND
           GES-SGV-VLCR IN GES-FLD NOT > ZEROES
           PERFORM ERR-GLS
           GO TO FIN-VAL-GES-SGV-PLCR.

           IF GES-SGV-PLCR IN GES-FLD > 100
               MOVE 'BGL'       TO MSG-COD-SIST
               MOVE '%>100'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *>>>>
       FIN-VAL-GES-SGV-PLCR.
           EXIT.
       
       VAL-GES-COD-TVCC SECTION.
       INI-VAL-GES-COD-TVCC.
           IF GES-COD-TVCC IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-COD-TVCC IN GES-FLD.
      *<<<< GES_TIP_VCB_CDT

           IF GES-COD-TVCC IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-COD-TVCC IN GES-FLD
               MOVE SPACES TO FRM-GLS-TVCC IN GES-FLD
               GO TO FIN-VAL-GES-COD-TVCC.

      *VAL-MSC Valida indicador ( miscelaneo ) de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'TVAL' TO MSC-COD-TMSC IN MSC.
           MOVE GES-COD-TVCC IN GES-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              GES-COD-TVCC IN GES-FLD > SPACES
               MOVE MSC-GLS-DESC IN MSC TO 
                    FRM-GLS-TVCC IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TVCC IN GES-FLD.

      *>>>>
       FIN-VAL-GES-COD-TVCC.
           EXIT.
       
       VAL-FRM-GLS-TVCC SECTION.
       INI-VAL-FRM-GLS-TVCC.
       FIN-VAL-FRM-GLS-TVCC.
           EXIT.
       
       VAL-GES-COD-TOPE SECTION.
       INI-VAL-GES-COD-TOPE.
           IF GES-COD-TOPE IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-COD-TOPE IN GES-FLD.
      *<<<< GES_COD_TOPE
      *<<<< GES_TIP_OPE_CDT
           IF GES-COD-TOPE IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOPE IN GES-FLD
               GO TO FIN-VAL-GES-COD-TOPE.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-TOPE IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS > SPACES
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-GES-COD-TOPE
               ELSE
                   MOVE SPACES TO FRM-GLS-TOPE IN GES-FLD
                   GO TO FIN-VAL-GES-COD-TOPE
           ELSE
                MOVE TAB-GLS-DESC IN TAB TO
                     FRM-GLS-TOPE IN GES-FLD.

      *FLB CST  8-NOV-1993 
           MOVE TAB TO TIO.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-TOPE IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-COD-TOPE IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOPE IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOPE IN GES-FLD.
       FIN-VAL-GES-COD-TOPE.
           EXIT.
       
       VAL-FRM-GLS-TOPE SECTION.
       INI-VAL-FRM-GLS-TOPE.
       FIN-VAL-FRM-GLS-TOPE.
           EXIT.
       
       VAL-GES-COD-SOPE SECTION.
       INI-VAL-GES-COD-SOPE.
           IF GES-COD-SOPE IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-COD-SOPE IN GES-FLD.
      *<<<< GES_COD_SOPE
      *<<<< GES_STP_OPE_CDT
           IF GES-COD-SOPE IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SOPE IN GES-FLD
               GO TO FIN-VAL-GES-COD-SOPE.

      *FLB CST  8-NOV-1993 
           IF TIO-GLS-SIST IN TIO = 'COL'
      *VAL-COD Valida EN TABLA AUX DE SISTEMA COL
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-TOPE IN GES-FLD TO WSS-COD-TOPE
               MOVE GES-COD-SOPE IN GES-FLD TO WSS-COD-SOPE
               MOVE WSS-COD-AGTA TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = 'COD    NEX' OR
                  GES-COD-SOPE IN GES-FLD NOT > SPACES
                   MOVE SPACES TO FRM-GLS-SOPE IN GES-FLD
                   GO TO FIN-VAL-GES-COD-SOPE
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO
                        FRM-GLS-SOPE IN GES-FLD
                   GO TO FIN-VAL-GES-COD-SOPE.
      *FLB CST  8-NOV-1993 

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-TOPE IN GES-FLD TO WSS-COD-TOPE.
           MOVE GES-COD-SOPE IN GES-FLD TO WSS-COD-SOPE.
           MOVE WSS-COD-AGTA TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
               GES-COD-SOPE IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SOPE IN GES-FLD
            ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SOPE IN GES-FLD.
      *>>>>
       FIN-VAL-GES-COD-SOPE.
           EXIT.
       
       VAL-FRM-GLS-SOPE SECTION.
       INI-VAL-FRM-GLS-SOPE.
       FIN-VAL-FRM-GLS-SOPE.
           EXIT.
       
       VAL-GES-COD-VCMC SECTION.
       INI-VAL-GES-COD-VCMC.
           IF GES-COD-VCMC IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-COD-VCMC IN GES-FLD.
      *<<<< GES_VCB_CDT
           IF GES-COD-VCMC IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-COD-VCMC     IN GES-FLD 
               MOVE SPACES TO FRM-GLS-VCMC IN GES-FLD
               GO TO FIN-VAL-GES-COD-VCMC.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'        TO TAB-COD-SIST.
           MOVE 'VLR'        TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-VCMC IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-COD-VCMC IN GES-FLD NOT > ZEROES
               MOVE SPACES TO FRM-GLS-VCMC IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCMC IN GES-FLD.
      *>>>>
       FIN-VAL-GES-COD-VCMC.
           EXIT.
       
       VAL-FRM-GLS-VCMC SECTION.
       INI-VAL-FRM-GLS-VCMC.
       FIN-VAL-FRM-GLS-VCMC.
           EXIT.
       
       VAL-GES-COD-DCRE SECTION.
       INI-VAL-GES-COD-DCRE.
           IF GES-COD-DCRE IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-COD-DCRE IN GES-FLD.
      *<<<< GES_COD_DST_CDT
           IF GES-COD-DCRE IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-COD-DCRE IN GES-FLD
               MOVE SPACES TO FRM-GLS-DCRE IN GES-FLD
               GO TO FIN-VAL-GES-COD-DCRE.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'DES ' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-DCRE IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-COD-DCRE IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-DCRE IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-DCRE IN GES-FLD.
       FIN-VAL-GES-COD-DCRE.
           EXIT.
       
       VAL-FRM-GLS-DCRE SECTION.
       INI-VAL-FRM-GLS-DCRE.
       FIN-VAL-FRM-GLS-DCRE.
           EXIT.
       
       VAL-GES-IND-TDEU SECTION.
       INI-VAL-GES-IND-TDEU.
           IF GES-IND-TDEU IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-IND-TDEU IN GES-FLD.
      *<<<< GES_TIP_DEU
           IF GES-IND-TDEU IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-IND-TDEU IN GES-FLD
               GO TO FIN-VAL-GES-IND-TDEU.

           IF NOT ( GES-IND-TDEU IN GES-FLD = 'D' OR 'I' )
               MOVE 'BGL'         TO MSG-COD-SIST
               MOVE 'TDEU    D/I' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GES-IND-TDEU.
           EXIT.
       
       VAL-GES-KEY-IDGP SECTION.
       INI-VAL-GES-KEY-IDGP.
           IF GES-KEY-IDGP IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-KEY-IDGP IN GES-FLD.
      *<<<<
           IF SCR-HDR-MRCA = 'BCS' AND                                  
              GES-KEY-IDGP IN GES-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-GES-KEY-IDGP.                               
                                                                        
      *AFRI-INI/MARZO2007 (MAE)                                         
           IF SCR-HDR-MRCA NOT = 'BCS'                                  
              GO TO FIN-VAL-GES-KEY-IDGP.                               
                                                                        
      *    IF SCR-HDR-MRCA = 'BCS'                                      
           MOVE SPACES TO WSS-IND-IOPC.                                 
           MOVE 'BGL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'VALOPC'     TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              TAB-IND-VIGE IN TAB = 'S')                                
      *        MOVE 'BGL'         TO MSG-COD-SIST                       
      *        MOVE 'TABLA NOVIG' TO MSG-COD-MENS                       
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC TO FRM-MENS                            
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE 'N'          TO WSS-IND-IOPC                        
           ELSE                                                         
               MOVE 'S'           TO WSS-IND-IOPC.                      
                                                                        
           IF ((WSS-IND-IOPC = 'N' OR                                   
                WSS-IND-IOPC = SPACES ) AND                             
                GES-KEY-IDGP IN GES-FLD NOT > SPACES)                   
                 MOVE 'BGL'         TO MSG-COD-SIST                     
                 MOVE 'SN NUM NOV' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-GES-KEY-IDGP.                            
                                                                        
           IF ((WSS-IND-IOPC = 'N' OR                                   
                WSS-IND-IOPC = SPACES ) AND                             
                GES-KEY-IDGP IN GES-FLD > SPACES)                       
                 GO TO FIN-VAL-GES-KEY-IDGP.                            
                                                                        
           IF (WSS-IND-IOPC NOT = 'S')                                  
                 GO TO FIN-VAL-GES-KEY-IDGP.                            
                                                                        
      *    IF WSS-IND-IOPC = 'S'                                        
           MOVE GES-KEY-IDGP IN GES-FLD TO OPC-CIC-ICEN IN OPC.         
           MOVE 'OPC-CIC-ICEN' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO  FIO-CMND.                            
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'OPC NOVALI' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-GES-KEY-IDGP.                              
                                                                        
           IF (FIO-STAT-OKS AND                                         
              (GES-IIC-IOPC IN GES-FLD > ZEROES  OR                     
               GES-CAI-IOPC IN GES-FLD > SPACES) AND                    
              (GES-IIC-IOPC IN GES-FLD NOT = OPC-IIC-IOPC AND           
               GES-CAI-IOPC IN GES-FLD NOT = OPC-CAI-IOPC))             
                MOVE 'BGL'         TO MSG-COD-SIST                      
                MOVE 'OPC NO=GES' TO MSG-COD-MENS                       
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
                GO TO FIN-VAL-GES-KEY-IDGP.                             
                                                                        
           IF (FIO-STAT-OKS AND                                         
              (GES-IIC-IOPC IN GES-FLD > ZEROES  OR                     
               GES-CAI-IOPC IN GES-FLD > SPACES) AND                    
              (GES-IIC-IOPC IN GES-FLD = OPC-IIC-IOPC AND               
               GES-CAI-IOPC IN GES-FLD = OPC-CAI-IOPC))                 
                GO TO FIN-VAL-GES-KEY-IDGP.                             
                                                                        
           IF (FIO-STAT-OKS AND                                         
              GES-IIC-IOPC IN GES-FLD NOT > ZEROES  AND                 
              GES-CAI-IOPC IN GES-FLD NOT > SPACES)                     
               MOVE OPC-CAI-IOPC IN OPC TO GES-CAI-IOPC IN GES-FLD      
               MOVE OPC-IIC-IOPC IN OPC TO GES-IIC-IOPC IN GES-FLD      
               MOVE 1 TO GES-NUM-IDLC IN GES-FLD                        
               PERFORM VAL-GES-NUM-IDLC                                 
               GO TO FIN-VAL-GES-KEY-IDGP.                              
                                                                        
                                                                        
                                                                        
      *AFRI-FIN/MARZO2007 (MAE)                                         
                                                                        
      *>>>>
       FIN-VAL-GES-KEY-IDGP.
           EXIT.
       
       VAL-CON-FLD-GES SECTION.
       INI-VAL-CON-FLD-GES.
      *<<<< VAL_CON_FLD_GES
      *<<<< FMT_CHI
      *AFRI-INI/MARZO2007 (MAE)                                         
           IF SCR-HDR-MRCA NOT = 'BCS' AND                              
      *AFRI-FIN/MARZO2007 (MAE)                                         
              GES-IIC-IOPC IN GES-FLD = ZEROES AND
      *>>>>
              GES-COD-TVCC IN GES-FLD = SPACES AND
              GES-COD-VCMC IN GES-FLD = ZEROES AND
      *<<<< GEN_BCI
              GES-COD-TOPE IN GES-FLD = SPACES AND
              GES-COD-SOPE IN GES-FLD = SPACES AND
      *>>>>
              GES-COD-DCRE IN GES-FLD = SPACES AND
              GES-IND-TDEU IN GES-FLD = SPACES 
                 MOVE 'BGL' TO MSG-COD-SIST
                 MOVE 'GESVALFLDBLK' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-CON-FLD-GES.
      *AFRI-INI/MARZO2007 (MAE)                                         
           IF SCR-HDR-MRCA  = 'BCS' AND                                 
              GES-KEY-IDGP IN GES-FLD = ZEROES AND                      
              GES-COD-TVCC IN GES-FLD = SPACES AND                      
              GES-COD-VCMC IN GES-FLD = ZEROES AND                      
              GES-COD-TOPE IN GES-FLD = SPACES AND                      
              GES-COD-SOPE IN GES-FLD = SPACES AND                      
      *       GES-COD-DCRE IN GES-FLD = SPACES AND                      
              GES-IND-TDEU IN GES-FLD = SPACES                          
                 MOVE 'BGL' TO MSG-COD-SIST                             
                 MOVE 'GESVALFLDBLK' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-CON-FLD-GES.                             
      *AFRI-FIN/MARZO2007 (MAE)                                         
      *>>>>
       FIN-VAL-CON-FLD-GES.
           EXIT.
       
       VAL-CON-GES SECTION.
       INI-VAL-CON-GES.
       FIN-VAL-CON-GES.
           EXIT.
       
       VAL-NUM-KEY-GES SECTION.
       INI-VAL-NUM-KEY-GES.
           PERFORM VAL-NUM-IKY-GES.
           PERFORM VAL-NUM-MKY-GES.
           PERFORM VAL-NUM-AKY-GES.
       FIN-VAL-NUM-KEY-GES.
           EXIT.
       
       VAL-NUM-IKY-GES SECTION.
       INI-VAL-NUM-IKY-GES.
       VAL-NUM-GES-IIC-GTIA.
           MOVE GES-IIC-GTIA-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-IIC-GTIA IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-IIC-GTIA-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-IKY-GES.
       VAL-NUM-GES-NUM-IGES.
           MOVE GES-NUM-IGES-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-NUM-IGES IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-NUM-IGES-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-IKY-GES.
       FIN-VAL-NUM-IKY-GES.
           EXIT.
       
       VAL-NUM-MKY-GES SECTION.
       INI-VAL-NUM-MKY-GES.
       VAL-NUM-GES-IIC-IOPC.
           MOVE GES-IIC-IOPC-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-IIC-IOPC IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-IIC-IOPC-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-MKY-GES.
       VAL-NUM-GES-NUM-IDLC.
           MOVE GES-NUM-IDLC-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-NUM-IDLC IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-NUM-IDLC-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-MKY-GES.
       FIN-VAL-NUM-MKY-GES.
           EXIT.
       
       VAL-NUM-AKY-GES SECTION.
       INI-VAL-NUM-AKY-GES.
       FIN-VAL-NUM-AKY-GES.
           EXIT.
       
       VAL-NUM-FLD-GES SECTION.
       INI-VAL-NUM-FLD-GES.
       VAL-NUM-GES-COD-PACR.
           MOVE GES-COD-PACR-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-COD-PACR IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-COD-PACR-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-SGV-VLCR.
           MOVE GES-SGV-VLCR-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GES-SGV-VLCR IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-SGV-VLCR-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-SGV-PLCR.
           MOVE GES-SGV-PLCR-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GES-SGV-PLCR IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-SGV-PLCR-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       FIN-VAL-NUM-FLD-GES.
           EXIT.
       
       EDT-KEY-GES SECTION.
       INI-EDT-KEY-GES.
           PERFORM EDT-IKY-GES.
           PERFORM EDT-MKY-GES.
           PERFORM EDT-AKY-GES.
       FIN-EDT-KEY-GES.
           EXIT.
       
       EDT-IKY-GES SECTION.
       INI-EDT-IKY-GES.
           IF GES-IIC-GTIA-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-IIC-GTIA-LEN IN GES-FLD
                GO TO FIN-EDT-IKY-GES.
           MOVE GES-IIC-GTIA IN GES-FLD TO GES-IIC-GTIA-EDT IN GES-EDT.
           MOVE GES-IIC-GTIA-EDT IN GES-EDT TO 
                GES-IIC-GTIA-ALF IN GES-FLD.
           IF GES-NUM-IGES-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-NUM-IGES-LEN IN GES-FLD
                GO TO FIN-EDT-IKY-GES.
           MOVE GES-NUM-IGES IN GES-FLD TO GES-NUM-IGES-EDT IN GES-EDT.
           MOVE GES-NUM-IGES-EDT IN GES-EDT TO 
                GES-NUM-IGES-ALF IN GES-FLD.
       FIN-EDT-IKY-GES.
           EXIT.
       
       EDT-MKY-GES SECTION.
       INI-EDT-MKY-GES.
           IF GES-IIC-IOPC-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-IIC-IOPC-LEN IN GES-FLD
                GO TO FIN-EDT-MKY-GES.
           MOVE GES-IIC-IOPC IN GES-FLD TO GES-IIC-IOPC-EDT IN GES-EDT.
           MOVE GES-IIC-IOPC-EDT IN GES-EDT TO 
                GES-IIC-IOPC-ALF IN GES-FLD.
           IF GES-NUM-IDLC-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-NUM-IDLC-LEN IN GES-FLD
                GO TO FIN-EDT-MKY-GES.
           MOVE GES-NUM-IDLC IN GES-FLD TO GES-NUM-IDLC-EDT IN GES-EDT.
           MOVE GES-NUM-IDLC-EDT IN GES-EDT TO 
                GES-NUM-IDLC-ALF IN GES-FLD.
       FIN-EDT-MKY-GES.
           EXIT.
       
       EDT-AKY-GES SECTION.
       INI-EDT-AKY-GES.
       FIN-EDT-AKY-GES.
           EXIT.
       
       EDT-FLD-GES SECTION.
       INI-EDT-FLD-GES.
           IF GES-COD-PACR-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-COD-PACR-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-COD-PACR IN GES-FLD TO GES-COD-PACR-EDT IN GES-EDT.
           MOVE GES-COD-PACR-EDT IN GES-EDT TO 
                GES-COD-PACR-ALF IN GES-FLD.
           IF GES-SGV-VLCR-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-SGV-VLCR-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-SGV-VLCR IN GES-FLD TO GES-SGV-VLCR-EDT IN GES-EDT.
           MOVE GES-SGV-VLCR-EDT IN GES-EDT TO 
                GES-SGV-VLCR-ALF IN GES-FLD.
           IF GES-SGV-PLCR-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-SGV-PLCR-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-SGV-PLCR IN GES-FLD TO GES-SGV-PLCR-EDT IN GES-EDT.
           MOVE GES-SGV-PLCR-EDT IN GES-EDT TO 
                GES-SGV-PLCR-ALF IN GES-FLD.
       FIN-EDT-FLD-GES.
           EXIT.
      *<<<< EOF BM
       BUS-COL SECTION.
       INI-BUS-COL.
      * LEE DOCUMENTO LEGAL DE CREDITO EN COL

      *<<<< FMT_CHI
           MOVE GES-CAI-IOPC IN GES-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE GES-IIC-IOPC IN GES-FLD TO DLC-IIC-IOPC IN DLC.
      *>>>>
           MOVE GES-NUM-IDLC IN GES-FLD TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'DLC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

      ** EVA-INI 06/09
      *  VALIDACION PARA LOS SISTEMAS CRE CON SALDO MAYOR A 0
           IF GES-COD-SIST IN GES-FLD = 'CRE'
              MOVE GES-CAI-IOPC IN GES-FLD TO
                   WSS-CAI-IOPC IN WSS-VARI
              PERFORM LEE-TBL-CRE
              IF WSS-IND-ETBL IN WSS-VARI = 'S'
                  GO TO NXT-BUS-COL.

      ** EVA-FIN 06/09

           IF DLC-VAL-SDLC IN DLC NOT > ZEROES
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'DLC SDLC=0'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

      ** EVA-INI 06/09

       NXT-BUS-COL.

      ** EVA-FIN 06/09

           MOVE DLC-FEC-FMAV IN DLC TO GES-FEC-FVCR IN GES.
           MOVE GES-NUM-SVCR IN GES TO GES-NUM-SVCR IN GES-FLD.
           MOVE GES-NUM-AVCR IN GES TO GES-NUM-AVCR IN GES-FLD.
           MOVE GES-NUM-MVCR IN GES TO GES-NUM-MVCR IN GES-FLD.
           MOVE GES-NUM-DVCR IN GES TO GES-NUM-DVCR IN GES-FLD.
      *
      *<<<< FMT_CHI
           MOVE GES-CAI-IOPC IN GES-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE GES-IIC-IOPC IN GES-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'OPC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.
      *>>>>
      *<<<< GEN_BCI
      *JRF-INI 29-JUL-2003
           MOVE OPC-COD-TOOC IN OPC TO GES-COD-TOPE IN GES-FLD.
           MOVE OPC-COD-AOOC IN OPC TO GES-COD-SOPE IN GES-FLD.
      *JRF-FIN 29-JUL-2003
      *>>>>
           MOVE OPC-COD-VCOC IN OPC TO GES-COD-VCMC IN GES-FLD.
      *<<<< FMT_CHI
           MOVE OPC-MSC-TVOC IN OPC TO GES-COD-TVCC IN GES-FLD.
      *>>>>
      *    MOVE OPC-COD-CDOC IN OPC TO GES-COD-DCRE IN GES-FLD.
      *MHM-INI 27-DIC-2004                                              
      *    MOVE SPACES              TO GES-COD-DCRE IN GES-FLD.         
      *MHM-FIN 27-DIC-2004                                                     
           MOVE 'D'                 TO GES-IND-TDEU IN GES-FLD.
      *<<<< FMT_CHI
           MOVE DLC-NUM-SMAV IN DLC TO WSS-NUM-SAUX IN WSS-VARI.
           MOVE DLC-NUM-AMAV IN DLC TO WSS-NUM-AAUX IN WSS-VARI.
           MOVE DLC-NUM-MMAV IN DLC TO WSS-NUM-MAUX IN WSS-VARI.
           MOVE DLC-NUM-DMAV IN DLC TO WSS-NUM-DAUX IN WSS-VARI.
      *>>>>
           MOVE WSS-FEC-FAUX IN WSS-VARI TO GES-FEC-FVCR IN GES-FLD.
           
      *MPB-INI 01-FEB-2019 MODIFICACION PANTALLA GES
           IF OPC-VAL-SCRE IN OPC > ZEROES        
               MOVE WSS-S TO GES-IND-SCRE IN GES-FLD
           ELSE                              
               MOVE WSS-N TO GES-IND-SCRE IN GES-FLD.
      *MPB-FIN           
           GO TO FIN-BUS-COL.
       ERR-BUS-COL.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-BUS-COL.
           EXIT.
      *>>>>
      *<<<< EOF
       VAL-DLC-IGUA SECTION.
       INI-VAL-DLC-IGUA.
      * DLC no debe repetirse
           PERFORM KEY-GES-GES.
           MOVE ZEROES TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GES.
       LUP-VAL-DLC-IGUA.
           IF NOT ( FIO-STAT-OKS AND
              GES-CAI-GTIA IN GES = GES-CAI-GTIA IN GES-FLD AND
              GES-IIC-GTIA IN GES = GES-IIC-GTIA IN GES-FLD )
               GO TO BRW-VAL-DLC-IGUA.

           IF GES-NUM-IGES IN GES = GES-NUM-IGES IN GES-FLD
               GO TO NXT-VAL-DLC-IGUA.
      *<<<< FMT_CHI
           IF GES-IIC-IOPC IN GES = GES-IIC-IOPC IN GES-FLD AND
              GES-CAI-IOPC IN GES = GES-CAI-IOPC IN GES-FLD AND
      *>>>>
              GES-NUM-IDLC IN GES = GES-NUM-IDLC IN GES-FLD
               MOVE 'DLCREPETIDO' TO MSG-COD-MENS
               GO TO BRW-VAL-DLC-IGUA.

       NXT-VAL-DLC-IGUA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM BGL-FIO-GES.
           GO TO LUP-VAL-DLC-IGUA.
       BRW-VAL-DLC-IGUA.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM BGL-FIO-GES.
       FIN-VAL-DLC-IGUA.
           EXIT.
      *>>>>

      ** EVA-INI 06/09
      * BUSCA LINEA O SOBREGIRO DE TARJETA ASOCIADA A TABLA

       LEE-TBL-CRE SECTION.
       INI-LEE-TBL-CRE.

           MOVE 'N' TO WSS-IND-ETBL IN WSS-VARI.

           MOVE 'BGL'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'CRE'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-TOPC IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
               GO TO FIN-LEE-TBL-CRE.

           MOVE 'S' TO WSS-IND-ETBL IN WSS-VARI.

       FIN-LEE-TBL-CRE.
           EXIT.

      ** EVA-FIN 06/09
      *>>>>
