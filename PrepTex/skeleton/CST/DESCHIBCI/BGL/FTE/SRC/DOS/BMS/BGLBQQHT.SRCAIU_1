      *
      * BGLBQQHT
      * Version 3.0.1 Nov-2005
      * 16-Jan-19 02:14 PM
      *
       SET-TAG-BGLBQQHT SECTION.
       INI-SET-TAG-BGLBQQHT.
           MOVE
           '<IDNMOD NOM=$BGLBQQHT$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$16-Jan-19 02:14 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBQQHT.
           EXIT.
           
       PUT-ALL-QHT SECTION.
       INI-PUT-ALL-QHT.
           PERFORM PUT-GDG-QHT.
       FIN-PUT-ALL-QHT.
           EXIT.
       
       PUT-GDG-QHT SECTION.
       INI-PUT-GDG-QHT.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-QHT.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-QHT
               GO TO FIN-PUT-GDG-QHT.
           MOVE GDG-CAI-GTIA IN GDG TO GDG-CAI-GTIA IN QHT-FLD.
           MOVE GDG-IIC-GTIA IN GDG TO GDG-IIC-GTIA IN QHT-FLD.
      * IDG-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN QHT-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN QHT-FLD.
      * IDG-FIN --> BMCHIBCI001210.SRCAIU 
      * OFI-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-OFIC IN GDG TO GDG-COD-OFIC IN QHT-FLD.
      * OFI-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-VCAM IN GDG TO GDG-COD-VCAM IN QHT-FLD.
           MOVE GDG-GLS-DGTA IN GDG TO GDG-GLS-DGTA IN QHT-FLD.
           MOVE GDG-GLS-DGT1 IN GDG TO GDG-GLS-DGT1 IN QHT-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFIC IN QHT-FLD > SPACES
               MOVE GDG-COD-OFIC IN QHT-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN QHT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN QHT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-VCAM IN QHT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-VCAM IN QHT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN QHT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCAM IN QHT-FLD.
      *<<<< FIN_PUT_GDG_QHT
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
      *<<<< FMT_CHI
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.

           MOVE GDG-TIP-CGTA IN QHT-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN QHT-FLD TO TAG-STP-AGTA IN TAG.
      *>>>>
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN QHT-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN QHT-FLD.
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.
           MOVE SPACES                  TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN QHT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN QHT-FLD.
      *MHM-FIN 23-OCT-2003

      *------------------------------------------------*
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'BGL' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
             MOVE SPACES TO MSG-COD-MENS
             MOVE 'BGL'  TO TAB-COD-SIST
             MOVE 'RAL'  TO TAB-COD-TTAB IN TAB

             MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB
             PERFORM BUS-TAB
             IF MSG-COD-MENS = SPACES
                MOVE TAB-GLS-DESC IN TAB TO 
                     FRM-GLS-TREA IN QHT-FLD
             ELSE
                MOVE SPACES TO FRM-GLS-TREA IN QHT-FLD.

      *----------------------------------------------*
      * Se determina si la tasacion esta vencida o no
           IF 'TAG    NEX' = MSG-COD-MENS
               MOVE ZEROES TO TAG-NUM-PVTS IN TAG.


           MOVE WSS-NO-EXA-VENC TO WSS-IND-EXAV.
      *
      * Excluye los Subtipos de Garantia que no requieren Tasacion Efectiva
           IF TAG-NUM-PVTS IN TAG NOT > ZEROES
               GO TO EXA-VEN-SEG.

      * Excluye los Creditos Hipotecarios
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.
           MOVE ZEROES              TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GES.
           IF NOT FIO-STAT-OKS OR
              GDG-CAI-GTIA IN GDG NOT = GES-CAI-GTIA IN GES OR
              GDG-IIC-GTIA IN GDG NOT = GES-IIC-GTIA IN GES
               MOVE SPACES TO GES
               MOVE ZEROES TO GES-IIC-GTIA IN GES
                              GES-FEC-FVCR IN GES
                              GES-NUM-IGES IN GES
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM BGL-FIO-GES
               ELSE
                   NEXT SENTENCE
           ELSE 
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM BGL-FIO-GES
               IF GES-COD-SIST IN GES > SPACES
                   MOVE 'TAB'                  TO TAB-COD-SIST
                   MOVE 'SIS'                  TO TAB-COD-TTAB IN TAB
                   MOVE GES-COD-SIST IN GES    TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS = SPACES AND
                      TAB-CIC-CTAB = 'HIP'
                      GO TO EXA-VEN-SEG.

           MOVE WSS-SI-EXA-VENC TO WSS-IND-EXAV.
           PERFORM GET-FHOY.
           IF TAG-COD-TPVT IN TAG = 'D'
              MOVE FEC-SUM-DIA TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NDIA
           ELSE
           IF TAG-COD-TPVT IN TAG = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NMES
           ELSE
           IF TAG-COD-TPVT IN TAG = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NANO.

           MOVE GDG-IIC-GTIA IN QHT-FLD TO GVT-IIC-GTIA IN GVT.
           MOVE GDG-CAI-GTIA IN QHT-FLD TO GVT-CAI-GTIA IN GVT.
           MOVE GDG-COD-TSCN IN GDG     TO GVT-COD-TASN IN GVT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GVT.

      * Busca ultima tasacion
           MOVE GVT-FEC-FTSN IN GVT TO FEC-FVLD.
           MOVE FEC-DVLD TO FEC-ITM1.
           MOVE FEC-MVLD TO FEC-ITM2.
           MOVE FEC-AVLD TO FEC-ITM4.
           MOVE FEC-SVLD TO FEC-ITM3.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF MSG-COD-MENS = SPACES
               MOVE FEC-ITM1 TO WSS-FEC-DVTA IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-FEC-MVTA IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-FEC-AVTA IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-FEC-SVTA IN WSS-VARI
           ELSE
               GO TO EXA-VEN-SEG.

      * Tasacion Vencida
           IF WSS-FEC-FVTA IN WSS-VARI > HOY-FHOY
               GO TO EXA-VEN-SEG.

           MOVE 'BGL' TO MSG-COD-SIST.
           MOVE 'FECTSN<HOY' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.

       EXA-VEN-SEG.
           MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE.
           MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GSE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-EXA-VEN-SEG.

      * Se determina si el seguro esta vencido o no


      * Excluye los Creditos Hipotecarios
           IF WSS-IND-EXAV = WSS-NO-EXA-VENC 
               GO TO FIN-EXA-VEN-SEG.

      * Seguro Vigente
           IF GSE-FEC-FVTS IN GSE > HOY-FHOY
               GO TO FIN-EXA-VEN-SEG.

           MOVE 'SEGURO VENCIDO' TO FRM-MEN2.

       FIN-EXA-VEN-SEG.

      *>>>>
       FIN-PUT-GDG-QHT.
           EXIT.
       
       KEY-ALL-QHT SECTION.
       INI-KEY-ALL-QHT.
           PERFORM KEY-GDG-QHT.
       FIN-KEY-ALL-QHT.
           EXIT.
       
       KEY-GDG-QHT SECTION.
       INI-KEY-GDG-QHT.
           MOVE GDG-CAI-GTIA IN QHT-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GDG-IIC-GTIA IN QHT-FLD TO GDG-IIC-GTIA IN GDG.
       FIN-KEY-GDG-QHT.
           EXIT.
       
       SCR-CLRA-QHT SECTION.
       INI-SCR-CLRA-QHT.
           PERFORM CLR-KEY-QHT.
           PERFORM CLR-FLD-QHT.
       FIN-SCR-CLRA-QHT.
           EXIT.
       
       CLR-KEY-QHT SECTION.
       INI-CLR-KEY-QHT.
           MOVE SPACES TO GDG-CAI-GTIA IN QHT-FLD.
           MOVE ZEROES TO GDG-IIC-GTIA IN QHT-FLD.
       FIN-CLR-KEY-QHT.
           EXIT.
       
       CLR-FLD-QHT SECTION.
       INI-CLR-FLD-QHT.
           MOVE SPACES TO FRM-GLS-TREA IN QHT-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN QHT-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN QHT-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN QHT-FLD.
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(1).
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(2).
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(3).
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(4).
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(5).
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(6).
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(7).
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(8).
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(9).
           MOVE SPACES TO FRM-COD-TASN IN QHT-FLD(10).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(1).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(2).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(3).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(4).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(5).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(6).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(7).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(8).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(9).
           MOVE SPACES TO FRM-IND-GTP IN QHT-FLD(10).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(1).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(2).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(3).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(4).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(5).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(6).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(7).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(8).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(9).
           MOVE ZEROES TO FRM-SGV-VCTS IN QHT-FLD(10).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(1).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(2).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(3).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(4).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(5).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(6).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(7).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(8).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(9).
           MOVE ZEROES TO FRM-SGV-VPND IN QHT-FLD(10).
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(1).
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(2).
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(3).
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(4).
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(5).
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(6).
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(7).
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(8).
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(9).
           MOVE ZEROES TO FRM-FEC-FTSN IN QHT-FLD(10).
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(1).
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(2).
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(3).
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(4).
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(5).
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(6).
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(7).
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(8).
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(9).
           MOVE SPACES TO FRM-GLS-ITSD IN QHT-FLD(10).
           PERFORM CLR-GDG-QHT.
       FIN-CLR-FLD-QHT.
           EXIT.
       
       CLR-GDG-QHT SECTION.
       INI-CLR-GDG-QHT.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN QHT-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN QHT-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN QHT-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN QHT-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN QHT-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN QHT-FLD.
       FIN-CLR-GDG-QHT.
           EXIT.
       
       FST-KEY-QHT SECTION.
       INI-FST-KEY-QHT.
           MOVE -1 TO GDG-CAI-GTIA-LEN IN QHT-FLD.
       FIN-FST-KEY-QHT.
           EXIT.
       
       FST-FLD-QHT SECTION.
       INI-FST-FLD-QHT.
       FIN-FST-FLD-QHT.
           EXIT.
       
       PRO-KEY-QHT SECTION.
       INI-PRO-KEY-QHT.
           PERFORM PRO-IKY-QHT.
           PERFORM PRO-AKY-QHT.
           PERFORM PRO-MKY-QHT.
       FIN-PRO-KEY-QHT.
           EXIT.
       
       PRO-IKY-QHT SECTION.
       INI-PRO-IKY-QHT.
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN QHT-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-ATR IN QHT-FLD.
       FIN-PRO-IKY-QHT.
           EXIT.
       
       PRO-MKY-QHT SECTION.
       INI-PRO-MKY-QHT.
       FIN-PRO-MKY-QHT.
           EXIT.
       
       PRO-AKY-QHT SECTION.
       INI-PRO-AKY-QHT.
       FIN-PRO-AKY-QHT.
           EXIT.
       
       UNP-KEY-QHT SECTION.
       INI-UNP-KEY-QHT.
           PERFORM UNP-IKY-QHT.
           PERFORM UNP-AKY-QHT.
           PERFORM UNP-MKY-QHT.
       FIN-UNP-KEY-QHT.
           EXIT.
       
       UNP-IKY-QHT SECTION.
       INI-UNP-IKY-QHT.
           MOVE FRM-CPIM-UBY TO GDG-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GDG-IIC-GTIA-ATR.
       FIN-UNP-IKY-QHT.
           EXIT.
       
       UNP-MKY-QHT SECTION.
       INI-UNP-MKY-QHT.
       FIN-UNP-MKY-QHT.
           EXIT.
       
       UNP-AKY-QHT SECTION.
       INI-UNP-AKY-QHT.
       FIN-UNP-AKY-QHT.
           EXIT.
       
       UNP-FLD-QHT SECTION.
       INI-UNP-FLD-QHT.
           PERFORM UNP-GDG-QHT.
       FIN-UNP-FLD-QHT.
           EXIT.
       
       UNP-GDG-QHT SECTION.
       INI-UNP-GDG-QHT.
       FIN-UNP-GDG-QHT.
           EXIT.
       
       VAL-KEY-QHT SECTION.
       INI-VAL-KEY-QHT.
           PERFORM VAL-IKY-QHT.
           PERFORM VAL-MKY-QHT.
           PERFORM VAL-AKY-QHT.
       FIN-VAL-KEY-QHT.
           EXIT.
       
       VAL-IKY-QHT SECTION.
       INI-VAL-IKY-QHT.
           PERFORM VAL-GDG-CAI-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-CAI-GTIA-LEN IN QHT-FLD
                GO TO FIN-VAL-IKY-QHT.
           PERFORM VAL-GDG-IIC-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IIC-GTIA-LEN IN QHT-FLD
                GO TO FIN-VAL-IKY-QHT.
       FIN-VAL-IKY-QHT.
           EXIT.
       
       VAL-MKY-QHT SECTION.
       INI-VAL-MKY-QHT.
       FIN-VAL-MKY-QHT.
           EXIT.
       
       VAL-AKY-QHT SECTION.
       INI-VAL-AKY-QHT.
       FIN-VAL-AKY-QHT.
           EXIT.
       
       VAL-GDG-CAI-GTIA SECTION.
       INI-VAL-GDG-CAI-GTIA.
           IF GDG-CAI-GTIA IN QHT-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-CAI-GTIA.
       FIN-VAL-GDG-CAI-GTIA.
           EXIT.
       
       VAL-GDG-IIC-GTIA SECTION.
       INI-VAL-GDG-IIC-GTIA.
           IF GDG-IIC-GTIA IN QHT-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-IIC-GTIA.
       FIN-VAL-GDG-IIC-GTIA.
           EXIT.
       
       VAL-CON-KEY-QHT SECTION.
       INI-VAL-CON-KEY-QHT.
      *<<<< INI_VAL_CON_KEY_QHT
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-QHT.
      *>>>>
           IF     GDG-CAI-GTIA IN QHT-FLD NOT > SPACES 
              AND GDG-IIC-GTIA IN QHT-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-QHT.
       FIN-VAL-CON-KEY-QHT.
           EXIT.
       
       VAL-CON-IKY-QHT SECTION.
       INI-VAL-CON-IKY-QHT.
           IF     GDG-CAI-GTIA IN QHT-FLD NOT > SPACES 
              AND GDG-IIC-GTIA IN QHT-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-QHT.
       FIN-VAL-CON-IKY-QHT.
           EXIT.
       
       VAL-NUM-KEY-QHT SECTION.
       INI-VAL-NUM-KEY-QHT.
           PERFORM VAL-NUM-IKY-QHT.
           PERFORM VAL-NUM-MKY-QHT.
           PERFORM VAL-NUM-AKY-QHT.
       FIN-VAL-NUM-KEY-QHT.
           EXIT.
       
       VAL-NUM-IKY-QHT SECTION.
       INI-VAL-NUM-IKY-QHT.
       VAL-NUM-GDG-IIC-GTIA.
           MOVE GDG-IIC-GTIA-ALF IN QHT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GDG-IIC-GTIA IN QHT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GDG-IIC-GTIA-LEN IN QHT-FLD
                GO TO FIN-VAL-NUM-IKY-QHT.
       FIN-VAL-NUM-IKY-QHT.
           EXIT.
       
       VAL-NUM-MKY-QHT SECTION.
       INI-VAL-NUM-MKY-QHT.
       FIN-VAL-NUM-MKY-QHT.
           EXIT.
       
       VAL-NUM-AKY-QHT SECTION.
       INI-VAL-NUM-AKY-QHT.
       FIN-VAL-NUM-AKY-QHT.
           EXIT.
       
       VAL-NUM-FLD-QHT SECTION.
       INI-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-1.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(1)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(1)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-2.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(2)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(2)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-3.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(3)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(3)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-4.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(4)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(4)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-5.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(5)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(5)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-6.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(6)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(6)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-7.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(7) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(7)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(7)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-8.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(8) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(8)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(8)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-9.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(9) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(9)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(9)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VCTS-10.
           MOVE FRM-SGV-VCTS-ALF IN QHT-FLD(10) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VCTS IN QHT-FLD(10)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VCTS-LEN IN QHT-FLD(10)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-1.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(1)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(1)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-2.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(2)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(2)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-3.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(3)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(3)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-4.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(4)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(4)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-5.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(5)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(5)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-6.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(6)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(6)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-7.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(7) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(7)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(7)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-8.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(8) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(8)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(8)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-9.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(9) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(9)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(9)
                GO TO FIN-VAL-NUM-FLD-QHT.
       VAL-NUM-FRM-SGV-VPND-10.
           MOVE FRM-SGV-VPND-ALF IN QHT-FLD(10) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-VPND IN QHT-FLD(10)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-VPND-LEN IN QHT-FLD(10)
                GO TO FIN-VAL-NUM-FLD-QHT.
       FIN-VAL-NUM-FLD-QHT.
           EXIT.
       
       EDT-KEY-QHT SECTION.
       INI-EDT-KEY-QHT.
           PERFORM EDT-IKY-QHT.
           PERFORM EDT-MKY-QHT.
           PERFORM EDT-AKY-QHT.
       FIN-EDT-KEY-QHT.
           EXIT.
       
       EDT-IKY-QHT SECTION.
       INI-EDT-IKY-QHT.
           IF GDG-IIC-GTIA-LEN IN QHT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDG-IIC-GTIA-LEN IN QHT-FLD
                GO TO FIN-EDT-IKY-QHT.
           MOVE GDG-IIC-GTIA IN QHT-FLD TO GDG-IIC-GTIA-EDT IN QHT-EDT.
           MOVE GDG-IIC-GTIA-EDT IN QHT-EDT TO 
                GDG-IIC-GTIA-ALF IN QHT-FLD.
       FIN-EDT-IKY-QHT.
           EXIT.
       
       EDT-MKY-QHT SECTION.
       INI-EDT-MKY-QHT.
       FIN-EDT-MKY-QHT.
           EXIT.
       
       EDT-AKY-QHT SECTION.
       INI-EDT-AKY-QHT.
       FIN-EDT-AKY-QHT.
           EXIT.
       
       EDT-FLD-QHT SECTION.
       INI-EDT-FLD-QHT.
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(1)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(1) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(1).
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(2)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(2) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(2).
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(3)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(3) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(3).
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(4)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(4) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(4).
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(5)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(5) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(5).
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(6)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(6) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(6).
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(7) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(7)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(7) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(7).
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(8) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(8)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(8) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(8).
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(9) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(9)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(9) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(9).
           IF FRM-SGV-VCTS-LEN IN QHT-FLD(10) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VCTS-LEN IN QHT-FLD(10)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VCTS IN QHT-FLD(10) TO 
                FRM-SGV-VCTS-EDT IN QHT-EDT.
           MOVE FRM-SGV-VCTS-EDT IN QHT-EDT TO 
                FRM-SGV-VCTS-ALF IN QHT-FLD(10).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(1)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(1) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(1).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(2)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(2) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(2).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(3)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(3) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(3).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(4)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(4) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(4).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(5)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(5) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(5).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(6)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(6) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(6).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(7) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(7)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(7) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(7).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(8) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(8)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(8) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(8).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(9) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(9)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(9) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(9).
           IF FRM-SGV-VPND-LEN IN QHT-FLD(10) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-VPND-LEN IN QHT-FLD(10)
                GO TO FIN-EDT-FLD-QHT.
           MOVE FRM-SGV-VPND IN QHT-FLD(10) TO 
                FRM-SGV-VPND-EDT IN QHT-EDT.
           MOVE FRM-SGV-VPND-EDT IN QHT-EDT TO 
                FRM-SGV-VPND-ALF IN QHT-FLD(10).
       FIN-EDT-FLD-QHT.
           EXIT.
