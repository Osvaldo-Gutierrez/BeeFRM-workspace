      *
      * BGLBQGES
      * Version 3.0.1 Nov-2005
      * 06-Mar-19 12:55 PM
      *
      *-----------------------------------------------------------------
      *  Autor     : BEE-MPB
      *  Fecha     : 01-02-2019
      *  NUB       : 54088
      *  Proyecto  : MODIFICACION PANTALLA GES
      *  ID        : MPB-INI 01-FEB-2019 MODIFICACION PANTALLA GES
      *  Cambios   : QUE INFORMACION DEL CREDITO NO SE GRABE EN GES
      *              QUE TODA LA INFORMACION EN PANTALLA DEL CREDITO 
      *              SEA EN LINEA DESDE OPC/DLC
      *---------------------------------------------------------------- 
       SET-TAG-BGLBQGES SECTION.
       INI-SET-TAG-BGLBQGES.
           MOVE
           '<IDNMOD NOM=$BGLBQGES$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$06-Mar-19 12:55 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBQGES.
           EXIT.
           
       PUT-ALL-GES SECTION.
       INI-PUT-ALL-GES.
           PERFORM PUT-GES-GES.
           PERFORM PUT-GDG-GES.
       FIN-PUT-ALL-GES.
           EXIT.
       
       PUT-GES-GES SECTION.
       INI-PUT-GES-GES.
           IF PGM-STAT-GES-NUL
               GO TO FIN-PUT-GES-GES.
           IF NOT PGM-STAT-GES-OKS
               PERFORM CLR-GES-GES
               GO TO FIN-PUT-GES-GES.
           MOVE GES-CAI-GTIA IN GES TO GES-CAI-GTIA IN GES-FLD.
           MOVE GES-IIC-GTIA IN GES TO GES-IIC-GTIA IN GES-FLD.
           MOVE GES-NUM-IGES IN GES TO GES-NUM-IGES IN GES-FLD.
           MOVE GES-COD-PACR IN GES TO GES-COD-PACR IN GES-FLD.
           MOVE GES-COD-SIST IN GES TO GES-COD-SIST IN GES-FLD.
           MOVE GES-CAI-IOPC IN GES TO GES-CAI-IOPC IN GES-FLD.
           MOVE GES-IIC-IOPC IN GES TO GES-IIC-IOPC IN GES-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GES-NUM-DVCR IN GES TO GES-NUM-DVCR IN GES-FLD.
           MOVE GES-NUM-MVCR IN GES TO GES-NUM-MVCR IN GES-FLD.
           MOVE GES-NUM-SVCR IN GES TO GES-NUM-SVCR IN GES-FLD.
           MOVE GES-NUM-AVCR IN GES TO GES-NUM-AVCR IN GES-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GES-NUM-IDLC IN GES TO GES-NUM-IDLC IN GES-FLD.
           MOVE GES-IND-SCRE IN GES TO GES-IND-SCRE IN GES-FLD.
           MOVE GES-COD-MVLC IN GES TO GES-COD-MVLC IN GES-FLD.
           MOVE GES-SGV-VLCR IN GES TO GES-SGV-VLCR IN GES-FLD.
           MOVE GES-SGV-PLCR IN GES TO GES-SGV-PLCR IN GES-FLD.
           MOVE GES-COD-TVCC IN GES TO GES-COD-TVCC IN GES-FLD.
           MOVE GES-COD-TOPE IN GES TO GES-COD-TOPE IN GES-FLD.
           MOVE GES-COD-SOPE IN GES TO GES-COD-SOPE IN GES-FLD.
           MOVE GES-COD-VCMC IN GES TO GES-COD-VCMC IN GES-FLD.
           MOVE GES-COD-DCRE IN GES TO GES-COD-DCRE IN GES-FLD.
           MOVE GES-IND-TDEU IN GES TO GES-IND-TDEU IN GES-FLD.
           MOVE GES-KEY-IDGP IN GES TO GES-KEY-IDGP IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-SIST IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'SIS ' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-SIST IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SIST IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-SIST IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-MVLC IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-MVLC IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-MVLC IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-MVLC IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-TOPE IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-TOPE IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOPE IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOPE IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-DCRE IN GES-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'DES ' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-DCRE IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-DCRE IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-DCRE IN GES-FLD.
      *<<<< FIN_PUT_GES_GES
      *BUS-COL busca datos Documento Legal Credito en Colocaciones
      *<<<< FMT_CHI
           IF GES-IIC-IOPC IN GES-FLD > ZEROES AND                  
      *>>>>
              GES-NUM-IDLC IN GES-FLD > ZEROES AND                  
              GES-COD-SIST IN GES-FLD > SPACES                      
                 MOVE 'TAB'                   TO FIO-SIST           
                 MOVE 'TAB'                   TO TAB-COD-SIST
                 MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB
                 MOVE GES-COD-SIST IN GES-FLD TO TAB-COD-CTAB IN TAB
                 MOVE FIO-GET-KEY             TO FIO-CMND           
                 PERFORM GNS-FIO-TAB                                
                 IF FIO-STAT-OKS                                    
                    PERFORM BUS-COL                                 
                    IF MSG-COD-MENS > SPACES                        
                       GO TO FIN-PUT-GES-GES.                       

      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-MVLC IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-MVLC IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-MVLC IN GES-FLD.

      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE GES-COD-VCMC IN GES-FLD TO GES-COD-VCMC IN GES.
           IF GES-COD-TVCC IN GES-FLD > SPACES AND
      *<<<< FMT_CHI
                GES-IIC-IOPC IN GES-FLD > ZEROES
      *>>>>

               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE GES-COD-TVCC IN GES-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TVCC IN GES-FLD
           ELSE
               MOVE SPACES TO GES-COD-TVCC IN GES-FLD
                                FRM-GLS-TVCC IN GES-FLD.
      *<<<< GEN_BCI
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-TOPE IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-TOPE IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB TO TIO
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOPE IN GES-FLD.

      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-SOPE IN GES-FLD NOT > SPACES
               GO TO FIN-BUS-AUX.

           IF TIO-GLS-SIST IN TIO = 'COL'
      *VAL-COD Valida EN TABLA AUX DE SISTEMA COL
               MOVE 'COL' TO TAB-COD-SIST
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST.

           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-TOPE IN GES-FLD TO WSS-COD-TOPE.
           MOVE GES-COD-SOPE IN GES-FLD TO WSS-COD-SOPE.
           MOVE WSS-COD-AGTA TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO
                FRM-GLS-SOPE IN GES-FLD.

      *>>>>
       FIN-BUS-AUX.

      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-VCMC IN GES-FLD > ZEROES AND
              GES-COD-CVCC IN GES > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-VCMC IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCMC IN GES-FLD.
      *>>>>
       FIN-PUT-GES-GES.
           EXIT.
       
       PUT-GDG-GES SECTION.
       INI-PUT-GDG-GES.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GES.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GES
               GO TO FIN-PUT-GDG-GES.
      * IDG-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GES-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GES-FLD.
      * IDG-FIN --> BMCHIBCI001210.SRCAIU 
      * OFI-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-OFIC IN GDG TO GDG-COD-OFIC IN GES-FLD.
      * OFI-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GDG-COD-VCAM IN GDG TO GDG-COD-VCAM IN GES-FLD.
           MOVE GDG-GLS-DGTA IN GDG TO GDG-GLS-DGTA IN GES-FLD.
           MOVE GDG-GLS-DGT1 IN GDG TO GDG-GLS-DGT1 IN GES-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFIC IN GES-FLD > SPACES
               MOVE GDG-COD-OFIC IN GES-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-VCAM IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-VCAM IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCAM IN GES-FLD.
      *<<<< FIN_PUT_GDG_GES
      *<<<< GEN_BCI
           IF GDG-TIP-CGTA IN GES-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'AUX'                   TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-CGTA IN GES-FLD TO WSS-COD-TOPE IN WSS-VARI
               MOVE GDG-STP-CGTA IN GES-FLD TO WSS-COD-SOPE IN WSS-VARI
               MOVE WSS-COD-AGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-CGTA IN GES-FLD.
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GES-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GES-FLD.
      *MHM-FIN 23-OCT-2003
      *>>>>
      *>>>>
       FIN-PUT-GDG-GES.
           EXIT.
       
       KEY-ALL-GES SECTION.
       INI-KEY-ALL-GES.
           PERFORM KEY-GES-GES.
           PERFORM KEY-GDG-GES.
       FIN-KEY-ALL-GES.
           EXIT.
       
       KEY-GES-GES SECTION.
       INI-KEY-GES-GES.
           MOVE GES-CAI-GTIA IN GES-FLD TO GES-CAI-GTIA IN GES.
           MOVE GES-IIC-GTIA IN GES-FLD TO GES-IIC-GTIA IN GES.
           MOVE GES-NUM-IGES IN GES-FLD TO GES-NUM-IGES IN GES.
           MOVE GES-CAI-IOPC IN GES-FLD TO GES-CAI-IOPC IN GES.
           MOVE GES-IIC-IOPC IN GES-FLD TO GES-IIC-IOPC IN GES.
           MOVE GES-NUM-IDLC IN GES-FLD TO GES-NUM-IDLC IN GES.
       FIN-KEY-GES-GES.
           EXIT.
       
       KEY-GDG-GES SECTION.
       INI-KEY-GDG-GES.
       FIN-KEY-GDG-GES.
           EXIT.
       
       SCR-CLRA-GES SECTION.
       INI-SCR-CLRA-GES.
           PERFORM CLR-KEY-GES.
           PERFORM CLR-FLD-GES.
       FIN-SCR-CLRA-GES.
           EXIT.
       
       CLR-KEY-GES SECTION.
       INI-CLR-KEY-GES.
           MOVE SPACES TO GES-CAI-GTIA IN GES-FLD.
           MOVE ZEROES TO GES-IIC-GTIA IN GES-FLD.
           MOVE ZEROES TO GES-NUM-IGES IN GES-FLD.
           MOVE SPACES TO GES-CAI-IOPC IN GES-FLD.
           MOVE ZEROES TO GES-IIC-IOPC IN GES-FLD.
           MOVE ZEROES TO GES-NUM-IDLC IN GES-FLD.
       FIN-CLR-KEY-GES.
           EXIT.
       
       CLR-FLD-GES SECTION.
       INI-CLR-FLD-GES.
           MOVE SPACES TO FRM-GLS-TREA IN GES-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN GES-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GES-FLD.
           MOVE SPACES TO FRM-GLS-SIST IN GES-FLD.
           MOVE SPACES TO FRM-GLS-MVLC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TVCC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TOPE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-SOPE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCMC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-DCRE IN GES-FLD.
           PERFORM CLR-GES-GES.
           PERFORM CLR-GDG-GES.
       FIN-CLR-FLD-GES.
           EXIT.
       
       CLR-GES-GES SECTION.
       INI-CLR-GES-GES.
           MOVE ZEROES TO GES-COD-PACR IN GES-FLD.
           MOVE SPACES TO GES-COD-SIST IN GES-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GES-FEC-FVCR IN GES-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GES-IND-SCRE IN GES-FLD.
           MOVE SPACES TO GES-COD-MVLC IN GES-FLD.
           MOVE ZEROES TO GES-SGV-VLCR IN GES-FLD.
           MOVE ZEROES TO GES-SGV-PLCR IN GES-FLD.
           MOVE SPACES TO GES-COD-TVCC IN GES-FLD.
           MOVE SPACES TO GES-COD-TOPE IN GES-FLD.
           MOVE SPACES TO GES-COD-SOPE IN GES-FLD.
           MOVE SPACES TO GES-COD-VCMC IN GES-FLD.
           MOVE SPACES TO GES-COD-DCRE IN GES-FLD.
           MOVE SPACES TO GES-IND-TDEU IN GES-FLD.
           MOVE SPACES TO GES-KEY-IDGP IN GES-FLD.
       FIN-CLR-GES-GES.
           EXIT.
       
       CLR-GDG-GES SECTION.
       INI-CLR-GDG-GES.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GES-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GES-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GES-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GES-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GES-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GES-FLD.
       FIN-CLR-GDG-GES.
           EXIT.
       
       FST-KEY-GES SECTION.
       INI-FST-KEY-GES.
           MOVE -1 TO GES-CAI-GTIA-LEN IN GES-FLD.
       FIN-FST-KEY-GES.
           EXIT.
       
       FST-FLD-GES SECTION.
       INI-FST-FLD-GES.
           MOVE -1 TO GES-COD-PACR-LEN IN GES-FLD.
      *<<<< FIN_FST_FLD_GES
      *<<<< FMT_CHI
           IF GES-IIC-IOPC IN GES-FLD > ZEROES
      *>>>>
               MOVE FRM-CPIM-AEY TO GES-FEC-FVCR-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-FEC-FVCR-STP

               MOVE FRM-CPIM-AEY TO GES-COD-TVCC-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-TVCC-STP

      *<<<< GEN_BCI
      *JRF-INI 29-JUL-2003
               MOVE FRM-CPIM-AEY TO GES-COD-TOPE-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-TOPE-STP
               MOVE FRM-CPIM-AEY TO GES-COD-SOPE-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-SOPE-STP
      *JRF-FIN 29-JUL-2003
      *>>>>
               MOVE FRM-CPIM-AEY TO GES-COD-VCMC-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-VCMC-STP

               MOVE FRM-CPIM-AEY TO GES-COD-DCRE-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-DCRE-STP

               MOVE FRM-CPIM-AEY TO GES-IND-TDEU-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-IND-TDEU-STP.
      *>>>>
       FIN-FST-FLD-GES.
           EXIT.
       
       PRO-KEY-GES SECTION.
       INI-PRO-KEY-GES.
           PERFORM PRO-IKY-GES.
           PERFORM PRO-AKY-GES.
           PERFORM PRO-MKY-GES.
       FIN-PRO-KEY-GES.
           EXIT.
       
       PRO-IKY-GES SECTION.
       INI-PRO-IKY-GES.
           MOVE FRM-CPIM-AEY TO GES-CAI-GTIA-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-IIC-GTIA-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-NUM-IGES-ATR IN GES-FLD.
       FIN-PRO-IKY-GES.
           EXIT.
       
       PRO-MKY-GES SECTION.
       INI-PRO-MKY-GES.
           MOVE FRM-CPIM-AEY TO GES-CAI-IOPC-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-IIC-IOPC-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-NUM-IDLC-ATR IN GES-FLD.
       FIN-PRO-MKY-GES.
           EXIT.
       
       PRO-AKY-GES SECTION.
       INI-PRO-AKY-GES.
       FIN-PRO-AKY-GES.
           EXIT.
       
       UNP-KEY-GES SECTION.
       INI-UNP-KEY-GES.
           PERFORM UNP-IKY-GES.
           PERFORM UNP-AKY-GES.
           PERFORM UNP-MKY-GES.
       FIN-UNP-KEY-GES.
           EXIT.
       
       UNP-IKY-GES SECTION.
       INI-UNP-IKY-GES.
           MOVE FRM-CPIM-UBY TO GES-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GES-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GES-NUM-IGES-ATR.
      *<<<< FIN_UNP_IKY_GES 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GES-NUM-IGES-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-NUM-IGES-STP.
      *RRM-FIN 16-APR-2002
      *>>>>
       FIN-UNP-IKY-GES.
           EXIT.
       
       UNP-MKY-GES SECTION.
       INI-UNP-MKY-GES.
           MOVE FRM-CPIM-UBY TO GES-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO GES-IIC-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO GES-NUM-IDLC-ATR.
       FIN-UNP-MKY-GES.
           EXIT.
       
       UNP-AKY-GES SECTION.
       INI-UNP-AKY-GES.
       FIN-UNP-AKY-GES.
           EXIT.
       
       UNP-FLD-GES SECTION.
       INI-UNP-FLD-GES.
           PERFORM UNP-GES-GES.
           PERFORM UNP-GDG-GES.
       FIN-UNP-FLD-GES.
           EXIT.
       
       UNP-GES-GES SECTION.
       INI-UNP-GES-GES.
           MOVE FRM-CPIM-UBY TO GES-COD-PACR-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-SIST-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-FEC-FVCR-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-IND-SCRE-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-MVLC-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-SGV-VLCR-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-SGV-PLCR-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-TVCC-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-TOPE-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-SOPE-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-VCMC-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-DCRE-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-IND-TDEU-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-KEY-IDGP-ATR IN GES-FLD.
      *<<<< FIN_UNP_GES_GES
           IF SCR-CCPP = 'ING'
              MOVE 'S'          TO GES-IND-SCRE     IN GES-FLD
              MOVE FRM-CPIM-AEY TO GES-IND-SCRE-ATR IN GES-FLD
              MOVE FRM-CPIM-AEY TO GES-IND-SCRE-STP.
      
           MOVE 'BGL'               TO FIO-SIST.              
           MOVE 'VSN'               TO TAB-COD-TTAB IN TAB.   
           MOVE 'SOLOESPECOPE'      TO TAB-COD-CTAB IN TAB.   

           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              IF TAB-IND-VIGE IN TAB = 'S'
      *RRM-INI 16-APR-2002
                 MOVE FRM-CPIM-AEY TO GES-FEC-FVCR-ATR IN GES-FLD
                 MOVE FRM-CPIM-AEY TO GES-FEC-FVCR-STP
      *RRM-FIN 16-APR-2002
                 MOVE FRM-CPIM-AEY TO GES-COD-TVCC-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-TVCC-STP 
      *<<<< GEN_BCI
      *JRF-INI 29-JUL-2003
                 MOVE FRM-CPIM-AEY TO GES-COD-TOPE-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-TOPE-STP 
                 MOVE FRM-CPIM-AEY TO GES-COD-SOPE-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-SOPE-STP 
      *JRF-FIN 29-JUL-2003
      *>>>>
                 MOVE FRM-CPIM-AEY TO GES-COD-VCMC-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-VCMC-STP 
                 MOVE FRM-CPIM-AEY TO GES-COD-DCRE-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-COD-DCRE-STP 
                 MOVE FRM-CPIM-AEY TO GES-IND-TDEU-ATR IN GES-FLD 
                 MOVE FRM-CPIM-AEY TO GES-IND-TDEU-STP.

      *>>>>
       FIN-UNP-GES-GES.
           EXIT.
       
       UNP-GDG-GES SECTION.
       INI-UNP-GDG-GES.
       FIN-UNP-GDG-GES.
           EXIT.
       
       VAL-KEY-GES SECTION.
       INI-VAL-KEY-GES.
           PERFORM VAL-IKY-GES.
           PERFORM VAL-MKY-GES.
           PERFORM VAL-AKY-GES.
       FIN-VAL-KEY-GES.
           EXIT.
       
       VAL-IKY-GES SECTION.
       INI-VAL-IKY-GES.
      *<<<< INI_VAL_IKY_GES
      *<<<< FMT_CHI
           IF GES-IIC-IOPC IN GES-FLD      > ZEROES  AND
      *>>>>
              GES-NUM-IDLC IN GES-FLD      > ZEROES  AND
              GES-CAI-GTIA IN GES-FLD NOT  > ZEROES  AND
              GES-IIC-GTIA IN GES-FLD NOT  > ZEROES  AND
              GES-NUM-IGES IN GES-FLD NOT  > ZEROES  AND
              SCR-CCPP                NOT = 'ING'
              GO TO FIN-VAL-IKY-GES.

      *>>>>
           PERFORM VAL-GES-CAI-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-CAI-GTIA-LEN IN GES-FLD
                GO TO FIN-VAL-IKY-GES.
           PERFORM VAL-GES-IIC-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-IIC-GTIA-LEN IN GES-FLD
                GO TO FIN-VAL-IKY-GES.
           PERFORM VAL-GES-NUM-IGES.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-NUM-IGES-LEN IN GES-FLD
                GO TO FIN-VAL-IKY-GES.
       FIN-VAL-IKY-GES.
           EXIT.
       
       VAL-MKY-GES SECTION.
       INI-VAL-MKY-GES.
      *<<<<INI_VAL_MKY_GES
           GO TO FIN-VAL-MKY-GES.
      *>>>>
           PERFORM VAL-GES-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-CAI-IOPC-LEN IN GES-FLD
                GO TO FIN-VAL-MKY-GES.
           PERFORM VAL-GES-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-IIC-IOPC-LEN IN GES-FLD
                GO TO FIN-VAL-MKY-GES.
           PERFORM VAL-GES-NUM-IDLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GES-NUM-IDLC-LEN IN GES-FLD
                GO TO FIN-VAL-MKY-GES.
       FIN-VAL-MKY-GES.
           EXIT.
       
       VAL-AKY-GES SECTION.
       INI-VAL-AKY-GES.
       FIN-VAL-AKY-GES.
           EXIT.
       
       VAL-GES-CAI-GTIA SECTION.
       INI-VAL-GES-CAI-GTIA.
           IF GES-CAI-GTIA IN GES-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GES-CAI-GTIA.
       FIN-VAL-GES-CAI-GTIA.
           EXIT.
       
       VAL-GES-IIC-GTIA SECTION.
       INI-VAL-GES-IIC-GTIA.
           IF GES-IIC-GTIA IN GES-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GES-IIC-GTIA.
       FIN-VAL-GES-IIC-GTIA.
           EXIT.
       
       VAL-GES-NUM-IGES SECTION.
       INI-VAL-GES-NUM-IGES.
      *<<<< GES_COD_ESP
           IF GES-NUM-IGES IN GES-FLD NOT > ZEROES AND
              SCR-CCPP NOT = 'ING'

               PERFORM KEY-GES-GES
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM BGL-FIO-GES
               IF FIO-STAT-OKS
                   GO TO FIN-VAL-GES-NUM-IGES.

           IF GES-NUM-IGES IN GES-FLD NOT > ZEROES
               PERFORM BUS-COR-GES.

           IF GES-NUM-IGES IN GES-FLD = ZEROES
               PERFORM ERR-GLS
                GO TO FIN-VAL-GES-NUM-IGES.
      *>>>>
       FIN-VAL-GES-NUM-IGES.
           EXIT.
       
       VAL-GES-CAI-IOPC SECTION.
       INI-VAL-GES-CAI-IOPC.
           IF GES-CAI-IOPC IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-CAI-IOPC IN GES-FLD.
       FIN-VAL-GES-CAI-IOPC.
           EXIT.
       
       VAL-GES-IIC-IOPC SECTION.
       INI-VAL-GES-IIC-IOPC.
      *<<<< GES_IIC_IOPC
      *RRM-INI 16-APR-2002
           IF WSS-IND-VIGE = 'N' AND
              GES-IIC-IOPC IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-IIC-IOPC IN GES-FLD
               GO TO FIN-VAL-GES-IIC-IOPC.
      *RRM-FIN 16-APR-2002

      *>>>>
       FIN-VAL-GES-IIC-IOPC.
           EXIT.
       
       VAL-GES-NUM-IDLC SECTION.
       INI-VAL-GES-NUM-IDLC.
      *<<<< GES_NUM_IDLC
      *RRM-INI 16-APR-2002

           IF WSS-IND-VIGE = 'N' AND
              GES-NUM-IDLC IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-NUM-IDLC IN GES-FLD
               GO TO FIN-VAL-GES-NUM-IDLC.
      *RRM-FIN 16-APR-2002
      
           IF GES-NUM-IDLC IN GES-FLD NOT > ZEROES 
               MOVE ZEROES TO GES-NUM-IDLC IN GES-FLD.

      *<<<< FMT_CHI
           IF ( GES-IIC-IOPC IN GES-FLD     > ZEROES AND
                GES-NUM-IDLC IN GES-FLD NOT > ZEROES ) 
      *AFRI-INI /JUL2004
              AND (GES-COD-SIST IN GES-FLD = 'COL' OR                   
                   GES-COD-SIST IN GES-FLD = 'CRE')   
      *AFRI-FIN /JUL2004
      *>>>>
               MOVE 'BGL'          TO MSG-COD-SIST      
               MOVE 'GESIICCDTBLK' TO MSG-COD-MENS      
               PERFORM GET-MSG                          
               MOVE MSG-GLS-DESC TO FRM-MENS            
               MOVE FRM-SUAR-MAL TO FRM-SUAR            
               GO TO FIN-VAL-GES-NUM-IDLC.              

           IF GES-NUM-IDLC IN GES-FLD NOT > ZEROES
               GO TO FIN-VAL-GES-NUM-IDLC.

      *FLB CST  9-MAY-1994 DLC NO DEBE REPETIRSE
           PERFORM VAL-DLC-IGUA.
           IF MSG-COD-MENS > SPACES
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-IDLC.

           PERFORM BUS-COL.
           IF MSG-COD-MENS > SPACES
               MOVE 'BGL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-IDLC.

      *<<<< PGM_CHI
      *>>>>
      *>>>>
       FIN-VAL-GES-NUM-IDLC.
           EXIT.
       
       VAL-CON-KEY-GES SECTION.
       INI-VAL-CON-KEY-GES.
           IF     GES-CAI-GTIA IN GES-FLD NOT > SPACES 
              AND GES-IIC-GTIA IN GES-FLD NOT > ZEROES 
              AND GES-NUM-IGES IN GES-FLD NOT > ZEROES 
              AND GES-CAI-IOPC IN GES-FLD NOT > SPACES 
              AND GES-IIC-IOPC IN GES-FLD NOT > ZEROES 
              AND GES-NUM-IDLC IN GES-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GES.
       FIN-VAL-CON-KEY-GES.
           EXIT.
       
       VAL-CON-IKY-GES SECTION.
       INI-VAL-CON-IKY-GES.
      *<<<< INI_VAL_CON_IKY_GES

           IF SCR-CCPP = 'ELI' 
               PERFORM KEY-GES-GES
               ADD 1   TO GES-NUM-IGES IN GES
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM BGL-FIO-GES
               IF FIO-STAT-OKS
                   MOVE 'BGL'       TO MSG-COD-SIST
                   MOVE 'IKYSIGEXI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-IKY-GES
               ELSE
                   GO TO FIN-VAL-CON-IKY-GES.

           IF GES-NUM-IGES IN GES-FLD > 1
               PERFORM KEY-GES-GES
               SUBTRACT 1 FROM GES-NUM-IGES IN GES-FLD
                        GIVING GES-NUM-IGES IN GES

               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM BGL-FIO-GES
               IF NOT FIO-STAT-OKS
                   MOVE 'BGL'       TO MSG-COD-SIST
                   MOVE 'IKYANTNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-IKY-GES
               ELSE
      *            Gtia a conjunto de creditos
                   IF GES-IIC-IOPC IN GES NOT > ZEROES
                       MOVE 'BGL'         TO MSG-COD-SIST
                       MOVE 'GES SOLO 1'  TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-IKY-GES
                   ELSE

      *                Gtia a un credito individual
      *                Ingresa Item siguientes al primero
                       GO TO FIN-VAL-CON-IKY-GES.

      *>>>>
           IF     GES-CAI-GTIA IN GES-FLD NOT > SPACES 
              AND GES-IIC-GTIA IN GES-FLD NOT > ZEROES 
              AND GES-NUM-IGES IN GES-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GES.
       FIN-VAL-CON-IKY-GES.
           EXIT.
       
       VAL-NUM-KEY-GES SECTION.
       INI-VAL-NUM-KEY-GES.
           PERFORM VAL-NUM-IKY-GES.
           PERFORM VAL-NUM-MKY-GES.
           PERFORM VAL-NUM-AKY-GES.
       FIN-VAL-NUM-KEY-GES.
           EXIT.
       
       VAL-NUM-IKY-GES SECTION.
       INI-VAL-NUM-IKY-GES.
       VAL-NUM-GES-IIC-GTIA.
           MOVE GES-IIC-GTIA-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-IIC-GTIA IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-IIC-GTIA-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-IKY-GES.
       VAL-NUM-GES-NUM-IGES.
           MOVE GES-NUM-IGES-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-NUM-IGES IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-NUM-IGES-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-IKY-GES.
       FIN-VAL-NUM-IKY-GES.
           EXIT.
       
       VAL-NUM-MKY-GES SECTION.
       INI-VAL-NUM-MKY-GES.
       VAL-NUM-GES-IIC-IOPC.
           MOVE GES-IIC-IOPC-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-IIC-IOPC IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-IIC-IOPC-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-MKY-GES.
       VAL-NUM-GES-NUM-IDLC.
           MOVE GES-NUM-IDLC-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-NUM-IDLC IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-NUM-IDLC-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-MKY-GES.
       FIN-VAL-NUM-MKY-GES.
           EXIT.
       
       VAL-NUM-AKY-GES SECTION.
       INI-VAL-NUM-AKY-GES.
       FIN-VAL-NUM-AKY-GES.
           EXIT.
       
       VAL-NUM-FLD-GES SECTION.
       INI-VAL-NUM-FLD-GES.
       VAL-NUM-GES-COD-PACR.
           MOVE GES-COD-PACR-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GES-COD-PACR IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-COD-PACR-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-SGV-VLCR.
           MOVE GES-SGV-VLCR-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GES-SGV-VLCR IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-SGV-VLCR-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-SGV-PLCR.
           MOVE GES-SGV-PLCR-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GES-SGV-PLCR IN GES-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GES-SGV-PLCR-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       FIN-VAL-NUM-FLD-GES.
           EXIT.
       
       EDT-KEY-GES SECTION.
       INI-EDT-KEY-GES.
           PERFORM EDT-IKY-GES.
           PERFORM EDT-MKY-GES.
           PERFORM EDT-AKY-GES.
       FIN-EDT-KEY-GES.
           EXIT.
       
       EDT-IKY-GES SECTION.
       INI-EDT-IKY-GES.
           IF GES-IIC-GTIA-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-IIC-GTIA-LEN IN GES-FLD
                GO TO FIN-EDT-IKY-GES.
           MOVE GES-IIC-GTIA IN GES-FLD TO GES-IIC-GTIA-EDT IN GES-EDT.
           MOVE GES-IIC-GTIA-EDT IN GES-EDT TO 
                GES-IIC-GTIA-ALF IN GES-FLD.
           IF GES-NUM-IGES-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-NUM-IGES-LEN IN GES-FLD
                GO TO FIN-EDT-IKY-GES.
           MOVE GES-NUM-IGES IN GES-FLD TO GES-NUM-IGES-EDT IN GES-EDT.
           MOVE GES-NUM-IGES-EDT IN GES-EDT TO 
                GES-NUM-IGES-ALF IN GES-FLD.
       FIN-EDT-IKY-GES.
           EXIT.
       
       EDT-MKY-GES SECTION.
       INI-EDT-MKY-GES.
           IF GES-IIC-IOPC-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-IIC-IOPC-LEN IN GES-FLD
                GO TO FIN-EDT-MKY-GES.
           MOVE GES-IIC-IOPC IN GES-FLD TO GES-IIC-IOPC-EDT IN GES-EDT.
           MOVE GES-IIC-IOPC-EDT IN GES-EDT TO 
                GES-IIC-IOPC-ALF IN GES-FLD.
           IF GES-NUM-IDLC-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-NUM-IDLC-LEN IN GES-FLD
                GO TO FIN-EDT-MKY-GES.
           MOVE GES-NUM-IDLC IN GES-FLD TO GES-NUM-IDLC-EDT IN GES-EDT.
           MOVE GES-NUM-IDLC-EDT IN GES-EDT TO 
                GES-NUM-IDLC-ALF IN GES-FLD.
       FIN-EDT-MKY-GES.
           EXIT.
       
       EDT-AKY-GES SECTION.
       INI-EDT-AKY-GES.
       FIN-EDT-AKY-GES.
           EXIT.
       
       EDT-FLD-GES SECTION.
       INI-EDT-FLD-GES.
           IF GES-COD-PACR-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-COD-PACR-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-COD-PACR IN GES-FLD TO GES-COD-PACR-EDT IN GES-EDT.
           MOVE GES-COD-PACR-EDT IN GES-EDT TO 
                GES-COD-PACR-ALF IN GES-FLD.
           IF GES-SGV-VLCR-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-SGV-VLCR-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-SGV-VLCR IN GES-FLD TO GES-SGV-VLCR-EDT IN GES-EDT.
           MOVE GES-SGV-VLCR-EDT IN GES-EDT TO 
                GES-SGV-VLCR-ALF IN GES-FLD.
           IF GES-SGV-PLCR-LEN IN GES-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GES-SGV-PLCR-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-SGV-PLCR IN GES-FLD TO GES-SGV-PLCR-EDT IN GES-EDT.
           MOVE GES-SGV-PLCR-EDT IN GES-EDT TO 
                GES-SGV-PLCR-ALF IN GES-FLD.
       FIN-EDT-FLD-GES.
           EXIT.
      *<<<< EOF BM
       BUS-COL SECTION.
       INI-BUS-COL.
      * LEE DOCUMENTO LEGAL DE CREDITO EN COL

      *<<<< FMT_CHI
           MOVE GES-CAI-IOPC IN GES-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE GES-IIC-IOPC IN GES-FLD TO DLC-IIC-IOPC IN DLC.
      *>>>>
           MOVE GES-NUM-IDLC IN GES-FLD TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'DLC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.


           IF DLC-VAL-SDLC IN DLC NOT > ZEROES
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'DLC SDLC=0'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.


           MOVE DLC-FEC-FMAV IN DLC TO GES-FEC-FVCR IN GES.
           MOVE GES-NUM-SVCR IN GES TO GES-NUM-SVCR IN GES-FLD.
           MOVE GES-NUM-AVCR IN GES TO GES-NUM-AVCR IN GES-FLD.
           MOVE GES-NUM-MVCR IN GES TO GES-NUM-MVCR IN GES-FLD.
           MOVE GES-NUM-DVCR IN GES TO GES-NUM-DVCR IN GES-FLD.
      *
      *<<<< FMT_CHI
           MOVE GES-CAI-IOPC IN GES-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE GES-IIC-IOPC IN GES-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'OPC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.
      *>>>>
      *<<<< GEN_BCI
      *JRF-INI 29-JUL-2003
           MOVE OPC-COD-TOOC IN OPC TO GES-COD-TOPE IN GES-FLD.
           MOVE OPC-COD-AOOC IN OPC TO GES-COD-SOPE IN GES-FLD.
      *JRF-FIN 29-JUL-2003
      *>>>>
           MOVE OPC-COD-VCOC IN OPC TO GES-COD-VCMC IN GES-FLD.
      *<<<< FMT_CHI
           MOVE OPC-MSC-TVOC IN OPC TO GES-COD-TVCC IN GES-FLD.
      *>>>>
      *    MOVE OPC-COD-CDOC IN OPC TO GES-COD-DCRE IN GES-FLD.
      *MHM-INI 27-DIC-2004                                              
      *    MOVE SPACES              TO GES-COD-DCRE IN GES-FLD.         
      *MHM-FIN 27-DIC-2004                                                     
           MOVE 'D'                 TO GES-IND-TDEU IN GES-FLD.
      *<<<< FMT_CHI
           MOVE DLC-NUM-SMAV IN DLC TO WSS-NUM-SAUX IN WSS-VARI.
           MOVE DLC-NUM-AMAV IN DLC TO WSS-NUM-AAUX IN WSS-VARI.
           MOVE DLC-NUM-MMAV IN DLC TO WSS-NUM-MAUX IN WSS-VARI.
           MOVE DLC-NUM-DMAV IN DLC TO WSS-NUM-DAUX IN WSS-VARI.
      *>>>>
           MOVE WSS-FEC-FAUX IN WSS-VARI TO GES-FEC-FVCR IN GES-FLD.
           
      *MPB-INI 01-FEB-2019 MODIFICACION PANTALLA GES
           IF OPC-VAL-SCRE IN OPC > ZEROES        
               MOVE WSS-S TO GES-IND-SCRE IN GES-FLD
           ELSE                              
               MOVE WSS-N TO GES-IND-SCRE IN GES-FLD.
      *MPB-FIN           
           GO TO FIN-BUS-COL.
       ERR-BUS-COL.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-BUS-COL.
           EXIT.
      *>>>>
      *<<<< EOF
       VAL-DLC-IGUA SECTION.
       INI-VAL-DLC-IGUA.
      * DLC no debe repetirse
           PERFORM KEY-GES-GES.
           MOVE ZEROES TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GES.
       LUP-VAL-DLC-IGUA.
           IF NOT ( FIO-STAT-OKS AND
              GES-CAI-GTIA IN GES = GES-CAI-GTIA IN GES-FLD AND
              GES-IIC-GTIA IN GES = GES-IIC-GTIA IN GES-FLD )
               GO TO BRW-VAL-DLC-IGUA.

           IF GES-NUM-IGES IN GES = GES-NUM-IGES IN GES-FLD
               GO TO NXT-VAL-DLC-IGUA.
      *<<<< FMT_CHI
           IF GES-IIC-IOPC IN GES = GES-IIC-IOPC IN GES-FLD AND
              GES-CAI-IOPC IN GES = GES-CAI-IOPC IN GES-FLD AND
      *>>>>
              GES-NUM-IDLC IN GES = GES-NUM-IDLC IN GES-FLD
               MOVE 'DLCREPETIDO' TO MSG-COD-MENS
               GO TO BRW-VAL-DLC-IGUA.

       NXT-VAL-DLC-IGUA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM BGL-FIO-GES.
           GO TO LUP-VAL-DLC-IGUA.
       BRW-VAL-DLC-IGUA.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM BGL-FIO-GES.
       FIN-VAL-DLC-IGUA.
           EXIT.
      *>>>>

