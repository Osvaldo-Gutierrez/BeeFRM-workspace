      *
      * BGLBUGTP
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 04:57 PM
      *
       SET-TAG-BGLBUGTP SECTION.
       INI-SET-TAG-BGLBUGTP.
           MOVE
           '<IDNMOD NOM=$BGLBUGTP$ VSN=$06.06.22$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 04:57 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGTP.
           EXIT.
           
       RET-ALL-GTP SECTION.
       INI-RET-ALL-GTP.
           PERFORM KEY-ALL-GTP.
           PERFORM RET-GTP-GTP.
           PERFORM RET-GDG-GTP.
       FIN-RET-ALL-GTP.
           EXIT.
       
       RET-GTP-GTP SECTION.
       INI-RET-GTP-GTP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GTP-NUM-DCES IN GTP-FLD TO GTP-NUM-DCES IN GTP.
           MOVE GTP-NUM-MCES IN GTP-FLD TO GTP-NUM-MCES IN GTP.
           MOVE GTP-NUM-SCES IN GTP-FLD TO GTP-NUM-SCES IN GTP.
           MOVE GTP-NUM-ACES IN GTP-FLD TO GTP-NUM-ACES IN GTP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GTP-COD-IITS IN GTP-FLD TO GTP-COD-IITS IN GTP.
           MOVE GTP-SGV-VTSN IN GTP-FLD TO GTP-SGV-VTSN IN GTP.
           MOVE GTP-COD-EITS IN GTP-FLD TO GTP-COD-EITS IN GTP.
           MOVE GTP-SGV-ITSN IN GTP-FLD TO GTP-SGV-ITSN IN GTP.
           MOVE GTP-COD-MAND IN GTP-FLD TO GTP-COD-MAND IN GTP.
           MOVE GTP-COD-CUST IN GTP-FLD TO GTP-COD-CUST IN GTP.
           MOVE GTP-GLS-UBIC IN GTP-FLD TO GTP-GLS-UBIC IN GTP.
           MOVE GTP-GLS-TIT1 IN GTP-FLD TO GTP-GLS-TIT1 IN GTP.
           MOVE GTP-GLS-TIT2 IN GTP-FLD TO GTP-GLS-TIT2 IN GTP.
           MOVE GTP-GLS-TIT3 IN GTP-FLD TO GTP-GLS-TIT3 IN GTP.
       FIN-RET-GTP-GTP.
           EXIT.
       
       RET-GDG-GTP SECTION.
       INI-RET-GDG-GTP.
      * IDG-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-TIP-CGTA IN GTP-FLD TO GDG-TIP-CGTA IN GDG.
           MOVE GDG-STP-CGTA IN GTP-FLD TO GDG-STP-CGTA IN GDG.
      * IDG-FIN --> BMCHIBCI002210.SRCAIU 
      * OFI-INI --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-OFIC IN GTP-FLD TO GDG-COD-OFIC IN GDG.
      * OFI-FIN --> BMCHIBCI002210.SRCAIU 
           MOVE GDG-COD-VCAM IN GTP-FLD TO GDG-COD-VCAM IN GDG.
           MOVE GDG-GLS-DGTA IN GTP-FLD TO GDG-GLS-DGTA IN GDG.
           MOVE GDG-GLS-DGT1 IN GTP-FLD TO GDG-GLS-DGT1 IN GDG.
       FIN-RET-GDG-GTP.
           EXIT.
       
       KEY-ALL-GTP SECTION.
       INI-KEY-ALL-GTP.
           PERFORM KEY-GTP-GTP.
           PERFORM KEY-GDG-GTP.
       FIN-KEY-ALL-GTP.
           EXIT.
       
       KEY-GTP-GTP SECTION.
       INI-KEY-GTP-GTP.
           MOVE GTP-CAI-GTIA IN GTP-FLD TO GTP-CAI-GTIA IN GTP.
           MOVE GTP-IIC-GTIA IN GTP-FLD TO GTP-IIC-GTIA IN GTP.
           MOVE GTP-NUM-ITSN IN GTP-FLD TO GTP-NUM-ITSN IN GTP.
           MOVE GTP-COD-ITSN IN GTP-FLD TO GTP-COD-ITSN IN GTP.
       FIN-KEY-GTP-GTP.
           EXIT.
       
       KEY-GDG-GTP SECTION.
       INI-KEY-GDG-GTP.
       FIN-KEY-GDG-GTP.
           EXIT.
       
       SCR-CLRA-GTP SECTION.
       INI-SCR-CLRA-GTP.
           PERFORM CLR-KEY-GTP.
           PERFORM CLR-FLD-GTP.
       FIN-SCR-CLRA-GTP.
           EXIT.
       
       CLR-KEY-GTP SECTION.
       INI-CLR-KEY-GTP.
           MOVE SPACES TO GTP-CAI-GTIA IN GTP-FLD.
           MOVE ZEROES TO GTP-IIC-GTIA IN GTP-FLD.
           MOVE ZEROES TO GTP-NUM-ITSN IN GTP-FLD.
           MOVE ZEROES TO GTP-COD-ITSN IN GTP-FLD.
       FIN-CLR-KEY-GTP.
           EXIT.
       
       CLR-FLD-GTP SECTION.
       INI-CLR-FLD-GTP.
           MOVE SPACES TO FRM-GLS-CGTA IN GTP-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN GTP-FLD.
           MOVE SPACES TO FRM-GLS-TREA IN GTP-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN GTP-FLD.
           MOVE SPACES TO FRM-COD-LIST IN GTP-FLD.
           MOVE SPACES TO FRM-GLS-EITS IN GTP-FLD.
           MOVE SPACES TO FRM-GLS-LIST IN GTP-FLD.
           MOVE SPACES TO FRM-GLS-CUST IN GTP-FLD.
           PERFORM CLR-GTP-GTP.
           PERFORM CLR-GDG-GTP.
       FIN-CLR-FLD-GTP.
           EXIT.
       
       CLR-GTP-GTP SECTION.
       INI-CLR-GTP-GTP.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GTP-FEC-FCES IN GTP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GTP-COD-IITS IN GTP-FLD.
           MOVE ZEROES TO GTP-SGV-VTSN IN GTP-FLD.
           MOVE SPACES TO GTP-COD-EITS IN GTP-FLD.
           MOVE ZEROES TO GTP-SGV-ITSN IN GTP-FLD.
           MOVE SPACES TO GTP-COD-MAND IN GTP-FLD.
           MOVE SPACES TO GTP-COD-CUST IN GTP-FLD.
           MOVE SPACES TO GTP-GLS-UBIC IN GTP-FLD.
           MOVE SPACES TO GTP-GLS-TIT1 IN GTP-FLD.
           MOVE SPACES TO GTP-GLS-TIT2 IN GTP-FLD.
           MOVE SPACES TO GTP-GLS-TIT3 IN GTP-FLD.
       FIN-CLR-GTP-GTP.
           EXIT.
       
       CLR-GDG-GTP SECTION.
       INI-CLR-GDG-GTP.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN GTP-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GTP-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN GTP-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN GTP-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN GTP-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN GTP-FLD.
       FIN-CLR-GDG-GTP.
           EXIT.
       
       FST-KEY-GTP SECTION.
       INI-FST-KEY-GTP.
           MOVE -1 TO GTP-CAI-GTIA-LEN IN GTP-FLD.
       FIN-FST-KEY-GTP.
           EXIT.
       
       FST-FLD-GTP SECTION.
       INI-FST-FLD-GTP.
           MOVE FRM-POS-CURS TO GTP-FEC-FCES-LEN IN GTP-FLD.
       FIN-FST-FLD-GTP.
           EXIT.
       
       PRO-KEY-GTP SECTION.
       INI-PRO-KEY-GTP.
           PERFORM PRO-MKY-GTP.
       FIN-PRO-KEY-GTP.
           EXIT.
       
       PRO-MKY-GTP SECTION.
       INI-PRO-MKY-GTP.
       FIN-PRO-MKY-GTP.
           EXIT.
       
       PRO-FLD-GTP SECTION.
       INI-PRO-FLD-GTP.
           PERFORM PRO-GTP-GTP.
           PERFORM PRO-GDG-GTP.
       FIN-PRO-FLD-GTP.
           EXIT.
       
       PRO-GTP-GTP SECTION.
       INI-PRO-GTP-GTP.
           MOVE FRM-CPIM-AEY TO GTP-FEC-FCES-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-COD-IITS-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-SGV-VTSN-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-COD-EITS-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-SGV-ITSN-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-COD-MAND-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-COD-CUST-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-GLS-UBIC-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-GLS-TIT1-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-GLS-TIT2-ATR IN GTP-FLD.
           MOVE FRM-CPIM-AEY TO GTP-GLS-TIT3-ATR IN GTP-FLD.
       FIN-PRO-GTP-GTP.
           EXIT.
       
       PRO-GDG-GTP SECTION.
       INI-PRO-GDG-GTP.
       FIN-PRO-GDG-GTP.
           EXIT.
       
       UNP-KEY-GTP SECTION.
       INI-UNP-KEY-GTP.
           PERFORM UNP-IKY-GTP.
           PERFORM UNP-AKY-GTP.
           PERFORM UNP-MKY-GTP.
       FIN-UNP-KEY-GTP.
           EXIT.
       
       UNP-IKY-GTP SECTION.
       INI-UNP-IKY-GTP.
           MOVE FRM-CPIM-UBY TO GTP-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GTP-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GTP-NUM-ITSN-ATR.
           MOVE FRM-CPIM-UBY TO GTP-COD-ITSN-ATR.
       FIN-UNP-IKY-GTP.
           EXIT.
       
       UNP-MKY-GTP SECTION.
       INI-UNP-MKY-GTP.
       FIN-UNP-MKY-GTP.
           EXIT.
       
       UNP-AKY-GTP SECTION.
       INI-UNP-AKY-GTP.
       FIN-UNP-AKY-GTP.
           EXIT.
       
       UNP-FLD-GTP SECTION.
       INI-UNP-FLD-GTP.
           PERFORM UNP-GTP-GTP.
           PERFORM UNP-GDG-GTP.
       FIN-UNP-FLD-GTP.
           EXIT.
       
       UNP-GTP-GTP SECTION.
       INI-UNP-GTP-GTP.
           MOVE FRM-CPIM-UBY TO GTP-FEC-FCES-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-COD-IITS-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-SGV-VTSN-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-COD-EITS-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-SGV-ITSN-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-COD-MAND-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-COD-CUST-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-GLS-UBIC-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-GLS-TIT1-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-GLS-TIT2-ATR IN GTP-FLD.
           MOVE FRM-CPIM-UBY TO GTP-GLS-TIT3-ATR IN GTP-FLD.
      *<<<< FIN_UNP_GTP_GTP
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GTP-FLD TO WSS-TIPO IN WSS-VARI
           MOVE GDG-STP-CGTA IN GTP-FLD TO WSS-AUX IN WSS-VARI.
           MOVE WSS-TIPO-AUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TIAU IN WSS-VARI.
           IF WSS-CIC-TIAU IN WSS-VARI = '952082'
                 MOVE FRM-CPIM-AEY TO GTP-SGV-VTSN-ATR IN GTP-FLD
                 MOVE FRM-CPIM-AEY TO GTP-FEC-FCES-ATR IN GTP-FLD.
      *>>>>
       FIN-UNP-GTP-GTP.
           EXIT.
       
       UNP-GDG-GTP SECTION.
       INI-UNP-GDG-GTP.
       FIN-UNP-GDG-GTP.
           EXIT.
       
       VAL-MKY-GTP SECTION.
       INI-VAL-MKY-GTP.
       FIN-VAL-MKY-GTP.
           EXIT.
       
       VAL-FLD-GTP SECTION.
       INI-VAL-FLD-GTP.
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
            MOVE GTP-CAI-GTIA IN GTP-FLD TO GDG-CAI-GTIA IN GDG.
            MOVE GTP-IIC-GTIA IN GTP-FLD TO GDG-IIC-GTIA IN GDG.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM BGL-FIO-GDG.
      *VERIFICA SI PRODUCTO (TIPO-SUBTIPO) ES FFMM
           MOVE SPACES              TO WSS-IND-FFMM.
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'PFM'               TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-CGTA IN GDG TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S
               MOVE WSS-S  TO WSS-IND-FFMM.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM

      * IDG-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-TIP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-TIP-CGTA-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GDG-STP-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-STP-CGTA-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
      * IDG-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
      * OFI-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GDG-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GDG-COD-OFIC-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
      * OFI-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-FRM-GLS-TREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TREA-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GDG-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-COD-VCAM-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GDG-GLS-DGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGTA-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GDG-GLS-DGT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-GLS-DGT1-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GTP-FEC-FCES.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GTP-FEC-FCES-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GTP-COD-IITS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-COD-IITS-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-FRM-COD-LIST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-LIST-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GTP-SGV-VTSN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-SGV-VTSN-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GTP-COD-EITS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-COD-EITS-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-FRM-GLS-EITS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EITS-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-FRM-GLS-LIST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-LIST-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GTP-SGV-ITSN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-SGV-ITSN-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GTP-COD-MAND.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-COD-MAND-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GTP-COD-CUST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-COD-CUST-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-FRM-GLS-CUST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CUST-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GTP-GLS-UBIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-GLS-UBIC-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GTP-GLS-TIT1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-GLS-TIT1-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GTP-GLS-TIT2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-GLS-TIT2-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
           PERFORM VAL-GTP-GLS-TIT3.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GTP-GLS-TIT3-LEN IN GTP-FLD
                GO TO FIN-VAL-FLD-GTP.
       FIN-VAL-FLD-GTP.
           EXIT.
      * IDG-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-TIP-CGTA SECTION.
       INI-VAL-GDG-TIP-CGTA.
           IF GDG-TIP-CGTA IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-CGTA IN GTP-FLD.
       FIN-VAL-GDG-TIP-CGTA.
           EXIT.

       VAL-GDG-STP-CGTA SECTION.
       INI-VAL-GDG-STP-CGTA.
           IF GDG-STP-CGTA IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-CGTA IN GTP-FLD.
       FIN-VAL-GDG-STP-CGTA.
           EXIT.
      * IDG-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * OFI-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GDG-COD-OFIC SECTION.
       INI-VAL-GDG-COD-OFIC.
           IF GDG-COD-OFIC IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFIC IN GTP-FLD.
       FIN-VAL-GDG-COD-OFIC.
           EXIT.
      * OFI-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-FRM-GLS-TREA SECTION.
       INI-VAL-FRM-GLS-TREA.
       FIN-VAL-FRM-GLS-TREA.
           EXIT.
       
       VAL-GDG-COD-VCAM SECTION.
       INI-VAL-GDG-COD-VCAM.
       FIN-VAL-GDG-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-GDG-GLS-DGTA SECTION.
       INI-VAL-GDG-GLS-DGTA.
       FIN-VAL-GDG-GLS-DGTA.
           EXIT.
       
       VAL-GDG-GLS-DGT1 SECTION.
       INI-VAL-GDG-GLS-DGT1.
       FIN-VAL-GDG-GLS-DGT1.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GTP-FEC-FCES SECTION.
       INI-VAL-GTP-FEC-FCES.
           IF GTP-FEC-FCES IN GTP-FLD  NOT > ZEROES
              MOVE ZEROES TO GTP-FEC-FCES IN GTP-FLD.
      *VAL-FEC Validar Fecha
           MOVE GTP-FEC-FCES IN GTP-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GTP-FEC-FCES IN GTP-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GTP-FEC-FCES.
      *<<<< FIN_GTP_FEC_FCES
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GTP-FLD TO WSS-TIPO IN WSS-VARI
           MOVE GDG-STP-CGTA IN GTP-FLD TO WSS-AUX IN WSS-VARI.
           MOVE WSS-TIPO-AUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TIAU IN WSS-VARI.
           IF WSS-CIC-TIAU IN WSS-VARI = '952082'
              PERFORM GET-FHOY
              MOVE HOY-SHOY TO GTP-NUM-SCES IN GTP-FLD
              MOVE HOY-AHOY TO GTP-NUM-ACES IN GTP-FLD
              MOVE HOY-MHOY TO GTP-NUM-MCES IN GTP-FLD
              MOVE HOY-DHOY TO GTP-NUM-DCES IN GTP-FLD.

            MOVE GTP-CAI-GTIA IN GTP-FLD TO GVT-CAI-GTIA IN GVT.
            MOVE GTP-IIC-GTIA IN GTP-FLD TO GVT-IIC-GTIA IN GVT.
            MOVE GTP-NUM-ITSN IN GTP-FLD TO GVT-COD-TASN IN GVT.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM BGL-FIO-GVT.
            IF FIO-STAT-OKS
                  MOVE GVT-NUM-DTSN IN GVT TO FEC-DEC1
                  MOVE GVT-NUM-MTSN IN GVT TO FEC-MEC1
                  MOVE GVT-NUM-STSN IN GVT TO WSS-SIGLO
                  MOVE GVT-NUM-ATSN IN GVT TO WSS-ANO
                  MOVE WSS-FECHA           TO FEC-FSA1
      *     
                  MOVE ZEROES TO WSS-FECHA
                  MOVE GTP-NUM-DCES IN GTP-FLD TO FEC-DEC2
                  MOVE GTP-NUM-MCES IN GTP-FLD TO FEC-MEC2
                  MOVE GTP-NUM-SCES IN GTP-FLD TO WSS-SIGLO
                  MOVE GTP-NUM-ACES IN GTP-FLD TO WSS-ANO
                  MOVE WSS-FECHA    IN WSS-VARI TO FEC-FSA2
                  MOVE FEC-FORM-FEC TO FEC-FORM
                  MOVE FEC-CMP-FEC  TO FEC-CMND
                  PERFORM PRO-FEC
                  IF FEC-STAT-GRT
                      MOVE 'BGL' TO MSG-COD-SIST
                      MOVE 'GTPCMB<TSN' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO FIN-VAL-GTP-FEC-FCES
                  ELSE
                    NEXT SENTENCE
           ELSE
               MOVE 'GTPKEYMALGDG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GTP-FEC-FCES.
      *>>>>
       FIN-VAL-GTP-FEC-FCES.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GTP-COD-IITS SECTION.
       INI-VAL-GTP-COD-IITS.
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
      *VERIFICA SI PRODUCTO (TIPO-SUBTIPO) ES FFMM
           IF WSS-IND-FFMM NOT = WSS-S
               GO TO GTP-COD-IITS-NO-FFMM.
      *"Identificacion" SE OBTIENE DESDE GDO.
           MOVE GTP-CAI-GTIA IN GTP-FLD TO GDO-CAI-GTIA IN GDO.
           MOVE GTP-IIC-GTIA IN GTP-FLD TO GDO-IIC-GTIA IN GDO.
           MOVE WSS-1                   TO GDO-NUM-IGDO IN GDO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GDO.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE 'GTPGDO NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GTP-COD-IITS.
           MOVE GDO-COD-TIEM IN GDO TO WSS-COD-TIEM.
           MOVE GDO-COD-INEM IN GDO TO WSS-COD-INEM.
           MOVE GDO-COD-SIEM IN GDO TO WSS-COD-SIEM.
           MOVE WSS-INST-EMIS       TO  GTP-COD-IITS IN GTP-FLD.
           GO TO FIN-VAL-GTP-COD-IITS.
       GTP-COD-IITS-NO-FFMM.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM

           IF GTP-COD-IITS IN GTP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GTP-COD-IITS.
      *<<<< GTP_COD_IITS
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GTP-FLD TO WSS-TIPO IN WSS-VARI
           MOVE GDG-STP-CGTA IN GTP-FLD TO WSS-AUX IN WSS-VARI.
           MOVE WSS-TIPO-AUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TIAU IN WSS-VARI.
      *PVG INI 15-OCT-2003
      *    IF WSS-CIC-TIAU IN WSS-VARI = '952082'
      *CGA-INI 05-FEB-2013
      *    IF WSS-CIC-TIAU IN WSS-VARI = '952086'
           IF WSS-CIC-TIAU IN WSS-VARI = '952086'  OR
              WSS-CIC-TIAU IN WSS-VARI = '952886'
      *CGA-FIN 05-FEB-2013
      *PVG FIN 15-OCT-2003
              MOVE GTP-COD-IITS IN GTP-FLD TO ACC-COD-NEMO IN ACC
      *PVG INI 15-OCT-2003
      *       MOVE 99999999                TO ACC-FEC-FPRO IN ACC
              MOVE GTP-NUM-SCES IN GTP-FLD TO ACC-NUM-SPRO IN ACC
              MOVE GTP-NUM-ACES IN GTP-FLD TO ACC-NUM-APRO IN ACC
              MOVE GTP-NUM-MCES IN GTP-FLD TO ACC-NUM-MPRO IN ACC
              MOVE GTP-NUM-DCES IN GTP-FLD TO ACC-NUM-DPRO IN ACC
      *PVG FIN 15-OCT-2003
              MOVE FIO-GET-LEQ TO FIO-CMND
              PERFORM BGL-FIO-ACC
              IF NOT (FIO-STAT-OKS AND 
                      ACC-COD-NEMO IN ACC = GTP-COD-IITS IN GTP-FLD)
                  MOVE 'TAB'          TO MSG-COD-SIST
                  MOVE 'NEM    NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GTP-COD-IITS.
      *>>>>
       FIN-VAL-GTP-COD-IITS.
           EXIT.
       
       VAL-FRM-COD-LIST SECTION.
       INI-VAL-FRM-COD-LIST.
      *<<<< FRM_COD_LIST
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
           IF WSS-IND-FFMM = WSS-S
               MOVE SPACES TO FRM-COD-LIST
               GO TO FIN-VAL-FRM-COD-LIST.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM

           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GTP-FLD TO WSS-TIPO IN WSS-VARI
           MOVE GDG-STP-CGTA IN GTP-FLD TO WSS-AUX IN WSS-VARI.
           MOVE WSS-TIPO-AUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TIAU IN WSS-VARI.
      *PVG INI 15-OCT-2003
      *    IF WSS-CIC-TIAU IN WSS-VARI = '952082'
      *CGA-INI 05-FEB-2013
      *    IF WSS-CIC-TIAU IN WSS-VARI = '952086'
           IF WSS-CIC-TIAU IN WSS-VARI = '952086'  OR
              WSS-CIC-TIAU IN WSS-VARI = '952886'
      *CGA-FIN 05-FEB-2013
      *PVG FIN 15-OCT-2003
              MOVE GTP-COD-IITS IN GTP-FLD TO ACC-COD-NEMO IN ACC
      *PVG INI 15-OCT-2003
      *       MOVE 99999999                TO ACC-FEC-FPRO IN ACC
              MOVE GTP-NUM-SCES IN GTP-FLD TO ACC-NUM-SPRO IN ACC
              MOVE GTP-NUM-ACES IN GTP-FLD TO ACC-NUM-APRO IN ACC
              MOVE GTP-NUM-MCES IN GTP-FLD TO ACC-NUM-MPRO IN ACC
              MOVE GTP-NUM-DCES IN GTP-FLD TO ACC-NUM-DPRO IN ACC
      *PVG FIN 15-OCT-2003
              MOVE FIO-GET-LEQ TO FIO-CMND
              PERFORM BGL-FIO-ACC
              IF NOT (FIO-STAT-OKS AND 
                      ACC-COD-NEMO IN ACC = GTP-COD-IITS IN GTP-FLD)
                   MOVE SPACES TO FRM-COD-LIST IN GTP-FLD
                   MOVE SPACES TO FRM-GLS-LIST IN GTP-FLD
                   MOVE ZEROES TO GTP-SGV-VTSN IN GTP-FLD
                   GO TO FIN-VAL-FRM-COD-LIST
              ELSE
                 MOVE 'BGL' TO TAB-COD-SIST
                 MOVE 'LST' TO TAB-COD-TTAB IN TAB
                 MOVE ACC-COD-LIST IN ACC TO TAB-COD-CTAB IN TAB
                 PERFORM VAL-COD
                 IF MSG-COD-MENS = 'COD    NEX' OR
                 GTP-COD-IITS IN GTP-FLD NOT > SPACES 
                     MOVE SPACES TO FRM-COD-LIST IN GTP-FLD
                     MOVE SPACES TO FRM-GLS-LIST IN GTP-FLD
                     MOVE ZEROES TO GTP-SGV-VTSN IN GTP-FLD
                     GO TO FIN-VAL-FRM-COD-LIST
                 ELSE
                    MOVE TAB-CIC-CTAB IN TAB TO WSS-LISTA IN WSS-VARI                 
                    MOVE ACC-COD-LIST IN ACC TO FRM-COD-LIST IN GTP-FLD
                    MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-LIST IN GTP-FLD
                    GO TO CONTINUA-VALOR
           ELSE
              MOVE SPACES TO FRM-COD-LIST IN GTP-FLD
              MOVE SPACES TO FRM-GLS-LIST IN GTP-FLD
              GO TO FIN-VAL-FRM-COD-LIST.
       CONTINUA-VALOR.
           IF WSS-LISTA IN WSS-VARI NOT = 'A' AND
              WSS-LISTA IN WSS-VARI NOT = 'B' AND
              WSS-LISTA IN WSS-VARI NOT = 'C'
              MOVE 1 TO GTP-SGV-VTSN IN GTP-FLD
           ELSE
              IF ACC-SGV-VCOU IN ACC < ACC-SGV-VCOP IN ACC
                 MOVE ACC-SGV-VCOU IN ACC TO GTP-SGV-VTSN IN GTP-FLD
              ELSE
                 MOVE ACC-SGV-VCOP IN ACC TO GTP-SGV-VTSN IN GTP-FLD. 
      *>>>>
       FIN-VAL-FRM-COD-LIST.
           EXIT.
       
       VAL-GTP-SGV-VTSN SECTION.
       INI-VAL-GTP-SGV-VTSN.
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
           IF WSS-IND-FFMM = WSS-S
               MOVE WSS-COD-SIEM TO WSS-COD-IVDO2
               MOVE WSS-FMT      TO VDO-COD-TIPO IN VDO
               MOVE WSS-COD-IVDO TO VDO-COD-IVDO IN VDO
               MOVE WSS-99999999 TO VDO-FEC-FVDO IN VDO
               MOVE FIO-GET-LEQ TO FIO-CMND
               PERFORM BGL-FIO-VDO
               IF NOT (FIO-STAT-OKS AND
                     VDO-COD-TIPO IN VDO = WSS-FMT AND
                     VDO-COD-IVDO IN VDO = WSS-COD-IVDO)
                  MOVE 'BGL'          TO MSG-COD-SIST
                  MOVE 'VDO    NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GTP-SGV-VTSN
               ELSE
                  PERFORM MOV-VLR-FFMM
                  GO TO FIN-VAL-GTP-SGV-VTSN.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM

           IF GTP-SGV-VTSN IN GTP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GTP-SGV-VTSN.
      *<<<< GTP_SGV_VTSN
      * Obtiene Codigo Vlr Cambio de Pesos Med CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *PVC-INI 14-OCT-2016 - NO REDONDEAR VALOR UNITARIO                
                     MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *              MOVE FRM-SUAR-MAL TO FRM-SUAR
      *          ELSE
      *          IF GDG-COD-VCAM IN GTP-FLD = TAB-COD-CTAB IN TAB   
      *              MOVE GTP-SGV-VTSN IN GTP-FLD TO 
      *                   PES-SGV-DECI IN PES-VARI
      *              PERFORM PES-SCTV
      *              MOVE PES-SGV-ENTE IN PES-VARI TO
      *                   GTP-SGV-VTSN IN GTP-FLD.
      *PVC-FIN 14-OCT-2016 - NO REDONDEAR VALOR UNITARIO                
      *>>>>
       FIN-VAL-GTP-SGV-VTSN.
           EXIT.
       
       VAL-GTP-COD-EITS SECTION.
       INI-VAL-GTP-COD-EITS.
           IF GTP-COD-EITS IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GTP-COD-EITS IN GTP-FLD.
      *<<<< GTP_COD_EITS
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'ES1' TO TAB-COD-TTAB IN TAB.
           MOVE GTP-COD-EITS IN GTP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GTP-COD-EITS IN GTP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-EITS IN GTP-FLD
               GO TO FIN-VAL-GTP-COD-EITS
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-EITS IN GTP-FLD.

           IF SCR-CCPP = 'ING'  
               IF GTP-COD-EITS IN GTP-FLD > '10'
                   MOVE 'EST-ITM>10' TO MSG-COD-MENS
                   GO TO ERR-VAL-GTP-COD-EITS
               ELSE
                   GO TO FIN-VAL-GTP-COD-EITS.

      * CAMBIOS DE ESTADO
            IF GTP-COD-EITS IN GTP-FLD NOT = GAR-EST-ANT
               IF NOT (GTP-COD-EITS IN GTP-FLD = GAR-ES1-1 OR
                       GTP-COD-EITS IN GTP-FLD = GAR-ES1-2 OR
                       GTP-COD-EITS IN GTP-FLD = GAR-ES1-3 OR
                       GTP-COD-EITS IN GTP-FLD = GAR-ES1-4)
                   MOVE 'ESTITMNVOANT' TO MSG-COD-MENS
                   GO TO ERR-VAL-GTP-COD-EITS.
           GO TO FIN-VAL-GTP-COD-EITS.

       ERR-VAL-GTP-COD-EITS.
           MOVE 'BGL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GTP-COD-EITS.
           EXIT.
       
       VAL-FRM-GLS-EITS SECTION.
       INI-VAL-FRM-GLS-EITS.
       FIN-VAL-FRM-GLS-EITS.
           EXIT.
       
       VAL-FRM-GLS-LIST SECTION.
       INI-VAL-FRM-GLS-LIST.
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
      *VERIFICA SI PRODUCTO (TIPO-SUBTIPO) ES FFMM
           IF WSS-IND-FFMM NOT = WSS-S
               GO TO FIN-VAL-FRM-GLS-LIST.
      *OBTIENE GLOSA DE UNIDAD DE MEDIDA PARA FFMM (CENTESIMAS)
           MOVE SPACES              TO FRM-GLS-LIST IN GTP-FLD.
           MOVE 'BGL'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'UMC'               TO TAB-COD-TTAB IN TAB.
           MOVE 'FFMM'              TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE 'UMCFM  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-GLS-LIST.

           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LIST IN GTP-FLD.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM
       FIN-VAL-FRM-GLS-LIST.
           EXIT.
       
       VAL-GTP-SGV-ITSN SECTION.
       INI-VAL-GTP-SGV-ITSN.
           IF GTP-SGV-ITSN IN GTP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GTP-SGV-ITSN.
       FIN-VAL-GTP-SGV-ITSN.
           EXIT.
       
       VAL-GTP-COD-MAND SECTION.
       INI-VAL-GTP-COD-MAND.
           IF GTP-COD-MAND IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GTP-COD-MAND IN GTP-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GTP-COD-MAND IN GTP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-GTP-COD-MAND.
           EXIT.
       
       VAL-GTP-COD-CUST SECTION.
       INI-VAL-GTP-COD-CUST.
           IF GTP-COD-CUST IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GTP-COD-CUST IN GTP-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'CUS ' TO TAB-COD-TTAB IN TAB.
           MOVE GTP-COD-CUST IN GTP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GTP-COD-CUST IN GTP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CUST IN GTP-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CUST IN GTP-FLD.
       FIN-VAL-GTP-COD-CUST.
           EXIT.
       
       VAL-FRM-GLS-CUST SECTION.
       INI-VAL-FRM-GLS-CUST.
       FIN-VAL-FRM-GLS-CUST.
           EXIT.
       
       VAL-GTP-GLS-UBIC SECTION.
       INI-VAL-GTP-GLS-UBIC.
           IF GTP-GLS-UBIC IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GTP-GLS-UBIC IN GTP-FLD.
       FIN-VAL-GTP-GLS-UBIC.
           EXIT.
       
       VAL-GTP-GLS-TIT1 SECTION.
       INI-VAL-GTP-GLS-TIT1.
           IF GTP-GLS-TIT1 IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GTP-GLS-TIT1 IN GTP-FLD.
       FIN-VAL-GTP-GLS-TIT1.
           EXIT.
       
       VAL-GTP-GLS-TIT2 SECTION.
       INI-VAL-GTP-GLS-TIT2.
           IF GTP-GLS-TIT2 IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GTP-GLS-TIT2 IN GTP-FLD.
       FIN-VAL-GTP-GLS-TIT2.
           EXIT.
       
       VAL-GTP-GLS-TIT3 SECTION.
       INI-VAL-GTP-GLS-TIT3.
           IF GTP-GLS-TIT3 IN GTP-FLD NOT > SPACES
              MOVE SPACES TO GTP-GLS-TIT3 IN GTP-FLD.
       FIN-VAL-GTP-GLS-TIT3.
           EXIT.
       
       VAL-CON-FLD-GTP SECTION.
       INI-VAL-CON-FLD-GTP.
       FIN-VAL-CON-FLD-GTP.
           EXIT.
       
       VAL-CON-GTP SECTION.
       INI-VAL-CON-GTP.
       FIN-VAL-CON-GTP.
           EXIT.
       
       VAL-NUM-KEY-GTP SECTION.
       INI-VAL-NUM-KEY-GTP.
           PERFORM VAL-NUM-IKY-GTP.
           PERFORM VAL-NUM-MKY-GTP.
           PERFORM VAL-NUM-AKY-GTP.
       FIN-VAL-NUM-KEY-GTP.
           EXIT.
       
       VAL-NUM-IKY-GTP SECTION.
       INI-VAL-NUM-IKY-GTP.
       VAL-NUM-GTP-IIC-GTIA.
           MOVE GTP-IIC-GTIA-ALF IN GTP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GTP-IIC-GTIA IN GTP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GTP-IIC-GTIA-LEN IN GTP-FLD
                GO TO FIN-VAL-NUM-IKY-GTP.
       VAL-NUM-GTP-NUM-ITSN.
           MOVE GTP-NUM-ITSN-ALF IN GTP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GTP-NUM-ITSN IN GTP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GTP-NUM-ITSN-LEN IN GTP-FLD
                GO TO FIN-VAL-NUM-IKY-GTP.
       VAL-NUM-GTP-COD-ITSN.
           MOVE GTP-COD-ITSN-ALF IN GTP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GTP-COD-ITSN IN GTP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GTP-COD-ITSN-LEN IN GTP-FLD
                GO TO FIN-VAL-NUM-IKY-GTP.
       FIN-VAL-NUM-IKY-GTP.
           EXIT.
       
       VAL-NUM-MKY-GTP SECTION.
       INI-VAL-NUM-MKY-GTP.
       FIN-VAL-NUM-MKY-GTP.
           EXIT.
       
       VAL-NUM-AKY-GTP SECTION.
       INI-VAL-NUM-AKY-GTP.
       FIN-VAL-NUM-AKY-GTP.
           EXIT.
       
       VAL-NUM-FLD-GTP SECTION.
       INI-VAL-NUM-FLD-GTP.
       VAL-NUM-GTP-SGV-VTSN.
           MOVE GTP-SGV-VTSN-ALF IN GTP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO GTP-SGV-VTSN IN GTP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GTP-SGV-VTSN-LEN IN GTP-FLD
                GO TO FIN-VAL-NUM-FLD-GTP.
       VAL-NUM-GTP-SGV-ITSN.
           MOVE GTP-SGV-ITSN-ALF IN GTP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GTP-SGV-ITSN IN GTP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GTP-SGV-ITSN-LEN IN GTP-FLD
                GO TO FIN-VAL-NUM-FLD-GTP.
       FIN-VAL-NUM-FLD-GTP.
           EXIT.
       
       EDT-KEY-GTP SECTION.
       INI-EDT-KEY-GTP.
           PERFORM EDT-IKY-GTP.
           PERFORM EDT-MKY-GTP.
           PERFORM EDT-AKY-GTP.
       FIN-EDT-KEY-GTP.
           EXIT.
       
       EDT-IKY-GTP SECTION.
       INI-EDT-IKY-GTP.
           IF GTP-IIC-GTIA-LEN IN GTP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GTP-IIC-GTIA-LEN IN GTP-FLD
                GO TO FIN-EDT-IKY-GTP.
           MOVE GTP-IIC-GTIA IN GTP-FLD TO GTP-IIC-GTIA-EDT IN GTP-EDT.
           MOVE GTP-IIC-GTIA-EDT IN GTP-EDT TO 
                GTP-IIC-GTIA-ALF IN GTP-FLD.
           IF GTP-NUM-ITSN-LEN IN GTP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GTP-NUM-ITSN-LEN IN GTP-FLD
                GO TO FIN-EDT-IKY-GTP.
           MOVE GTP-NUM-ITSN IN GTP-FLD TO GTP-NUM-ITSN-EDT IN GTP-EDT.
           MOVE GTP-NUM-ITSN-EDT IN GTP-EDT TO 
                GTP-NUM-ITSN-ALF IN GTP-FLD.
           IF GTP-COD-ITSN-LEN IN GTP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GTP-COD-ITSN-LEN IN GTP-FLD
                GO TO FIN-EDT-IKY-GTP.
           MOVE GTP-COD-ITSN IN GTP-FLD TO GTP-COD-ITSN-EDT IN GTP-EDT.
           MOVE GTP-COD-ITSN-EDT IN GTP-EDT TO 
                GTP-COD-ITSN-ALF IN GTP-FLD.
       FIN-EDT-IKY-GTP.
           EXIT.
       
       EDT-MKY-GTP SECTION.
       INI-EDT-MKY-GTP.
       FIN-EDT-MKY-GTP.
           EXIT.
       
       EDT-AKY-GTP SECTION.
       INI-EDT-AKY-GTP.
       FIN-EDT-AKY-GTP.
           EXIT.
       
       EDT-FLD-GTP SECTION.
       INI-EDT-FLD-GTP.
           IF GTP-SGV-VTSN-LEN IN GTP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GTP-SGV-VTSN-LEN IN GTP-FLD
                GO TO FIN-EDT-FLD-GTP.
           MOVE GTP-SGV-VTSN IN GTP-FLD TO GTP-SGV-VTSN-EDT IN GTP-EDT.
           MOVE GTP-SGV-VTSN-EDT IN GTP-EDT TO 
                GTP-SGV-VTSN-ALF IN GTP-FLD.
           IF GTP-SGV-ITSN-LEN IN GTP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GTP-SGV-ITSN-LEN IN GTP-FLD
                GO TO FIN-EDT-FLD-GTP.
           MOVE GTP-SGV-ITSN IN GTP-FLD TO GTP-SGV-ITSN-EDT IN GTP-EDT.
           MOVE GTP-SGV-ITSN-EDT IN GTP-EDT TO 
                GTP-SGV-ITSN-ALF IN GTP-FLD.
       FIN-EDT-FLD-GTP.
           EXIT.
      *RRM-INI JUL-2018 REVALORIZACION DE FFMM
       MOV-VLR-FFMM SECTION.
       INI-MOV-VLR-FFMM.
      * Obtiene Codigo VLR Cambio de Pesos Med CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-MOV-VLR-FFMM.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO.

           IF GDG-COD-VCAM IN GTP-FLD = WSS-COD-PESO
               MOVE VDO-SGV-VVDP IN VDO TO GTP-SGV-VTSN IN GTP-FLD
               GO TO FIN-MOV-VLR-FFMM.

           IF GDG-COD-VCAM IN GTP-FLD = VDO-COD-VCAM IN VDO
               MOVE VDO-SGV-VVDO IN VDO TO GTP-SGV-VTSN IN GTP-FLD
               GO TO FIN-MOV-VLR-FFMM.

           PERFORM CONV-MON-VVDO
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-MOV-VLR-FFMM
           ELSE
               MOVE WSS-SGV-VVDO IN WSS-VARI TO
                                        GTP-SGV-VTSN IN GTP-FLD.
       FIN-MOV-VLR-FFMM.
           EXIT.

       CONV-MON-VVDO SECTION.
       INI-CONV-MON-VVDO.
           MOVE ZEROES       TO WSS-SGV-VVDO IN WSS-VARI.

      *MONEDA VDO <> MONEDA GDG.
           PERFORM GET-FHOY.
           MOVE HOY-FHOY                TO NVC-FCAM.
           MOVE VDO-SGV-VVDO IN VDO     TO NVC-VALO.
           MOVE VDO-COD-VCAM IN VDO     TO NVC-MON1.
           MOVE GDG-COD-VCAM IN GDG     TO NVC-MON2.
           MOVE WSS-C                   TO NVC-IND-ACCI.
           PERFORM PRO-NVC-NCD.
      *OBTENGO VALOR
           MOVE NVC-RESU TO WSS-SGV-VVDO IN WSS-VARI.

       FIN-CONV-MON-VVDO.
           EXIT.
      *RRM-FIN JUL-2018 REVALORIZACION DE FFMM
