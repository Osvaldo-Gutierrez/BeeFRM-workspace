      *
      * BGLBUGSL
      * Version 3.0.1 Nov-2005
      * 15-Jan-19 10:09 PM
      *
       SET-TAG-BGLBUGSL SECTION.
       INI-SET-TAG-BGLBUGSL.
           MOVE
           '<IDNMOD NOM=$BGLBUGSL$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$15-Jan-19 10:09 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGSL.
           EXIT.
           
       RET-ALL-GSL SECTION.
       INI-RET-ALL-GSL.
           PERFORM KEY-ALL-GSL.
           PERFORM RET-DBC-GSL.
           PERFORM RET-GSL-GSL.
       FIN-RET-ALL-GSL.
           EXIT.
       
       RET-DBC-GSL SECTION.
       INI-RET-DBC-GSL.
      *>>>> INI_RET_GDG_GDG
           MOVE DBC-NUM-ICLI IN GSL-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GSL-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GSL-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GET-CLI.
           MOVE DBC-CIC-ICLI IN DBC TO GSL-CIC-DCLI IN GSL.
      *>>>>
       FIN-RET-DBC-GSL.
           EXIT.
       
       RET-GSL-GSL SECTION.
       INI-RET-GSL-GSL.
           MOVE GSL-COD-ORIG IN GSL-FLD TO GSL-COD-ORIG IN GSL.
           MOVE GSL-COD-ESOL IN GSL-FLD TO GSL-COD-ESOL IN GSL.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GSL-NUM-DSOL IN GSL-FLD TO GSL-NUM-DSOL IN GSL.
           MOVE GSL-NUM-MSOL IN GSL-FLD TO GSL-NUM-MSOL IN GSL.
           MOVE GSL-NUM-SSOL IN GSL-FLD TO GSL-NUM-SSOL IN GSL.
           MOVE GSL-NUM-ASOL IN GSL-FLD TO GSL-NUM-ASOL IN GSL.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE GSL-GLS-MOTC IN GSL-FLD TO GSL-GLS-MOTC IN GSL.
           MOVE GSL-COD-USER IN GSL-FLD TO GSL-COD-USER IN GSL.
           MOVE GSL-COD-CTRA IN GSL-FLD TO GSL-COD-CTRA IN GSL.
           MOVE GSL-NUM-NCAR IN GSL-FLD TO GSL-NUM-NCAR IN GSL.
           MOVE GSL-COD-TSOL IN GSL-FLD TO GSL-COD-TSOL IN GSL.
           MOVE GSL-COD-TPRO IN GSL-FLD TO GSL-COD-TPRO IN GSL.
           MOVE GSL-GLS-NCON IN GSL-FLD TO GSL-GLS-NCON IN GSL.
           MOVE GSL-NUM-TCON IN GSL-FLD TO GSL-NUM-TCON IN GSL.
           MOVE GSL-GLS-OBS1 IN GSL-FLD TO GSL-GLS-OBS1 IN GSL.
           MOVE GSL-GLS-OBS2 IN GSL-FLD TO GSL-GLS-OBS2 IN GSL.
       FIN-RET-GSL-GSL.
           EXIT.
       
       KEY-ALL-GSL SECTION.
       INI-KEY-ALL-GSL.
           PERFORM KEY-DBC-GSL.
           PERFORM KEY-GSL-GSL.
       FIN-KEY-ALL-GSL.
           EXIT.
       
       KEY-DBC-GSL SECTION.
       INI-KEY-DBC-GSL.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN GSL-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN GSL-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GSL-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GSL-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-GSL.
           EXIT.
       
       KEY-GSL-GSL SECTION.
       INI-KEY-GSL-GSL.
           MOVE GSL-NUM-SBGL IN GSL-FLD TO GSL-NUM-SBGL IN GSL.
       FIN-KEY-GSL-GSL.
           EXIT.
       
       SCR-CLRA-GSL SECTION.
       INI-SCR-CLRA-GSL.
           PERFORM CLR-KEY-GSL.
           PERFORM CLR-FLD-GSL.
       FIN-SCR-CLRA-GSL.
           EXIT.
       
       CLR-KEY-GSL SECTION.
       INI-CLR-KEY-GSL.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN GSL-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN GSL-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN GSL-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN GSL-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GSL-NUM-SBGL IN GSL-FLD.
       FIN-CLR-KEY-GSL.
           EXIT.
       
       CLR-FLD-GSL SECTION.
       INI-CLR-FLD-GSL.
           MOVE SPACES TO FRM-GLS-NOMC IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-DIRC IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-TELF IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-COMU IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-REGI IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-CIUD IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-ORIG IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-ESOL IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-USER IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-CTRA IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-TSOL IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-TPRO IN GSL-FLD.
           PERFORM CLR-DBC-GSL.
           PERFORM CLR-GSL-GSL.
       FIN-CLR-FLD-GSL.
           EXIT.
       
       CLR-DBC-GSL SECTION.
       INI-CLR-DBC-GSL.
       FIN-CLR-DBC-GSL.
           EXIT.
       
       CLR-GSL-GSL SECTION.
       INI-CLR-GSL-GSL.
           MOVE SPACES TO GSL-COD-ORIG IN GSL-FLD.
           MOVE SPACES TO GSL-COD-ESOL IN GSL-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GSL-FEC-ESOL IN GSL-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GSL-GLS-MOTC IN GSL-FLD.
           MOVE SPACES TO GSL-COD-USER IN GSL-FLD.
           MOVE SPACES TO GSL-COD-CTRA IN GSL-FLD.
           MOVE SPACES TO GSL-NUM-NCAR IN GSL-FLD.
           MOVE SPACES TO GSL-COD-TSOL IN GSL-FLD.
           MOVE SPACES TO GSL-COD-TPRO IN GSL-FLD.
           MOVE SPACES TO GSL-GLS-NCON IN GSL-FLD.
           MOVE ZEROES TO GSL-NUM-TCON IN GSL-FLD.
           MOVE SPACES TO GSL-GLS-OBS1 IN GSL-FLD.
           MOVE SPACES TO GSL-GLS-OBS2 IN GSL-FLD.
       FIN-CLR-GSL-GSL.
           EXIT.
       
       FST-KEY-GSL SECTION.
       INI-FST-KEY-GSL.
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN GSL-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
       FIN-FST-KEY-GSL.
           EXIT.
       
       FST-FLD-GSL SECTION.
       INI-FST-FLD-GSL.
      *<<<< INI_FST_FLD_GSL
      *PVG INI 14-PCT-2003
           IF SCR-CMND = 'CAN'
              MOVE FRM-POS-CURS TO GSL-GLS-MOTC-LEN IN GSL-FLD
           ELSE
           IF SCR-CMND = 'ASO'
              MOVE FRM-POS-CURS TO GSL-GLS-MENS-LEN IN GSL-FLD
           ELSE
      *PVG FIN 14-PCT-2003
      *>>>>
           MOVE -1 TO GSL-COD-ORIG-LEN IN GSL-FLD.
       FIN-FST-FLD-GSL.
           EXIT.
       
       PRO-KEY-GSL SECTION.
       INI-PRO-KEY-GSL.
           PERFORM PRO-MKY-GSL.
       FIN-PRO-KEY-GSL.
           EXIT.
       
       PRO-MKY-GSL SECTION.
       INI-PRO-MKY-GSL.
       FIN-PRO-MKY-GSL.
           EXIT.
       
       PRO-FLD-GSL SECTION.
       INI-PRO-FLD-GSL.
           PERFORM PRO-DBC-GSL.
           PERFORM PRO-GSL-GSL.
       FIN-PRO-FLD-GSL.
           EXIT.
       
       PRO-DBC-GSL SECTION.
       INI-PRO-DBC-GSL.
       FIN-PRO-DBC-GSL.
           EXIT.
       
       PRO-GSL-GSL SECTION.
       INI-PRO-GSL-GSL.
           MOVE FRM-CPIM-AEY TO GSL-COD-ORIG-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO GSL-GLS-MOTC-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO GSL-COD-CTRA-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO GSL-NUM-NCAR-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO GSL-COD-TSOL-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO GSL-COD-TPRO-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO GSL-GLS-NCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO GSL-NUM-TCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO GSL-GLS-OBS1-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO GSL-GLS-OBS2-ATR IN GSL-FLD.
       FIN-PRO-GSL-GSL.
           EXIT.
       
       UNP-KEY-GSL SECTION.
       INI-UNP-KEY-GSL.
           PERFORM UNP-IKY-GSL.
           PERFORM UNP-AKY-GSL.
           PERFORM UNP-MKY-GSL.
       FIN-UNP-KEY-GSL.
           EXIT.
       
       UNP-IKY-GSL SECTION.
       INI-UNP-IKY-GSL.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN GSL-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
      *<<<< FIN_UNP_IKY_GSL
           IF SCR-CCPP NOT = 'ING'
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-STP
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-STP
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-STP
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-STP.
      *>>>>
       FIN-UNP-IKY-GSL.
           EXIT.
       
       UNP-MKY-GSL SECTION.
       INI-UNP-MKY-GSL.
       FIN-UNP-MKY-GSL.
           EXIT.
       
       UNP-AKY-GSL SECTION.
       INI-UNP-AKY-GSL.
           MOVE FRM-CPIM-UBY TO GSL-NUM-SBGL-ATR.
       FIN-UNP-AKY-GSL.
           EXIT.
       
       UNP-FLD-GSL SECTION.
       INI-UNP-FLD-GSL.
           PERFORM UNP-DBC-GSL.
           PERFORM UNP-GSL-GSL.
       FIN-UNP-FLD-GSL.
           EXIT.
       
       UNP-DBC-GSL SECTION.
       INI-UNP-DBC-GSL.
       FIN-UNP-DBC-GSL.
           EXIT.
       
       UNP-GSL-GSL SECTION.
       INI-UNP-GSL-GSL.
           MOVE FRM-CPIM-UBY TO GSL-COD-ORIG-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-GLS-MOTC-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-COD-CTRA-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-NUM-NCAR-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-COD-TSOL-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-COD-TPRO-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-GLS-NCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-NUM-TCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-GLS-OBS1-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-GLS-OBS2-ATR IN GSL-FLD.
      *<<<< FIN_UNP_GSL_GSL
           IF SCR-CMND NOT = 'CAN'
               MOVE FRM-CPIM-AEY       TO GSL-GLS-MOTC-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY       TO GSL-GLS-MOTC-STP.
      
           IF SCR-CMND = 'ING' OR 'MOD'
               GO TO FIN-UNP-GSL-GSL.
      
           MOVE FRM-CPIM-AEY       TO GSL-COD-ORIG-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-COD-ORIG-STP.
           MOVE FRM-CPIM-AEY       TO GSL-COD-CTRA-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-COD-CTRA-STP.
           MOVE FRM-CPIM-AEY       TO GSL-NUM-NCAR-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-NUM-NCAR-STP.
           MOVE FRM-CPIM-AEY       TO GSL-COD-TSOL-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-COD-TSOL-STP.
           MOVE FRM-CPIM-AEY       TO GSL-COD-TPRO-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-COD-TPRO-STP.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-NCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-NCON-STP.
           MOVE FRM-CPIM-AEY       TO GSL-NUM-TCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-NUM-TCON-STP.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-OBS1-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-OBS1-STP.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-OBS2-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-OBS2-STP.
      *CGL-INI  20-AUG-2003 20:35:07 
      *     MOVE FRM-CPIM-AEY       TO GSL-FEC-FAUT-ATR IN GSL-FLD.
      *     MOVE FRM-CPIM-AEY       TO GSL-FEC-FAUT-STP.
      *CGL-FIN  20-AUG-2003 20:35:18 
      *CGL-INI  20-AUG-2003 20:29:33 
      *     MOVE FRM-CPIM-AEY       TO GSL-NUM-SBCO-ATR IN GSL-FLD.
      *     MOVE FRM-CPIM-AEY       TO GSL-NUM-SBCO-STP.
      *CGL-FIN  20-AUG-2003 20:29:44 
      *>>>>
       FIN-UNP-GSL-GSL.
           EXIT.
       
       VAL-MKY-GSL SECTION.
       INI-VAL-MKY-GSL.
       FIN-VAL-MKY-GSL.
           EXIT.
       
       VAL-FLD-GSL SECTION.
       INI-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMC-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-DIRC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-DIRC-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-TELF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TELF-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-COMU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-COMU-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-REGI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-REGI-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-CIUD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CIUD-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-COD-ORIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-COD-ORIG-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-ORIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ORIG-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-COD-ESOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-COD-ESOL-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-ESOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ESOL-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GSL-FEC-ESOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                GSL-FEC-ESOL-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GSL-GLS-MOTC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-GLS-MOTC-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-COD-USER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-COD-USER-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-USER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-USER-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-COD-CTRA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-COD-CTRA-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-CTRA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CTRA-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-NUM-NCAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-NUM-NCAR-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-COD-TSOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-COD-TSOL-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-TSOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TSOL-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-COD-TPRO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-COD-TPRO-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-FRM-GLS-TPRO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TPRO-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-GLS-NCON.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-GLS-NCON-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-NUM-TCON.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-NUM-TCON-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-GLS-OBS1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-GLS-OBS1-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
           PERFORM VAL-GSL-GLS-OBS2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-GLS-OBS2-LEN IN GSL-FLD
                GO TO FIN-VAL-FLD-GSL.
       FIN-VAL-FLD-GSL.
           EXIT.
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-FRM-GLS-DIRC SECTION.
       INI-VAL-FRM-GLS-DIRC.
       FIN-VAL-FRM-GLS-DIRC.
           EXIT.
       
       VAL-FRM-GLS-TELF SECTION.
       INI-VAL-FRM-GLS-TELF.
       FIN-VAL-FRM-GLS-TELF.
           EXIT.
       
       VAL-FRM-GLS-COMU SECTION.
       INI-VAL-FRM-GLS-COMU.
       FIN-VAL-FRM-GLS-COMU.
           EXIT.
       
       VAL-FRM-GLS-REGI SECTION.
       INI-VAL-FRM-GLS-REGI.
       FIN-VAL-FRM-GLS-REGI.
           EXIT.
       
       VAL-FRM-GLS-CIUD SECTION.
       INI-VAL-FRM-GLS-CIUD.
       FIN-VAL-FRM-GLS-CIUD.
           EXIT.
       
       VAL-GSL-COD-ORIG SECTION.
       INI-VAL-GSL-COD-ORIG.
           IF GSL-COD-ORIG IN GSL-FLD NOT > SPACES
              MOVE SPACES TO GSL-COD-ORIG IN GSL-FLD.
      *<<<< GSL_COD_ORIG 
            IF SCR-CMND = 'ING' OR 'MOD'
                  MOVE 'BGL'  TO TAB-COD-SIST
                  MOVE 'ORS ' TO TAB-COD-TTAB IN TAB
                  MOVE GSL-COD-ORIG IN GSL-FLD TO TAB-COD-CTAB IN TAB
                  PERFORM VAL-COD
                  IF MSG-COD-MENS NOT = SPACES
                     GO TO ERROR-GSL-COD-ORIG 
                  ELSE
                     GO TO FIN-VAL-GSL-COD-ORIG
           ELSE
                  GO TO FIN-VAL-GSL-COD-ORIG. 
     
       ERROR-GSL-COD-ORIG.
           MOVE MSG-GLS-DESC  TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>> 
       FIN-VAL-GSL-COD-ORIG.
           EXIT.
       
       VAL-FRM-GLS-ORIG SECTION.
       INI-VAL-FRM-GLS-ORIG.
      *<<<< FRM_GLS_ORIG
           MOVE 'BGL'  TO TAB-COD-SIST. 
           MOVE 'ORS ' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSL-COD-ORIG IN GSL-FLD TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ORIG IN GSL-FLD.
      *>>>>
       FIN-VAL-FRM-GLS-ORIG.
           EXIT.
       
       VAL-GSL-COD-ESOL SECTION.
       INI-VAL-GSL-COD-ESOL.
       FIN-VAL-GSL-COD-ESOL.
           EXIT.
       
       VAL-FRM-GLS-ESOL SECTION.
       INI-VAL-FRM-GLS-ESOL.
      *<<<< FRM_GLS_ESOL
           IF GSL-COD-ESOL IN GSL-FLD NOT > SPACES
              MOVE SPACES              TO FRM-GLS-ESOL IN GSL-FLD
           ELSE
              MOVE 'BGL'  TO TAB-COD-SIST 
              MOVE 'ESO ' TO TAB-COD-TTAB IN TAB                   
              MOVE GSL-COD-ESOL IN GSL-FLD TO TAB-COD-CTAB IN TAB  
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESOL IN GSL-FLD.
      *>>>>
       FIN-VAL-FRM-GLS-ESOL.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-GSL-FEC-ESOL SECTION.
       INI-VAL-GSL-FEC-ESOL.
           IF GSL-FEC-ESOL IN GSL-FLD  NOT > ZEROES
              MOVE ZEROES TO GSL-FEC-ESOL IN GSL-FLD.
       FIN-VAL-GSL-FEC-ESOL.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GSL-GLS-MOTC SECTION.
       INI-VAL-GSL-GLS-MOTC.
           IF GSL-GLS-MOTC IN GSL-FLD NOT > SPACES
              MOVE SPACES TO GSL-GLS-MOTC IN GSL-FLD.
      *<<<< FIN_GSL_GLS_MOTC
      *PVG INI 14-OCT-2003
           IF SCR-CMND = 'CAN' AND
              GSL-GLS-MOTC IN GSL-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSL-GLS-MOTC.
      *PVG FIN 14-OCT-2003
      *>>>>
       FIN-VAL-GSL-GLS-MOTC.
           EXIT.
       
       VAL-GSL-COD-USER SECTION.
       INI-VAL-GSL-COD-USER.
      *<<<< GSL_COD_USER
            IF GSL-COD-USER IN GSL-FLD NOT > SPACES
                MOVE SPACES TO GSL-COD-USER IN GSL-FLD.
      *>>>>
       FIN-VAL-GSL-COD-USER.
           EXIT.
       
       VAL-FRM-GLS-USER SECTION.
       INI-VAL-FRM-GLS-USER.
       FIN-VAL-FRM-GLS-USER.
           EXIT.
       
       VAL-GSL-COD-CTRA SECTION.
       INI-VAL-GSL-COD-CTRA.
           IF GSL-COD-CTRA IN GSL-FLD NOT > SPACES
              MOVE SPACES TO GSL-COD-CTRA IN GSL-FLD.
      *<<<< GSL_COD_CTRA
           MOVE 'BGL'  TO TAB-COD-SIST
           MOVE 'CAR' TO TAB-COD-TTAB IN TAB
           MOVE GSL-COD-CTRA IN GSL-FLD TO TAB-COD-CTAB IN TAB
           PERFORM VAL-COD
           IF MSG-COD-MENS NOT = SPACES
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GSL-COD-CTRA 
           ELSE
              GO TO FIN-VAL-GSL-COD-CTRA.
      *>>>>
       FIN-VAL-GSL-COD-CTRA.
           EXIT.
       
       VAL-FRM-GLS-CTRA SECTION.
       INI-VAL-FRM-GLS-CTRA.
      *<<<< FRM_GLS_CTRA
           MOVE 'BGL'  TO TAB-COD-SIST. 
           MOVE 'CAR' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSL-COD-CTRA IN GSL-FLD TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CTRA IN GSL-FLD.
      *>>>>
       FIN-VAL-FRM-GLS-CTRA.
           EXIT.
       
       VAL-GSL-NUM-NCAR SECTION.
       INI-VAL-GSL-NUM-NCAR.
           IF GSL-NUM-NCAR IN GSL-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSL-NUM-NCAR.
           IF GSL-NUM-NCAR IN GSL-FLD NOT > SPACES
              MOVE SPACES TO GSL-NUM-NCAR IN GSL-FLD.
      *<<<<
           IF GSL-NUM-NCAR IN GSL-FLD NOT > SPACES AND                  
      * EVA-INI / 2008                                                  
              GSL-COD-ORIG IN GSL-FLD NOT = 'M'                         
      * EVA-FIN / 2008                                                  
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-GSL-NUM-NCAR.                             
      *>>>>
       FIN-VAL-GSL-NUM-NCAR.
           EXIT.
       
       VAL-GSL-COD-TSOL SECTION.
       INI-VAL-GSL-COD-TSOL.
           IF GSL-COD-TSOL IN GSL-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSL-COD-TSOL.
      *<<<< GSL_COD_TSOL
            MOVE 'BGL'  TO TAB-COD-SIST
            MOVE 'TSO' TO TAB-COD-TTAB IN TAB
            MOVE GSL-COD-TSOL IN GSL-FLD TO TAB-COD-CTAB IN TAB
            PERFORM VAL-COD
            IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSL-COD-TSOL 
            ELSE
              GO TO FIN-VAL-GSL-COD-TSOL.

      *>>>> 
       FIN-VAL-GSL-COD-TSOL.
           EXIT.
       
       VAL-FRM-GLS-TSOL SECTION.
       INI-VAL-FRM-GLS-TSOL.
      *<<<< FRM_GLS_TSOL
           MOVE 'BGL'  TO TAB-COD-SIST. 
           MOVE 'TSO' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSL-COD-TSOL IN GSL-FLD TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TSOL IN GSL-FLD.
      *>>>>
       FIN-VAL-FRM-GLS-TSOL.
           EXIT.
       
       VAL-GSL-COD-TPRO SECTION.
       INI-VAL-GSL-COD-TPRO.
           IF GSL-COD-TPRO IN GSL-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSL-COD-TPRO.
      *<<<< GSL_COD_TPRO
           MOVE 'BGL'  TO TAB-COD-SIST
           MOVE 'TPR' TO TAB-COD-TTAB IN TAB
           MOVE GSL-COD-TPRO IN GSL-FLD TO TAB-COD-CTAB IN TAB
           PERFORM VAL-COD
           IF MSG-COD-MENS NOT = SPACES
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GSL-COD-TPRO 
           ELSE
              GO TO FIN-VAL-GSL-COD-TPRO.
      *>>>>
       FIN-VAL-GSL-COD-TPRO.
           EXIT.
       
       VAL-FRM-GLS-TPRO SECTION.
       INI-VAL-FRM-GLS-TPRO.
      *<<<< FRM_GLS_CTRA
           MOVE 'BGL'  TO TAB-COD-SIST. 
           MOVE 'TPR' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSL-COD-TPRO IN GSL-FLD TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TPRO IN GSL-FLD.
      *>>>>
       FIN-VAL-FRM-GLS-TPRO.
           EXIT.
       
       VAL-GSL-GLS-NCON SECTION.
       INI-VAL-GSL-GLS-NCON.
           IF GSL-GLS-NCON IN GSL-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSL-GLS-NCON.
       FIN-VAL-GSL-GLS-NCON.
           EXIT.
       
       VAL-GSL-NUM-TCON SECTION.
       INI-VAL-GSL-NUM-TCON.
           IF GSL-NUM-TCON IN GSL-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSL-NUM-TCON.
       FIN-VAL-GSL-NUM-TCON.
           EXIT.
       
       VAL-GSL-GLS-OBS1 SECTION.
       INI-VAL-GSL-GLS-OBS1.
           IF GSL-GLS-OBS1 IN GSL-FLD NOT > SPACES
              MOVE SPACES TO GSL-GLS-OBS1 IN GSL-FLD.
       FIN-VAL-GSL-GLS-OBS1.
           EXIT.
       
       VAL-GSL-GLS-OBS2 SECTION.
       INI-VAL-GSL-GLS-OBS2.
           IF GSL-GLS-OBS2 IN GSL-FLD NOT > SPACES
              MOVE SPACES TO GSL-GLS-OBS2 IN GSL-FLD.
       FIN-VAL-GSL-GLS-OBS2.
           EXIT.
       
       VAL-CON-FLD-GSL SECTION.
       INI-VAL-CON-FLD-GSL.
      *<<<< VAL_CON_FLD_GSL 
      * CANCELAR
           IF SCR-CMND = 'CAN'
               MOVE '02' TO GSL-COD-ESOL IN GSL-FLD
               MOVE SCR-USER TO GSL-COD-USER IN GSL-FLD
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO WSS-NUM-DEDIT
               MOVE HOY-MHOY TO WSS-NUM-MEDIT
               MOVE HOY-SHOY TO WSS-NUM-SEDIT
               MOVE HOY-AHOY TO WSS-NUM-AEDIT
               MOVE WSS-FEC-EDIT TO GSL-FEC-ESOL IN GSL-FLD
               GO TO BUSQ-GLOSA.

      * ACTIVAR SOLICITUD
           IF SCR-CMND NOT = 'ASO'
              GO TO CON-VAL-CON-FLD-GSL.              

           IF GSL-COD-ESOL IN GSL-FLD = '05'
               MOVE '10' TO GSL-COD-ESOL IN GSL-FLD.
           IF GSL-COD-ESOL IN GSL-FLD = '01'
               MOVE '05' TO GSL-COD-ESOL IN GSL-FLD.

           MOVE SCR-USER TO GSL-COD-USER IN GSL-FLD.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO WSS-NUM-DEDIT.
           MOVE HOY-MHOY TO WSS-NUM-MEDIT.
           MOVE HOY-SHOY TO WSS-NUM-SEDIT.
           MOVE HOY-AHOY TO WSS-NUM-AEDIT.
           MOVE WSS-FEC-EDIT TO GSL-FEC-ESOL IN GSL-FLD.

       BUSQ-GLOSA.
      *Glosa de estado.
      *PVG INI 14-OCT-2003
           PERFORM VAL-FRM-GLS-ESOL.
      *PVG FIN 14-OCT-2003
        CON-VAL-CON-FLD-GSL.
      *>>>>
       FIN-VAL-CON-FLD-GSL.
           EXIT.
       
       VAL-CON-GSL SECTION.
       INI-VAL-CON-GSL.
       FIN-VAL-CON-GSL.
           EXIT.
       
       VAL-NUM-KEY-GSL SECTION.
       INI-VAL-NUM-KEY-GSL.
           PERFORM VAL-NUM-IKY-GSL.
           PERFORM VAL-NUM-MKY-GSL.
           PERFORM VAL-NUM-AKY-GSL.
       FIN-VAL-NUM-KEY-GSL.
           EXIT.
       
       VAL-NUM-IKY-GSL SECTION.
       INI-VAL-NUM-IKY-GSL.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GSL-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN GSL-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN GSL-FLD
                GO TO FIN-VAL-NUM-IKY-GSL.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-IKY-GSL.
           EXIT.
       
       VAL-NUM-MKY-GSL SECTION.
       INI-VAL-NUM-MKY-GSL.
       FIN-VAL-NUM-MKY-GSL.
           EXIT.
       
       VAL-NUM-AKY-GSL SECTION.
       INI-VAL-NUM-AKY-GSL.
       VAL-NUM-GSL-NUM-SBGL.
           MOVE GSL-NUM-SBGL-ALF IN GSL-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSL-NUM-SBGL IN GSL-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSL-NUM-SBGL-LEN IN GSL-FLD
                GO TO FIN-VAL-NUM-AKY-GSL.
       FIN-VAL-NUM-AKY-GSL.
           EXIT.
       
       VAL-NUM-FLD-GSL SECTION.
       INI-VAL-NUM-FLD-GSL.
       VAL-NUM-GSL-NUM-TCON.
           MOVE GSL-NUM-TCON-ALF IN GSL-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSL-NUM-TCON IN GSL-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSL-NUM-TCON-LEN IN GSL-FLD
                GO TO FIN-VAL-NUM-FLD-GSL.
       FIN-VAL-NUM-FLD-GSL.
           EXIT.
       
       EDT-KEY-GSL SECTION.
       INI-EDT-KEY-GSL.
           PERFORM EDT-IKY-GSL.
           PERFORM EDT-MKY-GSL.
           PERFORM EDT-AKY-GSL.
       FIN-EDT-KEY-GSL.
           EXIT.
       
       EDT-IKY-GSL SECTION.
       INI-EDT-IKY-GSL.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN GSL-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN GSL-FLD
                GO TO FIN-EDT-IKY-GSL.
           MOVE DBC-NUM-ICLI IN GSL-FLD TO
                DBC-NUM-ICLI-EDT IN GSL-EDT.
           MOVE DBC-NUM-ICLI-EDT IN GSL-EDT TO
                DBC-NUM-ICLI-ALF IN GSL-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-IKY-GSL.
           EXIT.
       
       EDT-MKY-GSL SECTION.
       INI-EDT-MKY-GSL.
       FIN-EDT-MKY-GSL.
           EXIT.
       
       EDT-AKY-GSL SECTION.
       INI-EDT-AKY-GSL.
           IF GSL-NUM-SBGL-LEN IN GSL-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSL-NUM-SBGL-LEN IN GSL-FLD
                GO TO FIN-EDT-AKY-GSL.
           MOVE GSL-NUM-SBGL IN GSL-FLD TO GSL-NUM-SBGL-EDT IN GSL-EDT.
           MOVE GSL-NUM-SBGL-EDT IN GSL-EDT TO 
                GSL-NUM-SBGL-ALF IN GSL-FLD.
       FIN-EDT-AKY-GSL.
           EXIT.
       
       EDT-FLD-GSL SECTION.
       INI-EDT-FLD-GSL.
           IF GSL-NUM-TCON-LEN IN GSL-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSL-NUM-TCON-LEN IN GSL-FLD
                GO TO FIN-EDT-FLD-GSL.
           MOVE GSL-NUM-TCON IN GSL-FLD TO GSL-NUM-TCON-EDT IN GSL-EDT.
           MOVE GSL-NUM-TCON-EDT IN GSL-EDT TO 
                GSL-NUM-TCON-ALF IN GSL-FLD.
       FIN-EDT-FLD-GSL.
           EXIT.
