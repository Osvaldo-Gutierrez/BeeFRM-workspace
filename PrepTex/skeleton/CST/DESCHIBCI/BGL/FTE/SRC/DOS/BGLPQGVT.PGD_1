       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   BGLPQGVT.
       AUTHOR.       BEE.
       DATE-WRITTEN. 22-Jan-19 02:28 AM.

      * NOMBRE PROGRAMA                   BGLPQGVT
      * VERSION PGM                       3.1
      * VERSION SKL                       07.08.21
      * OPCION                            CON
      * ARCHIVO BASE                      BGLGVT
      * PANTALLA                          BGLGVT
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *-----------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: REGULARIZAR MENSAJE EXCEPCION DE LA GVT
      *PROYECTO: ACT. DE EXC.PARA PREPAGOS DE OPERACIONES HIPOT. PREP.
      *FECHA   : ENERO DE 2012
      *AUTOR   : CHC
      *ETIQUETA:
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
      *-----------------------------------------------------------------
      *PROYECTO: MENSAJE TASACION VENCIDA
      *OBJETIVO: VALIDAR QUE MONTO TASACION NO SEA MAYOR A 10000 UF 
      *AUTOR   : BEE-TEAM (PVC)
      *ETIQUETA: PVC-INI 29-Julio-2012 
      *-----------------------------------------------------------------
      *PROYECTO: ADMINISTRACION DE PRENDAS WARRANTS		
      *OBJETIVO: VALOR LIQUIDACION AUTOMATICO	
      *AUTOR   : BEE-TEAM (PVC)
      *ETIQUETA: PVC-INI 19-OCT-2012 
      *-----------------------------------------------------------------
      *PROYECTO: DESVALORIZACION - 51921
      *OBJETIVO: CONTADOR DE RETASACION CON AVALUO FISCAL
      *AUTOR   : BEE-TEAM (PVC)
      *ETIQUETA:
      *PVC-INI 19-NOV-2012  DESVALORIZACION
      *-----------------------------------------------------------------

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-BGLPQGVT-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$BGLPQGVT$ SKL=$07.08.21$ VSN=$06.06.29$        
      -    'GEN=$22-Jan-19 02:28 AM$ FNC=$OWFBGL$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
           03 CMA-VARI.
              05 GAR-CAI-GTIA                     PIC X(04).
              05 GAR-IIC-GTIA                     PIC X(08).
              05 GAR-IND-TPRE                     PIC X(01).
              05 GAR-IND-OMCT                     PIC X(01).
              05 GAR-SGV-PPON     COMP-3          PIC 9(03)V9(2).
              05 GAR-SGV-PAJU     COMP-3          PIC 9(03)V9(2).
              05 GAR-NUM-PVTS                     PIC 9(03).
              05 GAR-COD-TPVT                     PIC X(01).
              05 GAR-IND-GTAC                     PIC X(01). 
              05 GAR-COD-TASN                     PIC 9(03). 
      *<<<< NOT PGM_ARG
              05 WSS-SGV-VCTS     COMP-3           PIC S9(11)V9(4).
              05 WSS-SGV-LTSN     COMP-3           PIC S9(11)V9(4).
              05 WSS-SGV-VPND     COMP-3           PIC S9(11)V9(4).
              05 WSS-SGV-VGAS     COMP-3           PIC S9(11)V9(4).
              05 WSS-VALOR-LIQ    COMP-3           PIC S9(11)V9(4).
      *>>>>
              05 WSS-FEC-FRVL                       PIC 9(08).
              05 WSS-FEC-FTSN                       PIC 9(08).
      ** EVA-INI  10/07
              05 WSS-FEC-FURV                       PIC 9(08).
              05 WSS-FEC-FANR                       PIC 9(08).
      ** EVA-FIN  10/07
              05 WSS-LIQ-CML      COMP-3           PIC S9(1)V9(14).
              05 CMA-CIC-TGAR                      PIC X(06).
              05 CMA-IND-SMEC                      PIC X(01).
      *<<<< GEN_BCI
              05 CMA-IND-APLI                      PIC X(01).
              05 CMA-IND-TSWT                      PIC X(01).
      *>>>>
      *MHM-INI 29-OCT-2003
              05 CMA-CIC-UING                      PIC X(12).
      *MHM-FIN 29-OCT-2003
      ** EVA-INI  10/07
              05 WSS-IND-TASV       VALUE 'N'      PIC X(01).
      ** EVA-FIN  10/07
      *>>>>                                                             
       COPY BGLWIGVT.

       COPY BGLBRGVT.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.

      *PVC-INI 29-JUL-2012 - Mensaje de tasacion Vencida                
           03 WSS-IND-TASC                     PIC X(01).
           03 WSS-GLS-DAT1.
              05 WSS-VAL-TASC                  PIC  9(05).
              05 WSS-RES-DAT1                  PIC  X(05).

           03 WSS-VAL-UF                       PIC S9(11).              
           03 WSS-COD-UF.                                               
              05 WSS-IND-TMUF                  PIC X(01).               
              05 WSS-COD-REUF                  PIC X(05).               
      *PVC-FIN 29-JUL-2012                                              
      *PVC-INI 19-NOV-2012 - DESVALORIZACION
           03 WSS-NUM-FISC    VALUE ZEROES     PIC 9(03).
           03 I               VALUE ZEROES     PIC 9(02).
           03 WSS-GLS-DANE.
              05 WSS-COD-DATA OCCURS 20 TIMES  PIC X(03).
      *PVC-FIN 19-NOV-2012
      ** EVA-INI  10/07
       COPY BGLBRGIM.
       COPY BGLBRTAS.
       COPY BGLBRGSL.
       COPY SGCBRDBC.
      ** EVA-FIN  10/07 
       COPY BGLBRGDG.                                                   
       COPY BGLBRACC.                                                   
       COPY BGLBRGDP.                                                   
      *<<<< GEN_BCI                                                     
       COPY BGLBRGSO.                                                   
      *>>>>                                                             
       COPY TABBRIVB.                                                   
       COPY TABBRUSR. 
      *<<<< GEN_BCI AND PGM_PQ                                          
      *PTC-INI-MAN                                                      
      *COPY BGLWXGVT.                                                   
      *COPY BGLWXGTP.                                                   
      *PTC-FIN-MAN                                                      
      *>>>>  
      *<<<< GEN_BCI                                                     
       COPY BGLWXGTP.                                                   
       COPY BGLWXGVT.                                                   
       COPY BGLBRGDD.                                                   
       COPY COLBROPC.                                                   
       COPY COLBRRDC.                                                   
      *>>>>                                                             
       COPY BGLBRGES.                                                   
       COPY BGLBRGSE.                                                   
       COPY BGLBRGTP.                                                   
       COPY BGLBRTAG.                                                   
       COPY TABBRCAM.                                                   
      *   
       01  WSS-VARI.   
      *AFRI-INI/JUN2006  
           03 WSS-LST-GLOSA.                                            
              05 WSS-LST-PPON                  PIC X(05).               
              05 WSS-LST-RSTO                  PIC X(55).               
           03 WSS-NUM-PPON                     PIC 9(05).               
           03 WSS-VAL-PPON                     PIC S9(03)V9(02).        
           03 WSS-NEM-GLOSA.                                            
              05 WSS-NEM-ACCN                  PIC X(01).               
              05 WSS-NEM-RSTO                  PIC X(59).               
      *AFRI-FIN/JUN2006                                                 
      ** EVA-INI  09/07                                                 
                                                                        
           03 WSS-FEC-FULR.                                             
              05 WSS-NUM-SULR                   PIC 9(02).              
              05 WSS-NUM-AULR                   PIC 9(02).              
              05 WSS-NUM-MULR                   PIC 9(02).              
              05 WSS-NUM-DULR                   PIC 9(02).              
                                                                        
           03 WSS-FEC-FANR.                                             
              05 WSS-NUM-SANR                   PIC 9(02).              
              05 WSS-NUM-AANR                   PIC 9(02).              
              05 WSS-NUM-MANR                   PIC 9(02).              
              05 WSS-NUM-DANR                   PIC 9(02).              
                                                                        
           03 WSS-FEC-FURV.                                             
              05 WSS-NUM-SURV                   PIC 9(02).              
              05 WSS-NUM-AURV                   PIC 9(02).              
              05 WSS-NUM-MURV                   PIC 9(02).              
              05 WSS-NUM-DURV                   PIC 9(02).              
                                                                        
      ** EVA-FIN  09/07                                                 
                                                                        
      ** EVA-INI  10/07

           03 WSS-GLS-APLI.
              05 WSS-IND-TAPL                   PIC X(01).
              05 WSS-IND-SAPL                   PIC X(01).
              05 WSS-IND-IND3                   PIC X(01).
              05 WSS-IND-DAUX                   PIC X(57).

           03 WSS-IND-TNOV   VALUE 'N'          PIC X(01).
           03 WSS-IND-RTAS   VALUE SPACES       PIC X(01).
           03 WSS-IND-ATAS   VALUE SPACES       PIC X(01).

           03 WSS-GLS-VCTO    VALUE SPACES        PIC X(03).
           03 WSS-IND-GSO     VALUE ZEROES        PIC 9(01).
           03 WSS-IND-PVTS                        PIC 9(03).
           03 WSS-IND-TPVT                        PIC X(01).

           03 WSS-COD-CGTA.
              05 WSS-TIP-CGTA                     PIC X(03).
              05 WSS-STP-CGTA                     PIC X(03).

           03 WSS-FEC-FGVT.
              05 WSS-NUM-SGVT        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AGVT        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MGVT        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-DGVT        VALUE ZEROS  PIC 9(02).

           03 WSS-FEC-FVEN.
              05 WSS-NUM-SVEN        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AVEN        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MVEN        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-DVEN        VALUE ZEROS  PIC 9(02).

      ** EVA-FIN  10/07
      ** EVA-INI  11/08
           03 WSS-IND-GTIA     VALUE SPACES       PIC X(01).
           03 WSS-IND-GTAC     VALUE SPACES       PIC X(01).
           03 WSS-IND-ARET     VALUE SPACES       PIC X(01).
           03 WSS-IND-ECRT     VALUE SPACES       PIC X(01).
           03 WSS-IND-GDIA     VALUE SPACES       PIC X(01).
      ** EVA-FIN  11/08
           03 WSS-CIC-TIAU                        PIC X(06).            
           03 WSS-TIPO-AUX.                                             
              05 WSS-TIPO-1                       PIC X(03).            
              05 WSS-AUX-1                        PIC X(03).            
           03 WSS-TIPO-DIV.                                             
              05 WSS-TIPO                          PIC X(03).           
              05 WSS-DIV                           PIC X(03).           
           03 WSS-TSG-OPE.                                              
              05 WSS-COD-TOPE                   PIC X(03).              
              05 WSS-COD-SOPE                   PIC X(03).              
      *                                                                 
           03 WSS-COD-PESO.                                             
              05 WSS-IND-TMON                  PIC X(01).               
              05 WSS-COD-REST                  PIC X(05).               
      *<<<< NOT PGM_ARG                                                 
           03 WSS-VAL-PESO                     PIC S9(11).              
           03 WSS-SGV-VCTS-AUX COMP-3          PIC S9(11)V9(04).        
      *>>>>                                                             
           03 GAR-COD-ITSN                     PIC 9(03).               
           03 WSS-AUX         COMP-3           PIC S9(03)V9(12).        
           03 WSS-IMAL                         PIC 9(01).               
      * EVA-AFRI/MAY2006                                                
           03 WSS-GLS-DATA.                                             
              05 WSS-NUM-FVCT                     PIC 9(03).            
              05 WSS-COD-FVCT                     PIC X(01).            
                                                                        
           03 WSS-NUM-PVTS                     PIC 9(03).               
           03 WSS-COD-TPVT                     PIC X(01).               
           03 WSS-FEC-FECH.                                             
              05 WSS-NUM-STM3                   PIC 9(02).              
              05 WSS-NUM-ATM4                   PIC 9(02).              
              05 WSS-NUM-MTM2                   PIC 9(02).              
              05 WSS-NUM-DTM1                   PIC 9(02).              
           03 WSS-FEC-FTSC.                                             
              05 WSS-NUM-STSC                   PIC 9(02).              
              05 WSS-NUM-ATSC                   PIC 9(02).              
              05 WSS-NUM-MTSC                   PIC 9(02).              
              05 WSS-NUM-DTSC                   PIC 9(02).              
      * FIN-AFRI/MAY2006                                                
      *AFRI-INI/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012
           03 WSS-COD-CMSG                      PIC X(12).
           03 WSS-GLS-CMSG                      PIC X(50).
      *AFRI-FIN/ACT. DE EXC. PARA PREP. DE OPC HIPOTECARIAS/CHC/01-2012                                                                       
      *<<<< GEN_BCI                                                     
           03 WSS-CIC-TOPE    VALUE SPACES      PIC X(03).              
           03 WSS-IND-HIPT    VALUE SPACES      PIC X(01).              
           03 WSS-IND-ENFE    VALUE SPACES      PIC X(01).              
      *    INDICADOR DE EXCEPCION NORMATIVA DE TASACION UNO             
           03 WSS-IND-ENT1    VALUE SPACES      PIC X(01).              
      *    INDICADOR DE EXCEPCION NORMATIVA DE TASACION DOS             
           03 WSS-IND-ENT2    VALUE SPACES      PIC X(01).              
      *    INDICADOR DE EXCEPCION NORMATIVA DE TASACION TRES            
           03 WSS-IND-ENT3    VALUE SPACES      PIC X(01).              
           03 WSS-VAL-SCRE    VALUE ZEROES      PIC 9(13)V9(04).        
      ** EVA-INI  09/07
           03 WSS-FEC-FRVL.                                             
              05 WSS-NUM-SRVL                   PIC 9(02).              
              05 WSS-NUM-ARVL                   PIC 9(02).              
              05 WSS-NUM-MRVL                   PIC 9(02).              
              05 WSS-NUM-DRVL                   PIC 9(02).              
      ** EVA-FIN  09/07
           03 WSS-FEC-FTSN.                                             
              05 WSS-NUM-STSN                   PIC 9(02).              
              05 WSS-NUM-ATSN                   PIC 9(02).              
              05 WSS-NUM-MTSN                   PIC 9(02).              
              05 WSS-NUM-DTSN                   PIC 9(02).              
                                                                        
           03 WSS-FEC-FTRA.                                             
              05 WSS-NUM-STRA                   PIC 9(02).              
              05 WSS-NUM-ATRA                   PIC 9(02).              
              05 WSS-NUM-MTRA                   PIC 9(02).              
              05 WSS-NUM-DTRA                   PIC 9(02).              
      *    03 WSS-IND-TASV       VALUE 'N'      PIC X(01).
      *MHM-INI 23-OCT-2003                                              
           03 WSS-GLS-CGTA.                                             
              05 WSS-GLS-TOPE                   PIC X(40).              
              05 WSS-GLS-SOPE                   PIC X(40).              
      *MHM-FIN 23-OCT-2003                                              
      *>>>>                                                             
      * Variables para determinar vigencia de Tasacion                  
      * deben estar bajo WSS-VARI                                       
       COPY BGLWGEXV.                                                   
       COPY GNSWGPES.                                                   
      *MHM-INI 23-OCT-2003                                              
       COPY GNSWGCPT.                                                   
      *MHM-FIN 23-OCT-2003  
      *<<<< PGM_CHI AND PGM_PQ                                          
       COPY USPC113.   
      *<<<< GEN_BCI                                                     
       COPY BGLWGVCG.                                                   
      *>>>>                                                             
      *<<<< PGM_DTC 
      ** EVA-INI  10/07
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      ** EVA-FIN  10/07
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IVB-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDP-REQA==.        
      *<<<< GEN_BCI                                                     
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.        
      *>>>>                                                             
      *<<<< PGM_PQ                                                      
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.        
      *>>>>                                                             
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSE-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GTP-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.        
      *                                                                 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.        
      *>>>>                                                       
       01 WSS-VARI.
           03 WSS-FEC-FORI.
              05 WSS-NUM-SORI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-AORI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-MORI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-DORI           VALUE ZEROES    PIC 9(02).

           03 WSS-FEC-FMAV.
              05 WSS-NUM-SMAV           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-AMAV           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-MMAV           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-DMAV           VALUE ZEROES    PIC 9(02).

           03 WSS-FEC-FINI.
              05 WSS-NUM-SINI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-AINI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-MINI           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-DINI           VALUE ZEROES    PIC 9(02).

           03 WSS-FEC-FTER.
              05 WSS-NUM-STER           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-ATER           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-MTER           VALUE ZEROES    PIC 9(02).
              05 WSS-NUM-DTER           VALUE ZEROES    PIC 9(02).

           03 WSS-SGV-TINT              VALUE ZEROES    PIC 9(03)V9(04).
           03 WSS-SGV-MNTO              VALUE ZEROES    PIC 9(11)V9(04).
      *    03 WSS-GLS-DATO.
      *       05 WSS-NUM-MAXI           VALUE ZEROES    PIC 9(02).
      *       05 WSS-GLS-DISP           VALUE SPACES    PIC X(08).
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-GVT.
                 88 PGM-STAT-GVT-NUL    VALUE '  '.
                 07 PGM-STT1-GVT        VALUE '2' PIC X(01).
                    88 PGM-STAT-GVT-OKS VALUE '0'.
                 07 PGM-STT2-GVT        VALUE '3' PIC X(01).
              05 PGM-STAT-GDG.
                 88 PGM-STAT-GDG-NUL    VALUE '  '.
                 07 PGM-STT1-GDG        VALUE '2' PIC X(01).
                    88 PGM-STAT-GDG-OKS VALUE '0'.
                 07 PGM-STT2-GDG        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(501).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO GVT-FLD.
           MOVE LOW-VALUES TO GVT-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +501 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'BGLPQGVT' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO                                                     
      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           IF SCR-SISG NOT > SPACES
              MOVE SCR-SIST TO SCR-SISG.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGTP.              
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGVT.              
           MOVE +401 TO SCR-TCMA.
           IF SCR-DESDE-CMN                                             
               MOVE ZEROES TO WSS-FEC-FTSN IN CMA-VARI,                 
                              WSS-FEC-FRVL IN CMA-VARI,                 
      ** EVA-INI  09/07
                              WSS-FEC-FURV IN CMA-VARI,                 
                              WSS-FEC-FANR IN CMA-VARI,                 
      ** EVA-FIN  09/07
                              WSS-LIQ-CML  IN CMA-VARI.                 
      *>>>>                                                             
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-GVT.
           PERFORM EDT-KEY-GVT.
           PERFORM EDT-FLD-GVT.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-MOD.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-GVT
               PERFORM VAL-NUM-FLD-GVT.
           IF FRM-FFLD = FRM-FFLD-PF5 
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           PERFORM GNS-CLR-RQA.
      *>>>>
       MSG-SCR-MOD.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       BRW-SCR-MOD SECTION.
       INI-BRW-SCR-MOD.
       FIN-BRW-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-GVT
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
      *PTC-INI
                        MOVE 'S' TO SCR-IERR
      *PTC-FIN
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 
               PERFORM VAL-NUM-KEY-GVT
               PERFORM VAL-NUM-FLD-GVT
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ELI.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF5 
               PERFORM VAL-NUM-KEY-GVT
               PERFORM VAL-NUM-FLD-GVT
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       BRW-SCR-ELI SECTION.
       INI-BRW-SCR-ELI.
       FIN-BRW-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF FIO-STAT-OKS
                            MOVE SCR-ACTU-MOD TO SCR-ACTU
                            PERFORM PUT-SCR
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FIO-STAT-EOF
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGEOF    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                        IF FIO-STAT = FIO-STAT-NEX
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGNEX    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                            MOVE SCR-ACTU-ING TO SCR-ACTU
      *JSS                  PERFORM CLR-FLD-GVT
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACT
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACT.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACT
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-GVT
               PERFORM VAL-NUM-FLD-GVT.
           IF FRM-FFLD = FRM-FFLD-PF5 
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACT.
           EXIT.

       BRW-SCR-ACT SECTION.
       INI-BRW-SCR-ACT.
       FIN-BRW-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF FRM-STAT-ABT
                    MOVE SPACES TO FRM-MENS
                    PERFORM SCR-MSSG
                    PERFORM DESSCRTRL
                    GO TO FIN-SCR-PGM
                ELSE
                    MOVE SPACES TO FRM-MENS
                    PERFORM FND-KEY
                    IF FIO-STAT = FIO-STAT-NEX
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGNEX    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                    ELSE
                        MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                        PERFORM SCR-TRL
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       BRW-SCR-PGM SECTION.
       INI-BRW-SCR-PGM.
       FIN-BRW-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-GVT
               PERFORM EDT-KEY-GVT
               PERFORM EDT-FLD-GVT
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-GVT
               PERFORM EDT-KEY-GVT
           ELSE
               PERFORM CLR-FLD-GVT
               PERFORM EDT-FLD-GVT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-GVT.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO GVT-FLD.
           MOVE LOW-VALUES TO GVT-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY                                                 
      *<<<< GEN_BCI                                                     
           IF GVT-COD-SDAG IN GVT-FLD > SPACES AND                      
              GVT-IIC-GTIA IN GVT-FLD NOT > ZEROES                      
               MOVE GVT-COD-SDAG IN GVT-FLD TO GVT-COD-SDAG IN GVT      
               MOVE 'GVT-COD-SDAG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GVT                                      
               IF NOT FIO-STAT-OKS                                      
                  MOVE FIO-STAT TO PGM-STAT-GVT                         
                  GO TO FIN-FND-KEY                                     
               ELSE                                                     
                  MOVE GVT-CAI-GTIA IN GVT TO GVT-CAI-GTIA IN GVT-FLD   
                  MOVE GVT-IIC-GTIA IN GVT TO GVT-IIC-GTIA IN GVT-FLD.  
                                                                        
      *RRM-INI 12-MAY-2003  ACTULAZACION COD. ADIC. (PQ)                
      *MHM-INI 23-MAY-2006                                              
      * Llama a Subrutina Validacion Consistencia Garantia              
      *    IF FRM-FFLD = FRM-FFLD-PF5                                   
      *        PERFORM GAR-PRO-VCG                                      
      *        GO TO FIN-FND-KEY.                                       
      *MHM-FIN 23-MAY-2006                                              
                                                                        
      *>>>>                                                             
       BUS-GDG.                                                         
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           MOVE FIO-STAT TO PGM-STAT-GDG.                               
           IF NOT FIO-STAT-OKS                                          
               MOVE 'GDG    NEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
      *<<<< PGM_CHI                                                     
           IF SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON              
               GO TO FIN-VAL-OFI-USP-GVT.                               
           IF SCR-OFRM-SRV                                              
               GO TO FIN-VAL-OFI-USP-GVT.                               
                                                                        
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )        
               GO TO FIN-VAL-OFI-USP-GVT.                               
      *ALD-BCI-INI/07032000                                             
           COPY USPC143.                                                
           MOVE 'BGLGTUCG/CEN' TO USP-PTA-STR.                          
           COPY USPC103.                                                
           IF USP-PERMISO = 'P'                                         
               GO TO FIN-VAL-OFI-USP-GVT.                               
      *    COPY USPC143.                                                
      *ALD-BCI-FIN/07032000                                             
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG                 
               MOVE 'USRNODEOFI' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
       FIN-VAL-OFI-USP-GVT.                                             
      *>>>>                                                             
                                                                        
       FIN-BUS-GDG.                                                     
           IF SCR-CMND = 'RTA' AND                                      
              GDG-IND-EST1 IN GDG = '15'                                
              MOVE 'CMNDNPPG' TO MSG-COD-MENS                           
              GO TO ERR-FND-KEY.                                        
                                                                        
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GVT-FLD.         
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GVT-FLD.         
      *>>>>                                                             
      *BUS-TAB Busca codigo de tabla                                    
           MOVE 'TAB' TO TAB-COD-SIST.                                  
      *     MOVE 'GTA' TO TAB-COD-TTAB IN TAB.                          
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.                           
           MOVE SPACES TO TAB-COD-CTAB IN TAB.                          
      *<<<< FMT_CHI                                                     
           MOVE GDG-TIP-CGTA IN GVT-FLD TO TAG-TIP-AGTA IN TAG.         
           MOVE GDG-STP-CGTA IN GVT-FLD TO TAG-STP-AGTA IN TAG.         
      *>>>>                                                             
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.         
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
               MOVE TAB-CIC-CTAB IN TAB TO CMA-CIC-TGAR IN CMA-VARI     
      *<<<< GEN_BCI                                                     
               MOVE TAB-COD-DAT1 IN TAB-GLS-DAT1(1)                     
                                        TO CMA-IND-APLI IN CMA-VARI     
               MOVE TAB-COD-DAT1 IN TAB-GLS-DAT1(3)                     
                                        TO CMA-IND-TSWT IN CMA-VARI     
      *>>>>                                                             
      *MHM-INI 23-OCT-2003                                              
      *         MOVE TAB-GLS-DESC IN TAB TO                             
      *              FRM-GLS-CGTA IN GVT-FLD                            
      *     ELSE                                                        
      *         MOVE SPACES TO FRM-GLS-CGTA IN GVT-FLD.                 
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.                 
                                                                        
           IF GDG-TIP-CGTA IN GVT-FLD > SPACES                          
               MOVE 'TAB'                   TO TAB-COD-SIST             
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB      
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB      
               MOVE GDG-TIP-CGTA IN GVT-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI 
           ELSE                                                         
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.                 
                                                                        
           MOVE WSS-GLS-CGTA TO CPT-STRN.                               
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GVT-FLD.                    
      *MHM-FIN 23-OCT-2003                                              
                                                                        
      * Busca Glosa Tabla Real/no Real                                  
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
                MOVE 'TAG    NEX' TO MSG-COD-MENS                       
                MOVE 'BGL' TO MSG-COD-SIST                              
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
           ELSE                                                         
           MOVE TAG-IND-TPRE IN TAG TO GAR-IND-TPRE IN CMA-VARI         
           MOVE TAG-IND-OMCT IN TAG TO GAR-IND-OMCT IN CMA-VARI         
           MOVE TAG-SGV-PPON IN TAG TO GAR-SGV-PPON IN CMA-VARI         
           MOVE TAG-SGV-PAJU IN TAG TO GAR-SGV-PAJU IN CMA-VARI         
           MOVE TAG-NUM-PVTS IN TAG TO GAR-NUM-PVTS IN CMA-VARI         
           MOVE TAG-COD-TPVT IN TAG TO GAR-COD-TPVT IN CMA-VARI         
                                                                        
           MOVE SPACES              TO MSG-COD-MENS                     
           MOVE 'BGL'               TO TAB-COD-SIST                     
           MOVE 'RAL'               TO TAB-COD-TTAB IN TAB              
           MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB              
           PERFORM BUS-TAB                                              
           IF MSG-COD-MENS = SPACES                                     
              MOVE TAB-GLS-DESC IN TAB TO                               
                                   FRM-GLS-TREA IN GVT-FLD              
           ELSE                                                         
              MOVE SPACES TO FRM-GLS-TREA IN GVT-FLD.                   
                                                                        
                                                                        
      * No encontro TAG o Tabla RAL                                     
           IF MSG-COD-MENS > SPACES                                     
               GO TO ERR-FND-KEY.                                       
                                                                        
           MOVE GDG-CAI-GTIA IN GDG TO GAR-CAI-GTIA IN CMA-VARI.        
           MOVE GDG-IIC-GTIA IN GDG TO GAR-IIC-GTIA IN CMA-VARI.        
           MOVE GDG-IND-GTAC IN GDG TO GAR-IND-GTAC IN CMA-VARI.        
           MOVE GDG-COD-TSCN IN GDG TO GAR-COD-TASN IN CMA-VARI.        
           IF (SCR-CMND = 'ING' OR SCR-CMND = 'INE')                    
               PERFORM PUT-GDG-GVT.                                     
                                                                        
      * Valida Este permitido esta Entidad para Tipo-Subtipo            
           IF TAG-IND-EGVT IN TAG = 'N'                                 
               MOVE 'TAG    NOPGM' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
                                                                        
      * Busca ultima Tasacion                                           
           IF SCR-CCPP NOT = 'ING'                                      
               IF GVT-COD-TASN IN GVT-FLD < 1                           
                   MOVE GAR-COD-TASN IN CMA-VARI TO                     
                        GVT-COD-TASN IN GVT-FLD                         
                                                                        
      *            Busca ultimo Item                                    
                   PERFORM BUS-ULT-GTP                                  
               ELSE                                                     
                   PERFORM BUS-ULT-GTP.                                 
      *<<<< GEN_BCI                                                     
           IF ((SCR-CMND = 'ING' OR SCR-CMND = 'INE') AND               
              (GAR-IND-GTAC IN CMA-VARI NOT = 'S'))                     
               MOVE GVT-CAI-GTIA IN GVT-FLD TO GSO-CAI-GTIA IN GSO      
               MOVE GVT-IIC-GTIA IN GVT-FLD TO GSO-IIC-GTIA IN GSO      
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GSO                                      
               IF FIO-STAT-OKS AND GSO-COD-ESGA IN GSO NOT < '06'       
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   MOVE 'GVTNIGSO>=06' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY.                                   
                                                                        
           IF SCR-CMND = 'MOD' AND GAR-IND-GTAC IN CMA-VARI NOT = 'S'   
               MOVE GVT-CAI-GTIA IN GVT-FLD TO GSO-CAI-GTIA IN GSO      
               MOVE GVT-IIC-GTIA IN GVT-FLD TO GSO-IIC-GTIA IN GSO      
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GSO                                      
               IF FIO-STAT-OKS                                          
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   MOVE 'GVT  NMGSO' TO MSG-COD-MENS                    
                   GO TO ERR-FND-KEY.                                   
                                                                        
           IF SCR-CMND = 'ELI' AND GAR-IND-GTAC IN CMA-VARI NOT = 'S'   
               MOVE GVT-CAI-GTIA IN GVT-FLD TO GSO-CAI-GTIA IN GSO      
               MOVE GVT-IIC-GTIA IN GVT-FLD TO GSO-IIC-GTIA IN GSO      
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GSO                                      
               IF FIO-STAT-OKS AND GSO-COD-ESGA IN GSO NOT < '06'       
                   MOVE 'BGL' TO MSG-COD-SIST                           
                   MOVE 'GVTNEGSO>=06' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY.                                   
      *>>>>                                                             
      *>>>>                                                             
           PERFORM KEY-ALL-GVT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GVT.
           IF FIO-STAT-OKS
               MOVE GVT-STP-ITRN IN GVT TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-GVT.
      *<<<< FIN_FND_KEY                                                 
       EXA-COM-STAT.                                                    
      * Comando consulta error lo trata el genesis                      
           IF SCR-CCPP = 'ACC' AND                                      
              SCR-STPP = SCR-STAT-CON                                   
              GO TO FIN-FND-KEY.                                        
                                                                        
      * Garantia alzada                                                 
           IF GDG-IND-EST1 IN GDG > '19'                                
              MOVE 'GDGALZ' TO MSG-COD-MENS                             
              GO TO ERR-FND-KEY.                                        
                                                                        
      *MHM-INI 14-OCT-2003                                              
      * Solo Garantias Activadas                                        
           IF SCR-CMND = 'MTA' AND                                      
             ( GDG-IND-EST1 IN GDG < '10' OR                            
               GDG-IND-GTAC IN GDG NOT = 'S' )                          
               MOVE 'GDG    NOAGA' TO MSG-COD-MENS                      
               GO TO ERR-FND-KEY.                                       
      *MHM-FIN 14-OCT-2003                                              
                                                                        
      * Comando ingreso se valido en fin-val-con-iky                    
      * Error lo trata el genesis                                       
           IF SCR-CCPP = 'ING'                                          
              GO TO FIN-FND-KEY.                                        
                                                                        
      * Comandos no ingreso, no encontro registro                       
      * Error lo trata el genesis                                       
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-FND-KEY.                                        
                                                                        
      * Comando modificacion datos informativos ultima tasacion         
           IF SCR-CMND = 'MTA' AND                                      
              GVT-COD-TASN IN GVT-FLD = GDG-COD-TSCN IN GDG             
               GO TO FIN-FND-KEY.                                       
                                                                        
      * No permite actuar sobre tasacion antigua                        
           IF GVT-COD-TASN IN GVT-FLD < GDG-COD-TSCN IN GDG             
               MOVE 'TSNNOVIG' TO MSG-COD-MENS                          
               GO TO ERR-FND-KEY.                                       
                                                                        
      * Se intenta modificar, no activar                                
           IF SCR-CCPP = 'MOD' AND SCR-CMND = 'MOD'                     
               IF GDG-IND-GTAC IN GDG NOT = 'S'                         
      *            SE PERMITE MODIFICAR GARANTIA NO ACTIVADA            
                   GO TO FIN-FND-KEY                                    
               ELSE                                                     
                   MOVE 'GDG    AGAYA' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY.                                   
                                                                        
      *MHM-INI 14-OCT-2003                                              
           IF SCR-CMND NOT = 'RTF'                                      
               GO TO CNT-CMN-RTF.                                       
                                                                        
           PERFORM OBT-VALOR-MONNAC.                                    
           IF MSG-COD-MENS > SPACES                                     
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF GDG-COD-VCAM IN GDG = WSS-COD-PESO IN WSS-VARI            
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'RTF NOPESO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO ERR-FND-KEY.                                       
                                                                        
           IF FRM-IND-GTP IN GVT-FLD = 'S'                              
               MOVE 'BGL'         TO MSG-COD-SIST                       
               MOVE 'RTF  NOGTP'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO ERR-FND-KEY.                                       
                                                                        
       CNT-CMN-RTF.                                                     
      *MHM-FIN 14-OCT-2003                                              
      *MHM-INI 11-SEP-2003                                              
      *     IF SCR-CMND = 'RTA' OR SCR-CMND = 'RVL'                     
           IF SCR-CMND = 'RTA' OR SCR-CMND = 'RVL' OR SCR-CMND = 'RTF'  
      *MHM-FIN 11-SEP-2003                                              
               IF GVT-MSC-STAT IN GVT NOT = 'A'                         
                 IF FRM-IND-GTP IN GVT-FLD = 'N'                        
                   MOVE 'GTP    NOING' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY                                    
                 ELSE                                                   
                   MOVE 'ATANO' TO MSG-COD-MENS                         
                   GO TO ERR-FND-KEY                                    
               ELSE                                                     
               IF GDG-IND-GTAC IN GDG = 'S'                             
                   PERFORM SLV-VAL-ANT                                  
      *MHM-INI 10-OCT-2003                                              
                   GO TO FIN-FND-KEY                                    
      *MHM-FIN 10-OCT-2003                                              
                                                                        
               ELSE                                                     
                   MOVE 'GDG    NOAGA' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY.                                   
                                                                        
      * Examina si tiene tasaciones parciales                           
           IF FRM-IND-GTP IN GVT-FLD = 'S'                              
               GO TO EXA-SI-GTP.                                        
                                                                        
      * No tiene tasaciones parciales ya ingresadas                     
      * Se intenta activar                                              
           IF SCR-CMND = 'ATA'                                          
      *        comando solo para tasaciones parciales                   
               MOVE 'ATASINGTP' TO MSG-COD-MENS                         
               GO TO ERR-FND-KEY                                        
           ELSE                                                         
      *    Se intenta eliminar                                          
           IF SCR-CMND = 'ELI'                                          
               IF GDG-IND-GTAC IN GDG NOT = 'S'                         
      *        se permite eliminar, garantia no activada                
                   GO TO FIN-FND-KEY                                    
               ELSE                                                     
                   MOVE 'GDG    AGAYA' TO MSG-COD-MENS                  
                   GO TO ERR-FND-KEY                                    
           ELSE                                                         
      *        comando desconocido                                      
               MOVE 'CMNOSITNEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
      * Si tiene tasaciones parciales                                   
       EXA-SI-GTP.                                                      
                                                                        
      *    se intenta activar                                           
           IF SCR-CMND = 'ATA'                                          
                                                                        
      *        se permite activar, tasacion no activada                 
               IF GVT-MSC-STAT IN GVT NOT = 'A'                         
                                                                        
      *            si garantia completa se salva campos anteriores      
                   IF GDG-IND-GTAC IN GDG = 'S'                         
                       PERFORM SLV-VAL-ANT                              
                       GO TO FIN-FND-KEY                                
                   ELSE                                                 
                       GO TO FIN-FND-KEY                                
               ELSE                                                     
                   MOVE 'ATAYA' TO MSG-COD-MENS                         
                   GO TO ERR-FND-KEY                                    
           ELSE                                                         
           IF SCR-CMND = 'ELI'                                          
               IF GDG-IND-GTAC IN GDG NOT = 'S'                         
      *            se permite eliminar, garantia no activada            
                   GO TO FIN-FND-KEY                                    
               ELSE                                                     
      *            no permite eliminar por garantia y tasacion activadas
                   MOVE 'ATAYA' TO MSG-COD-MENS                         
                   GO TO ERR-FND-KEY                                    
           ELSE                                                         
      *        comando desconocido                                      
               MOVE 'CMNOSITNEX' TO MSG-COD-MENS                        
               GO TO ERR-FND-KEY.                                       
                                                                        
       ERR-CMN-STAT.                                                    
           MOVE 'CMNOSITNEX' TO MSG-COD-MENS.                           
           GO TO ERR-FND-KEY.                                           
                                                                        
       ERR-FND-KEY.                                                     
           MOVE 'BGL' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE SCR-STAT-ABT TO SCR-STAT.                               
           IF SCR-CCPP = 'ING'                                          
               MOVE '00' TO FIO-STAT                                    
           ELSE                                                         
               MOVE FIO-STAT-NEX TO FIO-STAT.                           
                                                                        
      *>>>>                                                             
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-GVT-OKS
               MOVE GVT-STP-ITRN IN GVT TO SCR-UMOD.
           PERFORM PUT-ALL-GVT.
      *<<<< FIN_PUT_SCR                                                 
      *PTC-INI-MAN                                                      
           MOVE SPACES TO WSX-TAB-GTP.                                  
           IF NOT SCR-OFRM-SRV                                          
              GO TO LUP-PUT-GTP-SIN-PTC.                                
           MOVE ZEROES TO WSX-IDX-GTP.                                  
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP.         
      *     MOVE ZEROES                 TO GAR-COD-TSN  IN GTP.         
           MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP.         
           MOVE ZEROES                  TO GTP-COD-ITSN IN GTP.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-PUT-ALL-GTP-PTC.                                             
      *  Se posiciona por la llave del hijo                             
      *     MOVE 'GAR-CLV-GTP-1' TO FIO-AKEY.                           
           PERFORM BGL-FIO-GTP.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                 GVT-CAI-GTIA IN GVT-FLD = GTP-CAI-GTIA IN GTP AND      
                 GVT-IIC-GTIA IN GVT-FLD = GTP-IIC-GTIA IN GTP AND      
                 GVT-COD-TASN IN GVT-FLD = GTP-NUM-ITSN IN GTP)         
                GO TO END-PUT-ALL-GTP-PTC.                              
                                                                        
                                                                        
           ADD 1 TO WSX-IDX-GTP                                         
                                                                        
           MOVE GTP-COD-ITSN IN GTP TO                                  
                   WSX-COD-ITSN IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-NUM-DCES IN GTP TO                                  
                   WSX-NUM-DCES IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-NUM-MCES IN GTP TO                                  
                   WSX-NUM-MCES IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-NUM-SCES IN GTP TO                                  
                   WSX-NUM-SCES IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-NUM-ACES IN GTP TO                                  
                   WSX-NUM-ACES IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-SGV-ITSN IN GTP TO                                  
                   WSX-SGV-ITSN IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-COD-IITS IN GTP TO                                  
                   WSX-COD-IITS IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-SGV-VTSN IN GTP TO                                  
               WSX-SGV-VTSN-RED IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
           MOVE GTP-COD-EITS IN GTP TO                                  
                   WSX-COD-EITS IN WSX-FRM-GTP-IDX(WSX-IDX-GTP).        
                                                                        
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-PUT-ALL-GTP-PTC.                                   
                                                                        
       END-PUT-ALL-GTP-PTC.                                             
                                                                        
                                                                        
           MOVE WSX-NOM-TSGTP  TO QUE-COLA.                             
           MOVE QUE-DEL        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
                                                                        
           MOVE WSX-NOM-TSGTP  TO QUE-COLA.                             
           MOVE WSX-LEN-TSGTP  TO QUE-LITM.                             
           MOVE WSX-TAB-GTP    TO QUE-ITEM.                             
           MOVE QUE-PUT        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
                                                                        
       LUP-PUT-GTP-SIN-PTC.                                             
      *PTC-FIN-MAN                                                      
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE GVT-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO GVT-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GKEY
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-GVT
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO GVT-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-GVT
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-GVT.
           PERFORM VAL-IKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-GVT.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-GVT.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-GVT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-GVT
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO GVT-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-GVT
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-GVT.
           PERFORM VAL-IKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-GVT.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-GVT.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-GVT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO GVT-GLS-MEN2
               MOVE SCR-PRMT     TO GVT-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO GVT-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO GVT-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE GVT-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO GVT-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-GVT

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO GVT-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO GVT-GLS-MENS.
           PERFORM PRO-MKY-GVT.
           PERFORM PRO-AKY-GVT.
           PERFORM UNP-IKY-GVT.
           PERFORM FST-KEY-GVT.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE GVT-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO GVT-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO GVT-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO GVT-GLS-MENS.
           PERFORM UNP-KEY-GVT.
           PERFORM FST-KEY-GVT.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-GVT.
           PERFORM PRO-AKY-GVT.
           PERFORM UNP-MKY-GVT.
           PERFORM UNP-FLD-GVT.
           PERFORM FST-FLD-GVT.
      *>>>> FIN_HBL_FLD                                                 
           IF SCR-CMND = 'RTA'                                          
           MOVE FRM-CPIM-UBY TO GVT-COD-SDAG-ATR.                       
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO GVT-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-GVT.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-GVT
               PERFORM EDT-FLD-GVT
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-GVT
               PERFORM EDT-FLD-GVT
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-GVT.
           PERFORM EDT-FLD-GVT.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY BGLBQGVT.
       COPY GNSBVNUM.
       COPY BGLBFGVT.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBFOFI.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       GNS-CLR-RQA SECTION.
       INI-GNS-CLR-RQA.
       FIN-GNS-CLR-RQA.
           EXIT.
      *>>>>
      *<<<< EOF AND PGM_DTC
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
      *<<<< EOF                                                         
      *MHM-INI 11-SEP-2003                                              
       OBT-VALOR-MONNAC SECTION.                                        
       OBT-VALOR-MONNAC-INI.                                            
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'CICPESONEX'   TO MSG-COD-MENS IN MSG               
               GO TO OBT-VALOR-MONNAC-FIN.                              
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.        
       OBT-VALOR-MONNAC-FIN.                                            
           EXIT.                                                        
      *MHM-FIN 11-SEP-2003                                              
      *<<<< PGM_PQ                                                      
       BUS-ULT-GTP SECTION.                                             
       INI-BUS-ULT-GTP.                                                 
           MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP.         
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP.         
           MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP.         
           MOVE 'GTP-KEY-IGTP' TO FIO-AKEY.                             
           MOVE '00' TO FIO-STAT.                                       
           MOVE 9999        TO GTP-COD-ITSN IN GTP.                     
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM BGL-FIO-GTP.                                         
           IF FIO-STAT-OKS AND                                          
              GVT-CAI-GTIA IN GVT-FLD = GTP-CAI-GTIA IN GTP AND         
              GVT-IIC-GTIA IN GVT-FLD = GTP-IIC-GTIA IN GTP AND         
              GVT-COD-TASN IN GVT-FLD = GTP-NUM-ITSN IN GTP             
                                                                        
               MOVE GTP-COD-ITSN IN GTP TO                              
                              FRM-NUM-GTP IN GVT-FLD                    
               MOVE 'S'    TO FRM-IND-GTP IN GVT-FLD                    
           ELSE                                                         
               MOVE SPACES TO FRM-IND-GTP IN GVT-FLD                    
               MOVE ZEROES TO FRM-NUM-GTP IN GVT-FLD.                   
       FIN-BUS-ULT-GTP.                                                 
           EXIT.                                                        
                                                                        
       SLV-VAL-ANT SECTION.                                             
       INI-SLV-VAL-ANT.                                                 
           MOVE GVT-SGV-LTSN IN GVT TO WSS-SGV-LTSN IN CMA-VARI.        
           MOVE GVT-SGV-VCTS IN GVT TO WSS-SGV-VCTS IN CMA-VARI.        
           MOVE GVT-SGV-VPND IN GVT TO WSS-SGV-VPND IN CMA-VARI.        
           MOVE GVT-FEC-FRVL IN GVT TO WSS-FEC-FRVL IN CMA-VARI.        
      *MHM-INI 17-OCT-2003                                              
      *     MOVE GVT-SGV-VPND IN GVT TO WSS-SGV-VGAS IN CMA-VARI.       
           MOVE GVT-SGV-VGAS IN GVT TO WSS-SGV-VGAS IN CMA-VARI.        
      *MHM-FIN 17-OCT-2003                                              
           MOVE GVT-FEC-FTSN IN GVT TO WSS-FEC-FTSN IN CMA-VARI.        
      *EVA-INI  09/07                                                   
                                                                        
           MOVE GVT-FEC-FURV IN GVT TO WSS-FEC-FURV IN CMA-VARI.        
           IF WSS-FEC-FTSN IN CMA-VARI > WSS-FEC-FRVL IN CMA-VARI       
              MOVE WSS-FEC-FTSN IN CMA-VARI TO                          
                   WSS-FEC-FANR IN CMA-VARI                             
           ELSE                                                         
              MOVE WSS-FEC-FRVL IN CMA-VARI TO                          
                   WSS-FEC-FANR IN CMA-VARI.                            
                                                                        
           IF WSS-FEC-FURV IN CMA-VARI > WSS-FEC-FANR IN CMA-VARI       
              MOVE WSS-FEC-FURV IN CMA-VARI TO                          
                   WSS-FEC-FANR IN CMA-VARI.                            
                                                                        
      *EVA-FIN  09/07                                                   
                                                                        
       FIN-SLV-VAL-ANT.                                                 
           EXIT.                                                        
                                                                        
      *>>>>                                                             
      *<<<< GEN_BCI                                                     
       OBT-VAL-RTF SECTION.                                             
       INI-OBT-VAL-RTF.                                                 
      ** EVA-INI  09/07
           IF GVT-FEC-FTSN IN GVT > GVT-FEC-FRVL IN GVT                 
              MOVE GVT-FEC-FTSN IN GVT TO WSS-FEC-FULR                  
           ELSE                                                         
              MOVE GVT-FEC-FRVL IN GVT TO WSS-FEC-FULR.                 
                                                                        
           IF GVT-FEC-FURV IN GVT > WSS-FEC-FULR                        
              MOVE GVT-FEC-FURV IN GVT TO WSS-FEC-FULR.                 
                                                                        
           MOVE WSS-NUM-SULR   TO CAM-NUM-SCAM IN CAM(1).               
           MOVE WSS-NUM-AULR   TO CAM-NUM-ACAM IN CAM(1).               
           MOVE WSS-NUM-MULR   TO CAM-NUM-MCAM IN CAM(1).               
           MOVE WSS-NUM-DULR   TO CAM-NUM-DCAM IN CAM(1).               
      ** EVA-FIN  09/07
                                                                        
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE GDG-COD-VCAM IN GVT-FLD  TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT (                                                     
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'                
              )                                                         
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-OBT-VAL-RTF.                                   
                                                                        
           MULTIPLY GVT-SGV-LTSN IN GVT-FLD                             
                     BY CAM-SGV-VCAM    IN CAM                          
                 GIVING WSS-VAL-PESO ROUNDED.                           
           MOVE WSS-VAL-PESO TO GVT-SGV-LTSN IN GVT.                    
                                                                        
           MULTIPLY GVT-SGV-VCTS IN GVT-FLD                             
                     BY CAM-SGV-VCAM    IN CAM                          
                 GIVING WSS-VAL-PESO ROUNDED.                           
           MOVE WSS-VAL-PESO TO GVT-SGV-VCTS IN GVT.                    
                                                                        
           MULTIPLY GVT-SGV-VPND IN GVT-FLD                             
                     BY CAM-SGV-VCAM    IN CAM                          
                 GIVING WSS-VAL-PESO ROUNDED.                           
           MOVE WSS-VAL-PESO TO GVT-SGV-VPND IN GVT.                    
                                                                        
           MULTIPLY GVT-SGV-VGAS IN GVT-FLD                             
                     BY CAM-SGV-VCAM    IN CAM                          
                 GIVING WSS-VAL-PESO ROUNDED.                           
           MOVE WSS-VAL-PESO TO GVT-SGV-VGAS IN GVT.                    
       FIN-OBT-VAL-RTF.                                                 
           EXIT.                                                        
                                                                        
       EXC-NOR-TAS SECTION.                                             
       INI-EXC-NOR-TAS.                                                 
           IF GDG-COD-LGTA IN GDG = 'E'                                 
               PERFORM GAR-ESP                                          
           ELSE                                                         
               PERFORM GAR-GRL.                                         
       FIN-EXC-NOR-TAS.                                                 
           EXIT.                                                        
                                                                        
       GAR-ESP SECTION.                                                 
       INI-GAR-ESP.                                                     
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.                     
           MOVE 'S'    TO WSS-IND-HIPT IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENFE IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT1 IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT2 IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT3 IN WSS-VARI.                     
                                                                        
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.             
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.             
           MOVE ZEROES TO GES-NUM-IGES IN GES.                          
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-GAR-ESP.                                                     
           PERFORM BGL-FIO-GES.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GES-CAI-GTIA IN GES = GDG-CAI-GTIA AND                    
              GES-IIC-GTIA IN GES = GDG-IIC-GTIA )                      
      ***********************************
              IF FIO-STAT-OKS OR FIO-STAT-EOF
                 MOVE FIO-END-BRW TO FIO-CMND
                 PERFORM BGL-FIO-GES
                 GO TO CNT-GAR-ESP
              ELSE
      ***********************************
               GO TO CNT-GAR-ESP.                                       
                                                                        
           MOVE GES-CAI-IOPC IN GES TO OPC-CAI-IOPC IN OPC.             
           MOVE GES-IIC-IOPC IN GES TO OPC-IIC-IOPC IN OPC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-GAR-ESP.                                       
                                                                        
      *MHM-INI 22-OCT-2003                                              
           IF OPC-MSC-STAT IN OPC NOT = 'A' OR                          
              OPC-VAL-SCRE IN OPC NOT > ZEROES                          
               GO TO NXT-GAR-ESP.                                       
      *MHM-FIN 22-OCT-2003                                              
                                                                        
           IF OPC-MSC-STAT IN OPC = 'A'                                 
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.     
                                                                        
           IF OPC-COD-TOPC IN OPC NOT = 'F'                             
               MOVE 'N' TO WSS-IND-HIPT IN WSS-VARI                     
               PERFORM CMP-FEC.                                         
                                                                        
       NXT-GAR-ESP.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-GAR-ESP.                                           
                                                                        
       CNT-GAR-ESP.                                                     
           IF WSS-VAL-SCRE IN WSS-VARI NOT > ZEROES                     
               MOVE 'S' TO WSS-IND-ENT1 IN WSS-VARI.                    
                                                                        
           IF WSS-IND-HIPT IN WSS-VARI = 'S'                            
               MOVE 'S' TO WSS-IND-ENT2 IN WSS-VARI.                    
                                                                        
           IF WSS-IND-ENFE IN WSS-VARI = 'S'                            
               MOVE 'S' TO WSS-IND-ENT3 IN WSS-VARI.                    
                                                                        
       FIN-GAR-ESP.                                                     
           EXIT.                                                        
                                                                        
       CMP-FEC SECTION.                                                 
       INI-CMP-FEC.                                                     
           PERFORM LEE-TIO.                                             
           IF WSS-CIC-TOPE IN WSS-VARI = '951'                          
               MOVE 2 TO FEC-NANO                                       
           ELSE                                                         
               MOVE 1 TO FEC-NANO.                                      
           PERFORM LEE-GVT.                                             
           IF WSS-FEC-FTSN IN WSS-VARI NOT > SPACES                     
               GO TO FIN-CMP-FEC.                                       
           PERFORM RST-FECHA.                                           
           IF WSS-FEC-FTRA IN WSS-VARI NOT < OPC-FEC-FINP IN OPC AND    
              OPC-VAL-SCRE IN OPC > ZEROES                              
               MOVE 'S' TO WSS-IND-ENFE IN WSS-VARI.                    
       FIN-CMP-FEC.                                                     
           EXIT.                                                        
                                                                        
       LEE-TIO SECTION.                                                 
       INI-LEE-TIO.                                                     
           MOVE SPACES              TO WSS-CIC-TOPE IN WSS-VARI.        
           MOVE 'TAB'               TO TAB-COD-SIST.                    
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.             
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.             
           MOVE GDG-COD-TOPE IN GDG TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS = SPACES                                     
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOPE IN WSS-VARI.    
       FIN-LEE-TIO.                                                     
           EXIT.                                                        
                                                                        
       LEE-GVT SECTION.                                                 
       INI-LEE-GVT.                                                     
           MOVE GVT-NUM-STSN IN GVT-FLD TO WSS-NUM-STSN IN WSS-VARI.    
           MOVE GVT-NUM-ATSN IN GVT-FLD TO WSS-NUM-ATSN IN WSS-VARI.    
           MOVE GVT-NUM-MTSN IN GVT-FLD TO WSS-NUM-MTSN IN WSS-VARI.    
           MOVE GVT-NUM-DTSN IN GVT-FLD TO WSS-NUM-DTSN IN WSS-VARI.    
       FIN-LEE-GVT.                                                     
           EXIT.                                                        
                                                                        
                                                                        
       RST-FECHA SECTION.                                               
       INI-RST-FECHA.                                                   
           MOVE SPACES TO WSS-FEC-FTRA IN WSS-VARI.                     
           MOVE WSS-NUM-DTSN IN WSS-VARI TO FEC-ITM1.                   
           MOVE WSS-NUM-MTSN IN WSS-VARI TO FEC-ITM2.                   
           MOVE WSS-NUM-STSN IN WSS-VARI TO FEC-ITM3.                   
           MOVE WSS-NUM-ATSN IN WSS-VARI TO FEC-ITM4.                   
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-SUM-ANO  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           IF FEC-STAT-OKS                                              
               MOVE FEC-ITM1 TO WSS-NUM-DTRA IN WSS-VARI                
               MOVE FEC-ITM2 TO WSS-NUM-MTRA IN WSS-VARI                
               MOVE FEC-ITM3 TO WSS-NUM-STRA IN WSS-VARI                
               MOVE FEC-ITM4 TO WSS-NUM-ATRA IN WSS-VARI.               
       FIN-RST-FECHA.                                                   
           EXIT.                                                        
                                                                        
       GAR-GRL SECTION.                                                 
       INI-GAR-GRL.                                                     
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.                     
           MOVE 'S'    TO WSS-IND-HIPT IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENFE IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT1 IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT2 IN WSS-VARI.                     
           MOVE 'N'    TO WSS-IND-ENT3 IN WSS-VARI.                     
                                                                        
           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.             
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.             
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-GDD-GAR-GRL.                                                 
           PERFORM BGL-FIO-GDD.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              GDD-CAI-GTIA IN GDD = GDG-CAI-GTIA AND                    
              GDD-IIC-GTIA IN GDD = GDG-IIC-GTIA )                      
               GO TO CNT-GAR-GRL.                                       
                                                                        
           MOVE GDD-CAI-DCLI IN GDD TO RDC-CAI-ICLI IN RDC.             
           MOVE GDD-IIC-DCLI IN GDD TO RDC-IIC-ICLI IN RDC.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-RDC-GAR-GRL.                                                 
           PERFORM COL-FIO-RDC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              RDC-CAI-ICLI IN RDC = GDD-CAI-DCLI IN GDD AND             
              RDC-IIC-ICLI IN RDC = GDD-IIC-DCLI IN GDD )               
               GO TO NXT-GDD-GRL.                                       
                                                                        
           MOVE RDC-CAI-IOPC IN RDC TO OPC-CAI-IOPC IN OPC.             
           MOVE RDC-IIC-IOPC IN RDC TO OPC-IIC-IOPC IN OPC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO NXT-RDC-GRL.                                       
                                                                        
      *MHM-INI 22-OCT-2003                                              
           IF OPC-MSC-STAT IN OPC NOT = 'A' OR                          
              OPC-VAL-SCRE IN OPC NOT > ZEROES                          
               GO TO NXT-RDC-GRL.                                       
      *MHM-FIN 22-OCT-2003                                              
                                                                        
           IF OPC-MSC-STAT IN OPC = 'A'                                 
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.     
                                                                        
           IF OPC-COD-TOPC IN OPC NOT = 'F'                             
               MOVE 'N' TO WSS-IND-HIPT IN WSS-VARI                     
               PERFORM CMP-FEC.                                         
                                                                        
       NXT-RDC-GRL.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-RDC-GAR-GRL.                                       
                                                                        
       NXT-GDD-GRL.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.                             
           GO TO LUP-GDD-GAR-GRL.                                       
                                                                        
       CNT-GAR-GRL.                                                     
           IF WSS-VAL-SCRE IN WSS-VARI NOT > ZEROES                     
               MOVE 'S' TO WSS-IND-ENT1 IN WSS-VARI.                    
                                                                        
           IF WSS-IND-HIPT IN WSS-VARI = 'S'                            
               MOVE 'S' TO WSS-IND-ENT2 IN WSS-VARI.                    
                                                                        
           IF WSS-IND-ENFE IN WSS-VARI = 'S'                            
               MOVE 'S' TO WSS-IND-ENT3 IN WSS-VARI.                    
                                                                        
       FIN-GAR-GRL.                                                     
           EXIT.                                                        
                                                                        
       COPY BGLBKVCG.                                                   
       COPY BGLBGVCG.                                                   
      *MHM-INI 16-OCT-2003                                              
       REST-VAL-GVT SECTION.                                            
       INI-REST-VAL-GVT.                                                
           MOVE WSS-SGV-LTSN IN CMA-VARI TO GVT-SGV-LTSN IN GVT.        
           MOVE WSS-SGV-VCTS IN CMA-VARI TO GVT-SGV-VCTS IN GVT.        
           MOVE WSS-SGV-VPND IN CMA-VARI TO GVT-SGV-VPND IN GVT.        
           MOVE WSS-SGV-VGAS IN CMA-VARI TO GVT-SGV-VGAS IN GVT.        
       FIN-REST-VAL-GVT.                                                
           EXIT.                                                        
      *MHM-FIN 16-OCT-2003                                              
      *>>>>                                                            
      ** EVA-INI  10/07
       COPY BGLBFGSL.
       COPY BGLBFTAS.
       COPY BGLBFGIM.
       COPY SGCBFDBC.
      ** EVA-FIN  10/07
       COPY BGLBFGDG.                                                   
       COPY BGLBFACC.                                                   
       COPY BGLBFGDP.                                                   
      *<<<< GEN_BCI                                                     
       COPY BGLBFGSO.                                                   
      *>>>>                                                             
       COPY TABBFIVB.                                                   
       COPY TABBFUSR.                                                   
      *<<<< GEN_BCI                                                     
       COPY BGLBFGDD.                                                   
       COPY COLBFRDC.                                                   
       COPY COLBFOPC.                                                   
      *>>>>                                                             
       COPY BGLBFGES.                                                   
       COPY BGLBFGSE.                                                   
       COPY BGLBFGTP.                                                   
       COPY BGLBFTAG.                                                   
       COPY TABBFCAM.                                                   
       COPY GNSBGPES.                                                   
      *MHM-INI 23-OCT-2003                                              
       COPY GNSBGCPT.                                                   
      *MHM-FIN 23-OCT-2003                                              

      *MPS-INI 21-SEP-2016 REVALORIZACIONES DE GARANTIAS
       COPY GNSBFLGN.
      *MPS-FIN 21-SEP-2016 REVALORIZACIONES DE GARANTIAS

      *<<<< PGM_PQ                                                      
       EXA-VEN-TSN SECTION.                                             
       INI-EXA-VEN-TSN.                                                 
                                                                        
      * Se determina si la tasacion esta vencida o no                   
                                                                        
                                                                        
      *    MOVE 'N' TO WSS-IND-TASV IN WSS-VARI.
           MOVE 'N' TO WSS-IND-TASV IN CMA-VARI.
           MOVE WSS-NO-EXA-VENC TO WSS-IND-EXAV.                        
      * Excluye los Subtipos de Garantia que no requieren Tasacion Efect
           IF TAG-NUM-PVTS IN TAG NOT > ZEROES                          
               GO TO EXA-VEN-SEG.                                       
                                                                        
      * Excluye los Creditos Hipotecarios                               
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.             
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.             
           MOVE ZEROES              TO GES-NUM-IGES IN GES.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-GES.                                         
           IF NOT FIO-STAT-OKS OR                                       
              GDG-CAI-GTIA IN GDG NOT = GES-CAI-GTIA IN GES OR          
              GDG-IIC-GTIA IN GDG NOT = GES-IIC-GTIA IN GES             
               MOVE SPACES TO GES                                       
               MOVE ZEROES TO GES-IIC-GTIA IN GES                       
                              GES-FEC-FVCR IN GES                       
                              GES-NUM-IGES IN GES                       
               IF FIO-STAT-OKS                                          
                   MOVE FIO-END-BRW TO FIO-CMND                         
                   PERFORM BGL-FIO-GES                                  
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM BGL-FIO-GES                                      
               IF GES-COD-SIST IN GES > SPACES                          
                   MOVE 'TAB'               TO TAB-COD-SIST             
                   MOVE 'SIS'               TO TAB-COD-TTAB IN TAB      
                   MOVE GES-COD-SIST IN GES TO TAB-COD-CTAB IN TAB      
                   PERFORM BUS-TAB                                      
                   IF MSG-COD-MENS = SPACES AND TAB-CIC-CTAB = 'HIP'    
                       GO TO EXA-VEN-SEG.                               
                                                                        
           MOVE WSS-SI-EXA-VENC TO WSS-IND-EXAV.                        
           IF TAG-COD-TPVT IN TAG = 'D'                                 
              MOVE FEC-SUM-DIA TO FEC-CMND                              
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NDIA                      
           ELSE                                                         
           IF TAG-COD-TPVT IN TAG = 'M'                                 
              MOVE FEC-SUM-MES TO FEC-CMND                              
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NMES                      
           ELSE                                                         
           IF TAG-COD-TPVT IN TAG = 'A'                                 
              MOVE FEC-SUM-ANO TO FEC-CMND                              
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NANO.                     
                                                                        
           MOVE GVT-FEC-FTSN IN GVT TO FEC-FVLD.                        
           MOVE FEC-DVLD TO FEC-ITM1.                                   
           MOVE FEC-MVLD TO FEC-ITM2.                                   
           MOVE FEC-AVLD TO FEC-ITM4.                                   
           MOVE FEC-SVLD TO FEC-ITM3.                                   
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           PERFORM CAL-FEC.                                             
           IF MSG-COD-MENS = SPACES                                     
               MOVE FEC-ITM1 TO WSS-FEC-DVTA IN WSS-VARI                
               MOVE FEC-ITM2 TO WSS-FEC-MVTA IN WSS-VARI                
               MOVE FEC-ITM4 TO WSS-FEC-AVTA IN WSS-VARI                
               MOVE FEC-ITM3 TO WSS-FEC-SVTA IN WSS-VARI                
           ELSE                                                         
               GO TO EXA-VEN-SEG.                                       
                                                                        
      * Tasacion Vencida                                                
           IF WSS-FEC-FVTA IN WSS-VARI > HOY-FHOY                       
               GO TO EXA-VEN-SEG.                                       
      *                                                                 
      *    MOVE 'S' TO WSS-IND-TASV IN WSS-VARI.
           MOVE 'S' TO WSS-IND-TASV IN CMA-VARI.
      *MHM-INI 21-OCT-2003                                              
      *     MOVE 'BGL'         TO MSG-COD-SIST.                         
      *     MOVE 'FECTSN<HOY'  TO MSG-COD-MENS.                         
      *     PERFORM GET-MSG.                                            
      *     MOVE MSG-GLS-DESC  TO FRM-MEN1.                             
      *MHM-INI 21-OCT-2003                                              
       EXA-VEN-SEG.                                                     
           MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE.             
           MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSE.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-EXA-VEN-SEG.                                   
                                                                        
      * Se determina si el seguro esta vencido o no                     
                                                                        
                                                                        
      * Excluye los Creditos Hipotecarios.                              
           IF WSS-IND-EXAV = WSS-NO-EXA-VENC                            
               GO TO FIN-EXA-VEN-SEG.                                   
                                                                        
      * Seguro Vigente.                                                 
           IF GSE-FEC-FVTS IN GSE > HOY-FHOY                            
               GO TO FIN-EXA-VEN-SEG.                                   
                                                                        
      *MHM-INI 21-OCT-2003                                              
      *     MOVE 'SEGURO VENCIDO' TO FRM-MEN2.                          
      *MHM-FIN 21-OCT-2003                                              
                                                                        
       FIN-EXA-VEN-SEG.                                                 
       FIN-EXA-VEN-TSN.                                                 
           EXIT.                                                        
                                                                        
      *>>>>                                                             
      *>>>>                                                             
       COPY GNSBPFEC.                                                   
      * COPY BGLBVUOF.                                                  
      *>>>>                                                             
      *>>>>
