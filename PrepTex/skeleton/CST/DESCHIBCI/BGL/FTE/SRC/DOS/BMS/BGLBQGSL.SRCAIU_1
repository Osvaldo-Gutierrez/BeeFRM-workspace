      *
      * BGLBQGSL
      * Version 3.0.1 Nov-2005
      * 15-Jan-19 10:09 PM
      *
       SET-TAG-BGLBQGSL SECTION.
       INI-SET-TAG-BGLBQGSL.
           MOVE
           '<IDNMOD NOM=$BGLBQGSL$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$15-Jan-19 10:09 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBQGSL.
           EXIT.
           
       PUT-ALL-GSL SECTION.
       INI-PUT-ALL-GSL.
           PERFORM PUT-DBC-GSL.
           PERFORM PUT-GSL-GSL.
       FIN-PUT-ALL-GSL.
           EXIT.
       
       PUT-DBC-GSL SECTION.
       INI-PUT-DBC-GSL.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-GSL.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-GSL
               GO TO FIN-PUT-DBC-GSL.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN GSL-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GSL-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN GSL-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN GSL-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
      *<<<< FIN_PUT_DBC_GSL 
      * CGL-INI  20-AUG-2003 20:30:58 
      *     MOVE DBC-IDC-ICLI IN GSL-FLD TO DBC-IDC-ICLI IN DBC.
      *     MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
      *     MOVE FIO-GET-KEY     TO FIO-CMND.
      *     PERFORM GET-CLI.
      *     IF NOT FIO-STAT-OKS
      *        MOVE 'CLI    NEX' TO FRM-GLS-NOMC IN GSL-FLD
      *        GO TO FIN-PUT-DBC-GSL.
      *     MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
      *     PERFORM CPT-BLKS.
      *     MOVE CPT-STRN TO FRM-GLS-NOMC IN GSL-FLD.
      *CGL-FIN  20-AUG-2003 20:31:16 
      *>>>>
       FIN-PUT-DBC-GSL.
           EXIT.
       
       PUT-GSL-GSL SECTION.
       INI-PUT-GSL-GSL.
           IF PGM-STAT-GSL-NUL
               GO TO FIN-PUT-GSL-GSL.
           IF NOT PGM-STAT-GSL-OKS
               PERFORM CLR-GSL-GSL
               GO TO FIN-PUT-GSL-GSL.
           MOVE GSL-NUM-SBGL IN GSL TO GSL-NUM-SBGL IN GSL-FLD.
           MOVE GSL-COD-ORIG IN GSL TO GSL-COD-ORIG IN GSL-FLD.
           MOVE GSL-COD-ESOL IN GSL TO GSL-COD-ESOL IN GSL-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE GSL-NUM-DSOL IN GSL TO GSL-NUM-DSOL IN GSL-FLD.
           MOVE GSL-NUM-MSOL IN GSL TO GSL-NUM-MSOL IN GSL-FLD.
           MOVE GSL-NUM-SSOL IN GSL TO GSL-NUM-SSOL IN GSL-FLD.
           MOVE GSL-NUM-ASOL IN GSL TO GSL-NUM-ASOL IN GSL-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE GSL-GLS-MOTC IN GSL TO GSL-GLS-MOTC IN GSL-FLD.
           MOVE GSL-COD-USER IN GSL TO GSL-COD-USER IN GSL-FLD.
           MOVE GSL-COD-CTRA IN GSL TO GSL-COD-CTRA IN GSL-FLD.
           MOVE GSL-NUM-NCAR IN GSL TO GSL-NUM-NCAR IN GSL-FLD.
           MOVE GSL-COD-TSOL IN GSL TO GSL-COD-TSOL IN GSL-FLD.
           MOVE GSL-COD-TPRO IN GSL TO GSL-COD-TPRO IN GSL-FLD.
           MOVE GSL-GLS-NCON IN GSL TO GSL-GLS-NCON IN GSL-FLD.
           MOVE GSL-NUM-TCON IN GSL TO GSL-NUM-TCON IN GSL-FLD.
           MOVE GSL-GLS-OBS1 IN GSL TO GSL-GLS-OBS1 IN GSL-FLD.
           MOVE GSL-GLS-OBS2 IN GSL TO GSL-GLS-OBS2 IN GSL-FLD.
      *<<<< FIN_PUT_GSL_GSL 
      *Nombre de ejecutivo.
           IF GSL-COD-USER IN GSL > SPACES                      
               MOVE GSL-COD-USER IN GSL TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-USER IN GSL-FLD  
           ELSE                                                     
               MOVE SPACES              TO FRM-GLS-USER IN GSL-FLD. 
      *Glosa de estado.
           IF GSL-COD-ESOL IN GSL > SPACES
              MOVE 'BGL'  TO TAB-COD-SIST 
              MOVE 'ESO ' TO TAB-COD-TTAB IN TAB 
              MOVE GSL-COD-ESOL IN GSL TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESOL IN GSL-FLD
           ELSE
               MOVE SPACES             TO FRM-GLS-ESOL IN GSL-FLD.

      *Glosa de Origen.
           IF GSL-COD-ORIG IN GSL > SPACES
               MOVE 'BGL'  TO TAB-COD-SIST 
               MOVE 'ORS ' TO TAB-COD-TTAB IN TAB 
               MOVE GSL-COD-ORIG IN GSL TO TAB-COD-CTAB IN TAB 
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ORIG IN GSL-FLD 
           ELSE
               MOVE SPACES              TO FRM-GLS-ORIG IN GSL-FLD.

           MOVE GSL-CIC-DCLI IN GSL TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           PERFORM GET-CLI.
           IF NOT FIO-STAT-OKS
              MOVE 'CLI    NEX' TO FRM-GLS-NOMC IN GSL-FLD
              GO TO FIN-PUT-GSL-GSL.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO FRM-GLS-NOMC IN GSL-FLD.
      *CGL-INI  7-SEP-2003 10:23:56 
            MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN GSL-FLD.
            MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN GSL-FLD.
            MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GSL-FLD.
            MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN GSL-FLD.


           MOVE DBC-CAI-ICLI IN DBC TO RCD-CAI-ICLI IN RCD.
           MOVE DBC-IIC-ICLI IN DBC TO RCD-IIC-ICLI IN RCD.
           MOVE ZEROES TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *EVA-AFRI/ABR2007                                                 
       LUP-FND-KEY.                                                     
           PERFORM SGC-FIO-RCD.
           IF NOT ( FIO-STAT-OKS AND
              RCD-CAI-ICLI IN RCD = DBC-CAI-ICLI IN DBC AND
              RCD-IIC-ICLI IN RCD = DBC-IIC-ICLI IN DBC )
              GO TO FND-KEY-GSL.                                        
                                                                        
           IF RCD-MSC-TDIR IN RCD NOT = 'D'                             
              GO TO CON-FND-KEY-GSL.                                    
                                                                        
      *FIN-AFRI/ABR2007                                                 
           MOVE RCD-GLS-DIRE IN RCD TO FRM-GLS-DIRC IN GSL-FLD.         
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'COM' TO TAB-COD-TTAB IN TAB.
           MOVE RCD-COD-LUGA IN RCD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB TO COM.
           MOVE COM-GLS-COMU IN COM TO FRM-GLS-COMU IN GSL-FLD.
           MOVE COM-GLS-CIUD IN COM TO FRM-GLS-CIUD IN GSL-FLD.

           MOVE 'TAB' TO FIO-SIST.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'REG' TO TAB-COD-TTAB IN TAB.
           MOVE COM-COD-REGI IN COM TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-REGI IN GSL-FLD.

           MOVE 'BGL'  TO TAB-COD-SIST. 
           MOVE 'CAR' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSL-COD-CTRA IN GSL TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CTRA IN GSL-FLD.
           
           MOVE 'BGL'  TO TAB-COD-SIST. 
           MOVE 'TSO' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSL-COD-TSOL IN GSL TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TSOL IN GSL-FLD.
           
           MOVE 'BGL'  TO TAB-COD-SIST. 
           MOVE 'TPR' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSL-COD-TPRO IN GSL TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TPRO IN GSL-FLD.
      *CGL-FIN  7-SEP-2003 10:23:42 
      *EVA-AFRI/ABR2007                                                 
       CON-FND-KEY-GSL.                                                 
           IF RCD-NUM-FONO IN RCD NOT > ZEROES                          
              MOVE FIO-GET-NXT TO FIO-CMND                              
              GO TO LUP-FND-KEY                                         
           ELSE                                                         
              MOVE RCD-NUM-FONO IN RCD TO FRM-GLS-TELF IN GSL-FLD.      
      *>>>>                                                             
                                                                        
       FND-KEY-GSL.                                                     
           IF FRM-GLS-TELF IN GSL-FLD NOT > SPACES                      
              MOVE 'BGL' TO MSG-COD-SIST                                
              MOVE 'GSLNOFONO' TO MSG-COD-MENS                          
              PERFORM GET-MSG                                           
              IF MSG-COD-MENS > SPACES                                  
                 MOVE MSG-GLS-DESC TO FRM-GLS-TELF IN GSL-FLD.          
      *FIN-AFRI/ABR2007                                                 
      *>>>>
       FIN-PUT-GSL-GSL.
           EXIT.
       
       KEY-ALL-GSL SECTION.
       INI-KEY-ALL-GSL.
           PERFORM KEY-DBC-GSL.
           PERFORM KEY-GSL-GSL.
       FIN-KEY-ALL-GSL.
           EXIT.
       
       KEY-DBC-GSL SECTION.
       INI-KEY-DBC-GSL.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN GSL-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN GSL-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GSL-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GSL-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-GSL.
           EXIT.
       
       KEY-GSL-GSL SECTION.
       INI-KEY-GSL-GSL.
           MOVE GSL-NUM-SBGL IN GSL-FLD TO GSL-NUM-SBGL IN GSL.
       FIN-KEY-GSL-GSL.
           EXIT.
       
       SCR-CLRA-GSL SECTION.
       INI-SCR-CLRA-GSL.
           PERFORM CLR-KEY-GSL.
           PERFORM CLR-FLD-GSL.
       FIN-SCR-CLRA-GSL.
           EXIT.
       
       CLR-KEY-GSL SECTION.
       INI-CLR-KEY-GSL.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN GSL-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN GSL-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN GSL-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN GSL-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GSL-NUM-SBGL IN GSL-FLD.
       FIN-CLR-KEY-GSL.
           EXIT.
       
       CLR-FLD-GSL SECTION.
       INI-CLR-FLD-GSL.
           MOVE SPACES TO FRM-GLS-NOMC IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-DIRC IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-TELF IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-COMU IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-REGI IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-CIUD IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-ORIG IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-ESOL IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-USER IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-CTRA IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-TSOL IN GSL-FLD.
           MOVE SPACES TO FRM-GLS-TPRO IN GSL-FLD.
           PERFORM CLR-DBC-GSL.
           PERFORM CLR-GSL-GSL.
       FIN-CLR-FLD-GSL.
           EXIT.
       
       CLR-DBC-GSL SECTION.
       INI-CLR-DBC-GSL.
       FIN-CLR-DBC-GSL.
           EXIT.
       
       CLR-GSL-GSL SECTION.
       INI-CLR-GSL-GSL.
           MOVE SPACES TO GSL-COD-ORIG IN GSL-FLD.
           MOVE SPACES TO GSL-COD-ESOL IN GSL-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GSL-FEC-ESOL IN GSL-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GSL-GLS-MOTC IN GSL-FLD.
           MOVE SPACES TO GSL-COD-USER IN GSL-FLD.
           MOVE SPACES TO GSL-COD-CTRA IN GSL-FLD.
           MOVE SPACES TO GSL-NUM-NCAR IN GSL-FLD.
           MOVE SPACES TO GSL-COD-TSOL IN GSL-FLD.
           MOVE SPACES TO GSL-COD-TPRO IN GSL-FLD.
           MOVE SPACES TO GSL-GLS-NCON IN GSL-FLD.
           MOVE ZEROES TO GSL-NUM-TCON IN GSL-FLD.
           MOVE SPACES TO GSL-GLS-OBS1 IN GSL-FLD.
           MOVE SPACES TO GSL-GLS-OBS2 IN GSL-FLD.
       FIN-CLR-GSL-GSL.
           EXIT.
       
       FST-KEY-GSL SECTION.
       INI-FST-KEY-GSL.
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN GSL-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
       FIN-FST-KEY-GSL.
           EXIT.
       
       FST-FLD-GSL SECTION.
       INI-FST-FLD-GSL.
      *<<<< INI_FST_FLD_GSL
      *PVG INI 14-PCT-2003
           IF SCR-CMND = 'CAN'
              MOVE FRM-POS-CURS TO GSL-GLS-MOTC-LEN IN GSL-FLD
           ELSE
           IF SCR-CMND = 'ASO'
              MOVE FRM-POS-CURS TO GSL-GLS-MENS-LEN IN GSL-FLD
           ELSE
      *PVG FIN 14-PCT-2003
      *>>>>
           MOVE -1 TO GSL-COD-ORIG-LEN IN GSL-FLD.
       FIN-FST-FLD-GSL.
           EXIT.
       
       PRO-KEY-GSL SECTION.
       INI-PRO-KEY-GSL.
           PERFORM PRO-IKY-GSL.
           PERFORM PRO-AKY-GSL.
           PERFORM PRO-MKY-GSL.
       FIN-PRO-KEY-GSL.
           EXIT.
       
       PRO-IKY-GSL SECTION.
       INI-PRO-IKY-GSL.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GSL-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-IKY-GSL.
           EXIT.
       
       PRO-MKY-GSL SECTION.
       INI-PRO-MKY-GSL.
       FIN-PRO-MKY-GSL.
           EXIT.
       
       PRO-AKY-GSL SECTION.
       INI-PRO-AKY-GSL.
           MOVE FRM-CPIM-AEY TO GSL-NUM-SBGL-ATR IN GSL-FLD.
       FIN-PRO-AKY-GSL.
           EXIT.
       
       UNP-KEY-GSL SECTION.
       INI-UNP-KEY-GSL.
           PERFORM UNP-IKY-GSL.
           PERFORM UNP-AKY-GSL.
           PERFORM UNP-MKY-GSL.
       FIN-UNP-KEY-GSL.
           EXIT.
       
       UNP-IKY-GSL SECTION.
       INI-UNP-IKY-GSL.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN GSL-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
      *<<<< FIN_UNP_IKY_GSL
           IF SCR-CCPP NOT = 'ING'
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-STP
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-STP
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-STP
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-STP.
      *>>>>
       FIN-UNP-IKY-GSL.
           EXIT.
       
       UNP-MKY-GSL SECTION.
       INI-UNP-MKY-GSL.
       FIN-UNP-MKY-GSL.
           EXIT.
       
       UNP-AKY-GSL SECTION.
       INI-UNP-AKY-GSL.
           MOVE FRM-CPIM-UBY TO GSL-NUM-SBGL-ATR.
       FIN-UNP-AKY-GSL.
           EXIT.
       
       UNP-FLD-GSL SECTION.
       INI-UNP-FLD-GSL.
           PERFORM UNP-DBC-GSL.
           PERFORM UNP-GSL-GSL.
       FIN-UNP-FLD-GSL.
           EXIT.
       
       UNP-DBC-GSL SECTION.
       INI-UNP-DBC-GSL.
       FIN-UNP-DBC-GSL.
           EXIT.
       
       UNP-GSL-GSL SECTION.
       INI-UNP-GSL-GSL.
           MOVE FRM-CPIM-UBY TO GSL-COD-ORIG-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-GLS-MOTC-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-COD-CTRA-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-NUM-NCAR-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-COD-TSOL-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-COD-TPRO-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-GLS-NCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-NUM-TCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-GLS-OBS1-ATR IN GSL-FLD.
           MOVE FRM-CPIM-UBY TO GSL-GLS-OBS2-ATR IN GSL-FLD.
      *<<<< FIN_UNP_GSL_GSL
           IF SCR-CMND NOT = 'CAN'
               MOVE FRM-CPIM-AEY       TO GSL-GLS-MOTC-ATR IN GSL-FLD
               MOVE FRM-CPIM-AEY       TO GSL-GLS-MOTC-STP.
      
           IF SCR-CMND = 'ING' OR 'MOD'
               GO TO FIN-UNP-GSL-GSL.
      
           MOVE FRM-CPIM-AEY       TO GSL-COD-ORIG-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-COD-ORIG-STP.
           MOVE FRM-CPIM-AEY       TO GSL-COD-CTRA-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-COD-CTRA-STP.
           MOVE FRM-CPIM-AEY       TO GSL-NUM-NCAR-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-NUM-NCAR-STP.
           MOVE FRM-CPIM-AEY       TO GSL-COD-TSOL-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-COD-TSOL-STP.
           MOVE FRM-CPIM-AEY       TO GSL-COD-TPRO-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-COD-TPRO-STP.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-NCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-NCON-STP.
           MOVE FRM-CPIM-AEY       TO GSL-NUM-TCON-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-NUM-TCON-STP.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-OBS1-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-OBS1-STP.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-OBS2-ATR IN GSL-FLD.
           MOVE FRM-CPIM-AEY       TO GSL-GLS-OBS2-STP.
      *CGL-INI  20-AUG-2003 20:35:07 
      *     MOVE FRM-CPIM-AEY       TO GSL-FEC-FAUT-ATR IN GSL-FLD.
      *     MOVE FRM-CPIM-AEY       TO GSL-FEC-FAUT-STP.
      *CGL-FIN  20-AUG-2003 20:35:18 
      *CGL-INI  20-AUG-2003 20:29:33 
      *     MOVE FRM-CPIM-AEY       TO GSL-NUM-SBCO-ATR IN GSL-FLD.
      *     MOVE FRM-CPIM-AEY       TO GSL-NUM-SBCO-STP.
      *CGL-FIN  20-AUG-2003 20:29:44 
      *>>>>
       FIN-UNP-GSL-GSL.
           EXIT.
       
       VAL-KEY-GSL SECTION.
       INI-VAL-KEY-GSL.
           PERFORM VAL-IKY-GSL.
           PERFORM VAL-MKY-GSL.
           PERFORM VAL-AKY-GSL.
       FIN-VAL-KEY-GSL.
           EXIT.
       
       VAL-IKY-GSL SECTION.
       INI-VAL-IKY-GSL.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN GSL-FLD
                GO TO FIN-VAL-IKY-GSL.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN GSL-FLD
                GO TO FIN-VAL-IKY-GSL.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN GSL-FLD
                GO TO FIN-VAL-IKY-GSL.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN GSL-FLD
                GO TO FIN-VAL-IKY-GSL.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-IKY-GSL.
           EXIT.
       
       VAL-MKY-GSL SECTION.
       INI-VAL-MKY-GSL.
       FIN-VAL-MKY-GSL.
           EXIT.
       
       VAL-AKY-GSL SECTION.
       INI-VAL-AKY-GSL.
           PERFORM VAL-GSL-NUM-SBGL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSL-NUM-SBGL-LEN IN GSL-FLD
                GO TO FIN-VAL-AKY-GSL.
       FIN-VAL-AKY-GSL.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
      *<<<< INI_DBC_VRF_ICLI
            MOVE SPACES TO MSG-COD-MENS.
      *>>>>
           IF DBC-VRF-ICLI IN GSL-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN GSL-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN GSL-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN GSL-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI
            IF MSG-COD-MENS NOT > SPACES AND
               DBC-NUM-ICLI IN GSL-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN GSL-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN GSL-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN GSL-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GET-CLI
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES TO FRM-GLS-NOMC IN GSL-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF MSG-GLS-DESC > SPACES
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  MOVE DBC-GLS-NOMC IN DBC TO FRM-GLS-NOMC IN GSL-FLD
               ELSE
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO FRM-GLS-NOMC IN GSL-FLD.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN GSL-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN GSL-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN GSL-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN GSL-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN GSL-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN GSL-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN GSL-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN GSL-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GSL-NUM-SBGL SECTION.
       INI-VAL-GSL-NUM-SBGL.
       FIN-VAL-GSL-NUM-SBGL.
           EXIT.
       
       VAL-CON-KEY-GSL SECTION.
       INI-VAL-CON-KEY-GSL.
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
           IF     DBC-NUM-ICLI IN GSL-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN GSL-FLD NOT > SPACES
              AND DBC-IND-ICLI IN GSL-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN GSL-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
              AND GSL-NUM-SBGL IN GSL-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GSL.
       FIN-VAL-CON-KEY-GSL.
           EXIT.
       
       VAL-CON-IKY-GSL SECTION.
       INI-VAL-CON-IKY-GSL.
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
           IF     DBC-NUM-ICLI IN GSL-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN GSL-FLD NOT > SPACES
              AND DBC-IND-ICLI IN GSL-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN GSL-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
                PERFORM ERR-KEY
                PERFORM FST-KEY-GSL.
       FIN-VAL-CON-IKY-GSL.
           EXIT.
       
       VAL-NUM-KEY-GSL SECTION.
       INI-VAL-NUM-KEY-GSL.
           PERFORM VAL-NUM-IKY-GSL.
           PERFORM VAL-NUM-MKY-GSL.
           PERFORM VAL-NUM-AKY-GSL.
       FIN-VAL-NUM-KEY-GSL.
           EXIT.
       
       VAL-NUM-IKY-GSL SECTION.
       INI-VAL-NUM-IKY-GSL.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GSL-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN GSL-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN GSL-FLD
                GO TO FIN-VAL-NUM-IKY-GSL.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-IKY-GSL.
           EXIT.
       
       VAL-NUM-MKY-GSL SECTION.
       INI-VAL-NUM-MKY-GSL.
       FIN-VAL-NUM-MKY-GSL.
           EXIT.
       
       VAL-NUM-AKY-GSL SECTION.
       INI-VAL-NUM-AKY-GSL.
       VAL-NUM-GSL-NUM-SBGL.
           MOVE GSL-NUM-SBGL-ALF IN GSL-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSL-NUM-SBGL IN GSL-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSL-NUM-SBGL-LEN IN GSL-FLD
                GO TO FIN-VAL-NUM-AKY-GSL.
       FIN-VAL-NUM-AKY-GSL.
           EXIT.
       
       VAL-NUM-FLD-GSL SECTION.
       INI-VAL-NUM-FLD-GSL.
       VAL-NUM-GSL-NUM-TCON.
           MOVE GSL-NUM-TCON-ALF IN GSL-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSL-NUM-TCON IN GSL-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSL-NUM-TCON-LEN IN GSL-FLD
                GO TO FIN-VAL-NUM-FLD-GSL.
       FIN-VAL-NUM-FLD-GSL.
           EXIT.
       
       EDT-KEY-GSL SECTION.
       INI-EDT-KEY-GSL.
           PERFORM EDT-IKY-GSL.
           PERFORM EDT-MKY-GSL.
           PERFORM EDT-AKY-GSL.
       FIN-EDT-KEY-GSL.
           EXIT.
       
       EDT-IKY-GSL SECTION.
       INI-EDT-IKY-GSL.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN GSL-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN GSL-FLD
                GO TO FIN-EDT-IKY-GSL.
           MOVE DBC-NUM-ICLI IN GSL-FLD TO
                DBC-NUM-ICLI-EDT IN GSL-EDT.
           MOVE DBC-NUM-ICLI-EDT IN GSL-EDT TO
                DBC-NUM-ICLI-ALF IN GSL-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-IKY-GSL.
           EXIT.
       
       EDT-MKY-GSL SECTION.
       INI-EDT-MKY-GSL.
       FIN-EDT-MKY-GSL.
           EXIT.
       
       EDT-AKY-GSL SECTION.
       INI-EDT-AKY-GSL.
           IF GSL-NUM-SBGL-LEN IN GSL-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSL-NUM-SBGL-LEN IN GSL-FLD
                GO TO FIN-EDT-AKY-GSL.
           MOVE GSL-NUM-SBGL IN GSL-FLD TO GSL-NUM-SBGL-EDT IN GSL-EDT.
           MOVE GSL-NUM-SBGL-EDT IN GSL-EDT TO 
                GSL-NUM-SBGL-ALF IN GSL-FLD.
       FIN-EDT-AKY-GSL.
           EXIT.
       
       EDT-FLD-GSL SECTION.
       INI-EDT-FLD-GSL.
           IF GSL-NUM-TCON-LEN IN GSL-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSL-NUM-TCON-LEN IN GSL-FLD
                GO TO FIN-EDT-FLD-GSL.
           MOVE GSL-NUM-TCON IN GSL-FLD TO GSL-NUM-TCON-EDT IN GSL-EDT.
           MOVE GSL-NUM-TCON-EDT IN GSL-EDT TO 
                GSL-NUM-TCON-ALF IN GSL-FLD.
       FIN-EDT-FLD-GSL.
           EXIT.
