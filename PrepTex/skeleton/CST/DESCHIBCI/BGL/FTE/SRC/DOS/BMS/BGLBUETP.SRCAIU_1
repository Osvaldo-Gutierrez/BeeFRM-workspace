      *
      * BGLBUETP
      * Version 3.0.1 Nov-2005
      * 01-Mar-19 12:58 PM
      *
       SET-TAG-BGLBUETP SECTION.
       INI-SET-TAG-BGLBUETP.
           MOVE
           '<IDNMOD NOM=$BGLBUETP$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$01-Mar-19 12:58 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUETP.
           EXIT.
           
       RET-ALL-ETP SECTION.
       INI-RET-ALL-ETP.
           PERFORM KEY-ALL-ETP.
           PERFORM RET-ETP-ETP.
       FIN-RET-ALL-ETP.
           EXIT.
       
       RET-ETP-ETP SECTION.
       INI-RET-ETP-ETP.
           MOVE ETP-COD-CGTA IN ETP-FLD TO ETP-COD-CGTA IN ETP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE ETP-NUM-DTAS IN ETP-FLD TO ETP-NUM-DTAS IN ETP.
           MOVE ETP-NUM-MTAS IN ETP-FLD TO ETP-NUM-MTAS IN ETP.
           MOVE ETP-NUM-STAS IN ETP-FLD TO ETP-NUM-STAS IN ETP.
           MOVE ETP-NUM-ATAS IN ETP-FLD TO ETP-NUM-ATAS IN ETP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE ETP-NUM-SOLI IN ETP-FLD TO ETP-NUM-SOLI IN ETP.
           MOVE ETP-COD-TASN IN ETP-FLD TO ETP-COD-TASN IN ETP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE ETP-NUM-DTRN IN ETP-FLD TO ETP-NUM-DTRN IN ETP.
           MOVE ETP-NUM-MTRN IN ETP-FLD TO ETP-NUM-MTRN IN ETP.
           MOVE ETP-NUM-STRN IN ETP-FLD TO ETP-NUM-STRN IN ETP.
           MOVE ETP-NUM-ATRN IN ETP-FLD TO ETP-NUM-ATRN IN ETP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE ETP-IND-IEXC IN ETP-FLD TO ETP-IND-IEXC IN ETP.
       FIN-RET-ETP-ETP.
           EXIT.
       
       KEY-ALL-ETP SECTION.
       INI-KEY-ALL-ETP.
           PERFORM KEY-ETP-ETP.
       FIN-KEY-ALL-ETP.
           EXIT.
       
       KEY-ETP-ETP SECTION.
       INI-KEY-ETP-ETP.
           MOVE ETP-CAI-GTIA IN ETP-FLD TO ETP-CAI-GTIA IN ETP.
           MOVE ETP-IIC-GTIA IN ETP-FLD TO ETP-IIC-GTIA IN ETP.
           MOVE ETP-NUM-CONT IN ETP-FLD TO ETP-NUM-CONT IN ETP.
       FIN-KEY-ETP-ETP.
           EXIT.
       
       SCR-CLRA-ETP SECTION.
       INI-SCR-CLRA-ETP.
           PERFORM CLR-KEY-ETP.
           PERFORM CLR-FLD-ETP.
       FIN-SCR-CLRA-ETP.
           EXIT.
       
       CLR-KEY-ETP SECTION.
       INI-CLR-KEY-ETP.
           MOVE SPACES TO ETP-CAI-GTIA IN ETP-FLD.
           MOVE ZEROES TO ETP-IIC-GTIA IN ETP-FLD.
           MOVE ZEROES TO ETP-NUM-CONT IN ETP-FLD.
       FIN-CLR-KEY-ETP.
           EXIT.
       
       CLR-FLD-ETP SECTION.
       INI-CLR-FLD-ETP.
           MOVE SPACES TO FRM-GLS-CGTA IN ETP-FLD.
           MOVE SPACES TO FRM-GLS-EXCP IN ETP-FLD.
           PERFORM CLR-ETP-ETP.
       FIN-CLR-FLD-ETP.
           EXIT.
       
       CLR-ETP-ETP SECTION.
       INI-CLR-ETP-ETP.
           MOVE SPACES TO ETP-COD-CGTA IN ETP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO ETP-FEC-FTAS IN ETP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO ETP-NUM-SOLI IN ETP-FLD.
           MOVE ZEROES TO ETP-COD-TASN IN ETP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO ETP-FEC-FTRN IN ETP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO ETP-IND-IEXC IN ETP-FLD.
       FIN-CLR-ETP-ETP.
           EXIT.
       
       FST-KEY-ETP SECTION.
       INI-FST-KEY-ETP.
           MOVE -1 TO ETP-CAI-GTIA-LEN IN ETP-FLD.
       FIN-FST-KEY-ETP.
           EXIT.
       
       FST-FLD-ETP SECTION.
       INI-FST-FLD-ETP.
           MOVE FRM-POS-CURS TO ETP-FEC-FTAS-LEN IN ETP-FLD.
       FIN-FST-FLD-ETP.
           EXIT.
       
       PRO-KEY-ETP SECTION.
       INI-PRO-KEY-ETP.
           PERFORM PRO-MKY-ETP.
       FIN-PRO-KEY-ETP.
           EXIT.
       
       PRO-MKY-ETP SECTION.
       INI-PRO-MKY-ETP.
       FIN-PRO-MKY-ETP.
           EXIT.
       
       PRO-FLD-ETP SECTION.
       INI-PRO-FLD-ETP.
           PERFORM PRO-ETP-ETP.
       FIN-PRO-FLD-ETP.
           EXIT.
       
       PRO-ETP-ETP SECTION.
       INI-PRO-ETP-ETP.
           MOVE FRM-CPIM-AEY TO ETP-FEC-FTAS-ATR IN ETP-FLD.
           MOVE FRM-CPIM-AEY TO ETP-NUM-SOLI-ATR IN ETP-FLD.
           MOVE FRM-CPIM-AEY TO ETP-FEC-FTRN-ATR IN ETP-FLD.
           MOVE FRM-CPIM-AEY TO ETP-IND-IEXC-ATR IN ETP-FLD.
       FIN-PRO-ETP-ETP.
           EXIT.
       
       UNP-KEY-ETP SECTION.
       INI-UNP-KEY-ETP.
           PERFORM UNP-IKY-ETP.
           PERFORM UNP-AKY-ETP.
           PERFORM UNP-MKY-ETP.
       FIN-UNP-KEY-ETP.
           EXIT.
       
       UNP-IKY-ETP SECTION.
       INI-UNP-IKY-ETP.
           MOVE FRM-CPIM-UBY TO ETP-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO ETP-IIC-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO ETP-NUM-CONT-ATR.
       FIN-UNP-IKY-ETP.
           EXIT.
       
       UNP-MKY-ETP SECTION.
       INI-UNP-MKY-ETP.
       FIN-UNP-MKY-ETP.
           EXIT.
       
       UNP-AKY-ETP SECTION.
       INI-UNP-AKY-ETP.
       FIN-UNP-AKY-ETP.
           EXIT.
       
       UNP-FLD-ETP SECTION.
       INI-UNP-FLD-ETP.
           PERFORM UNP-ETP-ETP.
       FIN-UNP-FLD-ETP.
           EXIT.
       
       UNP-ETP-ETP SECTION.
       INI-UNP-ETP-ETP.
           MOVE FRM-CPIM-UBY TO ETP-FEC-FTAS-ATR IN ETP-FLD.
           MOVE FRM-CPIM-UBY TO ETP-NUM-SOLI-ATR IN ETP-FLD.
           MOVE FRM-CPIM-UBY TO ETP-FEC-FTRN-ATR IN ETP-FLD.
           MOVE FRM-CPIM-UBY TO ETP-IND-IEXC-ATR IN ETP-FLD.
       FIN-UNP-ETP-ETP.
           EXIT.
       
       VAL-MKY-ETP SECTION.
       INI-VAL-MKY-ETP.
       FIN-VAL-MKY-ETP.
           EXIT.
       
       VAL-FLD-ETP SECTION.
       INI-VAL-FLD-ETP.
           PERFORM VAL-ETP-COD-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ETP-COD-CGTA-LEN IN ETP-FLD
                GO TO FIN-VAL-FLD-ETP.
           PERFORM VAL-FRM-GLS-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CGTA-LEN IN ETP-FLD
                GO TO FIN-VAL-FLD-ETP.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-ETP-FEC-FTAS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                ETP-FEC-FTAS-LEN IN ETP-FLD
                GO TO FIN-VAL-FLD-ETP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-ETP-NUM-SOLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ETP-NUM-SOLI-LEN IN ETP-FLD
                GO TO FIN-VAL-FLD-ETP.
           PERFORM VAL-ETP-COD-TASN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ETP-COD-TASN-LEN IN ETP-FLD
                GO TO FIN-VAL-FLD-ETP.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-ETP-FEC-FTRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                ETP-FEC-FTRN-LEN IN ETP-FLD
                GO TO FIN-VAL-FLD-ETP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-ETP-IND-IEXC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ETP-IND-IEXC-LEN IN ETP-FLD
                GO TO FIN-VAL-FLD-ETP.
           PERFORM VAL-FRM-GLS-EXCP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EXCP-LEN IN ETP-FLD
                GO TO FIN-VAL-FLD-ETP.
       FIN-VAL-FLD-ETP.
           EXIT.
       
       VAL-ETP-COD-CGTA SECTION.
       INI-VAL-ETP-COD-CGTA.
       FIN-VAL-ETP-COD-CGTA.
           EXIT.
       
       VAL-FRM-GLS-CGTA SECTION.
       INI-VAL-FRM-GLS-CGTA.
       FIN-VAL-FRM-GLS-CGTA.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-ETP-FEC-FTAS SECTION.
       INI-VAL-ETP-FEC-FTAS.
           IF ETP-FEC-FTAS IN ETP-FLD  NOT > ZEROES
              MOVE ZEROES TO ETP-FEC-FTAS IN ETP-FLD.
      *VAL-FEC Validar Fecha
           MOVE ETP-FEC-FTAS IN ETP-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO ETP-FEC-FTAS IN ETP-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-ETP-FEC-FTAS.
       FIN-VAL-ETP-FEC-FTAS.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-ETP-NUM-SOLI SECTION.
       INI-VAL-ETP-NUM-SOLI.
           IF ETP-NUM-SOLI IN ETP-FLD NOT > SPACES
              MOVE SPACES TO ETP-NUM-SOLI IN ETP-FLD.
       FIN-VAL-ETP-NUM-SOLI.
           EXIT.
       
       VAL-ETP-COD-TASN SECTION.
       INI-VAL-ETP-COD-TASN.
       FIN-VAL-ETP-COD-TASN.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-ETP-FEC-FTRN SECTION.
       INI-VAL-ETP-FEC-FTRN.
           IF ETP-FEC-FTRN IN ETP-FLD  NOT > ZEROES
              MOVE ZEROES TO ETP-FEC-FTRN IN ETP-FLD.
      *VAL-FEC Validar Fecha
           MOVE ETP-FEC-FTRN IN ETP-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO ETP-FEC-FTRN IN ETP-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-ETP-FEC-FTRN.
       FIN-VAL-ETP-FEC-FTRN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-ETP-IND-IEXC SECTION.
       INI-VAL-ETP-IND-IEXC.
           IF ETP-IND-IEXC IN ETP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-ETP-IND-IEXC.
       FIN-VAL-ETP-IND-IEXC.
           EXIT.
       
       VAL-FRM-GLS-EXCP SECTION.
       INI-VAL-FRM-GLS-EXCP.
       FIN-VAL-FRM-GLS-EXCP.
           EXIT.
       
       VAL-CON-FLD-ETP SECTION.
       INI-VAL-CON-FLD-ETP.
       FIN-VAL-CON-FLD-ETP.
           EXIT.
       
       VAL-CON-ETP SECTION.
       INI-VAL-CON-ETP.
       FIN-VAL-CON-ETP.
           EXIT.
       
       VAL-NUM-KEY-ETP SECTION.
       INI-VAL-NUM-KEY-ETP.
           PERFORM VAL-NUM-IKY-ETP.
           PERFORM VAL-NUM-MKY-ETP.
           PERFORM VAL-NUM-AKY-ETP.
       FIN-VAL-NUM-KEY-ETP.
           EXIT.
       
       VAL-NUM-IKY-ETP SECTION.
       INI-VAL-NUM-IKY-ETP.
       VAL-NUM-ETP-IIC-GTIA.
           MOVE ETP-IIC-GTIA-ALF IN ETP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ETP-IIC-GTIA IN ETP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ETP-IIC-GTIA-LEN IN ETP-FLD
                GO TO FIN-VAL-NUM-IKY-ETP.
       VAL-NUM-ETP-NUM-CONT.
           MOVE ETP-NUM-CONT-ALF IN ETP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ETP-NUM-CONT IN ETP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ETP-NUM-CONT-LEN IN ETP-FLD
                GO TO FIN-VAL-NUM-IKY-ETP.
       FIN-VAL-NUM-IKY-ETP.
           EXIT.
       
       VAL-NUM-MKY-ETP SECTION.
       INI-VAL-NUM-MKY-ETP.
       FIN-VAL-NUM-MKY-ETP.
           EXIT.
       
       VAL-NUM-AKY-ETP SECTION.
       INI-VAL-NUM-AKY-ETP.
       FIN-VAL-NUM-AKY-ETP.
           EXIT.
       
       VAL-NUM-FLD-ETP SECTION.
       INI-VAL-NUM-FLD-ETP.
       VAL-NUM-ETP-COD-TASN.
           MOVE ETP-COD-TASN-ALF IN ETP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ETP-COD-TASN IN ETP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ETP-COD-TASN-LEN IN ETP-FLD
                GO TO FIN-VAL-NUM-FLD-ETP.
       FIN-VAL-NUM-FLD-ETP.
           EXIT.
       
       EDT-KEY-ETP SECTION.
       INI-EDT-KEY-ETP.
           PERFORM EDT-IKY-ETP.
           PERFORM EDT-MKY-ETP.
           PERFORM EDT-AKY-ETP.
       FIN-EDT-KEY-ETP.
           EXIT.
       
       EDT-IKY-ETP SECTION.
       INI-EDT-IKY-ETP.
           IF ETP-IIC-GTIA-LEN IN ETP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ETP-IIC-GTIA-LEN IN ETP-FLD
                GO TO FIN-EDT-IKY-ETP.
           MOVE ETP-IIC-GTIA IN ETP-FLD TO ETP-IIC-GTIA-EDT IN ETP-EDT.
           MOVE ETP-IIC-GTIA-EDT IN ETP-EDT TO 
                ETP-IIC-GTIA-ALF IN ETP-FLD.
           IF ETP-NUM-CONT-LEN IN ETP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ETP-NUM-CONT-LEN IN ETP-FLD
                GO TO FIN-EDT-IKY-ETP.
           MOVE ETP-NUM-CONT IN ETP-FLD TO ETP-NUM-CONT-EDT IN ETP-EDT.
           MOVE ETP-NUM-CONT-EDT IN ETP-EDT TO 
                ETP-NUM-CONT-ALF IN ETP-FLD.
       FIN-EDT-IKY-ETP.
           EXIT.
       
       EDT-MKY-ETP SECTION.
       INI-EDT-MKY-ETP.
       FIN-EDT-MKY-ETP.
           EXIT.
       
       EDT-AKY-ETP SECTION.
       INI-EDT-AKY-ETP.
       FIN-EDT-AKY-ETP.
           EXIT.
       
       EDT-FLD-ETP SECTION.
       INI-EDT-FLD-ETP.
           IF ETP-COD-TASN-LEN IN ETP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ETP-COD-TASN-LEN IN ETP-FLD
                GO TO FIN-EDT-FLD-ETP.
           MOVE ETP-COD-TASN IN ETP-FLD TO ETP-COD-TASN-EDT IN ETP-EDT.
           MOVE ETP-COD-TASN-EDT IN ETP-EDT TO 
                ETP-COD-TASN-ALF IN ETP-FLD.
       FIN-EDT-FLD-ETP.
           EXIT.
