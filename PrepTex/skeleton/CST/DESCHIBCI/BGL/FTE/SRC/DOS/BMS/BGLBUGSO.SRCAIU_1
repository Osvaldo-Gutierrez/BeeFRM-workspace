      *
      * BGLBUGSO
      * Version 3.0.1 Nov-2005
      * 11-Dec-18 04:57 PM
      *
       SET-TAG-BGLBUGSO SECTION.
       INI-SET-TAG-BGLBUGSO.
           MOVE
           '<IDNMOD NOM=$BGLBUGSO$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$11-Dec-18 04:57 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBUGSO.
           EXIT.
           
       RET-ALL-GSO SECTION.
       INI-RET-ALL-GSO.
           PERFORM KEY-ALL-GSO.
           PERFORM RET-GSO-GSO.
           PERFORM RET-DBC-GSO.
       FIN-RET-ALL-GSO.
           EXIT.
       
       RET-GSO-GSO SECTION.
       INI-RET-GSO-GSO.
           MOVE GSO-COD-ESGA IN GSO-FLD TO GSO-COD-ESGA IN GSO.
           MOVE GSO-COD-EST2 IN GSO-FLD TO GSO-COD-EST2 IN GSO.
           MOVE GSO-COD-USER IN GSO-FLD TO GSO-COD-USER IN GSO.
           MOVE GSO-COD-RSEG IN GSO-FLD TO GSO-COD-RSEG IN GSO.
           MOVE GSO-IND-PCUO IN GSO-FLD TO GSO-IND-PCUO IN GSO.
           MOVE GSO-NUM-CUOT IN GSO-FLD TO GSO-NUM-CUOT IN GSO.
      *<<<<
      *MHM-INI 25-MAR-2004                                              
           MOVE FRM-NUM-DSO2 IN GSO-FLD TO GSO-NUM-DSO2 IN GSO.         
           MOVE FRM-NUM-MSO2 IN GSO-FLD TO GSO-NUM-MSO2 IN GSO.         
           MOVE FRM-NUM-SSO2 IN GSO-FLD TO GSO-NUM-SSO2 IN GSO.         
           MOVE FRM-NUM-ASO2 IN GSO-FLD TO GSO-NUM-ASO2 IN GSO.         
      *MHM-INI 25-MAR-2004                                              
      *>>>>
       FIN-RET-GSO-GSO.
           EXIT.
       
       RET-DBC-GSO SECTION.
       INI-RET-DBC-GSO.
           MOVE DBC-GLS-NOMC IN GSO-FLD TO DBC-GLS-NOMC IN DBC.
       FIN-RET-DBC-GSO.
           EXIT.
       
       KEY-ALL-GSO SECTION.
       INI-KEY-ALL-GSO.
           PERFORM KEY-GSO-GSO.
           PERFORM KEY-DBC-GSO.
       FIN-KEY-ALL-GSO.
           EXIT.
       
       KEY-GSO-GSO SECTION.
       INI-KEY-GSO-GSO.
           MOVE GSO-CAI-GTIA IN GSO-FLD TO GSO-CAI-GTIA IN GSO.
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GSO-IIC-GTIA IN GSO.
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSO-NUM-SBGL IN GSO.
       FIN-KEY-GSO-GSO.
           EXIT.
       
       KEY-DBC-GSO SECTION.
       INI-KEY-DBC-GSO.
       FIN-KEY-DBC-GSO.
           EXIT.
       
       SCR-CLRA-GSO SECTION.
       INI-SCR-CLRA-GSO.
           PERFORM CLR-KEY-GSO.
           PERFORM CLR-FLD-GSO.
       FIN-SCR-CLRA-GSO.
           EXIT.
       
       CLR-KEY-GSO SECTION.
       INI-CLR-KEY-GSO.
           MOVE SPACES TO GSO-CAI-GTIA IN GSO-FLD.
           MOVE ZEROES TO GSO-IIC-GTIA IN GSO-FLD.
           MOVE ZEROES TO GSO-NUM-SBGL IN GSO-FLD.
       FIN-CLR-KEY-GSO.
           EXIT.
       
       CLR-FLD-GSO SECTION.
       INI-CLR-FLD-GSO.
           MOVE SPACES TO FRM-GLS-CLAS IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-TOPE IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-SOPE IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-EST1 IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-ESGA IN GSO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-ESGA IN GSO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-EST2 IN GSO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-ESO2 IN GSO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-USER IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-RSEG IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-TPOL IN GSO-FLD.
           MOVE SPACES TO FRM-GLS-PCUO IN GSO-FLD.
           PERFORM CLR-GSO-GSO.
           PERFORM CLR-DBC-GSO.
       FIN-CLR-FLD-GSO.
           EXIT.
       
       CLR-GSO-GSO SECTION.
       INI-CLR-GSO-GSO.
           MOVE SPACES TO GSO-COD-ESGA IN GSO-FLD.
           MOVE SPACES TO GSO-COD-EST2 IN GSO-FLD.
           MOVE SPACES TO GSO-COD-USER IN GSO-FLD.
           MOVE SPACES TO GSO-COD-RSEG IN GSO-FLD.
           MOVE SPACES TO GSO-IND-PCUO IN GSO-FLD.
           MOVE ZEROES TO GSO-NUM-CUOT IN GSO-FLD.
       FIN-CLR-GSO-GSO.
           EXIT.
       
       CLR-DBC-GSO SECTION.
       INI-CLR-DBC-GSO.
           MOVE SPACES TO DBC-GLS-NOMC IN GSO-FLD.
       FIN-CLR-DBC-GSO.
           EXIT.
       
       FST-KEY-GSO SECTION.
       INI-FST-KEY-GSO.
           MOVE -1 TO GSO-CAI-GTIA-LEN IN GSO-FLD.
       FIN-FST-KEY-GSO.
           EXIT.
       
       FST-FLD-GSO SECTION.
       INI-FST-FLD-GSO.
      *<<<< INI_FST_FLD_GSO
      *PVG INI 14-PCT-2003
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-KEY-IGSL IN GSL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-FST-FLD-GSO.                                     
      * EVA-INI  11/08                                                  
      *    ELSE                                                         
      *    IF SCR-CMND = 'ING' AND                                      
      *    GSL-COD-TSOL IN GSL = 'R'                                    
      *       MOVE -1 TO GSO-GLS-MENS-LEN IN GSO-FLD.                   
                                                                        
           IF SCR-CMND = 'ING' OR SCR-CMND = 'INE' AND                  
              GSL-COD-TSOL IN GSL = 'R'                                 
              MOVE -1 TO GSO-GLS-MENS-LEN IN GSO-FLD.                   
                                                                        
      *    IF SCR-CMND = 'ING'                                          
           IF SCR-CMND = 'ING' OR SCR-CMND = 'INE'                      
      * EVA-FIN  11/08                                                  
              MOVE FRM-POS-CURS TO GSO-COD-RSEG-LEN IN GSO-FLD          
           ELSE                                                         
           IF SCR-CMND = 'AEJ'                                          
              MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD          
           ELSE                                                         
      *PVG FIN 14-PCT-2003
      *>>>>
           MOVE -1 TO GSO-COD-ESGA-LEN IN GSO-FLD.
       FIN-FST-FLD-GSO.
           EXIT.
       
       PRO-KEY-GSO SECTION.
       INI-PRO-KEY-GSO.
           PERFORM PRO-MKY-GSO.
       FIN-PRO-KEY-GSO.
           EXIT.
       
       PRO-MKY-GSO SECTION.
       INI-PRO-MKY-GSO.
       FIN-PRO-MKY-GSO.
           EXIT.
       
       PRO-FLD-GSO SECTION.
       INI-PRO-FLD-GSO.
           PERFORM PRO-GSO-GSO.
           PERFORM PRO-DBC-GSO.
       FIN-PRO-FLD-GSO.
           EXIT.
       
       PRO-GSO-GSO SECTION.
       INI-PRO-GSO-GSO.
           MOVE FRM-CPIM-AEY TO GSO-COD-ESGA-ATR IN GSO-FLD.
           MOVE FRM-CPIM-AEY TO GSO-COD-EST2-ATR IN GSO-FLD.
           MOVE FRM-CPIM-AEY TO GSO-COD-RSEG-ATR IN GSO-FLD.
           MOVE FRM-CPIM-AEY TO GSO-IND-PCUO-ATR IN GSO-FLD.
           MOVE FRM-CPIM-AEY TO GSO-NUM-CUOT-ATR IN GSO-FLD.
       FIN-PRO-GSO-GSO.
           EXIT.
       
       PRO-DBC-GSO SECTION.
       INI-PRO-DBC-GSO.
       FIN-PRO-DBC-GSO.
           EXIT.
       
       UNP-KEY-GSO SECTION.
       INI-UNP-KEY-GSO.
           PERFORM UNP-IKY-GSO.
           PERFORM UNP-AKY-GSO.
           PERFORM UNP-MKY-GSO.
       FIN-UNP-KEY-GSO.
           EXIT.
       
       UNP-IKY-GSO SECTION.
       INI-UNP-IKY-GSO.
           MOVE FRM-CPIM-UBY TO GSO-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GSO-IIC-GTIA-ATR.
       FIN-UNP-IKY-GSO.
           EXIT.
       
       UNP-MKY-GSO SECTION.
       INI-UNP-MKY-GSO.
       FIN-UNP-MKY-GSO.
           EXIT.
       
       UNP-AKY-GSO SECTION.
       INI-UNP-AKY-GSO.
           MOVE FRM-CPIM-UBY TO GSO-NUM-SBGL-ATR.
       FIN-UNP-AKY-GSO.
           EXIT.
       
       UNP-FLD-GSO SECTION.
       INI-UNP-FLD-GSO.
           PERFORM UNP-GSO-GSO.
           PERFORM UNP-DBC-GSO.
       FIN-UNP-FLD-GSO.
           EXIT.
       
       UNP-GSO-GSO SECTION.
       INI-UNP-GSO-GSO.
           MOVE FRM-CPIM-UBY TO GSO-COD-ESGA-ATR IN GSO-FLD.
           MOVE FRM-CPIM-UBY TO GSO-COD-EST2-ATR IN GSO-FLD.
           MOVE FRM-CPIM-UBY TO GSO-COD-RSEG-ATR IN GSO-FLD.
           MOVE FRM-CPIM-UBY TO GSO-IND-PCUO-ATR IN GSO-FLD.
           MOVE FRM-CPIM-UBY TO GSO-NUM-CUOT-ATR IN GSO-FLD.
      *<<<< FIN_UNP_GSO_GSO
           IF SCR-CMND = 'AEG'
              MOVE FRM-CPIM-AEY TO GSO-COD-EST2-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-COD-RSEG-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-IND-PCUO-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-NUM-CUOT-ATR IN GSO-FLD
              GO TO FIN-UNP-GSO-GSO.
              
           IF SCR-CMND = 'AEJ'
              MOVE FRM-CPIM-AEY TO GSO-COD-ESGA-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-COD-RSEG-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-IND-PCUO-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-NUM-CUOT-ATR IN GSO-FLD
              GO TO FIN-UNP-GSO-GSO.
      *>>>>
       FIN-UNP-GSO-GSO.
           EXIT.
       
       UNP-DBC-GSO SECTION.
       INI-UNP-DBC-GSO.
       FIN-UNP-DBC-GSO.
           EXIT.
       
       VAL-MKY-GSO SECTION.
       INI-VAL-MKY-GSO.
       FIN-VAL-MKY-GSO.
           EXIT.
       
       VAL-FLD-GSO SECTION.
       INI-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-CLAS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CLAS-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-TOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOPE-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-SOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SOPE-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-EST1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EST1-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-GSO-COD-ESGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSO-COD-ESGA-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-ESGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ESGA-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-FEC-ESGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-FEC-ESGA-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GSO-COD-EST2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSO-COD-EST2-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-EST2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EST2-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-FEC-ESO2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-FEC-ESO2-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-GSO-COD-USER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSO-COD-USER-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-USER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-USER-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-GSO-COD-RSEG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSO-COD-RSEG-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-RSEG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RSEG-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-TPOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TPOL-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-GSO-IND-PCUO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSO-IND-PCUO-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-FRM-GLS-PCUO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PCUO-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
           PERFORM VAL-GSO-NUM-CUOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GSO-NUM-CUOT-LEN IN GSO-FLD
                GO TO FIN-VAL-FLD-GSO.
       FIN-VAL-FLD-GSO.
           EXIT.
       
       VAL-FRM-GLS-CLAS SECTION.
       INI-VAL-FRM-GLS-CLAS.
       FIN-VAL-FRM-GLS-CLAS.
           EXIT.
       
       VAL-FRM-GLS-TOPE SECTION.
       INI-VAL-FRM-GLS-TOPE.
       FIN-VAL-FRM-GLS-TOPE.
           EXIT.
       
       VAL-FRM-GLS-SOPE SECTION.
       INI-VAL-FRM-GLS-SOPE.
       FIN-VAL-FRM-GLS-SOPE.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
      *<<<< DBC_GLS_NOMC
      *Busca nombre del cliente.
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-NUM-SBGL IN GSL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-GSL.
           IF NOT FIO-STAT-OKS
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'SOL  NOEXI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
              GO TO FIN-VAL-DBC-GLS-NOMC.
 
           MOVE GSL-CIC-DCLI IN GSL TO DBC-CIC-ICLI IN DBC.
           MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
              MOVE '00' TO PGM-STAT-DBC
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                    PERFORM CPT-BLKS
              MOVE CPT-STRN            TO DBC-GLS-NOMC IN GSO-FLD
           ELSE
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
              GO TO FIN-VAL-DBC-GLS-NOMC.
      *>>>>
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-FRM-GLS-EST1 SECTION.
       INI-VAL-FRM-GLS-EST1.
      *<<<< FRM_GLS_EST1 
      * EVA-INI  11/08                                                  
           MOVE GSO-CAI-GTIA IN GSO-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'BGL'          TO MSG-COD-SIST                       
              MOVE 'GDG    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-FRM-GLS-EST1.                               
      * EVA-FIN  11/08                                                  
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-IND-EST1 IN GDG > SPACES
             MOVE 'BGL' TO TAB-COD-SIST
             MOVE 'ES1'                TO TAB-COD-TTAB IN TAB
             MOVE GDG-IND-EST1 IN GDG  TO TAB-COD-CTAB IN TAB
             PERFORM BUS-TAB
             MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EST1 IN GSO-FLD.
      *>>>>
       FIN-VAL-FRM-GLS-EST1.
           EXIT.
       
       VAL-GSO-COD-ESGA SECTION.
       INI-VAL-GSO-COD-ESGA.
           IF GSO-COD-ESGA IN GSO-FLD NOT > SPACES
              MOVE SPACES TO GSO-COD-ESGA IN GSO-FLD.
      *<<<< GSO_COD_ESGA
           IF SCR-CMND NOT = 'AEG' 
                GO TO OBT-GLS-ESGA.

           MOVE 'BGL'  TO TAB-COD-SIST. 
           MOVE 'EGS ' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSO-COD-ESGA IN GSO-FLD TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               GO TO VAL-CORR-ORDEN
           ELSE
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'GSO ESTNOVAL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE FRM-POS-CURS TO GSO-COD-ESGA-LEN IN GSO-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSO-COD-ESGA.

       VAL-CORR-ORDEN.                 
           
      *MHM-INI 01-DIC-2003
      *     IF GSO-COD-ESGA IN GSO-FLD     = '02' AND
      *        SCR-COD-GSO-ANT IN SCR-VARI = '01'
      *         GO TO OBT-GLS-ESGA.
      *MHM-FIN 01-DIC-2003

           IF GSO-COD-ESGA IN GSO-FLD     = '03' AND
              SCR-COD-GSO-ANT IN SCR-VARI = '02'
              IF SCR-COD-TPRO IN SCR-VARI = 'S'
                 MOVE '02' TO GSO-COD-EST2 IN GSO-FLD
                 GO TO OBT-GLS-ESGA
              ELSE
                 GO TO OBT-GLS-ESGA.

           IF GSO-COD-ESGA IN GSO-FLD     = '06' 
              IF SCR-COD-TPRO IN SCR-VARI = 'S'
                 IF SCR-COD-GSO-ANT IN SCR-VARI = '03'
                    GO TO OBT-GLS-ESGA
                 ELSE  
                    GO TO ERROR-EN-ORDEN
              ELSE
              IF SCR-COD-GSO-ANT IN SCR-VARI = '03' AND
                 SCR-COD-JUD-ANT IN SCR-VARI = '05'
                 GO TO OBT-GLS-ESGA
              ELSE
                 GO TO ERROR-EN-ORDEN.

           IF  GSO-COD-ESGA IN GSO-FLD     = '07' AND 
             ( SCR-COD-GSO-ANT IN SCR-VARI = '06' OR
               SCR-COD-GSO-ANT IN SCR-VARI = '11')
               GO TO OBT-GLS-ESGA.

      *MHM-INI 01-DIC-2003
      *     IF GSO-COD-ESGA IN GSO-FLD     = '10' AND 
      *        SCR-COD-GSO-ANT IN SCR-VARI = '07'
      *         GO TO OBT-GLS-ESGA.
      *MHM-FIN 01-DIC-2003

           IF GSO-COD-ESGA IN GSO-FLD = '11'    AND
              SCR-COD-GSO-ANT IN SCR-VARI  = '06' 
                GO TO OBT-GLS-ESGA.

           IF GSO-COD-ESGA IN GSO-FLD = '12'    AND
              SCR-COD-GSO-ANT IN SCR-VARI NOT = '10' 
              GO TO OBT-GLS-ESGA.


       ERROR-EN-ORDEN.
           MOVE SPACES TO FRM-GLS-ESGA IN GSO-FLD.
           MOVE 'BGL'          TO MSG-COD-SIST.
           MOVE 'GSOEST NOVAL' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE FRM-POS-CURS TO GSO-COD-ESGA-LEN IN GSO-FLD.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-GSO-COD-ESGA.

       OBT-GLS-ESGA.
      *PVG INI 15-OCT-2003
           IF GSO-COD-ESGA IN GSO-FLD     = '03'
              MOVE GSO-CAI-GTIA IN GSO-FLD TO GVT-CAI-GTIA IN GVT 
              MOVE GSO-IIC-GTIA IN GSO-FLD TO GVT-IIC-GTIA IN GVT 
              MOVE ZEROES                  TO GVT-COD-TASN IN GVT 
              MOVE FIO-GET-NLS             TO FIO-CMND
              PERFORM BGL-FIO-GVT 
              IF NOT (FIO-STAT-OKS AND
                      GVT-CAI-GTIA IN GVT = GSO-CAI-GTIA IN GSO-FLD AND
                      GVT-IIC-GTIA IN GVT = GSO-IIC-GTIA IN GSO-FLD )
                 MOVE SPACES         TO FRM-GLS-ESGA IN GSO-FLD
                 MOVE 'BGL'          TO MSG-COD-SIST
                 MOVE 'GSOGVT   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE FRM-POS-CURS TO GSO-COD-ESGA-LEN IN GSO-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GSO-COD-ESGA.
           IF GSO-COD-ESGA IN GSO-FLD     = '07'
              MOVE GSO-CAI-GTIA IN GSO-FLD TO GSE-CAI-GTIA IN GSE 
              MOVE GSO-IIC-GTIA IN GSO-FLD TO GSE-IIC-GTIA IN GSE 
              MOVE ZEROES                  TO GSE-NUM-IGSE IN GSE 
              MOVE FIO-GET-NLS             TO FIO-CMND 
              PERFORM BGL-FIO-GSE 
              IF NOT (FIO-STAT-OKS AND
                      GSE-CAI-GTIA IN GSE = GSO-CAI-GTIA IN GSO-FLD AND
                      GSE-IIC-GTIA IN GSE = GSO-IIC-GTIA IN GSO-FLD )
                 MOVE SPACES         TO FRM-GLS-ESGA IN GSO-FLD
                 MOVE 'BGL'          TO MSG-COD-SIST
                 MOVE 'GSOGSE   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE FRM-POS-CURS TO GSO-COD-ESGA-LEN IN GSO-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GSO-COD-ESGA.

           IF GSO-COD-ESGA IN GSO-FLD > SPACES
              MOVE 'BGL'                   TO TAB-COD-SIST
              MOVE 'EGS '                  TO TAB-COD-TTAB IN TAB
              MOVE GSO-COD-ESGA IN GSO-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESGA IN GSO-FLD.
      *PVG FIN 15-OCT-2003
      *>>>>
       FIN-VAL-GSO-COD-ESGA.
           EXIT.
       
       VAL-FRM-GLS-ESGA SECTION.
       INI-VAL-FRM-GLS-ESGA.
       FIN-VAL-FRM-GLS-ESGA.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-FRM-FEC-ESGA SECTION.
       INI-VAL-FRM-FEC-ESGA.
           IF FRM-FEC-ESGA IN GSO-FLD  NOT > ZEROES
              MOVE ZEROES TO FRM-FEC-ESGA IN GSO-FLD.
      *<<<< FRM_FEC_ESGA
           IF SCR-CMND = 'ING' OR 'AEG'
              GO TO FIN-VAL-FRM-FEC-ESGA.
           MOVE GSO-NUM-DSOL IN GSO TO WSS-NUM-DEDIT IN WSS-VARI.
           MOVE GSO-NUM-MSOL IN GSO TO WSS-NUM-MEDIT IN WSS-VARI.
           MOVE GSO-NUM-SSOL IN GSO TO WSS-NUM-SEDIT IN WSS-VARI.
           MOVE GSO-NUM-ASOL IN GSO TO WSS-NUM-AEDIT IN WSS-VARI.
           MOVE WSS-FEC-EDIT IN WSS-VARI TO 
                FRM-FEC-ESGA IN GSO-FLD.
      *>>>>
       FIN-VAL-FRM-FEC-ESGA.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GSO-COD-EST2 SECTION.
       INI-VAL-GSO-COD-EST2.
           IF GSO-COD-EST2 IN GSO-FLD NOT > SPACES
              MOVE SPACES TO GSO-COD-EST2 IN GSO-FLD.
      *<<<< GSO_COD_EST2
      *CGL-FIN  11-SEP-2003 12:22:53 
           IF SCR-CMND NOT = 'AEJ' 
                GO TO OBT-GLS-EST2.

           MOVE 'BGL'  TO TAB-COD-SIST. 
           MOVE 'ET2 ' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSO-COD-EST2 IN GSO-FLD TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               GO TO VAL-CORR-ORDEN-1
           ELSE
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'GSO ESTNOVAL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSO-COD-EST2.

       VAL-CORR-ORDEN-1.                 
           
           IF GSO-COD-EST2 IN GSO-FLD     = '03' AND 
              SCR-COD-JUD-ANT IN SCR-VARI = '02'
               GO TO OBT-GLS-EST2.

           IF GSO-COD-EST2 IN GSO-FLD     = '04' AND 
              SCR-COD-JUD-ANT IN SCR-VARI = '03'
                 GO TO OBT-GLS-EST2.

           IF GSO-COD-EST2 IN GSO-FLD     = '05' AND
              SCR-COD-JUD-ANT IN SCR-VARI = '04'
      * INI-EVA   10/07                                                 
              MOVE SPACES TO MSG-COD-MENS                               
              PERFORM GSO-GLE                                           
              IF MSG-COD-MENS > SPACES                                  
                 GO TO FIN-VAL-GSO-COD-EST2                             
              ELSE                                                      
      * FIN-EVA   10/07                                                 
                 GO TO OBT-GLS-EST2.

       ERROR-EN-ORDEN-1.
           MOVE SPACES TO FRM-GLS-EST2 IN GSO-FLD.
           MOVE 'BGL'          TO MSG-COD-SIST.
           MOVE 'GSOEST NOVAL' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-GSO-COD-EST2.

       OBT-GLS-EST2.
      *PVG INI 15-OCT-2003
           IF GSO-COD-EST2 IN GSO-FLD     = '03'
              MOVE GSO-CAI-GTIA IN GSO-FLD TO GAP-CAI-GTIA IN GAP 
              MOVE GSO-IIC-GTIA IN GSO-FLD TO GAP-IIC-GTIA IN GAP 
              MOVE ZEROES                  TO GAP-COD-PACR IN GAP 
              MOVE FIO-GET-NLS             TO FIO-CMND 
              PERFORM BGL-FIO-GAP 
              IF NOT (FIO-STAT-OKS AND
                      GAP-CAI-GTIA IN GAP = GSO-CAI-GTIA IN GSO-FLD AND
                      GAP-IIC-GTIA IN GAP = GSO-IIC-GTIA IN GSO-FLD )
                 MOVE SPACES         TO FRM-GLS-ESGA IN GSO-FLD
                 MOVE 'BGL'          TO MSG-COD-SIST
                 MOVE 'GSOGAP   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GSO-COD-EST2.
           IF GSO-COD-EST2 IN GSO-FLD     = '04' OR '05'
              MOVE GSO-CAI-GTIA IN GSO-FLD TO GLE-CAI-GTIA IN GLE 
              MOVE GSO-IIC-GTIA IN GSO-FLD TO GLE-IIC-GTIA IN GLE 
              MOVE SPACES                  TO GLE-COD-PACR IN GLE 
              MOVE FIO-GET-NLS             TO FIO-CMND 
              PERFORM BGL-FIO-GLE 
              IF NOT (FIO-STAT-OKS AND
                      GLE-CAI-GTIA IN GLE = GSO-CAI-GTIA IN GSO-FLD AND
                      GLE-IIC-GTIA IN GLE = GSO-IIC-GTIA IN GSO-FLD )
                 MOVE SPACES         TO FRM-GLS-ESGA IN GSO-FLD
                 MOVE 'BGL'          TO MSG-COD-SIST
                 MOVE 'GSOGLE   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GSO-COD-EST2.

           IF GSO-COD-EST2 IN GSO-FLD > SPACES
              MOVE 'BGL'  TO TAB-COD-SIST
              MOVE 'ET2 ' TO TAB-COD-TTAB IN TAB
              MOVE GSO-COD-EST2 IN GSO-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-EST2 IN GSO-FLD.
      *PVG FIN 15-OCT-2003
      *CGL-FIN  11-SEP-2003 12:22:44 
      *>>>>
       FIN-VAL-GSO-COD-EST2.
           EXIT.
       
       VAL-FRM-GLS-EST2 SECTION.
       INI-VAL-FRM-GLS-EST2.
       FIN-VAL-FRM-GLS-EST2.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-FRM-FEC-ESO2 SECTION.
       INI-VAL-FRM-FEC-ESO2.
           IF FRM-FEC-ESO2 IN GSO-FLD  NOT > ZEROES
              MOVE ZEROES TO FRM-FEC-ESO2 IN GSO-FLD.
      *<<<< FRM_FEC_ESO2
      *MHM-INI 24-MAR-2004                                              
           IF SCR-CMND = 'AEJ'                                          
               PERFORM GET-FHOY                                         
               MOVE HOY-DHOY TO FRM-NUM-DSO2 IN GSO-FLD                 
               MOVE HOY-MHOY TO FRM-NUM-MSO2 IN GSO-FLD                 
               MOVE HOY-SHOY TO FRM-NUM-SSO2 IN GSO-FLD                 
               MOVE HOY-AHOY TO FRM-NUM-ASO2 IN GSO-FLD                 
               GO TO FIN-VAL-FRM-FEC-ESO2.                              
                                                                        
      *     IF SCR-CMND = 'ING' OR 'AEJ'                                
           IF SCR-CMND = 'ING'                                          
      *MHM-FIN 24-MAR-2004           
              GO TO FIN-VAL-FRM-FEC-ESO2.
           MOVE GSO-NUM-DSO2 IN GSO TO WSS-NUM-DEDII IN WSS-VARI.
           MOVE GSO-NUM-MSO2 IN GSO TO WSS-NUM-MEDII IN WSS-VARI.
           MOVE GSO-NUM-SSO2 IN GSO TO WSS-NUM-SEDII IN WSS-VARI.
           MOVE GSO-NUM-ASO2 IN GSO TO WSS-NUM-AEDII IN WSS-VARI.
           MOVE WSS-FEC-EDII IN WSS-VARI TO 
                FRM-FEC-ESO2 IN GSO-FLD.
      *>>>>
       FIN-VAL-FRM-FEC-ESO2.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-GSO-COD-USER SECTION.
       INI-VAL-GSO-COD-USER.
      *<<<< GSO_COD_USER
           IF GSO-COD-USER IN GSO-FLD NOT > SPACES
               MOVE SPACES TO GSO-COD-USER IN GSO-FLD.
      *>>>>
       FIN-VAL-GSO-COD-USER.
           EXIT.
       
       VAL-FRM-GLS-USER SECTION.
       INI-VAL-FRM-GLS-USER.
       FIN-VAL-FRM-GLS-USER.
           EXIT.
       
       VAL-GSO-COD-RSEG SECTION.
       INI-VAL-GSO-COD-RSEG.
           IF GSO-COD-RSEG IN GSO-FLD NOT > SPACES
              MOVE SPACES TO GSO-COD-RSEG IN GSO-FLD.
      *<<<< GSO_COD_RSEG
      *CGL-INI  8-SEP-2003 18:37:16 
      * EVA                                                             
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-KEY-IGSL IN GSL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-VAL-GSO-COD-RSEG.                               
                                                                        
      * EVA-INI 11/08                                                   
           IF GSL-COD-TSOL IN GSL = 'R'                                 
              GO TO FIN-VAL-GSO-COD-RSEG.                               
                                                                        
           IF SCR-CMND = 'ING' OR SCR-CMND = 'INE'                      
              IF GSO-COD-RSEG IN GSO-FLD NOT > SPACES AND               
                 GSL-COD-TSOL IN GSL = 'T'                              
                 PERFORM ERR-GLS                                        
                 GO TO FIN-VAL-GSO-COD-RSEG.                            
                                                                        
      *    IF SCR-CMND = 'ING' AND GSL-COD-TSOL IN GSL = 'R' OR         
           IF SCR-CMND = 'ING' AND GSL-COD-TSOL IN GSL = 'D' OR         
              SCR-CMND = 'ING' AND GSL-COD-TSOL IN GSL = 'I' OR         
      *       SCR-CMND = 'AEG' AND GSL-COD-TSOL IN GSL = 'R' OR         
      *       SCR-CMND = 'AEJ' AND GSL-COD-TSOL IN GSL = 'R' OR         
              SCR-CMND = 'INE' AND GSL-COD-TSOL IN GSL = 'D'            
              GO TO FIN-VAL-GSO-COD-RSEG.                               
                                                                        
           IF GSO-COD-RSEG IN GSO-FLD > SPACES                          
              GO TO NXT-VAL-GSO-COD-RSEG.                               
                                                                        
           MOVE GSO-CAI-GTIA IN GSO-FLD TO GDG-CAI-GTIA IN GDG.         
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GDG-IIC-GTIA IN GDG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GDG.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'BGL'          TO MSG-COD-SIST                       
              MOVE 'GDG    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-GSO-COD-RSEG.                               
                                                                        
      * EVA-FIN 11/08                                                   
           MOVE GDG-COD-TOPE IN GDG TO TAG-COD-TOPE IN TAG.             
           MOVE GDG-COD-SOPE IN GDG TO TAG-COD-SOPE IN TAG.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE SPACES TO FRM-GLS-RSEG IN GSO-FLD                    
              MOVE 'BGL'         TO MSG-COD-SIST                        
              MOVE 'GSO TAGNEXI' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE FRM-POS-CURS TO GSO-COD-RSEG-LEN IN GSO-FLD          
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-GSO-COD-RSEG.                               
                                                                        
           IF TAG-IND-EGSE IN TAG = 'S'                                 
              MOVE 'BGL'          TO MSG-COD-SIST                       
              MOVE 'GSO INDOBLI' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE FRM-POS-CURS TO GSO-COD-RSEG-LEN IN GSO-FLD          
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-GSO-COD-RSEG                                
            ELSE                                                        
              MOVE SPACES TO FRM-GLS-RSEG IN GSO-FLD                    
              GO TO FIN-VAL-GSO-COD-RSEG.                               
                                                                        
       NXT-VAL-GSO-COD-RSEG.                                            
      *VAL-COD Valida codigo de tabla                   
           MOVE 'BGL' TO TAB-COD-SIST.             
           MOVE 'RPB ' TO TAB-COD-TTAB IN TAB.     
           MOVE GSO-COD-RSEG IN GSO-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.                                        
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES TO FRM-GLS-RSEG IN GSO-FLD 
              PERFORM GET-MSG
              MOVE FRM-POS-CURS TO GSO-COD-RSEG-LEN IN GSO-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GSO-COD-RSEG
            ELSE 
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-RSEG IN GSO-FLD.    
      *CGL-FIN  8-SEP-2003 18:44:55 
      *>>>>
       FIN-VAL-GSO-COD-RSEG.
           EXIT.
       
       VAL-FRM-GLS-RSEG SECTION.
       INI-VAL-FRM-GLS-RSEG.
       FIN-VAL-FRM-GLS-RSEG.
           EXIT.
       
       VAL-FRM-GLS-TPOL SECTION.
       INI-VAL-FRM-GLS-TPOL.
       FIN-VAL-FRM-GLS-TPOL.
           EXIT.
       
       VAL-GSO-IND-PCUO SECTION.
       INI-VAL-GSO-IND-PCUO.
           IF GSO-IND-PCUO IN GSO-FLD NOT > SPACES
              MOVE SPACES TO GSO-IND-PCUO IN GSO-FLD.
      *<<<< GSO_IND_PCUO
      *CGL-INI  8-SEP-2003 19:07:43 
      * EVA                                                             
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-KEY-IGSL IN GSL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-VAL-GSO-IND-PCUO.                                
                                                                        
      * EVA-INI 11/08                                                   
           IF GSL-COD-TSOL IN GSL = 'R'                                 
              GO TO FIN-VAL-GSO-IND-PCUO.                               
                                                                        
      *    IF SCR-CMND = 'ING' AND GSL-COD-TSOL IN GSL = 'R' OR         
           IF SCR-CMND = 'ING' AND GSL-COD-TSOL IN GSL = 'D' OR         
              SCR-CMND = 'ING' AND GSL-COD-TSOL IN GSL = 'I' OR         
      *       SCR-CMND = 'AEG' AND GSL-COD-TSOL IN GSL = 'R' OR         
      *       SCR-CMND = 'AEJ' AND GSL-COD-TSOL IN GSL = 'R' OR         
              SCR-CMND = 'INE' AND GSL-COD-TSOL IN GSL = 'D'            
                  GO TO FIN-VAL-GSO-IND-PCUO.                           
                                                                        
            IF GSO-IND-PCUO IN GSO-FLD NOT > SPACES
      *PVG INI 14-OCT-2003
      *        IF GSO-COD-RSEG IN GSO-FLD = '01'
               IF GSO-COD-RSEG IN GSO-FLD = '1'
      *PVG FIN 14-OCT-2003
                  MOVE SPACES TO FRM-GLS-PCUO IN GSO-FLD
                  MOVE 'BGL'          TO MSG-COD-SIST
                  MOVE 'GSO INDOBLI'  TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE FRM-POS-CURS TO GSO-IND-PCUO-LEN IN GSO-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GSO-IND-PCUO
               ELSE
                  MOVE SPACES TO FRM-GLS-PCUO IN GSO-FLD.

      * EVA-INI  11/08                                                  
           IF GSO-IND-PCUO IN GSO-FLD NOT > SPACES                      
              GO TO FIN-VAL-GSO-IND-PCUO.                               
      * EVA-FIN  11/08                                                  
                                                                        
           MOVE 'BGL' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB. 
           MOVE GSO-IND-PCUO IN GSO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.   
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES TO FRM-GLS-PCUO IN GSO-FLD 
              PERFORM GET-MSG
              MOVE FRM-POS-CURS TO GSO-IND-PCUO-LEN IN GSO-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GSO-IND-PCUO
            ELSE 
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-PCUO IN GSO-FLD. 
      *CGL-FIN  8-SEP-2003 19:16:37  
      *>>>>
       FIN-VAL-GSO-IND-PCUO.
           EXIT.
       
       VAL-FRM-GLS-PCUO SECTION.
       INI-VAL-FRM-GLS-PCUO.
       FIN-VAL-FRM-GLS-PCUO.
           EXIT.
       
       VAL-GSO-NUM-CUOT SECTION.
       INI-VAL-GSO-NUM-CUOT.
      *<<<< GSO_NUM_CUOT
      *PVG INI 14-OCT-2003
      * EVA                                                             
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-KEY-IGSL IN GSL.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-GSL.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-VAL-GSO-NUM-CUOT.                                
                                                                        
      * EVA-INI  11/08                                                  
      *    IF SCR-CMND = 'ING' AND GSL-COD-TSOL IN GSL = 'R' OR         
      *       SCR-CMND = 'ING' AND GSL-COD-TSOL IN GSL = 'D' OR         
      *       SCR-CMND = 'ING' AND GSL-COD-TSOL IN GSL = 'I' OR         
      *       SCR-CMND = 'AEG' AND GSL-COD-TSOL IN GSL = 'R' OR         
      *       SCR-CMND = 'AEJ' AND GSL-COD-TSOL IN GSL = 'R' OR         
      *       SCR-CMND = 'INE' AND GSL-COD-TSOL IN GSL = 'D'            
      *            GO TO FIN-VAL-GSO-NUM-CUOT.                          
      * EVA-FIN  11/08                                                  
                                                                        
           IF GSO-IND-PCUO IN GSO-FLD = 'N'
              MOVE ZEROES TO GSO-NUM-CUOT IN GSO-FLD.

           IF GSO-IND-PCUO IN GSO-FLD = 'S' AND
              GSO-NUM-CUOT IN GSO-FLD NOT > ZEROES
              MOVE 'BGL'          TO MSG-COD-SIST
              MOVE 'GSO NCUOOBLI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE FRM-POS-CURS TO GSO-NUM-CUOT-LEN IN GSO-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *PVG FIN 14-OCT-2003
      *>>>>
       FIN-VAL-GSO-NUM-CUOT.
           EXIT.
       
       VAL-CON-FLD-GSO SECTION.
       INI-VAL-CON-FLD-GSO.
       FIN-VAL-CON-FLD-GSO.
           EXIT.
       
       VAL-CON-GSO SECTION.
       INI-VAL-CON-GSO.
       FIN-VAL-CON-GSO.
           EXIT.
       
       VAL-NUM-KEY-GSO SECTION.
       INI-VAL-NUM-KEY-GSO.
           PERFORM VAL-NUM-IKY-GSO.
           PERFORM VAL-NUM-MKY-GSO.
           PERFORM VAL-NUM-AKY-GSO.
       FIN-VAL-NUM-KEY-GSO.
           EXIT.
       
       VAL-NUM-IKY-GSO SECTION.
       INI-VAL-NUM-IKY-GSO.
       VAL-NUM-GSO-IIC-GTIA.
           MOVE GSO-IIC-GTIA-ALF IN GSO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSO-IIC-GTIA IN GSO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSO-IIC-GTIA-LEN IN GSO-FLD
                GO TO FIN-VAL-NUM-IKY-GSO.
       FIN-VAL-NUM-IKY-GSO.
           EXIT.
       
       VAL-NUM-MKY-GSO SECTION.
       INI-VAL-NUM-MKY-GSO.
       FIN-VAL-NUM-MKY-GSO.
           EXIT.
       
       VAL-NUM-AKY-GSO SECTION.
       INI-VAL-NUM-AKY-GSO.
       VAL-NUM-GSO-NUM-SBGL.
           MOVE GSO-NUM-SBGL-ALF IN GSO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSO-NUM-SBGL IN GSO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSO-NUM-SBGL-LEN IN GSO-FLD
                GO TO FIN-VAL-NUM-AKY-GSO.
       FIN-VAL-NUM-AKY-GSO.
           EXIT.
       
       VAL-NUM-FLD-GSO SECTION.
       INI-VAL-NUM-FLD-GSO.
       VAL-NUM-GSO-NUM-CUOT.
           MOVE GSO-NUM-CUOT-ALF IN GSO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO GSO-NUM-CUOT IN GSO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO GSO-NUM-CUOT-LEN IN GSO-FLD
                GO TO FIN-VAL-NUM-FLD-GSO.
       FIN-VAL-NUM-FLD-GSO.
           EXIT.
       
       EDT-KEY-GSO SECTION.
       INI-EDT-KEY-GSO.
           PERFORM EDT-IKY-GSO.
           PERFORM EDT-MKY-GSO.
           PERFORM EDT-AKY-GSO.
       FIN-EDT-KEY-GSO.
           EXIT.
       
       EDT-IKY-GSO SECTION.
       INI-EDT-IKY-GSO.
           IF GSO-IIC-GTIA-LEN IN GSO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSO-IIC-GTIA-LEN IN GSO-FLD
                GO TO FIN-EDT-IKY-GSO.
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GSO-IIC-GTIA-EDT IN GSO-EDT.
           MOVE GSO-IIC-GTIA-EDT IN GSO-EDT TO 
                GSO-IIC-GTIA-ALF IN GSO-FLD.
       FIN-EDT-IKY-GSO.
           EXIT.
       
       EDT-MKY-GSO SECTION.
       INI-EDT-MKY-GSO.
       FIN-EDT-MKY-GSO.
           EXIT.
       
       EDT-AKY-GSO SECTION.
       INI-EDT-AKY-GSO.
           IF GSO-NUM-SBGL-LEN IN GSO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSO-NUM-SBGL-LEN IN GSO-FLD
                GO TO FIN-EDT-AKY-GSO.
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSO-NUM-SBGL-EDT IN GSO-EDT.
           MOVE GSO-NUM-SBGL-EDT IN GSO-EDT TO 
                GSO-NUM-SBGL-ALF IN GSO-FLD.
       FIN-EDT-AKY-GSO.
           EXIT.
       
       EDT-FLD-GSO SECTION.
       INI-EDT-FLD-GSO.
           IF GSO-NUM-CUOT-LEN IN GSO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GSO-NUM-CUOT-LEN IN GSO-FLD
                GO TO FIN-EDT-FLD-GSO.
           MOVE GSO-NUM-CUOT IN GSO-FLD TO GSO-NUM-CUOT-EDT IN GSO-EDT.
           MOVE GSO-NUM-CUOT-EDT IN GSO-EDT TO 
                GSO-NUM-CUOT-ALF IN GSO-FLD.
       FIN-EDT-FLD-GSO.
           EXIT.
      *<<<<
                                                                        
      * INI-EVA   10/07                                                 
                                                                        
       GSO-GLE SECTION.                                                 
       INI-GSO-GLE.                                                     
                                                                        
           IF SCR-CMND NOT = 'AEJ'                                      
              GO TO FIN-GSO-GLE.                                        
                                                                        
           MOVE GSO-CAI-GTIA IN GSO-FLD TO GLE-CAI-GTIA IN GLE.         
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GLE-IIC-GTIA IN GLE.         
           MOVE SPACES                  TO GLE-COD-PACR IN GLE.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-GSO-GLE.                                                     
           PERFORM BGL-FIO-GLE.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              GSO-CAI-GTIA IN GSO-FLD = GLE-CAI-GTIA IN GLE AND         
              GSO-IIC-GTIA IN GSO-FLD = GLE-IIC-GTIA IN GLE)            
              GO TO FIN-GSO-GLE.                                        
                                                                        
           IF NOT (GLE-COD-NTRO IN GLE > SPACES AND                     
               GLE-IND-ITIN IN GLE > SPACES AND                         
               GLE-COD-REGI IN GLE > SPACES AND                         
               GLE-COD-LREG IN GLE > SPACES AND                         
               GLE-COD-COMU IN GLE > SPACES AND                         
               GLE-NUM-ESCR IN GLE > ZEROES AND                         
               GLE-FEC-FESC IN GLE > ZEROES AND                         
               GLE-COD-FICR IN GLE > SPACES AND                         
               GLE-COD-FPHG IN GLE > SPACES AND                         
               GLE-NUM-NICR IN GLE > ZEROES AND                         
               GLE-NUM-NPHG IN GLE > ZEROES AND                         
               GLE-NUM-AICR IN GLE > ZEROES AND                         
               GLE-NUM-APHG IN GLE > ZEROES)                            
                                                                        
                MOVE 'BGL' TO MSG-COD-SIST                              
                MOVE 'GLE   ERRDAT' TO MSG-COD-MENS                     
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
                GO TO FIN-GSO-GLE.                                      
                                                                        
           MOVE SPACES TO MSG-COD-MENS.                                 
                                                                        
       NXT-GSO-GLE.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-GSO-GLE.                                           
                                                                        
       FIN-GSO-GLE.                                                     
           EXIT.                                                        
                                                                        
      * FIN-EVA   10/07                                                 
      *>>>>
