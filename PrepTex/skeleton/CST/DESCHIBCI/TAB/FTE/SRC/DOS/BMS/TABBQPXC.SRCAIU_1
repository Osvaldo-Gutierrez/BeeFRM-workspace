      * 22-Apr-99 02:28 PM
       PUT-ALL-PXC SECTION.
       INI-PUT-ALL-PXC.
           PERFORM PUT-TXC-PXC.
       FIN-PUT-ALL-PXC.
           EXIT.

       PUT-TXC-PXC SECTION.
       INI-PUT-TXC-PXC.
           IF PGM-STAT-TXC-NUL
               GO TO FIN-PUT-TXC-PXC.
           IF NOT PGM-STAT-TXC-OKS
               PERFORM CLR-TXC-PXC
               GO TO FIN-PUT-TXC-PXC.
           MOVE TXC-COD-PLZO IN TXC TO TXC-COD-PLZO IN PXC-FLD.
           MOVE TXC-COD-VCOC IN TXC TO TXC-COD-VCOC IN PXC-FLD.
       FIN-PUT-TXC-PXC.
           EXIT.

       KEY-ALL-PXC SECTION.
       INI-KEY-ALL-PXC.
           PERFORM KEY-TXC-PXC.
       FIN-KEY-ALL-PXC.
           EXIT.

       KEY-TXC-PXC SECTION.
       INI-KEY-TXC-PXC.
           MOVE TXC-COD-PLZO IN PXC-FLD TO TXC-COD-PLZO IN TXC.
           MOVE TXC-COD-VCOC IN PXC-FLD TO TXC-COD-VCOC IN TXC.
       FIN-KEY-TXC-PXC.
           EXIT.

       SCR-CLRA-PXC SECTION.
       INI-SCR-CLRA-PXC.
           PERFORM CLR-KEY-PXC.
           PERFORM CLR-FLD-PXC.
       FIN-SCR-CLRA-PXC.
           EXIT.

       CLR-KEY-PXC SECTION.
       INI-CLR-KEY-PXC.
           MOVE SPACES TO TXC-COD-PLZO IN PXC-FLD.
           MOVE SPACES TO TXC-COD-VCOC IN PXC-FLD.
           MOVE ZEROES TO FRM-SGV-MNTO IN PXC-FLD.
           MOVE ZEROES TO FRM-FEC-FEC1 IN PXC-FLD.
           MOVE ZEROES TO FRM-FEC-FEC2 IN PXC-FLD.
           MOVE ZEROES TO FRM-SGV-VTXC IN PXC-FLD.
           MOVE ZEROES TO FRM-SGV-ATXC IN PXC-FLD.
       FIN-CLR-KEY-PXC.
           EXIT.

       CLR-FLD-PXC SECTION.
       INI-CLR-FLD-PXC.
           PERFORM CLR-TXC-PXC.
       FIN-CLR-FLD-PXC.
           EXIT.

       CLR-TXC-PXC SECTION.
       INI-CLR-TXC-PXC.
       FIN-CLR-TXC-PXC.
           EXIT.

       FST-KEY-PXC SECTION.
       INI-FST-KEY-PXC.
           MOVE -1 TO TXC-COD-PLZO-LEN IN PXC-FLD.
       FIN-FST-KEY-PXC.
           EXIT.

       FST-FLD-PXC SECTION.
       INI-FST-FLD-PXC.
       FIN-FST-FLD-PXC.
           EXIT.

       PRO-KEY-PXC SECTION.
       INI-PRO-KEY-PXC.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MNTO-ATR IN PXC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-FEC-FEC1-ATR IN PXC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-FEC-FEC2-ATR IN PXC-FLD.
           PERFORM PRO-IKY-PXC.
           PERFORM PRO-AKY-PXC.
           PERFORM PRO-MKY-PXC.
       FIN-PRO-KEY-PXC.
           EXIT.

       PRO-IKY-PXC SECTION.
       INI-PRO-IKY-PXC.
           MOVE FRM-CPIM-AEY TO TXC-COD-PLZO-ATR IN PXC-FLD.
           MOVE FRM-CPIM-AEY TO TXC-COD-VCOC-ATR IN PXC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MNTO-ATR IN PXC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-FEC-FEC1-ATR IN PXC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-FEC-FEC2-ATR IN PXC-FLD.
       FIN-PRO-IKY-PXC.
           EXIT.

       PRO-MKY-PXC SECTION.
       INI-PRO-MKY-PXC.
       FIN-PRO-MKY-PXC.
           EXIT.

       PRO-AKY-PXC SECTION.
       INI-PRO-AKY-PXC.
       FIN-PRO-AKY-PXC.
           EXIT.

       UNP-KEY-PXC SECTION.
       INI-UNP-KEY-PXC.
           MOVE FRM-CPIM-UBY TO FRM-SGV-MNTO-ATR IN PXC-FLD.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FEC1-ATR IN PXC-FLD.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FEC2-ATR IN PXC-FLD.
           PERFORM UNP-IKY-PXC.
           PERFORM UNP-AKY-PXC.
           PERFORM UNP-MKY-PXC.
       FIN-UNP-KEY-PXC.
           EXIT.

       UNP-IKY-PXC SECTION.
       INI-UNP-IKY-PXC.
           MOVE FRM-CPIM-UBY TO TXC-COD-PLZO-ATR.
           MOVE FRM-CPIM-UBY TO TXC-COD-VCOC-ATR.
           MOVE FRM-CPIM-UBY TO FRM-SGV-MNTO-ATR.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FEC1-ATR.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FEC2-ATR.
       FIN-UNP-IKY-PXC.
           EXIT.

       UNP-MKY-PXC SECTION.
       INI-UNP-MKY-PXC.
       FIN-UNP-MKY-PXC.
           EXIT.

       UNP-AKY-PXC SECTION.
       INI-UNP-AKY-PXC.
       FIN-UNP-AKY-PXC.
           EXIT.

       UNP-FLD-PXC SECTION.
       INI-UNP-FLD-PXC.
           PERFORM UNP-TXC-PXC.
       FIN-UNP-FLD-PXC.
           EXIT.

       UNP-TXC-PXC SECTION.
       INI-UNP-TXC-PXC.
       FIN-UNP-TXC-PXC.
           EXIT.

       VAL-KEY-PXC SECTION.
       INI-VAL-KEY-PXC.
           PERFORM VAL-IKY-PXC.
           PERFORM VAL-MKY-PXC.
           PERFORM VAL-AKY-PXC.
       FIN-VAL-KEY-PXC.
           EXIT.

       VAL-IKY-PXC SECTION.
       INI-VAL-IKY-PXC.
           PERFORM VAL-TXC-COD-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TXC-COD-PLZO-LEN IN PXC-FLD
                GO TO FIN-VAL-IKY-PXC.
           PERFORM VAL-TXC-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TXC-COD-VCOC-LEN IN PXC-FLD
                GO TO FIN-VAL-IKY-PXC.
           PERFORM VAL-FRM-SGV-MNTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-SGV-MNTO-LEN IN PXC-FLD
                GO TO FIN-VAL-IKY-PXC.
           PERFORM VAL-FRM-FEC-FEC1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-FEC-FEC1-LEN IN PXC-FLD
                GO TO FIN-VAL-IKY-PXC.
           PERFORM VAL-FRM-FEC-FEC2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-FEC-FEC2-LEN IN PXC-FLD
                GO TO FIN-VAL-IKY-PXC.
           PERFORM VAL-FRM-SGV-VTXC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-SGV-VTXC-LEN IN PXC-FLD
                GO TO FIN-VAL-IKY-PXC.
           PERFORM VAL-FRM-SGV-ATXC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-SGV-ATXC-LEN IN PXC-FLD
                GO TO FIN-VAL-IKY-PXC.
       FIN-VAL-IKY-PXC.
           EXIT.

       VAL-MKY-PXC SECTION.
       INI-VAL-MKY-PXC.
       FIN-VAL-MKY-PXC.
           EXIT.

       VAL-AKY-PXC SECTION.
       INI-VAL-AKY-PXC.
       FIN-VAL-AKY-PXC.
           EXIT.

       VAL-TXC-COD-PLZO SECTION.
       INI-VAL-TXC-COD-PLZO.
           IF TXC-COD-PLZO IN PXC-FLD NOT > SPACES
              MOVE SPACES TO TXC-COD-PLZO IN PXC-FLD.
       FIN-VAL-TXC-COD-PLZO.
           EXIT.

       VAL-TXC-COD-VCOC SECTION.
       INI-VAL-TXC-COD-VCOC.
           IF TXC-COD-VCOC IN PXC-FLD NOT > SPACES
              MOVE SPACES TO TXC-COD-VCOC IN PXC-FLD.
       FIN-VAL-TXC-COD-VCOC.
           EXIT.

       VAL-FRM-SGV-MNTO SECTION.
       INI-VAL-FRM-SGV-MNTO.
       FIN-VAL-FRM-SGV-MNTO.
           EXIT.

       VAL-FRM-FEC-FEC1 SECTION.
       INI-VAL-FRM-FEC-FEC1.
      *VAL-FEC Validar Fecha
           MOVE FRM-FEC-FEC1 IN PXC-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_FRM_FEC_FEC1
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO FRM-FEC-FEC1 IN PXC-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-FRM-FEC-FEC1.
       FIN-VAL-FRM-FEC-FEC1.
           EXIT.

       VAL-FRM-FEC-FEC2 SECTION.
       INI-VAL-FRM-FEC-FEC2.
      *VAL-FEC Validar Fecha
           MOVE FRM-FEC-FEC2 IN PXC-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_FRM_FEC_FEC2
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO FRM-FEC-FEC2 IN PXC-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-FRM-FEC-FEC2.
       FIN-VAL-FRM-FEC-FEC2.
           EXIT.

       VAL-FRM-SGV-VTXC SECTION.
       INI-VAL-FRM-SGV-VTXC.
       FIN-VAL-FRM-SGV-VTXC.
           EXIT.

       VAL-FRM-SGV-ATXC SECTION.
       INI-VAL-FRM-SGV-ATXC.
       FIN-VAL-FRM-SGV-ATXC.
           EXIT.

       VAL-CON-KEY-PXC SECTION.
       INI-VAL-CON-KEY-PXC.
           IF     TXC-COD-PLZO IN PXC-FLD NOT > SPACES
              AND TXC-COD-VCOC IN PXC-FLD NOT > SPACES
              AND FRM-SGV-MNTO IN PXC-FLD NOT > ZEROES
              AND FRM-FEC-FEC1 IN PXC-FLD NOT > SPACES
              AND FRM-NUM-DEC1 IN PXC-FLD NOT > SPACES
              AND FRM-NUM-MEC1 IN PXC-FLD NOT > SPACES
              AND FRM-NUM-SEC1 IN PXC-FLD NOT > SPACES
              AND FRM-NUM-AEC1 IN PXC-FLD NOT > SPACES
              AND FRM-FEC-FEC2 IN PXC-FLD NOT > SPACES
              AND FRM-NUM-DEC2 IN PXC-FLD NOT > SPACES
              AND FRM-NUM-MEC2 IN PXC-FLD NOT > SPACES
              AND FRM-NUM-SEC2 IN PXC-FLD NOT > SPACES
              AND FRM-NUM-AEC2 IN PXC-FLD NOT > SPACES
              AND FRM-SGV-VTXC IN PXC-FLD NOT > ZEROES
              AND FRM-SGV-ATXC IN PXC-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-PXC.
      *<<<< FIN_VAL_CON_KEY_PXC
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-CON-KEY-PXC.
           PERFORM LLAMA-RUTINA-TXC.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-KEY-PXC.
           EXIT.

       VAL-CON-IKY-PXC SECTION.
       INI-VAL-CON-IKY-PXC.
           IF     TXC-COD-PLZO IN PXC-FLD NOT > SPACES
              AND TXC-COD-VCOC IN PXC-FLD NOT > SPACES
              AND FRM-SGV-MNTO IN PXC-FLD NOT > ZEROES
              AND FRM-FEC-FEC1 IN PXC-FLD NOT > SPACES
              AND FRM-FEC-FEC2 IN PXC-FLD NOT > SPACES
              AND FRM-SGV-VTXC IN PXC-FLD NOT > ZEROES
              AND FRM-SGV-ATXC IN PXC-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-PXC.
       FIN-VAL-CON-IKY-PXC.
           EXIT.

       VAL-NUM-KEY-PXC SECTION.
       INI-VAL-NUM-KEY-PXC.
           PERFORM VAL-NUM-IKY-PXC.
           PERFORM VAL-NUM-MKY-PXC.
           PERFORM VAL-NUM-AKY-PXC.
       FIN-VAL-NUM-KEY-PXC.
           EXIT.

       VAL-NUM-IKY-PXC SECTION.
       INI-VAL-NUM-IKY-PXC.
       VAL-NUM-FRM-SGV-MNTO.
           MOVE FRM-SGV-MNTO-ALF IN PXC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO FRM-SGV-MNTO IN PXC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-MNTO-LEN IN PXC-FLD
                GO TO FIN-VAL-NUM-IKY-PXC.
       VAL-NUM-FRM-SGV-VTXC.
           MOVE FRM-SGV-VTXC-ALF IN PXC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO FRM-SGV-VTXC IN PXC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-VTXC-LEN IN PXC-FLD
                GO TO FIN-VAL-NUM-IKY-PXC.
       VAL-NUM-FRM-SGV-ATXC.
           MOVE FRM-SGV-ATXC-ALF IN PXC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO FRM-SGV-ATXC IN PXC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-ATXC-LEN IN PXC-FLD
                GO TO FIN-VAL-NUM-IKY-PXC.
       FIN-VAL-NUM-IKY-PXC.
           EXIT.

       VAL-NUM-MKY-PXC SECTION.
       INI-VAL-NUM-MKY-PXC.
       FIN-VAL-NUM-MKY-PXC.
           EXIT.

       VAL-NUM-AKY-PXC SECTION.
       INI-VAL-NUM-AKY-PXC.
       FIN-VAL-NUM-AKY-PXC.
           EXIT.

       VAL-NUM-FLD-PXC SECTION.
       INI-VAL-NUM-FLD-PXC.
       FIN-VAL-NUM-FLD-PXC.
           EXIT.

       EDT-KEY-PXC SECTION.
       INI-EDT-KEY-PXC.
           PERFORM EDT-IKY-PXC.
           PERFORM EDT-MKY-PXC.
           PERFORM EDT-AKY-PXC.
       FIN-EDT-KEY-PXC.
           EXIT.

       EDT-IKY-PXC SECTION.
       INI-EDT-IKY-PXC.
           IF FRM-SGV-MNTO-LEN IN PXC-FLD = -9
                MOVE -1 TO FRM-SGV-MNTO-LEN IN PXC-FLD
                GO TO FIN-EDT-IKY-PXC.
           MOVE FRM-SGV-MNTO IN PXC-FLD TO FRM-SGV-MNTO-EDT IN PXC-EDT.
           MOVE FRM-SGV-MNTO-EDT IN PXC-EDT TO
                FRM-SGV-MNTO-ALF IN PXC-FLD.
           IF FRM-SGV-VTXC-LEN IN PXC-FLD = -9
                MOVE -1 TO FRM-SGV-VTXC-LEN IN PXC-FLD
                GO TO FIN-EDT-IKY-PXC.
           MOVE FRM-SGV-VTXC IN PXC-FLD TO FRM-SGV-VTXC-EDT IN PXC-EDT.
           MOVE FRM-SGV-VTXC-EDT IN PXC-EDT TO
                FRM-SGV-VTXC-ALF IN PXC-FLD.
           IF FRM-SGV-ATXC-LEN IN PXC-FLD = -9
                MOVE -1 TO FRM-SGV-ATXC-LEN IN PXC-FLD
                GO TO FIN-EDT-IKY-PXC.
           MOVE FRM-SGV-ATXC IN PXC-FLD TO FRM-SGV-ATXC-EDT IN PXC-EDT.
           MOVE FRM-SGV-ATXC-EDT IN PXC-EDT TO
                FRM-SGV-ATXC-ALF IN PXC-FLD.
       FIN-EDT-IKY-PXC.
           EXIT.

       EDT-MKY-PXC SECTION.
       INI-EDT-MKY-PXC.
       FIN-EDT-MKY-PXC.
           EXIT.

       EDT-AKY-PXC SECTION.
       INI-EDT-AKY-PXC.
       FIN-EDT-AKY-PXC.
           EXIT.

       EDT-FLD-PXC SECTION.
       INI-EDT-FLD-PXC.
       FIN-EDT-FLD-PXC.
           EXIT.
      *<<<< IF EOF
       LLAMA-RUTINA-TXC SECTION.
       INI-LLAMA-RUTINA-TXC.
           MOVE TXC-COD-PLZO IN PXC-FLD TO TXC-PLZO.
           MOVE TXC-COD-VCOC IN PXC-FLD TO TXC-VCOC.
           MOVE FRM-SGV-MNTO IN PXC-FLD TO TXC-MNTO.
           MOVE FRM-FEC-FEC1 IN PXC-FLD TO TXC-FEC1.
           MOVE FRM-FEC-FEC2 IN PXC-FLD TO TXC-FEC2.
           PERFORM TAB-BUS-TXC.
           IF TXC-CMSG > SPACES
               MOVE 'TAB'    TO MSG-COD-SIST
               MOVE TXC-CMSG TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE TXC-MEN2     TO FRM-MEN2
               MOVE 0 TO FRM-SGV-VTXC IN PXC-FLD
               MOVE 0 TO FRM-SGV-ATXC IN PXC-FLD
           ELSE
               MOVE SPACES TO FRM-MENS
               MOVE TXC-VTXC TO FRM-SGV-VTXC IN PXC-FLD
               MOVE TXC-ATXC TO FRM-SGV-ATXC IN PXC-FLD.
       FIN-LLAMA-RUTINA-TXC.
           EXIT.
      *>>>>
