       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   TABPRTMC.
       AUTHOR.       BEE TEAM.
       DATE-WRITTEN. 19-APR-1999 12:22:15.

      * Prueba Programa procesa Tasas Maximas Convencionales

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       COPY TABWGTMC.
       COPY TABBRTXC.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       01  PGM-VARI.
           03 PGM-PLZO                   PIC X(04).
           03 PGM-VCOC                   PIC X(06).
           03 PGM-FECH.
              05 PGM-DECH                PIC 9(02).
              05 PGM-MECH                PIC 9(02).
              05 PGM-SECH                PIC 9(02).
              05 PGM-AECH                PIC 9(02).
           03 PGM-I                      PIC 9(02).
           03 PGM-NUM-MSTR-EDT-IDX  OCCURS 12 TIMES.
              05 PGM-NUM-MSTR-EDT        PIC  ZZZ.ZZZ.ZZZ.
              05 FILLER VALUE ' - '      PIC X(03).
              05 PGM-SGV-VTXC-EDT        PIC  ---.---.---,----.
              05 FILLER VALUE ' - '      PIC X(03).
              05 PGM-SGV-ATXC-EDT        PIC  ---.---.---.--9,9999.
              05 FILLER VALUE ' - '      PIC X(03).
              05 PGM-COD-BASE-EDT        PIC X(01).
       01  TXC-KFIN                      PIC X(27).
       01  TXC-KORI                      PIC X(27).

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.
       LUP-MAIN.
           DISPLAY 'INGRESE PLAZO (' TMC-PLZO '): '.
           ACCEPT PGM-PLZO.
           IF PGM-PLZO = 'F' OR 'f'
               GO TO FIN-MAIN.
           IF PGM-PLZO > SPACES
               MOVE PGM-PLZO TO TMC-PLZO.
           DISPLAY 'PLAZO INGRESADO (' TMC-PLZO '): '.

           DISPLAY 'INGRESE MONEDA (' TMC-VCOC '): '.
           ACCEPT PGM-VCOC.
           IF PGM-VCOC > SPACES
               MOVE PGM-VCOC TO TMC-VCOC.
           DISPLAY 'MONEDA INGRESADA (' TMC-VCOC '): '.

           DISPLAY 'INGRESE FECHA (DDMMSSAA) (' TMC-FECH '): '.
           ACCEPT PGM-FECH.
           IF PGM-FECH > SPACES
               MOVE PGM-FECH TO TMC-FECH.
           DISPLAY 'FECHA INGRESADA (' TMC-FECH '): '.

           PERFORM TAB-BUS-TMC.

           IF TMC-CMSG > SPACES
               DISPLAY TMC-CMSG ' - ' TMC-MENS
               DISPLAY '==============================================='
                       '============='
           ELSE
               PERFORM DISPLAY-TABLA.
           GO TO LUP-MAIN.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

       DISPLAY-TABLA SECTION.
       INI-DISPLAY-TABLA.
           MOVE 0 TO PGM-I.
           DISPLAY '   TRAMO                  TASA              ACUMULA'
                   'DO   BASE'.
           DISPLAY '---------------------------------------------------'
                   '---------'.
       LUP-DISPLAY-TABLA.
           ADD 1 TO PGM-I.
           IF PGM-I > 12
               GO TO FIN-DISPLAY-TABLA.
           IF TMC-MSTR(PGM-I) NOT > 0
               GO TO FIN-DISPLAY-TABLA.
           MOVE TMC-MSTR(PGM-I) TO PGM-NUM-MSTR-EDT(PGM-I).
           MOVE TMC-VTMC(PGM-I) TO PGM-SGV-VTXC-EDT(PGM-I).
           MOVE TMC-ATMC(PGM-I) TO PGM-SGV-ATXC-EDT(PGM-I).
           MOVE TMC-BASE(PGM-I) TO PGM-COD-BASE-EDT(PGM-I).
           DISPLAY PGM-NUM-MSTR-EDT-IDX(PGM-I).
           GO TO LUP-DISPLAY-TABLA.
       FIN-DISPLAY-TABLA.
           DISPLAY '==================================================='
                   '========='.
       EXT-DISPLAY-TABLA.
           EXIT.

       COPY TABBBTMC.
       COPY GNSBGEND.
