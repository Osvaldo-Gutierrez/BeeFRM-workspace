      *
      * TABBUWFC
      * Version 3.0.1 Nov-2005
      * 23-Apr-10 05:39 PM
      *
       SET-TAG-TABBUWFC SECTION.
       INI-SET-TAG-TABBUWFC.
           MOVE
           '<IDNMOD NOM=$TABBUWFC$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$23-Apr-10 05:39 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-TABBUWFC.
           EXIT.
           
       RET-ALL-WFC SECTION.
       INI-RET-ALL-WFC.
           PERFORM KEY-ALL-WFC.
           PERFORM RET-WFC-WFC.
           PERFORM RET-DBC-WFC.
           PERFORM RET-DCE-WFC.
       FIN-RET-ALL-WFC.
           EXIT.
       
       RET-WFC-WFC SECTION.
       INI-RET-WFC-WFC.
           MOVE WFC-MSC-STAT IN WFC-FLD TO WFC-MSC-STAT IN WFC.
           MOVE WFC-COD-ATRN IN WFC-FLD TO WFC-COD-ATRN IN WFC.
           MOVE WFC-IND-SMWI IN WFC-FLD TO WFC-IND-SMWI IN WFC.
           MOVE WFC-NUM-PAGR IN WFC-FLD TO WFC-NUM-PAGR IN WFC.
           MOVE WFC-COD-OFCV IN WFC-FLD TO WFC-COD-OFCV IN WFC.
           MOVE WFC-COD-RAPR IN WFC-FLD TO WFC-COD-RAPR IN WFC.
           MOVE WFC-COD-CAPR IN WFC-FLD TO WFC-COD-CAPR IN WFC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE WFC-NUM-DAPR IN WFC-FLD TO WFC-NUM-DAPR IN WFC.
           MOVE WFC-NUM-MAPR IN WFC-FLD TO WFC-NUM-MAPR IN WFC.
           MOVE WFC-NUM-SAPR IN WFC-FLD TO WFC-NUM-SAPR IN WFC.
           MOVE WFC-NUM-AAPR IN WFC-FLD TO WFC-NUM-AAPR IN WFC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE WFC-GLS-NCEP IN WFC-FLD TO WFC-GLS-NCEP IN WFC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE WFC-NUM-DPRC IN WFC-FLD TO WFC-NUM-DPRC IN WFC.
           MOVE WFC-NUM-MPRC IN WFC-FLD TO WFC-NUM-MPRC IN WFC.
           MOVE WFC-NUM-SPRC IN WFC-FLD TO WFC-NUM-SPRC IN WFC.
           MOVE WFC-NUM-APRC IN WFC-FLD TO WFC-NUM-APRC IN WFC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE WFC-COD-CCEP IN WFC-FLD TO WFC-COD-CCEP IN WFC.
           MOVE WFC-GLS-FCEP IN WFC-FLD TO WFC-GLS-FCEP IN WFC.
           MOVE WFC-COD-EBCS IN WFC-FLD TO WFC-COD-EBCS IN WFC.
           MOVE WFC-COD-SBCS IN WFC-FLD TO WFC-COD-SBCS IN WFC.
           MOVE WFC-COD-EBCI IN WFC-FLD TO WFC-COD-EBCI IN WFC.
           MOVE WFC-COD-SBCI IN WFC-FLD TO WFC-COD-SBCI IN WFC.
           MOVE WFC-VAL-CFMN IN WFC-FLD TO WFC-VAL-CFMN IN WFC.
           MOVE WFC-COD-CFMN IN WFC-FLD TO WFC-COD-CFMN IN WFC.
           MOVE WFC-VAL-CVTE IN WFC-FLD TO WFC-VAL-CVTE IN WFC.
           MOVE WFC-COD-CVTE IN WFC-FLD TO WFC-COD-CVTE IN WFC.
           MOVE WFC-NUM-NTSM IN WFC-FLD TO WFC-NUM-NTSM IN WFC.
           MOVE WFC-CAI-CCCF IN WFC-FLD TO WFC-CAI-CCCF IN WFC.
           MOVE WFC-IIC-CCCF IN WFC-FLD TO WFC-IIC-CCCF IN WFC.
           MOVE WFC-EXT-CCCF IN WFC-FLD TO WFC-EXT-CCCF IN WFC.
           MOVE WFC-COD-ACTC IN WFC-FLD TO WFC-COD-ACTC IN WFC.
           MOVE WFC-COD-PTRF IN WFC-FLD TO WFC-COD-PTRF IN WFC.
           MOVE WFC-IND-IWFL IN WFC-FLD TO WFC-IND-IWFL IN WFC.
           MOVE WFC-COD-CNDP IN WFC-FLD TO WFC-COD-CNDP IN WFC.
           MOVE WFC-IND-RBPR IN WFC-FLD TO WFC-IND-RBPR IN WFC.
           MOVE WFC-COD-RAUT IN WFC-FLD TO WFC-COD-RAUT IN WFC.
           MOVE WFC-COD-TCTA IN WFC-FLD TO WFC-COD-TCTA IN WFC.
           MOVE WFC-CAI-ICON IN WFC-FLD TO WFC-CAI-ICON IN WFC.
           MOVE WFC-IIC-ICON IN WFC-FLD TO WFC-IIC-ICON IN WFC.
       FIN-RET-WFC-WFC.
           EXIT.
       
       RET-DBC-WFC SECTION.
       INI-RET-DBC-WFC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN WFC-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN WFC-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN WFC-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN WFC-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-CAI-ICLI IN WFC-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN WFC-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE DBC-GLS-NOMC IN WFC-FLD TO DBC-GLS-NOMC IN DBC.
           MOVE DBC-COD-EJEC IN WFC-FLD TO DBC-COD-EJEC IN DBC.
      *<<<< FIN_RET_DBC_WFC                                             
            MOVE DBC-CAI-ICLI IN DBC TO WFC-CAI-EMPR IN WFC.            
            MOVE DBC-IIC-ICLI IN DBC TO WFC-IIC-EMPR IN WFC.            
      *>>>>                                                             
       FIN-RET-DBC-WFC.
           EXIT.
       
       RET-DCE-WFC SECTION.
       INI-RET-DCE-WFC.
           MOVE DCE-COD-TBAN IN WFC-FLD TO DCE-COD-TBAN IN DCE.
       FIN-RET-DCE-WFC.
           EXIT.
       
       KEY-ALL-WFC SECTION.
       INI-KEY-ALL-WFC.
           PERFORM KEY-WFC-WFC.
           PERFORM KEY-DBC-WFC.
           PERFORM KEY-DCE-WFC.
       FIN-KEY-ALL-WFC.
           EXIT.
       
       KEY-WFC-WFC SECTION.
       INI-KEY-WFC-WFC.
           MOVE WFC-CAI-CONV IN WFC-FLD TO WFC-CAI-CONV IN WFC.
           MOVE WFC-IIC-CONV IN WFC-FLD TO WFC-IIC-CONV IN WFC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE WFC-NUM-DCNV IN WFC-FLD TO WFC-NUM-DCNV IN WFC.
           MOVE WFC-NUM-MCNV IN WFC-FLD TO WFC-NUM-MCNV IN WFC.
           MOVE WFC-NUM-SCNV IN WFC-FLD TO WFC-NUM-SCNV IN WFC.
           MOVE WFC-NUM-ACNV IN WFC-FLD TO WFC-NUM-ACNV IN WFC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE WFC-HRA-CONV IN WFC-FLD TO WFC-HRA-CONV IN WFC.
       FIN-KEY-WFC-WFC.
           EXIT.
       
       KEY-DBC-WFC SECTION.
       INI-KEY-DBC-WFC.
       FIN-KEY-DBC-WFC.
           EXIT.
       
       KEY-DCE-WFC SECTION.
       INI-KEY-DCE-WFC.
       FIN-KEY-DCE-WFC.
           EXIT.
       
       SCR-CLRA-WFC SECTION.
       INI-SCR-CLRA-WFC.
           PERFORM CLR-KEY-WFC.
           PERFORM CLR-FLD-WFC.
       FIN-SCR-CLRA-WFC.
           EXIT.
       
       CLR-KEY-WFC SECTION.
       INI-CLR-KEY-WFC.
           MOVE SPACES TO WFC-CAI-CONV IN WFC-FLD.
           MOVE SPACES TO WFC-IIC-CONV IN WFC-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO WFC-FEC-FCNV IN WFC-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO WFC-HRA-CONV IN WFC-FLD.
       FIN-CLR-KEY-WFC.
           EXIT.
       
       CLR-FLD-WFC SECTION.
       INI-CLR-FLD-WFC.
           MOVE SPACES TO FRM-GLS-STAT IN WFC-FLD.
           MOVE SPACES TO FRM-GLS-SMWI IN WFC-FLD.
           MOVE SPACES TO FRM-GLS-EJEC IN WFC-FLD.
           MOVE SPACES TO FRM-GLS-TBAN IN WFC-FLD.
           MOVE SPACES TO FRM-GLS-RAPR IN WFC-FLD.
           MOVE SPACES TO FRM-GLS-CFMN IN WFC-FLD.
           MOVE SPACES TO FRM-GLS-CVTE IN WFC-FLD.
           MOVE SPACES TO FRM-GLS-PTR1 IN WFC-FLD.
           MOVE SPACES TO FRM-COD-TMET IN WFC-FLD.
           MOVE ZEROES TO FRM-NUM-METR IN WFC-FLD.
           MOVE SPACES TO FRM-IND-LOGA IN WFC-FLD.
           MOVE SPACES TO FRM-IND-ALGA IN WFC-FLD.
           PERFORM CLR-WFC-WFC.
           PERFORM CLR-DBC-WFC.
           PERFORM CLR-DCE-WFC.
       FIN-CLR-FLD-WFC.
           EXIT.
       
       CLR-WFC-WFC SECTION.
       INI-CLR-WFC-WFC.
           MOVE SPACES TO WFC-MSC-STAT IN WFC-FLD.
           MOVE SPACES TO WFC-COD-ATRN IN WFC-FLD.
           MOVE SPACES TO WFC-IND-SMWI IN WFC-FLD.
           MOVE ZEROES TO WFC-NUM-PAGR IN WFC-FLD.
           MOVE SPACES TO WFC-COD-OFCV IN WFC-FLD.
           MOVE SPACES TO WFC-COD-RAPR IN WFC-FLD.
           MOVE SPACES TO WFC-COD-CAPR IN WFC-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO WFC-FEC-FAPR IN WFC-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO WFC-GLS-NCEP IN WFC-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO WFC-FEC-APRC IN WFC-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO WFC-COD-CCEP IN WFC-FLD.
           MOVE SPACES TO WFC-GLS-FCEP IN WFC-FLD.
           MOVE SPACES TO WFC-COD-EBCS IN WFC-FLD.
           MOVE SPACES TO WFC-COD-SBCS IN WFC-FLD.
           MOVE SPACES TO WFC-COD-EBCI IN WFC-FLD.
           MOVE SPACES TO WFC-COD-SBCI IN WFC-FLD.
           MOVE ZEROES TO WFC-VAL-CFMN IN WFC-FLD.
           MOVE SPACES TO WFC-COD-CFMN IN WFC-FLD.
           MOVE ZEROES TO WFC-VAL-CVTE IN WFC-FLD.
           MOVE SPACES TO WFC-COD-CVTE IN WFC-FLD.
           MOVE ZEROES TO WFC-NUM-NTSM IN WFC-FLD.
           MOVE SPACES TO WFC-CAI-CCCF IN WFC-FLD.
           MOVE SPACES TO WFC-IIC-CCCF IN WFC-FLD.
           MOVE SPACES TO WFC-EXT-CCCF IN WFC-FLD.
           MOVE SPACES TO WFC-COD-ACTC IN WFC-FLD.
           MOVE SPACES TO WFC-COD-PTRF IN WFC-FLD.
           MOVE SPACES TO WFC-IND-IWFL IN WFC-FLD.
           MOVE SPACES TO WFC-COD-CNDP IN WFC-FLD.
           MOVE SPACES TO WFC-IND-RBPR IN WFC-FLD.
           MOVE SPACES TO WFC-COD-RAUT IN WFC-FLD.
           MOVE SPACES TO WFC-COD-TCTA IN WFC-FLD.
           MOVE SPACES TO WFC-CAI-ICON IN WFC-FLD.
           MOVE SPACES TO WFC-IIC-ICON IN WFC-FLD.
       FIN-CLR-WFC-WFC.
           EXIT.
       
       CLR-DBC-WFC SECTION.
       INI-CLR-DBC-WFC.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN WFC-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN WFC-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN WFC-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN WFC-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO DBC-CAI-ICLI IN WFC-FLD.
           MOVE SPACES TO DBC-IIC-ICLI IN WFC-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN WFC-FLD.
           MOVE SPACES TO DBC-COD-EJEC IN WFC-FLD.
       FIN-CLR-DBC-WFC.
           EXIT.
       
       CLR-DCE-WFC SECTION.
       INI-CLR-DCE-WFC.
           MOVE SPACES TO DCE-COD-TBAN IN WFC-FLD.
       FIN-CLR-DCE-WFC.
           EXIT.
       
       FST-KEY-WFC SECTION.
       INI-FST-KEY-WFC.
           MOVE -1 TO WFC-CAI-CONV-LEN IN WFC-FLD.
       FIN-FST-KEY-WFC.
           EXIT.
       
       FST-FLD-WFC SECTION.
       INI-FST-FLD-WFC.
      *<<<<                                                             
            IF SCR-CMND = 'APR'                                         
               MOVE FRM-POS-CURS TO WFC-FEC-FAPR-LEN IN WFC-FLD.        
            IF SCR-CMND = 'IMT'                                         
               MOVE FRM-POS-CURS TO FRM-COD-TMET-LEN IN WFC-FLD.        
            IF SCR-CMND = 'AEW'                                         
               MOVE FRM-POS-CURS TO WFC-IND-SMWI-LEN IN WFC-FLD.        
            IF SCR-CMND = 'IAB'                                         
               MOVE FRM-POS-CURS TO FRM-IND-LOGA-LEN IN WFC-FLD.        
            IF SCR-CMND = 'APR' OR 'IMT' OR 'AEW' OR 'IAB'              
               GO TO FIN-FST-FLD-WFC.                                   
      *>>>>                                                             
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN WFC-FLD.            
           GO TO FIN-FST-FLD-WFC. 
      *>>>>
           MOVE -1 TO WFC-IND-SMWI-LEN IN WFC-FLD.
       FIN-FST-FLD-WFC.
           EXIT.
       
       PRO-KEY-WFC SECTION.
       INI-PRO-KEY-WFC.
           PERFORM PRO-MKY-WFC.
       FIN-PRO-KEY-WFC.
           EXIT.
       
       PRO-MKY-WFC SECTION.
       INI-PRO-MKY-WFC.
       FIN-PRO-MKY-WFC.
           EXIT.
       
       PRO-FLD-WFC SECTION.
       INI-PRO-FLD-WFC.
           MOVE FRM-CPIM-AEY TO FRM-COD-TMET-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-NUM-METR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-LOGA-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ALGA-ATR IN WFC-FLD.
           PERFORM PRO-WFC-WFC.
           PERFORM PRO-DBC-WFC.
           PERFORM PRO-DCE-WFC.
       FIN-PRO-FLD-WFC.
           EXIT.
       
       PRO-WFC-WFC SECTION.
       INI-PRO-WFC-WFC.
           MOVE FRM-CPIM-AEY TO WFC-IND-SMWI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-NUM-PAGR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-OFCV-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-RAPR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-CAPR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-FEC-FAPR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-GLS-NCEP-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-FEC-APRC-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-CCEP-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-GLS-FCEP-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-EBCS-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-SBCS-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-EBCI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-SBCI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-VAL-CFMN-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-CFMN-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-VAL-CVTE-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-CVTE-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-NUM-NTSM-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-CAI-CCCF-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-IIC-CCCF-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-EXT-CCCF-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-ACTC-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-PTRF-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-IND-IWFL-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-CNDP-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-IND-RBPR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-RAUT-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO WFC-COD-TCTA-ATR IN WFC-FLD.
       FIN-PRO-WFC-WFC.
           EXIT.
       
       PRO-DBC-WFC SECTION.
       INI-PRO-DBC-WFC.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN WFC-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-DBC-WFC.
           EXIT.
       
       PRO-DCE-WFC SECTION.
       INI-PRO-DCE-WFC.
       FIN-PRO-DCE-WFC.
           EXIT.
       
       UNP-KEY-WFC SECTION.
       INI-UNP-KEY-WFC.
           PERFORM UNP-IKY-WFC.
           PERFORM UNP-AKY-WFC.
           PERFORM UNP-MKY-WFC.
       FIN-UNP-KEY-WFC.
           EXIT.
       
       UNP-IKY-WFC SECTION.
       INI-UNP-IKY-WFC.
           MOVE FRM-CPIM-UBY TO WFC-CAI-CONV-ATR.
           MOVE FRM-CPIM-UBY TO WFC-IIC-CONV-ATR.
           MOVE FRM-CPIM-UBY TO WFC-FEC-FCNV-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-HRA-CONV-ATR.
       FIN-UNP-IKY-WFC.
           EXIT.
       
       UNP-MKY-WFC SECTION.
       INI-UNP-MKY-WFC.
       FIN-UNP-MKY-WFC.
           EXIT.
       
       UNP-AKY-WFC SECTION.
       INI-UNP-AKY-WFC.
       FIN-UNP-AKY-WFC.
           EXIT.
       
       UNP-FLD-WFC SECTION.
       INI-UNP-FLD-WFC.
           MOVE FRM-CPIM-UBY TO FRM-COD-TMET-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO FRM-NUM-METR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-LOGA-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ALGA-ATR IN WFC-FLD.
           PERFORM UNP-WFC-WFC.
           PERFORM UNP-DBC-WFC.
           PERFORM UNP-DCE-WFC.
       FIN-UNP-FLD-WFC.
           EXIT.
       
       UNP-WFC-WFC SECTION.
       INI-UNP-WFC-WFC.
           MOVE FRM-CPIM-UBY TO WFC-IND-SMWI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-NUM-PAGR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-OFCV-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-RAPR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-CAPR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-FEC-FAPR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-GLS-NCEP-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-FEC-APRC-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-CCEP-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-GLS-FCEP-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-EBCS-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-SBCS-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-EBCI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-SBCI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-VAL-CFMN-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-CFMN-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-VAL-CVTE-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-CVTE-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-NUM-NTSM-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-CAI-CCCF-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-IIC-CCCF-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-EXT-CCCF-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-ACTC-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-PTRF-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-IND-IWFL-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-CNDP-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-IND-RBPR-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-RAUT-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO WFC-COD-TCTA-ATR IN WFC-FLD.
       FIN-UNP-WFC-WFC.
           EXIT.
       
       UNP-DBC-WFC SECTION.
       INI-UNP-DBC-WFC.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN WFC-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN WFC-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-DBC-WFC.
           EXIT.
       
       UNP-DCE-WFC SECTION.
       INI-UNP-DCE-WFC.
       FIN-UNP-DCE-WFC.
           EXIT.
       
       VAL-MKY-WFC SECTION.
       INI-VAL-MKY-WFC.
       FIN-VAL-MKY-WFC.
           EXIT.
       
       VAL-FLD-WFC SECTION.
       INI-VAL-FLD-WFC.
           PERFORM VAL-WFC-MSC-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-MSC-STAT-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-GLS-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-STAT-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-ATRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-ATRN-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-IND-SMWI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-IND-SMWI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-CAI-ICLI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-DBC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-IIC-ICLI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-GLS-SMWI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SMWI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-DCE-COD-TBAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCE-COD-TBAN-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-DBC-COD-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-COD-EJEC-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-GLS-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EJEC-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-GLS-TBAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TBAN-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-NUM-PAGR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-NUM-PAGR-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-OFCV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-OFCV-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-RAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-RAPR-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-GLS-RAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RAPR-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-CAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-CAPR-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-WFC-FEC-FAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                WFC-FEC-FAPR-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-WFC-GLS-NCEP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-GLS-NCEP-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-WFC-FEC-APRC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                WFC-FEC-APRC-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-WFC-COD-CCEP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-CCEP-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-GLS-FCEP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-GLS-FCEP-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-EBCS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-EBCS-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-SBCS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-SBCS-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-EBCI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-EBCI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-SBCI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-SBCI-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-VAL-CFMN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-VAL-CFMN-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-CFMN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-CFMN-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-GLS-CFMN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CFMN-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-VAL-CVTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-VAL-CVTE-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-CVTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-CVTE-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-GLS-CVTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CVTE-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-NUM-NTSM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-NUM-NTSM-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-CAI-CCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-CAI-CCCF-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-IIC-CCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-IIC-CCCF-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-EXT-CCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-EXT-CCCF-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-ACTC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-ACTC-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-PTRF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-PTRF-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-IND-IWFL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-IND-IWFL-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-GLS-PTR1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PTR1-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-CNDP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-CNDP-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-IND-RBPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-IND-RBPR-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-RAUT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-RAUT-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-COD-TCTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-COD-TCTA-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-CAI-ICON.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-CAI-ICON-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-WFC-IIC-ICON.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO WFC-IIC-ICON-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-COD-TMET.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-TMET-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-NUM-METR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-NUM-METR-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-IND-LOGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-LOGA-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
           PERFORM VAL-FRM-IND-ALGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-ALGA-LEN IN WFC-FLD
                GO TO FIN-VAL-FLD-WFC.
       FIN-VAL-FLD-WFC.
           EXIT.
       
       VAL-WFC-MSC-STAT SECTION.
       INI-VAL-WFC-MSC-STAT.
       FIN-VAL-WFC-MSC-STAT.
           EXIT.
       
       VAL-FRM-GLS-STAT SECTION.
       INI-VAL-FRM-GLS-STAT.
       FIN-VAL-FRM-GLS-STAT.
           EXIT.
       
       VAL-WFC-COD-ATRN SECTION.
       INI-VAL-WFC-COD-ATRN.
       FIN-VAL-WFC-COD-ATRN.
           EXIT.
       
       VAL-WFC-IND-SMWI SECTION.
       INI-VAL-WFC-IND-SMWI.
           IF WFC-IND-SMWI IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-IND-SMWI IN WFC-FLD.
      *<<<<
           IF SCR-CMND = 'ING' AND                                      
              WFC-IND-SMWI IN WFC-FLD NOT > SPACES                      
              MOVE 'P' TO WFC-IND-SMWI IN WFC-FLD.                      
                                                                        
           IF WFC-IND-SMWI IN WFC-FLD > SPACES                          
               MOVE 'TAB'  TO TAB-COD-SIST                              
               MOVE 'SWI'  TO TAB-COD-TTAB IN TAB                       
               MOVE WFC-IND-SMWI IN WFC-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM VAL-COD                                          
               IF MSG-COD-MENS NOT > SPACES                             
                  MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SMWI IN WFC-FLD   
               ELSE                                                     
                  MOVE SPACES              TO FRM-GLS-SMWI IN WFC-FLD.  
      *>>>>
       FIN-VAL-WFC-IND-SMWI.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
      *<<<< INI_DBC_NUM_ICLI                                            
            MOVE DBC-NUM-ICLI IN WFC-FLD TO DBC-NUM-ICLI IN DBC.        
            MOVE DBC-IND-ICLI IN WFC-FLD TO DBC-IND-ICLI IN DBC.        
            MOVE DBC-GLS-ICLI IN WFC-FLD TO DBC-GLS-ICLI IN DBC.        
            MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY.                   
            MOVE FIO-GET-KEY             TO FIO-CMND.                   
            PERFORM SGC-FIO-DBC.                                        
            IF NOT FIO-STAT-OKS                                         
                MOVE 'TAB'          TO MSG-COD-SIST                     
                MOVE 'CLIINEX    '  TO MSG-COD-MENS                     
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
            ELSE                                                        
                IF DBC-IND-TICL IN DBC = 'P'                            
                   MOVE 'TAB'          TO MSG-COD-SIST                  
                   MOVE 'CLI ES PER '  TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                ELSE                                                    
                    MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE     
                    MOVE FIO-GET-KEY         TO FIO-CMND                
                    PERFORM SGC-FIO-DCE                                 
                    IF NOT FIO-STAT-OKS                                 
                        MOVE 'TAB'          TO MSG-COD-SIST             
                        MOVE 'CICNOEXIS  '  TO MSG-COD-MENS             
                        PERFORM GET-MSG                                 
                        MOVE MSG-GLS-DESC TO FRM-MENS                   
                        MOVE FRM-SUAR-MAL TO FRM-SUAR                   
                    ELSE                                                
                        MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN            
                        PERFORM CPT-BLKS                                
                        MOVE CPT-STRN            TO DBC-GLS-NOMC        
                                                    IN WFC-FLD          
                        MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI        
                                                    IN WFC-FLD          
                        MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI        
                                                    IN WFC-FLD          
                        MOVE DCE-COD-TBAN IN DCE TO DCE-COD-TBAN        
                                                       IN WFC-FLD       
                        MOVE DBC-COD-EJEC IN DBC TO DBC-COD-EJEC        
                                                       IN WFC-FLD       
      *PVG INI 26-JUL-2005                                              
                        MOVE DBC-COD-OFIC IN DBC TO WSS-COD-OEMP        
                                                       IN WSS-VARI      
      *PVG FIN 26-JUL-2005                                              
      *VAL-COD Valida codigo de tabla                                   
                        MOVE 'SGC'               TO TAB-COD-SIST        
                        MOVE 'BAN '              TO TAB-COD-TTAB IN TAB 
                        MOVE DCE-COD-TBAN IN DCE TO TAB-COD-CTAB IN TAB 
                        PERFORM VAL-COD                                 
                        IF MSG-COD-MENS = 'COD    NEX' OR               
                           DCE-COD-TBAN IN DCE NOT > SPACES             
                           MOVE SPACES TO FRM-GLS-TBAN IN WFC-FLD       
                        ELSE                                            
                           MOVE TAB-GLS-DESC IN TAB TO                  
                                FRM-GLS-TBAN IN WFC-FLD                 
      *VAL-TDU Valida Tipo de Usuario                                   
                           MOVE 'EJC '    TO USR-COD-TTAB IN USR        
                           MOVE DBC-COD-EJEC IN WFC-FLD TO USR-COD-USER 
                                                           IN USR       
                           PERFORM VAL-TDU                              
                           IF MSG-COD-MENS NOT = 'COD    NEX' AND       
                               DBC-COD-EJEC IN WFC-FLD > SPACES         
                               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC 
                                                           IN WFC-FLD   
                           ELSE                                         
                               MOVE SPACES TO FRM-GLS-EJEC IN WFC-FLD.  
      *>>>>                                                             
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN WFC-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN WFC-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN WFC-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN WFC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN WFC-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN WFC-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN WFC-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN WFC-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN WFC-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN WFC-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN WFC-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN WFC-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-DBC-CAI-ICLI SECTION.
       INI-VAL-DBC-CAI-ICLI.
       FIN-VAL-DBC-CAI-ICLI.
           EXIT.
       
       VAL-DBC-IIC-ICLI SECTION.
       INI-VAL-DBC-IIC-ICLI.
       FIN-VAL-DBC-IIC-ICLI.
           EXIT.
       
       VAL-FRM-GLS-SMWI SECTION.
       INI-VAL-FRM-GLS-SMWI.
       FIN-VAL-FRM-GLS-SMWI.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-DCE-COD-TBAN SECTION.
       INI-VAL-DCE-COD-TBAN.
       FIN-VAL-DCE-COD-TBAN.
           EXIT.
       
       VAL-DBC-COD-EJEC SECTION.
       INI-VAL-DBC-COD-EJEC.
       FIN-VAL-DBC-COD-EJEC.
           EXIT.
       
       VAL-FRM-GLS-EJEC SECTION.
       INI-VAL-FRM-GLS-EJEC.
       FIN-VAL-FRM-GLS-EJEC.
           EXIT.
       
       VAL-FRM-GLS-TBAN SECTION.
       INI-VAL-FRM-GLS-TBAN.
       FIN-VAL-FRM-GLS-TBAN.
           EXIT.
       
       VAL-WFC-NUM-PAGR SECTION.
       INI-VAL-WFC-NUM-PAGR.
           IF WFC-NUM-PAGR IN WFC-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-WFC-NUM-PAGR.
      *<<<< WFC_NUM_PAGR                                                
            IF WFC-NUM-PAGR IN WFC-FLD > ZEROES                         
               IF WFC-NUM-PAGR IN WFC-FLD NOT > ZEROES OR               
                  WFC-NUM-PAGR IN WFC-FLD NOT < 32                      
                   MOVE 'TAB'          TO MSG-COD-SIST                  
                   MOVE 'FEC INVALIDA' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
      *>>>>                                                             
       FIN-VAL-WFC-NUM-PAGR.
           EXIT.
       
       VAL-WFC-COD-OFCV SECTION.
       INI-VAL-WFC-COD-OFCV.
      *<<<<
      *PVG INI 26-JUL-2005                                              
           IF WFC-COD-OFCV IN WFC-FLD NOT > SPACES                      
              MOVE WSS-COD-OEMP IN WSS-VARI TO                          
                   WFC-COD-OFCV IN WFC-FLD.                             
      *PVG FIN 26-JUL-2005                                              
      *>>>>
           IF WFC-COD-OFCV IN WFC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-WFC-COD-OFCV.
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE WFC-COD-OFCV IN WFC-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-WFC-COD-OFCV.
           EXIT.
       
       VAL-WFC-COD-RAPR SECTION.
       INI-VAL-WFC-COD-RAPR.
           IF WFC-COD-RAPR IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-RAPR IN WFC-FLD.
      *<<<<
           IF WFC-COD-RAPR IN WFC-FLD NOT > SPACES                      
              MOVE SPACES TO FRM-GLS-RAPR IN WFC-FLD                    
              GO TO FIN-VAL-WFC-COD-RAPR.                               
                                                                        
      *PVG INI 15-JUL-2005 (VALIDACION-DEFINICION)                      
           MOVE 'EJC '                  TO USR-COD-TTAB IN USR.         
           MOVE WFC-COD-RAPR IN WFC-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS = 'COD    NVG' OR 'COD    NEX'               
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
              MOVE USR-GLS-DESC IN USR TO FRM-GLS-RAPR IN WFC-FLD.      
                                                                        
            IF FRM-SUAR = FRM-SUAR-MAL                                  
               GO TO FIN-VAL-WFC-COD-RAPR.                              
      *VALIDACION ADICIONAL                                             
           IF USR-EXT-CTAB IN USR = 'APR  '                             
              GO TO FIN-VAL-WFC-COD-RAPR.                               
                                                                        
           IF USR-COD-AGES IN USR NOT > SPACES                          
              GO TO ERR-VAL-WFC-COD-RAPR.                               
                                                                        
           MOVE 'TAB'  TO TAB-COD-SIST.                                 
           MOVE 'ADG'  TO TAB-COD-TTAB IN TAB.                          
           MOVE USR-COD-AGES IN USR TO TAB-COD-CTAB IN TAB.             
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS > SPACES                                     
              GO TO ERR-VAL-WFC-COD-RAPR.                               
           IF (TAB-COD-DAT3 IN TAB(1) = 'CNV' AND                       
               TAB-COD-DAT3 IN TAB(2) = 'CPR')                          
               GO TO FIN-VAL-WFC-COD-RAPR.                              
                                                                        
       ERR-VAL-WFC-COD-RAPR.                                            
           MOVE 'TAB'          TO MSG-COD-SIST.                         
           MOVE 'CODADG   INV' TO MSG-COD-MENS.                         
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC   TO FRM-MENS.                             
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.                             
      *PVG FIN 15-JUL-2005                                              
      *>>>>
       FIN-VAL-WFC-COD-RAPR.
           EXIT.
       
       VAL-FRM-GLS-RAPR SECTION.
       INI-VAL-FRM-GLS-RAPR.
       FIN-VAL-FRM-GLS-RAPR.
           EXIT.
       
       VAL-WFC-COD-CAPR SECTION.
       INI-VAL-WFC-COD-CAPR.
           IF WFC-COD-CAPR IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-CAPR IN WFC-FLD.
       FIN-VAL-WFC-COD-CAPR.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-WFC-FEC-FAPR SECTION.
       INI-VAL-WFC-FEC-FAPR.
           IF WFC-FEC-FAPR IN WFC-FLD  NOT > ZEROES
              MOVE ZEROES TO WFC-FEC-FAPR IN WFC-FLD.
      *VAL-FEC Validar Fecha
           MOVE WFC-FEC-FAPR IN WFC-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_WFC_FEC_FAPR                                            
           MOVE FEC-CHOY-GE TO FEC-CHOY.                                
           IF ((SCR-CMND = 'MOD' OR 'ING') AND                          
                WFC-FEC-FAPR IN WFC-FLD > ZEROES)                       
                MOVE 'TAB'          TO MSG-COD-SIST                     
                MOVE 'NO INGFECAPR' TO MSG-COD-MENS                     
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
                GO TO FIN-VAL-WFC-FEC-FAPR.                             
                                                                        
           IF SCR-CMND = 'APR' AND WFC-FEC-FAPR IN WFC-FLD NOT > ZEROES 
              PERFORM GET-FHOY                                          
              MOVE HOY-DHOY TO WFC-NUM-DAPR IN WFC-FLD                  
              MOVE HOY-MHOY TO WFC-NUM-MAPR IN WFC-FLD                  
              MOVE HOY-SHOY TO WFC-NUM-SAPR IN WFC-FLD                  
              MOVE HOY-AHOY TO WFC-NUM-AAPR IN WFC-FLD                  
              MOVE WFC-FEC-FAPR IN WFC-FLD TO FEC-FECH.                 
                                                                        
           IF SCR-CMND = 'IMT' OR 'IAB' OR 'AEW'                        
              MOVE FEC-CHOY-N  TO FEC-CHOY.                             
      *>>>>                                                             
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO WFC-FEC-FAPR IN WFC-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-WFC-FEC-FAPR.
       FIN-VAL-WFC-FEC-FAPR.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-WFC-GLS-NCEP SECTION.
       INI-VAL-WFC-GLS-NCEP.
           IF WFC-GLS-NCEP IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-GLS-NCEP IN WFC-FLD.
       FIN-VAL-WFC-GLS-NCEP.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-WFC-FEC-APRC SECTION.
       INI-VAL-WFC-FEC-APRC.
           IF WFC-FEC-APRC IN WFC-FLD  NOT > ZEROES
              MOVE ZEROES TO WFC-FEC-APRC IN WFC-FLD.
      *VAL-FEC Validar Fecha
           MOVE WFC-FEC-APRC IN WFC-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<<
           IF SCR-CMND = 'IMT' OR 'IAB' OR 'AEW'                        
              MOVE FEC-CHOY-N  TO FEC-CHOY.                             
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO WFC-FEC-APRC IN WFC-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-WFC-FEC-APRC.
       FIN-VAL-WFC-FEC-APRC.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-WFC-COD-CCEP SECTION.
       INI-VAL-WFC-COD-CCEP.
           IF WFC-COD-CCEP IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-CCEP IN WFC-FLD.
       FIN-VAL-WFC-COD-CCEP.
           EXIT.
       
       VAL-WFC-GLS-FCEP SECTION.
       INI-VAL-WFC-GLS-FCEP.
           IF WFC-GLS-FCEP IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-GLS-FCEP IN WFC-FLD.
       FIN-VAL-WFC-GLS-FCEP.
           EXIT.
       
       VAL-WFC-COD-EBCS SECTION.
       INI-VAL-WFC-COD-EBCS.
           IF WFC-COD-EBCS IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-EBCS IN WFC-FLD.
      *<<<< WFC_COD_EBCS                                                
             IF WFC-COD-EBCS IN WFC-FLD NOT > SPACES                    
                 GO TO FIN-VAL-WFC-COD-EBCS.                            
      *VAL-TDU Valida Tipo de Usuario                                   
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.                   
           MOVE WFC-COD-EBCS IN WFC-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-WFC-COD-EBCS.                              
                                                                        
           MOVE USR-COD-OFUS IN USR TO OFI-COD-OFIC IN OFI.             
           PERFORM VAL-OFI.                                             
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'OFIEJEBCSNEX' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-EBCS.                               
           IF OFI-COD-MODL NOT = '8'                                    
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'EJE    NOBCS' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-EBCS.                               
                                                                        
            MOVE USR-COD-OFUS IN USR TO WSS-COD-OBCS IN WSS-VARI.       
            GO TO FIN-VAL-WFC-COD-EBCS.
      *>>>>                                                             
      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.
           MOVE WFC-COD-EBCS IN WFC-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-WFC-COD-EBCS.
           EXIT.
       
       VAL-WFC-COD-SBCS SECTION.
       INI-VAL-WFC-COD-SBCS.
           IF WFC-COD-SBCS IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-SBCS IN WFC-FLD.
      *<<<< WFC_COD_SBCS                                                
             IF WFC-COD-SBCS IN WFC-FLD NOT > SPACES                    
                IF WFC-COD-EBCS IN WFC-FLD > SPACES                     
                   MOVE WSS-COD-OBCS IN WSS-VARI TO                     
                        WFC-COD-SBCS IN WFC-FLD                         
                ELSE                                                    
                   GO TO FIN-VAL-WFC-COD-SBCS.                          
      *>>>>                                                             
      *NO VALIDA QUE OFICINA CORRESPONDA A LA DEL EJECUTIVO             
      *    IF WFC-COD-SBCS IN WFC-FLD NOT = WSS-COD-OBCS IN WSS-VARI    
      *       MOVE 'TAB'          TO MSG-COD-SIST                       
      *       MOVE 'OFIEJE NOBCS' TO MSG-COD-MENS                       
      *       PERFORM GET-MSG                                           
      *       MOVE MSG-GLS-DESC TO FRM-MENS                             
      *       MOVE FRM-SUAR-MAL TO FRM-SUAR                             
      *       GO TO FIN-VAL-WFC-COD-SBCS.                               
      *VAL-OFI Valida codigo de Oficina en TABLAS                       
           MOVE WFC-COD-SBCS IN WFC-FLD TO OFI-COD-OFIC IN OFI.         
           PERFORM VAL-OFI.                                             
           IF MSG-COD-MENS NOT = SPACES                                 
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR.                            
              GO TO FIN-VAL-WFC-COD-SBCS.                               
           IF OFI-COD-MODL NOT = '8'                                    
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'OFI    NOBCS' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-SBCS.                               
           GO TO FIN-VAL-WFC-COD-SBCS.
      *>>>>
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE WFC-COD-SBCS IN WFC-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-WFC-COD-SBCS.
           EXIT.
       
       VAL-WFC-COD-EBCI SECTION.
       INI-VAL-WFC-COD-EBCI.
           IF WFC-COD-EBCI IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-EBCI IN WFC-FLD.
      *<<<< WFC_COD_EBCI                                                
             IF WFC-COD-EBCI IN WFC-FLD NOT > SPACES                    
                GO TO FIN-VAL-WFC-COD-EBCI.                             
      *>>>>                                                             
      *VAL-TDU Valida Tipo de Usuario                                   
           MOVE 'EJC '                  TO USR-COD-TTAB IN USR.         
           MOVE WFC-COD-EBCI IN WFC-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
      *PVG INI 30-12-2005                                               
              MOVE 'USR '                  TO USR-COD-TTAB IN USR       
              MOVE WFC-COD-EBCI IN WFC-FLD TO USR-COD-USER IN USR       
              PERFORM VAL-TDU                                           
              IF MSG-COD-MENS > SPACES                                  
      *PVG FIN 30-12-2005                                               
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-WFC-COD-EBCI.                            
                                                                        
           MOVE USR-COD-OFUS IN USR TO OFI-COD-OFIC IN OFI.             
           PERFORM VAL-OFI.                                             
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'OFIEJEBCINEX' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-EBCI.                               
                                                                        
           IF OFI-COD-MODL IN OFI = '8'                                 
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'EJE    NOBCI' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-EBCI.                               
           MOVE USR-COD-OFUS IN USR TO WSS-COD-OBCI IN WSS-VARI.        
           GO TO FIN-VAL-WFC-COD-EBCI.
      *>>>>
      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.
           MOVE WFC-COD-EBCI IN WFC-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-WFC-COD-EBCI.
           EXIT.
       
       VAL-WFC-COD-SBCI SECTION.
       INI-VAL-WFC-COD-SBCI.
           IF WFC-COD-SBCI IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-SBCI IN WFC-FLD.
      *<<<< WFC_COD_SBCI                                                
             IF WFC-COD-SBCI IN WFC-FLD NOT > SPACES                    
                IF WFC-COD-EBCI IN WFC-FLD > SPACES                     
                   MOVE WSS-COD-OBCI IN WSS-VARI TO                     
                        WFC-COD-SBCI IN WFC-FLD                         
                ELSE                                                    
                   GO TO FIN-VAL-WFC-COD-SBCI.                          
      *>>>>                                                             
      *NO VALIDA QUE OFICINA INGRESADA CORRESPONDA A LA DEL EJECUTIVO   
      *    IF WFC-COD-SBCI IN WFC-FLD NOT = WSS-COD-OBCI IN WSS-VARI    
      *       MOVE 'TAB'          TO MSG-COD-SIST                       
      *       MOVE 'OFIEJE NOBCI' TO MSG-COD-MENS                       
      *       PERFORM GET-MSG                                           
      *       MOVE MSG-GLS-DESC TO FRM-MENS                             
      *       MOVE FRM-SUAR-MAL TO FRM-SUAR                             
      *       GO TO FIN-VAL-WFC-COD-SBCI.                               
                                                                        
      *VAL-OFI Valida codigo de Oficina en TABLAS                       
           MOVE WFC-COD-SBCI IN WFC-FLD TO OFI-COD-OFIC IN OFI.         
           PERFORM VAL-OFI.                                             
           IF MSG-COD-MENS > SPACES                                     
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-SBCI.                               
           IF OFI-COD-MODL IN OFI = '8'                                 
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'OFI    NOBCI' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-SBCI.
           GO TO FIN-VAL-WFC-COD-SBCI.                               
      *>>>>
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE WFC-COD-SBCI IN WFC-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-WFC-COD-SBCI.
           EXIT.
       
       VAL-WFC-VAL-CFMN SECTION.
       INI-VAL-WFC-VAL-CFMN.
       FIN-VAL-WFC-VAL-CFMN.
           EXIT.
       
       VAL-WFC-COD-CFMN SECTION.
       INI-VAL-WFC-COD-CFMN.
           IF WFC-COD-CFMN IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-CFMN IN WFC-FLD.
      *<<<< WFC_COD_CFMN                                                
           IF WFC-VAL-CFMN  IN WFC-FLD > ZEROES AND                     
              WFC-COD-CFMN IN WFC-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-WFC-COD-CFMN.                               
                                                                        
           IF WFC-VAL-CFMN  IN WFC-FLD NOT > ZEROES AND                 
              WFC-COD-CFMN IN WFC-FLD > SPACES                          
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'VCOC   INV' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-CFMN.                               
           IF WFC-COD-CFMN IN WFC-FLD NOT > SPACES                      
              MOVE SPACES TO FRM-GLS-CFMN IN WFC-FLD                    
              GO TO FIN-VAL-WFC-COD-CFMN.                               
      *>>>>                                                             
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE WFC-COD-CFMN IN WFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              WFC-COD-CFMN IN WFC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CFMN IN WFC-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-CFMN IN WFC-FLD.
       FIN-VAL-WFC-COD-CFMN.
           EXIT.
       
       VAL-FRM-GLS-CFMN SECTION.
       INI-VAL-FRM-GLS-CFMN.
       FIN-VAL-FRM-GLS-CFMN.
           EXIT.
       
       VAL-WFC-VAL-CVTE SECTION.
       INI-VAL-WFC-VAL-CVTE.
       FIN-VAL-WFC-VAL-CVTE.
           EXIT.
       
       VAL-WFC-COD-CVTE SECTION.
       INI-VAL-WFC-COD-CVTE.
           IF WFC-COD-CVTE IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-CVTE IN WFC-FLD.
      *<<<< WFC_COD_CVTE                                                
           IF WFC-VAL-CVTE  IN WFC-FLD > ZEROES AND                     
              WFC-COD-CVTE IN WFC-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-WFC-COD-CVTE.                               
                                                                        
           IF WFC-VAL-CVTE  IN WFC-FLD NOT > ZEROES AND                 
              WFC-COD-CVTE IN WFC-FLD > SPACES                          
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'VCOC   INV' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-CVTE.                               
           IF WFC-COD-CVTE IN WFC-FLD NOT > SPACES                      
              MOVE SPACES TO FRM-GLS-CVTE IN WFC-FLD                    
              GO TO FIN-VAL-WFC-COD-CVTE.                               
      *>>>>                                                             
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE WFC-COD-CVTE IN WFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              WFC-COD-CVTE IN WFC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CVTE IN WFC-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-CVTE IN WFC-FLD.
       FIN-VAL-WFC-COD-CVTE.
           EXIT.
       
       VAL-FRM-GLS-CVTE SECTION.
       INI-VAL-FRM-GLS-CVTE.
       FIN-VAL-FRM-GLS-CVTE.
           EXIT.
       
       VAL-WFC-NUM-NTSM SECTION.
       INI-VAL-WFC-NUM-NTSM.
       FIN-VAL-WFC-NUM-NTSM.
           EXIT.
       
       VAL-WFC-CAI-CCCF SECTION.
       INI-VAL-WFC-CAI-CCCF.
           IF WFC-CAI-CCCF IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-CAI-CCCF IN WFC-FLD.
      *<<<< WFC_CAI_CCCF                                                
           IF WFC-CAI-CCCF IN WFC-FLD NOT > SPACES                      
               GO TO FIN-VAL-WFC-CAI-CCCF.                              
           MOVE WFC-CAI-CCCF IN WFC-FLD TO OPE-CAI-IOPE IN OPE.         
           MOVE WFC-IIC-CCCF IN WFC-FLD TO OPE-IIC-IOPE IN OPE.         
           MOVE FIO-GET-KEY             TO FIO-CMND.                    
           PERFORM SGC-FIO-OPE.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'SGC'          TO MSG-COD-SIST                      
               MOVE 'CTA INVALIDA' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-WFC-CAI-CCCF.                              
           IF OPE-COD-TOPR IN OPE NOT = 'CCT'                           
               MOVE 'SGC'          TO MSG-COD-SIST                      
               MOVE 'CTA NO CCT' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-WFC-CAI-CCCF.                              
           MOVE OPE-CIC-IOPE IN OPE TO RCO-CIC-IOPE IN RCO.             
           MOVE DBC-CAI-ICLI IN WFC-FLD TO RCO-CAI-ICLI IN RCO.         
           MOVE DBC-IIC-ICLI IN WFC-FLD TO RCO-IIC-ICLI IN RCO.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-RCO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'SGC'          TO MSG-COD-SIST                      
               MOVE 'CTA NOCLI' TO MSG-COD-MENS                         
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-WFC-CAI-CCCF.                              
      *>>>>                                                             
       FIN-VAL-WFC-CAI-CCCF.
           EXIT.
       
       VAL-WFC-IIC-CCCF SECTION.
       INI-VAL-WFC-IIC-CCCF.
           IF WFC-IIC-CCCF IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-IIC-CCCF IN WFC-FLD.
      *<<<<                                                             
           IF WFC-IIC-CCCF IN WFC-FLD > SPACES AND                      
              WFC-CAI-CCCF IN WFC-FLD NOT > SPACES                      
               MOVE 'SGC'          TO MSG-COD-SIST                      
               MOVE 'CTA INVALIDA' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-WFC-IIC-CCCF.                              
      *>>>>                                                             
       FIN-VAL-WFC-IIC-CCCF.
           EXIT.
       
       VAL-WFC-EXT-CCCF SECTION.
       INI-VAL-WFC-EXT-CCCF.
           IF WFC-EXT-CCCF IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-EXT-CCCF IN WFC-FLD.
      *<<<<                                                             
           IF WFC-EXT-CCCF IN WFC-FLD > SPACES AND                      
              WFC-CAI-CCCF IN WFC-FLD NOT > SPACES                      
               MOVE 'SGC'          TO MSG-COD-SIST                      
               MOVE 'CTA INVALIDA' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-WFC-EXT-CCCF.                              
      *>>>>                                                             
       FIN-VAL-WFC-EXT-CCCF.
           EXIT.
       
       VAL-WFC-COD-ACTC SECTION.
       INI-VAL-WFC-COD-ACTC.
           IF WFC-COD-ACTC IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-ACTC IN WFC-FLD.
      *<<<< WFC_COD_ACTC                                                
             IF WFC-COD-ACTC IN WFC-FLD NOT > SPACES                    
                 GO TO FIN-VAL-WFC-COD-ACTC.                            
      *>>>>                                                             
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ACT ' TO TAB-COD-TTAB IN TAB.
           MOVE WFC-COD-ACTC IN WFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-WFC-COD-ACTC.
           EXIT.
       
       VAL-WFC-COD-PTRF SECTION.
       INI-VAL-WFC-COD-PTRF.
           IF WFC-COD-PTRF IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-PTRF IN WFC-FLD.
      *<<<< WFC_COD_PTRF                                                
           IF WFC-COD-PTRF IN WFC-FLD > SPACES                          
              MOVE 'TAB' TO TAB-COD-SIST                                
              MOVE 'PTR' TO TAB-COD-TTAB IN TAB                         
              MOVE WFC-COD-PTRF IN WFC-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC TO FRM-GLS-PTR1 IN WFC-FLD           
              ELSE                                                      
                 MOVE SPACES       TO FRM-GLS-PTR1 IN WFC-FLD           
           ELSE                                                         
              MOVE SPACES          TO FRM-GLS-PTR1 IN WFC-FLD.          
           GO TO FIN-VAL-WFC-COD-PTRF.
      *>>>>                                                             
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'PTR ' TO TAB-COD-TTAB IN TAB.
           MOVE WFC-COD-PTRF IN WFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-WFC-COD-PTRF.
           EXIT.
       
       VAL-WFC-IND-IWFL SECTION.
       INI-VAL-WFC-IND-IWFL.
           IF WFC-IND-IWFL IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-IND-IWFL IN WFC-FLD.
       FIN-VAL-WFC-IND-IWFL.
           EXIT.
       
       VAL-FRM-GLS-PTR1 SECTION.
       INI-VAL-FRM-GLS-PTR1.
       FIN-VAL-FRM-GLS-PTR1.
           EXIT.
       
       VAL-WFC-COD-CNDP SECTION.
       INI-VAL-WFC-COD-CNDP.
           IF WFC-COD-CNDP IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-CNDP IN WFC-FLD.
      *<<<< WFC_COD_CNDP                                                
           IF WFC-COD-CNDP IN WFC-FLD > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'CDP '                  TO TAB-COD-TTAB IN TAB       
              MOVE WFC-COD-CNDP IN WFC-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
       FIN-VAL-WFC-COD-CNDP.
           EXIT.
       
       VAL-WFC-IND-RBPR SECTION.
       INI-VAL-WFC-IND-RBPR.
           IF WFC-IND-RBPR IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-IND-RBPR IN WFC-FLD.
      *<<<<  WFC_IND_RBPR                                               
           IF WFC-IND-RBPR IN WFC-FLD > SPACES                          
              MOVE 'GNS'                   TO TAB-COD-SIST              
              MOVE 'SON '                  TO TAB-COD-TTAB IN TAB       
              MOVE WFC-IND-RBPR IN WFC-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
       FIN-VAL-WFC-IND-RBPR.
           EXIT.
       
       VAL-WFC-COD-RAUT SECTION.
       INI-VAL-WFC-COD-RAUT.
           IF WFC-COD-RAUT IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-RAUT IN WFC-FLD.
      *<<<<
      *PVG INI 15-JUL-2005 (VALIDACION-DEFINICION)                      
           IF WFC-COD-RAUT IN WFC-FLD NOT > SPACES                      
              GO TO FIN-VAL-WFC-COD-RAUT.                               
                                                                        
           MOVE 'EJC '                  TO USR-COD-TTAB IN USR.         
           MOVE WFC-COD-RAUT IN WFC-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS = 'COD    NVG' OR 'COD    NEX'               
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-WFC-COD-RAUT.                               
      *VALIDACION ADICIONAL                                             
           IF USR-EXT-CTAB IN USR = 'AUT  '                             
              GO TO FIN-VAL-WFC-COD-RAUT.                               
                                                                        
           IF USR-COD-CUSR IN USR NOT > SPACES                          
              GO TO ERR-VAL-WFC-COD-RAUT.                               
                                                                        
           MOVE 'TAB'  TO TAB-COD-SIST.                                 
           MOVE 'CUS'  TO TAB-COD-TTAB IN TAB.                          
           MOVE USR-COD-CUSR IN USR TO TAB-COD-CTAB IN TAB.             
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS > SPACES                                     
              GO TO ERR-VAL-WFC-COD-RAUT.                               
           IF (TAB-COD-DAT3 IN TAB(1) = 'CNV' AND                       
               TAB-COD-DAT3 IN TAB(2) = 'CPR')                          
               GO TO FIN-VAL-WFC-COD-RAUT.                              
                                                                        
       ERR-VAL-WFC-COD-RAUT.                                            
           MOVE 'TAB'          TO MSG-COD-SIST.                         
           MOVE 'CODCUS   INV' TO MSG-COD-MENS.                         
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC   TO FRM-MENS.                             
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.                             
      *PVG FIN 15-JUL-2005 
      *>>>>                                              
       FIN-VAL-WFC-COD-RAUT.
           EXIT.
       
       VAL-WFC-COD-TCTA SECTION.
       INI-VAL-WFC-COD-TCTA.
           IF WFC-COD-TCTA IN WFC-FLD NOT > SPACES
              MOVE SPACES TO WFC-COD-TCTA IN WFC-FLD.
      *<<<<
           IF WFC-COD-TCTA IN WFC-FLD > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'CCN '                  TO TAB-COD-TTAB IN TAB       
              MOVE WFC-COD-TCTA IN WFC-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>
       FIN-VAL-WFC-COD-TCTA.
           EXIT.
       
       VAL-WFC-CAI-ICON SECTION.
       INI-VAL-WFC-CAI-ICON.
      *<<<<
           MOVE WFC-CAI-CONV IN WFC-FLD TO WFC-CAI-ICON IN WFC-FLD.     
      *>>>>
       FIN-VAL-WFC-CAI-ICON.
           EXIT.
       
       VAL-WFC-IIC-ICON SECTION.
       INI-VAL-WFC-IIC-ICON.
      *<<<<
           MOVE WFC-IIC-CONV IN WFC-FLD TO WFC-IIC-ICON IN WFC-FLD.     
      *>>>>
       FIN-VAL-WFC-IIC-ICON.
           EXIT.
       
       VAL-FRM-COD-TMET SECTION.
       INI-VAL-FRM-COD-TMET.
           IF FRM-COD-TMET IN WFC-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-TMET IN WFC-FLD.
      *<<<< FRM_COD_TMET                                                
            IF SCR-CMND = 'IMT'                                         
               IF FRM-COD-TMET IN WFC-FLD NOT > SPACES                  
                  PERFORM ERR-GLS                                       
                  GO TO FIN-VAL-FRM-COD-TMET                            
               ELSE                                                     
                  NEXT SENTENCE                                         
            ELSE                                                        
               IF FRM-COD-TMET IN WFC-FLD > SPACES                      
                  MOVE 'TAB'       TO MSG-COD-SIST                      
                  MOVE 'TDM   INV' TO MSG-COD-MENS                      
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-FRM-COD-TMET.                           
                                                                        
           IF FRM-COD-TMET IN WFC-FLD > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE FRM-COD-TMET IN WFC-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
       FIN-VAL-FRM-COD-TMET.
           EXIT.
       
       VAL-FRM-NUM-METR SECTION.
       INI-VAL-FRM-NUM-METR.
      *<<<<
           IF FRM-NUM-METR IN WFC-FLD > ZEROES AND                      
              FRM-COD-TMET IN WFC-FLD NOT > SPACES                      
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'NUMINVALIDO ' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              GO TO FIN-VAL-FRM-NUM-METR.                               
                                                                        
           IF FRM-NUM-METR IN WFC-FLD NOT > ZEROES                      
              MOVE ZEROES TO FRM-NUM-METR IN WFC-FLD.                   
                                                                        
      *<<<<
       FIN-VAL-FRM-NUM-METR.
           EXIT.
       
       VAL-FRM-IND-LOGA SECTION.
       INI-VAL-FRM-IND-LOGA.
           IF FRM-IND-LOGA IN WFC-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-LOGA IN WFC-FLD.
     * <<<<
           IF FRM-IND-LOGA IN WFC-FLD NOT > SPACES                      
              MOVE 'N' TO FRM-IND-LOGA IN WFC-FLD.                      
                                                                        
           IF SCR-CMND = 'IAB' AND FRM-IND-LOGA IN WFC-FLD NOT = 'S'    
              PERFORM ERR-GLS                                           
              MOVE 'TAB'       TO MSG-COD-SIST                          
              MOVE 'LOGS  OBL' TO MSG-COD-MENS                          
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-FRM-IND-LOGA.                               
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-IND-LOGA IN WFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-IND-LOGA.
           EXIT.
       
       VAL-FRM-IND-ALGA SECTION.
       INI-VAL-FRM-IND-ALGA.
           IF FRM-IND-ALGA IN WFC-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-ALGA IN WFC-FLD.
      *<<<< FRM_COD_TMET                                                
           IF FRM-IND-ALGA IN WFC-FLD > SPACES AND                      
              FRM-IND-LOGA IN WFC-FLD NOT = 'S'                         
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'TIPOTREA INV' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              GO TO FIN-VAL-FRM-IND-ALGA.                               
                                                                        
           IF FRM-IND-LOGA IN WFC-FLD = 'S' AND                         
              FRM-IND-ALGA IN WFC-FLD NOT > SPACES                      
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'TAREA    OBL' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              GO TO FIN-VAL-FRM-IND-ALGA.                               
                                                                        
           IF FRM-IND-ALGA IN WFC-FLD > SPACES                          
              MOVE 'TAB' TO TAB-COD-SIST                                
              MOVE 'TDT' TO TAB-COD-TTAB IN TAB                         
              MOVE FRM-IND-ALGA IN WFC-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
       FIN-VAL-FRM-IND-ALGA.
           EXIT.
       
       VAL-CON-FLD-WFC SECTION.
       INI-VAL-CON-FLD-WFC.
      *<<<<                                                             
           IF WFC-COD-PTRF IN WFC-FLD > SPACES AND                      
              WFC-IND-RBPR IN WFC-FLD = 'S'                             
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'PTR   RP INV' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              MOVE FRM-IND-ERRO   TO WFC-COD-PTRF-LEN IN WFC-FLD        
              MOVE 'S'            TO FRM-UCUR                           
              GO TO FIN-VAL-CON-FLD-WFC.                                
                                                                        
           IF WFC-COD-EBCS IN WFC-FLD NOT > SPACES AND                  
              WFC-COD-SBCS IN WFC-FLD > SPACES                          
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'EJCBCS   OBL' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              MOVE FRM-IND-ERRO   TO WFC-COD-EBCS-LEN IN WFC-FLD        
              MOVE 'S'            TO FRM-UCUR                           
              GO TO FIN-VAL-CON-FLD-WFC.                                
                                                                        
           IF WFC-COD-EBCI IN WFC-FLD NOT > SPACES AND                  
              WFC-COD-SBCI IN WFC-FLD > SPACES                          
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'EJCBCI   OBL' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              MOVE FRM-IND-ERRO   TO WFC-COD-EBCI-LEN IN WFC-FLD        
              MOVE 'S'            TO FRM-UCUR                           
              GO TO FIN-VAL-CON-FLD-WFC.                                
                                                                        
           IF NOT SCR-CMND = 'APR'                                      
              GO TO FIN-VAL-CON-FLD-WFC.                                
                                                                        
           IF WFC-COD-RAPR IN WFC-FLD NOT > SPACES AND                  
              WFC-COD-CAPR IN WFC-FLD NOT > SPACES                      
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'CODCARAPROBL' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              GO TO FIN-VAL-CON-FLD-WFC.                                
                                                                        
           IF WFC-COD-RAPR IN WFC-FLD NOT > SPACES                      
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'COD   APROBL' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              GO TO FIN-VAL-CON-FLD-WFC.                                
                                                                        
           IF WFC-COD-CAPR IN WFC-FLD NOT > SPACES                      
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'CAR   APROBL' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              GO TO FIN-VAL-CON-FLD-WFC.                                
      *>>>>                                                             
       FIN-VAL-CON-FLD-WFC.
           EXIT.
       
       VAL-CON-WFC SECTION.
       INI-VAL-CON-WFC.
       FIN-VAL-CON-WFC.
           EXIT.
       
       VAL-NUM-KEY-WFC SECTION.
       INI-VAL-NUM-KEY-WFC.
           PERFORM VAL-NUM-IKY-WFC.
           PERFORM VAL-NUM-MKY-WFC.
           PERFORM VAL-NUM-AKY-WFC.
       FIN-VAL-NUM-KEY-WFC.
           EXIT.
       
       VAL-NUM-IKY-WFC SECTION.
       INI-VAL-NUM-IKY-WFC.
       VAL-NUM-WFC-HRA-CONV.
           MOVE WFC-HRA-CONV-ALF IN WFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO WFC-HRA-CONV IN WFC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO WFC-HRA-CONV-LEN IN WFC-FLD
                GO TO FIN-VAL-NUM-IKY-WFC.
       FIN-VAL-NUM-IKY-WFC.
           EXIT.
       
       VAL-NUM-MKY-WFC SECTION.
       INI-VAL-NUM-MKY-WFC.
       FIN-VAL-NUM-MKY-WFC.
           EXIT.
       
       VAL-NUM-AKY-WFC SECTION.
       INI-VAL-NUM-AKY-WFC.
       FIN-VAL-NUM-AKY-WFC.
           EXIT.
       
       VAL-NUM-FLD-WFC SECTION.
       INI-VAL-NUM-FLD-WFC.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN WFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN WFC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN WFC-FLD
                GO TO FIN-VAL-NUM-FLD-WFC.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-WFC-NUM-PAGR.
           MOVE WFC-NUM-PAGR-ALF IN WFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO WFC-NUM-PAGR IN WFC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO WFC-NUM-PAGR-LEN IN WFC-FLD
                GO TO FIN-VAL-NUM-FLD-WFC.
       VAL-NUM-WFC-VAL-CFMN.
           MOVE WFC-VAL-CFMN-ALF IN WFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO WFC-VAL-CFMN IN WFC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO WFC-VAL-CFMN-LEN IN WFC-FLD
                GO TO FIN-VAL-NUM-FLD-WFC.
       VAL-NUM-WFC-VAL-CVTE.
           MOVE WFC-VAL-CVTE-ALF IN WFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO WFC-VAL-CVTE IN WFC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO WFC-VAL-CVTE-LEN IN WFC-FLD
                GO TO FIN-VAL-NUM-FLD-WFC.
       VAL-NUM-WFC-NUM-NTSM.
           MOVE WFC-NUM-NTSM-ALF IN WFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO WFC-NUM-NTSM IN WFC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO WFC-NUM-NTSM-LEN IN WFC-FLD
                GO TO FIN-VAL-NUM-FLD-WFC.
       VAL-NUM-FRM-NUM-METR.
           MOVE FRM-NUM-METR-ALF IN WFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-METR IN WFC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-METR-LEN IN WFC-FLD
                GO TO FIN-VAL-NUM-FLD-WFC.
       FIN-VAL-NUM-FLD-WFC.
           EXIT.
       
       EDT-KEY-WFC SECTION.
       INI-EDT-KEY-WFC.
           PERFORM EDT-IKY-WFC.
           PERFORM EDT-MKY-WFC.
           PERFORM EDT-AKY-WFC.
       FIN-EDT-KEY-WFC.
           EXIT.
       
       EDT-IKY-WFC SECTION.
       INI-EDT-IKY-WFC.
           IF WFC-HRA-CONV-LEN IN WFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO WFC-HRA-CONV-LEN IN WFC-FLD
                GO TO FIN-EDT-IKY-WFC.
           MOVE WFC-HRA-CONV IN WFC-FLD TO WFC-HRA-CONV-EDT IN WFC-EDT.
           MOVE WFC-HRA-CONV-EDT IN WFC-EDT TO 
                WFC-HRA-CONV-ALF IN WFC-FLD.
       FIN-EDT-IKY-WFC.
           EXIT.
       
       EDT-MKY-WFC SECTION.
       INI-EDT-MKY-WFC.
       FIN-EDT-MKY-WFC.
           EXIT.
       
       EDT-AKY-WFC SECTION.
       INI-EDT-AKY-WFC.
       FIN-EDT-AKY-WFC.
           EXIT.
       
       EDT-FLD-WFC SECTION.
       INI-EDT-FLD-WFC.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN WFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN WFC-FLD
                GO TO FIN-EDT-FLD-WFC.
           MOVE DBC-NUM-ICLI IN WFC-FLD TO
                DBC-NUM-ICLI-EDT IN WFC-EDT.
           MOVE DBC-NUM-ICLI-EDT IN WFC-EDT TO
                DBC-NUM-ICLI-ALF IN WFC-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF WFC-NUM-PAGR-LEN IN WFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO WFC-NUM-PAGR-LEN IN WFC-FLD
                GO TO FIN-EDT-FLD-WFC.
           MOVE WFC-NUM-PAGR IN WFC-FLD TO WFC-NUM-PAGR-EDT IN WFC-EDT.
           MOVE WFC-NUM-PAGR-EDT IN WFC-EDT TO 
                WFC-NUM-PAGR-ALF IN WFC-FLD.
           IF WFC-VAL-CFMN-LEN IN WFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO WFC-VAL-CFMN-LEN IN WFC-FLD
                GO TO FIN-EDT-FLD-WFC.
           MOVE WFC-VAL-CFMN IN WFC-FLD TO WFC-VAL-CFMN-EDT IN WFC-EDT.
           MOVE WFC-VAL-CFMN-EDT IN WFC-EDT TO 
                WFC-VAL-CFMN-ALF IN WFC-FLD.
           IF WFC-VAL-CVTE-LEN IN WFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO WFC-VAL-CVTE-LEN IN WFC-FLD
                GO TO FIN-EDT-FLD-WFC.
           MOVE WFC-VAL-CVTE IN WFC-FLD TO WFC-VAL-CVTE-EDT IN WFC-EDT.
           MOVE WFC-VAL-CVTE-EDT IN WFC-EDT TO 
                WFC-VAL-CVTE-ALF IN WFC-FLD.
           IF WFC-NUM-NTSM-LEN IN WFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO WFC-NUM-NTSM-LEN IN WFC-FLD
                GO TO FIN-EDT-FLD-WFC.
           MOVE WFC-NUM-NTSM IN WFC-FLD TO WFC-NUM-NTSM-EDT IN WFC-EDT.
           MOVE WFC-NUM-NTSM-EDT IN WFC-EDT TO 
                WFC-NUM-NTSM-ALF IN WFC-FLD.
           IF FRM-NUM-METR-LEN IN WFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-METR-LEN IN WFC-FLD
                GO TO FIN-EDT-FLD-WFC.
           MOVE FRM-NUM-METR IN WFC-FLD TO FRM-NUM-METR-EDT IN WFC-EDT.
           MOVE FRM-NUM-METR-EDT IN WFC-EDT TO 
                FRM-NUM-METR-ALF IN WFC-FLD.
       FIN-EDT-FLD-WFC.
           EXIT.
