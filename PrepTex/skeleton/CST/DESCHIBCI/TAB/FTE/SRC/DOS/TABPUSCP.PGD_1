       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   TABPUSCP.
       AUTHOR.       BEE TEAM.
       DATE-WRITTEN. 20-May-10 11:06 AM.

      * NOMBRE PROGRAMA                   TABPUSCP
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      TABSGS
      * PANTALLA                          TABSCP
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250




       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.

       77  WSS-TAG-TABPUSCP-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$TABPUSCP$ SKL=$08.07.21$ VSN=$06.01.03.1$        
      -    'GEN=$20-May-10 11:06 AM$ FNC=$MC2-PRECIOS$/>'.    
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN


      *<<<< FIN_SCR_VARI                                                
      *ISP DEBE QUEDAR PRIMERO QUE EL OTRO LABEL FIN_SCR_VARI           
       COPY COLWGENG.                                                   
      *>>>>                                                             
                                                                        
      *<<<< FIN-SCR-VARI                                                
           03  SCR-NUM-PANT                         PIC 9(03).          
           03  SCR-TOT-OCCU    VALUE 0              PIC 9(03).          
      *>>>>                                                             
                                                                        
      *     03 SCR-NUM-PANT               PIC 9(02).                    
           03 SCR-SCP-FLD                PIC X(1080).                   
       COPY TABWISCP.
       COPY TABBRSGS.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SGS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGSYS.


      *<<<< WSS                                                         
      *PVG INI 11-ENE-2007 INTEGRACION CGN                              
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.        
       COPY GNSBRMSC.                                                   
      *PVG FIN 11-ENE-2007                                              
      *PVG INI 11-ENE-2007 INTEGRACION CGN                              
       COPY GNSWCVRF.                                                   
       COPY GNSWVVRF.                                                   
       COPY GNSWGIDC.                                                   
      *PVG FIN 11-ENE-2007                                              
       COPY TABWXSCP.                                                   
       01  WSS-VARI-PFS-QUE.                                            
           03 WSS-HAY-ERRO     VALUE 'N'            PIC X(01).          
           03 WSS-FRM-FFLD     VALUE SPACES         PIC X(01).          
           03 WSS-MAX-PANT     VALUE 10 PIC 9(05).                      
           03 WSS-IND-PANT     VALUE 1              PIC 9(05).          
           03 WSS-IND-HMAS     VALUE 'N'            PIC X(01).          
      *>>>> WSS                                                         
                                                                        
      *<<<< WSS                                                         
       77  WSS-ISCP            VALUE ZEROES         PIC 9(05).          
       77  WSS-ISCP-AUX        VALUE ZEROES         PIC 9(05).          
                                                                        
       01 WSS-VARI.                                                     
           03 WSS-N                                PIC 9(02).           
           03 WSS-N-MAX         VALUE 30           PIC 9(02).           
           03 WSS-I                                PIC 9(02).           
           03 WSS-IMAX          VALUE 50           PIC 9(02).           
           03 WSS-K                                PIC 9(02).           
           03 WSS-KMAX          VALUE 50           PIC 9(02).           
           03 WSS-L                                PIC 9(02).           
           03 WSS-J                                PIC 9(02).           
           03 WSS-JMAX          VALUE 50           PIC 9(02).           
           03 WSS-S                                PIC 9(02).           
           03 WSS-R                                PIC 9(02).           
           03 WSS-NUM-NMES      VALUE ZEROES       PIC 9(06).           
                                                                        
           03 WSS-VAL-MNTO      VALUE ZEROES       PIC 9(13).           
           03 WSS-COD-MONE      VALUE SPACES       PIC X(06).           
           03 WSS-NUM-IROC      VALUE ZEROES       PIC 9(03).           
           03 WSS-COD-TCAR      VALUE SPACES       PIC X(03).           
           03 WSS-IND-DUPL      VALUE SPACES       PIC X(01).           
                                                                        
           03 WSS-VEC-TSEG OCCURS 50.                                   
              05 WSS-IND-SELE                      PIC X(01).           
              05 WSS-COD-TSEG                      PIC X(03).           
                                                                        
       COPY TABBRROC.                                                   
       COPY COLBROPC.                                                   
       COPY COLBRDLC.                                                   
       COPY COLBRTOC.                                                   
       COPY COLBRRDC.                                                   
       COPY COLBRVEN.                                                   
       COPY COLBREVC.                                                   
       COPY COLBRAUT.                                                   
       COPY COLBRITR.                                                   
       COPY SGCBRDBC.                                                   
                                                                        
       COPY COLWGUVD.                                                   
       COPY TABWGQSP.                                                   
       COPY TABWGRCC.                                                   
       COPY COLWGPMP.                                                   
      *>>>>                                                             
                                                                        
      *<<<< WSS_DTC                                                     
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
      *>>>>                                                             
       01 WSS-NUM-VALOR VALUE ZEROES PIC 9(03).                         
       01 WSS-NUM-CCUR.                                                 
           03 WSS-NUM-ICUR-EDT  PIC  ZZ9.                               
           03 WSS-NUM-ICUR-ALF       PIC X(03).                         
           03 WSS-NUM-ICUR      REDEFINES                               
              WSS-NUM-ICUR-ALF       PIC 9(03).                         
      *>>>> 


       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).
              05 PGM-STAT-SGS.
                 88 PGM-STAT-SGS-NUL    VALUE '  '.
                 07 PGM-STT1-SGS        VALUE '2' PIC X(01).
                    88 PGM-STAT-SGS-OKS VALUE '0'.
                 07 PGM-STT2-SGS        VALUE '3' PIC X(01).

           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 DFH-CMMA OCCURS 3000 PIC X(01).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.

           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.

       COPY GNSBGEDB.
           MOVE LOW-VALUES TO SCP-FLD.
           MOVE LOW-VALUES TO SCP-EDT.

           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +3000 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'TABPUSCP' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN


      *<<<< INI_FIO                                                     
           IF SCR-OFRM-SRV                                              
                MOVE TSK-TERM-ALF TO SCP-COD-TERM                       
                MOVE TSK-TERM-ALF TO SCP-COD-TERM-MAS                   
                MOVE 'S'          TO RCC-OFRM-SRV                       
           ELSE                                                         
                MOVE EIBTRMID     TO SCP-COD-TERM                       
                MOVE EIBTRMID     TO SCP-COD-TERM-MAS                   
                MOVE 'S'          TO RCC-OFRM-SRV.                      
                                                                        
           IF FRM-FFLD = FRM-FFLD-PF5 AND                               
              SCR-INST = SCR-INST-GFL                                   
                MOVE FRM-FFLD-PF5 TO WSS-FRM-FFLD                       
                MOVE FRM-FFLD-RET TO FRM-FFLD                           
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PF6 AND                               
              SCR-INST = SCR-INST-GFL                                   
                MOVE FRM-FFLD-PF6 TO WSS-FRM-FFLD                       
                MOVE FRM-FFLD-RET TO FRM-FFLD                           
           ELSE                                                         
                MOVE FRM-FFLD-RET TO WSS-FRM-FFLD.                      
      *>>>>                                                             
                                                                        
      *<<<< INI_FIO                                                     
      *>>>>                                                             
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.

      *<<<< INI_SCR_COM                                                 
           PERFORM DEL-QUE-SCP.                                         
      *>>>>                                                             
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-SCP.
           PERFORM EDT-KEY-SCP.
           PERFORM EDT-FLD-SCP.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.

           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.

       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.

           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.

           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.

           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.

           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.

           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.

           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.

           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.

           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.

           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.

           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.

           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.

           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-SCP
               PERFORM EDT-KEY-SCP
               PERFORM EDT-FLD-SCP
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-SCP
               PERFORM EDT-KEY-SCP
           ELSE
               PERFORM CLR-FLD-SCP
               PERFORM EDT-FLD-SCP.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.

           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO SCP-FLD.
           MOVE LOW-VALUES TO SCP-EDT.

       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.

           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.

           PERFORM KEY-ALL-SCP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM TAB-FIO-SGS.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.

           PERFORM RET-ALL-SCP.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM TAB-FIO-SGS.

       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO SGS.

           PERFORM RET-ALL-SCP.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM TAB-FIO-SGS.

       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS

               GO TO FIN-CMN-ACC.

      *<<<< INI_CMN_ACC                                                 
           PERFORM ELI-ROC.                                             
                                                                        
           PERFORM PRO-ING-ROC.                                         
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-CMN-ACC.                                       
                                                                        
      *PVG INI 06-SEP-2006 (CONTINGENCIA)                               
      *    MOVE ROC-CAI-IOPC IN ROC TO OPC-CAI-IOPC IN OPC.             
      *    MOVE ROC-IIC-IOPC IN ROC TO OPC-IIC-IOPC IN OPC.             
           MOVE OPC-CAI-IOPC IN SCP-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO OPC-IIC-IOPC IN OPC.         
      *PVG FIN 06-SEP-2006                                              
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM COL-FIO-OPC.                                         
           IF FIO-STAT-OKS                                              
              IF OPC-MSC-STAT IN OPC = 'I'                              
                 MOVE FIO-ULK-REC TO FIO-CMND                           
                 PERFORM COL-FIO-OPC                                    
              ELSE                                                      
                 MOVE 'I'        TO OPC-MSC-STAT IN OPC                 
                 MOVE 'TABPUSCP' TO OPC-COD-ATRN IN OPC                 
                 MOVE FIO-MOD    TO FIO-CMND                            
                 PERFORM COL-FIO-OPC.                                   
                                                                        
           MOVE 'TAB'               TO MSG-COD-SIST.                    
           MOVE 'ROC    INGOK'      TO MSG-COD-MENS.                    
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           GO TO CNT-CMN-ACC.                                           
      *>>>>                                                             
           PERFORM KEY-ALL-SCP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM TAB-FIO-SGS.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.

           PERFORM RET-ALL-SCP.

      *<<<< FIN_CMN_ACC OR SCR_GFLD_VAL_MKY                             
       CNT-CMN-ACC.                                                     
           IF FRM-FFLD = FRM-FFLD-PF10 AND                              
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
      *<<<< FIN_CMN_ACC                                                 
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'            
               MOVE ROC-CAI-IOPC IN ROC TO OPC-CAI-IOPC IN OPC          
               MOVE ROC-IIC-IOPC IN ROC TO OPC-IIC-IOPC IN OPC          
               MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
               PERFORM COL-FIO-OPC                                      
               IF FIO-STAT-OKS                                          
                   MOVE 'I' TO OPC-MSC-STAT IN OPC                      
                   MOVE FIO-MOD TO FIO-CMND                             
                   PERFORM COL-FIO-OPC.                                 
      *>>>>                                                             
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.

           PERFORM KEY-ALL-SCP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM TAB-FIO-SGS.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM TAB-FIO-SGS.

       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.

           PERFORM RET-ALL-SCP.

       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.

           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.

       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.

      *<<<<
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR                            
              WSS-FRM-FFLD = FRM-FFLD-PF6                               
               MOVE SCR-INST-GFL TO SCR-INST.
      *>>>>                           
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.

           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.

      *<<<<                                                           
           IF (WSS-FRM-FFLD = FRM-FFLD-PF5 OR                           
               WSS-FRM-FFLD = FRM-FFLD-PF6) AND                         
               WSS-HAY-ERRO = 'N' AND                                   
               FRM-SUAR NOT = FRM-SUAR-MAL                              
               MOVE SPACES TO SCP-GLS-MENS IN SCP-FLD.                  
      *>>>>                                                           
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE SCP-FLD TO FRM-DFLD.

           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO SCP-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.

           MOVE SPACES TO FRM-MENS.

      *<<<<                                                           
           IF FRM-FFLD = FRM-FFLD-PF5                                   
              OR FRM-FFLD = FRM-FFLD-PF6                                
                MOVE FRM-FFLD-RET TO FRM-FFLD.                          
      *>>>>                                                           
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )

               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-SCP
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCP-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCP
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCP
               PERFORM EDT-FLD-SCP
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.

      *<<<< FIN_CMN_ING OR SCR_GFLD_VAL_MKY                             
           IF FRM-FFLD = FRM-FFLD-PF10 AND                              
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
           PERFORM VAL-MKY-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO ERR-SCR-GFLD.

           PERFORM VAL-FLD-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.

           PERFORM VAL-CON-FLD-SCP.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-SCP.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN

           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-SCP.
           PERFORM EDT-FLD-SCP.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.

      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD                
           IF FRM-FFLD = FRM-FFLD-PF3 AND                               
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )

               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCP-GLS-MEN2
               MOVE SCR-PRMT     TO SCP-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCP-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-SCP
               PERFORM VAL-NUM-FLD-SCP.

       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )

               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCP-GLS-MEN2
               MOVE SCR-PRMT     TO SCP-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCP-FLD.

       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO SCP-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.

      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE SCP-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO SCP-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-SCP

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO SCP-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO SCP-GLS-MENS.
           PERFORM PRO-FLD-SCP.
           PERFORM PRO-MKY-SCP.
           PERFORM UNP-IKY-SCP.
           PERFORM FST-KEY-SCP.

      *<<<< FIN_HBL_IKY                                                 
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM HBL-KEY-SCP.                                     
      *>>>>                                                             
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.

      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE SCP-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO SCP-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO SCP-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO SCP-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-SCP.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-SCP.
           PERFORM FST-KEY-SCP.

       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.

           PERFORM UNP-MKY-SCP.
           PERFORM UNP-FLD-SCP.
           PERFORM FST-FLD-SCP.

       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO SCP-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.

           PERFORM PRO-KEY-SCP.
           PERFORM PRO-FLD-SCP.
           PERFORM FST-MSG.

       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      * PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN


           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.

           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCP
               PERFORM EDT-FLD-SCP
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCP
               PERFORM EDT-FLD-SCP
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-SCP.
           PERFORM EDT-FLD-SCP.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.

      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-SCP.
           PERFORM PRO-FLD-SCP.
           PERFORM FST-MSG.

      *<<<<                                                           
           PERFORM SCP-PROC-ITEM.                                       
           IF WSS-FRM-FFLD = FRM-FFLD-RET                               
              MOVE ZEROES TO QUE-NITM                                   
           ELSE                                                         
           IF WSS-FRM-FFLD = FRM-FFLD-PF6                               
              COMPUTE QUE-NITM = (SCR-NUM-PANT * WSS-MAX-PANT)          
              IF QUE-NITM NOT < SCR-TOT-OCCU                            
                 MOVE 'S' TO WSS-HAY-ERRO                               
                 MOVE 'TAB' TO MSG-COD-SIST                             
                 MOVE 'SCPPF6   NEX' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 COMPUTE QUE-NITM =                                     
                   (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT         
              ELSE                                                      
                 ADD 1 TO SCR-NUM-PANT                                  
           ELSE                                                         
           IF WSS-FRM-FFLD = FRM-FFLD-PF5                               
              COMPUTE QUE-NITM = (SCR-NUM-PANT * WSS-MAX-PANT) -        
                      (2 * WSS-MAX-PANT - 1)                            
              IF QUE-NITM < 1                                           
                 MOVE 'S' TO WSS-HAY-ERRO                               
                 MOVE 'TAB' TO MSG-COD-SIST                             
                 MOVE 'SCPPF5   NEX' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 COMPUTE QUE-NITM =                                     
                   (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT         
              ELSE                                                      
                 SUBTRACT 1 FROM QUE-NITM                               
                 SUBTRACT 1 FROM SCR-NUM-PANT.                          
           MOVE SCP-NOM-TSSCP TO QUE-COLA.                              
           MOVE SCP-LEN-TSSCP TO QUE-LITM.                              
       SCP-CIC-LEE-TS.                                                  
           ADD 1 TO QUE-NITM.                                           
           MOVE QUE-NITM TO WSS-ISCP-AUX.                               
           MOVE QUE-GET TO QUE-CMND.                                    
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
               MOVE QUE-ITEM TO SCP-ITEM                                
               PERFORM SCP-MOV-TS-FRM                                   
               GO TO SCP-CIC-LEE-TS.                                    
                                                                        
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR                            
              WSS-FRM-FFLD = FRM-FFLD-PF6                               
               GO TO CNT-PRO-CONF.                                      
                                                                        
           PERFORM VRF-TIP-SEG.                                         
           IF WSS-IND-DUPL = 'S'                                        
               PERFORM SCR-MSSG                                         
               PERFORM EDT-KEY-SCP                                      
               PERFORM EDT-FLD-SCP                                      
               PERFORM SCR-PUTA                                         
               PERFORM SCR-EXIT.                                        
                                                                        
       CNT-PRO-CONF.                                                    
      *>>>>                                                           
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-SCP
               PERFORM EDT-FLD-SCP.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )

               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCP-GLS-MEN2
               MOVE SCR-CONF     TO SCP-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCP-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-SCP
               PERFORM VAL-NUM-FLD-SCP
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-SCP
                   PERFORM VAL-NUM-FLD-SCP
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.

      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD                
           IF FRM-FFLD = FRM-FFLD-PF3 AND                               
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.


       COPY TABBUSCP.
       COPY GNSBVNUM.
       COPY TABBFSGS.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBFTAB.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN


      *<<<<
       PGM-EBR-ALL SECTION.                                             
       INI-PGM-EBR-ALL.                                                 
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE FIO-EBR-ALL TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
       FIN-PGM-EBR-ALL.                                                 
           EXIT.                                                        
      *>>>>



      *<<<< EOF                                                         
       COPY GNSBGVSM.                                                   
       COPY GNSBHVSM.                                                   
      *PVG INI 11-ENE-2007 INTEGRACION CGN                              
       COPY GNSBVIND.                                                   
       COPY GNSBVIDC.                                                   
       COPY GNSBPVRF.                                                   
      *PVG FIN 11-ENE-2007                                              
                                                                        
       DEL-QUE-SCP SECTION.                                             
       INI-DEL-QUE-SCP.                                                 
           MOVE SCP-NOM-TSSCP TO QUE-COLA.                              
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNS-PRO-QUE.                                         
       FIN-DEL-QUE-SCP.                                                 
           EXIT.                                                        
                                                                        
       SCP-MOV-TS-FRM SECTION.                                          
       INI-SCP-MOV-TS-FRM.                                              
           IF SCR-OFRM-SRV                                              
               GO TO FIN-SCP-MOV-TS-FRM                                 
           ELSE                                                         
               IF WSS-IND-PANT > WSS-MAX-PANT                           
                   GO TO FIN-SCP-MOV-TS-FRM.                            
           PERFORM SCP-MOV-TS-FRM-ELM.                                  
      *     MOVE SCP-FLD01 TO                                           
      *                FLD01 IN SCP-FLD(WSS-IND-PANT).                  
           ADD 1 TO WSS-IND-PANT.                                       
       FIN-SCP-MOV-TS-FRM.                                              
           EXIT.                                                        
      *<<<< PGM_DTC AND EOF                                             
      *>>>>                                                             
      *<<<< EOF                                                         
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS                       
       ING-FPEN-CIC SECTION.                                            
       INI-ING-FPEN-CIC.                                                
           PERFORM ING-SETE.                                            
           MOVE SCR-MENS-EXT TO SCP-GLS-MENS.                           
           PERFORM HBL-IKY.                                             
      *PTC ini                                                          
           IF SCR-OFRM-SRV                                              
               EXEC CICS                                                
                  RETURN                                                
               END-EXEC.                                                
      *PTC fin                                                          
       FIN-ING-FPEN-CIC.                                                
           EXIT.                                                        
                                                                        
       ING-FTER-CIC SECTION.                                            
       INI-ING-FTER-CIC.                                                
           PERFORM ING-SETE.                                            
           MOVE SCR-MENS-EXT TO SCP-GLS-MENS.                           
           PERFORM HBL-IKY.                                             
       FIN-ING-FTER-CIC.                                                
           EXIT.                                                        
                                                                        
       ING-SETE SECTION.                                                
       INI-ING-SETE.                                                    
           PERFORM CRG-TBL-ENG.                                         
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.                         
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.                         
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.                         
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.                         
                                                                        
           MOVE WSS-NTRV(SCR-IPRO) TO SCR-NTRV.                         
           MOVE WSS-PROV(SCR-IPRO) TO SCR-PROV.                         
       FIN-ING-SETE.                                                    
           EXIT.                                                        
                                                                        
       EGR-FTER-CIC SECTION.                                            
       INI-EGR-FTER-CIC.                                                
           PERFORM CRG-TBL-ENG.                                         
           MOVE WSS-IDX-IOPC TO SCR-IPRO.                               
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.                      
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.                         
           MOVE 'ING' TO SCR-CMND.                                      
           MOVE 'ING' TO SCR-CCPP.                                      
           MOVE 'M'   TO SCR-STPP.                                      
                                                                        
           MOVE SCR-VARI TO SYS-CMMA.                                   
           MOVE SCR-TCMA TO SYS-TCMA.                                   
           MOVE SYS-XCTL TO SYS-CMND.                                   
      *PTC ini                                                          
           IF SCR-OFRM-SRV                                              
                MOVE WSS-IDX-ISCP TO SCR-IPRO                           
           ELSE                                                         
                PERFORM GNS-PRO-SYS.                                    
      *PTC fin                                                          
       FIN-EGR-FTER-CIC.                                                
           EXIT.                                                        
                                                                        
       SCR-INIT SECTION.                                                
       INI-SCR-INIT.                                                    
           MOVE 3  TO FRM-PLIN.                                         
           MOVE 19 TO FRM-NLIN.                                         
           MOVE FRM-CLR-FRM TO FRM-CMND.                                
           PERFORM GNS-PRO-FRM.                                         
           MOVE FRM-SINI-DBNF TO FRM-SINI.                              
           MOVE SCR-NMAP TO FRM-NAME.                                   
           MOVE SCR-NLIB TO FRM-NLIB.                                   
           MOVE SCP-FLD TO FRM-DFLD.                                    
           MOVE FRM-INI TO FRM-CMND.                                    
           PERFORM GNS-PRO-FRM.                                         
       FIN-SCR-INIT.                                                    
           EXIT.                                                        
       COPY COLBGMPT.                                                   
                                                                        
       PUT-TAB SECTION.                                                 
       INI-PUT-TAB.                                                     
       EXT-PUT-TAB.                                                     
           EXIT.                                                        
                                                                        
       SET-FRM-IFLD SECTION.                                            
       INI-SET-FRM-IFLD.                                                
           IF SCR-OFRM-SRV                                              
                MOVE 1 TO FRM-IFLD                                      
           ELSE                                                         
                ADD 1 TO FRM-IFLD.                                      
       FIN-SET-FRM-IFLD.                                                
           EXIT.                                                        
                                                                        
      * COPY LDCBKCCU.                                                  
                                                                        
       COPY GNSBBTAB.                                                   
      *>>>> EOF                                                         
      * DEL-QUE-SCP SECTION.                                            
      * INI-DEL-QUE-SCP.                                                
      *     MOVE SCP-NOM-TSSCP TO QUE-COLA.                             
      *     MOVE QUE-DEL TO QUE-CMND.                                   
      *     PERFORM GNS-PRO-QUE.                                        
      * FIN-DEL-QUE-SCP.                                                
      *     EXIT.                                                       
                                                                        
       SCP-PUT-SCR SECTION.                                             
       INI-SCP-PUT-SCR.                                                 
       FIN-SCP-PUT-SCR.                                                 
           EXIT.                                                        
                                                                        
       SCP-MOD-TS SECTION.                                              
       INI-SCP-MOD-TS.                                                  
           MOVE SCP-NOM-TSSCP  TO QUE-COLA.                             
           MOVE SCP-LEN-TSSCP  TO QUE-LITM.                             
           MOVE QUE-GET        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
               MOVE QUE-ITEM TO SCP-ITEM                                
               MOVE     FRM-IND-SELC IN SCP-FLD(WSS-ISCP) TO            
                    SCP-FRM-IND-SELC                                    
               MOVE     FRM-GLS-SELC IN SCP-FLD(WSS-ISCP) TO            
                    SCP-FRM-GLS-SELC                                    
               MOVE SCP-ITEM TO QUE-ITEM                                
               MOVE QUE-MOD TO QUE-CMND                                 
               PERFORM GNS-PRO-QUE                                      
               MOVE QUE-NITM TO WSS-ISCP-AUX                            
               ADD 1 TO QUE-NITM                                        
           ELSE                                                         
               ADD 1 TO WSS-MAX-PANT GIVING WSS-ISCP.                   
       FIN-SCP-MOD-TS.                                                  
           EXIT.                                                        
                                                                        
       SCP-PROC-ITEM SECTION.                                           
       INI-SCP-PROC-ITEM.                                               
           COMPUTE QUE-NITM = ( SCR-NUM-PANT - 1 ) * WSS-MAX-PANT + 1.  
                                                                        
           MOVE QUE-NITM TO WSS-ISCP.                                   
           PERFORM SCP-MOD-TS VARYING WSS-ISCP FROM 1 BY 1              
               UNTIL WSS-ISCP > WSS-MAX-PANT.                           
       FIN-SCP-PROC-ITEM.                                               
           EXIT.                                                        
                                                                        
      * SCP-MOV-TS-FRM SECTION.                                         
      * INI-SCP-MOV-TS-FRM.                                             
      *     IF SCR-OFRM-SRV                                             
      *         GO TO FIN-SCP-MOV-TS-FRM                                
      *     ELSE                                                        
      *         IF WSS-IND-PANT > WSS-MAX-PANT                          
      *             GO TO FIN-SCP-MOV-TS-FRM.                           
                                                                        
      *     PERFORM SCP-MOV-TS-FRM-ELM.                                 
      *     ADD 1 TO WSS-IND-PANT.                                      
      * FIN-SCP-MOV-TS-FRM.                                             
      *     EXIT.                                                       
                                                                        
       SCP-MOV-TS-FRM-ELM SECTION.                                      
       INI-SCP-MOV-TS-FRM-ELM.                                          
      *ISP-INI                                                          
           IF WSS-IND-PANT = 1                                          
               PERFORM CLR-PANT-SCP                                     
               PERFORM HBL-FLD.                                         
      *ISP-FIN                                                          
           MOVE SCP-FRM-IND-SELC TO                                     
                    FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT).              
           MOVE SCP-FRM-COD-TSEG TO                                     
                    FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT).              
           MOVE SCP-FRM-COD-OCOB TO                                     
                    FRM-COD-OCOB IN SCP-FLD(WSS-IND-PANT).              
           MOVE SCP-FRM-COD-SEGU TO                                     
                    FRM-COD-SEGU IN SCP-FLD(WSS-IND-PANT).              
           IF FRM-COD-CPTO IN SCP-FLD NOT = 'PPC'                       
           MOVE SCP-FRM-VAL-MNTO TO                                     
                    FRM-VAL-MNTO IN SCP-FLD(WSS-IND-PANT)               
           MOVE SCP-FRM-COD-VCOC TO                                     
                    FRM-COD-VCOC IN SCP-FLD(WSS-IND-PANT).              
                                                                        
           IF FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT) > SPACES            
               MOVE 'GNS' TO TAB-COD-SIST                               
               MOVE 'SON' TO TAB-COD-TTAB IN TAB                        
               MOVE FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT) TO            
                      TAB-COD-CTAB IN TAB                               
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-ABRV IN TAB TO                              
                              FRM-GLS-SELC IN SCP-FLD(WSS-IND-PANT)     
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(WSS-IND-PANT).    
                                                                        
           IF FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT) NOT > SPACES        
               MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(WSS-IND-PANT)     
               GO TO FIN-SCP-MOV-TS-FRM-ELM.                            
                                                                        
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS'                           
               MOVE 'TSE' TO TAB-COD-TTAB IN TAB.                       
           IF FRM-COD-CPTO IN SCP-FLD = 'INT' OR 'PPC'                  
              MOVE 'TDP' TO TAB-COD-TTAB IN TAB.                        
      *PVG INI 11-ENE-2007 INTEGRACION CGN                              
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'                           
              MOVE 'DOC' TO TAB-COD-TTAB IN TAB.                        
           IF FRM-COD-CPTO IN SCP-FLD = 'CCM'                           
              MOVE 'CMS' TO TAB-COD-TTAB IN TAB.                        
      *PVG FIN 11-ENE-2007                                              
           MOVE FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT) TO                
                TAB-COD-CTAB IN TAB.                                    
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DCOR IN TAB TO                                  
                FRM-GLS-TSEG IN SCP-FLD(WSS-IND-PANT).                  
       FIN-SCP-MOV-TS-FRM-ELM.                                          
           EXIT.                                                        
                                                                        
       PUT-TS-SCP SECTION.                                              
       INI-PUT-TS-SCP.                                                  
           MOVE SPACES TO SCP-ITEM.                                     
           MOVE ZEROES TO SCP-FRM-VAL-MNTO.                             
           IF SCR-OFRM-SRV                                              
               MOVE QSP-VAL-MNTO(WSS-S) TO FRM-VAL-MNTO-EDT             
               MOVE FRM-VAL-MNTO-EDT TO SCP-FRM-VAL-MNTO-ALF            
           ELSE                                                         
               MOVE QSP-VAL-MNTO(WSS-S) TO SCP-FRM-VAL-MNTO.            
                                                                        
           MOVE 'S'                 TO SCP-FRM-IND-SELC.                
           MOVE QSP-COD-TSEG(WSS-S) TO SCP-FRM-COD-TSEG.                
           MOVE QSP-COD-OCOB(WSS-S) TO SCP-FRM-COD-OCOB.                
           MOVE QSP-COD-SEGU(WSS-S) TO SCP-FRM-COD-SEGU.                
           MOVE QSP-COD-VCOC(WSS-S) TO SCP-FRM-COD-VCOC.                
                                                                        
           IF SCP-FRM-IND-SELC > SPACES                                 
               MOVE 'GNS' TO TAB-COD-SIST                               
               MOVE 'SON' TO TAB-COD-TTAB IN TAB                        
               MOVE SCP-FRM-IND-SELC TO TAB-COD-CTAB IN TAB             
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-ABRV IN TAB TO SCP-FRM-GLS-SELC             
           ELSE                                                         
               MOVE SPACES TO SCP-FRM-GLS-SELC.                         
                                                                        
           MOVE SCP-NOM-TSSCP  TO QUE-COLA.                             
           MOVE SCP-LEN-TSSCP  TO QUE-LITM.                             
           MOVE SCP-ITEM       TO QUE-ITEM.                             
           MOVE QUE-PUT        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
           ADD 1 TO SCR-TOT-OCCU.                                       
       FIN-PUT-TS-SCP.                                                  
           EXIT.                                                        
                                                                        
       CLR-PANT-SCP SECTION.                                            
       INI-CLR-PANT-SCP.                                                
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(1).                   
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(2).                   
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(3).                   
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(4).                   
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(5).                   
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(6).                   
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(7).                   
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(8).                   
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(9).                   
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(10).                  
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(1).                   
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(2).                   
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(3).                   
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(4).                   
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(5).                   
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(6).                   
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(7).                   
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(8).                   
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(9).                   
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(10).                  
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(1).                   
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(2).                   
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(3).                   
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(4).                   
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(5).                   
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(6).                   
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(7).                   
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(8).                   
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(9).                   
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(10).                  
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(1).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(2).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(3).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(4).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(5).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(6).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(7).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(8).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(9).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(10).                  
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(1).                   
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(2).                   
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(3).                   
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(4).                   
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(5).                   
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(6).                   
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(7).                   
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(8).                   
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(9).                   
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(10).                  
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(1).                   
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(2).                   
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(3).                   
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(4).                   
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(5).                   
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(6).                   
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(7).                   
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(8).                   
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(9).                   
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(10).                  
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(1).                   
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(2).                   
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(3).                   
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(4).                   
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(5).                   
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(6).                   
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(7).                   
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(8).                   
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(9).                   
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(10).                  
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(1).                   
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(2).                   
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(3).                   
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(4).                   
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(5).                   
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(6).                   
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(7).                   
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(8).                   
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(9).                   
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(10).                  
       FIN-CLR-PANT-SCP.                                                
           EXIT.                                                        
                                                                        
       PRO-ING-ROC SECTION.                                             
       INI-PRO-ING-ROC.                                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
           PERFORM LEE-QUE-SCP.                                         
           MOVE 1 TO WSS-I.                                             
       LUP-PRO-ING-ROC.                                                 
           IF QSP-VAL-MNTO(WSS-I) = ZEROES OR                           
              WSS-I > WSS-IMAX                                          
               GO TO FIN-PRO-ING-ROC.                                   
           IF QSP-IND-SELC(WSS-I) = 'S'                                 
               PERFORM GRA-ROC                                          
               IF MSG-COD-MENS > SPACES                                 
                  GO TO FIN-PRO-ING-ROC.                                
           ADD 1 TO WSS-I.                                              
           GO TO LUP-PRO-ING-ROC.                                       
       FIN-PRO-ING-ROC.                                                 
           EXIT.                                                        
                                                                        
       LEE-QUE-SCP SECTION.                                             
       INI-LEE-QUE-SCP.                                                 
           MOVE ZEROES TO WSS-R IN WSS-VARI.                            
       LUP-LEE-QUE-SCP.                                                 
           ADD 1 TO WSS-R.                                              
           MOVE WSS-R              TO QUE-NITM.                         
           MOVE SCP-NOM-TSSCP      TO QUE-COLA.                         
           MOVE SCP-LEN-TSSCP      TO QUE-LITM.                         
           MOVE QUE-GET            TO QUE-CMND.                         
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
              MOVE '00' TO FIO-STAT                                     
              MOVE QUE-ITEM         TO SCP-ITEM                         
              MOVE SCP-FRM-IND-SELC TO QSP-IND-SELC(WSS-R)              
              MOVE SCP-FRM-COD-TSEG TO QSP-COD-TSEG(WSS-R)              
              MOVE SCP-FRM-COD-OCOB TO QSP-COD-OCOB(WSS-R)              
              MOVE SCP-FRM-COD-SEGU TO QSP-COD-SEGU(WSS-R)              
              MOVE SCP-FRM-VAL-MNTO TO QSP-VAL-MNTO(WSS-R)              
              MOVE SCP-FRM-COD-VCOC TO QSP-COD-VCOC(WSS-R)              
              MOVE SCP-FRM-CIC-IRCC TO QSP-CIC-IRCC(WSS-R)              
              MOVE SCP-FRM-NUM-IRCC TO QSP-NUM-IRCC(WSS-R)              
              MOVE SCP-FRM-COD-MONE TO QSP-COD-MONE(WSS-R)              
              MOVE SCP-FRM-CIC-PLAN TO QSP-CIC-PLAN(WSS-R)              
              MOVE SCP-FRM-FEC-PLAN TO QSP-FEC-PLAN(WSS-R)              
              MOVE SCP-FRM-HRA-PLAN TO QSP-HRA-PLAN(WSS-R)              
              MOVE SCP-FRM-COD-TINT TO QSP-COD-TINT(WSS-R)              
              MOVE SCP-QSP-VAL-PPRO TO QSP-VAL-PPRO(WSS-R)              
                                                                        
              MOVE SCP-QSP-SGV-TAMO TO QSP-SGV-TAMO(WSS-R)              
              MOVE SCP-QSP-SGV-CSTF TO QSP-SGV-CSTF(WSS-R)              
              MOVE SCP-QSP-SGV-TMAX TO QSP-SGV-TMAX(WSS-R)              
              MOVE SCP-QSP-VAL-FRIE TO QSP-VAL-FRIE(WSS-R)              
              GO TO LUP-LEE-QUE-SCP.                                    
                                                                        
       FIN-LEE-QUE-SCP.                                                 
           EXIT.                                                        
                                                                        
       GRA-ROC SECTION.                                                 
       INI-GRA-ROC.                                                     
           PERFORM GET-FHOY.                                            
           PERFORM OBT-COR-ROC.                                         
           MOVE OPC-CAI-IOPC IN SCP-FLD TO ROC-CAI-IOPC IN ROC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO ROC-IIC-IOPC IN ROC.         
           MOVE ZEROES                  TO ROC-EXT-IOPC IN ROC.         
           MOVE FRM-COD-SIST IN SCP-FLD TO ROC-COD-SIST IN ROC.         
           MOVE FRM-COD-EVEN IN SCP-FLD TO ROC-COD-EVEN IN ROC.         
           MOVE WSS-NUM-IROC            TO ROC-NUM-IROC IN ROC.         
           MOVE HOY-STP-ITRN            TO ROC-STP-ITRN IN ROC.         
           MOVE QSP-IND-SELC(WSS-I)     TO ROC-MSC-STAT IN ROC.         
           MOVE SPACES                  TO ROC-COD-OTRN IN ROC.         
           MOVE 'TABPQSCP'              TO ROC-COD-ATRN IN ROC.         
           MOVE FRM-COD-CPTO IN SCP-FLD TO ROC-COD-CPTO IN ROC.         
           MOVE QSP-COD-SEGU(WSS-I)     TO ROC-COD-MODL IN ROC.         
           MOVE QSP-COD-OCOB(WSS-I)     TO ROC-COD-OCOB IN ROC.         
                                                                        
      *PVG INI 11-ENE-2007 INTEGRACION CGN                              
           IF (FRM-COD-CPTO IN SCP-FLD = 'SGS' OR 'CGN' OR 'CCM')       
      *    IF FRM-COD-CPTO IN SCP-FLD = 'SGS'                           
      *PVG FIN 11-ENE-2007                                              
               PERFORM MV-ROC-SGS                                       
           ELSE                                                         
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'                           
               PERFORM MV-ROC-INT                                       
           ELSE                                                         
           IF FRM-COD-CPTO IN SCP-FLD = 'PPC'                           
               PERFORM MV-ROC-PPC.                                      
                                                                        
           IF ROC-MSC-STAT IN ROC = 'S'                                 
               MOVE SPACES TO ROC-COD-ANUL IN ROC                       
           ELSE                                                         
               MOVE '02'   TO ROC-COD-ANUL IN ROC.                      
                                                                        
           MOVE SPACES     TO ROC-IDC-ADIC IN ROC.                      
           MOVE SPACES     TO ROC-VRF-ADIC IN ROC.                      
           MOVE ZEROES     TO ROC-FEC-FUNO IN ROC.                      
           MOVE ZEROES     TO ROC-FEC-FDOS IN ROC.                      
           MOVE SPACES     TO ROC-GLS-DISP IN ROC.                      
                                                                        
      *PVG INI 11-ENE-2007 INTEGRACION CGN                              
           MOVE 'RCC'                   TO ROC-GLS-ADIC IN ROC.         
           MOVE FRM-CAI-IRCC IN SCP-FLD TO ROC-IND-ADIC IN ROC.         
           MOVE FRM-IIC-IRCC IN SCP-FLD TO ROC-NUM-ADIC IN ROC.         
      *PVG FIN 11-ENE-2007                                              
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM TAB-FIO-ROC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'ROC    NOGRB' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-GRA-ROC.                                       
                                                                        
           IF FRM-COD-CPTO IN SCP-FLD = 'INT' AND                       
                  ROC-IND-TPLT IN ROC = 'P'                             
               PERFORM GRA-ITR.                                         
       FIN-GRA-ROC.                                                     
           EXIT.                                                        
                                                                        
       MV-ROC-SGS SECTION.                                              
       INI-MV-ROC-SGS.                                                  
           MOVE QSP-COD-TSEG(WSS-I)     TO ROC-COD-SCPT IN ROC.         
           MOVE QSP-VAL-MNTO(WSS-I)     TO ROC-SGV-TCAL IN ROC.         
           MOVE QSP-COD-MONE(WSS-I)     TO ROC-COD-VCOC IN ROC.         
                                                                        
           MOVE SPACES                  TO ROC-COD-TINT IN ROC.         
           MOVE ZEROES                  TO ROC-NUM-PREP IN ROC.         
           MOVE ZEROES                  TO ROC-SGV-TINF IN ROC.         
           MOVE ZEROES                  TO ROC-SGV-CFON IN ROC.         
      *PVG INI 11-ENE-2007 INTEGRACION CGN                              
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'                           
              MOVE QSP-SGV-CSTF(WSS-I)  TO ROC-SGV-CFON IN ROC          
              MOVE QSP-COD-TINT(WSS-I)  TO ROC-COD-TINT IN ROC          
              MOVE QSP-SGV-TAMO(WSS-I)  TO ROC-SGV-TINF IN ROC.         
      *PVG FIN 11-ENE-2007                                              
           MOVE ZEROES                  TO ROC-SGV-FRIE IN ROC.         
                                                                        
           MOVE FRM-CAI-PLAN IN SCP-FLD TO ROC-CAI-PLAN IN ROC.         
           MOVE FRM-IIC-PLAN IN SCP-FLD TO ROC-IIC-PLAN IN ROC.         
           MOVE FRM-IND-TPLT IN SCP-FLD TO ROC-IND-TPLT IN ROC.         
           MOVE FRM-FEC-PLAN IN SCP-FLD TO ROC-FEC-PLAN IN ROC.         
           MOVE FRM-HRA-PLAN IN SCP-FLD TO ROC-HRA-PLAN IN ROC.         
       FIN-MV-ROC-SGS.                                                  
           EXIT.                                                        
                                                                        
       MV-ROC-INT SECTION.                                              
       INI-MV-ROC-INT.                                                  
           MOVE SPACES              TO ROC-COD-SCPT IN ROC.             
           MOVE QSP-COD-MONE(WSS-I) TO ROC-COD-VCOC IN ROC.             
           MOVE QSP-CIC-PLAN(WSS-I) TO ROC-CIC-PLAN IN ROC.             
           MOVE QSP-COD-TSEG(WSS-I) TO ROC-IND-TPLT IN ROC.             
           MOVE QSP-FEC-PLAN(WSS-I) TO ROC-FEC-PLAN IN ROC.             
           MOVE QSP-HRA-PLAN(WSS-I) TO ROC-HRA-PLAN IN ROC.             
                                                                        
                                                                        
           MOVE QSP-VAL-PPRO(WSS-I) TO ROC-SGV-TCAL IN ROC.             
           MOVE QSP-COD-TINT(WSS-I) TO ROC-COD-TINT IN ROC.             
                                                                        
           MOVE QSP-SGV-TAMO(WSS-I) TO ROC-SGV-TINF IN ROC.             
                                                                        
           MOVE QSP-SGV-CSTF(WSS-I) TO ROC-SGV-CFON IN ROC.             
           MOVE QSP-VAL-FRIE(WSS-I) TO ROC-SGV-FRIE IN ROC.             
       FIN-MV-ROC-INT.                                                  
           EXIT.                                                        
                                                                        
       MV-ROC-PPC SECTION.                                              
       INI-MV-ROC-PPC.                                                  
           MOVE SPACES              TO ROC-COD-SCPT IN ROC.             
           MOVE QSP-COD-MONE(WSS-I) TO ROC-COD-VCOC IN ROC.             
           MOVE QSP-CIC-PLAN(WSS-I) TO ROC-CIC-PLAN IN ROC.             
           MOVE QSP-COD-TSEG(WSS-I) TO ROC-IND-TPLT IN ROC.             
           MOVE QSP-FEC-PLAN(WSS-I) TO ROC-FEC-PLAN IN ROC.             
           MOVE QSP-HRA-PLAN(WSS-I) TO ROC-HRA-PLAN IN ROC.             
                                                                        
           MOVE ZEROES              TO ROC-SGV-TCAL IN ROC.             
           MOVE SPACES              TO ROC-COD-TINT IN ROC.             
           MOVE ZEROES              TO ROC-NUM-PREP IN ROC.             
           MOVE ZEROES              TO ROC-SGV-TINF IN ROC.             
           MOVE ZEROES              TO ROC-SGV-CFON IN ROC.             
           MOVE ZEROES              TO ROC-SGV-FRIE IN ROC.             
       FIN-MV-ROC-PPC.                                                  
           EXIT.                                                        
                                                                        
       OBT-COR-ROC SECTION.                                             
       INI-OBT-COR-ROC.                                                 
           MOVE ZEROES TO WSS-NUM-IROC IN WSS-VARI.                     
           MOVE OPC-CAI-IOPC IN SCP-FLD TO ROC-CAI-IOPC IN ROC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO ROC-IIC-IOPC IN ROC.         
           MOVE ZEROES                  TO ROC-EXT-IOPC IN ROC.         
           MOVE FRM-COD-SIST IN SCP-FLD TO ROC-COD-SIST IN ROC.         
           MOVE FRM-COD-EVEN IN SCP-FLD TO ROC-COD-EVEN IN ROC.         
           MOVE 999 TO ROC-NUM-IROC IN ROC.                             
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM TAB-FIO-ROC.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               ROC-CAI-IOPC IN ROC = OPC-CAI-IOPC IN SCP-FLD AND        
               ROC-IIC-IOPC IN ROC = OPC-IIC-IOPC IN SCP-FLD AND        
               ROC-EXT-IOPC IN ROC = ZEROES AND                         
               ROC-COD-SIST IN ROC = FRM-COD-SIST IN SCP-FLD AND        
               ROC-COD-EVEN IN ROC = FRM-COD-EVEN IN SCP-FLD)           
               MOVE 1 TO WSS-NUM-IROC IN WSS-VARI                       
           ELSE                                                         
               MOVE ROC-NUM-IROC IN ROC TO WSS-NUM-IROC IN WSS-VARI     
               ADD 1 TO WSS-NUM-IROC IN WSS-VARI                        
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM TAB-FIO-ROC.                                     
       FIN-OBT-COR-ROC.                                                 
           EXIT.                                                        
                                                                        
       GRA-ITR SECTION.                                                 
       INI-GRA-ITR.                                                     
           PERFORM GET-CUR-ITR.                                         
           IF NOT FIO-STAT-OKS                                          
               PERFORM PUT-ITR                                          
               GO TO FIN-GRA-ITR.                                       
           MOVE FIO-GET-KEY-UPD TO FIO-CMND                             
           PERFORM COL-FIO-ITR                                          
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ITR    NOUPD' TO MSG-COD-MENS                      
               GO TO FIN-GRA-ITR.                                       
                                                                        
           IF QSP-COD-CVTI(WSS-I) > SPACES                              
               MOVE QSP-VAL-PPRO(WSS-I)  TO ITR-SGV-SPRD IN ITR         
               MOVE ZEROES               TO ITR-SGV-TINT IN ITR         
           ELSE                                                         
               MOVE QSP-VAL-PPRO(WSS-I)  TO ITR-SGV-TINT IN ITR.        
                                                                        
           MOVE QSP-COD-TINT(WSS-I)      TO ITR-COD-TINT IN ITR.        
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM COL-FIO-ITR.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ITR    NOMOD' TO MSG-COD-MENS                      
               GO TO FIN-GRA-ITR.                                       
       FIN-GRA-ITR.                                                     
           EXIT.                                                        
                                                                        
       PUT-ITR SECTION.                                                 
       INI-PUT-ITR.                                                     
           PERFORM INI-REG-ITR.                                         
           MOVE OPC-CAI-IOPC IN SCP-FLD  TO ITR-CAI-IOPC IN ITR.        
           MOVE OPC-IIC-IOPC IN SCP-FLD  TO ITR-IIC-IOPC IN ITR.        
           MOVE ZEROES                   TO ITR-NUM-ICAN IN ITR.        
           MOVE SPACES                   TO ITR-CIC-IOPV IN ITR.        
           MOVE ZEROES                   TO ITR-NUM-IVCT IN ITR.        
           MOVE 'INT'                    TO ITR-IND-TTAS IN ITR.        
           MOVE ZEROES                   TO ITR-FEC-FINI IN ITR.        
           IF QSP-COD-CVTI(WSS-I) > SPACES                              
               MOVE QSP-VAL-PPRO(WSS-I)  TO ITR-SGV-SPRD IN ITR         
               MOVE ZEROES               TO ITR-SGV-TINT IN ITR         
           ELSE                                                         
               MOVE ZEROES               TO ITR-SGV-SPRD IN ITR         
               MOVE QSP-VAL-PPRO(WSS-I)  TO ITR-SGV-TINT IN ITR.        
                                                                        
           MOVE QSP-COD-TINT(WSS-I)      TO ITR-COD-TINT IN ITR.        
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM COL-FIO-ITR.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ITR    NOGRB' TO MSG-COD-MENS.                     
       FIN-PUT-ITR.                                                     
           EXIT.                                                        
                                                                        
       INI-REG-ITR SECTION.                                             
       INI-INI-REG-ITR.                                                 
           MOVE SPACES   TO ITR-GLS-FLAG IN ITR.                        
           MOVE ZEROES   TO ITR-FEC-FTER IN ITR.                        
           MOVE ZEROES   TO ITR-SGV-SPRD IN ITR.                        
           MOVE ZEROES   TO ITR-SGV-MNTO IN ITR.                        
           MOVE SPACES   TO ITR-GLS-DISP IN ITR.                        
       FIN-INI-REG-ITR.                                                 
           EXIT.                                                        
                                                                        
       GET-CUR-ITR SECTION.                                             
       INI-GET-CUR-ITR.                                                 
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.                             
           MOVE OPC-CAI-IOPC IN SCP-FLD TO ITR-CAI-IOPC IN ITR.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO ITR-IIC-IOPC IN ITR.         
           MOVE ZEROES                  TO ITR-NUM-ICAN IN ITR.         
           MOVE SPACES                  TO ITR-CIC-IOPV IN ITR          
           MOVE ZEROES                  TO ITR-NUM-IVCT IN ITR          
           MOVE 'INT'                   TO ITR-IND-TTAS IN ITR.         
           MOVE ZEROES                  TO ITR-FEC-FINI IN ITR.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-ITR.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    ITR-CAI-IOPC IN ITR = OPC-CAI-IOPC IN SCP-FLD AND   
                    ITR-IIC-IOPC IN ITR = OPC-IIC-IOPC IN SCP-FLD AND   
                    ITR-NUM-ICAN IN ITR = ZEROES                  AND   
                    ITR-CIC-IOPV IN ITR = SPACES                  AND   
                    ITR-NUM-IVCT IN ITR = ZEROES                  AND   
                    ITR-IND-TTAS IN ITR = 'INT'  )                      
               MOVE '23' TO FIO-STAT.                                   
       FIN-GET-CUR-ITR.                                                 
           EXIT.                                                        
                                                                        
       VRF-TIP-SEG SECTION.                                             
       INI-VRF-TIP-SEG.                                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE SPACES TO WSS-IND-DUPL.                                 
           MOVE ZEROES TO WSS-L IN WSS-VARI.                            
           MOVE ZEROES TO WSS-K IN WSS-VARI.                            
           IF FRM-COD-CPTO IN SCP-FLD NOT = 'SGS'                       
               GO TO FIN-VRF-TIP-SEG.                                   
       LUP-VRF-TIP-SEG.                                                 
           ADD 1 TO WSS-L.                                              
           MOVE WSS-L              TO QUE-NITM.                         
           MOVE SCP-NOM-TSSCP      TO QUE-COLA.                         
           MOVE SCP-LEN-TSSCP      TO QUE-LITM.                         
           MOVE QUE-GET            TO QUE-CMND.                         
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT NOT = QUE-STAT-OKS                               
               GO TO FIN-VRF-TIP-SEG.                                   
                                                                        
           MOVE QUE-ITEM         TO SCP-ITEM.                           
           IF SCP-FRM-IND-SELC = 'N'                                    
               GO TO LUP-VRF-TIP-SEG.                                   
                                                                        
           PERFORM CHK-VEC-TSEG VARYING WSS-J FROM 1 BY 1 UNTIL         
             WSS-J > WSS-JMAX OR                                        
             (SCP-FRM-COD-TSEG = WSS-COD-TSEG(WSS-J) AND                
              SCP-FRM-IND-SELC = 'S')                                   
                                                                        
      * Encuentra                                                       
           IF WSS-J NOT > WSS-JMAX                                      
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'TSEG    DUPL' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE SCP-FRM-COD-TSEG TO FRM-MEN2                        
               MOVE 'S' TO WSS-IND-DUPL                                 
               GO TO FIN-VRF-TIP-SEG.                                   
                                                                        
      * No encuentra                                                    
           ADD 1 TO WSS-K.                                              
           IF WSS-K > WSS-KMAX                                          
               GO TO FIN-VRF-TIP-SEG.                                   
                                                                        
           MOVE SCP-FRM-COD-TSEG TO WSS-COD-TSEG(WSS-K).                
           MOVE SCP-FRM-IND-SELC TO WSS-IND-SELE(WSS-K).                
           GO TO LUP-VRF-TIP-SEG.                                       
                                                                        
       FIN-VRF-TIP-SEG.                                                 
           EXIT.                                                        
                                                                        
       CHK-VEC-TSEG SECTION.                                            
       INI-CHK-VEC-TSEG.                                                
       FIN-CHK-VEC-TSEG.                                                
           EXIT.                                                        
                                                                        
       HBL-KEY-SCP SECTION.                                             
       INI-HBL-KEY-SCP.                                                 
           MOVE SCR-INST-GKY TO SCR-INST.                               
           MOVE 'SEL' TO SCR-CMND.                                      
           MOVE 'ACC' TO SCR-CCPP.                                      
           MOVE 'M'   TO SCR-STPP.                                      
           MOVE '1' TO FRM-CPIM-AEY.                                    
           MOVE FRM-CPIM-AEY TO OPC-CAI-IOPC-ATR IN SCP-FLD.            
           MOVE FRM-CPIM-AEY TO OPC-IIC-IOPC-ATR IN SCP-FLD.            
                                                                        
                                                                        
           PERFORM SCR-CLRA-SCP.                                        
           MOVE +4 TO OPC-CAI-IOPC-LEN IN SCP-FLD.                      
           MOVE -1 TO FRM-COD-CPTO-LEN IN SCP-FLD.                      
           MOVE SCR-CAI-IOPC IN SCR-VARI TO OPC-CAI-IOPC IN SCP-FLD.    
           MOVE SCR-IIC-IOPC IN SCR-VARI TO OPC-IIC-IOPC IN SCP-FLD.    
      *ISP  7-FEB-1990 DEBE SER REEMPLAZADO POR VARIABLE                
      *     INHIBE MOVE FRM-CPSF TO FRM-CPIM-AEY                        
      *     MOVE '1' TO FRM-CPIM-AEY.                                   
      *     PERFORM HBL-FLD.                                            
                                                                        
           PERFORM EDT-KEY-SCP.                                         
           PERFORM EDT-FLD-SCP.                                         
                                                                        
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'                
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)      
               PERFORM SCR-INIT                                         
               PERFORM SCR-EXIT                                         
           ELSE                                                         
               PERFORM SCR-PUTA.                                        
                                                                        
       FIN-HBL-KEY-SCP.                                                 
           EXIT.                                                        
                                                                        
       ELI-ROC SECTION.                                                 
       INI-ELI-ROC.                                                     
           MOVE OPC-CAI-IOPC IN SCP-FLD TO ROC-CAI-IOPC IN ROC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO ROC-IIC-IOPC IN ROC.         
           MOVE ZEROES              TO ROC-EXT-IOPC IN ROC.             
           MOVE 'CRE'               TO ROC-COD-SIST IN ROC.             
           MOVE 'CUR'               TO ROC-COD-EVEN IN ROC.             
           MOVE ZEROES              TO ROC-NUM-IROC IN ROC.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-ELI-ROC.                                                     
           PERFORM TAB-FIO-ROC.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              ROC-CAI-IOPC IN ROC = OPC-CAI-IOPC IN SCP-FLD AND         
              ROC-IIC-IOPC IN ROC = OPC-IIC-IOPC IN SCP-FLD AND         
              ROC-EXT-IOPC IN ROC = ZEROES AND                          
              ROC-COD-SIST IN ROC = 'CRE' AND                           
              ROC-COD-EVEN IN ROC = 'CUR')                              
      *PVG INI 06-SEP-2006 (CONTINGENCIA)                               
              MOVE OPC-CAI-IOPC IN SCP-FLD TO ROC-CAI-IOPC IN ROC       
              MOVE OPC-IIC-IOPC IN SCP-FLD TO ROC-IIC-IOPC IN ROC       
      *PVG FIN 06-SEP-2006                                              
               GO TO FIN-ELI-ROC.                                       
                                                                        
           IF ROC-COD-CPTO IN ROC NOT = FRM-COD-CPTO IN SCP-FLD         
               MOVE FIO-GET-NXT TO FIO-CMND                             
               GO TO LUP-ELI-ROC.                                       
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM TAB-FIO-ROC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DEL TO FIO-CMND                                 
               PERFORM TAB-FIO-ROC                                      
               GO TO INI-ELI-ROC.                                       
       FIN-ELI-ROC.                                                     
           EXIT.                                                        
                                                                        
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBPFEC.                                                   
                                                                        
       COPY TABBFROC.                                                   
       COPY COLBFTOC.                                                   
       COPY COLBFOPC.                                                   
       COPY COLBFDLC.                                                   
       COPY COLBFRDC.                                                   
       COPY COLBFVEN.                                                   
       COPY COLBFEVC.                                                   
       COPY COLBFAUT.                                                   
       COPY COLBFITR.                                                   
       COPY SGCBFDBC.                                                   
       COPY COLBGUVD.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBVMSC.                                                   
       COPY GNSBFMSC.                                                   
       COPY TABBKRCC.                                                   
      *>>>>
