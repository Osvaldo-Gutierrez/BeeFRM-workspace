*% IF INI_DBC_GLS_ICLI
      *<<<<
           GO TO FIN-VAL-DBC-GLS-ICLI.                                  
      *>>>>
*% END
*% IF FIN_PUT_CAB_CAB
      *<<<<                                                             
           IF CAB-IND-SMWI IN CAB-FLD > SPACES                          
              MOVE 'TAB'  TO TAB-COD-SIST                               
              MOVE 'SWI'  TO TAB-COD-TTAB IN TAB                        
              MOVE CAB-IND-SMWI IN CAB-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SMWI IN CAB-FLD    
              ELSE                                                      
                 MOVE SPACES              TO FRM-GLS-SMWI IN CAB-FLD.   
                                                                        
           MOVE CAB-COD-METR IN CAB(01) TO FRM-COD-METR IN CAB-FLD(01). 
           MOVE CAB-NUM-METR IN CAB(01) TO FRM-NUM-METR IN CAB-FLD(01). 
           IF CAB-COD-METR IN CAB(01) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(01) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(01)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(01). 
                                                                        
           MOVE CAB-COD-METR IN CAB(02) TO FRM-COD-METR IN CAB-FLD(02). 
           MOVE CAB-NUM-METR IN CAB(02) TO FRM-NUM-METR IN CAB-FLD(02). 
           IF CAB-COD-METR IN CAB(02) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(02) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(02)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(02). 
                                                                        
           MOVE CAB-COD-METR IN CAB(03) TO FRM-COD-METR IN CAB-FLD(03). 
           MOVE CAB-NUM-METR IN CAB(03) TO FRM-NUM-METR IN CAB-FLD(03). 
           IF CAB-COD-METR IN CAB(03) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(03) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(03)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(03). 
                                                                        
           MOVE CAB-COD-METR IN CAB(04) TO FRM-COD-METR IN CAB-FLD(04). 
           MOVE CAB-NUM-METR IN CAB(04) TO FRM-NUM-METR IN CAB-FLD(04). 
           IF CAB-COD-METR IN CAB(04) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(04) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(04)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(04). 
                                                                        
           MOVE CAB-COD-METR IN CAB(05) TO FRM-COD-METR IN CAB-FLD(05). 
           MOVE CAB-NUM-METR IN CAB(05) TO FRM-NUM-METR IN CAB-FLD(05). 
           IF CAB-COD-METR IN CAB(05) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(05) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(05)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(05). 
                                                                        
           MOVE CAB-COD-METR IN CAB(06) TO FRM-COD-METR IN CAB-FLD(06). 
           MOVE CAB-NUM-METR IN CAB(06) TO FRM-NUM-METR IN CAB-FLD(06). 
           IF CAB-COD-METR IN CAB(06) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(06) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(06)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(06). 
                                                                        
           MOVE CAB-COD-METR IN CAB(07) TO FRM-COD-METR IN CAB-FLD(07). 
           MOVE CAB-NUM-METR IN CAB(07) TO FRM-NUM-METR IN CAB-FLD(07). 
           IF CAB-COD-METR IN CAB(07) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(07) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(07)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(07). 
                                                                        
           MOVE CAB-COD-METR IN CAB(08) TO FRM-COD-METR IN CAB-FLD(08). 
           MOVE CAB-NUM-METR IN CAB(08) TO FRM-NUM-METR IN CAB-FLD(08). 
           IF CAB-COD-METR IN CAB(08) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(08) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(08)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(08). 
                                                                        
           MOVE CAB-COD-METR IN CAB(09) TO FRM-COD-METR IN CAB-FLD(09). 
           MOVE CAB-NUM-METR IN CAB(09) TO FRM-NUM-METR IN CAB-FLD(09). 
           IF CAB-COD-METR IN CAB(09) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(09) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(09)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(09). 
                                                                        
           MOVE CAB-COD-METR IN CAB(10) TO FRM-COD-METR IN CAB-FLD(10). 
           MOVE CAB-NUM-METR IN CAB(10) TO FRM-NUM-METR IN CAB-FLD(10). 
           IF CAB-COD-METR IN CAB(10) > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'TDM'                   TO TAB-COD-TTAB IN TAB       
              MOVE CAB-COD-METR IN CAB(10) TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF MSG-COD-MENS NOT > SPACES                              
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TMET IN CAB-FLD(10)
              ELSE                                                      
                 MOVE SPACES            TO FRM-GLS-TMET IN CAB-FLD(10). 
      *>>>>                                                             
*% END
*% IF FIN_PUT_DBC_CAB
      *<<<<
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                        
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN CAB-FLD.         
      *>>>>
*% END
*% IF INI_FST_FLD_CAB
      *<<<<
           IF SCR-CMND = 'AEW'                                          
              MOVE -1 TO CAB-IND-SMWI-LEN IN CAB-FLD                    
              GO TO FIN-FST-FLD-CAB.                                    
      *>>>>
*% END
*% IF INI_CAB_NUM_ICAB
      *<<<<
           IF CAB-NUM-ICAB IN CAB-FLD NOT > ZEROES                      
              MOVE ZEROES TO CAB-NUM-ICAB IN CAB-FLD.                   
           IF (CAB-NUM-ICAB IN CAB-FLD NOT > ZEROES AND                 
               SCR-CMND NOT = 'ING')                                    
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-CAB-NUM-ICAB.                               
      *>>>>
*% END
*% IF FIN_CAB_IND_TIPO
      *<<<<
           IF CAB-IND-TIPO IN CAB-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-CAB-IND-TIPO.                               
           IF CAB-IND-TIPO IN CAB-FLD = 'A'                             
              MOVE 'ALTA        ' TO FRM-GLS-TIPO IN CAB-FLD            
           ELSE                                                         
           IF CAB-IND-TIPO IN CAB-FLD = 'B'                             
              MOVE 'BAJA        ' TO FRM-GLS-TIPO IN CAB-FLD            
           ELSE                                                         
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'TIPO   INV' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-CAB-IND-TIPO.                               
      *>>>>
*% END
*% IF FIN_CAB_IIC_CONV 
      *<<<<
           IF CAB-IIC-CONV IN CAB-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-CAB-IIC-CONV.                               
      *>>>>
*% END
*% IF FIN_CAB_CAI_CONV
      *<<<<
           IF CAB-CAI-CONV IN CAB-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-CAB-CAI-CONV.                               
      *>>>>
*% END
*% IF FIN_RET_CAB_CAB
      *<<<<
                                                                        
           MOVE FRM-COD-METR IN CAB-FLD(01) TO CAB-COD-METR IN CAB(01). 
           MOVE FRM-NUM-METR IN CAB-FLD(01) TO CAB-NUM-METR IN CAB(01). 
           MOVE FRM-COD-METR IN CAB-FLD(02) TO CAB-COD-METR IN CAB(02). 
           MOVE FRM-NUM-METR IN CAB-FLD(02) TO CAB-NUM-METR IN CAB(02). 
           MOVE FRM-COD-METR IN CAB-FLD(03) TO CAB-COD-METR IN CAB(03). 
           MOVE FRM-NUM-METR IN CAB-FLD(03) TO CAB-NUM-METR IN CAB(03). 
           MOVE FRM-COD-METR IN CAB-FLD(04) TO CAB-COD-METR IN CAB(04). 
           MOVE FRM-NUM-METR IN CAB-FLD(04) TO CAB-NUM-METR IN CAB(04). 
           MOVE FRM-COD-METR IN CAB-FLD(05) TO CAB-COD-METR IN CAB(05). 
           MOVE FRM-NUM-METR IN CAB-FLD(05) TO CAB-NUM-METR IN CAB(05). 
           MOVE FRM-COD-METR IN CAB-FLD(06) TO CAB-COD-METR IN CAB(06). 
           MOVE FRM-NUM-METR IN CAB-FLD(06) TO CAB-NUM-METR IN CAB(06). 
           MOVE FRM-COD-METR IN CAB-FLD(07) TO CAB-COD-METR IN CAB(07). 
           MOVE FRM-NUM-METR IN CAB-FLD(07) TO CAB-NUM-METR IN CAB(07). 
           MOVE FRM-COD-METR IN CAB-FLD(08) TO CAB-COD-METR IN CAB(08). 
           MOVE FRM-NUM-METR IN CAB-FLD(08) TO CAB-NUM-METR IN CAB(08). 
           MOVE FRM-COD-METR IN CAB-FLD(09) TO CAB-COD-METR IN CAB(09). 
           MOVE FRM-NUM-METR IN CAB-FLD(09) TO CAB-NUM-METR IN CAB(09). 
           MOVE FRM-COD-METR IN CAB-FLD(10) TO CAB-COD-METR IN CAB(10). 
           MOVE FRM-NUM-METR IN CAB-FLD(10) TO CAB-NUM-METR IN CAB(10). 
      *>>>>
*% END
*% IF FIN_CAB_IND_SMWI
      *<<<<                                                             
           IF CAB-IND-SMWI IN CAB-FLD NOT > SPACES                      
              MOVE 'P' TO CAB-IND-SMWI IN CAB-FLD.                      
                                                                        
           MOVE 'TAB'  TO TAB-COD-SIST.                                 
           MOVE 'SWI'  TO TAB-COD-TTAB IN TAB.                          
           MOVE CAB-IND-SMWI IN CAB-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT > SPACES                                 
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SMWI IN CAB-FLD       
           ELSE                                                         
              MOVE SPACES              TO FRM-GLS-SMWI IN CAB-FLD.      
      *>>>>                                                             
*% END
*% IF FIN_FRM_COD_METR
      *<<<<                                                             
           IF FRM-COD-METR IN CAB-FLD(FRM-IFLD) > SPACES                
              MOVE 'TAB'     TO TAB-COD-SIST                            
              MOVE 'TDM'     TO TAB-COD-TTAB IN TAB                     
              MOVE FRM-COD-METR IN CAB-FLD(FRM-IFLD)                    
                             TO TAB-COD-CTAB IN TAB                     
              PERFORM VAL-COD                                           
              IF MSG-COD-MENS NOT = 'COD    NEX'                        
                 MOVE TAB-GLS-DESC IN TAB TO                            
                                FRM-GLS-TMET IN CAB-FLD(FRM-IFLD)       
              ELSE                                                      
                 MOVE SPACES TO FRM-GLS-TMET IN CAB-FLD(FRM-IFLD).      
      *>>>>                                                             
*% END
*% IF FIN_FRM_NUM_METR
      *<<<<                                                             
           IF FRM-NUM-METR IN CAB-FLD(FRM-IFLD) NOT > ZEROES            
              MOVE ZEROES TO FRM-NUM-METR IN CAB-FLD(FRM-IFLD).         
                                                                        
           IF FRM-NUM-METR IN CAB-FLD(FRM-IFLD) NOT > ZEROES AND        
              FRM-COD-METR IN CAB-FLD(FRM-IFLD) > SPACES                
      *PVG INI 08-JUL-2005 (SUPRIME VALIDACION)                         
      *       PERFORM ERR-GLS                                           
      *PVG FIN 08-JUL-2005                                              
              GO TO FIN-VAL-FRM-NUM-METR.                               
                                                                        
           IF FRM-NUM-METR IN CAB-FLD(FRM-IFLD) > ZEROES AND            
              FRM-COD-METR IN CAB-FLD(FRM-IFLD) NOT > SPACES            
              MOVE 'TAB'       TO MSG-COD-SIST                          
              MOVE 'TDM   OBL' TO MSG-COD-MENS                          
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              MOVE FRM-IND-ERRO TO                                      
                   FRM-COD-METR-LEN IN CAB-FLD(FRM-IFLD)                
              MOVE 'S'          TO FRM-UCUR                             
              GO TO FIN-VAL-FRM-NUM-METR.                               
      *>>>>                                                             
*% END       
