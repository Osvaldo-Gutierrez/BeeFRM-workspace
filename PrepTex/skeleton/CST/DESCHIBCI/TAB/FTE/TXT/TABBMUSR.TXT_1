*%! Codigo adicional
*% IF SETTAG
*% VSNBQ = "06.06.06"
*% FNCBQ = "EJPOOL"
*% VSNBU = "06.06.06"
*% FNCBU = "EJPOOL"
*% END
*% IF FIN_PUT_ALL_USR
      *<<<< FIN_PUT_ALL_USR
      *BUS-TAB busca glosa de codigo en tabla
      *RRM-INI 7-APR-2000
           IF USR-COD-PTDT IN USR-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'JPD' TO TAB-COD-TTAB IN TAB
               MOVE USR-COD-PTDT IN USR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-PTDT IN USR-FLD.
      *RRM-FIN 7-APR-2000
           IF USR-COD-TTAB IN USR-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'USR' TO TAB-COD-TTAB IN TAB
               MOVE USR-COD-TTAB IN USR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TTAB IN USR-FLD.
           IF USR-COD-UBIC IN USR-FLD > SPACES
               MOVE USR-COD-UBIC IN USR-FLD TO USR-COD-UBIC IN USR
               IF USR-IND-UBIC IN USR = 'O'
                   MOVE USR-COD-OFIC IN USR TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-UBIC IN USR-FLD
               ELSE
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE 'UBI' TO TAB-COD-TTAB IN TAB
                   MOVE USR-COD-UBIC IN USR-FLD TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBIC IN USR-FLD.
           IF USR-COD-CUSR IN USR-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'CUS' TO TAB-COD-TTAB IN TAB
               MOVE USR-COD-CUSR IN USR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CUSR IN USR-FLD.
      *>>>>
*% END
*% IF INI_USR_COD_TTAB
      *<<<< INI_USR_COD_TTAB
      *VAL-COD Valida codigo de tabla
      *ISP-INI 26-11-2006 DIFF ASCII EBCDIC
           IF SCR-OFRM-SRV AND NOT PTC-TT-TAB-CMND = 'CUN'
      *       IF NOT USR-COD-TTAB IN USR-FLD > SPACES
      *          MOVE ZEROES TO USR-COD-TTAB IN USR-FLD
      *       END-IF
              GO TO FIN-VAL-USR-COD-TTAB.
      *>>>>
*% END
*% IF USR_COD_TTAB
      *<<<< USR_COD_TTAB
      *ISP-FIN 26-11-2006 DIFF ASCII EBCDIC
           IF USR-COD-TTAB IN USR-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'USR' TO TAB-COD-TTAB IN TAB
               MOVE USR-COD-TTAB IN USR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX' AND
                  USR-COD-TTAB IN USR-FLD > SPACES
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TTAB IN USR-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TTAB IN USR-FLD.
      *>>>>
*% END
*% IF INI_USR_COD_USER
      *<<<< INI_USR_COD_USER
      *ISP-INI 26-11-2006 DIFF ASCII EBCDIC
           IF SCR-OFRM-SRV AND NOT PTC-TT-TAB-CMND = 'CUN'
      *       IF NOT USR-COD-USER IN USR-FLD > SPACES
      *          MOVE ZEROES TO USR-COD-USER IN USR-FLD
      *       END-IF
              GO TO FIN-VAL-USR-COD-USER.
      *ISP-INI 26-11-2006 DIFF ASCII EBCDIC
      * ALD
      *     IF USR-COD-USER IN USR-FLD NOT > SPACES
      *         PERFORM ERR-KEY.
      *>>>>
*% END
*% IF USR_GLS_IUSR
      *<<<< USR_GLS_IUSR
      *PGV IF SCR-INST = SCR-INST-GFL OR
           IF USR-IND-IUSR IN USR-FLD     > SPACES OR
              USR-NUM-IUSR IN USR-FLD NOT = ZEROES OR
              USR-VRF-IUSR IN USR-FLD     > SPACES OR
              USR-GLS-IUSR IN USR-FLD     > SPACES
               MOVE USR-GLS-IUSR IN USR-FLD TO IDC-GLS-RUTV
               PERFORM VAL-GLS.
      *>>>>
*% END
*% IF USR_VRF_IUSR
      *<<<< USR_VRF_IUSR
      *PGV IF SCR-INST = SCR-INST-GFL OR
           IF USR-IND-IUSR IN USR-FLD     > SPACES OR
              USR-NUM-IUSR IN USR-FLD NOT = ZEROES OR
              USR-VRF-IUSR IN USR-FLD     > SPACES OR
              USR-GLS-IUSR IN USR-FLD     > SPACES
               MOVE USR-NUM-IUSR IN USR-FLD TO IDC-NUM-RUTV
               MOVE USR-VRF-IUSR IN USR-FLD TO IDC-VRF-RUTV
               PERFORM VAL-RUT
               IF MSG-COD-MENS = SPACES
                   MOVE IDC-NUM-RUTV TO USR-NUM-IUSR IN USR-FLD.
      *>>>>
*% END
*% IF USR_GLS_DESC
      *<<<< USR_GLS_DESC
           IF USR-GLS-DESC IN USR-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF USR_GLS_ABRV
      *<<<< USR_GLS_ABRV
           IF SCR-INST = SCR-INST-GFL AND
              USR-GLS-ABRV IN USR-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF USR_GLS_DCOR
      *<<<< USR_GLS_DCOR
           IF USR-GLS-DCOR IN USR-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF USR_IND_VIGE
      *<<<< USR_IND_VIGE
           MOVE 'GNS'  TO MSC-COD-SIST.
           MOVE 'VIGE' TO MSC-COD-TMSC IN MSC.
           MOVE USR-IND-VIGE IN USR-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF USR_COD_UBIC
      *<<<< USR_COD_UBIC
           MOVE USR-COD-UBIC IN USR-FLD TO USR-COD-UBIC IN USR.
           IF USR-IND-UBIC IN USR = 'O'
               GO TO OFI-VAL-USR-COD-UBIC.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'UBI' TO TAB-COD-TTAB IN TAB.
           MOVE USR-COD-UBIC IN USR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS IN MSG NOT = 'COD    NEX' AND
              USR-COD-UBIC IN USR-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBIC IN USR-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UBIC IN USR-FLD.
           GO TO FIN-VAL-USR-COD-UBIC.
       OFI-VAL-USR-COD-UBIC.
           MOVE USR-COD-OFIC IN USR TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-COD-OFIC IN OFI > SPACES
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-UBIC IN USR-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UBIC IN USR-FLD.
      *>>>>
*% END
*% IF USR_COD_CUSR
      *<<<< USR_COD_CUSR
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CUS' TO TAB-COD-TTAB IN TAB.
           MOVE USR-COD-CUSR IN USR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS IN MSG NOT = 'COD    NEX' AND
              USR-COD-CUSR IN USR-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CUSR IN USR-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CUSR IN USR-FLD.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_USR
      *<<<< INI_VAL_CON_IKY_USR
      *ISP-INI 26-11-2006 DIFF ASCII EBCDIC
           IF SCR-OFRM-SRV AND NOT PTC-TT-TAB-CMND = 'CUN'
              GO TO FIN-VAL-CON-IKY-USR.
      *ISP-INI 26-11-2006 DIFF ASCII EBCDIC
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_USR
      *<<<< INI_VAL_CON_KEY_USR
      *ISP-INI 26-11-2006 DIFF ASCII EBCDIC
           IF SCR-OFRM-SRV AND NOT PTC-TT-TAB-CMND = 'CUN'
              GO TO FIN-VAL-CON-KEY-USR.
      *ISP-INI 26-11-2006 DIFF ASCII EBCDIC
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_USR
      *<<<< FIN_VAL_CON_KEY_USR
           IF USR-COD-TTAB IN USR-FLD     > SPACES AND
              USR-COD-USER IN USR-FLD NOT > SPACES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
*% END
*% IF USR_COD_BNCA
      *<<<< USR_COD_BNCA
      *LRH ini 18-NOV-1994
           IF (SCR-CMND = 'ING' OR 'MOD' OR 'ACT') AND
              USR-COD-TTAB IN USR-FLD = 'EJC' AND
              USR-COD-BNCA IN USR-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-USR-COD-BNCA.
      *LRH fin 18-NOV-1994
      *>>>>
*% END
*% IF INI_VAL_MKY_USR
*% IF PGM_BU
      *<<<< INI_VAL_MKY_USR
           PERFORM VAL-USR-IND-IUSR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO USR-IND-IUSR-LEN IN USR-FLD
                GO TO FIN-VAL-MKY-USR.
           PERFORM VAL-USR-GLS-IUSR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO USR-GLS-IUSR-LEN IN USR-FLD
                GO TO FIN-VAL-MKY-USR.
           PERFORM VAL-USR-NUM-IUSR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO USR-NUM-IUSR-LEN IN USR-FLD
                GO TO FIN-VAL-MKY-USR.
           PERFORM VAL-USR-VRF-IUSR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO USR-VRF-IUSR-LEN IN USR-FLD
                GO TO FIN-VAL-MKY-USR.
           PERFORM VAL-USR-GLS-ABRV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO USR-GLS-ABRV-LEN IN USR-FLD
                GO TO FIN-VAL-MKY-USR.
      *>>>> INI_VAL_MKY_USR
*% END
*% END
*% IF USR_COD_REGL
      *<<<< USR_COD_REGL
      *LRH ini 18-NOV-1994
           IF (SCR-CMND = 'ING' OR 'MOD' OR 'ACT') AND
              USR-COD-TTAB IN USR-FLD = 'EJC' AND
              USR-COD-REGL IN USR-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-USR-COD-REGL.
      *LRH fin 18-NOV-1994
      *>>>>
*% END
*% IF USR_COD_PLAT
      *<<<< USR_COD_PLAT
      *LRH ini 18-NOV-1994
           IF (SCR-CMND = 'ING' OR 'MOD' OR 'ACT') AND
              USR-COD-TTAB IN USR-FLD = 'EJC' AND
              USR-COD-PLAT IN USR-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-USR-COD-PLAT.
      *LRH fin 18-NOV-1994
      *>>>>
*% END
*% IF USR_COD_PTDT
      *<<<< USR_COD_PTDT
      *RRM-INI 7-APR-2000
           IF USR-COD-PTDT IN USR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PTDT IN USR-FLD
               GO TO FIN-VAL-USR-COD-PTDT.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'JPD' TO TAB-COD-TTAB IN TAB.
           MOVE USR-COD-PTDT IN USR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              USR-COD-PTDT IN USR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PTDT IN USR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-PTDT IN USR-FLD.
      *RRM-FIN 7-APR-2000
      *>>>>
*% END
