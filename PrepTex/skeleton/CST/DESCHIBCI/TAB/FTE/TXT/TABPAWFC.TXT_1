*% PGM_PTC = TRUE
*% IF WSS
      *<<<< WSS                                                         
       COPY SGCBRDBC.                                                   
       COPY SGCBRDCE.                                                   
       COPY SGCBROPE.                                                   
       COPY SGCBRRCO.                                                   
       COPY GNSWGCPT.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.        
*% IF PGM_PQ
       COPY GNSBRCIC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.        
       COPY GNSWGCIC.                                                   
*% END
*% IF PGM_PU
       COPY TABBRMET.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MET-REQA==.        
       COPY GNSBRLGA.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LGA-REQA==.        
                                                                        
       01  WSS-VARI.                                                    
           03 WSS-COD-OBCS              VALUE SPACES    PIC X(03).      
           03 WSS-COD-OBCI              VALUE SPACES    PIC X(03).      
      *PVG INI 26-JUL-2005                                              
           03 WSS-COD-OEMP              VALUE SPACES    PIC X(03).      
      *PVG FIN 26-JUL-2005                                              
*% END                                                                        
      *>>>>                                                             
*% END
*% IF FIN_PGM_STAT
      *<<<<
              05 PGM-STAT-MET.                                          
                 88 PGM-STAT-MET-NUL    VALUE '  '.                     
                 07 PGM-STT1-MET        VALUE '2' PIC X(01).            
                    88 PGM-STAT-MET-OKS VALUE '0'.                      
                 07 PGM-STT2-MET        VALUE '3' PIC X(01).            
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY                                                 
            IF SCR-CCPP = 'ING'                                         
                IF WFC-FEC-FCNV IN WFC-FLD NOT > ZEROES                 
                    PERFORM GET-FHOY                                    
                    MOVE HOY-DHOY TO WFC-NUM-DCNV IN WFC-FLD            
                    MOVE HOY-MHOY TO WFC-NUM-MCNV IN WFC-FLD            
                    MOVE HOY-SHOY TO WFC-NUM-SCNV IN WFC-FLD            
                    MOVE HOY-AHOY TO WFC-NUM-ACNV IN WFC-FLD.           
                                                                        
            IF SCR-CCPP = 'ING'                                         
               IF WFC-HRA-CONV IN WFC-FLD NOT > ZEROES                  
                   PERFORM GET-FHOY                                     
                   MOVE HOY-HHOY TO WFC-HRA-CONV IN WFC-FLD.            
      *>>>>                                                             
*% END
*% IF FND_KEY
      *<<<< FND_KEY                                                     
            IF WFC-FEC-FCNV IN WFC-FLD NOT > ZEROES                     
               MOVE '99999999'   TO WFC-FEC-FCNV IN WFC.                
                                                                        
            IF WFC-HRA-CONV IN WFC-FLD NOT > ZEROES                     
               MOVE '999999'     TO WFC-HRA-CONV IN WFC.                
                                                                        
            MOVE FIO-GET-LEQ  TO FIO-CMND.                              
            PERFORM TAB-FIO-WFC.                                        
            IF NOT ( FIO-STAT-OKS AND                                   
                     WFC-CAI-CONV IN WFC = WFC-CAI-CONV IN WFC-FLD AND  
                     WFC-IIC-CONV IN WFC = WFC-IIC-CONV IN WFC-FLD )    
               MOVE '23' TO FIO-STAT PGM-STAT-WFC                       
               GO TO FIN-FND-KEY.                                       
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<<                                                             
           IF WFC-MSC-STAT IN WFC = 'J'                                 
              IF SCR-CMND NOT = 'CON' AND SCR-CMND NOT = 'IMT' AND      
                 SCR-CMND NOT = 'IAB' AND SCR-CMND NOT = 'AEW'          
                 MOVE 'CNV    APRYA' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
                                                                        
           GO TO FIN-FND-KEY.                                           
       SIG-FND-KEY.                                                     
           MOVE 'TAB'        TO MSG-COD-SIST.                           
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE '00'         TO FIO-STAT.                               
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           GO TO FIN-FND-KEY.                                           
      *>>>>                                                             
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD                                                 
            IF SCR-CMND = 'APR'                                         
               PERFORM PRO-FLD-WFC                                      
               MOVE FRM-CPIM-UBY TO WFC-FEC-FAPR-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IND-LOGA-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IND-ALGA-ATR IN WFC-FLD         
            ELSE                                                        
               MOVE FRM-CPIM-AEY TO WFC-FEC-FAPR-ATR IN WFC-FLD.        
                                                                        
            IF SCR-CMND = 'IMT'                                         
               PERFORM PRO-FLD-WFC                                      
               MOVE FRM-CPIM-UBY TO FRM-COD-TMET-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-NUM-METR-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IND-LOGA-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IND-ALGA-ATR IN WFC-FLD         
            ELSE                                                        
               MOVE FRM-CPIM-AEY TO FRM-COD-TMET-ATR IN WFC-FLD         
               MOVE FRM-CPIM-AEY TO FRM-NUM-METR-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IND-LOGA-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IND-ALGA-ATR IN WFC-FLD.        
                                                                        
            IF SCR-CMND = 'AEW'                                         
               PERFORM PRO-FLD-WFC                                      
               MOVE FRM-CPIM-UBY TO WFC-IND-SMWI-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IND-LOGA-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IND-ALGA-ATR IN WFC-FLD         
            ELSE                                                        
               MOVE FRM-CPIM-AEY TO WFC-IND-SMWI-ATR IN WFC-FLD.        
                                                                        
            IF SCR-CMND = 'IAB'                                         
               PERFORM PRO-FLD-WFC                                      
               MOVE FRM-CPIM-UBY TO FRM-IND-LOGA-ATR IN WFC-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IND-ALGA-ATR IN WFC-FLD.        
      *>>>>                                                             
*% END
*% IF EOF_PQ
      *<<<< EOF                                                         
       PGM-EBR-ALL SECTION.                                             
       INI-PGM-EBR-ALL.                                                 
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE FIO-EBR-ALL TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
       FIN-PGM-EBR-ALL.                                                 
           EXIT.                                                        

       COPY SGCBFDBC.                                                   
       COPY SGCBFDCE.                                                   
       COPY SGCBFOPE.                                                   
       COPY SGCBFRCO.                                                   
       COPY TABBBUSR.                                                   
       COPY GNSBGVSM.                                                   
       COPY GNSBGCPT.                                                   
      *>>>>                                                             
      *<<<< EOF_PQ                                                      
       PRO-FLD-WFC SECTION.                                             
       INI-PRO-FLD-WFC.                                                 
           MOVE FRM-CPIM-AEY TO FRM-COD-TMET-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO FRM-NUM-METR-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO FRM-IND-LOGA-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO FRM-IND-ALGA-ATR IN WFC-FLD.            
           PERFORM PRO-WFC-WFC.                                         
           PERFORM PRO-DBC-WFC.                                         
           PERFORM PRO-DCE-WFC.                                         
       FIN-PRO-FLD-WFC.                                                 
           EXIT.                                                        
                                                                        
       PRO-WFC-WFC SECTION.                                             
       INI-PRO-WFC-WFC.                                                 
           MOVE FRM-CPIM-AEY TO WFC-IND-SMWI-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-NUM-PAGR-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-OFCV-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-RAPR-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-CAPR-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-FEC-FAPR-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-GLS-NCEP-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-FEC-APRC-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-CCEP-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-GLS-FCEP-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-EBCS-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-SBCS-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-EBCI-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-SBCI-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-VAL-CFMN-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-CFMN-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-VAL-CVTE-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-CVTE-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-NUM-NTSM-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-CAI-CCCF-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-IIC-CCCF-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-EXT-CCCF-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-ACTC-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-PTRF-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-IND-IWFL-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-CNDP-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-IND-RBPR-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-RAUT-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO WFC-COD-TCTA-ATR IN WFC-FLD.            
       FIN-PRO-WFC-WFC.                                                 
           EXIT.                                                        
                                                                        
       PRO-DBC-WFC SECTION.                                             
       INI-PRO-DBC-WFC.                                                 
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )                
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN WFC-FLD.            
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN WFC-FLD.            
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )                
       FIN-PRO-DBC-WFC.                                                 
           EXIT.                                                        
                                                                        
       PRO-DCE-WFC SECTION.                                             
       INI-PRO-DCE-WFC.                                                 
                                                                        
       FIN-PRO-DCE-WFC.                                                 
           EXIT.                                                        
                                                                        
       COPY GNSBGCIC.                                                   
       COPY GNSBFCIC.                                                   
      *>>>>                                                             
*% END
*% IF FIN_CMN_MOD
      *<<<<
           IF NOT FIO-STAT-OKS                                          
              MOVE 'S' TO SCR-IERR.                                     
                                                                        
           MOVE FIO-STAT TO PGM-STAT-WFC.                               
           IF FIO-STAT-OKS AND FRM-IND-LOGA IN WFC-FLD = 'S'            
              MOVE FIO-MOD TO FIO-CMND                                  
              PERFORM TAB-PUT-ELGA.                                     
           MOVE PGM-STAT-WFC TO FIO-STAT .                              
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<<
           IF NOT FIO-STAT-OKS                                          
              MOVE 'S' TO SCR-IERR.                                     
                                                                        
           MOVE FIO-STAT TO PGM-STAT-WFC.                               
           IF FIO-STAT-OKS AND FRM-IND-LOGA IN WFC-FLD = 'S'            
              MOVE FIO-PUT TO FIO-CMND                                  
              PERFORM TAB-PUT-ELGA.                                     
           MOVE PGM-STAT-WFC TO FIO-STAT .                              
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC                                                     
            MOVE FIO-STAT TO PGM-STAT-WFC.                              
                                                                        
            IF SCR-CMND = 'AEW'                                         
               MOVE FIO-MOD TO FIO-CMND                                 
               PERFORM TAB-FIO-WFC                                      
               MOVE FIO-STAT TO PGM-STAT-WFC                            
               IF NOT FIO-STAT-OKS                                      
                  MOVE 'S'  TO SCR-IERR                                 
                  GO TO FIN-CMN-ACC.                                    
                                                                        
            IF SCR-CMND = 'IMT'                                         
               PERFORM ING-VAL-METR                                     
               MOVE PGM-STAT-MET TO FIO-STAT                            
               IF NOT FIO-STAT-OKS                                      
                  MOVE 'S'  TO SCR-IERR                                 
                  GO TO FIN-CMN-ACC.                                    
                                                                        
            IF SCR-CMND = 'APR'                                         
               MOVE 'J' TO WFC-MSC-STAT IN WFC WFC-MSC-STAT IN WFC-FLD  
               PERFORM LEE-MET-002                                      
               PERFORM RET-HDR-WFC                                      
               MOVE FIO-MOD TO FIO-CMND                                 
               PERFORM TAB-FIO-WFC                                      
               MOVE FIO-STAT TO PGM-STAT-WFC                            
               IF NOT FIO-STAT-OKS                                      
                  MOVE FIO-BCK-OUT TO FIO-CMND                          
                  PERFORM TAB-FIO-WFC                                   
                  MOVE 'S'  TO SCR-IERR                                 
                  GO TO FIN-CMN-ACC.                                    
                                                                        
            MOVE FIO-STAT TO PGM-STAT-WFC.                              
            IF FRM-IND-LOGA IN WFC-FLD = 'S'                            
               IF SCR-CMND = 'IMT' OR 'IAB'                             
                  MOVE FIO-PUT TO FIO-CMND                              
                  PERFORM TAB-PUT-ELGA                                  
               ELSE                                                     
                  MOVE FIO-MOD TO FIO-CMND                              
                  PERFORM TAB-PUT-ELGA.                                 
                                                                        
            MOVE PGM-STAT-WFC TO FIO-STAT.                              
            IF FIO-STAT-OKS                                             
               IF FRM-MEN1 NOT > SPACES                                 
                  MOVE 'INGYES    ' TO MSG-COD-MENS                     
                  MOVE 'GNS' TO MSG-COD-SIST                            
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MEN1                         
                ELSE                                                    
                  NEXT SENTENCE                                         
            ELSE                                                        
               IF FRM-MENS NOT > SPACES                                 
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG                       
                   MOVE FIO-STAT  TO MSG-COD-CMSG                       
                   MOVE 'GNS'     TO MSG-COD-SIST                       
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS.                       
      *>>>>                                                             
*% END
*% IF EOF_PU
      *<<<< EOF                                                         
       PGM-EBR-ALL SECTION.                                             
       INI-PGM-EBR-ALL.                                                 
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE FIO-EBR-ALL TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
       FIN-PGM-EBR-ALL.                                                 
           EXIT.                                                        

       COPY SGCBFDBC.                                                   
       COPY SGCBFDCE.                                                   
       COPY SGCBFOPE.                                                   
       COPY SGCBFRCO.                                                   
       COPY TABBBUSR.                                                   
       COPY TABBVUSR.                                                   
       COPY GNSBGVSM.                                                   
       COPY GNSBGCPT.                                                   
                                                                        
       ING-VAL-METR SECTION.                                            
       INI-ING-VAL-METR.                                                
           MOVE WFC-CAI-ICON IN WFC-FLD TO MET-CAI-CONV IN MET.         
           MOVE WFC-IIC-ICON IN WFC-FLD TO MET-IIC-CONV IN MET.         
           MOVE FRM-COD-TMET IN WFC-FLD TO MET-COD-TMET IN MET.         
           MOVE ZEROES                  TO MET-NUM-IMET IN MET.         
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM TAB-FIO-MET.                                         
           IF FIO-STAT-OKS                                              
              MOVE FIO-MOD TO FIO-CMND                                  
              MOVE 'ERR   MODMET' TO MSG-COD-MENS                       
           ELSE                                                         
              MOVE FIO-PUT TO FIO-CMND                                  
              MOVE 'ERR   PUTMET' TO MSG-COD-MENS.                      
                                                                        
           MOVE SPACES                  TO MET-GLS-FLAG IN MET.         
           MOVE WFC-CAI-ICON IN WFC-FLD TO MET-CAI-CONV IN MET.         
           MOVE WFC-IIC-ICON IN WFC-FLD TO MET-IIC-CONV IN MET.         
           MOVE FRM-COD-TMET IN WFC-FLD TO MET-COD-TMET IN MET.         
           MOVE ZEROES                  TO MET-NUM-IMET IN MET.         
           IF FIO-STAT-OKS                                              
               MOVE 'M'                 TO MET-MSC-TACC IN MET          
               MOVE 'M'                 TO MET-MSC-STAT IN MET          
           ELSE                                                         
               MOVE 'I'                 TO MET-MSC-TACC IN MET          
               MOVE 'I'                 TO MET-MSC-STAT IN MET.         
                                                                        
           PERFORM GET-FHOY.                                            
           MOVE HOY-FHOY                TO MET-FEC-FTRN IN MET.         
           MOVE HOY-HHOY                TO MET-HRA-HRTR IN MET.         
           MOVE SCR-OTRN                TO MET-COD-OTRN IN MET.         
           MOVE SCR-USER                TO MET-COD-ATRN IN MET.         
                                                                        
           MOVE FRM-NUM-METR IN WFC-FLD TO MET-VAL-CFMN IN MET.         
           MOVE SPACES                  TO MET-GLS-DISP IN MET.         
           PERFORM TAB-FIO-MET.                                         
           MOVE FIO-STAT TO PGM-STAT-MET.                               
           IF FIO-STAT-OKS                                              
              MOVE SPACES   TO MSG-COD-MENS.                            
                                                                        
       MSG-ING-VAL-METR.                                                
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'TAB'        TO MSG-COD-SIST                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MEN2                             
              MOVE PGM-STAT-MET TO PGM-STAT-WFC.                        
       FIN-ING-VAL-METR.                                                
           EXIT.                                                        
                                                                        
       LEE-MET-002 SECTION.                                             
       INI-LEE-MET-002.                                                 
           MOVE WFC-CAI-ICON IN WFC-FLD TO MET-CAI-CONV IN MET.         
           MOVE WFC-IIC-ICON IN WFC-FLD TO MET-IIC-CONV IN MET.         
           MOVE 'TDM002'                TO MET-COD-TMET IN MET.         
           MOVE ZEROES                  TO MET-NUM-IMET IN MET.         
           MOVE FIO-GET-KEY             TO FIO-CMND.                    
           PERFORM TAB-FIO-MET.                                         
           IF NOT FIO-STAT-OKS                                          
             MOVE 'C'   TO WFC-IND-SMWI IN WFC-FLD WFC-IND-SMWI IN WFC  
           ELSE                                                         
             IF MET-VAL-CFMN IN MET > ZEROES                            
               MOVE 'I' TO WFC-IND-SMWI IN WFC-FLD WFC-IND-SMWI IN WFC  
             ELSE                                                       
               MOVE 'C' TO WFC-IND-SMWI IN WFC-FLD WFC-IND-SMWI IN WFC. 
       FIN-LEE-MET-002.                                                 
           EXIT.                                                        
       COPY TABBFMET.                                                   
                                                                        
       COPY TABBGLGA.                                                   
       COPY GNSBFLGA.                                                   
      *>>>>                                                             
*% END
*% IF FIN_CMN_ELI
      *<<<<
           IF NOT FIO-STAT-OKS                                          
              MOVE 'S' TO SCR-IERR.                                     
                                                                        
           MOVE FIO-STAT TO PGM-STAT-WFC.                               
           IF FIO-STAT-OKS AND FRM-IND-LOGA IN WFC-FLD = 'S'            
              MOVE FIO-DEL TO FIO-CMND                                  
              PERFORM TAB-PUT-ELGA.                                     
           MOVE PGM-STAT-WFC TO FIO-STAT .                              
      *>>>>
*% END
