*%! Codigo adicional
*% IF FIN_PUT_PTI_PTI
      *<<<< FIN_PUT_PTI_PTI
           MOVE 'TAB'               TO TAB-COD-SIST FIO-SIST.           
           MOVE 'TVA'               TO TAB-CIC-TTAB IN TAB.             
           MOVE PTI-COD-TVAL IN PTI TO TAB-CIC-CTAB IN TAB.             
           MOVE 'TAB-CIC-TABL'      TO FIO-AKEY.                        
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-COD-CTAB IN TAB TO PTI-COD-TVAL IN PTI-FLD.         
                                                                        
           MOVE CIN-MSC-STAT IN CIN TO PTI-IND-VIGE IN PTI-FLD.
      *>>>>
*% END
*% IF FIN_KEY_PTI_PTI
      *<<<< FIN_KEY_PTI_PTI
           MOVE PTI-COD-TVAL IN PTI-FLD TO PTI-COD-TVAL IN PTI.         
           MOVE PTI-VAL-MNTO IN PTI-FLD TO PTI-VAL-MNTO IN PTI.         
           MOVE PTI-NUM-PLZO IN PTI-FLD TO PTI-NUM-PLZO IN PTI.         
           MOVE 'TAB'                   TO TAB-COD-SIST FIO-SIST.       
           MOVE 'TVA'                   TO TAB-COD-TTAB IN TAB.         
           MOVE PTI-COD-TVAL IN PTI-FLD TO TAB-COD-CTAB IN TAB.         
           MOVE FIO-GET-KEY             TO FIO-CMND.                    
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-CIC-CTAB IN TAB     TO PTI-COD-TVAL IN PTI.         
      *>>>>
*% END
*% IF FIN_CLR_KEY_PTI
      *<<<< FIN_CLR_KEY_PTI
           MOVE SPACES TO PTI-COD-TVAL IN PTI-FLD.                      
           MOVE ZEROES TO PTI-VAL-MNTO IN PTI-FLD.                      
           MOVE ZEROES TO PTI-NUM-PLZO IN PTI-FLD.                      
           MOVE SPACES TO FRM-IND-TELI IN PTI-FLD.                      
      *>>>>
*% END
*% IF FIN_PRO_IKY_PTI
      *<<<< FIN_PRO_IKY_PTI
           MOVE FRM-CPIM-AEY TO PTI-COD-TVAL-ATR IN PTI-FLD.            
           MOVE FRM-CPIM-AEY TO PTI-VAL-MNTO-ATR IN PTI-FLD.            
           MOVE FRM-CPIM-AEY TO PTI-NUM-PLZO-ATR IN PTI-FLD.
      *>>>>
*% END
*% IF FIN_UNP_IKY_PTI
      *<<<< FIN_UNP_IKY_PTI
           MOVE FRM-CPIM-UBY TO PTI-COD-TVAL-ATR.                       
           MOVE FRM-CPIM-UBY TO PTI-VAL-MNTO-ATR.                       
           MOVE FRM-CPIM-UBY TO PTI-NUM-PLZO-ATR.                       
      *>>>>
*% END
*% IF FIN_VAL_IKY_PTI
      *<<<< FIN_VAL_IKY_PTI
           PERFORM VAL-PTI-COD-TVAL.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO PTI-COD-TVAL-LEN IN PTI-FLD        
                GO TO FIN-VAL-IKY-PTI.                                  
           PERFORM VAL-PTI-VAL-MNTO.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO PTI-VAL-MNTO-LEN IN PTI-FLD        
                GO TO FIN-VAL-IKY-PTI.                                  
           PERFORM VAL-PTI-NUM-PLZO.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO PTI-NUM-PLZO-LEN IN PTI-FLD        
                GO TO FIN-VAL-IKY-PTI.                                  
           PERFORM VAL-FRM-IND-TELI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-IND-TELI-LEN IN PTI-FLD        
                GO TO FIN-VAL-IKY-PTI.                                  
      *>>>>
*% END
*% IF INI_PTI_IIC_IPTI
      *<<<< INI_PTI_IIC_IPTI
           IF PTI-IIC-IPTI IN PTI-FLD = ZEROES                          
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-PTI-IIC-IPTI.                             
      *>>>>
*% END
*% IF FIN_EDT_IKY_PTI
      *<<<< FIN_EDT_IKY_PTI
           IF PTI-VAL-MNTO-LEN IN PTI-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO PTI-VAL-MNTO-LEN IN PTI-FLD        
                GO TO FIN-EDT-IKY-PTI.                                  
           MOVE PTI-VAL-MNTO IN PTI-FLD TO PTI-VAL-MNTO-EDT IN PTI-EDT. 
           MOVE PTI-VAL-MNTO-EDT IN PTI-EDT TO                          
                PTI-VAL-MNTO-ALF IN PTI-FLD.                            
           IF PTI-NUM-PLZO-LEN IN PTI-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO PTI-NUM-PLZO-LEN IN PTI-FLD        
                GO TO FIN-EDT-IKY-PTI.                                  
           MOVE PTI-NUM-PLZO IN PTI-FLD TO PTI-NUM-PLZO-EDT IN PTI-EDT. 
           MOVE PTI-NUM-PLZO-EDT IN PTI-EDT TO                          
                PTI-NUM-PLZO-ALF IN PTI-FLD.                            
      *>>>>
*% END
*% IF EOF_IBM  AND  PGM_BQ
      *<<<< EOF_BQ
       VAL-PTI-COD-TVAL SECTION.                                        
       INI-VAL-PTI-COD-TVAL.                                            
           IF PTI-COD-TVAL IN PTI-FLD NOT > SPACES                      
              MOVE SPACES TO PTI-COD-TVAL IN PTI-FLD.                   
           IF PTI-COD-TVAL IN PTI-FLD NOT > SPACES                      
              MOVE 'TAS'  TO PTI-COD-TVAL IN PTI-FLD.                   
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'TVA'                   TO TAB-COD-TTAB IN TAB.         
           MOVE PTI-COD-TVAL IN PTI-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
              MOVE SPACES       TO FRM-GLS-TVAL IN PTI-FLD              
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR.                            
                                                                        
           IF TAB-CIC-CTAB IN TAB = 'X02' OR 'X03' OR 'X05' OR 'X06'    
               MOVE WSS-VAL-MNTO-MAX TO PTI-VAL-MNTO IN PTI-FLD.        
                                                                        
           IF TAB-CIC-CTAB IN TAB = 'X04' OR 'X07'                      
               MOVE WSS-NUM-PLZO-MAX TO PTI-NUM-PLZO IN PTI-FLD.        
       FIN-VAL-PTI-COD-TVAL.                                            
           EXIT.                                                        
                                                                        
       VAL-PTI-VAL-MNTO SECTION.                                        
       INI-VAL-PTI-VAL-MNTO.                                            
           IF PTI-VAL-MNTO IN PTI-FLD NOT > ZEROES                      
              MOVE 1 TO PTI-VAL-MNTO IN PTI-FLD.                        
       FIN-VAL-PTI-VAL-MNTO.                                            
           EXIT.                                                        
      *>>>>
*% END
