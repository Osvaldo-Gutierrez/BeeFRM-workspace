*% PGM_PTC = TRUE
*% GNSTCA_ORIG = 600
*% GNSTCA = 600
*% IF WSS  AND  PGM_PQ
      *<<<< WSS
       01  WSS-VARI.                                                    
           03 WSS-COD-CAUX.                                             
              05 WSS-COD-TOOC                           PIC X(03).      
              05 WSS-COD-AOOC                           PIC X(03).      
           03 WSS-COD-EVEN.                                             
              05 WSS-COD-SIST                           PIC X(03).      
              05 WSS-COD-EVTO                           PIC X(03).      
           03 WSS-COD-PLAN.                                             
              05 WSS-CAI-PLAN                           PIC X(04).      
              05 WSS-IIC-PLAN                           PIC X(08).      
*% END
*% IF WSS  AND  PGM_PU
      *<<<< WSS
       COPY COLBROPC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
       COPY COLBRITR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.        
       COPY COLBRVEN.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.        
       COPY TABBRSGS.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SGS-REQA==.        
       COPY TABBRCIN.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIN-REQA==.        
      *PVG INI 23-NOV-2004 PRECIOS-PPC                                  
       COPY TABBRPPC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PPC-REQA==.        
      *PVG FIN 23-NOV-2004 PRECIOS-PPC                                  
       COPY TABBRUSR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.        
      *PVG INI 25-SEP-2006 (INTEGRACION CGN)                            
       COPY MC2BRCGN.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CGN-REQA==.        
       COPY MC2BRCCM.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCM-REQA==.        
      *PVG FIN 25-SEP-2006                                              
      *PVG INI 27-NOV-2006 (INTEGRACION A CNC)                          
       COPY TABBRAGD.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AGD-REQA==.        
       COPY MC2BRCVN.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CVN-REQA==.        
      *PVG FIN 27-NOV-2006 (INTEGRACION A CNC)                          
                                                                        
       01  WSS-VARI.                                                    
           03 WSS-COD-CAUX.                                             
              05 WSS-COD-TOOC                           PIC X(03).      
              05 WSS-COD-AOOC                           PIC X(03).      
           03 WSS-COD-EVEN.                                             
              05 WSS-COD-SIST                           PIC X(03).      
              05 WSS-COD-EVTO                           PIC X(03).      
           03 WSS-COD-PLAN.                                             
              05 WSS-CAI-PLAN                           PIC X(04).      
              05 WSS-IIC-PLAN                           PIC X(08).      
           03 WSS-FEC-PLAN.                                             
              05 WSS-NUM-SLAN                           PIC 9(02).      
              05 WSS-NUM-ALAN                           PIC 9(02).      
              05 WSS-NUM-MLAN                           PIC 9(02).      
              05 WSS-NUM-DLAN                           PIC 9(02).      
           03 WSS-COD-VCAM.                                             
              05 WSS-COD-TVTI                           PIC X(01).      
              05 WSS-COD-CVTI                           PIC X(03).      
              05 WSS-COD-TCTI                           PIC X(02).      
*% END
*% IF WSS   AND  PGM_PQ
      *<<<< WSS
       COPY GNSWV3CR.                                                   
           03  SCR-VARI-PFS.                                            
               05  SCR-KEY-IROC-ACTU.                                   
                   07 SCR-ROC-CIC-IOPC PIC X(16).                       
                   07 SCR-ROC-COD-SIST PIC X(03).                       
                   07 SCR-ROC-COD-EVEN PIC X(03).                       
                   07 SCR-ROC-NUM-IROC PIC 9(03).                       

           02 SCR-NUM-IROC                 PIC 9(03).                   

       COPY COLMXW05.

       COPY COLWXCMB.                                                   
       COPY GNSWGCPT.                                                   
       COPY GNSWGSTR.                                                   

       01 WSS-I                 PIC 9(02).                              
       01 WSS-N                 PIC 9(02).                              
       01 WSS-NUM-CCUR.                                                 
           03 WSS-NUM-ICUR-EDT  PIC  ZZ9.                               
           03 WSS-NUM-ICUR-ALF  PIC X(03).                              
           03 WSS-NUM-ICUR      REDEFINES                               
              WSS-NUM-ICUR-ALF  PIC 9(03).                              
       01 WSS-IND-EXCT          PIC X(01).                              
                                                                        
       COPY COLBROPC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
       COPY TABBRUSR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.        
       COPY TABBRCIN.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIN-REQA==.        
      *PVG INI 23-NOV-2004 PRECIOS-PPC                                  
       COPY TABBRPPC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PPC-REQA==.        
      *PVG FIN 23-NOV-2004 PRECIOS-PPC                                  
      *PVG INI 25-SEP-2006 INTEGRACION A CGN-CCM                        
       COPY MC2BRCGN.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CGN-REQA==.        
       COPY MC2BRCCM.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCM-REQA==.        
      *PVG FIN 25-SEP-2006                                              
      *>>>>
*% END
*% IF FIN_PGM_STAT
      *<<<< FIN_PGM_STAT
              05 PGM-STAT-RCO.                                          
                 88 PGM-STAT-RCO-NUL    VALUE '  '.                     
                 07 PGM-STT1-RCO        VALUE '2' PIC X(01).            
                    88 PGM-STAT-RCO-OKS VALUE '0'.                      
                 07 PGM-STT2-RCO        VALUE '3' PIC X(01).            
      *>>>>
*% END
*% IF FIN_INI
      *<<<<  FIN_INI
      *PTC-INI                                                          
           PERFORM GNS-ERR-QUE.                                         
           PERFORM GET-TSK-TERM.                                        
      *PTC-FIN                                                          
      *>>>>
*% END
*% IF FIN_PUT_SCR
      *<<<<  FIN_PUT_SCR
           IF PGM-STAT-ROC-OKS                                          
               MOVE ROC-KEY-IROC IN ROC TO SCR-KEY-IROC-ACTU.           
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<<  FIN_CMN_MOD
           MOVE FIO-STAT TO PGM-STAT-ROC.                               

           IF FIO-STAT-OKS AND SCR-CMND = 'ANL'                         
               MOVE 'GNS'        TO MSG-COD-SIST                        
               MOVE 'ANLYES    ' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS.                           
                                                                        
           IF PGM-STAT-ROC-OKS                                          
              MOVE ROC-CAI-IOPC IN ROC TO OPC-CAI-IOPC IN OPC           
              MOVE ROC-IIC-IOPC IN ROC TO OPC-IIC-IOPC IN OPC           
              MOVE FIO-GET-KEY-UPD TO FIO-CMND                          
              PERFORM COL-FIO-OPC                                       
              IF FIO-STAT-OKS                                           
                 IF OPC-MSC-STAT IN OPC = 'M' OR 'A'                    
                    MOVE FIO-ULK-REC TO FIO-CMND                        
                    PERFORM COL-FIO-OPC                                 
                 ELSE                                                   
                    MOVE 'M' TO OPC-MSC-STAT IN OPC                     
                    MOVE FIO-MOD TO FIO-CMND                            
                    PERFORM COL-FIO-OPC                                 
              ELSE                                                      
                 MOVE 'TAB'          TO MSG-COD-SIST                    
                 MOVE 'ERRMOD   OPC' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS.                         
           MOVE PGM-STAT-ROC TO FIO-STAT.                               
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           MOVE FIO-STAT TO PGM-STAT-ROC.                               
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-CMN-ING.                                        
                                                                        
           IF SCR-OFRM-SRV AND                                          
              ROC-MSC-BCTI IN ROC-FLD > SPACES AND                      
              ROC-MSC-PBTI IN ROC-FLD > SPACES AND                      
              ROC-MSC-BPBT IN ROC-FLD > SPACES AND                      
              ROC-MSC-SPBT IN ROC-FLD > SPACES                          
      *PVG INI 04-JUN-2009                                              
      *       PERFORM ACT-ITR.                                          
              MOVE SPACES TO MSG-COD-MENS                               
              PERFORM ACT-ITR                                           
              IF MSG-COD-MENS > SPACES                                  
                 MOVE FIO-STAT TO PGM-STAT-ROC                          
                 MOVE 'TAB'    TO MSG-COD-SIST                          
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE PGM-STAT-ROC TO FIO-STAT                          
                 GO TO FIN-CMN-ING.                                     
      *PVG FIN 04-JUN-2009                                              
      *PVG INI 27-NOV-2006 (INTEGRACION A CNC)                          
      *PVG INI 04-JUN-2009                                              
           MOVE SPACES TO MSG-COD-MENS.                                 
      *PVG FIN 04-JUN-2009                                              
           PERFORM ANL-CNC-ROC.                                         
      *PVG INI 04-JUN-2009                                              
      *    IF NOT FIO-STAT-OKS                                          
      *       GO TO FIN-CMN-ING.                                        
      *PVG FIN 27-NOV-2006 (INTEGRACION A CNC)                          
           IF MSG-COD-MENS > SPACES                                     
              MOVE FIO-STAT TO PGM-STAT-ROC                             
              MOVE 'TAB'    TO MSG-COD-SIST                             
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE PGM-STAT-ROC TO FIO-STAT                             
              GO TO FIN-CMN-ING.                                        
                                                                        
           MOVE PGM-STAT-ROC TO FIO-STAT.                               
      *PVG FIN 04-JUN-2009                                              
           IF NOT SCR-OFRM-SRV                                          
                 MOVE ROC-CAI-IOPC IN ROC TO OPC-CAI-IOPC IN OPC        
                 MOVE ROC-IIC-IOPC IN ROC TO OPC-IIC-IOPC IN OPC        
                 MOVE FIO-GET-KEY-UPD TO FIO-CMND                       
                 PERFORM COL-FIO-OPC                                    
                 IF FIO-STAT-OKS                                        
                    IF OPC-MSC-STAT IN OPC = 'M'                        
                       MOVE FIO-ULK-REC TO FIO-CMND                     
                       PERFORM COL-FIO-OPC                              
                    ELSE                                                
                       MOVE 'M' TO OPC-MSC-STAT IN OPC                  
                       MOVE FIO-MOD TO FIO-CMND                         
                       PERFORM COL-FIO-OPC                              
                 ELSE                                                   
                    MOVE 'TAB'          TO MSG-COD-SIST                 
                    MOVE 'ERRMOD   OPC' TO MSG-COD-MENS                 
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC TO FRM-MENS.                      
                                                                        
      *PVG INI 31-MAY-2005                                              
           IF SCR-OFRM-SRV                                              
              MOVE ROC-CAI-IOPC IN ROC TO OPC-CAI-IOPC IN OPC           
              MOVE ROC-IIC-IOPC IN ROC TO OPC-IIC-IOPC IN OPC           
              MOVE FIO-GET-KEY-UPD TO FIO-CMND                          
              PERFORM COL-FIO-OPC                                       
              IF FIO-STAT-OKS                                           
                 IF OPC-MSC-STAT IN OPC = 'I' OR 'A'                    
                    MOVE FIO-ULK-REC TO FIO-CMND                        
                    PERFORM COL-FIO-OPC                                 
                 ELSE                                                   
                    MOVE 'I'     TO OPC-MSC-STAT IN OPC                 
                    MOVE FIO-MOD TO FIO-CMND                            
                    PERFORM COL-FIO-OPC                                 
              ELSE                                                      
                 MOVE 'TAB'          TO MSG-COD-SIST                    
                 MOVE 'ERRMOD   OPC' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS.                         
      *PVG FIN 31-MAY-2005                                              
                                                                        
           MOVE PGM-STAT-ROC TO FIO-STAT.                               
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC                                                     
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM VAL-NUM-KEY-ROC                                  
               PERFORM VAL-NUM-FLD-ROC                                  
               PERFORM SCRL-TAB-ROC                                     
               PERFORM SCR-TRL.                                         
      *>>>>                                                             
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *VALIDA ESTADO OPC                                                
           IF ROC-COD-SIST IN ROC-FLD = 'COL' OR 'CRE'                  
           MOVE ROC-CAI-IOPC IN ROC-FLD TO OPC-CAI-IOPC IN OPC          
           MOVE ROC-IIC-IOPC IN ROC-FLD TO OPC-IIC-IOPC IN OPC          
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM COL-FIO-OPC                                          
           IF NOT FIO-STAT-OKS                                          
              MOVE 'COL'        TO MSG-COD-SIST                         
              MOVE 'OPC    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE '00'         TO FIO-STAT                             
              MOVE SCR-STAT-CON TO SCR-STAT                             
              GO TO FIN-FND-KEY.                                        
                                                                        
           IF OPC-MSC-STAT IN OPC = 'A'                                 
              IF SCR-CMND = 'ING' OR 'MOD' OR 'ELI'                     
                 MOVE 'OPC    ACAYA' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
                                                                        
           MOVE ROC-NUM-IROC IN ROC-FLD TO SCR-NUM-IROC.                
           IF SCR-CCPP = 'ING'                                          
               MOVE 'S' TO ROC-IND-VIGE IN ROC-FLD                      
               PERFORM BUS-COR-ROC                                      
               GO TO CON-FND-KEY.                                       
           IF ROC-NUM-IROC IN ROC NOT > ZEROES                          
               PERFORM BUS-COR-ROC.                                     
       CON-FND-KEY.                                                     
           IF MSG-COD-MENS > SPACES                                     
              MOVE '23' TO FIO-STAT                                     
              GO TO FIN-FND-KEY.                                        

      *>>>>                                                             
*% END
*% IF CMN_ACC
      *<<<< FIN_CMN_ACC
           IF SCR-CMND = 'ANL'                                          
               MOVE 'N' TO ROC-IND-VIGE IN ROC                          
               MOVE FIO-MOD TO FIO-CMND                                 
               PERFORM TAB-FIO-ROC                                      
               IF NOT FIO-STAT-OKS                                      
                  MOVE 'S' TO SCR-IERR                                  
                  MOVE 'TAB' TO MSG-COD-SIST                            
                  MOVE 'ANLNOT    ' TO MSG-COD-MENS                     
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
               ELSE                                                     
                  MOVE 'ANLYES    ' TO MSG-COD-MENS                     
                  MOVE 'GNS' TO MSG-COD-SIST                            
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MEN1.                        
      *>>>>                                                             
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           MOVE FIO-STAT TO PGM-STAT-ROC.                               
      *PVG INI 04-JUN-2009                                              
      *    IF PGM-STAT-ROC-OKS                                          
           IF PGM-STAT-ROC-OKS AND ROC-COD-SIST IN ROC-FLD = 'CRE'      
      *PVG FIN 04-JUN-2009                                              
              MOVE ROC-CAI-IOPC IN ROC TO OPC-CAI-IOPC IN OPC           
              MOVE ROC-IIC-IOPC IN ROC TO OPC-IIC-IOPC IN OPC           
              MOVE FIO-GET-KEY-UPD TO FIO-CMND                          
              PERFORM COL-FIO-OPC                                       
              IF FIO-STAT-OKS                                           
                 IF OPC-MSC-STAT IN OPC = 'M'                           
                    MOVE FIO-ULK-REC TO FIO-CMND                        
                    PERFORM COL-FIO-OPC                                 
                 ELSE                                                   
                    MOVE 'M' TO OPC-MSC-STAT IN OPC                     
                    MOVE FIO-MOD TO FIO-CMND                            
                    PERFORM COL-FIO-OPC                                 
              ELSE                                                      
                 MOVE 'TAB'          TO MSG-COD-SIST                    
                 MOVE 'ERRMOD   OPC' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS.                         
           MOVE PGM-STAT-ROC TO FIO-STAT.                               
      *>>>>                                                             
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI

      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS                                          
              IF SCR-CMND = 'CON' OR 'MOD' OR 'ANL'                     
                 MOVE 'ROC    NEX' TO MSG-COD-MENS                      
                 GO TO SIG-FND-KEY.                                     
           IF SCR-CMND = 'ANL' AND ROC-IND-VIGE IN ROC = 'N'            
               MOVE 'ROC    YAANL' TO MSG-COD-MENS                      
               GO TO SIG-FND-KEY.                                       
                                                                        
           IF SCR-CMND = 'ANL' AND ROC-COD-CPTO IN ROC = 'INT'          
               MOVE 'ANLCPTINTINV' TO MSG-COD-MENS                      
               GO TO SIG-FND-KEY.                                       
                                                                        
           IF SCR-CMND = 'ELI' AND ROC-IND-VIGE IN ROC = 'N'            
               MOVE 'ROCANL NOELI' TO MSG-COD-MENS                      
               GO TO SIG-FND-KEY.                                       
                                                                        
           IF OPC-MSC-STAT IN OPC = 'A' AND SCR-CMND = 'ANL'            
              IF ROC-COD-OCOB IN ROC = 'FLT'                            
                 MOVE 'ANLFLT   INV' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
      
           PERFORM SGC-FIO-RCO.                                         
           MOVE FIO-STAT TO PGM-STAT-RCO.                               
       EXI-FND-KEY.                                                     
           PERFORM PUT-TAB.                                             
                                                                        
           MOVE '00' TO FIO-STAT.                                       
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           GO TO FIN-FND-KEY.                                           
      *----------------------------------------------------------       
       MSG-FND-KEY.                                                     
           MOVE 'TAB' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE '00' TO FIO-STAT.                                       
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           GO TO FIN-FND-KEY.                                           
                                                             
           IF FIO-STAT = FIO-STAT-NEX                                   
               MOVE 'S' TO SCR-IERR.                                    
       EXT-FND-KEY.                                                     
      *>>>>                                                             
*% END
*% IF ERR_SCR_GKEY
      *<<<< ERR_SCR_GKEY
           MOVE 'S' TO SCR-IERR.                                    
      *>>>>                                                             
*% END
*% IF ERR_SCR_GIKY
      *<<<< ERR_SCR_GIKY
           MOVE 'S' TO SCR-IERR.                                    
      *>>>>                                                             
*% END
*% IF PFS_GET_CON  AND  PGM_PQ
      *<<<< PFS_GET_CON                                                 
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 )                           
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 )                           
      *>>>>                                                             
*% END
*% IF INI_PRO_CONF
      *<<<< INI_PRO_CONF    
      *PTC-INI                                                          
           IF SCR-OFRM-SRV AND                                          
              SCR-CONF NOT > SPACES                                     
                MOVE SPACES TO FRM-MENS.                                
      *PTC-FIN                                                          
      *>>>>                                                             
*% END
*% IF EOF  AND  PGM_PQ
      *<<<< EOF	     
       COPY GNSBG3CF.
      *PTC-INI                                                          
       COPY GNSBGQUE.                                                   
       COPY GNSBGTSK.                                                   
      *PTC-FIN                                                          
       COPY GNSBGVSM.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBVCOD.                                                   
       COPY GNSBBTAB.                                                   
       COPY TABBBUSR.                                                   
       COPY TABBFUSR.                                                   
                                                                        
       COPY COLBFOPC.                                                   
       COPY TABBFCIN.                                                   
      *PVG INI 23-NOV-2004 PRECIOS-PPC                                  
       COPY TABBFPPC.                                                   
      *PVG FIN 23-NOV-2004 PRECIOS-PPC                                  
      *>>>>                                                             
       BUS-COR-ROC SECTION.                                             
       INI-BUS-COR-ROC.                                                 
           MOVE 999         TO ROC-NUM-IROC IN ROC.                     
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM TAB-FIO-ROC.                                         
           MOVE FIO-STAT TO PGM-STAT-ROC.                               
           IF NOT ( FIO-STAT-OKS AND                                    
               ROC-CAI-IOPC IN ROC-FLD  = ROC-CAI-IOPC IN ROC AND       
               ROC-IIC-IOPC IN ROC-FLD  = ROC-IIC-IOPC IN ROC AND       
               ROC-COD-SIST IN ROC-FLD  = ROC-COD-SIST IN ROC AND       
               ROC-COD-EVEN IN ROC-FLD  = ROC-COD-EVEN IN ROC )         
               PERFORM KEY-ALL-ROC                                      
               MOVE ZEROES TO ROC-NUM-IROC IN ROC                       
           ELSE                                                         
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM TAB-FIO-ROC.                                     
                                                                        
           IF SCR-CCPP = 'ING'                                          
               ADD 1 TO ROC-NUM-IROC IN ROC                             
               MOVE ROC-NUM-IROC IN ROC TO ROC-NUM-IROC IN ROC-FLD.     
                                                                        
       FIN-BUS-COR-ROC.                                                 
           EXIT.                                                        
                                                                        
       SCRL-TAB-ROC SECTION.                                            
       INI-SCRL-TAB-ROC.                                                
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF5                   
               PERFORM SCRL-TAB-ROC-PF7                                 
               GO TO FIN-SCRL-TAB-ROC.                                  
           IF FRM-FFLD = FRM-FFLD-PF8  OR FRM-FFLD-PF6                  
               PERFORM SCRL-TAB-ROC-PF8                                 
               GO TO FIN-SCRL-TAB-ROC.                                  
       FIN-SCRL-TAB-ROC.                                                
           EXIT.                                                        
                                                                        
       SCRL-TAB-ROC-PF7 SECTION.                                        
       INI-SCRL-TAB-ROC-PF7.                                            
           MOVE SCR-KEY-IROC-ACTU TO ROC-KEY-IROC IN ROC.               
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM TAB-FIO-ROC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    ROC-KEY-IROC IN ROC = SCR-KEY-IROC-ACTU)            
      *        ROC-KEY-IROC IN ROC = SCR-KEY-IROC-ACTU )                
               MOVE 'TABCURRNEX' TO MSG-COD-MENS                        
               GO TO MSG-SCRL-TAB-ROC-PF7.                              
       PRV-SCRL-TAB-ROC-PF8.                                            
           MOVE FIO-GET-PRV TO FIO-CMND.                                
           PERFORM TAB-FIO-ROC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    ROC-CIC-IOPC IN ROC = SCR-ROC-CIC-IOPC AND          
                    ROC-COD-SIST IN ROC = SCR-ROC-COD-SIST AND          
                    ROC-COD-EVEN IN ROC = SCR-ROC-COD-EVEN )            
               MOVE 'TAB    NOPRV' TO MSG-COD-MENS                      
               GO TO MSG-SCRL-TAB-ROC-PF7.                              
           MOVE FIO-STAT TO PGM-STAT-ROC.                               
           PERFORM SCR-CLRA-ROC.                                        
           PERFORM PUT-SCR.                                             
           GO TO FIN-SCRL-TAB-ROC-PF7.                                  
       MSG-SCRL-TAB-ROC-PF7.                                            
           MOVE 'TAB' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MEN2.                               
       FIN-SCRL-TAB-ROC-PF7.                                            
           EXIT.                                                        
                                                                        
       SCRL-TAB-ROC-PF8 SECTION.                                        
       INI-SCRL-TAB-ROC-PF8.                                            
           MOVE SCR-KEY-IROC-ACTU TO ROC-KEY-IROC IN ROC.               
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM TAB-FIO-ROC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    ROC-KEY-IROC IN ROC = SCR-KEY-IROC-ACTU)            
               MOVE 'TABCURRNEX' TO MSG-COD-MENS                        
               GO TO MSG-SCRL-TAB-ROC-PF8.                              
       NXT-SCRL-TAB-ROC-PF8.                                            
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM TAB-FIO-ROC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    ROC-CIC-IOPC IN ROC = SCR-ROC-CIC-IOPC AND          
                    ROC-COD-SIST IN ROC = SCR-ROC-COD-SIST AND          
                    ROC-COD-EVEN IN ROC = SCR-ROC-COD-EVEN )            
               MOVE 'TAB    NONXT' TO MSG-COD-MENS                      
               GO TO MSG-SCRL-TAB-ROC-PF8.                              
           MOVE FIO-STAT TO PGM-STAT-ROC.                               
           PERFORM SCR-CLRA-ROC.                                        
           PERFORM PUT-SCR.                                             
           GO TO FIN-SCRL-TAB-ROC-PF8.                                  
       MSG-SCRL-TAB-ROC-PF8.                                            
           MOVE 'TAB' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MEN2.                               
       FIN-SCRL-TAB-ROC-PF8.                                            
           EXIT.                                                        
                                                                        
      *PVG INI 25-SEP-2006 INTEGRACION A CGN-CCM                                
       COPY MC2BFCGN.                                                           
       COPY MC2BFCCM.                                                           
      *PVG FIN 25-SEP-2006       
*% END
*% IF EOF  AND  PGM_PU
      *<<<< EOF
       OBT-FVEN SECTION.                                                
       INI-OBT-FVEN.                                                    
           MOVE ROC-CAI-IOPC IN ROC-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE ROC-IIC-IOPC IN ROC-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC                                          
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ROC    OPCNEX' TO MSG-COD-MENS                     
               GO TO FIN-OBT-FVEN.                                      
                                                                        
           MOVE OPC-CAI-IOPC IN OPC TO VEN-CAI-IOPC IN VEN.             
           MOVE OPC-IIC-IOPC IN OPC TO VEN-IIC-IOPC IN VEN.             
           IF OPC-IND-VSTR IN OPC = 'S'                                 
               MOVE 1 TO VEN-NUM-IVEN IN VEN                            
           ELSE                                                         
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-VEN.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'OPC    VENNEX' TO MSG-COD-MENS                     
               GO TO FIN-OBT-FVEN.                                      
                                                                        
       FIN-OBT-FVEN.                                                    
           EXIT.                                                        
                                                                        
       ACT-ITR SECTION.                                                 
       INI-ACT-ITR.                                                     
      *PVG INI 12-DIC-2007                                              
      *    IF NOT ( ROC-COD-CPTO IN ROC-FLD = 'INT' OR                  
           IF NOT ( ROC-COD-CPTO IN ROC-FLD = 'INT' AND                 
      *PVG FIN 12-DIC-2007                                              
                    ROC-IND-TPLT IN ROC-FLD = 'P' )                     
              GO TO FIN-ACT-ITR.                                        
      *PVG INI 28-JUL-2005 (GRABACION CIC-RCC)                          
           IF ROC-IND-VIGE IN ROC-FLD NOT = 'S'                         
              GO TO FIN-ACT-ITR.                                        
      *PVG FIN 28-JUL-2005                                              
                                                                        
           PERFORM GET-CUR-ITR.                                         
           IF NOT FIO-STAT-OKS                                          
               PERFORM PUT-ITR                                          
               GO TO FIN-ACT-ITR.                                       
           MOVE FIO-GET-KEY-UPD TO FIO-CMND                             
           PERFORM COL-FIO-ITR                                          
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ITR    NOUPD' TO MSG-COD-MENS                      
               GO TO FIN-ACT-ITR.                                       
                                                                        
           IF ROC-COD-CVTI IN ROC > SPACES                              
               MOVE ROC-SGV-TCAL IN ROC-FLD TO ITR-SGV-SPRD IN ITR      
               MOVE ZEROES              TO ITR-SGV-TINT IN ITR          
           ELSE                                                         
               MOVE ZEROES              TO ITR-SGV-SPRD IN ITR          
               MOVE ROC-SGV-TCAL IN ROC-FLD TO ITR-SGV-TINT IN ITR.     
                                                                        
           MOVE ROC-MSC-BCTI IN ROC-FLD TO ITR-MSC-BCTI IN ITR.         
           MOVE ROC-MSC-PBTI IN ROC-FLD TO ITR-MSC-PBTI IN ITR.         
           MOVE ROC-MSC-BPBT IN ROC-FLD TO ITR-MSC-BPBT IN ITR.         
           MOVE ROC-MSC-SPBT IN ROC-FLD TO ITR-MSC-SPBT IN ITR.         
           MOVE ROC-COD-CVTI IN ROC-FLD TO ITR-COD-CVTI IN ITR.         
           MOVE ROC-MSC-TFPR IN ROC-FLD TO ITR-MSC-TFPR IN ITR.         
           MOVE ROC-NUM-PREP IN ROC-FLD TO ITR-NUM-PREP IN ITR.         
           MOVE ROC-MSC-UTPR IN ROC-FLD TO ITR-MSC-UTPR IN ITR.         
                                                                        
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM COL-FIO-ITR.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ITR    NOMOD' TO MSG-COD-MENS                      
               GO TO FIN-ACT-ITR.                                       
       FIN-ACT-ITR.                                                     
           EXIT.                                                        
                                                                        
       GET-CUR-ITR SECTION.                                             
       INI-GET-CUR-ITR.                                                 
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.                             
           MOVE ROC-CAI-IOPC IN ROC-FLD TO ITR-CAI-IOPC IN ITR.         
           MOVE ROC-IIC-IOPC IN ROC-FLD TO ITR-IIC-IOPC IN ITR.         
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.             
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR              
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR              
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.             
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-ITR.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    ITR-CAI-IOPC IN ITR = ROC-CAI-IOPC IN ROC-FLD AND   
                    ITR-IIC-IOPC IN ITR = ROC-IIC-IOPC IN ROC-FLD AND   
                    ITR-NUM-ICAN IN ITR = ZEROES              AND       
                    ITR-CIC-IOPV IN ITR = SPACES              AND       
                    ITR-NUM-IVCT IN ITR = ZEROES              AND       
                    ITR-IND-TTAS IN ITR = 'INT'  )                      
               MOVE '23' TO FIO-STAT.                                   
       FIN-GET-CUR-ITR.                                                 
           EXIT.                                                        
                                                                        
       PUT-ITR SECTION.                                                 
       INI-PUT-ITR.                                                     
           PERFORM INI-REG-ITR.                                         
           MOVE ROC-CAI-IOPC IN ROC-FLD TO ITR-CAI-IOPC IN ITR.         
           MOVE ROC-IIC-IOPC IN ROC-FLD TO ITR-IIC-IOPC IN ITR.         
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.             
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR.             
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR.             
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.             
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.             
           IF ROC-COD-CVTI IN ROC-FLD > SPACES                          
               MOVE ROC-SGV-TCAL IN ROC-FLD TO ITR-SGV-SPRD IN ITR      
               MOVE ZEROES              TO ITR-SGV-TINT IN ITR          
           ELSE                                                         
               MOVE ZEROES              TO ITR-SGV-SPRD IN ITR          
               MOVE ROC-SGV-TCAL IN ROC-FLD TO ITR-SGV-TINT IN ITR.     
                                                                        
           MOVE ROC-MSC-BCTI IN ROC-FLD TO ITR-MSC-BCTI IN ITR.         
           MOVE ROC-MSC-PBTI IN ROC-FLD TO ITR-MSC-PBTI IN ITR.         
           MOVE ROC-MSC-BPBT IN ROC-FLD TO ITR-MSC-BPBT IN ITR.         
           MOVE ROC-MSC-SPBT IN ROC-FLD TO ITR-MSC-SPBT IN ITR.         
           MOVE ROC-COD-CVTI IN ROC-FLD TO ITR-COD-CVTI IN ITR.         
           MOVE ROC-MSC-TFPR IN ROC-FLD TO ITR-MSC-TFPR IN ITR.         
           MOVE ROC-NUM-PREP IN ROC-FLD TO ITR-NUM-PREP IN ITR.         
           MOVE ROC-MSC-UTPR IN ROC-FLD TO ITR-MSC-UTPR IN ITR.         
                                                                        
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM COL-FIO-ITR.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ITR    NOGRB' TO MSG-COD-MENS.                     
       FIN-PUT-ITR.                                                     
           EXIT.                                                        
                                                                        
       INI-REG-ITR SECTION.                                             
       INI-INI-REG-ITR.                                                 
           MOVE SPACES   TO ITR-GLS-FLAG IN ITR.                        
           MOVE ZEROES   TO ITR-FEC-FTER IN ITR.                        
           MOVE ZEROES   TO ITR-SGV-SPRD IN ITR.                        
           MOVE ZEROES   TO ITR-SGV-MNTO IN ITR.                        
           MOVE SPACES   TO ITR-GLS-DISP IN ITR.                        
       FIN-INI-REG-ITR.                                                 
           EXIT.                                                        

       COPY GNSBGVSM.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBVCOD.                                                   
       COPY GNSBBTAB.                                                   
       COPY TABBFSGS.                                                   
       COPY TABBFCIN.                                                   
      *PVG INI 23-NOV-2004 PRECIOS-PPC                                  
       COPY TABBFPPC.                                                   
      *PVG FIN 23-NOV-2004 PRECIOS-PPC                                  
       COPY TABBBUSR.                                                   
       COPY TABBFUSR.                                                   
       COPY COLBFITR.                                                   
       COPY COLBFOPC.                                                   
       COPY COLBFVEN.                                                   
      *PVG INI 25-SEP-2006 INTEGRACION CGN                              
       COPY MC2BFCGN.                                                   
       COPY MC2BFCCM.                                                   
      *PVG FIN 25-SEP-2006                                              
                                                                        
      *PVG INI 27-NOV-2006 (INTEGRACION A CNC)                          
       COPY TABBFAGD.                                                   
       COPY MC2BFCVN.                                                   
                                                                        
       ANL-CNC-ROC SECTION.                                             
       INI-ANL-CNC-ROC.                                                 
           IF NOT (ROC-GLS-ADIC IN ROC = 'RCC')                         
              GO TO FIN-ANL-CNC-ROC.                                    
      *    ROC-IND-ADIC + ROC-GLS-ADIC= AGD-CAI-IAGD IN AGD.            
           MOVE ROC-IND-ADIC IN ROC  TO AGD-COD-TAGP IN AGD.            
           MOVE ROC-GLS-ADIC IN ROC  TO AGD-COD-CAGP IN AGD.            
           MOVE ROC-NUM-ADIC IN ROC  TO AGD-IIC-IAGD IN AGD.            
           MOVE ZEROES               TO AGD-NUM-IAGD IN AGD.            
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-ANL-CNC-ROC.                                                 
           PERFORM TAB-FIO-AGD.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                   ROC-IND-ADIC IN ROC = AGD-COD-TAGP IN AGD AND        
                   ROC-GLS-ADIC IN ROC = AGD-COD-CAGP IN AGD AND        
                   ROC-NUM-ADIC IN ROC = AGD-IIC-IAGD IN AGD)           
              GO TO FIN-ANL-CNC-ROC.                                    
                                                                        
           IF NOT (AGD-COD-TAGD IN AGD = 'CNV')                         
              MOVE FIO-GET-NXT TO FIO-CMND                              
              GO TO LUP-ANL-CNC-ROC.                                    
                                                                        
      *Carga parametros nueva ROC de convenio                           
      *    MOVE ROC-GLS-FLAG IN ROC TO ROC-GLS-FLAG IN ROC.             
      *    MOVE ROC-CIC-IOPC IN ROC TO ROC-CIC-IOPC IN ROC.             
      *    MOVE ROC-COD-SIST IN ROC TO ROC-COD-SIST IN ROC.             
      *    MOVE ROC-COD-EVEN IN ROC TO ROC-COD-EVEN IN ROC.             
           ADD  1                   TO ROC-NUM-IROC IN ROC.             
           PERFORM RET-STT-ROC.                                         
           PERFORM RET-HDR-ROC.                                         
           MOVE ROC-COD-SCPT IN ROC TO ROC-COD-MODL IN ROC.             
           MOVE ROC-COD-CPTO IN ROC TO ROC-COD-SCPT IN ROC.             
           MOVE 'CVN'               TO ROC-COD-CPTO IN ROC.             
      *    MOVE SPACES              TO ROC-COD-MODL IN ROC.             
           MOVE SPACES              TO ROC-COD-OCOB IN ROC.             
           MOVE AGD-COD-CAGD IN AGD TO ROC-CIC-PLAN IN ROC.             
      *    MOVE ROC-IND-TPLT IN ROC TO ROC-IND-TPLT IN ROC.             
      *    MOVE ROC-COD-VCOC IN ROC TO ROC-COD-VCOC IN ROC.             
           MOVE ROC-IND-VIGE IN ROC-FLD TO ROC-IND-VIGE IN ROC.         
                                                                        
      *Leer CVN                                                         
           MOVE ROC-CIC-PLAN IN ROC TO CVN-CIC-ICVN IN CVN.             
           PERFORM GET-FHOY.                                            
           MOVE HOY-FHOY            TO CVN-FEC-FCVN IN CVN.             
           MOVE HOY-HHOY            TO CVN-HRA-HRCV IN CVN.             
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM MC2-FIO-CVN.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                   ROC-CIC-PLAN IN ROC = CVN-CIC-ICVN IN CVN)           
              MOVE HOY-FHOY            TO ROC-FEC-PLAN IN ROC           
              MOVE HOY-HHOY            TO ROC-HRA-PLAN IN ROC           
           ELSE                                                         
              MOVE CVN-FEC-FCVN IN CVN TO ROC-FEC-PLAN IN ROC           
              MOVE CVN-HRA-HRCV IN CVN TO ROC-HRA-PLAN IN ROC.          
           IF FIO-STAT-OKS                                              
              MOVE FIO-END-BRW TO FIO-CMND                              
              PERFORM MC2-FIO-CVN.                                      
                                                                        
      *Leer DEC                                                         
           MOVE SPACES              TO ROC-NUM-ADIC IN ROC.             
           MOVE SPACES              TO ROC-IND-ADIC IN ROC.             
           MOVE SPACES              TO ROC-GLS-ADIC IN ROC.             
           MOVE SPACES              TO ROC-VRF-ADIC IN ROC.             
           MOVE SPACES              TO ROC-COD-ANUL IN ROC.             
      *                                                                 
           MOVE ZEROES              TO ROC-FEC-FUNO IN ROC.             
           MOVE ZEROES              TO ROC-FEC-FDOS IN ROC.             
           MOVE ZEROES              TO ROC-SGV-TCAL IN ROC.             
           MOVE SPACES              TO ROC-COD-TIPT IN ROC.             
           MOVE SPACES              TO ROC-COD-CVTI IN ROC.             
           MOVE SPACES              TO ROC-MSC-TFPR IN ROC.             
           MOVE ZEROES              TO ROC-NUM-PREP IN ROC.             
           MOVE SPACES              TO ROC-MSC-UTPR IN ROC.             
           MOVE ZEROES              TO ROC-SGV-TINF IN ROC.             
           MOVE ZEROES              TO ROC-SGV-CFON IN ROC.             
           MOVE ZEROES              TO ROC-SGV-FRIE IN ROC.             
           MOVE SPACES              TO ROC-GLS-DISP IN ROC.             
      *Graba nueva ROC de convenio                                      
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM TAB-FIO-ROC.                                         
      *PVG INI 04-JUN-2009                                              
      *    MOVE FIO-STAT TO PGM-STAT-ROC.                               
           IF NOT FIO-STAT-OKS                                          
              MOVE 'ERRPUTROCCNC' TO MSG-COD-MENS.                      
      *PVG FIN 04-JUN-2009                                              
       FIN-ANL-CNC-ROC.                                                 
           EXIT.                                                        
      *PVG FIN 27-NOV-2006 (INTEGRACION A CNC)                          
      *>>>>  
*% END	     
