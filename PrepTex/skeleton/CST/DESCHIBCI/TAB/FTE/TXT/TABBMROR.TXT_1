*%! Codigo adicional
*% INI_LBL = TRUE
*% PGM_BQ = TRUE
*% FRM = "ROR"
*% PGM_BQ = TRUE
*% IF INI_KEY_ROR_ROR
      *<<<< INI_KEY_ROR_ROR
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL             
           MOVE ROR-NUM-DCOL IN ROR-FLD TO ROR-NUM-DCOL IN ROR.         
           MOVE ROR-NUM-MCOL IN ROR-FLD TO ROR-NUM-MCOL IN ROR.         
           MOVE ROR-NUM-SCOL IN ROR-FLD TO ROR-NUM-SCOL IN ROR.         
           MOVE ROR-NUM-ACOL IN ROR-FLD TO ROR-NUM-ACOL IN ROR.         
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL             
      *>>>>
*% END
*% IF FIN_KEY_ROR_ROR
      *<<<< FIN_KEY_ROR_ROR
           MOVE ROR-COD-COOC IN ROR-FLD TO ROR-COD-COOC IN ROR.         
           MOVE ROR-COD-VCOC IN ROR-FLD TO ROR-COD-VCOC IN ROR.         
           MOVE ROR-IND-TCYA IN ROR-FLD TO ROR-IND-TCYA IN ROR.         
           MOVE ROR-NUM-PLZO IN ROR-FLD TO ROR-NUM-PLZO IN ROR.         
           MOVE ROR-COD-PLZO IN ROR-FLD TO ROR-COD-PLZO IN ROR.         
           MOVE ROR-COD-TTRN IN ROR-FLD TO ROR-COD-TTRN IN ROR.         
           MOVE ROR-SGV-RENT IN ROR-FLD TO ROR-SGV-RENT IN ROR.         
           MOVE ROR-SGV-COMI IN ROR-FLD TO ROR-SGV-COMI IN ROR.         
           MOVE ROR-SGV-MONT IN ROR-FLD TO ROR-SGV-MONT IN ROR.         
           MOVE ROR-NUM-VCOR IN ROR-FLD TO ROR-NUM-VCOR IN ROR.         
      *>>>>
*% END
*% IF INI_CLR_KEY_ROR
      *<<<< INI_CLR_KEY_ROR
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )                
           MOVE ZEROES TO ROR-FEC-FCOL IN ROR-FLD.                      
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )                
      *>>>>
*% END
*% IF FIN_CLR_KEY_ROR
      *<<<< FIN_CLR_KEY_ROR
           MOVE SPACES TO ROR-COD-COOC IN ROR-FLD.                      
           MOVE SPACES TO ROR-COD-VCOC IN ROR-FLD.                      
           MOVE SPACES TO ROR-IND-TCYA IN ROR-FLD.                      
           MOVE ZEROES TO ROR-NUM-PLZO IN ROR-FLD.                      
           MOVE SPACES TO ROR-COD-PLZO IN ROR-FLD.                      
           MOVE ZEROES TO ROR-COD-TTRN IN ROR-FLD.                      
           MOVE ZEROES TO ROR-SGV-RENT IN ROR-FLD.                      
           MOVE ZEROES TO ROR-SGV-COMI IN ROR-FLD.                      
           MOVE ZEROES TO ROR-SGV-MONT IN ROR-FLD.                      
           MOVE ZEROES TO ROR-NUM-VCOR IN ROR-FLD.                      
      *>>>>
*% END
*% IF FIN_PRO_IKY_ROR
      *<<<< FIN_PRO_IKY_ROR
           MOVE FRM-CPIM-AEY TO ROR-FEC-FCOL-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-COD-COOC-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-COD-VCOC-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-IND-TCYA-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-NUM-PLZO-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-COD-PLZO-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-COD-TTRN-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-SGV-RENT-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-SGV-COMI-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-SGV-MONT-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-AEY TO ROR-NUM-VCOR-ATR IN ROR-FLD.            
      *>>>>
*% END
*% IF FIN_UNP_IKY_ROR
      *<<<< FIN_UNP_IKY_ROR
           MOVE FRM-CPIM-UBY TO ROR-FEC-FCOL-ATR IN ROR-FLD.            
           MOVE FRM-CPIM-UBY TO ROR-COD-COOC-ATR.                       
           MOVE FRM-CPIM-UBY TO ROR-COD-VCOC-ATR.                       
           MOVE FRM-CPIM-UBY TO ROR-IND-TCYA-ATR.                       
           MOVE FRM-CPIM-UBY TO ROR-NUM-PLZO-ATR.                       
           MOVE FRM-CPIM-UBY TO ROR-COD-PLZO-ATR.                       
           MOVE FRM-CPIM-UBY TO ROR-COD-TTRN-ATR.                       
           MOVE FRM-CPIM-UBY TO ROR-SGV-RENT-ATR.                       
           MOVE FRM-CPIM-UBY TO ROR-SGV-COMI-ATR.                       
           MOVE FRM-CPIM-UBY TO ROR-SGV-MONT-ATR.                       
           MOVE FRM-CPIM-UBY TO ROR-NUM-VCOR-ATR.                       
      *>>>>
*% END
*% IF FIN_VAL_IKY_ROR
      *<<<< FIN_VAL_IKY_ROR
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
           PERFORM VAL-ROR-FEC-FCOL.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                ROR-FEC-FCOL-LEN IN ROR-FLD                             
                GO TO FIN-VAL-IKY-ROR.                                  
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                

           PERFORM VAL-ROR-COD-COOC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-COD-COOC-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
           PERFORM VAL-ROR-COD-VCOC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-COD-VCOC-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
           PERFORM VAL-ROR-IND-TCYA.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-IND-TCYA-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
           PERFORM VAL-ROR-NUM-PLZO.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-NUM-PLZO-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
           PERFORM VAL-ROR-COD-PLZO.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-COD-PLZO-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
           PERFORM VAL-ROR-COD-TTRN.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-COD-TTRN-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
           PERFORM VAL-ROR-SGV-RENT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-SGV-RENT-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
           PERFORM VAL-ROR-SGV-COMI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-SGV-COMI-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
           PERFORM VAL-ROR-SGV-MONT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-SGV-MONT-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
           PERFORM VAL-ROR-NUM-VCOR.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO ROR-NUM-VCOR-LEN IN ROR-FLD        
                GO TO FIN-VAL-IKY-ROR.                                  
      *>>>>
*% END

*% IF INI_
      *<<<< INI_
      *>>>>
*% END
*% IF INI_
      *<<<< INI_
      *>>>>
*% END
*% IF INI_
      *<<<< INI_
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION                
       VAL-ROR-FEC-FCOL SECTION.                                        
       INI-VAL-ROR-FEC-FCOL.                                            
           IF ROR-FEC-FCOL IN ROR-FLD  NOT > ZEROES                     
              MOVE ZEROES TO ROR-FEC-FCOL IN ROR-FLD.                   
      *VAL-FEC Validar Fecha                                            
           MOVE ROR-FEC-FCOL IN ROR-FLD TO FEC-FECH.                    
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-N  TO FEC-FBLK.                                
           MOVE FEC-CHOY-LE TO FEC-CHOY.                                
           MOVE FEC-VHBL-S TO FEC-VHBL.                                 
           MOVE FEC-VAL-FEC TO FEC-CMND.                                
           PERFORM PRO-FEC.                                             
           IF FEC-STAT-OKS                                              
               MOVE FEC-FECH TO ROR-FEC-FCOL IN ROR-FLD                 
           ELSE                                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE FEC-MENS     TO FRM-MENS                            
               GO TO FIN-VAL-ROR-FEC-FCOL.                              
       FIN-VAL-ROR-FEC-FCOL.                                            
           EXIT.                                                        
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION                

       VAL-ROR-COD-COOC SECTION.                                        
       INI-VAL-ROR-COD-COOC.                                            
           IF ROR-COD-COOC IN ROR-FLD NOT > SPACES                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-ROR-COD-COOC.                             
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'COL' TO TAB-COD-SIST.                                  
           MOVE 'AUX ' TO TAB-COD-TTAB IN TAB.                          
           MOVE ROR-COD-COOC IN ROR-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              ROR-COD-COOC IN ROR-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-COOC IN ROR-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-COOC IN ROR-FLD.                            
       FIN-VAL-ROR-COD-COOC.                                            
           EXIT.                                                        
                                                                        
       VAL-ROR-COD-VCOC SECTION.                                        
       INI-VAL-ROR-COD-VCOC.                                            
           IF ROR-COD-VCOC IN ROR-FLD NOT > SPACES                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-ROR-COD-VCOC.                             
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.                          
           MOVE ROR-COD-VCOC IN ROR-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              ROR-COD-VCOC IN ROR-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-VCOC IN ROR-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-VCOC IN ROR-FLD.                            
       FIN-VAL-ROR-COD-VCOC.                                            
           EXIT.                                                        
                                                                        
       VAL-ROR-IND-TCYA SECTION.                                        
       INI-VAL-ROR-IND-TCYA.                                            
           IF ROR-IND-TCYA IN ROR-FLD NOT > SPACES                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-ROR-IND-TCYA.                             
      *VAL-IND Valida miscelaneo de tabla                               
           MOVE 'TAB' TO MSC-COD-SIST.                                  
           MOVE 'TCYA' TO MSC-COD-TMSC IN MSC.                          
           MOVE ROR-IND-TCYA IN ROR-FLD TO MSC-COD-CMSC IN MSC.         
           PERFORM VAL-IND.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              ROR-IND-TCYA IN ROR-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-TCYA IN ROR-FLD                   
           ELSE                                                         
               MOVE MSC-GLS-DESC IN MSC TO                              
                    FRM-GLS-TCYA IN ROR-FLD.                            
       FIN-VAL-ROR-IND-TCYA.                                            
           EXIT.                                                        
                                                                        
       VAL-ROR-NUM-PLZO SECTION.                                        
       INI-VAL-ROR-NUM-PLZO.                                            
           IF ROR-NUM-PLZO IN ROR-FLD = ZEROES                          
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-ROR-NUM-PLZO.                             
       FIN-VAL-ROR-NUM-PLZO.                                            
           EXIT.                                                        
                                                                        
       VAL-ROR-COD-PLZO SECTION.                                        
       INI-VAL-ROR-COD-PLZO.                                            
           IF ROR-COD-PLZO IN ROR-FLD NOT > SPACES                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-ROR-COD-PLZO.                             
       FIN-VAL-ROR-COD-PLZO.                                            
           EXIT.                                                        
                                                                        
       VAL-ROR-COD-TTRN SECTION.                                        
       INI-VAL-ROR-COD-TTRN.                                            
           IF ROR-COD-TTRN IN ROR-FLD = ZEROES                          
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-ROR-COD-TTRN.                             
       FIN-VAL-ROR-COD-TTRN.                                            
           EXIT.                                                        
                                                                        
       VAL-ROR-SGV-RENT SECTION.                                        
       INI-VAL-ROR-SGV-RENT.                                            
      *    IF ROR-SGV-RENT IN ROR-FLD = ZEROES                          
      *         PERFORM ERR-GLS                                         
      *         GO TO FIN-VAL-ROR-SGV-RENT.                             
       FIN-VAL-ROR-SGV-RENT.                                            
           EXIT.                                                        
                                                                        
       VAL-ROR-SGV-COMI SECTION.                                        
       INI-VAL-ROR-SGV-COMI.                                            
      *    IF ROR-SGV-COMI IN ROR-FLD = ZEROES                          
      *         PERFORM ERR-GLS                                         
      *         GO TO FIN-VAL-ROR-SGV-COMI.                             
       FIN-VAL-ROR-SGV-COMI.                                            
           EXIT.                                                        
                                                                        
       VAL-ROR-SGV-MONT SECTION.                                        
       INI-VAL-ROR-SGV-MONT.                                            
           IF ROR-SGV-MONT IN ROR-FLD = ZEROES                          
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-ROR-SGV-MONT.                             
       FIN-VAL-ROR-SGV-MONT.                                            
           EXIT.                                                        
                                                                        
       VAL-ROR-NUM-VCOR SECTION.                                        
       INI-VAL-ROR-NUM-VCOR.                                            
           IF ROR-NUM-VCOR IN ROR-FLD = ZEROES                          
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-ROR-NUM-VCOR.                             
       FIN-VAL-ROR-NUM-VCOR.                                            
           EXIT.                                                        

      *>>>>
*% END
