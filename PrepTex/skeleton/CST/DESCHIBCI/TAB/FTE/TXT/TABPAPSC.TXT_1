*%! Codigo adicional para archivo
*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = FALSE
*% NO_HDR_CST = FALSE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% LARGO_MI_COMMAREA = 0
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
      *    Indicador Obligatoriedad Campo Codigo Seleccion
           03 SCR-IND-OBSC                             PIC X(01).
      *    Indicador Tipo Validadcion Campo Codigo Seleccion
           03 SCR-IND-VCPS                             PIC X(01).
      *    Indicador Protege Campo Monto 1 y Moneda 1
           03 SCR-IND-PMM1                             PIC X(01).
      *    Indicador Protege Campo Monto 2 y Moneda 2
           03 SCR-IND-PMM2                             PIC X(01).
      *    Indicador Protege Campo Descripcion
           03 SCR-IND-PDES                             PIC X(01).
      *    Indicador de Validacion de Campos Monedas
           03 SCR-IND-VMON                             PIC X(01).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01 WSS-VARI.
          03 WSS-GLS-DAT1.
             05 WSS-GLS-SIST                           PIC X(03).
             05 WSS-GLS-FILL                           PIC X(07).
          03 WSS-GLS-DTA1.                                              
             05 WSS-COD-DAT1                           PIC X(01).       
             05 WSS-GLS-FIL1                           PIC X(04).       
             05 WSS-COD-DAT6                           PIC X(01).       
             05 WSS-COD-DAT7                           PIC X(01).       
             05 WSS-COD-DAT8                           PIC X(01).       
             05 WSS-COD-DAT9                           PIC X(01).       
             05 WSS-COD-DAT0                           PIC X(01).       
          03 WSS-CIC-CTAB                              PIC X(12).
          03 WSS-STP-FINI.
             05 WSS-FEC-FINI.
                07 WSS-NUM-SINI                        PIC 9(02).
                07 WSS-NUM-AINI                        PIC 9(02).
                07 WSS-NUM-MINI                        PIC 9(02).
                07 WSS-NUM-DINI                        PIC 9(02).
             05 WSS-HRA-HINI.
                07 WSS-NUM-HHIN                        PIC 9(02).
                07 WSS-NUM-MMIN                        PIC 9(02).
                07 WSS-NUM-SSIN                        PIC 9(02).
          03 WSS-STP-FTER.
             05 WSS-FEC-FTER.
                07 WSS-NUM-STER                        PIC 9(02).
                07 WSS-NUM-ATER                        PIC 9(02).
                07 WSS-NUM-MTER                        PIC 9(02).
                07 WSS-NUM-DTER                        PIC 9(02).
             05 WSS-HRA-HTER.
                07 WSS-NUM-HHTE                        PIC 9(02).
                07 WSS-NUM-MMTE                        PIC 9(02).
                07 WSS-NUM-SSTE                        PIC 9(02).
          03 WSS-COD-EVEN.
             05 WSS-COD-SIST                           PIC X(03).
             05 WSS-COD-EVTO                           PIC X(06).
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CMND NOT = 'ING'
               GO TO CNT-FND-KEY.

           MOVE PSC-CAI-IPSC IN PSC-FLD TO PSC-CAI-IPSC IN PSC.
           MOVE PSC-IIC-IPSC IN PSC-FLD TO PSC-IIC-IPSC IN PSC.
           MOVE PSC-COD-SIST IN PSC-FLD TO PSC-COD-SIST IN PSC.
           MOVE PSC-IND-SELC IN PSC-FLD TO PSC-IND-SELC IN PSC.
           MOVE PSC-COD-EVEN IN PSC-FLD TO PSC-COD-EVEN IN PSC.
           MOVE PSC-COD-CPTO IN PSC-FLD TO PSC-COD-CPTO IN PSC.
           MOVE PSC-COD-CPSC IN PSC-FLD TO PSC-COD-CPSC IN PSC.
           MOVE '99999999999999'        TO PSC-STP-FINI IN PSC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM TAB-FIO-PSC.
           IF NOT (FIO-STAT-OKS AND
               PSC-CAI-IPSC IN PSC = PSC-CAI-IPSC IN PSC-FLD AND
               PSC-IIC-IPSC IN PSC = PSC-IIC-IPSC IN PSC-FLD AND
               PSC-COD-SIST IN PSC = PSC-COD-SIST IN PSC-FLD AND
               PSC-IND-SELC IN PSC = PSC-IND-SELC IN PSC-FLD AND
               PSC-COD-EVEN IN PSC = PSC-COD-EVEN IN PSC-FLD AND
               PSC-COD-CPTO IN PSC = PSC-COD-CPTO IN PSC-FLD AND
               PSC-COD-CPSC IN PSC = PSC-COD-CPSC IN PSC-FLD)
                GO TO CNT-FND-KEY.

           IF PSC-IND-VIGE IN PSC = 'S'
               MOVE 'PSC    VIG' TO MSG-COD-MENS
               GO TO SIG-FND-KEY.
 
           MOVE PSC-NUM-SINI IN PSC-FLD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE PSC-NUM-AINI IN PSC-FLD TO WSS-NUM-AINI IN WSS-VARI.
           MOVE PSC-NUM-MINI IN PSC-FLD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE PSC-NUM-DINI IN PSC-FLD TO WSS-NUM-DINI IN WSS-VARI.
           MOVE PSC-HRA-HINI IN PSC-FLD TO WSS-HRA-HINI IN WSS-VARI.
          
           IF WSS-STP-FINI IN WSS-VARI NOT > PSC-STP-FTER IN PSC        
               MOVE 'FINI<PSCFTER' TO MSG-COD-MENS                      
               GO TO SIG-FND-KEY.
 
       CNT-FND-KEY.
           PERFORM KEY-ALL-PSC.                                         
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF SCR-CMND = 'ANL' AND PSC-IND-VIGE IN PSC = 'N'
               MOVE 'PSC    YAANL' TO MSG-COD-MENS
               GO TO SIG-FND-KEY.

           GO TO FIN-FND-KEY.
       SIG-FND-KEY.
           MOVE 'TAB'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00'         TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
      *>>>>
*% END
*% IF SCR_GIKY_VAL_IKY
      *<<<< SCR_GIKY_VAL_IKY
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-IND-PMM1 IN SCR-VARI = 'S'
               MOVE FRM-CPIM-AEY TO PSC-VAL-MTO1-ATR IN PSC-FLD
               MOVE FRM-CPIM-AEY TO PSC-COD-MON1-ATR IN PSC-FLD.
           IF SCR-IND-PMM2 IN SCR-VARI = 'S'
               MOVE FRM-CPIM-AEY TO PSC-VAL-MTO2-ATR IN PSC-FLD
               MOVE FRM-CPIM-AEY TO PSC-COD-MON2-ATR IN PSC-FLD.
           IF SCR-IND-PDES IN SCR-VARI = 'S'
               MOVE FRM-CPIM-AEY TO PSC-GLS-DESC-ATR IN PSC-FLD.
           IF SCR-CMND = 'ANL'
               MOVE HOY-SHOY     TO PSC-NUM-STER     IN PSC-FLD 
               MOVE HOY-AHOY     TO PSC-NUM-ATER     IN PSC-FLD 
               MOVE HOY-MHOY     TO PSC-NUM-MTER     IN PSC-FLD 
               MOVE HOY-DHOY     TO PSC-NUM-DTER     IN PSC-FLD 
               MOVE FRM-CPIM-AEY TO PSC-VAL-MTO1-ATR IN PSC-FLD
               MOVE FRM-CPIM-AEY TO PSC-COD-MON1-ATR IN PSC-FLD
               MOVE FRM-CPIM-AEY TO PSC-VAL-MTO2-ATR IN PSC-FLD
               MOVE FRM-CPIM-AEY TO PSC-COD-MON2-ATR IN PSC-FLD
               MOVE FRM-CPIM-AEY TO PSC-GLS-DESC-ATR IN PSC-FLD.
           IF SCR-CMND = 'ING'
               MOVE FRM-CPIM-AEY TO PSC-FEC-FTER-ATR IN PSC-FLD
               MOVE FRM-CPIM-AEY TO PSC-HRA-HTER-ATR IN PSC-FLD
               MOVE 'S'          TO PSC-IND-VIGE     IN PSC-FLD
               MOVE FRM-CPIM-AEY TO PSC-IND-VIGE-ATR IN PSC-FLD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBGVSM.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBBTAB.
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
      *>>>>
*% END
