       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   DAPPQCCC.
       AUTHOR.       CONSIST.
       DATE-WRITTEN. 17-Jun-10 05:00 PM.

      * NOMBRE PROGRAMA                   DAPPQCCC
      * VERSION PGM                       3.1
      * VERSION SKL                       07.08.21
      * OPCION                            CON
      * ARCHIVO BASE                      SGCDBC
      * PANTALLA                          DAPCCC
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-DAPPQCCC-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$DAPPQCCC$ SKL=$07.08.21$ VSN=${vsnpq}$        
      -    'GEN=$17-Jun-10 05:00 PM$ FNC=${fncpq}$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-DBC-REQA==.
           02 SCR-KEY-IDBC                     PIC X(03).
           02 SCR-CIC-ICLI                     PIC X(12).
      *>>>>
       COPY DAPWICCC.

       COPY SGCBRDBC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.

      *<<<< WSS
      *Entidades de DAP
       COPY DAPBROPD.
       COPY DAPBRRCC.
       COPY DAPBRLIQ.                                                   
       COPY DAPBRVEN.                                                   
       COPY DAPBREPD.                                                   
      *NVA COPY DAPBRDCD.                                               
                                                                        
       COPY TABBRCAM.                                                   
      *NVA COPY TABBROFI.                                               
       COPY GNSWGFEC.                                                   
       COPY GNSWGHOY.                                                   
       COPY DAPWGCCC.                                                   
       COPY GNSWGPES.                                                   
      *                                                                 
       COPY DAPWG006.                                                   
       COPY DAPWG008.                                                   
       COPY USPC117.                                                    
      *
       COPY GNSWGCPT.
       COPY GNSWGSTR.

       77 WSS-DBNM           VALUE ZEROES        PIC 9(03).             
       77 WSS-DBIM           VALUE ZEROES        PIC 9(02).             
       77 WSS-DBNP           VALUE ZEROES        PIC 9(03).             
       77 WSS-DBIP           VALUE ZEROES        PIC 9(02).             
       77 WSS-BUS-BDP        VALUE 'N'           PIC X(01).             
                                                                        
       77 WS-CCC-OCC-FRM-VAL-CAFI-NUM  PIC  9(11)V9(04).                
       77 WS-CCC-OCC-FRM-VAL-CAFF-NUM  PIC  9(11)V9(04).                
                                                                        
       01  WSS-INI-BUSQ     VALUE 'N'   PIC X(01).                      
       01  WSS-IND-HMAS     VALUE 'N'   PIC X(01).                      
       01  WSS-TOT-HMAS     VALUE ZEROES PIC 9(04).                     
                                                                        
       01  WSS-FEC-FREA.                                                
           03 WSS-NUM-DREA          PIC X(02).                          
           03 WSS-NUM-MREA          PIC X(02).                          
           03 WSS-NUM-SREA          PIC X(02).                          
           03 WSS-NUM-AREA          PIC X(02).                          
                                                                        
       01  WSS-FEC-FLIQ.                                                
           03 WSS-NUM-DLIQ          PIC X(02).                          
           03 WSS-NUM-MLIQ          PIC X(02).                          
           03 WSS-NUM-SLIQ          PIC X(02).                          
           03 WSS-NUM-ALIQ          PIC X(02).                          
                                                                        
       01  WSS-FEC-FPVC.                                                
           03 WSS-NUM-DPVC          PIC X(02).                          
           03 WSS-NUM-MPVC          PIC X(02).                          
           03 WSS-NUM-SPVC          PIC X(02).                          
           03 WSS-NUM-APVC          PIC X(02).                          
                                                                        
       01  WSS-FEC-FDMA.                                                
           03 WSS-NUM-DDMA          PIC X(02).                          
           03 WSS-NUM-MDMA          PIC X(02).                          
           03 WSS-NUM-SDMA          PIC X(02).                          
           03 WSS-NUM-ADMA          PIC X(02).                          
                                                                        
       01  WSS-FEC-FDES.                                                
           03 WSS-NUM-SDES          PIC X(02).                          
           03 WSS-NUM-ADES          PIC X(02).                          
           03 WSS-NUM-MDES          PIC X(02).                          
           03 WSS-NUM-DDES          PIC X(02).                          
                                                                        
       01  WSS-FEC-FHAS.                                                
           03 WSS-NUM-SHAS          PIC X(02).                          
           03 WSS-NUM-AHAS          PIC X(02).                          
           03 WSS-NUM-MHAS          PIC X(02).                          
           03 WSS-NUM-DHAS          PIC X(02).                          
                                                                        
       01  WSS-FEC-FTER.                                                
           03 WSS-NUM-DTER          PIC X(02).                          
           03 WSS-NUM-MTER          PIC X(02).                          
                 03 WSS-NUM-ATER          PIC X(02).                          
                                                                        
      * FECHA INICIO RANGO INVERSIONES                                  
       01  WSS-FEC-FINR.                                                
           03 WSS-NUM-SINR          PIC X(02).                          
           03 WSS-NUM-AINR          PIC X(02).                          
           03 WSS-NUM-MINR          PIC X(02).                          
           03 WSS-NUM-DINR          PIC X(02).                          
                                                                        
      * FECHA TERMINO RANGO INVERSIONES                                 
       01  WSS-FEC-FFIR.                                                
           03 WSS-NUM-SFIR          PIC X(02).                          
           03 WSS-NUM-AFIR          PIC X(02).                          
           03 WSS-NUM-MFIR          PIC X(02).                          
           03 WSS-NUM-DFIR          PIC X(02).                          
                                                                        
      * OBVIAR OPERACION LIQUIDADA                                      
       01  WSS-RCC-CAI-IOPD-01 VALUE SPACES    PIC X(01).               
                                                                        
       01  WSS-PUT-TS-OCC   VALUE 'N'  PIC X(01).                       
       01  WSS-CIC-VCAM.                                                
           03 WSS-CIC-TVAL           PIC X(01).                         
           03 WSS-CIC-CVAL           PIC X(03).                         
           03 WSS-CIC-TCAM           PIC X(02).                         
       01  WSS-COD-VCAM-0999.                                           
           03 WSS-COD-TVAL-0999           PIC X(01).                    
           03 WSS-COD-CVAL-0999           PIC X(03).                    
           03 WSS-COD-TCAM-0999           PIC X(02).                    
                                                                        
       01  WSS-COD-VCAM-0998.                                           
           03 WSS-COD-TVAL-0998           PIC X(01).                    
           03 WSS-COD-CVAL-0998           PIC X(03).                    
           03 WSS-COD-TCAM-0998           PIC X(02).                    
                                                                        
       01  WSS-COD-VCAM-1013.                                           
           03 WSS-COD-TVAL-1013           PIC X(01).                    
           03 WSS-COD-CVAL-1013           PIC X(03).                    
           03 WSS-COD-TCAM-1013           PIC X(02).                    
                                                                        
       01  WSS-COD-VCAM-1142.                                           
           03 WSS-COD-TVAL-1142           PIC X(01).                    
           03 WSS-COD-CVAL-1142           PIC X(03).                    
           03 WSS-COD-TCAM-1142           PIC X(02).                    
                                                                        
       01  WSS-VARI.
           03  WSS-TOT-PUT-TS-OCC  VALUE ZEROES PIC 9(03).              
           03  WSS-TOT-OPER-MTX    VALUE ZEROES PIC 9(03).              
           03  WSS-TOT-LEYO-MTX    VALUE ZEROES PIC 9(03).              
           03 WSS-FEC-FUNO.                                             
              05 WSS-NUM-SUNO                   PIC 9(02).              
              05 WSS-NUM-AUNO                   PIC 9(02).              
              05 WSS-NUM-MUNO                   PIC 9(02).              
              05 WSS-NUM-DUNO                   PIC 9(02).              
           03  WSS-NUM-PNTE                     PIC 9(05).              
           03  WSS-SGV-VCAM   COMP-3      PIC S9(11)V9(4).              
           03  WSS-TOT-OPER                 PIC 9(03).
           03  WSS-NUM-OPER                 PIC 9(03).
           03  WSS-IND-MONE                 PIC X(01).
           03  WSS-TOT-MONE                 PIC 9(03).
           03  WSS-NUM-MONE                 PIC 9(03).
           03  WSS-IDX-MONE                 PIC 9(03).
           03  WSS-IND-PROD                     PIC X(01).              
           03  WSS-TOT-PROD                     PIC 9(03).              
           03  WSS-NUM-PROD                     PIC 9(03).              
           03  WSS-IDX-PROD                     PIC 9(03).              
           03  WSS-COPD.                                                
               05 WSS-TOPD                           PIC X(03).         
               05 WSS-AOPD                           PIC X(03).         
           03  WSS-PROD.                                                
               05 WSS-PROD-OCC OCCURS 30 TIMES.                         
                  07 WSS-PROD-VCAM                   PIC X(06).         
                  07 WSS-PROD-TOPD                   PIC X(03).         
                  07 WSS-PROD-AOPD                   PIC X(03).         
                  07 WSS-PROD-GLOS                   PIC X(20).         
                  07 WSS-PROD-TOTA VALUE ZEROES      PIC 9(13)V9(2).    
      *
           03 WSS-LTAB                       VALUE 13 PIC 9(02).
           03 WSS-I                                   PIC 9(02).
           03 WSS-J                          VALUE 00 PIC 9(02).
           03 WSS-IMAX               VALUE 5          PIC 9(02).
      *    Codigo Clase Operacion DAP
           03  WSS-GLS-COPD.
      *          
      *        Codigo Tipo Operacion
               05  WSS-GLS-TOPD                         PIC X(12).
      *
      *        Separacion
               05  WSS-GLS-SEPA  VALUE SPACES           PIC X(01).
      *
      *        Codigo Auxiliar Operacion                
               05  WSS-GLS-AOPD                         PIC X(12).
      *
      *    GLOSA PRODUCTO PARA TOTALIZAR                                
           03  WSS-GLS-COPD-PROD.                                       
      *                                                                 
      *        Codigo Tipo Operacion                                    
               05  WSS-GLS-TOPD-PROD                    PIC X(04).      
      *                                                                 
      *        Codigo Auxiliar Operacion                                
               05  WSS-GLS-AOPD-PROD                    PIC X(04).      
      *                                                                 
      *        Codigo Auxiliar Operacion                                
               05  WSS-GLS-VCAM-PROD                    PIC X(04).      
      *                                                                 
           03 WSS-STAT.
              05 LEO                                    PIC X(02).
                 88 LEO-TODOS  VALUE      'SI'.
                                                                        
       01  WSS-GLS-DCOR-VCAM VALUE SPACES.                              
           03 WSS-GLS-DCOR-0999                    PIC X(12).           
           03 WSS-GLS-DCOR-0998                    PIC X(12).           
           03 WSS-GLS-DCOR-1013                    PIC X(12).           
           03 WSS-GLS-DCOR-1142                    PIC X(12).           
                                                                        
      *>>>> WSS
      *<<<< WSS_DTC
      *Entidades de OPD
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LIQ-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.        
      *NVA COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.    
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EPD-REQA==.        
      *NVA COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCD-REQA==.    
                                                                        
       COPY DAPWGVEN.                                                   
       COPY GNSWGINT.                                                   
       01  WSS-BKP-OPD      VALUE SPACES PIC X(500).                    
       01  WSS-BKP-VEN      VALUE SPACES PIC X(300).                    
       77  WSS-IMP-SGV-INTP VALUE ZEROES PIC S9(11)V9999.               
       77  WSS-EPD-COD-IEPD VALUE SPACES    PIC X(03).                  
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
      *<<<<
              05 PGM-STAT-VEN.                                          
                 88 PGM-STAT-VEN-NUL    VALUE '  '.                     
                 07 PGM-STT1-VEN        VALUE '2' PIC X(01).            
                    88 PGM-STAT-VEN-OKS VALUE '0'.                      
                 07 PGM-STT2-VEN        VALUE '3' PIC X(01).            
      *>>>>
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
      *<<<< CMA
           02 FILLER                      PIC X(1200).
      *>>>>
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO CCC-FLD.
           MOVE LOW-VALUES TO CCC-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'DAPPQCCC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO
           MOVE +1200 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               PERFORM GNS-CLR-RQA.
      *>>>>
      *<<<< INI_FIO
           PERFORM GNS-HDL-VSM.
      * PTC-INI-MAN                                                     
                                                                        
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR' TO  TAB-CIC-TTAB IN TAB.                          
           MOVE '0999' TO TAB-CIC-CTAB IN TAB.                          
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           PERFORM BUS-TAB.                                             
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-VCAM-0999.               
                                                                        
                                                                        
           MOVE 'MONE0999' TO QUE-COLA                                  
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +25 TO QUE-LITM                                         
           MOVE WSS-COD-VCAM-0999           TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR' TO  TAB-CIC-TTAB IN TAB.                          
           MOVE '0998' TO TAB-CIC-CTAB IN TAB.                          
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           PERFORM BUS-TAB.                                             
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-VCAM-0998.               
                                                                        
           MOVE 'MONE0998' TO QUE-COLA                                  
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +25 TO QUE-LITM                                         
           MOVE WSS-COD-VCAM-0998           TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR' TO  TAB-CIC-TTAB IN TAB.                          
           MOVE '1013' TO TAB-CIC-CTAB IN TAB.                          
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           PERFORM BUS-TAB.                                             
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-VCAM-1013.               
                                                                        
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR' TO  TAB-CIC-TTAB IN TAB.                          
           MOVE '1142' TO TAB-CIC-CTAB IN TAB.                          
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           PERFORM BUS-TAB.                                             
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-VCAM-1142.               
                                                                        
           MOVE ZEROES TO WSS-TOT-MONE.                                 
           MOVE SPACES TO WSS-PROD.                                     
           PERFORM CLR-PROD VARYING                                     
             WSS-IDX-PROD FROM 1 BY 1 UNTIL                             
             WSS-IDX-PROD > 30.                                         
                                                                        
           PERFORM GET-FHOY.                                            
                                                                        
           MOVE TS-CCC-TYPE-INP TO QUE-TYPE.                            
           MOVE TSK-TERM-ALF    TO QUE-TERM.                            
           MOVE TS-CCC-LITM-INP TO QUE-LITM.                            
           MOVE 1 TO QUE-NITM.                                          
           MOVE QUE-GET TO QUE-CMND.                                    
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
               MOVE QUE-ITEM TO TS-CCC-INP                              
               MOVE TS-CCC-INP-FRM-FEC-FDES TO                          
                    WSS-FEC-FDMA                                        
               MOVE WSS-NUM-DDMA TO WSS-NUM-DDES                        
               MOVE WSS-NUM-MDMA TO WSS-NUM-MDES                        
               MOVE WSS-NUM-SDMA TO WSS-NUM-SDES                        
               MOVE WSS-NUM-ADMA TO WSS-NUM-ADES                        
                                                                        
               MOVE TS-CCC-INP-FRM-FEC-FHAS TO                          
                    WSS-FEC-FDMA                                        
               MOVE WSS-NUM-DDMA TO WSS-NUM-DHAS                        
               MOVE WSS-NUM-MDMA TO WSS-NUM-MHAS                        
               MOVE WSS-NUM-SDMA TO WSS-NUM-SHAS                        
               MOVE WSS-NUM-ADMA TO WSS-NUM-AHAS                        
                                                                        
               MOVE TS-CCC-INP-FRM-NUM-DINR TO WSS-NUM-DINR             
               MOVE TS-CCC-INP-FRM-NUM-MINR TO WSS-NUM-MINR             
               MOVE TS-CCC-INP-FRM-NUM-SINR TO WSS-NUM-SINR             
               MOVE TS-CCC-INP-FRM-NUM-AINR TO WSS-NUM-AINR             
                                                                        
                                                                        
               MOVE TS-CCC-INP-FRM-NUM-DFIR TO WSS-NUM-DFIR             
               MOVE TS-CCC-INP-FRM-NUM-MFIR TO WSS-NUM-MFIR             
               MOVE TS-CCC-INP-FRM-NUM-SFIR TO WSS-NUM-SFIR             
               MOVE TS-CCC-INP-FRM-NUM-AFIR TO WSS-NUM-AFIR             
                                                                        
                                                                        
               PERFORM SET-IF.                                          
                                                                        
      * PTC-FIN-MAN                                                     
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-CCC.
           PERFORM EDT-KEY-CCC.
           PERFORM EDT-FLD-CCC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.



       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-CCC
               PERFORM VAL-NUM-FLD-CCC
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-CCC
               PERFORM VAL-NUM-FLD-CCC
               PERFORM SCRL-TAB-CCC
               PERFORM SCR-TRL.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.




       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-CCC
               PERFORM EDT-KEY-CCC
               PERFORM EDT-FLD-CCC
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-CCC
               PERFORM EDT-KEY-CCC
           ELSE
               PERFORM CLR-FLD-CCC
               PERFORM EDT-FLD-CCC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-CCC.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO CCC-FLD.
           MOVE LOW-VALUES TO CCC-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY
           PERFORM BUSCA-DBIM-DBIP.                                     
           IF PGM-STAT-DBC-OKS
               GO TO FIN-FND-KEY.
      *>>>>
           PERFORM KEY-ALL-CCC.
      *<<<< FND_KEY
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-CCC
                   
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'SGC'          TO MSG-COD-SIST
                       MOVE 'DBC    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC   TO FRM-MENS
                       MOVE '00'           TO FIO-STAT
                       MOVE SCR-STAT-CON   TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC'          TO MSG-COD-SIST
                       MOVE 'DBC    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC   TO FRM-MENS
                       MOVE '00'           TO FIO-STAT
                       MOVE SCR-STAT-CON   TO SCR-STAT
                       GO TO FIN-FND-KEY.
      *     ELSE
      *     IF DBC-NUM-ICLI IN CCC-FLD > ZEROES
      **IDC-CLI Busca Cliente por medio de IdC
      *         MOVE DBC-NUM-ICLI IN CCC-FLD TO DBC-NUM-ICLI IN DBC
      *         MOVE DBC-IND-ICLI IN CCC-FLD TO DBC-IND-ICLI IN DBC
      *         MOVE DBC-GLS-ICLI IN CCC-FLD TO DBC-GLS-ICLI IN DBC
      *         MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
      *         MOVE FIO-GET-KEY    TO FIO-CMND
      *         PERFORM SGC-FIO-DBC
      *         IF NOT FIO-STAT-OKS
      *             MOVE FIO-STAT-NEX TO FIO-STAT
      *             MOVE '39'         TO PGM-STAT-DBC
      *             MOVE 'SGC'        TO MSG-COD-SIST
      *             MOVE 'CLI    NEX' TO MSG-COD-MENS
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
      *         ELSE
      *             MOVE SPACES TO MSG-COD-MENS
      *             MOVE '00'                TO PGM-STAT-DBC
      *             MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
      *             PERFORM CPT-BLKS
      *             MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC
      *     ELSE
      *     IF DBC-GLS-NOMC IN CCC-FLD > SPACES
      **NOM-CLI Busca Cliente por medio del Nombre
      *         MOVE DBC-GLS-NOMC IN CCC-FLD TO STR-GLS-GSTR
      *         PERFORM STR-UNS
      *         MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
      *         MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
      *         MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC
      *         MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
      *         MOVE FIO-GET-NLS    TO FIO-CMND
      *         PERFORM SGC-FIO-DBC
      *         IF NOT FIO-STAT-OKS
      *             MOVE FIO-STAT-NEX TO FIO-STAT
      *             MOVE '39'         TO PGM-STAT-DBC
      *             MOVE 'SGC'        TO MSG-COD-SIST
      *             MOVE 'CLI    NEX' TO MSG-COD-MENS
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
      *             MOVE ZEROES       TO DBC-NUM-ICLI IN CCC-FLD
      *             MOVE SPACES       TO DBC-VRF-ICLI IN CCC-FLD
      *             MOVE SPACES       TO DBC-IND-ICLI IN CCC-FLD
      *             MOVE SPACES       TO DBC-GLS-ICLI IN CCC-FLD
      *         ELSE
      *             MOVE SPACES TO MSG-COD-MENS
      *             MOVE '00'         TO PGM-STAT-DBC
      *             MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
      *             PERFORM CPT-BLKS
      *             MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC.
      *     PERFORM BKP-CIC-CLI.
      *     GO TO FIN-FND-KEY.
      *>>>>
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-STP-ITRN IN DBC TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-DBC.
      *<<<<
           IF FIO-STAT-OKS                                              
               IF DBC-COD-TICL IN DBC = 'EE' OR                         
                  DBC-COD-TICL IN DBC = 'FI'                            
                   MOVE WSS-IDN-SIST            TO USP-SISTEMA          
                   MOVE SPACES                  TO USP-PERMISO          
                   MOVE 'DAP'                   TO USP-GRUPO            
                   MOVE SCR-USER                TO USP-USUARIO          
      * CDC = CONSULTA DATO COLBORADOR                                  
                   MOVE 'DAPPQCCC/CDC'          TO USP-STRING           
                   PERFORM USPC107                                      
                   IF USP-PERMISO NOT = 'P'                             
                       MOVE 'DAP'          TO MSG-COD-SIST              
                       MOVE 'USRDAPNOCDC'  TO MSG-COD-MENS              
                       PERFORM GET-MSG                                  
                       MOVE MSG-GLS-DESC   TO FRM-MENS                  
                       MOVE FIO-STAT-NEX   TO FIO-STAT                  
                       MOVE SCR-STAT-CON   TO SCR-STAT                  
                       GO TO FIN-FND-KEY.                               
                                                                        
      *>>>>
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-DBC-OKS
               MOVE DBC-STP-ITRN IN DBC TO SCR-UMOD.
      *<<<< PUT_SCR

           MOVE SCR-CIC-ICLI TO RCC-CIC-ICLI IN RCC.
           MOVE SPACES TO RCC-CAI-IOPD IN RCC.
           MOVE ZEROES TO RCC-IIC-IOPD IN RCC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           MOVE RCC-CAI-IOPD IN RCC TO WSS-RCC-CAI-IOPD-01.             
           IF NOT FIO-STAT-OKS                             OR           
               ( SCR-CIC-ICLI NOT = RCC-CIC-ICLI IN RCC )  OR           
               ( WSS-RCC-CAI-IOPD-01 NOT = '0' ) AND                    
               ( WSS-RCC-CAI-IOPD-01 NOT = 'Z' )                        
                                                                        
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'CLI    NORCC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
                MOVE 'SI' TO LEO
                PERFORM PRO-RCC
                PERFORM PUT-GLS-MONE VARYING WSS-NUM-MONE
                  FROM 1 BY 1 UNTIL WSS-NUM-MONE > WSS-TOT-MONE
                IF SCR-OFRM-SRV                                         
                  PERFORM PUT-GLS-PROD VARYING WSS-NUM-PROD             
                     FROM 1 BY 1 UNTIL WSS-NUM-PROD > WSS-TOT-PROD      
                  PERFORM PUT-HDR-CCC                                   
                  IF WSS-PUT-TS-OCC = 'S'                               
                      PERFORM PUT-TS-OCC.                               
                                                                        
      *     PERFORM UNP-OPCI VARYING FRM-IFLD FROM 1 BY 1
      *             UNTIL FRM-IFLD > 11.
      *>>>>
           PERFORM PUT-ALL-CCC.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE CCC-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO CCC-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-CCC
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CCC-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CCC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-CCC.
           PERFORM VAL-IKY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-CCC.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-CCC.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CCC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-CCC
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CCC-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-CCC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-CCC.
           PERFORM VAL-IKY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-CCC.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-CCC.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-CCC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
      *<<<< PFS_GET_CON OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CCC-GLS-MEN2
               MOVE SCR-PRMT     TO CCC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CCC-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO CCC-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE CCC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CCC-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-CCC

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CCC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CCC-GLS-MENS.
           PERFORM PRO-MKY-CCC.
           PERFORM PRO-AKY-CCC.
           PERFORM UNP-IKY-CCC.
           PERFORM FST-KEY-CCC.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE CCC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CCC-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CCC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CCC-GLS-MENS.
           PERFORM UNP-KEY-CCC.
           PERFORM FST-KEY-CCC.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-CCC.
           PERFORM PRO-AKY-CCC.
           PERFORM UNP-MKY-CCC.
           PERFORM UNP-FLD-CCC.
           PERFORM FST-FLD-CCC.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO CCC-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-CCC.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CCC
               PERFORM EDT-FLD-CCC
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CCC
               PERFORM EDT-FLD-CCC
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CCC.
           PERFORM EDT-FLD-CCC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY DAPBQCCC.
       COPY GNSBVNUM.
       COPY SGCBFDBC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       GNS-CLR-RQA SECTION.
       INI-GNS-CLR-RQA.
           MOVE SPACES TO SCR-DBC-REQA.
           MOVE SPACES TO SCR-KEY-IDBC.
       FIN-GNS-CLR-RQA.
           EXIT.

       SCRL-TAB-CCC SECTION.
       INI-SCRL-TAB-CCC.
           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM SCRL-ASCE
           ELSE
               PERFORM SCRL-DESC.
       FIN-SCRL-TAB-CCC.
           EXIT.

       SCRL-ASCE SECTION.
       INI-SCRL-ASCE.
           IF FRM-CAI-IOPD IN CCC-FLD(11) > SPACES OR
              FRM-IIC-IOPD IN CCC-FLD(11) > ZEROES
                MOVE FRM-CAI-IOPD IN CCC-FLD(11) TO
                     RCC-CAI-IOPD IN RCC
                MOVE FRM-IIC-IOPD IN CCC-FLD(11) TO
                     RCC-IIC-IOPD IN RCC
                MOVE SCR-CIC-ICLI TO RCC-CIC-ICLI
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM DAP-FIO-RCC
                MOVE FIO-GET-NXT TO FIO-CMND
                PERFORM DAP-FIO-RCC
                IF NOT FIO-STAT-OKS OR
                   SCR-CIC-ICLI NOT = RCC-CIC-ICLI IN RCC
                   PERFORM MSG-ASCE
                ELSE
                    MOVE 'NO' TO LEO
                    PERFORM PRO-RCC
           ELSE
                PERFORM MSG-ASCE.
       FIN-SCRL-ASCE.
           EXIT.

       MSG-ASCE SECTION.
       INI-MSG-ASCE.
           MOVE 'RCC    NONXT' TO MSG-COD-MENS.
           PERFORM MSG-ASDE.
       FIN-MSG-ASCE.
           EXIT.

       MSG-DESC SECTION.
       INI-MSG-DESC.
           MOVE 'RCC    NOPRV' TO MSG-COD-MENS.
           PERFORM MSG-ASDE.
       FIN-MSG-DESC.
           EXIT.

       MSG-ASDE SECTION.
       INI-MSG-ASDE.
           MOVE 'DAP' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-MSG-ASDE.
           EXIT.

       SCRL-DESC SECTION.
       INI-SCRL-DESC.
           IF FRM-CAI-IOPD IN CCC-FLD(1) > SPACES OR
              FRM-IIC-IOPD IN CCC-FLD(1) > ZEROES
                 MOVE FRM-CAI-IOPD IN CCC-FLD(1) TO
                                             RCC-CAI-IOPD IN RCC
                 MOVE FRM-IIC-IOPD IN CCC-FLD(1) TO
                                             RCC-IIC-IOPD IN RCC
                 MOVE SCR-CIC-ICLI TO RCC-CIC-ICLI
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM DAP-FIO-RCC
                 MOVE FIO-GET-PRV TO FIO-CMND
                 PERFORM DAP-FIO-RCC
                 IF NOT FIO-STAT-OKS OR
                    SCR-CIC-ICLI NOT = RCC-CIC-ICLI IN RCC
                    PERFORM MSG-DESC
                 ELSE
                    MOVE 'NO' TO LEO
                    PERFORM PRO-RCC-PREV
           ELSE
                PERFORM MSG-DESC.
       FIN-SCRL-DESC.
           EXIT.
      *>>>>
      *<<<< EOF
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
      *<<<< EOF
       PRO-RCC SECTION.
       INI-PRO-RCC.
           MOVE ZEROES TO WSS-TOT-OPER.
           MOVE ZEROES TO WSS-TOT-OPER-MTX.                             
           MOVE ZEROES TO WSS-TOT-LEYO-MTX.                             
           MOVE SPACES TO TS-CCC-OCC.                                   
       LUP-PRO-RCC.
                                                                        
                                                                        
           MOVE 'PAS1' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE RCC-CIC-IOPD IN RCC TO QUE-ITEM.                        
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE RCC-CIC-IOPD IN RCC TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               GO TO NXT-PRO-RCC.
                                                                        
                                                                        
           MOVE 'PAS2' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE TS-CCC-INP-FRM-COD-VREN  TO QUE-ITEM.                   
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           IF OPD-COD-MORE IN OPD = 'PI'                                
               MOVE OPD-FEC-FTER IN OPD TO OPD-FEC-FPVC IN OPD.         
                                                                        
           MOVE 'PAS3' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE SPACES       TO QUE-ITEM.                               
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           IF WSS-INI-BUSQ = 'N'                                        
           IF TS-CCC-INP-FRM-CAI-IOPD > SPACES                          
              IF TS-CCC-INP-FRM-CAI-IOPD NOT = OPD-CAI-IOPD IN OPD OR   
                 TS-CCC-INP-FRM-IIC-IOPD NOT = OPD-IIC-IOPD IN OPD      
                  GO TO NXT-PRO-RCC                                     
              ELSE                                                      
                   MOVE 'S' TO WSS-INI-BUSQ                             
                   GO TO NXT-PRO-RCC.                                   
                                                                        
           MOVE 'PAS4' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE SPACES       TO QUE-ITEM.                               
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           IF TS-CCC-INP-FRM-COD-VCAM > SPACES AND                      
              TS-CCC-INP-FRM-COD-VCAM NOT = OPD-COD-VCAM IN OPD         
               GO TO NXT-PRO-RCC.                                       
                                                                        
           MOVE 'PAS5' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE SPACES       TO QUE-ITEM.                               
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           IF TS-CCC-INP-FRM-COD-RENT NOT = 'S'                         
               IF TS-CCC-INP-FRM-COD-STAT > SPACES AND                  
                  TS-CCC-INP-FRM-COD-STAT NOT = OPD-COD-STAT IN OPD     
                  GO TO NXT-PRO-RCC.                                    
                                                                        
           MOVE 'PAS6' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE OPD-COD-STAT IN OPD       TO QUE-ITEM.                  
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
      * CUANDO ES CONSULTA POR RENTABILIDAD FILTRA 'G' Y 'L' OR 'S'     
           IF TS-CCC-INP-FRM-COD-RENT = 'S'                             
                IF NOT                                                  
                    ( OPD-COD-STAT IN OPD = 'G' OR                      
                      OPD-COD-STAT IN OPD = 'S' OR                      
                      OPD-COD-STAT IN OPD = 'L' )                       
                  GO TO NXT-PRO-RCC.                                    
                                                                        
                                                                        
           MOVE 'PAS7' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE SPACES       TO QUE-ITEM.                               
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           IF TS-CCC-INP-FRM-COD-TOPD > SPACES AND                      
              TS-CCC-INP-FRM-COD-TOPD NOT = OPD-COD-TOPD IN OPD         
               GO TO NXT-PRO-RCC.                                       
                                                                        
           IF TS-CCC-INP-FRM-COD-AOPD > SPACES AND                      
              TS-CCC-INP-FRM-COD-AOPD NOT = OPD-COD-AOPD IN OPD         
               GO TO NXT-PRO-RCC.                                       
                                                                        
           MOVE 'PAS8' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE SPACES       TO QUE-ITEM.                               
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
      * CUANDO ES CONSULTA POR RENTABILIDAD NO FILTRA                   
           IF TS-CCC-INP-FRM-COD-RENT NOT = 'S'                         
               IF ( WSS-FEC-FDES > SPACES   AND                         
                    WSS-FEC-FHAS > SPACES     )  AND                    
                  ( OPD-FEC-FREA IN OPD < WSS-FEC-FDES OR               
                    OPD-FEC-FREA IN OPD > WSS-FEC-FHAS )                
                   GO TO NXT-PRO-RCC.                                   
                                                                        
           MOVE 'PAS9' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE SPACES       TO QUE-ITEM.                               
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE OPD-CIC-IOPD IN OPD TO VEN-CIC-IOPD IN VEN.             
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM DAP-FIO-VEN.                                         
           MOVE FIO-STAT TO PGM-STAT-VEN.                               
                                                                        
                                                                        
           MOVE 'FINR' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE WSS-FEC-FINR TO QUE-ITEM.                               
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           MOVE 'FFIR' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE WSS-FEC-FFIR TO QUE-ITEM.                               
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           MOVE 'FREA' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
           MOVE +12 TO QUE-LITM.                                        
           MOVE OPD-FEC-FREA IN OPD TO QUE-ITEM.                        
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           IF TS-CCC-INP-FRM-COD-RENT = 'S'                             
                IF NOT                                                  
                    (                                                   
                       (                                                
                         (                                              
                           OPD-FEC-FREA IN OPD NOT < WSS-FEC-FINR AND   
                           OPD-FEC-FREA IN OPD <     WSS-FEC-FFIR       
                          )                                             
                          OR                                            
                         ( OPD-FEC-FTER IN OPD >     WSS-FEC-FINR AND   
                           OPD-FEC-FTER IN OPD NOT > WSS-FEC-FFIR       
                         )                                              
                       )                                                
                       OR                                               
                       (                                                
                         OPD-FEC-FREA IN OPD < WSS-FEC-FINR AND         
                         OPD-FEC-FTER IN OPD > WSS-FEC-FFIR             
                       )                                                
                    )                                                   
                    MOVE 'SAL1' TO QUE-COLA                             
                    MOVE QUE-DEL TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                    MOVE +12 TO QUE-LITM                                
                    MOVE SPACES       TO QUE-ITEM                       
                    MOVE QUE-PUT TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                                                                        
               GO TO NXT-PRO-RCC.                                       
                                                                        
           IF SCR-CMND = 'CON'                                          
           IF  NOT (  OPD-COD-STAT IN OPD = 'G' OR 
                      ( OPD-COD-STAT IN OPD = 'L' AND
                        OPD-COD-SCTB = 'VCD' AND
                        OPD-COD-RENO IN OPD = 'N'
                      )
                  )
                    MOVE 'SAL2' TO QUE-COLA                             
                    MOVE QUE-DEL TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                    MOVE +12 TO QUE-LITM                                
                    MOVE SPACES       TO QUE-ITEM                       
                    MOVE QUE-PUT TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
               GO TO NXT-PRO-RCC.
                                                                        
                                                                        
      *     IF SCR-CMND = 'CTO'                                         
      *        NADA                                                     
                                                                        
                                                                        
           IF SCR-CMND = 'CGA'                                          
              IF  NOT ( OPD-COD-STAT IN OPD = 'G' OR                    
                        OPD-COD-STAT IN OPD = 'A' )                     
               GO TO NXT-PRO-RCC.                                       
                                                                        
                                                                        
           ADD 1 TO WSS-TOT-OPER.
           ADD 1 TO WSS-TOT-OPER-MTX.                                   
           ADD 1 TO WSS-TOT-LEYO-MTX.                                   
           IF WSS-TOT-OPER < 12
               PERFORM PUT-ELM
           ELSE
               IF NOT LEO-TODOS
                   GO TO END-PRO-RCC.

           IF LEO-TODOS
               PERFORM PRO-TOT.

       NXT-PRO-RCC.
           IF WSS-TOT-LEYO-MTX > 40                                     
               MOVE 'S' TO WSS-IND-HMAS.                                
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC
           MOVE RCC-CAI-IOPD IN RCC TO WSS-RCC-CAI-IOPD-01              
                                                                        
           IF FIO-STAT-OKS  AND                                         
              SCR-CIC-ICLI = RCC-CIC-ICLI IN RCC AND                    
              ( WSS-RCC-CAI-IOPD-01 = '0' OR                            
                WSS-RCC-CAI-IOPD-01 = 'Z' )                             
               GO TO LUP-PRO-RCC.                                       
                                                                        
              IF WSS-BUS-BDP = 'N'                                      
                 MOVE 'S' TO WSS-BUS-BDP                                
                 IF WSS-DBIM > ZEROES AND                               
                    WSS-DBIP > ZEROES                                   
                    PERFORM INV-BD                                      
                                                                        
                   MOVE SCR-CIC-ICLI TO RCC-CIC-ICLI IN RCC             
                   MOVE SPACES TO RCC-CAI-IOPD IN RCC                   
                   MOVE ZEROES TO RCC-IIC-IOPD IN RCC                   
                   MOVE FIO-GET-NLS TO FIO-CMND                         
                   PERFORM DAP-FIO-RCC                                  
           IF FIO-STAT-OKS AND
              SCR-CIC-ICLI = RCC-CIC-ICLI IN RCC
               GO TO LUP-PRO-RCC.

       END-PRO-RCC.
           IF WSS-TOT-OPER = 0
              PERFORM MSG-ASCE
              GO TO FIN-PRO-RCC.
           IF WSS-TOT-OPER > 0 AND
              WSS-TOT-OPER < 12
               MOVE 'DAP'          TO MSG-COD-SIST
               MOVE 'CLI    N+OPD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2
           ELSE
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'CLI    DGPF6' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
           ADD 1 TO WSS-TOT-OPER.
           PERFORM CLR-TBL-CCC VARYING FRM-IFLD FROM WSS-TOT-OPER BY 1
                        UNTIL FRM-IFLD > 11.
       FIN-PRO-RCC.
           EXIT.

       PRO-RCC-PREV SECTION.
       INI-PRO-RCC-PREV.
           MOVE ZEROES TO WSS-TOT-OPER.
       LUP-PRO-RCC-PREV.
           MOVE RCC-CIC-IOPD IN RCC TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               GO TO NXT-PRO-RCC-PREV.
           IF  NOT (  OPD-COD-STAT IN OPD = 'G' OR 
                      ( OPD-COD-STAT IN OPD = 'L' AND
                        OPD-COD-SCTB = 'VCD' AND
                        OPD-COD-RENO IN OPD = 'N'
                      )
                  )
           ADD 1 TO WSS-TOT-OPER.
           IF OPD-COD-MORE IN OPD = 'PI'                                
               MOVE OPD-FEC-FTER IN OPD TO OPD-FEC-FPVC IN OPD.         
                                                                        
           IF WSS-TOT-OPER < 12
               SUBTRACT 12 FROM WSS-TOT-OPER GIVING WSS-J
               PERFORM PUT-ELM-PREV
           ELSE
               IF NOT LEO-TODOS
                   GO TO END-PRO-RCC-PREV.

           IF LEO-TODOS
               PERFORM PRO-TOT.

       NXT-PRO-RCC-PREV.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM DAP-FIO-RCC
           IF FIO-STAT-OKS AND
              SCR-CIC-ICLI = RCC-CIC-ICLI IN RCC
               GO TO LUP-PRO-RCC-PREV.
       END-PRO-RCC-PREV.
           IF WSS-TOT-OPER = 0
              PERFORM MSG-DESC
              GO TO FIN-PRO-RCC-PREV.
           ADD 1 TO WSS-TOT-OPER.
           PERFORM CLR-TBL-CCC VARYING FRM-IFLD FROM WSS-TOT-OPER BY 1
                        UNTIL FRM-IFLD > 11.
       FIN-PRO-RCC-PREV.
           EXIT.

       CLR-PROD SECTION.                                                
       INI-CLR-PROD.                                                    
           MOVE ZEROES TO WSS-PROD-TOTA IN WSS-PROD(WSS-IDX-PROD).      
       FIN-CLR-PROD.                                                    
           EXIT.                                                        
                                                                        
       FIN-CLR-PROD.                                                    
           EXIT.                                                        
       PRO-TOT SECTION.
       INI-PRO-TOT.
           MOVE 'N' TO WSS-IND-MONE.
           PERFORM PRO-MONE-TOT VARYING WSS-NUM-MONE FROM 1 BY 1
                   UNTIL WSS-NUM-MONE > WSS-TOT-MONE OR
                         WSS-IND-MONE = 'S'.

           IF WSS-IND-MONE = 'N'
               ADD 1 TO WSS-TOT-MONE
               MOVE WSS-TOT-MONE TO WSS-IDX-MONE.

           ADD OPD-VAL-CAPT IN OPD TO
                   FRM-VAL-TOTA IN CCC-FLD(WSS-IDX-MONE).
           MOVE OPD-COD-VCAM IN OPD TO
                   FRM-GLS-TOTA IN CCC-FLD(WSS-IDX-MONE).

           MOVE 'N' TO WSS-IND-PROD.                                    
           PERFORM PRO-PROD-TOT VARYING WSS-NUM-PROD FROM 1 BY 1        
                   UNTIL WSS-NUM-PROD > WSS-TOT-PROD OR                 
                         WSS-IND-PROD = 'S'.                            
                                                                        
           IF WSS-IND-PROD = 'N'                                        
               ADD 1 TO WSS-TOT-PROD                                    
               MOVE WSS-TOT-PROD TO WSS-IDX-PROD.                       
                                                                        
           ADD OPD-VAL-CAPT IN OPD TO                                   
                   WSS-PROD-TOTA IN WSS-PROD(WSS-IDX-PROD).             
           MOVE OPD-COD-VCAM IN OPD TO                                  
              WSS-PROD-VCAM IN WSS-PROD(WSS-IDX-PROD).                  
           MOVE OPD-COD-TOPD IN OPD TO                                  
              WSS-PROD-TOPD IN WSS-PROD(WSS-IDX-PROD).                  
           MOVE OPD-COD-AOPD IN OPD TO                                  
              WSS-PROD-AOPD IN WSS-PROD(WSS-IDX-PROD).                  
                                                                        
       FIN-PRO-TOT.
           EXIT.

       CLR-TBL-CCC SECTION.
       INI-CLR-TBL-CCC.
           MOVE SPACES TO FRM-CAI-IOPD IN CCC-FLD(FRM-IFLD).
           MOVE ZEROES TO FRM-IIC-IOPD IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-IND-VENC IN CCC-FLD(FRM-IFLD).
           MOVE ZEROES TO FRM-VAL-CAPT IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-DMA-FREA IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-DMA-FPVC IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-VCAM IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-COPD IN CCC-FLD(FRM-IFLD).
       FIN-CLR-TBL-CCC.
           EXIT.

       PUT-ELM SECTION.
       INI-PUT-ELM.
           IF SCR-OFRM-SRV                                              
               MOVE 1 TO WSS-TOT-OPER.                                  
           MOVE OPD-CAI-IOPD TO FRM-CAI-IOPD IN CCC-FLD(WSS-TOT-OPER).
           MOVE OPD-IIC-IOPD TO FRM-IIC-IOPD IN CCC-FLD(WSS-TOT-OPER).
           IF  OPD-COD-STAT IN OPD = 'L' AND
               OPD-COD-SCTB = 'VCD' AND
               OPD-COD-RENO IN OPD = 'N'
                  MOVE 'V' TO FRM-IND-VENC IN CCC-FLD(WSS-TOT-OPER)
               ELSE
                  MOVE ' ' TO FRM-IND-VENC IN CCC-FLD(WSS-TOT-OPER).
           MOVE OPD-VAL-CAPT TO FRM-VAL-CAPT IN CCC-FLD(WSS-TOT-OPER).
           MOVE OPD-NUM-DREA TO FRM-NUM-DREA IN CCC-FLD(WSS-TOT-OPER).
           MOVE OPD-NUM-MREA TO FRM-NUM-MREA IN CCC-FLD(WSS-TOT-OPER).
           MOVE OPD-NUM-AREA TO FRM-NUM-AREA IN CCC-FLD(WSS-TOT-OPER).
                                                                        
           MOVE OPD-NUM-DREA TO WSS-NUM-DREA.                           
           MOVE OPD-NUM-MREA TO WSS-NUM-MREA.                           
           MOVE OPD-NUM-SREA TO WSS-NUM-SREA.                           
           MOVE OPD-NUM-AREA TO WSS-NUM-AREA.                           
                                                                        
           MOVE OPD-NUM-DTER TO WSS-NUM-DTER.                           
           MOVE OPD-NUM-MTER TO WSS-NUM-MTER.                           
           MOVE OPD-NUM-STER TO WSS-NUM-STER.                           
           MOVE OPD-NUM-ATER TO WSS-NUM-ATER.                           
                                                                        
           MOVE OPD-NUM-DPVC TO FRM-NUM-DPVC IN CCC-FLD(WSS-TOT-OPER).
           MOVE OPD-NUM-MPVC TO FRM-NUM-MPVC IN CCC-FLD(WSS-TOT-OPER).
           MOVE OPD-NUM-APVC TO FRM-NUM-APVC IN CCC-FLD(WSS-TOT-OPER).
                                                                        
           MOVE OPD-NUM-DPVC TO WSS-NUM-DPVC.                           
           MOVE OPD-NUM-MPVC TO WSS-NUM-MPVC.                           
           MOVE OPD-NUM-SPVC TO WSS-NUM-SPVC.                           
           MOVE OPD-NUM-APVC TO WSS-NUM-APVC.                           
                                                                        
                                                                        
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
                                                                        
           IF OPD-COD-VCAM IN OPD = '0999'                              
               IF WSS-GLS-DCOR-0999 NOT = SPACES                        
                   MOVE WSS-GLS-DCOR-0999 TO TAB-GLS-DCOR               
               ELSE                                                     
                   PERFORM BUS-TAB                                      
                   MOVE TAB-GLS-DCOR TO WSS-GLS-DCOR-0999               
           ELSE                                                         
           IF OPD-COD-VCAM IN OPD = '0998'                              
               IF WSS-GLS-DCOR-0998 NOT = SPACES                        
                   MOVE WSS-GLS-DCOR-0998 TO TAB-GLS-DCOR               
               ELSE                                                     
                   PERFORM BUS-TAB                                      
                   MOVE TAB-GLS-DCOR TO WSS-GLS-DCOR-0998               
           ELSE                                                         
           IF OPD-COD-VCAM IN OPD = '1013'                              
               IF WSS-GLS-DCOR-1013 NOT = SPACES                        
                   MOVE WSS-GLS-DCOR-1013 TO TAB-GLS-DCOR               
               ELSE                                                     
                   PERFORM BUS-TAB                                      
                   MOVE TAB-GLS-DCOR TO WSS-GLS-DCOR-1013               
           ELSE                                                         
           IF OPD-COD-VCAM IN OPD = '1142'                              
               IF WSS-GLS-DCOR-1142 NOT = SPACES                        
                   MOVE WSS-GLS-DCOR-1142 TO TAB-GLS-DCOR               
               ELSE                                                     
                   PERFORM BUS-TAB                                      
                   MOVE TAB-GLS-DCOR TO WSS-GLS-DCOR-1142               
           ELSE                                                         
           PERFORM BUS-TAB.
                                                                        
                                                                        
           MOVE TAB-GLS-DCOR TO FRM-GLS-VCAM IN CCC-FLD(WSS-TOT-OPER).
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.                    

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-TOPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR TO WSS-GLS-TOPD.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-COPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR TO WSS-GLS-AOPD.

           MOVE WSS-GLS-COPD TO FRM-GLS-COPD IN CCC-FLD(WSS-TOT-OPER).
           IF SCR-OFRM-SRV                                              
                PERFORM BUS-CCC-MTX                                     
                IF WSS-TOT-OPER-MTX = 5                                 
                    PERFORM PUT-TS-OCC.                                 
       FIN-PUT-ELM.
           EXIT.
                                                                        
       PUT-TS-OCC SECTION.                                              
       INI-PUT-TS-OCC.                                                  
           MOVE TS-CCC-TYPE-OCC TO QUE-TYPE.                            
           MOVE TSK-TERM-ALF    TO QUE-TERM.                            
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
           IF WSS-TOT-PUT-TS-OCC = ZEROES                               
               MOVE QUE-DEL TO QUE-CMND                                 
               PERFORM GNS-PRO-QUE.                                     
           MOVE TS-CCC-LITM-OCC TO QUE-LITM.                            
           MOVE TS-CCC-OCC TO QUE-ITEM.                                 
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNS-PRO-QUE.                                         
           ADD 1 TO WSS-TOT-PUT-TS-OCC.                                 
           MOVE ZEROES TO WSS-TOT-OPER-MTX.                             
           MOVE SPACES TO TS-CCC-OCC.                                   
           MOVE 'N' TO WSS-PUT-TS-OCC.                                  
       FIN-PUT-TS-OCC.                                                  
           EXIT.                                                        
                                                                        
       BUS-CCC-MTX SECTION.                                             
       INI-BUS-CCC-MTX.                                                 
                                                                        
           IF   WSS-TOT-LEYO-MTX > 40                                   
           MOVE 40               TO                                     
                TS-CCC-FRM-NUM-TOCC-NUM                                 
           ELSE                                                         
           MOVE WSS-TOT-LEYO-MTX TO                                     
                TS-CCC-FRM-NUM-TOCC-NUM.                                
                                                                        
           MOVE        FRM-CAI-IOPD IN    CCC-FLD(WSS-TOT-OPER) TO      
            TS-CCC-OCC-FRM-CAI-IOPD IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        FRM-IIC-IOPD IN    CCC-FLD(WSS-TOT-OPER) TO      
            TS-CCC-OCC-FRM-IIC-IOPD IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        FRM-IND-VENC IN    CCC-FLD(WSS-TOT-OPER) TO      
            TS-CCC-OCC-FRM-IND-VENC IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        FRM-GLS-COPD IN    CCC-FLD(WSS-TOT-OPER) TO      
            TS-CCC-OCC-FRM-GLS-COPD IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        OPD-COD-TOPD IN OPD TO                           
            TS-CCC-OCC-FRM-COD-TOPD IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        WSS-GLS-TOPD TO                                  
            TS-CCC-OCC-FRM-GLS-TOPD IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        OPD-COD-AOPD IN OPD TO                           
            TS-CCC-OCC-FRM-COD-AOPD IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        WSS-GLS-AOPD TO                                  
            TS-CCC-OCC-FRM-GLS-AOPD IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        WSS-FEC-FREA TO                                  
            TS-CCC-OCC-FRM-FEC-FREA IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        WSS-FEC-FPVC TO                                  
            TS-CCC-OCC-FRM-FEC-FPVC IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
                                                                        
           MOVE        WSS-FEC-FPVC TO WSS-FEC-FLIQ.                    
                                                                        
           MOVE         FRM-VAL-CAPT IN    CCC-FLD(WSS-TOT-OPER) TO     
                WSS-EDT-FRM-VAL-CAPT.                                   
           MOVE WSS-EDT-FRM-VAL-CAPT TO                                 
             TS-CCC-OCC-FRM-VAL-CAPT IN TS-CCC-OCC(WSS-TOT-OPER-MTX).   
                                                                        
           MOVE        OPD-COD-VCAM IN OPD TO                           
            TS-CCC-OCC-FRM-COD-VCAM IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        FRM-GLS-VCAM IN CCC-FLD(WSS-TOT-OPER) TO         
            TS-CCC-OCC-FRM-GLS-VCAM IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE          OPD-VAL-IPES IN OPD TO                         
                 WSS-EDT-FRM-VAL-CAPP.                                  
            MOVE WSS-EDT-FRM-VAL-CAPP TO                                
              TS-CCC-OCC-FRM-VAL-CAPP IN TS-CCC-OCC(WSS-TOT-OPER-MTX).  
                                                                        
           IF NOT PGM-STAT-VEN-OKS                                      
                MOVE ZEROES TO WSS-VEN-VAL-FINA                         
                MOVE ZEROES TO                                          
                           WSS-EDT-FRM-VAL-FORI                         
                MOVE       WSS-EDT-FRM-VAL-FORI TO                      
                        TS-CCC-OCC-FRM-VAL-FORI                         
                      IN TS-CCC-OCC(WSS-TOT-OPER-MTX)                   
                                                                        
                MOVE ZEROES TO WSS-FRM-VAL-FPES                         
                                                                        
                MOVE ZEROES TO                                          
                         WSS-EDT-FRM-VAL-FPES                           
                MOVE     WSS-EDT-FRM-VAL-FPES TO                        
                      TS-CCC-OCC-FRM-VAL-FPES                           
                      IN TS-CCC-OCC(WSS-TOT-OPER-MTX)                   
                                                                        
            ELSE                                                        
                PERFORM BUS-FORI-PI                                     
                                                                        
                                                                        
                MOVE VEN-VAL-FINA IN VEN TO                             
                           WSS-EDT-FRM-VAL-FORI                         
                MOVE       WSS-EDT-FRM-VAL-FORI TO                      
                     TS-CCC-OCC-FRM-VAL-FORI IN                         
                     TS-CCC-OCC(WSS-TOT-OPER-MTX)                       
                                                                        
                MOVE VEN-VAL-FINA IN VEN TO WSS-VEN-VAL-FINA            
                                                                        
                IF WSS-CIC-TVAL = PDB-CIC-MEXT                          
                         MOVE ZEROES TO                                 
                         WSS-EDT-FRM-VAL-FPES                           
                MOVE     WSS-EDT-FRM-VAL-FPES TO                        
                      TS-CCC-OCC-FRM-VAL-FPES IN                        
                          TS-CCC-OCC(WSS-TOT-OPER-MTX)                  
                                                                        
                          MOVE ZEROES TO WSS-FRM-VAL-FPES               
                ELSE                                                    
                IF WSS-CIC-VCAM = PDB-CIC-0999                          
                                                                        
                   MOVE          VEN-VAL-FINA IN VEN TO                 
                             WSS-FRM-VAL-FPES                           
                                                                        
                                                                        
                                                                        
                   MOVE          VEN-VAL-FINA IN VEN TO                 
                         WSS-EDT-FRM-VAL-FPES                           
                MOVE     WSS-EDT-FRM-VAL-FPES TO                        
                       TS-CCC-OCC-FRM-VAL-FPES IN                       
                       TS-CCC-OCC(WSS-TOT-OPER-MTX)                     
                ELSE                                                    
                     MOVE 1 TO WSS-SGV-VCAM                             
                     PERFORM LEE-VCAM                                   
                     IF MSG-COD-MENS > SPACES                           
                         MOVE ZEROES TO WSS-FRM-VAL-FPES                
                                                                        
                                                                        
                                                                        
                         MOVE ZEROES TO                                 
                         WSS-EDT-FRM-VAL-FPES                           
                MOVE     WSS-EDT-FRM-VAL-FPES TO                        
                           TS-CCC-OCC-FRM-VAL-FPES IN                   
                          TS-CCC-OCC(WSS-TOT-OPER-MTX)                  
                     ELSE                                               
                                                                        
                                                                        
                         MULTIPLY VEN-VAL-FINA IN VEN BY                
                           WSS-SGV-VCAM GIVING                          
                         WSS-FRM-VAL-FPES                               
                                                                        
                                                                        
                         MULTIPLY VEN-VAL-FINA IN VEN BY                
                           WSS-SGV-VCAM GIVING                          
                         WSS-EDT-FRM-VAL-FPES                           
                                                                        
                                                                        
                MOVE     WSS-EDT-FRM-VAL-FPES TO                        
                           TS-CCC-OCC-FRM-VAL-FPES IN                   
                          TS-CCC-OCC(WSS-TOT-OPER-MTX)                  
                          PERFORM AJUSTA-FPES.                          
                                                                        
      *NVA MOVE OPD-CAI-ISER IN OPD TO                                  
      *NVA  TS-CCC-OCC-FRM-CAI-ISER IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
      *NVA MOVE OPD-IIC-ISER IN OPD TO                                  
      *NVA      TS-CCC-OCC-FRM-IIC-ISER IN TS-CCC-OCC(WSS-TOT-OPER-MTX).
                                                                        
           MOVE OPD-COD-STAT IN OPD TO                                  
            TS-CCC-OCC-FRM-COD-STAT IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE OPD-COD-CUST IN OPD TO                                  
            TS-CCC-OCC-FRM-COD-CUST IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE OPD-COD-GARA IN OPD TO                                  
            TS-CCC-OCC-FRM-COD-COND IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE OPD-SGV-TINT IN OPD TO                                  
                         WSS-EDT-FRM-SGV-TINT                           
                MOVE     WSS-EDT-FRM-SGV-TINT TO                        
            TS-CCC-OCC-FRM-SGV-TINT IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
      *NVA MOVE OPD-COD-OFIC IN OPD TO                                  
      *NVA  TS-CCC-OCC-OPD-COD-OFIC IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
      *NVA MOVE OPD-COD-OFIC IN OPD TO OFI-COD-OFIC IN OFI.             
      *NVA PERFORM BUS-OFI.                                             
      *NVA MOVE OFI-GLS-DESC IN OFI TO                                  
      *NVA  TS-CCC-OCC-FRM-GLS-OFIC IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
      * busqueda glosa tasa interes asociada a la plantilla             
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'INT' TO TAB-COD-TTAB IN TAB.                           
           MOVE OPD-COD-TINT IN OPD TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DESC IN TAB TO                                  
            TS-CCC-OCC-FRM-GLS-TINT IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE OPD-COD-IONP IN OPD TO                                  
            TS-CCC-OCC-FRM-COD-CONP IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           IF OPD-COD-RENO IN OPD = 'S'                                 
                PERFORM VAL-PER-REN                                     
           ELSE                                                         
               MOVE 'N' TO                                              
               TS-CCC-OCC-FRM-COD-CLIQ IN TS-CCC-OCC(WSS-TOT-OPER-MTX). 
                                                                        
      *NVA MOVE OPD-CIC-IOPD IN OPD TO DCD-CIC-IOPD IN DCD.             
      *NVA MOVE FIO-GET-KEY TO FIO-CMND.                                
      *NVA PERFORM DAP-FIO-DCD.                                         
      *NVA IF FIO-STAT-OKS                                              
      *NVA     MOVE DCD-KEY-NOV1 IN DCD TO                              
      *NVA          TS-CCC-OCC-FRM-KEY-NOV1 IN                          
      *NVA          TS-CCC-OCC(WSS-TOT-OPER-MTX)                        
      *NVA     MOVE DCD-KEY-NOV2 IN DCD TO                              
      *NVA          TS-CCC-OCC-FRM-KEY-NOV2 IN                          
      *NVA          TS-CCC-OCC(WSS-TOT-OPER-MTX).                       
                                                                        
           MOVE OPD-CIC-IOPD IN OPD TO LIQ-CIC-IOPD IN LIQ.             
           MOVE LIQ-CAI-IOPD IN LIQ TO WSC-LIQ-CAI-IOPD.                
           MOVE LIQ-IIC-IOPD IN LIQ TO WSC-LIQ-IIC-IOPD.                
           PERFORM BUS-COR-LIQ.                                         
           IF FIO-STAT-OKS AND                                          
              LIQ-COD-LIQU IN LIQ = 'RC' AND                            
              LIQ-FEC-FREA IN LIQ > HOY-FHOY                            
                 MOVE 'N' TO TS-CCC-OCC-FRM-COD-CSLA                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                 MOVE 'S' TO TS-CCC-OCC-FRM-IND-CSLA                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                                                                        
                MOVE LIQ-NUM-DREA IN LIQ TO WSS-NUM-DLIQ                
                MOVE LIQ-NUM-MREA IN LIQ TO WSS-NUM-MLIQ                
                MOVE LIQ-NUM-SREA IN LIQ TO WSS-NUM-SLIQ                
                MOVE LIQ-NUM-AREA IN LIQ TO WSS-NUM-ALIQ                
                MOVE WSS-FEC-FLIQ TO TS-CCC-OCC-FRM-FEC-FLQP            
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                                                                        
                 MOVE 'S' TO TS-CCC-OCC-FRM-IND-CSLA                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                                                                        
                MOVE LIQ-SGV-TPAG IN LIQ TO                             
                           WSS-EDT-FRM-VAL-VFMP                         
                MOVE       WSS-EDT-FRM-VAL-VFMP TO                      
                     TS-CCC-OCC-FRM-VAL-VFMP IN                         
                     TS-CCC-OCC(WSS-TOT-OPER-MTX)                       
                                                                        
                MOVE LIQ-SGV-PESO IN LIQ TO                             
                           WSS-EDT-FRM-VAL-VFPP                         
                MOVE       WSS-EDT-FRM-VAL-VFPP TO                      
                     TS-CCC-OCC-FRM-VAL-VFPP IN                         
                     TS-CCC-OCC(WSS-TOT-OPER-MTX)                       
                                                                        
                                                                        
           ELSE                                                         
                                                                        
                MOVE WSS-VEN-VAL-FINA  TO                               
                           WSS-EDT-FRM-VAL-VFMP                         
                MOVE       WSS-EDT-FRM-VAL-VFMP TO                      
                     TS-CCC-OCC-FRM-VAL-VFMP IN                         
                     TS-CCC-OCC(WSS-TOT-OPER-MTX)                       
                                                                        
                MOVE WSS-FRM-VAL-FPES TO                                
                           WSS-EDT-FRM-VAL-VFPP                         
                MOVE       WSS-EDT-FRM-VAL-VFPP TO                      
                     TS-CCC-OCC-FRM-VAL-VFPP IN                         
                     TS-CCC-OCC(WSS-TOT-OPER-MTX)                       
                                                                        
                MOVE WSS-FEC-FLIQ TO TS-CCC-OCC-FRM-FEC-FLQP            
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                                                                        
                 MOVE 'S' TO TS-CCC-OCC-FRM-COD-CSLA                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                 MOVE 'N' TO TS-CCC-OCC-FRM-IND-CSLA                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE OPD-NUM-PVEN IN OPD TO                                  
            TS-CCC-OCC-OPD-NUM-PVEN-NUM IN TS-CCC-OCC(WSS-TOT-OPER-MTX).
                                                                        
           MOVE OPD-IND-PVEN IN OPD TO                                  
            TS-CCC-OCC-OPD-IND-PVEN IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           ADD OPD-NUM-VNLQ IN OPD TO                                   
               OPD-NUM-VSLQ IN OPD GIVING                               
            TS-CCC-OCC-FRM-NUM-TVEN-NUM IN TS-CCC-OCC(WSS-TOT-OPER-MTX).
                                                                        
           MOVE OPD-NUM-DURV IN OPD TO                                  
            TS-CCC-OCC-OPD-NUM-DURV-NUM IN TS-CCC-OCC(WSS-TOT-OPER-MTX).
                                                                        
           MOVE OPD-IND-DURV IN OPD TO                                  
            TS-CCC-OCC-OPD-IND-DURV IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE        WSS-FEC-FTER TO                                  
            TS-CCC-OCC-OPD-FEC-FTER IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE OPD-NUM-SEVE IN OPD TO                                  
            TS-CCC-OCC-OPD-NUM-SEVE-NUM IN TS-CCC-OCC(WSS-TOT-OPER-MTX).
                                                                        
           MOVE OPD-IND-SEVE IN OPD TO                                  
            TS-CCC-OCC-OPD-IND-SEVE IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE OPD-COD-MORE IN OPD TO                                  
            TS-CCC-OCC-OPD-COD-MORE IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE OPD-SGV-MPRE IN OPD TO                                  
                           WSS-EDT-OPD-SGV-MPRE                         
           MOVE       WSS-EDT-OPD-SGV-MPRE TO                      
                     TS-CCC-OCC-OPD-SGV-MPRE IN                         
                     TS-CCC-OCC(WSS-TOT-OPER-MTX)                       
                                                                        
           MOVE OPD-COD-SCTB IN OPD TO                                  
            TS-CCC-OCC-OPD-COD-SCTB IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE OPD-COD-AFER IN OPD TO                                  
            TS-CCC-OCC-OPD-COD-AFER IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
                                                                        
           MOVE OPD-NUM-IVEN IN OPD TO                                  
            TS-CCC-OCC-OPD-NUM-IVEN-NUM IN TS-CCC-OCC(WSS-TOT-OPER-MTX).
                                                                        
      * PUEDE PROGRAMAR                                                 
                                                                        
                                                                        
                                                                        
           MOVE 'N' TO TS-CCC-OCC-FRM-COD-CIN2                          
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           MOVE 'N' TO TS-CCC-OCC-FRM-IND-CIN2                          
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
      * INDICA QUE NUNCA TIENE PROGRAMADO UNA LIQ DE RENOV              
      * EN PERIODO DE RENOVACION ( NO ES EVENTO, ES ESTADO )            
           MOVE 'N' TO TS-CCC-OCC-FRM-IND-CLIQ                          
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
         
           IF OPD-COD-STAT IN OPD NOT = 'G' OR                          
              OPD-FEC-FTER IN OPD NOT > HOY-FHOY                        
                 MOVE 'N' TO TS-CCC-OCC-FRM-COD-CRDF                    
                                  IN TS-CCC-OCC(WSS-TOT-OPER-MTX)       
                 MOVE 'N' TO TS-CCC-OCC-FRM-IND-CRDF                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                 MOVE 'N' TO TS-CCC-OCC-FRM-COD-CLQF                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                 MOVE 'N' TO TS-CCC-OCC-FRM-IND-CLQF                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                 MOVE 'N' TO TS-CCC-OCC-FRM-COD-CIN1                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                 MOVE 'N' TO TS-CCC-OCC-FRM-IND-CIN1                    
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                 GO TO NO-VRF-EPD.                                      
                                                                        
                                                                        
           IF OPD-COD-RENO IN OPD = 'S'                                 
               MOVE 'N' TO TS-CCC-OCC-FRM-COD-CRDF                      
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
               MOVE 'N' TO TS-CCC-OCC-FRM-IND-CRDF                      
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
           ELSE                                                         
               MOVE 'RDF'               TO EPD-COD-IEPD IN EPD          
               PERFORM BUS-COR-EPD                                      
                                                                        
                                                                        
               IF FIO-STAT-OKS                                          
                   MOVE 'N' TO TS-CCC-OCC-FRM-COD-CRDF                  
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                   MOVE 'S' TO TS-CCC-OCC-FRM-IND-CRDF                  
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
               ELSE                                                     
                   MOVE 'S' TO TS-CCC-OCC-FRM-COD-CRDF                  
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                   MOVE 'N' TO TS-CCC-OCC-FRM-IND-CRDF                  
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
           IF OPD-COD-RENO IN OPD = 'S'                                 
               MOVE 'N' TO TS-CCC-OCC-FRM-COD-CLQF                      
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
               MOVE 'N' TO TS-CCC-OCC-FRM-IND-CLQF                      
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
           ELSE                                                         
               IF OPD-COD-CUST IN OPD = 'E'                             
                   IF OPD-COD-MORE IN OPD NOT = 'N'                     
                       MOVE 'N' TO TS-CCC-OCC-FRM-COD-CLQF              
                                     IN TS-CCC-OCC(WSS-TOT-OPER-MTX)    
                       MOVE 'N' TO TS-CCC-OCC-FRM-IND-CLQF              
                                     IN TS-CCC-OCC(WSS-TOT-OPER-MTX)    
                   ELSE                                                 
                       MOVE 'LQF'  TO EPD-COD-IEPD IN EPD               
                       PERFORM BUS-COR-EPD                              
                       IF FIO-STAT-OKS                                  
                            MOVE 'N' TO TS-CCC-OCC-FRM-COD-CLQF         
                                     IN TS-CCC-OCC(WSS-TOT-OPER-MTX)    
                            MOVE 'S' TO TS-CCC-OCC-FRM-IND-CLQF         
                                     IN TS-CCC-OCC(WSS-TOT-OPER-MTX)    
                       ELSE                                             
                            MOVE 'S' TO TS-CCC-OCC-FRM-COD-CLQF         
                                     IN TS-CCC-OCC(WSS-TOT-OPER-MTX)    
                            MOVE 'N' TO TS-CCC-OCC-FRM-IND-CLQF         
                                     IN TS-CCC-OCC(WSS-TOT-OPER-MTX)    
                ELSE                                                    
                    MOVE 'N' TO TS-CCC-OCC-FRM-COD-CLQF                 
                                     IN TS-CCC-OCC(WSS-TOT-OPER-MTX)    
                    MOVE 'N' TO TS-CCC-OCC-FRM-IND-CLQF                 
                                     IN TS-CCC-OCC(WSS-TOT-OPER-MTX).   
                                                                        
                                                                        
           IF OPD-COD-RENO IN OPD = 'N'                                 
               MOVE 'N' TO TS-CCC-OCC-FRM-COD-CIN1                      
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
               MOVE 'N' TO TS-CCC-OCC-FRM-IND-CIN1                      
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
           ELSE                                                         
               MOVE 'IN1'               TO EPD-COD-IEPD IN EPD          
               PERFORM BUS-COR-EPD                                      
               IF FIO-STAT-OKS                                          
                   MOVE 'N' TO TS-CCC-OCC-FRM-COD-CIN1                  
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                   MOVE 'S' TO TS-CCC-OCC-FRM-IND-CIN1                  
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
               ELSE                                                     
                   MOVE 'S' TO TS-CCC-OCC-FRM-COD-CIN1                  
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX)     
                   MOVE 'N' TO TS-CCC-OCC-FRM-IND-CIN1                  
                                    IN TS-CCC-OCC(WSS-TOT-OPER-MTX).    
                                                                        
                                                                        
                                                                        
       NO-VRF-EPD.                                                      

                                                                        
      *ISP CALCULA VALOR FINAL DE LA OPERACION                          
                                                                        
           IF TS-CCC-INP-FRM-COD-RENT NOT = 'S'                         
                                                                        
                MOVE ZEROES TO                                          
                     TS-CCC-OCC-FRM-VAL-CAFI-NUM IN                     
                        TS-CCC-OCC(WSS-TOT-OPER-MTX)                    
                                                                        
                     WS-CCC-OCC-FRM-VAL-CAFI-NUM                        
                                                                        
                     TS-CCC-OCC-FRM-VAL-CAFF-NUM IN                     
                        TS-CCC-OCC(WSS-TOT-OPER-MTX)                    
                                                                        
                     WS-CCC-OCC-FRM-VAL-CAFI-NUM                        
                                                                        
                     TS-CCC-OCC-FRM-VAL-RENT-NUM IN                     
                        TS-CCC-OCC(WSS-TOT-OPER-MTX)                    
                                                                        
                GO TO NO-CAL-RENT.                                      
                                                                        
           IF OPD-FEC-FREA IN OPD > WSS-FEC-FINR                        
                                                                        
                    MOVE 'CAL1' TO QUE-COLA                             
                    MOVE QUE-DEL TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                    MOVE +12 TO QUE-LITM                                
                    MOVE WSS-FEC-FFIR TO QUE-ITEM                       
                    MOVE QUE-PUT TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                                                                        
                    MOVE 'CAL1.1' TO QUE-COLA                           
                    MOVE QUE-DEL TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                    MOVE +12 TO QUE-LITM                                
                    MOVE OPD-FEC-FREA IN OPD TO QUE-ITEM                
                    MOVE QUE-PUT TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                                                                        
                MOVE OPD-VAL-CAPT IN OPD TO                             
                     TS-CCC-OCC-FRM-VAL-CAFI-NUM                        
                      IN TS-CCC-OCC(WSS-TOT-OPER-MTX)                   
                                                                        
                    MOVE 'CAL1.2' TO QUE-COLA                           
                    MOVE QUE-DEL TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                    MOVE +20 TO QUE-LITM                                
                    MOVE                                                
                     OPD-VAL-CAPT IN OPD              TO QUE-ITEM       
                    MOVE QUE-PUT TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                                                                        
                    MOVE 'CAL1.3' TO QUE-COLA                           
                    MOVE QUE-DEL TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                    MOVE +20 TO QUE-LITM                                
                    MOVE                                                
                     TS-CCC-OCC-FRM-VAL-CAFI-NUM                        
                      IN TS-CCC-OCC(WSS-TOT-OPER-MTX) TO QUE-ITEM       
                    MOVE QUE-PUT TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
           ELSE                                                         
                                                                        
                    MOVE 'CAL2' TO QUE-COLA                             
                    MOVE QUE-DEL TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                    MOVE +12 TO QUE-LITM                                
                    MOVE WSS-FEC-FFIR TO QUE-ITEM                       
                    MOVE QUE-PUT TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                                                                        
               MOVE OPD-NUM-DREA IN OPD TO INT-DUNO                     
               MOVE OPD-NUM-MREA IN OPD TO INT-MUNO                     
               MOVE OPD-NUM-SREA IN OPD TO INT-SUNO                     
               MOVE OPD-NUM-AREA IN OPD TO INT-AUNO                     
                                                                        
               MOVE TS-CCC-INP-FRM-FEC-FINR TO INT-FDOS                 
                                                                        
               MOVE OPD-COD-VCAM IN OPD TO INT-VCAM                     
               MOVE INT-FUNO            TO INT-FCOL                     
               MOVE INT-FUNO            TO INT-FBTV                     
               MOVE OPD-SGV-TINT IN OPD TO INT-TINT                     
               MOVE OPD-COD-TINT IN OPD TO INT-TIPT                     
               PERFORM GNS-CAL-INT                                      
               IF INT-CMSG > SPACES                                     
                                                                        
                    MOVE 'ERR1' TO QUE-COLA                             
                    MOVE QUE-DEL TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                    MOVE +25 TO QUE-LITM                                
                    MOVE INT-CMSG     TO QUE-ITEM                       
                    MOVE QUE-PUT TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                                                                        
                    MOVE OPD-VAL-CAPT IN OPD TO                         
                       TS-CCC-OCC-FRM-VAL-CAFI-NUM                      
                       IN TS-CCC-OCC(WSS-TOT-OPER-MTX)                  
               ELSE                                                     
                     COMPUTE TS-CCC-OCC-FRM-VAL-CAFI-NUM                
                       IN TS-CCC-OCC(WSS-TOT-OPER-MTX) =                
                         OPD-VAL-CAPT IN OPD +                          
                         OPD-VAL-CAPT IN OPD *                          
                             INT-TIPE                                   
                                                                        
                    MOVE 'CAL2.2' TO QUE-COLA                           
                    MOVE QUE-DEL TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE                                 
                    MOVE +25 TO QUE-LITM                                
                    MOVE                                                
                     TS-CCC-OCC-FRM-VAL-CAFI-NUM                        
                      IN TS-CCC-OCC(WSS-TOT-OPER-MTX) TO QUE-ITEM       
                    MOVE QUE-PUT TO QUE-CMND                            
                    PERFORM GNX-PRO-QUE.                                
                                                                        
           IF OPD-FEC-FTER IN OPD NOT > WSS-FEC-FFIR                    
                MOVE VEN-VAL-FINA IN VEN TO                             
                     TS-CCC-OCC-FRM-VAL-CAFF-NUM                        
                      IN TS-CCC-OCC(WSS-TOT-OPER-MTX)                   
           ELSE                                                         
               MOVE OPD-NUM-DREA IN OPD TO INT-DUNO                     
               MOVE OPD-NUM-MREA IN OPD TO INT-MUNO                     
               MOVE OPD-NUM-SREA IN OPD TO INT-SUNO                     
               MOVE OPD-NUM-AREA IN OPD TO INT-AUNO                     
                                                                        
               MOVE TS-CCC-INP-FRM-FEC-FFIR TO INT-FDOS                 
                                                                        
               MOVE OPD-COD-VCAM IN OPD TO INT-VCAM                     
               MOVE INT-FUNO            TO INT-FCOL                     
               MOVE INT-FUNO            TO INT-FBTV                     
               MOVE OPD-SGV-TINT IN OPD TO INT-TINT                     
               MOVE OPD-COD-TINT IN OPD TO INT-TIPT                     
               PERFORM GNS-CAL-INT                                      
               IF INT-CMSG > SPACES                                     
                    MOVE VEN-VAL-FINA IN VEN TO                         
                       TS-CCC-OCC-FRM-VAL-CAFF-NUM IN                   
                       TS-CCC-OCC(WSS-TOT-OPER-MTX)                     
               ELSE                                                     
                     COMPUTE TS-CCC-OCC-FRM-VAL-CAFF-NUM IN             
                             TS-CCC-OCC(WSS-TOT-OPER-MTX) =             
                         OPD-VAL-CAPT IN OPD +                          
                         OPD-VAL-CAPT IN OPD *                          
                             INT-TIPE.                                  
                                                                        
      * CALCULO VALORES RENTABILIDAD                                    
                                                                        
       CAL-RENT-CAFI.                                                   
                                                                        
           MOVE TS-CCC-OCC-FRM-VAL-CAFI-NUM  IN                         
                       TS-CCC-OCC(WSS-TOT-OPER-MTX) TO                  
                WS-CCC-OCC-FRM-VAL-CAFI-NUM.                            
                                                                        
           MOVE 'WSCAFI1' TO QUE-COLA                                   
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +25 TO QUE-LITM                                         
           MOVE WS-CCC-OCC-FRM-VAL-CAFI-NUM TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           MOVE ZEROES TO TS-CCC-OCC-FRM-VAL-CAFI-NUM  IN               
                       TS-CCC-OCC(WSS-TOT-OPER-MTX).                    
                                                                        
                                                                        
           MOVE 'WSCAFIV1' TO QUE-COLA                                  
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +25 TO QUE-LITM                                         
           MOVE TS-CCC-INP-FRM-COD-VREN     TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'WSCAFIV2' TO QUE-COLA                                  
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +25 TO QUE-LITM                                         
           MOVE OPD-COD-VCAM IN OPD         TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
           
                                                             
           MOVE 'WSCAFIV3' TO QUE-COLA                                  
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +25 TO QUE-LITM                                         
           MOVE WSS-COD-VCAM-0999           TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           IF TS-CCC-INP-FRM-COD-VREN = OPD-COD-VCAM IN OPD             
                GO TO EXT-CAL-RENT-CAFI.                                
                                                                        
           IF OPD-COD-VCAM IN OPD NOT = WSS-COD-VCAM-0999               
                MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB     
                MOVE OPD-COD-VCAM IN OPD     TO TAB-COD-CTAB IN TAB     
                PERFORM GET-VCAM-CAFI                                   
                IF MSG-COD-MENS NOT = SPACES                            
                    GO TO FIN-BUS-CCC-MTX                               
                ELSE                                                    
                   COMPUTE WS-CCC-OCC-FRM-VAL-CAFI-NUM =                
                           WS-CCC-OCC-FRM-VAL-CAFI-NUM *                
                           CAM-SGV-VCAM IN CAM.                         
                                                                        
                                                                        
           MOVE 'WSCAFI2' TO QUE-COLA                                   
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +25 TO QUE-LITM                                         
           MOVE WS-CCC-OCC-FRM-VAL-CAFI-NUM TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           IF TS-CCC-INP-FRM-COD-VREN NOT = WSS-COD-VCAM-0999           
                MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB     
                MOVE TS-CCC-INP-FRM-COD-VREN TO TAB-COD-CTAB IN TAB     
                PERFORM GET-VCAM-CAFI                                   
                IF MSG-COD-MENS NOT = SPACES                            
                    GO TO FIN-BUS-CCC-MTX                               
                ELSE                                                    
                    COMPUTE WS-CCC-OCC-FRM-VAL-CAFI-NUM =               
                            WS-CCC-OCC-FRM-VAL-CAFI-NUM /               
                      CAM-SGV-VCAM IN CAM.                              
                                                                        
                                                                        
           MOVE 'WSCAFI3' TO QUE-COLA                                   
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +25 TO QUE-LITM                                         
           MOVE WS-CCC-OCC-FRM-VAL-CAFI-NUM TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
       EXT-CAL-RENT-CAFI.                                               
                                                                        
       CAL-RENT-CAFF.                                                   
                                                                        
           MOVE 'WSCAFI4' TO QUE-COLA                                   
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +25 TO QUE-LITM                                         
           MOVE WS-CCC-OCC-FRM-VAL-CAFI-NUM TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           MOVE TS-CCC-OCC-FRM-VAL-CAFF-NUM  IN                         
                       TS-CCC-OCC(WSS-TOT-OPER-MTX) TO                  
                WS-CCC-OCC-FRM-VAL-CAFF-NUM.                            
                                                                        
           MOVE ZEROES TO TS-CCC-OCC-FRM-VAL-CAFF-NUM  IN               
                       TS-CCC-OCC(WSS-TOT-OPER-MTX).                    
                                                                        
           IF TS-CCC-INP-FRM-COD-VREN = OPD-COD-VCAM IN OPD             
                GO TO EXT-CAL-RENT-CAFF.                                
                                                                        
           IF OPD-COD-VCAM IN OPD NOT = WSS-COD-VCAM-0999               
                MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB     
                MOVE OPD-COD-VCAM IN OPD     TO TAB-COD-CTAB IN TAB     
                PERFORM GET-VCAM-CAFF                                   
                IF MSG-COD-MENS NOT = SPACES                            
                    GO TO FIN-BUS-CCC-MTX                               
                ELSE                                                    
                    COMPUTE WS-CCC-OCC-FRM-VAL-CAFF-NUM =               
                           WS-CCC-OCC-FRM-VAL-CAFF-NUM *                
                           CAM-SGV-VCAM IN CAM.                         
                                                                        
           IF TS-CCC-INP-FRM-COD-VREN NOT = WSS-COD-VCAM-0999           
                MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB     
                MOVE TS-CCC-INP-FRM-COD-VREN TO TAB-COD-CTAB IN TAB     
                PERFORM GET-VCAM-CAFF                                   
                IF MSG-COD-MENS NOT = SPACES                            
                    GO TO FIN-BUS-CCC-MTX                               
                ELSE                                                    
                    COMPUTE WS-CCC-OCC-FRM-VAL-CAFF-NUM =               
                      WS-CCC-OCC-FRM-VAL-CAFF-NUM /                     
                      CAM-SGV-VCAM IN CAM.                              
                                                                        
           COMPUTE TS-CCC-OCC-FRM-VAL-RENT-NUM IN                       
                       TS-CCC-OCC(WSS-TOT-OPER-MTX) =                   
                     WS-CCC-OCC-FRM-VAL-CAFF-NUM /                      
                     WS-CCC-OCC-FRM-VAL-CAFI-NUM  - 1.                  
                                                                        
       EXT-CAL-RENT-CAFF.                                               
                                                                        
      * EDICION                                                         
                                                                        
           MOVE WS-CCC-OCC-FRM-VAL-CAFI-NUM TO                          
                WSS-EDT-FRM-VAL-CAFI.                                   
           MOVE WSS-EDT-FRM-VAL-CAFI TO                                 
                TS-CCC-OCC-FRM-VAL-CAFI IN                              
                   TS-CCC-OCC(WSS-TOT-OPER-MTX).                        
                                                                        
           MOVE WS-CCC-OCC-FRM-VAL-CAFF-NUM TO                          
                WSS-EDT-FRM-VAL-CAFF.                                   
           MOVE WSS-EDT-FRM-VAL-CAFF TO                                 
                TS-CCC-OCC-FRM-VAL-CAFF IN                              
                   TS-CCC-OCC(WSS-TOT-OPER-MTX).                        
                                                                        
           MOVE TS-CCC-OCC-FRM-VAL-RENT-NUM IN                          
                   TS-CCC-OCC(WSS-TOT-OPER-MTX) TO                      
                WSS-EDT-FRM-VAL-RENT.                                   
           MOVE WSS-EDT-FRM-VAL-RENT TO                                 
                TS-CCC-OCC-FRM-VAL-RENT IN                              
                   TS-CCC-OCC(WSS-TOT-OPER-MTX).                        
                                                                        
       NO-CAL-RENT.                                                     
                                                                        
           MOVE 'S' TO WSS-PUT-TS-OCC.                                  
                                                                        
       FIN-BUS-CCC-MTX.                                                 
           EXIT.                                                        
                                                                        
       GET-VCAM-CAFI SECTION.                                           
       INI-GET-VCAM-CAFI.                                               
                                                                        
           IF OPD-FEC-FREA IN OPD > WSS-FEC-FINR                        
                MOVE OPD-NUM-DREA IN OPD TO TAB-NUM-DTRN IN TAB         
                MOVE OPD-NUM-MREA IN OPD TO TAB-NUM-MTRN IN TAB         
                MOVE OPD-NUM-SREA IN OPD TO TAB-NUM-STRN IN TAB         
                MOVE OPD-NUM-AREA IN OPD TO TAB-NUM-ATRN IN TAB         
           ELSE                                                         
                MOVE WSS-NUM-DINR         TO TAB-NUM-DTRN IN TAB        
                MOVE WSS-NUM-MINR         TO TAB-NUM-DTRN IN TAB        
                MOVE WSS-NUM-SINR         TO TAB-NUM-DTRN IN TAB        
                MOVE WSS-NUM-AINR         TO TAB-NUM-ATRN IN TAB.       
                                                                        
           PERFORM GET-VCAM.                                            
                                                                        
           MOVE 'CAMCAFI1' TO QUE-COLA                                  
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +80 TO QUE-LITM                                         
           MOVE CAM                         TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'CAMCAFI2' TO QUE-COLA                                  
           MOVE QUE-DEL TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE                                          
           MOVE +80 TO QUE-LITM                                         
           MOVE MSG-COD-MENS                TO QUE-ITEM                 
           MOVE QUE-PUT TO QUE-CMND                                     
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           IF MSG-COD-MENS NOT = SPACES                                 
                MOVE 'DAP' TO MSG-COD-SIST                              
                MOVE 'CAMCAFINEX' TO MSG-COD-MENS                       
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE 'S' TO SCR-IERR.                                   
       FIN-GET-VCAM-CAFI.                                               
           EXIT.                                                        
                                                                        
       GET-VCAM-CAFF SECTION.                                           
       INI-GET-VCAM-CAFF.                                               
                                                                        
           IF OPD-FEC-FTER IN OPD > WSS-FEC-FINR                        
                MOVE OPD-NUM-DTER IN OPD TO TAB-NUM-DTRN IN TAB         
                MOVE OPD-NUM-MTER IN OPD TO TAB-NUM-MTRN IN TAB         
                MOVE OPD-NUM-STER IN OPD TO TAB-NUM-STRN IN TAB         
                MOVE OPD-NUM-ATER IN OPD TO TAB-NUM-ATRN IN TAB         
           ELSE                                                         
                MOVE WSS-NUM-DFIR        TO TAB-NUM-DTRN IN TAB         
                MOVE WSS-NUM-MFIR        TO TAB-NUM-MTRN IN TAB         
                MOVE WSS-NUM-SFIR        TO TAB-NUM-STRN IN TAB         
                MOVE WSS-NUM-AFIR        TO TAB-NUM-ATRN IN TAB.       
 
                PERFORM GET-VCAM                                        
                IF MSG-COD-MENS NOT = SPACES                            
                     MOVE 'DAP' TO MSG-COD-SIST                         
                     MOVE 'CAMCAFFNEX' TO MSG-COD-MENS                  
                     PERFORM GET-MSG                                    
                     MOVE MSG-GLS-DESC TO FRM-MENS                      
                     MOVE 'S' TO SCR-IERR.                              
       FIN-GET-VCAM-CAFF.                                               
           EXIT.                                                        
                                                                        
       BUS-FORI-PI SECTION.                                             
       INI-BUS-FORI-PI.                                                 
           IF OPD-COD-MORE IN OPD = 'PI'                                
                PERFORM SET-EMI-PI.                                     
       FIN-BUS-FORI-PI.                                                 
           EXIT.                                                        
                                                                        
       SET-EMI-PI SECTION.                                              
       INI-SET-EMI-PI.                                                  
      *    PERFORM EXP-VEN.                                             
           IF VEN-VAL-FFLE IN VEN NUMERIC                               
              MOVE VEN-VAL-FFLE IN VEN TO VEN-VAL-FINA IN VEN.          
       FIN-SET-EMI-PI.                                                  
           EXIT.                                                        
                                                                        
       EXP-VEN SECTION.                                                 
       INI-EXP-VEN.                                                     
           MOVE SPACES TO MSG-COD-MENS.                                 
           PERFORM GET-COD-CIC-OPD.                                     
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-EXP-VEN.                                       
                                                                        
           MOVE FIO-GET-FST TO FIO-CMND.                                
       CIC-EXP-VEN.                                                     
           PERFORM GEN-PRX-RTR.                                         
                                                                        
                                                                        
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-EXP-VEN.                                       
           IF DAP-VEN-STAT-OKS                                          
              IF OPD-NUM-VNLQ IN OPD = ZEROES                           
                  PERFORM SET-VLR-IMP-PI                                
              ELSE                                                      
                  MOVE FIO-GET-NXT TO FIO-CMND                          
                  GO TO CIC-EXP-VEN.                                    
                                                                        
       FIN-EXP-VEN.                                                     
           EXIT.                                                        
                                                                        
       SET-VLR-IMP-PI SECTION.                                          
       INI-SET-VLR-IMP-PI.                                              
       FIN-SET-VLR-IMP-PI.                                              
           EXIT.                                                        
                                                                        
                                                                        
       KEY-LIQ-RDL SECTION.                                             
       INI-KEY-LIQ-RDL.                                                 
           IF OPD-COD-STAT IN OPD = 'G'                                 
               MOVE OPD-CIC-GREN IN OPD TO LIQ-CIC-IOPD IN LIQ          
               MOVE 1                   TO LIQ-NUM-ILIQ IN LIQ          
           ELSE                                                         
               MOVE OPD-CIC-IOPD IN OPD TO LIQ-CIC-IOPD IN LIQ          
               MOVE 1                   TO LIQ-NUM-ILIQ IN LIQ.         
       FIN-KEY-LIQ-RDL.                                                 
           EXIT.                                                        

       VAL-PER-REN SECTION.                                             
       INI-VAL-PER-REN.                                                 
           IF SCR-CNAL = '110' AND                                      
              OPD-COD-CUST IN OPD NOT = 'E' AND                         
              OPD-COD-IONP IN OPD NOT = 'N' AND                         
              OPD-COD-GARA IN OPD NOT = 'N'                             
               MOVE 'N' TO                                              
               TS-CCC-OCC-FRM-COD-CLIQ IN TS-CCC-OCC(WSS-TOT-OPER-MTX)  
               GO TO FIN-VAL-PER-REN.                                   
                                                                        
                                                                        
           PERFORM KEY-LIQ-RDL.                                         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM DAP-FIO-LIQ.                                         
           IF FIO-STAT-OKS                                              
               MOVE 'N' TO                                              
               TS-CCC-OCC-FRM-COD-CLIQ IN TS-CCC-OCC(WSS-TOT-OPER-MTX)  
               GO TO FIN-VAL-PER-REN.                                   
                                                                        
           IF OPD-FEC-FREA IN OPD = OPD-FEC-FPCO IN OPD OR              
              OPD-COD-STAT IN OPD NOT = 'G'                             
                MOVE 'N' TO                                             
                TS-CCC-OCC-FRM-COD-CLIQ IN TS-CCC-OCC(WSS-TOT-OPER-MTX) 
                GO TO FIN-VAL-PER-REN.                                  
                                                                        
                                                                        
           MOVE ZEROES TO WSS-NUM-PNTE.                                 
           MOVE OPD-NUM-DREA IN OPD TO FEC-ITM1.                        
           MOVE OPD-NUM-MREA IN OPD TO FEC-ITM2.                        
           MOVE OPD-NUM-SREA IN OPD TO FEC-ITM3.                        
           MOVE OPD-NUM-AREA IN OPD TO FEC-ITM4.                        
                                                                        
       BUS-INI-PER-REN.                                                 
      * ISP: SE POSICIONA EN PRIMERA FECHA HABIL A PARTIR DE            
      *      FECHA DE CAPTACION ( INCLUSIVE )                           
      *      LA DEJA CARGADA EN FEC-FECH                                
                                                                        
           MOVE FEC-FBLK-S TO FEC-FBLK.                                 
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           MOVE FEC-VHBL-S TO FEC-VHBL.                                 
           MOVE FEC-VAL-FEC TO FEC-CMND.                                
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-HBL                                          
               MOVE FEC-SUM-DIA            TO FEC-CMND                  
               MOVE 1                      TO FEC-NDIA                  
               MOVE FEC-FORM-FEC TO FEC-FORM                            
               PERFORM CAL-FEC                                          
               GO TO BUS-INI-PER-REN.                                   
                                                                        
       CIC-VAL-PER-REN.                                                 
           MOVE FEC-SUM-DIA            TO FEC-CMND.                     
           MOVE 1                      TO FEC-NDIA.                     
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           PERFORM CAL-FEC.                                             
                                                                        
      *VAL-FEC Validar Fecha                                            
           MOVE FEC-FBLK-S TO FEC-FBLK.                                 
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           MOVE FEC-VHBL-S TO FEC-VHBL.                                 
           MOVE FEC-VAL-FEC TO FEC-CMND.                                
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           PERFORM PRO-FEC.                                             
           IF FEC-STAT-HBL                                              
               ADD 1 TO WSS-NUM-PNTE.                                   
           IF WSS-NUM-PNTE < OPD-NUM-PNTE IN OPD                        
                GO TO CIC-VAL-PER-REN.                                  
           MOVE FEC-ITM1 TO WSS-NUM-DUNO.                               
           MOVE FEC-ITM2 TO WSS-NUM-MUNO.                               
           MOVE FEC-ITM3 TO WSS-NUM-SUNO.                               
           MOVE FEC-ITM4 TO WSS-NUM-AUNO.                               
           PERFORM GET-FHOY.                                            
           IF HOY-FHOY > WSS-FEC-FUNO                                   
               MOVE 'N' TO                                              
               TS-CCC-OCC-FRM-COD-CLIQ IN TS-CCC-OCC(WSS-TOT-OPER-MTX)  
           ELSE                                                         
               MOVE 'S' TO                                              
               TS-CCC-OCC-FRM-COD-CLIQ IN TS-CCC-OCC(WSS-TOT-OPER-MTX). 
       FIN-VAL-PER-REN.                                                 
           EXIT.                                                        
                                                                        
       AJUSTA-FPES SECTION.                                             
       INI-AJUSTA-FPES.                                                 
           IF WSS-CIC-TVAL = PDB-CIC-MEXT                               
              MOVE WSS-CIC-VCAM TO PES-CIC-VCAM.                        
           MOVE TS-CCC-OCC-FRM-VAL-FPES IN TS-CCC-OCC(WSS-TOT-OPER-MTX) 
                       TO PES-SGV-DECI.                                 
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE TO                                         
                         WSS-EDT-FRM-VAL-FPES                           
                MOVE     WSS-EDT-FRM-VAL-FPES TO                        
                    TS-CCC-OCC-FRM-VAL-FPES                             
                  IN TS-CCC-OCC(WSS-TOT-OPER-MTX).                      
       FIN-AJUSTA-FPES.                                                 
           EXIT.                                                        
                                                                        
       LEE-VCAM SECTION.                                                
       INI-LEE-VCAM.                                                    
      *    moneda reajustable, chilena y no pesos ; convertir a pesos   
           MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB.         
           MOVE OPD-COD-VCAM IN OPD     TO TAB-COD-CTAB IN TAB.         
           MOVE VEN-NUM-DVEN IN VEN     TO TAB-NUM-DTRN IN TAB.         
           MOVE VEN-NUM-MVEN IN VEN     TO TAB-NUM-MTRN IN TAB.         
           MOVE VEN-NUM-SVEN IN VEN     TO TAB-NUM-STRN IN TAB.         
           MOVE VEN-NUM-AVEN IN VEN     TO TAB-NUM-STRN IN TAB.         
           PERFORM GET-VCAM.                                            
           IF MSG-COD-MENS = SPACES                                     
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM.                
       FIN-LEE-VCAM.                                                    
           EXIT.                                                        
                                                                        
       PUT-ELM-PREV SECTION.
       INI-PUT-ELM-PREV.
           MOVE OPD-CAI-IOPD TO FRM-CAI-IOPD IN CCC-FLD(WSS-J).
           MOVE OPD-IIC-IOPD TO FRM-IIC-IOPD IN CCC-FLD(WSS-J).
           IF  OPD-COD-STAT IN OPD = 'L' AND
               OPD-COD-SCTB = 'VCD' AND
               OPD-COD-RENO IN OPD = 'N'
                  MOVE 'V' TO FRM-IND-VENC IN CCC-FLD(WSS-J)
               ELSE
                  MOVE ' ' TO FRM-IND-VENC IN CCC-FLD(WSS-J).
           MOVE OPD-VAL-CAPT TO FRM-VAL-CAPT IN CCC-FLD(WSS-J).
           MOVE OPD-NUM-DREA TO FRM-NUM-DREA IN CCC-FLD(WSS-J).
           MOVE OPD-NUM-MREA TO FRM-NUM-MREA IN CCC-FLD(WSS-J).
           MOVE OPD-NUM-AREA TO FRM-NUM-AREA IN CCC-FLD(WSS-J).
           MOVE OPD-NUM-DPVC TO FRM-NUM-DPVC IN CCC-FLD(WSS-J).
           MOVE OPD-NUM-MPVC TO FRM-NUM-MPVC IN CCC-FLD(WSS-J).
           MOVE OPD-NUM-APVC TO FRM-NUM-APVC IN CCC-FLD(WSS-J).
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR TO FRM-GLS-VCAM IN CCC-FLD(WSS-J).

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-TOPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR TO WSS-GLS-TOPD.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-COPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR TO WSS-GLS-AOPD.

           MOVE WSS-GLS-COPD TO FRM-GLS-COPD IN CCC-FLD(WSS-J).
       FIN-PUT-ELM-PREV.
           EXIT.

       PRO-MONE-TOT SECTION.
       INI-PRO-MONE-TOT.
           IF OPD-COD-VCAM IN OPD =
              FRM-GLS-TOTA IN CCC-FLD(WSS-NUM-MONE)
                MOVE 'S' TO WSS-IND-MONE
                MOVE WSS-NUM-MONE TO WSS-IDX-MONE.
       FIN-PRO-MONE-TOT.
           EXIT.

       PUT-GLS-MONE SECTION.
       INI-PUT-GLS-MONE.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-GLS-TOTA IN CCC-FLD(WSS-NUM-MONE) TO
                TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR TO
                FRM-GLS-TOTA IN CCC-FLD(WSS-NUM-MONE).
       FIN-PUT-GLS-MONE.
           EXIT.

       PRO-PROD-TOT SECTION.                                            
       INI-PRO-PROD-TOT.                                                
           IF  OPD-COD-VCAM IN OPD =                                    
              WSS-PROD-VCAM IN WSS-PROD(WSS-NUM-PROD) AND               
               OPD-COD-TOPD IN OPD =                                    
              WSS-PROD-TOPD IN WSS-PROD(WSS-NUM-PROD) AND               
               OPD-COD-AOPD IN OPD =                                    
              WSS-PROD-AOPD IN WSS-PROD(WSS-NUM-PROD)                   
                MOVE 'S' TO WSS-IND-PROD                                
                MOVE WSS-NUM-PROD TO WSS-IDX-PROD.                      
       FIN-PRO-PROD-TOT.                                                
           EXIT.                                                        
                                                                        
       PUT-GLS-PROD SECTION.                                            
       INI-PUT-GLS-PROD.                                                
           MOVE SPACES TO WSS-GLS-COPD-PROD.                            
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.                           
           MOVE WSS-PROD-TOPD IN WSS-PROD(WSS-NUM-PROD)   TO            
                                       TAB-COD-CTAB IN TAB.    
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-ABRV TO WSS-GLS-TOPD-PROD.                      
                                                                              
           MOVE 'TAB' TO TAB-COD-SIST.                         
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.                           
           MOVE WSS-PROD-TOPD IN WSS-PROD(WSS-NUM-PROD)   TO            
                                       WSS-TOPD.                        
           MOVE WSS-PROD-AOPD IN WSS-PROD(WSS-NUM-PROD)   TO            
                                       WSS-AOPD.                        
           MOVE WSS-COPD TO TAB-COD-CTAB IN TAB.                        
           PERFORM BUS-TAB.
           MOVE TAB-GLS-ABRV TO WSS-GLS-AOPD-PROD.                      

           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.                           
           MOVE WSS-PROD-VCAM IN WSS-PROD(WSS-NUM-PROD)   TO            
                                       TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-ABRV TO WSS-GLS-VCAM-PROD.                      
                                                                        
           MOVE WSS-GLS-COPD-PROD TO                                    
                         WSS-PROD-GLOS IN WSS-PROD(WSS-NUM-PROD).       
       FIN-PUT-GLS-PROD.                                                
           EXIT.                                                        
                                                                        
       PUT-HDR-CCC SECTION.                                             
       INI-PUT-HDR-CCC.                                                 
           MOVE TS-CCC-TYPE-HDR TO QUE-TYPE.                            
           MOVE TSK-TERM-ALF    TO QUE-TERM.                            
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNS-PRO-QUE.                                         
           MOVE WSS-IND-HMAS            TO TS-CCC-HDR-FRM-IND-HMAS.     
           MOVE DBC-GLS-NOMC IN DBC     TO TS-CCC-HDR-DBC-GLS-NOMC.     
           MOVE DBC-NUM-ICLI IN CCC-FLD TO TS-CCC-HDR-DBC-NUM-ICLI.     
           MOVE DBC-VRF-ICLI IN CCC-FLD TO TS-CCC-HDR-DBC-VRF-ICLI.     
           MOVE DBC-IND-ICLI IN CCC-FLD TO TS-CCC-HDR-DBC-IND-ICLI.     
           MOVE DBC-GLS-ICLI IN CCC-FLD TO TS-CCC-HDR-DBC-GLS-ICLI.     
                                                                        
           MOVE FRM-VAL-TOTA IN CCC-FLD(1) TO FRM-VAL-TOTA-EDT(1).      
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOT1.         
                                                                        
           MOVE FRM-VAL-TOTA IN CCC-FLD(2) TO FRM-VAL-TOTA-EDT(1).      
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOT2.         
                                                                        
           MOVE FRM-VAL-TOTA IN CCC-FLD(3) TO FRM-VAL-TOTA-EDT(1).      
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOT3.         
                                                                        
           MOVE FRM-VAL-TOTA IN CCC-FLD(4) TO FRM-VAL-TOTA-EDT(1).      
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOT4.         
                                                                        
           MOVE FRM-VAL-TOTA IN CCC-FLD(5) TO FRM-VAL-TOTA-EDT(1).      
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOT5.         
                                                                        
           MOVE FRM-VAL-TOTA IN CCC-FLD(6) TO FRM-VAL-TOTA-EDT(1).      
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOT6.         
                                                                        
           MOVE FRM-GLS-TOTA IN CCC-FLD(1) TO TS-CCC-HDR-FRM-GLS-TOT1.  
           MOVE FRM-GLS-TOTA IN CCC-FLD(2) TO TS-CCC-HDR-FRM-GLS-TOT2.  
           MOVE FRM-GLS-TOTA IN CCC-FLD(3) TO TS-CCC-HDR-FRM-GLS-TOT3.  
           MOVE FRM-GLS-TOTA IN CCC-FLD(4) TO TS-CCC-HDR-FRM-GLS-TOT4.  
           MOVE FRM-GLS-TOTA IN CCC-FLD(5) TO TS-CCC-HDR-FRM-GLS-TOT5.  
           MOVE FRM-GLS-TOTA IN CCC-FLD(6) TO TS-CCC-HDR-FRM-GLS-TOT6.  
                                                                        
           MOVE WSS-PROD-TOTA IN WSS-PROD(1) TO FRM-VAL-TOTA-EDT(1).    
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOP1.         
                                                                        
           MOVE WSS-PROD-TOTA IN WSS-PROD(2) TO FRM-VAL-TOTA-EDT(1).    
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOP2.         
                                                                        
           MOVE WSS-PROD-TOTA IN WSS-PROD(3) TO FRM-VAL-TOTA-EDT(1).    
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOP3.         
                                                                        
           MOVE WSS-PROD-TOTA IN WSS-PROD(4) TO FRM-VAL-TOTA-EDT(1).    
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOP4.         
                                                                        
           MOVE WSS-PROD-TOTA IN WSS-PROD(5) TO FRM-VAL-TOTA-EDT(1).    
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOP5.         
                                                                        
           MOVE WSS-PROD-TOTA IN WSS-PROD(6) TO FRM-VAL-TOTA-EDT(1).    
           MOVE FRM-VAL-TOTA-EDT(1) TO TS-CCC-HDR-FRM-VAL-TOP6.         
                                                                        
           MOVE WSS-PROD-GLOS IN WSS-PROD(1) TO TS-CCC-HDR-FRM-GLS-TOP1.
           MOVE WSS-PROD-GLOS IN WSS-PROD(2) TO TS-CCC-HDR-FRM-GLS-TOP2.
           MOVE WSS-PROD-GLOS IN WSS-PROD(3) TO TS-CCC-HDR-FRM-GLS-TOP3.
           MOVE WSS-PROD-GLOS IN WSS-PROD(4) TO TS-CCC-HDR-FRM-GLS-TOP4.
           MOVE WSS-PROD-GLOS IN WSS-PROD(5) TO TS-CCC-HDR-FRM-GLS-TOP5.
           MOVE WSS-PROD-GLOS IN WSS-PROD(6) TO TS-CCC-HDR-FRM-GLS-TOP6.
                                                                        
                                                                        
           MOVE TS-CCC-LITM-HDR TO QUE-LITM.                            
           MOVE TS-CCC-HDR TO QUE-ITEM.                                 
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNS-PRO-QUE.                                         
       FIN-PUT-HDR-CCC.                                                 
           EXIT.                                                        
                                                                        
      * UNP-OPCI SECTION.
      * INI-UNP-OPCI.
      *     MOVE FRM-CPIM-UBY TO FRM-COD-OPCI-ATR IN CCC-FLD(FRM-IFLD).
      * FIN-UNP-OPCI.
      *     EXIT.

       BKP-CIC-CLI SECTION.
       INI-BKP-CIC-CLI.
           IF PGM-STAT-DBC-OKS
              MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI.
       FIN-BKP-CIC-CLI.
           EXIT.

      * Modulo para Busqueda con PF7(prv) y PF8(nxt) por DBC(reqa) o Nombre.
       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
           PERFORM BKP-CIC-CLI.
       FIN-LEE-NXT-PRV.
           EXIT.

      * Modulo Efectua Busqueda por DBC(reqa) con PF7(prv) y PF8(nxt).
       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S   TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.

      * Modulo Efectua Busqueda por Nombre con PF7(prv) y PF8(nxt).
       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.
      **********************************************************************
      *Entidades de DAP
       COPY DAPBFOPD.
       COPY DAPBFRCC.
       COPY DAPBFLIQ.                                                   
       COPY DAPBFVEN.                                                   
       COPY DAPBFEPD.                                                   
      *NVA COPY DAPBFDCD.                                               
                                                                        

       COPY GNSBGCPT.
       COPY GNSBGSTR.
      * COPY SGCBGCLI.
       COPY GNSBBTAB.
       COPY GNSBGCAM.                                                   
       COPY TABBFCAM.                                                   
      *NVA COPY TABBFOFI.                                               
      *NVA COPY TABBBOFI.                                               
       COPY GNSBGFEC.                                                   
       COPY GNSBPFEC.                                                   
       COPY GNSBGPES.                                                   
       COPY GNSBGHOY.                                                   
       COPY DAPBGVEN.                                                   
       COPY GNSBGINT.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBVTAB.                                                   
       COPY DAPBG008.                                                   
                                                                        
       BUS-COR-EPD SECTION.                                             
       INI-BUS-COR-EPD.                                                 
           MOVE EPD-COD-IEPD IN EPD TO WSS-EPD-COD-IEPD.                
           MOVE OPD-CIC-IOPD IN OPD TO EPD-CIC-IOPD IN EPD.             
           MOVE OPD-NUM-IVEN IN OPD TO EPD-NUM-IVEN IN EPD.             
           MOVE 999                 TO EPD-NUM-IEPD IN EPD.             
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM DAP-FIO-EPD.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    EPD-CAI-IOPD IN EPD = OPD-CAI-IOPD IN OPD AND       
                    EPD-IIC-IOPD IN EPD = OPD-IIC-IOPD IN OPD AND       
                    EPD-COD-IEPD IN EPD = WSS-EPD-COD-IEPD )            
               MOVE '23' TO FIO-STAT.                                   
           IF ( FIO-STAT-OKS AND                                        
                EPD-COD-SEPD = 'R' ) OR                                 
                EPD-COD-SEPD = 'X'                                      
                 MOVE '23' TO FIO-STAT.                                 
                                                                        
       FIN-BUS-COR-EPD.                                                 
           EXIT.                                                        
                                                                        
       SET-IF SECTION.                                                  
       INI-SET-IF.                                                      
                                                                        
           IF TS-CCC-INP-FRM-CAI-IOPD NOT > SPACES                      
                   MOVE 'S' TO WSS-INI-BUSQ.                            
                                                                        
           IF TS-CCC-INP-FRM-COD-VREN > SPACES                          
                   MOVE 'S' TO TS-CCC-INP-FRM-COD-RENT.                 
       FIN-SET-IF.                                                      
           EXIT.                                                        
                                                                        
       GNX-PRO-QUE SECTION.                                             
       INI-GNX-PRO-QUE.                                                 
      *    PERFORM GNS-PRO-QUE.                                         
       FIN-GNX-PRO-QUE.                                                 
           EXIT.                                                        
                                                                        
       BUSCA-DBIM-DBIP SECTION.                                         
       INI-BUSCA-DBIM-DBIP.                                             
           MOVE 'DAP'  TO IDD-SAUX.                                     
           MOVE 'M'    TO IDD-GAUX.                                     
           MOVE SPACES TO IDD-RAUX.                                     
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             AT END                                                     
                GO TO DBM-BUSCA-DBIM-DBIP                               
             WHEN IDD-DENT(IDD-ITBL) = IDD-DAUX                         
                MOVE IDD-IENT(IDD-ITBL) TO WSS-DBNM                     
                 MOVE IDD-IAUX          TO WSS-DBIM                     
                 GO TO CON-BUSCA-DBIM-DBIP.                             
       DBM-BUSCA-DBIM-DBIP.                                             
           MOVE 0 TO WSS-DBNM.                                          
           MOVE 0 TO WSS-DBIM.                                          
       CON-BUSCA-DBIM-DBIP.                                             
           MOVE 'DAP'  TO IDD-SAUX.                                     
           MOVE 'P'    TO IDD-GAUX.                                     
           MOVE SPACES TO IDD-RAUX.                                     
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             AT END                                                     
                GO TO DBP-BUSCA-DBIM-DBIP                               
             WHEN IDD-DENT(IDD-ITBL) = IDD-DAUX                         
                MOVE IDD-IENT(IDD-ITBL) TO WSS-DBNP                     
                MOVE IDD-IAUX           TO WSS-DBIP                     
                GO TO FIN-BUSCA-DBIM-DBIP.                              
       DBP-BUSCA-DBIM-DBIP.                                             
           MOVE 0 TO WSS-DBNP.                                          
           MOVE 0 TO WSS-DBIP.                                          
       FIN-BUSCA-DBIM-DBIP.                                             
           EXIT.                                                        
                                                                        
       INV-BD SECTION.                                                  
       INI-INV-BD.                                                      
           MOVE WSS-DBNM TO IDD-IENT(WSS-DBIP).                         
           MOVE WSS-DBNP TO IDD-IENT(WSS-DBIM).                         
       FIN-INV-BD.                                                      
           EXIT.                                                        
                                                                        
       USPC107 SECTION.                                                 
       INI-USPC107.                                                     
      *    COPY USPC107.                                                
           COPY USPC107.                                                
       FIN-USPC107.                                                     
           EXIT.                                                              
      *>>>>
