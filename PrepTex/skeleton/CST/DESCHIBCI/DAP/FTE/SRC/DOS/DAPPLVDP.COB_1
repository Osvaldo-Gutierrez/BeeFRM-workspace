       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      DAPPLVDP.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    07-Jun-96 05:10 PM.

      * Programa Listador de Reporte VDP con Sort.
000000*COMPILED SITE 2000          01.09.98

      ******************************************************************
      *  INTERSOFT                                                     *
      *  MODIFICACION: CONVERTIR REPORT-WRITER A LISTADO, MIGRAR A     *
      *                A COBOL FOR MVS Y CONVERSION 2000               *
      *  FECHA: MAYO  1998                                             *
      ******************************************************************

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTVDP         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTVDP         ASSIGN TO        UT-S-RPTVDP.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.

      **** CRW-COMIENZO
      *    SELECT RPTVDP         ASSIGN TO        UT-S-RPTVDP.
           SELECT RPTVDP         ASSIGN TO             RPTVDP.
      **** CRW-FINAL

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY DAPRRVDP.

      **** CRW-COMIENZO
      *FD  RPTVDP LABEL RECORDS OMITTED
      *    REPORT IS RPT-VDP
      *    .
       FD  RPTVDP
           RECORD CONTAINS 133 CHARACTERS
           BLOCK CONTAINS 0 RECORDS
           LABEL RECORD STANDARD.

       01  RPTVDP-REG           PIC X(133).
      ***** CRW-FINAL

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY DAPBRVEN.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY DAPRWVDP.
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
      *Entidades de GNS
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.

      *Entidades de TAB
       COPY TABBRCAM.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRVLR.

      *Entidades de DAP
       COPY DAPBROPD.
       COPY DAPBRRCC.

      *Entidades de SGC
       COPY SGCBRDBC.
       COPY SGCBRRCD.

       01  WSS-VARI.
             03  WSS-GLS-DEST.
               05  WSS-GLS-DES1                      PIC X(20).
               05  WSS-GLS-DES2                      PIC X(20).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FFIN.
               05  WSS-NUM-DFIN                      PIC 9(02).
               05  WSS-NUM-MFIN                      PIC 9(02).
               05  WSS-NUM-SFIN                      PIC 9(02).
               05  WSS-NUM-AFIN                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-DTER                      PIC 9(02).
           03  WSS-FEC-FVEN.
               05  WSS-NUM-SVEN                      PIC 9(02).
               05  WSS-NUM-AVEN                      PIC 9(02).
               05  WSS-NUM-MVEN                      PIC 9(02).
               05  WSS-NUM-DVEN                      PIC 9(02).
           03  WSS-IND-TOPE                          PIC X(01).
           03  WSS-COD-EJEC                          PIC X(12).
           03  WSS-COD-OFIC                          PIC X(03).
           03  WSS-COD-VCAM                          PIC X(06).
           03  WSS-NUM-TOTO          VALUE ZEROES    PIC 9(05).
           03  WSS-NUM-TOTM          VALUE ZEROES    PIC 9(05).
           03  WSS-NUM-TOTF          VALUE ZEROES    PIC 9(05).
           03  WSS-STAT-OPD          VALUE ZEROES    PIC 9(01).
           03  WSS-STAT-RCC          VALUE ZEROES    PIC 9(01).
           03  WSS-IND-MCLI          VALUE SPACES    PIC X(01).
           03  WSS-COD-0999           VALUE '0999  '  PIC X(06).
           03  WSS-COD-0998           VALUE '0998  '  PIC X(06).
           03  WSS-VALOR-PESOS                        PIC 9(13).
      *>>>>
      *<<<< WSS_DTC
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *Entidades de GNS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>

      **** CRW-COMIENZO

      *REPORT SECTION.
      *--------------
      *COPY DAPRFVDP.
      *    .
      *COPY DAPRTVDP.

       01  RPT-VARIABLES.
           02 RPT-VARIABLES-VARIAS.
              03 RPT-VARI-LINEA              PIC 9(03) VALUE 60.
              03 RPT-VARI-PAGE-COUNTER       PIC 9(03).
           02 RPT-VARIABLES-CONTROL.
              03 RPT-CTRL-COD-COPD           PIC X(06) VALUE SPACES.
              03 RPT-CTRL-COD-OFIC           PIC X(03) VALUE SPACES.
              03 RPT-CTRL-COD-VCAM           PIC X(06) VALUE SPACES.
              03 RPT-CTRL-FEC-FVEN           PIC X(08) VALUE SPACES.
           02 RPT-VARIABLES-TOTALES.
              05 RPT-TOTA-VAL-FINA           PIC 9(13)V9999 VALUE 0.
              05 RPT-TOTA-VAL-SUMI           PIC 9(13)V9999 VALUE 0.
           02 RPT-VARIABLES-AUXILIARES.
              05 RPT-AUXI-GLS-COPD           PIC X(25).
              05 RPT-AUXI-GLS-VCAM           PIC X(25).

       01  PH-VDP.

           03  PH-VDP-01.
               05  RPT-HEAD-DUSU              PIC X(30).
               05  FILLER                     PIC X(012) VALUE SPACES.
               05  FILLER                     PIC X(36)
                   VALUE 'VENCIMIENTOS DE DEPOSITOS A PLAZO AL'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-NUM-DPRO          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-MPRO          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-SPRO          PIC X(2).
               05  RPT-HEAD-NUM-APRO          PIC X(2).
               05  FILLER                     PIC X(033) VALUE SPACES.
               05  RPT-HEAD-FDMA              PIC XXBXXBXXXX.

           03  PH-VDP-02.
               05  RPT-HEAD-DSIS              PIC X(30).
               05  FILLER                     PIC X(017) VALUE SPACES.
               05  FILLER                     PIC X(7)
                   VALUE 'DESDE :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-NUM-DINI          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-MINI          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-SINI          PIC X(2).
               05  RPT-HEAD-NUM-AINI          PIC X(2).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(7)
                   VALUE 'HASTA :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-NUM-DFIN          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-MFIN          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-SFIN          PIC X(2).
               05  RPT-HEAD-NUM-AFIN          PIC X(2).
               05  FILLER                     PIC X(037) VALUE SPACES.
               05  FILLER                     PIC X(6)
                   VALUE 'PAGINA'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-PAGE-COUNTER      PIC ZZZ.

           03  PH-VDP-03.
               05  RPT-HEAD-GLS-BLK0          PIC X.

           03  PH-VDP-04.
               05  FILLER                     PIC X(9)
                   VALUE 'OFICINA :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-GLS-DESC          PIC X(30).

           03  PH-VDP-05.
               05  FILLER                     PIC X(132)
                   VALUE ALL '-'.

           03  PH-VDP-06.
               05  FILLER                     PIC X(39)
                   VALUE 'NOMBRE O RAZON SOCIAL      RUT         '.
               05  FILLER                     PIC X(39)
                   VALUE 'DIRECCION                              '.
               05  FILLER                     PIC X(17)
                   VALUE '             FONO'.

           03  PH-VDP-07.
               05  FILLER                     PIC X(027) VALUE SPACES.
               05  FILLER                     PIC X(39)
                   VALUE 'NRO OPERACION  SERIAL        VEN  F CAP'.
               05  FILLER                     PIC X(39)
                   VALUE 'TAC      TASA INT    FINAL    VENCTO   '.
               05  FILLER                     PIC X(22)
                   VALUE '      INTERESES VENCTO'.

           03  PH-VDP-08.
               05  FILLER                     PIC X(132)
                   VALUE ALL '-'.

       01  DL-VD1.

           03  DL-VD1-09.
               05  RPT-DETA-GLS-NOMC          PIC X(25).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-ICLI          PIC X(8).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-VRF-ICLI          PIC X.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-DIRE          PIC X(50).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-FONO          PIC X(12).

       01  DL-VDP.

           03  DL-VDP-10.
               05  FILLER                     PIC X(025) VALUE SPACES.
               05  RPT-DETA-CAI-IOPD          PIC X(4).
               05  RPT-DETA-IIC-IOPD          PIC X(8).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-CAI-ISER          PIC X(4).
               05  RPT-DETA-IIC-ISER          PIC X(8).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-IVEN          PIC 9(3).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-DREA          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MREA          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SREA          PIC X(2).
               05  RPT-DETA-NUM-AREA          PIC X(2).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-SGV-TINT          PIC ---9,9999.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-VAL-FINA          PIC ZZZZ.ZZZ.ZZZ.ZZ9,9999.
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-VAL-INTE          PIC ZZZZ.ZZZ.ZZZ.ZZ9,9999.

           03  DL-VDP-11.
               05  RPT-DETA-GLS-BLK1          PIC X.

       01  CF-VDP-OPD-COD-COPD.

           03  CF-VDP-12.
               05  FILLER                     PIC X(13)
                   VALUE 'TOTALES CLASE'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-CTRL-GLS-COPD          PIC X(25).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  FILLER                     PIC X(26)
                   VALUE 'EN FECHA DE VENCIMIENTO  :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-CTRL-NUM-DVEN          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-CTRL-NUM-MVEN          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-CTRL-NUM-SVEN          PIC X(2).
               05  RPT-CTRL-NUM-AVEN          PIC X(2).
               05  FILLER                     PIC X(006) VALUE SPACES.
               05  RPT-CTRL-VAL-FINA          PIC ZZZZ.ZZZ.ZZZ.ZZ9,9999.
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-CTRL-VAL-SUMI          PIC ZZZZ.ZZZ.ZZZ.ZZ9,9999.

           03  CF-VDP-13.
               05  RPT-CTRL-GLS-BLK2          PIC X.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  FILLER                     PIC X(6)
                   VALUE 'MONEDA'.
               05  FILLER                     PIC X(007) VALUE SPACES.
               05  RPT-CTRL-GLS-VCAM          PIC X(25).

      ***** CRW-FINAL

       PROCEDURE DIVISION.
      *==================

      ***** CRW-COMIENZO
      *DECLARATIVES.
      ***** CRW-FINAL

       DEC-CF-VDP-OPD-COD-COPD SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-VDP-OPD-COD-COPD.
      ***** CRW-FINAL

       INI-CF-VDP-OPD-COD-COPD.
      *<<<< CF_VDP_OPD_COD_COPD
      *Recupera glosa de moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN SRT TO TAB-COD-CTAB IN TAB.
           DISPLAY 'OPD-COD-VCAM : ' OPD-COD-VCAM IN SRT.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCAM IN WSS-VDP.
           DISPLAY 'TAB-GLS-DESC : ' TAB-GLS-DESC IN TAB.
           DISPLAY ' '.

           MOVE OPD-COD-COPD IN SRT TO OPD-COD-COPD IN OPD.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-TOPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DES1 IN WSS-VARI.
           DISPLAY 'OPD-COD-TOPD : ' OPD-COD-TOPD IN OPD.
           DISPLAY 'TAB-GLS-DESC : ' TAB-GLS-DESC IN TAB.
           DISPLAY ' '.
      *
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-COPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DES2 IN WSS-VARI.

           DISPLAY 'OPD-COD-COPD : ' OPD-COD-COPD IN OPD.
           DISPLAY 'TAB-GLS-DESC : ' TAB-GLS-DESC IN TAB.
           DISPLAY ' '.

           MOVE WSS-GLS-DEST TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO WSS-GLS-DEST.
           MOVE WSS-GLS-DEST IN WSS-VARI TO
                                        WSS-GLS-COPD IN WSS-VDP.

           MOVE VEN-FEC-FVEN IN SRT TO WSS-FEC-FVEN IN WSS-VARI.
           MOVE WSS-NUM-DVEN IN WSS-VARI TO WSS-NUM-DVEN IN WSS-VDP.
           MOVE WSS-NUM-MVEN IN WSS-VARI TO WSS-NUM-MVEN IN WSS-VDP.
           MOVE WSS-NUM-SVEN IN WSS-VARI TO WSS-NUM-SVEN IN WSS-VDP.
           MOVE WSS-NUM-AVEN IN WSS-VARI TO WSS-NUM-AVEN IN WSS-VDP.
      *>>>>
       FIN-CF-VDP-OPD-COD-COPD.
           EXIT.
       DEC-CF-VDP-OPD-COD-OFIC SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-VDP-OPD-COD-OFIC.
      ***** CRW-FINAL

       INI-CF-VDP-OPD-COD-OFIC.
       FIN-CF-VDP-OPD-COD-OFIC.
           EXIT.
       DEC-CF-VDP-OPD-COD-VCAM SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-VDP-OPD-COD-VCAM.
      ***** CRW-FINAL

       INI-CF-VDP-OPD-COD-VCAM.
       FIN-CF-VDP-OPD-COD-VCAM.
           EXIT.
       DEC-PH-VDP SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING PH-VDP.
      ***** CRW-FINAL

       INI-PH-VDP.
      *<<<< IF PH_VDP
      *Recupera glosa de oficina
           MOVE OPD-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.

           DISPLAY 'OPD-COD-OFIC : ' OPD-COD-OFIC IN SRT.
           DISPLAY 'OFI-GLS-DESC : ' OFI-GLS-DESC IN OFI.
           DISPLAY ' '.

      *Recupera glosa ejecutivo
      *     MOVE SPACES TO WSS-GLS-EJEC IN WSS-VDP.
      *     IF OPD-COD-EJEC IN SRT > SPACES
      *        MOVE OPD-COD-EJEC IN SRT TO USR-COD-USER IN USR
      *        PERFORM BUS-USR
      *        MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-VDP.
      *>>>>
       FIN-PH-VDP.
           EXIT.

      ***** CRW-COMIENZO
      *END DECLARATIVES.
      ***** CRW-FINAL

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'DAPPLVDP' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
      * Captura parametros
           DISPLAY ' '.
           DISPLAY 'INICIO CAPTURA PARAMETROS '.
           DISPLAY ' '.
           DISPLAY 'INGRESE TOPE S/N ? : '.
           ACCEPT WSS-IND-TOPE IN WSS-VARI.
           DISPLAY WSS-IND-TOPE IN WSS-VARI.

           DISPLAY ' '.
           DISPLAY 'INGRESE FECHA INICIAL (DDMMSSAA) : '.
           ACCEPT WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.

           DISPLAY 'INGRESE FECHA FINAL   (DDMMSSAA) : '.
           ACCEPT WSS-FEC-FFIN IN WSS-VARI.
           DISPLAY WSS-FEC-FFIN IN WSS-VARI.
           DISPLAY 'FIN CAPTURA PARAMETROS '.

           DISPLAY 'INGRESE COD. EJECUTIVO (X(12)/*) : '.
           ACCEPT  WSS-COD-EJEC IN WSS-VARI.
           DISPLAY WSS-COD-EJEC IN WSS-VARI.

           DISPLAY 'INGRESE COD. DE OFICINA  (XXX/*) : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.

           DISPLAY 'INGRESE COD. DE MONEDA (X(06)/*) : '.
           ACCEPT  WSS-COD-VCAM IN WSS-VARI.
           DISPLAY WSS-COD-VCAM IN WSS-VARI.
           DISPLAY ' '.
           DISPLAY 'INICIO VALIDACION PARAMETROS '.
           DISPLAY ' '.

      *VAL-FEC Valida Fecha de Inicio
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR VALIDACION EN FECHA DE INICIO: '
                         WSS-FEC-FINI '  ' FEC-MENS
               PERFORM GNS-PRO-ABT.

      *VAL-FEC Valida Fecha de Termino
           MOVE WSS-FEC-FFIN IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR VALIDACION EN FECHA DE TERMINO: '
                         WSS-FEC-FINI '  ' FEC-MENS
               PERFORM GNS-PRO-ABT.

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FFIN IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' FECHA INICIO > FECHA TERMINO: '
                         WSS-FEC-FINI ' > ' WSS-FEC-FFIN
               PERFORM GNS-PRO-ABT.

      *Valida glosa ejecutivo
           IF WSS-COD-EJEC IN WSS-VARI > SPACES AND
              WSS-COD-EJEC IN WSS-VARI NOT = '*'
              MOVE WSS-COD-EJEC IN WSS-VARI TO USR-COD-USER IN USR
              PERFORM VAL-USR
               IF MSG-GLS-MENS = 'COD    NEX'
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR VALIDACION EJECUTIVO: ' WSS-COD-EJEC
                  PERFORM GNS-PRO-ABT.

      *VAL-OFI Valida Codigo de oficina
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
              PERFORM VAL-OFI
               IF MSG-GLS-MENS = 'COD    NEX'
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR VALIDACION OFICINA: ' WSS-COD-OFIC
                  PERFORM GNS-PRO-ABT.

      *VAL-TAB Valida Codigo de moneda
           IF WSS-COD-VCAM IN WSS-VARI > SPACES AND
              WSS-COD-VCAM IN WSS-VARI NOT = '*'
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
              MOVE WSS-COD-VCAM IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
               IF MSG-GLS-MENS = 'COD    NEX'
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR VALIDACION COD. MONEDA: ' WSS-COD-VCAM
                  PERFORM GNS-PRO-ABT.

           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DINI IN WSS-VDP.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MINI IN WSS-VDP.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SINI IN WSS-VDP.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AINI IN WSS-VDP.
           MOVE WSS-NUM-DFIN IN WSS-VARI TO WSS-NUM-DFIN IN WSS-VDP.
           MOVE WSS-NUM-MFIN IN WSS-VARI TO WSS-NUM-MFIN IN WSS-VDP.
           MOVE WSS-NUM-SFIN IN WSS-VARI TO WSS-NUM-SFIN IN WSS-VDP.
           MOVE WSS-NUM-AFIN IN WSS-VARI TO WSS-NUM-AFIN IN WSS-VDP.
           DISPLAY ' '.
           DISPLAY 'FIN VALIDACION PARAMETROS '.
           DISPLAY ' '.
      *>>>>
           SORT GNSSRT
       COPY DAPRSVDP.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
       FST-INP-SRT.
      *<<<< INI_FST_INP
      *OBT-FEC-HOY Obtiene Fecha Hoy
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO WSS-NUM-DPRO IN WSS-VDP.
           MOVE HOY-MHOY TO WSS-NUM-MPRO IN WSS-VDP.
           MOVE HOY-SHOY TO WSS-NUM-SPRO IN WSS-VDP.
           MOVE HOY-AHOY TO WSS-NUM-APRO IN WSS-VDP.

           MOVE WSS-NUM-DINI IN WSS-VARI TO VEN-NUM-DVEN IN VEN.
           MOVE WSS-NUM-MINI IN WSS-VARI TO VEN-NUM-MVEN IN VEN.
           MOVE WSS-NUM-SINI IN WSS-VARI TO VEN-NUM-SVEN IN VEN.
           MOVE WSS-NUM-AINI IN WSS-VARI TO VEN-NUM-AVEN IN VEN.
           MOVE WSS-NUM-DFIN IN WSS-VARI TO WSS-NUM-DTER IN WSS-VARI.
           MOVE WSS-NUM-MFIN IN WSS-VARI TO WSS-NUM-MTER IN WSS-VARI.
           MOVE WSS-NUM-SFIN IN WSS-VARI TO WSS-NUM-STER IN WSS-VARI.
           MOVE WSS-NUM-AFIN IN WSS-VARI TO WSS-NUM-ATER IN WSS-VARI.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL ACCESAR VEN POR VEN-FEC-FVEN : '
                         VEN-FEC-FVEN IN VEN ' FS: ' FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FTER IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS VEN EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI
                       ' A    ' WSS-FEC-FFIN IN WSS-VARI
               GO TO FIN-INP-SRT
           ELSE
               GO TO LUP-INP-SRT.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           IF VEN-VAL-SFIN IN VEN = ZEROES
              GO TO NXT-INP-SRT.

           PERFORM GET-OPD-VEN.
           IF WSS-STAT-OPD IN WSS-VARI = 1
              DISPLAY ' '
              DISPLAY 'NO EXISTE OPD PARA VEN ' VEN-CIC-IOPD IN VEN
              GO TO NXT-INP-SRT.

           IF OPD-VAL-SCAP IN OPD = ZEROES
              GO TO NXT-INP-SRT.

           IF OPD-COD-STAT IN OPD NOT = 'G'
              GO TO NXT-INP-SRT.

           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              IF WSS-COD-OFIC IN WSS-VARI NOT = OPD-COD-OFIC IN OPD
                 GO TO NXT-INP-SRT.

           IF WSS-COD-EJEC IN WSS-VARI > SPACES AND
              WSS-COD-EJEC IN WSS-VARI NOT = '*'
              IF WSS-COD-EJEC IN WSS-VARI NOT = OPD-COD-EJEC IN OPD
                 GO TO NXT-INP-SRT.

           IF WSS-COD-VCAM IN WSS-VARI > SPACES AND
              WSS-COD-VCAM IN WSS-VARI NOT = '*'
              IF WSS-COD-VCAM IN WSS-VARI NOT = OPD-COD-VCAM IN OPD
                 GO TO NXT-INP-SRT.

           IF WSS-IND-TOPE = 'S'
               IF OPD-COD-VCAM IN OPD = '0999  '
      **#             IF VEN-VAL-SCAP IN VEN < 30000000
                   IF VEN-VAL-CAPI IN VEN < 30000000
                        GO TO NXT-INP-SRT
                   ELSE
                        NEXT SENTENCE
               ELSE
               IF OPD-COD-VCAM IN OPD = '0998  '
      **#             IF VEN-VAL-SCAP IN VEN < 2000
                   IF VEN-VAL-CAPI IN VEN < 2000
                        GO TO NXT-INP-SRT
                   ELSE
                        NEXT SENTENCE
               ELSE
      **#         IF OPD-COD-VCAM IN OPD = '1013  '
                   IF VEN-VAL-CAPI IN VEN < 30000
                        GO TO NXT-INP-SRT.

           SUBTRACT VEN-VAL-CAPI IN VEN FROM VEN-VAL-FINA IN VEN
                    GIVING SRT-VAL-INTE IN SRT.
           IF OPD-COD-VCAM IN OPD = '1013  '
                MOVE SRT-VAL-INTE IN SRT TO SRT-VAL-SUMI IN SRT
           ELSE
                MOVE ZEROES TO SRT-VAL-SUMI IN SRT.
           MOVE 1 TO SRT-NUM-NOPD IN SRT.
      *>>>>
       MOV-INP-SRT.
       COPY DAPRMVDP.
      *<<<< RM
           MOVE OPD-CAI-ORIG IN OPD TO OPD-CAI-IOPD IN SRT
                                       VEN-CAI-IOPD IN SRT.
           MOVE OPD-IIC-ORIG IN OPD TO OPD-IIC-IOPD IN SRT
                                       VEN-IIC-IOPD IN SRT.
           MOVE OPD-CIC-ORIG IN OPD TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           MOVE OPD-CAI-ISER IN OPD TO OPD-CAI-ISER IN SRT.
           MOVE OPD-IIC-ISER IN OPD TO OPD-IIC-ISER IN SRT.
      **********************************
      *CPZ 16.08.93 CONVIERTE UF A PESOS
      **********************************
      * OBTIENE VALOR DE CAMBIO DE LA UF A FECHA VENCIMIENTO
           IF OPD-COD-VCAM  IN SRT = '0998  '
              PERFORM TRANSFORM-PESOS.
      **********************************
      *>>>>
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
      *Ubica registro en VEN por fecha
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
      *<<<< FIN_NXT_INP
      *Controla ingreso de registros por fecha termino
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FTER IN WSS-VARI
              GO TO FIN-INP-SRT.
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *<<<< FIN_INP
       TRANSFORM-PESOS.
      *----------------
           MOVE VEN-FEC-FVEN IN SRT      TO CAM-FEC-FCAM IN CAM(1)
           MOVE VEN-FEC-FVEN IN SRT      TO CAM-FEC-FCAM IN CAM(2)
           MOVE WSS-COD-0998             TO CAM-COD-VCAM IN CAM(1)
           MOVE WSS-COD-0999             TO CAM-COD-VCAM IN CAM(2)
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY 'PROCESO CANCELADO ' FIO-STAT
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        VEN-FEC-FVEN IN SRT      ' PARA LA UF.'
               PERFORM GNS-PRO-ABT
           ELSE
              IF CAM-IND-VIGE NOT = 'S'
               DISPLAY ' '
               DISPLAY 'PROCESO CANCELADO ' FIO-STAT
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        VEN-FEC-FVEN IN SRT      ' PARA LA UF.'
               PERFORM GNS-PRO-ABT
               ELSE
                COMPUTE WSS-VALOR-PESOS    =
                CAM-SGV-VCAM  IN CAM *  SRT-VAL-INTE IN SRT
                MOVE WSS-VALOR-PESOS  TO SRT-VAL-INTE IN SRT
                COMPUTE WSS-VALOR-PESOS    =
                CAM-SGV-VCAM  IN CAM *  VEN-VAL-FINA IN SRT
                MOVE WSS-VALOR-PESOS  TO VEN-VAL-FINA IN SRT.
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM DAP-FIO-VEN.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
      *<<<< INI_OUT
      *Limpia FIO-AKEY para acceso a otras FIO
           MOVE SPACES TO FIO-AKEY.
      *>>>>
           OPEN OUTPUT RPTVDP.
      *     MOVE 'DAPPLVDP' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.

      ***** CRW-COMIENZO
      *    INITIATE RPT-VDP.
      ***** CRW-FINAL

           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.

      ***** CRW-COMIENZO
           MOVE OPD-COD-COPD IN SRT TO RPT-CTRL-COD-COPD.
           MOVE OPD-COD-OFIC IN SRT TO RPT-CTRL-COD-OFIC.
           MOVE OPD-COD-VCAM IN SRT TO RPT-CTRL-COD-VCAM
           MOVE VEN-FEC-FVEN IN SRT TO RPT-CTRL-FEC-FVEN
           PERFORM DEC-CF-VDP-OPD-COD-COPD.
           PERFORM DEC-PH-VDP.
           MOVE WSS-GLS-COPD IN WSS-VDP TO RPT-AUXI-GLS-COPD
           MOVE WSS-GLS-VCAM IN WSS-VDP TO RPT-AUXI-GLS-VCAM.
      ***** CRW-FINAL

       LUP-OUT-SRT.
      *<<<< LUP_OUT
      * Obtiene Datos desde RCC y RCD para datos clientes en VDP
           PERFORM GET-CUR-RCC.
           IF WSS-STAT-RCC IN WSS-VARI = 1
              PERFORM RST-DBC
              PERFORM RST-RCD

      ***** CRW-COMIENZO
      *       GENERATE DL-VD1
              PERFORM GENERATE-DL-VD1

      ***** CRW-FINAL

              GO TO GEN-TOT
           ELSE
              PERFORM GET-RCC-DBC
              PERFORM GET-RCC-RCD

      ***** CRW-COMIENZO
      *       GENERATE DL-VD1.
              PERFORM GENERATE-DL-VD1.

      ***** CRW-FINAL


       CIC-RCC.
           PERFORM GET-NXT-RCC
           IF WSS-IND-MCLI IN WSS-VARI = 'M'
              PERFORM GET-RCC-DBC
              PERFORM GET-RCC-RCD

      ***** CRW-COMIENZO
      *       GENERATE DL-VD1
              PERFORM GENERATE-DL-VD1

      ***** CRW-FINAL

              GO TO CIC-RCC.
      *>>>>
       GEN-OUT-SRT.

      ***** CRW-COMIENZO
      *    GENERATE DL-VDP.
           PERFORM GENERATE-DL-VDP.

      ***** CRW-FINAL

      *<<<< FIN_GEN_OUT
       GEN-TOT.
      * Acumula numero de operaciones y totales.
           ADD SRT-NUM-NOPD IN SRT TO WSS-NUM-TOTF IN WSS-VARI.
      *>>>>
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.

      ***** CRW-COMIENZO
      *    TERMINATE RPT-VDP.
           MOVE WSS-GLS-COPD IN WSS-VDP TO RPT-CTRL-GLS-COPD
           MOVE WSS-GLS-VCAM IN WSS-VDP TO RPT-CTRL-GLS-VCAM
           MOVE WSS-NUM-DVEN IN WSS-VDP TO RPT-CTRL-NUM-DVEN
           MOVE WSS-NUM-MVEN IN WSS-VDP TO RPT-CTRL-NUM-MVEN
           MOVE WSS-NUM-SVEN IN WSS-VDP TO RPT-CTRL-NUM-SVEN
           MOVE WSS-NUM-AVEN IN WSS-VDP TO RPT-CTRL-NUM-AVEN
           MOVE RPT-TOTA-VAL-FINA TO RPT-CTRL-VAL-FINA
           MOVE RPT-TOTA-VAL-SUMI TO RPT-CTRL-VAL-SUMI
           MOVE SPACES TO RPTVDP-REG.
           WRITE RPTVDP-REG.
           WRITE RPTVDP-REG FROM  CF-VDP-12
           WRITE RPTVDP-REG FROM  CF-VDP-13
           MOVE SPACES TO RPTVDP-REG.
           WRITE RPTVDP-REG.
           ADD 3 TO RPT-VARI-LINEA.

      ***** CRW-FINAL

           CLOSE RPTVDP.
           GO TO EXT-OUT-SRT.

      ***** CRW-COMIENZO

       GENERATE-DL-VDP.
      *****************
           MOVE VEN-CAI-IOPD IN SRT     TO RPT-DETA-CAI-IOPD
           MOVE VEN-IIC-IOPD IN SRT     TO RPT-DETA-IIC-IOPD
           MOVE OPD-CAI-ISER IN SRT     TO RPT-DETA-CAI-ISER
           MOVE OPD-IIC-ISER IN SRT     TO RPT-DETA-IIC-ISER
           MOVE VEN-NUM-IVEN IN SRT     TO RPT-DETA-NUM-IVEN
           MOVE OPD-NUM-DREA IN SRT     TO RPT-DETA-NUM-DREA
           MOVE OPD-NUM-MREA IN SRT     TO RPT-DETA-NUM-MREA
           MOVE OPD-NUM-SREA IN SRT     TO RPT-DETA-NUM-SREA
           MOVE OPD-NUM-AREA IN SRT     TO RPT-DETA-NUM-AREA
           MOVE OPD-SGV-TINT IN SRT     TO RPT-DETA-SGV-TINT
           MOVE VEN-VAL-FINA IN SRT     TO RPT-DETA-VAL-FINA
           MOVE SRT-VAL-INTE IN SRT     TO RPT-DETA-VAL-INTE
           MOVE WSS-GLS-BLK1 IN WSS-VDP TO RPT-DETA-GLS-BLK1

           IF RPT-VARI-LINEA > 59 OR RPT-VARI-PAGE-COUNTER = 0 OR
              OPD-COD-COPD IN SRT NOT = RPT-CTRL-COD-COPD      OR
              OPD-COD-OFIC IN SRT NOT = RPT-CTRL-COD-OFIC      OR
              VEN-FEC-FVEN IN SRT NOT = RPT-CTRL-FEC-FVEN      OR
              OPD-COD-VCAM IN SRT NOT = RPT-CTRL-COD-VCAM
              IF OPD-COD-COPD IN SRT NOT = RPT-CTRL-COD-COPD OR
                 VEN-FEC-FVEN IN SRT NOT = RPT-CTRL-FEC-FVEN
                 MOVE RPT-AUXI-GLS-VCAM       TO RPT-CTRL-GLS-VCAM
                 MOVE RPT-AUXI-GLS-COPD       TO RPT-CTRL-GLS-COPD
                 MOVE WSS-NUM-DVEN IN WSS-VDP TO RPT-CTRL-NUM-DVEN
                 MOVE WSS-NUM-MVEN IN WSS-VDP TO RPT-CTRL-NUM-MVEN
                 MOVE WSS-NUM-SVEN IN WSS-VDP TO RPT-CTRL-NUM-SVEN
                 MOVE WSS-NUM-AVEN IN WSS-VDP TO RPT-CTRL-NUM-AVEN
                 MOVE RPT-TOTA-VAL-FINA TO RPT-CTRL-VAL-FINA
                 MOVE RPT-TOTA-VAL-SUMI TO RPT-CTRL-VAL-SUMI
                 MOVE SPACES TO RPTVDP-REG
                 WRITE RPTVDP-REG
                 WRITE RPTVDP-REG
                 WRITE RPTVDP-REG FROM  CF-VDP-12
                 WRITE RPTVDP-REG FROM  CF-VDP-13
                 MOVE SPACES TO RPTVDP-REG
                 WRITE RPTVDP-REG
                 WRITE RPTVDP-REG
                 ADD 6 TO RPT-VARI-LINEA
                 MOVE 0 TO RPT-TOTA-VAL-FINA RPT-TOTA-VAL-SUMI
                 MOVE WSS-GLS-COPD IN WSS-VDP TO RPT-AUXI-GLS-COPD
                 MOVE WSS-GLS-VCAM IN WSS-VDP TO RPT-AUXI-GLS-VCAM
                 IF OPD-COD-COPD IN SRT NOT = RPT-CTRL-COD-COPD
                    MOVE OPD-COD-COPD IN SRT TO RPT-CTRL-COD-COPD
                 END-IF
                 IF VEN-FEC-FVEN IN SRT NOT = RPT-CTRL-FEC-FVEN
                    MOVE VEN-FEC-FVEN IN SRT TO RPT-CTRL-FEC-FVEN
                 END-IF
              ELSE
                 IF RPT-VARI-LINEA > 59 OR RPT-VARI-PAGE-COUNTER = 0 OR
                    OPD-COD-OFIC IN SRT NOT = RPT-CTRL-COD-OFIC
                    PERFORM TITULOS
                    MOVE OPD-COD-OFIC IN SRT TO RPT-CTRL-COD-OFIC
                 END-IF
              END-IF
           END-IF.
           ADD  VEN-VAL-FINA IN SRT     TO RPT-TOTA-VAL-FINA
           ADD  SRT-VAL-SUMI IN SRT     TO RPT-TOTA-VAL-SUMI
           WRITE RPTVDP-REG FROM  DL-VDP-10.
           WRITE RPTVDP-REG FROM  DL-VDP-11.
           ADD 2 TO RPT-VARI-LINEA.

       GENERATE-DL-VD1.
      *****************
           PERFORM DEC-CF-VDP-OPD-COD-COPD.
           PERFORM DEC-PH-VDP.
           MOVE DBC-GLS-NOMC IN DBC            TO RPT-DETA-GLS-NOMC
           MOVE DBC-NUM-ICLI IN DBC            TO RPT-DETA-NUM-ICLI
           MOVE DBC-VRF-ICLI IN DBC            TO RPT-DETA-VRF-ICLI
           MOVE RCD-GLS-DIRE IN RCD            TO RPT-DETA-GLS-DIRE
           MOVE RCD-GLS-FONO IN RCD            TO RPT-DETA-GLS-FONO
           IF RPT-VARI-LINEA > 59 OR RPT-VARI-PAGE-COUNTER = 0 OR
              OPD-COD-COPD IN SRT NOT = RPT-CTRL-COD-COPD      OR
              OPD-COD-OFIC IN SRT NOT = RPT-CTRL-COD-OFIC      OR
              VEN-FEC-FVEN IN SRT NOT = RPT-CTRL-FEC-FVEN      OR
              OPD-COD-VCAM IN SRT NOT = RPT-CTRL-COD-VCAM
              IF OPD-COD-COPD IN SRT NOT = RPT-CTRL-COD-COPD OR
                 VEN-FEC-FVEN IN SRT NOT = RPT-CTRL-FEC-FVEN
                 MOVE RPT-AUXI-GLS-VCAM       TO RPT-CTRL-GLS-VCAM
                 MOVE RPT-AUXI-GLS-COPD       TO RPT-CTRL-GLS-COPD
                 MOVE WSS-NUM-DVEN IN WSS-VDP TO RPT-CTRL-NUM-DVEN
                 MOVE WSS-NUM-MVEN IN WSS-VDP TO RPT-CTRL-NUM-MVEN
                 MOVE WSS-NUM-SVEN IN WSS-VDP TO RPT-CTRL-NUM-SVEN
                 MOVE WSS-NUM-AVEN IN WSS-VDP TO RPT-CTRL-NUM-AVEN
                 MOVE RPT-TOTA-VAL-FINA TO RPT-CTRL-VAL-FINA
                 MOVE RPT-TOTA-VAL-SUMI TO RPT-CTRL-VAL-SUMI
                 MOVE SPACES TO RPTVDP-REG
                 WRITE RPTVDP-REG
                 WRITE RPTVDP-REG
                 WRITE RPTVDP-REG FROM  CF-VDP-12
                 WRITE RPTVDP-REG FROM  CF-VDP-13
                 MOVE SPACES TO RPTVDP-REG
                 WRITE RPTVDP-REG
                 WRITE RPTVDP-REG
                 ADD 6 TO RPT-VARI-LINEA
                 MOVE 0 TO RPT-TOTA-VAL-FINA RPT-TOTA-VAL-SUMI
                 IF OPD-COD-COPD IN SRT NOT = RPT-CTRL-COD-COPD
                    MOVE OPD-COD-COPD IN SRT TO RPT-CTRL-COD-COPD
                 END-IF
                 IF VEN-FEC-FVEN IN SRT NOT = RPT-CTRL-FEC-FVEN
                    MOVE VEN-FEC-FVEN IN SRT TO RPT-CTRL-FEC-FVEN
                 END-IF
                 MOVE WSS-GLS-COPD IN WSS-VDP TO RPT-AUXI-GLS-COPD
                 MOVE WSS-GLS-VCAM IN WSS-VDP TO RPT-AUXI-GLS-VCAM
              ELSE
                 IF RPT-VARI-LINEA > 59 OR RPT-VARI-PAGE-COUNTER = 0 OR
                    OPD-COD-OFIC IN SRT NOT = RPT-CTRL-COD-OFIC
                    PERFORM TITULOS
                    MOVE OPD-COD-OFIC IN SRT TO RPT-CTRL-COD-OFIC
                 END-IF
              END-IF
           END-IF.
           WRITE RPTVDP-REG FROM  DL-VD1-09
           ADD 1 TO RPT-VARI-LINEA.

       TITULOS.
      *********
           MOVE RPT-DUSU                       TO RPT-HEAD-DUSU
           MOVE WSS-NUM-DPRO IN WSS-VDP        TO RPT-HEAD-NUM-DPRO
           MOVE WSS-NUM-MPRO IN WSS-VDP        TO RPT-HEAD-NUM-MPRO
           MOVE WSS-NUM-SPRO IN WSS-VDP        TO RPT-HEAD-NUM-SPRO
           MOVE WSS-NUM-APRO IN WSS-VDP        TO RPT-HEAD-NUM-APRO
           MOVE RPT-FDMA                       TO RPT-HEAD-FDMA
           MOVE RPT-DSIS                       TO RPT-HEAD-DSIS
           MOVE WSS-NUM-DINI IN WSS-VDP        TO RPT-HEAD-NUM-DINI
           MOVE WSS-NUM-MINI IN WSS-VDP        TO RPT-HEAD-NUM-MINI
           MOVE WSS-NUM-SINI IN WSS-VDP        TO RPT-HEAD-NUM-SINI
           MOVE WSS-NUM-AINI IN WSS-VDP        TO RPT-HEAD-NUM-AINI
           MOVE WSS-NUM-DFIN IN WSS-VDP        TO RPT-HEAD-NUM-DFIN
           MOVE WSS-NUM-MFIN IN WSS-VDP        TO RPT-HEAD-NUM-MFIN
           MOVE WSS-NUM-SFIN IN WSS-VDP        TO RPT-HEAD-NUM-SFIN
           MOVE WSS-NUM-AFIN IN WSS-VDP        TO RPT-HEAD-NUM-AFIN
           MOVE WSS-GLS-BLK0 IN WSS-VDP        TO RPT-HEAD-GLS-BLK0
           MOVE OFI-GLS-DESC IN OFI            TO RPT-HEAD-GLS-DESC

           ADD 1 TO RPT-VARI-PAGE-COUNTER
           MOVE RPT-VARI-PAGE-COUNTER TO RPT-HEAD-PAGE-COUNTER
           MOVE SPACES TO RPTVDP-REG.
           WRITE RPTVDP-REG AFTER PAGE.
           WRITE RPTVDP-REG FROM  PH-VDP-01
           WRITE RPTVDP-REG FROM  PH-VDP-02
           WRITE RPTVDP-REG FROM  PH-VDP-03
           WRITE RPTVDP-REG FROM  PH-VDP-04
           WRITE RPTVDP-REG FROM  PH-VDP-05
           WRITE RPTVDP-REG FROM  PH-VDP-06
           WRITE RPTVDP-REG FROM  PH-VDP-07
           WRITE RPTVDP-REG FROM  PH-VDP-08
           MOVE 10 TO RPT-VARI-LINEA.

      ***** CRW-FINAL

       EXT-OUT-SRT.
           EXIT.
       COPY DAPBFVEN.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF
       GET-OPD-VEN SECTION.
       INI-GET-OPD-VEN.
           MOVE 0 TO WSS-STAT-OPD IN WSS-VARI.
           MOVE VEN-CIC-IOPD IN VEN TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WSS-STAT-OPD IN WSS-VARI.
       FIN-GET-OPD-VEN.
           EXIT.

       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE 0  TO WSS-STAT-RCC IN WSS-VARI.
           MOVE OPD-CAI-IOPD IN SRT TO RCC-CAI-IOPD IN RCC.
           MOVE OPD-IIC-IOPD IN SRT TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WSS-STAT-RCC IN WSS-VARI.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF FIO-STAT-OKS AND
              OPD-CAI-IOPD IN SRT = RCC-CAI-IOPD IN RCC AND
              OPD-IIC-IOPD IN SRT = RCC-IIC-IOPD IN RCC
                MOVE 'M'    TO WSS-IND-MCLI IN WSS-VARI
           ELSE
                MOVE SPACES TO WSS-IND-MCLI IN WSS-VARI.
       FIN-GET-NXT-RCC.
           EXIT.

      * Lee con CIC CLIENTE archivo DBC
       GET-RCC-DBC SECTION.
       INI-GET-RCC-DBC.
           MOVE RCC-CIC-ICLI IN RCC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              PERFORM RST-DBC
           ELSE
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
       FIN-GET-RCC-DBC.
           EXIT.

      * Limpia datos cliente desde DBC
       RST-DBC SECTION.
       INI-RST-DBC.
           MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC.
           MOVE SPACES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.

      * Lee con CIC CLIENTE archivo RCD
       GET-RCC-RCD SECTION.
       INI-GET-RCC-RCD.
           MOVE RCC-CIC-ICLI IN RCC TO RCD-CIC-ICLI IN RCD.
           MOVE RCC-NUM-DIRE IN RCC TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
              PERFORM RST-RCD.
       FIN-GET-RCC-RCD.
           EXIT.

      * Limpia datos cliente desde RDC
       RST-RCD SECTION.
       INI-RST-RCD.
           MOVE 'FONO INEXIS' TO RCD-GLS-FONO IN RCD.
           MOVE 'DIRECCION INEXISTENTE' TO RCD-GLS-DIRE IN RCD.
       FIN-RST-RCD.
           EXIT.

      *Entidades  de GNS
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
       COPY GNSBGCPT.

      *Entidades  de TAB
       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFUSR.
       COPY TABBBUSR.
       COPY TABBVUSR.

      *Entidades  de DAP
       COPY DAPBFRCC.
       COPY DAPBFOPD.

      *Entidades  de SGC
       COPY SGCBFDBC.
       COPY SGCBFRCD.
      *>>>>

