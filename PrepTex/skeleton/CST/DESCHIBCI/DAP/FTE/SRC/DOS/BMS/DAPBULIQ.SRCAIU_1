      *
      * DAPBULIQ
      * Version 3.0.1 Nov-2005
      * 20-Jul-10 04:09 PM
      *
       SET-TAG-DAPBULIQ SECTION.
       INI-SET-TAG-DAPBULIQ.
           MOVE
           '<IDNMOD NOM=$DAPBULIQ$ VSN=$09.01.14$ VGM=$3.0.1$
      -    'GEN=$20-Jul-10 04:09 PM$ FNC=$081102$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DAPBULIQ.
           EXIT.
           
       RET-ALL-LIQ SECTION.
       INI-RET-ALL-LIQ.
           PERFORM KEY-ALL-LIQ.
           PERFORM RET-OPD-LIQ.
           PERFORM RET-LIQ-LIQ.
           PERFORM RET-DBC-LIQ.
           PERFORM RET-CAD-LIQ.
           PERFORM RET-VEN-LIQ.
           PERFORM RET-DCL-LIQ.
       FIN-RET-ALL-LIQ.
           EXIT.
       
       RET-OPD-LIQ SECTION.
       INI-RET-OPD-LIQ.
           MOVE OPD-COD-VCAM IN LIQ-FLD TO OPD-COD-VCAM IN OPD.
           MOVE OPD-COD-TOPD IN LIQ-FLD TO OPD-COD-TOPD IN OPD.
           MOVE OPD-COD-AOPD IN LIQ-FLD TO OPD-COD-AOPD IN OPD.
           MOVE OPD-COD-EJEC IN LIQ-FLD TO OPD-COD-EJEC IN OPD.
           MOVE OPD-COD-OFIC IN LIQ-FLD TO OPD-COD-OFIC IN OPD.
           MOVE OPD-COD-GARA IN LIQ-FLD TO OPD-COD-GARA IN OPD.
           MOVE OPD-COD-IONP IN LIQ-FLD TO OPD-COD-IONP IN OPD.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE OPD-NUM-DCMP IN LIQ-FLD TO OPD-NUM-DCMP IN OPD.
           MOVE OPD-NUM-MCMP IN LIQ-FLD TO OPD-NUM-MCMP IN OPD.
           MOVE OPD-NUM-SCMP IN LIQ-FLD TO OPD-NUM-SCMP IN OPD.
           MOVE OPD-NUM-ACMP IN LIQ-FLD TO OPD-NUM-ACMP IN OPD.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE OPD-NUM-DREA IN LIQ-FLD TO OPD-NUM-DREA IN OPD.
           MOVE OPD-NUM-MREA IN LIQ-FLD TO OPD-NUM-MREA IN OPD.
           MOVE OPD-NUM-SREA IN LIQ-FLD TO OPD-NUM-SREA IN OPD.
           MOVE OPD-NUM-AREA IN LIQ-FLD TO OPD-NUM-AREA IN OPD.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE OPD-NUM-PVEN IN LIQ-FLD TO OPD-NUM-PVEN IN OPD.
           MOVE OPD-SGV-TINT IN LIQ-FLD TO OPD-SGV-TINT IN OPD.
           MOVE OPD-VAL-CAPT IN LIQ-FLD TO OPD-VAL-CAPT IN OPD.
           MOVE OPD-VAL-SCAP IN LIQ-FLD TO OPD-VAL-SCAP IN OPD.
       FIN-RET-OPD-LIQ.
           EXIT.
       
       RET-LIQ-LIQ SECTION.
       INI-RET-LIQ-LIQ.
           MOVE LIQ-COD-STAT IN LIQ-FLD TO LIQ-COD-STAT IN LIQ.
           MOVE LIQ-COD-EJEC IN LIQ-FLD TO LIQ-COD-EJEC IN LIQ.
           MOVE LIQ-COD-OFIC IN LIQ-FLD TO LIQ-COD-OFIC IN LIQ.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LIQ-NUM-DCTB IN LIQ-FLD TO LIQ-NUM-DCTB IN LIQ.
           MOVE LIQ-NUM-MCTB IN LIQ-FLD TO LIQ-NUM-MCTB IN LIQ.
           MOVE LIQ-NUM-SCTB IN LIQ-FLD TO LIQ-NUM-SCTB IN LIQ.
           MOVE LIQ-NUM-ACTB IN LIQ-FLD TO LIQ-NUM-ACTB IN LIQ.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LIQ-SGV-TLVP IN LIQ-FLD TO LIQ-SGV-TLVP IN LIQ.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LIQ-NUM-DCMP IN LIQ-FLD TO LIQ-NUM-DCMP IN LIQ.
           MOVE LIQ-NUM-MCMP IN LIQ-FLD TO LIQ-NUM-MCMP IN LIQ.
           MOVE LIQ-NUM-SCMP IN LIQ-FLD TO LIQ-NUM-SCMP IN LIQ.
           MOVE LIQ-NUM-ACMP IN LIQ-FLD TO LIQ-NUM-ACMP IN LIQ.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LIQ-NUM-DREA IN LIQ-FLD TO LIQ-NUM-DREA IN LIQ.
           MOVE LIQ-NUM-MREA IN LIQ-FLD TO LIQ-NUM-MREA IN LIQ.
           MOVE LIQ-NUM-SREA IN LIQ-FLD TO LIQ-NUM-SREA IN LIQ.
           MOVE LIQ-NUM-AREA IN LIQ-FLD TO LIQ-NUM-AREA IN LIQ.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LIQ-SGV-CAPI IN LIQ-FLD TO LIQ-SGV-CAPI IN LIQ.
           MOVE LIQ-SGV-TPAG IN LIQ-FLD TO LIQ-SGV-TPAG IN LIQ.
           MOVE LIQ-SGV-PESO IN LIQ-FLD TO LIQ-SGV-PESO IN LIQ.
       FIN-RET-LIQ-LIQ.
           EXIT.
       
       RET-DBC-LIQ SECTION.
       INI-RET-DBC-LIQ.
   *<<<<
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL             
           MOVE DBC-NUM-ICLI IN LIQ-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE DBC-VRF-ICLI IN LIQ-FLD TO DBC-VRF-ICLI IN DBC.         
           MOVE DBC-IND-ICLI IN LIQ-FLD TO DBC-IND-ICLI IN DBC.         
           MOVE DBC-GLS-ICLI IN LIQ-FLD TO DBC-GLS-ICLI IN DBC.         
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL             
   *>>>>
           MOVE DBC-GLS-NOMC IN LIQ-FLD TO DBC-GLS-NOMC IN DBC.
       FIN-RET-DBC-LIQ.
           EXIT.
       
       RET-CAD-LIQ SECTION.
       INI-RET-CAD-LIQ.
           MOVE CAD-IND-TCAD IN LIQ-FLD TO CAD-IND-TCAD IN CAD.
           MOVE CAD-CAI-ICAD IN LIQ-FLD TO CAD-CAI-ICAD IN CAD.
           MOVE CAD-IIC-ICAD IN LIQ-FLD TO CAD-IIC-ICAD IN CAD.
       FIN-RET-CAD-LIQ.
           EXIT.
       
       RET-VEN-LIQ SECTION.
       INI-RET-VEN-LIQ.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE VEN-NUM-DVEN IN LIQ-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN LIQ-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN LIQ-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN LIQ-FLD TO VEN-NUM-AVEN IN VEN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE VEN-VAL-FINA IN LIQ-FLD TO VEN-VAL-FINA IN VEN.
           MOVE VEN-VAL-SFIN IN LIQ-FLD TO VEN-VAL-SFIN IN VEN.
       FIN-RET-VEN-LIQ.
           EXIT.
       
       RET-DCL-LIQ SECTION.
       INI-RET-DCL-LIQ.
           MOVE DCL-COD-ACED IN LIQ-FLD TO DCL-COD-ACED IN DCL.
           MOVE DCL-SGV-RESC IN LIQ-FLD TO DCL-SGV-RESC IN DCL.
           MOVE DCL-SGV-KNEW IN LIQ-FLD TO DCL-SGV-KNEW IN DCL.
           MOVE DCL-SGV-FNEW IN LIQ-FLD TO DCL-SGV-FNEW IN DCL.
           MOVE DCL-SGV-INTD IN LIQ-FLD TO DCL-SGV-INTD IN DCL.
           MOVE DCL-SGV-PEGA IN LIQ-FLD TO DCL-SGV-PEGA IN DCL.
       FIN-RET-DCL-LIQ.
           EXIT.
       
       KEY-ALL-LIQ SECTION.
       INI-KEY-ALL-LIQ.
           PERFORM KEY-OPD-LIQ.
           PERFORM KEY-LIQ-LIQ.
           PERFORM KEY-DBC-LIQ.
           PERFORM KEY-CAD-LIQ.
           PERFORM KEY-VEN-LIQ.
           PERFORM KEY-DCL-LIQ.
       FIN-KEY-ALL-LIQ.
           EXIT.
       
       KEY-OPD-LIQ SECTION.
       INI-KEY-OPD-LIQ.
           MOVE OPD-CAI-ISER IN LIQ-FLD TO OPD-CAI-ISER IN OPD.
           MOVE OPD-IIC-ISER IN LIQ-FLD TO OPD-IIC-ISER IN OPD.
       FIN-KEY-OPD-LIQ.
           EXIT.
       
       KEY-LIQ-LIQ SECTION.
       INI-KEY-LIQ-LIQ.
           MOVE LIQ-CAI-IOPD IN LIQ-FLD TO LIQ-CAI-IOPD IN LIQ.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO LIQ-IIC-IOPD IN LIQ.
           MOVE LIQ-NUM-ILIQ IN LIQ-FLD TO LIQ-NUM-ILIQ IN LIQ.
       FIN-KEY-LIQ-LIQ.
           EXIT.
       
       KEY-DBC-LIQ SECTION.
       INI-KEY-DBC-LIQ.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN LIQ-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN LIQ-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN LIQ-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN LIQ-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-LIQ.
           EXIT.
       
       KEY-CAD-LIQ SECTION.
       INI-KEY-CAD-LIQ.
       FIN-KEY-CAD-LIQ.
           EXIT.
       
       KEY-VEN-LIQ SECTION.
       INI-KEY-VEN-LIQ.
       FIN-KEY-VEN-LIQ.
           EXIT.
       
       KEY-DCL-LIQ SECTION.
       INI-KEY-DCL-LIQ.
       FIN-KEY-DCL-LIQ.
           EXIT.
       
       SCR-CLRA-LIQ SECTION.
       INI-SCR-CLRA-LIQ.
           PERFORM CLR-KEY-LIQ.
           PERFORM CLR-FLD-LIQ.
       FIN-SCR-CLRA-LIQ.
           EXIT.
       
       CLR-KEY-LIQ SECTION.
       INI-CLR-KEY-LIQ.
           MOVE SPACES TO LIQ-CAI-IOPD IN LIQ-FLD.
           MOVE ZEROES TO LIQ-IIC-IOPD IN LIQ-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN LIQ-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN LIQ-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN LIQ-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN LIQ-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO OPD-CAI-ISER IN LIQ-FLD.
           MOVE ZEROES TO OPD-IIC-ISER IN LIQ-FLD.
           MOVE ZEROES TO LIQ-NUM-ILIQ IN LIQ-FLD.
       FIN-CLR-KEY-LIQ.
           EXIT.
       
       CLR-FLD-LIQ SECTION.
       INI-CLR-FLD-LIQ.
           MOVE SPACES TO FRM-GLS-VCAM IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-TOPD IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-AOPD IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-LIQU IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-EJEC-OPD IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-EJEC IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-OFIC-OPD IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN LIQ-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FLRE IN LIQ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-PLRE IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-TCAD IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-PVEN IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-TINT IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-SCAP IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-KNEW IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-IPAG IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-FNEW IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-INTD IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-ACED IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-PEGA IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-CAPI IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-INTE IN LIQ-FLD.
           MOVE SPACES TO FRM-GLS-SFIN IN LIQ-FLD.
           MOVE ZEROES TO FRM-SGV-INTE IN LIQ-FLD.
           MOVE ZEROES TO FRM-SGV-IPAG IN LIQ-FLD.
           PERFORM CLR-OPD-LIQ.
           PERFORM CLR-LIQ-LIQ.
           PERFORM CLR-DBC-LIQ.
           PERFORM CLR-CAD-LIQ.
           PERFORM CLR-VEN-LIQ.
           PERFORM CLR-DCL-LIQ.
       FIN-CLR-FLD-LIQ.
           EXIT.
       
       CLR-OPD-LIQ SECTION.
       INI-CLR-OPD-LIQ.
           MOVE SPACES TO OPD-COD-VCAM IN LIQ-FLD.
           MOVE SPACES TO OPD-COD-TOPD IN LIQ-FLD.
           MOVE SPACES TO OPD-COD-AOPD IN LIQ-FLD.
           MOVE SPACES TO OPD-COD-EJEC IN LIQ-FLD.
           MOVE SPACES TO OPD-COD-OFIC IN LIQ-FLD.
           MOVE SPACES TO OPD-COD-GARA IN LIQ-FLD.
           MOVE SPACES TO OPD-COD-IONP IN LIQ-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OPD-FEC-FCMP IN LIQ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OPD-FEC-FREA IN LIQ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OPD-NUM-PVEN IN LIQ-FLD.
           MOVE ZEROES TO OPD-SGV-TINT IN LIQ-FLD.
           MOVE ZEROES TO OPD-VAL-CAPT IN LIQ-FLD.
           MOVE ZEROES TO OPD-VAL-SCAP IN LIQ-FLD.
       FIN-CLR-OPD-LIQ.
           EXIT.
       
       CLR-LIQ-LIQ SECTION.
       INI-CLR-LIQ-LIQ.
           MOVE SPACES TO LIQ-COD-STAT IN LIQ-FLD.
           MOVE SPACES TO LIQ-COD-EJEC IN LIQ-FLD.
           MOVE SPACES TO LIQ-COD-OFIC IN LIQ-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LIQ-FEC-FCTB IN LIQ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LIQ-SGV-TLVP IN LIQ-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LIQ-FEC-FCMP IN LIQ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LIQ-FEC-FREA IN LIQ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LIQ-SGV-CAPI IN LIQ-FLD.
           MOVE ZEROES TO LIQ-SGV-TPAG IN LIQ-FLD.
           MOVE ZEROES TO LIQ-SGV-PESO IN LIQ-FLD.
       FIN-CLR-LIQ-LIQ.
           EXIT.
       
       CLR-DBC-LIQ SECTION.
       INI-CLR-DBC-LIQ.
    *<<<<INI_CLR_DBC_LIQ
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )                
           MOVE ZEROES TO DBC-NUM-ICLI IN LIQ-FLD.                      
           MOVE SPACES TO DBC-VRF-ICLI IN LIQ-FLD.                      
           MOVE SPACES TO DBC-IND-ICLI IN LIQ-FLD.                      
           MOVE SPACES TO DBC-GLS-ICLI IN LIQ-FLD.                      
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )                
    *>>>>
           MOVE SPACES TO DBC-GLS-NOMC IN LIQ-FLD.
       FIN-CLR-DBC-LIQ.
           EXIT.
       
       CLR-CAD-LIQ SECTION.
       INI-CLR-CAD-LIQ.
           MOVE SPACES TO CAD-IND-TCAD IN LIQ-FLD.
           MOVE SPACES TO CAD-CAI-ICAD IN LIQ-FLD.
           MOVE ZEROES TO CAD-IIC-ICAD IN LIQ-FLD.
       FIN-CLR-CAD-LIQ.
           EXIT.
       
       CLR-VEN-LIQ SECTION.
       INI-CLR-VEN-LIQ.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO VEN-FEC-FVEN IN LIQ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO VEN-VAL-FINA IN LIQ-FLD.
           MOVE ZEROES TO VEN-VAL-SFIN IN LIQ-FLD.
       FIN-CLR-VEN-LIQ.
           EXIT.
       
       CLR-DCL-LIQ SECTION.
       INI-CLR-DCL-LIQ.
           MOVE SPACES TO DCL-COD-ACED IN LIQ-FLD.
           MOVE ZEROES TO DCL-SGV-RESC IN LIQ-FLD.
           MOVE ZEROES TO DCL-SGV-KNEW IN LIQ-FLD.
           MOVE ZEROES TO DCL-SGV-FNEW IN LIQ-FLD.
           MOVE ZEROES TO DCL-SGV-INTD IN LIQ-FLD.
           MOVE ZEROES TO DCL-SGV-PEGA IN LIQ-FLD.
       FIN-CLR-DCL-LIQ.
           EXIT.
       
       FST-KEY-LIQ SECTION.
       INI-FST-KEY-LIQ.
           MOVE -1 TO LIQ-CAI-IOPD-LEN IN LIQ-FLD.
       FIN-FST-KEY-LIQ.
           EXIT.
       
       FST-FLD-LIQ SECTION.
       INI-FST-FLD-LIQ.
      *<<<< INI_FST_FLD_LIQ
           IF SCR-CMND = 'CVP' OR
              SCR-CMND = 'CRP'
                MOVE -1 TO LIQ-FEC-FREA-LEN IN LIQ-FLD
                GO TO FIN-FST-FLD-LIQ.
      
           IF SCR-CMND = 'SLA' OR
              SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
                MOVE -1 TO LIQ-COD-EJEC-LEN IN LIQ-FLD
                GO TO FIN-FST-FLD-LIQ.
      *ADA-INI 03-JUL-2002
           IF SCR-CMND = 'MCA'
                MOVE -1 TO CAD-IND-TCAD-LEN IN LIQ-FLD
                GO TO FIN-FST-FLD-LIQ.
      *ADA-FIN 03-JUL-2002
      *>>>> INI_FST_KEY_LIQ
           MOVE -1 TO OPD-COD-VCAM-LEN IN LIQ-FLD.
       FIN-FST-FLD-LIQ.
           EXIT.
       
       PRO-KEY-LIQ SECTION.
       INI-PRO-KEY-LIQ.
           PERFORM PRO-MKY-LIQ.
       FIN-PRO-KEY-LIQ.
           EXIT.
       
       PRO-MKY-LIQ SECTION.
       INI-PRO-MKY-LIQ.
       FIN-PRO-MKY-LIQ.
           EXIT.
       
       PRO-FLD-LIQ SECTION.
       INI-PRO-FLD-LIQ.
           MOVE FRM-CPIM-AEY TO FRM-GLS-VCAM-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-TOPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-AOPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-LIQU-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-STAT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-EJEC-OPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-EJEC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-OFIC-OPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-OFIC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-FEC-FLRE-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-PLRE-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-TCAD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-PVEN-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-TINT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-SCAP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-KNEW-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-IPAG-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-FNEW-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-INTD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ACED-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-PEGA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-CAPI-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-INTE-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-SFIN-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-INTE-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-IPAG-ATR IN LIQ-FLD.
           PERFORM PRO-OPD-LIQ.
           PERFORM PRO-LIQ-LIQ.
           PERFORM PRO-DBC-LIQ.
           PERFORM PRO-CAD-LIQ.
           PERFORM PRO-VEN-LIQ.
           PERFORM PRO-DCL-LIQ.
       FIN-PRO-FLD-LIQ.
           EXIT.
       
       PRO-OPD-LIQ SECTION.
       INI-PRO-OPD-LIQ.
           MOVE FRM-CPIM-AEY TO OPD-COD-VCAM-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-COD-TOPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-COD-AOPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-COD-EJEC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-COD-OFIC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-COD-GARA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-COD-IONP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-FEC-FCMP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-FEC-FREA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-NUM-PVEN-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-SGV-TINT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-VAL-CAPT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO OPD-VAL-SCAP-ATR IN LIQ-FLD.
       FIN-PRO-OPD-LIQ.
           EXIT.
       
       PRO-LIQ-LIQ SECTION.
       INI-PRO-LIQ-LIQ.
           MOVE FRM-CPIM-AEY TO LIQ-COD-STAT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-COD-EJEC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-COD-OFIC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-FEC-FCTB-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-SGV-TLVP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-FEC-FCMP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-FEC-FREA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-SGV-CAPI-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-SGV-TPAG-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-SGV-PESO-ATR IN LIQ-FLD.
       FIN-PRO-LIQ-LIQ.
           EXIT.
       
       PRO-DBC-LIQ SECTION.
       INI-PRO-DBC-LIQ.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN LIQ-FLD.
       FIN-PRO-DBC-LIQ.
           EXIT.
       
       PRO-CAD-LIQ SECTION.
       INI-PRO-CAD-LIQ.
           MOVE FRM-CPIM-AEY TO CAD-IND-TCAD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO CAD-CAI-ICAD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO CAD-IIC-ICAD-ATR IN LIQ-FLD.
       FIN-PRO-CAD-LIQ.
           EXIT.
       
       PRO-VEN-LIQ SECTION.
       INI-PRO-VEN-LIQ.
           MOVE FRM-CPIM-AEY TO VEN-FEC-FVEN-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-FINA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-SFIN-ATR IN LIQ-FLD.
       FIN-PRO-VEN-LIQ.
           EXIT.
       
       PRO-DCL-LIQ SECTION.
       INI-PRO-DCL-LIQ.
           MOVE FRM-CPIM-AEY TO DCL-COD-ACED-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO DCL-SGV-RESC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO DCL-SGV-KNEW-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO DCL-SGV-FNEW-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO DCL-SGV-INTD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO DCL-SGV-PEGA-ATR IN LIQ-FLD.
       FIN-PRO-DCL-LIQ.
           EXIT.
       
       UNP-KEY-LIQ SECTION.
       INI-UNP-KEY-LIQ.
           PERFORM UNP-IKY-LIQ.
           PERFORM UNP-AKY-LIQ.
           PERFORM UNP-MKY-LIQ.
       FIN-UNP-KEY-LIQ.
           EXIT.
       
       UNP-IKY-LIQ SECTION.
       INI-UNP-IKY-LIQ.
           MOVE FRM-CPIM-UBY TO LIQ-CAI-IOPD-ATR.
           MOVE FRM-CPIM-UBY TO LIQ-IIC-IOPD-ATR.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN LIQ-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO OPD-CAI-ISER-ATR.
           MOVE FRM-CPIM-UBY TO OPD-IIC-ISER-ATR.
           MOVE FRM-CPIM-UBY TO LIQ-NUM-ILIQ-ATR.
      *<<<< FIN_UNP_IKY_LIQ
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO LIQ-NUM-ILIQ-ATR IN LIQ-FLD.
      *>>>>
       FIN-UNP-IKY-LIQ.
           EXIT.
       
       UNP-MKY-LIQ SECTION.
       INI-UNP-MKY-LIQ.
       FIN-UNP-MKY-LIQ.
           EXIT.
       
       UNP-AKY-LIQ SECTION.
       INI-UNP-AKY-LIQ.
       FIN-UNP-AKY-LIQ.
           EXIT.
       
       UNP-FLD-LIQ SECTION.
       INI-UNP-FLD-LIQ.
           MOVE FRM-CPIM-UBY TO FRM-GLS-VCAM-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-TOPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-AOPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-LIQU-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-STAT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-EJEC-OPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-EJEC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-OFIC-OPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-OFIC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FLRE-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-PLRE-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-TCAD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-PVEN-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-TINT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-SCAP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-KNEW-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-IPAG-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-FNEW-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-INTD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ACED-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-PEGA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-CAPI-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-INTE-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-SFIN-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-SGV-INTE-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-SGV-IPAG-ATR IN LIQ-FLD.
           PERFORM UNP-OPD-LIQ.
           PERFORM UNP-LIQ-LIQ.
           PERFORM UNP-DBC-LIQ.
           PERFORM UNP-CAD-LIQ.
           PERFORM UNP-VEN-LIQ.
           PERFORM UNP-DCL-LIQ.
       FIN-UNP-FLD-LIQ.
           EXIT.
       
       UNP-OPD-LIQ SECTION.
       INI-UNP-OPD-LIQ.
           MOVE FRM-CPIM-UBY TO OPD-COD-VCAM-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-COD-TOPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-COD-AOPD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-COD-EJEC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-COD-OFIC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-COD-GARA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-COD-IONP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-FEC-FCMP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-FEC-FREA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-NUM-PVEN-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-SGV-TINT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-VAL-CAPT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO OPD-VAL-SCAP-ATR IN LIQ-FLD.
       FIN-UNP-OPD-LIQ.
           EXIT.
       
       UNP-LIQ-LIQ SECTION.
       INI-UNP-LIQ-LIQ.
           MOVE FRM-CPIM-UBY TO LIQ-COD-STAT-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO LIQ-COD-EJEC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO LIQ-COD-OFIC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO LIQ-FEC-FCTB-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO LIQ-SGV-TLVP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO LIQ-FEC-FCMP-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO LIQ-FEC-FREA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO LIQ-SGV-CAPI-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO LIQ-SGV-TPAG-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO LIQ-SGV-PESO-ATR IN LIQ-FLD.
      *<<<< FIN_UNP_LIQ_LIQ
      * ISP: GASTOS PROTEGIDOS
      *     MOVE FRM-CPIM-AEY TO LIQ-SGV-GAST-ATR IN LIQ-FLD.
      
           IF SCR-CMND NOT = 'LVP' AND
              SCR-CMND NOT = 'CVP' AND
              SCR-CMND NOT = 'LRP' AND
              SCR-CMND NOT = 'CRP'
               MOVE FRM-CPIM-AEY TO LIQ-SGV-TLVP-ATR IN LIQ-FLD.

      *    si comandos NO son rescate o
      *    moneda no reajustable ( pesos o extranjera )
      *    protege monto en pesos
           IF ( SCR-CMND NOT = 'LRP' AND
                SCR-CMND NOT = 'CRP' )
                       OR
              ( SCR-CIC-VCAM = PDB-CIC-0999 OR
                SCR-CIC-TVAL = PDB-CIC-MEXT )
                    MOVE FRM-CPIM-AEY TO LIQ-SGV-PESO-ATR IN LIQ-FLD.
      
           IF SCR-CMND = 'CVP' OR
              SCR-CMND = 'CRP'
               MOVE FRM-CPIM-AEY TO LIQ-FEC-FCTB-ATR IN LIQ-FLD
               MOVE FRM-CPIM-AEY TO LIQ-COD-OFIC-ATR IN LIQ-FLD
               MOVE FRM-CPIM-AEY TO LIQ-COD-EJEC-ATR IN LIQ-FLD.
      
      *     IF NOT ( SCR-CMND = 'CVP' OR
      *              SCR-CMND = 'LVP' )
      *         MOVE FRM-CPIM-AEY TO LIQ-SGV-TPAG-ATR IN LIQ-FLD.
      *>>>> FIN_UNP_LIQ_LIQ
       FIN-UNP-LIQ-LIQ.
           EXIT.
       
       UNP-DBC-LIQ SECTION.
       INI-UNP-DBC-LIQ.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR IN LIQ-FLD.
       FIN-UNP-DBC-LIQ.
           EXIT.
       
       UNP-CAD-LIQ SECTION.
       INI-UNP-CAD-LIQ.
           MOVE FRM-CPIM-UBY TO CAD-IND-TCAD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO CAD-CAI-ICAD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO CAD-IIC-ICAD-ATR IN LIQ-FLD.
      *<<<< FIN_UNP_CAD_LIQ
      * ISP: GASTOS PROTEGIDOS
           IF SCR-CMND = 'CVP' OR
              SCR-CMND = 'CRP'
               MOVE FRM-CPIM-AEY TO CAD-IND-TCAD-ATR IN LIQ-FLD
               MOVE FRM-CPIM-AEY TO CAD-CAI-ICAD-ATR IN LIQ-FLD
               MOVE FRM-CPIM-AEY TO CAD-IIC-ICAD-ATR IN LIQ-FLD.
      *>>>> FIN_UNP_CAD_LIQ
       FIN-UNP-CAD-LIQ.
           EXIT.
       
       UNP-VEN-LIQ SECTION.
       INI-UNP-VEN-LIQ.
           MOVE FRM-CPIM-UBY TO VEN-FEC-FVEN-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO VEN-VAL-FINA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO VEN-VAL-SFIN-ATR IN LIQ-FLD.
       FIN-UNP-VEN-LIQ.
           EXIT.
       
       UNP-DCL-LIQ SECTION.
       INI-UNP-DCL-LIQ.
           MOVE FRM-CPIM-UBY TO DCL-COD-ACED-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO DCL-SGV-RESC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO DCL-SGV-KNEW-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO DCL-SGV-FNEW-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO DCL-SGV-INTD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-UBY TO DCL-SGV-PEGA-ATR IN LIQ-FLD.
      *<<<< FIN_UNP_DCL_LIQ
      * ISP: GASTOS PROTEGIDOS
           IF NOT ( SCR-CMND = 'CRP' OR
                    SCR-CMND = 'LRP' )
               MOVE FRM-CPIM-AEY TO DCL-SGV-RESC-ATR IN LIQ-FLD.
           IF SCR-CMND NOT = 'LVP' AND
              SCR-CMND NOT = 'LRP'
                MOVE FRM-CPIM-AEY TO DCL-COD-ACED-ATR IN LIQ-FLD.
      *>>>> FIN_UNP_DCL_LIQ
       FIN-UNP-DCL-LIQ.
           EXIT.
       
       VAL-MKY-LIQ SECTION.
       INI-VAL-MKY-LIQ.
       FIN-VAL-MKY-LIQ.
           EXIT.
       
       VAL-FLD-LIQ SECTION.
       INI-VAL-FLD-LIQ.
      *<<<< INI_VAL_FLD_LIQ
           PERFORM VAL-OPD-COD-VCAM.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO OPD-COD-VCAM-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-COD-TOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO OPD-COD-TOPD-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOPD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-COD-AOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO OPD-COD-AOPD-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-AOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-GLS-AOPD-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
           PERFORM VAL-DBC-IND-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                DBC-IND-ICLI-LEN IN LIQ-FLD                             
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-DBC-GLS-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                DBC-GLS-ICLI-LEN IN LIQ-FLD                             
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-DBC-NUM-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                DBC-NUM-ICLI-LEN IN LIQ-FLD                             
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-DBC-VRF-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                DBC-VRF-ICLI-LEN IN LIQ-FLD                             
                GO TO FIN-VAL-FLD-LIQ.                                  
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-LIQ-COD-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO LIQ-COD-STAT-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-LIQU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-LIQU-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-STAT-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-LIQ-COD-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-COD-EJEC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-COD-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-COD-EJEC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-EJEC-OPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EJEC-OPD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EJEC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-OPD-COD-OFIC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO OPD-COD-OFIC-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-OFIC-OPD.                                
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-OPD-LEN IN LIQ-FLD    
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-LIQ-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO LIQ-COD-OFIC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-OPD-COD-GARA.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO OPD-COD-GARA-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-OPD-COD-IONP.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO OPD-COD-IONP-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
           PERFORM VAL-OPD-FEC-FCMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                OPD-FEC-FCMP-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
           PERFORM VAL-FRM-FEC-FLRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                FRM-FEC-FLRE-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
           PERFORM VAL-LIQ-FEC-FCMP.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                LIQ-FEC-FCMP-LEN IN LIQ-FLD                             
                GO TO FIN-VAL-FLD-LIQ.                                  
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
           PERFORM VAL-LIQ-FEC-FREA.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                LIQ-FEC-FREA-LEN IN LIQ-FLD                             
                GO TO FIN-VAL-FLD-LIQ.                                  
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
           PERFORM VAL-LIQ-FEC-FCTB.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO                                    
                LIQ-FEC-FCTB-LEN IN LIQ-FLD                             
                GO TO FIN-VAL-FLD-LIQ.                                  
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]                
           PERFORM VAL-FRM-GLS-PLRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-GLS-PLRE-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-CAD-IND-TCAD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAD-IND-TCAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-TCAD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TCAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OPD-FEC-FREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                OPD-FEC-FREA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CAD-CAI-ICAD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAD-CAI-ICAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-CAD-IIC-ICAD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAD-IIC-ICAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-OPD-NUM-PVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO OPD-NUM-PVEN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-PVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PVEN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-VEN-FEC-FVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                VEN-FEC-FVEN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LIQ-SGV-TLVP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-SGV-TLVP-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TINT-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-OPD-SGV-TINT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO OPD-SGV-TINT-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-DCL-SGV-RESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO DCL-SGV-RESC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-VAL-CAPT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-VAL-CAPT-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-CAPI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CAPI-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-LIQ-SGV-CAPI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-SGV-CAPI-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-VEN-VAL-FINA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-FINA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-INTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-INTE-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-SGV-INTE.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-SGV-INTE-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-SCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SCAP-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-OPD-VAL-SCAP.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO OPD-VAL-SCAP-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-LIQ-SGV-TPAG.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO LIQ-SGV-TPAG-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-SFIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-GLS-SFIN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-VEN-VAL-SFIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-SFIN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-LIQ-SGV-PESO.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO LIQ-SGV-PESO-LEN IN LIQ-FLD        
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-KNEW.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-GLS-KNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-DCL-SGV-KNEW.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO DCL-SGV-KNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-IPAG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-GLS-IPAG-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-SGV-IPAG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-SGV-IPAG-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-FNEW.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-GLS-FNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-DCL-SGV-FNEW.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO DCL-SGV-FNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-FRM-GLS-INTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO FRM-GLS-INTD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           PERFORM VAL-DCL-SGV-INTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO DCL-SGV-INTD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-ACED.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ACED-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-DCL-COD-ACED.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCL-COD-ACED-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-PEGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PEGA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-DCL-SGV-PEGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCL-SGV-PEGA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.                                  
           GO TO FIN-VAL-FLD-LIQ.
      *>>>> INI_VAL_FLD_LIQ
           PERFORM VAL-OPD-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-COD-VCAM-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-COD-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-COD-TOPD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOPD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-COD-AOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-COD-AOPD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-AOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOPD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-LIQ-COD-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-COD-STAT-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-LIQU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-LIQU-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-STAT-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-LIQ-COD-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-COD-EJEC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-COD-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-COD-EJEC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-EJEC-OPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EJEC-OPD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EJEC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-COD-OFIC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-OFIC-OPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-OPD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-LIQ-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-COD-OFIC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-COD-GARA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-COD-GARA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-COD-IONP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-COD-IONP-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OPD-FEC-FCMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                OPD-FEC-FCMP-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-FEC-FLRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-FEC-FLRE-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LIQ-FEC-FCTB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LIQ-FEC-FCTB-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-PLRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PLRE-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-CAD-IND-TCAD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAD-IND-TCAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-TCAD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TCAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OPD-FEC-FREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                OPD-FEC-FREA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CAD-CAI-ICAD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAD-CAI-ICAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-CAD-IIC-ICAD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAD-IIC-ICAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-NUM-PVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-NUM-PVEN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-PVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PVEN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-VEN-FEC-FVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                VEN-FEC-FVEN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LIQ-SGV-TLVP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-SGV-TLVP-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TINT-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-SGV-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-SGV-TINT-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-VEN-VAL-FINA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-FINA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-SCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SCAP-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-KNEW.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-KNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-IPAG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-IPAG-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-FNEW.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-FNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-INTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-INTD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-ACED.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ACED-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-DCL-COD-ACED.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCL-COD-ACED-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-PEGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PEGA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-CAPI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CAPI-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-INTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-INTE-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-GLS-SFIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SFIN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-VEN-VAL-SFIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-SFIN-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LIQ-FEC-FCMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LIQ-FEC-FCMP-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LIQ-FEC-FREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LIQ-FEC-FREA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DCL-SGV-RESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCL-SGV-RESC-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-VAL-CAPT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-VAL-CAPT-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-LIQ-SGV-CAPI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-SGV-CAPI-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-SGV-INTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-SGV-INTE-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-OPD-VAL-SCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPD-VAL-SCAP-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-LIQ-SGV-TPAG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-SGV-TPAG-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-LIQ-SGV-PESO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LIQ-SGV-PESO-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-DCL-SGV-KNEW.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCL-SGV-KNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-FRM-SGV-IPAG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-SGV-IPAG-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-DCL-SGV-FNEW.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCL-SGV-FNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-DCL-SGV-INTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCL-SGV-INTD-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
           PERFORM VAL-DCL-SGV-PEGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCL-SGV-PEGA-LEN IN LIQ-FLD
                GO TO FIN-VAL-FLD-LIQ.
       FIN-VAL-FLD-LIQ.
           EXIT.
       
       VAL-OPD-COD-VCAM SECTION.
       INI-VAL-OPD-COD-VCAM.
           IF OPD-COD-VCAM IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO OPD-COD-VCAM IN LIQ-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN LIQ-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              OPD-COD-VCAM IN LIQ-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCAM IN LIQ-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCAM IN LIQ-FLD.
       FIN-VAL-OPD-COD-VCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
           IF FRM-GLS-VCAM IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-VCAM IN LIQ-FLD.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-OPD-COD-TOPD SECTION.
       INI-VAL-OPD-COD-TOPD.
           IF OPD-COD-TOPD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO OPD-COD-TOPD IN LIQ-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-TOPD IN LIQ-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              OPD-COD-TOPD IN LIQ-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOPD IN LIQ-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOPD IN LIQ-FLD.
       FIN-VAL-OPD-COD-TOPD.
           EXIT.
       
       VAL-FRM-GLS-TOPD SECTION.
       INI-VAL-FRM-GLS-TOPD.
           IF FRM-GLS-TOPD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TOPD IN LIQ-FLD.
       FIN-VAL-FRM-GLS-TOPD.
           EXIT.
       
       VAL-OPD-COD-AOPD SECTION.
       INI-VAL-OPD-COD-AOPD.
           IF OPD-COD-AOPD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO OPD-COD-AOPD IN LIQ-FLD.
       FIN-VAL-OPD-COD-AOPD.
           EXIT.
       
       VAL-FRM-GLS-AOPD SECTION.
       INI-VAL-FRM-GLS-AOPD.
           IF FRM-GLS-AOPD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-AOPD IN LIQ-FLD.
       FIN-VAL-FRM-GLS-AOPD.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
           IF DBC-GLS-NOMC IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-NOMC IN LIQ-FLD.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-LIQ-COD-STAT SECTION.
       INI-VAL-LIQ-COD-STAT.
           IF LIQ-COD-STAT IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO LIQ-COD-STAT IN LIQ-FLD.
       FIN-VAL-LIQ-COD-STAT.
           EXIT.
       
       VAL-FRM-GLS-LIQU SECTION.
       INI-VAL-FRM-GLS-LIQU.
           IF FRM-GLS-LIQU IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-LIQU IN LIQ-FLD.
       FIN-VAL-FRM-GLS-LIQU.
           EXIT.
       
       VAL-FRM-GLS-STAT SECTION.
       INI-VAL-FRM-GLS-STAT.
           IF FRM-GLS-STAT IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-STAT IN LIQ-FLD.
       FIN-VAL-FRM-GLS-STAT.
           EXIT.
       
       VAL-LIQ-COD-EJEC SECTION.
       INI-VAL-LIQ-COD-EJEC.
      *<<<< INI_LIQ_COD_EJEC
           IF SCR-CMND = 'CVP' OR 'CRP'
                MOVE SPACES TO LIQ-COD-EJEC IN LIQ-FLD
                GO TO FIN-VAL-LIQ-COD-EJEC.
      *>>>> INI_LIQ_COD_EJEC
           IF LIQ-COD-EJEC IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO LIQ-COD-EJEC IN LIQ-FLD.
      *VAL-USR Valida Usuario
           MOVE LIQ-COD-EJEC IN LIQ-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN LIQ-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJEC IN LIQ-FLD.
       FIN-VAL-LIQ-COD-EJEC.
           EXIT.
       
       VAL-OPD-COD-EJEC SECTION.
       INI-VAL-OPD-COD-EJEC.
           IF OPD-COD-EJEC IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO OPD-COD-EJEC IN LIQ-FLD.
      *VAL-USR Valida Usuario
           MOVE OPD-COD-EJEC IN LIQ-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN LIQ-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJEC IN LIQ-FLD.
       FIN-VAL-OPD-COD-EJEC.
           EXIT.
       
       VAL-FRM-GLS-EJEC-OPD SECTION.
       INI-VAL-FRM-GLS-EJEC-OPD.
           IF FRM-GLS-EJEC-OPD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-EJEC-OPD IN LIQ-FLD.
       FIN-VAL-FRM-GLS-EJEC-OPD.
           EXIT.
       
       VAL-FRM-GLS-EJEC SECTION.
       INI-VAL-FRM-GLS-EJEC.
           IF FRM-GLS-EJEC IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-EJEC IN LIQ-FLD.
       FIN-VAL-FRM-GLS-EJEC.
           EXIT.
       
       VAL-OPD-COD-OFIC SECTION.
       INI-VAL-OPD-COD-OFIC.
           IF OPD-COD-OFIC IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO OPD-COD-OFIC IN LIQ-FLD.
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE OPD-COD-OFIC IN LIQ-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFIC IN LIQ-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN LIQ-FLD.
       FIN-VAL-OPD-COD-OFIC.
           EXIT.
       
       VAL-FRM-GLS-OFIC-OPD SECTION.
       INI-VAL-FRM-GLS-OFIC-OPD.
           IF FRM-GLS-OFIC-OPD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-OFIC-OPD IN LIQ-FLD.
       FIN-VAL-FRM-GLS-OFIC-OPD.
           EXIT.
       
       VAL-LIQ-COD-OFIC SECTION.
       INI-VAL-LIQ-COD-OFIC.
           IF LIQ-COD-OFIC IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO LIQ-COD-OFIC IN LIQ-FLD.
      *<<<< LIQ_COD_OFIC
           IF SCR-CMND = 'CVP' OR 'CRP'
               MOVE SPACES TO LIQ-COD-OFIC IN LIQ-FLD
               GO TO FIN-VAL-LIQ-COD-OFIC.
      *>>>> LIQ_COD_OFIC
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE LIQ-COD-OFIC IN LIQ-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFIC IN LIQ-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN LIQ-FLD.
       FIN-VAL-LIQ-COD-OFIC.
           EXIT.
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
           IF FRM-GLS-OFIC IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-OFIC IN LIQ-FLD.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-OPD-COD-GARA SECTION.
       INI-VAL-OPD-COD-GARA.
           IF OPD-COD-GARA IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO OPD-COD-GARA IN LIQ-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'GAR ' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-GARA IN LIQ-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-OPD-COD-GARA.
           EXIT.
       
       VAL-OPD-COD-IONP SECTION.
       INI-VAL-OPD-COD-IONP.
           IF OPD-COD-IONP IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO OPD-COD-IONP IN LIQ-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-IONP IN LIQ-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-OPD-COD-IONP.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-OPD-FEC-FCMP SECTION.
       INI-VAL-OPD-FEC-FCMP.
           IF OPD-FEC-FCMP IN LIQ-FLD  NOT > ZEROES
              MOVE ZEROES TO OPD-FEC-FCMP IN LIQ-FLD.
      *VAL-FEC Validar Fecha
           MOVE OPD-FEC-FCMP IN LIQ-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO OPD-FEC-FCMP IN LIQ-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-OPD-FEC-FCMP.
       FIN-VAL-OPD-FEC-FCMP.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-FRM-FEC-FLRE SECTION.
       INI-VAL-FRM-FEC-FLRE.
           IF FRM-FEC-FLRE IN LIQ-FLD  NOT > ZEROES
              MOVE ZEROES TO FRM-FEC-FLRE IN LIQ-FLD.
      *VAL-FEC Validar Fecha
           MOVE FRM-FEC-FLRE IN LIQ-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO FRM-FEC-FLRE IN LIQ-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-FRM-FEC-FLRE.
       FIN-VAL-FRM-FEC-FLRE.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LIQ-FEC-FCTB SECTION.
       INI-VAL-LIQ-FEC-FCTB.
           IF LIQ-FEC-FCTB IN LIQ-FLD  NOT > ZEROES
              MOVE ZEROES TO LIQ-FEC-FCTB IN LIQ-FLD.
      *VAL-FEC Validar Fecha
           MOVE LIQ-FEC-FCTB IN LIQ-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_LIQ_FEC_FCTB
      *ISP NO HABILES PARA PRUEBAS
           MOVE FEC-VHBL-N TO FEC-VHBL.
           IF SCR-CMND = 'SLA' OR
              SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
               MOVE FEC-CHOY-GE TO FEC-CHOY.
           PERFORM FLX-FEC.
      *>>>> INI_LIQ_FEC_FCTB
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LIQ-FEC-FCTB IN LIQ-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LIQ-FEC-FCTB.
      *<<<< LIQ_FEC_FCTB
      
      
      *     IF SCR-CMND = 'SLA'
      *          MOVE LIQ-FEC-FCTB IN LIQ-FLD TO FEC-FEC1
      *          MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FEC2
      *          MOVE FEC-FORM-FEC TO FEC-FORM
      *          MOVE FEC-CMP-FEC  TO FEC-CMND
      *          PERFORM PRO-FEC
      *          IF FEC-STAT-GRT
      **            FREA debe ser >= FCTB
      *             MOVE 'DAP' TO MSG-COD-SIST
      *             MOVE 'FCTB>FREA' TO MSG-COD-MENS
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC TO FRM-MENS
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
      *             GO TO FIN-VAL-LIQ-FEC-FREA.
      
           IF ( SCR-CMND = 'SLA' OR
                SCR-CMND = 'LVP' OR
                SCR-CMND = 'CVP' OR
                SCR-CMND = 'LRP' OR
                SCR-CMND = 'CRP' ) AND
              LIQ-FEC-FCTB IN LIQ-FLD NOT = LIQ-FEC-FREA IN LIQ-FLD
      *            FREA debe ser = FCTB
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'FCTB<>FREA' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-LIQ-FEC-FCTB.
      *ADA-INI JSS 02-JUL-2002
      *    IF SCR-CMND = 'LIQ'
           IF SCR-CMND = 'LIQ' OR 'LSI'
      *ADA-FIN JSS 02-JUL-2002
      
               MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FEC1
               MOVE LIQ-FEC-FCTB IN LIQ-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
      *        FREA debe ser < o = FCTB
               IF FEC-STAT-GRT
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'FCTB>FREA' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      
      *     IF SCR-CMND = 'LIQ'
      *          IF LIQ-FEC-FCTB IN LIQ-FLD NOT =
      *             LIQ-FEC-FCMP IN LIQ-FLD
      *               MOVE 'DAP' TO MSG-COD-SIST
      **          FCTB debe ser = a FREA
      *               MOVE 'FCTB<>FCMP' TO MSG-COD-MENS
      *               PERFORM GET-MSG
      *               MOVE MSG-GLS-DESC TO FRM-MENS
      *               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *           ELSE
      
      
      *     IF SCR-CMND = 'SLA'
      *          IF LIQ-FEC-FCTB IN LIQ-FLD NOT =
      *             LIQ-FEC-FREA IN LIQ-FLD
      *               MOVE 'DAP' TO MSG-COD-SIST
      **          FCTB debe ser = a FREA
      *               MOVE 'FCTB<>FCMP' TO MSG-COD-MENS
      *               PERFORM GET-MSG
      *               MOVE MSG-GLS-DESC TO FRM-MENS
      *               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *           ELSE
      *               MOVE LIQ-FEC-FCMP IN LIQ-FLD TO FEC-FEC1
      *               MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FEC2
      *               MOVE FEC-FORM-FEC TO FEC-FORM
      *               MOVE FEC-CMP-FEC  TO FEC-CMND
      *               PERFORM PRO-FEC
      *          FCMP debe ser < o = FREA
      *               IF FEC-STAT-GRT
      *                   MOVE 'DAP' TO MSG-COD-SIST
      *                   MOVE 'FCMP>FCTB' TO MSG-COD-MENS
      *                   PERFORM GET-MSG
      *                   MOVE MSG-GLS-DESC TO FRM-MENS
      *                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>> LIQ_FEC_FCTB
       FIN-VAL-LIQ-FEC-FCTB.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-PLRE SECTION.
       INI-VAL-FRM-GLS-PLRE.
           IF FRM-GLS-PLRE IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-PLRE IN LIQ-FLD.
       FIN-VAL-FRM-GLS-PLRE.
           EXIT.
       
       VAL-CAD-IND-TCAD SECTION.
       INI-VAL-CAD-IND-TCAD.
      *<<<< INI_CAD_IND_TCAD
           IF SCR-CMND = 'CVP' OR 'CRP'
                  MOVE SPACES TO CAD-IND-TCAD IN LIQ-FLD
                  GO TO FIN-VAL-CAD-IND-TCAD.
      *>>>> INI_CAD_IND_TCAD
           IF CAD-IND-TCAD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO CAD-IND-TCAD IN LIQ-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'TCYA' TO MSC-COD-TMSC IN MSC.
           MOVE CAD-IND-TCAD IN LIQ-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CAD-IND-TCAD IN LIQ-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TCAD IN LIQ-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-TCAD IN LIQ-FLD.
       FIN-VAL-CAD-IND-TCAD.
           EXIT.
       
       VAL-FRM-GLS-TCAD SECTION.
       INI-VAL-FRM-GLS-TCAD.
           IF FRM-GLS-TCAD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TCAD IN LIQ-FLD.
       FIN-VAL-FRM-GLS-TCAD.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-OPD-FEC-FREA SECTION.
       INI-VAL-OPD-FEC-FREA.
           IF OPD-FEC-FREA IN LIQ-FLD  NOT > ZEROES
              MOVE ZEROES TO OPD-FEC-FREA IN LIQ-FLD.
      *VAL-FEC Validar Fecha
           MOVE OPD-FEC-FREA IN LIQ-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO OPD-FEC-FREA IN LIQ-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-OPD-FEC-FREA.
       FIN-VAL-OPD-FEC-FREA.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CAD-CAI-ICAD SECTION.
       INI-VAL-CAD-CAI-ICAD.
      *<<<< INI_CAD_CAI_ICAD
           IF SCR-CMND = 'CVP' OR 'CRP'
                  MOVE SPACES TO CAD-CAI-ICAD IN LIQ-FLD
                  GO TO FIN-VAL-CAD-CAI-ICAD.
      
      *>>>> INI_CAD_CAI_ICAD
           IF CAD-CAI-ICAD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO CAD-CAI-ICAD IN LIQ-FLD.
      *<<<< CAD_CAI_ICAD
           IF ( CAD-CAI-ICAD IN LIQ-FLD > SPACES OR
                CAD-IIC-ICAD IN LIQ-FLD > ZEROES ) AND
                SCR-CIC-TVAL = PDB-CIC-MEXT
                  MOVE 'DAP' TO MSG-COD-SIST
                  MOVE 'CADICADAAI' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  MOVE -1 TO CAD-IND-TCAD-LEN IN LIQ-FLD
                  GO TO FIN-VAL-CAD-CAI-ICAD.
      
           MOVE MSC-COD-DAT1(1) TO WSS-IND-CTA.
           MOVE MSC-COD-DAT1(3) TO WSS-IND-MUOC.
      
      * LO SGTE. ESTA REFERIDO AL CAMPO CAD-IND-TCAD Y SE MANEJA AQUI
      * PUES NO ES POSIBLE INSERTAR CODIGO ADIC DESPUES DE LA VALIDACION
           MOVE MSC-COD-DAT2 IN MSC(5) TO WSS-IND-GCAD.
           IF WSS-IND-GCAD NOT > SPACES
      *        tcad no pertenece a dap
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'TCADNODAP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CAD-IND-TCAD-LEN IN LIQ-FLD
               GO TO FIN-VAL-CAD-CAI-ICAD.
      
           IF WSS-IND-MUOC = 'O'
      * ISP: NO ACEPTA ABONO A CTA OTRO CLIENTE
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'CMCERRLIQ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CAD-IND-TCAD-LEN IN LIQ-FLD
               GO TO FIN-VAL-CAD-CAI-ICAD.
      
           IF  WSS-IND-GCAD = 'A' AND
                 ( SCR-CMND = 'MOD' AND
                     LIQ-FEC-FREA IN LIQ-FLD NOT =
                     LIQ-FEC-FCMP IN LIQ-FLD )
      
      *        tcad no pertenece a dap
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'TCADAUTO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CAD-IND-TCAD-LEN IN LIQ-FLD
               GO TO FIN-VAL-CAD-CAI-ICAD.
      *>>>> CAD_CAI_ICAD
       FIN-VAL-CAD-CAI-ICAD.
           EXIT.
       
       VAL-CAD-IIC-ICAD SECTION.
       INI-VAL-CAD-IIC-ICAD.
      *<<<< INI_CAD_IIC_ICAD
           IF SCR-CMND = 'CVP' OR 'CRP'
                  MOVE ZEROES TO CAD-IIC-ICAD IN LIQ-FLD
                  GO TO FIN-VAL-CAD-IIC-ICAD.
      *>>>> INI_CAD_IIC_ICAD
       FIN-VAL-CAD-IIC-ICAD.
           EXIT.
       
       VAL-OPD-NUM-PVEN SECTION.
       INI-VAL-OPD-NUM-PVEN.
       FIN-VAL-OPD-NUM-PVEN.
           EXIT.
       
       VAL-FRM-GLS-PVEN SECTION.
       INI-VAL-FRM-GLS-PVEN.
           IF FRM-GLS-PVEN IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-PVEN IN LIQ-FLD.
       FIN-VAL-FRM-GLS-PVEN.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-VEN-FEC-FVEN SECTION.
       INI-VAL-VEN-FEC-FVEN.
           IF VEN-FEC-FVEN IN LIQ-FLD  NOT > ZEROES
              MOVE ZEROES TO VEN-FEC-FVEN IN LIQ-FLD.
      *VAL-FEC Validar Fecha
           MOVE VEN-FEC-FVEN IN LIQ-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO VEN-FEC-FVEN IN LIQ-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-VEN-FEC-FVEN.
       FIN-VAL-VEN-FEC-FVEN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-LIQ-SGV-TLVP SECTION.
       INI-VAL-LIQ-SGV-TLVP.
      *<<<< LIQ_SGV_TLVP
           IF SCR-CMND = 'CRP' OR 'LRP'
               IF LIQ-SGV-TLVP IN LIQ-FLD NOT > ZEROES
                    PERFORM ERR-GLS.
      *>>>> LIQ_SGV_TLVP
       FIN-VAL-LIQ-SGV-TLVP.
           EXIT.
       
       VAL-FRM-GLS-TINT SECTION.
       INI-VAL-FRM-GLS-TINT.
           IF FRM-GLS-TINT IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TINT IN LIQ-FLD.
       FIN-VAL-FRM-GLS-TINT.
           EXIT.
       
       VAL-OPD-SGV-TINT SECTION.
       INI-VAL-OPD-SGV-TINT.
       FIN-VAL-OPD-SGV-TINT.
           EXIT.
       
       VAL-VEN-VAL-FINA SECTION.
       INI-VAL-VEN-VAL-FINA.
       FIN-VAL-VEN-VAL-FINA.
           EXIT.
       
       VAL-FRM-GLS-SCAP SECTION.
       INI-VAL-FRM-GLS-SCAP.
           IF FRM-GLS-SCAP IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-SCAP IN LIQ-FLD.
       FIN-VAL-FRM-GLS-SCAP.
           EXIT.
       
       VAL-FRM-GLS-KNEW SECTION.
       INI-VAL-FRM-GLS-KNEW.
           IF FRM-GLS-KNEW IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-KNEW IN LIQ-FLD.
       FIN-VAL-FRM-GLS-KNEW.
           EXIT.
       
       VAL-FRM-GLS-IPAG SECTION.
       INI-VAL-FRM-GLS-IPAG.
           IF FRM-GLS-IPAG IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-IPAG IN LIQ-FLD.
       FIN-VAL-FRM-GLS-IPAG.
           EXIT.
       
       VAL-FRM-GLS-FNEW SECTION.
       INI-VAL-FRM-GLS-FNEW.
           IF FRM-GLS-FNEW IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-FNEW IN LIQ-FLD.
       FIN-VAL-FRM-GLS-FNEW.
           EXIT.
       
       VAL-FRM-GLS-INTD SECTION.
       INI-VAL-FRM-GLS-INTD.
           IF FRM-GLS-INTD IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-INTD IN LIQ-FLD.
       FIN-VAL-FRM-GLS-INTD.
           EXIT.
       
       VAL-FRM-GLS-ACED SECTION.
       INI-VAL-FRM-GLS-ACED.
           IF FRM-GLS-ACED IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-ACED IN LIQ-FLD.
       FIN-VAL-FRM-GLS-ACED.
           EXIT.
       
       VAL-DCL-COD-ACED SECTION.
       INI-VAL-DCL-COD-ACED.
           IF DCL-COD-ACED IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO DCL-COD-ACED IN LIQ-FLD.
      *<<<< DCL_COD_ACED
      *>>>> DCL_COD_ACED
       FIN-VAL-DCL-COD-ACED.
           EXIT.
       
       VAL-FRM-GLS-PEGA SECTION.
       INI-VAL-FRM-GLS-PEGA.
           IF FRM-GLS-PEGA IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-PEGA IN LIQ-FLD.
       FIN-VAL-FRM-GLS-PEGA.
           EXIT.
       
       VAL-FRM-GLS-CAPI SECTION.
       INI-VAL-FRM-GLS-CAPI.
           IF FRM-GLS-CAPI IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-CAPI IN LIQ-FLD.
       FIN-VAL-FRM-GLS-CAPI.
           EXIT.
       
       VAL-FRM-GLS-INTE SECTION.
       INI-VAL-FRM-GLS-INTE.
           IF FRM-GLS-INTE IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-INTE IN LIQ-FLD.
       FIN-VAL-FRM-GLS-INTE.
           EXIT.
       
       VAL-FRM-GLS-SFIN SECTION.
       INI-VAL-FRM-GLS-SFIN.
           IF FRM-GLS-SFIN IN LIQ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-SFIN IN LIQ-FLD.
       FIN-VAL-FRM-GLS-SFIN.
           EXIT.
       
       VAL-VEN-VAL-SFIN SECTION.
       INI-VAL-VEN-VAL-SFIN.
       FIN-VAL-VEN-VAL-SFIN.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LIQ-FEC-FCMP SECTION.
       INI-VAL-LIQ-FEC-FCMP.
           IF LIQ-FEC-FCMP IN LIQ-FLD  NOT > ZEROES
              MOVE ZEROES TO LIQ-FEC-FCMP IN LIQ-FLD.
      *VAL-FEC Validar Fecha
           MOVE LIQ-FEC-FCMP IN LIQ-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_LIQ_FEC_FCMP
      *ISP NO HABILES PARA PRUEBAS
           MOVE FEC-VHBL-N TO FEC-VHBL.
           PERFORM FLX-FEC.
      *>>>> INI_LIQ_FEC_FCMP
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LIQ-FEC-FCMP IN LIQ-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LIQ-FEC-FCMP.
      *<<<< LIQ_FEC_FCMP
           MOVE HOY-DHOY TO LIQ-NUM-DCMP IN LIQ-FLD.
           MOVE HOY-MHOY TO LIQ-NUM-MCMP IN LIQ-FLD.
           MOVE HOY-SHOY TO LIQ-NUM-SCMP IN LIQ-FLD.
           MOVE HOY-AHOY TO LIQ-NUM-ACMP IN LIQ-FLD.
           PERFORM FLX-FEC.
      
           IF LIQ-FEC-FREA IN LIQ-FLD NOT > ZEROES
             MOVE LIQ-FEC-FCMP IN LIQ-FLD TO
                  LIQ-FEC-FREA IN LIQ-FLD.
      
           IF LIQ-FEC-FCTB IN LIQ-FLD NOT > ZEROES
             MOVE LIQ-FEC-FREA IN LIQ-FLD TO
                  LIQ-FEC-FCTB IN LIQ-FLD.
      *>>>> LIQ_FEC_FCMP
       FIN-VAL-LIQ-FEC-FCMP.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LIQ-FEC-FREA SECTION.
       INI-VAL-LIQ-FEC-FREA.
           IF LIQ-FEC-FREA IN LIQ-FLD  NOT > ZEROES
              MOVE ZEROES TO LIQ-FEC-FREA IN LIQ-FLD.
      *VAL-FEC Validar Fecha
           MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_LIQ_FEC_FREA
      *VAL-FEC Validar Fecha
      *     IF SCR-CMND = 'SLA'
      *        MOVE 'DAP'   TO TAB-COD-SIST
      *        MOVE 'SLA'   TO TAB-COD-TTAB IN TAB
      *        MOVE 'NDSLA' TO TAB-COD-CTAB IN TAB
      *        PERFORM VAL-COD
      *        IF MSG-COD-MENS > SPACES
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR
      *            MOVE 'DAP' TO MSG-COD-SIST
      *            MOVE 'NDSLANEX' TO MSG-COD-MENS
      *            PERFORM GET-MSG
      *            MOVE MSG-GLS-DESC TO FRM-MENS
      *            GO TO FIN-VAL-LIQ-FEC-FREA
      *        ELSE
      *            MOVE TAB-GLS-ABRV IN TAB TO NUM-NUME
      *            MOVE NUM-ZERO-N TO NUM-ZERO
      *            MOVE NUM-SGNO-N TO NUM-SGNO
      *            MOVE 5 TO NUM-NENT
      *            MOVE 0 TO NUM-NDCM
      *               CALL 'GNSPVNUM' USING NUM-VARI
      *            IF NUM-STAT-OKS
      *                MOVE NUM-NN9N TO WSS-NUM-NDSLA
      *            ELSE
      *                MOVE FRM-SUAR-MAL TO FRM-SUAR
      *                MOVE 'DAP' TO MSG-COD-SIST
      *                MOVE 'NDSLANONUM' TO MSG-COD-MENS
      *                PERFORM GET-MSG
      *                MOVE MSG-GLS-DESC TO FRM-MENS
      *                GO TO FIN-VAL-LIQ-FEC-FREA.
      
           MOVE FEC-VHBL-N TO FEC-VHBL.
           IF SCR-CMND = 'SLA' OR
              SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
               MOVE FEC-VHBL-S TO FEC-VHBL
               MOVE FEC-CHOY-GE TO FEC-CHOY.
      
      *ISP NO HABILES PARA PRUEBAS
           PERFORM FLX-FEC.
      *>>>> INI_LIQ_FEC_FREA
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LIQ-FEC-FREA IN LIQ-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LIQ-FEC-FREA.
      *<<<< LIQ_FEC_FREA
      *RST-FEC
      
      * ISP: FLIQ < FTER PARA SLA CODIGO RECATE RC
           IF SCR-CMND = 'SLA' OR
              SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
               MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FEC1
      *         MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2
      *         MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2
      *         MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2
      *         MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2
               PERFORM SET-FTER
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF NOT FEC-STAT-LES
      *        FLIQ debe ser <= FTER
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'FLIQNOT<FTER' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-LIQ-FEC-FREA.
      
      *     IF SCR-CMND = 'SLA'
      *         MOVE LIQ-FEC-FCMP IN LIQ-FLD TO FEC-FEC1
      *         MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FEC2
      *         MOVE FEC-FORM-FEC TO FEC-FORM
      *         MOVE FEC-DIF-DIA  TO FEC-CMND
      *         PERFORM CAL-FEC
      *         IF WSS-NUM-NDSLA < FEC-NDIA
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
      *             MOVE 'DAP' TO MSG-COD-SIST
      *             MOVE 'NDSLAEXC' TO MSG-COD-MENS
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC TO FRM-MENS
      *             GO TO FIN-VAL-LIQ-FEC-FREA.
      
      
      *     IF SCR-CMND = 'SLA'
      *          MOVE LIQ-FEC-FCTB IN LIQ-FLD TO FEC-FEC1
      *          MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FEC2
      *          MOVE FEC-FORM-FEC TO FEC-FORM
      *          MOVE FEC-CMP-FEC  TO FEC-CMND
      *          PERFORM PRO-FEC
      *          IF FEC-STAT-GRT
      **            FREA debe ser >= FCTB
      *             MOVE 'DAP' TO MSG-COD-SIST
      *             MOVE 'FCTB>FREA' TO MSG-COD-MENS
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC TO FRM-MENS
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
      *             GO TO FIN-VAL-LIQ-FEC-FREA.
      *
      *         ELSE
      *             NEXT SENTENCE
      *     ELSE
      *             MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FEC1
      *             MOVE LIQ-FEC-FCTB IN LIQ-FLD TO FEC-FEC2
      *             MOVE FEC-FORM-FEC TO FEC-FORM
      *             MOVE FEC-CMP-FEC  TO FEC-CMND
      *             PERFORM PRO-FEC
      *             IF FEC-STAT-GRT
      **                FREA debe ser < o = FCTB
      *                 MOVE 'DAP' TO MSG-COD-SIST
      *                 MOVE 'FREA>FCTB' TO MSG-COD-MENS
      *                 PERFORM GET-MSG
      *                 MOVE MSG-GLS-DESC TO FRM-MENS
      *                 MOVE FRM-SUAR-MAL TO FRM-SUAR
      *                 GO TO FIN-VAL-LIQ-FEC-FREA.
      
      *           IF SCR-CMND = 'LIQ' AND
      *        LIQ-FEC-FREA IN LIQ-FLD NOT = LIQ-FEC-FCMP IN LIQ-FLD
      *          MOVE 'FREA<>FCMPLQ' TO MSG-COD-MENS
      *          MOVE 'DAP' TO MSG-COD-SIST
      *          PERFORM GET-MSG
      *          MOVE MSG-GLS-DESC TO FRM-MENS
      *          MOVE FRM-SUAR-MAL TO FRM-SUAR
      *          GO TO FIN-VAL-LIQ-FEC-FREA.
      
      *>>>> LIQ_FEC_FREA
       FIN-VAL-LIQ-FEC-FREA.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-DCL-SGV-RESC SECTION.
       INI-VAL-DCL-SGV-RESC.
      *<<<< DCL_SGV_RESC
           IF SCR-CMND = 'CRP' OR 'LRP'
               IF DCL-SGV-RESC IN LIQ-FLD NOT > ZEROES
                    PERFORM ERR-GLS.
           IF SCR-CMND = 'CRP' OR 'LRP' OR 'CVP' OR 'LVP'
               IF DCL-SGV-RESC IN LIQ-FLD >
                  VEN-VAL-SFIN IN VEN
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'LRPERRSLD-0' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DCL-SGV-RESC.
      
      *>>>> DCL_SGV_RESC
       FIN-VAL-DCL-SGV-RESC.
           EXIT.
       
       VAL-OPD-VAL-CAPT SECTION.
       INI-VAL-OPD-VAL-CAPT.
       FIN-VAL-OPD-VAL-CAPT.
           EXIT.
       
       VAL-LIQ-SGV-CAPI SECTION.
       INI-VAL-LIQ-SGV-CAPI.
       FIN-VAL-LIQ-SGV-CAPI.
           EXIT.
       
       VAL-FRM-SGV-INTE SECTION.
       INI-VAL-FRM-SGV-INTE.
       FIN-VAL-FRM-SGV-INTE.
           EXIT.
       
       VAL-OPD-VAL-SCAP SECTION.
       INI-VAL-OPD-VAL-SCAP.
       FIN-VAL-OPD-VAL-SCAP.
           EXIT.
       
       VAL-LIQ-SGV-TPAG SECTION.
       INI-VAL-LIQ-SGV-TPAG.
      *<<<< LIQ_SGV_TPAG
           IF SCR-CMND = 'CRP' OR 'LRP' OR 'CVP' OR 'LVP'
               IF LIQ-SGV-TPAG IN LIQ-FLD >
                  VEN-VAL-SFIN IN VEN
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'PAGERRSLD-0' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-LIQ-SGV-TPAG.
      *    si comandos de rescate
           IF SCR-CMND = 'CRP' OR 'LRP'
      *        si moneda no reajustable ( pesos o extranjera )
              IF ( SCR-CIC-VCAM = PDB-CIC-0999 OR
                   SCR-CIC-TVAL = PDB-CIC-MEXT )
      *                 si total pagado en cero, exige obligatoriedad
                        IF LIQ-SGV-TPAG IN LIQ-FLD NOT > ZEROES
                            MOVE 'DAP' TO MSG-COD-SIST
                            MOVE 'LRPTPAGOBL' TO MSG-COD-MENS
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            MOVE FRM-SUAR-MAL TO FRM-SUAR
                            GO TO FIN-VAL-LIQ-SGV-TPAG
                        ELSE
                            NEXT SENTENCE
              ELSE
      *          moneda reajustable
      *       si monto en pesos vacio
              IF LIQ-SGV-PESO IN LIQ-FLD NOT > ZEROES
      *               si total pagado en cero, exige obligatoriedad
                      IF LIQ-SGV-TPAG IN LIQ-FLD NOT > ZEROES
                            MOVE 'DAP' TO MSG-COD-SIST
                            MOVE 'LRPREAJOBLS' TO MSG-COD-MENS
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            MOVE FRM-SUAR-MAL TO FRM-SUAR
                            GO TO FIN-VAL-LIQ-SGV-TPAG.
                            
      *    si comandos de rescate
           IF SCR-CMND = 'CRP' OR 'LRP'
      *         si moneda extranjera
                IF SCR-CIC-TVAL NOT = PDB-CIC-MNAC
                      MOVE ZEROES TO LIQ-SGV-PESO IN LIQ-FLD
      *         si moneda pesos
                ELSE
                IF SCR-CIC-VCAM  = PDB-CIC-0999
                      MOVE LIQ-SGV-TPAG IN LIQ-FLD TO
                           LIQ-SGV-PESO IN LIQ-FLD
                ELSE
      *         moneda reajustable
                    PERFORM VCAM-FSLA
      *             si valor de cambio OK
                    IF FRM-SUAR NOT = FRM-SUAR-MAL
      *                 si peso > cero ==>> calcula TPAG
                        IF LIQ-SGV-PESO IN LIQ-FLD > ZEROES
      *                      calcula monto en moneda
                             DIVIDE  LIQ-SGV-PESO IN LIQ-FLD BY
                                     WSS-SGV-VCAM-FSLA GIVING
                                     LIQ-SGV-TPAG IN LIQ-FLD
                                     ROUNDED
                        ELSE
      *                      calcula monto en pesos
                             MULTIPLY LIQ-SGV-TPAG IN LIQ-FLD BY
                                      WSS-SGV-VCAM-FSLA GIVING
                                      LIQ-SGV-PESO IN LIQ-FLD
                                      ROUNDED

                             MOVE PDB-CIC-0999 TO PES-CIC-VCAM
                             MOVE LIQ-SGV-PESO IN LIQ-FLD TO
                                  PES-SGV-DECI
                             PERFORM PES-SCTV
                             MOVE PES-SGV-ENTE TO
                                  LIQ-SGV-PESO IN LIQ-FLD.
      *>>>> LIQ_SGV_TPAG
       FIN-VAL-LIQ-SGV-TPAG.
           EXIT.
       
       VAL-LIQ-SGV-PESO SECTION.
       INI-VAL-LIQ-SGV-PESO.
       FIN-VAL-LIQ-SGV-PESO.
           EXIT.
       
       VAL-DCL-SGV-KNEW SECTION.
       INI-VAL-DCL-SGV-KNEW.
       FIN-VAL-DCL-SGV-KNEW.
           EXIT.
       
       VAL-FRM-SGV-IPAG SECTION.
       INI-VAL-FRM-SGV-IPAG.
       FIN-VAL-FRM-SGV-IPAG.
           EXIT.
       
       VAL-DCL-SGV-FNEW SECTION.
       INI-VAL-DCL-SGV-FNEW.
       FIN-VAL-DCL-SGV-FNEW.
           EXIT.
       
       VAL-DCL-SGV-INTD SECTION.
       INI-VAL-DCL-SGV-INTD.
       FIN-VAL-DCL-SGV-INTD.
           EXIT.
       
       VAL-DCL-SGV-PEGA SECTION.
       INI-VAL-DCL-SGV-PEGA.
       FIN-VAL-DCL-SGV-PEGA.
           EXIT.
       
       VAL-CON-FLD-LIQ SECTION.
       INI-VAL-CON-FLD-LIQ.
      *<<<< VAL_CON_FLD_LIQ
           IF ( SCR-CMND = 'LVP' OR
                SCR-CMND = 'CVP' OR
                SCR-CMND = 'LRP' OR
                SCR-CMND = 'CRP' )
                  IF LIQ-SGV-TLVP IN LIQ-FLD NOT > ZEROES AND
                     LIQ-SGV-TPAG IN LIQ-FLD NOT > ZEROES
                       IF WSS-TASA-CERO = 'N'                                   
                           MOVE 'DAP' TO MSG-COD-SIST                           
                           MOVE 'SGVTLVPCERO' TO MSG-COD-MENS                   
                           PERFORM GET-MSG                                      
                           MOVE MSG-GLS-DESC TO WSS-MSG-DESC                    
                           MOVE MSG-GLS-DATA TO WSS-MSG-DATA                    
                           MOVE WSS-MSG      TO FRM-MENS                        
                           MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                           MOVE -1 TO LIQ-SGV-TLVP-LEN IN LIQ-FLD               
                           MOVE 'S' TO FRM-UCUR                                 
                           GO TO FIN-VAL-CON-FLD-LIQ.                           
      *ADA-INI 04-JUL-2002
           IF SCR-CMND = 'MCA'
      *ADA-INI 04-MAY-2004
               PERFORM VAL-CTA
      *ADA-FIN 04-MAY-2004
               GO TO FIN-VAL-CON-FLD-LIQ.
      *ADA-FIN 04-JUL-2002
      *VAL-USR Valida Usuario
           IF SCR-CMND = 'CVP' OR
              SCR-CMND = 'CRP'
                GO TO EXT-VAL-USR.
           MOVE LIQ-COD-EJEC IN LIQ-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO LIQ-COD-EJEC-LEN IN LIQ-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CON-FLD-LIQ
           ELSE
               MOVE USR-COD-OFUS IN USR TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               IF MSG-COD-MENS > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'OFIEJCERR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE -1 TO LIQ-COD-EJEC-LEN IN LIQ-FLD
                   MOVE 'S' TO FRM-UCUR
                   GO TO FIN-VAL-CON-FLD-LIQ
               ELSE
      *ADA-INI JSS 03-JUL-2002
      *Esta validacion que verifica que el Usuario conectado sea de
      *la misma Oficina que el Ejecutivo ingresado en el campo
      *'Liquidado por' no debe ser considerada para el comando
      *'LSI' dado que este comando es para usarios centralizados
                   IF SCR-CMND = 'LSI'
                       NEXT SENTENCE
                   ELSE
      *ADA-FIN JSS 03-JUL-2002
                   IF NOT SCR-OFRM-SRV
                   IF USR-COD-OFUS IN USR NOT = SCR-COD-OFIC
                       MOVE 'DAP' TO MSG-COD-SIST
                       MOVE 'OFIEJCCSSN<>' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE -1 TO LIQ-COD-EJEC-LEN IN LIQ-FLD
                       MOVE 'S' TO FRM-UCUR
                       GO TO FIN-VAL-CON-FLD-LIQ.
      
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN LIQ-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJEC IN LIQ-FLD.
       EXT-VAL-USR.
      
           IF ( SCR-CMND = 'SLA' OR
                SCR-CMND = 'LVP' OR
                SCR-CMND = 'CVP' OR
                SCR-CMND = 'LRP' OR
                SCR-CMND = 'CRP' ) AND
              LIQ-FEC-FREA IN LIQ-FLD NOT = LIQ-FEC-FCMP IN LIQ-FLD AND
              CAD-IND-TCAD IN LIQ-FLD NOT = 'CAJA' AND
              CAD-IND-TCAD IN LIQ-FLD NOT = 'CMCA' AND
              CAD-IND-TCAD IN LIQ-FLD NOT = 'CCMA'
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'ICADERRLIQ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-LIQ.
      
           MOVE ZEROES TO SCR-SGV-REAJ
                          SCR-SGV-CAPI.
           PERFORM VAL-CTA.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-CON-FLD-LIQ.
      
           MOVE ZEROES TO FRM-SGV-INTE IN LIQ-FLD.
           IF NOT ( SCR-CMND = 'CRP' OR
                    SCR-CMND = 'LRP' )
               MOVE ZEROES TO LIQ-SGV-PESO IN LIQ-FLD.
           IF NOT ( SCR-CMND = 'CVP' OR 'LVP' OR 'CRP' OR 'LRP' )
               MOVE ZEROES TO LIQ-SGV-TPAG IN LIQ-FLD.
      
           MOVE SPACES TO FRM-GLS-PLRE IN LIQ-FLD.
           IF SCR-CMND = 'SLA' OR
              SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
               PERFORM BUS-PRM-SLA
               IF MSG-COD-MENS > SPACES
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'DAP' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-LIQ
               ELSE
                  PERFORM CAL-SLA
                  IF FRM-SUAR = FRM-SUAR-MAL
                      IF WSS-CAL-SLA-GMSG = 'S'
                          MOVE 'DAP' TO MSG-COD-SIST
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                      END-IF
                      GO TO FIN-VAL-CON-FLD-LIQ.
      
      *ADA-INI JSS 02-JUL-2002
      *    IF SCR-CMND = 'LIQ'
           IF SCR-CMND = 'LIQ' OR 'LSI'
      *ADA-FIN JSS 02-JUL-2002
      *       MOVE 'A' TO WSS-OPD-CIC-RESC
      *       PERFORM CAL-LIQ.
              PERFORM OBT-LIQ.
      
           IF SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
                PERFORM PRO-LRP-TPAG
                COMPUTE WSS-SGV-DIFE = LRP-SGV-TPAG -
                                       LIQ-SGV-TPAG IN LIQ-FLD
                IF WSS-SGV-DIFE NOT = ZEROES
                     MOVE 'DAP' TO MSG-COD-SIST
                     MOVE 'LRPDIFE<>0' TO MSG-COD-MENS
                     PERFORM GET-MSG
      
                     MOVE LRP-SGV-TPAG            TO WSS-LRP-MSG-M01
                     MOVE MSG-GLS-DESC            TO WSS-LRP-MSG-M02
      
                     MOVE LIQ-SGV-TPAG IN LIQ-FLD TO WSS-LRP-MSG-M03
                     MOVE MSG-GLS-DATA            TO WSS-LRP-MSG-M04
      
                     MOVE WSS-SGV-DIFE            TO WSS-LRP-MSG-M05
                     MOVE MSG-GLS-DCOR            TO WSS-LRP-MSG-M06
      
                     MOVE WSS-LRP-MSG TO FRM-MENS
                                         LIQ-GLS-MENS IN LIQ-FLD
                     PERFORM PRO-ACED
                     IF DCL-COD-ACED IN LIQ-FLD NOT = 'S'
                         MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>> VAL_CON_FLD_LIQ
       FIN-VAL-CON-FLD-LIQ.
           EXIT.
       
       VAL-CON-LIQ SECTION.
       INI-VAL-CON-LIQ.
       FIN-VAL-CON-LIQ.
           EXIT.
       
       VAL-NUM-KEY-LIQ SECTION.
       INI-VAL-NUM-KEY-LIQ.
           PERFORM VAL-NUM-IKY-LIQ.
           PERFORM VAL-NUM-MKY-LIQ.
           PERFORM VAL-NUM-AKY-LIQ.
       FIN-VAL-NUM-KEY-LIQ.
           EXIT.
       
       VAL-NUM-IKY-LIQ SECTION.
       INI-VAL-NUM-IKY-LIQ.
        VAL-NUM-LIQ-IIC-IOPD 
           MOVE LIQ-IIC-IOPD-ALF IN LIQ-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO LIQ-IIC-IOPD IN LIQ-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO LIQ-IIC-IOPD-LEN IN LIQ-FLD                   
                GO TO FIN-VAL-NUM-IKY-LIQ.                              
       VAL-NUM-OPD-IIC-ISER.                                            
           MOVE OPD-IIC-ISER-ALF IN LIQ-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO OPD-IIC-ISER IN LIQ-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO OPD-IIC-ISER-LEN IN LIQ-FLD                   
                GO TO FIN-VAL-NUM-IKY-LIQ.                              
       VAL-NUM-LIQ-NUM-ILIQ.                                            
           MOVE LIQ-NUM-ILIQ-ALF IN LIQ-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 3 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO LIQ-NUM-ILIQ IN LIQ-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO LIQ-NUM-ILIQ-LEN IN LIQ-FLD                   
                GO TO FIN-VAL-NUM-IKY-LIQ.                              
           GO TO FIN-VAL-NUM-IKY-LIQ.
       VAL-NUM-LIQ-IIC-IOPD.
           MOVE LIQ-IIC-IOPD-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO LIQ-IIC-IOPD IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LIQ-IIC-IOPD-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-IKY-LIQ.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-IKY-LIQ.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-OPD-IIC-ISER.
           MOVE OPD-IIC-ISER-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO OPD-IIC-ISER IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPD-IIC-ISER-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-IKY-LIQ.
       VAL-NUM-LIQ-NUM-ILIQ.
           MOVE LIQ-NUM-ILIQ-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO LIQ-NUM-ILIQ IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LIQ-NUM-ILIQ-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-IKY-LIQ.
       FIN-VAL-NUM-IKY-LIQ.
           EXIT.
       
       VAL-NUM-MKY-LIQ SECTION.
       INI-VAL-NUM-MKY-LIQ.
       FIN-VAL-NUM-MKY-LIQ.
           EXIT.
       
       VAL-NUM-AKY-LIQ SECTION.
       INI-VAL-NUM-AKY-LIQ.
       FIN-VAL-NUM-AKY-LIQ.
           EXIT.
       
       VAL-NUM-FLD-LIQ SECTION.
       INI-VAL-NUM-FLD-LIQ.
      *<<<< INI_VAL_NUM_FLD_LIQ
           MOVE 'N' TO WSS-TASA-CERO.
           IF LIQ-SGV-TLVP-ALF IN LIQ-FLD = 'CERO'
               MOVE 'S' TO WSS-TASA-CERO
               MOVE SPACES TO LIQ-SGV-TLVP-ALF IN LIQ-FLD.
       VAL-NUM-DBC-NUM-ICLI.                                            
           MOVE DBC-NUM-ICLI-ALF IN LIQ-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN LIQ-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO DBC-NUM-ICLI-LEN IN LIQ-FLD                   
                GO TO FIN-VAL-NUM-FLD-LIQ.                              
       VAL-NUM-CAD-IIC-ICAD.
           MOVE CAD-IIC-ICAD-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO CAD-IIC-ICAD IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CAD-IIC-ICAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-OPD-NUM-PVEN.
           MOVE OPD-NUM-PVEN-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO OPD-NUM-PVEN IN LIQ-FLD
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO OPD-NUM-PVEN-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.                              
       VAL-NUM-LIQ-SGV-TLVP.
           MOVE LIQ-SGV-TLVP-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO LIQ-SGV-TLVP IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LIQ-SGV-TLVP-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-OPD-SGV-TINT.
           MOVE OPD-SGV-TINT-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO OPD-SGV-TINT IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPD-SGV-TINT-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-DCL-SGV-RESC.
           MOVE DCL-SGV-RESC-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO DCL-SGV-RESC IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DCL-SGV-RESC-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-OPD-VAL-CAPT.
           MOVE OPD-VAL-CAPT-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO OPD-VAL-CAPT IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPD-VAL-CAPT-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-LIQ-SGV-CAPI.
           MOVE LIQ-SGV-CAPI-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-S TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.                                         
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NS9V TO LIQ-SGV-CAPI IN LIQ-FLD
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO LIQ-SGV-CAPI-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.                              
       VAL-NUM-VEN-VAL-FINA.
           MOVE VEN-VAL-FINA-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-S TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NS9V TO VEN-VAL-FINA IN LIQ-FLD
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO VEN-VAL-FINA-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.                              
       VAL-NUM-FRM-SGV-INTE.                                            
           MOVE FRM-SGV-INTE-ALF IN LIQ-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-S TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.                                         
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NS9V TO FRM-SGV-INTE IN LIQ-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO FRM-SGV-INTE-LEN IN LIQ-FLD                   
                GO TO FIN-VAL-NUM-FLD-LIQ.                              
       VAL-NUM-OPD-VAL-SCAP.                                            
           MOVE OPD-VAL-SCAP-ALF IN LIQ-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.                                         
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9V TO OPD-VAL-SCAP IN LIQ-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO OPD-VAL-SCAP-LEN IN LIQ-FLD                   
                GO TO FIN-VAL-NUM-FLD-LIQ.                              
       VAL-NUM-LIQ-SGV-TPAG.                                            
           MOVE LIQ-SGV-TPAG-ALF IN LIQ-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-S TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.                                         
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NS9V TO LIQ-SGV-TPAG IN LIQ-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO LIQ-SGV-TPAG-LEN IN LIQ-FLD                   
                GO TO FIN-VAL-NUM-FLD-LIQ.                              
       VAL-NUM-VEN-VAL-SFIN.
           MOVE VEN-VAL-SFIN-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO VEN-VAL-SFIN IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO VEN-VAL-SFIN-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-LIQ-SGV-PESO.                                            
           MOVE LIQ-SGV-PESO-ALF IN LIQ-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-S TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.                                         
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NS9N TO LIQ-SGV-PESO IN LIQ-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO LIQ-SGV-PESO-LEN IN LIQ-FLD                   
                GO TO FIN-VAL-NUM-FLD-LIQ.                              
       VAL-NUM-DCL-SGV-KNEW.
           MOVE DCL-SGV-KNEW-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-S TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.                                         
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NS9V TO DCL-SGV-KNEW IN LIQ-FLD
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO DCL-SGV-KNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-FRM-SGV-IPAG.
           MOVE FRM-SGV-IPAG-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO FRM-SGV-IPAG IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-IPAG-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-DCL-SGV-FNEW.
           MOVE DCL-SGV-FNEW-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO DCL-SGV-FNEW IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DCL-SGV-FNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-DCL-SGV-INTD.
           MOVE DCL-SGV-INTD-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO DCL-SGV-INTD IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DCL-SGV-INTD-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-DCL-SGV-PEGA.
           MOVE DCL-SGV-PEGA-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO DCL-SGV-PEGA IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DCL-SGV-PEGA-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.                              
           GO TO FIN-VAL-FLD-LIQ. 
      *>>>> INI_VAL_NUM_FLD_LIQ
       VAL-NUM-CAD-IIC-ICAD.
           MOVE CAD-IIC-ICAD-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO CAD-IIC-ICAD IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CAD-IIC-ICAD-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-OPD-NUM-PVEN.
           MOVE OPD-NUM-PVEN-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO OPD-NUM-PVEN IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPD-NUM-PVEN-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-LIQ-SGV-TLVP.
           MOVE LIQ-SGV-TLVP-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO LIQ-SGV-TLVP IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LIQ-SGV-TLVP-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-OPD-SGV-TINT.
           MOVE OPD-SGV-TINT-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO OPD-SGV-TINT IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPD-SGV-TINT-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-VEN-VAL-FINA.
           MOVE VEN-VAL-FINA-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO VEN-VAL-FINA IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO VEN-VAL-FINA-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-VEN-VAL-SFIN.
           MOVE VEN-VAL-SFIN-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO VEN-VAL-SFIN IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO VEN-VAL-SFIN-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-DCL-SGV-RESC.
           MOVE DCL-SGV-RESC-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO DCL-SGV-RESC IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DCL-SGV-RESC-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-OPD-VAL-CAPT.
           MOVE OPD-VAL-CAPT-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO OPD-VAL-CAPT IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPD-VAL-CAPT-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-LIQ-SGV-CAPI.
           MOVE LIQ-SGV-CAPI-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO LIQ-SGV-CAPI IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LIQ-SGV-CAPI-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-FRM-SGV-INTE.
           MOVE FRM-SGV-INTE-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO FRM-SGV-INTE IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INTE-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-OPD-VAL-SCAP.
           MOVE OPD-VAL-SCAP-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO OPD-VAL-SCAP IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPD-VAL-SCAP-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-LIQ-SGV-TPAG.
           MOVE LIQ-SGV-TPAG-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO LIQ-SGV-TPAG IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LIQ-SGV-TPAG-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-LIQ-SGV-PESO.
           MOVE LIQ-SGV-PESO-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9N TO LIQ-SGV-PESO IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LIQ-SGV-PESO-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-DCL-SGV-KNEW.
           MOVE DCL-SGV-KNEW-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO DCL-SGV-KNEW IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DCL-SGV-KNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-FRM-SGV-IPAG.
           MOVE FRM-SGV-IPAG-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO FRM-SGV-IPAG IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-IPAG-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-DCL-SGV-FNEW.
           MOVE DCL-SGV-FNEW-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO DCL-SGV-FNEW IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DCL-SGV-FNEW-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-DCL-SGV-INTD.
           MOVE DCL-SGV-INTD-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO DCL-SGV-INTD IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DCL-SGV-INTD-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       VAL-NUM-DCL-SGV-PEGA.
           MOVE DCL-SGV-PEGA-ALF IN LIQ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 12 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO DCL-SGV-PEGA IN LIQ-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DCL-SGV-PEGA-LEN IN LIQ-FLD
                GO TO FIN-VAL-NUM-FLD-LIQ.
       FIN-VAL-NUM-FLD-LIQ.
           EXIT.
       
       EDT-KEY-LIQ SECTION.
       INI-EDT-KEY-LIQ.
           PERFORM EDT-IKY-LIQ.
           PERFORM EDT-MKY-LIQ.
           PERFORM EDT-AKY-LIQ.
       FIN-EDT-KEY-LIQ.
           EXIT.
       
       EDT-IKY-LIQ SECTION.
       INI-EDT-IKY-LIQ.
           IF LIQ-IIC-IOPD-LEN IN LIQ-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO LIQ-IIC-IOPD-LEN IN LIQ-FLD        
                GO TO FIN-EDT-IKY-LIQ.                                  
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO LIQ-IIC-IOPD-EDT IN LIQ-EDT. 
           MOVE LIQ-IIC-IOPD-EDT IN LIQ-EDT TO                          
                LIQ-IIC-IOPD-ALF IN LIQ-FLD.                            
           IF OPD-IIC-ISER-LEN IN LIQ-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO OPD-IIC-ISER-LEN IN LIQ-FLD        
                GO TO FIN-EDT-IKY-LIQ.                                  
           MOVE OPD-IIC-ISER IN LIQ-FLD TO OPD-IIC-ISER-EDT IN LIQ-EDT. 
           MOVE OPD-IIC-ISER-EDT IN LIQ-EDT TO                          
                OPD-IIC-ISER-ALF IN LIQ-FLD.                            
           IF LIQ-NUM-ILIQ-LEN IN LIQ-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO LIQ-NUM-ILIQ-LEN IN LIQ-FLD        
                GO TO FIN-EDT-IKY-LIQ.                                  
           MOVE LIQ-NUM-ILIQ IN LIQ-FLD TO LIQ-NUM-ILIQ-EDT IN LIQ-EDT. 
           MOVE LIQ-NUM-ILIQ-EDT IN LIQ-EDT TO                          
                LIQ-NUM-ILIQ-ALF IN LIQ-FLD.                            
           GO TO FIN-EDT-IKY-LIQ.   
           IF LIQ-IIC-IOPD-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LIQ-IIC-IOPD-LEN IN LIQ-FLD
                GO TO FIN-EDT-IKY-LIQ.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO LIQ-IIC-IOPD-EDT IN LIQ-EDT.
           MOVE LIQ-IIC-IOPD-EDT IN LIQ-EDT TO 
                LIQ-IIC-IOPD-ALF IN LIQ-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN LIQ-FLD
                GO TO FIN-EDT-IKY-LIQ.
           MOVE DBC-NUM-ICLI IN LIQ-FLD TO
                DBC-NUM-ICLI-EDT IN LIQ-EDT.
           MOVE DBC-NUM-ICLI-EDT IN LIQ-EDT TO
                DBC-NUM-ICLI-ALF IN LIQ-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF OPD-IIC-ISER-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPD-IIC-ISER-LEN IN LIQ-FLD
                GO TO FIN-EDT-IKY-LIQ.
           MOVE OPD-IIC-ISER IN LIQ-FLD TO OPD-IIC-ISER-EDT IN LIQ-EDT.
           MOVE OPD-IIC-ISER-EDT IN LIQ-EDT TO 
                OPD-IIC-ISER-ALF IN LIQ-FLD.
           IF LIQ-NUM-ILIQ-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LIQ-NUM-ILIQ-LEN IN LIQ-FLD
                GO TO FIN-EDT-IKY-LIQ.
           MOVE LIQ-NUM-ILIQ IN LIQ-FLD TO LIQ-NUM-ILIQ-EDT IN LIQ-EDT.
           MOVE LIQ-NUM-ILIQ-EDT IN LIQ-EDT TO 
                LIQ-NUM-ILIQ-ALF IN LIQ-FLD.
       FIN-EDT-IKY-LIQ.
           EXIT.
       
       EDT-MKY-LIQ SECTION.
       INI-EDT-MKY-LIQ.
       FIN-EDT-MKY-LIQ.
           EXIT.
       
       EDT-AKY-LIQ SECTION.
       INI-EDT-AKY-LIQ.
       FIN-EDT-AKY-LIQ.
           EXIT.
       
       EDT-FLD-LIQ SECTION.
       INI-EDT-FLD-LIQ.
   *<<<<EDT_FLD_LIQ
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA                 
           IF DBC-NUM-ICLI-LEN IN LIQ-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN LIQ-FLD        
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE DBC-NUM-ICLI IN LIQ-FLD TO                              
                DBC-NUM-ICLI-EDT IN LIQ-EDT.                            
           MOVE DBC-NUM-ICLI-EDT IN LIQ-EDT TO                          
                DBC-NUM-ICLI-ALF IN LIQ-FLD.                            
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA                 
           IF CAD-IIC-ICAD-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAD-IIC-ICAD-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE CAD-IIC-ICAD IN LIQ-FLD TO CAD-IIC-ICAD-EDT IN LIQ-EDT.
           MOVE CAD-IIC-ICAD-EDT IN LIQ-EDT TO
                CAD-IIC-ICAD-ALF IN LIQ-FLD.
           IF OPD-NUM-PVEN-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPD-NUM-PVEN-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE OPD-NUM-PVEN IN LIQ-FLD TO OPD-NUM-PVEN-EDT IN LIQ-EDT.
           MOVE OPD-NUM-PVEN-EDT IN LIQ-EDT TO
                OPD-NUM-PVEN-ALF IN LIQ-FLD.
           IF LIQ-SGV-TLVP-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LIQ-SGV-TLVP-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE LIQ-SGV-TLVP IN LIQ-FLD TO LIQ-SGV-TLVP-EDT IN LIQ-EDT.
           MOVE LIQ-SGV-TLVP-EDT IN LIQ-EDT TO
                LIQ-SGV-TLVP-ALF IN LIQ-FLD.
           IF OPD-SGV-TINT-LEN IN LIQ-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO OPD-SGV-TINT-LEN IN LIQ-FLD        
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE OPD-SGV-TINT IN LIQ-FLD TO OPD-SGV-TINT-EDT IN LIQ-EDT. 
           MOVE OPD-SGV-TINT-EDT IN LIQ-EDT TO                          
                OPD-SGV-TINT-ALF IN LIQ-FLD.                            
           IF DCL-SGV-RESC-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-RESC-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE DCL-SGV-RESC IN LIQ-FLD TO DCL-SGV-RESC-EDT IN LIQ-EDT.
           MOVE DCL-SGV-RESC-EDT IN LIQ-EDT TO
                DCL-SGV-RESC-ALF IN LIQ-FLD.
           IF OPD-VAL-CAPT-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPD-VAL-CAPT-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE OPD-VAL-CAPT IN LIQ-FLD TO OPD-VAL-CAPT-EDT IN LIQ-EDT.
           MOVE OPD-VAL-CAPT-EDT IN LIQ-EDT TO
                OPD-VAL-CAPT-ALF IN LIQ-FLD.
           IF LIQ-SGV-CAPI-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LIQ-SGV-CAPI-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE LIQ-SGV-CAPI IN LIQ-FLD TO LIQ-SGV-CAPI-EDT IN LIQ-EDT.
           MOVE LIQ-SGV-CAPI-EDT IN LIQ-EDT TO
                LIQ-SGV-CAPI-ALF IN LIQ-FLD.
           IF VEN-VAL-FINA-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-FINA-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE VEN-VAL-FINA IN LIQ-FLD TO VEN-VAL-FINA-EDT IN LIQ-EDT.
           MOVE VEN-VAL-FINA-EDT IN LIQ-EDT TO
                VEN-VAL-FINA-ALF IN LIQ-FLD.
           IF FRM-SGV-INTE-LEN IN LIQ-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO FRM-SGV-INTE-LEN IN LIQ-FLD        
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE FRM-SGV-INTE IN LIQ-FLD TO FRM-SGV-INTE-EDT IN LIQ-EDT. 
           MOVE FRM-SGV-INTE-EDT IN LIQ-EDT TO                          
                FRM-SGV-INTE-ALF IN LIQ-FLD.                            
           IF OPD-VAL-SCAP-LEN IN LIQ-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO OPD-VAL-SCAP-LEN IN LIQ-FLD        
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE OPD-VAL-SCAP IN LIQ-FLD TO OPD-VAL-SCAP-EDT IN LIQ-EDT. 
           MOVE OPD-VAL-SCAP-EDT IN LIQ-EDT TO                          
                OPD-VAL-SCAP-ALF IN LIQ-FLD.                            
           IF LIQ-SGV-TPAG-LEN IN LIQ-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO LIQ-SGV-TPAG-LEN IN LIQ-FLD        
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE LIQ-SGV-TPAG IN LIQ-FLD TO LIQ-SGV-TPAG-EDT IN LIQ-EDT. 
           MOVE LIQ-SGV-TPAG-EDT IN LIQ-EDT TO                          
                LIQ-SGV-TPAG-ALF IN LIQ-FLD.                            
           IF VEN-VAL-SFIN-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-SFIN-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE VEN-VAL-SFIN IN LIQ-FLD TO VEN-VAL-SFIN-EDT IN LIQ-EDT.
           MOVE VEN-VAL-SFIN-EDT IN LIQ-EDT TO
                VEN-VAL-SFIN-ALF IN LIQ-FLD.
           IF LIQ-SGV-PESO-LEN IN LIQ-FLD = FRM-ERR-NUME                
                MOVE FRM-IND-ERRO TO LIQ-SGV-PESO-LEN IN LIQ-FLD        
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE LIQ-SGV-PESO IN LIQ-FLD TO LIQ-SGV-PESO-EDT IN LIQ-EDT. 
           MOVE LIQ-SGV-PESO-EDT IN LIQ-EDT TO                          
                LIQ-SGV-PESO-ALF IN LIQ-FLD.                            
           IF DCL-SGV-KNEW-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-KNEW-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE DCL-SGV-KNEW IN LIQ-FLD TO DCL-SGV-KNEW-EDT IN LIQ-EDT.
           MOVE DCL-SGV-KNEW-EDT IN LIQ-EDT TO
                DCL-SGV-KNEW-ALF IN LIQ-FLD.
           IF FRM-SGV-IPAG-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-IPAG-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE FRM-SGV-IPAG IN LIQ-FLD TO FRM-SGV-IPAG-EDT IN LIQ-EDT.
           MOVE FRM-SGV-IPAG-EDT IN LIQ-EDT TO
                FRM-SGV-IPAG-ALF IN LIQ-FLD.
           IF DCL-SGV-FNEW-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-FNEW-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.                                  
           MOVE DCL-SGV-FNEW IN LIQ-FLD TO DCL-SGV-FNEW-EDT IN LIQ-EDT.
           MOVE DCL-SGV-FNEW-EDT IN LIQ-EDT TO
                DCL-SGV-FNEW-ALF IN LIQ-FLD.
           IF DCL-SGV-INTD-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-INTD-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE DCL-SGV-INTD IN LIQ-FLD TO DCL-SGV-INTD-EDT IN LIQ-EDT.
           MOVE DCL-SGV-INTD-EDT IN LIQ-EDT TO
                DCL-SGV-INTD-ALF IN LIQ-FLD.
           IF DCL-SGV-PEGA-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-PEGA-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE DCL-SGV-PEGA IN LIQ-FLD TO DCL-SGV-PEGA-EDT IN LIQ-EDT.
           MOVE DCL-SGV-PEGA-EDT IN LIQ-EDT TO
                DCL-SGV-PEGA-ALF IN LIQ-FLD.
           GO TO FIN-EDT-FLD-LIQ.
   *>>>> 
           IF CAD-IIC-ICAD-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAD-IIC-ICAD-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE CAD-IIC-ICAD IN LIQ-FLD TO CAD-IIC-ICAD-EDT IN LIQ-EDT.
           MOVE CAD-IIC-ICAD-EDT IN LIQ-EDT TO 
                CAD-IIC-ICAD-ALF IN LIQ-FLD.
           IF OPD-NUM-PVEN-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPD-NUM-PVEN-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE OPD-NUM-PVEN IN LIQ-FLD TO OPD-NUM-PVEN-EDT IN LIQ-EDT.
           MOVE OPD-NUM-PVEN-EDT IN LIQ-EDT TO 
                OPD-NUM-PVEN-ALF IN LIQ-FLD.
           IF LIQ-SGV-TLVP-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LIQ-SGV-TLVP-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE LIQ-SGV-TLVP IN LIQ-FLD TO LIQ-SGV-TLVP-EDT IN LIQ-EDT.
           MOVE LIQ-SGV-TLVP-EDT IN LIQ-EDT TO 
                LIQ-SGV-TLVP-ALF IN LIQ-FLD.
           IF OPD-SGV-TINT-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPD-SGV-TINT-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE OPD-SGV-TINT IN LIQ-FLD TO OPD-SGV-TINT-EDT IN LIQ-EDT.
           MOVE OPD-SGV-TINT-EDT IN LIQ-EDT TO 
                OPD-SGV-TINT-ALF IN LIQ-FLD.
           IF VEN-VAL-FINA-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-FINA-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE VEN-VAL-FINA IN LIQ-FLD TO VEN-VAL-FINA-EDT IN LIQ-EDT.
           MOVE VEN-VAL-FINA-EDT IN LIQ-EDT TO 
                VEN-VAL-FINA-ALF IN LIQ-FLD.
           IF VEN-VAL-SFIN-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-SFIN-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE VEN-VAL-SFIN IN LIQ-FLD TO VEN-VAL-SFIN-EDT IN LIQ-EDT.
           MOVE VEN-VAL-SFIN-EDT IN LIQ-EDT TO 
                VEN-VAL-SFIN-ALF IN LIQ-FLD.
           IF DCL-SGV-RESC-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-RESC-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE DCL-SGV-RESC IN LIQ-FLD TO DCL-SGV-RESC-EDT IN LIQ-EDT.
           MOVE DCL-SGV-RESC-EDT IN LIQ-EDT TO 
                DCL-SGV-RESC-ALF IN LIQ-FLD.
           IF OPD-VAL-CAPT-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPD-VAL-CAPT-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE OPD-VAL-CAPT IN LIQ-FLD TO OPD-VAL-CAPT-EDT IN LIQ-EDT.
           MOVE OPD-VAL-CAPT-EDT IN LIQ-EDT TO 
                OPD-VAL-CAPT-ALF IN LIQ-FLD.
           IF LIQ-SGV-CAPI-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LIQ-SGV-CAPI-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE LIQ-SGV-CAPI IN LIQ-FLD TO LIQ-SGV-CAPI-EDT IN LIQ-EDT.
           MOVE LIQ-SGV-CAPI-EDT IN LIQ-EDT TO 
                LIQ-SGV-CAPI-ALF IN LIQ-FLD.
           IF FRM-SGV-INTE-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INTE-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE FRM-SGV-INTE IN LIQ-FLD TO FRM-SGV-INTE-EDT IN LIQ-EDT.
           MOVE FRM-SGV-INTE-EDT IN LIQ-EDT TO 
                FRM-SGV-INTE-ALF IN LIQ-FLD.
           IF OPD-VAL-SCAP-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPD-VAL-SCAP-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE OPD-VAL-SCAP IN LIQ-FLD TO OPD-VAL-SCAP-EDT IN LIQ-EDT.
           MOVE OPD-VAL-SCAP-EDT IN LIQ-EDT TO 
                OPD-VAL-SCAP-ALF IN LIQ-FLD.
           IF LIQ-SGV-TPAG-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LIQ-SGV-TPAG-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE LIQ-SGV-TPAG IN LIQ-FLD TO LIQ-SGV-TPAG-EDT IN LIQ-EDT.
           MOVE LIQ-SGV-TPAG-EDT IN LIQ-EDT TO 
                LIQ-SGV-TPAG-ALF IN LIQ-FLD.
           IF LIQ-SGV-PESO-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LIQ-SGV-PESO-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE LIQ-SGV-PESO IN LIQ-FLD TO LIQ-SGV-PESO-EDT IN LIQ-EDT.
           MOVE LIQ-SGV-PESO-EDT IN LIQ-EDT TO 
                LIQ-SGV-PESO-ALF IN LIQ-FLD.
           IF DCL-SGV-KNEW-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-KNEW-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE DCL-SGV-KNEW IN LIQ-FLD TO DCL-SGV-KNEW-EDT IN LIQ-EDT.
           MOVE DCL-SGV-KNEW-EDT IN LIQ-EDT TO 
                DCL-SGV-KNEW-ALF IN LIQ-FLD.
           IF FRM-SGV-IPAG-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-IPAG-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE FRM-SGV-IPAG IN LIQ-FLD TO FRM-SGV-IPAG-EDT IN LIQ-EDT.
           MOVE FRM-SGV-IPAG-EDT IN LIQ-EDT TO 
                FRM-SGV-IPAG-ALF IN LIQ-FLD.
           IF DCL-SGV-FNEW-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-FNEW-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE DCL-SGV-FNEW IN LIQ-FLD TO DCL-SGV-FNEW-EDT IN LIQ-EDT.
           MOVE DCL-SGV-FNEW-EDT IN LIQ-EDT TO 
                DCL-SGV-FNEW-ALF IN LIQ-FLD.
           IF DCL-SGV-INTD-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-INTD-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE DCL-SGV-INTD IN LIQ-FLD TO DCL-SGV-INTD-EDT IN LIQ-EDT.
           MOVE DCL-SGV-INTD-EDT IN LIQ-EDT TO 
                DCL-SGV-INTD-ALF IN LIQ-FLD.
           IF DCL-SGV-PEGA-LEN IN LIQ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DCL-SGV-PEGA-LEN IN LIQ-FLD
                GO TO FIN-EDT-FLD-LIQ.
           MOVE DCL-SGV-PEGA IN LIQ-FLD TO DCL-SGV-PEGA-EDT IN LIQ-EDT.
           MOVE DCL-SGV-PEGA-EDT IN LIQ-EDT TO 
                DCL-SGV-PEGA-ALF IN LIQ-FLD.
       FIN-EDT-FLD-LIQ.
           EXIT.
      *<<<< EOF_BU

       BUS-PRM-SLA SECTION.
       INI-BUS-PRM-SLA.
           MOVE 'DAP'               TO TAB-COD-SIST.
           MOVE 'CDR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-RESC IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DESC TO FRM-GLS-PLRE IN LIQ-FLD
               MOVE TAB-CIC-CTAB TO WSS-OPD-CIC-RESC
      
               MOVE 'DAP'                TO TAB-COD-SIST
               MOVE 'PPR'                TO TAB-COD-TTAB IN TAB
               MOVE OPD-COD-PLPA  IN OPD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                   MOVE TAB-CIC-CTAB TO WSS-OPD-CIC-PLPA
      
      * ISP: YA CARGO FRM-FEC-FLRE EN FIN_SCR_TRL
      
                   MOVE FRM-NUM-DLRE IN LIQ-FLD TO WSS-NUM-DUNO
                   MOVE FRM-NUM-MLRE IN LIQ-FLD TO WSS-NUM-MUNO
                   MOVE FRM-NUM-SLRE IN LIQ-FLD TO WSS-NUM-SUNO
                   MOVE FRM-NUM-ALRE IN LIQ-FLD TO WSS-NUM-AUNO
      
                   MOVE LIQ-NUM-DREA IN LIQ-FLD TO WSS-NUM-DDOS
                   MOVE LIQ-NUM-MREA IN LIQ-FLD TO WSS-NUM-MDOS
                   MOVE LIQ-NUM-SREA IN LIQ-FLD TO WSS-NUM-SDOS
                   MOVE LIQ-NUM-AREA IN LIQ-FLD TO WSS-NUM-ADOS
                   IF WSS-FEC-FDOS < WSS-FEC-FUNO
                       MOVE 'S' TO WSS-IND-FEC-RESC
                   ELSE
                       MOVE 'N' TO WSS-IND-FEC-RESC
               ELSE
                   MOVE 'CODPLPAINV' TO MSG-COD-MENS
           ELSE
               MOVE 'CODRESCINV' TO MSG-COD-MENS.
      
           IF SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
                MOVE SPACES TO FRM-GLS-PLRE IN LIQ-FLD.
       FIN-BUS-PRM-SLA.
           EXIT.
      
       VAL-CTA SECTION.
       INI-VAL-CTA.
      * OPTIMIZAR CON MANEJO DE STATUS A TRAVES DE MSG-COD-MENS
           IF WSS-IND-CTA NOT > SPACES
               MOVE SPACES TO CAD-CAI-ICAD IN LIQ-FLD
               MOVE ZEROES TO CAD-IIC-ICAD IN LIQ-FLD
               GO TO FIN-VAL-CTA.
      
           IF SCR-CNAL = '150' AND
              CAD-IND-TCAD IN LIQ-FLD = 'CCMA' AND
              CAD-IIC-ICAD IN LIQ-FLD NOT > ZEROES
                 MOVE 'CAJA' TO CAD-IND-TCAD IN LIQ-FLD
                 GO TO FIN-VAL-CTA.
      
           IF CAD-IIC-ICAD IN LIQ-FLD NOT > ZEROES
               MOVE 'DAP'          TO MSG-COD-SIST
               MOVE 'IICICADCAOBL'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CAD-CAI-ICAD-LEN IN LIQ-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CTA.
      
           IF SCR-IND-MCLI = 'M'
               GO TO FIN-VAL-CTA.
      
           MOVE SCR-CIC-CLI1            TO RCO-CIC-ICLI IN RCO.
           MOVE CAD-CAI-ICAD IN LIQ-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CAD-IIC-ICAD IN LIQ-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               IF WSS-IND-MUOC = 'O'
                   MOVE 'DAP'          TO MSG-COD-SIST
                   MOVE 'CICICADMICLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE -1 TO CAD-CAI-ICAD-LEN IN LIQ-FLD
                   MOVE 'S' TO FRM-UCUR
                   GO TO FIN-VAL-CTA
               ELSE
                   GO TO CER-VAL-CAD-CAI-ICAD.
      
           MOVE CAD-CAI-ICAD IN LIQ-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CAD-IIC-ICAD IN LIQ-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CICICADNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CAD-CAI-ICAD-LEN IN LIQ-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CTA
           ELSE
               IF WSS-IND-MUOC = 'M'
                   MOVE 'DAP'          TO MSG-COD-SIST
                   MOVE 'CICICADOTCLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE -1 TO CAD-CAI-ICAD-LEN IN LIQ-FLD
                   MOVE 'S' TO FRM-UCUR
                   GO TO FIN-VAL-CTA.
       CER-VAL-CAD-CAI-ICAD.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF OPE-FEC-FTOP IN OPE > ZEROES
               IF OPE-FEC-FTOP IN OPE > OPE-FEC-FROP IN OPE
                   MOVE 'DAP'          TO MSG-COD-SIST
                   MOVE 'FECFTOPICYA>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE -1 TO CAD-CAI-ICAD-LEN IN LIQ-FLD
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-CTA.
           EXIT.
      
       CAL-SLA SECTION.
       INI-CAL-SLA.
           MOVE 'CALSLA' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SPACES TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE 'CICTVALC' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SCR-CIC-TVAL TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE 'CICVCAMC' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SCR-CIC-VCAM TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE OPD-VAL-SCAP IN OPD TO WSS-SGV-CAPI
                                       WSS-SGV-RESC
                                       SCR-SGV-CAPI.
      * ISP: WSS-SGV-CAPI,WSS-SGV-RESC,SCR-SGV-CAPI
      *      CON DECIMALES OK DESDE OPD-VAL-SCAP
      
           MOVE ZEROES TO WSS-SGV-INTE
                          WSS-SGV-TPAG-PESO
                          WSS-SGV-REAJ.
      
           IF SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP'
                PERFORM PRO-LVP.

           MOVE 'CALSLA01' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SCR-SGV-REAJ TO WSS-VAL-EDIT.
           MOVE WSS-VAL-EDIT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           IF SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
                PERFORM PRO-LRP.
      
           IF SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
                SUBTRACT LIQ-SGV-CAPI IN LIQ-FLD FROM
                     LIQ-SGV-TPAG IN LIQ-FLD GIVING
                     FRM-SGV-IPAG IN LIQ-FLD
      
                PERFORM SET-FRM-GLS-IPAG
      
                 SUBTRACT FRM-SGV-IPAG IN LIQ-FLD FROM
                     WSS-SGV-INTE-CVP        GIVING
                     DCL-SGV-PEGA IN LIQ-FLD
      
                 MOVE SCR-CIC-VCAM TO PES-CIC-VCAM
                 MOVE DCL-SGV-PEGA IN LIQ-FLD TO PES-SGV-DECI
                 PERFORM PES-SCTV
                 MOVE PES-SGV-ENTE TO DCL-SGV-PEGA IN LIQ-FLD
      
                 PERFORM SET-MSG-PEGA
      
                 GO TO FIN-CAL-SLA.
      
           IF SCR-CMND NOT = 'LVP' AND
              SCR-CMND NOT = 'CVP' AND
              SCR-CMND NOT = 'LRP' AND
              SCR-CMND NOT = 'CRP'
           IF ANTES-FECHA-RESCATE
               IF WSS-OPD-CIC-PLPA = 'L'
                   MOVE 'N' TO WSS-OPD-CIC-RESC
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'SLAK' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-GLS-PLRE IN LIQ-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-PLRE IN LIQ-FLD
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'DAP'          TO MSG-COD-SIST
                   MOVE 'FLIQSLA<PLRE' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE -1 TO FRM-FEC-FLRE-LEN IN LIQ-FLD
                   MOVE 'S' TO FRM-UCUR
                   GO TO FIN-CAL-SLA.
      
      
           IF OPD-COD-MORE NOT = 'PI'
                GO TO NOT-PI.
           MOVE ZEROES TO FRM-SGV-INTE IN LIQ-FLD.
           MOVE OPD-NUM-IVEN IN OPD TO WSS-NUM-IVEN.
           PERFORM GET-COD-CIC-OPD.
           MOVE FIO-GET-FST TO FIO-CMND.
       CIC-EXP-VEN.
      
           PERFORM GEN-PRX-RTR.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CAL-SLA.
           IF DAP-VEN-STAT-OKS
              IF OPD-NUM-IVEN IN OPD = WSS-NUM-IVEN
                   MOVE DAP-MTO-LIQU TO LIQ-SGV-TPAG IN LIQ-FLD
                   MOVE DAP-MTO-CAST TO SCR-SGV-MCAS
                   PERFORM SET-MNTO-PESO-PI
      
                   GO TO FIN-CAL-SLA
              ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO CIC-EXP-VEN.
      
       NOT-PI.
           IF WSS-OPD-CIC-RESC = 'I' OR 'A' OR
              OPD-COD-CVTI IN OPD > SPACES
      * JVM: 22/09/92  WSS-CON-INTE CONTROLA GENERACION DE INTERESES SEG
      *      => 0 = OPD-VAL-SCAP    1 = OPD-VAL-CAPT
               MOVE 0 TO WSS-CON-INTE
      * JVM: 22/09/92
               PERFORM SLA-INTE
      * ISP:   WSS-SGV-INTE CON DECIMALES OK EN SLA-INTE
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-CAL-SLA
               ELSE
                   MOVE WSS-SGV-INTE TO FRM-SGV-INTE IN LIQ-FLD
      * ISP:       FRM-SGV-INTE CON DECIMALES OK
                   ADD  WSS-SGV-INTE TO WSS-SGV-RESC.
      * ISP:       WSS-SGV-RESC CON DECIMALES OK
      
       END-CAL-SLA.
      
           MOVE WSS-SGV-RESC TO LIQ-SGV-TPAG IN LIQ-FLD.
      * ISP: LIQ-SGV-TPAG CON DECIMALES OK
           MOVE 'CICTVAL' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SCR-CIC-TVAL TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE 'CICVCAM' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SCR-CIC-VCAM TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      


           IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
                SCR-CIC-VCAM NOT = PDB-CIC-0999 )
      *ISP  18-AUG-1993 20:17:32 PARA SLA NUNCA PAGA REAJUSTES
      *           PERFORM SLA-FEC-REAJ
                 PERFORM VCAM-FCAP
                 IF MSG-COD-MENS > SPACES
                     GO TO FIN-CAL-SLA
                 ELSE
                 IF WSS-OPD-CIC-RESC = 'I'
      *                MULTIPLY WSS-SGV-INTE BY
      *                         WSS-SGV-VCAM-FSLA GIVING
      *                         WSS-SGV-INTE-PESO
      * ISP:  13-JUL-1992 12:18:59
      *       SEGUN MANTENCION SOLICITADA POR BCI
      *       INTERSES SE PAGAN A FECHA CAPTACION
                      MULTIPLY WSS-SGV-INTE BY
                               WSS-SGV-VCAM-FCAP GIVING
                               WSS-SGV-INTE-PESO
      
                      MULTIPLY WSS-SGV-CAPI BY
                               WSS-SGV-VCAM-FCAP GIVING
                               WSS-SGV-CAPI-PESO
      
                      ADD WSS-SGV-INTE-PESO
                          WSS-SGV-CAPI-PESO GIVING
                          WSS-SGV-TPAG-PESO
                 ELSE
      *ISP  18-AUG-1993 20:17:32 PARA SLA NUNCA PAGA REAJUSTES
      *           IF WSS-OPD-CIC-RESC = 'N'
                      MULTIPLY LIQ-SGV-TPAG IN LIQ-FLD BY
                               WSS-SGV-VCAM-FCAP GIVING
                               WSS-SGV-TPAG-PESO
      *           ELSE
      *                NEXT SENTENCE
      *                MULTIPLY LIQ-SGV-TPAG IN LIQ-FLD BY
      *                         WSS-SGV-VCAM-FSLA GIVING
      *                         WSS-SGV-TPAG-PESO
      *
      ** ISP: CALCULA REAJUSTE PARA DEJARLO GRABADO EN B.D.D
      *                MULTIPLY WSS-SGV-CAPI BY
      *                         WSS-SGV-VCAM-FCAP GIVING
      *                         WSS-SGV-REAJ-1
      *                MULTIPLY WSS-SGV-CAPI BY
      *                         WSS-SGV-VCAM-FSLA GIVING
      *                         WSS-SGV-REAJ-2
      *                SUBTRACT WSS-SGV-REAJ-1 FROM
      *                         WSS-SGV-REAJ-2 GIVING
      *                         WSS-SGV-REAJ
      
           ELSE
           IF SCR-CIC-VCAM = PDB-CIC-0999
                 MOVE LIQ-SGV-TPAG IN LIQ-FLD TO
                      WSS-SGV-TPAG-PESO
           ELSE
                 MOVE ZEROES TO WSS-SGV-TPAG-PESO.
      
           MOVE WSS-SGV-TPAG-PESO TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-TPAG-PESO.
           MOVE WSS-SGV-TPAG-PESO TO LIQ-SGV-PESO IN LIQ-FLD.
      
           MOVE WSS-SGV-REAJ TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-REAJ.
           MOVE WSS-SGV-REAJ TO SCR-SGV-REAJ.


           MOVE 'REAJLA' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SCR-SGV-REAJ TO WSS-VAL-EDIT.
           MOVE WSS-VAL-EDIT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
       FIN-CAL-SLA.
           EXIT.
      
       LIQ-FEC-REAJ SECTION.
       INI-LIQ-FEC-REAJ.
           PERFORM VCAM-FVEN.
           IF FRM-SUAR NOT = FRM-SUAR-MAL
               PERFORM VCAM-FCAP.
       FIN-LIQ-FEC-REAJ.
           EXIT.
      
      *ISP  18-AUG-1993 20:17:32 PARA SLA NUNCA PAGA REAJUSTES
        SLA-FEC-REAJ SECTION.
        INI-SLA-FEC-REAJ.
           MOVE 'FECREAJ1' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SCR-SGV-REAJ TO WSS-VAL-EDIT.
           MOVE WSS-VAL-EDIT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'FECREAJ2' TO QUE-COLA.
           MOVE SCR-SGV-REAJ TO WSS-VAL-EDIT.
           MOVE SCR-CMND     TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           IF SCR-CMND = 'CVP' OR                                       
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
                                                                        
                 MOVE 'DAP' TO TAB-COD-SIST                             
                 MOVE 'DAP' TO FIO-SIST                                 
                 MOVE 'VSN' TO TAB-COD-TTAB IN TAB                      
                 MOVE 'SEPREAJ' TO TAB-COD-CTAB IN TAB                  
                 MOVE FIO-GET-KEY TO FIO-CMND                           
                 PERFORM GNS-FIO-TAB                                    
                 IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )  
                    GO TO FIN-SLA-FEC-REAJ.                             
                                                                        
           PERFORM VCAM-FSLA.                                           

           MOVE 'FECREAJ3' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE FRM-SUAR     TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           IF FRM-SUAR NOT = FRM-SUAR-MAL                               
               PERFORM VCAM-FCAP.                                       
                                                                        
           IF SCR-CMND NOT = 'CVP' AND                                  
              SCR-CMND NOT = 'LVP' AND
              SCR-CMND NOT = 'LRP' AND
              SCR-CMND NOT = 'CRP'
               GO TO FIN-SLA-FEC-REAJ.                                  
                                                                        

           MOVE 'FECREAJ4' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE MSG-COD-MENS     TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
                                                                        
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-SLA-FEC-REAJ.                                  
                                                                        
           IF WSS-CAL-REAJ = 'VEN'
                MULTIPLY VEN-VAL-SCAP IN VEN BY
                         WSS-SGV-VCAM-FCAP GIVING
                         WSS-SGV-REAJ-1

                MULTIPLY VEN-VAL-SCAP IN VEN BY
                         WSS-SGV-VCAM-FSLA GIVING
                         WSS-SGV-REAJ-2

                SUBTRACT WSS-SGV-REAJ-1 FROM
                         WSS-SGV-REAJ-2 GIVING
                         SCR-SGV-REAJ
            ELSE
                MULTIPLY LIQ-SGV-CAPI IN LIQ-FLD BY
                         WSS-SGV-VCAM-FCAP GIVING
                         WSS-SGV-REAJ-1
                                                                        
                MULTIPLY LIQ-SGV-CAPI IN LIQ-FLD BY
                         WSS-SGV-VCAM-FSLA GIVING
                         WSS-SGV-REAJ-2
                                                                        
                SUBTRACT WSS-SGV-REAJ-1 FROM
                         WSS-SGV-REAJ-2 GIVING
                         SCR-SGV-REAJ.
                                                                        
           MOVE SCR-SGV-REAJ TO PES-SGV-DECI.                           
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE TO SCR-SGV-REAJ.                           
      
        FIN-SLA-FEC-REAJ.
            EXIT.
      
       VCAM-FCAP SECTION.
       INI-VCAM-FCAP.
      *VALOR DEL CAMBIO A FECHA CAPTACION
           MOVE PDB-CIC-0999        TO TAB-CIC-CTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
           MOVE OPD-NUM-DREA IN OPD TO TAB-NUM-DTRN IN TAB.
           MOVE OPD-NUM-MREA IN OPD TO TAB-NUM-MTRN IN TAB.
           MOVE OPD-NUM-SREA IN OPD TO TAB-NUM-STRN IN TAB.
           MOVE OPD-NUM-AREA IN OPD TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-FCAP
           ELSE
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'VCAMFCAPNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VCAM-FCAP.
           EXIT.
      
       VCAM-FSLA SECTION.
       INI-VCAM-FSLA.
      *VALOR DEL SALDO DE CAPITAL EN PESOS A FECHA DE RESCATE(LIQ. ANTIC
           MOVE PDB-CIC-0999        TO TAB-CIC-CTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
           MOVE LIQ-NUM-DREA IN LIQ-FLD TO TAB-NUM-DTRN IN TAB.
           MOVE LIQ-NUM-MREA IN LIQ-FLD TO TAB-NUM-MTRN IN TAB.
           MOVE LIQ-NUM-SREA IN LIQ-FLD TO TAB-NUM-STRN IN TAB.
           MOVE LIQ-NUM-AREA IN LIQ-FLD TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-FSLA
           ELSE
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'VCAMFSLANEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VCAM-FSLA.
           EXIT.
      
       VCAM-FVEN SECTION.
       INI-VCAM-FVEN.
      *VALOR DEL SALDO DE CAPITAL EN PESOS A FECHA DE TERMINO
      *O VENCIMIENTO.
           MOVE PDB-CIC-0999        TO TAB-CIC-CTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
           MOVE VEN-NUM-DVEN IN VEN TO TAB-NUM-DTRN IN TAB.
           MOVE VEN-NUM-MVEN IN VEN TO TAB-NUM-MTRN IN TAB.
           MOVE VEN-NUM-SVEN IN VEN TO TAB-NUM-STRN IN TAB.
           MOVE VEN-NUM-AVEN IN VEN TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-FVEN
           ELSE
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VCAM-FVEN.
           EXIT.
      
      *JVM: LOS DATOS OBTENIDOS DESDE CAL-LIQ SE RECUPERAN DIRECTAMENTE
      *     REG. "VEN".
      * CAL-LIQ SECTION.
      * INI-CAL-LIQ.
      *     MOVE OPD-VAL-SCAP IN OPD TO WSS-SGV-RESC.
      *     MOVE 1 TO SCR-SGV-VCAM.
      
      *    OBTIENE VALOR VALOR DE CAMBIO PARA MONEDA REAJUSTABLE,
      *    ES DECIR, CHILENA Y NO PESOS
      *     MOVE 'TAB'               TO TAB-COD-SIST.
      *     MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
      *     MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *SE DEBE VERIFICAR QUE BUSQUEDA DE CODIGO DE MONEDA SEA EXITOSO
      *EXISTENTE Y VIGENTE
      *     MOVE TAB-CIC-CTAB IN TAB TO SCR-CIC-VCAM.
      
      *     IF WSS-OPD-CIC-RESC = 'A'
      * JVM: 22/09/92
      *         MOVE 0 TO WSS-CON-INTE
      * JVM: 22/09/92
      *         PERFORM SLA-INTE
      *         IF MSG-COD-MENS > SPACES
      *             GO TO FIN-CAL-LIQ
      *         ELSE
      *             MOVE WSS-SGV-INTE TO FRM-SGV-INTE IN LIQ-FLD
      *             ADD WSS-SGV-INTE TO WSS-SGV-RESC.
      
      *     IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
      *          SCR-CIC-VCAM NOT = PDB-CIC-0999 )
      *               PERFORM VCAM-FVEN
      *               IF MSG-COD-MENS > SPACES
      *                   GO TO FIN-CAL-LIQ.
      *
      *      MOVE WSS-SGV-RESC TO LIQ-SGV-TPAG IN LIQ-FLD.*
      
      *     IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
      *          SCR-CIC-VCAM NOT = PDB-CIC-0999 )
      *            MULTIPLY LIQ-SGV-TPAG IN LIQ-FLD BY
      *                SCR-SGV-VCAM  GIVING
      *                LIQ-SGV-PESO IN LIQ-FLD
      *     ELSE
      *     IF SCR-CIC-VCAM = PDB-CIC-0999
      *           MOVE LIQ-SGV-TPAG IN LIQ-FLD TO
      *                LIQ-SGV-PESO IN LIQ-FLD
      *     ELSE
      *           MOVE ZEROES TO
      *                LIQ-SGV-PESO IN LIQ-FLD.
      
      * ISP: REDONDEA PESOS Y QUITA DECIMALES PARA MONEDA CHILENA
      *     IF SCR-CIC-TVAL = PDB-CIC-MNAC
      *         MOVE LIQ-SGV-PESO IN LIQ-FLD TO PES-SGV-DECI
      *         PERFORM PES-SCTV
      *         MOVE PES-SGV-ENTE TO LIQ-SGV-PESO IN LIQ-FLD.
      * FIN-CAL-LIQ.
      *     EXIT.
      
       OBT-LIQ SECTION.
       INI-OBT-LIQ.
           MOVE 'OBTLIQ' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SPACES TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE 'CICTVALL' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SCR-CIC-TVAL TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE 'CICVCAML' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE SCR-CIC-VCAM TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE VEN-VAL-SFIN IN VEN TO LIQ-SGV-TPAG IN LIQ-FLD.         
           MOVE VEN-VAL-SCAP IN VEN TO WSS-SGV-CAPI.                    
           MOVE WSS-SGV-CAPI        TO SCR-SGV-CAPI.                    
                                                                        
           SUBTRACT VEN-VAL-SCAP IN VEN FROM VEN-VAL-SFIN IN VEN        
                               GIVING FRM-SGV-INTE IN LIQ-FLD.          
                                                                        
           IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND                         
                SCR-CIC-VCAM NOT = PDB-CIC-0999 )                       
                    PERFORM LIQ-FEC-REAJ                                
                    IF MSG-COD-MENS > SPACES                            
                        GO TO FIN-OBT-LIQ                               
                    ELSE                                                
      * ISP: CALCULA REAJUSTE PARA DEJARLO GRABADO EN B.D.D             
                      MULTIPLY WSS-SGV-CAPI BY                          
                               WSS-SGV-VCAM-FCAP GIVING                 
                               WSS-SGV-REAJ-1                           
                      MULTIPLY WSS-SGV-CAPI BY                          
                               WSS-SGV-VCAM-FVEN GIVING                 
                               WSS-SGV-REAJ-2                           
                      SUBTRACT WSS-SGV-REAJ-1 FROM                      
                               WSS-SGV-REAJ-2 GIVING                    
                               WSS-SGV-REAJ                             
                                                                        
                      MULTIPLY LIQ-SGV-TPAG IN LIQ-FLD BY               
                      WSS-SGV-VCAM-FVEN GIVING WSS-SGV-TPAG-PESO        
           ELSE                                                         
           IF SCR-CIC-VCAM = PDB-CIC-0999                               
                 MOVE LIQ-SGV-TPAG IN LIQ-FLD TO WSS-SGV-TPAG-PESO      
           ELSE                                                         
                 MOVE ZEROES TO WSS-SGV-TPAG-PESO.                      
                                                                        
           MOVE WSS-SGV-TPAG-PESO TO PES-SGV-DECI.                      
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE TO WSS-SGV-TPAG-PESO.                      
           MOVE WSS-SGV-TPAG-PESO TO LIQ-SGV-PESO IN LIQ-FLD.           
                                                                        
           MOVE WSS-SGV-REAJ TO PES-SGV-DECI.                           
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE TO WSS-SGV-REAJ.                           
           MOVE WSS-SGV-REAJ TO SCR-SGV-REAJ.                           
       FIN-OBT-LIQ. 
           EXIT.
       SET-MNTO-PESO-PI SECTION.
       INI-SET-MNTO-PESO-PI.
           MOVE OPD-VAL-IPES IN OPD TO WSS-SGV-CAPI.
           MOVE OPD-VAL-IPES IN OPD TO SCR-SGV-CAPI.
           IF SCR-CIC-VCAM = PDB-CIC-0999
                 MOVE LIQ-SGV-TPAG IN LIQ-FLD TO
                      LIQ-SGV-PESO IN LIQ-FLD
           ELSE
                MULTIPLY LIQ-SGV-TPAG IN LIQ-FLD BY
                    WSS-SGV-VCAM-FCAP GIVING
                        WSS-SGV-TPAG-PESO
                MOVE WSS-SGV-TPAG-PESO TO PES-SGV-DECI
                PERFORM PES-SCTV
                MOVE PES-SGV-ENTE TO WSS-SGV-TPAG-PESO
                MOVE WSS-SGV-TPAG-PESO TO LIQ-SGV-PESO IN LIQ-FLD.
       FIN-SET-MNTO-PESO-PI.
           EXIT.
      
       SET-FTER SECTION.
       INI-SET-FTER.
      
           IF OPD-COD-MORE IN OPD = 'PI'
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2
            ELSE
               MOVE OPD-NUM-DTER IN OPD     TO FEC-DEC2
               MOVE OPD-NUM-MTER IN OPD     TO FEC-MEC2
               MOVE OPD-NUM-STER IN OPD     TO FEC-SEC2
               MOVE OPD-NUM-ATER IN OPD     TO FEC-AEC2.
       FIN-SET-FTER.
            EXIT.
      *
       PRO-LVP SECTION.
       INI-PRO-LVP.
      *
      * WSS-NUM-PRES = Plazo Residual
      * WSS-NUM-PBTI = Base
      * WSS-SGV-TTDE = LIQ-SGV-TLVP = Tasa descuento valor presente
      * LIQ-SGV-TPAG = Valor Presente
      
           MOVE 'LVP' TO WSS-VF-LVP-LRP.
      
           IF SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP'
               MOVE WSS-SGV-CAPI TO LIQ-SGV-CAPI IN LIQ-FLD.
      
           PERFORM CAL-VF-LVP-LRP.
      
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FEC1.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
                MOVE FEC-NDIA TO WSS-NUM-PRES
           ELSE
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE FEC-MENS     TO FRM-MENS
                GO TO FIN-PRO-LVP.
      
      *      MOVE 'I'                     TO VLR-MSC-TVAL IN VLR.
      *      MOVE 'TVP'                   TO VLR-COD-CVAL IN VLR.
      *      MOVE OPD-COD-PBTI IN OPD     TO VLR-COD-TCAM IN VLR.
      *      MOVE VLR-COD-VCAM IN VLR     TO TAB-COD-CTAB IN TAB.
      
      *      MOVE OPD-COD-VCAM IN OPD     TO TAB-CIC-CTAB IN TAB.
      
      *      MOVE LIQ-NUM-DREA IN LIQ-FLD TO TAB-NUM-DTRN IN TAB.
      *      MOVE LIQ-NUM-MREA IN LIQ-FLD TO TAB-NUM-MTRN IN TAB.
      *      MOVE LIQ-NUM-SREA IN LIQ-FLD TO TAB-NUM-STRN IN TAB.
      *      MOVE LIQ-NUM-AREA IN LIQ-FLD TO TAB-NUM-ATRN IN TAB.
      *      PERFORM GET-VCAM.
      *      IF MSG-COD-MENS = SPACES
      *          MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-TTDE
      *      ELSE
      *          MOVE 'N' TO WSS-CAL-SLA-GMSG
      *          MOVE 'DAP' TO MSG-COD-SIST
      *          MOVE 'VCAMFLVPNEX' TO MSG-COD-MENS
      *          PERFORM GET-MSG
      *          MOVE MSG-GLS-DESC TO WSS-LVP-MENS
      *          MOVE CAM-KEY-CAMB TO WSS-LVP-CCAM
      *          PERFORM SET-SVC
      *          MOVE WSS-LVP-MSG  TO FRM-MENS
      *          MOVE WSS-LVP-MSG  TO MSG-GLS-DESC
      *          MOVE FRM-SUAR-MAL TO FRM-SUAR
      *          GO TO FIN-PRO-LVP.
      
           IF OPD-COD-PBTI IN OPD = 'M'
                MOVE 030 TO WSS-NUM-PBTI
           ELSE
           IF OPD-COD-PBTI IN OPD = 'A'
                MOVE 360 TO WSS-NUM-PBTI
           ELSE
                MOVE 'N' TO WSS-CAL-SLA-GMSG
                MOVE 'DAP' TO MSG-COD-SIST
                MOVE 'LVPPBTIERR ' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-PRO-LVP.
      
           IF LIQ-SGV-TLVP IN LIQ-FLD > ZEROES AND
              LIQ-SGV-TPAG IN LIQ-FLD > ZEROES
                PERFORM PRO-LVP-TPAG-WSS

                IF SCR-CIC-TVAL = PDB-CIC-MNAC
                    MOVE LVP-SGV-PESO TO
                    LIQ-SGV-PESO IN LIQ-FLD
                END-IF

                COMPUTE WSS-SGV-DIFE = LVP-SGV-TPAG  -
                                       LIQ-SGV-TPAG IN LIQ-FLD
                IF WSS-SGV-DIFE NOT = ZEROES
                     MOVE 'DAP' TO MSG-COD-SIST
                     MOVE 'LVPDIFE<>0' TO MSG-COD-MENS
                     PERFORM GET-MSG

                     MOVE LVP-SGV-TPAG            TO WSS-LRP-MSG-M01
                     MOVE MSG-GLS-DESC            TO WSS-LRP-MSG-M02

                     MOVE LIQ-SGV-TPAG IN LIQ-FLD TO WSS-LRP-MSG-M03
                     MOVE MSG-GLS-DATA            TO WSS-LRP-MSG-M04

                     MOVE WSS-SGV-DIFE            TO WSS-LRP-MSG-M05
                     MOVE MSG-GLS-DCOR            TO WSS-LRP-MSG-M06

                     MOVE WSS-LRP-MSG TO FRM-MENS
                                         LIQ-GLS-MENS IN LIQ-FLD
                     PERFORM PRO-ACED
                     IF DCL-COD-ACED IN LIQ-FLD NOT = 'S'
                         MOVE FRM-SUAR-MAL TO FRM-SUAR
                     ELSE
                         GO TO FIN-PRO-LVP
                ELSE
                     NEXT SENTENCE
           ELSE
           IF ( LIQ-SGV-TLVP IN LIQ-FLD > ZEROES AND
                LIQ-SGV-TPAG IN LIQ-FLD NOT > ZEROES )
                        OR
              ( LIQ-SGV-TLVP IN LIQ-FLD NOT > ZEROES AND
                LIQ-SGV-TPAG IN LIQ-FLD NOT > ZEROES AND
                WSS-TASA-CERO = 'S' )
      * calcula total pagado a partir de tasa
                 PERFORM PRO-LVP-TPAG
                 IF FRM-SUAR = FRM-SUAR-MAL
                      GO TO FIN-PRO-LVP
                 ELSE
                      NEXT SENTENCE
           ELSE
           IF LIQ-SGV-TLVP IN LIQ-FLD NOT > ZEROES AND                          
              LIQ-SGV-TPAG IN LIQ-FLD > ZEROES                                  
                 PERFORM PRO-LVP-TASA.
      
       FIN-PRO-LVP.
           EXIT.
      
       PRO-LVP-TPAG SECTION.
       INI-PRO-LVP-TPAG.
           MOVE 'LVPTPAG' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.
      
           MOVE LIQ-SGV-TLVP IN LIQ-FLD TO WSS-SGV-TTDE.
      *    COMPUTE LIQ-SGV-TPAG IN LIQ-FLD ROUNDED =
      *       VEN-VAL-SFIN IN VEN /
      *       ( 1 + ( (
      *                 ( WSS-SGV-TTDE            / 100 ) / WSS-NUM-PBTI
      **                ( LIQ-SGV-TLVP IN LIQ-FLD / 100 ) / WSS-NUM-PBTI
      *               )
      *                            *
      *                      WSS-NUM-PRES
      *             )
      *       ).
           DIVIDE WSS-SGV-TTDE BY 100 GIVING WSS-SGV-TTDE
                      ROUNDED.
           DIVIDE WSS-SGV-TTDE BY WSS-NUM-PBTI GIVING WSS-SGV-TTDE.
      *     MOVE   WSS-SGV-TTDE TO WSS-LVP-EDIT.
      *     MOVE   'CALC1' TO QUE-COLA.
      *     MOVE WSS-LVP-EDIT TO QUE-ITEM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     MOVE +30 TO QUE-LITM.
      *     PERFORM GNS-PRO-QUE.
      
           MULTIPLY WSS-SGV-TTDE BY WSS-NUM-PRES GIVING WSS-SGV-TTDE
                      ROUNDED.
           ADD 1 TO WSS-SGV-TTDE.
           DIVIDE VEN-VAL-SFIN IN VEN BY
                  WSS-SGV-TTDE GIVING
                  LIQ-SGV-TPAG IN LIQ-FLD ROUNDED.
      
      *     MOVE   WSS-SGV-TTDE TO WSS-LVP-EDIT.
      *      MOVE   'CALC2' TO QUE-COLA.
      *      MOVE WSS-LVP-EDIT TO QUE-ITEM.
      *      MOVE QUE-PUT TO QUE-CMND.
      *      MOVE +30 TO QUE-LITM.
      *      PERFORM GNS-PRO-QUE.
      
      
           MOVE SCR-CIC-VCAM TO PES-CIC-VCAM.
      
      *      MOVE   'CALC3' TO QUE-COLA.
      *      MOVE PES-CIC-VCAM TO QUE-ITEM.
      *      MOVE QUE-PUT TO QUE-CMND.
      *      MOVE +30 TO QUE-LITM.
      *      PERFORM GNS-PRO-QUE.
      
           MOVE LIQ-SGV-TPAG IN LIQ-FLD TO PES-SGV-DECI.
           IF OPD-COD-VCAM IN OPD = '0993  '
               MOVE 4 TO PES-NUM-DECI IN PES-VARI.
      
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO LIQ-SGV-TPAG IN LIQ-FLD.
      
      *      MOVE   LIQ-SGV-TPAG IN LIQ-FLD TO WSS-LVP-EDIT.
      *      MOVE   'CALC4' TO QUE-COLA.
      *      MOVE WSS-LVP-EDIT TO QUE-ITEM.
      *      MOVE QUE-PUT TO QUE-CMND.
      *      MOVE +30 TO QUE-LITM.
      *      PERFORM GNS-PRO-QUE.
      
           SUBTRACT OPD-VAL-SCAP IN OPD FROM
                    LIQ-SGV-TPAG IN LIQ-FLD GIVING
                    FRM-SGV-INTE IN LIQ-FLD.
      
           IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
                SCR-CIC-VCAM NOT = PDB-CIC-0999 )
                 MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB
                 MOVE OPD-COD-VCAM IN OPD     TO TAB-COD-CTAB IN TAB
                 MOVE LIQ-NUM-DREA IN LIQ-FLD TO TAB-NUM-DTRN IN TAB
                 MOVE LIQ-NUM-MREA IN LIQ-FLD TO TAB-NUM-MTRN IN TAB
                 MOVE LIQ-NUM-SREA IN LIQ-FLD TO TAB-NUM-STRN IN TAB
                 MOVE LIQ-NUM-AREA IN LIQ-FLD TO TAB-NUM-ATRN IN TAB
                 PERFORM GET-VCAM
                 IF MSG-COD-MENS > SPACES
                     MOVE 'N' TO WSS-CAL-SLA-GMSG
                     MOVE 'DAP' TO MSG-COD-SIST
                     MOVE 'LVPVCAMFLIQ' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-PRO-LVP-TPAG
                 ELSE
                      MULTIPLY FRM-SGV-INTE IN LIQ-FLD BY
                               CAM-SGV-VCAM IN CAM GIVING
                               WSS-SGV-INTE-PESO
      
                      MULTIPLY OPD-VAL-SCAP IN OPD BY
                               CAM-SGV-VCAM IN CAM GIVING
                               WSS-SGV-CAPI-PESO
      
                      ADD WSS-SGV-INTE-PESO
                          WSS-SGV-CAPI-PESO GIVING
                          WSS-SGV-TPAG-PESO
           ELSE
           IF SCR-CIC-VCAM = PDB-CIC-0999
                 MOVE LIQ-SGV-TPAG IN LIQ-FLD TO
                      WSS-SGV-TPAG-PESO
           ELSE
                 MOVE ZEROES TO WSS-SGV-TPAG-PESO.
      
           MOVE WSS-SGV-TPAG-PESO TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-TPAG-PESO.
           MOVE WSS-SGV-TPAG-PESO TO LIQ-SGV-PESO IN LIQ-FLD.
      
           IF SCR-CIC-VCAM = PDB-CIC-0999
                 MOVE LIQ-SGV-PESO IN LIQ-FLD TO
                      LIQ-SGV-TPAG IN LIQ-FLD.
       FIN-PRO-LVP-TPAG.
           EXIT.

       PRO-LVP-TPAG-WSS SECTION.
       INI-PRO-LVP-TPAG-WSS.
           MOVE 'LVPTPAG' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE LIQ-SGV-TLVP IN LIQ-FLD TO WSS-SGV-TTDE.
      *    COMPUTE LIQ-SGV-TPAG IN LIQ-FLD ROUNDED =
      *       VEN-VAL-SFIN IN VEN /
      *       ( 1 + ( (
      *                 ( WSS-SGV-TTDE            / 100 ) / WSS-NUM-PBTI
      **                ( LIQ-SGV-TLVP IN LIQ-FLD / 100 ) / WSS-NUM-PBTI
      *               )
      *                            *
      *                      WSS-NUM-PRES
      *             )
      *       ).
           DIVIDE WSS-SGV-TTDE BY 100 GIVING WSS-SGV-TTDE
                      ROUNDED.
           DIVIDE WSS-SGV-TTDE BY WSS-NUM-PBTI GIVING WSS-SGV-TTDE.
      *     MOVE   WSS-SGV-TTDE TO WSS-LVP-EDIT.
      *     MOVE   'CALC1' TO QUE-COLA.
      *     MOVE WSS-LVP-EDIT TO QUE-ITEM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     MOVE +30 TO QUE-LITM.
      *     PERFORM GNS-PRO-QUE.

           MULTIPLY WSS-SGV-TTDE BY WSS-NUM-PRES GIVING WSS-SGV-TTDE
                      ROUNDED.
           ADD 1 TO WSS-SGV-TTDE.
           DIVIDE VEN-VAL-SFIN IN VEN BY
                  WSS-SGV-TTDE GIVING
                  LVP-SGV-TPAG ROUNDED.

      *     MOVE   WSS-SGV-TTDE TO WSS-LVP-EDIT.
      *      MOVE   'CALC2' TO QUE-COLA.
      *      MOVE WSS-LVP-EDIT TO QUE-ITEM.
      *      MOVE QUE-PUT TO QUE-CMND.
      *      MOVE +30 TO QUE-LITM.
      *      PERFORM GNS-PRO-QUE.


           MOVE SCR-CIC-VCAM TO PES-CIC-VCAM.

      *      MOVE   'CALC3' TO QUE-COLA.
      *      MOVE PES-CIC-VCAM TO QUE-ITEM.
      *      MOVE QUE-PUT TO QUE-CMND.
      *      MOVE +30 TO QUE-LITM.
      *      PERFORM GNS-PRO-QUE.

           MOVE LVP-SGV-TPAG TO PES-SGV-DECI.
           IF OPD-COD-VCAM IN OPD = '0993  '
               MOVE 4 TO PES-NUM-DECI IN PES-VARI.

           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO LVP-SGV-TPAG.

      *      MOVE   LIQ-SGV-TPAG IN LIQ-FLD TO WSS-LVP-EDIT.
      *      MOVE   'CALC4' TO QUE-COLA.
      *      MOVE WSS-LVP-EDIT TO QUE-ITEM.
      *      MOVE QUE-PUT TO QUE-CMND.
      *      MOVE +30 TO QUE-LITM.
      *      PERFORM GNS-PRO-QUE.

           SUBTRACT OPD-VAL-SCAP IN OPD FROM
                    LVP-SGV-TPAG GIVING
                    WSS-FRM-SGV-INTE.

           IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
                SCR-CIC-VCAM NOT = PDB-CIC-0999 )
                 MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB
                 MOVE OPD-COD-VCAM IN OPD     TO TAB-COD-CTAB IN TAB
                 MOVE LIQ-NUM-DREA IN LIQ-FLD TO TAB-NUM-DTRN IN TAB
                 MOVE LIQ-NUM-MREA IN LIQ-FLD TO TAB-NUM-MTRN IN TAB
                 MOVE LIQ-NUM-SREA IN LIQ-FLD TO TAB-NUM-STRN IN TAB
                 MOVE LIQ-NUM-AREA IN LIQ-FLD TO TAB-NUM-ATRN IN TAB
                 PERFORM GET-VCAM
                 IF MSG-COD-MENS > SPACES
                     MOVE 'N' TO WSS-CAL-SLA-GMSG
                     MOVE 'DAP' TO MSG-COD-SIST
                     MOVE 'LVPVCAMFLIQ' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-PRO-LVP-TPAG-WSS
                 ELSE
                      MULTIPLY WSS-FRM-SGV-INTE BY
                               CAM-SGV-VCAM IN CAM GIVING
                               WSS-SGV-INTE-PESO

                      MULTIPLY OPD-VAL-SCAP IN OPD BY
                               CAM-SGV-VCAM IN CAM GIVING
                               WSS-SGV-CAPI-PESO

                      ADD WSS-SGV-INTE-PESO
                          WSS-SGV-CAPI-PESO GIVING
                          WSS-SGV-TPAG-PESO
           ELSE
           IF SCR-CIC-VCAM = PDB-CIC-0999
                 MOVE LVP-SGV-TPAG TO
                      WSS-SGV-TPAG-PESO
           ELSE
                 MOVE ZEROES TO WSS-SGV-TPAG-PESO.
      
           MOVE WSS-SGV-TPAG-PESO TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-TPAG-PESO.
           MOVE WSS-SGV-TPAG-PESO TO LVP-SGV-PESO.

           IF SCR-CIC-VCAM = PDB-CIC-0999
                 MOVE LVP-SGV-PESO TO
                      LVP-SGV-TPAG.
       FIN-PRO-LVP-TPAG-WSS.
           EXIT.
      
       PRO-LVP-TASA SECTION.
       INI-PRO-LVP-TASA.
           MOVE 'LVPTASA' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.
      
      *==>> 01
           MOVE SCR-CIC-VCAM TO PES-CIC-VCAM.
      
           MOVE LIQ-SGV-TPAG IN LIQ-FLD TO PES-SGV-DECI.
           IF OPD-COD-VCAM IN OPD = '0993  '
               MOVE 4 TO PES-NUM-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO LIQ-SGV-TPAG IN LIQ-FLD.
      
      
      *    COMPUTE LIQ-SGV-TLVP IN LIQ-FLD ROUNDED =
      *    (
      *      (
      *        (
      *           VEN-VAL-SFIN IN VEN / LIQ-SGV-TPAG IN LIQ-FLD
      *         )
      *                   - 1
      *      )
      *      *
      *      WSS-NUM-PBTI
      *    )
      *    /
      *    WSS-NUM-PRES
      *    *
      *    100
      *
           DIVIDE VEN-VAL-SFIN IN VEN BY LIQ-SGV-TPAG IN LIQ-FLD
              GIVING WSS-SGV-TTDE-TEMP.
           SUBTRACT 1 FROM WSS-SGV-TTDE-TEMP.
           MULTIPLY WSS-SGV-TTDE-TEMP BY
                    WSS-NUM-PBTI
             GIVING WSS-SGV-TTDE-TEMP.
           DIVIDE   WSS-SGV-TTDE-TEMP BY
                    WSS-NUM-PRES
             GIVING WSS-SGV-TTDE-TEMP.
           MULTIPLY WSS-SGV-TTDE-TEMP BY
                    100
             GIVING WSS-SGV-TTDE-TEMP.
      
           MOVE WSS-SGV-TTDE-TEMP TO PES-SGV-DECI.
           MOVE 2 TO PES-NUM-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-TTDE-TEMP.
      
           MOVE     WSS-SGV-TTDE-TEMP TO
                    LIQ-SGV-TLVP IN LIQ-FLD.
      
           SUBTRACT OPD-VAL-SCAP IN OPD FROM
                    LIQ-SGV-TPAG IN LIQ-FLD GIVING
                    FRM-SGV-INTE IN LIQ-FLD.
      
           IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
                SCR-CIC-VCAM NOT = PDB-CIC-0999 )
                 MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB
                 MOVE OPD-COD-VCAM IN OPD     TO TAB-COD-CTAB IN TAB
                 MOVE LIQ-NUM-DREA IN LIQ-FLD TO TAB-NUM-DTRN IN TAB
                 MOVE LIQ-NUM-MREA IN LIQ-FLD TO TAB-NUM-MTRN IN TAB
                 MOVE LIQ-NUM-SREA IN LIQ-FLD TO TAB-NUM-STRN IN TAB
                 MOVE LIQ-NUM-AREA IN LIQ-FLD TO TAB-NUM-ATRN IN TAB
                 PERFORM GET-VCAM
                 IF MSG-COD-MENS > SPACES
                     MOVE 'N' TO WSS-CAL-SLA-GMSG
                     MOVE 'DAP' TO MSG-COD-SIST
                     MOVE 'LVPVCAMFLIQ' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-PRO-LVP-TASA
                 ELSE
                      MULTIPLY FRM-SGV-INTE IN LIQ-FLD BY
                               CAM-SGV-VCAM IN CAM GIVING
                               WSS-SGV-INTE-PESO
      
                      MULTIPLY OPD-VAL-SCAP IN OPD BY
                               CAM-SGV-VCAM IN CAM GIVING
                               WSS-SGV-CAPI-PESO
      
                      ADD WSS-SGV-INTE-PESO
                          WSS-SGV-CAPI-PESO GIVING
                          WSS-SGV-TPAG-PESO
           ELSE
           IF SCR-CIC-VCAM = PDB-CIC-0999
                 MOVE LIQ-SGV-TPAG IN LIQ-FLD TO
                      WSS-SGV-TPAG-PESO
           ELSE
                 MOVE ZEROES TO WSS-SGV-TPAG-PESO.
      
           MOVE WSS-SGV-TPAG-PESO TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-TPAG-PESO.
           MOVE WSS-SGV-TPAG-PESO TO LIQ-SGV-PESO IN LIQ-FLD.
      
           IF SCR-CIC-VCAM = PDB-CIC-0999
                 MOVE LIQ-SGV-PESO IN LIQ-FLD TO
                      LIQ-SGV-TPAG IN LIQ-FLD.
      
       FIN-PRO-LVP-TASA.
           EXIT.
      
       PRO-LRP-TPAG SECTION.
       INI-PRO-LRP-TPAG.
      
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE LIQ-FEC-FREA IN LIQ-FLD TO FEC-FEC1.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
                MOVE FEC-NDIA TO WSS-NUM-PRES
           ELSE
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE FEC-MENS     TO FRM-MENS
                GO TO FIN-PRO-LRP-TPAG.
      
           MOVE 'LRPTPAG' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.
      
           MOVE LIQ-SGV-TLVP IN LIQ-FLD TO WSS-SGV-TTDE.
      *    COMPUTE LRP-SGV-TPAG ROUNDED =
      *       DCL-SGV-RESC IN LIQ-FLD /
      *       ( 1 + ( (
      *                 ( WSS-SGV-TTDE            / 100 ) / WSS-NUM-PBTI
      **                ( LIQ-SGV-TLVP IN LIQ-FLD / 100 ) / WSS-NUM-PBTI
      *               )
      *                            *
      *                      WSS-NUM-PRES
      *             )
      *       ).
           DIVIDE WSS-SGV-TTDE BY 100 GIVING WSS-SGV-TTDE
                      ROUNDED.
           DIVIDE WSS-SGV-TTDE BY WSS-NUM-PBTI GIVING WSS-SGV-TTDE.
      
           MOVE   WSS-SGV-TTDE TO WSS-LVP-EDIT.
           MOVE   'LRPCALC1' TO QUE-COLA.
           MOVE WSS-LVP-EDIT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.
      
           MULTIPLY WSS-SGV-TTDE BY WSS-NUM-PRES GIVING WSS-SGV-TTDE
                      ROUNDED.
           ADD 1 TO WSS-SGV-TTDE.
           DIVIDE DCL-SGV-RESC IN LIQ-FLD BY
                  WSS-SGV-TTDE GIVING
                  LRP-SGV-TPAG ROUNDED.
      
           MOVE   WSS-SGV-TTDE TO WSS-LVP-EDIT.
           MOVE   'LRPCALC2' TO QUE-COLA.
           MOVE WSS-LVP-EDIT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.
      
           MOVE SCR-CIC-VCAM TO PES-CIC-VCAM.
      
           MOVE   'LRPCALC3' TO QUE-COLA.
           MOVE PES-CIC-VCAM TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.
      
           MOVE LRP-SGV-TPAG TO PES-SGV-DECI.
           IF OPD-COD-VCAM IN OPD = '0993  '
               MOVE 4 TO PES-NUM-DECI IN PES-VARI.
      
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO LRP-SGV-TPAG.
      
           MOVE   LRP-SGV-TPAG TO WSS-LVP-EDIT.
           MOVE   'LRPCALC4' TO QUE-COLA.
           MOVE WSS-LVP-EDIT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.
      
      
      *    IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
      *         SCR-CIC-VCAM NOT = PDB-CIC-0999 )
      *          MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB
      *          MOVE OPD-COD-VCAM IN OPD     TO TAB-COD-CTAB IN TAB
      *          MOVE LIQ-NUM-DREA IN LIQ-FLD TO TAB-NUM-DTRN IN TAB
      *          MOVE LIQ-NUM-MREA IN LIQ-FLD TO TAB-NUM-MTRN IN TAB
      *          MOVE LIQ-NUM-SREA IN LIQ-FLD TO TAB-NUM-STRN IN TAB
      *          MOVE LIQ-NUM-AREA IN LIQ-FLD TO TAB-NUM-ATRN IN TAB
      *          PERFORM GET-VCAM
      *          IF MSG-COD-MENS > SPACES
      *              MOVE 'N' TO WSS-CAL-SLA-GMSG
      *              MOVE 'DAP' TO MSG-COD-SIST
      *              MOVE 'LVPVCAMFLIQ' TO MSG-COD-MENS
      *              PERFORM GET-MSG
      *              MOVE MSG-GLS-DESC TO FRM-MENS
      *              MOVE FRM-SUAR-MAL TO FRM-SUAR
      *              GO TO FIN-PRO-LRP-TPAG
      *          ELSE
      *               MULTIPLY LRP-SGV-TPAG BY
      *                        CAM-SGV-VCAM IN CAM GIVING
      *                        LRP-SGV-TPAG
      *               MOVE LRP-SGV-TPAG TO PES-SGV-DECI
      *               PERFORM PES-SCTV
      *               MOVE PES-SGV-ENTE TO LRP-SGV-TPAG.
      *
      
           MOVE   LRP-SGV-TPAG TO WSS-LVP-EDIT.
           MOVE   'LRPCALC5' TO QUE-COLA.
           MOVE WSS-LVP-EDIT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.
       FIN-PRO-LRP-TPAG.
           EXIT.
      
      *
       PRO-LRP SECTION.
       INI-PRO-LRP.
      *
      * WSS-NUM-PTOT = Plazo Total
      * WSS-NUM-PBTI = Base
      * WSS-SGV-TTDE = LIQ-SGV-TLVP = Tasa descuento valor presente
      * LIQ-SGV-TPAG = Valor Presente
      
           MOVE 'LRP' TO WSS-VF-LVP-LRP.
      
           MOVE SCR-CIC-VCAM TO PES-CIC-VCAM.
           MOVE LIQ-SGV-TPAG IN LIQ-FLD TO PES-SGV-DECI.
           IF OPD-COD-VCAM IN OPD = '0993  '
               MOVE 4 TO PES-NUM-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO LIQ-SGV-TPAG IN LIQ-FLD.
      
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
      
           MOVE OPD-NUM-DREA IN OPD     TO FEC-DEC1.
           MOVE OPD-NUM-MREA IN OPD     TO FEC-MEC1.
           MOVE OPD-NUM-SREA IN OPD     TO FEC-SEC1.
           MOVE OPD-NUM-AREA IN OPD     TO FEC-AEC1.
      
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
                MOVE FEC-NDIA TO WSS-NUM-PTOT
           ELSE
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE FEC-MENS     TO FRM-MENS
                GO TO FIN-PRO-LRP.
      
           IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
                SCR-CIC-VCAM NOT = PDB-CIC-0999 )
                    MOVE 'LIQ' TO WSS-CAL-REAJ
                   PERFORM SLA-FEC-REAJ
                    IF MSG-COD-MENS > SPACES
                        MOVE FRM-SUAR-MAL TO FRM-SUAR
                        GO TO FIN-PRO-LRP.
      
           IF OPD-COD-PBTI IN OPD = 'M'
                MOVE 030 TO WSS-NUM-PBTI
           ELSE
           IF OPD-COD-PBTI IN OPD = 'A'
                MOVE 360 TO WSS-NUM-PBTI
           ELSE
                MOVE 'N' TO WSS-CAL-SLA-GMSG
                MOVE 'DAP' TO MSG-COD-SIST
                MOVE 'LVPPBTIERR ' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-PRO-LRP.
      
      *    COMPUTE LIQ-SGV-CAPI IN LIQ-FLD ROUNDED =
      *      (
      *         (
      *            (
      *             DCL-SGV-RESC IN LIQ-FLD * WSS-NUM-PBTI * 100
      *            )
      *            /
      *            (
      *              (
      *                WSS-NUM-PTOT * OPD-SGV-TINT IN OPD
      *              )
      *              +
      *              (
      *                100 * WSS-NUM-PBTI
      *              )
      *            )
      *         )
      *      )
      
           IF DCL-SGV-RESC IN LIQ-FLD =
              VEN-VAL-SFIN IN VEN
                 MOVE VEN-VAL-SCAP IN VEN TO
                      LIQ-SGV-CAPI IN LIQ-FLD
           ELSE

           COMPUTE LIQ-SGV-CAPI IN LIQ-FLD ROUNDED =
             (
                (
                   (
                    DCL-SGV-RESC IN LIQ-FLD * WSS-NUM-PBTI * 100
                   )
                   /
                   (
                     (
                      WSS-NUM-PTOT * OPD-SGV-TINT IN OPD
                     )
                     +
                     (
                       100 * WSS-NUM-PBTI
                     )
                   )
                )
             ).
      
           PERFORM CAL-VF-LVP-LRP.
      
           MOVE SCR-CIC-VCAM TO PES-CIC-VCAM.
      
           MOVE LIQ-SGV-CAPI IN LIQ-FLD TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO LIQ-SGV-CAPI IN LIQ-FLD.
      
           MOVE LIQ-SGV-CAPI IN LIQ-FLD TO SCR-SGV-CAPI.
      
      
           SUBTRACT LIQ-SGV-CAPI IN LIQ-FLD FROM
                    DCL-SGV-RESC IN LIQ-FLD GIVING
                    FRM-SGV-INTE IN LIQ-FLD.
      
           SUBTRACT DCL-SGV-RESC IN LIQ-FLD FROM
                    VEN-VAL-SFIN IN LIQ-FLD GIVING
                    DCL-SGV-FNEW IN LIQ-FLD.
      
           SUBTRACT LIQ-SGV-CAPI IN LIQ-FLD FROM
                    OPD-VAL-SCAP IN LIQ-FLD GIVING
                    DCL-SGV-KNEW IN LIQ-FLD.
      
           IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
                SCR-CIC-VCAM NOT = PDB-CIC-0999 )
                 MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB
                 MOVE OPD-COD-VCAM IN OPD     TO TAB-COD-CTAB IN TAB
                 MOVE LIQ-NUM-DREA IN LIQ-FLD TO TAB-NUM-DTRN IN TAB
                 MOVE LIQ-NUM-MREA IN LIQ-FLD TO TAB-NUM-MTRN IN TAB
                 MOVE LIQ-NUM-SREA IN LIQ-FLD TO TAB-NUM-STRN IN TAB
                 MOVE LIQ-NUM-AREA IN LIQ-FLD TO TAB-NUM-ATRN IN TAB
                 PERFORM GET-VCAM
                 IF MSG-COD-MENS > SPACES
                     MOVE 'N' TO WSS-CAL-SLA-GMSG
                     MOVE 'DAP' TO MSG-COD-SIST
                     MOVE 'LVPVCAMFLIQ' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-PRO-LRP
                 ELSE
                      MULTIPLY FRM-SGV-INTE IN LIQ-FLD BY
                               CAM-SGV-VCAM IN CAM GIVING
                               WSS-SGV-INTE-PESO
      
                      MULTIPLY OPD-VAL-SCAP IN OPD BY
                               CAM-SGV-VCAM IN CAM GIVING
                               WSS-SGV-CAPI-PESO
      
      *               ADD WSS-SGV-INTE-PESO
      *                   WSS-SGV-CAPI-PESO GIVING
      *                   WSS-SGV-TPAG-PESO
           ELSE
           IF SCR-CIC-VCAM = PDB-CIC-0999
                 MOVE LIQ-SGV-TPAG IN LIQ-FLD TO
                      WSS-SGV-TPAG-PESO
           ELSE
                 MOVE ZEROES TO WSS-SGV-TPAG-PESO.
      
       FIN-PRO-LRP.
           EXIT.
      
       SET-SVC SECTION.
       INI-SET-SVC.
           IF OPD-COD-VCAM IN OPD = '0999  ' AND
              OPD-COD-PBTI IN OPD = 'M'
                MOVE 'VPM$' TO WSS-LVP-CSVC
           ELSE
           IF OPD-COD-VCAM IN OPD = '0999  ' AND
              OPD-COD-PBTI IN OPD = 'A'
                MOVE 'VPA$' TO WSS-LVP-CSVC
           ELSE
           IF OPD-COD-VCAM IN OPD = '0998  ' AND
              OPD-COD-PBTI IN OPD = 'M'
                MOVE 'VPMU' TO WSS-LVP-CSVC
           ELSE
           IF OPD-COD-VCAM IN OPD = '0998  ' AND
              OPD-COD-PBTI IN OPD = 'A'
                MOVE 'VPAU' TO WSS-LVP-CSVC.
       FIN-SET-SVC.
           EXIT.
       VAL-DBC-VRF-ICLI SECTION.                                        
       INI-VAL-DBC-VRF-ICLI.                                            
           IF DBC-VRF-ICLI IN LIQ-FLD NOT > SPACES                      
              MOVE SPACES TO DBC-VRF-ICLI IN LIQ-FLD.                   
      *<<<< DBC_VRF_ICLI                                                
      *VAL-RUT Valida Rut para campo IDC                                
           MOVE IDC-ZERO-S TO IDC-ZERO.                                 
           MOVE DBC-NUM-ICLI IN LIQ-FLD TO IDC-NUM-RUTV.                
           MOVE DBC-VRF-ICLI IN LIQ-FLD TO IDC-VRF-RUTV.                
           PERFORM VAL-RUT.                                             
      *>>>>                                                             
       FIN-VAL-DBC-VRF-ICLI.                                            
           EXIT.                                                        
       VAL-DBC-IND-ICLI SECTION.                                        
       INI-VAL-DBC-IND-ICLI.                                            
           IF DBC-IND-ICLI IN LIQ-FLD NOT > SPACES                      
              MOVE SPACES TO DBC-IND-ICLI IN LIQ-FLD.                   
      *<<<< DBC_IND_ICLI                                                
      *VAL-IDC Valida identificador                                     
           MOVE DBC-IND-ICLI IN LIQ-FLD TO IDC-IND-RUTV.                
           PERFORM VAL-IDC.                                             
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN LIQ-FLD.                
      *>>>> DBC_IND_ICLI
       FIN-VAL-DBC-IND-ICLI.                                            
           EXIT.                                                        
       VAL-DBC-GLS-ICLI SECTION.                                        
       INI-VAL-DBC-GLS-ICLI.                                            
           IF DBC-GLS-ICLI IN LIQ-FLD NOT > IDC-INIC-GLS                
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN LIQ-FLD.             
      *VAL-GLS para IDC valida glosa ( extension ) de identificador     
           MOVE DBC-GLS-ICLI IN LIQ-FLD TO IDC-GLS-RUTV.                
           PERFORM VAL-GLS.                                             
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN LIQ-FLD.                
       FIN-VAL-DBC-GLS-ICLI.                                            
           EXIT.                                                        
      *>>>>
      *<<<< EOF
       PRO-ACED SECTION.
       INI-PRO-ACED.
           IF SCR-CMND = 'CRP' OR 'LRP' OR 'CVP' OR 'LVP'
               IF DCL-COD-ACED IN LIQ-FLD NOT > SPACES
                     MOVE 'DAP' TO MSG-COD-SIST
                     MOVE 'CODACEDOBL' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                                          LIQ-GLS-MENS IN LIQ-FLD
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO  EXT-PRO-ACED.

           IF SCR-CMND = 'CRP' OR 'LRP'
                MOVE 'GNS' TO TAB-COD-SIST
                MOVE 'SON' TO TAB-COD-TTAB IN TAB
                MOVE DCL-COD-ACED IN LIQ-FLD TO TAB-COD-CTAB IN TAB
                PERFORM VAL-COD.

       EXT-PRO-ACED.

           IF FRM-SUAR = FRM-SUAR-MAL
                MOVE +0  TO LIQ-COD-EJEC-LEN IN LIQ-FLD
                MOVE -1  TO DCL-COD-ACED-LEN IN LIQ-FLD
                MOVE 'S' TO FRM-UCUR.

       FIN-PRO-ACED.
           EXIT.

       SET-FRM-GLS-IPAG SECTION.
       INI-SET-FRM-GLS-IPAG.
           IF SCR-NEMO = 'DAPACTLIR' OR
              SCR-OFRM-SRV
                IF FRM-SGV-IPAG IN LIQ-FLD > ZEROES
                      MOVE WSS-FRM-GLS-IPAG-GA TO FRM-GLS-IPAG
                ELSE
                      MOVE WSS-FRM-GLS-IPAG-PE TO FRM-GLS-IPAG.
       FIN-SET-FRM-GLS-IPAG.
           EXIT.
      
       SET-MSG-PEGA SECTION.
       INI-SET-MSG-PEGA.
           IF NOT ( SCR-NEMO = 'DAPACTLIR' OR
                    SCR-OFRM-SRV )
               GO TO FIN-SET-MSG-PEGA.
      
           IF DCL-SGV-PEGA IN LIQ-FLD = ZEROES
               MOVE WSS-FRM-GLS-PEGA-VP TO FRM-GLS-PEGA
           ELSE
           IF DCL-SGV-PEGA IN LIQ-FLD > ZEROES
               MOVE WSS-FRM-GLS-PEGA-GA TO FRM-GLS-PEGA
           ELSE
               MOVE WSS-FRM-GLS-PEGA-PE TO FRM-GLS-PEGA.
       FIN-SET-MSG-PEGA.
           EXIT.
      
       FLX-FEC SECTION.
       INI-FLX-FEC.
           IF WSS-GLS-FUNGI-VHBL > SPACES
               MOVE WSS-GLS-FUNGI-VHBL TO FEC-VHBL.
           IF WSS-GLS-FUNGI-CHOY > SPACES
               MOVE WSS-GLS-FUNGI-CHOY TO FEC-VHBL.
           IF WSS-GLS-FUNGI-FBLK > SPACES
               MOVE WSS-GLS-FUNGI-FBLK TO FEC-VHBL.
       FIN-FLX-FEC.
           EXIT.
      
       OBT-CIC-PER SECTION.
       INI-OBT-CIC-PER.
      * ISP: OBTIENE CIC DE UN CODIGO DE PERIODO CARGADO EN MSC-COD-CMSC
      *      Y LO ENTREGA EN WSS-CIC-PER
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-CIC-CMSC IN MSC     TO WSS-CIC-PER.
       FIN-OBT-CIC-PER.
           EXIT.
      
       SEL-PER SECTION.
       INI-SEL-PER.
      * ISP: OBTIENE EN FEC-FECH LA SUMA DE UNA FECHA CARGADA EN FEC-FEC
      *      + UN PERIODO ( WSS-CIC-PER Y WSS-NUM-PER )
           IF WSS-CIC-PER = 'D'
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NDIA
           ELSE
           IF WSS-CIC-PER = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NMES
           ELSE
           IF WSS-CIC-PER = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NANO
      *LRH ini 16-AUG-1994
           ELSE
               GO TO FIN-SEL-PER.
      *LRH fin 16-AUG-1994
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
       FIN-SEL-PER.
           EXIT.
      
       SLA-INTE SECTION.
       INI-SLA-INTE.
           IF OPD-COD-CVTI > SPACES
                PERFORM PRO-TOD.
      
           MOVE OPD-NUM-DDEV IN OPD     TO INT-DUNO.
           MOVE OPD-NUM-MDEV IN OPD     TO INT-MUNO.
           MOVE OPD-NUM-SDEV IN OPD     TO INT-SUNO.
           MOVE OPD-NUM-ADEV IN OPD     TO INT-AUNO.
           IF WSS-IND-TOD = 'S'
               MOVE TOD-NUM-DINI TO INT-DUNO
               MOVE TOD-NUM-MINI TO INT-MUNO
               MOVE TOD-NUM-SINI TO INT-SUNO
               MOVE TOD-NUM-AINI TO INT-AUNO.
      
      
      
      
           MOVE LIQ-FEC-FREA IN LIQ-FLD TO INT-FDOS.
           MOVE OPD-COD-VCAM IN OPD     TO INT-VCAM.
      
           MOVE OPD-NUM-DREA IN OPD     TO INT-DCOL.
           MOVE OPD-NUM-MREA IN OPD     TO INT-MCOL.
           MOVE OPD-NUM-SREA IN OPD     TO INT-SCOL.
           MOVE OPD-NUM-AREA IN OPD     TO INT-ACOL.
           IF WSS-IND-TOD = 'S'
               MOVE TOD-NUM-DINI TO INT-DCOL
               MOVE TOD-NUM-MINI TO INT-MCOL
               MOVE TOD-NUM-SINI TO INT-SCOL
               MOVE TOD-NUM-AINI TO INT-ACOL.
      
      
           MOVE OPD-NUM-DREA IN OPD     TO INT-DBTV.
           MOVE OPD-NUM-MREA IN OPD     TO INT-MBTV.
           MOVE OPD-NUM-SREA IN OPD     TO INT-SBTV.
           MOVE OPD-NUM-AREA IN OPD     TO INT-ABTV.
           IF WSS-IND-TOD = 'S'
               MOVE TOD-NUM-DINI TO INT-DBTV
               MOVE TOD-NUM-MINI TO INT-MBTV
               MOVE TOD-NUM-SINI TO INT-SBTV
               MOVE TOD-NUM-AINI TO INT-ABTV.
      
           MOVE OPD-SGV-TINT IN OPD     TO INT-TINT.
           IF WSS-IND-TOD = 'S'
               ADD TOD-SGV-SPRD TO
                   TOD-SGV-TINT GIVING
                   INT-TINT.
      
           MOVE OPD-COD-TINT IN OPD     TO INT-TIPT.
      
      
           PERFORM GNS-CAL-INT.
           IF INT-CMSG > SPACES
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'DAP' TO MSG-COD-SIST
                MOVE INT-CMSG TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-SLA-INTE.
      * JVM: 22/09/92
           IF WSS-CON-INTE > 0
               MULTIPLY OPD-VAL-CAPT IN OPD BY INT-TIPE
                                      GIVING WSS-SGV-INTE
           ELSE
               MULTIPLY OPD-VAL-SCAP IN OPD BY INT-TIPE
                                      GIVING WSS-SGV-INTE.
           MOVE SCR-CIC-VCAM TO PES-CIC-VCAM.
           MOVE WSS-SGV-INTE TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-INTE.
      * JVM: 22/09/92
       FIN-SLA-INTE.
           EXIT.
      
       CAL-VF-LVP-LRP SECTION.
       INI-CAL-VF-LVP-LRP.
      
           MOVE OPD-NUM-DDEV IN OPD     TO INT-DUNO.
           MOVE OPD-NUM-MDEV IN OPD     TO INT-MUNO.
           MOVE OPD-NUM-SDEV IN OPD     TO INT-SUNO.
           MOVE OPD-NUM-ADEV IN OPD     TO INT-AUNO.
      
           MOVE LIQ-FEC-FREA IN LIQ-FLD TO INT-FDOS.
           MOVE OPD-COD-VCAM IN OPD     TO INT-VCAM.
      
           MOVE OPD-NUM-DREA IN OPD     TO INT-DCOL.
           MOVE OPD-NUM-MREA IN OPD     TO INT-MCOL.
           MOVE OPD-NUM-SREA IN OPD     TO INT-SCOL.
           MOVE OPD-NUM-AREA IN OPD     TO INT-ACOL.
      
           MOVE OPD-NUM-DREA IN OPD     TO INT-DBTV.
           MOVE OPD-NUM-MREA IN OPD     TO INT-MBTV.
           MOVE OPD-NUM-SREA IN OPD     TO INT-SBTV.
           MOVE OPD-NUM-AREA IN OPD     TO INT-ABTV.
      
           MOVE OPD-SGV-TINT IN OPD     TO INT-TINT.
      
           MOVE OPD-COD-TINT IN OPD     TO INT-TIPT.
      
           PERFORM GNS-CAL-INT.
           IF INT-CMSG > SPACES
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'DAP' TO MSG-COD-SIST
                MOVE INT-CMSG TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CAL-VF-LVP-LRP.
      
           IF WSS-VF-LVP-LRP = 'LVP'
                MULTIPLY OPD-VAL-SCAP IN OPD BY INT-TIPE
                              GIVING WSS-SGV-INTE-CVP
      
                MOVE WSS-SGV-INTE-CVP TO DCL-SGV-INTD IN LIQ-FLD
      
                ADD OPD-VAL-SCAP IN OPD TO WSS-SGV-INTE-CVP
                    GIVING WSS-SGV-FINA-CVP
           ELSE
                MULTIPLY LIQ-SGV-CAPI IN LIQ-FLD BY INT-TIPE
                              GIVING WSS-SGV-INTE-CVP
      
                MOVE WSS-SGV-INTE-CVP TO DCL-SGV-INTD IN LIQ-FLD
      
                ADD LIQ-SGV-CAPI IN LIQ-FLD TO WSS-SGV-INTE-CVP
                    GIVING WSS-SGV-FINA-CVP.
      
           MOVE SCR-CIC-VCAM TO PES-CIC-VCAM.
      
           MOVE DCL-SGV-INTD IN LIQ-FLD TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO DCL-SGV-INTD IN LIQ-FLD.
      
           MOVE WSS-SGV-FINA-CVP TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-FINA-CVP.
      
           MOVE 'FINA' TO QUE-COLA.
           MOVE WSS-SGV-FINA-CVP  TO WSS-VAL-EDIT.
           MOVE WSS-VAL-EDIT TO QUE-ITEM.
           MOVE +40 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      * JVM: 22/09/92
       FIN-CAL-VF-LVP-LRP.
           EXIT.
      
       PRO-TOD SECTION.
       INI-PRO-TOD.
           MOVE 'N' TO WSS-IND-TOD.
           MOVE SPACES TO TOD.
           MOVE OPD-CIC-IOPD IN OPD TO TOD-CIC-IOPD IN TOD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-PRO-TOD.
           PERFORM DAP-FIO-TOD.
           IF FIO-STAT-OKS AND
              OPD-CIC-IOPD IN OPD = TOD-CIC-IOPD IN TOD AND
              TOD-MSC-STAT IN TOD = 'G'
                 MOVE 'S' TO WSS-IND-TOD
                 MOVE TOD TO WSS-BKP-TOD
                 MOVE FIO-GET-NXT TO FIO-CMND
                 GO TO CIC-PRO-TOD.
      
           IF WSS-IND-TOD = 'S'
               MOVE WSS-BKP-TOD TO TOD.
      
       FIN-PRO-TOD.
           EXIT.
      
      
      
      * JVM: 22/09/92
       LIQ-INTE SECTION.
       INI-LIQ-INTE.
           MOVE OPD-NUM-DDEV IN OPD     TO INT-DUNO.
           MOVE OPD-NUM-MDEV IN OPD     TO INT-MUNO.
           MOVE OPD-NUM-SDEV IN OPD     TO INT-SUNO.
           MOVE OPD-NUM-ADEV IN OPD     TO INT-AUNO.
           MOVE OPD-NUM-DPVC IN OPD     TO INT-DDOS.
           MOVE OPD-NUM-MPVC IN OPD     TO INT-MDOS.
           MOVE OPD-NUM-SPVC IN OPD     TO INT-SDOS.
           MOVE OPD-NUM-APVC IN OPD     TO INT-ADOS.
           MOVE OPD-COD-VCAM IN OPD     TO INT-VCAM.
           MOVE OPD-NUM-DREA IN OPD     TO INT-DCOL.
           MOVE OPD-NUM-MREA IN OPD     TO INT-MCOL.
           MOVE OPD-NUM-SREA IN OPD     TO INT-SCOL.
           MOVE OPD-NUM-AREA IN OPD     TO INT-ACOL.
      
           MOVE OPD-NUM-DREA IN OPD     TO INT-DBTV.
           MOVE OPD-NUM-MREA IN OPD     TO INT-MBTV.
           MOVE OPD-NUM-SREA IN OPD     TO INT-SBTV.
           MOVE OPD-NUM-AREA IN OPD     TO INT-ABTV.
           MOVE OPD-SGV-TINT IN OPD     TO INT-TINT.
           MOVE OPD-COD-TINT IN OPD     TO INT-TIPT.
           PERFORM GNS-CAL-INT.
           IF INT-CMSG > SPACES
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'DAP' TO MSG-COD-SIST
                MOVE INT-CMSG TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-LIQ-INTE.
           MULTIPLY OPD-VAL-CAPT IN OPD BY INT-TIPE
                                        GIVING WSS-SGV-INTE.
           MOVE SCR-CIC-VCAM TO PES-CIC-VCAM.
           MOVE WSS-SGV-INTE TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-INTE.
       FIN-LIQ-INTE.
           EXIT.
      
      *>>>>
