       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      DAPPLPOD.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    19-Aug-98 06:31 PM.

      * Programa Listador de Reporte POD sin Sort.
      *
      * V 1.1.2
      *


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.

            C01 IS SALTO
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT RPTPOD       ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTPOD       ASSIGN TO        UT-S-RPTPOD.
           SELECT RPTPOD       ASSIGN TO        UT-S-RPTPOD.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       FD  RPTPOD LABEL RECORDS OMITTED
           RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-POD     PIC X(132).

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY DAPBRPOD.
       COPY DAPRRPOD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY DAPRWPOD.
       COPY DAPRNPOD.
       COPY DAPROPOD.
       COPY GNSWGSYS.
       01  PGM-HRSR-POD   VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-POD  VALUE 'S'.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
      *Entidades de GNS
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY GNSBRMSC.
      *Entidades de TAB
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRVLR.

       01  WSS-VARI.
             03  WSS-COD-OFIC                        PIC X(03).
             03  WSS-COD-COPD                        PIC X(06).
             03  WSS-COD-VCAM                        PIC X(06).
             03  WSS-COD-VIGE                        PIC X(03).
             03  WSS-NUM-NOPD        VALUE ZEROES    PIC 9(03).
             03  WSS-GLS-DEST.
               05  WSS-GLS-DES1                      PIC X(20).
               05  WSS-GLS-DES2                      PIC X(20).
      *>>>>
      *<<<< WSS_DTC
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>

      * AQUI EXISTIA LABEL RF INI
      * AQUI EXISTIA LABEL RF FIN
       COPY DAPRTPOD.

       PROCEDURE DIVISION.
      *==================

      * AQUI EXISTIA LABEL FIN_DEC INI
      * AQUI EXISTIA LABEL FIN_DEC FIN

       MAIN SECTION.
      *------------
       INI-MAIN.
      *    MOVE SYS-MXFL TO SYS-CMND.
      *    PERFORM GNS-PRO-SYS.
       COPY GNSBGEDB.
      *     MOVE 'DAP' TO RPT-SIST.
           MOVE 'DAPPLPOD' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
       INI-INP-SRT.
      *<<<< INI_INP
      * Captura Parametros
      *>>>>
      *     MOVE 'DAPPLPOD' TO RPT-NPGM.
           PERFORM CAL-HDR.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM DAP-FIO-POD.
       FST-INP-SRT.
      *<<<< INI_FST_INP
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM DAP-FIO-POD.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
       COPY DAPRMPOD.
       INI-OUT-SRT.
           OPEN OUTPUT RPTPOD.
           PERFORM INITIATE-RPTPOD.
           MOVE SRT TO SRT-OLD-POD.
           MOVE SRT TO SRT-CUR-POD.
      *    PERFORM POD-FST-PRO-CTL.
       LUP-MAIN.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
      *<<<< LUP_INP
      *>>>>
       MOV-INP-SRT.
       COPY DAPRMPOD.
       LUP-OUT-SRT.
      *<<<< LUP_OUT
      *Limpia FIO-AKEY para lectura de otros archivos
           MOVE SPACES TO FIO-AKEY.

      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-RENO IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-RENO IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-TOPD IN WSS-POD
           ELSE
              MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-RENO IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-ENDO IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-ENDO IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-ENDO IN WSS-POD
           ELSE
              MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-ENDO IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'BCT' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-BCTI IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-BCTI IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-BCTI IN WSS-POD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-BCTI IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PMIN IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PMIN IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PMIN IN WSS-POD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PMIN IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'PBT' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-PBTI IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-PBTI IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PBTI IN WSS-POD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-PBTI IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PMAX IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PMAX IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PMAX IN WSS-POD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PMAX IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'MCT' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-SPBT IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-SPBT IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-SPBT IN WSS-POD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-SPBT IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-SMNV IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-SMNV IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-SMNV IN WSS-POD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-SMNV IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-SMXV IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-SMXV IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-SMXV IN WSS-POD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-SMXV IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TPR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TFPR IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-TFPR IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-TFPR IN WSS-POD
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TFPR IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'MDR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-MORE IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-MORE IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-MORE IN WSS-POD
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-MORE IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'CDR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-RESC IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-RESC IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-RESC IN WSS-POD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-RESC IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PREP IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PREP IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PREP IN WSS-POD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PREP IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'PPR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-PLPA IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-PLPA IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PLPA IN WSS-POD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-PLPA IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PLRE IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PLRE IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PLRE IN WSS-POD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PLRE IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PNTE IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PNTE IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PNTE IN WSS-POD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PNTE IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'TCD' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TCDP IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-TCDP IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-TCDP IN WSS-POD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TCDP IN WSS-POD.
      *>>>>
           PERFORM GENERATE-DL-POD.
       NXT-INP-SRT.
       NXT-OUT-SRT.
           MOVE SRT TO SRT-OLD-POD.
       RET-OUT-SRT.
      *<<<< INI_NXT_INP
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-POD.
      *<<<< FIN_NXT_INP
      *>>>>
           GO TO LUP-MAIN.
       FIN-MAIN.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM DAP-FIO-POD.
       FIN-OUT-SRT.
           IF HAY-REGISTROS-EN-SORT-POD
                PERFORM TERMINATE-RPTPOD.
           CLOSE RPTPOD.
           IF PGM-STAT-SRT-MAL
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       COPY DAPBFPOD.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGIRH.
       COPY DAPREPOD.
      *    19-AUG-98 06:29 PM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
       D-CF-POD-POD-COD-VCAM SECTION.
       INI-CF-POD-POD-COD-VCAM.
       FIN-CF-POD-POD-COD-VCAM.
           EXIT.
       D-CF-POD-POD-COD-TOPD SECTION.
       INI-CF-POD-POD-COD-TOPD.
       FIN-CF-POD-POD-COD-TOPD.
           EXIT.
       D-CF-POD-POD-COD-AOPD SECTION.
       INI-CF-POD-POD-COD-AOPD.
       FIN-CF-POD-POD-COD-AOPD.
           EXIT.
       D-PH-POD SECTION.
       INI-PH-POD.
      *<<<< IF PH_POD
      *Recupera glosa de moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-VCAM IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCAM IN WSS-POD.

      *Recupera glosa de operacion
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TOPD IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES TO WSS-GLS-TOPD IN WSS-POD
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO
                                   WSS-GLS-TOPD IN WSS-POD.

           MOVE POD-COD-TOPD IN POD TO POD-COD-TOPD IN POD.
           MOVE POD-COD-AOPD IN POD TO POD-COD-AOPD IN POD.
           MOVE POD-COD-COPD IN POD TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES TO WSS-GLS-AOPD IN WSS-POD
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO
                                      WSS-GLS-AOPD IN WSS-POD.
      *>>>>
       FIN-PH-POD.
           EXIT.
       D-DL-POD SECTION.
       INI-DL-POD.
       FIN-DL-POD.
           EXIT.
       COPY GNSBGABT.

      *<<<< EOF
      *Entidades  de GNS
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
       COPY GNSBGCPT.

      *Entidades  de TAB
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFUSR.
       COPY TABBBUSR.
       COPY TABBVUSR.
      *>>>>
