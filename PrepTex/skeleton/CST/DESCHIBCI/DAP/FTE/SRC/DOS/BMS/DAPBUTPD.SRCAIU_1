      *
      * DAPBUTPD
      * Version 3.0.1 Nov-2005
      * 26-Jul-10 05:59 PM
      *
       SET-TAG-DAPBUTPD SECTION.
       INI-SET-TAG-DAPBUTPD.
           MOVE
           '<IDNMOD NOM=$DAPBUTPD$ VSN=$08.01.10$ VGM=$3.0.1$
      -    'GEN=$26-Jul-10 05:59 PM$ FNC=$MK2MT1$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DAPBUTPD.
           EXIT.
           
       RET-ALL-TPD SECTION.
       INI-RET-ALL-TPD.
           PERFORM KEY-ALL-TPD.
           PERFORM RET-TPD-TPD.
           PERFORM RET-DBC-TPD.
      *<<<< FIN_RET_ALL_TPD
      *>>>>
       FIN-RET-ALL-TPD.
           EXIT.
       
       RET-TPD-TPD SECTION.
       INI-RET-TPD-TPD.
       FIN-RET-TPD-TPD.
           EXIT.
       
       RET-DBC-TPD SECTION.
       INI-RET-DBC-TPD.
       FIN-RET-DBC-TPD.
           EXIT.
       
       KEY-ALL-TPD SECTION.
       INI-KEY-ALL-TPD.
           PERFORM KEY-TPD-TPD.
           PERFORM KEY-DBC-TPD.
       FIN-KEY-ALL-TPD.
           EXIT.
       
       KEY-TPD-TPD SECTION.
       INI-KEY-TPD-TPD.
           MOVE TPD-COD-VCAM IN TPD-FLD TO TPD-COD-VCAM IN TPD.
           MOVE TPD-COD-TOPD IN TPD-FLD TO TPD-COD-TOPD IN TPD.
           MOVE TPD-COD-AOPD IN TPD-FLD TO TPD-COD-AOPD IN TPD.
           MOVE TPD-NUM-IPOD IN TPD-FLD TO TPD-NUM-IPOD IN TPD.
           MOVE TPD-NUM-INEG IN TPD-FLD TO TPD-NUM-INEG IN TPD.
       FIN-KEY-TPD-TPD.
           EXIT.
       
       KEY-DBC-TPD SECTION.
       INI-KEY-DBC-TPD.
           MOVE DBC-GLS-NOMC IN TPD-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN TPD-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN TPD-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN TPD-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN TPD-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-TPD.
           EXIT.
       
       SCR-CLRA-TPD SECTION.
       INI-SCR-CLRA-TPD.
           PERFORM CLR-KEY-TPD.
           PERFORM CLR-FLD-TPD.
       FIN-SCR-CLRA-TPD.
           EXIT.
       
       CLR-KEY-TPD SECTION.
       INI-CLR-KEY-TPD.
           MOVE SPACES TO TPD-COD-VCAM IN TPD-FLD.
           MOVE SPACES TO TPD-COD-TOPD IN TPD-FLD.
           MOVE SPACES TO TPD-COD-AOPD IN TPD-FLD.
           MOVE ZEROES TO TPD-NUM-IPOD IN TPD-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN TPD-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN TPD-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN TPD-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN TPD-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN TPD-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO TPD-NUM-INEG IN TPD-FLD.
       FIN-CLR-KEY-TPD.
           EXIT.
       
       CLR-FLD-TPD SECTION.
       INI-CLR-FLD-TPD.
           MOVE SPACES TO FRM-GLS-VCAM IN TPD-FLD.
           MOVE SPACES TO FRM-GLS-TOPD IN TPD-FLD.
           MOVE SPACES TO FRM-GLS-AOPD IN TPD-FLD.
           MOVE ZEROES TO FRM-NUM-ITPD IN TPD-FLD(1).
           MOVE ZEROES TO FRM-NUM-ITPD IN TPD-FLD(2).
           MOVE ZEROES TO FRM-NUM-ITPD IN TPD-FLD(3).
           MOVE ZEROES TO FRM-NUM-ITPD IN TPD-FLD(4).
           MOVE ZEROES TO FRM-NUM-ITPD IN TPD-FLD(5).
           MOVE SPACES TO FRM-COD-BCTI IN TPD-FLD(1).
           MOVE SPACES TO FRM-COD-BCTI IN TPD-FLD(2).
           MOVE SPACES TO FRM-COD-BCTI IN TPD-FLD(3).
           MOVE SPACES TO FRM-COD-BCTI IN TPD-FLD(4).
           MOVE SPACES TO FRM-COD-BCTI IN TPD-FLD(5).
           MOVE SPACES TO FRM-COD-PBTI IN TPD-FLD(1).
           MOVE SPACES TO FRM-COD-PBTI IN TPD-FLD(2).
           MOVE SPACES TO FRM-COD-PBTI IN TPD-FLD(3).
           MOVE SPACES TO FRM-COD-PBTI IN TPD-FLD(4).
           MOVE SPACES TO FRM-COD-PBTI IN TPD-FLD(5).
           MOVE SPACES TO FRM-COD-BPBT IN TPD-FLD(1).
           MOVE SPACES TO FRM-COD-BPBT IN TPD-FLD(2).
           MOVE SPACES TO FRM-COD-BPBT IN TPD-FLD(3).
           MOVE SPACES TO FRM-COD-BPBT IN TPD-FLD(4).
           MOVE SPACES TO FRM-COD-BPBT IN TPD-FLD(5).
           MOVE SPACES TO FRM-COD-SPBT IN TPD-FLD(1).
           MOVE SPACES TO FRM-COD-SPBT IN TPD-FLD(2).
           MOVE SPACES TO FRM-COD-SPBT IN TPD-FLD(3).
           MOVE SPACES TO FRM-COD-SPBT IN TPD-FLD(4).
           MOVE SPACES TO FRM-COD-SPBT IN TPD-FLD(5).
           MOVE SPACES TO FRM-COD-CVTI IN TPD-FLD(1).
           MOVE SPACES TO FRM-COD-CVTI IN TPD-FLD(2).
           MOVE SPACES TO FRM-COD-CVTI IN TPD-FLD(3).
           MOVE SPACES TO FRM-COD-CVTI IN TPD-FLD(4).
           MOVE SPACES TO FRM-COD-CVTI IN TPD-FLD(5).
           MOVE SPACES TO FRM-GLS-CVTI IN TPD-FLD(1).
           MOVE SPACES TO FRM-GLS-CVTI IN TPD-FLD(2).
           MOVE SPACES TO FRM-GLS-CVTI IN TPD-FLD(3).
           MOVE SPACES TO FRM-GLS-CVTI IN TPD-FLD(4).
           MOVE SPACES TO FRM-GLS-CVTI IN TPD-FLD(5).
           MOVE SPACES TO FRM-COD-TFPR IN TPD-FLD(1).
           MOVE SPACES TO FRM-COD-TFPR IN TPD-FLD(2).
           MOVE SPACES TO FRM-COD-TFPR IN TPD-FLD(3).
           MOVE SPACES TO FRM-COD-TFPR IN TPD-FLD(4).
           MOVE SPACES TO FRM-COD-TFPR IN TPD-FLD(5).
           MOVE ZEROES TO FRM-NUM-PREP IN TPD-FLD(1).
           MOVE ZEROES TO FRM-NUM-PREP IN TPD-FLD(2).
           MOVE ZEROES TO FRM-NUM-PREP IN TPD-FLD(3).
           MOVE ZEROES TO FRM-NUM-PREP IN TPD-FLD(4).
           MOVE ZEROES TO FRM-NUM-PREP IN TPD-FLD(5).
           MOVE SPACES TO FRM-IND-PREP IN TPD-FLD(1).
           MOVE SPACES TO FRM-IND-PREP IN TPD-FLD(2).
           MOVE SPACES TO FRM-IND-PREP IN TPD-FLD(3).
           MOVE SPACES TO FRM-IND-PREP IN TPD-FLD(4).
           MOVE SPACES TO FRM-IND-PREP IN TPD-FLD(5).
           MOVE SPACES TO FRM-IND-OBGT IN TPD-FLD(1).
           MOVE SPACES TO FRM-IND-OBGT IN TPD-FLD(2).
           MOVE SPACES TO FRM-IND-OBGT IN TPD-FLD(3).
           MOVE SPACES TO FRM-IND-OBGT IN TPD-FLD(4).
           MOVE SPACES TO FRM-IND-OBGT IN TPD-FLD(5).
           MOVE ZEROES TO FRM-NUM-SMNV IN TPD-FLD(1).
           MOVE ZEROES TO FRM-NUM-SMNV IN TPD-FLD(2).
           MOVE ZEROES TO FRM-NUM-SMNV IN TPD-FLD(3).
           MOVE ZEROES TO FRM-NUM-SMNV IN TPD-FLD(4).
           MOVE ZEROES TO FRM-NUM-SMNV IN TPD-FLD(5).
           MOVE SPACES TO FRM-IND-SMNV IN TPD-FLD(1).
           MOVE SPACES TO FRM-IND-SMNV IN TPD-FLD(2).
           MOVE SPACES TO FRM-IND-SMNV IN TPD-FLD(3).
           MOVE SPACES TO FRM-IND-SMNV IN TPD-FLD(4).
           MOVE SPACES TO FRM-IND-SMNV IN TPD-FLD(5).
           MOVE SPACES TO FRM-COD-ITIF IN TPD-FLD(1).
           MOVE SPACES TO FRM-COD-ITIF IN TPD-FLD(2).
           MOVE SPACES TO FRM-COD-ITIF IN TPD-FLD(3).
           MOVE SPACES TO FRM-COD-ITIF IN TPD-FLD(4).
           MOVE SPACES TO FRM-COD-ITIF IN TPD-FLD(5).
           MOVE SPACES TO FRM-COD-ITIK IN TPD-FLD(1).
           MOVE SPACES TO FRM-COD-ITIK IN TPD-FLD(2).
           MOVE SPACES TO FRM-COD-ITIK IN TPD-FLD(3).
           MOVE SPACES TO FRM-COD-ITIK IN TPD-FLD(4).
           MOVE SPACES TO FRM-COD-ITIK IN TPD-FLD(5).
           MOVE SPACES TO FRM-COD-ITIC IN TPD-FLD(1).
           MOVE SPACES TO FRM-COD-ITIC IN TPD-FLD(2).
           MOVE SPACES TO FRM-COD-ITIC IN TPD-FLD(3).
           MOVE SPACES TO FRM-COD-ITIC IN TPD-FLD(4).
           MOVE SPACES TO FRM-COD-ITIC IN TPD-FLD(5).
           MOVE ZEROES TO FRM-NUM-SMXV IN TPD-FLD(1).
           MOVE ZEROES TO FRM-NUM-SMXV IN TPD-FLD(2).
           MOVE ZEROES TO FRM-NUM-SMXV IN TPD-FLD(3).
           MOVE ZEROES TO FRM-NUM-SMXV IN TPD-FLD(4).
           MOVE ZEROES TO FRM-NUM-SMXV IN TPD-FLD(5).
           MOVE SPACES TO FRM-IND-SMXV IN TPD-FLD(1).
           MOVE SPACES TO FRM-IND-SMXV IN TPD-FLD(2).
           MOVE SPACES TO FRM-IND-SMXV IN TPD-FLD(3).
           MOVE SPACES TO FRM-IND-SMXV IN TPD-FLD(4).
           MOVE SPACES TO FRM-IND-SMXV IN TPD-FLD(5).
           PERFORM CLR-TPD-TPD.
           PERFORM CLR-DBC-TPD.
       FIN-CLR-FLD-TPD.
           EXIT.
       
       CLR-TPD-TPD SECTION.
       INI-CLR-TPD-TPD.
       FIN-CLR-TPD-TPD.
           EXIT.
       
       CLR-DBC-TPD SECTION.
       INI-CLR-DBC-TPD.
       FIN-CLR-DBC-TPD.
           EXIT.
       
       FST-KEY-TPD SECTION.
       INI-FST-KEY-TPD.
           MOVE -1 TO TPD-COD-VCAM-LEN IN TPD-FLD.
       FIN-FST-KEY-TPD.
           EXIT.
       
       FST-FLD-TPD SECTION.
       INI-FST-FLD-TPD.
           MOVE -1 TO FRM-COD-BCTI-LEN IN TPD-FLD(1).
       FIN-FST-FLD-TPD.
           EXIT.
       
       PRO-KEY-TPD SECTION.
       INI-PRO-KEY-TPD.
           PERFORM PRO-MKY-TPD.
       FIN-PRO-KEY-TPD.
           EXIT.
       
       PRO-MKY-TPD SECTION.
       INI-PRO-MKY-TPD.
       FIN-PRO-MKY-TPD.
           EXIT.
       
       PRO-FLD-TPD SECTION.
       INI-PRO-FLD-TPD.
           MOVE FRM-CPIM-AEY TO FRM-COD-BCTI-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-BCTI-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-BCTI-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-BCTI-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-BCTI-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-PBTI-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-PBTI-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-PBTI-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-PBTI-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-PBTI-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-BPBT-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-BPBT-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-BPBT-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-BPBT-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-BPBT-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-SPBT-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-SPBT-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-SPBT-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-SPBT-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-SPBT-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-CVTI-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-CVTI-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-CVTI-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-CVTI-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-CVTI-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-TFPR-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-TFPR-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-TFPR-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-TFPR-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-TFPR-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-NUM-PREP-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-NUM-PREP-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-NUM-PREP-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-NUM-PREP-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-NUM-PREP-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-IND-PREP-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IND-PREP-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IND-PREP-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IND-PREP-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IND-PREP-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-IND-OBGT-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IND-OBGT-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IND-OBGT-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IND-OBGT-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IND-OBGT-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMNV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMNV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMNV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMNV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMNV-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMNV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMNV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMNV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMNV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMNV-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIF-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIF-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIF-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIF-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIF-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIK-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIK-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIK-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIK-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIK-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIC-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIC-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIC-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIC-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-ITIC-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(5).
           PERFORM PRO-TPD-TPD.
           PERFORM PRO-DBC-TPD.
       FIN-PRO-FLD-TPD.
           EXIT.
       
       PRO-TPD-TPD SECTION.
       INI-PRO-TPD-TPD.
       FIN-PRO-TPD-TPD.
           EXIT.
       
       PRO-DBC-TPD SECTION.
       INI-PRO-DBC-TPD.
       FIN-PRO-DBC-TPD.
           EXIT.
       
       UNP-KEY-TPD SECTION.
       INI-UNP-KEY-TPD.
           PERFORM UNP-IKY-TPD.
           PERFORM UNP-AKY-TPD.
           PERFORM UNP-MKY-TPD.
       FIN-UNP-KEY-TPD.
           EXIT.
       
       UNP-IKY-TPD SECTION.
       INI-UNP-IKY-TPD.
           MOVE FRM-CPIM-UBY TO TPD-COD-VCAM-ATR.
           MOVE FRM-CPIM-UBY TO TPD-COD-TOPD-ATR.
           MOVE FRM-CPIM-UBY TO TPD-COD-AOPD-ATR.
           MOVE FRM-CPIM-UBY TO TPD-NUM-IPOD-ATR.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN TPD-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN TPD-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN TPD-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN TPD-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO TPD-NUM-INEG-ATR.
      *<<<< FIN_UNP_IKY_TPD
           MOVE FRM-CPIM-AEY TO TPD-NUM-IPOD-ATR IN TPD-FLD.
           MOVE FRM-CPIM-AEY TO TPD-NUM-INEG-ATR IN TPD-FLD.
      *>>>>
       FIN-UNP-IKY-TPD.
           EXIT.
       
       UNP-MKY-TPD SECTION.
       INI-UNP-MKY-TPD.
       FIN-UNP-MKY-TPD.
           EXIT.
       
       UNP-AKY-TPD SECTION.
       INI-UNP-AKY-TPD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-TPD.
           EXIT.
       
       UNP-FLD-TPD SECTION.
       INI-UNP-FLD-TPD.
           MOVE FRM-CPIM-UBY TO FRM-COD-BCTI-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-BCTI-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-BCTI-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-BCTI-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-BCTI-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-PBTI-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-PBTI-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-PBTI-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-PBTI-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-PBTI-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-BPBT-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-BPBT-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-BPBT-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-BPBT-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-BPBT-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-SPBT-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-SPBT-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-SPBT-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-SPBT-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-SPBT-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-CVTI-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-CVTI-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-CVTI-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-CVTI-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-CVTI-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-TFPR-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-TFPR-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-TFPR-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-TFPR-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-TFPR-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-NUM-PREP-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-NUM-PREP-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-NUM-PREP-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-NUM-PREP-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-NUM-PREP-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-IND-PREP-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IND-PREP-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IND-PREP-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IND-PREP-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IND-PREP-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-IND-OBGT-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IND-OBGT-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IND-OBGT-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IND-OBGT-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IND-OBGT-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMNV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMNV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMNV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMNV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMNV-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMNV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMNV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMNV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMNV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMNV-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIF-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIF-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIF-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIF-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIF-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIK-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIK-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIK-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIK-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIK-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIC-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIC-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIC-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIC-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-ITIC-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMXV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMXV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMXV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMXV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-NUM-SMXV-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMXV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMXV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMXV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMXV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IND-SMXV-ATR IN TPD-FLD(5).
           PERFORM UNP-TPD-TPD.
           PERFORM UNP-DBC-TPD.
      *<<<< FIN_UNP_FLD_TPD 
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-NUM-SMXV-ATR IN TPD-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IND-SMXV-ATR IN TPD-FLD(5).
      *>>>> FIN_UNP_FLD_TPD 
       FIN-UNP-FLD-TPD.
           EXIT.
       
       UNP-TPD-TPD SECTION.
       INI-UNP-TPD-TPD.
       FIN-UNP-TPD-TPD.
           EXIT.
       
       UNP-DBC-TPD SECTION.
       INI-UNP-DBC-TPD.
       FIN-UNP-DBC-TPD.
           EXIT.
       
       VAL-MKY-TPD SECTION.
       INI-VAL-MKY-TPD.
       FIN-VAL-MKY-TPD.
           EXIT.
       
       VAL-FLD-TPD SECTION.
       INI-VAL-FLD-TPD.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN TPD-FLD
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-GLS-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOPD-LEN IN TPD-FLD
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-GLS-AOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOPD-LEN IN TPD-FLD
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-NUM-ITPD
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-NUM-ITPD-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-COD-BCTI
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-BCTI-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-COD-PBTI
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-PBTI-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-COD-BPBT
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-BPBT-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-COD-SPBT
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-SPBT-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-COD-CVTI
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-CVTI-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-GLS-CVTI
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-GLS-CVTI-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-COD-TFPR
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-TFPR-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-NUM-PREP
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-NUM-PREP-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-IND-PREP
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-IND-PREP-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-IND-OBGT
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-IND-OBGT-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-NUM-SMNV
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-NUM-SMNV-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-IND-SMNV
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-IND-SMNV-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-COD-ITIF
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-ITIF-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-COD-ITIK
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-ITIK-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-COD-ITIC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-ITIC-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-NUM-SMXV
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-NUM-SMXV-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
           PERFORM VAL-FRM-IND-SMXV
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-IND-SMXV-LEN IN TPD-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-TPD.
       FIN-VAL-FLD-TPD.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-FRM-GLS-TOPD SECTION.
       INI-VAL-FRM-GLS-TOPD.
       FIN-VAL-FRM-GLS-TOPD.
           EXIT.
       
       VAL-FRM-GLS-AOPD SECTION.
       INI-VAL-FRM-GLS-AOPD.
       FIN-VAL-FRM-GLS-AOPD.
           EXIT.
       
       VAL-FRM-NUM-ITPD SECTION.
       INI-VAL-FRM-NUM-ITPD.
       FIN-VAL-FRM-NUM-ITPD.
           EXIT.
       
       VAL-FRM-COD-BCTI SECTION.
       INI-VAL-FRM-COD-BCTI.
           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-BCTI IN TPD-FLD(FRM-IFLD).
      *<<<< FRM_COD_BCTI
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'BCT ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-COD-BCTI.
           EXIT.
       
       VAL-FRM-COD-PBTI SECTION.
       INI-VAL-FRM-COD-PBTI.
           IF FRM-COD-PBTI IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-PBTI IN TPD-FLD(FRM-IFLD).
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'PBT ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-PBTI IN TPD-FLD(FRM-IFLD) TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-COD-PBTI.
           EXIT.
       
       VAL-FRM-COD-BPBT SECTION.
       INI-VAL-FRM-COD-BPBT.
           IF FRM-COD-BPBT IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-BPBT IN TPD-FLD(FRM-IFLD).
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'MCT ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-BPBT IN TPD-FLD(FRM-IFLD) TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-COD-BPBT.
           EXIT.
       
       VAL-FRM-COD-SPBT SECTION.
       INI-VAL-FRM-COD-SPBT.
           IF FRM-COD-SPBT IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-SPBT IN TPD-FLD(FRM-IFLD).
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'MCT ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-SPBT IN TPD-FLD(FRM-IFLD) TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-COD-SPBT.
           EXIT.
       
       VAL-FRM-COD-CVTI SECTION.
       INI-VAL-FRM-COD-CVTI.
           IF FRM-COD-CVTI IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-CVTI IN TPD-FLD(FRM-IFLD).
       FIN-VAL-FRM-COD-CVTI.
           EXIT.
       
       VAL-FRM-GLS-CVTI SECTION.
       INI-VAL-FRM-GLS-CVTI.
       FIN-VAL-FRM-GLS-CVTI.
           EXIT.
       
       VAL-FRM-COD-TFPR SECTION.
       INI-VAL-FRM-COD-TFPR.
           IF FRM-COD-TFPR IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-TFPR IN TPD-FLD(FRM-IFLD).
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TPR ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TFPR IN TPD-FLD(FRM-IFLD) TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *<<<< FIN_FRM_COD_TFPR
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TFPR.
      *>>>> FIN_FRM_COD_TFPR
       FIN-VAL-FRM-COD-TFPR.
           EXIT.
       
       VAL-FRM-NUM-PREP SECTION.
       INI-VAL-FRM-NUM-PREP.
       FIN-VAL-FRM-NUM-PREP.
           EXIT.
       
       VAL-FRM-IND-PREP SECTION.
       INI-VAL-FRM-IND-PREP.
           IF FRM-IND-PREP IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-IND-PREP IN TPD-FLD(FRM-IFLD).
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE FRM-IND-PREP IN TPD-FLD(FRM-IFLD) TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-FRM-IND-PREP.
           EXIT.
       
       VAL-FRM-IND-OBGT SECTION.
       INI-VAL-FRM-IND-OBGT.
           IF FRM-IND-OBGT IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-IND-OBGT IN TPD-FLD(FRM-IFLD).
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'OBT ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-IND-OBGT IN TPD-FLD(FRM-IFLD) TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-IND-OBGT.
           EXIT.
       
       VAL-FRM-NUM-SMNV SECTION.
       INI-VAL-FRM-NUM-SMNV.
       FIN-VAL-FRM-NUM-SMNV.
           EXIT.
       
       VAL-FRM-IND-SMNV SECTION.
       INI-VAL-FRM-IND-SMNV.
           IF FRM-IND-SMNV IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-IND-SMNV IN TPD-FLD(FRM-IFLD).
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE FRM-IND-SMNV IN TPD-FLD(FRM-IFLD) TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-FRM-IND-SMNV.
           EXIT.
       
       VAL-FRM-COD-ITIF SECTION.
       INI-VAL-FRM-COD-ITIF.
           IF FRM-COD-ITIF IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-ITIF IN TPD-FLD(FRM-IFLD).
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'TIF ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-ITIF IN TPD-FLD(FRM-IFLD) TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-COD-ITIF.
           EXIT.
       
       VAL-FRM-COD-ITIK SECTION.
       INI-VAL-FRM-COD-ITIK.
           IF FRM-COD-ITIK IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-ITIK IN TPD-FLD(FRM-IFLD).
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'TIK ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-ITIK IN TPD-FLD(FRM-IFLD) TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-COD-ITIK.
           EXIT.
       
       VAL-FRM-COD-ITIC SECTION.
       INI-VAL-FRM-COD-ITIC.
           IF FRM-COD-ITIC IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-ITIC IN TPD-FLD(FRM-IFLD).
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'TIC ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-ITIC IN TPD-FLD(FRM-IFLD) TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-COD-ITIC.
           EXIT.
       
       VAL-FRM-NUM-SMXV SECTION.
       INI-VAL-FRM-NUM-SMXV.
       FIN-VAL-FRM-NUM-SMXV.
           EXIT.
       
       VAL-FRM-IND-SMXV SECTION.
       INI-VAL-FRM-IND-SMXV.
           IF FRM-IND-SMXV IN TPD-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-IND-SMXV IN TPD-FLD(FRM-IFLD).
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE FRM-IND-SMXV IN TPD-FLD(FRM-IFLD) TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-FRM-IND-SMXV.
           EXIT.
       
       VAL-CON-FLD-TPD SECTION.
       INI-VAL-CON-FLD-TPD.
      *<<<< VAL_CON_FLD_TPD
           PERFORM VAL-ALL-FLD VARYING FRM-IFLD FROM 1 BY 1
             UNTIL FRM-IFLD > WSS-IMAX OR
             FRM-SUAR = FRM-SUAR-MAL.

      *>>>> VAL_CON_FLD_TPD
       FIN-VAL-CON-FLD-TPD.
           EXIT.
       
       VAL-CON-TPD SECTION.
       INI-VAL-CON-TPD.
       FIN-VAL-CON-TPD.
           EXIT.
       
       VAL-NUM-KEY-TPD SECTION.
       INI-VAL-NUM-KEY-TPD.
           PERFORM VAL-NUM-IKY-TPD.
           PERFORM VAL-NUM-MKY-TPD.
           PERFORM VAL-NUM-AKY-TPD.
       FIN-VAL-NUM-KEY-TPD.
           EXIT.
       
       VAL-NUM-IKY-TPD SECTION.
       INI-VAL-NUM-IKY-TPD.
       VAL-NUM-TPD-NUM-IPOD.
           MOVE TPD-NUM-IPOD-ALF IN TPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 1 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO TPD-NUM-IPOD IN TPD-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO TPD-NUM-IPOD-LEN IN TPD-FLD
                GO TO FIN-VAL-NUM-IKY-TPD.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN TPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN TPD-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN TPD-FLD
                GO TO FIN-VAL-NUM-IKY-TPD.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-TPD-NUM-INEG.
           MOVE TPD-NUM-INEG-ALF IN TPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO TPD-NUM-INEG IN TPD-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO TPD-NUM-INEG-LEN IN TPD-FLD
                GO TO FIN-VAL-NUM-IKY-TPD.
       FIN-VAL-NUM-IKY-TPD.
           EXIT.
       
       VAL-NUM-MKY-TPD SECTION.
       INI-VAL-NUM-MKY-TPD.
       FIN-VAL-NUM-MKY-TPD.
           EXIT.
       
       VAL-NUM-AKY-TPD SECTION.
       INI-VAL-NUM-AKY-TPD.
       FIN-VAL-NUM-AKY-TPD.
           EXIT.
       
       VAL-NUM-FLD-TPD SECTION.
       INI-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-ITPD-1.
           MOVE FRM-NUM-ITPD-ALF IN TPD-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-ITPD IN TPD-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-ITPD-LEN IN TPD-FLD(1)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-ITPD-2.
           MOVE FRM-NUM-ITPD-ALF IN TPD-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-ITPD IN TPD-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-ITPD-LEN IN TPD-FLD(2)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-ITPD-3.
           MOVE FRM-NUM-ITPD-ALF IN TPD-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-ITPD IN TPD-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-ITPD-LEN IN TPD-FLD(3)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-ITPD-4.
           MOVE FRM-NUM-ITPD-ALF IN TPD-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-ITPD IN TPD-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-ITPD-LEN IN TPD-FLD(4)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-ITPD-5.
           MOVE FRM-NUM-ITPD-ALF IN TPD-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-ITPD IN TPD-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-ITPD-LEN IN TPD-FLD(5)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-PREP-1.
           MOVE FRM-NUM-PREP-ALF IN TPD-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-PREP IN TPD-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-PREP-LEN IN TPD-FLD(1)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-PREP-2.
           MOVE FRM-NUM-PREP-ALF IN TPD-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-PREP IN TPD-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-PREP-LEN IN TPD-FLD(2)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-PREP-3.
           MOVE FRM-NUM-PREP-ALF IN TPD-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-PREP IN TPD-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-PREP-LEN IN TPD-FLD(3)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-PREP-4.
           MOVE FRM-NUM-PREP-ALF IN TPD-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-PREP IN TPD-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-PREP-LEN IN TPD-FLD(4)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-PREP-5.
           MOVE FRM-NUM-PREP-ALF IN TPD-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-PREP IN TPD-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-PREP-LEN IN TPD-FLD(5)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMNV-1.
           MOVE FRM-NUM-SMNV-ALF IN TPD-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMNV IN TPD-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMNV-LEN IN TPD-FLD(1)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMNV-2.
           MOVE FRM-NUM-SMNV-ALF IN TPD-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMNV IN TPD-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMNV-LEN IN TPD-FLD(2)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMNV-3.
           MOVE FRM-NUM-SMNV-ALF IN TPD-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMNV IN TPD-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMNV-LEN IN TPD-FLD(3)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMNV-4.
           MOVE FRM-NUM-SMNV-ALF IN TPD-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMNV IN TPD-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMNV-LEN IN TPD-FLD(4)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMNV-5.
           MOVE FRM-NUM-SMNV-ALF IN TPD-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMNV IN TPD-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMNV-LEN IN TPD-FLD(5)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMXV-1.
           MOVE FRM-NUM-SMXV-ALF IN TPD-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMXV IN TPD-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMXV-LEN IN TPD-FLD(1)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMXV-2.
           MOVE FRM-NUM-SMXV-ALF IN TPD-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMXV IN TPD-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMXV-LEN IN TPD-FLD(2)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMXV-3.
           MOVE FRM-NUM-SMXV-ALF IN TPD-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMXV IN TPD-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMXV-LEN IN TPD-FLD(3)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMXV-4.
           MOVE FRM-NUM-SMXV-ALF IN TPD-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMXV IN TPD-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMXV-LEN IN TPD-FLD(4)
                GO TO FIN-VAL-NUM-FLD-TPD.
       VAL-NUM-FRM-NUM-SMXV-5.
           MOVE FRM-NUM-SMXV-ALF IN TPD-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-SMXV IN TPD-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-SMXV-LEN IN TPD-FLD(5)
                GO TO FIN-VAL-NUM-FLD-TPD.
       FIN-VAL-NUM-FLD-TPD.
           EXIT.
       
       EDT-KEY-TPD SECTION.
       INI-EDT-KEY-TPD.
           PERFORM EDT-IKY-TPD.
           PERFORM EDT-MKY-TPD.
           PERFORM EDT-AKY-TPD.
       FIN-EDT-KEY-TPD.
           EXIT.
       
       EDT-IKY-TPD SECTION.
       INI-EDT-IKY-TPD.
           IF TPD-NUM-IPOD-LEN IN TPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO TPD-NUM-IPOD-LEN IN TPD-FLD
                GO TO FIN-EDT-IKY-TPD.
           MOVE TPD-NUM-IPOD IN TPD-FLD TO TPD-NUM-IPOD-EDT IN TPD-EDT.
           MOVE TPD-NUM-IPOD-EDT IN TPD-EDT TO 
                TPD-NUM-IPOD-ALF IN TPD-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN TPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN TPD-FLD
                GO TO FIN-EDT-IKY-TPD.
           MOVE DBC-NUM-ICLI IN TPD-FLD TO
                DBC-NUM-ICLI-EDT IN TPD-EDT.
           MOVE DBC-NUM-ICLI-EDT IN TPD-EDT TO
                DBC-NUM-ICLI-ALF IN TPD-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF TPD-NUM-INEG-LEN IN TPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO TPD-NUM-INEG-LEN IN TPD-FLD
                GO TO FIN-EDT-IKY-TPD.
           MOVE TPD-NUM-INEG IN TPD-FLD TO TPD-NUM-INEG-EDT IN TPD-EDT.
           MOVE TPD-NUM-INEG-EDT IN TPD-EDT TO 
                TPD-NUM-INEG-ALF IN TPD-FLD.
       FIN-EDT-IKY-TPD.
           EXIT.
       
       EDT-MKY-TPD SECTION.
       INI-EDT-MKY-TPD.
       FIN-EDT-MKY-TPD.
           EXIT.
       
       EDT-AKY-TPD SECTION.
       INI-EDT-AKY-TPD.
       FIN-EDT-AKY-TPD.
           EXIT.
       
       EDT-FLD-TPD SECTION.
       INI-EDT-FLD-TPD.
           IF FRM-NUM-ITPD-LEN IN TPD-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITPD-LEN IN TPD-FLD(1)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-ITPD IN TPD-FLD(1) TO 
                FRM-NUM-ITPD-EDT IN TPD-EDT.
           MOVE FRM-NUM-ITPD-EDT IN TPD-EDT TO 
                FRM-NUM-ITPD-ALF IN TPD-FLD(1).
           IF FRM-NUM-ITPD-LEN IN TPD-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITPD-LEN IN TPD-FLD(2)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-ITPD IN TPD-FLD(2) TO 
                FRM-NUM-ITPD-EDT IN TPD-EDT.
           MOVE FRM-NUM-ITPD-EDT IN TPD-EDT TO 
                FRM-NUM-ITPD-ALF IN TPD-FLD(2).
           IF FRM-NUM-ITPD-LEN IN TPD-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITPD-LEN IN TPD-FLD(3)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-ITPD IN TPD-FLD(3) TO 
                FRM-NUM-ITPD-EDT IN TPD-EDT.
           MOVE FRM-NUM-ITPD-EDT IN TPD-EDT TO 
                FRM-NUM-ITPD-ALF IN TPD-FLD(3).
           IF FRM-NUM-ITPD-LEN IN TPD-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITPD-LEN IN TPD-FLD(4)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-ITPD IN TPD-FLD(4) TO 
                FRM-NUM-ITPD-EDT IN TPD-EDT.
           MOVE FRM-NUM-ITPD-EDT IN TPD-EDT TO 
                FRM-NUM-ITPD-ALF IN TPD-FLD(4).
           IF FRM-NUM-ITPD-LEN IN TPD-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITPD-LEN IN TPD-FLD(5)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-ITPD IN TPD-FLD(5) TO 
                FRM-NUM-ITPD-EDT IN TPD-EDT.
           MOVE FRM-NUM-ITPD-EDT IN TPD-EDT TO 
                FRM-NUM-ITPD-ALF IN TPD-FLD(5).
           IF FRM-NUM-PREP-LEN IN TPD-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-PREP-LEN IN TPD-FLD(1)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-PREP IN TPD-FLD(1) TO 
                FRM-NUM-PREP-EDT IN TPD-EDT.
           MOVE FRM-NUM-PREP-EDT IN TPD-EDT TO 
                FRM-NUM-PREP-ALF IN TPD-FLD(1).
           IF FRM-NUM-PREP-LEN IN TPD-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-PREP-LEN IN TPD-FLD(2)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-PREP IN TPD-FLD(2) TO 
                FRM-NUM-PREP-EDT IN TPD-EDT.
           MOVE FRM-NUM-PREP-EDT IN TPD-EDT TO 
                FRM-NUM-PREP-ALF IN TPD-FLD(2).
           IF FRM-NUM-PREP-LEN IN TPD-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-PREP-LEN IN TPD-FLD(3)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-PREP IN TPD-FLD(3) TO 
                FRM-NUM-PREP-EDT IN TPD-EDT.
           MOVE FRM-NUM-PREP-EDT IN TPD-EDT TO 
                FRM-NUM-PREP-ALF IN TPD-FLD(3).
           IF FRM-NUM-PREP-LEN IN TPD-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-PREP-LEN IN TPD-FLD(4)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-PREP IN TPD-FLD(4) TO 
                FRM-NUM-PREP-EDT IN TPD-EDT.
           MOVE FRM-NUM-PREP-EDT IN TPD-EDT TO 
                FRM-NUM-PREP-ALF IN TPD-FLD(4).
           IF FRM-NUM-PREP-LEN IN TPD-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-PREP-LEN IN TPD-FLD(5)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-PREP IN TPD-FLD(5) TO 
                FRM-NUM-PREP-EDT IN TPD-EDT.
           MOVE FRM-NUM-PREP-EDT IN TPD-EDT TO 
                FRM-NUM-PREP-ALF IN TPD-FLD(5).
           IF FRM-NUM-SMNV-LEN IN TPD-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMNV-LEN IN TPD-FLD(1)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMNV IN TPD-FLD(1) TO 
                FRM-NUM-SMNV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMNV-EDT IN TPD-EDT TO 
                FRM-NUM-SMNV-ALF IN TPD-FLD(1).
           IF FRM-NUM-SMNV-LEN IN TPD-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMNV-LEN IN TPD-FLD(2)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMNV IN TPD-FLD(2) TO 
                FRM-NUM-SMNV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMNV-EDT IN TPD-EDT TO 
                FRM-NUM-SMNV-ALF IN TPD-FLD(2).
           IF FRM-NUM-SMNV-LEN IN TPD-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMNV-LEN IN TPD-FLD(3)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMNV IN TPD-FLD(3) TO 
                FRM-NUM-SMNV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMNV-EDT IN TPD-EDT TO 
                FRM-NUM-SMNV-ALF IN TPD-FLD(3).
           IF FRM-NUM-SMNV-LEN IN TPD-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMNV-LEN IN TPD-FLD(4)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMNV IN TPD-FLD(4) TO 
                FRM-NUM-SMNV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMNV-EDT IN TPD-EDT TO 
                FRM-NUM-SMNV-ALF IN TPD-FLD(4).
           IF FRM-NUM-SMNV-LEN IN TPD-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMNV-LEN IN TPD-FLD(5)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMNV IN TPD-FLD(5) TO 
                FRM-NUM-SMNV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMNV-EDT IN TPD-EDT TO 
                FRM-NUM-SMNV-ALF IN TPD-FLD(5).
           IF FRM-NUM-SMXV-LEN IN TPD-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMXV-LEN IN TPD-FLD(1)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMXV IN TPD-FLD(1) TO 
                FRM-NUM-SMXV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMXV-EDT IN TPD-EDT TO 
                FRM-NUM-SMXV-ALF IN TPD-FLD(1).
           IF FRM-NUM-SMXV-LEN IN TPD-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMXV-LEN IN TPD-FLD(2)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMXV IN TPD-FLD(2) TO 
                FRM-NUM-SMXV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMXV-EDT IN TPD-EDT TO 
                FRM-NUM-SMXV-ALF IN TPD-FLD(2).
           IF FRM-NUM-SMXV-LEN IN TPD-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMXV-LEN IN TPD-FLD(3)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMXV IN TPD-FLD(3) TO 
                FRM-NUM-SMXV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMXV-EDT IN TPD-EDT TO 
                FRM-NUM-SMXV-ALF IN TPD-FLD(3).
           IF FRM-NUM-SMXV-LEN IN TPD-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMXV-LEN IN TPD-FLD(4)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMXV IN TPD-FLD(4) TO 
                FRM-NUM-SMXV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMXV-EDT IN TPD-EDT TO 
                FRM-NUM-SMXV-ALF IN TPD-FLD(4).
           IF FRM-NUM-SMXV-LEN IN TPD-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-SMXV-LEN IN TPD-FLD(5)
                GO TO FIN-EDT-FLD-TPD.
           MOVE FRM-NUM-SMXV IN TPD-FLD(5) TO 
                FRM-NUM-SMXV-EDT IN TPD-EDT.
           MOVE FRM-NUM-SMXV-EDT IN TPD-EDT TO 
                FRM-NUM-SMXV-ALF IN TPD-FLD(5).
       FIN-EDT-FLD-TPD.
           EXIT.
      *<<<< EOF_BU

       VAL-ALL-FLD SECTION.
       INI-VAL-ALL-FLD.
      * el discriminante para cada linea es el primer campo
      * de la tasa "V"mss. Si este campo esta prendido
      * asigna correlativo, caso contario ==> cero
           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES
                MOVE FRM-IFLD TO FRM-NUM-ITPD IN TPD-FLD(FRM-IFLD)
           ELSE
                MOVE ZEROES TO FRM-NUM-ITPD IN TPD-FLD(FRM-IFLD).

      * si el discriminante de la linea n esta lleno
      * el discriminate de la linea n-1 no puede estar vacia
           IF FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING FRM-IFLD-M1
               IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES AND
                  FRM-COD-BCTI IN TPD-FLD(FRM-IFLD-M1) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'FRMIFLDM1BL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-BCTI-LEN IN TPD-FLD(FRM-IFLD-M1)
                   GO TO FIN-VAL-ALL-FLD.

      * si en linea n tipo tasa existe
      * periodo tasa obligatorio
           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-PBTI IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDCODPBTIBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-PBTI-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

      * si en linea n tipo tasa existe
      * sobreperiodo obligatorio
           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-SPBT IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDCODSPBTBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-SPBT-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

      * si en linea n tipo tasa existe
      * bajoperiodo obligatorio
           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-BPBT IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDCODBPBTBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-BPBT-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

      * Asume Plazo maximo de cambio cantidad
      *        Plazo minimo de cambio cantidad
           MOVE  FRM-NUM-SMNV IN TPD-FLD(FRM-IFLD) TO
                 FRM-NUM-SMXV IN TPD-FLD (FRM-IFLD).

      * Asume Plazo maximo de cambio cantidad
      *        Plazo minimo de cambio cantidad
           MOVE  FRM-IND-SMNV IN TPD-FLD(FRM-IFLD) TO
                 FRM-IND-SMXV IN TPD-FLD (FRM-IFLD).

      * Para primera linea periodo minmo de sepracion
      *        no debe estar vacio
           IF FRM-IFLD = 1
                IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES
                     IF FRM-NUM-SMNV(FRM-IFLD) > ZEROES
                          MOVE 'DAP' TO MSG-COD-SIST
                          MOVE 'NUMSMNVVAC' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                          MOVE FRM-SUAR-MAL TO FRM-SUAR
                          MOVE 'S' TO FRM-UCUR
                          MOVE FRM-POS-CURS TO
                               FRM-NUM-SMNV-LEN IN TPD-FLD(FRM-IFLD)
                          GO TO FIN-VAL-ALL-FLD
                     ELSE
                     IF FRM-IND-SMNV(FRM-IFLD) > SPACES
                          MOVE 'DAP' TO MSG-COD-SIST
                          MOVE 'INDSMNVVAC' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                          MOVE FRM-SUAR-MAL TO FRM-SUAR
                          MOVE 'S' TO FRM-UCUR
                          MOVE FRM-POS-CURS TO
                               FRM-IND-SMNV-LEN IN TPD-FLD(FRM-IFLD)
                          GO TO FIN-VAL-ALL-FLD
                     ELSE
                     IF FRM-NUM-SMXV(FRM-IFLD) > ZEROES
                          MOVE 'DAP' TO MSG-COD-SIST
                          MOVE 'NUMSMXVVAC' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                          MOVE FRM-SUAR-MAL TO FRM-SUAR
                          MOVE 'S' TO FRM-UCUR
                          MOVE FRM-POS-CURS TO
                               FRM-NUM-SMXV-LEN IN TPD-FLD(FRM-IFLD)
                          GO TO FIN-VAL-ALL-FLD
                     ELSE
                     IF FRM-IND-SMXV(FRM-IFLD) > SPACES
                          MOVE 'DAP' TO MSG-COD-SIST
                          MOVE 'INDSMXVVAC' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                          MOVE FRM-SUAR-MAL TO FRM-SUAR
                          MOVE 'S' TO FRM-UCUR
                          MOVE FRM-POS-CURS TO
                               FRM-IND-SMXV-LEN IN TPD-FLD(FRM-IFLD)
                          GO TO FIN-VAL-ALL-FLD.

           IF FRM-IFLD > 1
                IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES
                     IF FRM-NUM-SMNV(FRM-IFLD) NOT > ZEROES
                          MOVE 'DAP' TO MSG-COD-SIST
                          MOVE 'NUMSMNVOBL' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                          MOVE FRM-SUAR-MAL TO FRM-SUAR
                          MOVE 'S' TO FRM-UCUR
                          MOVE FRM-POS-CURS TO
                               FRM-NUM-SMNV-LEN IN TPD-FLD(FRM-IFLD)
                          GO TO FIN-VAL-ALL-FLD
                     ELSE
                     IF FRM-IND-SMNV(FRM-IFLD) NOT > SPACES
                          MOVE 'DAP' TO MSG-COD-SIST
                          MOVE 'INDSMNVOBL' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                          MOVE FRM-SUAR-MAL TO FRM-SUAR
                          MOVE 'S' TO FRM-UCUR
                          MOVE FRM-POS-CURS TO
                               FRM-IND-SMNV-LEN IN TPD-FLD(FRM-IFLD)
                          GO TO FIN-VAL-ALL-FLD
                     ELSE
                     IF FRM-NUM-SMXV(FRM-IFLD) NOT > ZEROES
                          MOVE 'DAP' TO MSG-COD-SIST
                          MOVE 'NUMSMXVOBL' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                          MOVE FRM-SUAR-MAL TO FRM-SUAR
                          MOVE 'S' TO FRM-UCUR
                          MOVE FRM-POS-CURS TO
                               FRM-NUM-SMXV-LEN IN TPD-FLD(FRM-IFLD)
                          GO TO FIN-VAL-ALL-FLD
                     ELSE
                     IF FRM-IND-SMXV(FRM-IFLD) NOT > SPACES
                          MOVE 'DAP' TO MSG-COD-SIST
                          MOVE 'INDSMXVOBL' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                          MOVE FRM-SUAR-MAL TO FRM-SUAR
                          MOVE 'S' TO FRM-UCUR
                          MOVE FRM-POS-CURS TO
                               FRM-IND-SMXV-LEN IN TPD-FLD(FRM-IFLD)
                          GO TO FIN-VAL-ALL-FLD.
      **** ---

      *     IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES
      *         IF FRM-NUM-SMNV(FRM-IFLD) NOT =
      *            FRM-NUM-SMXV(FRM-IFLD)
      *              MOVE 'DAP' TO MSG-COD-SIST
      *              MOVE 'TPDNUMSMNVNE' TO MSG-COD-MENS
      *              PERFORM GET-MSG
      *              MOVE MSG-GLS-DESC TO FRM-MENS
      *              MOVE FRM-SUAR-MAL TO FRM-SUAR
      *              MOVE 'S' TO FRM-UCUR
      *              MOVE FRM-POS-CURS TO
      *                   FRM-NUM-SMNV-LEN IN TPD-FLD(FRM-IFLD)
      *              GO TO FIN-VAL-ALL-FLD.

      *     IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES
      *         IF FRM-IND-SMNV(FRM-IFLD) NOT =
      *            FRM-IND-SMXV(FRM-IFLD)
      *              MOVE 'DAP' TO MSG-COD-SIST
      *              MOVE 'TPDINDSMNVNE' TO MSG-COD-MENS
      *              PERFORM GET-MSG
      *              MOVE MSG-GLS-DESC TO FRM-MENS
      *              MOVE FRM-SUAR-MAL TO FRM-SUAR
      *              MOVE 'S' TO FRM-UCUR
      *              MOVE FRM-POS-CURS TO
      *                   FRM-IND-SMNV-LEN IN TPD-FLD(FRM-IFLD)
      *              GO TO FIN-VAL-ALL-FLD.

      *>>>> FRM-COD-CVTI

           IF FRM-COD-CVTI IN TPD-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-CVTI IN TPD-FLD(FRM-IFLD)
           ELSE
               MOVE 'I'                     TO
                    WSS-GLS-CVTI IN WSS-VARI

               MOVE FRM-COD-CVTI IN TPD-FLD(FRM-IFLD) TO
                    WSS-COD-CVTI IN WSS-VARI

               MOVE FRM-COD-PBTI IN TPD-FLD(FRM-IFLD) TO
                    WSS-COD-PBTI IN WSS-VARI

               MOVE WSS-CVTI IN WSS-VARI    TO TAB-COD-CTAB IN TAB
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = 'COD    NEX'
      *        CVTI inexistente
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'CVTI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-CVTI-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO
                        FRM-GLS-CVTI IN TPD-FLD(FRM-IFLD).

           IF FRM-COD-CVTI IN TPD-FLD(FRM-IFLD) > SPACES
               IF FRM-COD-TFPR IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDCODTFPRBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-TFPR-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF FRM-COD-CVTI IN TPD-FLD(FRM-IFLD) = SPACES
               IF FRM-COD-TFPR IN TPD-FLD(FRM-IFLD) > SPACES       
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'CODTFPRBLK' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-TFPR-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.


      *>>>> WSS-CIC-TFPR

           PERFORM VAL-FRM-COD-TFPR.

           IF FRM-COD-TFPR IN TPD-FLD(FRM-IFLD) > SPACES
               IF FRM-COD-CVTI IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'CODCVTIBLK' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-CVTI-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF WSS-CIC-TFPR = 'C'
               IF FRM-NUM-PREP IN TPD-FLD(FRM-IFLD) = ZEROES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'NUMPREPNO0' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-NUM-PREP-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF WSS-CIC-TFPR = 'C'
               IF FRM-IND-PREP IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDINDPREPBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-IND-PREP-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF WSS-CIC-TFPR = 'F'
               IF FRM-NUM-PREP IN TPD-FLD(FRM-IFLD) NOT = ZEROES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDNUMPREPZE' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-NUM-PREP-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF WSS-CIC-TFPR = 'F'
               IF FRM-IND-PREP IN TPD-FLD(FRM-IFLD) NOT = SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDINDPREPNB' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-IND-PREP-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF WSS-CIC-TFPR = ' '
               IF FRM-NUM-PREP IN TPD-FLD(FRM-IFLD) NOT = ZEROES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDNUMPREPN0' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-NUM-PREP-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF WSS-CIC-TFPR = ' '
               IF FRM-IND-PREP IN TPD-FLD(FRM-IFLD) NOT = SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDINDPREPNB' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-IND-PREP-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES
               MOVE 'TAB' TO TAB-COD-SIST

               MOVE 'INT' TO TAB-COD-TTAB IN TAB

               MOVE FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) TO
                WSS-INT-COD-BCTI IN WSS-VARI

               MOVE FRM-COD-PBTI IN TPD-FLD(FRM-IFLD) TO
                WSS-INT-COD-PBTI IN WSS-VARI

               MOVE FRM-COD-BPBT  IN TPD-FLD(FRM-IFLD) TO
                WSS-INT-COD-BPBT IN WSS-VARI

               MOVE FRM-COD-SPBT IN TPD-FLD(FRM-IFLD) TO
                WSS-INT-COD-SPBT IN WSS-VARI

               MOVE FRM-COD-CVTI IN TPD-FLD(FRM-IFLD) TO 
                WSS-INT-COD-CVTI IN WSS-VARI

               MOVE FRM-COD-TFPR IN TPD-FLD(FRM-IFLD) TO
                WSS-INT-COD-TFPR IN WSS-VARI

               MOVE FRM-NUM-PREP IN TPD-FLD(FRM-IFLD) TO
                WSS-INT-NUM-PREP IN WSS-VARI

               MOVE FRM-IND-PREP IN TPD-FLD(FRM-IFLD) TO
                WSS-INT-IND-PREP IN WSS-VARI

               MOVE WSS-INTE  IN WSS-VARI    TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD.
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TINT   NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-PBTI-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD
               ELSE
               IF MSG-COD-MENS = 'COD    NVG'
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TINT   NVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-PBTI-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES AND
              FRM-IND-OBGT IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDINDOBGTBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-IND-OBGT-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-ITIF IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDCODITIFBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-ITIF-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-ITIK IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDCODITIKBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-ITIK-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-ITIC IN TPD-FLD(FRM-IFLD) NOT > SPACES
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TPDCODITICBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-POS-CURS TO
                        FRM-COD-ITIC-LEN IN TPD-FLD(FRM-IFLD)
                   GO TO FIN-VAL-ALL-FLD.

           IF FRM-IFLD > 2 AND
              FRM-COD-BCTI IN TPD-FLD(FRM-IFLD) > SPACES
               PERFORM VAL-SEC-FEC
               IF FRM-SUAR = FRM-SUAR-MAL
                    GO TO FIN-VAL-ALL-FLD
               ELSE
                    PERFORM VAL-FEC-POD
                    IF FRM-SUAR = FRM-SUAR-MAL
                         GO TO FIN-VAL-ALL-FLD.

       FIN-VAL-ALL-FLD.
           EXIT.

       VAL-SEC-FEC SECTION.
       INI-VAL-SEC-FEC.
           MOVE '01012008' TO FEC-FECH.
           IF FRM-IND-SMNV IN TPD-FLD(FRM-IFLD-M1) = 'D'
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE FRM-NUM-SMNV IN TPD-FLD (FRM-IFLD-M1) TO FEC-NDIA
           ELSE
           IF FRM-IND-SMNV IN TPD-FLD(FRM-IFLD) = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE FRM-NUM-SMNV IN TPD-FLD (FRM-IFLD-M1) TO FEC-NMES
           ELSE
           IF FRM-IND-SMNV IN TPD-FLD(FRM-IFLD) = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE FRM-NUM-SMNV IN TPD-FLD (FRM-IFLD-M1) TO FEC-NANO.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DUNO.
           MOVE FEC-ITM2 TO WSS-NUM-MUNO.
           MOVE FEC-ITM3 TO WSS-NUM-SUNO.
           MOVE FEC-ITM4 TO WSS-NUM-AUNO.

           MOVE '01012008' TO FEC-FECH.
           IF FRM-IND-SMXV IN TPD-FLD(FRM-IFLD) = 'D'
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE FRM-NUM-SMXV IN TPD-FLD (FRM-IFLD) TO FEC-NDIA
           ELSE
           IF FRM-IND-SMXV IN TPD-FLD(FRM-IFLD) = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE FRM-NUM-SMXV IN TPD-FLD (FRM-IFLD) TO FEC-NMES
           ELSE
           IF FRM-IND-SMXV IN TPD-FLD(FRM-IFLD) = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE FRM-NUM-SMXV IN TPD-FLD (FRM-IFLD) TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DDOS.
           MOVE FEC-ITM2 TO WSS-NUM-MDOS.
           MOVE FEC-ITM3 TO WSS-NUM-SDOS.
           MOVE FEC-ITM4 TO WSS-NUM-ADOS.

           IF WSS-FEC-FUNO NOT < WSS-FEC-FDOS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'FECNV>FECXV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE FRM-POS-CURS TO
               FRM-NUM-SMNV-LEN IN TPD-FLD(FRM-IFLD).

       FIN-VAL-SEC-FEC.
           EXIT.

       VAL-FEC-POD SECTION.
       INI-VAL-FEC-POD.
           MOVE '01012008' TO FEC-FECH.
           MOVE TPD-COD-VCAM IN TPD-FLD TO POD-COD-VCAM IN POD.
           MOVE TPD-COD-TOPD IN TPD-FLD TO POD-COD-TOPD IN POD.
           MOVE TPD-COD-AOPD IN TPD-FLD TO POD-COD-AOPD IN POD.
           MOVE ZEROES                  TO POD-NUM-IPOD IN POD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-POD.
           IF NOT FIO-STAT-OKS
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'POD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-FEC-POD.

           IF POD-IND-PMAX IN POD = 'D'
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE POD-NUM-PMAX IN POD TO FEC-NDIA
           ELSE
           IF POD-IND-PMAX IN POD = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE POD-NUM-PMAX IN POD TO FEC-NMES
           ELSE
           IF POD-IND-PMAX IN POD = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE POD-NUM-PMAX IN POD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DUNO.
           MOVE FEC-ITM2 TO WSS-NUM-MUNO.
           MOVE FEC-ITM3 TO WSS-NUM-SUNO.
           MOVE FEC-ITM4 TO WSS-NUM-AUNO.

           IF WSS-FEC-FUNO NOT < WSS-FEC-FDOS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'FECXV>MXPOD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE FRM-POS-CURS TO
               FRM-NUM-SMXV-LEN IN TPD-FLD(FRM-IFLD).

       FIN-VAL-FEC-POD.
           EXIT.


      *>>>> EOF_BU
      *<<<< EOF
       VAL-ICLI SECTION.
       INI-VAL-ICLI.

           IF DBC-NUM-ICLI IN TPD-FLD NOT > ZEROES
               MOVE SPACES TO DBC-GLS-NOMC IN DBC
               GO TO FIN-VAL-ICLI.

           MOVE IDC-ZERO-N TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN TPD-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN TPD-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-VAL-ICLI.

           PERFORM LEE-CLI.
           IF NOT FIO-STAT-OKS
               GO TO ERR-VAL-ICLI.

           PERFORM SET-DBC-TPD.
           GO TO FIN-VAL-ICLI.

       ERR-VAL-ICLI.
           MOVE 'DAP' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-ICLI.
           EXIT.

       SET-DBC-TPD SECTION.
       INI-SET-DBC-TPD.
      *<<<< INI_PUT_DBC_TPD

           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *>>>>
           IF PGM-STAT-DBC-NUL
               GO TO FIN-SET-DBC-TPD.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-TPD
               GO TO FIN-SET-DBC-TPD.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN TPD-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN TPD-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN TPD-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN TPD-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN TPD-FLD.
       FIN-SET-DBC-TPD.
           EXIT.

      *>>>> EOF
