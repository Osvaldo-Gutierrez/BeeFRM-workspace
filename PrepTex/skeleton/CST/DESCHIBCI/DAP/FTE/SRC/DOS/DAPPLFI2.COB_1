000000 IDENTIFICATION DIVISION.
000000 PROGRAM-ID. DAPPLFI2.
000000 AUTHOR. CECILIA PIZARRO.
000000 DATE-WRITTEN.
000000 DATE-COMPILED.
000000*REMARKS. BANCO DE CREDITO E INVERSIONES
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 30 DE MARZO DE 1998                                    *
      ******************************************************************
000000*         * SISTEMA DE DEPOSITOS A PLAZO INFORME FINANZAS *
000000******************************************************************
000000*    *  INFORME DE VENCIMIENTOS DE MONTO > = TOPE DADO EN        *
000000*    *  TARJETA PARAMETRO.EN UN RANGO DE FECHAS DADO             *
000000*    *  CON CORTE DE CONTROL POR OFICINAS DISTINTA A OFICINA     *
000000*    *  CENTRAL Y ESTA.                                          *
000000*    *  EXISTE LA OPCION DE SACAR EL LISTADO PARA TODO EL BANCO  *
000000*    *  O SOLO PARA OFICINA CENTRAL.                             *
000000*                                                                *
000000*    ARCHIVOS                                                    *
000000*      ENTRADA:  DAPDOPD ARCHIVO IMAGEN DE TABLA OPD + VEN (SAM) *
000000*                TABLA DBC                                       *
000000*                TABLA RCC                                       *
000000*                TABLA OFI                                       *
000000*                                                                *
000000*      SALIDA :  LISTADO DE VENCIMIENTOS                         *
000000*                                                                *
000000*      OTROS  :  ARCHIVO SORT.                                   *
000000*                                                                *
000000******************************************************************
000000*                       MANTENCIONES                             *
000000******************************************************************
000000* 24-05-93  JORGE FERRADA G.                                     *
000000*         SE MODIFICA A OBJETO DE QUE EMITA LISTADO PARA TODAS   *
000000*         LAS MONEDAS. SE DEBERA INGRESAR EL  MONTO TOPE  PARA   *
000000*         PESOS, UF Y DOLARES POR SEPARADO. EL  SORT  ORDENARA   *
000000*         EN PRIMER LUGAR POR MONEDA Y LUEGO POR EL  RESTO  DE   *
000000*         LOS CONCEPTOS.                                         *
000000******************************************************************
000000* 22-06-93  JORGE FERRADA G.                                     *
000000*         SE EMITE UN RESUMEN DE INFORME DE VENCIMIENTOS SOLICI- *
000000*         TADO POR FINANZAS.                                     *
000000*         ESTE RESUMEN SE IMPRIME A  CONTINUACION  DEL  REPORTE  *
000000*         NORMAL, SIENDO UN COMPENDIO DE LOS  TOTALES  IMPRESOS  *
000000*         PREVIAMENTE. EN ESTE CASO ESTA SEPARADO POR FECHA.     *
000000******************************************************************
000000* 30-06-93  JORGE FERRADA G.                                     *
000000*         SE AMPLIA ARREGLO PARA EMITIR RESUMEN A OBJETO QUE SE  *
000000*         PUEDAN PROCESAR HASTA DOS MESES.                       *
000000******************************************************************
000000*
000000* MANTENCION:  P CONCHA L   18/08/94
000000* - SE REEMPLAZA RECORRIDO DE TABLA VEN Y OPD    POR EL ACCESO AL
000000*   ARCHIVO DAPDOPD (IMAGEN DE TABLA OPD + VEN DEPURADO) EN SAM.
000000*
000000******************************************************************
000000*
000000* MANTENCION:  P CONCHA L   20/06/95
000000* - SE AMPLIAN CAMPOS DE IMPRESION DE VALORES
000000* - SE REDUCEN LOS ACCESOS A BASES DE DATOS (RCC Y DBC),
000000*   BUSCANDO LA INFORMACION DE CLIENTES SOLO CUANDO SE LISTARA
000000*   EL DETALLE. A LAS OPERACIONES QUE NO SE LISTAN, SOLO SE
000000*   ACUMULAN, NO SE LES EXTRAE LE INFORMACION DE CLIENTE.
000000*   ESTO IMPLICA UNA REDUCCION DEL TIEMPO DE PROCESO.
000000*
000000******************************************************************
000000     EJECT
000000 ENVIRONMENT DIVISION.
000000 CONFIGURATION SECTION.
000000 SOURCE-COMPUTER. IBM-370-4341.
000000 OBJECT-COMPUTER. IBM-370-4341.
000000 SPECIAL-NAMES.
000000     C01 IS CANAL-1
000000     DECIMAL-POINT IS COMMA.
000000 INPUT-OUTPUT SECTION.
000000 FILE-CONTROL.
000000     SELECT DAPDOPD  ASSIGN UT-S-DAPDOPD.
000000     SELECT LISTADO  ASSIGN UT-S-LISTADO.
000000     SELECT FSORT    ASSIGN UT-S-SORTWK01.
000000     EJECT
000000*
000000 DATA DIVISION.
000000 FILE SECTION.
000000*
000000 FD  DAPDOPD
000000     RECORDING MODE IS F
000000     LABEL RECORD STANDARD
000000     BLOCK CONTAINS    0 RECORDS.
000000 01  REG-DAPDOPD.
000000*    COPYDD DAP-R-OPD.DAP-E-OPD00(PROD),02,D
      *                             EQUIVALENTE AL REGISTRO OPD
           02  DAP-E-OPD00.
      *                             OPERACION DEPOSITO A PLAZO
               04  OPD.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   06  OPD-GLS-FLAG PICTURE X(1).
      *                             IDENTIFICACION OPERACION DAP
                   06  OPD-KEY-IOPD.
      *                             COD. INT. COMP. OPERACION DAP
                       08  OPD-CIC-IOPD.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       10  OPD-CAI-IOPD
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       10  OPD-IIC-IOPD
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                   06  OPD-STP-ITRN.
      *                             FECHA TRANSACCION
                       08  OPD-FEC-FTRN
                                    PICTURE 9(8).
      *                             HORA TRANSACCION
                       08  OPD-HRA-HRTR
                                    PICTURE 9(6).
      *                             INDICADOR TIPO ACCION
                   06  OPD-COD-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   06  OPD-COD-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   06  OPD-COD-OTRN PICTURE X(4).
      *                             AUTOR TRANSACCION
                   06  OPD-COD-ATRN PICTURE X(12).
      *                             VALOR DE CAMBIO OPERACION DAP
                   06  OPD-COD-VCAM.
      *                             MISCELANEO TIPO VALOR
                       08  OPD-MSC-TVAL
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       08  OPD-COD-CVAL
                                    PICTURE X(3).
      *                             CODIGO TIPO CAMBIO
                       08  OPD-COD-TCAM
                                    PICTURE X(2).
      *                             CODIGO CLASE OPERACION DAP
                   06  OPD-COD-COPD.
      *                             CODIGO TIPO OPERACION
                       08  OPD-COD-TOPD
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       08  OPD-COD-AOPD
                                    PICTURE X(3).
      *                             CODIGO OFICINA OPERACION DAP
                   06  OPD-COD-OFIC PICTURE X(3).
      *                             RESPONSABLE MANTENCION OPERACION DAP
                   06  OPD-COD-EJEC PICTURE X(12).
      *                             COD. INT. COMP. SERIAL CDP
                   06  OPD-CIC-ISER.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  OPD-CAI-ISER
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  OPD-IIC-ISER
                                    PICTURE X(8).
      *                             FECHA CAPTACION REAL
                   06  OPD-FEC-FREA.
                       08  OPD-NUM-SREA
                                    PICTURE 9(2).
                       08  OPD-NUM-AREA
                                    PICTURE 9(2).
                       08  OPD-NUM-MREA
                                    PICTURE 9(2).
                       08  OPD-NUM-DREA
                                    PICTURE 9(2).
      *                             FECHA EMISION CONTABLE
                   06  OPD-FEC-FCTB.
                       08  OPD-NUM-SCTB
                                    PICTURE 9(2).
                       08  OPD-NUM-ACTB
                                    PICTURE 9(2).
                       08  OPD-NUM-MCTB
                                    PICTURE 9(2).
                       08  OPD-NUM-DCTB
                                    PICTURE 9(2).
      *                             FECHA INGRESO COMPUTACIONAL
                   06  OPD-FEC-FCMP.
                       08  OPD-NUM-SCMP
                                    PICTURE 9(2).
                       08  OPD-NUM-ACMP
                                    PICTURE 9(2).
                       08  OPD-NUM-MCMP
                                    PICTURE 9(2).
                       08  OPD-NUM-DCMP
                                    PICTURE 9(2).
      *                             MONTO CAPTACION
                   06  OPD-VAL-CAPT PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SALDO VALOR CAPTACION
                   06  OPD-VAL-SCAP PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             MONTO A PAGAR POR CAJA
                   06  OPD-VAL-CAJA PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             ANALISIS FERIADOS (S/N)
                   06  OPD-COD-AFER PICTURE X(1).
      *                             CONDICION GARANTIA
                   06  OPD-COD-GARA PICTURE X(1).
      *                             CODIGO UBICACION FISICA CDP
                   06  OPD-COD-UBFD.
                       08  OPD-COD-IUBF
                                    PICTURE X(3).
                       08  OPD-COD-CUBF
                                    PICTURE X(3).
                       08  OPD-COD-SUBF
                                    PICTURE X(3).
      *                             NUMERO PROXIMO VENCIMIENTO
                   06  OPD-NUM-IVEN PICTURE 9(3).
      *                             FECHA PROXIMO VENCIMIENTO
                   06  OPD-FEC-FPVC.
                       08  OPD-NUM-SPVC
                                    PICTURE 9(2).
                       08  OPD-NUM-APVC
                                    PICTURE 9(2).
                       08  OPD-NUM-MPVC
                                    PICTURE 9(2).
                       08  OPD-NUM-DPVC
                                    PICTURE 9(2).
      *                             CODIGO TIPO TASA INTERES
                   06  OPD-COD-TINT.
      *                             CODIGO TIPO TASA
                       08  OPD-COD-TIPT.
      *                             BASE CALCULO TASA INTERES
                       10  OPD-COD-BCTI
                                    PICTURE X(1).
      *                             PERIODO BASE TASA INTERES
                       10  OPD-COD-PBTI
                                    PICTURE X(1).
      *                             MODALIDAD CALCULO TASA INTERES
                       10  OPD-COD-MCTI.
      *                             BAJO PERIODO BASE TASA
                       12  OPD-COD-BPBT
                                    PICTURE X(1).
      *                             SOBRE PERIODO BASE TASA
                       12  OPD-COD-SPBT
                                    PICTURE X(1).
      *                             CODIGO VALOR TASA INTERES
                       08  OPD-COD-CVTI
                                    PICTURE X(3).
      *                             TIPO FECHA PERIODO REPACTO
                       08  OPD-COD-TFPR
                                    PICTURE X(1).
      *                             NUMERO PERIODO REPACTO
                       08  OPD-NUM-PREP
                                    PICTURE 9(3).
      *                             UNIDAD TIEMPO OPD-NUM-PREP
                       08  OPD-MSC-PREP
                                    PICTURE X(1).
      *                             VALOR SPREAD
                   06  OPD-SGV-SPRD PICTURE S9(5)V9(4)
                                        COMPUTATIONAL.
      *                             VALOR TASA
                   06  OPD-SGV-TINT PICTURE S9(5)V9(4)
                                        COMPUTATIONAL.
      *                             RETENCION DOCUMENTO
                   06  OPD-NUM-RETD PICTURE 9(3).
      *                             UNIDAD TIEMPO OPD-NUM-RETD
                   06  OPD-IND-RETD PICTURE X(1).
      *                             IND DEVOLUCION DINERO DOC S/FONDOS
                   06  OPD-COD-DEVL PICTURE X(1).
      *                             INDICADOR CUSTODIA
                   06  OPD-COD-CUST PICTURE X(1).
      *                             CONDICION GARANTIA ( EN POD )
                   06  OPD-COD-GPOD PICTURE X(1).
      *                             SEPARACION ENTRE VENCIMIENTOS
                   06  OPD-NUM-SEVE PICTURE 9(4)
                                        COMPUTATIONAL.
      *                             UNIDAD DE TIEMPO OPD-NUM-SEVE
                   06  OPD-IND-SEVE PICTURE X(1).
      *                             DURACION VENCIMIENTOS
                   06  OPD-NUM-DURV PICTURE 9(4)
                                        COMPUTATIONAL.
      *                             UNIDAD DE TIEMPO OPD-NUM-DURV
                   06  OPD-IND-DURV PICTURE X(1).
      *                             NUMERO VENCIMIENTOS NO LIQUIDADOS
                   06  OPD-NUM-VNLQ PICTURE 9(3).
      *                             NUMERO VENCIMIENTOS LIQUIDADOS
                   06  OPD-NUM-VSLQ PICTURE 9(3).
      *                             MODALIDAD DE RETIRO
                   06  OPD-COD-MORE PICTURE X(2).
      *                             MONTO O PORCENTAJE DEL RETIRO
                   06  OPD-SGV-MPRE PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR ORDEN NO PAGO
                   06  OPD-COD-IONP PICTURE X(1).
      *                             SITUACION CONTABLE
                   06  OPD-COD-SCTB PICTURE X(3).
      *                             INDICADOR RENOVABILIDAD
                   06  OPD-COD-RENO PICTURE X(1).
      *                             INDICADOR ENDOSABILIDAD
                   06  OPD-COD-ENDO PICTURE X(1).
      *                             VALOR REAJUSTES DEVENGADOS
                   06  OPD-VAL-READ PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR INTERESES DEVENGADOS
                   06  OPD-VAL-INTD PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             USUARIO QUE AUTORIZA TASA ESPECIAL
                   06  OPD-COD-EATE PICTURE X(12).
      *                             TASA PERIODO
                   06  OPD-VAL-SINT PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             FECHA DEVENGO ( ULTIMO PAGO TOTAL IN
                   06  OPD-FEC-FDEV.
                       08  OPD-NUM-SDEV
                                    PICTURE 9(2).
                       08  OPD-NUM-ADEV
                                    PICTURE 9(2).
                       08  OPD-NUM-MDEV
                                    PICTURE 9(2).
                       08  OPD-NUM-DDEV
                                    PICTURE 9(2).
      *                             FECHA TERMINO DE LA OPERACION
                   06  OPD-FEC-FTER.
                       08  OPD-NUM-STER
                                    PICTURE 9(2).
                       08  OPD-NUM-ATER
                                    PICTURE 9(2).
                       08  OPD-NUM-MTER
                                    PICTURE 9(2).
                       08  OPD-NUM-DTER
                                    PICTURE 9(2).
      *                             TIPO CERTIF DAP
                   06  OPD-COD-TCDP PICTURE X(3).
      *                             CODIGO RESCATE
                   06  OPD-COD-RESC PICTURE X(1).
      *                             CODIGO PLAZO PAGO RESCATE
                   06  OPD-COD-PLPA PICTURE X(1).
      *                             PLAZO RESCATE
                   06  OPD-NUM-PLRE PICTURE 9(3).
      *                             UNIDAD TIEMPO PLAZO RESCATE
                   06  OPD-IND-PLRE PICTURE X(1).
      *                             PERIODO NEGOCIACION TASA ESPECIAL
                   06  OPD-NUM-PNTE PICTURE 9(3).
      *                             UNIDAD TIEMPO OPD-NUM-PNTE
                   06  OPD-IND-PNTE PICTURE X(1).
      *                             PLAZO CONTABLE
                   06  OPD-COD-PLZO PICTURE X(2).
      *                             RESERVADO SAFE
                   06  OPD-GLS-SAFE PICTURE X(18).
      *                             FECHA DE CAPTACION ORIGINAL
                   06  OPD-FEC-FPCO.
                       08  OPD-NUM-SPCO
                                    PICTURE 9(2).
                       08  OPD-NUM-APCO
                                    PICTURE 9(2).
                       08  OPD-NUM-MPCO
                                    PICTURE 9(2).
                       08  OPD-NUM-DPCO
                                    PICTURE 9(2).
      *                             PERIODO PRIMER VENCIMIENTO
                   06  OPD-NUM-PVEN PICTURE 9(5)
                                        COMPUTATIONAL-3.
      *                             UNIDAD TIEMPO OPD-NUM-PVEN
                   06  OPD-IND-PVEN PICTURE X(1).
      *                             NUMERO DE OPERACION QUE GENERO RENOV
                   06  OPD-CIC-GREN.
                       08  OPD-CAI-GREN
                                    PICTURE X(4).
                       08  OPD-IIC-GREN
                                    PICTURE X(8).
      *                             INDICADOR ABONO AUTOMATICO A CUENTA
                   06  OPD-COD-AACC PICTURE X(1).
      *                             NUMERO DE OPERACION ORIGINAL
                   06  OPD-CIC-ORIG.
                       08  OPD-CAI-ORIG
                                    PICTURE X(4).
                       08  OPD-IIC-ORIG
                                    PICTURE X(8).
      *                             MULTIPLES CLIENTES ?
                   06  OPD-IND-MCLI PICTURE X(1).
      *                             INGRESO NO LINEA ? ( S = ODB, N = OD
                   06  OPD-IND-IDIF PICTURE X(1).
      *                             MONTO CAPTACION EN PESOS
                   06  OPD-VAL-IPES PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR CUSTODIA ORIGINAL
                   06  OPD-COD-CUSO PICTURE X(1).
      *                             GLOSA DISPONIBLE
                   06  OPD-GLS-DISP PICTURE X(9).
000000*    COPYDD DAP-R-VEN.DAP-E-VEN00(PROD),02,D
      *                             EQUIVALENTE AL REGISTRO VEN
           02  DAP-E-VEN00.
      *                             VENCIMIENTOS DAP
               04  VEN.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   06  VEN-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   06  VEN-KEY-IVEN.
      *                             COD. INT. COMP. OPERAC. DAP
                       08  VEN-CIC-IOPD.
      *                             CENTRO ASIGNAC. IDENTIFICACION
                       10  VEN-CAI-IOPD
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       10  VEN-IIC-IOPD
                                    PICTURE X(8).
      *                             NUM. IDENTIFICACION VENCIMIENTO
                       08  VEN-NUM-IVEN
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                   06  VEN-STP-ITRN.
      *                             FECHA TRANSACCION
                       08  VEN-FEC-FTRN
                                    PICTURE 9(8).
      *                             HORA TRANSACCION
                       08  VEN-HRA-HRTR
                                    PICTURE 9(6).
      *                             INDICADOR TIPO ACCION
                   06  VEN-COD-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   06  VEN-COD-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   06  VEN-COD-OTRN PICTURE X(4).
      *                             AUTOR TRANSACCION
                   06  VEN-COD-ATRN PICTURE X(12).
      *                             FECHA VENCIMIENTO
                   06  VEN-FEC-FVEN.
                       08  VEN-NUM-SVEN
                                    PICTURE 9(2).
                       08  VEN-NUM-AVEN
                                    PICTURE 9(2).
                       08  VEN-NUM-MVEN
                                    PICTURE 9(2).
                       08  VEN-NUM-DVEN
                                    PICTURE 9(2).
      *                             VALOR CAPITAL VENCIMIENTO ORIGINAL
                   06  VEN-VAL-CAPI PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SALDO VALOR CAPITAL VCMTO.
                   06  VEN-VAL-SCAP PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INT DEVENGADOS NO LIQUIDADOS
                   06  VEN-VAL-IDNI PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR FINAL VENCIMIENTO
                   06  VEN-VAL-FINA PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SALDO VALOR FINAL VCMTO.
                   06  VEN-VAL-SFIN PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SITUACION CONTABLE
                   06  VEN-COD-SCTB PICTURE X(3).
      *                             GLOSA DISPONIBLE
                   06  VEN-GLS-DISP PICTURE X(20).
000000*
000000 SD  FSORT.
000000 01  REG-FSORT.
000000     05 FSORT-FECHVCTO            PIC 9(08).
000000     05 FSORT-OFICIN              PIC X(03).
000000     05 FSORT-CODOPER             PIC X(06).
000000     05 FSORT-MONEDA              PIC X(06).
000000     05 FSORT-CAPITAL             PIC S9(16)V99  COMP-3.
000000     05 FSORT-KEY-IOPD            PIC X(12).
000000     05 FSORT-CIC-ISER            PIC X(12).
000000*
000000 FD  LISTADO
000000     RECORDING MODE IS F
000000     LABEL RECORD STANDARD
000000     BLOCK CONTAINS    0 RECORDS.
000000 01  REG-LISTADO                 PIC X(132).
000000*
000000     EJECT
000000 WORKING-STORAGE SECTION.
000000*
000000     COPY BIBBAUD1.
000000*
000000 01  SB-CT-CONTROL.
000000     05 FECHA-INI.
000000        10 SS-I                  PIC 99.
000000        10 AA-I                  PIC 99.
000000        10 MM-I                  PIC 99.
000000        10 DD-I                  PIC 99.
000000     05 FECHA-FIN.
000000        10 SS-F                  PIC 99.
000000        10 AA-F                  PIC 99.
000000        10 MM-F                  PIC 99.
000000        10 DD-F                  PIC 99.
000000     05 MONTO-TP-PESO            PIC X(12).
000000     05 MONTO-TOPE-PESO REDEFINES MONTO-TP-PESO PIC 9(10)V99.
000000     05 MONTO-TP-UF              PIC X(12).
000000     05 MONTO-TOPE-UF  REDEFINES MONTO-TP-UF  PIC 9(10)V99.
000000     05 MONTO-TP-DOLAR             PIC X(12).
000000     05 MONTO-TOPE-DOLAR REDEFINES MONTO-TP-DOLAR PIC 9(10)V99.
000000     05 OPCION-TP                PIC 9.
000000        88 OPCION-OK                            VALUE 0, 1.
000000        88 PROC-SUCUR                           VALUE 0.
000000        88 PROC-CENTRAL                         VALUE 1.
000000*
000000 01  CONTADORES.
000000     05 CNT-DAPDOPD-L        PIC 9(08) VALUE 0.
000000     05 CNT-DAPDOPD-S        PIC 9(08) VALUE 0.
000000     05 CNT-FSORT-G          PIC 9(08) VALUE 0.
000000     05 CNT-FSORT-L          PIC 9(08) VALUE 0.
000000     05 CONT-LINEAS          PIC 9(03) VALUE 0.
000000     05 EX-CONTAPAG          PIC 9(03) VALUE 0.
000000     05 TOTAL-MENOR          PIC 9(12) VALUE 0.
000000     05 TOTAL-TOPE           PIC 9(12) VALUE 0.
000000     05 TOTAL-VAR-SUCUR      PIC 9(16)V99   VALUE 0.
000000     05 TOTAL-VEN-SUCUR      PIC 9(16)V99   VALUE 0.
000000     05 TOTAL-VAR-CENTR      PIC 9(16)V99   VALUE 0.
000000     05 TOTAL-VEN-CENTR      PIC 9(16)V99   VALUE 0.
000000     05 TOTAL-VEN-BANCO      PIC 9(16)V99   VALUE 0.
000000*
000000 01  F-STATUS-INDICADORES.
000000     05 FS-DAPDOPD           PIC 9(01) VALUE 0.
000000     05 FS-FSORT             PIC 9(01) VALUE 0.
000000*
000000 01  W-VARIABLES.
000000     05 SW-CANCEL            PIC 9(01)     VALUE 0.
000000     05 SW-MENSAJ            PIC 9(01)     VALUE 0.
000000     05 WSS-FECHA-INI        PIC 9(08)     VALUE 0.
000000     05 WSS-FECHA-FIN        PIC 9(08)     VALUE 0.
000000     05 FECHA-AUX            PIC 9(08)     VALUE 0.
000000     05 MONEDA-AUX           PIC X(06)     VALUE SPACES.
000000     05 MONTO-TOPE-AUX       PIC 9(10)V99  VALUE 0.
000000     05 TAB-FECHA-AUX        PIC 9(08)     VALUE 0.
000000     05 WR-GLS-NOMC          PIC X(75).
000000*
000000     EJECT
000000*
000000* TABLA DE ACUMULACION PARA RESUMEN FINAL
000000*
000000 01  TABLA-ACM.
000000     05 TAB-ACM-CNT              PIC 9(3) VALUE 0.
000000     05 TAB-ACM-AUX              PIC X(82).
000000     05 TAB-ACM                  OCCURS 0 TO 200 TIMES
000000                                 DEPENDING ON TAB-ACM-CNT
000000                                 INDEXED BY IX-ACM1
000000                                            IX-ACM2.
000000        10 TB-ACM-CLAVE.
000000           15 TB-ACM-CLAVE-FECHA PIC 9(08).
000000           15 TB-ACM-CLAVE-MONED PIC X(04).
000000        10 TB-ACM-VAR-SUCURSAL   PIC 9(16)V99.
000000        10 TB-ACM-VEN-SUCURSAL   PIC 9(16)V99.
000000        10 TB-ACM-VAR-CENTRAL    PIC 9(16)V99.
000000        10 TB-ACM-VEN-CENTRAL    PIC 9(16)V99.
000000        10 TB-ACM-TOT-BANCO      PIC 9(16)V99.
000000*
000000 01  FECHA-VENCIMIENTO.
000000     05 SS-VENC                 PIC 99.
000000     05 AA-VENC                 PIC 99.
000000     05 MM-VENC                 PIC 99.
000000     05 DD-VENC                 PIC 99.
000000
000000 01  FECHA-CONTROL.
000000     05 AA-CONTROL              PIC 99.
000000     05 MM-CONTROL              PIC 99.
000000     05 DD-CONTROL              PIC 99.
000000*
000000     EJECT
000000***  LINEAS DE LISTADO  **********
000000*
000000 01  SC-T1.
000000     05 FILLER          PIC X(30)  VALUE
000000        'BANCO CREDITO INVERSIONES     '.
000000     05 FILLER          PIC X(25)  VALUE SPACES.
000000     05 FILLER          PIC X(12)  VALUE 'PGM:DAPPLFI2'.
000000     05 FILLER          PIC X(23)  VALUE SPACES.
000000     05 FILLER          PIC X(15)  VALUE 'FECHA PROCESO: '.
000000     05 DD-PROCESO      PIC 9(2).
000000     05 FILLER          PIC X      VALUE '/'.
000000     05 MM-PROCESO      PIC 9(2).
000000     05 FILLER          PIC X      VALUE '/'.
000000     05 AA-PROCESO      PIC 9(2).
000000     05 FILLER          PIC X(16)  VALUE '           PAG. '.
000000     05 NUM-PAG         PIC ZZZ.
000000*
000000 01  SC-T2.
000000     05 FILLER          PIC X(30)  VALUE
000000        'SISTEMA DEPOSITOS A PLAZO     '.
000000     05 FILLER          PIC X(103) VALUE SPACES.
000000*
000000 01  SC-T3.
000000     05 FILLER          PIC X(44)  VALUE
000000        '             I N F O R M E  D E  V E N C I M'.
000000     05 FILLER          PIC X(44)  VALUE
000000        ' I E N T O S  D E  M O N T O  M A Y O R  A  '.
000000     05 MONEDA-T3       PIC X(3).
000000     05 MONTO-TOPE-T3   PIC Z.ZZZ.ZZZ.ZZZ,ZZ.
000000     05 FILLER          PIC X(9)   VALUE '  D E L  '.
000000     05 FECHA-LISTADO.
000000        10 DD-C         PIC 99.
000000        10 FILLER       PIC X      VALUE '-'.
000000        10 MM-C         PIC 99.
000000        10 FILLER       PIC X      VALUE '-'.
000000        10 SS-C         PIC 99.
000000        10 AA-C         PIC 99.
000000     05 FILLER          PIC X(07)  VALUE SPACES.
000000*
000000 01  SC-S1.
000000     05 FILLER          PIC X(13)   VALUE SPACES.
000000     05 FILLER          PIC X(113)  VALUE ALL '*'.
000000     05 FILLER          PIC X(07)   VALUE SPACES.
000000*
000000 01  SC-T5.
000000     05 FILLER          PIC X(3)   VALUE SPACES.
000000     05 FILLER          PIC X(7)   VALUE 'COD.OP.'.
000000     05 FILLER          PIC X(3)   VALUE SPACES.
000000     05 FILLER          PIC X(29)  VALUE 'NOMBRE  BENEFICIARIO'.
000000     05 FILLER          PIC X(18)  VALUE SPACES.
000000     05 FILLER          PIC X(30)  VALUE 'NOMBRE  OFICINA '.
000000     05 FILLER          PIC X(14)  VALUE SPACES.
000000     05 FILLER          PIC X(01)  VALUE SPACES.
000000     05 FILLER          PIC X(24)  VALUE
000000        '         C A P I T A L  '.
000000*
000000 01  SC-S2.
000000     05 FILLER          PIC X(3)   VALUE SPACES.
000000     05 FILLER          PIC X(7)   VALUE ALL '='.
000000     05 FILLER          PIC X(3)   VALUE SPACES.
000000     05 FILLER          PIC X(29)  VALUE ALL '='.
000000     05 FILLER          PIC X(18)  VALUE SPACES.
000000     05 FILLER          PIC X(30)  VALUE ALL '='.
000000     05 FILLER          PIC X(14)  VALUE SPACES.
000000     05 FILLER          PIC X(01)  VALUE SPACES.
000000     05 FILLER          PIC X(24)  VALUE ALL '='.
000000*
000000 01  SC-SPACE-LINE.
000000     05 FILLER          PIC X(132) VALUE SPACES.
000000*
000000 01  SC-LD.
000000     05 FILLER          PIC X(3)   VALUE SPACES.
000000     05 LD-CODOPER      PIC X(6).
000000     05 FILLER          PIC X(4)   VALUE SPACES.
000000     05 LD-NOMBRE-BENEF PIC X(29)  VALUE SPACES.
000000     05 FILLER          PIC X(18)  VALUE SPACES.
000000     05 LD-NOMBRE-SUCUR PIC X(30)  VALUE SPACES.
000000     05 FILLER          PIC X(14)  VALUE SPACES.
000000     05 FILLER          PIC X(01)  VALUE SPACES.
000000     05 LD-CAPITAL      PIC Z.ZZZ.ZZZ.ZZZ.ZZZ.ZZ9,99.
000000*
000000 01  SC-LT-1.
000000     05 FILLER          PIC X(09)  VALUE SPACES.
000000     05 FILLER          PIC X(35)  VALUE
000000        '(1) VARIOS SUCURSALES              '.
000000     05 FILLER          PIC X(60)  VALUE ALL '-'.
000000     05 FILLER          PIC X(01)  VALUE SPACES.
000000     05 LT-1-VARIOS     PIC Z.ZZZ.ZZZ.ZZZ.ZZZ.ZZ9,99.
000000*
000000 01  SC-LT-2.
000000     05 FILLER          PIC X(09)  VALUE SPACES.
000000     05 FILLER          PIC X(35)  VALUE
000000        '(2) VARIOS OFIC. CTRAL             '.
000000     05 FILLER          PIC X(60)  VALUE ALL '-'.
000000     05 FILLER          PIC X(01)  VALUE SPACES.
000000     05 LT-2-VARIOS     PIC Z.ZZZ.ZZZ.ZZZ.ZZZ.ZZ9,99.
000000*
000000 01  SC-LTV-1.
000000     05 FILLER          PIC X(09)  VALUE SPACES.
000000     05 FILLER          PIC X(35)  VALUE
000000        '(1) TOTAL VENCIMIENTOS SUCURSALES  '.
000000     05 FILLER          PIC X(60)  VALUE ALL '-'.
000000     05 FILLER          PIC X(01)  VALUE SPACES.
000000     05 LTV-1-VENCIM    PIC Z.ZZZ.ZZZ.ZZZ.ZZZ.ZZ9,99.
000000*
000000 01  SC-LTV-2.
000000     05 FILLER          PIC X(09)  VALUE SPACES.
000000     05 FILLER          PIC X(35)  VALUE
000000        '(2) TOTAL VENCIMIENTOS OFIC. CTRAL '.
000000     05 FILLER          PIC X(60)  VALUE ALL '-'.
000000     05 FILLER          PIC X(01)  VALUE SPACES.
000000     05 LTV-2-VENCIM    PIC Z.ZZZ.ZZZ.ZZZ.ZZZ.ZZ9,99.
000000*
000000 01  SC-LTB.
000000     05 FILLER          PIC X(09)  VALUE SPACES.
000000     05 FILLER          PIC X(35)  VALUE
000000        '    TOTAL VENCIMIENTOS BANCO       '.
000000     05 FILLER          PIC X(60)  VALUE ALL '-'.
000000     05 FILLER          PIC X(01)  VALUE SPACES.
000000     05 LTB-BANCO       PIC Z.ZZZ.ZZZ.ZZZ.ZZZ.ZZ9,99.
000000*
000000 01  SC-RES1.
000000     05 FILLER          PIC X(34)  VALUE SPACES.
000000     05 FILLER          PIC X(32)  VALUE
000000        'R E S U M E N    I N F O R M E  '.
000000     05 FILLER          PIC X(32)  VALUE
000000        '  D E    V E N C I M I E N T O S'.
000000     05 FILLER          PIC X(34)  VALUE SPACES.
000000*
000000 01  SC-RES2.
000000     05 FILLER          PIC X(34)  VALUE SPACES.
000000     05 FILLER          PIC X(32)  VALUE
000000        '********************************'.
000000     05 FILLER          PIC X(32)  VALUE
000000        '********************************'.
000000     05 FILLER          PIC X(34)  VALUE SPACES.
000000*
000000 01  RES-DET1.
000000     05 FILLER                   PIC X(08)  VALUE 'FECHA:  '.
000000     05 RES-REC-DD               PIC 9(02).
000000     05 FILLER                   PIC X(01)  VALUE '/'.
000000     05 RES-REC-MM               PIC 9(02).
000000     05 FILLER                   PIC X(01)  VALUE '/'.
000000     05 RES-REC-SS               PIC 9(02).
000000     05 RES-REC-AA               PIC 9(02).
000000     05 FILLER                   PIC X(114) VALUE SPACES.
000000*
000000 01  RES-DET2.
000000     05 FILLER                   PIC X(04)  VALUE SPACES.
000000     05 RES-MONEDA               PIC X(15).
000000     05 RES-TOPE                 PIC Z.ZZZ.ZZZ.ZZZ,ZZ.
000000     05 FILLER                   PIC X(97)  VALUE SPACES.
000000*
000000******************************************************************
000000*      USER INFORMATION BLOCK                                    *
000000******************************************************************
000000*
000000 01  UIB.
000000     05 FILLER                 PIC X(32) VALUE 'DAPPLFI2'.
000000*
000000     EJECT
000000******************************************************************
000000*      REQUEST AREA                                              *
000000******************************************************************
000000*
000000 01  REQ-AREA-RCC.
000000     05 REQ-CMD-RCC          PIC X(05).
000000     05 REQ-TBLNM-RCC        PIC X(03)  VALUE 'RCC'.
000000     05 REQ-KEYNM-RCC        PIC X(05)  VALUE 'RCC01'.
000000     05 REQ-RETURN-CODE-RCC  PIC X(02)  VALUE SPACES.
000000     05 REQ-INRCD-RCC        PIC X(01).
000000     05 REQ-DBIDE-RCC        PIC S9(4)  COMP VALUE +370.
000000     05 REQ-TBLID-RCC        PIC X(07).
000000     05 FILLER               PIC X(25).
000000     05 REQ-CTMAX-RCC        PIC S9(4)  COMP.
000000     05 REQ-IOCNT-RCC        PIC S9(4)  COMP.
000000     05 FILLER               PIC X(22).
000000     05 REQ-KYVAL-RCC.
000000        10 REQ-KEY-RCC-CIC   PIC X(12).
000000*
000000 01  REQ-AREA-DBC.
000000     05 REQ-CMD-DBC          PIC X(05).
000000     05 REQ-TBLNM-DBC        PIC X(03)  VALUE 'DBC'.
000000     05 REQ-KEYNM-DBC        PIC X(05)  VALUE 'DBC00'.
000000     05 REQ-RETURN-CODE-DBC  PIC X(02)  VALUE SPACES.
000000     05 REQ-INRCD-DBC        PIC X(01).
000000     05 REQ-DBIDE-DBC        PIC S9(4)  COMP VALUE +100.
000000     05 REQ-TBLID-DBC        PIC X(07).
000000     05 FILLER               PIC X(25).
000000     05 REQ-CTMAX-DBC        PIC S9(4)  COMP.
000000     05 REQ-IOCNT-DBC        PIC S9(4)  COMP.
000000     05 FILLER               PIC X(22).
000000     05 REQ-KYVAL-DBC.
000000        10 REQ-KEY-DBC-ICLI  PIC X(12).
000000*
000000     EJECT
000000******************************************************************
000000*                   WORK AREA                                    *
000000******************************************************************
000000*
000000 01  REG-RCC.
000000*    COPYDD DAP-R-RCC.DAP-E-RCC00(PROD),02,D
      *                             EQUIVALENTE AL REGISTRO RCC
           02  DAP-E-RCC00.
      *                             RELACION CLIENTE CAPTACION
               04  RCC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   06  RCC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   06  RCC-KEY-IREG.
      *                             IDENTIFICACION RELACION CLIENTE OPER
                       08  RCC-KEY-IRCC.
      *                             COD. INT. COMP. CLIENTE
                       10  RCC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       12  RCC-CAI-ICLI
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       12  RCC-IIC-ICLI
                                    PICTURE X(8).
      *                             IDENTIFICACION OPERACION DAP
                       10  RCC-KEY-IOPD.
      *                             COD. INT. COMP. OPERACION
                       12  RCC-CIC-IOPD.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       14  RCC-CAI-IOPD
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       14  RCC-IIC-IOPD
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       08  RCC-STP-ITRN.
      *                             FECHA TRANSACCION
                       10  RCC-FEC-FTRN
                                    PICTURE 9(8).
      *                             HORA TRANSACCION
                       10  RCC-HRA-HRTR
                                    PICTURE 9(6).
      *                             INDICADOR TIPO ACCION
                   06  RCC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   06  RCC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   06  RCC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       08  RCC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       08  RCC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   06  RCC-COD-ATRN PICTURE X(12).
      *                             CODIGO STATUS
                   06  RCC-COD-STAT PICTURE X(3).
      *                             COD RELACION CLIENTE OPERACION
                   06  RCC-COD-RCOP PICTURE X(3).
      *                             NUMERO DE DIRECCION
                   06  RCC-NUM-DIRE PICTURE 9(2).
      *                             PORCENTAJE RELACION
                   06  RCC-VAL-PRCO PICTURE 9(3)V9(6)
                                        COMPUTATIONAL.
      *                             CODIGO CLASE OPERACION
                   06  RCC-COD-COPD.
      *                             CODIGO TIPO OPERACION
                       08  RCC-COD-TOPD
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       08  RCC-COD-AOPD
                                    PICTURE X(3).
      *                             DISPONIBLE
                   06  RCC-GLS-DISP PICTURE X(17).
000000*
000000 01  REG-DBC.
000000*    COPYDD DGC-R-DBC.DGC-E-DBC00(PROD),02,D
      *                             EQUIVALENTE AL REGISTRO DBC
           02  DGC-E-DBC00.
      *                             DATOS BASICOS DEL CLIENTE
               04  DBC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   06  DBC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   06  DBC-KEY-IREG.
      *                             IDENTIFICACION DATOS BASICOS CLIENTE
                       08  DBC-KEY-IDBC.
      *                             COD. INT. COMP. CLIENTE
                       10  DBC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       12  DBC-CAI-ICLI.
                       14  DBC-COD-TCLI
                                    PICTURE X(1).
                       14  DBC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       12  DBC-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       08  DBC-STP-ITRN.
      *                             FECHA TRANSACCION
                       10  DBC-FEC-FTRN.
                       12  DBC-NUM-STRN
                                    PICTURE 9(2).
                       12  DBC-NUM-ATRN
                                    PICTURE 9(2).
                       12  DBC-NUM-MTRN
                                    PICTURE 9(2).
                       12  DBC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       10  DBC-HRA-HRTR.
                       12  DBC-NUM-HHTR
                                    PICTURE 9(2).
                       12  DBC-NUM-MMTR
                                    PICTURE 9(2).
                       12  DBC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   06  DBC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   06  DBC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   06  DBC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       08  DBC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       08  DBC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   06  DBC-COD-ATRN PICTURE X(12).
      *                             KEY RUT CLIENTE + INDICADOR O CALIFI
                   06  DBC-IDC-ICLI.
      *                             RUT CLIENTE
                       08  DBC-NUM-ICLI
                                    PICTURE X(8).
      *                             INDICADOR TIPO RUT
                       08  DBC-IND-ICLI
                                    PICTURE X(1).
      *                             EXTENSION DEL RUT
                       08  DBC-GLS-ICLI
                                    PICTURE X(3).
      *                             KEY DIGITO VERIFICADOR DEL RUT
                   06  DBC-VRF-ICLI PICTURE X(1).
      *                             KEY NOMBRE CLIENTE GENERICO (PERSONA
                   06  DBC-GLS-NOMC.
                       08  DBC-GLS-APAT
                                    PICTURE X(25).
                       08  DBC-GLS-AMAT
                                    PICTURE X(25).
                       08  DBC-GLS-NOMB
                                    PICTURE X(25).
      *                             SOUNDEX DEL NOMBRE DE CLIENTE
                   06  DBC-SNX-NOMC.
                       08  DBC-SNX-APAT
                                    PICTURE X(3).
                       08  DBC-SNX-AMAT
                                    PICTURE X(3).
                       08  DBC-SNX-NOMB
                                    PICTURE X(3).
      *                             NUMERO DE DIRECCION DE ENVIO CORRESP
                   06  DBC-NUM-DCOR PICTURE 9(2).
      *                             OPR IND TIPO CLIENTE ( PERSONA O EMP
                   06  DBC-IND-TICL PICTURE X(1).
      *                             TIPO CLIENTE (POTENCIAL,NO CLIENTE,G
                   06  DBC-COD-TICL PICTURE X(2).
      *                             CODIGO CLASIFICACION COMERCIAL
                   06  DBC-COD-CLCM PICTURE X(2).
      *                             RCM CODIGO DEL EJECUTIVO ENCARGADO D
                   06  DBC-COD-EJEC PICTURE X(12).
      *                             OPR CODIGO DE OFICINA DONDE OPERA EL
                   06  DBC-COD-OFIC PICTURE X(3).
      *                             RCM INDICADOR SI OPERA EN OTRA OFICI
                   06  DBC-IND-OOFI PICTURE X(1).
      *                             EXT CODIGO ACTIVIDAD ECONOMICA
                   06  DBC-COD-ACTI PICTURE X(9).
      *                             EXT ORIGEN Y DESTINO SECT (COMP.INST
                   06  DBC-COD-ODSE PICTURE X(3).
      *                             INF FECHA INGRESO AL PLAN
                   06  DBC-FEC-FPLN.
                       08  DBC-NUM-SPLN
                                    PICTURE 9(2).
                       08  DBC-NUM-APLN
                                    PICTURE 9(2).
                       08  DBC-NUM-MPLN
                                    PICTURE 9(2).
                       08  DBC-NUM-DPLN
                                    PICTURE 9(2).
      *                             CODIGO DE SEGMENTO
                   06  DBC-COD-SETO PICTURE X(5).
      *                             PERIODO DE SEGMENTO (SSAAMM)
                   06  DBC-PDO-SETO PICTURE X(6).
      *                             INF INDICADOR DE MULTAS BANCO CENTRA
                   06  DBC-IND-MUBC PICTURE X(1).
      *                             INF INDICADOR DE JUICIOS BANCO CENTR
                   06  DBC-IND-JUBC PICTURE X(1).
      *                             EXT CODIGO ESTADO CLIENTE ( COMO DEU
                   06  DBC-MSC-SCLI PICTURE X(1).
      *                             FECHA ESTADO CLIENTE
                   06  DBC-FEC-FSCL.
                       08  DBC-NUM-SSCL
                                    PICTURE 9(2).
                       08  DBC-NUM-ASCL
                                    PICTURE 9(2).
                       08  DBC-NUM-MSCL
                                    PICTURE 9(2).
                       08  DBC-NUM-DSCL
                                    PICTURE 9(2).
      *                             CODIGO DE BLOQUEO DEL CLIENTE
                   06  DBC-COD-BLOC PICTURE X(2).
      *                             NUMERO TOTAL DE DIRECCIONES
                   06  DBC-NUM-TDIR PICTURE 9(2).
      *                             NUMERO TOTAL DE COMENTARIOS
                   06  DBC-NUM-TCMT PICTURE 9(3).
      *                             FECHA INICIO OPERACION
                   06  DBC-FEC-FIOP.
                       08  DBC-NUM-SIOP
                                    PICTURE 9(2).
                       08  DBC-NUM-AIOP
                                    PICTURE 9(2).
                       08  DBC-NUM-MIOP
                                    PICTURE 9(2).
                       08  DBC-NUM-DIOP
                                    PICTURE 9(2).
      *                             FECHA TERMINO OPERACION
                   06  DBC-FEC-FTOP.
                       08  DBC-NUM-STOP
                                    PICTURE 9(2).
                       08  DBC-NUM-ATOP
                                    PICTURE 9(2).
                       08  DBC-NUM-MTOP
                                    PICTURE 9(2).
                       08  DBC-NUM-DTOP
                                    PICTURE 9(2).
      *                             NUMERO OPERACIONES FECHA TERMINO NUL
                   06  DBC-NUM-OFTN PICTURE 9(3).
      *                             FECHA INGRESO DE DATOS A LA BASE DE
                   06  DBC-FEC-FINP.
                       08  DBC-NUM-SINP
                                    PICTURE 9(2).
                       08  DBC-NUM-AINP
                                    PICTURE 9(2).
                       08  DBC-NUM-MINP
                                    PICTURE 9(2).
                       08  DBC-NUM-DINP
                                    PICTURE 9(2).
000000*
000000     EJECT
000000******************************************************************
000000*                 ELEMENT LIST                                   *
000000******************************************************************
000000*
000000 01  ELM-LIS-RCC.
000000     05 ELEM-RCC             PIC X(05)  VALUE 'RCC00'.
000000     05 ELSE-RCC             PIC X(01).
000000     05 FILLER               PIC X(05)  VALUE SPACES.
000000*
000000 01  ELM-LIS-DBC.
000000     05 ELEM-DBC             PIC X(05)  VALUE 'DBC00'.
000000     05 ELSE-DBC             PIC X(01).
000000     05 FILLER               PIC X(05)  VALUE SPACES.
000000*
000000     EJECT
000000     COPY RTNWCALE.
000000     EJECT
000000     COPY RUTWCMNN.
000000     EJECT
000000     COPY RUTWTOFI.
000000     EJECT
000000*
000000*
000000*
000000 PROCEDURE DIVISION.
000000*
000000 A-CONTROL SECTION.
000000     ENTRY 'DBMSCBL'
000000     COPY BIBBAUD2.
000000*
000000 AA-INICIALIZACION.
000000     PERFORM B-INICIALIZAR.
000000*
000000 AB-PROCESAMIENTO.
000000     PERFORM C-PROCESAR.
000000*
000000 AC-TERMINACION.
000000     PERFORM D-TERMINAR.
000000*
000000 AZZ-FIN-PROC.
000000     GOBACK.
000000     EJECT
000000*
000000*            MODULO DE INICIALIZACION
000000*
000000 B-INICIALIZAR SECTION.
000000*
000000 BA-CONTROL.
000000     PERFORM BA-CARGA-CALENDAR
000000     PERFORM BB-VALIDA-PARAMETROS
000000     PERFORM BC-ABRIR-ARCHIVOS
000000     PERFORM BZ-VERIFICA
000000     GO TO BZZ-FIN-SECC.
000000*
000000 BA-CARGA-CALENDAR.
000000     MOVE ALL '0'                TO CALEAREA-FECHA-1
000000     MOVE 'CARGAR'               TO CALEAREA-FUNCION
000000     CALL 'RUTUCALE' USING RTNWCALE
000000     IF CALEAREA-FUNCION  =  'CANCEL'
000000        DISPLAY  '10: *ERROR  EN CARGA DE RUTUCALE'
000000        MOVE 1 TO SW-CANCEL.
000000*
000000 BB-VALIDA-PARAMETROS.
000000* ACEPTA FECHA DE PROCESO
000000     ACCEPT FECHA-CONTROL        FROM DATE
000000     MOVE DD-CONTROL             TO DD-PROCESO
000000     MOVE MM-CONTROL             TO MM-PROCESO
000000     MOVE AA-CONTROL             TO AA-PROCESO
000000*
000000*  VALIDA FECHA INICIAL DEL RANGO
000000     ACCEPT FECHA-INI
000000     MOVE SS-I                   TO CALEAREA-FECHA-1-AM
000000     MOVE AA-I                   TO CALEAREA-FECHA-1-AA
000000     MOVE MM-I                   TO CALEAREA-FECHA-1-M
000000     MOVE DD-I                   TO CALEAREA-FECHA-1-D
000000     MOVE 'INFO'                 TO CALEAREA-FUNCION
000000     CALL 'RUTUCALE' USING RTNWCALE
000000     IF CALEAREA-COD-RET NOT = 0
000000        DISPLAY  '02 FECHA-INICIAL   INCORRECTA CODIGO-RETORNO :'
000000                  CALEAREA-COD-RET  '   '
000000                  FECHA-INI
000000        MOVE 1 TO SW-CANCEL.
000000*
000000* VALIDA FECHA FINAL   DEL RANGO
000000     ACCEPT FECHA-FIN
000000     MOVE SS-F                   TO   CALEAREA-FECHA-1-AM
000000     MOVE AA-F                   TO   CALEAREA-FECHA-1-AA
000000     MOVE MM-F                   TO   CALEAREA-FECHA-1-M
000000     MOVE DD-F                   TO   CALEAREA-FECHA-1-D
000000     MOVE 'INFO'                 TO   CALEAREA-FUNCION
000000     CALL 'RUTUCALE' USING RTNWCALE
000000     IF CALEAREA-COD-RET NOT = 0
000000        DISPLAY  '02 FECHA-FINAL     INCORRECTA CODIGO-RETORNO :'
000000                CALEAREA-COD-RET  '   '
000000                FECHA-FIN
000000        MOVE 1 TO SW-CANCEL.
000000*
000000*  VALIDACION MONTO TOPE PESOS.
000000     ACCEPT MONTO-TP-PESO
000000     IF MONTO-TP-PESO  NOT NUMERIC
000000        DISPLAY 'MONTO TOPE PESOS NO NUMERICO'  MONTO-TP-PESO
000000        MOVE 1 TO SW-CANCEL.
000000*
000000*  VALIDACION MONTO TOPE UF.
000000     ACCEPT MONTO-TP-UF
000000     IF MONTO-TP-UF  NOT NUMERIC
000000        DISPLAY 'MONTO TOPE UF NO NUMERICO'  MONTO-TP-UF
000000        MOVE 1 TO SW-CANCEL.
000000*
000000*  VALIDACION MONTO TOPE DOLAR.
000000     ACCEPT MONTO-TP-DOLAR
000000     IF MONTO-TP-DOLAR  NOT NUMERIC
000000        DISPLAY 'MONTO TOPE DOLAR NO NUMERICO'  MONTO-TP-DOLAR
000000        MOVE 1 TO SW-CANCEL.
000000*
000000*  VALIDACION OPCION.
000000     ACCEPT OPCION-TP
000000     IF NOT OPCION-OK
000000        DISPLAY 'CODIGO DE OPCION INVALIDO EN TARJETA PARAMETRO'
000000        MOVE 1 TO SW-CANCEL.
000000*
000000     MOVE FECHA-INI              TO  WSS-FECHA-INI
000000     MOVE FECHA-FIN              TO  WSS-FECHA-FIN
000000     DISPLAY  '***********************'
000000     DISPLAY  'PARAMETROS  INGRESADOS PROGRAMA DAPPLFI2'
000000     DISPLAY  'SISTEMA DEPOSITOS A PLAZO'
000000     DISPLAY  'INFORMACION FINANZAS'
000000     DISPLAY  'FECHA-INICIAL   :'  FECHA-INI
000000     DISPLAY  'FECHA-FINAL     :'  FECHA-FIN
000000     DISPLAY  'MONTO TOPE $    :'  MONTO-TOPE-PESO
000000     DISPLAY  'MONTO TOPE UF   :'  MONTO-TOPE-UF
000000     DISPLAY  'MONTO TOPE US$  :'  MONTO-TOPE-DOLAR
000000     DISPLAY  '***********************'.
000000*
000000 BC-ABRIR-ARCHIVOS.
000000     OPEN INPUT  DAPDOPD
000000          OUTPUT LISTADO.
000000*
000000 BZ-VERIFICA.
000000     IF SW-CANCEL = 1
000000        DISPLAY '*****************************************'
000000        DISPLAY '*                                       *'
000000        DISPLAY 'ERROR EN MODULO INICIALIZACION'
000000        DISPLAY '*                                       *'
000000        DISPLAY '*****************************************'
000000        PERFORM D-TERMINAR.
000000*
000000 BZZ-FIN-SECC.
000000     EXIT.
000000     EJECT
000000*
000000*            MODULO DE PROCESO PRINCIPAL
000000*
000000 C-PROCESAR SECTION.
000000*
000000 CA-SORT.
000000     SORT FSORT
000000        ASCENDING KEY
000000           FSORT-MONEDA
000000           FSORT-FECHVCTO
000000           FSORT-OFICIN
000000           FSORT-CODOPER
000000        INPUT  PROCEDURE E-ENTRADA-SORT
000000        OUTPUT PROCEDURE F-SALIDA-SORT
000000     IF SORT-RETURN NOT = 0
000000        DISPLAY '** ##################### **'
000000        DISPLAY '** HUBO ERROR EN SORT    **'
000000        DISPLAY '** ##################### **'
000000        MOVE 1                   TO SW-CANCEL.
000000*
000000 CZZ-FIN-SECC.
000000     EXIT.
000000     EJECT
000000*
000000*            MODULO DE TERMINACION
000000*
000000 D-TERMINAR SECTION.
000000*
000000 DA-TOTALES.
000000     CLOSE DAPDOPD LISTADO
000000     DISPLAY ' '
000000     DISPLAY '+---------------------------------------------+'
000000     DISPLAY '+ ESTADISTICAS DE PROCESO.  PROGRAMA DAPPLFI2 +'
000000     DISPLAY '+---------------------------------------------+'
000000     DISPLAY ' '
000000     DISPLAY 'REG DAPDOPD LEIDOS..................' CNT-DAPDOPD-L
000000     DISPLAY 'REG DAPDOPD SELECC..................' CNT-DAPDOPD-S
000000     DISPLAY 'REG FSORT GRABAD....................' CNT-FSORT-G
000000     DISPLAY 'REG FSORT LEIDOS....................' CNT-FSORT-L
000000     DISPLAY ' '
000000     DISPLAY 'REG CON MONTO CAPITAL >= TOPE.......' TOTAL-TOPE
000000     DISPLAY 'REG CON MONTO CAPITAL <  TOPE.......' TOTAL-MENOR
000000     DISPLAY ' '
000000     IF SW-CANCEL = 1
000000        DISPLAY ' '
000000        DISPLAY '************************************************'
000000        DISPLAY '****                                        ****'
000000        DISPLAY '****      TERMINO ERRONEO DEL PROCESO       ****'
000000        DISPLAY '****                                        ****'
000000        DISPLAY '************************************************'
000000        MOVE 100                 TO RETURN-CODE
000000        GOBACK
000000     ELSE
000000        DISPLAY '*** PROCESO TERMINO EN FORMA NORMAL ***'
000000        IF SW-MENSAJ = 1
000000           DISPLAY '**********************************'
000000           DISPLAY 'HAY MENSAJES PARA EL EXPLOTADOR   '
000000           DISPLAY '**********************************'
000000        ELSE
000000           DISPLAY '**********************************'
000000           DISPLAY 'NO HAY MENSAJES PARA EL EXPLOTADOR'
000000           DISPLAY '**********************************'.
000000*
000000 DZZ-FIN-SECC.
000000     EXIT.
000000     EJECT
000000*
000000*
000000*
000000 E-ENTRADA-SORT SECTION.
000000*
000000 EA-LEER-DAPDOPD.
000000     READ DAPDOPD AT END MOVE 1 TO FS-DAPDOPD.
000000     IF FS-DAPDOPD = 0
000000        ADD 1 TO CNT-DAPDOPD-L.
000000*
000000 EB-CTRL-PROC.
000000     PERFORM EC-SELECCIONA UNTIL
000000        FS-DAPDOPD = 1
000000     GO TO EZZ-FIN-SECC.
000000*
000000 EC-SELECCIONA.
000000** SELECCIONA REGISTROS PARA CARGARLOS EN EL SORT
000000     IF OPD-COD-STAT = 'G'
000000        PERFORM ED-REVISA-FECHAS.
000000     PERFORM EA-LEER-DAPDOPD.
000000*
000000 ED-REVISA-FECHAS.
000000     IF VEN-FEC-FVEN < WSS-FECHA-INI
000000* SE IGNORAN LAS OPERACIONES CON FECHA DE VENCIMIENTO MENOR A
000000* FECHA DE INICIO POR PARAMETRO
000000        NEXT SENTENCE
000000     ELSE
000000        IF VEN-FEC-FVEN > WSS-FECHA-FIN
000000* SE IGNORAN LAS OPERACIONES CON FECHA DE VENCIMIENTO MAYOR A
000000* FECHA DE INICIO POR PARAMETRO
000000           NEXT SENTENCE
000000        ELSE
000000* SE PROCESAN SOLO LAS OPERACIONES CON FECHA DE VENCIMIENTO
000000* QUE ESTAN CONTENIDAS EN EL RANGO DE FECHAS INDICADO
000000* (INCLUIDOS LOS LIMITES POR PARAMETRO)
000000           ADD 1                TO CNT-DAPDOPD-S
000000           PERFORM EF-GRABA-FSORT.
000000*
000000 EF-GRABA-FSORT.
000000     MOVE OPD-COD-OFIC           TO FSORT-OFICIN
000000     IF OPD-COD-OFIC = '090'
000000        MOVE '999'               TO FSORT-OFICIN.
000000     MOVE OPD-COD-COPD           TO FSORT-CODOPER
000000     MOVE OPD-VAL-SCAP           TO FSORT-CAPITAL
000000     MOVE VEN-FEC-FVEN           TO FSORT-FECHVCTO
000000     MOVE OPD-COD-VCAM           TO FSORT-MONEDA
000000     MOVE OPD-KEY-IOPD           TO FSORT-KEY-IOPD
000000     MOVE OPD-CIC-ISER           TO FSORT-CIC-ISER
000000     RELEASE REG-FSORT
000000     ADD 1                       TO CNT-FSORT-G.
000000*
000000 EZZ-FIN-SECC.
000000     EXIT.
000000     EJECT
000000*
000000*
000000*
000000 F-SALIDA-SORT SECTION.
000000*
000000 FA-LEER-FSORT.
000000     RETURN FSORT AT END MOVE 1 TO FS-FSORT.
000000     IF FS-FSORT = 0
000000        ADD   1                  TO CNT-FSORT-L.
000000*
000000 FB-CTRL-PROC.
000000     PERFORM FE-TABULA-FSORT UNTIL
000000        FS-FSORT = 1
000000     PERFORM G-LISTA-RESUMEN
000000     GO TO FZZ-FIN-SECC.
000000*
000000 FE-TABULA-FSORT.
000000*
000000     EVALUATE FSORT-MONEDA
000000        WHEN '0998  '
000000           MOVE 'UF '            TO MONEDA-T3
000000           MOVE MONTO-TOPE-UF    TO MONTO-TOPE-T3
000000                                    MONTO-TOPE-AUX
000000        WHEN '0999  '
000000           MOVE '$  '            TO MONEDA-T3
000000           MOVE MONTO-TOPE-PESO  TO MONTO-TOPE-T3
000000                                    MONTO-TOPE-AUX
000000        WHEN '1013  '
000000           MOVE 'US$'            TO MONEDA-T3
000000           MOVE MONTO-TOPE-DOLAR TO MONTO-TOPE-T3
000000                                    MONTO-TOPE-AUX
000000        WHEN OTHER
000000           MOVE '???'            TO MONEDA-T3
000000           MOVE 999999999999     TO MONTO-TOPE-T3
000000     END-EVALUATE.
000000*
000000     MOVE FSORT-FECHVCTO         TO FECHA-VENCIMIENTO
000000     MOVE SS-VENC                TO SS-C
000000     MOVE AA-VENC                TO AA-C
000000     MOVE MM-VENC                TO MM-C
000000     MOVE DD-VENC                TO DD-C
000000     PERFORM FI-TITULO
000000     MOVE FSORT-MONEDA           TO MONEDA-AUX
000000     MOVE FSORT-FECHVCTO         TO FECHA-AUX
000000     PERFORM FF-CORTE-FECHA UNTIL
000000        FSORT-MONEDA NOT = MONEDA-AUX OR
000000        FSORT-FECHVCTO NOT = FECHA-AUX OR
000000        FS-FSORT = 1.
000000*
000000 FF-CORTE-FECHA.
000000     PERFORM FG-PROCESA-SUCURSALES UNTIL
000000        FSORT-OFICIN = 999 OR
000000        FSORT-MONEDA NOT = MONEDA-AUX OR
000000        FSORT-FECHVCTO NOT = FECHA-AUX OR
000000        FS-FSORT = 1
000000     PERFORM FG1-TOTALES-SUCURSALES
000000     PERFORM FH-PROCESA-CENTRAL UNTIL
000000        FSORT-MONEDA NOT = MONEDA-AUX OR
000000        FSORT-FECHVCTO NOT = FECHA-AUX OR
000000        FS-FSORT = 1
000000     PERFORM FH1-TOTALES-CENTRAL
000000     PERFORM FH1-TOTALES-BANCO.
000000*
000000 FG-PROCESA-SUCURSALES.
000000     IF FSORT-CAPITAL NOT < MONTO-TOPE-AUX
000000        ADD FSORT-CAPITAL        TO TOTAL-VEN-SUCUR
000000        ADD 1                    TO TOTAL-TOPE
000000        IF PROC-SUCUR
000000           PERFORM FG2-LISTA-DETALLE
000000        END-IF
000000     ELSE
000000        ADD FSORT-CAPITAL        TO TOTAL-VAR-SUCUR
000000        ADD 1                    TO TOTAL-MENOR
000000     END-IF.
000000     PERFORM  FA-LEER-FSORT.
000000*
000000 FG1-TOTALES-SUCURSALES.
000000     IF CONT-LINEAS > 58
000000        PERFORM FI-TITULO.
000000     MOVE TOTAL-VAR-SUCUR        TO LT-1-VARIOS
000000     WRITE REG-LISTADO FROM SC-LT-1  AFTER 2
000000     MOVE TOTAL-VEN-SUCUR        TO LTV-1-VENCIM
000000     WRITE REG-LISTADO FROM SC-LTV-1 AFTER 1
000000     ADD 3                       TO CONT-LINEAS.
000000*
000000 FH-PROCESA-CENTRAL.
000000     IF FSORT-CAPITAL NOT < MONTO-TOPE-AUX
000000        ADD FSORT-CAPITAL        TO TOTAL-VEN-CENTR
000000        PERFORM FG2-LISTA-DETALLE
000000        ADD 1                    TO TOTAL-TOPE
000000     ELSE
000000        ADD FSORT-CAPITAL        TO TOTAL-VAR-CENTR
000000        ADD 1                    TO TOTAL-MENOR.
000000     PERFORM  FA-LEER-FSORT.
000000*
000000 FH1-TOTALES-CENTRAL.
000000     MOVE TOTAL-VAR-CENTR        TO LT-2-VARIOS
000000     WRITE REG-LISTADO FROM SC-LT-2  AFTER 2
000000     MOVE TOTAL-VEN-CENTR        TO LTV-2-VENCIM
000000     WRITE REG-LISTADO FROM SC-LTV-2 AFTER 1.
000000*
000000 FH1-TOTALES-BANCO.
000000     COMPUTE TOTAL-VEN-BANCO =
000000        TOTAL-VEN-CENTR + TOTAL-VEN-SUCUR +
000000        TOTAL-VAR-CENTR + TOTAL-VAR-SUCUR
000000     MOVE TOTAL-VEN-BANCO        TO  LTB-BANCO
000000     WRITE REG-LISTADO FROM SC-LTB   AFTER 3
000000     PERFORM FJ-CARGA-RESUMEN
000000     MOVE ZEROS                  TO TOTAL-VEN-BANCO
000000                                    TOTAL-VEN-CENTR
000000                                    TOTAL-VEN-SUCUR
000000                                    TOTAL-VAR-CENTR
000000                                    TOTAL-VAR-SUCUR.
000000*
000000 FG2-LISTA-DETALLE.
000000     IF CONT-LINEAS > 58
000000        PERFORM FI-TITULO.
000000     MOVE FSORT-CODOPER          TO LD-CODOPER
000000     PERFORM FM-UBICA-CLTE-RCC
000000     MOVE WR-GLS-NOMC            TO LD-NOMBRE-BENEF
000000     IF FSORT-OFICIN = 999
000000        MOVE 090                 TO RUTWTOFI-COD-OFIC
000000     ELSE
000000        MOVE FSORT-OFICIN        TO RUTWTOFI-COD-OFIC.
000000     PERFORM FG3-BUSCA-GLOSA-OFIC
000000     MOVE FSORT-CAPITAL          TO LD-CAPITAL
000000     WRITE REG-LISTADO FROM SC-LD    AFTER 1
000000     ADD 1                       TO CONT-LINEAS.
000000*
000000 FG3-BUSCA-GLOSA-OFIC.
000000     CALL 'RUTUTOFI' USING RUTWTOFI
000000     IF RUTWTOFI-RETURN-CODE = SPACES
000000        MOVE RUTWTOFI-GLS-DESC   TO LD-NOMBRE-SUCUR
000000     ELSE
000000        DISPLAY 'ERROR EN ACCESO TABLA OFI CODIGO RETORNO:'
000000                 RUTWTOFI-RETURN-CODE
000000        MOVE SPACES              TO LD-NOMBRE-SUCUR
000000        MOVE 1 TO SW-MENSAJ.
000000*
000000 FI-TITULO.
000000     ADD 1                       TO EX-CONTAPAG
000000     MOVE EX-CONTAPAG            TO NUM-PAG
000000     WRITE REG-LISTADO FROM SC-T1    AFTER CANAL-1
000000     WRITE REG-LISTADO FROM SC-T2    AFTER 1
000000     WRITE REG-LISTADO FROM SC-T3    AFTER 3
000000     WRITE REG-LISTADO FROM SC-S1    AFTER 1
000000     WRITE REG-LISTADO FROM SC-S2    AFTER 3
000000     WRITE REG-LISTADO FROM SC-T5    AFTER 1
000000     WRITE REG-LISTADO FROM SC-S2    AFTER 1
000000     WRITE REG-LISTADO FROM SC-SPACE-LINE AFTER 1
000000     MOVE 12                     TO CONT-LINEAS.
000000*
000000 FJ-CARGA-RESUMEN.
000000     ADD 1                       TO TAB-ACM-CNT
000000     IF TAB-ACM-CNT > 200
000000        DISPLAY 'TABLA PARA RESUMEN EXEDIDA (200).'
000000        DISPLAY 'SE CANCELA EL PROCESO.        '
000000        MOVE 16                  TO SORT-RETURN
000000        MOVE 1                   TO SW-MENSAJ
000000     ELSE
000000        PERFORM FJ1-CARGA-RESUMEN.
000000*
000000 FJ1-CARGA-RESUMEN.
000000     SET IX-ACM1                 TO TAB-ACM-CNT
000000     IF MONEDA-AUX = '0999'
000000        MOVE '0900'              TO TB-ACM-CLAVE-MONED  (IX-ACM1)
000000     ELSE
000000        MOVE MONEDA-AUX          TO TB-ACM-CLAVE-MONED  (IX-ACM1).
000000     MOVE FECHA-AUX              TO TB-ACM-CLAVE-FECHA  (IX-ACM1)
000000     MOVE TOTAL-VAR-SUCUR        TO TB-ACM-VAR-SUCURSAL (IX-ACM1)
000000     MOVE TOTAL-VEN-SUCUR        TO TB-ACM-VEN-SUCURSAL (IX-ACM1)
000000     MOVE TOTAL-VAR-CENTR        TO TB-ACM-VAR-CENTRAL  (IX-ACM1)
000000     MOVE TOTAL-VEN-CENTR        TO TB-ACM-VEN-CENTRAL  (IX-ACM1)
000000     MOVE TOTAL-VEN-BANCO        TO TB-ACM-TOT-BANCO    (IX-ACM1).
000000*
000000 FM-UBICA-CLTE-RCC.
000000* CON EL CODIGO DE LA OPERACION VA A LA RCC PARA OBTENER EL CIC
000000* DEL CLIENTE Y CON ESTE VA A LA DBC PARA OBTENER LOS DATOS DE
000000* CLIENTE A IMPRIMIR.
000000     MOVE SPACES                 TO WR-GLS-NOMC
000000     MOVE 'REDKY'                TO REQ-CMD-RCC
000000     MOVE SPACES                 TO REQ-RETURN-CODE-RCC
000000     MOVE FSORT-KEY-IOPD         TO REQ-KEY-RCC-CIC
000000     CALL 'DBNTRY' USING UIB REQ-AREA-RCC REG-RCC ELM-LIS-RCC
000000     EVALUATE REQ-RETURN-CODE-RCC
000000        WHEN SPACES
000000           PERFORM FM1-BUSCA-CLIENTE-DBC
000000        WHEN '14'
000000           DISPLAY '** CLIENTE NO EXISTE EN RCC'
000000           PERFORM FM3-OPD-SIN-CLIENTE
000000        WHEN OTHER
000000           DISPLAY '* ERROR: REDKY TABLA RCC *'
000000           DISPLAY '* TABLA          : ' REQ-TBLNM-RCC
000000           DISPLAY '* CODIGO RETORNO : ' REQ-RETURN-CODE-RCC
000000           DISPLAY '* REQ. AREA      : ' REQ-AREA-RCC
000000           PERFORM FM3-OPD-SIN-CLIENTE
000000     END-EVALUATE.
000000*
000000 FM1-BUSCA-CLIENTE-DBC.
000000     MOVE 'REDKY'                TO REQ-CMD-DBC
000000     MOVE SPACES                 TO REQ-RETURN-CODE-DBC
000000     MOVE RCC-CIC-ICLI           TO REQ-KEY-DBC-ICLI
000000     CALL 'DBNTRY' USING UIB REQ-AREA-DBC REG-DBC ELM-LIS-DBC
000000     EVALUATE REQ-RETURN-CODE-DBC
000000        WHEN SPACES
000000           PERFORM FM2-COMPACTA-NOMBRE
000000        WHEN '14'
000000           DISPLAY '** CLIENTE NO EXISTE EN DBC'
000000           DISPLAY 'RCC-CIC-ICLI = ' RCC-CIC-ICLI
000000           PERFORM FM3-OPD-SIN-CLIENTE
000000        WHEN OTHER
000000           DISPLAY '* ERROR: REDKY TABLA DBC *'
000000           DISPLAY '* TABLA          : ' REQ-TBLNM-DBC
000000           DISPLAY '* CODIGO RETORNO : ' REQ-RETURN-CODE-DBC
000000           DISPLAY '* REQ. AREA      : ' REQ-AREA-DBC
000000           PERFORM FM3-OPD-SIN-CLIENTE
000000     END-EVALUATE.
000000*
000000 FM2-COMPACTA-NOMBRE.
000000     MOVE DBC-GLS-APAT           TO RUTWCMNN-INP-APAT
000000     MOVE DBC-GLS-AMAT           TO RUTWCMNN-INP-AMAT
000000     MOVE DBC-GLS-NOMB           TO RUTWCMNN-INP-NOMB
000000     CALL 'RUTUCMNN' USING RUTWCMNN
000000     MOVE RUTWCMNN-OUT-NOMB      TO WR-GLS-NOMC.
000000*
000000 FM3-OPD-SIN-CLIENTE.
000000     MOVE 'OPERACION SIN CLIENTE'     TO WR-GLS-NOMC
000000     MOVE 1                           TO SW-MENSAJ
000000     DISPLAY '* OPD SIN CLIENTE:  ' FSORT-KEY-IOPD '  '
000000             'SERIAL: ' FSORT-CIC-ISER
000000     DISPLAY ' '.
000000*
000000 FZZ-FIN-SECC.
000000     EXIT.
000000     EJECT
000000*
000000*
000000*
000000 G-LISTA-RESUMEN SECTION.
000000*
000000 GA-CTRL-PROC.
000000     IF TAB-ACM-CNT > 0
000000        PERFORM GB-ORDENA-TABLA
000000        MOVE 99                  TO CONT-LINEAS
000000        MOVE 0                   TO EX-CONTAPAG
000000        PERFORM GC-LISTA-RESUMEN
000000           VARYING IX-ACM1 FROM 1 BY 1 UNTIL
000000              IX-ACM1 > TAB-ACM-CNT.
000000     GO TO GZZ-FIN-SECC.
000000*
000000 GB-ORDENA-TABLA.
000000     PERFORM GB1-ORDENA-TABLA
000000        VARYING IX-ACM1 FROM 1 BY 1 UNTIL
000000           IX-ACM1 = TAB-ACM-CNT
000000        AFTER   IX-ACM2 FROM 1 BY 1 UNTIL
000000           IX-ACM2 > TAB-ACM-CNT.
000000*
000000 GB1-ORDENA-TABLA.
000000     IF IX-ACM2 = 1
000000        SET IX-ACM2              TO IX-ACM1
000000        SET IX-ACM2              UP BY 1.
000000     IF TB-ACM-CLAVE (IX-ACM1) > TB-ACM-CLAVE (IX-ACM2)
000000        MOVE TAB-ACM (IX-ACM1)   TO TAB-ACM-AUX
000000        MOVE TAB-ACM (IX-ACM2)   TO TAB-ACM (IX-ACM1)
000000        MOVE TAB-ACM-AUX         TO TAB-ACM (IX-ACM2).
000000*
000000 GC-LISTA-RESUMEN.
000000     IF CONT-LINEAS > 45
000000        PERFORM GD-IMPRIME-TITULO.
000000     IF TB-ACM-CLAVE-FECHA (IX-ACM1) NOT = TAB-FECHA-AUX
000000        MOVE TB-ACM-CLAVE-FECHA (IX-ACM1) TO FECHA-VENCIMIENTO
000000                                             TAB-FECHA-AUX
000000        MOVE SS-VENC             TO RES-REC-SS
000000        MOVE AA-VENC             TO RES-REC-AA
000000        MOVE MM-VENC             TO RES-REC-MM
000000        MOVE DD-VENC             TO RES-REC-DD
000000        WRITE REG-LISTADO FROM RES-DET1 AFTER 2
000000        ADD 2                    TO CONT-LINEAS
000000     END-IF.
000000*
000000     EVALUATE TB-ACM-CLAVE-MONED (IX-ACM1)
000000        WHEN '0900'
000000           MOVE 'I.    PESOS > ' TO RES-MONEDA
000000           MOVE MONTO-TOPE-PESO  TO RES-TOPE
000000        WHEN '0998'
000000           MOVE 'II.   U.F.  > ' TO RES-MONEDA
000000           MOVE MONTO-TOPE-UF    TO RES-TOPE
000000        WHEN OTHER
000000           MOVE 'III.  US$   > ' TO RES-MONEDA
000000           MOVE MONTO-TOPE-DOLAR TO RES-TOPE
000000     END-EVALUATE.
000000*
000000     MOVE TB-ACM-VAR-SUCURSAL (IX-ACM1) TO LT-1-VARIOS
000000     MOVE TB-ACM-VEN-SUCURSAL (IX-ACM1) TO LTV-1-VENCIM
000000     MOVE TB-ACM-VAR-CENTRAL  (IX-ACM1) TO LT-2-VARIOS
000000     MOVE TB-ACM-VEN-CENTRAL  (IX-ACM1) TO LTV-2-VENCIM
000000     MOVE TB-ACM-TOT-BANCO    (IX-ACM1) TO LTB-BANCO
000000*
000000     WRITE REG-LISTADO FROM RES-DET2 AFTER 2
000000     WRITE REG-LISTADO FROM SC-LT-1  AFTER 2
000000     WRITE REG-LISTADO FROM SC-LTV-1 AFTER 1
000000     WRITE REG-LISTADO FROM SC-LT-2  AFTER 2
000000     WRITE REG-LISTADO FROM SC-LTV-2 AFTER 1
000000     WRITE REG-LISTADO FROM SC-LTB   AFTER 2
000000     ADD 10                      TO CONT-LINEAS.
000000*
000000 GD-IMPRIME-TITULO.
000000     ADD  1                      TO EX-CONTAPAG
000000     MOVE EX-CONTAPAG            TO NUM-PAG
000000     WRITE REG-LISTADO FROM SC-T1    AFTER CANAL-1
000000     WRITE REG-LISTADO FROM SC-T2    AFTER 1
000000     WRITE REG-LISTADO FROM SC-RES1  AFTER 3
000000     WRITE REG-LISTADO FROM SC-RES2  AFTER 1
000000     MOVE 6                      TO CONT-LINEAS.
000000*
000000 GZZ-FIN-SECC.
000000     EXIT.
000000     EJECT
