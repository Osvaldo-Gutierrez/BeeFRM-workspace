       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      DAPPBR06.
       AUTHOR.          BEE-TEAM.
       DATE-WRITTEN.    14-AGOSTO-1998

      * Programa que inicializa campos de RCC.
      *

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY DAPBRRCC.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWVIDD.
       COPY GNSBRTAB.
       COPY GNSBRMSG.

       COPY GNSWGSYS.
      *<<<< WSS
       01 WSS-CIC-IOPD.
          03 WSS-CAI-IOPD       VALUE SPACES           PIC X(4).
          03 WSS-IIC-IOPD       VALUE SPACES           PIC X(8).

      *Entidades  de GNS
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSBRMSC.

      *Entidades de GNS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'DAPPBR06' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

       LUP-MAIN.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.

      *Lee la primera operacion.
           ACCEPT WSS-CIC-IOPD.

      *Inicializa campos de RCC.
           PERFORM CLEAN-RCC.
       FIN-MAIN.
           GOBACK.

       COPY DAPBFRCC.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBGABT.
      *COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.

      *Entidades  de GNS
       COPY GNSBFMSC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
      *>>>>

       CLEAN-RCC SECTION.
       INI-CLEAN-RCC.
       CIC-PRO-RCC.
      * Se verifica el fin del proceso de inicializacion.
           IF WSS-CAI-IOPD = 'FIN'
              GO TO FIN-PRO-RCC.

      * Se lee el registro RCC.
           MOVE WSS-CIC-IOPD TO RCC-CIC-IOPD IN RCC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LEE-NXT-REG.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           PERFORM DAP-FIO-RCC.
           IF NOT ( FIO-STAT-OKS AND WSS-CIC-IOPD = RCC-CIC-IOPD IN RCC)
               PERFORM DSP-ERROR
               GO TO LEE-NXT-RCC.

      * Se toma RCC con control exclusivo.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT FIO-STAT-OKS
              DISPLAY '  '
              DISPLAY 'IMPOSIBLE TOMAR CON CONTROL EXCLUSIVO RCC'
              DISPLAY 'WSS-CIC-IOPD: ' WSS-CAI-IOPD IN WSS-CIC-IOPD '-'
                                       WSS-IIC-IOPD IN WSS-CIC-IOPD
              DISPLAY '  '
              GO TO LEE-NXT-RCC.

      * Se inicializan los campos de RCC.
           MOVE SPACES TO RCC-GLS-FLAG IN RCC.
           MOVE SPACES TO RCC-MSC-STAT IN RCC.
           MOVE 'I'    TO RCC-COD-STAT IN RCC.
           MOVE SPACES TO RCC-COD-RCOP IN RCC.
           MOVE 100    TO RCC-VAL-PRCO IN RCC.
           MOVE SPACES TO RCC-COD-COPD IN RCC.
           MOVE SPACES TO RCC-GLS-DISP IN RCC.

      *Grabando los cambios.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT FIO-STAT-OKS
               DISPLAY '  '
               DISPLAY 'ERROR AL GRABAR LA INICIALIZACION DE '
               DISPLAY 'WSS-CIC-IOPD: ' WSS-CAI-IOPD IN WSS-CIC-IOPD '-'
                                        WSS-IIC-IOPD IN WSS-CIC-IOPD
               DISPLAY '  '
           ELSE
               DISPLAY ' '
               DISPLAY 'WSS-CIC-IOPD: ' WSS-CAI-IOPD IN WSS-CIC-IOPD '-'
                                        WSS-IIC-IOPD IN WSS-CIC-IOPD
               DISPLAY 'INICIALIZADA OK'
               DISPLAY '    '.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LEE-NXT-REG.
       LEE-NXT-RCC.
           ACCEPT WSS-CIC-IOPD.
           GO TO CIC-PRO-RCC.

       FIN-PRO-RCC.
           EXIT.


       DSP-ERROR SECTION.
       INI-DSP-ERROR.
           IF FIO-CMND = FIO-GET-NLS
               DISPLAY '  '
               DISPLAY 'ERROR AL ACCESAR RCC'
               DISPLAY 'WSS-CIC-IOPD: ' WSS-CAI-IOPD IN WSS-CIC-IOPD '-'
                                        WSS-IIC-IOPD IN WSS-CIC-IOPD
               DISPLAY '  '.
       FIN-DSP-ERROR.
           EXIT.

