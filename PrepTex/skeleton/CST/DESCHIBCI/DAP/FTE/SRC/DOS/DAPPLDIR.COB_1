       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. DAPPLDIR.
       AUTHOR.     CECILIA PIZARRO.
      *REMARKS.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 30 DE MARZO DE 1998                                    *
      ******************************************************************
      ******************************************************************
      *                                                                *
      *  OBJETIVO :                                                    *
      *           - LISTA TODAS LAS DIRECCIONES ASOCIADAS A UN CLIENTE *
      *             DAP.
      *                                                                *
      *  INPUT    :                                                    *
      *             TABLA RCC
      *             TABLA DBC
      *             TABLA OPD
      *             TABLA OFI
      *  OUTPUT   :                                                    *
      *             INFORME CON LISTA DE DIRECCIONES                   *
      *                                                                *
      *  FECHA    : JUL/93.                                            *
      *                                                                *
      ******************************************************************
      *      MANTENCIONES.
      *      ==============
      *
      *      PROGRAMADOR : FORMAT 2000 INC.
      *      FECHA       : 20.02.1998
      *      CAMBIO      : SE APLICA TECNICA WINDOWING PARA CONVERSION
      *                      2000 COMPLIANT.
      ******************************************************************
       ENVIRONMENT DIVISION.
      *=====================
           SKIP1
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
           C01 IS CANAL-1
           DECIMAL-POINT IS COMMA.
           SKIP1
      *
       INPUT-OUTPUT SECTION.
      *=====================
       FILE-CONTROL.
           SELECT INFORME        ASSIGN TO DAPLLIS.

           SELECT ASORT          ASSIGN TO SORTWK01.

           SELECT DAPDOPD        ASSIGN TO DAPDOPD.
       DATA DIVISION.
      *==============
      *
       FILE SECTION.
      *=============

       FD  INFORME
           RECORD CONTAINS 132 CHARACTERS.
       01  REG-INFORME              PIC X(132).
      *
      *
       SD  ASORT.
       01  REG-ASORT.
           02 SOR-COD-OFIC                       PIC X(03).
           02 SOR-CIC-ISER                       PIC 9(12).
           02 SOR-RUT-NUM                        PIC 9(08).
           02 SOR-RUT-DIG                        PIC X(01).
           02 SOR-NUM-DIRE                       PIC 9(02).
           02 SOR-NOMBRE                         PIC X(30).
           02 SOR-DIRECCION                      PIC X(30).
           02 SOR-FONO                           PIC X(08).
           02 SOR-ANEXO                          PIC X(04).
           02 SOR-TDIR                           PIC X(01).
           02 SOR-COMUNA                         PIC X(04).
      *
       FD  DAPDOPD
           RECORDING MODE IS F
           LABEL RECORD STANDARD
           BLOCK CONTAINS    0 RECORDS.
       01  REG-DAPDOPD.
      *    COPYDD DAP-R-OPD.DAP-E-OPD00(PROD),02,D
      *                             EQUIVALENTE AL REGISTRO OPD
           02  DAP-E-OPD00.
      *                             OPERACION DEPOSITO A PLAZO
               04  OPD.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   06  OPD-GLS-FLAG PICTURE X(1).
      *                             IDENTIFICACION OPERACION DAP
                   06  OPD-KEY-IOPD.
      *                             COD. INT. COMP. OPERACION DAP
                       08  OPD-CIC-IOPD.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       10  OPD-CAI-IOPD
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       10  OPD-IIC-IOPD
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                   06  OPD-STP-ITRN.
      *                             FECHA TRANSACCION
                       08  OPD-FEC-FTRN
                                    PICTURE 9(8).
      *                             HORA TRANSACCION
                       08  OPD-HRA-HRTR
                                    PICTURE 9(6).
      *                             INDICADOR TIPO ACCION
                   06  OPD-COD-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   06  OPD-COD-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   06  OPD-COD-OTRN PICTURE X(4).
      *                             AUTOR TRANSACCION
                   06  OPD-COD-ATRN PICTURE X(12).
      *                             VALOR DE CAMBIO OPERACION DAP
                   06  OPD-COD-VCAM.
      *                             MISCELANEO TIPO VALOR
                       08  OPD-MSC-TVAL
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       08  OPD-COD-CVAL
                                    PICTURE X(3).
      *                             CODIGO TIPO CAMBIO
                       08  OPD-COD-TCAM
                                    PICTURE X(2).
      *                             CODIGO CLASE OPERACION DAP
                   06  OPD-COD-COPD.
      *                             CODIGO TIPO OPERACION
                       08  OPD-COD-TOPD
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       08  OPD-COD-AOPD
                                    PICTURE X(3).
      *                             CODIGO OFICINA OPERACION DAP
                   06  OPD-COD-OFIC PICTURE X(3).
      *                             RESPONSABLE MANTENCION OPERACION DAP
                   06  OPD-COD-EJEC PICTURE X(12).
      *                             COD. INT. COMP. SERIAL CDP
                   06  OPD-CIC-ISER.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  OPD-CAI-ISER
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  OPD-IIC-ISER
                                    PICTURE X(8).
      *                             FECHA CAPTACION REAL
                   06  OPD-FEC-FREA.
                       08  OPD-NUM-SREA
                                    PICTURE 9(2).
                       08  OPD-NUM-AREA
                                    PICTURE 9(2).
                       08  OPD-NUM-MREA
                                    PICTURE 9(2).
                       08  OPD-NUM-DREA
                                    PICTURE 9(2).
      *                             FECHA EMISION CONTABLE
                   06  OPD-FEC-FCTB.
                       08  OPD-NUM-SCTB
                                    PICTURE 9(2).
                       08  OPD-NUM-ACTB
                                    PICTURE 9(2).
                       08  OPD-NUM-MCTB
                                    PICTURE 9(2).
                       08  OPD-NUM-DCTB
                                    PICTURE 9(2).
      *                             FECHA INGRESO COMPUTACIONAL
                   06  OPD-FEC-FCMP.
                       08  OPD-NUM-SCMP
                                    PICTURE 9(2).
                       08  OPD-NUM-ACMP
                                    PICTURE 9(2).
                       08  OPD-NUM-MCMP
                                    PICTURE 9(2).
                       08  OPD-NUM-DCMP
                                    PICTURE 9(2).
      *                             MONTO CAPTACION
                   06  OPD-VAL-CAPT PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SALDO VALOR CAPTACION
                   06  OPD-VAL-SCAP PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             MONTO A PAGAR POR CAJA
                   06  OPD-VAL-CAJA PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             ANALISIS FERIADOS (S/N)
                   06  OPD-COD-AFER PICTURE X(1).
      *                             CONDICION GARANTIA
                   06  OPD-COD-GARA PICTURE X(1).
      *                             CODIGO UBICACION FISICA CDP
                   06  OPD-COD-UBFD.
                       08  OPD-COD-IUBF
                                    PICTURE X(3).
                       08  OPD-COD-CUBF
                                    PICTURE X(3).
                       08  OPD-COD-SUBF
                                    PICTURE X(3).
      *                             NUMERO PROXIMO VENCIMIENTO
                   06  OPD-NUM-IVEN PICTURE 9(3).
      *                             FECHA PROXIMO VENCIMIENTO
                   06  OPD-FEC-FPVC.
                       08  OPD-NUM-SPVC
                                    PICTURE 9(2).
                       08  OPD-NUM-APVC
                                    PICTURE 9(2).
                       08  OPD-NUM-MPVC
                                    PICTURE 9(2).
                       08  OPD-NUM-DPVC
                                    PICTURE 9(2).
      *                             CODIGO TIPO TASA INTERES
                   06  OPD-COD-TINT.
      *                             CODIGO TIPO TASA
                       08  OPD-COD-TIPT.
      *                             BASE CALCULO TASA INTERES
                       10  OPD-COD-BCTI
                                    PICTURE X(1).
      *                             PERIODO BASE TASA INTERES
                       10  OPD-COD-PBTI
                                    PICTURE X(1).
      *                             MODALIDAD CALCULO TASA INTERES
                       10  OPD-COD-MCTI.
      *                             BAJO PERIODO BASE TASA
                       12  OPD-COD-BPBT
                                    PICTURE X(1).
      *                             SOBRE PERIODO BASE TASA
                       12  OPD-COD-SPBT
                                    PICTURE X(1).
      *                             CODIGO VALOR TASA INTERES
                       08  OPD-COD-CVTI
                                    PICTURE X(3).
      *                             TIPO FECHA PERIODO REPACTO
                       08  OPD-COD-TFPR
                                    PICTURE X(1).
      *                             NUMERO PERIODO REPACTO
                       08  OPD-NUM-PREP
                                    PICTURE 9(3).
      *                             UNIDAD TIEMPO OPD-NUM-PREP
                       08  OPD-MSC-PREP
                                    PICTURE X(1).
      *                             VALOR SPREAD
                   06  OPD-SGV-SPRD PICTURE S9(5)V9(4)
                                        COMPUTATIONAL.
      *                             VALOR TASA
                   06  OPD-SGV-TINT PICTURE S9(5)V9(4)
                                        COMPUTATIONAL.
      *                             RETENCION DOCUMENTO
                   06  OPD-NUM-RETD PICTURE 9(3).
      *                             UNIDAD TIEMPO OPD-NUM-RETD
                   06  OPD-IND-RETD PICTURE X(1).
      *                             IND DEVOLUCION DINERO DOC S/FONDOS
                   06  OPD-COD-DEVL PICTURE X(1).
      *                             INDICADOR CUSTODIA
                   06  OPD-COD-CUST PICTURE X(1).
      *                             CONDICION GARANTIA ( EN POD )
                   06  OPD-COD-GPOD PICTURE X(1).
      *                             SEPARACION ENTRE VENCIMIENTOS
                   06  OPD-NUM-SEVE PICTURE 9(4)
                                        COMPUTATIONAL.
      *                             UNIDAD DE TIEMPO OPD-NUM-SEVE
                   06  OPD-IND-SEVE PICTURE X(1).
      *                             DURACION VENCIMIENTOS
                   06  OPD-NUM-DURV PICTURE 9(4)
                                        COMPUTATIONAL.
      *                             UNIDAD DE TIEMPO OPD-NUM-DURV
                   06  OPD-IND-DURV PICTURE X(1).
      *                             NUMERO VENCIMIENTOS NO LIQUIDADOS
                   06  OPD-NUM-VNLQ PICTURE 9(3).
      *                             NUMERO VENCIMIENTOS LIQUIDADOS
                   06  OPD-NUM-VSLQ PICTURE 9(3).
      *                             MODALIDAD DE RETIRO
                   06  OPD-COD-MORE PICTURE X(2).
      *                             MONTO O PORCENTAJE DEL RETIRO
                   06  OPD-SGV-MPRE PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR ORDEN NO PAGO
                   06  OPD-COD-IONP PICTURE X(1).
      *                             SITUACION CONTABLE
                   06  OPD-COD-SCTB PICTURE X(3).
      *                             INDICADOR RENOVABILIDAD
                   06  OPD-COD-RENO PICTURE X(1).
      *                             INDICADOR ENDOSABILIDAD
                   06  OPD-COD-ENDO PICTURE X(1).
      *                             VALOR REAJUSTES DEVENGADOS
                   06  OPD-VAL-READ PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR INTERESES DEVENGADOS
                   06  OPD-VAL-INTD PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             USUARIO QUE AUTORIZA TASA ESPECIAL
                   06  OPD-COD-EATE PICTURE X(12).
      *                             TASA PERIODO
                   06  OPD-VAL-SINT PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             FECHA DEVENGO ( ULTIMO PAGO TOTAL IN
                   06  OPD-FEC-FDEV.
                       08  OPD-NUM-SDEV
                                    PICTURE 9(2).
                       08  OPD-NUM-ADEV
                                    PICTURE 9(2).
                       08  OPD-NUM-MDEV
                                    PICTURE 9(2).
                       08  OPD-NUM-DDEV
                                    PICTURE 9(2).
      *                             FECHA TERMINO DE LA OPERACION
                   06  OPD-FEC-FTER.
                       08  OPD-NUM-STER
                                    PICTURE 9(2).
                       08  OPD-NUM-ATER
                                    PICTURE 9(2).
                       08  OPD-NUM-MTER
                                    PICTURE 9(2).
                       08  OPD-NUM-DTER
                                    PICTURE 9(2).
      *                             TIPO CERTIF DAP
                   06  OPD-COD-TCDP PICTURE X(3).
      *                             CODIGO RESCATE
                   06  OPD-COD-RESC PICTURE X(1).
      *                             CODIGO PLAZO PAGO RESCATE
                   06  OPD-COD-PLPA PICTURE X(1).
      *                             PLAZO RESCATE
                   06  OPD-NUM-PLRE PICTURE 9(3).
      *                             UNIDAD TIEMPO PLAZO RESCATE
                   06  OPD-IND-PLRE PICTURE X(1).
      *                             PERIODO NEGOCIACION TASA ESPECIAL
                   06  OPD-NUM-PNTE PICTURE 9(3).
      *                             UNIDAD TIEMPO OPD-NUM-PNTE
                   06  OPD-IND-PNTE PICTURE X(1).
      *                             PLAZO CONTABLE
                   06  OPD-COD-PLZO PICTURE X(2).
      *                             RESERVADO SAFE
                   06  OPD-GLS-SAFE PICTURE X(18).
      *                             FECHA DE CAPTACION ORIGINAL
                   06  OPD-FEC-FPCO.
                       08  OPD-NUM-SPCO
                                    PICTURE 9(2).
                       08  OPD-NUM-APCO
                                    PICTURE 9(2).
                       08  OPD-NUM-MPCO
                                    PICTURE 9(2).
                       08  OPD-NUM-DPCO
                                    PICTURE 9(2).
      *                             PERIODO PRIMER VENCIMIENTO
                   06  OPD-NUM-PVEN PICTURE 9(5)
                                        COMPUTATIONAL-3.
      *                             UNIDAD TIEMPO OPD-NUM-PVEN
                   06  OPD-IND-PVEN PICTURE X(1).
      *                             NUMERO DE OPERACION QUE GENERO RENOV
                   06  OPD-CIC-GREN.
                       08  OPD-CAI-GREN
                                    PICTURE X(4).
                       08  OPD-IIC-GREN
                                    PICTURE X(8).
      *                             INDICADOR ABONO AUTOMATICO A CUENTA
                   06  OPD-COD-AACC PICTURE X(1).
      *                             NUMERO DE OPERACION ORIGINAL
                   06  OPD-CIC-ORIG.
                       08  OPD-CAI-ORIG
                                    PICTURE X(4).
                       08  OPD-IIC-ORIG
                                    PICTURE X(8).
      *                             MULTIPLES CLIENTES ?
                   06  OPD-IND-MCLI PICTURE X(1).
      *                             INGRESO NO LINEA ? ( S = ODB, N = OD
                   06  OPD-IND-IDIF PICTURE X(1).
      *                             MONTO CAPTACION EN PESOS
                   06  OPD-VAL-IPES PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR CUSTODIA ORIGINAL
                   06  OPD-COD-CUSO PICTURE X(1).
      *                             GLOSA DISPONIBLE
                   06  OPD-GLS-DISP PICTURE X(9).
      *    COPYDD DAP-R-VEN.DAP-E-VEN00(PROD),02,D
      *                             EQUIVALENTE AL REGISTRO VEN
           02  DAP-E-VEN00.
      *                             VENCIMIENTOS DAP
               04  VEN.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   06  VEN-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   06  VEN-KEY-IVEN.
      *                             COD. INT. COMP. OPERAC. DAP
                       08  VEN-CIC-IOPD.
      *                             CENTRO ASIGNAC. IDENTIFICACION
                       10  VEN-CAI-IOPD
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       10  VEN-IIC-IOPD
                                    PICTURE X(8).
      *                             NUM. IDENTIFICACION VENCIMIENTO
                       08  VEN-NUM-IVEN
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                   06  VEN-STP-ITRN.
      *                             FECHA TRANSACCION
                       08  VEN-FEC-FTRN
                                    PICTURE 9(8).
      *                             HORA TRANSACCION
                       08  VEN-HRA-HRTR
                                    PICTURE 9(6).
      *                             INDICADOR TIPO ACCION
                   06  VEN-COD-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   06  VEN-COD-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   06  VEN-COD-OTRN PICTURE X(4).
      *                             AUTOR TRANSACCION
                   06  VEN-COD-ATRN PICTURE X(12).
      *                             FECHA VENCIMIENTO
                   06  VEN-FEC-FVEN.
                       08  VEN-NUM-SVEN
                                    PICTURE 9(2).
                       08  VEN-NUM-AVEN
                                    PICTURE 9(2).
                       08  VEN-NUM-MVEN
                                    PICTURE 9(2).
                       08  VEN-NUM-DVEN
                                    PICTURE 9(2).
      *                             VALOR CAPITAL VENCIMIENTO ORIGINAL
                   06  VEN-VAL-CAPI PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SALDO VALOR CAPITAL VCMTO.
                   06  VEN-VAL-SCAP PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INT DEVENGADOS NO LIQUIDADOS
                   06  VEN-VAL-IDNI PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR FINAL VENCIMIENTO
                   06  VEN-VAL-FINA PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SALDO VALOR FINAL VCMTO.
                   06  VEN-VAL-SFIN PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SITUACION CONTABLE
                   06  VEN-COD-SCTB PICTURE X(3).
      *                             GLOSA DISPONIBLE
                   06  VEN-GLS-DISP PICTURE X(20).
      *
       WORKING-STORAGE SECTION.
      *========================

       01  WE-EXTERNAS.
           03 WE-TIME.
              05 WE-TIME-HMS.
                10  WE-TIME-HH         PIC 99.
                10  WE-TIME-MM         PIC 99.
                10  WE-TIME-SS         PIC 99.
              05  WE-TIME-MI         PIC 99.
       01  WS-CONTADORES.
           03 WR-FIN-SORT            PIC X(02) VALUE 'NO'.
           03 WA-SELEC               PIC 9(08) VALUE 0.
           03 WS-LEI-DAP             PIC 9(06) VALUE 0.
           03 WS-NUM-DIR             PIC 9(02) VALUE 0.
           03 WS-DUPLICADO           PIC 9(06) VALUE 0.
           03 WS-GRA-RCC             PIC 9(06) VALUE 0.
           03 WS-LIN-LREC            PIC 9(02) VALUE 0.
           03 WS-PAG-LREC            PIC 9(02) VALUE 0.
           03 WS-NUM-ACT-CIC         PIC 9(06) VALUE 0.
           03 FS-DAPDOPD             PIC 9(01) VALUE 0.
           03 CNT-DAPDOPD-L          PIC 9(08) VALUE 0.

       01  WS-VARIABLES.
           03 WA-LEIDOS-RCC                 PIC 9(8) VALUE 0.
           03 WR-TABLA-ERR                  PIC X(4).
           03 WR-MENSAJE                    PIC X(10).
           03 WR-CODIGO                     PIC X(2).
           03 WS-CIC-OPD.
              10 FILLER              PIC X VALUE 'Z'.
              10 WS-CIC-CLAVE        PIC 9(11).
           03 WS-NOMBRE              PIC X(30) VALUE SPACES.
           03 SW-SELEC               PIC X(02) VALUE 'NO'.
           03 WS-CLAVE               PIC 9(12) VALUE 0.
           03 WS-RUTNUM              PIC 9(08) VALUE 0.
           03 WS-RUTDIG              PIC X(01).
           03 AUX-OFICINA            PIC 9(03) VALUE 0.
           03 AUX-CIC-ICLI           PIC X(12) VALUE SPACES.
           03 AUX-CIC-ISER           PIC X(12) VALUE SPACES.
           03 AUX-RUT                PIC 9(08) VALUE ZEROS.
           03 SW-ERROR               PIC 9(01) VALUE 0.
           03 FIN-MAEDAPL            PIC X(02) VALUE 'NO'.
           03 WS-IND-CTROL-EXC-CIC   PIC X(02).
           03 WS-IND-HAY-REL         PIC X(02).
           03 WS-RCC-RETURN-CODE     PIC X(02).
           03 WS-IND-NOMC            PIC X(04) VALUE SPACES.
           03 BLANCO                 PIC X(12) VALUE SPACES.
           03 FS-MAEDAPL             PIC 9(02).
           03 WS-IND-ERRO            PIC 9(01).
           03 WS-IND-ELI             PIC 9(01) VALUE 0.
           03 WS-IND-RECH            PIC X(02).
           03 WS-IND-WRTE            PIC X(02).
           03 WS-CAPTA-SAMD.
              05 WS-CAPTA-SS         PIC X(02).
              05 WS-CAPTA-AA         PIC X(02).
              05 WS-CAPTA-MM         PIC X(02).
              05 WS-CAPTA-DD         PIC X(02).
           03 WS-VENCI-SAMD.
              05 WS-VENCI-SS         PIC X(02).
              05 WS-VENCI-AA         PIC X(02).
              05 WS-VENCI-MM         PIC X(02).
              05 WS-VENCI-DD         PIC X(02).
           03 WS-FECHA-SAMD.
              05 WS-FECHA-SS         PIC X(02).
              05 WS-FECHA-AA         PIC X(02).
              05 WS-FECHA-MM         PIC X(02).
              05 WS-FECHA-DD         PIC X(02).
           03 WS-NUM-ICIC            PIC 9(08).
           03 WS-SUCUR               PIC 9(03).
           03 WS-MCTE-SUCUR-AUX      PIC 9(03) VALUE 0.

       01  W-PARAMETRO.
           03 FILLER                 PIC X  VALUE SPACES.
           03 WP-DESCRIP             PIC X(20).
           03 WP-NOMBRE              PIC X(8).
           03 WP-FECHA.
              05 WP-FECHA-DD         PIC X(02).
              05 FILLER              PIC X(01).
              05 WP-FECHA-MM         PIC X(02).
              05 FILLER              PIC X(01).
              05 WP-FECHA-SS         PIC X(02).
              05 WP-FECHA-AA         PIC X(02).
              05 FILLER              PIC X(6).
              05 WP-EJECUTIVO        PIC X(08).

000000*
       01  WR-LINEA-TITULO.
           05 WR-LINEA01.
              10 FILLER           PIC X(018) VALUE 'BANCO CREDITO   IN'.
              10 FILLER           PIC X(009) VALUE 'VERSIONES'.
              10 FILLER           PIC X(018) VALUE '                 P'.
              10 FILLER           PIC X(011) VALUE 'GM:DAPPLDIR'.
              10 FILLER           PIC X(038) VALUE ALL ' '.
              10 FILLER           PIC X(004) VALUE 'PAG:'.
              10 WR-LA01-PAG      PIC ZZZ9.
           05 WR-LINEA02.
              10 FILLER           PIC X(018) VALUE 'SISTEMA DEPOSITOS'.
              10 FILLER           PIC X(007) VALUE 'A PLAZO'.
              10 FILLER           PIC X(069) VALUE ALL ' '.
              10 FILLER           PIC X(006) VALUE 'FECHA:'.
              10 WR-LA02-DD       PIC 99.
              10 FILLER           PIC X(001) VALUE ALL '-'.
              10 WR-LA02-MM       PIC 99.
              10 FILLER           PIC X(001) VALUE ALL '-'.
              10 WR-LA02-AA       PIC 99.
           05 WR-LINEA03.
              10 FILLER           PIC X(008) VALUE 'OFICINA:'.
              10 WR-LA03-OFIC     PIC X(30).
           05 WR-LINEA04.
              10 FILLER           PIC X(045) VALUE ALL ' '.
              10 FILLER           PIC X(018) VALUE 'LISTADO DE DIRECCI'.
              10 FILLER           PIC X(017) VALUE 'ONES CLIENTES DAP'.
           05 WR-LINEA05.
              10 FILLER           PIC X(045) VALUE ALL ' '.
              10 FILLER           PIC X(035) VALUE ALL '-'.
           05 WR-LINEA06.
              10 FILLER           PIC X(131) VALUE ALL '-'.
           05 WR-LINEA07.
              10 FILLER           PIC X(012) VALUE '  SERIAL    '.
              10 FILLER           PIC X(007) VALUE '  R.U.T'.
              10 FILLER           PIC X(018) VALUE '            N O M'.
              10 FILLER           PIC X(018) VALUE 'B R E'.
              10 FILLER           PIC X(006) VALUE 'NUMERO'.
              10 FILLER           PIC X(018) VALUE '              DIRE'.
              10 FILLER           PIC X(018) VALUE 'CCION           TI'.
              10 FILLER           PIC X(018) VALUE 'PO    FONO       C'.
              10 FILLER           PIC X(005) VALUE 'OMUNA'.
           05 WR-LINEA08.
              10 FILLER           PIC X(031) VALUE ALL ' '.
              10 FILLER           PIC X(013) VALUE 'C L I E N T E'.
              10 FILLER           PIC X(018) VALUE '           DIRECCI'.
              10 FILLER           PIC X(002) VALUE 'ON'.
              10 FILLER           PIC X(031) VALUE ALL ' '.
              10 FILLER           PIC X(004) VALUE 'DIR.'.

      *------------>   IDEM A WR-LINEA06
           05 WR-LINEA09.
              10 FILLER           PIC X(001) VALUE ALL ' '.
              10 WR-LA09-SERIAL   PIC X(12).
              10 FILLER           PIC X(001) VALUE ALL ' '.
              10 WR-LA09-RUTN     PIC ZZZZZZZ9.
              10 FILLER           PIC X(001) VALUE ALL '-'.
              10 WR-LA09-RUTD     PIC X(001).
              10 FILLER           PIC X(003) VALUE ALL ' '.
              10 WR-LA09-NOMBRE   PIC X(30).
           05 WR-LINEA10.
              10 FILLER           PIC X(054) VALUE ALL ' '.
              10 WR-LA10-NDIR     PIC 9(002).
              10 FILLER           PIC X(005) VALUE ALL ' '.
              10 WR-LA10-DIRE     PIC X(30).
              10 FILLER           PIC X(005) VALUE ALL ' '.
              10 WR-LA10-TDIR     PIC X.
              10 FILLER           PIC X(002) VALUE ALL ' '.
              10 WR-LA10-FONO     PIC X(08).
              10 FILLER           PIC X(001) VALUE ALL '-'.
              10 WR-LA10-ANXO     PIC X(04).
              10 FILLER           PIC X(001) VALUE ALL ' '.
              10 WR-LA10-COMUNA   PIC X(12).
      *
000271     COPY RTNWCALE.
000271     COPY RUTWTSGC.
000271     COPY RUTWTOFI.
000271     COPY RUTWTTAB.
000000*
      ******************************************************************
      *      USER INFORMATION BLOCK                                    *
      ******************************************************************
      *
       01  UIB.
           05 FILLER                 PIC X(32) VALUE 'DAPPLDIR'.
      *
      ******************************************************************
      *      REQUEST AREA                                              *
      ******************************************************************
      *
       01  REQ-DBC-AREA.
           02 REQ-DBC-CMD              PIC X(5).
           02 REQ-DBC-TBLNM            PIC X(3).
           02 REQ-DBC-KEYNM            PIC X(5).
           02 REQ-DBC-RETURN-CODE      PIC X(2) VALUE SPACES.
           02 REQ-DBC-INT-RTN-CD       PIC X(1).
           02 REQ-DBC-DBID             PIC S9(4) COMP VALUE +100.
           02 REQ-DBC-TBLID            PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-DBC-COUNT-MAX        PIC S9(4) COMP.
           02 REQ-DBC-IO-COUNT         PIC S9(4) COMP.
           02 FILLER               PIC X(22).
           02 REQ-DBC-KEY-VALUE        PIC X(24).
           02 REQ-RDBC-KEY-VALUE REDEFINES REQ-DBC-KEY-VALUE.
              03 REQ-DBC-NRO-RUT   PIC 9(08).
              03 REQ-DBC-EXT-RUT   PIC X(04).
              03 FILLER            PIC X(12).

       01  REQ-RCD-AREA.
           02 REQ-RCD-CMD              PIC X(5).
           02 REQ-RCD-TBLNM            PIC X(3).
           02 REQ-RCD-KEYNM            PIC X(5).
           02 REQ-RCD-RETURN-CODE      PIC X(2) VALUE SPACES.
           02 REQ-RCD-INT-RTN-CD       PIC X(1).
           02 REQ-RCD-DBID             PIC S9(4) COMP VALUE +100.
           02 REQ-RCD-TBLID            PIC X(7).
           02 FILLER                   PIC X(25).
           02 REQ-RCD-COUNT-MAX        PIC S9(4) COMP.
           02 REQ-RCD-IO-COUNT         PIC S9(4) COMP.
           02 FILLER                   PIC X(22).
           02 REQ-RCD-KEY-VALUE        PIC X(24).
           02 REQ-RRCD-KEY-VALUE REDEFINES REQ-RCD-KEY-VALUE.
              03 REQ-DIR-CIC           PIC X(12).
              03 REQ-DIR-NUM           PIC X(02).
              03 FILLER                PIC X(10).
      *
       01  REQ-AREA.
           02 REQ-CMD              PIC X(5).
           02 REQ-TBLNM            PIC X(3).
           02 REQ-KEYNM            PIC X(5).
           02 REQ-RETURN-CODE      PIC X(2) VALUE SPACES.
           02 REQ-INT-RTN-CD       PIC X(1).
           02 REQ-DBID             PIC S9(4) COMP VALUE +370.
           02 REQ-TBLID            PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-COUNT-MAX        PIC S9(4) COMP.
           02 REQ-IO-COUNT         PIC S9(4) COMP.
           02 FILLER               PIC X(22).
           02 REQ-KEY-VALUE.
              03 REQ-RCC-Z         PIC X     VALUE 'Z'.
              03 REQ-RCC-CLAVE     PIC 9(11).
              03 FILLER            PIC X(12).

      *
       01  REQ-AREA-RCC.
           02 REQ-COMAN-RCC        PIC X(05).
           02 REQ-TBLNM-RCC        PIC X(03)  VALUE 'RCC'.
           02 REQ-KEYNM-RCC        PIC X(05)  VALUE 'RCC01'.
           02 REQ-RTNCD-RCC        PIC X(02)  VALUE SPACES.
           02 REQ-INRCD-RCC        PIC X(01).
           02 REQ-DBIDE-RCC        PIC S9(4)  COMP VALUE +370.
           02 REQ-TBLID-RCC        PIC X(07).
           02 FILLER               PIC X(25).
           02 REQ-CTMAX-RCC        PIC S9(4)  COMP.
           02 REQ-IOCNT-RCC        PIC S9(4)  COMP.
           02 FILLER               PIC X(22).
           02 REQ-KYVAL-RCC.
              03 REQ-CLAVE-RCC     PIC X(12).
      ******************************************************************
      *                   WORK AREA                                    *
      ******************************************************************
      *
       01  REG-DBC.
      *    COPYDD DGC-R-DBC.DGC-E-DBC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DBC
           02  DGC-E-DBC00.
      *                             DATOS BASICOS DEL CLIENTE
               03  DBC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DBC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DBC-KEY-IREG.
      *                             IDENTIFICACION DATOS BASICOS CLIENTE
                       05  DBC-KEY-IDBC.
      *                             COD. INT. COMP. CLIENTE
                       06  DBC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DBC-CAI-ICLI.
                       08  DBC-COD-TCLI
                                    PICTURE X(1).
                       08  DBC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DBC-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DBC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DBC-FEC-FTRN.
                       07  DBC-NUM-STRN
                                    PICTURE 9(2).
                       07  DBC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DBC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DBC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DBC-HRA-HRTR.
                       07  DBC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DBC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DBC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DBC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DBC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DBC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DBC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DBC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DBC-COD-ATRN PICTURE X(12).
      *                             KEY RUT CLIENTE + INDICADOR O CALIFI
                   04  DBC-IDC-ICLI.
      *                             RUT CLIENTE
                       05  DBC-NUM-ICLI
                                    PICTURE X(8).
      *                             INDICADOR TIPO RUT
                       05  DBC-IND-ICLI
                                    PICTURE X(1).
      *                             EXTENSION DEL RUT
                       05  DBC-GLS-ICLI
                                    PICTURE X(3).
      *                             KEY DIGITO VERIFICADOR DEL RUT
                   04  DBC-VRF-ICLI PICTURE X(1).
      *                             KEY NOMBRE CLIENTE GENERICO (PERSONA
                   04  DBC-GLS-NOMC.
                       05  DBC-GLS-APAT
                                    PICTURE X(25).
                       05  DBC-GLS-AMAT
                                    PICTURE X(25).
                       05  DBC-GLS-NOMB
                                    PICTURE X(25).
      *                             SOUNDEX DEL NOMBRE DE CLIENTE
                   04  DBC-SNX-NOMC.
                       05  DBC-SNX-APAT
                                    PICTURE X(3).
                       05  DBC-SNX-AMAT
                                    PICTURE X(3).
                       05  DBC-SNX-NOMB
                                    PICTURE X(3).
      *                             NUMERO DE DIRECCION DE ENVIO CORRESP
                   04  DBC-NUM-DCOR PICTURE 9(2).
      *                             OPR IND TIPO CLIENTE ( PERSONA O EMP
                   04  DBC-IND-TICL PICTURE X(1).
      *                             TIPO CLIENTE (POTENCIAL,NO CLIENTE,G
                   04  DBC-COD-TICL PICTURE X(2).
      *                             CODIGO CLASIFICACION COMERCIAL
                   04  DBC-COD-CLCM PICTURE X(2).
      *                             RCM CODIGO DEL EJECUTIVO ENCARGADO D
                   04  DBC-COD-EJEC PICTURE X(12).
      *                             OPR CODIGO DE OFICINA DONDE OPERA EL
                   04  DBC-COD-OFIC PICTURE X(3).
      *                             RCM INDICADOR SI OPERA EN OTRA OFICI
                   04  DBC-IND-OOFI PICTURE X(1).
      *                             EXT CODIGO ACTIVIDAD ECONOMICA
                   04  DBC-COD-ACTI PICTURE X(9).
      *                             EXT ORIGEN Y DESTINO SECT (COMP.INST
                   04  DBC-COD-ODSE PICTURE X(3).
      *                             INF FECHA INGRESO AL PLAN
                   04  DBC-FEC-FPLN.
                       05  DBC-NUM-SPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-APLN
                                    PICTURE 9(2).
                       05  DBC-NUM-MPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-DPLN
                                    PICTURE 9(2).
      *                             CODIGO DE SEGMENTO
                   04  DBC-COD-SETO PICTURE X(5).
      *                             PERIODO DE SEGMENTO (SSAAMM)
                   04  DBC-PDO-SETO PICTURE X(6).
      *                             INF INDICADOR DE MULTAS BANCO CENTRA
                   04  DBC-IND-MUBC PICTURE X(1).
      *                             INF INDICADOR DE JUICIOS BANCO CENTR
                   04  DBC-IND-JUBC PICTURE X(1).
      *                             EXT CODIGO ESTADO CLIENTE ( COMO DEU
                   04  DBC-MSC-SCLI PICTURE X(1).
      *                             FECHA ESTADO CLIENTE
                   04  DBC-FEC-FSCL.
                       05  DBC-NUM-SSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-ASCL
                                    PICTURE 9(2).
                       05  DBC-NUM-MSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-DSCL
                                    PICTURE 9(2).
      *                             CODIGO DE BLOQUEO DEL CLIENTE
                   04  DBC-COD-BLOC PICTURE X(2).
      *                             NUMERO TOTAL DE DIRECCIONES
                   04  DBC-NUM-TDIR PICTURE 9(2).
      *                             NUMERO TOTAL DE COMENTARIOS
                   04  DBC-NUM-TCMT PICTURE 9(3).
      *                             FECHA INICIO OPERACION
                   04  DBC-FEC-FIOP.
                       05  DBC-NUM-SIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-AIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DIOP
                                    PICTURE 9(2).
      *                             FECHA TERMINO OPERACION
                   04  DBC-FEC-FTOP.
                       05  DBC-NUM-STOP
                                    PICTURE 9(2).
                       05  DBC-NUM-ATOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MTOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DTOP
                                    PICTURE 9(2).
      *                             NUMERO OPERACIONES FECHA TERMINO NUL
                   04  DBC-NUM-OFTN PICTURE 9(3).
      *                             FECHA INGRESO DE DATOS A LA BASE DE
                   04  DBC-FEC-FINP.
                       05  DBC-NUM-SINP
                                    PICTURE 9(2).
                       05  DBC-NUM-AINP
                                    PICTURE 9(2).
                       05  DBC-NUM-MINP
                                    PICTURE 9(2).
                       05  DBC-NUM-DINP
                                    PICTURE 9(2).

       01  REG-RCD.
      *    COPYDD DGC-R-RCD.DGC-E-RCD00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RCD
           02  DGC-E-RCD00.
      *                             RELACION CLIENTE DIRECCIONES
               03  RCD.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RCD-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  RCD-KEY-IREG.
      *                             IDENTIFICACION RELACION CLIENTE DIRE
                       05  RCD-KEY-IRCD.
      *                             COD. INT. COMP. CLIENTE
                       06  RCD-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RCD-CAI-ICLI.
                       08  RCD-COD-TCLI
                                    PICTURE X(1).
                       08  RCD-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RCD-IIC-ICLI
                                    PICTURE X(8).
      *                             NUMERO DIRECCION
                       06  RCD-NUM-DIRE
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  RCD-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RCD-FEC-FTRN.
                       07  RCD-NUM-STRN
                                    PICTURE 9(2).
                       07  RCD-NUM-ATRN
                                    PICTURE 9(2).
                       07  RCD-NUM-MTRN
                                    PICTURE 9(2).
                       07  RCD-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RCD-HRA-HRTR.
                       07  RCD-NUM-HHTR
                                    PICTURE 9(2).
                       07  RCD-NUM-MMTR
                                    PICTURE 9(2).
                       07  RCD-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  RCD-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RCD-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  RCD-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RCD-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RCD-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  RCD-COD-ATRN PICTURE X(12).
      *                             TIPO DIRECCION
                   04  RCD-MSC-TDIR PICTURE X(1).
      *                             ESTADO DIRECCION ( MALA, VERIFICADA,
                   04  RCD-MSC-SDIR PICTURE X(1).
      *                             FECHA DE VERIFICACION
                   04  RCD-FEC-FVRF.
                       05  RCD-NUM-SVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-AVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-MVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-DVRF
                                    PICTURE 9(2).
      *                             RCM DESCRIPCION DE LA DIRECCION
                   04  RCD-GLS-DIRE PICTURE X(60).
      *                             RCM CODIGO DE LUGAR
                   04  RCD-COD-LUGA PICTURE X(4).
      *                             TELEFONO DE LA DIRECCION
                   04  RCD-GLS-FONO.
                       05  RCD-NUM-FONO
                                    PICTURE X(8).
                       05  RCD-NUM-ANXO
                                    PICTURE X(4).
      *                             CODIGO POSTAL
                   04  RCD-COD-POST PICTURE X(7).
      *                             DISPONIBLE
                   04  RCD-GLS-DISP PICTURE X(18).

       01  REG-RCC.
      *    COPYDD DAP-R-RCC.DAP-E-RCC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RCC
           02  DAP-E-RCC00.
      *                             RELACION CLIENTE CAPTACION
               03  RCC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RCC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  RCC-KEY-IREG.
      *                             IDENTIFICACION RELACION CLIENTE OPER
                       05  RCC-KEY-IRCC.
      *                             COD. INT. COMP. CLIENTE
                       06  RCC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RCC-CAI-ICLI
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RCC-IIC-ICLI
                                    PICTURE X(8).
      *                             IDENTIFICACION OPERACION DAP
                       06  RCC-KEY-IOPD.
      *                             COD. INT. COMP. OPERACION
                       07  RCC-CIC-IOPD.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  RCC-CAI-IOPD
                                    PICTURE X(4).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  RCC-IIC-IOPD
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  RCC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RCC-FEC-FTRN
                                    PICTURE 9(8).
      *                             HORA TRANSACCION
                       06  RCC-HRA-HRTR
                                    PICTURE 9(6).
      *                             INDICADOR TIPO ACCION
                   04  RCC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RCC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  RCC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RCC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RCC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  RCC-COD-ATRN PICTURE X(12).
      *                             CODIGO STATUS
                   04  RCC-COD-STAT PICTURE X(3).
      *                             COD RELACION CLIENTE OPERACION
                   04  RCC-COD-RCOP PICTURE X(3).
      *                             NUMERO DE DIRECCION
                   04  RCC-NUM-DIRE PICTURE 9(2).
      *                             PORCENTAJE RELACION
                   04  RCC-VAL-PRCO PICTURE 9(3)V9(6)
                                        COMPUTATIONAL.
      *                             CODIGO CLASE OPERACION
                   04  RCC-COD-COPD.
      *                             CODIGO TIPO OPERACION
                       05  RCC-COD-TOPD
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       05  RCC-COD-AOPD
                                    PICTURE X(3).
      *                             DISPONIBLE
                   04  RCC-GLS-DISP PICTURE X(17).

      ******************************************************************
      *                 ELEMENT LIST                                   *
      ******************************************************************
      *
       01  ELEM-LIST.
           03 ELEM-1         PIC X(05).
           03 ELEM-SEC       PIC X(01).
           03 FILLER         PIC X(05) VALUE SPACES.
       01  ELM-LIS-RCC.
           03 ELEM-1-RCC     PIC X(05) VALUE 'RCC00'.
           03 ELEM-SEC-RCC   PIC X(01).
           03 FILLER         PIC X(05) VALUE SPACES.
      *-----------------------------------------------------------------
      *
           COPY RLOVR001.

       PROCEDURE DIVISION.
      *===================
           ENTRY 'DBMSCBL'.
       AA-INICIO.
           PERFORM B-INICIAR.
       AB-PROCESO.
           IF SW-ERROR = 0
              PERFORM C-PROCESAR
           END-IF.
       AC-FIN.
           PERFORM D-TERMINAR.
       AZ-FIN-PROGRAMA.
           GOBACK.

       B-INICIAR SECTION.
      *==================
       BA-CONTROL-PROCESO.
      *-------------------
           PERFORM BB-ACCEPT-TARJETA.
           PERFORM BC-OPEN-ARCHIVOS.
           GO TO BZ-FIN-SECTION.

       BB-ACCEPT-TARJETA.
      *------------------
           ACCEPT W-PARAMETRO.
           ACCEPT WE-TIME      FROM TIME.
           DISPLAY BLANCO '* TARJETA PARAM. : ' W-PARAMETRO.
000000* CARGA TABLA CALENDARIO
000000     MOVE '00000000' TO CALEAREA-FECHA-1.
000000     MOVE 'CARGAR' TO CALEAREA-FUNCION.
000000     CALL 'RUTUCALE' USING RTNWCALE
000000     IF CALEAREA-COD-RET NOT = 0
000000       DISPLAY
000000         'ERROR EN LA CARGA DE ARCHIVO CALENDARIO. CODIGO DE'
000000         'RETORNO = ' CALEAREA-COD-RET
000000       MOVE 1  TO SW-ERROR
           END-IF.
000000*  VALIDA NOMBRE.
000000*
000000     IF WP-NOMBRE NOT = 'DAPPLDIR'
000000       DISPLAY '*** PARAMETRO INVALIDO *** ', W-PARAMETRO
000000       MOVE 1  TO SW-ERROR
           END-IF.
000000*  VALIDA FECHA PARAMETRO
      *
000000     MOVE WP-FECHA-DD TO CALEAREA-FECHA-1-D.
000000     MOVE WP-FECHA-MM TO CALEAREA-FECHA-1-M.
000000     MOVE WP-FECHA-AA TO CALEAREA-FECHA-1-AA.
000000*****MOVE 19          TO CALEAREA-FECHA-1-AM.
           IF CALEAREA-FECHA-1-AA < ROLL-YY
              MOVE 20 TO CALEAREA-FECHA-1-AM
           ELSE
              MOVE 19 TO CALEAREA-FECHA-1-AM
           END-IF.
000000     MOVE 'INFO'      TO CALEAREA-FUNCION.
000000     CALL 'RUTUCALE'     USING RTNWCALE.
000000     IF CALEAREA-COD-RET NOT = 0
000000       DISPLAY
000000         'ERROR EN FECHA DE EMISION INGRESADA POR PARAMETRO'
000000         'CODIGO DE RETORNO = ' CALEAREA-COD-RET
                '  ' WP-FECHA
000000       MOVE 1  TO SW-ERROR
000000     ELSE
000000       DISPLAY 'TARJETA PARAMETRO'
000000       DISPLAY '-----------------'
000000       DISPLAY 'PROGRAMA: ' WP-NOMBRE
000000       DISPLAY 'FECHA   : ' WP-FECHA
             MOVE WP-FECHA-SS  TO WS-FECHA-SS
             MOVE WP-FECHA-AA  TO WS-FECHA-AA
                                  WR-LA02-AA
             MOVE WP-FECHA-MM  TO WS-FECHA-MM
                                  WR-LA02-MM
             MOVE WP-FECHA-DD  TO WS-FECHA-DD
                                  WR-LA02-DD
           END-IF.

       BC-OPEN-ARCHIVOS.
      *-----------------
           OPEN INPUT  DAPDOPD
           OPEN OUTPUT INFORME.

       BZ-FIN-SECTION.
      *---------------
           EXIT.

       C-PROCESAR SECTION.
      *===================
       CA-CONTROL-PROCESO.
      *-------------------
           SORT ASORT    ON ASCENDING KEY  SOR-COD-OFIC
                                           SOR-RUT-NUM
                                           SOR-CIC-ISER
           INPUT  PROCEDURE  D-ENTRADA-SORT
           OUTPUT PROCEDURE  E-SALIDA-SORT.
      *
           IF SORT-RETURN NOT = 0
              DISPLAY '**  ####################### **'
              DISPLAY '**  HUBO ERROR EN SORT      **'
              DISPLAY '**  ####################### **'
              MOVE 1 TO SW-ERROR
           END-IF.
       D-ENTRADA-SORT SECTION.
      *-----------------------
      ** LEE EN FORMA SECUENCIAL LA TABLA OPD
       DA-LEER-DAPDOPD.
           READ DAPDOPD AT END MOVE 1 TO FS-DAPDOPD.
           IF FS-DAPDOPD = 0
              ADD 1 TO CNT-DAPDOPD-L.
      *
       DC-CTRL-PROC.
           PERFORM DD-SELECCIONA-OPD UNTIL
              FS-DAPDOPD = 1
              GO TO DZZ-FIN-DE-SECCION.
      *

       DD-SELECCIONA-OPD.
      *------------------
           IF (OPD-COD-STAT = 'G'  )  AND
              (OPD-COD-RENO = 'S'  )
                 PERFORM DE-BUSCA-CLIENTES
                 ADD 1  TO  WA-SELEC
           END-IF.
           PERFORM DA-LEER-DAPDOPD.
      *
       DE-BUSCA-CLIENTES.
      *-------------------
      * 1.- CONSULTA TABLA DBC
           PERFORM  DE1-ACCESA-RCC-PRIMERA.
           PERFORM  DE2-ACCESA-RCC UNTIL  (REQ-RTNCD-RCC NOT = SPACES)
                       OR  (RCC-CIC-IOPD  NOT = OPD-CIC-IOPD).
      *
       DE1-ACCESA-RCC-PRIMERA.
      *-----------------------
           MOVE  OPD-CIC-IOPD   TO  REQ-KYVAL-RCC.
           MOVE 'REDKY'         TO  REQ-COMAN-RCC.
           CALL 'DBNTRY' USING UIB REQ-AREA-RCC REG-RCC ELM-LIS-RCC.
           IF REQ-RTNCD-RCC NOT = SPACES  AND
              REQ-RTNCD-RCC NOT = '14'
              MOVE 'REDKY  EN '  TO WR-MENSAJE
              MOVE ' RCC'        TO WR-TABLA-ERR
              MOVE REQ-RTNCD-RCC TO WR-CODIGO
              PERFORM D1-PROCESO-ERROR
           ELSE
              IF REQ-RTNCD-RCC NOT = '14'
                 PERFORM DA-CONSULTA-DBC
              ELSE
                 DISPLAY 'ERROR CON CLAVE OPD = ' OPD-CIC-IOPD
                 '  NO EXISTE RCC; PROCESO CONTINUA'
              END-IF
           END-IF.

      *
       DE2-ACCESA-RCC.
      *-----------------------
           MOVE 'REDNX'         TO  REQ-COMAN-RCC.
           CALL 'DBNTRY' USING UIB REQ-AREA-RCC REG-RCC ELM-LIS-RCC.
           IF REQ-RTNCD-RCC NOT = SPACES  AND
              REQ-RTNCD-RCC NOT = '14'
              MOVE 'REDNX  EN '  TO WR-MENSAJE
              MOVE ' RCC'        TO WR-TABLA-ERR
              MOVE REQ-RTNCD-RCC TO WR-CODIGO
              PERFORM D1-PROCESO-ERROR
           ELSE
              IF REQ-RTNCD-RCC NOT = '14'
                 IF RCC-CIC-IOPD = OPD-CIC-IOPD
                    PERFORM DA-CONSULTA-DBC
                 END-IF
              ELSE
                 DISPLAY 'ERROR CON CLAVE OPD = ' OPD-CIC-IOPD
                 '  NO EXISTE RCC; PROCESO CONTINUA'
              END-IF
           END-IF.

      *
       DA-CONSULTA-DBC.
      *---------------
           MOVE RCC-CIC-ICLI TO RUTWTSGC-CLAVE.
           MOVE 'CIC'        TO RUTWTSGC-TIP-ACCESO
           CALL 'RUTUTSGC' USING RUTWTSGC.
           EVALUATE RUTWTSGC-RETURN-CODE
           WHEN '  '
              MOVE RUTWTSGC-REGISTRO-DBC TO REG-DBC
              ADD 1  TO  WA-SELEC
              PERFORM DB-GENERA-SORT
           WHEN '14'
              DISPLAY  '******************************************'
              DISPLAY  '* ERROR: CLIENTE DAP NO ENCONTRADO EN SGC '
              DISPLAY  '******************************************'
              '  LLAVE-OPD:' RCC-CIC-IOPD
              '  LLAVE-DBC:' RCC-CIC-ICLI
           WHEN OTHER
              DISPLAY BLANCO '**************************'
              DISPLAY BLANCO '* ERROR: REDKY TABLA DBC *'
              DISPLAY BLANCO '* TABLA          : DBC'
              DISPLAY BLANCO '* CODIGO RETORNO : ' RUTWTSGC-RETURN-CODE
              PERFORM D1-PROCESO-ERROR
           END-EVALUATE.

       DB-GENERA-SORT.
      *-----------------
           MOVE 'REDKY'        TO REQ-RCD-CMD.
           MOVE 'RCD'          TO REQ-RCD-TBLNM.
           MOVE 'RCD00'        TO REQ-RCD-KEYNM.
           MOVE 'RCD00'        TO REQ-RCD-TBLID.
           MOVE 'RCD00'        TO ELEM-1.
           MOVE DBC-CIC-ICLI   TO REQ-DIR-CIC
           MOVE RCC-NUM-DIRE   TO REQ-DIR-NUM
           CALL 'DBNTRY' USING UIB REQ-RCD-AREA RCD ELEM-LIST.
           IF REQ-RCD-RETURN-CODE  = SPACES
              MOVE OPD-COD-OFIC    TO SOR-COD-OFIC
              MOVE OPD-CIC-ISER    TO SOR-CIC-ISER
              MOVE RUTWTSGC-NOMBRE TO SOR-NOMBRE
              MOVE RUTWTSGC-RUTNUM TO SOR-RUT-NUM
              MOVE RUTWTSGC-RUTDIG TO SOR-RUT-DIG
              MOVE RCD-GLS-DIRE    TO SOR-DIRECCION
              MOVE RCD-COD-LUGA    TO SOR-COMUNA
              MOVE RCD-NUM-DIRE    TO SOR-NUM-DIRE
              MOVE RCD-MSC-TDIR    TO SOR-TDIR
              MOVE RCD-NUM-FONO    TO SOR-FONO
              MOVE RCD-NUM-ANXO    TO SOR-ANEXO
              RELEASE REG-ASORT
           ELSE
              IF REQ-RCD-RETURN-CODE  NOT = '14'
                 DISPLAY        '*************************'
                 DISPLAY        '* ERROR REDKY TABLA RCD *'
                 DISPLAY        '* TABLA          : ' REQ-RCD-TBLNM
               DISPLAY        '* CODIGO RETORNO : ' REQ-RCD-RETURN-CODE
                DISPLAY        '* REQ. AREA      : ' REQ-RCD-AREA
              ELSE
                DISPLAY 'ERROR PARA CLAVE OPD :' OPD-CIC-IOPD
                        'NO EXISTE DIRECCION EN RCD'
              END-IF
           END-IF.

       D1-PROCESO-ERROR.
      *-----------------
           DISPLAY ' '.
           DISPLAY ' '.
           DISPLAY '*****************************************'.
           DISPLAY '*                                       *'.
           DISPLAY 'ERROR AL ' WR-MENSAJE 'TABLA' WR-TABLA-ERR.
           DISPLAY 'CODIGO DE RETORNO : ' WR-CODIGO '       *'.
           DISPLAY '*                                       *'.
           DISPLAY '*****************************************'.
           MOVE 20 TO SORT-RETURN.
           MOVE 1 TO SW-ERROR.
      *
       DZZ-FIN-DE-SECCION.
      *------------------
           EXIT.

       E-SALIDA-SORT SECTION.
      *---------------------
      * LEE SORT
      * PROCESA ARCHIVO SORT COMPLETO.
           PERFORM EB1-LEE-SORT.
           PERFORM EB-PROCESAR-SORT UNTIL WR-FIN-SORT = 'SI' OR
                                          SORT-RETURN NOT = 0.
           GO TO   EZZ-FIN-DE-SECCION.
      *
       EB1-LEE-SORT.
      *-------------
      *    DISPLAY 'EB1-LEE-SORT.'
           RETURN ASORT AT END MOVE 'SI' TO WR-FIN-SORT
           END-RETURN.
      *
       EB-PROCESAR-SORT.
      *----------------
           MOVE SOR-COD-OFIC     TO AUX-OFICINA
           PERFORM EG-BUSCA-OFICINA.
           PERFORM  EE-TITULO.
           PERFORM EC-CORTE-OFICINA UNTIL
                   (SOR-COD-OFIC NOT = AUX-OFICINA)  OR
                     WR-FIN-SORT = 'SI' OR
                     SORT-RETURN NOT = 0.
       EG-BUSCA-OFICINA.
      *----------------
           MOVE 0             TO WS-PAG-LREC
           MOVE SOR-COD-OFIC  TO RUTWTOFI-COD-OFIC.
           CALL 'RUTUTOFI' USING RUTWTOFI.
           IF RUTWTOFI-RETURN-CODE  = '  '
              MOVE RUTWTOFI-GLS-DESC    TO  WR-LA03-OFIC
           ELSE
              DISPLAY 'ERROR EN ACCESO TABLA OFI CODIGO RETORNO:'
                       RUTWTOFI-RETURN-CODE
              MOVE 'OFICINA SIN NOMBRE'  TO WR-LA03-OFIC
           END-IF.
      *

       EC-CORTE-OFICINA.
      *-----------------
           MOVE SOR-CIC-ISER     TO AUX-CIC-ISER
           PERFORM EG-LISTA-LINEA-OPERACION
           PERFORM ED-BUSCA-COMUNA.
           PERFORM EF-LISTA-LINEA-DIRECCION.
           PERFORM EB1-LEE-SORT.

       EG-LISTA-LINEA-OPERACION.
      *------------------------
           IF WS-LIN-LREC > 55
              PERFORM  EE-TITULO
           END-IF.
           MOVE SOR-CIC-ISER     TO WR-LA09-SERIAL
           MOVE SOR-NOMBRE       TO WR-LA09-NOMBRE
           MOVE SOR-RUT-NUM      TO WR-LA09-RUTN
           MOVE SOR-RUT-DIG      TO WR-LA09-RUTD
           ADD 2 TO WS-LIN-LREC
           WRITE REG-INFORME FROM WR-LINEA09 AFTER 2 LINES.


       EE-TITULO.
      *----------
           MOVE 12            TO WS-LIN-LREC
           ADD 1 TO WS-PAG-LREC
           MOVE WS-PAG-LREC   TO WR-LA01-PAG
           WRITE REG-INFORME FROM WR-LINEA01 AFTER CANAL-1.
           WRITE REG-INFORME FROM WR-LINEA02 AFTER 1 LINES.
           WRITE REG-INFORME FROM WR-LINEA03 AFTER 1 LINES.
           WRITE REG-INFORME FROM WR-LINEA04 AFTER 2 LINES.
           WRITE REG-INFORME FROM WR-LINEA05 AFTER 1 LINES.
           WRITE REG-INFORME FROM WR-LINEA06 AFTER 2 LINES.
           WRITE REG-INFORME FROM WR-LINEA07 AFTER 1 LINES.
           WRITE REG-INFORME FROM WR-LINEA08 AFTER 1 LINES.
           WRITE REG-INFORME FROM WR-LINEA06 AFTER 2 LINES.

       ED-BUSCA-COMUNA.
      *---------------
      * BUSCA COMUNA
              MOVE 'COM'               TO RUTWTTAB-TABLA
              MOVE '150'               TO RUTWTTAB-BASE
              MOVE SOR-COMUNA          TO RUTWTTAB-CLAVE
              CALL 'RUTUTTAB' USING RUTWTTAB
              IF RUTWTTAB-RETURN-CODE = SPACES
                    MOVE RUTWTTAB-GLOSA       TO WR-LA10-COMUNA
              ELSE
                    MOVE  SOR-COMUNA          TO WR-LA10-COMUNA
                    DISPLAY '5ERROR EN TABLA COMUNAS NO EXIXTE CODIGO'
                             'PARA COMUNA:' RUTWTSGC-COMUNA
                    DISPLAY 'AVISAR PARA CORREGIR EN SGC  COMUNA:'
                     SOR-COMUNA
                   'RUT: ' SOR-RUT-NUM   '-'  SOR-RUT-DIG
              END-IF.

       EF-LISTA-LINEA-DIRECCION.
      *-------------------------
           MOVE SOR-DIRECCION TO WR-LA10-DIRE
           MOVE SOR-NUM-DIRE  TO WR-LA10-NDIR
           MOVE SOR-TDIR      TO WR-LA10-TDIR
           MOVE SOR-FONO      TO WR-LA10-FONO
           ADD   1            TO WS-LIN-LREC
           WRITE REG-INFORME FROM WR-LINEA10  AFTER 1 LINES.
       EZZ-FIN-DE-SECCION.
      *-------------------
       D-TERMINAR  SECTION.
      *--------------------
       DA-CONTROL.
      *----------
           PERFORM DB-TOTALES.
           PERFORM DC-CERRAR-ARCHIVOS.
           GO TO DZ-FIN-DE-SECCION.
           SKIP1
       DB-TOTALES.
      *----------
           DISPLAY ' '
           DISPLAY '+---------------------------------------------+'
           DISPLAY '+ ESTADISTICAS DE PROCESO.  PROGRAMA DAPPLDIR +'
           DISPLAY '+---------------------------------------------+'
           DISPLAY '          FECHA : ' WP-FECHA.
           DISPLAY '+---------------------------------------------+'
           DISPLAY 'REG. LEIDOS TABLA RCC            : ' WA-LEIDOS-RCC.
           DISPLAY 'REG. SELECCIONADOS               :'  WA-SELEC.
           DISPLAY '***********************************************'.
           SKIP1
           DISPLAY ' '
           DISPLAY '+-------------------------------------------+'
           DISPLAY '+ MENSAJES PARA EL EXPLOTADOR               +'
           DISPLAY '+-------------------------------------------+'.
      *
           IF SW-ERROR    = 1
              DISPLAY ' HAY MENSAJES PARA EL EXPLOTADOR'
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '************************************************'
              DISPLAY '************************************************'
              DISPLAY '****                                        ****'
              DISPLAY '****      TERMINO ERRONEO DEL PROCESO       ****'
              DISPLAY '****                                        ****'
              DISPLAY '************************************************'
              DISPLAY '************************************************'
              MOVE 100 TO RETURN-CODE
           ELSE
              DISPLAY ' NO HAY MENSAJES PARA EL EXPLOTADOR'
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*** PROCESO TERMINO EN FORMA NORMAL ***'
           END-IF.
           SKIP1
       DC-CERRAR-ARCHIVOS.
      *------------------
           CLOSE INFORME.
           CLOSE DAPDOPD.
           SKIP1
       DZ-FIN-DE-SECCION.
      *-----------------
           EXIT.
           EJECT

