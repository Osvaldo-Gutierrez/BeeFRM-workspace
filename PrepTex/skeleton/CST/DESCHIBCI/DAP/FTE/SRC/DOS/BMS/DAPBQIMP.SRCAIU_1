      *
      * DAPBQIMP
      * Version 3.0.1 Nov-2005
      * 03-Feb-15 05:58 PM
      *
       SET-TAG-DAPBQIMP SECTION.
       INI-SET-TAG-DAPBQIMP.
           MOVE
           '<IDNMOD NOM=$DAPBQIMP$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$03-Feb-15 05:58 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DAPBQIMP.
           EXIT.
           
       PUT-ALL-IMP SECTION.
       INI-PUT-ALL-IMP.
           PERFORM PUT-IMP-IMP.
       FIN-PUT-ALL-IMP.
           EXIT.
       
       PUT-IMP-IMP SECTION.
       INI-PUT-IMP-IMP.
           IF PGM-STAT-IMP-NUL
               GO TO FIN-PUT-IMP-IMP.
           IF NOT PGM-STAT-IMP-OKS
               PERFORM CLR-IMP-IMP
               GO TO FIN-PUT-IMP-IMP.
           MOVE IMP-CAI-IOPD IN IMP TO IMP-CAI-IOPD IN IMP-FLD.
           MOVE IMP-IIC-IOPD IN IMP TO IMP-IIC-IOPD IN IMP-FLD.
           MOVE IMP-CAI-ISER IN IMP TO IMP-CAI-ISER IN IMP-FLD.
           MOVE IMP-IIC-ISER IN IMP TO IMP-IIC-ISER IN IMP-FLD.
           MOVE IMP-COD-STAT IN IMP TO IMP-COD-STAT IN IMP-FLD.
           MOVE IMP-STP-ITRN IN IMP TO IMP-STP-ITRN IN IMP-FLD.
           MOVE IMP-COD-TACC IN IMP TO IMP-COD-TACC IN IMP-FLD.
           MOVE IMP-COD-OTRN IN IMP TO IMP-COD-OTRN IN IMP-FLD.
           MOVE IMP-COD-ATRN IN IMP TO IMP-COD-ATRN IN IMP-FLD.
           MOVE IMP-COD-TCDP IN IMP TO IMP-COD-TCDP IN IMP-FLD.
           MOVE IMP-COD-COPD IN IMP TO IMP-COD-COPD IN IMP-FLD.
           MOVE IMP-COD-OFIC IN IMP TO IMP-COD-OFIC IN IMP-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-NUM-DREA IN IMP TO IMP-NUM-DREA IN IMP-FLD.
           MOVE IMP-NUM-MREA IN IMP TO IMP-NUM-MREA IN IMP-FLD.
           MOVE IMP-NUM-SREA IN IMP TO IMP-NUM-SREA IN IMP-FLD.
           MOVE IMP-NUM-AREA IN IMP TO IMP-NUM-AREA IN IMP-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-VAL-CAPT IN IMP TO IMP-VAL-CAPT IN IMP-FLD.
           MOVE IMP-VAL-VPES IN IMP TO IMP-VAL-VPES IN IMP-FLD.
           MOVE IMP-SGV-SPRD IN IMP TO IMP-SGV-SPRD IN IMP-FLD.
           MOVE IMP-SGV-TINT IN IMP TO IMP-SGV-TINT IN IMP-FLD.
           MOVE IMP-SGV-INTP IN IMP TO IMP-SGV-INTP IN IMP-FLD.
           MOVE IMP-VAL-VFIN IN IMP TO IMP-VAL-VFIN IN IMP-FLD.
           MOVE IMP-NUM-NCLI IN IMP TO IMP-NUM-NCLI IN IMP-FLD.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-NUM-ICL1 IN IMP TO IMP-NUM-ICL1 IN IMP-FLD.
           MOVE IMP-VRF-ICL1 IN IMP TO IMP-VRF-ICL1 IN IMP-FLD.
           MOVE IMP-IND-ICL1 IN IMP TO IMP-IND-ICL1 IN IMP-FLD.
           MOVE IMP-GLS-ICL1 IN IMP TO IMP-GLS-ICL1 IN IMP-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-GLS-NOM1 IN IMP TO IMP-GLS-NOM1 IN IMP-FLD.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-NUM-ICL2 IN IMP TO IMP-NUM-ICL2 IN IMP-FLD.
           MOVE IMP-VRF-ICL2 IN IMP TO IMP-VRF-ICL2 IN IMP-FLD.
           MOVE IMP-IND-ICL2 IN IMP TO IMP-IND-ICL2 IN IMP-FLD.
           MOVE IMP-GLS-ICL2 IN IMP TO IMP-GLS-ICL2 IN IMP-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-GLS-NOM2 IN IMP TO IMP-GLS-NOM2 IN IMP-FLD.
           MOVE IMP-GLS-OFIC IN IMP TO IMP-GLS-OFIC IN IMP-FLD.
           MOVE IMP-COD-GARA IN IMP TO IMP-COD-GARA IN IMP-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-NUM-DPVC IN IMP TO IMP-NUM-DPVC IN IMP-FLD.
           MOVE IMP-NUM-MPVC IN IMP TO IMP-NUM-MPVC IN IMP-FLD.
           MOVE IMP-NUM-SPVC IN IMP TO IMP-NUM-SPVC IN IMP-FLD.
           MOVE IMP-NUM-APVC IN IMP TO IMP-NUM-APVC IN IMP-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-NUM-RETD IN IMP TO IMP-NUM-RETD IN IMP-FLD.
           MOVE IMP-IND-RETD IN IMP TO IMP-IND-RETD IN IMP-FLD.
           MOVE IMP-COD-CUST IN IMP TO IMP-COD-CUST IN IMP-FLD.
           MOVE IMP-COD-RENO IN IMP TO IMP-COD-RENO IN IMP-FLD.
           MOVE IMP-COD-ENDO IN IMP TO IMP-COD-ENDO IN IMP-FLD.
           MOVE IMP-NUM-DURV IN IMP TO IMP-NUM-DURV IN IMP-FLD.
           MOVE IMP-IND-DURV IN IMP TO IMP-IND-DURV IN IMP-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-NUM-DTER IN IMP TO IMP-NUM-DTER IN IMP-FLD.
           MOVE IMP-NUM-MTER IN IMP TO IMP-NUM-MTER IN IMP-FLD.
           MOVE IMP-NUM-STER IN IMP TO IMP-NUM-STER IN IMP-FLD.
           MOVE IMP-NUM-ATER IN IMP TO IMP-NUM-ATER IN IMP-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-COD-PLZO IN IMP TO IMP-COD-PLZO IN IMP-FLD.
           MOVE IMP-GLS-SAFE IN IMP TO IMP-GLS-SAFE IN IMP-FLD.
           MOVE IMP-GLS-DISP IN IMP TO IMP-GLS-DISP IN IMP-FLD.
           MOVE IMP-SGV-TPER IN IMP TO IMP-SGV-TPER IN IMP-FLD.
           MOVE IMP-COD-AIMP IN IMP TO IMP-COD-AIMP IN IMP-FLD.
       FIN-PUT-IMP-IMP.
           EXIT.
       
       KEY-ALL-IMP SECTION.
       INI-KEY-ALL-IMP.
           PERFORM KEY-IMP-IMP.
       FIN-KEY-ALL-IMP.
           EXIT.
       
       KEY-IMP-IMP SECTION.
       INI-KEY-IMP-IMP.
           MOVE IMP-CAI-IOPD IN IMP-FLD TO IMP-CAI-IOPD IN IMP.
           MOVE IMP-IIC-IOPD IN IMP-FLD TO IMP-IIC-IOPD IN IMP.
       FIN-KEY-IMP-IMP.
           EXIT.
       
       SCR-CLRA-IMP SECTION.
       INI-SCR-CLRA-IMP.
           PERFORM CLR-KEY-IMP.
           PERFORM CLR-FLD-IMP.
       FIN-SCR-CLRA-IMP.
           EXIT.
       
       CLR-KEY-IMP SECTION.
       INI-CLR-KEY-IMP.
           MOVE SPACES TO IMP-CAI-IOPD IN IMP-FLD.
           MOVE ZEROES TO IMP-IIC-IOPD IN IMP-FLD.
       FIN-CLR-KEY-IMP.
           EXIT.
       
       CLR-FLD-IMP SECTION.
       INI-CLR-FLD-IMP.
           MOVE SPACES TO FRM-GLS-AIMP IN IMP-FLD.
           PERFORM CLR-IMP-IMP.
       FIN-CLR-FLD-IMP.
           EXIT.
       
       CLR-IMP-IMP SECTION.
       INI-CLR-IMP-IMP.
           MOVE SPACES TO IMP-CAI-ISER IN IMP-FLD.
           MOVE ZEROES TO IMP-IIC-ISER IN IMP-FLD.
           MOVE SPACES TO IMP-COD-STAT IN IMP-FLD.
           MOVE SPACES TO IMP-STP-ITRN IN IMP-FLD.
           MOVE SPACES TO IMP-COD-TACC IN IMP-FLD.
           MOVE SPACES TO IMP-COD-OTRN IN IMP-FLD.
           MOVE SPACES TO IMP-COD-ATRN IN IMP-FLD.
           MOVE SPACES TO IMP-COD-TCDP IN IMP-FLD.
           MOVE SPACES TO IMP-COD-COPD IN IMP-FLD.
           MOVE SPACES TO IMP-COD-OFIC IN IMP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-FEC-FREA IN IMP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-VAL-CAPT IN IMP-FLD.
           MOVE ZEROES TO IMP-VAL-VPES IN IMP-FLD.
           MOVE ZEROES TO IMP-SGV-SPRD IN IMP-FLD.
           MOVE ZEROES TO IMP-SGV-TINT IN IMP-FLD.
           MOVE ZEROES TO IMP-SGV-INTP IN IMP-FLD.
           MOVE ZEROES TO IMP-VAL-VFIN IN IMP-FLD.
           MOVE SPACES TO IMP-NUM-NCLI IN IMP-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-NUM-ICL1 IN IMP-FLD.
           MOVE SPACES TO IMP-VRF-ICL1 IN IMP-FLD.
           MOVE SPACES TO IMP-IND-ICL1 IN IMP-FLD.
           MOVE SPACES TO IMP-GLS-ICL1 IN IMP-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO IMP-GLS-NOM1 IN IMP-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-NUM-ICL2 IN IMP-FLD.
           MOVE SPACES TO IMP-VRF-ICL2 IN IMP-FLD.
           MOVE SPACES TO IMP-IND-ICL2 IN IMP-FLD.
           MOVE SPACES TO IMP-GLS-ICL2 IN IMP-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO IMP-GLS-NOM2 IN IMP-FLD.
           MOVE SPACES TO IMP-GLS-OFIC IN IMP-FLD.
           MOVE SPACES TO IMP-COD-GARA IN IMP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-FEC-FPVC IN IMP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-NUM-RETD IN IMP-FLD.
           MOVE SPACES TO IMP-IND-RETD IN IMP-FLD.
           MOVE SPACES TO IMP-COD-CUST IN IMP-FLD.
           MOVE SPACES TO IMP-COD-RENO IN IMP-FLD.
           MOVE SPACES TO IMP-COD-ENDO IN IMP-FLD.
           MOVE ZEROES TO IMP-NUM-DURV IN IMP-FLD.
           MOVE SPACES TO IMP-IND-DURV IN IMP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-FEC-FTER IN IMP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO IMP-COD-PLZO IN IMP-FLD.
           MOVE SPACES TO IMP-GLS-SAFE IN IMP-FLD.
           MOVE SPACES TO IMP-GLS-DISP IN IMP-FLD.
           MOVE ZEROES TO IMP-SGV-TPER IN IMP-FLD.
           MOVE SPACES TO IMP-COD-AIMP IN IMP-FLD.
       FIN-CLR-IMP-IMP.
           EXIT.
       
       FST-KEY-IMP SECTION.
       INI-FST-KEY-IMP.
           MOVE -1 TO IMP-CAI-IOPD-LEN IN IMP-FLD.
       FIN-FST-KEY-IMP.
           EXIT.
       
       FST-FLD-IMP SECTION.
       INI-FST-FLD-IMP.
      *<<<< INI_FST_FLD_IMP
      *CIMA-INI 26-ENE-2015 CUSTODIA DAP - IMPRESION
           IF SCR-CMND = WSS-CT-ATZ
              MOVE WSS-CT-MUNO TO IMP-COD-AIMP-LEN IN IMP-FLD
              GO TO FIN-FST-FLD-IMP.
      *CIMA-FIN 26-ENE-2015 CUSTODIA DAP - IMPRESION
      *>>>>
           MOVE -1 TO IMP-CAI-ISER-LEN IN IMP-FLD.
       FIN-FST-FLD-IMP.
           EXIT.
       
       PRO-KEY-IMP SECTION.
       INI-PRO-KEY-IMP.
           PERFORM PRO-IKY-IMP.
           PERFORM PRO-AKY-IMP.
           PERFORM PRO-MKY-IMP.
       FIN-PRO-KEY-IMP.
           EXIT.
       
       PRO-IKY-IMP SECTION.
       INI-PRO-IKY-IMP.
           MOVE FRM-CPIM-AEY TO IMP-CAI-IOPD-ATR IN IMP-FLD.
           MOVE FRM-CPIM-AEY TO IMP-IIC-IOPD-ATR IN IMP-FLD.
       FIN-PRO-IKY-IMP.
           EXIT.
       
       PRO-MKY-IMP SECTION.
       INI-PRO-MKY-IMP.
       FIN-PRO-MKY-IMP.
           EXIT.
       
       PRO-AKY-IMP SECTION.
       INI-PRO-AKY-IMP.
       FIN-PRO-AKY-IMP.
           EXIT.
       
       UNP-KEY-IMP SECTION.
       INI-UNP-KEY-IMP.
           PERFORM UNP-IKY-IMP.
           PERFORM UNP-AKY-IMP.
           PERFORM UNP-MKY-IMP.
       FIN-UNP-KEY-IMP.
           EXIT.
       
       UNP-IKY-IMP SECTION.
       INI-UNP-IKY-IMP.
           MOVE FRM-CPIM-UBY TO IMP-CAI-IOPD-ATR.
           MOVE FRM-CPIM-UBY TO IMP-IIC-IOPD-ATR.
       FIN-UNP-IKY-IMP.
           EXIT.
       
       UNP-MKY-IMP SECTION.
       INI-UNP-MKY-IMP.
       FIN-UNP-MKY-IMP.
           EXIT.
       
       UNP-AKY-IMP SECTION.
       INI-UNP-AKY-IMP.
       FIN-UNP-AKY-IMP.
           EXIT.
       
       UNP-FLD-IMP SECTION.
       INI-UNP-FLD-IMP.
           PERFORM UNP-IMP-IMP.
       FIN-UNP-FLD-IMP.
           EXIT.
       
       UNP-IMP-IMP SECTION.
       INI-UNP-IMP-IMP.
           MOVE FRM-CPIM-UBY TO IMP-CAI-ISER-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-IIC-ISER-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-STAT-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-STP-ITRN-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-TACC-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-OTRN-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-ATRN-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-TCDP-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-COPD-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-OFIC-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-FEC-FREA-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-VAL-CAPT-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-VAL-VPES-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-SGV-SPRD-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-SGV-TINT-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-SGV-INTP-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-VAL-VFIN-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-NUM-NCLI-ATR IN IMP-FLD.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO IMP-NUM-ICL1-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-VRF-ICL1-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-IND-ICL1-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-GLS-ICL1-ATR IN IMP-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO IMP-GLS-NOM1-ATR IN IMP-FLD.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO IMP-NUM-ICL2-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-VRF-ICL2-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-IND-ICL2-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-GLS-ICL2-ATR IN IMP-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO IMP-GLS-NOM2-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-GLS-OFIC-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-GARA-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-FEC-FPVC-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-NUM-RETD-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-IND-RETD-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-CUST-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-RENO-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-ENDO-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-NUM-DURV-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-IND-DURV-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-FEC-FTER-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-PLZO-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-GLS-SAFE-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-GLS-DISP-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-SGV-TPER-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-COD-AIMP-ATR IN IMP-FLD.
      *<<<< FIN_UNP_IMP_IMP
      *CIMA-INI 26-ENE-2015 CUSTODIA DAP - IMPRESION
           IF SCR-CMND NOT = WSS-CT-ATZ
              MOVE FRM-CPIM-AEY TO IMP-COD-AIMP-ATR IN IMP-FLD
           ELSE 
              MOVE FRM-CPIM-AEY TO IMP-CAI-ISER-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-IIC-ISER-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-STAT-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-STP-ITRN-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-TACC-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-OTRN-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-ATRN-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-TCDP-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-COPD-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-OFIC-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-FEC-FREA-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-VAL-CAPT-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-VAL-VPES-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-SGV-SPRD-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-SGV-TINT-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-SGV-INTP-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-VAL-VFIN-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-NUM-NCLI-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-NUM-ICL1-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-VRF-ICL1-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-IND-ICL1-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-GLS-ICL1-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-GLS-NOM1-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-NUM-ICL2-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-VRF-ICL2-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-IND-ICL2-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-GLS-ICL2-ATR IN IMP-FLD
              
              MOVE FRM-CPIM-AEY TO IMP-GLS-NOM2-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-GLS-OFIC-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-GARA-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-FEC-FPVC-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-NUM-RETD-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-IND-RETD-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-CUST-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-RENO-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-ENDO-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-NUM-DURV-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-IND-DURV-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-FEC-FTER-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-COD-PLZO-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-GLS-SAFE-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-GLS-DISP-ATR IN IMP-FLD
              MOVE FRM-CPIM-AEY TO IMP-SGV-TPER-ATR IN IMP-FLD
              MOVE FRM-CPIM-UBY TO IMP-COD-AIMP-ATR IN IMP-FLD.
      *CIMA-FIN 26-ENE-2015 CUSTODIA DAP - IMPRESION
      *>>>>
       FIN-UNP-IMP-IMP.
           EXIT.
       
       VAL-KEY-IMP SECTION.
       INI-VAL-KEY-IMP.
           PERFORM VAL-IKY-IMP.
           PERFORM VAL-MKY-IMP.
           PERFORM VAL-AKY-IMP.
       FIN-VAL-KEY-IMP.
           EXIT.
       
       VAL-IKY-IMP SECTION.
       INI-VAL-IKY-IMP.
           PERFORM VAL-IMP-CAI-IOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IMP-CAI-IOPD-LEN IN IMP-FLD
                GO TO FIN-VAL-IKY-IMP.
           PERFORM VAL-IMP-IIC-IOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IMP-IIC-IOPD-LEN IN IMP-FLD
                GO TO FIN-VAL-IKY-IMP.
       FIN-VAL-IKY-IMP.
           EXIT.
       
       VAL-MKY-IMP SECTION.
       INI-VAL-MKY-IMP.
       FIN-VAL-MKY-IMP.
           EXIT.
       
       VAL-AKY-IMP SECTION.
       INI-VAL-AKY-IMP.
       FIN-VAL-AKY-IMP.
           EXIT.
       
       VAL-IMP-CAI-IOPD SECTION.
       INI-VAL-IMP-CAI-IOPD.
           IF IMP-CAI-IOPD IN IMP-FLD NOT > SPACES
              MOVE SPACES TO IMP-CAI-IOPD IN IMP-FLD.
       FIN-VAL-IMP-CAI-IOPD.
           EXIT.
       
       VAL-IMP-IIC-IOPD SECTION.
       INI-VAL-IMP-IIC-IOPD.
       FIN-VAL-IMP-IIC-IOPD.
           EXIT.
       
       VAL-CON-KEY-IMP SECTION.
       INI-VAL-CON-KEY-IMP.
           IF     IMP-CAI-IOPD IN IMP-FLD NOT > SPACES 
              AND IMP-IIC-IOPD IN IMP-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-IMP.
       FIN-VAL-CON-KEY-IMP.
           EXIT.
       
       VAL-CON-IKY-IMP SECTION.
       INI-VAL-CON-IKY-IMP.
           IF     IMP-CAI-IOPD IN IMP-FLD NOT > SPACES 
              AND IMP-IIC-IOPD IN IMP-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-IMP.
       FIN-VAL-CON-IKY-IMP.
           EXIT.
       
       VAL-NUM-KEY-IMP SECTION.
       INI-VAL-NUM-KEY-IMP.
           PERFORM VAL-NUM-IKY-IMP.
           PERFORM VAL-NUM-MKY-IMP.
           PERFORM VAL-NUM-AKY-IMP.
       FIN-VAL-NUM-KEY-IMP.
           EXIT.
       
       VAL-NUM-IKY-IMP SECTION.
       INI-VAL-NUM-IKY-IMP.
       VAL-NUM-IMP-IIC-IOPD.
           MOVE IMP-IIC-IOPD-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO IMP-IIC-IOPD IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-IIC-IOPD-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-IKY-IMP.
       FIN-VAL-NUM-IKY-IMP.
           EXIT.
       
       VAL-NUM-MKY-IMP SECTION.
       INI-VAL-NUM-MKY-IMP.
       FIN-VAL-NUM-MKY-IMP.
           EXIT.
       
       VAL-NUM-AKY-IMP SECTION.
       INI-VAL-NUM-AKY-IMP.
       FIN-VAL-NUM-AKY-IMP.
           EXIT.
       
       VAL-NUM-FLD-IMP SECTION.
       INI-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-IIC-ISER.
           MOVE IMP-IIC-ISER-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO IMP-IIC-ISER IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-IIC-ISER-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-VAL-CAPT.
           MOVE IMP-VAL-CAPT-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO IMP-VAL-CAPT IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-VAL-CAPT-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-VAL-VPES.
           MOVE IMP-VAL-VPES-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO IMP-VAL-VPES IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-VAL-VPES-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-SGV-SPRD.
           MOVE IMP-SGV-SPRD-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO IMP-SGV-SPRD IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-SGV-SPRD-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-SGV-TINT.
           MOVE IMP-SGV-TINT-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO IMP-SGV-TINT IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-SGV-TINT-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-SGV-INTP.
           MOVE IMP-SGV-INTP-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO IMP-SGV-INTP IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-SGV-INTP-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-VAL-VFIN.
           MOVE IMP-VAL-VFIN-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO IMP-VAL-VFIN IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-VAL-VFIN-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-IMP-NUM-ICL1.
           MOVE IMP-NUM-ICL1-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO IMP-NUM-ICL1 IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-NUM-ICL1-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-IMP-NUM-ICL2.
           MOVE IMP-NUM-ICL2-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO IMP-NUM-ICL2 IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-NUM-ICL2-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-IMP-NUM-RETD.
           MOVE IMP-NUM-RETD-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO IMP-NUM-RETD IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-NUM-RETD-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-NUM-DURV.
           MOVE IMP-NUM-DURV-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO IMP-NUM-DURV IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-NUM-DURV-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-SGV-TPER.
           MOVE IMP-SGV-TPER-ALF IN IMP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO IMP-SGV-TPER IN IMP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IMP-SGV-TPER-LEN IN IMP-FLD
                GO TO FIN-VAL-NUM-FLD-IMP.
       FIN-VAL-NUM-FLD-IMP.
           EXIT.
       
       EDT-KEY-IMP SECTION.
       INI-EDT-KEY-IMP.
           PERFORM EDT-IKY-IMP.
           PERFORM EDT-MKY-IMP.
           PERFORM EDT-AKY-IMP.
       FIN-EDT-KEY-IMP.
           EXIT.
       
       EDT-IKY-IMP SECTION.
       INI-EDT-IKY-IMP.
           IF IMP-IIC-IOPD-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-IIC-IOPD-LEN IN IMP-FLD
                GO TO FIN-EDT-IKY-IMP.
           MOVE IMP-IIC-IOPD IN IMP-FLD TO IMP-IIC-IOPD-EDT IN IMP-EDT.
           MOVE IMP-IIC-IOPD-EDT IN IMP-EDT TO 
                IMP-IIC-IOPD-ALF IN IMP-FLD.
       FIN-EDT-IKY-IMP.
           EXIT.
       
       EDT-MKY-IMP SECTION.
       INI-EDT-MKY-IMP.
       FIN-EDT-MKY-IMP.
           EXIT.
       
       EDT-AKY-IMP SECTION.
       INI-EDT-AKY-IMP.
       FIN-EDT-AKY-IMP.
           EXIT.
       
       EDT-FLD-IMP SECTION.
       INI-EDT-FLD-IMP.
           IF IMP-IIC-ISER-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-IIC-ISER-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-IIC-ISER IN IMP-FLD TO IMP-IIC-ISER-EDT IN IMP-EDT.
           MOVE IMP-IIC-ISER-EDT IN IMP-EDT TO 
                IMP-IIC-ISER-ALF IN IMP-FLD.
           IF IMP-VAL-CAPT-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-VAL-CAPT-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-VAL-CAPT IN IMP-FLD TO IMP-VAL-CAPT-EDT IN IMP-EDT.
           MOVE IMP-VAL-CAPT-EDT IN IMP-EDT TO 
                IMP-VAL-CAPT-ALF IN IMP-FLD.
           IF IMP-VAL-VPES-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-VAL-VPES-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-VAL-VPES IN IMP-FLD TO IMP-VAL-VPES-EDT IN IMP-EDT.
           MOVE IMP-VAL-VPES-EDT IN IMP-EDT TO 
                IMP-VAL-VPES-ALF IN IMP-FLD.
           IF IMP-SGV-SPRD-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-SGV-SPRD-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-SGV-SPRD IN IMP-FLD TO IMP-SGV-SPRD-EDT IN IMP-EDT.
           MOVE IMP-SGV-SPRD-EDT IN IMP-EDT TO 
                IMP-SGV-SPRD-ALF IN IMP-FLD.
           IF IMP-SGV-TINT-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-SGV-TINT-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-SGV-TINT IN IMP-FLD TO IMP-SGV-TINT-EDT IN IMP-EDT.
           MOVE IMP-SGV-TINT-EDT IN IMP-EDT TO 
                IMP-SGV-TINT-ALF IN IMP-FLD.
           IF IMP-SGV-INTP-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-SGV-INTP-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-SGV-INTP IN IMP-FLD TO IMP-SGV-INTP-EDT IN IMP-EDT.
           MOVE IMP-SGV-INTP-EDT IN IMP-EDT TO 
                IMP-SGV-INTP-ALF IN IMP-FLD.
           IF IMP-VAL-VFIN-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-VAL-VFIN-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-VAL-VFIN IN IMP-FLD TO IMP-VAL-VFIN-EDT IN IMP-EDT.
           MOVE IMP-VAL-VFIN-EDT IN IMP-EDT TO 
                IMP-VAL-VFIN-ALF IN IMP-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF IMP-NUM-ICL1-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-NUM-ICL1-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-NUM-ICL1 IN IMP-FLD TO
                IMP-NUM-ICL1-EDT IN IMP-EDT.
           MOVE IMP-NUM-ICL1-EDT IN IMP-EDT TO
                IMP-NUM-ICL1-ALF IN IMP-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF IMP-NUM-ICL2-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-NUM-ICL2-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-NUM-ICL2 IN IMP-FLD TO
                IMP-NUM-ICL2-EDT IN IMP-EDT.
           MOVE IMP-NUM-ICL2-EDT IN IMP-EDT TO
                IMP-NUM-ICL2-ALF IN IMP-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF IMP-NUM-RETD-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-NUM-RETD-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-NUM-RETD IN IMP-FLD TO IMP-NUM-RETD-EDT IN IMP-EDT.
           MOVE IMP-NUM-RETD-EDT IN IMP-EDT TO 
                IMP-NUM-RETD-ALF IN IMP-FLD.
           IF IMP-NUM-DURV-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-NUM-DURV-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-NUM-DURV IN IMP-FLD TO IMP-NUM-DURV-EDT IN IMP-EDT.
           MOVE IMP-NUM-DURV-EDT IN IMP-EDT TO 
                IMP-NUM-DURV-ALF IN IMP-FLD.
           IF IMP-SGV-TPER-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-SGV-TPER-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-SGV-TPER IN IMP-FLD TO IMP-SGV-TPER-EDT IN IMP-EDT.
           MOVE IMP-SGV-TPER-EDT IN IMP-EDT TO 
                IMP-SGV-TPER-ALF IN IMP-FLD.
       FIN-EDT-FLD-IMP.
           EXIT.
