      *
      * DAPBQJPO
      * Version 3.0.1 Nov-2005
      * 09-Jun-10 06:02 PM
      *
       SET-TAG-DAPBQJPO SECTION.
       INI-SET-TAG-DAPBQJPO.
           MOVE
           '<IDNMOD NOM=$DAPBQJPO$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$09-Jun-10 06:02 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DAPBQJPO.
           EXIT.
           
       PUT-ALL-JPO SECTION.
       INI-PUT-ALL-JPO.
           PERFORM PUT-JPO-JPO.
       FIN-PUT-ALL-JPO.
           EXIT.
       
       PUT-JPO-JPO SECTION.
       INI-PUT-JPO-JPO.
           IF PGM-STAT-JPO-NUL
               GO TO FIN-PUT-JPO-JPO.
           IF NOT PGM-STAT-JPO-OKS
               PERFORM CLR-JPO-JPO
               GO TO FIN-PUT-JPO-JPO.
           MOVE JPO-COD-VCAM IN JPO TO JPO-COD-VCAM IN JPO-FLD.
           MOVE JPO-COD-TOPD IN JPO TO JPO-COD-TOPD IN JPO-FLD.
           MOVE JPO-COD-AOPD IN JPO TO JPO-COD-AOPD IN JPO-FLD.
           MOVE JPO-NUM-IPOD IN JPO TO JPO-NUM-IPOD IN JPO-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE JPO-NUM-DTRN IN JPO TO JPO-NUM-DTRN IN JPO-FLD.
           MOVE JPO-NUM-MTRN IN JPO TO JPO-NUM-MTRN IN JPO-FLD.
           MOVE JPO-NUM-STRN IN JPO TO JPO-NUM-STRN IN JPO-FLD.
           MOVE JPO-NUM-ATRN IN JPO TO JPO-NUM-ATRN IN JPO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE JPO-HRA-HRTR IN JPO TO JPO-HRA-HRTR IN JPO-FLD.
           MOVE JPO-COD-OTRN IN JPO TO JPO-COD-OTRN IN JPO-FLD.
           MOVE JPO-COD-TACC IN JPO TO JPO-COD-TACC IN JPO-FLD.
           MOVE JPO-COD-STAT IN JPO TO JPO-COD-STAT IN JPO-FLD.
           MOVE JPO-COD-ATRN IN JPO TO JPO-COD-ATRN IN JPO-FLD.
           MOVE JPO-COD-RENO IN JPO TO JPO-COD-RENO IN JPO-FLD.
           MOVE JPO-VAL-CMIN IN JPO TO JPO-VAL-CMIN IN JPO-FLD.
           MOVE JPO-COD-ENDO IN JPO TO JPO-COD-ENDO IN JPO-FLD.
           MOVE JPO-VAL-CMAX IN JPO TO JPO-VAL-CMAX IN JPO-FLD.
           MOVE JPO-COD-BCTI IN JPO TO JPO-COD-BCTI IN JPO-FLD.
           MOVE JPO-NUM-PMIN IN JPO TO JPO-NUM-PMIN IN JPO-FLD.
           MOVE JPO-IND-PMIN IN JPO TO JPO-IND-PMIN IN JPO-FLD.
           MOVE JPO-COD-PBTI IN JPO TO JPO-COD-PBTI IN JPO-FLD.
           MOVE JPO-NUM-PMAX IN JPO TO JPO-NUM-PMAX IN JPO-FLD.
           MOVE JPO-IND-PMAX IN JPO TO JPO-IND-PMAX IN JPO-FLD.
           MOVE JPO-COD-BPBT IN JPO TO JPO-COD-BPBT IN JPO-FLD.
           MOVE JPO-COD-SPBT IN JPO TO JPO-COD-SPBT IN JPO-FLD.
           MOVE JPO-NUM-VMIN IN JPO TO JPO-NUM-VMIN IN JPO-FLD.
           MOVE JPO-NUM-VMAX IN JPO TO JPO-NUM-VMAX IN JPO-FLD.
           MOVE JPO-COD-CVTI IN JPO TO JPO-COD-CVTI IN JPO-FLD.
           MOVE JPO-NUM-SMNV IN JPO TO JPO-NUM-SMNV IN JPO-FLD.
           MOVE JPO-IND-SMNV IN JPO TO JPO-IND-SMNV IN JPO-FLD.
           MOVE JPO-NUM-SMXV IN JPO TO JPO-NUM-SMXV IN JPO-FLD.
           MOVE JPO-IND-SMXV IN JPO TO JPO-IND-SMXV IN JPO-FLD.
           MOVE JPO-COD-TFPR IN JPO TO JPO-COD-TFPR IN JPO-FLD.
           MOVE JPO-COD-MORE IN JPO TO JPO-COD-MORE IN JPO-FLD.
           MOVE JPO-NUM-PREP IN JPO TO JPO-NUM-PREP IN JPO-FLD.
           MOVE JPO-COD-RESC IN JPO TO JPO-COD-RESC IN JPO-FLD.
           MOVE JPO-IND-PREP IN JPO TO JPO-IND-PREP IN JPO-FLD.
           MOVE JPO-COD-PLPA IN JPO TO JPO-COD-PLPA IN JPO-FLD.
           MOVE JPO-IND-VIGE IN JPO TO JPO-IND-VIGE IN JPO-FLD.
           MOVE JPO-NUM-PLRE IN JPO TO JPO-NUM-PLRE IN JPO-FLD.
           MOVE JPO-IND-PLRE IN JPO TO JPO-IND-PLRE IN JPO-FLD.
           MOVE JPO-NUM-PNTE IN JPO TO JPO-NUM-PNTE IN JPO-FLD.
           MOVE JPO-COD-NAPR IN JPO TO JPO-COD-NAPR IN JPO-FLD.
           MOVE JPO-IND-PNTE IN JPO TO JPO-IND-PNTE IN JPO-FLD.
           MOVE JPO-COD-GARA IN JPO TO JPO-COD-GARA IN JPO-FLD.
           MOVE JPO-COD-TCDP IN JPO TO JPO-COD-TCDP IN JPO-FLD.
           MOVE JPO-COD-AFER IN JPO TO JPO-COD-AFER IN JPO-FLD.
           MOVE JPO-COD-AACC IN JPO TO JPO-COD-AACC IN JPO-FLD.
      *<<<< FIN_PUT_JPO_JPO
      *>>>>
       FIN-PUT-JPO-JPO.
           EXIT.
       
       KEY-ALL-JPO SECTION.
       INI-KEY-ALL-JPO.
           PERFORM KEY-JPO-JPO.
       FIN-KEY-ALL-JPO.
           EXIT.
       
       KEY-JPO-JPO SECTION.
       INI-KEY-JPO-JPO.
           MOVE JPO-COD-VCAM IN JPO-FLD TO JPO-COD-VCAM IN JPO.
           MOVE JPO-COD-TOPD IN JPO-FLD TO JPO-COD-TOPD IN JPO.
           MOVE JPO-COD-AOPD IN JPO-FLD TO JPO-COD-AOPD IN JPO.
           MOVE JPO-NUM-IPOD IN JPO-FLD TO JPO-NUM-IPOD IN JPO.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE JPO-NUM-DTRN IN JPO-FLD TO JPO-NUM-DTRN IN JPO.
           MOVE JPO-NUM-MTRN IN JPO-FLD TO JPO-NUM-MTRN IN JPO.
           MOVE JPO-NUM-STRN IN JPO-FLD TO JPO-NUM-STRN IN JPO.
           MOVE JPO-NUM-ATRN IN JPO-FLD TO JPO-NUM-ATRN IN JPO.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE JPO-HRA-HRTR IN JPO-FLD TO JPO-HRA-HRTR IN JPO.
       FIN-KEY-JPO-JPO.
           EXIT.
       
       SCR-CLRA-JPO SECTION.
       INI-SCR-CLRA-JPO.
           PERFORM CLR-KEY-JPO.
           PERFORM CLR-FLD-JPO.
       FIN-SCR-CLRA-JPO.
           EXIT.
       
       CLR-KEY-JPO SECTION.
       INI-CLR-KEY-JPO.
           MOVE SPACES TO JPO-COD-VCAM IN JPO-FLD.
           MOVE SPACES TO JPO-COD-TOPD IN JPO-FLD.
           MOVE SPACES TO JPO-COD-AOPD IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-IPOD IN JPO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO JPO-FEC-FTRN IN JPO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO JPO-HRA-HRTR IN JPO-FLD.
       FIN-CLR-KEY-JPO.
           EXIT.
       
       CLR-FLD-JPO SECTION.
       INI-CLR-FLD-JPO.
           PERFORM CLR-JPO-JPO.
       FIN-CLR-FLD-JPO.
           EXIT.
       
       CLR-JPO-JPO SECTION.
       INI-CLR-JPO-JPO.
           MOVE SPACES TO JPO-COD-OTRN IN JPO-FLD.
           MOVE SPACES TO JPO-COD-TACC IN JPO-FLD.
           MOVE SPACES TO JPO-COD-STAT IN JPO-FLD.
           MOVE SPACES TO JPO-COD-ATRN IN JPO-FLD.
           MOVE SPACES TO JPO-COD-RENO IN JPO-FLD.
           MOVE ZEROES TO JPO-VAL-CMIN IN JPO-FLD.
           MOVE SPACES TO JPO-COD-ENDO IN JPO-FLD.
           MOVE ZEROES TO JPO-VAL-CMAX IN JPO-FLD.
           MOVE SPACES TO JPO-COD-BCTI IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-PMIN IN JPO-FLD.
           MOVE SPACES TO JPO-IND-PMIN IN JPO-FLD.
           MOVE SPACES TO JPO-COD-PBTI IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-PMAX IN JPO-FLD.
           MOVE SPACES TO JPO-IND-PMAX IN JPO-FLD.
           MOVE SPACES TO JPO-COD-BPBT IN JPO-FLD.
           MOVE SPACES TO JPO-COD-SPBT IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-VMIN IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-VMAX IN JPO-FLD.
           MOVE SPACES TO JPO-COD-CVTI IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-SMNV IN JPO-FLD.
           MOVE SPACES TO JPO-IND-SMNV IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-SMXV IN JPO-FLD.
           MOVE SPACES TO JPO-IND-SMXV IN JPO-FLD.
           MOVE SPACES TO JPO-COD-TFPR IN JPO-FLD.
           MOVE SPACES TO JPO-COD-MORE IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-PREP IN JPO-FLD.
           MOVE SPACES TO JPO-COD-RESC IN JPO-FLD.
           MOVE SPACES TO JPO-IND-PREP IN JPO-FLD.
           MOVE SPACES TO JPO-COD-PLPA IN JPO-FLD.
           MOVE SPACES TO JPO-IND-VIGE IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-PLRE IN JPO-FLD.
           MOVE SPACES TO JPO-IND-PLRE IN JPO-FLD.
           MOVE ZEROES TO JPO-NUM-PNTE IN JPO-FLD.
           MOVE SPACES TO JPO-COD-NAPR IN JPO-FLD.
           MOVE SPACES TO JPO-IND-PNTE IN JPO-FLD.
           MOVE SPACES TO JPO-COD-GARA IN JPO-FLD.
           MOVE SPACES TO JPO-COD-TCDP IN JPO-FLD.
           MOVE SPACES TO JPO-COD-AFER IN JPO-FLD.
           MOVE SPACES TO JPO-COD-AACC IN JPO-FLD.
       FIN-CLR-JPO-JPO.
           EXIT.
       
       FST-KEY-JPO SECTION.
       INI-FST-KEY-JPO.
           MOVE -1 TO JPO-COD-VCAM-LEN IN JPO-FLD.
       FIN-FST-KEY-JPO.
           EXIT.
       
       FST-FLD-JPO SECTION.
       INI-FST-FLD-JPO.
           MOVE -1 TO JPO-COD-OTRN-LEN IN JPO-FLD.
       FIN-FST-FLD-JPO.
           EXIT.
       
       PRO-KEY-JPO SECTION.
       INI-PRO-KEY-JPO.
           PERFORM PRO-IKY-JPO.
           PERFORM PRO-AKY-JPO.
           PERFORM PRO-MKY-JPO.
       FIN-PRO-KEY-JPO.
           EXIT.
       
       PRO-IKY-JPO SECTION.
       INI-PRO-IKY-JPO.
           MOVE FRM-CPIM-AEY TO JPO-COD-VCAM-ATR IN JPO-FLD.
           MOVE FRM-CPIM-AEY TO JPO-COD-TOPD-ATR IN JPO-FLD.
           MOVE FRM-CPIM-AEY TO JPO-COD-AOPD-ATR IN JPO-FLD.
           MOVE FRM-CPIM-AEY TO JPO-NUM-IPOD-ATR IN JPO-FLD.
           MOVE FRM-CPIM-AEY TO JPO-FEC-FTRN-ATR IN JPO-FLD.
           MOVE FRM-CPIM-AEY TO JPO-HRA-HRTR-ATR IN JPO-FLD.
       FIN-PRO-IKY-JPO.
           EXIT.
       
       PRO-MKY-JPO SECTION.
       INI-PRO-MKY-JPO.
       FIN-PRO-MKY-JPO.
           EXIT.
       
       PRO-AKY-JPO SECTION.
       INI-PRO-AKY-JPO.
       FIN-PRO-AKY-JPO.
           EXIT.
       
       UNP-KEY-JPO SECTION.
       INI-UNP-KEY-JPO.
           PERFORM UNP-IKY-JPO.
           PERFORM UNP-AKY-JPO.
           PERFORM UNP-MKY-JPO.
       FIN-UNP-KEY-JPO.
           EXIT.
       
       UNP-IKY-JPO SECTION.
       INI-UNP-IKY-JPO.
           MOVE FRM-CPIM-UBY TO JPO-COD-VCAM-ATR.
           MOVE FRM-CPIM-UBY TO JPO-COD-TOPD-ATR.
           MOVE FRM-CPIM-UBY TO JPO-COD-AOPD-ATR.
           MOVE FRM-CPIM-UBY TO JPO-NUM-IPOD-ATR.
           MOVE FRM-CPIM-UBY TO JPO-FEC-FTRN-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-HRA-HRTR-ATR.
       FIN-UNP-IKY-JPO.
           EXIT.
       
       UNP-MKY-JPO SECTION.
       INI-UNP-MKY-JPO.
       FIN-UNP-MKY-JPO.
           EXIT.
       
       UNP-AKY-JPO SECTION.
       INI-UNP-AKY-JPO.
       FIN-UNP-AKY-JPO.
           EXIT.
       
       UNP-FLD-JPO SECTION.
       INI-UNP-FLD-JPO.
           PERFORM UNP-JPO-JPO.
       FIN-UNP-FLD-JPO.
           EXIT.
       
       UNP-JPO-JPO SECTION.
       INI-UNP-JPO-JPO.
           MOVE FRM-CPIM-UBY TO JPO-COD-OTRN-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-TACC-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-STAT-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-ATRN-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-RENO-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-VAL-CMIN-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-ENDO-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-VAL-CMAX-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-BCTI-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-NUM-PMIN-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-IND-PMIN-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-PBTI-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-NUM-PMAX-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-IND-PMAX-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-BPBT-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-SPBT-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-NUM-VMIN-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-NUM-VMAX-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-CVTI-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-NUM-SMNV-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-IND-SMNV-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-NUM-SMXV-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-IND-SMXV-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-TFPR-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-MORE-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-NUM-PREP-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-RESC-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-IND-PREP-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-PLPA-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-IND-VIGE-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-NUM-PLRE-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-IND-PLRE-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-NUM-PNTE-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-NAPR-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-IND-PNTE-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-GARA-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-TCDP-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-AFER-ATR IN JPO-FLD.
           MOVE FRM-CPIM-UBY TO JPO-COD-AACC-ATR IN JPO-FLD.
       FIN-UNP-JPO-JPO.
           EXIT.
       
       VAL-KEY-JPO SECTION.
       INI-VAL-KEY-JPO.
           PERFORM VAL-IKY-JPO.
           PERFORM VAL-MKY-JPO.
           PERFORM VAL-AKY-JPO.
       FIN-VAL-KEY-JPO.
           EXIT.
       
       VAL-IKY-JPO SECTION.
       INI-VAL-IKY-JPO.
           PERFORM VAL-JPO-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO JPO-COD-VCAM-LEN IN JPO-FLD
                GO TO FIN-VAL-IKY-JPO.
           PERFORM VAL-JPO-COD-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO JPO-COD-TOPD-LEN IN JPO-FLD
                GO TO FIN-VAL-IKY-JPO.
           PERFORM VAL-JPO-COD-AOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO JPO-COD-AOPD-LEN IN JPO-FLD
                GO TO FIN-VAL-IKY-JPO.
           PERFORM VAL-JPO-NUM-IPOD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO JPO-NUM-IPOD-LEN IN JPO-FLD
                GO TO FIN-VAL-IKY-JPO.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-JPO-FEC-FTRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                JPO-FEC-FTRN-LEN IN JPO-FLD
                GO TO FIN-VAL-IKY-JPO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-JPO-HRA-HRTR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO JPO-HRA-HRTR-LEN IN JPO-FLD
                GO TO FIN-VAL-IKY-JPO.
       FIN-VAL-IKY-JPO.
           EXIT.
       
       VAL-MKY-JPO SECTION.
       INI-VAL-MKY-JPO.
       FIN-VAL-MKY-JPO.
           EXIT.
       
       VAL-AKY-JPO SECTION.
       INI-VAL-AKY-JPO.
       FIN-VAL-AKY-JPO.
           EXIT.
       
       VAL-JPO-COD-VCAM SECTION.
       INI-VAL-JPO-COD-VCAM.
           IF JPO-COD-VCAM IN JPO-FLD NOT > SPACES
              MOVE SPACES TO JPO-COD-VCAM IN JPO-FLD.
       FIN-VAL-JPO-COD-VCAM.
           EXIT.
       
       VAL-JPO-COD-TOPD SECTION.
       INI-VAL-JPO-COD-TOPD.
           IF JPO-COD-TOPD IN JPO-FLD NOT > SPACES
              MOVE SPACES TO JPO-COD-TOPD IN JPO-FLD.
       FIN-VAL-JPO-COD-TOPD.
           EXIT.
       
       VAL-JPO-COD-AOPD SECTION.
       INI-VAL-JPO-COD-AOPD.
           IF JPO-COD-AOPD IN JPO-FLD NOT > SPACES
              MOVE SPACES TO JPO-COD-AOPD IN JPO-FLD.
       FIN-VAL-JPO-COD-AOPD.
           EXIT.
       
       VAL-JPO-NUM-IPOD SECTION.
       INI-VAL-JPO-NUM-IPOD.
       FIN-VAL-JPO-NUM-IPOD.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-JPO-FEC-FTRN SECTION.
       INI-VAL-JPO-FEC-FTRN.
           IF JPO-FEC-FTRN IN JPO-FLD  NOT > ZEROES
              MOVE ZEROES TO JPO-FEC-FTRN IN JPO-FLD.
      *VAL-FEC Validar Fecha
           MOVE JPO-FEC-FTRN IN JPO-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO JPO-FEC-FTRN IN JPO-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-JPO-FEC-FTRN.
       FIN-VAL-JPO-FEC-FTRN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-JPO-HRA-HRTR SECTION.
       INI-VAL-JPO-HRA-HRTR.
           IF JPO-HRA-HRTR IN JPO-FLD NOT > SPACES
              MOVE SPACES TO JPO-HRA-HRTR IN JPO-FLD.
       FIN-VAL-JPO-HRA-HRTR.
           EXIT.
       
       VAL-CON-KEY-JPO SECTION.
       INI-VAL-CON-KEY-JPO.
      *<<<<
           IF     JPO-COD-VCAM IN JPO-FLD NOT > SPACES                  
              AND JPO-COD-TOPD IN JPO-FLD NOT > SPACES                  
              AND JPO-COD-AOPD IN JPO-FLD NOT > SPACES                  
              AND JPO-NUM-IPOD IN JPO-FLD NOT > ZEROES                  
              AND JPO-FEC-FTRN IN JPO-FLD NOT > SPACES                  
              AND JPO-NUM-DTRN IN JPO-FLD NOT > SPACES                  
              AND JPO-NUM-MTRN IN JPO-FLD NOT > SPACES                  
              AND JPO-NUM-STRN IN JPO-FLD NOT > SPACES                  
              AND JPO-NUM-ATRN IN JPO-FLD NOT > SPACES                  
              AND JPO-HRA-HRTR IN JPO-FLD NOT > SPACES                  
                PERFORM ERR-KEY                                         
                PERFORM FST-KEY-JPO.                                    
           GO TO FIN-VAL-CON-KEY-JPO.
      *>>>>
           IF     JPO-COD-VCAM IN JPO-FLD NOT > SPACES 
              AND JPO-COD-TOPD IN JPO-FLD NOT > SPACES 
              AND JPO-COD-AOPD IN JPO-FLD NOT > SPACES 
              AND JPO-NUM-IPOD IN JPO-FLD NOT > ZEROES 
              AND JPO-FEC-FTRN IN JPO-FLD NOT > ZEROES
              AND JPO-HRA-HRTR IN JPO-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-JPO.
       FIN-VAL-CON-KEY-JPO.
           EXIT.
       
       VAL-CON-IKY-JPO SECTION.
       INI-VAL-CON-IKY-JPO.
      *<<<<
           IF     JPO-COD-VCAM IN JPO-FLD NOT > SPACES                  
              AND JPO-COD-TOPD IN JPO-FLD NOT > SPACES                  
              AND JPO-COD-AOPD IN JPO-FLD NOT > SPACES                  
              AND JPO-NUM-IPOD IN JPO-FLD NOT > ZEROES                  
              AND JPO-FEC-FTRN IN JPO-FLD NOT > SPACES                  
              AND JPO-HRA-HRTR IN JPO-FLD NOT > SPACES                  
                PERFORM ERR-KEY                                         
                PERFORM FST-KEY-JPO.                                    
           GO TO FIN-VAL-CON-IKY-JPO.
      *>>>>
           IF     JPO-COD-VCAM IN JPO-FLD NOT > SPACES 
              AND JPO-COD-TOPD IN JPO-FLD NOT > SPACES 
              AND JPO-COD-AOPD IN JPO-FLD NOT > SPACES 
              AND JPO-NUM-IPOD IN JPO-FLD NOT > ZEROES 
              AND JPO-FEC-FTRN IN JPO-FLD NOT > ZEROES
              AND JPO-HRA-HRTR IN JPO-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-JPO.
       FIN-VAL-CON-IKY-JPO.
           EXIT.
       
       VAL-NUM-KEY-JPO SECTION.
       INI-VAL-NUM-KEY-JPO.
           PERFORM VAL-NUM-IKY-JPO.
           PERFORM VAL-NUM-MKY-JPO.
           PERFORM VAL-NUM-AKY-JPO.
       FIN-VAL-NUM-KEY-JPO.
           EXIT.
       
       VAL-NUM-IKY-JPO SECTION.
       INI-VAL-NUM-IKY-JPO.
       VAL-NUM-JPO-NUM-IPOD.
           MOVE JPO-NUM-IPOD-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 1 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-IPOD IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-IPOD-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-IKY-JPO.
       FIN-VAL-NUM-IKY-JPO.
           EXIT.
       
       VAL-NUM-MKY-JPO SECTION.
       INI-VAL-NUM-MKY-JPO.
       FIN-VAL-NUM-MKY-JPO.
           EXIT.
       
       VAL-NUM-AKY-JPO SECTION.
       INI-VAL-NUM-AKY-JPO.
       FIN-VAL-NUM-AKY-JPO.
           EXIT.
       
       VAL-NUM-FLD-JPO SECTION.
       INI-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-VAL-CMIN.
           MOVE JPO-VAL-CMIN-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO JPO-VAL-CMIN IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-VAL-CMIN-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-VAL-CMAX.
           MOVE JPO-VAL-CMAX-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO JPO-VAL-CMAX IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-VAL-CMAX-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-NUM-PMIN.
           MOVE JPO-NUM-PMIN-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-PMIN IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-PMIN-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-NUM-PMAX.
           MOVE JPO-NUM-PMAX-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-PMAX IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-PMAX-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-NUM-VMIN.
           MOVE JPO-NUM-VMIN-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-VMIN IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-VMIN-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-NUM-VMAX.
           MOVE JPO-NUM-VMAX-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-VMAX IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-VMAX-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-NUM-SMNV.
           MOVE JPO-NUM-SMNV-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-SMNV IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-SMNV-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-NUM-SMXV.
           MOVE JPO-NUM-SMXV-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-SMXV IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-SMXV-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-NUM-PREP.
           MOVE JPO-NUM-PREP-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-PREP IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-PREP-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-NUM-PLRE.
           MOVE JPO-NUM-PLRE-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-PLRE IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-PLRE-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       VAL-NUM-JPO-NUM-PNTE.
           MOVE JPO-NUM-PNTE-ALF IN JPO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO JPO-NUM-PNTE IN JPO-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO JPO-NUM-PNTE-LEN IN JPO-FLD
                GO TO FIN-VAL-NUM-FLD-JPO.
       FIN-VAL-NUM-FLD-JPO.
           EXIT.
       
       EDT-KEY-JPO SECTION.
       INI-EDT-KEY-JPO.
           PERFORM EDT-IKY-JPO.
           PERFORM EDT-MKY-JPO.
           PERFORM EDT-AKY-JPO.
       FIN-EDT-KEY-JPO.
           EXIT.
       
       EDT-IKY-JPO SECTION.
       INI-EDT-IKY-JPO.
           IF JPO-NUM-IPOD-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-IPOD-LEN IN JPO-FLD
                GO TO FIN-EDT-IKY-JPO.
           MOVE JPO-NUM-IPOD IN JPO-FLD TO JPO-NUM-IPOD-EDT IN JPO-EDT.
           MOVE JPO-NUM-IPOD-EDT IN JPO-EDT TO 
                JPO-NUM-IPOD-ALF IN JPO-FLD.
       FIN-EDT-IKY-JPO.
           EXIT.
       
       EDT-MKY-JPO SECTION.
       INI-EDT-MKY-JPO.
       FIN-EDT-MKY-JPO.
           EXIT.
       
       EDT-AKY-JPO SECTION.
       INI-EDT-AKY-JPO.
       FIN-EDT-AKY-JPO.
           EXIT.
       
       EDT-FLD-JPO SECTION.
       INI-EDT-FLD-JPO.
           IF JPO-VAL-CMIN-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-VAL-CMIN-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-VAL-CMIN IN JPO-FLD TO JPO-VAL-CMIN-EDT IN JPO-EDT.
           MOVE JPO-VAL-CMIN-EDT IN JPO-EDT TO 
                JPO-VAL-CMIN-ALF IN JPO-FLD.
           IF JPO-VAL-CMAX-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-VAL-CMAX-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-VAL-CMAX IN JPO-FLD TO JPO-VAL-CMAX-EDT IN JPO-EDT.
           MOVE JPO-VAL-CMAX-EDT IN JPO-EDT TO 
                JPO-VAL-CMAX-ALF IN JPO-FLD.
           IF JPO-NUM-PMIN-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-PMIN-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-NUM-PMIN IN JPO-FLD TO JPO-NUM-PMIN-EDT IN JPO-EDT.
           MOVE JPO-NUM-PMIN-EDT IN JPO-EDT TO 
                JPO-NUM-PMIN-ALF IN JPO-FLD.
           IF JPO-NUM-PMAX-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-PMAX-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-NUM-PMAX IN JPO-FLD TO JPO-NUM-PMAX-EDT IN JPO-EDT.
           MOVE JPO-NUM-PMAX-EDT IN JPO-EDT TO 
                JPO-NUM-PMAX-ALF IN JPO-FLD.
           IF JPO-NUM-VMIN-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-VMIN-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-NUM-VMIN IN JPO-FLD TO JPO-NUM-VMIN-EDT IN JPO-EDT.
           MOVE JPO-NUM-VMIN-EDT IN JPO-EDT TO 
                JPO-NUM-VMIN-ALF IN JPO-FLD.
           IF JPO-NUM-VMAX-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-VMAX-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-NUM-VMAX IN JPO-FLD TO JPO-NUM-VMAX-EDT IN JPO-EDT.
           MOVE JPO-NUM-VMAX-EDT IN JPO-EDT TO 
                JPO-NUM-VMAX-ALF IN JPO-FLD.
           IF JPO-NUM-SMNV-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-SMNV-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-NUM-SMNV IN JPO-FLD TO JPO-NUM-SMNV-EDT IN JPO-EDT.
           MOVE JPO-NUM-SMNV-EDT IN JPO-EDT TO 
                JPO-NUM-SMNV-ALF IN JPO-FLD.
           IF JPO-NUM-SMXV-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-SMXV-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-NUM-SMXV IN JPO-FLD TO JPO-NUM-SMXV-EDT IN JPO-EDT.
           MOVE JPO-NUM-SMXV-EDT IN JPO-EDT TO 
                JPO-NUM-SMXV-ALF IN JPO-FLD.
           IF JPO-NUM-PREP-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-PREP-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-NUM-PREP IN JPO-FLD TO JPO-NUM-PREP-EDT IN JPO-EDT.
           MOVE JPO-NUM-PREP-EDT IN JPO-EDT TO 
                JPO-NUM-PREP-ALF IN JPO-FLD.
           IF JPO-NUM-PLRE-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-PLRE-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-NUM-PLRE IN JPO-FLD TO JPO-NUM-PLRE-EDT IN JPO-EDT.
           MOVE JPO-NUM-PLRE-EDT IN JPO-EDT TO 
                JPO-NUM-PLRE-ALF IN JPO-FLD.
           IF JPO-NUM-PNTE-LEN IN JPO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO JPO-NUM-PNTE-LEN IN JPO-FLD
                GO TO FIN-EDT-FLD-JPO.
           MOVE JPO-NUM-PNTE IN JPO-FLD TO JPO-NUM-PNTE-EDT IN JPO-EDT.
           MOVE JPO-NUM-PNTE-EDT IN JPO-EDT TO 
                JPO-NUM-PNTE-ALF IN JPO-FLD.
       FIN-EDT-FLD-JPO.
           EXIT.
