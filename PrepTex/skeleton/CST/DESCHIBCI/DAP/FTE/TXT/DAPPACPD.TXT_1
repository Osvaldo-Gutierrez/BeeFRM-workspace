*%! Codigo adicional para DAPPACPD
*% IF SETTAG
*% FNCPQ = "MK2MT1"
*% VSNPQ = "08.01.10"
*% FNCPU = "MK2MT1"
*% VSNPU = "08.01.10"
*% END
*% NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF INI_FIO
      *<<<< INI_FIO
           PERFORM GET-FHOY.
      *>>>> INI_FIO
*% END INI_FIO
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSWGHOY.
       COPY DAPBRPOD.
*% IF PGM_PQ
      *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
       COPY DAPWGPPD.
       COPY MC2BRPPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PPD-REQA==.
       COPY TABWGRCC.
      *OGB-FIN 13-ENE-2017 BALANCE OPTIMO DAP
*% END

      *>>>> WSS
*% IF PGM_PQ
      *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
       01  WSS-CONSTANTES.
           03  WSS-CTE-N            VALUE 'N'        PIC X(01).
           03  WSS-CTE-S            VALUE 'S'        PIC X(01).
           03  WSS-CTE-23           VALUE '23'       PIC X(02).
           03  WSS-CTE-DAP          VALUE 'DAP'      PIC X(03).
           03  WSS-CTE-CNN          VALUE 'CNN'      PIC X(03).
           03  WSS-CTE-327          VALUE '327'      PIC X(03).

      *OGB-FIN 13-ENE-2017 BALANCE OPTIMO DAP
*% END
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POD-REQA==.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY

           MOVE CPD-COD-VCAM IN CPD-FLD TO POD-COD-VCAM IN POD.
           MOVE CPD-COD-TOPD IN CPD-FLD TO POD-COD-TOPD IN POD.
           MOVE CPD-COD-AOPD IN CPD-FLD TO POD-COD-AOPD IN POD.
           MOVE ZEROES                  TO POD-NUM-IPOD IN POD. 
      *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
      *    MOVE FIO-GET-KEY TO FIO-CMND.
      *    PERFORM DAP-FIO-POD.
      *    IF NOT FIO-STAT-OKS
      *        MOVE 'DAP'        TO MSG-COD-SIST
      *        MOVE 'POD    NEX' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FIO-STAT-NEX TO FIO-STAT
      *        MOVE SCR-STAT-CON TO SCR-STAT
      *        GO TO FIN-FND-KEY.
           MOVE WSS-CTE-DAP TO TAB-COD-SIST.
           MOVE WSS-CTE-DAP TO FIO-SIST.
           MOVE WSS-CTE-CNN TO TAB-COD-TTAB IN TAB.
           MOVE SCR-CNAL TO TAB-COD-CTAB IN TAB.
           IF NOT SCR-OFRM-SRV
              MOVE WSS-CTE-327 TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = WSS-CTE-S
              MOVE TAB-GLS-DESC IN TAB      TO PPD-GLS-CNAL IN PPD-VARI
              MOVE PPD-CNAL-MC2 IN PPD-VARI TO PPD-COD-TCNL IN PPD-VARI.

           MOVE POD-COD-VCAM IN POD TO PPD-COD-VCOC IN PPD-VARI.
           MOVE POD-COD-TOPD IN POD TO PPD-COD-TOOC IN PPD-VARI.
           MOVE POD-COD-AOPD IN POD TO PPD-COD-AOOC IN PPD-VARI.
           IF SCR-OFRM-SRV
              MOVE TSK-TERM-ALF TO PPD-COD-TERM-PPD IN PPD-VARI
              MOVE WSS-CTE-S    TO PPD-OFRM-SRV     IN PPD-VARI
           ELSE
              MOVE EIBTRMID     TO PPD-COD-TERM-PPD IN PPD-VARI
              MOVE WSS-CTE-N    TO PPD-OFRM-SRV     IN PPD-VARI.

           PERFORM CON-MC2-MPPD.
           IF RCC-COD-MENS IN RCC-VARI > SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE WSS-CTE-23   TO FIO-STAT
               GO TO FIN-FND-KEY.
      *OGB-FIN 13-ENE-2017 BALANCE OPTIMO DAP
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      *>>>> FIN_FND_KEY
*% END
*% IF FIN_SCR_TRL
      *<<<< FIN_SCR_TRL
      *>>>> FIN_SCR_TRL
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
      *>>>> FIN_HBL_FLD
*% END
*% IF SCR_GFLD_VAL_FLD
      *<<<< SCR_GFLD_VAL_FLD

      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           PERFORM PUT-FTRN.
      *>>>> CMN_ING
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
      *>>>> FIN_CMN_ING
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
      *>>>> CMN_MOD_RET
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
      *>>>> INI_CMN_MOD
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
      *>>>> CMN_ELI
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
      *>>>> FIN_CMN_ELI
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
      *>>>> CMN_ACC
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       COPY DAPBFPOD.
      *>>>> EOF_PQ
*% END
*% IF EOF_PU
      *<<<< EOF_PU
      *>>>> EOF_PU
*% END
*% IF EOF
      *<<<< EOF
*% IF PGM_PQ
      *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
       COPY DAPBGPPD.
       COPY TABBKRCC.
       COPY MC2BFPPD.
      *OGB-FIN 13-ENE-2017 BALANCE OPTIMO DAP
*% END

       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.

      *Entidades de DAP
       COPY GNSBGHOY.

       PUT-FTRN SECTION.
       INI-PUT-FTRN.
           MOVE HOY-DHOY TO CPD-NUM-DTRN IN CPD.
           MOVE HOY-MHOY TO CPD-NUM-MTRN IN CPD.
           MOVE HOY-SHOY TO CPD-NUM-STRN IN CPD.
           MOVE HOY-AHOY TO CPD-NUM-ATRN IN CPD.

      *     MOVE HOY-DHOY TO CPD-NUM-DTRN IN CPD-FLD.
      *     MOVE HOY-MHOY TO CPD-NUM-MTRN IN CPD-FLD.
      *     MOVE HOY-SHOY TO CPD-NUM-STRN IN CPD-FLD.
      *     MOVE HOY-AHOY TO CPD-NUM-ATRN IN CPD-FLD.

      *     MOVE HOY-HHOY TO CPD-HRA-HRTR IN CPD-FLD.
           MOVE HOY-HHOY TO CPD-HRA-HRTR IN CPD.

       FIN-PUT-FTRN.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE 'DAP' TO FIO-SIST.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.
      *>>>>
*% END
