      * 29-Nov-89 11:25 AM
       PUT-ALL-S21 SECTION.
       INI-PUT-ALL-S21.
           PERFORM PUT-D02-S21.
      *<<<< FIN_PUT_ALL_S21
           PERFORM PUT-ALL-S22.
      *>>>>
       FIN-PUT-ALL-S21.
           EXIT.

       PUT-D02-S21 SECTION.
       INI-PUT-D02-S21.
           IF PGM-STAT-D02-NUL
               GO TO FIN-PUT-D02-S21.
           IF NOT PGM-STAT-D02-OKS
               PERFORM CLR-D02-S21
               GO TO FIN-PUT-D02-S21.
           MOVE D02-GLS-NOMD IN D02 TO D02-GLS-NOMD IN S21-FLD.
           MOVE D02-NUM-RUTD IN D02 TO D02-NUM-RUTD IN S21-FLD.
           MOVE D02-VRF-RUTD IN D02 TO D02-VRF-RUTD IN S21-FLD.
           MOVE D02-COD-NIIO IN D02 TO D02-COD-NIIO IN S21-FLD.
           MOVE D02-IND-TDOP IN D02 TO D02-IND-TDOP IN S21-FLD.
           MOVE D02-COD-NIIG IN D02 TO D02-COD-NIIG IN S21-FLD.
           MOVE D02-NUM-RDDA IN D02 TO D02-NUM-RDDA IN S21-FLD.
           MOVE D02-VRF-RDDA IN D02 TO D02-VRF-RDDA IN S21-FLD.
           MOVE D02-VAL-PPCC IN D02 TO D02-VAL-PPCC IN S21-FLD.
           MOVE D02-NUM-PPPR IN D02 TO D02-NUM-PPPR IN S21-FLD.
           MOVE D02-VAL-MOOP IN D02 TO D02-VAL-MOOP IN S21-FLD.
           MOVE D02-VAL-RCCV IN D02 TO D02-VAL-RCCV IN S21-FLD.
           MOVE D02-VAL-SCON IN D02 TO D02-VAL-SCON IN S21-FLD.
           MOVE D02-VAL-ICCB IN D02 TO D02-VAL-ICCB IN S21-FLD.
           MOVE D02-VAL-SCVD IN D02 TO D02-VAL-SCVD IN S21-FLD.
           MOVE D02-VAL-RCCR IN D02 TO D02-VAL-RCCR IN S21-FLD.
           MOVE D02-VAL-SCIL IN D02 TO D02-VAL-SCIL IN S21-FLD.
           MOVE D02-VAL-ICCR IN D02 TO D02-VAL-ICCR IN S21-FLD.
           MOVE D02-VAL-SCOI IN D02 TO D02-VAL-SCOI IN S21-FLD.
           MOVE D02-VAL-RCCL IN D02 TO D02-VAL-RCCL IN S21-FLD.
           MOVE D02-VAL-SMOR IN D02 TO D02-VAL-SMOR IN S21-FLD.
           MOVE D02-VAL-ICCL IN D02 TO D02-VAL-ICCL IN S21-FLD.
           MOVE D02-VAL-SCVC IN D02 TO D02-VAL-SCVC IN S21-FLD.
           MOVE D02-VAL-UINP IN D02 TO D02-VAL-UINP IN S21-FLD.
           MOVE D02-VAL-SCVV IN D02 TO D02-VAL-SCVV IN S21-FLD.
           MOVE D02-NUM-CAPV IN D02 TO D02-NUM-CAPV IN S21-FLD.
           MOVE D02-VAL-IPCO IN D02 TO D02-VAL-IPCO IN S21-FLD.
           MOVE D02-VAL-IPCV IN D02 TO D02-VAL-IPCV IN S21-FLD.
           MOVE D02-IND-OPAV IN D02 TO D02-IND-OPAV IN S21-FLD.
           MOVE D02-NUM-DDIR IN D02 TO D02-NUM-DDIR IN S21-FLD.
           MOVE D02-IND-DEXC IN D02 TO D02-IND-DEXC IN S21-FLD.
           MOVE D02-IND-DCAS IN D02 TO D02-IND-DCAS IN S21-FLD.
       FIN-PUT-D02-S21.
           EXIT.

       RET-ALL-S21 SECTION.
       INI-RET-ALL-S21.
           PERFORM KEY-ALL-S21.
           PERFORM RET-D02-S21.
       FIN-RET-ALL-S21.
           EXIT.

       RET-D02-S21 SECTION.
       INI-RET-D02-S21.
           MOVE D02-GLS-NOMD IN S21-FLD TO D02-GLS-NOMD IN D02.
           MOVE D02-COD-NIIG IN S21-FLD TO D02-COD-NIIG IN D02.
           MOVE D02-NUM-RDDA IN S21-FLD TO D02-NUM-RDDA IN D02.
           MOVE D02-VRF-RDDA IN S21-FLD TO D02-VRF-RDDA IN D02.
           MOVE D02-VAL-PPCC IN S21-FLD TO D02-VAL-PPCC IN D02.
           MOVE D02-NUM-PPPR IN S21-FLD TO D02-NUM-PPPR IN D02.
           MOVE D02-VAL-MOOP IN S21-FLD TO D02-VAL-MOOP IN D02.
           MOVE D02-VAL-RCCV IN S21-FLD TO D02-VAL-RCCV IN D02.
           MOVE D02-VAL-SCON IN S21-FLD TO D02-VAL-SCON IN D02.
           MOVE D02-VAL-ICCB IN S21-FLD TO D02-VAL-ICCB IN D02.
           MOVE D02-VAL-SCVD IN S21-FLD TO D02-VAL-SCVD IN D02.
           MOVE D02-VAL-RCCR IN S21-FLD TO D02-VAL-RCCR IN D02.
           MOVE D02-VAL-SCIL IN S21-FLD TO D02-VAL-SCIL IN D02.
           MOVE D02-VAL-ICCR IN S21-FLD TO D02-VAL-ICCR IN D02.
           MOVE D02-VAL-SCOI IN S21-FLD TO D02-VAL-SCOI IN D02.
           MOVE D02-VAL-RCCL IN S21-FLD TO D02-VAL-RCCL IN D02.
           MOVE D02-VAL-SMOR IN S21-FLD TO D02-VAL-SMOR IN D02.
           MOVE D02-VAL-ICCL IN S21-FLD TO D02-VAL-ICCL IN D02.
           MOVE D02-VAL-SCVC IN S21-FLD TO D02-VAL-SCVC IN D02.
           MOVE D02-VAL-UINP IN S21-FLD TO D02-VAL-UINP IN D02.
           MOVE D02-VAL-SCVV IN S21-FLD TO D02-VAL-SCVV IN D02.
           MOVE D02-NUM-CAPV IN S21-FLD TO D02-NUM-CAPV IN D02.
           MOVE D02-VAL-IPCO IN S21-FLD TO D02-VAL-IPCO IN D02.
           MOVE D02-VAL-IPCV IN S21-FLD TO D02-VAL-IPCV IN D02.
           MOVE D02-IND-OPAV IN S21-FLD TO D02-IND-OPAV IN D02.
           MOVE D02-NUM-DDIR IN S21-FLD TO D02-NUM-DDIR IN D02.
           MOVE D02-IND-DEXC IN S21-FLD TO D02-IND-DEXC IN D02.
           MOVE D02-IND-DCAS IN S21-FLD TO D02-IND-DCAS IN D02.
      *<<<< INI_KEY_D02_S21 OR FIN_RET_D02_S21
           MOVE '2' TO D02-IND-TREG IN D02.
      *>>>>
       FIN-RET-D02-S21.
           EXIT.

       KEY-ALL-S21 SECTION.
       INI-KEY-ALL-S21.
           PERFORM KEY-D02-S21.
       FIN-KEY-ALL-S21.
           EXIT.

       KEY-D02-S21 SECTION.
       INI-KEY-D02-S21.
      *<<<< INI_KEY_D02_S21 OR FIN_RET_D02_S21
           MOVE '2' TO D02-IND-TREG IN D02.
      *>>>>
           MOVE D02-NUM-RUTD IN S21-FLD TO D02-NUM-RUTD IN D02.
           MOVE D02-VRF-RUTD IN S21-FLD TO D02-VRF-RUTD IN D02.
           MOVE D02-COD-NIIO IN S21-FLD TO D02-COD-NIIO IN D02.
           MOVE D02-IND-TDOP IN S21-FLD TO D02-IND-TDOP IN D02.
       FIN-KEY-D02-S21.
           EXIT.

       SCR-CLRA-S21 SECTION.
       INI-SCR-CLRA-S21.
           PERFORM CLR-KEY-S21.
           PERFORM CLR-FLD-S21.
      *<<<< FIN_SCR_CLRA_S21
           PERFORM SCR-CLRA-S22.
      *>>>>
       FIN-SCR-CLRA-S21.
           EXIT.

       CLR-KEY-S21 SECTION.
       INI-CLR-KEY-S21.
           MOVE ZEROES TO D02-NUM-RUTD IN S21-FLD.
           MOVE SPACES TO D02-VRF-RUTD IN S21-FLD.
           MOVE SPACES TO D02-COD-NIIO IN S21-FLD.
           MOVE SPACES TO D02-IND-TDOP IN S21-FLD.
       FIN-CLR-KEY-S21.
           EXIT.

       CLR-FLD-S21 SECTION.
       INI-CLR-FLD-S21.
           PERFORM CLR-D02-S21.
       FIN-CLR-FLD-S21.
           EXIT.

       CLR-D02-S21 SECTION.
       INI-CLR-D02-S21.
           MOVE SPACES TO D02-GLS-NOMD IN S21-FLD.
           MOVE SPACES TO D02-COD-NIIG IN S21-FLD.
           MOVE ZEROES TO D02-NUM-RDDA IN S21-FLD.
           MOVE SPACES TO D02-VRF-RDDA IN S21-FLD.
           MOVE ZEROES TO D02-VAL-PPCC IN S21-FLD.
           MOVE ZEROES TO D02-NUM-PPPR IN S21-FLD.
           MOVE ZEROES TO D02-VAL-MOOP IN S21-FLD.
           MOVE ZEROES TO D02-VAL-RCCV IN S21-FLD.
           MOVE ZEROES TO D02-VAL-SCON IN S21-FLD.
           MOVE ZEROES TO D02-VAL-ICCB IN S21-FLD.
           MOVE ZEROES TO D02-VAL-SCVD IN S21-FLD.
           MOVE ZEROES TO D02-VAL-RCCR IN S21-FLD.
           MOVE ZEROES TO D02-VAL-SCIL IN S21-FLD.
           MOVE ZEROES TO D02-VAL-ICCR IN S21-FLD.
           MOVE ZEROES TO D02-VAL-SCOI IN S21-FLD.
           MOVE ZEROES TO D02-VAL-RCCL IN S21-FLD.
           MOVE ZEROES TO D02-VAL-SMOR IN S21-FLD.
           MOVE ZEROES TO D02-VAL-ICCL IN S21-FLD.
           MOVE ZEROES TO D02-VAL-SCVC IN S21-FLD.
           MOVE ZEROES TO D02-VAL-UINP IN S21-FLD.
           MOVE ZEROES TO D02-VAL-SCVV IN S21-FLD.
           MOVE ZEROES TO D02-NUM-CAPV IN S21-FLD.
           MOVE ZEROES TO D02-VAL-IPCO IN S21-FLD.
           MOVE ZEROES TO D02-VAL-IPCV IN S21-FLD.
           MOVE SPACES TO D02-IND-OPAV IN S21-FLD.
           MOVE ZEROES TO D02-NUM-DDIR IN S21-FLD.
           MOVE SPACES TO D02-IND-DEXC IN S21-FLD.
           MOVE SPACES TO D02-IND-DCAS IN S21-FLD.
       FIN-CLR-D02-S21.
           EXIT.

       FST-KEY-S21 SECTION.
       INI-FST-KEY-S21.
           MOVE -1 TO D02-NUM-RUTD-LEN IN S21-FLD.
       FIN-FST-KEY-S21.
           EXIT.

       FST-FLD-S21 SECTION.
       INI-FST-FLD-S21.
           MOVE -1 TO D02-GLS-NOMD-LEN IN S21-FLD.
       FIN-FST-FLD-S21.
           EXIT.

       PRO-KEY-S21 SECTION.
       INI-PRO-KEY-S21.
           PERFORM PRO-IKY-S21.
           PERFORM PRO-AKY-S21.
           PERFORM PRO-MKY-S21.
       FIN-PRO-KEY-S21.
           EXIT.

       PRO-IKY-S21 SECTION.
       INI-PRO-IKY-S21.
           MOVE FRM-CPIM-AEY TO D02-NUM-RUTD-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VRF-RUTD-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-NIIO-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-TDOP-ATR IN S21-FLD.
       FIN-PRO-IKY-S21.
           EXIT.

       PRO-MKY-S21 SECTION.
       INI-PRO-MKY-S21.
       FIN-PRO-MKY-S21.
           EXIT.

       PRO-AKY-S21 SECTION.
       INI-PRO-AKY-S21.
       FIN-PRO-AKY-S21.
           EXIT.

       PRO-FLD-S21 SECTION.
       INI-PRO-FLD-S21.
           PERFORM PRO-D02-S21.
       FIN-PRO-FLD-S21.
           EXIT.

       PRO-D02-S21 SECTION.
       INI-PRO-D02-S21.
           MOVE FRM-CPIM-AEY TO D02-GLS-NOMD-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-NIIG-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-RDDA-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VRF-RDDA-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-PPCC-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-PPPR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-MOOP-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-RCCV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCON-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-ICCB-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCVD-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-RCCR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCIL-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-ICCR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCOI-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-RCCL-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SMOR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-ICCL-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCVC-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-UINP-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCVV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-CAPV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-IPCO-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-IPCV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-OPAV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-DDIR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-DEXC-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-DCAS-ATR IN S21-FLD.
       FIN-PRO-D02-S21.
           EXIT.

       UNP-KEY-S21 SECTION.
       INI-UNP-KEY-S21.
           PERFORM UNP-IKY-S21.
           PERFORM UNP-AKY-S21.
           PERFORM UNP-MKY-S21.
       FIN-UNP-KEY-S21.
           EXIT.

       UNP-IKY-S21 SECTION.
       INI-UNP-IKY-S21.
           MOVE FRM-CPIM-UBY TO D02-NUM-RUTD-ATR.
           MOVE FRM-CPIM-UBY TO D02-VRF-RUTD-ATR.
           MOVE FRM-CPIM-UBY TO D02-COD-NIIO-ATR.
           MOVE FRM-CPIM-UBY TO D02-IND-TDOP-ATR.
       FIN-UNP-IKY-S21.
           EXIT.

       UNP-MKY-S21 SECTION.
       INI-UNP-MKY-S21.
       FIN-UNP-MKY-S21.
           EXIT.

       UNP-AKY-S21 SECTION.
       INI-UNP-AKY-S21.
       FIN-UNP-AKY-S21.
           EXIT.

       UNP-FLD-S21 SECTION.
       INI-UNP-FLD-S21.
           PERFORM UNP-D02-S21.
       FIN-UNP-FLD-S21.
           EXIT.

       UNP-D02-S21 SECTION.
       INI-UNP-D02-S21.
           MOVE FRM-CPIM-UBY TO D02-GLS-NOMD-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-COD-NIIG-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-NUM-RDDA-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VRF-RDDA-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-PPCC-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-NUM-PPPR-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-MOOP-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-RCCV-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-SCON-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-ICCB-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-SCVD-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-RCCR-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-SCIL-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-ICCR-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-SCOI-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-RCCL-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-SMOR-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-ICCL-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-SCVC-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-UINP-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-SCVV-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-NUM-CAPV-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-IPCO-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-IPCV-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-OPAV-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-NUM-DDIR-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-DEXC-ATR IN S21-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-DCAS-ATR IN S21-FLD.
       FIN-UNP-D02-S21.
           EXIT.

       VAL-KEY-S21 SECTION.
       INI-VAL-KEY-S21.
           PERFORM VAL-IKY-S21.
           PERFORM VAL-MKY-S21.
           PERFORM VAL-AKY-S21.
       FIN-VAL-KEY-S21.
           EXIT.

       VAL-IKY-S21 SECTION.
       INI-VAL-IKY-S21.
           PERFORM VAL-D02-NUM-RUTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-NUM-RUTD-LEN IN S21-FLD
                GO TO FIN-VAL-IKY-S21.
           PERFORM VAL-D02-VRF-RUTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VRF-RUTD-LEN IN S21-FLD
                GO TO FIN-VAL-IKY-S21.
           PERFORM VAL-D02-COD-NIIO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-NIIO-LEN IN S21-FLD
                GO TO FIN-VAL-IKY-S21.
           PERFORM VAL-D02-IND-TDOP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-TDOP-LEN IN S21-FLD
                GO TO FIN-VAL-IKY-S21.
       FIN-VAL-IKY-S21.
           EXIT.

       VAL-MKY-S21 SECTION.
       INI-VAL-MKY-S21.
       FIN-VAL-MKY-S21.
           EXIT.

       VAL-AKY-S21 SECTION.
       INI-VAL-AKY-S21.
       FIN-VAL-AKY-S21.
           EXIT.

       VAL-FLD-S21 SECTION.
       INI-VAL-FLD-S21.
           PERFORM VAL-D02-GLS-NOMD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-GLS-NOMD-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-COD-NIIG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-NIIG-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-NUM-RDDA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-NUM-RDDA-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VRF-RDDA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VRF-RDDA-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-PPCC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-PPCC-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-NUM-PPPR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-NUM-PPPR-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-MOOP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-MOOP-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-RCCV.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-RCCV-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-SCON.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-SCON-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-ICCB.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-ICCB-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-SCVD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-SCVD-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-RCCR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-RCCR-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-SCIL.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-SCIL-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-ICCR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-ICCR-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-SCOI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-SCOI-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-RCCL.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-RCCL-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-SMOR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-SMOR-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-ICCL.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-ICCL-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-SCVC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-SCVC-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-UINP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-UINP-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-SCVV.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-SCVV-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-NUM-CAPV.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-NUM-CAPV-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-IPCO.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-IPCO-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-VAL-IPCV.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-IPCV-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-IND-OPAV.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-OPAV-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-NUM-DDIR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-NUM-DDIR-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-IND-DEXC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-DEXC-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
           PERFORM VAL-D02-IND-DCAS.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-DCAS-LEN IN S21-FLD
                GO TO FIN-VAL-FLD-S21.
       FIN-VAL-FLD-S21.
           EXIT.

       VAL-D02-GLS-NOMD SECTION.
       INI-VAL-D02-GLS-NOMD.
           IF D02-GLS-NOMD IN S21-FLD NOT > SPACES
              MOVE SPACES TO D02-GLS-NOMD IN S21-FLD.
       FIN-VAL-D02-GLS-NOMD.
           EXIT.

       VAL-D02-NUM-RUTD SECTION.
       INI-VAL-D02-NUM-RUTD.
       FIN-VAL-D02-NUM-RUTD.
           EXIT.

       VAL-D02-VRF-RUTD SECTION.
       INI-VAL-D02-VRF-RUTD.
           IF D02-VRF-RUTD IN S21-FLD NOT > SPACES
              MOVE SPACES TO D02-VRF-RUTD IN S21-FLD.
      *VAL-VRF Valida Verificador
           MOVE VRF-VAL TO VRF-CMND.
           MOVE VRF-SVRF-K TO VRF-SVRF.
           MOVE VRF-ZERO-S TO VRF-ZERO.
           MOVE D02-NUM-RUTD IN S21-FLD TO VRF-NUME.
           MOVE D02-VRF-RUTD IN S21-FLD TO VRF-DVRF.
           MOVE 7 TO VRF-LMAX.
           PERFORM PRO-VRF.
      *<<<< D02_VRF_RUTD
      * PRO-VRF
           MOVE D02-NUM-RUTD IN S21-FLD TO VRF-NUME.
           MOVE D02-VRF-RUTD IN S21-FLD TO VRF-DVRF.
           MOVE 7                       TO VRF-LMAX.
           MOVE VRF-ZERO-N              TO VRF-ZERO.
           MOVE VRF-SVRF-K              TO VRF-SVRF.
           MOVE VRF-VAL                 TO VRF-CMND.
           PERFORM PRO-VRF.
      *JSS IF MSG-COD-MENS = SPACES
      *        MOVE VRF-NUME TO D02-NUM-RUTD IN S21-FLD.
      *>>>>
       FIN-VAL-D02-VRF-RUTD.
           EXIT.

       VAL-D02-COD-NIIO SECTION.
       INI-VAL-D02-COD-NIIO.
           IF D02-COD-NIIO IN S21-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-NIIO IN S21-FLD.
      *<<<< D02_COD_NIIO
           IF D02-COD-NIIO IN S21-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
       FIN-VAL-D02-COD-NIIO.
           EXIT.

       VAL-D02-IND-TDOP SECTION.
       INI-VAL-D02-IND-TDOP.
           IF D02-IND-TDOP IN S21-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-TDOP IN S21-FLD.
      *<<<< D02_IND_TDOP
           MOVE 'SUP'                   TO MSC-COD-SIST.
           MOVE 'TDOP'                  TO MSC-COD-TMSC IN MSC.
           MOVE D02-IND-TDOP IN S21-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
       FIN-VAL-D02-IND-TDOP.
           EXIT.

       VAL-D02-COD-NIIG SECTION.
       INI-VAL-D02-COD-NIIG.
           IF D02-COD-NIIG IN S21-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-NIIG IN S21-FLD.
       FIN-VAL-D02-COD-NIIG.
           EXIT.

       VAL-D02-NUM-RDDA SECTION.
       INI-VAL-D02-NUM-RDDA.
       FIN-VAL-D02-NUM-RDDA.
           EXIT.

       VAL-D02-VRF-RDDA SECTION.
       INI-VAL-D02-VRF-RDDA.
           IF D02-VRF-RDDA IN S21-FLD NOT > SPACES
              MOVE SPACES TO D02-VRF-RDDA IN S21-FLD.
      *VAL-VRF Valida Verificador
           MOVE VRF-VAL TO VRF-CMND.
           MOVE VRF-SVRF-K TO VRF-SVRF.
           MOVE VRF-ZERO-S TO VRF-ZERO.
           MOVE D02-NUM-RDDA IN S21-FLD TO VRF-NUME.
           MOVE D02-VRF-RDDA IN S21-FLD TO VRF-DVRF.
           MOVE 7 TO VRF-LMAX.
           PERFORM PRO-VRF.
      *<<<< D02_VRF_RDDA
      * PRO-VRF
           MOVE D02-NUM-RDDA IN S21-FLD TO VRF-NUME.
           MOVE D02-VRF-RDDA IN S21-FLD TO VRF-DVRF.
           MOVE 7                       TO VRF-LMAX.
           MOVE VRF-ZERO-S              TO VRF-ZERO.
           MOVE VRF-SVRF-K              TO VRF-SVRF.
           MOVE VRF-VAL                 TO VRF-CMND.
           PERFORM PRO-VRF.
           IF D02-NUM-RDDA IN S21-FLD = ZEROES AND
               ( D02-IND-TDOP IN S21-FLD = 'C' OR
                 D02-IND-TDOP IN S21-FLD = 'I' )
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'NUMRDDA#BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      * ODJ MAYO/95
      *    IF D02-NUM-RDDA IN S21-FLD NOT = ZEROES AND
      *        ( D02-IND-TDOP IN S21-FLD = 'D' )
      *        MOVE 'SUP'         TO MSG-COD-SIST
      *        MOVE 'NUMRDDA=BLK' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-D02-VRF-RDDA.
           EXIT.

       VAL-D02-VAL-PPCC SECTION.
       INI-VAL-D02-VAL-PPCC.
      *<<<< D02_VAL_PPCC
           IF D02-VAL-PPCC IN S21-FLD > 100
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'VAL    %>100' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
      *<<<< D02_VAL_PPCC
           IF  D02-IND-TDOP IN S21-FLD = 'C' AND
               D02-VAL-PPCC IN S21-FLD = ZEROES
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'VALPPCC#BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

           IF  D02-IND-TDOP IN S21-FLD NOT = 'C' AND
               D02-VAL-PPCC IN S21-FLD NOT = ZEROES
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'VALPPCC=BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-D02-VAL-PPCC.
           EXIT.

       VAL-D02-NUM-PPPR SECTION.
       INI-VAL-D02-NUM-PPPR.
       FIN-VAL-D02-NUM-PPPR.
           EXIT.

       VAL-D02-VAL-MOOP SECTION.
       INI-VAL-D02-VAL-MOOP.
       FIN-VAL-D02-VAL-MOOP.
           EXIT.

       VAL-D02-VAL-RCCV SECTION.
       INI-VAL-D02-VAL-RCCV.
       FIN-VAL-D02-VAL-RCCV.
           EXIT.

       VAL-D02-VAL-SCON SECTION.
       INI-VAL-D02-VAL-SCON.
       FIN-VAL-D02-VAL-SCON.
           EXIT.

       VAL-D02-VAL-ICCB SECTION.
       INI-VAL-D02-VAL-ICCB.
       FIN-VAL-D02-VAL-ICCB.
           EXIT.

       VAL-D02-VAL-SCVD SECTION.
       INI-VAL-D02-VAL-SCVD.
       FIN-VAL-D02-VAL-SCVD.
           EXIT.

       VAL-D02-VAL-RCCR SECTION.
       INI-VAL-D02-VAL-RCCR.
       FIN-VAL-D02-VAL-RCCR.
           EXIT.

       VAL-D02-VAL-SCIL SECTION.
       INI-VAL-D02-VAL-SCIL.
       FIN-VAL-D02-VAL-SCIL.
           EXIT.

       VAL-D02-VAL-ICCR SECTION.
       INI-VAL-D02-VAL-ICCR.
       FIN-VAL-D02-VAL-ICCR.
           EXIT.

       VAL-D02-VAL-SCOI SECTION.
       INI-VAL-D02-VAL-SCOI.
       FIN-VAL-D02-VAL-SCOI.
           EXIT.

       VAL-D02-VAL-RCCL SECTION.
       INI-VAL-D02-VAL-RCCL.
       FIN-VAL-D02-VAL-RCCL.
           EXIT.

       VAL-D02-VAL-SMOR SECTION.
       INI-VAL-D02-VAL-SMOR.
       FIN-VAL-D02-VAL-SMOR.
           EXIT.

       VAL-D02-VAL-ICCL SECTION.
       INI-VAL-D02-VAL-ICCL.
       FIN-VAL-D02-VAL-ICCL.
           EXIT.

       VAL-D02-VAL-SCVC SECTION.
       INI-VAL-D02-VAL-SCVC.
       FIN-VAL-D02-VAL-SCVC.
           EXIT.

       VAL-D02-VAL-UINP SECTION.
       INI-VAL-D02-VAL-UINP.
       FIN-VAL-D02-VAL-UINP.
           EXIT.

       VAL-D02-VAL-SCVV SECTION.
       INI-VAL-D02-VAL-SCVV.
       FIN-VAL-D02-VAL-SCVV.
           EXIT.

       VAL-D02-NUM-CAPV SECTION.
       INI-VAL-D02-NUM-CAPV.
       FIN-VAL-D02-NUM-CAPV.
           EXIT.

       VAL-D02-VAL-IPCO SECTION.
       INI-VAL-D02-VAL-IPCO.
       FIN-VAL-D02-VAL-IPCO.
           EXIT.

       VAL-D02-VAL-IPCV SECTION.
       INI-VAL-D02-VAL-IPCV.
       FIN-VAL-D02-VAL-IPCV.
           EXIT.

       VAL-D02-IND-OPAV SECTION.
       INI-VAL-D02-IND-OPAV.
           IF D02-IND-OPAV IN S21-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-OPAV IN S21-FLD.
      *<<<< D02_IND_OPAV
      *DAD ini
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS'                   TO TAB-COD-SIST.
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB.
           MOVE D02-IND-OPAV IN S21-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *DAD fin
      *>>>>
       FIN-VAL-D02-IND-OPAV.
           EXIT.

       VAL-D02-NUM-DDIR SECTION.
       INI-VAL-D02-NUM-DDIR.
      *<<<< D02_NUM_DDIR
      *DAD ini
      *DAD fin
      *>>>>
       FIN-VAL-D02-NUM-DDIR.
           EXIT.

       VAL-D02-IND-DEXC SECTION.
       INI-VAL-D02-IND-DEXC.
           IF D02-IND-DEXC IN S21-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-DEXC IN S21-FLD.
      *<<<< D02_IND_DEXC
      *DAD ini
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'SUP'                   TO MSC-COD-SIST.
           MOVE 'DEXC'                  TO MSC-COD-TMSC IN MSC.
           MOVE D02-IND-DEXC IN S21-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *DAD fin
      *>>>>
       FIN-VAL-D02-IND-DEXC.
           EXIT.

       VAL-D02-IND-DCAS SECTION.
       INI-VAL-D02-IND-DCAS.
           IF D02-IND-DCAS IN S21-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-DCAS IN S21-FLD.
      *<<<< D02_IND_DCAS
      *DAD ini
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'SUP'                   TO MSC-COD-SIST.
           MOVE 'DCAS'                  TO MSC-COD-TMSC IN MSC.
           MOVE D02-IND-DCAS IN S21-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *DAD fin
      *>>>>
       FIN-VAL-D02-IND-DCAS.
           EXIT.

       VAL-CON-KEY-S21 SECTION.
       INI-VAL-CON-KEY-S21.
           IF     D02-NUM-RUTD IN S21-FLD NOT > ZEROES
              AND D02-VRF-RUTD IN S21-FLD NOT > SPACES
              AND D02-COD-NIIO IN S21-FLD NOT > SPACES
              AND D02-IND-TDOP IN S21-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-S21.
       FIN-VAL-CON-KEY-S21.
           EXIT.

       VAL-CON-IKY-S21 SECTION.
       INI-VAL-CON-IKY-S21.
           IF     D02-NUM-RUTD IN S21-FLD NOT > ZEROES
              AND D02-VRF-RUTD IN S21-FLD NOT > SPACES
              AND D02-COD-NIIO IN S21-FLD NOT > SPACES
              AND D02-IND-TDOP IN S21-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-S21.
       FIN-VAL-CON-IKY-S21.
           EXIT.

       VAL-CON-FLD-S21 SECTION.
       INI-VAL-CON-FLD-S21.
      *<<<< VAL_CON_FLD_S21
      ** ODJ MAYO/95
           IF D02-NUM-RUTD IN S21-FLD = D02-NUM-RDDA IN S21-FLD AND
              D02-IND-TDOP IN S21-FLD NOT = 'D'
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'NUMRUTD=RDDA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

       VAL-RCCV-MOOP.
           IF D02-VAL-RCCV IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCON-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALRCCV>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCON-MOOP.
      *DAD ini  24-FEB-1992
      *     IF D02-VAL-SCON IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
      *         GO TO VAL-ICCB-MOOP.
      *         MOVE 'SUP'          TO MSG-COD-SIST
      *         MOVE 'VALSCON>MOOP' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-S21.
      *DAD fin  24-FEB-1992
       VAL-ICCB-MOOP.
           IF D02-VAL-ICCB IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCVD-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALICCB>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCVD-MOOP.
           IF D02-VAL-SCVD IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-RCCR-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCVD>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-RCCR-MOOP.
           IF D02-VAL-RCCR IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCIL-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALRCCR>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCIL-MOOP.
           IF D02-VAL-SCIL IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-ICCR-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCIL>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-ICCR-MOOP.
           IF D02-VAL-ICCR IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCOI-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALICCR>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCOI-MOOP.
           IF D02-VAL-SCOI IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-RCCL-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCOI>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-RCCL-MOOP.
           IF D02-VAL-RCCL IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SMOR-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALRCCL>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SMOR-MOOP.
           IF D02-VAL-SMOR IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-ICCL-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSMOR>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-ICCL-MOOP.
           IF D02-VAL-ICCL IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCVC-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALICCL>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCVC-MOOP.
           IF D02-VAL-SCVC IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-UINP-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCVC>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-UINP-MOOP.
           IF D02-VAL-UINP IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCVV-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALUINP>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCVV-MOOP.
           IF D02-VAL-SCVV IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-IPCO-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCVV>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-IPCO-MOOP.
           IF D02-VAL-IPCO IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-IPCV-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALIPCO>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-IPCV-MOOP.
           IF D02-VAL-IPCO IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO FIN-VAL-CON-FLD-S21.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALIPCV>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
      *>>>>
       FIN-VAL-CON-FLD-S21.
           EXIT.

       VAL-CON-S21 SECTION.
       INI-VAL-CON-S21.
       FIN-VAL-CON-S21.
           EXIT.

       VAL-NUM-KEY-S21 SECTION.
       INI-VAL-NUM-KEY-S21.
           PERFORM VAL-NUM-IKY-S21.
           PERFORM VAL-NUM-MKY-S21.
           PERFORM VAL-NUM-AKY-S21.
       FIN-VAL-NUM-KEY-S21.
           EXIT.

       VAL-NUM-IKY-S21 SECTION.
       INI-VAL-NUM-IKY-S21.
       VAL-NUM-D02-NUM-RUTD.
           MOVE D02-NUM-RUTD-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D02-NUM-RUTD IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-NUM-RUTD-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-IKY-S21.
       FIN-VAL-NUM-IKY-S21.
           EXIT.

       VAL-NUM-MKY-S21 SECTION.
       INI-VAL-NUM-MKY-S21.
       FIN-VAL-NUM-MKY-S21.
           EXIT.

       VAL-NUM-AKY-S21 SECTION.
       INI-VAL-NUM-AKY-S21.
       FIN-VAL-NUM-AKY-S21.
           EXIT.

       VAL-NUM-FLD-S21 SECTION.
       INI-VAL-NUM-FLD-S21.
       VAL-NUM-D02-NUM-RDDA.
           MOVE D02-NUM-RDDA-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D02-NUM-RDDA IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-NUM-RDDA-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-PPCC.
           MOVE D02-VAL-PPCC-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-PPCC IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-PPCC-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-NUM-PPPR.
           MOVE D02-NUM-PPPR-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D02-NUM-PPPR IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-NUM-PPPR-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-MOOP.
           MOVE D02-VAL-MOOP-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-MOOP IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-MOOP-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-RCCV.
           MOVE D02-VAL-RCCV-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-RCCV IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-RCCV-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-SCON.
           MOVE D02-VAL-SCON-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-SCON IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-SCON-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-ICCB.
           MOVE D02-VAL-ICCB-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-ICCB IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-ICCB-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-SCVD.
           MOVE D02-VAL-SCVD-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-SCVD IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-SCVD-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-RCCR.
           MOVE D02-VAL-RCCR-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-RCCR IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-RCCR-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-SCIL.
           MOVE D02-VAL-SCIL-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-SCIL IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-SCIL-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-ICCR.
           MOVE D02-VAL-ICCR-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-ICCR IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-ICCR-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-SCOI.
           MOVE D02-VAL-SCOI-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-SCOI IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-SCOI-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-RCCL.
           MOVE D02-VAL-RCCL-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-RCCL IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-RCCL-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-SMOR.
           MOVE D02-VAL-SMOR-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-SMOR IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-SMOR-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-ICCL.
           MOVE D02-VAL-ICCL-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-ICCL IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-ICCL-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-SCVC.
           MOVE D02-VAL-SCVC-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-SCVC IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-SCVC-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-UINP.
           MOVE D02-VAL-UINP-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-UINP IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-UINP-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-SCVV.
           MOVE D02-VAL-SCVV-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-SCVV IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-SCVV-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-NUM-CAPV.
           MOVE D02-NUM-CAPV-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D02-NUM-CAPV IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-NUM-CAPV-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-IPCO.
           MOVE D02-VAL-IPCO-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-IPCO IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-IPCO-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-VAL-IPCV.
           MOVE D02-VAL-IPCV-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-IPCV IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-IPCV-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       VAL-NUM-D02-NUM-DDIR.
           MOVE D02-NUM-DDIR-ALF IN S21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 1 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D02-NUM-DDIR IN S21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-NUM-DDIR-LEN IN S21-FLD
                GO TO FIN-VAL-NUM-FLD-S21.
       FIN-VAL-NUM-FLD-S21.
           EXIT.

       EDT-KEY-S21 SECTION.
       INI-EDT-KEY-S21.
           PERFORM EDT-IKY-S21.
           PERFORM EDT-MKY-S21.
           PERFORM EDT-AKY-S21.
       FIN-EDT-KEY-S21.
           EXIT.

       EDT-IKY-S21 SECTION.
       INI-EDT-IKY-S21.
           IF D02-NUM-RUTD-LEN IN S21-FLD = -9
                MOVE -1 TO D02-NUM-RUTD-LEN IN S21-FLD
                GO TO FIN-EDT-IKY-S21.
           MOVE D02-NUM-RUTD IN S21-FLD TO D02-NUM-RUTD-EDT IN S21-EDT.
           MOVE D02-NUM-RUTD-EDT IN S21-EDT TO
                D02-NUM-RUTD-ALF IN S21-FLD.
       FIN-EDT-IKY-S21.
           EXIT.

       EDT-MKY-S21 SECTION.
       INI-EDT-MKY-S21.
       FIN-EDT-MKY-S21.
           EXIT.

       EDT-AKY-S21 SECTION.
       INI-EDT-AKY-S21.
       FIN-EDT-AKY-S21.
           EXIT.

       EDT-FLD-S21 SECTION.
       INI-EDT-FLD-S21.
           IF D02-NUM-RDDA-LEN IN S21-FLD = -9
                MOVE -1 TO D02-NUM-RDDA-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-NUM-RDDA IN S21-FLD TO D02-NUM-RDDA-EDT IN S21-EDT.
           MOVE D02-NUM-RDDA-EDT IN S21-EDT TO
                D02-NUM-RDDA-ALF IN S21-FLD.
           IF D02-VAL-PPCC-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-PPCC-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-PPCC IN S21-FLD TO D02-VAL-PPCC-EDT IN S21-EDT.
           MOVE D02-VAL-PPCC-EDT IN S21-EDT TO
                D02-VAL-PPCC-ALF IN S21-FLD.
           IF D02-NUM-PPPR-LEN IN S21-FLD = -9
                MOVE -1 TO D02-NUM-PPPR-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-NUM-PPPR IN S21-FLD TO D02-NUM-PPPR-EDT IN S21-EDT.
           MOVE D02-NUM-PPPR-EDT IN S21-EDT TO
                D02-NUM-PPPR-ALF IN S21-FLD.
           IF D02-VAL-MOOP-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-MOOP-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-MOOP IN S21-FLD TO D02-VAL-MOOP-EDT IN S21-EDT.
           MOVE D02-VAL-MOOP-EDT IN S21-EDT TO
                D02-VAL-MOOP-ALF IN S21-FLD.
           IF D02-VAL-RCCV-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-RCCV-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-RCCV IN S21-FLD TO D02-VAL-RCCV-EDT IN S21-EDT.
           MOVE D02-VAL-RCCV-EDT IN S21-EDT TO
                D02-VAL-RCCV-ALF IN S21-FLD.
           IF D02-VAL-SCON-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-SCON-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-SCON IN S21-FLD TO D02-VAL-SCON-EDT IN S21-EDT.
           MOVE D02-VAL-SCON-EDT IN S21-EDT TO
                D02-VAL-SCON-ALF IN S21-FLD.
           IF D02-VAL-ICCB-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-ICCB-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-ICCB IN S21-FLD TO D02-VAL-ICCB-EDT IN S21-EDT.
           MOVE D02-VAL-ICCB-EDT IN S21-EDT TO
                D02-VAL-ICCB-ALF IN S21-FLD.
           IF D02-VAL-SCVD-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-SCVD-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-SCVD IN S21-FLD TO D02-VAL-SCVD-EDT IN S21-EDT.
           MOVE D02-VAL-SCVD-EDT IN S21-EDT TO
                D02-VAL-SCVD-ALF IN S21-FLD.
           IF D02-VAL-RCCR-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-RCCR-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-RCCR IN S21-FLD TO D02-VAL-RCCR-EDT IN S21-EDT.
           MOVE D02-VAL-RCCR-EDT IN S21-EDT TO
                D02-VAL-RCCR-ALF IN S21-FLD.
           IF D02-VAL-SCIL-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-SCIL-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-SCIL IN S21-FLD TO D02-VAL-SCIL-EDT IN S21-EDT.
           MOVE D02-VAL-SCIL-EDT IN S21-EDT TO
                D02-VAL-SCIL-ALF IN S21-FLD.
           IF D02-VAL-ICCR-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-ICCR-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-ICCR IN S21-FLD TO D02-VAL-ICCR-EDT IN S21-EDT.
           MOVE D02-VAL-ICCR-EDT IN S21-EDT TO
                D02-VAL-ICCR-ALF IN S21-FLD.
           IF D02-VAL-SCOI-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-SCOI-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-SCOI IN S21-FLD TO D02-VAL-SCOI-EDT IN S21-EDT.
           MOVE D02-VAL-SCOI-EDT IN S21-EDT TO
                D02-VAL-SCOI-ALF IN S21-FLD.
           IF D02-VAL-RCCL-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-RCCL-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-RCCL IN S21-FLD TO D02-VAL-RCCL-EDT IN S21-EDT.
           MOVE D02-VAL-RCCL-EDT IN S21-EDT TO
                D02-VAL-RCCL-ALF IN S21-FLD.
           IF D02-VAL-SMOR-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-SMOR-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-SMOR IN S21-FLD TO D02-VAL-SMOR-EDT IN S21-EDT.
           MOVE D02-VAL-SMOR-EDT IN S21-EDT TO
                D02-VAL-SMOR-ALF IN S21-FLD.
           IF D02-VAL-ICCL-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-ICCL-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-ICCL IN S21-FLD TO D02-VAL-ICCL-EDT IN S21-EDT.
           MOVE D02-VAL-ICCL-EDT IN S21-EDT TO
                D02-VAL-ICCL-ALF IN S21-FLD.
           IF D02-VAL-SCVC-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-SCVC-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-SCVC IN S21-FLD TO D02-VAL-SCVC-EDT IN S21-EDT.
           MOVE D02-VAL-SCVC-EDT IN S21-EDT TO
                D02-VAL-SCVC-ALF IN S21-FLD.
           IF D02-VAL-UINP-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-UINP-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-UINP IN S21-FLD TO D02-VAL-UINP-EDT IN S21-EDT.
           MOVE D02-VAL-UINP-EDT IN S21-EDT TO
                D02-VAL-UINP-ALF IN S21-FLD.
           IF D02-VAL-SCVV-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-SCVV-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-SCVV IN S21-FLD TO D02-VAL-SCVV-EDT IN S21-EDT.
           MOVE D02-VAL-SCVV-EDT IN S21-EDT TO
                D02-VAL-SCVV-ALF IN S21-FLD.
           IF D02-NUM-CAPV-LEN IN S21-FLD = -9
                MOVE -1 TO D02-NUM-CAPV-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-NUM-CAPV IN S21-FLD TO D02-NUM-CAPV-EDT IN S21-EDT.
           MOVE D02-NUM-CAPV-EDT IN S21-EDT TO
                D02-NUM-CAPV-ALF IN S21-FLD.
           IF D02-VAL-IPCO-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-IPCO-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-IPCO IN S21-FLD TO D02-VAL-IPCO-EDT IN S21-EDT.
           MOVE D02-VAL-IPCO-EDT IN S21-EDT TO
                D02-VAL-IPCO-ALF IN S21-FLD.
           IF D02-VAL-IPCV-LEN IN S21-FLD = -9
                MOVE -1 TO D02-VAL-IPCV-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-VAL-IPCV IN S21-FLD TO D02-VAL-IPCV-EDT IN S21-EDT.
           MOVE D02-VAL-IPCV-EDT IN S21-EDT TO
                D02-VAL-IPCV-ALF IN S21-FLD.
           IF D02-NUM-DDIR-LEN IN S21-FLD = -9
                MOVE -1 TO D02-NUM-DDIR-LEN IN S21-FLD
                GO TO FIN-EDT-FLD-S21.
           MOVE D02-NUM-DDIR IN S21-FLD TO D02-NUM-DDIR-EDT IN S21-EDT.
           MOVE D02-NUM-DDIR-EDT IN S21-EDT TO
                D02-NUM-DDIR-ALF IN S21-FLD.
       FIN-EDT-FLD-S21.
           EXIT.
