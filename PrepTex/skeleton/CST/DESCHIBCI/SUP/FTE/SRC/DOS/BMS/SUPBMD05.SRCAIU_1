      * 01-Mar-88 03:49 PM
       PUT-ALL-D05 SECTION.
       INI-PUT-ALL-D05.
           PERFORM PUT-D05-D05.
      *<<<< FIN_PUT_ALL_D05
      *BUS-OFI busca oficina en tablas
           MOVE D05-COD-OFIC IN D05-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN D05-FLD.
      *BUS-USR busca usuario en tablas
           MOVE D05-COD-ACRG IN D05-FLD TO USR-COD-USER IN USR.
           PERFORM BUS-USR.
           MOVE USR-GLS-DESC IN USR TO FRM-GLS-ACRG IN D05-FLD.
      *BUS-USR busca usuario en tablas
           MOVE D05-COD-AUMO IN D05-FLD TO USR-COD-USER IN USR.
           PERFORM BUS-USR.
           MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUMO IN D05-FLD.
      *>>>>
       FIN-PUT-ALL-D05.
           EXIT.
       PUT-D05-D05 SECTION.
       INI-PUT-D05-D05.
           MOVE D05-GLS-NOMD IN D05 TO D05-GLS-NOMD IN D05-FLD.
           MOVE D05-NUM-RUTD IN D05 TO D05-NUM-RUTD IN D05-FLD.
           MOVE D05-VRF-RUTD IN D05 TO D05-VRF-RUTD IN D05-FLD.
           MOVE D05-COD-OPER IN D05 TO D05-COD-OPER IN D05-FLD.
           MOVE D05-IND-RUTD IN D05 TO D05-IND-RUTD IN D05-FLD.
           MOVE D05-GLS-RUTD IN D05 TO D05-GLS-RUTD IN D05-FLD.
           MOVE D05-VAL-DCMN IN D05 TO D05-VAL-DCMN IN D05-FLD.
           MOVE D05-VAL-DCME IN D05 TO D05-VAL-DCME IN D05-FLD.
           MOVE D05-VAL-ICMN IN D05 TO D05-VAL-ICMN IN D05-FLD.
           MOVE D05-VAL-ICME IN D05 TO D05-VAL-ICME IN D05-FLD.
           MOVE D05-COD-OFIC IN D05 TO D05-COD-OFIC IN D05-FLD.
           MOVE D05-NUM-DCAS IN D05 TO D05-NUM-DCAS IN D05-FLD.
           MOVE D05-NUM-MCAS IN D05 TO D05-NUM-MCAS IN D05-FLD.
           MOVE D05-NUM-ACAS IN D05 TO D05-NUM-ACAS IN D05-FLD.
           MOVE D05-NUM-DCRG IN D05 TO D05-NUM-DCRG IN D05-FLD.
           MOVE D05-NUM-MCRG IN D05 TO D05-NUM-MCRG IN D05-FLD.
           MOVE D05-NUM-ACRG IN D05 TO D05-NUM-ACRG IN D05-FLD.
           MOVE D05-NUM-DUMO IN D05 TO D05-NUM-DUMO IN D05-FLD.
           MOVE D05-NUM-MUMO IN D05 TO D05-NUM-MUMO IN D05-FLD.
           MOVE D05-NUM-AUMO IN D05 TO D05-NUM-AUMO IN D05-FLD.
           MOVE D05-COD-ACRG IN D05 TO D05-COD-ACRG IN D05-FLD.
           MOVE D05-COD-AUMO IN D05 TO D05-COD-AUMO IN D05-FLD.
       FIN-PUT-D05-D05.
           EXIT.
       RET-ALL-D05 SECTION.
       INI-RET-ALL-D05.
           PERFORM KEY-ALL-D05.
           PERFORM RET-D05-D05.
       FIN-RET-ALL-D05.
           EXIT.
       RET-D05-D05 SECTION.
       INI-RET-D05-D05.
      *<<<< INI_RET_D05_D05
           MOVE '2' TO D05-IND-TREG IN D05.
      *>>>>
           MOVE D05-GLS-NOMD IN D05-FLD TO D05-GLS-NOMD IN D05.
           MOVE D05-IND-RUTD IN D05-FLD TO D05-IND-RUTD IN D05.
           MOVE D05-GLS-RUTD IN D05-FLD TO D05-GLS-RUTD IN D05.
           MOVE D05-VAL-DCMN IN D05-FLD TO D05-VAL-DCMN IN D05.
           MOVE D05-VAL-DCME IN D05-FLD TO D05-VAL-DCME IN D05.
           MOVE D05-VAL-ICMN IN D05-FLD TO D05-VAL-ICMN IN D05.
           MOVE D05-VAL-ICME IN D05-FLD TO D05-VAL-ICME IN D05.
           MOVE D05-COD-OFIC IN D05-FLD TO D05-COD-OFIC IN D05.
           MOVE D05-NUM-DCAS IN D05-FLD TO D05-NUM-DCAS IN D05.
           MOVE D05-NUM-MCAS IN D05-FLD TO D05-NUM-MCAS IN D05.
           MOVE D05-NUM-ACAS IN D05-FLD TO D05-NUM-ACAS IN D05.
           MOVE D05-NUM-DCRG IN D05-FLD TO D05-NUM-DCRG IN D05.
           MOVE D05-NUM-MCRG IN D05-FLD TO D05-NUM-MCRG IN D05.
           MOVE D05-NUM-ACRG IN D05-FLD TO D05-NUM-ACRG IN D05.
           MOVE D05-NUM-DUMO IN D05-FLD TO D05-NUM-DUMO IN D05.
           MOVE D05-NUM-MUMO IN D05-FLD TO D05-NUM-MUMO IN D05.
           MOVE D05-NUM-AUMO IN D05-FLD TO D05-NUM-AUMO IN D05.
           MOVE D05-COD-ACRG IN D05-FLD TO D05-COD-ACRG IN D05.
           MOVE D05-COD-AUMO IN D05-FLD TO D05-COD-AUMO IN D05.
       FIN-RET-D05-D05.
           EXIT.
       KEY-ALL-D05 SECTION.
       INI-KEY-ALL-D05.
           PERFORM KEY-D05-D05.
       FIN-KEY-ALL-D05.
           EXIT.
       KEY-D05-D05 SECTION.
       INI-KEY-D05-D05.
      *<<<< INI_KEY_D05_D05
           MOVE '2' TO D05-IND-TREG IN D05.
      *>>>>
           MOVE D05-NUM-RUTD IN D05-FLD TO D05-NUM-RUTD IN D05.
           MOVE D05-VRF-RUTD IN D05-FLD TO D05-VRF-RUTD IN D05.
           MOVE D05-COD-OPER IN D05-FLD TO D05-COD-OPER IN D05.
       FIN-KEY-D05-D05.
           EXIT.
       SCR-CLRA-D05 SECTION.
       INI-SCR-CLRA-D05.
           PERFORM CLR-KEY-D05.
           PERFORM CLR-FLD-D05.
       FIN-SCR-CLRA-D05.
           EXIT.
       CLR-KEY-D05 SECTION.
       INI-CLR-KEY-D05.
           MOVE ZEROES TO D05-NUM-RUTD IN D05-FLD.
           MOVE SPACES TO D05-VRF-RUTD IN D05-FLD.
           MOVE SPACES TO D05-COD-OPER IN D05-FLD.
       FIN-CLR-KEY-D05.
           EXIT.
       CLR-FLD-D05 SECTION.
       INI-CLR-FLD-D05.
           MOVE SPACES TO FRM-GLS-OFIC IN D05-FLD.
           MOVE SPACES TO FRM-GLS-ACRG IN D05-FLD.
           MOVE SPACES TO FRM-GLS-AUMO IN D05-FLD.
           PERFORM CLR-D05-D05.
       FIN-CLR-FLD-D05.
           EXIT.
       CLR-D05-D05 SECTION.
       INI-CLR-D05-D05.
           MOVE SPACES TO D05-GLS-NOMD IN D05-FLD.
           MOVE SPACES TO D05-IND-RUTD IN D05-FLD.
           MOVE SPACES TO D05-GLS-RUTD IN D05-FLD.
           MOVE ZEROES TO D05-VAL-DCMN IN D05-FLD.
           MOVE ZEROES TO D05-VAL-DCME IN D05-FLD.
           MOVE ZEROES TO D05-VAL-ICMN IN D05-FLD.
           MOVE ZEROES TO D05-VAL-ICME IN D05-FLD.
           MOVE SPACES TO D05-COD-OFIC IN D05-FLD.
           MOVE SPACES TO D05-DMA-FCAS IN D05-FLD.
           MOVE SPACES TO D05-DMA-FCRG IN D05-FLD.
           MOVE SPACES TO D05-DMA-FUMO IN D05-FLD.
           MOVE SPACES TO D05-COD-ACRG IN D05-FLD.
           MOVE SPACES TO D05-COD-AUMO IN D05-FLD.
       FIN-CLR-D05-D05.
           EXIT.
       FST-KEY-D05 SECTION.
       INI-FST-KEY-D05.
           MOVE -1 TO D05-NUM-RUTD-LEN IN D05-FLD.
       FIN-FST-KEY-D05.
           EXIT.
       FST-FLD-D05 SECTION.
       INI-FST-FLD-D05.
           MOVE -1 TO D05-GLS-NOMD-LEN IN D05-FLD.
       FIN-FST-FLD-D05.
           EXIT.
       PRO-KEY-D05 SECTION.
       INI-PRO-KEY-D05.
           PERFORM PRO-IKY-D05.
           PERFORM PRO-AKY-D05.
           PERFORM PRO-MKY-D05.
       FIN-PRO-KEY-D05.
           EXIT.
       PRO-IKY-D05 SECTION.
       INI-PRO-IKY-D05.
           MOVE FRM-CPIM-AEY TO D05-NUM-RUTD-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-VRF-RUTD-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-COD-OPER-ATR IN D05-FLD.
       FIN-PRO-IKY-D05.
           EXIT.
       PRO-MKY-D05 SECTION.
       INI-PRO-MKY-D05.
       FIN-PRO-MKY-D05.
           EXIT.
       PRO-AKY-D05 SECTION.
       INI-PRO-AKY-D05.
       FIN-PRO-AKY-D05.
           EXIT.
       PRO-FLD-D05 SECTION.
       INI-PRO-FLD-D05.
           PERFORM PRO-D05-D05.
       FIN-PRO-FLD-D05.
           EXIT.
       PRO-D05-D05 SECTION.
       INI-PRO-D05-D05.
           MOVE FRM-CPIM-AEY TO D05-GLS-NOMD-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-IND-RUTD-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-GLS-RUTD-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-VAL-DCMN-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-VAL-DCME-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-VAL-ICMN-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-VAL-ICME-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-COD-OFIC-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-DMA-FCAS-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-COD-ACRG-ATR IN D05-FLD.
           MOVE FRM-CPIM-AEY TO D05-COD-AUMO-ATR IN D05-FLD.
       FIN-PRO-D05-D05.
           EXIT.
       UNP-KEY-D05 SECTION.
       INI-UNP-KEY-D05.
           PERFORM UNP-IKY-D05.
           PERFORM UNP-AKY-D05.
           PERFORM UNP-MKY-D05.
       FIN-UNP-KEY-D05.
           EXIT.
       UNP-IKY-D05 SECTION.
       INI-UNP-IKY-D05.
           MOVE FRM-CPIM-UBY TO D05-NUM-RUTD-ATR.
           MOVE FRM-CPIM-UBY TO D05-VRF-RUTD-ATR.
           MOVE FRM-CPIM-UBY TO D05-COD-OPER-ATR.
       FIN-UNP-IKY-D05.
           EXIT.
       UNP-MKY-D05 SECTION.
       INI-UNP-MKY-D05.
       FIN-UNP-MKY-D05.
           EXIT.
       UNP-AKY-D05 SECTION.
       INI-UNP-AKY-D05.
       FIN-UNP-AKY-D05.
           EXIT.
       UNP-FLD-D05 SECTION.
       INI-UNP-FLD-D05.
           PERFORM UNP-D05-D05.
       FIN-UNP-FLD-D05.
           EXIT.
       UNP-D05-D05 SECTION.
       INI-UNP-D05-D05.
           MOVE FRM-CPIM-UBY TO D05-GLS-NOMD-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-IND-RUTD-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-GLS-RUTD-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-VAL-DCMN-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-VAL-DCME-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-VAL-ICMN-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-VAL-ICME-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-COD-OFIC-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-DMA-FCAS-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-COD-ACRG-ATR IN D05-FLD.
           MOVE FRM-CPIM-UBY TO D05-COD-AUMO-ATR IN D05-FLD.
       FIN-UNP-D05-D05.
           EXIT.
       VAL-KEY-D05 SECTION.
       INI-VAL-KEY-D05.
           PERFORM VAL-IKY-D05.
           PERFORM VAL-MKY-D05.
           PERFORM VAL-AKY-D05.
       FIN-VAL-KEY-D05.
           EXIT.
       VAL-IKY-D05 SECTION.
       INI-VAL-IKY-D05.
           PERFORM VAL-D05-NUM-RUTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-NUM-RUTD-LEN IN D05-FLD
                GO TO FIN-VAL-IKY-D05.
           PERFORM VAL-D05-VRF-RUTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-VRF-RUTD-LEN IN D05-FLD
                GO TO FIN-VAL-IKY-D05.
           PERFORM VAL-D05-COD-OPER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-COD-OPER-LEN IN D05-FLD
                GO TO FIN-VAL-IKY-D05.
       FIN-VAL-IKY-D05.
           EXIT.
       VAL-MKY-D05 SECTION.
       INI-VAL-MKY-D05.
       FIN-VAL-MKY-D05.
           EXIT.
       VAL-AKY-D05 SECTION.
       INI-VAL-AKY-D05.
       FIN-VAL-AKY-D05.
           EXIT.
       VAL-FLD-D05 SECTION.
       INI-VAL-FLD-D05.
           PERFORM VAL-D05-GLS-NOMD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-GLS-NOMD-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-IND-RUTD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-IND-RUTD-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-GLS-RUTD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-GLS-RUTD-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-VAL-DCMN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-VAL-DCMN-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-VAL-DCME.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-VAL-DCME-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-VAL-ICMN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-VAL-ICMN-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-VAL-ICME.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-VAL-ICME-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-COD-OFIC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-COD-OFIC-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-DMA-FCAS.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-DMA-FCAS-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFIC-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-DMA-FCRG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-DMA-FCRG-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-DMA-FUMO.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-DMA-FUMO-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-COD-ACRG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-COD-ACRG-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-D05-COD-AUMO.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D05-COD-AUMO-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-FRM-GLS-ACRG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ACRG-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
           PERFORM VAL-FRM-GLS-AUMO.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-AUMO-LEN IN D05-FLD
                GO TO FIN-VAL-FLD-D05.
       FIN-VAL-FLD-D05.
           EXIT.
       VAL-D05-GLS-NOMD SECTION.
       INI-VAL-D05-GLS-NOMD.
       FIN-VAL-D05-GLS-NOMD.
           EXIT.
       VAL-D05-NUM-RUTD SECTION.
       INI-VAL-D05-NUM-RUTD.
       FIN-VAL-D05-NUM-RUTD.
           EXIT.
       VAL-D05-VRF-RUTD SECTION.
       INI-VAL-D05-VRF-RUTD.
      *<<<< D05_VRF_RUTD
      * PRO-VRF
           MOVE D05-NUM-RUTD IN D05-FLD TO VRF-NUME.
           MOVE D05-VRF-RUTD IN D05-FLD TO VRF-DVRF.
           MOVE 7 TO VRF-LMAX.
           MOVE VRF-ZERO-N TO VRF-ZERO.
           MOVE VRF-SVRF-K TO VRF-SVRF.
           MOVE VRF-VAL    TO VRF-CMND.
           PERFORM PRO-VRF.
      *>>>>
       FIN-VAL-D05-VRF-RUTD.
           EXIT.
       VAL-D05-COD-OPER SECTION.
       INI-VAL-D05-COD-OPER.
      *<<<< D05_COD_OPER
           IF D05-COD-OPER IN D05-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
       FIN-VAL-D05-COD-OPER.
           EXIT.
       VAL-D05-IND-RUTD SECTION.
       INI-VAL-D05-IND-RUTD.
      *<<<< D05_IND_RUTD
      *VAL-MSC Valida miscelaneo de tabla
           MOVE 'GNS' TO MSC-COD-SIST.
           MOVE 'IRUT' TO MSC-COD-TMSC IN MSC.
           MOVE D05-IND-RUTD IN D05-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
       FIN-VAL-D05-IND-RUTD.
           EXIT.
       VAL-D05-GLS-RUTD SECTION.
       INI-VAL-D05-GLS-RUTD.
       FIN-VAL-D05-GLS-RUTD.
           EXIT.
       VAL-D05-VAL-DCMN SECTION.
       INI-VAL-D05-VAL-DCMN.
       FIN-VAL-D05-VAL-DCMN.
           EXIT.
       VAL-D05-VAL-DCME SECTION.
       INI-VAL-D05-VAL-DCME.
       FIN-VAL-D05-VAL-DCME.
           EXIT.
       VAL-D05-VAL-ICMN SECTION.
       INI-VAL-D05-VAL-ICMN.
       FIN-VAL-D05-VAL-ICMN.
           EXIT.
       VAL-D05-VAL-ICME SECTION.
       INI-VAL-D05-VAL-ICME.
       FIN-VAL-D05-VAL-ICME.
           EXIT.
       VAL-D05-COD-OFIC SECTION.
       INI-VAL-D05-COD-OFIC.
      *<<<< D05_COD_OFIC
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE D05-COD-OFIC IN D05-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN D05-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN D05-FLD.
      *>>>>
       FIN-VAL-D05-COD-OFIC.
           EXIT.
       VAL-D05-DMA-FCAS SECTION.
       INI-VAL-D05-DMA-FCAS.
      *VAL-FEC Validar Fecha
           MOVE D05-DMA-FCAS IN D05-FLD TO FEC-FECH.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO D05-DMA-FCAS IN D05-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-D05-DMA-FCAS.
       FIN-VAL-D05-DMA-FCAS.
           EXIT.
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       VAL-D05-DMA-FCRG SECTION.
       INI-VAL-D05-DMA-FCRG.
       FIN-VAL-D05-DMA-FCRG.
           EXIT.
       VAL-D05-DMA-FUMO SECTION.
       INI-VAL-D05-DMA-FUMO.
       FIN-VAL-D05-DMA-FUMO.
           EXIT.
       VAL-D05-COD-ACRG SECTION.
       INI-VAL-D05-COD-ACRG.
      *<<<< D05_COD_ACRG
      *VAL-USR Valida Usuario
           MOVE D05-COD-ACRG IN D05-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-ACRG IN D05-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ACRG IN D05-FLD.
      *>>>>
       FIN-VAL-D05-COD-ACRG.
           EXIT.
       VAL-D05-COD-AUMO SECTION.
       INI-VAL-D05-COD-AUMO.
      *<<<< D05_COD_AUMO
      *VAL-USR Valida Usuario
           MOVE D05-COD-AUMO IN D05-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUMO IN D05-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AUMO IN D05-FLD.
      *>>>>
       FIN-VAL-D05-COD-AUMO.
           EXIT.
       VAL-FRM-GLS-ACRG SECTION.
       INI-VAL-FRM-GLS-ACRG.
       FIN-VAL-FRM-GLS-ACRG.
           EXIT.
       VAL-FRM-GLS-AUMO SECTION.
       INI-VAL-FRM-GLS-AUMO.
       FIN-VAL-FRM-GLS-AUMO.
           EXIT.
       VAL-CON-KEY-D05 SECTION.
       INI-VAL-CON-KEY-D05.
           IF     D05-NUM-RUTD IN D05-FLD NOT > ZEROES
              AND D05-VRF-RUTD IN D05-FLD NOT > SPACES
              AND D05-COD-OPER IN D05-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-D05.
       FIN-VAL-CON-KEY-D05.
           EXIT.
       VAL-CON-IKY-D05 SECTION.
       INI-VAL-CON-IKY-D05.
           IF     D05-NUM-RUTD IN D05-FLD NOT > ZEROES
              AND D05-VRF-RUTD IN D05-FLD NOT > SPACES
              AND D05-COD-OPER IN D05-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-D05.
       FIN-VAL-CON-IKY-D05.
           EXIT.
       VAL-CON-FLD-D05 SECTION.
       INI-VAL-CON-FLD-D05.
      *<<<< VAL_CON_FLD_D05
           IF  D05-VAL-DCMN IN D05-FLD = ZEROES AND
               D05-VAL-DCME IN D05-FLD = ZEROES AND
               D05-VAL-ICMN IN D05-FLD = ZEROES AND
               D05-VAL-ICME IN D05-FLD = ZEROES
      *GET-MSG Busca mensaje en tabla
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALXXXXBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-FLD-D05.
           EXIT.
       VAL-CON-D05 SECTION.
       INI-VAL-CON-D05.
       FIN-VAL-CON-D05.
           EXIT.
       VAL-NUM-KEY-D05 SECTION.
       INI-VAL-NUM-KEY-D05.
           PERFORM VAL-NUM-IKY-D05.
           PERFORM VAL-NUM-MKY-D05.
           PERFORM VAL-NUM-AKY-D05.
       FIN-VAL-NUM-KEY-D05.
           EXIT.
       VAL-NUM-IKY-D05 SECTION.
       INI-VAL-NUM-IKY-D05.
       VAL-NUM-D05-NUM-RUTD.
           MOVE D05-NUM-RUTD-ALF IN D05-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D05-NUM-RUTD IN D05-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D05-NUM-RUTD-LEN IN D05-FLD
                GO TO FIN-VAL-NUM-IKY-D05.
       FIN-VAL-NUM-IKY-D05.
           EXIT.
       VAL-NUM-MKY-D05 SECTION.
       INI-VAL-NUM-MKY-D05.
       FIN-VAL-NUM-MKY-D05.
           EXIT.
       VAL-NUM-AKY-D05 SECTION.
       INI-VAL-NUM-AKY-D05.
       FIN-VAL-NUM-AKY-D05.
           EXIT.
       VAL-NUM-FLD-D05 SECTION.
       INI-VAL-NUM-FLD-D05.
       VAL-NUM-D05-VAL-DCMN.
           MOVE D05-VAL-DCMN-ALF IN D05-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D05-VAL-DCMN IN D05-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D05-VAL-DCMN-LEN IN D05-FLD
                GO TO FIN-VAL-NUM-FLD-D05.
       VAL-NUM-D05-VAL-DCME.
           MOVE D05-VAL-DCME-ALF IN D05-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D05-VAL-DCME IN D05-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D05-VAL-DCME-LEN IN D05-FLD
                GO TO FIN-VAL-NUM-FLD-D05.
       VAL-NUM-D05-VAL-ICMN.
           MOVE D05-VAL-ICMN-ALF IN D05-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D05-VAL-ICMN IN D05-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D05-VAL-ICMN-LEN IN D05-FLD
                GO TO FIN-VAL-NUM-FLD-D05.
       VAL-NUM-D05-VAL-ICME.
           MOVE D05-VAL-ICME-ALF IN D05-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D05-VAL-ICME IN D05-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D05-VAL-ICME-LEN IN D05-FLD
                GO TO FIN-VAL-NUM-FLD-D05.
       FIN-VAL-NUM-FLD-D05.
           EXIT.
       EDT-KEY-D05 SECTION.
       INI-EDT-KEY-D05.
           PERFORM EDT-IKY-D05.
           PERFORM EDT-MKY-D05.
           PERFORM EDT-AKY-D05.
       FIN-EDT-KEY-D05.
           EXIT.

       EDT-IKY-D05 SECTION.
       INI-EDT-IKY-D05.
           IF D05-NUM-RUTD-LEN IN D05-FLD = -9
                MOVE -1 TO D05-NUM-RUTD-LEN IN D05-FLD
                GO TO FIN-EDT-IKY-D05.
           MOVE D05-NUM-RUTD IN D05-FLD TO D05-NUM-RUTD-EDT IN D05-EDT.
           MOVE D05-NUM-RUTD-EDT IN D05-EDT TO
                D05-NUM-RUTD-ALF IN D05-FLD.
       FIN-EDT-IKY-D05.
           EXIT.

       EDT-MKY-D05 SECTION.
       INI-EDT-MKY-D05.
       FIN-EDT-MKY-D05.
           EXIT.

       EDT-AKY-D05 SECTION.
       INI-EDT-AKY-D05.
       FIN-EDT-AKY-D05.
           EXIT.

       EDT-FLD-D05 SECTION.
       INI-EDT-FLD-D05.
           IF D05-VAL-DCMN-LEN IN D05-FLD = -9
                MOVE -1 TO D05-VAL-DCMN-LEN IN D05-FLD
                GO TO FIN-EDT-FLD-D05.
           MOVE D05-VAL-DCMN IN D05-FLD TO D05-VAL-DCMN-EDT IN D05-EDT.
           MOVE D05-VAL-DCMN-EDT IN D05-EDT TO
                D05-VAL-DCMN-ALF IN D05-FLD.
           IF D05-VAL-DCME-LEN IN D05-FLD = -9
                MOVE -1 TO D05-VAL-DCME-LEN IN D05-FLD
                GO TO FIN-EDT-FLD-D05.
           MOVE D05-VAL-DCME IN D05-FLD TO D05-VAL-DCME-EDT IN D05-EDT.
           MOVE D05-VAL-DCME-EDT IN D05-EDT TO
                D05-VAL-DCME-ALF IN D05-FLD.
           IF D05-VAL-ICMN-LEN IN D05-FLD = -9
                MOVE -1 TO D05-VAL-ICMN-LEN IN D05-FLD
                GO TO FIN-EDT-FLD-D05.
           MOVE D05-VAL-ICMN IN D05-FLD TO D05-VAL-ICMN-EDT IN D05-EDT.
           MOVE D05-VAL-ICMN-EDT IN D05-EDT TO
                D05-VAL-ICMN-ALF IN D05-FLD.
           IF D05-VAL-ICME-LEN IN D05-FLD = -9
                MOVE -1 TO D05-VAL-ICME-LEN IN D05-FLD
                GO TO FIN-EDT-FLD-D05.
           MOVE D05-VAL-ICME IN D05-FLD TO D05-VAL-ICME-EDT IN D05-EDT.
           MOVE D05-VAL-ICME-EDT IN D05-EDT TO
                D05-VAL-ICME-ALF IN D05-FLD.
       FIN-EDT-FLD-D05.
           EXIT.
