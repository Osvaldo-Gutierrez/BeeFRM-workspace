      * 26-Jun-95 11:15 AM
       PUT-ALL-P21 SECTION.
       INI-PUT-ALL-P21.
           PERFORM PUT-P21-P21.
      * <<< FRM-GLS-LOCA
           IF (P21-COD-LOCA IN P21-FLD > SPACES)
               MOVE P21-COD-LOCA IN P21-FLD TO WSS-VARI-P21
               MOVE WSS-COD-PLZA            TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'COM'                   TO TAB-EXT-TTAB IN TAB
               MOVE 'TAB-EXT-TABL'          TO FIO-AKEY
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-LOCA IN P21-FLD.
       FIN-PUT-ALL-P21.
           EXIT.

       PUT-P21-P21 SECTION.
       INI-PUT-P21-P21.
           IF PGM-STAT-P21-NUL
               GO TO FIN-PUT-P21-P21.
           IF NOT PGM-STAT-P21-OKS
               PERFORM CLR-P21-P21
               GO TO FIN-PUT-P21-P21.
           MOVE P21-COD-PROD IN P21 TO P21-COD-PROD IN P21-FLD.
           MOVE P21-COD-LOCA IN P21 TO P21-COD-LOCA IN P21-FLD.
           MOVE P21-COD-CLIE IN P21 TO P21-COD-CLIE IN P21-FLD.
      *
      *    CAMPO INDEXADO   P21-NUM-DEUD
           MOVE P21-NUM-DEUD IN P21(1) TO P21-NUM-DEUD IN P21-FLD(1).
           MOVE P21-NUM-DEUD IN P21(2) TO P21-NUM-DEUD IN P21-FLD(2).
           MOVE P21-NUM-DEUD IN P21(3) TO P21-NUM-DEUD IN P21-FLD(3).
           MOVE P21-NUM-DEUD IN P21(4) TO P21-NUM-DEUD IN P21-FLD(4).
           MOVE P21-NUM-DEUD IN P21(5) TO P21-NUM-DEUD IN P21-FLD(5).
      *
      *    CAMPO INDEXADO   P21-VAL-DEUD
           MOVE P21-VAL-DEUD IN P21(1) TO P21-VAL-DEUD IN P21-FLD(1).
           MOVE P21-VAL-DEUD IN P21(2) TO P21-VAL-DEUD IN P21-FLD(2).
           MOVE P21-VAL-DEUD IN P21(3) TO P21-VAL-DEUD IN P21-FLD(3).
           MOVE P21-VAL-DEUD IN P21(4) TO P21-VAL-DEUD IN P21-FLD(4).
           MOVE P21-VAL-DEUD IN P21(5) TO P21-VAL-DEUD IN P21-FLD(5).
       FIN-PUT-P21-P21.
           EXIT.
      * 26-Jun-95 11:15 AM
       RET-ALL-P21 SECTION.
       INI-RET-ALL-P21.
           PERFORM KEY-ALL-P21.
           PERFORM RET-P21-P21.
       FIN-RET-ALL-P21.
           EXIT.

       RET-P21-P21 SECTION.
       INI-RET-P21-P21.
      *
      *    CAMPO INDEXADO   P21-NUM-DEUD
           MOVE P21-NUM-DEUD IN P21-FLD(1) TO P21-NUM-DEUD IN P21(1).
           MOVE P21-NUM-DEUD IN P21-FLD(2) TO P21-NUM-DEUD IN P21(2).
           MOVE P21-NUM-DEUD IN P21-FLD(3) TO P21-NUM-DEUD IN P21(3).
           MOVE P21-NUM-DEUD IN P21-FLD(4) TO P21-NUM-DEUD IN P21(4).
           MOVE P21-NUM-DEUD IN P21-FLD(5) TO P21-NUM-DEUD IN P21(5).
      *
      *    CAMPO INDEXADO   P21-VAL-DEUD
           MOVE P21-VAL-DEUD IN P21-FLD(1) TO P21-VAL-DEUD IN P21(1).
           MOVE P21-VAL-DEUD IN P21-FLD(2) TO P21-VAL-DEUD IN P21(2).
           MOVE P21-VAL-DEUD IN P21-FLD(3) TO P21-VAL-DEUD IN P21(3).
           MOVE P21-VAL-DEUD IN P21-FLD(4) TO P21-VAL-DEUD IN P21(4).
           MOVE P21-VAL-DEUD IN P21-FLD(5) TO P21-VAL-DEUD IN P21(5).
       FIN-RET-P21-P21.
           EXIT.

       KEY-ALL-P21 SECTION.
       INI-KEY-ALL-P21.
           PERFORM KEY-P21-P21.
       FIN-KEY-ALL-P21.
           EXIT.

       KEY-P21-P21 SECTION.
       INI-KEY-P21-P21.
           MOVE P21-COD-PROD IN P21-FLD TO P21-COD-PROD IN P21.
           MOVE P21-COD-LOCA IN P21-FLD TO P21-COD-LOCA IN P21.
           MOVE P21-COD-CLIE IN P21-FLD TO P21-COD-CLIE IN P21.
       FIN-KEY-P21-P21.
           EXIT.

       SCR-CLRA-P21 SECTION.
       INI-SCR-CLRA-P21.
           PERFORM CLR-KEY-P21.
           PERFORM CLR-FLD-P21.
       FIN-SCR-CLRA-P21.
           EXIT.

       CLR-KEY-P21 SECTION.
       INI-CLR-KEY-P21.
           MOVE ZEROES TO P21-COD-PROD IN P21-FLD.
           MOVE ZEROES TO P21-COD-LOCA IN P21-FLD.
           MOVE ZEROES TO P21-COD-CLIE IN P21-FLD.
       FIN-CLR-KEY-P21.
           EXIT.

       CLR-FLD-P21 SECTION.
       INI-CLR-FLD-P21.
           MOVE SPACES TO FRM-GLS-LOCA IN P21-FLD.
           PERFORM CLR-P21-P21.
       FIN-CLR-FLD-P21.
           EXIT.

       CLR-P21-P21 SECTION.
       INI-CLR-P21-P21.
           MOVE ZEROES TO P21-NUM-DEUD IN P21-FLD(1).
           MOVE ZEROES TO P21-NUM-DEUD IN P21-FLD(2).
           MOVE ZEROES TO P21-NUM-DEUD IN P21-FLD(3).
           MOVE ZEROES TO P21-NUM-DEUD IN P21-FLD(4).
           MOVE ZEROES TO P21-NUM-DEUD IN P21-FLD(5).
           MOVE ZEROES TO P21-VAL-DEUD IN P21-FLD(1).
           MOVE ZEROES TO P21-VAL-DEUD IN P21-FLD(2).
           MOVE ZEROES TO P21-VAL-DEUD IN P21-FLD(3).
           MOVE ZEROES TO P21-VAL-DEUD IN P21-FLD(4).
           MOVE ZEROES TO P21-VAL-DEUD IN P21-FLD(5).
       FIN-CLR-P21-P21.
           EXIT.

       FST-KEY-P21 SECTION.
       INI-FST-KEY-P21.
           MOVE -1 TO P21-COD-PROD-LEN IN P21-FLD.
       FIN-FST-KEY-P21.
           EXIT.

       FST-FLD-P21 SECTION.
       INI-FST-FLD-P21.
           MOVE -1 TO P21-NUM-DEUD-LEN IN P21-FLD(1).
       FIN-FST-FLD-P21.
           EXIT.

       PRO-KEY-P21 SECTION.
       INI-PRO-KEY-P21.
           PERFORM PRO-IKY-P21.
           PERFORM PRO-AKY-P21.
           PERFORM PRO-MKY-P21.
       FIN-PRO-KEY-P21.
           EXIT.

       PRO-IKY-P21 SECTION.
       INI-PRO-IKY-P21.
           MOVE FRM-CPIM-AEY TO P21-COD-PROD-ATR IN P21-FLD.
           MOVE FRM-CPIM-AEY TO P21-COD-LOCA-ATR IN P21-FLD.
           MOVE FRM-CPIM-AEY TO P21-COD-CLIE-ATR IN P21-FLD.
       FIN-PRO-IKY-P21.
           EXIT.

       PRO-MKY-P21 SECTION.
       INI-PRO-MKY-P21.
       FIN-PRO-MKY-P21.
           EXIT.

       PRO-AKY-P21 SECTION.
       INI-PRO-AKY-P21.
       FIN-PRO-AKY-P21.
           EXIT.

       PRO-FLD-P21 SECTION.
       INI-PRO-FLD-P21.
           PERFORM PRO-P21-P21.
       FIN-PRO-FLD-P21.
           EXIT.

       PRO-P21-P21 SECTION.
       INI-PRO-P21-P21.
           MOVE FRM-CPIM-AEY TO P21-NUM-DEUD-ATR IN P21-FLD(1).
           MOVE FRM-CPIM-AEY TO P21-NUM-DEUD-ATR IN P21-FLD(2).
           MOVE FRM-CPIM-AEY TO P21-NUM-DEUD-ATR IN P21-FLD(3).
           MOVE FRM-CPIM-AEY TO P21-NUM-DEUD-ATR IN P21-FLD(4).
           MOVE FRM-CPIM-AEY TO P21-NUM-DEUD-ATR IN P21-FLD(5).
           MOVE FRM-CPIM-AEY TO P21-VAL-DEUD-ATR IN P21-FLD(1).
           MOVE FRM-CPIM-AEY TO P21-VAL-DEUD-ATR IN P21-FLD(2).
           MOVE FRM-CPIM-AEY TO P21-VAL-DEUD-ATR IN P21-FLD(3).
           MOVE FRM-CPIM-AEY TO P21-VAL-DEUD-ATR IN P21-FLD(4).
           MOVE FRM-CPIM-AEY TO P21-VAL-DEUD-ATR IN P21-FLD(5).
       FIN-PRO-P21-P21.
           EXIT.

       UNP-KEY-P21 SECTION.
       INI-UNP-KEY-P21.
           PERFORM UNP-IKY-P21.
           PERFORM UNP-AKY-P21.
           PERFORM UNP-MKY-P21.
       FIN-UNP-KEY-P21.
           EXIT.

       UNP-IKY-P21 SECTION.
       INI-UNP-IKY-P21.
           MOVE FRM-CPIM-UBY TO P21-COD-PROD-ATR.
           MOVE FRM-CPIM-UBY TO P21-COD-LOCA-ATR.
           MOVE FRM-CPIM-UBY TO P21-COD-CLIE-ATR.
       FIN-UNP-IKY-P21.
           EXIT.

       UNP-MKY-P21 SECTION.
       INI-UNP-MKY-P21.
       FIN-UNP-MKY-P21.
           EXIT.

       UNP-AKY-P21 SECTION.
       INI-UNP-AKY-P21.
       FIN-UNP-AKY-P21.
           EXIT.

       UNP-FLD-P21 SECTION.
       INI-UNP-FLD-P21.
           PERFORM UNP-P21-P21.
       FIN-UNP-FLD-P21.
           EXIT.

       UNP-P21-P21 SECTION.
       INI-UNP-P21-P21.
           MOVE FRM-CPIM-UBY TO P21-NUM-DEUD-ATR IN P21-FLD(1).
           MOVE FRM-CPIM-UBY TO P21-NUM-DEUD-ATR IN P21-FLD(2).
           MOVE FRM-CPIM-UBY TO P21-NUM-DEUD-ATR IN P21-FLD(3).
           MOVE FRM-CPIM-UBY TO P21-NUM-DEUD-ATR IN P21-FLD(4).
           MOVE FRM-CPIM-UBY TO P21-NUM-DEUD-ATR IN P21-FLD(5).
           MOVE FRM-CPIM-UBY TO P21-VAL-DEUD-ATR IN P21-FLD(1).
           MOVE FRM-CPIM-UBY TO P21-VAL-DEUD-ATR IN P21-FLD(2).
           MOVE FRM-CPIM-UBY TO P21-VAL-DEUD-ATR IN P21-FLD(3).
           MOVE FRM-CPIM-UBY TO P21-VAL-DEUD-ATR IN P21-FLD(4).
           MOVE FRM-CPIM-UBY TO P21-VAL-DEUD-ATR IN P21-FLD(5).
       FIN-UNP-P21-P21.
           EXIT.

       VAL-KEY-P21 SECTION.
       INI-VAL-KEY-P21.
           PERFORM VAL-IKY-P21.
           PERFORM VAL-MKY-P21.
           PERFORM VAL-AKY-P21.
       FIN-VAL-KEY-P21.
           EXIT.

       VAL-IKY-P21 SECTION.
       INI-VAL-IKY-P21.
           PERFORM VAL-P21-COD-PROD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO P21-COD-PROD-LEN IN P21-FLD
                GO TO FIN-VAL-IKY-P21.
           PERFORM VAL-P21-COD-LOCA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO P21-COD-LOCA-LEN IN P21-FLD
                GO TO FIN-VAL-IKY-P21.
           PERFORM VAL-P21-COD-CLIE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO P21-COD-CLIE-LEN IN P21-FLD
                GO TO FIN-VAL-IKY-P21.
       FIN-VAL-IKY-P21.
           EXIT.

       VAL-MKY-P21 SECTION.
       INI-VAL-MKY-P21.
       FIN-VAL-MKY-P21.
           EXIT.

       VAL-AKY-P21 SECTION.
       INI-VAL-AKY-P21.
       FIN-VAL-AKY-P21.
           EXIT.

       VAL-FLD-P21 SECTION.
       INI-VAL-FLD-P21.
           PERFORM VAL-FRM-GLS-LOCA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-LOCA-LEN IN P21-FLD
                GO TO FIN-VAL-FLD-P21.
           PERFORM VAL-P21-NUM-DEUD
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO P21-NUM-DEUD-LEN IN P21-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-P21.
           PERFORM VAL-P21-VAL-DEUD
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO P21-VAL-DEUD-LEN IN P21-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-P21.
       FIN-VAL-FLD-P21.
           EXIT.

       VAL-P21-COD-PROD SECTION.
       INI-VAL-P21-COD-PROD.
           IF P21-COD-PROD IN P21-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-P21-COD-PROD.
       FIN-VAL-P21-COD-PROD.
           EXIT.

       VAL-P21-COD-LOCA SECTION.
       INI-VAL-P21-COD-LOCA.
           IF P21-COD-LOCA IN P21-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-P21-COD-LOCA.
      * <<< Valida Codigo en tabla
           MOVE P21-COD-LOCA IN P21-FLD TO WSS-VARI-P21
           MOVE WSS-COD-PLZA            TO TAB-EXT-CTAB IN TAB
           MOVE 'TAB'                   TO TAB-COD-SIST
           MOVE 'COM'                   TO TAB-EXT-TTAB IN TAB
           MOVE 'TAB-EXT-TABL'          TO FIO-AKEY
           PERFORM VAL-COD
           IF (MSG-COD-MENS NOT = 'COD    NEX')
               MOVE TAB                 TO COM
               IF (WSS-COD-REGI = COM-COD-REGI)
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LOCA IN P21-FLD
               ELSE
                   MOVE 'CODIGO INEXISTENTE' TO FRM-MENS
                   MOVE FRM-SUAR-MAL    TO FRM-SUAR
                   MOVE SPACES          TO FRM-GLS-LOCA IN P21-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-LOCA IN P21-FLD.
      * >>> Fin Valida
       FIN-VAL-P21-COD-LOCA.
           EXIT.

       VAL-FRM-GLS-LOCA SECTION.
       INI-VAL-FRM-GLS-LOCA.
       FIN-VAL-FRM-GLS-LOCA.
           EXIT.

       VAL-P21-COD-CLIE SECTION.
       INI-VAL-P21-COD-CLIE.
           IF P21-COD-CLIE IN P21-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-P21-COD-CLIE.
       FIN-VAL-P21-COD-CLIE.
           EXIT.

       VAL-P21-NUM-DEUD SECTION.
       INI-VAL-P21-NUM-DEUD.
       FIN-VAL-P21-NUM-DEUD.
           EXIT.

       VAL-P21-VAL-DEUD SECTION.
       INI-VAL-P21-VAL-DEUD.
       FIN-VAL-P21-VAL-DEUD.
           EXIT.

       VAL-CON-KEY-P21 SECTION.
       INI-VAL-CON-KEY-P21.
           IF     P21-COD-PROD IN P21-FLD NOT > ZEROES
              AND P21-COD-LOCA IN P21-FLD NOT > ZEROES
              AND P21-COD-CLIE IN P21-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-P21.
       FIN-VAL-CON-KEY-P21.
           EXIT.

       VAL-CON-IKY-P21 SECTION.
       INI-VAL-CON-IKY-P21.
           IF     P21-COD-PROD IN P21-FLD NOT > ZEROES
              AND P21-COD-LOCA IN P21-FLD NOT > ZEROES
              AND P21-COD-CLIE IN P21-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-P21.
       FIN-VAL-CON-IKY-P21.
           EXIT.

       VAL-CON-FLD-P21 SECTION.
       INI-VAL-CON-FLD-P21.
       FIN-VAL-CON-FLD-P21.
           EXIT.

       VAL-CON-P21 SECTION.
       INI-VAL-CON-P21.
       FIN-VAL-CON-P21.
           EXIT.

       VAL-NUM-KEY-P21 SECTION.
       INI-VAL-NUM-KEY-P21.
           PERFORM VAL-NUM-IKY-P21.
           PERFORM VAL-NUM-MKY-P21.
           PERFORM VAL-NUM-AKY-P21.
       FIN-VAL-NUM-KEY-P21.
           EXIT.

       VAL-NUM-IKY-P21 SECTION.
       INI-VAL-NUM-IKY-P21.
       VAL-NUM-P21-COD-PROD.
           MOVE P21-COD-PROD-ALF IN P21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-COD-PROD IN P21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-COD-PROD-LEN IN P21-FLD
                GO TO FIN-VAL-NUM-IKY-P21.
       VAL-NUM-P21-COD-LOCA.
           MOVE P21-COD-LOCA-ALF IN P21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-COD-LOCA IN P21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-COD-LOCA-LEN IN P21-FLD
                GO TO FIN-VAL-NUM-IKY-P21.
       VAL-NUM-P21-COD-CLIE.
           MOVE P21-COD-CLIE-ALF IN P21-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 1 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-COD-CLIE IN P21-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-COD-CLIE-LEN IN P21-FLD
                GO TO FIN-VAL-NUM-IKY-P21.
       FIN-VAL-NUM-IKY-P21.
           EXIT.

       VAL-NUM-MKY-P21 SECTION.
       INI-VAL-NUM-MKY-P21.
       FIN-VAL-NUM-MKY-P21.
           EXIT.

       VAL-NUM-AKY-P21 SECTION.
       INI-VAL-NUM-AKY-P21.
       FIN-VAL-NUM-AKY-P21.
           EXIT.

       VAL-NUM-FLD-P21 SECTION.
       INI-VAL-NUM-FLD-P21.
       VAL-NUM-P21-NUM-DEUD-1.
           MOVE P21-NUM-DEUD-ALF IN P21-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-NUM-DEUD IN P21-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-NUM-DEUD-LEN IN P21-FLD(1)
                GO TO FIN-VAL-NUM-FLD-P21.
       VAL-NUM-P21-NUM-DEUD-2.
           MOVE P21-NUM-DEUD-ALF IN P21-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-NUM-DEUD IN P21-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-NUM-DEUD-LEN IN P21-FLD(2)
                GO TO FIN-VAL-NUM-FLD-P21.
       VAL-NUM-P21-NUM-DEUD-3.
           MOVE P21-NUM-DEUD-ALF IN P21-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-NUM-DEUD IN P21-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-NUM-DEUD-LEN IN P21-FLD(3)
                GO TO FIN-VAL-NUM-FLD-P21.
       VAL-NUM-P21-NUM-DEUD-4.
           MOVE P21-NUM-DEUD-ALF IN P21-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-NUM-DEUD IN P21-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-NUM-DEUD-LEN IN P21-FLD(4)
                GO TO FIN-VAL-NUM-FLD-P21.
       VAL-NUM-P21-NUM-DEUD-5.
           MOVE P21-NUM-DEUD-ALF IN P21-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-NUM-DEUD IN P21-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-NUM-DEUD-LEN IN P21-FLD(5)
                GO TO FIN-VAL-NUM-FLD-P21.
       VAL-NUM-P21-VAL-DEUD-1.
           MOVE P21-VAL-DEUD-ALF IN P21-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-VAL-DEUD IN P21-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-VAL-DEUD-LEN IN P21-FLD(1)
                GO TO FIN-VAL-NUM-FLD-P21.
       VAL-NUM-P21-VAL-DEUD-2.
           MOVE P21-VAL-DEUD-ALF IN P21-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-VAL-DEUD IN P21-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-VAL-DEUD-LEN IN P21-FLD(2)
                GO TO FIN-VAL-NUM-FLD-P21.
       VAL-NUM-P21-VAL-DEUD-3.
           MOVE P21-VAL-DEUD-ALF IN P21-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-VAL-DEUD IN P21-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-VAL-DEUD-LEN IN P21-FLD(3)
                GO TO FIN-VAL-NUM-FLD-P21.
       VAL-NUM-P21-VAL-DEUD-4.
           MOVE P21-VAL-DEUD-ALF IN P21-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-VAL-DEUD IN P21-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-VAL-DEUD-LEN IN P21-FLD(4)
                GO TO FIN-VAL-NUM-FLD-P21.
       VAL-NUM-P21-VAL-DEUD-5.
           MOVE P21-VAL-DEUD-ALF IN P21-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO P21-VAL-DEUD IN P21-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO P21-VAL-DEUD-LEN IN P21-FLD(5)
                GO TO FIN-VAL-NUM-FLD-P21.
       FIN-VAL-NUM-FLD-P21.
           EXIT.

       EDT-KEY-P21 SECTION.
       INI-EDT-KEY-P21.
           PERFORM EDT-IKY-P21.
           PERFORM EDT-MKY-P21.
           PERFORM EDT-AKY-P21.
       FIN-EDT-KEY-P21.
           EXIT.

       EDT-IKY-P21 SECTION.
       INI-EDT-IKY-P21.
           IF P21-COD-PROD-LEN IN P21-FLD = -9
                MOVE -1 TO P21-COD-PROD-LEN IN P21-FLD
                GO TO FIN-EDT-IKY-P21.
           MOVE P21-COD-PROD IN P21-FLD TO P21-COD-PROD-EDT IN P21-EDT.
           MOVE P21-COD-PROD-EDT IN P21-EDT TO
                P21-COD-PROD-ALF IN P21-FLD.
           IF P21-COD-LOCA-LEN IN P21-FLD = -9
                MOVE -1 TO P21-COD-LOCA-LEN IN P21-FLD
                GO TO FIN-EDT-IKY-P21.
           MOVE P21-COD-LOCA IN P21-FLD TO P21-COD-LOCA-EDT IN P21-EDT.
           MOVE P21-COD-LOCA-EDT IN P21-EDT TO
                P21-COD-LOCA-ALF IN P21-FLD.
           IF P21-COD-CLIE-LEN IN P21-FLD = -9
                MOVE -1 TO P21-COD-CLIE-LEN IN P21-FLD
                GO TO FIN-EDT-IKY-P21.
           MOVE P21-COD-CLIE IN P21-FLD TO P21-COD-CLIE-EDT IN P21-EDT.
           MOVE P21-COD-CLIE-EDT IN P21-EDT TO
                P21-COD-CLIE-ALF IN P21-FLD.
       FIN-EDT-IKY-P21.
           EXIT.

       EDT-MKY-P21 SECTION.
       INI-EDT-MKY-P21.
       FIN-EDT-MKY-P21.
           EXIT.

       EDT-AKY-P21 SECTION.
       INI-EDT-AKY-P21.
       FIN-EDT-AKY-P21.
           EXIT.

       EDT-FLD-P21 SECTION.
       INI-EDT-FLD-P21.
           IF P21-NUM-DEUD-LEN IN P21-FLD(1) = -9
                MOVE -1 TO P21-NUM-DEUD-LEN IN P21-FLD(1)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-NUM-DEUD IN P21-FLD(1) TO
                P21-NUM-DEUD-EDT IN P21-EDT(1).
           MOVE P21-NUM-DEUD-EDT IN P21-EDT(1) TO
                P21-NUM-DEUD-ALF IN P21-FLD(1).
           IF P21-NUM-DEUD-LEN IN P21-FLD(2) = -9
                MOVE -1 TO P21-NUM-DEUD-LEN IN P21-FLD(2)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-NUM-DEUD IN P21-FLD(2) TO
                P21-NUM-DEUD-EDT IN P21-EDT(2).
           MOVE P21-NUM-DEUD-EDT IN P21-EDT(2) TO
                P21-NUM-DEUD-ALF IN P21-FLD(2).
           IF P21-NUM-DEUD-LEN IN P21-FLD(3) = -9
                MOVE -1 TO P21-NUM-DEUD-LEN IN P21-FLD(3)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-NUM-DEUD IN P21-FLD(3) TO
                P21-NUM-DEUD-EDT IN P21-EDT(3).
           MOVE P21-NUM-DEUD-EDT IN P21-EDT(3) TO
                P21-NUM-DEUD-ALF IN P21-FLD(3).
           IF P21-NUM-DEUD-LEN IN P21-FLD(4) = -9
                MOVE -1 TO P21-NUM-DEUD-LEN IN P21-FLD(4)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-NUM-DEUD IN P21-FLD(4) TO
                P21-NUM-DEUD-EDT IN P21-EDT(4).
           MOVE P21-NUM-DEUD-EDT IN P21-EDT(4) TO
                P21-NUM-DEUD-ALF IN P21-FLD(4).
           IF P21-NUM-DEUD-LEN IN P21-FLD(5) = -9
                MOVE -1 TO P21-NUM-DEUD-LEN IN P21-FLD(5)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-NUM-DEUD IN P21-FLD(5) TO
                P21-NUM-DEUD-EDT IN P21-EDT(5).
           MOVE P21-NUM-DEUD-EDT IN P21-EDT(5) TO
                P21-NUM-DEUD-ALF IN P21-FLD(5).
           IF P21-VAL-DEUD-LEN IN P21-FLD(1) = -9
                MOVE -1 TO P21-VAL-DEUD-LEN IN P21-FLD(1)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-VAL-DEUD IN P21-FLD(1) TO
                P21-VAL-DEUD-EDT IN P21-EDT(1).
           MOVE P21-VAL-DEUD-EDT IN P21-EDT(1) TO
                P21-VAL-DEUD-ALF IN P21-FLD(1).
           IF P21-VAL-DEUD-LEN IN P21-FLD(2) = -9
                MOVE -1 TO P21-VAL-DEUD-LEN IN P21-FLD(2)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-VAL-DEUD IN P21-FLD(2) TO
                P21-VAL-DEUD-EDT IN P21-EDT(2).
           MOVE P21-VAL-DEUD-EDT IN P21-EDT(2) TO
                P21-VAL-DEUD-ALF IN P21-FLD(2).
           IF P21-VAL-DEUD-LEN IN P21-FLD(3) = -9
                MOVE -1 TO P21-VAL-DEUD-LEN IN P21-FLD(3)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-VAL-DEUD IN P21-FLD(3) TO
                P21-VAL-DEUD-EDT IN P21-EDT(3).
           MOVE P21-VAL-DEUD-EDT IN P21-EDT(3) TO
                P21-VAL-DEUD-ALF IN P21-FLD(3).
           IF P21-VAL-DEUD-LEN IN P21-FLD(4) = -9
                MOVE -1 TO P21-VAL-DEUD-LEN IN P21-FLD(4)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-VAL-DEUD IN P21-FLD(4) TO
                P21-VAL-DEUD-EDT IN P21-EDT(4).
           MOVE P21-VAL-DEUD-EDT IN P21-EDT(4) TO
                P21-VAL-DEUD-ALF IN P21-FLD(4).
           IF P21-VAL-DEUD-LEN IN P21-FLD(5) = -9
                MOVE -1 TO P21-VAL-DEUD-LEN IN P21-FLD(5)
                GO TO FIN-EDT-FLD-P21.
           MOVE P21-VAL-DEUD IN P21-FLD(5) TO
                P21-VAL-DEUD-EDT IN P21-EDT(5).
           MOVE P21-VAL-DEUD-EDT IN P21-EDT(5) TO
                P21-VAL-DEUD-ALF IN P21-FLD(5).
       FIN-EDT-FLD-P21.
           EXIT.
