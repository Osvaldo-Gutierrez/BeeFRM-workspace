*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% LARGO_TOTAL_COMMAREA = 2013
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF PGM_DTC AND EOF
      *<<<< PGM_DTC AND EOF
       COPY GNSBGHOY.
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
*% END
*%! IF NOT PGM_MCP
*% PGM_PTC = TRUE
*%! END
*% IF WSS
      *<<<< WSS
*% IF PGM_DTC
      *<<<< PGM_DTC
       COPY GNSWGHOY.
*% END
*%!GNN-INI 11-SEP-1996
*% IF NOT PGM_CLB AND NOT PGM_MEX
      * COPY GNSBRMSC.
*% END
      *<<<< WSS_IBM
       COPY TABBRUSR.
       COPY TABBRCOM.
       COPY SGCBRDBC.
       COPY SGCBRRCD.
       COPY GARBRGDG.
       COPY GARBRTAG.

       COPY GNSWGCPT.
       COPY GNSWGSTR.
*% IF NOT PGM_MCP AND NOT PGM_PTC
       COPY GNSWGQUE.
*% END
*% IF PGM_MEX
       COPY SGCWGICB.
*% END
       01   WSS-VARI.
            03  WSS-CIC-ICLI                             PIC X(12).
            03  WSS-GLS-NULL                             PIC X(30).
            03  WSS-I                                    PIC 9(04).
            03  WSS-IMAX                    VALUE 5      PIC 9(04).
            03  WSS-IMAX-MTX                VALUE 10     PIC 9(04).
            03  WSS-IVEN-MAS1               VALUE 0      PIC 9(03).
            03  WSS-NITM                    VALUE 0      PIC 9(03).
            03 WSS-LENG       VALUE 180 COMP PIC S9(04).

           03 WSS-NUM-ICLI-IDX.
      *       DIGITO VERIFICADOR CONSIST
*% IF FMT_CHI
              05 WSS-NUM-ICLI-LEN        COMP   PIC S9(04).
              05 WSS-NUM-ICLI-ATR       PIC X(01).
              05 WSS-NUM-ICLI-ALF       PIC X(08).
              05 WSS-NUM-ICLI     REDEFINES
                 WSS-NUM-ICLI-ALF       PIC 9(08).

              05 WSS-VRF-ICLI-LEN        COMP   PIC S9(04).
              05 WSS-VRF-ICLI-ATR       PIC X(01).
              05 WSS-VRF-ICLI           PIC X(01).

              05 WSS-IND-ICLI-LEN        COMP   PIC S9(04).
              05 WSS-IND-ICLI-ATR       PIC X(01).
              05 WSS-IND-ICLI           PIC X(01).

              05 WSS-GLS-ICLI-LEN        COMP   PIC S9(04).
              05 WSS-GLS-ICLI-ATR       PIC X(01).
              05 WSS-GLS-ICLI           PIC X(03).

              05 WSS-GLS-NOMC-LEN    COMP   PIC S9(04).
              05 WSS-GLS-NOMC-ATR           PIC  X(01).
              05 WSS-GLS-NOMC               PIC  X(23).

              05 WSS-SGV-VLIM-LEN    COMP   PIC S9(04).
              05 WSS-SGV-VLIM-ATR           PIC  X(01).
              05 WSS-SGV-VLIM-ALF           PIC  X(19).
              05 WSS-SGV-VLIM      REDEFINES
                 WSS-SGV-VLIM-ALF           PIC  99999999999V9999.

              05 WSS-SGV-PLIM-LEN    COMP   PIC S9(04).
              05 WSS-SGV-PLIM-ATR           PIC  X(01).
              05 WSS-SGV-PLIM-ALF           PIC  X(6).
              05 WSS-SGV-PLIM      REDEFINES
                 WSS-SGV-PLIM-ALF           PIC  999V99.

*% ELSE
              05 FILLER                       PIC X(04).

              05 WSS-IDC-ICLI-ALF              PIC  X(12). 
              05 WSS-IDC-ICLI REDEFINES 
                   WSS-IDC-ICLI-ALF            PIC  9(12). 
              05 FILLER                        PIC  X(04).
              05 WSS-GLS-NOMC                  PIC  X(28).
*% IF NOT PGM_MCP
              05 WSS-SGV-VLIM-LEN    COMP  PIC S9(04).
*% END

      *ISP    05 WSS-SGV-VLIM-ATR          PIC  X(01).
              05 FILLER                       PIC X(04).
              05 WSS-SGV-VLIM-ALF          PIC X(17).
              05 WSS-SGV-VLIM-RED  REDEFINES
                 WSS-SGV-VLIM-ALF.
                 09  FILLER                   PIC X(4).
                 09  WSS-SGV-VLIM          PIC 99999999999V99.
      *

*% IF NOT PGM_MCP
              05 WSS-SGV-PLIM-LEN    COMP   PIC S9(04).
*% END
      *ISP    05 WSS-SGV-PLIM-ATR           PIC  X(01).
              05 FILLER                        PIC X(04).
              05 WSS-SGV-PLIM-ALF           PIC X(06).
              05 WSS-SGV-PLIM-RED  REDEFINES
                 WSS-SGV-PLIM-ALF.
                 09  FILLER                    PIC X(1).
                 09  WSS-SGV-PLIM           PIC  999V99.

*% END
*% IF GEN_BCI
      *<<<< GEN_BCI
              05 WSS-GLS-DIRE-LEN    COMP   PIC S9(04).
              05 WSS-GLS-DIRE-ATR           PIC  X(01).
              05 WSS-GLS-DIRE               PIC  X(30).
      *
              05 WSS-GLS-COMU-LEN    COMP   PIC S9(04).
              05 WSS-GLS-COMU-ATR           PIC  X(01).
              05 WSS-GLS-COMU               PIC  X(12).
      *
              05 WSS-GLS-REGI-LEN    COMP   PIC S9(04).
              05 WSS-GLS-REGI-ATR           PIC  X(01).
              05 WSS-GLS-REGI               PIC  X(12).
      *
              05 WSS-GLS-CIUD-LEN    COMP   PIC S9(04).
              05 WSS-GLS-CIUD-ATR           PIC  X(01).
              05 WSS-GLS-CIUD               PIC  X(12).
      *
              05 WSS-GLS-FONO-LEN    COMP   PIC S9(04).
              05 WSS-GLS-FONO-ATR           PIC  X(01).
              05 WSS-GLS-FONO               PIC  X(8).
      *>>>>
*% END
           03 WSS-CAI-GTIA                      PIC X(04).
           03 WSS-IIC-GTIA                      PIC X(08).
      *MHM-INI 23-OCT-2003
           03 WSS-GLS-CGTA.
              05 WSS-GLS-TOPE                   PIC X(40).
              05 WSS-GLS-SOPE                   PIC X(40).
      *MHM-FIN 23-OCT-2003

      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% IF FIN_SCR_VARI
           03 SCR-NUM-PANT               PIC 9(02).
           03 SCR-GXD-FLD                PIC X(1761).
*% END
*% IF INI_SCR_COM
      *<<<< INI_SCR_COM
           MOVE EIBTRMID TO QUE-TERM.
           MOVE 'GGXD'   TO QUE-TYPE.
           MOVE QUE-DEL  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
      * EVP-INI 10-APR-1996
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )
               MOVE SCR-GXD-FLD TO GXD-FLD
               GO TO FIN-INI.

           IF ( FRM-FFLD = FRM-FFLD-PF6 )
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
               ADD 1         TO QUE-NITM
               MOVE EIBTRMID TO QUE-TERM
               MOVE 'GGXD'   TO QUE-TYPE
               MOVE WSS-LENG TO QUE-LITM
               MOVE QUE-GET  TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                  MOVE SCR-GXD-FLD TO GXD-FLD
                  GO TO FIN-INI.

      *     IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *         PERFORM GET-HDR-CMA.

      * EVP-FIN 10-APR-1996
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           GO TO CON-FND-KEY.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-GXD
               PERFORM VAL-NUM-FLD-GXD
               PERFORM SCRL-TAB-GXD
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CON-FND-KEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
              GO TO FIN-FND-KEY.
           MOVE FIO-STAT TO PGM-STAT-GDG.

           PERFORM PUT-TAB.

           MOVE '00' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-GDD.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *----------------------------------------------------------
       MSG-FND-KEY.
           MOVE 'GAR' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE EIBTRMID TO QUE-TERM.
           MOVE 'GGXD'   TO QUE-TYPE.
           MOVE QUE-DEL  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE 1 TO SCR-NUM-PANT.
           MOVE LOW-VALUES TO WSS-NUM-ICLI-IDX.
           PERFORM GET-FHOY.
      *
*% IF NOT FMT_CHI
      *RRM-INI 1-OCT-2002
           IF SYS-IND-AMBI = SYS-IND-AMBI-PPMTX
               MOVE  1 TO FRM-IDX-IFLD.
      *RRM-FIN 1-OCT-2002
*% END
           MOVE 1 TO FRM-IFLD.
           MOVE ZEROES  TO WSS-NITM IN WSS-VARI.

           MOVE GDD-CAI-GTIA IN GDD TO WSS-CAI-GTIA IN WSS-VARI.
           MOVE GDD-IIC-GTIA IN GDD TO WSS-IIC-GTIA IN WSS-VARI.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.           
           MOVE FIO-GET-NLS  TO FIO-CMND.
       LUP-PUT-TAB.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS AND 
              WSS-CAI-GTIA IN WSS-VARI = GDD-CAI-GTIA IN GDD AND
              WSS-IIC-GTIA IN WSS-VARI = GDD-IIC-GTIA IN GDD
                    PERFORM PUT-TAB-GXD
                    PERFORM PUT-GXD-QUE
*% IF NOT FMT_CHI
      *RRM-INI 1-OCT-2002
                    IF SYS-IND-AMBI = SYS-IND-AMBI-PPMTX
                        MOVE 1 TO FRM-IFLD
                        ADD  1 TO FRM-IDX-IFLD
                    ELSE
      *RRM-FIN 1-OCT-2002
*% END
                    ADD 1 TO FRM-IFLD
           ELSE
           IF FRM-IFLD = 1
              MOVE 'SGC' TO MSG-COD-SIST
              MOVE 'GXD    NOGDD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE '00' TO FIO-STAT
              GO TO FIN-PUT-TAB
           ELSE
              MOVE '00' TO FIO-STAT
              GO TO FIN-PUT-TAB.

*% IF NOT FMT_CHI
      *RRM-INI 27-SEP-2002
           IF SYS-IND-AMBI = SYS-IND-AMBI-PPMTX AND
              MSG-COD-MENS > SPACES
              GO TO FIN-PUT-TAB.
      *RRM-FIN 27-SEP-2002
*% END

           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-NXT  TO FIO-CMND.
           GO TO LUP-PUT-TAB.
       FIN-PUT-TAB.

           MOVE WSS-CAI-GTIA IN WSS-VARI TO GDD-CAI-GTIA IN GDD.
           MOVE WSS-IIC-GTIA IN WSS-VARI TO GDD-IIC-GTIA IN GDD.

*% IF NOT FMT_CHI
      *RRM-INI 26-SEP-2002
           IF SYS-IND-AMBI = SYS-IND-AMBI-PPMTX
               GO TO EXT-PUT-TAB.
      *RRM-FIN 26-SEP-2002
*% END

           IF WSS-NITM > WSS-IMAX
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'GXDGDDDMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.

      *--------------------------------------------
       SCRL-TAB-GXD SECTION.
       INI-SCRL-TAB-GXD.
           MOVE SPACES TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'SGC' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-GXD.
           EXIT.

       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1         TO QUE-NITM.
           MOVE EIBTRMID TO QUE-TERM.
           MOVE 'GGXD'   TO QUE-TYPE.
           MOVE WSS-LENG TO QUE-LITM.
           MOVE QUE-GET  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MOVE 'GXDGDDNONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
           MOVE QUE-ITEM TO FRM-NUM-ICLI-IDX(FRM-IFLD).
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO SCR-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1         TO QUE-NITM
               MOVE EIBTRMID TO QUE-TERM
               MOVE 'GGXD'   TO QUE-TYPE
               MOVE WSS-LENG TO QUE-LITM
               MOVE QUE-GET  TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'GXDGDDDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.

       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-NUM-PANT = 1
               MOVE 'GXDGDDNOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.

           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE EIBTRMID TO QUE-TERM.
           MOVE 'GGXD'   TO QUE-TYPE.
           MOVE WSS-LENG TO QUE-LITM.
           MOVE QUE-GET  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'GXDGDDNOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           MOVE QUE-ITEM TO FRM-NUM-ICLI-IDX(FRM-IFLD).
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.

           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.

           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM SCR-NUM-PANT
               MOVE 'GXDGDDDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.
      *--------------------------------------------
       PUT-TAB-GXD SECTION.
       INI-PUT-TAB-GXD.
      *ISP
*% IF NOT FMT_CHI
      *RRM-INI 26-SEP-2002
           IF SYS-IND-AMBI = SYS-IND-AMBI-PPMTX AND
              FRM-IDX-IFLD NOT > WSS-IMAX-MTX
               MOVE FRM-NUM-ICLI-IDX(FRM-IFLD) TO WSS-NUM-ICLI-IDX
               GO TO PPMTX-PUT-TAB-GXD
           ELSE
               IF SYS-IND-AMBI = SYS-IND-AMBI-PPMTX
                   MOVE "MTX   CONNXT" TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-GXD.
      *RRM-FIN 26-SEP-2002
*% END

           IF FRM-IFLD NOT > WSS-IMAX
               MOVE FRM-NUM-ICLI-IDX(FRM-IFLD) TO WSS-NUM-ICLI-IDX.

*% IF NOT FMT_CHI
      *RRM-INI 26-SEP-2002
       PPMTX-PUT-TAB-GXD.
      *RRM-FIN 26-SEP-2002
*% END

           MOVE GDD-CAI-DCLI IN GDD TO DBC-CAI-ICLI IN DBC.
           MOVE GDD-IIC-DCLI IN GDD TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO WSS-GLS-NOMC.
*% IF FMT_CHI
           MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-ICLI.
           MOVE DBC-VRF-ICLI IN DBC TO WSS-VRF-ICLI.
           MOVE DBC-IND-ICLI IN DBC TO WSS-IND-ICLI.
           MOVE DBC-GLS-ICLI IN DBC TO WSS-GLS-ICLI.
*% ELSE
           MOVE DBC-IDC-ICLI IN DBC TO WSS-IDC-ICLI. 
*% END
           MOVE GDD-SGV-VLIM IN GDD TO WSS-SGV-VLIM.

*% IF NOT FMT_CHI
      *RRM-INI 1-OCT-2002
           IF SYS-IND-AMBI = SYS-IND-AMBI-PPMTX
              MOVE SPACES TO WSS-SGV-PLIM-ALF.
      *RRM-FIN 1-OCT-2002
*% END

           MOVE GDD-SGV-PLIM IN GDD TO WSS-SGV-PLIM.  
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE DBC-CAI-ICLI IN DBC TO RCD-CAI-ICLI IN RCD.
           MOVE DBC-IIC-ICLI IN DBC TO RCD-IIC-ICLI IN RCD.
           MOVE ZEROES TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT ( FIO-STAT-OKS AND
              RCD-CAI-ICLI IN RCD = DBC-CAI-ICLI IN DBC AND
              RCD-IIC-ICLI IN RCD = DBC-IIC-ICLI IN DBC )
               GO TO CNT-PUT-TAB-GXD.

           MOVE RCD-GLS-DIRE IN RCD TO WSS-GLS-DIRE.
           MOVE RCD-NUM-FONO IN RCD TO WSS-GLS-FONO.

           MOVE 'TAB' TO FIO-SIST.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'COM' TO TAB-COD-TTAB IN TAB.
           MOVE RCD-COD-LUGA IN RCD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB TO COM.
           MOVE COM-GLS-COMU IN COM TO WSS-GLS-COMU.
           MOVE COM-GLS-CIUD IN COM TO WSS-GLS-CIUD.
           
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'REG' TO TAB-COD-TTAB IN TAB.
           MOVE COM-COD-REGI IN COM TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-REGI.

       CNT-PUT-TAB-GXD.
      *>>>>
*% END
*% IF NOT FMT_CHI
      *RRM-INI 26-SEP-2002
           IF SYS-IND-AMBI = SYS-IND-AMBI-PPMTX
               MOVE WSS-NUM-ICLI-IDX TO FRM-NUM-ICLI-IDX(FRM-IFLD)
               PERFORM PUT-MTX-IDX-GXD
               GO TO FIN-PUT-TAB-GXD.
      *RRM-FIN 26-SEP-2002
*% END

           IF FRM-IFLD NOT > WSS-IMAX
               MOVE WSS-NUM-ICLI-IDX TO FRM-NUM-ICLI-IDX(FRM-IFLD).
       FIN-PUT-TAB-GXD.
           EXIT.
      *----------------------------------------------------
       PUT-GXD-QUE SECTION.
       INI-PUT-GXD-QUE.
           ADD 1 TO WSS-NITM.
           MOVE EIBTRMID TO QUE-TERM.
           MOVE 'GGXD'   TO QUE-TYPE.
           MOVE WSS-NITM TO QUE-NITM.
           MOVE WSS-NUM-ICLI-IDX TO QUE-ITEM.
           MOVE WSS-LENG TO QUE-LITM.
           MOVE QUE-PUT  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *Esta cola se graba solo una vez al principio.
       FIN-PUT-GXD-QUE.
           EXIT.
      *----------------------------------------------------
       CLR-FRM SECTION.
       INI-CLR-FRM.
*% IF FMT_CHI
           MOVE ZEROES              TO FRM-NUM-ICLI IN
                                           GXD-FLD(WSS-I).
           MOVE SPACES              TO FRM-VRF-ICLI IN
                                           GXD-FLD(WSS-I).
           MOVE SPACES              TO FRM-IND-ICLI IN
                                           GXD-FLD(WSS-I).
           MOVE SPACES              TO FRM-GLS-ICLI IN
                                           GXD-FLD(WSS-I).
*% ELSE
           MOVE ZEROES TO FRM-IDC-ICLI IN  GXD-FLD(WSS-I).
*% END
           MOVE SPACES              TO FRM-GLS-NOMC IN
                                           GXD-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-VLIM IN 
                                           GXD-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-PLIM IN 
                                           GXD-FLD(WSS-I).
*% IF GEN_BCI
      *<<<<
           MOVE SPACES              TO FRM-GLS-DIRE IN
                                           GXD-FLD(WSS-I).
           MOVE SPACES              TO FRM-GLS-COMU IN
                                           GXD-FLD(WSS-I).
           MOVE SPACES              TO FRM-GLS-CIUD IN
                                           GXD-FLD(WSS-I).
           MOVE SPACES              TO FRM-GLS-REGI IN
                                           GXD-FLD(WSS-I).
           MOVE SPACES              TO FRM-GLS-FONO IN
                                           GXD-FLD(WSS-I).
      *>>>>
*% END
       FIN-CLR-FRM.
           EXIT.
      *------------------------------------------------------
       COPY TABBBUSR.
       COPY TABBFUSR.
       COPY TABBVUSR.

       COPY SGCBFDBC.
       COPY SGCBFRCD.

       COPY GARBFGDG.
       COPY GARBFTAG.

      *PGJ-INI / 4-JUN-1998
      * COPY GNSBGFEC.
      * COPY GNSBGHOY.
      *PGJ-FIN / 4-JUN-1998
       COPY SGCBGCLI.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
*% IF NOT PGM_MCP AND NOT PGM_PTC
       COPY GNSBGQUE.
*% END
       COPY GNSBVCOD.
       COPY GNSBVTAB.
      *>>>> EOF
*% END

