*% FRM = 'GVT'
*% REG = 'GVT'
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF FIN_UNP_IKY_GVT 
      *<<<< FIN_UNP_IKY_GVT 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = "ING"
           MOVE FRM-CPIM-AEY TO GVT-COD-TASN-ATR IN GVT-FLD
           MOVE FRM-CPIM-AEY TO GVT-COD-TASN-STP.
      *RRM-FIN 16-APR-2002
      *>>>>      
*% END
*% IF FIN_GVT_COD_EITS
      *<<<< FIN_GVT_COD_EITS
           IF GVT-COD-EITS IN GVT-FLD NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-GVT-COD-EITS.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE 'TAB'  TO TAB-COD-SIST.
           MOVE 'TAS'  TO TAB-COD-TTAB IN TAB.
           MOVE GVT-COD-EITS IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES       TO FRM-GLS-EITS IN GVT-FLD
              MOVE 'TAB' TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-EITS IN GVT-FLD.
      *>>>>
*% ELSE
      
           IF GVT-COD-EITS IN GVT-FLD > SPACES
              MOVE 'TAS'                   TO IVB-EXT-TTAB IN IVB
              MOVE GVT-COD-EITS IN GVT-FLD TO IVB-EXT-CTAB IN IVB
              MOVE 'IVB-KY2-TABS'          TO FIO-AKEY
              MOVE FIO-GET-KEY             TO FIO-CMND
              PERFORM TAB-FIO-IVB
              IF NOT (FIO-STAT-OKS AND
                   IVB-EXT-TTAB IN IVB = 'TAS' AND
                   IVB-EXT-CTAB IN IVB = GVT-COD-EITS IN GVT-FLD AND
                   IVB-MSC-STAT IN IVB = 'S')
                   MOVE 'TAB'           TO MSG-COD-SIST
                   MOVE 'TIT    NVIG'   TO MSG-COD-MENS
                   MOVE SPACES          TO FRM-GLS-EITS IN GVT-FLD
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC    TO FRM-MEN1
                   MOVE FRM-SUAR-MAL    TO FRM-SUAR
                   GO TO FIN-VAL-GVT-COD-EITS
              ELSE
                 MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-EITS IN GVT-FLD.
*% END 
      *>>>>
*% END 
*% IF FIN_GVT_COD_OAVA
      *<<<< FIN_GVT_COD_OAVA
      *CGL-INI  19-AUG-2003 18:08:56 
      *     MOVE 'GAR'  TO TAB-COD-SIST.
      *     MOVE 'ORA' TO TAB-COD-TTAB IN TAB.
      *     MOVE GVT-COD-OAVA IN GVT-FLD TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *     IF MSG-COD-MENS = 'COD    NEX'
      *        MOVE SPACES       TO FRM-GLS-OAVA IN GVT-FLD
      *        MOVE 'TAB' TO MSG-COD-SIST
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *     ELSE
      *        MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-OAVA IN GVT-FLD.
      *CGL-FIN  19-AUG-2003 18:09:21 
      *>>>>
*% END
*% IF FIN_GVT_COD_CRIT
      *<<<< FIN_GVT_COD_CRIT
      *CGL-INI  19-AUG-2003 18:06:44 
      *     MOVE 'GAR'                   TO TAB-COD-SIST.
      *     MOVE 'CRI'                   TO TAB-COD-TTAB IN TAB.
      *     MOVE GVT-COD-CRIT IN GVT-FLD TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *     IF MSG-COD-MENS = 'COD    NEX'
      *        MOVE SPACES       TO FRM-GLS-CRIT IN GVT-FLD
      *        MOVE 'TAB' TO MSG-COD-SIST
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *     ELSE
      *        MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CRIT IN GVT-FLD.
      * CGL-FIN  19-AUG-2003 18:07:10 
      *>>>>
*% END             
*% IF GVT_COD_ISVS
      *<<<< GVT_COD_ISVS
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
           MOVE SPACES TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GVT-FLD TO WSS-TIPO-DIV IN WSS-VARI.
      
           IF GVT-COD-ISVS IN GVT-FLD NOT > ZEROES
           IF (SCR-CCPP = 'MOD' OR SCR-CCPP = 'ACT' OR SCR-CCPP = 'ING')
              IF ((GDG-COD-CGTA IN GVT-FLD NOT < '000101' AND
                   GDG-COD-CGTA IN GVT-FLD     < '000130') OR
                   WSS-TIPO IN WSS-VARI = 'HIP')
                   PERFORM ERR-GLS
                   GO TO FIN-VAL-GVT-COD-ISVS
              ELSE
                 GO TO FIN-VAL-GVT-COD-ISVS
           ELSE
              GO TO FIN-VAL-GVT-COD-ISVS.

           IF GVT-COD-ISVS IN GVT-FLD > ZEROES
              MOVE 'USR'                   TO USR-COD-TTAB IN USR
              MOVE GVT-COD-ISVS IN GVT-FLD TO USR-COD-USER IN USR
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-USR
              IF NOT FIO-STAT-OKS
                 MOVE 'TAB'   TO MSG-COD-SIST
                 MOVE 'USR NOEXIST' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GVT-COD-ISVS
              ELSE
                 MOVE USR-GLS-DESC IN USR TO FRM-GLS-ISVS IN GVT-FLD.
      *>>>>
*% ELSE
           MOVE 'TAB'  TO TAB-COD-SIST.
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE 'TAS'  TO TAB-COD-TTAB IN TAB.
      *>>>>
*% ELSE
           MOVE 'INS'  TO TAB-COD-TTAB IN TAB.
*% END
           MOVE GVT-COD-ISVS IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES       TO FRM-GLS-ISVS IN GVT-FLD
              MOVE 'TAB' TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ISVS IN GVT-FLD.

*% END
      *>>>>
*% END             
*% IF GVT_COD_CFCD
      *<<<< GVT_COD_CFCD
           IF GVT-COD-CFCD IN GVT-FLD NOT > SPACES
               GO TO  FIN-VAL-GVT-COD-CFCD.        

           MOVE GVT-COD-CFCD IN GVT-FLD TO FCD-KEY-CFCD IN FCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-FCD.
           IF NOT FIO-STAT-OKS
               MOVE 'FCD    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GVT_COD_ADAG
      *<<<< GVT_COD_AGAG
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
           MOVE SPACES TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GVT-FLD TO WSS-TIPO-DIV IN WSS-VARI.
      *CGL-INI  19-AUG-2003 18:11:01 
      *     IF GVT-COD-ADAG IN GVT-FLD NOT > SPACES
      *     IF (SCR-CCPP = 'MOD' OR SCR-CCPP = 'ACT' OR SCR-CCPP = 'ING')
      *          AND ((GDG-COD-CGTA IN GVT-FLD NOT < '000101' AND
      *                GDG-COD-CGTA IN GVT-FLD     < '000130') OR
      *               (WSS-TIPO IN WSS-VARI = 'HIP'))
      *                PERFORM ERR-GLS
      *                GO TO FIN-VAL-GVT-COD-ADAG.
      *CGL-FIN  19-AUG-2003 18:11:18 
      *>>>>
*% END
      *>>>>
*% END
*% IF GVT_COD_SDAG
      *<<<< GVT_COD_SGAG
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
           MOVE SPACES TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GVT-FLD TO WSS-TIPO-DIV IN WSS-VARI.
      
           IF GVT-COD-SDAG IN GVT-FLD NOT > SPACES
           IF (SCR-CCPP = 'MOD' OR SCR-CCPP = 'ACT' OR SCR-CCPP = 'ING')
               IF  ((GDG-COD-CGTA IN GVT-FLD NOT < '000101' AND
                     GDG-COD-CGTA IN GVT-FLD     < '000130') OR
                    (WSS-TIPO IN WSS-VARI = 'HIP'))
                     PERFORM ERR-GLS
                     GO TO FIN-VAL-GVT-COD-SDAG.
      *>>>>
*% END
      *>>>>
*% END
*% IF FIN_UNP_FLD_GVT
      *<<<< FIN_UNP_FLD_GVT
           IF SCR-CMND = 'ING' OR SCR-CMND = 'MOD'
               MOVE FRM-CPIM-UBY TO GVT-COD-SDAG-ATR IN GVT-FLD.
      *>>>>
*% END
*% IF FIN_PRO_FLD_GVT
      *<<<< FIN_PRO_FLD_GVT
           IF SCR-CMND = 'ING' OR SCR-CMND = 'MOD'
               MOVE FRM-CPIM-AEY TO GVT-COD-SDAG-ATR IN GVT-FLD.
      *>>>>
*% END
*% IF INI_GVT_SGV_FISI
      *<<<< INI_GVT_SGV_FISI
      *CGL-INI  19-AUG-2003 18:11:56 
      *     IF GVT-SGV-FISI IN GVT-FLD NOT > ZEROES
      *        MOVE ZEROES TO GVT-SGV-FISI IN GVT-FLD
      *        GO TO FIN-VAL-GVT-SGV-FISI.
      *CGL-FIN  19-AUG-2003 18:12:06 
      *>>>>
*% END
*% IF GVT_NUM_AMOD
      *<<<< GVT_NUM_AMOD
            IF GVT-COD-CFCD IN GVT-FLD = SPACES AND
               GVT-NUM-AMOD IN GVT-FLD > ZEROES
                MOVE 'FCD    SPC' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GVT-NUM-AMOD.
      *
           IF GVT-NUM-AMOD IN GVT-FLD > ZEROES
               MOVE GVT-COD-CFCD IN GVT-FLD TO VCV-COD-CFCD IN VCV
               MOVE GVT-NUM-AMOD IN GVT-FLD TO VCV-NUM-AMOD IN VCV
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-VCV
               IF NOT FIO-STAT-OKS
                   MOVE 'VCV    NEX' TO MSG-COD-MENS
                   MOVE 'GAR' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GVT_SGV_VPND
      *<<<< GVT_VAL_CML_TSN
*% IF NOT GEN_BCI
      *<<<< NOT GEN_BCI
           IF ( GVT-SGV-VPND IN GVT-FLD > GVT-SGV-VCTS IN GVT-FLD )
               MOVE 'GAR'      TO MSG-COD-SIST
               MOVE 'VLCBL>AV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *>>>>
*% END
      *>>>>
*% END
*% IF GVT_SGV_VSIN
      *<<<< GVT_SGV_VSIN
      *MHM-INI 17-OCT-2003
           IF SCR-CMND = 'ATA'
               MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-VSIN IN GVT-FLD.

      *MHM-FIN 17-OCT-2003
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GVT-SGV-VSIN IN GVT-FLD NOT > ZEROES
               GO TO FIN-VAL-GVT-SGV-VSIN.
      *MHM-FIN 29-OCT-2003
           IF CMA-IND-TSWT IN CMA-VARI NOT = 'N' AND 
              GVT-SGV-VSIN IN GVT-FLD NOT > ZEROES
               PERFORM ERR-GLS
               GO TO FIN-VAL-GVT-SGV-VSIN.

           IF CMA-IND-TSWT IN CMA-VARI = 'N'
               MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-VSIN IN GVT-FLD.
      *>>>>
*% END
*% IF GVT_COD_ITSD
      *<<<<
           IF ( SCR-CMND = 'RVL' OR = 'RTA' ) AND 
              ( GVT-COD-ITSD IN GVT-FLD NOT > SPACES )
                  PERFORM ERR-GLS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GVT-COD-ITSD.
      *>>>>
*% END
*% IF FIN_PUT_GVT_GVT
      *<<<< FIN_PUT_GVT_GVT
      *MHM-INI 29-OCT-2003
           MOVE GVT-CIC-UING IN GVT TO CMA-CIC-UING IN CMA-VARI.
      *MHM-FIN 29-OCT-2003
*% IF FMT_CHI
      *<<<< FMT_CHI
           IF GVT-COD-ISVS IN GVT-FLD > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
*% IF GEN_BCI
      *<<<< GEN_BCI
              MOVE 'TAS'               TO TAB-COD-TTAB IN TAB
      *>>>>
*% ELSE
              MOVE 'INS'               TO TAB-COD-TTAB IN TAB
*% END
              MOVE GVT-COD-ISVS IN GVT TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ISVS IN GVT-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-ISVS IN GVT-FLD.
      *>>>>
*% ELSE
           IF GVT-COD-ISVS IN GVT-FLD > ZEROES
              MOVE 'USR'                   TO USR-COD-TTAB IN USR
              MOVE GVT-COD-ISVS IN GVT     TO USR-COD-USER IN USR
              MOVE FIO-GET-KEY             TO FIO-CMND
              PERFORM TAB-FIO-USR
              MOVE USR-GLS-DESC IN USR TO FRM-GLS-ISVS IN GVT-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-ISVS IN GVT-FLD.
*% END
      *CGL-INI  19-AUG-2003 18:07:25    
      *     IF GVT-COD-CRIT IN GVT-FLD > SPACES
      *        MOVE 'GAR'                   TO TAB-COD-SIST
      *        MOVE 'CRI'                   TO TAB-COD-TTAB IN TAB
      *        MOVE GVT-COD-CRIT IN GVT     TO TAB-COD-CTAB IN TAB
      *        PERFORM VAL-COD
      *        MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-CRIT IN GVT-FLD
      *     ELSE
      *        MOVE SPACES TO FRM-GLS-CRIT IN GVT-FLD.
      *CGL-FIN  19-AUG-2003 18:07:44 
      * CGL-INI  19-AUG-2003 18:09:33 
      *     IF GVT-COD-OAVA IN GVT-FLD > SPACES
      *        MOVE 'GAR'               TO TAB-COD-SIST
      *        MOVE 'ORA'               TO TAB-COD-TTAB IN TAB
      *        MOVE GVT-COD-OAVA IN GVT TO TAB-COD-CTAB IN TAB
      *        PERFORM VAL-COD
      *        MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-OAVA IN GVT-FLD
      *     ELSE
      *        MOVE SPACES TO FRM-GLS-OAVA IN GVT-FLD.
      *CGL-FIN  19-AUG-2003 18:09:51 
      
           IF GVT-MSC-STAT IN GVT-FLD = 'I'
              MOVE 'INGRESADO'       TO FRM-GLS-STAT IN GVT-FLD
           ELSE
           IF GVT-MSC-STAT IN GVT-FLD = 'M'
              MOVE 'MODIFICADO'      TO FRM-GLS-STAT IN GVT-FLD
           ELSE
           IF GVT-MSC-STAT IN GVT-FLD = 'A'
              MOVE 'ACTIVADO'        TO FRM-GLS-STAT IN GVT-FLD
           ELSE
              MOVE 'OTRO'            TO FRM-GLS-STAT IN GVT-FLD.
      
*% IF FMT_CHI
      *<<<< FMT_CHI
           IF GVT-COD-EITS IN GVT-FLD > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'TAS'               TO TAB-COD-TTAB IN TAB
              MOVE GVT-COD-EITS IN GVT TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-EITS IN GVT-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-EITS IN GVT-FLD.
      *>>>>
*% ELSE
           IF GVT-COD-EITS IN GVT-FLD > SPACES
              MOVE 'TAS'                   TO IVB-EXT-TTAB IN IVB
              MOVE GVT-COD-EITS IN GVT-FLD TO IVB-EXT-CTAB IN IVB
              MOVE 'IVB-KY2-TABS'          TO FIO-AKEY
              MOVE FIO-GET-KEY             TO FIO-CMND
              PERFORM TAB-FIO-IVB
              MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-EITS IN GVT-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-EITS IN GVT-FLD.
*% END

           MOVE GVT-SGV-LTSN IN GVT-FLD TO
                WSS-SGV-LTSN IN CMA-VARI.

           IF ( SCR-CCPP = 'ACC' AND
                SCR-STPP NOT = SCR-STAT-CON OR
                SCR-CMND = 'ATA' ) AND

               GVT-SGV-LTSN IN GVT-FLD > ZEROES AND
               GVT-SGV-VCTS IN GVT-FLD > ZEROES

                COMPUTE WSS-LIQ-CML IN CMA-VARI ROUNDED =
                               GVT-SGV-LTSN IN GVT-FLD /
                               GVT-SGV-VCTS IN GVT-FLD

           ELSE
               MOVE ZEROES TO WSS-LIQ-CML IN CMA-VARI.

       OBT-VEN-TSN.
           PERFORM EXA-VEN-TSN.
      *MHM-INI 16-SEP-2003
           IF SCR-CMND NOT = 'CON'
               GO TO CNT-PUT-GVT-GVT.

           IF CMA-IND-APLI IN CMA-VARI = 'N'
               MOVE 'NO APLICA RETASAR' TO FRM-GLS-EXCE IN GVT-FLD
               GO TO CNT-PUT-GVT-GVT.

           IF WSS-IND-TASV IN WSS-VARI NOT = 'S'
               MOVE 'AL DIA' TO FRM-GLS-EXCE IN GVT-FLD
               GO TO CNT-PUT-GVT-GVT.

           IF GDG-IND-ECRT IN GDG = 'S'
               MOVE 'VENCIDA CON EXCEPCION COMERCIAL'
                                            TO FRM-GLS-EXCE IN GVT-FLD
               GO TO CNT-PUT-GVT-GVT.
              
           PERFORM EXC-NOR-TAS.
           IF WSS-IND-ENT1 = 'S'
              MOVE 'VENCIDA EXCP.NORMATIVA, NO PRESENTA DEUDAS VIGENTES'
                                            TO FRM-GLS-EXCE IN GVT-FLD
           ELSE
           IF WSS-IND-ENT2 = 'S'
              MOVE 'VENCIDA EXCP.NORMATIVA, UNICA DEUDA HIPOTECARIA'
                                            TO FRM-GLS-EXCE IN GVT-FLD
           ELSE
           IF WSS-IND-ENT3 = 'S'
              MOVE 'VENCIDA EXCP.NORMATIVA, TASACION VIGENTE EN CURSE'
                                            TO FRM-GLS-EXCE IN GVT-FLD
           ELSE
              MOVE 'TASACION VENCIDA, DEBE RETASAR'
                                            TO FRM-GLS-EXCE IN GVT-FLD.

       CNT-PUT-GVT-GVT.
      *MHM-FIN 16-SEP-2003

           MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP.
           MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP.
           MOVE ZEROES                  TO GTP-COD-ITSN IN GTP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GTP-CAI-GTIA IN GTP = GVT-CAI-GTIA IN GVT-FLD AND
              GTP-IIC-GTIA IN GTP = GVT-IIC-GTIA IN GVT-FLD AND
              GTP-NUM-ITSN IN GTP = GVT-COD-TASN IN GVT-FLD
               MOVE 'S' TO FRM-IND-GTP IN GVT-FLD
           ELSE
               MOVE 'N' TO FRM-IND-GTP IN GVT-FLD.

           IF FIO-STAT-OKS 
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GTP.
      *>>>>
*% END
*% IF FIN_PUT_GDG_GVT
      *<<<< FIN_PUT_GDG_GVT
           IF GDG-COD-VCON IN GVT-FLD > SPACES
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
              MOVE GDG-COD-VCON IN GVT-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCON IN GVT-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-VCON IN GVT-FLD.
      *>>>>
*% END
*% IF INI_PRO_FLD_GVT
      *<<<< INI_PRO_FLD_GVT
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-STP.

           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-STP.

           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-STP.
      *>>>>
*% END
*% IF FIN_PUT_ALL_GVT
      *<<<< FIN_PUT_ALL_GVT
           PERFORM OBT-COD-MNAC.

*% IF (PGM_PER OR PGM_CLB OR PGM_MEX)
      *<<<< (PGM_PER OR PGM_CLB OR PGM_MEX)
      *
           COMPUTE FRM-SGV-VGAS IN GVT-FLD ROUNDED =
                   GVT-SGV-VCTS IN GVT *
                   GVT-SGV-PAJU IN GVT / 100.

           MOVE GVT-SGV-VPND IN GVT-FLD TO FRM-VAL-ULT-CON IN GVT-FLD.
      *
           MOVE ZEROES TO GVT-SGV-LTSN IN GVT-FLD.
           MOVE ZEROES TO GVT-SGV-PAJU IN GVT-FLD.
      *
           MOVE ZEROES TO FRM-SGV-VGAS IN GVT-FLD.
      *  
      *>>>>
*% END
*% IF NOT (PGM_PER OR PGM_CLB OR PGM_MEX)
      *<<<< NOT (PGM_PER OR PGM_CLB OR PGM_MEX)
           PERFORM OBT-VAL-CON.
      *>>>>
*% END
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_GVT
      *<<<< FIN_VAL_CON_IKY_GVT
           IF GVT-COD-TASN IN GVT-FLD < 1
               MOVE 1 TO GVT-COD-TASN IN GVT-FLD
           ELSE
           IF GVT-COD-TASN IN GVT-FLD > 1
      *        Comando Ingreso
               MOVE 'GAR'      TO MSG-COD-SIST
               MOVE 'GVTIKY>1' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-IKY-GVT.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_GVT AND NOT PGM_MCP
      *<<<< INI_VAL_CON_KEY_GVT
           IF FRM-FFLD = FRM-FFLD-PF5
               GO TO FIN-VAL-CON-KEY-GVT.

      *>>>>
*% END
*% IF INI_FST_FLD_GVT
      *<<<< INI_FST_FLD_GVT
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE -1 TO FRM-IND-GTP-LEN IN GVT-FLD.

           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

      *MHM-INI 14-OCT-2003
           IF SCR-CMND = 'MTA'
               PERFORM PRO-FLD-GVT
               MOVE FRM-CPIM-UBY TO GVT-COD-EITS-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-COD-ISVS-ATR IN GVT-FLD
               MOVE  0 TO FRM-IND-GTP-LEN  IN GVT-FLD
               MOVE -1 TO GVT-COD-EITS-LEN IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

      *MHM-FIN 14-OCT-2003

           IF SCR-CCPP = 'MOD'
               MOVE  0 TO FRM-IND-GTP-LEN  IN GVT-FLD
               MOVE -1 TO GVT-FEC-FTSN-LEN IN GVT-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD
      *MHM-INI 14-OCT-2003
               MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD
      *MHM-FIN 14-OCT-2003
               GO TO FIN-FST-FLD-GVT.

           MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.

      *MHM-INI 11-SEP-2003
           IF SCR-CMND = 'RTF'
               PERFORM PRO-FLD-GVT
               MOVE FRM-CPIM-UBY TO GVT-FEC-FTSN-ATR IN GVT-FLD
               MOVE  0 TO FRM-IND-GTP-LEN  IN GVT-FLD
               MOVE -1 TO GVT-FEC-FTSN-LEN IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

      *MHM-FIN 11-SEP-2003
           IF SCR-CMND = 'RVL'
               MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD
      *MHM-INI 14-OCT-2003
      *         MOVE -1 TO GVT-FEC-FRVL-LEN IN GVT-FLD
                MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD
                MOVE -1 TO GVT-SGV-VCTS-LEN IN GVT-FLD
      *MHM-FIN 14-OCT-2003
           ELSE
               MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD
               MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD
               MOVE -1 TO GVT-FEC-FTSN-LEN IN GVT-FLD.
            
           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.

           MOVE GVT-CAI-GTIA IN GVT-FLD TO GDP-CAI-GTIA IN GDP.
           MOVE GVT-IIC-GTIA IN GVT-FLD TO GDP-IIC-GTIA IN GDP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDP.
           IF FIO-STAT-OKS
               MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.

      *MHM-INI 15-OCT-2003
           GO TO FIN-FST-FLD-GVT.
      *MHM-FIN 15-OCT-2003

      *>>>>
*% ELSE
      *CAH-ISP INI 15-ENE-1998
           IF SCR-CMND = 'MTA'
              MOVE FRM-POS-CURS TO GVT-COD-EITS-LEN IN GVT-FLD
              GO TO FIN-FST-FLD-GVT.

           IF SCR-CMND = 'RVL'
              MOVE FRM-POS-CURS TO GVT-SGV-VCTS-LEN IN GVT-FLD
              GO TO FIN-FST-FLD-GVT.

           IF SCR-CMND = 'RTA'
               IF ( CMA-CIC-TGAR IN CMA-VARI = 'DOCCBR' OR
                    CMA-CIC-TGAR IN CMA-VARI = 'DOCCEX' OR
                    CMA-CIC-TGAR IN CMA-VARI = 'DOCFCC' OR
                    CMA-CIC-TGAR IN CMA-VARI = 'DOCDPN' )

                  MOVE FRM-RST-PCUR TO GVT-FEC-FTSN-LEN IN GVT-FLD
                  MOVE FRM-POS-CURS TO GVT-SGV-PAJU-LEN IN GVT-FLD
                  GO TO FIN-FST-FLD-GVT
               ELSE
                   IF CMA-CIC-TGAR IN CMA-VARI = 'DOCVAL' AND
                      CMA-IND-SMEC IN CMA-VARI NOT = 'S'
                       MOVE FRM-RST-PCUR TO GVT-FEC-FTSN-LEN IN GVT-FLD
                       MOVE FRM-POS-CURS TO GVT-SGV-PAJU-LEN IN GVT-FLD
                       GO TO FIN-FST-FLD-GVT
                   ELSE
                       MOVE FRM-POS-CURS TO GVT-FEC-FTSN-LEN IN GVT-FLD
                       GO TO FIN-FST-FLD-GVT.
      *
           IF SCR-CMND = 'MOD' OR 'ATA'
              MOVE FRM-POS-CURS TO GVT-FEC-FTSN-LEN IN GVT-FLD
              GO TO FIN-FST-FLD-GVT.
*% END
      *>>>> INI_FST_FLD_GVT
*% END
*% IF FRM_IND_GTP
      *<<<< FRM_IND_GTP
           IF FRM-IND-GTP IN GVT-FLD NOT > SPACES
               MOVE 'N' TO FRM-IND-GTP IN GVT-FLD.
      *>>>>
*% END
*% IF INI_GVT_FEC_FTSN
      *<<<< INI_GVT_FEC_TSN
           IF SCR-CMND = 'RVL'
               GO TO FIN-VAL-GVT-FEC-FTSN.
           MOVE GVT-FEC-FTSN IN GVT-FLD TO GVT-FEC-FRVL IN GVT-FLD.
      *>>>>
*% END
*% IF GVT_FEC_FTSN
      *<<<< GVT_FEC_TSN
      *
           MOVE FEC-FBLK-S TO FEC-FBLK.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           IF WSS-FEC-FTSN IN CMA-VARI > ZEROES
               MOVE WSS-FEC-FTSN IN CMA-VARI TO FEC-FVLD IN FEC-VARI
           ELSE
               MOVE 1937 TO FEC-FANO IN FEC-VARI
               MOVE   01 TO FEC-FMES IN FEC-VARI
               MOVE   01 TO FEC-FDIA IN FEC-VARI.

           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GVT-NUM-STSN IN GVT-FLD TO FEC-SEC2.
           MOVE GVT-NUM-ATSN IN GVT-FLD TO FEC-AEC2.
           MOVE GVT-NUM-MTSN IN GVT-FLD TO FEC-MEC2.
           MOVE GVT-NUM-DTSN IN GVT-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GVTTSNANTIGU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-FTSN.

      *>>>>
*% END
*% LBL = ''
*% IF GVT_FEC_FRVL
      *<<<< GVT_FEC_RVL

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GVT-NUM-STSN IN GVT-FLD TO FEC-SEC1.
           MOVE GVT-NUM-ATSN IN GVT-FLD TO FEC-AEC1.
           MOVE GVT-NUM-MTSN IN GVT-FLD TO FEC-MEC1.
           MOVE GVT-NUM-DTSN IN GVT-FLD TO FEC-DEC1.

           MOVE GVT-NUM-SRVL IN GVT-FLD TO FEC-SEC2.
           MOVE GVT-NUM-ARVL IN GVT-FLD TO FEC-AEC2.
           MOVE GVT-NUM-MRVL IN GVT-FLD TO FEC-MEC2.
           MOVE GVT-NUM-DRVL IN GVT-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GVTRVLANTIGU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-FRVL.

           IF GAR-NUM-PVTS IN CMA-VARI NOT > ZEROES
               GO TO FIN-VAL-VIG-RVL.

      * Suma periodo de vigencia a Fecha Tasacion

           MOVE GVT-NUM-STSN IN GVT-FLD TO FEC-ITM3.
           MOVE GVT-NUM-ATSN IN GVT-FLD TO FEC-ITM4.
           MOVE GVT-NUM-MTSN IN GVT-FLD TO FEC-ITM2.
           MOVE GVT-NUM-DTSN IN GVT-FLD TO FEC-ITM1.

           IF GAR-COD-TPVT IN CMA-VARI = 'A'
               MOVE GAR-NUM-PVTS IN CMA-VARI TO FEC-NANO
               MOVE FEC-SUM-ANO              TO FEC-CMND
           ELSE
           IF GAR-COD-TPVT IN CMA-VARI = 'M'
               MOVE GAR-NUM-PVTS IN CMA-VARI TO FEC-NMES
               MOVE FEC-SUM-MES              TO FEC-CMND
           ELSE
           IF GAR-COD-TPVT IN CMA-VARI = 'D'
               MOVE GAR-NUM-PVTS IN CMA-VARI TO FEC-NDIA
               MOVE FEC-SUM-DIA              TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
*% IF PGM_VMS
      *<<<< PGM_VMS
           PERFORM PRO-FEC.
      *>>>>
*% ELSE
      *<<<< NOT PGM_VMS
           PERFORM CAL-FEC.
      *>>>>
*% END
           
      * Usa fecha resultante como Fecha Maxima de Revalorizacion
           MOVE FEC-ITM1 TO FEC-DEC1.
           MOVE FEC-ITM2 TO FEC-MEC1.
           MOVE FEC-ITM3 TO FEC-SEC1.
           MOVE FEC-ITM4 TO FEC-AEC1.

           MOVE GVT-NUM-SRVL IN GVT-FLD TO FEC-SEC2.
           MOVE GVT-NUM-ARVL IN GVT-FLD TO FEC-AEC2.
           MOVE GVT-NUM-MRVL IN GVT-FLD TO FEC-MEC2.
           MOVE GVT-NUM-DRVL IN GVT-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GVTRVL>VIG'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-FRVL.
       FIN-VAL-VIG-RVL.

      *>>>>
*% END
*% LBL = ''
*% IF GVT_SGV_VCTS
      *<<<< GVT_VAL_CML_TSN
      *CGL-INI
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GVT-FLD TO WSS-TIPO-1 IN WSS-VARI.
           MOVE GDG-STP-CGTA IN GVT-FLD TO WSS-AUX-1 IN WSS-VARI.
           MOVE WSS-TIPO-AUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TIAU IN WSS-VARI.

           IF GVT-SGV-VCTS IN GVT-FLD NOT > 1
              MOVE 'GAR'          TO MSG-COD-SIST
              MOVE 'VLRNOPERM'    TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GVT-SGV-VCTS.

           PERFORM OBT-COD-MNAC.
           IF SCR-CCPP = 'ING' AND
              FRM-IND-GTP IN GVT-FLD = 'S'
               GO TO FIN-VAL-GVT-SGV-VCTS.

           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO WSS-SGV-VCTS-AUX

               MOVE GVT-CAI-GTIA IN GVT-FLD TO GTP-CAI-GTIA IN GTP
               MOVE GVT-IIC-GTIA IN GVT-FLD TO GTP-IIC-GTIA IN GTP
               MOVE GVT-COD-TASN IN GVT-FLD TO GTP-NUM-ITSN IN GTP
               MOVE '00' TO FIO-STAT

      *        Suma las tasaciones parciales para llenar valores CML y LIQ
               PERFORM TOT-GTP
               VARYING GAR-COD-ITSN IN WSS-VARI
                     FROM 1 
                     BY   1 
                     UNTIL ( NOT FIO-STAT-OKS) OR 
                           ( MSG-COD-MENS > SPACES)
      * 
               IF MSG-COD-MENS > SPACES
                  GO TO FIN-VAL-GVT-SGV-VCTS
               ELSE
      * 
                  MOVE WSS-SGV-VCTS-AUX TO GVT-SGV-VCTS IN GVT-FLD.

      * Obtiene valor sin decimales
           IF FIO-STAT-OKS AND 
              GDG-COD-VCAM  IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-SGV-VCTS IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-SGV-VCTS IN GVT-FLD.
      *>>>>
*% END
*% IF GVT_VAL_LIQ_TSN
      *<<<< GVT_VAL_LIQ_TSN

      *>>>>
*% END
*% IF NOT (PGM_PER OR PGM_CLB OR PGM_MEX)
*% IF GVT_SGV_PPCT
      *
      *<<<< GVT_PCT_PON
           IF GVT-SGV-PPCT IN GVT-FLD = ZEROES
               MOVE GAR-SGV-PPON IN CMA-VARI TO GVT-SGV-PPCT IN GVT-FLD
           ELSE
           IF GVT-SGV-PPCT IN GVT-FLD > 100
               MOVE '% > 100' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% END
*% IF GVT_SGV_LTSN
      *<<<< GVT_SGV_LTSN
*% IF GEN_BCI
      *<<<< GEN_BCI
      *FLB CST  4-MAY-1994 ARREGLADO MEJOR QUE ARGENTINA
           IF FRM-IND-GTP IN GVT-FLD = 'S' AND
              WSS-LIQ-CML IN CMA-VARI > ZEROES AND
              WSS-SGV-LTSN IN CMA-VARI =
              GVT-SGV-LTSN IN GVT-FLD
      *CGL-INI
              IF WSS-CIC-TIAU IN WSS-VARI NOT = '952082'
      *CGL-FIN
                 MULTIPLY WSS-LIQ-CML     IN CMA-VARI BY
                        GVT-SGV-VCTS IN GVT-FLD GIVING
                        GVT-SGV-LTSN IN GVT-FLD ROUNDED
      *CGL-INI
              ELSE    
                 COMPUTE WSS-VALOR-LIQ IN CMA-VARI ROUNDED =
                         WSS-VALOR-LIQ IN CMA-VARI * 1
                 MOVE WSS-VALOR-LIQ IN CMA-VARI TO 
                      GVT-SGV-LTSN IN GVT-FLD.
      *CGL-FIN

           IF GDG-COD-VCAM IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-SGV-LTSN IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-SGV-LTSN IN GVT-FLD.

            IF NOT (
                    SCR-CCPP = 'ING' AND
                    FRM-IND-GTP IN GVT-FLD = 'S'
                   ) AND
               GVT-SGV-LTSN IN GVT-FLD NOT > ZEROES
      *        Solo puede ser 0 al Ingresar GVT con Tasaciones Parciales

                MOVE 'GAR'      TO MSG-COD-SIST
                MOVE 'GVTLIQ=0' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GVT-SGV-LTSN.

           IF GVT-SGV-LTSN IN GVT-FLD >
              GVT-SGV-VCTS IN GVT-FLD AND
              NOT (
                  SCR-CCPP = 'ING' AND FRM-IND-GTP IN GVT-FLD = 'S'
                  )
               MOVE 'GAR'     TO MSG-COD-SIST
               MOVE 'GVTLIQ>CML' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-SGV-LTSN.

      *>>>>
*% END
      *>>>>
*% END
*% IF GVT_SGV_VPND
      *<<<< GVT_SGV_VPND
*% IF GEN_BCI
      *<<<< GEN_BCI
           COMPUTE GVT-SGV-VPND IN GVT-FLD ROUNDED =
                   GVT-SGV-LTSN IN GVT-FLD *
                   GVT-SGV-PPCT IN GVT-FLD / 100.

           IF GDG-COD-VCAM IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-SGV-VPND  IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-SGV-VPND  IN GVT-FLD.

      *>>>>
*% ELSE
*% IF NOT (PGM_PER OR PGM_CLB OR PGM_MEX)

           COMPUTE GVT-SGV-VPND IN GVT-FLD ROUNDED =
                   GVT-SGV-LTSN IN GVT-FLD *
                   GVT-SGV-PPCT IN GVT-FLD / 100.

*% END
           IF GVT-SGV-VPND IN GVT-FLD > GVT-SGV-VCTS IN GVT-FLD
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'VCNT>VCML'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-SGV-VPND.

      *
           MOVE GAR-CAI-GTIA IN CMA-VARI TO GSE-CAI-GTIA IN GSE.    
           MOVE GAR-IIC-GTIA IN CMA-VARI TO GSE-IIC-GTIA IN GSE.    
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
      *
      *    IF FIO-STAT-OKS
           IF NOT FIO-STAT-OKS
              GO TO FIN-VAL-GVT-SGV-VPND.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GVT-FLD TO WSS-COD-TOPE.        
           MOVE GDG-STP-CGTA IN GVT-FLD TO WSS-COD-SOPE.        
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GVT-FLD TO WSS-TSG-OPE.        
*% END
           MOVE  'TAB'                 TO TAB-COD-SIST.       
           MOVE  'NVA'                 TO TAB-COD-TTAB IN TAB.
           MOVE  WSS-TSG-OPE           TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.                                   
           IF MSG-COD-MENS NOT > SPACES                       
              GO TO FIN-VAL-GVT-SGV-VPND.                        
      *
           IF GVT-SGV-VPND IN GVT-FLD > GSE-SGV-SEGU IN GSE
              MOVE 'GAR'        TO MSG-COD-SIST
              MOVE 'VCCTB>VCSEG'  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GVT-SGV-VPND.
      *
*% END
      *>>>>
*% END
*% IF GVT_PCT_AJT_SUP
      *>>>>
*% END
*% IF GVT_SGV_PAJU
      *<<<< GVT_SGV_PAJU
           MOVE GAR-SGV-PAJU IN CMA-VARI TO GVT-SGV-PAJU IN GVT-FLD.
      *>>>>
*% END
*% IF (PGM_PER OR PGM_CLB OR PGM_MEX)
*% IF FRM_VAL_AJT_SUP
      *<<<< FRM_VAL_AJT_SUP
      *>>>>
*% END
*% END
*% IF GVT_SGV_VGAS
      *<<<< GVT_VAL_AJT_SUP
*% IF GEN_BCI
      *<<<< GEN_BCI
           COMPUTE   GVT-SGV-VGAS IN GVT-FLD ROUNDED =
                     GVT-SGV-VCTS IN GVT-FLD -
                   ( GVT-SGV-VCTS IN GVT-FLD *
                     GAR-SGV-PAJU     IN CMA-VARI / 100 ).

           IF GDG-COD-VCAM IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-SGV-VGAS IN GVT-FLD TO 
                    PES-SGV-DECI    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE    IN PES-VARI TO
                    GVT-SGV-VGAS IN GVT-FLD.

      *>>>>
*% ELSE
           MOVE GVT-SGV-VCTS IN GVT-FLD TO GVT-SGV-VGAS IN GVT-FLD.
*% END

      * Se contabiliza por valor ajustado, luego debe ser > 0
      *    salvo en el ingreso con Tasaciones Parciales
           IF NOT (
                   SCR-CCPP = 'ING' AND 
                   FRM-IND-GTP IN GVT-FLD = 'S'
                  ) AND
                   GVT-SGV-VGAS IN GVT-FLD NOT > ZEROES

                MOVE 'GAR'     TO MSG-COD-SIST
                MOVE 'GVTAJT=0' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR.

           PERFORM OBT-VAL-CON.
      *>>>>
*% END
*% IF GVT_COD_TCNS
      *<<<< GVT_TIP_CTR
      *ALD-BNL
      * PARA GAR-IND-TPRE = 'E' NO OBLIGA CAMPO GVT-COD-TCNS
      *
           IF GAR-IND-TPRE IN CMA-VARI = 'N' OR
              GAR-IND-TPRE IN CMA-VARI = 'E'

               MOVE SPACES TO GVT-COD-TCNS IN GVT-FLD
               MOVE SPACES TO FRM-GLS-TCNS IN GVT-FLD
               GO TO FIN-VAL-GVT-COD-TCNS.

           IF GVT-COD-TCNS IN GVT-FLD = SPACES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TIPCTR BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-COD-TCNS.
      *>>>>
*% END
*% IF GVT_COD_MQEQ
      *<<<< GVT_TIP_MAQ_EQP
      *
           IF GAR-IND-TPRE IN CMA-VARI NOT = 'E'
               MOVE SPACES TO GVT-COD-MQEQ IN GVT-FLD
               MOVE SPACES TO FRM-GLS-MQEQ IN GVT-FLD
               GO TO FIN-VAL-GVT-COD-MQEQ.

           IF GVT-COD-MQEQ IN GVT-FLD = SPACES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TIPMEQ BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-COD-MQEQ.
      *>>>>
*% END
*% IF GVT_VAL_TTM2
      *<<<< GVT_VAL-TTM2
           IF NOT ( GAR-IND-OMCT IN CMA-VARI = 'T' OR 'A' )
               MOVE ZEROES TO GVT-VAL-TTM2 IN GVT-FLD
               GO TO FIN-VAL-GVT-VAL-TTM2.

           IF GVT-VAL-TTM2 IN GVT-FLD = ZEROES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'M2TRR BLK'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-VAL-TTM2.
      *>>>>
*% END
*% IF GVT_COD_M2CT
      *<<<< GVT_M2_CTR
           IF NOT ( GAR-IND-OMCT IN CMA-VARI = 'C' OR 'A' )
               MOVE ZEROES TO GVT-COD-M2CT IN GVT-FLD
               GO TO FIN-VAL-GVT-COD-M2CT.

           IF GVT-COD-M2CT IN GVT-FLD = ZEROES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'M2CTR BLK'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-COD-M2CT.
      *>>>>
*% END
*% IF GVT_COD_UMD
      *<<<< GVT_COD_UMD
           IF NOT ( GAR-IND-OMCT IN CMA-VARI = 'C' OR 'T' OR 'A' )
               MOVE SPACES TO GVT-COD-UMD IN GVT-FLD
               GO TO FIN-VAL-GVT-COD-UMD.

           IF GVT-COD-UMD IN GVT-FLD = SPACES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'CODUMD BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-COD-UMD.
      *>>>>
*% END
*% IF EOF_VAX OR EOF_BU
      *<<<< EOF_VAX OR EOF_BU
       TOT-GTP SECTION.   
       INI-TOT-GTP.
      *    Devuelve Sumatoria Tasaciones Parciales en WSS-SGV-VCTS-AUX

           MOVE GAR-COD-ITSN IN WSS-VARI TO
                GTP-COD-ITSN IN GTP.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GTP-COD-EITS IN GTP > '09' AND < '15'
              COMPUTE
                 WSS-SGV-VCTS-AUX = WSS-SGV-VCTS-AUX +
                 GTP-SGV-ITSN IN GTP * GTP-SGV-VTSN IN GTP.
      *CGL-INI
           IF WSS-CIC-TIAU IN WSS-VARI = '952082'
              MOVE GTP-COD-IITS IN GTP     TO ACC-COD-NEMO IN ACC
              MOVE 99999999                TO ACC-FEC-FPRO IN ACC
              MOVE FIO-GET-LEQ TO FIO-CMND
              PERFORM GAR-FIO-ACC
              IF NOT (FIO-STAT-OKS AND
                      ACC-COD-NEMO IN ACC = GTP-COD-IITS IN GTP)
                 NEXT SENTENCE
              ELSE
                 COMPUTE WSS-VALOR-LIQ IN CMA-VARI =
                 ((WSS-SGV-VCTS-AUX * ACC-SGV-PPON IN ACC)/100) +
                   WSS-VALOR-LIQ.
      *CGL-FIN
           IF  NOT GTP-COD-EITS IN GTP > '09'
               MOVE 'GAR'      TO MSG-COD-SIST
               MOVE 'ESAP NOV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

       FIN-TOT-GTP.
           EXIT.

      *>>>>
*% END
*% IF EOF_VAX OR EOF
      *<<<< EOF_VAX 
       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.


       PRO-RTA-RDO SECTION.
       INI-PRO-RTA-RDO.
      *GET-HOY Otiene Fecha actual
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO GVT-FEC-FTSN IN GVT-FLD.
      *PROTEJE CAMPOS
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-STP.

       FIN-PRO-RTA-RDO.
           EXIT.


*% IF NOT (PGM_PER OR PGM_CLB OR PGM_MEX)
       OBT-VAL-CON SECTION.
       INI-OBT-VAL-CON.
           MOVE GDG-COD-VCAM IN GVT-FLD TO GDG-COD-VCAM IN GDG.
           IF NOT (
              GDG-COD-TVCM IN GDG = '0' AND
              GDG-COD-VCAM IN GVT-FLD NOT = WSS-COD-PESO IN WSS-VARI
              )
               MOVE GVT-SGV-VGAS IN GVT-FLD TO
                    FRM-VAL-ULT-CON IN GVT-FLD

               GO TO FIN-OBT-VAL-CON.

           MOVE GVT-NUM-SRVL IN GVT-FLD  TO CAM-NUM-SCAM IN CAM(1).
           MOVE GVT-NUM-ARVL IN GVT-FLD  TO CAM-NUM-ACAM IN CAM(1).
           MOVE GVT-NUM-MRVL IN GVT-FLD  TO CAM-NUM-MCAM IN CAM(1).
           MOVE GVT-NUM-DRVL IN GVT-FLD  TO CAM-NUM-DCAM IN CAM(1).

           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE GDG-COD-VCAM IN GVT-FLD  TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
              )
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MULTIPLY GVT-SGV-VGAS IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED
               MOVE WSS-VAL-PESO TO FRM-VAL-ULT-CON IN GVT-FLD.
       FIN-OBT-VAL-CON.
           EXIT.

*% END
      *>>>>
*% END
*% IF INI_GVT_CAI_GTIA
*% IF NOT GEN_BCI
      *<<<< NOT GEN_BCI
      *INI_GVT_CAI.
           IF GVT-CAI-GTIA IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-CAI-GTIA IN GVT-FLD
               PERFORM ERR-GLS
               GO TO FIN-VAL-GVT-CAI-GTIA.
      *>>>>
*% END
*% END
*% IF EOF_BQ AND NOT PGM_BM
      *<<<< EOF_BQ AND NOT PGM_BM
       PRO-FLD-GVT SECTION.
       INI-PRO-FLD-GVT.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-STP.

           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-STP.

           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-STP.

           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-STP.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VGAS-ATR IN GVT-FLD.
           PERFORM PRO-GVT-GVT.
           PERFORM PRO-GDG-GVT.
           IF SCR-CMND = 'ING' OR SCR-CMND = 'MOD'
               MOVE FRM-CPIM-AEY TO GVT-COD-SDAG-ATR IN GVT-FLD.
       FIN-PRO-FLD-GVT.
           EXIT.
       
       PRO-GVT-GVT SECTION.
       INI-PRO-GVT-GVT.
      * IDC-FIN --> BMMEXBNM005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO GVT-FEC-FTSN-ATR IN GVT-FLD.
      *CGL-INI  19-AUG-2003 18:08:08 
      *     MOVE FRM-CPIM-AEY TO GVT-COD-CRIT-ATR IN GVT-FLD.
      *     MOVE FRM-CPIM-AEY TO GVT-COD-OAVA-ATR IN GVT-FLD.
      *     MOVE FRM-CPIM-AEY TO GVT-COD-ADAG-ATR IN GVT-FLD.
      *CGL-FIN  19-AUG-2003 18:11:33 
           MOVE FRM-CPIM-AEY TO GVT-COD-SDAG-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VCTS-ATR IN GVT-FLD.
      *CGL-INI  19-AUG-2003 18:12:21 
      *     MOVE FRM-CPIM-AEY TO GVT-SGV-FISI-ATR IN GVT-FLD.
      *CGL-FIN  19-AUG-2003 18:12:29 
      *MHM-INI 15-OCT-2003
           MOVE FRM-CPIM-AEY TO GVT-SGV-PPCT-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-VSIN-ATR IN GVT-FLD.
      *MHM-FIN 15-OCT-2003
           MOVE FRM-CPIM-AEY TO GVT-SGV-VPND-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-PAJU-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-SGV-LTSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-EITS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-ISVS-ATR IN GVT-FLD.
      * IDC-FIN --> BMMEXBNM005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO GVT-FEC-FRVL-ATR IN GVT-FLD.
       FIN-PRO-GVT-GVT.
           EXIT.
       
       PRO-GDG-GVT SECTION.
       INI-PRO-GDG-GVT.
       FIN-PRO-GDG-GVT.
           EXIT.
      *>>>>
*% END

