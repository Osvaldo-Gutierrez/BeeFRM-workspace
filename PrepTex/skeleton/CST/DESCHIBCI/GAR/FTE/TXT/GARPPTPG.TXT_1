      CBL SIZE(10000K)
       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. GARPPTPG.
       AUTHOR. CONSIST.
       DATE-WRITTEN.   28-OCT-2003 01:21:14
      *
      * PROGRAMA TRADUCTOR PARA SISTEMA DE GARANTIAS
      *
      *
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *-------------*
       WORKING-STORAGE SECTION.
      *-----------------------*
      *
      *
      *INI Copys generados Working
       COPY GARMXWS1.
       COPY GARNXWS1.

       COPY GARMXWS2.
       COPY GARNXWS2.

       COPY GARMXWS3.
       COPY GARNXWS3.
      *FIN
       COPY GARWXQHT.
       COPY GARWXQHP.
       COPY GARWXCGD.
       COPY GARWXGTP.
       COPY GARWXGDD.
       COPY GARWXGDG.
       COPY GARWXGXD.
       COPY GARWXGSL.
       COPY GARWXAXG.
       COPY GARWXSXG.
       COPY GARWXCOG.

      * 77  WSS-ESCR-TMP VALUE 'N'    PIC X(01).
      * 77  WSS-WCAC     VALUE 'N'    PIC X(01).
        77  WSS-PATH     VALUE SPACES PIC X(02).
        01  WSS-TX-TMP  VALUE SPACES.
            03  WSS-TX-TMP-OCC            OCCURS 9500 TIMES.
                05  WSS-TX-TMP-ELM               PIC X(01).
        01  WSS-TX-TMP-RED REDEFINES WSS-TX-TMP.
            03 WSS-TX-TMP-RED-HDR     PIC X(0100).
            03 WSS-TX-TMP-RED-DAT     PIC X(9400).
        01  WSS-PT-TMP  VALUE SPACES.
            03  WSS-PT-TMP-OCC            OCCURS 9500 TIMES.
                05  WSS-PT-TMP-ELM               PIC X(01).

       01  BKP-TX-050.
           03 BKP-TX-050-GDG                     PIC X(368).
           03 BKP-TX-050-GUB                     PIC X(195).
           03 BKP-TX-050-GDD                     PIC X(920).

       01  NEW-TX-050.
           03 NEW-TX-050-GDG                     PIC X(368).
           03 NEW-TX-050-GDD                     PIC X(920).

       COPY GNSWGMXX.

       77  WSS-ULT-REG      VALUE ZEROES        PIC 9(02).

       COPY GNSWGSEG.
       COPY GNSWGHOY.
       COPY GNSWGTSK.
       COPY GNSWGPFG.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGSYS.

       COPY GNSBRTXI.
       COPY GNSWRTDI.
       COPY GNSWGTDI.

       COPY GNSBRTXO.
       COPY GNSWRTDO.
       COPY GNSWGTDO.

       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGQUE.
       COPY GNSWGFRM.
       COPY GNSWVSCR.
       COPY GNSWGMX1.
      *

       01  WS-VARI.
           03 WSS-ITX-DEST  VALUE ZEROES  PIC 9(05).
           03 WSS-ITX-ORIG  VALUE ZEROES  PIC 9(05).
           03 WSS-ITX-LARG  VALUE ZEROES  PIC 9(05).
           03 WSS-ITX-INDX  VALUE ZEROES  PIC 9(05).
           03 WSS-VAL-EDIT                PIC ZZ.ZZZ.ZZZ.ZZ9,9999.

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                     PIC X(06).
      *
       PROCEDURE DIVISION.
      *===================
      *
       MAIN SECTION.
       INI-MAIN.
      *ISP-INI 06-02-2003
      * MENSAJE DE 4096 BYTES DE LARGO
           MOVE 4 TO SEG-MAX-ELEM.
      *ISP-INI 06-02-2003

           MOVE +1025 TO SEG-LEN-TSSEG.
           PERFORM GET-TSK-TERM.
           MOVE TSK-TERM-ALF TO WSS-COD-TERM IN WSS-TSQHT.
           MOVE TSK-TERM-ALF TO WSS-COD-TERM IN WSS-TSQHP.
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSCGD.
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGDD.
           MOVE TSK-TERM-ALF TO WSY-COD-TERM IN WSY-TSGDD.
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGTP.
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGDG.
           MOVE TSK-TERM-ALF TO GXD-COD-TERM IN GXD-TSGXD.
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGSL.
           MOVE TSK-TERM-ALF TO WSS-COD-TERM IN WSS-TSCOG.


           MOVE TSK-TERM-ALF TO AXG-COD-TERM.
           MOVE TSK-TERM-ALF TO SXG-COD-TERM.

      * HAY-MAS INI
           MOVE TSK-TERM-ALF TO GXD-COD-TERM-MAS.
           MOVE TSK-TERM-ALF TO AXG-COD-TERM-MAS.
           MOVE TSK-TERM-ALF TO COG-COD-TERM-MAS.
           MOVE TSK-TERM-ALF TO SXG-COD-TERM-MAS.
           MOVE TSK-TERM-ALF TO QHP-COD-TERM-MAS.

      * HAY-MAS FIN


           PERFORM GNS-ERR-QUE.
      *     PERFORM ELI-TSS-DEU.
      * RECIBO IDENTIFICACION DEL PC QUE ENVIO EL MSG.
           MOVE DFHCOMMAREA(1:EIBCALEN) TO SCR-NOM-TCPIP.

           MOVE +9000   TO TDI-LTDI.
           MOVE +9000   TO TDO-LTDO.

           MOVE 'GNSPPMTX'   TO SYS-PROG.
           MOVE 0            TO SYS-TCMA.
           MOVE SPACES       TO SYS-CMMA.

           MOVE SPACES           TO WSS-RCV.
           MOVE SPACES           TO WSS-SND.
           PERFORM GNS-ERR-QUE.

           MOVE SCR-NOM-TCPIP    TO WSS-PTR-COD-TYPE.

           PERFORM PROCESO-LEE-TS.

           PERFORM PRO-REQ.
           PERFORM SND-TS-MSSG.
       FIN-MAIN.
           EXEC CICS
                 RETURN
           END-EXEC.
       EXT-MAIN.
           EXIT.

       PRO-REQ SECTION.
       INI-PRO-REQ.
      *DDD DISPLAY 'GARPPTPG -----::: EN PRO-REQ '.
           MOVE TSK-TERM-ALF   TO QUE-TERM.
           MOVE PTC-IBYA-TYPE  TO QUE-TYPE.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE PTC-IBYA-LENG TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE 'S' TO QUE-ITEM.
           PERFORM GNS-PRO-QUE.

           MOVE WSS-RCV-CREQ TO WSS-COD-CREQ.
      *DDD DISPLAY 'GARPPTPG -----::: RECIBIDO ' WSS-RCV.

      *DDD DISPLAY 'GARPPTPG -----::: COMANDO ' WSS-COD-CREQ.

           PERFORM SET-NMSF.


           IF WSS-COD-CREQ = '101'
              PERFORM PRO-REQ-101
           ELSE
           IF WSS-COD-CREQ = '201'
              PERFORM PRO-REQ-201
           ELSE
           IF WSS-COD-CREQ = '001'
              PERFORM PRO-REQ-001
           ELSE
           IF WSS-COD-CREQ = '002'
              PERFORM PRO-REQ-002
           ELSE
           IF WSS-COD-CREQ = '203'
              PERFORM PRO-REQ-203
           ELSE
           IF WSS-COD-CREQ = '003'
              PERFORM PRO-REQ-003
           ELSE
           IF WSS-COD-CREQ = '004'
              PERFORM PRO-REQ-004
           ELSE
           IF WSS-COD-CREQ = '105'
              PERFORM PRO-REQ-105
           ELSE
           IF WSS-COD-CREQ = '205'
              PERFORM PRO-REQ-205
           ELSE
           IF WSS-COD-CREQ = '005'
              PERFORM PRO-REQ-005
           ELSE
           IF WSS-COD-CREQ = '006'
              PERFORM PRO-REQ-006
           ELSE
           IF WSS-COD-CREQ = '207'
              PERFORM PRO-REQ-207
           ELSE
           IF WSS-COD-CREQ = '007'
              PERFORM PRO-REQ-007
           ELSE
           IF WSS-COD-CREQ = '008'
              PERFORM PRO-REQ-008
           ELSE
           IF WSS-COD-CREQ = '009'
              PERFORM PRO-REQ-009
           ELSE
           IF WSS-COD-CREQ = '010'
              PERFORM PRO-REQ-010
           ELSE
           IF WSS-COD-CREQ = '111'
              PERFORM PRO-REQ-111
           ELSE
           IF WSS-COD-CREQ = '011'
              PERFORM PRO-REQ-011
           ELSE
           IF WSS-COD-CREQ = '012'
              PERFORM PRO-REQ-012
           ELSE
           IF WSS-COD-CREQ = '013'
              PERFORM PRO-REQ-013
           ELSE
           IF WSS-COD-CREQ = '413'
              PERFORM PRO-REQ-413
           ELSE
           IF WSS-COD-CREQ = '014'
              PERFORM PRO-REQ-014
           ELSE
           IF WSS-COD-CREQ = '414'
              PERFORM PRO-REQ-414
           ELSE
           IF WSS-COD-CREQ = '514'
              PERFORM PRO-REQ-514
           ELSE
           IF WSS-COD-CREQ = '115'
              PERFORM PRO-REQ-115
           ELSE
           IF WSS-COD-CREQ = '015'
              PERFORM PRO-REQ-015
           ELSE
           IF WSS-COD-CREQ = '016'
              PERFORM PRO-REQ-016
           ELSE
           IF WSS-COD-CREQ = '017'
              PERFORM PRO-REQ-017
           ELSE
           IF WSS-COD-CREQ = '018'
              PERFORM PRO-REQ-018
           ELSE
           IF WSS-COD-CREQ = '119'
              PERFORM PRO-REQ-119
           ELSE
           IF WSS-COD-CREQ = '019'
              PERFORM PRO-REQ-019
           ELSE
           IF WSS-COD-CREQ = '020'
              PERFORM PRO-REQ-020
           ELSE
           IF WSS-COD-CREQ = '021'
              PERFORM PRO-REQ-021
           ELSE
           IF WSS-COD-CREQ = '022'
              PERFORM PRO-REQ-022
           ELSE
           IF WSS-COD-CREQ = '123'
              PERFORM PRO-REQ-123
           ELSE
           IF WSS-COD-CREQ = '023'
              PERFORM PRO-REQ-023
           ELSE
           IF WSS-COD-CREQ = '024'
              PERFORM PRO-REQ-024
           ELSE
           IF WSS-COD-CREQ = '025'
              PERFORM PRO-REQ-025
           ELSE
           IF WSS-COD-CREQ = '026'
              PERFORM PRO-REQ-026
           ELSE
           IF WSS-COD-CREQ = '127'
              PERFORM PRO-REQ-127
           ELSE
           IF WSS-COD-CREQ = '027'
              PERFORM PRO-REQ-027
           ELSE
           IF WSS-COD-CREQ = '028'
              PERFORM PRO-REQ-028
           ELSE
           IF WSS-COD-CREQ = '029'
              PERFORM PRO-REQ-029
           ELSE
           IF WSS-COD-CREQ = '030'
              PERFORM PRO-REQ-030
           ELSE
           IF WSS-COD-CREQ = '031'
              PERFORM PRO-REQ-031
           ELSE
           IF WSS-COD-CREQ = '132'
              PERFORM PRO-REQ-132
           ELSE
           IF WSS-COD-CREQ = '232'
              PERFORM PRO-REQ-232
           ELSE
           IF WSS-COD-CREQ = '032'
              PERFORM PRO-REQ-032
           ELSE
           IF WSS-COD-CREQ = '232'
              PERFORM PRO-REQ-232
           ELSE
           IF WSS-COD-CREQ = '332'
              PERFORM PRO-REQ-332
           ELSE
           IF WSS-COD-CREQ = '033'
              PERFORM PRO-REQ-033
           ELSE
           IF WSS-COD-CREQ = '034'
              PERFORM PRO-REQ-034
           ELSE
           IF WSS-COD-CREQ = '035'
              PERFORM PRO-REQ-035
           ELSE
           IF WSS-COD-CREQ = '036'
              PERFORM PRO-REQ-036
           ELSE
           IF WSS-COD-CREQ = '037'
              PERFORM PRO-REQ-037
      *     ELSE
      *     IF WSS-COD-CREQ = '038'
      *        PERFORM PRO-REQ-038
           ELSE
           IF WSS-COD-CREQ = '039'
              PERFORM PRO-REQ-039
           ELSE
           IF WSS-COD-CREQ = '140'
              PERFORM PRO-REQ-140
           ELSE
           IF WSS-COD-CREQ = '040'
              PERFORM PRO-REQ-040
           ELSE
           IF WSS-COD-CREQ = '041'
              PERFORM PRO-REQ-041
           ELSE
           IF WSS-COD-CREQ = '042'
              PERFORM PRO-REQ-042
           ELSE
           IF WSS-COD-CREQ = '043'
              PERFORM PRO-REQ-043
           ELSE
           IF WSS-COD-CREQ = '044'
              PERFORM PRO-REQ-044
           ELSE
           IF WSS-COD-CREQ = '145'
              PERFORM PRO-REQ-145
           ELSE
           IF WSS-COD-CREQ = '045'
              PERFORM PRO-REQ-045
           ELSE
           IF WSS-COD-CREQ = '046'
              PERFORM PRO-REQ-046
           ELSE
           IF WSS-COD-CREQ = '047'
              PERFORM PRO-REQ-047
           ELSE
           IF WSS-COD-CREQ = '048'
              PERFORM PRO-REQ-048
      *     ELSE
      *     IF WSS-COD-CREQ = '049'
      *        PERFORM PRO-REQ-049
           ELSE
           IF WSS-COD-CREQ = '150'
              PERFORM PRO-REQ-150
           ELSE
           IF WSS-COD-CREQ = '250'
              PERFORM PRO-REQ-250
           ELSE
           IF WSS-COD-CREQ = '050'
              PERFORM PRO-REQ-050
           ELSE
           IF WSS-COD-CREQ = '051'
              PERFORM PRO-REQ-051
           ELSE
           IF WSS-COD-CREQ = '252'
              PERFORM PRO-REQ-252
           ELSE
           IF WSS-COD-CREQ = '052'
              PERFORM PRO-REQ-052
           ELSE
           IF WSS-COD-CREQ = '053'
              PERFORM PRO-REQ-053
           ELSE
           IF WSS-COD-CREQ = '054'
              PERFORM PRO-REQ-054
           ELSE
           IF WSS-COD-CREQ = '255'
              PERFORM PRO-REQ-255
           ELSE
           IF WSS-COD-CREQ = '055'
              PERFORM PRO-REQ-055
           ELSE
           IF WSS-COD-CREQ = '056'
              PERFORM PRO-REQ-056
           ELSE
           IF WSS-COD-CREQ = '057'
              PERFORM PRO-REQ-057
           ELSE
           IF WSS-COD-CREQ = '058'
              PERFORM PRO-REQ-058
           ELSE
           IF WSS-COD-CREQ = '059'
              PERFORM PRO-REQ-059
           ELSE
           IF WSS-COD-CREQ = '060'
              PERFORM PRO-REQ-060
           ELSE
           IF WSS-COD-CREQ = '061'
              PERFORM PRO-REQ-061
           ELSE
           IF WSS-COD-CREQ = '162'
              PERFORM PRO-REQ-162
           ELSE
           IF WSS-COD-CREQ = '062'
              PERFORM PRO-REQ-062
           ELSE
           IF WSS-COD-CREQ = '063'
              PERFORM PRO-REQ-063
           ELSE
           IF WSS-COD-CREQ = '064'
              PERFORM PRO-REQ-064
           ELSE
           IF WSS-COD-CREQ = '065'
              PERFORM PRO-REQ-065
           ELSE
           IF WSS-COD-CREQ = '066'
              PERFORM PRO-REQ-066
           ELSE
           IF WSS-COD-CREQ = '067'
              PERFORM PRO-REQ-067
           ELSE
           IF WSS-COD-CREQ = '068'
              PERFORM PRO-REQ-068
           ELSE
           IF WSS-COD-CREQ = '069'
              PERFORM PRO-REQ-069
           ELSE
           IF WSS-COD-CREQ = '558' OR
              WSS-COD-CREQ = '658' OR
              WSS-COD-CREQ = '551' OR
              WSS-COD-CREQ = '651'
              PERFORM PRO-REQ-PFS-GDD
           ELSE
           IF WSS-COD-CREQ = '070'
              PERFORM PRO-REQ-070
           ELSE
           IF WSS-COD-CREQ = '071'
              PERFORM PRO-REQ-071
           ELSE
           IF WSS-COD-CREQ = '172'
              PERFORM PRO-REQ-172
           ELSE
           IF WSS-COD-CREQ = '072'
              PERFORM PRO-REQ-072
           ELSE
           IF WSS-COD-CREQ = '176'
              PERFORM PRO-REQ-176
           ELSE
           IF WSS-COD-CREQ = '276'
              PERFORM PRO-REQ-276
           ELSE
           IF WSS-COD-CREQ = '076'
              PERFORM PRO-REQ-076
           ELSE
           IF WSS-COD-CREQ = '077'
              PERFORM PRO-REQ-077
           ELSE
           IF WSS-COD-CREQ = '078'
              PERFORM PRO-REQ-078
           ELSE
           IF WSS-COD-CREQ = '079'
              PERFORM PRO-REQ-079
           ELSE
           IF WSS-COD-CREQ = '081'
              PERFORM PRO-REQ-081
           ELSE
           IF WSS-COD-CREQ = '082'
              PERFORM PRO-REQ-082
           ELSE
           IF WSS-COD-CREQ = '084'
              PERFORM PRO-REQ-084
           ELSE
           IF WSS-COD-CREQ = '085'
              PERFORM PRO-REQ-085
           ELSE
           IF WSS-COD-CREQ = '086'
              PERFORM PRO-REQ-086
           ELSE
           IF WSS-COD-CREQ = '187'
              PERFORM PRO-REQ-187
           ELSE
           IF WSS-COD-CREQ = '087'
              PERFORM PRO-REQ-087
           ELSE
           IF WSS-COD-CREQ = '088'
              PERFORM PRO-REQ-088
           ELSE
           IF WSS-COD-CREQ = '089'
              PERFORM PRO-REQ-089
           ELSE
           IF WSS-COD-CREQ = '095'
              PERFORM PRO-REQ-095
           ELSE
           IF WSS-COD-CREQ = '096'
              PERFORM PRO-REQ-096
           ELSE
           IF WSS-COD-CREQ = '097'
              PERFORM PRO-REQ-097
           ELSE
           IF WSS-COD-CREQ = '099'
              PERFORM PRO-REQ-099
           ELSE
      *         Error en Requerimiento.
              MOVE SPACES TO WSS-SND
              MOVE '1' TO WSS-SND-STAT
              MOVE 'ERROR EN CODIGO DE REQUERIMIENTO' TO WSS-SND.
       FIN-PRO-REQ.
           EXIT.

       PRO-REQ-101 SECTION.
       INI-PRO-REQ-101.
      * GDP,ING,GKY
           PERFORM EDT-NUM-PT-REQ-101.

           PERFORM MOV-GNS-101-01.
           PERFORM MOV-PT-TX-101-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-101-01.
           PERFORM VAL-NUM-TP-REQ-101.

       FIN-PRO-REQ-101.
           EXIT.

       PRO-REQ-201 SECTION.
       INI-PRO-REQ-201.
      * GDP,ING,GFL(CONFIMACION)
           PERFORM EDT-NUM-PT-REQ-201.
           PERFORM MOV-GNS-201-01.
           PERFORM MOV-PT-TX-201-01.
           PERFORM MOV-GNS-201-02.
           PERFORM MOV-PT-TX-201-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-201-01.
           PERFORM VAL-NUM-TP-REQ-201.

       FIN-PRO-REQ-201.
           EXIT.

       PRO-REQ-001 SECTION.
       INI-PRO-REQ-001.
      * GDP,ING,GFL
           PERFORM EDT-NUM-PT-REQ-001.
           PERFORM MOV-GNS-001-01.
           PERFORM MOV-PT-TX-001-01.
           PERFORM MOV-GNS-001-02
           PERFORM MOV-PT-TX-001-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-001.

       FIN-PRO-REQ-001.
           EXIT.

       PRO-REQ-002 SECTION.
       INI-PRO-REQ-002.
      * GDP,CON
           PERFORM EDT-NUM-PT-REQ-002.
           PERFORM MOV-GNS-002-01.
           PERFORM MOV-PT-TX-002-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-002-01.
           PERFORM VAL-NUM-TP-REQ-002.

       FIN-PRO-REQ-002.
           EXIT.

       PRO-REQ-203 SECTION.
       INI-PRO-REQ-203.
      * GDP,MOD ( CONFIRMA )
           PERFORM EDT-NUM-PT-REQ-203.

           PERFORM MOV-GNS-203-01.
           PERFORM MOV-PT-TX-203-01.
           PERFORM MOV-GNS-203-02.
           PERFORM MOV-PT-TX-203-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-203-01.
           PERFORM VAL-NUM-TP-REQ-203.

       FIN-PRO-REQ-203.
           EXIT.

       PRO-REQ-003 SECTION.
       INI-PRO-REQ-003.
      * GDP,MOD
           PERFORM EDT-NUM-PT-REQ-003.

           PERFORM MOV-GNS-003-01.
           PERFORM MOV-PT-TX-003-01.
           PERFORM MOV-GNS-003-02.
           PERFORM MOV-PT-TX-003-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-003.

       FIN-PRO-REQ-003.
           EXIT.

       PRO-REQ-004 SECTION.
       INI-PRO-REQ-004.
      * GDP,ELI
           PERFORM EDT-NUM-PT-REQ-004.

           PERFORM MOV-GNS-004-01.
           PERFORM MOV-PT-TX-004-01.
           PERFORM MOV-GNS-004-02.
           PERFORM MOV-PT-TX-004-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-004.

       FIN-PRO-REQ-004.
           EXIT.

       PRO-REQ-105 SECTION.
       INI-PRO-REQ-105.
      * GAP,ING,GKY
           PERFORM EDT-NUM-PT-REQ-105.

           PERFORM MOV-GNS-105-01.
           PERFORM MOV-PT-TX-105-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-105-01.
           PERFORM VAL-NUM-TP-REQ-105.

       FIN-PRO-REQ-105.
           EXIT.

       PRO-REQ-205 SECTION.
       INI-PRO-REQ-205.
      * GAP,ING,GFL ( CONFIRMA )
           PERFORM EDT-NUM-PT-REQ-205.

           PERFORM MOV-GNS-205-01.
           PERFORM MOV-PT-TX-205-01.
           PERFORM MOV-GNS-205-02.
           PERFORM MOV-PT-TX-205-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-205-01.
           PERFORM VAL-NUM-TP-REQ-205.

       FIN-PRO-REQ-205.
           EXIT.


       PRO-REQ-005 SECTION.
       INI-PRO-REQ-005.
      * GAP,ING,GFL
           PERFORM EDT-NUM-PT-REQ-005.

           PERFORM MOV-GNS-005-01.
           PERFORM MOV-PT-TX-005-01.
           PERFORM MOV-GNS-005-02.
           PERFORM MOV-PT-TX-005-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-005-01.
           PERFORM VAL-NUM-TP-REQ-005.

       FIN-PRO-REQ-005.
           EXIT.

       PRO-REQ-006 SECTION.
       INI-PRO-REQ-006.
      * GAP,CON
      *DDD DISPLAY 'GARPPTPG EN INI-PRO-REQ-006'.

           PERFORM EDT-NUM-PT-REQ-006.
           PERFORM MOV-GNS-006-01.
           PERFORM MOV-PT-TX-006-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-006-01.
           PERFORM VAL-NUM-TP-REQ-006.
      *DDD DISPLAY 'GARPPTPG EN FIN-PRO-REQ-006'.
      *DDD DISPLAY TP-006.
       FIN-PRO-REQ-006.
           EXIT.

       PRO-REQ-207 SECTION.
       INI-PRO-REQ-207.
      * GAP,MOD ( CONFIRMA )
           PERFORM EDT-NUM-PT-REQ-207.
           PERFORM MOV-GNS-207-01.
           PERFORM MOV-PT-TX-207-01.
           PERFORM MOV-GNS-207-02.
           PERFORM MOV-PT-TX-207-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-207-01.
           PERFORM VAL-NUM-TP-REQ-207.
       FIN-PRO-REQ-207.
           EXIT.

       PRO-REQ-007 SECTION.
       INI-PRO-REQ-007.
      * GAP,MOD
           PERFORM EDT-NUM-PT-REQ-007.
           PERFORM MOV-GNS-007-01.
           PERFORM MOV-PT-TX-007-01.
           PERFORM MOV-GNS-007-02.
           PERFORM MOV-PT-TX-007-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-007.

       FIN-PRO-REQ-007.
           EXIT.

       PRO-REQ-008 SECTION.
       INI-PRO-REQ-008.
      * GAP,ELI
           PERFORM EDT-NUM-PT-REQ-008.

           PERFORM MOV-GNS-008-01.
           PERFORM MOV-PT-TX-008-01.
           PERFORM MOV-GNS-008-02.
           PERFORM MOV-PT-TX-008-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-008.

       FIN-PRO-REQ-008.
           EXIT.

       PRO-REQ-009 SECTION.
       INI-PRO-REQ-009.
      * QHT,CON
           PERFORM EDT-NUM-PT-REQ-009.

           PERFORM MOV-GNS-009-01.
           PERFORM MOV-PT-TX-009-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-009-01.

           MOVE WSS-NOM-TSQHT  TO QUE-COLA.
           MOVE WSS-LEN-TSQHT  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           MOVE 1              TO QUE-NITM.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE QUE-ITEM TO WSS-TAB-QHT

              MOVE WSS-NOM-TSQHT  TO QUE-COLA
              MOVE QUE-DEL        TO QUE-CMND
              PERFORM GNS-PRO-QUE

           ELSE
              MOVE SPACES TO WSS-TAB-QHT.
           MOVE ZEROES TO WSS-IDX-QHT.
           PERFORM PRO-REQ-009-I VARYING I FROM 1 BY 1 UNTIL (I > 5).
           PERFORM VAL-NUM-TP-REQ-009.

       FIN-PRO-REQ-009.
           EXIT.

       PRO-REQ-009-I SECTION.
       INI-PRO-REQ-009-I.
           PERFORM PRO-REQ-009-J VARYING J FROM 1 BY 1 UNTIL (J > 9).
       FIN-PRO-REQ-009-I.
           EXIT.

       PRO-REQ-009-J SECTION.
       INI-PRO-REQ-009-J.
           ADD 1 TO WSS-IDX-QHT.
           MOVE WSS-COD-TSN IN WSS-TAB-QHT(WSS-IDX-QHT) TO
                TP-009-02-FRM-COD-TASN(I,J).
           MOVE WSS-IND-GTP IN WSS-TAB-QHT(WSS-IDX-QHT) TO
                TP-009-02-FRM-IND-GTP(I,J).

           MOVE WSS-VAL-CML-TSN IN WSS-TAB-QHT(WSS-IDX-QHT) TO
                TP-009-02-FRM-SGV-VCTS(I,J).
           MOVE WSS-VAL-PON IN WSS-TAB-QHT(WSS-IDX-QHT) TO
                TP-009-02-FRM-SGV-VPND(I,J).

           MOVE WSS-FEC-TSN IN WSS-TAB-QHT(WSS-IDX-QHT) TO
                TP-009-02-FRM-FEC-FTSN(I,J).
           MOVE WSS-GLS-IIV-TSD IN WSS-TAB-QHT(WSS-IDX-QHT) TO
                TP-009-02-FRM-GLS-ITSD(I,J).
       FIN-PRO-REQ-009-J.
           EXIT.

       PRO-REQ-010 SECTION.
       INI-PRO-REQ-010.
      * QHP,CON
      * HAY-MAS INI
           IF PT-010-02-FRM-COD-ITSN > ZEROES
                MOVE QHP-TSQHP-MAS TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE PT-010-01-GVT-CAI-GTIA TO QHP-MAS-GVT-CAI-GTIA
                MOVE PT-010-01-GVT-IIC-GTIA TO QHP-MAS-GVT-IIC-GTIA
                MOVE PT-010-01-GVT-COD-TASN TO QHP-MAS-GVT-COD-TASN
                MOVE PT-010-02-FRM-COD-ITSN TO QHP-MAS-GTP-COD-ITSN  
                MOVE QHP-MAS-ITEM TO QUE-ITEM
                MOVE QHP-LEN-TSQHP-MAS TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN

           PERFORM EDT-NUM-PT-REQ-010.

           PERFORM MOV-GNS-010-01.
           PERFORM MOV-PT-TX-010-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      * HAY-MAS INI
           MOVE QHP-TSQHP-MAS TO QUE-COLA.
           MOVE QHP-LEN-TSQHP-MAS TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO QHP-MAS-ITEM
               MOVE QHP-MAS-IND-HMAS TO TP-010-02-DAS-IND-HMAS
               MOVE QHP-MAS-NUM-TOCC TO TP-010-02-DAS-NUM-TGXD
               MOVE QUE-DEL TO QUE-CMND
               PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN


           PERFORM MOV-XT-TP-010-01.
           MOVE WSS-NOM-TSQHP  TO QUE-COLA.
      *DDD DISPLAY 'GARPPTPG REQ 010 LEE COLA ' QUE-COLA.
           MOVE WSS-LEN-TSQHP  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           MOVE 1 TO QUE-NITM.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
      *DDD    DISPLAY 'GARPPTPG REQ 010 QUE OK' QUE-ITEM
              MOVE QUE-ITEM TO WSS-TAB-QHP
              MOVE ZEROES TO WSS-IDX-QHP
              PERFORM PRO-REQ-010-I VARYING I FROM 1 BY 1 UNTIL (I > 5)

              MOVE WSS-NOM-TSQHP  TO QUE-COLA
              MOVE QUE-DEL        TO QUE-CMND
              PERFORM GNS-PRO-QUE

           ELSE
      *DDD    DISPLAY 'GARPPTPG REQ 010 QUE NO OK'
              MOVE SPACES TO WSS-TAB-QHP.
           PERFORM VAL-NUM-TP-REQ-010.

       FIN-PRO-REQ-010.
           EXIT.

       PRO-REQ-010-I SECTION.
       INI-PRO-REQ-010-I.
           PERFORM PRO-REQ-010-J VARYING J FROM 1 BY 1 UNTIL (J > 9).
       FIN-PRO-REQ-010-I.
           EXIT.

       PRO-REQ-010-J SECTION.
       INI-PRO-REQ-010-J.
           ADD 1 TO WSS-IDX-QHP.
      * >>>>>>>>>>>>>>>>>>>>>>>>><
           MOVE WSS-COD-ITM-TSN IN WSS-TAB-QHP(WSS-IDX-QHP) TO
                TP-010-03-FRM-COD-ITSN(I,J).
      * >>>>>>>>>>>>>>>>>>>>>>>>><
           MOVE WSS-IDN-ITM-TSN IN WSS-TAB-QHP(WSS-IDX-QHP) TO
                TP-010-03-FRM-COD-IITS(I,J).
      * >>>>>>>>>>>>>>>>>>>>>>>>><
           MOVE WSS-CTD-ITM-TSN IN WSS-TAB-QHP(WSS-IDX-QHP) TO
                TP-010-03-FRM-SGV-ITSN(I,J).
      * >>>>>>>>>>>>>>>>>>>>>>>>><
           MOVE WSS-VAL-UNT-ITM IN WSS-TAB-QHP(WSS-IDX-QHP) TO
                TP-010-03-FRM-SGV-VTSN(I,J).
      * >>>>>>>>>>>>>>>>>>>>>>>>><
           MOVE WSS-FEC-CMB-EST IN WSS-TAB-QHP(WSS-IDX-QHP) TO
                TP-010-03-FRM-FEC-FCES(I,J).
      * >>>>>>>>>>>>>>>>>>>>>>>>><
           MOVE WSS-GLS-EST-ITM IN WSS-TAB-QHP(WSS-IDX-QHP) TO
                TP-010-03-FRM-GLS-EITS(I,J).
       FIN-PRO-REQ-010-J.
           EXIT.

       PRO-REQ-111 SECTION.
       INI-PRO-REQ-111.
      * GIN-GUB,ING,GKY
           PERFORM EDT-NUM-PT-REQ-111.

           PERFORM MOV-GNS-111-01.
           PERFORM MOV-PT-TX-111-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-111-01.
           PERFORM VAL-NUM-TP-REQ-111.

       FIN-PRO-REQ-111.
           EXIT.

       PRO-REQ-011 SECTION.
       INI-PRO-REQ-011.
      * GIN-GUB,ING,GFL
           PERFORM EDT-NUM-PT-REQ-011.

           PERFORM MOV-GNS-011-01.
           PERFORM MOV-PT-TX-011-01.
           PERFORM MOV-GNS-011-02.
           PERFORM MOV-PT-TX-011-02.

           IF PT-011-04-GUB-GLS-CLLE > SPACES
               PERFORM MOV-GNS-011-03
               PERFORM MOV-PT-TX-011-03
               MOVE PT-011-01-GIN-CAI-GTIA TO TX-011-03-GUB-CAI-GTIA
               MOVE PT-011-01-GIN-IIC-GTIA TO TX-011-03-GUB-IIC-GTIA
               PERFORM MOV-GNS-011-04
               PERFORM MOV-PT-TX-011-04.

           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-011-01.
           PERFORM VAL-NUM-TP-REQ-011.

       FIN-PRO-REQ-011.
           EXIT.

       PRO-REQ-012 SECTION.
       INI-PRO-REQ-012.
      * GIN-GUB,CON
           PERFORM EDT-NUM-PT-REQ-012.

           PERFORM MOV-GNS-012-01.
           PERFORM MOV-PT-TX-012-01.
      *     PERFORM MOV-GNS-012-02.
      *     MOVE PT-012-01-GIN-CAI-GTIA TO TX-012-02-GUB-CAI-GTIA.
      *     MOVE PT-012-01-GIN-IIC-GTIA TO TX-012-02-GUB-IIC-GTIA.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-012-01.
      *     PERFORM MOV-XT-TP-012-02.
           PERFORM VAL-NUM-TP-REQ-012.

       FIN-PRO-REQ-012.
           EXIT.

       PRO-REQ-013 SECTION.
       INI-PRO-REQ-013.
      * GIN-GUB,MOD
           PERFORM EDT-NUM-PT-REQ-013.

           PERFORM MOV-GNS-013-01.
           PERFORM MOV-PT-TX-013-01.
           PERFORM MOV-GNS-013-02.
           PERFORM MOV-PT-TX-013-02.

           IF PT-013-04-GUB-GLS-CLLE > SPACES
               PERFORM MOV-GNS-013-03
               PERFORM MOV-PT-TX-013-03
               MOVE PT-013-01-GIN-CAI-GTIA TO TX-013-03-GUB-CAI-GTIA
               MOVE PT-013-01-GIN-IIC-GTIA TO TX-013-03-GUB-IIC-GTIA
               PERFORM MOV-GNS-013-04
               PERFORM MOV-PT-TX-013-04.

           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-013.

       FIN-PRO-REQ-013.
           EXIT.

       PRO-REQ-413 SECTION.
       INI-PRO-REQ-413.
      * GUB,MOD
           PERFORM EDT-NUM-PT-REQ-413.
           PERFORM MOV-GNS-413-01.
           PERFORM MOV-PT-TX-413-01.
           PERFORM MOV-GNS-413-02.
           PERFORM MOV-PT-TX-413-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-413.

       FIN-PRO-REQ-413.
           EXIT.

       PRO-REQ-014 SECTION.
       INI-PRO-REQ-014.
      * GIN-GUB,ELI
           PERFORM EDT-NUM-PT-REQ-014.

           PERFORM MOV-GNS-014-01.
           PERFORM MOV-PT-TX-014-01.
           PERFORM MOV-GNS-014-02.
           PERFORM MOV-PT-TX-014-02.
           PERFORM MOV-GNS-014-03.
           MOVE PT-014-01-GIN-CAI-GTIA TO TX-014-03-GUB-CAI-GTIA.
           MOVE PT-014-01-GIN-IIC-GTIA TO TX-014-03-GUB-IIC-GTIA.
           PERFORM MOV-GNS-014-04.
           PERFORM MOV-PT-TX-014-04.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-014.

       FIN-PRO-REQ-014.
           EXIT.


       PRO-REQ-414 SECTION.
       INI-PRO-REQ-414.
      * GUB,ELI

           PERFORM EDT-NUM-PT-REQ-414.

           PERFORM MOV-GNS-414-01.
           PERFORM MOV-PT-TX-414-01.
           PERFORM MOV-GNS-414-02.
           PERFORM MOV-PT-TX-414-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.

           PERFORM VAL-NUM-TP-REQ-414.

       FIN-PRO-REQ-414.
           EXIT.

       PRO-REQ-514 SECTION.
       INI-PRO-REQ-514.
      * GIN,ELI

           PERFORM EDT-NUM-PT-REQ-514.

           PERFORM MOV-GNS-514-01.
           PERFORM MOV-PT-TX-514-01.
           PERFORM MOV-GNS-514-02.
           PERFORM MOV-PT-TX-514-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.

           PERFORM VAL-NUM-TP-REQ-514.

       FIN-PRO-REQ-514.
           EXIT.

       PRO-REQ-115 SECTION.
       INI-PRO-REQ-115.
      * GSI,ING,GKY
           PERFORM EDT-NUM-PT-REQ-115.

           PERFORM MOV-GNS-115-01.
           PERFORM MOV-PT-TX-115-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-115-01.
           PERFORM VAL-NUM-TP-REQ-115.

       FIN-PRO-REQ-115.
           EXIT.

       PRO-REQ-015 SECTION.
       INI-PRO-REQ-015.
      * GSI,ING,GKY
           PERFORM EDT-NUM-PT-REQ-015.

           PERFORM MOV-GNS-015-01.
           PERFORM MOV-PT-TX-015-01.
           PERFORM MOV-GNS-015-02.
           PERFORM MOV-PT-TX-015-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-015-01.
           PERFORM VAL-NUM-TP-REQ-015.

       FIN-PRO-REQ-015.
           EXIT.

       PRO-REQ-016 SECTION.
       INI-PRO-REQ-016.
      * GSI,CON
           PERFORM EDT-NUM-PT-REQ-016.

           PERFORM MOV-GNS-016-01.
           PERFORM MOV-PT-TX-016-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-016-01.
           PERFORM VAL-NUM-TP-REQ-016.

       FIN-PRO-REQ-016.
           EXIT.

       PRO-REQ-017 SECTION.
       INI-PRO-REQ-017.
      * GSI,MOD
           PERFORM EDT-NUM-PT-REQ-017.

           PERFORM MOV-GNS-017-01.
           PERFORM MOV-PT-TX-017-01.
           PERFORM MOV-GNS-017-02.
           PERFORM MOV-PT-TX-017-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-017.

       FIN-PRO-REQ-017.
           EXIT.

       PRO-REQ-018 SECTION.
       INI-PRO-REQ-018.
      * GSI,ELI
           PERFORM EDT-NUM-PT-REQ-018.

           PERFORM MOV-GNS-018-01.
           PERFORM MOV-PT-TX-018-01.
           PERFORM MOV-GNS-018-02.
           PERFORM MOV-PT-TX-018-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-018.

       FIN-PRO-REQ-018.
           EXIT.

       PRO-REQ-119 SECTION.
       INI-PRO-REQ-119.
      * GDO,ING,GKY
           PERFORM EDT-NUM-PT-REQ-119.

           PERFORM MOV-GNS-119-01.
           PERFORM MOV-PT-TX-119-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-119-01.
           PERFORM VAL-NUM-TP-REQ-119.

       FIN-PRO-REQ-019.
           EXIT.

       PRO-REQ-019 SECTION.
       INI-PRO-REQ-019.
      * GDO,ING,GFL
           PERFORM EDT-NUM-PT-REQ-019.

           PERFORM MOV-GNS-019-01.
           PERFORM MOV-PT-TX-019-01.
           PERFORM MOV-GNS-019-02.
           PERFORM MOV-PT-TX-019-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-019-01.
           PERFORM VAL-NUM-TP-REQ-019.

       FIN-PRO-REQ-019.
           EXIT.

       PRO-REQ-020 SECTION.
       INI-PRO-REQ-020.
      * GDO,CON
           PERFORM EDT-NUM-PT-REQ-020.

           PERFORM MOV-GNS-020-01.
           PERFORM MOV-PT-TX-020-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-020-01.
           PERFORM VAL-NUM-TP-REQ-020.

       FIN-PRO-REQ-020.
           EXIT.

       PRO-REQ-021 SECTION.
       INI-PRO-REQ-021.
      * GDO,MOD
           PERFORM EDT-NUM-PT-REQ-021.

           PERFORM MOV-GNS-021-01.
           PERFORM MOV-PT-TX-021-01.
           PERFORM MOV-GNS-021-02
           PERFORM MOV-PT-TX-021-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-021.

       FIN-PRO-REQ-021.
           EXIT.

       PRO-REQ-022 SECTION.
       INI-PRO-REQ-022.
      * GDO,ELI
           PERFORM EDT-NUM-PT-REQ-022.

           PERFORM MOV-GNS-022-01.
           PERFORM MOV-PT-TX-022-01.
           PERFORM MOV-GNS-022-02.
           PERFORM MOV-PT-TX-022-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-022.

       FIN-PRO-REQ-022.
           EXIT.

       PRO-REQ-123 SECTION.
       INI-PRO-REQ-123.
      * GLE,ING,GKY
           PERFORM EDT-NUM-PT-REQ-123.

           PERFORM MOV-GNS-123-01.
           PERFORM MOV-PT-TX-123-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-123-01.
           PERFORM VAL-NUM-TP-REQ-123.

       FIN-PRO-REQ-123.
           EXIT.

       PRO-REQ-023 SECTION.
       INI-PRO-REQ-023.
      * GLE,ING,GFL
           PERFORM EDT-NUM-PT-REQ-023.

           PERFORM MOV-GNS-023-01.
           PERFORM MOV-PT-TX-023-01.
           PERFORM MOV-GNS-023-02.
           PERFORM MOV-PT-TX-023-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-023-01.
           PERFORM VAL-NUM-TP-REQ-023.

       FIN-PRO-REQ-023.
           EXIT.

       PRO-REQ-024 SECTION.
       INI-PRO-REQ-024.
      * GLE,CON
           PERFORM EDT-NUM-PT-REQ-024.
           PERFORM MOV-GNS-024-01.
           PERFORM MOV-PT-TX-024-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-024-01.
           PERFORM VAL-NUM-TP-REQ-024.
       FIN-PRO-REQ-024.
           EXIT.

       PRO-REQ-025 SECTION.
       INI-PRO-REQ-025.
      * GLE,MOD
           PERFORM EDT-NUM-PT-REQ-025.
           PERFORM MOV-GNS-025-01.
           PERFORM MOV-PT-TX-025-01.
           PERFORM MOV-GNS-025-02.
           PERFORM MOV-PT-TX-025-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-025.
       FIN-PRO-REQ-025.
           EXIT.

       PRO-REQ-026 SECTION.
       INI-PRO-REQ-026.
      * GLE,ELI
           PERFORM EDT-NUM-PT-REQ-026.
      *DDD DISPLAY 'GARPPTPG EN PRO-REQ-026'.
           PERFORM MOV-GNS-026-01.
           PERFORM MOV-PT-TX-026-01.
           PERFORM MOV-GNS-026-02.
           PERFORM MOV-PT-TX-026-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-026.
       FIN-PRO-REQ-026.
           EXIT.

       PRO-REQ-127 SECTION.
       INI-PRO-REQ-127.
      * GSE,ING,GKY
           PERFORM EDT-NUM-PT-REQ-127.
           PERFORM MOV-GNS-127-01.
           PERFORM MOV-PT-TX-127-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-127-01.
           PERFORM VAL-NUM-TP-REQ-127.
       FIN-PRO-REQ-127.
           EXIT.

       PRO-REQ-027 SECTION.
       INI-PRO-REQ-027.
      * GSE,ING,GFL
           PERFORM EDT-NUM-PT-REQ-027.
           PERFORM MOV-GNS-027-01.
           PERFORM MOV-PT-TX-027-01.
           PERFORM MOV-GNS-027-02.
           PERFORM MOV-PT-TX-027-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-027.
       FIN-PRO-REQ-027.
           EXIT.

       PRO-REQ-028 SECTION.
       INI-PRO-REQ-028.
      * GSE,CON
           PERFORM EDT-NUM-PT-REQ-028.
           PERFORM MOV-GNS-028-01.
           PERFORM MOV-PT-TX-028-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-028-01.
           PERFORM VAL-NUM-TP-REQ-028.
       FIN-PRO-REQ-028.
           EXIT.

       PRO-REQ-029 SECTION.
       INI-PRO-REQ-029.
      * GSE,MOD
           PERFORM EDT-NUM-PT-REQ-029.
           PERFORM MOV-GNS-029-01.
           PERFORM MOV-PT-TX-029-01.
           PERFORM MOV-GNS-029-02.
           PERFORM MOV-PT-TX-029-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-029.
       FIN-PRO-REQ-029.
           EXIT.

       PRO-REQ-030 SECTION.
       INI-PRO-REQ-030.
      * GSE,ELI
           PERFORM EDT-NUM-PT-REQ-030.
           PERFORM MOV-GNS-030-01.
           PERFORM MOV-PT-TX-030-01.
           PERFORM MOV-GNS-030-02.
           PERFORM MOV-PT-TX-030-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-030.
       FIN-PRO-REQ-030.
           EXIT.

       PRO-REQ-031 SECTION.
       INI-PRO-REQ-031.
      * HP2,CON
           PERFORM EDT-NUM-PT-REQ-031.
           PERFORM MOV-GNS-031-01.
           PERFORM MOV-PT-TX-031-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-031-01.
           PERFORM VAL-NUM-TP-REQ-031.
       FIN-PRO-REQ-031.
           EXIT.

       PRO-REQ-132 SECTION.
       INI-PRO-REQ-132.
      * GVT-GTP,ING,GKY
           PERFORM EDT-NUM-PT-REQ-132.
           PERFORM MOV-GNS-132-01.
           PERFORM MOV-PT-TX-132-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-132-01.
           PERFORM VAL-NUM-TP-REQ-132.
       FIN-PRO-REQ-132.
           EXIT.

       PRO-REQ-232 SECTION.
       INI-PRO-REQ-232.
      * GVT-ING,GFL-CNF
           PERFORM EDT-NUM-PT-REQ-232.
           PERFORM MOV-GNS-232-01.
           PERFORM MOV-PT-TX-232-01.
           PERFORM MOV-GNS-232-02.
           PERFORM MOV-PT-TX-232-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-232-01.
           PERFORM VAL-NUM-TP-REQ-232.
       FIN-PRO-REQ-232.
           EXIT.

       PRO-REQ-032 SECTION.
       INI-PRO-REQ-032.
      * GVT-GTP,ING,GFL
           PERFORM EDT-NUM-PT-REQ-032.
           PERFORM MOV-GNS-032-01.
           PERFORM MOV-PT-TX-032-01.
           PERFORM MOV-GNS-032-02.
           PERFORM MOV-PT-TX-032-02.

      *     IF PT-032-02-FRM-IND-GTP = 'N'
      *        GO TO CON-PRO-REQ-032.

      *     PERFORM PRO-REQ-032-IDX VARYING TPG-I FROM 1 BY 1
      *     UNTIL PT-032-04-GTP-FEC-FCES(TPG-I) NOT > SPACES.

       CON-PRO-REQ-032.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-032-01.
           PERFORM VAL-NUM-TP-REQ-032.
       FIN-PRO-REQ-032.
           EXIT.

       PRO-REQ-032-IDX SECTION.
       INI-PRO-REQ-032-IDX.

      *     PERFORM MOV-GNS-032-03.

      *     MOVE PT-032-01-GVT-CAI-GTIA TO
      *          TX-032-03-GTP-CAI-GTIA(TPG-I).
      *     MOVE PT-032-01-GVT-IIC-GTIA TO
      *          TX-032-03-GTP-IIC-GTIA(TPG-I).
      *     MOVE PT-032-01-GVT-COD-TASN TO
      *          TX-032-03-GTP-NUM-ITSN(TPG-I).

      *     PERFORM MOV-PT-TX-032-03.

      *     PERFORM MOV-GNS-032-04.

      *     PERFORM MOV-PT-TX-032-04.

       FIN-PRO-REQ-032-IDX.
           EXIT.

       PRO-REQ-332 SECTION.
       INI-PRO-REQ-332.
      * GTP,ING INDIVIDUAL
           PERFORM EDT-NUM-PT-REQ-332.

           PERFORM MOV-GNS-332-01.

           PERFORM MOV-PT-TX-332-01.

           PERFORM MOV-GNS-332-02.

           PERFORM MOV-PT-TX-332-02.


       CON-PRO-REQ-332.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-332-01.
           PERFORM VAL-NUM-TP-REQ-332.
       FIN-PRO-REQ-332.
           EXIT.

       PRO-REQ-332-IDX SECTION.
       INI-PRO-REQ-332-IDX.


       FIN-PRO-REQ-332-IDX.
           EXIT.

       PRO-REQ-033 SECTION.
       INI-PRO-REQ-033.
      * GVT-GTP,CON
           PERFORM EDT-NUM-PT-REQ-033.
           PERFORM MOV-GNS-033-01.
           PERFORM MOV-PT-TX-033-01.
      *     PERFORM MOV-GNS-033-02.
      *     MOVE PT-033-01-GVT-CAI-GTIA TO TX-033-02-GVT-CAI-GTIA
      *     MOVE PT-033-01-GVT-IIC-GTIA TO TX-033-02-GVT-IIC-GTIA
      *     MOVE PT-033-01-GVT-COD-TASN TO TX-033-02-GVT-COD-TASN

           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-033-01.
      *     PERFORM MOV-XT-TP-033-02.
           MOVE WSX-NOM-TSGTP  TO QUE-COLA.
           MOVE WSX-LEN-TSGTP  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           MOVE 1 TO QUE-NITM.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
      *DDD    DISPLAY 'GARPPTPG REQ 033 QUE OK ' QUE-ITEM
              MOVE QUE-ITEM TO WSX-TAB-GTP
              MOVE ZEROES TO WSX-IDX-GTP
              PERFORM PRO-REQ-033-I VARYING I FROM 1 BY 1 UNTIL (I > 20)

              MOVE WSX-NOM-TSGTP  TO QUE-COLA
              MOVE QUE-DEL        TO QUE-CMND
              PERFORM GNS-PRO-QUE


           ELSE
      *DDD    DISPLAY 'GARPPTPG REQ 033 QUE NO OK '
              MOVE SPACES TO WSX-TAB-GTP.
           PERFORM VAL-NUM-TP-REQ-033.
       FIN-PRO-REQ-033.
           EXIT.

       PRO-REQ-033-I SECTION.
       INI-PRO-REQ-033-I.
           ADD 1 TO WSX-IDX-GTP.

           MOVE         WSX-COD-ITSN IN WSX-TAB-GTP(WSX-IDX-GTP)
           TO TP-033-02-GTP-COD-ITSN(I).

           MOVE         WSX-FEC-FCES IN WSX-TAB-GTP(WSX-IDX-GTP)
           TO TP-033-02-GTP-FEC-FCES(I).

           MOVE WSX-COD-IITS IN WSX-TAB-GTP(WSX-IDX-GTP)
           TO TP-033-02-GTP-COD-IITS(I).

           MOVE WSX-SGV-ITSN IN WSX-TAB-GTP(WSX-IDX-GTP)
           TO TP-033-02-GTP-SGV-ITSN(I).

           MOVE WSX-SGV-VTSN IN WSX-TAB-GTP(WSX-IDX-GTP)
           TO TP-033-02-GTP-SGV-VTSN(I).

           MOVE WSX-COD-EITS IN WSX-TAB-GTP(WSX-IDX-GTP)
           TO TP-033-02-GTP-COD-EITS(I).
       FIN-PRO-REQ-033-I.
           EXIT.

       PRO-REQ-034 SECTION.
       INI-PRO-REQ-034.
      * GVT-GTP,MOD
           PERFORM EDT-NUM-PT-REQ-034.
           PERFORM MOV-GNS-034-01.
           PERFORM MOV-PT-TX-034-01.
           PERFORM MOV-GNS-034-02.
           PERFORM MOV-PT-TX-034-02

           PERFORM PRO-REQ-034-IDX VARYING TPG-I FROM 1 BY 1
           UNTIL PT-034-04-GTP-FEC-FCES(TPG-I) NOT > SPACES.

           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-034.
       FIN-PRO-REQ-034.
           EXIT.

       PRO-REQ-034-IDX SECTION.
       INI-PRO-REQ-034-IDX.

           PERFORM MOV-GNS-034-03.

           MOVE PT-034-01-GVT-CAI-GTIA TO TX-034-03-GTP-CAI-GTIA(TPG-I).
           MOVE PT-034-01-GVT-IIC-GTIA TO TX-034-03-GTP-IIC-GTIA(TPG-I).
           MOVE PT-034-01-GVT-COD-TASN TO TX-034-03-GTP-NUM-ITSN(TPG-I).

           PERFORM MOV-PT-TX-034-03.

           PERFORM MOV-GNS-034-04.

           PERFORM MOV-PT-TX-034-04.

       FIN-PRO-REQ-034-IDX.
           EXIT.


       PRO-REQ-035 SECTION.
       INI-PRO-REQ-035.
      * GTP,ELI
           PERFORM EDT-NUM-PT-REQ-035.
           PERFORM MOV-GNS-035-01.
           PERFORM MOV-PT-TX-035-01.
           PERFORM MOV-GNS-035-02.
           PERFORM MOV-PT-TX-035-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-035.
       FIN-PRO-REQ-035.
           EXIT.

       PRO-REQ-036 SECTION.
       INI-PRO-REQ-036.
      * GVT-GTP,ATA
           PERFORM EDT-NUM-PT-REQ-036.
           PERFORM MOV-GNS-036-01.
           PERFORM MOV-PT-TX-036-01.
           PERFORM MOV-GNS-036-02.
           PERFORM MOV-PT-TX-036-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-036.
       FIN-PRO-REQ-036.
           EXIT.

       PRO-REQ-037 SECTION.
       INI-PRO-REQ-037.
      * GVT-GTP,RTA
           PERFORM EDT-NUM-PT-REQ-037.
           PERFORM MOV-GNS-037-01.
           PERFORM MOV-PT-TX-037-01.
           PERFORM MOV-GNS-037-02.
           PERFORM MOV-PT-TX-037-02.

       CON-PRO-REQ-037.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-037.
       FIN-PRO-REQ-037.
           EXIT.

      * PRO-REQ-038 SECTION.
      * INI-PRO-REQ-038.
      *     PERFORM PRO-REQ-038-IDX VARYING TPG-I FROM 1 BY 1
      *     UNTIL PT-038-02-GTP-FEC-FCES(TPG-I) NOT > SPACES.

      *     PERFORM PUT-TDI.
      *     PERFORM LNK-MTD.
      *     PERFORM GET-TDO.
      * FIN-PRO-REQ-038.
      *     EXIT.

      *PRO-REQ-038-IDX SECTION.
      *INI-PRO-REQ-038-IDX.
      *    PERFORM MOV-GNS-038-01.
      *
      *    PERFORM MOV-PT-TX-038-01.
      *
      *    PERFORM MOV-GNS-038-02.
      *
      *    PERFORM MOV-PT-TX-038-02.
      *
      *    IF TPG-I > 1
      *         MOVE 'GARGTPINGGKY' TO TX-038-01-NEMO-GKY(TPG-I)
      *         MOVE 'GARGTPINGGFL' TO TX-038-02-NEMO-GFL(TPG-I).
      *
      *FIN-PRO-REQ-038-IDX.
      *    EXIT.

       PRO-REQ-039 SECTION.
       INI-PRO-REQ-039.
      * GVT-GTP,MTA
           PERFORM EDT-NUM-PT-REQ-039.
           PERFORM MOV-GNS-039-01.
           PERFORM MOV-PT-TX-039-01.
           PERFORM MOV-GNS-039-02.
           PERFORM MOV-PT-TX-039-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-039.
       FIN-PRO-REQ-039.
           EXIT.

       PRO-REQ-140 SECTION.
       INI-PRO-REQ-140.
      * GES,ING,GKY
           PERFORM EDT-NUM-PT-REQ-140.
           PERFORM MOV-GNS-140-01.
           PERFORM MOV-PT-TX-140-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-140-01.
           PERFORM VAL-NUM-TP-REQ-140.
       FIN-PRO-REQ-140.
           EXIT.

       PRO-REQ-040 SECTION.
       INI-PRO-REQ-040.
      * GES,ING,GFL
           PERFORM EDT-NUM-PT-REQ-040.
           PERFORM MOV-GNS-040-01.
           PERFORM MOV-PT-TX-040-01.
           PERFORM MOV-GNS-040-02.
           PERFORM MOV-PT-TX-040-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-040-01.
           PERFORM VAL-NUM-TP-REQ-040.
       FIN-PRO-REQ-040.
           EXIT.

       PRO-REQ-041 SECTION.
       INI-PRO-REQ-041.
      * GES,CON
           PERFORM EDT-NUM-PT-REQ-041.
           PERFORM MOV-GNS-041-01.
           PERFORM MOV-PT-TX-041-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-041-01.
           PERFORM VAL-NUM-TP-REQ-041.
       FIN-PRO-REQ-041.
           EXIT.

       PRO-REQ-042 SECTION.
       INI-PRO-REQ-042.
      * GES,MOD
           PERFORM EDT-NUM-PT-REQ-042.
           PERFORM MOV-GNS-042-01.
           PERFORM MOV-PT-TX-042-01.
           PERFORM MOV-GNS-042-02.
           PERFORM MOV-PT-TX-042-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-042.
       FIN-PRO-REQ-042.
           EXIT.

       PRO-REQ-043 SECTION.
       INI-PRO-REQ-043.
      * GES,ELI
           PERFORM EDT-NUM-PT-REQ-043.
           PERFORM MOV-GNS-043-01.
           PERFORM MOV-PT-TX-043-01.
           PERFORM MOV-GNS-043-02.
           PERFORM MOV-PT-TX-043-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-043.
       FIN-PRO-REQ-043.
           EXIT.

       PRO-REQ-044 SECTION.
       INI-PRO-REQ-044.
      * CGD,CON
      *DDD DISPLAY 'Version 31-10-2003 V1 Patch por aqui pase'.
      *DDD DISPLAY 'REQ-044'.

           MOVE 8 TO SEG-MAX-ELEM.

           MOVE WSX-NOM-TSCGD  TO QUE-COLA.
      *DDD DISPLAY 'REQ-044-1 NOMBRE COLA ' QUE-COLA.
           MOVE QUE-DEL        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *DDD DISPLAY 'STATUS ELIMINACION COLA ' QUE-STAT.

      * ESTO ES SOLO PARA PROBAR
      *     MOVE '0500' TO PT-044-02-FRM-CAI-GTIA.
      *     MOVE '00000148'    TO PT-044-02-FRM-IIC-GTIA.
           IF PT-044-02-FRM-CAI-GTIA > SPACES
               MOVE PT-044-02-FRM-CAI-GTIA TO WSX-INP-CAI-GTIA
               MOVE PT-044-02-FRM-IIC-GTIA TO WSX-INP-IIC-GTIA
               MOVE WSX-INP-KEY-GTIA TO QUE-ITEM

               MOVE WSX-LEN-TSCGD  TO QUE-LITM
               MOVE QUE-PUT        TO QUE-CMND
      *DDD     DISPLAY 'GARPPTPG GRABO TS HAY MAS ' WSX-INP-KEY-GTIA
               PERFORM GNS-PRO-QUE.

           PERFORM EDT-NUM-PT-REQ-044.
           PERFORM MOV-GNS-044-01.
           PERFORM MOV-PT-TX-044-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      *DDD DISPLAY 'REQ-044 TDO ' TDO-GLS-DESC.
           PERFORM MOV-XT-TP-044-01.
      *DDD DISPLAY 'REQ-044 FUE AL MTX ' TP-044.

           MOVE WSX-NOM-TSCGD  TO QUE-COLA.
      *DDD DISPLAY 'REQ-044 NOMBRE COLA ' QUE-COLA.

           MOVE SPACES TO WSX-TAB-CGD.
           MOVE WSX-LEN-TSCGD  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           MOVE 1 TO QUE-NITM.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
              MOVE SPACES TO WSX-TAB-CGD
           ELSE
      *DDD    DISPLAY 'PRO-REQ-044 CGD 1 QUE OK ' QUE-ITEM
              MOVE QUE-ITEM TO WSX-CGD-QUE-1
              ADD 1 TO QUE-NITM
              PERFORM GNS-PRO-QUE
              IF QUE-STAT NOT = QUE-STAT-OKS
                   NEXT SENTENCE
      *DDD         DISPLAY
      *DDD           'PRO-REQ-044 QUE CGD 2 NO OK STAT ' QUE-STAT
              ELSE
      *DDD         DISPLAY 'PRO-REQ-044 CGD 2 QUE OK ' QUE-ITEM
                   MOVE QUE-ITEM TO WSX-CGD-QUE-2
                   ADD 1 TO QUE-NITM
                   PERFORM GNS-PRO-QUE
                   IF QUE-STAT NOT = QUE-STAT-OKS
                       NEXT SENTENCE
      *DDD             DISPLAY
      *DDD            'PRO-REQ-044 QUE CGD 3 NO OK STAT ' QUE-STAT
                   ELSE
      *DDD             DISPLAY 'PRO-REQ-044 CGD 3 QUE OK ' QUE-ITEM
                       MOVE QUE-ITEM TO WSX-CGD-QUE-3.

           IF NOT ( QUE-STAT NOT = QUE-STAT-OKS AND
                      QUE-NITM = 1 )
               MOVE WSX-IND-HMAS TO TP-044-02-DAS-IND-HMAS
               MOVE WSX-NUM-TCGD TO TP-044-02-DAS-NUM-TGXD
               MOVE ZEROES TO WSX-IDX-CGD
               PERFORM PRO-REQ-044-I VARYING I FROM 1 BY 1
                          UNTIL (I > 12).

           MOVE WSX-NOM-TSCGD  TO QUE-COLA.
           MOVE QUE-DEL        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           PERFORM VAL-NUM-TP-REQ-044.
       FIN-PRO-REQ-044.
           EXIT.

       PRO-REQ-044-I SECTION.
       INI-PRO-REQ-044-I.
           PERFORM PRO-REQ-044-J VARYING J FROM 1 BY 1 UNTIL (J > 4).
       FIN-PRO-REQ-044-I.
           EXIT.

       PRO-REQ-044-J SECTION.
       INI-PRO-REQ-044-J.
           ADD 1 TO WSX-IDX-CGD.

           MOVE     WSX-KEY-IGDG IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-KEY-IGDG(I,J).

           MOVE      WSX-GDG-GLS-CGTA IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-GDG-GLS-CGTA(I,J).

      *     FALTA TRADDUCCION
      *     MOVE      WSX-ABV-STP-OPE IN WSX-TAB-CGD(WSX-IDX-CGD) TO
      *     TP-044-03-FRM-ABV-STP-OPE(I,J).

           MOVE      WSX-TAG-IND-TREA IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-TAG-IND-TREA(I,J).

           MOVE      WSX-GDG-COD-LGTA IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-GDG-COD-LGTA(I,J).

           MOVE      WSX-GDG-COD-GGTA IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-GDG-COD-GGTA(I,J).

           MOVE      WSX-GVT-SGV-VCTS IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-GVT-SGV-VCTS(I,J).

           MOVE      WSX-GVT-SGV-LTSN IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-GVT-SGV-LTSN(I,J).

           MOVE      WSX-GVT-SGV-VPND IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-GVT-SGV-VPND(I,J).

           MOVE      WSX-IND-MUL-DEU IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-IND-MUL-DEU(I,J).

           MOVE      WSX-IND-COMT    IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-IND-COMT(I,J).

           MOVE      WSX-GLS-NORT     IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-GLS-NORT(I,J).

           MOVE      WSX-IND-COMS     IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-IND-COMS(I,J).

           MOVE      WSX-GLS-NORS     IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-GLS-NORS(I,J).


      *    PENDIENTE MHM
           MOVE      WSX-GLS-ESTG     IN WSX-TAB-CGD(WSX-IDX-CGD) TO
           TP-044-03-FRM-GLS-ESTG(I,J).

       FIN-PRO-REQ-044-J.
           EXIT.

       PRO-REQ-145 SECTION.
       INI-PRO-REQ-145.
      * TAG,ING,GKY
           PERFORM EDT-NUM-PT-REQ-145.
           PERFORM MOV-GNS-145-01.
           PERFORM MOV-PT-TX-145-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-145-01.
           PERFORM VAL-NUM-TP-REQ-145.
       FIN-PRO-REQ-145.
           EXIT.

       PRO-REQ-045 SECTION.
       INI-PRO-REQ-045.
      * TAG,ING,GFL
           PERFORM EDT-NUM-PT-REQ-045.
           PERFORM MOV-GNS-045-01.
           PERFORM MOV-PT-TX-045-01.
           PERFORM MOV-GNS-045-02
           PERFORM MOV-PT-TX-045-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-045.
       FIN-PRO-REQ-045.
           EXIT.

       PRO-REQ-046 SECTION.
       INI-PRO-REQ-046.
      * TAG,CON
           PERFORM EDT-NUM-PT-REQ-046.
           PERFORM MOV-GNS-046-01.
           PERFORM MOV-PT-TX-046-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-046-01.
           PERFORM VAL-NUM-TP-REQ-046.
       FIN-PRO-REQ-046.
           EXIT.

       PRO-REQ-047 SECTION.
       INI-PRO-REQ-047.
      * TAG,MOD
           PERFORM EDT-NUM-PT-REQ-047.
           PERFORM MOV-GNS-047-01.
           PERFORM MOV-PT-TX-047-01.
           PERFORM MOV-GNS-047-02.
           PERFORM MOV-PT-TX-047-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-047.
       FIN-PRO-REQ-047.
           EXIT.

       PRO-REQ-048 SECTION.
       INI-PRO-REQ-048.
      * TAG,ELI
           PERFORM EDT-NUM-PT-REQ-048.
           PERFORM MOV-GNS-048-01.
           PERFORM MOV-PT-TX-048-01.
           PERFORM MOV-GNS-048-02.
           PERFORM MOV-PT-TX-048-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-048.
       FIN-PRO-REQ-048.
           EXIT.

      * PRO-REQ-049 SECTION.
      * INI-PRO-REQ-049.
      ** TAG,COP
      *     PERFORM MOV-GNS-049-01.
      *     PERFORM MOV-PT-TX-049-01.
      *     PERFORM MOV-GNS-049-02.
      *     PERFORM MOV-PT-TX-049-02.
      *     PERFORM PUT-TDI.
      *     PERFORM LNK-MTD.
      *     PERFORM GET-TDO.
      * FIN-PRO-REQ-049.
      *     EXIT.

       PRO-REQ-150 SECTION.
       INI-PRO-REQ-150.
      * GDG,ING,GKY
           PERFORM EDT-NUM-PT-REQ-150.
           PERFORM MOV-GNS-150-01.
           PERFORM MOV-PT-TX-150-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-150-01.
           PERFORM VAL-NUM-TP-REQ-150.
       FIN-PRO-REQ-150.
           EXIT.

       PRO-REQ-250 SECTION.
       INI-PRO-REQ-250.
      * GDG,ING ( CONFIRMA )
           PERFORM EDT-NUM-PT-REQ-250.
           PERFORM MOV-GNS-250-01.
           PERFORM MOV-PT-TX-250-01.
           PERFORM MOV-GNS-250-02.
           PERFORM MOV-PT-TX-250-02.

           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-250-01.
           PERFORM VAL-NUM-TP-REQ-250.
       FIN-PRO-REQ-250.
           EXIT.

       PRO-REQ-050 SECTION.
       INI-PRO-REQ-050.
      * GDG,GDD,ING,GFL
           PERFORM EDT-NUM-PT-REQ-050.

           PERFORM MOV-GNS-050-01.
           PERFORM MOV-PT-TX-050-01.
           PERFORM MOV-GNS-050-02.
           PERFORM MOV-PT-TX-050-02.

           PERFORM MOV-GNS-050-05 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 10 OR
               PT-050-05-DBC-NUM-ICLI(TPG-I) NOT > SPACES).

           PERFORM MOV-PT-TX-050-05 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 10 OR
               PT-050-05-DBC-NUM-ICLI(TPG-I) NOT > SPACES).

           PERFORM MOV-GNS-050-06 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 10 OR
               PT-050-05-DBC-NUM-ICLI(TPG-I) NOT > SPACES).

           PERFORM MOV-PT-TX-050-06 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 10 OR
               PT-050-05-DBC-NUM-ICLI(TPG-I) NOT > SPACES).

           IF PT-050-04-GUB-GLS-CLLE > SPACES
               PERFORM MOV-GNS-050-03
               PERFORM MOV-PT-TX-050-03
               PERFORM MOV-GNS-050-04
               PERFORM MOV-PT-TX-050-04
           ELSE
               MOVE TX-050 TO BKP-TX-050
               MOVE SPACES TO TX-050
               MOVE BKP-TX-050-GDG TO NEW-TX-050-GDG
               MOVE BKP-TX-050-GDD TO NEW-TX-050-GDD
               MOVE NEW-TX-050 TO TX-050.

           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM REC-TS-050.
           PERFORM VAL-NUM-TP-REQ-050.
       FIN-PRO-REQ-050.
           EXIT.

       REC-TS-050 SECTION.
       INI-REC-TS-050.
           MOVE WSX-NOM-TSGDG  TO QUE-COLA.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM TO WSX-TAB-GDG
                MOVE WSX-CAI-NGAR TO TP-050-01-GDG-CAI-GTIA
                MOVE WSX-IIC-NGAR TO TP-050-01-GDG-IIC-GTIA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE.
       FIN-REC-TS-050.
           EXIT.

       PRO-REQ-051 SECTION.
       INI-PRO-REQ-051.
      * GDG,GDD,CON
           PERFORM EDT-NUM-PT-REQ-051.

           PERFORM MOV-GNS-051-01.
           PERFORM MOV-PT-TX-051-01.
           PERFORM MOV-GNS-051-02.
           MOVE PT-051-01-GDG-CAI-GTIA TO TX-051-02-GDD-CAI-GTIA.
           MOVE PT-051-01-GDG-IIC-GTIA TO TX-051-02-GDD-IIC-GTIA.
           MOVE PT-051-01-DBC-GLS-NOMC TO TX-051-02-DBC-GLS-NOMC.
           MOVE PT-051-01-DBC-NUM-ICLI TO TX-051-02-DBC-NUM-ICLI.
           MOVE PT-051-01-DBC-VRF-ICLI TO TX-051-02-DBC-VRF-ICLI.
           MOVE PT-051-01-DBC-IND-ICLI TO TX-051-02-DBC-IND-ICLI.
           MOVE PT-051-01-DBC-GLS-ICLI TO TX-051-02-DBC-GLS-ICLI.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-051-01.
      *DDD DISPLAY 'GARPPTPG REQ 051 ' TP-051.
      *     PERFORM MOV-XT-TP-051-02.
           MOVE WSX-NOM-TSGDD  TO QUE-COLA.
      *DDD DISPLAY 'GARPPTPG REQ 051 COLA ' QUE-COLA.
           MOVE WSX-LEN-TSGDD  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           MOVE 1 TO QUE-NITM.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
      *DDD    DISPLAY 'GARPPTPG REQ 051 COLA OK ' QUE-ITEM

              MOVE QUE-ITEM TO WSX-TAB-GDD
              PERFORM PRO-REQ-051-I VARYING I FROM 1 BY 1
                   UNTIL (I > 10) OR
                 WSX-NUM-ICLI IN WSX-TAB-GDD(I) NOT > SPACES.

           PERFORM VAL-NUM-TP-REQ-051.

           MOVE WSX-LEN-TSGDD  TO QUE-LITM.
           MOVE QUE-DEL        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PRO-REQ-051.
           EXIT.

       PRO-REQ-051-I SECTION.
       INI-PRO-REQ-051-I.
           ADD 1 TO WSX-IDX-GDD.
           MOVE WSX-GLS-NOMC IN WSX-TAB-GDD(I) TO
           TP-051-02-DBC-GLS-NOMC(I).
           MOVE WSX-NUM-ICLI IN WSX-TAB-GDD(I) TO
           TP-051-02-DBC-NUM-ICLI(I).
           MOVE WSX-VRF-ICLI IN WSX-TAB-GDD(I) TO
           TP-051-02-DBC-VRF-ICLI(I).
           MOVE WSX-IND-ICLI IN WSX-TAB-GDD(I) TO
           TP-051-02-DBC-IND-ICLI(I).
           MOVE WSX-GLS-ICLI IN WSX-TAB-GDD(I) TO
           TP-051-02-DBC-GLS-ICLI(I).


           MOVE        WSX-COD-EJEC IN WSX-TAB-GDD(I) TO
             TP-051-02-DBC-COD-EJEC(I).

           MOVE        WSX-GLS-EJEC IN WSX-TAB-GDD(I) TO
             TP-051-02-FRM-GLS-EJEC(I).

      * >>>>>>>>>>>>>>>>>>>>>>>>><
           MOVE WSX-VAL-LIM-DDR IN WSX-TAB-GDD(I) TO
           TP-051-02-GDD-SGV-VLIM(I).

      * >>>>>>>>>>>>>>>>>>>>>>>>><
           MOVE WSX-PCT-LIM-DDR IN WSX-TAB-GDD(I) TO
           TP-051-02-GDD-SGV-PLIM(I).

       FIN-PRO-REQ-051-I.
           EXIT.

       PRO-REQ-252 SECTION.
       INI-PRO-REQ-252.
      * GDG,MOD ( CONFIRMA )
           PERFORM EDT-NUM-PT-REQ-252.
           PERFORM MOV-GNS-252-01.
           PERFORM MOV-PT-TX-252-01.
           PERFORM MOV-GNS-252-02.
           PERFORM MOV-PT-TX-252-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-252-01.
           PERFORM VAL-NUM-TP-REQ-252.
       FIN-PRO-REQ-252.
           EXIT.

       PRO-REQ-052 SECTION.
       INI-PRO-REQ-052.
      * GDG,MOD
           PERFORM EDT-NUM-PT-REQ-052.
           PERFORM MOV-GNS-052-01.
           PERFORM MOV-PT-TX-052-01.
           PERFORM MOV-GNS-052-02.
           PERFORM MOV-PT-TX-052-02.
           PERFORM PRO-REQ-052-A VARYING TPG-I FROM 1 BY 1
                                 UNTIL (TPG-I > 10 OR
                 PT-052-03-DBC-NUM-ICLI(TPG-I) NOT > SPACES).

           PERFORM MOV-GNS-052-03 VARYING TPG-I FROM 1 BY 1
                                 UNTIL (TPG-I > 10 OR
                 PT-052-03-DBC-NUM-ICLI(TPG-I) NOT > SPACES).

           PERFORM MOV-PT-TX-052-03 VARYING TPG-I FROM 1 BY 1
                                 UNTIL (TPG-I > 10 OR
                PT-052-03-DBC-NUM-ICLI(TPG-I) NOT > SPACES).

           PERFORM MOV-GNS-052-04 VARYING TPG-I FROM 1 BY 1
                                 UNTIL (TPG-I > 10 OR
                 PT-052-03-DBC-NUM-ICLI(TPG-I) NOT > SPACES).

           PERFORM MOV-PT-TX-052-04 VARYING TPG-I FROM 1 BY 1
                                 UNTIL (TPG-I > 10 OR
                 PT-052-03-DBC-NUM-ICLI(TPG-I) NOT > SPACES).

           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-052.
       FIN-PRO-REQ-052.
           EXIT.

       PRO-REQ-052-A SECTION.
       INI-PRO-REQ-052-A.
           MOVE TX-052-01-GDG-CAI-GTIA TO TX-052-03-GDD-CAI-GTIA(TPG-I).
           MOVE TX-052-01-GDG-IIC-GTIA TO TX-052-03-GDD-IIC-GTIA(TPG-I).
       FIN-PRO-REQ-052-A.
           EXIT.


       PRO-REQ-053 SECTION.
       INI-PRO-REQ-053.
      * GDG,ELI
           PERFORM EDT-NUM-PT-REQ-053.
           PERFORM MOV-GNS-053-01.
           PERFORM MOV-PT-TX-053-01.
           PERFORM MOV-GNS-053-02.
           PERFORM MOV-PT-TX-053-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-053.
       FIN-PRO-REQ-053.
           EXIT.

       PRO-REQ-054 SECTION.
       INI-PRO-REQ-054.
      * GDG,AGA
           PERFORM EDT-NUM-PT-REQ-054.
           PERFORM MOV-GNS-054-01.
           PERFORM MOV-PT-TX-054-01.
           PERFORM MOV-GNS-054-02.
           PERFORM MOV-PT-TX-054-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-054.
       FIN-PRO-REQ-054.
           EXIT.

       PRO-REQ-255 SECTION.
       INI-PRO-REQ-255.
      * GDG,MGA ( CONFIRMA )
           PERFORM EDT-NUM-PT-REQ-255.
           PERFORM MOV-GNS-255-01.
           PERFORM MOV-PT-TX-255-01.
           PERFORM MOV-GNS-255-02.
           PERFORM MOV-PT-TX-255-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-255-01.
           PERFORM VAL-NUM-TP-REQ-255.
       FIN-PRO-REQ-255.
           EXIT.

       PRO-REQ-055 SECTION.
       INI-PRO-REQ-055.
      * GDG,MGA
           PERFORM EDT-NUM-PT-REQ-055.
           PERFORM MOV-GNS-055-01.
           PERFORM MOV-PT-TX-055-01.
           PERFORM MOV-GNS-055-02.
           PERFORM MOV-PT-TX-055-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-055.
       FIN-PRO-REQ-055.
           EXIT.

       PRO-REQ-056 SECTION.
       INI-PRO-REQ-056.
      * GDG,ALZ
           PERFORM EDT-NUM-PT-REQ-056.
           PERFORM MOV-GNS-056-01.
           PERFORM MOV-PT-TX-056-01.
           PERFORM MOV-GNS-056-02.
           PERFORM MOV-PT-TX-056-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-056.
       FIN-PRO-REQ-056.
           EXIT.

       PRO-REQ-057 SECTION.
       INI-PRO-REQ-057.
      * GDG,EJE
           PERFORM EDT-NUM-PT-REQ-057.
           PERFORM MOV-GNS-057-01.
           PERFORM MOV-PT-TX-057-01.
           PERFORM MOV-GNS-057-02.
           PERFORM MOV-PT-TX-057-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-057.
       FIN-PRO-REQ-057.
           EXIT.

       PRO-REQ-058 SECTION.
       INI-PRO-REQ-058.
      * GQA,CON
           PERFORM EDT-NUM-PT-REQ-058.
           PERFORM MOV-GNS-058-01.
           PERFORM MOV-PT-TX-058-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-058-01.
           PERFORM VAL-NUM-TP-REQ-058.
       FIN-PRO-REQ-058.
           EXIT.

       PRO-REQ-PFS-GDD SECTION.
       INI-PRO-REQ-PFS-GDD.
      * GQA,CON GDG Y GDD,CON PF5,PF6
      *
      *           MOVE 'GAR'        TO CMMA-PFG-COD-SIS.
      *           MOVE WSS-RCV-CREQ TO CMMA-PFG-COD-REQ.
      *
      *           MOVE PT-058-01-DBC-NUM-ICLI TO NUM-NUME.
      *           MOVE NUM-ZERO-S TO NUM-ZERO.
      *           MOVE NUM-SGNO-N TO NUM-SGNO.
      *           MOVE 8 TO NUM-NENT.
      *           MOVE 0 TO NUM-NDCM.
      *           PERFORM VAL-NUM.
      *           IF NUM-STAT-OKS
      *               MOVE NUM-PENT-DE8 TO PT-058-01-DBC-NUM-ICLI.
      *
      *           MOVE PT-058-01-GDG-COD-CRR TO NUM-NUME.
      *           MOVE NUM-ZERO-S TO NUM-ZERO.
      *           MOVE NUM-SGNO-N TO NUM-SGNO.
      *           MOVE 8 TO NUM-NENT.
      *           MOVE 0 TO NUM-NDCM.
      *           PERFORM VAL-NUM.
      *           IF NUM-STAT-OKS
      *               MOVE NUM-PENT-DE8 TO PT-058-01-GDG-COD-CRR.
      *
      *           MOVE PT-058-01-GDD-CAI-GTIA  TO WPFG-GAR-058-56-GDG-NU
      *           MOVE PT-058-01-GDG-COD-CRR  TO WPFG-GAR-058-56-GDG-COD
      *           MOVE PT-058-01-DBC-NUM-ICLI TO WPFG-GAR-058-56-DBC-NUM
      *           MOVE PT-058-01-DBC-VRF-ICLI TO WPFG-GAR-058-56-DBC-VRF
      *           MOVE PT-058-01-DBC-IND-ICLI TO WPFG-GAR-058-56-DBC-IND
      *           MOVE PT-058-01-DBC-GLS-ICLI TO WPFG-GAR-058-56-DBC-GLS
      *
      *           MOVE WPFG TO CMMA-PFG-GLS-DATA.
      *
      *           MOVE CMMA-PFG TO SYS-CMMA.
      *           MOVE CMMA-PFG-TCMA TO SYS-TCMA.
      *           MOVE 'GNSPPPFG'             TO SYS-PROG.
      *           MOVE SYS-LINK               TO SYS-CMND.
      *           PERFORM GNS-PRO-SYS.
      *
      *           MOVE SYS-CMMA TO CMMA-PFG.
      *
      *           IF CMMA-PFG-COD-MENS > SPACES
      *              MOVE SPACES TO WSS-SND
      *              MOVE '1' TO WSS-SND-STAT
      *              MOVE CMMA-PFG-GLS-MENS TO WSS-SND-MENS
      *           ELSE
      *              MOVE CMMA-PFG-GLS-DATA TO WPFG
      *              MOVE WPFG-GAR-058-56-GDD-CAI-GTIA TO PT-058-01-GDG-
      *              MOVE WPFG-GAR-058-56-GDG-COD-CRR TO PT-058-01-GDG-C
      *              IF WSS-COD-CREQ = '558' OR
      *                 WSS-COD-CREQ = '658'
      *                 MOVE '058' TO WSS-COD-CREQ
      *                 PERFORM PRO-REQ-058
      *              ELSE
      *                 MOVE '051' TO WSS-COD-CREQ
      *                 PERFORM PRO-REQ-051.
      *
       FIN-PRO-REQ-PFS-GDD.
           EXIT.

       PRO-REQ-059 SECTION.
       INI-PRO-REQ-059.
      * GVT,RVL
           PERFORM EDT-NUM-PT-REQ-059.
           PERFORM MOV-GNS-059-01.
           PERFORM MOV-PT-TX-059-01.
           PERFORM MOV-GNS-059-02.
           PERFORM MOV-PT-TX-059-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-059.
       FIN-PRO-REQ-059.
           EXIT.

       PRO-REQ-060 SECTION.
       INI-PRO-REQ-060.
      * PXI,CON
           PERFORM EDT-NUM-PT-REQ-060.
           PERFORM MOV-GNS-060-01.
           PERFORM MOV-PT-TX-060-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-060-01.
           PERFORM VAL-NUM-TP-REQ-060.
       FIN-PRO-REQ-060.
           EXIT.


       PRO-REQ-061 SECTION.
       INI-PRO-REQ-061.
      * GSO,CON
           PERFORM EDT-NUM-PT-REQ-061.
           PERFORM MOV-GNS-061-01.
           PERFORM MOV-PT-TX-061-01.
           PERFORM PUT-TDI.
      *DDD DISPLAY 'GARPPTPG GSO CON GARANTIA +' PT-061-01-GSO-CAI-GTIA 
      *DDD     '-' PT-061-01-GSO-IIC-GTIA '-' PT-061-01-GSO-NUM-SBGL.
          
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-061-01.
      *DDD DISPLAY 'GARPPTPG REQ-061 ESTADO JURIDICO '.
      *DDD DISPLAY 'CODIGO +' TP-061-01-GSO-COD-EST2 '+'.
      *DDD DISPLAY 'GLOSA  +' TP-061-01-FRM-GLS-EST2 '+'.
           
           PERFORM VAL-NUM-TP-REQ-061.
       FIN-PRO-REQ-061.
           EXIT.

       PRO-REQ-162 SECTION.
       INI-PRO-REQ-162.
      * GSL,ING,GKY
           PERFORM EDT-NUM-PT-REQ-162.

           PERFORM MOV-GNS-162-01.
           PERFORM MOV-PT-TX-162-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-162-01.
           PERFORM VAL-NUM-TP-REQ-162.

       FIN-PRO-REQ-162.
           EXIT.

       PRO-REQ-062 SECTION.
       INI-PRO-REQ-062.
      * GSL,GSO,ING
           PERFORM DEL-TS-GSL.
           PERFORM EDT-NUM-PT-REQ-062.

           PERFORM MOV-GNS-062-01.
           PERFORM MOV-PT-TX-062-01.
           PERFORM MOV-GNS-062-02.
           PERFORM MOV-PT-TX-062-02.

           PERFORM MOV-GNS-062-03 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 70 OR
               PT-062-03-GSO-CAI-GTIA(TPG-I) NOT > SPACES).

           PERFORM MOV-PT-TX-062-03 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 70 OR
               PT-062-03-GSO-CAI-GTIA(TPG-I) NOT > SPACES).

           PERFORM MOV-GNS-062-04 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 70 OR
               PT-062-03-GSO-CAI-GTIA(TPG-I) NOT > SPACES).

           PERFORM MOV-PT-TX-062-04 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 70 OR
               PT-062-03-GSO-CAI-GTIA(TPG-I) NOT > SPACES).

      *DDD     DISPLAY 'PRO-REQ-062 TDI :' TX-062 ':'.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      *     PERFORM REC-TS-062.
           PERFORM MOV-XT-TP-062-01.
           PERFORM VAL-NUM-TP-REQ-062.
           PERFORM DEL-TS-GSL.
       FIN-PRO-REQ-062.
           EXIT.

       PRO-REQ-063 SECTION.
       INI-PRO-REQ-063.
      * GSO,AEJ
           PERFORM EDT-NUM-PT-REQ-063.
           PERFORM MOV-GNS-063-01.
           PERFORM MOV-PT-TX-063-01.
           PERFORM MOV-GNS-063-02.
           PERFORM MOV-PT-TX-063-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      *     PERFORM MOV-XT-TP-063-01.
           PERFORM VAL-NUM-TP-REQ-063.
       FIN-PRO-REQ-063.
           EXIT.

       PRO-REQ-064 SECTION.
       INI-PRO-REQ-064.
      * GSL,GSO,MOD
           PERFORM DEL-TS-GSL.
           PERFORM EDT-NUM-PT-REQ-064.

           PERFORM MOV-GNS-064-01.
           PERFORM MOV-PT-TX-064-01.
           PERFORM MOV-GNS-064-02.
           PERFORM MOV-PT-TX-064-02.

           PERFORM MOV-GNS-064-03 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 70 OR
               PT-064-03-GSO-CAI-GTIA(TPG-I) NOT > SPACES).

           PERFORM MOV-PT-TX-064-03 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 70 OR
               PT-064-03-GSO-CAI-GTIA(TPG-I) NOT > SPACES).

           PERFORM MOV-PT-TX-064-SBGL VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 70 OR
               PT-064-03-GSO-CAI-GTIA(TPG-I) NOT > SPACES).

           PERFORM MOV-GNS-064-04 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 70 OR
               PT-064-03-GSO-CAI-GTIA(TPG-I) NOT > SPACES).

           PERFORM MOV-PT-TX-064-04 VARYING TPG-I FROM 1 BY 1
                     UNTIL (TPG-I > 70 OR
               PT-064-03-GSO-CAI-GTIA(TPG-I) NOT > SPACES).

      *DDD DISPLAY 'PRO-REQ-064 TDI :' TX-064 ':'.

           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      *     PERFORM REC-TS-064.
           PERFORM VAL-NUM-TP-REQ-064.
           PERFORM DEL-TS-GSL.
       FIN-PRO-REQ-064.
           EXIT.


       MOV-PT-TX-064-SBGL SECTION.
       INI-MOV-PT-TX-064-SBGL.
           MOVE PT-064-01-GSL-NUM-SBGL TO
                TX-064-03-GSO-NUM-SBGL(TPG-I).
       FIN-MOV-PT-TX-064-SBGL.
           EXIT.


       PRO-REQ-065 SECTION.
       INI-PRO-REQ-065.
      * GSO,AEG
           PERFORM EDT-NUM-PT-REQ-065.
           PERFORM MOV-GNS-065-01.
           PERFORM MOV-PT-TX-065-01.
           PERFORM MOV-GNS-065-02.
           PERFORM MOV-PT-TX-065-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      *     PERFORM MOV-XT-TP-065-01.
           PERFORM VAL-NUM-TP-REQ-065.
       FIN-PRO-REQ-065.
           EXIT.

       PRO-REQ-066 SECTION.
       INI-PRO-REQ-066.
      * GSL,CON
           PERFORM EDT-NUM-PT-REQ-066.
           PERFORM MOV-GNS-066-01.
           PERFORM MOV-PT-TX-066-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-066-01.
           PERFORM VAL-NUM-TP-REQ-066.
       FIN-PRO-REQ-066.
           EXIT.

       PRO-REQ-067 SECTION.
       INI-PRO-REQ-067.
      * GSO,ELI
           PERFORM EDT-NUM-PT-REQ-067.
           PERFORM MOV-GNS-067-01.
           PERFORM MOV-PT-TX-067-01.
           PERFORM MOV-GNS-067-02.
           PERFORM MOV-PT-TX-067-02.

           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      *     PERFORM MOV-XT-TP-067-01.
           PERFORM VAL-NUM-TP-REQ-067.
       FIN-PRO-REQ-067.
           EXIT.

       PRO-REQ-068 SECTION.
       INI-PRO-REQ-068.
      * GSL,CAN
           PERFORM EDT-NUM-PT-REQ-068.
           PERFORM MOV-GNS-068-01.
           PERFORM MOV-PT-TX-068-01.
           PERFORM MOV-GNS-068-02.
           PERFORM MOV-PT-TX-068-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      *     PERFORM MOV-XT-TP-068-01.
           PERFORM VAL-NUM-TP-REQ-068.
       FIN-PRO-REQ-068.
           EXIT.

       PRO-REQ-069 SECTION.
       INI-PRO-REQ-069.
      * GSL,ASO
           PERFORM EDT-NUM-PT-REQ-069.
           PERFORM MOV-GNS-069-01.
           PERFORM MOV-PT-TX-069-01.
           PERFORM MOV-GNS-069-02.
           PERFORM MOV-PT-TX-069-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      *     PERFORM MOV-XT-TP-069-01.
           PERFORM VAL-NUM-TP-REQ-069.
       FIN-PRO-REQ-069.
           EXIT.

       PRO-REQ-070 SECTION.
       INI-PRO-REQ-070.
      * GUB,CON
           PERFORM EDT-NUM-PT-REQ-070.
           PERFORM MOV-GNS-070-01.
           PERFORM MOV-PT-TX-070-01.
           PERFORM MOV-GNS-070-02.
           PERFORM MOV-PT-TX-070-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-070.
       FIN-PRO-REQ-070.
           EXIT.

       PRO-REQ-071 SECTION.
       INI-PRO-REQ-071.
      * GUB,CON
           PERFORM EDT-NUM-PT-REQ-071.
           PERFORM MOV-GNS-071-01.
           PERFORM MOV-PT-TX-071-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-071-01.
           PERFORM VAL-NUM-TP-REQ-071.
       FIN-PRO-REQ-071.
           EXIT.

       PRO-REQ-172 SECTION.
       INI-PRO-REQ-172.
      * GUB,ING,GKY
           PERFORM EDT-NUM-PT-REQ-172.

           PERFORM MOV-GNS-172-01.
           PERFORM MOV-PT-TX-172-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-172-01.
           PERFORM VAL-NUM-TP-REQ-172.

       FIN-PRO-REQ-172.
           EXIT.
       PRO-REQ-072 SECTION.
       INI-PRO-REQ-072.
      * GUB,ING
           PERFORM EDT-NUM-PT-REQ-072.
           PERFORM MOV-GNS-072-01.
           PERFORM MOV-PT-TX-072-01.
           PERFORM MOV-GNS-072-02
           PERFORM MOV-PT-TX-072-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-072.

       FIN-PRO-REQ-072.
           EXIT.

       PRO-REQ-176 SECTION.
       INI-PRO-REQ-176.
      * GDD,ING-GKY
           PERFORM EDT-NUM-PT-REQ-176.

           PERFORM MOV-GNS-176-01.
           PERFORM MOV-PT-TX-176-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-176-01.
           PERFORM VAL-NUM-TP-REQ-176.

       FIN-PRO-REQ-176.
           EXIT.


       PRO-REQ-276 SECTION.
       INI-PRO-REQ-276.
      * GDD,ING,GFL-CNF
      * este req no tiene sentido, pues no hay nada que confirmar
           PERFORM EDT-NUM-PT-REQ-276.
           PERFORM MOV-GNS-276-01.
           PERFORM MOV-PT-TX-276-01.
           PERFORM MOV-GNS-276-02
           PERFORM MOV-PT-TX-276-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
      *     PERFORM MOV-XT-TP-276-01.
           PERFORM VAL-NUM-TP-REQ-276.

       FIN-PRO-REQ-276.
           EXIT.

       PRO-REQ-076 SECTION.
       INI-PRO-REQ-076.
      * GDD,ING,GFL
           PERFORM EDT-NUM-PT-REQ-076.
           PERFORM MOV-GNS-076-01.
           PERFORM MOV-PT-TX-076-01.
           PERFORM MOV-GNS-076-02
           PERFORM MOV-PT-TX-076-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-076.

       FIN-PRO-REQ-076.
           EXIT.

       PRO-REQ-077 SECTION.
       INI-PRO-REQ-077.
      * GDD,CON
           PERFORM EDT-NUM-PT-REQ-077.
           PERFORM MOV-GNS-077-01.
           PERFORM MOV-PT-TX-077-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-077-01.


           MOVE WSY-NOM-TSGDD  TO QUE-COLA.
           MOVE WSY-LEN-TSGDD  TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO WSY-TAB-GDD
               MOVE QUE-DEL TO QUE-CMND
               PERFORM GNS-PRO-QUE
               MOVE WSY-GLS-APAT IN WSY-TAB-GDD TO
                    TP-077-02-FRM-GLS-APAT
               MOVE WSY-GLS-AMAT IN WSY-TAB-GDD TO
                    TP-077-02-FRM-GLS-AMAT
               MOVE WSY-GLS-NOMB IN WSY-TAB-GDD TO
                    TP-077-02-FRM-GLS-NOMB.
           
           PERFORM VAL-NUM-TP-REQ-077.

       FIN-PRO-REQ-077.
           EXIT.

       PRO-REQ-078 SECTION.
       INI-PRO-REQ-078.
      * GDD,MOD
           PERFORM EDT-NUM-PT-REQ-078.
           PERFORM MOV-GNS-078-01.
           PERFORM MOV-PT-TX-078-01.
           PERFORM MOV-GNS-078-02.
           PERFORM MOV-PT-TX-078-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-078.

       FIN-PRO-REQ-078.
           EXIT.

       PRO-REQ-079 SECTION.
       INI-PRO-REQ-079.
      * GDD,ELI
           PERFORM EDT-NUM-PT-REQ-079.
           PERFORM MOV-GNS-079-01.
           PERFORM MOV-PT-TX-079-01.
           PERFORM MOV-GNS-079-02.
           PERFORM MOV-PT-TX-079-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-079.

       FIN-PRO-REQ-079.
           EXIT.

       PRO-REQ-081 SECTION.
       INI-PRO-REQ-081.
      * GXD,CON
      * HAY-MAS INI
           IF PT-081-02-FRM-NUM-ICLI-NUM > ZEROES
      *DDD      DISPLAY 'REQ 081 GRABANDO TS PARA HAY MAS '
                MOVE GXD-TSGXD-MAS TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE PT-081-02-FRM-NUM-ICLI TO GXD-MAS-FRM-NUM-ICLI
                MOVE PT-081-02-FRM-VRF-ICLI TO GXD-MAS-FRM-VRF-ICLI
                MOVE PT-081-02-FRM-IND-ICLI TO GXD-MAS-FRM-IND-ICLI
                MOVE PT-081-02-FRM-GLS-ICLI TO GXD-MAS-FRM-GLS-ICLI
                MOVE GXD-MAS-ITEM TO QUE-ITEM
      *DDD      DISPLAY 'REQ 081 GRABANDO TS HAY MAS ' GXD-MAS-ITEM

                MOVE GXD-LEN-TSGXD-MAS TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN

           PERFORM EDT-NUM-PT-REQ-081.
           PERFORM MOV-GNS-081-01.
           PERFORM MOV-PT-TX-081-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-081-01.

      * HAY-MAS INI
           MOVE GXD-TSGXD-MAS TO QUE-COLA.
           MOVE GXD-LEN-TSGXD-MAS TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO GXD-MAS-ITEM
      *DDD     DISPLAY 'REQ 081 LEYO TS HAY MAS '  GXD-MAS-ITEM
               MOVE GXD-MAS-IND-HMAS TO TP-081-02-DAS-IND-HMAS
               MOVE GXD-MAS-NUM-TOCC TO TP-081-02-DAS-NUM-TGXD
               MOVE QUE-DEL TO QUE-CMND
               PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN

           MOVE GXD-NOM-TSGXD TO QUE-COLA.
           MOVE GXD-LEN-TSGXD TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO GXD-081
               PERFORM PUT-GXDS VARYING GXD-IDX-GXD
                 FROM 1 BY 1 UNTIL GXD-IDX-GXD > GXD-TOT-OCC-GXD
               MOVE QUE-DEL TO QUE-CMND
               PERFORM GNS-PRO-QUE.

           PERFORM VAL-NUM-TP-REQ-081.
       FIN-PRO-REQ-081.
           EXIT.

       PUT-GXDS SECTION.
       INI-PUT-GXDS.
           MOVE  GXD-081-03-FRM-NUM-ICLI ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-NUM-ICLI ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-VRF-ICLI ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-VRF-ICLI ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-IND-ICLI ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-IND-ICLI ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-GLS-ICLI ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-GLS-ICLI ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-GLS-NOMC ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-GLS-NOMC ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-SGV-VLIM ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-SGV-VLIM ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-SGV-PLIM ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-SGV-PLIM ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-GLS-DIRE ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-GLS-DIRE ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-GLS-COMU ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-GLS-COMU ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-GLS-REGI ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-GLS-REGI ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-GLS-CIUD ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-GLS-CIUD ( GXD-IDX-GXD).

           MOVE  GXD-081-03-FRM-GLS-FONO ( GXD-IDX-GXD) TO
                  TP-081-03-FRM-GLS-FONO ( GXD-IDX-GXD).
       FIN-PUT-GXDS.
           EXIT.

       PRO-REQ-082 SECTION.
       INI-PRO-REQ-082.
      * AXG,CON

      * HAY-MAS INI
           MOVE AXG-TSAXG-MAS TO QUE-COLA.
           MOVE AXG-LEN-TSAXG-MAS TO QUE-LITM.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           IF PT-082-01-GAP-COD-PACR-NUM  > ZEROES
      *DDD      DISPLAY 'GARPPTPG GRABARA COLA MAS ' PT-082
                MOVE AXG-TSAXG-MAS TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE PT-082-01-GAP-CAI-GTIA TO AXG-MAS-GAP-CAI-GTIA
                MOVE PT-082-01-GAP-IIC-GTIA TO AXG-MAS-GAP-IIC-GTIA
                MOVE PT-082-01-GAP-COD-PACR TO AXG-MAS-GAP-COD-PACR
                MOVE AXG-MAS-ITEM TO QUE-ITEM
                MOVE AXG-LEN-TSAXG-MAS TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN


           PERFORM EDT-NUM-PT-REQ-082.
           PERFORM MOV-GNS-082-01.
           PERFORM MOV-PT-TX-082-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-082-01.




      * HAY-MAS INI
           MOVE AXG-TSAXG-MAS TO QUE-COLA.
           MOVE AXG-LEN-TSAXG-MAS TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *DDD DISPLAY 'GARPPTPG LEYO COLA MAS STAT '
      *DDD      AXG-TSAXG-MAS
      *DDD     '-' QUE-STAT.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO AXG-MAS-ITEM
               MOVE AXG-MAS-IND-HMAS TO TP-082-02-DAS-IND-HMAS
               MOVE AXG-MAS-NUM-TOCC TO TP-082-02-DAS-NUM-TGXD
               MOVE QUE-DEL TO QUE-CMND
               PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN



           MOVE AXG-NOM-TSAXG TO QUE-COLA.
           MOVE AXG-LEN-TSAXG TO QUE-LITM.
           MOVE ZEROES TO QUE-NITM.
           MOVE ZEROES TO AXG-IDX-AXG.

       CIC-PRO-REQ-082.
           ADD 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *DDD DISPLAY 'GARPPTPG LEYENDO COLA STAT ' AXG-NOM-TSAXG
      *DDD    '-' QUE-STAT.
           IF QUE-STAT = QUE-STAT-OKS
      *DDD     DISPLAY 'GARPPTPG : R-082 QUE OKS'
                MOVE QUE-ITEM TO  WSS-COD-PACR-IDX
               ADD 1 TO AXG-IDX-AXG
               PERFORM PUT-AXGS
               GO TO CIC-PRO-REQ-082.

           MOVE AXG-NOM-TSAXG TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           PERFORM VAL-NUM-TP-REQ-082.
       FIN-PRO-REQ-082.
           EXIT.

       PRO-REQ-084 SECTION.
       INI-PRO-REQ-084.
      * COG,CON
      * HAY-MAS INI
           IF PT-084-02-FRM-NUM-IGES > ZEROES
                MOVE COG-TSCOG-MAS TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE PT-084-01-GDG-CAI-GTIA TO COG-MAS-GDG-CAI-GTIA
                MOVE PT-084-01-GDG-IIC-GTIA TO COG-MAS-GDG-IIC-GTIA
                MOVE PT-084-02-FRM-NUM-IGES TO COG-MAS-FRM-NUM-IGES
                MOVE COG-MAS-ITEM TO QUE-ITEM
                MOVE COG-LEN-TSCOG-MAS TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN


           PERFORM EDT-NUM-PT-REQ-084.

           PERFORM MOV-GNS-084-01.
           PERFORM MOV-PT-TX-084-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-084-01.

      * HAY-MAS INI
           MOVE COG-TSCOG-MAS TO QUE-COLA.
           MOVE COG-LEN-TSCOG-MAS TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO COG-MAS-ITEM
               MOVE COG-MAS-IND-HMAS TO TP-084-02-DAS-IND-HMAS
               MOVE COG-MAS-NUM-TOCC TO TP-084-02-DAS-NUM-TGXD
               MOVE QUE-DEL TO QUE-CMND
               PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN

           MOVE WSS-NOM-TSCOG  TO QUE-COLA.
           MOVE WSS-LEN-TSCOG  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           MOVE 1              TO QUE-NITM.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
      *DDD        DISPLAY 'COLA R-084 COLA SI ENCONTRADA ' QUE-ITEM
              MOVE QUE-ITEM TO WSS-TAB-COG
           ELSE
      *DDD        DISPLAY 'COLA R-084 COLA NO ENCONTRADA ' QUE-ITEM
              MOVE SPACES TO WSS-TAB-COG.
           MOVE ZEROES TO WSS-IDX-COG.
           PERFORM PRO-REQ-084-I VARYING I FROM 1 BY 1 UNTIL (I > 9).
           PERFORM VAL-NUM-TP-REQ-084.

           MOVE WSS-NOM-TSCOG  TO QUE-COLA.
           MOVE QUE-DEL        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-PRO-REQ-084.
           EXIT.

       PRO-REQ-084-I SECTION.
       INI-PRO-REQ-084-I.
           PERFORM PRO-REQ-084-J VARYING J FROM 1 BY 1 UNTIL (J > 5).
       FIN-PRO-REQ-084-I.
           EXIT.

       PRO-REQ-084-J SECTION.
       INI-PRO-REQ-084-J.

           ADD 1 TO WSS-IDX-COG.
           MOVE               WSS-NUM-IGES IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-NUM-IGES(I,J).

      *DDD DISPLAY ' R-084  GRABANDO'  I '-' J '+'
      *DDD     TP-084-03-FRM-NUM-IGES(I,J).

           MOVE               WSS-COD-SIST IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-COD-SIST(I,J).
           MOVE               WSS-CAI-IOPC IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-CAI-IOPC(I,J).
           MOVE               WSS-IIC-IOPC IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-IIC-IOPC(I,J).
           MOVE               WSS-NUM-IDLC IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-NUM-IDLC(I,J).
           MOVE               WSS-FEC-FVCR IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-FEC-FVCR(I,J).
           MOVE                WSS-COD-MVLC IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-COD-MVLC(I,J).
           MOVE               WSS-SGV-VLCR IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-SGV-VLCR(I,J).
           MOVE               WSS-SGV-PLCR IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-SGV-PLCR(I,J).
           MOVE               WSS-IND-SCRE IN WSS-TAB-COG(WSS-IDX-COG)
                TO  TP-084-03-FRM-IND-SCRE(I,J).

       FIN-PRO-REQ-084-J.
           EXIT.

       PUT-AXGS SECTION.
       INI-PUT-AXGS.
           MOVE                  WSS-COD-PACR TO
                       TP-082-03-FRM-COD-PACR(AXG-IDX-AXG ).

           MOVE                  WSS-NUM-ICLI-AXG TO
                       TP-082-03-FRM-NUM-ICLI(AXG-IDX-AXG ).

           MOVE                  WSS-VRF-ICLI-AXG TO
                       TP-082-03-FRM-VRF-ICLI(AXG-IDX-AXG ).

           MOVE                  WSS-IND-ICLI-AXG TO
                       TP-082-03-FRM-IND-ICLI(AXG-IDX-AXG ).

           MOVE                  WSS-GLS-ICLI-AXG TO
                       TP-082-03-FRM-GLS-ICLI(AXG-IDX-AXG ).

           MOVE                  WSS-GLS-NOMC TO
                       TP-082-03-FRM-GLS-NOMC(AXG-IDX-AXG ).

           MOVE                  WSS-IND-ESBA TO
                       TP-082-03-FRM-IND-ESBA(AXG-IDX-AXG ).

           MOVE                  WSS-IND-ESCL TO
                       TP-082-03-FRM-IND-ESCL(AXG-IDX-AXG ).

           MOVE                  WSS-SGV-MACR TO
                                 FRM-SGV-MACR-EDT.

           MOVE                  FRM-SGV-MACR-EDT TO
                       TP-082-03-FRM-SGV-MACR(AXG-IDX-AXG ).

           MOVE                  WSS-IND-MACR TO
                       TP-082-03-FRM-IND-MACR(AXG-IDX-AXG ).

           MOVE                  WSS-GLS-ABOG TO
                       TP-082-03-FRM-GLS-ABOG(AXG-IDX-AXG ).

           MOVE                  WSS-GLS-NTRO TO
                       TP-082-03-FRM-GLS-NTRO(AXG-IDX-AXG ).

           MOVE                  WSS-IND-ITIN TO
                       TP-082-03-FRM-IND-ITIN(AXG-IDX-AXG ).

           MOVE                  WSS-FEC-FESC TO
                       TP-082-03-FRM-FEC-FESC(AXG-IDX-AXG ).

      *     MOVE WSS-CAI-GTIA TO

      *     MOVE WSS-IIC-GTIA TO

      *     MOVE WSS-COD-PACR-B TO

      *     MOVE WSS-GLS-CGTA TO

      *     MOVE WSS-GLS-TOPE TO

      *     MOVE WSS-GLS-SOPE TO

       FIN-PUT-AXGS.
           EXIT.

      * PRO-REQ-085 SECTION.
      * INI-PRO-REQ-085.
      ** GIM,MOD
      *     PERFORM EDT-NUM-PT-REQ-085.
      *     PERFORM MOV-GNS-085-01.
      *     PERFORM MOV-PT-TX-085-01.
      *     PERFORM MOV-GNS-085-02
      *     PERFORM MOV-PT-TX-085-02.
      *     PERFORM PUT-TDI.
      *     PERFORM LNK-MTD.
      *     PERFORM GET-TDO.
      *     PERFORM VAL-NUM-TP-REQ-085.
      *
      * FIN-PRO-REQ-085.
      *     EXIT.

       PRO-REQ-085 SECTION.
       INI-PRO-REQ-085.
      * SXG,CON
      * HAY-MAS INI
           IF PT-085-01-GSI-NUM-IGSI > ZEROES
                MOVE SXG-TSSXG-MAS TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE PT-085-01-GSI-CAI-GTIA TO SXG-MAS-GSI-CAI-GTIA
                MOVE PT-085-01-GSI-IIC-GTIA TO SXG-MAS-GSI-IIC-GTIA
                MOVE PT-085-01-GSI-NUM-IGSI TO SXG-MAS-GSI-NUM-IGSI
                MOVE SXG-MAS-ITEM TO QUE-ITEM
                MOVE SXG-LEN-TSSXG-MAS TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN





           PERFORM EDT-NUM-PT-REQ-085.
           PERFORM MOV-GNS-085-01.
           PERFORM MOV-PT-TX-085-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-085-01.

      * HAY-MAS INI
           MOVE SXG-TSSXG-MAS TO QUE-COLA.
           MOVE SXG-LEN-TSSXG-MAS TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO SXG-MAS-ITEM
               MOVE SXG-MAS-IND-HMAS TO TP-085-02-DAS-IND-HMAS
               MOVE SXG-MAS-NUM-TOCC TO TP-085-02-DAS-NUM-TGXD
               MOVE QUE-DEL TO QUE-CMND
               PERFORM GNS-PRO-QUE.
      * HAY-MAS FIN


           MOVE SXG-NOM-TSSXG TO QUE-COLA.
           MOVE SXG-LEN-TSSXG TO QUE-LITM.
           MOVE ZEROES TO QUE-NITM.
           MOVE ZEROES TO SXG-IDX-SXG.

       CIC-PRO-REQ-085.
           ADD 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *DDD DISPLAY 'GARPPTPG LEYENDO COLA ' SXG-NOM-TSSXG.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO WSS-NUM-IGSI-IDX
      *         MOVE SXG-MAS-IND-HMAS TO
      *               TP-085-02-DAS-IND-HMAS
      *         MOVE SXG-MAS-NUM-TOCC TO
      *              SXG-085-02-DAS-NUM-TSXG
               ADD 1 TO SXG-IDX-SXG
      *DDD         DISPLAY 'GARPPTPG : R-085 QUE OKS ' SXG-IDX-SXG
               PERFORM PUT-SXGS
               GO TO CIC-PRO-REQ-085.

           MOVE SXG-NOM-TSSXG TO QUE-COLA.
           MOVE SXG-LEN-TSSXG TO QUE-LITM.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           PERFORM VAL-NUM-TP-REQ-085.
       FIN-PRO-REQ-085.
           EXIT.

       PUT-SXGS SECTION.
       INI-PUT-SXGS.

              MOVE WSS-NUM-IGSI TO GSI-NUM-IGSI-EDT.

              MOVE GSI-NUM-IGSI-EDT TO
                       TP-085-03-FRM-NUM-IGSI(SXG-IDX-SXG ).

              MOVE WSS-FEC-FSIN TO
                       TP-085-03-FRM-FEC-FSIN(SXG-IDX-SXG ).

              MOVE WSS-SGV-PSIN TO FRM-SGV-PSIN-EDT.

              MOVE FRM-SGV-PSIN-EDT TO
                       TP-085-03-FRM-SGV-PSIN(SXG-IDX-SXG ).

              MOVE WSS-IND-SSEG TO
                       TP-085-03-FRM-IND-SSEG(SXG-IDX-SXG ).

              MOVE WSS-SGV-VPSG TO FRM-SGV-VPSG-EDT.

              MOVE FRM-SGV-VPSG-EDT TO
                       TP-085-03-FRM-SGV-VPSG(SXG-IDX-SXG ).

              MOVE WSS-IND-RTPS TO
                       TP-085-03-FRM-IND-RTPS(SXG-IDX-SXG ).

              MOVE WSS-GLS-DIDM TO
                       TP-085-03-FRM-GLS-DIDM(SXG-IDX-SXG ).

       FIN-PUT-SXGS.
           EXIT.

       PRO-REQ-086 SECTION.
       INI-PRO-REQ-086.
      * GIM,CON
           PERFORM EDT-NUM-PT-REQ-086.
           PERFORM MOV-GNS-086-01.
           PERFORM MOV-PT-TX-086-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-086-01.
           PERFORM VAL-NUM-TP-REQ-086.
       FIN-PRO-REQ-086.
           EXIT.

       PRO-REQ-187 SECTION.
       INI-PRO-REQ-187.
      * GIM,ING,GFL
           PERFORM EDT-NUM-PT-REQ-187.
           PERFORM MOV-GNS-187-01.
           PERFORM MOV-PT-TX-187-01.
      *     PERFORM MOV-GNS-187-02
      *     PERFORM MOV-PT-TX-187-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-187-01.
           PERFORM VAL-NUM-TP-REQ-187.

       FIN-PRO-REQ-187.
           EXIT.

       PRO-REQ-087 SECTION.
       INI-PRO-REQ-087.
      * GIM,ING,GFL
           PERFORM EDT-NUM-PT-REQ-087.
           PERFORM MOV-GNS-087-01.
           PERFORM MOV-PT-TX-087-01.
           PERFORM MOV-GNS-087-02
           PERFORM MOV-PT-TX-087-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-087.

       FIN-PRO-REQ-087.
           EXIT.

       PRO-REQ-088 SECTION.
       INI-PRO-REQ-088.
      * GIM,ELI
           PERFORM EDT-NUM-PT-REQ-088.
           PERFORM MOV-GNS-088-01.
           PERFORM MOV-PT-TX-088-01.
           PERFORM MOV-GNS-088-02
           PERFORM MOV-PT-TX-088-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-088.

       FIN-PRO-REQ-088.
           EXIT.


       PRO-REQ-089 SECTION.
       INI-PRO-REQ-089.
      * GVT,RTF
           PERFORM EDT-NUM-PT-REQ-089.
           PERFORM MOV-GNS-089-01.
           PERFORM MOV-PT-TX-089-01.
           PERFORM MOV-GNS-089-02
           PERFORM MOV-PT-TX-089-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-089.

       FIN-PRO-REQ-089.
           EXIT.


       PRO-REQ-095 SECTION.
       INI-PRO-REQ-095.
      * GVE,CON
           PERFORM EDT-NUM-PT-REQ-095.
           PERFORM MOV-GNS-095-01.
           PERFORM MOV-PT-TX-095-01.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM MOV-XT-TP-095-01.
           PERFORM VAL-NUM-TP-REQ-095.

       FIN-PRO-REQ-095.
           EXIT.


       PRO-REQ-096 SECTION.
       INI-PRO-REQ-096.
      * GVE,ING,GFL
           PERFORM EDT-NUM-PT-REQ-096.
           PERFORM MOV-GNS-096-01.
           PERFORM MOV-PT-TX-096-01.
           PERFORM MOV-GNS-096-02
           PERFORM MOV-PT-TX-096-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-096.

       FIN-PRO-REQ-096.
           EXIT.


       PRO-REQ-097 SECTION.
       INI-PRO-REQ-097.
      * GVE,ELI
           PERFORM EDT-NUM-PT-REQ-097.
           PERFORM MOV-GNS-097-01.
           PERFORM MOV-PT-TX-097-01.
           PERFORM MOV-GNS-097-02
           PERFORM MOV-PT-TX-097-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-097.

       FIN-PRO-REQ-097.
           EXIT.


       PRO-REQ-099 SECTION.
       INI-PRO-REQ-099.
      * GVE,MOD
           PERFORM EDT-NUM-PT-REQ-099.
           PERFORM MOV-GNS-099-01.
           PERFORM MOV-PT-TX-099-01.
           PERFORM MOV-GNS-099-02
           PERFORM MOV-PT-TX-099-02.
           PERFORM PUT-TDI.
           PERFORM LNK-MTD.
           PERFORM GET-TDO.
           PERFORM VAL-NUM-TP-REQ-099.

       FIN-PRO-REQ-099.
           EXIT.

       DEL-TS-GSL SECTION.
       INI-DEL-TS-GSL.
           MOVE WSX-NOM-TSGSL  TO QUE-COLA.
           MOVE QUE-DEL        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-DEL-TS-GSL.
           EXIT.

************************

      *INI Copys generados Procedure
       COPY GARMXPD1.
       COPY GARNXPD1.

       COPY GARMXPD2.
       COPY GARNXPD2.

       COPY GARMXPD3.
       COPY GARNXPD3.

       COPY GARMXPD4.
       COPY GARNXPD4.
      *FIN
       LNK-MTD SECTION.
       INI-LNK-MTD.
           MOVE 'GNSPPMTI'      TO SYS-PROG.
      *     MOVE 0               TO SYS-TCMA.
      *     MOVE SPACES          TO SYS-CMMA.
           MOVE SYS-LINK        TO SYS-CMND.
      *DDD DISPLAY 'GARPPTPG ANTES   DE INVOCAR GNSPPMTI'.
           PERFORM GNS-PRO-SYS.
      *DDD DISPLAY 'GARPPTPG DESPUES DE INVOCAR GNSPPMTI'.
           MOVE SPACES TO WSS-SND.
       FIN-LNK-MTD.
           EXIT.

      *
       PUT-TDI SECTION.
       INI-PUT-TDI.
           MOVE 1                      TO TDI-NUM-RECO.
           MOVE FIO-DEL                TO FIO-CMND.
           PERFORM GNS-FIO-TDI.
           MOVE 1                      TO TDI-NUM-RECO.
           MOVE FIO-PUT                TO FIO-CMND.
      * ISP-INI PROCESA MENSAJES SIN HDR
      * CUANDO PROCESA REQ 027 CAC EL MENSAJE QUEDA OK ( SIN HDR )
      *****     IF WSS-COD-CREQ NOT = '027'
           MOVE WSS-SND TO WSS-TX-TMP-RED.
           MOVE WSS-TX-TMP-RED-DAT TO TDI-GLS-DESC.
      *****     ELSE
      *****         MOVE WSS-SND TO TDI-GLS-DESC.
      * ISP-FIN PROCESA MENSAJES SIN HDR
           PERFORM GNS-FIO-TDI.
       FIN-PUT-TDI.
           EXIT.


       PROCESO-LEE-TS SECTION.
       INI-PROCESO-LEE-TS.
           MOVE ZEROES   TO WSS-NITM-TSPT.
           MOVE +1025    TO WSS-LEN-TSPT.
           PERFORM GET-TSPT.
       FIN-PROCESO-LEE-TS.
           EXIT.

       GET-TSPT SECTION.
       INI-GET-TSPT.
           ADD 1 TO WSS-NITM-TSPT.
           MOVE SCR-NOM-TCPIP     TO WSS-PTR-COD-TYPE.
           MOVE WSS-PTR-GLS-COLA  TO QUE-COLA.
           MOVE WSS-NITM-TSPT     TO QUE-NITM.
           MOVE WSS-LEN-TSPT      TO QUE-LITM.
           MOVE QUE-GET           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM      TO WSS-ITEM-TSPT
      *DDD     DISPLAY 'GARPPTPG : ITEM LEIDO VVVVVVVV'
      *DDD     DISPLAY WSS-ITEM-TSPT
      *DDD     DISPLAY 'GARPPTPG : ITEM LEIDO AAAAAAAA'
               MOVE WSS-DATA-TSPT TO WSS-ELE-SEGR (WSS-NITM-TSPT)
               GO TO INI-GET-TSPT.
       FIN-GET-TSPT.
           EXIT.

       GET-TDO SECTION.
       INI-GET-TDO.
           MOVE 1                       TO TDO-NUM-RECO.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM GNS-FIO-TDO.
      *DDD IF QUE-STAT NOT = QUE-STAT-OKS
      *DDD     DISPLAY 'GARPPTPG TDO LEIDO NO OK'.
           IF QUE-STAT = QUE-STAT-OKS
      *DDD     DISPLAY 'GARPPTPG TDO LEIDO    OK'
               MOVE TDO-COD-STAT   TO WSS-SND-STAT
               MOVE TDO-GLS-MENS   TO WSS-SND-MENS
               MOVE TDO-DESC-OCC   TO WSS-RCV.
       FIN-GET-TDO.
           EXIT.

       PRO-TO SECTION.
       INI-PRO-TO.
           MOVE 'TO' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 'TO' TO QUE-COLA.
           MOVE +1025 TO QUE-LITM.
           MOVE WSS-SND TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PRO-TO.
           EXIT.

       SND-TS-MSSG SECTION.
       INI-SND-TS-MSSG.
      * Borra TS si esta ya existe
           PERFORM BUS-ULT-ELEM.
      *    MOVE SEG-NOM-TSSEG  TO QUE-COLA.
      *    MOVE 'TO'           TO QUE-COLA.
           MOVE SCR-NOM-TCPIP     TO WSS-PTR-COD-TYPE.
           MOVE WSS-PTR-GLS-COLA  TO QUE-COLA.
           MOVE QUE-DEL        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE ZEROES TO SEG-NUM-ITEM.
       LUP-SND-TS-MSSG.
           ADD 1 TO SEG-NUM-ITEM.
           MOVE WSS-ELE-SEGS(SEG-NUM-ITEM) TO WSS-DATA-TSPT.
           IF SEG-NUM-ITEM < WSS-ULT-REG
                MOVE '0' TO WSS-INDICA-TSPT
           ELSE
                MOVE '1' TO WSS-INDICA-TSPT.
      *     IF WSS-PATH = 'SI'
      *           MOVE WSS-DATA-TSPT TO WSS-FMT-CORP
      *           MOVE +100 TO QUE-LITM
      *          EXEC CICS WRITEQ TS QNAME('DATATSPT')
      *          FROM(WSS-DATA-TSPT) LENTH(QUE-LITM)
      *          END-EXEC
      *           MOVE WSS-FMT-CORP-STAT TO WSS-FMT-CORP-STAT-ENV
      *           IF WSS-FMT-CORP-STAT = '0'
      *               MOVE +100 TO QUE-LITM
      *               EXEC CICS WRITEQ TS QNAME('FMTOK')
      *               FROM(WSS-FMT-CORP-STAT   ) LENTH(QUE-LITM)
      *               END-EXEC
      *                MOVE WSS-FMT-CORP-DATA TO WSS-FMT-CORP-DATA-ENV
      *                MOVE WSS-FMT-CORP-ENV TO WSS-DATA-TSPT
      *           ELSE
      *               MOVE +100 TO QUE-LITM
      *               EXEC CICS WRITEQ TS QNAME('FMTER')
      *               FROM(WSS-FMT-CORP-STAT   ) LENTH(QUE-LITM)
      *               END-EXEC
      *                MOVE WSS-FMT-CORP-ITEM TO WSS-FMT-CORP-DATA-ENV
      *                MOVE WSS-FMT-CORP-ENV TO WSS-DATA-TSPT.


      *    MOVE SEG-NOM-TSSEG          TO QUE-COLA.
      *    MOVE 'TO'                   TO QUE-COLA.
           MOVE WSS-ITEM-TSPT TO QUE-ITEM.
           MOVE SCR-NOM-TCPIP     TO WSS-PTR-COD-TYPE.
           MOVE WSS-PTR-GLS-COLA  TO QUE-COLA.
      *DDD DISPLAY 'GARPPTPG : GRABANDO TS OUT Y MENSAJE ' QUE-COLA.
      *DDD DISPLAY QUE-ITEM.
           MOVE SEG-LEN-TSSEG              TO QUE-LITM.
           MOVE QUE-PUT                    TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF WSS-ULT-REG > SEG-NUM-ITEM
              GO TO LUP-SND-TS-MSSG.
       FIN-SND-TS-MSSG.
           EXIT.
      *
       BUS-ULT-ELEM SECTION.
       INI-BUS-ULT-ELEM.
      * Borra TS si esta ya existe
           MOVE SEG-MAX-ELEM TO SEG-NUM-ITEM.
           MOVE 1 TO WSS-ULT-REG.
       LUP-BUS-ULT-ELEM.
           IF SEG-NUM-ITEM NOT > ZEROES
              GO TO FIN-BUS-ULT-ELEM.
           IF WSS-ELE-SEGS(SEG-NUM-ITEM) > SPACES
              MOVE SEG-NUM-ITEM TO WSS-ULT-REG
           ELSE
              SUBTRACT 1 FROM SEG-NUM-ITEM
              GO TO LUP-BUS-ULT-ELEM.
       FIN-BUS-ULT-ELEM.
           EXIT.

       COPY GNSBVNUM.
      *COPY GNSBPNUM.
       COPY GNSBGHOY.
       COPY GNSBHSYS.
       COPY GNSBGSYS.
       COPY GNSBIABT.
       COPY GNSBFTXI.
       COPY GNSBFTXO.
       COPY GNSBGTSK.


       COPY GNSBGEND.


      *Modulo Generico Manejo de Colas
       GNS-CHK-QUEU SECTION.
       INI-GNS-CHK-QUEU.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-GNS-CHK-QUEU.
           EXIT.

       GNS-QUE-EOQ SECTION.
       INI-GNS-QUE-EOQ.
           MOVE QUE-STAT-EOQ TO QUE-STAT.
           GO TO FIN-GNS-PRO-QUE.
       FIN-GNS-QUE-EOQ.
           EXIT.

       GNS-QUE-NEX SECTION.
       INI-GNS-QUE-NEX.
           MOVE QUE-STAT-NEX TO QUE-STAT.
           GO TO FIN-GNS-PRO-QUE.
       FIN-GNS-QUE-NEX.
           EXIT.

      **************************************************************
       GNS-ERR-QUE SECTION.
       INI-GNS-ERR-QUE.
           EXEC CICS HANDLE CONDITION
                     QIDERR (GNS-QUE-NEX)
                     ITEMERR(GNS-QUE-EOQ)
                     LENGERR(GNS-QUE-NEX)
           END-EXEC.
       FIN-GNS-ERR-QUE.
           EXIT.

       GNS-PRO-QUE SECTION.
       INI-GNS-PRO-QUE.
           MOVE QUE-STAT-OKS TO QUE-STAT.
           IF QUE-CMND = QUE-PUT
               GO TO GNS-PUT-QUE
           ELSE
           IF QUE-CMND = QUE-GET
               GO TO GNS-GET-QUE
           ELSE
           IF QUE-CMND = QUE-MOD
               GO TO GNS-MOD-QUE
           ELSE
           IF QUE-CMND = QUE-DEL
               GO TO GNS-DEL-QUE.
           MOVE 'Comando invalido :' TO QUE-MEN1.
           MOVE QUE-CMND             TO QUE-MEN2.
           EXEC CICS XCTL
                     PROGRAM('GNSPPABT')
                     COMMAREA(QUE-MENS)
                     LENGTH(+79)
           END-EXEC.

       GNS-PUT-QUE.
           IF WSS-IND-QUE = '   '
               EXEC CICS WRITEQ TS
                     QUEUE(QUE-COLA)
                     FROM(QUE-ITEM)
                     LENGTH(QUE-LITM)
                     AUXILIARY
              END-EXEC
           ELSE
           IF WSS-IND-QUE = 'TDI'
               EXEC CICS WRITEQ TS
                     QUEUE(QUE-COLA)
                     FROM(TDI-GLS-DESC-1)
                     LENGTH(QUE-LITM)
                     AUXILIARY
               END-EXEC
               EXEC CICS WRITEQ TS
                     QUEUE(QUE-COLA)
                     FROM(TDI-GLS-DESC-2)
                     LENGTH(QUE-LITM)
                     AUXILIARY
              END-EXEC
           ELSE
           IF WSS-IND-QUE = 'TDO'
               EXEC CICS WRITEQ TS
                     QUEUE(QUE-COLA)
                     FROM(TDO-GLS-DESC-1)
                     LENGTH(QUE-LITM)
                     AUXILIARY
               END-EXEC
               EXEC CICS WRITEQ TS
                     QUEUE(QUE-COLA)
                     FROM(TDO-GLS-DESC-2)
                     LENGTH(QUE-LITM)
                     AUXILIARY
              END-EXEC.
       FIN-GNS-PUT-QUE.
           GO TO FIN-GNS-PRO-QUE.

       GNS-GET-QUE.
           IF WSS-IND-QUE = '   '
               EXEC CICS READQ TS
                     QUEUE(QUE-COLA)
                     INTO(QUE-ITEM)
                     LENGTH(QUE-LITM)
                     ITEM(QUE-NITM)
              END-EXEC
           ELSE
           IF WSS-IND-QUE = 'TDI'
               EXEC CICS READQ TS
                     QUEUE(QUE-COLA)
                     INTO(TDI-GLS-DESC-1)
                     LENGTH(QUE-LITM)
                     ITEM(QUE-NITM)
               END-EXEC
               ADD 1  TO  QUE-NITM
               EXEC CICS READQ TS
                     QUEUE(QUE-COLA)
                     INTO(TDI-GLS-DESC-2)
                     LENGTH(QUE-LITM)
                     ITEM(QUE-NITM)
              END-EXEC
           ELSE
           IF WSS-IND-QUE = 'TDO'
               EXEC CICS READQ TS
                     QUEUE(QUE-COLA)
                     INTO(TDO-GLS-DESC-1)
                     LENGTH(QUE-LITM)
                     ITEM(QUE-NITM)
               END-EXEC
               ADD 1   TO  QUE-NITM
               EXEC CICS READQ TS
                     QUEUE(QUE-COLA)
                     INTO(TDO-GLS-DESC-2)
                     LENGTH(QUE-LITM)
                     ITEM(QUE-NITM)
              END-EXEC.
       FIN-GNS-GET-QUE.
           GO TO FIN-GNS-PRO-QUE.

       GNS-MOD-QUE.
           IF WSS-IND-QUE = SPACES
               EXEC CICS WRITEQ TS
                     QUEUE(QUE-COLA)
                     FROM(QUE-ITEM)
                     LENGTH(QUE-LITM)
                     ITEM(QUE-NITM)
                     REWRITE
               END-EXEC
           ELSE
           IF WSS-IND-QUE = 'TDI'
               EXEC CICS WRITEQ TS
                     QUEUE(QUE-COLA)
                     FROM(TDI-GLS-DESC)
                     LENGTH(QUE-LITM)
                     ITEM(QUE-NITM)
                     REWRITE
               END-EXEC
           ELSE
           IF WSS-IND-QUE = 'TDO'
               EXEC CICS WRITEQ TS
                     QUEUE(QUE-COLA)
                     FROM(TDO-GLS-DESC)
                     LENGTH(QUE-LITM)
                     ITEM(QUE-NITM)
                     REWRITE
               END-EXEC.
       FIN-GNS-MOD-QUE.
           GO TO FIN-GNS-PRO-QUE.

       GNS-DEL-QUE.
           EXEC CICS DELETEQ TS
                     QUEUE(QUE-COLA)
           END-EXEC.
       FIN-GNS-DEL-QUE.
           GO TO FIN-GNS-PRO-QUE.

       FIN-GNS-PRO-QUE.
           EXIT.

       PUT-CHR-TO-CHR SECTION.
       INI-PUT-CHR-TO-CHR.
           MOVE TX-TAB-CHR(WSS-ITX-ORIG)  TO
                TX-TAB-CHR(WSS-ITX-DEST).
           MOVE SPACES TO TX-TAB-CHR(WSS-ITX-ORIG).
           ADD 1 TO WSS-ITX-ORIG.
           ADD 1 TO WSS-ITX-DEST.
       FIN-PUT-CHR-TO-CHR.
           EXIT.
       DEL-TSS SECTION.
       INI-DEL-TSS.
            MOVE 'PL01' TO QUE-TERM.
            MOVE TSK-TERM-ALF TO QUE-TYPE.
            MOVE QUE-DEL TO QUE-CMND.
            PERFORM GNS-PRO-QUE.

            MOVE 'PL02' TO QUE-TERM.
            MOVE TSK-TERM-ALF TO QUE-TYPE.
            MOVE QUE-DEL TO QUE-CMND.
            PERFORM GNS-PRO-QUE.

            MOVE 'TSI ' TO QUE-TYPE.
            MOVE TSK-TERM-ALF TO QUE-TERM.
            MOVE QUE-DEL TO QUE-CMND.
            PERFORM GNS-PRO-QUE.

            MOVE 'TSO ' TO QUE-TYPE.
            MOVE TSK-TERM-ALF TO QUE-TERM.
            MOVE QUE-DEL TO QUE-CMND.
            PERFORM GNS-PRO-QUE.

            MOVE 'SIS '       TO QUE-TYPE.
            MOVE TSK-TERM-ALF TO QUE-TERM.
            MOVE QUE-DEL      TO QUE-CMND.
            PERFORM GNS-PRO-QUE.
       FIN-DEL-TSS.
           EXIT.
       MOV-PT-TO-PT SECTION.
       INI-MOV-PT-TO-PT.
           PERFORM MOV-PT-TO-PT-CHR VARYING WSS-PT-IDX-PT-PNTR
              FROM 1 BY 1 UNTIL WSS-PT-IDX-PT-PNTR > WSS-PT-LARG.
       FIN-MOV-PT-TO-PT.
           EXIT.

       MOV-PT-TO-PT-CHR SECTION.
       INI-MOV-PT-TO-PT-CHR.
      *    IF WSS-ESCR-TMP = 'S'
      *          PERFORM PUT-PT-027
      *          MOVE 'WTMP   ' TO QUE-COLA
      *          MOVE +1  TO QUE-LITM
      *          MOVE
      *         WSS-PT-TMP-ELM  IN WSS-PT-TMP  ( WSS-PT-IDX-PT-ORIG )
      *         TO QUE-ITEM
      *         MOVE QUE-PUT TO QUE-CMND
      *         PERFORM GNS-PRO-QUE.
           MOVE WSS-PT-TMP-ELM  IN WSS-PT-TMP  ( WSS-PT-IDX-PT-ORIG )
      *        TO WSS-PT-CHR-01.
      *
      *    MOVE SPACES TO
      *         WSS-RCV-RED-ELM IN WSS-RCV-RED ( WSS-PT-IDX-PT-ORIG ).
      *
      *    MOVE WSS-PT-CHR-01
            TO  WSS-RCV-RED-ELM IN WSS-RCV-RED ( WSS-PT-IDX-PT-DEST ).
           ADD 1 TO WSS-PT-IDX-PT-ORIG.
           ADD 1 TO WSS-PT-IDX-PT-DEST.
       FIN-MOV-PT-TO-PT-CHR.
           EXIT.

       OBT-HDR SECTION.
       INI-OBT-HDR.
      *    IF WSS-WCAC = 'S'
      *          MOVE 'WCAC   ' TO QUE-COLA
      *          MOVE +1  TO QUE-LITM
      *          MOVE
      *         WSS-PT-TMP-ELM IN WSS-PT-TMP   ( WSS-PT-IDX-HDR-ORIG )
      *               TO QUE-ITEM
      *          MOVE QUE-PUT TO QUE-CMND
      *          PERFORM GNS-PRO-QUE.
           MOVE WSS-PT-TMP-ELM IN WSS-PT-TMP   ( WSS-PT-IDX-HDR-ORIG )
                 TO WSS-IDN-HDR-ELM
                 IN WSS-IDN-HDR ( WSS-PT-IDX-HDR-DEST ).
           ADD 1 TO WSS-PT-IDX-HDR-ORIG.
       FIN-OBT-HDR.
           EXIT.

       MOV-TX-TO-TX-TMP SECTION.
       INI-MOV-TX-TO-TX-TMP.
           ADD 1 TO WSS-TX-IDX-ORIG.
           ADD 1 TO WSS-TX-IDX-DEST.
           MOVE TX-TAB-CHR  IN TX-TAB( WSS-TX-IDX-ORIG  )
            TO WSS-TX-TMP-ELM IN WSS-TX-TMP(WSS-TX-IDX-DEST).
       FIN-MOV-TX-TO-TX-TMP.
           EXIT.


       SET-NMSF SECTION.
       INI-SET-NMSF.
           MOVE TSK-TERM-ALF TO QUE-TERM.
      * NO MOVE SPACE FIELD
           MOVE 'NMSF' TO QUE-TYPE.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *     MOVE SPACES TO QUE-ITEM.
      *     MOVE +1 TO QUE-LITM
      *     MOVE QUE-PUT TO QUE-CMND
      *     PERFORM GNS-PRO-QUE.
       FIN-SET-NMSF.
           EXIT.

