*% FRM = 'GSI'
*% REG = 'GSI'
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF INI_GSI_FEC_FSIN
      *<<<< INI_GSI_FEC_SIN	
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-VHBL-N  TO FEC-VHBL.
      *>>>> 
*% END
*% IF FIN_UNP_IKY_GSI 
      *<<<< FIN_UNP_IKY_GSI 
           IF SCR-CCPP = "ING"
               MOVE FRM-CPIM-AEY TO GSI-NUM-IGSI-ATR IN GSI-FLD
               MOVE FRM-CPIM-AEY TO GSI-NUM-IGSI-STP.
      *>>>>
*% END
*% IF GSI_FEC_FSIN
      *<<<< GSI_FEC_SIN
      *Valida con fecha constitucion garantia.

           MOVE GSI-CAI-GTIA IN GSI-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GSI-IIC-GTIA IN GSI-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

           MOVE GDG-NUM-SEST IN GDG TO FEC-SEC1.
           MOVE GDG-NUM-AEST IN GDG TO FEC-AEC1.
           MOVE GDG-NUM-MEST IN GDG TO FEC-MEC1.
           MOVE GDG-NUM-DEST IN GDG TO FEC-DEC1.
      *
           MOVE GSI-NUM-SSIN IN GSI-FLD TO FEC-SEC2.
           MOVE GSI-NUM-ASIN IN GSI-FLD TO FEC-AEC2.
           MOVE GSI-NUM-MSIN IN GSI-FLD TO FEC-MEC2.
           MOVE GSI-NUM-DSIN IN GSI-FLD TO FEC-DEC2.
      *
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
*% IF PGM_ARG
      *<<<< PGM_ARG
               MOVE 'FEC   <MIN' TO MSG-COD-MENS
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
               MOVE 'FEC<MIN' TO MSG-COD-MENS
      *>>>>
*% END
               GO TO ERR-VAL-GSI-FEC-FSIN.

           GO TO FIN-VAL-GSI-FEC-FSIN.
       ERR-VAL-GSI-FEC-FSIN.
           MOVE 'GAR'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% LBL = ''
*% IF GSI_IND_RTPS
      *<<<< GSI_IND_RTS
*% IF FMT_CHI
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GSI-IND-RTPS IN GSI-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GSI-IND-RTPS.
      *>>>>
*% ELSE
           IF NOT (GSI-IND-RTPS IN GSI-FLD = 'S' OR 'N')
               MOVE 'DEBE SER S o N ' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
*% END
      *>>>>
*% END
*% IF GSI_IND_SSEG
      *<<<< GSI_IND_SSEG
*% IF FMT_CHI
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GSI-IND-SSEG IN GSI-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GSI-IND-SSEG.
      *>>>>
*% ELSE

           IF NOT (GSI-IND-SSEG IN GSI-FLD = 'S' OR 'N')
              MOVE 'DEBE SER S o N ' TO FRM-MENS
              MOVE FRM-SUAR-MAL  TO FRM-SUAR.
*% END
      *>>>>
*% END
*% IF GSI_SGV_VPSG
      *<<<< GSI_VAL_PAG_SEG
           IF GSI-IND-SSEG IN GSI-FLD NOT = 'S'
               MOVE 0 TO GSI-SGV-VPSG IN GSI-FLD
               GO TO FIN-VAL-GSI-SGV-VPSG.

           IF GSI-SGV-VPSG IN GSI-FLD = ZEROES
               MOVE 'GAR'     TO MSG-COD-SIST
               MOVE 'GSIVALPAG=0' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GSI_SGV_PSIN
      *<<<< GSI_PCT_SIN
      *
           IF ( GSI-IND-SSEG IN GSI-FLD = 'N')
               MOVE ZEROES TO GSI-SGV-PSIN IN GSI-FLD
               GO TO FIN-VAL-GSI-SGV-PSIN.

           IF ( GSI-SGV-PSIN IN GSI-FLD = ZEROES )
               MOVE 'GAR'     TO MSG-COD-SIST
               MOVE '%CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSI-SGV-PSIN.

           IF ( GSI-SGV-PSIN IN GSI-FLD > 100 )
               MOVE 'GAR'     TO MSG-COD-SIST
               MOVE '%>100' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *
      *>>>>
*% END
*% IF INI_GSI_CAI_GTIA
      *<<<<
           IF GSI-CAI-GTIA IN GSI-FLD NOT > SPACES
              MOVE SPACES TO GSI-CAI-GTIA IN GSI-FLD
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSI-CAI-GTIA.
      *>>>>
*% END
*% IF FIN_PUT_GDG_GSI
      *<<<< FIN_PUT_GDG_GSI
*% IF GEN_BCI
      *<<<< GEN_BCI
      *MHM-INI 25-JUL-2003
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-CGTA IN GSI-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE SPACES TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GSI-FLD TO WSS-TIP-CGTA
               MOVE GDG-STP-CGTA IN GSI-FLD TO WSS-STP-CGTA
               MOVE WSS-COD-CGTA TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GSI-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GSI-FLD.
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GSI-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GSI-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GSI-FLD.
      *MHM-FIN 23-OCT-2003
      *MHM-FIN 25-JUL-2003
      *>>>>
*% END
      *>>>>
*% END
