*% FRM = 'GSE'
*% REG = 'GSE'
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF GSE_CAI_GTIA
      *<<<< GSE_CAI_GTIA
              IF GSE-CAI-GTIA IN GSE-FLD NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-GSE-CAI-GTIA.
      *>>>>
*% END
*% IF FIN_PUT_GSE_GSE
      *<<<< FIN_PUT_GSE_GSE
      *MHM-INI 29-OCT-2003
           MOVE GSE-CIC-UING IN GSE TO CMA-CIC-UING IN CMA-VARI.
      *MHM-FIN 29-OCT-2003
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-CGTA IN GSE-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'AUX'                   TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-CGTA IN GSE-FLD TO WSS-TIP-CGTA IN WSS-VARI
               MOVE GDG-STP-CGTA IN GSE-FLD TO WSS-STP-CGTA IN WSS-VARI
               MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-CGTA IN GSE-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GSE-FLD.
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GSE-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GSE-FLD.
      *MHM-FIN 23-OCT-2003
*% IF GEN_BCI
      *<<<< GEN_BCI
      *PVG INI 15-OCT-2003 VALIDACION INDICADOR UCG
           IF SCR-CMND = 'CON' AND
              TAB-COD-DAT1 IN TAB(2) = 'A'
              MOVE 'S' TO WSS-IND-AREN IN WSS-VARI.
      *PVG FIN 15-OCT-2003
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-ICCS IN GSE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'CSE ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-ICCS IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ICCS IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ICCS IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-CORS IN GSE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'SEG ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-CORS IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CORS IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD.

      *PVG INI 14-OCT-2003
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-ESTA IN GSE-FLD > SPACES
               MOVE 'GAR'                   TO TAB-COD-SIST
               MOVE 'ESS '                  TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-ESTA IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-ESTA IN GSE-FLD
           ELSE
               MOVE SPACES                  TO FRM-GLS-ESTA IN GSE-FLD.
      *PVG FIN 14-OCT-2003
      *MHM-INI 7-OCT-2003
           IF SCR-CMND NOT = 'CON'
               GO TO CNT-PUT-GSE-GSE.
      *PVG INI 15-OCT-2003
           IF WSS-IND-AREN IN WSS-VARI NOT = 'S'
              MOVE 'NO APLICA RENOVAR' TO FRM-GLS-ESTD IN GSE-FLD
              GO TO CNT-PUT-GSE-GSE.            

           PERFORM GET-FHOY. 
      *PVG FIN 15-OCT-2003

           MOVE GSE-NUM-SVTS IN GSE-FLD TO WSS-NUM-SVTS IN WSS-VARI.
           MOVE GSE-NUM-AVTS IN GSE-FLD TO WSS-NUM-AVTS IN WSS-VARI.
           MOVE GSE-NUM-MVTS IN GSE-FLD TO WSS-NUM-MVTS IN WSS-VARI.
           MOVE GSE-NUM-DVTS IN GSE-FLD TO WSS-NUM-DVTS IN WSS-VARI.

           IF WSS-FEC-FVTS IN WSS-VARI > HOY-FHOY
               MOVE 'AL DIA' TO FRM-GLS-ESTD IN GSE-FLD
               GO TO CNT-PUT-GSE-GSE.

           IF GDG-IND-ECRS IN GDG = 'S'
               MOVE 'VENCIDA CON EXCEPCION COMERCIAL'
                                            TO FRM-GLS-ESTD IN GSE-FLD
               GO TO CNT-PUT-GSE-GSE.
              
           PERFORM EXC-NOR-SEG.
           IF WSS-IND-ENS1 = 'S'
              MOVE 'VENCIDA EXCP.NORMATIVA, AMPARA CREDITOS VIGENTES'
                                            TO FRM-GLS-ESTD IN GSE-FLD
           ELSE
           IF WSS-IND-ENS2 = 'S'
              MOVE 'VENCIDA EXCP.NORMATIVA, LINEAS DE CREDITOS VIGENTES'
                                            TO FRM-GLS-ESTD IN GSE-FLD
           ELSE
      *JRF-INI 20-OCT-2003
              MOVE 'SEGURO VENCIDO, NO ES NECESARIO RENOVAR            '
      *JRF-FIN 20-OCT-2003
                                            TO FRM-GLS-ESTD IN GSE-FLD.
       CNT-PUT-GSE-GSE.
      *MHM-FIN 7-OCT-2003
      *>>>>
*% ELSE
           IF GSE-COD-ICCS IN GSE-FLD > SPACES
               MOVE 'CSE'                    TO IVB-COD-TTAB IN IVB
               MOVE GSE-COD-ICCS IN GSE-FLD  TO IVB-COD-EIVB IN IVB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-IVB
               IF NOT FIO-STAT-OKS
                   MOVE 'CODICCSNEX' TO MSG-COD-MENS
                   MOVE 'GAR' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-GLS-ICCS IN GSE-FLD
               ELSE
                   MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-ICCS IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ICCS IN GSE-FLD.

           IF GSE-COD-CORS IN GSE-FLD > SPACES
               MOVE 'SEG'                    TO IVB-COD-TTAB IN IVB
               MOVE GSE-COD-CORS IN GSE-FLD  TO IVB-COD-EIVB IN IVB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-IVB
               IF NOT FIO-STAT-OKS
                   MOVE 'CODCORSNEX' TO MSG-COD-MENS
                   MOVE 'GAR' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-GLS-CORS IN GSE-FLD
               ELSE
                   MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-CORS IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD.

*% END
      *>>>>
*% END
*% IF FIN_UNP_IKY_GSE 
      *<<<< FIN_UNP_IKY_GSE 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = "ING"
               MOVE FRM-CPIM-AEY TO GSE-NUM-IGSE-ATR IN GSE-FLD
               MOVE FRM-CPIM-AEY TO GSE-NUM-IGSE-STP.
      *RRM-FIN 16-APR-2002
      *>>>>
*% END
*% IF FIN_GSE_FEC_FVSG AND NOT PGM_MCP
      *<<<< FIN_GSE_FEC_VIG_SEG
            IF GSE-FEC-FVSG IN GSE-FLD  NOT > SPACES
              MOVE ZEROES TO GSE-FEC-FVSG IN GSE-FLD.

      *VAL-FEC Validar Fecha
           MOVE GSE-FEC-FVSG IN GSE-FLD TO FEC-FECH.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GSE-FEC-FVSG IN GSE-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GSE-FEC-FVSG.
      *
      *>>>>
*% END
*% IF FIN_PUT_GDG_GSE
      *<<<< FIN_PUT_GDG_GSE

           MOVE GDG-CAI-GTIA IN GDG TO GVT-CAI-GTIA IN GVT.
           MOVE GDG-IIC-GTIA IN GDG TO GVT-IIC-GTIA IN GVT.
           MOVE GDG-COD-TSCN IN GDG TO GVT-COD-TASN IN GVT.

           MOVE 'GVT-KEY-IGVT'  TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-STAT TO PGM-STAT-GVT IN CMA-VARI.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO GAR-SGV-VPND IN CMA-VARI
               GO TO EXA-VEN-SEG.

           MOVE GVT-SGV-VPND IN GVT TO GAR-SGV-VPND IN CMA-VARI.
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE GVT-SGV-LTSN IN GVT TO GAR-SGV-LTSN IN CMA-VARI.
      *>>>>
*% END
      * Se determina si la tasacion esta vencida o no

*% FIN_EXA_VTO_TAS = 'EXA-VEN-SEG'
*% FEC_FVTA = 'WSS-FEC-FVTA'
*% FEC_DVTA = 'WSS-FEC-DVTA'
*% FEC_MVTA = 'WSS-FEC-MVTA'
*% FEC_AVTA = 'WSS-FEC-AVTA'
*% FEC_SVTA = 'WSS-FEC-SVTA'
*% FEC_FCTA = 'HOY-FHOY'
*% LEE_HOY = TRUE
*%! * Se determina si la tasacion esta vencida o no

           MOVE WSS-NO-EXA-VENC TO WSS-IND-EXAV.
      * Excluye los Subtipos de Garantia que no requieren Tasacion Efectiva
           IF TAG-NUM-PVTS IN TAG NOT > ZEROES
               GO TO EXA-VEN-SEG.

      * Excluye los Creditos Hipotecarios
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.
           MOVE ZEROES              TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF NOT FIO-STAT-OKS OR
              GDG-CAI-GTIA IN GDG NOT = GES-CAI-GTIA IN GES OR
              GDG-IIC-GTIA IN GDG NOT = GES-IIC-GTIA IN GES
               MOVE SPACES TO GES
               MOVE ZEROES TO GES-IIC-GTIA IN GES
                              GES-FEC-FVCR IN GES
                              GES-NUM-IGES IN GES
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM GAR-FIO-GES
               ELSE
                   NEXT SENTENCE
           ELSE 
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GES
               IF GES-COD-SIST IN GES > SPACES
                   MOVE 'TAB'                  TO TAB-COD-SIST
                   MOVE 'SIS'                  TO TAB-COD-TTAB IN TAB
                   MOVE GES-COD-SIST IN GES TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS = SPACES AND TAB-CIC-CTAB = 'HIP'
                       GO TO EXA-VEN-SEG.

           MOVE WSS-SI-EXA-VENC TO WSS-IND-EXAV.
           PERFORM GET-FHOY.

           IF TAG-COD-TPVT IN TAG = 'D'
              MOVE FEC-SUM-DIA TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NDIA
           ELSE
           IF TAG-COD-TPVT IN TAG = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NMES
           ELSE
           IF TAG-COD-TPVT IN TAG = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NANO.

           MOVE GVT-FEC-FTSN IN GVT TO FEC-FVLD.
           MOVE FEC-DVLD TO FEC-ITM1.
           MOVE FEC-MVLD TO FEC-ITM2.
           MOVE FEC-AVLD TO FEC-ITM4.
           MOVE FEC-SVLD TO FEC-ITM3.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF MSG-COD-MENS = SPACES
               MOVE FEC-ITM1 TO WSS-FEC-DVTA IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-FEC-MVTA IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-FEC-AVTA IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-FEC-SVTA IN WSS-VARI
           ELSE
               GO TO EXA-VEN-SEG.

      * Tasacion Vencida
           IF WSS-FEC-FVTA IN WSS-VARI > HOY-FHOY
               GO TO EXA-VEN-SEG.

      *JRF INI 20-OCT-2003
      *     MOVE 'GAR' TO MSG-COD-SIST.
      *     MOVE 'FECTSN<HOY' TO MSG-COD-MENS.
      *     PERFORM GET-MSG.
      *     MOVE MSG-GLS-DESC TO FRM-MEN1.
      *JRF FIN 20-OCT-20003
       EXA-VEN-SEG.
      *
      * Se determina si el seguro esta vencido o no
*% FIN_EXA_VTO_SEG = 'FIN-EXA-VEN-SEG'
*% LEE_GSE = FALSE
*% PGM_GSE = TRUE
*% FEC_FCSE = 'HOY-FHOY'
      * Excluye los Creditos Hipotecarios
           IF WSS-IND-EXAV = WSS-NO-EXA-VENC 
               GO TO FIN-EXA-VEN-SEG.

      * Seguro Vigente
           IF SCR-CCPP = 'ING'
               GO TO FIN-EXA-VEN-SEG.

           IF GSE-FEC-FVTS IN GSE > HOY-FHOY
               GO TO FIN-EXA-VEN-SEG.

      *PVG INI 15-OCT-2003 Segun JRF
      *    MOVE 'GAR' TO MSG-COD-SIST.
      *    MOVE 'FECSEG<HOY' TO MSG-COD-MENS.
      *    PERFORM GET-MSG.
      *    MOVE MSG-GLS-DESC TO FRM-MEN2.
      *PVG FIN 15-OCT-20003

       FIN-EXA-VEN-SEG.

      *>>>>
*% END
*% IF FIN_PUT_TAG_GSE
      *<<<< FIN_PUT_TAG_GSE
      *PVG INI 14-OCT-2003
           IF TAG-COD-TPOL IN TAG > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'POL'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-TPOL IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TPOL IN GSE-FLD
              ELSE
                 MOVE SPACES              TO FRM-GLS-TPOL IN GSE-FLD.
      *PVG FIN 14-OCT-2003
      *>>>>
*% END
*% IF GSE_SGV_SEGU
      *<<<< GSE_VAL_SEG
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-SGV-SEGU
           ELSE
*% IF PGM_ARG
      *<<<< PGM_ARG
               MOVE GSE-COD-VCMS IN GSE-FLD TO WSS-COD-PESO
               IF WSS-IND-TMON NOT = '0'
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
               IF GSE-COD-VCMS IN GSE-FLD = TAB-COD-CTAB IN TAB
      *>>>>
*% END
                  MOVE GSE-SGV-SEGU IN GSE-FLD TO
                                       PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                                        GSE-SGV-SEGU IN GSE-FLD.
      *
           IF NOT PGM-STAT-GVT-OKS
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'GSEGVTNEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-SGV-SEGU.  
      *
           MOVE  'TAB'                  TO TAB-COD-SIST.       
           MOVE  'NVA'                  TO TAB-COD-TTAB IN TAB.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GSE-FLD TO WSS-TIP-CGTA IN WSS-VARI.
           MOVE GDG-STP-CGTA IN GSE-FLD TO WSS-STP-CGTA IN WSS-VARI.
           MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GSE-FLD TO TAB-COD-CTAB IN TAB.
*% END
           PERFORM BUS-TAB.                                   
           IF MSG-COD-MENS NOT > SPACES                       
              GO TO FIN-VAL-GSE-SGV-SEGU.                      
      *
     
           IF GSE-COD-VCMS IN GSE-FLD = GDG-COD-VCAM IN GSE-FLD AND
              GSE-SGV-SEGU IN GSE-FLD < GAR-SGV-VPND IN CMA-VARI
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'GSESEG<LIQ' TO MSG-COD-MENS 
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-SGV-SEGU.  

      *
      *>>>>
*% END
*% IF INI_GSE_COD_ESTA
      *<<<< INI_GSE_COD_ESTA
           IF SCR-CMND = 'ING'
               MOVE '01' TO GSE-COD-ESTA IN GSE-FLD.
      *PVG INI 14-OCT-2003
           IF GSE-COD-ESTA IN GSE-FLD > SPACES
               MOVE 'GAR'                   TO TAB-COD-SIST
               MOVE 'ESS '                  TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-ESTA IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                  MOVE TAB-GLS-DESC IN TAB  TO FRM-GLS-ESTA IN GSE-FLD
               ELSE
                  MOVE SPACES               TO FRM-GLS-ESTA IN GSE-FLD.
      *PVG FIN 14-OCT-2003
      *>>>>
*% END
*% IF INI_GSE_FEC_FVTS
      *<<<< INI_GSE_FEC_VTO_SEG
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-FBLK-S TO FEC-FBLK.

           MOVE GSE-NUM-SVTS IN GSE-FLD TO FEC-SEC2.
           MOVE GSE-NUM-AVTS IN GSE-FLD TO FEC-AEC2.
           MOVE GSE-NUM-MVTS IN GSE-FLD TO FEC-MEC2.
           MOVE GSE-NUM-DVTS IN GSE-FLD TO FEC-DEC2.
      *>>>>
*% END
*% IF GSE_FEC_FVTS
      *<<<< GSE_FEC_VTO_SEG
      *Fecha vigencia
           MOVE GSE-NUM-SVSG IN GSE-FLD TO FEC-SEC1.
           MOVE GSE-NUM-AVSG IN GSE-FLD TO FEC-AEC1.
           MOVE GSE-NUM-MVSG IN GSE-FLD TO FEC-MEC1.
           MOVE GSE-NUM-DVSG IN GSE-FLD TO FEC-DEC1.
      *Fecha vencimiento
           MOVE GSE-NUM-SVTS IN GSE-FLD TO FEC-SEC2.
           MOVE GSE-NUM-AVTS IN GSE-FLD TO FEC-AEC2.
           MOVE GSE-NUM-MVTS IN GSE-FLD TO FEC-MEC2.
           MOVE GSE-NUM-DVTS IN GSE-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'VTO<=VIG' TO MSG-COD-MENS
               GO TO ERR-VAL-FEC-FVTS.

           GO TO FIN-VAL-GSE-FEC-FVTS.

       ERR-VAL-FEC-FVTS.
           MOVE 'GAR'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% LBL = ''
*% IF GSE_IND_ENDS
      *<<<< GSE_IND_ENDS
      *PVG INI 14-OCT-2003
           IF SCR-CMND = 'ING'
              MOVE 'S' TO GSE-IND-ENDS IN GSE-FLD.
      *PVG FIN 14-OCT-2003
*% IF FMT_CHI
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GSE-IND-ENDS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GSE-IND-ENDS.
      *>>>>
*% ELSE
           IF NOT (GSE-IND-ENDS IN GSE-FLD = 'S' OR 'N')
               MOVE 'DEBE SER S o N ' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
*% END
      *>>>>
*% END
*% IF GSE_IND_PCUO
      *<<<< GSE_IND_PCUO
*% IF FMT_CHI
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GSE-IND-PCUO IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GSE-IND-PCUO.
      *>>>>
*% ELSE
           IF NOT (GSE-IND-PCUO IN GSE-FLD = 'S' OR 'N')
               MOVE 'DEBE SER S o N ' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
*% END
      *>>>>
*% END
*% IF GSE_NUM_CUOT
      *<<<< GSE_NUM_CUOT
      *PVG INI 14-OCT-2003
           IF GSE-IND-PCUO IN GSE-FLD = 'N'
              MOVE ZEROES TO GSE-NUM-CUOT IN GSE-FLD.
           IF GSE-IND-PCUO IN GSE-FLD = 'S' AND
              GSE-NUM-CUOT IN GSE-FLD NOT > ZEROES
              MOVE 'GAR'          TO MSG-COD-SIST
              MOVE 'GSO NCUOOBLI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE FRM-POS-CURS TO GSE-NUM-CUOT-LEN IN GSE-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *PVG FIN 14-OCT-2003
      *>>>>
*% END
*% IF GSE_COD_ICCS
      *<<<< GSE_COD_ICCS
*% IF GEN_BCI
      *<<<< GEN_BCI
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CSE ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-ICCS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-ICCS IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ICCS IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ICCS IN GSE-FLD.
      *>>>>
*% ELSE
           MOVE 'CSE'                    TO IVB-COD-TTAB IN IVB.
           MOVE GSE-COD-ICCS IN GSE-FLD  TO IVB-COD-EIVB IN IVB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-IVB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODICCSNEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-COD-ICCS
           ELSE
               IF IVB-IND-VIGE IN IVB NOT = 'S'
                  MOVE 'COD    NVG' TO MSG-COD-MENS
                  MOVE 'GNS' TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                  MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-ICCS IN GSE-FLD.
      *<<<<
*% END
      *<<<<
*% END
*% IF GSE_COD_CORS
      *<<<< GSE_COD_CORS
*% IF GEN_BCI
      *<<<< GEN_BCI
           IF GSE-COD-RTSE IN GSE-FLD NOT = '3'
               MOVE SPACES TO GSE-COD-CORS IN GSE-FLD
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD
               GO TO FIN-VAL-GSE-COD-CORS.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'SEG ' TO TAB-COD-TTAB IN TAB.
           MOVE GSE-COD-CORS IN GSE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GSE-COD-CORS IN GSE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CORS IN GSE-FLD.
      *>>>>
*% ELSE
           IF GSE-COD-CORS IN GSE-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-CORS IN GSE-FLD
              GO TO FIN-VAL-GSE-COD-CORS.
           MOVE 'SEG'                    TO IVB-COD-TTAB IN IVB.
           MOVE GSE-COD-CORS IN GSE-FLD  TO IVB-COD-EIVB IN IVB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-IVB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODCORSNEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSE-COD-CORS
           ELSE
               IF IVB-IND-VIGE IN IVB NOT = 'S'
                  MOVE 'COD    NVG' TO MSG-COD-MENS
                  MOVE 'GNS' TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                  MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-CORS IN GSE-FLD.
      *>>>>
*% END
      *>>>>
*% END
*% IF VAL_CON_FLD_GSE
      *<<<< VAL_CON_FLD_GSE
           IF NOT PGM-STAT-GVT-OKS
               MOVE 'GSEGVTNEX' TO MSG-COD-MENS
           ELSE
           IF GSE-COD-VCMS IN GSE-FLD = GDG-COD-VCAM IN GSE-FLD AND
              GSE-SGV-SEGU IN GSE-FLD < GAR-SGV-LTSN IN CMA-VARI
               MOVE 'GSESEG<LIQ' TO MSG-COD-MENS.
      *>>>>
*% END
*% IF INI_GSE_VAL_MPRI
      *<<<< INI_GSE_VAL_MPRI
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GSE-VAL-MPRI IN GSE-FLD NOT > ZEROES
               GO TO FIN-VAL-GSE-VAL-MPRI.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF INI_GSE_NUM_CUOT
      *<<<< INI_GSE_NUM_CUOT
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GSE-NUM-CUOT IN GSE-FLD NOT > ZEROES
               GO TO FIN-VAL-GSE-NUM-CUOT.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
