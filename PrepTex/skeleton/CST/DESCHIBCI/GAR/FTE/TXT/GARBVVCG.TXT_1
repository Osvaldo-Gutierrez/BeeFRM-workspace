      * VALIDA CONSISTENCIA GENERAL DE UNA GARANTIA
      * Subrutina Pone Estado Garantia Completa
      * Este programa es invocado desde cualquier programa de actualizac
      *   de garantias, y su funcion es chequear que la gtia tenga ingre
      *   las entidades (obligatorias y opcionales) que corresponde segu
      *   la tabla TAG. Si tiene entidades que no corresponde, ellas se
      *   eliminan. Tambien graba registros GMO para cada entidad
      *   ingresada, que corresponde.
      
      * Si hay un error devuelve msg-cod-mens con el codigo del mensaje
      * El error se maneja en programa llamador
      * Marca GDG-IND-GTAC EN GDG.
      
       VAL-CON-GAR SECTION.
       INI-VAL-CON-GAR.
           MOVE VCG-CAI-GTIA TO GDG-CAI-GTIA IN GDG.
           MOVE VCG-IIC-GTIA TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
                MOVE "GDG    NEX" TO MSG-COD-MENS.
      
           MOVE "GAR"         TO  SCR-SIST.
           IF MSG-COD-MENS > SPACES
               GO TO EXT-VAL-CON-GAR.
      
           MOVE ZEROES TO GMO-NUM-IMOV IN GMO.
      
           IF GDG-IND-GTAC IN GDG = "S"
               MOVE "GDG    AGAYA" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
      
           IF GDG-IND-EST1 IN GDG < "05" OR
              GDG-IND-EST1 IN GDG NOT < "20"
              MOVE "GAR    NOVIG" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           MOVE GDG-COD-TOPE IN GDG TO TAG-COD-TOPE IN TAG.
           MOVE GDG-COD-SOPE IN GDG TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE "TAG    NEX" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
           PERFORM GET-FHOY.
           IF GDG-FEC-FVTO IN GDG NOT > HOY-FHOY
              MOVE "FVTO<=FING"   TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           MOVE "TAB"               TO TAB-COD-SIST.
           MOVE "GTA"               TO TAB-COD-TTAB IN TAB.
           MOVE TAG-COD-AGTA IN TAG TO TAB-COD-CTAB IN TAB.
           MOVE TAB-COD-SIST TO FIO-SIST.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE "COD    NEX" TO MSG-COD-MENS
               MOVE "GNS" TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-ABRV TO TAB-GLS-ABRV IN TAB
               MOVE MSG-GLS-DCOR TO TAB-GLS-DCOR IN TAB
               MOVE MSG-GLS-DESC TO TAB-GLS-DESC IN TAB
               MOVE "TIPSUBTNEX" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR
           ELSE
               MOVE TAB-CIC-CTAB IN TAB TO VVCG-TGAR.
      *----------------------------------------------*
           IF GDG-COD-LGTA IN GDG = "E"
               MOVE "S" TO TAG-IND-EGES IN TAG
           ELSE
               MOVE "N" TO TAG-IND-EGES IN TAG.
      *----------------------------------------------*
      
      *    IF GDG-COD-GGTA IN GDG > "1"
               MOVE "S" TO TAG-IND-EGAP IN TAG.
      *    ELSE
      *        MOVE "N" TO TAG-IND-EGAP IN TAG.
      
      *----------------------------------------------*
      
           IF GDG-IND-INOB IN GDG = "S"
               MOVE "S" TO TAG-IND-EGIN IN TAG
           ELSE
               MOVE "N" TO TAG-IND-EGIN IN TAG.
      *----------------------------------------------*
      
           MOVE "1" TO GMO-COD-MOVI IN GMO.
      
           IF TAG-IND-EGAP IN TAG = "S" AND
              GDG-IND-EGAP IN GDG NOT = "S"
              MOVE "GAP    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           IF GDG-COD-GGTA IN GDG > "1"
               PERFORM VAL-GAP
               IF MSG-COD-MENS > SPACES
                  GO TO EXT-VAL-CON-GAR.
      
           PERFORM VAL-GDD.
           IF MSG-COD-MENS > SPACES
               GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGDO IN TAG = "S" AND
              GDG-IND-EGDO IN GDG NOT = "S"
              MOVE "GDO    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGDP IN TAG = "S" AND
              GDG-IND-EGDP IN GDG NOT = "S"
              MOVE "GDP    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGES IN TAG = "S" AND
              GDG-IND-EGES IN GDG NOT = "S"
               MOVE "GES    NEX" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGIN IN TAG = "S" AND
              GDG-IND-EGIN IN GDG NOT = "S"
              MOVE "GIN    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGLE IN TAG = "S" AND
              GDG-IND-EGLE IN GDG NOT = "S"
              MOVE "GLE    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGSE IN TAG = "S" AND
              GDG-IND-EGSE IN GDG NOT = "S"
               MOVE "GSE    NEX" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGSE IN TAG NOT = "S"
              GO TO FIN-EGSE.
      
           MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE.
           MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE.
           MOVE ZEROES              TO GSE-NUM-IGSE IN GSE.
           MOVE FIO-GET-NLS TO FIO-CMND
           PERFORM GAR-FIO-GSE
           IF NOT ( FIO-STAT-OKS AND
                    GDG-CAI-GTIA IN GDG = GSE-CAI-GTIA IN GSE AND
                    GDG-IIC-GTIA IN GDG = GSE-IIC-GTIA IN GSE    )
              MOVE "GSE    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
       LUP-EGSE.
            IF NOT ( FIO-STAT-OKS AND
                     GDG-CAI-GTIA IN GDG = GSE-CAI-GTIA IN GSE AND
                     GDG-IIC-GTIA IN GDG = GSE-IIC-GTIA IN GSE    )
               MOVE "00" TO FIO-STAT
               GO TO FIN-EGSE.
      
            IF GSE-FEC-FVTS IN GSE < HOY-FHOY
               MOVE "GSE    VEN" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
            MOVE FIO-GET-NXT TO FIO-CMND.
            PERFORM GAR-FIO-GSE.
            GO TO LUP-EGSE.
      
       FIN-EGSE.
      
      *----------------------------------------------*
           IF TAG-IND-EGSI IN TAG = "S" AND
              GDG-IND-EGSI IN GDG NOT = "S"
               MOVE "GSI    NEX" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGTP IN TAG = "S" AND
              GDG-IND-EGTP IN GDG NOT = "S"
              MOVE "GTP    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGUB IN TAG = "S" AND
              GDG-IND-EGUB IN GDG NOT = "S"
              MOVE "GUB    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGUB IN TAG = "S" AND
              GDG-IND-EGUB IN GDG NOT = "S"
              MOVE "GUB    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGIM IN TAG = "S" AND
              GDG-IND-EGIM IN GDG NOT = "S"
              MOVE "GIM    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGVE IN TAG = "S" AND
              GDG-IND-EGVE IN GDG NOT = "S"
              MOVE "GVE    NEX" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      *---------------------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GVT-CAI-GTIA IN GVT.
           MOVE GDG-IIC-GTIA IN GDG TO GVT-IIC-GTIA IN GVT.
           MOVE GDG-COD-TSCN IN GDG TO GVT-COD-TASN IN GVT.
           MOVE "GVT-KEY-IGVT" TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           IF NOT FIO-STAT-OKS
               MOVE "GVT    NEX" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGVT IN TAG = "S" AND
              GDG-IND-EGVT IN GDG NOT = "S"
               IF GVT-MSC-STAT IN GVT NOT = "A"
                   MOVE "ATANO" TO MSG-COD-MENS
                   GO TO EXT-VAL-CON-GAR
               ELSE
                   MOVE "PGM    ERR" TO MSG-COD-MENS
                   GO TO EXT-VAL-CON-GAR.
      
           IF ( GDG-IND-EGVT IN GDG = "S" AND
                GDG-IND-EGTP IN GDG NOT  = "S" AND
                GVT-MSC-STAT IN GVT NOT = "A"           )
              MOVE "GTP    NOING" TO MSG-COD-MENS
              GO TO EXT-VAL-CON-GAR.
      
      *Verifica que documento no este ya registrado
      *como garantia.
           IF VVCG-TGAR NOT = "DOCCBR" AND "DOCCEX" AND
                   "DOCDPN" AND "DOCFCC" AND "DOCVAL"
               GO TO GENERA-GMO.
      
           MOVE GDG-CAI-GTIA IN GDG TO VDO-CAI-GTIA IN VDO-VARI.
           MOVE GDG-IIC-GTIA IN GDG TO VDO-IIC-GTIA IN VDO-VARI.
      
           MOVE GDG-KEY-IGDG IN GDG TO GDO-KEY-IGDO IN GDO.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
           IF NOT FIO-STAT-OKS
               MOVE "GDO    NEX" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
      
           MOVE GDO-COD-DOCU IN GDO TO VDO-COD-DOCU IN VDO-VARI.
           MOVE "GARPPVCG"          TO VDO-PROG IN VDO-VARI.
           PERFORM GAR-PRO-VDO.
           IF MSG-COD-MENS > SPACES
              GO TO EXT-VAL-CON-GAR.
      
      * GENERA GMO DE GDG
       GENERA-GMO.
           PERFORM VCG-INI-GMO.
           MOVE "GDG001" TO GMO-COD-CMPO IN GMO.
           MOVE "1"      TO GMO-COD-MOVI IN GMO.
           MOVE "N"      TO GMO-IND-VALO IN GMO.
           MOVE "S"      TO GMO-IND-CLVE IN GMO.
           MOVE GDG-IND-EST1 IN GDG TO GMO-COD-NCLV IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               MOVE "GMO    PUT" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE "GDG   KEYUPD" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGVT IN TAG = "N" AND
              GDG-IND-EGVT IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGVT IN GDG
               PERFORM ELI-GVT
           ELSE
           IF GDG-IND-EGVT IN GDG = "S"
               PERFORM VCG-ESC-GMO-GVT
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR
               ELSE
                   NEXT SENTENCE
           ELSE
               GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGDD IN TAG = "N" AND
              GDG-IND-EGDD IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGDD IN GDG
               PERFORM ELI-GDD
           ELSE
           IF GDG-IND-EGDD IN GDG = "S"
               PERFORM VCG-ESC-GMO-GDD
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGES IN TAG = "N" AND
              GDG-IND-EGES IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGES IN GDG
               PERFORM ELI-GES
           ELSE
           IF GDG-IND-EGES IN GDG = "S"
               PERFORM VCG-ESC-GMO-GES
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGLE IN TAG = "N" AND
              GDG-IND-EGLE IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGLE IN GDG
               PERFORM ELI-GLE
           ELSE
           IF GDG-IND-EGLE IN GDG = "S"
               PERFORM VCG-ESC-GMO-GLE
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGDO IN TAG = "N" AND
              GDG-IND-EGDO IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGDO IN GDG
               PERFORM ELI-GDO
           ELSE
           IF GDG-IND-EGDO IN GDG = "S"
               PERFORM VCG-ESC-GMO-GDO
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGSE IN TAG = "N" AND
              GDG-IND-EGSE IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGSE IN GDG
               PERFORM ELI-GSE
           ELSE
           IF GDG-IND-EGSE IN GDG = "S"
               PERFORM VCG-ESC-GMO-GSE
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGTP IN TAG = "N" AND
              GDG-IND-EGTP IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGTP IN GDG
               PERFORM ELI-GTP
           ELSE
           IF GDG-IND-EGTP IN GDG = "S"
               PERFORM VCG-ESC-GMO-GTP
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
            IF TAG-IND-EGUB IN TAG = "N" AND
               GDG-IND-EGUB IN GDG = "S"
                MOVE SPACES TO GDG-IND-EGUB IN GDG
               PERFORM ELI-GUB
           ELSE
           IF GDG-IND-EGUB IN GDG = "S"
               PERFORM VCG-ESC-GMO-GUB
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGAP IN TAG = "N" AND
              GDG-IND-EGAP IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGAP IN GDG
               PERFORM ELI-GAP
           ELSE
           IF GDG-IND-EGAP IN GDG = "S"
               PERFORM VCG-ESC-GMO-GAP
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGIN IN TAG = "N" AND
              GDG-IND-EGIN IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGIN IN GDG
               PERFORM ELI-GIN
           ELSE
           IF GDG-IND-EGIN IN GDG = "S"
               PERFORM VCG-ESC-GMO-GIN
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGSI IN TAG = "N" AND
              GDG-IND-EGSI IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGSI IN GDG
               PERFORM ELI-GSI
           ELSE
           IF GDG-IND-EGSI IN GDG = "S"
               PERFORM VCG-ESC-GMO-GSI
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGDP IN TAG = "N" AND
              GDG-IND-EGDP IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGDP IN GDG
               PERFORM ELI-GDP
           ELSE
           IF GDG-IND-EGDP IN GDG = "S"
               PERFORM VCG-ESC-GMO-GDP
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-VAL-CON-GAR.
      
           IF TAG-IND-EGIM IN TAG = "N" AND
              GDG-IND-EGIM IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGIM IN GDG
               PERFORM ELI-GIM.
      
           IF TAG-IND-EGVE IN TAG = "N" AND
              GDG-IND-EGVE IN GDG = "S"
               MOVE SPACES TO GDG-IND-EGVE IN GDG
               PERFORM ELI-GVE.
      
           MOVE HOY-FHOY TO GDG-FEC-FING IN GDG.
           MOVE "I"      TO GDG-MSC-TACC IN GDG.
           MOVE "10"     TO GDG-IND-EST1 IN GDG.
           MOVE "S"      TO GDG-IND-GTAC IN GDG.
           MOVE "A"      TO GDG-MSC-STAT IN GDG.
           MOVE HOY-FHOY TO GDG-FEC-FEST IN GDG.
           MOVE "S"      TO GDG-IND-EGDD IN GDG.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE "GDG    MOD" TO MSG-COD-MENS
               GO TO EXT-VAL-CON-GAR.
      
       EXT-VAL-CON-GAR.
           PERFORM FIN.
       FIN-VAL-CON-GAR.
           EXIT.
      
       INI-GAR SECTION.
       INI-INI-GAR.
       FIN-INI-GAR.
           EXIT.
      
       FIN SECTION.
       INI-FIN.
            MOVE MSG-COD-MENS TO VCG-MENS.
       FIN-FIN.
           EXIT.
      
       VAL-GAP SECTION.
       INI-VAL-GAP.
           MOVE GDG-COD-GGTA IN GDG TO VVCG-COD-GRA.
           MOVE GDG-CAI-GTIA IN GDG TO GAP-CAI-GTIA IN GAP.
           MOVE GDG-IIC-GTIA IN GDG TO GAP-IIC-GTIA IN GAP.
           MOVE VVCG-COD-PRD-ACR    TO GAP-COD-PACR IN GAP.
           MOVE VVCG-COD-GRA        TO VVCG-COD-PRD-ACR.
      
      
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF FIO-STAT-OKS
               MOVE "GRAINV" TO MSG-COD-MENS
               GO TO FIN-VAL-GAP.
      
           SUBTRACT 1 FROM VVCG-COD-PRD-ACR.
           MOVE VVCG-COD-PRD-ACR TO GAP-COD-PACR IN GAP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF NOT FIO-STAT-OKS
               MOVE "GRAINV" TO MSG-COD-MENS
               GO TO FIN-VAL-GAP.
       FIN-VAL-GAP.
           EXIT.
      
       VCG-ESC-GMO-GDD SECTION.
       INI-VCG-ESC-GMO-GDD.
           PERFORM VCG-INI-GMO.
           MOVE "GDD001"   TO GMO-COD-CMPO IN GMO.
           MOVE "N"        TO GMO-IND-VALO IN GMO.
           MOVE "N"        TO GMO-IND-CLVE IN GMO.
      *-------------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.
           MOVE 1 TO VVCG-IMAL.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-VCG-ESC-GMO-GDD.
           MOVE "GDD-KEY-AGDD" TO FIO-AKEY.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GDD-CAI-GTIA IN GDD AND
              GDG-IIC-GTIA IN GDG = GDD-IIC-GTIA IN GDD
               MOVE 0 TO VVCG-IMAL
               MOVE GDD-KEY-IGDD IN GDD TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GDD
               ELSE
                   MOVE "GMO    PUT" TO MSG-COD-MENS
           ELSE
               IF VVCG-IMAL > 0
                   MOVE "GDD    NEX" TO MSG-COD-MENS.
       FIN-VCG-ESC-GMO-GDD.
           EXIT.
      
       VCG-ESC-GMO-GES SECTION.
       INI-VCG-ESC-GMO-GES.
           PERFORM VCG-INI-GMO.
           MOVE "GES000"   TO GMO-COD-CMPO IN GMO.
           MOVE "N"        TO GMO-IND-VALO IN GMO.
           MOVE "N"        TO GMO-IND-CLVE IN GMO.
      *-------------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.
           MOVE ZEROES              TO GES-NUM-IGES IN GES.
           MOVE "GES-KEY-IGES" TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO VVCG-IMAL.
       LUP-VCG-ESC-GMO-GES.
           PERFORM GAR-FIO-GES.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GES-CAI-GTIA IN GES AND
              GDG-IIC-GTIA IN GDG = GES-IIC-GTIA IN GES
               MOVE 0 TO VVCG-IMAL
               MOVE GES-NUM-IGES IN GES TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GES
               ELSE
                   MOVE "GMO    PUT" TO MSG-COD-MENS
           ELSE
               IF VVCG-IMAL > 0
                   MOVE "GES    NEX" TO MSG-COD-MENS.
       FIN-VCG-ESC-GMO-GES.
           EXIT.
      
       VCG-ESC-GMO-GLE SECTION.
       INI-VCG-ESC-GMO-GLE.
           PERFORM VCG-INI-GMO.
           MOVE "GLE000"       TO GMO-COD-CMPO IN GMO.
           MOVE "N"            TO GMO-IND-VALO IN GMO.
           MOVE "N"            TO GMO-IND-CLVE IN GMO.
      *----------------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GLE-CAI-GTIA IN GLE.
           MOVE GDG-IIC-GTIA IN GDG TO GLE-IIC-GTIA IN GLE.
           MOVE ZEROES              TO GLE-COD-PACR IN GLE.
           MOVE "GLE-KEY-IGLE" TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO VVCG-IMAL.
       LUP-VCG-ESC-GMO-GLE.
           PERFORM GAR-FIO-GLE.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GLE-CAI-GTIA IN GLE AND
              GDG-IIC-GTIA IN GDG = GLE-IIC-GTIA IN GLE
               MOVE 0 TO VVCG-IMAL
               MOVE GLE-COD-PACR IN GLE TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GLE
               ELSE
                   MOVE "GMO    PUT" TO MSG-COD-MENS
           ELSE
               IF VVCG-IMAL > 0
                   MOVE "GLE    NEX" TO MSG-COD-MENS.
      
       FIN-VCG-ESC-GMO-GLE.
           EXIT.
      
       VCG-ESC-GMO-GDO SECTION.
       INI-VCG-ESC-GMO-GDO.
       FIN-VCG-ESC-GMO-GDO.
           EXIT.
      
       VCG-ESC-GMO-GSE SECTION.
       INI-VCG-ESC-GMO-GSE.
           PERFORM VCG-INI-GMO.
           MOVE "GSE000" TO GMO-COD-CMPO IN GMO.
           MOVE "N"      TO GMO-IND-VALO IN GMO.
           MOVE "N"      TO GMO-IND-CLVE IN GMO.
      *----------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE.
           MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE.
           MOVE ZEROES              TO GSE-NUM-IGSE IN GSE.
           MOVE "GSE-KEY-IGSE" TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO VVCG-IMAL.
       LUP-VCG-ESC-GMO-GSE.
           PERFORM GAR-FIO-GSE.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GSE-CAI-GTIA IN GSE AND
              GDG-IIC-GTIA IN GDG = GSE-IIC-GTIA IN GSE
               MOVE 0 TO VVCG-IMAL
               MOVE GSE-NUM-IGSE IN GSE TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GSE
               ELSE
                   MOVE "GMO    PUT" TO MSG-COD-MENS
           ELSE
               IF VVCG-IMAL > 0
                   MOVE "GSE    NEX" TO MSG-COD-MENS.
      
       FIN-VCG-ESC-GMO-GSE.
           EXIT.
      
       VCG-ESC-GMO-GVT SECTION.
       INI-VCG-ESC-GMO-GVT.
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM VCG-INI-GMO.
              MOVE GVT-COD-TASN IN GVT TO GMO-NUM-TASN IN GMO.
           MOVE "GVT001"            TO GMO-COD-CMPO IN GMO.
           MOVE GVT-SGV-LTSN IN GVT TO GMO-SGV-NCMP IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-VCG-ESC-GMO-GVT.
      
           MOVE "GVT002"            TO GMO-COD-CMPO IN GMO.
           MOVE GVT-SGV-VCTS IN GVT TO GMO-SGV-NCMP IN GMO.
           ADD 1                    TO GMO-NUM-IMOV IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-VCG-ESC-GMO-GVT.
      
           MOVE "GVT003"            TO GMO-COD-CMPO IN GMO.
           MOVE GVT-SGV-VPND IN GVT TO GMO-SGV-NCMP IN GMO.
           ADD 1                    TO GMO-NUM-IMOV IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-VCG-ESC-GMO-GVT.
      
           MOVE "GVT005"            TO GMO-COD-CMPO IN GMO.
           MOVE GVT-FEC-FTSN IN GVT TO GMO-GLS-NCMP IN GMO.
           MOVE GVT-SGV-VGAS IN GVT TO GMO-SGV-NCMP IN GMO.
           ADD 1                    TO GMO-NUM-IMOV IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-VCG-ESC-GMO-GVT.
      
           MOVE "GVT004"            TO GMO-COD-CMPO IN GMO.
           MOVE "N"                 TO GMO-IND-VALO IN GMO.
           MOVE ZEROES              TO GMO-SGV-CMPA IN GMO.
           MOVE ZEROES              TO GMO-SGV-NCMP IN GMO.
           MOVE GVT-FEC-FTSN IN GVT TO GMO-GLS-NCMP IN GMO.
           ADD 1                    TO GMO-NUM-IMOV IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-VCG-ESC-GMO-GVT.
           GO TO FIN-VCG-ESC-GMO-GVT.
      
       ERR-VCG-ESC-GMO-GVT.
           MOVE "GMO    PUT" TO MSG-COD-MENS.
       FIN-VCG-ESC-GMO-GVT.
           EXIT.
      
       VCG-ESC-GMO-GTP SECTION.
       INI-VCG-ESC-GMO-GTP.
           PERFORM VCG-INI-GMO.
           MOVE "N"      TO GMO-IND-VALO IN GMO.
           MOVE "N"      TO GMO-IND-CLVE IN GMO.
           MOVE "GTP001" TO GMO-COD-CMPO IN GMO.
      *---------------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GTP-CAI-GTIA IN GTP.
           MOVE GDG-IIC-GTIA IN GDG TO GTP-IIC-GTIA IN GTP.
           MOVE GDG-COD-TSCN IN GDG TO GTP-NUM-ITSN IN GTP.
           MOVE SPACES              TO GTP-COD-IITS IN GTP.
           MOVE "GTP-KEY-IGTP" TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO VVCG-IMAL.
       LUP-VCG-ESC-GMO-GTP.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GTP-CAI-GTIA IN GTP AND
              GDG-IIC-GTIA IN GDG = GTP-IIC-GTIA IN GTP
               MOVE 0 TO VVCG-IMAL
               MOVE GTP-COD-IITS IN GTP TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GTP
               ELSE
                   MOVE "GMO    PUT" TO MSG-COD-MENS
           ELSE
               IF VVCG-IMAL > 0
                   MOVE "GTP    NEX" TO MSG-COD-MENS.
       FIN-VCG-ESC-GMO-GTP.
           EXIT.
      
       VCG-ESC-GMO-GUB SECTION.
       INI-VCG-ESC-GMO-GUB.
           PERFORM VCG-INI-GMO.
           MOVE "GUB000" TO GMO-COD-CMPO IN GMO.
           MOVE "N"      TO GMO-IND-VALO IN GMO.
           MOVE "N"      TO GMO-IND-CLVE IN GMO.
      *------------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GUB-CAI-GTIA IN GUB.
           MOVE GDG-IIC-GTIA IN GDG TO GUB-IIC-GTIA IN GUB.
           MOVE "GUB-KEY-IGUB"      TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GUB.
           IF NOT FIO-STAT-OKS
              MOVE "GUB    NEX" TO MSG-COD-MENS
              GO TO FIN-VCG-ESC-GMO-GUB.
      
           MOVE "DATOS DE UBICACION" TO GMO-GLS-NCMP IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
              MOVE "GMO    PUT" TO MSG-COD-MENS.
       FIN-VCG-ESC-GMO-GUB.
           EXIT.
      
       VCG-ESC-GMO-GAP SECTION.
       INI-VCG-ESC-GMO-GAP.
           PERFORM VCG-INI-GMO.
           MOVE "N"      TO GMO-IND-VALO IN GMO.
           MOVE "N"      TO GMO-IND-CLVE IN GMO.
           MOVE "GAP001" TO GMO-COD-CMPO IN GMO.
      *-------------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GAP-CAI-GTIA IN GAP.
           MOVE GDG-IIC-GTIA IN GDG TO GAP-IIC-GTIA IN GAP.
           MOVE SPACES TO GAP-CIC-ICLI IN GAP.
           MOVE "GAP-KEY-IGAP" TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO VVCG-IMAL.
       LUP-VCG-ESC-GMO-GAP.
           PERFORM GAR-FIO-GAP.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GAP-CAI-GTIA IN GAP AND
              GDG-IIC-GTIA IN GDG = GAP-IIC-GTIA IN GAP
               MOVE 0 TO VVCG-IMAL
               MOVE GAP-CIC-ICLI IN GAP TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GAP
               ELSE
                   MOVE "GMO    PUT" TO MSG-COD-MENS
           ELSE
               IF VVCG-IMAL > 0
                   MOVE "GAP    NEX" TO MSG-COD-MENS.
       FIN-VCG-ESC-GMO-GAP.
           EXIT.
      
       VCG-ESC-GMO-GIN SECTION.
       INI-VCG-ESC-GMO-GIN.
           PERFORM VCG-INI-GMO.
           MOVE "GIN000" TO GMO-COD-CMPO IN GMO.
           MOVE "N"      TO GMO-IND-VALO IN GMO.
           MOVE "N"      TO GMO-IND-CLVE IN GMO.
      *----------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GIN-CAI-GTIA IN GIN.
           MOVE GDG-IIC-GTIA IN GDG TO GIN-IIC-GTIA IN GIN.
           MOVE ZEROES              TO GIN-NUM-IGIN IN GIN.
           MOVE "GIN-KEY-IGIN" TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO VVCG-IMAL.
       LUP-VCG-ESC-GMO-GIN.
           PERFORM GAR-FIO-GIN.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GIN-CAI-GTIA IN GIN AND
              GDG-IIC-GTIA IN GDG = GIN-IIC-GTIA IN GIN
               MOVE 0 TO VVCG-IMAL
               MOVE GIN-NUM-IGIN IN GIN TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GIN
               ELSE
                   MOVE "GMO    PUT" TO MSG-COD-MENS
           ELSE
               IF VVCG-IMAL > 0
                   MOVE "GIN    NEX" TO MSG-COD-MENS.
      
       FIN-VCG-ESC-GMO-GIN.
           EXIT.
      
       VCG-ESC-GMO-GDP SECTION.
       INI-VCG-ESC-GMO-GDP.
           PERFORM VCG-INI-GMO.
           MOVE "GDP000" TO GMO-COD-CMPO IN GMO.
           MOVE "N"      TO GMO-IND-VALO IN GMO.
           MOVE "N"      TO GMO-IND-CLVE IN GMO.
      *----------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GDP-CAI-GTIA IN GDP.
           MOVE GDG-IIC-GTIA IN GDG TO GDP-IIC-GTIA IN GDP.
           MOVE "GDP-KEY-IGDP" TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDP.
           IF NOT FIO-STAT-OKS
              MOVE "GDP    NEX" TO MSG-COD-MENS
              GO TO FIN-VCG-ESC-GMO-GDP.
      
           MOVE "DATOS DE DEPRECIACION" TO GMO-GLS-NCMP IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
              MOVE "GMO    PUT" TO MSG-COD-MENS.
       FIN-VCG-ESC-GMO-GDP.
           EXIT.
      
       VCG-ESC-GMO-GSI SECTION.
       INI-VCG-ESC-GMO-GSI.
       FIN-VCG-ESC-GMO-GSI.
           EXIT.
      
       VCG-INI-GMO SECTION.
       INI-VCG-INI-GMO.
           MOVE SPACES TO GMO-GLS-FLAG IN GMO.
           MOVE SPACES TO GMO-FEC-FMOV IN GMO.
           MOVE SPACES TO GMO-HRA-HMOV IN GMO.
           MOVE SPACES TO GMO-CAI-GTIA IN GMO.
           MOVE SPACES TO GMO-IIC-GTIA IN GMO.
            MOVE ZEROES TO GMO-NUM-TASN IN GMO.
           MOVE SPACES TO GMO-COD-CMPO IN GMO.
           MOVE SPACES TO GMO-IND-VALO IN GMO.
           MOVE SPACES TO GMO-IND-CLVE IN GMO.
           MOVE SPACES TO GMO-COD-CLVA IN GMO.
           MOVE SPACES TO GMO-GLS-CMPA IN GMO.
           MOVE ZEROES TO GMO-SGV-CMPA IN GMO.
           MOVE SPACES TO GMO-COD-NCLV IN GMO.
           MOVE SPACES TO GMO-GLS-NCMP IN GMO.
           MOVE ZEROES TO GMO-SGV-NCMP IN GMO.
           MOVE SPACES TO GMO-FEC-FING IN GMO.
           MOVE SPACES TO GMO-COD-TMOV IN GMO.
           MOVE SPACES TO GMO-GLS-DISP IN GMO.
      *---------------------------------------*
           MOVE GDG-CAI-GTIA IN GDG TO GMO-CAI-GTIA IN GMO.
           MOVE GDG-IIC-GTIA IN GDG TO GMO-IIC-GTIA IN GMO.
           MOVE GDG-COD-OFIC IN GDG TO GMO-COD-OFMV IN GMO.
      
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO GMO-FEC-FMOV IN GMO.
           MOVE HOY-HHOY TO GMO-HRA-HMOV IN GMO.
           MOVE VCG-OTRN TO GMO-TML-TMOV IN GMO.
           MOVE VCG-USER TO GMO-CIC-UING IN GMO.
           MOVE HOY-FHOY TO GMO-FEC-FING IN GMO.
           MOVE "S"      TO GMO-IND-VALO IN GMO.
           MOVE "N"      TO GMO-IND-CLVE IN GMO.
           MOVE SPACES   TO GMO-COD-CLVA IN GMO.
           MOVE SPACES   TO GMO-COD-NCLV IN GMO.
           MOVE ZEROES   TO GMO-SGV-CMPA IN GMO.
           MOVE ZEROES   TO GMO-SGV-NCMP IN GMO.
           MOVE SPACES   TO GMO-GLS-CMPA IN GMO.
           MOVE SPACES   TO GMO-GLS-NCMP IN GMO.
           MOVE "1"      TO GMO-COD-MOVI IN GMO.
           ADD 1         TO GMO-NUM-IMOV IN GMO.
      
       FIN-VCG-INI-GMO.
           EXIT.
      
       VAL-GDD SECTION.
       INI-VAL-GDD.
           MOVE SPACES              TO MSG-COD-MENS.
           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.
           MOVE "GDD-KEY-AGDD" TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
                    GDG-CAI-GTIA IN GDG = GDD-CAI-GTIA IN GDD AND
                    GDG-IIC-GTIA IN GDG = GDD-IIC-GTIA IN GDD )
               MOVE "GDD    NEX" TO MSG-COD-MENS
               GO TO BRW-VAL-GDD.
      
       LUP-VAL-GDD.
      
           IF GDD-IIC-DCLI IN GDD NOT > ZEROES OR
              GDD-IIC-DCLI IN GDD > "99999999"
               MOVE "IICICLI=0" TO MSG-COD-MENS
                GO TO BRW-VAL-GDD.
      
           MOVE "GDD-KEY-AGDD" TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
      
           IF NOT ( FIO-STAT-OKS AND
                    GDG-CAI-GTIA IN GDG = GDD-CAI-GTIA IN GDD AND
                    GDG-IIC-GTIA IN GDG = GDD-IIC-GTIA IN GDD )
               GO TO BRW-VAL-GDD.
           GO TO LUP-VAL-GDD.
       BRW-VAL-GDD.
           IF FIO-STAT-OKS
               MOVE "GDD-KEY-AGDD" TO FIO-AKEY
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GDD.
       FIN-VAL-GDD.
           EXIT.
