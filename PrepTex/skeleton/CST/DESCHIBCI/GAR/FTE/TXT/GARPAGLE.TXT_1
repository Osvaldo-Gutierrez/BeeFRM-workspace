*%! NO_TIENE_TIMESTAMP = TRUE
*% FRM = 'GLE'
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*%! IF NOT PGM_MCP
*% PGM_PTC = TRUE
*%! END
*% IF PGM_DTC AND PGM_UVS
*% IF INI_FIO AND PGM_DTC
      *<<<< INI_FIO
           PERFORM GNS-HDL-VSM.
      *>>>> END INI_FIO
*% END
*% END
*% IF EOF AND PGM_DTC
      *<<<< EOF
      *MHM-INI 23-OCT-2003
       COPY GNSBGCPT.
      *MHM-FIN 23-OCT-2003
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>> END EOF
*% END
*% IF NOT PGM_MCP
*%    ! Codigo adicional para Funcion GARPPVCG = PF5
*%    ! INCLUDE 'GARSRC:PFALL5.SRC'
*%    ! Codigo adicional para archivo
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 CMA-VARI.
              05 GAR-CAI-GTIA              PIC X(04).
              05 GAR-IIC-GTIA              PIC X(08).
              05 GAR-IND-GTAC              PIC X(01).
      *MHM-INI 29-OCT-2003
              05 CMA-CIC-UING              PIC X(12).
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF FIN_PGM_STAT
      *<<<< PGM_STAT
              05 PGM-STAT-GAP.
                 88 PGM-STAT-GAP-NUL    VALUE '  '.
                 07 PGM-STT1-GAP        VALUE '2' PIC X(01).
                    88 PGM-STAT-GAP-OKS VALUE '0'.
                 07 PGM-STT2-GAP        VALUE '3' PIC X(01).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
      * COPY TABBREST.
      * COPY TABBRCIU.
       COPY GARBRGVE.
       COPY GARBRGIM.
       COPY GARBRGDG.
       COPY GARBRGAP.
       COPY TABBRIVB.
       COPY GARBRTAG.
       COPY GARBRGSO.
       COPY GARWGVCG.
      *MHM-INI 23-OCT-2003
       COPY GNSWGCPT.
      *MHM-FIN 23-OCT-2003
*% IF PGM_MCP
       COPY GARBRGMO.
       COPY GARBRGVT.
       COPY GARBRGSE.
       COPY GARBRGDD.
       COPY GARBRGES.
       COPY GARBRGTP.
       COPY GARBRGIN.
       COPY GARBRGDP.
       COPY GARBRGSI.
       COPY GARBRGUB.
       COPY GARBRGDO.
       COPY GARWGVDO.
       COPY GARWVVCG.
*% END
*% IF PGM_PU
      *<<<< PGM_PU
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
*% IF PGM_MCP
       COPY GNSWRMSC.
*% END
      *>>>> 
*% END
*% IF PGM_PQ
      *<<<< PGM_PQ
       COPY USPC113.
      *>>>> 
*% END
*% IF (PGM_PQ) OR (PGM_MCP) OR (PGM_PU)
      *<<<< (PGM_PQ) OR (PGM_MCP) OR (PGM_PU)
       01  WSS-VARI.
           03 WSS-COD-CTAB.
              05 WSS-COD-CTAB1         PIC X(04).
              05 WSS-COD-CTAB2         PIC X(04).
              05 WSS-COD-CTAB3         PIC X(04).
              05 WSS-COD-CTAB4         PIC X(04).
           03 WSS-TIPO-DIV.
              05 WSS-TIPO                           PIC X(03).
	      05 WSS-DIV                            PIC X(03).     
           03 WSS-HOY-FHOY.
              05  WSS-SA-FHOY                       PIC 9(04).
              05  WSS-REST                          PIC 9(04).

      *MHM-INI 25-JUL-2003
           03 WSS-LOC-REG.
              05 WSS-COD-REG   VALUE SPACES             PIC X(02).
              05 WSS-COD-LOC   VALUE SPACES             PIC X(04).

           03 WSS-COD-CGTA.
              05 WSS-TIP-CGTA                       PIC X(03).
              05 WSS-STP-CGTA                       PIC X(03).
      *MHM-FIN 25-JUL-2003
      *MHM-INI 17-OCT-2003
           03 WSS-IND-SABG     VALUE SPACES         PIC X(01).
           03 WSS-FIO-STAT-BKP VALUE SPACES         PIC X(02).
      *MHM-FIN 17-OCT-2003
      *MHM-INI 23-OCT-2003
           03 WSS-GLS-CGTA.
              05 WSS-GLS-TOPE                   PIC X(40).
              05 WSS-GLS-SOPE                   PIC X(40).
      *MHM-FIN 23-OCT-2003

*% END
*% IF PGM_DTC
      *<<<< PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IVB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GAP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSO-REQA==.
*% END
*% IF PGM_VAX
      *<<<< PGM_VAX
           03 WSS-REG                          PIC X(03).
      *>>>>
*% END
      *>>>>
*% END
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
*% IF PGM_PQ
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-GLE
               PERFORM VAL-NUM-FLD-GLE.
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           PERFORM GNS-CLR-RQA.
*% END
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-GLE
               PERFORM VAL-NUM-FLD-GLE
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           PERFORM GNS-CLR-RQA.
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-GLE
               PERFORM VAL-NUM-FLD-GLE
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           PERFORM GNS-CLR-RQA.
      *>>>>
*% END
*% IF PFS_SCR_GKEY
      *<<<< PFS_SCR_GKEY
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF PFS_SCR_GFLD
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF5 ) )
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
           MOVE SPACES                  TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GLE-FLD TO WSS-TIPO-DIV IN WSS-VARI.
           IF  NOT ( WSS-TIPO IN WSS-VARI = 'HIP') AND
               NOT (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
                    GDG-COD-CGTA IN GLE-FLD < '000130')
              MOVE FRM-CPIM-AEY TO GLE-IND-LCUA-ATR IN GLE-FLD
              MOVE FRM-CPIM-AEY TO GLE-IND-LCUA-STP.
      *>>>>
*% END
      *>>>>
*% END
*% IF PGM_ARG
      *<<<< PGM_ARG
*% LARGO_MI_COMMAREA = 15
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
*% LARGO_MI_COMMAREA = 25
      *>>>>
*% END
*% IF INI_FIO AND PGM_VAX
      *<<<< INI_FIO AND PGM-VAX

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-TAG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-TAG.

      *>>>> INI_FIO
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      * Llama a Subrutina Validacion Consistencia Garantia
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM GAR-PRO-VCG
               GO TO FIN-FND-KEY.
      
*% FIN_BUS_HIJ = TRUE
       BUS-GDG.
           MOVE GLE-CAI-GTIA IN GLE-FLD TO GAP-CAI-GTIA IN GAP.
           MOVE GLE-IIC-GTIA IN GLE-FLD TO GAP-IIC-GTIA IN GAP.
           MOVE GLE-COD-PACR IN GLE-FLD TO GAP-COD-PACR IN GAP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           MOVE FIO-STAT TO PGM-STAT-GAP.
           IF NOT FIO-STAT-OKS
              MOVE 'GAP    NEX' TO MSG-COD-MENS
              GO TO ERR-FND-KEY.      

           MOVE GLE-CAI-GTIA IN GLE-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GLE-IIC-GTIA IN GLE-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-STAT TO PGM-STAT-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
*% IF PGM_CHI
      *<<<< PGM_CHI
           IF SCR-CCPP = 'ACC' AND 
              SCR-STAT = SCR-STAT-CON
              GO TO FIN-VAL-OFI-USP-GLE.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-VAL-OFI-USP-GLE.
      *-------------------------------------------------*
      *VALIDA USR CONTRA OFICINA
      *ALD-BCI-INI/07032000
           COPY USPC143.
           MOVE 'GARGTUCG/CEN' TO USP-PTA-STR.
           COPY USPC103.
           IF USP-PERMISO = 'P'
               GO TO FIN-VAL-OFI-USP-GLE.
      *    COPY USPC143.
      *ALD-BCI-FIN/07032000
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG 
               MOVE 'USRNODEOFI' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
      *-------------------------------------------------*
      *MHM-INI 6-AUG-2003
       FIN-VAL-OFI-USP-GLE.
      *MHM-FIN 6-AUG-2003
      *>>>>
*% END
*% IF PGM_PER AND PGM_GVT
      *<<<< PGM_PER AND PGM_GVT
       COPY GARBVUOF.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-FND-KEY.
      *>>>>
*% END

       FIN-BUS-GDG.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GLE-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GLE-FLD.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GDG TO GDG-COD-CGTA IN GLE-FLD.
*% END
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB'  TO TAB-COD-SIST.
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.
      *>>>>
*% ELSE
           MOVE 'GTA'  TO TAB-COD-TTAB IN TAB.
*% END
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
      *
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GLE-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GLE-FLD TO TAG-STP-AGTA IN TAG.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GLE-FLD TO TAG-COD-AGTA IN TAG.
*% END
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CGTA IN GLE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CGTA IN GLE-FLD.

      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'GAR' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TREA IN GLE-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TREA IN GLE-FLD.


           MOVE GDG-CAI-GTIA IN GDG TO GAR-CAI-GTIA IN CMA-VARI.
           MOVE GDG-IIC-GTIA IN GDG TO GAR-IIC-GTIA IN CMA-VARI.
           MOVE GDG-IND-GTAC IN GDG TO GAR-IND-GTAC IN CMA-VARI.
           IF SCR-CMND = 'ING'
               PERFORM PUT-GDG-GLE.

      * Valida Este permitido esta Entidad para Tipo-Subtipo
           IF TAG-IND-EGLE IN TAG = 'N'
               MOVE 'TAG    NOPGM' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      * Comando Consulta Error lo trata el GENESIS
           IF SCR-CCPP = 'ACC' AND 
              SCR-STPP = SCR-STAT-CON
              GO TO FIN-FND-KEY.

      * Garantia Alzada
           IF GDG-IND-EST1 IN GDG > '19'
               MOVE 'GDGALZ' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *MHM-INI 17-OCT-2003
           IF SCR-CMND = 'MOD'
               IF GDG-IND-GTAC IN GDG NOT = 'S'
                   MOVE FIO-STAT TO WSS-FIO-STAT-BKP IN WSS-VARI
                   MOVE GDG-CAI-GTIA IN GDG TO GSO-CAI-GTIA IN GSO
                   MOVE GDG-IIC-GTIA IN GDG TO GSO-IIC-GTIA IN GSO
                   MOVE 'GSO-KEY-IGDG' TO FIO-AKEY
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GAR-FIO-GSO
                   IF FIO-STAT-OKS AND GSO-COD-ESGA IN GSO NOT < '06'
                      MOVE 'GSOESGA>=6' TO MSG-COD-MENS
                      GO TO ERR-FND-KEY
                   ELSE
                       MOVE WSS-FIO-STAT-BKP IN WSS-VARI TO FIO-STAT.

           IF SCR-CMND = 'ELI'
               IF GDG-IND-GTAC IN GDG NOT = 'S'
                   MOVE FIO-STAT TO WSS-FIO-STAT-BKP IN WSS-VARI
                   MOVE GDG-CAI-GTIA IN GDG TO GSO-CAI-GTIA IN GSO 
                   MOVE GDG-IIC-GTIA IN GDG TO GSO-IIC-GTIA IN GSO
                   MOVE 'GSO-KEY-IGDG' TO FIO-AKEY
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GAR-FIO-GSO
                   IF FIO-STAT-OKS AND GSO-COD-EST2 IN GSO NOT < '04'
                      MOVE 'GSOEST2>04' TO MSG-COD-MENS
                      GO TO ERR-FND-KEY
                   ELSE
                       MOVE WSS-FIO-STAT-BKP IN WSS-VARI TO FIO-STAT.

      *MHM-FIN 17-OCT-2003

      * Garantia Completa
           IF SCR-CCPP = 'ELI' AND
              GDG-IND-GTAC IN GDG = 'S'
               MOVE 'GAR    CPL' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           GO TO FIN-FND-KEY.
       ERR-FND-KEY.
           MOVE 'GAR' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE SCR-STAT-ABT TO SCR-STAT.
           IF SCR-CCPP = 'ING'
               MOVE '00' TO FIO-STAT
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT.

      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE SPACES TO GLE-GLS-FLAG IN GLE.
           MOVE SPACES TO GLE-MSC-TACC IN GLE.
           MOVE SPACES TO GLE-CIC-UING IN GLE.
           MOVE 'I'    TO GLE-MSC-STAT IN GLE.

           MOVE SPACES TO GLE-COD-ABOG IN GLE.
           MOVE SPACES TO GLE-COD-NTRO IN GLE.
      *MHM-INI 6-AUG-2003
      *     MOVE SPACES TO GLE-VAL-RSII IN GLE.
            MOVE SPACES TO GLE-COD-RSII IN GLE.
      *MHM-FIN 6-AUG-2003
           MOVE SPACES TO GLE-IND-ITIN IN GLE.
      *MHM-INI 6-AUG-2003
      *     MOVE ZEROES TO GLE-FEC-FPGT IN GLE.
      *     MOVE SPACES TO GLE-NUM-FOJP IN GLE.
           MOVE SPACES TO GLE-COD-FPHG IN GLE.
      *MHM-FIN 6-AUG-2003

           MOVE ZEROES TO GLE-NUM-APHG IN GLE.
      *MHM-INI 6-AUG-2003
      *     MOVE SPACES TO GLE-NUM-TPGT IN GLE.
      *MHM-FIN 6-AUG-2003
           MOVE SPACES TO GLE-COD-REGI IN GLE.
           MOVE SPACES TO GLE-COD-LREG IN GLE.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING'
              OR SCR-CMND = 'COP'
               MOVE 'I'      TO GLE-MSC-TACC IN GLE

               MOVE HOY-FHOY TO GLE-FEC-FING IN GLE
*% IF PGM_MVS
               MOVE SCR-USER TO GLE-CIC-UING IN GLE
*% END
           ELSE
*% IF PGM_MVS
      *         MOVE SCR-USER TO GLE-CIC-UACT IN GLE
*% END
               MOVE 'M'      TO GLE-MSC-TACC    IN GLE.
*% IF PGM_MVS
*% END
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en la modificacion : informar               
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en el ingreso : informar                    
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

           MOVE GLE-CAI-GTIA IN GLE TO GDG-CAI-GTIA IN GDG.
           MOVE GLE-IIC-GTIA IN GLE TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE 'S' TO GDG-IND-EGLE IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GAR-FIO-GDG.

      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           MOVE GLE-CAI-GTIA IN GLE TO GDG-CAI-GTIA IN GDG.
           MOVE GLE-IIC-GTIA IN GLE TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE ' ' TO GDG-IND-EGLE IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GAR-FIO-GDG.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'MOD'
               IF GAR-IND-GTAC IN CMA-VARI NOT = 'S'
                   MOVE GLE-CAI-GTIA IN GLE-FLD TO GSO-CAI-GTIA IN GSO 
                   MOVE GLE-IIC-GTIA IN GLE-FLD TO GSO-IIC-GTIA IN GSO
                   MOVE 'GSO-KEY-IGDG' TO FIO-AKEY
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GAR-FIO-GSO
                   IF FIO-STAT-OKS AND GSO-COD-EST2 IN GSO NOT < '04'
                      MOVE FRM-CPIM-AEY TO GLE-COD-ABOG-ATR IN GLE-FLD
                      MOVE 0  TO GLE-COD-ABOG-LEN IN GLE-FLD
                      MOVE -1 TO GLE-COD-NTRO-LEN IN GLE-FLD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.
      
       GNS-CLR-RQA SECTION.
       INI-GNS-CLR-RQA.
       FIN-GNS-CLR-RQA.
           EXIT.

       COPY GARBFGIM.
       COPY GARBFGDG.
       COPY TABBFIVB.
       COPY GARBFTAG.
       COPY GARBFGAP.
       COPY GARBFGSO.
       COPY GARBGVCG.
       COPY GARBKVCG.
       COPY GARBFGVE.
      * COPY TABBFEST.
      * COPY TABBFCIU.
      *

*% IF PGM_MCP
       COPY GARBFGMO.
       COPY GARBFGVT.
       COPY GARBFGSE.
       COPY GARBFGDD.
       COPY GARBFGES.
       COPY GARBFGTP.
       COPY GARBFGIN.
       COPY GARBFGDP.
       COPY GARBFGSI.
       COPY GARBFGUB.
       COPY GARBFGDO.
       COPY GARBGVC2.
       COPY GARBGVDO.
*% END
*% IF PGM_PU
      *<<<< PGM_PU
       COPY GNSBFMSC.
       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBVIND.
      *>>>> 
*% END
      *>>>>
*% END
