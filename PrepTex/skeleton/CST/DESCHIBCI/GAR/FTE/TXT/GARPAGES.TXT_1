*%! NO_TIENE_TIMESTAMP = TRUE
*% PGM_GES = TRUE
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% FRM = 'GES'
*% REG = 'GES'
*% HIJ = 'GDG'
*% CAIREG = 'GES-CAI-GTIA'
*% IICREG = 'GES-IIC-GTIA'
*% CAIFLD = 'GES-CAI-GTIA'
*% IICFLD = 'GES-IIC-GTIA'
*% SISREG = 'GAR'
*%!IF NOT PGM_MCP
*% PGM_PTC = TRUE
*%!END
*% IF NOT PGM_MCP
*%      ! Codigo adicional para Funcion GARPPVCG = PF5
*%      ! INCLUDE 'GARSRC:PFALL5.SRC'
*%      ! Codigo adicional para archivo
*% END
*% GRA_GMO = TRUE
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 CMA-VARI.
               05 GAR-CAI-GTIA              PIC X(04).
               05 GAR-IIC-GTIA              PIC X(08).
               05 GAR-IND-GTAC              PIC X(01).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GARBRGDG.
       COPY GARBRTAG.
       COPY GARBRGAP.
       COPY GARBRGLE.
      *MHM-INI 23-OCT-2003
       COPY GNSWGCPT.
      *MHM-FIN 23-OCT-2003

*% IF PGM_CLB OR PGM_MEX
*%! IF PGM_MCP
      *<<<< IF PGM_MCP
       COPY GARBRGAP.
       COPY GARBRGDO.
       COPY GARBRGDP.
       COPY GARBRGIN.
       COPY GARBRGLE.
       COPY GARBRGSE.
       COPY GARBRGSI.
       COPY GARBRGTP.
       COPY GARBRGUB.
       COPY GARBRGVT.
       COPY GARBRGIM.
       COPY GARBRGVE.
       COPY GARBRGSL.
       COPY GARBRGSO.
       COPY GARWGVDO.
       COPY GARWVVCG.
      *>>>>
*% END
*% IF PGM_PU OR PGM_PQ
      *<<<< PGM_PU
       COPY GARBRGDD.
       COPY GARBRGMO.
      *>>>>
*% END
       COPY TABBRTIO.
       COPY COLBROPC.
       COPY COLBRDLC.

*% IF PGM_PQ OR PGM_PU
      *<<<< PGM_PQ OR PGM_PU
       COPY GARWGVCG.
*% IF PGM_VMS
      *<<<< PGM_VMS
           03 WSS-REG                          PIC X(03).
      *>>>>
*% END
      *>>>>
*% END
       COPY GNSBRMSC.

*% IF PGM_MCP
       COPY GNSWRMSC.
*% END
      *
       COPY GNSWGPES.
*% IF PGM_CHI AND PGM_PQ
      *<<<< PGM_CHI AND PGM_PQ
           COPY USPC113.
      *>>>>
*% END
       01  WSS-VARI.
*% IF PGM_PU
      *<<<< PGM_PU
           03 WSS-MARC-1                              PIC X(01).
           03 WSS-FEC-FMAV.
              05 WSS-NUM-SAMV                         PIC 9(04).
              05 WSS-NUM-MMAV                         PIC 9(02).
              05 WSS-NUM-DMAV                         PIC 9(02).

           03 PGM-STAT-ADI.
              05 PGM-STAT-RDC.
                 88 PGM-STAT-RDC-NUL    VALUE '  '.
                 07 PGM-STT1-RDC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RDC-OKS VALUE '0'.
                 07 PGM-STT2-RDC        VALUE '3' PIC X(01).
      *>>>>
*% END                         
           03 WSS-COD-AGTA.
              05 WSS-COD-TOPE                          PIC X(03).
              05 WSS-COD-SOPE                          PIC X(03).

           03 WSS-CAI-IDGP.
              05 WSS-COD-TDGP                         PIC X(01).
              05 WSS-COD-CDGP                         PIC X(03).

           03 WSS-COD-PESO.
              05 WSS-IND-TMON      VALUE SPACES       PIC X(01).
              05 WSS-COD-REST      VALUE SPACES       PIC X(05).
           03 WSS-CIC-COL          VALUE SPACES       PIC X(03).
           03 WSS-COD-TVCC      VALUE SPACES       PIC X(01).
           03 WSS-IND-VIGE                         PIC X(01).

           03 WSS-FEC-FAUX.
              05 WSS-NUM-DAUX        PIC 9(02).
              05 WSS-NUM-MAUX        PIC 9(02).
              05 WSS-NUM-SAUX        PIC 9(02).
              05 WSS-NUM-AAUX        PIC 9(02).
      
           03 WSS-MAR-UTIL           PIC 9(03).
           03 WSS-GES-CANT           PIC 9(03).
      *MHM-INI 23-OCT-2003
           03 WSS-GLS-CGTA.
              05 WSS-GLS-TOPE                   PIC X(40).
              05 WSS-GLS-SOPE                   PIC X(40).
      *MHM-FIN 23-OCT-2003

*% IF PGM_DTC
      *<<<< PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GMO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GAP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GLE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
      *>>>>
*% END
      *>>>>
*% END
*% IF PGM_ARG
*% LARGO_MI_COMMAREA = 17
*% ELSE
*% LARGO_MI_COMMAREA = 13
*% END
*% IF INI_FIO AND PGM_VAX
      *<<<< INI_FIO

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'COL'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-TAG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-TAG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GMO.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GMO.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'COL'        TO FIO-SIST.
           PERFORM COL-FIO-OPC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'COL'        TO FIO-SIST.
           PERFORM COL-FIO-DLC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
      *>>>> INI_FIO
*% END
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
*% IF PGM_PQ
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-GES
               PERFORM VAL-NUM-FLD-GES.
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           PERFORM GNS-CLR-RQA.
*% END
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
*% IF PGM_PQ
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-GES
               PERFORM VAL-NUM-FLD-GES
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           PERFORM GNS-CLR-RQA.
*% END
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
*% IF PGM_PQ
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-GES
               PERFORM VAL-NUM-FLD-GES
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           PERFORM GNS-CLR-RQA.
*% END
      *>>>>
*% END
*% IF PFS_SCR_GKEY
      *<<<< PFS_SCR_GKEY
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF PFS_SCR_GFLD
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF5 ) )
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *MHM-INI 4-AUG-2003
      * Llama a Subrutina Validacion Consistencia Garantia
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM GAR-PRO-VCG
               GO TO FIN-FND-KEY.
      
      *MHM-FIN 4-AUG-2003
*% FIN_BUS_HIJ = TRUE
           
           IF SCR-CCPP = 'ING'
              GO TO BUS-GDG.

           IF GES-CAI-GTIA IN GES-FLD NOT > SPACES AND                 
              GES-IIC-GTIA IN GES-FLD NOT > ZEROES AND
*% IF FMT_CHI
      *<<<< FMT_CHI
              GES-IIC-IOPC IN GES-FLD     > ZEROES AND                 
              GES-NUM-IDLC IN GES-FLD     > ZEROES                     
              MOVE GES-IIC-IOPC IN GES-FLD TO GES-IIC-IOPC IN GES      
              MOVE GES-CAI-IOPC IN GES-FLD TO GES-CAI-IOPC IN GES      
      *>>>>
*% ELSE
              GES-CIC-ICON IN GES-FLD     > ZEROES AND                 
              GES-CIC-IOPC IN GES-FLD     > ZEROES AND                 
              GES-NUM-IDLC IN GES-FLD     > ZEROES                     
              MOVE GES-CIC-ICON IN GES-FLD TO GES-CIC-ICON IN GES      
              MOVE GES-CIC-IOPC IN GES-FLD TO GES-CIC-IOPC IN GES      
*% END
              MOVE GES-NUM-IDLC IN GES-FLD TO GES-NUM-IDLC IN GES      
              MOVE 'GES-KEY-IOPE'          TO FIO-AKEY
              MOVE FIO-GET-NLS TO FIO-CMND                             
              PERFORM GAR-FIO-GES                                      
              IF NOT (FIO-STAT-OKS AND                                 
*% IF FMT_CHI
      *<<<< FMT_CHI
                      GES-CAI-IOPC IN GES-FLD = GES-CAI-IOPC IN GES AND
                      GES-IIC-IOPC IN GES-FLD = GES-IIC-IOPC IN GES AND
      *>>>>
*% ELSE
                      GES-CIC-ICON IN GES-FLD = GES-CIC-ICON IN GES AND
                      GES-CIC-IOPC IN GES-FLD = GES-CIC-IOPC IN GES AND
*% END
                      GES-NUM-IDLC IN GES-FLD = GES-NUM-IDLC IN GES )  
                 MOVE '23'         TO FIO-STAT                         
                 MOVE 'GES    NEX' TO MSG-COD-MENS                     
                 GO TO ERR-FND-KEY                                     
              ELSE                                                     
                 MOVE GES-CAI-GTIA IN GES TO GES-CAI-GTIA IN GES-FLD   
                 MOVE GES-IIC-GTIA IN GES TO GES-IIC-GTIA IN GES-FLD
                 MOVE GES-NUM-IGES IN GES TO GES-NUM-IGES IN GES-FLD.

       BUS-GDG.
           MOVE GES-CAI-GTIA IN GES-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GES-IIC-GTIA IN GES-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-STAT TO PGM-STAT-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *Garantia debe ser especifica
           IF GDG-COD-LGTA IN GDG NOT = 'E'
               MOVE 'GESNOESP' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
*% IF NOT PGM_CHI AND NOT PGM_BSH

      * Garantia activada
           IF GDG-IND-GTAC IN GDG = 'S'
              IF NOT ( SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON )
              IF NOT ( SCR-CCPP = 'ING' AND SCR-CMND     = 'ING')
              IF NOT ( SCR-CCPP = 'MOD' AND SCR-CMND NOT = 'MOD')
              IF NOT ( SCR-CCPP = 'ELI' AND SCR-CMND NOT = 'ELI')
               MOVE 'GAR    CPL' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
      
           IF GDG-IND-GTAC IN GDG = 'N'            AND
              SCR-CCPP            = 'MOD'          AND
              SCR-CMND         NOT = 'MOD'
              MOVE 'GAR  NOCPL' TO MSG-COD-MENS
              GO TO ERR-FND-KEY.
      
*% END
*% IF PGM_CHI
      *<<<< PGM_CHI
      *VALIDA USR CONTRA OFICINA
           IF SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON
               GO TO FIN-VAL-OFI-USP-GES.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-VAL-OFI-USP-GES.
      *ALD-BCI-INI/07032000
           COPY USPC143.
           MOVE 'GARGTUCG/CEN' TO USP-PTA-STR.
           COPY USPC103.
           IF USP-PERMISO = 'P'
               GO TO FIN-VAL-OFI-USP-GES.
      *    COPY USPC143.
      *ALD-BCI-FIN/07032000
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG 
               MOVE 'USRNODEOFI' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *MHM-INI 5-AUG-2003
       FIN-VAL-OFI-USP-GES.
      *MHM-FIN 5-AUG-2003
      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA
      *>>>>
*% END
*% IF PGM_PER AND PGM_GVT
      *<<<< PGM_PER AND PGM_GVT
       COPY GARBVUOF.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-FND-KEY.
      *>>>>
*% END

       FIN-BUS-GDG.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GES-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GES-FLD.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GDG TO GDG-COD-CGTA IN GES-FLD.
*% END
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB'  TO TAB-COD-SIST.
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.
      *>>>>
*% ELSE
           MOVE 'GTA'  TO TAB-COD-TTAB IN TAB.
*% END
           MOVE SPACES TO TAB-COD-CTAB IN TAB.

*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GDG     TO GDG-TIP-CGTA IN GES-FLD.
           MOVE GDG-STP-CGTA IN GDG     TO GDG-STP-CGTA IN GES-FLD.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GDG     TO GDG-COD-CGTA IN GES-FLD.
*% END
           MOVE GDG-COD-CGTA IN GDG     TO TAG-COD-AGTA IN TAG.
      *MHM-INI 23-OCT-2003
      *     MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
      *     PERFORM BUS-TAB.
      *     IF MSG-COD-MENS = SPACES
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GES-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GES-FLD.
      *MHM-FIN 23-OCT-2003

      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'GAR' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE TAG-IND-TREA IN TAG TO 
                     TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TREA IN GES-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TREA IN GES-FLD.


           MOVE GDG-CAI-GTIA IN GDG TO GAR-CAI-GTIA IN CMA-VARI.
           MOVE GDG-IIC-GTIA IN GDG TO GAR-IIC-GTIA IN CMA-VARI.
           MOVE GDG-IND-GTAC IN GDG TO GAR-IND-GTAC IN CMA-VARI.
           IF SCR-CCPP = 'ING'
               PERFORM PUT-GDG-GES.

      * Valida Este permitido esta Entidad para Tipo-Subtipo
           IF TAG-IND-EGES IN TAG = 'N'
               MOVE 'TAG    NOPGM' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      * Comando Consulta Error lo trata el GENESIS
           IF SCR-CCPP = 'ACC' AND SCR-STPP = SCR-STAT-CON
               GO TO FIN-FND-KEY.

      * Garantia Alzada
           IF GDG-IND-EST1 IN GDG > '19'
               MOVE 'GDGALZ' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
      *MHM-INI 17-OCT-2003
      * Garantia Completa
           IF SCR-CCPP = 'ELI' AND
              GDG-IND-GTAC IN GDG = 'S'
               MOVE 'GAR    CPL' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *MHM-FIN 17-OCT-2003

           GO TO FIN-FND-KEY.
       ERR-FND-KEY.
           MOVE 'GAR' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE SCR-STAT-ABT TO SCR-STAT.
           IF SCR-CCPP = 'ING'
               MOVE '00' TO FIO-STAT
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT.

      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE SPACES TO GES-GLS-FLAG IN GES.
           MOVE SPACES TO GES-MSC-TACC IN GES.
           MOVE SPACES TO GES-CIC-UING IN GES.
      *    MOVE SPACES TO GES-CIC-UACT IN GES.
           MOVE 'I'    TO GES-MSC-STAT IN GES.


           IF GES-COD-TVCC IN GES-FLD > SPACES AND
              GES-COD-VCMC IN GES-FLD = ZEROES
              MOVE GES-COD-TVCC IN GES-FLD TO WSS-COD-TVCC.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING'
              OR SCR-CMND = 'COP'
               MOVE 'I'      TO GES-MSC-TACC    IN GES

               MOVE HOY-FHOY TO GES-FEC-FING IN GES
*% IF PGM_MVS
               MOVE SCR-USER TO GES-CIC-UING IN GES
*% END
           ELSE
*% IF PGM_MVS
      *         MOVE SCR-USER TO GES-CIC-UACT IN GES
*% END
               MOVE 'M'      TO GES-MSC-TACC    IN GES.
*% IF PGM_MVS
*% END
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           IF GES-COD-TVCC IN GES-FLD > SPACES AND
              GES-COD-VCMC IN GES-FLD = ZEROES
               MOVE WSS-COD-TVCC TO GES-COD-TVCC IN GES.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

           IF GAR-IND-GTAC IN CMA-VARI NOT = 'S'
               GO TO SIG-CMN-ING.

           MOVE '1' TO GMO-COD-MOVI IN GMO.
           PERFORM ESC-GMO-GES.

           IF MSG-COD-MENS > SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CMN-ING.

      *MHM-INI 21-OCT-2003
           MOVE GES-CAI-IOPC IN GES TO DLC-CAI-IOPC IN DLC.
           MOVE GES-IIC-IOPC IN GES TO DLC-IIC-IOPC IN DLC.
           MOVE GES-NUM-IDLC IN GES TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS 
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'DLC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CMN-ING.
               
           MOVE GES-CAI-GTIA IN GES TO GDG-CAI-GTIA IN GDG.
           MOVE GES-IIC-GTIA IN GES TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS 
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CMN-ING.
                          
           MOVE GDG-COD-TOPE IN GDG TO TAG-COD-TOPE IN TAG.
           MOVE GDG-COD-SOPE IN GDG TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS 
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CMN-ING.

           IF TAG-IND-SVTO IN TAG = 'N'
               GO TO SIG-CMN-ING.
                          
           IF DLC-FEC-FMAV IN DLC > GDG-FEC-FVTO IN GDG
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM GAR-FIO-GDG
               MOVE DLC-FEC-FMAV IN DLC TO GDG-FEC-FVTO IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GAR-FIO-GDG.               
      *MHM-FIN 21-OCT-2003
       SIG-CMN-ING.
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en el ingreso : informar                    
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

           MOVE GES-CAI-GTIA IN GES TO GDG-CAI-GTIA IN GDG.
           MOVE GES-IIC-GTIA IN GES TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE 'S' TO GDG-IND-EGES IN GDG
               MOVE 'S' TO GDG-IND-UTIL IN GDG
               MOVE FIO-MOD TO FIO-CMND
      *RRM-INI 31-MAY-2002
      *        PERFORM GAR-FIO-GDG.
               PERFORM GAR-FIO-GDG
           ELSE
               GO TO FIN-CMN-ING.
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
      * Relacionar Garantia con la solicitud BEE.
           MOVE GES-NUM-SBGL IN GES-FLD TO GSO-NUM-SBGL IN GSO.
           MOVE GES-CAI-GTIA IN GES-FLD TO GSO-CAI-GTIA IN GSO.
           MOVE GES-IIC-GTIA IN GES-FLD TO GSO-IIC-GTIA IN GSO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSO.               
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
           IF GSO-COD-ESGA IN GSO NOT = '05'
               GO TO FIN-CMN-ING.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GSO.               
           MOVE '10' TO GSO-COD-ESGA IN GSO.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM GAR-FIO-GSO.               
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
      *RRM-FIN 31-MAY-2002
      *>>>>
*% END
      *>>>>
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
           IF GES-COD-TVCC IN GES-FLD > SPACES AND
              GES-COD-VCMC IN GES-FLD = ZEROES
              MOVE GES-COD-TVCC IN GES-FLD TO WSS-COD-TVCC.
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
           IF GES-COD-TVCC IN GES-FLD > SPACES AND
              GES-COD-VCMC IN GES-FLD = ZEROES
               MOVE WSS-COD-TVCC TO GES-COD-TVCC IN GES-FLD.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en la modificacion : informar               
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *MHM-INI 21-OCT-2003
           IF GAR-IND-GTAC IN CMA-VARI NOT = 'S'
               GO TO CNT-CMN-MOD.

           MOVE GES-CAI-IOPC IN GES TO DLC-CAI-IOPC IN DLC.
           MOVE GES-IIC-IOPC IN GES TO DLC-IIC-IOPC IN DLC.
           MOVE GES-NUM-IDLC IN GES TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS 
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'DLC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CMN-MOD.
               
           MOVE GES-CAI-GTIA IN GES TO GDG-CAI-GTIA IN GDG.
           MOVE GES-IIC-GTIA IN GES TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS 
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CMN-MOD.
                          
           MOVE GDG-COD-TOPE IN GDG TO TAG-COD-TOPE IN TAG.
           MOVE GDG-COD-SOPE IN GDG TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS 
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CMN-MOD.

           IF TAG-IND-SVTO IN TAG = 'N'
               GO TO CNT-CMN-MOD.

           IF DLC-FEC-FMAV IN DLC > GDG-FEC-FVTO IN GDG
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM GAR-FIO-GDG
               MOVE DLC-FEC-FMAV IN DLC TO GDG-FEC-FVTO IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GAR-FIO-GDG.
               
       CNT-CMN-MOD.
      *MHM-FIN 21-OCT-2003

           PERFORM BUS-GES-GDG.
           IF WSS-MAR-UTIL IN WSS-VARI > ZEROES
              MOVE '00' TO FIO-STAT
              GO TO FIN-CMN-MOD.
      
           MOVE GES-CAI-GTIA IN GES-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GES-IIC-GTIA IN GES-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
      
           MOVE 'N'     TO GDG-IND-UTIL IN GDG.
           MOVE FIO-MOD TO FIO-CMND
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
      *RRM-INI 31-MAY-2002
      *        MOVE FIO-MENS TO FRM-MENS.
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

      * Relacionar Garantia con la solicitud BEE.
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
           MOVE GES-NUM-SBGL IN GES-FLD TO GSO-NUM-SBGL IN GSO.
           MOVE GES-CAI-GTIA IN GES-FLD TO GSO-CAI-GTIA IN GSO.
           MOVE GES-IIC-GTIA IN GES-FLD TO GSO-IIC-GTIA IN GSO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSO.               
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           IF GSO-COD-ESGA IN GSO NOT = '05'
               GO TO FIN-CMN-MOD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GSO.               
      *RRM-INI 30-SEP-2002
           IF SCR-CMND = 'MGA'
               MOVE '11' TO GSO-COD-ESGA IN GSO.
           IF SCR-CMND = 'MOD'
      *RRM-INI 30-SEP-2002
           MOVE '10' TO GSO-COD-ESGA IN GSO.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM GAR-FIO-GSO.               
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *RRM-FIN 31-MAY-2002
      *>>>>
*% END
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           IF GAR-IND-GTAC IN CMA-VARI NOT = 'S'
               GO TO SIG-CMN-ELI.
           MOVE '3' TO GMO-COD-MOVI IN GMO.
           PERFORM ESC-GMO-GES.
           IF MSG-COD-MENS > SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CMN-ELI.
       SIG-CMN-ELI.

           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

      *RRM-INI 27-SEP-2002
           PERFORM BUS-GES-GDO.
           IF WSS-MAR-UTIL IN WSS-VARI > ZEROES AND
              WSS-GES-CANT IN WSS-VARI > ZEROES
              GO TO FIN-CMN-ELI.
      
      * Actualizar solicitud BEE.
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
           MOVE GES-NUM-SBGL IN GES-FLD TO GSO-NUM-SBGL IN GSO.
           MOVE GES-CAI-GTIA IN GES-FLD TO GSO-CAI-GTIA IN GSO.
           MOVE GES-IIC-GTIA IN GES-FLD TO GSO-IIC-GTIA IN GSO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF GSO-COD-ESGA IN GSO NOT = '10'
               GO TO SIGUE-CMN-ELI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GSO.
           MOVE '05' TO GSO-COD-ESGA IN GSO.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM GAR-FIO-GSO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
       SIGUE-CMN-ELI.
      *RRM-INI 27-SEP-2002
      *>>>>
*% END

           PERFORM BUS-GES-GDG.
           IF WSS-MAR-UTIL IN WSS-VARI > ZEROES OR
              WSS-GES-CANT IN WSS-VARI > ZEROES
              MOVE '00' TO FIO-STAT
              GO TO FIN-CMN-ELI.
      

      * No quedo ningun hijo
           MOVE GAR-CAI-GTIA IN CMA-VARI TO GDG-CAI-GTIA IN GDG.
           MOVE GAR-IIC-GTIA IN CMA-VARI TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
      
           IF WSS-GES-CANT IN WSS-VARI NOT > ZEROES
               MOVE ' ' TO GDG-IND-EGES IN GDG.
      
           IF WSS-MAR-UTIL IN WSS-VARI NOT > ZEROES
               MOVE 'N' TO GDG-IND-UTIL IN GDG.
      
           MOVE FIO-MOD TO FIO-CMND
           PERFORM GAR-FIO-GDG
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS.

      *>>>>
*% END
*% IF EOF AND PGM_PQ
      *<<<< EOF AND PGM_PQ
       BUS-COR-GES SECTION.
       INI-BUS-COR-GES.
      *FLB CST  9-MAY-1994 CORRIGE ERROR EN POSICIONAMIENTO
           PERFORM KEY-GES-GES.
           MOVE 99 TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF NOT ( FIO-STAT-OKS AND
                    GES-CAI-GTIA  IN GES-FLD = GES-CAI-GTIA  IN GES AND
                    GES-IIC-GTIA  IN GES-FLD = GES-IIC-GTIA  IN GES )
               PERFORM KEY-GES-GES
               MOVE ZEROES TO GES-NUM-IGES IN GES.

           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GES.

           IF ( SCR-CCPP = 'ING' OR 'ACT' ) OR
              GES-NUM-IGES IN GES = ZEROES
               ADD 1 TO GES-NUM-IGES IN GES
               MOVE GES-NUM-IGES IN GES TO GES-NUM-IGES IN GES-FLD.
      *FLB CST  9-MAY-1994
       FIN-BUS-COR-GES.
           EXIT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *MHM-INI 5-AUG-2003
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.
      
       GNS-CLR-RQA SECTION.
       INI-GNS-CLR-RQA.
       FIN-GNS-CLR-RQA.
           EXIT.
      *MHM-FIN 5-AUG-2003

*% IF PGM_DTC
      *<<<< PGM_DTC
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
*% END
*% IF PGM_PU
      *<<<< PGM_PU
       BUS-GES-GDG SECTION.
       INI-BUS-GES-GDG.
      
           MOVE ZEROES                  TO WSS-MAR-UTIL IN WSS-VARI.
           MOVE ZEROES                  TO WSS-GES-CANT IN WSS-VARI.
           MOVE GES-CAI-GTIA IN GES-FLD TO GES-CAI-GTIA IN GES.
           MOVE GES-IIC-GTIA IN GES-FLD TO GES-IIC-GTIA IN GES.
           MOVE ZEROES                  TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
       LUP-BUS-GES-GDG.
           IF NOT ( FIO-STAT-OKS AND
                GES-CAI-GTIA  IN GES-FLD = GES-CAI-GTIA  IN GES AND
                GES-IIC-GTIA  IN GES-FLD = GES-IIC-GTIA  IN GES )
                GO TO FIN-BUS-GES-GDG.
      
           ADD 1 TO WSS-GES-CANT IN WSS-VARI.
           IF GES-IND-SCRE IN GES NOT = 'N'
              ADD  1 TO  WSS-MAR-UTIL IN WSS-VARI
              GO TO FIN-BUS-GES-GDG.
      
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           GO TO LUP-BUS-GES-GDG.
      
       FIN-BUS-GES-GDG.
           EXIT.
      
      *RRM-INI 27-SEP-2002
       BUS-GES-GDO SECTION.
       INI-BUS-GES-GDO.
           MOVE ZEROES                  TO WSS-MAR-UTIL IN WSS-VARI.
           MOVE ZEROES                  TO WSS-GES-CANT IN WSS-VARI.
           MOVE GES-CAI-GTIA IN GES-FLD TO GES-CAI-GTIA IN GES.
           MOVE GES-IIC-GTIA IN GES-FLD TO GES-IIC-GTIA IN GES.
           MOVE ZEROES                  TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
       LUP-BUS-GES-GDO.
           IF NOT ( FIO-STAT-OKS AND
                GES-CAI-GTIA  IN GES-FLD = GES-CAI-GTIA  IN GES AND
                GES-IIC-GTIA  IN GES-FLD = GES-IIC-GTIA  IN GES )
                GO TO FIN-BUS-GES-GDO.
      
           ADD 1 TO WSS-GES-CANT IN WSS-VARI.
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
           IF GES-NUM-SBGL IN GES NOT = GES-NUM-SBGL IN GES-FLD
              ADD  1 TO  WSS-MAR-UTIL IN WSS-VARI
              GO TO FIN-BUS-GES-GDO.

      *>>>>
*% END      
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           GO TO LUP-BUS-GES-GDO.
      
       FIN-BUS-GES-GDO.
           EXIT.
      *RRM-INI 27-SEP-2002

       ESC-GMO-GES SECTION.
       INI-ESC-GMO-GES.
           MOVE ZEROES TO GMO-NUM-IMOV IN GMO.
           PERFORM INI-GMO.
           MOVE 'GES001' TO GMO-COD-CMPO IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           IF GMO-COD-MOVI IN GMO = '1'
               MOVE GES-NUM-IGES IN GES-FLD TO GMO-GLS-NCMP IN GMO
           ELSE
           IF GMO-COD-MOVI IN GMO = '3'
               MOVE GES-NUM-IGES IN GES-FLD TO GMO-GLS-CMPA IN GMO.
               
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
               MOVE SPACES TO MSG-COD-MENS.
       FIN-ESC-GMO-GES.
           EXIT.  
      
       CLR-CAM-ABA SECTION.
       INI-CLR-CAM-ABA.
           MOVE SPACES TO GES-COD-TVCC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TVCC IN GES-FLD.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE SPACES TO GDG-TIP-CGTA IN GES-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN GES-FLD.
      *>>>>
*% ELSE
           MOVE SPACES TO GDG-COD-CGTA IN GES-FLD.
*% END
           MOVE SPACES TO FRM-GLS-CGTA IN GES-FLD.

           MOVE ZEROES TO GES-COD-VCMC IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCMC IN GES-FLD.

           MOVE SPACES TO GES-COD-DCRE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-DCRE IN GES-FLD.
           MOVE SPACES TO GES-IND-TDEU IN GES-FLD.
       FIN-CLR-CAM-ABA.
           EXIT.
       INI-GMO SECTION.
       INI-INI-GMO.
               MOVE SPACES TO GMO-GLS-FLAG IN GMO.
               MOVE ZEROES TO GMO-NUM-TASN IN GMO.
               MOVE SPACES TO GMO-COD-CMPO IN GMO.
               MOVE SPACES TO GMO-COD-CLVA IN GMO.
               MOVE SPACES TO GMO-GLS-CMPA IN GMO.
               MOVE ZEROES TO GMO-SGV-CMPA IN GMO.
               MOVE SPACES TO GMO-COD-NCLV IN GMO.
               MOVE SPACES TO GMO-GLS-NCMP IN GMO.
               MOVE ZEROES TO GMO-SGV-NCMP IN GMO.
               MOVE SPACES TO GMO-COD-TMOV IN GMO.
               MOVE SPACES TO GMO-GLS-DISP IN GMO.

               PERFORM GET-FHOY.
               MOVE HOY-FHOY TO GMO-FEC-FMOV IN GMO.
               MOVE HOY-HHOY TO GMO-HRA-HMOV IN GMO.
*% IF PGM_MVS OR PGM_DOS
      *<<<< PGM_MVS OR PGM_DOS
               MOVE SCR-OTRN TO GMO-TML-TMOV IN GMO.
               MOVE SCR-USER TO GMO-CIC-UING IN GMO.
      *<<<< 
*% ELSE
      *<<<< PGM_VMS
      * FALTA ESCRIBIR TERMINAL Y USUARIO
               MOVE SPACES TO GMO-TML-TMOV IN GMO.
               MOVE SPACES TO GMO-CIC-UING IN GMO.
      *<<<< 
*% END
               MOVE HOY-FHOY                TO GMO-FEC-FING IN GMO.
               MOVE GES-CAI-GTIA IN GES     TO GMO-CAI-GTIA IN GMO.
               MOVE GES-IIC-GTIA IN GES     TO GMO-IIC-GTIA IN GMO.
               MOVE GDG-COD-OFIC IN GES-FLD TO GMO-COD-OFMV IN GMO.
               ADD 1                        TO GMO-NUM-IMOV IN GMO.
               MOVE 'S'                     TO GMO-IND-VALO IN GMO.
               MOVE 'N'                     TO GMO-IND-CLVE IN GMO.
       FIN-INI-GMO.
           EXIT.

      *>>>>
*% END
       COPY GARBFGDG.
       COPY GARBFTAG.
       COPY GARBFGMO.
       COPY GARBFGAP.
       COPY GARBFGLE.
       COPY GARBFGDD.

       COPY COLBFOPC.
       COPY COLBFDLC.

*% IF PGM_CLB OR PGM_MEX
*%! IF PGM_MCP
       COPY GARBFGAP.
       COPY GARBFGDO.
       COPY GARBFGDP.
       COPY GARBFGIN.
       COPY GARBFGLE.
       COPY GARBFGSE.
       COPY GARBFGSI.
       COPY GARBFGTP.
       COPY GARBFGUB.
       COPY GARBFGVT.
       COPY GARBFGIM.
       COPY GARBFGVE.
       COPY GARBFGSL.
       COPY GARBFGSO.
       COPY GARBGVC2.
       COPY GARBGVDO.
       COPY GARBVVCG.
      *>>>>
*% END

*% IF ( PGM_PQ OR PGM_PU ) AND ( NOT PGM_MCP )
      *<<<< PGM_PQ OR PGM_PU
       COPY GARBGVCG.
       COPY GARBKVCG.
      *>>>>
*% END

       COPY GNSBVIND.
       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBGPES.
      *MHM-INI 23-OCT-2003
       COPY GNSBGCPT.
      *MHM-FIN 23-OCT-2003
      *>>>>
*% END
