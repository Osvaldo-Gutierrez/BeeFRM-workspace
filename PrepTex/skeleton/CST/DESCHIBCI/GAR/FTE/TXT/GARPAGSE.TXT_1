*%! NO_TIENE_TIMESTAMP = TRUE
*%! NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% FRM = 'GSE'
*% REG = 'GSE'
*% HIJ = 'GDG'
*% IF NOT PGM_CLB AND NOT PGM_MEX AND PGM_PQ
*%     ! Codigo adicional para Funcion GARPPVCG = PF5
*%      INCLUDE 'GARSRC:PFALL5.SRC'
*%     ! Codigo adicional para archivo
*% END
*% IF EOF AND PGM_DTC
      *<<<< EOF AND PGM_DTC
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 CMA-VARI.
               05 GAR-CAI-GTIA                     PIC X(04).
               05 GAR-IIC-GTIA                     PIC X(08).
               05 PGM-STAT-GVT                     PIC X(02).
                  88 PGM-STAT-GVT-OKS VALUE '00'.
               05 GAR-SGV-VPND          COMP       PIC S9(11)V9(4).
               05 GAR-SGV-LTSN          COMP       PIC S9(11)V9(4).
      *MHM-INI 29-OCT-2003
               05 CMA-CIC-UING                     PIC X(12).
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
      *MHM-INI 7-OCT-2003
       COPY LDCBRCLF.
       COPY LDCBRLDC.
       COPY LDCBRARG.
       COPY LDCBRRDC REPLACING RDC BY RDL.
       COPY COLBROPC.
       COPY COLBRRDC.
       COPY GARBRGDD.
      *PVG INI 15-OCT-2003
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
      *PVG FIN 15-OCT-2003
      *MHM-FIN 7-OCT-2003
       COPY GARBRGDG.
       COPY GARBRGSO.
       COPY GARBRGES.
       COPY GARBRGVT.
       COPY GARBRTAG.
       COPY GARWGVCG.
*% IF PGM_CLB OR PGM_MEX
       COPY GARBRGAP.
       COPY GARBRGDO.
       COPY GARBRGDP.
       COPY GARBRGIN.
       COPY GARBRGLE.
       COPY GARBRGMO.
       COPY GARBRGSI.
       COPY GARBRGTP.
       COPY GARBRGUB.
       COPY GARBRGVE.
       COPY GARBRGIM.
       COPY GARWGVDO.
       COPY GARWVVCG.
       COPY TABBRIVB.
*% END
*% IF PGM_VAX
      *<<<< PGM_VAX
           03 WSS-REG                          PIC X(03).
      *>>>>
*% END
       01  WSS-VARI.
           03 GAR-VCB                         PIC X(06).
              88 MONEDA-SIN-DECIMALES VALUE '0999  '.
           03 WSS-TSG-OPE.                              
              05 WSS-COD-TOPE                  PIC X(03).
              05 WSS-COD-SOPE                  PIC X(03).
*% IF (NOT PGM_PQ) OR (PGM_CLB) OR (PGM_MEX)
      *<<<< NOT PGM_PQ
           03 WSS-COD-PESO.
              05 WSS-IND-TMON                 PIC X(01).
              05 WSS-COD-REST                 PIC X(05).
      *>>>>
*% END
*% IF FMT_CHI
      *<<<< FMT_CHI
           03 WSS-COD-CGTA.
              05 WSS-TIP-CGTA                 PIC X(03).
              05 WSS-STP-CGTA                 PIC X(03).
      *>>>>
*% END
*% IF GEN_BCI
      *<<<< GEN_BCI
      *PVG INI 15-OCT-2003 DATO ADICIONAL 2 DE TAB/AUX
           03 WSS-IND-AREN  VALUE 'N'           PIC X(01).
      *PVG FIN 15-OCT-2003
      *    INDICADOR DE EXCEPCION NORMATIVA DE SEGUROS UNO
           03 WSS-IND-ENS1    VALUE SPACES      PIC X(01).
      *    INDICADOR DE EXCEPCION NORMATIVA DE SEGUROS DOS
           03 WSS-IND-ENS2    VALUE SPACES      PIC X(01).
           03 WSS-VAL-SCRE    VALUE ZEROES      PIC 9(13)V9(04).
           03 WSS-FEC-FVTS.
              05 WSS-NUM-SVTS                   PIC 9(02).
              05 WSS-NUM-AVTS                   PIC 9(02).
              05 WSS-NUM-MVTS                   PIC 9(02).
              05 WSS-NUM-DVTS                   PIC 9(02).
      *MHM-INI 23-OCT-2003
           03 WSS-GLS-CGTA.
              05 WSS-GLS-TOPE                   PIC X(40).
              05 WSS-GLS-SOPE                   PIC X(40).
      *MHM-FIN 23-OCT-2003
      *>>>>
*% END
       COPY GARWGEXV.

      *MHM-INI 23-OCT-2003
       COPY GNSWGCPT.
      *MHM-FIN 23-OCT-2003
       COPY GNSWGPES.
*% IF PGM_CHI AND PGM_PQ
      *<<<< PGM_CHI AND PGM_PQ
           COPY USPC113.
      *>>>>
*% END
*% IF PGM_DTC
      *<<<< PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
      *MHM-INI 7-OCT-2003
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
      *MHM-FIN 7-OCT-2003
      *>>>>
*% END
*% END
*% CMA_USR = TRUE
*% IF CMA AND NOT PGM_VAX
*% IF NOT PGM_MCP
      *MHM-INI 02-DIC-2003
      *     02 FILLER                       PIC X(284).
           02 FILLER                       PIC X(300).
      *MHM-FIN 02-DIC-2003
*% ELSE
           01 FILLER                       PIC X(284).
*% END
*% END
*% IF INI_FIO AND NOT PGM_VAX
      *<<<< INI_FIO
      *MHM-INI 02-DIC-2003
      *     MOVE +284 TO SCR-TCMA.
           MOVE +300 TO SCR-TCMA.
      *MHM-FIN 02-DIC-2003
      *>>>>
*% END
*% IF INI_FIO AND PGM_VAX
      *<<<< INI_FIO

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GES.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GES.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GVT.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-TAG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-TAG.

      *>>>> INI_FIO
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      * Llama a Subrutina Validacion Consistencia Garantia
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM GAR-PRO-VCG
               GO TO FIN-FND-KEY.
      
*% FIN_BUS_HIJ = TRUE
       BUS-GDG.
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

           MOVE FIO-STAT TO PGM-STAT-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
*% IF PGM_CHI
      *<<<< PGM_CHI
      *
           IF SCR-CCPP = 'ACC' AND 
              SCR-STAT = SCR-STAT-CON
              GO TO FIN-VAL-OFI-USP-GSE.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-VAL-OFI-USP-GSE.
      *ALD-BCI-INI/07032000
           COPY USPC143.
           MOVE 'GARGTUCG/CEN' TO USP-PTA-STR.
           COPY USPC103.
           IF USP-PERMISO = 'P'
               GO TO FIN-VAL-OFI-USP-GSE.
      *    COPY USPC143.
      *ALD-BCI-FIN/07032000
           IF USP-COD-OFICINA NOT = GDG-COD-OFIC IN GDG 
               MOVE 'USRNODEOFI' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

       FIN-VAL-OFI-USP-GSE.
      *
      *>>>>
*% END
*% IF PGM_PER AND PGM_GVT
      *<<<< PGM_PER AND PGM_GVT
       COPY GARBVUOF.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-FND-KEY.
      *>>>>
*% END

       FIN-BUS-GDG.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN GSE-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN GSE-FLD.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GDG TO GDG-COD-CGTA IN GSE-FLD.
*% END
      *
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB'  TO TAB-COD-SIST.
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
      *
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GSE-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GSE-FLD TO TAG-STP-AGTA IN TAG.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GSE-FLD TO TAG-COD-AGTA IN TAG.
*% END
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GSE-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GSE-FLD.
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GSE-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GSE-FLD.
      *MHM-FIN 23-OCT-2003

      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           MOVE FIO-STAT TO PGM-STAT-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'GAR' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB
                     
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TREA IN GSE-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TREA IN GSE-FLD.
      *PVG INI 14-OCT-2003
           IF TAG-COD-TPOL IN TAG > SPACES
              MOVE TAG-COD-TPOL IN TAG TO TAG-COD-TPOL IN GSE-FLD
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'POL'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-TPOL IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TPOL IN GSE-FLD
              ELSE
                 MOVE SPACES              TO FRM-GLS-TPOL IN GSE-FLD.
      *PVG FIN 14-OCT-2003

           MOVE GDG-CAI-GTIA IN GDG TO GAR-CAI-GTIA IN CMA-VARI.
           MOVE GDG-IIC-GTIA IN GDG TO GAR-IIC-GTIA IN CMA-VARI.
           IF SCR-CMND = 'ING'
               PERFORM PUT-GDG-GSE.

      * Valida Este permitido esta Entidad para Tipo-Subtipo
           IF TAG-IND-EGSE IN TAG = 'N'
               MOVE 'TAG    NOPGM' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
               PERFORM BUS-COR-GSE
               GO TO CON-FND-KEY.

           IF GSE-NUM-IGSE IN GSE NOT > ZEROES
               PERFORM BUS-COR-GSE.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      * Comando Consulta Error lo trata el GENESIS
           IF SCR-CCPP = 'ACC' AND SCR-STPP = SCR-STAT-CON
               GO TO FIN-FND-KEY.

      * Garantia Alzada
           IF GDG-IND-EST1 IN GDG > '19'
               MOVE 'GDGALZ' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      * Garantia Completa
           IF SCR-CCPP = 'ELI' AND
              GDG-IND-GTAC IN GDG = 'S'
               MOVE 'GAR    CPL' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           GO TO FIN-FND-KEY.
       ERR-FND-KEY.
           MOVE 'GAR' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE SCR-STAT-ABT TO SCR-STAT.
           IF SCR-CCPP = 'ING'
               MOVE '00' TO FIO-STAT
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT.

      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE SPACES TO GSE.
           MOVE SPACES TO GSE-GLS-FLAG IN GSE.
           MOVE SPACES TO GSE-MSC-TACC IN GSE.
           MOVE 'I'    TO GSE-MSC-STAT IN GSE.
           MOVE SPACES TO GSE-COD-ICCS IN GSE.
           MOVE SPACES TO GSE-COD-CORS IN GSE.
           MOVE SPACES TO GSE-COD-RTSE IN GSE.
           MOVE SPACES TO GSE-COD-COB1 IN GSE.
           MOVE SPACES TO GSE-COD-COB2 IN GSE.
           MOVE SPACES TO GSE-COD-COB3 IN GSE.
           MOVE SPACES TO GSE-COD-COB4 IN GSE.
           MOVE SPACES TO GSE-COD-COB5 IN GSE.
           MOVE SPACES TO GSE-IND-ENDS IN GSE.
           MOVE SPACES TO GSE-IND-PCUO IN GSE.
           MOVE ZEROES TO GSE-FEC-FVTS IN GSE.
           MOVE ZEROES TO GSE-FEC-FVSG IN GSE.

      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING'
              OR SCR-CMND = 'COP'
               MOVE 'I'      TO GSE-MSC-TACC IN GSE

               MOVE HOY-FHOY TO GSE-FEC-FING IN GSE
*% IF PGM_MVS
               MOVE SCR-USER TO GSE-CIC-UING IN GSE
*% END
           ELSE
*% IF PGM_MVS
*% END
               MOVE 'M'      TO GSE-MSC-TACC IN GSE.
*% IF PGM_MVS
*% END
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en la modificacion : informar               
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *MHM-INI 6-OCT-2003
           MOVE GSE-CAI-GTIA IN GSE TO GDG-CAI-GTIA IN GDG.
           MOVE GSE-IIC-GTIA IN GSE TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE GDG-IND-INOB IN GSE-FLD TO GDG-IND-INOB IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GAR-FIO-GDG.
      *MHM-FIN 6-OCT-2003
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en el ingreso : informar                    
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING. 

           MOVE GSE-CAI-GTIA IN GSE TO GDG-CAI-GTIA IN GDG.
           MOVE GSE-IIC-GTIA IN GSE TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF FIO-STAT-OKS
      *MHM-INI 6-OCT-2003
               MOVE GDG-IND-INOB IN GSE-FLD TO GDG-IND-INOB IN GDG
      *MHM-FIN 6-OCT-2003
               MOVE 'S' TO GDG-IND-EGSE IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GAR-FIO-GDG.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           MOVE GSE-CAI-GTIA IN GSE TO GDG-CAI-GTIA IN GDG.
           MOVE GSE-IIC-GTIA IN GSE TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE ' ' TO GDG-IND-EGSE IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GAR-FIO-GDG.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND NOT = 'ING'
              GO TO FIN-HBL-FLD-GSO.
           MOVE GSE-CAI-GTIA IN GSE-FLD TO GSO-CAI-GTIA IN GSO.
           MOVE GSE-IIC-GTIA IN GSE-FLD TO GSO-IIC-GTIA IN GSO.
           MOVE 'GSO-KEY-IGDG' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-GSO.
           IF NOT FIO-STAT-OKS
              GO TO FIN-HBL-FLD-GSO.

           IF GSO-COD-RSEG IN GSO > SPACES
               MOVE GSO-COD-RSEG IN GSO TO GSE-COD-RTSE IN GSE-FLD
               MOVE FRM-CPIM-AEY        TO GSE-COD-RTSE-ATR IN GSE-FLD
               MOVE ZEROES              TO GSE-COD-RTSE-LEN IN GSE-FLD
               MOVE FRM-POS-CURS        TO GSE-COD-PLZA-LEN IN GSE-FLD
               MOVE 'GAR'               TO TAB-COD-SIST
               MOVE 'RPB '              TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-RTSE IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-RTSE IN GSE-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-RTSE IN GSE-FLD.

           IF GSO-IND-PCUO IN GSO > SPACES
               MOVE GSO-IND-PCUO IN GSO TO GSE-IND-PCUO IN GSE-FLD
               MOVE FRM-CPIM-AEY        TO GSE-IND-PCUO-ATR IN GSE-FLD

           IF GSO-NUM-CUOT IN GSO > ZEROES
               MOVE GSO-NUM-CUOT IN GSO TO GSE-NUM-CUOT IN GSE-FLD
               MOVE FRM-CPIM-AEY        TO GSE-NUM-CUOT-ATR IN GSE-FLD.
       FIN-HBL-FLD-GSO.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-COR-GSE SECTION.
       INI-BUS-COR-GSE.
           MOVE 999 TO GSE-NUM-IGSE IN GSE.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
           IF NOT ( FIO-STAT-OKS AND
                    GSE-CAI-GTIA IN GSE-FLD = GSE-CAI-GTIA IN GSE AND
                    GSE-IIC-GTIA IN GSE-FLD = GSE-IIC-GTIA IN GSE )
               PERFORM KEY-ALL-GSE
               MOVE ZEROES TO GSE-NUM-IGSE IN GSE.
           IF SCR-CCPP = 'ING'
               ADD 1 TO GSE-NUM-IGSE IN GSE
               MOVE GSE-NUM-IGSE IN GSE TO GSE-NUM-IGSE IN GSE-FLD
           ELSE
               MOVE GSE-NUM-IGSE IN GSE TO GSE-NUM-IGSE IN GSE-FLD.
       FIN-BUS-COR-GSE.
           EXIT.

      *MHM-INI 7-OCT-2003
       EXC-NOR-SEG SECTION.
       INI-EXC-NOR-SEG.
           MOVE 'N' TO WSS-IND-ENS1 IN WSS-VARI.
           MOVE 'N' TO WSS-IND-ENS2 IN WSS-VARI.

           IF GDG-COD-LGTA IN GDG = 'E'
               PERFORM GAR-ESP
           ELSE
               PERFORM GAR-GRL.
           
           IF WSS-VAL-SCRE IN WSS-VARI > ZEROES
               MOVE 'S' TO WSS-IND-ENS1 IN WSS-VARI
               GO TO FIN-EXC-NOR-SEG.
           
           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GDD-EXC-SEG.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           PERFORM GAR-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
              GDD-CAI-GTIA IN GDD = GDG-CAI-GTIA IN GDG AND
              GDD-IIC-GTIA IN GDD = GDG-IIC-GTIA IN GDG)
               GO TO FIN-EXC-NOR-SEG.

           MOVE GDD-CAI-DCLI IN GDD TO RDC-CAI-ICLI IN RDL.
           MOVE GDD-IIC-DCLI IN GDD TO RDC-IIC-ICLI IN RDL.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-RDC-EXC-SEG.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-CAI-ICLI IN RDL = GDD-CAI-DCLI IN GDD AND
              RDC-IIC-ICLI IN RDL = GDD-IIC-DCLI IN GDD )
               GO TO NXT-GDD-EXC-SEG.

           MOVE RDC-CAI-ICLF IN RDL TO CLF-CAI-ICLF IN CLF.
           MOVE RDC-IIC-ICLF IN RDL TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               GO TO NXT-RDC-EXC-SEG.
               
           MOVE CLF-CAI-ICLF IN CLF TO LDC-CAI-ICLF IN LDC.
           MOVE CLF-IIC-ICLF IN CLF TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES              TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LDC-EXC-SEG.
           PERFORM LDC-FIO-LDC.
           IF NOT ( FIO-STAT-OKS AND
              LDC-CAI-ICLF IN LDC = CLF-CAI-ICLF IN CLF AND
              LDC-IIC-ICLF IN LDC = CLF-IIC-ICLF IN CLF )
               GO TO NXT-RDC-EXC-SEG.
               
           IF LDC-IND-VIGE IN LDC NOT = 'S'
               GO TO NXT-LDC-EXC-SEG.
           
           MOVE LDC-CAI-ICLF IN LDC TO ARG-CAI-ICLF IN ARG.
           MOVE LDC-IIC-ICLF IN LDC TO ARG-IIC-ICLF IN ARG.
           MOVE LDC-NUM-ILDC IN LDC TO ARG-NUM-ILDC IN ARG.
           MOVE ZEROES              TO ARG-NUM-IARG IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-ARG-EXC-SEG.
           PERFORM LDC-FIO-ARG.
           IF NOT ( FIO-STAT-OKS AND
              ARG-CAI-ICLF IN ARG = LDC-CAI-ICLF IN LDC AND
              ARG-IIC-ICLF IN ARG = LDC-IIC-ICLF IN LDC AND
              ARG-NUM-ILDC IN ARG = LDC-NUM-ILDC IN LDC )
               GO TO NXT-LDC-EXC-SEG.

           IF GDG-CIC-GTIA IN GDG = ARG-CIC-IGAR IN ARG
               MOVE 'S' TO WSS-IND-ENS2 IN WSS-VARI.
               
           IF GDG-COD-CGTA = ARG-COD-COGA IN ARG
               MOVE 'S' TO WSS-IND-ENS2 IN WSS-VARI.
               
           IF GDG-COD-TOPE = ARG-COD-TOGA IN ARG
               MOVE 'S' TO WSS-IND-ENS2 IN WSS-VARI.

           IF GDG-COD-SOPE = ARG-COD-AOGA IN ARG
               MOVE 'S' TO WSS-IND-ENS2 IN WSS-VARI.
               
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-ARG-EXC-SEG.

       NXT-LDC-EXC-SEG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-LDC-EXC-SEG.

       NXT-RDC-EXC-SEG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-RDC-EXC-SEG.

       NXT-GDD-EXC-SEG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GDD-EXC-SEG.

       FIN-EXC-NOR-SEG.
           EXIT.

       GAR-ESP SECTION.
       INI-GAR-ESP.
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.
           
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.
           MOVE ZEROES TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GAR-ESP.
           PERFORM GAR-FIO-GES.
           IF NOT ( FIO-STAT-OKS AND
              GES-CAI-GTIA IN GES = GDG-CAI-GTIA AND
              GES-IIC-GTIA IN GES = GDG-IIC-GTIA )
               GO TO FIN-GAR-ESP.
           
           MOVE GES-CAI-IOPC IN GES TO OPC-CAI-IOPC IN OPC.
           MOVE GES-IIC-IOPC IN GES TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GAR-ESP.
               
           IF OPC-MSC-STAT IN OPC = 'A'
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
               
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GAR-ESP.
           
       FIN-GAR-ESP.
           EXIT.
           
       GAR-GRL SECTION.
       INI-GAR-GRL.
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI.

           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GDD-GAR-GRL.
           PERFORM GAR-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
              GDD-CAI-GTIA IN GDD = GDG-CAI-GTIA AND
              GDD-IIC-GTIA IN GDD = GDG-IIC-GTIA )
               GO TO FIN-GAR-GRL.

           MOVE GDD-CAI-DCLI IN GDD TO RDC-CAI-ICLI IN RDC.
           MOVE GDD-IIC-DCLI IN GDD TO RDC-IIC-ICLI IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-RDC-GAR-GRL.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-CAI-ICLI IN RDC = GDD-CAI-DCLI IN GDD AND
              RDC-IIC-ICLI IN RDC = GDD-IIC-DCLI IN GDD )
               GO TO NXT-GDD-GRL.
               
           MOVE RDC-CAI-IOPC IN RDC TO OPC-CAI-IOPC IN OPC.
           MOVE RDC-IIC-IOPC IN RDC TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-RDC-GRL.
               
           IF OPC-MSC-STAT IN OPC = 'A'
               ADD OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
               
       NXT-RDC-GRL.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-RDC-GAR-GRL.
           
       NXT-GDD-GRL.
      *PVG INI 15-OCT-2003
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
      *PVG FIN 15-OCT-2003
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GDD-GAR-GRL.

       FIN-GAR-GRL.
           EXIT.
      *MHM-FIN 7-OCT-2003

*% IF PGM_CLB OR PGM_MEX
       COPY TABBFIVB.
       COPY GARBFGAP.
       COPY GARBFGDO.
       COPY GARBFGDP.
       COPY GARBFGIN.
       COPY GARBFGLE.
       COPY GARBFGMO.
       COPY GARBFGSI.
       COPY GARBFGTP.
       COPY GARBFGUB.
       COPY GARBFGVE.
       COPY GARBFGIM.
       COPY GARBGVC2.
       COPY GARBGVDO.
       COPY GARBVVCG.
*% END
       COPY GARBFGDG.
       COPY GARBFGSO.
       COPY GARBFGES.
       COPY GARBFGVT.
       COPY GARBFTAG.
      *MHM-INI 7-OCT-2003
       COPY LDCBFRDC REPLACING RDC BY RDL
                  ==ADR-RDC-REQA== BY ==ADR-RDL-REQA==.
       COPY LDCBFCLF.
       COPY LDCBFLDC.
       COPY LDCBFARG.
       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY GARBFGDD.       
      *MHM-FIN 7-OCT-2003

       COPY GARBGVCG.
       COPY GARBKVCG.
      *MHM-INI 23-OCT-2003
       COPY GNSBGCPT.
      *MHM-FIN 23-OCT-2003

       COPY GNSBGPES.
*% IF (PGM_CLB OR PGM_MVS OR PGM_MEX) AND PGM_PQ
       COPY GNSBPFEC.
*% END
      *>>>>
*% END
