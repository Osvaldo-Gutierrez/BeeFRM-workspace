*% FRM = 'GDP'
*% REG = 'GDP'
*% IF FIN_FST_FLD_GDP
      *<<<< FIN_FST_FLD_GDP
           IF SCR-CCPP = 'ING'
               GO TO FIN-FST-FLD-GDP.

           IF GAR-IND-GTAC IN CMA-VARI = 'S'
               MOVE FRM-CPIM-AEY TO GDP-COD-TDPN-ATR IN GDP-FLD
               MOVE FRM-CPIM-AEY TO GDP-COD-TDPN-STP

               MOVE FRM-CPIM-AEY TO GDP-IND-PDPN-ATR IN GDP-FLD
               MOVE FRM-CPIM-AEY TO GDP-IND-PDPN-STP

               MOVE FRM-CPIM-AEY TO GDP-NUM-PDPN-ATR IN GDP-FLD
               MOVE FRM-CPIM-AEY TO GDP-NUM-PDPN-STP

               MOVE 0            TO GDP-COD-TDPN-LEN IN GDP-FLD
               MOVE FRM-POS-CURS TO GDP-IND-VDPN-LEN IN GDP-FLD.
      *>>>>
*% END
*% IF GDP_IND_VDPN
      *<<<< GDP_IND_VIG_DPN
           IF GDP-IND-VDPN IN GDP-FLD NOT > SPACES
               MOVE 'S' TO GDP-IND-VDPN IN GDP-FLD
               GO TO FIN-VAL-GDP-IND-VDPN.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'  TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDP-IND-VDPN IN GDP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-GDP-IND-VDPN.

           IF SCR-CCPP = 'MOD' AND
              GDP-IND-VDPN IN GDP-FLD  = 'N' AND
              GAR-IND-GTAC IN CMA-VARI NOT = 'S'
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GDP    NOAGA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDP-IND-VDPN.
      *>>>>
*% END
*% IF VAL_CON_FLD_GDP
      *<<<< VAL_CON_FLD_GDP
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-CON-FLD-GDP.

      * Busca GVT
           MOVE GDP-CAI-GTIA IN GDP-FLD  TO GVT-CAI-GTIA IN GVT.
           MOVE GDP-IIC-GTIA IN GDP-FLD  TO GVT-IIC-GTIA IN GVT.
           MOVE GAR-COD-TASN IN CMA-VARI TO GVT-COD-TASN IN GVT.
           MOVE 'GVT-KEY-IGVT' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           IF NOT FIO-STAT-OKS
               MOVE 'GVT    NEX' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.
      *PVG INI 15-OCT-2003
      *    MOVE GVT-SGV-VPND IN GVT TO GDP-SGV-TSNO IN GDP-FLD.
           MOVE GVT-SGV-LTSN IN GVT TO GDP-SGV-TSNO IN GDP-FLD.
      *PVG FIN 15-OCT-2003
           IF GDP-SGV-TSNO IN GDP-FLD = ZEROES
               MOVE 'GDPVALORI=0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

           MOVE GVT-NUM-STSN IN GVT TO GDP-NUM-STSO IN GDP-FLD.
           MOVE GVT-NUM-ATSN IN GVT TO GDP-NUM-ATSO IN GDP-FLD.
           MOVE GVT-NUM-MTSN IN GVT TO GDP-NUM-MTSO IN GDP-FLD.
           MOVE GVT-NUM-DTSN IN GVT TO GDP-NUM-DTSO IN GDP-FLD.

           IF GDP-FEC-FTSO IN GDP-FLD NOT > ZEROES
               MOVE 'GDPFECORI=0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

      * Obtiene Fecha Proxima Depreciacion
*% IF PGM_ARG
      *<<<< PGM_ARG
      *ALD-BNL
           MOVE GDP-CAI-GTIA IN GDP-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GDP-IIC-GTIA IN GDP-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           MOVE GDG-NUM-SEST IN GDG TO FEC-ITM3.
           MOVE GDG-NUM-AEST IN GDG TO FEC-ITM4. 
           MOVE GDG-NUM-MEST IN GDG TO FEC-ITM2. 
           MOVE GDG-NUM-DEST IN GDG TO FEC-ITM1. 
*% ELSE
      *<<<< NOT PGM_ARG
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO FEC-ITM1.
           MOVE HOY-MHOY TO FEC-ITM2.
           MOVE HOY-SHOY TO FEC-ITM3.
           MOVE HOY-AHOY TO FEC-ITM4.
      *>>>>
*% END
           IF GDP-IND-PDPN IN GDP-FLD NOT = 'A' AND
              GDP-IND-PDPN IN GDP-FLD NOT = 'M'
               MOVE 'GDPPDPNMAL' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

           IF GDP-IND-PDPN IN GDP-FLD = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE 1 TO FEC-NANO
           ELSE
           IF GDP-IND-PDPN IN GDP-FLD = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE 1 TO FEC-NMES.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.

           MOVE FEC-ITM1 TO GDP-NUM-DPDP IN GDP-FLD.
           MOVE FEC-ITM2 TO GDP-NUM-MPDP IN GDP-FLD.
           MOVE FEC-ITM3 TO GDP-NUM-SPDP IN GDP-FLD.
           MOVE FEC-ITM4 TO GDP-NUM-APDP IN GDP-FLD.

           IF FEC-FVLD NOT > HOY-FHOY
               MOVE 'GDPFECPXM<HY' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

      * Obtiene Valor Proxima Depreciacion
           IF GDP-COD-TDPN IN GDP-FLD = 'L'
               COMPUTE GDP-SGV-PDPN IN GDP-FLD ROUNDED =
      *MHM-INI 8-SEP-2003
      *                 GVT-SGV-VPND IN GVT /
                       GVT-SGV-LTSN IN GVT /
      *MHM-FIN 8-SEP-2003
                       GDP-NUM-PDPN IN GDP-FLD
           ELSE
           IF GDP-COD-TDPN IN GDP-FLD = 'D'
               COMPUTE GDP-SGV-PDPN IN GDP-FLD ROUNDED =
      *MHM-INI 8-SEP-2003
      *                 GVT-SGV-VPND IN GVT /
                       GVT-SGV-LTSN IN GVT /
      *MHM-FIN 8-SEP-2003
                       GDP-NUM-PDPN IN GDP-FLD * 2
           ELSE
           IF GDP-COD-TDPN IN GDP-FLD = 'A'
               MOVE ZEROES TO WSS-FACT
               PERFORM CAL-TASA-DPN VARYING I FROM 1 BY 1
                       UNTIL I > GDP-NUM-PDPN IN GDP-FLD

               COMPUTE GDP-SGV-PDPN IN GDP-FLD ROUNDED =
      *MHM-INI 8-SEP-2003
      *                 GVT-SGV-VPND IN GVT *
                       GVT-SGV-LTSN IN GVT *
      *MHM-FIN 8-SEP-2003
                       GDP-NUM-PDPN IN GDP-FLD / WSS-FACT
           ELSE
               MOVE ZEROES TO GDP-SGV-PDPN IN GDP-FLD.

           IF GDP-SGV-PDPN IN GDP-FLD = ZEROES
               MOVE 'GDPVALPXM=0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-GDP.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF GDG-COD-VCAM IN GDP-FLD = TAB-COD-CTAB IN TAB

               MOVE GDG-COD-VCAM IN GDP-FLD TO PES-COD-VCAM
               MOVE GDP-SGV-PDPN IN GDP-FLD TO PES-SGV-DECI
                    
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE TO GDP-SGV-PDPN IN GDP-FLD.
                    
           GO TO FIN-VAL-CON-FLD-GDP.

       ERR-VAL-CON-FLD-GDP.
           MOVE 'GAR'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       CAL-TASA-DPN SECTION.
       INI-CAL-TASA-DPN.
               COMPUTE WSS-FACT = WSS-FACT + I.
       FIN-CAL-TASA-DPN.
           EXIT.
      *>>>>
*% END
*% IF FIN_PUT_GDG_GDP
      *<<<< FIN_PUT_GDG_GDP
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GDP-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GDP-FLD TO TAG-STP-AGTA IN TAG.
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GDP-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GDP-FLD.
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GDP-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GDP-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GDP-FLD.
      *MHM-FIN 23-OCT-2003
      *>>>>
*% END
