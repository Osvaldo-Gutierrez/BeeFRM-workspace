*%! PARA MANEJAT DATACOM DESDE AMBIENTE VSAM INTERACTIVO
*%! INCLUDE 'GARSRC:GNSVSIDTC.SRC'
*% FRM = 'GSO'
*% REG = 'GSO'
*% PGM_PTC = TRUE
*% LARGO_TOTAL_COMMAREA = 255
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
      *PVG INI 15-OCT-2003
           02 SCR-COD-GSO-ANT                      PIC X(02).
           02 SCR-COD-JUD-ANT                      PIC X(02).
           02 SCR-COD-TPRO                         PIC X(01).
      *PVG FIN 15-OCT-2003
      *>>>>
*%END
*% IF WSS
      *<<<< WSS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSE-REQA==.      
      *CGL-FIN  11-SEP-2003 14:47:13 
       COPY GNSWXGSL.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GLE-REQA==.
      *CGL-INI  11-SEP-2003 14:47:07 
       COPY GARBRGSE.
       COPY GARBRGLE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GAP-REQA==.
      *CGL-FIN  11-SEP-2003 14:47:13 
       COPY GARBRTAG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY TABBRUSR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGPES.
       COPY GARBRGDD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
       COPY GARBRGDG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GARBRGSL.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSL-REQA==.
       COPY GARBRGVT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
       COPY GARBRGUB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GUB-REQA==.
       COPY GARBRGIM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIM-REQA==.
       COPY GARBRGIN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIN-REQA==.
       COPY GARBREST.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EST-REQA==.

       01  WSS-VARI.
      **     03 WSS-NUM-TIPO-ALF                           PIC X(06).
      **     03 WSS-NUM-TIPO REDEFINES  WSS-NUM-TIPO-ALF   PIC 9(06).
           03 WSS-IND-OK                                 PIC X(01). 
           03 WSS-IND-GVT                                PIC X(01).
           03 WSS-IND-EST1.
              05 WSS-NUM-EST1                            PIC 9(02).
           03 WSS-COD-EST2. 
              05 WSS-NUM-EST2                            PIC 9(02).

      **     03 WSS-TIPO-DIV.
      **        05 WSS-TIPO                                PIC X(03).
      **        05 WSS-DIV                                 PIC X(03).
           03 WSS-TSG-OPE.                               
              05 WSS-COD-TOPE                            PIC X(03).
              05 WSS-COD-SOPE                            PIC X(03).
      *
      **     03 WSS-COD-PESO.
      **        05 WSS-IND-TMON                  PIC X(01).
      **        05 WSS-COD-REST                  PIC X(05).
           
           03 PGM-STAT-ADI.
              05  PGM-STAT-GDG           VALUE '23'   PIC X(02).
                  88 PGM-STAT-GDG-OKS    VALUE '00'.
                  88 PGM-STAT-GDG-NUL    VALUE '  '.
              05  PGM-STAT-GSL           VALUE '23'   PIC X(02).
                  88 PGM-STAT-GSL-OKS    VALUE '00'.
                  88 PGM-STAT-GSL-NUL    VALUE '  '.
           03 WSS-FEC-EDIT.
              05  WSS-NUM-DEDIT                 PIC 9(02).
              05  WSS-NUM-MEDIT                 PIC 9(02).
              05  WSS-NUM-SEDIT                 PIC 9(02).
              05  WSS-NUM-AEDIT                 PIC 9(02).
      *CGL-INI  11-SEP-2003 12:50:01  
           03 WSS-FEC-EDII.
              05  WSS-NUM-DEDII                 PIC 9(02).
              05  WSS-NUM-MEDII                 PIC 9(02).
              05  WSS-NUM-SEDII                 PIC 9(02).
              05  WSS-NUM-AEDII                 PIC 9(02).
      *CGL-FIN  11-SEP-2003 12:50:09 
      *>>>>
*% END
*% IF FIN_INI
      *<<<< FIN_INI
           MOVE TSK-TERM-ALF TO WSX-COD-TERM IN WSX-TSGSL.
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
      *PVG INI 14-OCT-2003
           IF SCR-CMND = 'ING'
              MOVE FRM-CPIM-UBY TO GSO-NUM-SBGL-ATR.
      *PVG FIN 14-OCT-2003
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *>>>> FIN_HBL_FLD
      *CGL-INI  11-SEP-2003 12:08:00 
      *      IF SCR-CMND = 'AEG' 
             IF SCR-CMND = 'AEG' OR SCR-CMND = 'AEJ'
      *CGL-FIN  11-SEP-2003 12:08:35 
                GO TO FIN-HBL-FLD.

            MOVE FRM-CPIM-AEY   TO GSO-COD-ESGA-ATR IN GSO-FLD.
            MOVE FRM-CPIM-AEY   TO GSO-COD-ESGA-STP.
            MOVE FRM-CPIM-AEY   TO GSO-COD-EST2-ATR IN GSO-FLD.
            MOVE FRM-CPIM-AEY   TO GSO-COD-EST2-STP.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *CGL-INI  12-SEP-2003 11:41:04 
           MOVE GSO-CAI-GTIA IN GSO-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-STAT TO PGM-STAT-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
      *PVG INI 14-OCT-2003
           IF SCR-CMND = 'ING' AND GDG-IND-GTAC IN GDG = 'S' AND
              GDG-IND-EST1 IN GDG > '09' AND
              GDG-IND-EST1 IN GDG < '19'
              MOVE 'GDG    AGAYA' TO MSG-COD-MENS
              GO TO ERR-FND-KEY.
      *PVG FIN 14-OCT-2003
           IF SCR-CMND = 'CON' AND
              GSO-NUM-SBGL IN GSO-FLD NOT > ZEROES 
              MOVE GSO-CAI-GTIA IN GSO-FLD TO GSO-CAI-GTIA IN GSO
              MOVE GSO-IIC-GTIA IN GSO-FLD TO GSO-IIC-GTIA IN GSO
              MOVE 'GSO-KEY-IGDG' TO FIO-AKEY
              MOVE FIO-GET-NLS TO FIO-CMND
              PERFORM GAR-FIO-GSO
              IF NOT FIO-STAT-OKS
                 MOVE 'GSO    NEX' TO MSG-COD-MENS
                 GO TO ERR-FND-KEY
              ELSE
                 MOVE GSO-NUM-SBGL IN GSO TO GSO-NUM-SBGL IN GSO-FLD.

           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-KEY-IGSL IN GSL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSL.
           MOVE FIO-STAT TO PGM-STAT-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GSL    NEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           MOVE GSL-COD-TPRO IN GSL TO SCR-COD-TPRO IN SCR-VARI. 
           IF SCR-CMND = 'ING' 
      *cgl-ini  7-SEP-2003 15:01:59 
      *         IF GSL-COD-ESOL IN GSL NOT = '05' AND 
      *            GSL-COD-ESOL IN GSL NOT = '01'
                IF GSL-COD-ESOL IN GSL NOT = '01'
      *cgl-fin  7-SEP-2003 15:02:46    
                   MOVE 'GSLESOLNO0105' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY
               ELSE
                   IF GDG-IND-EST1 IN GDG = '05'
                       PERFORM LEE-OTRA-GSO
                       IF FIO-STAT-OKS AND 
                          GDG-KEY-IGDG IN GDG = GSO-KEY-IGDG IN GSO
                           MOVE 'GDG ASOC EX' TO MSG-COD-MENS
                           GO TO ERR-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      *PVG INI 14-OCT-2003
           IF NOT FIO-STAT-OKS AND SCR-CMND = 'ELI'
              MOVE 'GSO    NEX' TO MSG-COD-MENS
              GO TO ERR-FND-KEY.
      *PVG FIN 14-OCT-2003
           MOVE GSO-COD-ESGA IN GSO TO SCR-COD-GSO-ANT IN SCR-VARI.
           MOVE GSO-COD-EST2 IN GSO TO SCR-COD-JUD-ANT IN SCR-VARI.

      * Se realiza Consulta 
           IF SCR-CMND = 'CON' 
               GO TO FIN-FND-KEY.

      * Se intenta Actualizacion
           IF SCR-CMND = 'AEG'
               IF GSO-COD-ESGA IN GSO = '12'
                   MOVE 'GSO    CAN' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY
               ELSE
      *            Se permite activar garantia
                   GO TO MOV-FEC-USER.


      * Se intenta Ingreso.
           IF SCR-CMND NOT = 'ING'
               GO TO OTRO-CMN.

      *    Valida si estado es ejecutado. 
           MOVE GDG-IND-EST1 IN GDG TO WSS-IND-EST1 IN WSS-VARI.
           MOVE GDG-COD-EST2 IN GDG TO WSS-COD-EST2 IN WSS-VARI.
           IF WSS-NUM-EST1 IN WSS-VARI > 10 OR
              WSS-NUM-EST2 IN WSS-VARI > 0
               MOVE 'GSO    NOING' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *    Se permite ingresar garantia 
       INGRESO-VALIDO.
            MOVE '01'     TO GSO-COD-ESGA IN GSO-FLD.
      *PVG INI 14-OCT-2003
           MOVE SPACES                 TO FRM-GLS-CLAS IN GSO-FLD.
           MOVE SPACES                 TO FRM-GLS-TPOL IN GSO-FLD.

           MOVE GDG-COD-TOPE IN GDG    TO TAG-COD-TOPE IN TAG.
           MOVE GDG-COD-SOPE IN GDG    TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
              GO TO CON-FND-KEY.

           IF TAG-COD-CLAS IN TAG > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'CLA'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-CLAS IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-CLAS IN GSO-FLD.

           IF TAG-COD-TPOL IN TAG > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'POL'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-TPOL IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TPOL IN GSO-FLD.
       CON-FND-KEY.
      *PVG FIN 14-OCT-2003
           IF GDG-COD-TOPE IN GDG > SPACES
              MOVE 'TAB'  TO TAB-COD-SIST                 
              MOVE 'TIO ' TO TAB-COD-TTAB IN TAB         
              MOVE GDG-COD-TOPE IN GDG TO TAB-COD-CTAB IN TAB 
              PERFORM BUS-TAB                                    
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TOPE IN GSO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOPE IN GSO-FLD.

           IF GDG-COD-SOPE IN GDG > SPACES
      *BUS-TAB Busca codigo de tabla
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'AUX' TO TAB-COD-TTAB IN TAB
              MOVE SPACES TO TAB-COD-CTAB IN TAB
              MOVE GDG-COD-TOPE IN GDG TO WSS-COD-TOPE IN WSS-VARI
              MOVE GDG-COD-SOPE IN GDG TO WSS-COD-SOPE IN WSS-VARI
              MOVE WSS-TSG-OPE IN WSS-VARI  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-SOPE IN GSO-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-SOPE IN GSO-FLD.             
      *CGL-FIN  7-SEP-2003 15:43:28 

      *Busca Nombre del Cliente.
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-NUM-SBGL IN GSL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSL.
           IF NOT FIO-STAT-OKS
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'SOL  NOEXI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
              GO TO CONTINUA-USR-PA.

            MOVE GSL-CIC-DCLI IN GSL TO DBC-CIC-ICLI IN DBC.
            MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY.
            MOVE FIO-GET-KEY     TO FIO-CMND.
            PERFORM SGC-FIO-DBC.
            IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-DBC
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN GSO-FLD
            ELSE
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
               GO TO CONTINUA-USR-PA.

       CONTINUA-USR-PA.
      *BUS-TAB Glosa de estado GDG.
           IF GDG-IND-EST1 IN GDG > SPACES
             MOVE 'GAR' TO TAB-COD-SIST
             MOVE 'ES1'                TO TAB-COD-TTAB IN TAB
             MOVE GDG-IND-EST1 IN GDG  TO TAB-COD-CTAB IN TAB
             PERFORM BUS-TAB
             MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EST1 IN GSO-FLD.
      *BUS-TAB Glosa de estado GSO.
           IF GSO-COD-ESGA IN GSO-FLD > SPACES
               MOVE 'GAR'  TO TAB-COD-SIST
               MOVE 'EGS ' TO TAB-COD-TTAB IN TAB
               MOVE GSO-COD-ESGA IN GSO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESGA IN GSO-FLD.
       MOV-FEC-USER.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO WSS-NUM-DEDIT.
           MOVE HOY-MHOY TO WSS-NUM-MEDIT.
           MOVE HOY-SHOY TO WSS-NUM-SEDIT.
           MOVE HOY-AHOY TO WSS-NUM-AEDIT.
           MOVE WSS-FEC-EDIT TO FRM-FEC-ESGA IN GSO-FLD.
           IF SCR-USER NOT > SPACES
               MOVE SPACES TO SCR-USER.
           MOVE SCR-USER TO GSO-COD-USER IN GSO-FLD.
      *Nombre de ejecutivo.
           IF GSO-COD-USER IN GSO-FLD > SPACES                      
               MOVE GSO-COD-USER IN GSO-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-USER IN GSO-FLD  
           ELSE                                                     
               MOVE SPACES              TO FRM-GLS-USER IN GSO-FLD. 

           MOVE PGM-STAT-GSO TO FIO-STAT.
           GO TO FIN-FND-KEY.

       OTRO-CMN.
      * Se intenta eliminar
                MOVE PGM-STAT-GSO TO FIO-STAT.
               
           IF SCR-CMND = 'ELI'
               IF GSO-COD-ESGA IN GSO = '01'
      *            Se permite eliminar garantia
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE 'GSOESGA NO01' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY.

           GO TO FIN-FND-KEY.

       ERR-FND-KEY.
           MOVE 'GAR' TO MSG-COD-SIST.

           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE SCR-STAT-CON TO SCR-STAT.
           MOVE '00' TO FIO-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE FRM-NUM-DSGA IN GSO-FLD TO GSO-NUM-DSOL IN GSO.         
           MOVE FRM-NUM-MSGA IN GSO-FLD TO GSO-NUM-MSOL IN GSO.
           MOVE FRM-NUM-SSGA IN GSO-FLD TO GSO-NUM-SSOL IN GSO.
           MOVE FRM-NUM-ASGA IN GSO-FLD TO GSO-NUM-ASOL IN GSO.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
            IF NOT FIO-STAT-OKS
      *         Error inconsistencia en el ingreso : informar
                MOVE FIO-MENS TO FRM-MENS
                GO TO FIN-CMN-ING. 
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
      *cgl-ini  11-SEP-2003 11:54:02
           IF SCR-CMND = 'AEG' 
              IF GSO-COD-ESGA IN GSO-FLD = '07'
                 MOVE GSO-CAI-GTIA IN GSO-FLD TO GSE-CAI-GTIA IN GSE
                 MOVE GSO-IIC-GTIA IN GSO-FLD TO GSE-IIC-GTIA IN GSE
                 MOVE 999                     TO GSE-NUM-IGSE IN GSE
                 MOVE FIO-GET-LEQ TO FIO-CMND
                 PERFORM GAR-FIO-GSE
                 IF NOT FIO-STAT-OKS
                    GO TO CONTINUAR-MOD
                 ELSE
                 IF GSE-CAI-GTIA IN GSE = GSO-CAI-GTIA IN GSO-FLD AND
                    GSE-IIC-GTIA IN GSE = GSO-IIC-GTIA IN GSO-FLD
                    MOVE FIO-GET-KEY-UPD TO FIO-CMND
                    PERFORM GAR-FIO-GSE
                    MOVE '02' TO GSE-COD-ESTA IN GSE
                    MOVE FIO-MOD TO FIO-CMND
                    PERFORM GAR-FIO-GSE.
      *CGL-INI  11-SEP-2003 14:47:23 
           IF SCR-CMND = 'AEJ' 
              IF GSO-COD-EST2 IN GSO-FLD = '05'
                 PERFORM ACTUALIZAR-GLE. 
      *CGL-FIN  11-SEP-2003 14:47:30  
       CONTINUAR-MOD.
      *CGL-FIN  11-SEP-2003 12:06:39 
           MOVE FRM-NUM-DSGA IN GSO-FLD TO GSO-NUM-DSOL IN GSO.         
           MOVE FRM-NUM-MSGA IN GSO-FLD TO GSO-NUM-MSOL IN GSO.
           MOVE FRM-NUM-SSGA IN GSO-FLD TO GSO-NUM-SSOL IN GSO.
           MOVE FRM-NUM-ASGA IN GSO-FLD TO GSO-NUM-ASOL IN GSO.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
            IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : INFORMAR               
                MOVE FIO-MENS TO FRM-MENS
                GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
            IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : INFORMAR               
                MOVE FIO-MENS TO FRM-MENS
                GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GARBFTAG.
      *CGL-INI  11-SEP-2003 14:47:38 
       COPY GARBFGSE.
       COPY GARBFGLE.
      *CGL-FIN  11-SEP-2003 14:47:43 
      *PVG INI 15-OCT-2003
       COPY GARBFGAP.
      *PVG FIN 15-OCT-2003
       COPY SGCBFDBC.
       COPY SGCBGCLI.
       COPY TABBBUSR.
       COPY TABBFUSR.
       COPY GARBFGDG.
       COPY GARBFGDD.
       COPY GARBFGSL.
       COPY GARBFGVT.
       COPY GARBFGUB.
       COPY GARBFGIM.
       COPY GARBFGIN.
      *CGL-INI  14-SEP-2003 17:52:10 
      * COPY GARBFEST.
      *CGL-FIN  14-SEP-2003 17:52:20 
       COPY GNSBGPES.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBPFEC.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
      *CGL-INI  11-SEP-2003 14:47:51 
       ACTUALIZAR-GLE SECTION.
       INI-ACTUALIZAR-GLE.
           MOVE GSO-CAI-GTIA IN GSO-FLD TO GLE-CAI-GTIA IN GLE.
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GLE-IIC-GTIA IN GLE.
           MOVE SPACES                  TO GLE-COD-PACR IN GLE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GLE.
       ACT-GLE.
           IF NOT FIO-STAT-OKS
              GO TO FIN-ACTUALIZAR-GLE
           ELSE
           IF GLE-CAI-GTIA IN GLE = GSO-CAI-GTIA IN GSO-FLD AND
              GLE-IIC-GTIA IN GLE = GSO-IIC-GTIA IN GSO-FLD
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM GAR-FIO-GLE
      *PVG INI 15-OCT-2003
      *       MOVE '02' TO GLE-IND-ESTA IN GLE
              MOVE 'A'  TO GLE-IND-ESTA IN GLE
      *PVG FIN 15-OCT-2003
              MOVE FIO-MOD TO FIO-CMND
              PERFORM GAR-FIO-GLE
      *PVG INI 15-OCT-2003 Compatibilidad VSAM
              MOVE FIO-GET-NLS TO FIO-CMND
              PERFORM GAR-FIO-GLE
      *PVG FIN 15-OCT-2003
              MOVE FIO-GET-NXT TO FIO-CMND
              PERFORM GAR-FIO-GLE
              GO TO ACT-GLE.
       FIN-ACTUALIZAR-GLE.
           EXIT.
      *CGL-FIN  11-SEP-2003 14:47:59 
       LEE-GVA SECTION.
       INI-LEE-GVA.
           MOVE 'S' TO WSS-IND-GVT.
           MOVE 'S' TO WSS-IND-OK.
           MOVE GDG-CIC-GTIA IN GDG TO GVT-CIC-GTIA IN GVT.
           MOVE ZEROES              TO GVT-COD-TASN IN GVT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           IF NOT FIO-STAT-OKS OR 
              GDG-CIC-GTIA IN GDG NOT = GVT-CIC-GTIA IN GVT OR
              GVT-MSC-STAT IN GVT NOT = 'A'
               MOVE 'N' TO WSS-IND-GVT
               MOVE 'N' TO WSS-IND-OK.
       FIN-LEE-GVA.
           EXIT.

       LEE-GIN SECTION.
       INI-LEE-GIN.
           IF WSS-IND-OK = 'N'
              GO TO FIN-LEE-GIN.
           MOVE GDG-CIC-GTIA IN GDG TO GIN-CIC-GTIA IN GIN.
           PERFORM GAR-FIO-GIN.
           IF NOT FIO-STAT-OKS 
               MOVE 'N' TO WSS-IND-OK.
       FIN-LEE-GIN.
           EXIT.

       LEE-GIM SECTION.
       INI-LEE-GIM.
           IF WSS-IND-OK = 'N'
              GO TO FIN-LEE-GIM.
           MOVE GDG-CIC-GTIA IN GDG TO GIM-CIC-GTIA IN GIM.
           PERFORM GAR-FIO-GIM.
           IF NOT FIO-STAT-OKS 
               MOVE 'N' TO WSS-IND-OK.
       FIN-LEE-GIM.
           EXIT.

       LEE-GUB SECTION.
       INI-LEE-GUB.
           IF WSS-IND-OK = 'N'
              GO TO FIN-LEE-GUB.
           MOVE GDG-CIC-GTIA IN GDG TO GUB-CIC-GTIA IN GUB.
           PERFORM GAR-FIO-GUB.
           IF NOT FIO-STAT-OKS 
               MOVE 'N' TO WSS-IND-OK.
       FIN-LEE-GUB.
           EXIT.

       LEE-OTRA-GSO SECTION.
       INI-LEE-OTRA-GSO.
           MOVE GDG-KEY-IGDG IN GDG TO GSO-KEY-IGDG IN GSO.
           MOVE 'GSO-KEY-IGDG' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GSO.
       FIN-LEE-OTRA-GSO.
           EXIT.
      *>>>>
*% END
