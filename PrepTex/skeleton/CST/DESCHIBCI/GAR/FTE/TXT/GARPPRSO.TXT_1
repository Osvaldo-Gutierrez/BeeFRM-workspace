       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   GARPPRSO.
       AUTHOR.       BEE TEAM.
       DATE-WRITTEN. 04-NOV-2002 11:23:21

      * CONSULTA RCC WEB POR CLIENTE

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
      *         DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       COPY GNSWVSCR.
      *AMB 01  SCR-VARI.
      *AMB     05 SCR-SIST     VALUE 'GAR'    PIC X(03).
       COPY GNSWVVRF.
       COPY GNSWCVRF.
       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFRM.
       COPY GNSWGHOY.

       COPY GNSWGQUE.
       COPY GNSWGTSK.

       COPY GARWERSO.
       COPY GARWSRSO.
       COPY GARWSGAP.
       COPY GARWSGDO.
       COPY GARWSGIN.
       COPY GARWSGLE.
       COPY GARWSGSE.
       COPY GARWSGES.
       COPY GARWSGE1.

       COPY SGCBRDBC.
      * COPY GNSWRTAB.
      * COPY GNSWRMSG.
       COPY GNSBRMSC.
      * COPY GNSWRMSC.
      * COPY GNSWSFIO.
       COPY GNSWVNUM.
      * COPY GNSWSNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY TABBROFI.

       COPY GARBRGDG.
       COPY GARBRTAG.
       COPY GARWGVCG.
       COPY GARBRGAP.
       COPY GARBRGDD.
       COPY GARBRGDO.
       COPY GARBRGDP.
       COPY GARBRGES.
       COPY GARBRGIN.
       COPY GARBRGLE.
       COPY GARBRGMO.
       COPY GARBRGSE.
       COPY GARBRGTP.
       COPY GARBRGUB.
       COPY GARBRGVT.
       COPY GARBRGIM.
       COPY GARBRGVE.
       COPY TABBRIVB.
       COPY TABBREST.
       COPY TABBRCIU.
       COPY GARWGVDO.
       COPY GARWVVCG.
       COPY GARBRGSI.

       01  WSS-NUM-CIC    VALUE ZEROES     PIC 9(12).
       01  WSS-NUM-VLR                     PIC X(06).
       01  WSS-NUM-IDX    VALUE ZEROES     PIC 9(02).
       01  WSS-DSP-SEC    VALUE 'S'        PIC X(01).
       01  WSS-DSP-TRC    VALUE 'S'        PIC X(01).
       01  WSS-IND-ERR    VALUE 'N'        PIC X(01).
       01  WSS-SALIDA-DSP.
           03  DSP-GDO-GLS-MENS.
               05 DSP-GDO-GLS-MEN1       PIC X(39) VALUE SPACES.
               05 DSP-GDO-GLS-MEN2       PIC X(40) VALUE SPACES.
           03  DATOS-DSP PIC X(300).

       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-STAT.
              05 PGM-STAT-GSI.
                 88 PGM-STAT-GSI-NUL    VALUE '  '.
                 07 PGM-STT1-GSI        VALUE '2' PIC X(01).
                    88 PGM-STAT-GSI-OKS VALUE '0'.
                 07 PGM-STT2-GSI        VALUE '3' PIC X(01).
              05 PGM-STAT-GDG.
                 88 PGM-STAT-GDG-NUL    VALUE '  '.
                 07 PGM-STT1-GDG        VALUE '2' PIC X(01).
                    88 PGM-STAT-GDG-OKS VALUE '0'.
                 07 PGM-STT2-GDG        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       COPY GNSWGCPT.
       COPY GNSWGSTR.


       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           03 FILLER                            PIC X(3000).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.

           PERFORM INI.
           PERFORM CLR-SALIDA.
           IF CMMA-GAR-COD-ENTIDAD IN CMMA-INPUT = 'GDO'
              PERFORM CON-OCC-GDO
              MOVE GDO-SALIDA TO CMMA-OUTPUT
           ELSE
           IF CMMA-GAR-COD-ENTIDAD IN CMMA-INPUT = 'GSE'
              PERFORM CON-OCC-GSE
              MOVE GSE-SALIDA TO CMMA-OUTPUT
           ELSE
           IF CMMA-GAR-COD-ENTIDAD IN CMMA-INPUT = 'GAP'
              PERFORM CON-OCC-GAP
              MOVE GAP-SALIDA TO CMMA-OUTPUT
           ELSE
           IF CMMA-GAR-COD-ENTIDAD IN CMMA-INPUT = 'GLE' OR 'GAL'
              PERFORM CON-OCC-GLE
              MOVE GLE-SALIDA TO CMMA-OUTPUT
           ELSE
           IF CMMA-GAR-COD-ENTIDAD IN CMMA-INPUT = 'GIN'
              PERFORM CON-OCC-GIN
              MOVE GIN-SALIDA TO CMMA-OUTPUT
           ELSE
           IF CMMA-GAR-COD-ENTIDAD IN CMMA-INPUT = 'GES'
              PERFORM CON-OCC-GES
              MOVE GES-SALIDA TO CMMA-OUTPUT
           ELSE
           IF CMMA-GAR-COD-ENTIDAD IN CMMA-INPUT = 'GE1'
              PERFORM CON-OCC-GE1
              MOVE GE1-SALIDA TO CMMA-OUTPUT
           ELSE
              MOVE 'OPCION INEXISTENTE' TO
                         CMMA-GAR-GLS-MEN1     IN CMMA-OUTPUT
              MOVE SPACES               TO
                         CMMA-GAR-GLS-MEN2     IN CMMA-OUTPUT.

           DISPLAY 'CMMA-OUTPUT :' CMMA-OUTPUT.
           MOVE CMMA-OUTPUT TO DFHCOMMAREA.
       FIN-MAIN.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           EXEC CICS RETURN END-EXEC.


       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.

           MOVE DFHCOMMAREA TO CMMA-INPUT.
           DISPLAY "CMMA-INPUT :" CMMA-INPUT.

      *AMB     MOVE 'GARPPRSO'  TO IDD-PROG FIO-PROG.
      *AMB     MOVE IDD-VARI    TO SYS-CMMA.
      *AMB     MOVE +507        TO SYS-TCMA.
      *AMB     MOVE 'GNSPPIDD'  TO SYS-PROG.
      *AMB     MOVE SYS-LINK    TO SYS-CMND.
      *AMB     PERFORM GNS-PRO-SYS.
      *AMB     MOVE SYS-CMMA TO IDD-VARI.

           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
           MOVE TSK-TERM-ALF TO WSS-TIDD.
           MOVE WSS-QIDD TO SCR-QIDD.
           MOVE WSS-QIDD-LEN TO SCR-LIDD.
           MOVE 'GAR' TO SCR-SIST.
           PERFORM GNS-BUS-IDD.


       FIN-INI.
           EXIT.

       WRIT-QUE SECTION.
       INI-WRIT-QUE.
      *     MOVE CMMA-QRW-GLS-COLA  TO QUE-COLA.
      *     MOVE TS-LEN-TS-QRW      TO QUE-LITM.
      *     MOVE TS-FLD-QRW         TO QUE-ITEM.
      *     MOVE 1                  TO QUE-NITM.
      *     MOVE QUE-PUT            TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
       FIN-WRIT-QUE.
           EXIT.

       ELIM-QUE SECTION.
       INI-ELIM-QUE.
      *     PERFORM GNS-ERR-QUE.
      *     MOVE CMMA-QRW-GLS-COLA  TO QUE-COLA.
      *     MOVE QUE-DEL            TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
       FIN-ELIM-QUE.
           EXIT.

       CLR-SALIDA SECTION.
       INI-CLR-SALIDA.
           MOVE SPACES TO CMMA-OUTPUT.
           MOVE SPACES TO GDO-SALIDA.
           MOVE SPACES TO GSE-SALIDA.
           MOVE SPACES TO GAP-SALIDA.
           MOVE SPACES TO GLE-SALIDA.
           MOVE SPACES TO GIN-SALIDA.
           MOVE SPACES TO GES-SALIDA.
           MOVE SPACES TO GE1-SALIDA.
       FIN-CLR-SALIDA.
           EXIT.

       CON-OCC-GDO SECTION.
       INI-CON-OCC-GDO.

           MOVE CMMA-INPUT-DAT IN CMMA-INPUT TO GDO-ENTRADA.
           MOVE MTX-GDO-IIC-GTIA-ALF IN GDO-ENTRADA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO MTX-GDO-IIC-GTIA IN GDO-ENTRADA
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
                                    MTX-GDO-GLS-MENS IN GDO-SALIDA
               MOVE '1'          TO MTX-GDO-STATUS IN GDO-SALIDA
               GO TO FIN-CON-OCC-GDO.


           MOVE MTX-GDO-CAI-GTIA IN GDO-ENTRADA TO GDG-CAI-GTIA IN GDG.
           MOVE MTX-GDO-IIC-GTIA IN GDO-ENTRADA TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GDO-GLS-MENS IN GDO-SALIDA
               MOVE '1'          TO MTX-GDO-STATUS IN GDO-SALIDA
               GO TO FIN-CON-OCC-GDO.

           MOVE MTX-GDO-CAI-GTIA IN GDO-ENTRADA TO GDO-CAI-GTIA IN GDO.
           MOVE MTX-GDO-IIC-GTIA IN GDO-ENTRADA TO GDO-IIC-GTIA IN GDO.
           MOVE ZEROES                          TO GDO-NUM-IGDO IN GDO.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
           IF FIO-STAT-OKS AND
              MTX-GDO-CAI-GTIA IN GDO-ENTRADA = GDO-CAI-GTIA IN GDO AND
              MTX-GDO-IIC-GTIA IN GDO-ENTRADA = GDO-IIC-GTIA IN GDO
               MOVE SPACES TO MTX-GDO-GLS-MENS IN GDO-SALIDA
               GO TO PUT-GDO-MTX
           ELSE
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'GDO    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GDO-GLS-MENS IN GDO-SALIDA
               MOVE '1'          TO MTX-GDO-STATUS IN GDO-SALIDA
               GO TO FIN-CON-OCC-GDO.


       PUT-GDO-MTX.
           MOVE ZEROES TO WSS-NUM-IDX.
           MOVE 'N' TO WSS-IND-ERR.

           MOVE 'P'             TO MTX-GDO-CAI-GTIA-ATR IN GDO-SALIDA.
           MOVE 'P'             TO MTX-GDO-IIC-GTIA-ATR IN GDO-SALIDA.
           MOVE 'P'             TO MTX-GDG-TIP-CGTA-ATR IN GDO-SALIDA.
           MOVE 'P'             TO MTX-GDG-STP-CGTA-ATR IN GDO-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-OFIC-ATR IN GDO-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-VCAM-ATR IN GDO-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGTA-ATR IN GDO-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGT1-ATR IN GDO-SALIDA.

           MOVE 'GDO'           TO MTX-GAR-COD-ENTIDAD IN GDO-SALIDA.
           MOVE GDO-CAI-GTIA IN GDO TO MTX-GDO-CAI-GTIA IN GDO-SALIDA.
           MOVE GDO-IIC-GTIA IN GDO TO GDO-IIC-GTIA-EDT IN GDO-EDT.
           MOVE GDO-IIC-GTIA-EDT IN GDO-EDT TO
                                       MTX-GDO-IIC-GTIA IN GDO-SALIDA.
           MOVE GDG-TIP-CGTA IN GDG TO MTX-GDG-TIP-CGTA IN GDO-SALIDA.
           MOVE GDG-STP-CGTA IN GDG TO MTX-GDG-STP-CGTA IN GDO-SALIDA.
           MOVE GDG-COD-OFIC IN GDG TO MTX-GDG-COD-OFIC IN GDO-SALIDA.
           MOVE GDG-COD-VCAM IN GDG TO MTX-GDG-COD-VCAM IN GDO-SALIDA.
           MOVE GDG-GLS-DGTA IN GDG TO MTX-GDG-GLS-DGTA IN GDO-SALIDA.
           MOVE GDG-GLS-DGT1 IN GDG TO MTX-GDG-GLS-DGT1 IN GDO-SALIDA.

       PUT-GDO-TS.
           ADD 1 TO WSS-NUM-IDX.

           MOVE 'P' TO MTX-GDO-NUM-IGDO-ATR IN GDO-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDO-COD-DOCU-ATR IN GDO-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDO-COD-TDOC-ATR IN GDO-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-TDOC-ATR IN GDO-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDO-FEC-FCAP-ATR IN GDO-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-COD-TIEM-ATR IN GDO-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDO-COD-EIEM-ATR IN GDO-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-IEMI-ATR IN GDO-SALIDA(WSS-NUM-IDX).

           MOVE GDO-NUM-IGDO IN GDO TO GDO-NUM-IGDO-EDT IN GDO-EDT.
           MOVE GDO-NUM-IGDO-EDT IN GDO-EDT TO MTX-GDO-NUM-IGDO IN
                                              GDO-SALIDA(WSS-NUM-IDX).
           MOVE GDO-COD-DOCU IN GDO TO MTX-GDO-COD-DOCU IN
                                              GDO-SALIDA(WSS-NUM-IDX).
           MOVE GDO-COD-TDOC IN GDO TO MTX-GDO-COD-TDOC IN
                                              GDO-SALIDA(WSS-NUM-IDX).

           IF GDO-COD-TDOC IN GDO > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'DOC'               TO TAB-COD-TTAB IN TAB
              MOVE GDO-COD-TDOC IN GDO TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-TDOC IN
                                              GDO-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES              TO MTX-FRM-GLS-TDOC IN
                                              GDO-SALIDA(WSS-NUM-IDX).

           MOVE GDO-NUM-SCAP IN GDO TO MTX-GDO-NUM-SCAP IN
                                              GDO-SALIDA(WSS-NUM-IDX).
           MOVE GDO-NUM-ACAP IN GDO TO MTX-GDO-NUM-ACAP IN
                                              GDO-SALIDA(WSS-NUM-IDX).
           MOVE GDO-NUM-MCAP IN GDO TO MTX-GDO-NUM-MCAP IN
                                              GDO-SALIDA(WSS-NUM-IDX).
           MOVE GDO-NUM-DCAP IN GDO TO MTX-GDO-NUM-DCAP IN
                                              GDO-SALIDA(WSS-NUM-IDX).

           MOVE 'IDO'               TO MTX-FRM-COD-TIEM IN
                                              GDO-SALIDA(WSS-NUM-IDX).
           MOVE GDO-COD-EIEM IN GDO TO MTX-GDO-COD-EIEM IN
                                              GDO-SALIDA(WSS-NUM-IDX).

           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'GDO'               TO TAB-COD-TTAB IN TAB.
           MOVE GDO-COD-EIEM IN GDO TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES              TO MTX-FRM-GLS-IEMI IN
                                              GDO-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-IEMI IN
                                              GDO-SALIDA(WSS-NUM-IDX).


           IF FRM-MAX-FLD-GDO = WSS-NUM-IDX
              GO TO FIN-CON-OCC-GDO.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
           IF FIO-STAT-OKS AND
              MTX-GDO-CAI-GTIA IN GDO-ENTRADA = GDO-CAI-GTIA IN GDO AND
              MTX-GDO-IIC-GTIA IN GDO-ENTRADA = GDO-IIC-GTIA IN GDO
              GO TO PUT-GDO-TS.

       FIN-CON-OCC-GDO.
           EXIT.

       CON-OCC-GSE SECTION.
       INI-CON-OCC-GSE.

           MOVE CMMA-INPUT-DAT IN CMMA-INPUT TO GSE-ENTRADA.
           MOVE MTX-GSE-IIC-GTIA-ALF IN GSE-ENTRADA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO MTX-GSE-IIC-GTIA IN GSE-ENTRADA
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
                                    MTX-GSE-GLS-MENS IN GSE-SALIDA
               MOVE '1'          TO MTX-GSE-STATUS IN GSE-SALIDA
               GO TO FIN-CON-OCC-GSE.

           MOVE MTX-GSE-CAI-GTIA IN GSE-ENTRADA TO GDG-CAI-GTIA IN GDG.
           MOVE MTX-GSE-IIC-GTIA IN GSE-ENTRADA TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GSE-GLS-MENS IN GSE-SALIDA
               MOVE '1'          TO MTX-GSE-STATUS IN GSE-SALIDA
               GO TO FIN-CON-OCC-GSE.


           MOVE MTX-GSE-CAI-GTIA IN GSE-ENTRADA TO GSE-CAI-GTIA IN GSE.
           MOVE MTX-GSE-IIC-GTIA IN GSE-ENTRADA TO GSE-IIC-GTIA IN GSE.
           MOVE ZEROES                          TO GSE-NUM-IGSE IN GSE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
           IF FIO-STAT-OKS AND
              MTX-GSE-CAI-GTIA IN GSE-ENTRADA = GSE-CAI-GTIA IN GSE AND
              MTX-GSE-IIC-GTIA IN GSE-ENTRADA = GSE-IIC-GTIA IN GSE
               MOVE SPACES TO MTX-GSE-GLS-MENS IN GSE-SALIDA
               GO TO PUT-GSE-MTX
           ELSE
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'GSE    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GSE-GLS-MENS IN GSE-SALIDA
               MOVE '1'          TO MTX-GSE-STATUS IN GSE-SALIDA
               GO TO FIN-CON-OCC-GSE.


       PUT-GSE-MTX.
           MOVE 'N' TO WSS-IND-ERR.
           MOVE ZEROES TO WSS-NUM-IDX.
           MOVE 'P'             TO MTX-GSE-CAI-GTIA-ATR IN GSE-SALIDA.
           MOVE 'P'             TO MTX-GSE-IIC-GTIA-ATR IN GSE-SALIDA.
           MOVE 'P'             TO MTX-GDG-TIP-CGTA-ATR IN GSE-SALIDA.
           MOVE 'P'             TO MTX-GDG-STP-CGTA-ATR IN GSE-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-OFIC-ATR IN GSE-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-VCAM-ATR IN GSE-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGTA-ATR IN GSE-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGT1-ATR IN GSE-SALIDA.

           MOVE 'GSE'           TO MTX-GAR-COD-ENTIDAD IN GSE-SALIDA.
           MOVE GSE-CAI-GTIA IN GSE TO MTX-GSE-CAI-GTIA IN GSE-SALIDA.
           MOVE GSE-IIC-GTIA IN GSE TO GSE-IIC-GTIA-EDT IN GSE-EDT.
           MOVE GSE-IIC-GTIA-EDT IN GSE-EDT TO
                                       MTX-GSE-IIC-GTIA IN GSE-SALIDA.
           MOVE GDG-TIP-CGTA IN GDG TO MTX-GDG-TIP-CGTA IN GSE-SALIDA.
           MOVE GDG-STP-CGTA IN GDG TO MTX-GDG-STP-CGTA IN GSE-SALIDA.
           MOVE GDG-COD-OFIC IN GDG TO MTX-GDG-COD-OFIC IN GSE-SALIDA.
           MOVE GDG-COD-VCAM IN GDG TO MTX-GDG-COD-VCAM IN GSE-SALIDA.
           MOVE GDG-GLS-DGTA IN GDG TO MTX-GDG-GLS-DGTA IN GSE-SALIDA.
           MOVE GDG-GLS-DGT1 IN GDG TO MTX-GDG-GLS-DGT1 IN GSE-SALIDA.

       PUT-GSE-TS.
           ADD 1 TO WSS-NUM-IDX.
           MOVE 'P' TO MTX-GSE-NUM-IGSE-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-RTSE-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-RTSE-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-PLZA-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-ICCS-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-ICCS-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-CORS-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-CORS-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-FEC-FVSG-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-FEC-FVTS-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-VCMS-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-VCMS-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-SGV-SEGU-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-COB1-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-COB1-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-IND-ENDS-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-COB2-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-COB2-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-IND-PCUO-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-COB3-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-COB3-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-COB4-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-COB4-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GSE-COD-COB5-ATR IN GSE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-COB5-ATR IN GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-NUM-IGSE IN GSE TO GSE-NUM-IGSE-EDT IN GSE-EDT.
           MOVE GSE-NUM-IGSE-EDT IN GSE-EDT TO MTX-GSE-NUM-IGSE IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-COD-RTSE IN GSE TO MTX-GSE-COD-RTSE IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           IF GSE-COD-RTSE IN GSE > SPACES
               MOVE 'GAR'               TO TAB-COD-SIST
               MOVE 'RPB '              TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-RTSE IN GSE TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO MTX-FRM-GLS-RTSE IN
                                              GSE-SALIDA(WSS-NUM-IDX)
           ELSE
               MOVE SPACES TO  MTX-FRM-GLS-RTSE IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-COD-PLZA IN GSE TO MTX-GSE-COD-PLZA IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-COD-ICCS IN GSE TO MTX-GSE-COD-ICCS IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           IF GSE-COD-ICCS IN GSE > SPACES
              MOVE 'CSE'                    TO IVB-COD-TTAB IN IVB
              MOVE GSE-COD-ICCS IN GSE      TO IVB-COD-EIVB IN IVB
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-IVB
              IF NOT FIO-STAT-OKS
                 MOVE 'CODICCSNEX' TO MSG-COD-MENS
                 MOVE 'GAR' TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO MTX-FRM-GLS-ICCS IN
                                              GSE-SALIDA(WSS-NUM-IDX)
              ELSE
                 MOVE IVB-GLS-DESC IN IVB TO MTX-FRM-GLS-ICCS IN
                                              GSE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-ICCS IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-COD-CORS IN GSE TO MTX-GSE-COD-CORS IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           IF GSE-COD-CORS IN GSE > SPACES
              MOVE 'SEG'                    TO IVB-COD-TTAB IN IVB
              MOVE GSE-COD-CORS IN GSE      TO IVB-COD-EIVB IN IVB
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-IVB
              IF NOT FIO-STAT-OKS
                 MOVE 'CODCORSNEX' TO MSG-COD-MENS
                 MOVE 'GAR' TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO MTX-FRM-GLS-CORS IN
                                              GSE-SALIDA(WSS-NUM-IDX)
              ELSE
                 MOVE IVB-GLS-DESC IN IVB TO MTX-FRM-GLS-CORS IN
                                              GSE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-CORS IN
                                              GSE-SALIDA(WSS-NUM-IDX).


           MOVE GSE-NUM-DVSG IN GSE TO MTX-GSE-NUM-DVSG IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           MOVE GSE-NUM-MVSG IN GSE TO MTX-GSE-NUM-MVSG IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           MOVE GSE-NUM-SVSG IN GSE TO MTX-GSE-NUM-SVSG IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           MOVE GSE-NUM-AVSG IN GSE TO MTX-GSE-NUM-AVSG IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-NUM-DVTS IN GSE TO MTX-GSE-NUM-DVTS IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           MOVE GSE-NUM-MVTS IN GSE TO MTX-GSE-NUM-MVTS IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           MOVE GSE-NUM-SVTS IN GSE TO MTX-GSE-NUM-SVTS IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           MOVE GSE-NUM-AVTS IN GSE TO MTX-GSE-NUM-AVTS IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-COD-VCMS IN GSE TO MTX-GSE-COD-VCMS IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           IF GSE-COD-VCMS IN GSE > ZEROES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR '              TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-VCMS IN GSE TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-VCMS IN
                                              GSE-SALIDA(WSS-NUM-IDX)
           ELSE
               MOVE SPACES              TO MTX-FRM-GLS-VCMS IN
                                              GSE-SALIDA(WSS-NUM-IDX).


           MOVE GSE-SGV-SEGU IN GSE TO GSE-SGV-SEGU-EDT IN GSE-EDT.
           MOVE GSE-SGV-SEGU-EDT IN GSE-EDT TO MTX-GSE-SGV-SEGU IN
                                              GSE-SALIDA(WSS-NUM-IDX).


           MOVE GSE-COD-COB1 IN GSE TO MTX-GSE-COD-COB1 IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           IF GSE-COD-COB1 IN GSE > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'CBS '              TO TAB-COD-TTAB IN TAB
              MOVE GSE-COD-COB1 IN GSE TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-COB1 IN
                                              GSE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-COB1 IN
                                              GSE-SALIDA(WSS-NUM-IDX).


           MOVE GSE-IND-ENDS IN GSE TO MTX-GSE-IND-ENDS IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           MOVE GSE-COD-COB2 IN GSE TO MTX-GSE-COD-COB2 IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           IF GSE-COD-COB2 IN GSE > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'CBS '              TO TAB-COD-TTAB IN TAB
              MOVE GSE-COD-COB2 IN GSE TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-COB2 IN
                                              GSE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-COB2 IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-IND-PCUO IN GSE TO MTX-GSE-IND-PCUO IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           MOVE GSE-COD-COB3 IN GSE TO MTX-GSE-COD-COB3 IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           IF GSE-COD-COB3 IN GSE > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'CBS '              TO TAB-COD-TTAB IN TAB
              MOVE GSE-COD-COB3 IN GSE TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-COB3 IN
                                              GSE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-COB3 IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-COD-COB4 IN GSE TO MTX-GSE-COD-COB4 IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           IF GSE-COD-COB4 IN GSE > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'CBS '              TO TAB-COD-TTAB IN TAB
              MOVE GSE-COD-COB4 IN GSE TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-COB4 IN
                                              GSE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-COB4 IN
                                              GSE-SALIDA(WSS-NUM-IDX).

           MOVE GSE-COD-COB5 IN GSE TO MTX-GSE-COD-COB5 IN
                                              GSE-SALIDA(WSS-NUM-IDX).
           IF GSE-COD-COB5 IN GSE > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'CBS '              TO TAB-COD-TTAB IN TAB
              MOVE GSE-COD-COB5 IN GSE TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-COB5 IN
                                              GSE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-COB5 IN
                                              GSE-SALIDA(WSS-NUM-IDX).



           IF FRM-MAX-FLD-GSE = WSS-NUM-IDX
              GO TO FIN-CON-OCC-GSE.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
           IF FIO-STAT-OKS AND
              MTX-GSE-CAI-GTIA IN GSE-ENTRADA = GSE-CAI-GTIA IN GSE AND
              MTX-GSE-IIC-GTIA IN GSE-ENTRADA = GSE-IIC-GTIA IN GSE
              GO TO PUT-GSE-TS.

       FIN-CON-OCC-GSE.
           EXIT.

       CON-OCC-GAP SECTION.
       INI-CON-OCC-GAP.

           MOVE CMMA-INPUT-DAT IN CMMA-INPUT TO GAP-ENTRADA.

           DISPLAY 'GAP-ENTRADA :' GAP-ENTRADA.

           MOVE MTX-GAP-IIC-GTIA-ALF IN GAP-ENTRADA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO MTX-GAP-IIC-GTIA IN GAP-ENTRADA
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
                                    MTX-GAP-GLS-MENS IN GAP-SALIDA
               MOVE '1'          TO MTX-GAP-STATUS IN GAP-SALIDA
               GO TO FIN-CON-OCC-GAP.

           MOVE MTX-GAP-CAI-GTIA IN GAP-ENTRADA TO GDG-CAI-GTIA IN GDG.
           MOVE MTX-GAP-IIC-GTIA IN GAP-ENTRADA TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GAP-GLS-MENS IN GAP-SALIDA
               MOVE '1'          TO MTX-GAP-STATUS IN GAP-SALIDA
               GO TO FIN-CON-OCC-GAP.

           MOVE MTX-GAP-CAI-GTIA IN GAP-ENTRADA TO GAP-CAI-GTIA IN GAP.
           MOVE MTX-GAP-IIC-GTIA IN GAP-ENTRADA TO GAP-IIC-GTIA IN GAP.
           MOVE ZEROES                          TO GAP-COD-PACR IN GAP.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF FIO-STAT-OKS AND
              MTX-GAP-CAI-GTIA IN GAP-ENTRADA = GAP-CAI-GTIA IN GAP AND
              MTX-GAP-IIC-GTIA IN GAP-ENTRADA = GAP-IIC-GTIA IN GAP
               MOVE SPACES TO MTX-GAP-GLS-MENS IN GAP-SALIDA
               GO TO PUT-GAP-MTX
           ELSE
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GAP    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GAP-GLS-MENS IN GAP-SALIDA
               MOVE '1'          TO MTX-GAP-STATUS IN GAP-SALIDA
               GO TO FIN-CON-OCC-GAP.

       PUT-GAP-MTX.
           MOVE 'N' TO WSS-IND-ERR.
           MOVE ZEROES TO WSS-NUM-IDX.

           MOVE 'P'             TO MTX-GAP-CAI-GTIA-ATR IN GAP-SALIDA.
           MOVE 'P'             TO MTX-GAP-IIC-GTIA-ATR IN GAP-SALIDA.
           MOVE 'P'             TO MTX-GDG-TIP-CGTA-ATR IN GAP-SALIDA.
           MOVE 'P'             TO MTX-GDG-STP-CGTA-ATR IN GAP-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-OFIC-ATR IN GAP-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-VCAM-ATR IN GAP-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGTA-ATR IN GAP-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGT1-ATR IN GAP-SALIDA.

           MOVE 'GAP'           TO MTX-GAR-COD-ENTIDAD  IN GAP-SALIDA.
           MOVE GAP-CAI-GTIA IN GAP TO MTX-GAP-CAI-GTIA IN GAP-SALIDA.
           MOVE GAP-IIC-GTIA IN GAP TO GAP-IIC-GTIA-EDT IN GAP-EDT.
           MOVE GAP-IIC-GTIA-EDT IN GAP-EDT TO
                                       MTX-GAP-IIC-GTIA IN GAP-SALIDA.
           MOVE GDG-TIP-CGTA IN GDG TO MTX-GDG-TIP-CGTA IN GAP-SALIDA.
           MOVE GDG-STP-CGTA IN GDG TO MTX-GDG-STP-CGTA IN GAP-SALIDA.
           MOVE GDG-COD-OFIC IN GDG TO MTX-GDG-COD-OFIC IN GAP-SALIDA.
           MOVE GDG-COD-VCAM IN GDG TO MTX-GDG-COD-VCAM IN GAP-SALIDA.
           MOVE GDG-GLS-DGTA IN GDG TO MTX-GDG-GLS-DGTA IN GAP-SALIDA.
           MOVE GDG-GLS-DGT1 IN GDG TO MTX-GDG-GLS-DGT1 IN GAP-SALIDA.

       PUT-GAP-TS.
           ADD 1 TO WSS-NUM-IDX.
      *----------------------------------------------------------------
           MOVE 'P' TO MTX-GAP-COD-PACR-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GAP-COD-RFCA-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GAP-IND-ESBA-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GAP-IND-ESCL-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-DBC-NUM-ICLI-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-DBC-VRF-ICLI-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-DBC-IND-ICLI-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-DBC-GLS-ICLI-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-DBC-GLS-NOMC-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GAP-IND-MACR-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-MACR-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GAP-SGV-MACR-ATR IN GAP-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GAP-IND-MASC-ATR IN GAP-SALIDA(WSS-NUM-IDX).

           MOVE GAP-COD-PACR IN GAP TO GAP-COD-PACR-EDT IN GAP-EDT.
           MOVE GAP-COD-PACR-EDT IN GAP-EDT TO MTX-GAP-COD-PACR IN
                                              GAP-SALIDA(WSS-NUM-IDX).
           MOVE GAP-COD-RFCA IN GAP         TO MTX-GAP-COD-RFCA IN
                                              GAP-SALIDA(WSS-NUM-IDX).
           MOVE GAP-IND-ESBA IN GAP         TO MTX-GAP-IND-ESBA IN
                                              GAP-SALIDA(WSS-NUM-IDX).
           MOVE GAP-IND-ESCL IN GAP         TO MTX-GAP-IND-ESCL IN
                                              GAP-SALIDA(WSS-NUM-IDX).

           IF GAP-CIC-ICLI IN GAP > SPACES
              MOVE GAP-CIC-ICLI IN GAP         TO DBC-CIC-ICLI IN DBC
              MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY
              MOVE FIO-GET-KEY     TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF FIO-STAT-OKS
                 MOVE DBC-NUM-ICLI IN DBC         TO
                           DBC-NUM-ICLI-EDT IN GAP-EDT
                 MOVE DBC-NUM-ICLI-EDT IN GAP-EDT TO
                           MTX-DBC-NUM-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
                 MOVE DBC-VRF-ICLI IN DBC         TO
                           MTX-DBC-VRF-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
                 MOVE DBC-IND-ICLI IN DBC         TO
                           MTX-DBC-IND-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
                 MOVE DBC-GLS-ICLI IN DBC         TO
                           MTX-DBC-GLS-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
              ELSE
                 MOVE GAP-CIC-ICLI IN GAP TO
      *          MOVE SPACES                      TO
                           MTX-DBC-NUM-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
                 MOVE SPACES                      TO
                           MTX-DBC-VRF-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
                 MOVE SPACES                      TO
                           MTX-DBC-IND-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
                 MOVE SPACES                      TO
                           MTX-DBC-GLS-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES                      TO
                           MTX-DBC-NUM-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
              MOVE SPACES                      TO
                           MTX-DBC-VRF-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
              MOVE SPACES                      TO
                           MTX-DBC-IND-ICLI IN GAP-SALIDA(WSS-NUM-IDX)
              MOVE SPACES                      TO
                           MTX-DBC-GLS-ICLI IN GAP-SALIDA(WSS-NUM-IDX).

           MOVE GAP-GLS-NOMA IN GAP         TO MTX-DBC-GLS-NOMC IN
                                             GAP-SALIDA(WSS-NUM-IDX).
           MOVE GAP-IND-MACR IN GAP         TO MTX-GAP-IND-MACR IN
                                             GAP-SALIDA(WSS-NUM-IDX).

           IF GAP-IND-MACR IN GAP > SPACES
              MOVE 'GAR'               TO MSC-COD-SIST
              MOVE 'MACR'              TO MSC-COD-TMSC IN MSC
              MOVE GAP-IND-MACR IN GAP TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC TO MTX-FRM-GLS-MACR IN
                                             GAP-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-MACR IN
                                             GAP-SALIDA(WSS-NUM-IDX).

           MOVE GAP-SGV-MACR IN GAP TO GAP-SGV-MACR-EDT IN GAP-EDT.
           MOVE GAP-SGV-MACR-EDT IN GAP-EDT TO MTX-GAP-SGV-MACR IN
                                             GAP-SALIDA(WSS-NUM-IDX).
           MOVE GAP-IND-MASC IN GAP         TO MTX-GAP-IND-MASC IN
                                             GAP-SALIDA(WSS-NUM-IDX).

           IF FRM-MAX-FLD-GAP = WSS-NUM-IDX
              GO TO FIN-CON-OCC-GAP.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF FIO-STAT-OKS AND
              MTX-GAP-CAI-GTIA IN GAP-ENTRADA = GAP-CAI-GTIA IN GAP AND
              MTX-GAP-IIC-GTIA IN GAP-ENTRADA = GAP-IIC-GTIA IN GAP
              GO TO PUT-GAP-TS.

       FIN-CON-OCC-GAP.
           EXIT.

       CON-OCC-GLE SECTION.
       INI-CON-OCC-GLE.

           MOVE CMMA-INPUT-DAT IN CMMA-INPUT TO GLE-ENTRADA.
           MOVE MTX-GLE-IIC-GTIA-ALF IN GLE-ENTRADA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO MTX-GLE-IIC-GTIA IN GLE-ENTRADA
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
                                    MTX-GLE-GLS-MENS IN GLE-SALIDA
               MOVE '1'          TO MTX-GLE-STATUS IN GLE-SALIDA
               GO TO FIN-CON-OCC-GLE.

           MOVE MTX-GLE-CAI-GTIA IN GLE-ENTRADA TO GDG-CAI-GTIA IN GDG.
           MOVE MTX-GLE-IIC-GTIA IN GLE-ENTRADA TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GLE-GLS-MENS IN GLE-SALIDA
               MOVE '1'          TO MTX-GLE-STATUS IN GLE-SALIDA
               GO TO FIN-CON-OCC-GLE.

           MOVE MTX-GLE-CAI-GTIA IN GLE-ENTRADA TO GLE-CAI-GTIA IN GLE.
           MOVE MTX-GLE-IIC-GTIA IN GLE-ENTRADA TO GLE-IIC-GTIA IN GLE.
           MOVE ZEROES              TO GLE-COD-PACR IN GLE.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM GAR-FIO-GLE.
           IF FIO-STAT-OKS AND
              MTX-GLE-CAI-GTIA IN GLE-ENTRADA = GLE-CAI-GTIA IN GLE AND
              MTX-GLE-IIC-GTIA IN GLE-ENTRADA = GLE-IIC-GTIA IN GLE
               MOVE SPACES TO MTX-GLE-GLS-MENS IN GLE-SALIDA
           ELSE
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GLE    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GLE-GLS-MENS IN GLE-SALIDA
               MOVE '1'          TO MTX-GLE-STATUS IN GLE-SALIDA
               GO TO FIN-CON-OCC-GLE.

           MOVE GDG-KEY-IGDG IN GDG TO GDD-KEY-AGDD IN GDD.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS AND
              GDG-KEY-IGDG  IN GDG = GDD-KEY-AGDD  IN GDD
               MOVE SPACES TO MTX-GLE-GLS-MENS IN GLE-SALIDA
           ELSE
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GDD    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GLE-GLS-MENS IN GLE-SALIDA
               MOVE '1'          TO MTX-GLE-STATUS IN GLE-SALIDA
               GO TO FIN-CON-OCC-GLE.

           MOVE GDD-CIC-DCLI IN GDD TO DBC-KEY-IDBC IN DBC
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM SGC-FIO-DBC
           IF NOT FIO-STAT-OKS
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GDD    NODBC' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GLE-GLS-MENS IN GLE-SALIDA
               MOVE '1'          TO MTX-GLE-STATUS IN GLE-SALIDA
               GO TO FIN-CON-OCC-GLE.

           MOVE 'N' TO WSS-IND-ERR.
           MOVE ZEROES TO WSS-NUM-IDX.

           MOVE 'P' TO MTX-GLE-CAI-GTIA-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GLE-IIC-GTIA-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-TIP-CGTA-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-STP-CGTA-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-COD-OFIC-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-COD-VCAM-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-GLS-DGTA-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-GLS-DGT1-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-FEC-FVTO-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-COD-GGTA-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-VAL-MNTO-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-IND-CBAN-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-COD-DESP-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-GDG-COD-RFCP-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-FRM-NUM-ICLI-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-FRM-VRF-ICLI-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-FRM-IND-ICLI-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-FRM-GLS-ICLI-ATR IN GLE-SALIDA.
           MOVE 'P' TO MTX-FRM-GLS-NOMC-ATR IN GLE-SALIDA.
           MOVE 'GLE'           TO MTX-GAR-COD-ENTIDAD IN GLE-SALIDA.
           MOVE GLE-CAI-GTIA IN GLE TO MTX-GLE-CAI-GTIA IN GLE-SALIDA.
           MOVE GLE-IIC-GTIA IN GLE TO GLE-IIC-GTIA-EDT IN GLE-EDT.
           MOVE GLE-IIC-GTIA-EDT IN GLE-EDT TO
                                       MTX-GLE-IIC-GTIA IN GLE-SALIDA.
           MOVE GDG-TIP-CGTA IN GDG TO MTX-GDG-TIP-CGTA IN GLE-SALIDA.
           MOVE GDG-STP-CGTA IN GDG TO MTX-GDG-STP-CGTA IN GLE-SALIDA.
           MOVE GDG-COD-OFIC IN GDG TO MTX-GDG-COD-OFIC IN GLE-SALIDA.
           MOVE GDG-COD-VCAM IN GDG TO MTX-GDG-COD-VCAM IN GLE-SALIDA.
           MOVE GDG-GLS-DGTA IN GDG TO MTX-GDG-GLS-DGTA IN GLE-SALIDA.
           MOVE GDG-GLS-DGT1 IN GDG TO MTX-GDG-GLS-DGT1 IN GLE-SALIDA.
           MOVE GDG-NUM-DVTO IN GDG TO MTX-GDG-NUM-DVTO IN GLE-SALIDA.
           MOVE GDG-NUM-MVTO IN GDG TO MTX-GDG-NUM-MVTO IN GLE-SALIDA.
           MOVE GDG-NUM-SVTO IN GDG TO MTX-GDG-NUM-SVTO IN GLE-SALIDA.
           MOVE GDG-NUM-AVTO IN GDG TO MTX-GDG-NUM-AVTO IN GLE-SALIDA.
           MOVE GDG-COD-GGTA IN GDG TO GDG-COD-GGTA-EDT IN GDG-EDT.
           MOVE GDG-COD-GGTA-EDT IN GDG-EDT TO
                                       MTX-GDG-COD-GGTA IN GLE-SALIDA.
           MOVE GDG-VAL-MNTO IN GDG TO GDG-VAL-MNTO-EDT IN GDG-EDT.
           MOVE GDG-VAL-MNTO-EDT IN GDG-EDT TO
                                       MTX-GDG-VAL-MNTO IN GLE-SALIDA.
           MOVE GDG-IND-CBAN IN GDG TO MTX-GDG-IND-CBAN IN GLE-SALIDA.
           MOVE GDG-COD-DESP IN GDG TO MTX-GDG-COD-DESP IN GLE-SALIDA.
           MOVE GDG-COD-RFCP IN GDG TO MTX-GDG-COD-RFCP IN GLE-SALIDA.

           IF GDG-CIC-ICLI IN GDG > SPACES
              MOVE GDG-CIC-ICLI IN GDG         TO DBC-CIC-ICLI IN DBC
              MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY
              MOVE FIO-GET-KEY     TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF FIO-STAT-OKS
                 MOVE DBC-NUM-ICLI IN DBC TO
                                           FRM-NUM-ICLI-EDT IN GDG-EDT
                 MOVE FRM-NUM-ICLI-EDT IN GDG-EDT TO
                                        MTX-FRM-NUM-ICLI IN GLE-SALIDA
                 MOVE DBC-VRF-ICLI IN DBC TO
                                        MTX-FRM-VRF-ICLI IN GLE-SALIDA
                 MOVE DBC-IND-ICLI IN DBC TO
                                        MTX-FRM-IND-ICLI IN GLE-SALIDA
                 MOVE DBC-GLS-ICLI IN DBC TO
                                        MTX-FRM-GLS-ICLI IN GLE-SALIDA
              ELSE
                 MOVE SPACES TO MTX-FRM-NUM-ICLI IN GLE-SALIDA
                 MOVE SPACES TO MTX-FRM-VRF-ICLI IN GLE-SALIDA
                 MOVE SPACES TO MTX-FRM-IND-ICLI IN GLE-SALIDA
                 MOVE SPACES TO MTX-FRM-GLS-ICLI IN GLE-SALIDA
           ELSE
              MOVE SPACES TO MTX-FRM-NUM-ICLI IN GLE-SALIDA
              MOVE SPACES TO MTX-FRM-VRF-ICLI IN GLE-SALIDA
              MOVE SPACES TO MTX-FRM-IND-ICLI IN GLE-SALIDA
              MOVE SPACES TO MTX-FRM-GLS-ICLI IN GLE-SALIDA.

           MOVE GDG-GLS-NOMP IN GDG TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO MTX-FRM-GLS-NOMC IN GLE-SALIDA.

       PUT-GLE-TS.
           ADD 1 TO WSS-NUM-IDX.
           MOVE 'P' TO MTX-GLE-COD-PACR-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-COD-ABOG-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-ABOG-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-COD-NTRO-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-NTRO-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-IND-ITIN-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-GLS-REGI-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-COD-REGI-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-REGI-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-NUM-REGP-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-FEC-FPGT-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-RRGN-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-COD-LRGN-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-LRGN-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-COD-TESC-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-TESC-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-NUM-ESCR-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-FEC-FESC-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-IND-FOLI-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-NUM-FOLI-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-FEC-FFOL-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-NUM-LIBR-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-NUM-TPGT-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-NUM-VPGT-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-COD-SECC-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-NUM-SRIE-ATR IN GLE-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GLE-NUM-HOJA-ATR IN GLE-SALIDA(WSS-NUM-IDX).

           MOVE GLE-COD-PACR IN GLE TO GLE-COD-PACR-EDT IN GLE-EDT.
           MOVE GLE-COD-PACR-EDT IN GLE-EDT TO MTX-GLE-COD-PACR IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-COD-ABOG IN GLE TO MTX-GLE-COD-ABOG IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           IF GLE-COD-ABOG IN GLE > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ABG ' TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-ABOG IN GLE TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-ABOG IN
                                               GLE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-ABOG IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           MOVE GLE-COD-NTRO IN GLE TO MTX-GLE-COD-NTRO IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           IF GLE-COD-NTRO IN GLE > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'NOT ' TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-NTRO IN GLE TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-NTRO IN
                                               GLE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES                  TO MTX-FRM-GLS-NTRO IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           MOVE GLE-IND-ITIN IN GLE TO MTX-GLE-IND-ITIN IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-GLS-REGI IN GLE TO MTX-GLE-GLS-REGI IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-COD-REGI IN GLE TO MTX-GLE-COD-REGI IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           IF GLE-COD-REGI IN GLE > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'REG '              TO TAB-COD-TTAB IN TAB
              MOVE GLE-COD-REGI IN GLE TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-REGI IN
                                               GLE-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO  MTX-FRM-GLS-REGI IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           MOVE GLE-NUM-REGP IN GLE TO MTX-GLE-NUM-REGP IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           MOVE GLE-NUM-DPGT IN GLE TO MTX-GLE-NUM-DPGT IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-MPGT IN GLE TO MTX-GLE-NUM-MPGT IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-SPGT IN GLE TO MTX-GLE-NUM-SPGT IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-APGT IN GLE TO MTX-GLE-NUM-APGT IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           IF GLE-COD-LRGN IN GLE > SPACES
               MOVE 'TAB'  TO TAB-COD-SIST
               MOVE 'CIU'  TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-LRGN IN GLE TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS IN MSG NOT > SPACES
                   MOVE TAB TO CIU
                   MOVE CIU-GLS-CIUD IN CIU TO MTX-GLE-COD-LRGN IN
                                               GLE-SALIDA(WSS-NUM-IDX)
                   MOVE CIU-GLS-ESTD IN CIU TO MTX-FRM-GLS-RRGN IN
                                               GLE-SALIDA(WSS-NUM-IDX)
               ELSE
                   MOVE SPACES              TO MTX-GLE-COD-LRGN IN
                                               GLE-SALIDA(WSS-NUM-IDX)
                   MOVE SPACES              TO MTX-FRM-GLS-RRGN IN
                                               GLE-SALIDA(WSS-NUM-IDX)
           ELSE
                MOVE SPACES              TO MTX-GLE-COD-LRGN IN
                                            GLE-SALIDA(WSS-NUM-IDX)
                MOVE SPACES              TO MTX-FRM-GLS-RRGN IN
                                            GLE-SALIDA(WSS-NUM-IDX).

           MOVE GLE-COD-LRGN IN GLE TO MTX-GLE-COD-LRGN IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-COD-TESC IN GLE TO MTX-GLE-COD-TESC IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           IF GLE-COD-TESC IN GLE > SPACES
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'TES' TO TAB-COD-TTAB IN TAB
              MOVE GLE-COD-TESC IN GLE TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS > SPACES
                 MOVE SPACES              TO MTX-FRM-GLS-TESC IN
                                               GLE-SALIDA(WSS-NUM-IDX)
              ELSE
                 MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-TESC IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           MOVE GLE-NUM-ESCR IN GLE TO MTX-GLE-NUM-ESCR IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-DESC IN GLE TO MTX-GLE-NUM-DESC IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-MESC IN GLE TO MTX-GLE-NUM-MESC IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-SESC IN GLE TO MTX-GLE-NUM-SESC IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-AESC IN GLE TO MTX-GLE-NUM-AESC IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           MOVE GLE-IND-FOLI IN GLE TO MTX-GLE-IND-FOLI IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-FOLI IN GLE TO MTX-GLE-NUM-FOLI IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-DFOL IN GLE TO MTX-GLE-NUM-DFOL IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-MFOL IN GLE TO MTX-GLE-NUM-MFOL IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-SFOL IN GLE TO MTX-GLE-NUM-SFOL IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-AFOL IN GLE TO MTX-GLE-NUM-AFOL IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           MOVE GLE-NUM-LIBR IN GLE TO MTX-GLE-NUM-LIBR IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-TPGT IN GLE TO MTX-GLE-NUM-TPGT IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-VPGT IN GLE TO MTX-GLE-NUM-VPGT IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-COD-SECC IN GLE TO MTX-GLE-COD-SECC IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-SRIE IN GLE TO MTX-GLE-NUM-SRIE IN
                                               GLE-SALIDA(WSS-NUM-IDX).
           MOVE GLE-NUM-HOJA IN GLE TO GLE-NUM-HOJA-EDT IN GLE-EDT.
           MOVE GLE-NUM-HOJA-EDT IN GLE-EDT TO MTX-GLE-NUM-HOJA IN
                                               GLE-SALIDA(WSS-NUM-IDX).

           IF FRM-MAX-FLD-GLE = WSS-NUM-IDX
              GO TO FIN-CON-OCC-GLE.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GLE.
           IF FIO-STAT-OKS AND
              MTX-GLE-CAI-GTIA IN GLE-ENTRADA = GLE-CAI-GTIA IN GLE AND
              MTX-GLE-IIC-GTIA IN GLE-ENTRADA = GLE-IIC-GTIA IN GLE
              GO TO PUT-GLE-TS.

       FIN-CON-OCC-GLE.
           EXIT.

       CON-OCC-GIN SECTION.
       INI-CON-OCC-GIN.

           MOVE CMMA-INPUT-DAT IN CMMA-INPUT TO GIN-ENTRADA.
           MOVE MTX-GIN-IIC-GTIA-ALF IN GIN-ENTRADA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO MTX-GIN-IIC-GTIA IN GIN-ENTRADA
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
                                    MTX-GIN-GLS-MENS IN GIN-SALIDA
               MOVE '1'          TO MTX-GIN-STATUS IN GIN-SALIDA
               GO TO FIN-CON-OCC-GIN.

           MOVE MTX-GIN-CAI-GTIA IN GIN-ENTRADA TO GDG-CAI-GTIA IN GDG.
           MOVE MTX-GIN-IIC-GTIA IN GIN-ENTRADA TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GIN-GLS-MENS IN GIN-SALIDA
               MOVE '1'          TO MTX-GIN-STATUS IN GIN-SALIDA
               GO TO FIN-CON-OCC-GIN.

           MOVE MTX-GIN-CAI-GTIA IN GIN-ENTRADA TO GIN-CAI-GTIA IN GIN.
           MOVE MTX-GIN-IIC-GTIA IN GIN-ENTRADA TO GIN-IIC-GTIA IN GIN.
           MOVE ZEROES              TO GIN-NUM-IGIN IN GIN.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM GAR-FIO-GIN.
           IF FIO-STAT-OKS AND
              MTX-GIN-CAI-GTIA IN GIN-ENTRADA = GIN-CAI-GTIA IN GIN AND
              MTX-GIN-IIC-GTIA IN GIN-ENTRADA = GIN-IIC-GTIA IN GIN
               MOVE SPACES TO MTX-GIN-GLS-MENS IN GIN-SALIDA
               GO TO PUT-GIN-MTX
           ELSE
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GIN    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GIN-GLS-MENS IN GIN-SALIDA
               MOVE '1'          TO MTX-GIN-STATUS IN GIN-SALIDA
               GO TO FIN-CON-OCC-GIN.

       PUT-GIN-MTX.
           MOVE 'N' TO WSS-IND-ERR.
           MOVE ZEROES TO WSS-NUM-IDX.

           MOVE 'P'             TO MTX-GIN-CAI-GTIA-ATR IN GIN-SALIDA.
           MOVE 'P'             TO MTX-GIN-IIC-GTIA-ATR IN GIN-SALIDA.
           MOVE 'P'             TO MTX-GDG-TIP-CGTA-ATR IN GIN-SALIDA.
           MOVE 'P'             TO MTX-GDG-STP-CGTA-ATR IN GIN-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-OFIC-ATR IN GIN-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-VCAM-ATR IN GIN-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGTA-ATR IN GIN-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGT1-ATR IN GIN-SALIDA.

           MOVE 'GIN'           TO MTX-GAR-COD-ENTIDAD  IN GIN-SALIDA.
           MOVE GIN-CAI-GTIA IN GIN TO MTX-GIN-CAI-GTIA IN GIN-SALIDA.
           MOVE GIN-IIC-GTIA IN GIN TO GIN-IIC-GTIA-EDT IN GIN-EDT.
           MOVE GIN-IIC-GTIA-EDT IN GIN-EDT TO
                                       MTX-GIN-IIC-GTIA IN GIN-SALIDA.
           MOVE GDG-TIP-CGTA IN GDG TO MTX-GDG-TIP-CGTA IN GIN-SALIDA.
           MOVE GDG-STP-CGTA IN GDG TO MTX-GDG-STP-CGTA IN GIN-SALIDA.
           MOVE GDG-COD-OFIC IN GDG TO MTX-GDG-COD-OFIC IN GIN-SALIDA.
           MOVE GDG-COD-VCAM IN GDG TO MTX-GDG-COD-VCAM IN GIN-SALIDA.
           MOVE GDG-GLS-DGTA IN GDG TO MTX-GDG-GLS-DGTA IN GIN-SALIDA.
           MOVE GDG-GLS-DGT1 IN GDG TO MTX-GDG-GLS-DGT1 IN GIN-SALIDA.

       PUT-GIN-TS.
           ADD 1 TO WSS-NUM-IDX.
           MOVE 'P' TO MTX-GIN-NUM-IGIN-ATR IN GIN-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GIN-FEC-FUIN-ATR IN GIN-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GIN-COD-INSP-ATR IN GIN-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-INSP-ATR IN GIN-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GIN-COD-IINS-ATR IN GIN-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-IINS-ATR IN GIN-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GIN-GLS-RES1-ATR IN GIN-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GIN-GLS-RES2-ATR IN GIN-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GIN-FEC-FPIN-ATR IN GIN-SALIDA(WSS-NUM-IDX).

           MOVE GIN-NUM-IGIN IN GIN TO GIN-NUM-IGIN-EDT IN GIN-EDT.
           MOVE GIN-NUM-IGIN-EDT IN GIN-EDT TO MTX-GIN-NUM-IGIN IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-NUM-SUIN IN GIN TO MTX-GIN-NUM-SUIN IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-NUM-AUIN IN GIN TO MTX-GIN-NUM-AUIN IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-NUM-MUIN IN GIN TO MTX-GIN-NUM-MUIN IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-NUM-DUIN IN GIN TO MTX-GIN-NUM-DUIN IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-COD-INSP IN GIN TO MTX-GIN-COD-INSP IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           IF GIN-COD-INSP IN GIN > SPACES
              MOVE 'GAR'               TO MSC-COD-SIST
              MOVE 'SCMP'              TO MSC-COD-TMSC IN MSC
              MOVE GIN-COD-INSP IN GIN TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DESC IN MSC TO MTX-FRM-GLS-INSP IN
                                               GIN-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES              TO MTX-FRM-GLS-INSP IN
                                               GIN-SALIDA(WSS-NUM-IDX).

           MOVE GIN-COD-IINS IN GIN TO MTX-GIN-COD-IINS IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           IF GIN-COD-IINS IN GIN > SPACES
               MOVE 'INS'                    TO IVB-COD-TTAB IN IVB
               MOVE GIN-COD-IINS IN GIN      TO IVB-COD-EIVB IN IVB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-IVB
               IF NOT FIO-STAT-OKS
                   MOVE 'CODIINSNEX' TO MSG-COD-MENS
                   MOVE 'GAR' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO MTX-FRM-GLS-IINS IN
                                               GIN-SALIDA(WSS-NUM-IDX)
               ELSE
                   MOVE IVB-GLS-DESC IN IVB TO MTX-FRM-GLS-IINS IN
                                               GIN-SALIDA(WSS-NUM-IDX)
           ELSE
               MOVE SPACES TO MTX-FRM-GLS-IINS IN
                                               GIN-SALIDA(WSS-NUM-IDX).


           MOVE GIN-GLS-RES1 IN GIN TO MTX-GIN-GLS-RES1 IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-GLS-RES2 IN GIN TO MTX-GIN-GLS-RES2 IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-NUM-SPIN IN GIN TO MTX-GIN-NUM-SPIN IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-NUM-APIN IN GIN TO MTX-GIN-NUM-APIN IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-NUM-MPIN IN GIN TO MTX-GIN-NUM-MPIN IN
                                               GIN-SALIDA(WSS-NUM-IDX).
           MOVE GIN-NUM-DPIN IN GIN TO MTX-GIN-NUM-DPIN IN
                                               GIN-SALIDA(WSS-NUM-IDX).


           IF FRM-MAX-FLD-GIN = WSS-NUM-IDX
              GO TO FIN-CON-OCC-GIN.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GIN.
           IF FIO-STAT-OKS AND
              MTX-GIN-CAI-GTIA IN GIN-ENTRADA = GIN-CAI-GTIA IN GIN AND
              MTX-GIN-IIC-GTIA IN GIN-ENTRADA = GIN-IIC-GTIA IN GIN
              GO TO PUT-GIN-TS.

       FIN-CON-OCC-GIN.
           EXIT.


       CON-OCC-GES SECTION.
       INI-CON-OCC-GES.

           MOVE CMMA-INPUT-DAT IN CMMA-INPUT TO GES-ENTRADA.
           MOVE MTX-GES-IIC-GTIA-ALF IN GES-ENTRADA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO MTX-GES-IIC-GTIA IN GES-ENTRADA
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
                                    MTX-GES-GLS-MENS IN GES-SALIDA
               MOVE '1'          TO MTX-GES-STATUS IN GES-SALIDA
               GO TO FIN-CON-OCC-GES.

           MOVE MTX-GES-CAI-GTIA IN GES-ENTRADA TO GDG-CAI-GTIA IN GDG.
           MOVE MTX-GES-IIC-GTIA IN GES-ENTRADA TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GES-GLS-MENS IN GES-SALIDA
               MOVE '1'          TO MTX-GES-STATUS IN GES-SALIDA
               GO TO FIN-CON-OCC-GES.


           MOVE MTX-GES-CAI-GTIA IN GES-ENTRADA TO GES-CAI-GTIA IN GES.
           MOVE MTX-GES-IIC-GTIA IN GES-ENTRADA TO GES-IIC-GTIA IN GES.
           MOVE ZEROES                          TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF FIO-STAT-OKS AND
              MTX-GES-CAI-GTIA IN GES-ENTRADA = GES-CAI-GTIA IN GES AND
              MTX-GES-IIC-GTIA IN GES-ENTRADA = GES-IIC-GTIA IN GES
               MOVE SPACES TO MTX-GES-GLS-MENS IN GES-SALIDA
               GO TO PUT-GES-MTX
           ELSE
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'GES    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GES-GLS-MENS IN GES-SALIDA
               MOVE '1'          TO MTX-GES-STATUS IN GES-SALIDA
               GO TO FIN-CON-OCC-GES.


       PUT-GES-MTX.
           MOVE 'N' TO WSS-IND-ERR.
           MOVE ZEROES TO WSS-NUM-IDX.
           MOVE 'P'             TO MTX-GES-CAI-GTIA-ATR IN GES-SALIDA.
           MOVE 'P'             TO MTX-GES-IIC-GTIA-ATR IN GES-SALIDA.
           MOVE 'P'             TO MTX-GDG-TIP-CGTA-ATR IN GES-SALIDA.
           MOVE 'P'             TO MTX-GDG-STP-CGTA-ATR IN GES-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-OFIC-ATR IN GES-SALIDA.
           MOVE 'P'             TO MTX-GDG-COD-VCAM-ATR IN GES-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGTA-ATR IN GES-SALIDA.
           MOVE 'P'             TO MTX-GDG-GLS-DGT1-ATR IN GES-SALIDA.

           MOVE 'GES'           TO MTX-GAR-COD-ENTIDAD IN GES-SALIDA.
           MOVE GES-CAI-GTIA IN GES TO MTX-GES-CAI-GTIA IN GES-SALIDA.
           MOVE GES-IIC-GTIA IN GES TO GES-IIC-GTIA-EDT IN GES-EDT.
           MOVE GES-IIC-GTIA-EDT IN GES-EDT TO
                                       MTX-GES-IIC-GTIA IN GES-SALIDA.
           MOVE GDG-TIP-CGTA IN GDG TO MTX-GDG-TIP-CGTA IN GES-SALIDA.
           MOVE GDG-STP-CGTA IN GDG TO MTX-GDG-STP-CGTA IN GES-SALIDA.
           MOVE GDG-COD-OFIC IN GDG TO MTX-GDG-COD-OFIC IN GES-SALIDA.
           MOVE GDG-COD-VCAM IN GDG TO MTX-GDG-COD-VCAM IN GES-SALIDA.
           MOVE GDG-GLS-DGTA IN GDG TO MTX-GDG-GLS-DGTA IN GES-SALIDA.
           MOVE GDG-GLS-DGT1 IN GDG TO MTX-GDG-GLS-DGT1 IN GES-SALIDA.

       PUT-GES-TS.
           ADD 1 TO WSS-NUM-IDX.
           MOVE 'P' TO MTX-GES-NUM-IGES-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-COD-PACR-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-COD-SIST-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-SIST-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-CAI-IOPC-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-IIC-IOPC-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-FEC-FVCR-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-NUM-IDLC-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-IND-SCRE-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-COD-MVLC-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-MVLC-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-SGV-VLCR-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-SGV-PLCR-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-COD-TVCC-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-TVCC-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-COD-COPE-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-COPE-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-COD-VCMC-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-VCMC-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-COD-DCRE-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-DCRE-ATR IN GES-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-IND-TDEU-ATR IN GES-SALIDA(WSS-NUM-IDX).

           MOVE GES-NUM-IGES IN GES TO GES-NUM-IGES-EDT IN GES-EDT.
           MOVE GES-NUM-IGES-EDT IN GES-EDT TO MTX-GES-NUM-IGES IN
                                              GES-SALIDA(WSS-NUM-IDX).

           MOVE GES-COD-PACR IN GES TO GES-COD-PACR-EDT IN GES-EDT.
           MOVE GES-COD-PACR-EDT IN GES-EDT TO MTX-GES-COD-PACR IN
                                              GES-SALIDA(WSS-NUM-IDX).
           MOVE GES-COD-SIST IN GES TO MTX-GES-COD-SIST IN
                                              GES-SALIDA(WSS-NUM-IDX).
           IF GES-COD-SIST IN GES > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'SIS '              TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-SIST IN GES TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-SIST IN
                                              GES-SALIDA(WSS-NUM-IDX)
           ELSE
               MOVE SPACES TO  MTX-FRM-GLS-SIST IN
                                              GES-SALIDA(WSS-NUM-IDX).

           MOVE GES-CAI-IOPC IN GES TO MTX-GES-CAI-IOPC IN
                                              GES-SALIDA(WSS-NUM-IDX).
           MOVE GES-IIC-IOPC IN GES TO GES-IIC-IOPC-EDT IN GES-EDT.
           MOVE GES-IIC-IOPC-EDT IN GES-EDT TO MTX-GES-IIC-IOPC IN
                                              GES-SALIDA(WSS-NUM-IDX).

           MOVE GES-NUM-DVCR IN GES TO MTX-GES-NUM-DVCR IN
                                              GES-SALIDA(WSS-NUM-IDX).
           MOVE GES-NUM-MVCR IN GES TO MTX-GES-NUM-MVCR IN
                                              GES-SALIDA(WSS-NUM-IDX).
           MOVE GES-NUM-SVCR IN GES TO MTX-GES-NUM-SVCR IN
                                              GES-SALIDA(WSS-NUM-IDX).
           MOVE GES-NUM-AVCR IN GES TO MTX-GES-NUM-AVCR IN
                                              GES-SALIDA(WSS-NUM-IDX).
           MOVE GES-NUM-IDLC IN GES TO GES-NUM-IDLC-EDT IN GES-EDT.
           MOVE GES-NUM-IDLC-EDT IN GES-EDT TO MTX-GES-NUM-IDLC IN
                                              GES-SALIDA(WSS-NUM-IDX).
           MOVE GES-IND-SCRE IN GES TO MTX-GES-IND-SCRE IN
                                              GES-SALIDA(WSS-NUM-IDX).
           DISPLAY 'GES-COD-MVLC :' GES-COD-MVLC IN GES.
           MOVE GES-COD-MVLC IN GES TO MTX-GES-COD-MVLC IN
                                              GES-SALIDA(WSS-NUM-IDX).
           IF GES-COD-MVLC IN GES > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'VLR '              TO TAB-COD-TTAB IN TAB
              MOVE GES-COD-MVLC IN GES TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-MVLC IN
                                              GES-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-MVLC IN
                                              GES-SALIDA(WSS-NUM-IDX).

           MOVE GES-SGV-VLCR IN GES TO GES-SGV-VLCR-EDT IN GES-EDT.
           MOVE GES-SGV-VLCR-EDT IN GES-EDT TO MTX-GES-SGV-VLCR IN
                                              GES-SALIDA(WSS-NUM-IDX).
           MOVE GES-SGV-PLCR IN GES TO GES-SGV-PLCR-EDT IN GES-EDT.
           MOVE GES-SGV-PLCR-EDT IN GES-EDT TO MTX-GES-SGV-PLCR IN
                                              GES-SALIDA(WSS-NUM-IDX).

           MOVE GES-COD-TVCC IN GES TO MTX-GES-COD-TVCC IN
                                              GES-SALIDA(WSS-NUM-IDX).
           IF GES-COD-TVCC IN GES > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'VLR '              TO TAB-COD-TTAB IN TAB
              MOVE GES-COD-TVCC IN GES TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-TVCC IN
                                              GES-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-TVCC IN
                                              GES-SALIDA(WSS-NUM-IDX).

           MOVE GES-COD-COPE IN GES TO MTX-GES-COD-COPE IN
                                              GES-SALIDA(WSS-NUM-IDX).
           IF GES-COD-COPE IN GES > SPACES
              MOVE GES-COD-SIST IN GES TO TAB-GLS-ABRV IN TAB
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'TCR '              TO TAB-COD-TTAB IN TAB
              MOVE GES-COD-COPE IN GES TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-COPE IN
                                              GES-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-COPE IN
                                              GES-SALIDA(WSS-NUM-IDX).

           DISPLAY 'GES-COD-VCMC :' GES-COD-VCMC IN GES.
           MOVE GES-COD-VCMC IN GES TO MTX-GES-COD-VCMC IN
                                              GES-SALIDA(WSS-NUM-IDX).
           IF GES-COD-VCMC IN GES > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'VLR '              TO TAB-COD-TTAB IN TAB
              MOVE GES-COD-VCMC IN GES TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-VCMC IN
                                              GES-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-VCMC IN
                                              GES-SALIDA(WSS-NUM-IDX).

           MOVE GES-COD-DCRE IN GES TO MTX-GES-COD-DCRE IN
                                              GES-SALIDA(WSS-NUM-IDX).
           IF GES-COD-DCRE IN GES > SPACES
              MOVE 'COL'               TO TAB-COD-SIST
              MOVE 'DES '              TO TAB-COD-TTAB IN TAB
              MOVE GES-COD-DCRE IN GES TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-DCRE IN
                                              GES-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-DCRE IN
                                              GES-SALIDA(WSS-NUM-IDX).

           MOVE GES-IND-TDEU IN GES TO MTX-GES-IND-TDEU IN
                                              GES-SALIDA(WSS-NUM-IDX).

           IF FRM-MAX-FLD-GES = WSS-NUM-IDX
              GO TO FIN-CON-OCC-GES.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF FIO-STAT-OKS AND
              MTX-GES-CAI-GTIA IN GES-ENTRADA = GES-CAI-GTIA IN GES AND
              MTX-GES-IIC-GTIA IN GES-ENTRADA = GES-IIC-GTIA IN GES
              GO TO PUT-GES-TS.

       FIN-CON-OCC-GES.
           EXIT.

       CON-OCC-GE1 SECTION.
       INI-CON-OCC-GE1.

           MOVE CMMA-INPUT-DAT IN CMMA-INPUT TO GE1-ENTRADA.

           MOVE MTX-GES-IIC-IOPC-ALF IN GE1-ENTRADA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO MTX-GES-IIC-IOPC IN GE1-ENTRADA
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
                                    MTX-GES-GLS-MENS IN GE1-SALIDA
               MOVE '1'          TO MTX-GE1-STATUS IN GE1-SALIDA
               GO TO FIN-CON-OCC-GE1.

           MOVE MTX-GES-NUM-IDLC-ALF IN GE1-ENTRADA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO MTX-GES-NUM-IDLC IN GE1-ENTRADA
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
                                    MTX-GES-GLS-MENS IN GE1-SALIDA
               MOVE '1'          TO MTX-GE1-STATUS IN GE1-SALIDA
               GO TO FIN-CON-OCC-GE1.

           MOVE MTX-GES-CAI-IOPC IN GE1-ENTRADA TO GES-CAI-IOPC IN GES.
           MOVE MTX-GES-IIC-IOPC IN GE1-ENTRADA TO GES-IIC-IOPC IN GES.
           MOVE MTX-GES-NUM-IDLC IN GE1-ENTRADA TO GES-NUM-IDLC IN GES.
           MOVE 'GES-KEY-IOPE'          TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF FIO-STAT-OKS AND
              GES-CAI-IOPC IN GES = MTX-GES-CAI-IOPC IN GE1-ENTRADA AND
              GES-IIC-IOPC IN GES = MTX-GES-IIC-IOPC IN GE1-ENTRADA AND
              GES-NUM-IDLC IN GES = MTX-GES-NUM-IDLC IN GE1-ENTRADA
               MOVE SPACES TO MTX-GES-GLS-MENS IN GE1-SALIDA
               GO TO PUT-GE1-MTX
           ELSE
               MOVE 'S'          TO WSS-IND-ERR
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'GES    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
                                    MTX-GES-GLS-MENS IN GE1-SALIDA
               MOVE '1'          TO MTX-GE1-STATUS IN GE1-SALIDA
               GO TO FIN-CON-OCC-GE1.


       PUT-GE1-MTX.
           MOVE 'N' TO WSS-IND-ERR.
           MOVE ZEROES TO WSS-NUM-IDX.

           MOVE 'P'             TO MTX-GES-CAI-IOPC-ATR IN GE1-SALIDA.
           MOVE 'P'             TO MTX-GES-IIC-IOPC-ATR IN GE1-SALIDA.
           MOVE 'P'             TO MTX-GES-NUM-IDLC-ATR IN GE1-SALIDA.
           MOVE 'P'             TO MTX-GES-COD-SIST-ATR IN GE1-SALIDA.
           MOVE 'GE1'           TO MTX-GAR-COD-ENTIDAD IN GE1-SALIDA.
           MOVE GES-CAI-IOPC IN GES TO MTX-GES-CAI-IOPC IN GE1-SALIDA.
           MOVE GES-IIC-IOPC IN GES TO GES-IIC-IOPC-EDT IN GE1-EDT.
           MOVE GES-IIC-IOPC-EDT IN GE1-EDT TO
                                       MTX-GES-IIC-IOPC IN GE1-SALIDA.
           MOVE GES-NUM-IDLC IN GES TO GES-NUM-IDLC-EDT IN GE1-EDT.
           MOVE GES-NUM-IDLC-EDT IN GE1-EDT TO
                                       MTX-GES-NUM-IDLC IN GE1-SALIDA.
           MOVE GES-COD-SIST IN GES TO MTX-GES-COD-SIST IN GE1-SALIDA.


       PUT-GE1-TS.
           ADD 1 TO WSS-NUM-IDX.

           MOVE 'P' TO MTX-GES-CAI-GTIA-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-IIC-GTIA-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-NUM-IGES-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDG-TIP-CGTA-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDG-STP-CGTA-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDG-COD-OFIC-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDG-COD-VCAM-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDG-GLS-DGTA-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDG-GLS-DGT1-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-COD-PACR-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-COD-MVLC-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-MVLC-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-SGV-VLCR-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GES-SGV-PLCR-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDG-IND-EST1-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-EST1-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDG-FEC-FVTO-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-GDG-IND-EST2-ATR IN GE1-SALIDA(WSS-NUM-IDX).
           MOVE 'P' TO MTX-FRM-GLS-EST2-ATR IN GE1-SALIDA(WSS-NUM-IDX).

           MOVE GES-CAI-GTIA IN GES TO MTX-GES-CAI-GTIA IN
                                              GE1-SALIDA(WSS-NUM-IDX).
           MOVE GES-IIC-GTIA IN GES TO GES-IIC-GTIA-EDT IN GE1-EDT.
           MOVE GES-IIC-GTIA-EDT IN GE1-EDT TO MTX-GES-IIC-GTIA IN
                                              GE1-SALIDA(WSS-NUM-IDX).

           MOVE GES-CAI-GTIA IN GES TO GDG-CAI-GTIA IN GDG.
           MOVE GES-IIC-GTIA IN GES TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF FIO-STAT-OKS
              MOVE GDG-TIP-CGTA IN GDG TO MTX-GDG-TIP-CGTA IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-STP-CGTA IN GDG TO MTX-GDG-STP-CGTA IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-COD-OFIC IN GDG TO MTX-GDG-COD-OFIC IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-COD-VCAM IN GDG TO MTX-GDG-COD-VCAM IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-GLS-DGTA IN GDG TO MTX-GDG-GLS-DGTA IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-GLS-DGT1 IN GDG TO MTX-GDG-GLS-DGT1 IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-IND-EST1 IN GDG TO MTX-GDG-IND-EST1 IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-NUM-DVTO IN GDG TO MTX-GDG-NUM-DVTO IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-NUM-MVTO IN GDG TO MTX-GDG-NUM-MVTO IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-NUM-SVTO IN GDG TO MTX-GDG-NUM-SVTO IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-NUM-AVTO IN GDG TO MTX-GDG-NUM-AVTO IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE GDG-COD-EST2 IN GDG TO MTX-GDG-IND-EST2 IN
                                              GE1-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES              TO MTX-GDG-TIP-CGTA IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE SPACES              TO MTX-GDG-STP-CGTA IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE SPACES              TO MTX-GDG-COD-OFIC IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE SPACES              TO MTX-GDG-COD-VCAM IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE SPACES              TO MTX-GDG-GLS-DGTA IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE SPACES              TO MTX-GDG-GLS-DGT1 IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE SPACES              TO MTX-GDG-IND-EST1 IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE SPACES              TO MTX-GDG-FEC-FVTO IN
                                              GE1-SALIDA(WSS-NUM-IDX)
              MOVE SPACES              TO MTX-GDG-IND-EST2 IN
                                              GE1-SALIDA(WSS-NUM-IDX).

           MOVE GES-NUM-IGES IN GES TO GES-NUM-IGES-EDT IN GE1-EDT.
           MOVE GES-NUM-IGES-EDT IN GE1-EDT TO MTX-GES-NUM-IGES IN
                                              GE1-SALIDA(WSS-NUM-IDX).
           MOVE GES-COD-PACR IN GES TO GES-COD-PACR-EDT IN GE1-EDT.
           MOVE GES-COD-PACR-EDT IN GE1-EDT TO MTX-GES-COD-PACR IN
                                              GE1-SALIDA(WSS-NUM-IDX).

           IF MTX-GDG-IND-EST1 IN GE1-SALIDA(WSS-NUM-IDX) > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES1 ' TO TAB-COD-TTAB IN TAB
               MOVE MTX-GDG-IND-EST1 IN GE1-SALIDA(WSS-NUM-IDX) TO
                                               TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    MTX-FRM-GLS-EST1 IN GE1-SALIDA(WSS-NUM-IDX)
           ELSE
               MOVE SPACES TO
                    MTX-FRM-GLS-EST1 IN GE1-SALIDA(WSS-NUM-IDX).


           IF MTX-GDG-IND-EST2 IN GE1-SALIDA(WSS-NUM-IDX) > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES2 ' TO TAB-COD-TTAB IN TAB
               MOVE MTX-GDG-IND-EST2 IN GE1-SALIDA(WSS-NUM-IDX) TO
                                               TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    MTX-FRM-GLS-EST2 IN GE1-SALIDA(WSS-NUM-IDX)
           ELSE
               MOVE SPACES TO
                    MTX-FRM-GLS-EST2 IN GE1-SALIDA(WSS-NUM-IDX).


           MOVE GES-COD-MVLC IN GES TO MTX-GES-COD-MVLC IN
                                              GE1-SALIDA(WSS-NUM-IDX).
           IF GES-COD-MVLC IN GES > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'VLR '              TO TAB-COD-TTAB IN TAB
              MOVE GES-COD-MVLC IN GES TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO MTX-FRM-GLS-MVLC IN
                                              GE1-SALIDA(WSS-NUM-IDX)
           ELSE
              MOVE SPACES TO MTX-FRM-GLS-MVLC IN
                                              GE1-SALIDA(WSS-NUM-IDX).

           MOVE GES-SGV-VLCR IN GES TO GES-SGV-VLCR-EDT IN GE1-EDT.
           MOVE GES-SGV-VLCR-EDT IN GE1-EDT TO MTX-GES-SGV-VLCR IN
                                              GE1-SALIDA(WSS-NUM-IDX).
           MOVE GES-SGV-PLCR IN GES TO GES-SGV-PLCR-EDT IN GE1-EDT.
           MOVE GES-SGV-PLCR-EDT IN GE1-EDT TO MTX-GES-SGV-PLCR IN
                                              GE1-SALIDA(WSS-NUM-IDX).


           IF FRM-MAX-FLD-GE1 = WSS-NUM-IDX
              GO TO FIN-CON-OCC-GE1.

           MOVE FIO-GET-NXT    TO FIO-CMND.
           MOVE 'GES-KEY-IOPE' TO FIO-AKEY.
           PERFORM GAR-FIO-GES.
           IF FIO-STAT-OKS AND
              GES-CAI-IOPC IN GES = MTX-GES-CAI-IOPC IN GE1-ENTRADA AND
              GES-IIC-IOPC IN GES = MTX-GES-IIC-IOPC IN GE1-ENTRADA AND
              GES-NUM-IDLC IN GES = MTX-GES-NUM-IDLC IN GE1-ENTRADA
              GO TO PUT-GE1-TS.

       FIN-CON-OCC-GE1.
           EXIT.

       COPY SGCBFDBC.
       COPY GARBFGSI.
       COPY GNSBVNUM.
       COPY GNSBGFRM.
       COPY GNSBGMSG.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBBMSC.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBFTAB.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY TABBBOFI.
       COPY TABBFOFI.


       COPY GNSBGTSK.
       COPY GNSBGSYS.
       COPY GNSBGVSM.
       COPY GNSBGHOY.
       COPY GNSBGQUE.
       COPY GNSBFMSG.
       COPY GARBFGDG.
       COPY GARBFTAG.
       COPY GARBFGAP.
       COPY GARBFGDD.
       COPY GARBFGDO.
       COPY GARBFGDP.
       COPY GARBFGES.
       COPY GARBFGIN.
       COPY GARBFGLE.
       COPY GARBFGMO.
       COPY GARBFGSE.
       COPY GARBFGTP.
       COPY GARBFGUB.
       COPY GARBFGVT.
       COPY GARBFGIM.
       COPY GARBFGVE.
       COPY TABBFIVB.
       COPY TABBFEST.
      *COPY TABBFCIU.
       COPY GNSBVTAB.

       COPY GNSBGCPT.
       COPY GNSBGSTR.

       COPY GNSBBIDD.
       COPY GNSBCIDD.
