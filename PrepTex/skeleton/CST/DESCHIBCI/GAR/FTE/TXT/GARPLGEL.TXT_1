*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY TABBROFI.
       COPY LDCBRRDC.
       COPY LDCBRARG.
       COPY GNSWGFPB.
       COPY GNSWGCPT.
       01  WSS-VARI.
           03  WSS-CLV-GDG
               05  WSS-NUM-SIS       VALUE SPACES       PIC X(04).
               05  WSS-COD-CRR       VALUE SPACES       PIC X(08).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
      *>>>>
*% END
*% IF INI
      *<<<< INI
           MOVE FIO-INP      TO FIO-CMND.
           PERFORM SGC-FIO-DBC.

           MOVE FIO-INP      TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-INP      TO FIO-CMND.
           PERFORM LDC-FIO-RDC.

           MOVE FIO-INP      TO FIO-CMND.
           PERFORM LDC-FIO-ARG.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

      *Captura Fecha de proceso
       COPY GNSBGFPB.
           MOVE FPB-DPRO TO WSS-NUM-DPRO IN WSS-GEL.
           MOVE FPB-MPRO TO WSS-NUM-MPRO IN WSS-GEL.
           MOVE FPB-SPRO TO WSS-NUM-SPRO IN WSS-GEL.
           MOVE FPB-APRO TO WSS-NUM-APRO IN WSS-GEL.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           IF NOT (GEL-NUM-SIS IN SRT = WSS-NUM-SIS IN WSS-VARI AND
              GEL-COD-CRR IN SRT = WSS-COD-CRR IN WSS-VARI)
               GO TO GEN-OUT-SRT.
           PERFORM PRO-DL-RDC.
           GO TO NXT-OUT-SRT.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
           MOVE GEL-NUM-SIS IN SRT TO WSS-NUM-SIS IN WSS-VARI.
           MOVE GEL-COD-CRR IN SRT TO WSS-COD-CRR IN WSS-VARI.
      *>>>>
*% END
*% IF DL_GEL OR DL_RDC
      *<<<< DL_GEL OR DL_RDC
           MOVE GEL-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
           ELSE
               MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC
               MOVE ZEROES                TO DBC-NUM-ICLI IN DBC
               MOVE SPACES                TO DBC-VRF-ICLI IN DBC
               MOVE SPACES                TO DBC-IND-ICLI IN DBC
               MOVE SPACES                TO DBC-GLS-ICLI IN DBC.
           PERFORM BUS-ARG.
      *>>>>
*% END
*% IF CH_GEL_GEL_GAR_VCB
      *<<<< CH_GEL_GEL_GAR_VCB
      *BUS-TAB busca glosa de codigo en tabla
           IF GEL-GAR-VCB IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GEL-GAR-VCB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCB IN WSS-GEL
           ELSE
               MOVE SPACES TO WSS-GLS-VCB IN WSS-GEL.
      *>>>>
*% END
*% IF CH_GEL_GEL_COD_OFI
      *<<<< CH_GEL_GEL_COD_OFI
      *BUS-OFI busca oficina en tablas
           IF GEL-COD-OFI IN SRT > SPACES
               MOVE GEL-COD-OFI IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFI IN WSS-GEL
           ELSE
               MOVE SPACES TO WSS-GLS-OFI IN WSS-GEL.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-ARG SECTION.
       INI-BUS-ARG.
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.
           MOVE LOW-VALUES          TO RDC-KEY-ICLF IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC )
               GO TO CLR-BUS-ARG.
           MOVE RDC-CIC-ICLF IN RDC TO ARG-CIC-ICLF IN ARG.
           MOVE ZEROES              TO ARG-NUM-ILDC IN ARG.
           MOVE ZEROES              TO ARG-NUM-IARG IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
       LUP-LEE-ARG.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-ICLF IN RDC = ARG-CIC-ICLF IN ARG )
               GO TO CLR-BUS-ARG.
           IF ( ARG-CAI-IGAR IN ARG = GEL-NUM-SIS IN SRT AND
                ARG-IIC-IGAR IN ARG = GEL-COD-CRR IN SRT )
               MOVE ARG-NUM-ILDC IN ARG TO WSS-NUM-ILDC IN WSS-GEL
               MOVE ARG-NUM-IARG IN ARG TO WSS-NUM-IARG IN WSS-GEL
               GO TO FIN-BUS-ARG.
           MOVE FIO-GET-NXT  TO FIO-CMND.
           PERFORM LDC-FIO-ARG
           GO TO LUP-LEE-ARG.
       CLR-BUS-ARG.
           MOVE SPACES TO ARG-CAI-ICLF IN ARG.
           MOVE SPACES TO ARG-IIC-ICLF IN ARG.
           MOVE SPACES TO WSS-NUM-ILDC IN WSS-GEL.
           MOVE SPACES TO WSS-NUM-IARG IN WSS-GEL.
       FIN-BUS-ARG.
           EXIT.

       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY LDCBFRDC.
       COPY LDCBFARG.
       COPY SGCBFDBC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
      *>>>>
*% END
