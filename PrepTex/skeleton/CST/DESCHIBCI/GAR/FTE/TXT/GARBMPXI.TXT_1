*%! Codigo adicional para archivo
*% FRM = 'PXI'
*% IF FIN_PUT_GDG_PXI
      *<<<< FIN_PUT_GDG_PXI

           MOVE ZEROES TO WSS-OPIN, WSS-OPXI.
           MOVE SPACES TO FRM-GLS-AUXI IN PXI-FLD.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDG' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDGNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
           ADD 1 TO WSS-OPIN.
           MOVE MNU-COD-OPCI IN MNU TO FRM-COD-OPIN 
                                                 IN PXI-FLD(WSS-OPIN).
           MOVE MNU-GLS-FMEN IN MNU TO FRM-GLS-PING 
                                                 IN PXI-FLD(WSS-OPIN).

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDD' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDDNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE '00' TO PGM-STAT-DBC.
           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDD.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDD.
           MOVE 'GAR-CLV-GDD-2' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
                    GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GDD AND
                    GAR-COD-CRR IN GDG = GAR-COD-CRR IN GDD )
               MOVE '23' TO PGM-STAT-DBC
               MOVE '23' TO FIO-STAT.
           MOVE 'S' TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      *    Busca DBC
           IF PGM-STAT-DBC NOT = '23'
               MOVE GDD-CIC-ICLI IN GDD TO DBC-KEY-IDBC IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GVT' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGVTNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GVT.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GVT.
           MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GVT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           MOVE 'S' TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GAP' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGAPNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           IF GAR-COD-GRA IN GDG > '1'
               MOVE 'S' TO GAR-IND-EXG-GAP IN TAG
           ELSE
               MOVE 'N' TO GAR-IND-EXG-GAP IN TAG.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GAP.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GAP.
           MOVE ZEROES             TO GAR-COD-PRD-ACR IN GAP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF NOT ( FIO-STAT-OKS AND
                    GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GAP AND
                    GAR-COD-CRR IN GDG = GAR-COD-CRR IN GAP )
               MOVE '23' TO FIO-STAT.
           MOVE GAR-IND-EXG-GAP IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDO' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDONEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDO.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
           MOVE GAR-IND-EXG-GDO IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDP' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDPNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDP.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDP.
           MOVE GAR-IND-EXG-GDP IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GES' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGESNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           IF GAR-COD-LIM  IN GDG = 'E'
               MOVE 'S' TO GAR-IND-EXG-GES IN TAG
           ELSE
               MOVE 'N' TO GAR-IND-EXG-GES IN TAG.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GES.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GES.
           MOVE ZEROES             TO GAR-COD-ESP IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF NOT ( FIO-STAT-OKS AND
                    GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GES AND
                    GAR-COD-CRR IN GDG = GAR-COD-CRR IN GES )
               MOVE '23' TO FIO-STAT.
           MOVE GAR-IND-EXG-GES IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GIN' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGINNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           IF GAR-IND-OBL-INS IN GDG = 'S'
               MOVE 'S' TO GAR-IND-EXG-GIN IN TAG
           ELSE
               MOVE 'N' TO GAR-IND-EXG-GIN IN TAG.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GIN.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GIN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GIN.
           MOVE GAR-IND-EXG-GIN IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GLE' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGLENEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GLE.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GLE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GLE.
           MOVE GAR-IND-EXG-GLE IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GSE' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGSENEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GSE.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GSE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
           MOVE GAR-IND-EXG-GSE IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GSI' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGSINEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GSI.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GSI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSI.
           MOVE GAR-IND-EXG-GSI IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GTP' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGTPNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GTP.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GTP.
           MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GTP.
           MOVE ZEROES             TO GAR-COD-ITM-TSN IN GTP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF NOT ( FIO-STAT-OKS AND
                    GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GTP AND
                    GAR-COD-CRR IN GDG = GAR-COD-CRR IN GTP AND 
                    GAR-COD-TSN IN GDG = GAR-COD-TSN IN GTP
                  )
               MOVE '23' TO FIO-STAT.
           MOVE GAR-IND-EXG-GTP IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GUB' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGUBNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GUB.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GUB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GUB.
           MOVE GAR-IND-EXG-GUB IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Limpia COD-NEMO no desplegados
               MOVE WSS-OPXI TO FRM-IFLD.
               PERFORM LIM-RES-LIN UNTIL FRM-IFLD > WSS-IMAX.

           GO TO FIN-PUT-GDG-PXI.
       ERR-PUT-GDG-PXI.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_PUT_DBC_{FRM}
      *<<<< FIN_PUT_DBC_{FRM}
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN {FRM}-FLD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-OPC-MNU SECTION.
       INI-BUS-OPC-MNU.
           MOVE 'GAR'          TO FIO-SIST.
           MOVE 'PXI'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR' TO MSG-COD-SIST
               GO TO FIN-BUS-OPC-MNU.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE TAB-COD-CTAB IN TAB TO MNU-COD-OPCI IN MNU.
           MOVE 'GAR' TO FIO-SIST.
           MOVE 'MNU-COD-OPCI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MNU.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'MNU    NEX' TO MSG-COD-MENS
               GO TO FIN-BUS-OPC-MNU.
       FIN-BUS-OPC-MNU.
           EXIT.

       DIS-FMEN SECTION.
       INI-DIS-FMEN.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-OPIN
               MOVE MNU-COD-OPCI IN MNU TO FRM-COD-OPIN 
                                                 IN PXI-FLD(WSS-OPIN)
               MOVE MNU-GLS-FMEN IN MNU TO FRM-GLS-PING 
                                                 IN PXI-FLD(WSS-OPIN)
           ELSE
               IF WSS-IND-EXIG = 'S'
                   ADD 1 TO WSS-OPXI
                   MOVE MNU-COD-OPCI IN MNU TO FRM-COD-OPXI 
                                                 IN PXI-FLD(WSS-OPXI)
                   MOVE MNU-GLS-FMEN IN MNU TO FRM-GLS-PXIN
                                                 IN PXI-FLD(WSS-OPXI)
                   MOVE MNU-COD-NEMO IN MNU TO FRM-COD-NEMO
                                                 IN PXI-FLD(WSS-OPXI).
       FIN-DIS-FMEN.
           EXIT.

       LIM-RES-LIN SECTION.
       INI-LIM-RES-LIN.
           IF FRM-IFLD > WSS-OPXI
                MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(FRM-IFLD)
                MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(FRM-IFLD)
                MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(FRM-IFLD).
           ADD 1 TO FRM-IFLD.
       FIN-LIM-RES-LIN.
           EXIT.
      *>>>>
*% END
