*%! Codigo adicional para archivo
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF DBC_IDC_ICLI
      *<<<<
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-DBC-IDC-ICLI.

           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-DBC-IDC-ICLI.

           IF DBC-IDC-ICLI IN GDD-FLD NOT = ZEROES
              MOVE DBC-IDC-ICLI IN GDD-FLD TO DBC-IDC-ICLI IN DBC
              MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
              MOVE FIO-GET-KEY     TO FIO-CMND
              PERFORM GET-CLI
              MOVE FIO-STAT TO PGM-STAT-DBC
              IF NOT FIO-STAT-OKS
                 MOVE SPACES       TO DBC-GLS-NOMC IN GDD-FLD
                 MOVE 'SGC'        TO MSG-COD-SIST
                 MOVE 'CLI    NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
              IF MSG-GLS-DESC > SPACES
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                 PERFORM CPT-BLKS
                 MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD
                 GO TO FIN-VAL-DBC-IDC-ICLI
              ELSE
                 MOVE DBC-CAI-ICLI IN DBC TO
                      CNE-GDD-CAI-DCLI
                 MOVE DBC-IIC-ICLI IN DBC TO
                      CNE-GDD-IIC-DCLI
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                 PERFORM CPT-BLKS
                 MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD.
      *>>>>
*% END
*% IF INI_PUT_GDD_GDD
      *<<<<
           MOVE GDD-CAI-DCLI IN GDD TO CNE-GDD-CAI-DCLI.
           MOVE GDD-IIC-DCLI IN GDD TO CNE-GDD-IIC-DCLI.
      *>>>>
*% END
*% IF FIN_PUT_GDG_GDD
      *<<<<
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
      *MHM-INI 25-SEP-2003
      *     MOVE GDG-COD-TOPE IN GDG TO WSS-COD-TOPE IN WSS-VARI.
      *     MOVE GDG-COD-SOPE IN GDG TO WSS-COD-SOPE IN WSS-VARI.
           MOVE GDG-TIP-CGTA IN GDD-FLD TO WSS-COD-TOPE IN WSS-VARI.
           MOVE GDG-STP-CGTA IN GDD-FLD TO WSS-COD-SOPE IN WSS-VARI.
      *MHM-FIN 25-SEP-2003
      *-----------------------------------------------------*
      *    DISPLAY 'WSS-CLA-OPE:' WSS-CLA-OPE IN WSS-VARI
      
           MOVE WSS-CLA-OPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
      *    PERFORM VAL-COD.
           PERFORM BUS-TAB.
      *    DISPLAY 'MSG-COD-MENS:' MSG-COD-MENS

      *MHM-INI 23-OCT-2003
      *     MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-CGTA IN GDD-FLD.
           MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI.
      *MHM-FIN 23-OCT-2003

      *MHM-INI 12-NOV-2003
      *     IF MSG-COD-MENS = SPACES
      *        MOVE TAB-GLS-DATA IN TAB TO WSS-DATOS-ADICIONALES
      **       DISPLAY 'WSS-CLASE-GARANTIA:' WSS-CLASE-GARANTIA
      *
      *        MOVE WSS-CLASE-GARANTIA TO FRM-COD-CGAR IN GDD-FLD
      *     ELSE
      *        MOVE SPACES TO FRM-COD-CGAR IN GDD-FLD.
      *MHM-FIN 12-NOV-2003
      
      *MHM-INI 23-OCT-2003
           IF GDG-TIP-CGTA IN GDD-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GDD-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GDD-FLD.
      *MHM-FIN 23-OCT-2003
      *MHM-INI 12-NOV-2003
           MOVE GDG-TIP-CGTA IN GDD-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GDD-FLD TO TAG-STP-AGTA IN TAG.
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'GAR' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
      
                MOVE TAG-IND-TREA IN TAG TO 
                     TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TREA IN GDD-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TREA IN GDD-FLD.
      *MHM-FIN 12-NOV-2003

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CLA' TO TAB-COD-TTAB IN TAB.
           MOVE WSS-CLASE-GARANTIA TO TAB-COD-CTAB IN TAB.
      *    PERFORM VAL-COD.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
              MOVE TAB-GLS-DESC TO FRM-GLS-CGAR IN GDD-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-CGAR IN GDD-FLD.
      *>>>>
*% END
*% IF INI_KEY_GDD_GDD
      *<<<<
           MOVE CNE-GDD-CAI-DCLI TO GDD-CAI-DCLI IN GDD.
           MOVE CNE-GDD-IIC-DCLI TO GDD-IIC-DCLI IN GDD.
      *>>>>
*% END
*% IF FIN_CLR_KEY_GDD
      *<<<<
      *>>>>
*% END
*% IF PGM_VMS AND FIN_RET_GDD_GDD
      *<<<< FIN_RET_GDD_GDD
           MOVE GDD-KEY-IGDD IN GDD TO GDD-KEY-PRV.
      *>>>>
*% END
*% IF FIN_PUT_ALL_GDD
      *<<<< FIN_PUT_ALL_GDD
      *    Cuenta numero de deudores de la garantia
           PERFORM CUENTA-GDD.
           PERFORM KEY-GDD-GDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           MOVE FIO-STAT TO PGM-STAT-GDD.
      *>>>> 
*% END
*% IF FRM_GLS_TREA
      *<<<< FRM_GLS_TREA 
      *    MOVE GDG-COD-CGTA IN GDD-FLD TO TAG-COD-AGTA IN TAG.
      *    MOVE FIO-GET-KEY    TO FIO-CMND.                    
      *    PERFORM GAR-FIO-TAG.                                
      *    IF NOT FIO-STAT-OKS                                 
      *       GO TO FIN-VAL-FRM-GLS-TREA
      *    MOVE "GAR" TO TAB-COD-SIST.
      *    MOVE "RAL " TO TAB-COD-TTAB IN TAB.
      *    MOVE TAG-IND-TREA IN TAG TO TAB-COD-CTAB IN TAB.
      *    PERFORM BUS-TAB.
      *    MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TREA IN GDD-FLD.
      *>>>> 
*% END
*% IF FRM_NUM_QDEU
      *<<<< FRM_NUM_QDEU
      *    Cuenta numero de deudores de la garantia
           PERFORM CUENTA-GDD.
           PERFORM KEY-GDD-GDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           MOVE FIO-STAT TO PGM-STAT-GDD.
      *>>>> 
*% END
*% IF INI_VAL_CON_IKY_GDD
      *<<<< INI_VAL_CON_IKY_GDD
      *    TODO LLENO ( CLI + GDG )
*% IF PGM_MEX
           IF NOT (( DBC-IDC-ICLI IN GDD-FLD NOT = SPACES OR
                     DBC-GLS-NOMC IN GDD-FLD > SPACES ) AND
                     GDD-IIC-GTIA IN GDD-FLD > ZEROES )
*% ELSE
           IF NOT (( DBC-NUM-ICLI IN GDD-FLD NOT = ZEROES OR
                     DBC-GLS-NOMC IN GDD-FLD > SPACES ) AND
                     GDD-IIC-GTIA IN GDD-FLD > ZEROES )
*% END
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-IKY-GDD.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_GDD
      *<<<< INI_VAL_CON_KEY_GDD
*% IF PGM_MEX
           IF SCR-CCPP = 'ELI' AND
              NOT (( DBC-IDC-ICLI IN GDD-FLD NOT = SPACES OR
                     DBC-GLS-NOMC IN GDD-FLD > SPACES ) AND
                     GDD-IIC-GTIA IN GDD-FLD > ZEROES )
*% ELSE
           IF SCR-CCPP = 'ELI' AND
              NOT (( DBC-NUM-ICLI IN GDD-FLD NOT = ZEROES OR
                     DBC-GLS-NOMC IN GDD-FLD > SPACES ) AND
                     GDD-IIC-GTIA IN GDD-FLD > ZEROES )
*% END

               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
*% IF PGM_MEX
           IF     GDD-IIC-GTIA IN GDD-FLD NOT > ZEROES 
              AND DBC-GLS-NOMC IN GDD-FLD NOT > SPACES 
              AND DBC-IDC-ICLI IN GDD-FLD = SPACES 
*% ELSE
           IF     GDD-IIC-GTIA IN GDD-FLD NOT > ZEROES 
              AND DBC-GLS-NOMC IN GDD-FLD NOT > SPACES 
              AND DBC-NUM-ICLI IN GDD-FLD = ZEROES 
*% END
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDD.
           GO TO FIN-VAL-CON-KEY-GDD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_GDD
      *<<<< FIN_PUT_DBC_GDD
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF MSG-COD-MENS > SPACES 
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-DBC-VRF-ICLI.
*% IF PGM_MEX
           IF DBC-IDC-ICLI IN GDD-FLD NOT = SPACES
               MOVE DBC-IDC-ICLI IN GDD-FLD TO DBC-IDC-ICLI IN DBC
*% ELSE
           IF DBC-NUM-ICLI IN GDD-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN GDD-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN GDD-FLD TO DBC-IND-ICLI IN DBC
*% END
               MOVE DBC-GLS-ICLI IN GDD-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY     TO FIO-CMND
               PERFORM GET-CLI
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDD-FLD
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE 
               IF MSG-GLS-DESC > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO
                        CNE-GDD-CAI-DCLI
                   MOVE DBC-IIC-ICLI IN DBC TO 
                        CNE-GDD-IIC-DCLI
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDD-FLD.
*% END
*% IF GDD_SGV_VLIM
      *<<<< GDD_VAL_LIM_DDR

           IF GDG-COD-VCAM IN GDD-FLD = WSS-COD-PESO IN CMA-VARI AND
              GDD-SGV-VLIM IN GDD-FLD > ZEROES
               MOVE GDD-SGV-VLIM  IN GDD-FLD TO 
                    PES-SGV-DECI  IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GDD-SGV-VLIM IN GDD-FLD.
      *>>>>
*% END
*% IF GDD_SGV_PLIM
      *<<<< GDD_PCT_LIM_DDR
           IF NOT ( GDD-SGV-VLIM  IN GDD-FLD > ZEROES OR
                    GDD-SGV-PLIM  IN GDD-FLD > ZEROES )
               MOVE 100 TO GDD-SGV-PLIM IN GDD-FLD
           ELSE
           IF GDD-SGV-PLIM  IN GDD-FLD > 100
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE '%>100'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
