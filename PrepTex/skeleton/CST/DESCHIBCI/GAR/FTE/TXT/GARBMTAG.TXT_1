*% FRM = 'TAG'
*% REG = 'TAG'
*% TAG_PGM = TRUE
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF TAG_COD_TOPE
      *<<<< TAG_STP_OPE
*% VALIDA = TRUE
*% FINPARRAFO = 'FIN-VAL-TAG-COD-TOPE'
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'  TO TAB-COD-SIST.
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE TAG-COD-TOPE IN TAG-FLD TO TAG-COD-TOPE IN TAG.
           MOVE TAG-COD-SOPE IN TAG-FLD TO TAG-COD-SOPE IN TAG.
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SOPE IN TAG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-SOPE IN TAG-FLD
               GO TO FIN-VAL-TAG-COD-TOPE.
      *>>>>
*% END
*% IF TAG_IND_VTO
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'EXI ' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-IND-VTO IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
*% END
*% IF FIN_CLR_TAG_TAG
      *<<<< FIN_CLR_TAG_TAG
      *    MOVE 'S'  TO  TAG-IND-EGDG IN TAG-FLD.
      *    MOVE 'S'  TO  TAG-IND-EGDD IN TAG-FLD.
      *    MOVE 'S'  TO  TAG-IND-EGVT IN TAG-FLD.
      *>>>>
*% END
*% IF FIN_PUT_TAG_TAG
      *<<<< FIN_PUT_TAG_TAG
*% VALIDA = FALSE
      *MHM-INI 1-SEP-2003
           MOVE 'TAB'  TO TAB-COD-SIST.
           MOVE 'TIO'  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE TAG-COD-TOPE IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOPE IN TAG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOPE IN TAG-FLD.

      *MHM-FIN 1-SEP-2003
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB'  TO TAB-COD-SIST.
      *    MOVE TAG-COD-TOPE IN TAG-FLD TO TAG-COD-TOPE IN TAG.
      *    MOVE TAG-COD-SOPE IN TAG-FLD TO TAG-COD-SOPE IN TAG.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE TAG-COD-TOPE IN TAG-FLD TO TAG-COD-TOPE IN TAG.
           MOVE TAG-COD-SOPE IN TAG-FLD TO TAG-COD-SOPE IN TAG.
      *>>>>
*% ELSE
      *    MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.
           MOVE 'GTA'  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE TAG-COD-AGTA IN TAG-FLD TO TAG-COD-AGTA IN TAG.
*% END
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SOPE IN TAG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-SOPE IN TAG-FLD.
      *MHM-INI 1-SEP-2003
           IF TAG-IND-TREA IN TAG-FLD > SPACES
               MOVE 'GAR'  TO TAB-COD-SIST
               MOVE 'RAL ' TO TAB-COD-TTAB IN TAB
               MOVE TAG-IND-TREA IN TAG-FLD TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TREA IN TAG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TREA IN TAG-FLD.

           IF TAG-COD-CLAS IN TAG-FLD > SPACES
               MOVE 'GAR'  TO TAB-COD-SIST
               MOVE 'CLA'  TO TAB-COD-TTAB IN TAB
               MOVE TAG-COD-CLAS IN TAG-FLD TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-CLAS IN TAG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CLAS IN TAG-FLD.

           IF TAG-COD-TPOL IN TAG-FLD > SPACES
               MOVE 'GAR'  TO TAB-COD-SIST
               MOVE 'POL'  TO TAB-COD-TTAB IN TAB
               MOVE TAG-COD-TPOL IN TAG-FLD TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TPOL IN TAG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TPOL IN TAG-FLD.

      *MHM-FIN 1-SEP-2003
*% IF NOT GEN_BCI
      *<<<< NOT GEN_BCI
           MOVE ZEROES        TO TAG-SGV-PAJU IN TAG-FLD.
           MOVE ZEROES        TO TAG-SGV-PPON  IN TAG-FLD.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_TAG
      *<<<< INI_VAL_CON_KEY_TAG
           GO TO FIN-VAL-CON-KEY-TAG.
      *>>>>
*% END
*% IF FIN_FST_FLD_TAG
      *<<<< FIN_FST_FLD_TAG
           IF NOT ( SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON )
               MOVE 'S' TO TAG-IND-EGDG IN TAG-FLD
               MOVE 'S' TO TAG-IND-EGDD IN TAG-FLD
               MOVE 'S' TO TAG-IND-EGVT IN TAG-FLD

      *         MOVE 'S' TO TAG-IND-EGES IN TAG-FLD
               MOVE 'S' TO TAG-IND-EGAP IN TAG-FLD
      
      *         MOVE FRM-CPIM-AEY TO TAG-IND-EGES-ATR IN TAG-FLD
      *         MOVE FRM-CPIM-AEY TO TAG-IND-EGES-STP
      
               MOVE FRM-CPIM-AEY TO TAG-IND-EGAP-ATR IN TAG-FLD
               MOVE FRM-CPIM-AEY TO TAG-IND-EGAP-STP
               MOVE FRM-CPIM-AEY TO TAG-IND-EGDD-ATR IN TAG-FLD
               MOVE FRM-CPIM-AEY TO TAG-IND-EGDD-STP

               MOVE FRM-CPIM-AEY TO TAG-IND-EGVT-ATR IN TAG-FLD
               MOVE FRM-CPIM-AEY TO TAG-IND-EGVT-STP.

      *>>>>
*% END
*% IF INI_PRO_PRO_TAG
      *<<<< PRO_PROT_TAG
           MOVE FRM-CPIM-AEY TO TAG-IND-EGES-ATR IN TAG-FLD.
           MOVE FRM-CPIM-AEY TO TAG-IND-EGES-STP.
           MOVE FRM-CPIM-AEY TO TAG-IND-EGAP-ATR IN TAG-FLD.
           MOVE FRM-CPIM-AEY TO TAG-IND-EGAP-STP.
      *>>>>
*% END
*% IF TAG_IND_OUBI
      *<<<< TAG_IND_OBL_UBI
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'EUB ' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-IND-OUBI IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF TAG_IND_EGSL
      *<<<< TAG_IND_EGSL
      *RRM-INI 29-MAY-2002
      *VAL-COD Valida codigo de tabla
      *cgl-ini  19-AUG-2003 18:56:51 
      *     MOVE 'GAR'                   TO TAB-COD-SIST.
      *     MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
      *     MOVE TAG-IND-EGSL IN TAG-FLD TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *cgl-fin  19-AUG-2003 18:57:03 
      *RRM-FIN 29-MAY-2002
      *>>>>
*% END
*% IF TAG_IND_EGSO
      *<<<< TAG_IND_EGSO
      *cgl-ini  19-AUG-2003 18:57:17 
      *     MOVE TAG-IND-EGSL IN TAG-FLD TO TAG-IND-EGSO IN TAG-FLD.
      *cgl-fin  19-AUG-2003 18:57:26 
      *>>>>
*% END
*% IF TAG_COD_TPVT
      *<<<< TAG_UTP_VIG_TSN
      *
           IF TAG-NUM-PVTS IN TAG-FLD = ZEROES
               MOVE SPACES TO TAG-COD-TPVT IN TAG-FLD
               GO TO FIN-VAL-TAG-COD-TPVT.

      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB'  TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE TAG-COD-TPVT IN TAG-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF TAG_IND_TSN
      *<<<< TAG_IND_TSN
           IF NOT ( TAG-IND-TSN IN TAG-FLD = 'S' OR 'N' )
               MOVE 'SI o NO' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF VAL_CON_FLD_TAG
      *<<<< VAL_CON_FLD_TAG
           IF SCR-CMND = 'COP'
      *        MOVE TAG-COD-TOPE IN TAG-FLD TO TAG-COD-TOPE IN TAG
      *        MOVE TAG-COD-SOPE IN TAG-FLD TO TAG-COD-SOPE IN TAG
*% IF FMT_CHI
      *<<<< FMT_CHI
               MOVE TAG-COD-TOPE IN TAG-FLD TO TAG-COD-TOPE IN TAG
               MOVE TAG-COD-SOPE IN TAG-FLD TO TAG-COD-SOPE IN TAG
      *>>>>
*% ELSE
               MOVE TAG-COD-AGTA IN TAG-FLD TO TAG-COD-AGTA IN TAG
*% END
               MOVE 'GAR'                  TO FIO-SIST
               MOVE FIO-GET-KEY            TO FIO-CMND
               PERFORM GAR-FIO-TAG
               IF FIO-STAT-OKS
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'KEYPRIMDUPLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   PERFORM FST-KEY-TAG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR.
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
           PERFORM VAL-IKY-TAG-FLD.
      *>>>>
*% END
      *>>>>
*% END
*% IF EOF_BU 
      *<<<< EOF_BU
*% IF NOT FMT_CHI
      *<<<< NOT FMT_CHI
       VAL-IKY-TAG-FLD SECTION.
       INI-VAL-IKY-TAG-FLD.
      *RRM-INI 11-SEP-2001
           PERFORM VAL-TAG-COD-AGTA-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-POS-CURS TO TAG-COD-AGTA-LEN IN TAG-FLD
                GO TO FIN-VAL-IKY-TAG-FLD.

      *    PERFORM VAL-TAG-COD-TOPE-FLD.
      *    IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
      *         MOVE FRM-POS-CURS TO TAG-COD-TOPE-LEN IN TAG-FLD
      *         GO TO FIN-VAL-IKY-TAG-FLD.
      *
      *    PERFORM VAL-TAG-COD-SOPE-FLD.
      *    IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
      *         MOVE FRM-POS-CURS TO TAG-COD-SOPE-LEN IN TAG-FLD
      *         GO TO FIN-VAL-IKY-TAG-FLD.
      *RRM-FIN 11-SEP-2001
       FIN-VAL-IKY-TAG-FLD.
           EXIT.
       
      *RRM-INI 11-SEP-2001
       VAL-TAG-COD-AGTA-FLD SECTION.
       INI-VAL-TAG-COD-AGTA-FLD.
           IF TAG-COD-AGTA IN TAG-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-TAG-COD-AGTA-FLD.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-COD-AGTA IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              TAG-COD-AGTA IN TAG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AGTA IN TAG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-AGTA IN TAG-FLD.
       FIN-VAL-TAG-COD-AGTA-FLD.
           EXIT.

      *VAL-TAG-COD-TOPE-FLD SECTION.
      *INI-VAL-TAG-COD-TOPE-FLD.
      *    IF TAG-COD-TOPE IN TAG-FLD NOT > SPACES
      *       MOVE SPACES TO TAG-COD-TOPE IN TAG-FLD.
      *
      *VAL-COD Valida codigo de tabla
      *    MOVE 'TAB' TO TAB-COD-SIST.
      *    MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
      *    MOVE TAG-COD-TOPE IN TAG-FLD TO TAB-COD-CTAB IN TAB.
      *    PERFORM VAL-COD.
      *    IF MSG-COD-MENS = 'COD    NEX' OR
      *       TAG-COD-TOPE IN TAG-FLD NOT > SPACES
      *        MOVE SPACES TO FRM-GLS-TOPE IN TAG-FLD
      *    ELSE
      *        MOVE TAB-GLS-DESC IN TAB TO
      *             FRM-GLS-TOPE IN TAG-FLD.
      *FIN-VAL-TAG-COD-TOPE-FLD.
      *    EXIT.
      *
      *VAL-TAG-COD-SOPE-FLD SECTION.
      *INI-VAL-TAG-COD-SOPE-FLD.
      *    IF TAG-COD-SOPE IN TAG-FLD NOT > SPACES
      *       MOVE SPACES TO TAG-COD-SOPE IN TAG-FLD.
      *<<<< TAG_STP_OPE
      *
      *VAL-COD Valida codigo de tabla
      *    MOVE 'TAB' TO TAB-COD-SIST.
      *    MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
      *    MOVE SPACES TO TAB-COD-CTAB IN TAB.
      *    MOVE TAG-COD-TOPE IN TAG-FLD TO TAG-COD-TOPE IN TAG.
      *    MOVE TAG-COD-SOPE IN TAG-FLD TO TAG-COD-SOPE IN TAG.
      *    MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
      *    PERFORM VAL-COD.
      *    IF MSG-COD-MENS = SPACES
      *        MOVE TAB-GLS-DESC IN TAB TO
      *             FRM-GLS-SOPE IN TAG-FLD
      *    ELSE
      *        MOVE SPACES TO FRM-GLS-SOPE IN TAG-FLD
      *        GO TO FIN-VAL-TAG-COD-SOPE-FLD.
      *>>>>
      *FIN-VAL-TAG-COD-SOPE-FLD.
      *    EXIT.
      *RRM-FIN 11-SEP-2001 
      *>>>>
*% END
      *>>>>
*% END
*% IF TAG_COD_SOPE
      *<<<< TAG_COD_SOPE
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-COD-TOPE IN TAG-FLD TO TAG-COD-TOPE IN TAG.
           MOVE TAG-COD-SOPE IN TAG-FLD TO TAG-COD-SOPE IN TAG.
           MOVE TAG-COD-AGTA IN TAG TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              TAG-COD-SOPE IN TAG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SOPE IN TAG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SOPE IN TAG-FLD.
      *>>>>
*% END
*% IF TAG_COD_TOPE
      *<<<< TAG_COD_TOPE
      *VAL-COD Valida codigo de tabla
      *     MOVE 'TAB' TO TAB-COD-SIST.
      *     MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
      *     MOVE TAG-COD-TOPE IN TAG-FLD TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *     IF MSG-COD-MENS = 'COD    NEX' OR
      *        TAG-COD-TOPE IN TAG-FLD NOT > SPACES
      *         MOVE SPACES TO FRM-GLS-TOPE IN TAG-FLD
      *     ELSE
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-TOPE IN TAG-FLD.
      *>>>>
*% END
*% IF TAG_COD_CLAS
      *<<<< TAG_COD_CLAS
           IF TAG-COD-CLAS IN TAG-FLD NOT > SPACES AND
              TAG-IND-EGVT IN TAG-FLD = 'S'
                PERFORM ERR-GLS
                GO TO FIN-VAL-TAG-COD-CLAS.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'CLA' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-COD-CLAS IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              TAG-COD-CLAS IN TAG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CLAS IN TAG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CLAS IN TAG-FLD.
      *>>>>
*% END
*% IF TAG_IND_CTBL
      *<<<< TAG_IND_CTBL
           IF TAG-IND-CTBL IN TAG-FLD NOT > SPACES
               MOVE 'S' TO TAG-IND-CTBL IN TAG-FLD.

      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-IND-CTBL IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF TAG_IND_TPRE
      *<<<< TAG_IND_TPRE
           IF TAG-IND-TPRE IN TAG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-TAG-IND-TPRE.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'  TO TAB-COD-SIST.
           MOVE 'ECM ' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-IND-TPRE IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF TAG_IND_OMCT
      *<<<< TAG_IND_OMCT
           IF TAG-IND-OMCT IN TAG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-TAG-IND-OMCT.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'  TO TAB-COD-SIST.
           MOVE 'ECT ' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-IND-OMCT IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF TAG_COD_TPOL
      *<<<< TAG_COD_TPOL
           IF TAG-COD-TPOL IN TAG-FLD NOT > SPACES AND
              TAG-IND-EGSE IN TAG-FLD = 'S'
                PERFORM ERR-GLS
                GO TO FIN-VAL-TAG-COD-TPOL.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'POL' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-COD-TPOL IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              TAG-COD-TPOL IN TAG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TPOL IN TAG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TPOL IN TAG-FLD.
      *>>>>
*% END
