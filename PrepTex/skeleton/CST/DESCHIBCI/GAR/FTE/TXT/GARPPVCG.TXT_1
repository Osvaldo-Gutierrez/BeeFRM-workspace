       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   GARPPVCG.
       AUTHOR.       CONSIST.
       DATE-WRITTEN.  25-JUL-1991 16:24:03

      * VALIDA CONSISTENCIA GENERAL DE UNA GARANTIA
      * Subrutina Pone Estado Garantia Completa
      * Este programa es invocado desde cualquier programa de actualizac
      *   de garantias, y su funcion es chequear que la gtia tenga ingre
      *   las entidades (obligatorias y opcionales) que corresponde segu
      *   la tabla TAG. Si tiene entidades que no corresponde, ellas se
      *   eliminan. Tambien graba registros GMO para cada entidad
      *   ingresada, que corresponde.

      * SI HAY UN ERROR DEVUELVE MSG-COD-MENS CON EL CODIGO DEL MENSAJE
      * EL ERROR SE MANEJA EN PROGRAMA LLAMADOR
      * MARCA GAR-IND-CPL EN GDG.

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSBRMSG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGHOY.
       COPY GNSWGSYS.
       COPY GNSWGFRM.
       01  SCR-VARI.
           03 SCR-SIST             VALUE 'GAR' PIC X(03).
           03 SCR-QIDD                         PIC X(08).
           03 SCR-LIDD                    COMP PIC S9(04).

       COPY GARBRGAP.
       COPY GARBRGDD.
       COPY GARBRGDG.
       COPY GARBRGDO.
       COPY GARBRGDP.
       COPY GARBRGES.
       COPY GARBRGIN.
       COPY GARBRGLE.
       COPY GARBRGMO.
       COPY GARBRGSE.
       COPY GARBRGSI.
       COPY GARBRGTP.
       COPY GARBRGUB.
       COPY GARBRGVT.
      *MHM-INI 29-JUL-2003
       COPY GARBRGVE.
       COPY GARBRGIM.
      *MHM-FIN 29-JUL-2003
       COPY GARBRTAG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GAP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GLE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GMO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GTP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GUB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
      *MHM-INI 29-JUL-2003
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVE-REQA==.
      *MHM-FIN 29-JUL-2003

       COPY GARWGVCG.

       01  WSS-VARI.
           03 WSS-IMAL                  VALUE 0           PIC 9(01).
      *FLB CST 22-SEP-1993
           03 WSS-COD-GRA                             PIC 9(01).
           03 WSS-COD-PRD-ACR                         PIC 9(02).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                               PIC X(60).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
      *FLB CST  1-DEC-1993
           IF MSG-COD-MENS > SPACES
               GO TO EXT-MAIN.

           MOVE ZEROES TO GMO-NUM-IMOV IN GMO.

           IF GDG-IND-GTAC IN GDG = 'S'
               MOVE 'GDG    AGAYA' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF GDG-IND-EST1 IN GDG < '05' OR
              GDG-IND-EST1 IN GDG NOT < '20'
               MOVE 'GAR    NOVIG' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           MOVE GDG-COD-TOPE IN GDG TO TAG-COD-TOPE IN TAG.
           MOVE GDG-COD-SOPE IN GDG TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF GDG-COD-LGTA  IN GDG = 'E'
               MOVE 'S' TO TAG-IND-EGES IN TAG
           ELSE
               MOVE 'N' TO TAG-IND-EGES IN TAG.

      *MHM-INI 13-OCT-2003
      *     IF GDG-COD-GGTA IN GDG > '1'
      *         MOVE 'S' TO TAG-IND-EGAP IN TAG
      *     ELSE
      *         MOVE 'N' TO TAG-IND-EGAP IN TAG.
      *MHM-FIN 13-OCT-2003

           IF GDG-IND-INOB IN GDG = 'S'
               MOVE 'S' TO TAG-IND-EGIN IN TAG
           ELSE
               MOVE 'N' TO TAG-IND-EGIN IN TAG.

           MOVE '1' TO GMO-COD-MOVI IN GMO.

           IF TAG-IND-EGAP IN TAG = 'S' AND
              GDG-IND-EGAP IN GDG NOT = 'S'
               MOVE 'GAP    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

      *FLB CST 22-SEP-1993
           IF GDG-COD-GGTA IN GDG > '1'
               PERFORM VAL-GAP
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.
      *FLB CST 22-SEP-1993

      *FLB CST  13-JUN-1994
      *     IF TAG-IND-EGDD IN TAG = 'S' AND
      *        GDG-IND-EGDD IN GDG NOT = 'S'
      *         MOVE 'GDD    NEX' TO MSG-COD-MENS
      *         GO TO EXT-MAIN.
           PERFORM VAL-GDD.
           IF MSG-COD-MENS > SPACES
               GO TO EXT-MAIN.
      *FLB CST  13-JUN-1994

           IF TAG-IND-EGDO IN TAG = 'S' AND
              GDG-IND-EGDO IN GDG NOT = 'S'
               MOVE 'GDO    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF TAG-IND-EGDP IN TAG = 'S' AND
              GDG-IND-EGDP IN GDG NOT = 'S'
               MOVE 'GDP    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF TAG-IND-EGES IN TAG = 'S' AND
              GDG-IND-EGES IN GDG NOT = 'S'
               MOVE 'GES    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF TAG-IND-EGIN IN TAG = 'S' AND
              GDG-IND-EGIN IN GDG NOT = 'S'
               MOVE 'GIN    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF TAG-IND-EGLE IN TAG = 'S' AND
              GDG-IND-EGLE IN GDG NOT = 'S'
               MOVE 'GLE    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF TAG-IND-EGSE IN TAG = 'S' AND
              GDG-IND-EGSE IN GDG NOT = 'S'
               MOVE 'GSE    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.
      *MHM-INI 29-JUL-2003
           IF TAG-IND-EGSE IN TAG NOT = 'S'
              GO TO FIN-EGSE.

           MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE.
           MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE.
           MOVE ZEROES              TO GSE-NUM-IGSE IN GSE.
           MOVE FIO-GET-NLS TO FIO-CMND
           PERFORM GAR-FIO-GSE
           IF NOT ( FIO-STAT-OKS AND
                    GDG-CAI-GTIA IN GDG = GSE-CAI-GTIA IN GSE AND
                    GDG-IIC-GTIA IN GDG = GSE-IIC-GTIA IN GSE    )
              MOVE 'GSE    NEX' TO MSG-COD-MENS
              GO TO EXT-MAIN.
       LUP-EGSE.
            IF NOT ( FIO-STAT-OKS AND
                     GDG-CAI-GTIA IN GDG = GSE-CAI-GTIA IN GSE AND
                     GDG-IIC-GTIA IN GDG = GSE-IIC-GTIA IN GSE    )
               MOVE '00' TO FIO-STAT
               GO TO FIN-EGSE.

            IF GSE-FEC-FVTS IN GSE < HOY-FHOY
               MOVE 'GSE    VEN' TO MSG-COD-MENS
               GO TO EXT-MAIN.

            MOVE FIO-GET-NXT TO FIO-CMND.
            PERFORM GAR-FIO-GSE.
            GO TO LUP-EGSE.

       FIN-EGSE.

      *MHM-FIN 29-JUL-2003
           IF TAG-IND-EGSI IN TAG = 'S' AND
              GDG-IND-EGSI IN GDG NOT = 'S'
               MOVE 'GSI    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF TAG-IND-EGTP IN TAG = 'S' AND
              GDG-IND-EGTP IN GDG NOT = 'S'
               MOVE 'GTP    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF TAG-IND-EGUB IN TAG = 'S' AND
              GDG-IND-EGUB IN GDG NOT = 'S'
               MOVE 'GUB    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.
      *MHM-INI 29-JUL-2003
           IF TAG-IND-EGIM IN TAG = 'S' AND
              GDG-IND-EGIM IN GDG NOT = 'S'
              MOVE 'GIM    NEX' TO MSG-COD-MENS
              GO TO EXT-MAIN.

           IF TAG-IND-EGVE IN TAG = 'S' AND
              GDG-IND-EGVE IN GDG NOT = 'S'
              MOVE 'GVE    NEX' TO MSG-COD-MENS
              GO TO EXT-MAIN.
      *MHM-FIN 29-JUL-2003
      *---------------------------------------------------*

      *FLB CST  19-OCT-1993 DISTINGUE GVT NO INGRESADA DE TASACION NO
      *   ACTIVADA EN TASACIONES PARCIALES
           MOVE GDG-CAI-GTIA IN GDG TO GVT-CAI-GTIA IN GVT.
           MOVE GDG-IIC-GTIA IN GDG TO GVT-IIC-GTIA IN GVT.
           MOVE GDG-COD-TSCN IN GDG TO GVT-COD-TASN IN GVT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           IF NOT FIO-STAT-OKS
               MOVE 'GVT    NEX' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF TAG-IND-EGVT IN TAG = 'S' AND
              GDG-IND-EGVT IN GDG NOT = 'S'
               IF GVT-MSC-STAT IN GVT NOT = 'A'
                   MOVE 'ATANO' TO MSG-COD-MENS
                   GO TO EXT-MAIN
               ELSE
                   MOVE 'PGM    ERR' TO MSG-COD-MENS
                   GO TO EXT-MAIN.

      * GENERA GMO DE GDG
           PERFORM INI-GMO.
           MOVE 'GDG001' TO GMO-COD-CMPO IN GMO.
           MOVE '1' TO GMO-COD-MOVI IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'S' TO GMO-IND-CLVE IN GMO.
           MOVE GDG-IND-EST1 IN GDG TO GMO-COD-NCLV IN GMO.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO CON-SIN-GMO.
      *ALD-ADA-FIN/08112001
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               MOVE 'GMO    PUT' TO MSG-COD-MENS
               GO TO EXT-MAIN.
      *ALD-ADA-INI/08112001
       CON-SIN-GMO.
      *ALD-ADA-FIN/08112001

      *    PERFORM GET-FHOY.
      *FLB CST  17-NOV-1993 SE TRASLADA EL CODIGO QUE HABIA AQUI
      *         A ANTES DEL FIO-MOD
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG   KEYUPD' TO MSG-COD-MENS
               GO TO EXT-MAIN.

           IF TAG-IND-EGVT IN TAG = 'N' AND
              GDG-IND-EGVT IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGVT IN GDG
               PERFORM ELI-GVT
           ELSE
           IF GDG-IND-EGVT IN GDG = 'S'
      *FLB CST  19-OCT-1993 SE TRASLADO EL BUS-GVT (NO SECTION)
               PERFORM ESC-GMO-GVT
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN
               ELSE
                   NEXT SENTENCE
           ELSE
               GO TO EXT-MAIN.

           IF TAG-IND-EGDD IN TAG = 'N' AND
              GDG-IND-EGDD IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGDD IN GDG
               PERFORM ELI-GDD
           ELSE
           IF GDG-IND-EGDD IN GDG = 'S'
               PERFORM ESC-GMO-GDD
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGES IN TAG = 'N' AND
              GDG-IND-EGES IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGES IN GDG
               PERFORM ELI-GES
           ELSE
           IF GDG-IND-EGES IN GDG = 'S'
               PERFORM ESC-GMO-GES
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGLE IN TAG = 'N' AND
              GDG-IND-EGLE IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGLE IN GDG
               PERFORM ELI-GLE
           ELSE
           IF GDG-IND-EGLE IN GDG = 'S'
               PERFORM ESC-GMO-GLE
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGDO IN TAG = 'N' AND
              GDG-IND-EGDO IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGDO IN GDG
               PERFORM ELI-GDO
           ELSE
           IF GDG-IND-EGDO IN GDG = 'S'
               PERFORM ESC-GMO-GDO
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGSE IN TAG = 'N' AND
              GDG-IND-EGSE IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGSE IN GDG
               PERFORM ELI-GSE
           ELSE
           IF GDG-IND-EGSE IN GDG = 'S'
               PERFORM ESC-GMO-GSE
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGTP IN TAG = 'N' AND
              GDG-IND-EGTP IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGTP IN GDG
               PERFORM ELI-GTP
           ELSE
           IF GDG-IND-EGTP IN GDG = 'S'
               PERFORM ESC-GMO-GTP
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGUB IN TAG = 'N' AND
              GDG-IND-EGUB IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGUB IN GDG
               PERFORM ELI-GUB
           ELSE
           IF GDG-IND-EGUB IN GDG = 'S'
               PERFORM ESC-GMO-GUB
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGAP IN TAG = 'N' AND
              GDG-IND-EGAP IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGAP IN GDG
               PERFORM ELI-GAP
           ELSE
           IF GDG-IND-EGAP IN GDG = 'S'
               PERFORM ESC-GMO-GAP
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGIN IN TAG = 'N' AND
              GDG-IND-EGIN IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGIN IN GDG
               PERFORM ELI-GIN
           ELSE
           IF GDG-IND-EGIN IN GDG = 'S'
               PERFORM ESC-GMO-GIN
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGSI IN TAG = 'N' AND
              GDG-IND-EGSI IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGSI IN GDG
               PERFORM ELI-GSI
           ELSE
           IF GDG-IND-EGSI IN GDG = 'S'
               PERFORM ESC-GMO-GSI
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.

           IF TAG-IND-EGDP IN TAG = 'N' AND
              GDG-IND-EGDP IN GDG = 'S'
      *FLB CST  17-NOV-1993 SE LIMPIA EL INDICADOR
               MOVE SPACES TO GDG-IND-EGDP IN GDG
               PERFORM ELI-GDP
           ELSE
           IF GDG-IND-EGDP IN GDG = 'S'
               PERFORM ESC-GMO-GDP
               IF MSG-COD-MENS > SPACES
                   GO TO EXT-MAIN.
      *MHM-INI 29-JUL-2003
           IF TAG-IND-EGIM IN TAG = 'N' AND
              GDG-IND-EGIM IN GDG = 'S'
               MOVE SPACES TO GDG-IND-EGIM IN GDG
               PERFORM ELI-GIM.

           IF TAG-IND-EGVE IN TAG = 'N' AND
              GDG-IND-EGVE IN GDG = 'S'
               MOVE SPACES TO GDG-IND-EGVE IN GDG
               PERFORM ELI-GVE.
      *MHM-FIN 29-JUL-2003
      *FLB CST  17-NOV-1993 TRASLADADO AQUI PARA EVITAR QUE IND-EXI-XXX
      *    QUEDE LLENO EN GDG CUANDO DEBE ESTAR VACIO
      *    EL PROBLEMA SE PRODUJO EN LA ENTIDAD GES PERO PODRIA OCURRIR
      *    PARA OTRAS

      *FLB CST  17-NOV-1993 TRASLADADO AQUI
           MOVE HOY-FHOY TO GDG-FEC-FTRN IN GDG.
           MOVE HOY-HHOY TO GDG-HRA-HRTR IN GDG.
      *FLB CST  17-NOV-1993 TRASLADADO AQUI
           MOVE HOY-FHOY TO GDG-FEC-FING IN GDG.
           MOVE 'I'      TO GDG-MSC-TACC IN GDG.
      *MHM-INI 29-JUL-2003
           MOVE '10'     TO GDG-IND-EST1 IN GDG.
      *MHM-FIN 29-JUL-2003
           MOVE 'S'      TO GDG-IND-GTAC  IN GDG.
           MOVE 'A'      TO GDG-MSC-STAT  IN GDG.
      *MHM-INI 29-JUL-2003
           MOVE HOY-FHOY TO GDG-FEC-FEST IN GDG.
      *MHM-FIN 29-JUL-2003
      *MHM-INI 21-OCT-2003
           IF VCG-FEC-FVTO IN VCG-VARI > SPACES
               MOVE  VCG-FEC-FVTO IN VCG-VARI TO GDG-FEC-FVTO IN GDG.
      *MHM-FIN 21-OCT-2003
      *FLB CST  13-JUN-1994
           MOVE 'S'      TO GDG-IND-EGDD IN GDG.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG    MOD' TO MSG-COD-MENS
               GO TO EXT-MAIN.
      *FLB CST  17-NOV-1993 TRASLADADO AQUI

      * TERMINA NORMALMENTE EN EXT-MAIN.
       EXT-MAIN.
           PERFORM FIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEDB.
           MOVE DFHCOMMAREA(1:EIBCALEN) TO VCG-CMMA.
           MOVE VCG-PROG    TO FIO-PROG.
           MOVE SPACES TO MSG-COD-MENS.
      *Handler para manejar VSAM
      *     PERFORM GNS-HDL-VSM.
      *Buscar Independencia de Datos
           MOVE VCG-QIDD TO SCR-QIDD.
           MOVE VCG-LIDD TO SCR-LIDD.
           PERFORM GNS-BUS-IDD.
      *Carga
      *FLB CST  1-DEC-1993
      *     MOVE VCG-RGDG TO GDG.
           MOVE VCG-CAI-GTIA TO GDG-CAI-GTIA IN GDG.
           MOVE VCG-IIC-GTIA TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG    NEX' TO MSG-COD-MENS.
      *FLB CST  1-DEC-1993
       FIN-INI.
           EXIT.

       FIN SECTION.
       INI-FIN.
      *FLB CST  1-DEC-1993
      *     MOVE GDG TO VCG-RGDG.
      *     MOVE MSG TO VCG-RMSG.
      *MHM-INI 29-JUL-2003
      *     MOVE MSG-COD-MENS TO VCG-MENS.
           MOVE MSG-COD-MENS TO VCG-GLS-MENS.
      *MHM-FIN 29-JUL-2003
      *FLB CST  1-DEC-1993
           MOVE VCG-CMMA TO DFHCOMMAREA.
           MOVE +0 TO EIBRESP.
       COPY GNSBGGBK.
       FIN-FIN.
           EXIT.

       COPY GNSBGSYS.
       COPY GNSBBIDD.
       COPY GNSBHVSM.
       COPY GNSBGVSM.
      * COPY GNSBGDTC.
       COPY GNSBIABT.

       COPY GARBGVC2.

      *FLB CST 22-SEP-1993
       VAL-GAP SECTION.
       INI-VAL-GAP.
           MOVE GDG-COD-GGTA IN GDG TO WSS-COD-GRA.
           MOVE GDG-CAI-GTIA IN GDG TO GAP-CAI-GTIA IN GAP.
           MOVE GDG-IIC-GTIA IN GDG TO GAP-IIC-GTIA IN GAP.
           MOVE WSS-COD-GRA TO WSS-COD-PRD-ACR.
           MOVE WSS-COD-PRD-ACR TO GAP-COD-PACR IN GAP.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF FIO-STAT-OKS
               MOVE 'GRAINV' TO MSG-COD-MENS
               GO TO FIN-VAL-GAP.

           SUBTRACT 1 FROM WSS-COD-PRD-ACR.
           MOVE WSS-COD-PRD-ACR TO GAP-COD-PACR IN GAP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF NOT FIO-STAT-OKS
               MOVE 'GRAINV' TO MSG-COD-MENS
               GO TO FIN-VAL-GAP.

       FIN-VAL-GAP.
           EXIT.

      *FLB CST 22-SEP-1993 FIN

       ESC-GMO-GDD SECTION.
       INI-ESC-GMO-GDD.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GDD.
      *ALD-ADA-FIN/08112001
           PERFORM INI-GMO.
           MOVE 'GDD001' TO GMO-COD-CMPO IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.
           MOVE 1 TO WSS-IMAL.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-ESC-GMO-GDD.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GDD-CAI-GTIA IN GDD AND
              GDG-IIC-GTIA IN GDG = GDD-IIC-GTIA IN GDD
               MOVE 0 TO WSS-IMAL
               MOVE GDD-KEY-IGDD IN GDD TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-ESC-GMO-GDD
               ELSE
                   MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
               IF WSS-IMAL > 0
                   MOVE 'GDD    NEX' TO MSG-COD-MENS.
       FIN-ESC-GMO-GDD.
           EXIT.

       ESC-GMO-GES SECTION.
       INI-ESC-GMO-GES.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GES.
      *ALD-ADA-FIN/08112001
           PERFORM INI-GMO.
           MOVE 'GES000' TO GMO-COD-CMPO IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.
           MOVE ZEROES TO GES-NUM-IGES IN GES.
           MOVE 'GES-KEY-IGES' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO WSS-IMAL.
       LUP-ESC-GMO-GES.
           PERFORM GAR-FIO-GES.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GES-CAI-GTIA IN GES AND
              GDG-IIC-GTIA IN GDG = GES-IIC-GTIA IN GES
               MOVE 0 TO WSS-IMAL
               MOVE GES-NUM-IGES IN GES TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-ESC-GMO-GES
               ELSE
                   MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
               IF WSS-IMAL > 0
                   MOVE 'GES    NEX' TO MSG-COD-MENS.
       FIN-ESC-GMO-GES.
           EXIT.

       ESC-GMO-GLE SECTION.
       INI-ESC-GMO-GLE.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GLE.
      *ALD-ADA-FIN/08112001
           PERFORM INI-GMO.
           MOVE 'GLE000' TO GMO-COD-CMPO IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GLE-CAI-GTIA IN GLE.
           MOVE GDG-IIC-GTIA IN GDG TO GLE-IIC-GTIA IN GLE.
      *MHM-INI 29-JUL-2003
           MOVE ZEROES              TO GLE-COD-PACR IN GLE.
      *MHM-FIN 29-JUL-2003
           MOVE 'GLE-KEY-IGLE' TO FIO-AKEY.
      *MHM-INI 29-JUL-2003
      *     MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO WSS-IMAL.
      *MHM-FIN 29-JUL-2003
       LUP-VCG-ESC-GMO-GLE.
           PERFORM GAR-FIO-GLE.
      *MHM-INI 29-JUL-2003
      *     IF FIO-STAT-OKS
      *         MOVE 'DATOS LEGALES' TO GMO-GLS-NCMP IN GMO
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GLE-CAI-GTIA IN GLE AND
              GDG-IIC-GTIA IN GDG = GLE-IIC-GTIA IN GLE
               MOVE 0 TO WSS-IMAL
               MOVE GLE-COD-PACR IN GLE TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
      *MHM-FIN 29-JUL-2003
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
      *MHM-INI 29-JUL-2003
      *             NEXT SENTENCE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GLE
      *MHM-FIN 29-JUL-2003
               ELSE
                   MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
      *MHM-INI 29-JUL-2003
               IF WSS-IMAL > 0
      *MHM-FIN 29-JUL-2003
                   MOVE 'GLE    NEX' TO MSG-COD-MENS.
       FIN-ESC-GMO-GLE.
           EXIT.

       ESC-GMO-GDO SECTION.
       INI-ESC-GMO-GDO.
       FIN-ESC-GMO-GDO.
           EXIT.

       ESC-GMO-GSE SECTION.
       INI-ESC-GMO-GSE.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GSE.
      *ALD-ADA-FIN/08112001
           PERFORM INI-GMO.
           MOVE 'GSE000' TO GMO-COD-CMPO IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE.
           MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE.
      *MHM-INI 29-JUL-2003
           MOVE ZEROES              TO GSE-NUM-IGSE IN GSE.
      *MHM-FIN 29-JUL-2003
           MOVE 'GSE-KEY-IGSE' TO FIO-AKEY.
      *MHM-INI 29-JUL-2003
      *     MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO WSS-IMAL.
       LUP-VCG-ESC-GMO-GSE.
      *MHM-FIN 29-JUL-2003
           PERFORM GAR-FIO-GSE.
      *MHM-INI 29-JUL-2003
      *     IF FIO-STAT-OKS
      *         MOVE 'DATOS DE SEGUROS' TO GMO-GLS-NCMP IN GMO
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GSE-CAI-GTIA IN GSE AND
              GDG-IIC-GTIA IN GDG = GSE-IIC-GTIA IN GSE
               MOVE 0 TO WSS-IMAL
               MOVE GSE-NUM-IGSE IN GSE TO GMO-GLS-NCMP IN GMO
      *MHM-FIN 29-JUL-2003
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
      *MHM-INI 29-JUL-2003
      *             NEXT SENTENCE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GSE
      *MHM-FIN 29-JUL-2003
               ELSE
                   MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
      *MHM-INI 29-JUL-2003
               IF WSS-IMAL > 0
      *MHM-FIN 29-JUL-2003
                  MOVE 'GSE    NEX' TO MSG-COD-MENS.
       FIN-ESC-GMO-GSE.
           EXIT.

       ESC-GMO-GVT SECTION.
       INI-ESC-GMO-GVT.
           MOVE SPACES TO MSG-COD-MENS.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GVT.
      *ALD-ADA-FIN/08112001
      * SI LA GARANTIA ESTA COMPLETA, SE ESCRIBE GMO
      * SI ESTA INCOMPLETA SE ESCRIBE EN RUTINA QUE MARCA GARANTIA COMPL
           PERFORM INI-GMO.
           MOVE GVT-COD-TASN IN GVT TO GMO-NUM-TASN IN GMO.
           MOVE 'GVT001' TO GMO-COD-CMPO IN GMO.
           MOVE GVT-SGV-LTSN IN GVT TO GMO-SGV-NCMP IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-ESC-GMO-GVT.

           MOVE 'GVT002' TO GMO-COD-CMPO IN GMO.
           MOVE GVT-SGV-VCTS IN GVT TO GMO-SGV-NCMP IN GMO.
           ADD 1 TO GMO-NUM-IMOV IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-ESC-GMO-GVT.

           MOVE 'GVT003' TO GMO-COD-CMPO IN GMO.
           MOVE GVT-SGV-VPND IN GVT TO GMO-SGV-NCMP IN GMO.
           ADD 1 TO GMO-NUM-IMOV IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-ESC-GMO-GVT.

           MOVE 'GVT005' TO GMO-COD-CMPO IN GMO.
           MOVE GVT-FEC-FTSN IN GVT TO GMO-GLS-NCMP IN GMO.
           MOVE GVT-SGV-VGAS IN GVT TO GMO-SGV-NCMP IN GMO.
           ADD 1 TO GMO-NUM-IMOV IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-ESC-GMO-GVT.

           MOVE 'GVT004' TO GMO-COD-CMPO IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE ZEROES TO GMO-SGV-CMPA IN GMO.
           MOVE ZEROES TO GMO-SGV-NCMP IN GMO.
           MOVE GVT-FEC-FTSN IN GVT TO GMO-GLS-NCMP IN GMO.
           ADD 1 TO GMO-NUM-IMOV IN GMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-ESC-GMO-GVT.
           GO TO FIN-ESC-GMO-GVT.
       ERR-ESC-GMO-GVT.
           MOVE 'GMO    PUT' TO MSG-COD-MENS.
       FIN-ESC-GMO-GVT.
           EXIT.

       ESC-GMO-GTP SECTION.
       INI-ESC-GMO-GTP.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GTP.
      *ALD-ADA-FIN/08112001
           PERFORM INI-GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE 'GTP001' TO GMO-COD-CMPO IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GTP-CAI-GTIA IN GTP.
           MOVE GDG-IIC-GTIA IN GDG TO GTP-IIC-GTIA IN GTP.
           MOVE GDG-COD-TSCN IN GDG TO GTP-NUM-ITSN IN GTP.
           MOVE SPACES TO GTP-COD-IITS IN GTP.
           MOVE 'GTP-KEY-IGTP' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO WSS-IMAL.
       LUP-ESC-GMO-GTP.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GTP-CAI-GTIA IN GTP AND
              GDG-IIC-GTIA IN GDG = GTP-IIC-GTIA IN GTP
               MOVE 0 TO WSS-IMAL
               MOVE GTP-COD-IITS IN GTP TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-ESC-GMO-GTP
               ELSE
                   MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
               IF WSS-IMAL > 0
                   MOVE 'GTP    NEX' TO MSG-COD-MENS.
       FIN-ESC-GMO-GTP.
           EXIT.

       ESC-GMO-GUB SECTION.
       INI-ESC-GMO-GUB.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GUB.
      *ALD-ADA-FIN/08112001
           PERFORM INI-GMO.
           MOVE 'GUB000' TO GMO-COD-CMPO IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GUB-CAI-GTIA IN GUB.
           MOVE GDG-IIC-GTIA IN GDG TO GUB-IIC-GTIA IN GUB.
           MOVE 'GUB-KEY-IGUB' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GUB.
           IF FIO-STAT-OKS
               MOVE 'DATOS DE UBICACION' TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   NEXT SENTENCE
               ELSE
                   MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
                   MOVE 'GUB    NEX' TO MSG-COD-MENS.
       FIN-ESC-GMO-GUB.
           EXIT.

       ESC-GMO-GAP SECTION.
       INI-ESC-GMO-GAP.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GAP.
      *ALD-ADA-FIN/08112001
      *MHM-INI 17-OCT-2003
           MOVE 'GAP-KEY-IGAP' TO FIO-AKEY
           MOVE FIO-END-BRW TO FIO-CMND
           PERFORM GAR-FIO-GAP.
      *MHM-FIN 17-OCT-2003
           PERFORM INI-GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE 'GAP001' TO GMO-COD-CMPO IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GAP-CAI-GTIA IN GAP.
           MOVE GDG-IIC-GTIA IN GDG TO GAP-IIC-GTIA IN GAP.
      *MHM-INI 17-OCT-2003
           MOVE ZEROES              TO GAP-COD-PACR IN GAP.
      *MHM-FIN 17-OCT-2003
           MOVE SPACES TO GAP-CIC-ICLI IN GAP.
           MOVE 'GAP-KEY-IGAP' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO WSS-IMAL.
       LUP-ESC-GMO-GAP.
           PERFORM GAR-FIO-GAP.
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GAP-CAI-GTIA IN GAP AND
              GDG-IIC-GTIA IN GDG = GAP-IIC-GTIA IN GAP
               MOVE 0 TO WSS-IMAL
               MOVE GAP-CIC-ICLI IN GAP TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-ESC-GMO-GAP
               ELSE
                   MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
               IF WSS-IMAL > 0
                   MOVE 'GAP    NEX' TO MSG-COD-MENS.
       FIN-ESC-GMO-GAP.
           EXIT.

       ESC-GMO-GIN SECTION.
       INI-ESC-GMO-GIN.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GIN.
      *ALD-ADA-FIN/08112001
           PERFORM INI-GMO.
           MOVE 'GIN000' TO GMO-COD-CMPO IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GIN-CAI-GTIA IN GIN.
           MOVE GDG-IIC-GTIA IN GDG TO GIN-IIC-GTIA IN GIN.
      *MHM-INI 29-JUL-2003
           MOVE ZEROES              TO GIN-NUM-IGIN IN GIN.
      *MHM-FIN 29-JUL-2003
           MOVE 'GIN-KEY-IGIN' TO FIO-AKEY.
      *MHM-INI 29-JUL-2003
      *     MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 1 TO WSS-IMAL.
       LUP-VCG-ESC-GMO-GIN.
      *MHM-FIN 29-JUL-2003
           PERFORM GAR-FIO-GIN.
      *MHM-INI 29-JUL-2003
      *     IF FIO-STAT-OKS
      *         MOVE 'DATOS DE INSPECCIONES' TO GMO-GLS-NCMP IN GMO
           IF FIO-STAT-OKS AND
              GDG-CAI-GTIA IN GDG = GIN-CAI-GTIA IN GIN AND
              GDG-IIC-GTIA IN GDG = GIN-IIC-GTIA IN GIN
               MOVE 0 TO WSS-IMAL
               MOVE GIN-NUM-IGIN IN GIN TO GMO-GLS-NCMP IN GMO
      *MHM-FIN 29-JUL-2003
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
      *MHM-INI 29-JUL-2003
      *             NEXT SENTENCE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   ADD 1 TO GMO-NUM-IMOV IN GMO
                   GO TO LUP-VCG-ESC-GMO-GIN
      *MHM-FIN 29-JUL-2003
               ELSE
                   MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
      *MHM-INI 29-JUL-2003
               IF WSS-IMAL > 0
      *MHM-FIN 29-JUL-2003
                   MOVE 'GIN    NEX' TO MSG-COD-MENS.
       FIN-ESC-GMO-GIN.
           EXIT.

       ESC-GMO-GDP SECTION.
       INI-ESC-GMO-GDP.
      *ALD-ADA-INI/08112001
           IF TAG-IND-CTBL IN TAG = 'N'
               GO TO FIN-ESC-GMO-GDP.
      *ALD-ADA-FIN/08112001
           PERFORM INI-GMO.
           MOVE 'GDP000' TO GMO-COD-CMPO IN GMO.
           MOVE 'N' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GDP-CAI-GTIA IN GDP.
           MOVE GDG-IIC-GTIA IN GDG TO GDP-IIC-GTIA IN GDP.
           MOVE 'GDP-KEY-IGDP' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDP.
           IF FIO-STAT-OKS
               MOVE 'DATOS DE DEPRECIACION' TO GMO-GLS-NCMP IN GMO
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GMO
               IF FIO-STAT-OKS
                   NEXT SENTENCE
               ELSE
                   MOVE 'GMO    PUT' TO MSG-COD-MENS
           ELSE
                   MOVE 'GDP    NEX' TO MSG-COD-MENS.
       FIN-ESC-GMO-GDP.
           EXIT.

       ESC-GMO-GSI SECTION.
       INI-ESC-GMO-GSI.
       FIN-ESC-GMO-GSI.
           EXIT.

       INI-GMO SECTION.
       INI-INI-GMO.
           MOVE SPACES TO GMO-GLS-FLAG IN GMO.
           MOVE SPACES TO GMO-FEC-FMOV IN GMO.
           MOVE SPACES TO GMO-HRA-HMOV IN GMO.
           MOVE SPACES TO GMO-CAI-GTIA IN GMO.
           MOVE SPACES TO GMO-IIC-GTIA IN GMO.
      *    MOVE ZEROES TO GMO-NUM-IMOV IN GMO.
           MOVE ZEROES TO GMO-NUM-TASN IN GMO.
           MOVE SPACES TO GMO-COD-CMPO IN GMO.
           MOVE SPACES TO GMO-IND-VALO IN GMO.
           MOVE SPACES TO GMO-IND-CLVE IN GMO.
           MOVE SPACES TO GMO-COD-CLVA IN GMO.
           MOVE SPACES TO GMO-GLS-CMPA IN GMO.
           MOVE ZEROES TO GMO-SGV-CMPA IN GMO.
           MOVE SPACES TO GMO-COD-NCLV IN GMO.
           MOVE SPACES TO GMO-GLS-NCMP IN GMO.
           MOVE ZEROES TO GMO-SGV-NCMP IN GMO.
           MOVE SPACES TO GMO-FEC-FING IN GMO.
           MOVE SPACES TO GMO-COD-TMOV IN GMO.
           MOVE SPACES TO GMO-GLS-DISP IN GMO.

           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO GMO-FEC-FMOV IN GMO.
           MOVE HOY-HHOY TO GMO-HRA-HMOV IN GMO.
      *FLB CST  13-OCT-1993
           MOVE VCG-OTRN TO GMO-TML-TMOV IN GMO.
           MOVE VCG-USER TO GMO-CIC-UING IN GMO.
      *FLB CST  13-OCT-1993
           MOVE HOY-FHOY TO GMO-FEC-FING IN GMO.
           MOVE GDG-CAI-GTIA IN GDG TO GMO-CAI-GTIA IN GMO.
           MOVE GDG-IIC-GTIA IN GDG TO GMO-IIC-GTIA IN GMO.
           MOVE GDG-COD-OFIC IN GDG TO GMO-COD-OFMV IN GMO.
           ADD 1 TO GMO-NUM-IMOV IN GMO.
           MOVE 'S' TO GMO-IND-VALO IN GMO.
           MOVE 'N' TO GMO-IND-CLVE IN GMO.
           MOVE SPACES TO GMO-COD-CLVA IN GMO.
           MOVE SPACES TO GMO-COD-NCLV IN GMO.
           MOVE ZEROES TO GMO-SGV-CMPA IN GMO.
           MOVE ZEROES TO GMO-SGV-NCMP IN GMO.
           MOVE SPACES TO GMO-GLS-CMPA IN GMO.
           MOVE SPACES TO GMO-GLS-NCMP IN GMO.
           MOVE '1' TO GMO-COD-MOVI IN GMO.
       FIN-INI-GMO.
           EXIT.

       COPY GARBFGAP.
       COPY GARBFGDD.
       COPY GARBFGDG.
       COPY GARBFGDO.
       COPY GARBFGDP.
       COPY GARBFGES.
       COPY GARBFGIN.
       COPY GARBFGLE.
       COPY GARBFGMO.
       COPY GARBFGSE.
       COPY GARBFGSI.
       COPY GARBFGTP.
       COPY GARBFGUB.
       COPY GARBFGVT.
       COPY GARBFTAG.
      *MHM-INI 29-JUL-2003
       COPY GARBFGVE.
       COPY GARBFGIM.
      *MHM-FIN 29-JUL-2003

       COPY GNSBGHOY.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

      *FLB CST  13-JUN-1994
       VAL-GDD SECTION.
       INI-VAL-GDD.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE GDG-CAI-GTIA IN GDG TO GDD-CAI-GTIA IN GDD.
           MOVE GDG-IIC-GTIA IN GDG TO GDD-IIC-GTIA IN GDD.
           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
                    GDG-CAI-GTIA IN GDG = GDD-CAI-GTIA IN GDD AND
                    GDG-IIC-GTIA IN GDG = GDD-IIC-GTIA IN GDD )
               MOVE 'GDD    NEX' TO MSG-COD-MENS
               GO TO BRW-VAL-GDD.
       LUP-VAL-GDD.
           IF GDD-IIC-DCLI IN GDD NOT > ZEROES OR
              GDD-IIC-DCLI IN GDD > '99999999'
               MOVE 'IICICLI=0' TO MSG-COD-MENS
                GO TO BRW-VAL-GDD.

           MOVE 'GDD-KEY-AGDD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
                    GDG-CAI-GTIA IN GDG = GDD-CAI-GTIA IN GDD AND
                    GDG-IIC-GTIA IN GDG = GDD-IIC-GTIA IN GDD )
               GO TO BRW-VAL-GDD.
           GO TO LUP-VAL-GDD.
       BRW-VAL-GDD.
           IF FIO-STAT-OKS
               MOVE 'GDD-KEY-AGDD' TO FIO-AKEY
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GDD.
       FIN-VAL-GDD.
           EXIT.
