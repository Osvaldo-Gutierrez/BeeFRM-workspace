*% FRM = 'GVE'
*% REG = 'GVE'
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF FIN_PUT_GVE_GVE
      *<<<< FIN_PUT_GVE_GVE
           IF GVE-COD-MAVE IN GVE-FLD = '99'
               MOVE GVE-GLS-MAVE IN GVE TO GVE-GLS-MAVE IN GVE-FLD.

*% IF FMT_CHI
      *<<<< FMT_CHI
*% IF NOT GEN_BCI
      *<<<< NOT GEN_BCI
      *BUS-TAB busca glosa de codigo en tabla
           IF GVE-COD-AGVE IN GVE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AGV ' TO TAB-COD-TTAB IN TAB
               MOVE GVE-COD-AGVE IN GVE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-AGVE IN GVE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AGVE IN GVE-FLD.
      *>>>>
*% END
      *>>>>
*% ELSE
           IF GVE-COD-AGVE IN GVE-FLD > SPACES
               MOVE 'AGT'                    TO IVB-COD-TTAB IN IVB
               MOVE GVE-COD-AGVE IN GVE-FLD  TO IVB-COD-EIVB IN IVB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-IVB
               IF NOT FIO-STAT-OKS
                   MOVE 'CODICCSNEX' TO MSG-COD-MENS
                   MOVE 'GAR' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-GLS-AGVE IN GVE-FLD
               ELSE
                   MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-AGVE IN GVE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AGVE IN GVE-FLD.
*% END
      *MHM-INI 29-JUL-2003
      *BUS-TAB busca glosa de codigo en tabla
           IF GVE-COD-MQEQ IN GVE-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'MEQ ' TO TAB-COD-TTAB IN TAB
               MOVE GVE-COD-MQEQ IN GVE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-MQEQ IN GVE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-MQEQ IN GVE-FLD.
      *MHM-FIN 29-JUL-2003
      *RRM-INI 4-OCT-2002
      *BUS-TAB busca glosa de codigo en tabla
           IF GVE-COD-TVEH IN GVE-FLD > SPACES
               MOVE "GAR" TO TAB-COD-SIST
               MOVE "TVH " TO TAB-COD-TTAB IN TAB
               MOVE GVE-COD-TVEH IN GVE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TVEH IN GVE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TVEH IN GVE-FLD.

      *RRM-INI 10-OCT-2002 YA NO SE VALIDA
      **BUS-TAB busca glosa de codigo en tabla
      *    IF GVE-COD-VEND IN GVE-FLD > SPACES
      *        MOVE "GAR" TO TAB-COD-SIST
      *        MOVE "VND " TO TAB-COD-TTAB IN TAB
      *        MOVE GVE-COD-VEND IN GVE-FLD TO TAB-COD-CTAB IN TAB
      *        PERFORM BUS-TAB
      *        MOVE TAB-GLS-DESC IN TAB TO
      *             FRM-GLS-VEND IN GVE-FLD
      *    ELSE
      *        MOVE SPACES TO FRM-GLS-VEND IN GVE-FLD.
      *RRM-FIN 10-OCT-2002
      *RRM-FIN 4-OCT-2002
      *MHM-INI 24-OCT-2003
      **BUS-TAB busca glosa de codigo en tabla
      *     IF GDG-TIP-CGTA IN GVE-FLD > SPACES
      *         MOVE 'TAB'                   TO TAB-COD-SIST
      *         MOVE 'AUX'                   TO TAB-COD-TTAB IN TAB
      *         MOVE GDG-TIP-CGTA IN GVE-FLD TO WSS-TIP-CGTA IN WSS-VARI
      *         MOVE GDG-STP-CGTA IN GVE-FLD TO WSS-STP-CGTA IN WSS-VARI
      *         MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB             
      *         MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-CGTA IN GVE-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GVE-FLD.
      *MHM-FIN 24-OCT-2003
      *MHM-INI 29-OCT-2003
           MOVE GVE-CIC-UING IN GVE TO CMA-CIC-UING IN CMA-VARI.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF FIN_PUT_GDG_GVE
      *<<<< FIN_PUT_GDG_GVE
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-CGTA IN GVE-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'AUX'                   TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-CGTA IN GVE-FLD TO WSS-TIP-CGTA IN WSS-VARI
               MOVE GDG-STP-CGTA IN GVE-FLD TO WSS-STP-CGTA IN WSS-VARI
               MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GVE-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GVE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GVE-FLD.
      *MHM-FIN 23-OCT-2003
      *>>>>
*% END
*% IF GVE_COD_MAVE
      *<<<< GVE_COD_MAVE
           IF GVE-COD-MAVE IN GVE-FLD = '99'
               GO TO FIN-VAL-GVE-COD-MAVE.
      *>>>>
*% END
*% IF INI_GVE_COD_MAVE
      *<<<< INI_GVE_COD_MAVE
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GVE-COD-MAVE IN GVE-FLD NOT > SPACES
               GO TO FIN-VAL-GVE-COD-MAVE.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF GVE_GLS_MAVE
      *<<<< GVE_GLS_MAVE
           IF GVE-COD-MAVE IN GVE-FLD = '99' AND
              GVE-GLS-MAVE IN GVE-FLD = SPACES
               MOVE 'GLSOBLIMRC' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVE-GLS-MAVE.
      *>>>>
*% END
*% IF INI_GVE_GLS_SUVE
      *<<<< INI_GVE_GLS_SUVE
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GVE-GLS-SUVE IN GVE-FLD NOT > SPACES
               GO TO FIN-VAL-GVE-GLS-SUVE.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF INI_GVE_GLS_PTTE
      *<<<< INI_GVE_GLS_PTTE
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GVE-GLS-PTTE IN GVE-FLD NOT > SPACES
               GO TO FIN-VAL-GVE-GLS-PTTE.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF INI_GVE_IND_PTTE
      *<<<< INI_GVE_IND_PTTE
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GVE-IND-PTTE IN GVE-FLD NOT > SPACES
               GO TO FIN-VAL-GVE-IND-PTTE.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF GVE_GLS_ADVE
      *<<<< GVE_GLS_ADVE
           IF FRM-COD-SINO IN GVE-FLD = 'S' AND
               GVE-GLS-ADVE IN GVE-FLD NOT > SPACES
               MOVE 'GLSADVEOBL' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVE-GLS-ADVE.
      *>>>>
*% END
*% IF GVE_COD_AGVE
      *<<<< GVE_COD_AGVE
*% IF FMT_CHI
      *<<<< FMT_CHI
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AGV ' TO TAB-COD-TTAB IN TAB.
           MOVE GVE-COD-AGVE IN GVE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = "COD    NEX" OR
              GVE-COD-AGVE IN GVE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AGVE IN GVE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-AGVE IN GVE-FLD.
      *>>>>
*% ELSE
           MOVE GVE-COD-AGVE IN GVE-FLD  TO WSS-COD-AGVE IN WSS-VARI.
           MOVE 'AGT'                    TO IVB-COD-TTAB IN IVB.
           MOVE WSS-COD-AGEN IN WSS-VARI TO IVB-COD-EIVB IN IVB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-IVB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODAGENNEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVE-COD-AGVE
           ELSE
               IF IVB-IND-VIGE IN IVB NOT = 'S'
                  MOVE 'COD    NVG' TO MSG-COD-MENS
                  MOVE 'GNS' TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                  MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-AGVE IN GVE-FLD.
*% END
      *>>>>
*% END
*% IF INI_GVE_FEC_FVEN
      *<<<< INI_GVE_FEC_FVEN
           MOVE FEC-VHBL-N  TO FEC-VHBL.
      *>>>>
*% END
*% IF GVE_COD_TVEH 
      *<<<< GVE_COD_TVEH 
      *RRM-INI 4-OCT-2002
           IF GVE-COD-TVEH IN GVE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TVEH IN GVE-FLD
               GO TO FIN-VAL-GVE-COD-TVEH.

      *VAL-COD Valida codigo de tabla
           MOVE "GAR" TO TAB-COD-SIST.
           MOVE "TVH " TO TAB-COD-TTAB IN TAB.
           MOVE GVE-COD-TVEH IN GVE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = "COD    NEX" OR
              GVE-COD-TVEH IN GVE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TVEH IN GVE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TVEH IN GVE-FLD.
      *RRM-FIN 4-OCT-2002
      *>>>>
*% END
*% IF GVE_COD_VEND
      *<<<< GVE_COD_VEND 
      *RRM-INI 10-OCT-2002 YA NO SE VALIDA NI SE OBTIENE GLOSA
      *
      **RRM-INI 4-OCT-2002
      *     IF GVE-COD-VEND IN GVE-FLD NOT > SPACES
      *        MOVE SPACES TO FRM-GLS-VEND IN GVE-FLD
      *        GO TO FIN-VAL-GVE-COD-VEND.
      *
      **VAL-COD Valida codigo de tabla
      *     MOVE "GAR" TO TAB-COD-SIST.
      *     MOVE "VND " TO TAB-COD-TTAB IN TAB.
      *     MOVE GVE-COD-VEND IN GVE-FLD TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *     IF MSG-COD-MENS = "COD    NEX" OR
      *        GVE-COD-VEND IN GVE-FLD NOT > SPACES
      *         MOVE SPACES TO FRM-GLS-VEND IN GVE-FLD
      *     ELSE
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-VEND IN GVE-FLD.
      **RRM-FIN 4-OCT-2002
      *
      *RRM-FIN 10-OCT-2002
      *>>>>
*% END
*% IF GVE_COD_MQEQ
      *<<<< GVE_COD_MQEQ
           MOVE GDG-TIP-CGTA IN GVE-FLD TO TAG-COD-TOPE IN TAG.
           MOVE GDG-STP-CGTA IN GVE-FLD TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO GVE-COD-MQEQ IN GVE-FLD                
               MOVE SPACES TO FRM-GLS-MQEQ IN GVE-FLD                
               GO TO FIN-VAL-GVE-COD-MQEQ.   

           IF TAG-IND-TPRE IN TAG = 'N' OR                      
              TAG-IND-TPRE IN TAG = 'C'                         
               MOVE SPACES TO GVE-COD-MQEQ IN GVE-FLD                
               MOVE SPACES TO FRM-GLS-MQEQ IN GVE-FLD                
               GO TO FIN-VAL-GVE-COD-MQEQ.   

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'MEQ ' TO TAB-COD-TTAB IN TAB.
           MOVE GVE-COD-MQEQ IN GVE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GVE-COD-MQEQ IN GVE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-MQEQ IN GVE-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-MQEQ IN GVE-FLD.
      *>>>>
*% END
