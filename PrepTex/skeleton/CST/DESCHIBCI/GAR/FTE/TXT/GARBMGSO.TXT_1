*% IF FIN_UNP_GSO_GSO
      *<<<< FIN_UNP_GSO_GSO
           IF SCR-CMND = 'AEG'
              MOVE FRM-CPIM-AEY TO GSO-COD-EST2-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-COD-RSEG-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-IND-PCUO-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-NUM-CUOT-ATR IN GSO-FLD
              GO TO FIN-UNP-GSO-GSO.
              
           IF SCR-CMND = 'AEJ'
              MOVE FRM-CPIM-AEY TO GSO-COD-ESGA-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-COD-RSEG-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-IND-PCUO-ATR IN GSO-FLD
              MOVE FRM-CPIM-AEY TO GSO-NUM-CUOT-ATR IN GSO-FLD
              GO TO FIN-UNP-GSO-GSO.
      *>>>>
*% END
*% IF INI_FST_FLD_GSO
      *<<<< INI_FST_FLD_GSO
      *PVG INI 14-PCT-2003
           IF SCR-CMND = 'ING'
              MOVE FRM-POS-CURS TO GSO-COD-RSEG-LEN IN GSO-FLD
           ELSE
           IF SCR-CMND = 'AEJ'
              MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD
           ELSE
      *PVG FIN 14-PCT-2003
      *>>>>
*% END
*% IF GSO_NUM_SBGL
      *<<<< GSO_NUM_SBGL
      *CGL-FIN  12-SEP-2003 11:40:12 
            IF SCR-CMND NOT = 'CON'
               IF GSO-NUM-SBGL IN GSO-FLD NOT > ZEROES
                  MOVE FRM-POS-CURS TO GSO-NUM-SBGL-LEN IN GSO-FLD
                  MOVE 'GAR'          TO MSG-COD-SIST
                  MOVE 'GSO CORRNE'  TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GSO-NUM-SBGL.
      *CGL-FIN  12-SEP-2003 11:40:05 
      *>>>>
*% END
*% IF GSO_IND_PCUO
      *<<<< GSO_IND_PCUO
      *CGL-INI  8-SEP-2003 19:07:43 
            IF GSO-IND-PCUO IN GSO-FLD NOT > SPACES
      *PVG INI 14-OCT-2003
      *        IF GSO-COD-RSEG IN GSO-FLD = '01'
               IF GSO-COD-RSEG IN GSO-FLD = '1'
      *PVG FIN 14-OCT-2003
                  MOVE SPACES TO FRM-GLS-PCUO IN GSO-FLD
                  MOVE 'GAR'          TO MSG-COD-SIST
                  MOVE 'GSO INDOBLI'  TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE FRM-POS-CURS TO GSO-IND-PCUO-LEN IN GSO-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GSO-IND-PCUO
               ELSE
                  MOVE SPACES TO FRM-GLS-PCUO IN GSO-FLD.

           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB. 
           MOVE GSO-IND-PCUO IN GSO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.   
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES TO FRM-GLS-PCUO IN GSO-FLD 
              PERFORM GET-MSG
              MOVE FRM-POS-CURS TO GSO-IND-PCUO-LEN IN GSO-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GSO-IND-PCUO
            ELSE 
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-PCUO IN GSO-FLD. 
      *CGL-FIN  8-SEP-2003 19:16:37  
      *>>>>
*% END
*% IF GSO_NUM_CUOT
      *<<<< GSO_NUM_CUOT
      *PVG INI 14-OCT-2003
           IF GSO-IND-PCUO IN GSO-FLD = 'N'
              MOVE ZEROES TO GSO-NUM-CUOT IN GSO-FLD.
           IF GSO-IND-PCUO IN GSO-FLD = 'S' AND
              GSO-NUM-CUOT IN GSO-FLD NOT > ZEROES
              MOVE 'GAR'          TO MSG-COD-SIST
              MOVE 'GSO NCUOOBLI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE FRM-POS-CURS TO GSO-NUM-CUOT-LEN IN GSO-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *PVG FIN 14-OCT-2003
      *>>>>
*% END
*% IF GSO_COD_RSEG
      *<<<< GSO_COD_RSEG
      *CGL-INI  8-SEP-2003 18:37:16 
            IF GSO-COD-RSEG IN GSO-FLD NOT > SPACES
               MOVE GDG-COD-TOPE IN GDG TO TAG-COD-TOPE IN TAG
               MOVE GDG-COD-SOPE IN GDG TO TAG-COD-SOPE IN TAG
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-TAG
               IF NOT FIO-STAT-OKS
                  MOVE SPACES TO FRM-GLS-RSEG IN GSO-FLD
                  MOVE 'GAR'          TO MSG-COD-SIST
                  MOVE 'GSO TAGNEXI' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE FRM-POS-CURS TO GSO-COD-RSEG-LEN IN GSO-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GSO-COD-RSEG
               ELSE
               IF TAG-IND-EGSE IN TAG = 'S'
                  MOVE 'GAR'          TO MSG-COD-SIST
                  MOVE 'GSO INDOBLI' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE FRM-POS-CURS TO GSO-COD-RSEG-LEN IN GSO-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GSO-COD-RSEG
               ELSE
                  MOVE SPACES TO FRM-GLS-RSEG IN GSO-FLD
                  GO TO FIN-VAL-GSO-COD-RSEG. 

      *VAL-COD Valida codigo de tabla                   
           MOVE 'GAR' TO TAB-COD-SIST.             
           MOVE 'RPB ' TO TAB-COD-TTAB IN TAB.     
           MOVE GSO-COD-RSEG IN GSO-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.                                        
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES TO FRM-GLS-RSEG IN GSO-FLD 
              PERFORM GET-MSG
              MOVE FRM-POS-CURS TO GSO-COD-RSEG-LEN IN GSO-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GSO-COD-RSEG
            ELSE 
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-RSEG IN GSO-FLD.    
      *CGL-FIN  8-SEP-2003 18:44:55 
      *>>>>
*% END
*% IF FIN_PUT_GSO_GSO 
      *<<<< FIN_PUT_GSO_GSO 
      *PVG INI 14-OCT-2003
           IF GSO-IND-PCUO IN GSO-FLD > SPACES
              MOVE 'GAR' TO TAB-COD-SIST
              MOVE 'SIN ' TO TAB-COD-TTAB IN TAB
              MOVE GSO-IND-PCUO IN GSO-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB 
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-PCUO IN GSO-FLD.
      *PVG FIN 14-OCT-2003

      *CGL-INI  7-SEP-2003 15:31:13 
           MOVE GSO-CAI-GTIA IN GSO-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GSO-IIC-GTIA IN GSO-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

      *PVG INI 14-OCT-2003
           MOVE SPACES                 TO FRM-GLS-CLAS IN GSO-FLD.
           MOVE SPACES                 TO FRM-GLS-TPOL IN GSO-FLD.

           MOVE GDG-COD-TOPE IN GDG    TO TAG-COD-TOPE IN TAG.
           MOVE GDG-COD-SOPE IN GDG    TO TAG-COD-SOPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
              GO TO CON-PUT-GSO-GSO.

           IF TAG-COD-CLAS IN TAG > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'CLA'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-CLAS IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-CLAS IN GSO-FLD.

           IF TAG-COD-TPOL IN TAG > SPACES
              MOVE 'GAR'               TO TAB-COD-SIST
              MOVE 'POL'               TO TAB-COD-TTAB IN TAB
              MOVE TAG-COD-TPOL IN TAG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TPOL IN GSO-FLD.
       CON-PUT-GSO-GSO.
      *PVG FIN 14-OCT-2003
           
           MOVE 'TAB'  TO TAB-COD-SIST                 
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB         
           MOVE GDG-COD-TOPE IN GDG TO TAB-COD-CTAB IN TAB 
           PERFORM BUS-TAB                                    
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOPE IN GSO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOPE IN GSO-FLD.

      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.

           MOVE GDG-COD-TOPE IN GDG TO WSS-COD-TOPE IN WSS-VARI.
           MOVE GDG-COD-SOPE IN GDG TO WSS-COD-SOPE IN WSS-VARI.
           MOVE WSS-TSG-OPE IN WSS-VARI  TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SOPE IN GSO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-SOPE IN GSO-FLD.
      *CGL-FIN  7-SEP-2003 15:15:16 
       CONTINUA-NOMC.
      *Busca nombre del cliente.
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-NUM-SBGL IN GSL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSL.
           IF NOT FIO-STAT-OKS
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'SOL  NOEXI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
              GO TO CONTINUA-USR.
       
           MOVE GSL-CIC-DCLI IN GSL TO DBC-CIC-ICLI IN DBC.
           MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
              MOVE '00' TO PGM-STAT-DBC
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN            TO DBC-GLS-NOMC IN GSO-FLD
           ELSE
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
              GO TO CONTINUA-USR.
       

       CONTINUA-USR.
      *Nombre de ejecutivo.
           IF GSO-COD-USER IN GSO > SPACES                      
               MOVE GSO-COD-USER IN GSO TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-USER IN GSO-FLD  
           ELSE                                                     
               MOVE SPACES              TO GSO-COD-USER IN GSO-FLD
               MOVE SPACES              TO FRM-GLS-USER IN GSO-FLD. 

       CONTINUA-EST1.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-IND-EST1 IN GDG > SPACES
             MOVE 'GAR' TO TAB-COD-SIST
             MOVE 'ES1'                TO TAB-COD-TTAB IN TAB
             MOVE GDG-IND-EST1 IN GDG  TO TAB-COD-CTAB IN TAB
             PERFORM BUS-TAB
             MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EST1 IN GSO-FLD.

       CONTINUA-ESGA.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSO-COD-ESGA IN GSO > SPACES
               MOVE 'GAR'  TO TAB-COD-SIST
               MOVE 'EGS ' TO TAB-COD-TTAB IN TAB
               MOVE GSO-COD-ESGA IN GSO TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESGA IN GSO-FLD.

       CONTINUA-EST2.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSO-COD-EST2 IN GSO > SPACES
              MOVE 'GAR'  TO TAB-COD-SIST
              MOVE 'ET2 ' TO TAB-COD-TTAB IN TAB
              MOVE GSO-COD-EST2 IN GSO TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-EST2 IN GSO-FLD.

       CONTINUA-FEC.
           IF SCR-CMND NOT = 'ING' AND
              SCR-CMND NOT = 'AEG' AND
      *CGL-INI  11-SEP-2003 12:14:25  
              SCR-CMND NOT = 'AEJ'
              MOVE GSO-NUM-DSO2 IN GSO TO WSS-NUM-DEDII IN WSS-VARI
              MOVE GSO-NUM-MSO2 IN GSO TO WSS-NUM-MEDII IN WSS-VARI
              MOVE GSO-NUM-SSO2 IN GSO TO WSS-NUM-SEDII IN WSS-VARI
              MOVE GSO-NUM-ASO2 IN GSO TO WSS-NUM-AEDII IN WSS-VARI
              MOVE WSS-FEC-EDII IN WSS-VARI TO FRM-FEC-ESO2 IN GSO-FLD
      *CGL-FIN  11-SEP-2003 12:14:32 
              MOVE GSO-NUM-DSOL IN GSO TO WSS-NUM-DEDIT IN WSS-VARI
              MOVE GSO-NUM-MSOL IN GSO TO WSS-NUM-MEDIT IN WSS-VARI
              MOVE GSO-NUM-SSOL IN GSO TO WSS-NUM-SEDIT IN WSS-VARI
              MOVE GSO-NUM-ASOL IN GSO TO WSS-NUM-AEDIT IN WSS-VARI
              MOVE WSS-FEC-EDIT IN WSS-VARI TO FRM-FEC-ESGA IN GSO-FLD.

              IF GSO-COD-RSEG IN GSO-FLD > SPACES
                 MOVE 'GAR' TO TAB-COD-SIST
                 MOVE 'RPB ' TO TAB-COD-TTAB IN TAB
                 MOVE GSO-COD-RSEG IN GSO-FLD TO TAB-COD-CTAB IN TAB
                 PERFORM BUS-TAB
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-RSEG IN GSO-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_GSO
      *<<<< FIN_PUT_DBC_GSO
      *PVG INI 14-OCT-2003
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN GSO-FLD.
      *PVG INI 14-OCT-2003
      *>>>>
*% END
*% IF GSO_COD_ESGA
      *<<<< GSO_COD_ESGA
           IF SCR-CMND NOT = 'AEG' 
                GO TO OBT-GLS-ESGA.

           MOVE 'GAR'  TO TAB-COD-SIST. 
           MOVE 'EGS ' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSO-COD-ESGA IN GSO-FLD TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               GO TO VAL-CORR-ORDEN
           ELSE
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GSO ESTNOVAL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE FRM-POS-CURS TO GSO-COD-ESGA-LEN IN GSO-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSO-COD-ESGA.

       VAL-CORR-ORDEN.                 
           
           IF GSO-COD-ESGA IN GSO-FLD     = '02' AND 
              SCR-COD-GSO-ANT IN SCR-VARI = '01'
               GO TO OBT-GLS-ESGA.

           IF GSO-COD-ESGA IN GSO-FLD     = '03' AND 
              SCR-COD-GSO-ANT IN SCR-VARI = '02'
              IF SCR-COD-TPRO IN SCR-VARI = 'S'
                 MOVE '02' TO GSO-COD-EST2 IN GSO-FLD
                 GO TO OBT-GLS-ESGA
              ELSE
                 GO TO OBT-GLS-ESGA.   

           IF GSO-COD-ESGA IN GSO-FLD     = '06' 
              IF SCR-COD-TPRO IN SCR-VARI = 'S'
                 IF SCR-COD-GSO-ANT IN SCR-VARI = '03'
                    GO TO OBT-GLS-ESGA
                 ELSE  
                    GO TO ERROR-EN-ORDEN
              ELSE
              IF SCR-COD-GSO-ANT IN SCR-VARI = '03' AND
                 SCR-COD-JUD-ANT IN SCR-VARI = '05'
                 GO TO OBT-GLS-ESGA
              ELSE
                 GO TO ERROR-EN-ORDEN.

           IF  GSO-COD-ESGA IN GSO-FLD     = '07' AND 
             ( SCR-COD-GSO-ANT IN SCR-VARI = '06' OR
               SCR-COD-GSO-ANT IN SCR-VARI = '11')
               GO TO OBT-GLS-ESGA.

      *MHM-INI 01-DIC-2003
      *     IF GSO-COD-ESGA IN GSO-FLD     = '10' AND 
      *        SCR-COD-GSO-ANT IN SCR-VARI = '07'
      *         GO TO OBT-GLS-ESGA.
      *MHM-FIN 01-DIC-2003

           IF GSO-COD-ESGA IN GSO-FLD = '11'    AND
              SCR-COD-GSO-ANT IN SCR-VARI  = '06' 
                GO TO OBT-GLS-ESGA.

           IF GSO-COD-ESGA IN GSO-FLD = '12'    AND
              SCR-COD-GSO-ANT IN SCR-VARI NOT = '10' 
              GO TO OBT-GLS-ESGA.


       ERROR-EN-ORDEN.
           MOVE SPACES TO FRM-GLS-ESGA IN GSO-FLD.
           MOVE 'GAR'          TO MSG-COD-SIST.
           MOVE 'GSOEST NOVAL' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE FRM-POS-CURS TO GSO-COD-ESGA-LEN IN GSO-FLD.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-GSO-COD-ESGA.

       OBT-GLS-ESGA.
      *PVG INI 15-OCT-2003
           IF GSO-COD-ESGA IN GSO-FLD     = '03'
              MOVE GSO-CAI-GTIA IN GSO-FLD TO GVT-CAI-GTIA IN GVT 
              MOVE GSO-IIC-GTIA IN GSO-FLD TO GVT-IIC-GTIA IN GVT 
              MOVE ZEROES                  TO GVT-COD-TASN IN GVT 
              MOVE FIO-GET-NLS             TO FIO-CMND
              PERFORM GAR-FIO-GVT 
              IF NOT (FIO-STAT-OKS AND
                      GVT-CAI-GTIA IN GVT = GSO-CAI-GTIA IN GSO-FLD AND
                      GVT-IIC-GTIA IN GVT = GSO-IIC-GTIA IN GSO-FLD )
                 MOVE SPACES         TO FRM-GLS-ESGA IN GSO-FLD
                 MOVE 'GAR'          TO MSG-COD-SIST
                 MOVE 'GSOGVT   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE FRM-POS-CURS TO GSO-COD-ESGA-LEN IN GSO-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GSO-COD-ESGA.
           IF GSO-COD-ESGA IN GSO-FLD     = '07'
              MOVE GSO-CAI-GTIA IN GSO-FLD TO GSE-CAI-GTIA IN GSE 
              MOVE GSO-IIC-GTIA IN GSO-FLD TO GSE-IIC-GTIA IN GSE 
              MOVE ZEROES                  TO GSE-NUM-IGSE IN GSE 
              MOVE FIO-GET-NLS             TO FIO-CMND 
              PERFORM GAR-FIO-GSE 
              IF NOT (FIO-STAT-OKS AND
                      GSE-CAI-GTIA IN GSE = GSO-CAI-GTIA IN GSO-FLD AND
                      GSE-IIC-GTIA IN GSE = GSO-IIC-GTIA IN GSO-FLD )
                 MOVE SPACES         TO FRM-GLS-ESGA IN GSO-FLD
                 MOVE 'GAR'          TO MSG-COD-SIST
                 MOVE 'GSOGSE   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE FRM-POS-CURS TO GSO-COD-ESGA-LEN IN GSO-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GSO-COD-ESGA.

           IF GSO-COD-ESGA IN GSO-FLD > SPACES
              MOVE 'GAR'                   TO TAB-COD-SIST
              MOVE 'EGS '                  TO TAB-COD-TTAB IN TAB
              MOVE GSO-COD-ESGA IN GSO-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ESGA IN GSO-FLD.
      *PVG FIN 15-OCT-2003
      *>>>>
*% END
*% IF GSO_COD_EST2
      *<<<< GSO_COD_EST2
      *CGL-FIN  11-SEP-2003 12:22:53 
           IF SCR-CMND NOT = 'AEJ' 
                GO TO OBT-GLS-EST2.

           MOVE 'GAR'  TO TAB-COD-SIST. 
           MOVE 'ET2 ' TO TAB-COD-TTAB IN TAB.                   
           MOVE GSO-COD-EST2 IN GSO-FLD TO TAB-COD-CTAB IN TAB.  
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               GO TO VAL-CORR-ORDEN-1
           ELSE
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GSO ESTNOVAL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GSO-COD-EST2.

       VAL-CORR-ORDEN-1.                 
           
           IF GSO-COD-EST2 IN GSO-FLD     = '03' AND 
              SCR-COD-JUD-ANT IN SCR-VARI = '02'
               GO TO OBT-GLS-EST2.

           IF GSO-COD-EST2 IN GSO-FLD     = '04' AND 
              SCR-COD-JUD-ANT IN SCR-VARI = '03'
                 GO TO OBT-GLS-EST2.

           IF GSO-COD-EST2 IN GSO-FLD     = '05' AND
              SCR-COD-JUD-ANT IN SCR-VARI = '04'
              GO TO OBT-GLS-EST2.

       ERROR-EN-ORDEN-1.
           MOVE SPACES TO FRM-GLS-EST2 IN GSO-FLD.
           MOVE 'GAR'          TO MSG-COD-SIST.
           MOVE 'GSOEST NOVAL' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-GSO-COD-EST2.

       OBT-GLS-EST2.
      *PVG INI 15-OCT-2003
           IF GSO-COD-EST2 IN GSO-FLD     = '03'
              MOVE GSO-CAI-GTIA IN GSO-FLD TO GAP-CAI-GTIA IN GAP 
              MOVE GSO-IIC-GTIA IN GSO-FLD TO GAP-IIC-GTIA IN GAP 
              MOVE ZEROES                  TO GAP-COD-PACR IN GAP 
              MOVE FIO-GET-NLS             TO FIO-CMND 
              PERFORM GAR-FIO-GAP 
              IF NOT (FIO-STAT-OKS AND
                      GAP-CAI-GTIA IN GAP = GSO-CAI-GTIA IN GSO-FLD AND
                      GAP-IIC-GTIA IN GAP = GSO-IIC-GTIA IN GSO-FLD )
                 MOVE SPACES         TO FRM-GLS-ESGA IN GSO-FLD
                 MOVE 'GAR'          TO MSG-COD-SIST
                 MOVE 'GSOGAP   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GSO-COD-EST2.
           IF GSO-COD-EST2 IN GSO-FLD     = '04' OR '05'
              MOVE GSO-CAI-GTIA IN GSO-FLD TO GLE-CAI-GTIA IN GLE 
              MOVE GSO-IIC-GTIA IN GSO-FLD TO GLE-IIC-GTIA IN GLE 
              MOVE SPACES                  TO GLE-COD-PACR IN GLE 
              MOVE FIO-GET-NLS             TO FIO-CMND 
              PERFORM GAR-FIO-GLE 
              IF NOT (FIO-STAT-OKS AND
                      GLE-CAI-GTIA IN GLE = GSO-CAI-GTIA IN GSO-FLD AND
                      GLE-IIC-GTIA IN GLE = GSO-IIC-GTIA IN GSO-FLD )
                 MOVE SPACES         TO FRM-GLS-ESGA IN GSO-FLD
                 MOVE 'GAR'          TO MSG-COD-SIST
                 MOVE 'GSOGLE   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE FRM-POS-CURS TO GSO-COD-EST2-LEN IN GSO-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-GSO-COD-EST2.

           IF GSO-COD-EST2 IN GSO-FLD > SPACES
              MOVE 'GAR'  TO TAB-COD-SIST
              MOVE 'ET2 ' TO TAB-COD-TTAB IN TAB
              MOVE GSO-COD-EST2 IN GSO-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-EST2 IN GSO-FLD.
      *PVG FIN 15-OCT-2003
      *CGL-FIN  11-SEP-2003 12:22:44 
      *>>>>
*% END
*% IF DBC_GLS_NOMC
      *<<<< DBC_GLS_NOMC
      *Busca nombre del cliente.
           MOVE GSO-NUM-SBGL IN GSO-FLD TO GSL-NUM-SBGL IN GSL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSL.
           IF NOT FIO-STAT-OKS
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'SOL  NOEXI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
              GO TO FIN-VAL-DBC-GLS-NOMC.
 
           MOVE GSL-CIC-DCLI IN GSL TO DBC-CIC-ICLI IN DBC.
           MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
              MOVE '00' TO PGM-STAT-DBC
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                    PERFORM CPT-BLKS
              MOVE CPT-STRN            TO DBC-GLS-NOMC IN GSO-FLD
           ELSE
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GSO-FLD
              GO TO FIN-VAL-DBC-GLS-NOMC.
      *>>>>
*% END
*% IF FRM_GLS_EST1 
      *<<<< FRM_GLS_EST1 
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-IND-EST1 IN GDG > SPACES
             MOVE 'GAR' TO TAB-COD-SIST
             MOVE 'ES1'                TO TAB-COD-TTAB IN TAB
             MOVE GDG-IND-EST1 IN GDG  TO TAB-COD-CTAB IN TAB
             PERFORM BUS-TAB
             MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EST1 IN GSO-FLD.
      *>>>>
*% END
*% IF FRM_FEC_ESGA
      *<<<< FRM_FEC_ESGA
           IF SCR-CMND = 'ING' OR 'AEG'
              GO TO FIN-VAL-FRM-FEC-ESGA.
           MOVE GSO-NUM-DSOL IN GSO TO WSS-NUM-DEDIT IN WSS-VARI.
           MOVE GSO-NUM-MSOL IN GSO TO WSS-NUM-MEDIT IN WSS-VARI.
           MOVE GSO-NUM-SSOL IN GSO TO WSS-NUM-SEDIT IN WSS-VARI.
           MOVE GSO-NUM-ASOL IN GSO TO WSS-NUM-AEDIT IN WSS-VARI.
           MOVE WSS-FEC-EDIT IN WSS-VARI TO 
                FRM-FEC-ESGA IN GSO-FLD.
      *>>>>
*% END
*% IF FRM_FEC_ESO2
      *<<<< FRM_FEC_ESO2
           IF SCR-CMND = 'ING' OR 'AEJ'
              GO TO FIN-VAL-FRM-FEC-ESO2.
           MOVE GSO-NUM-DSO2 IN GSO TO WSS-NUM-DEDII IN WSS-VARI.
           MOVE GSO-NUM-MSO2 IN GSO TO WSS-NUM-MEDII IN WSS-VARI.
           MOVE GSO-NUM-SSO2 IN GSO TO WSS-NUM-SEDII IN WSS-VARI.
           MOVE GSO-NUM-ASO2 IN GSO TO WSS-NUM-AEDII IN WSS-VARI.
           MOVE WSS-FEC-EDII IN WSS-VARI TO 
                FRM-FEC-ESO2 IN GSO-FLD.
      *>>>>
*% END
*% IF GSO_COD_USER
      *<<<< GSO_COD_USER
           IF GSO-COD-USER IN GSO-FLD NOT > SPACES
               MOVE SPACES TO GSO-COD-USER IN GSO-FLD.
      *>>>>
*% END
