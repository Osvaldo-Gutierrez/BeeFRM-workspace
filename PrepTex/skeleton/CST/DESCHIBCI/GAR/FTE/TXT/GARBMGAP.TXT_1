*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF GAP_IND_MACR
           IF ( GAP-IND-MACR IN GAP-FLD NOT > SPACES)
                MOVE SPACES TO GAP-IND-MACR IN GAP-FLD.

      *VAL-IND Valida miscelaneo de tabla
           MOVE 'GAR' TO MSC-COD-SIST.
           MOVE 'MACR' TO MSC-COD-TMSC IN MSC.
           MOVE GAP-IND-MACR IN GAP-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GAP-IND-MACR IN GAP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-MACR IN GAP-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-MACR IN GAP-FLD.
*% END
*% IF INI_RET_GAP_GAP
           MOVE CNE-GAP-CAI-ICLI  TO GAP-CAI-ICLI IN GAP.
           MOVE CNE-GAP-IIC-ICLI  TO GAP-IIC-ICLI IN GAP.
           MOVE CNE-GAP-GLS-NOMA  TO GAP-GLS-NOMA IN GAP.
*% END
*% IF FIN_PUT_GDG_GAP
           MOVE GDG-COD-GGTA IN GDG TO GAR-COD-GGTA IN CMA-VARI.
      *MHM-INI 23-OCT-2003
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-CGTA IN GAP-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'AUX'                   TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-CGTA IN GAP-FLD TO WSS-COD-TOPE IN WSS-VARI
               MOVE GDG-STP-CGTA IN GAP-FLD TO WSS-COD-SOPE IN WSS-VARI
               MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GAP-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GAP-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GAP-FLD.
      *MHM-FIN 23-OCT-2003
*% END
*% IF FIN_PUT_GAP_GAP
      *<<<< FIN_PUT_GAP_GAP
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF GAP-IND-MACR IN GAP-FLD > SPACES
               MOVE 'GAR' TO MSC-COD-SIST
               MOVE 'MACR' TO MSC-COD-TMSC IN MSC
               MOVE GAP-IND-MACR IN GAP-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-MACR IN GAP-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-MACR IN GAP-FLD.
*% IF FMT_CHI
      *<<<<
      *     MOVE GAP-CIC-ICLI IN GAP TO WSS-IDC-ICLI IN WSS-VARI.
      *     MOVE WSS-NUM-ICLI IN WSS-VARI TO DBC-NUM-ICLI IN GAP-FLD.
      *     MOVE WSS-IND-ICLI IN WSS-VARI TO DBC-VRF-ICLI IN GAP-FLD.
      *     MOVE WSS-GLS-ICLI IN WSS-VARI TO DBC-GLS-ICLI IN GAP-FLD.

           IF GAP-IND-ESBA IN GAP  = 'S'
               MOVE 'GAR'     TO TAB-COD-SIST
               MOVE 'IDC '    TO TAB-COD-TTAB IN TAB
               MOVE 'IDCBCO'  TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-IDC-ICLI IN WSS-VARI
               MOVE WSS-NUM-ICLI IN WSS-VARI TO DBC-NUM-ICLI IN GAP-FLD
               MOVE WSS-IND-ICLI IN WSS-VARI TO DBC-IND-ICLI IN GAP-FLD
               MOVE WSS-GLS-ICLI IN WSS-VARI TO DBC-GLS-ICLI IN GAP-FLD
               MOVE TAB-COD-DAT1 IN TAB(1)   TO DBC-VRF-ICLI IN GAP-FLD
*% IF GEN_BCI
      *<<<< GEN_BCI
               PERFORM VAL-NUM-ICLI
      *>>>>
*% END
           ELSE
               MOVE GAP-CIC-ICLI IN GAP TO DBC-CIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY
               MOVE FIO-GET-KEY     TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN GAP-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GAP-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN GAP-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN GAP-FLD.

      *MHM-INI 24-OCT-2003
      **BUS-TAB busca glosa de codigo en tabla
      *     IF GDG-STP-CGTA IN GAP-FLD > SPACES
      *         MOVE 'TAB'  TO TAB-COD-SIST
      *         MOVE 'AUX ' TO TAB-COD-TTAB IN TAB
      *         MOVE GDG-TIP-CGTA IN GAP-FLD TO WSS-COD-TOPE IN WSS-VARI
      *         MOVE GDG-STP-CGTA IN GAP-FLD TO WSS-COD-SOPE IN WSS-VARI
      *         MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GAP-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GAP-FLD.
      *MHM-FIN 24-OCT-2003

      *>>>>
*% ELSE
           MOVE GAP-CIC-ICLI IN GAP TO DBC-IDC-ICLI IN GAP-FLD.
*% END
           MOVE GAP-GLS-NOMA IN GAP TO DBC-GLS-NOMC IN GAP-FLD.
      *>>>>
*% END
*% IF FIN_UNP_IKY_GAP 
      *<<<< FIN_UNP_IKY_GAP 
      *MHM-INI 30-SEP-2003
      **RRM-INI 26-SEP-2002
      *     IF SCR-CCPP = "ING"
      *         MOVE FRM-CPIM-AEY TO GAP-COD-PACR-ATR IN GAP-FLD
      *         MOVE FRM-CPIM-AEY TO GAP-COD-PACR-STP.
      **RRM-FIN 16-APR-2002
      *MHM-FIN 30-SEP-2003
      *>>>>
*% END
*% IF  FIN_UNP_GAP_GAP
      *<<<< FIN_UNP_GAP_GAP
           IF SCR-CCPP = 'ING'
              MOVE FRM-CPIM-AEY TO GAP-IND-MASC-STP
              MOVE FRM-CPIM-AEY TO GAP-IND-MASC-ATR IN GAP-FLD
              MOVE 'S' TO GAP-IND-MASC IN GAP-FLD.
*% END
*% IF INI_PUT_DBC_GAP
      *<<<< INI_PUT_DBC_GAP
      
           IF  GAP-IND-ESBA IN GAP-FLD  = 'S'
               GO TO FIN-PUT-DBC-GAP.
      *      
           IF  GAP-IND-ESBA IN GAP-FLD  = 'N' AND
               GAP-IND-ESCL IN GAP-FLD = 'N'
               GO TO FIN-PUT-DBC-GAP.
      *
*% IF FMT_CHI
      *<<<<
           IF  GAP-IND-ESCL IN GAP-FLD  = 'S'
               GO TO FIN-PUT-DBC-GAP.

      *>>>>
*% END
           MOVE GAP-CIC-ICLI IN GAP TO DBC-CIC-ICLI IN DBC.
           MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *>>>>
*% END
*% IF FIN_FST_KEY_GAP
      *<<<< FIN_FST_KEY_GAP
      *MHM-INI 30-SEP-2003
      *     IF SCR-CCPP = 'ING'
      *         MOVE FRM-CPIM-AEY TO GAP-COD-PACR-ATR IN GAP-FLD
      *         MOVE FRM-CPIM-AEY TO GAP-COD-PACR-STP.
      *MHM-FIN 30-SEP-2003
      *>>>>
*% END
*% IF GAP_COD_PACR
      *<<<< GAP_COD_PACR
           IF GAP-COD-PACR IN GAP-FLD NOT > ZEROES
               PERFORM BUS-COR-GAP.

           IF GAP-COD-PACR IN GAP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GAP-COD-PACR.
           
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
*% IF NOT PGM_MEX
      *<<<< NOT PGM_MEX
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-DBC-VRF-ICLI.
*% IF GEN_BCI
      *<<<<
           IF GAP-IND-ESBA IN GAP-FLD = 'N' AND
              GAP-IND-ESCL IN GAP-FLD = 'N'
               GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
*% END
           MOVE DBC-NUM-ICLI IN GAP-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GAP-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GAP-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DBC-VRF-ICLI.

           PERFORM VAL-ACR-GDD.
           IF MSG-COD-MENS > SPACES
               MOVE 'GAR'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DBC-VRF-ICLI.

           MOVE DBC-CAI-ICLI IN DBC TO CNE-GAP-CAI-ICLI.
           MOVE DBC-IIC-ICLI IN DBC TO CNE-GAP-IIC-ICLI.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GAP-FLD.
           MOVE CPT-STRN TO CNE-GAP-GLS-NOMA.
      *>>>>
*% END
      *>>>>
*% END
*% IF GAP_SGV_MACR
      *<<<< GAP_SGV_MACR

      * Obtiene Codigo Valor de Cambio de Pesos
      * Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF GDG-COD-VCAM IN GAP-FLD = TAB-COD-CTAB AND
              GAP-SGV-MACR IN GAP-FLD > ZEROES
               MOVE GAP-SGV-MACR IN GAP-FLD TO 
                    PES-SGV-DECI IN PES-VARI

               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GAP-SGV-MACR IN GAP-FLD.
      *>>>>
*% END
*% IF EOF AND PGM_VAX OR EOF_BU
      *<<<< EOF AND PGM_VAX OR EOF_BU
       VAL-ACR-GDD SECTION.
       INI-VAL-ACR-GDD.
           MOVE DBC-KEY-IDBC IN DBC     TO GDD-CIC-DCLI IN GDD.
           MOVE GAP-CAI-GTIA IN GAP-FLD TO GDD-CAI-GTIA IN GDD.
           MOVE GAP-IIC-GTIA IN GAP-FLD TO GDD-IIC-GTIA IN GDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS
*% IF PGM_ARG
      *<<<< PGM_ARG
               MOVE 'ACRE=DEU' TO MSG-COD-MENS.
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
               MOVE 'GAPACR=CLI' TO MSG-COD-MENS.
      *>>>>
*% END
       FIN-VAL-ACR-GDD.
           EXIT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
*% IF GEN_BCI
      *<<<< GEN_BCI
       VAL-NUM-ICLI SECTION.
       INI-VAL-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN GAP-FLD
           ELSE
               MOVE 'GAR'         TO MSG-COD-SIST
               MOVE 'NUMICLINONU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-NUM-ICLI.
           EXIT.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_GAP_CAI_GTIA
           IF GAP-CAI-GTIA IN GAP-FLD NOT > SPACES
              MOVE SPACES TO GAP-CAI-GTIA IN GAP-FLD
                PERFORM ERR-GLS
                GO TO FIN-VAL-GAP-CAI-GTIA.
*% END
*% IF INI_GAP_IND_ESBA
      *Si GAP-IND-ESBA = 'S' (Cliente Banco)
      *Busar IDC BCO en tabla y desplegra nombre

      *Si GAP-IND-ESBA = 'N' (Cliente No Banco)

           IF GAP-IND-ESBA IN GAP-FLD NOT > SPACES
               MOVE 'N'   TO GAP-IND-ESBA IN GAP-FLD.
             
      *RRM-INI 15-APR-2002
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GAP-IND-ESBA IN GAP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
      *    IF NOT ( GAP-IND-ESBA IN GAP-FLD = 'N' OR 'S' )
      *        MOVE 'GAR'         TO MSG-COD-SIST
      *        MOVE 'IESBA    N/S' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RRM-FIN 15-APR-2002
               GO TO FIN-VAL-GAP-IND-ESBA.

           IF GAP-IND-ESBA IN GAP-FLD = 'S' AND
              GAP-IND-ESCL IN GAP-FLD = 'S'
               MOVE 'GAR'         TO MSG-COD-SIST
               MOVE 'ESBA<>ESCLI ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GAP-IND-ESBA.

      *------------------------------------------------------*
      *Validar que la Prioridad sea Igual al grado de la GDG
      *Criente preferencial tiene que se BCO.
           IF GAP-COD-PACR IN GAP-FLD = GAR-COD-GGTA IN CMA-VARI AND
              GAP-IND-ESBA IN GAP-FLD NOT = 'S'
               MOVE 'GAR'         TO MSG-COD-SIST
               MOVE 'ESBA=BCO   ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GAP-IND-ESBA.

           IF GAP-COD-PACR IN GAP-FLD < GAR-COD-GGTA IN CMA-VARI AND
              GAP-IND-ESBA IN GAP-FLD  = 'S'
               MOVE 'GAR'         TO MSG-COD-SIST
               MOVE 'ESBA<>BCO  ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GAP-IND-ESBA.

           IF GAP-IND-ESBA IN GAP-FLD = 'S'
*% IF FMT_CHI
      *<<<< FMT_CHI
              MOVE ZEROES       TO DBC-NUM-ICLI IN GAP-FLD
              MOVE SPACES       TO DBC-IND-ICLI IN GAP-FLD
              MOVE SPACES       TO DBC-GLS-ICLI IN GAP-FLD
              MOVE SPACES       TO DBC-VRF-ICLI IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GAP-FLD
      *>>>>
*% ELSE
              MOVE ZEROES       TO DBC-IDC-ICLI IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-IDC-ICLI-ATR IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-IDC-ICLI-STP
*% END

              MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GAP-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-STP.

           IF GAP-IND-ESBA IN GAP-FLD  = 'S'
               MOVE 'GAR'     TO TAB-COD-SIST
               MOVE 'IDC '    TO TAB-COD-TTAB IN TAB
               MOVE 'IDCBCO'  TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO DBC-GLS-NOMC IN GAP-FLD
      
*% IF FMT_CHI
      *<<<< FMT_CHI
               MOVE TAB-GLS-DCOR IN TAB TO WSS-IDC-ICLI IN WSS-VARI
               MOVE WSS-NUM-ICLI IN WSS-VARI TO DBC-NUM-ICLI IN GAP-FLD
               MOVE WSS-IND-ICLI IN WSS-VARI TO DBC-IND-ICLI IN GAP-FLD
               MOVE WSS-GLS-ICLI IN WSS-VARI TO DBC-GLS-ICLI IN GAP-FLD
*% IF GEN_BCI
      *<<<< GEN_BCI
               PERFORM VAL-NUM-ICLI
      *>>>>
*% END
               MOVE TAB-COD-DAT1 IN TAB(1)   TO DBC-VRF-ICLI IN GAP-FLD.
      *>>>>
*% ELSE
               MOVE TAB-GLS-DCOR IN TAB TO DBC-IDC-ICLI IN GAP-FLD.
*% END
*% END
*% IF INI_GAP_IND_ESCL
           IF GAP-IND-ESCL IN GAP-FLD NOT > SPACES
              MOVE 'N'  TO GAP-IND-ESCL IN GAP-FLD.

      *RRM-INI 15-APR-2002
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GAP-IND-ESCL IN GAP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
      *    IF NOT ( GAP-IND-ESCL IN GAP-FLD = 'N' OR 'S' )
      *       MOVE 'GAR'         TO MSG-COD-SIST
      *       MOVE 'IESCL    S/N' TO MSG-COD-MENS
      *       PERFORM GET-MSG
      *       MOVE MSG-GLS-DESC TO FRM-MENS
      *       MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RRM-FIN 15-APR-2002
              GO TO FIN-VAL-GAP-IND-ESCL.
         
           IF  GAP-IND-ESCL IN GAP-FLD = 'N' 
*% IF FMT_CHI
      *<<<< FMT_CHI
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GAP-FLD.
      *>>>>
*% ELSE
               MOVE FRM-CPIM-AEY TO DBC-IDC-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-AEY TO DBC-IDC-ICLI-STP.
*% END

           IF  GAP-IND-ESCL IN GAP-FLD = 'S'
*% IF FMT_CHI
      *<<<< FMT_CHI
               MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN GAP-FLD
               MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN GAP-FLD
      *>>>>
*% END
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GAP-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-STP. 

*% END
*% IF INI_GAP_IND_MASC
      *<<<< INI_GAP_IND_MASC
      *RRM-INI 15-APR-2002
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR'                   TO TAB-COD-SIST.
           MOVE 'SIN '                  TO TAB-COD-TTAB IN TAB.
           MOVE GAP-IND-MASC IN GAP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-GAP-IND-MASC.
      *RRM-FIN 15-APR-2002
      *>>>>
*% END
*% IF INI_DBC_IDC_ICLI
      *<<<<
           IF MSG-COD-MENS > SPACES
              GO TO FIN-VAL-DBC-IDC-ICLI.
      
      *Buscar tabla no se ingresa
           IF GAP-IND-ESBA IN GAP-FLD = 'S'
              GO TO FIN-VAL-DBC-IDC-ICLI.
      *JGM
      *Se ingresa solo nombre
           IF GAP-IND-ESBA IN GAP-FLD = 'N' AND
              GAP-IND-ESCL IN GAP-FLD = 'N'
              MOVE ZEROES TO DBC-IDC-ICLI IN GAP-FLD
              GO TO FIN-VAL-DBC-IDC-ICLI.
      *JGM
      *Se tiene que ingresar IDC
           IF  GAP-IND-ESCL IN GAP-FLD = 'S' AND
               DBC-IDC-ICLI IN GAP-FLD = ZEROES
      
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'INGIDC' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-IDC-ICLI.
      
           IF   GAP-IND-ESCL IN GAP-FLD = 'N' AND
                DBC-IDC-ICLI IN GAP-FLD NOT = ZEROES
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'NOINGIDC'   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-IDC-ICLI.
      
      
      
           MOVE DBC-IDC-ICLI IN GAP-FLD TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DBC-IDC-ICLI.
      
           PERFORM VAL-ACR-GDD.
           IF MSG-COD-MENS > SPACES
              MOVE 'GAR'        TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DBC-IDC-ICLI.
      
           MOVE DBC-CAI-ICLI IN DBC TO CNE-GAP-CAI-ICLI.
           MOVE DBC-IIC-ICLI IN DBC TO CNE-GAP-IIC-ICLI.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GAP-FLD.
           MOVE CPT-STRN TO CNE-GAP-GLS-NOMA.
      *>>>>       
*% END
*% IF INI_DBC_NUM_ICLI
      *<<<<
           IF MSG-COD-MENS > SPACES
              GO TO FIN-VAL-DBC-NUM-ICLI.
      
      *Buscar tabla no se ingresa
           IF GAP-IND-ESBA IN GAP-FLD = 'S'
              GO TO FIN-VAL-DBC-NUM-ICLI.
      *JGM
      *Se ingresa solo nombre
           IF GAP-IND-ESBA IN GAP-FLD = 'N' AND
              GAP-IND-ESCL IN GAP-FLD = 'N'
              MOVE ZEROES TO DBC-NUM-ICLI IN GAP-FLD
              MOVE SPACES TO DBC-IND-ICLI IN GAP-FLD
              MOVE SPACES TO DBC-GLS-ICLI IN GAP-FLD
              MOVE SPACES TO DBC-VRF-ICLI IN GAP-FLD
              GO TO FIN-VAL-DBC-NUM-ICLI.
      *JGM
      *Se tiene que ingresar IDC
           IF  GAP-IND-ESCL IN GAP-FLD = 'S' AND
               DBC-NUM-ICLI IN GAP-FLD = ZEROES
      
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'INGIDC' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-NUM-ICLI.
      
           IF   GAP-IND-ESCL IN GAP-FLD = 'N' AND
                DBC-NUM-ICLI IN GAP-FLD NOT = ZEROES
                  MOVE 'TAB'        TO MSG-COD-SIST
                  MOVE 'NOINGIDC'   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-NUM-ICLI.
      
           MOVE DBC-NUM-ICLI IN GAP-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GAP-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GAP-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DBC-NUM-ICLI.

           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GAP-FLD.
      
           PERFORM VAL-ACR-GDD.
           IF MSG-COD-MENS > SPACES
              MOVE 'GAR'        TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DBC-NUM-ICLI.
      
           MOVE DBC-CAI-ICLI IN DBC TO CNE-GAP-CAI-ICLI.
           MOVE DBC-IIC-ICLI IN DBC TO CNE-GAP-IIC-ICLI.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GAP-FLD.
           MOVE CPT-STRN TO CNE-GAP-GLS-NOMA.
      *>>>>       
*% END
*% IF INI_DBC_GLS_NOMC
      *<<<<
           IF GAP-IND-ESBA IN GAP-FLD = 'S'  
               GO TO FIN-VAL-DBC-GLS-NOMC.

           IF  GAP-IND-ESCL IN GAP-FLD = 'S'  
               GO TO FIN-VAL-DBC-GLS-NOMC.

           IF  DBC-GLS-NOMC IN GAP-FLD NOT > SPACES AND
               GAP-IND-ESCL IN GAP-FLD = 'N'  

                  MOVE 'TAB'        TO MSG-COD-SIST                     
                  MOVE 'ACR-NOM-NEX' TO MSG-COD-MENS                     
                  PERFORM GET-MSG                                       
                  MOVE SPACES       TO DBC-GLS-NOMC IN GAP-FLD          
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-GLS-NOMC.

*% END
*% IF INI_RET_GAP_GAP
      *>>>> INI_RET_GDG_GDG
*% IF FMT_CHI
      *>>>> FMT_CHI
      *     MOVE DBC-NUM-ICLI IN GAP-FLD  TO WSS-NUM-ICLI IN WSS-VARI.
      *     MOVE DBC-VRF-ICLI IN GAP-FLD  TO WSS-IND-ICLI IN WSS-VARI.
      *     MOVE DBC-GLS-ICLI IN GAP-FLD  TO WSS-GLS-ICLI IN WSS-VARI.
      *     MOVE WSS-IDC-ICLI IN WSS-VARI TO GAP-CIC-ICLI IN GAP.

      *IDC-CLI Busca Cliente por medio de IdC.
           MOVE DBC-NUM-ICLI IN GAP-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GAP-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GAP-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-CAI-ICLI IN DBC TO GAP-CAI-ICLI IN GAP
               MOVE DBC-IIC-ICLI IN DBC TO GAP-IIC-ICLI IN GAP.

      *<<<<
*% ELSE
           MOVE DBC-IDC-ICLI IN GAP-FLD  TO GAP-CIC-ICLI IN GAP.
*% END
           MOVE DBC-GLS-NOMC IN GAP-FLD  TO GAP-GLS-NOMA IN GAP.
      *<<<<
*% END
