*% FRM = 'GIN'
*% REG = 'GIN'
*% GEN_BCI = TRUE
*% IF FIN_UNP_IKY_GIN 
      *<<<< FIN_UNP_IKY_GIN 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = "ING"
               MOVE FRM-CPIM-AEY TO GIN-NUM-IGIN-ATR IN GIN-FLD
               MOVE FRM-CPIM-AEY TO GIN-NUM-IGIN-STP.
      *RRM-FIN 16-APR-2002
      *>>>>
*% END
*% IF INI_GIN_FEC_ULT_INS
      *<<<< INI_GIN_FEC_ULT_INS
           MOVE FEC-FBLK-S TO FEC-FBLK.
      *>>>>
*% END
*% IF FIN_PUT_GIN_GIN
      *<<<< FIN_PUT_GIN_GIN
*% IF GEN_BCI
      *<<<< GEN_BCI
      *BUS-TAB busca glosa de codigo en tabla
           IF GIN-COD-IINS IN GIN-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'INS ' TO TAB-COD-TTAB IN TAB
               MOVE GIN-COD-IINS IN GIN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IINS IN GIN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IINS IN GIN-FLD.
      *>>>>
*% ELSE
          IF GIN-COD-IINS IN GIN-FLD > SPACES
               MOVE 'INS'                    TO IVB-COD-TTAB IN IVB
               MOVE GIN-COD-IINS IN GIN-FLD  TO IVB-COD-EIVB IN IVB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-IVB
               IF NOT FIO-STAT-OKS
                   MOVE 'CODIINSNEX' TO MSG-COD-MENS
                   MOVE 'GAR' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-GLS-IINS IN GIN-FLD
               ELSE
                   MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-IINS IN GIN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IINS IN GIN-FLD.
*% END
      *MHM-INI 24-OCT-2003
      **BUS-TAB Busca codigo de tabla
      *     MOVE 'TAB'  TO TAB-COD-SIST.
      *     MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.
      *     MOVE SPACES TO TAB-COD-CTAB IN TAB.
      *MHM-FIN 24-OCT-2003

           MOVE GDG-TIP-CGTA IN GIN-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GIN-FLD TO TAG-STP-AGTA IN TAG.
      *MHM-INI 24-OCT-2003
      *     MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
      *     PERFORM BUS-TAB.
      *     IF MSG-COD-MENS = SPACES
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GIN-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GIN-FLD.
      *MHM-FIN 24-OCT-2003
      *MHM-INI 29-OCT-2003
           MOVE GIN-CIC-UING IN GIN TO CMA-CIC-UING IN CMA-VARI.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF FIN_PUT_GDG_GIN
      *<<<< FIN_PUT_GDG_GIN
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-CGTA IN GIN-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'AUX'                   TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-CGTA IN GIN-FLD TO WSS-TIP-CGTA IN WSS-VARI
               MOVE GDG-STP-CGTA IN GIN-FLD TO WSS-STP-CGTA IN WSS-VARI
               MOVE WSS-COD-CGTA IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GIN-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GIN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GIN-FLD.
      *MHM-FIN 23-OCT-2003
      *>>>>
*% END
*% IF INI_GIN_COD_INSP
      *<<<< INI_GIN_COD_INSP
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GIN-COD-INSP IN GIN-FLD NOT > SPACES
               GO TO FIN-VAL-GIN-COD-INSP.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF INI_GIN_CAI_GTIA
           IF GIN-CAI-GTIA IN GIN-FLD NOT > SPACES
              MOVE SPACES TO GIN-CAI-GTIA IN GIN-FLD
              PERFORM ERR-GLS
              GO TO FIN-VAL-GIN-CAI-GTIA.
*% END
*% IF GIN_COD_IINS
      *<<<< GIN_COD_IINS
*% IF GEN_BCI
      *<<<< GEN_BCI
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'INS ' TO TAB-COD-TTAB IN TAB.
           MOVE GIN-COD-IINS IN GIN-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GIN-COD-IINS IN GIN-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-IINS IN GIN-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IINS IN GIN-FLD.
      *>>>>
*% ELSE
           MOVE 'INS'                    TO IVB-COD-TTAB IN IVB.
           MOVE GIN-COD-IINS IN GIN-FLD  TO IVB-COD-EIVB IN IVB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-IVB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODIINSNEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GIN-COD-IINS
           ELSE
               IF IVB-IND-VIGE IN IVB NOT = 'S'
                  MOVE 'COD    NVG' TO MSG-COD-MENS
                  MOVE 'GNS' TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                  MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-IINS IN GIN-FLD.
*% END
      *<<<<
*% END
*% IF GIN_FEC_FUIN
      *<<<< GIN_FEC_ULT_INS
           MOVE '01011937' TO FEC-FEC1.
           MOVE GIN-NUM-SUIN IN GIN-FLD TO FEC-SEC2.
           MOVE GIN-NUM-AUIN IN GIN-FLD TO FEC-AEC2.
           MOVE GIN-NUM-MUIN IN GIN-FLD TO FEC-MEC2
           MOVE GIN-NUM-DUIN IN GIN-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'FEC<MIN' TO MSG-COD-MENS
               GO TO ERR-VAL-GIN-FEC-FUIN.

           GO TO FIN-VAL-GIN-FEC-FUIN.
       ERR-VAL-GIN-FEC-FUIN.
           MOVE 'GAR'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% LBL = ''
*% IF INI_GIN_FEC_FPIN
      *<<<< INI_GIN_FEC_PXM_INS
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-CHOY-G TO FEC-CHOY.
           MOVE FEC-FBLK-S TO FEC-FBLK.
      *>>>>
*% END
*% IF GIN_FEC_FPIN
      *<<<< GIN_FEC_PXM_INS

           MOVE '31122020' TO FEC-FEC1.

           MOVE GIN-NUM-APIN IN GIN-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GIN-NUM-MPIN IN GIN-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GIN-NUM-DPIN IN GIN-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-GRT
               MOVE 'PXMINS>MAX' TO MSG-COD-MENS
               GO TO ERR-VAL-GIN-FEC-FPIN.

      *LAV-CST 14-OCT-1993 No se permite inspecciones posteriores
      * a la fecha de vencimiento.
           MOVE GIN-NUM-APIN IN GIN-FLD TO FEC-FANO IN FEC-VARI.         
           MOVE GIN-NUM-MPIN IN GIN-FLD TO FEC-FMES IN FEC-VARI.         
           MOVE GIN-NUM-DPIN IN GIN-FLD TO FEC-FDIA IN FEC-VARI.         
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.
      *--------------------------------------------------*
           MOVE GIN-CAI-GTIA IN GIN-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GIN-IIC-GTIA IN GIN-FLD TO GDG-IIC-GTIA IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           MOVE GDG-NUM-DVTO IN GDG TO FEC-DEC2.
           MOVE GDG-NUM-MVTO IN GDG TO FEC-MEC2.
           MOVE GDG-NUM-AVTO IN GDG TO FEC-FANO IN FEC-VARI.         
           MOVE FEC-SVLD          TO FEC-SEC2.
           MOVE FEC-AVLD          TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'PXMINS>VTO' TO MSG-COD-MENS
               GO TO ERR-VAL-GIN-FEC-FPIN.

           GO TO FIN-VAL-GIN-FEC-FPIN.
       ERR-VAL-GIN-FEC-FPIN.
           MOVE 'GAR'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% LBL = ''
