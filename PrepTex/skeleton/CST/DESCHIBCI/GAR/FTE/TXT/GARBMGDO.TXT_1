*% FRM = 'GDO'
*% REG = 'GDO'
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF FIN_UNP_IKY_GDO 
      *<<<< FIN_UNP_IKY_GDO 
      *RRM-INI 16-APR-2002
           IF SCR-CCPP = "ING"
               MOVE FRM-CPIM-AEY TO GDO-NUM-IGDO-ATR IN GDO-FLD
               MOVE FRM-CPIM-AEY TO GDO-NUM-IGDO-STP.
      *RRM-FIN 16-APR-2002
      *>>>>
*% END
*% IF FIN_PUT_GDO_GDO
      *<<<< FIN_PUT_GDO_GDO
      *BUS-TAB busca glosa de codigo en tabla
           IF GDO-COD-TDOC IN GDO-FLD > SPACES
*% IF GEN_BCI
      *<<<< GEN_BCI
               MOVE 'TAB'  TO TAB-COD-SIST
               MOVE 'TIO'  TO TAB-COD-TTAB IN TAB
      *>>>>
*% ELSE
               MOVE 'GAR'  TO TAB-COD-SIST
               MOVE 'DOC'  TO TAB-COD-TTAB IN TAB
*% END
               MOVE GDO-COD-TDOC IN GDO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TDOC IN GDO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TDOC IN GDO-FLD.

*% IF NOT GEN_BCI
      *<<<< NOT GEN_BCI
*% VALIDA = FALSE
      *BUS-TAB Busca codigo de tabla                           
           MOVE "IDO" TO FRM-COD-TIEM IN GDO-FLD.
           MOVE "TAB"  TO TAB-COD-SIST.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE "BCO"  TO TAB-COD-TTAB IN TAB.
      *>>>>
*% ELSE
           MOVE "GDO"  TO TAB-COD-TTAB IN TAB.
*% END
           MOVE GDO-COD-EIEM IN GDO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = "COD    NEX"
               MOVE SPACES TO FRM-GLS-IEMI IN GDO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IEMI IN GDO-FLD.
      *>>>>
*% ELSE
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE GDO-COD-TIEM IN GDO-FLD TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDO-COD-INEM IN GDO-FLD TO WSS-COD-INEM
           MOVE GDO-COD-SIEM IN GDO-FLD TO WSS-COD-SIEM
           MOVE WSS-CIV-SIV TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IEMI IN GDO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IEMI IN GDO-FLD.
*% END
      *>>>>
*% END
*% IF INI_GDO_COD_EIEM
      *>>>> INI_EIEM
*% IF NOT GEN_BCI
      *>>>> NOT GEN_BCI
           MOVE 'IDO' TO FRM-COD-TIEM IN GDO-FLD.
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB'  TO TAB-COD-SIST.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE 'BCO'  TO TAB-COD-TTAB IN TAB.
      *>>>>
*% ELSE
           MOVE 'GDO'  TO TAB-COD-TTAB IN TAB.
*% END
           MOVE GDO-COD-EIEM IN GDO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDO-COD-EIEM IN GDO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-IEMI IN GDO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IEMI IN GDO-FLD.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_GDO_COD_TDOC
      *>>>> INI_GTO_TIP_DOCU
           IF GDO-COD-TDOC IN GDO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDO-COD-TDOC.

      *VAL-COD Valida codigo de tabla
*% IF GEN_BCI
      *<<<< GEN_BCI
           MOVE 'TAB'           TO TAB-COD-SIST.
           MOVE 'TIO'           TO TAB-COD-TTAB IN TAB.
      *>>>>
*% ELSE
           MOVE 'GAR'           TO TAB-COD-SIST.
           MOVE 'DOC'           TO TAB-COD-TTAB IN TAB.
*% END
           MOVE GDO-COD-TDOC IN GDO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDO-COD-TDOC IN GDO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TDOC IN GDO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TDOC IN GDO-FLD.

           GO TO FIN-VAL-GDO-COD-TDOC.
      *<<<<
*% END
*% IF GDO_COD_DOCU
      *<<<< GDO_COD_DOC
*% IF NOT GEN_BCI
      *<<<< NOT GEN_BCI
           MOVE GDO-COD-DOCU IN GDO-FLD TO VDO-COD-DOCU IN VDO-VARI.
           MOVE GDO-CAI-GTIA IN GDO-FLD TO VDO-CAI-GTIA IN VDO-VARI.
           MOVE GDO-IIC-GTIA IN GDO-FLD TO VDO-IIC-GTIA IN VDO-VARI.
           MOVE 'GARPUGDO'              TO VDO-PROG     IN VDO-VARI.
           PERFORM GAR-PRO-VDO.
           IF MSG-COD-MENS > SPACES
               MOVE 'GAR'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDO-COD-DOCU.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_GDO_FEC_FCAP
      *<<<< INI_GDO_FEC_CAP
           MOVE FEC-FBLK-S TO FEC-FBLK.
      *>>>>
*% END
*% IF GDO_FEC_FCAP
      *<<<< GDO_FEC_CAP

      *RRM-INI 8-SEP-2001
      *    MOVE GDG-COD-SOPE IN GDO-FLD TO WSS-COD-SOPE.
*% IF FMT_CHI
      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN GDO-FLD TO WSS-COD-TOPE.
           MOVE GDG-STP-CGTA IN GDO-FLD TO WSS-COD-SOPE.
      *>>>>
*% ELSE
           MOVE GDG-COD-CGTA IN GDO-FLD TO WSS-COD-CGTA.
*% END
      *RRM-FIN 8-SEP-2001
           IF NOT DEPOSITO-A-PLAZO
               GO TO FIN-VAL-GDO-FEC-FCAP.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GDG-FEC-FSOL IN CMA-VARI TO FEC-FVLD IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.
      *--------------------------------------------------------*
           MOVE GDO-FEC-FCAP IN GDO-FLD TO FEC-FVLD IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'CAP>SOL' TO MSG-COD-MENS
               MOVE 'GAR'     TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDO-FEC-FCAP.

      *>>>>
*% END
*% IF GDO_COD_SIEM
      *<<<< GDO_SIV_EMI
*% IF NOT GEN_BCI
      *<<<< NOT GEN_BCI
*% VALIDA = TRUE
*% FINPARRAFO = 'FIN-VAL-GDO-SIEM'
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE GDO-COD-TIEM IN GDO-FLD TO TAB-COD-TTAB IN TAB.
           MOVE SPACES        TO TAB-COD-CTAB IN TAB.
           MOVE GDO-COD-INEM IN GDO-FLD TO WSS-COD-INEM.
           MOVE GDO-COD-SIEM IN GDO-FLD TO WSS-COD-SIEM.
           MOVE WSS-CIV-SIV   TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IEMI IN GDO-FLD
           ELSE
               MOVE  0           TO GDO-COD-SIEM-LEN IN GDO-FLD
               MOVE  0           TO GDO-COD-INEM-LEN IN GDO-FLD
               MOVE FRM-POS-CURS TO GDO-COD-TIEM-LEN IN GDO-FLD
               MOVE 'S'          TO FRM-UCUR
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE SPACES       TO FRM-GLS-IEMI IN GDO-FLD
               GO TO FIN-VAL-GDO-COD-SIEM.
      *>>>>
*% ELSE
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE GDO-COD-TIEM IN GDO-FLD TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDO-COD-INEM IN GDO-FLD TO WSS-COD-INEM
           MOVE GDO-COD-SIEM IN GDO-FLD TO WSS-COD-SIEM
           MOVE WSS-CIV-SIV TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IEMI IN GDO-FLD
           ELSE
               MOVE  0 TO GDO-COD-SIEM-LEN IN GDO-FLD
               MOVE -1 TO GDO-COD-TIEM-LEN IN GDO-FLD
               MOVE SPACES TO FRM-GLS-IEMI IN GDO-FLD
               GO TO FIN-VAL-GDO-COD-SIEM.
*% END
*% END
*% IF INI_GDO_CAI_GTIA
      *>>>>
           IF GDO-CAI-GTIA IN GDO-FLD NOT > SPACES     
              MOVE SPACES TO GDO-CAI-GTIA IN GDO-FLD
              PERFORM ERR-GLS             
              GO TO FIN-VAL-GDO-CAI-GTIA. 
      *<<<<
*% END
*% IF FIN_PUT_GDG_GDO
      *<<<< FIN_PUT_GDG_GDO
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN GDO-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN GDO-FLD TO TAG-STP-AGTA IN TAG.
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
      *MHM-INI 23-OCT-2003
      *     MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CGTA IN GDO-FLD.
           MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GDO-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GDO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GDO-FLD.
      *MHM-FIN 23-OCT-2003
      *<<<<
*% END
