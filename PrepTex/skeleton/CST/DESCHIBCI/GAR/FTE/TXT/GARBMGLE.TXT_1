*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF GLE_IND_FOLI
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-IND-FOLI IN GLE-FLD NOT > SPACES   AND     
             (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND     
              GDG-COD-CGTA IN GLE-FLD     < '000130')        
              PERFORM ERR-GLS                                
              GO TO FIN-VAL-GLE-IND-FOLI.                    
      *>>>
*% END
      *>>>
*% END
*% IF GLE_NUM_ESCR
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-NUM-ESCR IN GLE-FLD NOT > SPACES   AND      
             (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND      
              GDG-COD-CGTA IN GLE-FLD     < '000130')         
              PERFORM ERR-GLS                                 
              GO TO FIN-VAL-GLE-NUM-ESCR.                     
      *>>>>
*% END
      *>>>>
*% END
*% IF GLE_COD_TESC
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-COD-TESC IN GLE-FLD NOT > SPACES   AND
             (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
              GDG-COD-CGTA IN GLE-FLD     < '000130')
              PERFORM ERR-GLS
              GO TO FIN-VAL-GLE-COD-TESC.
      *>>>>
*% END
      *>>>>
*% END
*% IF FRM_GLS_TESC
      *<<<< FRM_GLS_TESC
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
      *RRM-INI 10-JUN-2002
           IF GLE-COD-TESC IN GLE-FLD > SPACES
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'TES' TO TAB-COD-TTAB IN TAB
              MOVE GLE-COD-TESC IN GLE-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS > SPACES
                 MOVE 'TAB' TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE SPACES       TO FRM-GLS-TESC IN GLE-FLD
              ELSE
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TESC IN GLE-FLD.
      *RRM-FIN 10-JUN-2002
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_GLE_FEC_FPGT
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF  GLE-FEC-FPGT IN GLE-FLD NOT > ZEROES AND
             ((GDG-COD-CGTA IN GLE-FLD NOT < '000130' AND
               GDG-COD-CGTA IN GLE-FLD     < '000150') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000001' AND
               GDG-COD-CGTA IN GLE-FLD     < '000010') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000010' AND
               GDG-COD-CGTA IN GLE-FLD     < '000019') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000020' AND
               GDG-COD-CGTA IN GLE-FLD     < '000030') OR
               GDG-COD-CGTA IN GLE-FLD     = '000141')
               GO TO FIN-VAL-GLE-FEC-FPGT.
      
           IF GLE-FEC-FPGT IN GLE-FLD NOT > SPACES   AND
             (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
              GDG-COD-CGTA IN GLE-FLD     < '000130')
              PERFORM ERR-GLS
              GO TO FIN-VAL-GLE-FEC-FPGT.
      *>>>>
*% END 
      *>>>>
*% END 
*% IF INI_GLE_COD_LRGN
      *<<<<
*% IF FMT_CHI
      *<<<< FMT_CHI
      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-COD-LRGN IN GLE-FLD > SPACES
               MOVE 'TAB'  TO TAB-COD-SIST
               MOVE 'CIU'  TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-LRGN IN GLE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS IN MSG NOT > SPACES
                   MOVE TAB TO CIU
                   MOVE CIU-GLS-CIUD IN CIU TO FRM-GLS-LRGN IN GLE-FLD
                   MOVE CIU-GLS-ESTD IN CIU TO FRM-GLS-RRGN IN GLE-FLD
               ELSE
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE SPACES       TO FRM-GLS-LRGN IN GLE-FLD
                   MOVE SPACES       TO FRM-GLS-RRGN IN GLE-FLD
                   GO TO FIN-VAL-GLE-COD-LRGN.

      *>>>>
*% ELSE
             IF GLE-COD-LRGN IN GLE-FLD NOT > ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GLE-COD-LRGN.
      
           MOVE GLE-COD-RRGN IN GLE-FLD TO CIU-COD-NOED IN CIU.
           MOVE GLE-COD-LRGN IN GLE-FLD TO CIU-COD-NOCI IN CIU.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CIU.
           IF NOT (FIO-STAT-OKS AND
                   CIU-COD-NOED IN CIU = GLE-COD-RRGN IN GLE-FLD AND
                   CIU-COD-NOCI IN CIU = GLE-COD-LRGN IN GLE-FLD)
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CIU    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO FRM-GLS-LRGN IN GLE-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-GLE-COD-LRGN
           ELSE
              MOVE CIU-GLS-NOMB IN CIU TO FRM-GLS-LRGN IN GLE-FLD  
              GO TO FIN-VAL-GLE-COD-LRGN.                          
*% END
      *>>>>
*% END
*% IF INI_GLE_COD_RRGN
      *<<<<
*% IF FMT_CHI
      *<<<< FMT_CHI
      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-COD-RRGN IN GLE-FLD > SPACES
               MOVE 'TAB'  TO TAB-COD-SIST
               MOVE 'EST'  TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-RRGN IN GLE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS IN MSG NOT > SPACES
                   MOVE TAB-GLS-DESC IN TAB TO
                        FRM-GLS-RRGN IN GLE-FLD
               ELSE
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE SPACES       TO FRM-GLS-RRGN IN GLE-FLD
                   GO TO FIN-VAL-GLE-COD-RRGN.
      *>>>>
*% ELSE

           IF GLE-COD-RRGN IN GLE-FLD NOT > ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GLE-COD-RRGN.
      
           MOVE GLE-COD-RRGN IN GLE-FLD TO EST-COD-NOED IN EST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-EST.
           IF NOT (FIO-STAT-OKS AND
                   EST-COD-NOED IN EST = GLE-COD-RRGN IN GLE-FLD)
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'EST    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE SPACES       TO FRM-GLS-RRGN IN GLE-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-GLE-COD-RRGN
           ELSE
              MOVE EST-GLS-NOME IN EST TO FRM-GLS-RRGN IN GLE-FLD    
              GO TO FIN-VAL-GLE-COD-RRGN.                            
*% END
      *>>>>
*% END
*% IF INI_GLE_FEC_FESC
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-FEC-FESC IN GLE-FLD NOT > SPACES   AND
             (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
              GDG-COD-CGTA IN GLE-FLD     < '000130')
              PERFORM ERR-GLS
              GO TO FIN-VAL-GLE-FEC-FESC.

           MOVE SPACES                  TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GLE-FLD TO WSS-TIPO-DIV IN WSS-VARI.
      
           IF GLE-FEC-FESC IN GLE-FLD NOT > ZEROES
               IF  (WSS-TIPO IN WSS-VARI = 'HIP'          OR
                   (GDG-COD-CGTA IN GLE-FLD NOT < '000101'   AND
                    GDG-COD-CGTA IN GLE-FLD     < '000130'))
                  MOVE 'FECHA DE ESCRITURA OBLIGATORIA' TO MSG-GLS-DESC
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-GLE-FEC-FESC.
      *>>>>
*% END
      *>>>>
*% END
*% IF FIN_PUT_GLE_GLE
      *<<<< FIN_PUT_GLE_GLE
      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-COD-REGI IN GLE-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'REG ' TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-REGI IN GLE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-REGI IN GLE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-REGI IN GLE-FLD.

*% IF FMT_CHI
      *<<<<< FMT_CHI
      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-COD-ABOG IN GLE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ABG ' TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-ABOG IN GLE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ABOG IN GLE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ABOG IN GLE-FLD.

      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-COD-NTRO IN GLE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'NOT ' TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-NTRO IN GLE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-NTRO IN GLE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-NTRO IN GLE-FLD.

      *BUS-TAB busca glosa de codigo en tabla
      *     IF GLE-COD-RRGN IN GLE-FLD > SPACES
      *         MOVE 'TAB' TO TAB-COD-SIST
      *         MOVE 'EST ' TO TAB-COD-TTAB IN TAB
      *         MOVE GLE-COD-RRGN IN GLE-FLD TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-RRGN IN GLE-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-RRGN IN GLE-FLD.

      *MHM-INI 5-AUG-2003
      **BUS-TAB busca glosa de codigo en tabla
      *     IF GLE-COD-LRGN IN GLE-FLD > SPACES
      *         MOVE 'TAB' TO TAB-COD-SIST
      *         MOVE 'CIU ' TO TAB-COD-TTAB IN TAB
      *         MOVE GLE-COD-LRGN IN GLE-FLD TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB TO CIU
      *         MOVE CIU-GLS-CIUD IN CIU TO FRM-GLS-LRGN IN GLE-FLD
      *         MOVE CIU-GLS-ESTD IN CIU TO FRM-GLS-RRGN IN GLE-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-LRGN IN GLE-FLD
      *         MOVE SPACES TO FRM-GLS-RRGN IN GLE-FLD.
      *MHM-FIN 5-AUG-2003

      *>>>>
*% ELSE
           IF GLE-COD-ABOG IN GLE-FLD > SPACES
              MOVE 'ABG'                   TO IVB-COD-TTAB IN IVB
              MOVE GLE-COD-ABOG IN GLE-FLD TO IVB-COD-EIVB IN IVB
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-IVB
              MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-ABOG IN GLE-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-ABOG IN GLE-FLD.
      
      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-COD-NTRO IN GLE-FLD > SPACES
              MOVE 'NOT'                   TO IVB-COD-TTAB IN IVB
              MOVE GLE-COD-NTRO IN GLE-FLD TO IVB-COD-EIVB IN IVB
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-IVB
              MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-NTRO IN GLE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-NTRO IN GLE-FLD.
      
           IF GLE-COD-LRGN IN GLE-FLD > SPACES
      *CGL-INI 10-04-2002
              MOVE GLE-COD-RRGN IN GLE-FLD TO CIU-COD-NOED IN CIU
              MOVE GLE-COD-LRGN IN GLE-FLD TO CIU-COD-NOCI IN CIU
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-CIU
              MOVE CIU-GLS-NOMB IN CIU TO FRM-GLS-LRGN IN GLE-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-LRGN IN GLE-FLD.
      
      *        MOVE 'TAB'  TO TAB-COD-SIST
      *        MOVE 'COM'  TO TAB-COD-TTAB IN TAB
      *        MOVE SPACES TO WSS-COD-CTAB IN WSS-VARI
      *        MOVE GLE-COD-RRGN IN GLE-FLD TO WSS-COD-CTAB1 IN WSS-VARI
      *        MOVE GLE-COD-LRGN IN GLE-FLD TO WSS-COD-CTAB2 IN WSS-VARI
      *        MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB
      *        PERFORM BUS-TAB
      *        MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LRGN IN GLE-FLD
      *     ELSE
      *         MOVE SPACES       TO FRM-GLS-LRGN IN GLE-FLD.
      *CGL-FIN 10-04-2002
      
           IF GLE-COD-RRGN IN GLE-FLD > SPACES
      *CGL-INI 10-04-2002
              MOVE GLE-COD-RRGN IN GLE-FLD TO EST-COD-NOED IN EST
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-EST
              MOVE EST-GLS-NOME IN EST TO FRM-GLS-RRGN IN GLE-FLD
           ELSE
              MOVE SPACES TO FRM-GLS-RRGN IN GLE-FLD.
      
      *        MOVE 'TAB' TO TAB-COD-SIST
      *        MOVE 'EST' TO TAB-COD-TTAB IN TAB
      *        MOVE GLE-COD-RRGN IN GLE-FLD TO TAB-COD-CTAB IN TAB
      *        PERFORM BUS-TAB
      *        MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-RRGN IN GLE-FLD
      *     ELSE
      *        MOVE SPACES       TO FRM-GLS-RRGN IN GLE-FLD.
      *CGL-FIN 10-04-2002
      *RRM-INI 10-JUN-2002
*% END
      *MHM-FIN 5-AUG-2003
      *     IF GLE-COD-TESC IN GLE-FLD > SPACES
      *        MOVE 'TAB' TO TAB-COD-SIST
      *        MOVE 'TES' TO TAB-COD-TTAB IN TAB
      *        MOVE GLE-COD-TESC IN GLE-FLD TO TAB-COD-CTAB IN TAB
      *        PERFORM BUS-TAB
      *        MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-TESC IN GLE-FLD
      *     ELSE
      *        MOVE SPACES TO FRM-GLS-TESC IN GLE-FLD.
      *RRM-FIN 10-JUN-2002
      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-COD-LREG IN GLE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'LOC' TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-LREG IN GLE-FLD TO WSS-LOC-REG
               MOVE WSS-COD-LOC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-LREG IN GLE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LREG IN GLE-FLD.

      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-COD-COMU IN GLE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'COM' TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-COMU IN GLE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COMU IN GLE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-COMU IN GLE-FLD.

      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-IND-ESTA IN GLE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'SLE' TO TAB-COD-TTAB IN TAB
               MOVE GLE-IND-ESTA IN GLE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ESTA IN GLE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ESTA IN GLE-FLD.
      *MHM-FIN 5-AUG-2003
      *MHM-INI 29-OCT-2003
           MOVE GLE-CIC-UING IN GLE TO CMA-CIC-UING IN CMA-VARI.
      *MHM-FIN 29-OCT-2003
      *>>>>
*% END
*% IF INI_GLE_COD_SECC
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-IND-FOLI IN GLE-FLD = 'L'
              IF GLE-COD-SECC IN GLE-FLD NOT > ZEROES   OR
                (GLE-COD-SECC IN GLE-FLD NOT > ZEROES    AND
                (GDG-COD-CGTA IN GLE-FLD NOT < '000101'  AND
                 GDG-COD-CGTA IN GLE-FLD     < '000130'))
                 PERFORM ERR-GLS
                 GO TO FIN-VAL-GLE-COD-SECC.
      *>>>>
*% END
 
           IF GLE-IND-FOLI IN GLE-FLD = 'F' AND
              GLE-COD-SECC IN GLE-FLD > SPACES
               MOVE 'IND    NOCRR' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GLE-COD-SECC.
      *>>>>
*% END
*% IF GLE_NUM_SRIE
      *<<<< GLE_NUM_SRIE
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-IND-FOLI IN GLE-FLD = 'L'
              IF GLE-NUM-SRIE IN GLE-FLD NOT > ZEROES OR
                (GLE-NUM-SRIE IN GLE-FLD NOT > ZEROES   AND
                (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
                 GDG-COD-CGTA IN GLE-FLD     < '000130'))
              PERFORM ERR-GLS
              GO TO FIN-VAL-GLE-NUM-SRIE.
      *>>>>
*% END
      
             IF GLE-IND-FOLI IN GLE-FLD = 'F' AND
                GLE-NUM-SRIE IN GLE-FLD > SPACES
                MOVE 'IND    NOCRR' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GLE-NUM-SRIE.
      *>>>>
*% END
*% IF INI_GLE_FEC_FFOL
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-IND-FOLI IN GLE-FLD = 'F'                        
              IF GLE-FEC-FFOL IN GLE-FLD NOT > ZEROES  OR          
                (GLE-NUM-FOLI IN GLE-FLD NOT > ZEROES   AND        
                (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND        
                 GDG-COD-CGTA IN GLE-FLD     < '000130'))          
                 PERFORM ERR-GLS                                   
                 GO TO FIN-VAL-GLE-FEC-FFOL.                       
      *>>>>
*% END  

           IF GLE-IND-FOLI IN GLE-FLD = 'L' AND
              GLE-FEC-FFOL IN GLE-FLD > ZEROES
               MOVE 'IND    NOCRR' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GLE-FEC-FFOL.
      *>>>>
*% END  
*% IF FIN_GLE_IND_FOLI
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           MOVE SPACES                  TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GLE-FLD TO WSS-TIPO-DIV IN WSS-VARI.
           IF  (WSS-TIPO IN WSS-VARI = 'HIP'          OR
               (GDG-COD-CGTA IN GLE-FLD NOT < '000101'   AND
                GDG-COD-CGTA IN GLE-FLD     < '000130'))  AND
                GLE-IND-FOLI IN GLE-FLD     = SPACES
                MOVE 'INDICADOR ES OBLIGATORIO'  TO MSG-GLS-DESC
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GLE-IND-FOLI.
      *>>>>
*% END  

           IF GLE-IND-FOLI IN GLE-FLD > SPACES
      *VAL-COD Valida codigo de tabla
               MOVE 'GAR'                   TO TAB-COD-SIST
               MOVE 'FOL '                  TO TAB-COD-TTAB IN TAB
               MOVE GLE-IND-FOLI IN GLE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = SPACES
                   GO TO FIN-VAL-GLE-IND-FOLI.

      *>>>>
*% END
*% IF FIN_GLE_COD_TESC
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           MOVE SPACES                  TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GLE-FLD TO WSS-TIPO-DIV IN WSS-VARI.
           IF  (WSS-TIPO IN WSS-VARI = 'HIP'          OR
               (GDG-COD-CGTA IN GLE-FLD NOT < '000101'   AND
                GDG-COD-CGTA IN GLE-FLD     < '000130'))  AND
                GLE-COD-TESC IN GLE-FLD     = SPACES
                MOVE 'TIPO DE ESCRITURA OBLIGATORIO' TO MSG-GLS-DESC
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GLE-COD-TESC.
      *>>>>
*% END
      
           IF GLE-COD-TESC IN GLE-FLD > SPACES
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'TES' TO TAB-COD-TTAB IN TAB
              MOVE GLE-COD-TESC IN GLE-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS > SPACES
                 MOVE 'TAB'        TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE SPACES       TO FRM-GLS-TESC IN GLE-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TESC IN GLE-FLD.
      *>>>>
*% END 	
*% IF FIN_GLE_COD_NTRO
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-COD-NTRO IN GLE-FLD NOT > SPACES AND
              GDG-COD-CGTA IN GLE-FLD = '000141'
              GO TO FIN-VAL-GLE-COD-NTRO.
      
           IF GLE-COD-NTRO IN GLE-FLD NOT > SPACES   AND
            ((GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
              GDG-COD-CGTA IN GLE-FLD     < '000130') OR
             (GDG-COD-CGTA IN GLE-FLD NOT < '000130' AND
              GDG-COD-CGTA IN GLE-FLD     < '000150') OR
             (GDG-COD-CGTA IN GLE-FLD NOT < '000001' AND
              GDG-COD-CGTA IN GLE-FLD     < '000010') OR
             (GDG-COD-CGTA IN GLE-FLD NOT < '000010' AND
              GDG-COD-CGTA IN GLE-FLD     < '000019') OR
             (GDG-COD-CGTA IN GLE-FLD NOT < '000020' AND
              GDG-COD-CGTA IN GLE-FLD     < '000030'))
              PERFORM ERR-GLS
              GO TO FIN-VAL-GLE-COD-NTRO.

           MOVE 'NOT'                   TO IVB-COD-TTAB IN IVB.
           MOVE GLE-COD-NTRO IN GLE-FLD TO IVB-COD-EIVB IN IVB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-IVB.
           IF NOT (FIO-STAT-OKS AND
                   IVB-COD-TTAB IN IVB = 'NOT' AND
                   IVB-COD-EIVB IN IVB = GLE-COD-NTRO IN GLE-FLD)
              MOVE 'TAB'         TO MSG-COD-SIST
              MOVE 'NOT    NVIG' TO MSG-COD-MENS
              MOVE SPACES        TO FRM-GLS-NTRO IN GLE-FLD
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MEN1
              MOVE FRM-SUAR-MAL  TO FRM-SUAR
              GO TO FIN-VAL-GLE-COD-NTRO
           ELSE
              MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-NTRO IN GLE-FLD.
      *>>>>
*% ELSE
      *MHM-INI 17-OCT-2003
           IF GLE-COD-NTRO IN GLE-FLD NOT > SPACES AND
              WSS-IND-SABG IN WSS-VARI = 'S'
               GO TO FIN-VAL-GLE-COD-NTRO.
      *MHM-FIN 17-OCT-2003
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'NOT ' TO TAB-COD-TTAB IN TAB.
           MOVE GLE-COD-NTRO IN GLE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GLE-COD-NTRO IN GLE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-NTRO IN GLE-FLD
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MEN1
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-NTRO IN GLE-FLD.
           GO TO FIN-VAL-GLE-COD-NTRO.

*% END 	
      *>>>>
*% END
*% IF INI_GLE_COD_ABOG
      *<<<< INI_GLE_COD_ABOG
           MOVE SPACES TO WSS-IND-SABG IN WSS-VARI.
           IF GAR-IND-GTAC IN CMA-VARI NOT = 'S'
               MOVE GLE-CAI-GTIA IN GLE-FLD TO GSO-CAI-GTIA IN GSO 
               MOVE GLE-IIC-GTIA IN GLE-FLD TO GSO-IIC-GTIA IN GSO
               MOVE 'GSO-KEY-IGDG' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GSO
               IF FIO-STAT-OKS
                   MOVE GLE-CAI-GTIA IN GLE-FLD TO GLE-CAI-GTIA IN GLE
                   MOVE GLE-IIC-GTIA IN GLE-FLD TO GLE-IIC-GTIA IN GLE
                   MOVE SPACES                  TO GLE-COD-PACR IN GLE
                   MOVE FIO-GET-NLS TO FIO-CMND
                   PERFORM GAR-FIO-GLE
                   IF NOT ( FIO-STAT-OKS AND
                      GLE-CAI-GTIA IN GLE = GLE-CAI-GTIA IN GLE-FLD AND
                      GLE-IIC-GTIA IN GLE = GLE-IIC-GTIA IN GLE-FLD )
                       MOVE 'I' TO GLE-IND-ESTA IN GLE-FLD
                       MOVE 'S' TO WSS-IND-SABG IN WSS-VARI
                       IF GLE-COD-ABOG IN GLE-FLD NOT > SPACES
                           MOVE SPACES TO FRM-GLS-ABOG IN GLE-FLD
                           MOVE 'GLEABOGOBL' TO MSG-COD-MENS
                           MOVE 'GAR' TO MSG-COD-SIST
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC  TO FRM-MEN1
                           MOVE FRM-SUAR-MAL  TO FRM-SUAR
                           GO TO FIN-VAL-GLE-COD-ABOG.
      *>>>>
*% END
*% IF FIN_GLE_COD_ABOG
      *<<<<
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-COD-ABOG IN GLE-FLD NOT > SPACES AND
              GDG-COD-CGTA IN GLE-FLD = '000141'
              GO TO FIN-VAL-GLE-COD-ABOG.
      
           IF  GLE-COD-ABOG IN GLE-FLD NOT > SPACES   AND
             ((GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
               GDG-COD-CGTA IN GLE-FLD     < '000130') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000130' AND
               GDG-COD-CGTA IN GLE-FLD     < '000150') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000001' AND
               GDG-COD-CGTA IN GLE-FLD     < '000010') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000010' AND
               GDG-COD-CGTA IN GLE-FLD     < '000019') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000020' AND
               GDG-COD-CGTA IN GLE-FLD     < '000030'))
               PERFORM ERR-GLS
               GO TO FIN-VAL-GLE-COD-ABOG.

           MOVE 'ABG'                   TO IVB-COD-TTAB IN IVB.
           MOVE GLE-COD-ABOG IN GLE-FLD TO IVB-COD-EIVB IN IVB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-IVB.
           IF NOT (FIO-STAT-OKS AND
                   IVB-COD-TTAB IN IVB = 'ABG' AND
                   IVB-COD-EIVB IN IVB = GLE-COD-ABOG IN GLE-FLD)
              MOVE 'TAB'         TO MSG-COD-SIST
              MOVE 'ABG    NVIG' TO MSG-COD-MENS
              MOVE SPACES        TO FRM-GLS-ABOG IN GLE-FLD
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MEN1
              MOVE FRM-SUAR-MAL  TO FRM-SUAR
              GO TO FIN-VAL-GLE-COD-ABOG
           ELSE
              MOVE IVB-GLS-DESC IN IVB TO FRM-GLS-ABOG IN GLE-FLD.
      *>>>>
*% ELSE
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ABG ' TO TAB-COD-TTAB IN TAB.
           MOVE GLE-COD-ABOG IN GLE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GLE-COD-ABOG IN GLE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ABOG IN GLE-FLD
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MEN1
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ABOG IN GLE-FLD.
           GO TO FIN-VAL-GLE-COD-ABOG.

*% END
      *>>>>
*% END
*% IF INI_GLE_IND_ITIN
      *<<<< INI_GLE_IND_ITIN
      *MHM-INI 17-OCT-2003
           IF GLE-IND-ITIN IN GLE-FLD NOT > SPACES
               MOVE SPACES TO GLE-IND-ITIN IN GLE-FLD.

           IF GLE-IND-ITIN IN GLE-FLD NOT > SPACES AND
              WSS-IND-SABG IN WSS-VARI = 'S'
               GO TO FIN-VAL-GLE-IND-ITIN.
      *MHM-FIN 17-OCT-2003
      *>>>>
*% END
*% IF FIN_GLE_IND_ITIN
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'PUP ' TO TAB-COD-TTAB IN TAB.
           MOVE GLE-IND-ITIN IN GLE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
*% END
*% IF GLE_NUM_LIBR
           IF ( GLE-NUM-LIBR IN GLE-FLD NOT > SPACES)
                MOVE SPACES TO GLE-NUM-LIBR IN GLE-FLD.
      
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-IND-FOLI IN GLE-FLD    = 'L'
              IF GLE-NUM-LIBR IN GLE-FLD = ZEROES  OR
                (GLE-NUM-LIBR IN GLE-FLD = ZEROES       AND
                (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
                 GDG-COD-CGTA IN GLE-FLD     < '000130'))
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'NUMLIBOBLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GLE-NUM-LIBR.
      *>>>>
*% END

            IF GLE-IND-FOLI IN GLE-FLD = 'F' AND
               GLE-NUM-LIBR IN GLE-FLD > SPACES
                MOVE 'IND    NOCRR' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GLE-NUM-LIBR.
               
*% END
*% IF GLE_NUM_FOLI
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF  GLE-IND-FOLI IN GLE-FLD = 'F'
               IF GLE-NUM-FOLI IN GLE-FLD NOT > ZEROES OR
                 (GLE-NUM-FOLI IN GLE-FLD NOT > ZEROES AND
                 (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
                  GDG-COD-CGTA IN GLE-FLD     < '000130'))
              PERFORM ERR-GLS
              GO TO FIN-VAL-GLE-NUM-FOLI.
      *>>>>
*% END
      
           IF GLE-IND-FOLI IN GLE-FLD = 'L' AND
              GLE-NUM-FOLI IN GLE-FLD > SPACES
                MOVE 'IND    NOCRR' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GLE-NUM-FOLI.
      
           IF ( GLE-NUM-FOLI IN GLE-FLD NOT > SPACES)
                MOVE SPACES TO GLE-NUM-FOLI IN GLE-FLD.
*% END
*% IF GLE_NUM_ESCR
      *<<<< GLE_NUM_ESCR
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           MOVE SPACES                  TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GLE-FLD TO WSS-TIPO-DIV IN WSS-VARI.
           IF  (WSS-TIPO IN WSS-VARI = 'HIP'          OR
               (GDG-COD-CGTA IN GLE-FLD NOT < '000101'   AND
                GDG-COD-CGTA IN GLE-FLD     < '000130'))  AND
               GLE-NUM-ESCR IN GLE-FLD     = SPACES
              MOVE 'GAR'        TO MSG-COD-SIST
              MOVE 'NUMESCOBLI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
      *>>>>
*% END
*% IF GLE_NUM_HOJA
      *<<<< GLE_NUM_HOJA
           IF ( GLE-NUM-HOJA IN GLE-FLD NOT > SPACES)
                MOVE SPACES TO GLE-NUM-HOJA IN GLE-FLD.
      
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           MOVE SPACES                  TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GLE-FLD TO WSS-TIPO-DIV IN WSS-VARI.
      
           IF GLE-NUM-HOJA IN GLE-FLD NOT > ZEROES
           IF (WSS-TIPO     IN WSS-VARI    = 'HIP'  OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000101'   AND
               GDG-COD-CGTA IN GLE-FLD     < '000130'))
              MOVE 'GAR'        TO MSG-COD-SIST
              MOVE 'NUMHOJAOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_GLE_GLS_REGI
      *<<<< INI_GLE_GLS_REGI
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-GLS-REGI IN GLE-FLD NOT > SPACES   AND
             (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
              GDG-COD-CGTA IN GLE-FLD     < '000130')
              PERFORM ERR-GLS
              GO TO FIN-VAL-GLE-GLS-REGI.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_GLE_NUM_REGP
      *<<<< INI_GLE_NUM_REGP
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
      *RRM-INI 4-JUN-2002 Campo no obligatorio en el ingreso (HIPOTEC)
           IF GLE-NUM-REGP IN GLE-FLD NOT > SPACES AND 
               SCR-CMND = 'ING' AND 
               GDG-COD-CGTA IN GLE-FLD NOT < '000101'   AND
               GDG-COD-CGTA IN GLE-FLD     < '000130'
                 GO TO FIN-VAL-GLE-NUM-REGP.
      *RRM-FIN 4-JUN-2002 


            IF GLE-NUM-REGP IN GLE-FLD NOT > SPACES AND
             ((GDG-COD-CGTA IN GLE-FLD NOT < '000130' AND
               GDG-COD-CGTA IN GLE-FLD     < '000150') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000001' AND
               GDG-COD-CGTA IN GLE-FLD     < '000010') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000010' AND
               GDG-COD-CGTA IN GLE-FLD     < '000019') OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000020' AND
               GDG-COD-CGTA IN GLE-FLD     < '000030') OR
               GDG-COD-CGTA IN GLE-FLD     = '000141')
               GO TO FIN-VAL-GLE-NUM-REGP.
      

            IF (GLE-NUM-REGP IN GLE-FLD NOT > SPACES     AND
               (GDG-COD-CGTA IN GLE-FLD NOT < '000101'   AND
                GDG-COD-CGTA IN GLE-FLD     < '000130')) OR
               (GLE-NUM-REGP IN GLE-FLD NOT > SPACES     AND
                GLE-IND-ITIN IN GLE-FLD = 'U')
                PERFORM ERR-GLS
                GO TO FIN-VAL-GLE-NUM-REGP.
      *>>>>
*% END
      *>>>>
*% END
*% IF GLE_IND_LCUA
      *<<<< GLE_IND_LCUA
           IF GLE-IND-LCUA IN GLE-FLD NOT > SPACES
              MOVE SPACES TO GLE-IND-LCUA IN GLE-FLD.

*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           MOVE SPACES                  TO WSS-TIPO-DIV IN WSS-VARI.
           MOVE GDG-COD-CGTA IN GLE-FLD TO WSS-TIPO-DIV IN WSS-VARI.
      
           IF  GLE-IND-LCUA IN GLE-FLD = SPACES AND
              (WSS-TIPO IN WSS-VARI    = 'HIP'  OR
              (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
               GDG-COD-CGTA IN GLE-FLD     < '000130'))
               PERFORM ERR-GLS
               GO TO FIN-VAL-GLE-IND-LCUA.
      
           IF  GLE-IND-LCUA IN GLE-FLD = SPACES OR
               NOT (WSS-TIPO IN WSS-VARI    = 'HIP'  OR
                   (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
                    GDG-COD-CGTA IN GLE-FLD     < '000130'))
               GO TO FIN-VAL-GLE-IND-LCUA.
      *>>>>
*% END

      *VAL-IND Valida miscelaneo de tabla
           MOVE 'GNS' TO MSC-COD-SIST.
           MOVE 'VIGE' TO MSC-COD-TMSC IN MSC.
           MOVE GLE-IND-LCUA IN GLE-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF GLE_IND_TENC
      *<<<< GLE_IND_TENC
           IF GLE-IND-TENC IN GLE-FLD NOT > SPACES
              MOVE SPACES TO GLE-IND-TENC IN GLE-FLD.
      *
           IF ( (GLE-IND-TENC IN GLE-FLD = SPACES) AND
                (GDG-COD-TOPE  IN GLE-FLD = 'PDA') )
                  PERFORM ERR-GLS
                  GO TO FIN-VAL-GLE-IND-TENC.

      *
           IF ( (GLE-IND-TENC IN GLE-FLD = SPACES) OR
                (GDG-COD-TOPE  IN GLE-FLD NOT = 'PDA') )
              GO TO FIN-VAL-GLE-IND-TENC.

      *VAL-IND Valida miscelaneo de tabla
           MOVE 'GNS' TO MSC-COD-SIST.
           MOVE 'VIGE' TO MSC-COD-TMSC IN MSC.
           MOVE GLE-IND-TENC IN GLE-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF INI_GLE_COD_REGI
      *<<<< INI_GLE_COD_REGI
      *MHM-INI 17-OCT-2003
           IF GLE-COD-REGI IN GLE-FLD NOT > SPACES
               MOVE SPACES TO GLE-COD-REGI IN GLE-FLD.

           IF GLE-COD-REGI IN GLE-FLD NOT > SPACES AND
              WSS-IND-SABG IN WSS-VARI = 'S'
               GO TO FIN-VAL-GLE-COD-REGI.
      *MHM-FIN 17-OCT-2003
      *>>>>
*% END
*% IF GLE_COD_REGI
      *<<<< GLE_COD_REG
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'REG ' TO TAB-COD-TTAB IN TAB.
           MOVE GLE-COD-REGI IN GLE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GLE-COD-REGI IN GLE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-REGI IN GLE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-REGI IN GLE-FLD.
      *>>>>
*% END
*% IF INI_GLE_COD_LREG
      *<<<< INI_GLE_COD_LREG
      *MHM-INI 17-OCT-2003
           IF GLE-COD-LREG IN GLE-FLD NOT > SPACES
               MOVE SPACES TO GLE-COD-LREG IN GLE-FLD.

           IF GLE-COD-LREG IN GLE-FLD NOT > SPACES AND
              WSS-IND-SABG IN WSS-VARI = 'S'
               GO TO FIN-VAL-GLE-COD-LREG.
      *MHM-FIN 17-OCT-2003
      *>>>>
*% END
*% IF GLE_COD_LREG
      *<<<< GLE_COD_LREG
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'LOC' TO TAB-COD-TTAB IN TAB.
           MOVE GLE-COD-LREG IN GLE-FLD TO WSS-LOC-REG.
           MOVE WSS-COD-LOC TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GLE-COD-LREG IN GLE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-LREG IN GLE-FLD
               GO TO FIN-VAL-GLE-COD-LREG.
           IF TAB-COD-DAT2 IN TAB(7) NOT = WSS-COD-REG
               MOVE 'GAR'       TO MSG-COD-SIST
               MOVE 'REGIONNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GLE-COD-LREG.

           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LREG IN GLE-FLD.
      *>>>>
*% END
*% IF INI_GLE_COD_COMU
      *<<<< INI_GLE_COD_COMU
      *MHM-INI 29-OCT-2003
           IF CMA-CIC-UING IN CMA-VARI = 'MIGRACION' AND
              GLE-COD-COMU IN GLE-FLD NOT > SPACES
               GO TO FIN-VAL-GLE-COD-COMU.
      *MHM-FIN 29-OCT-2003
      *MHM-INI 17-OCT-2003
           IF GLE-COD-COMU IN GLE-FLD NOT > SPACES
               MOVE SPACES TO GLE-COD-COMU IN GLE-FLD.

           IF GLE-COD-COMU IN GLE-FLD NOT > SPACES AND
              WSS-IND-SABG IN WSS-VARI = 'S'
               GO TO FIN-VAL-GLE-COD-COMU.
      *MHM-FIN 17-OCT-2003
      *>>>>
*% END
*% IF GLE_COD_COMU
      *<<<< GLE_COD_COMU
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'COM' TO TAB-COD-TTAB IN TAB.
           MOVE GLE-COD-COMU IN GLE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GLE-COD-COMU IN GLE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COMU IN GLE-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COMU IN GLE-FLD.
           GO TO FIN-VAL-GLE-COD-COMU.
      *>>>>
*% END
*% IF GLE_NUM_TPGT
      *<<<< GLE_NUM_TPGT
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-IND-FOLI IN GLE-FLD = 'L'
              IF GLE-NUM-TPGT IN GLE-FLD NOT > ZEROES  OR
                (GLE-NUM-TPGT IN GLE-FLD NOT > ZEROES   AND
                (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
                 GDG-COD-CGTA IN GLE-FLD     < '000130'))
                 PERFORM ERR-GLS
                 GO TO FIN-VAL-GLE-NUM-TPGT.
      *>>>>
*% END
      
           IF GLE-IND-FOLI IN GLE-FLD = 'F' AND
              GLE-NUM-TPGT IN GLE-FLD > SPACES
                MOVE 'IND    NOCRR' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GLE-NUM-TPGT.
      *>>>>
*% END
*% IF GLE_NUM_VPGT
      *<<<< GLE_NUM_VPGT
*% IF NOT FMT_CHI
      *<<<<< NOT FMT_CHI
           IF GLE-IND-FOLI IN GLE-FLD     = 'L'
              IF GLE-NUM-VPGT IN GLE-FLD NOT > ZEROES  OR
                (GLE-NUM-VPGT IN GLE-FLD NOT > ZEROES   AND
                (GDG-COD-CGTA IN GLE-FLD NOT < '000101' AND
                 GDG-COD-CGTA IN GLE-FLD     < '000130'))
              PERFORM ERR-GLS
              GO TO FIN-VAL-GLE-NUM-VPGT.
      *>>>>
*% END
      
           IF GLE-IND-FOLI IN GLE-FLD = 'F' AND
              GLE-NUM-VPGT IN GLE-FLD > SPACES
                MOVE 'IND    NOCRR' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GLE-NUM-VPGT.
      *>>>>
*% END
*% IF FIN_GLE_FEC_FPGT
*% END
*% IF INI_GLE_CAI_GTIA
      *>>>>>>>>
           IF GLE-CAI-GTIA IN GLE-FLD NOT > SPACES
              MOVE SPACES TO GLE-CAI-GTIA IN GLE-FLD
                PERFORM ERR-GLS
                GO TO FIN-VAL-GLE-CAI-GTIA.
      *<<<<<<
*% END
*% IF GLE_NUM_AICR
      *>>>>>>>> GLE_NUM_AICR
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO WSS-HOY-FHOY IN WSS-VARI.
           IF GLE-NUM-AICR IN GLE-FLD > WSS-SA-FHOY
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GLEANO>HOY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GLE-NUM-AICR.
      *
           IF GLE-NUM-AICR IN GLE-FLD > 0 AND < 1900
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GLEANO<1900' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GLE-NUM-AICR.
      *<<<<<<
*% END
*% IF GLE_NUM_APHG
      *>>>> GLE_NUM_APHG
           IF GLE-NUM-APHG IN GLE-FLD > 0 AND < 1900
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GLEANO<1900' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GLE-NUM-APHG.
      *<<<<
*% END
*% IF FIN_UNP_GLE_GLE
      *<<<< FIN_UNP_GLE_GLE
           MOVE FRM-CPIM-AEY TO GLE-IND-ESTA-ATR.
      *>>>>
*% END 
*% IF GLE_IND_ESTA
      *<<<< GLE_IND_ESTA
      *MHM-INI 23-SEP-2003
           MOVE GLE-CAI-GTIA IN GLE-FLD TO GSO-CAI-GTIA IN GSO.
           MOVE GLE-IIC-GTIA IN GLE-FLD TO GSO-IIC-GTIA IN GSO.
           MOVE 'GSO-KEY-IGDG' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSO.
           IF FIO-STAT-OKS
               MOVE 'I' TO GLE-IND-ESTA IN GLE-FLD
           ELSE
               MOVE 'A' TO GLE-IND-ESTA IN GLE-FLD.

      **BUS-TAB busca glosa de codigo en tabla
      *     IF GLE-IND-ESTA IN GLE-FLD > SPACES
      *         MOVE 'TAB'  TO TAB-COD-SIST
      *         MOVE 'SLE'  TO TAB-COD-TTAB IN TAB
      *         MOVE GLE-IND-ESTA IN GLE-FLD TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         IF MSG-COD-MENS IN MSG NOT > SPACES
      *             MOVE TAB-GLS-DESC IN TAB TO
      *                  FRM-GLS-ESTA IN GLE-FLD
      *         ELSE
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC TO FRM-MENS
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
      *             MOVE SPACES       TO FRM-GLS-ESTA IN GLE-FLD
      *             GO TO FIN-VAL-GLE-IND-ESTA.
      *MHM-FIN 23-SEP-2003
      *>>>>
*% END
*% IF FIN_PUT_GDG_GLE
      *<<<< FIN_PUT_GDG_GLE
*% IF GEN_BCI
      *<<<< GEN_BCI
      *MHM-INI 25-JUL-2003
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-CGTA IN GLE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE SPACES TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GLE-FLD TO WSS-TIP-CGTA
               MOVE GDG-STP-CGTA IN GLE-FLD TO WSS-STP-CGTA
               MOVE WSS-COD-CGTA TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN GLE-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN GLE-FLD.
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           IF GDG-TIP-CGTA IN GLE-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE SPACES                  TO TAB-COD-CTAB IN TAB
               MOVE GDG-TIP-CGTA IN GLE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB             
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.
               
           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN GLE-FLD.
      *MHM-FIN 23-OCT-2003
      *MHM-FIN 25-JUL-2003
      *>>>>
*% END
      *>>>>
*% END
