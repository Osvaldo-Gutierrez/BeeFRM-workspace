       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GARPGDFG.
       AUTHOR.          BEE-TEAM.
       DATE-WRITTEN.    23-JUN-2003.

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
      *        DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GARBRTCG.
       COPY GARBRTCF.
       COPY GARBRTSF.
      *
      * Registros de las Bases Originales.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRMSG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
      *
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
      *
       01  WSS-VARI.
           03 WSS-NUM-RLEE        VALUE ZEROES          PIC 9(05).
           03 WSS-NUM-GRCF        VALUE ZEROES          PIC 9(05).
           03 WSS-NUM-GRSF        VALUE ZEROES          PIC 9(05).


       PROCEDURE DIVISION.
      *------------------
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE "GARPGDFG" TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM OPEN-FILE.
           PERFORM PRO-TCG.
           PERFORM DISP-ESTAD.
           PERFORM CLOSE-FILE.
           PERFORM GNS-PRO-END.
       FIN-MAIN.
           EXIT.
      *
      *---------------------------------------------------------------
      *
       OPEN-FILE SECTION.
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-TCG.
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM GAR-FIO-TCF.
           PERFORM GAR-FIO-TSF.
       FIN-OPEN-FILE.
           EXIT.
      *
      *---------------------------------------------------------------
      *
       CLOSE-FILE SECTION.
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-TCG.
           PERFORM GAR-FIO-TCF.
           PERFORM GAR-FIO-TSF.
       FIN-CLOSE-FILE.
           EXIT.
      *
      *---------------------------------------------------------------
      *
       PRO-TCG SECTION.
       INI-PRO-TCG.
           MOVE FIO-GET-FST  TO FIO-CMND.
       LUP-PRO-TCG.
           PERFORM GAR-FIO-TCG.
           IF NOT FIO-STAT-OKS OR FIO-STAT-EOF
               GO TO FIN-PRO-TCG.
           ADD 1 TO WSS-NUM-RLEE IN WSS-VARI.

           IF (TCG-IND-VCOM IN TCG = 'T' OR
               TCG-IND-VLIQ IN TCG = 'T' OR
               TCG-IND-VUME IN TCG = 'T' OR
               TCG-IND-VTCR IN TCG = 'T' OR
               TCG-IND-VTTR IN TCG = 'T' OR
               TCG-IND-VTAS IN TCG = 'T' OR
               TCG-IND-VSUP IN TCG = 'T' OR
               TCG-IND-VFTS IN TCG = 'T')
               PERFORM GRA-REG-TCF
            ELSE
               PERFORM GRA-REG-TSF.


       NXT-PRO-TCG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-TCG.
       FIN-PRO-TCG.
           EXIT.
      *
      *---------------------------------------------------------------
      *
       GRA-REG-TCF SECTION.
       INI-GRA-REG-TCF.
           MOVE TCG TO TCF.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-TCF.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-GRCF IN WSS-VARI
           ELSE
               DISPLAY 'ERROR AL GRABAR TCF : ' TCF.
       FIN-GRA-REG-TCF.
           EXIT.
      *
      *---------------------------------------------------------------
      *
       GRA-REG-TSF SECTION.
       INI-GRA-REG-TSF.
           MOVE TCG TO TSF.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-TSF.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-GRSF IN WSS-VARI
           ELSE
               DISPLAY 'ERROR AL GRABAR TSF : ' TSF.
       FIN-GRA-REG-TSF.
           EXIT.
      *
      *---------------------------------------------------------------
      *
       DISP-ESTAD SECTION.
       INI-DISP-ESTAD.
           DISPLAY 'NUM. TASACIONES ANALIZADAS      : '
                                               WSS-NUM-RLEE IN WSS-VARI.
           DISPLAY 'NUM. TASACIONES CON DIFERENCIAS : '
                                               WSS-NUM-GRCF IN WSS-VARI.
           DISPLAY 'NUM. TASACIONES SIN DIFERENCIAS : '
                                               WSS-NUM-GRSF IN WSS-VARI.
       FIN-DISP-ESTAD.
           EXIT.
      *
      *---------------------------------------------------------------
      *

       COPY GARBFTCG.
       COPY GARBFTCF.
       COPY GARBFTSF.
       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBTABT.
       COPY GNSBGABT.
       COPY GNSBGIDD.
       COPY GNSBGDTC.
       COPY GNSBGEND.
       COPY GNSBGHOY.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBBSYS.
