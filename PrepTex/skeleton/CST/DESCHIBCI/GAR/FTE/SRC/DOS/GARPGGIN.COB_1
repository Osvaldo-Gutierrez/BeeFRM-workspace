       IDENTIFICATION DIVISION.
      *-----------------------
       PROGRAM-ID.  GARPGGIN.

      * Carga de Base Garantias, entidades GIN
      * a partir de archivo aplanado GARINS.

       ENVIRONMENT DIVISION.
      *--------------------
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *-------------
       WORKING-STORAGE SECTION.
       COPY GARBRINS.
       COPY GARBRGIN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GIN-REQA==.

       COPY GNSWGRQA.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSLGFIO.

       01  WS-VARIABLES.
           02 WS-EOF-INS     PIC 9(01).
           02 WS-CON-LEE     PIC 9(09).
           02 WS-CON-GRAB    PIC 9(09).
           02 WS-CON-ERRO    PIC 9(09).

       PROCEDURE DIVISION.
      *------------------
       MAIN-PROGRAM SECTION.
       INI-MAIN.
           MOVE FIO-INP     TO FIO-CMND.
           PERFORM GAR-FIO-INS.
           MOVE ZEROS       TO WS-EOF-INS.
           MOVE ZEROS       TO WS-CON-LEE.
           MOVE ZEROS       TO WS-CON-GRAB.
           MOVE ZEROS       TO WS-CON-ERRO.
           PERFORM LEER-GARINS.
           PERFORM PROCESA-GARINS UNTIL WS-EOF-INS = 1.
           MOVE FIO-CLO     TO FIO-CMND.
           PERFORM GAR-FIO-INS.
           DISPLAY 'REGISTROS LEIDOS GARGIN   ' WS-CON-LEE.
           DISPLAY 'REGISTROS GRABADOS GARGIN ' WS-CON-GRAB.
           DISPLAY 'REGISTROS NO GRABA GARGIN ' WS-CON-ERRO.
           PERFORM GNS-PRO-END.
       FIN-MAIN.
           EXIT.
           
       LEER-GARINS SECTION.
       INI-LEE-INS.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-INS.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WS-EOF-INS.
           IF FIO-STAT-EOF
              MOVE 1 TO WS-EOF-INS
              ADD  1 TO WS-CON-LEE.
       FIN-LEE-INS.
           EXIT.

       PROCESA-GARINS SECTION.
       INI-PROC-INS.
           MOVE GIN-GLS-FLAG    IN INS TO GIN-GLS-FLAG IN GIN.
           MOVE GAR-NUM-SIS     IN INS TO GIN-CAI-GTIA IN GIN.
           MOVE GAR-COD-CRR     IN INS TO GIN-IIC-GTIA IN GIN.
           MOVE '1'                    TO GIN-NUM-IGIN IN GIN.
           MOVE GIN-FEC-ULT-ACT IN INS TO GIN-FEC-FTRN IN GIN.            
           MOVE GIN-HOR-ACT     IN INS TO GIN-HRA-HRTR IN GIN.          
           MOVE GIN-MSC-STAT    IN INS TO GIN-MSC-TACC IN GIN.
           MOVE GIN-MSC-TACC    IN INS TO GIN-MSC-STAT IN GIN.
           MOVE GIN-TML-ACT     IN INS TO GIN-COD-OTRN IN GIN.              
           MOVE GIN-IDN-USU-ACT IN INS TO GIN-COD-ATRN IN GIN.
           MOVE GAR-FEC-ULT-INS IN INS TO GIN-FEC-FUIN IN GIN.            
           MOVE GAR-IIV-INP     IN INS TO GIN-COD-IINS IN GIN.          
           MOVE GAR-GLS-RES-1   IN INS TO GIN-GLS-RES1 IN GIN.
           MOVE GAR-GLS-RES-2   IN INS TO GIN-GLS-RES2 IN GIN.
           MOVE GAR-FEC-PXM-INS IN INS TO GIN-FEC-FPIN IN GIN.              
           MOVE SPACES                 TO GIN-COD-INSP IN GIN.
           MOVE GIN-FEC-ING-SIS IN INS TO GIN-FEC-FING IN GIN.
           MOVE GIN-IDN-USU-ING IN INS TO GIN-CIC-UING IN GIN.
           MOVE GIN-GLS-DISP    IN INS TO GIN-GLS-DISP IN GIN.
           MOVE FIO-PUT  TO FIO-CMND.
           PERFORM GAR-FIO-GIN.
           IF FIO-STAT-OKS
              ADD 1 TO WS-CON-GRAB
           ELSE
              ADD 1 TO WS-CON-ERRO.
           PERFORM LEER-GARINS.
       FIN-PROC-INS.
           EXIT.
      *
       COPY GARBFINS.
       COPY GARBFGIN.
      *
       COPY GNSBTABT.
       COPY GNSBGEND.
