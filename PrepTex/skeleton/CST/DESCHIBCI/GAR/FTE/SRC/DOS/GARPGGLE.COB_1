       IDENTIFICATION DIVISION.
      *-----------------------
       PROGRAM-ID.  GARPGGLE.

      * Carga de Base Garantias, entidades GLE
      * a partir de archivo aplanado GARLES.

       ENVIRONMENT DIVISION.
      *--------------------
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *-------------
       WORKING-STORAGE SECTION.
       COPY GARBRLES.
       COPY GARBRGLE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GLE-REQA==.

       COPY GNSWGRQA.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSLGFIO.


       01  WS-VARIABLES.
           02 WS-EOF-LES     PIC 9(01).
           02 WS-CON-LEE     PIC 9(09).
           02 WS-CON-GRAB    PIC 9(09).
           02 WS-CON-ERRO    PIC 9(09).

       PROCEDURE DIVISION.
      *------------------
       MAIN-PROGRAM SECTION.
       INI-MAIN.
           MOVE FIO-INP     TO FIO-CMND.
           PERFORM GAR-FIO-LES.
           MOVE ZEROS       TO WS-EOF-LES.
           MOVE ZEROS       TO WS-CON-LEE.
           MOVE ZEROS       TO WS-CON-GRAB.
           MOVE ZEROS       TO WS-CON-ERRO.
           PERFORM LEER-GARLES.
           PERFORM PROCESA-GARLES UNTIL WS-EOF-LES = 1.
           MOVE FIO-CLO     TO FIO-CMND.
           PERFORM GAR-FIO-LES.
           DISPLAY 'REGISTROS LEIDOS GARLES   ' WS-CON-LEE.
           DISPLAY 'REGISTROS GRABADOS GARGLE ' WS-CON-GRAB.
           DISPLAY 'REGISTROS NO GRABA GARGLE ' WS-CON-ERRO.
           PERFORM GNS-PRO-END.
       FIN-MAIN.
           EXIT.
           
       LEER-GARLES SECTION.
       INI-LEE-LES.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-LES.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WS-EOF-LES.
           IF FIO-STAT-EOF
              MOVE 1 TO WS-EOF-LES
              ADD  1 TO WS-CON-LEE.
       FIN-LEE-LES.
           EXIT.

       PROCESA-GARLES SECTION.
       INI-PROC-LES.
           MOVE GLE-GLS-FLAG    IN LES TO GLE-GLS-FLAG IN GLE.
           MOVE GAR-NUM-SIS     IN LES TO GLE-CAI-GTIA IN GLE.
           MOVE GAR-COD-CRR     IN LES TO GLE-IIC-GTIA IN GLE.
           MOVE '1'                    TO GLE-COD-PACR IN GLE.
           MOVE GLE-FEC-ULT-ACT IN LES TO GLE-FEC-FTRN IN GLE.
           MOVE GLE-HOR-ACT     IN LES TO GLE-HRA-HRTR IN GLE.
           MOVE GLE-MSC-STAT    IN LES TO GLE-MSC-TACC IN GLE.
           MOVE GLE-MSC-TACC    IN LES TO GLE-MSC-STAT IN GLE.
           MOVE GLE-TML-ACT     IN LES TO GLE-COD-OTRN IN GLE.
           MOVE GLE-IDN-USU-ACT IN LES TO GLE-COD-ATRN IN GLE.
           MOVE GAR-IIV-ABG     IN LES TO GLE-COD-ABOG IN GLE.
           MOVE GAR-IIV-NTR     IN LES TO GLE-COD-NTRO IN GLE.
           MOVE SPACES                 TO GLE-IND-FOLI IN GLE.
           MOVE SPACES                 TO GLE-COD-TESC IN GLE.
           MOVE GAR-ROL-SII     IN LES TO GLE-VAL-RSII IN GLE.
           MOVE GAR-IND-PUB-PRV IN LES TO GLE-IND-ITIN IN GLE.
           MOVE ZEROS                  TO GLE-FEC-FFOL IN GLE.
           MOVE ZEROS                  TO GLE-FEC-FESC IN GLE.
           MOVE GAR-FEC-PFN     IN LES TO GLE-FEC-FPGT IN GLE.
           MOVE GAR-FOJ-ICR     IN LES TO GAR-FOJ-ICR  IN GLE.
           MOVE GAR-NUM-ICR     IN LES TO GAR-NUM-ICR  IN GLE.
           MOVE GAR-ANO-ICR     IN LES TO GAR-ANO-ICR  IN GLE.
           MOVE SPACES                 TO GLE-NUM-ESCR IN GLE.
           MOVE SPACES                 TO GLE-COD-SECC IN GLE.
           MOVE SPACES                 TO GLE-IND-LCUA IN GLE.
           MOVE GAR-FOJ-PHB     IN LES TO GLE-NUM-FOJP IN GLE.
           MOVE GAR-NUM-PHB     IN LES TO GLE-NUM-APHG IN GLE.
           MOVE SPACES                 TO GLE-NUM-TPGT IN GLE.
           MOVE SPACES                 TO GLE-NUM-VPGT IN GLE.
           MOVE GAR-ANO-PHB     IN LES TO GAR-ANO-PHB  IN GLE.
           MOVE GAR-COD-REG     IN LES TO GLE-COD-REGI IN GLE.
           MOVE GAR-LOC-REG     IN LES TO GLE-COD-LREG IN GLE.
           MOVE SPACES                 TO GLE-NUM-LIBR IN GLE.
           MOVE SPACES                 TO GLE-NUM-FOLI IN GLE.
           MOVE SPACES                 TO GLE-NUM-HOJA IN GLE.
           MOVE SPACES                 TO GLE-NUM-SRIE IN GLE.
           MOVE SPACES                 TO GLE-NUM-REGP IN GLE.
           MOVE SPACES                 TO GLE-GLS-REGI IN GLE.
           MOVE SPACES                 TO GLE-IND-TENC IN GLE.
           MOVE GLE-FEC-ING-SIS IN LES TO GLE-FEC-FING IN GLE.
           MOVE GLE-IDN-USU-ING IN LES TO GLE-CIC-UING IN GLE.
           MOVE GLE-GLS-DISP    IN LES TO GLE-GLS-DISP IN GLE.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GLE.
           IF FIO-STAT-OKS
              ADD 1 TO WS-CON-GRAB
           ELSE
              ADD 1 TO WS-CON-ERRO.
           PERFORM LEER-GARLES.
       FIN-PROC-LES.
           EXIT.

       COPY GARBFLES.
       COPY GARBFGLE.
      *
       COPY GNSBTABT.
       COPY GNSBGEND.
