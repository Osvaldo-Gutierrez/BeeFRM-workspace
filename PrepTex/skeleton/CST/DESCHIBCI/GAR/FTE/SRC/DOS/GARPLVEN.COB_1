       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GARPLVEN.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    23-Jul-97 04:12 PM.

      * Programa Listador de Reporte VEN con Sort.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MODIFICACION: CONVERTIR REPORT-WRITER A LISTADO, MIGRAR A     *
      *                A COBOL FOR MVS Y CONVERSION 2000               *
      *  FECHA: 13/03/1998                                             *
      ******************************************************************


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTVEN         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTVEN         ASSIGN TO        UT-S-RPTVEN.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      ***** CRW-COMIENZO
      *    SELECT RPTVEN         ASSIGN TO        UT-S-RPTVEN.
           SELECT RPTVEN         ASSIGN TO        RPTVEN.
      ***** CRW-FINAL

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY GARRRVEN.
      ***** CRW-COMIENZO
      *FD  RPTVEN LABEL RECORDS OMITTED
      *    REPORT IS RPT-VEN
      *    .
       FD  RPTVEN
           RECORD CONTAINS 132 CHARACTERS
           BLOCK CONTAINS 0 RECORDS
           LABEL RECORD STANDARD.

       01  RPTVEN-REG           PIC X(132).
      ***** CRW-FINAL

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GARBRGDG.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GARRWVEN.
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
      *Entidades de GNS
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
      *Entidades de TAB
       COPY TABBRUSR.
       COPY TABBROFI.
      *Entidades de SGC
       COPY SGCBRDBC.
      *Entidades de GAR
       COPY GARBRGDD.
       COPY GARBRGES.
       COPY GARBRGVT.

       01  WSS-VARI.
           03  WSS-LINEA1              VALUE SPACES PIC X(01).
           03  WSS-LINEA2              VALUE SPACES PIC X(01).
      *FORMATO (DDMMSSAA)
           03  WSS-FEC-VTO.
               05  WSS-FEC-DVTO        VALUE 0      PIC 9(02).
               05  WSS-FEC-MVTO        VALUE 0      PIC 9(02).
               05  WSS-FEC-AVTO        VALUE 0      PIC 9(04).
      *FORMATO (SSAAMMDD)
           03  WSS-FEC-VTO-AUX.
               05  WSS-FEC-AAUX        VALUE 0      PIC 9(04).
               05  WSS-FEC-MAUX        VALUE 0      PIC 9(02).
               05  WSS-FEC-DAUX        VALUE 0      PIC 9(02).
           03  WSS-SW                  VALUE 0      PIC 9(01).
           03  WSS-CNT-STP-ANT         VALUE ZEROES PIC 9(05).
           03  WSS-CNT-TIP-ANT         VALUE ZEROES PIC 9(05).
           03  WSS-CNT-EJE-ORI-ANT     VALUE ZEROES PIC 9(05).
           03  WSS-CNT-OFI-ANT         VALUE ZEROES PIC 9(05).
      *>>>>
      *<<<< WSS_DTC
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
      *Entidades de GAR
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *Entidades de USR
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>

      ***** CRW-COMIENZO
      *REPORT SECTION.
      *--------------
      *COPY GARRFVEN.
      *    .
      *COPY GARRTVEN.
       01  RPT-VARIABLES.
           02 RPT-VARIABLES-VARIAS.
               03 RPT-IND-INICIO-LISTADO      PIC X(02) VALUE 'SI'.
               03 RPT-VARI-LINEA              PIC 9(03) VALUE 60.
               03 RPT-VARI-PAGE-COUNTER       PIC 9(03).
           02 RPT-VARIABLES-CONTROL.
               03 RPT-CTRL-STP-OPE            PIC X(03) VALUE SPACES.
               03 RPT-CTRL-TIP-OPE            PIC X(03) VALUE SPACES.
               03 RPT-CTRL-COD-EJEC           PIC X(12) VALUE SPACES.
               03 RPT-CTRL-COD-OFI            PIC X(03) VALUE SPACES.

       01  PH-VEN.

           03  PH-VEN-01.
               05  RPT-HEAD-DUSU              PIC X(40).
               05  FILLER                     PIC X(015) VALUE SPACES.
               05  FILLER                     PIC X(39)
                   VALUE 'I N F O R M E   D E   G A R A N T I A S'.
               05  FILLER                     PIC X(8)
                   VALUE '   P O R'.
               05  FILLER                     PIC X(020) VALUE SPACES.
               05  RPT-HEAD-FDMA              PIC 99B99B9999.

           03  PH-VEN-02.
               05  RPT-HEAD-DSIS              PIC X(40).
               05  FILLER                     PIC X(028) VALUE SPACES.
               05  FILLER                     PIC X(39)
                   VALUE 'V E N C I M I E N T O                  '.
               05  FILLER                     PIC X(19)
                   VALUE '               PAG.'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-PAGE-COUNTER      PIC ZZZZZ.

           03  PH-VEN-03.
               05  RPT-HEAD-LINEA1            PIC X.

           03  PH-VEN-04.
               05  FILLER                     PIC X(102) VALUE SPACES.
               05  FILLER                     PIC X(17)
                   VALUE 'VENCIMIENTOS AL :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-HEAD-FEC-DGDG          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-FEC-MGDG          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-FEC-AGDG          PIC 9(4).

           03  PH-VEN-05.
               05  FILLER                     PIC X(9)
                   VALUE 'OFICINA :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-COD-OFI           PIC X(3).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-GLS-OFI           PIC X(15).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(8)
                   VALUE 'EJECUT :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-COD-EJEC          PIC X(12).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-GLS-EJC           PIC X(20).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(6)
                   VALUE 'TIPO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-TIP-OPE           PIC X(3).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-GLS-TIP-OPE       PIC X(10).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(9)
                   VALUE 'SUBTIPO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-STP-OPE           PIC X(3).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-GLS-STP-OPE       PIC X(20).

           03  PH-VEN-06.
               05  FILLER                     PIC X(132)
                   VALUE ALL '='.

           03  PH-VEN-07.
               05  FILLER                     PIC X(39)
                   VALUE 'NUM     GARANTIA   IDENTIFICACION DEUDO'.
               05  FILLER                     PIC X(39)
                   VALUE 'R   F.VCTO         MONEDA         LIMIT'.
               05  FILLER                     PIC X(39)
                   VALUE 'E     F.TASACION     F.VCTO.CREDIT  TIP'.
               05  FILLER                     PIC X(12)
                   VALUE 'O ESP.   NUM'.

           03  PH-VEN-08.
               05  FILLER                     PIC X(044) VALUE SPACES.
               05  FILLER                     PIC X(39)
                   VALUE 'GTIA            VALOR COMERCIAL      VA'.
               05  FILLER                     PIC X(39)
                   VALUE 'LOR LIQUIDACION    VALOR PONDERACION   '.
               05  FILLER                     PIC X(8)
                   VALUE '   GRTIA'.

           03  PH-VEN-09.
               05  FILLER                     PIC X(132)
                   VALUE ALL '='.

       01  DL-VEN.

           03  DL-VEN-10.
               05  RPT-DETA-NUM-SIS           PIC X(4).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-COD-CRR           PIC X(8).
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-NUM-ICLI          PIC X(8).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-VRF-ICLI          PIC X.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-IND-ICLI          PIC X.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-ICLI          PIC X(3).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-FD-VTO            PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-FM-VTO            PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-FA-VTO            PIC 9(4).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-VCB           PIC X(12).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-LIM           PIC X(10).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-FD-TSN            PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-FM-TSN            PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-FA-TSN            PIC 9(4).
               05  FILLER                     PIC X(006) VALUE SPACES.
               05  RPT-DETA-FD-VTO-CDT        PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-FM-VTO-CDT        PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-FA-VTO-CDT        PIC 9(4).
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-GLS-TIP-ESP       PIC X(5).
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-CNT-GAR           PIC ZZZZZ.

           03  DL-VEN-11.
               05  RPT-DETA-GLS-NOMC          PIC X(55).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-VAL-CML-TSN       PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-VAL-LIQ-TSN       PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-VAL-PON           PIC ZZ.ZZZ.ZZZ.ZZ9,9999.

           03  DL-VEN-12.
               05  RPT-DETA-LINEA2            PIC X.

       01  CF-VEN-GDG-STP-OPE.

           03  CF-VEN-13.
               05  FILLER                     PIC X(132)
                   VALUE ALL '-'.

           03  CF-VEN-14.
               05  FILLER                     PIC X(7)
                   VALUE 'SUBTIPO'.
               05  FILLER                     PIC X(118) VALUE SPACES.
               05  RPT-FOOT-CNT-STP           PIC ZZZZZ.

       01  CF-VEN-GDG-TIP-OPE.

           03  CF-VEN-15.
               05  FILLER                     PIC X(124) VALUE SPACES.
               05  FILLER                     PIC X(6)
                   VALUE ALL '-'.

           03  CF-VEN-16.
               05  FILLER                     PIC X(4)
                   VALUE 'TIPO'.
               05  FILLER                     PIC X(121) VALUE SPACES.
               05  RPT-FOOT-CNT-TIP           PIC ZZZZZ.

       01  CF-VEN-DBC-COD-EJEC.

           03  CF-VEN-17.
               05  FILLER                     PIC X(124) VALUE SPACES.
               05  FILLER                     PIC X(7)
                   VALUE ALL '-'.

           03  CF-VEN-18.
               05  FILLER                     PIC X(9)
                   VALUE 'EJECUTIVO'.
               05  FILLER                     PIC X(116) VALUE SPACES.
               05  RPT-FOOT-CNT-EJE-ORI       PIC ZZZZZ.

       01  CF-VEN-GDG-COD-OFI.

           03  CF-VEN-19.
               05  FILLER                     PIC X(124) VALUE SPACES.
               05  FILLER                     PIC X(7)
                   VALUE ALL '-'.

           03  CF-VEN-20.
               05  FILLER                     PIC X(7)
                   VALUE 'OFICINA'.
               05  FILLER                     PIC X(118) VALUE SPACES.
               05  RPT-FOOT-CNT-OFI           PIC ZZZZZ.
      ***** CRW-FINAL

       PROCEDURE DIVISION.
      *==================
      ***** CRW-COMIENZO
      *DECLARATIVES.
      *DEC-CF-VEN-GDG-COD-OFI SECTION.
      *    USE BEFORE REPORTING CF-VEN-GDG-COD-OFI.
      ***** CRW-FINAL

       DEC-CF-VEN-GDG-COD-OFI SECTION.
       INI-CF-VEN-GDG-COD-OFI.
      *<<<< CF_VEN_GDG_COD_OFI
               MOVE 1 TO WSS-CNT-GAR.
               MOVE WSS-CNT-STP-ANT TO WSS-CNT-STP.
               MOVE 0 TO WSS-CNT-STP-ANT.
               MOVE WSS-CNT-TIP-ANT TO WSS-CNT-TIP.
               MOVE 0 TO WSS-CNT-TIP-ANT.
               MOVE WSS-CNT-EJE-ORI-ANT TO WSS-CNT-EJE-ORI.
               MOVE 0 TO WSS-CNT-EJE-ORI-ANT.
               MOVE WSS-CNT-OFI-ANT TO WSS-CNT-OFI.
               MOVE 0 TO WSS-CNT-OFI-ANT.

      *>>>>
       FIN-CF-VEN-GDG-COD-OFI.
           EXIT.
      ***** CRW-COMIENZO
      *DEC-CF-VEN-DBC-COD-EJEC SECTION.
      *    USE BEFORE REPORTING CF-VEN-DBC-COD-EJEC.
      ***** CRW-FINAL

       DEC-CF-VEN-DBC-COD-EJEC SECTION.
       INI-CF-VEN-DBC-COD-EJEC.
      *<<<< CF_VEN_DBC_COD_EJEC
               MOVE WSS-CNT-STP-ANT TO WSS-CNT-STP.
               MOVE 0 TO WSS-CNT-STP-ANT.
               MOVE WSS-CNT-TIP-ANT TO WSS-CNT-TIP.
               MOVE 0 TO WSS-CNT-TIP-ANT.
               MOVE WSS-CNT-EJE-ORI-ANT TO WSS-CNT-EJE-ORI.
               MOVE 0 TO WSS-CNT-EJE-ORI-ANT.
      *>>>>
       FIN-CF-VEN-DBC-COD-EJEC.
           EXIT.
      ***** CRW-COMIENZO
      *DEC-CF-VEN-GDG-TIP-OPE SECTION.
      *    USE BEFORE REPORTING CF-VEN-GDG-TIP-OPE.
      ***** CRW-FINAL

       DEC-CF-VEN-GDG-TIP-OPE SECTION.
       INI-CF-VEN-GDG-TIP-OPE.
      *<<<< CF_VEN_GDG_TIP_OPE
               MOVE WSS-CNT-STP-ANT TO WSS-CNT-STP.
               MOVE 0 TO WSS-CNT-STP-ANT.
               MOVE WSS-CNT-TIP-ANT TO WSS-CNT-TIP.
               MOVE 0 TO WSS-CNT-TIP-ANT.
      *>>>>
       FIN-CF-VEN-GDG-TIP-OPE.
           EXIT.
      ***** CRW-COMIENZO
      *DEC-CF-VEN-GDG-STP-OPE SECTION.
      *    USE BEFORE REPORTING CF-VEN-GDG-STP-OPE.
      ***** CRW-FINAL

       DEC-CF-VEN-GDG-STP-OPE SECTION.
       INI-CF-VEN-GDG-STP-OPE.
      *<<<< CF_VEN_GDG_STP_OPE
               MOVE WSS-CNT-STP-ANT TO WSS-CNT-STP.
               MOVE 0 TO WSS-CNT-STP-ANT.
      *>>>>
       FIN-CF-VEN-GDG-STP-OPE.
           EXIT.
      ***** CRW-COMIENZO
      *DEC-PH-VEN SECTION.
      *    USE BEFORE REPORTING PH-VEN.
      ***** CRW-FINAL

       DEC-PH-VEN SECTION.
       INI-PH-VEN.
      *<<<< PH_VEN
      *BUS-TAB Busca Glosa de Subtipo Garantia
           IF GDG-STP-OPE IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE SPACES TO TAB-COD-CTAB IN TAB
               STRING GDG-TIP-OPE IN SRT, GDG-STP-OPE IN SRT
                      DELIMITED BY SIZE INTO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES AND
                   GDG-STP-OPE IN SRT > SPACES
                      MOVE TAB-GLS-DESC IN TAB TO
                           WSS-GLS-STP-OPE IN WSS-VEN
               ELSE
                  MOVE SPACES TO WSS-GLS-STP-OPE IN WSS-VEN
           ELSE
               MOVE SPACES TO WSS-GLS-STP-OPE IN WSS-VEN.
      *BUS-TAB Busca Glosa de Tabla Tipo de Operacion
           IF GDG-TIP-OPE IN SRT > SPACES
                MOVE 'TAB' TO TAB-COD-SIST
                MOVE 'TIO' TO TAB-COD-TTAB IN TAB
                MOVE SPACES TO TAB-COD-CTAB IN TAB
                MOVE GDG-TIP-OPE IN SRT TO TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                   MOVE TAB-GLS-DESC IN TAB TO
                        WSS-GLS-TIP-OPE IN WSS-VEN
                ELSE
                   MOVE SPACES TO WSS-GLS-TIP-OPE IN WSS-VEN
            ELSE
                MOVE SPACES TO WSS-GLS-TIP-OPE IN WSS-VEN.

      *BUS-USR Busca Glosa de Ejecutivo
           IF DBC-COD-EJEC IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'USR' TO TAB-COD-TTAB IN TAB
               MOVE DBC-COD-EJEC IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               IF MSG-COD-MENS = SPACES
                  MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJC IN WSS-VEN
               ELSE
                  MOVE SPACES TO WSS-GLS-EJC IN WSS-VEN
           ELSE
               MOVE SPACES TO WSS-GLS-EJC IN WSS-VEN.

      *BUS-OFI Busca Codigo de Tabla
           IF GDG-COD-OFI IN SRT > SPACES
                MOVE 'TAB' TO TAB-COD-SIST
                MOVE 'OFI' TO TAB-COD-TTAB IN TAB
                MOVE SPACES TO OFI-COD-OFIC IN OFI
                MOVE GDG-COD-OFI IN SRT TO OFI-COD-OFIC IN OFI
                IF OFI-COD-OFIC > SPACES
                    PERFORM BUS-OFI
                    IF OFI-GLS-DESC > SPACES
                        MOVE OFI-GLS-DESC IN OFI TO
                             WSS-GLS-OFI IN WSS-VEN
                    ELSE
                        MOVE SPACES TO WSS-GLS-OFI IN WSS-VEN.
      *>>>>
       FIN-PH-VEN.
           EXIT.
      ***** CRW-COMIENZO
      *END DECLARATIVES.
      ***** CRW-FINAL

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'GARPLVEN' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB'   TO FIO-SIST.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-USR.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB'   TO FIO-SIST.
           PERFORM TAB-FIO-USR.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB'   TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDD.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GDD.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GVT.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GES.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GES.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'SGC'   TO FIO-SIST.
           PERFORM SGC-FIO-DBC.

           DISPLAY 'FECHA DE VENCIMIENTO (DDMMSSAA) : '.
           ACCEPT WSS-FEC-VTO IN WSS-VARI.
           DISPLAY WSS-FEC-VTO IN WSS-VARI.

      *VAL-FEC Validar Fecha
           MOVE WSS-FEC-VTO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
      *VUELVE FORMATO FECHA (DDMMSSAA) A (SSAAMMDD)
               MOVE WSS-FEC-DVTO TO WSS-FEC-DAUX IN WSS-VARI
               MOVE WSS-FEC-MVTO TO WSS-FEC-MAUX IN WSS-VARI
               MOVE WSS-FEC-AVTO TO WSS-FEC-AAUX IN WSS-VARI
           ELSE
               DISPLAY 'FECHA INCORRECTA : ' WSS-FEC-VTO IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               PERFORM GNS-PRO-END.


      * Mueve Fecha de Vencimiento al Reporte
           MOVE WSS-FEC-DVTO IN WSS-VARI TO WSS-FEC-DGDG IN WSS-VEN.
           MOVE WSS-FEC-MVTO IN WSS-VARI TO WSS-FEC-MGDG IN WSS-VEN.
           MOVE WSS-FEC-AVTO IN WSS-VARI TO WSS-FEC-AGDG IN WSS-VEN.
      *>>>>
           SORT GNSSRT
       COPY GARRSVEN.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
       FST-INP-SRT.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
      *<<<< FIN_FST_INP
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTEN REGISTROS GDG'
              GO TO FIN-INP-SRT.
      *>>>>
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           IF NOT (
              GAR-IND-CPL IN GDG = 'S' AND
              GAR-ES1 IN GDG > '09' AND GAR-ES1 IN GDG < '20'
              )
                 GO TO NXT-INP-SRT.

           IF GAR-FEC-VTO IN GDG > WSS-FEC-VTO-AUX IN WSS-VARI
                 GO TO NXT-INP-SRT.

      *Busca Glosa del Deudor
           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDD.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDD.
           MOVE 'GAR-CLV-GDD-2' TO FIO-AKEY.
      *RVM-BSH-INI 15
      *    MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *RVM-BSH-FIN 15
           PERFORM GAR-FIO-GDD.
      *FLB CST  28-FEB-1994
      *     IF FIO-STAT-OKS
            IF FIO-STAT-OKS AND
               GAR-CLV-GDD-2 IN GDD = GAR-CLV-GDG-1 IN GDG
               MOVE GDD-CIC-ICLI IN GDD TO DBC-CIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO DBC
      *FLB CST  28-FEB-1994
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE SPACES TO DBC.
      *FLB CST  28-FEB-1994 FIN

           IF FIO-STAT-OKS AND DBC-GLS-NOMC IN DBC > SPACES
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.

      * Busca Registro GES
           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GES.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GES.
      *IAS 10/12/92
           MOVE ZEROES             TO GAR-COD-ESP IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF NOT FIO-STAT-OKS OR
              GAR-NUM-SIS IN GDG NOT = GAR-NUM-SIS IN GES OR
              GAR-COD-CRR IN GDG NOT = GAR-COD-CRR IN GES
      *IAS 10/12/92
                MOVE SPACES TO GES
                MOVE ZEROES TO GAR-FEC-VTO-CDT IN GES
                               GAR-COD-CRR IN GES
                               GAR-COD-ESP IN GES.

      *Busca Registro GVT
           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GVT.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GVT.
           MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GVT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO GVT.

           IF NOT FIO-STAT-OKS
                MOVE ZEROES TO GAR-FEC-TSN IN GVT
                               GAR-VAL-CML-TSN IN GVT
                               GAR-VAL-LIQ-TSN IN GVT
                               GAR-VAL-PON IN GVT.
      *>>>>
       MOV-INP-SRT.
       COPY GARRMVEN.
           RELEASE SRT.
       NXT-INP-SRT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
           OPEN OUTPUT RPTVEN.
      *     MOVE 'GARPLVEN' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.
      ***** CRW-COMIENZO
      *    INITIATE RPT-VEN.
           MOVE 0 TO RPT-VARI-PAGE-COUNTER.
      ***** CRW-FINAL
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
       LUP-OUT-SRT.
      *<<<< LUP_OUT
      *BUS-TAB Busca Glosa de Valor de Cambio
           IF GDG-VCB IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE SPACES TO TAB-COD-CTAB IN TAB
               MOVE GDG-VCB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                  MOVE TAB-GLS-DCOR IN TAB TO
                       WSS-GLS-VCB IN WSS-VEN
               ELSE
                  MOVE SPACES TO WSS-GLS-VCB IN WSS-VEN
           ELSE
               MOVE SPACES TO WSS-GLS-VCB IN WSS-VEN.

      *BUS-TAB Busca Glosa de Limite de Garantia
           IF GDG-COD-LIM IN SRT > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'LIM' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-LIM IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                  MOVE TAB-GLS-DCOR IN TAB TO
                       WSS-GLS-LIM IN WSS-VEN
               ELSE
                  MOVE SPACES TO WSS-GLS-LIM IN WSS-VEN
           ELSE
               MOVE SPACES TO WSS-GLS-LIM IN WSS-VEN.


      * Acumular Numero de Garantia por Oficina, que se despliega en DL
           ADD 1 TO WSS-CNT-GAR.

      *>>>>
       GEN-OUT-SRT.
      ***** CRW-COMIENZO
      *    GENERATE DL-VEN.
           MOVE GDG-NUM-SIS IN SRT             TO RPT-DETA-NUM-SIS
           MOVE GDG-COD-CRR IN SRT             TO RPT-DETA-COD-CRR
           MOVE DBC-NUM-ICLI IN SRT            TO RPT-DETA-NUM-ICLI
           MOVE DBC-VRF-ICLI IN SRT            TO RPT-DETA-VRF-ICLI
           MOVE DBC-IND-ICLI IN SRT            TO RPT-DETA-IND-ICLI
           MOVE DBC-GLS-ICLI IN SRT            TO RPT-DETA-GLS-ICLI
           MOVE GDG-FD-VTO IN SRT              TO RPT-DETA-FD-VTO
           MOVE GDG-FM-VTO IN SRT              TO RPT-DETA-FM-VTO
           MOVE GDG-FA-VTO IN SRT              TO RPT-DETA-FA-VTO
           MOVE WSS-GLS-VCB IN WSS-VEN         TO RPT-DETA-GLS-VCB
           MOVE WSS-GLS-LIM IN WSS-VEN         TO RPT-DETA-GLS-LIM
           MOVE GVT-FD-TSN IN SRT              TO RPT-DETA-FD-TSN
           MOVE GVT-FM-TSN IN SRT              TO RPT-DETA-FM-TSN
           MOVE GVT-FA-TSN IN SRT              TO RPT-DETA-FA-TSN
           MOVE GES-FD-VTO-CDT IN SRT          TO RPT-DETA-FD-VTO-CDT
           MOVE GES-FM-VTO-CDT IN SRT          TO RPT-DETA-FM-VTO-CDT
           MOVE GES-FA-VTO-CDT IN SRT          TO RPT-DETA-FA-VTO-CDT
           MOVE WSS-GLS-TIP-ESP IN WSS-VEN     TO RPT-DETA-GLS-TIP-ESP
           MOVE WSS-CNT-GAR IN WSS-VEN         TO RPT-DETA-CNT-GAR
           MOVE DBC-GLS-NOMC IN SRT            TO RPT-DETA-GLS-NOMC
           MOVE GVT-VAL-CML-TSN IN SRT         TO RPT-DETA-VAL-CML-TSN
           MOVE GVT-VAL-LIQ-TSN IN SRT         TO RPT-DETA-VAL-LIQ-TSN
           MOVE GVT-VAL-PON IN SRT             TO RPT-DETA-VAL-PON
           MOVE WSS-LINEA2 IN WSS-VEN          TO RPT-DETA-LINEA2
           IF RPT-IND-INICIO-LISTADO = 'SI'
              MOVE GDG-STP-OPE IN SRT     TO RPT-CTRL-STP-OPE
              MOVE GDG-TIP-OPE IN SRT     TO RPT-CTRL-TIP-OPE
              MOVE DBC-COD-EJEC IN SRT    TO RPT-CTRL-COD-EJEC
              MOVE GDG-COD-OFI IN SRT     TO RPT-CTRL-COD-OFI
              MOVE 'NO' TO RPT-IND-INICIO-LISTADO.
           IF GDG-COD-OFI IN SRT     NOT = RPT-CTRL-COD-OFI OR
              DBC-COD-EJEC IN SRT    NOT = RPT-CTRL-COD-EJEC OR
              GDG-TIP-OPE IN SRT     NOT = RPT-CTRL-TIP-OPE OR
              GDG-STP-OPE IN SRT     NOT = RPT-CTRL-STP-OPE
              PERFORM INI-CTRL-REPORT
              PERFORM INI-HEAD-REPORT.
           IF RPT-VARI-LINEA > 57
              PERFORM INI-HEAD-REPORT.
           WRITE RPTVEN-REG FROM  DL-VEN-10
           WRITE RPTVEN-REG FROM  DL-VEN-11
           WRITE RPTVEN-REG FROM  DL-VEN-12
           ADD 3 TO RPT-VARI-LINEA.
      ***** CRW-FINAL

      *<<<< FIN_GEN_OUT
      * Acumular Contadores de Garantias
           ADD 1 TO WSS-CNT-STP-ANT.
           ADD 1 TO WSS-CNT-TIP-ANT.
           ADD 1 TO WSS-CNT-EJE-ORI-ANT.
           ADD 1 TO WSS-CNT-OFI-ANT.
      *>>>>
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      ***** CRW-COMIENZO
      *    TERMINATE RPT-VEN.
           MOVE HIGH-VALUE TO GDG-COD-OFI IN SRT
           MOVE HIGH-VALUE TO DBC-COD-EJEC IN SRT
           MOVE HIGH-VALUE TO GDG-TIP-OPE IN SRT
           MOVE HIGH-VALUE TO GDG-STP-OPE IN SRT
           PERFORM INI-CTRL-REPORT.
      ***** CRW-FINAL
           CLOSE RPTVEN.
       EXT-OUT-SRT.
           EXIT.
      ***** CRW-COMIENZO
       INI-HEAD-REPORT SECTION.
       INI-HEADING.
           PERFORM DEC-PH-VEN
           MOVE RPT-DUSU                       TO RPT-HEAD-DUSU
           MOVE RPT-FDMA                       TO RPT-HEAD-FDMA
           MOVE RPT-DSIS                       TO RPT-HEAD-DSIS
           MOVE WSS-LINEA1 IN WSS-VEN          TO RPT-HEAD-LINEA1
           MOVE WSS-FEC-DGDG IN WSS-VEN        TO RPT-HEAD-FEC-DGDG
           MOVE WSS-FEC-MGDG IN WSS-VEN        TO RPT-HEAD-FEC-MGDG
           MOVE WSS-FEC-AGDG IN WSS-VEN        TO RPT-HEAD-FEC-AGDG
           MOVE GDG-COD-OFI IN SRT             TO RPT-HEAD-COD-OFI
           MOVE WSS-GLS-OFI IN WSS-VEN         TO RPT-HEAD-GLS-OFI
           MOVE DBC-COD-EJEC IN SRT            TO RPT-HEAD-COD-EJEC
           MOVE WSS-GLS-EJC IN WSS-VEN         TO RPT-HEAD-GLS-EJC
           MOVE GDG-TIP-OPE IN SRT             TO RPT-HEAD-TIP-OPE
           MOVE WSS-GLS-TIP-OPE IN WSS-VEN     TO RPT-HEAD-GLS-TIP-OPE
           MOVE GDG-STP-OPE IN SRT             TO RPT-HEAD-STP-OPE
           MOVE WSS-GLS-STP-OPE IN WSS-VEN     TO RPT-HEAD-GLS-STP-OPE
           ADD 1 TO RPT-VARI-PAGE-COUNTER
           MOVE RPT-VARI-PAGE-COUNTER TO RPT-HEAD-PAGE-COUNTER
           MOVE SPACES TO RPTVEN-REG
           WRITE RPTVEN-REG AFTER PAGE
           WRITE RPTVEN-REG FROM  PH-VEN-01
           WRITE RPTVEN-REG FROM  PH-VEN-02
           WRITE RPTVEN-REG FROM  PH-VEN-03
           WRITE RPTVEN-REG FROM  PH-VEN-04
           WRITE RPTVEN-REG FROM  PH-VEN-05
           WRITE RPTVEN-REG FROM  PH-VEN-06
           WRITE RPTVEN-REG FROM  PH-VEN-07
           WRITE RPTVEN-REG FROM  PH-VEN-08
           WRITE RPTVEN-REG FROM  PH-VEN-09
           MOVE 10 TO RPT-VARI-LINEA.
       FIN-HEADING.
       FIN-HEAD-REPORT.
           EXIT.
       INI-CTRL-REPORT SECTION.
       INI-CONTROL.
           IF GDG-STP-OPE IN SRT     NOT = RPT-CTRL-STP-OPE OR
              GDG-TIP-OPE IN SRT     NOT = RPT-CTRL-TIP-OPE OR
              DBC-COD-EJEC IN SRT    NOT = RPT-CTRL-COD-EJEC OR
              GDG-COD-OFI IN SRT     NOT = RPT-CTRL-COD-OFI
              PERFORM DEC-CF-VEN-GDG-STP-OPE
              MOVE GDG-STP-OPE IN SRT         TO RPT-CTRL-STP-OPE
              MOVE WSS-CNT-STP IN WSS-VEN     TO RPT-FOOT-CNT-STP
              WRITE RPTVEN-REG FROM  CF-VEN-13
              WRITE RPTVEN-REG FROM  CF-VEN-14
              ADD 2 TO RPT-VARI-LINEA.

           IF GDG-TIP-OPE IN SRT NOT = RPT-CTRL-TIP-OPE OR
              DBC-COD-EJEC IN SRT    NOT = RPT-CTRL-COD-EJEC OR
              GDG-COD-OFI IN SRT     NOT = RPT-CTRL-COD-OFI
              PERFORM DEC-CF-VEN-GDG-TIP-OPE
              MOVE GDG-TIP-OPE IN SRT         TO RPT-CTRL-TIP-OPE
              MOVE WSS-CNT-TIP IN WSS-VEN     TO RPT-FOOT-CNT-TIP
              WRITE RPTVEN-REG FROM  CF-VEN-15
              WRITE RPTVEN-REG FROM  CF-VEN-16
              ADD 2 TO RPT-VARI-LINEA.

           IF DBC-COD-EJEC IN SRT NOT = RPT-CTRL-COD-EJEC OR
              GDG-COD-OFI IN SRT     NOT = RPT-CTRL-COD-OFI
              PERFORM DEC-CF-VEN-DBC-COD-EJEC
              MOVE DBC-COD-EJEC IN SRT        TO RPT-CTRL-COD-EJEC
              MOVE WSS-CNT-EJE-ORI IN WSS-VEN TO RPT-FOOT-CNT-EJE-ORI

              WRITE RPTVEN-REG FROM  CF-VEN-17
              WRITE RPTVEN-REG FROM  CF-VEN-18
              ADD 2 TO RPT-VARI-LINEA.

           IF GDG-COD-OFI IN SRT     NOT = RPT-CTRL-COD-OFI
              PERFORM DEC-CF-VEN-GDG-COD-OFI
              MOVE GDG-COD-OFI IN SRT         TO RPT-CTRL-COD-OFI
              MOVE WSS-CNT-OFI IN WSS-VEN     TO RPT-FOOT-CNT-OFI
              WRITE RPTVEN-REG FROM  CF-VEN-19
              WRITE RPTVEN-REG FROM  CF-VEN-20
              ADD 2 TO RPT-VARI-LINEA.
       FIN-CONTROL.
       FIN-CTRL-REPORT.
           EXIT.
      ***** CRW-FINAL

       COPY GARBFGDG.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF
      *Entidades de SGC
       COPY SGCBFDBC.

      *Entidades de GAR
       COPY GARBFGES.
       COPY GARBFGDD.
       COPY GARBFGVT.

      *Entidades de GNS
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBBTAB.
       COPY GNSBBMSG.

      *Entidades de TAB
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY TABBFUSR.
      *>>>>

