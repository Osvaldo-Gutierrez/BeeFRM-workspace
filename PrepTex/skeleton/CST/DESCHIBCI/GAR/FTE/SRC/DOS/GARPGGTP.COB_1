       IDENTIFICATION DIVISION.
      *-----------------------
       PROGRAM-ID.  GARPGGTP.

      * Carga de Base Garantias, entidades GTP
      * a partir de archivo aplanado GARTPS.

       ENVIRONMENT DIVISION.
      *--------------------
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *-------------
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GARBRTPS.
       COPY GARBRGTP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GTP-REQA==.

       COPY GNSWGRQA.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSLGFIO.

       01  WS-VARIABLES.
           02 WS-EOF-TPS     PIC 9(01).
           02 WS-CON-GRAB    PIC 9(09).
           02 WS-CON-ERRO    PIC 9(09).

       PROCEDURE DIVISION.
      *------------------
       MAIN-PROGRAM SECTION.
       INI-MAIN.
           MOVE FIO-INP     TO FIO-CMND.
           PERFORM GAR-FIO-TPS.
           MOVE ZEROS       TO WS-EOF-TPS.
           PERFORM LEER-GARTPS.
           PERFORM PROCESA-GARTPS UNTIL WS-EOF-TPS = 1.
           MOVE FIO-CLO     TO FIO-CMND.
           PERFORM GAR-FIO-TPS.
           DISPLAY 'REGISTROS GRABADOS EN GTP-BEE    ' WS-CON-GRAB.
           DISPLAY 'REGISTROS NO GRABADOS EN GTP-BEE ' WS-CON-ERRO.
           PERFORM GNS-PRO-END.
       FIN-MAIN.
           EXIT.
           
       LEER-GARTPS SECTION.
       INI-LEE-TPS.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-TPS.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WS-EOF-TPS.
           IF FIO-STAT-EOF
              MOVE 1 TO WS-EOF-TPS.
       FIN-LEE-TPS.
           EXIT.

       PROCESA-GARTPS SECTION.
       INI-PROC-TPS.
           MOVE GTP-GLS-FLAG    IN TPS TO GTP-GLS-FLAG IN GTP.
           MOVE GAR-CLV-GTP-1   IN TPS TO GTP-KEY-IGTP IN GTP.
           MOVE GTP-FEC-ULT-ACT IN TPS TO GTP-FEC-FTRN IN GTP.
           MOVE GTP-HOR-ACT     IN TPS TO GTP-HRA-HRTR IN GTP.
           MOVE GTP-MSC-TACC    IN TPS TO GTP-MSC-TACC IN GTP.
           MOVE GTP-MSC-STAT    IN TPS TO GTP-MSC-STAT IN GTP.
           MOVE GTP-TML-ACT     IN TPS TO GTP-COD-OTRN IN GTP.
           MOVE GTP-IDN-USU-ACT IN TPS TO GTP-COD-ATRN IN GTP.
           MOVE GAR-IDN-ITM-TSN IN TPS TO GTP-COD-IITS IN GTP.
           MOVE GAR-CTD-ITM-TSN IN TPS TO GTP-SGV-ITSN IN GTP.
           MOVE GAR-VAL-UNT-ITM IN TPS TO GTP-SGV-VTSN IN GTP.
           MOVE GAR-COD-EST-ITM IN TPS TO GTP-COD-EITS IN GTP.
           MOVE GAR-FEC-CMB-EST IN TPS TO GTP-FEC-FCES IN GTP.
           MOVE GTP-FEC-ING-SIS IN TPS TO GTP-FEC-FING IN GTP.
           MOVE GTP-IDN-USU-ING IN TPS TO GTP-CIC-UNIG IN GTP.
           MOVE GTP-GLS-DISP    IN TPS TO GTP-GLS-DISP IN GTP.
           MOVE FIO-PUT  TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS
              ADD 1 TO WS-CON-GRAB
           ELSE
              ADD 1 TO WS-CON-ERRO.
           PERFORM LEER-GARTPS.
       FIN-PROC-TPS.
           EXIT.
      *
       COPY GARBFTPS.
       COPY GARBFGTP.
      *
       COPY GNSBTABT.
       COPY GNSBGEND.
      * COPY GNSBGVSM.
