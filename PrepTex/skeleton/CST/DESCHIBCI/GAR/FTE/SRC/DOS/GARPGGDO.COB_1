       IDENTIFICATION DIVISION.
      *-----------------------
       PROGRAM-ID.  GARPGGDO.

      * Carga de Base Garantias, entidades GDO
      * a partir de archivo aplanado GARDOS.

       ENVIRONMENT DIVISION.
      *--------------------
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *-------------
       WORKING-STORAGE SECTION.
       COPY GARBRDOS.
       COPY GARBRGDO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDO-REQA==.

       COPY GNSWGRQA.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSLGFIO.

       01  WS-VARIABLES.
           02 WS-EOF-DOS     PIC 9(01).
           02 WS-CON-LEE     PIC 9(09).
           02 WS-CON-GRAB    PIC 9(09).
           02 WS-CON-ERRO    PIC 9(09).

       PROCEDURE DIVISION.
      *------------------
       MAIN-PROGRAM SECTION.
       INI-MAIN.
           MOVE FIO-INP     TO FIO-CMND.
           PERFORM GAR-FIO-DOS.
           MOVE ZEROS       TO WS-EOF-DOS.
           MOVE ZEROS       TO WS-CON-LEE.
           MOVE ZEROS       TO WS-CON-GRAB.
           MOVE ZEROS       TO WS-CON-ERRO.
           PERFORM LEER-GARDOS.
           PERFORM PROCESA-GARDOS UNTIL WS-EOF-DOS = 1.
           MOVE FIO-CLO     TO FIO-CMND.
           PERFORM GAR-FIO-DOS.
           DISPLAY 'REGISTROS LEIDOS GARDOS   ' WS-CON-LEE.
           DISPLAY 'REGISTROS GRABADOS GARGDO ' WS-CON-GRAB.
           DISPLAY 'REGISTROS NO GRABA GARGDO ' WS-CON-ERRO.
           PERFORM GNS-PRO-END.
       FIN-MAIN.
           EXIT.
           
       LEER-GARDOS SECTION.
       INI-LEE-DOS.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-DOS.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WS-EOF-DOS.
           IF FIO-STAT-EOF
              MOVE 1 TO WS-EOF-DOS
              ADD  1 TO WS-CON-LEE.
       FIN-LEE-DOS.
           EXIT.

       PROCESA-GARDOS SECTION.
       INI-PROC-DOS.
           MOVE GDO-GLS-FLAG    IN DOS   TO GDO-GLS-FLAG IN GDO.
           MOVE GAR-NUM-SIS     IN DOS   TO GDO-CAI-GTIA IN GDO.
           MOVE GAR-COD-CRR     IN DOS   TO GDO-IIC-GTIA IN GDO.
           MOVE '1'                      TO GDO-NUM-IGDO IN GDO.
           MOVE GDO-FEC-ULT-ACT IN DOS   TO GDO-FEC-FTRN IN GDO.          
           MOVE GDO-HOR-ACT     IN DOS   TO GDO-HRA-HRTR IN GDO.                
           MOVE GDO-MSC-TACC    IN DOS   TO GDO-MSC-TACC IN GDO.
           MOVE GDO-MSC-STAT    IN DOS   TO GDO-MSC-STAT IN GDO.
           MOVE GDO-TML-ACT     IN DOS   TO GDO-COD-OTRN IN GDO.                
           MOVE GDO-IDN-USU-ACT IN DOS   TO GDO-COD-ATRN IN GDO.
           MOVE GAR-COD-DOC     IN DOS   TO GDO-COD-DOCU IN GDO.
           MOVE GAR-TIP-DOC     IN DOS   TO GDO-COD-TDOC IN GDO.
           MOVE GAR-FEC-CAP     IN DOS   TO GDO-FEC-FCAP IN GDO.                
           MOVE GAR-IIV-EMI     IN DOS   TO GDO-COD-IEMI IN GDO.                
           MOVE GDO-FEC-ING-SIS IN DOS   TO GDO-FEC-FING IN GDO.
           MOVE GDO-IDN-USU-ING IN DOS   TO GDO-CIC-UING IN GDO.
           MOVE GDO-GLS-DISP    IN DOS   TO GDO-GLS-DISP IN GDO.
           MOVE FIO-PUT  TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
           IF FIO-STAT-OKS
              ADD 1 TO WS-CON-GRAB
           ELSE
              ADD 1 TO WS-CON-ERRO.
           PERFORM LEER-GARDOS.
       FIN-PROC-DOS.
           EXIT.
      *
       COPY GARBFDOS.
       COPY GARBFGDO.
      *
       COPY GNSBTABT.
       COPY GNSBGEND.
