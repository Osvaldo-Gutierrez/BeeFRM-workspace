       IDENTIFICATION DIVISION.
      *-----------------------
       PROGRAM-ID.  GARPGGSE.

      * Carga de Base Garantias, entidades GSE
      * a partir de archivo aplanado GARGSS.

       ENVIRONMENT DIVISION.
      *--------------------
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *-------------
       WORKING-STORAGE SECTION.
       COPY GARBRGSS.
       COPY GARBRGSE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSE-REQA==.

       COPY GNSWGRQA.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSLGFIO.


       01  WS-VARIABLES.
           02 WS-EOF-GSS     PIC 9(01).
           02 WS-CON-LEE     PIC 9(09).
           02 WS-CON-GRAB    PIC 9(09).
           02 WS-CON-ERRO    PIC 9(09).

       PROCEDURE DIVISION.
      *------------------
       MAIN-PROGRAM SECTION.
       INI-MAIN.
           MOVE FIO-INP     TO FIO-CMND.
           PERFORM GAR-FIO-GSS.
           MOVE ZEROS       TO WS-EOF-GSS.
           MOVE ZEROS       TO WS-CON-LEE.
           MOVE ZEROS       TO WS-CON-GRAB.
           MOVE ZEROS       TO WS-CON-ERRO.
           PERFORM LEER-GARGSS.
           PERFORM PROCESA-GARGSS UNTIL WS-EOF-GSS = 1.
           MOVE FIO-CLO     TO FIO-CMND.
           PERFORM GAR-FIO-GSS.
           DISPLAY 'REGISTROS LEIDOS GARGSS   ' WS-CON-LEE.
           DISPLAY 'REGISTROS GRABADOS GARGSE ' WS-CON-GRAB.
           DISPLAY 'REGISTROS NO GRABA GARGSE ' WS-CON-ERRO.
           PERFORM GNS-PRO-END.
       FIN-MAIN.
           EXIT.
           
       LEER-GARGSS SECTION.
       INI-LEE-GSS.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GSS.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WS-EOF-GSS.
           IF FIO-STAT-EOF
              MOVE 1 TO WS-EOF-GSS
              ADD  1 TO WS-CON-LEE.
       FIN-LEE-GSS.
           EXIT.

       PROCESA-GARGSS SECTION.
       INI-PROC-GSS.
           MOVE GSE-GLS-FLAG    IN GSS   TO GSE-GLS-FLAG IN GSE.
           MOVE GAR-NUM-SIS     IN GSS   TO GSE-CAI-GTIA IN GSE.
           MOVE GAR-COD-CRR     IN GSS   TO GSE-IIC-GTIA IN GSE.
           MOVE '1'                      TO GSE-NUM-IGSE IN GSE.
           MOVE GSE-FEC-ULT-ACT IN GSS   TO GSE-FEC-FTRN IN GSE.
           MOVE GSE-HOR-ACT       IN GSS   TO GSE-HRA-HRTR IN GSE.
           MOVE GSE-MSC-TACC    IN GSS   TO GSE-MSC-TACC IN GSE.
           MOVE GSE-MSC-STAT    IN GSS   TO GSE-MSC-STAT IN GSE.
           MOVE GSE-TML-ACT     IN GSS   TO GSE-COD-OTRN IN GSE.                
           MOVE GSE-IDN-USU-ACT IN GSS   TO GSE-COD-ATRN IN GSE.
           MOVE GAR-COD-PLZ     IN GSS   TO GSE-COD-PLZA IN GSE.
           MOVE GAR-IIV-CIA-SEG IN GSS   TO GSE-COD-ICCS IN GSE.
           MOVE GAR-IIV-CRD-SEG IN GSS   TO GSE-COD-CORS IN GSE.
           MOVE GAR-VAL-SEG     IN GSS   TO GSE-SGV-SEGU IN GSE.
           MOVE GAR-VCB-SEG     IN GSS   TO GSE-COD-VCMS IN GSE.                
           MOVE GAR-IND-ST      IN GSS   TO GSE-IND-TASC IN GSE.
           MOVE GAR-COD-COB-1   IN GSS   TO GSE-COD-COB1 IN GSE.
           MOVE GAR-COD-COB-2   IN GSS   TO GSE-COD-COB2 IN GSE.
           MOVE GAR-COD-COB-3   IN GSS   TO GSE-COD-COB3 IN GSE.
           MOVE GAR-COD-COB-4   IN GSS   TO GSE-COD-COB4 IN GSE.
           MOVE GAR-COD-COB-5   IN GSS   TO GSE-COD-COB5 IN GSE.
           MOVE GAR-COD-RPB-SEG IN GSS   TO GSE-COD-RTSE IN GSE.
           MOVE GAR-IND-EDS-SEG IN GSS   TO GSE-IND-ENDS IN GSE.
           MOVE GAR-FEC-VIG-SEG IN GSS   TO GSE-FEC-FVSG IN GSE.
           MOVE GAR-FEC-VTO-SEG IN GSS   TO GSE-FEC-FVTS IN GSE.                
           MOVE GAR-IND-PAG-CUO IN GSS   TO GSE-IND-PCUO IN GSE.
           MOVE GSE-FEC-ING-SIS IN GSS   TO GSE-FEC-FING IN GSE.
           MOVE GSE-IDN-USU-ING IN GSS   TO GSE-CIC-UING IN GSE.
           MOVE GSE-GLS-DISP    IN GSS   TO GSE-GLS-DISP IN GSE.
           MOVE FIO-PUT  TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
           IF FIO-STAT-OKS
              ADD 1 TO WS-CON-GRAB
           ELSE
              ADD 1 TO WS-CON-ERRO.
           PERFORM LEER-GARGSS.
       FIN-PROC-GSS.
           EXIT.
      *
       COPY GARBFGSS.
       COPY GARBFGSE.
      *
       COPY GNSBTABT.
       COPY GNSBGEND.
