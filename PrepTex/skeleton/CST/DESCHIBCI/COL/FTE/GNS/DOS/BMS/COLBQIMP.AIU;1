      *
      * COLBQIMP
      * Version 3.0.1 Nov-2005
      * 28-Oct-19 09:03 PM
      *
*% INI_LBL = TRUE
*% PGM_BQ = TRUE
*% FRM = "IMP"
*% PGM_BQ = TRUE
*% INCLUDE SETTAG OF 'COLBMIMP.TXT'
       SET-TAG-COLBQIMP SECTION.
       INI-SET-TAG-COLBQIMP.
           MOVE
           '<IDNMOD NOM=$COLBQIMP$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$28-Oct-19 09:03 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBQIMP.
           EXIT.
           
       PUT-ALL-IMP SECTION.
       INI-PUT-ALL-IMP.
*% INCLUDE INI_PUT_ALL_IMP OF 'COLBMIMP.TXT'
           PERFORM PUT-IMP-IMP.
*% INCLUDE FIN_PUT_ALL_IMP OF 'COLBMIMP.TXT'
       FIN-PUT-ALL-IMP.
           EXIT.
       
       PUT-IMP-IMP SECTION.
       INI-PUT-IMP-IMP.
*% INCLUDE INI_PUT_IMP_IMP OF 'COLBMIMP.TXT'
           IF PGM-STAT-IMP-NUL
               GO TO FIN-PUT-IMP-IMP.
           IF NOT PGM-STAT-IMP-OKS
               PERFORM CLR-IMP-IMP
               GO TO FIN-PUT-IMP-IMP.
           MOVE IMP-COD-TDOC IN IMP TO IMP-COD-TDOC IN IMP-FLD.
           MOVE IMP-MSC-TIMP IN IMP TO IMP-MSC-TIMP IN IMP-FLD.
           MOVE IMP-CIC-IMPU IN IMP TO IMP-CIC-IMPU IN IMP-FLD.
           MOVE IMP-IND-VIGE IN IMP TO IMP-IND-VIGE IN IMP-FLD.
*% RREG = "IMP"
*% RREG_FRM = "IMP"
*% NOMB = "FTRN"
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-NUM-DTRN IN IMP TO IMP-NUM-DTRN IN IMP-FLD.
           MOVE IMP-NUM-MTRN IN IMP TO IMP-NUM-MTRN IN IMP-FLD.
           MOVE IMP-NUM-STRN IN IMP TO IMP-NUM-STRN IN IMP-FLD.
           MOVE IMP-NUM-ATRN IN IMP TO IMP-NUM-ATRN IN IMP-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE IMP-VAL-TIMP IN IMP TO IMP-VAL-TIMP IN IMP-FLD.
           MOVE IMP-VAL-TOPE IN IMP TO IMP-VAL-TOPE IN IMP-FLD.
*% BUF = "IMP-FLD"
*% SIS = "TAB"
*% TAB = "DOC "
*% FLD = "IMP-COD-TDOC"
*% GLS = "FRM-GLS-TDOC"
*% TIENE_GLOSA = TRUE
*% LGL = 34
*% INCLUDE 'BUSTAB'
*% BUF = "IMP-FLD"
*% SIS = "COL"
*% TAB = "TIMP"
*% FLD = "IMP-MSC-TIMP"
*% GLS = "FRM-GLS-TIMP"
*% TIENE_GLOSA = TRUE
*% LGL = 32
*% INCLUDE 'BUSMSC'
*% INCLUDE FIN_PUT_IMP_IMP OF 'COLBMIMP.TXT'
       FIN-PUT-IMP-IMP.
           EXIT.
       
       KEY-ALL-IMP SECTION.
       INI-KEY-ALL-IMP.
*% INCLUDE INI_KEY_ALL_IMP OF 'COLBMIMP.TXT'
           PERFORM KEY-IMP-IMP.
*% INCLUDE FIN_KEY_ALL_IMP OF 'COLBMIMP.TXT'
       FIN-KEY-ALL-IMP.
           EXIT.
       
       KEY-IMP-IMP SECTION.
       INI-KEY-IMP-IMP.
*% INCLUDE INI_KEY_IMP_IMP OF 'COLBMIMP.TXT'
           MOVE IMP-COD-TDOC IN IMP-FLD TO IMP-COD-TDOC IN IMP.
           MOVE IMP-MSC-TIMP IN IMP-FLD TO IMP-MSC-TIMP IN IMP.
*% INCLUDE FIN_KEY_IMP_IMP OF 'COLBMIMP.TXT'
       FIN-KEY-IMP-IMP.
           EXIT.
       
       SCR-CLRA-IMP SECTION.
       INI-SCR-CLRA-IMP.
*% INCLUDE INI_SCR_CLRA_IMP OF 'COLBMIMP.TXT'
           PERFORM CLR-KEY-IMP.
           PERFORM CLR-FLD-IMP.
*% INCLUDE FIN_SCR_CLRA_IMP OF 'COLBMIMP.TXT'
       FIN-SCR-CLRA-IMP.
           EXIT.
       
       CLR-KEY-IMP SECTION.
       INI-CLR-KEY-IMP.
*% INCLUDE INI_CLR_KEY_IMP OF 'COLBMIMP.TXT'
           MOVE SPACES TO IMP-COD-TDOC IN IMP-FLD.
           MOVE SPACES TO IMP-MSC-TIMP IN IMP-FLD.
*% INCLUDE FIN_CLR_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-CLR-KEY-IMP.
           EXIT.
       
       CLR-FLD-IMP SECTION.
       INI-CLR-FLD-IMP.
*% INCLUDE INI_CLR_FLD_IMP OF 'COLBMIMP.TXT'
           MOVE SPACES TO FRM-GLS-TDOC IN IMP-FLD.
           MOVE SPACES TO FRM-GLS-TIMP IN IMP-FLD.
           PERFORM CLR-IMP-IMP.
*% INCLUDE FIN_CLR_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-CLR-FLD-IMP.
           EXIT.
       
       CLR-IMP-IMP SECTION.
       INI-CLR-IMP-IMP.
*% INCLUDE INI_CLR_IMP_IMP OF 'COLBMIMP.TXT'
           MOVE SPACES TO IMP-CIC-IMPU IN IMP-FLD.
           MOVE SPACES TO IMP-IND-VIGE IN IMP-FLD.
*% RREG = "IMP"
*% RREG_FRM = "IMP"
*% NOMB = "FTRN"
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-FEC-FTRN IN IMP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-VAL-TIMP IN IMP-FLD.
           MOVE ZEROES TO IMP-VAL-TOPE IN IMP-FLD.
*% INCLUDE FIN_CLR_IMP_IMP OF 'COLBMIMP.TXT'
       FIN-CLR-IMP-IMP.
           EXIT.
       
       FST-KEY-IMP SECTION.
       INI-FST-KEY-IMP.
*% INCLUDE INI_FST_KEY_IMP OF 'COLBMIMP.TXT'
           MOVE -1 TO IMP-COD-TDOC-LEN IN IMP-FLD.
*% INCLUDE FIN_FST_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-FST-KEY-IMP.
           EXIT.
       
       FST-FLD-IMP SECTION.
       INI-FST-FLD-IMP.
*% INCLUDE INI_FST_FLD_IMP OF 'COLBMIMP.TXT'
           MOVE -1 TO IMP-CIC-IMPU-LEN IN IMP-FLD.
*% INCLUDE FIN_FST_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-FST-FLD-IMP.
           EXIT.
       
       PRO-KEY-IMP SECTION.
       INI-PRO-KEY-IMP.
*% INCLUDE INI_PRO_KEY_IMP OF 'COLBMIMP.TXT'
           PERFORM PRO-IKY-IMP.
           PERFORM PRO-AKY-IMP.
           PERFORM PRO-MKY-IMP.
*% INCLUDE FIN_PRO_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-PRO-KEY-IMP.
           EXIT.
       
       PRO-IKY-IMP SECTION.
       INI-PRO-IKY-IMP.
*% INCLUDE INI_PRO_IKY_IMP OF 'COLBMIMP.TXT'
           MOVE FRM-CPIM-AEY TO IMP-COD-TDOC-ATR IN IMP-FLD.
           MOVE FRM-CPIM-AEY TO IMP-MSC-TIMP-ATR IN IMP-FLD.
*% INCLUDE FIN_PRO_IKY_IMP OF 'COLBMIMP.TXT'
       FIN-PRO-IKY-IMP.
           EXIT.
       
       PRO-MKY-IMP SECTION.
       INI-PRO-MKY-IMP.
*% INCLUDE INI_PRO_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_PRO_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-PRO-MKY-IMP.
           EXIT.
       
       PRO-AKY-IMP SECTION.
       INI-PRO-AKY-IMP.
*% INCLUDE INI_PRO_AKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_PRO_AKY_IMP OF 'COLBMIMP.TXT'
       FIN-PRO-AKY-IMP.
           EXIT.
       
       UNP-KEY-IMP SECTION.
       INI-UNP-KEY-IMP.
*% INCLUDE INI_UNP_KEY_IMP OF 'COLBMIMP.TXT'
           PERFORM UNP-IKY-IMP.
           PERFORM UNP-AKY-IMP.
           PERFORM UNP-MKY-IMP.
*% INCLUDE FIN_UNP_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-KEY-IMP.
           EXIT.
       
       UNP-IKY-IMP SECTION.
       INI-UNP-IKY-IMP.
*% INCLUDE INI_UNP_IKY_IMP OF 'COLBMIMP.TXT'
           MOVE FRM-CPIM-UBY TO IMP-COD-TDOC-ATR.
           MOVE FRM-CPIM-UBY TO IMP-MSC-TIMP-ATR.
*% INCLUDE FIN_UNP_IKY_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-IKY-IMP.
           EXIT.
       
       UNP-MKY-IMP SECTION.
       INI-UNP-MKY-IMP.
*% INCLUDE INI_UNP_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_UNP_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-MKY-IMP.
           EXIT.
       
       UNP-AKY-IMP SECTION.
       INI-UNP-AKY-IMP.
*% INCLUDE INI_UNP_AKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_UNP_AKY_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-AKY-IMP.
           EXIT.
       
       UNP-FLD-IMP SECTION.
       INI-UNP-FLD-IMP.
*% INCLUDE INI_UNP_FLD_IMP OF 'COLBMIMP.TXT'
           PERFORM UNP-IMP-IMP.
*% INCLUDE FIN_UNP_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-FLD-IMP.
           EXIT.
       
       UNP-IMP-IMP SECTION.
       INI-UNP-IMP-IMP.
*% INCLUDE INI_UNP_IMP_IMP OF 'COLBMIMP.TXT'
           MOVE FRM-CPIM-UBY TO IMP-CIC-IMPU-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-IND-VIGE-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-VAL-TIMP-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-VAL-TOPE-ATR IN IMP-FLD.
*% INCLUDE FIN_UNP_IMP_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-IMP-IMP.
           EXIT.
       
       VAL-KEY-IMP SECTION.
       INI-VAL-KEY-IMP.
           PERFORM VAL-IKY-IMP.
           PERFORM VAL-MKY-IMP.
           PERFORM VAL-AKY-IMP.
       FIN-VAL-KEY-IMP.
           EXIT.
       
       VAL-IKY-IMP SECTION.
       INI-VAL-IKY-IMP.
*% INCLUDE INI_VAL_IKY_IMP OF 'COLBMIMP.TXT'
           PERFORM VAL-IMP-COD-TDOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IMP-COD-TDOC-LEN IN IMP-FLD
                GO TO FIN-VAL-IKY-IMP.
           PERFORM VAL-IMP-MSC-TIMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IMP-MSC-TIMP-LEN IN IMP-FLD
                GO TO FIN-VAL-IKY-IMP.
*% INCLUDE FIN_VAL_IKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-IKY-IMP.
           EXIT.
       
       VAL-MKY-IMP SECTION.
       INI-VAL-MKY-IMP.
*% INCLUDE INI_VAL_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_VAL_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-MKY-IMP.
           EXIT.
       
       VAL-AKY-IMP SECTION.
       INI-VAL-AKY-IMP.
*% INCLUDE INI_VAL_AKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_VAL_AKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-AKY-IMP.
           EXIT.
       
       VAL-IMP-COD-TDOC SECTION.
       INI-VAL-IMP-COD-TDOC.
*% LBL = "IMP_COD_TDOC OF 'COLBMIMP.TXT'"
*% INCLUDE INI_IMP_COD_TDOC OF 'COLBMIMP.TXT'
           IF IMP-COD-TDOC IN IMP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-IMP-COD-TDOC.
*% INCLUDE IMP_COD_TDOC OF 'COLBMIMP.TXT'
*% BUF = "IMP-FLD"
*% SIS = "TAB"
*% TAB = "DOC "
*% FLD = "IMP-COD-TDOC"
*% GLS = "FRM-GLS-TDOC"
*% TIENE_GLOSA = TRUE
*% LGL = 34
*% INCLUDE 'VALCOD'
*% INCLUDE FIN_IMP_COD_TDOC OF 'COLBMIMP.TXT'
       FIN-VAL-IMP-COD-TDOC.
           EXIT.
       
       VAL-IMP-MSC-TIMP SECTION.
       INI-VAL-IMP-MSC-TIMP.
*% LBL = "IMP_MSC_TIMP OF 'COLBMIMP.TXT'"
*% INCLUDE INI_IMP_MSC_TIMP OF 'COLBMIMP.TXT'
           IF IMP-MSC-TIMP IN IMP-FLD NOT > SPACES
              MOVE SPACES TO IMP-MSC-TIMP IN IMP-FLD.
*% INCLUDE IMP_MSC_TIMP OF 'COLBMIMP.TXT'
*% BUF = "IMP-FLD"
*% SIS = "COL"
*% TAB = "TIMP"
*% FLD = "IMP-MSC-TIMP"
*% GLS = "FRM-GLS-TIMP"
*% TIENE_GLOSA = TRUE
*% LGL = 32
*% INCLUDE 'VALIND'
*% INCLUDE FIN_IMP_MSC_TIMP OF 'COLBMIMP.TXT'
       FIN-VAL-IMP-MSC-TIMP.
           EXIT.
*% RREG = "IMP"
*% RREG_FRM = "IMP"
*% NOMB = "FTRN"
*% IZR = "S"
       
       VAL-CON-KEY-IMP SECTION.
       INI-VAL-CON-KEY-IMP.
*% INCLUDE INI_VAL_CON_KEY_IMP OF 'COLBMIMP.TXT'
           IF     IMP-COD-TDOC IN IMP-FLD NOT > SPACES 
              AND IMP-MSC-TIMP IN IMP-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-IMP.
*% INCLUDE FIN_VAL_CON_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-CON-KEY-IMP.
           EXIT.
       
       VAL-CON-IKY-IMP SECTION.
       INI-VAL-CON-IKY-IMP.
*% INCLUDE INI_VAL_CON_IKY_IMP OF 'COLBMIMP.TXT'
           IF     IMP-COD-TDOC IN IMP-FLD NOT > SPACES 
              AND IMP-MSC-TIMP IN IMP-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-IMP.
*% INCLUDE FIN_VAL_CON_IKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-CON-IKY-IMP.
           EXIT.
       
       VAL-NUM-KEY-IMP SECTION.
       INI-VAL-NUM-KEY-IMP.
           PERFORM VAL-NUM-IKY-IMP.
           PERFORM VAL-NUM-MKY-IMP.
           PERFORM VAL-NUM-AKY-IMP.
       FIN-VAL-NUM-KEY-IMP.
           EXIT.
       
       VAL-NUM-IKY-IMP SECTION.
       INI-VAL-NUM-IKY-IMP.
*% INCLUDE INI_VAL_NUM_IKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_VAL_NUM_IKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-NUM-IKY-IMP.
           EXIT.
       
       VAL-NUM-MKY-IMP SECTION.
       INI-VAL-NUM-MKY-IMP.
*% INCLUDE INI_VAL_NUM_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_VAL_NUM_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-NUM-MKY-IMP.
           EXIT.
       
       VAL-NUM-AKY-IMP SECTION.
       INI-VAL-NUM-AKY-IMP.
*% INCLUDE INI_VAL_NUM_AKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_VAL_NUM_AKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-NUM-AKY-IMP.
           EXIT.
       
       VAL-NUM-FLD-IMP SECTION.
       INI-VAL-NUM-FLD-IMP.
*% INCLUDE INI_VAL_NUM_FLD_IMP OF 'COLBMIMP.TXT'
       VAL-NUM-IMP-VAL-TIMP.
*% BUF = "IMP-FLD"
*% FLD = "IMP-VAL-TIMP"
*% ENT = "2"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-VAL-TOPE.
*% BUF = "IMP-FLD"
*% FLD = "IMP-VAL-TOPE"
*% ENT = "2"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-IMP.
*% INCLUDE FIN_VAL_NUM_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-NUM-FLD-IMP.
           EXIT.
       
       EDT-KEY-IMP SECTION.
       INI-EDT-KEY-IMP.
           PERFORM EDT-IKY-IMP.
           PERFORM EDT-MKY-IMP.
           PERFORM EDT-AKY-IMP.
*% INCLUDE EDT_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-KEY-IMP.
           EXIT.
       
       EDT-IKY-IMP SECTION.
       INI-EDT-IKY-IMP.
*% INCLUDE EDT_IKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_EDT_IKY_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-IKY-IMP.
           EXIT.
       
       EDT-MKY-IMP SECTION.
       INI-EDT-MKY-IMP.
*% INCLUDE EDT_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_EDT_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-MKY-IMP.
           EXIT.
       
       EDT-AKY-IMP SECTION.
       INI-EDT-AKY-IMP.
*% INCLUDE EDT_AKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_EDT_AKY_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-AKY-IMP.
           EXIT.
       
       EDT-FLD-IMP SECTION.
       INI-EDT-FLD-IMP.
*% INCLUDE EDT_FLD_IMP OF 'COLBMIMP.TXT'
*% RREG = "IMP"
*% RREG_FRM = "IMP"
*% NOMB = "FTRN"
           IF IMP-VAL-TIMP-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-VAL-TIMP-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-VAL-TIMP IN IMP-FLD TO IMP-VAL-TIMP-EDT IN IMP-EDT.
           MOVE IMP-VAL-TIMP-EDT IN IMP-EDT TO 
                IMP-VAL-TIMP-ALF IN IMP-FLD.
           IF IMP-VAL-TOPE-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-VAL-TOPE-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-VAL-TOPE IN IMP-FLD TO IMP-VAL-TOPE-EDT IN IMP-EDT.
           MOVE IMP-VAL-TOPE-EDT IN IMP-EDT TO 
                IMP-VAL-TOPE-ALF IN IMP-FLD.
*% INCLUDE FIN_EDT_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-FLD-IMP.
           EXIT.
*% INCLUDE EOF_BQ OF 'COLBMIMP.TXT'
*% INCLUDE EOF OF 'COLBMIMP.TXT'
*% INCLUDE EOF_IBM OF 'COLBMIMP.TXT'
