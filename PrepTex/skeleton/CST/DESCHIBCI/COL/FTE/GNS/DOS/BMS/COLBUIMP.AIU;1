*% FRM = "IMP"
      *
      * COLBUIMP
      * Version 3.0.1 Nov-2005
      * 28-Oct-19 09:03 PM
      *
*% INI_LBL = TRUE
*% PGM_BU = TRUE
*% INCLUDE SETTAG OF 'COLBMIMP.TXT'
       SET-TAG-COLBUIMP SECTION.
       INI-SET-TAG-COLBUIMP.
           MOVE
           '<IDNMOD NOM=$COLBUIMP$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$28-Oct-19 09:03 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBUIMP.
           EXIT.
           
       RET-ALL-IMP SECTION.
       INI-RET-ALL-IMP.
*% INCLUDE INI_RET_ALL_IMP OF 'COLBMIMP.TXT'
           PERFORM KEY-ALL-IMP.
           PERFORM RET-IMP-IMP.
*% INCLUDE FIN_RET_ALL_IMP OF 'COLBMIMP.TXT'
       FIN-RET-ALL-IMP.
           EXIT.
       
       RET-IMP-IMP SECTION.
       INI-RET-IMP-IMP.
*% INCLUDE INI_RET_IMP_IMP OF 'COLBMIMP.TXT'
           MOVE IMP-CIC-IMPU IN IMP-FLD TO IMP-CIC-IMPU IN IMP.
           MOVE IMP-IND-VIGE IN IMP-FLD TO IMP-IND-VIGE IN IMP.
*% RREG = "IMP"
*% RREG_FRM = "IMP"
*% NOMB = "FTRN"
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IMP-NUM-DTRN IN IMP-FLD TO IMP-NUM-DTRN IN IMP.
           MOVE IMP-NUM-MTRN IN IMP-FLD TO IMP-NUM-MTRN IN IMP.
           MOVE IMP-NUM-STRN IN IMP-FLD TO IMP-NUM-STRN IN IMP.
           MOVE IMP-NUM-ATRN IN IMP-FLD TO IMP-NUM-ATRN IN IMP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IMP-VAL-TIMP IN IMP-FLD TO IMP-VAL-TIMP IN IMP.
           MOVE IMP-VAL-TOPE IN IMP-FLD TO IMP-VAL-TOPE IN IMP.
*% INCLUDE FIN_RET_IMP_IMP OF 'COLBMIMP.TXT'
       FIN-RET-IMP-IMP.
           EXIT.
       
       KEY-ALL-IMP SECTION.
       INI-KEY-ALL-IMP.
*% INCLUDE INI_KEY_ALL_IMP OF 'COLBMIMP.TXT'
           PERFORM KEY-IMP-IMP.
*% INCLUDE FIN_KEY_ALL_IMP OF 'COLBMIMP.TXT'
       FIN-KEY-ALL-IMP.
           EXIT.
       
       KEY-IMP-IMP SECTION.
       INI-KEY-IMP-IMP.
*% INCLUDE INI_KEY_IMP_IMP OF 'COLBMIMP.TXT'
           MOVE IMP-COD-TDOC IN IMP-FLD TO IMP-COD-TDOC IN IMP.
           MOVE IMP-MSC-TIMP IN IMP-FLD TO IMP-MSC-TIMP IN IMP.
*% INCLUDE FIN_KEY_IMP_IMP OF 'COLBMIMP.TXT'
       FIN-KEY-IMP-IMP.
           EXIT.
       
       SCR-CLRA-IMP SECTION.
       INI-SCR-CLRA-IMP.
*% INCLUDE INI_SCR_CLRA_IMP OF 'COLBMIMP.TXT'
           PERFORM CLR-KEY-IMP.
           PERFORM CLR-FLD-IMP.
*% INCLUDE FIN_SCR_CLRA_IMP OF 'COLBMIMP.TXT'
       FIN-SCR-CLRA-IMP.
           EXIT.
       
       CLR-KEY-IMP SECTION.
       INI-CLR-KEY-IMP.
*% INCLUDE INI_CLR_KEY_IMP OF 'COLBMIMP.TXT'
           MOVE SPACES TO IMP-COD-TDOC IN IMP-FLD.
           MOVE SPACES TO IMP-MSC-TIMP IN IMP-FLD.
*% INCLUDE FIN_CLR_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-CLR-KEY-IMP.
           EXIT.
       
       CLR-FLD-IMP SECTION.
       INI-CLR-FLD-IMP.
*% INCLUDE INI_CLR_FLD_IMP OF 'COLBMIMP.TXT'
           MOVE SPACES TO FRM-GLS-TDOC IN IMP-FLD.
           MOVE SPACES TO FRM-GLS-TIMP IN IMP-FLD.
           PERFORM CLR-IMP-IMP.
*% INCLUDE FIN_CLR_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-CLR-FLD-IMP.
           EXIT.
       
       CLR-IMP-IMP SECTION.
       INI-CLR-IMP-IMP.
*% INCLUDE INI_CLR_IMP_IMP OF 'COLBMIMP.TXT'
           MOVE SPACES TO IMP-CIC-IMPU IN IMP-FLD.
           MOVE SPACES TO IMP-IND-VIGE IN IMP-FLD.
*% RREG = "IMP"
*% RREG_FRM = "IMP"
*% NOMB = "FTRN"
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-FEC-FTRN IN IMP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IMP-VAL-TIMP IN IMP-FLD.
           MOVE ZEROES TO IMP-VAL-TOPE IN IMP-FLD.
*% INCLUDE FIN_CLR_IMP_IMP OF 'COLBMIMP.TXT'
       FIN-CLR-IMP-IMP.
           EXIT.
       
       FST-KEY-IMP SECTION.
       INI-FST-KEY-IMP.
*% INCLUDE INI_FST_KEY_IMP OF 'COLBMIMP.TXT'
           MOVE -1 TO IMP-COD-TDOC-LEN IN IMP-FLD.
*% INCLUDE FIN_FST_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-FST-KEY-IMP.
           EXIT.
       
       FST-FLD-IMP SECTION.
       INI-FST-FLD-IMP.
*% INCLUDE INI_FST_FLD_IMP OF 'COLBMIMP.TXT'
           MOVE -1 TO IMP-CIC-IMPU-LEN IN IMP-FLD.
*% INCLUDE FIN_FST_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-FST-FLD-IMP.
           EXIT.
       
       PRO-KEY-IMP SECTION.
       INI-PRO-KEY-IMP.
*% INCLUDE INI_PRO_KEY_IMP OF 'COLBMIMP.TXT'
           PERFORM PRO-MKY-IMP.
*% INCLUDE FIN_PRO_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-PRO-KEY-IMP.
           EXIT.
       
       PRO-MKY-IMP SECTION.
       INI-PRO-MKY-IMP.
*% INCLUDE INI_PRO_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_PRO_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-PRO-MKY-IMP.
           EXIT.
       
       PRO-FLD-IMP SECTION.
       INI-PRO-FLD-IMP.
*% INCLUDE INI_PRO_FLD_IMP OF 'COLBMIMP.TXT'
           PERFORM PRO-IMP-IMP.
*% INCLUDE FIN_PRO_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-PRO-FLD-IMP.
           EXIT.
       
       PRO-IMP-IMP SECTION.
       INI-PRO-IMP-IMP.
*% INCLUDE INI_PRO_IMP_IMP OF 'COLBMIMP.TXT'
           MOVE FRM-CPIM-AEY TO IMP-CIC-IMPU-ATR IN IMP-FLD.
           MOVE FRM-CPIM-AEY TO IMP-IND-VIGE-ATR IN IMP-FLD.
           MOVE FRM-CPIM-AEY TO IMP-VAL-TIMP-ATR IN IMP-FLD.
           MOVE FRM-CPIM-AEY TO IMP-VAL-TOPE-ATR IN IMP-FLD.
*% INCLUDE FIN_PRO_IMP_IMP OF 'COLBMIMP.TXT'
       FIN-PRO-IMP-IMP.
           EXIT.
       
       UNP-KEY-IMP SECTION.
       INI-UNP-KEY-IMP.
*% INCLUDE INI_UNP_KEY_IMP OF 'COLBMIMP.TXT'
           PERFORM UNP-IKY-IMP.
           PERFORM UNP-AKY-IMP.
           PERFORM UNP-MKY-IMP.
*% INCLUDE FIN_UNP_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-KEY-IMP.
           EXIT.
       
       UNP-IKY-IMP SECTION.
       INI-UNP-IKY-IMP.
*% INCLUDE INI_UNP_IKY_IMP OF 'COLBMIMP.TXT'
           MOVE FRM-CPIM-UBY TO IMP-COD-TDOC-ATR.
           MOVE FRM-CPIM-UBY TO IMP-MSC-TIMP-ATR.
*% INCLUDE FIN_UNP_IKY_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-IKY-IMP.
           EXIT.
       
       UNP-MKY-IMP SECTION.
       INI-UNP-MKY-IMP.
*% INCLUDE INI_UNP_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_UNP_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-MKY-IMP.
           EXIT.
       
       UNP-AKY-IMP SECTION.
       INI-UNP-AKY-IMP.
*% INCLUDE INI_UNP_AKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_UNP_AKY_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-AKY-IMP.
           EXIT.
       
       UNP-FLD-IMP SECTION.
       INI-UNP-FLD-IMP.
*% INCLUDE INI_UNP_FLD_IMP OF 'COLBMIMP.TXT'
           PERFORM UNP-IMP-IMP.
*% INCLUDE FIN_UNP_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-FLD-IMP.
           EXIT.
       
       UNP-IMP-IMP SECTION.
       INI-UNP-IMP-IMP.
*% INCLUDE INI_UNP_IMP_IMP OF 'COLBMIMP.TXT'
           MOVE FRM-CPIM-UBY TO IMP-CIC-IMPU-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-IND-VIGE-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-VAL-TIMP-ATR IN IMP-FLD.
           MOVE FRM-CPIM-UBY TO IMP-VAL-TOPE-ATR IN IMP-FLD.
*% INCLUDE FIN_UNP_IMP_IMP OF 'COLBMIMP.TXT'
       FIN-UNP-IMP-IMP.
           EXIT.
       
       VAL-MKY-IMP SECTION.
       INI-VAL-MKY-IMP.
*% INCLUDE INI_VAL_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_VAL_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-MKY-IMP.
           EXIT.
       
       VAL-FLD-IMP SECTION.
       INI-VAL-FLD-IMP.
*% INCLUDE INI_VAL_FLD_IMP OF 'COLBMIMP.TXT'
           PERFORM VAL-FRM-GLS-TDOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TDOC-LEN IN IMP-FLD
                GO TO FIN-VAL-FLD-IMP.
           PERFORM VAL-FRM-GLS-TIMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TIMP-LEN IN IMP-FLD
                GO TO FIN-VAL-FLD-IMP.
           PERFORM VAL-IMP-CIC-IMPU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IMP-CIC-IMPU-LEN IN IMP-FLD
                GO TO FIN-VAL-FLD-IMP.
           PERFORM VAL-IMP-IND-VIGE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IMP-IND-VIGE-LEN IN IMP-FLD
                GO TO FIN-VAL-FLD-IMP.
*% RREG = "IMP"
*% RREG_FRM = "IMP"
*% NOMB = "FTRN"
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IMP-FEC-FTRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                IMP-FEC-FTRN-LEN IN IMP-FLD
                GO TO FIN-VAL-FLD-IMP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IMP-VAL-TIMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IMP-VAL-TIMP-LEN IN IMP-FLD
                GO TO FIN-VAL-FLD-IMP.
           PERFORM VAL-IMP-VAL-TOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IMP-VAL-TOPE-LEN IN IMP-FLD
                GO TO FIN-VAL-FLD-IMP.
*% INCLUDE FIN_VAL_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-FLD-IMP.
           EXIT.
       
       VAL-FRM-GLS-TDOC SECTION.
       INI-VAL-FRM-GLS-TDOC.
*% LBL = "FRM_GLS_TDOC OF 'COLBMIMP.TXT'"
*% INCLUDE INI_FRM_GLS_TDOC OF 'COLBMIMP.TXT'
*% INCLUDE FRM_GLS_TDOC OF 'COLBMIMP.TXT'
*% INCLUDE FIN_FRM_GLS_TDOC OF 'COLBMIMP.TXT'
       FIN-VAL-FRM-GLS-TDOC.
           EXIT.
       
       VAL-FRM-GLS-TIMP SECTION.
       INI-VAL-FRM-GLS-TIMP.
*% LBL = "FRM_GLS_TIMP OF 'COLBMIMP.TXT'"
*% INCLUDE INI_FRM_GLS_TIMP OF 'COLBMIMP.TXT'
*% INCLUDE FRM_GLS_TIMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_FRM_GLS_TIMP OF 'COLBMIMP.TXT'
       FIN-VAL-FRM-GLS-TIMP.
           EXIT.
       
       VAL-IMP-CIC-IMPU SECTION.
       INI-VAL-IMP-CIC-IMPU.
*% LBL = "IMP_CIC_IMPU OF 'COLBMIMP.TXT'"
*% INCLUDE INI_IMP_CIC_IMPU OF 'COLBMIMP.TXT'
           IF IMP-CIC-IMPU IN IMP-FLD NOT > SPACES
              MOVE SPACES TO IMP-CIC-IMPU IN IMP-FLD.
*% INCLUDE IMP_CIC_IMPU OF 'COLBMIMP.TXT'
*% INCLUDE FIN_IMP_CIC_IMPU OF 'COLBMIMP.TXT'
       FIN-VAL-IMP-CIC-IMPU.
           EXIT.
       
       VAL-IMP-IND-VIGE SECTION.
       INI-VAL-IMP-IND-VIGE.
*% LBL = "IMP_IND_VIGE OF 'COLBMIMP.TXT'"
*% INCLUDE INI_IMP_IND_VIGE OF 'COLBMIMP.TXT'
           IF IMP-IND-VIGE IN IMP-FLD NOT > SPACES
              MOVE SPACES TO IMP-IND-VIGE IN IMP-FLD.
*% INCLUDE IMP_IND_VIGE OF 'COLBMIMP.TXT'
*% BUF = "IMP-FLD"
*% SIS = "GNS"
*% TAB = "VIGE"
*% FLD = "IMP-IND-VIGE"
*% GLS = ""
*% TIENE_GLOSA = FALSE
*% LGL = 0
*% INCLUDE 'VALIND'
*% INCLUDE FIN_IMP_IND_VIGE OF 'COLBMIMP.TXT'
       FIN-VAL-IMP-IND-VIGE.
           EXIT.
*% RREG = "IMP"
*% RREG_FRM = "IMP"
*% NOMB = "FTRN"
*% OBL = "S"
*% LBL = "IMP_FEC_FTRN OF 'COLBMIMP.TXT'"
*% IZR = "S"
*% ZRO = "S"
*% FRM_IFLD = ""
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-IMP-FEC-FTRN SECTION.
       INI-VAL-IMP-FEC-FTRN.
           IF IMP-FEC-FTRN IN IMP-FLD  NOT > ZEROES
              MOVE ZEROES TO IMP-FEC-FTRN IN IMP-FLD.
*% INCLUDE INI_IMP_FEC_FTRN OF 'COLBMIMP.TXT'
*% INCLUDE IMP_FEC_FTRN OF 'COLBMIMP.TXT'
*% INCLUDE FIN_IMP_FEC_FTRN OF 'COLBMIMP.TXT'
       FIN-VAL-IMP-FEC-FTRN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-IMP-VAL-TIMP SECTION.
       INI-VAL-IMP-VAL-TIMP.
*% LBL = "IMP_VAL_TIMP OF 'COLBMIMP.TXT'"
*% INCLUDE INI_IMP_VAL_TIMP OF 'COLBMIMP.TXT'
*% INCLUDE IMP_VAL_TIMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_IMP_VAL_TIMP OF 'COLBMIMP.TXT'
       FIN-VAL-IMP-VAL-TIMP.
           EXIT.
       
       VAL-IMP-VAL-TOPE SECTION.
       INI-VAL-IMP-VAL-TOPE.
*% LBL = "IMP_VAL_TOPE OF 'COLBMIMP.TXT'"
*% INCLUDE INI_IMP_VAL_TOPE OF 'COLBMIMP.TXT'
*% INCLUDE IMP_VAL_TOPE OF 'COLBMIMP.TXT'
*% INCLUDE FIN_IMP_VAL_TOPE OF 'COLBMIMP.TXT'
       FIN-VAL-IMP-VAL-TOPE.
           EXIT.
       
       VAL-CON-FLD-IMP SECTION.
       INI-VAL-CON-FLD-IMP.
*% INCLUDE VAL_CON_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-CON-FLD-IMP.
           EXIT.
       
       VAL-CON-IMP SECTION.
       INI-VAL-CON-IMP.
*% INCLUDE VAL_CON_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-CON-IMP.
           EXIT.
       
       VAL-NUM-KEY-IMP SECTION.
       INI-VAL-NUM-KEY-IMP.
           PERFORM VAL-NUM-IKY-IMP.
           PERFORM VAL-NUM-MKY-IMP.
           PERFORM VAL-NUM-AKY-IMP.
       FIN-VAL-NUM-KEY-IMP.
           EXIT.
       
       VAL-NUM-IKY-IMP SECTION.
       INI-VAL-NUM-IKY-IMP.
*% INCLUDE INI_VAL_NUM_IKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_VAL_NUM_IKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-NUM-IKY-IMP.
           EXIT.
       
       VAL-NUM-MKY-IMP SECTION.
       INI-VAL-NUM-MKY-IMP.
*% INCLUDE INI_VAL_NUM_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_VAL_NUM_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-NUM-MKY-IMP.
           EXIT.
       
       VAL-NUM-AKY-IMP SECTION.
       INI-VAL-NUM-AKY-IMP.
*% INCLUDE INI_VAL_NUM_AKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_VAL_NUM_AKY_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-NUM-AKY-IMP.
           EXIT.
       
       VAL-NUM-FLD-IMP SECTION.
       INI-VAL-NUM-FLD-IMP.
*% INCLUDE INI_VAL_NUM_FLD_IMP OF 'COLBMIMP.TXT'
       VAL-NUM-IMP-VAL-TIMP.
*% BUF = "IMP-FLD"
*% FLD = "IMP-VAL-TIMP"
*% ENT = "2"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-IMP.
       VAL-NUM-IMP-VAL-TOPE.
*% BUF = "IMP-FLD"
*% FLD = "IMP-VAL-TOPE"
*% ENT = "2"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-IMP.
*% INCLUDE FIN_VAL_NUM_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-VAL-NUM-FLD-IMP.
           EXIT.
       
       EDT-KEY-IMP SECTION.
       INI-EDT-KEY-IMP.
           PERFORM EDT-IKY-IMP.
           PERFORM EDT-MKY-IMP.
           PERFORM EDT-AKY-IMP.
*% INCLUDE EDT_KEY_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-KEY-IMP.
           EXIT.
       
       EDT-IKY-IMP SECTION.
       INI-EDT-IKY-IMP.
*% INCLUDE EDT_IKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_EDT_IKY_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-IKY-IMP.
           EXIT.
       
       EDT-MKY-IMP SECTION.
       INI-EDT-MKY-IMP.
*% INCLUDE EDT_MKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_EDT_MKY_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-MKY-IMP.
           EXIT.
       
       EDT-AKY-IMP SECTION.
       INI-EDT-AKY-IMP.
*% INCLUDE EDT_AKY_IMP OF 'COLBMIMP.TXT'
*% INCLUDE FIN_EDT_AKY_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-AKY-IMP.
           EXIT.
       
       EDT-FLD-IMP SECTION.
       INI-EDT-FLD-IMP.
*% INCLUDE EDT_FLD_IMP OF 'COLBMIMP.TXT'
*% RREG = "IMP"
*% RREG_FRM = "IMP"
*% NOMB = "FTRN"
           IF IMP-VAL-TIMP-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-VAL-TIMP-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-VAL-TIMP IN IMP-FLD TO IMP-VAL-TIMP-EDT IN IMP-EDT.
           MOVE IMP-VAL-TIMP-EDT IN IMP-EDT TO 
                IMP-VAL-TIMP-ALF IN IMP-FLD.
           IF IMP-VAL-TOPE-LEN IN IMP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IMP-VAL-TOPE-LEN IN IMP-FLD
                GO TO FIN-EDT-FLD-IMP.
           MOVE IMP-VAL-TOPE IN IMP-FLD TO IMP-VAL-TOPE-EDT IN IMP-EDT.
           MOVE IMP-VAL-TOPE-EDT IN IMP-EDT TO 
                IMP-VAL-TOPE-ALF IN IMP-FLD.
*% INCLUDE FIN_EDT_FLD_IMP OF 'COLBMIMP.TXT'
       FIN-EDT-FLD-IMP.
           EXIT.
*% INCLUDE EOF_BU OF 'COLBMIMP.TXT'
*% INCLUDE EOF OF 'COLBMIMP.TXT'
*% INCLUDE EOF_IBM OF 'COLBMIMP.TXT'
