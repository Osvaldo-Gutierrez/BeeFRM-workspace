      *
      * COLBQLO2
      * Version 3.0.1 Nov-2005
      * 28-Oct-19 09:06 PM
      *
*% INI_LBL = TRUE
*% PGM_BQ = TRUE
*% FRM = "LO2"
*% PGM_BQ = TRUE
*% INCLUDE SETTAG OF 'COLBMLO2.TXT'
       SET-TAG-COLBQLO2 SECTION.
       INI-SET-TAG-COLBQLO2.
           MOVE
           '<IDNMOD NOM=$COLBQLO2$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$28-Oct-19 09:06 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBQLO2.
           EXIT.
           
       PUT-ALL-LO2 SECTION.
       INI-PUT-ALL-LO2.
*% INCLUDE INI_PUT_ALL_LO2 OF 'COLBMLO2.TXT'
           PERFORM PUT-LAP-LO2.
           PERFORM PUT-POC-LO2.
*% INCLUDE FIN_PUT_ALL_LO2 OF 'COLBMLO2.TXT'
       FIN-PUT-ALL-LO2.
           EXIT.
       
       PUT-LAP-LO2 SECTION.
       INI-PUT-LAP-LO2.
*% INCLUDE INI_PUT_LAP_LO2 OF 'COLBMLO2.TXT'
           IF PGM-STAT-LAP-NUL
               GO TO FIN-PUT-LAP-LO2.
           IF NOT PGM-STAT-LAP-OKS
               PERFORM CLR-LAP-LO2
               GO TO FIN-PUT-LAP-LO2.
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE LAP-NUM-DLAP IN LAP TO LAP-NUM-DLAP IN LO2-FLD.
           MOVE LAP-NUM-MLAP IN LAP TO LAP-NUM-MLAP IN LO2-FLD.
           MOVE LAP-NUM-SLAP IN LAP TO LAP-NUM-SLAP IN LO2-FLD.
           MOVE LAP-NUM-ALAP IN LAP TO LAP-NUM-ALAP IN LO2-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE LAP-HRA-HLAP IN LAP TO LAP-HRA-HLAP IN LO2-FLD.
           MOVE LAP-COD-KLAP IN LAP TO LAP-COD-KLAP IN LO2-FLD.
           MOVE LAP-COD-AUTO IN LAP TO LAP-COD-AUTO IN LO2-FLD.
           MOVE LAP-COD-COME IN LAP TO LAP-COD-COME IN LO2-FLD.
           MOVE LAP-COD-CMND IN LAP TO LAP-COD-CMND IN LO2-FLD.
           MOVE LAP-COD-OTRN IN LAP TO LAP-COD-OTRN IN LO2-FLD.
           MOVE LAP-NUM-CLAP IN LAP TO LAP-NUM-CLAP IN LO2-FLD.
*% INCLUDE FIN_PUT_LAP_LO2 OF 'COLBMLO2.TXT'
       FIN-PUT-LAP-LO2.
           EXIT.
       
       PUT-POC-LO2 SECTION.
       INI-PUT-POC-LO2.
*% INCLUDE INI_PUT_POC_LO2 OF 'COLBMLO2.TXT'
           IF PGM-STAT-POC-NUL
               GO TO FIN-PUT-POC-LO2.
           IF NOT PGM-STAT-POC-OKS
               PERFORM CLR-POC-LO2
               GO TO FIN-PUT-POC-LO2.
           MOVE POC-MSC-STAT IN POC TO POC-MSC-STAT IN LO2-FLD.
           MOVE POC-MSC-MIPL IN POC TO POC-MSC-MIPL IN LO2-FLD.
           MOVE POC-COD-CDOC IN POC TO POC-COD-CDOC IN LO2-FLD.
           MOVE POC-COD-NAPR IN POC TO POC-COD-NAPR IN LO2-FLD.
           MOVE POC-IND-GARA IN POC TO POC-IND-GARA IN LO2-FLD.
           MOVE POC-COD-NCUR IN POC TO POC-COD-NCUR IN LO2-FLD.
           MOVE POC-MSC-TCVE IN POC TO POC-MSC-TCVE IN LO2-FLD.
           MOVE POC-IND-AFER IN POC TO POC-IND-AFER IN LO2-FLD.
           MOVE POC-COD-ACTI IN POC TO POC-COD-ACTI IN LO2-FLD.
           MOVE POC-COD-COTO IN POC TO POC-COD-COTO IN LO2-FLD.
           MOVE POC-IND-TABO IN POC TO POC-IND-TABO IN LO2-FLD.
           MOVE POC-NUM-MINC IN POC TO POC-NUM-MINC IN LO2-FLD.
           MOVE POC-NUM-MINI IN POC TO POC-NUM-MINI IN LO2-FLD.
           MOVE POC-IND-MINC IN POC TO POC-IND-MINC IN LO2-FLD.
           MOVE POC-IND-MINI IN POC TO POC-IND-MINI IN LO2-FLD.
           MOVE POC-NUM-MAXC IN POC TO POC-NUM-MAXC IN LO2-FLD.
           MOVE POC-NUM-MAXI IN POC TO POC-NUM-MAXI IN LO2-FLD.
           MOVE POC-IND-MAXC IN POC TO POC-IND-MAXC IN LO2-FLD.
           MOVE POC-IND-MAXI IN POC TO POC-IND-MAXI IN LO2-FLD.
           MOVE POC-IND-LIQI IN POC TO POC-IND-LIQI IN LO2-FLD.
           MOVE POC-IND-ECDC IN POC TO POC-IND-ECDC IN LO2-FLD.
           MOVE POC-COD-IPVC IN POC TO POC-COD-IPVC IN LO2-FLD.
           MOVE POC-COD-TPAG IN POC TO POC-COD-TPAG IN LO2-FLD.
*% INCLUDE FIN_PUT_POC_LO2 OF 'COLBMLO2.TXT'
       FIN-PUT-POC-LO2.
           EXIT.
       
       KEY-ALL-LO2 SECTION.
       INI-KEY-ALL-LO2.
*% INCLUDE INI_KEY_ALL_LO2 OF 'COLBMLO2.TXT'
           PERFORM KEY-LAP-LO2.
           PERFORM KEY-POC-LO2.
*% INCLUDE FIN_KEY_ALL_LO2 OF 'COLBMLO2.TXT'
       FIN-KEY-ALL-LO2.
           EXIT.
       
       KEY-LAP-LO2 SECTION.
       INI-KEY-LAP-LO2.
*% INCLUDE INI_KEY_LAP_LO2 OF 'COLBMLO2.TXT'
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LAP-NUM-DLAP IN LO2-FLD TO LAP-NUM-DLAP IN LAP.
           MOVE LAP-NUM-MLAP IN LO2-FLD TO LAP-NUM-MLAP IN LAP.
           MOVE LAP-NUM-SLAP IN LO2-FLD TO LAP-NUM-SLAP IN LAP.
           MOVE LAP-NUM-ALAP IN LO2-FLD TO LAP-NUM-ALAP IN LAP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LAP-HRA-HLAP IN LO2-FLD TO LAP-HRA-HLAP IN LAP.
           MOVE LAP-COD-KLAP IN LO2-FLD TO LAP-COD-KLAP IN LAP.
           MOVE LAP-COD-AUTO IN LO2-FLD TO LAP-COD-AUTO IN LAP.
           MOVE LAP-NUM-CLAP IN LO2-FLD TO LAP-NUM-CLAP IN LAP.
*% INCLUDE FIN_KEY_LAP_LO2 OF 'COLBMLO2.TXT'
       FIN-KEY-LAP-LO2.
           EXIT.
       
       KEY-POC-LO2 SECTION.
       INI-KEY-POC-LO2.
*% INCLUDE INI_KEY_POC_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_KEY_POC_LO2 OF 'COLBMLO2.TXT'
       FIN-KEY-POC-LO2.
           EXIT.
       
       SCR-CLRA-LO2 SECTION.
       INI-SCR-CLRA-LO2.
*% INCLUDE INI_SCR_CLRA_LO2 OF 'COLBMLO2.TXT'
           PERFORM CLR-KEY-LO2.
           PERFORM CLR-FLD-LO2.
*% INCLUDE FIN_SCR_CLRA_LO2 OF 'COLBMLO2.TXT'
       FIN-SCR-CLRA-LO2.
           EXIT.
       
       CLR-KEY-LO2 SECTION.
       INI-CLR-KEY-LO2.
*% INCLUDE INI_CLR_KEY_LO2 OF 'COLBMLO2.TXT'
           MOVE SPACES TO FRM-COD-CREB IN LO2-FLD.
           MOVE SPACES TO FRM-IND-NEXT IN LO2-FLD.
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LAP-FEC-FLAP IN LO2-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LAP-HRA-HLAP IN LO2-FLD.
           MOVE SPACES TO LAP-COD-KLAP IN LO2-FLD.
           MOVE SPACES TO LAP-COD-AUTO IN LO2-FLD.
           MOVE ZEROES TO LAP-NUM-CLAP IN LO2-FLD.
*% INCLUDE FIN_CLR_KEY_LO2 OF 'COLBMLO2.TXT'
       FIN-CLR-KEY-LO2.
           EXIT.
       
       CLR-FLD-LO2 SECTION.
       INI-CLR-FLD-LO2.
*% INCLUDE INI_CLR_FLD_LO2 OF 'COLBMLO2.TXT'
           MOVE SPACES TO FRM-GLS-INST IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX01 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX02 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX03 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX04 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX05 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX06 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX07 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX08 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX09 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX10 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX11 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX12 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX13 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX14 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX15 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX16 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX17 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX18 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX19 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX20 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX21 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX22 IN LO2-FLD.
           MOVE SPACES TO FRM-GLS-TX23 IN LO2-FLD.
           PERFORM CLR-LAP-LO2.
           PERFORM CLR-POC-LO2.
*% INCLUDE FIN_CLR_FLD_LO2 OF 'COLBMLO2.TXT'
       FIN-CLR-FLD-LO2.
           EXIT.
       
       CLR-LAP-LO2 SECTION.
       INI-CLR-LAP-LO2.
*% INCLUDE INI_CLR_LAP_LO2 OF 'COLBMLO2.TXT'
           MOVE SPACES TO LAP-COD-COME IN LO2-FLD.
           MOVE SPACES TO LAP-COD-CMND IN LO2-FLD.
           MOVE SPACES TO LAP-COD-OTRN IN LO2-FLD.
*% INCLUDE FIN_CLR_LAP_LO2 OF 'COLBMLO2.TXT'
       FIN-CLR-LAP-LO2.
           EXIT.
       
       CLR-POC-LO2 SECTION.
       INI-CLR-POC-LO2.
*% INCLUDE INI_CLR_POC_LO2 OF 'COLBMLO2.TXT'
           MOVE SPACES TO POC-MSC-STAT IN LO2-FLD.
           MOVE SPACES TO POC-MSC-MIPL IN LO2-FLD.
           MOVE SPACES TO POC-COD-CDOC IN LO2-FLD.
           MOVE SPACES TO POC-COD-NAPR IN LO2-FLD.
           MOVE SPACES TO POC-IND-GARA IN LO2-FLD.
           MOVE SPACES TO POC-COD-NCUR IN LO2-FLD.
           MOVE SPACES TO POC-MSC-TCVE IN LO2-FLD.
           MOVE SPACES TO POC-IND-AFER IN LO2-FLD.
           MOVE SPACES TO POC-COD-ACTI IN LO2-FLD.
           MOVE SPACES TO POC-COD-COTO IN LO2-FLD.
           MOVE SPACES TO POC-IND-TABO IN LO2-FLD.
           MOVE ZEROES TO POC-NUM-MINC IN LO2-FLD.
           MOVE ZEROES TO POC-NUM-MINI IN LO2-FLD.
           MOVE SPACES TO POC-IND-MINC IN LO2-FLD.
           MOVE SPACES TO POC-IND-MINI IN LO2-FLD.
           MOVE ZEROES TO POC-NUM-MAXC IN LO2-FLD.
           MOVE ZEROES TO POC-NUM-MAXI IN LO2-FLD.
           MOVE SPACES TO POC-IND-MAXC IN LO2-FLD.
           MOVE SPACES TO POC-IND-MAXI IN LO2-FLD.
           MOVE SPACES TO POC-IND-LIQI IN LO2-FLD.
           MOVE SPACES TO POC-IND-ECDC IN LO2-FLD.
           MOVE SPACES TO POC-COD-IPVC IN LO2-FLD.
           MOVE SPACES TO POC-COD-TPAG IN LO2-FLD.
*% INCLUDE FIN_CLR_POC_LO2 OF 'COLBMLO2.TXT'
       FIN-CLR-POC-LO2.
           EXIT.
       
       FST-KEY-LO2 SECTION.
       INI-FST-KEY-LO2.
*% INCLUDE INI_FST_KEY_LO2 OF 'COLBMLO2.TXT'
           MOVE -1 TO FRM-COD-CREB-LEN IN LO2-FLD.
*% INCLUDE FIN_FST_KEY_LO2 OF 'COLBMLO2.TXT'
       FIN-FST-KEY-LO2.
           EXIT.
       
       FST-FLD-LO2 SECTION.
       INI-FST-FLD-LO2.
*% INCLUDE INI_FST_FLD_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_FST_FLD_LO2 OF 'COLBMLO2.TXT'
       FIN-FST-FLD-LO2.
           EXIT.
       
       PRO-KEY-LO2 SECTION.
       INI-PRO-KEY-LO2.
*% INCLUDE INI_PRO_KEY_LO2 OF 'COLBMLO2.TXT'
           MOVE FRM-CPIM-AEY TO FRM-COD-CREB-ATR IN LO2-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-NEXT-ATR IN LO2-FLD.
           PERFORM PRO-IKY-LO2.
           PERFORM PRO-AKY-LO2.
           PERFORM PRO-MKY-LO2.
*% INCLUDE FIN_PRO_KEY_LO2 OF 'COLBMLO2.TXT'
       FIN-PRO-KEY-LO2.
           EXIT.
       
       PRO-IKY-LO2 SECTION.
       INI-PRO-IKY-LO2.
*% INCLUDE INI_PRO_IKY_LO2 OF 'COLBMLO2.TXT'
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
           MOVE FRM-CPIM-AEY TO LAP-FEC-FLAP-ATR IN LO2-FLD.
           MOVE FRM-CPIM-AEY TO LAP-HRA-HLAP-ATR IN LO2-FLD.
           MOVE FRM-CPIM-AEY TO LAP-COD-KLAP-ATR IN LO2-FLD.
           MOVE FRM-CPIM-AEY TO LAP-COD-AUTO-ATR IN LO2-FLD.
*% INCLUDE FIN_PRO_IKY_LO2 OF 'COLBMLO2.TXT'
       FIN-PRO-IKY-LO2.
           EXIT.
       
       PRO-MKY-LO2 SECTION.
       INI-PRO-MKY-LO2.
*% INCLUDE INI_PRO_MKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_PRO_MKY_LO2 OF 'COLBMLO2.TXT'
       FIN-PRO-MKY-LO2.
           EXIT.
       
       PRO-AKY-LO2 SECTION.
       INI-PRO-AKY-LO2.
*% INCLUDE INI_PRO_AKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_PRO_AKY_LO2 OF 'COLBMLO2.TXT'
       FIN-PRO-AKY-LO2.
           EXIT.
       
       UNP-KEY-LO2 SECTION.
       INI-UNP-KEY-LO2.
*% INCLUDE INI_UNP_KEY_LO2 OF 'COLBMLO2.TXT'
           MOVE FRM-CPIM-UBY TO FRM-COD-CREB-ATR IN LO2-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-NEXT-ATR IN LO2-FLD.
           PERFORM UNP-IKY-LO2.
           PERFORM UNP-AKY-LO2.
           PERFORM UNP-MKY-LO2.
*% INCLUDE FIN_UNP_KEY_LO2 OF 'COLBMLO2.TXT'
       FIN-UNP-KEY-LO2.
           EXIT.
       
       UNP-IKY-LO2 SECTION.
       INI-UNP-IKY-LO2.
*% INCLUDE INI_UNP_IKY_LO2 OF 'COLBMLO2.TXT'
           MOVE FRM-CPIM-UBY TO FRM-COD-CREB-ATR.
           MOVE FRM-CPIM-UBY TO FRM-IND-NEXT-ATR.
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
           MOVE FRM-CPIM-UBY TO LAP-FEC-FLAP-ATR IN LO2-FLD.
           MOVE FRM-CPIM-UBY TO LAP-HRA-HLAP-ATR.
           MOVE FRM-CPIM-UBY TO LAP-COD-KLAP-ATR.
           MOVE FRM-CPIM-UBY TO LAP-COD-AUTO-ATR.
*% INCLUDE FIN_UNP_IKY_LO2 OF 'COLBMLO2.TXT'
       FIN-UNP-IKY-LO2.
           EXIT.
       
       UNP-MKY-LO2 SECTION.
       INI-UNP-MKY-LO2.
*% INCLUDE INI_UNP_MKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_UNP_MKY_LO2 OF 'COLBMLO2.TXT'
       FIN-UNP-MKY-LO2.
           EXIT.
       
       UNP-AKY-LO2 SECTION.
       INI-UNP-AKY-LO2.
*% INCLUDE INI_UNP_AKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_UNP_AKY_LO2 OF 'COLBMLO2.TXT'
       FIN-UNP-AKY-LO2.
           EXIT.
       
       UNP-FLD-LO2 SECTION.
       INI-UNP-FLD-LO2.
*% INCLUDE INI_UNP_FLD_LO2 OF 'COLBMLO2.TXT'
           PERFORM UNP-LAP-LO2.
           PERFORM UNP-POC-LO2.
*% INCLUDE FIN_UNP_FLD_LO2 OF 'COLBMLO2.TXT'
       FIN-UNP-FLD-LO2.
           EXIT.
       
       UNP-LAP-LO2 SECTION.
       INI-UNP-LAP-LO2.
*% INCLUDE INI_UNP_LAP_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_UNP_LAP_LO2 OF 'COLBMLO2.TXT'
       FIN-UNP-LAP-LO2.
           EXIT.
       
       UNP-POC-LO2 SECTION.
       INI-UNP-POC-LO2.
*% INCLUDE INI_UNP_POC_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_UNP_POC_LO2 OF 'COLBMLO2.TXT'
       FIN-UNP-POC-LO2.
           EXIT.
       
       VAL-KEY-LO2 SECTION.
       INI-VAL-KEY-LO2.
           PERFORM VAL-IKY-LO2.
           PERFORM VAL-MKY-LO2.
           PERFORM VAL-AKY-LO2.
       FIN-VAL-KEY-LO2.
           EXIT.
       
       VAL-IKY-LO2 SECTION.
       INI-VAL-IKY-LO2.
*% INCLUDE INI_VAL_IKY_LO2 OF 'COLBMLO2.TXT'
           PERFORM VAL-FRM-COD-CREB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-CREB-LEN IN LO2-FLD
                GO TO FIN-VAL-IKY-LO2.
           PERFORM VAL-FRM-IND-NEXT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-NEXT-LEN IN LO2-FLD
                GO TO FIN-VAL-IKY-LO2.
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LAP-FEC-FLAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LAP-FEC-FLAP-LEN IN LO2-FLD
                GO TO FIN-VAL-IKY-LO2.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LAP-HRA-HLAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LAP-HRA-HLAP-LEN IN LO2-FLD
                GO TO FIN-VAL-IKY-LO2.
           PERFORM VAL-LAP-COD-KLAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LAP-COD-KLAP-LEN IN LO2-FLD
                GO TO FIN-VAL-IKY-LO2.
           PERFORM VAL-LAP-COD-AUTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LAP-COD-AUTO-LEN IN LO2-FLD
                GO TO FIN-VAL-IKY-LO2.
           PERFORM VAL-LAP-NUM-CLAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LAP-NUM-CLAP-LEN IN LO2-FLD
                GO TO FIN-VAL-IKY-LO2.
*% INCLUDE FIN_VAL_IKY_LO2 OF 'COLBMLO2.TXT'
       FIN-VAL-IKY-LO2.
           EXIT.
       
       VAL-MKY-LO2 SECTION.
       INI-VAL-MKY-LO2.
*% INCLUDE INI_VAL_MKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_VAL_MKY_LO2 OF 'COLBMLO2.TXT'
       FIN-VAL-MKY-LO2.
           EXIT.
       
       VAL-AKY-LO2 SECTION.
       INI-VAL-AKY-LO2.
*% INCLUDE INI_VAL_AKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_VAL_AKY_LO2 OF 'COLBMLO2.TXT'
       FIN-VAL-AKY-LO2.
           EXIT.
       
       VAL-FRM-COD-CREB SECTION.
       INI-VAL-FRM-COD-CREB.
*% LBL = "FRM_COD_CREB OF 'COLBMLO2.TXT'"
*% INCLUDE INI_FRM_COD_CREB OF 'COLBMLO2.TXT'
           IF FRM-COD-CREB IN LO2-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-CREB IN LO2-FLD.
*% INCLUDE FRM_COD_CREB OF 'COLBMLO2.TXT'
*% INCLUDE FIN_FRM_COD_CREB OF 'COLBMLO2.TXT'
       FIN-VAL-FRM-COD-CREB.
           EXIT.
       
       VAL-FRM-IND-NEXT SECTION.
       INI-VAL-FRM-IND-NEXT.
*% LBL = "FRM_IND_NEXT OF 'COLBMLO2.TXT'"
*% INCLUDE INI_FRM_IND_NEXT OF 'COLBMLO2.TXT'
           IF FRM-IND-NEXT IN LO2-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-NEXT IN LO2-FLD.
*% INCLUDE FRM_IND_NEXT OF 'COLBMLO2.TXT'
*% INCLUDE FIN_FRM_IND_NEXT OF 'COLBMLO2.TXT'
       FIN-VAL-FRM-IND-NEXT.
           EXIT.
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
*% OBL = "S"
*% LBL = "LAP_FEC_FLAP OF 'COLBMLO2.TXT'"
*% IZR = "S"
*% ZRO = "S"
*% BUF = "LO2-FLD"
*% FLD = "LAP-FEC-FLAP"
*% SN  = "S"
*% HOY = "LE"
*% HBL = "S"
*% TIPO = "FEC"
*% FRM_IFLD = ""
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LAP-FEC-FLAP SECTION.
       INI-VAL-LAP-FEC-FLAP.
           IF LAP-FEC-FLAP IN LO2-FLD  NOT > ZEROES
              MOVE ZEROES TO LAP-FEC-FLAP IN LO2-FLD.
*% INCLUDE 'SETFEC'
*% INCLUDE INI_LAP_FEC_FLAP OF 'COLBMLO2.TXT'
*% INCLUDE 'PROFEC'
*% INCLUDE LAP_FEC_FLAP OF 'COLBMLO2.TXT'
*% INCLUDE FIN_LAP_FEC_FLAP OF 'COLBMLO2.TXT'
       FIN-VAL-LAP-FEC-FLAP.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-LAP-HRA-HLAP SECTION.
       INI-VAL-LAP-HRA-HLAP.
*% LBL = "LAP_HRA_HLAP OF 'COLBMLO2.TXT'"
*% INCLUDE INI_LAP_HRA_HLAP OF 'COLBMLO2.TXT'
*% INCLUDE LAP_HRA_HLAP OF 'COLBMLO2.TXT'
*% INCLUDE FIN_LAP_HRA_HLAP OF 'COLBMLO2.TXT'
       FIN-VAL-LAP-HRA-HLAP.
           EXIT.
       
       VAL-LAP-COD-KLAP SECTION.
       INI-VAL-LAP-COD-KLAP.
*% LBL = "LAP_COD_KLAP OF 'COLBMLO2.TXT'"
*% INCLUDE INI_LAP_COD_KLAP OF 'COLBMLO2.TXT'
           IF LAP-COD-KLAP IN LO2-FLD NOT > SPACES
              MOVE SPACES TO LAP-COD-KLAP IN LO2-FLD.
*% INCLUDE LAP_COD_KLAP OF 'COLBMLO2.TXT'
*% INCLUDE FIN_LAP_COD_KLAP OF 'COLBMLO2.TXT'
       FIN-VAL-LAP-COD-KLAP.
           EXIT.
       
       VAL-LAP-COD-AUTO SECTION.
       INI-VAL-LAP-COD-AUTO.
*% LBL = "LAP_COD_AUTO OF 'COLBMLO2.TXT'"
*% INCLUDE INI_LAP_COD_AUTO OF 'COLBMLO2.TXT'
           IF LAP-COD-AUTO IN LO2-FLD NOT > SPACES
              MOVE SPACES TO LAP-COD-AUTO IN LO2-FLD.
*% INCLUDE LAP_COD_AUTO OF 'COLBMLO2.TXT'
*% INCLUDE FIN_LAP_COD_AUTO OF 'COLBMLO2.TXT'
       FIN-VAL-LAP-COD-AUTO.
           EXIT.
       
       VAL-LAP-NUM-CLAP SECTION.
       INI-VAL-LAP-NUM-CLAP.
*% LBL = "LAP_NUM_CLAP OF 'COLBMLO2.TXT'"
*% INCLUDE INI_LAP_NUM_CLAP OF 'COLBMLO2.TXT'
*% INCLUDE LAP_NUM_CLAP OF 'COLBMLO2.TXT'
*% INCLUDE FIN_LAP_NUM_CLAP OF 'COLBMLO2.TXT'
       FIN-VAL-LAP-NUM-CLAP.
           EXIT.
       
       VAL-CON-KEY-LO2 SECTION.
       INI-VAL-CON-KEY-LO2.
*% INCLUDE INI_VAL_CON_KEY_LO2 OF 'COLBMLO2.TXT'
           IF     FRM-COD-CREB IN LO2-FLD NOT > SPACES 
              AND FRM-IND-NEXT IN LO2-FLD NOT > SPACES 
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
              AND LAP-FEC-FLAP IN LO2-FLD NOT > ZEROES
              AND LAP-HRA-HLAP IN LO2-FLD NOT > ZEROES 
              AND LAP-COD-KLAP IN LO2-FLD NOT > SPACES 
              AND LAP-COD-AUTO IN LO2-FLD NOT > SPACES 
              AND LAP-NUM-CLAP IN LO2-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-LO2.
*% INCLUDE FIN_VAL_CON_KEY_LO2 OF 'COLBMLO2.TXT'
       FIN-VAL-CON-KEY-LO2.
           EXIT.
       
       VAL-CON-IKY-LO2 SECTION.
       INI-VAL-CON-IKY-LO2.
*% INCLUDE INI_VAL_CON_IKY_LO2 OF 'COLBMLO2.TXT'
           IF     FRM-COD-CREB IN LO2-FLD NOT > SPACES 
              AND FRM-IND-NEXT IN LO2-FLD NOT > SPACES 
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
              AND LAP-FEC-FLAP IN LO2-FLD NOT > ZEROES
              AND LAP-HRA-HLAP IN LO2-FLD NOT > ZEROES 
              AND LAP-COD-KLAP IN LO2-FLD NOT > SPACES 
              AND LAP-COD-AUTO IN LO2-FLD NOT > SPACES 
              AND LAP-NUM-CLAP IN LO2-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-LO2.
*% INCLUDE FIN_VAL_CON_IKY_LO2 OF 'COLBMLO2.TXT'
       FIN-VAL-CON-IKY-LO2.
           EXIT.
       
       VAL-NUM-KEY-LO2 SECTION.
       INI-VAL-NUM-KEY-LO2.
           PERFORM VAL-NUM-IKY-LO2.
           PERFORM VAL-NUM-MKY-LO2.
           PERFORM VAL-NUM-AKY-LO2.
       FIN-VAL-NUM-KEY-LO2.
           EXIT.
       
       VAL-NUM-IKY-LO2 SECTION.
       INI-VAL-NUM-IKY-LO2.
*% INCLUDE INI_VAL_NUM_IKY_LO2 OF 'COLBMLO2.TXT'
       VAL-NUM-LAP-HRA-HLAP.
*% BUF = "LO2-FLD"
*% FLD = "LAP-HRA-HLAP"
*% ENT = "6"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-IKY-LO2.
       VAL-NUM-LAP-NUM-CLAP.
*% BUF = "LO2-FLD"
*% FLD = "LAP-NUM-CLAP"
*% ENT = "3"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-IKY-LO2.
*% INCLUDE FIN_VAL_NUM_IKY_LO2 OF 'COLBMLO2.TXT'
       FIN-VAL-NUM-IKY-LO2.
           EXIT.
       
       VAL-NUM-MKY-LO2 SECTION.
       INI-VAL-NUM-MKY-LO2.
*% INCLUDE INI_VAL_NUM_MKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_VAL_NUM_MKY_LO2 OF 'COLBMLO2.TXT'
       FIN-VAL-NUM-MKY-LO2.
           EXIT.
       
       VAL-NUM-AKY-LO2 SECTION.
       INI-VAL-NUM-AKY-LO2.
*% INCLUDE INI_VAL_NUM_AKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_VAL_NUM_AKY_LO2 OF 'COLBMLO2.TXT'
       FIN-VAL-NUM-AKY-LO2.
           EXIT.
       
       VAL-NUM-FLD-LO2 SECTION.
       INI-VAL-NUM-FLD-LO2.
*% INCLUDE INI_VAL_NUM_FLD_LO2 OF 'COLBMLO2.TXT'
       VAL-NUM-POC-NUM-MINC.
*% BUF = "LO2-FLD"
*% FLD = "POC-NUM-MINC"
*% ENT = "3"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-LO2.
       VAL-NUM-POC-NUM-MINI.
*% BUF = "LO2-FLD"
*% FLD = "POC-NUM-MINI"
*% ENT = "3"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-LO2.
       VAL-NUM-POC-NUM-MAXC.
*% BUF = "LO2-FLD"
*% FLD = "POC-NUM-MAXC"
*% ENT = "3"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-LO2.
       VAL-NUM-POC-NUM-MAXI.
*% BUF = "LO2-FLD"
*% FLD = "POC-NUM-MAXI"
*% ENT = "3"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-LO2.
*% INCLUDE FIN_VAL_NUM_FLD_LO2 OF 'COLBMLO2.TXT'
       FIN-VAL-NUM-FLD-LO2.
           EXIT.
       
       EDT-KEY-LO2 SECTION.
       INI-EDT-KEY-LO2.
           PERFORM EDT-IKY-LO2.
           PERFORM EDT-MKY-LO2.
           PERFORM EDT-AKY-LO2.
*% INCLUDE EDT_KEY_LO2 OF 'COLBMLO2.TXT'
       FIN-EDT-KEY-LO2.
           EXIT.
       
       EDT-IKY-LO2 SECTION.
       INI-EDT-IKY-LO2.
*% INCLUDE EDT_IKY_LO2 OF 'COLBMLO2.TXT'
*% RREG = "LAP"
*% RREG_FRM = "LAP"
*% NOMB = "FLAP"
           IF LAP-HRA-HLAP-LEN IN LO2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LAP-HRA-HLAP-LEN IN LO2-FLD
                GO TO FIN-EDT-IKY-LO2.
           MOVE LAP-HRA-HLAP IN LO2-FLD TO LAP-HRA-HLAP-EDT IN LO2-EDT.
           MOVE LAP-HRA-HLAP-EDT IN LO2-EDT TO 
                LAP-HRA-HLAP-ALF IN LO2-FLD.
           IF LAP-NUM-CLAP-LEN IN LO2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LAP-NUM-CLAP-LEN IN LO2-FLD
                GO TO FIN-EDT-IKY-LO2.
           MOVE LAP-NUM-CLAP IN LO2-FLD TO LAP-NUM-CLAP-EDT IN LO2-EDT.
           MOVE LAP-NUM-CLAP-EDT IN LO2-EDT TO 
                LAP-NUM-CLAP-ALF IN LO2-FLD.
*% INCLUDE FIN_EDT_IKY_LO2 OF 'COLBMLO2.TXT'
       FIN-EDT-IKY-LO2.
           EXIT.
       
       EDT-MKY-LO2 SECTION.
       INI-EDT-MKY-LO2.
*% INCLUDE EDT_MKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_EDT_MKY_LO2 OF 'COLBMLO2.TXT'
       FIN-EDT-MKY-LO2.
           EXIT.
       
       EDT-AKY-LO2 SECTION.
       INI-EDT-AKY-LO2.
*% INCLUDE EDT_AKY_LO2 OF 'COLBMLO2.TXT'
*% INCLUDE FIN_EDT_AKY_LO2 OF 'COLBMLO2.TXT'
       FIN-EDT-AKY-LO2.
           EXIT.
       
       EDT-FLD-LO2 SECTION.
       INI-EDT-FLD-LO2.
*% INCLUDE EDT_FLD_LO2 OF 'COLBMLO2.TXT'
           IF POC-NUM-MINC-LEN IN LO2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POC-NUM-MINC-LEN IN LO2-FLD
                GO TO FIN-EDT-FLD-LO2.
           MOVE POC-NUM-MINC IN LO2-FLD TO POC-NUM-MINC-EDT IN LO2-EDT.
           MOVE POC-NUM-MINC-EDT IN LO2-EDT TO 
                POC-NUM-MINC-ALF IN LO2-FLD.
           IF POC-NUM-MINI-LEN IN LO2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POC-NUM-MINI-LEN IN LO2-FLD
                GO TO FIN-EDT-FLD-LO2.
           MOVE POC-NUM-MINI IN LO2-FLD TO POC-NUM-MINI-EDT IN LO2-EDT.
           MOVE POC-NUM-MINI-EDT IN LO2-EDT TO 
                POC-NUM-MINI-ALF IN LO2-FLD.
           IF POC-NUM-MAXC-LEN IN LO2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POC-NUM-MAXC-LEN IN LO2-FLD
                GO TO FIN-EDT-FLD-LO2.
           MOVE POC-NUM-MAXC IN LO2-FLD TO POC-NUM-MAXC-EDT IN LO2-EDT.
           MOVE POC-NUM-MAXC-EDT IN LO2-EDT TO 
                POC-NUM-MAXC-ALF IN LO2-FLD.
           IF POC-NUM-MAXI-LEN IN LO2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POC-NUM-MAXI-LEN IN LO2-FLD
                GO TO FIN-EDT-FLD-LO2.
           MOVE POC-NUM-MAXI IN LO2-FLD TO POC-NUM-MAXI-EDT IN LO2-EDT.
           MOVE POC-NUM-MAXI-EDT IN LO2-EDT TO 
                POC-NUM-MAXI-ALF IN LO2-FLD.
*% INCLUDE FIN_EDT_FLD_LO2 OF 'COLBMLO2.TXT'
       FIN-EDT-FLD-LO2.
           EXIT.
*% INCLUDE EOF_BQ OF 'COLBMLO2.TXT'
*% INCLUDE EOF OF 'COLBMLO2.TXT'
*% INCLUDE EOF_IBM OF 'COLBMLO2.TXT'
