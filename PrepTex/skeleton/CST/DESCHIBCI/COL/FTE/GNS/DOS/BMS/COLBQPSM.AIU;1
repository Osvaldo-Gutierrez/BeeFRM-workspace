      *
      * COLBQPSM
      * Version 3.0.1 Nov-2005
      * 28-Oct-19 09:44 PM
      *
*% INI_LBL = TRUE
*% PGM_BQ = TRUE
*% FRM = "PSM"
*% PGM_BQ = TRUE
*% INCLUDE SETTAG OF 'COLBMPSM.TXT'
       SET-TAG-COLBQPSM SECTION.
       INI-SET-TAG-COLBQPSM.
           MOVE
           '<IDNMOD NOM=$COLBQPSM$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$28-Oct-19 09:44 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBQPSM.
           EXIT.
           
       PUT-ALL-PSM SECTION.
       INI-PUT-ALL-PSM.
*% INCLUDE INI_PUT_ALL_PSM OF 'COLBMPSM.TXT'
           PERFORM PUT-PSM-PSM.
           PERFORM PUT-POC-PSM.
*% INCLUDE FIN_PUT_ALL_PSM OF 'COLBMPSM.TXT'
       FIN-PUT-ALL-PSM.
           EXIT.
       
       PUT-PSM-PSM SECTION.
       INI-PUT-PSM-PSM.
*% INCLUDE INI_PUT_PSM_PSM OF 'COLBMPSM.TXT'
           IF PGM-STAT-PSM-NUL
               GO TO FIN-PUT-PSM-PSM.
           IF NOT PGM-STAT-PSM-OKS
               PERFORM CLR-PSM-PSM
               GO TO FIN-PUT-PSM-PSM.
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE PSM-NUM-DTRN IN PSM TO PSM-NUM-DTRN IN PSM-FLD.
           MOVE PSM-NUM-MTRN IN PSM TO PSM-NUM-MTRN IN PSM-FLD.
           MOVE PSM-NUM-STRN IN PSM TO PSM-NUM-STRN IN PSM-FLD.
           MOVE PSM-NUM-ATRN IN PSM TO PSM-NUM-ATRN IN PSM-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE PSM-HRA-HRTR IN PSM TO PSM-HRA-HRTR IN PSM-FLD.
           MOVE PSM-COD-OFOC IN PSM TO PSM-COD-OFOC IN PSM-FLD.
           MOVE PSM-COD-VCOC IN PSM TO PSM-COD-VCOC IN PSM-FLD.
           MOVE PSM-COD-TOOC IN PSM TO PSM-COD-TOOC IN PSM-FLD.
           MOVE PSM-COD-AOOC IN PSM TO PSM-COD-AOOC IN PSM-FLD.
           MOVE PSM-COD-TBAN IN PSM TO PSM-COD-TBAN IN PSM-FLD.
           MOVE PSM-COD-CLCM IN PSM TO PSM-COD-CLCM IN PSM-FLD.
           MOVE PSM-COD-OFCB IN PSM TO PSM-COD-OFCB IN PSM-FLD.
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FACT"
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE PSM-NUM-DACT IN PSM TO PSM-NUM-DACT IN PSM-FLD.
           MOVE PSM-NUM-MACT IN PSM TO PSM-NUM-MACT IN PSM-FLD.
           MOVE PSM-NUM-SACT IN PSM TO PSM-NUM-SACT IN PSM-FLD.
           MOVE PSM-NUM-AACT IN PSM TO PSM-NUM-AACT IN PSM-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE PSM-COD-ATRN IN PSM TO PSM-COD-ATRN IN PSM-FLD.
           MOVE PSM-MSC-STAT IN PSM TO PSM-MSC-STAT IN PSM-FLD.
*% BUF = "PSM-FLD"
*% SIS = "TAB"
*% TAB = "OFI "
*% FLD = "PSM-COD-OFOC"
*% GLS = "FRM-GLS-OFOC"
*% TIENE_GLOSA = TRUE
*% LGL = 11
*% INCLUDE 'BUSOFI          '
*% BUF = "PSM-FLD"
*% SIS = "TAB"
*% TAB = "VLR "
*% FLD = "PSM-COD-VCOC"
*% GLS = "FRM-GLS-VCOC"
*% TIENE_GLOSA = TRUE
*% LGL = 12
*% INCLUDE 'BUSTAB'
*% BUF = "PSM-FLD"
*% SIS = "COL"
*% TAB = "AUX "
*% FLD = "PSM-COD-AOOC"
*% GLS = "FRM-GLS-AOOC"
*% TIENE_GLOSA = TRUE
*% LGL = 5
*% INCLUDE 'BUSTAB'
*% BUF = "PSM-FLD"
*% SIS = "SGC"
*% TAB = "BAN "
*% FLD = "PSM-COD-TBAN"
*% GLS = "FRM-GLS-TBAN"
*% TIENE_GLOSA = TRUE
*% LGL = 12
*% INCLUDE 'BUSTAB'
*% BUF = "PSM-FLD"
*% SIS = "SGC"
*% TAB = "CLC "
*% FLD = "PSM-COD-CLCM"
*% GLS = "FRM-GLS-CLCM"
*% TIENE_GLOSA = TRUE
*% LGL = 11
*% INCLUDE 'BUSTAB'
*% INCLUDE FIN_PUT_PSM_PSM OF 'COLBMPSM.TXT'
       FIN-PUT-PSM-PSM.
           EXIT.
       
       PUT-POC-PSM SECTION.
       INI-PUT-POC-PSM.
*% INCLUDE INI_PUT_POC_PSM OF 'COLBMPSM.TXT'
           IF PGM-STAT-POC-NUL
               GO TO FIN-PUT-POC-PSM.
           IF NOT PGM-STAT-POC-OKS
               PERFORM CLR-POC-PSM
               GO TO FIN-PUT-POC-PSM.
           MOVE POC-MSC-BCTI IN POC TO POC-MSC-BCTI IN PSM-FLD.
           MOVE POC-MSC-PBTI IN POC TO POC-MSC-PBTI IN PSM-FLD.
           MOVE POC-MSC-BPBT IN POC TO POC-MSC-BPBT IN PSM-FLD.
           MOVE POC-MSC-SPBT IN POC TO POC-MSC-SPBT IN PSM-FLD.
           MOVE POC-COD-CVTI IN POC TO POC-COD-CVTI IN PSM-FLD.
           MOVE POC-MSC-TFPR IN POC TO POC-MSC-TFPR IN PSM-FLD.
           MOVE POC-NUM-PREP IN POC TO POC-NUM-PREP IN PSM-FLD.
           MOVE POC-MSC-UTPR IN POC TO POC-MSC-UTPR IN PSM-FLD.
*% BUF = "PSM-FLD"
*% SIS = "COL"
*% TAB = "BCTI"
*% FLD = "POC-MSC-BCTI"
*% GLS = "FRM-GLS-BCTI"
*% TIENE_GLOSA = TRUE
*% LGL = 12
*% INCLUDE 'BUSMSC'
*% BUF = "PSM-FLD"
*% SIS = "COL"
*% TAB = "PBTI"
*% FLD = "POC-MSC-PBTI"
*% GLS = "FRM-GLS-PBTI"
*% TIENE_GLOSA = TRUE
*% LGL = 8
*% INCLUDE 'BUSMSC'
*% BUF = "PSM-FLD"
*% SIS = "COL"
*% TAB = "MCTI"
*% FLD = "POC-MSC-BPBT"
*% GLS = "FRM-GLS-BPBT"
*% TIENE_GLOSA = TRUE
*% LGL = 12
*% INCLUDE 'BUSMSC'
*% BUF = "PSM-FLD"
*% SIS = "COL"
*% TAB = "MCTI"
*% FLD = "POC-MSC-SPBT"
*% GLS = "FRM-GLS-SPBT"
*% TIENE_GLOSA = TRUE
*% LGL = 12
*% INCLUDE 'BUSMSC'
*% INCLUDE FIN_PUT_POC_PSM OF 'COLBMPSM.TXT'
       FIN-PUT-POC-PSM.
           EXIT.
       
       KEY-ALL-PSM SECTION.
       INI-KEY-ALL-PSM.
*% INCLUDE INI_KEY_ALL_PSM OF 'COLBMPSM.TXT'
           PERFORM KEY-PSM-PSM.
           PERFORM KEY-POC-PSM.
*% INCLUDE FIN_KEY_ALL_PSM OF 'COLBMPSM.TXT'
       FIN-KEY-ALL-PSM.
           EXIT.
       
       KEY-PSM-PSM SECTION.
       INI-KEY-PSM-PSM.
*% INCLUDE INI_KEY_PSM_PSM OF 'COLBMPSM.TXT'
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE PSM-NUM-DTRN IN PSM-FLD TO PSM-NUM-DTRN IN PSM.
           MOVE PSM-NUM-MTRN IN PSM-FLD TO PSM-NUM-MTRN IN PSM.
           MOVE PSM-NUM-STRN IN PSM-FLD TO PSM-NUM-STRN IN PSM.
           MOVE PSM-NUM-ATRN IN PSM-FLD TO PSM-NUM-ATRN IN PSM.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE PSM-HRA-HRTR IN PSM-FLD TO PSM-HRA-HRTR IN PSM.
           MOVE PSM-COD-OFOC IN PSM-FLD TO PSM-COD-OFOC IN PSM.
           MOVE PSM-COD-VCOC IN PSM-FLD TO PSM-COD-VCOC IN PSM.
           MOVE PSM-COD-TOOC IN PSM-FLD TO PSM-COD-TOOC IN PSM.
           MOVE PSM-COD-AOOC IN PSM-FLD TO PSM-COD-AOOC IN PSM.
           MOVE PSM-COD-TBAN IN PSM-FLD TO PSM-COD-TBAN IN PSM.
           MOVE PSM-COD-CLCM IN PSM-FLD TO PSM-COD-CLCM IN PSM.
*% INCLUDE FIN_KEY_PSM_PSM OF 'COLBMPSM.TXT'
       FIN-KEY-PSM-PSM.
           EXIT.
       
       KEY-POC-PSM SECTION.
       INI-KEY-POC-PSM.
*% INCLUDE INI_KEY_POC_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_KEY_POC_PSM OF 'COLBMPSM.TXT'
       FIN-KEY-POC-PSM.
           EXIT.
       
       SCR-CLRA-PSM SECTION.
       INI-SCR-CLRA-PSM.
*% INCLUDE INI_SCR_CLRA_PSM OF 'COLBMPSM.TXT'
           PERFORM CLR-KEY-PSM.
           PERFORM CLR-FLD-PSM.
*% INCLUDE FIN_SCR_CLRA_PSM OF 'COLBMPSM.TXT'
       FIN-SCR-CLRA-PSM.
           EXIT.
       
       CLR-KEY-PSM SECTION.
       INI-CLR-KEY-PSM.
*% INCLUDE INI_CLR_KEY_PSM OF 'COLBMPSM.TXT'
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO PSM-FEC-FTRN IN PSM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO PSM-HRA-HRTR IN PSM-FLD.
           MOVE SPACES TO PSM-COD-OFOC IN PSM-FLD.
           MOVE SPACES TO PSM-COD-VCOC IN PSM-FLD.
           MOVE SPACES TO PSM-COD-TOOC IN PSM-FLD.
           MOVE SPACES TO PSM-COD-AOOC IN PSM-FLD.
           MOVE SPACES TO PSM-COD-TBAN IN PSM-FLD.
           MOVE SPACES TO PSM-COD-CLCM IN PSM-FLD.
*% INCLUDE FIN_CLR_KEY_PSM OF 'COLBMPSM.TXT'
       FIN-CLR-KEY-PSM.
           EXIT.
       
       CLR-FLD-PSM SECTION.
       INI-CLR-FLD-PSM.
*% INCLUDE INI_CLR_FLD_PSM OF 'COLBMPSM.TXT'
           MOVE SPACES TO FRM-GLS-OFOC IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-TBAN IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-CLCM IN PSM-FLD.
           MOVE ZEROES TO FRM-SGV-MTO1 IN PSM-FLD.
           MOVE ZEROES TO FRM-SGV-MTO2 IN PSM-FLD.
           MOVE ZEROES TO FRM-SGV-MTO3 IN PSM-FLD.
           MOVE ZEROES TO FRM-SGV-MTO4 IN PSM-FLD.
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(1).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(2).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(3).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(4).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(5).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(6).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(1).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(2).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(3).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(4).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(5).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(6).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(1).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(2).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(3).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(4).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(5).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(6).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(1).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(2).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(3).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(4).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(5).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(6).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(1).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(2).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(3).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(4).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(5).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(6).
           MOVE SPACES TO FRM-GLS-BCTI IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-PBTI IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-BPBT IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-SPBT IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-CVTI IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-OFCB IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-UTPR IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-ATRN IN PSM-FLD.
           PERFORM CLR-PSM-PSM.
           PERFORM CLR-POC-PSM.
*% INCLUDE FIN_CLR_FLD_PSM OF 'COLBMPSM.TXT'
       FIN-CLR-FLD-PSM.
           EXIT.
       
       CLR-PSM-PSM SECTION.
       INI-CLR-PSM-PSM.
*% INCLUDE INI_CLR_PSM_PSM OF 'COLBMPSM.TXT'
           MOVE SPACES TO PSM-COD-OFCB IN PSM-FLD.
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FACT"
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO PSM-FEC-FACT IN PSM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO PSM-COD-ATRN IN PSM-FLD.
           MOVE SPACES TO PSM-MSC-STAT IN PSM-FLD.
*% INCLUDE FIN_CLR_PSM_PSM OF 'COLBMPSM.TXT'
       FIN-CLR-PSM-PSM.
           EXIT.
       
       CLR-POC-PSM SECTION.
       INI-CLR-POC-PSM.
*% INCLUDE INI_CLR_POC_PSM OF 'COLBMPSM.TXT'
           MOVE SPACES TO POC-MSC-BCTI IN PSM-FLD.
           MOVE SPACES TO POC-MSC-PBTI IN PSM-FLD.
           MOVE SPACES TO POC-MSC-BPBT IN PSM-FLD.
           MOVE SPACES TO POC-MSC-SPBT IN PSM-FLD.
           MOVE SPACES TO POC-COD-CVTI IN PSM-FLD.
           MOVE SPACES TO POC-MSC-TFPR IN PSM-FLD.
           MOVE ZEROES TO POC-NUM-PREP IN PSM-FLD.
           MOVE SPACES TO POC-MSC-UTPR IN PSM-FLD.
*% INCLUDE FIN_CLR_POC_PSM OF 'COLBMPSM.TXT'
       FIN-CLR-POC-PSM.
           EXIT.
       
       FST-KEY-PSM SECTION.
       INI-FST-KEY-PSM.
*% INCLUDE INI_FST_KEY_PSM OF 'COLBMPSM.TXT'
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
           MOVE FRM-POS-CURS TO PSM-FEC-FTRN-LEN IN PSM-FLD.
*% INCLUDE FIN_FST_KEY_PSM OF 'COLBMPSM.TXT'
       FIN-FST-KEY-PSM.
           EXIT.
       
       FST-FLD-PSM SECTION.
       INI-FST-FLD-PSM.
*% INCLUDE INI_FST_FLD_PSM OF 'COLBMPSM.TXT'
           MOVE -1 TO FRM-SGV-MTO1-LEN IN PSM-FLD.
*% INCLUDE FIN_FST_FLD_PSM OF 'COLBMPSM.TXT'
       FIN-FST-FLD-PSM.
           EXIT.
       
       PRO-KEY-PSM SECTION.
       INI-PRO-KEY-PSM.
*% INCLUDE INI_PRO_KEY_PSM OF 'COLBMPSM.TXT'
           PERFORM PRO-IKY-PSM.
           PERFORM PRO-AKY-PSM.
           PERFORM PRO-MKY-PSM.
*% INCLUDE FIN_PRO_KEY_PSM OF 'COLBMPSM.TXT'
       FIN-PRO-KEY-PSM.
           EXIT.
       
       PRO-IKY-PSM SECTION.
       INI-PRO-IKY-PSM.
*% INCLUDE INI_PRO_IKY_PSM OF 'COLBMPSM.TXT'
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
           MOVE FRM-CPIM-AEY TO PSM-FEC-FTRN-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-HRA-HRTR-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-OFOC-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-VCOC-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-TOOC-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-AOOC-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-TBAN-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-CLCM-ATR IN PSM-FLD.
*% INCLUDE FIN_PRO_IKY_PSM OF 'COLBMPSM.TXT'
       FIN-PRO-IKY-PSM.
           EXIT.
       
       PRO-MKY-PSM SECTION.
       INI-PRO-MKY-PSM.
*% INCLUDE INI_PRO_MKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_PRO_MKY_PSM OF 'COLBMPSM.TXT'
       FIN-PRO-MKY-PSM.
           EXIT.
       
       PRO-AKY-PSM SECTION.
       INI-PRO-AKY-PSM.
*% INCLUDE INI_PRO_AKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_PRO_AKY_PSM OF 'COLBMPSM.TXT'
       FIN-PRO-AKY-PSM.
           EXIT.
       
       UNP-KEY-PSM SECTION.
       INI-UNP-KEY-PSM.
*% INCLUDE INI_UNP_KEY_PSM OF 'COLBMPSM.TXT'
           PERFORM UNP-IKY-PSM.
           PERFORM UNP-AKY-PSM.
           PERFORM UNP-MKY-PSM.
*% INCLUDE FIN_UNP_KEY_PSM OF 'COLBMPSM.TXT'
       FIN-UNP-KEY-PSM.
           EXIT.
       
       UNP-IKY-PSM SECTION.
       INI-UNP-IKY-PSM.
*% INCLUDE INI_UNP_IKY_PSM OF 'COLBMPSM.TXT'
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
           MOVE FRM-CPIM-UBY TO PSM-FEC-FTRN-ATR IN PSM-FLD.
           MOVE FRM-CPIM-UBY TO PSM-HRA-HRTR-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-OFOC-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-VCOC-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-TOOC-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-AOOC-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-TBAN-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-CLCM-ATR.
*% INCLUDE FIN_UNP_IKY_PSM OF 'COLBMPSM.TXT'
       FIN-UNP-IKY-PSM.
           EXIT.
       
       UNP-MKY-PSM SECTION.
       INI-UNP-MKY-PSM.
*% INCLUDE INI_UNP_MKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_UNP_MKY_PSM OF 'COLBMPSM.TXT'
       FIN-UNP-MKY-PSM.
           EXIT.
       
       UNP-AKY-PSM SECTION.
       INI-UNP-AKY-PSM.
*% INCLUDE INI_UNP_AKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_UNP_AKY_PSM OF 'COLBMPSM.TXT'
       FIN-UNP-AKY-PSM.
           EXIT.
       
       UNP-FLD-PSM SECTION.
       INI-UNP-FLD-PSM.
*% INCLUDE INI_UNP_FLD_PSM OF 'COLBMPSM.TXT'
           MOVE FRM-CPIM-UBY TO FRM-SGV-MTO1-ATR IN PSM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-SGV-MTO2-ATR IN PSM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-SGV-MTO3-ATR IN PSM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-SGV-MTO4-ATR IN PSM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(6).
           PERFORM UNP-PSM-PSM.
           PERFORM UNP-POC-PSM.
*% INCLUDE FIN_UNP_FLD_PSM OF 'COLBMPSM.TXT'
       FIN-UNP-FLD-PSM.
           EXIT.
       
       UNP-PSM-PSM SECTION.
       INI-UNP-PSM-PSM.
*% INCLUDE INI_UNP_PSM_PSM OF 'COLBMPSM.TXT'
           MOVE FRM-CPIM-UBY TO PSM-MSC-STAT-ATR IN PSM-FLD.
*% INCLUDE FIN_UNP_PSM_PSM OF 'COLBMPSM.TXT'
       FIN-UNP-PSM-PSM.
           EXIT.
       
       UNP-POC-PSM SECTION.
       INI-UNP-POC-PSM.
*% INCLUDE INI_UNP_POC_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_UNP_POC_PSM OF 'COLBMPSM.TXT'
       FIN-UNP-POC-PSM.
           EXIT.
       
       VAL-KEY-PSM SECTION.
       INI-VAL-KEY-PSM.
           PERFORM VAL-IKY-PSM.
           PERFORM VAL-MKY-PSM.
           PERFORM VAL-AKY-PSM.
       FIN-VAL-KEY-PSM.
           EXIT.
       
       VAL-IKY-PSM SECTION.
       INI-VAL-IKY-PSM.
*% INCLUDE INI_VAL_IKY_PSM OF 'COLBMPSM.TXT'
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-PSM-FEC-FTRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                PSM-FEC-FTRN-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-PSM-HRA-HRTR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PSM-HRA-HRTR-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-OFOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PSM-COD-OFOC-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PSM-COD-VCOC-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PSM-COD-TOOC-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PSM-COD-AOOC-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-TBAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PSM-COD-TBAN-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-CLCM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PSM-COD-CLCM-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
*% INCLUDE FIN_VAL_IKY_PSM OF 'COLBMPSM.TXT'
       FIN-VAL-IKY-PSM.
           EXIT.
       
       VAL-MKY-PSM SECTION.
       INI-VAL-MKY-PSM.
*% INCLUDE INI_VAL_MKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_VAL_MKY_PSM OF 'COLBMPSM.TXT'
       FIN-VAL-MKY-PSM.
           EXIT.
       
       VAL-AKY-PSM SECTION.
       INI-VAL-AKY-PSM.
*% INCLUDE INI_VAL_AKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_VAL_AKY_PSM OF 'COLBMPSM.TXT'
       FIN-VAL-AKY-PSM.
           EXIT.
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
*% OBL = "S"
*% LBL = "PSM_FEC_FTRN OF 'COLBMPSM.TXT'"
*% IZR = "S"
*% ZRO = "S"
*% BUF = "PSM-FLD"
*% FLD = "PSM-FEC-FTRN"
*% SN  = "S"
*% HOY = "LE"
*% HBL = "S"
*% TIPO = "FEC"
*% FRM_IFLD = ""
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-PSM-FEC-FTRN SECTION.
       INI-VAL-PSM-FEC-FTRN.
           IF PSM-FEC-FTRN IN PSM-FLD  NOT > ZEROES
              MOVE ZEROES TO PSM-FEC-FTRN IN PSM-FLD.
*% INCLUDE 'SETFEC'
*% INCLUDE INI_PSM_FEC_FTRN OF 'COLBMPSM.TXT'
*% INCLUDE 'PROFEC'
*% INCLUDE PSM_FEC_FTRN OF 'COLBMPSM.TXT'
*% INCLUDE FIN_PSM_FEC_FTRN OF 'COLBMPSM.TXT'
       FIN-VAL-PSM-FEC-FTRN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-PSM-HRA-HRTR SECTION.
       INI-VAL-PSM-HRA-HRTR.
*% LBL = "PSM_HRA_HRTR OF 'COLBMPSM.TXT'"
*% INCLUDE INI_PSM_HRA_HRTR OF 'COLBMPSM.TXT'
*% INCLUDE PSM_HRA_HRTR OF 'COLBMPSM.TXT'
*% INCLUDE FIN_PSM_HRA_HRTR OF 'COLBMPSM.TXT'
       FIN-VAL-PSM-HRA-HRTR.
           EXIT.
       
       VAL-PSM-COD-OFOC SECTION.
       INI-VAL-PSM-COD-OFOC.
*% LBL = "PSM_COD_OFOC OF 'COLBMPSM.TXT'"
*% INCLUDE INI_PSM_COD_OFOC OF 'COLBMPSM.TXT'
           IF PSM-COD-OFOC IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-OFOC IN PSM-FLD.
*% INCLUDE PSM_COD_OFOC OF 'COLBMPSM.TXT'
*% BUF = "PSM-FLD"
*% SIS = "TAB"
*% TAB = "OFI "
*% FLD = "PSM-COD-OFOC"
*% GLS = "FRM-GLS-OFOC"
*% TIENE_GLOSA = TRUE
*% LGL = 11
*% INCLUDE 'VALOFI          '
*% INCLUDE FIN_PSM_COD_OFOC OF 'COLBMPSM.TXT'
       FIN-VAL-PSM-COD-OFOC.
           EXIT.
       
       VAL-PSM-COD-VCOC SECTION.
       INI-VAL-PSM-COD-VCOC.
*% LBL = "PSM_COD_VCOC OF 'COLBMPSM.TXT'"
*% INCLUDE INI_PSM_COD_VCOC OF 'COLBMPSM.TXT'
           IF PSM-COD-VCOC IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-VCOC IN PSM-FLD.
*% INCLUDE PSM_COD_VCOC OF 'COLBMPSM.TXT'
*% BUF = "PSM-FLD"
*% SIS = "TAB"
*% TAB = "VLR "
*% FLD = "PSM-COD-VCOC"
*% GLS = "FRM-GLS-VCOC"
*% TIENE_GLOSA = TRUE
*% LGL = 12
*% INCLUDE 'VALCOD'
*% INCLUDE FIN_PSM_COD_VCOC OF 'COLBMPSM.TXT'
       FIN-VAL-PSM-COD-VCOC.
           EXIT.
       
       VAL-PSM-COD-TOOC SECTION.
       INI-VAL-PSM-COD-TOOC.
*% LBL = "PSM_COD_TOOC OF 'COLBMPSM.TXT'"
*% INCLUDE INI_PSM_COD_TOOC OF 'COLBMPSM.TXT'
           IF PSM-COD-TOOC IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-TOOC IN PSM-FLD.
*% INCLUDE PSM_COD_TOOC OF 'COLBMPSM.TXT'
*% INCLUDE FIN_PSM_COD_TOOC OF 'COLBMPSM.TXT'
       FIN-VAL-PSM-COD-TOOC.
           EXIT.
       
       VAL-PSM-COD-AOOC SECTION.
       INI-VAL-PSM-COD-AOOC.
*% LBL = "PSM_COD_AOOC OF 'COLBMPSM.TXT'"
*% INCLUDE INI_PSM_COD_AOOC OF 'COLBMPSM.TXT'
           IF PSM-COD-AOOC IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-AOOC IN PSM-FLD.
*% INCLUDE PSM_COD_AOOC OF 'COLBMPSM.TXT'
*% BUF = "PSM-FLD"
*% SIS = "COL"
*% TAB = "AUX "
*% FLD = "PSM-COD-AOOC"
*% GLS = "FRM-GLS-AOOC"
*% TIENE_GLOSA = TRUE
*% LGL = 5
*% INCLUDE 'VALCOD'
*% INCLUDE FIN_PSM_COD_AOOC OF 'COLBMPSM.TXT'
       FIN-VAL-PSM-COD-AOOC.
           EXIT.
       
       VAL-PSM-COD-TBAN SECTION.
       INI-VAL-PSM-COD-TBAN.
*% LBL = "PSM_COD_TBAN OF 'COLBMPSM.TXT'"
*% INCLUDE INI_PSM_COD_TBAN OF 'COLBMPSM.TXT'
           IF PSM-COD-TBAN IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-TBAN IN PSM-FLD.
*% INCLUDE PSM_COD_TBAN OF 'COLBMPSM.TXT'
*% BUF = "PSM-FLD"
*% SIS = "SGC"
*% TAB = "BAN "
*% FLD = "PSM-COD-TBAN"
*% GLS = "FRM-GLS-TBAN"
*% TIENE_GLOSA = TRUE
*% LGL = 12
*% INCLUDE 'VALCOD'
*% INCLUDE FIN_PSM_COD_TBAN OF 'COLBMPSM.TXT'
       FIN-VAL-PSM-COD-TBAN.
           EXIT.
       
       VAL-PSM-COD-CLCM SECTION.
       INI-VAL-PSM-COD-CLCM.
*% LBL = "PSM_COD_CLCM OF 'COLBMPSM.TXT'"
*% INCLUDE INI_PSM_COD_CLCM OF 'COLBMPSM.TXT'
           IF PSM-COD-CLCM IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-CLCM IN PSM-FLD.
*% INCLUDE PSM_COD_CLCM OF 'COLBMPSM.TXT'
*% BUF = "PSM-FLD"
*% SIS = "SGC"
*% TAB = "CLC "
*% FLD = "PSM-COD-CLCM"
*% GLS = "FRM-GLS-CLCM"
*% TIENE_GLOSA = TRUE
*% LGL = 11
*% INCLUDE 'VALCOD'
*% INCLUDE FIN_PSM_COD_CLCM OF 'COLBMPSM.TXT'
       FIN-VAL-PSM-COD-CLCM.
           EXIT.
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FACT"
*% IZR = "S"
       
       VAL-CON-KEY-PSM SECTION.
       INI-VAL-CON-KEY-PSM.
*% INCLUDE INI_VAL_CON_KEY_PSM OF 'COLBMPSM.TXT'
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
           IF     PSM-FEC-FTRN IN PSM-FLD NOT > ZEROES
              AND PSM-HRA-HRTR IN PSM-FLD NOT > ZEROES 
              AND PSM-COD-OFOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-VCOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-TOOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-AOOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-TBAN IN PSM-FLD NOT > SPACES 
              AND PSM-COD-CLCM IN PSM-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PSM.
*% INCLUDE FIN_VAL_CON_KEY_PSM OF 'COLBMPSM.TXT'
       FIN-VAL-CON-KEY-PSM.
           EXIT.
       
       VAL-CON-IKY-PSM SECTION.
       INI-VAL-CON-IKY-PSM.
*% INCLUDE INI_VAL_CON_IKY_PSM OF 'COLBMPSM.TXT'
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
           IF     PSM-FEC-FTRN IN PSM-FLD NOT > ZEROES
              AND PSM-HRA-HRTR IN PSM-FLD NOT > ZEROES 
              AND PSM-COD-OFOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-VCOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-TOOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-AOOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-TBAN IN PSM-FLD NOT > SPACES 
              AND PSM-COD-CLCM IN PSM-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PSM.
*% INCLUDE FIN_VAL_CON_IKY_PSM OF 'COLBMPSM.TXT'
       FIN-VAL-CON-IKY-PSM.
           EXIT.
       
       VAL-NUM-KEY-PSM SECTION.
       INI-VAL-NUM-KEY-PSM.
           PERFORM VAL-NUM-IKY-PSM.
           PERFORM VAL-NUM-MKY-PSM.
           PERFORM VAL-NUM-AKY-PSM.
       FIN-VAL-NUM-KEY-PSM.
           EXIT.
       
       VAL-NUM-IKY-PSM SECTION.
       INI-VAL-NUM-IKY-PSM.
*% INCLUDE INI_VAL_NUM_IKY_PSM OF 'COLBMPSM.TXT'
       VAL-NUM-PSM-HRA-HRTR.
*% BUF = "PSM-FLD"
*% FLD = "PSM-HRA-HRTR"
*% ENT = "4"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-IKY-PSM.
*% INCLUDE FIN_VAL_NUM_IKY_PSM OF 'COLBMPSM.TXT'
       FIN-VAL-NUM-IKY-PSM.
           EXIT.
       
       VAL-NUM-MKY-PSM SECTION.
       INI-VAL-NUM-MKY-PSM.
*% INCLUDE INI_VAL_NUM_MKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_VAL_NUM_MKY_PSM OF 'COLBMPSM.TXT'
       FIN-VAL-NUM-MKY-PSM.
           EXIT.
       
       VAL-NUM-AKY-PSM SECTION.
       INI-VAL-NUM-AKY-PSM.
*% INCLUDE INI_VAL_NUM_AKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_VAL_NUM_AKY_PSM OF 'COLBMPSM.TXT'
       FIN-VAL-NUM-AKY-PSM.
           EXIT.
       
       VAL-NUM-FLD-PSM SECTION.
       INI-VAL-NUM-FLD-PSM.
*% INCLUDE INI_VAL_NUM_FLD_PSM OF 'COLBMPSM.TXT'
       VAL-NUM-FRM-SGV-MTO1.
*% BUF = "PSM-FLD"
*% FLD = "FRM-SGV-MTO1"
*% ENT = "8"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-MTO2.
*% BUF = "PSM-FLD"
*% FLD = "FRM-SGV-MTO2"
*% ENT = "8"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-MTO3.
*% BUF = "PSM-FLD"
*% FLD = "FRM-SGV-MTO3"
*% ENT = "8"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-MTO4.
*% BUF = "PSM-FLD"
*% FLD = "FRM-SGV-MTO4"
*% ENT = "8"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-1.
*% BUF = "PSM-FLD(1)"
*% FLD = "FRM-NUM-NDIA"
*% ENT = "4"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-2.
*% BUF = "PSM-FLD(2)"
*% FLD = "FRM-NUM-NDIA"
*% ENT = "4"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-3.
*% BUF = "PSM-FLD(3)"
*% FLD = "FRM-NUM-NDIA"
*% ENT = "4"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-4.
*% BUF = "PSM-FLD(4)"
*% FLD = "FRM-NUM-NDIA"
*% ENT = "4"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-5.
*% BUF = "PSM-FLD(5)"
*% FLD = "FRM-NUM-NDIA"
*% ENT = "4"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-6.
*% BUF = "PSM-FLD(6)"
*% FLD = "FRM-NUM-NDIA"
*% ENT = "4"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-1.
*% BUF = "PSM-FLD(1)"
*% FLD = "FRM-SGV-INT1"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-2.
*% BUF = "PSM-FLD(2)"
*% FLD = "FRM-SGV-INT1"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-3.
*% BUF = "PSM-FLD(3)"
*% FLD = "FRM-SGV-INT1"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-4.
*% BUF = "PSM-FLD(4)"
*% FLD = "FRM-SGV-INT1"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-5.
*% BUF = "PSM-FLD(5)"
*% FLD = "FRM-SGV-INT1"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-6.
*% BUF = "PSM-FLD(6)"
*% FLD = "FRM-SGV-INT1"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-1.
*% BUF = "PSM-FLD(1)"
*% FLD = "FRM-SGV-INT2"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-2.
*% BUF = "PSM-FLD(2)"
*% FLD = "FRM-SGV-INT2"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-3.
*% BUF = "PSM-FLD(3)"
*% FLD = "FRM-SGV-INT2"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-4.
*% BUF = "PSM-FLD(4)"
*% FLD = "FRM-SGV-INT2"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-5.
*% BUF = "PSM-FLD(5)"
*% FLD = "FRM-SGV-INT2"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-6.
*% BUF = "PSM-FLD(6)"
*% FLD = "FRM-SGV-INT2"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-1.
*% BUF = "PSM-FLD(1)"
*% FLD = "FRM-SGV-INT3"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-2.
*% BUF = "PSM-FLD(2)"
*% FLD = "FRM-SGV-INT3"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-3.
*% BUF = "PSM-FLD(3)"
*% FLD = "FRM-SGV-INT3"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-4.
*% BUF = "PSM-FLD(4)"
*% FLD = "FRM-SGV-INT3"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-5.
*% BUF = "PSM-FLD(5)"
*% FLD = "FRM-SGV-INT3"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-6.
*% BUF = "PSM-FLD(6)"
*% FLD = "FRM-SGV-INT3"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-1.
*% BUF = "PSM-FLD(1)"
*% FLD = "FRM-SGV-INT4"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-2.
*% BUF = "PSM-FLD(2)"
*% FLD = "FRM-SGV-INT4"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-3.
*% BUF = "PSM-FLD(3)"
*% FLD = "FRM-SGV-INT4"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-4.
*% BUF = "PSM-FLD(4)"
*% FLD = "FRM-SGV-INT4"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-5.
*% BUF = "PSM-FLD(5)"
*% FLD = "FRM-SGV-INT4"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-6.
*% BUF = "PSM-FLD(6)"
*% FLD = "FRM-SGV-INT4"
*% ENT = "4"
*% DCM = "4"
*% NMR = "NN9V"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-POC-NUM-PREP.
*% BUF = "PSM-FLD"
*% FLD = "POC-NUM-PREP"
*% ENT = "3"
*% DCM = "0"
*% NMR = "NN9N"
*% ISG = "N"
*% IZR = "S"
*% INCLUDE 'VALNUM'
                GO TO FIN-VAL-NUM-FLD-PSM.
*% INCLUDE FIN_VAL_NUM_FLD_PSM OF 'COLBMPSM.TXT'
       FIN-VAL-NUM-FLD-PSM.
           EXIT.
       
       EDT-KEY-PSM SECTION.
       INI-EDT-KEY-PSM.
           PERFORM EDT-IKY-PSM.
           PERFORM EDT-MKY-PSM.
           PERFORM EDT-AKY-PSM.
*% INCLUDE EDT_KEY_PSM OF 'COLBMPSM.TXT'
       FIN-EDT-KEY-PSM.
           EXIT.
       
       EDT-IKY-PSM SECTION.
       INI-EDT-IKY-PSM.
*% INCLUDE EDT_IKY_PSM OF 'COLBMPSM.TXT'
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FTRN"
           IF PSM-HRA-HRTR-LEN IN PSM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PSM-HRA-HRTR-LEN IN PSM-FLD
                GO TO FIN-EDT-IKY-PSM.
           MOVE PSM-HRA-HRTR IN PSM-FLD TO PSM-HRA-HRTR-EDT IN PSM-EDT.
           MOVE PSM-HRA-HRTR-EDT IN PSM-EDT TO 
                PSM-HRA-HRTR-ALF IN PSM-FLD.
*% INCLUDE FIN_EDT_IKY_PSM OF 'COLBMPSM.TXT'
       FIN-EDT-IKY-PSM.
           EXIT.
       
       EDT-MKY-PSM SECTION.
       INI-EDT-MKY-PSM.
*% INCLUDE EDT_MKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_EDT_MKY_PSM OF 'COLBMPSM.TXT'
       FIN-EDT-MKY-PSM.
           EXIT.
       
       EDT-AKY-PSM SECTION.
       INI-EDT-AKY-PSM.
*% INCLUDE EDT_AKY_PSM OF 'COLBMPSM.TXT'
*% INCLUDE FIN_EDT_AKY_PSM OF 'COLBMPSM.TXT'
       FIN-EDT-AKY-PSM.
           EXIT.
       
       EDT-FLD-PSM SECTION.
       INI-EDT-FLD-PSM.
*% INCLUDE EDT_FLD_PSM OF 'COLBMPSM.TXT'
           IF FRM-SGV-MTO1-LEN IN PSM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-MTO1-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-MTO1 IN PSM-FLD TO FRM-SGV-MTO1-EDT IN PSM-EDT.
           MOVE FRM-SGV-MTO1-EDT IN PSM-EDT TO 
                FRM-SGV-MTO1-ALF IN PSM-FLD.
           IF FRM-SGV-MTO2-LEN IN PSM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-MTO2-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-MTO2 IN PSM-FLD TO FRM-SGV-MTO2-EDT IN PSM-EDT.
           MOVE FRM-SGV-MTO2-EDT IN PSM-EDT TO 
                FRM-SGV-MTO2-ALF IN PSM-FLD.
           IF FRM-SGV-MTO3-LEN IN PSM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-MTO3-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-MTO3 IN PSM-FLD TO FRM-SGV-MTO3-EDT IN PSM-EDT.
           MOVE FRM-SGV-MTO3-EDT IN PSM-EDT TO 
                FRM-SGV-MTO3-ALF IN PSM-FLD.
           IF FRM-SGV-MTO4-LEN IN PSM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-MTO4-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-MTO4 IN PSM-FLD TO FRM-SGV-MTO4-EDT IN PSM-EDT.
           MOVE FRM-SGV-MTO4-EDT IN PSM-EDT TO 
                FRM-SGV-MTO4-ALF IN PSM-FLD.
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-NDIA-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(1) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT.
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(1).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-NDIA-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(2) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT.
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(2).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-NDIA-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(3) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT.
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(3).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-NDIA-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(4) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT.
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(4).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-NDIA-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(5) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT.
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(5).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-NDIA-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(6) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT.
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(6).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT1-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(1) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(1).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT1-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(2) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(2).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT1-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(3) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(3).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT1-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(4) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(4).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT1-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(5) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(5).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT1-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(6) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(6).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT2-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(1) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(1).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT2-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(2) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(2).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT2-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(3) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(3).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT2-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(4) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(4).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT2-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(5) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(5).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT2-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(6) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(6).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT3-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(1) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(1).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT3-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(2) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(2).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT3-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(3) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(3).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT3-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(4) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(4).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT3-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(5) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(5).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT3-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(6) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(6).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT4-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(1) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(1).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT4-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(2) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(2).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT4-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(3) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(3).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT4-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(4) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(4).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT4-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(5) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(5).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-INT4-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(6) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT.
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(6).
*% RREG = "PSM"
*% RREG_FRM = "PSM"
*% NOMB = "FACT"
           IF POC-NUM-PREP-LEN IN PSM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POC-NUM-PREP-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE POC-NUM-PREP IN PSM-FLD TO POC-NUM-PREP-EDT IN PSM-EDT.
           MOVE POC-NUM-PREP-EDT IN PSM-EDT TO 
                POC-NUM-PREP-ALF IN PSM-FLD.
*% INCLUDE FIN_EDT_FLD_PSM OF 'COLBMPSM.TXT'
       FIN-EDT-FLD-PSM.
           EXIT.
*% INCLUDE EOF_BQ OF 'COLBMPSM.TXT'
*% INCLUDE EOF OF 'COLBMPSM.TXT'
*% INCLUDE EOF_IBM OF 'COLBMPSM.TXT'
