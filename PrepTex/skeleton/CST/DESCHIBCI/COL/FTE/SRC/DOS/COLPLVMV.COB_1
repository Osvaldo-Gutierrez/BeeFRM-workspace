       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLVMV.
       AUTHOR.          BEE TEAM(JGM).
       DATE-WRITTEN.    05-Feb-99 12:56 PM.

      * Programa Listador de Reporte VMV con Sort.
      *
      * V 1.1.2
      *


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            C01 IS SALTO
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTVMV         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTVMV         ASSIGN TO        UT-S-RPTVMV.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *    SELECT RPTVMV         ASSIGN TO        UT-S-RPTVMV.
           SELECT RPTVMV         ASSIGN TO        RPTVMV.

      *<<<< IOS
      *DOS SELECT RPTMVR         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTMVR         ASSIGN TO        UT-S-RPTMVR.
      *    SELECT RPTMVR         ASSIGN TO        UT-S-RPTMVR.
           SELECT RPTMVR         ASSIGN TO        RPTMVR.
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY COLRRVMV.

       FD  RPTVMV LABEL RECORDS OMITTED
                  BLOCK CONTAINS 0 RECORDS
                  RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-VMV     PIC X(132).


      *<<<< FLS
       FD  RPTMVR LABEL RECORDS OMITTED
                  BLOCK CONTAINS 0 RECORDS
                  RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-MVR PIC X(132).

       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VMV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBRVMV.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWVMV.

      *<<<< RW
       COPY COLRWMVR.
      *>>>>
       COPY COLRNVMV.

      *<<<< RN
       COPY COLRNMVR.
      *>>>>
       COPY COLROVMV.

      *<<<< RO
       COPY COLROMVR.
      *>>>>
       COPY GNSWGSYS.
       01  PGM-HRSR-VMV   VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-VMV  VALUE 'S'.

       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).

      *<<<< WSS
      *<<<< WSS
       COPY GNSBRMSC.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABBRVLR.
       COPY TABBRCAM.
       COPY COLBROPC.
       COPY COLBRVEN.
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY COLWGVEN.
       COPY GNSWGCVI.
       COPY GNSWGPES.
       COPY COLWGINT.
       COPY COLBREVC.
       COPY COLBRRCV.
       COPY COLBRRDT.
       COPY COLWGCAU.
       COPY COLWGCTO.
       COPY TABBRTIO.

       01  PGM-HRSR-MVR   VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-MVR   VALUE 'S'.

       01  WSS-VARI.
            03 WSS-NUM-FFVA    VALUE ZEROES   PIC 9(04).
            03 VEN-FECH        VALUE SPACES   PIC X(01).
            03 WSS-PLVMV.
               07 WSS-GLS-VMV                     PIC X(08).
            05 WSS-FEC-FVM1.
               07 WSS-NUM-DVM1                     PIC 9(02).
               07 WSS-NUM-MVM1                     PIC 9(02).
               07 WSS-NUM-SVM1                     PIC 9(02).
               07 WSS-NUM-AVM1                     PIC 9(02).
            05 WSS-FEC-FVM2.
               07 WSS-NUM-DVM2                     PIC 9(02).
               07 WSS-NUM-MVM2                     PIC 9(02).
               07 WSS-NUM-SVM2                     PIC 9(02).
               07 WSS-NUM-AVM2                     PIC 9(02).
            03  WSS-FEC-FUCT.
               05  WSS-NUM-SUCT               PIC 9(02).
               05  WSS-NUM-AUCT               PIC 9(02).
               05  WSS-NUM-MUCT               PIC 9(02).
               05  WSS-NUM-DUCT               PIC 9(02).
           03  WSS-FEC-FXXX.
               05  WSS-NUM-SXXX               PIC 9(02).
               05  WSS-NUM-AXXX               PIC 9(02).
               05  WSS-NUM-MXXX               PIC 9(02).
               05  WSS-NUM-DXXX               PIC 9(02).
           03  WSS-PVEZ        VALUE SPACES   PIC X(01).
      *       RESPALDA VEN(1) PARA OPERACIONES ESTRUCTURADAS, PARA
      *       EXPANDIR PROXIMOS VENCIMIENTOS DE ESA ESTRUCTURA DENTRO
      *       DEL RANGO DE FECHAS Y LUEGO RESTAURARLO Y SEGUIR RECORRIEN
      *       LA BASE DE DATOS
           03 SCR-VEN-KEY-IVEN                       PIC X(15).
           03 WSS-VEN-KEY-IVEN                       PIC X(15).
           03 PGM-STAT-RDT VALUE SPACES              PIC X(02).
              88 PGM-STAT-RDT-OKS VALUE  '00'.

      *       INDICADOR PARA OBTENER VENCIMIENTOS DENTRO DEL RANGO
      *       ASOCIADOS A UNA ESTRUCTURA
           03 WSS-IND-RECO   VALUE 0              PIC 9(01).
              88 RECORRE-ESTRUCTURA               VALUE 1.

           03 WSS-IND-EXPA   VALUE ' '            PIC X(01).
              88 EXPANDI-SI                       VALUE 'S'.
              88 EXPANDI-NO                       VALUE 'N'.

      *       INDICADOR PARA DETERMINAR EOF DE RDT
           03 WSS-IND-LAST   VALUE ' '             PIC X(01).
              88 LAST-RDT VALUE 'S'.

      *       NRO OPERACION PARA RDT'S DE UN MISMO DOCUMENTO
           03 WSS-RDT-CIC-IOPC                    PIC X(12).

      *       NRO DOCUMENTO PARA RDT'S DE UN MISMO DOCUMENTO
           03 WSS-RDT-NUM-IDLC                    PIC 9(03).
           03 WSS-NUM-IVCT                        PIC 9(03).

      *       STATUS VALIDACION PRO-DLC-VEN
           03 WSS-IND-DLC                         PIC X(01).
      *
      *    Saldo Documento
           03  WSS-RDT-VAL-SRDT   COMP-3          PIC 9(11)V9(04).
      *
           03 WSS-FEC-FINI.
              05 WSS-NUM-DINI                     PIC 9(02).
              05 WSS-NUM-MINI                     PIC 9(02).
              05 WSS-NUM-SINI                     PIC 9(02).
              05 WSS-NUM-AINI                     PIC 9(02).
           03 WSS-FEC-FTER.
              05 WSS-NUM-DTER                     PIC 9(02).
              05 WSS-NUM-MTER                     PIC 9(02).
              05 WSS-NUM-STER                     PIC 9(02).
              05 WSS-NUM-ATER                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-FEC-FFET.
              05 WSS-NUM-SFET                     PIC 9(02).
              05 WSS-NUM-AFET                     PIC 9(02).
              05 WSS-NUM-MFET                     PIC 9(02).
              05 WSS-NUM-DFET                     PIC 9(02).
           03 WSS-FEC-FREG.
              05 WSS-NUM-SREG                     PIC 9(02).
              05 WSS-NUM-AREG                     PIC 9(02).
              05 WSS-NUM-MREG                     PIC 9(02).
              05 WSS-NUM-DREG                     PIC 9(02).
           03 WSS-COD-OFOC                        PIC X(03).
           03 WSS-COD-OFOR                        PIC X(03).
           03 WSS-COD-RMOC                        PIC X(12).
           03 WSS-IND-NEXT                        PIC 9(01).
           03 WSS-CIC-IOPC                        PIC X(12).
           03 WSS-CIC-IAUX                        PIC X(12).
           03 WSS-GLS-NOMM                        PIC X(25).
           03 WSS-GLS-NOMF                        PIC X(25).
           03 WSS-SW                              PIC 9(01).
      * CODIGOS PARA SITUACIONES MOROSA.
           03 WSS-COD-SMOR      VALUE LOW-VALUES  PIC X(08).

      *VERIFCAR CIC MONEDA CHILENA Y NO PESOS
           03  WSS-VLR.
               05  WSS-CIC-VCAM.
      *            Tipo Valor
                   07  WSS-CIC-TVAL                     PIC X(01).
      *            Codigo Valor
                   07  WSS-CIC-CVAL                     PIC X(03).
      *            Tipo Cambio
                   07  WSS-CIC-TCAM                     PIC X(08).

      * NUMERO SIN DECIMALES ( PARA TRUNCAR )
            03 WSS-NUM-NDEC                              PIC 9(12).
            03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                      PIC X(03).
               05  WSS-COD-AOOC                      PIC X(03).
      * GLOSAS TIO + AUX
            03  WSS-GLS-TIAU.
               05 WSS-GLS-TIO                        PIC X(40).
               05 WSS-GLS-AUX                        PIC X(12).
      *
            03  WSS-GLS-DAT3.
               05 FILLER                               PIC X(17).
               05 WSS-IND-OMIT                         PIC X(01).
               05 FILLER                               PIC X(12).
            03 WSS-IND                                 PIC 9(02).
            03 TAB-FLU-MOR-FUT.
               05 WSS-TAB-MOR      OCCURS 25.
                  07 WSS-COD-MORN                      PIC X(06).
                  07 WSS-VAL-MORN                      PIC 9(12)V9(04).
                  07 WSS-COD-MORE                      PIC X(06).
                  07 WSS-VAL-MORE                      PIC 9(12)V9(04).
               05 WSS-TAB-FUT      OCCURS 25.
                  07 WSS-COD-FUTN                      PIC X(06).
                  07 WSS-VAL-FUTN                      PIC 9(12)V9(04).
                  07 WSS-COD-FUTE                      PIC X(06).
                  07 WSS-VAL-FUTE                      PIC 9(12)V9(04).

            03 WSS-COD-COOC.
               05 WSS-IND-COOC      OCCURS 10           PIC X(06).
            03 WSS-IND-HAYR                             PIC 9(01).
            03 WSS-FEC-FINT.
               05  WSS-NUM-SINT               PIC 9(02).
               05  WSS-NUM-AINT               PIC 9(02).
               05  WSS-NUM-MINT               PIC 9(02).
               05  WSS-NUM-DINT               PIC 9(02).
      *>>>>

      *<<<< WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
      *>>>>

      * AQUI EXISTIA LABEL RF INI

      * AQUI EXISTIA LABEL RF FIN
       COPY COLRTVMV.

      *<<<< RT
       COPY COLRTMVR.
      *>>>>

       PROCEDURE DIVISION.
      *==================

      * AQUI EXISTIA LABEL FIN_DEC INI

      * AQUI EXISTIA LABEL FIN_DEC FIN

       MAIN SECTION.
      *------------
       INI-MAIN.

      *    MOVE SYS-MXFL TO SYS-CMND.
      *    PERFORM GNS-PRO-SYS.
       COPY GNSBGEDB.
      *    MOVE 'COL' TO RPT-SIST.
           MOVE 'COLPLVMV' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *VAL-FEC Valida Fecha de Termino
      *
       INI-LISTADO.
           MOVE FIO-INP     TO FIO-CMND.
           PERFORM COL-FIO-VMV.
      *
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VMV.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN
           ELSE
              MOVE VMV TO WSS-PLVMV
              PERFORM MOVER-FECHAS
              MOVE FIO-GET-NXT TO FIO-CMND
              PERFORM COL-FIO-VMV
              IF FIO-STAT-OKS
                 MOVE ' ' TO PGM-STAT-SRT
                 GO TO INI-OUT-SRT
              ELSE
                GO TO FIN-MAIN.
      *>>>>
           SORT GNSSRT
       COPY COLRSVMV.

           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.

           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-VMV.
       FST-INP-SRT.

           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-VMV.

       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.

       MOV-INP-SRT.
       COPY COLRMVMV.

           RELEASE SRT.
       NXT-INP-SRT.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VMV.

           GO TO LUP-INP-SRT.
       FIN-INP-SRT.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-VMV.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.

      *<<<< INI_OUT
        INI-OUT-MVM.
           OPEN OUTPUT RPTVMV.
           PERFORM CAL-HDR.
           PERFORM INITIATE-RPTVMV.
      *Lee reg VMV.
      *    16-MAR-99 08:58 AM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
           MOVE VMV-COD-RMOC IN VMV TO VMV-COD-RMOC IN SRT.
           MOVE VMV-FEC-FVEN IN VMV TO VMV-FEC-FVEN IN SRT.
           MOVE VMV-COD-VCOC IN VMV TO VMV-COD-VCOC IN SRT.
           MOVE VMV-COD-COOC IN VMV TO VMV-COD-COOC IN SRT.
           MOVE VMV-MSC-TVOC IN VMV TO VMV-MSC-TVOC IN SRT.
           MOVE WSS-IND-SORT IN WSS-VMV TO WSS-IND-SORT IN SRT.
           MOVE VMV-GLS-NOMC IN VMV TO VMV-GLS-NOMC IN SRT.
           MOVE VMV-NUM-ICLI IN VMV TO VMV-NUM-ICLI IN SRT.
           MOVE VMV-VRF-ICLI IN VMV TO VMV-VRF-ICLI IN SRT.
           MOVE VMV-IND-ICLI IN VMV TO VMV-IND-ICLI IN SRT.
           MOVE VMV-GLS-ICLI IN VMV TO VMV-GLS-ICLI IN SRT.
           MOVE VMV-CAI-IOPC IN VMV TO VMV-CAI-IOPC IN SRT.
           MOVE VMV-IIC-IOPC IN VMV TO VMV-IIC-IOPC IN SRT.
           MOVE VMV-IND-MORA IN VMV TO VMV-IND-MORA IN SRT.
           MOVE VMV-NUM-IVCT IN VMV TO VMV-NUM-IVCT IN SRT.
           MOVE VMV-IIC-ICYA IN VMV TO VMV-IIC-ICYA IN SRT.
           MOVE VMV-SGV-TINT IN VMV TO VMV-SGV-TINT IN SRT.
           MOVE VMV-NUM-DVEN IN VMV TO VMV-NUM-DVEN IN SRT.
           MOVE VMV-NUM-MVEN IN VMV TO VMV-NUM-MVEN IN SRT.
           MOVE VMV-NUM-SVEN IN VMV TO VMV-NUM-SVEN IN SRT.
           MOVE VMV-NUM-AVEN IN VMV TO VMV-NUM-AVEN IN SRT.
           MOVE VMV-IND-TAPO IN VMV TO VMV-IND-TAPO IN SRT.
           MOVE VMV-VAL-VTRA IN VMV TO VMV-VAL-VTRA IN SRT.
           MOVE VMV-COD-OFOC IN VMV TO VMV-COD-OFOC IN SRT.
           MOVE SRT TO SRT-OLD-VMV.
           MOVE SRT TO SRT-CUR-VMV.
      *
      *Reporte MVR
           MOVE 'N' TO WSS-IND-EXPA IN WSS-VARI.
           MOVE  1  TO WSS-IND-HAYR IN WSS-VARI.
           OPEN OUTPUT RPTMVR.
           PERFORM INITIATE-RPTMVR.
           MOVE  0  TO WSS-SW IN WSS-VARI.
           MOVE VMV-COD-OFOC IN SRT TO WSS-COD-OFOR IN WSS-VARI.
           MOVE VMV-COD-OFOC IN SRT TO WSS-COD-OFOC IN WSS-VARI.
           MOVE VMV-COD-RMOC IN SRT TO WSS-COD-RMOC IN WSS-VARI.
           MOVE SPACES              TO WSS-GLS-NOMM IN WSS-VARI
                                       WSS-GLS-NOMF IN WSS-VARI.
           PERFORM MVR-FST-PRO-CTL.
           PERFORM VMV-FST-PRO-CTL.
           PERFORM INI-TAB-FLU-MOR-FUT.
           GO TO LUP-OUT-SRT.
      *>>>>Fin ciclo de la rutina-jgm
      *    PERFORM VMV-FST-PRO-CTL.
       LUP-OUT-SRT.

      *<<<< LUP_OUT
      * Mediante BUS-TAB Busca Clase de Operacion de Tabla AUX
       LUP-OUT-VMV.
      *
           IF VMV-COD-COOC IN VMV > SPACES
              MOVE 'COL'               TO TAB-COD-SIST
              MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
              MOVE VMV-COD-TOOC IN VMV TO WSS-COD-TOOC IN WSS-VARI
              MOVE VMV-COD-AOOC IN VMV TO WSS-COD-AOOC IN WSS-VARI
              MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AUX IN WSS-VARI
           ELSE
              MOVE SPACES TO WSS-GLS-AUX IN WSS-VARI.

           IF VMV-COD-TOOC IN VMV > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
              MOVE VMV-COD-TOOC IN VMV TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TIO IN WSS-VARI
           ELSE
              MOVE SPACES TO WSS-GLS-TIO IN WSS-VARI.
      *
           MOVE WSS-GLS-TIAU IN WSS-VARI TO CPT-STRN
           PERFORM CPT-BLKS
           MOVE WSS-GLS-AUX IN WSS-VARI TO WSS-GLS-COOC IN WSS-VMV.


      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF VMV-COD-VCOC IN VMV > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
              MOVE VMV-COD-VCOC IN VMV TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-VCOC IN WSS-VMV
           ELSE
              MOVE SPACES TO WSS-GLS-VCOC IN WSS-VMV.
      *
           IF VMV-GLS-ICLI IN SRT > SPACES
              MOVE '-'    TO WSS-GLS-AUXI IN WSS-VMV
           ELSE
              MOVE SPACES TO WSS-GLS-AUXI IN WSS-VMV.
      *
       VALIDA-IND-CALC.
            PERFORM GENERATE-DL-VMV.
            PERFORM VALIDA-MVR.
            MOVE VMV-COD-OFOC IN SRT TO WSS-COD-OFOR IN WSS-VARI.
            MOVE VMV-COD-OFOC IN SRT TO WSS-COD-OFOC IN WSS-VARI.
            MOVE VMV-COD-RMOC IN SRT TO WSS-COD-RMOC IN WSS-VARI.
      *
       NXT-OUT-VMV.
            MOVE SRT TO SRT-OLD-VMV.
       RET-OUT-VMV.
      *Lee reg VMV.
           MOVE 'N' TO WSS-IND-EXPA IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VMV.
           IF NOT FIO-STAT-OKS
              GO TO FIN-OUT-SRT.

      *    16-MAR-99 08:58 AM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
           MOVE VMV-COD-RMOC IN VMV TO VMV-COD-RMOC IN SRT.
           MOVE VMV-FEC-FVEN IN VMV TO VMV-FEC-FVEN IN SRT.
           MOVE VMV-COD-VCOC IN VMV TO VMV-COD-VCOC IN SRT.
           MOVE VMV-COD-COOC IN VMV TO VMV-COD-COOC IN SRT.
           MOVE VMV-MSC-TVOC IN VMV TO VMV-MSC-TVOC IN SRT.
           MOVE WSS-IND-SORT IN WSS-VMV TO WSS-IND-SORT IN SRT.
           MOVE VMV-GLS-NOMC IN VMV TO VMV-GLS-NOMC IN SRT.
           MOVE VMV-NUM-ICLI IN VMV TO VMV-NUM-ICLI IN SRT.
           MOVE VMV-VRF-ICLI IN VMV TO VMV-VRF-ICLI IN SRT.
           MOVE VMV-IND-ICLI IN VMV TO VMV-IND-ICLI IN SRT.
           MOVE VMV-GLS-ICLI IN VMV TO VMV-GLS-ICLI IN SRT.
           MOVE VMV-CAI-IOPC IN VMV TO VMV-CAI-IOPC IN SRT.
           MOVE VMV-IIC-IOPC IN VMV TO VMV-IIC-IOPC IN SRT.
           MOVE VMV-IND-MORA IN VMV TO VMV-IND-MORA IN SRT.
           MOVE VMV-NUM-IVCT IN VMV TO VMV-NUM-IVCT IN SRT.
           MOVE VMV-IIC-ICYA IN VMV TO VMV-IIC-ICYA IN SRT.
           MOVE VMV-SGV-TINT IN VMV TO VMV-SGV-TINT IN SRT.
           MOVE VMV-NUM-DVEN IN VMV TO VMV-NUM-DVEN IN SRT.
           MOVE VMV-NUM-MVEN IN VMV TO VMV-NUM-MVEN IN SRT.
           MOVE VMV-NUM-SVEN IN VMV TO VMV-NUM-SVEN IN SRT.
           MOVE VMV-NUM-AVEN IN VMV TO VMV-NUM-AVEN IN SRT.
           MOVE VMV-IND-TAPO IN VMV TO VMV-IND-TAPO IN SRT.
           MOVE VMV-VAL-VTRA IN VMV TO VMV-VAL-VTRA IN SRT.
           MOVE VMV-COD-OFOC IN VMV TO VMV-COD-OFOC IN SRT.
           GO TO LUP-OUT-VMV.
      *>>>>
       GEN-OUT-SRT.
           PERFORM GENERATE-DL-VMV.

       NXT-OUT-SRT.
           MOVE SRT TO SRT-OLD-VMV.
       RET-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
           PERFORM TERMINATE-RPTMVR.
           IF WSS-IND-HAYR IN WSS-VARI = 0
               MOVE 'NO EXISTE INFORMACION QUE LISTAR, DE ACUERDO A LOS
      -             'PARAMETROS INGRESADOS' TO WSS-GLS-MENS IN WSS-VMV
               PERFORM PRO-DL-MSG
               PERFORM TERMINATE-RPTVMV
               CLOSE RPTVMV
               GO TO EXT-OUT-SRT.
      *>>>>
           IF HAY-REGISTROS-EN-SORT-VMV
                PERFORM TERMINATE-RPTVMV.

      *<<<< FIN_TMT
      *     MOVE FIO-CLO TO FIO-CMND.
      *     PERFORM COL-FIO-VMV.
      *
           PERFORM BUS-GLS-MVR.
           PERFORM PRO-DL-MVR.
           PERFORM GEN-LIN-MOR.
           PERFORM GEN-LIN-FUT.
           PERFORM PRO-DL-RAY.
           PERFORM TERMINATE-RPTMVR.
           CLOSE RPTMVR.
      *>>>>
           CLOSE RPTVMV.
           GO TO FIN-MAIN.
       EXT-OUT-SRT.
           EXIT.
       COPY COLBFVMV.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGIRH.
       COPY COLREVMV.
      *    02-FEB-99 02:00 PM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
       D-CF-VMV-VMV-COD-OFOC SECTION.
       INI-CF-VMV-VMV-COD-OFOC.
           MOVE ZEROES TO RPT-VMV-PAGE-COUNTER IN RPT-VARI-VMV.
       FIN-CF-VMV-VMV-COD-OFOC.
           EXIT.
       D-CH-VMV-VMV-COD-OFOC SECTION.
       INI-CH-VMV-VMV-COD-OFOC.

       FIN-CH-VMV-VMV-COD-OFOC.
           EXIT.
       D-CF-VMV-VMV-COD-RMOC SECTION.
       INI-CF-VMV-VMV-COD-RMOC.

      *<<<< CF_VMV_OPC_COD_RMOC
           IF WSS-COD-OFOC IN WSS-VARI NOT =
                  WSS-COD-OFOC IN WSS-MVR
              MOVE ZEROES TO RPT-MVR-PAGE-COUNTER IN RPT-VARI-MVR
              PERFORM MVR-WRT-PH-SRE.
           MOVE  1  TO WSS-SW IN WSS-VARI.
      *>>>>
       FIN-CF-VMV-VMV-COD-RMOC.
           EXIT.
       D-CF-VMV-VMV-FEC-FVEN SECTION.
       INI-CF-VMV-VMV-FEC-FVEN.

       FIN-CF-VMV-VMV-FEC-FVEN.
           EXIT.
       D-PH-VMV SECTION.
       INI-PH-VMV.

      *<<<< PH_VMV
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF VMV-COD-OFOC IN VMV > SPACES
               MOVE VMV-COD-OFOC IN VMV TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-VMV
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-VMV.

      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF VMV-COD-RMOC IN VMV > SPACES
               MOVE VMV-COD-RMOC IN VMV TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-VMV
           ELSE
               MOVE SPACES TO WSS-GLS-RMOC IN WSS-VMV.
      *>>>> END
       FIN-PH-VMV.
           EXIT.
       D-DL-VMV SECTION.
       INI-DL-VMV.

       FIN-DL-VMV.
           EXIT.
       D-DL-NUL SECTION.
       INI-DL-NUL.

       FIN-DL-NUL.
           EXIT.
       D-DL-MSG SECTION.
       INI-DL-MSG.

       FIN-DL-MSG.
           EXIT.
       COPY GNSBGABT.


      *<<<< EOF
      ******************************************************************
       VALIDA-MVR SECTION.
       INI-VALIDA-MVR.
      *<<<< FIN_GEN_OUT
           IF WSS-SW = 1
               PERFORM BUS-GLS-MVR
               PERFORM PRO-DL-MVR
               PERFORM GEN-LIN-MOR
               PERFORM GEN-LIN-FUT
               PERFORM PRO-DL-RAY
               PERFORM INI-TAB-FLU-MOR-FUT
               MOVE SPACES TO WSS-GLS-MNAM IN WSS-MVR
                              WSS-GLS-MNAF IN WSS-MVR
                              WSS-GLS-MEXM IN WSS-MVR
                              WSS-GLS-MEXF IN WSS-MVR

               MOVE ZEROES TO WSS-VAL-FVMC IN WSS-MVR
                              WSS-VAL-FVME IN WSS-MVR
                              WSS-NUM-NCVM IN WSS-MVR
                              WSS-VAL-FFVC IN WSS-MVR
                              WSS-VAL-FFVE IN WSS-MVR
                              WSS-NUM-NCFV IN WSS-MVR
                              WSS-SW       IN WSS-VARI.
           IF VMV-IND-MORA IN SRT = 'M'
               PERFORM FLU-VEN-MOR
           ELSE
               PERFORM FLU-FUT-VEN.
       FIN-VALIDA-MVR.
           EXIT.
      * Valida que la Clase del parametro Exista
       VAL-PAR-COOC SECTION.
       INI-VAL-PAR-COOC.
           IF WSS-IND-COOC IN WSS-VARI(WSS-IND) > SPACES
               MOVE 'COL'           TO TAB-COD-SIST
               MOVE 'AUX'           TO TAB-COD-TTAB IN TAB
               MOVE WSS-IND-COOC IN WSS-VARI(WSS-IND)
                                    TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS IN MSG > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                           ' CLASE : ' WSS-IND-COOC IN WSS-VARI(WSS-IND)
                   MOVE SPACES TO WSS-IND-COOC IN WSS-VARI(WSS-IND).
           ADD 1 TO WSS-IND IN WSS-VARI.
       FIN-VAL-PAR-COOC.
           EXIT.
      ******************************************************************
      *DAD ini  31-JUL-1991
      * Valida que pertenezca a Clase del parametro
       VAL-SEL-COOC SECTION.
       INI-VAL-SEL-COOC.
           ADD 1 TO WSS-IND IN WSS-VARI.
       FIN-VAL-SEL-COOC.
           EXIT.
      *DAD fin  31-JUL-1991
      ******************************************************************
       CNV-VCAM SECTION.
       INI-CNV-VCAM.
           MOVE ZEROES              TO VMV-VAL-VTRA IN SRT.
           MOVE VMV-VAL-VTRA IN VMV TO VMV-VAL-VTRA IN SRT.
           GO TO FIN-CNV-VCAM.
       FIN-CNV-VCAM.
           EXIT.
      ******************************************************************
      ******************************************************************
       INI-TAB-FLU-MOR-FUT SECTION.
       INI-INI-TAB-FLU-MOR-FUT.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-INI-TAB-FLU-MOR-FUT.
           MOVE ZEROES TO WSS-VAL-MORN IN WSS-VARI(WSS-IND)
                          WSS-VAL-MORE IN WSS-VARI(WSS-IND)
                          WSS-VAL-FUTN IN WSS-VARI(WSS-IND)
                          WSS-VAL-FUTE IN WSS-VARI(WSS-IND).
           MOVE SPACES TO WSS-COD-MORN IN WSS-VARI(WSS-IND)
                          WSS-COD-MORE IN WSS-VARI(WSS-IND)
                          WSS-COD-FUTN IN WSS-VARI(WSS-IND)
                          WSS-COD-FUTE IN WSS-VARI(WSS-IND).
           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               GO TO FIN-INI-TAB-FLU-MOR-FUT.
           GO TO LUP-INI-TAB-FLU-MOR-FUT.
       FIN-INI-TAB-FLU-MOR-FUT.
           EXIT.
      ******************************************************************
       BUS-GLS-VMV SECTION.
       INI-BUS-GLS-VMV.
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF WSS-COD-OFOC IN WSS-VARI > SPACES
               MOVE WSS-COD-OFOC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-VMV
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-VMV.

      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF WSS-COD-RMOC IN WSS-VARI > SPACES
               MOVE WSS-COD-RMOC IN WSS-VARI TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-VMV
           ELSE
               MOVE SPACES TO WSS-GLS-RMOC IN WSS-VMV.
       FIN-BUS-GLS-VMV.
           EXIT.
       BUS-GLS-MVR SECTION.
       INI-BUS-GLS-MVR.
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           MOVE  WSS-NUM-FFVA IN WSS-VARI TO
                                    WSS-NUM-FFVA IN WSS-MVR.
           MOVE WSS-COD-OFOR IN WSS-VARI TO
                                WSS-COD-OFOC IN WSS-MVR.
           IF WSS-COD-OFOR IN WSS-VARI > SPACES
               MOVE WSS-COD-OFOR IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-MVR
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-MVR.

      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF WSS-COD-RMOC IN WSS-VARI > SPACES
               MOVE WSS-COD-RMOC IN WSS-VARI TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-MVR
           ELSE
               MOVE SPACES TO WSS-GLS-RMOC IN WSS-MVR.
       FIN-BUS-GLS-MVR.
           EXIT.
       MOVER-FECHAS SECTION.
       INI-MOVER-FECHAS.
           MOVE WSS-NUM-DVM1 IN WSS-VARI TO WSS-NUM-DPRO IN WSS-VMV
                                            WSS-NUM-DPRO IN WSS-MVR
                                            WSS-NUM-DINI IN WSS-VARI.
           MOVE WSS-NUM-MVM1 IN WSS-VARI TO WSS-NUM-MPRO IN WSS-VMV
                                            WSS-NUM-MPRO IN WSS-MVR
                                            WSS-NUM-MINI IN WSS-VARI.
           MOVE WSS-NUM-SVM1 IN WSS-VARI TO WSS-NUM-SPRO IN WSS-VMV
                                            WSS-NUM-SPRO IN WSS-MVR
                                            WSS-NUM-SINI IN WSS-VARI.
           MOVE WSS-NUM-AVM1 IN WSS-VARI TO WSS-NUM-APRO IN WSS-VMV
                                            WSS-NUM-APRO IN WSS-MVR
                                            WSS-NUM-AINI IN WSS-VARI.
      *
           MOVE WSS-NUM-DVM2 IN WSS-VARI TO WSS-NUM-DTER IN WSS-VMV
                                            WSS-NUM-DTER IN WSS-MVR
                                            WSS-NUM-DTER IN WSS-VARI.
           MOVE WSS-NUM-MVM2 IN WSS-VARI TO WSS-NUM-MTER IN WSS-VMV
                                            WSS-NUM-MTER IN WSS-MVR
                                            WSS-NUM-MTER IN WSS-VARI.
           MOVE WSS-NUM-SVM2 IN WSS-VARI TO WSS-NUM-STER IN WSS-VMV
                                            WSS-NUM-STER IN WSS-MVR
                                            WSS-NUM-STER IN WSS-VARI.
           MOVE WSS-NUM-AVM2 IN WSS-VARI TO WSS-NUM-ATER IN WSS-VMV
                                            WSS-NUM-ATER IN WSS-MVR
                                            WSS-NUM-ATER IN WSS-VARI.

           MOVE WSS-FEC-FINI IN WSS-VARI TO  FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO  FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF  FEC-STAT-OKS
               MOVE FEC-NDIA TO WSS-NUM-FFVA IN WSS-VARI.
      *
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
       FIN-MOVER-FECHAS.
           EXIT.
       FLU-VEN-MOR SECTION.
      *--------------------*
       INI-FLU-VEN-MOR.
           IF VMV-MSC-TVOC IN SRT = '0'
               PERFORM MOR-VAL-NAC
           ELSE
               PERFORM MOR-VAL-EXT.

           IF  VMV-GLS-NOMC IN SRT NOT = WSS-GLS-NOMM IN WSS-VARI OR
              (VMV-GLS-NOMC IN SRT     = WSS-GLS-NOMM IN WSS-VARI AND
               VMV-COD-RMOC IN SRT NOT = WSS-COD-RMOC IN WSS-VARI )
               ADD  1  TO WSS-NUM-NCVM IN WSS-MVR
               MOVE VMV-GLS-NOMC IN SRT TO WSS-GLS-NOMM IN WSS-VARI.
       FIN-FLU-VEN-MOR.
           EXIT.

       FLU-FUT-VEN SECTION.
      *--------------------*
       INI-FLU-FUT-VEN.
           IF VMV-MSC-TVOC IN SRT = '0'
               PERFORM FUT-VAL-NAC
           ELSE
               PERFORM FUT-VAL-EXT.

           IF VMV-GLS-NOMC IN SRT NOT  = WSS-GLS-NOMF IN WSS-VARI OR
              (VMV-GLS-NOMC IN SRT     = WSS-GLS-NOMF IN WSS-VARI AND
               VMV-COD-RMOC IN SRT NOT = WSS-COD-RMOC IN WSS-VARI )

               ADD  1  TO WSS-NUM-NCFV IN WSS-MVR
               MOVE VMV-GLS-NOMC IN SRT TO WSS-GLS-NOMF IN WSS-VARI.
       FIN-FLU-FUT-VEN.
           EXIT.

       GEN-LIN-MOR SECTION.
      *-------------------*
       INI-GEN-LIN-MOR.
           MOVE 1 TO WSS-IND IN WSS-VARI.
           IF WSS-COD-MORN IN WSS-VARI(WSS-IND) = SPACES AND
              WSS-COD-MORE IN WSS-VARI(WSS-IND) = SPACES
               PERFORM PRO-DL-FMO
               GO TO FIN-GEN-LIN-MOR.
       LUP-GEN-LIN-MOR.
           IF WSS-COD-MORN IN WSS-VARI(WSS-IND) > SPACES
                MOVE WSS-COD-MORN IN WSS-VARI(WSS-IND)
                                         TO OPC-COD-VCOC IN OPC
                PERFORM BUS-GLS-MONE
                MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MNAM IN WSS-MVR
                MOVE WSS-VAL-MORN IN WSS-VARI(WSS-IND)
                                         TO WSS-VAL-FVMC IN WSS-MVR
           ELSE
                MOVE SPACES TO WSS-GLS-MNAM IN WSS-MVR
                MOVE ZEROES TO WSS-VAL-FVMC IN WSS-MVR.

           IF WSS-COD-MORE IN WSS-VARI(WSS-IND) > SPACES
                MOVE WSS-COD-MORE IN WSS-VARI(WSS-IND)
                                         TO OPC-COD-VCOC IN OPC
                PERFORM BUS-GLS-MONE
                MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MEXM IN WSS-MVR
                MOVE WSS-VAL-MORE IN WSS-VARI(WSS-IND)
                                         TO WSS-VAL-FVME IN WSS-MVR
           ELSE
                MOVE SPACES TO WSS-GLS-MEXM IN WSS-MVR
                MOVE ZEROES TO WSS-VAL-FVME IN WSS-MVR.

           PERFORM PRO-DL-FMO.
           ADD 1 TO WSS-IND IN WSS-VARI.
           IF ( WSS-COD-MORN IN WSS-VARI(WSS-IND) = SPACES AND
                WSS-COD-MORE IN WSS-VARI(WSS-IND) = SPACES ) OR
              WSS-IND IN WSS-VARI > 25
               GO TO FIN-GEN-LIN-MOR.
           GO TO LUP-GEN-LIN-MOR.
       FIN-GEN-LIN-MOR.
           EXIT.

       GEN-LIN-FUT SECTION.
      *--------------------*
       INI-GEN-LIN-FUT.
           PERFORM PRO-DL-TFU.
           MOVE 1 TO WSS-IND IN WSS-VARI.
           IF WSS-COD-FUTN IN WSS-VARI(WSS-IND) = SPACES AND
              WSS-COD-FUTE IN WSS-VARI(WSS-IND) = SPACES
               PERFORM PRO-DL-FFU
               GO TO FIN-GEN-LIN-FUT.

       LUP-GEN-LIN-FUT.
           IF WSS-COD-FUTN IN WSS-VARI(WSS-IND) > SPACES
                MOVE WSS-COD-FUTN IN WSS-VARI(WSS-IND)
                                         TO OPC-COD-VCOC IN OPC
                PERFORM BUS-GLS-MONE
                MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MNAF IN WSS-MVR
                MOVE WSS-VAL-FUTN IN WSS-VARI(WSS-IND)
                                         TO WSS-VAL-FFVC IN WSS-MVR
           ELSE
                MOVE SPACES TO WSS-GLS-MNAF IN WSS-MVR
                MOVE ZEROES TO WSS-VAL-FFVC IN WSS-MVR.

           IF WSS-COD-FUTE IN WSS-VARI(WSS-IND) > SPACES
                MOVE WSS-COD-FUTE IN WSS-VARI(WSS-IND)
                                         TO OPC-COD-VCOC IN OPC
                PERFORM BUS-GLS-MONE
                MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MEXF IN WSS-MVR
                MOVE WSS-VAL-FUTE IN WSS-VARI(WSS-IND)
                                         TO WSS-VAL-FFVE IN WSS-MVR
           ELSE
                MOVE SPACES TO WSS-GLS-MEXF IN WSS-MVR
                MOVE ZEROES TO WSS-VAL-FFVE IN WSS-MVR.

           PERFORM PRO-DL-FFU.
           ADD 1 TO WSS-IND IN WSS-VARI.
           IF ( WSS-COD-FUTN IN WSS-VARI(WSS-IND) = SPACES AND
                WSS-COD-FUTE IN WSS-VARI(WSS-IND) = SPACES ) OR
              WSS-IND IN WSS-VARI > 25
               GO TO FIN-GEN-LIN-FUT.
           GO TO LUP-GEN-LIN-FUT.
       FIN-GEN-LIN-FUT.
           EXIT.

       BUS-GLS-MONE SECTION.
      *---------------------*
       INI-BUS-GLS-MONE.
      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN OPC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
           ELSE
               MOVE SPACES TO TAB-GLS-ABRV IN TAB.
       FIN-BUS-GLS-MONE.
           EXIT.

       MOR-VAL-NAC SECTION.
      *---------------------*
       INI-MOR-VAL-NAC.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-MOR-VAL-NAC.
           IF WSS-COD-MORN IN WSS-VARI(WSS-IND) = SPACES
               MOVE VMV-COD-VCOC IN SRT TO WSS-COD-MORN
                                           IN WSS-VARI(WSS-IND)
               ADD  VMV-VAL-VTRA IN SRT TO WSS-VAL-MORN
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-MOR-VAL-NAC
           ELSE
           IF WSS-COD-MORN IN WSS-VARI(WSS-IND) = VMV-COD-VCOC IN SRT
               ADD  VMV-VAL-VTRA IN SRT TO WSS-VAL-MORN
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-MOR-VAL-NAC.

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               DISPLAY 'TABLA DE MONEDA CHILENA MOROSOS QUEDO CHICA'
               GO TO FIN-MOR-VAL-NAC.
           GO TO LUP-MOR-VAL-NAC.
       FIN-MOR-VAL-NAC.
           EXIT.

       MOR-VAL-EXT SECTION.
      *---------------------*
       INI-MOR-VAL-EXT.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-MOR-VAL-EXT.
           IF WSS-COD-MORE IN WSS-VARI(WSS-IND) = SPACES
               MOVE VMV-COD-VCOC IN SRT TO WSS-COD-MORE
                                           IN WSS-VARI(WSS-IND)
               ADD  VMV-VAL-VTRA IN SRT TO WSS-VAL-MORE
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-MOR-VAL-EXT
           ELSE
           IF WSS-COD-MORE IN WSS-VARI(WSS-IND) = VMV-COD-VCOC IN SRT
               ADD  VMV-VAL-VTRA IN SRT TO WSS-VAL-MORE
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-MOR-VAL-EXT.

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               DISPLAY 'TABLA DE MONEDA EXTRANJERA MOROSOS QUEDO CHICA'
               GO TO FIN-MOR-VAL-EXT.
           GO TO LUP-MOR-VAL-EXT.
       FIN-MOR-VAL-EXT.
           EXIT.

       FUT-VAL-NAC SECTION.
      *---------------------*
       INI-FUT-VAL-NAC.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-FUT-VAL-NAC.
           IF WSS-COD-FUTN IN WSS-VARI(WSS-IND) = SPACES
               MOVE VMV-COD-VCOC IN SRT TO WSS-COD-FUTN
                                           IN WSS-VARI(WSS-IND)
               ADD  VMV-VAL-VTRA IN SRT TO WSS-VAL-FUTN
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-FUT-VAL-NAC
           ELSE
           IF WSS-COD-FUTN IN WSS-VARI(WSS-IND) = VMV-COD-VCOC IN SRT
               ADD  VMV-VAL-VTRA IN SRT TO WSS-VAL-FUTN
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-FUT-VAL-NAC.

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               DISPLAY 'TABLA DE MONEDA CHILENA FUTUROS QUEDO CHICA'
               GO TO FIN-FUT-VAL-NAC.
           GO TO LUP-FUT-VAL-NAC.
       FIN-FUT-VAL-NAC.
           EXIT.

       FUT-VAL-EXT SECTION.
      *---------------------*
       INI-FUT-VAL-EXT.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-FUT-VAL-EXT.
           IF WSS-COD-FUTE IN WSS-VARI(WSS-IND) = SPACES
               MOVE VMV-COD-VCOC IN SRT TO WSS-COD-FUTE
                                           IN WSS-VARI(WSS-IND)
               ADD  VMV-VAL-VTRA IN SRT TO WSS-VAL-FUTE
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-FUT-VAL-EXT
           ELSE
           IF WSS-COD-FUTE IN WSS-VARI(WSS-IND) = VMV-COD-VCOC IN SRT
               ADD  VMV-VAL-VTRA IN SRT TO WSS-VAL-FUTE
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-FUT-VAL-EXT.

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               DISPLAY 'TABLA DE MONEDA EXTRANJERA FUTUROS QUEDO CHICA'
               GO TO FIN-FUT-VAL-EXT.
           GO TO LUP-FUT-VAL-EXT.
       FIN-FUT-VAL-EXT.
           EXIT.

       COPY COLREMVR.

       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY TABBFVLR.
       COPY TABBFCAM.
       COPY TABBBUSR.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBVUSR.

       COPY COLBFOPC.
       COPY COLBFRDT.


       COPY SGCBFDBC.
       COPY SGCBGCLI.

       COPY GNSBFMSC.
       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSG.

       COPY GNSBBTAB.
       COPY GNSBVTAB.

       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.

       COPY GNSBGCPT.
       D-PH-MVR SECTION.
       INI-PH-MVR.
      *<<<< PH_MVR
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF WSS-COD-OFOR IN WSS-VARI > SPACES
               MOVE WSS-COD-OFOR IN WSS-VARI TO
                                        WSS-COD-OFOC IN WSS-MVR
               MOVE WSS-COD-OFOR IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-MVR
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-MVR.

      * Mediante BUS-USR Busca Usuario de Tabla USR
      *    IF VMV-COD-RMOC IN VMV > SPACES
      *        MOVE VMV-COD-RMOC IN VMV TO USR-COD-USER IN USR
      *        PERFORM BUS-USR
      *        MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-VMV
      *    ELSE
      *        MOVE SPACES TO WSS-GLS-RMOC IN WSS-VMV.
      *>>>> END
       FIN-PH-MVR.
           EXIT.
       D-DL-MVR SECTION.
       INI-DL-MVR.
       FIN-DL-MVR.
           EXIT.
       D-DL-FMO SECTION.
       INI-DL-FMO.
       FIN-DL-FMO.
           EXIT.
       D-DL-TFU SECTION.
       INI-DL-TFU.
       FIN-DL-TFU.
           EXIT.
       D-DL-FFU SECTION.
       INI-DL-FFU.
       FIN-DL-FFU.
           EXIT.
       D-DL-RAY SECTION.
       INI-DL-RAY.
       FIN-DL-RAY.
           EXIT.
