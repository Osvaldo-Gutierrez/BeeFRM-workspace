      *
      * COLBUALM
      * Version 3.0.1 Nov-2005
      * 01-Jul-19 10:46 AM
      *
       SET-TAG-COLBUALM SECTION.
       INI-SET-TAG-COLBUALM.
           MOVE
           '<IDNMOD NOM=$COLBUALM$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$01-Jul-19 10:46 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBUALM.
           EXIT.
           
       RET-ALL-ALM SECTION.
       INI-RET-ALL-ALM.
           PERFORM KEY-ALL-ALM.
           PERFORM RET-OIA-ALM.
       FIN-RET-ALL-ALM.
           EXIT.
       
       RET-OIA-ALM SECTION.
       INI-RET-OIA-ALM.
      *>>>> INI_RET_OIA_ALM
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO OIA-NUM-DAPR IN ALM-FLD.
           MOVE HOY-MHOY TO OIA-NUM-MAPR IN ALM-FLD.
           MOVE HOY-SHOY TO OIA-NUM-SAPR IN ALM-FLD.
           MOVE HOY-AHOY TO OIA-NUM-AAPR IN ALM-FLD.
           
           MOVE HOY-HHOY TO OIA-HRA-HAPR IN ALM-FLD.
           
           MOVE EIBTRMID                TO OIA-COD-TAPR IN OIA.
      *<<<<  
           MOVE OIA-COD-UAPR IN ALM-FLD TO OIA-COD-UAPR IN OIA.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE OIA-NUM-DAPR IN ALM-FLD TO OIA-NUM-DAPR IN OIA.
           MOVE OIA-NUM-MAPR IN ALM-FLD TO OIA-NUM-MAPR IN OIA.
           MOVE OIA-NUM-SAPR IN ALM-FLD TO OIA-NUM-SAPR IN OIA.
           MOVE OIA-NUM-AAPR IN ALM-FLD TO OIA-NUM-AAPR IN OIA.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE OIA-HRA-HAPR IN ALM-FLD TO OIA-HRA-HAPR IN OIA.
       FIN-RET-OIA-ALM.
           EXIT.
       
       KEY-ALL-ALM SECTION.
       INI-KEY-ALL-ALM.
           PERFORM KEY-OIA-ALM.
       FIN-KEY-ALL-ALM.
           EXIT.
       
       KEY-OIA-ALM SECTION.
       INI-KEY-OIA-ALM.
      *>>>> INI_KEY_OIA_ALM
           MOVE WSS-CT-ALM              TO OIA-COD-CPTO IN OIA.
      *<<<<  
           MOVE OIA-CAI-IOPC IN ALM-FLD TO OIA-CAI-IOPC IN OIA.
           MOVE OIA-IIC-IOPC IN ALM-FLD TO OIA-IIC-IOPC IN OIA.
       FIN-KEY-OIA-ALM.
           EXIT.
       
       SCR-CLRA-ALM SECTION.
       INI-SCR-CLRA-ALM.
           PERFORM CLR-KEY-ALM.
           PERFORM CLR-FLD-ALM.
       FIN-SCR-CLRA-ALM.
           EXIT.
       
       CLR-KEY-ALM SECTION.
       INI-CLR-KEY-ALM.
           MOVE SPACES TO OIA-CAI-IOPC IN ALM-FLD.
           MOVE ZEROES TO OIA-IIC-IOPC IN ALM-FLD.
       FIN-CLR-KEY-ALM.
           EXIT.
       
       CLR-FLD-ALM SECTION.
       INI-CLR-FLD-ALM.
           MOVE SPACES TO FRM-COD-VCOC IN ALM-FLD.
           MOVE SPACES TO FRM-COD-TOOC IN ALM-FLD.
           MOVE SPACES TO FRM-COD-AOOC IN ALM-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN ALM-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN ALM-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN ALM-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-ICLI IN ALM-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN ALM-FLD.
           MOVE SPACES TO FRM-IND-ICLI IN ALM-FLD.
           MOVE SPACES TO FRM-GLS-ICLI IN ALM-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-NOMC IN ALM-FLD.
           MOVE ZEROES TO FRM-VAL-CRED IN ALM-FLD.
           MOVE SPACES TO FRM-GLS-VCO2 IN ALM-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FCOL IN ALM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-NOME IN ALM-FLD.
           PERFORM CLR-OIA-ALM.
       FIN-CLR-FLD-ALM.
           EXIT.
       
       CLR-OIA-ALM SECTION.
       INI-CLR-OIA-ALM.
           MOVE SPACES TO OIA-COD-UAPR IN ALM-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OIA-FEC-FAPR IN ALM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OIA-HRA-HAPR IN ALM-FLD.
       FIN-CLR-OIA-ALM.
           EXIT.
       
       FST-KEY-ALM SECTION.
       INI-FST-KEY-ALM.
           MOVE -1 TO OIA-CAI-IOPC-LEN IN ALM-FLD.
       FIN-FST-KEY-ALM.
           EXIT.
       
       FST-FLD-ALM SECTION.
       INI-FST-FLD-ALM.
       FIN-FST-FLD-ALM.
           EXIT.
       
       PRO-KEY-ALM SECTION.
       INI-PRO-KEY-ALM.
           PERFORM PRO-MKY-ALM.
       FIN-PRO-KEY-ALM.
           EXIT.
       
       PRO-MKY-ALM SECTION.
       INI-PRO-MKY-ALM.
       FIN-PRO-MKY-ALM.
           EXIT.
       
       PRO-FLD-ALM SECTION.
       INI-PRO-FLD-ALM.
           PERFORM PRO-OIA-ALM.
       FIN-PRO-FLD-ALM.
           EXIT.
       
       PRO-OIA-ALM SECTION.
       INI-PRO-OIA-ALM.
       FIN-PRO-OIA-ALM.
           EXIT.
       
       UNP-KEY-ALM SECTION.
       INI-UNP-KEY-ALM.
           PERFORM UNP-IKY-ALM.
           PERFORM UNP-AKY-ALM.
           PERFORM UNP-MKY-ALM.
       FIN-UNP-KEY-ALM.
           EXIT.
       
       UNP-IKY-ALM SECTION.
       INI-UNP-IKY-ALM.
           MOVE FRM-CPIM-UBY TO OIA-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO OIA-IIC-IOPC-ATR.
       FIN-UNP-IKY-ALM.
           EXIT.
       
       UNP-MKY-ALM SECTION.
       INI-UNP-MKY-ALM.
       FIN-UNP-MKY-ALM.
           EXIT.
       
       UNP-AKY-ALM SECTION.
       INI-UNP-AKY-ALM.
       FIN-UNP-AKY-ALM.
           EXIT.
       
       UNP-FLD-ALM SECTION.
       INI-UNP-FLD-ALM.
           PERFORM UNP-OIA-ALM.
       FIN-UNP-FLD-ALM.
           EXIT.
       
       UNP-OIA-ALM SECTION.
       INI-UNP-OIA-ALM.
       FIN-UNP-OIA-ALM.
           EXIT.
       
       VAL-MKY-ALM SECTION.
       INI-VAL-MKY-ALM.
       FIN-VAL-MKY-ALM.
           EXIT.
       
       VAL-FLD-ALM SECTION.
       INI-VAL-FLD-ALM.
           PERFORM VAL-FRM-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-VCOC-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-TOOC-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-AOOC-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-GLS-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCOC-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-GLS-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOOC-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-GLS-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOOC-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-IND-ICLI-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-GLS-ICLI-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-NUM-ICLI-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-VRF-ICLI-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMC-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-VAL-CRED.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-CRED-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-GLS-VCO2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCO2-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-FEC-FCOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-FEC-FCOL-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OIA-COD-UAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OIA-COD-UAPR-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
           PERFORM VAL-FRM-GLS-NOME.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOME-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OIA-FEC-FAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                OIA-FEC-FAPR-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OIA-HRA-HAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OIA-HRA-HAPR-LEN IN ALM-FLD
                GO TO FIN-VAL-FLD-ALM.
       FIN-VAL-FLD-ALM.
           EXIT.
       
       VAL-FRM-COD-VCOC SECTION.
       INI-VAL-FRM-COD-VCOC.
       FIN-VAL-FRM-COD-VCOC.
           EXIT.
       
       VAL-FRM-COD-TOOC SECTION.
       INI-VAL-FRM-COD-TOOC.
       FIN-VAL-FRM-COD-TOOC.
           EXIT.
       
       VAL-FRM-COD-AOOC SECTION.
       INI-VAL-FRM-COD-AOOC.
       FIN-VAL-FRM-COD-AOOC.
           EXIT.
       
       VAL-FRM-GLS-VCOC SECTION.
       INI-VAL-FRM-GLS-VCOC.
      *<<<< INI_FRM_GLS_VCOC
           MOVE WSS-CT-TAB              TO TAB-COD-SIST.           
           MOVE WSS-CT-VLR              TO TAB-COD-TTAB IN TAB.    
           MOVE FRM-COD-VCOC IN ALM-FLD TO TAB-COD-CTAB IN TAB.    
           PERFORM VAL-COD.                                        
           IF MSG-COD-MENS = WSS-CT-CODNEX OR WSS-CT-CODNVG
               MOVE MSG-GLS-DESC TO FRM-MENS                       
               MOVE FRM-SUAR-MAL TO FRM-SUAR                       
           ELSE                                                    
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VCOC IN ALM-FLD.
      *>>>>
       FIN-VAL-FRM-GLS-VCOC.
           EXIT.
       
       VAL-FRM-GLS-TOOC SECTION.
       INI-VAL-FRM-GLS-TOOC.
       FIN-VAL-FRM-GLS-TOOC.
           EXIT.
       
       VAL-FRM-GLS-AOOC SECTION.
       INI-VAL-FRM-GLS-AOOC.
       FIN-VAL-FRM-GLS-AOOC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-FRM-NUM-ICLI SECTION.
       INI-VAL-FRM-NUM-ICLI.
       FIN-VAL-FRM-NUM-ICLI.
           EXIT.

       VAL-FRM-VRF-ICLI SECTION.
       INI-VAL-FRM-VRF-ICLI.
           IF FRM-VRF-ICLI IN ALM-FLD NOT > SPACES
              MOVE SPACES TO FRM-VRF-ICLI IN ALM-FLD.
       FIN-VAL-FRM-VRF-ICLI.
           EXIT.
       VAL-FRM-IND-ICLI SECTION.
       INI-VAL-FRM-IND-ICLI.
           IF FRM-IND-ICLI IN ALM-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-ICLI IN ALM-FLD.
       FIN-VAL-FRM-IND-ICLI.
           EXIT.

       VAL-FRM-GLS-ICLI SECTION.
       INI-VAL-FRM-GLS-ICLI.
      *>>>> INI_FRM_GLS_ICLI
           GO TO FIN-VAL-FRM-GLS-ICLI.
      *<<<<
           IF FRM-GLS-ICLI IN ALM-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO FRM-GLS-ICLI IN ALM-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE FRM-GLS-ICLI IN ALM-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO FRM-GLS-ICLI IN ALM-FLD.
       FIN-VAL-FRM-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-FRM-VAL-CRED SECTION.
       INI-VAL-FRM-VAL-CRED.
       FIN-VAL-FRM-VAL-CRED.
           EXIT.
       
       VAL-FRM-GLS-VCO2 SECTION.
       INI-VAL-FRM-GLS-VCO2.
       FIN-VAL-FRM-GLS-VCO2.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-FRM-FEC-FCOL SECTION.
       INI-VAL-FRM-FEC-FCOL.
           IF FRM-FEC-FCOL IN ALM-FLD  NOT > ZEROES
              MOVE ZEROES TO FRM-FEC-FCOL IN ALM-FLD.
      *>>>> INI_FRM_FEC_FCOL
           GO TO FIN-VAL-FRM-FEC-FCOL.
      *<<<< 
       FIN-VAL-FRM-FEC-FCOL.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-OIA-COD-UAPR SECTION.
       INI-VAL-OIA-COD-UAPR.
      *>>>> INI_OIA_COD_UAPR
           IF OIA-COD-UAPR IN ALM-FLD NOT > SPACES
              MOVE SCR-USER TO OIA-COD-UAPR IN ALM-FLD.
      *<<<< 
       FIN-VAL-OIA-COD-UAPR.
           EXIT.
       
       VAL-FRM-GLS-NOME SECTION.
       INI-VAL-FRM-GLS-NOME.
       FIN-VAL-FRM-GLS-NOME.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-OIA-FEC-FAPR SECTION.
       INI-VAL-OIA-FEC-FAPR.
           IF OIA-FEC-FAPR IN ALM-FLD  NOT > ZEROES
              MOVE ZEROES TO OIA-FEC-FAPR IN ALM-FLD.
      *>>>> INI_OIA_FEC_FAPR
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO OIA-NUM-DAPR IN ALM-FLD.
           MOVE HOY-MHOY TO OIA-NUM-MAPR IN ALM-FLD.
           MOVE HOY-SHOY TO OIA-NUM-SAPR IN ALM-FLD.
           MOVE HOY-AHOY TO OIA-NUM-AAPR IN ALM-FLD.
      *<<<<
       FIN-VAL-OIA-FEC-FAPR.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-OIA-HRA-HAPR SECTION.
       INI-VAL-OIA-HRA-HAPR.
      *>>>> INI_OIA_HRA_HAPR
           PERFORM GET-FHOY.
           MOVE HOY-HHOY TO OIA-HRA-HAPR IN ALM-FLD.
      *<<<<
       FIN-VAL-OIA-HRA-HAPR.
           EXIT.
       
       VAL-CON-FLD-ALM SECTION.
       INI-VAL-CON-FLD-ALM.
       FIN-VAL-CON-FLD-ALM.
           EXIT.
       
       VAL-CON-ALM SECTION.
       INI-VAL-CON-ALM.
       FIN-VAL-CON-ALM.
           EXIT.
       
       VAL-NUM-KEY-ALM SECTION.
       INI-VAL-NUM-KEY-ALM.
           PERFORM VAL-NUM-IKY-ALM.
           PERFORM VAL-NUM-MKY-ALM.
           PERFORM VAL-NUM-AKY-ALM.
       FIN-VAL-NUM-KEY-ALM.
           EXIT.
       
       VAL-NUM-IKY-ALM SECTION.
       INI-VAL-NUM-IKY-ALM.
       VAL-NUM-OIA-IIC-IOPC.
           MOVE OIA-IIC-IOPC-ALF IN ALM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO OIA-IIC-IOPC IN ALM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OIA-IIC-IOPC-LEN IN ALM-FLD
                GO TO FIN-VAL-NUM-IKY-ALM.
       FIN-VAL-NUM-IKY-ALM.
           EXIT.
       
       VAL-NUM-MKY-ALM SECTION.
       INI-VAL-NUM-MKY-ALM.
       FIN-VAL-NUM-MKY-ALM.
           EXIT.
       
       VAL-NUM-AKY-ALM SECTION.
       INI-VAL-NUM-AKY-ALM.
       FIN-VAL-NUM-AKY-ALM.
           EXIT.
       
       VAL-NUM-FLD-ALM SECTION.
       INI-VAL-NUM-FLD-ALM.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN ALM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN ALM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN ALM-FLD
                GO TO FIN-VAL-NUM-FLD-ALM.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-VAL-CRED.
           MOVE FRM-VAL-CRED-ALF IN ALM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-CRED IN ALM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-CRED-LEN IN ALM-FLD
                GO TO FIN-VAL-NUM-FLD-ALM.
       VAL-NUM-OIA-HRA-HAPR.
           MOVE OIA-HRA-HAPR-ALF IN ALM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO OIA-HRA-HAPR IN ALM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OIA-HRA-HAPR-LEN IN ALM-FLD
                GO TO FIN-VAL-NUM-FLD-ALM.
       FIN-VAL-NUM-FLD-ALM.
           EXIT.
       
       EDT-KEY-ALM SECTION.
       INI-EDT-KEY-ALM.
           PERFORM EDT-IKY-ALM.
           PERFORM EDT-MKY-ALM.
           PERFORM EDT-AKY-ALM.
       FIN-EDT-KEY-ALM.
           EXIT.
       
       EDT-IKY-ALM SECTION.
       INI-EDT-IKY-ALM.
           IF OIA-IIC-IOPC-LEN IN ALM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OIA-IIC-IOPC-LEN IN ALM-FLD
                GO TO FIN-EDT-IKY-ALM.
           MOVE OIA-IIC-IOPC IN ALM-FLD TO OIA-IIC-IOPC-EDT IN ALM-EDT.
           MOVE OIA-IIC-IOPC-EDT IN ALM-EDT TO 
                OIA-IIC-IOPC-ALF IN ALM-FLD.
       FIN-EDT-IKY-ALM.
           EXIT.
       
       EDT-MKY-ALM SECTION.
       INI-EDT-MKY-ALM.
       FIN-EDT-MKY-ALM.
           EXIT.
       
       EDT-AKY-ALM SECTION.
       INI-EDT-AKY-ALM.
       FIN-EDT-AKY-ALM.
           EXIT.
       
       EDT-FLD-ALM SECTION.
       INI-EDT-FLD-ALM.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-ICLI-LEN IN ALM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN ALM-FLD
                GO TO FIN-EDT-FLD-ALM.
           MOVE FRM-NUM-ICLI IN ALM-FLD TO
                FRM-NUM-ICLI-EDT IN ALM-EDT.
           MOVE FRM-NUM-ICLI-EDT IN ALM-EDT TO
                FRM-NUM-ICLI-ALF IN ALM-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-VAL-CRED-LEN IN ALM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-CRED-LEN IN ALM-FLD
                GO TO FIN-EDT-FLD-ALM.
           MOVE FRM-VAL-CRED IN ALM-FLD TO FRM-VAL-CRED-EDT IN ALM-EDT.
           MOVE FRM-VAL-CRED-EDT IN ALM-EDT TO 
                FRM-VAL-CRED-ALF IN ALM-FLD.
           IF OIA-HRA-HAPR-LEN IN ALM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OIA-HRA-HAPR-LEN IN ALM-FLD
                GO TO FIN-EDT-FLD-ALM.
           MOVE OIA-HRA-HAPR IN ALM-FLD TO OIA-HRA-HAPR-EDT IN ALM-EDT.
           MOVE OIA-HRA-HAPR-EDT IN ALM-EDT TO 
                OIA-HRA-HAPR-ALF IN ALM-FLD.
       FIN-EDT-FLD-ALM.
           EXIT.
