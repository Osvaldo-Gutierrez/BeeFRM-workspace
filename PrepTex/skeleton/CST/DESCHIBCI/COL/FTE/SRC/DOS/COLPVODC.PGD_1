       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   COLPVODC.
       AUTHOR.       CONSIST.
      *<<<< FEC
       DATE-WRITTEN.   19-JUL-1999 (ULT. MOD. BEE-TEAM)
      *>>>>
      
      *JACTUALIZA ARCHIVO COLOPC EN FORMA INTERACTIVA.
      
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
      
       DATA DIVISION.
      *==============
      
       WORKING-STORAGE SECTION.
      *------------------------
       COPY COLBROPC.
      
       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      *COPY GNSWGFRM.
       COPY GNSWG3CF.
      *PTC-FIN
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MITR                         PIC X(01).
           02 SCR-IND-MCOM                         PIC X(01).
           02 SCR-IND-MCYA                         PIC X(01).
           02 SCR-MSC-TCAN                         PIC X(01).
      *ALD-BCI-INI/12.08.1996
           02 SCR-COD-PLZO                         PIC X(06).
              88 SCR-COD-PLZO-B90 VALUE 'C1' 'C2' 'USAB90'.
           02  SCR-COD-TINT.
               05  SCR-COD-TIPT.
                   07  SCR-MSC-BCTI                     PIC X(01).
                   07  SCR-MSC-PBTI                     PIC X(01).
                   07  SCR-MSC-MCTI.
                       09  SCR-MSC-BPBT                 PIC X(01).
                       09  SCR-MSC-SPBT                 PIC X(01).
               05  SCR-COD-CVTI                         PIC X(03).
               05  SCR-MSC-TFPR                         PIC X(01).
               05  SCR-NUM-PREP                         PIC 9(03).
               05  SCR-MSC-UTPR                         PIC X(01).
      *ALD-BCI-FIN/12.08.1996
      *>>>>
       COPY COLWIOPC.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGSYS.
      
      *<<<< WSS
       01  WSS-VARI.
      *RVM-CST-INI 16-JAN-1997
      *VARIABLES PARA MIN Y MAX AGNO SEGDES
           03  WSS-IND-MM50                       PIC X(01).
           03  WSS-IND-COBRO                      PIC X(01).
           03  WSS-IND-MPES      VALUE 'M$   '    PIC X(06).
           03  WSS-COD-TBAN                       PIC X(03).
           03  WSS-IND-TBAN                       PIC X(01).
           03  WSS-IND-SEGU                       PIC X(01).
           03  WSS-IND-CLID                       PIC X(01).
           03  WSS-IND-SIST                       PIC X(03).
           03  WSS-IND-TTAB                       PIC X(03).
           03  WSS-IND-CTAB                       PIC X(06).
           03  WSS-IND-MENS                       PIC X(10).
           03  WSS-NUM-NANO                       PIC 9(02).
           03  WSS-GLS-DAT2-MINMAX.
               05 WSS-AGNO-NUM-MINMAX.
                  07 WSS-MIN-AGNO                 PIC X(02).
                  07 WSS-MAX-AGNO                 PIC X(02).
               05 FILLER                          PIC X(16).
      *INI-JGM
           03  WSS-GLS-DAT3-MINMAX-I.
               05 FILLER                          PIC X(10).
               05 WSS-AGNO-NUM-MINMAX-I.
                  07 WSS-MIN-AGNO-I               PIC X(02).
                  07 WSS-MAX-AGNO-I               PIC X(02).
               05 FILLER                          PIC X(16).
           03  WSS-GLS-DAT2-MINMAX-ID.
               05 FILLER                          PIC X(10).
               05 WSS-AGNO-NUM-MINMAX-ID.
                  07 WSS-MIN-AGNO-ID              PIC X(02).
                  07 WSS-MAX-AGNO-ID              PIC X(02).
               05 FILLER                          PIC X(06).
      *FIN-JGM
      *RVM-CST-INI 16-JAN-1997
      *Dado el uso del modulo de manejo BQ
           03  WSS-CAI-ICIC.
               05 WSS-COD-TCIC                    PIC X(01).
               05 WSS-COD-CCIC                    PIC X(03).
           03  WSS-MSC-TCAN                       PIC X(01).
           03  WSS-CPT-NOMB.
               05  WSS-CPT-DESC                   PIC X(40).
               05  WSS-CPT-IOPV                   PIC X(12).
               05  WSS-CPT-DATA                   PIC X(40).
           03  WSS-CPT-NOMB-R REDEFINES WSS-CPT-NOMB PIC X(92).
           03  WSS-CIC-IOPV                       PIC X(12).
      *
           03  WSS-NTRN              VALUE SPACES PIC X(04).
      * ISP/23-JAN-1990
      * VARIABLES PARA DETECTAR N CANCELACIONES ASOCIADAS A UNA UNICA OP
      * ALD-BCI-INI/14.06.1996
           03  WSS-ROV-RENO     COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-VAL-DIFE     COMP-3 VALUE ZEROES PIC  9(11)V9(04).
           03  WSS-VAL-PASO            VALUE ZEROES PIC  9(01)V9(04).
      * ALD-BCI-FIN/14.06.1996
           03  WSS-SGV-RENO     COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  RCAN-CAN-KEY-ICAN                  PIC X(15).
           03  WSS-TOT-RCAN   VALUE ZEROES        PIC 9(04).
      *ALD/22-AUG-1988
           03  WSS-I                              PIC 9(02).
           03  WSS-NUM-DIGT                       PIC 9(02).
           03  WSS-COD-DIGT                       PIC X(02).
           03  WSS-MEN2.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-NUM-VAL1-EDT                   PIC ----.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-IND-DMA1                      PIC X(01).
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-GLS-GUI2                      PIC X(01).
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-NUM-VAL2-EDT                   PIC ----.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-IND-DMA2                      PIC X(01).
           03  PGM-STAT-POC          VALUE '23'   PIC X(02).
               88  PGM-STAT-POC-OKS  VALUE '00'.
               88  PGM-STAT-POC-NUL  VALUE '  '.
           03  WSS-NUM-ACTI                       PIC 9(01).
           03  WSS-NUM-COTO                       PIC 9(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03  WSS-IND-IVFI                       PIC X(01).
           03  WSS-VAL-TEVC             COMP-3    PIC 9(11)V9(05).
           03  WSS-CVI-TCAP             COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-TCAP             COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-TVEN             COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-NDLC             COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-PDIR             COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-PIND             COMP-3    PIC 9(11)V9(05).
           03  WSS-MSG-STR.
               05  WSS-NUM-FALF                   PIC  --.---.--9,99999.
               05  WSS-MSG-GLS-DESC               PIC X(40).
               05  WSS-NUM-FEDT                   PIC  --.---.--9,99999.
               05  WSS-MSG-GLS-DATA               PIC X(60).
           03  WSS-VAL-CRED   COMP-3 VALUE ZEROES PIC 9(11)V9(04).
           03  WSS-IND-TMON          VALUE SPACES PIC X(01).
           03  WSS-IND-TMMN          VALUE 'N'    PIC X(01).
           03  WSS-IND-TMMX          VALUE 'E'    PIC X(01).
      *
           03  WSS-GLS-DAT1          VALUE SPACES PIC X(01).
           03  BUS-POR-KEYS          VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'    PIC X(01).
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-MRDC              VALUE 0      PIC 9(01).
               88  WSS-MISMO-RDC     VALUE 0.
               88  WSS-OTRO-RDC      VALUE 1.
           03  WSS-MISMO             VALUE 0      PIC 9(01).
           03  WSS-OTRO              VALUE 1      PIC 9(01).
           03  WSS-CIC-IMPU                       PIC X(04).
           03  WSS-VAL-IMPU   COMP-3 VALUE 0      PIC 9(11)V9(04).
           03  WSS-AUX-IMPU   COMP-3 VALUE 0      PIC 9(11)V9(04).
           03  WSS-VAL-GNOT   COMP-3 VALUE 0      PIC 9(11)V9(04).
      
           03  WSS-SGV-LIQU          VALUE +0     PIC S9(13)V9(05).
      *                              SIGN LEADING SEPARATE.
           03  WSS-SGV-LIQU-ALF                   PIC X(24).
           03  WSS-SGV-LIQU-EDT REDEFINES WSS-SGV-LIQU-ALF
                                     PIC --.---.---.---.---,-----.
      
           03  WSS-NUM-TABN          VALUE 0      PIC 9(03).
           03  WSS-NUM-TABZ          VALUE 0      PIC 9(03).
           03  WSS-INTR                           PIC X(01).
           03  WSS-KEY-ICYA.
               05  WSS-CIC-IOPC                   PIC X(12).
               05  WSS-NUM-ICAN                   PIC X(03).
               05  WSS-NUM-ICYA                   PIC 9(01).
      *PARA VALIDAR QUE LOS CARGOS/ABONOS SEAN TODOS O NINGUNO EN CC
           03  WSS-OPC-CACC                       PIC X(08).
           03  WSS-OPC-LNBT                       PIC X(01).
      *    03  WSS-KEY-IEVC                       PIC X(15).
           03  WSS-FEC-FPVC VALUE ZEROES.
               05  WSS-NUM-SPVC                   PIC 9(02).
               05  WSS-NUM-APVC                   PIC 9(02).
               05  WSS-NUM-MPVC                   PIC 9(02).
               05  WSS-NUM-DPVC                   PIC 9(02).
           03  WSS-FEC-FIMV VALUE ZEROES.
               05  WSS-NUM-SIMV                   PIC 9(02).
               05  WSS-NUM-AIMV                   PIC 9(02).
               05  WSS-NUM-MIMV                   PIC 9(02).
               05  WSS-NUM-DIMV                   PIC 9(02).
           03  WSS-MSC-TCVE                       PIC X(02).
           03  WSS-PESO                 VALUE ' ' PIC X(01).
               88 WSS-PESO-SI           VALUE 'S'.
               88 WSS-PESO-NO           VALUE 'N'.
      *
           03  WSS-NUM-VCVG                       PIC 9(03).
      *    03  WSS-AEVC                           PIC X(105).
           03  WSS-AXSV                           PIC 9(04).
           03  WSS-AXUS                           PIC X(01).
           03  WSS-EEVC       OCCURS 50.
               05  WSS-REVC                       PIC X(105).
               05  WSS-SPVE                       PIC 9(04).
               05  WSS-UTPV                       PIC X(01).
               05  WSS-SEVE                       PIC 9(04).
               05  WSS-UTSV                       PIC X(01).
               05  WSS-VIGU                       PIC 9(03).
               05  WSS-FPVC.
                   07  WSS-SPVC                   PIC 9(02).
                   07  WSS-APVC                   PIC 9(02).
                   07  WSS-MPVC                   PIC 9(02).
                   07  WSS-DPVC                   PIC 9(02).
               05  WSS-FFPV.
                   07  WSS-SFPV                   PIC 9(02).
                   07  WSS-AFPV                   PIC 9(02).
                   07  WSS-MFPV                   PIC 9(02).
                   07  WSS-DFPV                   PIC 9(02).
               05  WSS-DVEN                       PIC 9(02).
           03  WSS-LEFO                 VALUE  50 PIC 9(02).
           03  WSS-MEFO                           PIC 9(02).
           03  WSS-FAVC.
               05  WSS-SAVC                       PIC 9(02).
               05  WSS-AAVC                       PIC 9(02).
               05  WSS-MAVC                       PIC 9(02).
               05  WSS-DAVC                       PIC 9(02).
           03  WSS-FMVC.
               05  WSS-SMVC                       PIC 9(02).
               05  WSS-AMVC                       PIC 9(02).
               05  WSS-MMVC                       PIC 9(02).
               05  WSS-DMVC                       PIC 9(02).
           03  WSS-IMVC                           PIC 9(02).
      *
           03  WSS-USEP                           PIC X(01).
           03  WSS-VSEP                      COMP PIC 9(04).
           03  WSS-FVNC.
               05  WSS-SVNC                       PIC 9(02).
               05  WSS-AVNC                       PIC 9(02).
               05  WSS-MVNC                       PIC 9(02).
               05  WSS-DVNC                       PIC 9(02).
           03  WSS-FMIV.
               05  WSS-SMIV                       PIC 9(02).
               05  WSS-AMIV                       PIC 9(02).
               05  WSS-MMIV                       PIC 9(02).
               05  WSS-DMIV                       PIC 9(02).
           03  WSS-FMAV.
               05  WSS-SMAV                       PIC 9(02).
               05  WSS-AMAV                       PIC 9(02).
               05  WSS-MMAV                       PIC 9(02).
               05  WSS-DMAV                       PIC 9(02).
           03  WSS-NEEV                      COMP PIC 9(04).
           03  WSS-FPPC.
               05  WSS-SPPC                       PIC 9(02).
               05  WSS-APPC                       PIC 9(02).
               05  WSS-MPPC                       PIC 9(02).
               05  WSS-DPPC                       PIC 9(02).
           03  WSS-FPPI.
               05  WSS-SPPI                       PIC 9(02).
               05  WSS-APPI                       PIC 9(02).
               05  WSS-MPPI                       PIC 9(02).
               05  WSS-DPPI                       PIC 9(02).
           03  WSS-FIPC.
               05  WSS-SIPC                       PIC 9(02).
               05  WSS-AIPC                       PIC 9(02).
               05  WSS-MIPC                       PIC 9(02).
               05  WSS-DIPC                       PIC 9(02).
           03  WSS-FSPC.
               05  WSS-SSPC                       PIC 9(02).
               05  WSS-ASPC                       PIC 9(02).
               05  WSS-MSPC                       PIC 9(02).
               05  WSS-DSPC                       PIC 9(02).
           03  WSS-FIPI.
               05  WSS-SIPI                       PIC 9(02).
               05  WSS-AIPI                       PIC 9(02).
               05  WSS-MIPI                       PIC 9(02).
               05  WSS-DIPI                       PIC 9(02).
           03  WSS-FSPI.
               05  WSS-SSPI                       PIC 9(02).
               05  WSS-ASPI                       PIC 9(02).
               05  WSS-MSPI                       PIC 9(02).
               05  WSS-DSPI                       PIC 9(02).
           03  WSS-FUVC.
               05  WSS-SUVC                       PIC 9(02).
               05  WSS-AUVC                       PIC 9(02).
               05  WSS-MUVC                       PIC 9(02).
               05  WSS-DUVC                       PIC 9(02).
           03  WSS-NEUV                           PIC 9(03).
           03  WSS-IVUV              VALUE SPACES PIC X(01).
               88 WSS-ULTIMO-VENC-EN-ZERO VALUE 'Z'.
           03  WSS-EPOC              VALUE 'N'    PIC X(01).
           03  WSS-OPEC                           PIC X(08).
      *JSS
           03  WSS-VEDT-ALF                       PIC X(24).
           03  WSS-VEDT-EDT REDEFINES WSS-VEDT-ALF
                                     PIC --.---.---.---.---,-----.
      *JSS-NEW
           03  WSS-LEVC COMP             VALUE 10 PIC 9(02).
           03  WSS-MEVC COMP             VALUE 0  PIC 9(02).
           03  WSS-IEVC COMP             VALUE 0  PIC 9(02).
           03  WSS-EVC1 COMP             VALUE 0  PIC 9(02).
           03  WSS-TCFO COMP             VALUE 0  PIC 9(02).
           03  WSS-TCCO COMP             VALUE 0  PIC 9(02).
           03  WSS-VCVC OCCURS 10.
               05  WSS-BCCR                       PIC X(01).
               05  WSS-VICR                       PIC X(01).
           03  WSS-FMIN.
               05  WSS-SMIN                       PIC 9(02).
               05  WSS-AMIN                       PIC 9(02).
               05  WSS-MMIN                       PIC 9(02).
               05  WSS-DMIN                       PIC 9(02).
           03  WSS-J                              PIC 9(02).
           03  WSS-K                              PIC 9(02).
      
      * DPM ini  21-JUN-1995
           03  WSS-CTAB.
               05  WSS-TOPR                     PIC X(03).
               05  WSS-FILLER                   PIC X(09).
           03  WSS-CIC-CTAB                     PIC X(06).
           03  WSS-VAL-SCRE                     PIC 9(11)V9(04).
           03  WSS-RUT-ICLI    VALUE '50000000' PIC X(08).
           03  WSS-NUM-ICLI    REDEFINES WSS-RUT-ICLI
                                                PIC 9(08).
           03  WSS-COD-TCLI    VALUE SPACES     PIC X(03).
           03  WSS-FEC-FMAV.
               05  WSS-NUM-SMAV                 PIC 9(02).
               05  WSS-NUM-AMAV                 PIC 9(02).
               05  WSS-NUM-MMAV                 PIC 9(02).
               05  WSS-NUM-DMAV                 PIC 9(02).
           03  WSS-FEC-FEC2.
               05  WSS-NUM-SEC2                 PIC 9(02).
               05  WSS-NUM-AEC2                 PIC 9(02).
               05  WSS-NUM-MEC2                 PIC 9(02).
               05  WSS-NUM-DEC2                 PIC 9(02).
           03  WSS-FEC-FCOL.
               05  WSS-NUM-SCOL                 PIC 9(02).
               05  WSS-NUM-ACOL                 PIC 9(02).
               05  WSS-NUM-MCOL                 PIC 9(02).
               05  WSS-NUM-DCOL                 PIC 9(02).
           03  WSS-GLS-DMES                     PIC X(03).
           03  WSS-NUM-DMES REDEFINES WSS-GLS-DMES
                                                PIC 9(03).
           03  WSS-GLS-DANO                     PIC X(03).
           03  WSS-NUM-DANO REDEFINES WSS-GLS-DANO
                                                PIC 9(03).
           03  WSS-VAL-SEGD                     PIC 9(11)V9(04).
           03  WSS-VAL-SEGP                     PIC 9(11)V9(04).
           03  WSS-VAL-SEGC                     PIC 9(11)V9(04).
           03  WSS-VAL-TREN                     PIC 9(11)V9(04).
      
           03  WSS-GLS-DATA.
               05  WSS-GLS-CLIE                 PIC X(09).
               05  WSS-VAL-CLIE REDEFINES WSS-GLS-CLIE
                                                PIC 9(03)V9(06).
               05  FILL1                        PIC X(01).
               05  WSS-GLS-NCLI                 PIC X(09).
               05  WSS-VAL-NCLI REDEFINES WSS-GLS-NCLI
                                                PIC 9(03)V9(06).
               05  FILL2                        PIC X(41).
      *INI-JGM
           03  WSS-GLS-DATA-I.
               05  WSS-GLS-CLIE-I               PIC X(09).
               05  WSS-VAL-CLIE-I REDEFINES WSS-GLS-CLIE-I
                                                PIC 9(03)V9(06).
               05  FILL1                        PIC X(01).
               05  WSS-GLS-NCLI-I               PIC X(09).
               05  WSS-VAL-NCLI-I REDEFINES WSS-GLS-NCLI-I
                                                PIC 9(03)V9(06).
      *FIN-JGM
      * DPM fin  21-JUN-1995
      * RBG INI 14-MAR-1996
      *     03  WSS-VAL-DIFE        COMP-3       PIC 9(11)V9(04).
      * RBG FIN 14-MAR-1996
      * RBG INI  16-NOV-1995
           03  WSS-IBLK-VSEG                    PIC X(01).
           03  WSS-IND-MUF                      PIC X(01).
           03  WSS-IND-RBJB                     PIC X(01).
           03  WSS-GLS-DATA-SEGH.
               05  WSS-IND-CONT                 PIC X(01).
               05  WSS-IND-RBJA                 PIC X(01).
               05  FILLER                       PIC X(28).
               05  WSS-GLS-TSEG                 PIC X(09).
               05  WSS-VAL-TSEG REDEFINES WSS-GLS-TSEG
                                                PIC 9(03)V9(06).
               05  FILLER                       PIC X(21).
      * RBG FIN  16-NOV-1995
      * RBG/INI/30-APR-1997
           03  WSS-IND-NOCA   VALUE 'S'          PIC X(01).
           03  WSS-NUM-IDLC                      PIC 9(03).
           03  WSS-SGV-VCAM                      PIC S9(11)V9(04).
           03  WSS-GLS-DAT4.
               05 WSS-GLS-MANO                   PIC X(02).
               05 WSS-NUM-MANO       REDEFINES
                  WSS-GLS-MANO                   PIC 9(02).
               05 FILLER                         PIC X(18).
           03  WSS-GLS-DAT5.
               05 WSS-COD-MONE                   PIC X(06).
               05 WSS-GLS-MOUF                   PIC X(11).
               05 WSS-VAL-MOUF       REDEFINES
                  WSS-GLS-MOUF                   PIC 9(07)V9(04).
               05 FILLER                         PIC X(03).
      * RBG/FIN/30-APR-1997
      * RBG/INI/12-NOV-1997. Esto es para el seguro de desgarvamen de
      *                      los creditos comerciales. Tipos de TIO's.
           03  WSS-GLS-DAT3           VALUE SPACES     PIC X(60).
           03  WSS-TTIO               REDEFINES
                   WSS-GLS-DAT3       OCCURS 20        PIC X(03).
      
           03  MOV-I                  VALUE ZEROES     PIC 9(02).
           03  WSS-IND-ETIO           VALUE 'N'        PIC X(01).
           03  WSS-GLS-DDIA                            PIC X(04).
           03  WSS-NUM-DDIA REDEFINES WSS-GLS-DDIA
                                                       PIC 9(04).
      * RBG/FIN/12-NOV-1997.
      * INI-JGM 17-05-1999 .
           03  WSS-GLS-DATBAN     VALUE SPACES     PIC X(45).
           03  WSS-GLS-DATTBAN    REDEFINES   WSS-GLS-DATBAN.
               05 WSS-COD-TBANC   OCCURS 15        PIC X(03).
      
           03  WSS-GLS-DATCOB.
               05 FILLER                       PIC X(45).
               05 WSS-GLS-PORREN.
                  07 WSS-NUM-PORCOB            PIC X(04).
                  07 WSS-NUM-TOPREN            PIC X(06).
               05  WSS-VAL-PORREN REDEFINES WSS-GLS-PORREN.
                  07 WSS-VAL-PORCOB            PIC 9(02)V9(02).
                  07 WSS-VAL-TOPREN            PIC 9(04)V9(02).
      *
           03 WSS-VAL-RLCL                     PIC 9(10)V9(02).
           03 WSS-VAL-TRUF                     PIC 9(04)V9(02).
           03 WSS-GLS-DIVA                        PIC X(10).
           03 WSS-NUM-PIVA REDEFINES WSS-GLS-DIVA PIC 9(06)V9(04).
           03 WSS-VAL-IVA                         PIC 9(3)V9(04).
      * FIN-JGM 17-05-1999 .
      * RRM-INI 21-JUN-1999
           03 WSS-IND-STAT      VALUE SPACES      PIC X(01).
           03 WSS-NUM-DIFF      VALUE ZEROES      PIC 9(04).
           03 WSS-NUM-MMES      VALUE ZEROES      PIC 9(03).
           03 WSS-IND-BLLN      VALUE SPACES      PIC X(01).
           03 WS1-CIC-IOPC.
              05 WS1-CAI-IOPC   VALUE SPACES      PIC X(04).
              05 WS1-IIC-IOPC   VALUE SPACES      PIC X(08).
           03 WS1-CIC-IOPV.
              05 WS1-CAI-IOPV   VALUE SPACES      PIC X(04).
              05 WS1-IIC-IOPV   VALUE SPACES      PIC X(08).
           03 WS1-OLD-IOPC      VALUE SPACES      PIC X(12).
           03 WS1-OPC-FCOL.
              05 WS1-NUM-SCOL                     PIC 9(02).
              05 WS1-NUM-ACOL                     PIC 9(02).
              05 WS1-NUM-MCOL                     PIC 9(02).
              05 WS1-NUM-DCOL                     PIC 9(02).
           03 WSS-COD-RBL.
              05 WSS-COD-RBL1                     PIC X(06).
              05 WSS-COD-RBL2.
                 07 WSS-TOC-RBL21                 PIC X(03).
                 07 WSS-AOC-RBL22                 PIC X(03).
           03 WSS-RBL-DATA.
              05 WSS-NUM-PLZO    VALUE ZEROES     PIC 9(04).
              05 WSS-IND-TDFE    VALUE SPACES     PIC X(01).
              05 WSS-GLS-REST    VALUE SPACES     PIC X(36).
           03 WSS-NUM-FRAC       VALUE ZEROES     PIC 9(03).
           03 WSS-OPC            VALUE SPACES     PIC X(300).
      * RRM-FIN 21-JUN-1999
      
       01  REG.
           02 REG-FILL                          PIC X(01).
       COPY COLBREVC REPLACING ==01  EVC== BY
                               ==02 REG-EVC OCCURS 10==.
      *JSS-NEW
      
      *JSS-TRC
      * COPY GNSWGDSP.
      *JSS
       01  SCR-INST-BRW              VALUE 'BRW'  PIC X(03).
      *
      *Registros de GENESIS
       COPY GNSBRTAB.
      *Registros de TABLAS
       COPY TABBROFI.
       COPY TABBRUSR.
      *ALD/22-AUG-1988
       COPY TABBRCAM.
      *Registros de CLIENTES
       COPY SGCBRDBC.
      
      * DPM ini  21-JUN-1995
       COPY SGCBRDCP.
      * DPM fin  21-JUN-1995
      *ALD-BCI-INI/12.08.1996
       COPY SGCBRDCE.
      *ALD-BCI-FIN/12.08.1996
      
      *Registros de Colocaciones
       COPY COLBRCAN.
       COPY COLBRRDC.
       COPY COLBRITR.
       COPY COLBRCOM.
       COPY COLBRCYA.
       COPY COLBRAUT.
       COPY COLBRROV.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRVEN.
       COPY COLBRIMP.
       COPY COLBRICG.
       COPY COLBRNTR.
       COPY COLBRTOC.
       COPY COLBRPOC.
      *ALD-BCI-INI/12.08.1996
      * COPY COLBRPSM.
      *ALD-BCI-FIN/12.08.1996
      
      *
      *ALD-BCI-INI/12.08.1996
      * COPY COLWGPSM.
      *ALD-BCI-FIN/12.08.1996
       COPY COLWGUVD.
       COPY COLWGRNO.
       COPY COLWGVIN.
      *DAD ini  15-JUL-1994   (Mimu.05-01-93 pto.3)
      * COPY COLWGCIP.
      *DAD fin  15-JUL-1994
      * RBG INI 27-DEC-1995
       COPY COLWGCLM.
      * RBG FIN 27-DEC-1995
      *
      *PTC ini
       COPY GNSWGQUE.
      *PTC fin
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
      *
       COPY GNSWGIDC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
      *
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY GNSWGCVI.
      *
       COPY GNSWGPES.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY SGCBRRCD.
      
       COPY SGCBRAEP.
      *RVM-CST-INI 6-AUG-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SDC-REQA==.
       COPY SGCBRDCC REPLACING == DCC== BY == SDC==.
      *RVM-CST-FIN 6-AUG-1996
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *ALD/22-AUG-1988
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IMP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-NTR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
      *ALD-BCI-INI/12.08.1996
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PSM-REQA==.
      *ALD-BCI-FIN/12.08.1996
      * DPM ini  21-JUN-1995
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
      * DPM fin  21-JUN-1995
      *ALD-BCI-INI/12.08.1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
      *ALD-BCI-FIN/12.08.1996
      *JGM
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AEP-REQA==.
      *JGM
      *>>>>
       01  PGM-VARI.
           03 PGM-ICKY                 VALUE 0 PIC 9(01).
              88 PGM-LIMPIAR-LLAVES    VALUE 0.
              88 PGM-NO-LIMPIAR-LLAVES VALUE 1.
           03 PGM-STAT.
              05 PGM-STAT-OPC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-OPC-OKS    VALUE '00'.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
              05 PGM-STAT-CAN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CAN-OKS    VALUE '00'.
                 88 PGM-STAT-CAN-NUL    VALUE '  '.
              05 PGM-STAT-RDC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RDC-OKS    VALUE '00'.
                 88 PGM-STAT-RDC-NUL    VALUE '  '.
              05 PGM-STAT-DBC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-DBC-OKS    VALUE '00'.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
              05 PGM-STAT-RCD           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RCD-OKS    VALUE '00'.
                 88 PGM-STAT-RCD-NUL    VALUE '  '.
              05 PGM-STAT-ROV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ROV-OKS    VALUE '00'.
                 88 PGM-STAT-ROV-NUL    VALUE '  '.
              05 PGM-STAT-ITR           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ITR-OKS    VALUE '00'.
                 88 PGM-STAT-ITR-NUL    VALUE '  '.
              05 PGM-STAT-COM           VALUE '23'      PIC X(02).
                 88 PGM-STAT-COM-OKS    VALUE '00'.
                 88 PGM-STAT-COM-NUL    VALUE '  '.
              05 PGM-STAT-CYA           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CYA-OKS    VALUE '00'.
                 88 PGM-STAT-CYA-NUL    VALUE '  '.
              05 PGM-STAT-AUT           VALUE '23'      PIC X(02).
                 88 PGM-STAT-AUT-OKS    VALUE '00'.
                 88 PGM-STAT-AUT-NUL    VALUE '  '.
      
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
       COPY GNSLGFIO.
      
       PROCEDURE DIVISION.
      *===================
      
       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'ACC'
               IF SCR-STPP = SCR-STAT-CON OR SCR-STAT-SON
                   PERFORM SCR-ACC
               ELSE
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'SPP    NOSOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE SCR-STPP     TO FRM-MEN2
                   PERFORM SCR-MSSG
                   PERFORM SCR-COM
           ELSE
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'CPP    NOSOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE SCR-CCPP     TO FRM-MEN2
               PERFORM SCR-MSSG
               PERFORM SCR-COM.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.
      
       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO OPC-FLD.
           MOVE LOW-VALUES TO OPC-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           PERFORM GNS-HDL-VSM.
           MOVE 'COLPVODC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *<<<< INI_FIO
      *PTC ini
           PERFORM GNS-ERR-QUE.
      *PTC fin
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
                              SCR-RQA2.
      *>>>>
       FIN-INI.
           EXIT.
      
       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBHVSM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.
      
       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-OPC.
           PERFORM EDT-KEY-OPC.
           PERFORM EDT-FLD-OPC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE FRM-CLR-FRM  TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-MSG      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.
      
       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               IF PGM-LIMPIAR-LLAVES
                   PERFORM SCR-CLRA-OPC
                   PERFORM EDT-KEY-OPC
                   PERFORM EDT-FLD-OPC
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM CLR-FLD-OPC
                   PERFORM EDT-FLD-OPC
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.
      
       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE 0 TO PGM-ICKY
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-OPC.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE 1 TO PGM-ICKY.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'S'          TO SCR-IERR
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
           MOVE 'S'          TO SCR-IERR.
        FIN-SCR-KEY.
           EXIT.
      
       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO OPC-FLD.
       FIN-SCR-RST.
           EXIT.
      
       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.
      
       FND-KEY SECTION.
       INI-FND-KEY.
           PERFORM KEY-ALL-OPC.
      *<<<< FND_KEY
           IF OPC-IIC-IOPC IN OPC-FLD > ZEROES
               GO TO CON-FND-KEY
           ELSE
           IF DBC-NUM-ICLI IN OPC-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN OPC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN OPC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN OPC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM ANL-KEY-OPC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
                   MOVE 'S'          TO SCR-IERR
      *PTC fin
                   GO TO FIN-FND-KEY
               ELSE
                   NEXT SENTENCE
           ELSE
           IF DBC-GLS-NOMC IN OPC-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre
               MOVE DBC-GLS-NOMC IN OPC-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC
      
      *         UNSTRING DBC-GLS-NOMC IN OPC-FLD DELIMITED BY '/' INTO
      *                                  DBC-GLS-APAT IN DBC
      *                                  DBC-GLS-AMAT IN DBC
      *                                  DBC-GLS-NOMB IN DBC
      
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM ANL-KEY-OPC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
                   MOVE 'S'          TO SCR-IERR
      *PTC fin
                   GO TO FIN-FND-KEY.
       CON-FND-KEY.
      *>>>>
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-STAT TO PGM-STAT-OPC.
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
      
           MOVE '00' TO PGM-STAT-OPC.
      *INI-JGM
           MOVE OPC-STP-ITRN IN OPC TO SCR-UMOD.
      *FIN-JGM
           IF NOT BUS-POR-KEYS = BUS-POR-CLTE
               GO TO OPC-FND-KEY.
           PERFORM GET-CUR-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RDC    INCKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
               MOVE 'S'          TO SCR-IERR
      *PTC fin
               GO TO FIN-FND-KEY.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE MSG-GLS-DESC TO FRM-MENS.
           GO TO ANL-CLI.
       OPC-FND-KEY.
           PERFORM GET-CUR-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
               MOVE 'S'          TO SCR-IERR
      *PTC fin
               GO TO FIN-FND-KEY.
           MOVE '00' TO PGM-STAT-RDC.
           MOVE 'IDLC' TO SCR-KEY-IRDC.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE 'M'          TO DBC-IND-ICLI IN OPC-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               GO TO ANL-CLI.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RDC    NOCLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
               MOVE 'S'          TO SCR-IERR
      *PTC fin
               GO TO FIN-FND-KEY.
      
           MOVE '00' TO PGM-STAT-DBC.
           MOVE ADR-DBC-REQA TO SCR-RQA1.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD.
      *JGM-AEP.
       INI-BUS-AEP.
           IF DBC-IND-TICL IN DBC = 'E'
              GO TO FIN-BUS-AEP.
      *    IF DBC-NUM-ICLI IN DBC NOT < WSS-NUM-ICLI IN WSS-VARI
      *       GO TO FIN-BUS-AEP.
      *
           IF OPC-COD-TOOC IN OPC   = 'PAP' OR
              OPC-COD-TOOC IN OPC   = 'PAF'
              GO TO FIN-BUS-AEP.
      *
           MOVE OPC-CAI-IOPC IN OPC TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN OPC TO DLC-IIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT (FIO-STAT-OKS AND
                   OPC-CAI-IOPC IN OPC = DLC-CAI-IOPC IN DLC AND
                   OPC-IIC-IOPC IN OPC = DLC-IIC-IOPC IN DLC)
                    MOVE 'COL'          TO MSG-COD-SIST
                    MOVE 'DLC    NEX  ' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FIO-STAT-NEX TO FIO-STAT
                    MOVE SCR-STAT-CON TO SCR-STAT
                    MOVE 'S'          TO SCR-IERR
                    GO TO FIN-FND-KEY
           ELSE
           IF (DLC-IND-SCTB IN DLC = 'VCD' OR
               DLC-IND-SCTB IN DLC = 'CAS' )
                GO TO FIN-BUS-AEP.
      *
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB
           MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-CAUX IN WSS-VARI.
           IF WSS-COD-TOOC IN WSS-VARI  NOT = 'CON'
              GO TO FIN-BUS-AEP.
      *
           MOVE DBC-CAI-ICLI IN DBC TO AEP-CAI-ICLI IN AEP.
           MOVE DBC-IIC-ICLI IN DBC TO AEP-IIC-ICLI IN AEP.
           MOVE '999999999'         TO AEP-FEC-FAEP IN AEP.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-AEP.
           IF NOT FIO-STAT-OKS  OR
              AEP-CIC-ICLI IN AEP NOT = DBC-CIC-ICLI IN DBC
              MOVE 'COL'          TO MSG-COD-SIST
              MOVE 'CLI    NOAEP' TO MSG-COD-MENS IN MSG
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE 'S'          TO SCR-IERR
              GO TO FIN-FND-KEY
           ELSE
           IF  AEP-VAL-RLCL IN AEP NOT > ZEROES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CLI    NORTA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE SCR-STAT-CON TO SCR-STAT
              MOVE 'S'          TO SCR-IERR
              GO TO FIN-FND-KEY.
       FIN-BUS-AEP.
      *JGM-AEP.
       ANL-CLI.
           PERFORM ANL-KEY-ALL.
           IF MSG-COD-MENS NOT = SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
               MOVE 'S'          TO SCR-IERR
      *PTC fin
               GO TO FIN-FND-KEY.
       REC-OPC-STAT.
      *ISP/ 23-JAN-1990
      * RECUPERACION DE LA(S) CANCELACION(ES) ASOCIADAS A LA OPERACION
           IF OPC-IND-RENO IN OPC NOT > SPACES
               GO TO NOT-BUS-ROV.
           PERFORM BUS-CIC-RENO
           IF OPC-IND-RENO IN OPC = RNO-CIC-NOV IN RNO-VARI
               PERFORM GET-ROV-NOV
           ELSE
               IF (OPC-IND-RENO IN OPC = RNO-CIC-REN IN RNO-VARI) OR
                  (OPC-IND-RENO IN OPC = RNO-CIC-PRO IN RNO-VARI)
                   PERFORM GET-ROV-REN
                   MOVE WSS-SGV-RENO TO ROV-SGV-RENO IN ROV.
       NOT-BUS-ROV.
           MOVE PGM-STAT-OPC TO FIO-STAT.
      *>>>>
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
      
       PUT-SCR SECTION.
       INI-PUT-SCR.
           PERFORM PUT-ALL-OPC.
       FIN-PUT-SCR.
           EXIT.
      
       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
      *<<<< ABT_CMN_ACC
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOLIQ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE  MSG-GLS-DESC TO FRM-MENS
      *>>>>
               GO TO FIN-CMN-ACC.
      *<<<< INI_CMN_ACC
      *>>>>
           PERFORM KEY-ALL-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
      *    PERFORM RET-ALL-OPC.
       FIN-CMN-ACC.
           EXIT.
      
       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *<<<< SCR_EXIT
           IF WSS-NTRN > SPACES
               MOVE WSS-NTRN TO SYS-NTRN.
      *>>>>
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.
      
       SCR-PUTA SECTION.
       INI-SCR-PUTA.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE OPC-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.
      
       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO OPC-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.
      
       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-OPC
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO OPC-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-OPC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-OPC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-OPC.
           PERFORM VAL-IKY-OPC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-OPC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-OPC.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           PERFORM VAL-CON-KEY-OPC.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-OPC.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-OPC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.
      
       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO OPC-GLS-MEN2
               MOVE SCR-PRMT TO OPC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO OPC-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.
      
       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO OPC-GLS-MEN2
               MOVE SCR-PRMT TO OPC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO OPC-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      
       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO OPC-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.
      
       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE OPC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO OPC-FLD
               MOVE FRM-MENS TO OPC-GLS-MENS.
           PERFORM PRO-FLD-OPC.
           PERFORM UNP-KEY-OPC.
           PERFORM FST-KEY-OPC.
       FIN-HBL-KEY.
           EXIT.
      
       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-OPC.
           PERFORM PRO-AKY-OPC.
           PERFORM UNP-MKY-OPC.
           PERFORM UNP-FLD-OPC.
           PERFORM FST-FLD-OPC.
      *<<<< FIN_HBL_FLD
      *>>>>
       FIN-HBL-FLD.
           EXIT.
      
       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO OPC-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.
      
       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-OPC.
           PERFORM PRO-FLD-OPC.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.
      
       SCR-TRL SECTION.
       INI-SCR-TRL.
      *<<<< INI_SCR_TRL
      *JSS 16-MAY-1991 15:32:57 ( para manejo de cuenta corriente )
      *    IF OPC-MSC-STAT IN OPC = 'X' OR 'B' OR 'G'
           IF OPC-ESPERA-ABONO
               MOVE 'COL'               TO MSG-COD-SIST
               MOVE 'OPCSTT'            TO MSG-COD-TMSG
               MOVE OPC-MSC-STAT IN OPC TO MSG-COD-CMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
               MOVE 'S'          TO SCR-IERR
      *PTC fin
      *** RBG INI 10-APR-1996
           ELSE
           IF OPC-APROBADA-APR
              MOVE 'COL'          TO MSG-COD-SIST
              MOVE 'OPC    APRYA' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
              MOVE 'S'          TO SCR-IERR
      *PTC fin
           ELSE
      **** RBG FIN 10-APR-1996
      *
      *    IF OPC-MSC-STAT IN OPC = 'A'
           IF OPC-ACTIVADA
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    ACAYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
               MOVE 'S'          TO SCR-IERR
      *PTC fin
           ELSE
      *    IF OPC-MSC-STAT IN OPC = 'S'
           IF OPC-SUSPENDIDA
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    SUSYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
               MOVE 'S'          TO SCR-IERR
      *PTC fin
           ELSE
      *    IF OPC-MSC-STAT IN OPC = 'D'
           IF OPC-DESACTIVADA
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DESYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
               MOVE 'S'          TO SCR-IERR
      *PTC fin
           ELSE
      *    IF OPC-MSC-STAT IN OPC = 'L'
           IF OPC-LIQUIDADA
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    LIQYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *PTC ini
               MOVE 'S'          TO SCR-IERR
      *PTC fin
           ELSE
               PERFORM VRF-ROPC
               IF FRM-SUAR = FRM-SUAR-MAL
      *PTC ini
                   MOVE 'S'          TO SCR-IERR
      *PTC fin
                   MOVE SCR-STAT-CON TO SCR-STAT
               ELSE
      * RBG INI 1-APR-1996 **Esto Corresponde a Cliente Moroso**
                  IF FRM-MEN2 > SPACES
                     MOVE SPACES TO FRM-MEN1
                     PERFORM LIQ-ROPC
                     IF MSG-COD-MENS > SPACES
                        MOVE MSG-GLS-DESC TO FRM-MEN1
      *PTC ini
                        MOVE 'S'          TO SCR-IERR
      *PTC fin
                        MOVE SCR-STAT-CON TO SCR-STAT
                     ELSE
                        NEXT SENTENCE
                  ELSE
                      MOVE SPACES TO FRM-MENS
                      PERFORM LIQ-ROPC
                      IF MSG-COD-MENS > SPACES
                         MOVE MSG-GLS-DESC TO FRM-MEN1
      *PTC ini
                         MOVE 'S'          TO SCR-IERR
      *PTC fin
                         MOVE SCR-STAT-CON TO SCR-STAT.
      * RBG FIN 1-APR-1996 **Esto Corresponde a Cliente Moroso**
      
      *DAD ini  07-APR-1993
      *     IF SCR-STAT = SCR-STAT-SON AND SCR-CMND = 'LIQ'
      **JSS Se mueve la transaccion del programa liquidador
      *             MOVE 'KO44' TO WSS-NTRN.
           IF SCR-STAT = SCR-STAT-SON
               IF SCR-CMND = 'LIQ'
      * Mueve transaccion de NUEVO programa liquidador COLPCODC : KO74
                   MOVE 'KO74' TO WSS-NTRN
               ELSE
      * Mueve transaccion de ANTIGUO programa liquidador COLPCOPC : KO44
                   MOVE 'KO44' TO WSS-NTRN.
      *DAD fin  07-APR-1993
      *>>>>
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-SON
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-OPC
               PERFORM EDT-FLD-OPC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
           MOVE 'S'          TO SCR-IERR.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-OPC
           PERFORM EDT-FLD-OPC
           PERFORM SCR-PUTA
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.
      
       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.
      
       PRO-CONF SECTION.
       INI-PRO-CONF.
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-MSSG.
           PERFORM PRO-KEY-OPC.
           PERFORM PRO-FLD-OPC.
           PERFORM FST-MSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-OPC
               PERFORM EDT-FLD-OPC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.
      
       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO OPC-GLS-MEN2
               MOVE SCR-CONF TO OPC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO OPC-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-OPC
                   PERFORM VAL-NUM-FLD-OPC
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.
      
      *JSS COPY COLBMOPC.
       COPY COLBQOPC.
      
       COPY COLBFOPC.
       COPY GNSBFMSC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGVSM.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      *COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
      *PTC-INI
       PGM-EBR-ALL SECTION.
       INI-PGM-EBR-ALL.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       FIN-PGM-EBR-ALL.
           EXIT.
      *PTC-FIN
      
      *<<<< EOF
       ANL-KEY-OPC SECTION.
       INI-ANL-KEY-OPC.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROES TO DBC-NUM-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN OPC-FLD
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ANL-KEY-OPC
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPC-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD
               PERFORM BUS-DEU-DIR
               IF FIO-STAT-OKS
                   MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                   MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
               ELSE
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'CLI    NODIR' TO MSG-COD-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-KEY-OPC.
           EXIT.
      
       ANL-KEY-ALL SECTION.
       INI-ANL-KEY-ALL.
           PERFORM GET-CUR-ITR.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOINT' TO MSG-COD-MENS
               GO TO FIN-ANL-KEY-ALL.
           PERFORM GET-NXT-ITR.
           IF SCR-IND-MITR = 'M'
               MOVE 'MULTIPLES'  TO ITR-COD-TINT IN OPC-FLD
           ELSE
               MOVE '00' TO PGM-STAT-ITR
               PERFORM PUT-ITR-OPC.
           PERFORM GET-CUR-COM.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-COM
                PERFORM GET-NXT-COM
                IF SCR-IND-MCOM = 'M'
                    MOVE 'MULTIPLES' TO COM-COD-TINT IN OPC-FLD
                ELSE
                    PERFORM PUT-COM-OPC
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE ZEROES TO COM-SGV-TINT IN OPC-FLD
                MOVE SPACES TO COM-COD-TINT IN OPC-FLD.
           PERFORM GET-CUR-CYA.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-CYA
                PERFORM GET-NXT-CYA
                IF SCR-IND-MCYA = 'M'
                    MOVE 'M'          TO CYA-IND-TCYA IN OPC-FLD
                    MOVE MSG-GLS-DESC TO FRM-MEN2
                    MOVE SPACES TO MSG-COD-SIST
                    MOVE SPACES TO MSG-COD-MENS
                ELSE
                    PERFORM PUT-CYA-OPC
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE SPACES TO CYA-IND-TCYA IN OPC-FLD
                MOVE SPACES TO CYA-CAI-ICYA IN OPC-FLD
                MOVE ZEROES TO CYA-IIC-ICYA IN OPC-FLD.
           MOVE OPC-CIC-IOPC IN OPC TO AUT-CIC-IOPC IN AUT.
           MOVE 'AUT'               TO AUT-NUM-ICAN IN AUT.
           MOVE 1                   TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-AUT
               PERFORM PUT-AUT-OPC
           ELSE
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO AUT-IIC-ICYA IN OPC-FLD
               MOVE SPACES TO AUT-CAI-ICYA IN OPC-FLD.
           PERFORM GET-CUR-ROV.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-ROV.
       FIN-ANL-KEY-ALL.
           EXIT.
      
       BUS-DEU-DIR SECTION.
       INI-BUS-DEU-DIR.
           MOVE SPACES              TO RDC-KEY-IRDC IN RDC.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN RDC.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE '999999999999' TO RDC-KEY-IDLC IN RDC
               MOVE 999 TO RDC-NUM-IDLC IN RDC
               MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-DEU-DIR.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC
               IF RDC-NUM-IDLC IN RDC = ZEROES
                   MOVE '00' TO PGM-STAT-RDC
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   MOVE 'IRDC' TO SCR-KEY-IRDC
                   GO TO FIN-BUS-DEU-DIR
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
            ELSE
               MOVE SPACES TO SCR-RQA2
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-DEU-DIR.
           EXIT.
      
       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *DSP COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-RDC.
      *DSP COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC AND
              RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC AND
              RDC-NUM-IDLC IN RDC = ZEROS
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *
       FIN-GET-CUR-RDC.
           EXIT.
      
       GET-NXT-RDC SECTION.
       INI-GET-NXT-RDC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              OPC-CAI-IOPC IN OPC = RDC-CAI-IOPC IN RDC AND
              OPC-IIC-IOPC IN OPC = RDC-IIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'OPC    MDDIR' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO SCR-IND-MRDC
                PERFORM GET-CUR-RDC.
       FIN-GET-NXT-RDC.
           EXIT.
      
       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
      *ALD-BCI-INI/12.08.1996
      *         MOVE '23' TO FIO-STAT.
                MOVE '23' TO FIO-STAT
                GO TO FIN-GET-CUR-ITR.
           MOVE ITR-COD-TINT IN ITR TO SCR-COD-TINT.
      *ALD-BCI-FIN/12.08.1996
       FIN-GET-CUR-ITR.
           EXIT.
      
       GET-NXT-ITR SECTION.
       INI-GET-NXT-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS                              AND
              ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
                MOVE 'M' TO SCR-IND-MITR
           ELSE
                MOVE SPACES TO SCR-IND-MITR
                PERFORM GET-CUR-ITR.
       FIN-GET-NXT-ITR.
           EXIT.
      
       GET-CUR-COM SECTION.
       INI-GET-CUR-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO COM-CIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE 'COM'               TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = 'COM' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COM.
           EXIT.
      
       GET-NXT-COM SECTION.
       INI-GET-NXT-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF FIO-STAT-OKS                              AND
              COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
              COM-NUM-ICAN IN COM = ZEROES              AND
              COM-CIC-IOPV IN COM = SPACES              AND
              COM-NUM-IVCT IN COM = ZEROES              AND
              COM-IND-TTAS IN COM = 'COM'
                MOVE 'M' TO SCR-IND-MCOM
           ELSE
                MOVE SPACES TO SCR-IND-MCOM
                PERFORM GET-CUR-COM.
       FIN-GET-NXT-COM.
           EXIT.
      
       GET-CUR-CYA SECTION.
       INI-GET-CUR-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
      *DSP COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-CYA.
      *DSP COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              CYA-CIC-IOPC IN CYA = OPC-CIC-IOPC IN OPC AND
              CYA-NUM-ICAN IN CYA = ZEROES              AND
              CYA-NUM-ICYA IN CYA = 1
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *
       FIN-GET-CUR-CYA.
           EXIT.
      
       GET-NXT-CYA SECTION.
       INI-GET-NXT-CYA.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS                              AND
              OPC-CIC-IOPC IN OPC = CYA-CIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES
               MOVE 'M' TO SCR-IND-MCYA
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'OPC    MCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
           ELSE
               MOVE SPACES TO SCR-IND-MCYA
               PERFORM GET-CUR-CYA.
       FIN-GET-NXT-CYA.
           EXIT.
      
       GET-CUR-ROV SECTION.
       INI-GET-CUR-ROV.
           MOVE 'ROV-KEY-IROV' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
      *DSP COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-ROV.
      *DSP COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              ROV-CIC-IOPC IN ROV = OPC-CIC-IOPC IN OPC AND
              ROV-CIC-IOPV IN ROV = SPACES              AND
              ROV-NUM-IVCT IN ROV = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *
       FIN-GET-CUR-ROV.
           EXIT.
      *
       LIQ-ROPC SECTION.
       INI-LIQ-ROPC.
           MOVE SPACES TO MSG-COD-MENS.
      *ALD/22-AUG-1988
      *Si es moneda Nacional transformar a Pesos
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO MSC-COD-CMSC IN MSC.
           MOVE WSS-IND-TMMX IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI.
           MOVE OPC-VAL-CRED IN OPC-FLD  TO WSS-VAL-CRED IN WSS-VARI.
           MOVE 'N' TO WSS-IND-MUF.
           IF OPC-MSC-TVOC IN OPC-FLD = MSC-COD-CMSC IN MSC
               MOVE WSS-IND-TMMN IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI
               MOVE OPC-COD-VCOC IN OPC-FLD TO TAB-COD-CTAB IN TAB
               MOVE '0999  '                TO TAB-CIC-CTAB IN TAB
               MOVE OPC-NUM-DCOL IN OPC-FLD TO TAB-NUM-DTRN IN TAB
               MOVE OPC-NUM-MCOL IN OPC-FLD TO TAB-NUM-MTRN IN TAB
               MOVE OPC-NUM-SCOL IN OPC-FLD TO TAB-NUM-STRN IN TAB
               MOVE OPC-NUM-ACOL IN OPC-FLD TO TAB-NUM-ATRN IN TAB
               PERFORM GET-VCAM
               IF MSG-COD-MENS IN MSG NOT > SPACES
                   MULTIPLY CAM-SGV-VCAM IN CAM BY OPC-VAL-CRED IN
                           OPC-FLD GIVING WSS-VAL-CRED IN WSS-VARI
      * RBG INI 20/NOV/1995
                   MOVE 'S' TO WSS-IND-MUF
      * RBG FIN 20/NOV/1995
               ELSE
                   IF MSG-COD-MENS IN MSG = 'CODVCAMEQL'
                       MOVE 1 TO CAM-SGV-VCAM IN CAM
                       MOVE SPACES TO MSG-COD-MENS IN MSG
                       MOVE OPC-VAL-CRED IN OPC-FLD TO WSS-VAL-CRED IN
                                                       WSS-VARI
                   ELSE
                       GO TO MSG-LIQ-ROPC.
      *
      
      *Valor de Comision
           MOVE 'COL' TO TAB-COD-SIST FIO-SIST.
           MOVE 'COM' TO TAB-COD-TTAB IN TAB.
           MOVE COM-COD-TINT IN OPC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODTCOMNEX' TO MSG-COD-MENS
               MOVE COM-COD-TINT IN OPC-FLD TO FRM-MEN2
               GO TO MSG-LIQ-ROPC.
           IF TAB-CIC-CTAB IN TAB = 'I'
               GO TO IMP-LIQ-ROPC.
      
           MOVE OPC-CAI-IOPC IN OPC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES                  TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES                  TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES                  TO ICG-NUM-IVCT IN ICG.
           MOVE 'COM'                   TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES                  TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN OPC-FLD AND
              ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN OPC-FLD AND
              ICG-NUM-ICAN IN ICG = ZEROES AND
              ICG-CIC-IOPV IN ICG = SPACES AND
              ICG-NUM-IVCT IN ICG = ZEROES AND
              ICG-IND-TTAS IN ICG = 'COM'
              MULTIPLY OPC-VAL-CRED IN OPC-FLD BY ICG-SGV-TINT IN ICG
                                       GIVING OPC-SGV-VCOM IN OPC-FLD
           ELSE
               MOVE ZEROES TO OPC-SGV-VCOM IN OPC-FLD.
      
      *ALD
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MULTIPLY CAM-SGV-VCAM IN CAM BY OPC-SGV-VCOM IN
                        OPC-FLD GIVING OPC-SGV-VCOM IN OPC-FLD.
           DIVIDE OPC-SGV-VCOM IN OPC-FLD BY 100
               GIVING OPC-SGV-VCOM IN OPC-FLD.
      
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MOVE OPC-SGV-VCOM IN OPC-FLD TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO OPC-SGV-VCOM IN OPC-FLD.
      *
       IMP-LIQ-ROPC.
      *Valor del Impuesto y Gastos de Notario
           PERFORM OBT-VIMP-GNOT.
           IF MSG-COD-MENS > SPACES
               GO TO MSG-LIQ-ROPC.
      *RRM-INI 19-JUL-1999
      *Valida el plazo total.
           IF OPC-IND-RENO IN OPC NOT = SPACES
              PERFORM DET-OPC-ORIG-BALL
              IF MSG-COD-MENS > SPACES
                 GO TO MSG-LIQ-ROPC
              ELSE
                 PERFORM CAL-PLZO-BALL
                 IF MSG-COD-MENS > SPACES
                    IF MSG-COD-MENS = 'TABLAPRBNEX'
                       MOVE SPACES TO MSG-COD-MENS
                       MOVE WSS-OPC TO OPC
                    ELSE
                       GO TO MSG-LIQ-ROPC.
      * RRM-FIN 19-JUL-1999
      * RBG INI 30-NOV-1995
           MOVE 'COL'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSC'                    TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN OPC-FLD  TO WSS-COD-TOOC IN WSS-VARI.
           MOVE OPC-COD-AOOC IN OPC-FLD  TO WSS-COD-AOOC IN WSS-VARI.
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE 'N' TO WSS-IND-RBJB IN WSS-VARI
           ELSE
               MOVE 'S' TO WSS-IND-RBJB IN WSS-VARI.
      *
      * RBG FIN 30-NOV-1995
      *Valor del Seguro
           MOVE 'COL' TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDG' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-SEGD IN OPC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
                  TAB-IND-VIGE NOT = 'S'
               MOVE 'CODSEGDNEX' TO MSG-COD-MENS
               MOVE OPC-COD-SEGD IN OPC-FLD TO FRM-MEN2
               GO TO MSG-LIQ-ROPC.
      
      * DPM ini  21-JUN-1995
           MOVE ZEROES         TO  OPC-VAL-SEGC IN OPC-FLD.
           MOVE TAB-GLS-DATA   TO  WSS-GLS-DATA-SEGH.
           MOVE 'S'            TO  WSS-IND-RBJA.
      *
           IF TAB-CIC-CTAB IN TAB  = 'SEGHIP'
              IF WSS-IND-MUF = 'S'
              IF OPC-VAL-SCRE IN OPC-FLD NOT < OPC-VAL-SEGD IN OPC-FLD
                 IF WSS-VAL-TSEG NOT NUMERIC
                    MOVE 'TSEGNONUME' TO MSG-COD-MENS
                    GO TO MSG-LIQ-ROPC
                 ELSE
                    MOVE 'N' TO WSS-IND-RBJA
                    MULTIPLY WSS-VAL-TSEG
                          BY OPC-VAL-SCRE IN OPC-FLD
                      GIVING OPC-VAL-SEGD IN OPC-FLD
                ELSE
                    MOVE 'MSEG>MCRE' TO MSG-COD-MENS
                    GO TO MSG-LIQ-ROPC
                ELSE
                   MOVE 'MNCRE<>MNREA' TO MSG-COD-MENS
                   GO TO MSG-LIQ-ROPC
           ELSE
      *    RBG FIN 16-NOV-1995
      *    Si Sit Contable es VCD seguro 0
           IF TAB-CIC-CTAB IN TAB NOT = 'SEGDES'
               MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
           ELSE
               MOVE OPC-CAI-IOPC IN OPC-FLD TO DLC-CAI-IOPC IN DLC
               MOVE OPC-IIC-IOPC IN OPC-FLD TO DLC-IIC-IOPC IN DLC
               MOVE ZEROES                  TO DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-NLS             TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF NOT (FIO-STAT-OKS AND
                 OPC-CAI-IOPC IN OPC-FLD = DLC-CAI-IOPC IN DLC AND
                 OPC-IIC-IOPC IN OPC-FLD = DLC-IIC-IOPC IN DLC)
                   MOVE 'DLC    NEX  '      TO MSG-COD-MENS
                   MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
                   GO TO MSG-LIQ-ROPC
               ELSE
               IF (DLC-IND-SCTB IN DLC = 'VCD' OR
                 OPC-IND-RENO IN OPC-FLD = 'PRO')
                   MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
               ELSE
                 IF TAB-CIC-CTAB IN TAB  = 'SEGDES      '  AND
                    TAB-COD-CTAB IN TAB  = 'SEGDES'
                     PERFORM CALC-SEG-SEGDES
                     IF MSG-COD-MENS > SPACES
                         GO TO MSG-LIQ-ROPC.
      * DPM fin  21-JUN-1995
      * RBG/INI/28-APR-1997
           IF TAB-CIC-CTAB IN TAB = 'SEGCOR'
               PERFORM CALC-SEG-CORF
               IF MSG-COD-MENS IN MSG > SPACES
                   GO TO MSG-LIQ-ROPC.
      * RBG/FIN/28-APR-1997
      
      *INI-JGM 19-05-1999.
      *
      *CALCULO:SINSEG.
           IF (TAB-CIC-CTAB IN TAB = 'SINSEG' AND
               OPC-IND-RENO IN OPC-FLD NOT = 'PRO')
               MOVE ZEROES TO OPC-VAL-SEGD  IN OPC-FLD
               MOVE ZEROES TO OPC-VAL-SEGC  IN OPC-FLD.
      *
      *CALCULO:CNAVAL.
           IF (TAB-CIC-CTAB IN TAB = 'SEGDES' AND
               TAB-COD-CTAB IN TAB = 'CNAVAL' AND
               OPC-IND-RENO IN OPC-FLD NOT = 'PRO')
               PERFORM LIM-VEC-TIO
               PERFORM CALC-SEG-CNAVAL
               IF MSG-COD-MENS IN MSG > SPACES
                   GO TO MSG-LIQ-ROPC.
      *Calculo:CESANT.
           IF (TAB-CIC-CTAB IN TAB = 'CESANTCESANT' AND
               OPC-IND-RENO IN OPC-FLD NOT = 'PRO')
               PERFORM LIM-VEC-TIO
               PERFORM CALC-SEG-CESANT
               IF MSG-COD-MENS IN MSG > SPACES
                   GO TO MSG-LIQ-ROPC.
      *
      *Calculo:SEDECE----->CNAVAL+CESANT.
           IF (TAB-CIC-CTAB IN TAB = 'SEGDESCESANT' AND
               OPC-IND-RENO IN OPC-FLD NOT = 'PRO')
               PERFORM LIM-VEC-TIO
               PERFORM CALC-SEG-CNAVAL
               IF MSG-COD-MENS IN MSG > SPACES
                   GO TO MSG-LIQ-ROPC
               ELSE
                  PERFORM LIM-VEC-TIO
                  PERFORM CALC-SEG-CESANT
                  IF MSG-COD-MENS IN MSG > SPACES
                     GO TO MSG-LIQ-ROPC.
      *
      *Seguro Comercial.
      * RBG/INI/11-NOV-1997
           IF (TAB-CIC-CTAB IN TAB = 'SEDECO      ' AND
               OPC-IND-RENO IN OPC-FLD NOT = 'PRO')
               PERFORM LIM-VEC-TIO
               PERFORM CALC-SEG-SEDECO
               IF MSG-COD-MENS IN MSG > SPACES
                   GO TO MSG-LIQ-ROPC.
      *
      *CALCULO:SECOCE----->SEDECO+CESANT.
           IF (TAB-CIC-CTAB IN TAB = 'SEDECOCESANT' AND
               OPC-IND-RENO IN OPC-FLD NOT = 'PRO')
               PERFORM LIM-VEC-TIO
               PERFORM CALC-SEG-SEDECO
               IF MSG-COD-MENS IN MSG > SPACES
                   GO TO MSG-LIQ-ROPC
               ELSE
                  PERFORM LIM-VEC-TIO
                  PERFORM CALC-SEG-CESANT
                  IF MSG-COD-MENS IN MSG > SPACES
                     GO TO MSG-LIQ-ROPC.
      *
      *FIN-JGM 19-05-1999.
      *Si como opera = 'B', valor capital debe ser 0
           IF WSS-OPEC = 'B'
              MOVE ZEROES     TO  WSS-VAL-CRED IN WSS-VARI.
      *
      * RBG INI 16-NOV-1995
           IF WSS-IND-RBJA = 'N'
               MOVE ZEROES    TO WSS-VAL-SEGD IN WSS-VARI
           ELSE
               MOVE OPC-VAL-SEGD IN OPC-FLD TO WSS-VAL-SEGD IN WSS-VARI.
      *
      * RBG FIN 16-NOV-1995
      * RBG INI 29-NOV-1995
           IF WSS-IND-RBJB = 'N'
               MOVE ZEROES TO WSS-VAL-SEGP IN WSS-VARI
           ELSE
               MOVE OPC-VAL-SEGP IN OPC-FLD TO WSS-VAL-SEGP IN WSS-VARI.
      
      * RBG INI 14-MAR-1996 **Esto corresponde al peso**
           IF WSS-IND-MUF = 'S'
              IF OPC-IND-RENO IN OPC-FLD = 'PRO' OR 'REN'
      *ALD-BCI-INI/13-08-1998
      *          IF WSS-VAL-CRED  IN  WSS-VARI  NOT > ROV-SGV-RENO  IN
      *                                                        OPC-FLD
      *ALD-BCI-FIN/13-08-1998
                 SUBTRACT ROV-SGV-RENO IN OPC-FLD
                     FROM WSS-VAL-CRED IN WSS-VARI
                   GIVING WSS-VAL-DIFE IN WSS-VARI
                     MOVE WSS-VAL-DIFE IN  WSS-VARI TO
                                           PES-SGV-DECI IN PES-VARI
                    PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE IN PES-VARI  TO
                                            WSS-VAL-DIFE IN WSS-VARI
      *
                    IF WSS-VAL-DIFE IN WSS-VARI < 10
                       MOVE ROV-SGV-RENO IN OPC-FLD TO
                                            WSS-VAL-CRED IN WSS-VARI.
      
      * RBG FIN 14-MAR-1996 **Esto corresponde al peso**
      * RBG FIN 29-NOV-1995
           COMPUTE OPC-SGV-LIQU IN OPC-FLD =
      * RBG INI 16-NOV-1995
      *        WSS-VAL-CRED IN WSS-VARI - OPC-VAL-SEGD IN OPC-FLD  -
               WSS-VAL-CRED IN WSS-VARI - WSS-VAL-SEGD IN WSS-VARI -
      * RBG FIN 16-NOV-1995
               OPC-VAL-GAST IN OPC-FLD  - OPC-SGV-VCOM IN OPC-FLD  -
               WSS-VAL-IMPU IN WSS-VARI - WSS-VAL-GNOT IN WSS-VARI -
               WSS-VAL-SEGP IN WSS-VARI - OPC-VAL-SEGC IN OPC-FLD.
      
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MOVE OPC-SGV-LIQU IN OPC-FLD TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO OPC-SGV-LIQU IN OPC-FLD.
      *ALD
           IF WSS-OPEC NOT = 'B'
               SUBTRACT ROV-SGV-RENO IN OPC-FLD FROM OPC-SGV-LIQU
                                                             IN OPC-FLD.
      *
      *ALD-BCI-INI/12.08.1996
      *     PERFORM VAL-SPR-MINI.
      *ALD-BCI-FIN/12.08.1996
           GO TO FIN-LIQ-ROPC.
       MSG-LIQ-ROPC.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
       FIN-LIQ-ROPC.
           EXIT.
      
       OBT-VIMP-GNOT SECTION.
       INI-OBT-VIMP-GNOT.
           MOVE 0 TO WSS-VAL-IMPU IN WSS-VARI.
           MOVE 0 TO WSS-VAL-GNOT IN WSS-VARI.
      * DPM ini  22-JUN-1995
           MOVE ZEROES TO WSS-FEC-FMAV IN WSS-VARI.
      * DPM fin  22-JUN-1995
      
           MOVE OPC-COD-TOOC IN OPC-FLD TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPCTOOCNEX'        TO MSG-COD-MENS
               MOVE TOC-COD-TOCR IN TOC TO FRM-MEN2
               GO TO FIN-OBT-VIMP-GNOT.
      
           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'TOCOPECNEX'        TO MSG-COD-MENS
               MOVE MSC-COD-TABL IN MSC TO FRM-MEN2
               GO TO FIN-OBT-VIMP-GNOT.
      
           MOVE MSC-CIC-CMSC IN MSC TO WSS-OPEC.
      
           IF MSC-CIC-CMSC IN MSC = 'D'
               MOVE 'N' TO WSS-INTR
           ELSE
               MOVE 'S' TO WSS-INTR.
      
           MOVE OPC-CAI-IOPC IN OPC-FLD TO UVD-CAI-IOPC IN UVD.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO UVD-IIC-IOPC IN UVD.
           PERFORM BUS-UVD.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-OBT-VIMP-GNOT.
      
           MOVE OPC-CAI-IOPC IN OPC-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE 0                       TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-VIMP-GNOT.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC = OPC-CAI-IOPC IN OPC-FLD AND
                    DLC-IIC-IOPC IN DLC = OPC-IIC-IOPC IN OPC-FLD )
               GO TO FIN-OBT-VIMP-GNOT.
           MOVE OPC-COD-TOOC IN OPC-FLD TO OPC-COD-TOOC IN OPC.
           MOVE OPC-COD-AOOC IN OPC-FLD TO OPC-COD-AOOC IN OPC.
      
      *Leer miscelaneo TIMP en COL
           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'TIMP'              TO MSC-COD-TMSC IN MSC.
           MOVE DLC-MSC-TIMP IN DLC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLCTIMPNEX'        TO MSG-COD-MENS
               MOVE MSC-COD-TABL IN MSC TO FRM-MEN2
               GO TO FIN-OBT-VIMP-GNOT.
           MOVE MSC-CIC-MSCL IN MSC TO WSS-CIC-IMPU.
      
      *Leer Tabla de Impuestos ( IMP )
           MOVE DLC-COD-TDOC IN DLC TO IMP-COD-TDOC IN IMP.
           MOVE DLC-MSC-TIMP IN DLC TO IMP-MSC-TIMP IN IMP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-IMP.
           IF NOT FIO-STAT-OKS
               MOVE 'IMP    NEX' TO MSG-COD-MENS
               MOVE IMP-COD-TABL IN IMP TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.
      
           IF WSS-INTR = 'S' AND DLC-COD-NOTC IN DLC > SPACES
      *Leer Tabla de Notarios ( NTR )
               MOVE DLC-COD-NOTC IN DLC TO NTR-COD-NOTA IN NTR
               MOVE OPC-COD-OFOC IN OPC TO NTR-COD-OFIC IN NTR
               MOVE DLC-COD-TDOC IN DLC TO NTR-COD-TDOC IN NTR
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-NTR
               IF NOT FIO-STAT-OKS
                   MOVE 'NTR    NEX' TO MSG-COD-MENS
                   MOVE NTR-COD-TABL IN NTR TO FRM-MEN2
                   MOVE FIO-BCK-OUT TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   GO TO FIN-OBT-VIMP-GNOT
               ELSE
      *SUMA el Gasto del Notario
      *ALD-BCI-INI/11042000
      *            ADD NTR-VAL-GNOT IN NTR TO WSS-VAL-GNOT IN WSS-VARI
                   ADD DLC-VAL-GNOT IN DLC TO WSS-VAL-GNOT IN WSS-VARI
      *ALD-BCI-FIN/11042000
           ELSE
               MOVE 0 TO NTR-VAL-GNOT IN NTR.
      
      *Obtiene Diferencia de Meses entre Fecha de Colocacion  ( OPC ) y
      *                                  Fecha de Vencimiento ( DLC )
           IF DLC-NUM-IDLC IN DLC > UVD-IMAX IN UVD
               MOVE 'DLCFVENNODET'      TO MSG-COD-MENS
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.
      *Desplazar fecha si hay analisis de feriado antes de calcular dife
           IF OPC-IND-AFER IN OPC-FLD = 'N'
               GO TO DFD-OBT-VIMP-GNOT.
           MOVE DLC-NUM-DVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-ITM1.
           MOVE DLC-NUM-MVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-ITM2.
           MOVE DLC-NUM-SVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-ITM3.
           MOVE DLC-NUM-AVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-ITM4.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
               MOVE 'LIQDDIAIMPU' TO MSG-COD-MENS
               MOVE FIO-BCK-OUT   TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.
           IF FEC-STAT-FER
               MOVE FEC-SIG-HBL TO FEC-CMND
      *        PERFORM PRO-FEC
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   MOVE 'LIQSHBLIMPU' TO MSG-COD-MENS
                   MOVE FIO-BCK-OUT TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   GO TO FIN-OBT-VIMP-GNOT.
           MOVE FEC-ITM1 TO DLC-NUM-DVEN IN UVD(DLC-NUM-IDLC IN DLC).
           MOVE FEC-ITM2 TO DLC-NUM-MVEN IN UVD(DLC-NUM-IDLC IN DLC).
           MOVE FEC-ITM3 TO DLC-NUM-SVEN IN UVD(DLC-NUM-IDLC IN DLC).
           MOVE FEC-ITM4 TO DLC-NUM-AVEN IN UVD(DLC-NUM-IDLC IN DLC).
      *
       DFD-OBT-VIMP-GNOT.
           MOVE OPC-FEC-FCOL IN OPC-FLD                  TO FEC-FEC1.
           MOVE DLC-NUM-DVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-DEC2.
           MOVE DLC-NUM-MVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-MEC2.
           MOVE DLC-NUM-SVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-SEC2.
           MOVE DLC-NUM-AVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-AEC2.
      
      *DAD ini  15-JUL-1994   (Mimu.05-01-93 pto.3)
      *     IF WSS-CIC-IMPU = 'I'
      *         GO TO CON-OBT-VIMP-GNOT.
      
      *     IF OPC-IND-RENO IN OPC-FLD = 'PRO'
      *         MOVE CAN-CAI-IOPC IN OPC-FLD TO CIP-CAIP IN CIP-VARI
      *         MOVE CAN-IIC-IOPC IN OPC-FLD TO CIP-IICP IN CIP-VARI
      *         MOVE FEC-FEC1                TO CIP-FCCN IN CIP-VARI
      *         MOVE FEC-FEC2                TO CIP-FVCN IN CIP-VARI
      *         MOVE DLC-VAL-NDLC IN DLC     TO CIP-NDLC IN CIP-VARI
      *         MOVE IDD-FSIS IN IDD-VARI    TO CIP-VIDD IN CIP-VARI
      *         MOVE FIO-MSFL IN FIO-CTTS    TO CIP-MSFL IN CIP-VARI
      *         MOVE CIP-CMMA IN CIP-VARI    TO SYS-CMMA
      *         MOVE 'COLPPCIP'              TO SYS-PROG
      *         MOVE CIP-TCMA IN CIP-VARI    TO SYS-TCMA
      *         MOVE SYS-LINK                TO SYS-CMND
      *         PERFORM GNS-PRO-SYS
      *         MOVE SYS-CMMA TO CIP-CMMA
      *         MOVE CIP-MSFL TO FIO-MSFL
      *         IF CIP-CMSG IN CIP-VARI > SPACES
      *             MOVE CIP-CMSG IN CIP-VARI TO MSG-COD-MENS
      *             MOVE CIP-MEN2 IN CIP-VARI TO FRM-MEN2
      *             MOVE FIO-BCK-OUT TO FIO-CMND
      *             PERFORM COL-FIO-OPC
      *             GO TO FIN-OBT-VIMP-GNOT
      *         ELSE
      *             MOVE CIP-IMPP IN CIP-VARI TO WSS-AUX-IMPU IN WSS-VAR
      *             GO TO PRO-OBT-VIMP-GNOT.
      *DAD fin  15-JUL-1994
      
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-MES  TO FEC-CMND.
      *Despues cambiar a CAL-FEC.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.
      *ALD-BCI-INI/07101999
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
               COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
      *ALD-BCI-FIN/07101999
           IF FEC-NDIA > 0
               ADD 1 TO FEC-NMES.
      
      *DAD ini  15-JUL-1994    (Desplazado lineas ARRIBA)
           IF WSS-CIC-IMPU = 'I'
               GO TO CON-OBT-VIMP-GNOT.
      *DAD fin  15-JUL-1994
      
      *Calcula el valor de impuesto para el DLC en particular
           MULTIPLY IMP-VAL-TIMP IN IMP BY FEC-NMES
               GIVING WSS-AUX-IMPU IN WSS-VARI.
           IF WSS-AUX-IMPU IN WSS-VARI > IMP-VAL-TOPE IN IMP
               MOVE IMP-VAL-TOPE IN IMP TO WSS-AUX-IMPU IN WSS-VARI.
      *ALD
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MULTIPLY CAM-SGV-VCAM IN CAM BY DLC-VAL-NDLC IN
                        DLC GIVING WSS-VAL-NDLC IN WSS-VARI
           ELSE
               MOVE DLC-VAL-NDLC IN DLC TO WSS-VAL-NDLC IN WSS-VARI.
      *    MULTIPLY WSS-AUX-IMPU IN WSS-VARI BY DLC-VAL-NDLC IN DLC
           MULTIPLY WSS-AUX-IMPU IN WSS-VARI BY WSS-VAL-NDLC IN WSS-VARI
               GIVING WSS-AUX-IMPU IN WSS-VARI.
      
           DIVIDE WSS-AUX-IMPU IN WSS-VARI BY 100
               GIVING WSS-AUX-IMPU IN WSS-VARI.
      *ALD
      *DAD ini  15-JUL-1994   (Mimu.05-01-93 pto.3)
       PRO-OBT-VIMP-GNOT.
      *DAD fin  15-JUL-1994
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MOVE WSS-AUX-IMPU IN WSS-VARI TO PES-SGV-DECI IN
                                                       PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-AUX-IMPU IN
                                                       WSS-VARI.
       CON-OBT-VIMP-GNOT.
      
      * DEBE IMPLEMENTARSE EL FIO-GET-NXT-UPD......para no leer nuevamen
      *Actualiza Valor de Impuesto en el DLC particular(si no es informa
      *Acumula los valores de impuesto de cada DLC en WSS-VAL-IMPU
      *Actualiza Gasto de Notario  en el DLC particular
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NGKUP' TO MSG-COD-MENS
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.
      
           IF WSS-CIC-IMPU NOT = 'I'
               MOVE WSS-AUX-IMPU IN WSS-VARI TO DLC-VAL-IMPU IN DLC.
      
           ADD DLC-VAL-IMPU IN DLC TO WSS-VAL-IMPU.
      
      *ALD-BCI-FIN/11042000
      *    IF WSS-INTR = 'S'
           IF WSS-INTR NOT = 'S'
      *        MOVE NTR-VAL-GNOT IN NTR  TO DLC-VAL-GNOT IN DLC
      *     ELSE
      *ALD-BCI-FIN/11042000
               MOVE ZEROES               TO DLC-VAL-GNOT IN DLC.
      *ALD/14-APR-1989
           MOVE DLC-FEC-FVEN IN UVD(DLC-NUM-IDLC IN DLC) TO
                DLC-FEC-FMAV IN DLC.
      
      * DPM ini  22-JUN-1995
           IF DLC-FEC-FMAV IN DLC > WSS-FEC-FMAV IN WSS-VARI
               MOVE DLC-FEC-FMAV IN DLC TO WSS-FEC-FMAV IN WSS-VARI.
      * DPM fin  22-JUN-1995
      
      *
      *     PERFORM GET-FHOY.
      *     MOVE HOY-STP-ITRN TO DLC-STP-IINV IN DLC.
           MOVE OPC-NUM-DCOL IN OPC-FLD TO DLC-NUM-DDEV IN DLC.
           MOVE OPC-NUM-MCOL IN OPC-FLD TO DLC-NUM-MDEV IN DLC.
           MOVE OPC-NUM-SCOL IN OPC-FLD TO DLC-NUM-SDEV IN DLC.
           MOVE OPC-NUM-ACOL IN OPC-FLD TO DLC-NUM-ADEV IN DLC.
      
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NOUPD' TO MSG-COD-MENS
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.
      
      *JSS COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-NXT TO FIO-CMND.
           ADD 1 TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           GO TO LUP-OBT-VIMP-GNOT.
       FIN-OBT-VIMP-GNOT.
           EXIT.
      
      *ALD/24-OCT-1988
       VRF-ROPC SECTION.
       INI-VRF-ROPC.
            PERFORM KEY-OPC-OPC.
      *JSS  MOVE FIO-GET-KEY-UPD TO FIO-CMND.
            MOVE FIO-GET-KEY     TO FIO-CMND.
            PERFORM COL-FIO-OPC.
            IF NOT FIO-STAT-OKS
                MOVE 'OPC    NOUPD' TO MSG-COD-MENS
                MOVE OPC-KEY-IOPC IN OPC TO FRM-MEN2
                MOVE FIO-BCK-OUT TO FIO-CMND
                PERFORM COL-FIO-OPC
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VRF-ROPC.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
      *JSS
           PERFORM CHK-VOPC.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM CHK-FPCI.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
      
           PERFORM PRO-DLC.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-RDC.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-EVC.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-ITR.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-CYA.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
      *No acepta ( temporalmente ) prorrogas,novaciones,renovaciones
      *junto con codigos de cargo/abono para cuenta corriente
      *DAD ini  21-JUL-1992
           IF POC-COD-COTO IN POC NOT = 'LAC' AND
      *DAD fin  21-JUL-1992
              OPC-IND-RENO IN OPC-FLD > SPACES AND
              WSS-OPC-LNBT > SPACES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPCPRGACCTNO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VRF-ROPC.
      *
           PERFORM PRO-ROV.
           IF FRM-SUAR =  FRM-SUAR-MAL
                GO TO FIN-VRF-ROPC.
           PERFORM PRO-RCO.
           IF FRM-SUAR =  FRM-SUAR-MAL
                GO TO FIN-VRF-ROPC.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM SUM-EVC
               IF FRM-SUAR =  FRM-SUAR-MAL
                   GO TO FIN-VRF-ROPC
               ELSE
                   MOVE OPC-NUM-VCVG IN OPC TO OPC-NUM-VCVG IN OPC-FLD
           ELSE
               PERFORM ULT-VEN
               IF FRM-SUAR =  FRM-SUAR-MAL
                   GO TO FIN-VRF-ROPC
               ELSE
                   MOVE OPC-NUM-VCVG IN OPC TO OPC-NUM-VCVG IN OPC-FLD.
      *JSS  MOVE 'V' TO OPC-MSC-STAT IN OPC.
      *     MOVE FIO-MOD TO FIO-CMND.
      *     PERFORM COL-FIO-OPC.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'OPC    NOUPD' TO MSG-COD-MENS
      *         MOVE OPC-KEY-IOPC IN OPC TO FRM-MEN2
      *         MOVE FIO-BCK-OUT TO FIO-CMND
      *         PERFORM COL-FIO-OPC
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VRF-ROPC.
       FIN-VRF-ROPC.
           EXIT.
      
       CHK-VOPC SECTION.
       INI-CHK-VOPC.
           MOVE SPACES TO FRM-MENS.
      *
           MOVE 'S' TO WSS-EPOC.
      
           PERFORM KEY-OPC-OPC.
      
           MOVE ZEROES     TO WSS-FMIV.
           MOVE '99999999' TO WSS-FMAV.
           MOVE ZEROES TO WSS-NEEV.
      
           MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC.
           MOVE ZEROES              TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
      *        GO TO FIN-CHK-VOPC.
               MOVE 'N' TO WSS-EPOC
           ELSE
           IF POC-NUM-PMIN IN POC NOT > ZEROES AND
              POC-NUM-PMAX IN POC NOT > ZEROES
      *        GO TO FIN-CHK-VOPC.
               MOVE 'Z' TO WSS-EPOC.
      
           IF WSS-EPOC NOT = 'S'
               GO TO SK1-CHK-VOPC.
      
           IF POC-NUM-PMIN IN POC > ZEROES
               MOVE POC-IND-PMIN IN POC TO WSS-USEP
               MOVE POC-NUM-PMIN IN POC TO WSS-VSEP
               PERFORM CAL-FECH
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-CHK-VOPC
               ELSE
                   MOVE FEC-ITM1 TO WSS-DMIV
                   MOVE FEC-ITM2 TO WSS-MMIV
                   MOVE FEC-ITM3 TO WSS-SMIV
                   MOVE FEC-ITM4 TO WSS-AMIV.
      
           IF POC-NUM-PMAX IN POC > ZEROES
               MOVE POC-IND-PMAX IN POC TO WSS-USEP
               MOVE POC-NUM-PMAX IN POC TO WSS-VSEP
               PERFORM CAL-FECH
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-CHK-VOPC
               ELSE
                   MOVE FEC-ITM1 TO WSS-DMAV
                   MOVE FEC-ITM2 TO WSS-MMAV
                   MOVE FEC-ITM3 TO WSS-SMAV
                   MOVE FEC-ITM4 TO WSS-AMAV.
      *JSS-TRC
      *     MOVE 'FECHA MINIMA : ' TO DSP-GLS-MEN1.
      *     MOVE WSS-FMIV          TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *JSS-TRC
      *     MOVE 'FECHA MAXIMA : ' TO DSP-GLS-MEN1.
      *     MOVE WSS-FMAV          TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      
           MOVE ZEROES TO WSS-FPPI WSS-FPPC.
       SK1-CHK-VOPC.
      
           MOVE ZEROES TO WSS-FUVC WSS-NEUV.
           MOVE 'N'    TO WSS-IVUV.
      *
           IF OPC-IND-VSTR IN OPC-FLD = 'S'
               PERFORM EVC-CHK-VOPC
           ELSE
               PERFORM VEN-CHK-VOPC.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-CHK-VOPC.
      *
           IF WSS-EPOC = 'S'
               IF WSS-NEEV = ZEROES
                   MOVE 'OPCFFINFMIN<' TO MSG-COD-MENS
                   GO TO ERR-CHK-VOPC.
      
           IF WSS-ULTIMO-VENC-EN-ZERO
               MOVE 'OPCUVNCZERO=' TO MSG-COD-MENS
               MOVE WSS-NEUV TO FRM-MEN2
               GO TO ERR-CHK-VOPC.
      
           GO TO FIN-CHK-VOPC.
       ERR-CHK-VOPC.
           IF FRM-MEN1 NOT > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-CHK-VOPC.
           EXIT.
      
       EVC-CHK-VOPC SECTION.
       INI-EVC-CHK-VOPC.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-CAI-IOPC IN OPC TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN OPC TO EVC-IIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-EVC-CHK-VOPC.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN OPC AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN OPC )
               GO TO FIN-EVC-CHK-VOPC.
      
           IF WSS-EPOC = 'N'
               GO TO SK2-EVC-CHK-VOPC.
      
           IF ( EVC-VAL-VENC IN EVC > ZEROES ) OR
              ( EVC-MSC-BCCR IN EVC NOT = 'I' )
               IF WSS-FPPC NOT > ZEROES OR
                  WSS-FPPC     > EVC-FEC-FPVC IN EVC
                   IF OPC-IND-AFER IN OPC-FLD = 'N'
                       MOVE EVC-FEC-FPVC IN EVC TO WSS-FPPC
                   ELSE
                       MOVE EVC-NUM-DPVC IN EVC TO FEC-ITM1
                       MOVE EVC-NUM-MPVC IN EVC TO FEC-ITM2
                       MOVE EVC-NUM-SPVC IN EVC TO FEC-ITM3
                       MOVE EVC-NUM-APVC IN EVC TO FEC-ITM4
                       PERFORM ANL-FRDO
                       IF MSG-COD-MENS NOT > SPACES
                           MOVE FEC-ITM1 TO WSS-DPPC
                           MOVE FEC-ITM2 TO WSS-MPPC
                           MOVE FEC-ITM3 TO WSS-SPPC
                           MOVE FEC-ITM4 TO WSS-APPC
                       ELSE
                           GO TO FIN-EVC-CHK-VOPC.
      
           IF WSS-FPPI NOT > ZEROES OR
              WSS-FPPI     > EVC-FEC-FPVC IN EVC
                   IF OPC-IND-AFER IN OPC-FLD = 'N'
                       MOVE EVC-FEC-FPVC IN EVC TO WSS-FPPI
                   ELSE
                       MOVE EVC-NUM-DPVC IN EVC TO FEC-ITM1
                       MOVE EVC-NUM-MPVC IN EVC TO FEC-ITM2
                       MOVE EVC-NUM-SPVC IN EVC TO FEC-ITM3
                       MOVE EVC-NUM-APVC IN EVC TO FEC-ITM4
                       PERFORM ANL-FRDO
                       IF MSG-COD-MENS NOT > SPACES
                           MOVE FEC-ITM1 TO WSS-DPPI
                           MOVE FEC-ITM2 TO WSS-MPPI
                           MOVE FEC-ITM3 TO WSS-SPPI
                           MOVE FEC-ITM4 TO WSS-APPI
                       ELSE
                           GO TO FIN-EVC-CHK-VOPC.
       SK2-EVC-CHK-VOPC.
      
           IF EVC-NUM-VIGU IN EVC NOT > 1
               MOVE EVC-NUM-DPVC IN EVC TO FEC-ITM1
               MOVE EVC-NUM-MPVC IN EVC TO FEC-ITM2
               MOVE EVC-NUM-SPVC IN EVC TO FEC-ITM3
               MOVE EVC-NUM-APVC IN EVC TO FEC-ITM4
               GO TO HBL-EVC-CHK-VOPC.
      
           COMPUTE EVC-NUM-SEVE IN EVC = EVC-NUM-SEVE IN EVC *
                                       ( EVC-NUM-VIGU IN EVC - 1 ).
           IF EVC-IND-UTSV IN EVC = 'D'
               MOVE FEC-SUM-DIA         TO FEC-CMND
               MOVE EVC-NUM-SEVE IN EVC TO FEC-NDIA
           ELSE
           IF EVC-IND-UTSV IN EVC = 'M'
               MOVE FEC-SUM-MES         TO FEC-CMND
               MOVE EVC-NUM-SEVE IN EVC TO FEC-NMES
           ELSE
           IF EVC-IND-UTSV IN EVC = 'A'
               MOVE FEC-SUM-ANO         TO FEC-CMND
               MOVE EVC-NUM-SEVE IN EVC TO FEC-NANO
           ELSE
               MOVE 'EVCUTSVINV' TO MSG-COD-MENS
               GO TO FIN-EVC-CHK-VOPC.
      
           MOVE EVC-NUM-DPVC IN EVC TO FEC-ITM1.
           MOVE EVC-NUM-MPVC IN EVC TO FEC-ITM2.
           MOVE EVC-NUM-SPVC IN EVC TO FEC-ITM3.
           MOVE EVC-NUM-APVC IN EVC TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'CHKVOPCFSUM' TO MSG-COD-MENS
               GO TO FIN-EVC-CHK-VOPC.
      
           MOVE EVC-IND-UTSV IN EVC TO INT-IPER.
           MOVE EVC-NUM-DPVE IN EVC TO CVI-DVEN.
           PERFORM CHK-DIA-VEN.
      *JSS-TRC.
      *     MOVE 'UTSV,'             TO DSP-GLS-MENA.
      *     MOVE 'SEVE : '           TO DSP-GLS-MENB.
      *     MOVE EVC-IND-UTSV IN EVC TO DSP-GLS-MENC.
      *     MOVE EVC-NUM-SEVE IN EVC TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
      *JSS-TRC.
      *     MOVE 'FECHA FINAL ESTRUC (S/FER) :' TO DSP-GLS-MENS.
      *     MOVE FEC-FECH                       TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      
       HBL-EVC-CHK-VOPC.
           IF OPC-IND-AFER IN OPC-FLD = 'N'
               GO TO CON-EVC-CHK-VOPC.
      
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-S  TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM PRO-FEC.
           IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
               MOVE 'CHKVOPCFVHBL' TO MSG-COD-MENS
               GO TO FIN-EVC-CHK-VOPC.
      
           IF NOT FEC-STAT-FER
               GO TO CON-EVC-CHK-VOPC.
      
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SIG-HBL  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'CHKVOPCFSHBL' TO MSG-COD-MENS
               GO TO FIN-EVC-CHK-VOPC.
       CON-EVC-CHK-VOPC.
      
           MOVE FEC-ITM1 TO WSS-DVNC.
           MOVE FEC-ITM2 TO WSS-MVNC.
           MOVE FEC-ITM3 TO WSS-SVNC.
           MOVE FEC-ITM4 TO WSS-AVNC.
      
      *JSS-TRC
      *     MOVE 'FECHA ESTRUCTURA : ' TO DSP-GLS-MEN1.
      *     MOVE WSS-FVNC              TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      
           IF ( WSS-FVNC > WSS-FUVC ) OR ( WSS-FVNC = WSS-FUVC )
               IF WSS-FVNC > WSS-FUVC
                   MOVE WSS-FVNC            TO WSS-FUVC
                   MOVE EVC-NUM-IEVC IN EVC TO WSS-NEUV
                   IF ( EVC-MSC-BCCR IN EVC = 'I' ) AND
                      ( EVC-VAL-VENC IN EVC NOT > ZEROES )
                       MOVE 'Z' TO WSS-IVUV
                   ELSE
                       MOVE 'N' TO WSS-IVUV
               ELSE
               IF WSS-ULTIMO-VENC-EN-ZERO
                   IF ( EVC-MSC-BCCR IN EVC = 'I' ) AND
                      ( EVC-VAL-VENC IN EVC NOT > ZEROES )
                       MOVE 'Z' TO WSS-IVUV
                   ELSE
                       MOVE 'N' TO WSS-IVUV.
      
           IF WSS-EPOC = 'S'
               IF WSS-FVNC > WSS-FMAV
                   MOVE 'OPCFFINFMAX>' TO MSG-COD-MENS
                   GO TO FIN-EVC-CHK-VOPC.
      *DPM ini  19-DEC-1996
           IF OPC-IND-RENO IN OPC = 'PRO'
               ADD 1 TO WSS-NEEV
           ELSE
      *DPM fin  19-DEC-1996
           IF WSS-EPOC = 'S'
               IF WSS-FVNC NOT < WSS-FMIV
                   ADD 1 TO WSS-NEEV.
      
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-EVC-CHK-VOPC.
       FIN-EVC-CHK-VOPC.
           EXIT.
      
       VEN-CHK-VOPC SECTION.
       INI-VEN-CHK-VOPC.
      *HPM ini
      * Busca indicador Opera como
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPCTOOCNEX  '      TO MSG-COD-MENS
               MOVE OPC-COD-TOOC IN OPC TO FRM-MEN2
               GO TO FIN-VEN-CHK-VOPC.
           MOVE 'COL'               TO FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPCOPECNEX  '      TO MSG-COD-MENS
               MOVE TOC-MSC-OPEC IN TOC TO FRM-MEN2
               GO TO FIN-VEN-CHK-VOPC.
           MOVE MSC-CIC-CMSC IN MSC TO WSS-OPEC.
      *HPM fin
           MOVE ZEROES TO WSS-VAL-TVEN.
           MOVE SPACES TO WSS-IND-IVFI.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-CAI-IOPC IN OPC TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN OPC TO VEN-IIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-VEN-CHK-VOPC.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CAI-IOPC IN VEN = OPC-CAI-IOPC IN OPC AND
                    VEN-IIC-IOPC IN VEN = OPC-IIC-IOPC IN OPC )
               IF FIO-CMND = FIO-GET-NLS
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'OPC    NOVEN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO CPT-STR1
                   MOVE MSG-GLS-DATA   TO CPT-STR2
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN       TO FRM-MENS
      
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS
                   GO TO FIN-VEN-CHK-VOPC
               ELSE
                   GO TO UVC-VEN-CHK-VOPC.
      *HPM ini
           IF WSS-OPEC = 'D'
      *Busca DLC asociado a VEN leido
               MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC
               MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF NOT FIO-STAT-OKS
                   MOVE 'DLC    NEX  '      TO MSG-COD-MENS
                   MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
                   GO TO FIN-VEN-CHK-VOPC
               ELSE
      *HPM Se pregunta por distinto de 'R' y 'C' para que sean considera
      *HPM aquellos registros grabados antes de esta modificacion, los q
      *HPM no tienen valor 'A' sino ' '.
                   IF NOT ( DLC-MSC-STAT IN DLC = 'R' OR 'C' )
                       ADD VEN-VAL-FINA IN VEN TO WSS-VAL-TVEN
                   ELSE
                       NEXT SENTENCE
           ELSE
               ADD VEN-VAL-CAPI IN VEN TO WSS-VAL-TVEN
               IF VEN-IND-CALC IN VEN = 'N' AND
                  VEN-VAL-FINA IN VEN > ZEROES
                   MOVE '1' TO WSS-IND-IVFI.
      *HPM fin
           IF WSS-EPOC = 'N'
               GO TO SK2-VEN-CHK-VOPC.
      
           IF VEN-VAL-SCAP IN VEN > ZEROES
               IF WSS-FPPC NOT > ZEROES OR
                  WSS-FPPC     > VEN-FEC-FVEN IN VEN
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-FPPC.
      
           IF WSS-FPPI NOT > ZEROES OR
              WSS-FPPI     > VEN-FEC-FVEN IN VEN
               MOVE VEN-FEC-FVEN IN VEN TO WSS-FPPI.
      
       SK2-VEN-CHK-VOPC.
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FVNC.
      
           IF ( WSS-FVNC > WSS-FUVC ) OR ( WSS-FVNC = WSS-FUVC )
               IF WSS-FVNC > WSS-FUVC
                   MOVE WSS-FVNC            TO WSS-FUVC
                   MOVE VEN-NUM-IVEN IN VEN TO WSS-NEUV
                   IF VEN-VAL-SCAP IN VEN NOT > ZEROES
                       MOVE 'Z' TO WSS-IVUV
                   ELSE
                       MOVE 'N' TO WSS-IVUV
               ELSE
               IF WSS-ULTIMO-VENC-EN-ZERO
                   IF VEN-VAL-SCAP IN VEN NOT > ZEROES
                       MOVE 'Z' TO WSS-IVUV
                   ELSE
                       MOVE 'N' TO WSS-IVUV.
      
           IF WSS-EPOC = 'S'
               IF WSS-FVNC > WSS-FMAV
                   MOVE 'OPCFFINFMAX>' TO MSG-COD-MENS
                   GO TO FIN-VEN-CHK-VOPC.
      
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-VEN-CHK-VOPC.
      
       UVC-VEN-CHK-VOPC.
           IF WSS-IND-IVFI > SPACES
               IF WSS-VAL-TVEN < OPC-VAL-CRED IN OPC-FLD
                   GO TO POC-VEN-CHK-VOPC
               ELSE
                   MOVE 'OPCCRE<=CAPI' TO MSG-COD-MENS
                   MOVE 'COL'          TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE SPACES              TO WSS-MSG-STR
                   MOVE OPC-VAL-CRED IN OPC TO WSS-NUM-FALF
                   MOVE MSG-GLS-DESC IN MSG TO WSS-MSG-GLS-DESC
                   MOVE WSS-VAL-TVEN        TO WSS-NUM-FEDT
                   MOVE MSG-GLS-DATA IN MSG TO WSS-MSG-GLS-DATA
                   MOVE WSS-MSG-STR         TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-MENS
                   GO TO FIN-VEN-CHK-VOPC.
      
           IF WSS-VAL-TVEN NOT = OPC-VAL-CRED IN OPC-FLD
               MOVE 'OPC    TVEN' TO MSG-COD-MENS
               MOVE 'COL'         TO MSG-COD-SIST
               PERFORM GET-MSG
      
               MOVE SPACES              TO WSS-MSG-STR
               MOVE OPC-VAL-CRED IN OPC TO WSS-NUM-FALF
               MOVE MSG-GLS-DESC IN MSG TO WSS-MSG-GLS-DESC
               MOVE WSS-VAL-TVEN        TO WSS-NUM-FEDT
               MOVE MSG-GLS-DATA IN MSG TO WSS-MSG-GLS-DATA
               MOVE WSS-MSG-STR         TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-MENS
               GO TO FIN-VEN-CHK-VOPC.
      *
       POC-VEN-CHK-VOPC.
      *DPM ini  19-DEC-1996
           IF OPC-IND-RENO IN OPC = 'PRO'
               MOVE 1 TO WSS-NEEV
           ELSE
      *DPM fin  19-DEC-1996
           IF WSS-EPOC = 'S'
               IF WSS-FUVC < WSS-FMIV
                   MOVE ZEROES TO WSS-NEEV
               ELSE
                   MOVE 1      TO WSS-NEEV.
       FIN-VEN-CHK-VOPC.
           EXIT.
      
       CHK-FPCI SECTION.
       INI-CHK-FPCI.
           IF WSS-EPOC = 'N'
               GO TO FIN-CHK-FPCI.
      
           IF POC-NUM-MINC IN POC NOT > ZEROES AND
              POC-NUM-MAXC IN POC NOT > ZEROES AND
              POC-NUM-MINI IN POC NOT > ZEROES AND
              POC-NUM-MAXI IN POC NOT > ZEROES
               GO TO FIN-CHK-FPCI.
      
           MOVE ZEROES     TO WSS-FIPC WSS-FIPI.
           MOVE '99999999' TO WSS-FSPC WSS-FSPI.
      
           IF POC-NUM-MINC IN POC > ZEROES
               MOVE POC-IND-MINC IN POC TO WSS-USEP
               MOVE POC-NUM-MINC IN POC TO WSS-VSEP
               PERFORM CAL-FECH
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-CHK-FPCI
               ELSE
                   MOVE FEC-ITM1 TO WSS-DIPC
                   MOVE FEC-ITM2 TO WSS-MIPC
                   MOVE FEC-ITM3 TO WSS-SIPC
                   MOVE FEC-ITM4 TO WSS-AIPC.
      
           IF POC-NUM-MAXC IN POC > ZEROES
               MOVE POC-IND-MAXC IN POC TO WSS-USEP
               MOVE POC-NUM-MAXC IN POC TO WSS-VSEP
               PERFORM CAL-FECH
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-CHK-FPCI
               ELSE
                   MOVE FEC-ITM1 TO WSS-DSPC
                   MOVE FEC-ITM2 TO WSS-MSPC
                   MOVE FEC-ITM3 TO WSS-SSPC
                   MOVE FEC-ITM4 TO WSS-ASPC.
      
           IF POC-NUM-MINI IN POC > ZEROES
               MOVE POC-IND-MINI IN POC TO WSS-USEP
               MOVE POC-NUM-MINI IN POC TO WSS-VSEP
               PERFORM CAL-FECH
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-CHK-FPCI
               ELSE
                   MOVE FEC-ITM1 TO WSS-DIPI
                   MOVE FEC-ITM2 TO WSS-MIPI
                   MOVE FEC-ITM3 TO WSS-SIPI
                   MOVE FEC-ITM4 TO WSS-AIPI.
      
           IF POC-NUM-MAXI IN POC > ZEROES
               MOVE POC-IND-MAXI IN POC TO WSS-USEP
               MOVE POC-NUM-MAXI IN POC TO WSS-VSEP
               PERFORM CAL-FECH
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-CHK-FPCI
               ELSE
                   MOVE FEC-ITM1 TO WSS-DSPI
                   MOVE FEC-ITM2 TO WSS-MSPI
                   MOVE FEC-ITM3 TO WSS-SSPI
                   MOVE FEC-ITM4 TO WSS-ASPI.
      
      *DPM ini  4-MAR-1997
      *     IF WSS-FPPC < WSS-FIPC
           IF OPC-IND-RENO IN OPC NOT = 'PRO' AND
              WSS-FPPC < WSS-FIPC
      *DPM fin  4-MAR-1997
               MOVE 'EVCFPPCMINC<' TO MSG-COD-MENS
               GO TO ERR-CHK-FPCI
           ELSE
           IF WSS-FPPC > WSS-FSPC
               MOVE 'EVCFPPCMAXC>' TO MSG-COD-MENS
               GO TO ERR-CHK-FPCI.
      
      *DPM ini  4-MAR-1997
      *     IF WSS-FPPI < WSS-FIPI
           IF OPC-IND-RENO IN OPC NOT = 'PRO' AND
              WSS-FPPI < WSS-FIPI
      *DPM fin  4-MAR-1997
               MOVE 'EVCFPPIMINI<' TO MSG-COD-MENS
               GO TO ERR-CHK-FPCI
           ELSE
           IF WSS-FPPI > WSS-FSPI
               MOVE 'EVCFPPIMAXI>' TO MSG-COD-MENS
               GO TO ERR-CHK-FPCI.
           GO TO FIN-CHK-FPCI.
       ERR-CHK-FPCI.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-CHK-FPCI.
           EXIT.
      
       CAL-FECH SECTION.
       INI-CAL-FECH.
           MOVE SPACES TO MSG-COD-MENS.
           IF WSS-USEP = 'D'
               MOVE WSS-VSEP    TO FEC-NDIA
               MOVE FEC-SUM-DIA TO FEC-CMND
           ELSE
           IF WSS-USEP = 'M'
               MOVE WSS-VSEP    TO FEC-NMES
               MOVE FEC-SUM-MES TO FEC-CMND
           ELSE
           IF WSS-USEP = 'A'
               MOVE WSS-VSEP    TO FEC-NANO
               MOVE FEC-SUM-ANO TO FEC-CMND
           ELSE
               MOVE 'INDUSEPINV' TO MSG-COD-MENS
               GO TO FIN-CAL-FECH.
      
           MOVE OPC-FEC-FCOL IN OPC-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC            TO FEC-FORM.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'CALFECHFSUM' TO MSG-COD-MENS.
       FIN-CAL-FECH.
           EXIT.
      
       ANL-FRDO SECTION.
       INI-ANL-FRDO.
           MOVE SPACES TO MSG-COD-MENS.
      
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM PRO-FEC.
           IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
               MOVE 'ANLFRDOFVHBL' TO MSG-COD-MENS
               GO TO FIN-ANL-FRDO.
      
           IF FEC-STAT-FER
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-SIG-HBL  TO FEC-CMND
      *        PERFORM PRO-FEC
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   MOVE 'ANLFRDOFSHBL' TO MSG-COD-MENS
                   GO TO FIN-ANL-FRDO.
      
           MOVE SPACES TO MSG-COD-MENS.
       FIN-ANL-FRDO.
           EXIT.
      
       PRO-DLC SECTION.
       INI-PRO-DLC.
           MOVE ZEROES TO WSS-VAL-NDLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC )
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NODLC' TO MSG-COD-MENS
               PERFORM GET-MSG
      
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
      
      *         STRING MSG-GLS-DESC
      *                MSG-GLS-DATA DELIMITED BY SIZE
      *         INTO FRM-MENS
               GO TO FIN-PRO-DLC.
       LUP-INP-DLC.
      *HPM Se pregunta por distinto de 'R' y 'C' para que sean considera
      *HPM aquellos registros grabados antes de esta modificacion, los q
      *HPM no tienen valor 'A' sino ' '.
      *ALD-BCI-INI/18.03.1999
           IF OPC-COD-TOOC IN OPC NOT = 'TCR'
              IF ( DLC-IND-SCTB IN DLC = 'VCD' OR
                   DLC-IND-SCTB IN DLC = 'CAS') AND
                   OPC-IND-RENO IN OPC NOT > SPACES
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    MOVE 'COL' TO MSG-COD-SIST
                    MOVE 'DLCVCDCASREN' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO CPT-STR1
                    MOVE MSG-GLS-DATA TO CPT-STR2
                    PERFORM CPT-BLKS
                    MOVE CPT-STRN     TO FRM-MENS
                    GO TO FIN-PRO-DLC.
           IF OPC-COD-TOOC IN OPC = 'TCR'
               IF DLC-IND-SCTB IN DLC = 'VCD' AND
                  DLC-IND-SCBZ IN DLC NOT > SPACES
                   NEXT SENTENCE
               ELSE
                   IF ( DLC-IND-SCTB IN DLC = 'VCD' OR
                        DLC-IND-SCTB IN DLC = 'CAS') AND
                        OPC-IND-RENO IN OPC NOT > SPACES
                         MOVE FRM-SUAR-MAL TO FRM-SUAR
                         MOVE 'COL' TO MSG-COD-SIST
                         MOVE 'DLCVCDCASREN' TO MSG-COD-MENS
                         PERFORM GET-MSG
                         MOVE MSG-GLS-DESC TO CPT-STR1
                         MOVE MSG-GLS-DATA TO CPT-STR2
                         PERFORM CPT-BLKS
                         MOVE CPT-STRN     TO FRM-MENS
                         GO TO FIN-PRO-DLC.
      *ALD-BCI-FIN/18.03.1999
           IF NOT ( DLC-MSC-STAT IN DLC = 'R' OR 'C' )
               ADD DLC-VAL-NDLC TO WSS-VAL-NDLC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC
               GO TO LUP-INP-DLC.
           IF OPC-VAL-CRED IN OPC NOT = WSS-VAL-NDLC
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALCREDNDLC=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE SPACES TO WSS-MSG-STR
               MOVE OPC-VAL-CRED IN OPC TO WSS-NUM-FALF
               MOVE MSG-GLS-DESC IN MSG TO WSS-MSG-GLS-DESC
               MOVE WSS-VAL-NDLC        TO WSS-NUM-FEDT
               MOVE MSG-GLS-DATA IN MSG TO WSS-MSG-GLS-DATA
               MOVE WSS-MSG-STR TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
      *         STRING WSS-NUM-FALF
      *                MSG-GLS-DESC
      *                WSS-NUM-FEDT
      *                MSG-GLS-DATA DELIMITED BY SIZE
      *         INTO FRM-MENS
               GO TO FIN-PRO-DLC.
       FIN-PRO-DLC.
           EXIT.
      
       PRO-RDC SECTION.
       INI-PRO-RDC.
           MOVE ZEROES TO WSS-NUM-PDIR.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
                    RDC-NUM-IDLC IN RDC = ZEROES )
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
      *         STRING MSG-GLS-DESC
      *                MSG-GLS-DATA DELIMITED BY SIZE
      *         INTO FRM-MENS
               GO TO FIN-PRO-RDC.
      *ALD-BCI-INI/15062000
              MOVE RDC-CIC-ICLI IN RDC TO DCP-CIC-ICLI IN DCP.
              MOVE FIO-GET-KEY TO FIO-CMND.
              PERFORM SGC-FIO-DCP.
              IF FIO-STAT-OKS
                  MOVE 'SGC' TO TAB-COD-SIST FIO-SIST
                  MOVE 'BAN' TO TAB-COD-TTAB IN TAB
                  MOVE DCP-COD-TBAN IN DCP TO TAB-COD-CTAB IN TAB
                  MOVE FIO-GET-KEY TO FIO-CMND
                  PERFORM GNS-FIO-TAB
                  IF FIO-STAT-OKS AND
                     TAB-IND-VIGE IN TAB = 'S'
                      NEXT SENTENCE
                  ELSE
                      MOVE 'COL'          TO MSG-COD-SIST
                      MOVE 'BNCACLINEONV' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO FIN-PRO-RDC
              ELSE
                  MOVE RDC-CIC-ICLI IN RDC TO DCE-CIC-ICLI IN DCE
                  MOVE FIO-GET-KEY TO FIO-CMND
                  PERFORM SGC-FIO-DCE
                  IF FIO-STAT-OKS
                      MOVE 'SGC' TO TAB-COD-SIST FIO-SIST
                      MOVE 'BAN' TO TAB-COD-TTAB IN TAB
                      MOVE DCE-COD-TBAN IN DCE TO TAB-COD-CTAB IN TAB
                      MOVE FIO-GET-KEY TO FIO-CMND
                      PERFORM GNS-FIO-TAB
                      IF FIO-STAT-OKS AND
                         TAB-IND-VIGE IN TAB = 'S'
                          NEXT SENTENCE
                      ELSE
                          MOVE 'COL'          TO MSG-COD-SIST
                          MOVE 'BNCACLINEONV' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS
                          MOVE FRM-SUAR-MAL TO FRM-SUAR
                          GO TO FIN-PRO-RDC.
      *ALD-BCI-FIN/15062000
      * RBG INI 26-DEC-1995
           MOVE RDC-VAL-LIMD IN RDC TO WSS-NUM-PIND.
           MOVE RDC-CIC-ICLI IN RDC TO CLM-CIC-ICLI IN CLM-VARI.
           MOVE RDC-CIC-IOPC IN RDC TO CLM-CIC-IOPC IN CLM-VARI.
      
           MOVE CAN-CAI-IOPC IN OPC-FLD TO CLM-CAI-IROV.
           MOVE CAN-IIC-IOPC IN OPC-FLD TO CLM-IIC-IROV.
      
           PERFORM CLM-CLI-SCTB.
           IF CLM-COD-MENS IN CLM-VARI > SPACES
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE CLM-COD-MENS TO MSG-COD-MENS
               PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS.
               MOVE MSG-GLS-DESC TO FRM-MEN2.
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-PRO-RDC.
           MOVE CLM-CIC-ICLI IN CLM-VARI TO RDC-CIC-ICLI IN RDC.
           MOVE WSS-NUM-PIND             TO RDC-VAL-LIMD IN RDC.
      * RBG FIN 26-DEC-1995
       LUP-INP-RDC.
           MOVE ZEROES              TO WSS-NUM-PIND.
           ADD RDC-VAL-LIMD         TO WSS-NUM-PDIR.
           MOVE RDC-CIC-ICLI IN RDC TO WSS-CIC-ICLI.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE 1                   TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF ( FIO-STAT-OKS AND
                RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC )
      *DAD ini  27-DEC-1993   (Memo.30-11-93 pto.1)
      *         PERFORM VAL-DEU-IND.
               PERFORM VAL-DEU-IND
           ELSE
           IF SCR-IND-MRDC NOT = 'M'
               MOVE 'COL'  TO FIO-SIST
               MOVE 'GARA' TO MSC-CIC-TMSC IN MSC
               MOVE '2'    TO MSC-CIC-CMSC IN MSC
               MOVE 'MSC-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF FIO-STAT-OKS AND
                  OPC-IND-GARA IN OPC = MSC-COD-CMSC IN MSC
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CLIOBLPORPLT' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *DAD fin  27-DEC-1993
      
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-RDC.
      
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LU2-PRO-RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
                    RDC-NUM-IDLC IN RDC = ZEROES )
               GO TO VAL-PRO-RDC.
           IF RDC-CIC-ICLI IN RDC = WSS-CIC-ICLI
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM COL-FIO-RDC
               IF FIO-STAT-OKS AND
                  RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
                  RDC-NUM-IDLC IN RDC = ZEROES
                   GO TO LUP-INP-RDC
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LU2-PRO-RDC.
       VAL-PRO-RDC.
           IF WSS-NUM-PDIR < 100
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMPDIR100<' TO MSG-COD-MENS
               PERFORM GET-MSG
      
               MOVE SPACES TO WSS-MSG-STR
               MOVE MSG-GLS-DESC IN MSG TO WSS-MSG-GLS-DESC
               MOVE WSS-NUM-PDIR TO WSS-NUM-FEDT
               MOVE MSG-GLS-DATA IN MSG TO WSS-MSG-GLS-DATA
               MOVE WSS-MSG-STR TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN         TO FRM-MENS
      *         STRING MSG-GLS-DESC
      *                WSS-NUM-FEDT
      *                MSG-GLS-DATA DELIMITED BY SIZE
      *         INTO FRM-MENS
               GO TO FIN-PRO-RDC.
       FIN-PRO-RDC.
           EXIT.
      
       PRO-EVC SECTION.
       INI-PRO-EVC.
      *     IF OPC-IND-VSTR IN OPC NOT = 'S'
      *        PERFORM GET-FST-EVC
      *        IF MSG-COD-MENS = 'OPC    NOEVC'
      *            GO TO FIN-PRO-EVC
      *        ELSE
      *            MOVE 'COL' TO MSG-COD-SIST
      *            MOVE 'OPC    SIEVC' TO MSG-COD-MENS
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR
      *            PERFORM GET-MSG
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS
      *            GO TO FIN-PRO-EVC.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
                  GO TO FIN-PRO-EVC.
           PERFORM GET-FST-EVC.
           IF MSG-COD-MENS = 'OPC    NOEVC'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS.
      *         STRING MSG-GLS-DESC
      *                MSG-GLS-DATA DELIMITED BY SIZE
      *         INTO FRM-MENS.
       FIN-PRO-EVC.
           EXIT.
      
       GET-FST-EVC SECTION.
       INI-GET-FST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = EVC-CIC-IOPC IN EVC )
               MOVE 'OPC    NOEVC' TO MSG-COD-MENS.
       FIN-GET-FST-EVC.
           EXIT.
      
       PRO-ITR SECTION.
       INI-PRO-ITR.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR.
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR.
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
      ** No se si esta bien
      *     MOVE SPACES TO ITR-KEY-IVCT IN ITR.
      *     MOVE SPACES TO ITR-IND-TTAS IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
      *              ITR-NUM-ICAN IN ITR = ZEROES )
                    ITR-NUM-ICAN IN ITR = ZEROES AND
                    ITR-IND-TTAS IN ITR = 'INT')
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOICG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS.
      *         STRING MSG-GLS-DESC
      *                MSG-GLS-DATA DELIMITED BY SIZE
      *         INTO FRM-MENS.
       FIN-PRO-ITR.
           EXIT.
      
      *JSS 16-MAY-1991 15:32:57 ( para manejo de cuenta corriente )
       PRO-CYA SECTION.
       INI-PRO-CYA.
           MOVE SPACES TO WSS-OPC-CACC.
           MOVE SPACES TO WSS-OPC-LNBT.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-CYA.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CYA-CIC-IOPC IN CYA = OPC-CIC-IOPC IN OPC AND
                    CYA-NUM-ICAN IN CYA = ZEROES )
      *Pregunta para averiguar si existe algun CYA
               IF WSS-OPC-CACC > SPACES
                   GO TO CON-PRO-CYA
               ELSE
                   MOVE 'OPC    NOCYA' TO MSG-COD-MENS
                   GO TO MSG-PRO-CYA.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               MOVE 'TAB'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF FIO-STAT-OKS
                   IF MSC-CIC-CMSC IN MSC = 'CC'
                       IF ( WSS-OPC-CACC > SPACES ) AND
                          ( WSS-OPC-CACC NOT = 'CC' )
                           MOVE 'CANTCYACC=<>' TO MSG-COD-MENS
                           GO TO MSG-PRO-CYA
                       ELSE
                           MOVE MSC-CIC-CMSC IN MSC TO WSS-OPC-CACC
                           IF MSC-COD-DAT1(2) NOT > SPACES
                               MOVE 'MSCTCYACCLB?' TO MSG-COD-MENS
                               MOVE MSC-COD-TABL IN MSC TO FRM-MEN2
                               GO TO MSG-PRO-CYA
                           ELSE
                           IF ( WSS-OPC-LNBT > SPACES      ) AND
                              ( WSS-OPC-LNBT NOT = MSC-COD-DAT1(2) )
                               MOVE 'CANTCYALB=<>' TO MSG-COD-MENS
                               GO TO MSG-PRO-CYA
                           ELSE
                               MOVE MSC-COD-DAT1(2) TO WSS-OPC-LNBT
                   ELSE
                       IF ( WSS-OPC-CACC > SPACES ) AND
                          ( WSS-OPC-CACC = 'CC' )
                           MOVE 'CANTCYACC=<>' TO MSG-COD-MENS
                           GO TO MSG-PRO-CYA
                       ELSE
                           MOVE MSC-CIC-CMSC IN MSC TO WSS-OPC-CACC
               ELSE
                   MOVE 'CYATCYANEX' TO MSG-COD-MENS
                   MOVE CYA-IND-TCYA IN CYA TO FRM-MEN2
                   GO TO MSG-PRO-CYA
           ELSE
               MOVE 'CYATCYABLK' TO MSG-COD-MENS
               MOVE CYA-KEY-ICYA IN CYA TO FRM-MEN2
               GO TO MSG-PRO-CYA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-CYA.
       CON-PRO-CYA.
      *En el caso de prorrogas, renovacion o novacion, valida la consist
      *entre los tipos de cargo de la operacion y cancelaciones
           IF OPC-IND-RENO IN OPC NOT > SPACES
               GO TO FIN-PRO-CYA.
           PERFORM VAL-TCYA-OPC-CAN.
       MSG-PRO-CYA.
           IF MSG-COD-MENS > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-CYA.
       FIN-PRO-CYA.
           EXIT.
      
       VAL-TCYA-OPC-CAN SECTION.
       INI-VAL-TCYA-OPC-CAN.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-KEY-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-VAL-TCYA-OPC-CAN.
      *Lup para obtener todas las cancelaciones asociadas a la misma OPC
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    ROV-CIC-IOPC IN ROV = OPC-CIC-IOPC IN OPC )
               GO TO FIN-VAL-TCYA-OPC-CAN.
      *Leer cancelacion asociada al ROV
           MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               MOVE 'ROV    CANNX' TO MSG-COD-MENS
               GO TO FIN-VAL-TCYA-OPC-CAN.
      *Buscar CYA asociado a la cancelacion ( es suficiente con buscar e
           MOVE SPACES              TO CYA-KEY-ICYA IN CYA.
           MOVE CAN-KEY-ICAN IN CAN TO CYA-KEY-ICAN IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CYA-KEY-ICAN IN CYA = CAN-KEY-ICAN IN CAN )
               GO TO NXT-VAL-TCYA-OPC-CAN.
      *Buscar CIC asociado al TCYA
      *DAD ini  21-JUL-1992
           IF POC-COD-COTO IN POC NOT = 'LAC' AND
      *DAD fin  21-JUL-1992
              CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TAB'               TO FIO-SIST
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF FIO-STAT-OKS AND
                  ( ( MSC-CIC-CMSC IN MSC     = 'CC' AND
                      WSS-OPC-CACC        NOT = 'CC' ) OR
                    ( MSC-CIC-CMSC IN MSC NOT = 'CC' AND
                      WSS-OPC-CACC            = 'CC' ) )
                   MOVE 'OPCCANTCYACC' TO MSG-COD-MENS
                   GO TO FIN-VAL-TCYA-OPC-CAN.
       NXT-VAL-TCYA-OPC-CAN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-VAL-TCYA-OPC-CAN.
       FIN-VAL-TCYA-OPC-CAN.
           EXIT.
      
       PRO-ROV SECTION.
       INI-PRO-ROV.
           IF OPC-IND-RENO IN OPC = SPACES
               GO TO FIN-PRO-ROV.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
      * No se si esta bien
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = ROV-CIC-IOPC IN ROV )
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOROV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS.
      *         STRING MSG-GLS-DESC
      *                MSG-GLS-DATA DELIMITED BY SIZE
      *         INTO FRM-MENS.
       FIN-PRO-ROV.
           EXIT.
      
       PRO-RCO SECTION.
       INI-PRO-RCO.
           MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC.
           MOVE ZEROES              TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           MOVE FIO-STAT TO PGM-STAT-POC.
           IF NOT PGM-STAT-POC-OKS
               GO TO FIN-PRO-RCO.
      
           MOVE ZEROES TO WSS-NUM-COTO.
           MOVE ZEROES TO WSS-NUM-ACTI.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
                    RDC-NUM-IDLC IN RDC = ZEROES )
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         STRING MSG-GLS-DESC
      *                MSG-GLS-DATA DELIMITED BY SIZE
      *         INTO FRM-MENS
               GO TO FIN-PRO-RCO.
      
           IF POC-COD-ACTI IN POC NOT > SPACES
               MOVE 1 TO WSS-NUM-ACTI IN WSS-VARI.
      *DAD ini  21-JUL-1992
           IF POC-COD-COTO IN POC = 'LAC' OR
      *DAD fin  21-JUL-1992
              POC-COD-COTO IN POC NOT > SPACES
               MOVE 1 TO WSS-NUM-COTO IN WSS-VARI.
       LUP-PRO-RCO.
           IF WSS-NUM-ACTI IN WSS-VARI NOT > ZEROES
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               PERFORM VAL-ACTI
               IF MSG-COD-MENS NOT > SPACES
                   MOVE 1 TO WSS-NUM-ACTI IN WSS-VARI.
           MOVE SPACES              TO RCO-KEY-IRCO IN RCO.
           MOVE RDC-CIC-ICLI IN RDC TO RCO-CIC-ICLI IN RCO.
           MOVE FIO-GET-NLS TO FIO-CMND.
       NXT-PRO-RCO.
           IF WSS-NUM-COTO IN WSS-VARI > ZEROES
               GO TO NXT-RDC-PRO-RCO.
           PERFORM SGC-FIO-RCO.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-ICLI IN RDC = RCO-CIC-ICLI IN RCO )
               GO TO NXT-RDC-PRO-RCO.
           PERFORM VAL-COTO.
           IF NOT ( MSG-COD-MENS > SPACES OR
                    RCO-MSC-STAT IN RCO = 'D' OR
                    RCO-MSC-STAT IN RCO = 'E' OR
                    RCO-COD-STAT IN RCO = 'ELI' )
               MOVE 1 TO WSS-NUM-COTO IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND
           GO TO NXT-PRO-RCO.
       NXT-RDC-PRO-RCO.
           IF WSS-NUM-ACTI IN WSS-VARI > ZEROES AND
              WSS-NUM-COTO IN WSS-VARI > ZEROES
               GO TO FIN-PRO-RCO.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
              RDC-NUM-IDLC IN RDC = ZEROES
               GO TO LUP-PRO-RCO.
           IF WSS-NUM-ACTI NOT > ZEROES
               MOVE 'COL'           TO MSG-COD-SIST
               MOVE 'CODACTISNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-COD-ACTI TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-RCO.
           IF WSS-NUM-COTO NOT > ZEROES
               MOVE 'COL'           TO MSG-COD-SIST
               MOVE 'CODCOTOSNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-COD-COTO TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-RCO.
       FIN-PRO-RCO.
           EXIT.
      
       SUM-EVC SECTION.
       INI-SUM-EVC.
           MOVE SPACES TO INT-CMSG.
      
      *JSS-TRC.
      *     MOVE 'INI-SUM-EVC' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
      
           MOVE ZEROES TO OPC-NUM-VCVG IN OPC.
           MOVE ZEROES TO WSS-VAL-TEVC.
           MOVE ZEROES TO WSS-VAL-TCAP.
      
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-SUM-EVC.
      
      *JSS-TRC.
      *     MOVE 'LUP-SUM-EVC' TO DSP-GLS-MEN1.
      *     MOVE WSS-VAL-TEVC      TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
      
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = EVC-CIC-IOPC IN EVC )
               GO TO DIF-SUM-EVC.
      
      *Busca el CIC de EVC-MSC-TCVE en TAB CVC ( en sist COL )
           MOVE 'COL' TO TAB-COD-SIST FIO-SIST.
           MOVE 'CVC' TO TAB-COD-TTAB IN TAB.
           MOVE EVC-MSC-TCVE IN EVC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CICTCVENEX' TO INT-CMSG
               MOVE TAB-COD-TABL TO FRM-MEN2
               GO TO FIN-SUM-EVC.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-MSC-TCVE IN WSS-VARI.
      
           IF EVC-VAL-VENC IN EVC > ZEROES
               IF WSS-MSC-TCVE IN WSS-VARI = 'CI' OR 'IO' OR 'IN'
                   MULTIPLY EVC-NUM-VIGU IN EVC BY EVC-VAL-VENC IN EVC
                     GIVING WSS-VAL-TCAP
                   ADD WSS-VAL-TCAP TO WSS-VAL-TEVC
      *JSS-TRC.
      *             MOVE WSS-MSC-TCVE TO DSP-GLS-MEN1
      *             MOVE WSS-VAL-TCAP TO DSP-SV1-13V4
      *             PERFORM GNS-DSP-MENS
               ELSE
               IF WSS-MSC-TCVE IN WSS-VARI = 'CE' OR 'FE'
                   ADD EVC-VAL-VENC IN EVC TO WSS-VAL-TEVC
      *JSS-TRC.
      *             MOVE WSS-MSC-TCVE        TO DSP-GLS-MEN1
      *             MOVE EVC-VAL-VENC IN EVC TO DSP-SV1-13V4
      *             PERFORM GNS-DSP-MENS
               ELSE
               IF WSS-MSC-TCVE IN WSS-VARI = 'IF'
      *JSS         PERFORM CHK-SUM-EIF
                   IF INT-CMSG > SPACES
                       GO TO FIN-SUM-EVC.
      
      *JSS IF WSS-MSC-TCVE IN WSS-VARI = 'CO'
      *        ADD EVC-NUM-VIGU IN EVC TO WSS-NUM-VCVG.
      
      *    IF WSS-MSC-TCVE IN WSS-VARI = 'FO'
      *JSS-TRC.
      *             MOVE 'CASO FO CON LLAVE : ' TO DSP-GLS-MEN1
      *             MOVE EVC-KEY-IEVC IN EVC    TO DSP-GLS-MEN2
      *             PERFORM GNS-DSP-MENS.
      
           ADD EVC-NUM-VIGU IN EVC TO OPC-NUM-VCVG IN OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-SUM-EVC.
      
       DIF-SUM-EVC.
      *JSS-TRC.
      *     MOVE 'OPC-VAL-CRED'      TO DSP-GLS-MEN1.
      *     MOVE OPC-VAL-CRED IN OPC TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
      *JSS-TRC.
      *     MOVE 'WSS-VAL-TEVC' TO DSP-GLS-MEN1.
      *     MOVE WSS-VAL-TEVC   TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
      
           IF WSS-VAL-TEVC > OPC-VAL-CRED IN OPC
               MOVE 'EVCSUMAOPC>' TO INT-CMSG
               MOVE WSS-VAL-TEVC  TO WSS-NUM-FEDT
               MOVE WSS-NUM-FEDT  TO FRM-MEN2
               GO TO FIN-SUM-EVC.
      *
       CON-SUM-EVC.
           IF NOT PGM-STAT-POC-OKS
               GO TO FIN-SUM-EVC.
      
      *DPM ini  10-OCT-1996
           IF OPC-IND-RENO IN OPC = 'PRO'
              IF ( POC-NUM-VMAX IN POC NOT > ZEROES OR
                   POC-NUM-VMAX IN POC NOT < OPC-NUM-VCVG IN OPC )
                 GO TO FIN-SUM-EVC
              ELSE
                 NEXT SENTENCE
           ELSE
      *DPM fin  10-OCT-1996
           IF ( POC-NUM-VMIN IN POC NOT > ZEROES OR
                POC-NUM-VMIN IN POC NOT > OPC-NUM-VCVG IN OPC ) AND
              ( POC-NUM-VMAX IN POC NOT > ZEROES OR
                POC-NUM-VMAX IN POC NOT < OPC-NUM-VCVG IN OPC )
                 GO TO FIN-SUM-EVC.
           MOVE 'NUMVCVGNORNG' TO INT-CMSG.
           MOVE POC-NUM-VMIN IN POC     TO WSS-NUM-VAL1-EDT IN WSS-VARI.
           MOVE SPACES                  TO WSS-IND-DMA1     IN WSS-VARI.
           MOVE '-'                     TO WSS-GLS-GUI2     IN WSS-VARI.
           MOVE POC-NUM-VMAX IN POC     TO WSS-NUM-VAL2-EDT IN WSS-VARI.
           MOVE SPACES                  TO WSS-IND-DMA2     IN WSS-VARI.
           MOVE WSS-MEN2 IN WSS-VARI    TO FRM-MEN2.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      
       FIN-SUM-EVC.
           IF INT-CMSG > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE INT-CMSG TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       EXT-SUM-EVC.
           EXIT.
      
       ULT-VEN SECTION.
       INI-ULT-VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE 999 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
               MOVE ZEROES TO VEN-NUM-IVEN IN VEN.
           MOVE VEN-NUM-IVEN IN VEN TO OPC-NUM-VCVG IN OPC.
      *     IF FIO-STAT-OKS AND
      *        OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN
      *         IF VEN-VAL-SFIN IN VEN NOT > ZEROES
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
      *             MOVE 'COL' TO MSG-COD-SIST
      *             MOVE 'VALSFINULTZ' TO MSG-COD-MENS
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-ULT-VEN.
           EXIT.
      
       VAL-DEU-IND SECTION.
       INI-VAL-DEU-IND.
           IF RDC-CIC-ICLI = WSS-CIC-ICLI
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CICICLIICLI=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
      *         STRING MSG-GLS-DESC
      *                MSG-GLS-DATA DELIMITED BY SIZE
      *         INTO FRM-MENS
               GO TO FIN-VAL-DEU-IND.
           ADD RDC-VAL-LIMD TO WSS-NUM-PIND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC
                 GO TO INI-VAL-DEU-IND.
       FIN-VAL-DEU-IND.
           EXIT.
      
       VAL-ACTI SECTION.
       INI-VAL-ACTI.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE SPACES TO WSS-COD-DIGT.
           IF POC-COD-ACTI IN POC > SPACES
               MOVE POC-COD-ACTI IN POC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 9 TO NUM-NENT
               MOVE 0 TO NUM-NDCM
      *         CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI
               PERFORM VAL-NUM
               IF NUM-STAT-OKS
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE 'ACT' TO TAB-COD-TTAB IN TAB
                   MOVE POC-COD-ACTI IN POC TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS > SPACES
                       MOVE NUM-NN9N TO WSS-NUM-DIGT
                       MOVE WSS-NUM-DIGT TO WSS-COD-DIGT
                   ELSE
                   IF POC-COD-ACTI IN POC NOT = DBC-COD-ACTI IN DBC
                       MOVE 'CODACTINOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-ACTI
                   ELSE
                       NEXT SENTENCE
               ELSE
                   IF POC-COD-ACTI IN POC NOT = DBC-COD-ACTI IN DBC
                       MOVE 'CODACTINOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-ACTI.
           IF WSS-COD-DIGT NOT > SPACES
               GO TO FIN-VAL-ACTI.
           MOVE 'TAB' TO TAB-COD-SIST
           MOVE 'ACT' TO TAB-COD-TTAB IN TAB
           MOVE DBC-COD-ACTI IN DBC TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           PERFORM BUS-FAM VARYING WSS-I FROM 1 BY 1 UNTIL WSS-I > 10 OR
                           WSS-COD-DIGT = TAB-COD-DAT2 (WSS-I).
           IF WSS-I > 10
               MOVE 'CODACTINEFAM' TO MSG-COD-MENS
               GO TO FIN-VAL-ACTI.
       FIN-VAL-ACTI.
           EXIT.
      
       VAL-COTO SECTION.
       INI-VAL-COTO.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE SPACES TO WSS-COD-DIGT.
           IF POC-COD-COTO IN POC > SPACES
               MOVE POC-COD-COTO IN POC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 3 TO NUM-NENT
               MOVE 0 TO NUM-NDCM
      *         CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI
               PERFORM VAL-NUM
               IF NUM-STAT-OKS
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE 'TIO' TO TAB-COD-TTAB IN TAB
                   MOVE POC-COD-COTO IN POC TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS > SPACES
                       MOVE NUM-NN9N TO WSS-NUM-DIGT
                       MOVE WSS-NUM-DIGT TO WSS-COD-DIGT
                   ELSE
                   IF RCO-COD-TOPR IN RCO NOT = POC-COD-COTO IN POC
                       MOVE 'CODCOTONOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-COTO
                   ELSE
                       NEXT SENTENCE
               ELSE
                   IF RCO-COD-TOPR IN RCO NOT = POC-COD-COTO IN POC
                       MOVE 'CODCOTONOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-COTO.
           IF WSS-COD-DIGT NOT > SPACES
               GO TO FIN-VAL-COTO.
           MOVE 'TAB' TO TAB-COD-SIST
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB
           MOVE RCO-COD-TOPR IN RCO TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           PERFORM BUS-FAM VARYING WSS-I FROM 1 BY 1 UNTIL WSS-I > 10 OR
                           WSS-COD-DIGT = TAB-COD-DAT2 (WSS-I).
           IF WSS-I > 10
               MOVE 'CODCOTONEFAM' TO MSG-COD-MENS
               GO TO FIN-VAL-COTO.
       FIN-VAL-COTO.
           EXIT.
      
       BUS-FAM SECTION.
       INI-BUS-FAM.
       FIN-BUS-FAM.
           EXIT.
      
      *ISP/ 23-JAN-1990
      * RECUPERACION DE LA(S) CANCELACION(ES) ASOCIADAS A LA OPERACION
       GET-ROV-NOV SECTION.
       INI-GET-ROV-NOV.
      * RECUPERA CANCELACION(NOV)  ASOCIADA A OPERACION
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE LOW-VALUES          TO ROV-KEY-IVCT IN ROV.
           MOVE '23' TO PGM-STAT-CAN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-GET-ROV-NOV.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               MOVE FIO-STAT TO PGM-STAT-ROV
               GO TO FIN-GET-ROV-NOV.
      
           IF OPC-CIC-IOPC IN OPC NOT = ROV-CIC-IOPC IN ROV
               GO TO FIN-GET-ROV-NOV.
      
           IF ROV-IIC-IOPV IN ROV > ZEROES AND
              ROV-NUM-IVCT IN ROV > ZEROES
      
                MOVE FIO-STAT TO PGM-STAT-ROV
                MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM COL-FIO-CAN
                MOVE FIO-STAT TO PGM-STAT-CAN
           ELSE
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO CIC-GET-ROV-NOV.
       FIN-GET-ROV-NOV.
           EXIT.
      
       GET-ROV-REN SECTION.
       INI-GET-ROV-REN.
      * RECUPERA CANCELACIONES (REN)  ASOCIADAS A OPERACION
      *    DEJA EN ZERO EN TOTAL DE CANCELACIONES QUE RENUEVAN LA OPERAC
           MOVE ZEROES TO WSS-TOT-RCAN.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE LOW-VALUES          TO ROV-KEY-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * ASUME QUE NO ENCONTRARA ROV'S
           MOVE '23' TO PGM-STAT-ROV.
       CIC-GET-ROV-REN.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               GO TO VRF-RCAN.
      
           IF OPC-CIC-IOPC IN OPC NOT = ROV-CIC-IOPC IN ROV
               GO TO VRF-RCAN.
      
           IF NOT ( ROV-IIC-IOPV IN ROV > ZEROES AND
                    ROV-NUM-IVCT IN ROV > ZEROES )
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO CIC-GET-ROV-REN
           ELSE
                MOVE FIO-STAT TO PGM-STAT-ROV
                MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM COL-FIO-CAN
                IF FIO-STAT-OKS AND
      *JSS 15-MAY-1991 20:41:00 ( agregado OR 'P' para manejo de cc )
                   ( CAN-MSC-STAT IN CAN = 'C' OR 'W' OR 'P' ) OR
      *            ( OPC-MSC-STAT IN OPC = 'A' AND
                   ( OPC-ACTIVADA              AND
                     CAN-MSC-STAT IN CAN = 'A' )
                       MOVE CAN-KEY-ICAN TO RCAN-CAN-KEY-ICAN
                       ADD 1 TO WSS-TOT-RCAN
      *                 ADD ROV-SGV-RENO IN ROV TO WSS-SGV-RENO
                       ADD CAN-SGV-TREN IN CAN TO WSS-SGV-RENO
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO CIC-GET-ROV-REN.
       VRF-RCAN.
      * EN INGRESO VERIFICO QUE EXISTIERA AL MENOS UNA CANCELACION
      * CON STATUS 'C' OR 'W'
           IF WSS-TOT-RCAN = ZEROES
               GO TO FIN-GET-ROV-REN.
      
      *    RECUPERA ULTIMA CANCELACION CON STATUS 'C' O 'W'
           MOVE RCAN-CAN-KEY-ICAN TO CAN-KEY-ICAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE FIO-STAT TO PGM-STAT-CAN.
       FIN-GET-ROV-REN.
           EXIT.
      
      ***************************************************
      *INI-JGM
       CALC-SEG-SEGDES SECTION.
       INI-CALC-SEG-SEGDES.
           MOVE ZEROES     TO WSS-NUM-IDLC IN WSS-VARI.
           MOVE 'D'        TO WSS-IND-SEGU IN WSS-VARI.
           MOVE 'D'        TO WSS-IND-CLID IN WSS-VARI.
           MOVE ZEROES     TO WSS-VAL-SEGD IN WSS-VARI.
      *
           PERFORM BUS-MONEDA-NAC.
      *
           PERFORM BUS-CLIE-FEC-NAC.
           IF MSG-COD-MENS IN MSG > SPACES
              IF MSG-COD-MENS IN MSG = '50000000'
                 MOVE ZEROES TO  OPC-VAL-SEGD IN OPC-FLD
                 MOVE SPACES  TO MSG-COD-MENS IN MSG
                 GO TO FIN-CALC-SEG-SEGDES
              ELSE
                 GO TO FIN-CALC-SEG-SEGDES.
      *
      *Busca MIN y Max SEGDES Deudor Directo.
           MOVE 'COL'        TO WSS-IND-SIST IN WSS-VARI.
           MOVE 'SDG'        TO WSS-IND-TTAB IN WSS-VARI.
           MOVE 'SEGDES'     TO WSS-IND-CTAB IN WSS-VARI.
           MOVE 'CODSEGDNEX' TO WSS-IND-MENS IN WSS-VARI.
           PERFORM BUS-MINMAX-SEGURO.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO FIN-CALC-SEG-SEGDES.
      
           IF WSS-AGNO-NUM-MINMAX IN WSS-VARI NOT NUMERIC
              MOVE 'SEGDESNONUM' TO MSG-COD-MENS
              GO TO FIN-CALC-SEG-SEGDES.
      
      * Si cliente tiene mas de 69 anos a FCOL no cobrar seguro
           PERFORM BUS-CLIE-EDAD1.
           IF MSG-COD-MENS IN MSG > SPACES
              IF MSG-COD-MENS IN MSG = '>MINAGNO'
                 MOVE ZEROES TO  OPC-VAL-SEGD IN OPC-FLD
                 MOVE SPACES  TO MSG-COD-MENS IN MSG
                 GO TO FIN-CALC-SEG-SEGDES
              ELSE
                 GO TO FIN-CALC-SEG-SEGDES.
      
      * Si cliente tiene hoy mas de 75 anos no cobrar seguro
           IF DCP-FEC-FNAC IN DCP NOT > ZEROES
               MOVE WSS-FEC-FMAV IN WSS-VARI TO WSS-FMIN IN WSS-VARI
               GO TO NXT-CALC-SEG-SEGDES-DD.
      
           PERFORM BUS-CLIE-EDAD2.
           IF MSG-COD-MENS IN MSG > SPACES
              IF  MSG-COD-MENS IN MSG = '>FECFCOL'
                  MOVE ZEROES  TO  OPC-VAL-SEGD IN OPC-FLD
                  MOVE SPACES  TO MSG-COD-MENS IN MSG
                  GO TO FIN-CALC-SEG-SEGDES
               ELSE
                  GO TO FIN-CALC-SEG-SEGDES.
      
      * Calcular MIN(wss-fec-fmav y wss-fec-fec2)
           PERFORM CALC-MIN-FEC.
      
       NXT-CALC-SEG-SEGDES-DD.
           PERFORM OBT-DIFE-MESES.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE ZEROES  TO OPC-VAL-SEGD IN OPC-FLD
              MOVE SPACES  TO MSG-COD-MENS IN MSG
              GO TO FIN-CALC-SEG-SEGDES.
      
       BUS-SGT-TRAMO-DD.
           MOVE 'COL'       TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDV'       TO TAB-COD-TTAB IN TAB.
           MOVE WSS-NUM-DMES IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODSEGDNEX' TO MSG-COD-MENS
               MOVE WSS-NUM-DMES IN WSS-VARI TO FRM-MEN2
               GO TO MSG-LIQ-ROPC.
      
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.
           IF TAB-IND-VIGE IN TAB NOT = 'S' AND
              TAB-CIC-CTAB IN TAB NOT = '999'
               MOVE TAB-CIC-CTAB IN TAB TO WSS-GLS-DMES IN WSS-VARI
               ADD 1   TO WSS-NUM-DMES IN WSS-VARI
               GO TO BUS-SGT-TRAMO-DD.
      
           IF TAB-IND-VIGE IN TAB NOT = 'S'
               MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
               MOVE 'TMOSDVNVIG' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-SEGDES.
      
           PERFORM  CAL-FINAL-SEGD .
           MOVE WSS-VAL-SEGD IN WSS-VARI TO
                                OPC-VAL-SEGD IN OPC-FLD.
       FIN-CALC-SEG-SEGDES-DD.
           IF OPC-VAL-SEGD IN OPC-FLD = ZEROES
              GO TO FIN-CALC-SEG-SEGDES-DI.
      *
       INI-CALC-SEG-SEGDES-DI.
           MOVE 'D'        TO WSS-IND-SEGU IN WSS-VARI.
           MOVE 'I'        TO WSS-IND-CLID IN WSS-VARI.
           MOVE ZEROES     TO WSS-VAL-SEGD IN WSS-VARI.
           MOVE 1          TO WSS-NUM-IDLC IN WSS-VARI.
      *
      *
           PERFORM BUS-CLIE-FEC-NAC.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE SPACES  TO MSG-COD-MENS  IN MSG
              GO TO FIN-CALC-SEG-SEGDES-DI.
      *
      *Busca MIN y Max SEGDES Deudor Directo.
           MOVE 'COL'        TO WSS-IND-SIST IN WSS-VARI.
           MOVE 'SDG'        TO WSS-IND-TTAB IN WSS-VARI.
           MOVE 'SEGDES'     TO WSS-IND-CTAB IN WSS-VARI.
           MOVE 'CODSEGDNEX' TO WSS-IND-MENS IN WSS-VARI.
           PERFORM BUS-MINMAX-SEGURO.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO FIN-CALC-SEG-SEGDES-DI.
      *
      *BUSCA MIN Y MAX SEGDES DEUDOR INDIRECTO(*)
           IF WSS-AGNO-NUM-MINMAX-I IN WSS-VARI NOT NUMERIC
              MOVE 'SEGDESNONUDI' TO MSG-COD-MENS
              GO TO FIN-CALC-SEG-SEGDES-DI.
      
      * Si cliente tiene mas de 69 anos a FCOL no cobrar seguro
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM BUS-CLIE-EDAD1.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE SPACES  TO MSG-COD-MENS IN MSG
              GO TO FIN-CALC-SEG-SEGDES-DI.
      
      * Si cliente tiene hoy mas de 75 anos no cobrar seguro
           IF DCP-FEC-FNAC IN DCP NOT > ZEROES
               MOVE WSS-FEC-FMAV IN WSS-VARI TO WSS-FMIN IN WSS-VARI
               GO TO NXT-CALC-SEG-SEGDES-DI.
      
           PERFORM BUS-CLIE-EDAD2.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE SPACES  TO MSG-COD-MENS IN MSG
              GO TO FIN-CALC-SEG-SEGDES-DI.
      
      * Calcular MIN(wss-fec-fmav y wss-fec-fec2)
           PERFORM CALC-MIN-FEC.
      
       NXT-CALC-SEG-SEGDES-DI.
           PERFORM OBT-DIFE-MESES.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE SPACES  TO MSG-COD-MENS IN MSG
              GO TO FIN-CALC-SEG-SEGDES-DI.
      
       BUS-SGT-TRAMO-DI.
           MOVE 'COL' TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDV' TO TAB-COD-TTAB IN TAB.
           MOVE WSS-NUM-DMES IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODSEGDNEX' TO MSG-COD-MENS
               MOVE WSS-NUM-DMES IN WSS-VARI TO FRM-MEN2
               GO TO MSG-LIQ-ROPC.
      
           MOVE TAB-GLS-DAT3 IN TAB TO WSS-GLS-DATA-I IN WSS-VARI.
      
           IF TAB-IND-VIGE IN TAB NOT = 'S' AND
              TAB-CIC-CTAB IN TAB NOT = '999'
               MOVE TAB-CIC-CTAB IN TAB TO WSS-GLS-DMES IN WSS-VARI
               ADD 1 TO WSS-NUM-DMES IN WSS-VARI
               GO TO BUS-SGT-TRAMO-DI.
      
           IF TAB-IND-VIGE IN TAB NOT = 'S'
               MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
               MOVE 'TMOSDVNVIG' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-SEGDES-DI.
      
           MOVE WSS-VAL-NCLI-I IN WSS-VARI TO WSS-VAL-NCLI IN WSS-VARI.
           MOVE WSS-VAL-CLIE-I IN WSS-VARI TO WSS-VAL-CLIE IN WSS-VARI.
           PERFORM  CAL-FINAL-SEGD .
           COMPUTE
           OPC-VAL-SEGD IN OPC-FLD = WSS-VAL-SEGD IN WSS-VARI +
                                     OPC-VAL-SEGD IN OPC-FLD.
       FIN-CALC-SEG-SEGDES-DI.
       FIN-CALC-SEG-SEGDES.
           EXIT.
      *INI-JGM
       CALC-SEG-CNAVAL SECTION.
       INI-CALC-SEG-CNAVAL.
           MOVE 'D'        TO WSS-IND-SEGU IN WSS-VARI.
           MOVE 'I'        TO WSS-IND-CLID IN WSS-VARI.
           MOVE 1          TO WSS-NUM-IDLC IN WSS-VARI.
           MOVE ZEROES     TO WSS-VAL-SEGD IN WSS-VARI.
           MOVE ZEROES     TO OPC-VAL-SEGD IN OPC-FLD.
           MOVE ZEROES     TO OPC-VAL-SEGC IN OPC-FLD.
      *
           PERFORM BUS-MONEDA-NAC.
      *
           PERFORM BUS-CLIE-FEC-NAC.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO FIN-CALC-SEG-CNAVAL.
      *
      *BUSCA MIN Y MAX  DEUDOR DIRECTO.
           MOVE 'COL'        TO WSS-IND-SIST IN WSS-VARI.
           MOVE 'SDG'        TO WSS-IND-TTAB IN WSS-VARI.
           MOVE 'CNAVAL'     TO WSS-IND-CTAB IN WSS-VARI.
           MOVE 'CCNAVALNEX' TO WSS-IND-MENS IN WSS-VARI.
           PERFORM BUS-MINMAX-SEGURO.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO FIN-CALC-SEG-CNAVAL.
      *
      *BUSCA MIN Y MAX SEGDES DEUDOR INDIRECTO(*)
           IF WSS-AGNO-NUM-MINMAX-I IN WSS-VARI NOT NUMERIC
              MOVE 'SEGDESNONUDI' TO MSG-COD-MENS
              GO TO FIN-CALC-SEG-CNAVAL.
      
      * Si cliente tiene mas de 69 anos a FCOL no cobrar seguro
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM BUS-CLIE-EDAD1.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE SPACES  TO MSG-COD-MENS IN MSG
              GO TO FIN-CALC-SEG-CNAVAL.
      
      * Si cliente tiene hoy mas de 75 anos no cobrar seguro
           IF DCP-FEC-FNAC IN DCP NOT > ZEROES
               MOVE WSS-FEC-FMAV IN WSS-VARI TO WSS-FMIN IN WSS-VARI
               GO TO NXT-CALC-SEG-CNAVAL.
      
           PERFORM BUS-CLIE-EDAD2.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE SPACES  TO MSG-COD-MENS IN MSG
              GO TO FIN-CALC-SEG-CNAVAL.
      
      * Calcular MIN(wss-fec-fmav y wss-fec-fec2)
           PERFORM CALC-MIN-FEC.
      
       NXT-CALC-SEG-CNAVAL.
           PERFORM OBT-DIFE-MESES.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE SPACES  TO MSG-COD-MENS IN MSG
              GO TO FIN-CALC-SEG-CNAVAL.
      
       BUS-SGT-TRAMO-CNAVAL.
           MOVE 'COL' TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDV' TO TAB-COD-TTAB IN TAB.
           MOVE WSS-NUM-DMES IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODAVALNEX'             TO MSG-COD-MENS
               MOVE WSS-NUM-DMES IN WSS-VARI TO FRM-MEN2
              GO TO FIN-CALC-SEG-CNAVAL.
      
           MOVE TAB-GLS-DAT3 IN TAB TO WSS-GLS-DATA-I IN WSS-VARI.
      
           IF TAB-IND-VIGE IN TAB NOT = 'S' AND
              TAB-CIC-CTAB IN TAB NOT = '999'
               MOVE TAB-CIC-CTAB IN TAB TO WSS-GLS-DMES IN WSS-VARI
               ADD 1 TO WSS-NUM-DMES IN WSS-VARI
               GO TO BUS-SGT-TRAMO-CNAVAL.
      
           IF TAB-IND-VIGE IN TAB NOT = 'S'
               MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
               MOVE 'TMOSDVNVIG' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-CNAVAL.
      
           MOVE WSS-VAL-NCLI-I IN WSS-VARI TO WSS-VAL-NCLI IN WSS-VARI.
           MOVE WSS-VAL-CLIE-I IN WSS-VARI TO WSS-VAL-CLIE IN WSS-VARI.
           PERFORM  CAL-FINAL-SEGD .
           MOVE WSS-VAL-SEGD IN WSS-VARI TO OPC-VAL-SEGD IN OPC-FLD.
       FIN-CALC-SEG-CNAVAL.
           EXIT.
      ******************************************************************
       BUS-MONEDA-NAC SECTION.
       INI-BUS-MONEDA-NAC.
      *Si es moneda Nacional transformar a Pesos
           MOVE 'TVAL'         TO MSC-CIC-TMSC IN MSC.
           MOVE '0'            TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
              MOVE SPACES      TO MSC-COD-CMSC IN MSC.
      
           IF OPC-MSC-TVOC IN OPC-FLD NOT = MSC-COD-CMSC IN MSC
               MOVE ZEROES     TO WSS-VAL-SCRE IN WSS-VARI
               GO TO  BUS-MONEDA-NACS.
      
           MOVE OPC-COD-VCOC IN OPC-FLD TO TAB-COD-CTAB IN TAB
           MOVE '0999  '                TO TAB-CIC-CTAB IN TAB
           MOVE OPC-NUM-DCOL IN OPC-FLD TO TAB-NUM-DTRN IN TAB
           MOVE OPC-NUM-MCOL IN OPC-FLD TO TAB-NUM-MTRN IN TAB
           MOVE OPC-NUM-SCOL IN OPC-FLD TO TAB-NUM-STRN IN TAB
           MOVE OPC-NUM-ACOL IN OPC-FLD TO TAB-NUM-ATRN IN TAB
           PERFORM GET-VCAM
           IF MSG-COD-MENS IN MSG NOT > SPACES
               MULTIPLY CAM-SGV-VCAM IN CAM BY
                        OPC-VAL-SCRE IN OPC-FLD GIVING
                        WSS-VAL-SCRE IN WSS-VARI
           ELSE
               IF MSG-COD-MENS IN MSG = 'CODVCAMEQL'
                  MOVE 1      TO CAM-SGV-VCAM IN CAM
                  MOVE SPACES TO MSG-COD-MENS IN MSG
                  MOVE OPC-VAL-SCRE IN OPC-FLD TO WSS-VAL-SCRE
                                                        IN WSS-VARI
                ELSE
                  GO TO FIN-BUS-MONEDA-NAC.
      
       BUS-MONEDA-NACS.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-NUM-DCOL IN OPC-FLD TO WSS-NUM-DCOL IN WSS-VARI.
           MOVE OPC-NUM-MCOL IN OPC-FLD TO WSS-NUM-MCOL IN WSS-VARI.
           MOVE OPC-NUM-SCOL IN OPC-FLD TO WSS-NUM-SCOL IN WSS-VARI.
           MOVE OPC-NUM-ACOL IN OPC-FLD TO WSS-NUM-ACOL IN WSS-VARI.
       FIN-BUS-MONEDA-NAC.
           EXIT.
      
       BUS-MINMAX-SEGURO SECTION.
       INI-BUS-MINMAX-SEGURO.
           MOVE WSS-IND-SIST IN WSS-VARI TO TAB-COD-SIST FIO-SIST.
           MOVE WSS-IND-TTAB IN WSS-VARI TO TAB-COD-TTAB IN TAB.
           MOVE WSS-IND-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE WSS-IND-MENS IN WSS-VARI TO MSG-COD-MENS
               GO TO FIN-BUS-MINMAX-SEGURO.
      
           MOVE TAB-GLS-DAT2 IN TAB TO
                                WSS-GLS-DAT2-MINMAX IN WSS-VARI.
           MOVE TAB-GLS-DAT2 IN TAB TO
                                WSS-GLS-DAT2-MINMAX-ID IN WSS-VARI.
           MOVE TAB-GLS-DAT3 IN TAB TO
                                 WSS-GLS-DAT3-MINMAX-I IN WSS-VARI.
       FIN-BUS-MINMAX-SEGURO.
           EXIT.
      
       BUS-CLIE-EDAD1 SECTION.
       INI-BUS-CLIE-EDAD1.
      * Si cliente tiene mas de 69 anos a FCOL no cobrar seguro
           MOVE 'SPACES' TO MSG-COD-MENS IN MSG.
           IF DCP-FEC-FNAC IN DCP NOT > ZEROES
               MOVE '>MINAGNO' TO MSG-COD-MENS IN MSG
               GO TO FIN-BUS-CLIE-EDAD1.
      
            MOVE DCP-NUM-DNAC IN DCP      TO FEC-DEC1.
            MOVE DCP-NUM-MNAC IN DCP      TO FEC-MEC1.
            MOVE DCP-NUM-SNAC IN DCP      TO FEC-SEC1.
            MOVE DCP-NUM-ANAC IN DCP      TO FEC-AEC1.
      
            MOVE WSS-NUM-DCOL IN WSS-VARI TO FEC-DEC2.
            MOVE WSS-NUM-MCOL IN WSS-VARI TO FEC-MEC2.
            MOVE WSS-NUM-SCOL IN WSS-VARI TO FEC-SEC2.
            MOVE WSS-NUM-ACOL IN WSS-VARI TO FEC-AEC2.
      
            MOVE FEC-DIF-ANO              TO FEC-CMND.
            MOVE FEC-FORM-FEC             TO FEC-FORM.
            PERFORM CAL-FEC.
            IF NOT FEC-STAT-OKS
               MOVE 'FNAC>FCOL' TO MSG-COD-MENS IN MSG
               GO TO FIN-BUS-CLIE-EDAD1.
      *
           IF  WSS-IND-CLID IN WSS-VARI = 'D'
               MOVE FEC-NANO TO WSS-NUM-NANO IN WSS-VARI
               IF WSS-NUM-NANO IN WSS-VARI > WSS-MIN-AGNO IN WSS-VARI
                  MOVE '>MINAGNO'    TO  MSG-COD-MENS IN MSG
                  GO TO FIN-BUS-CLIE-EDAD1
               ELSE
                  GO TO FIN-BUS-CLIE-EDAD1.
      *
           IF WSS-IND-CLID IN WSS-VARI = 'I'
              MOVE FEC-NANO TO WSS-NUM-NANO IN WSS-VARI
              IF WSS-NUM-NANO IN WSS-VARI > WSS-MIN-AGNO-I IN WSS-VARI
                 MOVE '>MINAGNO' TO MSG-COD-MENS IN MSG.
      *
           IF WSS-IND-CLID IN WSS-VARI = 'E'
              MOVE FEC-NANO TO WSS-NUM-NANO IN WSS-VARI
              IF WSS-NUM-NANO IN WSS-VARI > WSS-MIN-AGNO-ID IN WSS-VARI
                 MOVE '>MINAGNO' TO MSG-COD-MENS IN MSG.
       FIN-BUS-CLIE-EDAD1.
           EXIT.
      
       BUS-CLIE-EDAD2 SECTION.
       INI-BUS-CLIE-EDAD2.
      * Si cliente tiene hoy mas de 75 anos no cobrar seguro
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           IF DCP-FEC-FNAC IN DCP NOT > ZEROES
              MOVE WSS-FEC-FMAV IN WSS-VARI TO WSS-FMIN IN WSS-VARI
              GO TO FIN-BUS-CLIE-EDAD2.
      
           IF  WSS-IND-CLID IN WSS-VARI = 'D'
               MOVE WSS-MAX-AGNO   TO FEC-NANO
            ELSE
               IF  WSS-IND-CLID IN WSS-VARI = 'I'
                   MOVE WSS-MAX-AGNO-I TO FEC-NANO
               ELSE
                  IF  WSS-IND-CLID IN WSS-VARI = 'E'
                      MOVE WSS-MAX-AGNO-ID TO FEC-NANO.
      *
            MOVE DCP-NUM-DNAC IN DCP TO FEC-ITM1
            MOVE DCP-NUM-MNAC IN DCP TO FEC-ITM2
            MOVE DCP-NUM-SNAC IN DCP TO FEC-ITM3
            MOVE DCP-NUM-ANAC IN DCP TO FEC-ITM4
            MOVE FEC-SUM-ANO  TO FEC-CMND
            PERFORM CAL-FEC
            IF NOT FEC-STAT-OKS
               MOVE FEC-STAT TO MSG-COD-MENS IN MSG
               GO TO FIN-BUS-CLIE-EDAD2.
      
            MOVE FEC-ITM1 TO WSS-NUM-DEC2 IN WSS-VARI
            MOVE FEC-ITM2 TO WSS-NUM-MEC2 IN WSS-VARI
            MOVE FEC-ITM3 TO WSS-NUM-SEC2 IN WSS-VARI
            MOVE FEC-ITM4 TO WSS-NUM-AEC2 IN WSS-VARI
      
            IF WSS-FEC-FEC2 IN WSS-VARI NOT > WSS-FEC-FCOL IN WSS-VARI
               MOVE '>FECFCOL' TO MSG-COD-MENS IN MSG.
       FIN-BUS-CLIE-EDAD2.
           EXIT.
      
      
      * Obtener diferencia de meses entre FMIN y OPC-FEC-FCOL IN OPC-FLD
       OBT-DIFE-MESES SECTION.
       INI-OBT-DIFE-MESES.
      *WSS-IND-SEGU = (E)-> SEDECO (D)-> SEGDES
      *
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           IF WSS-IND-SEGU IN WSS-VARI = 'E'
               MOVE FEC-DIF-DIA              TO FEC-CMND
           ELSE
               MOVE FEC-DIF-MES              TO FEC-CMND.
      *
           IF WSS-FMIN IN WSS-VARI NOT > WSS-FEC-FCOL IN WSS-VARI
              IF WSS-FMIN IN WSS-VARI = WSS-FEC-FCOL IN WSS-VARI
                 MOVE 'FMIN=FCOL' TO MSG-COD-MENS IN MSG
                 GO TO FIN-OBT-DIFE-MESES
               ELSE
                 GO TO FIN-OBT-DIFE-MESES.
      *
            MOVE WSS-NUM-DCOL IN WSS-VARI TO FEC-DEC1.
            MOVE WSS-NUM-MCOL IN WSS-VARI TO FEC-MEC1.
            MOVE WSS-NUM-SCOL IN WSS-VARI TO FEC-SEC1.
            MOVE WSS-NUM-ACOL IN WSS-VARI TO FEC-AEC1.
      
            MOVE WSS-DMIN IN WSS-VARI     TO FEC-DEC2.
            MOVE WSS-MMIN IN WSS-VARI     TO FEC-MEC2.
            MOVE WSS-SMIN IN WSS-VARI     TO FEC-SEC2.
            MOVE WSS-AMIN IN WSS-VARI     TO FEC-AEC2.
      
            MOVE FEC-FORM-FEC             TO FEC-FORM.
            PERFORM CAL-FEC.
            IF WSS-IND-SEGU IN WSS-VARI = 'D'
               MOVE FEC-NMES TO WSS-NUM-DMES IN WSS-VARI
               IF FEC-NDIA > ZEROES AND
                  WSS-NUM-DMES IN WSS-VARI < 999
                    ADD 1 TO WSS-NUM-DMES IN WSS-VARI
               ELSE
                    NEXT SENTENCE
            ELSE
               IF FEC-NDIA NOT < ZEROES
                  MOVE FEC-NDIA  TO WSS-NUM-DDIA IN WSS-VARI.
       FIN-OBT-DIFE-MESES.
           EXIT.
      
       CAL-FINAL-SEGD SECTION.
       INI-CAL-FINAL-SEGD.
           IF (DCP-COD-TBAN IN DCP = 'N' OR
               DCP-COD-TBAN IN DCP = WSS-COD-TCLI IN WSS-VARI)
               MULTIPLY WSS-VAL-SCRE IN WSS-VARI BY
                        WSS-VAL-NCLI IN WSS-VARI GIVING
                        WSS-VAL-SEGD IN WSS-VARI ROUNDED
           ELSE
               MULTIPLY WSS-VAL-SCRE IN WSS-VARI BY
                        WSS-VAL-CLIE IN WSS-VARI GIVING
                        WSS-VAL-SEGD IN WSS-VARI ROUNDED.
      
           MOVE WSS-VAL-SEGD IN WSS-VARI TO PES-SGV-DECI
                                             IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO
                                WSS-VAL-SEGD IN WSS-VARI.
       FIN-CAL-FINAL-SEGD.
           EXIT.
      
       BUS-CLIE-FEC-NAC SECTION.
       INI-BUS-CLIE-FEC-NAC.
      * Si cliente es empresa, valor de seguro es 0
      * Buscar fecha nacimiento de deudor natural
      * Si RUT cliente > 50000000 (empresa) no cobrar seguro
           MOVE SPACES                   TO MSG-COD-MENS IN MSG.
           MOVE OPC-CAI-IOPC IN OPC-FLD  TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC-FLD  TO RDC-IIC-IOPC IN RDC.
           MOVE WSS-NUM-IDLC IN WSS-VARI TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS OR
             RDC-CAI-IOPC IN RDC NOT = OPC-CAI-IOPC IN OPC-FLD OR
             RDC-IIC-IOPC IN RDC NOT = OPC-IIC-IOPC IN OPC-FLD OR
             RDC-NUM-IDLC IN RDC NOT = WSS-NUM-IDLC IN WSS-VARI
             IF  WSS-NUM-IDLC IN WSS-VARI= ZEROES
                 MOVE 'OPC    NORDC' TO MSG-COD-MENS IN MSG
                 GO TO FIN-BUS-CLIE-FEC-NAC
             ELSE
                 MOVE 'OPC  NORDCDI' TO MSG-COD-MENS IN MSG
                 GO TO FIN-BUS-CLIE-FEC-NAC.
      *
            MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM SGC-FIO-DBC.
            IF NOT FIO-STAT-OKS
               MOVE 'OPC    NODBC' TO MSG-COD-MENS IN MSG
               GO TO FIN-BUS-CLIE-FEC-NAC.
      *
            IF DBC-NUM-ICLI IN DBC NOT < WSS-NUM-ICLI IN WSS-VARI
               MOVE '50000000' TO MSG-COD-MENS IN MSG
               GO TO FIN-BUS-CLIE-FEC-NAC.
      *
            MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM SGC-FIO-DCP.
            IF NOT FIO-STAT-OKS
               MOVE 'CLI    NODCP' TO MSG-COD-MENS IN MSG
               GO TO FIN-BUS-CLIE-FEC-NAC.
       FIN-BUS-CLIE-FEC-NAC.
           EXIT.
      
      
      ******************************************************************
      * RBG/INI/28-APR-1997.
       CALC-SEG-CORF SECTION.
      **********************
       INI-CALC-SEG-CORF.
           MOVE 'S' TO WSS-IND-NOCA IN WSS-VARI.
      * Si es moneda Nacional transformar a Pesos.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO MSC-COD-CMSC IN MSC.
      
           IF OPC-MSC-TVOC IN OPC-FLD = MSC-COD-CMSC IN MSC
               MOVE OPC-COD-VCOC IN OPC-FLD TO TAB-COD-CTAB IN TAB
               MOVE '0999  '                TO TAB-CIC-CTAB IN TAB
               MOVE OPC-NUM-DCOL IN OPC-FLD TO TAB-NUM-DTRN IN TAB
               MOVE OPC-NUM-MCOL IN OPC-FLD TO TAB-NUM-MTRN IN TAB
               MOVE OPC-NUM-SCOL IN OPC-FLD TO TAB-NUM-STRN IN TAB
               MOVE OPC-NUM-ACOL IN OPC-FLD TO TAB-NUM-ATRN IN TAB
               PERFORM GET-VCAM
               IF MSG-COD-MENS IN MSG NOT > SPACES
                   MULTIPLY CAM-SGV-VCAM IN CAM BY
                            OPC-VAL-SCRE IN OPC-FLD GIVING
                            WSS-VAL-SCRE IN WSS-VARI
               ELSE
                   IF MSG-COD-MENS IN MSG = 'CODVCAMEQL'
                       MOVE 1 TO CAM-SGV-VCAM IN CAM
                       MOVE SPACES TO MSG-COD-MENS IN MSG
                       MOVE OPC-VAL-SCRE IN OPC-FLD TO WSS-VAL-SCRE
                                                        IN WSS-VARI
                   ELSE
                       GO TO FIN-CALC-SEG-CORF
           ELSE
               MOVE OPC-VAL-SCRE IN OPC-FLD TO WSS-VAL-SCRE IN WSS-VARI.
      
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-NUM-DCOL IN OPC-FLD TO WSS-NUM-DCOL IN WSS-VARI.
           MOVE OPC-NUM-MCOL IN OPC-FLD TO WSS-NUM-MCOL IN WSS-VARI.
           MOVE OPC-NUM-SCOL IN OPC-FLD TO WSS-NUM-SCOL IN WSS-VARI.
           MOVE OPC-NUM-ACOL IN OPC-FLD TO WSS-NUM-ACOL IN WSS-VARI.
      
      * Si cliente es empresa, valor del seguro es cero.
      * Buscar fecha nacimiento de deudor natural.
           MOVE OPC-CAI-IOPC IN OPC-FLD  TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC-FLD  TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES                   TO WSS-NUM-IDLC IN WSS-VARI.
           MOVE WSS-NUM-IDLC IN WSS-VARI TO RDC-NUM-IDLC IN RDC.
           PERFORM VAL-ICLI.
           IF WSS-IND-NOCA IN WSS-VARI = 'N'
               GO TO FIN-CALC-SEG-CORF.
      
           IF MSG-COD-MENS IN MSG > SPACES
               IF MSG-COD-MENS IN MSG = 'PENACRCOEMP'
                   MOVE SPACES TO MSG-COD-MENS IN MSG
                   GO TO FIN-CALC-SEG-CORF
               ELSE
                   GO TO FIN-CALC-SEG-CORF.
      
      * Busco MINIMO de anos desde la tabla SDG con codigo SEGCOR.
           MOVE 'COL'    TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDG'    TO TAB-COD-TTAB IN TAB.
           MOVE 'SEGCOR' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODSEGCORNEX' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-CORF
           ELSE
               MOVE TAB-GLS-DAT2 IN TAB TO WSS-GLS-DAT4 IN WSS-VARI.
      
           IF WSS-NUM-MANO IN WSS-VARI NOT NUMERIC
               MOVE 'SEGCORFNONUM' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-CORF.
      
      * Si cliente tiene hoy mas anos que los que trae el parametro
      * analizo al Deudor Indirecto.
           IF DCP-FEC-FNAC IN DCP > ZEROES
               MOVE DCP-NUM-DNAC IN DCP TO FEC-ITM1
               MOVE DCP-NUM-MNAC IN DCP TO FEC-ITM2
               MOVE DCP-NUM-SNAC IN DCP TO FEC-ITM3
               MOVE DCP-NUM-ANAC IN DCP TO FEC-ITM4
               MOVE FEC-SUM-ANO  TO FEC-CMND
      * Minimo de anos para cobrar Seguro es parametrico.
               MOVE WSS-NUM-MANO TO FEC-NANO
               PERFORM CAL-FEC
               IF FEC-STAT-OKS
                  MOVE FEC-ITM1 TO WSS-NUM-DEC2 IN WSS-VARI
                  MOVE FEC-ITM2 TO WSS-NUM-MEC2 IN WSS-VARI
                  MOVE FEC-ITM3 TO WSS-NUM-SEC2 IN WSS-VARI
                  MOVE FEC-ITM4 TO WSS-NUM-AEC2 IN WSS-VARI
                  IF WSS-FEC-FEC2 IN WSS-VARI NOT >
                     WSS-FEC-FCOL IN WSS-VARI
      * Voy a buscar la fecha de nacimiento del Deudor Indirecto para
      * calcular la edad a hoy.
                      MOVE OPC-CAI-IOPC IN OPC-FLD  TO RDC-CAI-IOPC
                                                             IN RDC
                      MOVE OPC-IIC-IOPC IN OPC-FLD  TO RDC-IIC-IOPC
                                                             IN RDC
                      MOVE 1                        TO WSS-NUM-IDLC
                                                        IN WSS-VARI
                      MOVE WSS-NUM-IDLC IN WSS-VARI TO RDC-NUM-IDLC
                                                             IN RDC
                      PERFORM VAL-ICLI
                      IF MSG-COD-MENS IN MSG > SPACES
                          GO TO FIN-CALC-SEG-CORF
                      ELSE
                          IF WSS-IND-NOCA IN WSS-VARI = 'N'
                              MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
                              GO TO FIN-CALC-SEG-CORF
                          ELSE
                              NEXT SENTENCE
                  ELSE
                      GO TO CONT-COB-SEGC
               ELSE
                   MOVE FEC-STAT TO MSG-COD-MENS IN MSG
                   GO TO FIN-CALC-SEG-CORF
           ELSE
               IF DCP-FEC-FNAC IN DCP = ZEROES
                   MOVE 'FECNACDD NEX' TO MSG-COD-MENS
                   GO TO FIN-CALC-SEG-CORF.
      
      * Si Deudor Indirecto tiene hoy mas anos que el parametro no
      * cobrar seguro.
           IF DCP-FEC-FNAC IN DCP > ZEROES
               MOVE DCP-NUM-DNAC IN DCP TO FEC-ITM1
               MOVE DCP-NUM-MNAC IN DCP TO FEC-ITM2
               MOVE DCP-NUM-SNAC IN DCP TO FEC-ITM3
               MOVE DCP-NUM-ANAC IN DCP TO FEC-ITM4
               MOVE FEC-SUM-ANO  TO FEC-CMND
      * Minimo de anos para cobrar Seguro se deja Parametrico.
               MOVE WSS-NUM-MANO TO FEC-NANO
               PERFORM CAL-FEC
               IF FEC-STAT-OKS
                  MOVE FEC-ITM1 TO WSS-NUM-DEC2 IN WSS-VARI
                  MOVE FEC-ITM2 TO WSS-NUM-MEC2 IN WSS-VARI
                  MOVE FEC-ITM3 TO WSS-NUM-SEC2 IN WSS-VARI
                  MOVE FEC-ITM4 TO WSS-NUM-AEC2 IN WSS-VARI
                  IF WSS-FEC-FEC2 IN WSS-VARI NOT >
                     WSS-FEC-FCOL IN WSS-VARI
                       MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
                       GO TO FIN-CALC-SEG-CORF
                  ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE FEC-STAT TO MSG-COD-MENS IN MSG
                   GO TO FIN-CALC-SEG-CORF
           ELSE
               IF DCP-FEC-FNAC IN DCP = ZEROES
                   MOVE 'FECNACDI NEX' TO MSG-COD-MENS
                   GO TO FIN-CALC-SEG-CORF.
      
       CONT-COB-SEGC.
      
      * Si MIN > WSS-FEC-FCOL IN WSS-VARI.
           MOVE WSS-FEC-FMAV IN WSS-VARI TO WSS-FMIN IN WSS-VARI.
           IF WSS-FMIN IN WSS-VARI > WSS-FEC-FCOL IN WSS-VARI
               MOVE WSS-NUM-DCOL IN WSS-VARI TO FEC-DEC1
               MOVE WSS-NUM-MCOL IN WSS-VARI TO FEC-MEC1
               MOVE WSS-NUM-SCOL IN WSS-VARI TO FEC-SEC1
               MOVE WSS-NUM-ACOL IN WSS-VARI TO FEC-AEC1
      
               MOVE WSS-DMIN IN WSS-VARI     TO FEC-DEC2
               MOVE WSS-MMIN IN WSS-VARI     TO FEC-MEC2
               MOVE WSS-SMIN IN WSS-VARI     TO FEC-SEC2
               MOVE WSS-AMIN IN WSS-VARI     TO FEC-AEC2
      
               MOVE FEC-FORM-FEC             TO FEC-FORM
               MOVE FEC-DIF-MES              TO FEC-CMND
               PERFORM CAL-FEC
               DIVIDE FEC-NMES BY 12 GIVING WSS-NUM-DANO IN WSS-VARI
               REMAINDER WSS-NUM-DMES IN WSS-VARI
      
               IF WSS-NUM-DMES IN WSS-VARI > ZEROES
                  OR FEC-NDIA > ZEROES
                   ADD 1 TO WSS-NUM-DANO IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               IF WSS-FMIN IN WSS-VARI = WSS-FEC-FCOL IN WSS-VARI
                   MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
                   GO TO FIN-CALC-SEG-CORF.
      
      * Busca en tabla SDC el valor en UF del seguro desde los datos
      * adicionales.
           MOVE 'COL'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDC'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-NUM-DANO IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       NXT-SGT-TMO.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
               TAB-COD-TTAB IN TAB = 'SDC'
                NEXT SENTENCE
           ELSE
               IF FIO-CMND  = FIO-GET-NLS
                   MOVE 'CODSEGC  NEX' TO MSG-COD-MENS
                   MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
                   GO TO FIN-CALC-SEG-CORF
               ELSE
                   MOVE 'TMOSDCNVIG' TO MSG-COD-MENS
                   GO TO FIN-CALC-SEG-CORF.
      
           IF TAB-IND-VIGE IN TAB NOT = 'S'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO NXT-SGT-TMO.
      
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DAT5 IN WSS-VARI.
      
           IF WSS-COD-MONE IN WSS-VARI NOT > SPACES
               MOVE 'SDCCICMNDNEX' TO MSG-COD-MENS
               MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
               GO TO FIN-CALC-SEG-CORF.
      
           IF ( WSS-COD-MONE IN WSS-VARI NOT = '0998  ' AND
                WSS-COD-MONE IN WSS-VARI NOT = '0999  ' )
                 MOVE 'SDCCICMNDINV' TO MSG-COD-MENS
                 MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
                 GO TO FIN-CALC-SEG-CORF.
      
           IF WSS-VAL-MOUF IN WSS-VARI NOT NUMERIC
               MOVE 'SDCMONTO NEX' TO MSG-COD-MENS
               MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
               GO TO FIN-CALC-SEG-CORF.
      
      * El Monto en UF varia segun el numero de anos del Credito Corfo.
      * Voy a buscar el valor de cambio.
           IF WSS-COD-MONE IN WSS-VARI = '0999  '
               MOVE 1 TO WSS-SGV-VCAM IN WSS-VARI
               GO TO CONT-SIN-VCAM.
      
           MOVE WSS-COD-MONE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999  '                 TO CAM-COD-VCAM IN CAM(2).
           MOVE OPC-NUM-DCOL IN OPC-FLD  TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC-FLD  TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC-FLD  TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC-FLD  TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
               MOVE 'SEGCORFNVCAM' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-CORF
           ELSE
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM.
      
      * Multiplico por el Valor de Cambio y lo dejo en valor del credito
      * corfo.
       CONT-SIN-VCAM.
           MULTIPLY WSS-VAL-MOUF IN WSS-VARI BY WSS-SGV-VCAM IN WSS-VARI
                                GIVING WSS-VAL-SEGD IN WSS-VARI ROUNDED.
      
           MOVE WSS-VAL-SEGD IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SEGD IN WSS-VARI.
      
           IF WSS-VAL-SEGD IN WSS-VARI NOT < WSS-VAL-SCRE IN WSS-VARI
               MOVE 'MNTSEG>MNTCR' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-CORF.
      
           MOVE WSS-VAL-SEGD IN WSS-VARI TO OPC-VAL-SEGD IN OPC-FLD.
       FIN-CALC-SEG-CORF.
           EXIT.
      *
      * RBG/INI/11-NOV-1997.
       CALC-SEG-SEDECO SECTION.
      *************************
       INI-CALC-SEG-SEDECO.
      
           MOVE 'E'    TO WSS-IND-SEGU IN WSS-VARI.
           MOVE 'S'    TO WSS-IND-NOCA IN WSS-VARI.
           MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD.
           MOVE ZEROES TO WSS-VAL-SEGD IN WSS-VARI.
           MOVE 'D'    TO WSS-IND-CLID IN WSS-VARI.
      
           MOVE 'COL'       TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDM'       TO TAB-COD-TTAB IN TAB.
           MOVE SPACES      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TBLSDM  NEX' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-SEDECO.
      
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DAT3 IN WSS-VARI.
      
      * Chequea que exista la TIO en tabla SDM (Madre).
           PERFORM CHK-EXI-TIO.
           IF WSS-IND-ETIO IN WSS-VARI NOT = 'S'
               MOVE 'TIOTBLSDMNEX' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-SEDECO.
      
      * Si es moneda nacional transformar a Pesos.
           PERFORM BUS-MONEDA-NAC.
      
      * Si cliente es empresa, valor del seguro es cero.
      * Buscar fecha nacimiento de deudor natural.
           MOVE OPC-CAI-IOPC IN OPC-FLD  TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC-FLD  TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES                   TO WSS-NUM-IDLC IN WSS-VARI.
           MOVE WSS-NUM-IDLC IN WSS-VARI TO RDC-NUM-IDLC IN RDC.
           PERFORM VAL-ICLI-SEG.
      *
           MOVE SPACES TO   WSS-COD-TBAN IN WSS-VARI.
           IF WSS-IND-MM50 IN WSS-VARI  = 'S'
              MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM SGC-FIO-DCP
              IF FIO-STAT-OKS
                 MOVE DCP-COD-TBAN IN DCP TO
                                   WSS-COD-TBAN IN WSS-VARI
                 GO TO INI-CALC-SEG-SEDECO-I
              ELSE
                MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM SGC-FIO-DCE
                IF FIO-STAT-OKS
                 MOVE DCE-COD-TBAN IN DCE TO
                                   WSS-COD-TBAN IN WSS-VARI
                 GO TO INI-CALC-SEG-SEDECO-I.
      
           IF WSS-IND-NOCA IN WSS-VARI = 'N'
               GO TO FIN-CALC-SEG-SEDECO-I.
      
           IF MSG-COD-MENS IN MSG > SPACES
               IF MSG-COD-MENS IN MSG = 'PENACRCOEMP'
                   MOVE SPACES TO MSG-COD-MENS IN MSG
                   GO TO FIN-CALC-SEG-SEDECO-D
               ELSE
                   GO TO FIN-CALC-SEG-SEDECO-D.
      *
      *BUSCA MIN Y MAX SEDECO
           MOVE 'COL'           TO WSS-IND-SIST IN WSS-VARI.
           MOVE 'SDG'           TO WSS-IND-TTAB IN WSS-VARI.
           MOVE 'SEDECO'        TO WSS-IND-CTAB IN WSS-VARI.
           MOVE 'CMODSEDECONEX' TO WSS-IND-MENS IN WSS-VARI.
           PERFORM BUS-MINMAX-SEGURO.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO FIN-CALC-SEG-SEDECO.
      
           IF WSS-AGNO-NUM-MINMAX IN WSS-VARI NOT NUMERIC
              MOVE 'SEDECONONUM' TO MSG-COD-MENS
              GO TO FIN-CALC-SEG-SEDECO.
      
      * RINALDO FUENTES/INI/06-FEB-1998.
      * VALIDA QUE LA BANCA DEL CLIENTE ESTA AFECTA A COBRO
      * SEDECO CON INF. TABLA SDG DATOS ADICIONALES POS 31 A 60.
           IF DCP-COD-TBAN IN DCP = SPACES
              MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
              GO TO FIN-CALC-SEG-SEDECO-D.
      
           IF DCP-COD-TBAN IN DCP = TAB-COD-DAT3 IN TAB (1)  OR
                                    TAB-COD-DAT3 IN TAB (2)  OR
                                    TAB-COD-DAT3 IN TAB (3)  OR
                                    TAB-COD-DAT3 IN TAB (4)  OR
                                    TAB-COD-DAT3 IN TAB (5)  OR
                                    TAB-COD-DAT3 IN TAB (6)  OR
                                    TAB-COD-DAT3 IN TAB (7)  OR
                                    TAB-COD-DAT3 IN TAB (8)  OR
                                    TAB-COD-DAT3 IN TAB (9)  OR
                                    TAB-COD-DAT3 IN TAB (10)
              NEXT SENTENCE
            ELSE
              MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
              GO TO FIN-CALC-SEG-SEDECO-D.
      
      * RINALDO FUENTES/FIN/06-FEB-1998.
      * Si cliente tiene mas de 69 anos a FCOL no cobrar seguro
           PERFORM BUS-CLIE-EDAD1.
           IF MSG-COD-MENS IN MSG > SPACES
              IF MSG-COD-MENS IN MSG = '>MINAGNO'
                 MOVE ZEROES TO  OPC-VAL-SEGD IN OPC-FLD
                 MOVE SPACES  TO MSG-COD-MENS IN MSG
                 GO TO FIN-CALC-SEG-SEDECO-D
               ELSE
                 GO TO FIN-CALC-SEG-SEDECO-D.
      
      * Si cliente tiene hoy mas de 75 anos no cobrar seguro
           IF DCP-FEC-FNAC IN DCP  > ZEROES
              PERFORM BUS-CLIE-EDAD2
              IF MSG-COD-MENS IN MSG > SPACES
                 IF  MSG-COD-MENS IN MSG = '>FECFCOL'
                     MOVE ZEROES TO  OPC-VAL-SEGD IN OPC-FLD
                     MOVE SPACES  TO MSG-COD-MENS IN MSG
                     GO TO FIN-CALC-SEG-SEDECO-D
                  ELSE
                    GO TO FIN-CALC-SEG-SEDECO-D.
      
      * Calcular MIN(wss-fec-fmav y wss-fec-fec2)
           PERFORM CALC-MIN-FEC.
           PERFORM OBT-DIFE-MESES.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
              MOVE SPACES  TO MSG-COD-MENS IN MSG
              GO TO FIN-CALC-SEG-SEDECO-D.
      
      * Busco en la tabla SDM el porcentaje a aplicar al credito, desde
      * los datos adicionales, con respecto al plazo en dias.
           MOVE 'COL'        TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDM'        TO TAB-COD-TTAB IN TAB.
           MOVE WSS-NUM-DDIA TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS  TO FIO-CMND.
       NXT-SGT-TMO-D.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
               TAB-COD-TTAB IN TAB = 'SDM'
                NEXT SENTENCE
           ELSE
               IF FIO-CMND = FIO-GET-NLS
                   MOVE 'TRAMOSDM NEX'      TO MSG-COD-MENS
                   MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
                   GO TO FIN-CALC-SEG-SEDECO-D
               ELSE
                   MOVE 'TMOSDMNVIG' TO MSG-COD-MENS
                   GO TO FIN-CALC-SEG-SEDECO-D.
      
           IF TAB-IND-VIGE IN TAB NOT = 'S'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO NXT-SGT-TMO-D.
      
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.
      
           IF WSS-VAL-CLIE IN WSS-VARI NOT NUMERIC
               MOVE 'PRCNTJSDMNEX' TO MSG-COD-MENS IN MSG
               GO TO FIN-CALC-SEG-SEDECO-D.
      
      * Multiplico el saldo de credito por el porcentaje asociado al
      * credito y lo dejo en OPC-VAL-SEGD IN OPC-FLD.
           MULTIPLY WSS-VAL-SCRE IN WSS-VARI
                 BY WSS-VAL-CLIE IN WSS-VARI
             GIVING WSS-VAL-SEGD IN WSS-VARI ROUNDED.
      
           MOVE WSS-VAL-SEGD IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SEGD IN WSS-VARI.
      
           IF WSS-VAL-SEGD IN WSS-VARI NOT < WSS-VAL-SCRE IN WSS-VARI
               MOVE 'MNTSEG>MNTCR'       TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-SEDECO-D.
      
           MOVE WSS-VAL-SEGD IN WSS-VARI TO OPC-VAL-SEGD IN OPC-FLD.
           GO TO INI-CALC-SEG-SEDECO-ID.
      
      
       FIN-CALC-SEG-SEDECO-D.
      * Si cliente es empresa, valor del seguro es cero.
      * Buscar fecha nacimiento de deudor natural.
           IF  OPC-VAL-SEGD IN OPC-FLD = ZEROES
                GO TO FIN-CALC-SEG-SEDECO.
      *
       INI-CALC-SEG-SEDECO-I.
           MOVE 'N' TO  WSS-IND-MM50 IN WSS-VARI.
           MOVE 'COL'          TO WSS-IND-SIST IN WSS-VARI.
           MOVE 'SDG'          TO WSS-IND-TTAB IN WSS-VARI.
           MOVE 'SEDECO'       TO WSS-IND-CTAB IN WSS-VARI.
           MOVE 'CMODSEDECONEX' TO WSS-IND-MENS IN WSS-VARI.
           PERFORM BUS-MINMAX-SEGURO.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO FIN-CALC-SEG-SEDECO.
      
           IF WSS-COD-TBAN IN WSS-VARI = TAB-COD-DAT3 IN TAB (1) OR
                                    TAB-COD-DAT3 IN TAB (2)  OR
                                    TAB-COD-DAT3 IN TAB (3)  OR
                                    TAB-COD-DAT3 IN TAB (4)  OR
                                    TAB-COD-DAT3 IN TAB (5)  OR
                                    TAB-COD-DAT3 IN TAB (6)  OR
                                    TAB-COD-DAT3 IN TAB (7)  OR
                                    TAB-COD-DAT3 IN TAB (8)  OR
                                    TAB-COD-DAT3 IN TAB (9)  OR
                                    TAB-COD-DAT3 IN TAB (10)
                MOVE 'S' TO  WSS-IND-MM50 IN WSS-VARI.
      
            IF  WSS-IND-MM50 IN WSS-VARI = 'N'
                GO TO FIN-CALC-SEG-SEDECO.
      
       INI-CALC-SEG-SEDECO-ID.
           MOVE 'I'  TO WSS-IND-CLID IN WSS-VARI.
           MOVE OPC-CAI-IOPC IN OPC-FLD  TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC-FLD  TO RDC-IIC-IOPC IN RDC.
           MOVE 1                        TO WSS-NUM-IDLC IN WSS-VARI.
           MOVE WSS-NUM-IDLC IN WSS-VARI TO RDC-NUM-IDLC IN RDC.
           PERFORM VAL-ICLI-SEG.
           IF WSS-IND-NOCA IN WSS-VARI = 'N'
               GO TO FIN-CALC-SEG-SEDECO-I.
      
           IF MSG-COD-MENS IN MSG > SPACES
               IF MSG-COD-MENS IN MSG = 'PENACRCOEMP'
                   MOVE SPACES TO MSG-COD-MENS IN MSG
                   GO TO FIN-CALC-SEG-SEDECO-I
               ELSE
                   GO TO FIN-CALC-SEG-SEDECO-I.
      *
      *BUSCA MIN Y MAX SEDECO
           MOVE 'COL'          TO WSS-IND-SIST IN WSS-VARI.
           MOVE 'SDG'          TO WSS-IND-TTAB IN WSS-VARI.
           MOVE 'SEDECO'       TO WSS-IND-CTAB IN WSS-VARI.
           MOVE 'CODSEDECONEX' TO WSS-IND-MENS IN WSS-VARI.
           PERFORM BUS-MINMAX-SEGURO.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO FIN-CALC-SEG-SEDECO-I.
      * (*)
           IF WSS-AGNO-NUM-MINMAX-ID IN WSS-VARI NOT NUMERIC
              MOVE 'SEDECONONUDI' TO MSG-COD-MENS
              GO TO FIN-CALC-SEG-SEDECO-I.
      
      * RINALDO FUENTES/INI/06-FEB-1998.
      * VALIDA QUE LA BANCA DEL CLIENTE ESTA AFECTA A COBRO
      * SEDECO CON INF. TABLA SDG DATOS ADICIONALES POS 31 A 60.
           IF DCP-COD-TBAN IN DCP = SPACES
              GO TO FIN-CALC-SEG-SEDECO-I.
      
      
      * RINALDO FUENTES/FIN/06-FEB-1998.
      * Si cliente tiene mas de 69 anos a FCOL no cobrar seguro
           MOVE 'E'    TO WSS-IND-CLID IN WSS-VARI.
           PERFORM BUS-CLIE-EDAD1.
           IF MSG-COD-MENS IN MSG > SPACES
              IF MSG-COD-MENS IN MSG = '>MINAGNO'
                 MOVE SPACES  TO MSG-COD-MENS IN MSG
                 GO TO FIN-CALC-SEG-SEDECO-I
               ELSE
                 GO TO FIN-CALC-SEG-SEDECO-I.
      *21-04-1999.
      *JGM(SE ELIMINO LA VALIDACION DE BANCA PARA EL DEUDOR ID).
      *21-04-1999.
      * Si cliente tiene hoy mas de 75 anos no cobrar seguro
           IF DCP-FEC-FNAC IN DCP  > ZEROES
              PERFORM BUS-CLIE-EDAD2
              IF MSG-COD-MENS IN MSG > SPACES
                 IF  MSG-COD-MENS IN MSG = '>FECFCOL'
                     MOVE SPACES  TO MSG-COD-MENS IN MSG
                     GO TO FIN-CALC-SEG-SEDECO-I
                  ELSE
                    GO TO FIN-CALC-SEG-SEDECO-I.
      
           MOVE 'I'    TO WSS-IND-CLID IN WSS-VARI.
      
      * Calcular MIN(wss-fec-fmav y wss-fec-fec2)
           PERFORM CALC-MIN-FEC.
           PERFORM OBT-DIFE-MESES.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE SPACES  TO MSG-COD-MENS IN MSG
              GO TO FIN-CALC-SEG-SEDECO-I.
      
      * Busco en la tabla SDM el porcentaje a aplicar al credito, desde
      * los datos adicionales, con respecto al plazo en dias.
           MOVE 'COL'        TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDM'        TO TAB-COD-TTAB IN TAB.
           MOVE WSS-NUM-DDIA TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS  TO FIO-CMND.
       NXT-SGT-TMO-I.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
               TAB-COD-TTAB IN TAB = 'SDM'
                NEXT SENTENCE
           ELSE
               IF FIO-CMND = FIO-GET-NLS
                   MOVE 'TRAMOSDM NEX'      TO MSG-COD-MENS
                   MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
                   GO TO FIN-CALC-SEG-SEDECO-I
               ELSE
                   MOVE 'TMOSDMNVIG' TO MSG-COD-MENS
                   GO TO FIN-CALC-SEG-SEDECO-I.
      
           IF TAB-IND-VIGE IN TAB NOT = 'S'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO NXT-SGT-TMO-I.
      
           MOVE TAB-GLS-DAT3 IN TAB TO WSS-GLS-DATA-I IN WSS-VARI.
      
           IF WSS-VAL-CLIE-I IN WSS-VARI NOT NUMERIC
      *(*)
               MOVE 'PRCNSDMNEXDI' TO MSG-COD-MENS IN MSG
               GO TO FIN-CALC-SEG-SEDECO-I.
      
      * Multiplico el saldo de credito por el porcentaje asociado al
      * credito y lo dejo en OPC-VAL-SEGD IN OPC-FLD.
      
           MULTIPLY    WSS-VAL-SCRE   IN WSS-VARI
                 BY    WSS-VAL-CLIE-I IN WSS-VARI
             GIVING    WSS-VAL-SEGD   IN WSS-VARI ROUNDED.
      
           MOVE WSS-VAL-SEGD IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SEGD IN WSS-VARI.
      
           IF WSS-VAL-SEGD IN WSS-VARI NOT < WSS-VAL-SCRE IN WSS-VARI
               MOVE 'MNTSEG>MNTCR' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-SEDECO-I.
      
           COMPUTE
           OPC-VAL-SEGD IN OPC-FLD = OPC-VAL-SEGD IN OPC-FLD +
                                     WSS-VAL-SEGD IN WSS-VARI .
       FIN-CALC-SEG-SEDECO-I.
       FIN-CALC-SEG-SEDECO.
           EXIT.
      * RBG/FIN/11-NOV-1997.
      
      ******************************************************************
       VAL-ICLI SECTION.
      *****************
       INI-VAL-ICLI.
      * Busco fecha de nacimiento del deudor directo o indirecto.
           MOVE 'N' TO WSS-IND-MM50 IN WSS-VARI.
           MOVE SPACES TO WSS-IND-NOCA IN WSS-VARI.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
             RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC-FLD AND
             RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC-FLD AND
             RDC-NUM-IDLC IN RDC = WSS-NUM-IDLC IN WSS-VARI
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
      * Si RUT del cliente es > 50.000.0000 (empresa) no cobrar seguro.
                   IF DBC-NUM-ICLI IN DBC < WSS-NUM-ICLI IN WSS-VARI
                      AND DBC-IND-TICL IN DBC = 'P'
                       MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM SGC-FIO-DCP
                       IF FIO-STAT-OKS
                           NEXT SENTENCE
                       ELSE
                           MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'PENACRCOEMP' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC IN MSG TO FRM-MEN2
                           GO TO FIN-VAL-ICLI
                   ELSE
                     MOVE 'S' TO WSS-IND-MM50 IN WSS-VARI
                     MOVE 'N' TO WSS-IND-NOCA IN WSS-VARI
                     MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
                     GO TO FIN-VAL-ICLI
               ELSE
                   MOVE 'OPC    NODBC' TO MSG-COD-MENS IN MSG
                   GO TO FIN-VAL-ICLI
           ELSE
               IF WSS-NUM-IDLC IN WSS-VARI = ZEROES
                   MOVE 'OPC    NORDC' TO MSG-COD-MENS IN MSG
               ELSE
                   MOVE 'N' TO WSS-IND-NOCA IN WSS-VARI.
       FIN-VAL-ICLI.
           EXIT.
      * RBG/FIN/28-APR-1997.
      ******************************************************
       VAL-ICLI-SEG SECTION.
      *****************
       INI-VAL-ICLI-SEG.
      * Busco fecha de nacimiento del deudor directo o indirecto.
           MOVE 'N' TO WSS-IND-MM50 IN WSS-VARI.
           MOVE SPACES TO WSS-IND-NOCA IN WSS-VARI.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
             RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC-FLD AND
             RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC-FLD AND
             RDC-NUM-IDLC IN RDC = WSS-NUM-IDLC IN WSS-VARI
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
      * Si RUT del cliente es > 50.000.0000 (empresa) no cobrar seguro.
                   IF DBC-NUM-ICLI IN DBC < WSS-NUM-ICLI IN WSS-VARI
                      AND DBC-IND-TICL IN DBC = 'P'
                       MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM SGC-FIO-DCP
                       IF FIO-STAT-OKS
                           NEXT SENTENCE
                       ELSE
                           MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'PENACRCOEMP' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC IN MSG TO FRM-MEN2
                           GO TO FIN-VAL-ICLI-SEG
                   ELSE
                     MOVE 'S' TO WSS-IND-MM50 IN WSS-VARI
                     MOVE 'N' TO WSS-IND-NOCA IN WSS-VARI
      *              MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD
                     GO TO FIN-VAL-ICLI-SEG
               ELSE
                   MOVE 'OPC    NODBC' TO MSG-COD-MENS IN MSG
                   GO TO FIN-VAL-ICLI-SEG
           ELSE
               IF WSS-NUM-IDLC IN WSS-VARI = ZEROES
                   MOVE 'OPC    NORDC' TO MSG-COD-MENS IN MSG
               ELSE
                   MOVE 'N' TO WSS-IND-NOCA IN WSS-VARI.
       FIN-VAL-ICLI-SEG.
           EXIT.
      ******************************************************************
      *INI-JGM 17-05-1999.
       CALC-SEG-CESANT SECTION.
      **********************
       INI-CALC-SEG-CESANT.
           MOVE 'S'    TO WSS-IND-COBRO IN WSS-VARI.
           MOVE ZEROES TO OPC-VAL-SEGC  IN OPC-FLD.
           MOVE ZEROES TO WSS-VAL-SEGC  IN WSS-VARI.
      *
      *TIO:NO COBRO.
           IF OPC-COD-TOOC IN OPC-FLD  = 'PAP' OR
              OPC-COD-TOOC IN OPC-FLD  = 'PAF' OR
              OPC-COD-TOOC IN OPC-FLD  = 'PCF' OR
              OPC-COD-TOOC IN OPC-FLD  = 'PCP'
              MOVE ZEROES TO OPC-VAL-SEGC IN OPC-FLD
              GO TO FIN-CALC-SEG-CESANT.
      
           MOVE 'COL'       TO TAB-COD-SIST FIO-SIST.
           MOVE 'SDG'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CESANT'    TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TBLCST  NEX' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-CESANT.
      
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATBAN IN WSS-VARI.
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATCOB IN WSS-VARI.
      *
      *'SGCMONTO NEX' *
           IF WSS-GLS-PORREN IN  WSS-VARI NOT NUMERIC
               MOVE 'SGCMONTO NEX'              TO MSG-COD-MENS
               MOVE  WSS-GLS-PORREN IN WSS-VARI TO FRM-MEN2
               GO TO FIN-CALC-SEG-CESANT.
      *
      *
      * Si es moneda nacional transformar a Pesos.
           PERFORM BUS-MONEDA-NAC.
      *
           MOVE 'S' TO WSS-IND-COBRO IN WSS-VARI.
           PERFORM VAL-ICLI-SCESANT.
            IF MSG-COD-MENS IN MSG > SPACES
               IF MSG-COD-MENS IN MSG = 'PENACRCOEMP'
                   MOVE SPACES TO MSG-COD-MENS IN MSG
                   GO TO FIN-CALC-SEG-CESANT
               ELSE
                   GO TO FIN-CALC-SEG-CESANT.
      *
      
           IF WSS-IND-COBRO IN WSS-VARI = 'N'
              GO TO FIN-CALC-SEG-CESANT.
      *
      * Multiplico el saldo de credito por el porcentaje asociado al
      * CREDITO Y SE LE CALCULA IVA ->OPC-VAL-SEGC IN OPC-FLD.
           COMPUTE
           WSS-VAL-SEGC IN WSS-VARI =
                    ( WSS-VAL-PORCOB IN WSS-VARI / 100 ) *
                      WSS-VAL-SCRE IN WSS-VARI.
      
      *IVA
           MOVE 'TAB'       TO TAB-COD-SIST FIO-SIST.
           MOVE 'IVA'       TO TAB-COD-TTAB IN TAB.
           MOVE SPACES      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
      
           IF TAB-IND-VIGE NOT = 'S'
               MOVE 'CODIVANEX'          TO MSG-COD-MENS
               MOVE  TAB-COD-TTAB IN TAB TO FRM-MEN2
               GO TO FIN-CALC-SEG-CESANT.
      
           MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-DIVA IN WSS-VARI.
      *'SGCMONTO NEX' *
           IF WSS-GLS-DIVA  IN  WSS-VARI NOT NUMERIC
               MOVE 'TABIVA NONUM' TO MSG-COD-MENS
               MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
               GO TO FIN-CALC-SEG-CESANT.
      
           COMPUTE WSS-VAL-SEGC IN WSS-VARI =
                  (( WSS-NUM-PIVA IN WSS-VARI / 100 ) *
                     WSS-VAL-SEGC IN WSS-VARI ) +
                     WSS-VAL-SEGC IN WSS-VARI.
      *
           MOVE WSS-VAL-SEGC IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SEGC IN WSS-VARI.
      *
           IF WSS-VAL-SEGC IN WSS-VARI NOT < WSS-VAL-SCRE IN WSS-VARI
               MOVE 'MNTSEG>MNTCR' TO MSG-COD-MENS
               GO TO FIN-CALC-SEG-CESANT.
      *
           MOVE WSS-VAL-SEGC IN WSS-VARI TO OPC-VAL-SEGC IN OPC-FLD.
      
       FIN-CALC-SEG-CESANT.
           EXIT.
      
      ******************************************************************
       VAL-ICLI-SCESANT SECTION.
      *****************
       INI-VAL-ICLI-SCESANT.
      * Busco fecha de nacimiento del deudor directo o indirecto.
           MOVE 'S'    TO WSS-IND-COBRO IN WSS-VARI.
           MOVE SPACES TO MSG-COD-MENS  IN MSG.
      *
           MOVE OPC-CAI-IOPC IN OPC-FLD  TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC-FLD  TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES                   TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
             RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC-FLD AND
             RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC-FLD AND
             RDC-NUM-IDLC IN RDC = ZEROES)
              MOVE 'OPC    NORDC' TO MSG-COD-MENS IN MSG
              MOVE ZEROES         TO OPC-VAL-SEGC  IN OPC-FLD
              GO TO FIN-VAL-ICLI-SCESANT.
      *
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'OPC    NODBC' TO MSG-COD-MENS IN MSG
              MOVE ZEROES         TO OPC-VAL-SEGC  IN OPC-FLD
              GO TO FIN-VAL-ICLI-SCESANT.
      *
           IF NOT (DBC-NUM-ICLI IN DBC < WSS-NUM-ICLI IN WSS-VARI AND
                   DBC-IND-TICL IN DBC = 'P')
              MOVE 'N'    TO WSS-IND-COBRO IN WSS-VARI
              MOVE ZEROES TO OPC-VAL-SEGC  IN OPC-FLD
              GO TO FIN-VAL-ICLI-SCESANT.
      *
            MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM SGC-FIO-DCP
            IF NOT FIO-STAT-OKS
               MOVE 'CLI    NODCP' TO MSG-COD-MENS IN MSG
               MOVE ZEROES         TO OPC-VAL-SEGC IN OPC-FLD
               GO TO FIN-VAL-ICLI-SCESANT.
      *
           MOVE DCP-COD-TBAN IN DCP TO WSS-IND-TBAN IN WSS-VARI.
           IF  WSS-IND-TBAN IN WSS-VARI NOT = 'P'
               MOVE 'N'       TO WSS-IND-COBRO IN WSS-VARI
               MOVE ZEROES    TO OPC-VAL-SEGC  IN OPC-FLD
               GO TO FIN-VAL-ICLI-SCESANT.
      *
           IF DCP-COD-TBAN IN DCP = WSS-COD-TBANC IN WSS-VARI (1) OR
                                WSS-COD-TBANC IN WSS-VARI (2) OR
                                WSS-COD-TBANC IN WSS-VARI (3) OR
                                WSS-COD-TBANC IN WSS-VARI (4) OR
                                WSS-COD-TBANC IN WSS-VARI (5) OR
                                WSS-COD-TBANC IN WSS-VARI (6) OR
                                WSS-COD-TBANC IN WSS-VARI (7) OR
                                WSS-COD-TBANC IN WSS-VARI (8) OR
                                WSS-COD-TBANC IN WSS-VARI (9) OR
                                WSS-COD-TBANC IN WSS-VARI (10) OR
                                WSS-COD-TBANC IN WSS-VARI (11) OR
                                WSS-COD-TBANC IN WSS-VARI (12) OR
                                WSS-COD-TBANC IN WSS-VARI (13) OR
                                WSS-COD-TBANC IN WSS-VARI (14) OR
                                WSS-COD-TBANC IN WSS-VARI (15)
              NEXT SENTENCE
            ELSE
              MOVE ZEROES TO OPC-VAL-SEGC  IN OPC-FLD
              MOVE 'N'    TO WSS-IND-COBRO IN WSS-VARI
              GO TO FIN-CALC-SEG-CESANT.
      *RENTA
           MOVE DBC-CAI-ICLI IN DBC TO AEP-CAI-ICLI IN AEP.
           MOVE DBC-IIC-ICLI IN DBC TO AEP-IIC-ICLI IN AEP.
           MOVE '999999999'         TO AEP-FEC-FAEP IN AEP.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-AEP.
           IF NOT ( FIO-STAT-OKS  AND
              AEP-CIC-ICLI IN AEP  = DBC-CIC-ICLI IN DBC)
              MOVE ZEROES TO AEP-VAL-RLCL IN AEP
              GO TO FIN-VAL-ICLI-SCESANT.
      *
           IF  AEP-VAL-RLCL IN AEP  = ZEROES
               PERFORM FIN-VAL-ICLI-SCESANT.
      
      *TOPE DE LA RENTA EN UF(WS-VAL-TOPREN)
      
      *AEP-COD-VCEA IN  AEP :UF (SE COMPARA )
           IF AEP-COD-VCAE IN AEP = '0998  '
              MOVE AEP-VAL-RLCL IN AEP TO WSS-VAL-TRUF IN WSS-VARI
              GO TO COMPARA-RENTA-UF.
      *
      *AEP-COD-VCEA IN  AEP :M$ (MILES DE PESOS)
           IF AEP-COD-VCAE IN AEP = 'M$    '
              MULTIPLY AEP-VAL-RLCL IN AEP
                 BY 1000 GIVING WSS-VAL-RLCL IN WSS-VARI
                 GO TO BUS-CAMBIO-RENTA-P-U.
      *
      
      *AEP-COD-VCEA IN  AEP :$  (SE LLEVA UF)
           IF AEP-COD-VCAE IN AEP = '0999  '
              MOVE AEP-VAL-RLCL IN AEP TO WSS-VAL-RLCL IN WSS-VARI
              GO TO BUS-CAMBIO-RENTA-P-U.
      
      *
        BUS-CAMBIO-RENTA-P-U.
      *$(0999 ) ->  UF(0998 )  TOPE DE LA RENTA.
           MOVE '0998  '               TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999  '               TO CAM-COD-VCAM IN CAM(2).
           MOVE AEP-NUM-DAEP IN AEP    TO CAM-NUM-DCAM IN CAM(1).
           MOVE AEP-NUM-MAEP IN AEP    TO CAM-NUM-MCAM IN CAM(1).
           MOVE AEP-NUM-SAEP IN AEP    TO CAM-NUM-SCAM IN CAM(1).
           MOVE AEP-NUM-AAEP IN AEP    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
      *
      *(SEGCESANVCAN) NO EXISTE V.DE CAM. SEG.CESANTIA.
           IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
              MOVE 'SEGCESANVCAM'       TO MSG-COD-MENS
               GO TO FIN-VAL-ICLI-SCESANT.
      *
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM IN WSS-VARI.
      *
           DIVIDE   WSS-VAL-RLCL IN WSS-VARI
                 BY WSS-SGV-VCAM IN WSS-VARI
             GIVING WSS-VAL-TRUF IN WSS-VARI ROUNDED.
      
      *    MOVE WSS-VAL-TRUF IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
      *    PERFORM PES-SCTV.
      *    MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-TRUF IN WSS-VARI.
      
      *VALIDA RENTA > TOPE NO SE COBRA.
       COMPARA-RENTA-UF.
           IF WSS-VAL-TRUF IN WSS-VARI NOT < WSS-VAL-TOPREN IN WSS-VARI
              MOVE 'N'    TO WSS-IND-COBRO IN WSS-VARI
              GO TO FIN-VAL-ICLI-SCESANT.
      
       FIN-VAL-ICLI-SCESANT.
           EXIT.
      
      ******************************************************************
      * RBG/INI/12-NOV-1997. Limpio el arreglos de los TIO's.
       LIM-VEC-TIO SECTION.
      *********************
       INI-LIM-VEC-TIO.
           MOVE 1 TO MOV-I.
       LUP-LIM-VEC-TIO.
           IF MOV-I > 20
               GO TO FIN-LIM-VEC-TIO.
           MOVE SPACES TO WSS-TTIO (MOV-I).
           ADD 1 TO MOV-I.
           GO TO LUP-LIM-VEC-TIO.
       FIN-LIM-VEC-TIO.
           EXIT.
      * RBG/FIN/12-NOV-1997.
      
      ******************************************************************
      * RBG/INI/12-NOV-1997. Cheqeo que exista el TIO de la OPC.
       CHK-EXI-TIO SECTION.
      **********************
       INI-CHK-EXI-TIO.
           MOVE 1 TO MOV-I.
       LUP-CHK-EXI-TIO.
           IF OPC-COD-TOOC IN OPC = WSS-TTIO (MOV-I)
               MOVE 'S' TO WSS-IND-ETIO IN WSS-VARI
           ELSE
               IF MOV-I NOT > 20
                   ADD 1 TO MOV-I
                   GO TO LUP-CHK-EXI-TIO
               ELSE
                   MOVE 'TIOTBLSDMNEX' TO MSG-COD-MENS IN MSG
                   MOVE 'N' TO WSS-IND-ETIO IN WSS-VARI.
       FIN-CHK-EXI-TIO.
           EXIT.
      * RBG/FIN/12-NOV-1997.
      ******************************************************************
      
       CALC-MIN-FEC SECTION.
       INI-CALC-MIN-FEC.
           IF WSS-FEC-FMAV IN WSS-VARI < WSS-FEC-FEC2 IN WSS-VARI
             MOVE WSS-FEC-FMAV IN WSS-VARI TO WSS-FMIN IN WSS-VARI
           ELSE
             MOVE WSS-FEC-FEC2 IN WSS-VARI TO WSS-FMIN IN WSS-VARI.
       FIN-CALC-MIN-FEC.
           EXIT.
      * DPM fin  21-JUN-1995
      
      *ALD-BCI-INI/12.08.1996
      * VAL-SPR-MINI SECTION.
      * INI-VAL-SPR-MINI.
      *     IF SCR-COD-CVTI NOT > SPACES
      *         GO TO FIN-VAL-SPR-MINI.
      *     IF ITR-COD-TINT IN ITR = 'MULTIPLES'
      *         GO TO FIN-VAL-SPR-MINI.
      *     IF ITR-SGV-TINT IN OPC-FLD = ZEROES
      *         IF POC-IND-TICE IN POC = 'S'
      *             GO TO FIN-VAL-SPR-MINI.
      *ojo CON MULTIPLES DEUDORES SOLO OBTIENE BANCA Y CLASIFICACION DEL
      *     MOVE OPC-CAI-IOPC IN OPC-FLD TO RDC-CAI-IOPC IN RDC.
      *     MOVE OPC-IIC-IOPC IN OPC-FLD TO RDC-IIC-IOPC IN RDC.
      *     MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.
      *     MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *     MOVE FIO-GET-NLS TO FIO-CMND.
      *     PERFORM COL-FIO-RDC.
      *     IF FIO-STAT-OKS AND
      *       RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC-FLD AND
      *       RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC-FLD AND
      *       RDC-NUM-IDLC IN RDC = ZEROES
      *         MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
      *         MOVE FIO-GET-KEY TO FIO-CMND
      *         PERFORM SGC-FIO-DBC
      *         IF FIO-STAT-OKS
      *             MOVE DBC-COD-CLCM IN DBC TO PSM-COD-CLCM IN PSM-VARI
      *     IF DBC-IND-TICL IN DBC = 'P'
      *         MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
      *         MOVE FIO-GET-KEY TO FIO-CMND
      *         PERFORM SGC-FIO-DCP
      *         IF FIO-STAT-OKS
      *             MOVE DCP-COD-TBAN IN DCP TO PSM-COD-TBAN IN PSM-VARI
      *     IF DBC-IND-TICL IN DBC NOT = 'P'
      *         MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
      *         MOVE FIO-GET-KEY TO FIO-CMND
      *         PERFORM SGC-FIO-DCE
      *         IF FIO-STAT-OKS
      *             MOVE DCE-COD-TBAN IN DCE TO PSM-COD-TBAN IN PSM-VARI
      
      * Validacion Tasa de Interes contra plantilla PSM
      *     MOVE OPC-COD-OFOC IN OPC      TO PSM-COD-OFOC IN PSM-VARI.
      *     MOVE OPC-COD-VCOC IN OPC      TO PSM-COD-VCOC IN PSM-VARI.
      *     MOVE OPC-COD-TOOC IN OPC      TO PSM-COD-TOOC IN PSM-VARI.
      *     MOVE OPC-COD-AOOC IN OPC      TO PSM-COD-AOOC IN PSM-VARI.
      
      *     MOVE OPC-NUM-DCOL IN OPC      TO PSM-NUM-DTRN IN PSM-VARI.
      *     MOVE OPC-NUM-MCOL IN OPC      TO PSM-NUM-MTRN IN PSM-VARI.
      *     MOVE OPC-NUM-SCOL IN OPC      TO PSM-NUM-STRN IN PSM-VARI.
      *     MOVE OPC-NUM-ACOL IN OPC      TO PSM-NUM-ATRN IN PSM-VARI.
      
      *     MOVE WSS-NUM-DMAV IN WSS-VARI TO PSM-NUM-DTOC IN PSM-VARI.
      *     MOVE WSS-NUM-MMAV IN WSS-VARI TO PSM-NUM-MTOC IN PSM-VARI.
      *     MOVE WSS-NUM-SMAV IN WSS-VARI TO PSM-NUM-STOC IN PSM-VARI.
      *     MOVE WSS-NUM-AMAV IN WSS-VARI TO PSM-NUM-ATOC IN PSM-VARI.
      
      *     MOVE ITR-SGV-TINT IN OPC-FLD  TO PSM-SGV-TINT IN PSM-VARI.
      *     MOVE SCR-COD-TINT             TO PSM-COD-TINT IN PSM-VARI.
      *     MOVE OPC-VAL-SCRE IN OPC      TO PSM-VAL-MCRE IN PSM-VARI.
      *     MOVE POC-IND-TICE IN POC      TO PSM-IND-TICE IN PSM-VARI.
      *     PERFORM COL-VAL-PSM.
      * WSS-ASIGNAR-TASA = 'S' ==> Asignar tasa desde PSM a OPC
      *     IF PSM-COD-MENS IN PSM-VARI > SPACES
      *         MOVE PSM-COD-MENS IN PSM-VARI TO MSG-COD-MENS
      *         MOVE 'COL' TO MSG-COD-SIST
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC IN MSG TO FRM-MEN2.
      *     MOVE SPACES TO MSG-COD-MENS.
      * FIN-VAL-SPR-MINI.
      *     EXIT.
      *ALD-BCI-FIN/12.08.1996
      
      *RRM-INI 21-JUN-1999
       GET-ROV-BALL SECTION.
      *---------------------
       INI-GET-ROV-BALL.
           MOVE 'ROV-KEY-IROV' TO FIO-AKEY.
           MOVE WS1-CIC-IOPC IN WSS-VARI TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES                   TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES                   TO ROV-NUM-IVCT IN ROV.
      *DSP COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
      *DSP COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              ROV-CIC-IOPC IN ROV = WS1-CIC-IOPC IN WSS-VARI
               MOVE SPACES TO MSG-COD-MENS
           ELSE
               MOVE '23' TO FIO-STAT
               MOVE 'ROV    NEX  '      TO MSG-COD-MENS.
       FIN-GET-ROV-BALL.
           EXIT.
       DET-OPC-ORIG-BALL SECTION.
      *--------------------------
       INI-DET-OPC-ORIG-BALL.
           MOVE OPC-CAI-IOPC IN OPC-FLD TO WS1-CAI-IOPC  IN WSS-VARI.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO WS1-IIC-IOPC  IN WSS-VARI.
           MOVE OPC-COD-TOOC IN OPC-FLD TO WSS-TOC-RBL21 IN WSS-VARI.
           MOVE OPC-COD-AOOC IN OPC-FLD TO WSS-AOC-RBL22 IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC     TO WS1-OLD-IOPC  IN WSS-VARI.
           MOVE OPC TO WSS-OPC.
       LOOP-LEE-ROV.
           PERFORM GET-ROV-BALL.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-DET-OPC-ORIG-BALL.
      
           PERFORM LEER-OPC-ROV
           IF MSG-COD-MENS > SPACES
               GO TO FIN-DET-OPC-ORIG-BALL.
      
           IF OPC-IND-RENO IN OPC = SPACES
               MOVE OPC-FEC-FCOL IN OPC TO WS1-OPC-FCOL IN WSS-VARI
               MOVE OPC-COD-COOC IN OPC TO WSS-COD-RBL1 IN WSS-VARI
               GO TO FIN-DET-OPC-ORIG-BALL
           ELSE
               MOVE OPC-CIC-IOPC IN OPC TO WS1-CIC-IOPC IN WSS-VARI
               GO TO LOOP-LEE-ROV.
       FIN-DET-OPC-ORIG-BALL.
           MOVE WS1-OLD-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC.
           EXIT.
       CAL-PLZO-BALL SECTION.
      *----------------------
       INI-CAL-PLZO-BALL.
           PERFORM LEER-DLC-ACT.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-CAL-PLZO-BALL.
      
           PERFORM LEER-TABLA-PRB.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-CAL-PLZO-BALL.
      
           PERFORM DIF-MES-FCOL-FMAV.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-CAL-PLZO-BALL.
      
           IF WSS-NUM-DIFF IN WSS-VARI > WSS-NUM-PLZO IN WSS-VARI
               MOVE 'PZOT>PZOP' TO MSG-COD-MENS
           ELSE
               MOVE  SPACES     TO MSG-COD-MENS.
       FIN-CAL-PLZO-BALL.
           EXIT.
       LEER-DLC-ACT SECTION.
      *---------------------
       INI-LEER-DLC-ACT.
            MOVE OPC-CAI-IOPC IN OPC-FLD TO DLC-CAI-IOPC IN DLC
            MOVE OPC-IIC-IOPC IN OPC-FLD TO DLC-IIC-IOPC IN DLC
            MOVE ZEROES TO DLC-NUM-IDLC IN DLC
            MOVE FIO-GET-NLS TO FIO-CMND
            PERFORM COL-FIO-DLC
            IF NOT (FIO-STAT-OKS AND
               OPC-CAI-IOPC IN OPC-FLD = DLC-CAI-IOPC IN DLC AND
               OPC-IIC-IOPC IN OPC-FLD = DLC-IIC-IOPC IN DLC)
                MOVE 'DLC    NEX  '      TO MSG-COD-MENS
                MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
            ELSE
                MOVE SPACES TO MSG-COD-MENS.
       FIN-LEER-DLC-ACT.
            EXIT.
       DIF-MES-FCOL-FMAV SECTION.
      *--------------------------
       INI-DIF-MES-FVEN-FMAV.
           MOVE SPACES           TO    MSG-COD-MENS.
           MOVE SPACES           TO        FEC-FEC1.
           MOVE SPACES           TO        FEC-FEC2.
      
           MOVE WS1-NUM-DCOL IN WSS-VARI TO FEC-DEC1.
           MOVE WS1-NUM-MCOL IN WSS-VARI TO FEC-MEC1.
           MOVE WS1-NUM-SCOL IN WSS-VARI TO FEC-SEC1.
           MOVE WS1-NUM-ACOL IN WSS-VARI TO FEC-AEC1.
      
           MOVE DLC-NUM-DMAV IN DLC      TO FEC-DEC2.
           MOVE DLC-NUM-MMAV IN DLC      TO FEC-MEC2.
           MOVE DLC-NUM-SMAV IN DLC      TO FEC-SEC2.
           MOVE DLC-NUM-AMAV IN DLC      TO FEC-AEC2.
      
           MOVE FEC-FORM-FEC TO FEC-FORM.
      
      *DIFERENCIA EN DIAS
           IF WSS-IND-TDFE = 'D'
              MOVE FEC-DIF-DIA  TO FEC-CMND
              PERFORM CAL-FEC
              IF NOT FEC-STAT-OKS
                 MOVE FEC-STAT TO MSG-COD-MENS
                 GO TO FIN-DIF-MES-FCOL-FMAV
              ELSE
                 MOVE FEC-NDIA IN FEC-VARI TO WSS-NUM-DIFF IN WSS-VARI
                 GO TO FIN-DIF-MES-FCOL-FMAV.
      
      *DIFERENCIA EN MESES O ANOS
           MOVE FEC-DIF-MES  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
              MOVE FEC-STAT TO MSG-COD-MENS
              GO TO FIN-DIF-MES-FCOL-FMAV.
           IF WSS-IND-TDFE = 'A'
              MOVE ZEROES TO WSS-NUM-FRAC IN WSS-VARI
              DIVIDE FEC-NMES BY 12 GIVING WSS-NUM-DIFF IN WSS-VARI
                                    REMAINDER WSS-NUM-FRAC IN WSS-VARI.
           IF WSS-IND-TDFE = 'M'
              MOVE ZEROES TO WSS-NUM-FRAC IN WSS-VARI
              MOVE FEC-NMES TO WSS-NUM-DIFF IN WSS-VARI.
           IF FEC-NDIA > ZEROES OR WSS-NUM-FRAC IN WSS-VARI > ZEROES
              ADD 1 TO WSS-NUM-DIFF IN WSS-VARI.
      
       FIN-DIF-MES-FCOL-FMAV.
           EXIT.
       LEER-OPC-ROV SECTION.
      *---------------------
       INI-LEER-OPC-ROV.
           MOVE ROV-CIC-IOPV IN ROV TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
                MOVE 'OPC    NEX  '      TO MSG-COD-MENS
                MOVE OPC-CIC-IOPC IN OPC TO FRM-MEN2
            ELSE
                MOVE SPACES TO MSG-COD-MENS.
       FIN-LEER-OPC-ROV.
            EXIT.
       LEER-TABLA-PRB SECTION.
      *-----------------------
       INI-LEER-TABLA-PRB.
           MOVE 'COL'       TO FIO-SIST.
           MOVE 'COL'       TO TAB-COD-SIST.
           MOVE 'PRB'       TO TAB-COD-TTAB.
      
      *PRIMER INTENTO (BUSQUEDA ESPECIFICA)
           MOVE WSS-COD-RBL TO TAB-COD-CTAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE = 'S'
               MOVE TAB-GLS-DATA IN TAB TO WSS-RBL-DATA IN WSS-VARI
               IF WSS-NUM-PLZO IN WSS-VARI NOT NUMERIC OR
                  WSS-NUM-PLZO IN WSS-VARI = ZEROES
                  MOVE 'PLZO NOT NUM' TO MSG-COD-MENS
                   GO TO FIN-LEER-TABLA-PRB
               ELSE
                   IF WSS-IND-TDFE IN WSS-VARI = 'A' OR 'M' OR 'D'
                      MOVE SPACES TO MSG-COD-MENS
                      GO TO FIN-LEER-TABLA-PRB
                   ELSE
                      MOVE 'IND PZO NVAL' TO MSG-COD-MENS
                      GO TO FIN-LEER-TABLA-PRB.
      *SEGUNDO INTENTO (BUSQUEDA GENERAL '*')
           MOVE '*     ' TO WSS-COD-RBL2 IN WSS-VARI.
           MOVE WSS-COD-RBL TO TAB-COD-CTAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE = 'S'
               MOVE TAB-GLS-DATA IN TAB TO WSS-RBL-DATA IN WSS-VARI
               IF WSS-NUM-PLZO IN WSS-VARI NOT NUMERIC OR
                  WSS-NUM-PLZO IN WSS-VARI = ZEROES
                  MOVE 'PLZO NOT NUM' TO MSG-COD-MENS
                   GO TO FIN-LEER-TABLA-PRB
               ELSE
                   IF WSS-IND-TDFE IN WSS-VARI = 'A' OR 'M' OR 'D'
                      MOVE SPACES TO MSG-COD-MENS
                      GO TO FIN-LEER-TABLA-PRB
                   ELSE
                      MOVE 'IND PZO NVAL' TO MSG-COD-MENS
                      GO TO FIN-LEER-TABLA-PRB
           ELSE
               MOVE 'TABLAPRBNEX'  TO MSG-COD-MENS.
       FIN-LEER-TABLA-PRB.
           EXIT.
      ******************************************************************
      * RRM-FIN 21-JUN-1999
      *
      *RVM-CST-INI 6-AUG-1996
       COPY SGCBFDCC REPLACING ==DCC== BY ==SDC==
                      ==ADR-DCC-REQA== BY ==ADR-SDC-REQA==.
      *RVM-CST-FIN 6-AUG-1996
       COPY SGCBGCLI.
       COPY SGCBFDBC.
      * DPM ini  21-JUN-1995
       COPY SGCBFDCP.
      * DPM fin  21-JUN-1995
      *ALD-BCI-INI/12.08.1996
        COPY SGCBFDCE.
      *ALD-BCI-FIN/12.08.1996
      *
      *JGM-BCI
        COPY SGCBFAEP.
      *JGM-BCI
      *
       COPY COLBFCAN.
       COPY COLBFRDC.
       COPY COLBFITR.
       COPY COLBFCOM.
       COPY COLBFCYA.
       COPY COLBFAUT.
       COPY COLBFROV.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFVEN.
       COPY COLBFIMP.
       COPY COLBFICG.
       COPY COLBFNTR.
       COPY COLBFTOC.
       COPY COLBFPOC.
      *ALD-BCI-INI/12.08.1996
      * COPY COLBFPSM.
      *ALD-BCI-FIN/12.08.1996
      *
      *ALD-BCI-INI/12.08.1996
      * COPY COLBGPSM.
      * COPY COLBVPSM.
      *ALD-BCI-FIN/12.08.1996
       COPY COLBGUVD.
       COPY COLBGRNO.
      *
       COPY COLBGCLI.
       COPY COLBGVIN.
      *
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBVIND.
       COPY GNSBVMSC.
      *
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY GNSBGCVI.
      *
      *PTC ini
       COPY GNSBGQUE.
      *PTC fin
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBFTAB.
      *ALD/22-AUG-1988
       COPY GNSBGCAM.
       COPY GNSBGPES.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBVNUM.
      *
       COPY TABBBOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBFUSR.
      *ALD/22-AUG-1988
       COPY TABBFCAM.
       COPY TABBVTDU.
       COPY TABBVOFI.
       COPY TABBVUSR.
      *
       COPY SGCBGDOM.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY SGCBFRCD.
      * RBG INI 27-DEC-1995
       COPY COLBGCLM.
      * RBG FIN 27-DEC-1995
      *>>>>
      
