       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   COLPPACA.
       AUTHOR.       CONSIST.
       DATE-WRITTEN. 28-APR-89 20:15 PM.
      * ACTUALIZA ARCHIVO COLOPC EN FORMA INTERACTIVA.
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============
       WORKING-STORAGE SECTION.
      *------------------------
       COPY COLWIOPC.
       COPY COLBROPC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWGSCR.
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MITR                         PIC X(01).
           02 SCR-IND-MCOM                         PIC X(01).
           02 SCR-IND-MCYA                         PIC X(01).
      *>>>>
       COPY GNSWGSYS.
      *<<<< WSS
       01  WSS-VARI.
      *ALD/22-AUG-1988
           03  WSS-I                              PIC 9(02).
           03  WSS-NUM-DIGT                       PIC 9(02).
           03  WSS-COD-DIGT                       PIC X(02).
           03  WSS-MEN2.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-NUM-VAL1-EDT                   PIC ----.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-IND-DMA1                      PIC X(01).
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-GLS-GUI2                      PIC X(01).
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-NUM-VAL2-EDT                   PIC ----.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-IND-DMA2                      PIC X(01).
           03  WSS-NUM-ACTI                       PIC 9(01).
           03  WSS-NUM-COTO                       PIC 9(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03  WSS-NUM-TVEN                       PIC 9(03).
           03  WSS-VAL-TEVC             COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-TCAP             COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-TVEN             COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-NDLC             COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-PDIR             COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-PIND             COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-FALF                   PIC  --.---.--9,99999.
           03  WSS-NUM-FEDT                   PIC  --.---.--9,99999.
           03  WSS-VAL-CRED   COMP-3 VALUE ZEROES PIC 9(11)V9(04).
           03  WSS-IND-TMON          VALUE SPACES PIC X(01).
           03  WSS-IND-TMMN          VALUE 'N'    PIC X(01).
           03  WSS-IND-TMMX          VALUE 'E'    PIC X(01).
      *
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-CIC-IMPU                       PIC X(04).
           03  WSS-VAL-IMPU   COMP-3 VALUE 0      PIC 9(11)V9(04).
           03  WSS-AUX-IMPU   COMP-3 VALUE 0      PIC 9(11)V9(04).
           03  WSS-VAL-GNOT   COMP-3 VALUE 0      PIC 9(11)V9(04).
           03  WSS-SGV-LIQU          VALUE +0     PIC S9(13)V9(05)
                                     SIGN LEADING SEPARATE.
           03  WSS-SGV-LIQU-ALF                   PIC X(24).
           03  WSS-SGV-LIQU-EDT REDEFINES WSS-SGV-LIQU-ALF
                                     PIC --.---.---.---.---,-----.
           03  WSS-NUM-TABN          VALUE 0      PIC 9(03).
           03  WSS-NUM-TABZ          VALUE 0      PIC 9(03).
           03  WSS-INTR                           PIC X(01).
           03  WSS-KEY-ICYA.
               05  WSS-CIC-IOPC                   PIC X(12).
               05  WSS-NUM-ICAN                   PIC X(03).
               05  WSS-NUM-ICYA                   PIC 9(01).
      *    03  WSS-KEY-IEVC                       PIC X(15).
           03  WSS-FEC-FPVC VALUE ZEROES.
               05  WSS-NUM-SPVC                   PIC 9(02).
               05  WSS-NUM-APVC                   PIC 9(02).
               05  WSS-NUM-MPVC                   PIC 9(02).
               05  WSS-NUM-DPVC                   PIC 9(02).
           03  WSS-FEC-FIMV VALUE ZEROES.
               05  WSS-NUM-SIMV                   PIC 9(02).
               05  WSS-NUM-AIMV                   PIC 9(02).
               05  WSS-NUM-MIMV                   PIC 9(02).
               05  WSS-NUM-DIMV                   PIC 9(02).
           03  WSS-MSC-TCVE                       PIC X(02).
           03  WSS-PESO                 VALUE ' ' PIC X(01).
               88 WSS-PESO-SI           VALUE 'S'.
               88 WSS-PESO-NO           VALUE 'N'.
      *
           03  WSS-NUM-VCVG                       PIC 9(03).
      *    03  WSS-AEVC                           PIC X(105).
           03  WSS-AXSV                           PIC 9(04).
           03  WSS-AXUS                           PIC X(01).
           03  WSS-EEVC       OCCURS 50.
               05  WSS-REVC                       PIC X(105).
               05  WSS-SPVE                       PIC 9(04).
               05  WSS-UTPV                       PIC X(01).
               05  WSS-SEVE                       PIC 9(04).
               05  WSS-UTSV                       PIC X(01).
               05  WSS-VIGU                       PIC 9(03).
               05  WSS-FPVC.
                   07  WSS-SPVC                   PIC 9(02).
                   07  WSS-APVC                   PIC 9(02).
                   07  WSS-MPVC                   PIC 9(02).
                   07  WSS-DPVC                   PIC 9(02).
               05  WSS-FFPV.
                   07  WSS-SFPV                   PIC 9(02).
                   07  WSS-AFPV                   PIC 9(02).
                   07  WSS-MFPV                   PIC 9(02).
                   07  WSS-DFPV                   PIC 9(02).
               05  WSS-DVEN                       PIC 9(02).
           03  WSS-LEFO                 VALUE  50 PIC 9(02).
           03  WSS-MEFO                           PIC 9(02).
           03  WSS-FAVC.
               05  WSS-SAVC                       PIC 9(02).
               05  WSS-AAVC                       PIC 9(02).
               05  WSS-MAVC                       PIC 9(02).
               05  WSS-DAVC                       PIC 9(02).
           03  WSS-FMVC.
               05  WSS-SMVC                       PIC 9(02).
               05  WSS-AMVC                       PIC 9(02).
               05  WSS-MMVC                       PIC 9(02).
               05  WSS-DMVC                       PIC 9(02).
           03  WSS-IMVC                           PIC 9(02).
      *
           03  WSS-USEP                           PIC X(01).
           03  WSS-VSEP                      COMP PIC 9(04).
           03  WSS-FVNC.
               05  WSS-SVNC                       PIC 9(02).
               05  WSS-AVNC                       PIC 9(02).
               05  WSS-MVNC                       PIC 9(02).
               05  WSS-DVNC                       PIC 9(02).
           03  WSS-FMIV.
               05  WSS-SMIV                       PIC 9(02).
               05  WSS-AMIV                       PIC 9(02).
               05  WSS-MMIV                       PIC 9(02).
               05  WSS-DMIV                       PIC 9(02).
           03  WSS-FMAV.
               05  WSS-SMAV                       PIC 9(02).
               05  WSS-AMAV                       PIC 9(02).
               05  WSS-MMAV                       PIC 9(02).
               05  WSS-DMAV                       PIC 9(02).
           03  WSS-NEEV                      COMP PIC 9(04).
           03  WSS-FPPC.
               05  WSS-SPPC                       PIC 9(02).
               05  WSS-APPC                       PIC 9(02).
               05  WSS-MPPC                       PIC 9(02).
               05  WSS-DPPC                       PIC 9(02).
           03  WSS-FPPI.
               05  WSS-SPPI                       PIC 9(02).
               05  WSS-APPI                       PIC 9(02).
               05  WSS-MPPI                       PIC 9(02).
               05  WSS-DPPI                       PIC 9(02).
           03  WSS-FIPC.
               05  WSS-SIPC                       PIC 9(02).
               05  WSS-AIPC                       PIC 9(02).
               05  WSS-MIPC                       PIC 9(02).
               05  WSS-DIPC                       PIC 9(02).
           03  WSS-FSPC.
               05  WSS-SSPC                       PIC 9(02).
               05  WSS-ASPC                       PIC 9(02).
               05  WSS-MSPC                       PIC 9(02).
               05  WSS-DSPC                       PIC 9(02).
           03  WSS-FIPI.
               05  WSS-SIPI                       PIC 9(02).
               05  WSS-AIPI                       PIC 9(02).
               05  WSS-MIPI                       PIC 9(02).
               05  WSS-DIPI                       PIC 9(02).
           03  WSS-FSPI.
               05  WSS-SSPI                       PIC 9(02).
               05  WSS-ASPI                       PIC 9(02).
               05  WSS-MSPI                       PIC 9(02).
               05  WSS-DSPI                       PIC 9(02).
           03  WSS-FUVC.
               05  WSS-SUVC                       PIC 9(02).
               05  WSS-AUVC                       PIC 9(02).
               05  WSS-MUVC                       PIC 9(02).
               05  WSS-DUVC                       PIC 9(02).
           03  WSS-NEUV                           PIC 9(03).
           03  WSS-IVUV              VALUE SPACES PIC X(01).
               88 WSS-ULTIMO-VENC-EN-ZERO VALUE 'Z'.
           03  WSS-EPOC              VALUE 'N'    PIC X(01).
           03  WSS-OPEC                           PIC X(08).
      *JSS
           03  WSS-VEDT-ALF                       PIC X(24).
           03  WSS-VEDT-EDT REDEFINES WSS-VEDT-ALF
                                     PIC --.---.---.---.---,-----.
      *JSS-NEW
           03  WSS-LEVC COMP             VALUE 10 PIC 9(02).
           03  WSS-MEVC COMP             VALUE 0  PIC 9(02).
           03  WSS-IEVC COMP             VALUE 0  PIC 9(02).
           03  WSS-EVC1 COMP             VALUE 0  PIC 9(02).
           03  WSS-TCFO COMP             VALUE 0  PIC 9(02).
           03  WSS-TCCO COMP             VALUE 0  PIC 9(02).
           03  WSS-VCVC OCCURS 10.
               05  WSS-BCCR                       PIC X(01).
               05  WSS-VICR                       PIC X(01).
           03  WSS-FMIN.
               05  WSS-SMIN                       PIC 9(02).
               05  WSS-AMIN                       PIC 9(02).
               05  WSS-MMIN                       PIC 9(02).
               05  WSS-DMIN                       PIC 9(02).
           03  WSS-J                              PIC 9(02).
           03  WSS-K                              PIC 9(02).
       01  REG.
           02 REG-FILL                            PIC X(01).
       COPY COLBREVC REPLACING ==01  EVC.== BY
                               ==02 REG-EVC OCCURS 10.==.
      *JSS-NEW
      *JSS-TRC
      * COPY GNSWGDSP.
      *JSS
       01  SCR-INST-BRW              VALUE 'BRW'  PIC X(03).
      *
      *Registros de GENESIS
       COPY GNSBRTAB.
      *Registros de TABLAS
      *Registros de Colocaciones
       COPY COLBRRDC.
       COPY COLBRITR.
       COPY COLBRCYA.
       COPY COLBRDLC.
       COPY COLBRCAM.
       COPY COLBREVC.
       COPY COLBRVEN.
       COPY COLBRIMP.
       COPY COLBRICG.
       COPY COLBRNTR.
       COPY COLBRTOC.
      *
       COPY COLWGUVD.
      *
       COPY GNSWGFEC.
       COPY GNSWGHOY.
      *
       COPY GNSWGIDC.
      *
       COPY GNSWGINT.
       COPY GNSWGCVI.
      *
       COPY GNSWGPES.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY SGCBRRCD.
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IMP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-NTR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICKY                 VALUE 0 PIC 9(01).
              88 PGM-LIMPIAR-LLAVES    VALUE 0.
              88 PGM-NO-LIMPIAR-LLAVES VALUE 1.
           03 PGM-STAT.
              05 PGM-STAT-OPC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-OPC-OKS    VALUE '00'.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
              05 PGM-STAT-RDC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RDC-OKS    VALUE '00'.
                 88 PGM-STAT-RDC-NUL    VALUE '  '.
              05 PGM-STAT-RCD           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RCD-OKS    VALUE '00'.
                 88 PGM-STAT-RCD-NUL    VALUE '  '.
              05 PGM-STAT-ITR           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ITR-OKS    VALUE '00'.
                 88 PGM-STAT-ITR-NUL    VALUE '  '.
              05 PGM-STAT-CYA           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CYA-OKS    VALUE '00'.
                 88 PGM-STAT-CYA-NUL    VALUE '  '.
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
       COPY GNSLGFIO.
       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       FIN-MAIN.
           EXIT.
       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
       COPY GNSBGCMA.
           MOVE 'COLPPACA' TO FIO-PROG.
      *<<<< INI_FIO
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
                              SCR-RQA2.
      *>>>>
       FIN-INI.
           EXIT.
       SCR-ACC SECTION.
       INI-SCR-ACC.
           PERFORM CMN-ACC.
       FIN-SCR-ACC.
           EXIT.
       CMN-ACC SECTION.
       INI-CMN-ACC.
           MOVE SPACES TO WSS-OPEC.
           IF OPC-SGV-LIQU IN OPC-FLD NOT > ZEROES
               MOVE OPC-COD-TOOC IN OPC-FLD TO TOC-COD-TOCR IN TOC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-TOC
               IF NOT FIO-STAT-OKS
                   MOVE 'OPCTOOCNEX'        TO MSG-COD-MENS
                   MOVE TOC-COD-TOCR IN TOC TO FRM-MEN2
                   GO TO MSG-CMN-ACC
               ELSE
                   MOVE 'COL'               TO MSC-COD-SIST FIO-SIST
                   MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC
                   MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-MSC
                   IF NOT FIO-STAT-OKS
                       MOVE 'TOCOPECNEX'        TO MSG-COD-MENS
                       MOVE MSC-COD-TABL IN MSC TO FRM-MEN2
                       GO TO MSG-CMN-ACC
                   ELSE
                       MOVE MSC-CIC-CMSC IN MSC TO WSS-OPEC.
           MOVE 'TAB'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'  TO TAB-CIC-TTAB IN TAB.
           MOVE '0999' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               MOVE 'VLRCICN0999' TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.
           IF OPC-COD-VCOC IN OPC-FLD = TAB-COD-CTAB IN TAB
               MOVE 'S' TO WSS-PESO
           ELSE
               MOVE 'N' TO WSS-PESO.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 0 TO WSS-NUM-TABN.
           MOVE 0 TO WSS-NUM-TABZ.
           MOVE OPC-CAI-IOPC IN OPC-FLD TO CYA-CAI-IOPC IN CYA.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO CYA-IIC-IOPC IN CYA.
           MOVE ZEROES                  TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES                  TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee cada CYA ( ABONO )
       LUP-CMN-ACC.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
               CYA-CAI-IOPC IN CYA = OPC-CAI-IOPC IN OPC-FLD AND
               CYA-IIC-IOPC IN CYA = OPC-IIC-IOPC IN OPC-FLD AND
               CYA-NUM-ICAN IN CYA = ZEROES )
               GO TO ACT-CMN-ACC.
           ADD 1 TO WSS-NUM-TABN.
      *Acumula el valor liquido ( > 0 ) del CYA en particular
           IF CYA-SGV-LIQU IN CYA NOT > ZEROES OR
              CYA-IND-FREE IN CYA = 'S'
               MOVE CYA-KEY-ICYA IN CYA TO WSS-KEY-ICYA IN WSS-VARI
               ADD 1 TO WSS-NUM-TABZ
           ELSE
               ADD CYA-SGV-LIQU IN CYA TO WSS-SGV-LIQU IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CMN-ACC.
       ACT-CMN-ACC.
           IF WSS-NUM-TABN = ZEROES
               MOVE 'CYA    NOABN' TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.
           IF WSS-NUM-TABZ NOT = 1
               MOVE 'CYA    ABNN1' TO MSG-COD-MENS
               MOVE WSS-NUM-TABZ   TO FRM-MEN2
               GO TO MSG-CMN-ACC.
      *ALD
      *     MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
      *     MOVE '0'    TO MSC-CIC-CMSC IN MSC.
      *     MOVE 'TAB' TO FIO-SIST.
      *     MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM GNS-FIO-MSC.
      *     IF NOT FIO-STAT-OKS
      *         MOVE SPACES TO MSC-COD-CMSC IN MSC.
      *     MOVE WSS-IND-TMMX IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI.
      *     IF OPC-MSC-TVOC IN OPC-FLD = MSC-COD-CMSC IN MSC
      *         MOVE WSS-IND-TMMN IN WSS-VARI TO WSS-IND-TMON IN WSS-VAR
      *         MOVE OPC-COD-VCOC IN OPC-FLD TO TAB-COD-CTAB IN TAB
      *         MOVE '0999  '                TO TAB-CIC-CTAB IN TAB
      *         MOVE OPC-NUM-DCOL IN OPC-FLD TO TAB-NUM-DTRN IN TAB
      *         MOVE OPC-NUM-MCOL IN OPC-FLD TO TAB-NUM-MTRN IN TAB
      *         MOVE OPC-NUM-SCOL IN OPC-FLD TO TAB-NUM-STRN IN TAB
      *         MOVE OPC-NUM-ACOL IN OPC-FLD TO TAB-NUM-ATRN IN TAB
      *         PERFORM GET-VCAM
      *         IF MSG-COD-MENS IN MSG NOT > SPACES
      *             MULTIPLY CAM-SGV-VCAM IN CAM BY WSS-SGV-LIQU IN
      *                    WSS-VARI GIVING WSS-SGV-LIQU IN WSS-VARI
      *         ELSE
      *             IF MSG-COD-MENS IN MSG = 'CODVCAMEQL'
      *                 MOVE 1 TO CAM-SGV-VCAM IN CAM
      *                 MOVE SPACES TO MSG-COD-MENS IN MSG
      *             ELSE
      *                 GO TO MSG-CMN-ACC.
      *
           IF WSS-SGV-LIQU IN WSS-VARI > OPC-SGV-LIQU IN OPC-FLD
               IF NOT ( OPC-SGV-LIQU IN OPC-FLD NOT > ZEROES AND
                        WSS-OPEC = 'B' )
                   MOVE 'OPCLIQUSABN<' TO MSG-COD-MENS
                   MOVE WSS-SGV-LIQU TO WSS-SGV-LIQU-EDT
                   MOVE WSS-SGV-LIQU-ALF TO FRM-MEN2
                   GO TO MSG-CMN-ACC.
           MOVE WSS-KEY-ICYA IN WSS-VARI TO CYA-KEY-ICYA IN CYA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 'CYA    NGKUP' TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.
           SUBTRACT WSS-SGV-LIQU IN WSS-VARI FROM
                    OPC-SGV-LIQU IN OPC-FLD  GIVING CYA-SGV-LIQU IN CYA.
      *ALD
      *     IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
      *         DIVIDE CYA-SGV-LIQU IN CYA BY CAM-SGV-VCAM IN CAM
      *                GIVING CYA-SGV-LIQU IN CYA ROUNDED.
      *
           MOVE 'S' TO CYA-IND-FREE IN CYA.
           PERFORM GET-FHOY.
      *     MOVE HOY-STP-ITRN TO CYA-STP-IINV IN CYA.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 'CYA    NGKUP' TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.
           PERFORM KEY-OPC-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.
           PERFORM RET-OPC-OPC.
           MOVE 'L' TO OPC-MSC-STAT IN OPC.
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO OPC-STP-ITRN IN OPC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               GO TO MSG-CMN-ACC.
      *JSS-NEW
           PERFORM BUS-REVC.
           IF MSG-COD-MENS > SPACES
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO MSG-CMN-ACC.
           PERFORM DET-OEVC.
           MOVE EVC-FEC-FPVC IN REG-EVC(WSS-EVC1) TO
                                WSS-FEC-FPVC IN WSS-VARI.
      *JSS-NEW
           IF OPC-IND-AFER IN OPC-FLD = 'N'
               GO TO MRA-CMN-ACC.
           MOVE WSS-NUM-DPVC IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MPVC IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SPVC IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-APVC IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
               MOVE FEC-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.
           IF FEC-STAT-FER
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-SIG-HBL  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-OKS
                   MOVE FEC-ITM1 TO WSS-NUM-DPVC IN WSS-VARI
                   MOVE FEC-ITM2 TO WSS-NUM-MPVC IN WSS-VARI
                   MOVE FEC-ITM3 TO WSS-NUM-SPVC IN WSS-VARI
                   MOVE FEC-ITM4 TO WSS-NUM-APVC IN WSS-VARI
               ELSE
                   MOVE FEC-MENS TO FRM-MENS
                   MOVE FIO-BCK-OUT TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   GO TO FIN-CMN-ACC.
       MRA-CMN-ACC.
           MOVE WSS-NUM-DPVC IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MPVC IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SPVC IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-APVC IN WSS-VARI TO FEC-ITM4.
           MOVE EVC-NUM-DESD IN EVC      TO FEC-NDIA.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           IF EVC-NUM-DESD IN EVC NOT > 0
               IF OPC-IND-AFER IN OPC-FLD = 'N'
                   MOVE 1 TO FEC-NDIA
                   MOVE FEC-SUM-DIA TO FEC-CMND
               ELSE
                   MOVE FEC-SIG-HBL TO FEC-CMND
           ELSE
               MOVE FEC-SUM-DIA TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FEC-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.
           IF ( EVC-NUM-DESD IN EVC     NOT > 0   ) AND
              ( OPC-IND-AFER IN OPC-FLD NOT = 'N' )
               GO TO IMV-CMN-ACC.
           MOVE FEC-VHBL-S  TO FEC-VHBL.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
               MOVE FEC-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.
           IF FEC-STAT-FER
               MOVE FEC-SIG-HBL TO FEC-CMND
               PERFORM PRO-FEC
               IF NOT FEC-STAT-OKS
                   MOVE FEC-MENS TO FRM-MENS
                   MOVE FIO-BCK-OUT TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   GO TO FIN-CMN-ACC.
       IMV-CMN-ACC.
           MOVE FEC-ITM1 TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-AIMV IN WSS-VARI.
       VEN-CMN-ACC.
      *JSS-NEW
           MOVE 0 TO WSS-IEVC.
       NXT-CMN-ACC.
           ADD 1 TO WSS-IEVC.
           IF WSS-IEVC > WSS-MEVC
               GO TO UVN-CMN-ACC.
           IF WSS-IEVC = WSS-EVC1
               GO TO NXT-CMN-ACC.
           MOVE REG-EVC(WSS-IEVC) TO EVC.
           PERFORM PRO-VFIN-REVC.
           IF INT-CMSG > SPACES
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               MOVE INT-CMSG TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.
           GO TO NXT-CMN-ACC.
       UVN-CMN-ACC.
      * SE PROCESA AL FINAL LA ESTRUCTURA 1
           MOVE WSS-EVC1 TO WSS-IEVC.
           MOVE REG-EVC(WSS-EVC1) TO EVC.
           PERFORM PRO-VFIN-REVC.
           IF INT-CMSG > SPACES
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               MOVE INT-CMSG TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.
           IF WSS-TCFO > 0
               ADD 1 WSS-TCFO GIVING WSS-IEVC
               PERFORM ACT-EVFO VARYING WSS-IEVC FROM WSS-IEVC BY 1
                                UNTIL   WSS-IEVC > WSS-MEVC.
           IF WSS-TCCO > 0
               ADD 1 WSS-TCCO GIVING WSS-IEVC
               PERFORM ACT-EVCO VARYING WSS-IEVC FROM WSS-IEVC BY 1
                                UNTIL   WSS-IEVC > WSS-MEVC.
           MOVE REG-EVC(WSS-EVC1) TO EVC.
      *JSS-NEW
      *JSS-TRC
      *     PERFORM DSP-VFIN.
      *
           MOVE OPC-CAI-IOPC IN OPC-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE 1                       TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               MOVE FIO-PUT TO FIO-CMND.
           MOVE WSS-FEC-FPVC IN WSS-VARI TO VEN-FEC-FVEN IN VEN.
           MOVE WSS-FEC-FIMV IN WSS-VARI TO VEN-FEC-FIMV IN VEN.
      *Si es Boleta de garantia se debe mover 0 al valor capital del
      *vencimiento.
           IF WSS-OPEC = 'B'
               MOVE 0 TO VEN-VAL-CAPI IN VEN
           ELSE
           IF WSS-PESO-SI
               MOVE CVI-VCAP TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-CAPI IN VEN
           ELSE
               MOVE CVI-VCAP TO VEN-VAL-CAPI IN VEN.
           MOVE VEN-VAL-CAPI IN VEN      TO VEN-VAL-SCAP IN VEN.
      *JSS Pendiente
           MOVE ZEROES                   TO VEN-VAL-IDNI IN VEN.
      *
           IF WSS-PESO-SI
               MOVE CVI-VFIN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-FINA IN VEN
           ELSE
               MOVE CVI-VFIN TO VEN-VAL-FINA IN VEN.
           MOVE VEN-VAL-FINA IN VEN      TO VEN-VAL-SFIN IN VEN.
           MOVE SPACES                   TO VEN-IND-SCTB IN VEN.
           MOVE 1                        TO VEN-NUM-IVCT IN VEN.
           MOVE EVC-NUM-IEVC IN EVC      TO VEN-NUM-IEVC IN VEN.
           MOVE EVC-NUM-IDLC IN EVC      TO VEN-NUM-IDLC IN VEN.
           MOVE SPACES                   TO VEN-IND-SCBZ IN VEN.
           MOVE EVC-IND-CAUT IN EVC      TO VEN-IND-CAUT IN VEN.
      *     MOVE SPACES                   TO VEN-GLS-DISP IN VEN.
      *     PERFORM GET-FHOY.
      *     MOVE HOY-STP-ITRN TO VEN-STP-IINV IN VEN.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.
           MOVE OPC-CAI-IOPC IN OPC-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN     TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.
           SUBTRACT VEN-VAL-CAPI IN VEN FROM DLC-VAL-SDLC IN DLC
             GIVING DLC-VAL-SCPA IN DLC.
           MOVE     VEN-FEC-FVEN IN VEN TO   DLC-FEC-FAMT IN DLC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.
      *JSS-NEW
           MOVE 0 TO WSS-IEVC.
       UEV-CMN-ACC.
           ADD 1 TO WSS-IEVC.
           IF WSS-IEVC > WSS-MEVC
               GO TO MSG-CMN-ACC.
           MOVE REG-EVC(WSS-IEVC) TO EVC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               MOVE 'UEVEVC NOGKU' TO MSG-COD-MENS
               MOVE EVC-KEY-IEVC IN EVC TO FRM-MEN2
               GO TO MSG-CMN-ACC.
           MOVE REG-EVC(WSS-IEVC) TO EVC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               MOVE 'UEVEVC NOMOD' TO MSG-COD-MENS
               MOVE EVC-KEY-IEVC IN EVC TO FRM-MEN2
               GO TO MSG-CMN-ACC.
           GO TO UEV-CMN-ACC.
      *JSS-NEW
       MSG-CMN-ACC.
           IF MSG-COD-MENS NOT > SPACES
               MOVE 'OPC    SILIQ' TO MSG-COD-MENS.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           IF MSG-COD-MENS = 'OPC    SILIQ'
               PERFORM PRO-OPC.
           GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM KEY-OPC-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
      *    PERFORM RET-ALL-OPC.
       FIN-CMN-ACC.
           EXIT.
       COPY COLBFOPC.
       COPY GNSBFMSC.
       COPY GNSBFMSG.
       COPY GNSBECIC.
       COPY GNSBGSYS.
       COPY GNSBGVSM.
       COPY GNSBGDTC.
       COPY GNSBGFRM.
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
      *<<<< EOF
      *
       PRO-OPC SECTION.
       INI-PRO-OPC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
                    RDC-NUM-IDLC IN RDC = ZEROES )
               GO TO FIN-PRO-OPC.
       LUP-INP-OPC.
           MOVE ADR-RDC-REQA TO ADR-AUX-REQA.
           MOVE RDC-CIC-ICLI IN RDC TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE SPACES TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-NXT-RDC.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO LUP-NXT-OPC.
           IF WSS-CIC-ICLI IN WSS-VARI NOT = RDC-CIC-ICLI IN RDC
               GO TO LUP-NXT-OPC.
           IF RDC-NUM-IDLC IN RDC > ZEROES OR
              WSS-CIC-IOPC IN WSS-VARI = RDC-CIC-IOPC IN RDC
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-NXT-RDC.
           MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC
           IF FIO-STAT-OKS AND
              ( OPC-MSC-STAT = 'M' OR
                OPC-MSC-STAT = 'I' OR
                OPC-MSC-STAT NOT > SPACES )
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CLI    NOVRF' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DCOR
                      OPC-CIC-IOPC IN OPC DELIMITED BY SIZE
               INTO FRM-MEN2
               GO TO FIN-PRO-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-NXT-RDC.
       LUP-NXT-OPC.
           MOVE ADR-AUX-REQA TO ADR-RDC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = WSS-CIC-IOPC IN WSS-VARI AND
              RDC-NUM-IDLC IN RDC = ZEROES
               GO TO LUP-INP-OPC.
       FIN-PRO-OPC.
           EXIT.
      *Busca Registros EVC.
       BUS-REVC SECTION.
       INI-BUS-REVC.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 0 TO WSS-IEVC.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-REVC.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CIC-IOPC IN EVC = OPC-CIC-IOPC IN OPC )
               GO TO FIN-BUS-REVC.
           ADD 1 TO WSS-IEVC.
           IF WSS-IEVC > WSS-LEVC
               MOVE 'EVCIEVCOVFLW' TO MSG-COD-MENS
               GO TO FIN-BUS-REVC.
           MOVE EVC TO REG-EVC(WSS-IEVC).
           MOVE 0   TO EVC-NUM-IVCT IN REG-EVC(WSS-IEVC).
      *Busca el CIC de EVC-MSC-TCVE en TAB CVC ( en sist COL )
           MOVE 'COL' TO TAB-COD-SIST FIO-SIST.
           MOVE 'CVC' TO TAB-COD-TTAB IN TAB.
           MOVE EVC-MSC-TCVE IN EVC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CICTCVENEX' TO MSG-COD-MENS
               MOVE TAB-COD-TABL TO FRM-MEN2
               GO TO FIN-BUS-REVC.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-VCVC(WSS-IEVC).
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-REVC.
       FIN-BUS-REVC.
           MOVE WSS-IEVC TO WSS-MEVC.
       EXT-BUS-REVC.
           EXIT.
      *Determina EVC-NUM-IVCT orden de EVC
       DET-OEVC SECTION.
       INI-DET-OEVC.
           MOVE 0 TO WSS-I.
       NXI-DET-OEVC.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-MEVC
               GO TO FIN-DET-OEVC.
           MOVE '999999999' TO WSS-FMIN.
           MOVE 0 TO WSS-J.
       NXJ-DET-OEVC.
           ADD 1 TO WSS-J.
           IF WSS-J > WSS-MEVC
               MOVE WSS-I TO EVC-NUM-IVCT IN REG-EVC(WSS-K)
               IF WSS-I = 1
                   MOVE WSS-K TO WSS-EVC1
                   GO TO NXI-DET-OEVC
               ELSE
                   GO TO NXI-DET-OEVC.
           IF EVC-NUM-IVCT IN REG-EVC(WSS-J) > ZEROES
               GO TO NXJ-DET-OEVC.
           IF EVC-FEC-FPVC IN REG-EVC(WSS-J) < WSS-FMIN
               MOVE EVC-FEC-FPVC IN REG-EVC(WSS-J) TO WSS-FMIN
               MOVE WSS-J TO WSS-K.
           GO TO NXJ-DET-OEVC.
       FIN-DET-OEVC.
           EXIT.
       PRO-VFIN-REVC SECTION.
       INI-PRO-VFIN-REVC.
           MOVE WSS-VCVC(WSS-IEVC) TO WSS-MSC-TCVE IN WSS-VARI.
           IF WSS-MSC-TCVE = 'CO'
               IF WSS-TCCO > ZEROES
                   GO TO FIN-PRO-VFIN-REVC
               ELSE
                   MOVE WSS-IEVC TO WSS-TCCO
           ELSE
           IF WSS-MSC-TCVE = 'FO'
               IF WSS-TCFO > ZEROES
                   GO TO FIN-PRO-VFIN-REVC
               ELSE
                   MOVE WSS-IEVC TO WSS-TCFO.
           PERFORM PRO-VFIN.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-VFIN-REVC.
           IF WSS-PESO-SI
               MOVE CVI-VFIN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CVI-VFIN.
      *Si es boleta de garantia se debe mover el valor capital de la
      *operacion al VCVF del vencimiento
           IF WSS-OPEC = 'B'
               MOVE OPC-VAL-CRED IN OPC-FLD TO
                                EVC-VAL-VCVF IN REG-EVC(WSS-IEVC)
           ELSE
           IF ( WSS-BCCR(WSS-IEVC) = 'F' ) OR
              ( WSS-VICR(WSS-IEVC) = 'F' )
               MOVE CVI-VFIN TO EVC-VAL-VCVF IN REG-EVC(WSS-IEVC)
           ELSE
               MOVE CVI-VCAP TO EVC-VAL-VCVF IN REG-EVC(WSS-IEVC).
       FIN-PRO-VFIN-REVC.
           EXIT.
       ACT-EVCO SECTION.
       INI-ACT-EVCO.
           IF WSS-VCVC(WSS-IEVC) = 'CO'
               MOVE EVC-VAL-VCVF IN REG-EVC(WSS-TCCO) TO
                    EVC-VAL-VCVF IN REG-EVC(WSS-IEVC).
       FIN-ACT-EVCO.
           EXIT.
       ACT-EVFO SECTION.
       INI-ACT-EVFO.
           IF WSS-VCVC(WSS-IEVC) = 'FO'
               MOVE EVC-VAL-VCVF IN REG-EVC(WSS-TCFO) TO
                    EVC-VAL-VCVF IN REG-EVC(WSS-IEVC).
       FIN-ACT-EVFO.
           EXIT.
       PRO-VFIN SECTION.
       INI-PRO-VFIN.
      ******************************************************************
      * Se debe aceptar
      * INT-TIPT Tipo Tasa --> X X X X XXX X XXX X
      * INT-TINT Tasa Interes Informada
      * INT-FINT Fecha del Interes
      * INT-FINI Fecha Inicio
      * INT-NVVG Numero Cuotas Iguales
      * INT-SEPA Separacion
      * INT-USPA Unidad de separacion
      * INT-AFER Indicador Analisis de Feriados
      * INT-IBEG Indicador de comienzo del periodo
      * INT-VCAM Valor de Cambio
      * INT-OPEC Opera Como (P,C,D,B)
      * CVI-VFIN Valor Final ( Cap + Rea + Int ) ( si INT-OPEC = 'D' )
      * CVI-VCAP Valor Capital                   ( si INT-OPEC NOT = 'D'
      ******************************************************************
           MOVE ZEROES TO CVI-VFIN CVI-VCAP.
           MOVE OPC-CAI-IOPC IN OPC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES                  TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES                  TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES                  TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'                   TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES                  TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN OPC-FLD AND
                    ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN OPC-FLD AND
                    ICG-NUM-ICAN IN ICG = ZEROES AND
                    ICG-CIC-IOPV IN ICG = SPACES AND
                    ICG-NUM-IVCT IN ICG = ZEROES AND
                    ICG-IND-TTAS IN ICG = 'INT' )
                MOVE 'ICG    NEX' TO MSG-COD-MENS
                GO TO FIN-PRO-VFIN.
           MOVE OPC-COD-TOOC IN OPC-FLD TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPCTOOCNEX' TO MSG-COD-MENS
               MOVE TOC-COD-TOCR IN TOC TO FRM-MEN2
               GO TO FIN-PRO-VFIN.
           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'TOCOPECNEX' TO MSG-COD-MENS
               MOVE MSC-COD-TABL IN MSC TO FRM-MEN2
               GO TO FIN-PRO-VFIN.
           MOVE MSC-CIC-CMSC IN MSC TO TOC-MSC-OPEC IN TOC.
      ******************************************************************
           MOVE SPACES TO MSG-COD-MENS.
           MOVE INT-IBTV-UNA-VEZ TO INT-IBTV.
           MOVE ICG-COD-TINT IN ICG TO INT-TIPT.
           IF INT-CVTI NOT > SPACES
               MOVE ICG-SGV-TINT IN ICG TO INT-TINT
           ELSE
               MOVE ICG-SGV-SPRD IN ICG TO INT-TINT.
           MOVE OPC-NUM-DCOL IN OPC TO INT-DINI.
           MOVE OPC-NUM-MCOL IN OPC TO INT-MINI.
           MOVE OPC-NUM-SCOL IN OPC TO INT-SINI.
           MOVE OPC-NUM-ACOL IN OPC TO INT-AINI.
      *     MOVE ICG-NUM-DINI IN ICG TO INT-DDMA.
      *     MOVE ICG-NUM-MINI IN ICG TO INT-MDMA.
      *     MOVE ICG-NUM-SINI IN ICG TO INT-SDMA.
      *     MOVE ICG-NUM-AINI IN ICG TO INT-ADMA.
           MOVE OPC-NUM-DCOL IN OPC TO INT-DDMA.
           MOVE OPC-NUM-MCOL IN OPC TO INT-MDMA.
           MOVE OPC-NUM-SCOL IN OPC TO INT-SDMA.
           MOVE OPC-NUM-ACOL IN OPC TO INT-ADMA.
           MOVE EVC-NUM-VIGU IN EVC TO INT-NVVG.
           MOVE EVC-NUM-SEVE IN EVC TO INT-SEPA.
           MOVE EVC-IND-UTSV IN EVC TO INT-IPER.
           MOVE EVC-NUM-DPVE IN EVC TO CVI-DVEN.
           MOVE OPC-IND-AFER IN OPC TO INT-AFER.
           MOVE 0                   TO INT-IBEG.
           MOVE OPC-COD-VCOC IN OPC TO INT-VCAM.
           MOVE TOC-MSC-OPEC IN TOC TO INT-OPEC.
      *Diferencia en dias entre Fecha Colocacion y EVC-FEC-FPVC
           MOVE OPC-NUM-DCOL IN OPC TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC TO FEC-AEC1.
           MOVE EVC-NUM-DPVC IN EVC TO FEC-DEC2.
           MOVE EVC-NUM-MPVC IN EVC TO FEC-MEC2.
           MOVE EVC-NUM-SPVC IN EVC TO FEC-SEC2.
           MOVE EVC-NUM-APVC IN EVC TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               GO TO FIN-PRO-VFIN.
           MOVE FEC-NDIA TO INT-SEPV.
           MOVE 'D'      TO INT-USPV.
      *JSS
      *     PERFORM DSP-VINT.
      *
           IF WSS-MSC-TCVE IN WSS-VARI = 'IC'
               MOVE INT-SEPV TO INT-SEPA
               MOVE INT-USPV TO INT-IPER
               MOVE EVC-VAL-VENC IN EVC TO CVI-VCAP
               PERFORM PRO-IPER
               IF INT-CMSG NOT > SPACES
                   PERFORM PRO-VFIN-IC
               ELSE
                    MOVE INT-CMSG TO MSG-COD-MENS
                   GO TO FIN-PRO-VFIN
           ELSE
           IF WSS-MSC-TCVE IN WSS-VARI = 'IO'
               MOVE INT-SEPV TO INT-SEPA
               MOVE INT-USPV TO INT-IPER
               MOVE EVC-VAL-VENC IN EVC TO CVI-VCAP
               PERFORM PRO-IPER
               IF INT-CMSG NOT > SPACES
                   PERFORM PRO-VFIN-IO
               ELSE
                   MOVE INT-CMSG TO MSG-COD-MENS
                   GO TO FIN-PRO-VFIN
           ELSE
           IF WSS-MSC-TCVE IN WSS-VARI = 'IF'
               MOVE INT-SEPV TO INT-SEPA
               MOVE INT-USPV TO INT-IPER
               MOVE EVC-VAL-VENC IN EVC TO CVI-VFIN
               PERFORM PRO-IPER
               IF INT-CMSG NOT > SPACES
                   PERFORM PRO-VFIN-IF
               ELSE
                   MOVE INT-CMSG TO MSG-COD-MENS
                   GO TO FIN-PRO-VFIN
           ELSE
           IF WSS-MSC-TCVE IN WSS-VARI = 'IN'
               MOVE EVC-VAL-VENC IN EVC TO CVI-VCAP
               MOVE CVI-VCAP TO CVI-VFIN
           ELSE
           IF WSS-MSC-TCVE IN WSS-VARI = 'CO'
      *Capital sobre la Operacion - El capital de otras estructuras
               PERFORM PRO-VFIN-CO
           ELSE
           IF WSS-MSC-TCVE IN WSS-VARI = 'FO'
      *Valor final sobre la Operacion
      *Analizar estructuras compuestas
               PERFORM PRO-VFIN-FO
           ELSE
           IF WSS-MSC-TCVE IN WSS-VARI = 'CE'
      *Capital sobre Estructura
      *
      *     ------------------------------ ...
      *     f0         CI         CI
      *
      *     Tomar C.EVC dividirlo por el numero de Venc.EVC, obteniendo
      *     UN CI y aplicar interes sobre C.EVC, y el mismo calculo que
      *     para caso 'IC'
      *
               MOVE INT-SEPV TO INT-SEPA
               MOVE INT-USPV TO INT-IPER
               DIVIDE EVC-VAL-VENC IN EVC BY EVC-NUM-VIGU IN EVC
                                          GIVING CVI-VCAP
               PERFORM PRO-IPER
               IF INT-CMSG NOT > SPACES
                   PERFORM PRO-VFIN-IC
               ELSE
                   MOVE INT-CMSG TO MSG-COD-MENS
                   GO TO FIN-PRO-VFIN
           ELSE
           IF WSS-MSC-TCVE IN WSS-VARI = 'FE'
      *Valor final sobre Estructura
      *
      *     ------------------------------ ...
      *     f0         VF         VF
      *
      *     Llamar a la rutina OBT-VMTO para obtener valor final igual
      *     para todas las cuotas con C.EVC y datos de EVC
               PERFORM PRO-VFIN-FE
           ELSE
               MOVE 'LIQCVC NEX' TO INT-CMSG
               MOVE WSS-MSC-TCVE IN WSS-VARI TO FRM-MEN2.
       FIN-PRO-VFIN.
           EXIT.
      *JSS
       DSP-VINT SECTION.
       INI-DSP-VINT.
      *     MOVE 'INT-TIPT :' TO DSP-GLS-MEN1.
      *     MOVE INT-TIPT     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-TINT :' TO DSP-GLS-MEN1.
      *     MOVE INT-TINT     TO WSS-VEDT-EDT.
      *     MOVE WSS-VEDT-ALF TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-FINT :' TO DSP-GLS-MEN1.
      *     MOVE INT-FINT     TO DSP-GLS-MEN2
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-FINI :' TO DSP-GLS-MEN1.
      *     MOVE INT-FINI     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-NVVG :' TO DSP-GLS-MEN1.
      *     MOVE INT-NVVG     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-SEPA :' TO DSP-GLS-MEN1.
      *     MOVE INT-SEPA     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-IPER :' TO DSP-GLS-MEN1.
      *     MOVE INT-IPER     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-SEPV :' TO DSP-GLS-MEN1.
      *     MOVE INT-SEPV     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-USPV :' TO DSP-GLS-MEN1.
      *     MOVE INT-USPV     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-AFER :' TO DSP-GLS-MEN1.
      *     MOVE INT-AFER     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-IBEG :' TO DSP-GLS-MEN1.
      *     MOVE INT-IBEG     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-VCAM :' TO DSP-GLS-MEN1.
      *     MOVE INT-VCAM     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-OPEC :' TO DSP-GLS-MEN1.
      *     MOVE INT-OPEC     TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'MODALIDAD DE CALCULO :' TO DSP-GLS-MEN1.
      *     MOVE WSS-MSC-TCVE IN WSS-VARI TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
       FIN-DSP-VINT.
           EXIT.
      *JSS-TRC
      * DSP-VFIN SECTION.
      * INI-DSP-VFIN.
      *     MOVE 'CVI-VCAP :' TO DSP-GLS-MEN1.
      *     MOVE CVI-VCAP     TO WSS-VEDT-EDT.
      *     MOVE WSS-VEDT-ALF TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'INT-TIPE :' TO DSP-GLS-MEN1.
      *     MOVE INT-TIPE     TO WSS-VEDT-EDT.
      *     MOVE WSS-VEDT-ALF TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      *     MOVE 'CVI-VFIN :' TO DSP-GLS-MEN1.
      *     MOVE CVI-VFIN     TO WSS-VEDT-EDT.
      *     MOVE WSS-VEDT-ALF TO DSP-GLS-MEN2.
      *     PERFORM GNS-DSP-MENS.
      * FIN-DSP-VFIN.
      *     EXIT.
      *JSS-TRC
      * COPY GNSBGDSP.
       PRO-VFIN-IC SECTION.
       INI-PRO-VFIN-IC.
      *Capital Informado ( calculo sobre el Capital Informado )
      *
      *     ------------------------------ ...
      *     f0         CI
      *
      *     Calculo interes( I ) sobre CI entre f0 y CI y VFIN = CI + I*
           MOVE INT-FINI TO FEC-FECH CVI-FFTP.
           PERFORM PRO-AFER.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG TO MSG-COD-MENS
               GO TO FIN-PRO-VFIN-IC.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG TO MSG-COD-MENS
               GO TO FIN-PRO-VFIN-IC.
      *JSS-PGV El calculo deberia ser sobre C.OPC para 'CE' ?
           MULTIPLY EVC-VAL-VENC IN EVC BY INT-TIPE GIVING CVI-VFIN.
           ADD CVI-VCAP TO CVI-VFIN.
       FIN-PRO-VFIN-IC.
           EXIT.
       PRO-VFIN-IO SECTION.
       INI-PRO-VFIN-IO.
      *Capital Informado ( calculo sobre el Capital Operacion )
      *
      *     ------------------------------ ...
      *     f0         CI
      *
      *     Calculo interes( I ) sobre C.OPC entre f0 y CI y VFIN = CI +
           MOVE INT-FINI TO FEC-FECH CVI-FFTP.
           PERFORM PRO-AFER.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG TO MSG-COD-MENS
               GO TO FIN-PRO-VFIN-IO.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG TO MSG-COD-MENS
               GO TO FIN-PRO-VFIN-IO.
           MULTIPLY OPC-VAL-CRED IN OPC BY INT-TIPE GIVING CVI-VFIN.
           ADD CVI-VCAP TO CVI-VFIN.
       FIN-PRO-VFIN-IO.
           EXIT.
       PRO-VFIN-IF SECTION.
       INI-PRO-VFIN-IF.
      *Valor Final Informado
      *
      *     ------------------------------ ...
      *     f0         FI
      *
      *     Calculo interes( I ) sobre C.OPC entre f0 y FI y C = FI - I*
           MOVE INT-FINI TO FEC-FECH CVI-FFTP.
           PERFORM PRO-AFER.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG TO MSG-COD-MENS
               GO TO FIN-PRO-VFIN-IF.
           PERFORM OBT-VTIN.
           IF INT-CMSG NOT > SPACES
               IF WSS-OPEC = 'D'
                   DIVIDE OPC-VAL-CRED IN OPC BY INT-TIPE GIVING
                                                          CVI-VCAP
                   SUBTRACT CVI-VCAP FROM CVI-VFIN GIVING CVI-VCAP
               ELSE
                   MULTIPLY OPC-VAL-CRED IN OPC BY INT-TIPE GIVING
                                                            CVI-VCAP
                   SUBTRACT CVI-VCAP FROM CVI-VFIN GIVING CVI-VCAP
           ELSE
               MOVE INT-CMSG TO MSG-COD-MENS.
       FIN-PRO-VFIN-IF.
           EXIT.
       PRO-VFIN-CO SECTION.
       INI-PRO-VFIN-CO.
      *Capital sobre la Operacion - Capital de las otras estructuras
      *
      *     ------------------------------ ...
      *     f0         CI         CI
      *
      *     Tomar C.OPC - Capital Otros EVC, dividirlo por el numero de
      *     Venc.OPC, obteniendo un CI y aplicar el mismo calculo que pa
      *     caso 'IO'
      *
           MOVE INT-IBTV-UNA-VEZ TO INT-IBTV.
           MOVE INT-SEPV TO WSS-AXSV.
           MOVE INT-USPV TO WSS-AXUS.
           PERFORM CHK-SUM-EVC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-VFIN-CO.
           IF WSS-NUM-VCVG NOT > ZEROES
               MOVE 'NUMVCVGCOZRO' TO INT-CMSG
               GO TO FIN-PRO-VFIN-CO.
           SUBTRACT WSS-VAL-TEVC FROM OPC-VAL-CRED IN OPC GIVING
                    CVI-VCAP.
           MOVE INT-IBTV-UNA-VEZ TO INT-IBTV.
      *JSS-TRC.
      *     MOVE 'CAPITAL CON EL QUE TRABAJARA CO :' TO DSP-GLS-MEN1.
      *     MOVE CVI-VCAP                            TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
      *JSS-NEW MOVE WSS-AEVC TO EVC.
           MOVE REG-EVC(WSS-EVC1) TO EVC.
      *JSS-NEW
           MOVE EVC-NUM-VIGU IN EVC TO INT-NVVG.
           MOVE WSS-AXSV            TO INT-SEPV INT-SEPA.
           MOVE WSS-AXUS            TO INT-USPV INT-IPER.
      *     DIVIDE OPC-VAL-CRED IN OPC BY
      *            OPC-NUM-VCVG IN OPC GIVING CVI-VCAP
           DIVIDE CVI-VCAP BY WSS-NUM-VCVG GIVING CVI-VCAP.
      *
           PERFORM PRO-IPER.
           IF INT-CMSG NOT > SPACES
               PERFORM PRO-VFIN-IO
           ELSE
               MOVE INT-CMSG TO MSG-COD-MENS.
       FIN-PRO-VFIN-CO.
           EXIT.
       PRO-VFIN-FO SECTION.
       INI-PRO-VFIN-FO.
           MOVE INT-IBTV-UNA-VEZ TO INT-IBTV.
      *     MOVE 'LIQCVC NEX' TO MSG-COD-MENS.
      *     MOVE WSS-MSC-TCVE IN WSS-VARI TO FRM-MEN2.
      *JSS-TRC.
      *     MOVE 'INI-PRO-VFIN-FO' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           PERFORM CHK-SUM-EVC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-VFIN-FO.
           SUBTRACT WSS-VAL-TEVC FROM OPC-VAL-CRED IN OPC GIVING
                    CVI-VCAP.
           MOVE INT-IBTV-UNA-VEZ TO INT-IBTV.
      *JSS-TRC.
      *     MOVE 'CAPITAL CON EL QUE TRABAJARA FO :' TO DSP-GLS-MEN1.
      *     MOVE CVI-VCAP                            TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
           PERFORM BUS-VPER-EVC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-VFIN-FO.
           MOVE 1 TO CVI-QTAN.
           MOVE 0 TO CVI-SUMA CVI-FTOR.
           MOVE 1 TO CVI-FOLD CVI-NVVG.
           MOVE OPC-FEC-FCOL IN OPC TO WSS-FAVC.
           IF INT-AFER-YES
               PERFORM CHK-AFER-EVC
               IF INT-CMSG > SPACES
                   GO TO FIN-PRO-VFIN-FO.
       LUP-PRO-VFIN-FO.
      *JSS-TRC.
      *     MOVE 'LUP-PRO-VFIN-FO' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           PERFORM BUS-MEVC.
           IF WSS-IMVC = ZEROES
      *JSS    Se acabaron los vencimientos
               GO TO CAL-PRO-VFIN-FO.
           SUBTRACT 1 FROM WSS-VIGU(WSS-IMVC).
      *JSS CALCULAR ENTRE WSS-FAVC y WSS-FMVC.
           MOVE WSS-DAVC TO FEC-DEC1.
           MOVE WSS-MAVC TO FEC-MEC1.
           MOVE WSS-SAVC TO FEC-SEC1.
           MOVE WSS-AAVC TO FEC-AEC1.
           MOVE WSS-DMVC TO FEC-DEC2.
           MOVE WSS-MMVC TO FEC-MEC2.
           MOVE WSS-SMVC TO FEC-SEC2.
           MOVE WSS-AMVC TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE MSG-COD-MENS TO INT-CMSG
               GO TO FIN-PRO-VFIN-FO.
           MOVE FEC-NDIA TO INT-SEPD.
      *JSS-TRC.
      *     MOVE 'FECHAS/EVC' TO DSP-GLS-MENS.
      *     MOVE WSS-FAVC     TO DSP-GLS-MENB.
      *     MOVE WSS-FMVC     TO DSP-GLS-MENC.
      *     MOVE WSS-IMVC     TO DSP-SV2-13V4.
      *     PERFORM GNS-DSP-MENS.
           PERFORM OBT-VTIN.
      *JSS-TRC.
      *     MOVE 'DIAS SEPA./T.INTERES :' TO DSP-GLS-MENS.
      *     MOVE FEC-NDIA                 TO DSP-SV1-13V4.
      *     MOVE INT-TIPE                 TO DSP-SV2-13V4.
      *     PERFORM GNS-DSP-MENS.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-VFIN-FO.
           COMPUTE CVI-SUMA = CVI-SUMA + ( 1 + INT-TIPE ) ** CVI-NVVG.
           COMPUTE CVI-FTOR = CVI-FTOR +
                              1 / ( CVI-FOLD * ( 1 + INT-TIPE ) ).
           COMPUTE CVI-FOLD = CVI-FOLD * ( 1 + INT-TIPE ).
           IF CVI-QTAN = CVI-NVVG
               MOVE INT-TIPE TO CVI-TIQN.
           ADD 1 TO CVI-NVVG.
      *    MOVE WSS-FFPV TO WSS-FAVC.
           MOVE WSS-DFPV(WSS-IMVC) TO WSS-DAVC.
           MOVE WSS-MFPV(WSS-IMVC) TO WSS-MAVC.
           MOVE WSS-SFPV(WSS-IMVC) TO WSS-SAVC.
           MOVE WSS-AFPV(WSS-IMVC) TO WSS-AAVC.
           IF WSS-VIGU(WSS-IMVC) = ZEROES
               GO TO LUP-PRO-VFIN-FO.
      *JSS Desplazar WSS-FPVC(WSS-IMVC) en WSS-SEVE(WSS-IMVC) segun
      *                                    WSS-UTSV(WSS-IMVC)
      *    Considerando analisis de feriado si corresponde.
           IF WSS-UTSV(WSS-IMVC) = 'D'
               MOVE FEC-SUM-DIA        TO FEC-CMND
               MOVE WSS-SEVE(WSS-IMVC) TO FEC-NDIA
           ELSE
           IF WSS-UTSV(WSS-IMVC) = 'M'
               MOVE FEC-SUM-MES        TO FEC-CMND
               MOVE WSS-SEVE(WSS-IMVC) TO FEC-NMES
           ELSE
           IF WSS-UTSV(WSS-IMVC) = 'A'
               MOVE FEC-SUM-ANO        TO FEC-CMND
               MOVE WSS-SEVE(WSS-IMVC) TO FEC-NANO
           ELSE
               MOVE 'INTIPERINV' TO INT-CMSG
               GO TO FIN-PRO-VFIN-FO.
           MOVE WSS-DPVC(WSS-IMVC) TO FEC-ITM1.
           MOVE WSS-MPVC(WSS-IMVC) TO FEC-ITM2.
           MOVE WSS-SPVC(WSS-IMVC) TO FEC-ITM3.
           MOVE WSS-APVC(WSS-IMVC) TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
      *JSS PERFORM CAL-FEC
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE MSG-COD-MENS TO INT-CMSG
               GO TO FIN-PRO-VFIN-FO.
           MOVE WSS-DVEN(WSS-IMVC) TO CVI-DVEN.
           IF NOT ( ( WSS-UTSV(WSS-IMVC) = 'M' OR 'A' ) AND
              CVI-DVEN > ZEROES AND FEC-ITM1 < CVI-DVEN )
               GO TO FER-PRO-VFIN-FO.
           IF CVI-DVEN > FEC-DMES(FEC-ITM2)
               MOVE FEC-DMES(FEC-ITM2) TO FEC-ITM1
           ELSE
               MOVE CVI-DVEN TO FEC-ITM1.
           IF FEC-ITM2 = 2
               DIVIDE FEC-ITM4 BY 4 GIVING FEC-REST REMAINDER FEC-REST
               IF ( FEC-REST NOT = 0 ) AND ( FEC-ITM1 > 28 )
                   MOVE 28 TO FEC-ITM1.
       FER-PRO-VFIN-FO.
           MOVE FEC-ITM1 TO WSS-DPVC(WSS-IMVC).
           MOVE FEC-ITM2 TO WSS-MPVC(WSS-IMVC).
           MOVE FEC-ITM3 TO WSS-SPVC(WSS-IMVC).
           MOVE FEC-ITM4 TO WSS-APVC(WSS-IMVC).
           IF NOT INT-AFER-YES
               GO TO FPV-PRO-VFIN-FO.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-S  TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
      *JSS PERFORM CAL-FEC.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS AND NOT FEC-STAT-FER
               MOVE MSG-COD-MENS TO INT-CMSG
               GO TO FIN-PRO-VFIN-FO.
           IF NOT FEC-STAT-FER
               GO TO FPV-PRO-VFIN-FO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SIG-HBL  TO FEC-CMND.
      *JSS PERFORM CAL-FEC.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE MSG-COD-MENS TO INT-CMSG
               GO TO FIN-PRO-VFIN-FO.
       FPV-PRO-VFIN-FO.
      *JSS-TRC.
      *     MOVE 'FPV-PRO-VFIN-FO' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           MOVE FEC-ITM1 TO WSS-DFPV(WSS-IMVC).
           MOVE FEC-ITM2 TO WSS-MFPV(WSS-IMVC).
           MOVE FEC-ITM3 TO WSS-SFPV(WSS-IMVC).
           MOVE FEC-ITM4 TO WSS-AFPV(WSS-IMVC).
           GO TO LUP-PRO-VFIN-FO.
       CAL-PRO-VFIN-FO.
      *JSS-TRC.
      *     MOVE 'CAL-PRO-VFIN-FO' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
      *JSS
           MOVE 'P' TO INT-OPEC.
           IF INT-OPEC = 'D'
      *JSS     COMPUTE CVI-VCAP ROUNDED = CVI-VFIN / CVI-SUMA
               DIVIDE CVI-VFIN BY CVI-SUMA GIVING CVI-VCAP
           ELSE
      *JSS     COMPUTE CVI-VFIN ROUNDED = CVI-VCAP * CVI-SUMA.
      *JSS     COMPUTE CVI-VFIN ROUNDED = CVI-VCAP / CVI-FTOR.
               DIVIDE CVI-VCAP BY CVI-FTOR GIVING CVI-VFIN.
      *CALCULO DE INTERES SOBRE EL VALOR CAPITAL
           MULTIPLY CVI-VCAP BY CVI-TIQN GIVING CVI-VCAP.
           IF CVI-VCAP NOT > CVI-VFIN
               SUBTRACT CVI-VCAP FROM CVI-VFIN GIVING CVI-VCAP
           ELSE
               MOVE 0 TO CVI-VCAP.
       FIN-PRO-VFIN-FO.
           EXIT.
       CHK-SUM-EVC SECTION.
       INI-CHK-SUM-EVC.
      *JSS-TRC.
      *     MOVE 'INI-CHK-SUM-EVC' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           MOVE ZEROES TO WSS-MEFO WSS-NUM-VCVG.
           MOVE ZEROES TO WSS-VAL-TEVC.
           MOVE ZEROES TO WSS-VAL-TCAP.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CHK-SUM-EVC.
      *JSS-TRC.
      *     MOVE 'LUP-CHK-SUM-EVC' TO DSP-GLS-MEN1.
      *     MOVE WSS-VAL-TEVC      TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = EVC-CIC-IOPC IN EVC )
               GO TO DIF-CHK-SUM-EVC.
      *Busca el CIC de EVC-MSC-TCVE en TAB CVC ( en sist COL )
           MOVE 'COL' TO TAB-COD-SIST FIO-SIST.
           MOVE 'CVC' TO TAB-COD-TTAB IN TAB.
           MOVE EVC-MSC-TCVE IN EVC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CICTCVENEX' TO INT-CMSG
               MOVE TAB-COD-TABL TO FRM-MEN2
               GO TO FIN-CHK-SUM-EVC.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-MSC-TCVE IN WSS-VARI.
           IF EVC-VAL-VENC IN EVC > ZEROES
               IF WSS-MSC-TCVE IN WSS-VARI = 'CI' OR 'IO' OR 'IN'
                   MULTIPLY EVC-NUM-VIGU IN EVC BY EVC-VAL-VENC IN EVC
                     GIVING WSS-VAL-TCAP
                   ADD WSS-VAL-TCAP TO WSS-VAL-TEVC
      *JSS-TRC.
      *             MOVE WSS-MSC-TCVE TO DSP-GLS-MEN1
      *             MOVE WSS-VAL-TCAP TO DSP-SV1-13V4
      *             PERFORM GNS-DSP-MENS
               ELSE
               IF WSS-MSC-TCVE IN WSS-VARI = 'IO'
                   MULTIPLY EVC-NUM-VIGU IN EVC BY EVC-VAL-VENC IN EVC
                     GIVING WSS-VAL-TCAP
                   ADD WSS-VAL-TCAP TO WSS-VAL-TEVC
      *JSS-TRC.
      *             MOVE WSS-MSC-TCVE TO DSP-GLS-MEN1
      *             MOVE WSS-VAL-TCAP TO DSP-SV1-13V4
      *             PERFORM GNS-DSP-MENS
               ELSE
               IF WSS-MSC-TCVE IN WSS-VARI = 'CE' OR 'FE'
                   ADD EVC-VAL-VENC IN EVC TO WSS-VAL-TEVC
      *JSS-TRC.
      *             MOVE WSS-MSC-TCVE        TO DSP-GLS-MEN1
      *             MOVE EVC-VAL-VENC IN EVC TO DSP-SV1-13V4
      *             PERFORM GNS-DSP-MENS
               ELSE
               IF WSS-MSC-TCVE IN WSS-VARI = 'IF'
                   PERFORM CHK-SUM-EIF
                   IF INT-CMSG > SPACES
                       GO TO FIN-CHK-SUM-EVC.
           IF WSS-MSC-TCVE IN WSS-VARI = 'CO'
               ADD EVC-NUM-VIGU IN EVC TO WSS-NUM-VCVG.
           IF WSS-MSC-TCVE IN WSS-VARI = 'FO'
               ADD 1 TO WSS-MEFO
               IF WSS-MEFO NOT > WSS-LEFO
      *JSS-TRC.
      *             MOVE 'CASO FO CON LLAVE : ' TO DSP-GLS-MEN1
      *             MOVE EVC-KEY-IEVC IN EVC    TO DSP-GLS-MEN2
      *             PERFORM GNS-DSP-MENS
                   MOVE EVC TO WSS-REVC(WSS-MEFO)
               ELSE
                   MOVE 'EVCTCVEFOOVR' TO INT-CMSG
                   GO TO FIN-CHK-SUM-EVC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CHK-SUM-EVC.
       DIF-CHK-SUM-EVC.
      *JSS-TRC.
      *     MOVE 'OPC-VAL-CRED'      TO DSP-GLS-MEN1.
      *     MOVE OPC-VAL-CRED IN OPC TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
      *JSS-TRC.
      *     MOVE 'WSS-VAL-TEVC' TO DSP-GLS-MEN1.
      *     MOVE WSS-VAL-TEVC   TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
           IF WSS-VAL-TEVC > OPC-VAL-CRED IN OPC
               MOVE 'EVCSUMAOPC>' TO INT-CMSG
               MOVE WSS-VAL-TEVC  TO WSS-NUM-FEDT
               MOVE WSS-NUM-FEDT  TO FRM-MEN2.
       FIN-CHK-SUM-EVC.
           EXIT.
       CHK-SUM-EIF SECTION.
       INI-CHK-SUM-EIF.
      *JSS-TRC.
      *     MOVE 'INI-CHK-SUM-EIF' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           MOVE EVC-NUM-VIGU IN EVC TO INT-NVVG.
      *Diferencia en dias entre Fecha Colocacion y EVC-FEC-FPVC
           MOVE OPC-NUM-DCOL IN OPC TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC TO FEC-AEC1.
           MOVE EVC-NUM-DPVC IN EVC TO FEC-DEC2.
           MOVE EVC-NUM-MPVC IN EVC TO FEC-MEC2.
           MOVE EVC-NUM-SPVC IN EVC TO FEC-SEC2.
           MOVE EVC-NUM-APVC IN EVC TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE MSG-COD-MENS TO INT-CMSG
               GO TO FIN-CHK-SUM-EIF.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPV.
           MOVE 'D'      TO INT-IPER INT-USPV.
           MOVE EVC-VAL-VENC IN EVC TO CVI-VFIN.
           PERFORM PRO-VFIN-IF.
           IF INT-CMSG > SPACES
               GO TO FIN-CHK-SUM-EIF.
           ADD CVI-VCAP TO WSS-VAL-TEVC.
      *JSS-TRC.
      *     MOVE 'PVC-CHK-SUM-EIF' TO DSP-GLS-MEN1.
      *     MOVE CVI-VCAP          TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
           MOVE EVC-NUM-SEVE IN EVC TO INT-SEPA.
           MOVE EVC-IND-UTSV IN EVC TO INT-IPER.
           MOVE EVC-NUM-DPVE IN EVC TO CVI-DVEN.
           PERFORM PRO-IPER.
           IF INT-CMSG > SPACES
               GO TO FIN-CHK-SUM-EIF.
           MOVE 1 TO CVI-NVVG.
       LUP-CHK-SUM-EIF.
      *JSS-TRC.
      *     MOVE 'LUP-CHK-SUM-EIF' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           ADD 1 TO CVI-NVVG.
           IF CVI-NVVG > INT-NVVG
               GO TO FIN-CHK-SUM-EIF.
           MOVE EVC-VAL-VENC IN EVC TO CVI-VFIN.
      *JSS MOVE CVI-FTPE            TO FEC-FECH CVI-FIPE.  o ??? .....
           MOVE INT-FINI            TO FEC-FECH CVI-FIPE.
           PERFORM PRO-VFIN-IF.
           IF INT-CMSG > SPACES
               GO TO FIN-CHK-SUM-EIF.
           ADD CVI-VCAP TO WSS-VAL-TEVC.
      *JSS-TRC.
      *     MOVE 'VEN-CHK-SUM-EIF' TO DSP-GLS-MEN1.
      *     MOVE CVI-VCAP          TO DSP-SV1-13V4.
      *     PERFORM GNS-DSP-MENS.
           GO TO LUP-CHK-SUM-EIF.
       FIN-CHK-SUM-EIF.
           EXIT.
       BUS-VPER-EVC SECTION.
       INI-BUS-VPER-EVC.
      *JSS-TRC.
      *     MOVE 'INI-BUS-VPER-EVC' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           MOVE 0 TO WSS-I.
       LUP-BUS-VPER-EVC.
      *JSS-TRC.
      *     MOVE 'LUP-BUS-VPER-EVC' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-MEFO
               GO TO FIN-BUS-VPER-EVC.
           MOVE WSS-REVC(WSS-I) TO EVC.
           MOVE EVC-IND-UTSV IN EVC TO INT-IPER.
           MOVE EVC-NUM-DPVE IN EVC TO CVI-DVEN.
           PERFORM PRO-IPER.
           IF INT-CMSG > SPACES
               GO TO FIN-BUS-VPER-EVC.
           MOVE EVC-NUM-SEVE IN EVC TO WSS-SEVE(WSS-I).
           MOVE INT-IPER            TO WSS-UTSV(WSS-I).
           MOVE EVC-NUM-VIGU IN EVC TO WSS-VIGU(WSS-I).
           MOVE EVC-NUM-DPVC IN EVC TO WSS-DPVC(WSS-I).
           MOVE EVC-NUM-MPVC IN EVC TO WSS-MPVC(WSS-I).
           MOVE EVC-NUM-SPVC IN EVC TO WSS-SPVC(WSS-I).
           MOVE EVC-NUM-APVC IN EVC TO WSS-APVC(WSS-I).
           MOVE WSS-FPVC(WSS-I) TO WSS-FFPV(WSS-I).
           MOVE CVI-DVEN            TO WSS-DVEN(WSS-I).
      *Diferencia en dias entre Fecha Colocacion y EVC-FEC-FPVC
      *     MOVE OPC-NUM-DCOL IN OPC TO FEC-DEC1.
      *     MOVE OPC-NUM-MCOL IN OPC TO FEC-MEC1.
      *     MOVE OPC-NUM-SCOL IN OPC TO FEC-SEC1.
      *     MOVE OPC-NUM-ACOL IN OPC TO FEC-AEC1.
      *     MOVE EVC-NUM-DPVC IN EVC TO FEC-DEC2.
      *     MOVE EVC-NUM-MPVC IN EVC TO FEC-MEC2.
      *     MOVE EVC-NUM-SPVC IN EVC TO FEC-SEC2.
      *     MOVE EVC-NUM-APVC IN EVC TO FEC-AEC2.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     MOVE FEC-DIF-DIA  TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF NOT FEC-STAT-OKS
      *         MOVE MSG-COD-MENS TO INT-CMSG
      *         GO TO FIN-BUS-VPER-EVC.
      *     MOVE FEC-NDIA            TO WSS-SPVE(WSS-I).
      *     MOVE 'D'                 TO WSS-UTPV(WSS-I).
           GO TO LUP-BUS-VPER-EVC.
       FIN-BUS-VPER-EVC.
           EXIT.
       CHK-AFER-EVC SECTION.
       INI-CHK-AFER-EVC.
           MOVE 0 TO WSS-I.
       LUP-CHK-AFER-EVC.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-MEFO
               GO TO FIN-CHK-AFER-EVC.
           MOVE WSS-DPVC(WSS-I) TO FEC-ITM1.
           MOVE WSS-MPVC(WSS-I) TO FEC-ITM2.
           MOVE WSS-SPVC(WSS-I) TO FEC-ITM3.
           MOVE WSS-APVC(WSS-I) TO FEC-ITM4.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
               MOVE MSG-COD-MENS TO INT-CMSG
               GO TO FIN-CHK-AFER-EVC.
           IF FEC-STAT-FER
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-SIG-HBL  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-OKS
                   MOVE FEC-ITM1 TO WSS-DFPV(WSS-I)
                   MOVE FEC-ITM2 TO WSS-MFPV(WSS-I)
                   MOVE FEC-ITM3 TO WSS-SFPV(WSS-I)
                   MOVE FEC-ITM4 TO WSS-AFPV(WSS-I)
               ELSE
                   MOVE MSG-COD-MENS TO INT-CMSG
                   GO TO FIN-CHK-AFER-EVC.
           GO TO LUP-CHK-AFER-EVC.
       FIN-CHK-AFER-EVC.
           EXIT.
       BUS-MEVC SECTION.
       INI-BUS-MEVC.
      *JSS-TRC.
      *     MOVE 'INI-BUS-MEVC' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           MOVE ZEROES TO WSS-FMVC.
           MOVE ZEROES TO WSS-IMVC.
           MOVE 0 TO WSS-I.
       LUP-BUS-MEVC.
      *JSS-TRC.
      *     MOVE 'LUP-BUS-MEVC' TO DSP-GLS-MENS.
      *     PERFORM GNS-DSP-MENS.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-MEFO
               GO TO FIN-BUS-MEVC.
           IF ( WSS-FFPV(WSS-I) < WSS-FMVC OR WSS-FMVC = ZEROES ) AND
              WSS-VIGU(WSS-I) > ZEROES
               MOVE WSS-FFPV(WSS-I) TO WSS-FMVC
               MOVE WSS-I           TO WSS-IMVC.
           GO TO LUP-BUS-MEVC.
       FIN-BUS-MEVC.
           EXIT.
       PRO-VFIN-FE SECTION.
       INI-PRO-VFIN-FE.
           MOVE INT-IBTV-UNA-VEZ TO INT-IBTV.
           MOVE 'P' TO INT-OPEC.
           MOVE 1                   TO CVI-QTAN.
           MOVE EVC-VAL-VENC IN EVC TO CVI-VCAP.
           PERFORM OBT-VMTO.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG TO MSG-COD-MENS
               GO TO FIN-PRO-VFIN-FE.
      *JSS-PGV El calculo deberia ser sobre C.OPC ?
           MULTIPLY EVC-VAL-VENC IN EVC BY CVI-TIQN GIVING CVI-VCAP.
           IF CVI-VCAP NOT > CVI-VFIN
               SUBTRACT CVI-VCAP FROM CVI-VFIN GIVING CVI-VCAP
           ELSE
               MOVE 0 TO CVI-VCAP.
       FIN-PRO-VFIN-FE.
           EXIT.
       BUS-FAM SECTION.
       INI-BUS-FAM.
       FIN-BUS-FAM.
           EXIT.
      *
      *
       COPY COLBFRDC.
       COPY COLBFITR.
       COPY COLBFCYA.
       COPY COLBFDLC.
       COPY COLBFCAM.
       COPY COLBFEVC.
       COPY COLBFVEN.
       COPY COLBFIMP.
       COPY COLBFICG.
       COPY COLBFNTR.
       COPY COLBFTOC.
      *
      *
       COPY GNSBVMSC.
      *
       COPY GNSBGCVI.
       COPY GNSBGINT.
      *
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBFTAB.
       COPY GNSBGPES.
      *
      *
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY SGCBFRCD.
       KEY-OPC-OPC SECTION.
       INI-KEY-OPC-OPC.
           MOVE OPC-CAI-IOPC IN OPC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO OPC-IIC-IOPC IN OPC.
       FIN-KEY-OPC-OPC.
           EXIT.
      *>>>>
