      *
      * COLBUIPT
      * Version 3.0.2 Oct-2013 VALVNM
      * 06-Nov-13 08:38 PM
      *
       SET-TAG-COLBUIPT SECTION.
       INI-SET-TAG-COLBUIPT.
           MOVE
           '<IDNMOD NOM=$COLBUIPT$ VSN=${VSNBU}$ VGM=$3.0.2$
      -    'GEN=$06-Nov-13 08:38 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBUIPT.
           EXIT.
           
       RET-ALL-IPT SECTION.
       INI-RET-ALL-IPT.
           PERFORM KEY-ALL-IPT.
           PERFORM RET-IPT-IPT.
       FIN-RET-ALL-IPT.
           EXIT.
       
       RET-IPT-IPT SECTION.
       INI-RET-IPT-IPT.
           MOVE IPT-CIC-ORIG IN IPT-FLD TO IPT-CIC-ORIG IN IPT.
           MOVE IPT-COD-IEMI IN IPT-FLD TO IPT-COD-IEMI IN IPT.
           MOVE IPT-CAI-IORI IN IPT-FLD TO IPT-CAI-IORI IN IPT.
           MOVE IPT-IIC-IORI IN IPT-FLD TO IPT-IIC-IORI IN IPT.
           MOVE IPT-NUM-PTRM IN IPT-FLD TO IPT-NUM-PTRM IN IPT.
           MOVE IPT-VAL-CTRA IN IPT-FLD TO IPT-VAL-CTRA IN IPT.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IPT-NUM-DCOL IN IPT-FLD TO IPT-NUM-DCOL IN IPT.
           MOVE IPT-NUM-MCOL IN IPT-FLD TO IPT-NUM-MCOL IN IPT.
           MOVE IPT-NUM-SCOL IN IPT-FLD TO IPT-NUM-SCOL IN IPT.
           MOVE IPT-NUM-ACOL IN IPT-FLD TO IPT-NUM-ACOL IN IPT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IPT-NUM-DORI IN IPT-FLD TO IPT-NUM-DORI IN IPT.
           MOVE IPT-NUM-MORI IN IPT-FLD TO IPT-NUM-MORI IN IPT.
           MOVE IPT-NUM-SORI IN IPT-FLD TO IPT-NUM-SORI IN IPT.
           MOVE IPT-NUM-AORI IN IPT-FLD TO IPT-NUM-AORI IN IPT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IPT-NUM-DMAV IN IPT-FLD TO IPT-NUM-DMAV IN IPT.
           MOVE IPT-NUM-MMAV IN IPT-FLD TO IPT-NUM-MMAV IN IPT.
           MOVE IPT-NUM-SMAV IN IPT-FLD TO IPT-NUM-SMAV IN IPT.
           MOVE IPT-NUM-AMAV IN IPT-FLD TO IPT-NUM-AMAV IN IPT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IPT-NUM-DINI IN IPT-FLD TO IPT-NUM-DINI IN IPT.
           MOVE IPT-NUM-MINI IN IPT-FLD TO IPT-NUM-MINI IN IPT.
           MOVE IPT-NUM-SINI IN IPT-FLD TO IPT-NUM-SINI IN IPT.
           MOVE IPT-NUM-AINI IN IPT-FLD TO IPT-NUM-AINI IN IPT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IPT-NUM-DTER IN IPT-FLD TO IPT-NUM-DTER IN IPT.
           MOVE IPT-NUM-MTER IN IPT-FLD TO IPT-NUM-MTER IN IPT.
           MOVE IPT-NUM-STER IN IPT-FLD TO IPT-NUM-STER IN IPT.
           MOVE IPT-NUM-ATER IN IPT-FLD TO IPT-NUM-ATER IN IPT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IPT-SGV-TUNI IN IPT-FLD TO IPT-SGV-TUNI IN IPT.
           MOVE IPT-SGV-TOPE IN IPT-FLD TO IPT-SGV-TOPE IN IPT.
           MOVE IPT-SGV-TINT IN IPT-FLD TO IPT-SGV-TINT IN IPT.
           MOVE IPT-SGV-TACU IN IPT-FLD TO IPT-SGV-TACU IN IPT.
           MOVE IPT-NUM-PDES IN IPT-FLD TO IPT-NUM-PDES IN IPT.
           MOVE IPT-COD-ITRU IN IPT-FLD TO IPT-COD-ITRU IN IPT.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IPT-NUM-DTRI IN IPT-FLD TO IPT-NUM-DTRI IN IPT.
           MOVE IPT-NUM-MTRI IN IPT-FLD TO IPT-NUM-MTRI IN IPT.
           MOVE IPT-NUM-STRI IN IPT-FLD TO IPT-NUM-STRI IN IPT.
           MOVE IPT-NUM-ATRI IN IPT-FLD TO IPT-NUM-ATRI IN IPT.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE IPT-COD-TDOC IN IPT-FLD TO IPT-COD-TDOC IN IPT.
           MOVE IPT-MSC-TIMP IN IPT-FLD TO IPT-MSC-TIMP IN IPT.
           MOVE IPT-SGV-MORI IN IPT-FLD TO IPT-SGV-MORI IN IPT.
           MOVE IPT-COD-VCOC IN IPT-FLD TO IPT-COD-VCOC IN IPT.
           MOVE IPT-SGV-MNTO IN IPT-FLD TO IPT-SGV-MNTO IN IPT.
           MOVE IPT-COD-TIPO IN IPT-FLD TO IPT-COD-TIPO IN IPT.
           MOVE IPT-MSC-STAT IN IPT-FLD TO IPT-MSC-STAT IN IPT.
           MOVE IPT-SGV-CUOT IN IPT-FLD TO IPT-SGV-CUOT IN IPT.
           MOVE IPT-SGV-VDES IN IPT-FLD TO IPT-SGV-VDES IN IPT.
           MOVE IPT-GLS-NORM IN IPT-FLD TO IPT-GLS-NORM IN IPT.
           MOVE IPT-SGV-VTOT IN IPT-FLD TO IPT-SGV-VTOT IN IPT.
           MOVE IPT-NUM-FOLI IN IPT-FLD TO IPT-NUM-FOLI IN IPT.
           MOVE IPT-SGV-MCAL IN IPT-FLD TO IPT-SGV-MCAL IN IPT.
           MOVE IPT-COD-ATRN IN IPT-FLD TO IPT-COD-ATRN IN IPT.
       FIN-RET-IPT-IPT.
           EXIT.
       
       KEY-ALL-IPT SECTION.
       INI-KEY-ALL-IPT.
           PERFORM KEY-IPT-IPT.
       FIN-KEY-ALL-IPT.
           EXIT.
       
       KEY-IPT-IPT SECTION.
       INI-KEY-IPT-IPT.
           MOVE IPT-CAI-IOPC IN IPT-FLD TO IPT-CAI-IOPC IN IPT.
           MOVE IPT-IIC-IOPC IN IPT-FLD TO IPT-IIC-IOPC IN IPT.
           MOVE IPT-COD-EVEN IN IPT-FLD TO IPT-COD-EVEN IN IPT.
           MOVE IPT-NUM-ICAN IN IPT-FLD TO IPT-NUM-ICAN IN IPT.
           MOVE IPT-COD-CPTO IN IPT-FLD TO IPT-COD-CPTO IN IPT.
           MOVE IPT-NUM-CPTO IN IPT-FLD TO IPT-NUM-CPTO IN IPT.
      *<<<< FIN_KEY_IPT_IPT                                               
           IF SCR-CMND = 'IPA'                                                  
               GO TO FIN-KEY-IPT-IPT.                   
        
           MOVE IPT-CAI-IOPC IN IPT-FLD  TO WSS-CAI-IOPC IN WSS-VARI.   
           MOVE IPT-IIC-IOPC IN IPT-FLD  TO WSS-IIC-IOPC IN WSS-VARI.   
           MOVE WSS-CIC-IOPC IN WSS-VARI TO WSS-CIC-IOPC IN BDO-VARI.   
           PERFORM OBT-OPE-ANT.                                         
           IF WSS-CIC-ANTE IN BDO-VARI > SPACES                         
              MOVE WSS-CAI-ANTE IN BDO-VARI TO IPT-CAI-IORI IN IPT-FLD  
              MOVE WSS-IIC-ANTE IN BDO-VARI TO IPT-IIC-IORI IN IPT-FLD  
           ELSE                                                         
              MOVE WSS-CAI-ORIG IN BDO-VARI TO IPT-CAI-IORI IN IPT-FLD  
              MOVE WSS-IIC-ORIG IN BDO-VARI TO IPT-IIC-IORI IN IPT-FLD.      
      *>>>>
       FIN-KEY-IPT-IPT.
           EXIT.
       
       SCR-CLRA-IPT SECTION.
       INI-SCR-CLRA-IPT.
           PERFORM CLR-KEY-IPT.
           PERFORM CLR-FLD-IPT.
       FIN-SCR-CLRA-IPT.
           EXIT.
       
       CLR-KEY-IPT SECTION.
       INI-CLR-KEY-IPT.
           MOVE SPACES TO IPT-CAI-IOPC IN IPT-FLD.
           MOVE ZEROES TO IPT-IIC-IOPC IN IPT-FLD.
           MOVE SPACES TO IPT-COD-EVEN IN IPT-FLD.
           MOVE ZEROES TO IPT-NUM-ICAN IN IPT-FLD.
           MOVE SPACES TO IPT-COD-CPTO IN IPT-FLD.
           MOVE ZEROES TO IPT-NUM-CPTO IN IPT-FLD.
       FIN-CLR-KEY-IPT.
           EXIT.
       
       CLR-FLD-IPT SECTION.
       INI-CLR-FLD-IPT.
           MOVE SPACES TO FRM-GLS-EVEN IN IPT-FLD.
           MOVE SPACES TO FRM-GLS-CPTO IN IPT-FLD.
           MOVE SPACES TO FRM-GLS-IEMI IN IPT-FLD.
           MOVE SPACES TO FRM-GLS-TIPO IN IPT-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN IPT-FLD.
           PERFORM CLR-IPT-IPT.
       FIN-CLR-FLD-IPT.
           EXIT.
       
       CLR-IPT-IPT SECTION.
       INI-CLR-IPT-IPT.
           MOVE SPACES TO IPT-CIC-ORIG IN IPT-FLD.
           MOVE SPACES TO IPT-COD-IEMI IN IPT-FLD.
           MOVE SPACES TO IPT-CAI-IORI IN IPT-FLD.
           MOVE ZEROES TO IPT-IIC-IORI IN IPT-FLD.
           MOVE ZEROES TO IPT-NUM-PTRM IN IPT-FLD.
           MOVE ZEROES TO IPT-VAL-CTRA IN IPT-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IPT-FEC-FCOL IN IPT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IPT-FEC-FORI IN IPT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IPT-FEC-FMAV IN IPT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IPT-FEC-FINI IN IPT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IPT-FEC-FTER IN IPT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IPT-SGV-TUNI IN IPT-FLD.
           MOVE ZEROES TO IPT-SGV-TOPE IN IPT-FLD.
           MOVE ZEROES TO IPT-SGV-TINT IN IPT-FLD.
           MOVE ZEROES TO IPT-SGV-TACU IN IPT-FLD.
           MOVE ZEROES TO IPT-NUM-PDES IN IPT-FLD.
           MOVE SPACES TO IPT-COD-ITRU IN IPT-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO IPT-FEC-TTRI IN IPT-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO IPT-COD-TDOC IN IPT-FLD.
           MOVE SPACES TO IPT-MSC-TIMP IN IPT-FLD.
           MOVE ZEROES TO IPT-SGV-MORI IN IPT-FLD.
           MOVE SPACES TO IPT-COD-VCOC IN IPT-FLD.
           MOVE ZEROES TO IPT-SGV-MNTO IN IPT-FLD.
           MOVE SPACES TO IPT-COD-TIPO IN IPT-FLD.
           MOVE SPACES TO IPT-MSC-STAT IN IPT-FLD.
           MOVE ZEROES TO IPT-SGV-CUOT IN IPT-FLD.
           MOVE ZEROES TO IPT-SGV-VDES IN IPT-FLD.
           MOVE SPACES TO IPT-GLS-NORM IN IPT-FLD.
           MOVE ZEROES TO IPT-SGV-VTOT IN IPT-FLD.
           MOVE ZEROES TO IPT-NUM-FOLI IN IPT-FLD.
           MOVE ZEROES TO IPT-SGV-MCAL IN IPT-FLD.
           MOVE SPACES TO IPT-COD-ATRN IN IPT-FLD.
       FIN-CLR-IPT-IPT.
           EXIT.
       
       FST-KEY-IPT SECTION.
       INI-FST-KEY-IPT.
           MOVE -1 TO IPT-CAI-IOPC-LEN IN IPT-FLD.
       FIN-FST-KEY-IPT.
           EXIT.
       
       FST-FLD-IPT SECTION.
       INI-FST-FLD-IPT.
      *<<<< INI_FST_FLD_IPT                                                 
           IF IPT-COD-EVEN IN IPT-FLD NOT = 'HIS'                               
              GO TO NXT-FST-FLD-IPT.                                            
      *>>>>
           MOVE -1 TO IPT-CIC-ORIG-LEN IN IPT-FLD.
      *<<<< FIN_FST_FLD_IPT                                                
           GO TO FIN-FST-FLD-IPT.                                               
       NXT-FST-FLD-IPT.                                                         
           MOVE 0  TO IPT-CIC-ORIG-LEN IN IPT-FLD.                              
           MOVE -1 TO IPT-COD-IEMI-LEN IN IPT-FLD.                              
           IF SCR-CMND = 'ING' AND                                              
              WSS-MSC-TIMP IN WSS-VARI = 'I'
              MOVE 0  TO IPT-COD-IEMI-LEN IN IPT-FLD                            
              MOVE -1 TO IPT-CIC-ORIG-LEN IN IPT-FLD.                           
                                                                                
           IF SCR-CMND = 'MOD'                                                  
              MOVE 0  TO IPT-COD-IEMI-LEN IN IPT-FLD                            
              MOVE -1 TO IPT-CIC-ORIG-LEN IN IPT-FLD.                           
                                                                       
           IF SCR-CMND = 'IPA'                                                  
              MOVE 0  TO IPT-COD-IEMI-LEN IN IPT-FLD                  
              MOVE -1 TO IPT-CAI-IORI-LEN IN IPT-FLD.  

           IF SCR-CMND = 'MCA'                                                  
              MOVE 0  TO IPT-COD-IEMI-LEN IN IPT-FLD                            
              MOVE -1 TO IPT-VAL-CTRA-LEN IN IPT-FLD.
      *>>>>
       FIN-FST-FLD-IPT.
           EXIT.
       
       PRO-KEY-IPT SECTION.
       INI-PRO-KEY-IPT.
           PERFORM PRO-MKY-IPT.
       FIN-PRO-KEY-IPT.
           EXIT.
       
       PRO-MKY-IPT SECTION.
       INI-PRO-MKY-IPT.
       FIN-PRO-MKY-IPT.
           EXIT.
       
       PRO-FLD-IPT SECTION.
       INI-PRO-FLD-IPT.
           PERFORM PRO-IPT-IPT.
       FIN-PRO-FLD-IPT.
           EXIT.
       
       PRO-IPT-IPT SECTION.
       INI-PRO-IPT-IPT.
           MOVE FRM-CPIM-AEY TO IPT-CIC-ORIG-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-COD-IEMI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-CAI-IORI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-IIC-IORI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-NUM-PTRM-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-VAL-CTRA-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-FEC-FORI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-FEC-FMAV-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-FEC-FINI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-FEC-FTER-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-SGV-TUNI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-SGV-TACU-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-NUM-PDES-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-COD-ITRU-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-FEC-TTRI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-COD-TDOC-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-MSC-TIMP-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-SGV-MORI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-COD-VCOC-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-SGV-MNTO-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-COD-TIPO-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-MSC-STAT-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-SGV-CUOT-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-GLS-NORM-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-SGV-VTOT-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-NUM-FOLI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-AEY TO IPT-SGV-MCAL-ATR IN IPT-FLD.
       FIN-PRO-IPT-IPT.
           EXIT.
       
       UNP-KEY-IPT SECTION.
       INI-UNP-KEY-IPT.
           PERFORM UNP-IKY-IPT.
           PERFORM UNP-AKY-IPT.
           PERFORM UNP-MKY-IPT.
       FIN-UNP-KEY-IPT.
           EXIT.
       
       UNP-IKY-IPT SECTION.
       INI-UNP-IKY-IPT.
           MOVE FRM-CPIM-UBY TO IPT-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO IPT-IIC-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO IPT-COD-EVEN-ATR.
           MOVE FRM-CPIM-UBY TO IPT-NUM-ICAN-ATR.
           MOVE FRM-CPIM-UBY TO IPT-COD-CPTO-ATR.
           MOVE FRM-CPIM-UBY TO IPT-NUM-CPTO-ATR.
       FIN-UNP-IKY-IPT.
           EXIT.
       
       UNP-MKY-IPT SECTION.
       INI-UNP-MKY-IPT.
       FIN-UNP-MKY-IPT.
           EXIT.
       
       UNP-AKY-IPT SECTION.
       INI-UNP-AKY-IPT.
       FIN-UNP-AKY-IPT.
           EXIT.
       
       UNP-FLD-IPT SECTION.
       INI-UNP-FLD-IPT.
           PERFORM UNP-IPT-IPT.
       FIN-UNP-FLD-IPT.
           EXIT.
       
       UNP-IPT-IPT SECTION.
       INI-UNP-IPT-IPT.
           MOVE FRM-CPIM-UBY TO IPT-CIC-ORIG-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-COD-IEMI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-CAI-IORI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-IIC-IORI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-NUM-PTRM-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-VAL-CTRA-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-FEC-FORI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-FEC-FMAV-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-FEC-FINI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-FEC-FTER-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-SGV-TUNI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-SGV-TACU-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-NUM-PDES-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-COD-ITRU-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-FEC-TTRI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-COD-TDOC-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-MSC-TIMP-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-SGV-MORI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-COD-VCOC-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-SGV-MNTO-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-COD-TIPO-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-MSC-STAT-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-SGV-CUOT-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-GLS-NORM-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-SGV-VTOT-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-NUM-FOLI-ATR IN IPT-FLD.
           MOVE FRM-CPIM-UBY TO IPT-SGV-MCAL-ATR IN IPT-FLD.
       FIN-UNP-IPT-IPT.
           EXIT.
       
       VAL-MKY-IPT SECTION.
       INI-VAL-MKY-IPT.
       FIN-VAL-MKY-IPT.
           EXIT.
       
       VAL-FLD-IPT SECTION.
       INI-VAL-FLD-IPT.
      *<<<< INI_VAL_FLD_IPT                                            
           IF SCR-CMND = 'IPA'
               PERFORM VAL-IPT-CAI-IORI
               IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                   MOVE FRM-IND-ERRO TO IPT-CAI-IORI-LEN IN IPT-FLD
                   GO TO FIN-VAL-FLD-IPT
               ELSE
               PERFORM VAL-IPT-IIC-IORI
               IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                   MOVE FRM-IND-ERRO TO IPT-IIC-IORI-LEN IN IPT-FLD
                   GO TO FIN-VAL-FLD-IPT
               ELSE
                   GO TO FIN-VAL-FLD-IPT.
           IF SCR-CMND = 'MCA'
               PERFORM VAL-IPT-VAL-CTRA
               IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                   MOVE FRM-IND-ERRO TO IPT-VAL-CTRA-LEN IN IPT-FLD
                   GO TO FIN-VAL-FLD-IPT
               ELSE
               PERFORM VAL-IPT-MSC-STAT
               IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                   MOVE FRM-IND-ERRO TO IPT-MSC-STAT-LEN IN IPT-FLD
                   GO TO FIN-VAL-FLD-IPT
               ELSE
                   PERFORM MCA-TAS-ACUM
                   GO TO FIN-VAL-FLD-IPT.
      *>>>>
           PERFORM VAL-FRM-GLS-EVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EVEN-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-FRM-GLS-CPTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CPTO-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-CIC-ORIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-CIC-ORIG-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-COD-IEMI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-COD-IEMI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-CAI-IORI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-CAI-IORI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-IIC-IORI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-IIC-IORI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-FRM-GLS-IEMI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-IEMI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-NUM-PTRM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-NUM-PTRM-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-VAL-CTRA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-VAL-CTRA-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IPT-FEC-FCOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                IPT-FEC-FCOL-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IPT-FEC-FORI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                IPT-FEC-FORI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IPT-FEC-FMAV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                IPT-FEC-FMAV-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IPT-FEC-FINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                IPT-FEC-FINI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IPT-FEC-FTER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                IPT-FEC-FTER-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IPT-SGV-TUNI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-TUNI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-SGV-TOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-TOPE-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-SGV-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-TINT-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-SGV-TACU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-TACU-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-NUM-PDES.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-NUM-PDES-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-COD-ITRU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-COD-ITRU-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IPT-FEC-TTRI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                IPT-FEC-TTRI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-IPT-COD-TDOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-COD-TDOC-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-MSC-TIMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-MSC-TIMP-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-SGV-MORI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-MORI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-COD-VCOC-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-SGV-MNTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-MNTO-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-COD-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-COD-TIPO-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-MSC-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-MSC-STAT-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-SGV-CUOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-CUOT-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-FRM-GLS-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TIPO-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-FRM-GLS-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-STAT-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-SGV-VDES.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-VDES-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-GLS-NORM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-GLS-NORM-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-SGV-VTOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-VTOT-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-NUM-FOLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-NUM-FOLI-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-SGV-MCAL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-SGV-MCAL-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
           PERFORM VAL-IPT-COD-ATRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO IPT-COD-ATRN-LEN IN IPT-FLD
                GO TO FIN-VAL-FLD-IPT.
       FIN-VAL-FLD-IPT.
           EXIT.
       
       VAL-FRM-GLS-EVEN SECTION.
       INI-VAL-FRM-GLS-EVEN.
       FIN-VAL-FRM-GLS-EVEN.
           EXIT.
       
       VAL-FRM-GLS-CPTO SECTION.
       INI-VAL-FRM-GLS-CPTO.
       FIN-VAL-FRM-GLS-CPTO.
           EXIT.
       
       VAL-IPT-CIC-ORIG SECTION.
       INI-VAL-IPT-CIC-ORIG.
           IF IPT-CIC-ORIG IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-CIC-ORIG IN IPT-FLD.
      *<<<< FIN_IPT_CIC_ORIG                                        
           MOVE IPT-CAI-IOPC IN IPT-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE IPT-IIC-IOPC IN IPT-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE 1                       TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'DLCNEX    ' TO MSG-COD-MENS
               MOVE 'S' TO SCR-IERR
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-IPT-CIC-ORIG.

           MOVE DLC-MSC-TIMP IN DLC TO WSS-MSC-TIMP IN WSS-VARI.
           MOVE DLC-COD-TDOC IN DLC TO WSS-COD-TDOC IN WSS-VARI.

      *VALIDA QUE NO SEA IMPUESTO INFORMADO                             
           IF DLC-MSC-TIMP IN DLC > SPACES                              
               MOVE 'COL'                   TO MSC-COD-SIST             
               MOVE 'TIMP'                  TO MSC-COD-TMSC IN MSC      
               MOVE DLC-MSC-TIMP IN DLC     TO MSC-COD-CMSC IN MSC      
               PERFORM BUS-MSC                                          
               IF MSC-CIC-MSCL IN MSC = 'I'
                  MOVE MSC-CIC-MSCL IN MSC TO WSS-MSC-TIMP IN WSS-VARI.

      *    IF IPT-COD-EVEN IN IPT-FLD = 'HIS' AND
      *       IPT-CIC-ORIG IN IPT-FLD NOT > SPACES
      *       PERFORM ERR-GLS
      *       GO TO FIN-VAL-IPT-CIC-ORIG.

      *    IF WSS-MSC-TIMP IN WSS-VARI = 'I'
      *       IF IPT-COD-EVEN IN IPT-FLD = 'CUR' AND
      *          IPT-CIC-ORIG IN IPT-FLD NOT > SPACES
      *           PERFORM ERR-GLS
      *           GO TO FIN-VAL-IPT-CIC-ORIG.
      *>>>>
       FIN-VAL-IPT-CIC-ORIG.
           EXIT.
       
       VAL-IPT-COD-IEMI SECTION.
       INI-VAL-IPT-COD-IEMI.
           IF IPT-COD-IEMI IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-COD-IEMI IN IPT-FLD.
      *<<<< IPT_COD_IEMI                                                
           IF IPT-COD-IEMI IN IPT-FLD NOT > SPACES AND
              IPT-COD-EVEN IN IPT-FLD = 'HIS'
              MOVE 'BCO' TO IPT-COD-IEMI IN IPT-FLD.
      *       GO TO FIN-VAL-IPT-COD-IEMI.

      *    IF WSS-MSC-TIMP IN WSS-VARI = 'I'
      *       IF IPT-COD-IEMI IN IPT-FLD NOT > SPACES AND
      *          IPT-COD-EVEN IN IPT-FLD = 'CUR'
      *           PERFORM ERR-GLS
      *           GO TO FIN-VAL-IPT-COD-IEMI.
      *
           IF IPT-COD-IEMI IN IPT-FLD NOT > SPACES
              GO TO FIN-VAL-IPT-COD-IEMI.
           MOVE IPT-COD-IEMI IN IPT-FLD TO IPT-COD-IEMI IN IPT.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'IVB ' TO TAB-COD-TTAB IN TAB.
           MOVE IPT-COD-TIEM IN IPT TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-IEMI IN IPT-FLD
               GO TO FIN-VAL-IPT-COD-IEMI.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE IPT-COD-TIEM IN IPT TO TAB-COD-TTAB IN TAB.
           MOVE IPT-COD-INEM IN IPT TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              IPT-COD-IEMI IN IPT-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-IEMI IN IPT-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IEMI IN IPT-FLD.
           GO TO FIN-VAL-IPT-COD-IEMI.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'IVB ' TO TAB-COD-TTAB IN TAB.
           MOVE IPT-COD-IEMI IN IPT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              IPT-COD-IEMI IN IPT-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-IEMI IN IPT-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IEMI IN IPT-FLD.
       FIN-VAL-IPT-COD-IEMI.
           EXIT.
       
       VAL-IPT-CAI-IORI SECTION.
       INI-VAL-IPT-CAI-IORI.
      *<<<< INI_IPT_CAI_IORI          
           IF SCR-CMND = 'IPA' AND                                              
              IPT-CAI-IORI IN IPT-FLD NOT > SPACES                              
                PERFORM ERR-GLS                                                 
                GO TO FIN-VAL-IPT-CAI-IORI.                                    
           IF SCR-CMND = 'IPA'
               PERFORM VAL-IPT-REL
               IF WSS-IND-OREL NOT = 'S'
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPC NO REL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-IPT-CAI-IORI.
      *>>>>
           IF IPT-CAI-IORI IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-CAI-IORI IN IPT-FLD.
       FIN-VAL-IPT-CAI-IORI.
           EXIT.
       
       VAL-IPT-IIC-IORI SECTION.
       INI-VAL-IPT-IIC-IORI.
      *<<<< INI_IPT_IIC_IORI          
           IF SCR-CMND = 'IPA' AND                                              
              IPT-IIC-IORI IN IPT-FLD NOT > ZEROES                              
                PERFORM ERR-GLS                                                 
                GO TO FIN-VAL-IPT-IIC-IORI.                                     
      *>>>>
       FIN-VAL-IPT-IIC-IORI.
           EXIT.
       
       VAL-FRM-GLS-IEMI SECTION.
       INI-VAL-FRM-GLS-IEMI.
       FIN-VAL-FRM-GLS-IEMI.
           EXIT.
       
       VAL-IPT-NUM-PTRM SECTION.
       INI-VAL-IPT-NUM-PTRM.
      *<<<< INI_IPT_NUM_PTRM                                                  
      *>>>>
           IF IPT-NUM-PTRM IN IPT-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-IPT-NUM-PTRM.
      *<<<< FIN_IPT_NUM_PTRM                        
           MOVE 'COL'    TO FIO-SIST.                                           
           MOVE 'IPT '   TO TAB-COD-TTAB IN TAB.                                
           MOVE 'IPTEXC' TO TAB-COD-CTAB IN TAB.                                
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS AND                                         
               TAB-IND-VIGE IN TAB = 'S')                               
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.            
                                                                                
           IF IPT-NUM-PTRM IN IPT-FLD > ZEROES AND                              
              IPT-NUM-PTRM IN IPT-FLD > WSS-NUM-MAXI IN WSS-VARI                
              MOVE 'COL'        TO MSG-COD-SIST                         
              MOVE 'ERRVALTRM ' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-IPT-NUM-PTRM.                             
      *>>>>
       FIN-VAL-IPT-NUM-PTRM.
           EXIT.
       
       VAL-IPT-VAL-CTRA SECTION.
       INI-VAL-IPT-VAL-CTRA.
      *<<<< INI_IPT_VAL_CTRA                                                  
      *>>>>
           IF IPT-VAL-CTRA IN IPT-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-IPT-VAL-CTRA.
      *<<<< FIN_IPT_VAL_CTRA

           IF IPT-VAL-CTRA IN IPT-FLD < IPT-NUM-PTRM IN IPT-FLD         
              MOVE 'COL'        TO MSG-COD-SIST                         
              MOVE 'CTRA>PTRM ' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-IPT-VAL-CTRA.                               
                                                                               
           MOVE 'COL'    TO FIO-SIST.                                           
           MOVE 'IPT '   TO TAB-COD-TTAB IN TAB.                                
           MOVE 'IPTEXC' TO TAB-COD-CTAB IN TAB.                                
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS AND                                         
               TAB-IND-VIGE IN TAB = 'S')                               
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.            
                                                                                
           IF IPT-VAL-CTRA IN IPT-FLD > ZEROES AND                              
              IPT-VAL-CTRA IN IPT-FLD > WSS-NUM-MAXI IN WSS-VARI                
              MOVE 'COL'        TO MSG-COD-SIST                         
              MOVE 'ERRVALTRA ' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-IPT-VAL-CTRA.                                       
      *>>>>
       FIN-VAL-IPT-VAL-CTRA.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-IPT-FEC-FCOL SECTION.
       INI-VAL-IPT-FEC-FCOL.
           IF IPT-FEC-FCOL IN IPT-FLD  NOT > ZEROES
              MOVE ZEROES TO IPT-FEC-FCOL IN IPT-FLD.
      *<<<< FIN_IPT_FEC_FCOL                                                    

           MOVE IPT-CAI-IOPC IN IPT-FLD TO OPC-CAI-IOPC IN OPC.                 
           MOVE IPT-IIC-IOPC IN IPT-FLD TO OPC-IIC-IOPC IN OPC.                 
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM COL-FIO-OPC.                                                 
           IF FIO-STAT-OKS                                                      
               MOVE OPC-NUM-DCOL IN OPC TO IPT-NUM-DCOL IN IPT-FLD     
               MOVE OPC-NUM-MCOL IN OPC TO IPT-NUM-MCOL IN IPT-FLD      
               MOVE OPC-NUM-SCOL IN OPC TO IPT-NUM-SCOL IN IPT-FLD      
               MOVE OPC-NUM-ACOL IN OPC TO IPT-NUM-ACOL IN IPT-FLD.    
      *>>>>
       FIN-VAL-IPT-FEC-FCOL.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-IPT-FEC-FORI SECTION.
       INI-VAL-IPT-FEC-FORI.
           IF IPT-FEC-FORI IN IPT-FLD  NOT > ZEROES
              MOVE ZEROES TO IPT-FEC-FORI IN IPT-FLD.
      *VAL-FEC Validar Fecha
           MOVE IPT-FEC-FORI IN IPT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_IPT_FEC_FORI                                         

           IF WSS-MSC-TIMP IN WSS-VARI = 'I' AND
              IPT-COD-EVEN IN IPT-FLD NOT = 'HIS'
      *       IPT-COD-EVEN IN IPT-FLD NOT = 'HIS' AND
      *       SCR-CMND = 'ING'
               MOVE IPT-FEC-FCOL IN IPT-FLD TO IPT-FEC-FORI IN IPT-FLD
               GO TO CON-VAL-IPT-FEC-FORI.

           IF IPT-FEC-FORI IN IPT-FLD  NOT > ZEROES
              PERFORM ERR-GLS
              GO TO FIN-VAL-IPT-FEC-FORI.

           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N  TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO IPT-FEC-FORI IN IPT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-IPT-FEC-FORI.
      *<<<< FIN_IPT_FEC_FORI 
       CON-VAL-IPT-FEC-FORI.
           MOVE IPT-CAI-IOPC IN IPT-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE IPT-IIC-IOPC IN IPT-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF FIO-STAT-OKS                                              
               MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DCUR IN WSS-VARI     
               MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MCUR IN WSS-VARI     
               MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SCUR IN WSS-VARI     
               MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-ACUR IN WSS-VARI.    
                                                            
           MOVE IPT-NUM-SORI IN IPT-FLD TO WSS-NUM-SORI IN WSS-VARI.            
           MOVE IPT-NUM-AORI IN IPT-FLD TO WSS-NUM-AORI IN WSS-VARI.            
           MOVE IPT-NUM-MORI IN IPT-FLD TO WSS-NUM-MORI IN WSS-VARI.            
           MOVE IPT-NUM-DORI IN IPT-FLD TO WSS-NUM-DORI IN WSS-VARI.            
                                                                                
           IF WSS-FEC-FORI IN WSS-VARI > WSS-FEC-FCUR IN WSS-VARI               
              MOVE 'COL'        TO MSG-COD-SIST                                 
              MOVE 'FEC COLMAY' TO MSG-COD-MENS                                 
              PERFORM GET-MSG                                                   
              MOVE MSG-GLS-DESC TO FRM-MENS                                     
              MOVE FRM-SUAR-MAL TO FRM-SUAR                                     
              GO TO FIN-VAL-IPT-FEC-FORI.                              
           PERFORM OBT-DAT-ITIM.                                        
           IF MSG-COD-MENS > SPACES
              MOVE 'COL'        TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-IPT-FEC-FORI.
      *>>>>
       FIN-VAL-IPT-FEC-FORI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-IPT-FEC-FMAV SECTION.
       INI-VAL-IPT-FEC-FMAV.
           IF IPT-FEC-FMAV IN IPT-FLD  NOT > ZEROES
              MOVE ZEROES TO IPT-FEC-FMAV IN IPT-FLD.
      *VAL-FEC Validar Fecha
           MOVE IPT-FEC-FMAV IN IPT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_IPT_FEC_FMAV                                         
           IF WSS-MSC-TIMP IN WSS-VARI = 'I' AND
              IPT-COD-EVEN IN IPT-FLD NOT = 'HIS'
      *       IPT-COD-EVEN IN IPT-FLD NOT = 'HIS' AND
      *       SCR-CMND = 'ING'
               MOVE DLC-NUM-SMAV IN DLC TO IPT-NUM-SMAV IN IPT-FLD
               MOVE DLC-NUM-AMAV IN DLC TO IPT-NUM-AMAV IN IPT-FLD
               MOVE DLC-NUM-MMAV IN DLC TO IPT-NUM-MMAV IN IPT-FLD
               MOVE DLC-NUM-DMAV IN DLC TO IPT-NUM-DMAV IN IPT-FLD
               GO TO FIN-VAL-IPT-FEC-FMAV.

           IF IPT-FEC-FMAV IN IPT-FLD  NOT > ZEROES
              PERFORM ERR-GLS
              GO TO FIN-VAL-IPT-FEC-FMAV.

           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N  TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO IPT-FEC-FMAV IN IPT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-IPT-FEC-FMAV.
      *<<<< FIN_IPT_FEC_FMAV                                           
           MOVE IPT-NUM-SORI IN IPT-FLD TO WSS-NUM-SORI IN WSS-VARI.    
           MOVE IPT-NUM-AORI IN IPT-FLD TO WSS-NUM-AORI IN WSS-VARI.    
           MOVE IPT-NUM-MORI IN IPT-FLD TO WSS-NUM-MORI IN WSS-VARI.    
           MOVE IPT-NUM-DORI IN IPT-FLD TO WSS-NUM-DORI IN WSS-VARI.         
                                                                                
           MOVE IPT-NUM-SMAV IN IPT-FLD TO WSS-NUM-SMAV IN WSS-VARI.            
           MOVE IPT-NUM-AMAV IN IPT-FLD TO WSS-NUM-AMAV IN WSS-VARI.            
           MOVE IPT-NUM-MMAV IN IPT-FLD TO WSS-NUM-MMAV IN WSS-VARI.            
           MOVE IPT-NUM-DMAV IN IPT-FLD TO WSS-NUM-DMAV IN WSS-VARI.            

           IF IPT-FEC-FORI IN IPT-FLD NOT > ZEROES                      
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'FORI VACIA' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-IPT-FEC-FMAV.                              
                                                                        
           IF WSS-FEC-FMAV IN WSS-VARI < WSS-FEC-FORI IN WSS-VARI       
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'FMAV<FORI ' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-IPT-FEC-FMAV.                              
                                                                                
       NXT-VAL-IPT-FEC-FMAV.                                                    
           MOVE IPT-CAI-IOPC IN IPT-FLD TO DLC-CAI-IOPC IN DLC.                 
           MOVE IPT-IIC-IOPC IN IPT-FLD TO DLC-IIC-IOPC IN DLC.                 
           MOVE 999                     TO DLC-NUM-IDLC IN DLC.                 
           MOVE FIO-GET-LEQ  TO FIO-CMND.                                       
           PERFORM COL-FIO-DLC.                                                 
           IF NOT (FIO-STAT-OKS AND                                             
              IPT-CAI-IOPC IN IPT-FLD = DLC-CAI-IOPC IN DLC AND                 
              IPT-IIC-IOPC IN IPT-FLD = DLC-IIC-IOPC IN DLC)                    
              GO TO FIN-VAL-IPT-FEC-FMAV.                                       
                                                                                
           MOVE DLC-NUM-SMAV IN DLC TO WSS-NUM-SDAV IN WSS-VARI.                
           MOVE DLC-NUM-AMAV IN DLC TO WSS-NUM-ADAV IN WSS-VARI.                
           MOVE DLC-NUM-MMAV IN DLC TO WSS-NUM-MDAV IN WSS-VARI.                
           MOVE DLC-NUM-DMAV IN DLC TO WSS-NUM-DDAV IN WSS-VARI.                
                                                                                
           IF WSS-FEC-FDAV IN WSS-VARI NOT > ZEROES                             
               GO TO FIN-VAL-IPT-FEC-FMAV.                                      
                                                                                
           IF WSS-FEC-FMAV IN WSS-VARI > WSS-FEC-FDAV IN WSS-VARI               
               MOVE 'COL'        TO MSG-COD-SIST                                
               MOVE 'FEC VENMAY' TO MSG-COD-MENS                                
               PERFORM GET-MSG                                                  
               MOVE MSG-GLS-DESC TO FRM-MENS                                    
               MOVE FRM-SUAR-MAL TO FRM-SUAR                                    
               GO TO FIN-VAL-IPT-FEC-FMAV.                      
      *>>>>
       FIN-VAL-IPT-FEC-FMAV.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-IPT-FEC-FINI SECTION.
       INI-VAL-IPT-FEC-FINI.
           IF IPT-FEC-FINI IN IPT-FLD  NOT > ZEROES
              MOVE ZEROES TO IPT-FEC-FINI IN IPT-FLD.
      *VAL-FEC Validar Fecha
           MOVE IPT-FEC-FINI IN IPT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_IPT_FEC_FINI                                         
           IF WSS-MSC-TIMP IN WSS-VARI = 'I' AND
              IPT-COD-EVEN IN IPT-FLD NOT = 'HIS'
      *       IPT-COD-EVEN IN IPT-FLD NOT = 'HIS' AND
      *       SCR-CMND = 'ING'
               MOVE IPT-FEC-FCOL IN IPT-FLD TO IPT-FEC-FINI IN IPT-FLD
               GO TO FIN-VAL-IPT-FEC-FINI.

           IF IPT-FEC-FINI IN IPT-FLD  NOT > ZEROES
              PERFORM ERR-GLS
              GO TO FIN-VAL-IPT-FEC-FINI.

           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N  TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO IPT-FEC-FINI IN IPT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-IPT-FEC-FINI.
      *<<<< FIN_IPT_FEC_FINI                                    
           MOVE IPT-NUM-SINI IN IPT-FLD TO WSS-NUM-SINI IN WSS-VARI.            
           MOVE IPT-NUM-AINI IN IPT-FLD TO WSS-NUM-AINI IN WSS-VARI.            
           MOVE IPT-NUM-MINI IN IPT-FLD TO WSS-NUM-MINI IN WSS-VARI.            
           MOVE IPT-NUM-DINI IN IPT-FLD TO WSS-NUM-DINI IN WSS-VARI.            
                                                                                
           MOVE IPT-NUM-SORI IN IPT-FLD TO WSS-NUM-SORI IN WSS-VARI.            
           MOVE IPT-NUM-AORI IN IPT-FLD TO WSS-NUM-AORI IN WSS-VARI.            
           MOVE IPT-NUM-MORI IN IPT-FLD TO WSS-NUM-MORI IN WSS-VARI.            
           MOVE IPT-NUM-DORI IN IPT-FLD TO WSS-NUM-DORI IN WSS-VARI.            
                                                                                
           IF WSS-FEC-FORI IN WSS-VARI > WSS-FEC-FINI IN WSS-VARI               
               MOVE 'COL'        TO MSG-COD-SIST                                
               MOVE 'FORI>FINI ' TO MSG-COD-MENS                                
               PERFORM GET-MSG                                                  
               MOVE MSG-GLS-DESC TO FRM-MENS                                    
               MOVE FRM-SUAR-MAL TO FRM-SUAR                                    
               GO TO FIN-VAL-IPT-FEC-FINI.                              
      *>>>>
       FIN-VAL-IPT-FEC-FINI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-IPT-FEC-FTER SECTION.
       INI-VAL-IPT-FEC-FTER.
           IF IPT-FEC-FTER IN IPT-FLD  NOT > ZEROES
              MOVE ZEROES TO IPT-FEC-FTER IN IPT-FLD.
      *VAL-FEC Validar Fecha
           MOVE IPT-FEC-FTER IN IPT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_IPT_FEC_FTER                                         
           IF WSS-MSC-TIMP IN WSS-VARI = 'I' AND
              IPT-COD-EVEN IN IPT-FLD NOT = 'HIS'
      *       IPT-COD-EVEN IN IPT-FLD NOT = 'HIS' AND
      *       SCR-CMND = 'ING'
               PERFORM CAL-FTER
               GO TO FIN-VAL-IPT-FEC-FTER.

           IF IPT-FEC-FTER IN IPT-FLD  NOT > ZEROES
              PERFORM ERR-GLS
              GO TO FIN-VAL-IPT-FEC-FTER.

       NXT-IPT-FEC-FTER.

           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO IPT-FEC-FTER IN IPT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-IPT-FEC-FTER.
      *<<<< FIN_IPT_FEC_FTER
           IF IPT-FEC-FINI IN IPT-FLD NOT > ZEROES                      
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'FINI VACIA' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-IPT-FEC-FMAV.                              
                                                                        
           IF IPT-FEC-FMAV IN IPT-FLD NOT > ZEROES                      
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'FMAV VACIA' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-IPT-FEC-FMAV.                              
      
           MOVE IPT-NUM-STER IN IPT-FLD TO WSS-NUM-STER IN WSS-VARI.            
           MOVE IPT-NUM-ATER IN IPT-FLD TO WSS-NUM-ATER IN WSS-VARI.            
           MOVE IPT-NUM-MTER IN IPT-FLD TO WSS-NUM-MTER IN WSS-VARI.            
           MOVE IPT-NUM-DTER IN IPT-FLD TO WSS-NUM-DTER IN WSS-VARI.            

           MOVE IPT-NUM-SMAV IN IPT-FLD TO WSS-NUM-SMAV IN WSS-VARI.    
           MOVE IPT-NUM-AMAV IN IPT-FLD TO WSS-NUM-AMAV IN WSS-VARI.    
           MOVE IPT-NUM-MMAV IN IPT-FLD TO WSS-NUM-MMAV IN WSS-VARI.    
           MOVE IPT-NUM-DMAV IN IPT-FLD TO WSS-NUM-DMAV IN WSS-VARI.    
                                                                        
           MOVE IPT-NUM-SINI IN IPT-FLD TO WSS-NUM-SINI IN WSS-VARI.    
           MOVE IPT-NUM-AINI IN IPT-FLD TO WSS-NUM-AINI IN WSS-VARI.    
           MOVE IPT-NUM-MINI IN IPT-FLD TO WSS-NUM-MINI IN WSS-VARI.    
           MOVE IPT-NUM-DINI IN IPT-FLD TO WSS-NUM-DINI IN WSS-VARI.    
                                                                                
           IF WSS-FEC-FINI IN WSS-VARI > WSS-FEC-FTER IN WSS-VARI               
               MOVE 'COL'        TO MSG-COD-SIST                                
               MOVE 'FEC ERRINI' TO MSG-COD-MENS                                
               PERFORM GET-MSG                                                  
               MOVE MSG-GLS-DESC TO FRM-MENS                                    
               MOVE FRM-SUAR-MAL TO FRM-SUAR                                    
               GO TO FIN-VAL-IPT-FEC-FTER.                                      
                                                                                
           IF WSS-FEC-FTER IN WSS-VARI > WSS-FEC-FMAV IN WSS-VARI               
               MOVE 'COL'        TO MSG-COD-SIST                                
               MOVE 'FEC MAVMAY' TO MSG-COD-MENS                                
               PERFORM GET-MSG                                                  
               MOVE MSG-GLS-DESC TO FRM-MENS                                    
               MOVE FRM-SUAR-MAL TO FRM-SUAR                                    
               GO TO FIN-VAL-IPT-FEC-FTER.                       
      *>>>>
       FIN-VAL-IPT-FEC-FTER.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-IPT-SGV-TUNI SECTION.
       INI-VAL-IPT-SGV-TUNI.
      *<<<< INI_IPT_SGV_TUNI 

           IF WSS-MSC-TIMP IN WSS-VARI = 'I' AND
              WSS-IBLK-TUNI = 'S'
               IF IPT-SGV-TUNI IN IPT-FLD NOT > ZEROES
                   PERFORM ERR-GLS
                   GO TO FIN-VAL-IPT-SGV-TUNI.
           IF IPT-SGV-TUNI IN IPT-FLD NOT < 100
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'TUNI > 100' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-IPT-SGV-TUNI.
      *>>>>
       FIN-VAL-IPT-SGV-TUNI.
           EXIT.
       
       VAL-IPT-SGV-TOPE SECTION.
       INI-VAL-IPT-SGV-TOPE.
      *<<<< INI_IPT_SGV_TOPE 

           IF WSS-MSC-TIMP IN WSS-VARI NOT = 'I'
               GO TO FIN-VAL-IPT-SGV-TOPE.
           MOVE 'COL'    TO FIO-SIST.
           MOVE 'IPT '   TO TAB-COD-TTAB IN TAB.
           MOVE 'IPTEXC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS AND                                         
               TAB-IND-VIGE IN TAB = 'S')                               
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.

           COMPUTE IPT-SGV-TOPE IN IPT-FLD = WSS-NUM-MAXI *
                   IPT-SGV-TUNI IN IPT-FLD.
      *>>>>
       FIN-VAL-IPT-SGV-TOPE.
           EXIT.
       
       VAL-IPT-SGV-TINT SECTION.
       INI-VAL-IPT-SGV-TINT.
      *<<<< INI_IPT_SGV_TINT
      *>>>>
       FIN-VAL-IPT-SGV-TINT.
           EXIT.
       
       VAL-IPT-SGV-TACU SECTION.
       INI-VAL-IPT-SGV-TACU.
      *<<<< INI_IPT_SGV_TACU

           IF SCR-CMND = 'MCA'
              MOVE IPT-CAI-IOPC IN IPT-FLD TO IPT-CAI-IOPC IN IPT
              MOVE IPT-IIC-IOPC IN IPT-FLD TO IPT-IIC-IOPC IN IPT
              MOVE IPT-COD-EVEN IN IPT-FLD TO IPT-COD-EVEN IN IPT
              MOVE IPT-NUM-ICAN IN IPT-FLD TO IPT-NUM-ICAN IN IPT
              MOVE IPT-COD-CPTO IN IPT-FLD TO IPT-COD-CPTO IN IPT
              MOVE IPT-NUM-CPTO IN IPT-FLD TO IPT-NUM-CPTO IN IPT
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-IPT
              IF FIO-STAT-OKS AND
              IPT-SGV-TINT IN IPT-FLD NOT = IPT-SGV-TINT IN IPT
                COMPUTE WSS-DIF-TINT IN WSS-VARI ROUNDED =
                        IPT-SGV-TINT IN IPT-FLD -
                        IPT-SGV-TINT IN IPT
                COMPUTE IPT-SGV-TACU IN IPT-FLD  ROUNDED =
                        IPT-SGV-TACU IN IPT +
                        WSS-DIF-TINT IN WSS-VARI
                GO TO FIN-VAL-IPT-SGV-TACU.

      *    IF IPT-SGV-TACU IN IPT-FLD > ZEROES
      *       GO TO FIN-VAL-IPT-SGV-TACU
      *    ELSE
               MOVE IPT-SGV-TINT IN IPT-FLD  TO IPT-SGV-TACU IN IPT-FLD.  
      *>>>>
       FIN-VAL-IPT-SGV-TACU.
           EXIT.
       
       VAL-IPT-NUM-PDES SECTION.
       INI-VAL-IPT-NUM-PDES.
      *<<<< INI_IPT_NUM_PDES 
           IF WSS-MSC-TIMP IN WSS-VARI = 'I' AND
              WSS-IBLK-PDES = 'S'
               IF IPT-NUM-PDES IN IPT-FLD NOT > ZEROES
                   PERFORM ERR-GLS
                   GO TO FIN-VAL-IPT-NUM-PDES.

           IF IPT-NUM-PDES IN IPT-FLD > 100
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'VDES > 100' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-IPT-NUM-PDES.

      *>>>>
       FIN-VAL-IPT-NUM-PDES.
           EXIT.
       
       VAL-IPT-COD-ITRU SECTION.
       INI-VAL-IPT-COD-ITRU.
           IF IPT-COD-ITRU IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-COD-ITRU IN IPT-FLD.
       FIN-VAL-IPT-COD-ITRU.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-IPT-FEC-TTRI SECTION.
       INI-VAL-IPT-FEC-TTRI.
           IF IPT-FEC-TTRI IN IPT-FLD  NOT > ZEROES
              MOVE ZEROES TO IPT-FEC-TTRI IN IPT-FLD.
      *VAL-FEC Validar Fecha
           MOVE IPT-FEC-TTRI IN IPT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_IPT_FEC_TTRI
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO IPT-FEC-TTRI IN IPT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-IPT-FEC-TTRI.
       FIN-VAL-IPT-FEC-TTRI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-IPT-COD-TDOC SECTION.
       INI-VAL-IPT-COD-TDOC.
           IF IPT-COD-TDOC IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-COD-TDOC IN IPT-FLD.
       FIN-VAL-IPT-COD-TDOC.
           EXIT.
       
       VAL-IPT-MSC-TIMP SECTION.
       INI-VAL-IPT-MSC-TIMP.
           IF IPT-MSC-TIMP IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-MSC-TIMP IN IPT-FLD.
       FIN-VAL-IPT-MSC-TIMP.
           EXIT.
       
       VAL-IPT-SGV-MORI SECTION.
       INI-VAL-IPT-SGV-MORI.
       FIN-VAL-IPT-SGV-MORI.
           EXIT.
       
       VAL-IPT-COD-VCOC SECTION.
       INI-VAL-IPT-COD-VCOC.
           IF IPT-COD-VCOC IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-COD-VCOC IN IPT-FLD.
       FIN-VAL-IPT-COD-VCOC.
           EXIT.
       
       VAL-IPT-SGV-MNTO SECTION.
       INI-VAL-IPT-SGV-MNTO.
      *<<<< INI_IPT_SGV_MNTO                                       
      *    IF SCR-CMND = 'ING' AND
           IF IPT-COD-EVEN IN IPT-FLD NOT = 'HIS' AND
              WSS-MSC-TIMP IN WSS-VARI = 'I'
               MOVE IPT-CAI-IOPC IN IPT-FLD TO OPC-CAI-IOPC IN OPC
               MOVE IPT-IIC-IOPC IN IPT-FLD TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
                  MOVE OPC-VAL-CRED IN OPC TO IPT-SGV-MNTO IN IPT-FLD
                  PERFORM VAL-CAM-OPC
                  IF MSG-COD-MENS IN MSG > SPACES
                      MOVE 'COL'          TO MSG-COD-SIST
                      MOVE 'CAM    NEX' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MEN1
                      MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO FIN-VAL-IPT-SGV-MNTO
                  ELSE
                      GO TO FIN-VAL-IPT-SGV-MNTO.

           IF IPT-SGV-MNTO IN IPT-FLD NOT > ZEROES
              PERFORM ERR-GLS
              GO TO FIN-VAL-IPT-SGV-MNTO.
      *>>>>
       FIN-VAL-IPT-SGV-MNTO.
           EXIT.
       
       VAL-IPT-COD-TIPO SECTION.
       INI-VAL-IPT-COD-TIPO.
      *<<<< INI_IPT_COD_TIPO                                                 
           IF IPT-COD-TIPO IN IPT-FLD NOT > SPACES
               MOVE 'A' TO IPT-COD-TIPO IN IPT-FLD.

           IF IPT-COD-TIPO IN IPT-FLD = WCC-E
               MOVE 100 TO IPT-NUM-PDES IN IPT-FLD.
      *>>>>
           IF IPT-COD-TIPO IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-COD-TIPO IN IPT-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'TEA ' TO TAB-COD-TTAB IN TAB.
           MOVE IPT-COD-TIPO IN IPT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              IPT-COD-TIPO IN IPT-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIPO IN IPT-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIPO IN IPT-FLD.
       FIN-VAL-IPT-COD-TIPO.
           EXIT.
       
       VAL-IPT-MSC-STAT SECTION.
       INI-VAL-IPT-MSC-STAT.
      *<<<< INI_IPT_MSC_STAT  
           IF IPT-MSC-STAT IN IPT-FLD NOT > SPACES
               MOVE 'A' TO IPT-MSC-STAT IN IPT-FLD.
      *>>>> INI_IPT_MSC_STAT 
           IF IPT-MSC-STAT IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-MSC-STAT IN IPT-FLD.
      *<<<< IPT_MSC_STAT                                             

           IF IPT-MSC-STAT IN IPT-FLD NOT > SPACES                              
              PERFORM ERR-GLS                                                   
              GO TO FIN-VAL-IPT-MSC-STAT.                                    
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'SPT ' TO TAB-COD-TTAB IN TAB.
           MOVE IPT-MSC-STAT IN IPT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              IPT-MSC-STAT IN IPT-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-STAT IN IPT-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STAT IN IPT-FLD.
       FIN-VAL-IPT-MSC-STAT.
           EXIT.
       
       VAL-IPT-SGV-CUOT SECTION.
       INI-VAL-IPT-SGV-CUOT.
      *<<<< INI_IPT_SGV_CUOT       
      
      *    IF SCR-CMND = 'ING' AND
           IF IPT-COD-EVEN IN IPT-FLD NOT = 'HIS' AND
              WSS-MSC-TIMP IN WSS-VARI = 'I'
               MOVE IPT-CAI-IOPC IN IPT-FLD TO DLC-CAI-IOPC IN DLC
               MOVE IPT-IIC-IOPC IN IPT-FLD TO DLC-IIC-IOPC IN DLC
               MOVE 1                       TO DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF FIO-STAT-OKS
                  MOVE DLC-VAL-IMPU IN DLC TO IPT-SGV-CUOT IN IPT-FLD
                  GO TO FIN-VAL-IPT-SGV-CUOT.



           COMPUTE WSS-SGV-MNTO IN WSS-VARI ROUNDED =
              IPT-SGV-MNTO IN IPT-FLD * IPT-SGV-TINT IN IPT-FLD / 100.
           MOVE WSS-SGV-MNTO IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.   
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-MNTO IN WSS-VARI.   
           MOVE WSS-SGV-MNTO IN WSS-VARI TO IPT-SGV-CUOT IN IPT-FLD.

           IF IPT-SGV-CUOT IN IPT-FLD > IPT-SGV-MNTO IN IPT-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'VALEXDMTOIPT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-IPT-SGV-CUOT.
      *>>>>
       FIN-VAL-IPT-SGV-CUOT.
           EXIT.
       
       VAL-FRM-GLS-TIPO SECTION.
       INI-VAL-FRM-GLS-TIPO.
       FIN-VAL-FRM-GLS-TIPO.
           EXIT.
       
       VAL-FRM-GLS-STAT SECTION.
       INI-VAL-FRM-GLS-STAT.
       FIN-VAL-FRM-GLS-STAT.
           EXIT.
       
       VAL-IPT-SGV-VDES SECTION.
       INI-VAL-IPT-SGV-VDES.
      *<<<< INI_IPT_SGV_VDES         
           IF WSS-MSC-TIMP IN WSS-VARI = 'I'
                MOVE ZEROES TO IPT-SGV-VDES IN IPT-FLD                          
                GO TO FIN-VAL-IPT-SGV-VDES.                                     
           COMPUTE IPT-SGV-VDES IN IPT-FLD ROUNDED =
                   IPT-SGV-CUOT IN IPT-FLD * 
                   IPT-NUM-PDES IN IPT-FLD /100.
           MOVE IPT-SGV-VDES IN IPT-FLD TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO IPT-SGV-VDES IN IPT-FLD.         
      *>>>>
       FIN-VAL-IPT-SGV-VDES.
           EXIT.
       
       VAL-IPT-GLS-NORM SECTION.
       INI-VAL-IPT-GLS-NORM.
      *<<<< INI_IPT_GLS_NORM                                   

           IF SCR-CMND = 'CON'    OR 
              IPT-GLS-NORM IN IPT-FLD > SPACES                        
               GO TO FIN-VAL-IPT-GLS-NORM.
    
           IF IPT-COD-EVEN IN IPT-FLD = 'HIS'                           
               MOVE 'DL-20130' TO IPT-GLS-NORM IN IPT-FLD.     
      *>>>>
           IF IPT-GLS-NORM IN IPT-FLD NOT > SPACES
              MOVE SPACES TO IPT-GLS-NORM IN IPT-FLD.
       FIN-VAL-IPT-GLS-NORM.
           EXIT.
       
       VAL-IPT-SGV-VTOT SECTION.
       INI-VAL-IPT-SGV-VTOT.
      *<<<< INI_IPT_SGV_VTOT                                          
           COMPUTE IPT-SGV-VTOT IN IPT-FLD ROUNDED = 
                   IPT-SGV-CUOT IN IPT-FLD - IPT-SGV-VDES IN IPT-FLD. 
      *>>>>
       FIN-VAL-IPT-SGV-VTOT.
           EXIT.
       
       VAL-IPT-NUM-FOLI SECTION.
       INI-VAL-IPT-NUM-FOLI.
       FIN-VAL-IPT-NUM-FOLI.
           EXIT.
       
       VAL-IPT-SGV-MCAL SECTION.
       INI-VAL-IPT-SGV-MCAL.
      *<<<< INI_IPT_SGV_MCAL       
            MOVE IPT-SGV-VTOT IN IPT-FLD  TO IPT-SGV-MCAL IN IPT-FLD.
      *>>>>
       FIN-VAL-IPT-SGV-MCAL.
           EXIT.
       
       VAL-IPT-COD-ATRN SECTION.
       INI-VAL-IPT-COD-ATRN.
      *<<<< INI_IPT_COD_ATRN                                            
      *>>>>
      *<<<< INI_IPT_COD_ATRN                                                 
           MOVE SCR-USER TO IPT-COD-ATRN IN IPT-FLD.                
      *>>>>
       FIN-VAL-IPT-COD-ATRN.
           EXIT.
       
       VAL-CON-FLD-IPT SECTION.
       INI-VAL-CON-FLD-IPT.
      *<<<< VAL_CON_FLD_IPT
           IF SCR-CMND = 'IPA' OR
              SCR-CMND = 'MCA'
               GO TO FIN-VAL-CON-FLD-IPT.
           PERFORM CAL-PER.
           IF IPT-NUM-PTRM IN IPT-FLD NOT = FEC-NMES
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'NPTRMNOTRMO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-IPT.
           IF IPT-SGV-TINT IN IPT-FLD > IPT-SGV-TOPE IN IPT-FLD
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'TINT > TOPE' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-IPT.
           PERFORM VAL-TAS-INGRE.
           IF MSG-COD-MENS > SPACES
               MOVE 'COL'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-IPT.
      *>>>> VAL_CON_FLD_IPT
       FIN-VAL-CON-FLD-IPT.
           EXIT.
       
       VAL-CON-IPT SECTION.
       INI-VAL-CON-IPT.
       FIN-VAL-CON-IPT.
           EXIT.
       
       VAL-NUM-KEY-IPT SECTION.
       INI-VAL-NUM-KEY-IPT.
           PERFORM VAL-NUM-IKY-IPT.
           PERFORM VAL-NUM-MKY-IPT.
           PERFORM VAL-NUM-AKY-IPT.
       FIN-VAL-NUM-KEY-IPT.
           EXIT.
       
       VAL-NUM-IKY-IPT SECTION.
       INI-VAL-NUM-IKY-IPT.
       VAL-NUM-IPT-IIC-IOPC.
           MOVE IPT-IIC-IOPC-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0810 TO IPT-IIC-IOPC IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-IIC-IOPC-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-IKY-IPT.
       VAL-NUM-IPT-NUM-ICAN.
           MOVE IPT-NUM-ICAN-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0315 TO IPT-NUM-ICAN IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-NUM-ICAN-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-IKY-IPT.
       VAL-NUM-IPT-NUM-CPTO.
           MOVE IPT-NUM-CPTO-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0315 TO IPT-NUM-CPTO IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-NUM-CPTO-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-IKY-IPT.
       FIN-VAL-NUM-IKY-IPT.
           EXIT.
       
       VAL-NUM-MKY-IPT SECTION.
       INI-VAL-NUM-MKY-IPT.
       FIN-VAL-NUM-MKY-IPT.
           EXIT.
       
       VAL-NUM-AKY-IPT SECTION.
       INI-VAL-NUM-AKY-IPT.
       FIN-VAL-NUM-AKY-IPT.
           EXIT.
       
       VAL-NUM-FLD-IPT SECTION.
       INI-VAL-NUM-FLD-IPT.
      *<<<< INI_VAL_NUM_FLD_IPT
           IF IPT-SGV-TUNI-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TUNI
           ELSE
               MOVE 'N' TO WSS-IBLK-TUNI.

           IF IPT-NUM-PDES-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-PDES
           ELSE
               MOVE 'N' TO WSS-IBLK-PDES.
      *>>>>
       VAL-NUM-IPT-IIC-IORI.
           MOVE IPT-IIC-IORI-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0810 TO IPT-IIC-IORI IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-IIC-IORI-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-NUM-PTRM.
           MOVE IPT-NUM-PTRM-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0315 TO IPT-NUM-PTRM IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-NUM-PTRM-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-VAL-CTRA.
           MOVE IPT-VAL-CTRA-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0315 TO IPT-VAL-CTRA IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-VAL-CTRA-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-TUNI.
           MOVE IPT-SGV-TUNI-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 12 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0315 TO IPT-SGV-TUNI IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-TUNI-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-TOPE.
           MOVE IPT-SGV-TOPE-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 12 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0315 TO IPT-SGV-TOPE IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-TOPE-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-TINT.
           MOVE IPT-SGV-TINT-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 12 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0315 TO IPT-SGV-TINT IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-TINT-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-TACU.
           MOVE IPT-SGV-TACU-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 12 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0315 TO IPT-SGV-TACU IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-TACU-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-NUM-PDES.
           MOVE IPT-NUM-PDES-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 12 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-0315 TO IPT-NUM-PDES IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-NUM-PDES-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-MORI.
           MOVE IPT-SGV-MORI-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-1107 TO IPT-SGV-MORI IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-MORI-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-MNTO.
           MOVE IPT-SGV-MNTO-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-1107 TO IPT-SGV-MNTO IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-MNTO-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-CUOT.
           MOVE IPT-SGV-CUOT-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-1107 TO IPT-SGV-CUOT IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-CUOT-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-VDES.
           MOVE IPT-SGV-VDES-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-1107 TO IPT-SGV-VDES IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-VDES-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-VTOT.
           MOVE IPT-SGV-VTOT-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-1107 TO IPT-SGV-VTOT IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-VTOT-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-NUM-FOLI.
           MOVE IPT-NUM-FOLI-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-1008 TO IPT-NUM-FOLI IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-NUM-FOLI-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       VAL-NUM-IPT-SGV-MCAL.
           MOVE IPT-SGV-MCAL-ALF IN IPT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE VNM-1107 TO IPT-SGV-MCAL IN IPT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO IPT-SGV-MCAL-LEN IN IPT-FLD
                GO TO FIN-VAL-NUM-FLD-IPT.
       FIN-VAL-NUM-FLD-IPT.
           EXIT.
       
       EDT-KEY-IPT SECTION.
       INI-EDT-KEY-IPT.
           PERFORM EDT-IKY-IPT.
           PERFORM EDT-MKY-IPT.
           PERFORM EDT-AKY-IPT.
       FIN-EDT-KEY-IPT.
           EXIT.
       
       EDT-IKY-IPT SECTION.
       INI-EDT-IKY-IPT.
           IF IPT-IIC-IOPC-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-IIC-IOPC-LEN IN IPT-FLD
                GO TO FIN-EDT-IKY-IPT.
           MOVE IPT-IIC-IOPC IN IPT-FLD TO IPT-IIC-IOPC-EDT IN IPT-EDT.
           MOVE IPT-IIC-IOPC-EDT IN IPT-EDT TO 
                IPT-IIC-IOPC-ALF IN IPT-FLD.
           IF IPT-NUM-ICAN-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-NUM-ICAN-LEN IN IPT-FLD
                GO TO FIN-EDT-IKY-IPT.
           MOVE IPT-NUM-ICAN IN IPT-FLD TO IPT-NUM-ICAN-EDT IN IPT-EDT.
           MOVE IPT-NUM-ICAN-EDT IN IPT-EDT TO 
                IPT-NUM-ICAN-ALF IN IPT-FLD.
           IF IPT-NUM-CPTO-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-NUM-CPTO-LEN IN IPT-FLD
                GO TO FIN-EDT-IKY-IPT.
           MOVE IPT-NUM-CPTO IN IPT-FLD TO IPT-NUM-CPTO-EDT IN IPT-EDT.
           MOVE IPT-NUM-CPTO-EDT IN IPT-EDT TO 
                IPT-NUM-CPTO-ALF IN IPT-FLD.
       FIN-EDT-IKY-IPT.
           EXIT.
       
       EDT-MKY-IPT SECTION.
       INI-EDT-MKY-IPT.
       FIN-EDT-MKY-IPT.
           EXIT.
       
       EDT-AKY-IPT SECTION.
       INI-EDT-AKY-IPT.
       FIN-EDT-AKY-IPT.
           EXIT.
       
       EDT-FLD-IPT SECTION.
       INI-EDT-FLD-IPT.
           IF IPT-IIC-IORI-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-IIC-IORI-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-IIC-IORI IN IPT-FLD TO IPT-IIC-IORI-EDT IN IPT-EDT.
           MOVE IPT-IIC-IORI-EDT IN IPT-EDT TO 
                IPT-IIC-IORI-ALF IN IPT-FLD.
           IF IPT-NUM-PTRM-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-NUM-PTRM-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-NUM-PTRM IN IPT-FLD TO IPT-NUM-PTRM-EDT IN IPT-EDT.
           MOVE IPT-NUM-PTRM-EDT IN IPT-EDT TO 
                IPT-NUM-PTRM-ALF IN IPT-FLD.
           IF IPT-VAL-CTRA-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-VAL-CTRA-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-VAL-CTRA IN IPT-FLD TO IPT-VAL-CTRA-EDT IN IPT-EDT.
           MOVE IPT-VAL-CTRA-EDT IN IPT-EDT TO 
                IPT-VAL-CTRA-ALF IN IPT-FLD.
           IF IPT-SGV-TUNI-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-TUNI-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-TUNI IN IPT-FLD TO IPT-SGV-TUNI-EDT IN IPT-EDT.
           MOVE IPT-SGV-TUNI-EDT IN IPT-EDT TO 
                IPT-SGV-TUNI-ALF IN IPT-FLD.
           IF IPT-SGV-TOPE-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-TOPE-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-TOPE IN IPT-FLD TO IPT-SGV-TOPE-EDT IN IPT-EDT.
           MOVE IPT-SGV-TOPE-EDT IN IPT-EDT TO 
                IPT-SGV-TOPE-ALF IN IPT-FLD.
           IF IPT-SGV-TINT-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-TINT-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-TINT IN IPT-FLD TO IPT-SGV-TINT-EDT IN IPT-EDT.
           MOVE IPT-SGV-TINT-EDT IN IPT-EDT TO 
                IPT-SGV-TINT-ALF IN IPT-FLD.
           IF IPT-SGV-TACU-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-TACU-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-TACU IN IPT-FLD TO IPT-SGV-TACU-EDT IN IPT-EDT.
           MOVE IPT-SGV-TACU-EDT IN IPT-EDT TO 
                IPT-SGV-TACU-ALF IN IPT-FLD.
           IF IPT-NUM-PDES-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-NUM-PDES-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-NUM-PDES IN IPT-FLD TO IPT-NUM-PDES-EDT IN IPT-EDT.
           MOVE IPT-NUM-PDES-EDT IN IPT-EDT TO 
                IPT-NUM-PDES-ALF IN IPT-FLD.
           IF IPT-SGV-MORI-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-MORI-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-MORI IN IPT-FLD TO IPT-SGV-MORI-EDT IN IPT-EDT.
           MOVE IPT-SGV-MORI-EDT IN IPT-EDT TO 
                IPT-SGV-MORI-ALF IN IPT-FLD.
           IF IPT-SGV-MNTO-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-MNTO-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-MNTO IN IPT-FLD TO IPT-SGV-MNTO-EDT IN IPT-EDT.
           MOVE IPT-SGV-MNTO-EDT IN IPT-EDT TO 
                IPT-SGV-MNTO-ALF IN IPT-FLD.
           IF IPT-SGV-CUOT-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-CUOT-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-CUOT IN IPT-FLD TO IPT-SGV-CUOT-EDT IN IPT-EDT.
           MOVE IPT-SGV-CUOT-EDT IN IPT-EDT TO 
                IPT-SGV-CUOT-ALF IN IPT-FLD.
           IF IPT-SGV-VDES-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-VDES-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-VDES IN IPT-FLD TO IPT-SGV-VDES-EDT IN IPT-EDT.
           MOVE IPT-SGV-VDES-EDT IN IPT-EDT TO 
                IPT-SGV-VDES-ALF IN IPT-FLD.
           IF IPT-SGV-VTOT-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-VTOT-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-VTOT IN IPT-FLD TO IPT-SGV-VTOT-EDT IN IPT-EDT.
           MOVE IPT-SGV-VTOT-EDT IN IPT-EDT TO 
                IPT-SGV-VTOT-ALF IN IPT-FLD.
           IF IPT-NUM-FOLI-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-NUM-FOLI-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-NUM-FOLI IN IPT-FLD TO IPT-NUM-FOLI-EDT IN IPT-EDT.
           MOVE IPT-NUM-FOLI-EDT IN IPT-EDT TO 
                IPT-NUM-FOLI-ALF IN IPT-FLD.
           IF IPT-SGV-MCAL-LEN IN IPT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO IPT-SGV-MCAL-LEN IN IPT-FLD
                GO TO FIN-EDT-FLD-IPT.
           MOVE IPT-SGV-MCAL IN IPT-FLD TO IPT-SGV-MCAL-EDT IN IPT-EDT.
           MOVE IPT-SGV-MCAL-EDT IN IPT-EDT TO 
                IPT-SGV-MCAL-ALF IN IPT-FLD.
       FIN-EDT-FLD-IPT.
           EXIT.
      *<<<< EOF_BU
       OBT-OPE-ANT SECTION.                                             
       INI-OBT-OPE-ANT.                                                 
      *    LIMPIA VARIABLES                                             
           MOVE SPACES TO WSS-CIC-ANTE IN BDO-VARI.                     
           MOVE SPACES TO WSS-CIC-PROR IN BDO-VARI.                     
                                                                        
      *    BUSCA OPC                                                    
           MOVE WSS-CIC-IOPC  IN WSS-VARI   TO OPC-CIC-IOPC IN OPC.     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-OBT-OPE-ANT.                                   
                                                                        
      *    OPC-IND-RENO = SPACES => OPC ANTE                            
           IF OPC-IND-RENO IN OPC NOT > SPACES                          
              MOVE WSS-CIC-IOPC IN WSS-VARI TO WSS-CIC-ANTE IN BDO-VARI 
              GO TO FIN-OBT-OPE-ANT.                                    
                                                                        
      *    OPC-IND-RENO = 'PRO' => PRORROGA                             
      *    WSS-CIC-ANTE = NW OPC ANTERIOR                               
      *    WSS-CIC-PROR = NW OPC INFORMACION ANTERIOR                   
           IF OPC-IND-RENO IN OPC = 'PRO' 
                MOVE WSS-CIC-IOPC IN WSS-VARI TO ROV-CIC-IOPC IN ROV
                MOVE FIO-GET-NLS         TO FIO-CMND                    
                PERFORM COL-FIO-ROV                                     
                IF (NOT FIO-STAT-OKS OR                                 
                    WSS-CIC-IOPC IN WSS-VARI NOT = ROV-CIC-IOPC IN ROV) 
                    GO TO FIN-OBT-OPE-ANT                               
                ELSE                                                    
                    MOVE ROV-CIC-IOPV IN ROV TO WSS-CIC-ANTE IN BDO-VARI
                    GO TO FIN-OBT-OPE-ANT.                              
                                                                        
      *    => RENOVACIONES                                              
                                                                        
           MOVE SPACES TO ROV.                                          
           MOVE SPACES TO BDO-1        IN BDO-VARI.                     
                                                                        
           MOVE WSS-CIC-IOPC IN WSS-VARI  TO ROV-CIC-IOPC IN ROV.       
           MOVE ROV-CIC-IOPC IN ROV       TO WSS-COD-OPCR IN BDO-VARI.  
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-ROV.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    WSS-COD-OPCR  = ROV-CIC-IOPC IN ROV )               
              GO TO FIN-OBT-OPE-ANT.                                    
                                                                        
           IF BDO-1 IN BDO-VARI = SPACES                                
              MOVE ROV-CIC-IOPV IN ROV TO  WSS-CIC-ANTE IN BDO-VARI     
              MOVE  'N'                TO  BDO-1 IN BDO-VARI.           
                                                                        
           MOVE ROV-CIC-IOPV IN ROV TO DLC-CIC-IOPC IN DLC.             
           MOVE ROV-CIC-IOPV IN ROV TO WSS-COD-OPCR IN BDO-VARI.        
           MOVE 001                 TO DLC-NUM-IDLC IN DLC.             
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM COL-FIO-DLC.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-OBT-OPE-ANT.                                    
                                                                        
           MOVE ROV-CIC-IOPV IN ROV TO  WSS-CIC-ANTE IN BDO-VARI.       
           IF ( DLC-IND-SCTB IN DLC = SPACES OR 'MUL' )                 
                 MOVE ROV-CIC-IOPV IN ROV TO  WSS-CIC-ANTE IN BDO-VARI  
                 GO TO FIN-OBT-OPE-ANT.                                 
                                                                        
       FIN-OBT-OPE-ANT.                                                 
           EXIT.                                                        
      *-------------------------------------------------------------    
      *BUSQUEDA DE TASA DE IMPUESTO                                     
       BUS-TAS-IMP SECTION.                                             
       INI-BUS-TAS-IMP.                                                 
                                                                        
      *    VALIDA DLC EXISTENTE                                         
           MOVE IPT-CAI-IOPC IN IPT-FLD    TO DLC-CAI-IOPC IN DLC.      
           MOVE IPT-IIC-IOPC IN IPT-FLD    TO DLC-IIC-IOPC IN DLC.      
           MOVE 1                          TO DLC-NUM-IDLC IN DLC.      
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM COL-FIO-DLC                                          
           IF NOT (FIO-STAT-OKS)                                        
              MOVE 'DLC    NEX' TO MSG-COD-MENS
              GO TO FIN-BUS-TAS-IMP.                                    
                                                                        
           MOVE ZEROES TO WSS-VAL-TOPE IN WSS-VARI.                     
           MOVE ZEROES TO WSS-NUM-PDES IN WSS-VARI.                     
           MOVE SPACES TO WSS-IND-ETIM IN WSS-VARI.                     
           MOVE SPACES TO WSS-GLS-PDES IN WSS-VARI.                     
           MOVE IPT-NUM-DORI IN IPT-FLD TO WSS-NUM-DCOL IN WSS-VARI.
           MOVE IPT-NUM-MORI IN IPT-FLD TO WSS-NUM-MCOL IN WSS-VARI.
           MOVE IPT-NUM-SORI IN IPT-FLD TO WSS-NUM-SCOL IN WSS-VARI.
           MOVE IPT-NUM-AORI IN IPT-FLD TO WSS-NUM-ACOL IN WSS-VARI.
      *    IF IPT-COD-EVEN IN IPT-FLD = 'HIS'
      *        MOVE IPT-NUM-DINI IN IPT-FLD TO WSS-NUM-DCOL IN WSS-VARI
      *        MOVE IPT-NUM-MINI IN IPT-FLD TO WSS-NUM-MCOL IN WSS-VARI
      *        MOVE IPT-NUM-SINI IN IPT-FLD TO WSS-NUM-SCOL IN WSS-VARI
      *        MOVE IPT-NUM-AINI IN IPT-FLD TO WSS-NUM-ACOL IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-GLOS IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-GLO2 IN WSS-VARI.
           MOVE WSS-FEC-FCOL IN WSS-VARI  TO WSS-FEC-CTAB IN WSS-VARI.  
           MOVE DLC-COD-TDOC IN DLC       TO WSS-GLS-DOCU IN WSS-VARI.  
           IF WSS-MSC-TIMP IN WSS-VARI = 'I'
               MOVE SPACES TO WSS-GLS-TIPO IN WSS-VARI
           ELSE
               MOVE DLC-MSC-TIMP IN DLC TO WSS-GLS-TIPO IN WSS-VARI.   

           MOVE 'COL'                    TO FIO-SIST.                   
           MOVE 'TIM'                    TO TAB-COD-TTAB IN TAB.        
           MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-BUS-TAS-IMP.                                                 
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-COD-TTAB IN TAB = 'TIM')        
                GO TO FIN-BUS-TAS-IMP.                                  
                                                                        
           IF NOT (TAB-IND-VIGE IN TAB = 'S')                           
                GO TO NXT-BUS-TAS-IMP.                                  
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTIM IN WSS-VARI.        
           IF WSS-GLS-DOCU IN WSS-VARI NOT = WSS-GLS-DTIM IN WSS-VARI   
                GO TO NXT-BUS-TAS-IMP.                                  
                                                                        
           IF WSS-GLS-TIPO IN WSS-VARI NOT = WSS-GLS-TTIM IN WSS-VARI   
                GO TO NXT-BUS-TAS-IMP.                                  
                                                                        
           IF WSS-IND-ETIM IN WSS-VARI NOT > SPACES                     
               MOVE WSS-FEC-CTIM        TO  WSS-FEC-FANT IN WSS-VARI.   
                                                                        
           MOVE WSS-FEC-CTIM IN WSS-VARI TO  WSS-FEC-FTIM IN WSS-VARI.  
                                                                        
           IF WSS-FEC-FCOL IN WSS-VARI < WSS-FEC-FTIM IN WSS-VARI       
               IF WSS-FEC-FCOL IN WSS-VARI > WSS-FEC-FANT IN WSS-VARI OR
                  WSS-FEC-FTIM IN WSS-VARI = WSS-FEC-FANT IN WSS-VARI   
                   MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-GLOS IN WSS-VARI 
                   MOVE TAB-GLS-DATA IN TAB(21:3) TO                    
                        WSS-GLS-PDES IN WSS-VARI                        
                   MOVE TAB-GLS-DATA IN TAB(11:10) TO                   
                        WSS-GLS-GLO2 IN WSS-VARI                        
                   MOVE TAB-GLS-DATA IN TAB(1:10) TO
                        WSS-GLS-GLO3 IN WSS-VARI
                   GO TO FIN-BUS-TAS-IMP                                
               ELSE

                   GO TO FIN-BUS-TAS-IMP.                               
                                                                        
           IF WSS-FEC-FCOL IN WSS-VARI NOT < WSS-FEC-FTIM IN WSS-VARI   
               MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-GLOS IN WSS-VARI     
               MOVE 'S'                 TO WSS-IND-ETIM IN WSS-VARI     
               MOVE TAB-GLS-DATA IN TAB(21:3) TO                        
                    WSS-GLS-PDES IN WSS-VARI                            
               MOVE TAB-GLS-DATA IN TAB(11:10) TO                       
                    WSS-GLS-GLO2 IN WSS-VARI                            
               MOVE TAB-GLS-DATA IN TAB(1:10) TO
                    WSS-GLS-GLO3 IN WSS-VARI
               GO TO NXT-BUS-TAS-IMP.                                 
                                                                        
       NXT-BUS-TAS-IMP.                                                 
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-BUS-TAS-IMP.                                       
                                                                        
       FIN-BUS-TAS-IMP.                                                 
           EXIT.                                                        
      *--------------------------------------------------------------   
        CAL-TOPE SECTION.                                               
        INI-CAL-TOPE.                                                   
                                                                        
           IF WSS-MSC-TIMP IN WSS-VARI = 'I'
               MOVE SPACES                   TO IMP-MSC-TIMP IN IMP
           ELSE
               MOVE WSS-MSC-TIMP IN WSS-VARI TO IMP-MSC-TIMP IN IMP.    

           IF WSS-GLS-GLO2 IN WSS-VARI NOT NUMERIC
      *         MOVE ZEROES TO WSS-VAL-TOPE IN WSS-VARI
                MOVE WSS-COD-TDOC IN WSS-VARI TO IMP-COD-TDOC IN IMP    
      *         MOVE WSS-MSC-TIMP IN WSS-VARI TO IMP-MSC-TIMP IN IMP    
                MOVE FIO-GET-KEY TO FIO-CMND                            
                PERFORM COL-FIO-IMP                                     
                IF NOT FIO-STAT-OKS                                     
                    MOVE 'COLIMPNEX' TO MSG-COD-MENS                    
                    GO TO FIN-CAL-TOPE
                ELSE
                   MOVE IMP-VAL-TOPE IN IMP  TO WSS-VAL-TOPE IN WSS-VARI
                   MOVE IMP-VAL-TIMP IN IMP  TO WSS-VAL-TUNI IN WSS-VARI
                   MOVE ZEROES               TO WSS-NUM-PDES IN WSS-VARI
                   GO TO FIN-CAL-TOPE.

            MOVE  WSS-GLS-GLO2 IN WSS-VARI TO WSS-NUM-DAT1 IN WSS-VARI.
            IF WSS-NUM-DAT1 IS NOT NUMERIC
                MOVE 'TOPEINVAL' TO MSG-COD-MENS                        
                GO TO FIN-CAL-TOPE.
            COMPUTE WSS-SGV-DAT1 IN WSS-VARI = WSS-NUM-DAT1 / 10000000.

            MOVE WSS-SGV-DAT1 IN WSS-VARI TO WSS-VAL-TOPE IN WSS-VARI.

            MOVE  WSS-GLS-GLO3 IN WSS-VARI TO WSS-NUM-DAT3 IN WSS-VARI.
            IF WSS-NUM-DAT3 IS NOT NUMERIC
                MOVE 'TUNIINVAL' TO MSG-COD-MENS                        
                GO TO FIN-CAL-TOPE.
            COMPUTE WSS-SGV-DAT3 IN WSS-VARI = WSS-NUM-DAT3 / 10000000.

            MOVE WSS-SGV-DAT3 IN WSS-VARI TO WSS-VAL-TUNI IN WSS-VARI.

            IF WSS-GLS-PDES IS NOT NUMERIC
                MOVE 'PORCJEINV' TO MSG-COD-MENS                        
                GO TO FIN-CAL-TOPE
            ELSE
                MOVE WSS-GLS-PDES IN WSS-VARI TO
                     WSS-NUM-PDES IN WSS-VARI.

           PERFORM GET-FHOY.                                            
           IF IPT-NUM-SCOL IN IPT-FLD  NOT = HOY-SHOY OR                
              IPT-NUM-ACOL IN IPT-FLD  NOT = HOY-AHOY OR                
              IPT-NUM-MCOL IN IPT-FLD  NOT = HOY-MHOY OR                
              IPT-NUM-DCOL IN IPT-FLD  NOT = HOY-DHOY                   
                GO TO FIN-CAL-TOPE.                                     
                                                                        
           MOVE WSS-COD-TDOC IN WSS-VARI TO IMP-COD-TDOC IN IMP.        
           MOVE WSS-MSC-TIMP IN WSS-VARI TO IMP-MSC-TIMP IN IMP.        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-IMP.                                         
           IF NOT FIO-STAT-OKS                                          
      *        MOVE 'COLIMPNEX' TO CPI-COD-MENS                         
                GO TO FIN-CAL-TOPE.                                     
                                                                        
           COMPUTE WSS-VAL-DIFE IN WSS-VARI ROUNDED =                   
                   WSS-VAL-TOPE IN WSS-VARI  *                          
                   ((100 - WSS-NUM-PDES IN WSS-VARI) / 100).            
                                                                        
           IF WSS-VAL-DIFE IN WSS-VARI NOT = IMP-VAL-TOPE IN IMP        
               MOVE IMP-VAL-TOPE IN IMP  TO WSS-VAL-TOPE IN WSS-VARI
               MOVE IMP-VAL-TIMP IN IMP  TO WSS-VAL-TUNI IN WSS-VARI
               MOVE ZEROES               TO WSS-NUM-PDES IN WSS-VARI.   
                                                                        
        FIN-CAL-TOPE.                                                   
            EXIT.                                                       
      *-------------------------------------------------------------    
       CAL-FTER SECTION.                                                
       INI-CAL-FTER.                                                    
                                                                        
      *    MOVE IPT-NUM-DCOL IN IPT-FLD TO FEC-TRN1.                    
      *    MOVE IPT-NUM-MCOL IN IPT-FLD TO FEC-TRN2.                    
      *    MOVE IPT-NUM-SCOL IN IPT-FLD TO FEC-TRN3.                    
      *    MOVE IPT-NUM-ACOL IN IPT-FLD TO FEC-TRN4.                    
           MOVE ZEROES                  TO IPT-FEC-FTER IN IPT-FLD.     
                                                                        
      *    SUMA MESES DE TRAMO A FECHA DE INICIO                        
           MOVE IPT-FEC-FCOL IN IPT-FLD TO FEC-FECH.                    
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-N   TO FEC-FBLK.                               
           MOVE FEC-CHOY-N   TO FEC-CHOY.                               
           MOVE FEC-VHBL-N   TO FEC-VHBL.                               
           MOVE IPT-NUM-PTRM IN IPT-FLD  TO FEC-NMES.                   
           MOVE FEC-SUM-MES  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           IF NOT FEC-STAT-OKS                                          
      *        MOVE 'S'               TO WSS-IND-ERRO                   
      *        MOVE 'CAL-FEC NOOK'    TO WSS-COD-MENS                   
               GO TO FIN-CAL-FTER.                                      
                                                                        
           MOVE FEC-FECH TO WSS-FEC-FCAL IN WSS-VARI.                   
                                                                        
           MOVE WSS-FEC-FCAL IN WSS-VARI TO FEC-FECH.                   
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-S   TO FEC-FBLK.                               
           MOVE FEC-CHOY-N   TO FEC-CHOY.                               
           MOVE FEC-VHBL-N   TO FEC-VHBL.                               
           MOVE FEC-VAL-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-OKS                                          
               GO TO FIN-CAL-FTER.                                  
    
           MOVE WSS-NUM-DCAL IN WSS-VARI TO IPT-NUM-DTER IN IPT-FLD.

           MOVE WSS-NUM-MCAL IN WSS-VARI TO IPT-NUM-MTER IN IPT-FLD.    
           MOVE WSS-NUM-SCAL IN WSS-VARI TO IPT-NUM-STER IN IPT-FLD.    
           MOVE WSS-NUM-ACAL IN WSS-VARI TO IPT-NUM-ATER IN IPT-FLD.    
                                                                        
           MOVE WSS-NUM-DCAL IN WSS-VARI TO WSS-NUM-D001 IN WSS-VARI.   
           MOVE WSS-NUM-MCAL IN WSS-VARI TO WSS-NUM-M001 IN WSS-VARI.   
           MOVE WSS-NUM-SCAL IN WSS-VARI TO WSS-NUM-S001 IN WSS-VARI.   
           MOVE WSS-NUM-ACAL IN WSS-VARI TO WSS-NUM-A001 IN WSS-VARI.   
                                                                        
           MOVE IPT-NUM-DMAV IN IPT-FLD  TO WSS-NUM-D002 IN WSS-VARI.   
           MOVE IPT-NUM-MMAV IN IPT-FLD  TO WSS-NUM-M002 IN WSS-VARI.   
           MOVE IPT-NUM-SMAV IN IPT-FLD  TO WSS-NUM-S002 IN WSS-VARI.   
           MOVE IPT-NUM-AMAV IN IPT-FLD  TO WSS-NUM-A002 IN WSS-VARI.   
                                                                        
      *    COMPARA FECHAS EN FORMATO SSAAMMDD                           
           IF WSS-FEC-F001 IN WSS-VARI >  WSS-FEC-F002 IN WSS-VARI      
               MOVE IPT-FEC-FMAV IN IPT-FLD  TO IPT-FEC-FTER IN IPT-FLD.
                                                                        
                                                                        
       FIN-CAL-FTER.                                                    
           EXIT.                                                        

       OBT-DAT-ITIM SECTION.                                            
       INI-OBT-DAT-ITIM.                                                
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM BUS-TAS-IMP.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-OBT-DAT-ITIM.
           PERFORM CAL-TOPE.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-OBT-DAT-ITIM.
           MOVE WSS-VAL-TOPE IN WSS-VARI TO IPT-SGV-TOPE IN IPT-FLD.
           IF WSS-IBLK-TUNI = 'S'
           MOVE WSS-VAL-TUNI IN WSS-VARI TO IPT-SGV-TUNI IN IPT-FLD.
           IF WSS-IBLK-PDES = 'S'
           MOVE WSS-NUM-PDES IN WSS-VARI TO IPT-NUM-PDES IN IPT-FLD.
           COMPUTE WSS-SGV-TINT IN WSS-VARI ROUNDED =
               IPT-NUM-PTRM IN IPT-FLD * IPT-SGV-TUNI IN IPT-FLD.
           MOVE WSS-SGV-TINT IN WSS-VARI TO IPT-SGV-TINT IN IPT-FLD.
       FIN-OBT-DAT-ITIM.                                                
           EXIT.
       BUS-PESO SECTION.                                                
       INI-BUS-PESO.                                                    
           MOVE SPACES         TO WSS-COD-PESO IN WSS-VARI.             
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.        
       FIN-BUS-PESO.                                                    
           EXIT.                                                        
       VAL-CAM-OPC SECTION.                                             
       INI-VAL-CAM-OPC.                                                 
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           PERFORM BUS-PESO.
           IF (OPC-COD-VCOC = WSS-COD-PESO IN WSS-VARI)                 
                GO TO FIN-VAL-CAM-OPC.                                  
                                                                        
           MOVE OPC-COD-VCOC IN OPC       TO CAM-COD-VCAM IN CAM(1).    
           MOVE WSS-COD-PESO IN WSS-VARI  TO CAM-COD-VCAM IN CAM(2).    
           MOVE IPT-NUM-DCOL IN IPT-FLD   TO CAM-NUM-DCAM IN CAM(1).    
           MOVE IPT-NUM-MCOL IN IPT-FLD   TO CAM-NUM-MCAM IN CAM(1).    
           MOVE IPT-NUM-SCOL IN IPT-FLD   TO CAM-NUM-SCAM IN CAM(1).    
           MOVE IPT-NUM-ACOL IN IPT-FLD   TO CAM-NUM-ACAM IN CAM(1).    
           MOVE CAM-FEC-FCAM IN CAM(1)    TO CAM-FEC-FCAM IN CAM(2).    
                                                                        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S' )      
                MOVE 'VCAM OPC NEX' TO MSG-COD-MENS IN MSG
                GO TO FIN-VAL-CAM-OPC.                                  

           COMPUTE IPT-SGV-MNTO IN IPT-FLD = OPC-VAL-CRED IN OPC *
                                             CAM-SGV-VCAM IN CAM.
           MOVE IPT-SGV-MNTO IN IPT-FLD TO PES-SGV-DECI IN PES-VARI.    
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE IN PES-VARI TO IPT-SGV-MNTO IN IPT-FLD.    
                                                                        
                                                                        
       FIN-VAL-CAM-OPC.                                                 
           EXIT.                                                        
       CAL-PER SECTION.                                                 
       INI-CAL-PER.                                                     
           MOVE IPT-NUM-DINI IN IPT-FLD TO FEC-DEC1.                    
           MOVE IPT-NUM-MINI IN IPT-FLD TO FEC-MEC1.                    
           MOVE IPT-NUM-SINI IN IPT-FLD TO FEC-SEC1.                    
           MOVE IPT-NUM-AINI IN IPT-FLD TO FEC-AEC1.                    
                                                                        
       CAL-PER-RTE.
                                                                        
           MOVE IPT-NUM-DTER IN IPT-FLD TO FEC-DEC2.                    
           MOVE IPT-NUM-MTER IN IPT-FLD TO FEC-MEC2.                    
           MOVE IPT-NUM-STER IN IPT-FLD TO FEC-SEC2.                    
           MOVE IPT-NUM-ATER IN IPT-FLD TO FEC-AEC2.                    
                                                                        
           MOVE FEC-FORM-FEC   TO FEC-FORM.                             
           MOVE FEC-DIF-MES    TO FEC-CMND.                             
           PERFORM CAL-FEC.                                             
           IF NOT FEC-STAT-OKS                                          
               GO TO FIN-CAL-PER.                                       

           IF FEC-NDIA = ZEROES AND                                     
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND           
              FEC-SIND < FEC-REST                                       
               COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.                  
           IF FEC-NDIA > 0                                              
               ADD 1 TO FEC-NMES.                                       
                                                                        
      *NUM-TRMO CANT ANTERIOR TRAMOS
      *    IF FEC-NMES > WSS-NUM-PEXC                                   
      *        MOVE WSS-NUM-PEXC TO WSS-NUM-NPER IN IPT-VARI            
      *        GO TO FIN-CAL-PER                                        
      *    ELSE                                                         
      *        MOVE FEC-NMES TO WSS-NUM-NPER IN IPT-VARI.               
      *                                                                 
       FIN-CAL-PER.                                                     
      *    MOVE WSS-NUM-NPER IN IPT-VARI TO CPI-NUM-TRMO.
           EXIT.                                                        

       VAL-TAS-INGRE SECTION.
       INI-VAL-TAS-INGRE.
      *    VALIDA DLC EXISTENTE
           MOVE IPT-CAI-IOPC IN IPT-FLD    TO DLC-CAI-IOPC IN DLC.
           MOVE IPT-IIC-IOPC IN IPT-FLD    TO DLC-IIC-IOPC IN DLC.
           MOVE 1                          TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM COL-FIO-DLC                                          
           PERFORM CRG-VEC-TIMP.
           MOVE 1 TO WSS-NUM-ITIM IN WSS-VARI.
       LUP-VAL-TAS-INGRE.
           IF WSS-COD-ITIM(WSS-NUM-ITIM) NOT > SPACES AND
              WSS-NUM-ITIM > 1
               MOVE 'TASUNINVAL' TO MSG-COD-MENS
               GO TO FIN-VAL-TAS-INGRE.
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM VAL-TAS-IMP.
           PERFORM BUS-TOPE.
           IF WSS-MSC-TIMP IN WSS-VARI NOT = 'I'
              IF WSS-NUM-PDES NOT = IPT-NUM-PDES IN IPT-FLD
                  MOVE 'PCJEDESINVAL' TO MSG-COD-MENS
                  GO TO FIN-VAL-TAS-INGRE.
           IF WSS-VAL-TUNI IN WSS-VARI = IPT-SGV-TUNI IN IPT-FLD
               GO TO FIN-VAL-TAS-INGRE.
           ADD 1 TO WSS-NUM-ITIM.
           IF WSS-NUM-ITIM NOT > 200
               GO TO LUP-VAL-TAS-INGRE.
       FIN-VAL-TAS-INGRE.
           EXIT.
       CRG-VEC-TIMP SECTION.
       INI-CRG-VEC-TIMP.
           MOVE SPACES TO WSS-COD-TIMP.
           MOVE 1 TO WSS-NUM-ITIM.
           IF WSS-MSC-TIMP IN WSS-VARI NOT = 'I'
               MOVE DLC-MSC-TIMP IN DLC TO WSS-COD-ITIM(WSS-NUM-ITIM)
               GO TO FIN-CRG-VEC-TIMP.
           MOVE 'COL'                    TO FIO-SIST.
           MOVE 'TIMP'                   TO MSC-COD-TMSC IN MSC.
           MOVE SPACES                   TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CRG-VEC-TIMP.
           PERFORM GNS-FIO-MSC.
           IF NOT (FIO-STAT-OKS AND MSC-COD-TMSC IN MSC = 'TIMP')
                GO TO FIN-CRG-VEC-TIMP.

           IF NOT (MSC-IND-VIGE IN MSC = 'S')
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-CRG-VEC-TIMP.
           MOVE MSC-COD-CMSC IN MSC TO WSS-COD-ITIM(WSS-NUM-ITIM).
           ADD 1 TO WSS-NUM-ITIM.
           IF WSS-NUM-ITIM NOT > 200
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-CRG-VEC-TIMP.
       FIN-CRG-VEC-TIMP.
           EXIT.
       VAL-TAS-IMP SECTION.
       INI-VAL-TAS-IMP.
      *    VALIDA DLC EXISTENTE
           MOVE IPT-CAI-IOPC IN IPT-FLD    TO DLC-CAI-IOPC IN DLC.
           MOVE IPT-IIC-IOPC IN IPT-FLD    TO DLC-IIC-IOPC IN DLC.
           MOVE 1                          TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM COL-FIO-DLC                                          
           IF NOT (FIO-STAT-OKS)                                        
              MOVE 'DLC    NEX' TO MSG-COD-MENS                         
              GO TO FIN-VAL-TAS-IMP.                                    

           MOVE ZEROES TO WSS-VAL-TOPE IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-PDES IN WSS-VARI.
           MOVE SPACES TO WSS-IND-ETIM IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-PDES IN WSS-VARI.
           MOVE IPT-NUM-DORI IN IPT-FLD TO WSS-NUM-DCOL IN WSS-VARI.
           MOVE IPT-NUM-MORI IN IPT-FLD TO WSS-NUM-MCOL IN WSS-VARI.
           MOVE IPT-NUM-SORI IN IPT-FLD TO WSS-NUM-SCOL IN WSS-VARI.
           MOVE IPT-NUM-AORI IN IPT-FLD TO WSS-NUM-ACOL IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-GLOS IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-GLO2 IN WSS-VARI.
           MOVE WSS-FEC-FCOL IN WSS-VARI  TO WSS-FEC-CTAB IN WSS-VARI.  
           MOVE DLC-COD-TDOC IN DLC       TO WSS-GLS-DOCU IN WSS-VARI.  
           MOVE WSS-COD-ITIM(WSS-NUM-ITIM) TO WSS-GLS-TIPO.
           MOVE 'COL'                    TO FIO-SIST.
           MOVE 'TIM'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-VAL-TAS-IMP.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-COD-TTAB IN TAB = 'TIM')
                GO TO FIN-VAL-TAS-IMP.

           IF NOT (TAB-IND-VIGE IN TAB = 'S')
                GO TO NXT-VAL-TAS-IMP.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTIM IN WSS-VARI.
           IF WSS-GLS-DOCU IN WSS-VARI NOT = WSS-GLS-DTIM IN WSS-VARI
                GO TO NXT-VAL-TAS-IMP.                                  

           IF WSS-GLS-TIPO IN WSS-VARI NOT = WSS-GLS-TTIM IN WSS-VARI
                GO TO NXT-VAL-TAS-IMP.                                  

           IF WSS-IND-ETIM IN WSS-VARI NOT > SPACES
               MOVE WSS-FEC-CTIM        TO  WSS-FEC-FANT IN WSS-VARI.

           MOVE WSS-FEC-CTIM IN WSS-VARI TO  WSS-FEC-FTIM IN WSS-VARI.

           IF WSS-FEC-FCOL IN WSS-VARI < WSS-FEC-FTIM IN WSS-VARI
               IF WSS-FEC-FCOL IN WSS-VARI > WSS-FEC-FANT IN WSS-VARI OR
                  WSS-FEC-FTIM IN WSS-VARI = WSS-FEC-FANT IN WSS-VARI
                   MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-GLOS IN WSS-VARI
                   MOVE TAB-GLS-DATA IN TAB(21:3) TO
                        WSS-GLS-PDES IN WSS-VARI
                   MOVE TAB-GLS-DATA IN TAB(11:10) TO
                        WSS-GLS-GLO2 IN WSS-VARI
                   MOVE TAB-GLS-DATA IN TAB(1:10) TO
                        WSS-GLS-GLO3 IN WSS-VARI
                   GO TO FIN-VAL-TAS-IMP
               ELSE
                   GO TO FIN-VAL-TAS-IMP.

           IF WSS-FEC-FCOL IN WSS-VARI NOT < WSS-FEC-FTIM IN WSS-VARI
               MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-GLOS IN WSS-VARI
               MOVE 'S'                 TO WSS-IND-ETIM IN WSS-VARI
               MOVE TAB-GLS-DATA IN TAB(21:3) TO
                    WSS-GLS-PDES IN WSS-VARI
               MOVE TAB-GLS-DATA IN TAB(11:10) TO
                    WSS-GLS-GLO2 IN WSS-VARI
               MOVE TAB-GLS-DATA IN TAB(1:10) TO
                    WSS-GLS-GLO3 IN WSS-VARI
               GO TO NXT-VAL-TAS-IMP.


       NXT-VAL-TAS-IMP.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-VAL-TAS-IMP.

       FIN-VAL-TAS-IMP.
           EXIT.
      *--------------------------------------------------------------
        BUS-TOPE SECTION.
        INI-CAL-TOPE.
           MOVE WSS-COD-ITIM(WSS-NUM-ITIM) TO IMP-MSC-TIMP IN IMP.

            IF WSS-GLS-GLO2 IN WSS-VARI NOT NUMERIC
      *         MOVE ZEROES TO WSS-VAL-TOPE IN WSS-VARI
                MOVE WSS-COD-TDOC IN WSS-VARI TO IMP-COD-TDOC IN IMP    
      *         MOVE WSS-MSC-TIMP IN WSS-VARI TO IMP-MSC-TIMP IN IMP    
                MOVE FIO-GET-KEY TO FIO-CMND                            
                PERFORM COL-FIO-IMP                                     
                IF NOT FIO-STAT-OKS                                     
                    MOVE 'COLIMPNEX' TO MSG-COD-MENS                    
                    GO TO FIN-BUS-TOPE
                ELSE
                   MOVE IMP-VAL-TOPE IN IMP  TO WSS-VAL-TOPE IN WSS-VARI
                   MOVE IMP-VAL-TIMP IN IMP  TO WSS-VAL-TUNI IN WSS-VARI
                   MOVE ZEROES               TO WSS-NUM-PDES IN WSS-VARI
                   GO TO FIN-BUS-TOPE.

            MOVE  WSS-GLS-GLO2 IN WSS-VARI TO WSS-NUM-DAT1 IN WSS-VARI.
            IF WSS-NUM-DAT1 IS NOT NUMERIC
                MOVE 'TOPEINVAL' TO MSG-COD-MENS                        
                GO TO FIN-BUS-TOPE.
            COMPUTE WSS-SGV-DAT1 IN WSS-VARI = WSS-NUM-DAT1 / 10000000.

            MOVE WSS-SGV-DAT1 IN WSS-VARI TO WSS-VAL-TOPE IN WSS-VARI.

            MOVE  WSS-GLS-GLO3 IN WSS-VARI TO WSS-NUM-DAT3 IN WSS-VARI.
            IF WSS-NUM-DAT3 IS NOT NUMERIC
                MOVE 'TUNIINVAL' TO MSG-COD-MENS                        
                GO TO FIN-BUS-TOPE.
            COMPUTE WSS-SGV-DAT3 IN WSS-VARI = WSS-NUM-DAT3 / 10000000.

            MOVE WSS-SGV-DAT3 IN WSS-VARI TO WSS-VAL-TUNI IN WSS-VARI.

            IF WSS-GLS-PDES IS NOT NUMERIC
                MOVE 'PORCJEINV' TO MSG-COD-MENS                        
                GO TO FIN-BUS-TOPE
            ELSE
                MOVE WSS-GLS-PDES IN WSS-VARI TO
                     WSS-NUM-PDES IN WSS-VARI.

           PERFORM GET-FHOY.
           IF IPT-NUM-SCOL IN IPT-FLD  NOT = HOY-SHOY OR
              IPT-NUM-ACOL IN IPT-FLD  NOT = HOY-AHOY OR
              IPT-NUM-MCOL IN IPT-FLD  NOT = HOY-MHOY OR
              IPT-NUM-DCOL IN IPT-FLD  NOT = HOY-DHOY
                GO TO FIN-BUS-TOPE.

           MOVE WSS-COD-TDOC IN WSS-VARI TO IMP-COD-TDOC IN IMP.        
           MOVE WSS-MSC-TIMP IN WSS-VARI TO IMP-MSC-TIMP IN IMP.        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-IMP.                                         
           IF NOT FIO-STAT-OKS                                          
      *        MOVE 'COLIMPNEX' TO CPI-COD-MENS                         
                GO TO FIN-BUS-TOPE.

           COMPUTE WSS-VAL-DIFE IN WSS-VARI ROUNDED =
                   WSS-VAL-TOPE IN WSS-VARI  *
                   ((100 - WSS-NUM-PDES IN WSS-VARI) / 100).

           IF WSS-VAL-DIFE IN WSS-VARI NOT = IMP-VAL-TOPE IN IMP
               MOVE IMP-VAL-TOPE IN IMP  TO WSS-VAL-TOPE IN WSS-VARI
               MOVE IMP-VAL-TIMP IN IMP  TO WSS-VAL-TUNI IN WSS-VARI
               MOVE ZEROES               TO WSS-NUM-PDES IN WSS-VARI.

        FIN-BUS-TOPE.
            EXIT.
        MCA-TAS-ACUM SECTION.
        INI-MCA-TAS-ACUM.
           IF SCR-CMND NOT = 'MCA'
               GO TO FIN-MCA-TAS-ACUM.
           MOVE IPT-CAI-IOPC IN IPT-FLD TO IPT-CAI-IOPC IN IPT
           MOVE IPT-IIC-IOPC IN IPT-FLD TO IPT-IIC-IOPC IN IPT
           MOVE IPT-COD-EVEN IN IPT-FLD TO IPT-COD-EVEN IN IPT
           MOVE IPT-NUM-ICAN IN IPT-FLD TO IPT-NUM-ICAN IN IPT
           MOVE IPT-COD-CPTO IN IPT-FLD TO IPT-COD-CPTO IN IPT
           MOVE IPT-NUM-CPTO IN IPT-FLD TO IPT-NUM-CPTO IN IPT
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM COL-FIO-IPT
           IF NOT FIO-STAT-OKS
               GO TO FIN-MCA-TAS-ACUM.
           COMPUTE WSS-DIF-TINT IN WSS-VARI ROUNDED =
                   IPT-VAL-CTRA IN IPT-FLD -
                   IPT-NUM-PTRM IN IPT.
           COMPUTE IPT-SGV-TACU IN IPT-FLD =
                   IPT-SGV-TACU IN IPT +
                   ( WSS-DIF-TINT IN WSS-VARI *
                     IPT-SGV-TUNI IN IPT ).
           COMPUTE IPT-SGV-TINT IN IPT-FLD =
                   IPT-SGV-TINT IN IPT +
                   ( IPT-SGV-TUNI IN IPT * WSS-DIF-TINT ).
        FIN-MCA-TAS-ACUM.
            EXIT.

      *>>>>
