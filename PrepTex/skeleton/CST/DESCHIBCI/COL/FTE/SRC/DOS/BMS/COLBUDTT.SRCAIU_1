      *
      * COLBUDTT
      * Version 3.0.1 Nov-2005
      * 20-Aug-19 10:35 AM
      *
       SET-TAG-COLBUDTT SECTION.
       INI-SET-TAG-COLBUDTT.
           MOVE
           '<IDNMOD NOM=$COLBUDTT$ VSN=$06.07.25.1$ VGM=$3.0.1$
      -    'GEN=$20-Aug-19 10:35 AM$ FNC=$CNCMSV$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBUDTT.
           EXIT.
           
       RET-ALL-DTT SECTION.
       INI-RET-ALL-DTT.
           PERFORM KEY-ALL-DTT.
           PERFORM RET-DTT-DTT.
           PERFORM RET-PTT-DTT.
       FIN-RET-ALL-DTT.
           EXIT.
       
       RET-DTT-DTT SECTION.
       INI-RET-DTT-DTT.
           MOVE DTT-NUM-CODI IN DTT-FLD TO DTT-NUM-CODI IN DTT.
           MOVE DTT-NUM-LARG IN DTT-FLD TO DTT-NUM-LARG IN DTT.
       FIN-RET-DTT-DTT.
           EXIT.
       
       RET-PTT-DTT SECTION.
       INI-RET-PTT-DTT.
           MOVE PTT-CAI-ICVN IN DTT-FLD TO PTT-CAI-ICVN IN PTT.
           MOVE PTT-IIC-ICVN IN DTT-FLD TO PTT-IIC-ICVN IN PTT.
           MOVE PTT-COD-TIPO IN DTT-FLD TO PTT-COD-TIPO IN PTT.
           MOVE PTT-IND-SEPA IN DTT-FLD TO PTT-IND-SEPA IN PTT.
           MOVE PTT-GLS-NOMP IN DTT-FLD TO PTT-GLS-NOMP IN PTT.
       FIN-RET-PTT-DTT.
           EXIT.
       
       KEY-ALL-DTT SECTION.
       INI-KEY-ALL-DTT.
           PERFORM KEY-DTT-DTT.
           PERFORM KEY-PTT-DTT.
       FIN-KEY-ALL-DTT.
           EXIT.
       
       KEY-DTT-DTT SECTION.
       INI-KEY-DTT-DTT.
           MOVE DTT-CAI-IDTT IN DTT-FLD TO DTT-CAI-IDTT IN DTT.
           MOVE DTT-IIC-IDTT IN DTT-FLD TO DTT-IIC-IDTT IN DTT.
           MOVE DTT-NUM-IDTT IN DTT-FLD TO DTT-NUM-IDTT IN DTT.
       FIN-KEY-DTT-DTT.
           EXIT.
       
       KEY-PTT-DTT SECTION.
       INI-KEY-PTT-DTT.
       FIN-KEY-PTT-DTT.
           EXIT.
       
       SCR-CLRA-DTT SECTION.
       INI-SCR-CLRA-DTT.
           PERFORM CLR-KEY-DTT.
           PERFORM CLR-FLD-DTT.
       FIN-SCR-CLRA-DTT.
           EXIT.
       
       CLR-KEY-DTT SECTION.
       INI-CLR-KEY-DTT.
           MOVE SPACES TO DTT-CAI-IDTT IN DTT-FLD.
           MOVE ZEROES TO DTT-IIC-IDTT IN DTT-FLD.
           MOVE ZEROES TO DTT-NUM-IDTT IN DTT-FLD.
       FIN-CLR-KEY-DTT.
           EXIT.
       
       CLR-FLD-DTT SECTION.
       INI-CLR-FLD-DTT.
           MOVE SPACES TO FRM-GLS-TIPO IN DTT-FLD.
           MOVE SPACES TO FRM-GLS-CODI IN DTT-FLD.
           PERFORM CLR-DTT-DTT.
           PERFORM CLR-PTT-DTT.
       FIN-CLR-FLD-DTT.
           EXIT.
       
       CLR-DTT-DTT SECTION.
       INI-CLR-DTT-DTT.
           MOVE ZEROES TO DTT-NUM-CODI IN DTT-FLD.
           MOVE ZEROES TO DTT-NUM-LARG IN DTT-FLD.
       FIN-CLR-DTT-DTT.
           EXIT.
       
       CLR-PTT-DTT SECTION.
       INI-CLR-PTT-DTT.
           MOVE SPACES TO PTT-CAI-ICVN IN DTT-FLD.
           MOVE ZEROES TO PTT-IIC-ICVN IN DTT-FLD.
           MOVE SPACES TO PTT-COD-TIPO IN DTT-FLD.
           MOVE SPACES TO PTT-IND-SEPA IN DTT-FLD.
           MOVE SPACES TO PTT-GLS-NOMP IN DTT-FLD.
       FIN-CLR-PTT-DTT.
           EXIT.
       
       FST-KEY-DTT SECTION.
       INI-FST-KEY-DTT.
           MOVE -1 TO DTT-CAI-IDTT-LEN IN DTT-FLD.
       FIN-FST-KEY-DTT.
           EXIT.
       
       FST-FLD-DTT SECTION.
       INI-FST-FLD-DTT.
           MOVE -1 TO DTT-NUM-CODI-LEN IN DTT-FLD.
       FIN-FST-FLD-DTT.
           EXIT.
       
       PRO-KEY-DTT SECTION.
       INI-PRO-KEY-DTT.
           PERFORM PRO-MKY-DTT.
       FIN-PRO-KEY-DTT.
           EXIT.
       
       PRO-MKY-DTT SECTION.
       INI-PRO-MKY-DTT.
       FIN-PRO-MKY-DTT.
           EXIT.
       
       PRO-FLD-DTT SECTION.
       INI-PRO-FLD-DTT.
           PERFORM PRO-DTT-DTT.
           PERFORM PRO-PTT-DTT.
       FIN-PRO-FLD-DTT.
           EXIT.
       
       PRO-DTT-DTT SECTION.
       INI-PRO-DTT-DTT.
           MOVE FRM-CPIM-AEY TO DTT-NUM-CODI-ATR IN DTT-FLD.
           MOVE FRM-CPIM-AEY TO DTT-NUM-LARG-ATR IN DTT-FLD.
       FIN-PRO-DTT-DTT.
           EXIT.
       
       PRO-PTT-DTT SECTION.
       INI-PRO-PTT-DTT.
       FIN-PRO-PTT-DTT.
           EXIT.
       
       UNP-KEY-DTT SECTION.
       INI-UNP-KEY-DTT.
           PERFORM UNP-IKY-DTT.
           PERFORM UNP-AKY-DTT.
           PERFORM UNP-MKY-DTT.
       FIN-UNP-KEY-DTT.
           EXIT.
       
       UNP-IKY-DTT SECTION.
       INI-UNP-IKY-DTT.
           MOVE FRM-CPIM-UBY TO DTT-CAI-IDTT-ATR.
           MOVE FRM-CPIM-UBY TO DTT-IIC-IDTT-ATR.
           MOVE FRM-CPIM-UBY TO DTT-NUM-IDTT-ATR.
       FIN-UNP-IKY-DTT.
           EXIT.
       
       UNP-MKY-DTT SECTION.
       INI-UNP-MKY-DTT.
       FIN-UNP-MKY-DTT.
           EXIT.
       
       UNP-AKY-DTT SECTION.
       INI-UNP-AKY-DTT.
       FIN-UNP-AKY-DTT.
           EXIT.
       
       UNP-FLD-DTT SECTION.
       INI-UNP-FLD-DTT.
           PERFORM UNP-DTT-DTT.
           PERFORM UNP-PTT-DTT.
       FIN-UNP-FLD-DTT.
           EXIT.
       
       UNP-DTT-DTT SECTION.
       INI-UNP-DTT-DTT.
           MOVE FRM-CPIM-UBY TO DTT-NUM-CODI-ATR IN DTT-FLD.
           MOVE FRM-CPIM-UBY TO DTT-NUM-LARG-ATR IN DTT-FLD.
      *<<<< FIN_UNP_DTT_DTT
           IF PTT-COD-TIPO IN DTT-FLD = 'S'                             
               MOVE FRM-CPIM-AEY TO DTT-NUM-LARG-ATR IN DTT-FLD.        
      *>>>>
       FIN-UNP-DTT-DTT.
           EXIT.
       
       UNP-PTT-DTT SECTION.
       INI-UNP-PTT-DTT.
       FIN-UNP-PTT-DTT.
           EXIT.
       
       VAL-MKY-DTT SECTION.
       INI-VAL-MKY-DTT.
       FIN-VAL-MKY-DTT.
           EXIT.
       
       VAL-FLD-DTT SECTION.
       INI-VAL-FLD-DTT.
           PERFORM VAL-PTT-CAI-ICVN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PTT-CAI-ICVN-LEN IN DTT-FLD
                GO TO FIN-VAL-FLD-DTT.
           PERFORM VAL-PTT-IIC-ICVN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PTT-IIC-ICVN-LEN IN DTT-FLD
                GO TO FIN-VAL-FLD-DTT.
           PERFORM VAL-PTT-COD-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PTT-COD-TIPO-LEN IN DTT-FLD
                GO TO FIN-VAL-FLD-DTT.
           PERFORM VAL-FRM-GLS-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TIPO-LEN IN DTT-FLD
                GO TO FIN-VAL-FLD-DTT.
           PERFORM VAL-PTT-IND-SEPA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PTT-IND-SEPA-LEN IN DTT-FLD
                GO TO FIN-VAL-FLD-DTT.
           PERFORM VAL-PTT-GLS-NOMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PTT-GLS-NOMP-LEN IN DTT-FLD
                GO TO FIN-VAL-FLD-DTT.
           PERFORM VAL-DTT-NUM-CODI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DTT-NUM-CODI-LEN IN DTT-FLD
                GO TO FIN-VAL-FLD-DTT.
           PERFORM VAL-FRM-GLS-CODI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CODI-LEN IN DTT-FLD
                GO TO FIN-VAL-FLD-DTT.
           PERFORM VAL-DTT-NUM-LARG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DTT-NUM-LARG-LEN IN DTT-FLD
                GO TO FIN-VAL-FLD-DTT.
       FIN-VAL-FLD-DTT.
           EXIT.
       
       VAL-PTT-CAI-ICVN SECTION.
       INI-VAL-PTT-CAI-ICVN.
       FIN-VAL-PTT-CAI-ICVN.
           EXIT.
       
       VAL-PTT-IIC-ICVN SECTION.
       INI-VAL-PTT-IIC-ICVN.
       FIN-VAL-PTT-IIC-ICVN.
           EXIT.
       
       VAL-PTT-COD-TIPO SECTION.
       INI-VAL-PTT-COD-TIPO.
       FIN-VAL-PTT-COD-TIPO.
           EXIT.
       
       VAL-FRM-GLS-TIPO SECTION.
       INI-VAL-FRM-GLS-TIPO.
       FIN-VAL-FRM-GLS-TIPO.
           EXIT.
       
       VAL-PTT-IND-SEPA SECTION.
       INI-VAL-PTT-IND-SEPA.
       FIN-VAL-PTT-IND-SEPA.
           EXIT.
       
       VAL-PTT-GLS-NOMP SECTION.
       INI-VAL-PTT-GLS-NOMP.
       FIN-VAL-PTT-GLS-NOMP.
           EXIT.
       
       VAL-DTT-NUM-CODI SECTION.
       INI-VAL-DTT-NUM-CODI.
      *<<<< FIN_VAL_DTT_NUM_CODI
           IF DTT-NUM-CODI IN DTT-FLD NOT > ZEROES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-DTT-NUM-CODI.  
      *                                                                
      *MHM-INI 21-DIC-2006                                              
           IF NOT (SCR-CMND = 'ING' OR SCR-CMND = 'MOD')                
               GO TO CNT-VAL-DTT-NUM-CODI.                              
                                                                        
      *MHM-FIN 21-DIC-2006    
           MOVE DTT-CAI-IDTT IN DTT-FLD TO DTT-CAI-IDTT IN DTT.        
           MOVE DTT-IIC-IDTT IN DTT-FLD TO DTT-IIC-IDTT IN DTT.        
           MOVE ZEROES                  TO DTT-NUM-IDTT IN DTT.        
           MOVE FIO-GET-NLS TO FIO-CMND.                               
       BUS-NUM-CODI.                                                   
           PERFORM COL-FIO-DTT.                                        
           IF FIO-STAT-OKS 
              IF  DTT-CAI-IDTT IN DTT-FLD =  DTT-CAI-IDTT IN DTT AND      
               DTT-IIC-IDTT IN DTT-FLD =  DTT-IIC-IDTT IN DTT          
                IF DTT-NUM-CODI IN DTT      = 1 AND                     
                   DTT-NUM-CODI IN DTT-FLD  = 1        
                   MOVE 'COL'          TO MSG-COD-SIST                 
                   MOVE 'CODIRUTYAEXI' TO MSG-COD-MENS                 
                   PERFORM GET-MSG                                     
                   MOVE MSG-GLS-DESC TO FRM-MENS                       
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                       
                   GO TO FIN-VAL-DTT-NUM-CODI                          
                ELSE                                                   
                    MOVE FIO-GET-NXT TO FIO-CMND                       
                    GO TO BUS-NUM-CODI.                                
      *MHM-INI 21-DIC-2006                                              
       CNT-VAL-DTT-NUM-CODI.                                            
      *MHM-FIN 21-DIC-2006       
      *VAL-COD Valida codigo de tabla                                
           MOVE 'COL' TO TAB-COD-SIST.                                 
           MOVE 'CDF ' TO TAB-COD-TTAB IN TAB.                      
           MOVE DTT-NUM-CODI IN DTT-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'TIP    NEX' OR                            
               DTT-NUM-CODI IN DTT-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-CODI IN DTT-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-CODI IN DTT-FLD.     
      *>>>>
       FIN-VAL-DTT-NUM-CODI.
           EXIT.
       
       VAL-FRM-GLS-CODI SECTION.
       INI-VAL-FRM-GLS-CODI.
       FIN-VAL-FRM-GLS-CODI.
           EXIT.
       
       VAL-DTT-NUM-LARG SECTION.
       INI-VAL-DTT-NUM-LARG.
      *<<<< INI_VAL_DTT_NUM_LARG
           IF PTT-COD-TIPO IN DTT-FLD = 'F' AND                         
              DTT-NUM-LARG IN DTT-FLD NOT > ZEROES                      
               PERFORM ERR-GLS                                          
               GO TO FIN-VAL-DTT-NUM-LARG.        
      *>>>>
       FIN-VAL-DTT-NUM-LARG.
           EXIT.
       
       VAL-CON-FLD-DTT SECTION.
       INI-VAL-CON-FLD-DTT.
       FIN-VAL-CON-FLD-DTT.
           EXIT.
       
       VAL-CON-DTT SECTION.
       INI-VAL-CON-DTT.
       FIN-VAL-CON-DTT.
           EXIT.
       
       VAL-NUM-KEY-DTT SECTION.
       INI-VAL-NUM-KEY-DTT.
           PERFORM VAL-NUM-IKY-DTT.
           PERFORM VAL-NUM-MKY-DTT.
           PERFORM VAL-NUM-AKY-DTT.
       FIN-VAL-NUM-KEY-DTT.
           EXIT.
       
       VAL-NUM-IKY-DTT SECTION.
       INI-VAL-NUM-IKY-DTT.
       VAL-NUM-DTT-IIC-IDTT.
           MOVE DTT-IIC-IDTT-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DTT-IIC-IDTT IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DTT-IIC-IDTT-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-IKY-DTT.
       VAL-NUM-DTT-NUM-IDTT.
           MOVE DTT-NUM-IDTT-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DTT-NUM-IDTT IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DTT-NUM-IDTT-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-IKY-DTT.
       FIN-VAL-NUM-IKY-DTT.
           EXIT.
       
       VAL-NUM-MKY-DTT SECTION.
       INI-VAL-NUM-MKY-DTT.
       FIN-VAL-NUM-MKY-DTT.
           EXIT.
       
       VAL-NUM-AKY-DTT SECTION.
       INI-VAL-NUM-AKY-DTT.
       FIN-VAL-NUM-AKY-DTT.
           EXIT.
       
       VAL-NUM-FLD-DTT SECTION.
       INI-VAL-NUM-FLD-DTT.
       VAL-NUM-PTT-IIC-ICVN.
           MOVE PTT-IIC-ICVN-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PTT-IIC-ICVN IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PTT-IIC-ICVN-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-FLD-DTT.
       VAL-NUM-DTT-NUM-CODI.
           MOVE DTT-NUM-CODI-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DTT-NUM-CODI IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DTT-NUM-CODI-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-FLD-DTT.
       VAL-NUM-DTT-NUM-LARG.
           MOVE DTT-NUM-LARG-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DTT-NUM-LARG IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DTT-NUM-LARG-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-FLD-DTT.
       FIN-VAL-NUM-FLD-DTT.
           EXIT.
       
       EDT-KEY-DTT SECTION.
       INI-EDT-KEY-DTT.
           PERFORM EDT-IKY-DTT.
           PERFORM EDT-MKY-DTT.
           PERFORM EDT-AKY-DTT.
       FIN-EDT-KEY-DTT.
           EXIT.
       
       EDT-IKY-DTT SECTION.
       INI-EDT-IKY-DTT.
           IF DTT-IIC-IDTT-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DTT-IIC-IDTT-LEN IN DTT-FLD
                GO TO FIN-EDT-IKY-DTT.
           MOVE DTT-IIC-IDTT IN DTT-FLD TO DTT-IIC-IDTT-EDT IN DTT-EDT.
           MOVE DTT-IIC-IDTT-EDT IN DTT-EDT TO 
                DTT-IIC-IDTT-ALF IN DTT-FLD.
           IF DTT-NUM-IDTT-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DTT-NUM-IDTT-LEN IN DTT-FLD
                GO TO FIN-EDT-IKY-DTT.
           MOVE DTT-NUM-IDTT IN DTT-FLD TO DTT-NUM-IDTT-EDT IN DTT-EDT.
           MOVE DTT-NUM-IDTT-EDT IN DTT-EDT TO 
                DTT-NUM-IDTT-ALF IN DTT-FLD.
       FIN-EDT-IKY-DTT.
           EXIT.
       
       EDT-MKY-DTT SECTION.
       INI-EDT-MKY-DTT.
       FIN-EDT-MKY-DTT.
           EXIT.
       
       EDT-AKY-DTT SECTION.
       INI-EDT-AKY-DTT.
       FIN-EDT-AKY-DTT.
           EXIT.
       
       EDT-FLD-DTT SECTION.
       INI-EDT-FLD-DTT.
           IF PTT-IIC-ICVN-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PTT-IIC-ICVN-LEN IN DTT-FLD
                GO TO FIN-EDT-FLD-DTT.
           MOVE PTT-IIC-ICVN IN DTT-FLD TO PTT-IIC-ICVN-EDT IN DTT-EDT.
           MOVE PTT-IIC-ICVN-EDT IN DTT-EDT TO 
                PTT-IIC-ICVN-ALF IN DTT-FLD.
           IF DTT-NUM-CODI-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DTT-NUM-CODI-LEN IN DTT-FLD
                GO TO FIN-EDT-FLD-DTT.
           MOVE DTT-NUM-CODI IN DTT-FLD TO DTT-NUM-CODI-EDT IN DTT-EDT.
           MOVE DTT-NUM-CODI-EDT IN DTT-EDT TO 
                DTT-NUM-CODI-ALF IN DTT-FLD.
           IF DTT-NUM-LARG-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DTT-NUM-LARG-LEN IN DTT-FLD
                GO TO FIN-EDT-FLD-DTT.
           MOVE DTT-NUM-LARG IN DTT-FLD TO DTT-NUM-LARG-EDT IN DTT-EDT.
           MOVE DTT-NUM-LARG-EDT IN DTT-EDT TO 
                DTT-NUM-LARG-ALF IN DTT-FLD.
       FIN-EDT-FLD-DTT.
           EXIT.
