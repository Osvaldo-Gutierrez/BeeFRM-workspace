       IDENTIFICATION DIVISION.
       PROGRAM-ID. COLPBORR.
       AUTHOR. PHJH.
      *REMARKS. BORRAR DETERMINADOS DATOS DE UNA TABLA (PRODUCCION).
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 30 DE MARZO DE 1998                                    *
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.

       SPECIAL-NAMES.
           C01 IS CANAL-1
           DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       DATA DIVISION.
       FILE SECTION.

       WORKING-STORAGE SECTION.
      *-----------------------
       77  I                       PIC 99 VALUE 0.
       77  SW-OPC                  PIC XXX VALUE SPACES.
       77  REG-LEIDOS              PIC 9(7)            VALUE 0.
       77  REG-BORRADOS            PIC 9(7)            VALUE 0.
       77  REG-OPC1                PIC 9(7)            VALUE 0.
       77  REG-OPC2                PIC 9(7)            VALUE 0.
       77  TB-WS                   PIC XXX             VALUE SPACES.
       77  TT-WS                   PIC XXX             VALUE SPACES.
      *77  TA-WS                   PIC X               VALUE SPACE.
       77  CAMPO-WS                PIC X(50)           VALUE SPACES.
       77  BDATO-WS                PIC 999             VALUE 0.
       77  VAR-AUX                 PIC XXXX            VALUE SPACE.
       77  VAR-AUX9                PIC X(50)           VALUE SPACES.
       01  TARJETA.
           05 DIA-T         PIC 99.
           05 MES-T         PIC 99.
           05 ANO-T         PIC 99.
           05 FILLER        PIC X.
           05 BDATO-T       PIC 999.
           05 FILLER        PIC X.
           05 TIPO-BORRADO  PIC XXX.
           05 FILLER        PIC X.
           05 TIPO-TABLA    PIC XXX.
           05 FILLER        PIC X.
           05 CAMPO-T.
              10 TIPO-ARCH  PIC XXXX.
              10 FIL-T      PIC X(46).
           05 FILLER        PIC X(11).

      ******************************************************************
      *      USER INFORMATION BLOCK
      ******************************************************************
       01  UIB.
           05 FILLER                 PIC X(32) VALUE 'COLPBORR'.
       01  AREA-VARIOS.
           05 TA-WS.
              10 TA1-WS PIC X.
              10 TA2-WS PIC XXX.
           05 TA-WS9.
              10 TA1-WS9 PIC X.
              10 TA2-WS9 PIC XXX.
           05 TA-AUX.
              10 TA1-AUX PIC X.
              10 TA2-AUX PIC XXX.



      ******************************************************************
      *      REQUEST AREA
      ******************************************************************
       01  REQ-AREA-GEN.
           03 GEN-COMMAND          PIC X(5).
           03 GEN-TABLE            PIC X(3) VALUE '   '.
           03 GEN-KEY              PIC X(5).
           03 GEN-RET-COD          PIC X(2) VALUE SPACES.
           03 GEN-INT-RC           PIC X(1).
           03 GEN-DB-ID            PIC S9(4) COMP VALUE +000.
           03 GEN-REC-ID           PIC X(7).
           03 FILLER               PIC X(25).
           03 GEN-CONT-MAX         PIC S9(4) COMP.
           03 GEN-CONT-IO          PIC S9(4) COMP.
           03 FILLER               PIC X(22).
           03 GEN-VALUE            PIC X(50).




      ******************************************************************
      *                   WORK AREA
      ******************************************************************


       01  REG-OPC.
      *    COPYDD COL-R-OPC.COL-E-OPC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO OPC
           02  COL-E-OPC00.
      *                             OPERACION CREDITO
               03  OPC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  OPC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  OPC-KEY-IREG.
      *                             KEY     IDENTIFICACION OPERACION CRE
                       05  OPC-KEY-IOPC.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  OPC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  OPC-CAI-IOPC.
                       08  OPC-COD-TOPC
                                    PICTURE X(1).
                       08  OPC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  OPC-IIC-IOPC.
                       08  OPC-COD-OOPC.
                       09  OPC-COD-SOPC
                                    PICTURE X(2).
                       09  OPC-IND-SOPC
                                    PICTURE X(1).
                       08  OPC-GLS-NOPC
                                    PICTURE X(5).
      *                             TIME STAMP TRANSACCION
                       05  OPC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  OPC-FEC-FTRN.
                       07  OPC-NUM-STRN
                                    PICTURE 9(2).
                       07  OPC-NUM-ATRN
                                    PICTURE 9(2).
                       07  OPC-NUM-MTRN
                                    PICTURE 9(2).
                       07  OPC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  OPC-HRA-HRTR.
                       07  OPC-NUM-HHTR
                                    PICTURE 9(2).
                       07  OPC-NUM-MMTR
                                    PICTURE 9(2).
                       07  OPC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  OPC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  OPC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  OPC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  OPC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  OPC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  OPC-COD-ATRN PICTURE X(12).
      *                             REQ VALOR DE CAMBIO OPERACION CREDIT
                   04  OPC-COD-VCOC.
      *                             MISCELANEO TIPO VALOR
                       05  OPC-MSC-TVOC
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       05  OPC-COD-CVOC
                                    PICTURE X(3).
      *                             CODIGO TIPO CAMBIO
                       05  OPC-COD-TCOC
                                    PICTURE X(2).
      *                             REQ CODIGO CLASE OPERACION CREDITO
                   04  OPC-COD-COOC.
      *                             CODIGO TIPO OPERACION
                       05  OPC-COD-TOOC
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       05  OPC-COD-AOOC
                                    PICTURE X(3).
      *                             REQ CODIGO OFICINA OPERACION CREDITO
                   04  OPC-COD-OFOC PICTURE X(3).
      *                             RESPONSABLE MANTENCION OPERACION CRE
                   04  OPC-COD-RMOC PICTURE X(12).
      *                             CODIGO DESTINO OPERACION CREDITO
                   04  OPC-COD-CDOC PICTURE X(3).
      *                             COD. INT. COMP. LINEA DE CREDITO
                   04  OPC-CIC-ILDC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       05  OPC-CAI-ILDC.
                       06  OPC-COD-TLDC
                                    PICTURE X(1).
                       06  OPC-COD-CLDC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       05  OPC-IIC-ILDC.
                       06  OPC-COD-OLDC.
                       07  OPC-COD-SLDC
                                    PICTURE X(2).
                       07  OPC-IND-SLDC
                                    PICTURE X(1).
                       06  OPC-GLS-NLDC
                                    PICTURE X(5).
      *                             REQ FECHA CURSE O COLOCACION
                   04  OPC-FEC-FCOL.
                       05  OPC-NUM-SCOL
                                    PICTURE 9(2).
                       05  OPC-NUM-ACOL
                                    PICTURE 9(2).
                       05  OPC-NUM-MCOL
                                    PICTURE 9(2).
                       05  OPC-NUM-DCOL
                                    PICTURE 9(2).
      *                             REQ FECHA CURSE CONTABLE
                   04  OPC-FEC-FING.
                       05  OPC-NUM-SING
                                    PICTURE 9(2).
                       05  OPC-NUM-AING
                                    PICTURE 9(2).
                       05  OPC-NUM-MING
                                    PICTURE 9(2).
                       05  OPC-NUM-DING
                                    PICTURE 9(2).
      *                             REQ FECHA CURSE COMPUTACIONAL
                   04  OPC-FEC-FINP.
                       05  OPC-NUM-SINP
                                    PICTURE 9(2).
                       05  OPC-NUM-AINP
                                    PICTURE 9(2).
                       05  OPC-NUM-MINP
                                    PICTURE 9(2).
                       05  OPC-NUM-DINP
                                    PICTURE 9(2).
      *                             REQ MONTO CREDITO
                   04  OPC-VAL-CRED PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ SALDO VALOR CREDITO
                   04  OPC-VAL-SCRE PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ ANALISIS FERIADOS (S/N)
                   04  OPC-IND-AFER PICTURE X(1).
      *                             REQ MODALIDAD CALCULO VALORES FINALE
                   04  OPC-MSC-MCVF PICTURE X(1).
      *                             REQ TIPO CALCULO VENCIMIENTOS
                   04  OPC-MSC-TCVE.
      *                             BASE CALCULO CREDITO
                       05  OPC-MSC-BCCR
                                    PICTURE X(1).
      *                             VALORES INFORMADOS CREDITO
                       05  OPC-MSC-VICR
                                    PICTURE X(1).
      *                             TIPO RENOVACION
                   04  OPC-IND-RENO PICTURE X(3).
      *                             CONDICION GARANTIA
                   04  OPC-IND-GARA PICTURE X(3).
      *                             VALOR COMISION
                   04  OPC-SGV-VCOM PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR GASTOS
                   04  OPC-VAL-GAST PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             CODIGO DE SEGURO DESGRAVAMEN
                   04  OPC-COD-SEGD.
                       05  OPC-COD-ISEG
                                    PICTURE X(3).
                       05  OPC-COD-CSEG
                                    PICTURE X(3).
                       05  OPC-COD-SSEG
                                    PICTURE X(3).
      *                             VALOR SEGURO
                   04  OPC-VAL-SEGD PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR LIQUIDO
                   04  OPC-SGV-LIQU PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ NUMERO PROXIMO VENCIMIENTO
                   04  OPC-NUM-IVEN PICTURE 9(3).
      *                             REQ NUMERO VENCIMIENTOS ORIGINALES
                   04  OPC-NUM-VCOR PICTURE 9(3).
      *                             REQ NUMERO VENCIMIENTOS VIGENTES
                   04  OPC-NUM-VCVG PICTURE 9(3).
      *                             NUMERO VENCTOS CANCELADOS EN FORMA O
                   04  OPC-NUM-VCCO PICTURE 9(3).
      *                             NUMERO VENCIMIENTOS CANCELADOS MOROS
                   04  OPC-NUM-VCCM PICTURE 9(3).
      *                             NUMERO DE VENCIMIENTOS CANCELADOS VE
                   04  OPC-NUM-VCCV PICTURE 9(3).
      *                             REQ NUMERO TOTAL VENCIMIENTOS CANCEL
                   04  OPC-NUM-TVCC PICTURE 9(3).
      *                             INDICADOR VENCIMIENTOS ESTRUCTURADOS
                   04  OPC-IND-VSTR PICTURE X(1).
      *                             COD. INT. COMP. CREDITO ENLACE
                   04  OPC-CIC-ICEN.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       05  OPC-CAI-ICEN.
                       06  OPC-COD-TCEN
                                    PICTURE X(1).
                       06  OPC-COD-CCEN
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       05  OPC-IIC-ICEN.
                       06  OPC-COD-OCEN.
                       07  OPC-COD-SCEN
                                    PICTURE X(2).
                       07  OPC-IND-SCEN
                                    PICTURE X(1).
                       06  OPC-GLS-NCEN
                                    PICTURE X(5).
      *                             CODIGO AREA GESTION
                   04  OPC-COD-AGES PICTURE X(2).
      *                             FLAG PARA ACTIVAR SIN CONTABILIZAR
                   04  FILLER       PICTURE X(1).
      *                             INDICADOR INSISTENCIA
                   04  FILLER       PICTURE X(1).
      *                             CANAL DE VENTA
                   04  FILLER       PICTURE X(1).
      *                             VALOR SEGURO
                   04  FILLER       PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             GLOSA DISPONIBLE
                   04  OPC-GLS-DISP PICTURE X(20).
       01  REG-DLC.
      *    COPYDD COL-R-DLC.COL-E-DLC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DLC
           02  COL-E-DLC00.
      *                             DOCUMENTO LEGAL CREDITO
               03  DLC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DLC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  DLC-KEY-IREG.
      *                             KEY     IDENTIFICACION DOCUMENTO LEG
                       05  DLC-KEY-IDLC.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  DLC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DLC-CAI-IOPC.
                       08  DLC-COD-TOPC
                                    PICTURE X(1).
                       08  DLC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DLC-IIC-IOPC.
                       08  DLC-COD-OOPC.
                       09  DLC-COD-SOPC
                                    PICTURE X(2).
                       09  DLC-IND-SOPC
                                    PICTURE X(1).
                       08  DLC-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENTIFICACION DOCUMENTO LEGAL
                       06  DLC-NUM-IDLC
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  DLC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DLC-FEC-FTRN.
                       07  DLC-NUM-STRN
                                    PICTURE 9(2).
                       07  DLC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DLC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DLC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DLC-HRA-HRTR.
                       07  DLC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DLC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DLC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  DLC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DLC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  DLC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DLC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DLC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  DLC-COD-ATRN PICTURE X(12).
      *                             REQ VALOR NOMINAL DOCUMENTO LEGAL
                   04  DLC-VAL-NDLC PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR SALDO DOCUMENTO LEGAL
                   04  DLC-VAL-SDLC PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ CODIGO TIPO DOCUMENTO
                   04  DLC-COD-TDOC PICTURE X(3).
      *                             REQ CODIGO PLAZO ( CONTABLE )
                   04  DLC-COD-PLZO.
                       05  DLC-MSC-TPZO
                                    PICTURE X(1).
                       05  DLC-MSC-CPZO
                                    PICTURE X(1).
      *                             TIPO IMPUESTOS
                   04  DLC-MSC-TIMP PICTURE X(1).
      *                             VALOR IMPUESTOS
                   04  DLC-VAL-IMPU PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             CODIGO NOTARIO CREDITO
                   04  DLC-COD-NOTC.
                       05  DLC-COD-INOT
                                    PICTURE X(3).
                       05  DLC-COD-CNOT
                                    PICTURE X(3).
                       05  DLC-COD-SNOT
                                    PICTURE X(3).
      *                             VALOR GASTOS NOTARIO
                   04  DLC-VAL-GNOT PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SITUACION COBRANZA
                   04  DLC-IND-SCBZ PICTURE X(5).
      *                             REQ SITUACION CARTERA
                   04  DLC-IND-SCRT PICTURE X(3).
      *                             CODIGO UBICACION FISICA
                   04  DLC-COD-UBFD.
                       05  DLC-COD-IUBF
                                    PICTURE X(3).
                       05  DLC-COD-CUBF
                                    PICTURE X(3).
                       05  DLC-COD-SUBF
                                    PICTURE X(3).
      *                             REQ CODIGO PLAZA
                   04  DLC-COD-PLZA PICTURE X(4).
      *                             REQ MANEJO INTERESES PERIODOS LARGOS
                   04  DLC-MSC-MIPL PICTURE X(1).
      *                             REQ CLASIFICACION RIESGO
                   04  DLC-IND-RIES PICTURE X(2).
      *                             PEN VALOR REAJUSTES DEVENGADOS DOCUM
                   04  DLC-VAL-READ PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             PEN VALOR INTERESES DEVENGADOS DOCUM
                   04  DLC-VAL-INTD PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ FECHA DEVENGO ( ULTIMO PAGO TOTA
                   04  DLC-FEC-FDEV.
                       05  DLC-NUM-SDEV
                                    PICTURE 9(2).
                       05  DLC-NUM-ADEV
                                    PICTURE 9(2).
                       05  DLC-NUM-MDEV
                                    PICTURE 9(2).
                       05  DLC-NUM-DDEV
                                    PICTURE 9(2).
      *                             SALDO INTERESES
                   04  DLC-VAL-SINT PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SALDO CAPITAL POR AMORTIZAR
                   04  DLC-VAL-SCPA PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             FECHA AMORTIZACION
                   04  DLC-FEC-FAMT.
                       05  DLC-NUM-SAMT
                                    PICTURE 9(2).
                       05  DLC-NUM-AAMT
                                    PICTURE 9(2).
                       05  DLC-NUM-MAMT
                                    PICTURE 9(2).
                       05  DLC-NUM-DAMT
                                    PICTURE 9(2).
      *                             IDENTIFICACION DOCUMENTO LEGAL ORIGI
                   04  DLC-KEY-IDLO.
      *                             COD. INT. COMP. OPERACION CREDITO OR
                       05  DLC-CIC-IOCO.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       06  DLC-CAI-IOCO.
                       07  DLC-COD-TOCO
                                    PICTURE X(1).
                       07  DLC-COD-COCO
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       06  DLC-IIC-IOCO.
                       07  DLC-COD-OOCO.
                       08  DLC-COD-SOCO
                                    PICTURE X(2).
                       08  DLC-IND-SOCO
                                    PICTURE X(1).
                       07  DLC-GLS-NOCO
                                    PICTURE X(5).
      *                             NUM IDENT DOCUMENTO LEGAL ORIGINAL
                       05  DLC-NUM-IDLO
                                    PICTURE 9(3).
      *                             MONTO INTERESES PENDIENTES
                   04  DLC-VAL-IPEN PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR DOCTO EN PESOS (CUADRE CON
                   04  DLC-VAL-DPES PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR SITUACION CONTABLE
                   04  DLC-IND-SCTB PICTURE X(3).
      *                             FECHA MAXIMO VENCIMIENTO
                   04  DLC-FEC-FMAV.
                       05  DLC-NUM-SMAV
                                    PICTURE 9(2).
                       05  DLC-NUM-AMAV
                                    PICTURE 9(2).
                       05  DLC-NUM-MMAV
                                    PICTURE 9(2).
                       05  DLC-NUM-DMAV
                                    PICTURE 9(2).
      *                             VENC. EN SITUACION CONTBLE ESPECIAL
                   04  DLC-NUM-VSCE PICTURE 9(3).
      *                             FECHA SUSPENCION DEVENGO
                   04  DLC-FEC-FSDE.
                       05  DCL-NUM-SSDE
                                    PICTURE 9(2).
                       05  DCL-NUM-ASDE
                                    PICTURE 9(2).
                       05  DCL-NUM-MSDE
                                    PICTURE 9(2).
                       05  DCL-NUM-DSDE
                                    PICTURE 9(2).
      *                             GLOSA DISPONIBLE
                   04  DLC-GLS-DISP PICTURE X(63).
       01  REG-RDC.
      *    COPYDD COL-R-RDC.COL-E-RDC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RDC
           02  COL-E-RDC00.
      *                             RELACION DEUDOR CREDITO
               03  RDC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RDC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  RDC-KEY-IREG.
      *                             KEY     IDENTIFICACION RELACION DEUD
                       05  RDC-KEY-IRDC.
      *                             COD. INT. COMP. CLIENTE
                       06  RDC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RDC-CAI-ICLI.
                       08  RDC-COD-TCLI
                                    PICTURE X(1).
                       08  RDC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RDC-IIC-ICLI
                                    PICTURE X(8).
      *                             IDENTIFICACION DOCUMENTO LEGAL
                       06  RDC-KEY-IDLC.
      *                             COD. INT. COMP. OPERACION CURSADA
                       07  RDC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  RDC-CAI-IOPC.
                       09  RDC-COD-TOPC
                                    PICTURE X(1).
                       09  RDC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  RDC-IIC-IOPC.
                       09  RDC-COD-OOPC.
                       10  RDC-COD-SOPC
                                    PICTURE X(2).
                       10  RDC-IND-SOPC
                                    PICTURE X(1).
                       09  RDC-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENTIFICACION DOCUMENTO LEGAL
                       07  RDC-NUM-IDLC
                                    PICTURE 9(3).
      *                             CODIGO TIPO RELACION
                       05  RDC-COD-TRDC
                                    PICTURE X(3).
      *                             TIME STAMP TRANSACCION
                       05  RDC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RDC-FEC-FTRN.
                       07  RDC-NUM-STRN
                                    PICTURE 9(2).
                       07  RDC-NUM-ATRN
                                    PICTURE 9(2).
                       07  RDC-NUM-MTRN
                                    PICTURE 9(2).
                       07  RDC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RDC-HRA-HRTR.
                       07  RDC-NUM-HHTR
                                    PICTURE 9(2).
                       07  RDC-NUM-MMTR
                                    PICTURE 9(2).
                       07  RDC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  RDC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RDC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  RDC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RDC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RDC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  RDC-COD-ATRN PICTURE X(12).
      *                             PEN DIRECCION ASOCIADA
                   04  RDC-NUM-DIRE PICTURE X(2).
      *                             REQ MONTO LIMITE DEUDA ( PORCENTAJE
                   04  RDC-VAL-LIMD PICTURE 9(3)V9(6)
                                        COMPUTATIONAL.
      *                             GLOSA DISPONIBLE
                   04  RDC-GLS-DISP PICTURE X(6).
       01  REG-VEN.
      *    COPYDD COL-R-VEN.COL-E-VEN00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO VEN
           02  COL-E-VEN00.
      *                             VENCIMIENTOS
               03  VEN.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  VEN-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  VEN-KEY-IREG.
      *                             KEY     IDENTIFICACION VENCIMIENTOS
                       05  VEN-KEY-IVEN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  VEN-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  VEN-CAI-IOPC.
                       08  VEN-COD-TOPC
                                    PICTURE X(1).
                       08  VEN-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  VEN-IIC-IOPC.
                       08  VEN-COD-OOPC.
                       09  VEN-COD-SOPC
                                    PICTURE X(2).
                       09  VEN-IND-SOPC
                                    PICTURE X(1).
                       08  VEN-GLS-NOPC
                                    PICTURE X(5).
      *                             NUMERO IDENTIFICACION VENCIMIENTO
                       06  VEN-NUM-IVEN
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  VEN-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  VEN-FEC-FTRN.
                       07  VEN-NUM-STRN
                                    PICTURE 9(2).
                       07  VEN-NUM-ATRN
                                    PICTURE 9(2).
                       07  VEN-NUM-MTRN
                                    PICTURE 9(2).
                       07  VEN-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  VEN-HRA-HRTR.
                       07  VEN-NUM-HHTR
                                    PICTURE 9(2).
                       07  VEN-NUM-MMTR
                                    PICTURE 9(2).
                       07  VEN-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  VEN-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  VEN-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  VEN-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  VEN-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  VEN-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  VEN-COD-ATRN PICTURE X(12).
      *                             REQ FECHA VENCIMIENTO
                   04  VEN-FEC-FVEN.
                       05  VEN-NUM-SVEN
                                    PICTURE 9(2).
                       05  VEN-NUM-AVEN
                                    PICTURE 9(2).
                       05  VEN-NUM-MVEN
                                    PICTURE 9(2).
                       05  VEN-NUM-DVEN
                                    PICTURE 9(2).
      *                             REQ FECHA INICIO MORA VENCIMIENTO
                   04  VEN-FEC-FIMV.
                       05  VEN-NUM-SIMV
                                    PICTURE 9(2).
                       05  VEN-NUM-AIMV
                                    PICTURE 9(2).
                       05  VEN-NUM-MIMV
                                    PICTURE 9(2).
                       05  VEN-NUM-DIMV
                                    PICTURE 9(2).
      *                             REQ VALOR CAPITAL VENCIMIENTO
                   04  VEN-VAL-CAPI PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ SALDO VALOR CAPITAL VENCIMIENTO
                   04  VEN-VAL-SCAP PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ INT DEVENGADOS NO INCLUIDOS EN V
                   04  VEN-VAL-IDNI PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR FINAL VENCIMIENTO
                   04  VEN-VAL-FINA PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ SALDO VALOR FINAL VENCIMIENTO
                   04  VEN-VAL-SFIN PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SITUACION CONTABLE
                   04  VEN-IND-SCTB PICTURE X(3).
      *                             REQ NUMERO IDENTIFICACION VENCIMIENT
                   04  VEN-NUM-IVCT PICTURE 9(3).
      *                             NUMERO IDENTIFICACION ESTRUCTURA VEN
                   04  VEN-NUM-IEVC PICTURE 9(3).
      *                             REQ NUMERO IDENTIFICACION DOCUMENTO
                   04  VEN-NUM-IDLC PICTURE 9(3).
      *                             INDICADOR CARGO AUTOMATICO
                   04  VEN-IND-CAUT PICTURE X(1).
      *                             SITUACION COBRANZA
                   04  VEN-IND-SCBZ PICTURE X(5).
      *                             MONTO TRASPASADO SITUACION CONTABLE
                   04  VEN-VAL-MTSC PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR TRASPASO SITUACION CONTAB.
                   04  VEN-IND-MTSC PICTURE X(1).
      *                             INDICADOR DE CALCULO
                   04  VEN-IND-CALC PICTURE X(1).
      *                             SITUACION CONTABLE ANTERIOR
                   04  VEN-IND-CTBA PICTURE X(3).
      *                             GLOSA DISPONIBLE
                   04  VEN-GLS-DISP PICTURE X(10).
       01  REG-ICG.
      *    COPYDD COL-R-ICG.COL-E-ICG00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO ICG
           02  COL-E-ICG00.
      *                             INTERES COMISIONES GASTOS
               03  ICG.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  ICG-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  ICG-KEY-IREG.
      *                             KEY     IDENTIFICACION TASAS
                       05  ICG-KEY-IICG.
      *                             IDENTIFICACION CANCELACION
                       06  ICG-KEY-ICAN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  ICG-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  ICG-CAI-IOPC.
                       09  ICG-COD-TOPC
                                    PICTURE X(1).
                       09  ICG-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  ICG-IIC-IOPC.
                       09  ICG-COD-OOPC.
                       10  ICG-COD-SOPC
                                    PICTURE X(2).
                       10  ICG-IND-SOPC
                                    PICTURE X(1).
                       09  ICG-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENT. CANCELACION
                       07  ICG-NUM-ICAN
                                    PICTURE 9(3).
      *                             IDENTIFICACION VENCIMIENTO
                       06  ICG-KEY-IVCT.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  ICG-CIC-IOPV.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  ICG-CAI-IOPV.
                       09  ICG-COD-TOPV
                                    PICTURE X(1).
                       09  ICG-COD-COPV
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  ICG-IIC-IOPV.
                       09  ICG-COD-OOPV.
                       10  ICG-COD-SOPV
                                    PICTURE X(2).
                       10  ICG-IND-SOPV
                                    PICTURE X(1).
                       09  ICG-GLS-NOPV
                                    PICTURE X(5).
      *                             NUM IDENT. VENCIMIENTO
                       07  ICG-NUM-IVCT
                                    PICTURE 9(3).
      *                             TIPO TASA
                       06  ICG-IND-TTAS
                                    PICTURE X(3).
      *                             FECHA INICIO VIGENCIA TASA
                       06  ICG-FEC-FINI.
                       07  ICG-NUM-SINI
                                    PICTURE 9(2).
                       07  ICG-NUM-AINI
                                    PICTURE 9(2).
                       07  ICG-NUM-MINI
                                    PICTURE 9(2).
                       07  ICG-NUM-DINI
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  ICG-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  ICG-FEC-FTRN.
                       07  ICG-NUM-STRN
                                    PICTURE 9(2).
                       07  ICG-NUM-ATRN
                                    PICTURE 9(2).
                       07  ICG-NUM-MTRN
                                    PICTURE 9(2).
                       07  ICG-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  ICG-HRA-HRTR.
                       07  ICG-NUM-HHTR
                                    PICTURE 9(2).
                       07  ICG-NUM-MMTR
                                    PICTURE 9(2).
                       07  ICG-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  ICG-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  ICG-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  ICG-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  ICG-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  ICG-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  ICG-COD-ATRN PICTURE X(12).
      *                             REQ CODIGO TIPO TASA INTERES
                   04  ICG-COD-TINT.
      *                             CODIGO TIPO TASA
                       05  ICG-COD-TIPT.
      *                             BASE CALCULO TASA INTERES
                       06  ICG-MSC-BCTI
                                    PICTURE X(1).
      *                             PERIODO BASE TASA INTERES
                       06  ICG-MSC-PBTI
                                    PICTURE X(1).
      *                             MODALIDAD CALCULO TASA INTERES
                       06  ICG-MSC-MCTI.
      *                             BAJO PERIODO BASE TASA           COL
                       07  ICG-MSC-BPBT
                                    PICTURE X(1).
      *                             SOBRE PERIODO BASE TASA          COL
                       07  ICG-MSC-SPBT
                                    PICTURE X(1).
      *                             CODIGO VALOR TASA INTERES
                       05  ICG-COD-CVTI
                                    PICTURE X(3).
      *                             TIPO FECHA PERIODO REPACTO
                       05  ICG-MSC-TFPR
                                    PICTURE X(1).
      *                             NUMERO PERIODO REPACTO
                       05  ICG-NUM-PREP
                                    PICTURE 9(3).
      *                             UNIDAD TIEMPO PERIODO REPACTO
                       05  ICG-MSC-UTPR
                                    PICTURE X(1).
      *                             FECHA TERMINO VIGENCIA TASA
                   04  ICG-FEC-FTER.
                       05  ICG-NUM-STER
                                    PICTURE 9(2).
                       05  ICG-NUM-ATER
                                    PICTURE 9(2).
                       05  ICG-NUM-MTER
                                    PICTURE 9(2).
                       05  ICG-NUM-DTER
                                    PICTURE 9(2).
      *                             REQ VALOR SPREAD
                   04  ICG-SGV-SPRD PICTURE S9(3)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR TASA
                   04  ICG-SGV-TINT PICTURE S9(3)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR EN MONTO
                   04  ICG-SGV-MNTO PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             GLOSA DISPONIBLE
                   04  ICG-GLS-DISP PICTURE X(7).
       01  REG-RCV.
      *    COPYDD COL-R-RCV.COL-E-RCV00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RCV
           02  COL-E-RCV00.
      *                             RELACION CANCELACION VENCIMIENTOS
               03  RCV.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RCV-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  RCV-KEY-IREG.
      *                             KEY     IDENTIFICACION RELACION CANC
                       05  RCV-KEY-IRCV.
      *                             IDENTIFICACION CANCELACION
                       06  RCV-KEY-ICAN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  RCV-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  RCV-CAI-IOPC.
                       09  RCV-COD-TOPC
                                    PICTURE X(1).
                       09  RCV-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  RCV-IIC-IOPC.
                       09  RCV-COD-OOPC.
                       10  RCV-COD-SOPC
                                    PICTURE X(2).
                       10  RCV-IND-SOPC
                                    PICTURE X(1).
                       09  RCV-GLS-NOPC
                                    PICTURE X(5).
      *                             NUMERO IDENTIFICACION CANCELACION
                       07  RCV-NUM-ICAN
                                    PICTURE 9(3).
      *                             IDENTIFICACION VENCIMIENTO
                       06  RCV-KEY-IVCT.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  RCV-CIC-IOPV.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  RCV-CAI-IOPV.
                       09  RCV-COD-TOPV
                                    PICTURE X(1).
                       09  RCV-COD-COPV
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  RCV-IIC-IOPV.
                       09  RCV-COD-OOPV.
                       10  RCV-COD-SOPV
                                    PICTURE X(2).
                       10  RCV-IND-SOPV
                                    PICTURE X(1).
                       09  RCV-GLS-NOPV
                                    PICTURE X(5).
      *                             NUMERO IDENTIFICACION VENCIMIENTO
                       07  RCV-NUM-IVCT
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  RCV-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RCV-FEC-FTRN.
                       07  RCV-NUM-STRN
                                    PICTURE 9(2).
                       07  RCV-NUM-ATRN
                                    PICTURE 9(2).
                       07  RCV-NUM-MTRN
                                    PICTURE 9(2).
                       07  RCV-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RCV-HRA-HRTR.
                       07  RCV-NUM-HHTR
                                    PICTURE 9(2).
                       07  RCV-NUM-MMTR
                                    PICTURE 9(2).
                       07  RCV-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  RCV-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RCV-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  RCV-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RCV-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RCV-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  RCV-COD-ATRN PICTURE X(12).
      *                             IDENTIFICACION DOCUMENTO ASOCIADO
                   04  RCV-KEY-IDLC.
      *                             COD. INT. COMP. OPERACION CREDITO
                       05  RCV-CIC-IOPD.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       06  RCV-CAI-IOPD.
                       07  RCV-COD-TOPD
                                    PICTURE X(1).
                       07  RCV-COD-COPD
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       06  RCV-IIC-IOPD.
                       07  RCV-COD-OOPD.
                       08  RCV-COD-SOPD
                                    PICTURE X(2).
                       08  RCV-IND-SOPD
                                    PICTURE X(1).
                       07  RCV-GLS-NOPD
                                    PICTURE X(5).
      *                             NUMERO IDENTIFICACION DOCUMENTO
                       05  RCV-NUM-IDLC
                                    PICTURE 9(3).
      *                             CORRELATIVO ESTRUCTURA VENCIMIENTOS
                   04  RCV-NUM-IEVC PICTURE 9(3).
      *                             REQ MODO CANCELACION ( ANTICIPADA, V
                   04  RCV-MSC-MCAN PICTURE X(1).
      *                             REQ VALOR CAPITAL CANCELADO
                   04  RCV-SGV-CAPI PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             MONTO INTERES NO INCLUIDO VALOR FINA
                   04  RCV-SGV-INTE PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR FINAL CANCELADO
                   04  RCV-SGV-FINA PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SITUACION CONTABLE
                   04  RCV-IND-SCTB PICTURE X(3).
      *                             SITUACION COBRANZA
                   04  RCV-IND-SCBZ PICTURE X(5).
      *                             REQ FECHA CANCELACION REAL
                   04  RCV-FEC-FCAN.
                       05  RCV-NUM-SCAN
                                    PICTURE 9(2).
                       05  RCV-NUM-ACAN
                                    PICTURE 9(2).
                       05  RCV-NUM-MCAN
                                    PICTURE 9(2).
                       05  RCV-NUM-DCAN
                                    PICTURE 9(2).
      *                             REQ FECHA CANCELACION COMPUTACIONAL
                   04  RCV-FEC-FOUT.
                       05  RCV-NUM-SOUT
                                    PICTURE 9(2).
                       05  RCV-NUM-AOUT
                                    PICTURE 9(2).
                       05  RCV-NUM-MOUT
                                    PICTURE 9(2).
                       05  RCV-NUM-DOUT
                                    PICTURE 9(2).
      *                             VALOR REAJUSTES CANCELADOS
                   04  RCV-SGV-REAJ PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INT. MOR. CANC. MONEDA CONTABLE
                   04  RCV-SGV-INTM PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REAJUSTES MORATORIOS CANCELADOS
                   04  RCV-SGV-REAM PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             GLOSA DISPONIBLE
                   04  RCV-GLS-DISP PICTURE X(4).
       01  REG-CAN.
      *    COPYDD COL-R-CAN.COL-E-CAN00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO CAN
           02  COL-E-CAN00.
      *                             CANCELACIONES
               03  CAN.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CAN-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  CAN-KEY-IREG.
      *                             KEY    IDENTIFICACION CANCELACION
                       05  CAN-KEY-ICAN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  CAN-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  CAN-CAI-IOPC.
                       08  CAN-COD-TOPC
                                    PICTURE X(1).
                       08  CAN-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  CAN-IIC-IOPC.
                       08  CAN-COD-OOPC.
                       09  CAN-COD-SOPC
                                    PICTURE X(2).
                       09  CAN-IND-SOPC
                                    PICTURE X(1).
                       08  CAN-GLS-NOPC
                                    PICTURE X(5).
      *                             NUMERO IDENTIFICACION CANCELACION
                       06  CAN-NUM-ICAN
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  CAN-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CAN-FEC-FTRN.
                       07  CAN-NUM-STRN
                                    PICTURE 9(2).
                       07  CAN-NUM-ATRN
                                    PICTURE 9(2).
                       07  CAN-NUM-MTRN
                                    PICTURE 9(2).
                       07  CAN-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CAN-HRA-HRTR.
                       07  CAN-NUM-HHTR
                                    PICTURE 9(2).
                       07  CAN-NUM-MMTR
                                    PICTURE 9(2).
                       07  CAN-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  CAN-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CAN-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  CAN-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CAN-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CAN-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  CAN-COD-ATRN PICTURE X(12).
      *                             REQ OFICINA CANCELACION
                   04  CAN-COD-OFCA PICTURE X(3).
      *                             CODIGO RESPONSABLE CANCELACION
                   04  CAN-COD-RCAN PICTURE X(12).
      *                             REQ CODIGO CANCELACION
                   04  CAN-MSC-CANC.
      *                             TIPO CANCELACION
                       05  CAN-MSC-TCAN
                                    PICTURE X(1).
      *                             FORMA CANCELACION
                       05  CAN-MSC-FCAN
                                    PICTURE X(1).
      *                             ENTIDAD CANCELACION
                       05  CAN-MSC-ECAN
                                    PICTURE X(1).
      *                             REQ FECHA CANCELACION REAL
                   04  CAN-FEC-FCAN.
                       05  CAN-NUM-SCAN
                                    PICTURE 9(2).
                       05  CAN-NUM-ACAN
                                    PICTURE 9(2).
                       05  CAN-NUM-MCAN
                                    PICTURE 9(2).
                       05  CAN-NUM-DCAN
                                    PICTURE 9(2).
      *                             REQ FECHA CANCELACION CONTABLE
                   04  CAN-FEC-FEGR.
                       05  CAN-NUM-SEGR
                                    PICTURE 9(2).
                       05  CAN-NUM-AEGR
                                    PICTURE 9(2).
                       05  CAN-NUM-MEGR
                                    PICTURE 9(2).
                       05  CAN-NUM-DEGR
                                    PICTURE 9(2).
      *                             REQ FECHA CANCELACION COMPUTACIONAL
                   04  CAN-FEC-FOUT.
                       05  CAN-NUM-SOUT
                                    PICTURE 9(2).
                       05  CAN-NUM-AOUT
                                    PICTURE 9(2).
                       05  CAN-NUM-MOUT
                                    PICTURE 9(2).
                       05  CAN-NUM-DOUT
                                    PICTURE 9(2).
      *                             VALOR GASTOS
                   04  CAN-SGV-GAST PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR TOTAL PAGADO
                   04  CAN-SGV-TPAG PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR TOTAL RENOVADO
                   04  CAN-SGV-TREN PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             TOTAL DE VENCIMIENTOS CANCELADOS
                   04  CAN-NUM-TVCC PICTURE S9(3).
      *                             DIFERENCIA, PAGO EFECT - DEBE PAGAR
                   04  CAN-SGV-DIFE PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             FECHA DEVENGO ANTERIOR
                   04  CAN-FEC-FDVA.
                       05  CAN-NUM-SDVA
                                    PICTURE 9(2).
                       05  CAN-NUM-ADVA
                                    PICTURE 9(2).
                       05  CAN-NUM-MDVA
                                    PICTURE 9(2).
                       05  CAN-NUM-DDVA
                                    PICTURE 9(2).
      *                             GLOSA DISPONIBLE
                   04  CAN-GLS-DISP PICTURE X(25).
       01  ELEM-LIST-GEN.
           03 ELEM-1         PIC X(5) VALUE '     '.
           03 ELEM-SEC       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.
       01  R-AUX PIC X(400).

       PROCEDURE DIVISION.
      *------------------
             ENTRY 'DBMSCBL'.
             ACCEPT TARJETA.
             IF (DIA-T > 0 AND DIA-T < 32)
                THEN NEXT SENTENCE
                ELSE
                 DISPLAY 'DIA TARJETA CONTROL ERRONEO'
                 GOBACK.

             IF (MES-T > 0 AND MES-T < 13)
                THEN NEXT SENTENCE
                ELSE
                 DISPLAY 'MES TARJETA CONTROL ERRONEO'
                 GOBACK.

      ****** IF (ANO-T > 87 AND ANO-T < 90)
      ******    THEN NEXT SENTENCE
      ******    ELSE
      ******     DISPLAY 'ANO TARJETA CONTROL ERRONEO'
      ******     GOBACK.

                 IF BDATO-T = 660 OR 170 OR 160
                    THEN NEXT SENTENCE
                    ELSE
                  DISPLAY 'BASE DATOS ERRONEA REVISAR TARJETA CONTROL'
                     GOBACK.

                 IF TIPO-BORRADO = 'TOT' OR 'PAR'
                    THEN NEXT SENTENCE
                    ELSE
                  DISPLAY 'PARAMETRO TIPO BORRADO ERRONEA,REVISAR TC'
                     GOBACK.

              IF TIPO-BORRADO = 'PAR'
              THEN
               IF TIPO-TABLA = 'OPC' OR 'DLC' OR 'RDC' OR 'VEN' OR 'ICG'
                         OR 'RCV' OR 'CAN'
                THEN NEXT SENTENCE
                ELSE
                 DISPLAY 'TIPO TABLA NO VALIDA,REVISAR TARJETA CONTROL'
                    GOBACK
                ELSE NEXT SENTENCE.

            IF TIPO-ARCH = 'A   ' OR 'B   ' OR 'C   ' OR 'D   ' OR 'E  '
                        OR 'E   ' OR 'F   ' OR '0400' OR 'G   '
               THEN NEXT SENTENCE
               ELSE
                DISPLAY 'TIPO ARCHIVO NO VALIDO,REVISAR TARJETA CONTROL'
                    GOBACK.





             MOVE CAMPO-T      TO CAMPO-WS
             MOVE TIPO-TABLA   TO TT-WS.
             MOVE TIPO-BORRADO TO TB-WS.
             MOVE TIPO-ARCH    TO TA-WS.
             MOVE BDATO-T      TO BDATO-WS.
      ******************************************************
      *
      ******************************************************
           IF BDATO-WS = 660
              THEN MOVE +660 TO GEN-DB-ID.
           IF BDATO-WS = 160
              THEN MOVE +160 TO GEN-DB-ID.
           IF BDATO-WS = 170
              THEN MOVE +170 TO GEN-DB-ID.

           IF TB-WS = 'PAR'
              THEN
               PERFORM PROCESO-BORRADO
              ELSE
               PERFORM PROCESO VARYING I FROM 1 BY 1 UNTIL I > 7.
           GOBACK.
       PROCESO.
           MOVE 0 TO REG-LEIDOS
           MOVE 0 TO REG-BORRADOS
           MOVE 0 TO REG-OPC1
           MOVE 0 TO REG-OPC2
           IF I = 1 MOVE 'OPC' TO TT-WS.
           IF I = 2 MOVE 'DLC' TO TT-WS.
           IF I = 3 MOVE 'RDC' TO TT-WS.
           IF I = 4 MOVE 'VEN' TO TT-WS.
           IF I = 5 MOVE 'ICG' TO TT-WS.
           IF I = 6 MOVE 'RCV' TO TT-WS.
           IF I = 7 MOVE 'CAN' TO TT-WS.
           PERFORM PROCESO-BORRADO.
       FIN-PROCESO.


       PROCESO-BORRADO.
           IF TT-WS = 'OPC'
              THEN MOVE 'OPC00' TO GEN-KEY
                   MOVE 'OPC00' TO ELEM-1
                   MOVE 'OPC'   TO GEN-TABLE
              ELSE
              IF TT-WS = 'DLC'
                 THEN MOVE 'DLC00' TO GEN-KEY
                      MOVE 'DLC00' TO ELEM-1
                      MOVE 'DLC'   TO GEN-TABLE
                 ELSE
                 IF TT-WS = 'RDC'
                    THEN MOVE 'RDC01' TO GEN-KEY
                         MOVE 'RDC00' TO ELEM-1
                         MOVE 'RDC'   TO GEN-TABLE
                    ELSE
                    IF TT-WS = 'VEN'
                       THEN MOVE 'VEN00' TO GEN-KEY
                            MOVE 'VEN00' TO ELEM-1
                            MOVE 'VEN'   TO GEN-TABLE
                       ELSE
                       IF TT-WS = 'ICG'
                          THEN MOVE 'ICG00' TO GEN-KEY
                               MOVE 'ICG00' TO ELEM-1
                               MOVE 'ICG'   TO GEN-TABLE
                          ELSE
                          IF TT-WS = 'RCV'
                             THEN MOVE 'RCV00' TO GEN-KEY
                                  MOVE 'RCV00' TO ELEM-1
                                  MOVE 'RCV'   TO GEN-TABLE
                             ELSE
                             IF TT-WS = 'CAN'
                                THEN MOVE 'CAN00' TO GEN-KEY
                                     MOVE 'CAN00' TO ELEM-1
                                     MOVE 'CAN'   TO GEN-TABLE
                                ELSE NEXT SENTENCE.


           MOVE CAMPO-WS             TO GEN-VALUE
      *    IF TT-WS = 'RDC' MOVE SPACES TO GEN-VALUE.
           MOVE SPACES TO SW-OPC.
                  DISPLAY '**********************************'
           MOVE 'LOCKY'                   TO GEN-COMMAND
           CALL 'DBNTRY' USING UIB REQ-AREA-GEN R-AUX ELEM-LIST-GEN
           IF GEN-RET-COD = SPACES
              THEN
               MOVE 'REDLE'                   TO GEN-COMMAND
               CALL 'DBNTRY' USING UIB REQ-AREA-GEN R-AUX ELEM-LIST-GEN
               IF GEN-RET-COD NOT = SPACES
                  THEN DISPLAY 'ERROR EN REDLE :' GEN-RET-COD
                       GOBACK
                  ELSE PERFORM MOVER
                       ADD 1 TO REG-LEIDOS
                  IF TA-AUX = TA-WS
                     THEN
                      MOVE VAR-AUX9           TO GEN-VALUE
                      MOVE 'RDUKY'            TO GEN-COMMAND
                      CALL 'DBNTRY' USING UIB REQ-AREA-GEN R-AUX
                           ELEM-LIST-GEN
                      IF GEN-RET-COD NOT = SPACES
                         THEN
                          DISPLAY 'ERROR EN RDUKY:' GEN-RET-COD
                          MOVE 'FIN' TO SW-OPC
                          MOVE 'RELES' TO GEN-COMMAND
                          CALL 'DBNTRY' USING UIB REQ-AREA-GEN
                          GOBACK
                         ELSE
                          MOVE 'DELET'           TO GEN-COMMAND
                          CALL 'DBNTRY' USING UIB REQ-AREA-GEN R-AUX
                               ELEM-LIST-GEN
                          IF GEN-RET-COD  = SPACES
                             THEN
                              DISPLAY 'BORRO OK'
                              ADD 1 TO REG-BORRADOS
                             ELSE
                              DISPLAY 'NO BORRO REG OPC ENCONTRADO:'
                              GEN-RET-COD
                              MOVE 'RELES' TO GEN-COMMAND
                              CALL 'DBNTRY' USING UIB REQ-AREA-GEN
                              GOBACK
                     ELSE
                      DISPLAY ' 1ER REG NO ES TIPO :' TA-WS
                      DISPLAY 'PROCESO CONTINUA'

              ELSE DISPLAY 'ERROR EN LOCKY :' GEN-RET-COD
                   MOVE 'FIN' TO SW-OPC.




             PERFORM BORRAGEN UNTIL SW-OPC = 'FIN'.
                  DISPLAY 'TIPO TABLA :' TT-WS
                  DISPLAY 'TIPO ARCHIVO :' TA-WS
                  DISPLAY 'BASE DATOS   :' BDATO-WS
                  DISPLAY 'REG LEIDOS:' REG-LEIDOS
                  DISPLAY 'REG BORRADOS' REG-BORRADOS
                  DISPLAY 'REG GEN1    ' REG-OPC1
                  DISPLAY 'REG GEN2    ' REG-OPC2.
       BORRAGEN.
      ******************************************************
           MOVE 'RDUNX'                   TO GEN-COMMAND
           CALL 'DBNTRY' USING UIB REQ-AREA-GEN R-AUX ELEM-LIST-GEN.
           IF GEN-RET-COD NOT = SPACES
                 THEN
                  DISPLAY 'ERROR EN RDUNX:' GEN-RET-COD
                  MOVE 'FIN' TO SW-OPC
                        MOVE 'RELES' TO GEN-COMMAND
                        CALL 'DBNTRY' USING UIB REQ-AREA-GEN

                 ELSE ADD 1 TO REG-LEIDOS
                      PERFORM MOVER
                  IF TA-AUX = TA-WS
                     THEN
      *               DISPLAY 'DLC:' DLC
                      MOVE 'DELET'           TO GEN-COMMAND
                      CALL 'DBNTRY' USING UIB REQ-AREA-GEN R-AUX
                          ELEM-LIST-GEN
                      IF GEN-RET-COD  = SPACES
                         THEN
      *                   DISPLAY 'BORRO OK'
                          ADD 1 TO REG-BORRADOS
      *                   IF REG-BORRADOS > 2
      *                      THEN MOVE 'FIN' TO SW-OPC
      *                      ELSE NEXT SENTENCE
                         ELSE
                          DISPLAY 'NO BORRO REG OPC ENCONTRADO:'
                          GEN-RET-COD
                          MOVE 'FIN' TO SW-OPC
                     ELSE
                      ADD 1 TO REG-OPC2
                      MOVE 'RELES' TO GEN-COMMAND
                      CALL 'DBNTRY' USING UIB REQ-AREA-GEN
      *               IF TT-WS = 'RDC'
      *                  THEN
      *                   NEXT SENTENCE
      *                  ELSE
                          MOVE 'FIN' TO SW-OPC.
       FIN-BORRADO.
       MOVER.
           IF TT-WS = 'OPC'
              THEN MOVE R-AUX   TO OPC
                   MOVE OPC-CAI-IOPC TO VAR-AUX
                      MOVE SPACES TO VAR-AUX9
                   MOVE OPC-KEY-IOPC TO VAR-AUX9
              ELSE
              IF TT-WS = 'DLC'
                 THEN MOVE R-AUX   TO DLC
                      MOVE DLC-CAI-IOPC TO VAR-AUX
                      MOVE SPACES TO VAR-AUX9
                      MOVE DLC-KEY-IDLC TO VAR-AUX9
                 ELSE
                 IF TT-WS = 'RDC'
                    THEN MOVE R-AUX   TO RDC
                         MOVE RDC-CAI-IOPC TO VAR-AUX
                         MOVE SPACES TO VAR-AUX9
                         MOVE RDC-KEY-IDLC TO VAR-AUX9
                    ELSE
                    IF TT-WS = 'VEN'
                       THEN MOVE R-AUX   TO VEN
                            MOVE VEN-CAI-IOPC TO VAR-AUX
                            MOVE SPACES TO VAR-AUX9
                            MOVE VEN-KEY-IVEN TO VAR-AUX9
                       ELSE
                       IF TT-WS = 'ICG'
                          THEN MOVE R-AUX   TO ICG
                               MOVE ICG-CAI-IOPC TO VAR-AUX
                               MOVE SPACES TO VAR-AUX9
                               MOVE ICG-KEY-IICG TO VAR-AUX9
                          ELSE
                          IF TT-WS = 'RCV'
                             THEN MOVE R-AUX   TO RCV
                                  MOVE RCV-CAI-IOPC TO VAR-AUX
                                  MOVE SPACES TO VAR-AUX9
                                  MOVE RCV-KEY-IRCV TO VAR-AUX9
                             ELSE
                             IF TT-WS = 'CAN'
                                THEN MOVE R-AUX   TO CAN
                                     MOVE CAN-CAI-IOPC TO VAR-AUX
                                     MOVE SPACES TO VAR-AUX9
                                     MOVE CAN-KEY-ICAN TO VAR-AUX9
                                ELSE NEXT SENTENCE.

           IF VAR-AUX = '0400'
              THEN
               MOVE VAR-AUX TO TA-AUX
              ELSE
               MOVE VAR-AUX TO TA-WS9
               MOVE SPACES  TO TA-AUX
               MOVE TA1-WS9 TO TA1-AUX.



       FIN-MOVER.
