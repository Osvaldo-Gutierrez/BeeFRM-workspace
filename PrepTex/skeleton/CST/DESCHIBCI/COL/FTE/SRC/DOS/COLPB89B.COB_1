       IDENTIFICATION DIVISION.
      *************************
       PROGRAM-ID.     COLPB89B.
      *AUTHOR.         K. CERPA J.
      *DATE-WRITTEN    17/05/1999.
      ******************************************************************
      *  Sistema  : Colocaciones                                       *
      *  Subsist. :                                                    *
      *  Objetivo : Genera archivos para ser enviados a Sistemas       *
      *             Cobranzas de Excel en Unix.                        *
      *                                                                *
      *  ARCHIVOS :                                                    *
      *   ENTRADA : COLSOPC: Archivo Secuencial extraido desde         *
      *                      archivo COLS890.                          *
      *             COLSDBC: Archivo Secuencial extraido desde         *
      *                      archivo COLS890.                          *
      *             ICG 160: Tabla de interes comisiones y gastos      *
      *             RCD 100: Relacion cliente direccion                *
      *             CAM 100: Registros de valores de cambios           *
      *             TAB 150: Tablas                                    *
      *             TXC 150:                                           *
      *                                                                *
      *   Salida  : CUOTAS : Archivo Secuencial                        *
      *             OPERAC : Archivo Secuencial                        *
      *             DIRECC : Archivo Secuencial                        *
      *             TELEFO : Archivo Secuencial                        *
      *                                                                *
      *  Mantenciones                                                  *
      *  ============                                                  *
      *            PROGRAMADOR:                                        *
      *            FECHA      :   /  /                                 *
      *            CAMBIO     :                                        *
      *                                                                *
      ******************************************************************
       ENVIRONMENT DIVISION.
      *--------------------*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
           EJECT
       INPUT-OUTPUT SECTION.
      *--------------------*
       FILE-CONTROL.
      *------------*
           SELECT COLSOPC     ASSIGN       TO COLSOPC
                              FILE STATUS  IS WR-FS-COLSOPC.
           SELECT COLSDBC     ASSIGN       TO COLSDBC
                              FILE STATUS  IS WR-FS-COLSDBC.
           SELECT CUOTAS      ASSIGN       TO CUOTAS
                              FILE STATUS  IS WR-FS-CUOTAS.
           SELECT OPERAC      ASSIGN       TO OPERAC
                              FILE STATUS  IS WR-FS-OPERAC.
           SELECT DIRECC      ASSIGN       TO DIRECC
                              FILE STATUS  IS WR-FS-DIRECC.
           SELECT TELEFO      ASSIGN       TO TELEFO
                              FILE STATUS  IS WR-FS-TELEFO.

       DATA DIVISION.
      *-------------*
       FILE SECTION.
      *------------*
       FD  COLSOPC
           LABEL RECORD IS STANDARD
           BLOCK CONTAINS 0 RECORDS.
       01  REG-COLSOPC.
           05 SD-CIC-IOPC               PIC X(12).
           05 SD-NUM-IVEN               PIC 9(03).
           05 SD-NUM-IVCT               PIC 9(03).
           05 SD-VAL-SFIN               PIC 9(11)V9(04).
           05 SD-FEC-FVEN.
              10 SD-NUM-SVEN            PIC 9(02).
              10 SD-NUM-AVEN            PIC 9(02).
              10 SD-NUM-MVEN            PIC 9(02).
              10 SD-NUM-DVEN            PIC 9(02).
           05 SD-OPC-COD-VCOC           PIC X(06).
           05 SD-OPC-COD-COOC.
              10 SD-OPC-COD-TOOC        PIC X(03).
              10 SD-OPC-COD-AOOC        PIC X(03).
           05 SD-OPC-COD-OFOC           PIC X(03).
           05 SD-OPC-CIC-IOPC           PIC X(12).
           05 SD-OPC-FEC-FCOL           PIC X(08).
           05 SD-OPC-VAL-SCRE           PIC S9(11)V9(04).
           05 SD-OPC-VAL-CRED           PIC S9(11)V9(04).
           05 SD-OPC-NUM-VCOR           PIC 9(03).
           05 SD-OPC-NUM-TVCC           PIC 9(03).
           05 SD-OPC-NUM-IVEN           PIC 9(03).
           05 SD-OPC-NUM-VCVG           PIC 9(03).
           05 SD-OPC-COD-RMOC           PIC X(12).
           05 SD-DLC-COD-PLZO           PIC X(02).
           05 SD-DLC-FEC-FMAV           PIC X(08).

       FD  COLSDBC
           LABEL RECORD IS STANDARD
           BLOCK CONTAINS 0 RECORDS.
       01  REG-COLSDBC.
           05 SD-CIC-ICLI               PIC X(12).
           05 SD-DBC-NUM-ICLI           PIC 9(09).
           05 SD-DBC-VRF-ICLI           PIC X(01).

       FD  CUOTAS
           RECORD CONTAINS 117 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.
       01  REG-CUOTAS.
           05 CUO-NUM-OPE           PIC X(12).
           05 CUO-FILLER1           PIC X(01) VALUE '%'.
           05 CUO-NUM-CUO           PIC 9(03).
           05 CUO-FILLER2           PIC X(01) VALUE '%'.
           05 CUO-FILLER3           PIC X(01) VALUE '$'.
           05 CUO-MON-ORI           PIC 9(11).9(04).
           05 CUO-FILLER4           PIC X(01) VALUE '%'.
           05 CUO-FEC-VCT           PIC X(08).
           05 CUO-FILLER5           PIC X(01) VALUE '%'.
           05 CUO-FILLER6           PIC X(01) VALUE '$'.
           05 CUO-INT-MOR           PIC 9(11).9(04).
           05 CUO-FILLER7           PIC X(01) VALUE '%'.
           05 CUO-FILLER8           PIC X(01) VALUE '$'.
           05 CUO-MON-TOT           PIC 9(11).9(04).
           05 CUO-FILLER9           PIC X(01) VALUE '%'.
           05 CUO-FILLER10          PIC X(01) VALUE '%'.
           05 CUO-FILLER11          PIC X(01) VALUE '$'.
           05 CUO-TAS-PER           PIC 9(11).9(04).
           05 CUO-FILLER12          PIC X(01) VALUE '%'.
           05 CUO-FILLER13          PIC X(01) VALUE '$'.
           05 CUO-TAS-INC           PIC 9(11).9(04).
           05 CUO-FILLER14          PIC X(01) VALUE '%'.

       FD  OPERAC
           RECORD CONTAINS 203 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.
       01  REG-OPERAC.
           05 OPE-COD-PRO           PIC X(06).
           05 OPE-FILLER1           PIC X(01) VALUE '%'.
           05 OPE-COD-SUC           PIC X(03).
           05 OPE-FILLER2           PIC X(01) VALUE '%'.
           05 OPE-NUM-OPE           PIC X(12).
           05 OPE-FILLER3           PIC X(01) VALUE '%'.
           05 OPE-COD-MON           PIC X(06).
           05 OPE-FILLER4           PIC X(01) VALUE '%'.
           05 OPE-FILLER5           PIC X(01) VALUE '$'.
           05 OPE-MON-CRE           PIC 9(11).9(04).
           05 OPE-FILLER6           PIC X(01) VALUE '%'.
           05 OPE-FEC-CUR           PIC X(08).
           05 OPE-FILLER7           PIC X(01) VALUE '%'.
           05 OPE-FILLER8           PIC X(01) VALUE '$'.
           05 OPE-MON-SAL           PIC 9(11).9(04).
           05 OPE-FILLER9           PIC X(01) VALUE '%'.
           05 OPE-NUM-CUO           PIC 9(03).
           05 OPE-FILLER10          PIC X(01) VALUE '%'.
           05 OPE-FEC-VCT           PIC X(08).
           05 OPE-FILLER11          PIC X(01) VALUE '%'.
           05 OPE-NUM-REN           PIC 9(03).
           05 OPE-FILLER12          PIC X(01) VALUE '%'.
           05 OPE-TAS-PAC           PIC  9(03).9(4).
           05 OPE-FILLER13          PIC X(01) VALUE '%'.
           05 OPE-TAS-MOR           PIC  9(03).9(4).
           05 OPE-FILLER14          PIC X(01) VALUE '%'.
           05 OPE-FILLER15          PIC X(01) VALUE '$'.
           05 OPE-MON-MOR           PIC 9(11).9(4).
           05 OPE-FILLER16          PIC X(01) VALUE '%'.
           05 OPE-FILLER17          PIC X(01) VALUE '$'.
           05 OPE-CUP-NAC           PIC 9(11).9(4).
           05 OPE-FILLER18          PIC X(01) VALUE '%'.
           05 OPE-FILLER19          PIC X(01) VALUE '$'.
           05 OPE-CUP-INT           PIC 9(11).9(4).
           05 OPE-FILLER20          PIC X(01) VALUE '%'.
           05 OPE-PRI-CUO           PIC 9(03).
           05 OPE-FILLER21          PIC X(01) VALUE '%'.
           05 OPE-CUO-IMP           PIC 9(03).
           05 OPE-FILLER22          PIC X(01) VALUE '%'.
           05 OPE-CUO-MOR           PIC 9(03).
           05 OPE-FILLER23          PIC X(01) VALUE '%'.
           05 OPE-COD-EST           PIC X(03).
           05 OPE-FILLER24          PIC X(01) VALUE '%'.
           05 OPE-COD-TCRE          PIC X(06).
           05 OPE-FILLER25          PIC X(01) VALUE '%'.
           05 OPE-COD-PLZO          PIC X(02).
           05 OPE-FILLER26          PIC X(01) VALUE '%'.
           05 OPE-COD-EJEC          PIC X(12).

       FD  DIRECC
           RECORD CONTAINS 274 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.
       01  REG-DIRECC.
           05 DIR-NUM-RUT           PIC 9(09).
           05 DIR-FILLER1           PIC X(01) VALUE '%'.
           05 DIR-DVF-RUT           PIC X(01).
           05 DIR-FILLER2           PIC X(01) VALUE '%'.
           05 DIR-COR-DIR           PIC 9(01).
           05 DIR-FILLER3           PIC X(01) VALUE '%'.
           05 DIR-COD-TDI           PIC X(25).
           05 DIR-FILLER4           PIC X(01) VALUE '%'.
           05 DIR-NOM-CAL           PIC X(40).
           05 DIR-FILLER5           PIC X(01) VALUE '%'.
           05 DIR-NUM-CAL           PIC X(06).
           05 DIR-FILLER6           PIC X(01) VALUE '%'.
           05 DIR-NOM-LUG           PIC X(40).
           05 DIR-FILLER7           PIC X(01) VALUE '%'.
           05 DIR-NUM-LUG           PIC X(06).
           05 DIR-FILLER8           PIC X(01) VALUE '%'.
           05 DIR-IND-CON           PIC 9(01).
           05 DIR-FILLER9           PIC X(01) VALUE '%'.
           05 DIR-NOM-CON           PIC X(40).
           05 DIR-FILLER10          PIC X(01) VALUE '%'.
           05 DIR-NOM-SEC           PIC X(40).
           05 DIR-FILLER11          PIC X(01) VALUE '%'.
           05 DIR-COD-COM           PIC X(25).
           05 DIR-FILLER12          PIC X(01) VALUE '%'.
           05 DIR-COD-CIU           PIC X(25).
           05 DIR-FILLER13          PIC X(01) VALUE '%'.
           05 DIR-COD-REG           PIC X(02).

       FD  TELEFO
           RECORD CONTAINS 52 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.
       01  REG-TELEFO.
           05 TEL-NUM-RUT           PIC 9(09).
           05 TEL-FILLER1           PIC X(01) VALUE '%'.
           05 TEL-DVF-RUT           PIC X(01).
           05 TEL-FILLER2           PIC X(01) VALUE '%'.
           05 TEL-COR-TEL           PIC 9(02).
           05 TEL-FILLER3           PIC X(01) VALUE '%'.
           05 TEL-COD-TTE           PIC X(25).
           05 TEL-FILLER4           PIC X(01) VALUE '%'.
           05 TEL-NUM-TEL           PIC X(11).

       WORKING-STORAGE SECTION.
      *-----------------------*
       77  WS-CIC-IOPC                  PIC X(12) VALUE SPACES.
       77  WS-INT-MORA-UF               PIC S9(11)V9(04) VALUE 0.
       77  WS-INT-MORA-PE               PIC S9(11)       VALUE 0.
       77  WS-TOT-CUOTA                 PIC S9(11)V9(04) VALUE 0.
       77  WS-CUO-TAS-PER               PIC S9(11)V9(04) VALUE 0.
       77  WS-CUO-TAS-INC               PIC S9(11)V9(04) VALUE 0.
       77  WS-TASA-MORA-PROM            PIC S9(05)V9(10) VALUE 0.
       77  WS-MONTO-TOT-MORA            PIC S9(11)V9(04) VALUE 0.
       77  WS-MONTO-TOT-PE              PIC S9(11)       VALUE 0.
       77  WS-PRIM-CUO-IMPA             PIC  9(03)       VALUE 0.
       77  WS-NUM-CUO-MOR               PIC  9(03)       VALUE 0.
       77  WR-CAM-SGV-VCAM              PIC S9(11)V9(04) VALUE +0.
       77  WR-MTO-UF                    PIC S9(11)V9(04) VALUE +0.
       77  WS-RCD-NUM-FONO              PIC  X(08) VALUE SPACES.
       77  WS-RCD-NUM-DIRE              PIC  9(02) VALUE 0.
       77  WS-RCD-MSC-TDIR              PIC  X(01) VALUE SPACES.
       77  WS-RCD-GLS-DIRE              PIC  X(60) VALUE SPACES.
       77  WS-RCD-COD-LUGA              PIC  X(04) VALUE SPACES.
       77  WS-OPC-COD-VCOC              PIC  X(06) VALUE SPACES.
       77  WS-OPC-COD-OFOC              PIC  X(03) VALUE SPACES.
       77  WS-OPC-CIC-IOPC              PIC  X(12) VALUE SPACES.
       77  WS-OPC-FEC-FCOL              PIC  X(08) VALUE SPACES.
       77  WS-OPC-VAL-SCRE              PIC S9(11)V9(04) VALUE 0.
       77  WS-OPC-VAL-CRED              PIC S9(11)V9(04) VALUE 0.
       77  WS-OPC-NUM-VCOR              PIC  9(03) VALUE 0.
       77  WS-OPC-NUM-TVCC              PIC  9(03) VALUE 0.
       77  WS-OPC-NUM-IVEN              PIC  9(03) VALUE 0.
       77  WS-OPC-NUM-VCVG              PIC  9(03) VALUE 0.
       77  WS-OPC-COD-RMOC              PIC  X(12) VALUE SPACES.
       77  WS-DLC-COD-PLZO              PIC  X(02) VALUE SPACES.
       77  WS-DLC-FEC-FMAV              PIC  X(08) VALUE SPACES.

       01  WS-OPC-COD-COOC.
           05 WS-OPC-COD-TOOC           PIC  X(03) VALUE SPACES.
           05 WS-OPC-COD-AOOC           PIC  X(03) VALUE SPACES.

       01  W-SWITCHES.
           05 WS-PROCESO                    PIC 9(01) VALUE 0.
              88 WS-PROCESO-OK       VALUE 0.
              88 WS-PROCESO-ERROR    VALUE 1.
           05 WS-FIN-OPC                    PIC 9(01) VALUE 0.
              88 WS-FIN-OPC-NO       VALUE 0.
              88 WS-FIN-OPC-SI       VALUE 1.
           05 WS-FIN-DBC                    PIC 9(01) VALUE 0.
              88 WS-FIN-DBC-NO       VALUE 0.
              88 WS-FIN-DBC-SI       VALUE 1.
           05 WS-ICG                        PIC X(15) VALUE SPACES.

       01  W-CONTADORES-Y-ACUMULADORES.
           05 WA-L-OPC                      PIC 9(06) VALUE 0.
           05 WA-L-DBC                      PIC 9(06) VALUE 0.
           05 WA-L-RCD                      PIC 9(06) VALUE 0.
           05 WA-N-RCD                      PIC 9(06) VALUE 0.
           05 WA-L-TAB                      PIC 9(06) VALUE 0.
           05 WA-N-TAB                      PIC 9(06) VALUE 0.
           05 WA-L-CAM                      PIC 9(06) VALUE 0.
           05 WA-N-CAM                      PIC 9(06) VALUE 0.
           05 WA-L-ICG                      PIC 9(06) VALUE 0.
           05 WA-N-ICG                      PIC 9(06) VALUE 0.
           05 WA-L-TXC                      PIC 9(06) VALUE 0.
           05 WA-N-TXC                      PIC 9(06) VALUE 0.
           05 WA-G-MOR                      PIC 9(06) VALUE 0.
           05 WA-G-OPE                      PIC 9(06) VALUE 0.
           05 WA-G-DIR                      PIC 9(06) VALUE 0.
           05 WA-G-TEL                      PIC 9(06) VALUE 0.

       01  W-REGISTROS-DE-TRABAJO.
           05 WR-FS-COLSOPC                PIC 9(02) VALUE 0.
           05 WR-FS-COLSDBC                PIC 9(02) VALUE 0.
           05 WR-FS-CUOTAS                 PIC 9(02) VALUE 0.
           05 WR-FS-OPERAC                 PIC 9(02) VALUE 0.
           05 WR-FS-DIRECC                 PIC 9(02) VALUE 0.
           05 WR-FS-TELEFO                 PIC 9(02) VALUE 0.
           05 WR-MENSAJES.
              10 WR-SECCION                PIC X(15).
              10 WR-PARRAFO                PIC X(15).
              10 WR-ARCHIVO                PIC X(10).
              10 WR-OPERACI                PIC X(10).
              10 WR-FILE-ST                PIC X(02).
              10 WR-MENSAJE                PIC X(35).

       01  W-PARAMETROS.
           05 WP-FECHA-PRO.
              10 WP-DIA-PRO                 PIC X(02).
              10 WP-MES-PRO                 PIC X(02).
              10 WP-ANO-PRO                 PIC X(04).
              10 WP-ANO-PRO-RED REDEFINES WP-ANO-PRO.
                 15 WP-SIG-PRO-R            PIC X(02).
                 15 WP-ANO-PRO-R            PIC X(02).

       COPY RTNWCALE.
       COPY TABWGTXC.
      ******************************************************************
      *      AREAS DE USO PARA DATACOM                                 *
      ******************************************************************
      *
       01  WB-UIB.
           05 FILLER                        PIC X(32) VALUE 'COLPB89B'.
      *
       01  WB-REQ-CAM-AREA.
           02 WB-REQ-CAM-CMD                PIC X(5) VALUE 'REDKX'.
           02 FILLER                        PIC X(3) VALUE 'CAM'.
           02 FILLER                        PIC X(5) VALUE 'CAM00'.
           02 WB-REQ-CAM-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +150.
           02 FILLER                        PIC X(58).
           02 WB-REQ-CAM-KEY-VALUE.
              03 WB-REQ-CAM-KEY-FE1         PIC 9(08).
              03 WB-REQ-CAM-KEY-FE2         PIC 9(08).
              03 WB-REQ-CAM-KEY-COD1        PIC X(06).
              03 WB-REQ-CAM-KEY-COD2        PIC X(06).

       01  WB-REQ-TAB-AREA.
           02 WB-REQ-TAB-CMD                PIC X(5) VALUE 'REDKX'.
           02 FILLER                        PIC X(3) VALUE 'TAB'.
           02 FILLER                        PIC X(5) VALUE 'TAB00'.
           02 WB-REQ-TAB-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +150.
           02 FILLER                        PIC X(58).
           02 WB-REQ-TAB-KEY-VALUE.
              03 WB-REQ-TAB-KEY-TIP         PIC X(03) VALUE 'COM'.
              03 WB-REQ-TAB-KEY-COD         PIC X(03).
              03 WB-REQ-TAB-KEY-RESTO       PIC X(12) VALUE SPACES.

       01  WB-REQ-RCD-AREA.
           02 WB-REQ-RCD-CMD                PIC X(5) VALUE 'REDKX'.
           02 FILLER                        PIC X(3) VALUE 'RCD'.
           02 FILLER                        PIC X(5) VALUE 'RCD00'.
           02 WB-REQ-RCD-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-RCD-KEY-VALUE.
              03 WB-REQ-RCD-KEY-CLI         PIC X(12).
              03 WB-REQ-RCD-KEY-DIR         PIC X(02).

       01  WB-REQ-ICG-AREA.
           02 WB-REQ-ICG-CMD                PIC X(5) VALUE SPACES.
           02 FILLER                        PIC X(3) VALUE 'ICG'.
           02 FILLER                        PIC X(5) VALUE 'ICG00'.
           02 WB-REQ-ICG-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-ICG-KEY-VALUE          PIC X(45).

       01  REG-CAM.
      *    COPYDD TAB-R-CAM.TAB-E-CAM00(PROD),01,D.
      *                             EQUIVALENTE AL REGISTRO CAM
           02  TAB-E-CAM00.
      *                             REGISTRO DE VALORES DE CAMBIOS
               03  CAM.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CAM-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  CAM-KEY-IREG.
      *                             KEY     FECHA 1 + FECHA 2 + VALOR 1
                       05  CAM-KEY-CAMB.
      *                             FECHA DE CAMBIO
                       06  CAM-FEC-CAMB.
      *                             FECHA 1 + FECHA 2
                       07  CAM-FEC-FCAM
                                        OCCURS 2 TIMES.
                       08  CAM-NUM-SCAM
                                    PICTURE 9(2).
                       08  CAM-NUM-ACAM
                                    PICTURE 9(2).
                       08  CAM-NUM-MCAM
                                    PICTURE 9(2).
                       08  CAM-NUM-DCAM
                                    PICTURE 9(2).
      *                             CODIGO VALOR DE CAMBIO
                       06  CAM-COD-CAMB.
      *                             VALOR 1 + VALOR 2
                       07  CAM-COD-VCAM
                                        OCCURS 2 TIMES.
      *                             TIPO VALOR                   TAB TVA
                       08  CAM-MSC-TVAL
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       08  CAM-COD-CVAL
                                    PICTURE X(3).
      *                             TIPO CAMBIO
                       08  CAM-COD-TCAM
                                    PICTURE X(2).
      *                             TIME STAMP TRANSACCION
                       05  CAM-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CAM-FEC-FTRN.
                       07  CAM-NUM-STRN
                                    PICTURE 9(2).
                       07  CAM-NUM-ATRN
                                    PICTURE 9(2).
                       07  CAM-NUM-MTRN
                                    PICTURE 9(2).
                       07  CAM-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CAM-HRA-HRTR.
                       07  CAM-NUM-HHTR
                                    PICTURE 9(2).
                       07  CAM-NUM-MMTR
                                    PICTURE 9(2).
                       07  CAM-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  CAM-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CAM-MSC-STAT PICTURE X(1).
      *                             INDICADOR VIGENCIA
                   04  CAM-IND-VIGE
                             REDEFINES CAM-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  CAM-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CAM-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CAM-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  CAM-COD-ATRN PICTURE X(12).
      *                             VALOR DE CAMBIO
                   04  CAM-SGV-VCAM PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             DISPONIBLE
                   04  CAM-GLS-DISP PICTURE X(6).
       01  REG-ICG.
      *    COPYDD COL-R-ICG.COL-E-ICG00(PROD),01,D.
      *                             EQUIVALENTE AL REGISTRO ICG
           02  COL-E-ICG00.
      *                             INTERES COMISIONES GASTOS
               03  ICG.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  ICG-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  ICG-KEY-IREG.
      *                             KEY     IDENTIFICACION TASAS
                       05  ICG-KEY-IICG.
      *                             IDENTIFICACION CANCELACION
                       06  ICG-KEY-ICAN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  ICG-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  ICG-CAI-IOPC.
                       09  ICG-COD-TOPC
                                    PICTURE X(1).
                       09  ICG-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  ICG-IIC-IOPC.
                       09  ICG-COD-OOPC.
                       10  ICG-COD-SOPC
                                    PICTURE X(2).
                       10  ICG-IND-SOPC
                                    PICTURE X(1).
                       09  ICG-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENT. CANCELACION
                       07  ICG-NUM-ICAN
                                    PICTURE 9(3).
      *                             IDENTIFICACION VENCIMIENTO
                       06  ICG-KEY-IVCT.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  ICG-CIC-IOPV.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  ICG-CAI-IOPV.
                       09  ICG-COD-TOPV
                                    PICTURE X(1).
                       09  ICG-COD-COPV
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  ICG-IIC-IOPV.
                       09  ICG-COD-OOPV.
                       10  ICG-COD-SOPV
                                    PICTURE X(2).
                       10  ICG-IND-SOPV
                                    PICTURE X(1).
                       09  ICG-GLS-NOPV
                                    PICTURE X(5).
      *                             NUM IDENT. VENCIMIENTO
                       07  ICG-NUM-IVCT
                                    PICTURE 9(3).
      *                             TIPO TASA
                       06  ICG-IND-TTAS
                                    PICTURE X(3).
      *                             FECHA INICIO VIGENCIA TASA
                       06  ICG-FEC-FINI.
                       07  ICG-NUM-SINI
                                    PICTURE 9(2).
                       07  ICG-NUM-AINI
                                    PICTURE 9(2).
                       07  ICG-NUM-MINI
                                    PICTURE 9(2).
                       07  ICG-NUM-DINI
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  ICG-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  ICG-FEC-FTRN.
                       07  ICG-NUM-STRN
                                    PICTURE 9(2).
                       07  ICG-NUM-ATRN
                                    PICTURE 9(2).
                       07  ICG-NUM-MTRN
                                    PICTURE 9(2).
                       07  ICG-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  ICG-HRA-HRTR.
                       07  ICG-NUM-HHTR
                                    PICTURE 9(2).
                       07  ICG-NUM-MMTR
                                    PICTURE 9(2).
                       07  ICG-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  ICG-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  ICG-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  ICG-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  ICG-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  ICG-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  ICG-COD-ATRN PICTURE X(12).
      *                             REQ CODIGO TIPO TASA INTERES
                   04  ICG-COD-TINT.
      *                             CODIGO TIPO TASA
                       05  ICG-COD-TIPT.
      *                             BASE CALCULO TASA INTERES
                       06  ICG-MSC-BCTI
                                    PICTURE X(1).
      *                             PERIODO BASE TASA INTERES
                       06  ICG-MSC-PBTI
                                    PICTURE X(1).
      *                             MODALIDAD CALCULO TASA INTERES
                       06  ICG-MSC-MCTI.
      *                             BAJO PERIODO BASE TASA           COL
                       07  ICG-MSC-BPBT
                                    PICTURE X(1).
      *                             SOBRE PERIODO BASE TASA          COL
                       07  ICG-MSC-SPBT
                                    PICTURE X(1).
      *                             CODIGO VALOR TASA INTERES
                       05  ICG-COD-CVTI
                                    PICTURE X(3).
      *                             TIPO FECHA PERIODO REPACTO
                       05  ICG-MSC-TFPR
                                    PICTURE X(1).
      *                             NUMERO PERIODO REPACTO
                       05  ICG-NUM-PREP
                                    PICTURE 9(3).
      *                             UNIDAD TIEMPO PERIODO REPACTO
                       05  ICG-MSC-UTPR
                                    PICTURE X(1).
      *                             FECHA TERMINO VIGENCIA TASA
                   04  ICG-FEC-FTER.
                       05  ICG-NUM-STER
                                    PICTURE 9(2).
                       05  ICG-NUM-ATER
                                    PICTURE 9(2).
                       05  ICG-NUM-MTER
                                    PICTURE 9(2).
                       05  ICG-NUM-DTER
                                    PICTURE 9(2).
      *                             REQ VALOR SPREAD
                   04  ICG-SGV-SPRD PICTURE S9(3)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR TASA
                   04  ICG-SGV-TINT PICTURE S9(3)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR EN MONTO
                   04  ICG-SGV-MNTO PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             GLOSA DISPONIBLE
                   04  ICG-GLS-DISP PICTURE X(7).
       01  REG-RCD.
      *    COPYDD DGC-R-RCD.DGC-E-RCD00(PROD),01,D.
      *                             EQUIVALENTE AL REGISTRO RCD
           02  DGC-E-RCD00.
      *                             RELACION CLIENTE DIRECCIONES
               03  RCD.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RCD-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  RCD-KEY-IREG.
      *                             IDENTIFICACION RELACION CLIENTE DIRE
                       05  RCD-KEY-IRCD.
      *                             COD. INT. COMP. CLIENTE
                       06  RCD-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RCD-CAI-ICLI.
                       08  RCD-COD-TCLI
                                    PICTURE X(1).
                       08  RCD-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RCD-IIC-ICLI
                                    PICTURE X(8).
      *                             NUMERO DIRECCION
                       06  RCD-NUM-DIRE
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  RCD-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RCD-FEC-FTRN.
                       07  RCD-NUM-STRN
                                    PICTURE 9(2).
                       07  RCD-NUM-ATRN
                                    PICTURE 9(2).
                       07  RCD-NUM-MTRN
                                    PICTURE 9(2).
                       07  RCD-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RCD-HRA-HRTR.
                       07  RCD-NUM-HHTR
                                    PICTURE 9(2).
                       07  RCD-NUM-MMTR
                                    PICTURE 9(2).
                       07  RCD-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  RCD-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RCD-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  RCD-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RCD-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RCD-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  RCD-COD-ATRN PICTURE X(12).
      *                             TIPO DIRECCION
                   04  RCD-MSC-TDIR PICTURE X(1).
      *                             ESTADO DIRECCION ( MALA, VERIFICADA,
                   04  RCD-MSC-SDIR PICTURE X(1).
      *                             FECHA DE VERIFICACION
                   04  RCD-FEC-FVRF.
                       05  RCD-NUM-SVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-AVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-MVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-DVRF
                                    PICTURE 9(2).
      *                             RCM DESCRIPCION DE LA DIRECCION
                   04  RCD-GLS-DIRE PICTURE X(60).
      *                             RCM CODIGO DE LUGAR
                   04  RCD-COD-LUGA PICTURE X(4).
      *                             TELEFONO DE LA DIRECCION
                   04  RCD-GLS-FONO.
                       05  RCD-NUM-FONO
                                    PICTURE X(8).
                       05  RCD-NUM-ANXO
                                    PICTURE X(4).
      *                             CODIGO POSTAL
                   04  RCD-COD-POST PICTURE X(7).
      *                             DISPONIBLE
                   04  RCD-GLS-DISP PICTURE X(18).

      *    Registro de Comunas
      *    -------------------
      *
      *    Nombre Registro : COM
      *    Clave(s)        : COM-COD-TABL(UU), COM-STP-ITRN(UU),
      *                      COM-CIC-TABL(UU), COM-EXT-TABL(UU)
      *    Largo           : 194
      *    Bloqueo         : 2
      *    Observaciones   :
      *
       01  COM.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  COM-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  COM-KEY-IREG.
      *
      *KEY     Tipo + Codigo ( LLave Primaria )
               05  COM-COD-TABL.
      *
      *            Codigo Tipo Tabla
                   07  COM-COD-TTAB                     PIC X(03).
      *
      *            Codigo Comuna
                   07  COM-COD-COMU                     PIC X(12).
      *
      *        Time Stamp Transaccion
               05  COM-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  COM-FEC-FTRN.
                       09  COM-NUM-STRN                 PIC 9(02).
                       09  COM-NUM-ATRN                 PIC 9(02).
                       09  COM-NUM-MTRN                 PIC 9(02).
                       09  COM-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  COM-HRA-HRTR.
                       09  COM-NUM-HHTR                 PIC 9(02).
                       09  COM-NUM-MMTR                 PIC 9(02).
                       09  COM-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  COM-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  COM-MSC-STAT                             PIC X(01).
      *
      *    Indicador Vigencia                           GNS VIGE
           03  COM-IND-VIGE  REDEFINES  COM-MSC-STAT    PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  COM-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  COM-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  COM-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  COM-COD-ATRN                             PIC X(12).
      *
      *KEY Tipo + Codigo ( Interno Computacional )
           03  COM-CIC-TABL.
      *
      *        Codigo Tipo Tabla
               05  COM-CIC-TTAB                         PIC X(03).
      *
      *        Codigo Comuna
               05  COM-CIC-COMU                         PIC X(12).
      *
      *    Codigo Externo
           03  COM-EXT-TABL.
      *
      *        Codigo Tipo Tabla
               05  COM-EXT-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  COM-EXT-CTAB                         PIC X(05).
      *
      *    Descripcion Corta
           03  COM-GLS-DCOR                             PIC X(12).
      *
      *    Abreviacion Descripcion
           03  COM-GLS-ABRV                             PIC X(05).
      *
      *    Descripcion del Codigo
           03  COM-GLS-DESC.
      *
      *        Descripcion Comuna
               05  COM-GLS-COMU                         PIC X(20).
      *
      *        Descripcion Ciudad
               05  COM-GLS-CIUD                         PIC X(20).
      *
      *    Discado Directo Distante
           03  COM-GLS-CDDD                             PIC X(05).
      *
      *    Codigo Postal
           03  COM-GLS-CPOS                             PIC X(10).
      *
      *    Codigo Departamento
           03  COM-COD-DPTO                             PIC X(05).
      *
      *    Codigo Provincia
           03  COM-COD-PRVC                             PIC X(02).
      *
      *    Codigo Region
           03  COM-COD-REGI                             PIC X(02).
      *
      *    Codigo Pais
           03  COM-COD-PAIS                             PIC X(03).
      *
      *    Disponible
           03  COM-GLS-DISP                             PIC X(33).
      *
      *    Clave Soundex
           03  COM-SNX-TABL.
               05  COM-SNX-TTAB                         PIC X(03).
               05  COM-SNX-COMU                         PIC X(03).
      *
       01  WB-ELEM-LIS                      PIC X(11).


       PROCEDURE DIVISION.
      *------------------*
           ENTRY 'DBMSCBL'.
           PERFORM 010-ABRIR-ARCHIVOS.
           PERFORM 020-CARGA-CALENDAR.
           IF (CALEAREA-COD-RET = 0 OR CALEAREA-FUNCION NOT = 'CANCEL')
               PERFORM 040-VALIDA-PARAMETRO
           END-IF.
           PERFORM 050-PROCESAR.
           PERFORM 200-ESTADISTICAS.
           PERFORM 210-TERMINO.

       010-ABRIR-ARCHIVOS.
      *------------------*
           OPEN INPUT  COLSOPC
                       COLSDBC
           OPEN OUTPUT CUOTAS
                       OPERAC
                       DIRECC
                       TELEFO.
           IF (WR-FS-COLSOPC NOT = 0)
               MOVE SPACES                  TO WR-SECCION
               MOVE '010-ABRIR-ARCHIVOS'    TO WR-PARRAFO
               MOVE 'COLSOPC'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-COLSOPC           TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM 190-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-COLSDBC NOT = 0)
               MOVE SPACES                  TO WR-SECCION
               MOVE '010-ABRIR-ARCHIVOS'    TO WR-PARRAFO
               MOVE 'COLSDBC'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-COLSDBC           TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM 190-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-CUOTAS NOT = 0)
               MOVE SPACES                  TO WR-SECCION
               MOVE '010-ABRIR-ARCHIVOS'    TO WR-PARRAFO
               MOVE 'CUOTAS'                TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-CUOTAS            TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM 190-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-OPERAC NOT = 0)
               MOVE SPACES                  TO WR-SECCION
               MOVE '010-ABRIR-ARCHIVOS'    TO WR-PARRAFO
               MOVE 'OPERAC'                TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-OPERAC            TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM 190-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-DIRECC NOT = 0)
               MOVE SPACES                  TO WR-SECCION
               MOVE '010-ABRIR-ARCHIVOS'    TO WR-PARRAFO
               MOVE 'DIRECC'                TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-DIRECC            TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM 190-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-TELEFO NOT = 0)
               MOVE SPACES                  TO WR-SECCION
               MOVE '010-ABRIR-ARCHIVOS'    TO WR-PARRAFO
               MOVE 'TELEFO'                TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-TELEFO            TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM 190-DISPLAY-ERROR
           END-IF.

       020-CARGA-CALENDAR.
      *-----------------*
           MOVE 'CARGAR'                    TO CALEAREA-FUNCION.
           MOVE ALL '0'                     TO CALEAREA-FECHA-1.
           PERFORM 030-CALL-RUTUCALE.

       030-CALL-RUTUCALE.
      *-----------------*
           CALL 'RUTUCALE' USING RTNWCALE.
           IF (CALEAREA-COD-RET NOT = 0 OR CALEAREA-FUNCION = 'CANCEL')
               MOVE SPACES                  TO WR-SECCION
               MOVE '030-CALL-RUTUCALE'     TO WR-PARRAFO
               MOVE 'RUTUCALE'              TO WR-ARCHIVO
               MOVE CALEAREA-FECHA-1        TO WR-OPERACI
               MOVE '*FECHA INVALIDA*'      TO WR-MENSAJE
               MOVE CALEAREA-COD-RET        TO WR-FILE-ST
               PERFORM 190-DISPLAY-ERROR
           END-IF.

       040-VALIDA-PARAMETRO.
      *--------------------*
           ACCEPT W-PARAMETROS
           MOVE WP-ANO-PRO                  TO CALEAREA-FECHA-1-A
           MOVE WP-MES-PRO                  TO CALEAREA-FECHA-1-M
           MOVE WP-DIA-PRO                  TO CALEAREA-FECHA-1-D
           MOVE 'INFO'                      TO CALEAREA-FUNCION.
           MOVE ALL '0'                     TO CALEAREA-FECHA-2.
           PERFORM 030-CALL-RUTUCALE.
           IF  CALEAREA-COD-RET = 0
               DISPLAY 'PARAMETRO : ' W-PARAMETROS
           END-IF.

       050-PROCESAR.
      *------------*
           PERFORM 060-LEER-DBC
           PERFORM 070-PROCESO-DBC UNTIL WS-FIN-DBC = 1.
           PERFORM 100-LEER-OPC
           MOVE    SD-CIC-IOPC     TO WS-CIC-IOPC
           PERFORM 110-MOVER-DATOS-OPC
           PERFORM 120-PROCESO-OPC UNTIL WS-FIN-OPC = 1
           PERFORM 170-GRABAR-OPERAC.

       060-LEER-DBC.
      *------------*
           READ COLSDBC AT END MOVE 1 TO WS-FIN-DBC.
           IF WS-FIN-DBC = 0
              ADD 1                         TO WA-L-DBC
           END-IF.

       070-PROCESO-DBC.
      *---------------*
           PERFORM 080-LEER-RCD
           MOVE SD-DBC-NUM-ICLI         TO DIR-NUM-RUT
           MOVE SD-DBC-VRF-ICLI         TO DIR-DVF-RUT
           MOVE WS-RCD-NUM-DIRE         TO DIR-COR-DIR
           MOVE WS-RCD-MSC-TDIR         TO DIR-COD-TDI
           MOVE WS-RCD-GLS-DIRE         TO DIR-NOM-CAL
           MOVE SPACES                  TO DIR-NUM-CAL
           MOVE SPACES                  TO DIR-NOM-LUG
           MOVE SPACES                  TO DIR-NUM-LUG
           MOVE ZEROES                  TO DIR-IND-CON
           MOVE SPACES                  TO DIR-NOM-CON
           MOVE SPACES                  TO DIR-NOM-SEC
           MOVE WS-RCD-COD-LUGA         TO DIR-COD-COM
           MOVE WS-RCD-COD-LUGA         TO DIR-COD-CIU
           PERFORM 090-BUSCAR-REGION
           MOVE '%'                     TO DIR-FILLER1
                DIR-FILLER2  DIR-FILLER3   DIR-FILLER4
                DIR-FILLER5  DIR-FILLER6   DIR-FILLER7
                DIR-FILLER8  DIR-FILLER9   DIR-FILLER10
                DIR-FILLER11 DIR-FILLER12  DIR-FILLER13
           WRITE REG-DIRECC
           IF WR-FS-DIRECC = 0
              ADD 1                     TO WA-G-DIR
           ELSE
              MOVE SPACES               TO WR-SECCION
              MOVE '070-PROCESO-DBC'    TO WR-PARRAFO
              MOVE 'DIRECC'             TO WR-ARCHIVO
              MOVE 'WRITE'              TO WR-OPERACI
              MOVE WR-FS-DIRECC         TO WR-FILE-ST
              MOVE SPACES               TO WR-MENSAJE
              PERFORM 190-DISPLAY-ERROR
           END-IF.
           MOVE SD-DBC-NUM-ICLI         TO TEL-NUM-RUT
           MOVE SD-DBC-VRF-ICLI         TO TEL-DVF-RUT
           MOVE WS-RCD-NUM-DIRE         TO TEL-COR-TEL
           MOVE WS-RCD-MSC-TDIR         TO TEL-COD-TTE
           MOVE WS-RCD-NUM-FONO         TO TEL-NUM-TEL
           MOVE '%'                     TO TEL-FILLER1
                TEL-FILLER2  TEL-FILLER3   TEL-FILLER4
           WRITE REG-TELEFO
           IF WR-FS-TELEFO = 0
              ADD 1                         TO WA-G-TEL
           ELSE
              MOVE SPACES                   TO WR-SECCION
              MOVE '070-PROCESO-DBC'        TO WR-PARRAFO
              MOVE 'TELEFO'                 TO WR-ARCHIVO
              MOVE 'WRITE'                  TO WR-OPERACI
              MOVE WR-FS-TELEFO             TO WR-FILE-ST
              MOVE SD-CIC-IOPC              TO WR-MENSAJE
              PERFORM 190-DISPLAY-ERROR
           END-IF.
           PERFORM 060-LEER-DBC.

       080-LEER-RCD.
      *------------*
           MOVE SD-CIC-ICLI    TO WB-REQ-RCD-KEY-CLI
           MOVE '01'           TO WB-REQ-RCD-KEY-DIR
           MOVE 'RCD00'        TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-RCD-AREA RCD WB-ELEM-LIS
           IF  WB-REQ-RCD-RC = SPACES
               ADD 1                       TO WA-L-RCD
               MOVE RCD-NUM-FONO           TO WS-RCD-NUM-FONO
               MOVE RCD-NUM-DIRE           TO WS-RCD-NUM-DIRE
               MOVE RCD-MSC-TDIR           TO WS-RCD-MSC-TDIR
               MOVE RCD-GLS-DIRE           TO WS-RCD-GLS-DIRE
               MOVE RCD-COD-LUGA           TO WS-RCD-COD-LUGA
           ELSE
           IF  WB-REQ-RCD-RC = '14'
               ADD 1                        TO WA-N-RCD
               DISPLAY 'STATUS RCD: ' WB-REQ-RCD-RC
               DISPLAY 'DBC-CIC-ICLI: ' SD-CIC-ICLI
               MOVE SPACES                 TO WS-RCD-NUM-FONO
               MOVE ZEROES                 TO WS-RCD-NUM-DIRE
               MOVE SPACES                 TO WS-RCD-MSC-TDIR
               MOVE '** SIN DIRECCION  **' TO WS-RCD-GLS-DIRE
               MOVE ZEROES                 TO WS-RCD-COD-LUGA
           ELSE
              MOVE SPACES                  TO WR-SECCION
              MOVE '080-LEER-RCD'          TO WR-PARRAFO
              MOVE 'RCD'                   TO WR-ARCHIVO
              MOVE WB-REQ-RCD-CMD          TO WR-OPERACI
              MOVE WB-REQ-RCD-RC           TO WR-FILE-ST
              MOVE WB-REQ-RCD-KEY-VALUE    TO WR-MENSAJE
              PERFORM 190-DISPLAY-ERROR
           END-IF
           END-IF.

       090-BUSCAR-REGION.
      *-----------------*
           MOVE WS-RCD-COD-LUGA       TO WB-REQ-TAB-KEY-COD
           MOVE 'TAB00'               TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-TAB-AREA COM WB-ELEM-LIS
           IF  WB-REQ-TAB-RC = SPACES
               ADD 1                  TO WA-L-TAB
               MOVE COM-COD-REGI      TO DIR-COD-REG
           ELSE
              ADD 1                   TO WA-N-TAB
              DISPLAY '** ERROR ACCESO TABLA TAB-COM'
              DISPLAY ' ESTADO : ' WB-REQ-TAB-RC
              DISPLAY ' CLAVE  : ' WB-REQ-TAB-KEY-VALUE
              DISPLAY '** PROCESO CONTINUA **'
              MOVE '13'                TO DIR-COD-REG
           END-IF.

       100-LEER-OPC.
      *------------*
           READ COLSOPC AT END MOVE 1 TO WS-FIN-OPC.
           IF WS-FIN-OPC = 0
              ADD 1                         TO WA-L-OPC
           END-IF.

       110-MOVER-DATOS-OPC.
      *-------------------*
           MOVE SD-OPC-COD-VCOC TO WS-OPC-COD-VCOC
           MOVE SD-OPC-COD-COOC TO WS-OPC-COD-COOC
           MOVE SD-OPC-COD-OFOC TO WS-OPC-COD-OFOC
           MOVE SD-OPC-CIC-IOPC TO WS-OPC-CIC-IOPC
           MOVE SD-OPC-FEC-FCOL TO WS-OPC-FEC-FCOL
           MOVE SD-OPC-VAL-SCRE TO WS-OPC-VAL-SCRE
           MOVE SD-OPC-VAL-CRED TO WS-OPC-VAL-CRED
           MOVE SD-OPC-NUM-VCOR TO WS-OPC-NUM-VCOR
           MOVE SD-OPC-NUM-TVCC TO WS-OPC-NUM-TVCC
           MOVE SD-OPC-NUM-IVEN TO WS-OPC-NUM-IVEN
           MOVE SD-OPC-NUM-VCVG TO WS-OPC-NUM-VCVG
           MOVE SD-OPC-COD-RMOC TO WS-OPC-COD-RMOC
           MOVE SD-DLC-FEC-FMAV TO WS-DLC-FEC-FMAV
           MOVE SD-DLC-COD-PLZO TO WS-DLC-COD-PLZO
           MOVE SD-DLC-FEC-FMAV TO WS-DLC-FEC-FMAV.

       120-PROCESO-OPC.
      *---------------*
           IF SD-CIC-IOPC NOT = WS-CIC-IOPC
              PERFORM 170-GRABAR-OPERAC
              MOVE SD-CIC-IOPC  TO WS-CIC-IOPC
              PERFORM 110-MOVER-DATOS-OPC
              MOVE 0            TO WS-NUM-CUO-MOR
                                   WS-TASA-MORA-PROM
                                   WS-MONTO-TOT-MORA
           END-IF.
           PERFORM 130-GRABAR-CUOTAS.
           PERFORM 100-LEER-OPC.

       130-GRABAR-CUOTAS.
      *-----------------*
           MOVE 0                        TO WS-CUO-TAS-PER
           MOVE 0                        TO WS-CUO-TAS-INC
           PERFORM 140-CALCULO-MORA
           MOVE SD-CIC-IOPC              TO CUO-NUM-OPE
           MOVE SD-NUM-IVCT              TO CUO-NUM-CUO
           MOVE SD-VAL-SFIN              TO CUO-MON-ORI
           MOVE SD-FEC-FVEN              TO CUO-FEC-VCT
           IF SD-OPC-COD-VCOC = '0998  '
              MOVE WS-INT-MORA-UF        TO CUO-INT-MOR
           ELSE
              MOVE WS-INT-MORA-PE        TO CUO-INT-MOR
           END-IF.
           MOVE WS-TOT-CUOTA             TO CUO-MON-TOT
           MOVE WS-CUO-TAS-PER           TO CUO-TAS-PER
           MOVE WS-CUO-TAS-INC           TO CUO-TAS-INC
           MOVE '%'                      TO CUO-FILLER1
                 CUO-FILLER2  CUO-FILLER4   CUO-FILLER5
                 CUO-FILLER7  CUO-FILLER9   CUO-FILLER10
                              CUO-FILLER12  CUO-FILLER14
           MOVE '$'                      TO CUO-FILLER3
                              CUO-FILLER6   CUO-FILLER8
                              CUO-FILLER11  CUO-FILLER13
           WRITE REG-CUOTAS
           IF WR-FS-CUOTAS = 0
              ADD 1                            TO WA-G-MOR
           ELSE
              MOVE SPACES                   TO WR-SECCION
              MOVE '130-GRABAR-CUOTAS'      TO WR-PARRAFO
              MOVE 'CUOTAS'                 TO WR-ARCHIVO
              MOVE 'WRITE'                  TO WR-OPERACI
              MOVE WR-FS-CUOTAS             TO WR-FILE-ST
              MOVE SD-CIC-IOPC              TO WR-MENSAJE
              PERFORM 190-DISPLAY-ERROR
           END-IF.
           ADD 1                            TO WS-NUM-CUO-MOR
           COMPUTE WS-TASA-MORA-PROM = WS-TASA-MORA-PROM + TXC-ATXC
           ADD WS-TOT-CUOTA                 TO WS-MONTO-TOT-MORA.

       140-CALCULO-MORA.
      *----------------*
           PERFORM 150-LEER-RUTINA-TMC
           IF SD-OPC-COD-VCOC = '0998  '
              COMPUTE WS-INT-MORA-UF ROUNDED =
                      (SD-VAL-SFIN * TXC-ATXC) / 100
              COMPUTE WS-TOT-CUOTA = SD-VAL-SFIN + WS-INT-MORA-UF
           ELSE
              COMPUTE WS-INT-MORA-PE ROUNDED =
                      (SD-VAL-SFIN * TXC-ATXC) / 100
              COMPUTE WS-TOT-CUOTA = SD-VAL-SFIN + WS-INT-MORA-PE
           END-IF.
           MOVE TXC-ATXC           TO WS-CUO-TAS-PER
           IF TXC-BASE = 'A'
              COMPUTE WS-CUO-TAS-INC ROUNDED = TXC-VTXC / 360
           ELSE
              COMPUTE WS-CUO-TAS-INC ROUNDED = TXC-VTXC / 30
           END-IF.

       150-LEER-RUTINA-TMC.
      *-------------------*
      *HZF-INI 12-07-2000
      *   IF SD-DLC-COD-PLZO NOT = 'C1' AND SD-DLC-COD-PLZO NOT = 'C2'
      *      AND SD-OPC-COD-VCOC = '0999  '
           IF SD-OPC-COD-VCOC = '0999  '
      *HZF-FIN 12-07-2000
              PERFORM 160-CONVERTIR-A-UF
           ELSE
      *HZF-INI 12-07-2000
              MOVE 0                        TO TXC-MNTO
              MOVE SD-OPC-VAL-CRED          TO TXC-MNTO
      *HZF-FIN 12-07-2000
           END-IF.
           MOVE SD-DLC-COD-PLZO             TO TXC-PLZO
           MOVE SD-OPC-COD-VCOC             TO TXC-VCOC
           MOVE SD-NUM-DVEN                 TO TXC-DEC1
           MOVE SD-NUM-MVEN                 TO TXC-MEC1
           MOVE SD-NUM-SVEN                 TO TXC-SEC1
           MOVE SD-NUM-AVEN                 TO TXC-AEC1
           MOVE WP-DIA-PRO                  TO TXC-DEC2
           MOVE WP-MES-PRO                  TO TXC-MEC2
           MOVE WP-SIG-PRO-R                TO TXC-SEC2
           MOVE WP-ANO-PRO-R                TO TXC-AEC2
           CALL 'TABPBTXC' USING TXC-CMMA.
           IF TXC-CMSG = SPACES
              ADD 1 TO WA-L-TXC
           ELSE
              ADD  1                        TO WA-L-TXC
              MOVE 1                        TO TXC-ATXC
              MOVE 1                        TO TXC-VTXC
              MOVE 'A'                      TO TXC-BASE
              DISPLAY '******************************'
              DISPLAY '** ERROR AL CALL TABPBTXC **'
              DISPLAY ' ESTATUS  : ' TXC-CMSG
              DISPLAY ' TXC-PLZO : ' TXC-PLZO
              DISPLAY ' TXC-VCOC : ' TXC-VCOC
              DISPLAY ' TXC-FEC1 : ' TXC-FEC1
              DISPLAY ' TXC-FEC2 : ' TXC-FEC2
              DISPLAY 'SE DEJA CAMPO TXC-ATXC = 1 '
              DISPLAY '        CAMPO TXC-VTXC = 1 '
              DISPLAY '        CAMPO TXC-BASE = A '
              DISPLAY 'PARA ARCHIVO CUOTAS : '
              DISPLAY 'CUO-NUM-OPE : ' SD-CIC-IOPC
              DISPLAY 'CUO-NUM-CUO : ' SD-NUM-IVCT
              DISPLAY 'CUO-MON-ORI : ' SD-VAL-SFIN
              DISPLAY 'CUO-FEC-VCT : ' SD-FEC-FVEN
              DISPLAY '******************************'
           END-IF.

       160-CONVERTIR-A-UF.
      *------------------*
           MOVE SD-OPC-FEC-FCOL  TO WB-REQ-CAM-KEY-FE1
           MOVE SD-OPC-FEC-FCOL  TO WB-REQ-CAM-KEY-FE2
           MOVE '0998  '         TO WB-REQ-CAM-KEY-COD1
           MOVE '0999  '         TO WB-REQ-CAM-KEY-COD2
           MOVE 'CAM00'          TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-CAM-AREA REG-CAM
                               WB-ELEM-LIS
           IF WB-REQ-CAM-RC = SPACES
              ADD 1 TO WA-L-CAM
              MOVE CAM-SGV-VCAM             TO WR-CAM-SGV-VCAM
              COMPUTE WR-MTO-UF = SD-OPC-VAL-CRED / WR-CAM-SGV-VCAM
              MOVE WR-MTO-UF                TO TXC-MNTO
           ELSE
              ADD  1                        TO WA-N-CAM
              MOVE 1                        TO TXC-MNTO
              DISPLAY '******************************'
              DISPLAY '** ERROR AL REDKX TABLA CAM **'
              DISPLAY ' ESTATUS : ' WB-REQ-CAM-RC
              DISPLAY ' CLAVE   : ' WB-REQ-CAM-KEY-VALUE
              DISPLAY 'SE LEE RUTINA CON CAMPO TXC-MNTO = 1 '
              DISPLAY 'PARA ARCHIVO CUOTAS : '
              DISPLAY 'CUO-NUM-OPE : ' SD-CIC-IOPC
              DISPLAY 'CUO-NUM-CUO : ' SD-NUM-IVCT
              DISPLAY 'CUO-MON-ORI : ' SD-VAL-SFIN
              DISPLAY 'CUO-FEC-VCT : ' SD-FEC-FVEN
              DISPLAY '******************************'
           END-IF.

       170-GRABAR-OPERAC.
      *-----------------*
           COMPUTE WS-TASA-MORA-PROM ROUNDED =
                   (WS-TASA-MORA-PROM / WS-NUM-CUO-MOR)
           IF WS-OPC-COD-VCOC = '0999  '
              COMPUTE WS-MONTO-TOT-PE ROUNDED = WS-MONTO-TOT-MORA * 1
              MOVE WS-MONTO-TOT-PE     TO WS-MONTO-TOT-MORA
           END-IF.
           MOVE WS-MONTO-TOT-MORA               TO OPE-MON-MOR
           IF WS-OPC-COD-TOOC = 'CON' OR 'PAP'
              MOVE '000098'                     TO OPE-COD-PRO
           ELSE
              MOVE '000099'                     TO OPE-COD-PRO
           END-IF.
           MOVE WS-OPC-COD-OFOC                 TO OPE-COD-SUC
           MOVE WS-OPC-CIC-IOPC                 TO OPE-NUM-OPE
           MOVE WS-OPC-COD-VCOC                 TO OPE-COD-MON
           MOVE WS-OPC-FEC-FCOL                 TO OPE-FEC-CUR
           MOVE WS-OPC-VAL-SCRE                 TO OPE-MON-SAL
           MOVE WS-OPC-VAL-CRED                 TO OPE-MON-CRE
           MOVE WS-OPC-NUM-VCOR                 TO OPE-NUM-CUO
           MOVE WS-DLC-FEC-FMAV                 TO OPE-FEC-VCT
           MOVE ZEROES                          TO OPE-NUM-REN
           PERFORM 180-LEER-ICG.
           IF ICG-COD-CVTI > SPACES
              MOVE ICG-SGV-SPRD                 TO OPE-TAS-PAC
           ELSE
              MOVE ICG-SGV-TINT                 TO OPE-TAS-PAC
           END-IF.
           COMPUTE OPE-TAS-MOR ROUNDED = WS-TASA-MORA-PROM * 1
           MOVE ZEROES                          TO OPE-CUP-NAC
           MOVE ZEROES                          TO OPE-CUP-INT
           MOVE WS-OPC-NUM-IVEN                 TO WS-PRIM-CUO-IMPA
           MOVE WS-PRIM-CUO-IMPA                TO OPE-PRI-CUO
           MOVE WS-OPC-NUM-VCVG                 TO OPE-CUO-IMP
           MOVE WS-NUM-CUO-MOR                  TO OPE-CUO-MOR
           MOVE 'VIG'                           TO OPE-COD-EST
           MOVE WS-DLC-COD-PLZO                 TO OPE-COD-PLZO
           MOVE WS-OPC-COD-COOC                 TO OPE-COD-TCRE
           MOVE WS-OPC-COD-RMOC                 TO OPE-COD-EJEC
           MOVE '%'                             TO OPE-FILLER1
                        OPE-FILLER2  OPE-FILLER3   OPE-FILLER4
                        OPE-FILLER6  OPE-FILLER7   OPE-FILLER9
                        OPE-FILLER10 OPE-FILLER11  OPE-FILLER12
                        OPE-FILLER13 OPE-FILLER14  OPE-FILLER16
                        OPE-FILLER18 OPE-FILLER20  OPE-FILLER21
                        OPE-FILLER22 OPE-FILLER23  OPE-FILLER24
                                     OPE-FILLER25  OPE-FILLER26
           MOVE '$'                             TO OPE-FILLER5
                                     OPE-FILLER8   OPE-FILLER15
                                     OPE-FILLER17  OPE-FILLER19
           WRITE REG-OPERAC
           IF WR-FS-OPERAC = 0
              ADD 1                         TO WA-G-OPE
           ELSE
              MOVE SPACES                   TO WR-SECCION
              MOVE '170-WRITE-OPERAC'       TO WR-PARRAFO
              MOVE 'OPERAC'                 TO WR-ARCHIVO
              MOVE 'WRITE'                  TO WR-OPERACI
              MOVE WR-FS-OPERAC             TO WR-FILE-ST
              MOVE WS-CIC-IOPC              TO WR-MENSAJE
              PERFORM 190-DISPLAY-ERROR
           END-IF.

       180-LEER-ICG.
      *------------*
           MOVE WS-CIC-IOPC                 TO ICG-CIC-IOPC.
           MOVE 000                         TO ICG-NUM-ICAN.
           MOVE SPACES                      TO ICG-CIC-IOPV
           MOVE 0                           TO ICG-NUM-IVCT
           MOVE 'INT'                       TO ICG-IND-TTAS
           MOVE SPACES                      TO ICG-FEC-FINI
           MOVE ICG-KEY-IICG                TO WB-REQ-ICG-KEY-VALUE
           MOVE ICG-KEY-ICAN                TO WS-ICG.
           MOVE SPACES                      TO WB-REQ-ICG-RC
           MOVE 'LOCKY'                     TO WB-REQ-ICG-CMD
           MOVE 'ICG00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-ICG-AREA ICG WB-ELEM-LIS
           IF  WB-REQ-ICG-RC = SPACES
               MOVE 'REDLE'                 TO WB-REQ-ICG-CMD
               CALL 'DBNTRY' USING WB-UIB WB-REQ-ICG-AREA
                                   ICG WB-ELEM-LIS
               IF WB-REQ-ICG-RC = SPACES
                  IF ICG-KEY-ICAN = WS-ICG
                     ADD 1                  TO WA-L-ICG
                  ELSE
                     MOVE SPACES               TO WR-SECCION
                     MOVE '180-LEER-ICG'       TO WR-PARRAFO
                     MOVE 'ICG'                TO WR-ARCHIVO
                     MOVE WB-REQ-ICG-CMD       TO WR-OPERACI
                     MOVE WB-REQ-ICG-RC        TO WR-FILE-ST
                     MOVE 'NO EXISTE ICG V/S OPC' TO WR-MENSAJE
                     PERFORM 190-DISPLAY-ERROR
                  END-IF
               ELSE
               IF WB-REQ-ICG-RC = '14'
                  MOVE SPACES               TO WR-SECCION
                  MOVE '180-LEER-ICG'       TO WR-PARRAFO
                  MOVE 'ICG'                TO WR-ARCHIVO
                  MOVE WB-REQ-ICG-CMD       TO WR-OPERACI
                  MOVE WB-REQ-ICG-RC        TO WR-FILE-ST
                  MOVE 'NO EXISTE ICG V/S OPC' TO WR-MENSAJE
                  PERFORM 190-DISPLAY-ERROR
               ELSE
                  MOVE SPACES               TO WR-SECCION
                  MOVE '180-LEER-ICG'       TO WR-PARRAFO
                  MOVE 'ICG'                TO WR-ARCHIVO
                  MOVE WB-REQ-ICG-CMD       TO WR-OPERACI
                  MOVE WB-REQ-ICG-RC        TO WR-FILE-ST
                  MOVE WB-REQ-ICG-KEY-VALUE TO WR-MENSAJE
                  PERFORM 190-DISPLAY-ERROR
               END-IF
               END-IF
           ELSE
           IF WB-REQ-ICG-RC NOT = '14'
              MOVE SPACES                  TO WR-SECCION
              MOVE '180-LEER-ICG'           TO WR-PARRAFO
              MOVE 'ICG'                   TO WR-ARCHIVO
              MOVE WB-REQ-ICG-CMD          TO WR-OPERACI
              MOVE WB-REQ-ICG-RC           TO WR-FILE-ST
              MOVE WB-REQ-ICG-KEY-VALUE    TO WR-MENSAJE
              PERFORM 190-DISPLAY-ERROR
           END-IF
           END-IF.

       190-DISPLAY-ERROR.
      *-----------------*
           SET WS-PROCESO-ERROR             TO TRUE.
           DISPLAY ' '
           DISPLAY 'ERROR EN SECCION   : ' WR-SECCION
           DISPLAY '   PARRAFO         : ' WR-PARRAFO
           DISPLAY '   ARCHIVO         : ' WR-ARCHIVO
           DISPLAY '   OPERACION       : ' WR-OPERACI
           DISPLAY '   FILE STATUS     : ' WR-FILE-ST
           DISPLAY '   MENSAJE DE ERROR: ' WR-MENSAJE.
           PERFORM 200-ESTADISTICAS.
           PERFORM 210-TERMINO.

       200-ESTADISTICAS.
      *----------------*
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'INFORMES'
           DISPLAY '--------'
           DISPLAY ' '
           DISPLAY 'COLPB89B NO EMITE INFORME'
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'ESTADISTICAS DE PROCESO PROGRAMA COLPB89B FECHA '
                    WP-FECHA-PRO
           DISPLAY '------------------------------------------------'
           DISPLAY '        GENERA ARCHIVO CUOTAS CON VEN"S'
           DISPLAY ' '
           DISPLAY 'LEIDOS COLSOPC   : ' WA-L-OPC
           DISPLAY 'LEIDOS COLSDBC   : ' WA-L-DBC
           DISPLAY 'LEIDOS RCD       : ' WA-L-RCD
           DISPLAY 'NO LEIDOS RCD    : ' WA-N-RCD
           DISPLAY 'LEIDOS ICG       : ' WA-L-ICG
           DISPLAY 'NO LEIDOS ICG    : ' WA-N-ICG
           DISPLAY 'LEIDOS TAB       : ' WA-L-TAB
           DISPLAY 'NO LEIDOS TAB    : ' WA-N-TAB
           DISPLAY 'LEIDOS TXC       : ' WA-L-TXC
           DISPLAY 'NO LEIDOS TXC    : ' WA-N-TXC
           DISPLAY 'LEIDOS CAM       : ' WA-L-CAM
           DISPLAY 'NO LEIDOS CAM    : ' WA-N-CAM
           DISPLAY ' '
           DISPLAY 'GRABADOS OPERAC : ' WA-G-OPE
           DISPLAY 'GRABADOS CUOTAS : ' WA-G-MOR
           DISPLAY 'GRABADOS DIRECC : ' WA-G-DIR
           DISPLAY 'GRABADOS TELEFO : ' WA-G-TEL
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'TARJETAS DE PARAMETROS'
           DISPLAY '----------------------'
           DISPLAY ' '
           DISPLAY W-PARAMETROS
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'MENSAJES PARA EL EXPLOTADOR'
           DISPLAY '---------------------------'
           DISPLAY ' '
           IF WS-PROCESO-OK
               DISPLAY 'NO HAY MENSAJES PARA EL EXPLOTADOR'
           ELSE
               DISPLAY 'HAY MENSAJES PARA EL EXPLOTADOR'
           END-IF.
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '.

       210-TERMINO.
      *----------*
           CLOSE COLSOPC
                 COLSDBC
                 CUOTAS
                 OPERAC
                 DIRECC
                 TELEFO.
           IF WS-PROCESO-ERROR
              MOVE 100                      TO RETURN-CODE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
              DISPLAY '********                              ********'
              DISPLAY '******** TERMINO ERRONEO DEL PROCESO  ********'
              DISPLAY '********                              ********'
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
           ELSE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*****PROCESO TERMINO EN FORMA NORMAL*****'
           END-IF
           GOBACK.

