       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      SGCPMREC.
       AUTHOR.          CONSIST.
      * Programa Modifica Registro REC.
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY SGCBRREC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGIFD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       01  WSS-VARI.
           03  WSS-RERR                      VALUE 0  PIC 9(05).
           03  WSS-ROKS                      VALUE 0  PIC 9(05).
           03  WSS-RLEE                      VALUE 0  PIC 9(05).
       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'SGCPMREC' TO FIO-PROG.
           PERFORM BUS-FSIS.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM SGC-FIO-REC.
       LUP-MAIN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MAIN.
           ADD 1 TO WSS-RLEE IN WSS-VARI.
           IF NOT REC-COD-VCAM IN REC = '0000  '
               GO TO NXT-MAIN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF NOT FIO-STAT-OKS
               ADD 1 TO WSS-RERR IN WSS-VARI
               GO TO NXT-MAIN.
           MOVE 'P' TO REC-COD-VCAM IN REC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF NOT FIO-STAT-OKS
               ADD 1 TO WSS-RERR IN WSS-VARI
           ELSE
               ADD 1 TO WSS-ROKS IN WSS-VARI.
       NXT-MAIN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           GO TO LUP-MAIN.
       FIN-MAIN.
           DISPLAY 'REGISTROS LEIDOS      : ' WSS-RLEE IN WSS-VARI.
           DISPLAY 'REGISTRO ERRONEOS     : ' WSS-REER IN WSS-VARI.
           DISPLAY 'REGISTROS MODIFICADOS : ' WSS-ROKS IN WSS-VARI.
           GOBACK.
       COPY SGCBFREC.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.
