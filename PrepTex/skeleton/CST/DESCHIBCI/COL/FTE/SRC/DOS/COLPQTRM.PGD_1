       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   COLPQTRM.
       AUTHOR.       BEE.
       DATE-WRITTEN. 06-Sep-19 05:26 PM.

      * NOMBRE PROGRAMA                   COLPQTRM
      * VERSION PGM                       3.1
      * VERSION SKL                       19.04.15
      * OPCION                            CON
      * ARCHIVO BASE                      COLOPC
      * PANTALLA                          COLTRM
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *-----------------------------------------------------------------
      *MODIFICACIONES
      *-----------------------------------------------------------------
      *OBJETIVO: CAMBIAR LECTURA ENTIDAD IMP POR TABLA TIM
      *PROYECTO: ITE - AUMENTO DE DECIMALES
      *FECHA   : ENERO DE 2013
      *AUTOR   : SOP
      *ETIQUETA: *AFRI-INI/ITE/SOP/01-2013
      *-----------------------------------------------------------------

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-COLPQTRM-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$COLPQTRM$ SKL=$19.04.15$ VSN=${vsnpq}$        
      -    'GEN=$06-Sep-19 05:26 PM$ FNC=${fncpq}$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
       COPY COLWITRM.

       COPY COLBROPC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.

      *<<<< WSS
       COPY COLBRDIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DIC-REQA==.
      *<<<< WSS  AND  PGM_PQ
       COPY COLBRIVE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IVE-REQA==.
           COPY USPC113.
       COPY COLBRVEN.
      *LOP-INI CREDITO SIN MORA
       COPY COLBRIXT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IXT-REQA==.
       COPY COLBRCXE.
       COPY COLWGCXE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CXE-REQA==.
       COPY COLBRIMP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IMP-REQA==.
       COPY COLWGTIM.
       COPY COLBRRCE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
      *LOP-FIN CREDITO SIN MORA
       COPY COLBRCAN.
       COPY COLBRRCV.
       COPY COLBRCYA.
       COPY COLBRICG.
       COPY COLBRROV.
       COPY COLBRTOC.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRRDC.
       COPY COLBRRDT.
       COPY COLBRPOC.
       COPY COLBRPVC.
       COPY SGCBRDBC.
       COPY COLWGVEN.
       COPY TABBRCAM.
       COPY GNSBRCIC.
       COPY TABBRUSR.
       COPY GNSWGPES.
       COPY COLWGINT.
       COPY GNSWGCIC.
       COPY GNSWGCPT.
       COPY COLWICAN.
       COPY COLW1CAN.
       COPY COLBRVEN REPLACING ==VEN== BY ==VEN-BKP==.
       COPY COLW2CAN.
           03 WSS-IND-PACA                        PIC X(01).
           03 WSS-COD-TABL.
              05 WSS-COD-PROG                     PIC X(08).
              05 WSS-COD-PARA                     PIC X(04).
           03 WSS-SCR-CMND                        PIC X(03).
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-FEC-FMIN.
              05 WSS-NUM-SMIN                     PIC 9(02).
              05 WSS-NUM-AMIN                     PIC 9(02).
              05 WSS-NUM-MMIN                     PIC 9(02).
              05 WSS-NUM-DMIN                     PIC 9(02).
      *     03 WSS-IND-FLAG        VALUE ZEROES    PIC 9(01).
           03 WSS-NUM-DTAC        VALUE ZEROES    PIC 9(03).
           03 WSS-DIF-DIAS        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-CORR        VALUE ZEROES    PIC 9(06).
           03 WSS-IND-DISP        VALUE SPACES    PIC X(01).
           03 WSS-COD-PESO        VALUE SPACES    PIC X(06).
           03 WSS-SGV-CAP1        VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-SGV-CAP2        VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-NUM-RLEI        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RNSE        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RGRA        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RACT        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RNIN        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RNAC        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RRCH        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-ROIN        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RONI        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-ROAC        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RONA        VALUE ZEROES    PIC 9(06).
           03  WSS-MAXV              VALUE ZEROS  PIC 9(03).
           03  WSS-MINV              VALUE ZEROS  PIC 9(03).
           03  WSS-MAXD              VALUE ZEROS  PIC 9(03).
           03  WSS-MIND              VALUE ZEROS  PIC 9(03).
           03  WSS-IDLC.
               05  WSS-VEC-IDLC OCCURS 500.
                   07  WSS-SGV-CAPD  COMP-3       PIC S9(11)V9(04).
                   07  WSS-SGV-FINA  COMP-3       PIC S9(11)V9(04).
           03  WSS-LIM-IDLC          VALUE 500    PIC 9(03).
           03  WSS-NUM-IDLC          VALUE ZEROS  PIC 9(04).
           03  WSS-NUM-VCVG          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-VCCM          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-VCCO          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-VCCV          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-IEVC          VALUE ZEROS  PIC 9(03).
           03  WSS-AUX-IVEN          VALUE ZEROS  PIC 9(03).
           03  WSS-IND-SCTB                        PIC X(03).
           03  WSS-IND-SCBZ                        PIC X(05).
           03  WSS-IND-EXIS          VALUE 'N'    PIC X(01).
           03  WSS-VAL-CAPI-GENE     COMP-3       PIC 9(11)V9(04).
           03  WSS-VAL-VENC  COMP-3  VALUE ZEROS  PIC 9(11)V9(04).
           03  WSS-FEC-FAMT.
               05  WSS-NUM-SAMT      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-AAMT      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-MAMT      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-DAMT      VALUE ZEROS  PIC 9(02).
           03  WSS-RCAN-SACT         VALUE ZEROES PIC 9(04).
           03  WSS-RCAN-NACT         VALUE ZEROES PIC 9(04).
           03  WSS-COD-OFOC          VALUE SPACES PIC X(03).
           03  WSS-COD-RMOC          VALUE SPACES PIC X(12).
           03  WSS-MSC-TCVE          VALUE SPACES PIC X(02).
           03  WSS-COD-CTAB.
               05  WSS-COD-CLASE.
                   07  WSS-COD-TIOC  VALUE ZEROES PIC X(03).
                   07  WSS-COD-AUXC  VALUE ZEROES PIC X(03).
               05  WSS-COD-VCDA      VALUE SPACES PIC X(06).
           03  WSS-IND-ACEL          VALUE SPACES PIC X(01).
           03  WSS-NUM-VSCE          VALUE ZEROES PIC 9(03).
           03  WSS-NUM-DIRE          VALUE ZEROES PIC X(02).
           03  WSS-COD-PLZO          VALUE SPACES PIC X(02).
           03  WSS-IND-GARA          VALUE SPACES PIC X(03).
           03  WSS-IND-VSTR          VALUE SPACES PIC X(01).
           03  WSS-COD-CDOC          VALUE SPACES PIC X(03).
           03  WSS-NUM-IVEN          VALUE ZEROES PIC 9(03).
           03  WSS-NUM-VCOR          VALUE ZEROES PIC 9(03).
           03  AUX-CIC-IOPC          VALUE SPACES PIC X(12).
      *ALD-BCI-INI/20-08-1998 VALIDA SI TIENE CAN ANTERIORES PARA FIMV
           03  WSS-FEC-FMVE.
               05  WSS-NUM-SMVE      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-AMVE      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-MMVE      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-DMVE      VALUE ZEROS  PIC 9(02).
      *ALD-BCI-FIN/20-08-1998
           03 PGM-STAT-CYA           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CYA-OKS    VALUE '00'.
                 88 PGM-STAT-CYA-NUL    VALUE '  '.
           03 PGM-STAT-RCV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RCV-OKS    VALUE '00'.
                 88 PGM-STAT-RCV-NUL    VALUE '  '.
           03 PGM-STAT-ITR           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ITR-OKS    VALUE '00'.
                 88 PGM-STAT-ITR-NUL    VALUE '  '.
           03 PGM-STAT-ICG           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ICG-OKS    VALUE '00'.
                 88 PGM-STAT-ICG-NUL    VALUE '  '.
           03 PGM-STAT-CAN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CAN-OKS    VALUE '00'.
                 88 PGM-STAT-CAN-NUL    VALUE '  '.
           03 PGM-STAT-ROV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ROV-OKS    VALUE '00'.
                 88 PGM-STAT-ROV-NUL    VALUE '  '.
      *
      *PVG INI 07-OCT-2004
           03 WSS-IVE-VIG-CAP1    COMP-3              PIC S9(11)V9(04).
           03 WSS-IVE-VIG-CAP2    COMP-3              PIC S9(11)V9(04).
           03 WSS-IVE-VIG-INT1    COMP-3              PIC S9(11)V9(04).
           03 WSS-IVE-VIG-INT2    COMP-3              PIC S9(11)V9(04).
           03 WSS-IVE-VIG-REA1    COMP-3              PIC S9(11)V9(04).
           03 WSS-IVE-VIG-REA2    COMP-3              PIC S9(11)V9(04).
           03 WSS-IVE-VIG-TAS1    COMP-3              PIC S9(11)V9(04).
           03 WSS-IVE-VIG-TAS2    COMP-3              PIC S9(11)V9(04).
      *PVG FIN 07-OCT-2004
      *     WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).
              05 PGM-STAT-VEN.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
                 07 PGM-STT1-VEN        VALUE '2' PIC X(01).
                    88 PGM-STAT-VEN-OKS VALUE '0'.
                 07 PGM-STT2-VEN        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
              05 PGM-STAT-DLC.
                 88 PGM-STAT-DLC-NUL    VALUE '  '.
                 07 PGM-STT1-DLC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DLC-OKS VALUE '0'.
                 07 PGM-STT2-DLC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(250).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO TRM-FLD.
           MOVE LOW-VALUES TO TRM-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'COLPQTRM' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *AFRI-INI/DEVENGO SUSPENDIDO/CHC/10-2014
           PERFORM GNS-HDL-VSM.
      *AFRI-FIN/DEVENGO SUSPENDIDO/CHC/10-2014
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-TRM.
           PERFORM EDT-KEY-TRM.
           PERFORM EDT-FLD-TRM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-MOD.
           PERFORM DESSCRTRL.
       MSG-SCR-MOD.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       BRW-SCR-MOD SECTION.
       INI-BRW-SCR-MOD.
       FIN-BRW-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-TRM
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
      *PTC-INI
                        MOVE 'S' TO SCR-IERR
      *PTC-FIN
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ELI.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       BRW-SCR-ELI SECTION.
       INI-BRW-SCR-ELI.
       FIN-BRW-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF FIO-STAT-OKS
                            MOVE SCR-ACTU-MOD TO SCR-ACTU
                            PERFORM PUT-SCR
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FIO-STAT-EOF
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGEOF    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                        IF FIO-STAT = FIO-STAT-NEX
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGNEX    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                            MOVE SCR-ACTU-ING TO SCR-ACTU
      *JSS                  PERFORM CLR-FLD-TRM
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACT
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACT.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACT.
           EXIT.

       BRW-SCR-ACT SECTION.
       INI-BRW-SCR-ACT.
       FIN-BRW-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF FRM-STAT-ABT
                    MOVE SPACES TO FRM-MENS
                    PERFORM SCR-MSSG
                    PERFORM DESSCRTRL
                    GO TO FIN-SCR-PGM
                ELSE
                    MOVE SPACES TO FRM-MENS
                    PERFORM FND-KEY
                    IF FIO-STAT = FIO-STAT-NEX
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGNEX    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                    ELSE
                        MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                        PERFORM SCR-TRL
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       BRW-SCR-PGM SECTION.
       INI-BRW-SCR-PGM.
       FIN-BRW-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-TRM
               PERFORM EDT-KEY-TRM
               PERFORM EDT-FLD-TRM
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-TRM
               PERFORM EDT-KEY-TRM
           ELSE
               PERFORM CLR-FLD-TRM
               PERFORM EDT-FLD-TRM.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-TRM.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO TRM-FLD.
           MOVE LOW-VALUES TO TRM-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
           PERFORM KEY-ALL-TRM.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE OPC-STP-ITRN IN OPC TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-OPC.
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CICIOPCNOOPC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO FRM-NUM-DCCT IN TRM-FLD.
           MOVE HOY-MHOY TO FRM-NUM-MCCT IN TRM-FLD.
           MOVE HOY-SHOY TO FRM-NUM-SCCT IN TRM-FLD.
           MOVE HOY-AHOY TO FRM-NUM-ACCT IN TRM-FLD.

           IF VEN-NUM-IVCT IN TRM-FLD NOT > ZEROES
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVCT IN TRM-FLD.

           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE 1 TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN.

           MOVE OPC-CAI-IOPC IN TRM-FLD     TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN TRM-FLD     TO VEN-IIC-IOPC IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICIOPCNOVEN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           MOVE '00' TO PGM-STAT-VEN.
           PERFORM PUT-VEN-TRM.
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'NUMIDLCNEX  ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           MOVE '00' TO PGM-STAT-DLC.
           PERFORM PUT-DLC-TRM.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT (FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = RDC-CIC-IOPC IN RDC)
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'OPC    NORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CLI    INEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.

           MOVE '00' TO PGM-STAT-DBC.
           PERFORM PUT-DBC-TRM.

      *    IF VEN-FEC-FVEN IN VEN NOT < HOY-FHOY
      *        MOVE 'COL'          TO MSG-COD-SIST
      *        MOVE 'FVENDEBE<HOY' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC   TO FRM-MENS
      *        MOVE '00'           TO FIO-STAT
      *        MOVE SCR-STAT-CON   TO SCR-STAT
      *        GO TO FIN-FND-KEY.

           IF OPC-MSC-STAT IN OPC NOT = 'A'
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'OPC    NOACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'OPC    YACAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           IF VEN-COD-TOPC IN VEN NOT = 'D'
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'VEN0NOTD'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           IF VEN-VAL-SFIN IN VEN NOT > ZEROES
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'VEN    YACAN'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           MOVE ' '              TO WSS-IND-PACA.
           IF SCR-CMND = 'TRC'
               MOVE 'COL'        TO FIO-SIST
               MOVE 'AUX'        TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND
                  TAB-MSC-STAT IN TAB = 'S' AND
                  TAB-GLS-DATA IN TAB (60:1) = 'C'
                   MOVE 'S'   TO WSS-IND-PACA.

           IF SCR-CMND = 'TRV' OR 'TRJ' OR 'TRC' OR 'ATV' OR 'TRN'
               IF OPC-COD-TOOC IN OPC = 'VDE'
                  IF NOT WSS-IND-PACA = 'S'
                     MOVE 'COL'        TO MSG-COD-SIST
                     MOVE 'OPCTOOCVDE' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE '00'         TO FIO-STAT
                     MOVE SCR-STAT-CON TO SCR-STAT
                     GO TO FIN-FND-KEY.

      * Si SCTB en VEN no es MOR o VIGENTE o no es administrada
      * por COL, no se procesa
           IF VEN-IND-SCTB IN VEN NOT = 'MOR' AND
              VEN-IND-SCTB IN VEN NOT = 'VIG' AND
              VEN-IND-SCTB IN VEN NOT = SPACES
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'SCTBVENINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           IF VEN-NUM-IVCT IN TRM-FLD NOT = OPC-NUM-IVEN IN OPC
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'NUMIVCTSEQ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           IF SCR-CMND = 'TRV' OR SCR-CMND = 'ATV'
               IF DLC-IND-SCTB IN DLC = 'VCD' OR
                  DLC-IND-SCTB IN DLC = 'CAS'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'DLCYAVCDOCAS'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY.

           IF SCR-CMND = 'TRJ'
               IF DLC-IND-SCTB IN DLC NOT = 'VCD'
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'DLCNOT=VCD'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
               IF DLC-IND-SCBZ IN DLC > SPACES
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'DLCSCBZ>SPAC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY.

           IF SCR-CMND = 'TRC'
               IF WSS-IND-PACA = 'S'
                   IF (DLC-IND-SCTB IN DLC NOT > SPACES OR
                       DLC-IND-SCTB IN DLC = 'MOR'      OR
                       DLC-IND-SCTB IN DLC = 'MUL'      OR
                       DLC-IND-SCTB IN DLC = 'VIG') AND
                      (DLC-IND-SCBZ IN DLC NOT > SPACES)
                         GO TO NO-VAL-IND-SCTB.
           IF SCR-CMND = 'TRC'
                  IF DLC-IND-SCTB IN DLC NOT = 'VCD'
                     MOVE 'COL'        TO MSG-COD-SIST
                     MOVE 'DLCNOT=VCD' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE '00'         TO FIO-STAT
                     MOVE SCR-STAT-CON TO SCR-STAT
                     GO TO FIN-FND-KEY.

           IF SCR-CMND = 'TRN'
               IF OPC-COD-TOOC IN OPC = 'VDE'
                   IF (DLC-IND-SCTB IN DLC NOT > SPACES OR
                       DLC-IND-SCTB IN DLC = 'MOR'      OR
                       DLC-IND-SCTB IN DLC = 'MUL'      OR
                       DLC-IND-SCTB IN DLC = 'VIG') AND
                      (DLC-IND-SCBZ IN DLC NOT > SPACES)
                        GO TO NO-VAL-IND-SCTB.

           IF SCR-CMND = 'TRN'
               IF DLC-IND-SCTB IN DLC NOT = 'CAS'
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'DLCNOT=CAS'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
           ELSE
      *PRC-INI 2008-02-22
      *        IF DLC-IND-SCBZ IN DLC > SPACES
               IF DLC-IND-SCBZ IN DLC = 'NIS'
      *PRC-FIN 2008-02-22
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'DLCSCBZ>SPAC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY.
       NO-VAL-IND-SCTB.
           IF SCR-CMND = 'TRV'
               PERFORM DET-ACELERA-OPC
           ELSE
               MOVE ZEROES TO WSS-NUM-VSCE IN WSS-VARI.
           IF WSS-NUM-VSCE IN WSS-VARI = 2 OR
              SCR-CMND = 'ATV'
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'OPCACEL=S'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'PRM' TO TAB-COD-TTAB IN TAB.
           MOVE 'COLPATRM'   TO WSS-COD-PROG.
           MOVE SCR-CMND     TO WSS-COD-PARA.
           MOVE WSS-COD-TABL TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB
           IF MSG-COD-MENS IN MSG = SPACES
               MOVE TAB-GLS-DATA IN TAB TO FRM-GLS-TRAS IN TRM-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-TRAS IN TRM-FLD.
           MOVE 'COL'        TO FIO-SIST.
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP TRV' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
               IF SCR-CMND = 'TRV' OR SCR-CMND = 'ATV'
                   PERFORM CHQ-USP
                   IF USP-COD-OFICINA NOT = OPC-COD-OFOC IN OPC
                       MOVE 'COL'        TO MSG-COD-SIST
                       MOVE 'OFIUSRNOTRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.
           MOVE PGM-STAT-OPC TO FIO-STAT.
      *>>>>
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-OPC-OKS
               MOVE OPC-STP-ITRN IN OPC TO SCR-UMOD.
           PERFORM PUT-ALL-TRM.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE TRM-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO TRM-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-TRM
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO TRM-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-TRM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-TRM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-TRM.
           PERFORM VAL-IKY-TRM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-TRM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-TRM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-TRM.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-TRM.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-TRM.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-TRM
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO TRM-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-TRM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-TRM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-TRM.
           PERFORM VAL-IKY-TRM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-TRM.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-TRM.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-TRM.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO TRM-GLS-MEN2
               MOVE SCR-PRMT     TO TRM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO TRM-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO TRM-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE TRM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO TRM-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-TRM

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO TRM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO TRM-GLS-MENS.
           PERFORM PRO-MKY-TRM.
           PERFORM PRO-AKY-TRM.
           PERFORM UNP-IKY-TRM.
           PERFORM FST-KEY-TRM.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE TRM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO TRM-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO TRM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO TRM-GLS-MENS.
           PERFORM UNP-KEY-TRM.
           PERFORM FST-KEY-TRM.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-TRM.
           PERFORM PRO-AKY-TRM.
           PERFORM UNP-MKY-TRM.
           PERFORM UNP-FLD-TRM.
           PERFORM FST-FLD-TRM.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO TRM-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-TRM.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-TRM
               PERFORM EDT-FLD-TRM
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-TRM
               PERFORM EDT-FLD-TRM
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-TRM.
           PERFORM EDT-FLD-TRM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY COLBQTRM.
       COPY GNSBVNUM.
       COPY COLBFOPC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBFOFI.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF_PQ
       COPY COLBFDIC.
       COPY COLBFVEN.
       COPY COLBFCAN.
       COPY COLBFRCV.
       COPY COLBFCYA.
       COPY COLBFICG.
       COPY COLBFROV.
       COPY COLBFTOC.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFRDC.
       COPY COLBFRDT.
       COPY COLBFPOC.
       COPY COLBFPVC.
       COPY COLBFIVE.
       COPY SGCBFDBC.
       COPY TABBFCAM.
       COPY GNSBFCIC.
       COPY TABBFUSR.
       COPY COLBGVEN.
       COPY GNSBGCAM.
       COPY GNSBGPES.
       COPY COLBGINT.

       COPY GNSBGCIC.
       COPY GNSBGCPT.
       COPY GNSBPFEC.
      *>>>>

      *<<<< EOF_PQ
       CHQ-USP SECTION.
       INI-CHQ-USP.
           COPY USPC143.
       FIN-CHQ-USP.
           EXIT.

       DET-ACELERA-OPC SECTION.
       INI-DET-ACELERA-OPC.
           MOVE VEN-CIC-IOPC IN VEN TO CAN-CIC-IOPC IN CAN.
           MOVE 999                 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-DET-ACELERA-OPC.
           PERFORM COL-FIO-CAN.
           IF NOT (FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = CAN-CIC-IOPC IN CAN)
               GO TO FIN-DET-ACELERA-OPC.
           IF CAN-MSC-TCAN IN CAN NOT = 'R'
               GO TO FIN-DET-ACELERA-OPC.

           MOVE CAN-CIC-IOPC IN CAN TO ROV-CIC-IOPV IN ROV.
           MOVE CAN-NUM-ICAN IN CAN TO ROV-NUM-IVCT IN ROV.
           MOVE 'ROV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DET-ACELERA-OPC.

           MOVE ROV-CIC-IOPC IN ROV TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DET-ACELERA-OPC.

           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO FIN-DET-ACELERA-OPC.

           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT (FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC AND
              DLC-IND-SCTB IN DLC = 'VCD')
               GO TO FIN-DET-ACELERA-OPC.
           ADD 1 TO WSS-NUM-VSCE IN WSS-VARI.
           MOVE FIO-GET-PRV TO FIO-CMND.
           GO TO LUP-DET-ACELERA-OPC.
       FIN-DET-ACELERA-OPC.
      *RESTAURA OPC
           MOVE OPC-CAI-IOPC IN TRM-FLD     TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN TRM-FLD     TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC
      *RESTAURA VEN
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE 1                       TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE OPC-NUM-IVEN IN OPC     TO VEN-NUM-IVEN IN VEN.
           MOVE OPC-CAI-IOPC IN TRM-FLD     TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN TRM-FLD     TO VEN-IIC-IOPC IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN
      *RESTAURA DLC
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
       EXT-DET-ACELERA-OPC.
           EXIT.

      *LOP-INI CREDITO SIN MORA
       COPY COLBFIXT.
       COPY COLBFCXE.
       COPY COLBGCXE.
       COPY COLB2CXE.
      *AFRI-INI/ITE/SOP/01-2013
      *COPY COLBFIMP.
      *AFRI-FIN/ITE/SOP/01-2013
       COPY COLBFRCE.
      *LOP-FIN CREDITO SIN MORA
      *>>>>
