       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGVFC.
       AUTHOR.          CONSIST (RBG).
       DATE-WRITTEN.    11-Mar-96 12:42 PM.

      * Genera archivo COLBRVFC para el listado
      * OPTIMIZACION : JGM.

      *JGM      SITE 2000          01.10.98

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.

       DATA DIVISION.
      *=============*

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.

       COPY COLBRVEN.
       COPY COLBRVES.
       COPY COLBRVFC.

       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY SGCBRDCP.
       COPY SGCBRDCE.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GNSWGSYS.
       COPY COLWGCTO.
       COPY COLBRTOC.
       COPY TABBRTIO.
       COPY GNSWGHOY.
       COPY GNSWGFEC.
       COPY GNSWGCPT.
       COPY TABBRUSR.


       01  WSS-VARI.
           03  WSS-FEC-FHST.
               05  WSS-NUM-SHST                PIC 9(02).
               05  WSS-NUM-AHST                PIC 9(02).
               05  WSS-NUM-MHST                PIC 9(02).
               05  WSS-NUM-DHST                PIC 9(02).

           03  WSS-FEC-FINI.
               05  WSS-NUM-SINI                PIC 9(02).
               05  WSS-NUM-AINI                PIC 9(02).
               05  WSS-NUM-MINI                PIC 9(02).
               05  WSS-NUM-DINI                PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                PIC 9(02).
               05  WSS-NUM-ATER                PIC 9(02).
               05  WSS-NUM-MTER                PIC 9(02).
               05  WSS-NUM-DTER                PIC 9(02).

           03  WSS-NUM-NDIA                    PIC 9(02).
           03  WSS-NUM-GVFC                    PIC 9(08).
           03  WSS-NUM-LVEN                    PIC 9(08).
           03  WSS-IND-PROCESAR                PIC X(01).
           03  WSS-IND-MORA                    PIC X(01).

           03 VEC-GLS-TBAN.
              05  VEC-COD-TBAN  OCCURS 20      PIC X(03).
           03 WSS-CNTD          VALUE ZEROES   PIC 9(02).
           03 WSS-CMAX          VALUE 20       PIC 9(02).

           03 WSS-BANCA.
              05  WSS-IND-TIPO                     PIC X(01).
                  88 BANCA-PERSONAS   VALUE 'P' 'N' ' '.
              05  WSS-IND-BANCA                    PIC X(02).


       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
       MAIN SECTION.
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPGVFC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM CAP-PARAMETROS.
           PERFORM OPEN-FILE.
           PERFORM CICLO-VEN.
           PERFORM L-ESTADISTICA.
       FIN-MAIN.
           PERFORM GNS-PRO-END.


       CICLO-VEN SECTION.
      *---------------
       INI-CICLO-VEN.

           MOVE 1 TO WSS-NUM-LVEN IN WSS-VARI.
           MOVE FIO-GET-FST    TO FIO-CMND.
           PERFORM COL-FIO-VES.
           IF NOT FIO-STAT-OKS
              GO TO CERRA-CICLO-VEN.
           MOVE VES TO VES.
       LUP-REG-VEN.
           IF VEN-FEC-FVEN IN VEN  <  WSS-FEC-FINI IN WSS-VARI
              GO TO NXT-REG-VEN.

           IF VEN-FEC-FVEN IN VEN  >  WSS-FEC-FTER IN WSS-VARI
              GO TO NXT-REG-VEN.


           IF VEN-VAL-SFIN IN VEN = ZEROES
              GO TO NXT-REG-VEN.

           PERFORM BUS-REG-OPC.
           IF  WSS-IND-PROCESAR IN WSS-VARI = 'N'
               GO TO NXT-REG-VEN.
      *
      *
           PERFORM BUS-REG-DLC.
           IF  WSS-IND-PROCESAR IN WSS-VARI = 'N'
               GO TO NXT-REG-VEN.
      *
      *

           PERFORM BUS-REG-RDC.
           IF  WSS-IND-PROCESAR IN WSS-VARI = 'N'
               GO TO NXT-REG-VEN.
      *

           PERFORM BUS-REG-DBC.
           IF  WSS-IND-PROCESAR IN WSS-VARI = 'N'
               GO TO NXT-REG-VEN.
      *

           PERFORM OBT-TIP-BANCA.
           IF  WSS-IND-PROCESAR IN WSS-VARI = 'N'
               GO TO NXT-REG-VEN.
      *

           PERFORM VAL-COD-TBAN.
           IF  WSS-IND-PROCESAR IN WSS-VARI = 'N'
               GO TO NXT-REG-VEN.

      *

           IF VEN-NUM-IVCT IN VEN > OPC-NUM-IVEN IN OPC
               MOVE 'S' TO WSS-IND-MORA IN WSS-VARI
           ELSE
               MOVE 'N' TO WSS-IND-MORA IN WSS-VARI.
      ***************************
           PERFORM GRAB-REG-VFC.
      ***************************
       NXT-REG-VEN.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-VES.
           IF NOT FIO-STAT-OKS
              GO TO CERRA-CICLO-VEN.

           ADD 1    TO WSS-NUM-LVEN IN WSS-VARI.
           MOVE VES TO VEN.
           GO TO LUP-REG-VEN.

       CERRA-CICLO-VEN.
            MOVE FIO-CLO TO FIO-CMND.
            PERFORM COL-FIO-VES.

            MOVE FIO-CLO TO FIO-CMND.
            PERFORM COL-FIO-VFC.
       FIN-CICLO-VEN.
           EXIT.


       BUS-REG-DLC SECTION.
      *--------------------*
       INI-BUS-REG-DLC.
           MOVE 'S'                 TO WSS-IND-PROCESAR IN WSS-VARI.
           MOVE VEN-CAI-IOPC IN VEN TO DLC-CAI-IOPC IN DLC.
           MOVE VEN-IIC-IOPC IN VEN TO DLC-IIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS         TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
              MOVE 'N' TO WSS-IND-PROCESAR IN WSS-VARI
              DISPLAY 'NO SE ENCONTRO REGISTRO DLC'
                      OPC-CIC-IOPC IN OPC.
       FIN-BUS-REG-DLC.
           EXIT.

       BUS-REG-OPC SECTION.
      *--------------------*
       INI-BUS-REG-OPC.
           MOVE 'S'                 TO WSS-IND-PROCESAR IN WSS-VARI.

           MOVE VEN-CAI-IOPC IN VEN TO OPC-CAI-IOPC IN OPC.
           MOVE VEN-IIC-IOPC IN VEN TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
              MOVE 'N' TO WSS-IND-PROCESAR IN WSS-VARI

              DISPLAY 'NO SE ENCONTRO REGISTRO OPC : '
                      OPC-CIC-IOPC IN OPC
              GO TO FIN-BUS-REG-OPC.

           IF OPC-MSC-STAT IN OPC NOT = 'A'
              MOVE 'N' TO WSS-IND-PROCESAR IN WSS-VARI
              GO TO FIN-BUS-REG-OPC.


           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
              MOVE 'N' TO WSS-IND-PROCESAR IN WSS-VARI.

           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
              MOVE 'COL'                TO MSG-COD-SIST
              MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
              PERFORM GET-MSG
              DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
              'CON CODIGO : '     CTO-TOOC IN CTO-VARI
              ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               MOVE 'N' TO WSS-IND-PROCESAR IN WSS-VARI.

       FIN-BUS-REG-OPC.
           EXIT.

       BUS-REG-RDC SECTION.
      *--------------------*
       INI-BUS-REG-RDC.
           MOVE 'S'                 TO WSS-IND-PROCESAR IN WSS-VARI.
           MOVE VEN-CAI-IOPC IN VEN TO RDC-CAI-IOPC IN RDC.
           MOVE VEN-IIC-IOPC IN VEN TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE ENCONTRO REGISTRO RDC PARA OPC: '
                       VEN-CIC-IOPC IN VEN
              MOVE 'N' TO WSS-IND-PROCESAR IN WSS-VARI.

       FIN-BUS-REG-RDC.
           EXIT.

       BUS-REG-DBC SECTION.
      *--------------------*
       INI-BUS-REG-DBC.
           MOVE 'S'                 TO WSS-IND-PROCESAR IN WSS-VARI.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'N' TO WSS-IND-PROCESAR IN WSS-VARI
              DISPLAY 'NO SE ENCONTRO REGISTRO DBC PARA OPC: '
                       VEN-CIC-IOPC IN VEN
              GO TO FIN-BUS-REG-DBC.

           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.

       FIN-BUS-REG-DBC.
           EXIT.

       OBT-TIP-BANCA SECTION.
      *----------------------*
       INI-OBT-TIP-BCA.
           MOVE SPACES              TO WSS-BANCA IN WSS-VARI.
           MOVE 'S'                 TO WSS-IND-PROCESAR IN WSS-VARI.
           MOVE RDC-CIC-ICLI IN RDC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF FIO-STAT-OKS
              MOVE DCP-COD-TBAN IN DCP TO WSS-BANCA IN WSS-VARI
              GO TO FIN-OBT-TIP-BCA.

           MOVE RDC-CIC-ICLI IN RDC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF FIO-STAT-OKS
              MOVE DCE-COD-TBAN IN DCE TO WSS-BANCA IN WSS-VARI
           ELSE
              MOVE 'N' TO WSS-IND-PROCESAR IN WSS-VARI
              DISPLAY '#ERROR> NO EXISTE DCP NI DCE'
              DISPLAY '#     > ASIGNA BLANCOS A TIPO BANCA '
              DISPLAY '#     > PROCESO CONTINUA '
              DISPLAY '#---------------------------------- '
              MOVE SPACES TO WSS-BANCA IN WSS-VARI.
       FIN-OBT-TIP-BCA.
           EXIT.


       VAL-COD-TBAN SECTION.
      *---------------------*
       INI-VAL-COD-TBAN.
           MOVE 'N' TO WSS-IND-PROCESAR IN WSS-VARI.
           MOVE 1   TO WSS-CNTD IN WSS-VARI.
           MOVE '00' TO FIO-STAT.
       LUP-TBAN.
           IF  VEC-COD-TBAN(WSS-CNTD) = '*'
               MOVE 'S' TO WSS-IND-PROCESAR IN WSS-VARI
               GO TO FIN-VAL-COD-TBAN.

           IF WSS-CNTD IN WSS-VARI > WSS-CMAX IN WSS-VARI OR
             VEC-COD-TBAN(WSS-CNTD) = '999'
               MOVE '23' TO FIO-STAT
               GO TO FIN-VAL-COD-TBAN.
      *

           IF VEC-COD-TBAN(WSS-CNTD) = WSS-BANCA IN WSS-VARI
              MOVE 'S' TO WSS-IND-PROCESAR IN WSS-VARI
              GO TO FIN-VAL-COD-TBAN
           ELSE
               ADD 1 TO WSS-CNTD IN WSS-VARI
               GO TO LUP-TBAN.
       FIN-VAL-COD-TBAN.
           EXIT.

       GRAB-REG-VFC SECTION.
      *--------------------*
       INI-GRAB-REG-VFC.
           MOVE ZEROES TO VFC.
           MOVE 999                      TO VFC-NUM-NDIA IN VFC.
      *
           MOVE VEN-CIC-IOPC IN VEN      TO VFC-CIC-IOPC IN VFC.
           MOVE VEN-NUM-IVCT IN VEN      TO VFC-NUM-IVCT IN VFC.
           MOVE VEN-FEC-FVEN IN VEN      TO VFC-FEC-FVEN IN VFC.
           MOVE VEN-VAL-SFIN IN VEN      TO VFC-VAL-SFIN IN VFC.
           MOVE VEN-VAL-SCAP IN VEN      TO VFC-VAL-SCAP IN VFC.

           MOVE OPC-COD-RMOC IN OPC      TO VFC-COD-RMOC IN VFC.
           MOVE OPC-VAL-SCRE IN OPC      TO VFC-VAL-SCRE IN VFC.
           MOVE OPC-VAL-CRED IN OPC      TO VFC-VAL-CRED IN VFC.
           MOVE OPC-COD-VCOC IN OPC      TO VFC-COD-VCOC IN VFC.

           MOVE DLC-FEC-FMAV IN DLC      TO VFC-FEC-FMAV IN VFC.
           MOVE WSS-IND-MORA IN WSS-VARI TO VFC-IND-MORA IN VFC.
           MOVE WSS-BANCA    IN WSS-VARI TO VFC-COD-TBAN IN VFC.
           MOVE CTO-OPEC                 TO VFC-CTO-OPEC IN VFC.

           MOVE DBC-GLS-NOMC IN DBC      TO VFC-GLS-NOMC IN VFC.
           MOVE DBC-NUM-ICLI IN DBC      TO VFC-NUM-ICLI IN VFC.
           MOVE DBC-VRF-ICLI IN DBC      TO VFC-VRF-ICLI IN VFC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-VFC.
           IF NOT FIO-STAT-OKS
              DISPLAY ' ERROR AL GRABAR VFC(FIO-STAT) ' FIO-STAT
              PERFORM GNS-PRO-ABT.
           ADD 1 TO WSS-NUM-GVFC IN WSS-VARI.

       FIN-GRAB-REG-VFC.
           EXIT.

       CAP-PARAMETROS SECTION.
      *----------------------*
       INI-CAP-PARAMETROS.
      * Acepta Numero de Dias como Parametro.
           ACCEPT WSS-NUM-NDIA IN WSS-VARI.
           IF WSS-NUM-NDIA IN WSS-VARI NOT NUMERIC
               DISPLAY 'ERROR DIAS NO NUMERICO'
               PERFORM GNS-PRO-ABT.
      *
           ACCEPT  VEC-GLS-TBAN IN WSS-VARI.
           DISPLAY 'PROCESO COLPGVFC : PARAMETROS '.
           DISPLAY '============================= '.
           DISPLAY 'BANCAS : ' VEC-GLS-TBAN IN WSS-VARI.
           DISPLAY 'DIAS   : ' WSS-NUM-NDIA IN WSS-VARI.

           MOVE 1  TO WSS-CNTD IN WSS-VARI.
       LUP-VAL-TBAN.
           IF VEC-COD-TBAN(WSS-CNTD) NOT = '*' AND
              WSS-CNTD IN WSS-VARI NOT > WSS-CMAX IN WSS-VARI AND
              VEC-COD-TBAN(WSS-CNTD) NOT = '999'
                 MOVE 'SGC'                  TO FIO-SIST
                 MOVE 'BAN'                  TO TAB-COD-TTAB IN TAB
                 MOVE VEC-COD-TBAN(WSS-CNTD) TO TAB-COD-CTAB IN TAB
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM GNS-FIO-TAB
                 IF FIO-STAT-OKS
                    ADD 1 TO WSS-CNTD IN WSS-VARI
                    GO TO LUP-VAL-TBAN
                 ELSE
                    DISPLAY 'CODIGO TIPO BANCA NO ENCONTRADO '
                             VEC-COD-TBAN(WSS-CNTD)
                    PERFORM OPEN-CLOSE-VFC
                    PERFORM GNS-PRO-ABT.

      * Obtengo Fecha de HOY
           PERFORM GET-FHOY.
           MOVE HOY-DHOY     TO FEC-ITM1.
           MOVE HOY-MHOY     TO FEC-ITM2.
           MOVE HOY-SHOY     TO FEC-ITM3.
           MOVE HOY-AHOY     TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE WSS-NUM-NDIA TO FEC-NDIA.
           PERFORM CAL-FEC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE PUEDE CALCULAR NUMERO DE DIAS'
              PERFORM GNS-PRO-ABT.

      * Traspaso la Fecha "Desde" al Reporte
           MOVE HOY-DHOY TO WSS-NUM-DINI IN WSS-VARI.
           MOVE HOY-MHOY TO WSS-NUM-MINI IN WSS-VARI.
           MOVE HOY-SHOY TO WSS-NUM-SINI IN WSS-VARI.
           MOVE HOY-AHOY TO WSS-NUM-AINI IN WSS-VARI.

           MOVE FEC-ITM1 TO WSS-NUM-DTER IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MTER IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-STER IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-ATER IN WSS-VARI.
       FIN-CAP-PARAMETROS.
           EXIT.

       OPEN-CLOSE-VFC SECTION.
      *-----------------*
       INI-OPEN-CLOSE-VFC.
            MOVE FIO-OUT TO FIO-CMND.
            PERFORM COL-FIO-VFC.
            IF NOT FIO-STAT-OKS
               PERFORM GNS-PRO-ABT.
      *
            MOVE FIO-CLO TO FIO-CMND.
            PERFORM COL-FIO-VFC.
       FIN-OPEN-CLOSE-VFC.
           EXIT.

       OPEN-FILE SECTION.
      *-----------------*
       INI-OPEN-FILE.
      * Abro los Archivos que necesito.
      *Apertura archivo VEN secuencial
            MOVE FIO-INP TO FIO-CMND.
            PERFORM COL-FIO-VES.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR ARCHIVO VES '
               PERFORM GNS-PRO-ABT.
      *
            MOVE FIO-OUT TO FIO-CMND.
            PERFORM COL-FIO-VFC.
            IF NOT FIO-STAT-OKS
               PERFORM GNS-PRO-ABT.
      *
            PERFORM GRABA-ENCABEZADO.

      *
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO OPC'
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO RDC'
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO TOC'
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO DBC'
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           MOVE 'SGC' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO TAB'
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO TAB'
               PERFORM GNS-PRO-ABT.

      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
               PERFORM GNS-PRO-ABT.

       FIN-OPEN-FILE.
           EXIT.

       GRABA-ENCABEZADO SECTION.
      *-------------------------*
       INI-GRABA-ENCABEZADO.
            MOVE ZEROES TO VFC
      *
            MOVE HOY-DHOY                 TO VFC-NUM-DINI IN VFC.
            MOVE HOY-MHOY                 TO VFC-NUM-MINI IN VFC.
            MOVE HOY-SHOY                 TO VFC-NUM-SINI IN VFC.
            MOVE HOY-AHOY                 TO VFC-NUM-AINI IN VFC.

            MOVE WSS-NUM-DTER IN WSS-VARI TO VFC-NUM-DTER IN VFC.
            MOVE WSS-NUM-MTER IN WSS-VARI TO VFC-NUM-MTER IN VFC.
            MOVE WSS-NUM-STER IN WSS-VARI TO VFC-NUM-STER IN VFC.
            MOVE WSS-NUM-ATER IN WSS-VARI TO VFC-NUM-ATER IN VFC.

            MOVE WSS-NUM-NDIA IN WSS-VARI TO VFC-NUM-NDIA IN VFC.
            MOVE SPACES                   TO VFC-COD-TBAN IN VFC.
            MOVE SPACES                   TO VFC-COD-RMOC IN VFC.
      *
            MOVE FIO-PUT TO FIO-CMND.
            PERFORM COL-FIO-VFC.
            IF NOT FIO-STAT-OKS
               DISPLAY ' ERROR AL GRABAR VFC(FIO-STAT) ' FIO-STAT
               PERFORM GNS-PRO-ABT.
       FIN-GRABA-ENCABEZADO.
           EXIT.
       L-ESTADISTICA SECTION.
       INI-L-ESTADISTICA.
           DISPLAY ' ESTADISTICAS PROCESO COLPGVFC '.
           DISPLAY ' ============================= '.
           DISPLAY ' VEN LEIDAS      :'
                     WSS-NUM-LVEN IN WSS-VARI.
           DISPLAY ' VFC GRABADAS    :'
                     WSS-NUM-GVFC IN WSS-VARI.
       FIN-L-ESTADISTICA.
           EXIT.
       COPY COLBFVES.
       COPY COLBFVFC.

       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY SGCBFDCE.
       COPY SGCBFDCP.

       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBPFEC.
       COPY GNSBBMSG.
       COPY GNSBGCPT.
       COPY TABBBUSR.
       COPY TABBFUSR.
       COPY GNSBBTAB.
       COPY COLBGCTO.
       COPY COLBFTOC.
      *>>>>
