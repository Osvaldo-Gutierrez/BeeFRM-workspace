       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGHDI.
       AUTHOR.          BEE TEAM (JGM).
       DATE-WRITTEN.    27-JUL-1999
      *
      *Generar Informacion , CAMARA DE COMERCIO.
      *Aclaracion Documentos Pagados.
      *
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
      *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
      *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
      *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
      *<<<< WSS
      ***************
       COPY COLBRADI.
       COPY COLBRCDC.
      ***************
       COPY COLBROPC.
       COPY COLBRVEN.
       COPY COLBRCAN.
       COPY COLBRDLC.
       COPY COLBRCYA.
       COPY COLBRRCV.
       COPY COLBRRDC.
       COPY COLBRROV.
      *
       COPY SGCBRDBC.
       COPY SGCBRDCP.
       COPY SGCBRRCD.
      *
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGFRM.
      ***************
       COPY COLWGVEN.
       COPY COLWGINT.
       COPY GNSWGPES.
       COPY COLBRICG.
       COPY COLBRTOC.
       COPY COLBREVC.
       COPY TABBRCAM.
       COPY TABBROFI.
      ***************
      *
       01  WSS-VARI.
           03 WSS-GLS-CAB1.
              05 WSS-GLS-CAB1-A   VALUE SPACES    PIC X(52).
              05 WSS-GLS-CAB1-B   VALUE SPACES    PIC X(01).

           03 WSS-GLS-CAB2.
              05 WSS-GLS-CAB2-A   VALUE SPACES    PIC X(46).
              05 WSS-GLS-CAB2-B.
                 07 WSS-ANO2                      PIC X(02).
                 07 WSS-MES2                      PIC X(02).
                 07 WSS-DIA2                      PIC X(02).

           03 WSS-GLS-CAB3.
              05 WSS-GLS-CAB3-A   VALUE SPACES    PIC X(50).
              05 WSS-GLS-CAB3-B.
                 07 WSS-SIG3                      PIC X(02).
                 07 WSS-ANO3                      PIC X(02).
                 07 WSS-MES3                      PIC X(02).
                 07 WSS-DIA3                      PIC X(02).
      *
           03 WSS-FEC-FVEN.
              05 WSS-NUM-SVEN                     PIC X(02).
              05 WSS-NUM-AVEN                     PIC X(02).
              05 WSS-NUM-MVEN                     PIC X(02).
              05 WSS-NUM-DVEN                     PIC X(02).
      *
           03 WSS-FEC-FPTE.
              05 WSS-NUM-SPTE                     PIC 9(02).
              05 WSS-NUM-APTE                     PIC 9(02).
              05 WSS-NUM-MPTE                     PIC 9(02).
              05 WSS-NUM-DPTE                     PIC 9(02).
      *
           03 WSS-NUM-LCAB       VALUE ZEROES     PIC 9(08).
           03 WSS-NUM-LDET       VALUE ZEROES     PIC 9(08).
           03 WSS-NUM-GCDC       VALUE ZEROES     PIC 9(08).
           03 WSS-NUM-LADI       VALUE ZEROES     PIC 9(08).

           03 WSS-IND-EXISTE     VALUE SPACE      PIC X(01).
      *
           03 WSS-COD-ERRO                        PIC X(01).
              88 WSS-OK                           VALUE  '0'.
              88 WSS-NOINFORMADA-BOLETIN          VALUE  '1'.


       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPGHDI' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           PERFORM OPEN-FILE.
           PERFORM PRO-REG-ADI.
           PERFORM CLOSE-FILE.
           PERFORM MUESTRA-ESTADISTICAS.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

      ******************************************************************

       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
      *
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-CDC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR ABRIENDO COLCDC ' FIO-STAT
              PERFORM GNS-PRO-ABT.
      *
      *
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-ADI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR ABRIENDO COLADI ' FIO-STAT
              PERFORM GNS-PRO-ABT.
       FIN-OPEN-FILE.
           EXIT.

       CLOSE-FILE SECTION.
      *-----------------
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-CDC.
      *
      * Archivo de aclaracion   de documentos Protestados.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-ADI.
           DISPLAY 'CERRAR ARCHIVOS: CDC, ADI'.
      *
       FIN-CLOSE-FILE.
           EXIT.


      ******************************************************************
       PRO-REG-ADI SECTION.
      *------------------*
       INI-PRO-REG-ADI.
      * fecha computacional
      *
           MOVE ZERO  TO WSS-FEC-FPTE IN WSS-VARI.
      *
           MOVE FIO-GET-NXT              TO FIO-CMND.
           PERFORM COL-FIO-ADI.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTEN REGISTROS ADI '
               GO TO FIN-PRO-REG-ADI.
      **
       LUP-BUS-ADI.
           ADD 1 TO WSS-NUM-LADI IN WSS-VARI.
      *
           IF ADI-COD-TREG IN ADI = 'RC'  AND
              ADI-COD-TDOC IN ADI = 'DI'
              ADD 1 TO  WSS-NUM-LCAB IN WSS-VARI
              PERFORM BUS-REG-CABEZERA
           ELSE
            IF ADI-COD-TREG IN ADI = 'RP'  AND
               ADI-COD-TDOC IN ADI = 'DI'
               ADD 1 TO  WSS-NUM-LDET IN WSS-VARI
               PERFORM GRABA-REG-CDC
           ELSE
            DISPLAY 'REG '  ADI.

       NXT-PRO-ADI.
      *
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ADI.
           IF FIO-STAT-OKS
               GO TO LUP-BUS-ADI.
       FIN-PRO-REG-ADI.
           EXIT.
      *

       BUS-REG-CABEZERA SECTION.
      *------------------------*
       INI-BUS-REG-CABEZERA.

           MOVE ADI TO WSS-GLS-CAB1 IN WSS-VARI.
           IF WSS-GLS-CAB1-B IN WSS-VARI = ' '
             MOVE ADI  TO WSS-GLS-CAB2 IN WSS-VARI
      *
             MOVE 19                   TO WSS-NUM-SPTE IN WSS-VARI
             MOVE WSS-ANO2 IN WSS-VARI TO WSS-NUM-APTE IN WSS-VARI
             MOVE WSS-MES2 IN WSS-VARI TO WSS-NUM-MPTE IN WSS-VARI
             MOVE WSS-DIA2 IN WSS-VARI TO WSS-NUM-DPTE IN WSS-VARI
           ELSE
             MOVE ADI  TO WSS-GLS-CAB3 IN WSS-VARI
             MOVE WSS-GLS-CAB3-B IN WSS-VARI TO
                                    WSS-FEC-FPTE IN WSS-VARI.
       FIN-BUS-REG-CABEZERA.
           EXIT.

       GRABA-REG-CDC SECTION.
      *---------------------*
       INI-GRABA-REG-CDC.

      *     Tipo de registro.
            MOVE ADI-COD-TREG  IN ADI  TO CDC-COD-TREG IN CDC.
      *
      *     Tipo de documento.
            MOVE ADI-COD-TDOC  IN ADI  TO CDC-COD-TDOC IN CDC.
      *
      *     Numero correlativo.
            MOVE ADI-NUM-CORR  IN ADI  TO CDC-NUM-CORR IN CDC.
      *
      *     RUT del Deudor (Numero - digito Verificador).
            MOVE ADI-COD-IRUT  IN ADI  TO CDC-COD-IRUT IN CDC.

      *
      *     Calidad Juridica.
            MOVE ADI-IND-CJUR  IN ADI   TO CDC-COD-CJUR IN CDC.

      *
      *     Codigo de Oficina /Sucursal.
            MOVE ADI-COD-OFOC  IN ADI   TO CDC-COD-OFIC IN CDC.
      *
      *     Codigo de localidad
            MOVE ADI-COD-LOCA  IN ADI   TO CDC-COD-LOCA IN CDC.
      *
      *     Moneda.
            MOVE ADI-GLS-MONE  IN ADI   TO CDC-COD-MONE IN CDC.
      *
      *     Monto.
            MOVE ADI-VAL-MONT  IN ADI   TO CDC-VAL-MONT IN CDC.
      *
      *     Cic- IOPC.
            MOVE ADI-CIC-IOPC  IN ADI   TO CDC-CIC-IOPC IN CDC.
      *
      *     Codigo de Causal.
            MOVE ADI-COD-CAUS  IN ADI   TO CDC-COD-CAUS IN CDC.
      *
      * Fecha de vencimiento.
            IF ADI-NUM-SVEN IN ADI = 19
               MOVE ADI-FEC-FVEN  IN ADI   TO CDC-FEC-FVEN IN CDC
            ELSE
               MOVE 19                     TO CDC-NUM-SVEN IN CDC
               MOVE ADI-NUM-SVEN  IN ADI   TO CDC-NUM-AVEN IN CDC
               MOVE ADI-NUM-AVEN  IN ADI   TO CDC-NUM-MVEN IN CDC
               MOVE ADI-NUM-MVEN  IN ADI   TO CDC-NUM-DVEN IN CDC.

      *Fecha de proceso(cabezera)
            MOVE WSS-FEC-FPTE IN WSS-VARI  TO CDC-FEC-FENV IN CDC.
      *
            MOVE ZERO                      TO CDC-FEC-FACL IN CDC.
            MOVE ZERO                      TO CDC-FEC-FCAN IN CDC.
            MOVE SPACES                    TO CDC-IND-ESTA IN CDC.
            MOVE SPACES                    TO CDC-GLS-DISP IN CDC.
            MOVE FIO-PUT TO FIO-CMND.
            PERFORM COL-FIO-CDC.
            IF  NOT FIO-STAT-OKS
                DISPLAY 'ERROR GRABA REG : CDC '
                GO TO FIN-GRABA-REG-CDC.
      *
            ADD 1 TO WSS-NUM-GCDC IN WSS-VARI.
       FIN-GRABA-REG-CDC.
           EXIT.



      *
       MUESTRA-ESTADISTICAS SECTION.
      *----------------------------*
       INI-MUESTRA-ESTADISTICAS.
           DISPLAY 'ESTADISTICAS PROCESO: COLPGHDI '.
           DISPLAY '==============================='.
           DISPLAY ' REGISTROS LEIDOS ADI         : ' WSS-NUM-LADI.
           DISPLAY ' REGISTROS LEIDOS CABECERA    : ' WSS-NUM-LCAB.
           DISPLAY ' REGISTROS LEIDOS DETALLE     : ' WSS-NUM-LDET.
           DISPLAY ' REGISTROS GRABADOS CDC       : ' WSS-NUM-GCDC.
           DISPLAY '==============================='.
       FIN-MUESTRA-ESTADISTICAS.
           EXIT.

      ***************
       COPY COLBFADI.
       COPY COLBFCDC.
      ***************
       COPY COLBFOPC.
       COPY COLBFVEN.
       COPY COLBFCAN.
       COPY COLBFDLC.
       COPY COLBFCYA.
       COPY COLBFRCV.
       COPY COLBFRDC.
       COPY COLBFROV.
      ***************
       COPY SGCBFDBC.
       COPY SGCBFDCP.
       COPY SGCBFRCD.
      ***************
       COPY COLBGVEN.
       COPY COLBGINT.
       COPY GNSBGPES.
       COPY COLBFICG.
       COPY COLBFTOC.
       COPY COLBFEVC.
       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBVOFI.
      ***************
       COPY GNSBFMSG.
       COPY GNSBFMSC.

       COPY GNSBFTAB.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.

       COPY GNSBBMSG.
