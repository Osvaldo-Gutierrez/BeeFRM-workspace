       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLROI.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    02-May-94 10:48 AM.

      * Programa Listador de Reporte OC1 con Sort.


000000*COMPILED SITE 2000          01.09.98
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MODIFICACION: CONVERTIR REPORT-WRITER A LISTADO, MIGRAR A     *
      *                A COBOL FOR MVS Y CONVERSION 2000               *
      *  FECHA: JULIO 1998                                             *
      ******************************************************************


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTOC1         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTOC1         ASSIGN TO        UT-S-RPTOC1.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.

      ***** CRW-COMIENZO
      *    SELECT RPTOC1         ASSIGN TO        UT-S-RPTOC1.
           SELECT RPTOC1         ASSIGN TO             RPTOC1.
      ***** CRW-FINAL


       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY COLRROC1.
      *<<<<
       COPY COLRROC2 REPLACING ==01  SRT== BY ==02  SRT-OC2==.
      *>>>>

      ***** CRW-COMIENZO

      *FD  RPTOC1 LABEL RECORDS OMITTED
      *    REPORT IS RPT-OC1
      *    .

       FD  RPTOC1
           RECORD CONTAINS 133 CHARACTERS
           BLOCK CONTAINS 0 RECORDS
           LABEL RECORD STANDARD.

       01  RPTOC1-REG           PIC X(133).
      ***** CRW-FINAL

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBROPC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWOC1.
      *<<<< RW
       COPY COLRWOC2.
       COPY COLRWDLC.
       COPY COLRWEVC.
       COPY COLRWVEN.
       COPY COLRWRDC.
       COPY COLRWCYA.
       COPY COLRWICG.
      *>>>>
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       01  WSS-VARI.
           03  WSS-COD-PLZA.
               05 WSS-IND-OFIC                       PIC X(01).
               05 WSS-COD-OFIC      VALUE SPACES     PIC X(03).
           03  WSS-NUM-JUL                VALUE 0    PIC 9(06).
           03  WSS-SGV-VCAM               COMP-3     PIC S9(11)V9(4).
           03  WSS-MSC-STAT                          PIC X(01).
           03  WSS-IND-VEVC                          PIC 9(01).
           03  WSS-GLS-SPAC                          PIC X(01).
           03  WSS-NUM-IDLC                          PIC 9(03).
           03  WSS-NUM-FSTD                          PIC 9(03).
           03  WSS-NUM-SUDL                          PIC 9(05).
           03  WSS-MUL-FSTD                          PIC 9(01).
           03  WSS-MUL-DEUD                          PIC 9(01).
           03  WSS-MUL-DEUI                          PIC 9(01).
           03  WSS-MUL-CYA                           PIC 9(01).
           03  WSS-MUL-ICG                           PIC 9(01).
           03  WSS-NUM-ICAN                          PIC 9(03).
           03  WSS-IND-SEL1                          PIC X(01).
           03  WSS-FEC-FCMP.
               05  WSS-NUM-SCMP                      PIC 9(02).
               05  WSS-NUM-ACMP                      PIC 9(02).
               05  WSS-NUM-MCMP                      PIC 9(02).
               05  WSS-NUM-DCMP                      PIC 9(02).
           03  WSS-CIC-IOPC.
               05  WSS-CAI-IOPC         VALUE SPACES PIC X(04).
               05  WSS-IIC-IOPC         VALUE SPACES PIC X(08).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-DTER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                      PIC X(03).
               05  WSS-COD-AOOC                      PIC X(03).
          03 WSS-COD-LUGA.
               05 WSS-COD-COMU                       PIC X(04).
               05 WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
                  07 WSS-IND-PAIS                    PIC X(01).
                  07 WSS-COD-PAIS                    PIC X(03).
           03  WSS-UBFD.
               05  WSS-TAB-UBFD                      PIC X(03).
               05  WSS-COD-UBFD                      PIC X(12).
           03  WSS-MSC-TVOC                          PIC X(01).

       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRVEN.
       COPY COLBRRDC.
       COPY COLBRCYA.
       COPY COLBRICG.
       COPY COLBRROV.
       COPY COLBRITR.
       COPY COLBRCOM.
       COPY COLBRAUT.
       COPY COLBRDCC.
       COPY SGCBRDBC.
       COPY SGCBRRCD.
       COPY TABBRCAM.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRVLR.
      *DAD  ini 23-ABR-1991
       COPY TABBRTIO.
      *DAD  fin 23-ABR-1991
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
      *>>>>

      ***** CRW-COMIENZO

      *REPORT SECTION.
      *--------------
      *COPY COLRFOC1.
      *    .
      *COPY COLRTOC1.
      *<<<< RT
      *COPY COLRTOC2.
      *COPY COLRTDLC.
      *COPY COLRTEVC.
      *COPY COLRTVEN.
      *COPY COLRTRDC.
      *COPY COLRTCYA.
      *COPY COLRTICG.
      *>>>>

       01  RPT-VARIABLES.
           02 RPT-VARIABLES-VARIAS.
              03 RPT-VARI-LINEA              PIC 9(03) VALUE 66.
              03 RPT-VARI-PAGE-COUNTER       PIC 9(04).
           02 RPT-VARIABLES-CONTROL.
              03 RPT-CTRL-IIC-IOPC           PIC X(08) VALUE SPACES.

       01  PH-OC1.

           03  PH-OC1-01.
               05  RPT-HEAD-DUSU              PIC X(30).
               05  FILLER                     PIC X(030) VALUE SPACES.
               05  RPT-HEAD-FDMA              PIC 99B99B9999.

           03  PH-OC1-02.
               05  RPT-HEAD-DSIS              PIC X(30).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(8)
                   VALUE 'CREDITOS'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-MSC-STAT          PIC X(12).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(6)
                   VALUE 'PAGINA'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-PAGE-COUNTER      PIC ZZZZ.

           03  PH-OC1-03.
               05  FILLER                     PIC X(027) VALUE SPACES.
               05  FILLER                     PIC X(5)
                   VALUE 'DESDE'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-NUM-DINI          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-MINI          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-SINI          PIC X(2).
               05  RPT-HEAD-NUM-AINI          PIC X(2).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(5)
                   VALUE 'HASTA'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-NUM-DTER          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-MTER          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-HEAD-NUM-STER          PIC X(2).
               05  RPT-HEAD-NUM-ATER          PIC X(2).

           03  PH-OC1-04.
               05  FILLER                     PIC X(10)
                   VALUE 'T MONEDA :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-HEAD-MSC-TVOC          PIC X.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(10)
                   VALUE 'T OPERAC :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-COD-TOOC          PIC X(3).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  FILLER                     PIC X(9)
                   VALUE 'OFICINA :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-HEAD-COD-OFOC          PIC X(3).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(5)
                   VALUE 'NRO :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-HEAD-CAI-IOPC          PIC X(4).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-IIC-IOPC          PIC X(8).

           03  PH-OC1-05.
               05  RPT-HEAD-GLS-TVOC          PIC X(13).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-HEAD-GLS-TOOC          PIC X(14).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-HEAD-GLS-OFOC          PIC X(14).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(5)
                   VALUE 'CAN :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-HEAD-CAI-RENO          PIC X(4).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-HEAD-IIC-RENO          PIC X(8).

       01  DL-OC1.

           03  DL-OC1-06.
               05  FILLER                     PIC X(13)
                   VALUE 'DEUDOR DIR  :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-NOMC-OC1      PIC X(52).
               05  RPT-DETA-NUM-RENO          PIC ZZZ.

           03  DL-OC1-07.
               05  FILLER                     PIC X(13)
                   VALUE 'IDC DEUDOR  :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-ICLI-OC1      PIC ZZZZZZZZ.
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-VRF-ICLI-OC1      PIC X.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-ICLI-OC1      PIC X.
               05  RPT-DETA-IND-SCLI-OC1      PIC X.
               05  RPT-DETA-GLS-ICLI-OC1      PIC X(3).
               05  RPT-DETA-MSC-STAT          PIC X.
               05  FILLER                     PIC X(012) VALUE SPACES.
               05  FILLER                     PIC X(23)
                   VALUE 'NRO DIRECCION DEU DIR :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-DIRE-OC1      PIC ZZ.

           03  DL-OC1-08.
               05  FILLER                     PIC X(13)
                   VALUE 'DIRECCION   :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-DIRE-OC1      PIC X(55).

           03  DL-OC1-09.
               05  FILLER                     PIC X(15)
                   VALUE 'COMUNA O PAIS :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-COMU-OC1      PIC X(20).
               05  FILLER                     PIC X(007) VALUE SPACES.
               05  FILLER                     PIC X(12)
                   VALUE 'TELEFONO   :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-FONO-OC1      PIC X(12).

           03  DL-OC1-10.
               05  FILLER                     PIC X(15)
                   VALUE 'MONEDA CRED   :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-COD-VCOC          PIC X(6).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-VCOC-OC1      PIC X(15).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(19)
                   VALUE 'CODIGO AUXILIAR   :'.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-COD-AOOC          PIC X(3).

           03  DL-OC1-11.
               05  FILLER                     PIC X(15)
                   VALUE 'MONTO CREDITO :'.
               05  FILLER                     PIC X(006) VALUE SPACES.
               05  RPT-DETA-VAL-CRED          PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-AOOC          PIC X(26).

           03  DL-OC1-12.
               05  FILLER                     PIC X(15)
                   VALUE 'SALDO CREDITO :'.
               05  FILLER                     PIC X(006) VALUE SPACES.
               05  RPT-DETA-VAL-SCRE          PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(12)
                   VALUE 'LINEA CRED :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-CAI-ILDC          PIC X(4).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IIC-ILDC          PIC ZZZZZZZZ.

           03  DL-OC1-13.
               05  FILLER                     PIC X(15)
                   VALUE 'VENCTOS VIGS  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-VCVG          PIC ZZZ.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(13)
                   VALUE 'TIPO RENOV  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-RENO          PIC X(5).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(7)
                   VALUE 'V REN :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-RENO          PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.

           03  DL-OC1-14.
               05  FILLER                     PIC X(24)
                   VALUE 'CREDITO COMPLEMENTARIO :'.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-CAI-ICEN          PIC X(4).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IIC-ICEN          PIC ZZZZZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(19)
                   VALUE 'SEGURO DESGRAV    :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-COD-SEGD          PIC X(6).

           03  DL-OC1-15.
               05  FILLER                     PIC X(39)
                   VALUE 'CURSE COMP     CURSE REAL     CURSE CTB'.
               05  FILLER                     PIC X(1)
                   VALUE 'L'.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-SEGD          PIC X(26).

           03  DL-OC1-16.
               05  RPT-DETA-NUM-DINP          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MINP          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SINP          PIC 9(2).
               05  RPT-DETA-NUM-AINP          PIC 9(2).
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-NUM-DCOL          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MCOL          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SCOL          PIC 9(2).
               05  RPT-DETA-NUM-ACOL          PIC 9(2).
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-NUM-DING          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MING          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SING          PIC 9(2).
               05  RPT-DETA-NUM-AING          PIC 9(2).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(7)
                   VALUE 'V SEG :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-SEGD          PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.

           03  DL-OC1-17.
               05  FILLER                     PIC X(24)
                   VALUE 'TASA INTERES O SPREAD  :'.
               05  FILLER                     PIC X(007) VALUE SPACES.
               05  RPT-DETA-SGV-TINT-OC1-I    PIC ---9,9999.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(15)
                   VALUE 'TASA COMISION :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-SGV-TINT-OC1-C    PIC ----,----.

           03  DL-OC1-18.
               05  FILLER                     PIC X(19)
                   VALUE 'TIPO TASA INTERES :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-TINT          PIC X(20).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(12)
                   VALUE 'TIPO T COM :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-COD-TINT          PIC X(12).

           03  DL-OC1-19.
               05  FILLER                     PIC X(14)
                   VALUE 'CONDIC GTIAS :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-GARA          PIC X(3).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(18)
                   VALUE 'VCTOS ESTRUCT ?  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-IEVC          PIC X.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(8)
                   VALUE 'V COM  :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-SGV-VCOM          PIC ---.---.---,----.

           03  DL-OC1-20.
               05  FILLER                     PIC X(14)
                   VALUE 'CALC VAL FIN :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-MSC-MCVF          PIC X.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(18)
                   VALUE 'ANAL FERIADOS ?  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-AFER          PIC X.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(8)
                   VALUE 'GASTOS :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-VAL-GAST          PIC ZZZ.ZZZ.ZZZ,ZZZZ.

           03  DL-OC1-21.
               05  RPT-DETA-GLS-MCVF          PIC X(16).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(16)
                   VALUE 'ESTADO CREDITO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-STAT          PIC X(3).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(5)
                   VALUE 'LIQ :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-SGV-LIQU-OC1      PIC ---.---.---.---,----.

       01  CF-OC1-OPC-IIC-IOPC.

           03  CF-OC1-22.
               05  RPT-CTRL-GLS-BLKS          PIC X.

      *****************************************************************

       01  DL-OC2.

           03  DL-OC2-01.
               05  FILLER                     PIC X(21)
                   VALUE 'EJECUTIVO COMERCIAL :'.
               05  FILLER                     PIC X(007) VALUE SPACES.
               05  RPT-DETA-COD-RMOC          PIC X(12).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(7)
                   VALUE 'ABONO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-TCYA          PIC X(5).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-TCYA-OC2      PIC X(12).

           03  DL-OC2-02.
               05  RPT-DETA-GLS-RMOC          PIC X(40).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(11)
                   VALUE 'CTA ABONO :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-CAI-ICYA-OC2-C    PIC X(4).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IIC-ICYA-OC2      PIC ZZZZZZZZ.

           03  DL-OC2-03.
               05  FILLER                     PIC X(14)
                   VALUE 'DESTINO CRED :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-COD-CDOC          PIC X(3).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-GLS-CDOC          PIC X(19).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(11)
                   VALUE 'CTA CARGO :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-CAI-ICYA-OC2-A    PIC X(4).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IIC-IAUT          PIC ZZZZZZZZ.

      *****************************************************************

       01  DL-DLC.

           03  DL-DLC-01.
               05  FILLER                     PIC X(023) VALUE SPACES.
               05  FILLER                     PIC X(25)
                   VALUE 'DOCUMENTO LEGAL CREDITO :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-IDLC-DLC      PIC ZZZ.

           03  DL-DLC-02.
               05  FILLER                     PIC X(12)
                   VALUE 'DEUDOR IND :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-NOMC-DLC      PIC X(56).

           03  DL-DLC-03.
               05  FILLER                     PIC X(12)
                   VALUE 'IDC DEUDOR :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-ICLI-DLC      PIC ZZZZZZZZ.
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-VRF-ICLI-DLC      PIC X.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-ICLI-DLC      PIC X.
               05  RPT-DETA-IND-SCLI-DLC      PIC X.
               05  RPT-DETA-GLS-ICLI-DLC      PIC X(3).
               05  FILLER                     PIC X(012) VALUE SPACES.
               05  FILLER                     PIC X(23)
                   VALUE 'NRO DIRECCION DEU IND :'.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-NUM-DIRE-DLC      PIC ZZ.

           03  DL-DLC-04.
               05  FILLER                     PIC X(12)
                   VALUE 'DIRECCION  :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-DIRE-DLC      PIC X(56).

           03  DL-DLC-05.
               05  FILLER                     PIC X(19)
                   VALUE 'COMUNA O PAIS     :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-COMU-DLC      PIC X(18).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(15)
                   VALUE 'TELEFONO      :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-FONO-DLC      PIC X(12).

           03  DL-DLC-06.
               05  FILLER                     PIC X(042) VALUE SPACES.
               05  FILLER                     PIC X(15)
                   VALUE 'TASA INTERES  :'.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-SGV-TINT-DLC      PIC ----,----.

           03  DL-DLC-07.
               05  FILLER                     PIC X(19)
                   VALUE 'VALOR DOCUMENTO   :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-NDLC          PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(15)
                   VALUE 'TIPO TASA INT :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-TIPT          PIC X(12).

           03  DL-DLC-08.
               05  FILLER                     PIC X(19)
                   VALUE 'SALDO DOCUMENTO   :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-SDLC          PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(22)
                   VALUE 'CLASIFICACION RIESGO :'.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-IND-RIES          PIC X(2).

           03  DL-DLC-09.
               05  FILLER                     PIC X(19)
                   VALUE 'TIPO  DOCUMENTO   :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-COD-TDOC          PIC X(3).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-GLS-TDOC          PIC X(12).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(18)
                   VALUE 'UBICACION FISICA :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-COD-UBFD          PIC X(9).

           03  DL-DLC-10.
               05  FILLER                     PIC X(19)
                   VALUE 'TIPO  IMPUESTOS   :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-MSC-TIMP          PIC X.
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-GLS-TIMP          PIC X(12).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-UBFD          PIC X(28).

           03  DL-DLC-11.
               05  FILLER                     PIC X(19)
                   VALUE 'VALOR IMPUESTOS $ :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-IMPU          PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(18)
                   VALUE 'PLAZA DE COBRO   :'.
               05  FILLER                     PIC X(006) VALUE SPACES.
               05  RPT-DETA-COD-PLZA          PIC X(4).

           03  DL-DLC-12.
               05  FILLER                     PIC X(9)
                   VALUE 'NOTARIA :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-COD-NOTC          PIC X(6).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-NOTC          PIC X(18).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-PLZA          PIC X(20).

           03  DL-DLC-13.
               05  FILLER                     PIC X(19)
                   VALUE 'GASTOS  NOTARIA $ :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-GNOT          PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(18)
                   VALUE 'PLAZO CONTABLE   :'.
               05  FILLER                     PIC X(008) VALUE SPACES.
               05  RPT-DETA-COD-PLZO          PIC X(2).

           03  DL-DLC-14.
               05  FILLER                     PIC X(19)
                   VALUE 'INTS PERIODOS ESP :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-MSC-MIPL          PIC X.
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-GLS-MIPL          PIC X(12).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-PLZO          PIC X(28).

           03  DL-DLC-15.
               05  FILLER                     PIC X(19)
                   VALUE 'INTS PENDIENTES   :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-IPEN          PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(20)
                   VALUE 'SITUACION CARTERA  :'.
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-IND-SCRT          PIC X(3).

           03  DL-DLC-16.
               05  FILLER                     PIC X(26)
                   VALUE 'ULT PAGO TOTAL INTERESES :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-DDEV          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MDEV          PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SDEV          PIC 9(2).
               05  RPT-DETA-NUM-ADEV          PIC 9(2).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(20)
                   VALUE 'SITUACION CONTABLE :'.
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-IND-SCTB-DLC      PIC X(3).

           03  DL-DLC-17.
               05  FILLER                     PIC X(19)
                   VALUE 'REAJUSTES DEVENG  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-READ          PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(20)
                   VALUE 'SITUACION COBRANZA :'.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-IND-SCBZ-DLC      PIC X(5).

           03  DL-DLC-18.
               05  FILLER                     PIC X(19)
                   VALUE 'INTERESES DEVENG  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-INTD          PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(24)
                   VALUE 'TIPO OPERACION ANTIGUO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-COD-TOSB          PIC X(3).

      *****************************************************************

       01  DL-EVC.

           03  DL-EVC-01.
               05  FILLER                     PIC X(021) VALUE SPACES.
               05  FILLER                     PIC X(33)
                   VALUE 'ESTRUCTURA VENCIMIENTOS CREDITO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-IEVC          PIC ZZZ.

           03  DL-EVC-02.
               05  FILLER                     PIC X(22)
                   VALUE 'DURACION TOTAL VCTOS :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-DURV          PIC ZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(36)
                   VALUE 'PERTENECE A DOCUMENTO LEGAL NUMERO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-IDLC-EVC      PIC ZZZ.

           03  DL-EVC-03.
               05  FILLER                     PIC X(14)
                   VALUE 'EXPRESADA EN :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-UTDV          PIC X.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-GLS-UTDV          PIC X(7).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(26)
                   VALUE 'FECHA PRIMER VENCIMIENTO :'.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-NUM-DPVC          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MPVC          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SPVC          PIC X(2).
               05  RPT-DETA-NUM-APVC          PIC X(2).

           03  DL-EVC-04.
               05  FILLER                     PIC X(22)
                   VALUE 'TOTAL VCTOS GRUPO    :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-VIGU          PIC ZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(26)
                   VALUE 'DIA DE VENCIMIENTOS      :'.
               05  FILLER                     PIC X(012) VALUE SPACES.
               05  RPT-DETA-NUM-DPVE          PIC ZZ.

           03  DL-EVC-05.
               05  FILLER                     PIC X(22)
                   VALUE 'PERIODO PRIMER VCTO  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-SPVE          PIC ZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(37)
                   VALUE 'VALOR VENCIMIENTO CALCULADO EN BASE :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-MSC-TCVE          PIC X(2).

           03  DL-EVC-06.
               05  FILLER                     PIC X(14)
                   VALUE 'EXPRESADO EN :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-UTPV          PIC X.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-GLS-UTPV          PIC X(7).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-TCVE          PIC X(40).

           03  DL-EVC-07.
               05  FILLER                     PIC X(22)
                   VALUE 'DESFASE EN DIAS      :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-DESD          PIC ZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(19)
                   VALUE 'VALOR VENCIMIENTO :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-VAL-VENC          PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.

           03  DL-EVC-08.
               05  FILLER                     PIC X(22)
                   VALUE 'PERIODO ENTRE VCTOS  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-SEVE          PIC ZZZ.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(14)
                   VALUE 'EXPRESADO EN :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-VCOC-EVC      PIC X(25).

           03  DL-EVC-09.
               05  FILLER                     PIC X(14)
                   VALUE 'EXPRESADO EN :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-UTSV          PIC X.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-GLS-UTSV          PIC X(7).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(19)
                   VALUE 'FACTOR VARIACION  :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-SGV-FVAR          PIC --.---.---.---,----.

           03  DL-EVC-10.
               05  FILLER                     PIC X(22)
                   VALUE 'CARGO AUTOMATICO ?   :'.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-IND-CAUT-EVC      PIC X.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(37)
                   VALUE 'EXPRESADO EN ( MONTO O PORCENTAJE ) :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-IND-FVAR          PIC X.

      *****************************************************************

       01  DL-VEN.

           03  DL-VEN-01.
               05  FILLER                     PIC X(029) VALUE SPACES.
               05  FILLER                     PIC X(21)
                   VALUE 'VENCIMIENTO CREDITO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-IVEN          PIC ZZZ.

           03  DL-VEN-02.
               05  FILLER                     PIC X(21)
                   VALUE 'PERTENECE DOCUMENTO :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-IDLC-VEN      PIC ZZZ.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  FILLER                     PIC X(9)
                   VALUE 'MONEDA  :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-VCOC-VEN      PIC X(30).

           03  DL-VEN-03.
               05  FILLER                     PIC X(15)
                   VALUE 'F VENCIMIENTO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-DVEN          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MVEN          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SVEN          PIC X(2).
               05  RPT-DETA-NUM-AVEN          PIC X(2).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  FILLER                     PIC X(21)
                   VALUE 'VALOR CAPITAL VCTO  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-CAPI          PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.

           03  DL-VEN-04.
               05  FILLER                     PIC X(15)
                   VALUE 'F INICIO MORA :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-DIMV          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MIMV          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SIMV          PIC X(2).
               05  RPT-DETA-NUM-AIMV          PIC X(2).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  FILLER                     PIC X(21)
                   VALUE 'SALDO VALOR CAPITAL :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-SCAP          PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.

           03  DL-VEN-05.
               05  FILLER                     PIC X(20)
                   VALUE 'SITUACION CONTABLE :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-SCTB-VEN      PIC X(5).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  FILLER                     PIC X(21)
                   VALUE 'INTS NO INCLUIDOS   :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-IDNI          PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.

           03  DL-VEN-06.
               05  FILLER                     PIC X(20)
                   VALUE 'SITUACION COBRANZA :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-SCBZ-VEN      PIC X(5).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  FILLER                     PIC X(21)
                   VALUE 'VALOR FINAL VCTO    :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-FINA          PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.

           03  DL-VEN-07.
               05  FILLER                     PIC X(20)
                   VALUE 'CARGO AUTOMATICO ? :'.
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-IND-CAUT-VEN      PIC X.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  FILLER                     PIC X(21)
                   VALUE 'SALDO VALOR FINAL   :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-SFIN          PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.

      *****************************************************************

       01  DL-HRDC.

           03  DL-HRD-01.
               05  FILLER                     PIC X(026) VALUE SPACES.
               05  FILLER                     PIC X(8)
                   VALUE 'DEUDORES'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-TDEU          PIC X(10).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-DOCU          PIC X(9).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-IDLC-HRD      PIC ZZZ.

       01  DL-RDC.

           03  DL-RDC-02.
               05  FILLER                     PIC X(11)
                   VALUE 'NOMBRE    :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-NOMC-RDC      PIC X(58).

           03  DL-RDC-03.
               05  FILLER                     PIC X(11)
                   VALUE 'IDC (RUT) :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-ICLI-RDC      PIC X(8).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-VRF-ICLI-RDC      PIC X.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IND-ICLI-RDC      PIC X.
               05  RPT-DETA-IND-SCLI-RDC      PIC X.
               05  RPT-DETA-GLS-ICLI-RDC      PIC X(3).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(8)
                   VALUE 'LIMITE :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-LIMD          PIC ZZZ,ZZZZZ.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  FILLER                     PIC X(1)
                   VALUE ALL '%'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-VAL-MONL          PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.

           03  DL-RDC-04.
               05  FILLER                     PIC X(11)
                   VALUE 'DIRECCION :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-DIRE          PIC X(58).

           03  DL-RDC-05.
               05  FILLER                     PIC X(11)
                   VALUE 'TELEFONO  :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-FONO          PIC X(12).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(5)
                   VALUE 'NRO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-DIRE-RDC      PIC ZZ.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  FILLER                     PIC X(13)
                   VALUE 'COMUNA/PAIS :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-COMU-RDC      PIC X(20).

           03  DL-RDC-06.
               05  FILLER                     PIC X(70)
                   VALUE ALL '-'.

      *****************************************************************

       01  DL-HCYA.

           03  DL-HCY-01.
               05  FILLER                     PIC X(028) VALUE SPACES.
               05  RPT-DETA-GLS-TIPM          PIC X(6).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  FILLER                     PIC X(7)
                   VALUE 'CREDITO'.

           03  DL-HCY-02.
               05  FILLER                     PIC X(3)
                   VALUE 'NRO'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-TMOV-1        PIC X(5).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  FILLER                     PIC X(15)
                   VALUE 'A        CUENTA'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-TMOV-2        PIC X(5).
               05  FILLER                     PIC X(008) VALUE SPACES.
               05  RPT-DETA-GLS-TMOV-3        PIC X(5).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'EN'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-VCOC-HCY      PIC X(5).
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-GLS-TMOV-4        PIC X(5).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  FILLER                     PIC X(8)
                   VALUE 'EN PESOS'.

           03  DL-HCY-03.
               05  FILLER                     PIC X(70)
                   VALUE ALL '-'.

       01  DL-CYA.

           03  DL-CYA-04.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-ICYA          PIC Z.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-GLS-TCYA-CYA      PIC X(12).
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-CAI-ICYA-CYA      PIC X(4).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IIC-ICYA-CYA      PIC ZZZZZZZZ.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-SGV-LIQU-CYA      PIC --.---.---.---,----.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-VAL-VPES          PIC --.---.---.---.

      *****************************************************************

       01  DL-ICG.

           03  DL-ICG-01.
               05  FILLER                     PIC X(026) VALUE SPACES.
               05  FILLER                     PIC X(24)
                   VALUE 'TASA DE INTERES NUMERO :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-TASA          PIC ZZZ.

           03  DL-ICG-02.
               05  FILLER                     PIC X(19)
                   VALUE 'F INICIO VIGENCIA :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-DINI          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MINI          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SINI          PIC X(2).
               05  RPT-DETA-NUM-AINI          PIC X(2).

           03  DL-ICG-03.
               05  FILLER                     PIC X(19)
                   VALUE 'TIPO TASA BASE    :'.
               05  FILLER                     PIC X(010) VALUE SPACES.
               05  RPT-DETA-MSC-BCTI          PIC X.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(29)
                   VALUE 'PERIODO BASE TASA           :'.
               05  FILLER                     PIC X(006) VALUE SPACES.
               05  RPT-DETA-MSC-PBTI          PIC X.

           03  DL-ICG-04.
               05  RPT-DETA-GLS-BCTI          PIC X(30).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-PBTI          PIC X(36).

           03  DL-ICG-05.
               05  FILLER                     PIC X(28)
                   VALUE 'MODO CALCULO BAJO PDO BASE :'.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-MSC-BPBT          PIC X.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(29)
                   VALUE 'MODO CALCULO SOBRE PDO BASE :'.
               05  FILLER                     PIC X(006) VALUE SPACES.
               05  RPT-DETA-MSC-SPBT          PIC X.

           03  DL-ICG-06.
               05  RPT-DETA-GLS-BPBT          PIC X(30).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-SPBT          PIC X(36).

           03  DL-ICG-07.
               05  FILLER                     PIC X(20)
                   VALUE 'BASE TASA VARIABLE :'.
               05  FILLER                     PIC X(007) VALUE SPACES.
               05  RPT-DETA-COD-CVTI          PIC X(3).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(29)
                   VALUE 'TIPO FECHA PERIODO REPACTO  :'.
               05  FILLER                     PIC X(006) VALUE SPACES.
               05  RPT-DETA-MSC-TFPR          PIC X.

           03  DL-ICG-08.
               05  RPT-DETA-GLS-CVTI          PIC X(30).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  RPT-DETA-GLS-TFPR          PIC X(36).

           03  DL-ICG-09.
               05  FILLER                     PIC X(20)
                   VALUE 'PERIODO DE REPACTO :'.
               05  FILLER                     PIC X(007) VALUE SPACES.
               05  RPT-DETA-NUM-PREP          PIC ZZZ.

           03  DL-ICG-10.
               05  FILLER                     PIC X(14)
                   VALUE 'EXPRESADO EN :'.
               05  FILLER                     PIC X(005) VALUE SPACES.
               05  RPT-DETA-MSC-UTPR          PIC X.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-GLS-UTPR          PIC X(7).
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(24)
                   VALUE 'FECHA TERMINO VIGENCIA :'.
               05  FILLER                     PIC X(002) VALUE SPACES.
               05  RPT-DETA-NUM-DTER          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MTER          PIC X(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-STER          PIC X(2).
               05  RPT-DETA-NUM-ATER          PIC X(2).

           03  DL-ICG-11.
               05  FILLER                     PIC X(14)
                   VALUE 'VALOR SPREAD :'.
               05  FILLER                     PIC X(007) VALUE SPACES.
               05  RPT-DETA-SGV-SPRD          PIC ---9,9999.
               05  FILLER                     PIC X(004) VALUE SPACES.
               05  FILLER                     PIC X(24)
                   VALUE 'VALOR TASA INTERES     :'.
               05  FILLER                     PIC X(003) VALUE SPACES.
               05  RPT-DETA-SGV-TINT-ICG      PIC ---9,9999.

      ***** CRW-FINAL


       PROCEDURE DIVISION.
      *==================

      ***** CRW-COMIENZO
      *DECLARATIVES.
      ***** CRW-FINAL

       DEC-CF-OC1-OPC-COD-OFOC SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-OC1-OPC-COD-OFOC.
      ***** CRW-FINAL

       INI-CF-OC1-OPC-COD-OFOC.
       FIN-CF-OC1-OPC-COD-OFOC.
           EXIT.
       DEC-CF-OC1-OPC-CAI-IOPC SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-OC1-OPC-CAI-IOPC.
      ***** CRW-FINAL

       INI-CF-OC1-OPC-CAI-IOPC.
       FIN-CF-OC1-OPC-CAI-IOPC.
           EXIT.
       DEC-CF-OC1-OPC-IIC-IOPC SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-OC1-OPC-IIC-IOPC.
      ***** CRW-FINAL

       INI-CF-OC1-OPC-IIC-IOPC.
       FIN-CF-OC1-OPC-IIC-IOPC.
           EXIT.
       DEC-CF-OC1-OPC-MSC-STAT SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-OC1-OPC-MSC-STAT.
      ***** CRW-FINAL

       INI-CF-OC1-OPC-MSC-STAT.
       FIN-CF-OC1-OPC-MSC-STAT.
           EXIT.
       DEC-CF-OC1-OPC-NUM-DCOL SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-OC1-OPC-NUM-DCOL.
      ***** CRW-FINAL

       INI-CF-OC1-OPC-NUM-DCOL.
       FIN-CF-OC1-OPC-NUM-DCOL.
           EXIT.
       DEC-CF-OC1-OPC-NUM-MCOL SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-OC1-OPC-NUM-MCOL.
      ***** CRW-FINAL

       INI-CF-OC1-OPC-NUM-MCOL.
       FIN-CF-OC1-OPC-NUM-MCOL.
           EXIT.
       DEC-CF-OC1-OPC-NUM-SCOL SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-OC1-OPC-NUM-SCOL.
      ***** CRW-FINAL

       INI-CF-OC1-OPC-NUM-SCOL.
       FIN-CF-OC1-OPC-NUM-SCOL.
           EXIT.
       DEC-CF-OC1-OPC-NUM-ACOL SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING CF-OC1-OPC-NUM-ACOL.
      ***** CRW-FINAL

       INI-CF-OC1-OPC-NUM-ACOL.
       FIN-CF-OC1-OPC-NUM-ACOL.
           EXIT.
       DEC-PH-OC1 SECTION.

      ***** CRW-COMIENZO
      *    USE BEFORE REPORTING PH-OC1.
      ***** CRW-FINAL

       INI-PH-OC1.
      *<<<< PH_OC1
           IF OPC-MSC-TVOC IN SRT > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'TVAL'              TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-TVOC IN SRT TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TVOC IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-TVOC IN WSS-OC1.

           IF OPC-COD-TOOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOOC IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-TOOC IN WSS-OC1.

           IF OPC-MSC-STAT IN SRT > SPACES
               MOVE 'GNS'               TO TAB-COD-SIST
               MOVE 'STT'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-MSC-STAT IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-MSC-STAT IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-MSC-STAT IN WSS-OC1.
      *>>>>
       FIN-PH-OC1.
           EXIT.

      ***** CRW-COMIENZO
      *END DECLARATIVES.
      ***** CRW-FINAL


       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPLROI' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           SORT GNSSRT
       COPY COLRSOC1.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *Captura Centro asignacion de Operacion
           DISPLAY 'ASIGNACION OPERACION : '.
           ACCEPT  WSS-CAI-IOPC IN WSS-VARI.
           DISPLAY WSS-CAI-IOPC IN WSS-VARI.
      *Captura Codigo de Operacion
           DISPLAY 'IDENTIFICACION OPERACION : '.
           ACCEPT  WSS-IIC-IOPC IN WSS-VARI.
           DISPLAY WSS-IIC-IOPC IN WSS-VARI.
      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMAAAA ) : '
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.
      *Captura Status
           DISPLAY 'STATUS : '.
           ACCEPT  WSS-MSC-STAT IN WSS-VARI.
           DISPLAY WSS-MSC-STAT IN WSS-VARI.

           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.
           IF WSS-MSC-STAT IN WSS-VARI > SPACES AND
              WSS-MSC-STAT IN WSS-VARI NOT = '*'
               MOVE 'GNS'                    TO TAB-COD-SIST
               MOVE 'STT'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-MSC-STAT IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-MENS IN MSG
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.

           MOVE 'TAB'    TO FIO-SIST.
           MOVE 'VLR'    TO TAB-CIC-TTAB.
           MOVE '0999  ' TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT  FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE TAB-COD-CTAB IN TAB TO CAM-COD-MNAC IN CAM-VARI.

           IF WSS-CIC-IOPC IN WSS-VARI > SPACES
               IF WSS-CIC-IOPC IN WSS-VARI = '*'
                   MOVE '*' TO WSS-IND-SEL1 IN WSS-VARI
                   GO TO NXT-INP
               ELSE
                   MOVE 'O' TO WSS-IND-SEL1 IN WSS-VARI
                   GO TO NXT-INP.

      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DINI IN WSS-OC1.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MINI IN WSS-OC1.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SINI IN WSS-OC1.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AINI IN WSS-OC1.
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DTER IN WSS-OC1
                                            WSS-NUM-DCMP IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MTER IN WSS-OC1
                                            WSS-NUM-MCMP IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-STER IN WSS-OC1
                                            WSS-NUM-SCMP IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ATER IN WSS-OC1
                                            WSS-NUM-ACMP IN WSS-VARI.

           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               DISPLAY WSS-COD-OFIC IN WSS-VARI
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY MSG-GLS-MENS
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.
       NXT-INP.
           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
      *>>>>
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       FST-INP-SRT.
      *<<<< INI_FST_INP
           IF WSS-IND-SEL1 IN WSS-VARI = '*'
               GO TO CON-INP-SRT
           ELSE
           IF WSS-IND-SEL1 IN WSS-VARI = 'O'
               MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPC    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                            OPC-IIC-IOPC IN SRT
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT
               ELSE
                   GO TO LUP-INP-SRT.

           MOVE WSS-NUM-DINI IN WSS-VARI TO OPC-NUM-DINP IN OPC.
           MOVE WSS-NUM-MINI IN WSS-VARI TO OPC-NUM-MINP IN OPC.
           MOVE WSS-NUM-SINI IN WSS-VARI TO OPC-NUM-SINP IN OPC.
           MOVE WSS-NUM-AINI IN WSS-VARI TO OPC-NUM-AINP IN OPC.
           MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           IF OPC-FEC-FINP IN OPC > WSS-FEC-FCMP IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT
           ELSE
               GO TO LUP-INP-SRT.
       CON-INP-SRT.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
      *DAD  ini 13-MAY-1991
      * Verifica Credito tenga Saldo
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO NXT-INP-SRT.
      *DAD  fin 13-MAY-1991

      *DAD  ini 23-ABR-1991
      * Mediante BUS-TAB Busca Sistema Valido en Tabla TIO para Operacio
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
               DISPLAY MSG-GLS-DESC ' : ' TAB-COD-TABL
               GO TO NXT-INP-SRT.

      * Obtiene Sistema Valido de la Operacion de Credito
           MOVE TAB TO TIO.
           IF TIO-GLS-SIST IN TIO NOT = 'COL'
               GO TO NXT-INP-SRT.
      *DAD  fin 23-ABR-1991

      * Compara Oficina del Parametro con la Oficina del Credito
           IF WSS-CIC-IOPC IN WSS-VARI NOT > SPACES AND
              WSS-COD-OFIC IN WSS-VARI     > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFIC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO NXT-INP-SRT.

      * Compara Status del Parametro con el Status del Credito
           IF WSS-MSC-STAT IN WSS-VARI > SPACES AND
              WSS-MSC-STAT IN WSS-VARI NOT = '*'
               IF WSS-MSC-STAT IN WSS-VARI NOT = OPC-MSC-STAT IN OPC
                   GO TO NXT-INP-SRT.

           PERFORM GET-DLC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-INP-SRT.

           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM GET-VEN
           ELSE
               PERFORM GET-EVC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-INP-SRT.

           IF CAM-COD-MNAC IN CAM-VARI NOT = OPC-COD-VCOC IN OPC
               MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1)
               MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE CAM-COD-MNAC IN CAM-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'CODVCAMNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ':' OPC-FEC-FCOL IN OPC '/'
                                            OPC-COD-VCOC IN OPC '/'
                                            CAM-COD-MNAC IN CAM-VARI '/'
                                            OPC-CIC-IOPC IN OPC
                   GO TO NXT-INP-SRT
               ELSE
                   IF CAM-IND-VIGE NOT = 'S'
                       MOVE 'COL'       TO MSG-COD-SIST
                       MOVE 'VALCAMNVG' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC ':' OPC-FEC-FCOL IN OPC '/'
                                                OPC-COD-VCOC IN OPC '/'
                                                CAM-COD-MNAC IN CAM-VARI
                                                '/' OPC-CIC-IOPC IN OPC
                       GO TO NXT-INP-SRT.

           MOVE OPC-IND-VSTR IN OPC TO SRT-IND-IEVC IN SRT.
      *>>>>
       MOV-INP-SRT.
       COPY COLRMOC1.
      *<<<< RM
       COPY COLRMOC2.
      *>>>>
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
           IF WSS-IND-SEL1 IN WSS-VARI = 'O'
               GO TO FIN-INP-SRT.
           IF WSS-CIC-IOPC IN WSS-VARI NOT > SPACES
               MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
      *<<<< FIN_NXT_INP
           IF WSS-IND-SEL1 IN WSS-VARI = '*'
               GO TO LUP-INP-SRT.
           IF OPC-FEC-FINP IN OPC > WSS-FEC-FCMP IN WSS-VARI
               GO TO FIN-INP-SRT.
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-OPC.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
           OPEN OUTPUT RPTOC1.
           CALL 'GNSPLHDR' USING RPT-VARI.

      ***** CRW-COMIENZO
      *    INITIATE RPT-OC1.
      ***** CRW-FINAL

           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.

      ***** CRW-COMIENZO
           MOVE OPC-IIC-IOPC IN SRT TO RPT-CTRL-IIC-IOPC.
      ***** CRW-FINAL

       LUP-OUT-SRT.
      *<<<< LUP_OUT
           PERFORM BUS-OPC-FIL-ANX.
           IF NOT FIO-STAT-OKS
               GO TO NXT-OUT-SRT.

           PERFORM BUS-GLS-OPC.
           MOVE ZEROES TO WSS-MUL-DEUD IN WSS-VARI.
           PERFORM BUS-DEU-DIR.
      *>>>>
       GEN-OUT-SRT.

      ***** CRW-COMIENZO
      *    GENERATE DL-OC1.
           PERFORM GENERATE-DL-OC1.
      ***** CRW-FINAL

      *<<<< FIN_GEN_OUT
           MOVE CYA-IIC-ICYA IN CYA TO WSS-IIC-ICYA IN WSS-OC2.
           MOVE AUT-IIC-ICYA IN AUT TO WSS-IIC-IAUT IN WSS-OC2.

      ***** CRW-COMIENZO
      *    GENERATE DL-OC2.
           PERFORM GENERATE-DL-OC2.
      ***** CRW-FINAL

           PERFORM GET-DLC-OPC.
           IF WSS-MUL-FSTD IN WSS-VARI = 1
      *ALD Solo IBM
      *        MOVE '67' TO LINE-COUNTER
               MOVE 67 TO RPT-VARI-LINEA
      *
               MOVE WSS-NUM-FSTD IN WSS-VARI TO DLC-NUM-IDLC IN DLC
               PERFORM GET-IND-RDC
               PERFORM GET-DIR-RDC
               PERFORM GET-ABN-CYA
               PERFORM GET-INT-ICG
           ELSE
           IF WSS-MUL-DEUD IN WSS-VARI = 1
      *ALD Solo IBM
      *        MOVE '67' TO LINE-COUNTER
               MOVE 67 TO RPT-VARI-LINEA
      *
               PERFORM GET-DIR-RDC
               PERFORM GET-ABN-CYA
               PERFORM GET-INT-ICG
           ELSE
               IF WSS-MUL-CYA IN WSS-VARI = 1
      *ALD Solo IBM
      *            MOVE '67' TO LINE-COUNTER
                   MOVE 67 TO RPT-VARI-LINEA
      *
                   PERFORM GET-ABN-CYA
                   PERFORM GET-INT-ICG
               ELSE
                   IF WSS-MUL-ICG IN WSS-VARI = 1
      *ALD Solo IBM
      *                MOVE '67' TO LINE-COUNTER
                       MOVE 67 TO RPT-VARI-LINEA
      *
                       PERFORM GET-INT-ICG.
      *>>>>
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.

      ***** CRW-COMIENZO
      *    TERMINATE RPT-OC1.
      ***** CRW-FINAL

           CLOSE RPTOC1.

           GO TO EXT-OUT-SRT.

      ***** CRW-COMIENZO

       GENERATE-DL-OC1.
      *****************

           IF RPT-VARI-LINEA > 65 OR RPT-VARI-PAGE-COUNTER = 0 OR
              OPC-IIC-IOPC IN SRT NOT = RPT-CTRL-IIC-IOPC
              MOVE OPC-IIC-IOPC IN SRT TO RPT-CTRL-IIC-IOPC
              PERFORM TITULOS
           END-IF.
           MOVE DBC-GLS-NOMC            TO RPT-DETA-GLS-NOMC-OC1
           MOVE WSS-NUM-RENO IN WSS-OC1 TO RPT-DETA-NUM-RENO
           MOVE DBC-NUM-ICLI            TO RPT-DETA-NUM-ICLI-OC1
           MOVE DBC-VRF-ICLI            TO RPT-DETA-VRF-ICLI-OC1
           MOVE DBC-IND-ICLI            TO RPT-DETA-IND-ICLI-OC1
           MOVE WSS-IND-SCLI IN WSS-OC1 TO RPT-DETA-IND-SCLI-OC1
           MOVE DBC-GLS-ICLI            TO RPT-DETA-GLS-ICLI-OC1
           MOVE SPACES                  TO RPT-DETA-MSC-STAT
           MOVE RCD-NUM-DIRE            TO RPT-DETA-NUM-DIRE-OC1
           MOVE RCD-GLS-DIRE            TO RPT-DETA-GLS-DIRE-OC1
           MOVE WSS-GLS-COMU IN WSS-OC1 TO RPT-DETA-GLS-COMU-OC1
           MOVE RCD-GLS-FONO            TO RPT-DETA-GLS-FONO-OC1
           MOVE OPC-COD-VCOC IN SRT     TO RPT-DETA-COD-VCOC
           MOVE WSS-GLS-VCOC IN WSS-OC1 TO RPT-DETA-GLS-VCOC-OC1
           MOVE OPC-COD-AOOC IN SRT     TO RPT-DETA-COD-AOOC
           MOVE OPC-VAL-CRED IN SRT     TO RPT-DETA-VAL-CRED
           MOVE WSS-GLS-AOOC IN WSS-OC1 TO RPT-DETA-GLS-AOOC
           MOVE OPC-VAL-SCRE IN SRT     TO RPT-DETA-VAL-SCRE
           MOVE OPC-CAI-ILDC IN SRT     TO RPT-DETA-CAI-ILDC
           MOVE OPC-IIC-ILDC IN SRT     TO RPT-DETA-IIC-ILDC
           MOVE OPC-NUM-VCVG IN SRT     TO RPT-DETA-NUM-VCVG
           MOVE OPC-IND-RENO IN SRT     TO RPT-DETA-IND-RENO
           MOVE WSS-VAL-RENO IN WSS-OC1 TO RPT-DETA-VAL-RENO
           MOVE OPC-CAI-ICEN IN SRT     TO RPT-DETA-CAI-ICEN
           MOVE OPC-IIC-ICEN IN SRT     TO RPT-DETA-IIC-ICEN
           MOVE OPC-COD-SEGD IN SRT     TO RPT-DETA-COD-SEGD
           MOVE WSS-GLS-SEGD IN WSS-OC1 TO RPT-DETA-GLS-SEGD
           MOVE OPC-NUM-DINP IN SRT     TO RPT-DETA-NUM-DINP
           MOVE OPC-NUM-MINP IN SRT     TO RPT-DETA-NUM-MINP
           MOVE OPC-NUM-SINP IN SRT     TO RPT-DETA-NUM-SINP
           MOVE OPC-NUM-AINP IN SRT     TO RPT-DETA-NUM-AINP
           MOVE OPC-NUM-DCOL IN SRT     TO RPT-DETA-NUM-DCOL
           MOVE OPC-NUM-MCOL IN SRT     TO RPT-DETA-NUM-MCOL
           MOVE OPC-NUM-SCOL IN SRT     TO RPT-DETA-NUM-SCOL
           MOVE OPC-NUM-ACOL IN SRT     TO RPT-DETA-NUM-ACOL
           MOVE OPC-NUM-DING IN SRT     TO RPT-DETA-NUM-DING
           MOVE OPC-NUM-MING IN SRT     TO RPT-DETA-NUM-MING
           MOVE OPC-NUM-SING IN SRT     TO RPT-DETA-NUM-SING
           MOVE OPC-NUM-AING IN SRT     TO RPT-DETA-NUM-AING
           MOVE OPC-VAL-SEGD IN SRT     TO RPT-DETA-VAL-SEGD
           MOVE ITR-SGV-TINT            TO RPT-DETA-SGV-TINT-OC1-I
           MOVE COM-SGV-TINT            TO RPT-DETA-SGV-TINT-OC1-C
           MOVE WSS-GLS-TINT IN WSS-OC1 TO RPT-DETA-GLS-TINT
           MOVE COM-COD-TINT            TO RPT-DETA-COD-TINT
           MOVE OPC-IND-GARA IN SRT     TO RPT-DETA-IND-GARA
           MOVE SRT-IND-IEVC IN SRT     TO RPT-DETA-IND-IEVC
           MOVE OPC-SGV-VCOM IN SRT     TO RPT-DETA-SGV-VCOM
           MOVE OPC-MSC-MCVF IN SRT     TO RPT-DETA-MSC-MCVF
           MOVE OPC-IND-AFER IN SRT     TO RPT-DETA-IND-AFER
           MOVE OPC-VAL-GAST IN SRT     TO RPT-DETA-VAL-GAST
           MOVE WSS-GLS-MCVF IN WSS-OC1 TO RPT-DETA-GLS-MCVF
           MOVE WSS-GLS-STAT IN WSS-OC1 TO RPT-DETA-GLS-STAT
           MOVE OPC-SGV-LIQU IN SRT     TO RPT-DETA-SGV-LIQU-OC1
           WRITE RPTOC1-REG FROM  DL-OC1-06
           WRITE RPTOC1-REG FROM  DL-OC1-07
           WRITE RPTOC1-REG FROM  DL-OC1-08
           WRITE RPTOC1-REG FROM  DL-OC1-09
           WRITE RPTOC1-REG FROM  DL-OC1-10
           WRITE RPTOC1-REG FROM  DL-OC1-11
           WRITE RPTOC1-REG FROM  DL-OC1-12
           WRITE RPTOC1-REG FROM  DL-OC1-13
           WRITE RPTOC1-REG FROM  DL-OC1-14
           WRITE RPTOC1-REG FROM  DL-OC1-15
           WRITE RPTOC1-REG FROM  DL-OC1-16
           WRITE RPTOC1-REG FROM  DL-OC1-17
           WRITE RPTOC1-REG FROM  DL-OC1-18
           WRITE RPTOC1-REG FROM  DL-OC1-19
           WRITE RPTOC1-REG FROM  DL-OC1-20
           WRITE RPTOC1-REG FROM  DL-OC1-21
           ADD 16 TO RPT-VARI-LINEA.

       GENERATE-DL-OC2.
      *****************
           MOVE OPC-COD-RMOC IN SRT     TO RPT-DETA-COD-RMOC
           MOVE CYA-IND-TCYA            TO RPT-DETA-IND-TCYA
           MOVE WSS-GLS-TCYA IN WSS-OC2 TO RPT-DETA-GLS-TCYA-OC2
           MOVE WSS-GLS-RMOC IN WSS-OC2 TO RPT-DETA-GLS-RMOC
           MOVE CYA-CAI-ICYA            TO RPT-DETA-CAI-ICYA-OC2-C
           MOVE WSS-IIC-ICYA IN WSS-OC2 TO RPT-DETA-IIC-ICYA-OC2
           MOVE OPC-COD-CDOC IN SRT     TO RPT-DETA-COD-CDOC
           MOVE WSS-GLS-CDOC IN WSS-OC2 TO RPT-DETA-GLS-CDOC
           MOVE AUT-CAI-ICYA            TO RPT-DETA-CAI-ICYA-OC2-A
           MOVE WSS-IIC-IAUT IN WSS-OC2 TO RPT-DETA-IIC-IAUT
           WRITE RPTOC1-REG FROM  DL-OC2-01
           WRITE RPTOC1-REG FROM  DL-OC2-02
           WRITE RPTOC1-REG FROM  DL-OC2-03.
           ADD 03 TO RPT-VARI-LINEA.

       GENERATE-DL-DLC.
      *****************
           MOVE DLC-NUM-IDLC            TO RPT-DETA-NUM-IDLC-DLC
           MOVE DBC-GLS-NOMC            TO RPT-DETA-GLS-NOMC-DLC
           MOVE DBC-NUM-ICLI            TO RPT-DETA-NUM-ICLI-DLC
           MOVE DBC-VRF-ICLI            TO RPT-DETA-VRF-ICLI-DLC
           MOVE DBC-IND-ICLI            TO RPT-DETA-IND-ICLI-DLC
           MOVE WSS-IND-SCLI IN WSS-DLC TO RPT-DETA-IND-SCLI-DLC
           MOVE DBC-GLS-ICLI            TO RPT-DETA-GLS-ICLI-DLC
           MOVE RCD-NUM-DIRE            TO RPT-DETA-NUM-DIRE-DLC
           MOVE RCD-GLS-DIRE            TO RPT-DETA-GLS-DIRE-DLC
           MOVE WSS-GLS-COMU IN WSS-DLC TO RPT-DETA-GLS-COMU-DLC
           MOVE RCD-GLS-FONO            TO RPT-DETA-GLS-FONO-DLC
           MOVE ICG-SGV-TINT            TO RPT-DETA-SGV-TINT-DLC
           MOVE DLC-VAL-NDLC            TO RPT-DETA-VAL-NDLC
           MOVE WSS-GLS-TIPT IN WSS-DLC TO RPT-DETA-GLS-TIPT
           MOVE DLC-VAL-SDLC            TO RPT-DETA-VAL-SDLC
           MOVE DLC-IND-RIES            TO RPT-DETA-IND-RIES
           MOVE DLC-COD-TDOC            TO RPT-DETA-COD-TDOC
           MOVE WSS-GLS-TDOC IN WSS-DLC TO RPT-DETA-GLS-TDOC
           MOVE DLC-COD-UBFD            TO RPT-DETA-COD-UBFD
           MOVE DLC-MSC-TIMP            TO RPT-DETA-MSC-TIMP
           MOVE WSS-GLS-TIMP IN WSS-DLC TO RPT-DETA-GLS-TIMP
           MOVE WSS-GLS-UBFD IN WSS-DLC TO RPT-DETA-GLS-UBFD
           MOVE DLC-VAL-IMPU            TO RPT-DETA-VAL-IMPU
           MOVE DLC-COD-PLZA            TO RPT-DETA-COD-PLZA
           MOVE DLC-COD-NOTC            TO RPT-DETA-COD-NOTC
           MOVE WSS-GLS-NOTC IN WSS-DLC TO RPT-DETA-GLS-NOTC
           MOVE WSS-GLS-PLZA IN WSS-DLC TO RPT-DETA-GLS-PLZA
           MOVE DLC-VAL-GNOT            TO RPT-DETA-VAL-GNOT
           MOVE DLC-COD-PLZO            TO RPT-DETA-COD-PLZO
           MOVE DLC-MSC-MIPL            TO RPT-DETA-MSC-MIPL
           MOVE WSS-GLS-MIPL IN WSS-DLC TO RPT-DETA-GLS-MIPL
           MOVE WSS-GLS-PLZO IN WSS-DLC TO RPT-DETA-GLS-PLZO
           MOVE DLC-VAL-IPEN            TO RPT-DETA-VAL-IPEN
           MOVE DLC-IND-SCRT            TO RPT-DETA-IND-SCRT
           MOVE DLC-NUM-DDEV            TO RPT-DETA-NUM-DDEV
           MOVE DLC-NUM-MDEV            TO RPT-DETA-NUM-MDEV
           MOVE DLC-NUM-SDEV            TO RPT-DETA-NUM-SDEV
           MOVE DLC-NUM-ADEV            TO RPT-DETA-NUM-ADEV
           MOVE DLC-IND-SCTB            TO RPT-DETA-IND-SCTB-DLC
           MOVE DLC-VAL-READ            TO RPT-DETA-VAL-READ
           MOVE DLC-IND-SCBZ            TO RPT-DETA-IND-SCBZ-DLC
           MOVE DLC-VAL-INTD            TO RPT-DETA-VAL-INTD
           MOVE WSS-COD-TOSB IN WSS-DLC TO RPT-DETA-COD-TOSB
           WRITE RPTOC1-REG FROM  DL-DLC-01 AFTER 2
           WRITE RPTOC1-REG FROM  DL-DLC-02 AFTER 2
           WRITE RPTOC1-REG FROM  DL-DLC-03
           WRITE RPTOC1-REG FROM  DL-DLC-04
           WRITE RPTOC1-REG FROM  DL-DLC-05
           WRITE RPTOC1-REG FROM  DL-DLC-06
           WRITE RPTOC1-REG FROM  DL-DLC-07
           WRITE RPTOC1-REG FROM  DL-DLC-08
           WRITE RPTOC1-REG FROM  DL-DLC-09
           WRITE RPTOC1-REG FROM  DL-DLC-10
           WRITE RPTOC1-REG FROM  DL-DLC-11
           WRITE RPTOC1-REG FROM  DL-DLC-12
           WRITE RPTOC1-REG FROM  DL-DLC-13
           WRITE RPTOC1-REG FROM  DL-DLC-14
           WRITE RPTOC1-REG FROM  DL-DLC-15
           WRITE RPTOC1-REG FROM  DL-DLC-16
           WRITE RPTOC1-REG FROM  DL-DLC-17
           WRITE RPTOC1-REG FROM  DL-DLC-18.
           ADD 20 TO RPT-VARI-LINEA.

       GENERATE-DL-VEN.
      *****************
           IF RPT-VARI-LINEA NOT > 58 OR RPT-VARI-PAGE-COUNTER = 0 OR
              OPC-IIC-IOPC IN SRT NOT = RPT-CTRL-IIC-IOPC
              MOVE OPC-IIC-IOPC IN SRT TO RPT-CTRL-IIC-IOPC
              PERFORM TITULOS
           END-IF.
           MOVE VEN-NUM-IVEN            TO RPT-DETA-NUM-IVEN
           MOVE VEN-NUM-IDLC            TO RPT-DETA-NUM-IDLC-VEN
           MOVE WSS-GLS-VCOC IN WSS-VEN TO RPT-DETA-GLS-VCOC-VEN
           MOVE VEN-NUM-DVEN            TO RPT-DETA-NUM-DVEN
           MOVE VEN-NUM-MVEN            TO RPT-DETA-NUM-MVEN
           MOVE VEN-NUM-SVEN            TO RPT-DETA-NUM-SVEN
           MOVE VEN-NUM-AVEN            TO RPT-DETA-NUM-AVEN
           MOVE VEN-VAL-CAPI            TO RPT-DETA-VAL-CAPI
           MOVE VEN-NUM-DIMV            TO RPT-DETA-NUM-DIMV
           MOVE VEN-NUM-MIMV            TO RPT-DETA-NUM-MIMV
           MOVE VEN-NUM-SIMV            TO RPT-DETA-NUM-SIMV
           MOVE VEN-NUM-AIMV            TO RPT-DETA-NUM-AIMV
           MOVE VEN-VAL-SCAP            TO RPT-DETA-VAL-SCAP
           MOVE VEN-IND-SCTB            TO RPT-DETA-IND-SCTB-VEN
           MOVE VEN-VAL-IDNI            TO RPT-DETA-VAL-IDNI
           MOVE VEN-IND-SCBZ            TO RPT-DETA-IND-SCBZ-VEN
           MOVE VEN-VAL-FINA            TO RPT-DETA-VAL-FINA
           MOVE VEN-IND-CAUT            TO RPT-DETA-IND-CAUT-VEN
           MOVE VEN-VAL-SFIN            TO RPT-DETA-VAL-SFIN
           WRITE RPTOC1-REG FROM  DL-VEN-01
           WRITE RPTOC1-REG FROM  DL-VEN-02
           WRITE RPTOC1-REG FROM  DL-VEN-03
           WRITE RPTOC1-REG FROM  DL-VEN-04
           WRITE RPTOC1-REG FROM  DL-VEN-05
           WRITE RPTOC1-REG FROM  DL-VEN-06
           WRITE RPTOC1-REG FROM  DL-VEN-07
           ADD 07 TO RPT-VARI-LINEA.

       GENERATE-DL-EVC.
      *****************
           IF RPT-VARI-LINEA > 53 OR RPT-VARI-PAGE-COUNTER = 0 OR
              OPC-IIC-IOPC IN SRT NOT = RPT-CTRL-IIC-IOPC
              MOVE OPC-IIC-IOPC IN SRT TO RPT-CTRL-IIC-IOPC
              PERFORM TITULOS
           END-IF.
           MOVE EVC-NUM-IEVC            TO RPT-DETA-NUM-IEVC
           MOVE EVC-NUM-DURV            TO RPT-DETA-NUM-DURV
           MOVE EVC-NUM-IDLC            TO RPT-DETA-NUM-IDLC-EVC
           MOVE EVC-IND-UTDV            TO RPT-DETA-IND-UTDV
           MOVE WSS-GLS-UTDV IN WSS-EVC TO RPT-DETA-GLS-UTDV
           MOVE EVC-NUM-DPVC            TO RPT-DETA-NUM-DPVC
           MOVE EVC-NUM-MPVC            TO RPT-DETA-NUM-MPVC
           MOVE EVC-NUM-SPVC            TO RPT-DETA-NUM-SPVC
           MOVE EVC-NUM-APVC            TO RPT-DETA-NUM-APVC
           MOVE EVC-NUM-VIGU            TO RPT-DETA-NUM-VIGU
           MOVE EVC-NUM-DPVE            TO RPT-DETA-NUM-DPVE
           MOVE WSS-NUM-SPVE IN WSS-EVC TO RPT-DETA-NUM-SPVE
           MOVE EVC-MSC-TCVE            TO RPT-DETA-MSC-TCVE
           MOVE WSS-IND-UTPV IN WSS-EVC TO RPT-DETA-IND-UTPV
           MOVE WSS-GLS-UTPV IN WSS-EVC TO RPT-DETA-GLS-UTPV
           MOVE WSS-GLS-TCVE IN WSS-EVC TO RPT-DETA-GLS-TCVE
           MOVE EVC-NUM-DESD            TO RPT-DETA-NUM-DESD
           MOVE EVC-VAL-VENC            TO RPT-DETA-VAL-VENC
           MOVE EVC-NUM-SEVE            TO RPT-DETA-NUM-SEVE
           MOVE WSS-GLS-VCOC IN WSS-EVC TO RPT-DETA-GLS-VCOC-EVC
           MOVE EVC-IND-UTSV            TO RPT-DETA-IND-UTSV
           MOVE WSS-GLS-UTSV IN WSS-EVC TO RPT-DETA-GLS-UTSV
           MOVE EVC-SGV-FVAR            TO RPT-DETA-SGV-FVAR
           MOVE EVC-IND-CAUT            TO RPT-DETA-IND-CAUT-EVC
           MOVE EVC-IND-FVAR            TO RPT-DETA-IND-FVAR
           WRITE RPTOC1-REG FROM  DL-EVC-01 AFTER 2
           WRITE RPTOC1-REG FROM  DL-EVC-02 AFTER 2
           WRITE RPTOC1-REG FROM  DL-EVC-03
           WRITE RPTOC1-REG FROM  DL-EVC-04
           WRITE RPTOC1-REG FROM  DL-EVC-05
           WRITE RPTOC1-REG FROM  DL-EVC-06
           WRITE RPTOC1-REG FROM  DL-EVC-07
           WRITE RPTOC1-REG FROM  DL-EVC-08
           WRITE RPTOC1-REG FROM  DL-EVC-09
           WRITE RPTOC1-REG FROM  DL-EVC-10
           MOVE SPACES TO RPTOC1-REG.
           WRITE RPTOC1-REG AFTER 2
           ADD 14 TO RPT-VARI-LINEA.

       GENERATE-DL-HRDC.
      ******************
           PERFORM TITULOS.
           MOVE WSS-GLS-TDEU IN WSS-RDC TO RPT-DETA-GLS-TDEU
           MOVE WSS-GLS-DOCU IN WSS-RDC TO RPT-DETA-GLS-DOCU
           MOVE DLC-NUM-IDLC            TO RPT-DETA-NUM-IDLC-HRD
           WRITE RPTOC1-REG FROM DL-HRD-01.
           ADD 01 TO RPT-VARI-LINEA.

       GENERATE-DL-RDC.
      *****************
           MOVE DBC-GLS-NOMC            TO RPT-DETA-GLS-NOMC-RDC
           MOVE DBC-NUM-ICLI            TO RPT-DETA-NUM-ICLI-RDC
           MOVE DBC-VRF-ICLI            TO RPT-DETA-VRF-ICLI-RDC
           MOVE DBC-IND-ICLI            TO RPT-DETA-IND-ICLI-RDC
           MOVE WSS-IND-SCLI IN WSS-RDC TO RPT-DETA-IND-SCLI-RDC
           MOVE DBC-GLS-ICLI            TO RPT-DETA-GLS-ICLI-RDC
           MOVE RDC-VAL-LIMD            TO RPT-DETA-VAL-LIMD
           MOVE WSS-VAL-MONL IN WSS-RDC TO RPT-DETA-VAL-MONL
           MOVE RCD-GLS-DIRE            TO RPT-DETA-GLS-DIRE
           MOVE RCD-GLS-FONO            TO RPT-DETA-GLS-FONO
           MOVE RDC-NUM-DIRE            TO RPT-DETA-NUM-DIRE-RDC
           MOVE WSS-GLS-COMU IN WSS-RDC TO RPT-DETA-GLS-COMU-RDC
           WRITE RPTOC1-REG FROM  DL-RDC-02
           WRITE RPTOC1-REG FROM  DL-RDC-03
           WRITE RPTOC1-REG FROM  DL-RDC-04
           WRITE RPTOC1-REG FROM  DL-RDC-05
           WRITE RPTOC1-REG FROM  DL-RDC-06.
           ADD 06 TO RPT-VARI-LINEA.

       GENERATE-DL-HCYA.
      ******************
           MOVE WSS-GLS-TIPM IN WSS-CYA TO RPT-DETA-GLS-TIPM
           MOVE WSS-GLS-TMOV IN WSS-CYA TO RPT-DETA-GLS-TMOV-1
           MOVE WSS-GLS-TMOV IN WSS-CYA TO RPT-DETA-GLS-TMOV-2
           MOVE WSS-GLS-TMOV IN WSS-CYA TO RPT-DETA-GLS-TMOV-3
           MOVE WSS-GLS-VCOC IN WSS-CYA TO RPT-DETA-GLS-VCOC-HCY
           MOVE WSS-GLS-TMOV IN WSS-CYA TO RPT-DETA-GLS-TMOV-4.
           WRITE RPTOC1-REG FROM  DL-HCY-01
           WRITE RPTOC1-REG FROM  DL-HCY-02
           WRITE RPTOC1-REG FROM  DL-HCY-03
           ADD 03 TO RPT-VARI-LINEA.

       GENERATE-DL-CYA.
      *****************
           MOVE CYA-NUM-ICYA            TO RPT-DETA-NUM-ICYA
           MOVE WSS-GLS-TCYA IN WSS-CYA TO RPT-DETA-GLS-TCYA-CYA
           MOVE CYA-CAI-ICYA            TO RPT-DETA-CAI-ICYA-CYA
           MOVE WSS-IIC-ICYA IN WSS-CYA TO RPT-DETA-IIC-ICYA-CYA
           MOVE CYA-SGV-LIQU            TO RPT-DETA-SGV-LIQU-CYA
           MOVE WSS-VAL-VPES IN WSS-CYA TO RPT-DETA-VAL-VPES
           WRITE RPTOC1-REG FROM  DL-CYA-04.
           ADD 01 TO RPT-VARI-LINEA.

       GENERATE-DL-ICG.
      *****************
           MOVE WSS-NUM-TASA IN WSS-ICG TO RPT-DETA-NUM-TASA
           MOVE ICG-NUM-DINI            TO RPT-DETA-NUM-DINI
           MOVE ICG-NUM-MINI            TO RPT-DETA-NUM-MINI
           MOVE ICG-NUM-SINI            TO RPT-DETA-NUM-SINI
           MOVE ICG-NUM-AINI            TO RPT-DETA-NUM-AINI
           MOVE ICG-MSC-BCTI            TO RPT-DETA-MSC-BCTI
           MOVE ICG-MSC-PBTI            TO RPT-DETA-MSC-PBTI
           MOVE WSS-GLS-BCTI IN WSS-ICG TO RPT-DETA-GLS-BCTI
           MOVE WSS-GLS-PBTI IN WSS-ICG TO RPT-DETA-GLS-PBTI
           MOVE ICG-MSC-BPBT            TO RPT-DETA-MSC-BPBT
           MOVE ICG-MSC-SPBT            TO RPT-DETA-MSC-SPBT
           MOVE WSS-GLS-BPBT IN WSS-ICG TO RPT-DETA-GLS-BPBT
           MOVE WSS-GLS-SPBT IN WSS-ICG TO RPT-DETA-GLS-SPBT
           MOVE ICG-COD-CVTI            TO RPT-DETA-COD-CVTI
           MOVE ICG-MSC-TFPR            TO RPT-DETA-MSC-TFPR
           MOVE WSS-GLS-CVTI IN WSS-ICG TO RPT-DETA-GLS-CVTI
           MOVE WSS-GLS-TFPR IN WSS-ICG TO RPT-DETA-GLS-TFPR
           MOVE ICG-NUM-PREP            TO RPT-DETA-NUM-PREP
           MOVE ICG-MSC-UTPR            TO RPT-DETA-MSC-UTPR
           MOVE WSS-GLS-UTPR IN WSS-ICG TO RPT-DETA-GLS-UTPR
           MOVE ICG-NUM-DTER            TO RPT-DETA-NUM-DTER
           MOVE ICG-NUM-MTER            TO RPT-DETA-NUM-MTER
           MOVE ICG-NUM-STER            TO RPT-DETA-NUM-STER
           MOVE ICG-NUM-ATER            TO RPT-DETA-NUM-ATER
           MOVE ICG-SGV-SPRD            TO RPT-DETA-SGV-SPRD
           MOVE ICG-SGV-TINT            TO RPT-DETA-SGV-TINT-ICG.
           WRITE RPTOC1-REG FROM  DL-ICG-01
           WRITE RPTOC1-REG FROM  DL-ICG-02
           WRITE RPTOC1-REG FROM  DL-ICG-03
           WRITE RPTOC1-REG FROM  DL-ICG-04
           WRITE RPTOC1-REG FROM  DL-ICG-05
           WRITE RPTOC1-REG FROM  DL-ICG-06
           WRITE RPTOC1-REG FROM  DL-ICG-07
           WRITE RPTOC1-REG FROM  DL-ICG-08
           WRITE RPTOC1-REG FROM  DL-ICG-09
           WRITE RPTOC1-REG FROM  DL-ICG-10
           WRITE RPTOC1-REG FROM  DL-ICG-11.
           ADD 11 TO RPT-VARI-LINEA.

       TITULOS.
      *********
           PERFORM DEC-PH-OC1.
           MOVE RPT-DUSU                TO RPT-HEAD-DUSU
           MOVE RPT-FDMA                TO RPT-HEAD-FDMA
           MOVE RPT-DSIS                TO RPT-HEAD-DSIS
           MOVE WSS-MSC-STAT IN WSS-OC1 TO RPT-HEAD-MSC-STAT
           MOVE WSS-NUM-DINI IN WSS-OC1 TO RPT-HEAD-NUM-DINI
           MOVE WSS-NUM-MINI IN WSS-OC1 TO RPT-HEAD-NUM-MINI
           MOVE WSS-NUM-SINI IN WSS-OC1 TO RPT-HEAD-NUM-SINI
           MOVE WSS-NUM-AINI IN WSS-OC1 TO RPT-HEAD-NUM-AINI
           MOVE WSS-NUM-DTER IN WSS-OC1 TO RPT-HEAD-NUM-DTER
           MOVE WSS-NUM-MTER IN WSS-OC1 TO RPT-HEAD-NUM-MTER
           MOVE WSS-NUM-STER IN WSS-OC1 TO RPT-HEAD-NUM-STER
           MOVE WSS-NUM-ATER IN WSS-OC1 TO RPT-HEAD-NUM-ATER
           MOVE OPC-MSC-TVOC IN SRT     TO RPT-HEAD-MSC-TVOC
           MOVE OPC-COD-TOOC IN SRT     TO RPT-HEAD-COD-TOOC
           MOVE OPC-COD-OFOC IN SRT     TO RPT-HEAD-COD-OFOC
           MOVE OPC-CAI-IOPC IN SRT     TO RPT-HEAD-CAI-IOPC
           MOVE OPC-IIC-IOPC IN SRT     TO RPT-HEAD-IIC-IOPC
           MOVE WSS-GLS-TVOC IN WSS-OC1 TO RPT-HEAD-GLS-TVOC
           MOVE WSS-GLS-TOOC IN WSS-OC1 TO RPT-HEAD-GLS-TOOC
           MOVE WSS-GLS-OFOC IN WSS-OC1 TO RPT-HEAD-GLS-OFOC
           MOVE WSS-CAI-RENO IN WSS-OC1 TO RPT-HEAD-CAI-RENO
           MOVE WSS-IIC-RENO IN WSS-OC1 TO RPT-HEAD-IIC-RENO
           ADD 1 TO RPT-VARI-PAGE-COUNTER
           MOVE RPT-VARI-PAGE-COUNTER TO RPT-HEAD-PAGE-COUNTER
           MOVE SPACES TO RPTOC1-REG.
           WRITE RPTOC1-REG AFTER PAGE
           WRITE RPTOC1-REG FROM  PH-OC1-01
           WRITE RPTOC1-REG FROM  PH-OC1-02
           WRITE RPTOC1-REG FROM  PH-OC1-03
           WRITE RPTOC1-REG FROM  PH-OC1-04 AFTER 2
           WRITE RPTOC1-REG FROM  PH-OC1-05
           MOVE 08 TO RPT-VARI-LINEA.

      ***** CRW-FINAL

       EXT-OUT-SRT.
           EXIT.
       COPY COLBFOPC.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF
       COPY GNSBPFEC.
      ******************************************************************
       GET-DLC SECTION.
       INI-GET-DLC.
           MOVE OPC-CAI-IOPC IN OPC TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN OPC TO DLC-IIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC = OPC-CAI-IOPC IN OPC AND
                    DLC-IIC-IOPC IN DLC = OPC-IIC-IOPC IN OPC )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NODLC' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN OPC
                                        OPC-IIC-IOPC IN OPC.
       FIN-GET-DLC.
           EXIT.
      ******************************************************************
       GET-EVC SECTION.
       INI-GET-EVC.
           MOVE OPC-CAI-IOPC IN OPC TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN OPC TO EVC-IIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN OPC AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN OPC )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOEVC' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN OPC
                                        OPC-IIC-IOPC IN OPC.
       FIN-GET-EVC.
           EXIT.
      ******************************************************************
       GET-VEN SECTION.
       INI-GET-VEN.
           MOVE OPC-CAI-IOPC IN OPC TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN OPC TO VEN-IIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CAI-IOPC IN VEN = OPC-CAI-IOPC IN OPC AND
                    VEN-IIC-IOPC IN VEN = OPC-IIC-IOPC IN OPC )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOVEN' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN OPC
                                        OPC-IIC-IOPC IN OPC.
       FIN-GET-VEN.
           EXIT.
      ******************************************************************
       BUS-OPC-FIL-ANX SECTION.
       INI-BUS-OPC-FIL-ANX.
           MOVE ZEROES TO WSS-MUL-ICG IN WSS-VARI.
           MOVE ZEROES TO WSS-MUL-CYA IN WSS-VARI.
           PERFORM GET-CUR-ITR.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOICG' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                        OPC-IIC-IOPC IN SRT
               GO TO FIN-BUS-OPC-FIL-ANX.

           PERFORM GET-NXT-ITR.
           IF ITR-COD-CVTI IN ITR > SPACES
               MOVE ITR-SGV-SPRD IN ITR TO ITR-SGV-TINT IN ITR.
           IF ITR-COD-TINT IN ITR = 'M'
               MOVE 'MULTIPLES' TO WSS-GLS-TINT IN WSS-OC1
               MOVE 1           TO WSS-MUL-ICG  IN WSS-VARI
               MOVE ZEROES      TO ITR-SGV-TINT IN ITR
           ELSE
               IF ITR-COD-TINT IN ITR > SPACES
                   MOVE 'COL'               TO TAB-COD-SIST
                   MOVE 'INT'               TO TAB-COD-TTAB IN TAB
                   MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TINT IN WSS-OC1
               ELSE
                   MOVE SPACES TO WSS-GLS-TINT IN WSS-OC1.

           PERFORM GET-CUR-COM.
           IF NOT FIO-STAT-OKS
                MOVE ZEROES TO COM-SGV-TINT IN COM
                MOVE SPACES TO COM-COD-TINT IN COM
           ELSE
               PERFORM GET-NXT-COM
               IF COM-COD-TINT IN COM = 'M'
                   MOVE 'MULTIPLES' TO COM-COD-TINT IN COM
                   MOVE ZEROES      TO COM-SGV-TINT IN COM
               ELSE
                   IF COM-COD-TINT IN COM > SPACES
                       MOVE 'COL'               TO TAB-COD-SIST
                       MOVE 'COM'               TO TAB-COD-TTAB IN TAB
                       MOVE COM-COD-TINT IN COM TO TAB-COD-CTAB IN TAB
                       PERFORM BUS-TAB
                       MOVE TAB-GLS-DESC TO COM-COD-TINT IN COM
                   ELSE
                       MOVE SPACES TO COM-COD-TINT IN COM.

           PERFORM GET-CUR-CYA.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO CYA-CAI-ICYA IN CYA
               MOVE ZEROES TO CYA-IIC-ICYA IN CYA
               MOVE SPACES TO CYA-IND-TCYA IN CYA
               MOVE SPACES TO WSS-GLS-TCYA IN WSS-OC2
           ELSE
               PERFORM GET-NXT-CYA
               IF CYA-IND-TCYA IN CYA = 'M'
                    MOVE SPACES      TO CYA-IND-TCYA IN CYA
                    MOVE 1           TO WSS-MUL-CYA  IN WSS-VARI
                    MOVE 'MULTIPLES' TO WSS-GLS-TCYA IN WSS-OC2
                    MOVE SPACES      TO CYA-CAI-ICYA IN CYA
                    MOVE ZEROES      TO CYA-IIC-ICYA IN CYA
               ELSE
                   IF CYA-IND-TCYA IN CYA > SPACES
                       MOVE 'TAB'               TO MSC-COD-SIST
                       MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
                       MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
                       PERFORM BUS-MSC
                       MOVE MSC-GLS-DCOR TO WSS-GLS-TCYA IN WSS-OC2
                   ELSE
                       MOVE SPACES TO WSS-GLS-TCYA IN WSS-OC2.

           MOVE OPC-CAI-IOPC IN SRT TO AUT-CAI-IOPC IN AUT.
           MOVE OPC-IIC-IOPC IN SRT TO AUT-IIC-IOPC IN AUT.
           MOVE 'AUT'               TO AUT-NUM-ICAN IN AUT.
           MOVE 1                   TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO AUT-IIC-ICYA IN AUT
               MOVE SPACES TO AUT-CAI-ICYA IN AUT.

           PERFORM GET-CUR-ROV.
           MOVE '00' TO FIO-STAT.
       FIN-BUS-OPC-FIL-ANX.
           EXIT.
      *-----------------------------------------------------------------
       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE OPC-CAI-IOPC IN SRT TO ITR-CAI-IOPC IN ITR.
           MOVE OPC-IIC-IOPC IN SRT TO ITR-IIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CAI-IOPC IN ITR = OPC-CAI-IOPC IN SRT AND
                    ITR-IIC-IOPC IN ITR = OPC-IIC-IOPC IN SRT AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-ITR.
           EXIT.
      *-----------------------------------------------------------------
       GET-NXT-ITR SECTION.
       INI-GET-NXT-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS                              AND
              ITR-CAI-IOPC IN ITR = OPC-CAI-IOPC IN SRT AND
              ITR-IIC-IOPC IN ITR = OPC-IIC-IOPC IN SRT AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
                MOVE 'M' TO ITR-COD-TINT IN ITR
           ELSE
                MOVE SPACES TO ITR-COD-TINT IN ITR
                PERFORM GET-CUR-ITR.
       FIN-GET-NXT-ITR.
           EXIT.
      *-----------------------------------------------------------------
       GET-CUR-COM SECTION.
       INI-GET-CUR-COM.
           MOVE OPC-CAI-IOPC IN SRT TO COM-CAI-IOPC IN COM.
           MOVE OPC-IIC-IOPC IN SRT TO COM-IIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE 'COM'               TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CAI-IOPC IN COM = OPC-CAI-IOPC IN SRT AND
                    COM-IIC-IOPC IN COM = OPC-IIC-IOPC IN SRT AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = 'COM' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COM.
           EXIT.
      *-----------------------------------------------------------------
       GET-NXT-COM SECTION.
       INI-GET-NXT-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF FIO-STAT-OKS                              AND
              COM-CAI-IOPC IN COM = OPC-CAI-IOPC IN SRT AND
              COM-IIC-IOPC IN COM = OPC-IIC-IOPC IN SRT AND
              COM-NUM-ICAN IN COM = ZEROES              AND
              COM-CIC-IOPV IN COM = SPACES              AND
              COM-NUM-IVCT IN COM = ZEROES              AND
              COM-IND-TTAS IN COM = 'COM'
                MOVE 'M' TO COM-COD-TINT IN COM
           ELSE
                MOVE SPACES TO COM-COD-TINT IN COM
                PERFORM GET-CUR-COM.
       FIN-GET-NXT-COM.
           EXIT.
      *-----------------------------------------------------------------
       GET-CUR-CYA SECTION.
       INI-GET-CUR-CYA.
           MOVE OPC-CAI-IOPC IN SRT TO CYA-CAI-IOPC IN CYA.
           MOVE OPC-IIC-IOPC IN SRT TO CYA-IIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-CYA.
       FIN-GET-CUR-CYA.
           EXIT.
      *-----------------------------------------------------------------
       GET-NXT-CYA SECTION.
       INI-GET-NXT-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS                              AND
              OPC-CAI-IOPC IN SRT = CYA-CAI-IOPC IN CYA AND
              OPC-IIC-IOPC IN SRT = CYA-IIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES
               MOVE 'M' TO CYA-IND-TCYA IN CYA
           ELSE
               MOVE SPACES TO CYA-IND-TCYA IN CYA
               PERFORM GET-CUR-CYA.
       FIN-GET-NXT-CYA.
           EXIT.
      *-----------------------------------------------------------------
       GET-CUR-ROV SECTION.
       INI-GET-CUR-ROV.
           MOVE OPC-CAI-IOPC IN SRT TO ROV-CAI-IOPC IN ROV.
           MOVE OPC-IIC-IOPC IN SRT TO ROV-IIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
      *DAD  ini 13-MAY-1991
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = ROV-CAI-IOPC IN ROV AND
                    OPC-IIC-IOPC IN SRT = ROV-IIC-IOPC IN ROV )
               MOVE SPACES TO WSS-CAI-RENO IN WSS-OC1
               MOVE SPACES TO WSS-IIC-RENO IN WSS-OC1
               MOVE ZEROES TO WSS-NUM-RENO IN WSS-OC1
               MOVE ZEROES TO WSS-VAL-RENO IN WSS-OC1
               GO TO FIN-GET-CUR-ROV.
           MOVE ROV-CAI-IOPV IN ROV TO WSS-CAI-RENO IN WSS-OC1.
           MOVE ROV-IIC-IOPV IN ROV TO WSS-IIC-RENO IN WSS-OC1.
           MOVE ROV-NUM-IVCT IN ROV TO WSS-NUM-RENO IN WSS-OC1.
           MOVE ROV-SGV-RENO IN ROV TO WSS-VAL-RENO IN WSS-OC1.
       NXT-GET-CUR-ROV.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = ROV-CAI-IOPC IN ROV AND
                    OPC-IIC-IOPC IN SRT = ROV-IIC-IOPC IN ROV )
               GO TO FIN-GET-CUR-ROV.
           MOVE 'MULT'             TO WSS-CAI-RENO IN WSS-OC1.
           MOVE SPACES             TO WSS-IIC-RENO IN WSS-OC1.
           MOVE ZEROES             TO WSS-NUM-RENO IN WSS-OC1.
           ADD ROV-SGV-RENO IN ROV TO WSS-VAL-RENO IN WSS-OC1.
           GO TO NXT-GET-CUR-ROV.
      *DAD  fin 13-MAY-1991
       FIN-GET-CUR-ROV.
           EXIT.
      ******************************************************************
       BUS-GLS-OPC SECTION.
       INI-BUS-GLS-OPC.
      *BUS-OFI busca oficina en tablas
      *DAD  ini 13-MAY-1991
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
      *DAD  fin 13-MAY-1991
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-OC1.

           IF OPC-COD-RMOC IN SRT > SPACES
               MOVE OPC-COD-RMOC IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-OC2
           ELSE
               MOVE SPACES TO WSS-GLS-RMOC IN WSS-OC2.

           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCOC IN WSS-OC1
               MOVE WSS-GLS-VCOC IN WSS-OC1 TO WSS-GLS-VCOC IN WSS-VEN
               MOVE WSS-GLS-VCOC IN WSS-OC1 TO WSS-GLS-VCOC IN WSS-EVC
               MOVE TAB-GLS-ABRV IN TAB     TO WSS-GLS-VCOC IN WSS-CYA
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-VEN
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-EVC
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-CYA
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-OC1.

           IF OPC-COD-AOOC IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN SRT TO WSS-COD-TOOC IN WSS-VARI
               MOVE OPC-COD-AOOC IN SRT TO WSS-COD-AOOC IN WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AOOC IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-AOOC IN WSS-OC1.

           IF OPC-MSC-STAT IN SRT > SPACES
               MOVE 'GNS'               TO TAB-COD-SIST
               MOVE 'STT'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-MSC-STAT IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-STAT IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-STAT IN WSS-OC1.

           IF OPC-COD-SEGD IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'SDG'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-SEGD IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-SEGD IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-SEGD IN WSS-OC1.

           IF OPC-MSC-MCVF IN SRT > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'MCVF'              TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-MCVF IN SRT TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-MCVF IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-MCVF IN WSS-OC1.

           IF OPC-COD-CDOC IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'DES'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-CDOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CDOC IN WSS-OC2
           ELSE
               MOVE SPACES TO WSS-GLS-CDOC IN WSS-OC2.
       FIN-BUS-GLS-OPC.
           EXIT.
      ******************************************************************
       BUS-DEU-DIR SECTION.
       INI-BUS-DEU-DIR.
           MOVE OPC-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               GO TO CON-BUS-DEU-DIR.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               MOVE SPACES TO WSS-GLS-COMU IN WSS-OC1
               GO TO NXT-BUS-DEU-DIR.

           PERFORM BUS-DIRE.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE SPACES TO WSS-GLS-COMU IN WSS-OC1
               PERFORM RST-RCD
               GO TO NXT-BUS-DEU-DIR.

           PERFORM BUS-GLS-COMU.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-OC1.
       NXT-BUS-DEU-DIR.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              OPC-CAI-IOPC IN SRT = RDC-CAI-IOPC IN RDC AND
              OPC-IIC-IOPC IN SRT = RDC-IIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
                MOVE 1 TO WSS-MUL-DEUD IN WSS-VARI
                PERFORM RST-RCD
                PERFORM RST-DBC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'OPC    MDDIR' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC.
       CON-BUS-DEU-DIR.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-ICLI IN DBC > SPACES
               MOVE '-' TO WSS-IND-SCLI IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-IND-SCLI IN WSS-OC1.
       FIN-BUS-DEU-DIR.
           EXIT.
      ******************************************************************
       GET-DLC-OPC SECTION.
       INI-GET-DLC-OPC.
           MOVE OPC-CAI-IOPC IN SRT TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN SRT TO DLC-IIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC = OPC-CAI-IOPC IN SRT AND
                    DLC-IIC-IOPC IN DLC = OPC-IIC-IOPC IN SRT )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NODLC' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                        OPC-IIC-IOPC IN SRT
               GO TO FIN-GET-DLC-OPC.

           MOVE DLC-NUM-IDLC IN DLC TO WSS-NUM-IDLC IN WSS-VARI.
           PERFORM BUS-DLC-FIL-ANX.
           PERFORM BUS-GLS-DLC.
           PERFORM BUS-DEU-IND.

      ***** CRW-COMIENZO
      *    GENERATE DL-DLC.
           PERFORM GENERATE-DL-DLC.
      ***** CRW-FINAL

           IF SRT-IND-IEVC IN SRT NOT = 'S'
               PERFORM GET-DLC-VEN
           ELSE
               PERFORM GET-DLC-EVC.

           IF WSS-NUM-SUDL IN WSS-VARI NOT > ZEROES
               MOVE ZEROES TO DLC-NUM-IDLC IN DLC
               IF SRT-IND-IEVC IN SRT NOT = 'S'
                   PERFORM GET-DLC-VEN
               ELSE
                   PERFORM GET-DLC-EVC.

           IF WSS-NUM-SUDL IN WSS-VARI > ZEROES
               GO TO CON-GET-DLC-OPC.

           MOVE 'COL' TO MSG-COD-SIST.
           IF SRT-IND-IEVC IN SRT NOT = 'S'
               MOVE 'DLC    NOVEN' TO MSG-COD-MENS
           ELSE
               MOVE 'DLC    NOEVC' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                    OPC-IIC-IOPC IN SRT
                                    WSS-NUM-IDLC IN WSS-VARI.
       CON-GET-DLC-OPC.
           MOVE WSS-NUM-IDLC IN WSS-VARI TO DLC-NUM-IDLC IN DLC.
           IF WSS-MUL-DEUI IN WSS-VARI = 1
               MOVE DLC-NUM-IDLC IN DLC TO WSS-NUM-FSTD IN WSS-VARI
               MOVE 1 TO WSS-MUL-FSTD IN WSS-VARI
           ELSE
               MOVE ZEROES TO WSS-MUL-FSTD IN WSS-VARI.
       LUP-GET-DLC-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC = OPC-CAI-IOPC IN SRT AND
                    DLC-IIC-IOPC IN DLC = OPC-IIC-IOPC IN SRT )
               GO TO FIN-GET-DLC-OPC.
           MOVE DLC-NUM-IDLC IN DLC TO WSS-NUM-IDLC IN WSS-VARI.
           PERFORM BUS-DLC-FIL-ANX.
           PERFORM BUS-GLS-DLC.
           PERFORM BUS-DEU-IND.
      *    IF LINE-COUNTER > ZEROES
      *ALD Solo IBM
      *        MOVE '67' TO LINE-COUNTER.
           IF RPT-VARI-LINEA > ZEROES
               MOVE 67 TO RPT-VARI-LINEA.
      *

      ***** CRW-COMIENZO
      *    GENERATE DL-DLC.
           PERFORM GENERATE-DL-DLC.
      ***** CRW-FINAL

           IF SRT-IND-IEVC IN SRT NOT = 'S'
               PERFORM GET-DLC-VEN
           ELSE
               PERFORM GET-DLC-EVC.

           IF WSS-NUM-SUDL IN WSS-VARI NOT > ZEROES
               MOVE ZEROES TO DLC-NUM-IDLC IN DLC
               IF SRT-IND-IEVC IN SRT NOT = 'S'
                   PERFORM GET-DLC-VEN
               ELSE
                   PERFORM GET-DLC-EVC.

           IF WSS-NUM-SUDL IN WSS-VARI > ZEROES
               GO TO NXT-GET-DLC-OPC.

           MOVE 'COL' TO MSG-COD-SIST.
           IF SRT-IND-IEVC IN SRT NOT = 'S'
               MOVE 'DLC    NOVEN' TO MSG-COD-MENS
           ELSE
               MOVE 'DLC    NOEVC' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                    OPC-IIC-IOPC IN SRT
                                    WSS-NUM-IDLC IN WSS-VARI.
       NXT-GET-DLC-OPC.
           MOVE WSS-NUM-IDLC IN WSS-VARI TO DLC-NUM-IDLC IN DLC.
           IF WSS-MUL-DEUI IN WSS-VARI = 1
               PERFORM GET-IND-RDC.
           GO TO LUP-GET-DLC-OPC.
       FIN-GET-DLC-OPC.
           EXIT.
      ******************************************************************
       GET-DLC-VEN SECTION.
       INI-GET-DLC-VEN.
           MOVE ZEROES TO WSS-NUM-SUDL IN WSS-VARI.
           MOVE OPC-CAI-IOPC IN SRT TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN SRT TO VEN-IIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CAI-IOPC IN VEN = OPC-CAI-IOPC IN SRT AND
                    VEN-IIC-IOPC IN VEN = OPC-IIC-IOPC IN SRT )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOVEN' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                        OPC-IIC-IOPC IN SRT
               GO TO FIN-GET-DLC-VEN.

           IF VEN-NUM-IDLC IN VEN = DLC-NUM-IDLC IN DLC
               ADD 1 TO WSS-NUM-SUDL IN WSS-VARI

      ***** CRW-COMIENZO
      *        GENERATE DL-VEN.
               PERFORM GENERATE-DL-VEN.
      ***** CRW-FINAL

       LUP-GET-DLC-VEN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CAI-IOPC IN VEN = OPC-CAI-IOPC IN SRT AND
                    VEN-IIC-IOPC IN VEN = OPC-IIC-IOPC IN SRT )
               GO TO FIN-GET-DLC-VEN.

           IF VEN-NUM-IDLC IN VEN = DLC-NUM-IDLC IN DLC
               ADD 1 TO WSS-NUM-SUDL IN WSS-VARI

      ***** CRW-COMIENZO
      *        GENERATE DL-VEN.
               PERFORM GENERATE-DL-VEN.
      ***** CRW-FINAL

           GO TO LUP-GET-DLC-VEN.
       FIN-GET-DLC-VEN.
           EXIT.

       GET-DLC-EVC SECTION.
       INI-GET-DLC-EVC.
           MOVE ZEROES TO WSS-NUM-SUDL IN WSS-VARI.
           MOVE OPC-CAI-IOPC IN SRT TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN SRT TO EVC-IIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN SRT AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN SRT )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOEVC' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                        OPC-IIC-IOPC IN SRT
               GO TO FIN-GET-DLC-EVC.

           IF EVC-NUM-IDLC IN EVC = DLC-NUM-IDLC IN DLC
               ADD 1 TO WSS-NUM-SUDL IN WSS-VARI
               PERFORM BUS-GLS-EVC

      ***** CRW-COMIENZO
      *        GENERATE DL-EVC.
               PERFORM GENERATE-DL-EVC.
      ***** CRW-FINAL

       LUP-GET-DLC-EVC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN SRT AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN SRT )
               GO TO FIN-GET-DLC-EVC.

           IF EVC-NUM-IDLC IN EVC = DLC-NUM-IDLC IN DLC
               ADD 1 TO WSS-NUM-SUDL IN WSS-VARI
               PERFORM BUS-GLS-EVC

      ***** CRW-COMIENZO
      *        GENERATE DL-EVC.
               PERFORM GENERATE-DL-EVC.
      ***** CRW-FINAL

           GO TO LUP-GET-DLC-EVC.
       FIN-GET-DLC-EVC.
           EXIT.

       GET-DIR-RDC SECTION.
       INI-GET-DIR-RDC.
           IF WSS-MUL-DEUD IN WSS-VARI NOT > ZEROES
               GO TO FIN-GET-DIR-RDC.

           MOVE OPC-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GET-DIR-RDC.

           MOVE SPACES TO WSS-GLS-DOCU IN WSS-RDC.
           MOVE ZEROES TO DLC-NUM-IDLC IN DLC.
           MOVE 'DIRECTOS' TO WSS-GLS-TDEU IN WSS-RDC.

      ***** CRW-COMIENZO
      *    GENERATE DL-HRDC.
           PERFORM GENERATE-DL-HRDC.
      ***** CRW-FINAL

       LUP-GET-DIR-RDC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               GO TO CON-GET-DIR-RDC.

           PERFORM BUS-DIRE.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               PERFORM RST-RCD
               GO TO CON-GET-DIR-RDC.

           PERFORM BUS-GLS-COMU.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-RDC.
       CON-GET-DIR-RDC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE '-' TO WSS-IND-SCLI IN WSS-RDC
           ELSE
               MOVE SPACES TO WSS-IND-SCLI IN WSS-RDC.

      *DAD  ini 02-MAY-1994    (Memo.06-01-94 Pto.3)
      * Calcula Monto Limite Deuda de Deudor Directo Credito
      *     MULTIPLY OPC-VAL-CRED IN SRT BY RDC-VAL-LIMD IN RDC
      *                       GIVING WSS-VAL-MONL IN WSS-RDC.
      *     DIVIDE WSS-VAL-MONL IN WSS-RDC BY 100 GIVING
      *            WSS-VAL-MONL IN WSS-RDC.
           COMPUTE WSS-VAL-MONL IN WSS-RDC =
                   ( OPC-VAL-CRED IN SRT * RDC-VAL-LIMD IN RDC ) / 100.
      *DAD  fin 02-MAY-1994

      ***** CRW-COMIENZO
      *    GENERATE DL-RDC.
           PERFORM GENERATE-DL-RDC.
      ***** CRW-FINAL

       LOOP-GET-DIR-RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = RDC-CAI-IOPC IN RDC AND
                    OPC-IIC-IOPC IN SRT = RDC-IIC-IOPC IN RDC )
               GO TO FIN-GET-DIR-RDC.

           IF RDC-NUM-IDLC IN RDC = ZEROES
               GO TO LUP-GET-DIR-RDC
           ELSE
               GO TO LOOP-GET-DIR-RDC.
       FIN-GET-DIR-RDC.
           EXIT.

       GET-IND-RDC SECTION.
       INI-GET-IND-RDC.
           IF WSS-MUL-DEUI IN WSS-VARI NOT > ZEROES
               GO TO FIN-GET-IND-RDC.

           MOVE OPC-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GET-IND-RDC.

           MOVE 'DOCUMENTO'  TO WSS-GLS-DOCU IN WSS-RDC.
           MOVE 'INDIRECTOS' TO WSS-GLS-TDEU IN WSS-RDC.

      ***** CRW-COMIENZO
      *    GENERATE DL-HRDC.
           PERFORM GENERATE-DL-HRDC.
      ***** CRW-FINAL

       LUP-GET-IND-RDC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               GO TO CON-GET-IND-RDC.

           PERFORM BUS-DIRE.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               PERFORM RST-RCD
               GO TO CON-GET-IND-RDC.

           PERFORM BUS-GLS-COMU.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-RDC.
       CON-GET-IND-RDC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE '-' TO WSS-IND-SCLI IN WSS-RDC
           ELSE
               MOVE SPACES TO WSS-IND-SCLI IN WSS-RDC.

      *DAD  ini 02-MAY-1994    (Memo.06-01-94 Pto.3)
      * Calcula Monto Limite Deuda de Deudor Indirecto Credito
      *     MULTIPLY OPC-VAL-CRED IN SRT BY RDC-VAL-LIMD IN RDC
      *                       GIVING WSS-VAL-MONL IN WSS-RDC.
      *     DIVIDE WSS-VAL-MONL IN WSS-RDC BY 100 GIVING
      *            WSS-VAL-MONL IN WSS-RDC.
           COMPUTE WSS-VAL-MONL IN WSS-RDC =
                   ( OPC-VAL-CRED IN SRT * RDC-VAL-LIMD IN RDC ) / 100.
      *DAD  fin 02-MAY-1994

      ***** CRW-COMIENZO
      *    GENERATE DL-RDC.
           PERFORM GENERATE-DL-RDC.
      ***** CRW-FINAL


           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = RDC-CAI-IOPC IN RDC AND
                    OPC-IIC-IOPC IN SRT = RDC-IIC-IOPC IN RDC AND
                    DLC-NUM-IDLC IN DLC = RDC-NUM-IDLC IN RDC )
               GO TO FIN-GET-IND-RDC.
           GO TO LUP-GET-IND-RDC.
       FIN-GET-IND-RDC.
           EXIT.

       GET-ABN-CYA SECTION.
       INI-GET-ABN-CYA.
           IF WSS-MUL-CYA IN WSS-VARI NOT > ZEROES
               GO TO FIN-GET-ABN-CYA.

           MOVE OPC-CAI-IOPC IN SRT TO CYA-CAI-IOPC IN CYA.
           MOVE OPC-IIC-IOPC IN SRT TO CYA-IIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = CYA-CAI-IOPC IN CYA AND
                    OPC-IIC-IOPC IN SRT = CYA-IIC-IOPC IN CYA AND
                    CYA-NUM-ICAN IN CYA = ZEROES )
               GO TO FIN-GET-ABN-CYA.

           MOVE 'ABONOS' TO WSS-GLS-TIPM IN WSS-CYA.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'A'   TO TAB-CIC-CTAB IN TAB.
           MOVE 'MOV' TO TAB-CIC-TTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-TMOV IN WSS-CYA.

           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           MOVE MSC-COD-CMSC IN MSC TO WSS-MSC-TVOC IN WSS-VARI.
           IF OPC-MSC-TVOC IN SRT = WSS-MSC-TVOC IN WSS-VARI
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-CYA.

      ***** CRW-COMIENZO
      *    GENERATE DL-HCYA.
           PERFORM GENERATE-DL-HCYA.
      ***** CRW-FINAL

       LUP-GET-ABN-CYA.
           PERFORM BUS-GLS-CYA.
           MOVE CYA-IIC-ICYA IN CYA TO WSS-IIC-ICYA IN WSS-CYA.

      ***** CRW-COMIENZO
      *    GENERATE DL-CYA.
           PERFORM GENERATE-DL-CYA.
      ***** CRW-FINAL

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS AND
              OPC-CAI-IOPC IN SRT = CYA-CAI-IOPC IN CYA AND
              OPC-IIC-IOPC IN SRT = CYA-IIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES
               GO TO LUP-GET-ABN-CYA.
       FIN-GET-ABN-CYA.
           EXIT.

       GET-INT-ICG SECTION.
       INI-GET-INT-ICG.
           IF WSS-MUL-ICG IN WSS-VARI NOT > ZEROES
               GO TO FIN-GET-INT-ICG.

           MOVE ZEROES TO WSS-NUM-TASA IN WSS-ICG.
           MOVE OPC-CAI-IOPC IN SRT TO ICG-CAI-IOPC IN ICG.
           MOVE OPC-IIC-IOPC IN SRT TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN SRT AND
                    ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN SRT AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               GO TO FIN-GET-INT-ICG.
       LUP-GET-INT-ICG.
           PERFORM BUS-GLS-ICG.
           ADD 1 TO WSS-NUM-TASA IN WSS-ICG.

      ***** CRW-COMIENZO
      *    GENERATE DL-ICG.
           PERFORM GENERATE-DL-ICG.
      ***** CRW-FINAL

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN SRT AND
              ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN SRT AND
              ICG-NUM-ICAN IN ICG = ZEROES              AND
              ICG-CIC-IOPV IN ICG = SPACES              AND
              ICG-NUM-IVCT IN ICG = ZEROES              AND
              ICG-IND-TTAS IN ICG = 'INT'
               GO TO LUP-GET-INT-ICG.
       FIN-GET-INT-ICG.
           EXIT.

       BUS-DEU-IND SECTION.
       INI-BUS-DEU-IND.
           MOVE ZEROES TO WSS-MUL-DEUI IN WSS-VARI.
           MOVE DLC-CAI-IOPC IN DLC TO RDC-CAI-IOPC IN RDC.
           MOVE DLC-IIC-IOPC IN DLC TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               MOVE SPACES TO WSS-GLS-COMU IN WSS-DLC
               GO TO CON-BUS-DEU-IND.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               MOVE SPACES TO WSS-GLS-COMU IN WSS-DLC
               GO TO NXT-BUS-DEU-IND.

           PERFORM BUS-DIRE.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               PERFORM RST-RCD
               MOVE SPACES TO WSS-GLS-COMU IN WSS-DLC
               GO TO NXT-BUS-DEU-IND.

           PERFORM BUS-GLS-COMU.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-DLC.
       NXT-BUS-DEU-IND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              DLC-CAI-IOPC IN DLC = RDC-CAI-IOPC IN RDC AND
              DLC-IIC-IOPC IN DLC = RDC-IIC-IOPC IN RDC AND
              DLC-NUM-IDLC IN DLC = RDC-NUM-IDLC IN RDC
               MOVE 1 TO WSS-MUL-DEUI IN WSS-VARI
               PERFORM RST-RCD
               PERFORM RST-DBC
               MOVE SPACES TO WSS-GLS-COMU IN WSS-DLC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLC    MDIND' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC.
       CON-BUS-DEU-IND.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-ICLI IN DBC > SPACES
               MOVE '-' TO WSS-IND-SCLI IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-IND-SCLI IN WSS-DLC.
       FIN-BUS-DEU-IND.
           EXIT.

       BUS-DIRE SECTION.
       INI-BUS-DIRE.
           MOVE DBC-CAI-ICLI IN DBC TO RCD-CAI-ICLI IN RCD.
           MOVE DBC-IIC-ICLI IN DBC TO RCD-IIC-ICLI IN RCD.
           MOVE RDC-NUM-DIRE IN RDC TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO RCD-GLS-DIRE IN RCD.
       FIN-BUS-DIRE.
           EXIT.

       RST-DBC SECTION.
       INI-RST-DBC.
      *     MOVE 'SGC' TO MSG-COD-SIST.
      *     MOVE 'CLI    NEX' TO MSG-COD-MENS.
      *     PERFORM GET-MSG.
      *     MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC.
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.

       RST-RCD SECTION.
       INI-RST-RCD.
           MOVE SPACES TO RCD-GLS-DIRE IN RCD.
           MOVE SPACES TO RCD-NUM-FONO IN RCD.
           MOVE ZEROES TO RCD-NUM-DIRE IN RCD.
           MOVE SPACES TO RCD-COD-LUGA IN RCD.
       FIN-RST-RCD.
           EXIT.

       BUS-GLS-EVC SECTION.
       INI-BUS-GLS-EVC.
           IF EVC-IND-UTDV IN EVC > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IDMA'              TO MSC-COD-TMSC IN MSC
               MOVE EVC-IND-UTDV IN EVC TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-UTDV IN WSS-EVC
           ELSE
               MOVE SPACES TO WSS-GLS-UTDV IN WSS-EVC.

           PERFORM GET-PER-FEC.

           IF EVC-MSC-TCVE IN EVC > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'CVC '              TO TAB-COD-TTAB IN TAB
               MOVE EVC-MSC-TCVE IN EVC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TCVE IN WSS-EVC
           ELSE
               MOVE SPACES TO WSS-GLS-TCVE IN WSS-EVC.

           IF EVC-IND-UTSV IN EVC > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE EVC-IND-UTSV IN EVC TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-UTSV IN WSS-EVC
           ELSE
               MOVE SPACES TO WSS-GLS-UTSV IN WSS-EVC.
       FIN-BUS-GLS-EVC.
           EXIT.

       BUS-GLS-DLC SECTION.
       INI-BUS-GLS-DLC.
           IF DLC-COD-TDOC IN DLC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'DOC'               TO TAB-COD-TTAB IN TAB
               MOVE DLC-COD-TDOC IN DLC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TDOC IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-TDOC IN WSS-DLC.

           IF DLC-MSC-TIMP IN DLC > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'TIMP'              TO MSC-COD-TMSC IN MSC
               MOVE DLC-MSC-TIMP IN DLC TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-TIMP IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-TIMP IN WSS-DLC.

           MOVE DLC-COD-UBFD IN DLC TO WSS-UBFD IN WSS-VARI.
           IF WSS-TAB-UBFD NOT > SPACES
               MOVE SPACES TO WSS-GLS-UBFD IN WSS-DLC
           ELSE
               IF WSS-TAB-UBFD = 'OFI'
                   MOVE WSS-COD-UBFD TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   IF MSG-COD-MENS = 'COD    NEX'
                       MOVE SPACES TO WSS-GLS-UBFD IN WSS-DLC
                   ELSE
                       MOVE OFI-GLS-DESC IN OFI TO
                            WSS-GLS-UBFD IN WSS-DLC
               ELSE
                   MOVE 'TAB'        TO TAB-COD-SIST
                   MOVE WSS-TAB-UBFD TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-UBFD TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-UBFD IN WSS-DLC.

           IF DLC-COD-NOTC IN DLC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'NOT'               TO TAB-COD-TTAB IN TAB
               MOVE DLC-COD-NOTC IN DLC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-NOTC IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-NOTC IN WSS-DLC.

           IF DLC-COD-PLZA IN DLC > SPACES
               MOVE DLC-COD-PLZA IN DLC TO WSS-COD-PLZA IN WSS-VARI
               IF WSS-IND-OFIC IN WSS-VARI = 'O'
                   MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-PLZA IN WSS-DLC
               ELSE
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'PZA'               TO TAB-COD-TTAB IN TAB
                   MOVE DLC-COD-PLZA IN DLC TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-PLZA IN WSS-DLC
            ELSE
                MOVE SPACES TO WSS-GLS-PLZA IN WSS-DLC.

           IF DLC-MSC-MIPL IN DLC > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'MIPL'              TO MSC-COD-TMSC IN MSC
               MOVE DLC-MSC-MIPL IN DLC TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-MIPL IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-MIPL IN WSS-DLC.

           IF DLC-COD-PLZO IN DLC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PZO'               TO TAB-COD-TTAB IN TAB
               MOVE DLC-COD-PLZO IN DLC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-PLZO IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-PLZO IN WSS-DLC.

      *     IF DLC-IND-SCBZ IN DLC > SPACES
      *         MOVE 'COL'               TO MSC-COD-SIST
      *         MOVE 'SCBZ'              TO MSC-COD-TMSC IN MSC
      *         MOVE DLC-IND-SCBZ IN DLC TO MSC-COD-CMSC IN MSC
      *         PERFORM BUS-MSC
      *         MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-SCBZ IN WSS-DLC
      *     ELSE
      *         MOVE SPACES TO WSS-GLS-SCBZ IN WSS-DLC.

           MOVE 'COL'  TO FIO-SIST.
           MOVE 'TCCT' TO MSC-CIC-TMSC IN MSC.
           MOVE 'CAP'  TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               MOVE MSC-COD-CMSC IN MSC TO DCC-MSC-TCCT IN DCC
           ELSE
               MOVE 'CAP' TO DCC-MSC-TCCT IN DCC.
           MOVE OPC-COD-VCOC IN SRT TO DCC-COD-VCAM IN DCC.
           MOVE OPC-COD-TOOC IN SRT TO DCC-COD-TOCR IN DCC.
           MOVE OPC-COD-AOOC IN SRT TO DCC-COD-AOCR IN DCC.
           MOVE DLC-COD-PLZO IN DLC TO DCC-COD-PLZO IN DCC.
           MOVE DLC-IND-SCRT IN DLC TO DCC-IND-SCRT IN DCC.
           MOVE DLC-IND-SCTB IN DLC TO DCC-IND-SCTB IN DCC.
           MOVE DLC-IND-SCBZ IN DLC TO DCC-IND-SCBZ IN DCC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DCC.
           IF FIO-STAT-OKS
               MOVE DCC-CIC-TCCT IN DCC TO WSS-COD-TOSB IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-COD-TOSB IN WSS-DLC.
       FIN-BUS-GLS-DLC.
           EXIT.

       BUS-GLS-ICG SECTION.
       INI-BUS-GLS-ICG.
           IF ICG-MSC-BCTI IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'BCTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-BCTI IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-BCTI IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-BCTI IN WSS-ICG.

           IF ICG-MSC-PBTI IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'PBTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-PBTI IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-PBTI IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-PBTI IN WSS-ICG.

           IF ICG-MSC-BPBT IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'MCTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-BPBT IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-BPBT IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-BPBT IN WSS-ICG.

           IF ICG-MSC-SPBT IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'MCTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-SPBT IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-SPBT IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-SPBT IN WSS-ICG.

           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE 'I'                 TO VLR-MSC-TVAL IN VLR
               MOVE ICG-COD-CVTI IN ICG TO VLR-COD-CVAL IN VLR
               MOVE ICG-MSC-PBTI IN ICG TO VLR-COD-TCAM IN VLR
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE VLR-COD-VCAM IN VLR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CVTI IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-CVTI IN WSS-ICG.

           IF ICG-MSC-TFPR IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'TFPR'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-TFPR IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TFPR IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-TFPR IN WSS-ICG.

           IF ICG-MSC-UTPR IN ICG > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-UTPR IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-UTPR IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-UTPR IN WSS-ICG.

       FIN-BUS-GLS-ICG.
           EXIT.

       BUS-GLS-CYA SECTION.
       INI-BUS-GLS-CYA.
           IF CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TCYA IN WSS-CYA
           ELSE
               MOVE SPACES TO WSS-GLS-TCYA IN WSS-CYA.
           IF OPC-MSC-TVOC IN SRT = WSS-MSC-TVOC IN WSS-VARI
               MOVE 1 TO WSS-SGV-VCAM IN WSS-VARI
           ELSE
               MOVE ZEROES TO WSS-SGV-VCAM IN WSS-VARI.

           MULTIPLY WSS-SGV-VCAM IN WSS-VARI BY CYA-SGV-LIQU IN CYA
                    GIVING WSS-VAL-VPES IN WSS-CYA ROUNDED.
           IF OPC-MSC-TVOC IN SRT = WSS-MSC-TVOC IN WSS-VARI
               MOVE ZEROES TO CYA-SGV-LIQU IN CYA.
       FIN-BUS-GLS-CYA.
           EXIT.

       BUS-GLS-COMU SECTION.
       INI-BUS-GLS-COMU.
           IF RCD-COD-LUGA IN RCD > SPACES
               MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA
               IF WSS-IND-PAIS = 'P'
                   MOVE 'TAB'        TO TAB-COD-SIST
                   MOVE 'PAI'        TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-PAIS TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
               ELSE
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'COM'               TO TAB-COD-TTAB IN TAB
                   MOVE RCD-COD-LUGA IN RCD TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
           ELSE
               MOVE SPACES TO TAB-GLS-DESC IN TAB.
       FIN-BUS-GLS-COMU.
           EXIT.

       BUS-DLC-FIL-ANX SECTION.
       INI-BUS-DLC-FIL-ANX.
           PERFORM GET-CUR-ICG.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               MOVE SPACES TO WSS-GLS-TIPT IN WSS-DLC
               GO TO FIN-BUS-DLC-FIL-ANX.
           PERFORM GET-NXT-ICG
           IF ICG-COD-TINT IN ICG = 'M'
               MOVE 'M'    TO WSS-GLS-TIPT IN WSS-DLC
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               GO TO FIN-BUS-DLC-FIL-ANX.

           IF ICG-COD-TINT IN ICG > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'INT'               TO TAB-COD-TTAB IN TAB
               MOVE ICG-COD-TINT IN ICG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TIPT IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-TIPT IN WSS-DLC.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG.
       FIN-BUS-DLC-FIL-ANX.
           EXIT.

       GET-CUR-ICG SECTION.
       INI-GET-CUR-ICG.
           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
              ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               GO TO FIN-GET-CUR-ICG.
           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES       TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS     TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
                    ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
                    ICG-NUM-ICAN IN ICG = ZEROES       AND
                    ICG-CIC-IOPV IN ICG = SPACES       AND
                    ICG-NUM-IVCT IN ICG = ZEROES       AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-GET-CUR-ICG.
           EXIT.

       GET-NXT-ICG SECTION.
       INI-GET-NXT-ICG.
           MOVE ICG-NUM-ICAN IN ICG TO WSS-NUM-ICAN IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC      AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC      AND
              ICG-NUM-ICAN IN ICG = WSS-NUM-ICAN IN WSS-VARI AND
              ICG-CIC-IOPV IN ICG = SPACES                   AND
              ICG-NUM-IVCT IN ICG = ZEROES                   AND
              ICG-IND-TTAS IN ICG = 'INT'
                MOVE 'M' TO ICG-COD-TINT IN ICG
           ELSE
                MOVE SPACES TO ICG-COD-TINT IN ICG
                PERFORM GET-CUR-ICG.
       FIN-GET-NXT-ICG.
           EXIT.

       GET-PER-FEC SECTION.
       INI-GET-PER-FEC.
           MOVE FEC-RET-JUL             TO FEC-CMND.
           MOVE FEC-FORM-FEC            TO FEC-FORM.
           MOVE EVC-NUM-DPVC IN EVC     TO FEC-ITM1.
           MOVE EVC-NUM-MPVC IN EVC     TO FEC-ITM2.
           MOVE EVC-NUM-SPVC IN EVC     TO FEC-ITM3.
           MOVE EVC-NUM-APVC IN EVC     TO FEC-ITM4.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-FJUL            TO WSS-NUM-JUL.
           MOVE FEC-RET-JUL         TO FEC-CMND.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE OPC-NUM-DCOL IN SRT TO FEC-ITM1.
           MOVE OPC-NUM-MCOL IN SRT TO FEC-ITM2.
           MOVE OPC-NUM-SCOL IN SRT TO FEC-ITM3.
           MOVE OPC-NUM-ACOL IN SRT TO FEC-ITM4.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           SUBTRACT FEC-FJUL FROM WSS-NUM-JUL
                           GIVING WSS-NUM-SPVE IN WSS-EVC
           MOVE 'D' TO WSS-IND-UTPV IN WSS-EVC.
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE WSS-IND-UTPV IN WSS-EVC TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-UTPV IN WSS-EVC.
       FIN-GET-PER-FEC.
           EXIT.

       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFVEN.
       COPY COLBFRDC.
       COPY COLBFCYA.
       COPY COLBFICG.
       COPY COLBFROV.
       COPY COLBFAUT.
       COPY COLBFITR.
       COPY COLBFCOM.
       COPY COLBFDCC.

       COPY SGCBFDBC.
       COPY SGCBFRCD.

       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBFUSR.
       COPY TABBFVLR.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY TABBVOFI.
       COPY TABBVUSR.

       COPY GNSBVTAB.
       COPY GNSBGCPT.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *
      *>>>>

