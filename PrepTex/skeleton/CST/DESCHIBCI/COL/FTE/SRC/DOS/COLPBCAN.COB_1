       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.      COLPBCAN.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    08-AGO-1994     (Ultima Modificacion).
      * ACTUALIZA CANCELACIONES DE COLOCACIONES EN FORMA BACH.

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *------------------------
       COPY COLBRCAN.
       COPY COLBRRCV.
       COPY COLBRVEN.
       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBRTOC.
       COPY COLBRRCE.
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
       COPY COLBRCYA.
      *DAD fin  09-ABR-1992
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
       COPY COLBRRDT.
      *DAD fin  27-APR-1993
       COPY GNSWVFIO.
       COPY GNSWCFIO.
       COPY GNSWVIDD.
       COPY GNSWGHOY.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GNSBRERR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
      *DAD fin  09-ABR-1992
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
      *DAD fin  27-APR-1993
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBI-REQA==.
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ERR-REQA==.

       01  WSS-VARI.
      *DAD ini  31-MAY-1993
           03  WSS-IND-EXIS         VALUE 'N'   PIC X(01).
           03  WSS-VAL-CAPI-GENE    COMP-3      PIC 9(11)V9(04).
      *DAD fin  31-MAY-1993
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2) / (Memo.08-10-92)
           03  WSS-MSC-OPEC                     PIC X(04).
           03  WSS-FEC-FAMT.
               05  WSS-NUM-SAMT                 PIC 9(02).
               05  WSS-NUM-AAMT                 PIC 9(02).
               05  WSS-NUM-MAMT                 PIC 9(02).
               05  WSS-NUM-DAMT                 PIC 9(02).
      *DAD fin  27-APR-1993
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
           03  WSS-TBL-RCYA.
               05  WSS-RCYA      OCCURS 10      PIC X(92).
           03  WSS-J             VALUE ZEROES   PIC 9(02).
      *DAD fin  09-ABR-1992
      *DAD ini  22-MAY-1992   (Memo.20-05-92)
           03  WSS-K             VALUE ZEROES   PIC 9(02).
      *DAD fin  22-MAY-1992
      *DAD ini  08-JUL-1991
           03  WSS-IND-VSTR                     PIC X(01).
           03  WSS-NUM-IVEN                     PIC 9(03).
      *DAD fin  08-JUL-1991
           03  WSS-MAXV                         PIC 9(03).
           03  WSS-MINV                         PIC 9(03).
           03  WSS-MAXD                         PIC 9(03).
           03  WSS-MIND                         PIC 9(03).
           03  WSS-NUM-DBIN                     PIC 9(03).
           03  WSS-NUM-DBOU                     PIC 9(03).
           03  WSS-CIC-DBIN                     PIC X(12).
           03  WSS-CIC-DBOU                     PIC X(12).
           03  WSS-REGI.
               05  FILLER                       PIC X(30).
               05  WSS-MSC-TACC                 PIC X(01).
               05  FILLER                       PIC X(86).
           03  WSS-NUM-IDLC                     PIC 9(04).
           03  WSS-IDLC.
               05  WSS-VEC-IDLC OCCURS 1000.
                   07  WSS-SGV-CAPI   COMP-3    PIC S9(11)V9(04).
                   07  WSS-SGV-FINA   COMP-3    PIC S9(11)V9(04).
           03  WSS-SGV-CAPT           COMP-3    PIC S9(11)V9(04).
           03  WSS-SGV-FINL           COMP-3    PIC S9(11)V9(04).
           03  WSS-NUM-VCVG                     PIC 9(03).
           03  WSS-NUM-TVCC                     PIC 9(03).
           03  WSS-NUM-VCCM                     PIC 9(03).
           03  WSS-NUM-VCCO                     PIC 9(03).
           03  WSS-NUM-VCCV                     PIC 9(03).
           03  WSS-FEC-FPRO.
               05  WSS-NUM-DPRO                 PIC 9(02).
               05  WSS-NUM-MPRO                 PIC 9(02).
               05  WSS-NUM-SPRO                 PIC 9(02).
               05  WSS-NUM-APRO                 PIC 9(02).
           03  WSS-I            VALUE ZEROES    PIC 9(03).
           03  WSS-IMAX         VALUE 50        PIC 9(03).
           03  WSS-TREG                         PIC X(03).
           03  WSS-TACC                         PIC X(01).
           03  WSS-TAB-ESTD.
               05  WSS-VEC-ESTD OCCURS 50.
                   07  WSS-IND-TREG             PIC X(03).
                   07  WSS-IND-TACC             PIC X(01).
                   07  WSS-NUM-RRCH             PIC 9(06).
                   07  WSS-NUM-RLEI             PIC 9(06).
                   07  WSS-NUM-RPRO             PIC 9(06).
      *JSS 24-JUN-1991 19:19:32
           03  WSS-FEC-FDEV.
               05  WSS-NUM-SDEV                 PIC 9(02).
               05  WSS-NUM-ADEV                 PIC 9(02).
               05  WSS-NUM-MDEV                 PIC 9(02).
               05  WSS-NUM-DDEV                 PIC 9(02).
           03  WSS-AUX-IVEN                     PIC 9(03).
      *JSS PARA V3.1
      *( IDBM = INDICE DE BASE DE DATOS MAESTRA,       ANTES=13 )
      *( IDBT = INDICE DE BASE DE DATOS TRANSACCIONES, ANTES=14 )
      *EN VERSION 3.1 SE DETERMINAN CON UN SEARC SOBRE IDD
           03  WSS-IDBM                         PIC 9(03).
           03  WSS-IDBT                         PIC 9(03).
      *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGPES.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY COLBREVC.
       COPY COLBRICG.
       COPY COLBRVEN REPLACING ==VEN== BY ==VEN-BKP==.
       COPY COLWGVEN.
       COPY TABBRCAM.
      *JSS - FIN


       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.
           PERFORM INI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MAIN.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR
               PERFORM PRO-ERR
               MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR
               GO TO FIN-MAIN.
       LUP-MAIN.
           MOVE 'CAN'               TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN TO WSS-TACC IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN TO ERR-MSC-TACC IN ERR.
           PERFORM GEN-ESTD.
           IF CAN-MSC-STAT > SPACES
               GO TO CAN-MAIN.
           PERFORM CHK-PNT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MAIN.
           IF CAN-MSC-TCAN IN CAN NOT = 'N'
               MOVE CAN-CIC-IOPC IN CAN TO RCE-KEY-DISP IN RCE
               MOVE 'RCE-KEY-DISP' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM COL-FIO-RCE
               IF FIO-STAT-OKS
                   MOVE RCE-CIC-IOPC IN RCE TO WSS-CIC-DBOU IN WSS-VARI
                   MOVE RCE-KEY-DISP IN RCE TO WSS-CIC-DBIN IN WSS-VARI
               ELSE
                   MOVE CAN-CIC-IOPC IN CAN TO WSS-CIC-DBIN IN WSS-VARI
                   MOVE CAN-CIC-IOPC IN CAN TO WSS-CIC-DBOU IN WSS-VARI
           ELSE
               MOVE CAN-CIC-IOPC IN CAN TO WSS-CIC-DBIN IN WSS-VARI
               MOVE CAN-CIC-IOPC IN CAN TO WSS-CIC-DBOU IN WSS-VARI.
           MOVE 'CAN'                    TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN      TO WSS-TACC IN WSS-VARI.
           MOVE ADR-CAN-REQA             TO ADR-DBI-REQA.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBOU IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
       ING-MAIN.
      *DAD ini  8-JUL-1991
      * Se lee OPC para obtener IND-VSTR asociado a la CAN en proceso
           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE OPC : ' OPC-CIC-IOPC IN OPC
               MOVE ADR-DBI-REQA TO ADR-CAN-REQA
               GO TO CAN-MAIN.
           MOVE OPC-IND-VSTR IN OPC TO WSS-IND-VSTR IN WSS-VARI.
      *DAD fin  8-JUL-1991
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
      *Obtencion del Opera Como para comparaciones posteriores
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE TOC : ' TOC-COD-TOCR IN TOC
                       'OPC : ' OPC-CIC-IOPC IN OPC
               MOVE ADR-DBI-REQA TO ADR-CAN-REQA
               GO TO CAN-MAIN.
           MOVE TOC-MSC-OPEC IN TOC TO WSS-MSC-OPEC IN WSS-VARI.
      *DAD fin  27-APR-1993
           IF CAN-MSC-TACC = 'I'
               MOVE 'A'                      TO CAN-MSC-STAT IN CAN
      *DAD ini  25-OCT-1991
               MOVE 'BACH'                   TO CAN-COD-OTRN IN CAN
      *DAD fin  25-OCT-1991
               MOVE HOY-STP-ITRN IN HOY-VARI TO CAN-STP-ITRN IN CAN
               MOVE WSS-NUM-SPRO IN WSS-VARI TO CAN-NUM-SOUT IN CAN
               MOVE WSS-NUM-APRO IN WSS-VARI TO CAN-NUM-AOUT IN CAN
               MOVE WSS-NUM-MPRO IN WSS-VARI TO CAN-NUM-MOUT IN CAN
               MOVE WSS-NUM-DPRO IN WSS-VARI TO CAN-NUM-DOUT IN CAN
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF NOT FIO-STAT-OKS
                   PERFORM GEN-ESTD
                   PERFORM PRO-ERR
                   GO TO NXT-MAIN
               ELSE
                   PERFORM GEN-ESTD
                   GO TO NXT-MAIN.
           MOVE CAN TO WSS-REGI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
               GO TO NXT-MAIN.
           MOVE WSS-MSC-TACC TO CAN-MSC-TACC IN CAN.
           IF CAN-MSC-TACC = 'M'
               MOVE WSS-REGI TO CAN
               MOVE HOY-STP-ITRN IN HOY-VARI TO CAN-STP-ITRN IN CAN
      *DAD ini  25-OCT-1991
               MOVE 'BACH'                   TO CAN-COD-OTRN IN CAN
      *DAD fin  25-OCT-1991
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF NOT FIO-STAT-OKS
                   PERFORM GEN-ESTD
                   PERFORM PRO-ERR
               ELSE
                   PERFORM GEN-ESTD
           ELSE
      *    IF CAN-MSC-TACC = 'E'
      *        MOVE FIO-DEL TO FIO-CMND
      *        PERFORM COL-FIO-CAN
      *        IF NOT FIO-STAT-OKS
      *            PERFORM PRO-ERR
      *        ELSE
      *            NEXT SENTENCE
      *    ELSE
               MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
               MOVE 'MSCTACCNEX'             TO ERR-COD-MENS IN ERR
               MOVE 'CAN-MSC-TACC'           TO ERR-COD-CMPO IN ERR
               MOVE ADR-DBI-REQA             TO ADR-REQA
               MOVE FIO-STAT-NEX             TO FIO-STAT
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
               MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR.
       NXT-MAIN.
      *    PERFORM PRO-ICG.
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
           PERFORM PRO-CYA.
      *DAD fin  09-ABR-1992
           PERFORM PRO-RCV.
           IF ERR-IND-RBCK IN ERR-VARI = ERR-RBCK-YES IN ERR-VARI
               PERFORM BCK-OUT
               IF NOT FIO-STAT-OKS
                   GO TO FIN-MAIN
               ELSE
                   GO TO RQA-MAIN.
      *JSS 26-JUN-1991 20:15:19 para guardar fecha de devengo
      *en cancelacion de output
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBOU IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO RQA-MAIN.
           MOVE WSS-FEC-FDEV TO CAN-FEC-FDVA IN CAN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO RQA-MAIN.
      *JSS - FIN
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBIN IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO RQA-MAIN.
           MOVE 'A' TO CAN-MSC-STAT IN CAN.
      *Parametrizar? ^
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR.
       RQA-MAIN.
           MOVE ADR-DBI-REQA TO ADR-CAN-REQA.
       CAN-MAIN.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE FIO-KDEF-S  TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
               GO TO LUP-MAIN.
       FIN-MAIN.
           PERFORM IMP-ESTD.
           PERFORM CLO-FIL.
      *DAD ini  27-APR-1993
      * COPY GNSBGGBK.
           PERFORM GNS-PRO-END.
      *DAD fin  27-APR-1993
      ******************************************************************
      ******************************************************************
       INI SECTION.
       INI-INI.
           MOVE 'COLPBCAN' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *BUSCA LA POSICION EN IDD DONDE SE ENCUENTRA EL NUMERO DE
      *LA BASE DE DATOS DE TRANSACCIONES
           MOVE 'T' TO IDD-GAUX.
           PERFORM BUS-IND-BDATOS.
      *DAD ini  08-AGO-1994   (Memo.08-08-94 Pto.1)
      *     MOVE ADR-DBID IN ADR-REQA TO WSS-IDBT.
           MOVE IDD-IAUX TO WSS-IDBT.
      *DAD fin  08-AGO-1994
      *BUSCA LA POSICION EN IDD DONDE SE ENCUENTRA EL NUMERO DE
      *LA BASE DE DATOS MAESTRA
           MOVE 'M' TO IDD-GAUX.
           PERFORM BUS-IND-BDATOS.
      *DAD ini  08-AGO-1994   (Memo.08-08-94 Pto.1)
      *     MOVE ADR-DBID IN ADR-REQA TO WSS-IDBM.
           MOVE IDD-IAUX TO WSS-IDBM.
      *DAD fin  08-AGO-1994
      *
           PERFORM GET-FHOY.
      *Captura Fecha de Proceso
           DISPLAY 'FECHA PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      *VAL-FEC Valida Fecha de Proceso
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
           PERFORM INI-ESTD VARYING WSS-I FROM 1 BY 1
                              UNTIL WSS-I > WSS-IMAX.
           MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR.
           MOVE 'COLPBCAN'               TO ERR-COD-ATRN IN ERR.
           MOVE ERR-TTRN-BAT IN ERR-VARI TO ERR-MSC-TTRN IN ERR.
           MOVE ERR-SVRT-FAT IN ERR-VARI TO ERR-IND-SVRT IN ERR.
           MOVE IDD-IENT(WSS-IDBT) TO WSS-NUM-DBIN.
           MOVE IDD-IENT(WSS-IDBM) TO WSS-NUM-DBOU.
           MOVE WSS-NUM-DBIN TO IDD-IENT(WSS-IDBM).
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
      *DAD fin  09-ABR-1992
           MOVE WSS-NUM-DBOU TO IDD-IENT(WSS-IDBM).
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               GO TO FIN-INI.
      *DAD fin  09-ABR-1992
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               MOVE 100 TO RETURN-CODE
               GO TO FIN-INI.
      *DAD fin  27-APR-1993
      *    MOVE FIO-UPD TO FIO-CMND.
      *    PERFORM GNS-FIO-ERR.
      *    IF NOT FIO-STAT-OKS
      *        PERFORM PRO-ERR
      *        GO TO FIN-INI.
           MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR.
       FIN-INI.
           EXIT.
      *-----------------------------------------------------------------
       INI-ESTD SECTION.
       INI-INI-ESTD.
           MOVE SPACES TO WSS-IND-TREG(WSS-I).
           MOVE SPACES TO WSS-IND-TACC(WSS-I).
           MOVE ZEROES TO WSS-NUM-RLEI(WSS-I).
           MOVE ZEROES TO WSS-NUM-RRCH(WSS-I).
           MOVE ZEROES TO WSS-NUM-RPRO(WSS-I).
       FIN-INI-ESTD.
           EXIT.
      ******************************************************************
       CHK-PNT SECTION.
       INI-CHK-PNT.
           MOVE SPACES TO ERR-COD-MENS IN ERR.
           MOVE SPACES TO ERR-IND-RBCK IN ERR-VARI.
           MOVE ZEROES TO WSS-NUM-VCVG IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-TVCC IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCM IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCO IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCV IN WSS-VARI.
           PERFORM RST-DLC VARYING WSS-NUM-IDLC FROM 1 BY 1
                             UNTIL WSS-NUM-IDLC > 1000.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO ADR-DBID IN ADR-REQA.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM GNS-FIO-DTC.
           IF NOT FIO-STAT-OKS
               MOVE ERR-SVRT-FAT IN ERR-VARI TO ERR-IND-SVRT IN ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               PERFORM PRO-ERR.
       FIN-CHK-PNT.
           EXIT.
      *-----------------------------------------------------------------
       RST-DLC SECTION.
       INI-RST-DLC.
           MOVE ZEROES TO WSS-SGV-CAPI(WSS-NUM-IDLC)
                          WSS-SGV-FINA(WSS-NUM-IDLC).
       FIN-RST-DLC.
           EXIT.
      ******************************************************************
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
       PRO-CYA SECTION.
       INI-PRO-CYA.
           MOVE SPACES TO WSS-TBL-RCYA IN WSS-VARI.
      *DAD ini  22-MAY-1992   (Memo.20-05-92)
           MOVE 0      TO WSS-K        IN WSS-VARI.
      *DAD fin  22-MAY-1992
           MOVE 'CYA'                    TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN      TO WSS-TACC IN WSS-VARI.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBIN IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
      * Parametrizar ?   ^
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-CYA.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CYA-KEY-ICAN IN CYA = CAN-KEY-ICAN IN CAN )
               GO TO PUT-PRO-CYA.
           PERFORM GEN-ESTD.
      *DAD ini  22-MAY-1992   (Memo.20-05-92)
           ADD 1    TO WSS-K    IN WSS-VARI.
           MOVE CYA TO WSS-RCYA IN WSS-VARI(WSS-K).
           MOVE WSS-K IN WSS-VARI TO WSS-J IN WSS-VARI.
      *DAD fin  22-MAY-1992
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-CYA.
       PUT-PRO-CYA.
      *DAD ini  22-MAY-1992   (Memo.20-05-92)
           IF WSS-K IN WSS-VARI NOT > 0
               GO TO FIN-PRO-CYA.
           PERFORM PUT-RCYA VARYING WSS-K FROM 1 BY 1
                              UNTIL WSS-K > WSS-J.
      *DAD fin  22-MAY-1992
       FIN-PRO-CYA.
           EXIT.
      *-----------------------------------------------------------------
       PUT-RCYA SECTION.
       INI-PUT-RCYA.
           MOVE 'CYA'                    TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN      TO WSS-TACC IN WSS-VARI.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
      *DAD ini  22-MAY-1992   (Memo.20-05-92)
           MOVE WSS-RCYA IN WSS-VARI(WSS-K) TO CYA.
      *DAD fin  22-MAY-1992
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
               PERFORM GEN-ESTD.
       FIN-PUT-RCYA.
           EXIT.
      *DAD fin  09-ABR-1992
      ******************************************************************
      ******************************************************************
       PRO-RCV SECTION.
       INI-PRO-RCV.
           MOVE 'RCV'                    TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN      TO WSS-TACC IN WSS-VARI.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBIN IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
      * Parametrizar ?   ^
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE SPACES              TO RCV-KEY-IVCT IN RCV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF FIO-STAT-OKS AND
              RCV-KEY-ICAN IN RCV = CAN-KEY-ICAN IN CAN
               GO TO LUP-PRO-RCV.
           IF NOT ( CAN-MSC-FCAN = 'T' AND CAN-MSC-ECAN = 'T' )
      * Parametrizar ?              ^                      ^
               MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
               MOVE 'MSCFCANECANT'           TO ERR-COD-MENS IN ERR
               MOVE 'CAN-COD-TCAN'           TO ERR-COD-CMPO IN ERR
               MOVE ADR-CAN-REQA             TO ADR-REQA
               MOVE FIO-STAT-NEX             TO FIO-STAT
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
               MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR
               GO TO FIN-PRO-RCV.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           IF CAN-MSC-TCAN IN CAN = 'N'
               MOVE WSS-CIC-DBIN IN WSS-VARI TO CAN-CIC-IOPC IN CAN
           ELSE
               MOVE WSS-CIC-DBOU IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
           MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN.
           MOVE 999                 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = VEN-CIC-IOPC IN VEN
               MOVE VEN-NUM-IVEN IN VEN TO WSS-MAXV
           ELSE
               MOVE ZEROES TO WSS-MAXV.
           MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = VEN-CIC-IOPC IN VEN
               MOVE VEN-NUM-IVEN IN VEN TO WSS-MINV
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE ZEROES TO WSS-MINV.
           MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN.
           PERFORM PRO-VCT VARYING VEN-NUM-IVEN IN VEN FROM WSS-MINV
                              BY 1 UNTIL NOT FIO-STAT-OKS OR
                                         VEN-NUM-IVEN IN VEN > WSS-MAXV.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           IF CAN-MSC-TCAN IN CAN = 'N'
               MOVE WSS-CIC-DBIN IN WSS-VARI TO CAN-CIC-IOPC IN CAN
           ELSE
               MOVE WSS-CIC-DBOU IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
           MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC.
           MOVE 999                 TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = DLC-CIC-IOPC IN DLC
               MOVE DLC-NUM-IDLC IN DLC TO WSS-MAXD
           ELSE
               MOVE ZEROES TO WSS-MAXD.
           MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = DLC-CIC-IOPC IN DLC
               MOVE DLC-NUM-IDLC IN DLC TO WSS-MIND
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE ZEROES       TO WSS-MIND.
           MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC.
           PERFORM PRO-DLC VARYING DLC-NUM-IDLC FROM WSS-MIND BY 1
                             UNTIL NOT FIO-STAT-OKS OR
                                   DLC-NUM-IDLC > WSS-MAXD.
           PERFORM PRO-OPC.
           GO TO FIN-PRO-RCV.
       LUP-PRO-RCV.
           PERFORM GEN-ESTD.
           IF RCV-NUM-IVCT IN RCV > ZEROES
               MOVE RCV-KEY-IVCT IN RCV TO VEN-KEY-IVEN IN VEN
               PERFORM PRO-VEN
               MOVE RCV-NUM-IDLC IN RCV TO WSS-NUM-IDLC
               ADD  RCV-SGV-CAPI IN RCV TO WSS-SGV-CAPI(WSS-NUM-IDLC)
               ADD  RCV-SGV-FINA IN RCV TO WSS-SGV-FINA(WSS-NUM-IDLC)
               IF FIO-STAT-OKS
                   IF VEN-VAL-SFIN IN VEN NOT > ZEROES
                       ADD 1 TO WSS-NUM-VCVG IN WSS-VARI
                       ADD 1 TO WSS-NUM-TVCC IN WSS-VARI
                       IF RCV-IND-SCTB = 'VCD'
                           ADD 1 TO WSS-NUM-VCCV IN WSS-VARI
                       ELSE
                           IF RCV-MSC-MCAN = 'V'
                               ADD 1 TO WSS-NUM-VCCM IN WSS-VARI
                           ELSE
                               ADD 1 TO WSS-NUM-VCCO IN WSS-VARI
                   ELSE
                       NEXT SENTENCE
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE ZEROES TO WSS-NUM-IDLC
               IF CAN-MSC-ECAN NOT = 'N'
      * Parametrizar ?                ^
                   MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
                   MOVE 'MSCECANNOTN'            TO ERR-COD-MENS IN ERR
                   MOVE 'CAN-MSC-ECAN'           TO ERR-COD-CMPO IN ERR
                   MOVE ADR-CAN-REQA             TO ADR-REQA
                   MOVE FIO-STAT-NEX             TO FIO-STAT
                   PERFORM GEN-ESTD
                   PERFORM PRO-ERR
                   MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR.
           MOVE 'RCV'               TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN TO WSS-TACC IN WSS-VARI.
           ADD  RCV-SGV-CAPI IN RCV TO WSS-SGV-CAPI(1000).
           ADD  RCV-SGV-FINA IN RCV TO WSS-SGV-FINA(1000).
           MOVE ADR-RCV-REQA             TO ADR-AUX-REQA.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBOU IN WSS-VARI TO RCV-CIC-IOPC IN RCV.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
               PERFORM GEN-ESTD.
       NXT-PRO-RCV.
           MOVE ADR-AUX-REQA             TO ADR-RCV-REQA.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE FIO-KDEF-S  TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF FIO-STAT-OKS AND
              RCV-KEY-ICAN IN RCV = CAN-KEY-ICAN IN CAN
               GO TO LUP-PRO-RCV.
           PERFORM PRO-OPE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-RCV.
           IF WSS-NUM-IDLC > ZEROES
               MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC
               PERFORM PRO-DOC VARYING WSS-NUM-IDLC FROM 1 BY 1
                                 UNTIL WSS-NUM-IDLC > 999.
      *JSS 24-JUN-1991 19:02:57
      *Despues de procesar Vencimiento cancelado, Operacion y Documentos
      *genera siguiente vencimiento para creditos con EVC ( si correspon
      *es decir cuando cancelo totalmente el vencimiento, aun queda sald
      *del credito ( se supone que no se procesan reversas )
           IF OPC-IND-VSTR IN OPC = 'S'        AND
              VEN-VAL-SFIN IN VEN NOT > ZEROES AND
              OPC-VAL-SCRE IN OPC > ZEROES
               MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM)
               MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
               PERFORM GEN-SIG-VEN.
       FIN-PRO-RCV.
           EXIT.
      ******************************************************************
       GEN-SIG-VEN SECTION.
       INI-GEN-SIG-VEN.
           MOVE SPACES TO MSG-COD-MENS.
      *Lee fisicamente el VEN=1 ( el que se cancelo )
           MOVE 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           ADD 1 VEN-NUM-IVCT IN VEN GIVING WSS-AUX-IVEN.
      *Busca si existe un VEN siguiente para eliminarlo ( ya que el
      *que se cancela puede estar moroso y en ese caso existe uno o mas
      *vencimientos fisicos adicionales )
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-VEN
      *DAD ini  31-MAY-1993
               IF FIO-STAT-OKS
      *Respalda el VEN leido antes de eliminarlo
                   MOVE VEN TO VEN-BKP
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM COL-FIO-VEN
                   IF FIO-STAT-OKS
                       MOVE 'S' TO WSS-IND-EXIS
                   ELSE
                       MOVE 'VEN    NODEL' TO MSG-COD-MENS
                       GO TO FIN-GEN-SIG-VEN
               ELSE
                   MOVE 'VEN    NOGKU' TO MSG-COD-MENS
                   GO TO FIN-GEN-SIG-VEN
           ELSE
               MOVE 'N' TO WSS-IND-EXIS.
      *DAD fin  31-MAY-1993
      *
      *Pide a la rutina de expansion generar el siguiente vencimiento
      *al cancelado ( Asume la FCOL para poder generarlo con mayor
      *probabilidad )
           MOVE OPC-CIC-IOPC IN OPC      TO     VEN-CIC-IOPC IN VEN.
      *JSS ADD 1 VEN-NUM-IVCT IN CAN-FLD GIVING VEN-NUM-IVEN IN VEN.
           MOVE WSS-AUX-IVEN             TO     VEN-NUM-IVEN IN VEN.
           MOVE OPC-NUM-DCOL IN OPC TO VEN-DTBS.
           MOVE OPC-NUM-MCOL IN OPC TO VEN-MTBS.
           MOVE OPC-NUM-SCOL IN OPC TO VEN-STBS.
           MOVE OPC-NUM-ACOL IN OPC TO VEN-ATBS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-OBT-VEN.
           IF NOT VEN-STAT-OKS
               MOVE VEN-STAT TO MSG-COD-MENS
      *JSS     MOVE VEN-MEN2 TO FRM-MEN2
               GO TO FIN-GEN-SIG-VEN.
      *
      *DAD ini  31-MAY-1993
      *Respalda el nuevo VEN generado cuando no existia este VEN
           IF WSS-IND-EXIS = 'N'
               MOVE VEN TO VEN-BKP.
           MOVE SPACES              TO MSG-COD-MENS.
           MOVE VEN-VAL-CAPI IN VEN TO WSS-VAL-CAPI-GENE.
      *Lee el 1er VEN fisico ( el cancelado )
           MOVE  1  TO VEN-NUM-IVEN IN VEN
                       VEN-NUM-IVEN IN VEN-BKP.
      *     MOVE VEN TO VEN-BKP.
      *DAD fin  31-MAY-1993
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENIVENNEX=1' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN.
      *Regraba el VEN respaldado con VEN-NUM-IVEN = 1
           MOVE VEN-BKP TO VEN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
      *DAD ini  31-MAY-1993
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    NOMOD' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN.
      *DAD fin  31-MAY-1993
      *Proyeccion Estructura => actualizar EVC y DLC
           PERFORM ACT-REVC-RDLC.
      *DAD ini  27-APR-1993   (Memo.08-10-92)
      *Renumera los VEN existentes
           IF MSG-COD-MENS NOT > SPACES
               PERFORM ACT-VEN-SHFT.
      *DAD fin  27-APR-1993
       FIN-GEN-SIG-VEN.
           EXIT.
      *-----------------------------------------------------------------
       ACT-REVC-RDLC SECTION.
       INI-ACVT-REVC.
           MOVE 1 TO VEN-I.
      *Primer LUP para actualizar estructuras
       LU1-ACT-REVC-RDLC.
           IF VEN-I > VEN-EMAX
               GO TO CON-ACT-REVC-RDLC.
           MOVE VEN-CIC-IOPC IN VEN TO EVC-CIC-IOPC IN EVC.
           MOVE EVC-IEVC(VEN-I)     TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    EVCNX' TO MSG-COD-MENS VEN-STAT
               GO TO FIN-ACT-REVC-RDLC.
           MOVE EVC-DPVC(VEN-I) TO EVC-NUM-DPVC IN EVC.
           MOVE EVC-MPVC(VEN-I) TO EVC-NUM-MPVC IN EVC.
           MOVE EVC-SPVC(VEN-I) TO EVC-NUM-SPVC IN EVC.
           MOVE EVC-APVC(VEN-I) TO EVC-NUM-APVC IN EVC.
           MOVE EVC-VCAN(VEN-I) TO EVC-NUM-VCAN IN EVC.
           MOVE EVC-IVCT(VEN-I) TO EVC-NUM-IVCT IN EVC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    EVCNX' TO MSG-COD-MENS VEN-STAT
               GO TO FIN-ACT-REVC-RDLC.
           ADD 1 TO VEN-I.
           GO TO LU1-ACT-REVC-RDLC.
       CON-ACT-REVC-RDLC.
      *
           MOVE ZEROES TO VEN-I.
      *Segundo LUP para actualizar documentos
       LUP-ACT-REVC-RDLC.
           ADD 1 TO VEN-I.
           IF VEN-I > 10
               GO TO FIN-ACT-REVC-RDLC.
           IF DLC-TDOC(VEN-I) NOT > SPACES
               GO TO LUP-ACT-REVC-RDLC.
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-I               TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO LUP-ACT-REVC-RDLC.
           MOVE DLC-SINT(VEN-I) TO DLC-VAL-SINT IN DLC.
           MOVE DLC-FAMT(VEN-I) TO DLC-FEC-FAMT IN DLC.
           MOVE DLC-SCPA(VEN-I) TO DLC-VAL-SCPA IN DLC.
      *DAD ini  31-MAY-1993
      *Cuando Exista el VEN y SOLO se genere para proyectar las estructu
           IF WSS-IND-EXIS = 'S'
               ADD WSS-VAL-CAPI-GENE        TO   DLC-VAL-SCPA IN DLC
               SUBTRACT VEN-VAL-CAPI IN VEN FROM DLC-VAL-SCPA IN DLC.
           MOVE 'N' TO WSS-IND-EXIS.
      *DAD fin  31-MAY-1993
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           GO TO LUP-ACT-REVC-RDLC.
       FIN-ACT-REVC-RDLC.
           EXIT.
      *-----------------------------------------------------------------
       COPY GNSBFMSC.
       COPY GNSBGPES.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY COLBFEVC.
       COPY COLBFICG.
       COPY COLBGVEN.
       COPY TABBFCAM.
      *JSS - FIN
      *-----------------------------------------------------------------
      *DAD ini  27-APR-1993   (Memo.08-10-92)
      *Renumera los VEN existentes
       ACT-VEN-SHFT SECTION.
       INI-ACT-VEN-SHFT.
           MOVE 1 TO WSS-AUX-IVEN
                     VEN-NUM-IVEN IN VEN.
      * Lee fisicamente el Primer VEN
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
       LUP-ACT-VEN-SHFT.
      * Lee fisicamente el Siguiente VEN
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
               GO TO FIN-ACT-VEN-SHFT.
      * Elimina el VEN tomado de UPD previamente Respaldado
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENSHFTNOUPD' TO MSG-COD-MENS
               GO TO FIN-ACT-VEN-SHFT.
           MOVE VEN TO VEN-BKP.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENSHFTNODEL' TO MSG-COD-MENS
               GO TO FIN-ACT-VEN-SHFT.
      * Graba el VEN Respaldado luego de Actualizar
           MOVE VEN-BKP TO VEN.
           ADD 1 TO WSS-AUX-IVEN.
           MOVE WSS-AUX-IVEN TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENSHFTNOPUT' TO MSG-COD-MENS
               GO TO FIN-ACT-VEN-SHFT.
           MOVE VEN-BKP TO VEN.
           GO TO LUP-ACT-VEN-SHFT.
       FIN-ACT-VEN-SHFT.
           EXIT.
      *DAD fin  27-APR-1993
      ******************************************************************
       PRO-VCT SECTION.
       INI-PRO-VCT.
           MOVE 'VEN'                    TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN      TO WSS-TACC IN WSS-VARI.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBOU IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               MOVE VEN-CIC-IOPC IN VEN TO ADR-VKEY IN ADR-REQA
               PERFORM PRO-ERR
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-PRO-VCT
           ELSE
               PERFORM GEN-ESTD.
           MOVE ZEROES TO VEN-VAL-SCAP IN VEN.
           MOVE ZEROES TO VEN-VAL-SFIN IN VEN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               MOVE VEN-CIC-IOPC IN VEN TO ADR-VKEY IN ADR-REQA
               PERFORM PRO-ERR
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               PERFORM GEN-ESTD.
       FIN-PRO-VCT.
           EXIT.
      ******************************************************************
       PRO-DLC SECTION.
       INI-PRO-DLC.
           MOVE 'DLC'                    TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN      TO WSS-TACC IN WSS-VARI.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBOU IN WSS-VARI TO DLC-CIC-IOPC IN DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               MOVE DLC-CIC-IOPC IN DLC TO ADR-VKEY IN ADR-REQA
               PERFORM PRO-ERR
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-PRO-DLC
           ELSE
               PERFORM GEN-ESTD.
           MOVE ZEROES TO DLC-VAL-SDLC IN DLC.
      *DAD ini  27-APR-1993
      *Respaldo fecha de devengo del documento en la cancelacion
           MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FDEV IN WSS-VARI.
           MOVE DLC-FEC-FMAV IN DLC TO DLC-FEC-FDEV IN DLC.
      *DAD fin  27-APR-1993
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               PERFORM GEN-ESTD.
       FIN-PRO-DLC.
           EXIT.
      ******************************************************************
       PRO-OPC SECTION.
       INI-PRO-OPC.
           MOVE 'OPC'                    TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN      TO WSS-TACC IN WSS-VARI.
           MOVE CAN-CIC-IOPC IN CAN      TO OPC-CIC-IOPC IN OPC.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           IF CAN-MSC-TCAN IN CAN = 'N'
               MOVE WSS-CIC-DBIN IN WSS-VARI TO CAN-CIC-IOPC IN CAN
           ELSE
               MOVE WSS-CIC-DBOU IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               MOVE OPC-CIC-IOPC IN OPC TO ADR-VKEY IN ADR-REQA
               PERFORM PRO-ERR
               GO TO FIN-PRO-OPC
           ELSE
               PERFORM GEN-ESTD.
           MOVE ZEROES                  TO OPC-VAL-SCRE IN OPC.
           ADD WSS-NUM-VCVG IN WSS-VARI TO OPC-NUM-TVCC IN OPC.
           MOVE ZEROES                  TO OPC-NUM-VCVG IN OPC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
               PERFORM GEN-ESTD.
       FIN-PRO-OPC.
           EXIT.
      ******************************************************************
       PRO-VEN SECTION.
       INI-PRO-VEN.
           MOVE 'VEN'                    TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN      TO WSS-TACC IN WSS-VARI.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBOU IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
      *DAD ini  8-JUL-1991
      * Si Credito es Estructurado se guarda el IVEN Logico del VEN y se
      * (1) al IVEN Fisico del VEN
           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN IN WSS-VARI
               MOVE 1                   TO VEN-NUM-IVEN IN VEN.
      *DAD fin  8-JUL-1991
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
      *   Informa Error del VEN Fisico ya sea Credito con VEN o EVC
               PERFORM GEN-ESTD
               MOVE VEN-CIC-IOPC IN VEN TO ADR-VKEY IN ADR-REQA
               PERFORM PRO-ERR
      *DAD ini  09-ABR-1992   (Memo.09-03-92 Pto.2)
               MOVE '23' TO FIO-STAT
      *DAD fin  09-ABR-1992
               GO TO FIN-PRO-VEN
           ELSE
      *DAD ini  8-JUL-1991
      * Si Credito es Estructurado y el IVEN Logico del VEN leido NO cor
      * al IVEN Logico guardado anteriormente se Informa Error del VEN L
           IF WSS-IND-VSTR IN WSS-VARI = 'S' AND
              VEN-NUM-IVCT IN VEN NOT = WSS-NUM-IVEN IN WSS-VARI
               MOVE WSS-NUM-IVEN IN WSS-VARI TO VEN-NUM-IVEN IN VEN
               PERFORM GEN-ESTD
               MOVE VEN-CIC-IOPC IN VEN TO ADR-VKEY IN ADR-REQA
               PERFORM PRO-ERR
      *DAD ini  09-ABR-1992   (Memo.09-03-92 Pto.2)
               MOVE '23' TO FIO-STAT
      *DAD fin  09-ABR-1992
               GO TO FIN-PRO-VEN
           ELSE
      *DAD fin  8-JUL-1991
               PERFORM GEN-ESTD.
      *DAD ini  27-APR-1993
      *Guarda Situacion Contable y Cobranza del VEN con EVC en el RCV
           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               MOVE VEN-IND-SCTB IN VEN TO RCV-IND-SCTB IN RCV.
               MOVE VEN-IND-SCBZ IN VEN TO RCV-IND-SCBZ IN RCV.
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FAMT IN WSS-VARI.
      *DAD fin  27-APR-1993
           IF CAN-MSC-FCAN IN CAN = 'I' AND CAN-MSC-ECAN IN CAN = 'E'
               SUBTRACT RCV-SGV-CAPI IN RCV FROM VEN-VAL-SCAP IN VEN
                    GIVING WSS-SGV-CAPT IN WSS-VARI
               SUBTRACT RCV-SGV-FINA IN RCV FROM VEN-VAL-SFIN IN VEN
                    GIVING WSS-SGV-FINL IN WSS-VARI
               MOVE WSS-SGV-CAPT IN WSS-VARI TO RCV-SGV-CAPI IN RCV
               MOVE WSS-SGV-FINL IN WSS-VARI TO RCV-SGV-FINA IN RCV.

           IF RCV-SGV-CAPI IN RCV > VEN-VAL-SCAP IN VEN
               MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
               MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR
               MOVE 'VALSCAP<ZERO'           TO ERR-COD-MENS IN ERR
               MOVE 'VEN-VAL-SCAP'           TO ERR-COD-CMPO IN ERR
               MOVE ADR-VEN-REQA             TO ADR-REQA
               PERFORM PRO-ERR
               MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR
               MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR
               MOVE ZEROES TO VEN-VAL-SCAP IN VEN
           ELSE
               SUBTRACT RCV-SGV-CAPI IN RCV FROM VEN-VAL-SCAP IN VEN.

           IF RCV-SGV-FINA IN RCV > VEN-VAL-SFIN IN VEN
               MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
               MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR
               MOVE 'VALSFIN<ZERO'           TO ERR-COD-MENS IN ERR
               MOVE 'VEN-VAL-SFIN'           TO ERR-COD-CMPO IN ERR
               MOVE ADR-VEN-REQA             TO ADR-REQA
               PERFORM PRO-ERR
               MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR
               MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR
               MOVE ZEROES TO VEN-VAL-SFIN IN VEN
           ELSE
               SUBTRACT RCV-SGV-FINA IN RCV FROM VEN-VAL-SFIN IN VEN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
      *   Informa Error del VEN Fisico
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
      *DAD ini  09-ABR-1992   (Memo.09-03-92 Pto.2)
               MOVE '23' TO FIO-STAT
      *DAD fin  09-ABR-1992
           ELSE
               PERFORM GEN-ESTD.
      *DAD ini  09-ABR-1992   (Memo.09-03-92 Pto.2)
           IF FIO-STAT-OKS AND
              RCV-IND-SCTB IN RCV NOT > SPACES
               MOVE VEN-IND-SCTB IN VEN TO RCV-IND-SCTB IN RCV.
      *DAD fin  09-ABR-1992
       FIN-PRO-VEN.
      *DAD ini  8-JUL-1991
      * Si Credito es con EVC restaura el IVEN Logico guardado anteriorm
           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               MOVE WSS-NUM-IVEN IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
       EXT-PRO-VEN.
      *DAD fin  8-JUL-1991
           EXIT.
      ******************************************************************
       PRO-OPE SECTION.
       INI-PRO-OPE.
           MOVE 'OPC'                    TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN      TO WSS-TACC IN WSS-VARI.
           MOVE CAN-CIC-IOPC IN CAN      TO OPC-CIC-IOPC IN OPC.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBOU IN WSS-VARI TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               MOVE OPC-CIC-IOPC IN OPC TO ADR-VKEY IN ADR-REQA
               PERFORM PRO-ERR
               GO TO FIN-PRO-OPE
           ELSE
               PERFORM GEN-ESTD.

      *DAD ini  27-APR-1993
           SUBTRACT WSS-NUM-VCVG IN WSS-VARI FROM OPC-NUM-VCVG IN OPC.
           IF OPC-NUM-TVCC IN OPC > ZEROES
               ADD WSS-NUM-TVCC IN WSS-VARI TO OPC-NUM-TVCC IN OPC
           ELSE
      **DAD ini  22-OCT-1991
               ADD WSS-NUM-VCCM IN WSS-VARI TO OPC-NUM-VCCM IN OPC
               ADD WSS-NUM-VCCV IN WSS-VARI TO OPC-NUM-VCCV IN OPC
      **DAD fin  22-OCT-1991
               ADD WSS-NUM-VCCO IN WSS-VARI TO OPC-NUM-VCCO IN OPC.
      **DAD ini  22-OCT-1991
      **PGV 20-JUL-1989
      **     IF OPC-NUM-IVEN IN OPC > ZEROES
      **DAD fin  22-OCT-1991
               ADD WSS-NUM-TVCC IN WSS-VARI TO OPC-NUM-IVEN IN OPC.
      **
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
      *     MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM COL-FIO-TOC.
      *     IF NOT FIO-STAT-OKS
      *         MOVE OPC-CIC-IOPC IN OPC TO ADR-VKEY IN ADR-REQA
      *         PERFORM PRO-ERR
      *         GO TO FIN-PRO-OPE.
      *     IF TOC-MSC-OPEC = 'D'
           IF WSS-MSC-OPEC IN WSS-VARI = 'D'
      *DAD fin  27-APR-1993
      * Parametrizar ?        ^
               IF WSS-SGV-FINA(1000) > OPC-VAL-SCRE IN OPC
                   MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
                   MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR
                   MOVE 'VALSCRE<ZERO'           TO ERR-COD-MENS IN ERR
                   MOVE 'OPC-VAL-SCRE'           TO ERR-COD-CMPO IN ERR
                   MOVE ADR-OPC-REQA             TO ADR-REQA
                   PERFORM PRO-ERR
                   MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR
                   MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR
                   MOVE ZEROES TO OPC-VAL-SCRE IN OPC
               ELSE
                   SUBTRACT WSS-SGV-FINA(1000) FROM OPC-VAL-SCRE IN OPC
           ELSE
      *DAD ini  27-APR-1993   (Memo.08-01-93)
               IF WSS-SGV-CAPI(1000) NOT < OPC-VAL-SCRE IN OPC
      *DAD fin  27-APR-1993
                   MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
                   MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR
                   MOVE 'VALSCRE<ZERO'           TO ERR-COD-MENS IN ERR
                   MOVE 'OPC-VAL-SCRE'           TO ERR-COD-CMPO IN ERR
                   MOVE ADR-OPC-REQA             TO ADR-REQA
                   PERFORM PRO-ERR
                   MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR
                   MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR
                   MOVE ZEROES TO OPC-VAL-SCRE IN OPC
      *DAD ini  27-APR-1993   (Memo.08-01-93)
                   MOVE ZEROES TO OPC-NUM-VCVG IN OPC
      *DAD fin  27-APR-1993
               ELSE
                   SUBTRACT WSS-SGV-CAPI(1000) FROM OPC-VAL-SCRE IN OPC.

      *DAD ini  27-APR-1993
      *     SUBTRACT WSS-NUM-VCVG IN WSS-VARI FROM OPC-NUM-VCVG IN OPC.
      *     IF OPC-NUM-TVCC IN OPC > ZEROES
      *         ADD WSS-NUM-TVCC IN WSS-VARI TO OPC-NUM-TVCC IN OPC
      *     ELSE
      **DAD ini  22-OCT-1991
      *         ADD WSS-NUM-VCCM IN WSS-VARI TO OPC-NUM-VCCM IN OPC
      *         ADD WSS-NUM-VCCV IN WSS-VARI TO OPC-NUM-VCCV IN OPC
      **DAD fin  22-OCT-1991
      *         ADD WSS-NUM-VCCO IN WSS-VARI TO OPC-NUM-VCCO IN OPC.
      **DAD ini  22-OCT-1991
      **PGV 20-JUL-1989
      **     IF OPC-NUM-IVEN IN OPC > ZEROES
      **DAD fin  22-OCT-1991
      *         ADD WSS-NUM-TVCC IN WSS-VARI TO OPC-NUM-IVEN IN OPC.
      **
      *DAD fin  27-APR-1993
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
               PERFORM GEN-ESTD.
       FIN-PRO-OPE.
           EXIT.
      ******************************************************************
       PRO-DOC SECTION.
       INI-PRO-DOC.
           MOVE 'DLC'               TO WSS-TREG IN WSS-VARI.
           MOVE CAN-MSC-TACC IN CAN TO WSS-TACC IN WSS-VARI.
      *JSS 25-JUL-1991 12:54:09
      *    IF WSS-SGV-CAPI(WSS-NUM-IDLC) = ZEROES
      *        GO TO FIN-PRO-DOC.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IDD-IENT(WSS-IDBM).
           MOVE WSS-CIC-DBOU IN WSS-VARI TO DLC-CIC-IOPC IN DLC.
           MOVE WSS-NUM-IDLC             TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               IF WSS-SGV-CAPI(WSS-NUM-IDLC) > ZEROES
                   PERFORM GEN-ESTD
                   MOVE DLC-KEY-IDLC IN DLC TO ADR-VKEY IN ADR-REQA
                   PERFORM PRO-ERR
                   MOVE 999 TO WSS-NUM-IDLC
                   GO TO FIN-PRO-DOC
               ELSE
      *Si DLC no esta para WSS-SGV-CAPI=ZEROES es simplemente porque
      *el WSS-SGV-CAPI() es ZEROES por la inicializacion ( no hay mas DL
                   MOVE 999 TO WSS-NUM-IDLC
                   GO TO FIN-PRO-DOC
           ELSE
               PERFORM GEN-ESTD.
      *JSS 25-JUL-1991 12:54:23 si no paga capital actualiza solo FDEV
           IF WSS-SGV-CAPI(WSS-NUM-IDLC) = ZEROES
               GO TO CON-PRO-DOC.
      *JSS - FIN
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
      *     IF TOC-MSC-OPEC = 'D'
           IF WSS-MSC-OPEC IN WSS-VARI = 'D'
      *DAD fin  27-APR-1993
               IF WSS-SGV-FINA(WSS-NUM-IDLC) > DLC-VAL-SDLC IN DLC
                   MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
                   MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR
                   MOVE 'VALSDLC<ZERO'           TO ERR-COD-MENS IN ERR
                   MOVE 'DLC-VAL-SDLC'           TO ERR-COD-CMPO IN ERR
                   MOVE ADR-DLC-REQA             TO ADR-REQA
                   PERFORM PRO-ERR
                   MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR
                   MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR
                   MOVE ZEROES TO DLC-VAL-SDLC IN DLC
               ELSE
                   SUBTRACT WSS-SGV-FINA(WSS-NUM-IDLC)
                       FROM DLC-VAL-SDLC IN DLC
           ELSE
               IF WSS-SGV-CAPI(WSS-NUM-IDLC) > DLC-VAL-SDLC IN DLC
                   MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
                   MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR
                   MOVE 'VALSDLC<ZERO'           TO ERR-COD-MENS IN ERR
                   MOVE 'DLC-VAL-SDLC'           TO ERR-COD-CMPO IN ERR
                   MOVE ADR-DLC-REQA             TO ADR-REQA
                   PERFORM PRO-ERR
                   MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR
                   MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR
                   MOVE ZEROES                   TO DLC-VAL-SDLC IN DLC
               ELSE
                   SUBTRACT WSS-SGV-CAPI(WSS-NUM-IDLC)
                                         FROM DLC-VAL-SDLC IN DLC.
      *DAD ini  27-APR-1993
      *Para operaciones con EVC donde el valor estimado es el CAPITAL
      *y para creditos con VEN se actualiza SCPA
           IF ( OPC-IND-VSTR IN OPC = 'S' AND
                RCV-MSC-STAT IN RCV = 'C' ) OR
              ( OPC-IND-VSTR IN OPC NOT = 'S' )
               IF WSS-MSC-OPEC IN WSS-VARI = 'D'
                   IF WSS-SGV-FINA(WSS-NUM-IDLC) > DLC-VAL-SCPA IN DLC
                       MOVE ZEROES TO DLC-VAL-SCPA IN DLC
                   ELSE
                       SUBTRACT WSS-SGV-FINA(WSS-NUM-IDLC) FROM
                                DLC-VAL-SCPA IN DLC
               ELSE
                   IF WSS-SGV-CAPI(WSS-NUM-IDLC) > DLC-VAL-SCPA IN DLC
                       MOVE ZEROES TO DLC-VAL-SCPA IN DLC
                   ELSE
                       SUBTRACT WSS-SGV-CAPI(WSS-NUM-IDLC) FROM
                                DLC-VAL-SCPA IN DLC.

      *Para operaciones con VEN se actualiza FAMT
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE WSS-FEC-FAMT IN WSS-VARI TO DLC-FEC-FAMT IN DLC.

      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
      *Si se cancelo totalmente la cuota y situacion contable no vigente
           IF VEN-VAL-SFIN IN VEN NOT > ZEROES  AND
              VEN-IND-SCTB IN VEN > SPACES
               PERFORM PRO-RDT-DLC.
      *DAD fin  27-APR-1993
       CON-PRO-DOC.
      *JSS 26-JUN-1991 19:53:37
      *Debe respaldar fecha de devengo del documeto en la cancelacion
           MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FDEV.
           IF CAN-MSC-CANC IN CAN = 'CTT'
               MOVE DLC-FEC-FMAV IN DLC TO DLC-FEC-FDEV IN DLC
           ELSE
           IF ( CAN-MSC-FCAN IN CAN = 'T' OR
              CAN-MSC-FCAN IN CAN = 'I' ) AND
              OPC-NUM-VCOR IN OPC = 1
               MOVE CAN-FEC-FCAN IN CAN TO DLC-FEC-FDEV IN DLC
           ELSE
           IF CAN-MSC-FCAN IN CAN = 'T' OR
              CAN-MSC-FCAN IN CAN = 'I'
               MOVE VEN-NUM-DVEN IN VEN TO DLC-NUM-DDEV IN DLC
               MOVE VEN-NUM-MVEN IN VEN TO DLC-NUM-MDEV IN DLC
               MOVE VEN-NUM-SVEN IN VEN TO DLC-NUM-SDEV IN DLC
               MOVE VEN-NUM-AVEN IN VEN TO DLC-NUM-ADEV IN DLC.
      *JSS - FIN
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
               MOVE 999 TO WSS-NUM-IDLC
           ELSE
               PERFORM GEN-ESTD.
       FIN-PRO-DOC.
           EXIT.
      *-----------------------------------------------------------------
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
      * Lectura del RDT para procesar Morosidad y Actualizar RDT
       PRO-RDT-DLC SECTION.
       INI-PRO-RDT-DLC.
           MOVE DLC-CIC-IOPC IN DLC TO RDT-CIC-IOPC IN RDT.
           MOVE DLC-NUM-IDLC IN DLC TO RDT-NUM-IDLC IN RDT.
           MOVE VEN-IND-SCTB IN VEN TO RDT-IND-SCTB IN RDT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE RDT : ' RDT-KEY-IRDT IN RDT
               GO TO FIN-PRO-RDT-DLC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR UPD RDT : ' RDT-KEY-IRDT IN RDT
               GO TO FIN-PRO-RDT-DLC.

           IF WSS-MSC-OPEC IN WSS-VARI = 'D'
               SUBTRACT RCV-SGV-FINA IN RCV FROM RDT-VAL-SRDT IN RDT
           ELSE
               SUBTRACT RCV-SGV-CAPI IN RCV FROM RDT-VAL-SRDT IN RDT.

           IF RDT-VAL-SRDT IN RDT NOT > ZEROES
               MOVE FIO-DEL TO FIO-CMND
               PERFORM COL-FIO-RDT
           ELSE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-RDT.
           IF NOT FIO-STAT-OKS
               IF FIO-CMND = FIO-MOD
                   DISPLAY 'ERROR MOD RDT : ' RDT-KEY-IRDT IN RDT
                   GO TO FIN-PRO-RDT-DLC
               ELSE
               IF FIO-CMND = FIO-DEL
                   DISPLAY 'ERROR DEL RDT : ' RDT-KEY-IRDT IN RDT
                   GO TO FIN-PRO-RDT-DLC.

           MOVE DLC-CIC-IOPC IN DLC TO RDT-CIC-IOPC IN RDT.
           MOVE DLC-NUM-IDLC IN DLC TO RDT-NUM-IDLC IN RDT.
           MOVE SPACES              TO RDT-IND-SCTB IN RDT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDT-CIC-IOPC IN RDT AND
              DLC-NUM-IDLC IN DLC = RDT-NUM-IDLC IN RDT
               GO TO FIN-PRO-RDT-DLC.
           MOVE SPACES TO DLC-IND-SCTB IN DLC.
       FIN-PRO-RDT-DLC.
           EXIT.
      *DAD fin  27-APR-1993
      ******************************************************************
      ******************************************************************
       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO ADR-DBID IN ADR-REQA.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-DTC.
           IF NOT FIO-STAT-OKS
               MOVE ERR-SVRT-FAT IN ERR-VARI TO ERR-IND-SVRT IN ERR
      *DAD ini  27-APR-1993   (Memo.27-04-92)
               MOVE 100 TO RETURN-CODE
      *DAD fin  27-APR-1993
               PERFORM PRO-ERR.
       FIN-BCK-OUT.
           EXIT.
      *-----------------------------------------------------------------
       GEN-ESTD SECTION.
       INI-GEN-ESTD.
           MOVE 1 TO WSS-I.
       LUP-GEN-ESTD.
           IF WSS-IND-TREG IN WSS-VARI(WSS-I) NOT > SPACES
               MOVE WSS-TREG IN WSS-VARI TO
                             WSS-IND-TREG IN WSS-VARI(WSS-I)
               MOVE WSS-TACC IN WSS-VARI TO
                             WSS-IND-TACC IN WSS-VARI(WSS-I)
               GO TO CON-GEN-ESTD.
           IF WSS-TREG IN WSS-VARI = WSS-IND-TREG IN WSS-VARI(WSS-I) AND
              WSS-TACC IN WSS-VARI = WSS-IND-TACC IN WSS-VARI(WSS-I)
               GO TO CON-GEN-ESTD.
           ADD 1 TO WSS-I.
           IF WSS-I IN WSS-VARI > WSS-IMAX IN WSS-VARI
               GO TO FIN-GEN-ESTD.
           GO TO LUP-GEN-ESTD.
       CON-GEN-ESTD.
           IF NOT FIO-STAT-OKS
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI(WSS-I)
               GO TO FIN-GEN-ESTD.
           IF FIO-CMND = FIO-GET-NLS OR
              FIO-CMND = FIO-GET-NXT OR
              FIO-CMND = FIO-GET-FST OR
              FIO-CMND = FIO-GET-KEY-UPD
               ADD 1 TO WSS-NUM-RLEI IN WSS-VARI(WSS-I)
               GO TO FIN-GEN-ESTD.
           IF FIO-CMND = FIO-PUT OR
              FIO-CMND = FIO-MOD OR
              FIO-CMND = FIO-DEL
               ADD 1 TO WSS-NUM-RPRO IN WSS-VARI(WSS-I)
               GO TO FIN-GEN-ESTD.
       FIN-GEN-ESTD.
           EXIT.
      *-----------------------------------------------------------------
       IMP-ESTD SECTION.
       INI-IMP-ESTD.
           MOVE 1 TO WSS-I IN WSS-VARI.
       LUP-IMP-ESTD.
           IF WSS-IND-TREG(WSS-I) NOT > SPACES
               GO TO FIN-IMP-ESTD.
           DISPLAY 'EN REGISTRO          : ' WSS-IND-TREG(WSS-I).
           DISPLAY 'TIPO DE  ACCION      : ' WSS-IND-TACC(WSS-I).
           DISPLAY 'REGISTROS LEIDOS     : ' WSS-NUM-RLEI(WSS-I).
           DISPLAY 'REGISTROS RECHAZADOS : ' WSS-NUM-RRCH(WSS-I).
           DISPLAY 'REGISTROS PROCESADOS : ' WSS-NUM-RPRO(WSS-I).
           ADD 1 TO WSS-I IN WSS-VARI.
           IF WSS-I IN WSS-VARI > WSS-IMAX IN WSS-VARI
               GO TO FIN-IMP-ESTD.
           GO TO LUP-IMP-ESTD.
       FIN-IMP-ESTD.
           EXIT.
      *-----------------------------------------------------------------
       CLO-FIL SECTION.
       INI-CLO-FIL.
           MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR.
           MOVE WSS-NUM-DBIN TO IDD-IENT(WSS-IDBM).
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCV.
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
           PERFORM COL-FIO-CYA.
      *DAD fin  09-ABR-1992
           MOVE WSS-NUM-DBOU TO IDD-IENT(WSS-IDBM).
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-OPC.
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
           PERFORM COL-FIO-CYA.
      *DAD fin  09-ABR-1992
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
           PERFORM COL-FIO-RDT.
      *DAD fin  27-APR-1993
      *    PERFORM GNS-FIO-ERR.
       FIN-CLO-FIL.
           EXIT.
      ******************************************************************

       COPY COLBFCAN.
       COPY COLBFRCV.
       COPY COLBFVEN.
       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFTOC.
       COPY COLBFRCE.
      *DAD ini  09-ABR-1992   (Memo.11-07-91 Pto.12)
       COPY COLBFCYA.
      *DAD fin  09-ABR-1992
      *DAD ini  27-APR-1993   (Memo.27-02-92 Pto.1.2)
       COPY COLBFRDT.
      *DAD ini  27-APR-1993
       COPY GNSBGEND.
      *DAD fin  27-APR-1993
       COPY GNSBBMSG.
       COPY GNSBFMSG.
       COPY GNSBFTAB.
      *COPY GNSBFERR.
       COPY GNSBGERR.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGHOY.
       COPY GNSBGFEC.
       COPY GNSBPFEC.

       BUS-IND-BDATOS SECTION.
       INI-BUS-IND-BDATOS.
      *RECIBE COMO INPUT EL GRUPO DE BASE DE DATOS EN IDD-GAUX
           MOVE 'COL'  TO IDD-SAUX.
      *    MOVE 'M'    TO IDD-GAUX.
           MOVE SPACES TO IDD-RAUX.
           MOVE 1 TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               GO TO NEX-BUS-IND-BDATOS
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA
               GO TO FIN-BUS-IND-BDATOS.
       NEX-BUS-IND-BDATOS.
           MOVE 'En BUS-IND-BDATOS, NO existe en IDD:' TO FIO-MEN1.
           MOVE IDD-DAUX                               TO FIO-MEN2.
           PERFORM PRG-ABT.
       FIN-BUS-IND-BDATOS.
           EXIT.
