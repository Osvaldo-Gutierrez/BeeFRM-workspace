       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. COLPBNOV.
       AUTHOR.     CONSIST.
      * ACTUALIZA OPERACIONES DE COLOCACIONES EN FORMA BATCH.
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *------------------------
       COPY COLBROPC.
       COPY COLBRRDC.
       COPY COLBRDLC.
       COPY COLBRICG.
       COPY COLBRCYA.
       COPY COLBRVEN.
       COPY COLBRROV.
       COPY COLBRCAN.
       COPY COLBRRCE.
       COPY GNSWVFIO.
       COPY GNSWCFIO.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGCIC.
       COPY GNSWGIFD.
       COPY GNSWGHOY.
       COPY GNSWGFEC.
       COPY GNSWGSYS.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSBRMSG.
       COPY GNSBRTAB.
       COPY GNSBRERR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ERR-REQA==.
       COPY GNSBRCIC.
       01  WSS-VARI.
           03  WSS-ASIG                         PIC X(01).
           03  WSS-ASIG-OK       VALUE 'S'      PIC X(01).
           03  WSS-ASIG-NO       VALUE 'N'      PIC X(01).
           03  WSS-CIC-IOPE                     PIC X(12).
           03  WSS-CIC-IOPC                     PIC X(12).
           03  WSS-NUM-TVEN                     PIC 9(03).
           03  WSS-NUM-DBIN                     PIC 9(03).
           03  WSS-NUM-DBOU                     PIC 9(03).
           03  WSS-FEC-FPRO.
               05  WSS-NUM-DPRO                 PIC 9(02).
               05  WSS-NUM-MPRO                 PIC 9(02).
               05  WSS-NUM-SPRO                 PIC 9(02).
               05  WSS-NUM-APRO                 PIC 9(02).
           03  WSS-I            VALUE ZEROES    PIC 9(03).
           03  WSS-K            VALUE ZEROES    PIC 9(03).
           03  WSS-IMAX         VALUE 50        PIC 9(03).
           03  WSS-KMAX         VALUE 50        PIC 9(03).
           03  WSS-TREG                         PIC X(03).
           03  WSS-TACC                         PIC X(01).
           03  RDC-TAB-DDIR VALUE SPACES.
               05  RDC-VEC-DDIR OCCURS 50.
                   07  RDC-CIC-DDIR             PIC X(12).
           03  WSS-TAB-ESTD.
               05  WSS-VEC-ESTD OCCURS 50.
                   07  WSS-IND-TREG             PIC X(03).
                   07  WSS-IND-TACC             PIC X(01).
                   07  WSS-NUM-RRCH             PIC 9(06).
                   07  WSS-NUM-RLEI             PIC 9(06).
                   07  WSS-NUM-RPRO             PIC 9(06).
       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.
           PERFORM INI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MAIN.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR
               PERFORM PRO-ERR
               MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR
               GO TO FIN-MAIN.
       LUP-MAIN.
           MOVE 'OPC'               TO WSS-TREG IN WSS-VARI.
           MOVE OPC-MSC-TACC IN OPC TO WSS-TACC IN WSS-VARI.
           MOVE OPC-MSC-TACC IN OPC TO ERR-MSC-TACC IN ERR.
           PERFORM GEN-ESTD.
           IF OPC-MSC-STAT > SPACES OR
              ( OPC-MSC-TACC IN OPC  NOT = 'N'  AND
              OPC-MSC-TACC IN OPC    NOT = 'O' )
               GO TO OPC-MAIN.
           PERFORM CHK-PNT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MAIN.
           MOVE OPC-CIC-IOPC TO WSS-CIC-IOPC IN WSS-VARI.
           MOVE 'OPC'               TO WSS-TREG IN WSS-VARI.
           MOVE OPC-MSC-TACC IN OPC TO WSS-TACC IN WSS-VARI.
           MOVE ADR-OPC-REQA TO ADR-DBI-REQA.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IFD-GSIS(13).
       ING-MAIN.
           IF OPC-CIC-IOPC IN OPC NOT = OPC-CIC-ICEN IN OPC AND
              OPC-CIC-ICEN IN OPC > SPACES
               MOVE OPC-CIC-ICEN IN OPC TO RCE-CIC-IOPC IN RCE
               MOVE OPC-CIC-IOPC IN OPC TO RCE-KEY-DISP IN RCE
               MOVE RCE-CIC-IOPC IN RCE TO OPC-CIC-IOPC IN OPC
               MOVE WSS-ASIG-NO IN WSS-VARI TO WSS-ASIG IN WSS-VARI
               GO TO ING-OPC.
      *GET-CIC Obtener CIC
           MOVE SPACES TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
               MOVE CIC-MENS                 TO ERR-COD-MENS IN ERR
               MOVE 'CIC-CIC-ICIC'           TO ERR-COD-CMPO IN ERR
               MOVE ADR-CIC-REQA             TO ADR-REQA
               PERFORM PRO-ERR
               MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR
               GO TO FIN-MAIN.
           MOVE OPC-COD-TOPC IN OPC TO CIC-COD-TCIC.
           MOVE '999'               TO CIC-COD-CCIC.
           MOVE CIC-CIC-ICIC        TO RCE-CIC-IOPC IN RCE.
           MOVE OPC-CIC-IOPC IN OPC TO RCE-KEY-DISP IN RCE.
           MOVE CIC-CIC-ICIC        TO WSS-CIC-IOPE IN WSS-VARI.
           MOVE WSS-ASIG-OK IN WSS-VARI TO WSS-ASIG IN WSS-VARI.
           PERFORM PRO-OPC-PUDE.
           PERFORM PRO-ICG-PUDE.
           PERFORM PRO-CYA-PUDE.
           PERFORM PRO-RDC-PUDE.
           PERFORM PRO-DLC-PUDE.
           PERFORM PRO-VEN-PUDE.
           IF ERR-IND-RBCK IN ERR-VARI = ERR-RBCK-YES IN ERR-VARI
               PERFORM BCK-OUT
               IF NOT FIO-STAT-OKS
                   GO TO FIN-MAIN
               ELSE
                   GO TO OPC-MAIN
           ELSE
               MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC.
       ING-OPC.
           MOVE ZEROES TO RCE-NUM-IDLC IN RCE.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
               GO TO NXT-MAIN.
           MOVE 'A' TO OPC-MSC-STAT IN OPC.
           MOVE HOY-STP-ITRN IN HOY-VARI TO OPC-STP-ITRN IN OPC.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO OPC-NUM-SINP IN OPC.
           MOVE WSS-NUM-APRO IN WSS-VARI TO OPC-NUM-AINP IN OPC.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO OPC-NUM-MINP IN OPC.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO OPC-NUM-DINP IN OPC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
                PERFORM GEN-ESTD.
       NXT-MAIN.
           PERFORM PRO-ICG.
           PERFORM PRO-CYA.
           PERFORM PRO-ROV.
           PERFORM PRO-RDC.
           PERFORM PRO-DLC.
           PERFORM PRO-VEN.
           PERFORM PRO-CAN.
           IF ERR-IND-RBCK IN ERR-VARI = ERR-RBCK-YES IN ERR-VARI
               PERFORM BCK-OUT
               IF NOT FIO-STAT-OKS
                   GO TO FIN-MAIN
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13)
               MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   PERFORM PRO-ERR
               ELSE
                   MOVE 'A' TO OPC-MSC-STAT IN OPC
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   IF NOT FIO-STAT-OKS
                       PERFORM PRO-ERR.
           MOVE ADR-DBI-REQA TO ADR-OPC-REQA.
       OPC-MAIN.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
              GO TO LUP-MAIN.
       FIN-MAIN.
           PERFORM IMP-ESTD.
           PERFORM CLO-FIL.
       COPY GNSBGGBK.
       INI SECTION.
       INI-INI.
           MOVE 'COLPBNOV' TO FIO-PROG.
           PERFORM BUS-FSIS.
           PERFORM GET-FHOY.
      *Captura Fecha de Proceso
           DISPLAY 'FECHA PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      *VAL-FEC Valida Fecha de Proceso
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-INI.
           PERFORM INI-ESTD VARYING WSS-I FROM 1 BY 1
                   UNTIL WSS-I > WSS-IMAX.
           MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR.
           MOVE 'COLPBNOV'               TO ERR-COD-ATRN IN ERR.
           MOVE ERR-TTRN-BAT IN ERR-VARI TO ERR-MSC-TTRN IN ERR.
           MOVE ERR-SVRT-FAT IN ERR-VARI TO ERR-IND-SVRT IN ERR.
           MOVE IFD-GSIS(14) TO WSS-NUM-DBIN.
           MOVE IFD-GSIS(13) TO WSS-NUM-DBOU.
           MOVE WSS-NUM-DBIN TO IFD-GSIS(13).
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE WSS-NUM-DBOU TO IFD-GSIS(13).
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-INI.
      *    MOVE FIO-UPD TO FIO-CMND.
      *    PERFORM GNS-FIO-ERR.
      *    IF NOT FIO-STAT-OKS
      *        PERFORM PRO-ERR
      *        GO TO FIN-INI.
           MOVE ERR-SVRT-REC IN ERR-VARI TO ERR-IND-SVRT IN ERR.
       FIN-INI.
           EXIT.
       CHK-PNT SECTION.
       INI-CHK-PNT.
           MOVE SPACES TO ERR-COD-MENS IN ERR.
           MOVE SPACES TO ERR-IND-RBCK IN ERR-VARI.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO ADR-DBID IN ADR-REQA.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM GNS-FIO-DTC.
           IF NOT FIO-STAT-OKS
               MOVE ERR-SVRT-FAT IN ERR-VARI TO ERR-IND-SVRT IN ERR
               PERFORM PRO-ERR.
       FIN-CHK-PNT.
           EXIT.
       PRO-ICG SECTION.
       INI-PRO-ICG.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE WSS-CIC-IOPC IN WSS-VARI TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES TO ICG-KEY-IVCT IN ICG.
           MOVE SPACES TO ICG-IND-TTAS IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CIC-IOPC IN ICG = WSS-CIC-IOPC IN WSS-VARI AND
                    ICG-NUM-ICAN IN ICG = ZEROES )
                   GO TO FIN-PRO-ICG.
           MOVE 'ICG'               TO WSS-TREG IN WSS-VARI.
           MOVE OPC-MSC-TACC IN OPC TO WSS-TACC IN WSS-VARI.
       LUP-PRO-ICG.
           PERFORM GEN-ESTD.
           MOVE ADR-ICG-REQA TO ADR-AUX-REQA.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IFD-GSIS(13).
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ICG
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
               PERFORM GEN-ESTD.
       NXT-PRO-ICG.
           MOVE ADR-AUX-REQA TO ADR-ICG-REQA.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CIC-IOPC IN ICG = WSS-CIC-IOPC IN WSS-VARI AND
              ICG-NUM-ICAN IN ICG = ZEROES
      * No se pueden mezclar tasas de ingresos con tasas de cancelacione
               GO TO LUP-PRO-ICG.
       FIN-PRO-ICG.
           EXIT.
       PRO-CYA SECTION.
       INI-PRO-CYA.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE WSS-CIC-IOPC IN WSS-VARI TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CYA-CIC-IOPC IN CYA = WSS-CIC-IOPC IN WSS-VARI AND
                    CYA-NUM-ICAN IN CYA = ZEROES )
                   GO TO FIN-PRO-CYA.
           MOVE 'CYA'               TO WSS-TREG IN WSS-VARI.
           MOVE OPC-MSC-TACC IN OPC TO WSS-TACC IN WSS-VARI.
       LUP-PRO-CYA.
           PERFORM GEN-ESTD.
           MOVE ADR-CYA-REQA TO ADR-AUX-REQA.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IFD-GSIS(13).
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-CYA
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR.
       NXT-PRO-CYA.
           MOVE ADR-AUX-REQA TO ADR-CYA-REQA.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS AND
              CYA-CIC-IOPC IN CYA = WSS-CIC-IOPC IN WSS-VARI AND
              CYA-NUM-ICAN IN CYA = ZEROES
               GO TO LUP-PRO-CYA.
       FIN-PRO-CYA.
           EXIT.
       PRO-ROV SECTION.
       INI-PRO-ROV.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IFD-GSIS(13).
           IF OPC-CIC-IOPC IN OPC NOT = OPC-CIC-ICEN IN OPC AND
              OPC-CIC-ICEN IN OPC > SPACES
               MOVE OPC-CIC-IOPC IN OPC      TO ROV-CIC-IOPC IN ROV
               MOVE WSS-CIC-IOPC IN WSS-VARI TO ROV-CIC-IOPV IN ROV
           ELSE
               MOVE WSS-CIC-IOPE IN WSS-VARI TO ROV-CIC-IOPC IN ROV
               MOVE OPC-CIC-IOPC IN OPC      TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES                   TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR.
       FIN-PRO-ROV.
           EXIT.
       PRO-RDC SECTION.
       INI-PRO-RDC.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = WSS-CIC-IOPC IN WSS-VARI AND
                    RDC-NUM-IDLC IN RDC = ZEROES )
               GO TO FIN-PRO-RDC.
           MOVE 'RDC'               TO WSS-TREG IN WSS-VARI.
           MOVE OPC-MSC-TACC IN OPC TO WSS-TACC IN WSS-VARI.
           MOVE ZEROES TO WSS-K.
           MOVE SPACES TO RDC-TAB-DDIR.
       LUP-PRO-RDC.
           MOVE ADR-RDC-REQA TO ADR-AUX-REQA.
           IF RDC-NUM-IDLC IN RDC NOT > ZEROES
               ADD 1 TO WSS-K IN WSS-VARI
               IF WSS-K IN WSS-VARI NOT > WSS-KMAX IN WSS-VARI
                   MOVE RDC-CIC-ICLI IN RDC TO RDC-CIC-DDIR(WSS-K)
               ELSE
                   MOVE WSS-KMAX IN WSS-VARI TO WSS-K IN WSS-VARI
           ELSE
               PERFORM EQL-DDYI VARYING WSS-I FROM 1 BY 1
                   UNTIL WSS-I > WSS-K OR
                   RDC-CIC-ICLI IN RDC = RDC-CIC-DDIR(WSS-I)
               IF WSS-I NOT > WSS-K
                   PERFORM GEN-ESTD
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   PERFORM GEN-ESTD
                   GO TO NXT-PRO-RDC.
           PERFORM GEN-ESTD.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IFD-GSIS(13).
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE FIO-PUT TO FIO-CMND
           PERFORM COL-FIO-RDC
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
               PERFORM GEN-ESTD.
       NXT-PRO-RDC.
           MOVE ADR-AUX-REQA TO ADR-RDC-REQA.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = WSS-CIC-IOPC IN WSS-VARI
               GO TO LUP-PRO-RDC.
       FIN-PRO-RDC.
           EXIT.
       PRO-DLC SECTION.
       INI-PRO-DLC.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE WSS-CIC-IOPC IN WSS-VARI TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    WSS-CIC-IOPC IN WSS-VARI = DLC-CIC-IOPC IN DLC )
               GO TO FIN-PRO-DLC.
           MOVE 'DLC'               TO WSS-TREG IN WSS-VARI.
           MOVE OPC-MSC-TACC IN OPC TO WSS-TACC IN WSS-VARI.
       LUP-PRO-DLC.
           PERFORM GEN-ESTD.
           MOVE ADR-DLC-REQA TO ADR-AUX-REQA.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IFD-GSIS(13).
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE FIO-PUT TO FIO-CMND
           PERFORM COL-FIO-DLC
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
               PERFORM GEN-ESTD.
       NXT-PRO-DLC.
           MOVE ADR-AUX-REQA TO ADR-DLC-REQA.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = WSS-CIC-IOPC IN WSS-VARI
               GO TO LUP-PRO-DLC.
       FIN-PRO-DLC.
           EXIT.
       PRO-VEN SECTION.
       INI-PRO-VEN.
           MOVE ZEROES TO WSS-NUM-TVEN.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE WSS-CIC-IOPC IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CIC-IOPC IN VEN = WSS-CIC-IOPC IN WSS-VARI )
               GO TO FIN-PRO-VEN.
           MOVE 'VEN'               TO WSS-TREG IN WSS-VARI.
           MOVE OPC-MSC-TACC IN OPC TO WSS-TACC IN WSS-VARI.
       LUP-PRO-VEN.
           PERFORM GEN-ESTD.
           MOVE ADR-VEN-REQA TO ADR-AUX-REQA.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IFD-GSIS(13).
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
               PERFORM GEN-ESTD.
       NXT-PRO-VEN.
           ADD 1 TO WSS-NUM-TVEN.
           MOVE ADR-AUX-REQA TO ADR-VEN-REQA.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = WSS-CIC-IOPC IN WSS-VARI
               GO TO LUP-PRO-VEN.
       TOT-PRO-VEN.
           IF WSS-NUM-TVEN IN WSS-VARI NOT = OPC-NUM-VCVG IN OPC
               MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR
               MOVE 'NUMVCVGNTVEN' TO ERR-COD-MENS IN ERR
               MOVE 'OPC-NUM-VCVG' TO ERR-COD-CMPO IN ERR
               MOVE ADR-AUX-REQA   TO ADR-REQA
               PERFORM PRO-ERR
               MOVE ERR-TERR-LGC IN ERR-VARI TO ERR-COD-TERR IN ERR.
       FIN-PRO-VEN.
           EXIT.
       PRO-CAN SECTION.
       INI-PRO-CAN.
           MOVE 'CAN'               TO WSS-TREG IN WSS-VARI.
           MOVE 'I'                 TO WSS-TACC IN WSS-VARI.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           IF WSS-ASIG IN WSS-VARI = WSS-ASIG-NO IN WSS-VARI
               MOVE WSS-CIC-IOPC IN WSS-VARI TO CAN-CIC-IOPC IN CAN
           ELSE
               MOVE WSS-CIC-IOPE IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
           MOVE ZEROES TO CAN-NUM-ICAN IN CAN.
           MOVE 'I'    TO CAN-MSC-TACC IN CAN.
           MOVE 'NTT'  TO CAN-MSC-CANC IN CAN.
           MOVE SPACES TO CAN-MSC-STAT IN CAN.
           MOVE HOY-STP-ITRN IN HOY-VARI TO CAN-STP-ITRN IN CAN.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO CAN-NUM-SOUT IN CAN.
           MOVE WSS-NUM-APRO IN WSS-VARI TO CAN-NUM-AOUT IN CAN.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO CAN-NUM-MOUT IN CAN.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO CAN-NUM-DOUT IN CAN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               PERFORM GEN-ESTD
               PERFORM PRO-ERR
           ELSE
               PERFORM GEN-ESTD.
       FIN-PRO-CAN.
           EXIT.
       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO ADR-DBID IN ADR-REQA.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-DTC.
           IF NOT FIO-STAT-OKS
               MOVE ERR-SVRT-FAT IN ERR-VARI TO ERR-IND-SVRT IN ERR
               PERFORM PRO-ERR.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO ADR-DBID IN ADR-REQA.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-DTC.
           IF NOT FIO-STAT-OKS
               MOVE ERR-SVRT-FAT IN ERR-VARI TO ERR-IND-SVRT IN ERR
               PERFORM PRO-ERR.
           MOVE IFD-GSIS( 15 ) TO ADR-DBID IN ADR-REQA.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-DTC.
           IF NOT FIO-STAT-OKS
               MOVE ERR-SVRT-FAT IN ERR-VARI TO ERR-IND-SVRT IN ERR
               PERFORM PRO-ERR.
       FIN-BCK-OUT.
           EXIT.
       CLO-FIL SECTION.
       INI-CLO-FIL.
           MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR.
           MOVE WSS-NUM-DBIN TO IFD-GSIS(13).
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-ROV.
           PERFORM COL-FIO-RDC.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-CAN.
           MOVE WSS-NUM-DBOU TO IFD-GSIS(13).
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-ROV.
           PERFORM COL-FIO-RDC.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-RCE.
      *    PERFORM GNS-FIO-ERR.
       FIN-CLO-FIL.
           EXIT.
       EQL-DDYI SECTION.
       INI-EQL-DDYI.
       FIN-EQL-DDYI.
           EXIT.
       GEN-ESTD SECTION.
       INI-GEN-ESTD.
           MOVE 1 TO WSS-I.
       LUP-GEN-ESTD.
           IF WSS-IND-TREG IN WSS-VARI(WSS-I) NOT > SPACES
               MOVE WSS-TREG IN WSS-VARI TO
                           WSS-IND-TREG IN WSS-VARI(WSS-I)
               MOVE WSS-TACC IN WSS-VARI TO
                           WSS-IND-TACC IN WSS-VARI(WSS-I)
               GO TO CON-GEN-ESTD.
           IF WSS-TREG IN WSS-VARI = WSS-IND-TREG IN WSS-VARI(WSS-I) AND
              WSS-TACC IN WSS-VARI = WSS-IND-TACC IN WSS-VARI(WSS-I)
               GO TO CON-GEN-ESTD.
           ADD 1 TO WSS-I.
           IF WSS-I IN WSS-VARI > WSS-IMAX IN WSS-VARI
               GO TO FIN-GEN-ESTD.
           GO TO LUP-GEN-ESTD.
       CON-GEN-ESTD.
           IF NOT FIO-STAT-OKS
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI(WSS-I)
               GO TO FIN-GEN-ESTD.
           IF FIO-CMND = FIO-GET-NLS OR
              FIO-CMND = FIO-GET-NXT OR
              FIO-CMND = FIO-GET-FST
               ADD 1 TO WSS-NUM-RLEI IN WSS-VARI(WSS-I)
               GO TO FIN-GEN-ESTD.
           IF FIO-CMND = FIO-PUT OR
              FIO-CMND = FIO-MOD OR
              FIO-CMND = FIO-DEL
               ADD 1 TO WSS-NUM-RPRO IN WSS-VARI(WSS-I)
               GO TO FIN-GEN-ESTD.
       FIN-GEN-ESTD.
           EXIT.
       IMP-ESTD SECTION.
       INI-IMP-ESTD.
           MOVE 1 TO WSS-I IN WSS-VARI.
       LUP-IMP-ESTD.
           IF WSS-IND-TREG(WSS-I) NOT > SPACES
               GO TO FIN-IMP-ESTD.
           DISPLAY 'EN REGISTRO          : ' WSS-IND-TREG(WSS-I).
           DISPLAY 'TIPO DE  ACCION      : ' WSS-IND-TACC(WSS-I).
           DISPLAY 'REGISTROS LEIDOS     : ' WSS-NUM-RLEI(WSS-I).
           DISPLAY 'REGISTROS RECHAZADOS : ' WSS-NUM-RRCH(WSS-I).
           DISPLAY 'REGISTROS PROCESADOS : ' WSS-NUM-RPRO(WSS-I).
           ADD 1 TO WSS-I IN WSS-VARI.
           IF WSS-I IN WSS-VARI > WSS-IMAX IN WSS-VARI
               GO TO FIN-IMP-ESTD.
           GO TO LUP-IMP-ESTD.
       FIN-IMP-ESTD.
           EXIT.
       INI-ESTD SECTION.
       INI-INI-ESTD.
           MOVE SPACES TO WSS-IND-TREG(WSS-I).
           MOVE SPACES TO WSS-IND-TACC(WSS-I).
           MOVE ZEROES TO WSS-NUM-RLEI(WSS-I).
           MOVE ZEROES TO WSS-NUM-RRCH(WSS-I).
           MOVE ZEROES TO WSS-NUM-RPRO(WSS-I).
       FIN-INI-ESTD.
           EXIT.
       PRO-OPC-PUDE SECTION.
       INI-PRO-OPC-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT  FIO-STAT-OKS
               GO TO FIN-PRO-OPC-PUDE.
           MOVE WSS-CIC-IOPE IN WSS-VARI TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-OPC-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-OPC-PUDE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-OPC-PUDE.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(13).
           MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IFD-GSIS(13).
       FIN-PRO-OPC-PUDE.
           EXIT.
       PRO-ICG-PUDE SECTION.
       INI-PRO-ICG-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES TO ICG-KEY-IVCT IN ICG.
           MOVE SPACES TO ICG-IND-TTAS IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CIC-IOPC IN ICG = WSS-CIC-IOPC IN WSS-VARI AND
                    ICG-NUM-ICAN IN ICG = ZEROES )
                   GO TO FIN-PRO-ICG-PUDE.
       LUP-PRO-ICG-PUDE.
           MOVE ADR-ICG-REQA TO ADR-AUX-REQA.
           MOVE WSS-CIC-IOPE IN WSS-VARI TO ICG-CIC-IOPC IN ICG.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-ICG-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO ICG-CIC-IOPC IN ICG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-ICG-PUDE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-ICG-PUDE.
       NXT-PRO-ICG-PUDE.
           MOVE ADR-AUX-REQA TO ADR-ICG-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CIC-IOPC IN ICG = WSS-CIC-IOPC IN WSS-VARI AND
              ICG-NUM-ICAN IN ICG = ZEROES
               GO TO LUP-PRO-ICG-PUDE.
       FIN-PRO-ICG-PUDE.
           EXIT.
       PRO-CYA-PUDE SECTION.
       INI-PRO-CYA-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CYA-CIC-IOPC IN CYA = WSS-CIC-IOPC IN WSS-VARI AND
                    CYA-NUM-ICAN IN CYA = ZEROES )
                   GO TO FIN-PRO-CYA-PUDE.
       LUP-PRO-CYA-PUDE.
           MOVE ADR-CYA-REQA TO ADR-AUX-REQA.
           MOVE WSS-CIC-IOPE IN WSS-VARI TO CYA-CIC-IOPC IN CYA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-CYA-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO CYA-CIC-IOPC IN CYA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-CYA-PUDE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-CYA-PUDE.
       NXT-PRO-CYA-PUDE.
           MOVE ADR-AUX-REQA TO ADR-CYA-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS AND
              CYA-CIC-IOPC IN CYA = WSS-CIC-IOPC IN WSS-VARI AND
              CYA-NUM-ICAN IN CYA = ZEROES
               GO TO LUP-PRO-CYA-PUDE.
       FIN-PRO-CYA-PUDE.
           EXIT.
       PRO-RDC-PUDE SECTION.
       INI-PRO-RDC-PUDE.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = WSS-CIC-IOPC IN WSS-VARI AND
                    RDC-NUM-IDLC IN RDC = ZEROES )
               GO TO FIN-PRO-RDC-PUDE.
       LUP-PRO-RDC-PUDE.
           MOVE ADR-RDC-REQA TO ADR-AUX-REQA.
           MOVE WSS-CIC-IOPE IN WSS-VARI TO RDC-CIC-IOPC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-RDC-PUDE.
           MOVE WSS-CIC-IOPC TO RDC-CIC-IOPC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-RDC-PUDE.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-RDC-PUDE.
       NXT-PRO-RDC-PUDE.
           MOVE ADR-AUX-REQA TO ADR-RDC-REQA.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = WSS-CIC-IOPC IN WSS-VARI
               GO TO LUP-PRO-RDC-PUDE.
       FIN-PRO-RDC-PUDE.
           EXIT.
       PRO-DLC-PUDE SECTION.
       INI-PRO-DLC-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    WSS-CIC-IOPC IN WSS-VARI = DLC-CIC-IOPC IN DLC )
               GO TO FIN-PRO-DLC-PUDE.
       LUP-PRO-DLC-PUDE.
           MOVE ADR-DLC-REQA TO ADR-AUX-REQA.
           MOVE WSS-CIC-IOPE IN WSS-VARI TO DLC-CIC-IOPC IN DLC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-DLC-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO DLC-CIC-IOPC IN DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-DLC-PUDE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-DLC-PUDE.
       NXT-PRO-DLC-PUDE.
           MOVE ADR-AUX-REQA TO ADR-DLC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = WSS-CIC-IOPC IN WSS-VARI
               GO TO LUP-PRO-DLC-PUDE.
       FIN-PRO-DLC-PUDE.
           EXIT.
       PRO-VEN-PUDE SECTION.
       INI-PRO-VEN-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CIC-IOPC IN VEN = WSS-CIC-IOPC IN WSS-VARI )
               GO TO FIN-PRO-VEN-PUDE.
       LUP-PRO-VEN-PUDE.
           MOVE ADR-VEN-REQA TO ADR-AUX-REQA.
           MOVE WSS-CIC-IOPE IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-VEN-PUDE.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-VEN-PUDE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-PRO-VEN-PUDE.
       NXT-PRO-VEN-PUDE.
           MOVE ADR-AUX-REQA TO ADR-VEN-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = WSS-CIC-IOPC IN WSS-VARI
               GO TO LUP-PRO-VEN-PUDE.
       FIN-PRO-VEN-PUDE.
           EXIT.
       COPY COLBFOPC.
       COPY COLBFICG.
       COPY COLBFCYA.
       COPY COLBFRDC.
       COPY COLBFDLC.
       COPY COLBFVEN.
       COPY COLBFROV.
       COPY COLBFCAN.
       COPY COLBFRCE.
       COPY GNSBBMSG.
       COPY GNSBFCIC.
       COPY GNSBFMSG.
       COPY GNSBFTAB.
      *COPY GNSBFERR.
       COPY GNSBGCIC.
       COPY GNSBGERR.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGHOY.
       COPY GNSBGFEC.
