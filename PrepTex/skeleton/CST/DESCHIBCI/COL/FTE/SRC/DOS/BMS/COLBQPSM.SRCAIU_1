      * 11-Sep-96 06:55 PM
       PUT-ALL-PSM SECTION.
       INI-PUT-ALL-PSM.
           PERFORM PUT-PSM-PSM.
           PERFORM PUT-POC-PSM.
       FIN-PUT-ALL-PSM.
           EXIT.
       
       PUT-PSM-PSM SECTION.
       INI-PUT-PSM-PSM.
           IF PGM-STAT-PSM-NUL
               GO TO FIN-PUT-PSM-PSM.
           IF NOT PGM-STAT-PSM-OKS
               PERFORM CLR-PSM-PSM
               GO TO FIN-PUT-PSM-PSM.
           MOVE PSM-NUM-DTRN IN PSM TO PSM-NUM-DTRN IN PSM-FLD.
           MOVE PSM-NUM-MTRN IN PSM TO PSM-NUM-MTRN IN PSM-FLD.
           MOVE PSM-NUM-STRN IN PSM TO PSM-NUM-STRN IN PSM-FLD.
           MOVE PSM-NUM-ATRN IN PSM TO PSM-NUM-ATRN IN PSM-FLD.
           MOVE PSM-HRA-HRTR IN PSM TO PSM-HRA-HRTR IN PSM-FLD.
           MOVE PSM-COD-OFOC IN PSM TO PSM-COD-OFOC IN PSM-FLD.
           MOVE PSM-COD-VCOC IN PSM TO PSM-COD-VCOC IN PSM-FLD.
           MOVE PSM-COD-TOOC IN PSM TO PSM-COD-TOOC IN PSM-FLD.
           MOVE PSM-COD-AOOC IN PSM TO PSM-COD-AOOC IN PSM-FLD.
           MOVE PSM-COD-TBAN IN PSM TO PSM-COD-TBAN IN PSM-FLD.
           MOVE PSM-COD-CLCM IN PSM TO PSM-COD-CLCM IN PSM-FLD.
           MOVE PSM-COD-OFCB IN PSM TO PSM-COD-OFCB IN PSM-FLD.
           MOVE PSM-NUM-DACT IN PSM TO PSM-NUM-DACT IN PSM-FLD.
           MOVE PSM-NUM-MACT IN PSM TO PSM-NUM-MACT IN PSM-FLD.
           MOVE PSM-NUM-SACT IN PSM TO PSM-NUM-SACT IN PSM-FLD.
           MOVE PSM-NUM-AACT IN PSM TO PSM-NUM-AACT IN PSM-FLD.
           MOVE PSM-COD-ATRN IN PSM TO PSM-COD-ATRN IN PSM-FLD.
           MOVE PSM-MSC-STAT IN PSM TO PSM-MSC-STAT IN PSM-FLD.
      *BUS-OFI busca oficina en tablas
           IF PSM-COD-OFOC IN PSM-FLD > SPACES
               MOVE PSM-COD-OFOC IN PSM-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN PSM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFOC IN PSM-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PSM-COD-VCOC IN PSM-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE PSM-COD-VCOC IN PSM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOC IN PSM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOC IN PSM-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PSM-COD-AOOC IN PSM-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX ' TO TAB-COD-TTAB IN TAB
               MOVE PSM-COD-AOOC IN PSM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-AOOC IN PSM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOOC IN PSM-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PSM-COD-TBAN IN PSM-FLD > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'BAN ' TO TAB-COD-TTAB IN TAB
               MOVE PSM-COD-TBAN IN PSM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TBAN IN PSM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TBAN IN PSM-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PSM-COD-CLCM IN PSM-FLD > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'CLC ' TO TAB-COD-TTAB IN TAB
               MOVE PSM-COD-CLCM IN PSM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-CLCM IN PSM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CLCM IN PSM-FLD.
      *<<<< FIN_PUT_PSM_PSM
           IF SCR-CMND = 'CON' AND PSM-COD-OFOC IN PSM-FLD = '*  '
               MOVE SPACES TO FRM-GLS-OFOC IN PSM-FLD.
           IF SCR-CMND = 'CON' AND PSM-COD-AOOC IN PSM-FLD = '*  '
               MOVE SPACES TO FRM-GLS-AOOC IN PSM-FLD.
           IF SCR-CMND = 'CON' AND PSM-COD-TBAN IN PSM-FLD = '*  '
               MOVE SPACES TO FRM-GLS-TBAN IN PSM-FLD.
           IF SCR-CMND = 'CON' AND PSM-COD-CLCM IN PSM-FLD = '*  '
               MOVE SPACES TO FRM-GLS-CLCM IN PSM-FLD.
      *>>>>
       FIN-PUT-PSM-PSM.
           EXIT.
       
       PUT-POC-PSM SECTION.
       INI-PUT-POC-PSM.
           IF PGM-STAT-POC-NUL
               GO TO FIN-PUT-POC-PSM.
           IF NOT PGM-STAT-POC-OKS
               PERFORM CLR-POC-PSM
               GO TO FIN-PUT-POC-PSM.
           MOVE POC-MSC-BCTI IN POC TO POC-MSC-BCTI IN PSM-FLD.
           MOVE POC-MSC-PBTI IN POC TO POC-MSC-PBTI IN PSM-FLD.
           MOVE POC-MSC-BPBT IN POC TO POC-MSC-BPBT IN PSM-FLD.
           MOVE POC-MSC-SPBT IN POC TO POC-MSC-SPBT IN PSM-FLD.
           MOVE POC-COD-CVTI IN POC TO POC-COD-CVTI IN PSM-FLD.
           MOVE POC-MSC-TFPR IN POC TO POC-MSC-TFPR IN PSM-FLD.
           MOVE POC-NUM-PREP IN POC TO POC-NUM-PREP IN PSM-FLD.
           MOVE POC-MSC-UTPR IN POC TO POC-MSC-UTPR IN PSM-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF POC-MSC-BCTI IN PSM-FLD > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'BCTI' TO MSC-COD-TMSC IN MSC
               MOVE POC-MSC-BCTI IN PSM-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-BCTI IN PSM-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-BCTI IN PSM-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF POC-MSC-PBTI IN PSM-FLD > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'PBTI' TO MSC-COD-TMSC IN MSC
               MOVE POC-MSC-PBTI IN PSM-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PBTI IN PSM-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-PBTI IN PSM-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF POC-MSC-BPBT IN PSM-FLD > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'MCTI' TO MSC-COD-TMSC IN MSC
               MOVE POC-MSC-BPBT IN PSM-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-BPBT IN PSM-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-BPBT IN PSM-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF POC-MSC-SPBT IN PSM-FLD > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'MCTI' TO MSC-COD-TMSC IN MSC
               MOVE POC-MSC-SPBT IN PSM-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SPBT IN PSM-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-SPBT IN PSM-FLD.
      *<<<< FIN_PUT_POC_PSM
      *BUSCA GLOSA EN TABLAS
           IF POC-COD-CVTI IN PSM-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE 'I' TO WSS-COD-TVTI
               MOVE POC-COD-CVTI IN PSM-FLD TO WSS-COD-CVTI
               MOVE POC-MSC-PBTI IN PSM-FLD TO WSS-COD-TCTI
               MOVE WSS-COD-VCAM TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF POC-COD-CVTI IN PSM-FLD > SPACES
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CVTI IN PSM-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-CVTI IN PSM-FLD.
      *BUS-MSC BUSCA GLOSA DE MISCELANEO EN TABLA
           IF POC-MSC-UTPR IN PSM-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'IPER' TO MSC-COD-TMSC IN MSC
               MOVE POC-MSC-UTPR IN PSM-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-UTPR IN PSM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UTPR IN PSM-FLD.
      *>>>>
       FIN-PUT-POC-PSM.
           EXIT.
       
       KEY-ALL-PSM SECTION.
       INI-KEY-ALL-PSM.
           PERFORM KEY-PSM-PSM.
           PERFORM KEY-POC-PSM.
       FIN-KEY-ALL-PSM.
           EXIT.
       
       KEY-PSM-PSM SECTION.
       INI-KEY-PSM-PSM.
           MOVE PSM-NUM-DTRN IN PSM-FLD TO PSM-NUM-DTRN IN PSM.
           MOVE PSM-NUM-MTRN IN PSM-FLD TO PSM-NUM-MTRN IN PSM.
           MOVE PSM-NUM-STRN IN PSM-FLD TO PSM-NUM-STRN IN PSM.
           MOVE PSM-NUM-ATRN IN PSM-FLD TO PSM-NUM-ATRN IN PSM.
           MOVE PSM-HRA-HRTR IN PSM-FLD TO PSM-HRA-HRTR IN PSM.
           MOVE PSM-COD-OFOC IN PSM-FLD TO PSM-COD-OFOC IN PSM.
           MOVE PSM-COD-VCOC IN PSM-FLD TO PSM-COD-VCOC IN PSM.
           MOVE PSM-COD-TOOC IN PSM-FLD TO PSM-COD-TOOC IN PSM.
           MOVE PSM-COD-AOOC IN PSM-FLD TO PSM-COD-AOOC IN PSM.
           MOVE PSM-COD-TBAN IN PSM-FLD TO PSM-COD-TBAN IN PSM.
           MOVE PSM-COD-CLCM IN PSM-FLD TO PSM-COD-CLCM IN PSM.
       FIN-KEY-PSM-PSM.
           EXIT.
       
       KEY-POC-PSM SECTION.
       INI-KEY-POC-PSM.
       FIN-KEY-POC-PSM.
           EXIT.
       
       SCR-CLRA-PSM SECTION.
       INI-SCR-CLRA-PSM.
           PERFORM CLR-KEY-PSM.
           PERFORM CLR-FLD-PSM.
       FIN-SCR-CLRA-PSM.
           EXIT.
       
       CLR-KEY-PSM SECTION.
       INI-CLR-KEY-PSM.
           MOVE ZEROES TO PSM-FEC-FTRN IN PSM-FLD.
           MOVE ZEROES TO PSM-HRA-HRTR IN PSM-FLD.
           MOVE SPACES TO PSM-COD-OFOC IN PSM-FLD.
           MOVE SPACES TO PSM-COD-VCOC IN PSM-FLD.
           MOVE SPACES TO PSM-COD-TOOC IN PSM-FLD.
           MOVE SPACES TO PSM-COD-AOOC IN PSM-FLD.
           MOVE SPACES TO PSM-COD-TBAN IN PSM-FLD.
           MOVE SPACES TO PSM-COD-CLCM IN PSM-FLD.
       FIN-CLR-KEY-PSM.
           EXIT.
       
       CLR-FLD-PSM SECTION.
       INI-CLR-FLD-PSM.
           MOVE SPACES TO FRM-GLS-OFOC IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-TBAN IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-CLCM IN PSM-FLD.
           MOVE ZEROES TO FRM-SGV-MTO1 IN PSM-FLD.
           MOVE ZEROES TO FRM-SGV-MTO2 IN PSM-FLD.
           MOVE ZEROES TO FRM-SGV-MTO3 IN PSM-FLD.
           MOVE ZEROES TO FRM-SGV-MTO4 IN PSM-FLD.
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(1).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(2).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(3).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(4).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(5).
           MOVE ZEROES TO FRM-NUM-NDIA IN PSM-FLD(6).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(1).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(2).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(3).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(4).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(5).
           MOVE ZEROES TO FRM-SGV-INT1 IN PSM-FLD(6).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(1).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(2).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(3).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(4).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(5).
           MOVE ZEROES TO FRM-SGV-INT2 IN PSM-FLD(6).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(1).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(2).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(3).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(4).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(5).
           MOVE ZEROES TO FRM-SGV-INT3 IN PSM-FLD(6).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(1).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(2).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(3).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(4).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(5).
           MOVE ZEROES TO FRM-SGV-INT4 IN PSM-FLD(6).
           MOVE SPACES TO FRM-GLS-BCTI IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-PBTI IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-BPBT IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-SPBT IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-CVTI IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-OFCB IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-UTPR IN PSM-FLD.
           MOVE SPACES TO FRM-GLS-ATRN IN PSM-FLD.
           PERFORM CLR-PSM-PSM.
           PERFORM CLR-POC-PSM.
       FIN-CLR-FLD-PSM.
           EXIT.
       
       CLR-PSM-PSM SECTION.
       INI-CLR-PSM-PSM.
           MOVE SPACES TO PSM-COD-OFCB IN PSM-FLD.
           MOVE ZEROES TO PSM-FEC-FACT IN PSM-FLD.
           MOVE SPACES TO PSM-COD-ATRN IN PSM-FLD.
           MOVE SPACES TO PSM-MSC-STAT IN PSM-FLD.
       FIN-CLR-PSM-PSM.
           EXIT.
       
       CLR-POC-PSM SECTION.
       INI-CLR-POC-PSM.
           MOVE SPACES TO POC-MSC-BCTI IN PSM-FLD.
           MOVE SPACES TO POC-MSC-PBTI IN PSM-FLD.
           MOVE SPACES TO POC-MSC-BPBT IN PSM-FLD.
           MOVE SPACES TO POC-MSC-SPBT IN PSM-FLD.
           MOVE SPACES TO POC-COD-CVTI IN PSM-FLD.
           MOVE SPACES TO POC-MSC-TFPR IN PSM-FLD.
           MOVE ZEROES TO POC-NUM-PREP IN PSM-FLD.
           MOVE SPACES TO POC-MSC-UTPR IN PSM-FLD.
       FIN-CLR-POC-PSM.
           EXIT.
       
       FST-KEY-PSM SECTION.
       INI-FST-KEY-PSM.
           MOVE -1 TO PSM-FEC-FTRN-LEN IN PSM-FLD.
      *<<<< FIN_FST_KEY_PSM
           IF SCR-CMND = 'OFC' OR 'DFC'
               MOVE 0  TO PSM-FEC-FTRN-LEN IN PSM-FLD
               MOVE -1 TO PSM-COD-OFOC-LEN IN PSM-FLD.
      *>>>>
       FIN-FST-KEY-PSM.
           EXIT.
       
       FST-FLD-PSM SECTION.
       INI-FST-FLD-PSM.
           MOVE -1 TO FRM-SGV-MTO1-LEN IN PSM-FLD.
      *<<<< FIN_FST_FLD_PSM
           IF SCR-CMND = 'OFC' OR 'DFC'
               MOVE 0  TO FRM-SGV-MTO1-LEN IN PSM-FLD
               MOVE -1 TO PSM-COD-OFCB-LEN IN PSM-FLD.
      *>>>>
       FIN-FST-FLD-PSM.
           EXIT.
       
       PRO-KEY-PSM SECTION.
       INI-PRO-KEY-PSM.
           PERFORM PRO-IKY-PSM.
           PERFORM PRO-AKY-PSM.
           PERFORM PRO-MKY-PSM.
       FIN-PRO-KEY-PSM.
           EXIT.
       
       PRO-IKY-PSM SECTION.
       INI-PRO-IKY-PSM.
           MOVE FRM-CPIM-AEY TO PSM-FEC-FTRN-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-HRA-HRTR-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-OFOC-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-VCOC-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-TOOC-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-AOOC-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-TBAN-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO PSM-COD-CLCM-ATR IN PSM-FLD.
       FIN-PRO-IKY-PSM.
           EXIT.
       
       PRO-MKY-PSM SECTION.
       INI-PRO-MKY-PSM.
       FIN-PRO-MKY-PSM.
           EXIT.
       
       PRO-AKY-PSM SECTION.
       INI-PRO-AKY-PSM.
       FIN-PRO-AKY-PSM.
           EXIT.
       
       UNP-KEY-PSM SECTION.
       INI-UNP-KEY-PSM.
           PERFORM UNP-IKY-PSM.
           PERFORM UNP-AKY-PSM.
           PERFORM UNP-MKY-PSM.
       FIN-UNP-KEY-PSM.
           EXIT.
       
       UNP-IKY-PSM SECTION.
       INI-UNP-IKY-PSM.
           MOVE FRM-CPIM-UBY TO PSM-FEC-FTRN-ATR.
           MOVE FRM-CPIM-UBY TO PSM-HRA-HRTR-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-OFOC-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-VCOC-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-TOOC-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-AOOC-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-TBAN-ATR.
           MOVE FRM-CPIM-UBY TO PSM-COD-CLCM-ATR.
       FIN-UNP-IKY-PSM.
           EXIT.
       
       UNP-MKY-PSM SECTION.
       INI-UNP-MKY-PSM.
       FIN-UNP-MKY-PSM.
           EXIT.
       
       UNP-AKY-PSM SECTION.
       INI-UNP-AKY-PSM.
       FIN-UNP-AKY-PSM.
           EXIT.
       
       UNP-FLD-PSM SECTION.
       INI-UNP-FLD-PSM.
           MOVE FRM-CPIM-UBY TO FRM-SGV-MTO1-ATR IN PSM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-SGV-MTO2-ATR IN PSM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-SGV-MTO3-ATR IN PSM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-SGV-MTO4-ATR IN PSM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-NUM-NDIA-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT1-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT2-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT3-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-SGV-INT4-ATR IN PSM-FLD(6).
           PERFORM UNP-PSM-PSM.
           PERFORM UNP-POC-PSM.
       FIN-UNP-FLD-PSM.
           EXIT.
       
       UNP-PSM-PSM SECTION.
       INI-UNP-PSM-PSM.
           MOVE FRM-CPIM-UBY TO PSM-MSC-STAT-ATR IN PSM-FLD.
       FIN-UNP-PSM-PSM.
           EXIT.
       
       UNP-POC-PSM SECTION.
       INI-UNP-POC-PSM.
       FIN-UNP-POC-PSM.
           EXIT.
       
       VAL-KEY-PSM SECTION.
       INI-VAL-KEY-PSM.
           PERFORM VAL-IKY-PSM.
           PERFORM VAL-MKY-PSM.
           PERFORM VAL-AKY-PSM.
       FIN-VAL-KEY-PSM.
           EXIT.
       
       VAL-IKY-PSM SECTION.
       INI-VAL-IKY-PSM.
           PERFORM VAL-PSM-FEC-FTRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PSM-FEC-FTRN-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-HRA-HRTR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PSM-HRA-HRTR-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-OFOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PSM-COD-OFOC-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PSM-COD-VCOC-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PSM-COD-TOOC-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PSM-COD-AOOC-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-TBAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PSM-COD-TBAN-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
           PERFORM VAL-PSM-COD-CLCM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PSM-COD-CLCM-LEN IN PSM-FLD
                GO TO FIN-VAL-IKY-PSM.
       FIN-VAL-IKY-PSM.
           EXIT.
       
       VAL-MKY-PSM SECTION.
       INI-VAL-MKY-PSM.
       FIN-VAL-MKY-PSM.
           EXIT.
       
       VAL-AKY-PSM SECTION.
       INI-VAL-AKY-PSM.
       FIN-VAL-AKY-PSM.
           EXIT.
       
       VAL-PSM-FEC-FTRN SECTION.
       INI-VAL-PSM-FEC-FTRN.
      *VAL-FEC Validar Fecha
           MOVE PSM-FEC-FTRN IN PSM-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_PSM_FEC_FTRN
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO PSM-FEC-FTRN IN PSM-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-PSM-FEC-FTRN.
      *<<<< PSM_FEC_FTRN
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-PSM-FEC-FTRN.
           IF PSM-FEC-FTRN IN PSM-FLD NOT > ZEROES AND
              ( SCR-CMND NOT = 'OFC' AND SCR-CMND NOT = 'DFC' )
               PERFORM GET-FHOY
               MOVE HOY-DHOY IN HOY-VARI TO PSM-NUM-DTRN IN PSM-FLD
               MOVE HOY-MHOY IN HOY-VARI TO PSM-NUM-MTRN IN PSM-FLD
               MOVE HOY-SHOY IN HOY-VARI TO PSM-NUM-STRN IN PSM-FLD
               MOVE HOY-AHOY IN HOY-VARI TO PSM-NUM-ATRN IN PSM-FLD.
      *>>>>
       FIN-VAL-PSM-FEC-FTRN.
           EXIT.
       
       VAL-PSM-HRA-HRTR SECTION.
       INI-VAL-PSM-HRA-HRTR.
      *<<<< PSM_HRA_HRTR
           MOVE PSM-HRA-HRTR IN PSM-FLD TO PSM-HRA-HRTR IN PSM.
           IF PSM-NUM-HHTR IN PSM < ZEROES OR
              PSM-NUM-HHTR IN PSM > 24
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PSM-HRA-HRTR.
           IF PSM-NUM-MMTR IN PSM < ZEROES OR
              PSM-NUM-MMTR IN PSM > 60
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMMMTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PSM-HRA-HRTR.
      *>>>>
       FIN-VAL-PSM-HRA-HRTR.
           EXIT.
       
       VAL-PSM-COD-OFOC SECTION.
       INI-VAL-PSM-COD-OFOC.
           IF PSM-COD-OFOC IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-OFOC IN PSM-FLD.
      *<<<< INI_PSM_COD_OFOC
           IF ( SCR-CMND NOT = 'CON' ) AND
              ( PSM-COD-OFOC IN PSM-FLD = '*  ' )
               GO TO FIN-VAL-PSM-COD-OFOC.
      *>>>>
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE PSM-COD-OFOC IN PSM-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFOC IN PSM-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN PSM-FLD.
       FIN-VAL-PSM-COD-OFOC.
           EXIT.
       
       VAL-PSM-COD-VCOC SECTION.
       INI-VAL-PSM-COD-VCOC.
           IF PSM-COD-VCOC IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-VCOC IN PSM-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE PSM-COD-VCOC IN PSM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PSM-COD-VCOC IN PSM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN PSM-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOC IN PSM-FLD.
       FIN-VAL-PSM-COD-VCOC.
           EXIT.
       
       VAL-PSM-COD-TOOC SECTION.
       INI-VAL-PSM-COD-TOOC.
           IF PSM-COD-TOOC IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-TOOC IN PSM-FLD.
      *<<<< INI_PSM_COD_TOOC
      * RBG/INI/31-OCT-1996
           IF PSM-COD-TOOC IN PSM-FLD = '*  '
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'NPERMITE*TIO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-PSM-COD-TOOC.
      * RBG/FIN/31-OCT-1996 
      *>>>>
       FIN-VAL-PSM-COD-TOOC.
           EXIT.
       
       VAL-PSM-COD-AOOC SECTION.
       INI-VAL-PSM-COD-AOOC.
           IF PSM-COD-AOOC IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-AOOC IN PSM-FLD.
      *<<<< PSM_COD_AOOC
           IF ( SCR-CMND NOT = 'CON' ) AND
              ( PSM-COD-AOOC IN PSM-FLD = '*  ' )
               GO TO FIN-VAL-PSM-COD-AOOC.
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE PSM-COD-TOOC IN PSM-FLD TO WSS-COD-TOOC IN WSS-VARI.
           MOVE PSM-COD-AOOC IN PSM-FLD TO WSS-COD-AOOC IN WSS-VARI.
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              PSM-COD-AOOC IN PSM-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN PSM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOOC IN PSM-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-PSM-COD-AOOC.
           MOVE PSM-COD-VCOC IN PSM-FLD TO POC-COD-VCOC IN POC.
           MOVE PSM-COD-TOOC IN PSM-FLD TO POC-COD-TOOC IN POC.
           MOVE PSM-COD-AOOC IN PSM-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'POC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               PERFORM EDT-FLD-PSM
               GO TO FIN-VAL-PSM-COD-AOOC.
           IF POC-MSC-STAT IN POC = 'N'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'POC    NVG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               PERFORM EDT-FLD-PSM
               GO TO FIN-VAL-PSM-COD-AOOC.
           GO TO FIN-VAL-PSM-COD-AOOC.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'AUX ' TO TAB-COD-TTAB IN TAB.
           MOVE PSM-COD-AOOC IN PSM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PSM-COD-AOOC IN PSM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOOC IN PSM-FLD
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-AOOC IN PSM-FLD.
       FIN-VAL-PSM-COD-AOOC.
           EXIT.
       
       VAL-PSM-COD-TBAN SECTION.
       INI-VAL-PSM-COD-TBAN.
           IF PSM-COD-TBAN IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-TBAN IN PSM-FLD.
      *<<<< INI_PSM_COD_TBAN
           IF ( SCR-CMND NOT = 'CON' ) AND
              ( PSM-COD-TBAN IN PSM-FLD = '*  ' )
               GO TO FIN-VAL-PSM-COD-TBAN.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'BAN ' TO TAB-COD-TTAB IN TAB.
           MOVE PSM-COD-TBAN IN PSM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PSM-COD-TBAN IN PSM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TBAN IN PSM-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TBAN IN PSM-FLD.
       FIN-VAL-PSM-COD-TBAN.
           EXIT.
       
       VAL-PSM-COD-CLCM SECTION.
       INI-VAL-PSM-COD-CLCM.
           IF PSM-COD-CLCM IN PSM-FLD NOT > SPACES
              MOVE SPACES TO PSM-COD-CLCM IN PSM-FLD.
      *<<<< INI_PSM_COD_CLCM
           IF ( SCR-CMND NOT = 'CON' ) AND
              ( PSM-COD-CLCM IN PSM-FLD = '*  ' )
               GO TO FIN-VAL-PSM-COD-CLCM.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'CLC ' TO TAB-COD-TTAB IN TAB.
           MOVE PSM-COD-CLCM IN PSM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PSM-COD-CLCM IN PSM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CLCM IN PSM-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-CLCM IN PSM-FLD.
       FIN-VAL-PSM-COD-CLCM.
           EXIT.
       
       VAL-CON-KEY-PSM SECTION.
       INI-VAL-CON-KEY-PSM.
           IF     PSM-FEC-FTRN IN PSM-FLD NOT > SPACES 
              AND PSM-NUM-DTRN IN PSM-FLD NOT > SPACES 
              AND PSM-NUM-MTRN IN PSM-FLD NOT > SPACES 
              AND PSM-NUM-STRN IN PSM-FLD NOT > SPACES 
              AND PSM-NUM-ATRN IN PSM-FLD NOT > SPACES 
              AND PSM-HRA-HRTR IN PSM-FLD NOT > ZEROES 
              AND PSM-COD-OFOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-VCOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-TOOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-AOOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-TBAN IN PSM-FLD NOT > SPACES 
              AND PSM-COD-CLCM IN PSM-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PSM.
       FIN-VAL-CON-KEY-PSM.
           EXIT.
       
       VAL-CON-IKY-PSM SECTION.
       INI-VAL-CON-IKY-PSM.
           IF     PSM-FEC-FTRN IN PSM-FLD NOT > SPACES 
              AND PSM-HRA-HRTR IN PSM-FLD NOT > ZEROES 
              AND PSM-COD-OFOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-VCOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-TOOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-AOOC IN PSM-FLD NOT > SPACES 
              AND PSM-COD-TBAN IN PSM-FLD NOT > SPACES 
              AND PSM-COD-CLCM IN PSM-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PSM.
       FIN-VAL-CON-IKY-PSM.
           EXIT.
       
       VAL-NUM-KEY-PSM SECTION.
       INI-VAL-NUM-KEY-PSM.
           PERFORM VAL-NUM-IKY-PSM.
           PERFORM VAL-NUM-MKY-PSM.
           PERFORM VAL-NUM-AKY-PSM.
       FIN-VAL-NUM-KEY-PSM.
           EXIT.
       
       VAL-NUM-IKY-PSM SECTION.
       INI-VAL-NUM-IKY-PSM.
       VAL-NUM-PSM-HRA-HRTR.
           MOVE PSM-HRA-HRTR-ALF IN PSM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO PSM-HRA-HRTR IN PSM-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO PSM-HRA-HRTR-LEN IN PSM-FLD
                GO TO FIN-VAL-NUM-IKY-PSM.
       FIN-VAL-NUM-IKY-PSM.
           EXIT.
       
       VAL-NUM-MKY-PSM SECTION.
       INI-VAL-NUM-MKY-PSM.
       FIN-VAL-NUM-MKY-PSM.
           EXIT.
       
       VAL-NUM-AKY-PSM SECTION.
       INI-VAL-NUM-AKY-PSM.
       FIN-VAL-NUM-AKY-PSM.
           EXIT.
       
       VAL-NUM-FLD-PSM SECTION.
       INI-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-MTO1.
           MOVE FRM-SGV-MTO1-ALF IN PSM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-SGV-MTO1 IN PSM-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-MTO1-LEN IN PSM-FLD
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-MTO2.
           MOVE FRM-SGV-MTO2-ALF IN PSM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-SGV-MTO2 IN PSM-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-MTO2-LEN IN PSM-FLD
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-MTO3.
           MOVE FRM-SGV-MTO3-ALF IN PSM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-SGV-MTO3 IN PSM-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-MTO3-LEN IN PSM-FLD
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-MTO4.
           MOVE FRM-SGV-MTO4-ALF IN PSM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-SGV-MTO4 IN PSM-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-MTO4-LEN IN PSM-FLD
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-1.
           MOVE FRM-NUM-NDIA-ALF IN PSM-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-NDIA IN PSM-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-NDIA-LEN IN PSM-FLD(1)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-2.
           MOVE FRM-NUM-NDIA-ALF IN PSM-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-NDIA IN PSM-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-NDIA-LEN IN PSM-FLD(2)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-3.
           MOVE FRM-NUM-NDIA-ALF IN PSM-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-NDIA IN PSM-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-NDIA-LEN IN PSM-FLD(3)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-4.
           MOVE FRM-NUM-NDIA-ALF IN PSM-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-NDIA IN PSM-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-NDIA-LEN IN PSM-FLD(4)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-5.
           MOVE FRM-NUM-NDIA-ALF IN PSM-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-NDIA IN PSM-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-NDIA-LEN IN PSM-FLD(5)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-NUM-NDIA-6.
           MOVE FRM-NUM-NDIA-ALF IN PSM-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-NDIA IN PSM-FLD(6)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-NDIA-LEN IN PSM-FLD(6)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-1.
           MOVE FRM-SGV-INT1-ALF IN PSM-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT1 IN PSM-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT1-LEN IN PSM-FLD(1)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-2.
           MOVE FRM-SGV-INT1-ALF IN PSM-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT1 IN PSM-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT1-LEN IN PSM-FLD(2)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-3.
           MOVE FRM-SGV-INT1-ALF IN PSM-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT1 IN PSM-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT1-LEN IN PSM-FLD(3)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-4.
           MOVE FRM-SGV-INT1-ALF IN PSM-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT1 IN PSM-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT1-LEN IN PSM-FLD(4)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-5.
           MOVE FRM-SGV-INT1-ALF IN PSM-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT1 IN PSM-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT1-LEN IN PSM-FLD(5)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT1-6.
           MOVE FRM-SGV-INT1-ALF IN PSM-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT1 IN PSM-FLD(6)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT1-LEN IN PSM-FLD(6)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-1.
           MOVE FRM-SGV-INT2-ALF IN PSM-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT2 IN PSM-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT2-LEN IN PSM-FLD(1)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-2.
           MOVE FRM-SGV-INT2-ALF IN PSM-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT2 IN PSM-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT2-LEN IN PSM-FLD(2)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-3.
           MOVE FRM-SGV-INT2-ALF IN PSM-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT2 IN PSM-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT2-LEN IN PSM-FLD(3)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-4.
           MOVE FRM-SGV-INT2-ALF IN PSM-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT2 IN PSM-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT2-LEN IN PSM-FLD(4)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-5.
           MOVE FRM-SGV-INT2-ALF IN PSM-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT2 IN PSM-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT2-LEN IN PSM-FLD(5)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT2-6.
           MOVE FRM-SGV-INT2-ALF IN PSM-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT2 IN PSM-FLD(6)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT2-LEN IN PSM-FLD(6)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-1.
           MOVE FRM-SGV-INT3-ALF IN PSM-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT3 IN PSM-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT3-LEN IN PSM-FLD(1)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-2.
           MOVE FRM-SGV-INT3-ALF IN PSM-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT3 IN PSM-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT3-LEN IN PSM-FLD(2)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-3.
           MOVE FRM-SGV-INT3-ALF IN PSM-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT3 IN PSM-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT3-LEN IN PSM-FLD(3)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-4.
           MOVE FRM-SGV-INT3-ALF IN PSM-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT3 IN PSM-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT3-LEN IN PSM-FLD(4)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-5.
           MOVE FRM-SGV-INT3-ALF IN PSM-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT3 IN PSM-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT3-LEN IN PSM-FLD(5)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT3-6.
           MOVE FRM-SGV-INT3-ALF IN PSM-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT3 IN PSM-FLD(6)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT3-LEN IN PSM-FLD(6)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-1.
           MOVE FRM-SGV-INT4-ALF IN PSM-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT4 IN PSM-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT4-LEN IN PSM-FLD(1)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-2.
           MOVE FRM-SGV-INT4-ALF IN PSM-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT4 IN PSM-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT4-LEN IN PSM-FLD(2)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-3.
           MOVE FRM-SGV-INT4-ALF IN PSM-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT4 IN PSM-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT4-LEN IN PSM-FLD(3)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-4.
           MOVE FRM-SGV-INT4-ALF IN PSM-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT4 IN PSM-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT4-LEN IN PSM-FLD(4)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-5.
           MOVE FRM-SGV-INT4-ALF IN PSM-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT4 IN PSM-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT4-LEN IN PSM-FLD(5)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-FRM-SGV-INT4-6.
           MOVE FRM-SGV-INT4-ALF IN PSM-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-SGV-INT4 IN PSM-FLD(6)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-INT4-LEN IN PSM-FLD(6)
                GO TO FIN-VAL-NUM-FLD-PSM.
       VAL-NUM-POC-NUM-PREP.
           MOVE POC-NUM-PREP-ALF IN PSM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO POC-NUM-PREP IN PSM-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO POC-NUM-PREP-LEN IN PSM-FLD
                GO TO FIN-VAL-NUM-FLD-PSM.
       FIN-VAL-NUM-FLD-PSM.
           EXIT.
       
       EDT-KEY-PSM SECTION.
       INI-EDT-KEY-PSM.
           PERFORM EDT-IKY-PSM.
           PERFORM EDT-MKY-PSM.
           PERFORM EDT-AKY-PSM.
       FIN-EDT-KEY-PSM.
           EXIT.
       
       EDT-IKY-PSM SECTION.
       INI-EDT-IKY-PSM.
           IF PSM-HRA-HRTR-LEN IN PSM-FLD = -9
                MOVE -1 TO PSM-HRA-HRTR-LEN IN PSM-FLD
                GO TO FIN-EDT-IKY-PSM.
           MOVE PSM-HRA-HRTR IN PSM-FLD TO PSM-HRA-HRTR-EDT IN PSM-EDT.
           MOVE PSM-HRA-HRTR-EDT IN PSM-EDT TO 
                PSM-HRA-HRTR-ALF IN PSM-FLD.
       FIN-EDT-IKY-PSM.
           EXIT.
       
       EDT-MKY-PSM SECTION.
       INI-EDT-MKY-PSM.
       FIN-EDT-MKY-PSM.
           EXIT.
       
       EDT-AKY-PSM SECTION.
       INI-EDT-AKY-PSM.
       FIN-EDT-AKY-PSM.
           EXIT.
       
       EDT-FLD-PSM SECTION.
       INI-EDT-FLD-PSM.
           IF FRM-SGV-MTO1-LEN IN PSM-FLD = -9
                MOVE -1 TO FRM-SGV-MTO1-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-MTO1 IN PSM-FLD TO FRM-SGV-MTO1-EDT IN PSM-EDT.
           MOVE FRM-SGV-MTO1-EDT IN PSM-EDT TO 
                FRM-SGV-MTO1-ALF IN PSM-FLD.
           IF FRM-SGV-MTO2-LEN IN PSM-FLD = -9
                MOVE -1 TO FRM-SGV-MTO2-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-MTO2 IN PSM-FLD TO FRM-SGV-MTO2-EDT IN PSM-EDT.
           MOVE FRM-SGV-MTO2-EDT IN PSM-EDT TO 
                FRM-SGV-MTO2-ALF IN PSM-FLD.
           IF FRM-SGV-MTO3-LEN IN PSM-FLD = -9
                MOVE -1 TO FRM-SGV-MTO3-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-MTO3 IN PSM-FLD TO FRM-SGV-MTO3-EDT IN PSM-EDT.
           MOVE FRM-SGV-MTO3-EDT IN PSM-EDT TO 
                FRM-SGV-MTO3-ALF IN PSM-FLD.
           IF FRM-SGV-MTO4-LEN IN PSM-FLD = -9
                MOVE -1 TO FRM-SGV-MTO4-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-MTO4 IN PSM-FLD TO FRM-SGV-MTO4-EDT IN PSM-EDT.
           MOVE FRM-SGV-MTO4-EDT IN PSM-EDT TO 
                FRM-SGV-MTO4-ALF IN PSM-FLD.
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(1) = -9
                MOVE -1 TO FRM-NUM-NDIA-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(1) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT(1).
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT(1) TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(1).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(2) = -9
                MOVE -1 TO FRM-NUM-NDIA-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(2) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT(2).
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT(2) TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(2).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(3) = -9
                MOVE -1 TO FRM-NUM-NDIA-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(3) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT(3).
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT(3) TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(3).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(4) = -9
                MOVE -1 TO FRM-NUM-NDIA-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(4) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT(4).
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT(4) TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(4).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(5) = -9
                MOVE -1 TO FRM-NUM-NDIA-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(5) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT(5).
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT(5) TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(5).
           IF FRM-NUM-NDIA-LEN IN PSM-FLD(6) = -9
                MOVE -1 TO FRM-NUM-NDIA-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(6) TO 
                FRM-NUM-NDIA-EDT IN PSM-EDT(6).
           MOVE FRM-NUM-NDIA-EDT IN PSM-EDT(6) TO 
                FRM-NUM-NDIA-ALF IN PSM-FLD(6).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(1) = -9
                MOVE -1 TO FRM-SGV-INT1-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(1) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT(1).
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT(1) TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(1).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(2) = -9
                MOVE -1 TO FRM-SGV-INT1-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(2) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT(2).
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT(2) TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(2).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(3) = -9
                MOVE -1 TO FRM-SGV-INT1-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(3) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT(3).
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT(3) TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(3).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(4) = -9
                MOVE -1 TO FRM-SGV-INT1-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(4) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT(4).
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT(4) TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(4).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(5) = -9
                MOVE -1 TO FRM-SGV-INT1-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(5) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT(5).
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT(5) TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(5).
           IF FRM-SGV-INT1-LEN IN PSM-FLD(6) = -9
                MOVE -1 TO FRM-SGV-INT1-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(6) TO 
                FRM-SGV-INT1-EDT IN PSM-EDT(6).
           MOVE FRM-SGV-INT1-EDT IN PSM-EDT(6) TO 
                FRM-SGV-INT1-ALF IN PSM-FLD(6).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(1) = -9
                MOVE -1 TO FRM-SGV-INT2-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(1) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT(1).
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT(1) TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(1).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(2) = -9
                MOVE -1 TO FRM-SGV-INT2-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(2) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT(2).
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT(2) TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(2).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(3) = -9
                MOVE -1 TO FRM-SGV-INT2-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(3) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT(3).
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT(3) TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(3).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(4) = -9
                MOVE -1 TO FRM-SGV-INT2-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(4) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT(4).
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT(4) TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(4).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(5) = -9
                MOVE -1 TO FRM-SGV-INT2-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(5) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT(5).
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT(5) TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(5).
           IF FRM-SGV-INT2-LEN IN PSM-FLD(6) = -9
                MOVE -1 TO FRM-SGV-INT2-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(6) TO 
                FRM-SGV-INT2-EDT IN PSM-EDT(6).
           MOVE FRM-SGV-INT2-EDT IN PSM-EDT(6) TO 
                FRM-SGV-INT2-ALF IN PSM-FLD(6).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(1) = -9
                MOVE -1 TO FRM-SGV-INT3-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(1) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT(1).
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT(1) TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(1).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(2) = -9
                MOVE -1 TO FRM-SGV-INT3-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(2) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT(2).
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT(2) TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(2).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(3) = -9
                MOVE -1 TO FRM-SGV-INT3-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(3) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT(3).
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT(3) TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(3).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(4) = -9
                MOVE -1 TO FRM-SGV-INT3-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(4) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT(4).
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT(4) TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(4).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(5) = -9
                MOVE -1 TO FRM-SGV-INT3-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(5) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT(5).
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT(5) TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(5).
           IF FRM-SGV-INT3-LEN IN PSM-FLD(6) = -9
                MOVE -1 TO FRM-SGV-INT3-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(6) TO 
                FRM-SGV-INT3-EDT IN PSM-EDT(6).
           MOVE FRM-SGV-INT3-EDT IN PSM-EDT(6) TO 
                FRM-SGV-INT3-ALF IN PSM-FLD(6).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(1) = -9
                MOVE -1 TO FRM-SGV-INT4-LEN IN PSM-FLD(1)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(1) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT(1).
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT(1) TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(1).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(2) = -9
                MOVE -1 TO FRM-SGV-INT4-LEN IN PSM-FLD(2)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(2) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT(2).
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT(2) TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(2).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(3) = -9
                MOVE -1 TO FRM-SGV-INT4-LEN IN PSM-FLD(3)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(3) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT(3).
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT(3) TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(3).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(4) = -9
                MOVE -1 TO FRM-SGV-INT4-LEN IN PSM-FLD(4)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(4) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT(4).
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT(4) TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(4).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(5) = -9
                MOVE -1 TO FRM-SGV-INT4-LEN IN PSM-FLD(5)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(5) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT(5).
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT(5) TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(5).
           IF FRM-SGV-INT4-LEN IN PSM-FLD(6) = -9
                MOVE -1 TO FRM-SGV-INT4-LEN IN PSM-FLD(6)
                GO TO FIN-EDT-FLD-PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(6) TO 
                FRM-SGV-INT4-EDT IN PSM-EDT(6).
           MOVE FRM-SGV-INT4-EDT IN PSM-EDT(6) TO 
                FRM-SGV-INT4-ALF IN PSM-FLD(6).
           IF POC-NUM-PREP-LEN IN PSM-FLD = -9
                MOVE -1 TO POC-NUM-PREP-LEN IN PSM-FLD
                GO TO FIN-EDT-FLD-PSM.
           MOVE POC-NUM-PREP IN PSM-FLD TO POC-NUM-PREP-EDT IN PSM-EDT.
           MOVE POC-NUM-PREP-EDT IN PSM-EDT TO 
                POC-NUM-PREP-ALF IN PSM-FLD.
       FIN-EDT-FLD-PSM.
           EXIT.
