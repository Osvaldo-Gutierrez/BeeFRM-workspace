       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGPLT.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.
      * Programa Separador de Interfaz Contable en Lotes
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY COLBRLT1.
       COPY COLBRLT2.
       COPY COLBRLT3.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.

       01  WSS-VARI.
      *
      * DEFINICION DE CAMPOS PARA ARCHIVO DE INTERFAZ PARA CONTABILIDAD
      *
      *****CABECERA*****
      *   CABECERA DE LOTE (BATCH HEADER)
           03 WSS-FZE-CABECERA.
      *      CABECERA-LOTE
              05 WSS-FZE-COD-CABE     VALUE 'BH'     PIC X(02).
      *      COMPANIA
              05 WSS-FZE-COD-CCIA     VALUE 'BCI '   PIC X(04).
      *      COD.IDENTIFICACION
              05 WSS-FZE-COD-IDEN                    PIC X(02).
      *      NUMERO DE LOTE
              05 WSS-FZE-NUM-LOTE                    PIC 9(02).
      *      TIPO DE MOVIMIENTO
              05 WSS-FZE-COD-MVTO     VALUE 2        PIC 9(01).
      *      TOTAL DE LOTE
              05 WSS-FZE-SGV-LOTE     VALUE ZEROES   PIC 9(14)V9(02).
      *      PERIODO
              05 WSS-FZE-COD-PERI     VALUE 0        PIC 9(01).
      *      FECHA
              05 WSS-FZE-FEC-FECH                    PIC X(06).
      *
      *   DETALLE DEL MOVIMIENTO (**PRIMER REGISTRO**)
      *
           03 WSS-FZE-PMERREG.
      *      IDENTIFICACION DEL REGISTRO.
              05 WSS-FZE-COD-IDE1     VALUE 'PT'     PIC X(02).
      *      NUMERO DE MOVIMIENTO
              05 WSS-FZE-NUM-MOV1                    PIC 9(04).
      *      PRIMER REGISTRO
              05 WSS-FZE-NUM-REG1     VALUE 1        PIC 9(01).
      *      DEBE-HABER
              05 WSS-FZE-NUM-DEHA                    PIC 9(02).
      *      COMPANIA
              05 WSS-FZE-COD-CIA1     VALUE 'BCI '   PIC X(04).
      *      CUENTA
              05 WSS-FZE-COD-CCSB                    PIC 9(09).
      *      BLANCOS
              05 WSS-FZE-COD-BLCO     VALUE SPACES   PIC X(09).
      *      SUCURSAL
              05 WSS-FZE-COD-SUCU                    PIC X(12).
      *      SOURCE CODE
              05 WSS-FZE-COD-CODE                    PIC X(10).
      *      FECHA
              05 WSS-FZE-FEC-FCTB                    PIC X(06).
      *      MONTO
              05 WSS-FZE-NUM-MONT     VALUE ZEROES   PIC 9(11)V9(02).
      *
      *
      *    (**SEGUNDO REGISTRO**)
      *
           03 WSS-FZE-SGDOREG.
              05 WSS-FZE-COD-IDE2     VALUE 'PT'     PIC X(02).
              05 WSS-FZE-NUM-MOV2                    PIC 9(04).
              05 WSS-FZE-NUM-REG2     VALUE 2        PIC 9(01).
              05 WSS-FZE-GLS-GLOS                    PIC X(30).
              05 WSS-FZE-COD-VIGE                    PIC X(12).
              05 WSS-FZE-COD-DESC                    PIC X(10).
              05 WSS-GLS-RESTANTE-2                  PIC X(21).
      *
      *   CABECERA DE LOTE (BATCH HEADER) DE SALIDA
           03 WSS-FZE-CABECERA-SAL.
              05 WSS-FZE-COD-CABE-SAL  VALUE 'BH'    PIC X(02).
              05 WSS-FZE-COD-CCIA-SAL  VALUE 'BCI '  PIC X(04).
              05 WSS-FZE-COD-IDEN-SAL                PIC X(02).
              05 WSS-FZE-NUM-LOTE-SAL  VALUE ZEROES  PIC 9(02).
              05 WSS-FZE-COD-MVTO-SAL  VALUE 2       PIC 9(01).
              05 WSS-FZE-SGV-LOTE-SAL  VALUE ZEROES  PIC 9(12)V9(02).
              05 WSS-FZE-COD-PERI-SAL  VALUE 0       PIC 9(01).
              05 WSS-FZE-FEC-FECH-SAL                PIC X(06).
      *
      *
           03 WSS-TOPE VALUE  99999999999            PIC 9(11).
           03 WSS-NUM-SUMA-H       VALUE ZEROES      PIC 9(12)V9(02).
           03 WSS-NUM-SUMA-D       VALUE ZEROES      PIC 9(12)V9(02).
           03 WSS-SUM-ANT-D        VALUE ZEROES      PIC 9(12)V9(02).
           03 WSS-SUM-ANT-H        VALUE ZEROES      PIC 9(12)V9(02).
           03 WSS-NUM-CORR-CAB     VALUE ZEROES      PIC 9(02).
           03 WSS-NUM-CORR         VALUE ZEROES      PIC 9(02).
           03 WSS-SGV-MONCAB       VALUE ZEROES      PIC 9(14)V9(02).
           03 WSS-CONT-LOTES       VALUE ZEROES      PIC 9(02).
      *
      *
           03 WSS-VEC-D-AUX.
              05 WSS-VEC-D-PMERREG.
                 07 WSS-VEC-COD-ID1D                 PIC X(02).
                 07 WSS-VEC-NUM-MO1D  VALUE ZEROES   PIC 9(04).
                 07 WSS-VEC-NUM-RE1D  VALUE ZEROES   PIC 9(01).
                 07 WSS-VEC-NUM-DEHD  VALUE ZEROES   PIC 9(02).
                 07 WSS-VEC-COD-CIAD                 PIC X(04).
                 07 WSS-VEC-COD-CCSD  VALUE ZEROES   PIC 9(09).
                 07 WSS-VEC-COD-BLCD                 PIC X(09).
                 07 WSS-VEC-COD-SUCD                 PIC X(12).
                 07 WSS-VEC-COD-CODD                 PIC X(10).
                 07 WSS-VEC-FEC-FCTD                 PIC X(06).
                 07 WSS-VEC-NUM-MOND  VALUE ZEROES   PIC 9(11)V9(02).
      *DPM INI  28-JUN-1996
      *          07 WSS-VEC-NUM-NVID                 PIC 9(03).
      *          07 WSS-VEC-GLS-RESTANTE-D           PIC X(03).
                 07 WSS-VEC-GLS-RESTANTE-D           PIC X(06).
      *DPM FIN
              05 WSS-VEC-D-SGDOREG.
                 07 WSS-VEC-COD-ID2D                 PIC X(02).
                 07 WSS-VEC-NUM-MO2D  VALUE ZEROES   PIC 9(04).
                 07 WSS-VEC-NUM-RE2D  VALUE ZEROES   PIC 9(01).
                 07 WSS-VEC-GLS-GLOD                 PIC X(30).
                 07 WSS-VEC-COD-VIGD                 PIC X(12).
                 07 WSS-VEC-COD-DESD                 PIC X(10).
                 07 WSS-VEC-GLS-RESTANTE-D           PIC X(21).

           03 WSS-VEC-H-AUX.
              05 WSS-VEC-H-PMERREG.
                 07 WSS-VEC-COD-ID1H                 PIC X(02).
                 07 WSS-VEC-NUM-MO1H  VALUE ZEROES   PIC 9(04).
                 07 WSS-VEC-NUM-RE1H  VALUE ZEROES   PIC 9(01).
                 07 WSS-VEC-NUM-DEHH  VALUE ZEROES   PIC 9(02).
                 07 WSS-VEC-COD-CIAH                 PIC X(04).
                 07 WSS-VEC-COD-CCSH  VALUE ZEROES   PIC 9(09).
                 07 WSS-VEC-COD-BLCH                 PIC X(09).
                 07 WSS-VEC-COD-SUCH                 PIC X(12).
                 07 WSS-VEC-COD-CODH                 PIC X(10).
                 07 WSS-VEC-FEC-FCTH                 PIC X(06).
                 07 WSS-VEC-NUM-MONH  VALUE ZEROES   PIC 9(11)V9(02).
      *DPM INI  28-JUN-1996
      *          07 WSS-VEC-NUM-NVIH                 PIC 9(03).
      *          07 WSS-VEC-GLS-RESTANTE-H           PIC X(03).
                 07 WSS-VEC-GLS-RESTANTE-H           PIC X(06).
      *DPM FIN  28-JUN-1996
              05 WSS-VEC-H-SGDOREG.
                 07 WSS-VEC-COD-ID2H                 PIC X(02).
                 07 WSS-VEC-NUM-MO2H  VALUE ZEROES   PIC 9(04).
                 07 WSS-VEC-NUM-RE2H  VALUE ZEROES   PIC 9(01).
                 07 WSS-VEC-GLS-GLOH                 PIC X(30).
                 07 WSS-VEC-COD-VIGH                 PIC X(12).
                 07 WSS-VEC-COD-DESH                 PIC X(10).
                 07 WSS-VEC-GLS-RESTANTE-H           PIC X(21).

      * Contadores para las Estadisticas.
           03 WSS-NUM-RLE1     VALUE ZEROES PIC 9(06).
           03 WSS-NUM-RLE2     VALUE ZEROES PIC 9(06).
           03 WSS-NUM-RLC1     VALUE ZEROES PIC 9(06).
           03 WSS-NUM-RLC2     VALUE ZEROES PIC 9(06).
           03 WSS-NUM-CON3     VALUE ZEROES PIC 9(06).
           03 WSS-NUM-CABE     VALUE ZEROES PIC 9(02).
      *
       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPGPLT' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM OPEN-FILE.
           PERFORM INICIO.
           PERFORM INP-SRT.
           PERFORM CLOSE-FILE.
           PERFORM MUESTRA-ESTADISTICAS.
       FIN-MAIN.
           PERFORM GNS-PRO-END.
      *
       OPEN-FILE SECTION.
      *-----------------*
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-LT1.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-LT2.
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
       FIN-OPEN-FILE.
           EXIT.
      *
       INICIO SECTION.
       INI-INICIO.
           DISPLAY 'INICIO GENERACION DE INTERFAZ EN LOTES'.
       FIN-INICIO.
           EXIT.
      *

       INP-SRT SECTION.
      *---------------*
       INI-INP-SRT.
      *-----------*
      *INI-JGM 09-04-1998
           MOVE ZEROES TO WSS-NUM-RLE1 IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-RLE2 IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-RLC1 IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-RLC2 IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-CON3 IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-CABE IN WSS-VARI.
      *FIN-JGM 09-04-1998
           MOVE ZEROES TO WSS-NUM-CORR WSS-NUM-CORR-CAB.
           PERFORM LEER-ARCH1.
           IF NOT (FIO-STAT-OKS AND
              LT1-IND-TREG IN LT1 = 'BH')
               DISPLAY 'NO EXISTEN REGISTROS A PROCESAR'
      *        GO TO GNS-PRO-ABT
               GO TO FIN-INP-SRT.
           MOVE LT1 TO WSS-FZE-CABECERA.
           MOVE WSS-FZE-SGV-LOTE TO WSS-SGV-MONCAB.

       LUP-INP-SRT.
           IF WSS-SGV-MONCAB IN WSS-VARI > WSS-TOPE AND
              WSS-SGV-MONCAB IN WSS-VARI > ZEROES
               GO TO NXT-PROC.

           MOVE WSS-CONT-LOTES       TO WSS-FZE-NUM-LOTE.
      *DPM ini  22-AUG-1996
           ADD 1                     TO WSS-NUM-CORR-CAB.
      *DPM fin  22-AUG-1996
           MOVE WSS-SGV-MONCAB       TO WSS-FZE-SGV-LOTE-SAL.
           MOVE WSS-FZE-COD-IDEN     TO WSS-FZE-COD-IDEN-SAL.
           MOVE WSS-NUM-CORR-CAB     TO WSS-FZE-NUM-LOTE-SAL.
           MOVE WSS-FZE-COD-MVTO     TO WSS-FZE-COD-MVTO-SAL.
           MOVE WSS-FZE-COD-PERI     TO WSS-FZE-COD-PERI-SAL.
           MOVE WSS-FZE-FEC-FECH     TO WSS-FZE-FEC-FECH-SAL.
           MOVE WSS-FZE-CABECERA-SAL TO LT3.
           PERFORM GRABA-CABECERA.
           ADD 1                     TO WSS-CONT-LOTES.

           IF WSS-VEC-NUM-MOND > ZEROES
               PERFORM GRABA-VEC-D-SRT.

           IF WSS-VEC-NUM-MONH > ZEROES
               PERFORM GRABA-VEC-H-SRT.

           PERFORM GRABA-ARCH1-LT2.
           PERFORM GRABA-ARCH2-LT2.
           GO TO FIN-INP-SRT.

       NXT-PROC.
           MOVE WSS-TOPE             TO WSS-FZE-SGV-LOTE-SAL.
           MOVE WSS-CONT-LOTES       TO WSS-FZE-NUM-LOTE.
      *DPM ini  22-AUG-1996
           ADD 1                     TO WSS-NUM-CORR-CAB.
      *DPM fin  22-AUG-1996
           MOVE WSS-FZE-COD-IDEN     TO WSS-FZE-COD-IDEN-SAL.
           MOVE WSS-NUM-CORR-CAB     TO WSS-FZE-NUM-LOTE-SAL.
           MOVE WSS-FZE-COD-MVTO     TO WSS-FZE-COD-MVTO-SAL.
           MOVE WSS-FZE-COD-PERI     TO WSS-FZE-COD-PERI-SAL.
           MOVE WSS-FZE-FEC-FECH     TO WSS-FZE-FEC-FECH-SAL.
           MOVE WSS-FZE-CABECERA-SAL TO LT3.
           PERFORM GRABA-CABECERA.

           IF WSS-VEC-NUM-MOND > ZEROES
               PERFORM GRABA-VEC-D-SRT.

           IF WSS-VEC-NUM-MONH > ZEROES
               PERFORM GRABA-VEC-H-SRT.

           SUBTRACT WSS-TOPE FROM WSS-SGV-MONCAB
                           GIVING WSS-SGV-MONCAB.

       LEE-NXT-ARCH1.
           PERFORM LEER-ARCH1.
           MOVE LT1 TO WSS-FZE-PMERREG.
           IF WSS-FZE-NUM-REG1 NOT = 1
              GO TO FIN-INP-SRT.

           ADD WSS-FZE-NUM-MONT TO WSS-NUM-SUMA-D
                            GIVING WSS-NUM-SUMA-D.

           IF WSS-NUM-SUMA-D < WSS-TOPE
               PERFORM GRABA-REG-SRT-D
               GO TO LEE-NXT-ARCH1.

           SUBTRACT WSS-FZE-NUM-MONT FROM WSS-NUM-SUMA-D
                                    GIVING WSS-SUM-ANT-D.
           SUBTRACT WSS-SUM-ANT-D FROM WSS-TOPE
                                 GIVING WSS-FZE-NUM-MONT.
           PERFORM GRABA-REG-SRT-D.
           SUBTRACT WSS-TOPE FROM WSS-NUM-SUMA-D
                           GIVING WSS-FZE-NUM-MONT.
           PERFORM GUARDA-REG-D-VEC.

       LEE-NXT-ARCH2.
           PERFORM LEER-ARCH2.
           MOVE LT2 TO WSS-FZE-PMERREG.
           ADD WSS-FZE-NUM-MONT TO WSS-NUM-SUMA-H
                            GIVING WSS-NUM-SUMA-H.

           IF WSS-NUM-SUMA-H < WSS-TOPE
               PERFORM GRABA-REG-SRT-H
               GO TO LEE-NXT-ARCH2
           ELSE
               SUBTRACT WSS-FZE-NUM-MONT FROM WSS-NUM-SUMA-H
                                        GIVING WSS-SUM-ANT-H
               SUBTRACT WSS-SUM-ANT-H FROM WSS-TOPE
                                     GIVING WSS-FZE-NUM-MONT
               PERFORM GRABA-REG-SRT-H
               SUBTRACT WSS-TOPE FROM WSS-NUM-SUMA-H
                               GIVING WSS-FZE-NUM-MONT
               PERFORM GUARDA-REG-H-VEC
               GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *-----------*
           EXIT.


       GRABA-CABECERA SECTION.
       INI-GRABA-CABECERA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.

      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CABE IN WSS-VARI.
      *INI-JGM 09-04-1998.
           MOVE ZEROES TO WSS-NUM-SUMA-D
                          WSS-NUM-SUMA-H
                          WSS-NUM-CORR.
       FIN-GRABA-CABECERA.
           EXIT.


       GRABA-VEC-D-SRT SECTION.
      *---------------------*
       INI-GRABA-VEC-D-SRT.
      *DPM ini  22-AUG-1996
           ADD 1                  TO WSS-NUM-CORR.
           MOVE WSS-NUM-CORR      TO WSS-VEC-NUM-MO1D.
      *DPM ini  22-AUG-1996
           MOVE WSS-VEC-D-PMERREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.

      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.

           MOVE WSS-NUM-CORR      TO WSS-VEC-NUM-MO2D.
           MOVE WSS-VEC-D-SGDOREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.
      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.
           MOVE WSS-VEC-NUM-MOND  TO WSS-NUM-SUMA-D.
           MOVE ZEROES            TO WSS-VEC-NUM-MOND.
       FIN-GRABA-VEC-D-SRT.
           EXIT.


       GRABA-VEC-H-SRT SECTION.
      *---------------------*
       INI-GRABA-VEC-H-SRT.
           ADD 1                  TO WSS-NUM-CORR.
           MOVE WSS-NUM-CORR      TO WSS-VEC-NUM-MO1H.
           MOVE WSS-VEC-H-PMERREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.

      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.
           MOVE WSS-NUM-CORR      TO WSS-VEC-NUM-MO2H.
           MOVE WSS-VEC-H-SGDOREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.
      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.
           MOVE WSS-VEC-NUM-MONH  TO WSS-NUM-SUMA-H.
           MOVE ZEROES            TO WSS-VEC-NUM-MONH.
       FIN-GRABA-VEC-H-SRT.
           EXIT.


       GRABA-ARCH1-LT2 SECTION.
      *-----------------------*
       INI-GRABA-ARCH1-LT2.
           PERFORM LEER-ARCH1.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GRABA-ARCH1-LT2.
           MOVE LT1             TO WSS-FZE-PMERREG.
           ADD 1                TO WSS-NUM-CORR.
      *     MOVE WSS-CONT-LOTES  TO SRT-NUM-LOTE.
      *     MOVE WSS-NUM-CORR    TO SRT-NUM-CORR WSS-FZE-NUM-MOV1.
           MOVE WSS-NUM-CORR    TO WSS-FZE-NUM-MOV1.
           MOVE WSS-FZE-PMERREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.

      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.

           PERFORM LEER-ARCH1.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GRABA-ARCH1-LT2.
           MOVE LT1             TO WSS-FZE-SGDOREG.
           MOVE WSS-NUM-CORR    TO WSS-FZE-NUM-MOV2.
           MOVE WSS-FZE-SGDOREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.

      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.

           GO TO INI-GRABA-ARCH1-LT2.
       FIN-GRABA-ARCH1-LT2.
           EXIT.


       GRABA-ARCH2-LT2 SECTION.
      *-----------------------*
       INI-GRABA-ARCH2-LT2.
           PERFORM LEER-ARCH2.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GRABA-ARCH2-LT2.
           MOVE LT2             TO WSS-FZE-PMERREG.
           ADD 1                TO WSS-NUM-CORR.
      *     MOVE WSS-CONT-LOTES  TO SRT-NUM-LOTE.
           MOVE WSS-NUM-CORR    TO WSS-FZE-NUM-MOV1.
           MOVE WSS-FZE-PMERREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.
      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.

           PERFORM LEER-ARCH2.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GRABA-ARCH2-LT2.
           MOVE LT2             TO WSS-FZE-SGDOREG.
           MOVE WSS-NUM-CORR    TO WSS-FZE-NUM-MOV2.
           MOVE WSS-FZE-SGDOREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.
      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.
           GO TO INI-GRABA-ARCH2-LT2.
       FIN-GRABA-ARCH2-LT2.
           EXIT.


       GRABA-REG-SRT-D SECTION.
      *---------------------*
       INI-GRABA-REG-SRT-D.
           ADD 1                TO WSS-NUM-CORR.
           MOVE WSS-NUM-CORR    TO WSS-FZE-NUM-MOV1.
           MOVE WSS-FZE-PMERREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.
      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.

           PERFORM LEER-ARCH1.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GRABA-REG-SRT-D.
           MOVE LT1             TO WSS-FZE-SGDOREG.
           MOVE WSS-NUM-CORR    TO WSS-FZE-NUM-MOV2.
           MOVE WSS-FZE-SGDOREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.
      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.
       FIN-GRABA-REG-SRT-D.
           EXIT.


       GRABA-REG-SRT-H SECTION.
      *---------------------*
       INI-GRABA-REG-SRT-H.
           ADD 1                TO WSS-NUM-CORR.
           MOVE WSS-NUM-CORR    TO WSS-FZE-NUM-MOV1.
           MOVE WSS-FZE-PMERREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.
      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.
           PERFORM LEER-ARCH2.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GRABA-REG-SRT-H.
           MOVE LT2             TO WSS-FZE-SGDOREG.
           MOVE WSS-NUM-CORR    TO WSS-FZE-NUM-MOV2.
           MOVE WSS-FZE-SGDOREG TO LT3.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LT3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR GRABACION ARCHIVO LT3'
               PERFORM GNS-PRO-ABT.
      *INI-JGM 09-04-1998.
           ADD 1 TO WSS-NUM-CON3 IN WSS-VARI.
      *INI-JGM 09-04-1998.
       FIN-GRABA-REG-SRT-H.
           EXIT.


       GUARDA-REG-D-VEC SECTION.
      *------------------------*
       INI-GUARDA-REG-D-VEC.
           MOVE WSS-FZE-PMERREG TO WSS-VEC-D-PMERREG.
           MOVE WSS-FZE-SGDOREG TO WSS-VEC-D-SGDOREG.
       FIN-GUARDA-REG-D-VEC.
           EXIT.


       GUARDA-REG-H-VEC SECTION.
      *------------------------*
       INI-GUARDA-REG-H-VEC.
           MOVE WSS-FZE-PMERREG TO WSS-VEC-H-PMERREG.
           MOVE WSS-FZE-SGDOREG TO WSS-VEC-H-SGDOREG.
       FIN-GUARDA-REG-H-VEC.
           EXIT.


       LEER-ARCH1 SECTION.
      *------------------*
       INI-LEER-ARCH1.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-LT1.
           IF FIO-STAT-OKS
              IF LT1-IND-TREG IN LT1 = 'BH'
               ADD 1 TO WSS-NUM-RLC1 IN WSS-VARI
              ELSE
               ADD 1 TO WSS-NUM-RLE1 IN WSS-VARI.
       FIN-LEER-ARCH1.
           EXIT.


       LEER-ARCH2 SECTION.
      *------------------*
       INI-LEER-ARCH2.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-LT2.
           IF FIO-STAT-OKS
              IF LT1-IND-TREG IN LT1 = 'BH'
                 ADD 1 TO WSS-NUM-RLC2 IN WSS-VARI
              ELSE
                 ADD 1 TO WSS-NUM-RLE2 IN WSS-VARI.
       FIN-LEER-ARCH2.
           EXIT.


       CLOSE-FILE SECTION.
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-LT1.
           PERFORM COL-FIO-LT2.
           PERFORM COL-FIO-LT3.
       FIN-CLOSE-FILE.
           EXIT.
      *INI-JGM 09-04-1998.
      ******************************************************************
       MUESTRA-ESTADISTICAS SECTION.
      *****************************
       INI-MUESTRA-ESTADISTICAS.
           DISPLAY ' '.
           DISPLAY ' ESTADISTICAS DEL PROCESO COLPGPLT'.
           DISPLAY ' ---------------------------------'.
           DISPLAY ' '.
           DISPLAY 'REGISTROS LEIDOS DESDE ARCHIVO LT1    : '
                    WSS-NUM-RLE1 IN WSS-VARI.
           DISPLAY 'CABECERAS LEIDAS DESDE ARCHIVO LT1     : '
                    WSS-NUM-RLC1 IN WSS-VARI.

           DISPLAY 'REGISTROS LEIDOS DESDE ARCHIVO LT2    : '
                    WSS-NUM-RLE2 IN WSS-VARI.
           DISPLAY 'CABECERAS LEIDAS DESDE ARCHIVO LT2     : '
                    WSS-NUM-RLC2 IN WSS-VARI.
      *
           DISPLAY 'CABECERAS GRABADAS EN LT3     : '
                    WSS-NUM-CABE IN WSS-VARI.

           DISPLAY 'MOVIMIENTOS GRABADOS EN LT3     : '
                    WSS-NUM-CON3 IN WSS-VARI.

       FIN-MUESTRA-ESTADISTICAS.
           EXIT.
      *FIN-JGM 09-04-1998.


       COPY COLBFLT1.
       COPY COLBFLT2.
       COPY COLBFLT3.
       COPY GNSBGIDD.
       COPY GNSBBSYS.
       COPY GNSBGEND.
       COPY GNSBGABT.

