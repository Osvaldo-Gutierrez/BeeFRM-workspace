       IDENTIFICATION DIVISION.
      *=======================*
       PROGRAM-ID.      COLPGBIC.
       AUTHOR.          BEE.
       DATE-WRITTEN.     1-JUL-1998.
      * Programa para Proceso Mensual de Devengo.
      * Bancos Chilenos BDE,BCI.
      *
       ENVIRONMENT DIVISION.
      *====================*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------*
       FILE-CONTROL.
      *     SELECT COLBCI ASSIGN TO COLBCI.

       DATA DIVISION.
      *=============*
       WORKING-STORAGE SECTION.
      *-----------------------*
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IDD-REQA==.
      *DPM ini  30-OCT-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CPP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ERC-REQA==.
      *DPM fin  30-OCT-1996
      *<<<< WSS
       COPY COLBRICG.
       COPY COLBROPS.
       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBRVEN.
      * COPY COLWGVEN.
       COPY COLBRCAN.
       COPY TABBRTIO.
       COPY TABBRCAM.
       COPY GNSBRTAB.
       COPY GNSBRIDD.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
       COPY COLWGINT.
       COPY COLBRDVG.
       COPY COLBRDVG REPLACING == DVG.== BY == DV2.==.
       COPY COLWGMOR.
      *DPM ini  29-OCT-1996 BCI
       COPY COLBRTMC.
       COPY COLBRCPP.
       COPY COLBRDCC.
       COPY COLBRERC.
       COPY COLBRTOC.
      *DPM fin  29-OCT-1996 BCI

      *ALD-BCI-INI/05.05.1999
       COPY TABWGTXC.
      *ALD-BCI-FIN/05.05.1999
       01  VAL-VARI.
           03 VAL-I                               PIC S9(11)V9(04).
           03 VAL-R                               PIC S9(11)V9(04).
           03 VAL-IM                              PIC S9(11)V9(04).
           03 VAL-RM                              PIC S9(11)V9(04).
           03 VAL-ROR                             PIC S9(11)V9(04).
           03 VAL-IOR                             PIC S9(11)V9(04).

       01  WSS-VARI.
      * FECHAS
           03  WSS-FEC-FPRO.
               05  WSS-NUM-DPRO                   PIC 9(02).
               05  WSS-NUM-MPRO                   PIC 9(02).
               05  WSS-NUM-SPRO                   PIC 9(02).
               05  WSS-NUM-APRO                   PIC 9(02).

      *JUS-INI 21-JAN-1998
           03  WSS-FEC-FEJE.
               05  WSS-NUM-DEJE                   PIC 9(02).
               05  WSS-NUM-MEJE                   PIC 9(02).
               05  WSS-NUM-SEJE                   PIC 9(02).
               05  WSS-NUM-AEJE                   PIC 9(02).
      *JUS-FIN 21-JAN-1998

           03  WSS-FEC-F1.
               05  WSS-NUM-S1                     PIC 9(02).
               05  WSS-NUM-A1                     PIC 9(02).
               05  WSS-NUM-M1                     PIC 9(02).
               05  WSS-NUM-D1                     PIC 9(02).
           03  WSS-FEC-F2.
               05  WSS-NUM-S2                     PIC 9(02).
               05  WSS-NUM-A2                     PIC 9(02).
               05  WSS-NUM-M2                     PIC 9(02).
               05  WSS-NUM-D2                     PIC 9(02).

      *   Fecha de parametro para calculo de Mora
           03  WSS-FEC-FCAL.
               05  WSS-NUM-SCAL                   PIC 9(02).
               05  WSS-NUM-ACAL                   PIC 9(02).
               05  WSS-NUM-MCAL                   PIC 9(02).
               05  WSS-NUM-DCAL                   PIC 9(02).

      *   Fecha Proceso (FPRO) en formato SSAAMMDD
           03  WSS-FEC-FTRA.
               05  WSS-NUM-STRA                   PIC 9(02).
               05  WSS-NUM-ATRA                   PIC 9(02).
               05  WSS-NUM-MTRA                   PIC 9(02).
               05  WSS-NUM-DTRA                   PIC 9(02).

      *JUS-INI 21-JAN-1998
      *   Fecha Ejecucion (FEJE) en formato SSAAMMDD
           03  WSS-FEC-FEXE.
               05  WSS-NUM-SEXE                   PIC 9(02).
               05  WSS-NUM-AEXE                   PIC 9(02).
               05  WSS-NUM-MEXE                   PIC 9(02).
               05  WSS-NUM-DEXE                   PIC 9(02).
      *JUS-FIN 21-JAN-1998

      *   Fecha FSDM Suspension de Devengo por Mora
           03  WSS-FEC-FSDM.
               05  WSS-NUM-SSDM                   PIC 9(02).
               05  WSS-NUM-ASDM                   PIC 9(02).
               05  WSS-NUM-MSDM                   PIC 9(02).
               05  WSS-NUM-DSDM                   PIC 9(02).

      *   Fecha FSDR Suspension de Devengo por Clasificacion de Riesgo
           03  WSS-FEC-FSDR.
               05  WSS-NUM-SSDR                   PIC 9(02).
               05  WSS-NUM-ASDR                   PIC 9(02).
               05  WSS-NUM-MSDR                   PIC 9(02).
               05  WSS-NUM-DSDR                   PIC 9(02).

      *   Fecha FSUS Suspension de Devengo (Mora o Riesgo)
           03  WSS-FEC-FSUS.
               05  WSS-NUM-SSUS                   PIC 9(02).
               05  WSS-NUM-ASUS                   PIC 9(02).
               05  WSS-NUM-MSUS                   PIC 9(02).
               05  WSS-NUM-DSUS                   PIC 9(02).

      *   Fecha FADV Auxiliar de Devengo
           03  WSS-FEC-FADV.
               05  WSS-NUM-SADV                   PIC 9(02).
               05  WSS-NUM-AADV                   PIC 9(02).
               05  WSS-NUM-MADV                   PIC 9(02).
               05  WSS-NUM-DADV                   PIC 9(02).

      * CONTADORES
           03 WSS-NUM-ROPC      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-RNSE      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-REDV      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-LOPC      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-GOPC      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-DOPC      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-RDVG      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-GDV2      VALUE ZEROES      PIC 9(07).

      *               Valores: 'M' -> Mora / 'R' -> Riesgo
           03 WSS-IND-SCTB                        PIC X(03).
      *     03 WSS-TIPO-SUSP                       PIC X(01).
           03 WSS-IND-CAN                         PIC X(01).
           03 WSS-TIPO-DEV                        PIC X(01).
           03 WSS-IND-CALC                        PIC X(02).
           03 WSS-JUS                             PIC X(01).
      *     03 WSS-ERR-MORA                        PIC 9(01) VALUE 0.
      *   Indica desde donde fue llamado el proceso CALCULA-NORMAL
      *   'PO'=>PRO-OPC           / 'FR'=>PRO-VEN-FUERA-RANGO
      *   'SD'=>PRO-SUSP-DEVENGO
           03 WSS-IND-DESDE       VALUE SPACES    PIC X(02).

      * MONTOS
      *       Parametro Monto Capital en Calculo de Intereses
           03 WSS-VAL-CAPI                        PIC 9(11)V9(04).

      *       Monto de Intereses Devengados normales
           03 WSS-VAL-INTD                        PIC 9(11)V9(04).
      *       Monto de Reajustes Devengados normales
      *     03 WSS-VAL-READ                        PIC 9(11)V9(04).
           03 WSS-VAL-READ                        PIC S9(11)V9(04).

      *       Monto de Intereses Moratorios Orden
           03 WSS-VAL-INTM                        PIC 9(11)V9(04).
      *       Monto de Reajustes Moratorios Orden
      *     03 WSS-VAL-REAM                        PIC 9(11)V9(04).
           03 WSS-VAL-REAM                        PIC S9(11)V9(04).

      *       Monto de Intereses Devengados en Orden
           03 WSS-VAL-INTO                        PIC 9(11)V9(04).
      *       Monto de Reajustes Devengados en Orden
      *     03 WSS-VAL-REAO                        PIC 9(11)V9(04).
           03 WSS-VAL-REAO                        PIC S9(11)V9(04).

           03 WSS-VAL-INTD0                       PIC 9(11).
      *    03 WSS-VAL-READ0                       PIC 9(11).
           03 WSS-VAL-READ0                       PIC S9(11).
           03 WSS-VAL-INTM0                       PIC 9(11).
      *    03 WSS-VAL-REAM0                       PIC 9(11).
           03 WSS-VAL-REAM0                       PIC S9(11).
           03 WSS-VAL-INTO0                       PIC 9(11).
      *    03 WSS-VAL-REAO0                       PIC 9(11).
           03 WSS-VAL-REAO0                       PIC S9(11).

           03 WSS-VAL-INTD2                       PIC 9(11)V9(02).
      *    03 WSS-VAL-READ2                       PIC 9(11)V9(02).
           03 WSS-VAL-READ2                       PIC S9(11)V9(02).
           03 WSS-VAL-INTM2                       PIC 9(11)V9(02).
      *    03 WSS-VAL-REAM2                       PIC 9(11)V9(02).
           03 WSS-VAL-REAM2                       PIC S9(11)V9(02).
           03 WSS-VAL-INTO2                       PIC 9(11)V9(02).
      *    03 WSS-VAL-REAO2                       PIC 9(11)V9(02).
           03 WSS-VAL-REAO2                       PIC S9(11)V9(02).

      *       Montos Aux. para UFs.
           03 WSS-VAL-UF1                         PIC 9(11)V9(04).
           03 WSS-VAL-UF2                         PIC 9(11)V9(04).
           03 WSS-VAL-UFSU                        PIC 9(11)V9(04).
           03 WSS-VAL-UFVE                        PIC 9(11)V9(04).
           03 WSS-VAL-UFCO                        PIC 9(11)V9(04).
           03 WSS-VAL-UFPRO                       PIC 9(11)V9(04).
           03 WSS-VAL-REIN                        PIC 9(11)V9(04).
           03 WSS-VAL-RESTO                       PIC 9(11)V9(04).
      *     03 WSS-VAL-PREVEN                      PIC 9(11)V9(04).

      *    03 WSS-DIF-UFS                         PIC 9(11)V9(04).
           03 WSS-DIF-UFS                         PIC S9(11)V9(04).
      *    03 WSS-DELTA-UF1                       PIC 9(11)V9(04).
           03 WSS-DELTA-UF1                       PIC S9(11)V9(04).
      *    03 WSS-DELTA-UF2                       PIC 9(11)V9(04).
           03 WSS-DELTA-UF2                       PIC S9(11)V9(04).
      *    03 WSS-DELTA-UF3                       PIC 9(11)V9(04).
           03 WSS-DELTA-UF3                       PIC S9(11)V9(04).

      * ACUMULADORES
      *       Acumulador de saldos de cap. para vencimientos
           03 WSS-SUM-VCAP       VALUE ZEROS      PIC 9(11)V9(04).
           03 WSS-SUM-IXC        VALUE ZEROS      PIC 9(11)V9(04).
      *    03 WSS-SUM-RXC        VALUE ZEROS      PIC 9(11)V9(04).
           03 WSS-SUM-RXC        VALUE ZEROS      PIC S9(11)V9(04).
           03 WSS-SUM-IMO        VALUE ZEROS      PIC 9(11)V9(04).
      *    03 WSS-SUM-RMO        VALUE ZEROS      PIC 9(11)V9(04).
           03 WSS-SUM-RMO        VALUE ZEROS      PIC S9(11)V9(04).
           03 WSS-SUM-ISU        VALUE ZEROS      PIC 9(11)V9(04).
      *    03 WSS-SUM-RSU        VALUE ZEROS      PIC 9(11)V9(04).
           03 WSS-SUM-RSU        VALUE ZEROS      PIC S9(11)V9(04).

      * DPM ini  3-OCT-1997 campos ingresados para calculo de
      * intereses en creditos no estructurados para VEN > FPRO
           03 WSS-VAL-INTE        VALUE ZEROS     PIC S9(11)V9(04).
           03 WSS-VAL-INT         VALUE ZEROS     PIC S9(11)V9(04).
           03 WSS-VAL-IO          VALUE ZEROS     PIC S9(11)V9(04).
           03 WSS-VAL-ITOT        VALUE ZEROS     PIC S9(11)V9(04).
           03 WSS-VAL-A           VALUE ZEROS     PIC S9(11)V9(04).
           03 WSS-VAL-B           VALUE ZEROS     PIC S9(11)V9(04).
           03 WSS-VAL-C           VALUE ZEROS     PIC S9(11)V9(04).
           03 WSS-VAL-D           VALUE ZEROS     PIC S9(11)V9(04).
           03 WSS-VEN-FANT.
              05 WSS-VEN-SANT                     PIC 9(02).
              05 WSS-VEN-AANT                     PIC 9(02).
              05 WSS-VEN-MANT                     PIC 9(02).
              05 WSS-VEN-DANT                     PIC 9(02).
      * DPM fin  3-OCT-1997
      * DPM ini  13-OCT-1997
           03 WSS-VEN-FPRI.
              05 WSS-VEN-SPRI                     PIC 9(02).
              05 WSS-VEN-APRI                     PIC 9(02).
              05 WSS-VEN-MPRI                     PIC 9(02).
              05 WSS-VEN-DPRI                     PIC 9(02).
      * DPM fin  13-OCT-1997
      *
      * LLAVES AUXILIARES
           03 WSS-CIC-VEN                         PIC X(12).
           03 WSS-CIC-IOPC                        PIC X(12).
           03 WSS-NUM-IVEN                        PIC 9(03).
           03 WSS-NUM-IVEN0                       PIC 9(03).
      *     03 WSS-CIC-CAN                         PIC X(12).
      *     03 WSS-CORR-CAN                        PIC 9(03).
           03 WSS-COD-PESO                        PIC X(06).
           03 WSS-COD-OFIC                        PIC X(03).
           03 WSS-COD-MONEDA.
              05 WSS-MSC-TVOC                     PIC X(01).
              05 WSS-COD-CVOC                     PIC X(03).
              05 WSS-COD-TCOC                     PIC X(02).
           03 WSS-TASA                     PIC ZZ9,999999999999.
           03 WSS-MONTO                    PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
           03 WSS-MONTO2                   PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
           03 WSS-MOR-TIPE                 PIC ZZ9,999999999999.

           03 WSS-COD-CVIG.
              05 WSS-COD-CAMB                        PIC X(12).
              05 WSS-FEC-FVCA                        PIC 9(08).
      *     03 WSS-FEC-FVCA0                       PIC 9(08).
      *     03 FIO-CMND-AUX                        PIC 9(04).
      *     03 EOF-CAM                             PIC X(01).
      *     03 WSS-FLAG-CAM                        PIC X(01).
           03 WSS-FLAG-VEN                        PIC X(01).

      *DPM ini  28-OCT-1996 BCI
           03 WSS-COD-VCOC.
              05 WSS-COD-TVOC                     PIC X(01).
              05 WSS-COD-CVOC                     PIC X(03).
              05 WSS-COD-TCOC                     PIC X(02).
      *     03 WSS-NUM-IREG    VALUE ZEROES        PIC 9(01).
           03 CPP-I           VALUE ZEROES        PIC 9(03).
           03 WSS-COD-CPTO    VALUE SPACES        PIC X(06).

      *Variables para calculo de tasa para mora
           03 WSS-DIAM        VALUE 0             PIC 9(03).
           03 WSS-INT-TB90    COMP-3              PIC 9(03)V9(08).
           03 WSS-INT-TS90    COMP-3              PIC 9(03)V9(08).
           03 WSS-INT-TMAX    COMP-3              PIC 9(03)V9(08).
           03 WSS-PESO        VALUE ' '           PIC X(01).
              88 WSS-PESO-SI            VALUE 'S'.
              88 WSS-PESO-NO            VALUE 'N'.
           03 WSS-IND-TMON    VALUE SPACES        PIC X(01).
           03 WSS-PLZO                            PIC X(12).
              88 WSS-PLZO-B90           VALUE 'C1' 'C2'.
           03 WSS-SGV-CANT    COMP-3              PIC S9(07)V9(02).
           03 WSS-SGV-VENT    COMP-3              PIC S9(07)V9(02).
           03 WSS-SGV-MTMC    COMP-3              PIC S9(11)V9(04).
      *DPM fin  28-OCT-1996 BCI
      *DPM ini  9-DEC-1996
           03 AUX-CIC-IOPC    VALUE SPACES        PIC X(12).
      *ALD-BCI-INI/05051999
           03 WSS-CRED-ORIG   COMP-3              PIC S9(11)V9(04).
           03 WSS-FEC-FORI.
              05 WSS-NUM-SORI VALUE ZEROES        PIC 9(02).
              05 WSS-NUM-AORI VALUE ZEROES        PIC 9(02).
              05 WSS-NUM-MORI VALUE ZEROES        PIC 9(02).
              05 WSS-NUM-DORI VALUE ZEROES        PIC 9(02).
      *ALD-BCI-FIN/05051999
           03 WSS-FEC-FCOL.
              05 WSS-NUM-SCOL VALUE ZEROES        PIC 9(02).
              05 WSS-NUM-ACOL VALUE ZEROES        PIC 9(02).
              05 WSS-NUM-MCOL VALUE ZEROES        PIC 9(02).
              05 WSS-NUM-DCOL VALUE ZEROES        PIC 9(02).
           03 WSS-OPEC        VALUE SPACES        PIC X(01).
           03 WSS-FEC-FVEN.
              05 WSS-NUM-SVEN VALUE ZEROES        PIC 9(02).
              05 WSS-NUM-AVEN VALUE ZEROES        PIC 9(02).
              05 WSS-NUM-MVEN VALUE ZEROES        PIC 9(02).
              05 WSS-NUM-DVEN VALUE ZEROES        PIC 9(02).
           03 WSS-IND-DISP    VALUE SPACES        PIC X(01).
      * DPM ini  1-JUL-1998
           03 WSS-IND-PROC    VALUE SPACES        PIC X(01).
      * DPM fin  1-JUL-1998
      * Variables para emulacion de archivo MCD para comparar con
      * CIC de tabla ALG para saber el concepto a grabar en DVG
           03 WSS-COD-INTD    VALUE 'INTD  '      PIC X(06).
           03 WSS-COD-READ    VALUE 'READ  '      PIC X(06).
           03 WSS-COD-INTO    VALUE 'INTO  '      PIC X(06).
           03 WSS-COD-REAO    VALUE 'REAO  '      PIC X(06).
           03 WSS-COD-INTM    VALUE 'INTM  '      PIC X(06).
           03 WSS-COD-REAM    VALUE 'REAM  '      PIC X(06).
      * Vector para guardar datos de CPP para grabar luego en DVG
           03 VEC-CPP-DVG OCCURS 40.
              05 VEC-MSC-TCCT                     PIC X(03).
              05 VEC-IND-DBHB                     PIC X(01).
              05 VEC-CIC-CCSB                     PIC X(12).
              05 VEC-SGV-ICTB        COMP-3       PIC S9(13)V9(02).
           03 MOV-I                               PIC 9(02).
           03 MOV-TOPE                            PIC 9(02).
      *DPM fin  9-DEC-1996
      *DPM ini  1-AUG-1997 Parametro de actualizacion de DLC
           03 WSS-IND-ACTU        VALUE 'N'       PIC X(01).
           03 WSS-PVEZ            VALUE SPACES    PIC X(01).
           03 WSS-FEC-FUCT.
              05 WSS-NUM-SUCT                     PIC 9(02).
              05 WSS-NUM-AUCT                     PIC 9(02).
              05 WSS-NUM-MUCT                     PIC 9(02).
              05 WSS-NUM-DUCT                     PIC 9(02).
           03 WSS-FEC-FINT.
              05 WSS-NUM-SINT                     PIC 9(02).
              05 WSS-NUM-AINT                     PIC 9(02).
              05 WSS-NUM-MINT                     PIC 9(02).
              05 WSS-NUM-DINT                     PIC 9(02).
           03 WSS-FEC-FXXX.
              05 WSS-NUM-SXXX                     PIC 9(02).
              05 WSS-NUM-AXXX                     PIC 9(02).
              05 WSS-NUM-MXXX                     PIC 9(02).
              05 WSS-NUM-DXXX                     PIC 9(02).
           03 WSS-IND-FLAG       VALUE SPACES     PIC X(01).
           03 WSS-IND-ULTI       VALUE SPACES     PIC X(01).
           03 WSS-IND-SALE       VALUE SPACES     PIC X(01).
           03 WSS-IND-BALA       VALUE SPACES     PIC X(01).
      *DPM fin  1-AUG-1997


       PROCEDURE DIVISION.
      *==================*
       MAIN SECTION.
      *------------*
       INI-MAIN.
      *--------*
           COPY GNSBGEDB.
           MOVE 'COLPGBIC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM INI-VAR.
           PERFORM ABRE-ARCHIVOS.
           PERFORM PRO-OPC.
      *     PERFORM CIERRA-ARCHIVOS.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-DVG.
           PERFORM COL-FIO-DV2.
           PERFORM COL-FIO-OPS.
           PERFORM COL-FIO-ERC.
       FIN-MAIN.
      *--------*
           DISPLAY 'ESTADISTICAS.'.
           DISPLAY '-------------'.
           DISPLAY ' '.
           DISPLAY 'OPCs LEIDAS           : ' WSS-NUM-LOPC IN WSS-VARI.
           DISPLAY 'OPCs NO SELECCIONADAS : ' WSS-NUM-RNSE IN WSS-VARI.
           DISPLAY 'OPCs GRABADAS DLC     : ' WSS-NUM-GOPC IN WSS-VARI.
           DISPLAY 'OPCs RECHAZADAS DLC   : ' WSS-NUM-ROPC IN WSS-VARI.
           DISPLAY 'REGs GRABADOS DVG     : ' WSS-NUM-DOPC IN WSS-VARI.
           DISPLAY 'REGs GRABADOS DV2(CAS): ' WSS-NUM-GDV2 IN WSS-VARI.
           DISPLAY 'OPCs RECHAZADAS DVG   : ' WSS-NUM-REDV IN WSS-VARI.
           PERFORM GNS-PRO-END.

       ABRE-ARCHIVOS SECTION.
      *---------------------*
       INI-ABRE-ARCHIVOS.
      *-----------------*
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

      * Obtengo COD de Peso Chileno del Banco.
           MOVE 'TAB'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'               TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '            TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL LEER VLR: ' TAB-CIC-TABL IN TAB
                            ' ' FIO-STAT
              PERFORM GNS-PRO-ABT
              GO TO FIN-ABRE-ARCHIVOS.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

           MOVE FIO-CLO TO FIO-CMND
           PERFORM GNS-FIO-TAB.

           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-DVG.
           PERFORM COL-FIO-DV2.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-OPS.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-ICG.
           PERFORM TAB-FIO-CAM.

      *DPM ini  7-AUG-1997
           PERFORM COL-FIO-TMC.
      *DPM fin  7-AUG-1997

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.

      *DPM ini  30-OCT-1996 BCI
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-DCC.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-CPP.

      * DPM ini Modificado porque graba errores antiguos cuando
      * no se borra archivo
      *     MOVE FIO-EXT TO FIO-CMND.
           MOVE FIO-OUT TO FIO-CMND.
      * DPM fin  3-OCT-1997
           PERFORM COL-FIO-ERC.
      *DPM fin  30-OCT-1996 BCI
       FIN-ABRE-ARCHIVOS.
      *-----------------*
           EXIT.

       CIERRA-ARCHIVOS SECTION.
      *-----------------------*
       INI-CIERRA-ARCHIVOS.
      *-------------------*
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-DVG.
           PERFORM COL-FIO-DV2.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-OPS.
           PERFORM COL-FIO-VEN.
      *     PERFORM COL-FIO-CAN.
           PERFORM TAB-FIO-CAM.
           PERFORM COL-FIO-DLC.
      *DPM ini  30-OCT-1996 BCI
           PERFORM COL-FIO-CPP.
           PERFORM COL-FIO-DCC.
           PERFORM COL-FIO-ERC.
      *DPM fin  30-OCT-1996 BCI
      *DPM ini  7-AUG-1997
           PERFORM COL-FIO-TMC.
      *DPM fin  7-AUG-1997
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

       FIN-CIERRA-ARCHIVOS.
      *-------------------*
           EXIT.

       INI-VAR SECTION.
      *---------------*
       INI-INI-VAR.
      *-----------*
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *
      *DPM  18-AUG-1997 Captura fecha del sistema
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO DVG-NUM-DREA IN DVG.
           MOVE HOY-MHOY TO DVG-NUM-MREA IN DVG.
           MOVE HOY-SHOY TO DVG-NUM-SREA IN DVG.
           MOVE HOY-AHOY TO DVG-NUM-AREA IN DVG.
      *DPM fin  18-AUG-1997
      *CAPTURA FECHA BALANCE
           ACCEPT   WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY 'FECHA DE BALANCE (DDMMSSAA) : '
                                    WSS-FEC-FPRO IN WSS-VARI.
           ACCEPT   WSS-COD-OFIC IN WSS-VARI.
           DISPLAY 'CODIGO OFICINA: ' WSS-COD-OFIC IN WSS-VARI.
      *DPM ini  17-DEC-1996
           ACCEPT WSS-IND-DISP IN WSS-VARI.
           DISPLAY 'INDICADOR DE DISPLAY (S/N): '
                                      WSS-IND-DISP IN WSS-VARI.
      *DPM fin  17-DEC-1996
      *DPM ini  1-AUG-1997 Crea parametro de actualizacion de DLC
           ACCEPT WSS-IND-ACTU IN WSS-VARI.
           DISPLAY 'ACTUALIZA DLC (S/N): ' WSS-IND-ACTU IN WSS-VARI.
      *DPM fin  1-AUG-1997

      * CAPTURA INDICADOR DE BALANCE O PREBALANCE
      *JUS-INI 21-JAN-1998
      * Se inhibe parametro, ya que el efecto se controlara por logica
      *     ACCEPT WSS-IND-BALA IN WSS-VARI.
      *     DISPLAY 'INDICADOR DE BALANCE O PREBALANCE (B/P): '
      *                           WSS-IND-BALA IN WSS-VARI.
      * Se Agrega:
      * CAPTURA FECHA EJECUCION (Para buscar en tablas con valores de
      *                         dias anteriores en Pre Balance)
           ACCEPT   WSS-FEC-FEJE IN WSS-VARI.
           DISPLAY 'FECHA DE PROCESO (DDMMSSAA) : '
                                    WSS-FEC-FEJE IN WSS-VARI.
      *JUS-FIN 21-JAN-1998
      * DPM ini  1-JUL-1998 Se incluye parametro de Proceso o Reproceso,
      * para buscar tablas en Base de Datos normal o especial
           ACCEPT WSS-IND-PROC IN WSS-VARI.
           DISPLAY 'INDICADOR DE PROCESO/REPROCESO: '
                                 WSS-IND-PROC IN WSS-VARI.
      * DPM fin  1-JUL-1998

      *VAL-FEC VALIDA FECHA
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'FECPROCNEX'   TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT
               GO TO FIN-INI-VAR.

           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DTRA IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MTRA IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-STRA IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-ATRA IN WSS-VARI.

      *JUS-INI 21-JAN-1998
      *VAL-FEC VALIDA FECHA EJECUCION
           MOVE WSS-FEC-FEJE IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'FECEJECNEX'   TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT
               GO TO FIN-INI-VAR.

           MOVE WSS-NUM-DEJE IN WSS-VARI TO WSS-NUM-DEXE IN WSS-VARI.
           MOVE WSS-NUM-MEJE IN WSS-VARI TO WSS-NUM-MEXE IN WSS-VARI.
           MOVE WSS-NUM-SEJE IN WSS-VARI TO WSS-NUM-SEXE IN WSS-VARI.
           MOVE WSS-NUM-AEJE IN WSS-VARI TO WSS-NUM-AEXE IN WSS-VARI.
      *JUS-FIN 21-JAN-1998

      *JUS-INI 21-JAN-1998
           IF WSS-FEC-FEXE IN WSS-VARI < WSS-FEC-FTRA IN WSS-VARI
              MOVE 'P' TO WSS-IND-BALA IN WSS-VARI
           ELSE
              MOVE 'B' TO WSS-IND-BALA IN WSS-VARI.
      *JUS-FIN 21-JAN-1998

      *Valida indicador de display
           IF WSS-IND-DISP IN WSS-VARI NOT = 'S' AND 'N'
               MOVE 'N' TO WSS-IND-DISP IN WSS-VARI.

      * Valida Indicador de Actualizacion de DLC
           IF WSS-IND-ACTU IN WSS-VARI NOT = 'S' AND 'N'
               MOVE 'N' TO WSS-IND-ACTU IN WSS-VARI.

      *JUS-INI 21-JAN-1998
      * Valida Indicador de Balance o Prebalance
      *     IF WSS-IND-BALA IN WSS-VARI NOT = 'B' AND 'P'
      *         MOVE 'B' TO WSS-IND-BALA IN WSS-VARI.
      *JUS-FIN 21-JAN-1998

      * DPM ini  1-JUL-1998
           IF WSS-IND-PROC IN WSS-VARI NOT = 'P' AND 'R'
               MOVE 'P' TO WSS-IND-PROC IN WSS-VARI.
      * DPM fin  1-JUL-1998
      *ALD-BCI-INI/05051999
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    DPTMC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO MOR-TXC
           ELSE
               MOVE 'N' TO MOR-TXC.
      *ALD-BCI-FIN/05051999
       FIN-INI-VAR.
      *-----------*
           EXIT.


       PRO-OPC SECTION.
      *---------------*
       INI-PRO-OPC.
      *-----------*
      * Se Lee el Primer Registro OPC.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-OPS.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL LEER PRIMER REG.OPC: ' FIO-STAT
              GO TO FIN-PRO-OPC.

           MOVE OPS TO OPC.

           PERFORM LIMPIA-VEC-DVG.

       LUP-PRO-OPC.
      *-----------*
      *Contador de OPC Leidas
           ADD 1 TO WSS-NUM-LOPC IN WSS-VARI.

      *DPM ini  16-SEP-1997
      * DPM ini  16-DEC-1997
           MOVE 'N' TO WSS-IND-ULTI IN WSS-VARI
                       WSS-IND-SALE IN WSS-VARI.
      * DPM fin  16-DEC-1997
           MOVE 'S' TO WSS-PVEZ IN WSS-VARI.
           MOVE ZEROES TO DVG-SGV-TASA IN DVG.
      *DPM fin  16-SEP-1997

      *   Filtra entrada al proceso por Oficina.
           IF WSS-COD-OFIC IN WSS-VARI NOT = '*  '

              IF OPC-COD-OFOC IN OPC NOT = WSS-COD-OFIC IN WSS-VARI
      *           DISPLAY 'ERROR, OFIC. DISTINTA A PARAMETRO: '
      *                                     OPC-CIC-IOPC IN OPC
                 ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
                 GO TO LEE-SIGUIENTE-OPC.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'NEW-OPC: ' OPC-CIC-IOPC IN OPC
               DISPLAY 'K: ' OPC-VAL-SCRE IN OPC
               DISPLAY 'MONEDA: ' OPC-COD-VCOC IN OPC.

      * Si fecha comp > fecha proceso no contemplar
           IF OPC-FEC-FINP IN OPC > WSS-FEC-FTRA IN WSS-VARI
      *           ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
      *           DISPLAY 'ERROR, FECHA COMP. OPC > FECHA PROCESO: '
      *                                         OPC-CIC-IOPC IN OPC
      *           MOVE 'FECINP>PRO'  TO ERC-COD-MSGE IN ERC
      *           PERFORM GRABAR-ERROR
                 ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
                 GO TO LEE-SIGUIENTE-OPC.

      *DPM ini  5-DEC-1996 Obtiene Opera como D
      *Lee TOC
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
      *Obtiene Como Opera
           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           MOVE MSC-CIC-CMSC IN MSC TO WSS-OPEC IN WSS-VARI.
      *DPM fin  5-DEC-1996

           PERFORM LEE-ICG.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               DISPLAY 'ERROR LECTURA ICG PARA LLAVE '
                                             OPC-CIC-IOPC IN OPC
               GO TO LEE-SIGUIENTE-OPC.

           PERFORM LEE-VEN-MAS-ANTIGUO.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL LEER REG. VEN, KEY:'
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
              MOVE 'OPC  NOVEN'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO LEE-SIGUIENTE-OPC.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'VEN LEIDO: ' VEN-KEY-IREG IN VEN
               DISPLAY 'FVEN: ' VEN-FEC-FVEN IN VEN
               DISPLAY 'FIMV: ' VEN-FEC-FIMV IN VEN.

      * DPM ini  9-OCT-1997 Se mueve Fecha Inicio Mora(FIMV) a FVEN
      * para que calcule los intereses a fecha de mora en credito
      * con vencimientos en dia no habil. Si VEN cae en dia habil,
      * FIMV = FVEN
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE VEN-FEC-FIMV IN VEN TO VEN-FEC-FVEN IN VEN.
      * DPM fin  9-OCT-1997

      * Si Saldo Capital Insoluto no es mayor a Cero
      * No se procesa OPC y se busca el siguiente registro
      * En el extract se verifica que la OPC este activa y con saldo
      * mayor que cero, por lo que se asterisqueo
      *     MOVE OPC-VAL-SCRE IN OPC TO WSS-MONTO IN WSS-VARI.
      *     IF NOT (OPC-VAL-SCRE IN OPC > ZEROES AND OPC-ACTIVADA)
      *        IF OPC-VAL-SCRE IN OPC > ZEROES
      *           DISPLAY 'OPC NO ACTIVADA: ' OPC-CIC-IOPC IN OPC
      *           DISPLAY 'BUSCA SIGUIENTE OPC'
      *           GO TO LEE-SIGUIENTE-OPC
      *        ELSE
      *           DISPLAY 'SALDO CREDITO CERO PARA OPC : '
      *                                       OPC-CIC-IOPC IN OPC
      *           DISPLAY 'BUSCA SIGUIENTE OPC '
      *           GO TO LEE-SIGUIENTE-OPC.

      *DPM ini  5-DEC-1996
           IF WSS-OPEC IN WSS-VARI = 'D'
              MOVE VEN-VAL-CAPI IN VEN TO OPC-VAL-SCRE IN OPC.
      *DPM fin  5-DEC-1996

      * Muevo Cod.Moneda Operacion a Variable de Memoria
      *   Limpia montos que deben quedar limpios en Reg.DLC

      * Inicializo Variables
           MOVE ZEROES TO WSS-VAL-INTD IN WSS-VARI
                          WSS-VAL-READ IN WSS-VARI
                          WSS-VAL-INTM IN WSS-VARI
                          WSS-VAL-REAM IN WSS-VARI
                          WSS-VAL-INTO IN WSS-VARI
                          WSS-VAL-REAO IN WSS-VARI.

           MOVE OPC-COD-VCOC IN OPC TO WSS-COD-MONEDA IN WSS-VARI.

      * Lee Registro DLC asociado al Reg. OPC
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE 1                   TO DLC-NUM-IDLC IN DLC.
      *DPM ini  29-OCT-1996 BCI
      *     MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           MOVE FIO-GET-KEY TO FIO-CMND.
      *DPM fin  29-OCT-1996 BCI
           PERFORM COL-FIO-DLC.
      *DPM ini  14-NOV-1996
      *     IF NOT FIO-STAT-OKS
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC )
      *DPM fin  14-NOV-1996
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL LEER REG. DLC: '
                     OPC-CIC-IOPC IN OPC ' ' FIO-STAT
              MOVE 'OPC  NODLC'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO LEE-SIGUIENTE-OPC.

      * DPM ini  1-JUL-1998 Se limpian fechas de susp. de devengo que
      * quedaron con basura por conversion de programas linea
           MOVE ZEROES TO DLC-FEC-FSDM IN DLC.

           MOVE ZEROES TO DLC-FEC-FSDE IN DLC.

           IF DLC-FEC-FDEV IN DLC NOT > ZEROES
      *ALD-BCI-INI/02.09.1999
               MOVE ZEROES TO DLC-FEC-FDEV IN DLC
               ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'FECFDEV=ZERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY 'ERROR ' MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
               MOVE 'FECFDEV=ZERO' TO ERC-COD-MSGE IN ERC
               PERFORM GRABAR-ERROR
               GO TO LEE-SIGUIENTE-OPC.
      *ALD-BCI-FIN/02.09.1999
      * DPM fin  1-JUL-1998

      *DPM ini  3-SEP-1997 Mientras no este disponible el Traspaso de Ca
           IF DLC-IND-SCTB IN DLC = 'CAS'
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
      *RVM-BCI-INI 6-APR-1998
               PERFORM GRABA-CAS-DVG
      *RVM-BCI-FIN 6-APR-1998
               GO TO LEE-SIGUIENTE-OPC.
      *DPM fin  3-SEP-1997

      *DPM ini  16-SEP-1997
      * DPM ini  8-OCT-1997 Si Credito es No estructurado, la tasa que
      * sera informada sera 9999,9999 porque no se conoce la tasa y los
      * intereses no se calcularon con tasa sino por diferencia (prorrat
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE 9999,9999 TO DVG-SGV-TASA IN DVG
           ELSE
           IF ICG-COD-CVTI IN ICG NOT > SPACES
      *        Credito a tasa fija
               MOVE ICG-SGV-TINT IN ICG TO DVG-SGV-TASA IN DVG
           ELSE
           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FTRA IN WSS-VARI
               MOVE ZEROES TO DVG-SGV-TASA IN DVG
           ELSE
      * Si es Credito variable, la tasa se obtiene de la CAM a fecha
      * de Ult Pago de Int
               PERFORM OBT-TASA-CAM.
      *DPM fin  16-SEP-1997

      *DPM ini  9-DEC-1996
      *Obtiene Fecha de Colocacion de OPC original
           IF OPC-IND-RENO IN OPC = 'PRO' AND
              OPC-MSC-TVOC IN OPC = '0' AND
              OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
      * Guarda el CIC de la OPC de la prorroga
               MOVE OPC TO OPS
      * Lee OPC original para rescatar la fecha de origen
               MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
      * Mueve fecha de OPC original para la conversion a valor origen
      *ALD-BCI-INI/05051999
                   MOVE OPC-VAL-CRED IN OPC TO WSS-CRED-ORIG
      *ALD-BCI-FIN/05051999
                   MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FORI IN WSS-VARI
                   MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FCOL IN WSS-VARI
      * RESTAURO OPC
                   MOVE OPS TO OPC
              ELSE
                   ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPCORIGNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY 'ERROR ' MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
                   MOVE 'OPCORIGNEX'  TO ERC-COD-MSGE IN ERC
                   PERFORM GRABAR-ERROR
                   GO TO LEE-SIGUIENTE-OPC
           ELSE
      *ALD-BCI-INI/05051999
               MOVE OPC-VAL-CRED IN OPC TO WSS-CRED-ORIG
               MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FORI IN WSS-VARI
      *ALD-BCI-FIN/05051999
               MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FCOL IN WSS-VARI.
      *DPM fin  9-DEC-1996

      * Si Fecha de Susp.Devengo por Mora no esta en blanco
      * se procesa una Suspension de Devengo.
      *DPM ini  18-DEC-1996
           IF DLC-FEC-FSDM IN DLC < ZEROES
               MOVE ZEROES TO DLC-FEC-FSDM IN DLC.
      *DPM fin  18-DEC-1996

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'DLC-FEC-FSDM: ' DLC-FEC-FSDM IN DLC.

           IF DLC-FEC-FSDM IN DLC NOT = ZEROES AND
              DLC-FEC-FSDM IN DLC NOT = SPACES
      *DPM ini  18-DEC-1996
              IF VEN-IND-SCTB IN VEN = SPACES OR 'VIG'
                  ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                  DISPLAY 'ERROR, FSUS DEV MORA > 0 Y SIT.CTBLE VIG: '
                                                OPC-CIC-IOPC IN OPC
                  MOVE 'FSDM>0 VIG'  TO ERC-COD-MSGE IN ERC
                  PERFORM GRABAR-ERROR
                  GO TO LEE-SIGUIENTE-OPC
              ELSE
      *DPM fin  18-DEC-1996
      *            MOVE 'M' TO WSS-TIPO-SUSP
                  PERFORM PRO-SUSP-DEVENGO
                  GO TO LEE-SIGUIENTE-OPC.

      * Si Fecha de Susp.Devengo por Riesgo no esta en blanco
      * se procesa una Suspension de Devengo.
      *DPM ini  18-DEC-1996
           IF DLC-FEC-FSDE IN DLC < ZEROES
               MOVE ZEROES TO DLC-FEC-FSDE IN DLC.
      *DPM fin  18-DEC-1996
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'DLC-FEC-FSDE: ' DLC-FEC-FSDE IN DLC.

           IF DLC-FEC-FSDE IN DLC NOT = ZEROES AND
              DLC-FEC-FSDE IN DLC NOT = SPACES
      *        MOVE 'R' TO WSS-TIPO-SUSP
              PERFORM PRO-SUSP-DEVENGO
              GO TO LEE-SIGUIENTE-OPC.

      *DPM ini  18-NOV-1996
           IF VEN-FEC-FVEN IN VEN NOT < WSS-FEC-FTRA IN WSS-VARI

               MOVE SPACES TO VEN-IND-SCTB IN VEN.
      *DPM fin  18-NOV-1996

           MOVE VEN-IND-SCTB IN VEN TO WSS-IND-SCTB IN WSS-VARI.
           MOVE VEN-CIC-IOPC IN VEN TO WSS-CIC-VEN IN WSS-VARI.

      * Selecciona OPC con Situacion Contab. No Vigente en el
      * VEN mas antiguo para procesarla como No Vigente.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'SIT.CTB.EN VEN: ' VEN-IND-SCTB IN VEN.

      * DPM ini  30-JUL-1997  Si la Fecha de Vencimiento
      * es menor que FPRO y SCTB es VIG o SPACES, estaba calculando
      * Intereses Normales en vez de Intereses Moratorios.
      * Si FVEN = FPRO, debe calcular INT NORMALES por diferencia
      * y los INT y REAJ MORATORIOS valen 0
      *     IF NOT (VEN-IND-SCTB IN VEN = SPACES OR 'VIG')
           IF NOT (VEN-IND-SCTB IN VEN = SPACES OR 'VIG') OR
      * DPM INI  27-NOV-1997 Solo si FVEN > FPRO entra a CALCULA-NORMAL
      *        VEN-FEC-FVEN IN VEN < WSS-FEC-FTRA IN WSS-VARI
              VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FTRA IN WSS-VARI
      * DPM FIN   27-NOV-1997
              PERFORM PRO-NO-VIGENTE
              GO TO LEE-SIGUIENTE-OPC.
      * DPM fin  30-JUL-1997

      *    Prepara Fechas de Parametros para calculo de Tasa Periodo
      *    Muevo FDEV a fecha Dos.
           MOVE DLC-NUM-DDEV IN DLC TO INT-DUNO IN INT-VARI.
           MOVE DLC-NUM-MDEV IN DLC TO INT-MUNO IN INT-VARI.
           MOVE DLC-NUM-SDEV IN DLC TO INT-SUNO IN INT-VARI.
           MOVE DLC-NUM-ADEV IN DLC TO INT-AUNO IN INT-VARI.

      * Preparo Parametros para obtener dia siguiente a FPRO.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *     IF NOT FIO-STAT-OKS
           IF NOT FEC-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL SUMAR 1 DIA A FPRO: '
                       WSS-FEC-FTRA IN WSS-VARI ' ' FIO-STAT
                      ' ' OPC-CIC-IOPC IN OPC
              MOVE 'ERR FPRO+1'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO LEE-SIGUIENTE-OPC.

      *    Muevo FPRO+1 a fecha uno.
           MOVE FEC-ITM1 TO INT-DDOS IN INT-VARI.
           MOVE FEC-ITM2 TO INT-MDOS IN INT-VARI.
           MOVE FEC-ITM3 TO INT-SDOS IN INT-VARI.
           MOVE FEC-ITM4 TO INT-ADOS IN INT-VARI.

           MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI.
           PERFORM LEE-VEN-ANT.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE DLC-FEC-FDEV IN DLC TO WSS-VEN-FANT IN WSS-VARI
           ELSE
               MOVE VEN-FEC-FVEN IN VEN TO WSS-VEN-FANT IN WSS-VARI.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.

           MOVE 'PO' TO WSS-IND-DESDE IN WSS-VARI.
           PERFORM CALCULA-NORMAL.

      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT FIO-STAT-OKS OR
              INT-CMSG > SPACES
              DISPLAY 'ERROR CALCULA-NORMAL: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
                       ' ' INT-CMSG
      *        MOVE INT-CMSG  TO ERC-COD-MSGE IN ERC
              MOVE INT-MEN2 TO ERC-GLS-DISP IN ERC
              PERFORM GRABAR-ERROR
              GO TO LEE-SIGUIENTE-OPC.
      *DPM fin  4-NOV-1996

      *   Limpia montos que deben quedar limpios en Reg.DLC
           MOVE ZEROES TO WSS-VAL-INTO IN WSS-VARI
                          WSS-VAL-REAO IN WSS-VARI
                          WSS-VAL-INTM IN WSS-VARI
                          WSS-VAL-REAM IN WSS-VARI.
           PERFORM GRABA-REG-DLC.

       LEE-SIGUIENTE-OPC.
      *-----------------*
           MOVE FIO-GET-NXT TO FIO-CMND.
      *     MOVE FIO-KDEF-S TO FIO-KDEF.
           PERFORM COL-FIO-OPS.
           IF NOT FIO-STAT-OKS
              IF FIO-STAT = '10'
                 DISPLAY 'FIN DE ARCHIVO OPC'
                 GO TO FIN-PRO-OPC
              ELSE
                 DISPLAY 'ERROR LECTURA OPC: ' OPC-CIC-IOPC IN OPC
                         ' ' FIO-STAT
                 GO TO FIN-PRO-OPC
           ELSE
              MOVE OPS TO OPC
              GO TO LUP-PRO-OPC.

       FIN-PRO-OPC.
      *-----------*
           EXIT.

      *----------------------------------------------------------------*
      *                 O T R A S   S E C C I O N E S                  *
      *----------------------------------------------------------------*

       PRO-NO-VIGENTE SECTION.
      *----------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A PRO-NO-VIGENTE'.
       INI-PRO-NO-VIGENTE.
      *------------------*
      * Si OPC No tiene Situacion Contab. en Mora en el
      * VEN mas antiguo se procesara de otra forma
      * DPM ini  30-JUL-1997
      *     IF VEN-IND-SCTB IN VEN NOT = 'MOR'
           IF NOT (VEN-IND-SCTB IN VEN = 'MOR' OR 'VIG' OR SPACES)
      * DPM fin  30-JUL-1997
              PERFORM PRO-DEV-OTRA-SIT
              GO TO FIN-PRO-NO-VIGENTE.

           MOVE VEN-VAL-SCAP IN VEN TO WSS-SUM-VCAP IN WSS-VARI.

      * Si Nro.de Vencimientos Vigente es mayor que 1 se procesaran
      * Varios Vencimientos
           IF OPC-NUM-VCVG IN OPC > 1
              MOVE 'N' TO WSS-TIPO-DEV IN WSS-VARI
              PERFORM PRO-VARIOS-VENCI
              GO TO FIN-PRO-NO-VIGENTE.

      * Lee Ultimo Registro CAN asociado al Reg.VEN
           PERFORM LEE-CAN-ASOCIA-VEN.
           IF WSS-IND-CAN IN WSS-VARI NOT = 'S'
      *     Si no existe CAN asociada al Reg.VEN o Cod.CAN distinto
      *     de CIE, calcula mora desde Fec.Vencimiento
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
           ELSE
      *     Si existe CAN asociada al Reg.VEN y Cod.CAN es 'CIE'
      *     calculo Mora desde Fec.Cancelacion
              MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.

           MOVE 'N' TO WSS-TIPO-DEV IN WSS-VARI.

           PERFORM CALCULA-INT-REA-MORA.

      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT ( FIO-STAT-OKS AND
                    MOR-CMSG IN MOR-VARI = SPACES )
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR CALCULA-INT-REA-MORA: '
                        OPC-CIC-IOPC IN OPC ' ' FIO-STAT
      *        MOVE MOR-CMSG IN MOR-VARI TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-NO-VIGENTE.
      *DPM fin  4-NOV-1996

      *   Limpia montos que deben quedar limpios en Reg.DLC
           MOVE ZEROES TO WSS-VAL-INTO IN WSS-VARI
                          WSS-VAL-REAO IN WSS-VARI.
           PERFORM GRABA-REG-DLC.

       FIN-PRO-NO-VIGENTE.
      *------------------*
           EXIT.

       PRO-VARIOS-VENCI SECTION.
      *-------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRE A PRO-VARIOS-VENCI, TIPO-DEV='
                                                    WSS-TIPO-DEV.
       INI-PRO-VARIOS-VENCI.
      *--------------------*
           MOVE ZEROES TO WSS-SUM-IXC IN WSS-VARI
                          WSS-SUM-RXC IN WSS-VARI
                          WSS-SUM-IMO IN WSS-VARI
                          WSS-SUM-RMO IN WSS-VARI.
      * Lee Ultimo Registro CAN asociado al Reg.VEN
           PERFORM LEE-CAN-ASOCIA-VEN.
           IF WSS-IND-CAN NOT = 'S'
      *     Si no existe CAN asociada al Reg.VEN o Cod.CAN distinto
      *     de CIE, calcula mora desde Fec.Vencimiento
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
           ELSE
      *     Si existe CAN asociada al Reg.VEN y Cod.CAN es 'CIE'
      *     calculo Mora desde Fec.Cancelacion
              MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.

       LUP-PRO-VARIOS-VENCI.
      *--------------------*
           PERFORM CALCULA-INT-REA-MORA.
      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT (FIO-STAT-OKS AND
              MOR-CMSG IN MOR-VARI = SPACES)
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR CALCULA-INT-REA-MORA: '
                      OPC-CIC-IOPC IN OPC ' ' FIO-STAT
      *        MOVE MOR-CMSG IN MOR-VARI TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-VARIOS-VENCI.
      *DPM fin  4-NOV-1996

      *  Acumula valores
           IF WSS-TIPO-DEV IN WSS-VARI = 'N'
              ADD WSS-VAL-INTD IN WSS-VARI TO WSS-SUM-IXC IN WSS-VARI
              ADD WSS-VAL-READ IN WSS-VARI TO WSS-SUM-RXC IN WSS-VARI.

           ADD WSS-VAL-INTM IN WSS-VARI TO WSS-SUM-IMO IN WSS-VARI.
           ADD WSS-VAL-REAM IN WSS-VARI TO WSS-SUM-RMO IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
             DISPLAY 'INTD      : ' WSS-VAL-INTD IN WSS-VARI
             DISPLAY 'INTD(ACUM): ' WSS-SUM-IXC  IN WSS-VARI
             DISPLAY 'READ      : ' WSS-VAL-READ IN WSS-VARI
             DISPLAY 'READ(ACUM): ' WSS-SUM-RXC  IN WSS-VARI
             DISPLAY 'INTM      : ' WSS-VAL-INTM IN WSS-VARI
             DISPLAY 'INTM(ACUM): ' WSS-SUM-IMO  IN WSS-VARI
             DISPLAY 'REAM      : ' WSS-VAL-REAM IN WSS-VARI
             DISPLAY 'REAM(ACUM): ' WSS-SUM-RMO  IN WSS-VARI.

      *
      *     IF VEN-NUM-IVEN IN VEN = 1
              MOVE VEN-CIC-IOPC IN VEN TO WSS-CIC-VEN IN WSS-VARI.

      *DPM ini  9-SEP-1997 Se guarda registro del ultimo VEN correcto
              MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI.
      *DPM fin  9-SEP-1997

      *DPM ini  3-SEP-1997
       LUP-PRO-VARIOS-VENCI-2.
      *DPM fin  3-SEP-1997
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.

      *DPM ini  3-SEP-1997 Si FVEN < FPRO y Saldo VEN = 0, no procesar
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE VEN-FEC-FIMV IN VEN TO VEN-FEC-FVEN IN VEN.

           IF FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = WSS-CIC-VEN IN WSS-VARI AND
              VEN-FEC-FVEN IN VEN < WSS-FEC-FTRA IN WSS-VARI AND
              VEN-VAL-SFIN IN VEN NOT > ZEROES AND
      * DPM ini  24-NOV-1997
              WSS-OPEC IN WSS-VARI NOT = 'B'
      * DPM fin  24-NOV-1997
               GO TO LUP-PRO-VARIOS-VENCI-2.
      *DPM fin  3-SEP-1997

           IF NOT (FIO-STAT-OKS AND VEN-CIC-IOPC IN VEN = WSS-CIC-VEN
                                                          IN WSS-VARI)
      *       Se acabaron vencimientos para OPC
      * DPM ini  27-NOV-1997
              MOVE 'S' TO WSS-IND-ULTI IN WSS-VARI
      * DPM fin  27-NOV-1997
      *DPM ini  6-NOV-1996
      *   Muevo Acumuladores a ser grabados
              MOVE WSS-SUM-IXC IN WSS-VARI TO WSS-VAL-INTD IN WSS-VARI
              MOVE WSS-SUM-RXC IN WSS-VARI TO WSS-VAL-READ IN WSS-VARI
              MOVE WSS-SUM-IMO IN WSS-VARI TO WSS-VAL-INTM IN WSS-VARI
              MOVE WSS-SUM-RMO IN WSS-VARI TO WSS-VAL-REAM IN WSS-VARI

      *   Limpia montos que deben quedar limpios en Reg.DLC

              MOVE ZEROES TO WSS-VAL-INTO IN WSS-VARI
                             WSS-VAL-REAO IN WSS-VARI
      *DPM ini  9-SEP-1997 Se restaura ultimo VEN correcto para grabar D
              MOVE WSS-CIC-VEN IN WSS-VARI TO VEN-CIC-IOPC IN VEN
              MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-VEN
              IF NOT FIO-STAT-OKS
                  ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                  DISPLAY 'ERROR PRO-VARIOS-VENCI: '
                          OPC-CIC-IOPC IN OPC ' ' FIO-STAT
                  MOVE 'OPC  NOVEN' TO ERC-COD-MSGE IN ERC
                  PERFORM GRABAR-ERROR
                  GO TO FIN-PRO-VARIOS-VENCI
              ELSE
      * DPM fin  9-SEP-1997
      * DPM ini  25-NOV-1997
              IF OPC-VAL-SCRE IN OPC NOT > WSS-SUM-VCAP IN WSS-VARI
                  MOVE 'N' TO WSS-IND-ULTI IN WSS-VARI
                              WSS-IND-SALE IN WSS-VARI
      * DPM fin  25-NOV-1997
                  PERFORM GRABA-REG-DLC
      * DPM fin  6-NOV-1996
                  GO TO FIN-PRO-VARIOS-VENCI
              ELSE
                  MOVE 'S' TO WSS-IND-SALE IN WSS-VARI.

      * DPM ini  27-NOV-1997
           IF NOT (WSS-FEC-FTRA IN WSS-VARI > VEN-FEC-FVEN IN VEN) OR
              WSS-IND-SALE IN WSS-VARI = 'S'
      * DPM ini  27-NOV-1997
               PERFORM PRO-VEN-FUERA-RANGO
      * DPM ini  16-DEC-1997
               IF WSS-IND-ULTI IN WSS-VARI = 'S'
      * DPM fin  16-DEC-1997
                   MOVE 'N' TO WSS-IND-ULTI IN WSS-VARI
                               WSS-IND-SALE IN WSS-VARI
                   GO TO FIN-PRO-VARIOS-VENCI.

      *    Acumula Saldo Cuota de Ven.
           IF WSS-TIPO-DEV IN WSS-VARI = 'N'
              ADD VEN-VAL-SCAP IN VEN TO WSS-SUM-VCAP IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'SALDO EN VEN-' VEN-NUM-IVEN IN VEN ' = '
                                       VEN-VAL-SCAP IN VEN
               DISPLAY 'ACUMULADO : ' WSS-SUM-VCAP IN WSS-VARI.

           IF WSS-TIPO-DEV IN WSS-VARI = 'M'
              IF VEN-IND-SCTB IN VEN NOT = WSS-IND-SCTB IN WSS-VARI
                 GO TO FIN-PRO-VARIOS-VENCI.

           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI.

           IF WSS-FEC-FTRA IN WSS-VARI = VEN-FEC-FVEN IN VEN
               MOVE 'S' TO WSS-IND-ULTI IN WSS-VARI
               GO TO LUP-PRO-VARIOS-VENCI-2
           ELSE
           IF WSS-FEC-FTRA IN WSS-VARI < VEN-FEC-FVEN IN VEN
               MOVE 'N' TO WSS-IND-ULTI IN WSS-VARI
                           WSS-IND-SALE IN WSS-VARI
               GO TO FIN-PRO-VARIOS-VENCI
           ELSE
               GO TO LUP-PRO-VARIOS-VENCI.
       FIN-PRO-VARIOS-VENCI.
      *--------------------*
           EXIT.

       PRO-VEN-FUERA-RANGO SECTION.
      *---------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A PRO-VEN-FUERA-RANGO'.
      *    Calculo de Saldo Insoluto a la Fecha de Proceso.
           SUBTRACT WSS-SUM-VCAP IN WSS-VARI FROM OPC-VAL-SCRE IN OPC
                                      GIVING WSS-VAL-CAPI IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'K - Acumulado: ' WSS-VAL-CAPI IN WSS-VARI.
      *    Prepara Fechas de Parametros para calculo de Tasa Periodo
      *    Obtengo Vencimiento anterior a fecha de Proceso.

      * DPM INI
           IF WSS-IND-SALE IN WSS-VARI = 'N'
               MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI
               PERFORM LEE-VEN-ANT-FPRO
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                   MOVE DLC-FEC-FDEV IN DLC TO WSS-VEN-FANT IN WSS-VARI
               ELSE
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-VEN-FANT IN WSS-VARI.

           IF WSS-IND-SALE IN WSS-VARI = 'N'
               MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
               MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-VEN.
      * DPM FIN
      * DPM ini  9-OCT-1997 Se mueve Fecha Inicio Mora(FIMV) a FVEN
      * para que calcule los intereses a fecha de mora en credito
      * con vencimientos en dia no habil. Si VEN cae en dia habil,
      * FIMV = FVEN
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE VEN-FEC-FIMV IN VEN TO VEN-FEC-FVEN IN VEN.
      * DPM fin  9-OCT-1997

      *DPM ini  3-SEP-1997 Si FVEN < FPRO y Saldo VEN = 0, no procesar
           IF VEN-FEC-FVEN IN VEN < WSS-FEC-FTRA IN WSS-VARI AND
              VEN-VAL-SFIN IN VEN NOT > ZEROES AND
      * DPM ini  24-NOV-1997
              WSS-OPEC IN WSS-VARI NOT = 'B'
      * DPM fin  24-NOV-1997
               ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
               DISPLAY 'SALDO VCTO = 0: ' VEN-KEY-IREG IN VEN
               MOVE 'FSDM>0 VIG'  TO ERC-COD-MSGE IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-PRO-VEN-FUERA-RANGO.
      *DPM fin  3-SEP-1997

      * DPM ini  17-OCT-1997 Se cambio FVEN actual por FVEN anterior
      * porque no se estaban grabando los INT del ultimo VEN, ya que
      * FUNO era > FDOS para rutina.
      *    Muevo FVEN a fecha Uno.
      *     MOVE VEN-NUM-DVEN IN VEN TO INT-DUNO IN INT-VARI.
      *     MOVE VEN-NUM-MVEN IN VEN TO INT-MUNO IN INT-VARI.
      *     MOVE VEN-NUM-SVEN IN VEN TO INT-SUNO IN INT-VARI.
      *     MOVE VEN-NUM-AVEN IN VEN TO INT-AUNO IN INT-VARI.

      * DPM ini  27-NOV-1997
           IF WSS-IND-SALE IN WSS-VARI = 'S'
               MOVE VEN-NUM-DVEN IN VEN TO WSS-VEN-DANT IN WSS-VARI
                                           INT-DUNO IN INT-VARI
               MOVE VEN-NUM-MVEN IN VEN TO WSS-VEN-MANT IN WSS-VARI
                                           INT-MUNO IN INT-VARI
               MOVE VEN-NUM-SVEN IN VEN TO WSS-VEN-SANT IN WSS-VARI
                                           INT-SUNO IN INT-VARI
               MOVE VEN-NUM-AVEN IN VEN TO WSS-VEN-AANT IN WSS-VARI
                                           INT-AUNO IN INT-VARI
           ELSE
      * DPM fin  27-NOV-1997
               MOVE WSS-VEN-DANT IN WSS-VARI TO INT-DUNO IN INT-VARI
               MOVE WSS-VEN-MANT IN WSS-VARI TO INT-MUNO IN INT-VARI
               MOVE WSS-VEN-SANT IN WSS-VARI TO INT-SUNO IN INT-VARI
               MOVE WSS-VEN-AANT IN WSS-VARI TO INT-AUNO IN INT-VARI.
      * DPM fin  17-OCT-1997

      * Preparo Parametros para obtener dia siguiente a FPRO.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *     IF NOT FIO-STAT-OKS
           IF NOT FEC-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL SUMAR 1 DIA A FPRO: '
                                    WSS-FEC-FTRA IN WSS-VARI
                      ' ' OPC-CIC-IOPC IN OPC
              MOVE 'ERR FPRO+1'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-VEN-FUERA-RANGO.

      *    Muevo FPRO+1 a fecha uno.
           MOVE FEC-ITM1 TO INT-DDOS IN INT-VARI.
           MOVE FEC-ITM2 TO INT-MDOS IN INT-VARI.
           MOVE FEC-ITM3 TO INT-SDOS IN INT-VARI.
           MOVE FEC-ITM4 TO INT-ADOS IN INT-VARI.

           MOVE 'FR' TO WSS-IND-DESDE IN WSS-VARI.
           PERFORM CALCULA-NORMAL.
      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT FIO-STAT-OKS OR
              INT-CMSG > SPACES
              DISPLAY 'ERROR CALCULA-NORMAL: ' OPC-CIC-IOPC IN OPC
                                           ' ' FIO-STAT
      *        MOVE INT-CMSG TO ERC-COD-MSGE IN ERC
              MOVE INT-MEN2 TO ERC-GLS-DISP IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-VEN-FUERA-RANGO.
      *DPM fin  4-NOV-1996

           ADD WSS-VAL-INTD IN WSS-VARI TO WSS-SUM-IXC IN WSS-VARI.
           ADD WSS-VAL-READ IN WSS-VARI TO WSS-SUM-RXC IN WSS-VARI.

      *   Muevo Acumuladores a ser grabados
           MOVE WSS-SUM-IXC IN WSS-VARI TO WSS-VAL-INTD IN WSS-VARI.
           MOVE WSS-SUM-RXC IN WSS-VARI TO WSS-VAL-READ IN WSS-VARI.
           MOVE WSS-SUM-IMO IN WSS-VARI TO WSS-VAL-INTM IN WSS-VARI.
           MOVE WSS-SUM-RMO IN WSS-VARI TO WSS-VAL-REAM IN WSS-VARI.

      *   Limpia montos que deben quedar limpios en Reg.DLC

           MOVE ZEROES TO WSS-VAL-INTO IN WSS-VARI
                          WSS-VAL-REAO IN WSS-VARI.

      * DPM ini  12-JAN-1998 No estaba grabando DVG cuando existia
      * ultimo VEN fisico con FVEN > FPRO
      * DPM ini  22-DEC-1997 Se asegura que grabe DLC y DVG solo una vez
      * si es que tiene saldo insoluto
      *     IF WSS-IND-ULTI IN WSS-VARI = 'S'
      * DPM fin  22-DEC-1997
           IF WSS-IND-ULTI IN WSS-VARI = 'S' OR
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
      *JUS-AUX         MOVE 'S' TO WSS-IND-ULTI IN WSS-VARI
      * DPM fin  12-JAN-1998
               PERFORM GRABA-REG-DLC.

       FIN-PRO-VEN-FUERA-RANGO.
      *-----------------------*
           EXIT.


       PRO-SUSP-DEVENGO SECTION.
      *------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A PRO-SUSP-DEVENGO'.
       INI-PRO-SUSP-DEVENGO.
      *--------------------*
           MOVE 'N' TO WSS-TIPO-DEV IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'SUSP.MORA: ' DLC-FEC-FSDM IN DLC
               DISPLAY 'SUSP.RIES: ' DLC-FEC-FSDE IN DLC.

      * M=3 R=2 => SUS=R
           IF DLC-FEC-FSDM IN DLC > DLC-FEC-FSDE IN DLC AND
               DLC-FEC-FSDE IN DLC > ZEROES
              MOVE DLC-FEC-FSDE IN DLC TO WSS-FEC-FSUS IN WSS-VARI
              IF WSS-IND-DISP IN WSS-VARI = 'S'
                 DISPLAY 'FSUS M=3,R=2: ' WSS-FEC-FSUS IN WSS-VARI
                 GO TO SIGUE-PRO-SUSP-DEVENGO
              ELSE
                 GO TO SIGUE-PRO-SUSP-DEVENGO.

      * M=1 R=0 => SUS=M
           IF DLC-FEC-FSDM IN DLC > DLC-FEC-FSDE IN DLC AND
              DLC-FEC-FSDE IN DLC NOT > ZEROES OR SPACES
              MOVE DLC-FEC-FSDM IN DLC TO WSS-FEC-FSUS IN WSS-VARI
              IF WSS-IND-DISP IN WSS-VARI = 'S'
                  DISPLAY 'FSUS M=1,R=0: ' WSS-FEC-FSUS IN WSS-VARI
                  PERFORM PRO-SUSP-DEVENGO-6
                  GO TO FIN-PRO-SUSP-DEVENGO
              ELSE
                  PERFORM PRO-SUSP-DEVENGO-6
                  GO TO FIN-PRO-SUSP-DEVENGO.


      * M=0 R=2 => SUS=R
           IF DLC-FEC-FSDE IN DLC > DLC-FEC-FSDM IN DLC AND
              DLC-FEC-FSDM IN DLC NOT > ZEROES OR SPACES
              MOVE DLC-FEC-FSDE IN DLC TO WSS-FEC-FSUS IN WSS-VARI
              IF WSS-IND-DISP IN WSS-VARI = 'S'
                  DISPLAY 'FSUS M=0,R=2: ' WSS-FEC-FSUS IN WSS-VARI
                  GO TO SIGUE-PRO-SUSP-DEVENGO
              ELSE
                  GO TO SIGUE-PRO-SUSP-DEVENGO.


      * M=2 R=3 => SUS=M
           IF DLC-FEC-FSDE IN DLC > DLC-FEC-FSDM IN DLC AND
              DLC-FEC-FSDM IN DLC > ZEROES
              MOVE DLC-FEC-FSDM IN DLC TO WSS-FEC-FSUS IN WSS-VARI
              IF WSS-IND-DISP IN WSS-VARI = 'S'
                  DISPLAY 'FSUS M=2,R=3: ' WSS-FEC-FSUS IN WSS-VARI
                  PERFORM PRO-SUSP-DEVENGO-6
                  GO TO FIN-PRO-SUSP-DEVENGO
              ELSE
                  PERFORM PRO-SUSP-DEVENGO-6
                  GO TO FIN-PRO-SUSP-DEVENGO.

       SIGUE-PRO-SUSP-DEVENGO.
      *----------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'FEC.FSUS: ' WSS-FEC-FSUS IN WSS-VARI.
      *DPM ini  9-DEC-1996 Si es prorroga se usa FCOL de OPC original
      *     IF OPC-FEC-FCOL IN OPC > WSS-FEC-FSUS IN WSS-VARI
      *        MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FSUS IN WSS-VARI
      *        DISPLAY 'FEC.FSUS(FCOL): ' WSS-FEC-FSUS IN WSS-VARI
           IF WSS-FEC-FCOL IN WSS-VARI > WSS-FEC-FSUS IN WSS-VARI
              MOVE WSS-FEC-FCOL IN WSS-VARI TO WSS-FEC-FSUS IN WSS-VARI
              IF WSS-IND-DISP IN WSS-VARI = 'S'
                  DISPLAY 'FEC.FSUS(FCOL): ' WSS-FEC-FSUS IN WSS-VARI
              ELSE
                  NEXT SENTENCE
      *DPM fin  9-DEC-1996
           ELSE
              MOVE WSS-FEC-FSUS IN WSS-VARI TO WSS-FEC-FCAL IN WSS-VARI
              IF WSS-IND-DISP IN WSS-VARI = 'S'
                  DISPLAY 'FEC.FSUS(FCAL): ' WSS-FEC-FSUS IN WSS-VARI
                  PERFORM PRO-SUSP-DEVENGO-7
                  GO TO FIN-PRO-SUSP-DEVENGO
              ELSE
                  PERFORM PRO-SUSP-DEVENGO-7
                  GO TO FIN-PRO-SUSP-DEVENGO.

           PERFORM LEE-VEN-MAS-ANTIGUO.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL LEER VEN, KEY:' OPC-CIC-IOPC IN OPC
                      ' ' FIO-STAT
              MOVE 'OPC  NOVEN'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO.

           MOVE VEN-IND-SCTB IN VEN TO WSS-IND-SCTB IN WSS-VARI.

           IF NOT (WSS-IND-SCTB IN WSS-VARI = 'VIG' OR SPACES)
              PERFORM PRO-SUSP-DEVENGO-8
              GO TO FIN-PRO-SUSP-DEVENGO.

      *    Prepara Fechas de Parametros para calculo de Tasa Periodo
      *    Muevo FSUS a fecha Uno.
           MOVE WSS-NUM-DSUS IN WSS-VARI TO INT-DUNO IN INT-VARI.
           MOVE WSS-NUM-MSUS IN WSS-VARI TO INT-MUNO IN INT-VARI.
           MOVE WSS-NUM-SSUS IN WSS-VARI TO INT-SUNO IN INT-VARI.
           MOVE WSS-NUM-ASUS IN WSS-VARI TO INT-AUNO IN INT-VARI.

      * Preparo Parametros para obtener dia siguiente a FPRO.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *     IF NOT FIO-STAT-OKS
           IF NOT FEC-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL SUMAR 1 DIA A FPRO: '
                       WSS-FEC-FTRA IN WSS-VARI ' ' FIO-STAT
                      ' ' OPC-CIC-IOPC IN OPC
              MOVE 'ERR FPRO+1'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO.

           MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI.
           PERFORM LEE-VEN-ANT.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE DLC-FEC-FDEV IN DLC TO WSS-VEN-FANT IN WSS-VARI
           ELSE
               MOVE VEN-FEC-FVEN IN VEN TO WSS-VEN-FANT IN WSS-VARI.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.

      *    Muevo FPRO+1 a fecha uno.
           MOVE FEC-ITM1 TO INT-DDOS IN INT-VARI.
           MOVE FEC-ITM2 TO INT-MDOS IN INT-VARI.
           MOVE FEC-ITM3 TO INT-SDOS IN INT-VARI.
           MOVE FEC-ITM4 TO INT-ADOS IN INT-VARI.

           MOVE 'SD' TO WSS-IND-DESDE IN WSS-VARI.
           PERFORM CALCULA-NORMAL.
           IF NOT FIO-STAT-OKS OR
              INT-CMSG > SPACES
              DISPLAY 'ERROR CALCULA-NORMAL ' OPC-CIC-IOPC IN OPC
                      ' ' FIO-STAT
      *        MOVE INT-CMSG TO ERC-COD-MSGE IN ERC
              MOVE INT-MEN2 TO ERC-GLS-DISP IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO.

      *   Limpia montos que deben quedar limpios en Reg.DLC
           MOVE ZEROES TO WSS-VAL-INTD IN WSS-VARI
                          WSS-VAL-READ IN WSS-VARI
                          WSS-VAL-INTM IN WSS-VARI
                          WSS-VAL-REAM IN WSS-VARI.

           PERFORM GRABA-REG-DLC.

       FIN-PRO-SUSP-DEVENGO.
      *--------------------*
           EXIT.

       PRO-SUSP-DEVENGO-7 SECTION.
      *--------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A PRO-SUSP-DEVENGO-7'.
       INI-PRO-SUSP-DEVENGO-7.
      *----------------------*
           PERFORM LEE-VEN-MAS-ANTIGUO.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR EN VEN + ANT.(7) KEY: '
                       OPC-CIC-IOPC IN OPC ' '  FIO-STAT
              MOVE 'OPC  NOVEN'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-7.

           MOVE ZEROES TO WSS-VAL-UF1 IN WSS-VARI
                          WSS-VAL-UF2 IN WSS-VARI
                          WSS-DIF-UFS IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'SIT.CTB IN VEN: ' VEN-IND-SCTB IN VEN.
           MOVE VEN-IND-SCTB IN VEN TO WSS-IND-SCTB IN WSS-VARI.
           IF NOT (VEN-IND-SCTB IN VEN = 'VIG' OR SPACES)
              PERFORM PRO-SUSP-DEVENGO-11
              GO TO FIN-PRO-SUSP-DEVENGO-7.

      *    Prepara Fechas de Parametros para calculo de Tasa Periodo
      *    Muevo FSUS a fecha Uno.
           MOVE WSS-NUM-DCAL IN WSS-VARI TO INT-DUNO IN INT-VARI.
           MOVE WSS-NUM-MCAL IN WSS-VARI TO INT-MUNO IN INT-VARI.
           MOVE WSS-NUM-SCAL IN WSS-VARI TO INT-SUNO IN INT-VARI.
           MOVE WSS-NUM-ACAL IN WSS-VARI TO INT-AUNO IN INT-VARI.

      * Preparo Parametros para obtener dia siguiente a FPRO.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *     IF NOT FIO-STAT-OKS
           IF NOT FEC-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL SUMAR 1 DIA A FPRO: '
                       WSS-FEC-FTRA IN WSS-VARI ' ' FIO-STAT
                      ' ' OPC-CIC-IOPC IN OPC
              MOVE 'ERR FPRO+1'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-7.

      *    Muevo FPRO+1 a fecha uno.
           MOVE FEC-ITM1 TO INT-DDOS IN INT-VARI.
           MOVE FEC-ITM2 TO INT-MDOS IN INT-VARI.
           MOVE FEC-ITM3 TO INT-SDOS IN INT-VARI.
           MOVE FEC-ITM4 TO INT-ADOS IN INT-VARI.

           PERFORM CALCULA-7.
      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT FIO-STAT-OKS OR
              INT-CMSG > SPACES
               DISPLAY 'ERROR CALCULA-7: ' OPC-CIC-IOPC IN OPC
                       ' ' FIO-STAT
      *         MOVE 'CALCULA-7'  TO ERC-COD-MSGE IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-PRO-SUSP-DEVENGO-7.
      *DPM fin  4-NOV-1996

      *   Limpia montos que deben quedar limpios en Reg.DLC
           MOVE ZEROES TO WSS-VAL-INTM IN WSS-VARI
                          WSS-VAL-REAM IN WSS-VARI.

           PERFORM GRABA-REG-DLC.

       FIN-PRO-SUSP-DEVENGO-7.
      *----------------------*
           EXIT.

       PRO-SUSP-DEVENGO-8 SECTION.
      *--------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A PRO-SUSP-DEVENGO-8'.
       INI-PRO-SUSP-DEVENGO-8.
      *----------------------*
           IF WSS-IND-SCTB IN WSS-VARI NOT = 'MOR'
              PERFORM PRO-DEV-OTRA-SIT
              GO TO FIN-PRO-SUSP-DEVENGO-8.

           MOVE VEN-VAL-SCAP IN VEN TO WSS-SUM-VCAP IN WSS-VARI.

      * Si Nro.de Vencimientos Vigente es mayor que 1 se procesaran
      * Varios Vencimientos
           IF OPC-NUM-VCVG IN OPC > 1
              MOVE 'S' TO WSS-TIPO-DEV IN WSS-VARI
              PERFORM PRO-SUSP-DEVENGO-9
              GO TO FIN-PRO-SUSP-DEVENGO-8.

      * Lee Ultimo Registro CAN asociado al Reg.VEN
           PERFORM LEE-CAN-ASOCIA-VEN.
           IF WSS-IND-CAN IN WSS-VARI NOT = 'S'
      *     Si no existe CAN asociada al Reg.VEN o Cod.CAN distinto
      *     de CIE, calcula mora desde Fec.Vencimiento
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
           ELSE
      *     Si existe CAN asociada al Reg.VEN y Cod.CAN es 'CIE'
      *     calculo Mora desde Fec.Cancelacion
              MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.

           PERFORM CALCULA-8.
      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR EN RUTINA CALCULA-8 '
                     OPC-CIC-IOPC IN OPC ' ' FIO-STAT
      *        MOVE 'CALCULA-8' TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-8.
      *DPM fin  4-NOV-1996

      *   Limpia montos que deben quedar limpios en Reg.DLC
           MOVE ZEROES TO WSS-VAL-INTD IN WSS-VARI
                          WSS-VAL-READ IN WSS-VARI.
           PERFORM GRABA-REG-DLC.

       FIN-PRO-SUSP-DEVENGO-8.
      *----------------------*
           EXIT.

       PRO-SUSP-DEVENGO-9 SECTION.
      *--------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A PRO-SUSP-DEVENGO-9'.
       INI-PRO-SUSP-DEVENGO-9.
      *----------------------*
           MOVE 'N' TO WSS-TIPO-DEV IN WSS-VARI.
           MOVE ZEROES TO WSS-SUM-ISU IN WSS-VARI
                          WSS-SUM-RSU IN WSS-VARI
                          WSS-SUM-IMO IN WSS-VARI
                          WSS-SUM-RMO IN WSS-VARI.
      * Lee Ultimo Registro CAN asociado al Reg.VEN
           PERFORM LEE-CAN-ASOCIA-VEN.
           IF WSS-IND-CAN NOT = 'S'
      *     Si no existe CAN asociada al Reg.VEN o Cod.CAN distinto
      *     de CIE, calcula mora desde Fec.Vencimiento
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
           ELSE
      *     Si existe CAN asociada al Reg.VEN y Cod.CAN es 'CIE'
      *     calculo Mora desde Fec.Cancelacion
              MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.

       LUP-PRO-SUSP-DEVENGO-9.
      *----------------------*
           PERFORM CALCULA-8.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR EN RUTINA CALCULA-8 '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
      *        MOVE 'CALCULA-8' TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-9.

      *  Acumula valores
           ADD WSS-VAL-INTO IN WSS-VARI TO WSS-SUM-ISU IN WSS-VARI.
           ADD WSS-VAL-REAO IN WSS-VARI TO WSS-SUM-RSU IN WSS-VARI.

           ADD WSS-VAL-INTM IN WSS-VARI TO WSS-SUM-IMO IN WSS-VARI.
           ADD WSS-VAL-REAM IN WSS-VARI TO WSS-SUM-RMO IN WSS-VARI.

      *DPM ini  16-DEC-1996
      *     IF VEN-NUM-IVEN IN VEN = 1
              MOVE VEN-CIC-IOPC IN VEN TO WSS-CIC-VEN IN WSS-VARI.
      *        MOVE FIO-GET-GRT TO FIO-CMND
      *     ELSE
      *DPM fin  16-DEC-1996
      *DPM ini  9-SEP-1997
              MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI.
      *DPM fin  9-SEP-1997

      *DPM ini  3-SEP-1997
       LUP-PRO-SUSP-DEVENGO-9-2.
      *DPM fin  3-SEP-1997
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.

      *DPM ini  3-SEP-1997 Si FVEN < FPRO y Saldo VEN = 0, no procesar
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE VEN-FEC-FIMV IN VEN TO VEN-FEC-FVEN IN VEN.

           IF FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = WSS-CIC-VEN IN WSS-VARI AND
              VEN-FEC-FVEN IN VEN < WSS-FEC-FTRA IN WSS-VARI AND
              VEN-VAL-SFIN IN VEN NOT > ZEROES AND
      * DPM ini  24-NOV-1997
              WSS-OPEC IN WSS-VARI NOT = 'B'
      * DPM fin  24-NOV-1997
               GO TO LUP-PRO-SUSP-DEVENGO-9-2.
      *DPM fin  3-SEP-1997

           IF NOT (FIO-STAT-OKS AND VEN-CIC-IOPC IN VEN = WSS-CIC-VEN
                                                          IN WSS-VARI)
      *       Se acabaron vencimientos para OPC
      * DPM ini  27-NOV-1997
              MOVE 'S' TO WSS-IND-ULTI IN WSS-VARI
      * DPM fin  27-NOV-1997
      *DPM ini  6-NOV-1996
      *   Muevo Acumuladores a ser grabados
      *        MOVE WSS-SUM-IXC IN WSS-VARI TO WSS-VAL-INTD IN WSS-VARI
      *        MOVE WSS-SUM-RXC IN WSS-VARI TO WSS-VAL-READ IN WSS-VARI
              MOVE WSS-SUM-IMO IN WSS-VARI TO WSS-VAL-INTM IN WSS-VARI
              MOVE WSS-SUM-RMO IN WSS-VARI TO WSS-VAL-REAM IN WSS-VARI
              MOVE WSS-SUM-ISU IN WSS-VARI TO WSS-VAL-INTO IN WSS-VARI
              MOVE WSS-SUM-RSU IN WSS-VARI TO WSS-VAL-REAO IN WSS-VARI

      *   Limpia montos que deben quedar limpios en Reg.DLC
              MOVE ZEROES                  TO WSS-VAL-INTD IN WSS-VARI
                                              WSS-VAL-READ IN WSS-VARI

      *DPM ini  9-SEP-1997 Se restaura ultimo VEN correcto para grabar D
              MOVE WSS-CIC-VEN IN WSS-VARI TO VEN-CIC-IOPC IN VEN
              MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-VEN
              IF NOT FIO-STAT-OKS
                  ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                  DISPLAY 'ERROR PRO-SUSP-DEVENGO-9: '
                          OPC-CIC-IOPC IN OPC ' ' FIO-STAT
                  MOVE 'OPC  NOVEN' TO ERC-COD-MSGE IN ERC
                  PERFORM GRABAR-ERROR
                  GO TO FIN-PRO-SUSP-DEVENGO-9
              ELSE
      *DPM fin  9-SEP-1997
      * DPM ini  25-NOV-1997
              IF OPC-VAL-SCRE IN OPC NOT > WSS-SUM-VCAP IN WSS-VARI
                  MOVE 'N' TO WSS-IND-ULTI IN WSS-VARI
      * DPM fin  25-NOV-1997
                  PERFORM GRABA-REG-DLC
      *DPM fin  6-NOV-1996
                  GO TO FIN-PRO-SUSP-DEVENGO-9.

      * DPM ini  27-NOV-1997
      *     IF NOT (WSS-FEC-FTRA IN WSS-VARI > VEN-FEC-FVEN IN VEN)
           IF NOT (WSS-FEC-FTRA IN WSS-VARI > VEN-FEC-FVEN IN VEN) OR
              WSS-IND-ULTI IN WSS-VARI = 'S'
      * DPM ini  27-NOV-1997
               PERFORM PRO-SUSP-DEVENGO-10
               MOVE 'N' TO WSS-IND-ULTI IN WSS-VARI
               GO TO FIN-PRO-SUSP-DEVENGO-9.

      *    Acumula Saldo Cuota de Ven.
           IF WSS-TIPO-DEV IN WSS-VARI = 'N'
              ADD VEN-VAL-SCAP IN VEN TO WSS-SUM-VCAP IN WSS-VARI.

      *INI JUS
      *     IF CAN-MSC-CANC NOT = 'CIE'
      *     Si Cod.CAN distinto de CIE, calcula mora desde Fec.Venc.
      *        MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
      *     ELSE
      *     Si Cod.CAN es 'CIE' calculo Mora desde Fec.Cancelacion
      *        MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.
      *ADD
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI.
      *ADD
      *FIN JUS
           GO TO LUP-PRO-SUSP-DEVENGO-9.

       FIN-PRO-SUSP-DEVENGO-9.
      *----------------------*
           EXIT.

       CALCULA-NORMAL SECTION.
      *----------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A CALCULA-NORMAL'.
       INI-CALCULA-NORMAL.
      *------------------*
           MOVE ZEROES TO INT-TIPE.
      *    Muevo Valor de Cambio
      *     MOVE WSS-COD-MONEDA IN WSS-VARI TO INT-VCAM IN INT-VARI.
           MOVE OPC-COD-VCOC IN OPC TO INT-VCAM IN INT-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'MONEDA DE OPERACION: ' INT-VCAM IN INT-VARI.

      *    Muevo Fecha Colocacion
      *DPM ini  10-DEC-1996
      *     MOVE OPC-NUM-DCOL IN OPC TO INT-DCOL.
      *     MOVE OPC-NUM-MCOL IN OPC TO INT-MCOL.
      *     MOVE OPC-NUM-SCOL IN OPC TO INT-SCOL.
      *     MOVE OPC-NUM-ACOL IN OPC TO INT-ACOL.
           MOVE WSS-NUM-DCOL IN WSS-VARI TO INT-DCOL.
           MOVE WSS-NUM-MCOL IN WSS-VARI TO INT-MCOL.
           MOVE WSS-NUM-SCOL IN WSS-VARI TO INT-SCOL.
           MOVE WSS-NUM-ACOL IN WSS-VARI TO INT-ACOL.

      *DPM fin  10-DEC-1996

      *    Muevo Identificacion de la Operacion
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC IN INT-VARI.
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC IN INT-VARI.
      *     DISPLAY 'OPC-CIC-IOPC: ' INT-IOPC IN INT-VARI.
      *     DISPLAY 'VEN-NUM-IDLC: ' INT-IDLC IN INT-VARI.
      *
           MOVE ZEROES TO INT-SEVE IN INT-VARI.
           MOVE SPACES TO INT-TCVF IN INT-VARI
                          INT-CMSG IN INT-VARI.
      *
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'INT-VCAM: ' INT-VCAM
               DISPLAY 'INT-FCOL: ' INT-FCOL
               DISPLAY 'INT-IOPC: ' INT-IOPC
               DISPLAY 'INT-IDLC: ' INT-IDLC
               DISPLAY 'INT-FUNO : ' INT-FUNO
               DISPLAY 'INT-FDOS : ' INT-FDOS.

      *DPM ini  1-SEP-1997 Si INT-FEC1 > INT-FEC2, Tasa = 0
           MOVE INT-DUNO TO WSS-NUM-D1.
           MOVE INT-MUNO TO WSS-NUM-M1.
           MOVE INT-SUNO TO WSS-NUM-S1.
           MOVE INT-AUNO TO WSS-NUM-A1.

           MOVE INT-DDOS TO WSS-NUM-D2.
           MOVE INT-MDOS TO WSS-NUM-M2.
           MOVE INT-SDOS TO WSS-NUM-S2.
           MOVE INT-ADOS TO WSS-NUM-A2.

           PERFORM LEE-ICG.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               DISPLAY 'ERROR LECTURA ICG PARA LLAVE '
                                             OPC-CIC-IOPC IN OPC
      * DPM ini  12-NOV-1997
               MOVE 'OPC  NOICG' TO ERC-COD-MSGE IN ERC
      * DPM fin  12-NOV-1997
               GO TO FIN-CALCULA-NORMAL.

      * DPM ini  12-DEC-1997 Determina si es balance o prebalance para
      * utilizar las fechas correspondientes en busqueda de tasa
           PERFORM DET-SI-BALANCE.
      * DPM fin  12-DEC-1997

           MOVE 'N' TO WSS-PVEZ IN WSS-VARI.

      * DPM ini  3-OCT-1997 Para creditos no Estructurados y con
      * el vencimiento mayor a fecha de proceso, los INT se calculan
      * por prorrateo y no por rutina de calculo
           IF OPC-IND-VSTR IN OPC NOT = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
               MOVE ZEROES TO WSS-FEC-F1 IN WSS-VARI
                              WSS-FEC-F2 IN WSS-VARI.
      *DPM FIN

           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FTRA IN WSS-VARI OR
              WSS-FEC-F1 IN WSS-VARI > WSS-FEC-F2 IN WSS-VARI
               MOVE ZEROES TO INT-TIPE IN INT-VARI
      * DPM ini  17-OCT-1997
                              WSS-VAL-INT IN WSS-VARI
                              WSS-VAL-INTE IN WSS-VARI
      * DPM fin  17-OCT-1997
           ELSE
      * DPM fin  1-SEP-1997
      * DPM ini  14-OCT-1997 Si FVEN = FPRO, INT se calculan por
      * diferencia y los INT y REAJ MORATORIOS valen 0
           IF VEN-FEC-FVEN IN VEN = WSS-FEC-FTRA IN WSS-VARI AND
              WSS-IND-ULTI IN WSS-VARI NOT = 'S'
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
      * DPM ini  18-FEB-1998 Si SFIN > SCAP calcula INT por diferencia,
      * en caso contrario, INT = 0
               IF VEN-VAL-SFIN IN VEN > VEN-VAL-SCAP IN VEN
                   SUBTRACT VEN-VAL-SCAP IN VEN FROM
                            VEN-VAL-SFIN IN VEN GIVING
                            WSS-VAL-INTE IN WSS-VARI
               ELSE
                   MOVE ZEROES TO WSS-VAL-INTE IN WSS-VARI
      * DPM fin  18-FEB-1998
           ELSE
      * DPM fin  14-OCT-1997
      * DPM ini  3-OCT-1997 Para creditos no Estructurados y con
      * el vencimiento mayor a fecha de proceso, los INT se calculan
      * por prorrateo y no por rutina de calculo
           IF OPC-IND-VSTR IN OPC NOT = 'S' AND
      * DPM ini  19-FEB-1998
      *        VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI AND
              (ICG-COD-CVTI IN ICG NOT > SPACES OR
              VEN-IND-CALC IN VEN NOT = 'N')
      * DPM fin  19-FEB-1998
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
               SUBTRACT VEN-VAL-SCAP IN VEN FROM
                        VEN-VAL-SFIN IN VEN GIVING
                        WSS-VAL-INTE IN WSS-VARI
               PERFORM OBT-DIF-FECHAS-A
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   GO TO FIN-CALCULA-NORMAL
               ELSE
                   COMPUTE WSS-VAL-INT IN WSS-VARI =
                           WSS-VAL-INTE IN WSS-VARI *
                           WSS-VAL-B IN WSS-VARI /
                           WSS-VAL-A IN WSS-VARI
           ELSE
      * DPM fin  3-OCT-1997
               PERFORM COL-CAL-INT
               IF INT-CMSG > SPACES
                   ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE INT-CMSG       TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY 'ERROR ' MSG-GLS-DESC
                                        ' ' INT-MEN2
                   MOVE INT-CMSG TO ERC-COD-MSGE IN ERC
                   GO TO FIN-CALCULA-NORMAL.

           MOVE INT-TIPE IN INT-VARI TO WSS-TASA IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'TASA: ' INT-TINC
               DISPLAY 'TASA PERIODO: ' WSS-TASA IN WSS-VARI.

      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
              GO TO SIGUE-CALCULA-NORMAL.

      *    Prepara Lectura para obtener Valor de UF FPRO.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FTRA   IN WSS-VARI   TO CAM-FEC-FCAM IN CAM(1)
                                                CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL BUSCAR VALOR UF PARA FPRO '
                      CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
      *DPM ini  4-NOV-1996
              GO TO FIN-CALCULA-NORMAL.
      *DPM fin  4-NOV-1996
           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI.

           MOVE WSS-VAL-UF1 IN WSS-VARI TO WSS-MONTO IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'UF FPRO: ' WSS-MONTO IN WSS-VARI.

      *  Prepara Lectura para obtener Valor de UF FCOL.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).


      *  Si es llamado desde PRO-SUSP-DEVENGO obtiene UF FSUS
           IF WSS-IND-DESDE IN WSS-VARI = 'SD'
              MOVE WSS-FEC-FSUS IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                               CAM-FEC-FCAM IN CAM(2)
           ELSE
      *DPM ini  9-DEC-1996
      *Mueve FCOL de OPC original si es prorroga para calculo de reajust
      *        MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1)
      *                                         CAM-FEC-FCAM IN CAM(2).
              MOVE WSS-FEC-FCOL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                               CAM-FEC-FCAM IN CAM(2).
      *DPM fin  9-DEC-1996

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                      CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-NORMAL.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI.

           MOVE WSS-VAL-UF2 IN WSS-VARI TO WSS-MONTO IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'UF FCOL(SUS):' WSS-MONTO IN WSS-VARI.

      *  Calcula Delta_UF
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM
                                 WSS-VAL-UF1 IN WSS-VARI
                          GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.

       SIGUE-CALCULA-NORMAL.
      *--------------------*
           IF WSS-IND-DESDE = 'FR'
      *       Calcula: R = Ki * Delta_UF
              MULTIPLY WSS-VAL-CAPI BY WSS-DIF-UFS IN WSS-VARI
                                     GIVING VAL-R IN VAL-VARI ROUNDED
      * DPM ini  3-OCT-1997 Si credito es no estructurado, los INT
      * se calculan por prorrateo
              IF OPC-IND-VSTR IN OPC NOT = 'S' AND
      * DPM ini  19-FEB-1998
      *           VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
                 VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI AND
                 (ICG-COD-CVTI IN ICG NOT > SPACES OR
                 VEN-IND-CALC IN VEN NOT = 'N')
      * DPM fin  19-FEB-1998
                  MOVE WSS-VAL-INT IN WSS-VARI TO
                                            VAL-I IN VAL-VARI
              ELSE
      * DPM fin  3-OCT-1997
      * DPM ini  13-OCT-1997
              IF VEN-FEC-FVEN IN VEN = WSS-FEC-FTRA IN WSS-VARI AND
                 WSS-IND-ULTI IN WSS-VARI NOT = 'S'
                  MOVE WSS-VAL-INTE IN WSS-VARI TO
                                             VAL-I IN VAL-VARI
              ELSE
      * DPM fin  13-OCT-1997
      *       Calcula: I = Ki * TP
                  MULTIPLY WSS-VAL-CAPI BY INT-TIPE IN INT-VARI
                                     GIVING VAL-I IN VAL-VARI ROUNDED
           ELSE
      *       Calcula: R = K * Delta_UF
              MULTIPLY OPC-VAL-SCRE IN OPC BY WSS-DIF-UFS IN WSS-VARI
                                     GIVING VAL-R IN VAL-VARI ROUNDED
      *       Calcula: I = K * TP
      * DPM ini  3-OCT-1997 Si credito es no estructurado, los INT
      * se calculan por prorrateo
              IF OPC-IND-VSTR IN OPC NOT = 'S' AND
      * DPM ini  19-FEB-1998
      *           VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
                 VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI AND
                 (ICG-COD-CVTI IN ICG NOT > SPACES OR
                 VEN-IND-CALC IN VEN NOT = 'N')
      * DPM fin  19-FEB-1998
                  MOVE WSS-VAL-INT IN WSS-VARI TO
                                        VAL-I IN VAL-VARI
      * DPM ini  14-OCT-1997
              ELSE
              IF VEN-FEC-FVEN IN VEN = WSS-FEC-FTRA IN WSS-VARI AND
                 WSS-IND-ULTI IN WSS-VARI NOT = 'S'
                  MOVE WSS-VAL-INTE IN WSS-VARI TO
                                            VAL-I IN VAL-VARI
      * DPM fin  14-OCT-1997
              ELSE
      * DPM fin  3-OCT-1997
                 MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE IN INT-VARI
                                     GIVING VAL-I IN VAL-VARI ROUNDED.

           IF WSS-IND-DESDE IN WSS-VARI = 'SD'
      *       Calcula: I OR = I * UF(FPRO)
              MULTIPLY VAL-I IN VAL-VARI BY WSS-VAL-UF1 IN WSS-VARI
                                GIVING WSS-VAL-INTO IN WSS-VARI ROUNDED
      *       Asigna: R OR = R
              MOVE VAL-R IN VAL-VARI TO WSS-VAL-REAO IN WSS-VARI
           ELSE
      *       Calcula: IxC = I * UF(FPRO)
              MULTIPLY VAL-I IN VAL-VARI BY WSS-VAL-UF1 IN WSS-VARI
                                GIVING WSS-VAL-INTD IN WSS-VARI ROUNDED
              IF WSS-IND-DISP IN WSS-VARI = 'S'
                 DISPLAY 'UF1 = ' WSS-VAL-UF1 IN WSS-VARI
                 DISPLAY 'INTD = ' WSS-VAL-INTD IN WSS-VARI

      *       Asigna: RxC = R
                 MOVE VAL-R IN VAL-VARI TO WSS-VAL-READ IN WSS-VARI
              ELSE
                 MOVE VAL-R IN VAL-VARI TO WSS-VAL-READ IN WSS-VARI.

           MOVE '00' TO FIO-STAT.
       FIN-CALCULA-NORMAL.
      *------------------*
           EXIT.


       CALCULA-7 SECTION.
      *-----------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A CALCULA-7'.
       INI-CALCULA-7.
      *-------------*
      *    Muevo Valor de Cambio
           MOVE WSS-COD-MONEDA IN WSS-VARI TO INT-VCAM IN INT-VARI.
      *    Muevo Identificacion de la Operacion
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC IN INT-VARI.
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC IN INT-VARI.
      *
           MOVE ZEROES TO INT-SEVE IN INT-VARI.
           MOVE SPACES TO INT-TCVF IN INT-VARI.
      *
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'INT-FUNO : ' INT-FUNO
              DISPLAY 'INT-FDOS : ' INT-FDOS
              DISPLAY 'LLAMA A RUTINA CAL-INT'.

           MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI.
           PERFORM LEE-VEN-ANT.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE DLC-FEC-FDEV IN DLC TO WSS-VEN-FANT IN WSS-VARI
           ELSE
               MOVE VEN-FEC-FVEN IN VEN TO WSS-VEN-FANT IN WSS-VARI.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.

      *DPM ini  1-SEP-1997 Si INT-FEC1 > INT-FEC2, Tasa = 0
           MOVE INT-DUNO TO WSS-NUM-D1.
           MOVE INT-MUNO TO WSS-NUM-M1.
           MOVE INT-SUNO TO WSS-NUM-S1.
           MOVE INT-AUNO TO WSS-NUM-A1.

           MOVE INT-DDOS TO WSS-NUM-D2.
           MOVE INT-MDOS TO WSS-NUM-M2.
           MOVE INT-SDOS TO WSS-NUM-S2.
           MOVE INT-ADOS TO WSS-NUM-A2.

           PERFORM LEE-ICG.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               DISPLAY 'ERROR LECTURA ICG PARA LLAVE '
                                             OPC-CIC-IOPC IN OPC
               MOVE 'OPC  NOICG' TO ERC-COD-MSGE IN ERC
               GO TO FIN-CALCULA-7.

      * DPM ini  12-DEC-1997 Determina si es balance o prebalance para
      * utilizar las fechas correspondientes en busqueda de tasa
           PERFORM DET-SI-BALANCE.
      * DPM fin  12-DEC-1997

           MOVE 'N' TO WSS-PVEZ IN WSS-VARI.

           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FTRA IN WSS-VARI OR
              WSS-FEC-F1 IN WSS-VARI > WSS-FEC-F2 IN WSS-VARI
               MOVE ZEROES TO INT-TIPE IN INT-VARI
           ELSE
      *DPM fin  1-SEP-1997
      * DPM ini  3-OCT-1997 Para creditos no Estructurados y con
      * el vencimiento mayor a fecha de proceso, los INT se calculan
      * por prorrateo y no por rutina de calculo
           IF OPC-IND-VSTR IN OPC NOT = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
               SUBTRACT VEN-VAL-SCAP IN VEN FROM
                        VEN-VAL-SFIN IN VEN GIVING
                        WSS-VAL-INTE IN WSS-VARI
               PERFORM OBT-DIF-FECHAS-A
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   GO TO FIN-CALCULA-7
               ELSE
                   PERFORM OBT-DIF-FECHAS-B
                   IF WSS-IND-FLAG IN WSS-VARI = 1
                       GO TO FIN-CALCULA-7
                   ELSE
                       COMPUTE WSS-VAL-ITOT IN WSS-VARI =
                               WSS-VAL-INTE IN WSS-VARI *
                               WSS-VAL-B IN WSS-VARI /
                               WSS-VAL-A IN WSS-VARI
                       COMPUTE WSS-VAL-IO IN WSS-VARI =
                               WSS-VAL-ITOT IN WSS-VARI *
                               WSS-VAL-C IN WSS-VARI /
                               WSS-VAL-B IN WSS-VARI

                       SUBTRACT WSS-VAL-IO IN WSS-VARI FROM
                               WSS-VAL-ITOT IN WSS-VARI GIVING
                               WSS-VAL-INT IN WSS-VARI
           ELSE
      * DPM fin  3-OCT-1997
               PERFORM COL-CAL-INT
               IF INT-CMSG > SPACES
                   ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE INT-CMSG       TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE INT-CMSG TO ERC-COD-MSGE IN ERC
                   DISPLAY 'ERROR ' MSG-GLS-DESC
                                  ' ' INT-MEN2
                   GO TO FIN-CALCULA-7.

           MOVE INT-TIPE IN INT-VARI TO WSS-TASA IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
      *  Si la operacion es en Moneda Nacional salta
               DISPLAY 'MONEDA: ' WSS-COD-MONEDA IN WSS-VARI
               DISPLAY 'TASA: ' INT-TINC
               DISPLAY 'TASA PERIODO: ' WSS-TASA IN WSS-VARI.

           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
                             WSS-VAL-UF2 IN WSS-VARI
              GO TO SIGUE-CALCULA-7.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'C7-1'.

      *    Prepara Lectura para obtener Valor de UF FPRO.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FTRA IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-7.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI.

      *    Prepara Lectura para obtener Valor de UF FSUS.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).

           MOVE WSS-FEC-FSUS IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-7.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI.

      *  Calcula Delta_UF2
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM WSS-VAL-UF1 IN WSS-VARI
                                 GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.
      *INI CGB
           MOVE WSS-DIF-UFS IN WSS-VARI TO WSS-DELTA-UF2 IN WSS-VARI.
      *FIN CGB
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'UF1: ' WSS-VAL-UF1 IN WSS-VARI
              DISPLAY 'UF2: ' WSS-VAL-UF2 IN WSS-VARI.

       SIGUE-CALCULA-7.
      *---------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'C7-2'.
      *  Calcula: R OR = K * Delta_UF2
           MULTIPLY OPC-VAL-SCRE IN OPC BY WSS-DIF-UFS IN WSS-VARI
                                     GIVING VAL-ROR IN VAL-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'VAL ROR: ' VAL-ROR IN VAL-VARI.

      *  Calcula: I OR = K * TP2
      * DPM ini  3-OCT-1997
           IF OPC-IND-VSTR IN OPC NOT = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
               MOVE WSS-VAL-IO IN WSS-VARI TO
                                 VAL-IOR IN VAL-VARI
           ELSE
      * DPM fin  3-OCT-1997
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE IN INT-VARI
                                 GIVING VAL-IOR IN VAL-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'I OR: ' VAL-IOR IN VAL-VARI.

      *  Calcula: I SUS = I OR * UF(FPRO)
           MULTIPLY VAL-IOR IN VAL-VARI BY WSS-VAL-UF1 IN WSS-VARI
                                GIVING WSS-VAL-INTO IN WSS-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'I SUS: ' WSS-VAL-INTO IN WSS-VARI.

      *  Asigna: R OR = R
           MOVE VAL-R IN VAL-VARI TO WSS-VAL-REAO IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'R OR: ' WSS-VAL-REAO IN WSS-VARI.

      *  Calcula: I OR = K * TP2
      * DPM ini  3-OCT-1997
           IF OPC-IND-VSTR IN OPC NOT = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
               MOVE WSS-VAL-IO IN WSS-VARI TO
                                 VAL-IOR IN VAL-VARI
           ELSE
      * DPM fin  3-OCT-1997
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE IN INT-VARI
                                GIVING VAL-IOR IN VAL-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'I OR: ' VAL-IOR IN VAL-VARI.

      *    Prepara Fechas de Parametros para calculo de Tasa Periodo
      *    Muevo FDEV a fecha Uno.
           MOVE DLC-NUM-DDEV IN DLC TO INT-DUNO IN INT-VARI.
           MOVE DLC-NUM-MDEV IN DLC TO INT-MUNO IN INT-VARI.
           MOVE DLC-NUM-SDEV IN DLC TO INT-SUNO IN INT-VARI.
           MOVE DLC-NUM-ADEV IN DLC TO INT-AUNO IN INT-VARI.

      * Preparo Parametros para obtener dia siguiente a FPRO.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *     IF NOT FIO-STAT-OKS
           IF NOT FEC-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL SUMAR 1 DIA A FPRO. '
                       WSS-FEC-FTRA IN WSS-VARI ' ' FIO-STAT
              MOVE 'ERR FPRO+1' TO ERC-COD-MSGE IN ERC
              GO TO FIN-CALCULA-7.

      *    Muevo FPRO+1 a fecha uno.
           MOVE FEC-ITM1 TO INT-DDOS IN INT-VARI.
           MOVE FEC-ITM2 TO INT-MDOS IN INT-VARI.
           MOVE FEC-ITM3 TO INT-SDOS IN INT-VARI.
           MOVE FEC-ITM4 TO INT-ADOS IN INT-VARI.

      *    Muevo Valor de Cambio
           MOVE WSS-COD-MONEDA IN WSS-VARI TO INT-VCAM IN INT-VARI.

      *    Muevo Identificacion de la Operacion
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC IN INT-VARI.
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC IN INT-VARI.
      *
           MOVE ZEROES TO INT-SEVE IN INT-VARI
                          INT-TIPE IN INT-VARI.
           MOVE SPACES TO INT-TCVF IN INT-VARI.
      *
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'INT-FUNO (FDEV)  : ' INT-FUNO
              DISPLAY 'INT-FDOS (FPRO+1): ' INT-FDOS
              DISPLAY 'INT-FUNO : ' INT-FUNO
              DISPLAY 'INT-FDOS : ' INT-FDOS
              DISPLAY 'LLAMA A RUTINA CAL-INT'.

      *DPM ini  1-SEP-1997 Si INT-FEC1 > INT-FEC2, Tasa = 0
           MOVE INT-DUNO TO WSS-NUM-D1.
           MOVE INT-MUNO TO WSS-NUM-M1.
           MOVE INT-SUNO TO WSS-NUM-S1.
           MOVE INT-AUNO TO WSS-NUM-A1.

           MOVE INT-DDOS TO WSS-NUM-D2.
           MOVE INT-MDOS TO WSS-NUM-M2.
           MOVE INT-SDOS TO WSS-NUM-S2.
           MOVE INT-ADOS TO WSS-NUM-A2.

           PERFORM LEE-ICG.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               DISPLAY 'ERROR LECTURA ICG PARA LLAVE '
                                             OPC-CIC-IOPC IN OPC
               MOVE 'OPC  NOICG' TO ERC-COD-MSGE IN ERC
               GO TO FIN-CALCULA-7.

      * DPM ini  12-DEC-1997 Determina si es balance o prebalance para
      * utilizar las fechas correspondientes en busqueda de tasa
           PERFORM DET-SI-BALANCE.
      * DPM fin  12-DEC-1997

           MOVE 'N' TO WSS-PVEZ IN WSS-VARI.

           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FTRA IN WSS-VARI OR
              WSS-FEC-F1 IN WSS-VARI > WSS-FEC-F2 IN WSS-VARI
               MOVE ZEROES TO INT-TIPE IN INT-VARI
           ELSE
      *DPM fin  1-SEP-1997
      * DPM ini  14-OCT-1997
           IF OPC-IND-VSTR IN OPC NOT = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
           ELSE
           IF OPC-IND-VSTR IN OPC = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
      * DPM fin  14-OCT-1997
               PERFORM COL-CAL-INT
               IF INT-CMSG > SPACES
                   ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE INT-CMSG       TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY 'ERROR ' MSG-GLS-DESC
                                  ' ' INT-MEN2
                   MOVE INT-CMSG TO ERC-COD-MSGE IN ERC
                   GO TO FIN-CALCULA-7
      * DPM ini  14-OCT-1997
           ELSE
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
      * DPM ini  18-FEB-1998 Si SFIN > SCAP calcula INT por diferencia,
      * en caso contrario, INT = 0
               IF VEN-VAL-SFIN IN VEN > VEN-VAL-SCAP IN VEN
                   SUBTRACT VEN-VAL-SCAP IN VEN FROM
                            VEN-VAL-SFIN IN VEN GIVING
                            WSS-VAL-INTE IN WSS-VARI
               ELSE
                   MOVE ZEROES TO WSS-VAL-INTE IN WSS-VARI.
      * DPM fin  18-FEB-1998
      * DPM fin  14-OCT-1997

      *  Calcula: I = (K * TP) - I OR
           MOVE INT-TIPE IN INT-VARI TO WSS-TASA IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'TASA: ' INT-TINC
               DISPLAY 'TASA PERIODO: ' WSS-TASA IN WSS-VARI.

      * DPM ini  3-OCT-1997
           IF OPC-IND-VSTR IN OPC NOT = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
               MOVE WSS-VAL-INT IN WSS-VARI TO
                                 VAL-I IN VAL-VARI
           ELSE
      * DPM fin  3-OCT-1997
      * DPM ini  14-OCT-1997
           IF OPC-IND-VSTR IN OPC = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
      * DPM fin  14-OCT-1997
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE IN INT-VARI
                                  GIVING VAL-I IN VAL-VARI ROUNDED
           ELSE
      * DPM ini  14-OCT-1997
               SUBTRACT VAL-IOR IN VAL-VARI FROM
                                  WSS-VAL-INTE IN WSS-VARI
                                  GIVING VAL-I IN VAL-VARI ROUNDED.
      * DPM ini  14-OCT-1997

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'VAL-I: ' VAL-I IN VAL-VARI.

      *  Prepara Calculo R = K * Delta_UF1
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
                             WSS-VAL-UF2 IN WSS-VARI
              GO TO SIGUE2-CALCULA-7.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'C7-3'.

      *    Prepara Lectura para obtener Valor de UF FCOL.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).

      *DPM ini  9-DEC-1996
      *     MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1)
      *                                      CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-FEC-FCOL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
      *DPM fin  9-DEC-1996

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-7.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'UF1 (antes SIGUE2): ' WSS-VAL-UF1 IN WSS-VARI.

       SIGUE2-CALCULA-7.
      *----------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'C7-4'
              DISPLAY 'UF1 (despues SIGUE2): ' WSS-VAL-UF1 IN WSS-VARI
              DISPLAY 'UF FSUS: ' WSS-VAL-UF2 IN WSS-VARI.

           SUBTRACT WSS-VAL-UF1 IN WSS-VARI FROM WSS-VAL-UF2 IN WSS-VARI
                                         GIVING WSS-DIF-UFS IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'DELTA UFS: ' WSS-DIF-UFS IN WSS-VARI.

      *  Calcula R = K * Delta_UF1
           MULTIPLY OPC-VAL-SCRE IN OPC BY WSS-DIF-UFS IN WSS-VARI
                                      GIVING VAL-R IN VAL-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'VAL-R: ' VAL-R IN VAL-VARI.

      *  Calcula: IxC = I * UF(FSUS)
           MULTIPLY VAL-I IN VAL-VARI BY WSS-VAL-UF2 IN WSS-VARI
                               GIVING WSS-VAL-INTD IN WSS-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'INTD: ' WSS-VAL-INTD IN WSS-VARI.

      *  INI CGB
      *  Calcula: REIN = I * Delta UF2
           MULTIPLY VAL-I IN VAL-VARI BY WSS-DELTA-UF2 IN WSS-VARI
                               GIVING WSS-VAL-REIN IN WSS-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'REIN: ' WSS-VAL-REIN IN WSS-VARI.
      *  FIN CGB

      *  Calcula: RxC = R
           MOVE VAL-R IN VAL-VARI TO WSS-VAL-READ IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'RXC = R: ' WSS-VAL-READ IN WSS-VARI.

      *  Calcula: R SUS = R OR + REIN
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
             OR WSS-MSC-TVOC IN WSS-VARI = '1'
             MOVE VAL-ROR IN VAL-VARI TO WSS-VAL-REAO IN WSS-VARI
           ELSE
             ADD WSS-VAL-REIN IN WSS-VARI TO VAL-ROR IN VAL-VARI GIVING
                                      WSS-VAL-REAO IN WSS-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
             DISPLAY 'WSS-VAL-REAO (R SUS): ' WSS-VAL-REAO IN WSS-VARI.

       FIN-CALCULA-7.
      *-------------*
           EXIT.

       CALCULA-INT-REA-MORA SECTION.
      *----------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A CALCULA-INT-REA-MORA'.
       INI-CALCULA-INT-REA-MORA.
      *------------------------*
      *     IF WSS-TIPO-DEV = 'M'
      *       GO TO SALTA-INT-REA-MORA.
      * Calcula Interes,Reajuste,Int.por Mora y Reaj.por Mora
      * I = TPV = VF - Kc

      *DPM ini  8-AUG-1997 Si opera como Bol. Grtia, INT deben ser
      * VEN-VAL-SFIN solamente
           IF WSS-OPEC IN WSS-VARI = 'B'
               MOVE VEN-VAL-SFIN IN VEN TO VAL-I IN VAL-VARI
           ELSE
      * DPM ini  18-FEB-1998 Si SFIN > SCAP calcula INT por diferencia,
      * en caso contrario, INT = 0
      *         SUBTRACT VEN-VAL-SCAP IN VEN FROM VEN-VAL-SFIN IN VEN
      *                                      GIVING VAL-I IN VAL-VARI.
               IF VEN-VAL-SFIN IN VEN > VEN-VAL-SCAP IN VEN
                   SUBTRACT VEN-VAL-SCAP IN VEN FROM
                            VEN-VAL-SFIN IN VEN GIVING
                            VAL-I IN VAL-VARI
               ELSE
                   MOVE ZEROES TO VAL-I IN VAL-VARI.
      * DPM fin  18-FEB-1998
      *DPM fin  8-AUG-1997

      *     DISPLAY '1'.
      * Calcula diferencia en UFs entre FCOL y FVEN.
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
              GO TO SIGUE-CALCULA-INT-REA-MORA.
      *     DISPLAY '2'.

      *    Prepara Lectura para obtener Valor de UF FVEN.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-INT-REA-MORA.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI.
      *     DISPLAY '3'.

      *    Prepara Lectura para obtener Valor de UF FCOL.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).

      *DPM ini  9-DEC-1996
      *     MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1)
      *                                      CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-FEC-FCOL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
      *DPM fin  9-DEC-1996

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-INT-REA-MORA.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI.
      *     DISPLAY '4'.

      *  Calcula Delta_UF
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM WSS-VAL-UF1 IN WSS-VARI
                                 GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.

       SIGUE-CALCULA-INT-REA-MORA.
      *--------------------------*
      *     DISPLAY '5'.
      *  Calcula: R = Kc * Delta_UFV
      *ALD-BCI-INI/07.09.1999
           IF DLC-IND-SCTB IN DLC = 'VCD' OR
              DLC-IND-SCTB IN DLC = 'CAS'
               MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI.
      *ALD-BCI-FIN/07.09.1999
           MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-DIF-UFS IN WSS-VARI
                                       GIVING VAL-R IN VAL-VARI ROUNDED.
      *  Calcula: IxC = I * UF(FVEN)
           MULTIPLY VAL-I IN VAL-VARI BY WSS-VAL-UF1 IN WSS-VARI
                                GIVING WSS-VAL-INTD IN WSS-VARI ROUNDED.
      *ALD-BCI-INI/07.09.1999
           IF DLC-IND-SCTB IN DLC = 'VCD' OR
              DLC-IND-SCTB IN DLC = 'CAS'
               MOVE ZEROES TO VAL-I IN VAL-VARI
               MOVE ZEROES TO WSS-VAL-INTD IN WSS-VARI.
      *ALD-BCI-FIN/07.09.1999
      *  Asigna: RxC = R
           MOVE VAL-R IN VAL-VARI TO WSS-VAL-READ IN WSS-VARI.

       SALTA-INT-REA-MORA.
      *------------------*
      *     DISPLAY '6'.

      * Invoca a Section que Prepara Parametros y llama a Rutina
      * para Calculo de Interes de Mora. Retornando Tasa en MOR-TIPE.
           PERFORM LLAMA-CAL-INT-MORA.

      *DPM ini  18-DEC-1996
           IF NOT FIO-STAT-OKS OR
              MOR-CMSG IN MOR-VARI > SPACES
               DISPLAY 'ERROR LLAMA-CAL-INT-MORA: '
                        OPC-CIC-IOPC IN OPC ' ' MOR-CMSG IN MOR-VARI
               GO TO FIN-CALCULA-INT-REA-MORA
           ELSE
               MOVE SPACES TO MOR-CMSG IN MOR-VARI.
      *DPM fin  18-DEC-1996

      *  IM = VF * TPMO
           MULTIPLY VEN-VAL-SFIN IN VEN BY MOR-TIPE IN MOR-VARI
                              GIVING VAL-IM IN VAL-VARI ROUNDED.

      * Calcula diferencia en UFs entre FPRO y WSS-FEC-FCAL.
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
              GO TO CONT-CALCULA-INT-REA-MORA.
      *     DISPLAY '9'.

      *    Prepara Lectura para obtener Valor de UF FPRO.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FTRA IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-INT-REA-MORA.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI.
      *     DISPLAY '10'.

      *    Prepara Lectura para obtener Valor de UF FCAL.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FCAL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-INT-REA-MORA.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI.
      *     DISPLAY '11'.

      *  Calcula Delta_UF
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM WSS-VAL-UF1 IN WSS-VARI
                                 GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.

       CONT-CALCULA-INT-REA-MORA.
      *-------------------------*
      *     DISPLAY '12'.
      * RM = VF * Delta_UFMO
           MULTIPLY VEN-VAL-SFIN IN VEN BY WSS-DIF-UFS IN WSS-VARI
                                    GIVING VAL-RM IN VAL-VARI ROUNDED.
      * IMORA = IM * UFP
           MULTIPLY VAL-IM IN VAL-VARI BY WSS-VAL-UF1 IN WSS-VARI
                              GIVING WSS-VAL-INTM IN WSS-VARI ROUNDED.
      * RMORA = RM
           MOVE VAL-RM IN VAL-VARI TO WSS-VAL-REAM IN WSS-VARI.

       FIN-CALCULA-INT-REA-MORA.
      *------------------------*
           EXIT.

       CALCULA-8 SECTION.
      *-----------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A CALCULA-8'.
       INI-CALCULA-8.
      *-------------*
      * I OR = TPV = VF - Kc
      *DPM ini  8-AUG-1997 Si opera como Bol. Grtia, INT deben ser
      * VEN-VAL-SFIN solamente
           IF WSS-OPEC IN WSS-VARI = 'B'
               MOVE VEN-VAL-SFIN IN VEN TO VAL-IOR IN VAL-VARI
           ELSE
               SUBTRACT VEN-VAL-SCAP IN VEN FROM VEN-VAL-SFIN IN VEN
                                          GIVING VAL-IOR IN VAL-VARI.
      * DPM ini  18-FEB-1998 Si SFIN > SCAP calcula INT por diferencia,
      * en caso contrario, INT = 0
      *         SUBTRACT VEN-VAL-SCAP IN VEN FROM VEN-VAL-SFIN IN VEN
      *                                    GIVING VAL-IOR IN VAL-VARI.
               IF VEN-VAL-SFIN IN VEN > VEN-VAL-SCAP IN VEN
                   SUBTRACT VEN-VAL-SCAP IN VEN FROM
                            VEN-VAL-SFIN IN VEN GIVING
                            VAL-IOR IN VAL-VARI
               ELSE
                   MOVE ZEROES TO VAL-IOR IN VAL-VARI.
      * DPM fin  18-FEB-1998
      *DPM fin  8-AUG-1997

      * Calcula diferencia en UFs entre FVEN y FSUS.
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
              GO TO SIGUE-CALCULA-8.

      *    Prepara Lectura para obtener Valor de UF FVEN.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-8.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI.

      *    Prepara Lectura para obtener Valor de UF FSUS.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FSUS IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-8.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI.

      *  Calcula Delta_UF
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM WSS-VAL-UF1 IN WSS-VARI
                                 GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.

       SIGUE-CALCULA-8.
      *---------------*
      *  Calcula: R OR = Kc * Delta_UFV3
           MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-DIF-UFS IN WSS-VARI
                                    GIVING VAL-ROR IN VAL-VARI ROUNDED.
      *  Calcula: IxC = I * UF(FVEN)
           MULTIPLY VAL-IOR IN VAL-VARI BY WSS-VAL-UF1 IN WSS-VARI
                               GIVING WSS-VAL-INTO IN WSS-VARI ROUNDED.
      *  Asigna: RxC = R
           MOVE VAL-ROR IN VAL-VARI TO WSS-VAL-REAO IN WSS-VARI.

       SALTA-CALCULA-8.
      *---------------*
      * Invoca a Section que Prepara Parametros y llama a Rutina
      * para Calculo de Interes de Mora. Retornando Tasa en MOR-TIPE.
           PERFORM LLAMA-CAL-INT-MORA.

      *DPM ini  18-DEC-1996
           IF NOT FIO-STAT-OKS OR
              MOR-CMSG IN MOR-VARI > SPACES
               ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
               DISPLAY 'ERROR LLAMA-CAL-INT-MORA: '
                        OPC-CIC-IOPC IN OPC ' ' MOR-CMSG IN MOR-VARI
               GO TO FIN-CALCULA-8
           ELSE
               MOVE SPACES TO MOR-CMSG IN MOR-VARI.
      *DPM fin  18-DEC-1996

      *  IM = VF * TPMO
           MULTIPLY VEN-VAL-SFIN IN VEN BY MOR-TIPE IN MOR-VARI
                                      GIVING VAL-IM IN VAL-VARI ROUNDED.

      * Calcula diferencia en UFs entre FPRO y WSS-FEC-FCAL.
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
              GO TO CONT-CALCULA-8.

      *    Prepara Lectura para obtener Valor de UF FPRO.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FTRA IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-8.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI.

      *    Prepara Lectura para obtener Valor de UF FCAL.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FCAL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-8.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI.

      *  Calcula Delta_UF
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM WSS-VAL-UF1 IN WSS-VARI
                                 GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.

       CONT-CALCULA-8.
      *--------------*
      * RM = VF * Delta_UFMO
           MULTIPLY VEN-VAL-SFIN IN VEN BY WSS-DIF-UFS IN WSS-VARI
                                    GIVING VAL-RM IN VAL-VARI ROUNDED.
      * IMORA = IM * UFP
           MULTIPLY VAL-IM IN VAL-VARI BY WSS-VAL-UF1 IN WSS-VARI
                              GIVING WSS-VAL-INTM IN WSS-VARI ROUNDED.
      * RMORA = RM
           MOVE VAL-RM IN VAL-VARI TO WSS-VAL-REAM IN WSS-VARI.

       FIN-CALCULA-8.
      *-------------*
           EXIT.

       PRO-SUSP-DEVENGO-10 SECTION.
      *---------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A PRO-SUSP-DEVENGO-10'.

      *    Calculo de Saldo Insoluto a la Fecha de Proceso.
           SUBTRACT WSS-SUM-VCAP IN WSS-VARI FROM OPC-VAL-SCRE IN OPC
                                      GIVING WSS-VAL-CAPI IN WSS-VARI.

      *    Prepara Fechas de Parametros para calculo de Tasa Periodo
      * Obtengo Vencimiento anterior a fecha de Proceso.
      *DPM INI
           IF WSS-IND-ULTI IN WSS-VARI = 'N'
               MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI
               PERFORM LEE-VEN-ANT-FPRO
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                   MOVE DLC-FEC-FDEV IN DLC TO WSS-VEN-FANT IN WSS-VARI
               ELSE
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-VEN-FANT IN WSS-VARI.

           IF WSS-IND-ULTI IN WSS-VARI = 'N'
               MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
               MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN
               PERFORM COL-FIO-VEN.
      *DPM FIN
      *DPM ini  3-SEP-1997 Si FVEN < FPRO y Saldo VEN = 0, no procesar
           IF VEN-FEC-FVEN IN VEN < WSS-FEC-FTRA IN WSS-VARI AND
              VEN-VAL-SFIN IN VEN NOT > ZEROES AND
      * DPM ini  24-NOV-1997
              WSS-OPEC IN WSS-VARI NOT = 'B'
      * DPM fin  24-NOV-1997
               ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
               DISPLAY 'SALDO VCTO = 0: ' VEN-KEY-IREG IN VEN
               MOVE 'FSDM>0 VIG'  TO ERC-COD-MSGE IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-PRO-SUSP-DEVENGO-10.
      *DPM fin  3-SEP-1997

      * DPM ini  17-OCT-1997 Se cambio FVEN actual por FVEN anterior
      * porque no se estaban grabando los INT del ultimo VEN, ya que
      * FUNO era > FDOS para rutina.
      *    Muevo FVEN a fecha Uno.
      *     MOVE VEN-NUM-DVEN IN VEN TO INT-DUNO IN INT-VARI.
      *     MOVE VEN-NUM-MVEN IN VEN TO INT-MUNO IN INT-VARI.
      *     MOVE VEN-NUM-SVEN IN VEN TO INT-SUNO IN INT-VARI.
      *     MOVE VEN-NUM-AVEN IN VEN TO INT-AUNO IN INT-VARI.

      * DPM ini  27-NOV-1997
           IF WSS-IND-ULTI IN WSS-VARI = 'S'
               MOVE VEN-NUM-DVEN IN VEN TO WSS-VEN-DANT IN WSS-VARI
                                           INT-DUNO IN INT-VARI
               MOVE VEN-NUM-MVEN IN VEN TO WSS-VEN-MANT IN WSS-VARI
                                           INT-MUNO IN INT-VARI
               MOVE VEN-NUM-SVEN IN VEN TO WSS-VEN-SANT IN WSS-VARI
                                           INT-SUNO IN INT-VARI
               MOVE VEN-NUM-AVEN IN VEN TO WSS-VEN-AANT IN WSS-VARI
                                           INT-AUNO IN INT-VARI
           ELSE
      * DPM fin  27-NOV-1997
               MOVE WSS-VEN-DANT IN WSS-VARI TO INT-DUNO IN INT-VARI
               MOVE WSS-VEN-MANT IN WSS-VARI TO INT-MUNO IN INT-VARI
               MOVE WSS-VEN-SANT IN WSS-VARI TO INT-SUNO IN INT-VARI
               MOVE WSS-VEN-AANT IN WSS-VARI TO INT-AUNO IN INT-VARI.
      * DPM fin  17-OCT-1997

      * Preparo Parametros para obtener dia siguiente a FPRO.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *     IF NOT FIO-STAT-OKS
           IF NOT FEC-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR AL SUMAR 1 DIA A FPRO: '
                       WSS-FEC-FTRA IN WSS-VARI ' ' FIO-STAT
                      ' ' OPC-CIC-IOPC IN OPC
              MOVE 'ERR FPRO+1'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-10.

      *    Muevo FPRO+1 a fecha uno.
           MOVE FEC-ITM1 TO INT-DDOS IN INT-VARI.
           MOVE FEC-ITM2 TO INT-MDOS IN INT-VARI.
           MOVE FEC-ITM3 TO INT-SDOS IN INT-VARI.
           MOVE FEC-ITM4 TO INT-ADOS IN INT-VARI.

      *     DISPLAY 'FECHA 2 TP: ' INT-FDOS IN INT-VARI.

           PERFORM CALCULA-10.
      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR CALCULA-10: '
                     OPC-CIC-IOPC IN OPC  ' ' FIO-STAT
      *        MOVE 'CALCULA-10'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-10.
      *DPM fin  4-NOV-1996

           ADD WSS-VAL-INTO IN WSS-VARI TO WSS-SUM-ISU IN WSS-VARI.
           ADD WSS-VAL-REAO IN WSS-VARI TO WSS-SUM-RSU IN WSS-VARI.

      *   Muevo Acumuladores a ser grabados
           MOVE WSS-SUM-ISU IN WSS-VARI TO WSS-VAL-INTO IN WSS-VARI.
           MOVE WSS-SUM-RSU IN WSS-VARI TO WSS-VAL-REAO IN WSS-VARI.
           MOVE WSS-SUM-IMO IN WSS-VARI TO WSS-VAL-INTM IN WSS-VARI.
           MOVE WSS-SUM-RMO IN WSS-VARI TO WSS-VAL-REAM IN WSS-VARI.

      *   Limpia montos que deben quedar limpios en Reg.DLC

           MOVE ZEROES TO WSS-VAL-INTD IN WSS-VARI
                          WSS-VAL-READ IN WSS-VARI.
           PERFORM GRABA-REG-DLC.

       FIN-PRO-SUSP-DEVENGO-10.
      *-----------------------*
           EXIT.

       CALCULA-10 SECTION.
      *------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A CALCULA-10'.
       INI-CALCULA-10.
      *--------------*
      *    Muevo Valor de Cambio
           MOVE WSS-COD-MONEDA TO INT-VCAM IN INT-VARI.
      *    Muevo Identificacion de la Operacion
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC IN INT-VARI.
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC IN INT-VARI.
      *
           MOVE ZEROES TO INT-SEVE IN INT-VARI.
           MOVE SPACES TO INT-TCVF IN INT-VARI.
      *
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'INT-FUNO : ' INT-FUNO
               DISPLAY 'INT-FDOS : ' INT-FDOS
               DISPLAY 'LLAMA A RUTINA CAL-INT'.

      *DPM ini  1-SEP-1997 Si INT-FEC1 > INT-FEC2, Tasa = 0
           MOVE INT-DUNO TO WSS-NUM-D1.
           MOVE INT-MUNO TO WSS-NUM-M1.
           MOVE INT-SUNO TO WSS-NUM-S1.
           MOVE INT-AUNO TO WSS-NUM-A1.

           MOVE INT-DDOS TO WSS-NUM-D2.
           MOVE INT-MDOS TO WSS-NUM-M2.
           MOVE INT-SDOS TO WSS-NUM-S2.
           MOVE INT-ADOS TO WSS-NUM-A2.

           PERFORM LEE-ICG.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               DISPLAY 'ERROR LECTURA ICG PARA LLAVE '
                                             OPC-CIC-IOPC IN OPC
               MOVE 'OPC  NOICG' TO ERC-COD-MSGE IN ERC
               GO TO FIN-CALCULA-10.

      * DPM ini  12-DEC-1997 Determina si es balance o prebalance para
      * utilizar las fechas correspondientes en busqueda de tasa
           PERFORM DET-SI-BALANCE.
      * DPM fin  12-DEC-1997

           MOVE 'N' TO WSS-PVEZ IN WSS-VARI.

           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FTRA IN WSS-VARI OR
              WSS-FEC-F1 IN WSS-VARI > WSS-FEC-F2 IN WSS-VARI
               MOVE ZEROES TO INT-TIPE IN INT-VARI
           ELSE
      *DPM fin  1-SEP-1997
      * DPM ini  3-OCT-1997 Para creditos no Estructurados y con
      * el vencimiento mayor a fecha de proceso, los INT se calculan
      * por prorrateo y no por rutina de calculo
           IF OPC-IND-VSTR IN OPC NOT = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
               SUBTRACT VEN-VAL-SCAP IN VEN FROM
                        VEN-VAL-SFIN IN VEN GIVING
                        WSS-VAL-INTE IN WSS-VARI
               PERFORM OBT-DIF-FECHAS-A
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   GO TO FIN-CALCULA-10
               ELSE
                   COMPUTE WSS-VAL-INT IN WSS-VARI =
                           WSS-VAL-INTE IN WSS-VARI *
                           WSS-VAL-B IN WSS-VARI /
                           WSS-VAL-A IN WSS-VARI
           ELSE
      * DPM fin  3-OCT-1997
      * DPM ini  14-OCT-1997
           IF VEN-FEC-FVEN IN VEN = WSS-FEC-FTRA IN WSS-VARI
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
      * DPM ini  18-FEB-1998 Si SFIN > SCAP calcula INT por diferencia,
      * en caso contrario, INT = 0
      *         SUBTRACT VEN-VAL-SCAP IN VEN FROM
      *                  VEN-VAL-SFIN IN VEN GIVING
      *                  WSS-VAL-INTE IN WSS-VARI

               IF VEN-VAL-SFIN IN VEN > VEN-VAL-SCAP IN VEN
                   SUBTRACT VEN-VAL-SCAP IN VEN FROM
                            VEN-VAL-SFIN IN VEN GIVING
                            WSS-VAL-INTE IN WSS-VARI
               ELSE
                   MOVE ZEROES TO WSS-VAL-INTE IN WSS-VARI
      * DPM fin  18-FEB-1998

           ELSE
      * DPM fin  14-OCT-1997
               PERFORM COL-CAL-INT
               IF INT-CMSG > SPACES
                   ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE INT-CMSG       TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY 'ERROR ' MSG-GLS-DESC
                                  ' ' INT-MEN2
                   MOVE INT-CMSG TO ERC-COD-MSGE IN ERC
                   GO TO FIN-CALCULA-10.

           MOVE INT-TIPE IN INT-VARI TO WSS-TASA IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
      *  Si la operacion es en Moneda Nacional salta
               DISPLAY 'MONEDA: ' WSS-COD-MONEDA IN WSS-VARI
               DISPLAY 'TASA: ' INT-TINC
               DISPLAY 'TASA PERIODO: ' WSS-TASA IN WSS-VARI.

      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
              GO TO SIGUE-CALCULA-10.

      *    Prepara Lectura para obtener Valor de UF FPRO.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FTRA IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-10.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI

      *    Prepara Lectura para obtener Valor de UF FSUS.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FSUS IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-10.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI.

      *  Calcula Delta_UF
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM WSS-VAL-UF1 IN WSS-VARI
                                 GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.

       SIGUE-CALCULA-10.
      *----------------*
      *  Calcula: R SUS = Ki * Delta_UF2
           MULTIPLY WSS-VAL-CAPI IN WSS-VARI BY WSS-DIF-UFS IN WSS-VARI
                                    GIVING VAL-ROR IN VAL-VARI ROUNDED.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'WSS-VAL-CAPI: ' WSS-VAL-CAPI IN WSS-VARI
               DISPLAY 'INT-TIPE    : ' INT-TIPE IN INT-VARI
               DISPLAY 'VAL-ROR     : ' VAL-ROR IN VAL-VARI.

      * DPM ini  14-OCT-1997
           IF OPC-IND-VSTR IN OPC NOT = 'S' AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
               MOVE WSS-VAL-INT IN WSS-VARI TO
                                   VAL-IOR IN VAL-VARI
           ELSE
           IF VEN-FEC-FVEN IN VEN = WSS-FEC-FTRA IN WSS-VARI
               MOVE WSS-VAL-INTE IN WSS-VARI TO
                                   VAL-IOR IN VAL-VARI
           ELSE
      * DPM fin  14-OCT-1997
      *  Calcula: IOR = Ki * TP
               MULTIPLY WSS-VAL-CAPI IN WSS-VARI BY
                                INT-TIPE IN INT-VARI
                                GIVING VAL-IOR IN VAL-VARI ROUNDED.
      * DPM fin  14-OCT-1997

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'VAL-IOR     : ' VAL-IOR IN VAL-VARI.

      *       Calcula: I SUS = I OR * UF(FPRO)
              MULTIPLY VAL-IOR IN VAL-VARI BY WSS-VAL-UF1 IN WSS-VARI
                                GIVING WSS-VAL-INTO IN WSS-VARI ROUNDED.

           MOVE VAL-ROR IN VAL-VARI TO WSS-VAL-REAO IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'VAL-R: ' VAL-R IN VAL-VARI.
       FIN-CALCULA-10.
      *--------------*
           EXIT.

       GRABA-REG-DLC SECTION.
      *---------------------*
      *DPM ini  29-OCT-1996 BCI
      *DPM ini  5-AUG-1997 Se inserto parametro de actualizacion de DLC
           IF WSS-IND-ACTU IN WSS-VARI = 'S'
               MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC
               MOVE 1                   TO DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF NOT FIO-STAT-OKS
                   ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                   DISPLAY 'ERROR AL LEER REG. DLC, KEY:'
                            OPC-CIC-IOPC IN OPC ' ' FIO-STAT
                   MOVE 'OPC  NODLC'  TO ERC-COD-MSGE IN ERC
                   PERFORM GRABAR-ERROR
                   GO TO FIN-GRABA-REG-DLC.
      *DPM fin  29-OCT-1996 BCI

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A GRABA-REG-DLC'.

      ********* MUEVO VALORES CALCULADOS A REG.DLC Y REG.DVG*********

           IF WSS-MSC-TVOC NOT = '1'
      *       Salida con aprox. al entero para montos <> Dolares 0 Dec.
      *       ---------------------------------------------------------
      *       Valor Intereses Devengados Normales (resultado)
              MULTIPLY WSS-VAL-INTD IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-INTD0 IN WSS-VARI ROUNDED
              MOVE WSS-VAL-INTD0 IN WSS-VARI TO DLC-VAL-INTD IN DLC
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-INTD IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Reajustes Devengados Normales (resultado)
              MULTIPLY WSS-VAL-READ IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-READ0 IN WSS-VARI ROUNDED
              MOVE WSS-VAL-READ0 IN WSS-VARI TO DLC-VAL-READ IN DLC
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-READ IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Intereses Devengados en Orden (por Mora o Riesgo)
              MULTIPLY WSS-VAL-INTO IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-INTO0 IN WSS-VARI ROUNDED
      *DPM ini  1-AUG-1997 Los conceptos INTO, INTM, REAO y REAM se
      * graban en la DVG y no en DLC, para no sobrecargar la DLC
      *        MOVE WSS-VAL-INTO0 IN WSS-VARI TO DLC-VAL-INTO IN DLC
      *DPM fin  1-AUG-1997
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-INTO IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Reajustes Devengados en Orden (por Mora o Riesgo)
              MULTIPLY WSS-VAL-REAO IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-REAO0 IN WSS-VARI ROUNDED
      *DPM ini  1-AUG-1997 Los conceptos INTO, INTM, REAO y REAM se
      * graban en la DVG y no en DLC, para no sobrecargar la DLC
      *        MOVE WSS-VAL-REAO0 IN WSS-VARI TO DLC-VAL-REAO IN DLC
      *DPM fin  1-AUG-1997
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-REAO IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Intereses Moratorios
      *        MOVE ZEROES TO WSS-VAL-INTM IN WSS-VARI
              MULTIPLY WSS-VAL-INTM IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-INTM0 IN WSS-VARI ROUNDED
      *DPM ini  1-AUG-1997 Los conceptos INTO, INTM, REAO y REAM se
      * graban en la DVG y no en DLC, para no sobrecargar la DLC
      *        MOVE WSS-VAL-INTM0 IN WSS-VARI TO DLC-VAL-INTM IN DLC
      *DPM fin  1-AUG-1997
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-INTM IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Reajustes Moratorios
      *        MOVE ZEROES TO WSS-VAL-REAM IN WSS-VARI
              MULTIPLY WSS-VAL-REAM IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-REAM0 IN WSS-VARI ROUNDED
      *DPM ini  1-AUG-1997 Los conceptos INTO, INTM, REAO y REAM se
      * graban en la DVG y no en DLC, para no sobrecargar la DLC
      *        MOVE WSS-VAL-REAM0 IN WSS-VARI TO DLC-VAL-REAM IN DLC
      *DPM fin  1-AUG-1997
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-REAM IN DVG
      *DPM fin  29-OCT-1996 BCI

           ELSE
      *       Salida con aprox. al entero para montos en Dolares 2 Dec.
      *       ---------------------------------------------------------
      *       Valor Intereses Devengados Normales (resultado)
              MULTIPLY WSS-VAL-INTD IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-INTD2 IN WSS-VARI ROUNDED
              MOVE WSS-VAL-INTD2 IN WSS-VARI TO DLC-VAL-INTD IN DLC
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-INTD IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Reajustes Devengados Normales (resultado)
              MULTIPLY WSS-VAL-READ IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-READ2 IN WSS-VARI ROUNDED
              MOVE WSS-VAL-READ2 IN WSS-VARI TO DLC-VAL-READ IN DLC
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-READ IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Intereses Devengados en Orden (por Mora o Riesgo)
              MULTIPLY WSS-VAL-INTO IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-INTO2 IN WSS-VARI ROUNDED
      *DPM ini  1-AUG-1997 Los conceptos INTO, INTM, REAO y REAM se
      * graban en la DVG y no en DLC, para no sobrecargar la DLC
      *        MOVE WSS-VAL-INTO2 IN WSS-VARI TO DLC-VAL-INTO IN DLC
      *DPM fin  1-AUG-1997
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-INTO IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Reajustes Devengados en Orden (por Mora o Riesgo)
              MULTIPLY WSS-VAL-REAO IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-REAO2 IN WSS-VARI ROUNDED
      *DPM ini  1-AUG-1997 Los conceptos INTO, INTM, REAO y REAM se
      * graban en la DVG y no en DLC, para no sobrecargar la DLC
      *        MOVE WSS-VAL-REAO2 IN WSS-VARI TO DLC-VAL-REAO IN DLC
      *DPM fin  1-AUG-1997
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-REAO IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Intereses Moratorios
      *        MOVE ZEROES TO WSS-VAL-INTM IN WSS-VARI
              MULTIPLY WSS-VAL-INTM IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-INTM2 IN WSS-VARI ROUNDED
      *DPM ini  1-AUG-1997 Los conceptos INTO, INTM, REAO y REAM se
      * graban en la DVG y no en DLC, para no sobrecargar la DLC
      *        MOVE WSS-VAL-INTM2 IN WSS-VARI TO DLC-VAL-INTM IN DLC
      *DPM fin  1-AUG-1997
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-INTM IN DVG
      *DPM fin  29-OCT-1996 BCI

      *       Valor Reajustes Moratorios
      *        MOVE ZEROES TO WSS-VAL-REAM IN WSS-VARI
              MULTIPLY WSS-VAL-REAM IN WSS-VARI BY 1 GIVING
                                    WSS-VAL-REAM2 IN WSS-VARI ROUNDED
      *DPM ini  1-AUG-1997 Los conceptos INTO, INTM, REAO y REAM se
      * graban en la DVG y no en DLC, para no sobrecargar la DLC
      *        MOVE WSS-VAL-REAM2 IN WSS-VARI TO DLC-VAL-REAM IN DLC.
      *DPM fin  1-AUG-1997
      *DPM ini  29-OCT-1996 BCI
      *                                          DVG-VAL-REAM IN DVG.
      *DPM fin  29-OCT-1996 BCI

      *     DISPLAY 'GRABA-DLC'.

      *     MOVE DLC-VAL-INTD IN DLC TO WSS-MONTO  IN WSS-VARI.
      *     MOVE DLC-VAL-READ IN DLC TO WSS-MONTO2 IN WSS-VARI.
      *     IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'DLC-VAL-INTD       DLC-VAL-READ'
      *        DISPLAY WSS-MONTO IN WSS-VARI ' ' WSS-MONTO2 IN WSS-VARI.

      *DPM ini  1-AUG-1997
      *     MOVE DLC-VAL-INTO IN DLC TO WSS-MONTO  IN WSS-VARI.
      *     MOVE DLC-VAL-REAO IN DLC TO WSS-MONTO2 IN WSS-VARI.
      *     IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'DLC-VAL-INTO       DLC-VAL-REAO'
      *        DISPLAY WSS-MONTO IN WSS-VARI ' ' WSS-MONTO2 IN WSS-VARI.

      *     MOVE DLC-VAL-INTM IN DLC TO WSS-MONTO  IN WSS-VARI.
      *     MOVE DLC-VAL-REAM IN DLC TO WSS-MONTO2 IN WSS-VARI.
      *     IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'DLC-VAL-INTM       DLC-VAL-REAM'
      *        DISPLAY WSS-MONTO IN WSS-VARI ' ' WSS-MONTO2 IN WSS-VARI.
      *DPM fin  1-AUG-1997

      *DPM ini  1-AUG-1997 Se graba DLC solo si ind. actualizacion es S
           IF WSS-IND-ACTU IN WSS-VARI = 'S'
      *DPM ini  17-DEC-1996
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF NOT FIO-STAT-OKS
                  ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                  DISPLAY 'DLCNOGRABA'
                  MOVE 'DLCNOGRABA'  TO ERC-COD-MSGE IN ERC
                  PERFORM GRABAR-ERROR
                  DISPLAY 'ERROR AL REGRABAR DLC, KEY: '
                                     DLC-CIC-IOPC IN DLC
                  GO TO FIN-GRABA-REG-DLC
               ELSE
                  DISPLAY 'GRABA REG DLC: OK'.
      *DPM fin  17-DEC-1996
      *DPM fin  1-AUG-1997

           ADD 1 TO WSS-NUM-GOPC IN WSS-VARI.

           PERFORM CREA-REGISTRO-DVG.
           PERFORM LIMPIA-VEC-DVG.
       FIN-GRABA-REG-DLC.
      *-----------------*
           EXIT.


      ************************************************
      *DPM ini  29-OCT-1996 BCI
       CREA-REGISTRO-DVG SECTION.
       INI-CREA-REGISTRO-DVG.
      *---------------------*
      *     MOVE 1 TO WSS-NUM-IREG IN WSS-VARI.
           PERFORM OBT-CPTO-CTA.
           IF NOT FIO-STAT-OKS OR
              MSG-COD-MENS > SPACES
               ADD 1 TO WSS-NUM-REDV IN WSS-VARI
               MOVE SPACES TO MSG-COD-MENS
               GO TO FIN-CREA-REGISTRO-DVG.

           MOVE 1 TO CPP-I.
           MOVE 1 TO MOV-I.
       SIGUE1-CREA-REGISTRO-DVG.
           IF ( ( CPP-I > 39 ) OR
                ( CPP-MSC-TCCT (CPP-I) = SPACES AND
                  CPP-IND-DBHB (CPP-I) = SPACES AND
                  CPP-IND-TALG (CPP-I) = SPACES ) )
               GO TO SIGUE2-CREA-REGISTRO-DVG.

      *Obtiene concepto a contabilizar
           PERFORM OBT-CPTO-ALG.
           IF NOT FIO-STAT-OKS
               ADD 1 TO WSS-NUM-REDV IN WSS-VARI
               GO TO FIN-CREA-REGISTRO-DVG.

           IF WSS-COD-CPTO IN WSS-VARI = WSS-COD-INTD IN WSS-VARI
             MOVE CPP-IND-DBHB (CPP-I) TO VEC-IND-DBHB (MOV-I)
             MOVE CPP-MSC-TCCT (CPP-I) TO VEC-MSC-TCCT (MOV-I)
             IF WSS-MSC-TVOC NOT = '1'
               MOVE WSS-VAL-INTD0 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
             ELSE
               MOVE WSS-VAL-INTD2 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
           ELSE
           IF WSS-COD-CPTO IN WSS-VARI = WSS-COD-READ IN WSS-VARI
             MOVE CPP-IND-DBHB (CPP-I) TO VEC-IND-DBHB (MOV-I)
             MOVE CPP-MSC-TCCT (CPP-I) TO VEC-MSC-TCCT (MOV-I)
             IF WSS-MSC-TVOC NOT = '1'
               MOVE WSS-VAL-READ0 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
             ELSE
               MOVE WSS-VAL-READ2 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
           ELSE
           IF WSS-COD-CPTO IN WSS-VARI = WSS-COD-INTO IN WSS-VARI
             MOVE CPP-IND-DBHB (CPP-I) TO VEC-IND-DBHB (MOV-I)
             MOVE CPP-MSC-TCCT (CPP-I) TO VEC-MSC-TCCT (MOV-I)
             IF WSS-MSC-TVOC NOT = '1'
               MOVE WSS-VAL-INTO0 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
             ELSE
               MOVE WSS-VAL-INTO2 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
           ELSE
           IF WSS-COD-CPTO IN WSS-VARI = WSS-COD-REAO IN WSS-VARI
             MOVE CPP-IND-DBHB (CPP-I) TO VEC-IND-DBHB (MOV-I)
             MOVE CPP-MSC-TCCT (CPP-I) TO VEC-MSC-TCCT (MOV-I)
             IF WSS-MSC-TVOC NOT = '1'
               MOVE WSS-VAL-REAO0 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
             ELSE
               MOVE WSS-VAL-REAO2 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
           ELSE
           IF WSS-COD-CPTO IN WSS-VARI = WSS-COD-INTM IN WSS-VARI
             MOVE CPP-IND-DBHB (CPP-I) TO VEC-IND-DBHB (MOV-I)
             MOVE CPP-MSC-TCCT (CPP-I) TO VEC-MSC-TCCT (MOV-I)
             IF WSS-MSC-TVOC NOT = '1'
               MOVE WSS-VAL-INTM0 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
             ELSE
               MOVE WSS-VAL-INTM2 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
           ELSE
           IF WSS-COD-CPTO IN WSS-VARI = WSS-COD-REAM IN WSS-VARI
             MOVE CPP-IND-DBHB (CPP-I) TO VEC-IND-DBHB (MOV-I)
             MOVE CPP-MSC-TCCT (CPP-I) TO VEC-MSC-TCCT (MOV-I)
             IF WSS-MSC-TVOC NOT = '1'
               MOVE WSS-VAL-REAM0 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
             ELSE
               MOVE WSS-VAL-REAM2 IN WSS-VARI TO VEC-SGV-ICTB (MOV-I)
           ELSE
             ADD 1 TO CPP-I
             GO TO SIGUE1-CREA-REGISTRO-DVG.

      *DPM ini  11-AUG-1997 Grabar OPC con montos devengados en cero
           IF VEC-SGV-ICTB (MOV-I) = ZEROES
               ADD 1 TO CPP-I
               GO TO SIGUE1-CREA-REGISTRO-DVG.

           ADD 1 TO WSS-NUM-RDVG IN WSS-VARI.
      *DPM fin  11-AUG-1997

      *Obtiene cuenta contable de tabla DCC
           PERFORM OBT-CUENTA-DCC.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-CREA-REGISTRO-DVG.

           MOVE DCC-GLS-CCSB IN DCC TO VEC-CIC-CCSB (MOV-I).
           ADD 1 TO CPP-I.
           ADD 1 TO MOV-I.
           GO TO SIGUE1-CREA-REGISTRO-DVG.

       SIGUE2-CREA-REGISTRO-DVG.
           SUBTRACT 1 FROM MOV-I.
           MOVE MOV-I TO MOV-TOPE.
           MOVE 1     TO MOV-I.

       SIGUE3-CREA-REGISTRO-DVG.
           IF MOV-I > MOV-TOPE
               PERFORM GRABA-REG-CAP
               GO TO FIN-CREA-REGISTRO-DVG.

           IF VEC-SGV-ICTB (MOV-I) =  ZEROES
               ADD 1 TO MOV-I
               GO TO SIGUE3-CREA-REGISTRO-DVG.

      *INI-JGM 10-03-1998.
           IF VEC-SGV-ICTB (MOV-I) NOT > ZEROES
                  MULTIPLY VEC-SGV-ICTB (MOV-I)
                  BY -1 GIVING VEC-SGV-ICTB (MOV-I)
              IF VEC-IND-DBHB (MOV-I) = 'D'
                  MOVE 'H'   TO VEC-IND-DBHB (MOV-I)
                ELSE
                  MOVE 'D'   TO VEC-IND-DBHB (MOV-I).
      *FIN-JGM 10-03-1998.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CPTO:    MONTO: '
                   VEC-MSC-TCCT (MOV-I) '  ' VEC-SGV-ICTB (MOV-I).

           MOVE VEC-MSC-TCCT (MOV-I)          TO DVG-MSC-TCCT IN DVG.
           MOVE VEC-CIC-CCSB (MOV-I)          TO DVG-CIC-CCSB IN DVG.
           MOVE VEC-IND-DBHB (MOV-I)          TO DVG-IND-DBHB IN DVG.
           MOVE VEC-SGV-ICTB (MOV-I)          TO DVG-SGV-ICTB IN DVG.

           MOVE 'DVG'                         TO DVG-COD-MVTO IN DVG.
           MOVE WSS-FEC-FTRA IN WSS-VARI      TO DVG-FEC-FPRO IN DVG.
           MOVE OPC-COD-VCOC IN OPC           TO DVG-COD-VCOC IN DVG.
           MOVE OPC-COD-OFOC IN OPC           TO DVG-COD-OFOC IN DVG.
           MOVE OPC-COD-COOC IN OPC           TO DVG-COD-COOC IN DVG.
           MOVE WSS-FEC-FTRA IN WSS-VARI      TO DVG-FEC-FCTB IN DVG.
           MOVE OPC-CIC-IOPC IN OPC           TO DVG-CIC-IOPC IN DVG.
           MOVE DLC-NUM-IDLC IN DLC           TO DVG-NUM-IDLC IN DVG.

      * DPM ini  13-OCT-1997 Se graba VEN mas antiguo
      *     MOVE VEN-FEC-FVEN IN VEN           TO DVG-FEC-FVEN IN DVG.
           MOVE WSS-VEN-FPRI IN WSS-VARI      TO DVG-FEC-FVEN IN DVG.
      * DPM fin  13-OCT-1997

      *DPM ini  1-AUG-1997 Se graba FDEV para no leer la tabla DLC
      * en el programa listador COLPLDVG
           MOVE DLC-FEC-FDEV IN DLC           TO DVG-FEC-FDEV IN DVG.
           MOVE WSS-FEC-FCOL IN WSS-VARI      TO DVG-FEC-FCOL IN DVG.
           MOVE DLC-IND-SCBZ IN DLC           TO DVG-IND-SCBZ IN DVG.
           MOVE DLC-IND-SCRT IN DLC           TO DVG-IND-SCRT IN DVG.
           MOVE DLC-IND-SCTB IN DLC           TO DVG-IND-SCTB IN DVG.
           MOVE DLC-COD-PLZO IN DLC           TO DVG-COD-PLZO IN DVG.
           MOVE DLC-IND-SCTB IN DLC           TO DVG-IND-SCTB IN DVG.
           MOVE OPC-VAL-SCRE IN OPC           TO DVG-VAL-SCRE IN DVG.
      *DPM fin  1-AUG-1997
           MOVE SPACES                        TO DVG-GLS-DISP IN DVG.

      *RVM-BCI-INI 14-APR-1998
           MOVE DLC-FEC-FMAV IN DLC           TO DVG-FEC-FMAV IN DVG.
           MOVE OPC-FEC-FINP IN OPC           TO DVG-FEC-FINP IN DVG.
           MOVE ZEROES                        TO DVG-SGV-FCOL IN DVG.
           MOVE OPC-VAL-CRED IN OPC           TO DVG-VAL-CRED IN DVG.
           MOVE OPC-COD-CDOC IN OPC           TO DVG-COD-CDOC IN DVG.
           MOVE OPC-IND-GARA IN OPC           TO DVG-IND-GARA IN DVG.
           MOVE OPC-NUM-VCOR IN OPC           TO DVG-NUM-VCOR IN DVG.
      *RVM-BCI-FIN 14-APR-1998
      *INI-JGM 28-03-2000.
           MOVE OPC-NUM-VCVG IN OPC           TO DVG-NUM-VCVG IN DVG.
      *FIN-JGM 28-03-2000.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-DVG.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-REDV IN WSS-VARI
              DISPLAY 'DVGNOGRABA'
              MOVE 'DVGNOGRABA'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              DISPLAY 'ERROR EN WRITE DVG: ' OPC-CIC-IOPC IN OPC
           ELSE
              ADD 1 TO WSS-NUM-DOPC IN WSS-VARI
              ADD 1 TO MOV-I
              GO TO SIGUE3-CREA-REGISTRO-DVG.
       FIN-CREA-REGISTRO-DVG.
           EXIT.

       GRABA-REG-CAP SECTION.
      *---------------------*
       INI-GRABA-REG-CAP.
           IF WSS-NUM-RDVG IN WSS-VARI > ZEROES
               MOVE ZEROES TO WSS-NUM-RDVG IN WSS-VARI
               GO TO FIN-GRABA-REG-CAP.

           MOVE 'DVG'                    TO DVG-COD-MVTO IN DVG.
           MOVE 'CAP'                    TO DVG-MSC-TCCT IN DVG.
           MOVE SPACES                   TO DVG-CIC-CCSB IN DVG.
           MOVE 'D'                      TO DVG-IND-DBHB IN DVG.
           MOVE ZEROES                   TO DVG-SGV-ICTB IN DVG.
           MOVE WSS-FEC-FTRA IN WSS-VARI TO DVG-FEC-FPRO IN DVG.
           MOVE OPC-COD-VCOC IN OPC      TO DVG-COD-VCOC IN DVG.
           MOVE OPC-COD-OFOC IN OPC      TO DVG-COD-OFOC IN DVG.
           MOVE OPC-COD-COOC IN OPC      TO DVG-COD-COOC IN DVG.
           MOVE WSS-FEC-FTRA IN WSS-VARI TO DVG-FEC-FCTB IN DVG.
           MOVE OPC-CIC-IOPC IN OPC      TO DVG-CIC-IOPC IN DVG.
           MOVE DLC-NUM-IDLC IN DLC      TO DVG-NUM-IDLC IN DVG.
           MOVE OPC-VAL-SCRE IN OPC      TO DVG-VAL-SCRE IN DVG.
           MOVE VEN-FEC-FVEN IN VEN      TO DVG-FEC-FVEN IN DVG.
           MOVE DLC-FEC-FDEV IN DLC      TO DVG-FEC-FDEV IN DVG.
           MOVE WSS-FEC-FCOL IN WSS-VARI TO DVG-FEC-FCOL IN DVG.
           MOVE DLC-IND-SCBZ IN DLC      TO DVG-IND-SCBZ IN DVG.
           MOVE DLC-IND-SCRT IN DLC      TO DVG-IND-SCRT IN DVG.
           MOVE DLC-IND-SCTB IN DLC      TO DVG-IND-SCTB IN DVG.
           MOVE DLC-COD-PLZO IN DLC      TO DVG-COD-PLZO IN DVG.
           MOVE DLC-IND-SCTB IN DLC      TO DVG-IND-SCTB IN DVG.
           MOVE SPACES                   TO DVG-GLS-DISP IN DVG.
      *RVM-BCI-INI 14-APR-1998
           MOVE DLC-FEC-FMAV IN DLC      TO DVG-FEC-FMAV IN DVG.
           MOVE OPC-FEC-FINP IN OPC      TO DVG-FEC-FINP IN DVG.
           MOVE ZEROES                   TO DVG-SGV-FCOL IN DVG.
           MOVE OPC-VAL-CRED IN OPC      TO DVG-VAL-CRED IN DVG.
           MOVE OPC-COD-CDOC IN OPC      TO DVG-COD-CDOC IN DVG.
           MOVE OPC-IND-GARA IN OPC      TO DVG-IND-GARA IN DVG.
      *RVM-BCI-FIN 14-APR-1998
      *INI-JGM 28-03-2000.
           MOVE OPC-NUM-VCVG IN OPC      TO DVG-NUM-VCVG IN DVG.
      *FIN-JGM 28-03-2000.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-DVG.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-REDV IN WSS-VARI
              DISPLAY 'DVGNOGRABA'
              MOVE 'DVGNOGRABA'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              DISPLAY 'ERROR EN WRITE DVG: ' OPC-CIC-IOPC IN OPC
           ELSE
              ADD 1 TO WSS-NUM-DOPC IN WSS-VARI
              ADD 1 TO MOV-I.
       FIN-GRABA-REG-CAP.
           EXIT.


       LIMPIA-VEC-DVG SECTION.
      *----------------------*
       INI-LIMPIA-VEC-DVG.
           MOVE 1 TO MOV-I.

       LUP-LIMPIA-VEC-DVG.
           IF MOV-I > 40
               MOVE 1 TO MOV-I
               GO TO FIN-LIMPIA-VEC-DVG.

           MOVE SPACES TO VEC-MSC-TCCT (MOV-I).
           MOVE SPACES TO VEC-CIC-CCSB (MOV-I).
           MOVE SPACES TO VEC-IND-DBHB (MOV-I).
           MOVE ZEROES TO VEC-SGV-ICTB (MOV-I).

           ADD 1 TO MOV-I.
           GO TO LUP-LIMPIA-VEC-DVG.
       FIN-LIMPIA-VEC-DVG.
           EXIT.


       OBT-CPTO-ALG SECTION.
      *--------------------*
       INI-OBT-CPTO-ALG.
            MOVE 'COL'                TO FIO-SIST.
            MOVE 'ALG'                TO TAB-COD-TTAB.
            MOVE CPP-IND-TALG (CPP-I) TO TAB-COD-CTAB.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF NOT (FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S')
               DISPLAY 'ERROR, ALGCICINEX ' CPP-KEY-IREG IN CPP
                       ' OPC: ' OPC-CIC-IOPC IN OPC
               MOVE 'ALGCICINEX'  TO ERC-COD-MSGE IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-OBT-CPTO-ALG.
            MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-CPTO IN WSS-VARI.
       FIN-OBT-CPTO-ALG.
           EXIT.


       OBT-CPTO-CTA SECTION.
      *--------------------*
       INI-OBT-CPTO-CTA.
           MOVE 'DVG'               TO CPP-COD-MVTO IN CPP.
           MOVE OPC-COD-VCOC IN OPC TO CPP-COD-VCOC IN CPP.
           MOVE OPC-COD-COOC IN OPC TO CPP-COD-COOC IN CPP.
           MOVE DLC-IND-SCRT IN DLC TO CPP-IND-SCRT IN CPP.
           MOVE DLC-IND-SCTB IN DLC TO CPP-IND-SCTB IN CPP.
           IF CPP-IND-SCTB IN CPP = 'MUL'
              MOVE SPACES TO CPP-IND-SCTB IN CPP.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-CPP.
           IF NOT FIO-STAT-OKS
              MOVE '*  ' TO CPP-COD-AOOC IN CPP
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-CPP
              IF NOT FIO-STAT-OKS
                 MOVE '*     ' TO CPP-COD-VCOC IN CPP
                 MOVE OPC-COD-AOOC IN OPC TO CPP-COD-AOOC IN CPP
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM COL-FIO-CPP
                 IF NOT FIO-STAT-OKS
                   MOVE '*  ' TO CPP-COD-AOOC IN CPP
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-CPP
                   IF NOT FIO-STAT-OKS
                     MOVE 'CPP    NEX' TO MSG-COD-MENS
                     DISPLAY 'ERROR, CPP    NEX : ' CPP-KEY-ICPP IN CPP
                             ' OPC: ' OPC-CIC-IOPC IN OPC
                     MOVE 'CPP    NEX' TO ERC-COD-MSGE IN ERC
                     MOVE CPP-KEY-ICPP IN CPP TO ERC-GLS-DISP IN ERC
                     PERFORM GRABAR-ERROR
                     GO TO FIN-OBT-CPTO-CTA.
       FIN-OBT-CPTO-CTA.
           EXIT.


       OBT-CUENTA-DCC SECTION.
      *----------------------*
       INI-OBT-CUENTA-DCC.
           MOVE 'DCC'                TO DCC-COD-TTAB IN DCC.
           MOVE CPP-MSC-TCCT (CPP-I) TO DCC-MSC-TCCT IN DCC.
           MOVE OPC-COD-VCOC IN OPC  TO DCC-COD-VCAM IN DCC.
           MOVE OPC-COD-COOC IN OPC  TO DCC-COD-COCR IN DCC.
           MOVE DLC-COD-PLZO IN DLC  TO DCC-COD-PLZO IN DCC.
           MOVE DLC-IND-SCRT IN DLC  TO DCC-IND-SCRT IN DCC.
           MOVE DLC-IND-SCTB IN DLC  TO DCC-IND-SCTB IN DCC.
           MOVE DLC-IND-SCBZ IN DLC  TO DCC-IND-SCBZ IN DCC.
           IF DCC-IND-SCTB IN DCC = 'MUL'
              MOVE SPACES TO DCC-IND-SCTB IN DCC.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DCC.
           IF NOT FIO-STAT-OKS
              MOVE '* ' TO DCC-COD-PLZO IN DCC
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-DCC
              IF NOT FIO-STAT-OKS
                 MOVE '*     ' TO DCC-COD-COCR IN DCC
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM COL-FIO-DCC
                 IF NOT FIO-STAT-OKS
                    ADD 1 TO WSS-NUM-REDV IN WSS-VARI
                    MOVE 'DCC    NEX'       TO MSG-COD-MENS
                    DISPLAY 'ERROR, DCC INEXISTENTE ' DCC-KEY-IREG
                             OPC-CIC-IOPC IN OPC
                    MOVE 'DCC    NEX'  TO ERC-COD-MSGE IN ERC
                    MOVE DCC-KEY-IREG IN DCC TO ERC-GLS-DISP IN ERC
                    PERFORM GRABAR-ERROR
                    GO TO FIN-OBT-CUENTA-DCC.
       FIN-OBT-CUENTA-DCC.
           EXIT.


       GRABAR-ERROR SECTION.
      *--------------------*
       INI-GRABAR-ERROR.
           MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC.
           MOVE OPC-COD-OFOC IN OPC TO ERC-COD-OFIC IN ERC.
           MOVE 'DVG'               TO ERC-COD-EVEN IN ERC.
           MOVE 'BIC'               TO ERC-COD-PGRM IN ERC.
           MOVE ZEROES              TO ERC-NUM-CANC IN ERC.
           MOVE ZEROES              TO ERC-VAL-MNTO IN ERC.
      *     MOVE SPACES              TO ERC-GLS-DISP IN ERC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ERC.
           MOVE SPACES              TO ERC-GLS-DISP IN ERC.
       FIN-GRABAR-ERROR.
           EXIT.
      *DPM fin  29-OCT-1996 BCI


       LEE-CAN-ASOCIA-VEN SECTION.
      *--------------------------*
           MOVE 'N' TO WSS-IND-CAN IN WSS-VARI.
       FIN-LEE-CAN-ASOCIA-VEN.
      *----------------------*
           EXIT.

       PRO-DEV-OTRA-SIT SECTION.
      *------------------------*
       INI-PRO-OTRA-SIT.
      *----------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRE A PRO-DEV-OTRA-SIT'.
      *  Si situacion Contable = CASA o CASE Termina
           IF VEN-IND-SCTB IN VEN = 'CAS'
              GO TO FIN-PRO-DEV-OTRA-SIT.

           MOVE VEN-VAL-SCAP IN VEN TO WSS-SUM-VCAP IN WSS-VARI.

      * Si Nro.de Vencimientos Vigente es mayor que 1 se procesaran
      * Varios Vencimientos
           IF OPC-NUM-VCVG IN OPC > 1
              MOVE 'M' TO WSS-TIPO-DEV IN WSS-VARI
              PERFORM PRO-VARIOS-VENCI
              GO TO FIN-PRO-DEV-OTRA-SIT.

      * Lee Ultimo Registro CAN asociado al Reg.VEN
           PERFORM LEE-CAN-ASOCIA-VEN.
           IF WSS-IND-CAN IN WSS-VARI NOT = 'S'
      *     Si no existe CAN asociada al Reg.VEN o Cod.CAN distinto
      *     de CIE, calcula mora desde Fec.Vencimiento
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
           ELSE
      *     Si existe CAN asociada al Reg.VEN y Cod.CAN es 'CIE'
      *     calculo Mora desde Fec.Cancelacion
              MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.

           MOVE 'M' TO WSS-TIPO-DEV IN WSS-VARI.
           PERFORM CALCULA-INT-REA-MORA.
      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT ( FIO-STAT-OKS AND
                    MOR-CMSG IN MOR-VARI = SPACES )
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR CALCULA-INT-REA-MORA: '
                        OPC-CIC-IOPC IN OPC ' ' FIO-STAT
      *        MOVE MOR-CMSG IN MOR-VARI TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-DEV-OTRA-SIT.
      *DPM fin  4-NOV-1996

           PERFORM GRABA-REG-DLC.

       FIN-PRO-DEV-OTRA-SIT.
      *--------------------*
           EXIT.

       PRO-SUSP-DEVENGO-11 SECTION.
      *---------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ENTRA A PRO-SUSP-DEVENGO-11'.
       INI-PRO-SUSP-DEVENGO-11.
      *-----------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY WSS-IND-SCTB IN WSS-VARI.
           IF WSS-IND-SCTB IN WSS-VARI NOT = 'MOR'
              PERFORM PRO-DEV-OTRA-SIT
              GO TO FIN-PRO-SUSP-DEVENGO-11.

           MOVE VEN-VAL-SCAP IN VEN TO WSS-SUM-VCAP IN WSS-VARI.

      * Si Nro.de Vencimientos Vigente es mayor que 1 se procesaran
      * Varios Vencimientos
           IF OPC-NUM-VCVG IN OPC > 1
              MOVE 'S' TO WSS-TIPO-DEV IN WSS-VARI
              PERFORM PRO-SUSP-DEVENGO-12
              GO TO FIN-PRO-SUSP-DEVENGO-11.

      * Lee Ultimo Registro CAN asociado al Reg.VEN
           PERFORM LEE-CAN-ASOCIA-VEN.
           IF WSS-IND-CAN IN WSS-VARI NOT = 'S'
      *     Si no existe CAN asociada al Reg.VEN o Cod.CAN distinto
      *     de CIE, calcula mora desde Fec.Vencimiento
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
           ELSE
      *     Si existe CAN asociada al Reg.VEN y Cod.CAN es 'CIE'
      *     calculo Mora desde Fec.Cancelacion
              MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.

           PERFORM CALCULA-11.
      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR CALCULA-11: '
                      OPC-CIC-IOPC IN OPC ' ' FIO-STAT
      *        MOVE 'CALCULA-11'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-11.
      *DPM fin  4-NOV-1996

           PERFORM GRABA-REG-DLC.

       FIN-PRO-SUSP-DEVENGO-11.
      *-----------------------*
           EXIT.

       CALCULA-11 SECTION.
      *------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A CALCULA-11'.
       INI-CALCULA-11.
      *--------------*
              MOVE 1 TO WSS-VAL-UFSU IN WSS-VARI
                        WSS-VAL-UFVE IN WSS-VARI.
      *    Prepara Fechas de Parametros para calculo de Tasa Periodo
      * TP1 o TP4
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'WSS-FEC-FSUS: ' WSS-FEC-FSUS IN WSS-VARI
              DISPLAY 'WSS-IND-CALC: ' WSS-IND-CALC IN WSS-VARI.

           IF WSS-IND-CALC IN WSS-VARI = '16'
      *       Muevo FADV a fecha Uno.
              MOVE WSS-NUM-DADV IN WSS-VARI TO INT-DUNO IN INT-VARI
              MOVE WSS-NUM-MADV IN WSS-VARI TO INT-MUNO IN INT-VARI
              MOVE WSS-NUM-SADV IN WSS-VARI TO INT-SUNO IN INT-VARI
              MOVE WSS-NUM-AADV IN WSS-VARI TO INT-AUNO IN INT-VARI
      *    Muevo FSUS a fecha Dos.
              MOVE WSS-NUM-DSUS IN WSS-VARI TO INT-DDOS IN INT-VARI
              MOVE WSS-NUM-MSUS IN WSS-VARI TO INT-MDOS IN INT-VARI
              MOVE WSS-NUM-SSUS IN WSS-VARI TO INT-SDOS IN INT-VARI
              MOVE WSS-NUM-ASUS IN WSS-VARI TO INT-ADOS IN INT-VARI
           ELSE
             IF WSS-IND-CALC IN WSS-VARI = '06'
      *       Muevo FTRA a fecha Dos.
      * Preparo Parametros para obtener dia siguiente a FPRO.
               MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-ITM1
               MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-ITM2
               MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-ITM3
               MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-ITM4
               MOVE FEC-SUM-DIA  TO FEC-CMND
               MOVE 1            TO FEC-NDIA
               PERFORM CAL-FEC

      *    Muevo FPRO+1 a fecha uno.
               MOVE FEC-ITM1 TO INT-DDOS IN INT-VARI
               MOVE FEC-ITM2 TO INT-MDOS IN INT-VARI
               MOVE FEC-ITM3 TO INT-SDOS IN INT-VARI
               MOVE FEC-ITM4 TO INT-ADOS IN INT-VARI

      *     DISPLAY 'FECHA 2 TP: ' INT-FDOS IN INT-VARI

               MOVE DLC-NUM-DDEV IN DLC      TO INT-DUNO IN INT-VARI
               MOVE DLC-NUM-MDEV IN DLC      TO INT-MUNO IN INT-VARI
               MOVE DLC-NUM-SDEV IN DLC      TO INT-SUNO IN INT-VARI
               MOVE DLC-NUM-ADEV IN DLC      TO INT-AUNO IN INT-VARI
             ELSE
      *        Muevo FSUS a fecha Dos.
               MOVE WSS-NUM-DSUS IN WSS-VARI TO INT-DUNO IN INT-VARI
               MOVE WSS-NUM-MSUS IN WSS-VARI TO INT-MUNO IN INT-VARI
               MOVE WSS-NUM-SSUS IN WSS-VARI TO INT-SUNO IN INT-VARI
               MOVE WSS-NUM-ASUS IN WSS-VARI TO INT-AUNO IN INT-VARI

               MOVE VEN-NUM-DVEN IN VEN      TO INT-DDOS IN INT-VARI
               MOVE VEN-NUM-MVEN IN VEN      TO INT-MDOS IN INT-VARI
               MOVE VEN-NUM-SVEN IN VEN      TO INT-SDOS IN INT-VARI
               MOVE VEN-NUM-AVEN IN VEN      TO INT-ADOS IN INT-VARI.

      *     MOVE SPACES TO WSS-IND-CALC IN WSS-VARI.

      *    Muevo Valor de Cambio
           MOVE WSS-COD-MONEDA IN WSS-VARI TO INT-VCAM IN INT-VARI.
      *    Muevo Identificacion de la Operacion
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC IN INT-VARI.
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC IN INT-VARI.
      *
           MOVE ZEROES TO INT-SEVE IN INT-VARI.
           MOVE SPACES TO INT-TCVF IN INT-VARI.
      *
      ************************************************************
           MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI.
           PERFORM LEE-VEN-ANT.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE DLC-FEC-FDEV IN DLC TO WSS-VEN-FANT IN WSS-VARI
           ELSE
               MOVE VEN-FEC-FVEN IN VEN TO WSS-VEN-FANT IN WSS-VARI.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.

           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FSUS IN WSS-VARI
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
                              WSS-VAL-IO IN WSS-VARI
                              VAL-ROR IN VAL-VARI
                              WSS-VAL-CAPI IN WSS-VARI
               MOVE 'S' TO WSS-JUS IN WSS-VARI
           ELSE
           IF WSS-FEC-FSUS IN WSS-VARI < DLC-FEC-FDEV IN DLC
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
                              VAL-I IN VAL-VARI

      * DPM ini  18-FEB-1998 Si SFIN > SCAP calcula INT por diferencia,
      * en caso contrario, INT = 0
      *         SUBTRACT VEN-VAL-SCAP IN VEN FROM
      *                  VEN-VAL-SFIN IN VEN GIVING
      *                  WSS-VAL-IO IN WSS-VARI

               IF VEN-VAL-SFIN IN VEN > VEN-VAL-SCAP IN VEN
                   SUBTRACT VEN-VAL-SCAP IN VEN FROM
                            VEN-VAL-SFIN IN VEN GIVING
                            WSS-VAL-IO IN WSS-VARI
               ELSE
                   MOVE ZEROES TO WSS-VAL-IO IN WSS-VARI
      * DPM fin  18-FEB-1998

           ELSE
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE ZEROES TO INT-TIPE IN INT-VARI
                              INT-TINC IN INT-VARI
               SUBTRACT VEN-VAL-SCAP IN VEN FROM
                        VEN-VAL-SFIN IN VEN GIVING
                        WSS-VAL-INTE IN WSS-VARI
               PERFORM OBT-DIF-FECHAS-A
               PERFORM OBT-DIF-FECHAS-C
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   GO TO FIN-CALCULA-11
               ELSE
                   COMPUTE WSS-VAL-IO IN WSS-VARI =
                           WSS-VAL-INTE IN WSS-VARI *
                           WSS-VAL-D IN WSS-VARI /
                           WSS-VAL-A IN WSS-VARI
           ELSE
               MOVE INT-DUNO TO WSS-NUM-D1
               MOVE INT-MUNO TO WSS-NUM-M1
               MOVE INT-SUNO TO WSS-NUM-S1
               MOVE INT-AUNO TO WSS-NUM-A1

               MOVE INT-DDOS TO WSS-NUM-D2
               MOVE INT-MDOS TO WSS-NUM-M2
               MOVE INT-SDOS TO WSS-NUM-S2
               MOVE INT-ADOS TO WSS-NUM-A2

               PERFORM LEE-ICG
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   DISPLAY 'ERROR LECTURA ICG PARA LLAVE '
                                              OPC-CIC-IOPC IN OPC
                   MOVE 'OPC  NOICG' TO ERC-COD-MSGE IN ERC
                   GO TO FIN-CALCULA-11
               ELSE
               IF VEN-FEC-FVEN IN VEN > WSS-FEC-FSUS IN WSS-VARI AND
                  WSS-FEC-FVEN IN WSS-VARI NOT >
                                            WSS-FEC-FSUS IN WSS-VARI
                   MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FINT IN WSS-VARI

      * DPM ini  12-DEC-1997 Determina si es balance o prebalance para
      * utilizar las fechas correspondientes en busqueda de tasa
                   PERFORM DET-SI-BALANCE
      * DPM fin  12-DEC-1997

                   MOVE 'N' TO WSS-PVEZ IN WSS-VARI

                   IF DLC-FEC-FDEV IN DLC > WSS-FEC-FTRA IN WSS-VARI OR
                      WSS-FEC-F1 IN WSS-VARI > WSS-FEC-F2 IN WSS-VARI
                       MOVE ZEROES TO INT-TIPE IN INT-VARI
                                      INT-TINC IN INT-VARI
                   ELSE
                       PERFORM COL-CAL-INT
                       IF INT-CMSG > SPACES
                           ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                           MOVE 'COL'          TO MSG-COD-SIST
                           MOVE INT-CMSG       TO MSG-COD-MENS
                           PERFORM GET-MSG
                           DISPLAY 'ERROR ' MSG-GLS-DESC ' '
                                            INT-MEN2
                           MOVE INT-CMSG TO ERC-COD-MSGE IN ERC
                           GO TO FIN-CALCULA-11
                       ELSE
                           NEXT SENTENCE
               ELSE
               IF VEN-FEC-FVEN IN VEN > WSS-FEC-FSUS IN WSS-VARI
                   MOVE ZEROES TO VAL-I IN VAL-VARI
      * Calcula TPV = VF - Kc
                   IF WSS-OPEC IN WSS-VARI = 'B'
                       MOVE VEN-VAL-SFIN IN VEN TO
                                        WSS-VAL-CAPI IN WSS-VARI
      * Calcula: IOR = TPV - I      ( I = 0 ==> IOR = TPV )
      *
                       MOVE WSS-VAL-CAPI IN WSS-VARI TO
                                             VAL-IOR IN VAL-VARI
                   ELSE
      * DPM ini  18-FEB-1998 Si SFIN > SCAP calcula INT por diferencia,
      * en caso contrario, INT = 0
      *                 SUBTRACT VEN-VAL-SCAP IN VEN FROM
      *                                       VEN-VAL-SFIN IN VEN
      *                           GIVING WSS-VAL-CAPI IN WSS-VARI
      * Calcula: IOR = TPV - I      ( I = 0 ==> IOR = TPV )
      *
      *                 MOVE WSS-VAL-CAPI IN WSS-VARI TO
      *                                       VAL-IOR IN VAL-VARI.

                   IF VEN-VAL-SFIN IN VEN > VEN-VAL-SCAP IN VEN
                       SUBTRACT VEN-VAL-SCAP IN VEN FROM
                                VEN-VAL-SFIN IN VEN GIVING
                                WSS-VAL-CAPI IN WSS-VARI
      * Calcula: IOR = TPV - I      ( I = 0 ==> IOR = TPV )
      *
                       MOVE WSS-VAL-CAPI IN WSS-VARI TO
                                             VAL-IOR IN VAL-VARI
                   ELSE
                       MOVE ZEROES TO WSS-VAL-CAPI IN WSS-VARI
      * Calcula: IOR = TPV - I      ( I = 0 ==> IOR = TPV )
      *
                       MOVE WSS-VAL-CAPI IN WSS-VARI TO
                                             VAL-IOR IN VAL-VARI.
      * DPM fin  18-FEB-1998

           MOVE INT-TIPE IN INT-VARI TO WSS-TASA IN WSS-VARI.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
      *  Si la operacion es en Moneda Nacional salta
               DISPLAY 'MONEDA: ' WSS-COD-MONEDA IN WSS-VARI
               DISPLAY 'TASA: ' INT-TINC
               DISPLAY 'TASA PERIODO: ' WSS-TASA IN WSS-VARI.


      * Calcula: I OR = K * TP3
      *
           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FSUS IN WSS-VARI
               MOVE WSS-VAL-IO IN WSS-VARI TO
                                  VAL-IOR IN VAL-VARI
           ELSE
           IF WSS-FEC-FSUS IN WSS-VARI < DLC-FEC-FDEV IN DLC
               MOVE WSS-VAL-IO IN WSS-VARI TO VAL-IOR IN VAL-VARI
           ELSE
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE WSS-VAL-IO IN WSS-VARI TO VAL-IOR IN VAL-VARI
           ELSE
      *     IF VEN-FEC-FVEN IN VEN > WSS-FEC-FSUS IN WSS-VARI AND
      *        WSS-FEC-FVEN IN WSS-VARI NOT > WSS-FEC-FSUS IN WSS-VARI
              SUBTRACT WSS-SUM-VCAP IN WSS-VARI FROM
                                       OPC-VAL-SCRE IN OPC
                                GIVING WSS-VAL-RESTO IN WSS-VARI
              ADD VEN-VAL-SCAP IN VEN TO WSS-VAL-RESTO IN WSS-VARI
              MULTIPLY WSS-VAL-RESTO IN WSS-VARI BY INT-TIPE IN INT-VARI
                                  GIVING VAL-IOR IN VAL-VARI ROUNDED.
      *
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'IOR: ' VAL-IOR IN VAL-VARI
              DISPLAY 'MONEDA: ' WSS-COD-MONEDA IN WSS-VARI.

      * Calcula diferencia en UFs entre FVEN y FSUS. Delta_UF3
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
                             WSS-DELTA-UF3 IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
                             WSS-VAL-UF2 IN WSS-VARI
                             WSS-VAL-UFVE IN WSS-VARI
                             WSS-VAL-UFSU IN WSS-VARI
              GO TO SIGUE-CALCULA-11.

      *    Prepara Lectura para obtener Valor de UF FVEN.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-11.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI
                                       WSS-VAL-UFVE IN WSS-VARI.

      *    Prepara Lectura para obtener Valor de UF FSUS.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
      *     DISPLAY 'WSS-FEC-FSUS (PARA UF): ' WSS-FEC-FSUS IN WSS-VARI.
           MOVE WSS-FEC-FSUS IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-11.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI
                                       WSS-VAL-UFSU IN WSS-VARI.

      *  Calcula Delta_UF3
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM
                                       WSS-VAL-UF1 IN WSS-VARI
                                GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.
           MOVE WSS-DIF-UFS IN WSS-VARI TO WSS-DELTA-UF3 IN WSS-VARI.

       SIGUE-CALCULA-11.
      *----------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'SIGUE-CALCULA-11'
              DISPLAY 'UF(VEN): ' WSS-VAL-UF1 IN WSS-VARI
              DISPLAY 'UF(SUS): ' WSS-VAL-UF2 IN WSS-VARI.
      *
      *    Calcula: R OR = K * Delta_UF3
           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FSUS IN WSS-VARI
               NEXT SENTENCE
           ELSE
               MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-DIF-UFS IN WSS-VARI
                                    GIVING VAL-ROR IN VAL-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ROR: ' VAL-ROR IN VAL-VARI
              DISPLAY 'VEN-VAL-SCAP (Kc): ' VEN-VAL-SCAP IN VEN
              DISPLAY 'VEN-VAL-SFIN (VF): ' VEN-VAL-SFIN IN VEN.

       SIGUE3-CALCULA-11.
      *-----------------*
      *DPM ini  17-DEC-1996
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FSUS IN WSS-VARI AND
              WSS-FEC-FVEN IN WSS-VARI > WSS-FEC-FSUS IN WSS-VARI
               GO TO SIGUE4-CALCULA-11.
      *DPM fin  17-DEC-1996

      * Calcula TPV = VF - Kc
      *DPM ini  8-AUG-1997 Si opera como Bol. Grtia, INT deben ser
      * VEN-VAL-SFIN solamente
           IF WSS-OPEC IN WSS-VARI = 'B'
               MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-CAPI IN WSS-VARI
           ELSE
      * DPM ini  18-FEB-1998 Si SFIN > SCAP calcula INT por diferencia,
      * en caso contrario, INT = 0
      *         SUBTRACT VEN-VAL-SCAP IN VEN FROM VEN-VAL-SFIN IN VEN
      *                               GIVING WSS-VAL-CAPI IN WSS-VARI.
               IF VEN-VAL-SFIN IN VEN > VEN-VAL-SCAP IN VEN
                   SUBTRACT VEN-VAL-SCAP IN VEN FROM
                            VEN-VAL-SFIN IN VEN GIVING
                            WSS-VAL-CAPI IN WSS-VARI
               ELSE
                   MOVE ZEROES TO WSS-VAL-CAPI IN WSS-VARI.
      * DPM fin  18-FEB-1998
      *DPM fin  8-AUG-1997

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'TPV: ' WSS-VAL-CAPI IN WSS-VARI
              DISPLAY 'IOR: ' VAL-IOR IN VAL-VARI.

      * Calcula: I = TPV - I OR
      *
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FSUS IN WSS-VARI AND
              WSS-FEC-FSUS IN WSS-VARI < DLC-FEC-FDEV IN DLC
               MOVE ZEROES TO VAL-I IN VAL-VARI
           ELSE
               SUBTRACT VAL-IOR IN VAL-VARI FROM
                                   WSS-VAL-CAPI IN WSS-VARI
                                   GIVING VAL-I IN VAL-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'I: ' VAL-I IN VAL-VARI.
      *

       SIGUE4-CALCULA-11.
      * Calcula diferencia en UFs entre FSUS y FCOL Delta_UF1
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
                             WSS-VAL-UF2 IN WSS-VARI
                             WSS-VAL-UFCO IN WSS-VARI
              GO TO SIGUE2-CALCULA-11.

      *    Prepara Lectura para obtener Valor de UF FCOL.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).

      *DPM ini  9-DEC-1996
      *     MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1)
      *                                      CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-FEC-FCOL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
      *DPM fin  9-DEC-1996

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-11.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI
                                       WSS-VAL-UFCO IN WSS-VARI.

           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FSUS IN WSS-VARI
      *      Calcula Delta_UFV = UF(VEN)-UF(COL)
              SUBTRACT WSS-VAL-UF1 IN WSS-VARI FROM WSS-VAL-UFVE
              IN WSS-VARI GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED
           ELSE
      *      Calcula Delta_UF1 = UF(SUS)-UF(COL)
              SUBTRACT WSS-VAL-UF1 IN WSS-VARI FROM WSS-VAL-UF2
              IN WSS-VARI GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.

       SIGUE2-CALCULA-11.
      *-----------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'UF1: ' WSS-VAL-UF1 IN WSS-VARI
              DISPLAY 'UF2: ' WSS-VAL-UF2 IN WSS-VARI.
      *
           MOVE 'S' TO WSS-JUS IN WSS-VARI.
           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FSUS IN WSS-VARI
      *      Va a calcular Delta_UFV que retorna en WSS-DIF-UFS
              MOVE 'N' TO WSS-JUS IN WSS-VARI
              PERFORM CAL-DELTA-UFV
              IF NOT FIO-STAT-OKS
                  ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                  DISPLAY 'ERROR CAL-DELTA-UFV FIO-STAT: ' FIO-STAT
                  GO TO FIN-CALCULA-11.
      *
      *    Calcula: R = K * Delta_UF? (UFV o UF1)
           MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-DIF-UFS IN WSS-VARI
                                  GIVING VAL-R IN VAL-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'Ki       : ' VEN-VAL-SCAP IN VEN
              DISPLAY 'Delta    : ' WSS-DIF-UFS IN WSS-VARI
              DISPLAY 'R        : ' VAL-R IN VAL-VARI
              DISPLAY 'ENTRO IF?: ' WSS-JUS IN WSS-VARI.

      * Invoca a Section que Prepara Parametros y llama a Rutina
      * para Calculo de Interes de Mora. Retornando Tasa en MOR-TIPE.
           PERFORM LLAMA-CAL-INT-MORA.

      *DPM ini  18-DEC-1996
           IF NOT FIO-STAT-OKS OR
              MOR-CMSG IN MOR-VARI > SPACES
               DISPLAY 'ERROR LLAMA-CAL-INT-MORA: '
                    OPC-CIC-IOPC IN OPC ' ' MOR-CMSG IN MOR-VARI
               GO TO FIN-CALCULA-11
           ELSE
               MOVE SPACES TO MOR-CMSG IN MOR-VARI.
      *DPM fin  18-DEC-1996

      *  IM = VF * TPMO
           MULTIPLY VEN-VAL-SFIN IN VEN BY INT-TIPE IN INT-VARI
                                      GIVING VAL-IM IN VAL-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'IM: ' VAL-IM IN VAL-VARI.

      * Calcula diferencia en UFs entre FPRO y WSS-FEC-FCAL.
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
                             WSS-VAL-UFPRO IN WSS-VARI
              GO TO CONT-CALCULA-11.

      *    Prepara Lectura para obtener Valor de UF FPRO.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FTRA IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-11.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI
                                       WSS-VAL-UFPRO IN WSS-VARI.

      *    Prepara Lectura para obtener Valor de UF FCAL.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FCAL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CALCULA-11.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI.

      *  Calcula Delta_UF
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM WSS-VAL-UF1 IN WSS-VARI
                                 GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.

       CONT-CALCULA-11.
      *---------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'CONT-CALCULA-11'
              DISPLAY 'UF1: ' WSS-VAL-UF1 IN WSS-VARI
              DISPLAY 'UF2: ' WSS-VAL-UF2 IN WSS-VARI.

      * RM = VF * Delta_UFMO (o Delta_UFM)
           MULTIPLY VEN-VAL-SFIN IN VEN BY WSS-DIF-UFS IN WSS-VARI
                                    GIVING VAL-RM IN VAL-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'RM: ' VAL-RM IN VAL-VARI.

      * IMORA = IM * UFP
           MULTIPLY VAL-IM IN VAL-VARI BY WSS-VAL-UF1 IN WSS-VARI
                              GIVING WSS-VAL-INTM IN WSS-VARI ROUNDED.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'IMORA: ' WSS-VAL-INTM IN WSS-VARI.

      * RMORA = RM
           MOVE VAL-RM IN VAL-VARI TO WSS-VAL-REAM IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY '* VAL-I: ' VAL-I IN VAL-VARI.

      *
           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FSUS IN WSS-VARI
      *      Calcula: IxC = I * UF(VEN)
              MULTIPLY VAL-I IN VAL-VARI BY WSS-VAL-UFVE IN WSS-VARI
                               GIVING WSS-VAL-INTD IN WSS-VARI ROUNDED
           ELSE
      *      Calcula: IxC = I * UF(FSUS)
              MULTIPLY VAL-I IN VAL-VARI BY WSS-VAL-UFSU IN WSS-VARI
                               GIVING WSS-VAL-INTD IN WSS-VARI ROUNDED
      *      Calcula: REIN = I * Delta_UF3
              MULTIPLY VAL-I IN VAL-VARI BY WSS-DELTA-UF3 IN WSS-VARI
                               GIVING WSS-VAL-REIN IN WSS-VARI ROUNDED.
      *
      *  Calcula: RxC = R
           MOVE VAL-R IN VAL-VARI TO WSS-VAL-READ IN WSS-VARI.

      *  Calcula: R SUS = R OR + REIN
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE VAL-ROR IN VAL-VARI TO WSS-VAL-REAO IN WSS-VARI
           ELSE
              ADD WSS-VAL-REIN IN WSS-VARI TO VAL-ROR IN VAL-VARI GIVING
                               WSS-VAL-REAO IN WSS-VARI ROUNDED.
      *
      *  Calcula: I SUS = I OR * UF(VEN)
           MULTIPLY VAL-IOR IN VAL-VARI BY WSS-VAL-UFVE IN WSS-VARI
                             GIVING WSS-VAL-INTO IN WSS-VARI ROUNDED.

       FIN-CALCULA-11.
      *--------------*
           EXIT.

       PRO-SUSP-DEVENGO-12 SECTION.
      *---------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A PRO-SUSP-DEVENGO-12'.
       INI-PRO-SUSP-DEVENGO-12.
      *-----------------------*
           MOVE 'N' TO WSS-TIPO-DEV IN WSS-VARI.
           MOVE ZEROES TO WSS-SUM-ISU IN WSS-VARI
                          WSS-SUM-RSU IN WSS-VARI
                          WSS-SUM-IMO IN WSS-VARI
                          WSS-SUM-RMO IN WSS-VARI
                          WSS-SUM-IXC IN WSS-VARI
                          WSS-SUM-RXC IN WSS-VARI
      *                    WSS-VAL-PREVEN IN WSS-VARI
                          WSS-VAL-RESTO IN WSS-VARI.
      * Lee Ultimo Registro CAN asociado al Reg.VEN
           PERFORM LEE-CAN-ASOCIA-VEN.
           IF WSS-IND-CAN NOT = 'S'
      *     Si no existe CAN asociada al Reg.VEN o Cod.CAN distinto
      *     de CIE, calcula mora desde Fec.Vencimiento
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
           ELSE
      *     Si existe CAN asociada al Reg.VEN y Cod.CAN es 'CIE'
      *     calculo Mora desde Fec.Cancelacion
              MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.

      *DPM ini  17-DEC-1996
           MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FVEN IN WSS-VARI.
      *DPM fin  17-DEC-1996

       LUP-PRO-SUSP-DEVENGO-12.
      *-----------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'LUP-12, Y ENTRA '
                         'A CALCULA-11 ------------------LUP'.

           PERFORM CALCULA-11.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR CALCULA-11: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
      *        MOVE 'CALCULA-11'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-12.

      *  Acumula valores
           ADD WSS-VAL-INTO IN WSS-VARI TO WSS-SUM-ISU IN WSS-VARI
           ADD WSS-VAL-REAO IN WSS-VARI TO WSS-SUM-RSU IN WSS-VARI.

           ADD WSS-VAL-INTM IN WSS-VARI TO WSS-SUM-IMO IN WSS-VARI.
           ADD WSS-VAL-REAM IN WSS-VARI TO WSS-SUM-RMO IN WSS-VARI.

           ADD WSS-VAL-INTD IN WSS-VARI TO WSS-SUM-IXC IN WSS-VARI.
           ADD WSS-VAL-READ IN WSS-VARI TO WSS-SUM-RXC IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'INTD      : ' WSS-VAL-INTD IN WSS-VARI
              DISPLAY 'INTD(ACUM): ' WSS-SUM-IXC  IN WSS-VARI
              DISPLAY 'READ      : ' WSS-VAL-READ IN WSS-VARI
              DISPLAY 'READ(ACUM): ' WSS-SUM-RXC  IN WSS-VARI

              DISPLAY 'INTO      : ' WSS-VAL-INTO IN WSS-VARI
              DISPLAY 'INTO(ACUM): ' WSS-SUM-ISU  IN WSS-VARI
              DISPLAY 'REAO      : ' WSS-VAL-REAO IN WSS-VARI
              DISPLAY 'REAO(ACUM): ' WSS-SUM-RSU  IN WSS-VARI

              DISPLAY 'INTM      : ' WSS-VAL-INTM IN WSS-VARI
              DISPLAY 'INTM(ACUM): ' WSS-SUM-IMO  IN WSS-VARI
              DISPLAY 'REAM      : ' WSS-VAL-REAM IN WSS-VARI
              DISPLAY 'REAM(ACUM): ' WSS-SUM-RMO  IN WSS-VARI.

      *DPM ini  16-DEC-1996
      *     IF VEN-NUM-IVEN IN VEN = 1
              MOVE VEN-CIC-IOPC IN VEN TO WSS-CIC-VEN IN WSS-VARI.
      *        MOVE FIO-GET-GRT TO FIO-CMND
      *     ELSE
      *DPM fin  16-DEC-1996

      *DPM ini  9-SEP-1997
              MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI.
      *DPM fin  9-SEP-1997

      *DPM ini  3-SEP-1997
       LUP-PRO-SUSP-DEVENGO-12-2.
      *DPM fin  3-SEP-1997
              MOVE FIO-GET-NXT TO FIO-CMND.

           PERFORM COL-FIO-VEN.

      *DPM ini  3-SEP-1997 Si FVEN < FPRO y Saldo VEN = 0, no procesar
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE VEN-FEC-FIMV IN VEN TO VEN-FEC-FVEN IN VEN.

           IF FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = WSS-CIC-VEN IN WSS-VARI AND
              VEN-FEC-FVEN IN VEN < WSS-FEC-FTRA IN WSS-VARI AND
              VEN-VAL-SFIN IN VEN NOT > ZEROES AND
      * DPM ini  24-NOV-1997
              WSS-OPEC IN WSS-VARI NOT = 'B'
      * DPM fin  24-NOV-1997
               GO TO LUP-PRO-SUSP-DEVENGO-12-2.
      *DPM fin  3-SEP-1997

           IF NOT (FIO-STAT-OKS AND VEN-CIC-IOPC IN VEN = WSS-CIC-VEN
                                                          IN WSS-VARI)
      *       Se acabaron vencimientos para OPC
      * DPM ini  27-NOV-1997
              MOVE 'S' TO WSS-IND-ULTI IN WSS-VARI
      * DPM fin  27-NOV-1997
      *DPM ini  16-DIC-1996
      *   Muevo Acumuladores a ser grabados
              MOVE WSS-SUM-IXC IN WSS-VARI TO WSS-VAL-INTD IN WSS-VARI
              MOVE WSS-SUM-RXC IN WSS-VARI TO WSS-VAL-READ IN WSS-VARI
              MOVE WSS-SUM-IMO IN WSS-VARI TO WSS-VAL-INTM IN WSS-VARI
              MOVE WSS-SUM-RMO IN WSS-VARI TO WSS-VAL-REAM IN WSS-VARI
              MOVE WSS-SUM-ISU IN WSS-VARI TO WSS-VAL-INTO IN WSS-VARI
              MOVE WSS-SUM-RSU IN WSS-VARI TO WSS-VAL-REAO IN WSS-VARI
      *DPM ini  9-SEP-1997 Se restaura ultimo VEN correcto para grabar D
              MOVE WSS-CIC-VEN IN WSS-VARI TO VEN-CIC-IOPC IN VEN
              MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-VEN
              IF NOT FIO-STAT-OKS
                  ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                  DISPLAY 'ERROR PRO-SUSP-DEVENGO-12: '
                          OPC-CIC-IOPC IN OPC ' ' FIO-STAT
                  MOVE 'OPC  NOVEN' TO ERC-COD-MSGE IN ERC
                  PERFORM GRABAR-ERROR
                  GO TO FIN-PRO-SUSP-DEVENGO-12
              ELSE
      * DPM ini  25-NOV-1997
              IF OPC-VAL-SCRE IN OPC NOT > WSS-SUM-VCAP IN WSS-VARI
                  MOVE 'N' TO WSS-IND-ULTI IN WSS-VARI
      * DPM fin  25-NOV-1997
                  MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FVEN IN WSS-VARI
      *DPM fin  9-SEP-1997
                  PERFORM GRABA-REG-DLC
      *DPM fin  16-DIC-1996
                  GO TO FIN-PRO-SUSP-DEVENGO-12.

      * DPM ini  27-NOV-1997
      *     IF NOT (WSS-FEC-FTRA IN WSS-VARI > VEN-FEC-FVEN IN VEN)
           IF NOT (WSS-FEC-FTRA IN WSS-VARI > VEN-FEC-FVEN IN VEN) OR
              WSS-IND-ULTI IN WSS-VARI = 'S'
      * DPM fin  27-NOV-1997
               PERFORM PRO-SUSP-DEVENGO-13
               MOVE 'N' TO WSS-IND-ULTI IN WSS-VARI
               GO TO FIN-PRO-SUSP-DEVENGO-12.

      *    Acumula Saldo Cuota de Ven.
           IF WSS-TIPO-DEV IN WSS-VARI = 'N'
      *        MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-PREVEN IN WSS-VARI
              ADD VEN-VAL-SCAP IN VEN TO WSS-SUM-VCAP IN WSS-VARI.
      *INI JUS
      *     IF CAN-MSC-CANC NOT = 'CIE'
      *     Si Cod.CAN distinto de CIE, calcula mora desde Fec.Venc.
      *        MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
      *     ELSE
      *     Si Cod.CAN es 'CIE' calculo Mora desde Fec.Cancelacion
      *        MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.
      *ADD
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI.
      *ADD
      *JUS FIN
           GO TO LUP-PRO-SUSP-DEVENGO-12.

       FIN-PRO-SUSP-DEVENGO-12.
      *-----------------------*
           EXIT.

       PRO-SUSP-DEVENGO-13 SECTION.
      *---------------------------*
           MOVE ZEROES TO WSS-VAL-INTD IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-READ IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-INTO IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-REAO IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-INTM IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-REAM IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A PRO-SUSP-DEVENGO-13'.

      *    Calculo de Saldo Insoluto a la Fecha de Proceso.
      *JUS INI
      *     DISPLAY 'WSS-VAL-PREVEN: ' WSS-VAL-PREVEN IN WSS-VARI.
      *     SUBTRACT WSS-VAL-PREVEN IN WSS-VARI FROM WSS-SUM-VCAP
      *                                              IN WSS-VARI.
           SUBTRACT WSS-SUM-VCAP IN WSS-VARI FROM OPC-VAL-SCRE IN OPC
                                      GIVING WSS-VAL-CAPI IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'WSS-SUM-VCAP: ' WSS-SUM-VCAP IN WSS-VARI
              DISPLAY 'WSS-VAL-CAPI: ' WSS-VAL-CAPI IN WSS-VARI.

      *JUS FIN
      *    Prepara Fechas de Parametros para calculo de Tasa Periodo
      * Obtengo Vencimiento anterior a fecha de Proceso.
      *DPM INI
           IF WSS-IND-ULTI IN WSS-VARI = 'N'
               MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI
               PERFORM LEE-VEN-ANT-FPRO
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                   MOVE DLC-FEC-FDEV IN DLC TO WSS-VEN-FANT IN WSS-VARI
               ELSE
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-VEN-FANT IN WSS-VARI.

           IF WSS-IND-ULTI IN WSS-VARI = 'N'
               MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
               MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN
               PERFORM COL-FIO-VEN.
      *DPM FIN
      *DPM ini  3-SEP-1997 Si FVEN < FPRO y Saldo VEN = 0, no procesar
              IF VEN-FEC-FVEN IN VEN < WSS-FEC-FTRA IN WSS-VARI AND
                 VEN-VAL-SFIN IN VEN NOT > ZEROES AND
      * DPM ini  24-NOV-1997
                 WSS-OPEC IN WSS-VARI NOT = 'B'
      * DPM fin  24-NOV-1997
                  ADD 1 TO WSS-NUM-ROPC IN WSS-VARI
                  DISPLAY 'SALDO VCTO = 0: ' VEN-KEY-IREG IN VEN
                  MOVE 'FSDM>0 VIG'  TO ERC-COD-MSGE IN ERC
                  PERFORM GRABAR-ERROR
                  GO TO FIN-PRO-SUSP-DEVENGO-13.
      *DPM fin  3-SEP-1997

      * DPM ini  17-OCT-1997 Se cambio FVEN actual por FVEN anterior
      * porque no se estaban grabando los INT del ultimo VEN, ya que
      * FUNO era > FDOS para rutina.
      *    Muevo FVEN a fecha Uno.
      *     MOVE VEN-NUM-DVEN IN VEN TO INT-DUNO IN INT-VARI.
      *     MOVE VEN-NUM-MVEN IN VEN TO INT-MUNO IN INT-VARI.
      *     MOVE VEN-NUM-SVEN IN VEN TO INT-SUNO IN INT-VARI.
      *     MOVE VEN-NUM-AVEN IN VEN TO INT-AUNO IN INT-VARI.

      * DPM ini  27-NOV-1997
           IF WSS-IND-ULTI IN WSS-VARI = 'S'
               MOVE VEN-NUM-DVEN IN VEN TO WSS-VEN-DANT IN WSS-VARI
                                           INT-DUNO IN INT-VARI
               MOVE VEN-NUM-MVEN IN VEN TO WSS-VEN-MANT IN WSS-VARI
                                           INT-MUNO IN INT-VARI
               MOVE VEN-NUM-SVEN IN VEN TO WSS-VEN-SANT IN WSS-VARI
                                           INT-SUNO IN INT-VARI
               MOVE VEN-NUM-AVEN IN VEN TO WSS-VEN-AANT IN WSS-VARI
                                           INT-AUNO IN INT-VARI
           ELSE
      * DPM fin  27-NOV-1997
               MOVE WSS-VEN-DANT IN WSS-VARI TO INT-DUNO IN INT-VARI
               MOVE WSS-VEN-MANT IN WSS-VARI TO INT-MUNO IN INT-VARI
               MOVE WSS-VEN-SANT IN WSS-VARI TO INT-SUNO IN INT-VARI
               MOVE WSS-VEN-AANT IN WSS-VARI TO INT-AUNO IN INT-VARI.
      * DPM fin  17-OCT-1997

      * Preparo Parametros para obtener dia siguiente a FPRO.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *     IF NOT FIO-STAT-OKS
           IF NOT FEC-STAT-OKS
              DISPLAY 'ERROR AL SUMAR 1 DIA A FPRO: '
                       WSS-FEC-FTRA IN WSS-VARI ' ' FIO-STAT
                      ' OPC: ' OPC-CIC-IOPC IN OPC
              GO TO FIN-PRO-SUSP-DEVENGO-13.

      *    Muevo FPRO+1 a fecha uno.
           MOVE FEC-ITM1 TO INT-DDOS IN INT-VARI.
           MOVE FEC-ITM2 TO INT-MDOS IN INT-VARI.
           MOVE FEC-ITM3 TO INT-SDOS IN INT-VARI.
           MOVE FEC-ITM4 TO INT-ADOS IN INT-VARI.

      *     DISPLAY 'FECHA 2 TP: ' INT-FDOS IN INT-VARI.

           PERFORM CALCULA-10.
      *DPM ini  4-NOV-1996 Desasterisqueado
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR CALCULA-10: '
                     OPC-CIC-IOPC IN OPC  ' ' FIO-STAT
      *        MOVE 'CALCULA-10'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-13.
      *DPM fin  4-NOV-1996

      * Calcula diferencia en UFs entre FPRO y WSS-FEC-FCAL.
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
              GO TO CON-PRO-SUSP-DEVENGO-13.

      *    Prepara Lectura para obtener Valor de UF FCOL.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).

      *DPM ini  9-DEC-1996
      *     MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1)
      *                                      CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-FEC-FCOL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
      *DPM fin  9-DEC-1996

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
                      ' OPC: ' OPC-CIC-IOPC IN OPC
              GO TO FIN-PRO-SUSP-DEVENGO-13.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI.

           SUBTRACT WSS-VAL-UF1 IN WSS-VARI FROM
                                   WSS-VAL-UF2 IN WSS-VARI
                            GIVING WSS-DIF-UFS IN WSS-VARI.
       CON-PRO-SUSP-DEVENGO-13.
      *-----------------------*
      *  Calcula: R = Ki * Delta_UF1
           MULTIPLY WSS-VAL-CAPI IN WSS-VARI BY WSS-DIF-UFS IN WSS-VARI
                                     GIVING VAL-R IN VAL-VARI ROUNDED.
      *  Asigna: RxC = R
           MOVE VAL-R IN VAL-VARI TO WSS-VAL-READ IN WSS-VARI.


           ADD WSS-VAL-INTO IN WSS-VARI TO WSS-SUM-ISU IN WSS-VARI.
           ADD WSS-VAL-REAO IN WSS-VARI TO WSS-SUM-RSU IN WSS-VARI.
           ADD WSS-VAL-READ IN WSS-VARI TO WSS-SUM-RXC IN WSS-VARI.
           ADD WSS-VAL-INTD IN WSS-VARI TO WSS-SUM-IXC IN WSS-VARI.

      *   Muevo Acumuladores a ser grabados
           MOVE WSS-SUM-ISU IN WSS-VARI TO WSS-VAL-INTO IN WSS-VARI.
           MOVE WSS-SUM-RSU IN WSS-VARI TO WSS-VAL-REAO IN WSS-VARI.
           MOVE WSS-SUM-IMO IN WSS-VARI TO WSS-VAL-INTM IN WSS-VARI.
           MOVE WSS-SUM-RMO IN WSS-VARI TO WSS-VAL-REAM IN WSS-VARI.
           MOVE WSS-SUM-RXC IN WSS-VARI TO WSS-VAL-READ IN WSS-VARI.
           MOVE WSS-SUM-IXC IN WSS-VARI TO WSS-VAL-INTD IN WSS-VARI.

           PERFORM GRABA-REG-DLC.

       FIN-PRO-SUSP-DEVENGO-13.
      *-----------------------*
           EXIT.

       PRO-SUSP-DEVENGO-6 SECTION.
      *--------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A PRO-SUSP-DEVENGO-6'.
       INI-PRO-SUSP-DEVENGO-6.
      *----------------------*
           MOVE '06' TO WSS-IND-CALC IN WSS-VARI.
           PERFORM LEE-VEN-MAS-ANTIGUO.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL LEER REG. VEN, KEY:'
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
              MOVE 'OPC  NOVEN'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-6.

           MOVE VEN-IND-SCTB IN VEN TO WSS-IND-SCTB IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'VEN-IND-SCTB: ' WSS-IND-SCTB IN WSS-VARI.

           IF WSS-IND-SCTB IN WSS-VARI NOT = 'MOR' AND
              WSS-IND-SCTB IN WSS-VARI NOT = 'VIG' AND
              WSS-IND-SCTB IN WSS-VARI NOT = '   '
              PERFORM PRO-DEV-OTRA-SIT
              GO TO FIN-PRO-SUSP-DEVENGO-6.
      *JUS ?
           IF DLC-FEC-FDEV IN DLC > VEN-FEC-FVEN IN VEN OR
              VEN-FEC-FVEN > WSS-FEC-FTRA IN WSS-VARI
              MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FADV IN WSS-VARI
           ELSE
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FADV IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'FECHA AUX-DEV: ' WSS-FEC-FADV IN WSS-VARI.

      *JUS INI
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FTRA IN WSS-VARI
              MOVE WSS-FEC-FTRA IN WSS-VARI TO VEN-FEC-FVEN IN VEN.
      *JUS FIN

           IF NOT (DLC-FEC-FSDM IN DLC < WSS-FEC-FADV IN WSS-VARI)
              PERFORM PRO-SUSP-DEVENGO-16
              GO TO FIN-PRO-SUSP-DEVENGO-6.

           IF OPC-NUM-VCVG IN OPC > 1
              PERFORM PRO-SUSP-DEVENGO-12
              GO TO FIN-PRO-SUSP-DEVENGO-6.

           PERFORM LEE-CAN-ASOCIA-VEN.
           IF WSS-IND-CAN NOT = 'S'
      *     Si no existe CAN asociada al Reg.VEN o Cod.CAN distinto
      *     de CIE, calcula mora desde Fec.Vencimiento
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
           ELSE
      *     Si existe CAN asociada al Reg.VEN y Cod.CAN es 'CIE'
      *     calculo Mora desde Fec.Cancelacion
              MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.

           MOVE '06' TO WSS-IND-CALC IN WSS-VARI.
           PERFORM CALCULA-11.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR CALCULA-11: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
      *        MOVE 'CALCULA-11'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-6.

           PERFORM GRABA-REG-DLC.

       FIN-PRO-SUSP-DEVENGO-6.
      *----------------------*
           EXIT.

       PRO-SUSP-DEVENGO-16 SECTION.
      *---------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A PRO-SUSP-DEVENGO-16'.
       INI-PRO-SUSP-DEVENGO-16.
      *-----------------------*
           IF WSS-IND-SCTB IN WSS-VARI NOT = 'MOR'
              PERFORM PRO-DEV-OTRA-SIT
              GO TO FIN-PRO-SUSP-DEVENGO-16.

           MOVE VEN-VAL-SCAP IN VEN TO WSS-SUM-VCAP IN WSS-VARI.

      * Si Nro.de Vencimientos Vigente es mayor que 1 se procesaran
      * Varios Vencimientos
           IF OPC-NUM-VCVG IN OPC > 1
              MOVE 'S' TO WSS-TIPO-DEV IN WSS-VARI
              MOVE '16' TO WSS-IND-CALC IN WSS-VARI
              PERFORM PRO-SUSP-DEVENGO-12
              GO TO FIN-PRO-SUSP-DEVENGO-16.

      * Lee Ultimo Registro CAN asociado al Reg.VEN
           PERFORM LEE-CAN-ASOCIA-VEN.
           IF WSS-IND-CAN IN WSS-VARI NOT = 'S'
      *     Si no existe CAN asociada al Reg.VEN o Cod.CAN distinto
      *     de CIE, calcula mora desde Fec.Vencimiento
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FCAL IN WSS-VARI
           ELSE
      *     Si existe CAN asociada al Reg.VEN y Cod.CAN es 'CIE'
      *     calculo Mora desde Fec.Cancelacion
              MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAL IN WSS-VARI.

           MOVE '16' TO WSS-IND-CALC IN WSS-VARI.
           PERFORM CALCULA-11.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR CALCULA-11: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
      *        MOVE 'CALCULA-11'  TO ERC-COD-MSGE IN ERC
              PERFORM GRABAR-ERROR
              GO TO FIN-PRO-SUSP-DEVENGO-16.

           PERFORM GRABA-REG-DLC.

       FIN-PRO-SUSP-DEVENGO-16.
      *-----------------------*
           EXIT.


       LEE-VEN-MAS-ANTIGUO SECTION.
      *---------------------------*
      *     DISPLAY 'ENTRA A LEE-VEN-MAS-ANTIGUO'.
      * Lee Registro VEN mas antiguo, asociado al Reg. OPC
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.

           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.

           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-LEE-VEN-MAS-ANTIGUO.
           PERFORM COL-FIO-VEN.
      *DPM ini  14-NOV-1996
      *     IF NOT FIO-STAT-OKS
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
              DISPLAY 'NO HAY VEN ASOCIADO A OPC: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
              MOVE '23' TO FIO-STAT
              GO TO FIN-LEE-VEN-MAS-ANTIGUO.

      *DPM ini  3-SEP-1997 Si FVEN < FPRO y Saldo VEN = 0, no procesar
      *     IF WSS-OPEC IN WSS-VARI = 'B'
      *         NEXT SENTENCE
      *     ELSE
      *     IF VEN-FEC-FVEN IN VEN < WSS-FEC-FTRA IN WSS-VARI AND
      *     IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FTRA IN WSS-VARI AND
      *        VEN-VAL-SFIN IN VEN NOT > ZEROES
      * DPM ini  16-FEB-1998
      *         MOVE FIO-GET-NXT TO FIO-CMND
      *         GO TO LUP-LEE-VEN-MAS-ANTIGUO.
      *        DISPLAY 'ERROR, VENCIMIENTO INCOMPLETO: '
      *                 OPC-CIC-IOPC IN OPC VEN-NUM-IVEN IN VEN
      *                                              ' ' FIO-STAT
      *        MOVE '23' TO FIO-STAT
      *        GO TO FIN-LEE-VEN-MAS-ANTIGUO.
      * DPM fin  16-FEB-1998
      *DPM fin  3-SEP-1997

      * DPM ini  18-FEB-1998 Si VEN es Bol. Grtia debe procesar
      * el VEN actual, si no, debe procesar 1er VEN posterior a
      * FPRO si SFIN y SCAP son ceros. Si SFIN es cero y SCAP > 0,
      * es un error.
           IF VEN-VAL-SFIN IN VEN = ZEROES AND
              VEN-VAL-SCAP IN VEN > ZEROES AND
              WSS-OPEC IN WSS-VARI NOT = 'B' AND
              ICG-COD-CVTI IN ICG NOT > SPACES
               DISPLAY 'ERROR, VENCIMIENTO INCOMPLETO: '
                        OPC-CIC-IOPC IN OPC VEN-NUM-IVEN IN VEN
                                                   ' ' FIO-STAT
               MOVE '23' TO FIO-STAT
               GO TO FIN-LEE-VEN-MAS-ANTIGUO.

           IF VEN-VAL-SFIN IN VEN = ZEROES AND
              VEN-VAL-SCAP IN VEN > ZEROES AND
              WSS-OPEC IN WSS-VARI NOT = 'B' AND
              ICG-COD-CVTI IN ICG > SPACES AND
              ICG-MSC-TFPR IN ICG = 'C' AND
            ((WSS-IND-BALA IN WSS-VARI = 'P' AND
              VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FEXE IN WSS-VARI) OR
             (WSS-IND-BALA IN WSS-VARI = 'B' AND
              VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FTRA IN WSS-VARI))
               DISPLAY 'ERROR, VENCIMIENTO INCOMPLETO: '
                     OPC-CIC-IOPC IN OPC VEN-NUM-IVEN IN VEN
                                                ' ' FIO-STAT
               MOVE '23' TO FIO-STAT
               GO TO FIN-LEE-VEN-MAS-ANTIGUO
           ELSE
           IF VEN-VAL-SFIN IN VEN = ZEROES AND
              VEN-VAL-SCAP IN VEN > ZEROES AND
              WSS-OPEC IN WSS-VARI NOT = 'B' AND
              ICG-COD-CVTI IN ICG > SPACES AND
      * DPM ini  23-FEB-1998
      *        ICG-MSC-TFPR IN ICG = 'F'
              ICG-MSC-TFPR IN ICG = 'F' AND
              VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FTRA IN WSS-VARI
      * DPM fin  23-FEB-1998
               DISPLAY 'ERROR, VENCIMIENTO INCOMPLETO: '
                     OPC-CIC-IOPC IN OPC VEN-NUM-IVEN IN VEN
                                                ' ' FIO-STAT
               MOVE '23' TO FIO-STAT
               GO TO FIN-LEE-VEN-MAS-ANTIGUO.
      * DPM fin  18-FEB-1998

      * DPM ini  13-OCT-1997 No estaba grabando en archivo DVG el
      * primer VEN a pagar
           MOVE VEN-FEC-FVEN IN VEN TO WSS-VEN-FPRI IN WSS-VARI.
      * DPM fin  13-OCT-1997

      *DPM fin  14-NOV-1996

       FIN-LEE-VEN-MAS-ANTIGUO.
      *-----------------------*
           EXIT.

       LEE-VEN-ANT-FPRO SECTION.
      *------------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A LEE-VEN-ANT-FPRO'.
       INI-LEE-VEN-ANT-FPRO.
      *--------------------*
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
      *DPM ini  5-NOV-1997
      *     MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE 1 TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN.
      *DPM fin  5-NOV-1997
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'N' TO WSS-FLAG-VEN.
       SIGUE-LEE-VEN-ANT-FPRO.
      *----------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'VEN-NUM-IVEN: ' VEN-NUM-IVEN IN VEN.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              IF WSS-FLAG-VEN = 'N'
                 DISPLAY 'NO HAY VEN ANT. FPRO: '
                          OPC-CIC-IOPC IN OPC ' ' FIO-STAT
                 MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                 GO TO FIN-LEE-VEN-ANT-FPRO
              ELSE
                 GO TO LEE-VEN-EXACTO.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'VEN-CIC-IOPC: ' VEN-CIC-IOPC IN VEN
              DISPLAY 'VEN-NUM-IVEN: ' VEN-NUM-IVEN IN VEN
              DISPLAY 'VEN-FEC-FVEN: ' VEN-FEC-FVEN IN VEN.

           IF OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN
      * DPM ini  19-DEC-1997
      *        IF VEN-FEC-FVEN IN VEN < WSS-FEC-FTRA IN WSS-VARI
              IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FTRA IN WSS-VARI
      * DPM fin  19-DEC-1997
                 MOVE 'S' TO WSS-FLAG-VEN
                 MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN
                 MOVE FIO-GET-NXT TO FIO-CMND
                 GO TO SIGUE-LEE-VEN-ANT-FPRO
              ELSE
                 IF WSS-FLAG-VEN = 'S'
                    GO TO LEE-VEN-EXACTO
                 ELSE
                    DISPLAY 'ERROR AL LEER VEN ANT. A FPRO (FLAG): KEY '
                            OPC-CIC-IOPC IN OPC
                    MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
           ELSE
      *       DISPLAY 'ERROR AL LEER VEN ANTERIOR A FPRO: KEY '
      *               OPC-CIC-IOPC IN OPC
             MOVE 1 TO WSS-IND-FLAG IN WSS-VARI.
           GO TO FIN-LEE-VEN-ANT-FPRO.

       LEE-VEN-EXACTO.
      *--------------*
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVEN TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR LECTURA VEN: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT.

       FIN-LEE-VEN-ANT-FPRO.
      *--------------------*
           EXIT.

       LEE-VEN-ANT SECTION.
      *-------------------*
           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'ENTRA A LEE-VEN-ANT'.
       INI-LEE-VEN-ANT.
      *---------------*
           SUBTRACT 1 FROM VEN-NUM-IVEN IN VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           MOVE 'N' TO WSS-FLAG-VEN.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
      *           DISPLAY 'NO HAY VEN ANT: '
      *                    OPC-CIC-IOPC IN OPC ' ' FIO-STAT
                 MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                 GO TO FIN-LEE-VEN-ANT.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'VEN-CIC-IOPC: ' VEN-CIC-IOPC IN VEN
              DISPLAY 'VEN-NUM-IVEN: ' VEN-NUM-IVEN IN VEN
              DISPLAY 'VEN-FEC-FVEN: ' VEN-FEC-FVEN IN VEN.

       FIN-LEE-VEN-ANT.
      *---------------*
           EXIT.

       CAL-DELTA-UFV SECTION.
      *---------------------*
       INI-CAL-DELTA-UFV.
      *-----------------*
      * Calcula diferencia en UFs entre FCOL y FVEN.
      *  Si la operacion es en Moneda Nacional salta
           IF WSS-COD-MONEDA IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              OR WSS-MSC-TVOC IN WSS-VARI = '1'
              MOVE ZEROES TO WSS-DIF-UFS IN WSS-VARI
              MOVE 1      TO WSS-VAL-UF1 IN WSS-VARI
              GO TO SIGUE-CAL-DELTA-UFV.
      *     DISPLAY '2'.

      *    Prepara Lectura para obtener Valor de UF FVEN.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).
           MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CAL-DELTA-UFV.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF1 IN WSS-VARI.
      *     DISPLAY '3'.

      *    Prepara Lectura para obtener Valor de UF FCOL.
           MOVE WSS-COD-MONEDA IN WSS-VARI   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI   TO CAM-COD-VCAM IN CAM(2).

      *DPM ini  9-DEC-1996
      *     MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1)
      *                                      CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-FEC-FCOL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
      *DPM fin  9-DEC-1996

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR TABLA CAM: '
                       CAM-KEY-CAMB IN CAM ' ' FIO-STAT
              MOVE 'CAM    NEX' TO ERC-COD-MSGE IN ERC
              MOVE CAM-KEY-CAMB IN CAM TO ERC-GLS-DISP IN ERC
              GO TO FIN-CAL-DELTA-UFV.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF2 IN WSS-VARI.

      *  Calcula Delta_UFV
           SUBTRACT WSS-VAL-UF2 IN WSS-VARI FROM WSS-VAL-UF1 IN WSS-VARI
                                 GIVING WSS-DIF-UFS IN WSS-VARI ROUNDED.

       SIGUE-CAL-DELTA-UFV.
      *-------------------*
      *  Calcula: R = Kc * Delta_UFV
           MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-DIF-UFS IN WSS-VARI
                                       GIVING VAL-R IN VAL-VARI ROUNDED.
       FIN-CAL-DELTA-UFV.
      *-----------------*
           EXIT.

       LLAMA-CAL-INT-MORA SECTION.
      *--------------------------*
       INI-LLAMA-CAL-INT-MORA.
      *----------------------*
      *  Prepara Parametros para calculo de Tasa Periodo Mora
      *  MUEVO WSS-FEC-FCAL A MOR-FVEN SI ES PRIMER VEN
           IF VEN-NUM-IVEN IN VEN = 1
              MOVE WSS-NUM-DCAL IN WSS-VARI TO MOR-DVEN IN MOR-VARI
              MOVE WSS-NUM-MCAL IN WSS-VARI TO MOR-MVEN IN MOR-VARI
              MOVE WSS-NUM-SCAL IN WSS-VARI TO MOR-SVEN IN MOR-VARI
              MOVE WSS-NUM-ACAL IN WSS-VARI TO MOR-AVEN IN MOR-VARI
           ELSE
              MOVE VEN-NUM-DVEN IN VEN      TO MOR-DVEN IN MOR-VARI
              MOVE VEN-NUM-MVEN IN VEN      TO MOR-MVEN IN MOR-VARI
              MOVE VEN-NUM-SVEN IN VEN      TO MOR-SVEN IN MOR-VARI
              MOVE VEN-NUM-AVEN IN VEN      TO MOR-AVEN IN MOR-VARI.

      * Preparo Parametros para obtener dia siguiente a FPRO.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'SALI DE CALFEC ' WSS-FEC-FTRA.

      *     IF NOT FIO-STAT-OKS
           IF NOT FEC-STAT-OKS
              DISPLAY 'ERROR AL SUMAR 1 A FPRO: '
                       WSS-FEC-FTRA IN WSS-VARI ' ' FIO-STAT
              MOVE ZEROES TO MOR-TIPE
              MOVE 'ERR FPRO+1' TO ERC-COD-MSGE IN ERC
              GO TO FIN-LLAMA-CAL-INT-MORA.

      *    Muevo FPRO+1 a fecha uno.
           MOVE FEC-ITM1 TO MOR-DCAN IN MOR-VARI.
           MOVE FEC-ITM2 TO MOR-MCAN IN MOR-VARI.
           MOVE FEC-ITM3 TO MOR-SCAN IN MOR-VARI.
           MOVE FEC-ITM4 TO MOR-ACAN IN MOR-VARI.

      * DPM ini  12-DEC-1997 Para prebalance necesita fecha especial
      * para calculo de tasa de mora
           PERFORM DET-SI-BALANCE.
      * DPM fin  12-DEC-1997

      *DPM ini  10-DEC-1996
      *     MOVE OPC-NUM-ACOL IN OPC      TO MOR-ACOL IN MOR-VARI.
      *     MOVE OPC-NUM-SCOL IN OPC      TO MOR-SCOL IN MOR-VARI.
      *     MOVE OPC-NUM-MCOL IN OPC      TO MOR-MCOL IN MOR-VARI.
      *     MOVE OPC-NUM-DCOL IN OPC      TO MOR-DCOL IN MOR-VARI.
           MOVE WSS-NUM-ACOL IN WSS-VARI TO MOR-ACOL IN MOR-VARI.
           MOVE WSS-NUM-SCOL IN WSS-VARI TO MOR-SCOL IN MOR-VARI.
           MOVE WSS-NUM-MCOL IN WSS-VARI TO MOR-MCOL IN MOR-VARI.
           MOVE WSS-NUM-DCOL IN WSS-VARI TO MOR-DCOL IN MOR-VARI.
      *DPM fin  10-DEC-1996
      *ALD-BCI-INI/05051999
           IF OPC-IND-RENO IN OPC = 'PRO' AND
              OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE OPC TO OPS
               MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
                   MOVE OPC-VAL-CRED IN OPC TO WSS-CRED-ORIG
                   MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FORI
                   MOVE OPS TO OPC.
           MOVE WSS-NUM-AORI IN WSS-VARI TO MOR-AORI IN MOR-VARI.
           MOVE WSS-NUM-SORI IN WSS-VARI TO MOR-SORI IN MOR-VARI.
           MOVE WSS-NUM-MORI IN WSS-VARI TO MOR-MORI IN MOR-VARI.
           MOVE WSS-NUM-DORI IN WSS-VARI TO MOR-DORI IN MOR-VARI.
           MOVE WSS-CRED-ORIG            TO MOR-CRED IN MOR-VARI.
      *ALD-BCI-FIN/05051999

           MOVE DLC-NUM-AMAV IN DLC      TO MOR-AMAV IN MOR-VARI.
           MOVE DLC-NUM-SMAV IN DLC      TO MOR-SMAV IN MOR-VARI.
           MOVE DLC-NUM-MMAV IN DLC      TO MOR-MMAV IN MOR-VARI.
           MOVE DLC-NUM-DMAV IN DLC      TO MOR-DMAV IN MOR-VARI.

           MOVE VEN-NUM-AVEN IN VEN      TO MOR-AVCT IN MOR-VARI.
           MOVE VEN-NUM-SVEN IN VEN      TO MOR-SVCT IN MOR-VARI.
           MOVE VEN-NUM-MVEN IN VEN      TO MOR-MVCT IN MOR-VARI.
           MOVE VEN-NUM-DVEN IN VEN      TO MOR-DVCT IN MOR-VARI.

           MOVE VEN-NUM-AIMV IN VEN      TO MOR-AIMV IN MOR-VARI.
           MOVE VEN-NUM-SIMV IN VEN      TO MOR-SIMV IN MOR-VARI.
           MOVE VEN-NUM-MIMV IN VEN      TO MOR-MIMV IN MOR-VARI.
           MOVE VEN-NUM-DIMV IN VEN      TO MOR-DIMV IN MOR-VARI.

           MOVE DLC-COD-PLZO IN DLC      TO MOR-PLZO IN MOR-VARI.

      *    Muevo Valor de Cambio
           MOVE WSS-COD-MONEDA IN WSS-VARI TO MOR-VCOC IN MOR-VARI.

           MOVE OPC-CIC-IOPC IN OPC      TO MOR-IOPC IN MOR-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'OPC CIC IOPC : ' OPC-CIC-IOPC IN OPC
              DISPLAY 'OPC FCOL : ' OPC-FEC-FCOL IN OPC
              DISPLAY 'WSS FCAL : ' WSS-FEC-FCAL IN WSS-VARI
              DISPLAY 'MOR FCOL : ' MOR-FCOL IN MOR-VARI
              DISPLAY 'VEN FVEN : ' VEN-FEC-FVEN IN VEN
              DISPLAY 'MOR FVEN : ' MOR-FVEN IN MOR-VARI
              DISPLAY 'MOR FCAN : ' MOR-FCAN IN MOR-VARI
              DISPLAY 'CAL-INT-MORA'.

      *DPM ini  28-OCT-1996
           PERFORM CAL-INT-MORA.
           IF MOR-CMSG > SPACES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE MOR-CMSG       TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY 'ERROR ' MSG-GLS-DESC ' ' MOR-MEN2 IN MOR-VARI
               MOVE MOR-CMSG TO ERC-COD-MSGE IN ERC
               GO TO FIN-LLAMA-CAL-INT-MORA.
      *DPM fin  28-OCT-1996
           MOVE MOR-TIPE TO WSS-MOR-TIPE IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
              DISPLAY 'MOR-TIPE: ' WSS-MOR-TIPE IN WSS-VARI.

       FIN-LLAMA-CAL-INT-MORA.
      *----------------------*
           EXIT.


      *DPM ini  16-SEP-1997
      ******************************************************************
      *El parametro VEN-FTBS sirve para buscar la ultima tasa vigente
      *a esa fecha (si lleva valor), y si no lleva valor, busca la tasa
      *a fecha de colocacion
       CARGA-FTBS SECTION.
      *-------------------
       INI-CARGA-FTBS.
      *     IF WSS-PVEZ IN WSS-VARI = 'S'
      *         MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FUCT IN WSS-VARI
      *                                     WSS-FEC-FXXX IN WSS-VARI
      *     ELSE
      *     IF WSS-PVEZ IN WSS-VARI NOT = 'S' AND
      *        VEN-FEC-FVEN IN VEN NOT > HOY-FHOY
      *         MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FUCT IN WSS-VARI
      *         MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FXXX IN WSS-VARI
      *     ELSE
      *         MOVE WSS-FEC-FXXX TO WSS-FEC-FUCT IN WSS-VARI.

           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FTRA IN WSS-VARI
               MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FUCT IN WSS-VARI
               GO TO FIN-CARGA-FTBS.

           MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN0 IN WSS-VARI.
           PERFORM LEE-VEN-ANT.
           IF WSS-IND-FLAG IN WSS-VARI = 1 OR
              VEN-FEC-FVEN IN VEN > HOY-FHOY
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FUCT IN WSS-VARI
           ELSE
               MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FUCT IN WSS-VARI.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVEN0 IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
       FIN-CARGA-FTBS.
           EXIT.


      * Rutina que a partir de la fecha de colocacion, busca la
      * ultima fecha de cambio de tasa antes de la fecha de ejecucion
      * La fecha de ultimo cambio de tasa se calcula solo para el primer
      * vencimiento, para los demas se mantiene la fecha calculada
      * Entrada : WSS-FEC-FINT  ( FCOL )
      * Salida  : WSS-FEC-FUCT

       CAL-ULT-CAMBIO-TASA SECTION.
      *----------------------------
       INI-CAL-ULT-CAMBIO-TASA.
           IF ICG-COD-CVTI IN ICG NOT > SPACES
               MOVE ZEROES TO WSS-FEC-FUCT IN WSS-VARI
               GO TO FIN-CAL-ULT-CAMBIO-TASA.

           IF ICG-MSC-TFPR IN ICG = 'F'
               PERFORM CARGA-FTBS
               GO TO FIN-CAL-ULT-CAMBIO-TASA.

           IF WSS-PVEZ IN WSS-VARI NOT = 'S'
               GO TO FIN-CAL-ULT-CAMBIO-TASA.

       LUP-CAL-ULT-CAMBIO-TASA.
      *JUS-INI 21-JAN-1998
      *     IF WSS-FEC-FINT IN WSS-VARI > HOY-FHOY
           IF WSS-FEC-FINT IN WSS-VARI > WSS-FEC-FEXE IN WSS-VARI
      *JUS-FIN 21-JAN-1998
               GO TO FIN-CAL-ULT-CAMBIO-TASA.

           MOVE WSS-FEC-FINT IN WSS-VARI TO WSS-FEC-FUCT IN WSS-VARI.

           IF ICG-MSC-UTPR IN ICG = 'D'
               MOVE ICG-NUM-PREP IN ICG TO FEC-NDIA
               MOVE FEC-SUM-DIA         TO FEC-CMND
           ELSE
           IF ICG-MSC-UTPR IN ICG = 'M'
               MOVE ICG-NUM-PREP IN ICG TO FEC-NMES
               MOVE FEC-SUM-MES         TO FEC-CMND
           ELSE
               MOVE ICG-NUM-PREP IN ICG TO FEC-NANO
               MOVE FEC-SUM-ANO         TO FEC-CMND.

           MOVE WSS-NUM-DINT IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MINT IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SINT IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-AINT IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               GO TO FIN-CAL-ULT-CAMBIO-TASA.

           MOVE FEC-ITM1 TO WSS-NUM-DINT IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MINT IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SINT IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-AINT IN WSS-VARI.
           GO TO LUP-CAL-ULT-CAMBIO-TASA.
       FIN-CAL-ULT-CAMBIO-TASA.
           EXIT.

      ******************************************************************
       LEE-ICG SECTION.
      ****************
       INI-LEE-ICG.
           MOVE ZEROES TO WSS-IND-FLAG IN WSS-VARI.

           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
                     MOVE 1 TO WSS-IND-FLAG IN WSS-VARI.
       FIN-LEE-ICG.
           EXIT.


       OBT-TASA-CAM SECTION.
      **********************
       INI-OBT-TASA-CAM.
           IF WSS-IND-BALA IN WSS-VARI = 'P' AND
      *JUS-INI 21-JAN-1998
      *        DLC-FEC-FDEV IN DLC > HOY-FHOY
      *         MOVE HOY-FHOY TO CAM-FEC-FCAM IN CAM(1)
      *                          CAM-FEC-FCAM IN CAM(2)
              DLC-FEC-FDEV IN DLC > WSS-FEC-FEXE IN WSS-VARI
               MOVE WSS-FEC-FEXE IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                                CAM-FEC-FCAM IN CAM(2)
      *JUS-FIN 21-JAN-1998
           ELSE
               MOVE DLC-FEC-FDEV IN DLC TO CAM-FEC-FCAM IN CAM(1)
                                           CAM-FEC-FCAM IN CAM(2).

           MOVE 'I'                 TO CAM-MSC-TVAL IN CAM(1).
           MOVE ICG-COD-CVTI IN ICG TO CAM-COD-CVAL IN CAM(1).
           MOVE ICG-MSC-PBTI IN ICG TO CAM-COD-TCAM IN CAM(1).
           MOVE OPC-COD-VCOC IN OPC TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CAM     NEX PARA FECHA: ' CAM-KEY-CAMB IN CAM
                       ' ' OPC-CIC-IOPC IN OPC
           ELSE
               ADD ICG-SGV-SPRD IN ICG TO CAM-SGV-VCAM IN CAM
                           GIVING DVG-SGV-TASA IN DVG.
       FIN-OBT-TASA-CAM.
           EXIT.
      *DPM fin  16-SEP-1997

      *DPM ini  16-SEP-1997
       OBT-DIF-FECHAS-A SECTION.
      *------------------------
       INI-OBT-DIF-FECHAS-A.
           IF DLC-FEC-FDEV IN DLC > WSS-VEN-FANT IN WSS-VARI
      * Calcular diferencia entre FDEV y FVEN en DIAS
               MOVE DLC-NUM-DDEV IN DLC TO FEC-DEC1
               MOVE DLC-NUM-MDEV IN DLC TO FEC-MEC1
               MOVE DLC-NUM-SDEV IN DLC TO FEC-SEC1
               MOVE DLC-NUM-ADEV IN DLC TO FEC-AEC1
               MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-DIF-DIA  TO FEC-CMND
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   DISPLAY 'ERROR CAL DIF '
                           'ENTRE FUPI Y FVEN '
                            OPC-CIC-IOPC IN OPC ' '
                            DLC-FEC-FDEV IN DLC ' '
                            VEN-FEC-FVEN IN VEN
                   MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                   MOVE 'FUPI<>FVEN' TO ERC-COD-MSGE IN ERC
                   GO TO FIN-OBT-DIF-FECHAS-A
               ELSE
                   MOVE FEC-NDIA TO WSS-VAL-A IN WSS-VARI

      * Calcular diferencia entre FDEV y FPRO en DIAS
                   MOVE DLC-NUM-DDEV IN DLC      TO FEC-DEC1
                   MOVE DLC-NUM-MDEV IN DLC      TO FEC-MEC1
                   MOVE DLC-NUM-SDEV IN DLC      TO FEC-SEC1
                   MOVE DLC-NUM-ADEV IN DLC      TO FEC-AEC1
                   MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-DEC2
                   MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-MEC2
                   MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-SEC2
                   MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-AEC2
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-DIF-DIA  TO FEC-CMND
                   PERFORM CAL-FEC
                   IF NOT FEC-STAT-OKS
                       DISPLAY 'ERROR CAL DIF '
                               'ENTRE FUPI Y FPRO '
                               OPC-CIC-IOPC IN OPC
                               DLC-FEC-FDEV IN DLC ' '
                              WSS-FEC-FTRA IN WSS-VARI
                       MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                       MOVE 'FUPI<>FPRO' TO ERC-COD-MSGE IN ERC
                       GO TO FIN-OBT-DIF-FECHAS-A
                   ELSE
                       MOVE FEC-NDIA TO WSS-VAL-B IN WSS-VARI
                       ADD 1 TO WSS-VAL-B IN WSS-VARI
           ELSE
      * Calcular diferencia entre FANT y FVEN en DIAS
               MOVE WSS-VEN-DANT IN WSS-VARI TO FEC-DEC1
               MOVE WSS-VEN-MANT IN WSS-VARI TO FEC-MEC1
               MOVE WSS-VEN-SANT IN WSS-VARI TO FEC-SEC1
               MOVE WSS-VEN-AANT IN WSS-VARI TO FEC-AEC1
               MOVE VEN-NUM-DVEN IN VEN      TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN      TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN      TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN      TO FEC-AEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-DIF-DIA  TO FEC-CMND
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   DISPLAY 'ERROR CAL DIF '
                           'ENTRE FVEN ANT Y FVEN '
                           OPC-CIC-IOPC IN OPC ' '
                           WSS-VEN-FANT IN WSS-VARI ' '
                           VEN-FEC-FVEN IN VEN
                   MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                   MOVE 'FANT<>FVEN' TO ERC-COD-MSGE IN ERC
                   GO TO FIN-OBT-DIF-FECHAS-A
               ELSE
                   MOVE FEC-NDIA TO WSS-VAL-A IN WSS-VARI

      * CON ESTO SE CONSIDERA EL DIA DE PROCESO INCLUSIVE
      *             ADD 1 TO WSS-VAL-A IN WSS-VARI
      * Calcular diferencia entre FANT y FPRI en DIAS
                   MOVE WSS-VEN-DANT IN WSS-VARI TO FEC-DEC1
                   MOVE WSS-VEN-MANT IN WSS-VARI TO FEC-MEC1
                   MOVE WSS-VEN-SANT IN WSS-VARI TO FEC-SEC1
                   MOVE WSS-VEN-AANT IN WSS-VARI TO FEC-AEC1
                   MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-DEC2
                   MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-MEC2
                   MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-SEC2
                   MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-AEC2
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-DIF-DIA  TO FEC-CMND
                   PERFORM CAL-FEC
                   IF NOT FEC-STAT-OKS
                       DISPLAY 'ERROR CAL DIF '
                           'ENTRE FVEN ANT Y FPRO '
                            OPC-CIC-IOPC IN OPC ' '
                            WSS-VEN-FANT IN WSS-VARI ' '
                            WSS-FEC-FTRA IN WSS-VARI
                       MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                       MOVE 'FANT<>FPRO' TO ERC-COD-MSGE IN ERC
                       GO TO FIN-OBT-DIF-FECHAS-A
                   ELSE
                       MOVE FEC-NDIA TO WSS-VAL-B IN WSS-VARI
      * CON ESTO SE CONSIDERA EL DIA DE PROCESO INCLUSIVE
                       ADD 1 TO WSS-VAL-B IN WSS-VARI.
       FIN-OBT-DIF-FECHAS-A.
           EXIT.

       OBT-DIF-FECHAS-B SECTION.
      *------------------------
       INI-OBT-DIF-FECHAS-B.
      * Calcular diferencia entre FANT y FPRI en DIAS
           MOVE WSS-NUM-DSUS IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MSUS IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SSUS IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ASUS IN WSS-VARI TO FEC-AEC1.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-DEC2.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-MEC2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-SEC2.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR CAL DIF '
                       'ENTRE FSUSP DEV Y FPRO '
                        OPC-CIC-IOPC IN OPC ' '
                        WSS-FEC-FSUS IN WSS-VARI ' '
                        WSS-FEC-FTRA IN WSS-VARI
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               MOVE 'FSUS<>FPRO' TO ERC-COD-MSGE IN ERC
               GO TO FIN-OBT-DIF-FECHAS-B
           ELSE
               MOVE FEC-NDIA TO WSS-VAL-C IN WSS-VARI.

      * CON ESTO SE CONSIDERA EL DIA DE PROCESO INCLUSIVE
           ADD 1 TO WSS-VAL-C IN WSS-VARI.
       FIN-OBT-DIF-FECHAS-B.
           EXIT.

       OBT-DIF-FECHAS-C SECTION.
      *------------------------
       INI-OBT-DIF-FECHAS-C.
      * Calcular diferencia entre FANT y FPRI en DIAS
           MOVE WSS-NUM-DSUS IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MSUS IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SSUS IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ASUS IN WSS-VARI TO FEC-AEC1.
           MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR CAL DIF '
                       'ENTRE FSUSP DEV Y FPRO '
                        OPC-CIC-IOPC IN OPC ' '
                        WSS-FEC-FSUS IN WSS-VARI ' '
                        WSS-FEC-FTRA IN WSS-VARI
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               GO TO FIN-OBT-DIF-FECHAS-C
           ELSE
               MOVE FEC-NDIA TO WSS-VAL-D IN WSS-VARI.
       FIN-OBT-DIF-FECHAS-C.
           EXIT.


       DET-SI-BALANCE SECTION.
      *-----------------------
       INI-DET-SI-BALANCE.
      * DPM ini  12-DEC-1997 Si es prebalance utiliza fechas distintas
      * para calculo de tasa de interes
           IF WSS-IND-BALA IN WSS-VARI = 'P'
               MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FINT IN WSS-VARI
               PERFORM CAL-ULT-CAMBIO-TASA
               MOVE ICG-COD-CVTI IN ICG TO INT-CVTI IN INT-VARI
               MOVE WSS-NUM-DUCT IN WSS-VARI TO INT-DBTV IN INT-VARI
               MOVE WSS-NUM-MUCT IN WSS-VARI TO INT-MBTV IN INT-VARI
               MOVE WSS-NUM-SUCT IN WSS-VARI TO INT-SBTV IN INT-VARI
               MOVE WSS-NUM-AUCT IN WSS-VARI TO INT-ABTV IN INT-VARI
      *JUS-INI 21-JAN-1998
      *         IF WSS-FEC-FUCT IN WSS-VARI > HOY-FHOY AND
      *            WSS-IND-BALA IN WSS-VARI = 'P'
      *             MOVE HOY-DHOY TO INT-DBTV IN INT-VARI
      *             MOVE HOY-MHOY TO INT-MBTV IN INT-VARI
      *             MOVE HOY-SHOY TO INT-SBTV IN INT-VARI
      *             MOVE HOY-AHOY TO INT-ABTV IN INT-VARI
              IF WSS-FEC-FUCT IN WSS-VARI > WSS-FEC-FEXE IN WSS-VARI AND
                  WSS-IND-BALA IN WSS-VARI = 'P'
                   MOVE WSS-NUM-DEXE TO INT-DBTV IN INT-VARI
                   MOVE WSS-NUM-MEXE TO INT-MBTV IN INT-VARI
                   MOVE WSS-NUM-SEXE TO INT-SBTV IN INT-VARI
                   MOVE WSS-NUM-AEXE TO INT-ABTV IN INT-VARI
      *JUS-FIN 21-JAN-1998
                   IF WSS-IND-DISP IN WSS-VARI = 'S'
                       DISPLAY 'COD TIPO TASA: ' INT-CVTI IN INT-VARI
                       DISPLAY 'FECHA CAMBIO TASA INT: '
                                                  INT-FBTV IN INT-VARI
                       DISPLAY 'TIPO TASA VAR: ' ICG-MSC-TFPR IN ICG
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF WSS-IND-DISP IN WSS-VARI = 'S'
                   DISPLAY 'COD TIPO TASA: ' INT-CVTI IN INT-VARI
                   DISPLAY 'FECHA CAMBIO TASA INT: '
                                              INT-FBTV IN INT-VARI
                   DISPLAY 'TIPO TASA VAR: ' ICG-MSC-TFPR IN ICG.
      * DPM fin  12-DEC-1997
       FIN-DET-SI-BALANCE.
           EXIT.
      *RVM-BCI-INI 6-APR-1998
       GRABA-CAS-DVG SECTION.
       INI-GRABA-CAS-DVG.
           MOVE 'DVG'                    TO DVG-COD-MVTO IN DV2.
           MOVE 'CAS'                    TO DVG-MSC-TCCT IN DV2.
           MOVE SPACES                   TO DVG-CIC-CCSB IN DV2.
           MOVE 'D'                      TO DVG-IND-DBHB IN DV2.
           MOVE ZEROES                   TO DVG-SGV-ICTB IN DV2.
           MOVE WSS-FEC-FTRA IN WSS-VARI TO DVG-FEC-FPRO IN DV2.
           MOVE OPC-COD-VCOC IN OPC      TO DVG-COD-VCOC IN DV2.
           MOVE OPC-COD-OFOC IN OPC      TO DVG-COD-OFOC IN DV2.
           MOVE OPC-COD-COOC IN OPC      TO DVG-COD-COOC IN DV2.
           MOVE WSS-FEC-FTRA IN WSS-VARI TO DVG-FEC-FCTB IN DV2.
           MOVE OPC-CIC-IOPC IN OPC      TO DVG-CIC-IOPC IN DV2.
           MOVE DLC-NUM-IDLC IN DLC      TO DVG-NUM-IDLC IN DV2.
           MOVE OPC-VAL-SCRE IN OPC      TO DVG-VAL-SCRE IN DV2.
           MOVE ZEROES                   TO DVG-FEC-FVEN IN DV2.
           MOVE DLC-FEC-FDEV IN DLC      TO DVG-FEC-FDEV IN DV2.
           MOVE WSS-FEC-FCOL IN WSS-VARI TO DVG-FEC-FCOL IN DV2.
           MOVE DLC-IND-SCBZ IN DLC      TO DVG-IND-SCBZ IN DV2.
           MOVE DLC-IND-SCRT IN DLC      TO DVG-IND-SCRT IN DV2.
           MOVE DLC-IND-SCTB IN DLC      TO DVG-IND-SCTB IN DV2.
           MOVE DLC-COD-PLZO IN DLC      TO DVG-COD-PLZO IN DV2.
           MOVE DLC-IND-SCTB IN DLC      TO DVG-IND-SCTB IN DV2.
           MOVE DLC-FEC-FMAV IN DLC      TO DVG-FEC-FMAV IN DV2.
           MOVE OPC-FEC-FINP IN OPC      TO DVG-FEC-FINP IN DV2.
           MOVE ZEROES                   TO DVG-SGV-FCOL IN DV2.
           MOVE SPACES                   TO DVG-GLS-DISP IN DV2.
           MOVE OPC-VAL-CRED IN OPC      TO DVG-VAL-CRED IN DV2.
           MOVE OPC-COD-CDOC IN OPC      TO DVG-COD-CDOC IN DV2.
           MOVE OPC-IND-GARA IN OPC      TO DVG-IND-GARA IN DV2.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-DV2.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-GDV2 IN WSS-VARI
           ELSE
               DISPLAY 'ERROR: AL GRABAR COLDV2 : ' FIO-STAT.
       FIN-GRABA-CAS-DVG.
           EXIT.
      *RVM-BCI-FIN 6-APR-1998

      *COPY COLBFOPC.
      * Modulo FIO para registro OPC en DATACOM, 25-MAR-1993 10:00:37.98
       COL-FIO-OPC SECTION.
       INI-COL-FIO-OPC.
           MOVE ADR-OPC-REQA TO ADR-REQA.
           MOVE 'OPC' TO ADR-TABL IN ADR-REQA.
      *
      * DPM ini  1-JUL-1998 10:01:57
           IF WSS-IND-PROC IN WSS-VARI = 'R'
               MOVE +162 TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-OPC.
      * DPM fin  1-JUL-1998

           MOVE 'COL'  TO IDD-SAUX.
           MOVE 'M'    TO IDD-GAUX.
           MOVE SPACES TO IDD-RAUX.
           MOVE 1 TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               GO TO GRP-COL-FIO-OPC
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-OPC.
       GRP-COL-FIO-OPC.
           MOVE SPACES TO IDD-GAUX.
           MOVE 1      TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               MOVE 'En COL-FIO-OPC, NO existe en IDD:' TO FIO-MEN1
               MOVE IDD-DAUX                            TO FIO-MEN2
               PERFORM PRG-ABT
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA.
       FSR-COL-FIO-OPC.
      *
           MOVE 'OPC00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           IF FIO-KDEF = FIO-KDEF-S
               GO TO CON-COL-FIO-OPC.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'OPC-KEY-IOPC' OR FIO-AKEY NOT > SPACES )
               MOVE OPC-KEY-IOPC IN OPC TO ADR-VKEY IN ADR-REQA
               MOVE 'OPC00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'OPC-FEC-FCOL'
               MOVE OPC-FEC-FCOL IN OPC TO ADR-VKEY IN ADR-REQA
               MOVE 'OPC01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'OPC-FEC-FING'
               MOVE OPC-FEC-FING IN OPC TO ADR-VKEY IN ADR-REQA
               MOVE 'OPC02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'OPC-FEC-FINP'
               MOVE OPC-FEC-FINP IN OPC TO ADR-VKEY IN ADR-REQA
               MOVE 'OPC03' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En COL-FIO-OPC, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.
       CON-COL-FIO-OPC.
           MOVE OPC TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO OPC
           ELSE
               MOVE 'COLOPC' TO FIO-MEN2
               IF FIO-STAT-FTL
                   PERFORM PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE FIO-KDEF-N TO FIO-KDEF.
           MOVE ADR-REQA TO ADR-OPC-REQA.
       FIN-COL-FIO-OPC.
           EXIT.

       COPY COLBFOPS.

      *COPY COLBFVEN.
      * Modulo FIO para registro VEN en DATACOM, 25-MAR-1993 10:01:59.98
       COL-FIO-VEN SECTION.
       INI-COL-FIO-VEN.
           MOVE ADR-VEN-REQA TO ADR-REQA.
           MOVE 'VEN' TO ADR-TABL IN ADR-REQA.

      * DPM ini  1-JUL-1998 10:01:57
           IF WSS-IND-PROC IN WSS-VARI = 'R'
               MOVE +162 TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-VEN.
      * DPM fin  1-JUL-1998

           MOVE 'COL'  TO IDD-SAUX.
           MOVE 'M'    TO IDD-GAUX.
           MOVE SPACES TO IDD-RAUX.
           MOVE 1 TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               GO TO GRP-COL-FIO-VEN
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-VEN.
       GRP-COL-FIO-VEN.
           MOVE SPACES TO IDD-GAUX.
           MOVE 1      TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               MOVE 'En COL-FIO-VEN, NO existe en IDD:' TO FIO-MEN1
               MOVE IDD-DAUX                            TO FIO-MEN2
               PERFORM PRG-ABT
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA.
       FSR-COL-FIO-VEN.
      *
           MOVE 'VEN00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           IF FIO-KDEF = FIO-KDEF-S
               GO TO CON-COL-FIO-VEN.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'VEN-KEY-IVEN' OR FIO-AKEY NOT > SPACES )
               MOVE VEN-KEY-IVEN IN VEN TO ADR-VKEY IN ADR-REQA
               MOVE 'VEN00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'VEN-FEC-FVEN'
               MOVE VEN-FEC-FVEN IN VEN TO ADR-VKEY IN ADR-REQA
               MOVE 'VEN01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'VEN-FEC-FIMV'
               MOVE VEN-FEC-FIMV IN VEN TO ADR-VKEY IN ADR-REQA
               MOVE 'VEN02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'VEN-IND-SCTB'
               MOVE VEN-IND-SCTB IN VEN TO ADR-VKEY IN ADR-REQA
               MOVE 'VEN03' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En COL-FIO-VEN, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.
       CON-COL-FIO-VEN.
           MOVE VEN TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO VEN
           ELSE
               MOVE 'COLVEN' TO FIO-MEN2
               IF FIO-STAT-FTL
                   PERFORM PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE FIO-KDEF-N TO FIO-KDEF.
           MOVE ADR-REQA TO ADR-VEN-REQA.
       FIN-COL-FIO-VEN.
           EXIT.

      *COPY COLBFCAN.
      * Modulo FIO para registro CAN en DATACOM, 25-MAR-1993 09:57:15.45
       COL-FIO-CAN SECTION.
       INI-COL-FIO-CAN.
           MOVE ADR-CAN-REQA TO ADR-REQA.
           MOVE 'CAN' TO ADR-TABL IN ADR-REQA.
      *
      * DPM ini  1-JUL-1998 10:01:57
           IF WSS-IND-PROC IN WSS-VARI = 'R'
               MOVE +162 TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-CAN.
      * DPM fin  1-JUL-1998

           MOVE 'COL'  TO IDD-SAUX.
           MOVE 'M'    TO IDD-GAUX.
           MOVE SPACES TO IDD-RAUX.
           MOVE 1 TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               GO TO GRP-COL-FIO-CAN
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-CAN.
       GRP-COL-FIO-CAN.
           MOVE SPACES TO IDD-GAUX.
           MOVE 1      TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               MOVE 'En COL-FIO-CAN, NO existe en IDD:' TO FIO-MEN1
               MOVE IDD-DAUX                            TO FIO-MEN2
               PERFORM PRG-ABT
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA.
       FSR-COL-FIO-CAN.
      *
           MOVE 'CAN00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           IF FIO-KDEF = FIO-KDEF-S
               GO TO CON-COL-FIO-CAN.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'CAN-KEY-ICAN' OR FIO-AKEY NOT > SPACES )
               MOVE CAN-KEY-ICAN IN CAN TO ADR-VKEY IN ADR-REQA
               MOVE 'CAN00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'CAN-FEC-FCAN'
               MOVE CAN-FEC-FCAN IN CAN TO ADR-VKEY IN ADR-REQA
               MOVE 'CAN01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'CAN-FEC-FEGR'
               MOVE CAN-FEC-FEGR IN CAN TO ADR-VKEY IN ADR-REQA
               MOVE 'CAN02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'CAN-FEC-FOUT'
               MOVE CAN-FEC-FOUT IN CAN TO ADR-VKEY IN ADR-REQA
               MOVE 'CAN03' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En COL-FIO-CAN, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.
       CON-COL-FIO-CAN.
           MOVE CAN TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO CAN
           ELSE
               MOVE 'COLCAN' TO FIO-MEN2
               IF FIO-STAT-FTL
                   PERFORM PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE FIO-KDEF-N TO FIO-KDEF.
           MOVE ADR-REQA TO ADR-CAN-REQA.
       FIN-COL-FIO-CAN.
           EXIT.

      * COPY COLBFDCC.

      *COPY COLBFDLC.
      * Modulo FIO para registro DLC en DATACOM, 25-MAR-1993 09:59:30.49
       COL-FIO-DLC SECTION.
       INI-COL-FIO-DLC.
           MOVE ADR-DLC-REQA TO ADR-REQA.
           MOVE 'DLC' TO ADR-TABL IN ADR-REQA.
      *
      * DPM ini  1-JUL-1998 10:01:57
           IF WSS-IND-PROC IN WSS-VARI = 'R'
               MOVE +162 TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-DLC.
      * DPM fin  1-JUL-1998

           MOVE 'COL'  TO IDD-SAUX.
           MOVE 'M'    TO IDD-GAUX.
           MOVE SPACES TO IDD-RAUX.
           MOVE 1 TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               GO TO GRP-COL-FIO-DLC
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-DLC.
       GRP-COL-FIO-DLC.
           MOVE SPACES TO IDD-GAUX.
           MOVE 1      TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               MOVE 'En COL-FIO-DLC, NO existe en IDD:' TO FIO-MEN1
               MOVE IDD-DAUX                            TO FIO-MEN2
               PERFORM PRG-ABT
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA.
       FSR-COL-FIO-DLC.
      *
           MOVE 'DLC00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           IF FIO-KDEF = FIO-KDEF-S
               GO TO CON-COL-FIO-DLC.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'DLC-KEY-IDLC' OR FIO-AKEY NOT > SPACES )
               MOVE DLC-KEY-IDLC IN DLC TO ADR-VKEY IN ADR-REQA
               MOVE 'DLC00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'DLC-IND-SCTB'
               MOVE DLC-IND-SCTB IN DLC TO ADR-VKEY IN ADR-REQA
               MOVE 'DLC01' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En COL-FIO-DLC, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.
       CON-COL-FIO-DLC.
           MOVE DLC TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO DLC
           ELSE
               MOVE 'COLDLC' TO FIO-MEN2
               IF FIO-STAT-FTL
                   PERFORM PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE FIO-KDEF-N TO FIO-KDEF.
           MOVE ADR-REQA TO ADR-DLC-REQA.
       FIN-COL-FIO-DLC.
           EXIT.

       COPY COLBGINT.
       COPY COLBFICG.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGPES.
       COPY TABBFCAM.
       COPY COLBFDVG.
       COPY COLBFDV2.
       COPY COLBGMOR.
      *DPM ini  29-OCT-1996
       COPY COLIOTMC.
       COPY COLBFCPP.
       COPY COLBFDCC.
       COPY COLBFERC.
       COPY COLBFTOC.
      *DPM fin  29-OCT-1996
      *ALD-BCI-INI/05.05.1999
       COPY TABBBTXC.
      *ALD-BCI-FIN/05.05.1999





