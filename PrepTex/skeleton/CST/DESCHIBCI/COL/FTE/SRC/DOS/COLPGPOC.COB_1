       IDENTIFICATION DIVISION.
      *=======================*
       PROGRAM-ID.      COLPGPOC.
       AUTHOR.          BEE(JGM).
       DATE-WRITTEN.     09-ABRIL-1999.
      * Programa de actualizacion de la rov.
      *
       ENVIRONMENT DIVISION.
      *====================*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------*
       FILE-CONTROL.
      *     SELECT COLBCI ASSIGN TO COLBCI.

       DATA DIVISION.
      *=============*
       WORKING-STORAGE SECTION.
      *-----------------------*
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IDD-REQA==.
      *<<<< WSS

       COPY COLBRPOC.
      *
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRIDD.
       COPY GNSWVIDD.
      *
       COPY GNSBRTAB.
      *
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.

      *
       01  WSS-VARI.
           03 PGM-STAT.
              05 PGM-STAT-ROC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-OPC-OKS    VALUE '00'.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.


      * FECHAS

      *
           03 WSS-OPC-IMOD.
               05 WSS-CIC-IMOD                    PIC X(12).
               05 WSS-NUM-IMOD                    PIC 9(03).
           03 WSS-ANT-IMOD.
               05 WSS-CIC-AMOD                    PIC X(12).
               05 WSS-NUM-AMOD                    PIC 9(03).

           03 WSS-ROC.
               05 WSS-KEY-IROC.
                  07 WSS-CIC-IOPC                 PIC X(12).
                  07 WSS-KEY-IVCT.
                     11 WSS-CIC-IVCT              PIC X(12).
                     11 WSS-NUM-IVCT              PIC 9(03).

      * Contadores
           03 WSS-NUM-MPOC      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-LPOC      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-DPOC      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-EPOC      VALUE ZEROES      PIC 9(07).

      *Indicadores.
           03 WSS-CIC-IOPV      VALUE SPACES      PIC X(12).
           03 WSS-IND-IRTE      VALUE SPACES      PIC X(01).

       PROCEDURE DIVISION.
      *==================*
       MAIN SECTION.
      *------------*
       INI-MAIN.
      *--------*
           COPY GNSBGEDB.
           MOVE 'COLPGPOC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *
      *
           PERFORM ABRE-ARCHIVOS.
           IF NOT FIO-STAT-OKS
              GO TO FIN-MAIN.
      *
           PERFORM PRO-POC.
      *
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-POC.
      *
      *
       FIN-MAIN.
      *--------*
           DISPLAY 'ESTADISTICAS.'.
           DISPLAY '-------------'.
           DISPLAY ' '.
           DISPLAY 'POC LEIDAS           : ' WSS-NUM-LPOC IN WSS-VARI.
           DISPLAY 'POC MODIFICADAS      : ' WSS-NUM-MPOC IN WSS-VARI.
           DISPLAY '--------------------------------------'.
           DISPLAY 'POC SEGDES           : ' WSS-NUM-DPOC IN WSS-VARI.
           DISPLAY 'POC SEDECO           : ' WSS-NUM-EPOC IN WSS-VARI.
       FIN-MAIN-FIN.
           PERFORM GNS-PRO-END.
      *
       ABRE-ARCHIVOS SECTION.
      *---------------------*
       INI-ABRE-ARCHIVOS.
      *ARCHIVO SECUENCIAL POC
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR APERTURA DE POC: ' FIO-STAT.
      *
       FIN-ABRE-ARCHIVOS.
           EXIT.

       PRO-POC SECTION.
      *---------------*
       INI-PRO-POC.
      *
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL LEER PRIMER REG.POC: ' FIO-STAT
              GO TO FIN-PRO-POC.

           MOVE ZEROES TO  WSS-NUM-LPOC IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-MPOC IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-EPOC IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-DPOC IN WSS-VARI.
      *
       LUP-PRO-POC.
           ADD 1 TO WSS-NUM-LPOC IN WSS-VARI.
      *
           IF POC-COD-SEGD IN POC NOT = 'SEGDES' AND
              POC-COD-SEGD IN POC NOT = 'SEDECO'
               GO TO LEE-SIGUIENTE-POC.
      *
           IF POC-COD-SEGD IN POC = 'SEGDES'
              ADD 1 TO WSS-NUM-DPOC IN WSS-VARI.
      *
           IF POC-COD-SEGD IN POC = 'SEDECO'
              ADD 1 TO WSS-NUM-EPOC IN WSS-VARI.
      *
      *
           MOVE FIO-GET-KEY-UPD TO FIO-CMND
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO SE PUEDE UPD-POC '
               PERFORM BCK-OUT
               GO TO LEE-SIGUIENTE-POC.
      *
           DISPLAY ' KEY-POC : A MODIFICAR : '
                     POC-KEY-IPOC IN POC.
      *
           MOVE SPACES TO  POC-COD-SEGD IN POC.
      *
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO SE PUEDE MODIFICAR  POC '
               PERFORM BCK-OUT
               GO TO LEE-SIGUIENTE-POC.

           PERFORM CHK-PNT.

           ADD 1 TO WSS-NUM-MPOC IN WSS-VARI.
      *
      *
       LEE-SIGUIENTE-POC.
           MOVE FIO-GET-NXT   TO  FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'FIN DE ARCHIVO POC '
              GO TO FIN-PRO-POC.
           GO TO LUP-PRO-POC.
       FIN-PRO-POC.
           EXIT.

       CHK-PNT SECTION.
      *---------------*
       INI-CHK-PNT.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CHK-PNT ERRONEO: ' FIO-STAT.
       FIN-CHK-PNT.
           EXIT.

       BCK-OUT SECTION.
      *---------------*
       INI-BCK-PNT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'BCK-OUT ERRONEO: ' FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGPES.
      *
       COPY COLBFPOC.

