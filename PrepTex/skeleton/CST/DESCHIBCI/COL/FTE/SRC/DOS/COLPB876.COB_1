       IDENTIFICATION DIVISION.
      *************************
       PROGRAM-ID.     COLPB876.
      *AUTHOR.         DONOSO JARA OSVALDO.
000000*COMPILED SITE 2000          26.08.98
      *                DATE-WRITTEN,  30/08/94.
      *         PROCESO DIAS NO HABILES
      *         SI LA FECHA GENERADA - 1 ES NOHABIL, BUSCAR DIA HANT
      *         Y PROCESAR DESDE ESTE + 1 HASTA FECHA GENERADA
      *         1. UBICAR FECHA PARAM - N DIAS HABILES
      *         2. SI DIA CAL ANTERIOR ES NHABIL, UBICAR HABIL
      *            ANTERIOR.
      *         3. AVANZAR 1 DIA HABIL CAL
      *         4. PROCESAR DESDE FECHA (3) HASTA FECHA (1)
      *  ESTRUCTURA PARAMETRO CANT DIAS:
      *   - DIA-1= 03 (BANCA NEGOCIOS)
      *   - DIA-2= 30 (BANCA NEGOCIOS)
      *   - DIA-3= 15 (BANCA PERSONAS)
      *   - DIA-4= 45 (BANCA PERSONAS)
      ******************************************************************
      * MANTENCION. 14-03-98 P. RETAMAL
      *  SE CAMBIA BANCA NEGOCIOS POR BANCA EMPRESAS
      *   - DIA-1= 10 (BANCA EMPRESAS)
      *   - DIA-2= 99 (BANCA EMPRESAS) NO SE EMITE
      *   - DIA-3= 03 (BANCA PERSONAS)
      *   - DIA-4= 10 (BANCA PERSONAS) SE ENVIARA COMO TIPO = 1
      *  Sistema  : Colocaciones                                       *
      ******************************************************************
      *  Subsist. :                                                    *
      *  Analista : Retamal Pablo                                      *
      *  OBJETIVO : GENERA ARCHIVO CON DATOS PARA GENERAR CARTA AVISO  *
      *             DE MOROSIDAD.                                      *
      *                                                                *
      *  Archivos :                                                    *
      *   ENTRADA : OPC 160: TABLA DE OPERACIONES (CURSES)             *
      *             VEN 160: Tabla de vencimientos                     *
      *             RDC 160: Relacion deuda credito                    *
      *             DBC 100: Datos basicos de clinetes                 *
      *             DCP 100: DATOS CLIENTE PERSONA                     *
      *             DCE 100: DATOS CLIENTE EMPRESA                     *
      *             RCD 100: Relacion cliente direccion                *
      *                                                                *
      *   SALIDA  : COLVAVI: PARA EMITIR CARTA AVISO.                  *
      *                                                                *
      *   Ent/Sal :                                                    *
      *                                                                *
      *   Trabajo :                                                    *
      *                                                                *
      *  Mantenciones                                                  *
      *  ============                                                  *
      *            Programador: ...........................            *
      *            Fecha      : dd/mm/aa                               *
      *            Cambio     : ....................................   *
      *                         ....................................   *
      *                         ....................................   *
      *                                                                *
      ******************************************************************
      *** SINCRONIZADO AL 25/8/1998 (SE TOMA EL DE PRODUCCION)
           EJECT
       ENVIRONMENT DIVISION.
      **********************
       CONFIGURATION SECTION.
      *======================
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
           EJECT
       INPUT-OUTPUT SECTION.
      *=====================
       FILE-CONTROL.
           SELECT COLVAVI ASSIGN TO COLVAVI
                  FILE STATUS IS WR-FS-COLVAVI.
           SELECT ARCVIP  ASSIGN TO ARCVIP.

           EJECT
       DATA DIVISION.
      *==============
           SKIP3
       FILE SECTION.
      *=============
           SKIP1
       FD  ARCVIP
           BLOCK CONTAINS 0 RECORDS.

       01  R-ARCVIP.
           05 ARC-RUT-VIP    PIC X(08).
           05 FILLER         PIC X(01).
           05 ARC-VRF-VIP    PIC X(01).
           05 FILLER         PIC X(01).
           05 ARC-OPE-VIP    PIC X(12).

       FD  COLVAVI
           BLOCK CONTAINS 0 RECORDS.

       01  R-COLVAVI.
           05 AVI-IND-TCAR       PIC 9(01).
           05 AVI-COD-VCOC       PIC X(06).
           05 AVI-CIC-IOPC       PIC X(12).
           05 AVI-NUM-IVCT       PIC 9(03).
           05 AVI-FEC-FVEN       PIC X(08).
           05 AVI-FEC-FSEL       PIC X(08).
           05 AVI-VAL-SFIN       PIC 9(11)V9999.
           05 AVI-NOM-DDIR       PIC X(35).
           05 AVI-DIR-DDIR       PIC X(60).
           05 AVI-COM-DDIR       PIC X(20).
           05 AVI-NOM-DIND       PIC X(35).
           05 AVI-DIR-DIND       PIC X(60).
           05 AVI-COM-DIND       PIC X(20).

           SKIP1
       WORKING-STORAGE SECTION.
      *========================
       SKIP1
       01  W-SWITCHES.
           05 EOF-ARCVIP                    PIC 9(01) VALUE 0.
              88 FIN-ARCVIP          VALUE 1.
           05 WS-PROCESO                    PIC 9(01) VALUE 0.
              88 WS-PROCESO-OK       VALUE 0.
              88 WS-PROCESO-ERROR    VALUE 1.
           05 WS-INTERES                    PIC S9(11)V9(4) VALUE 0.
       SKIP1
       01  W-PARAMETROS.
           05 FILLER                        PIC X(20).
           05 WP-FECHA-PRO.
              10 WP-ANO-PRO                 PIC X(04).
              10 WP-MES-PRO                 PIC X(02).
              10 WP-DIA-PRO                 PIC X(02).
           05 FILLER                        PIC X(01).
           05 WP-NUM-DIA-1                  PIC 9(03).
           05 FILLER                        PIC X(01).
           05 WP-NUM-DIA-2                  PIC 9(03).
           05 FILLER                        PIC X(01).
           05 WP-NUM-DIA-3                  PIC 9(03).
           05 FILLER                        PIC X(01).
           05 WP-NUM-DIA-4                  PIC 9(03).
           05 FILLER                        PIC X(01).
           05 WP-CLASE-1                    PIC X(06).
           05 FILLER                        PIC X(01).
           05 WP-CLASE-2                    PIC X(06).
           05 FILLER                        PIC X(01).
           05 WP-CLASE-3                    PIC X(06).
           05 FILLER                        PIC X(01).
           05 WP-CLASE-4                    PIC X(06).
           05 FILLER                        PIC X(01).
           05 WP-CLASE-5                    PIC X(06).
           05 FILLER                        PIC X(01).
       SKIP1
       01  W-CONTADORES-Y-ACUMULADORES.
           05 WA-L-RCD                      PIC 9(06) VALUE 0.
           05 WA-L-RDC                      PIC 9(06) VALUE 0.
           05 WA-L-OPC                      PIC 9(06) VALUE 0.
           05 WA-L-VEN                      PIC 9(06) VALUE 0.
           05 WA-L-DBC                      PIC 9(06) VALUE 0.
           05 WA-G-MOR                      PIC 9(06) VALUE 0.
           SKIP1
       01  TABLAS.
           05 TB-VIP OCCURS 3000 DEPENDING ON DO-TB-VIP
                                 INDEXED   BY IB-TB-VIP.
              10 TB-RUT-VIP    PIC X(08).
              10 TB-VRF-VIP    PIC X(01).
              10 TB-OPE-VIP    PIC X(12).

       01  W-REGISTROS-DE-TRABAJO.
           05 WR-RUT-DD     PIC X(08).
           05 DO-TB-VIP                     PIC 9(06) VALUE 0.
           05 WR-FS-COLVAVI                 PIC 9(02) VALUE 0.
           05 WR-FECHA-HOY.
              10 WR-HOY-AA                  PIC X(02).
              10 WR-HOY-MM                  PIC X(02).
              10 WR-HOY-DD                  PIC X(02).
           05 WR-FECHA-INI.
              10 WR-ANO-INI                 PIC X(04).
              10 WR-MES-INI                 PIC X(02).
              10 WR-DIA-INI                 PIC X(02).
           05 WK-FECHA-1                    PIC X(08).
           05 WK-FECHA-2                    PIC X(08).
           05 WK-FECHA-3                    PIC X(08).
           05 WK-FECHA-4                    PIC X(08).
           05 WK-FECHA-11                   PIC X(08).
           05 WK-FECHA-22                   PIC X(08).
           05 WK-FECHA-33                   PIC X(08).
           05 WK-FECHA-44                   PIC X(08).
           05 WK-COD-TBAN                   PIC X(03) VALUE SPACES.
           05 WK-COD-TBAN-RED REDEFINES WK-COD-TBAN.
              10 WK-TIPO                    PIC X(01).
              10 WK-FILLER                  PIC X(02).
           05 WK-IND-PROC                   PIC 9(01) VALUE 0.
           05 WR-FECHA-FIN.
              10 WR-ANO-FIN                 PIC X(04).
              10 WR-MES-FIN                 PIC X(02).
              10 WR-DIA-FIN                 PIC X(02).
           05 WR-MENSAJES.
              10 WR-SECCION                 PIC X(15).
              10 WR-PARRAFO                 PIC X(15).
              10 WR-ARCHIVO                 PIC X(10).
              10 WR-OPERACI                 PIC X(10).
              10 WR-FILE-ST                 PIC X(02).
              10 WR-MENSAJE                 PIC X(35).
      ******************************************************************
      *    DEFINICION DE AREAS PARA RUTINA CALENDAR.                   *
      ******************************************************************
      ******************************************************************
      *
       01  RTNWCALE.
      *
      * AREA DE LLAMADA A SUBRUTINA "RTNUCALE"
      *
      * ***  FUNCIONES VALIDAS PARA SUBRUTINA  ***
      *
      * AVNDC  : AVANZA N DIAS CALENDARIO (N = 0 A 99999)
      * AVNDH  : AVANZA N DIAS HABILES (N = 0 A 99999)
      * BDCA   : BUSCA DIA CALENDARIO ANTERIOR
      * BDCS   : BUSCA DIA CALENDARIO SIGUIENTE
      * BDHA   : BUSCA DIA HABIL ANTERIOR
      * BDHS   : BUSCA DIA HABIL SIGUIENTE
      * BPDCM  : BUSCA PRIMER DIA CALENDARIO MES (ACTUAL)
      * BPDCMA : BUSCA PRIMER DIA CALENDARIO MES ANTERIOR
      * BPDCMS : BUSCA PRIMER DIA CALENDARIO MES SIGUIENTE
      * BPDHM  : BUSCA PRIMER DIA HABIL MES (ACTUAL)
      * BPDHMA : BUSCA PRIMER DIA HABIL MES ANTERIOR
      * BPDHMS : BUSCA PRIMER DIA HABIL MES SIGUIENTE
      * BUDCM  : BUSCA ULTIMO DIA CALENDARIO MES (ACTUAL)
      * BUDCMA : BUSCA ULTIMO DIA CALENDARIO MES ANTERIOR
      * BUDCMS : BUSCA ULTIMO DIA CALENDARIO MES SIGUIENTE
      * BUDHM  : BUSCA ULTIMO DIA HABIL MES (ACTUAL)
      * BUDHMA : BUSCA ULTIMO DIA HABIL MES ANTERIOR
      * BUDHMS : BUSCA ULTIMO DIA HABIL MES SIGUIENTE
      * CARGAR : CARGA ARCHIVO CALENDARIO EN MEMORIA DESDE UNA FECHA
      * CDCEF  : CALCULA DIFERENCIA DE DIAS CALENDARIO ENTRE FECHAS
      * INFO   : ENTREGA INFORMACION ACERCA DE UNA FECHA
      * RENDC  : RETROCEDE N DIAS CALENDARIO (N = 0 A 99999)
      * RENDH  : RETROCEDE N DIAS HABILES (N = 0 A 99999)
      *
           05 CALEAREA-FUNCION              PIC X(06).
           05 CALEAREA-FECHA-1              PIC X(08).
           05 R1-CALEAREA-FECHA-1         REDEFINES CALEAREA-FECHA-1.
              10 CALEAREA-FECHA-1-D         PIC 9(02).
              10 CALEAREA-FECHA-1-M         PIC 9(02).
              10 CALEAREA-FECHA-1-A         PIC 9(04).
              10 R1-CALEAREA-FECHA-1-A    REDEFINES CALEAREA-FECHA-1-A.
                 15 CALEAREA-FECHA-1-AM     PIC 9(02).
                 15 CALEAREA-FECHA-1-AA     PIC 9(02).
           05 CALEAREA-FECHA-2              PIC X(08).
           05 R1-CALEAREA-FECHA-2         REDEFINES CALEAREA-FECHA-2.
              10 CALEAREA-FECHA-2-D         PIC 9(02).
              10 CALEAREA-FECHA-2-M         PIC 9(02).
              10 CALEAREA-FECHA-2-A         PIC 9(04).
              10 R1-CALEAREA-FECHA-2-A    REDEFINES CALEAREA-FECHA-2-A.
                 15 CALEAREA-FECHA-2-AM     PIC 9(02).
                 15 CALEAREA-FECHA-2-AA     PIC 9(02).
           05 CALEAREA-NUM-DIA              PIC S9(8).
           05 CALEAREA-TIP-DIA              PIC X(01).
           05 CALEAREA-INI-DIA              PIC X(02).
           05 CALEAREA-COD-RET              PIC 9(02).
      *
      ******************************************************************
      *---------------------------------------------------------------*
      * VARAIBLES DE RUTINA GENESIS PARA COMPACTAR NOMBRES            *
      *---------------------------------------------------------------*
           COPY GNSWGCPT.
      ******************************************************************
      *      AREAS DE USO PARA DATACOM                                 *
      ******************************************************************
      *
       01  WB-UIB.
           05 FILLER                        PIC X(32) VALUE 'COLPB876'.
      *
       01  WB-REQ-RDC-AREA.
           02 WB-REQ-RDC-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'RDC'.
           02 FILLER                        PIC X(5) VALUE 'RDC01'.
           02 WB-REQ-RDC-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-RDC-KEY-VALUE.
              03 WB-REQ-RDC-KEY-OPC         PIC X(12).
              03 WB-REQ-RDC-KEY-REL         PIC X(03).

       01  WB-REQ-OPC-AREA.
           02 WB-REQ-OPC-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'OPC'.
           02 FILLER                        PIC X(5) VALUE 'OPC00'.
           02 WB-REQ-OPC-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-OPC-KEY-VALUE          PIC X(12).

       01  WB-REQ-DLC-AREA.
           02 WB-REQ-DLC-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DLC'.
           02 FILLER                        PIC X(5) VALUE 'DLC00'.
           02 WB-REQ-DLC-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DLC-KEY-VALUE-1        PIC X(12).
           02 WB-REQ-DLC-KEY-VALUE-2        PIC 9(03).

       01  WB-REQ-VEN-AREA.
           02 WB-REQ-VEN-CMD                PIC X(5) VALUE 'REDKG'.
           02 FILLER                        PIC X(3) VALUE 'VEN'.
           02 FILLER                        PIC X(5) VALUE 'VEN01'.
           02 WB-REQ-VEN-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-VEN-KEY-VALUE          PIC X(08).

       01  WB-REQ-VEN-AREA-R.
           02 WB-REQ-VEN-CMD-R              PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'VEN'.
           02 FILLER                        PIC X(5) VALUE 'VEN00'.
           02 WB-REQ-VEN-RC-R               PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-VEN-KEY-VALUE-R.
              05 WB-REQ-VEN-KEY-1           PIC X(12).
              05 WB-REQ-VEN-KEY-2           PIC 9(03).

       01  WB-REQ-DBC-AREA.
           02 WB-REQ-DBC-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DBC'.
           02 FILLER                        PIC X(5) VALUE 'DBC00'.
           02 WB-REQ-DBC-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DBC-KEY-VALUE          PIC X(12).

       01  WB-REQ-RCD-AREA.
           02 WB-REQ-RCD-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'RCD'.
           02 FILLER                        PIC X(5) VALUE 'RCD00'.
           02 WB-REQ-RCD-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-RCD-KEY-VALUE.
              03 WB-REQ-RCD-KEY-CLI         PIC X(12).
              03 WB-REQ-RCD-KEY-DIR         PIC X(02).

       01  WB-REQ-DCP-AREA.
           02 WB-REQ-DCP-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DCP'.
           02 FILLER                        PIC X(5) VALUE 'DCP00'.
           02 WB-REQ-DCP-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DCP-KEY-VALUE.
              03 WB-REQ-DCP-KEY-CIC         PIC X(12).

       01  WB-REQ-DCE-AREA.
           02 WB-REQ-DCE-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DCE'.
           02 FILLER                        PIC X(5) VALUE 'DCE00'.
           02 WB-REQ-DCE-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DCE-KEY-VALUE.
              03 WB-REQ-DCE-KEY-CIC         PIC X(12).

      *
       01  WB-REQ-TAB-AREA.
           02 WB-REQ-TAB-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'TAB'.
           02 FILLER                        PIC X(5) VALUE 'TAB00'.
           02 WB-REQ-TAB-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +150.
           02 FILLER                        PIC X(58).
           02 WB-REQ-TAB-KEY-VALUE.
              03 WB-REQ-TAB-KEY-TIP         PIC X(03) VALUE 'COM'.
              03 WB-REQ-TAB-KEY-COD         PIC X(03).
              03 WB-REQ-TAB-KEY-RESTO       PIC X(12) VALUE SPACES.


      *    RELACION DEUDOR CREDITO
      *    -----------------------
      *
      *    NOMBRE REGISTRO : RDC
      *    CLAVE(S)        : RDC-KEY-IRDC(UU), RDC-KEY-IDLC(DU)
      *    LARGO           : 075
      *    BLOQUEO         : 1
      *    OBSERVACIONES   :
      *
      *    01) MODIFICACIONES 06/09/88, LJV
      *        - ELIMINACION CLAVE RDC-KEY-IREG
      *        - ESTANDARIZACION A HEADER TIPO LOG
      *        - MODIFICACION LARGO/BLOQUEO REGISTRO (064/1)
      *        - INCORPORACION CAMPO RDC-COD-TRDC
      *
       01  RDC.
      *
      *    FILLER COMPATIBILIDAD VSAM/MVS
           03  RDC-GLS-FLAG                             PIC X(01).
      *
      *    CLAVE PRIMARIA REGISTRO
           03  RDC-KEY-IREG.
      *
      *KEY     IDENTIFICACION RELACION DEUDOR CREDITO
               05  RDC-KEY-IRDC.
      *
      *            COD. INT. COMP. CLIENTE
                   07  RDC-CIC-ICLI.
      *
      *                CENTRO ASIGNACION IDENTIFICACION
                       09  RDC-CAI-ICLI.
                           11  RDC-COD-TCLI             PIC X(01).
                           11  RDC-COD-CCLI             PIC X(03).
      *
      *                IDENT. INTERNA COMPUTACIONAL
                       09  RDC-IIC-ICLI                 PIC X(08).
      *
      *            IDENTIFICACION DOCUMENTO LEGAL
                   07  RDC-KEY-IDLC.
      *
      *                COD. INT. COMP. OPERACION CURSADA
                       09  RDC-CIC-IOPC.
      *
      *                    CENTRO ASIGNACION IDENTIFICACION
                           11  RDC-CAI-IOPC.
                               13  RDC-COD-TOPC         PIC X(01).
                               13  RDC-COD-COPC         PIC X(03).
      *
      *                    IDENT. INTERNA COMPUTACIONAL
                           11  RDC-IIC-IOPC.
                               13  RDC-COD-OOPC.
                                   15  RDC-COD-SOPC     PIC X(02).
                                   15  RDC-IND-SOPC     PIC X(01).
                               13  RDC-GLS-NOPC         PIC X(05).
      *
      *                NUM IDENTIFICACION DOCUMENTO LEGAL
                       09  RDC-NUM-IDLC                 PIC 9(03).
      *
      *ING-01
      *        CODIGO TIPO RELACION                     COL RDC
               05  RDC-COD-TRDC                         PIC X(03).
      *
      *        TIME STAMP TRANSACCION
               05  RDC-STP-ITRN.
      *
      *            FECHA TRANSACCION
                   07  RDC-FEC-FTRN.
                       09  RDC-NUM-STRN                 PIC 9(02).
                       09  RDC-NUM-ATRN                 PIC 9(02).
                       09  RDC-NUM-MTRN                 PIC 9(02).
                       09  RDC-NUM-DTRN                 PIC 9(02).
      *
      *            HORA TRANSACCION
                   07  RDC-HRA-HRTR.
                       09  RDC-NUM-HHTR                 PIC 9(02).
                       09  RDC-NUM-MMTR                 PIC 9(02).
                       09  RDC-NUM-SSTR                 PIC 9(02).
      *
      *REQ INDICADOR TIPO ACCION
           03  RDC-MSC-TACC                             PIC X(01).
      *
      *    INDICADOR STATUS
           03  RDC-MSC-STAT                             PIC X(01).
      *
      *REQ CODIGO ORIGEN TRANSACCION
           03  RDC-COD-OTRN.
      *
      *        INDICADOR TIPO ORIGEN
               05  RDC-MSC-TTRN                         PIC X(01).
      *
      *        CODIGO TIPO ORIGEN
               05  RDC-COD-TTRN                         PIC X(03).
      *
      *REQ AUTOR TRANSACCION
           03  RDC-COD-ATRN                             PIC X(12).
      *
      *PEN DIRECCION ASOCIADA
           03  RDC-NUM-DIRE                             PIC X(02).
      *
      *REQ MONTO LIMITE DEUDA ( PORCENTAJE )
           03  RDC-VAL-LIMD             COMP            PIC 9(03)V9(06).
      *
      *MOD-01  PIC X(11)
      *    GLOSA DISPONIBLE
           03  RDC-GLS-DISP                             PIC X(06).
      *    Operacion Credito
      *    -----------------
      *
      *    Nombre Registro : OPC
      *    Clave(s)        : OPC-KEY-IOPC(UU), OPC-FEC-FCOL(DC),
      *                      OPC-FEC-FING(DC), OPC-FEC-FINP(DC)
      *    Largo           : 245
      *    Bloqueo         : 2
      *    Observaciones   :
      *
      *    01) Modificaciones 06/09/88, LJV
      *        - Eliminacion Clave OPC-STP-ITRN
      *    02) Modificaciones 11/10/89, ALD
      *        - Cambio nombre campo OPC-NUM-IEVC
      *          por  OPC-NUM-IVEN
      *        - Ingreso campo OPC-IND-VSTR
      *    03) Modificacion  30/06/93,  DAD
      *        - Modificado Largo/Bloqueo del registro, de 218/4 a 245/2
      *          aumentando la Glosa Disponible.
      *    04) Modificacion  06/09/95,  ALD
      *        - Ingreso Campo OPC-VAL-SEGP
      *        - Modificado Glosa Disponible de 28 a 20
      *    05) Modificacion  17/05/1999,ALD
      *        - Ingreso Campo OPC-VAL-SEGC
      *        - Modificado Glosa Disponible de 20 a 12
      *
       01  OPC.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  OPC-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  OPC-KEY-IREG.
      *
      *KEY     Identificacion Operacion Credito
               05  OPC-KEY-IOPC.
      *
      *            Cod. Int. Comp. Operacion Credito
                   07  OPC-CIC-IOPC.
      *
      *                Centro Asignacion Identificacion
                       09  OPC-CAI-IOPC.
                           11  OPC-COD-TOPC             PIC X(01).
                           11  OPC-COD-COPC             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  OPC-IIC-IOPC.
                           11  OPC-COD-OOPC.
                               13  OPC-COD-SOPC         PIC X(02).
                               13  OPC-IND-SOPC         PIC X(01).
                           11  OPC-GLS-NOPC             PIC X(05).
      *
      *        Time Stamp Transaccion
               05  OPC-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  OPC-FEC-FTRN.
                       09  OPC-NUM-STRN                 PIC 9(02).
                       09  OPC-NUM-ATRN                 PIC 9(02).
                       09  OPC-NUM-MTRN                 PIC 9(02).
                       09  OPC-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  OPC-HRA-HRTR.
                       09  OPC-NUM-HHTR                 PIC 9(02).
                       09  OPC-NUM-MMTR                 PIC 9(02).
                       09  OPC-NUM-SSTR                 PIC 9(02).
      *
      *REQ Indicador Tipo Accion
           03  OPC-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  OPC-MSC-STAT                             PIC X(01).
               88  OPC-INGRESADA               VALUE 'I'.
               88  OPC-MODIFICADA              VALUE 'M'.
               88  OPC-APROBADA-CTC            VALUE 'F'.
               88  OPC-LIQUIDADA-CTC           VALUE 'K'.
               88  OPC-LIQUIDADA-LIQ           VALUE 'L'.
               88  OPC-ACTIVADA                VALUE 'A'.
               88  OPC-ESPERA-OPC              VALUE 'C'.
               88  OPC-ESPERA-ENVIO-ABONO-DIF  VALUE 'B'.
               88  OPC-ESPERA-ENVIO-ABONO      VALUE 'G'.
               88  OPC-ESPERA-CONF-ABONO       VALUE 'H'.
               88  OPC-ESPERA-ABONO-X          VALUE 'X'.
               88  OPC-SUSPENDIDA              VALUE 'S'.
               88  OPC-DESACTIVADA             VALUE 'D'.
               88  OPC-ACTUALIZADA             VALUE 'I' 'M'.
               88  OPC-PENDIENTE-CTC           VALUE 'F' 'K'.
               88  OPC-LIQUIDADA               VALUE 'L' 'K'.
               88  OPC-ESPERA-ABONO            VALUE 'B' 'G' 'H' 'X'.
      * RBG INI 10-APR-1996
               88  OPC-APROBADA-APR            VALUE 'J'.
      * RBG FIN 10-APR-1996
      *
      *REQ Codigo Origen Transaccion
           03  OPC-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  OPC-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  OPC-COD-TTRN                         PIC X(03).
      *
      *REQ Autor Transaccion
           03  OPC-COD-ATRN                             PIC X(12).
      *
      *REQ Valor de Cambio Operacion Credito            TAB VLR
           03  OPC-COD-VCOC.
      *
      *        Miscelaneo Tipo Valor                    TAB TVAL
               05  OPC-MSC-TVOC                         PIC X(01).
      *
      *        Codigo Valor
               05  OPC-COD-CVOC                         PIC X(03).
      *
      *        Codigo Tipo Cambio
               05  OPC-COD-TCOC                         PIC X(02).
      *
      *REQ Codigo Clase Operacion Credito               COL AUX
           03  OPC-COD-COOC.
      *
      *        Codigo Tipo Operacion                    COL TOC
               05  OPC-COD-TOOC                         PIC X(03).
      *
      *        Codigo Auxiliar Operacion
               05  OPC-COD-AOOC                         PIC X(03).
      *
      *REQ Codigo Oficina Operacion Credito             TAB OFI
           03  OPC-COD-OFOC                             PIC X(03).
      *
      *    Responsable Mantencion Operacion Credito     TAB USR
           03  OPC-COD-RMOC                             PIC X(12).
      *
      *    Codigo Destino Operacion Credito             COL DES
           03  OPC-COD-CDOC                             PIC X(03).
      *
      *    Cod. Int. Comp. Linea de Credito
           03  OPC-CIC-ILDC.
      *
      *        Centro Asignacion Identificacion
               05  OPC-CAI-ILDC.
                   07  OPC-COD-TLDC                     PIC X(01).
                   07  OPC-COD-CLDC                     PIC X(03).
      *
      *        Ident. Interna Computacional
               05  OPC-IIC-ILDC.
                   07  OPC-COD-OLDC.
                       09  OPC-COD-SLDC                 PIC X(02).
                       09  OPC-IND-SLDC                 PIC X(01).
                   07  OPC-GLS-NLDC                     PIC X(05).
      *
      *REQ Fecha Curse o Colocacion
           03  OPC-FEC-FCOL.
               05  OPC-NUM-SCOL                         PIC 9(02).
               05  OPC-NUM-ACOL                         PIC 9(02).
               05  OPC-NUM-MCOL                         PIC 9(02).
               05  OPC-NUM-DCOL                         PIC 9(02).
      *
      *REQ Fecha Curse Contable
           03  OPC-FEC-FING.
               05  OPC-NUM-SING                         PIC 9(02).
               05  OPC-NUM-AING                         PIC 9(02).
               05  OPC-NUM-MING                         PIC 9(02).
               05  OPC-NUM-DING                         PIC 9(02).
      *
      *REQ Fecha Curse Computacional
           03  OPC-FEC-FINP.
               05  OPC-NUM-SINP                         PIC 9(02).
               05  OPC-NUM-AINP                         PIC 9(02).
               05  OPC-NUM-MINP                         PIC 9(02).
               05  OPC-NUM-DINP                         PIC 9(02).
      *
      *REQ Monto Credito
           03  OPC-VAL-CRED             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Saldo Valor Credito K Capital Insoluto
           03  OPC-VAL-SCRE             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Analisis Feriados (S/N)                      COL AFER
           03  OPC-IND-AFER                             PIC X(01).
      *
      *REQ Modalidad Calculo Valores Finales            COL MCVF
           03  OPC-MSC-MCVF                             PIC X(01).
      *
      *REQ Tipo Calculo Vencimientos                    COL TCVE
           03  OPC-MSC-TCVE.
      *
      *        Base Calculo Credito                     COL BCCR
               05  OPC-MSC-BCCR                         PIC X(01).
      *
      *        Valores Informados Credito               COL VICR
               05  OPC-MSC-VICR                         PIC X(01).
      *
      *    Tipo Renovacion                              COL RENO
           03  OPC-IND-RENO                             PIC X(03).
      *
      *    Condicion Garantia                           COL GARA
           03  OPC-IND-GARA                             PIC X(03).
      *
      *    Valor Comision
           03  OPC-SGV-VCOM             COMP-3          PIC S9(11)V9(4).
      *
      *    Valor Gastos
           03  OPC-VAL-GAST             COMP-3          PIC S9(11)V9(4).
      *
      *    Codigo de Seguro Desgravamen                 TAB IVB
           03  OPC-COD-SEGD.
               05  OPC-COD-ISEG                         PIC X(03).
               05  OPC-COD-CSEG                         PIC X(03).
               05  OPC-COD-SSEG                         PIC X(03).
      *
      *    Valor Seguro
           03  OPC-VAL-SEGD             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Liquido
           03  OPC-SGV-LIQU             COMP-3          PIC S9(11)V9(4).
      *
      *MOD-02
      *REQ Numero Proximo Vencimiento
           03  OPC-NUM-IVEN                             PIC 9(03).
      *
      *REQ Numero Vencimientos Originales
           03  OPC-NUM-VCOR                             PIC 9(03).
      *
      *REQ Numero Vencimientos Vigentes
           03  OPC-NUM-VCVG                             PIC 9(03).
      *
      *    Numero Venctos Cancelados en forma Oportuna
           03  OPC-NUM-VCCO                             PIC 9(03).
      *
      *    Numero Vencimientos Cancelados Morosos
           03  OPC-NUM-VCCM                             PIC 9(03).
      *
      *    Numero de Vencimientos Cancelados Vencidos
           03  OPC-NUM-VCCV                             PIC 9(03).
      *
      *REQ Numero Total Vencimientos Cancelados
           03  OPC-NUM-TVCC                             PIC 9(03).
      *
      *ING-02
      *    Indicador Vencimientos Estructurados
           03  OPC-IND-VSTR                             PIC X(01).
      *
      *    Cod. Int. Comp. Credito Enlace
           03  OPC-CIC-ICEN.
      *
      *        Centro Asignacion Identificacion
               05  OPC-CAI-ICEN.
                   07  OPC-COD-TCEN                     PIC X(01).
                   07  OPC-COD-CCEN                     PIC X(03).
      *
      *        Ident. Interna Computacional
               05  OPC-IIC-ICEN.
                   07  OPC-COD-OCEN.
                       09  OPC-COD-SCEN                 PIC X(02).
                       09  OPC-IND-SCEN                 PIC X(01).
                   07  OPC-GLS-NCEN                     PIC X(05).
      *
      *    Codigo Area Gestion                          COL GES
           03  OPC-COD-AGES                             PIC X(02).
      *
      *    Flag para activar sin contabilizar
           03 OPC-IND-CTBL                              PIC X(01).
      *
      *    Indicador Insistencia
           03 OPC-COD-INSI                              PIC X(01).
      *
      *    Canal de Venta
           03 OPC-COD-CVTA                              PIC X(01).
      *
      *MOD-04
      *    Valor Seguro
           03  OPC-VAL-SEGP             COMP-3          PIC 9(11)V9(04).
      *
      *MOD-05
      *    Valor Seguro Cesantia
           03  OPC-VAL-SEGC             COMP-3          PIC 9(11)V9(04).
      *
      *MOD-05
      *    Glosa Disponible
           03  OPC-GLS-DISP                             PIC X(12).
      *    Documento Legal Credito
      *    -----------------------
      *
      *    Nombre Registro : DLC
      *    Clave(s)        : DLC-KEY-IDLC(UU), DLC-IND-SCTB(DC)
      *    Largo           : 283
      *    Bloqueo         : 4
      *    Observaciones   :
      *
      *    01) Modificaciones 06/09/88, LJV
      *        - Eliminacion Clave DLC-KEY-IREG
      *        - Modificacion Largo/Bloqueo registro (194/2)
      *        - Estandarizacion a Header tipo Log
      *        - Eliminacion campo DLC-MSC-TCVE
      *        - Incorporacion campo DLC-IND-SCTB
      *        - Incorporacion campo DLC-FEC-FMAV
      *    02) Modificaciones 03/10/89, ISP
      *        - Creacion de llave DLC-IND-SCTB duplicada y modificable
      *        - Ingreso campo DLC-NUM-VSCE
      *        - Modificacion disponible
      *    03) Modificacion  15/12/92,  DAD
      *        - Creacion de campo DLC-DMA-FSDE redefiniendo el Disponib
      *    04) Modificacion  30/06/93,  DAD
      *        - Modificado largo y campo DLC-DMA-FSDE por DLC-FEC-FSDE
      *        - Modificado Largo/Bloqueo del registro, de 218/4 a 283/4
      *          aumentada la Glosa Disponible.
      *    05) Modificacion 25/04/95,  JUS
      *        - Creacion campos: DLC-COD-SUSP
      *                           DLC-FEC-FSDM
      *        - Glosa Disponible queda en 11.
      *
       01  DLC.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  DLC-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  DLC-KEY-IREG.
      *
      *        Identificacion Documento Legal                        KEY
               05  DLC-KEY-IDLC.
      *
      *            Cod. Int. Comp. Operacion Credito
                   07  DLC-CIC-IOPC.
      *
      *                Centro Asignacion Identificacion
                       09  DLC-CAI-IOPC.
                           11  DLC-COD-TOPC             PIC X(01).
                           11  DLC-COD-COPC             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  DLC-IIC-IOPC.
                           11  DLC-COD-OOPC.
                               13  DLC-COD-SOPC         PIC X(02).
                               13  DLC-IND-SOPC         PIC X(01).
                           11  DLC-GLS-NOPC             PIC X(05).
      *
      *            Num Identificacion Documento Legal
                   07  DLC-NUM-IDLC                     PIC 9(03).
      *
      *        Time Stamp Transaccion
               05  DLC-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  DLC-FEC-FTRN.
                       09  DLC-NUM-STRN                 PIC 9(02).
                       09  DLC-NUM-ATRN                 PIC 9(02).
                       09  DLC-NUM-MTRN                 PIC 9(02).
                       09  DLC-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  DLC-HRA-HRTR.
                       09  DLC-NUM-HHTR                 PIC 9(02).
                       09  DLC-NUM-MMTR                 PIC 9(02).
                       09  DLC-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion                                     REQ
           03  DLC-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  DLC-MSC-STAT                             PIC X(01).
      *
      *    Codigo Origen Transaccion                                 REQ
           03  DLC-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  DLC-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  DLC-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion                                         REQ
           03  DLC-COD-ATRN                             PIC X(12).
      *
      *    Valor Nominal Documento Legal                             REQ
           03  DLC-VAL-NDLC             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Saldo Documento Legal                               REQ
           03  DLC-VAL-SDLC             COMP-3          PIC 9(11)V9(04).
      *
      *    Codigo Tipo Documento                        TAB DOC      REQ
           03  DLC-COD-TDOC                             PIC X(03).
      *
      *    Codigo Plazo ( Contable )                    TAB PZO      REQ
           03  DLC-COD-PLZO.
               05  DLC-MSC-TPZO                         PIC X(01).
               05  DLC-MSC-CPZO                         PIC X(01).
      *
      *    Tipo Impuestos                               COL TIMP
           03  DLC-MSC-TIMP                             PIC X(01).
      *
      *    Valor Impuestos
           03  DLC-VAL-IMPU             COMP-3          PIC 9(11)V9(04).
      *
      *    Codigo Notario Credito                       TAB IVB
           03  DLC-COD-NOTC.
               05  DLC-COD-INOT                         PIC X(03).
               05  DLC-COD-CNOT                         PIC X(03).
               05  DLC-COD-SNOT                         PIC X(03).
      *
      *    Valor Gastos Notario
           03  DLC-VAL-GNOT             COMP-3          PIC 9(11)V9(04).
      *
      *    Situacion Cobranza                           COL SCBZ
           03  DLC-IND-SCBZ                             PIC X(05).
      *
      *    Situacion Cartera                            COL SCRT     REQ
           03  DLC-IND-SCRT                             PIC X(03).
      *
      *    Codigo Ubicacion Fisica                      TAB IVB
           03  DLC-COD-UBFD.
               05  DLC-COD-IUBF                         PIC X(03).
               05  DLC-COD-CUBF                         PIC X(03).
               05  DLC-COD-SUBF                         PIC X(03).
      *
      *    Codigo Plaza                                 TAB PZA      REQ
           03  DLC-COD-PLZA                             PIC X(04).
      *
      *    Manejo Intereses Periodos Largos             COL MIPL     REQ
           03  DLC-MSC-MIPL                             PIC X(01).
      *
      *    Tipo Calculo Vencimientos                    COL TCVE
      *    03  DLC-MSC-TCVE.
      *
      *        Base Calculo Credito                     COL BCCR
      *        05  DLC-MSC-BCCR                         PIC X(01).
      *
      *        Valores Informados Credito               COL VICR
      *        05  DLC-MSC-VICR                         PIC X(01).
      *
      *    Clasificacion Riesgo                         DEU RIES     REQ
           03  DLC-IND-RIES                             PIC X(02).
      *
      *    Valor Reajustes Devengados Documento Legal                PEN
           03  DLC-VAL-READ             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Intereses Devengados Documento Legal                PEN
           03  DLC-VAL-INTD             COMP-3          PIC 9(11)V9(04).
      *
      *    Fecha Devengo ( Ultimo Pago Total Intereses )             REQ
           03  DLC-FEC-FDEV.
               05  DLC-NUM-SDEV                         PIC 9(02).
               05  DLC-NUM-ADEV                         PIC 9(02).
               05  DLC-NUM-MDEV                         PIC 9(02).
               05  DLC-NUM-DDEV                         PIC 9(02).
      *
      *    Saldo Intereses
           03  DLC-VAL-SINT             COMP-3          PIC 9(11)V9(04).
      *
      *    Saldo Capital por Amortizar
           03  DLC-VAL-SCPA             COMP-3          PIC 9(11)V9(04).
      *
      *    Fecha Amortizacion
           03  DLC-FEC-FAMT.
               05  DLC-NUM-SAMT                         PIC 9(02).
               05  DLC-NUM-AAMT                         PIC 9(02).
               05  DLC-NUM-MAMT                         PIC 9(02).
               05  DLC-NUM-DAMT                         PIC 9(02).
      *
      *    Identificacion Documento Legal Original
           03  DLC-KEY-IDLO.
      *
      *        Cod. Int. Comp. Operacion Credito Original
               05  DLC-CIC-IOCO.
      *
      *            Centro Asignacion Identificacion
                   07  DLC-CAI-IOCO.
                       09  DLC-COD-TOCO                 PIC X(01).
                       09  DLC-COD-COCO                 PIC X(03).
      *
      *            Ident. Interna Computacional
                   07  DLC-IIC-IOCO.
                       09  DLC-COD-OOCO.
                           11  DLC-COD-SOCO             PIC X(02).
                           11  DLC-IND-SOCO             PIC X(01).
                       09  DLC-GLS-NOCO                 PIC X(05).
      *
      *        Num Ident Documento Legal Original
               05  DLC-NUM-IDLO                         PIC 9(03).
      *
      *    Monto Intereses Pendientes
           03  DLC-VAL-IPEN             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Docto en Pesos (Cuadre Contabilidad)                REQ
           03  DLC-VAL-DPES             COMP-3          PIC 9(11)V9(04).
      *
      *    Indicador Situacion Contable                 COL SCTB
           03  DLC-IND-SCTB                             PIC X(03).
      *
      *    Fecha Maximo Vencimiento
           03  DLC-FEC-FMAV.
               05  DLC-NUM-SMAV                         PIC 9(02).
               05  DLC-NUM-AMAV                         PIC 9(02).
               05  DLC-NUM-MMAV                         PIC 9(02).
               05  DLC-NUM-DMAV                         PIC 9(02).
      *ING-02
      *    Cantidad de venciminetos en situacion contable especial
      *    ( NOT = SPACES )
      *    Cero ==> todos los vencimientos estan en la misma
      *             situacion contable
      *    Distinto de cero ==> Existen vencimientos en distintas
      *                         situaciones contables
      *
           03  DLC-NUM-VSCE                             PIC 9(03).
      *
      *MOD-04
      *MOD-03 ( DLC-DMA-FSDE )
      *    Fecha Suspension Devengo (Por Clasificacion de Riesgo)
           03  DLC-FEC-FSDE.
               05  DLC-NUM-SSDE                         PIC 9(02).
               05  DLC-NUM-ASDE                         PIC 9(02).
               05  DLC-NUM-MSDE                         PIC 9(02).
               05  DLC-NUM-DSDE                         PIC 9(02).
      *
      *MOD-04
           03  DLC-VAL-PIMP                             PIC 9(11).
      *MOD-05 INI
      *    Causal de Suspension de Devengo.
           03  DLC-COD-SUSP                             PIC X(01).
      *
      *    Fecha Suspension Devengo por Mora
           03  DLC-FEC-FSDM.
               05  DLC-NUM-SSDM                         PIC 9(02).
               05  DLC-NUM-ASDM                         PIC 9(02).
               05  DLC-NUM-MSDM                         PIC 9(02).
               05  DLC-NUM-DSDM                         PIC 9(02).
      *
      *    Glosa Disponible baja de (52 - 9) = 43
           03  DLC-GLS-DISP                             PIC X(43).
      *MOD-05 FIN
      *    Vencimientos
      *    ------------
      *
      *    Nombre Registro : VEN
      *    Clave(s)        : VEN-KEY-IVEN(UU), VEN-FEC-FVEN(DC),
      *                      VEN-IND-SCTB(DC)
      *    Largo           : 145
      *    Bloqueo         : 3
      *    Observaciones   :
      *
      *    01) Modificaciones 06/09/88, LJV
      *        - Eliminacion Clave VEN-KEY-IREG
      *        - Estandarizacion a Header tipo Log
      *        - Modificacion Largo/Bloqueo registro (117/1)
      *        - Cambio ubicacion campo IND-SCBZ
      *        - Incorporacion campo VAL-MTSC
      *    02) Modificaciones 23/09/88, PGV
      *    03) Modificacion  30/06/93,  DAD
      *        - Modificado Largo/Bloqueo del registro, de 137/2 a 145/3
      *          aumentando la Glosa Disponible.
      *
       01  VEN.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  VEN-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  VEN-KEY-IREG.
      *
      *KEY     Identificacion Vencimientos
               05  VEN-KEY-IVEN.
      *
      *            Cod. Int. Comp. Operac. Credito
                   07  VEN-CIC-IOPC.
      *
      *                Centro Asignac. Identificacion
                       09  VEN-CAI-IOPC.
                           11  VEN-COD-TOPC             PIC X(01).
                           11  VEN-COD-COPC             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  VEN-IIC-IOPC.
                           11  VEN-COD-OOPC.
                               13  VEN-COD-SOPC         PIC X(02).
                               13  VEN-IND-SOPC         PIC X(01).
                           11  VEN-GLS-NOPC             PIC X(05).
      *
      *            Num. Identificacion Vencimiento
                   07  VEN-NUM-IVEN                     PIC 9(03).
      *
      *        Time Stamp Transaccion
               05  VEN-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  VEN-FEC-FTRN.
                       09  VEN-NUM-STRN                 PIC 9(02).
                       09  VEN-NUM-ATRN                 PIC 9(02).
                       09  VEN-NUM-MTRN                 PIC 9(02).
                       09  VEN-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  VEN-HRA-HRTR.
                       09  VEN-NUM-HHTR                 PIC 9(02).
                       09  VEN-NUM-MMTR                 PIC 9(02).
                       09  VEN-NUM-SSTR                 PIC 9(02).
      *
      *REQ Indicador Tipo Accion
           03  VEN-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  VEN-MSC-STAT                             PIC X(01).
      *
      *REQ Codigo Origen Transaccion
           03  VEN-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  VEN-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  VEN-COD-TTRN                         PIC X(03).
      *
      *REQ Autor Transaccion
           03  VEN-COD-ATRN                             PIC X(12).
      *
      *REQ Fecha Vencimiento
           03  VEN-FEC-FVEN.
               05  VEN-NUM-SVEN                         PIC 9(02).
               05  VEN-NUM-AVEN                         PIC 9(02).
               05  VEN-NUM-MVEN                         PIC 9(02).
               05  VEN-NUM-DVEN                         PIC 9(02).
      *
      *REQ Fecha Inicio Mora Vcmto.
           03  VEN-FEC-FIMV.
               05  VEN-NUM-SIMV                         PIC 9(02).
               05  VEN-NUM-AIMV                         PIC 9(02).
               05  VEN-NUM-MIMV                         PIC 9(02).
               05  VEN-NUM-DIMV                         PIC 9(02).
      *
      *REQ Valor Capital Vencimiento
           03  VEN-VAL-CAPI             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Saldo Valor Capital Vcmto.
           03  VEN-VAL-SCAP             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Int Devengados no incluidos
      *    en Valor Final Vcto
           03  VEN-VAL-IDNI             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Valor Final Vencimiento
           03  VEN-VAL-FINA             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Saldo Valor Final Vcmto.
           03  VEN-VAL-SFIN             COMP-3          PIC 9(11)V9(04).
      *
      *    Situacion Contable                           COL SCTB
           03  VEN-IND-SCTB                             PIC X(03).
      *
      *REQ Num. Identificacion Vcmto.
           03  VEN-NUM-IVCT                             PIC 9(03).
      *
      *    Num. Identif. Estructura Vcmto.
           03  VEN-NUM-IEVC                             PIC 9(03).
      *
      *REQ Num Identif Documento Asociado
           03  VEN-NUM-IDLC                             PIC 9(03).
      *
      *    Indicador Cargo Automatico                   GNS VIGE
           03  VEN-IND-CAUT                             PIC X(01).
      *
      *    Situacion Cobranza                           COL SCBZ
           03  VEN-IND-SCBZ                             PIC X(05).
      *
      *ING-01
      *    Monto Trasp Situac Contable
           03  VEN-VAL-MTSC             COMP-3          PIC 9(11)V9(04).
      *
      *ING-02
      *    Ind Trasp Situac Contable
           03  VEN-IND-MTSC                             PIC X(01).
      *
      *MOD-01  PIC X(08)
      *MOD-02  PIC X(07)
      *    Indicador de calculo
           03  VEN-IND-CALC                             PIC X(01).
      *
      *    Situacion Contable Anterior
           03  VEN-IND-CTBA                             PIC X(03).
      *
      *MOD-03
      *    Glosa Disponible
           03  VEN-GLS-DISP                             PIC X(10).
           COPY SGCBRDBC.
           COPY SGCBRRCD.
           COPY SGCBRDCE.
           COPY SGCBRDCP.
           COPY TABBRCOM.

      * AREAS AUXILIARES A IMAGEN REGISTRO VEN
      * SI CAMBIA LARGO REGISTRO VEN SE DEBEN MODIFICAR

       01  WK-VEN-ACT                    PIC X(145) VALUE SPACES.
       01  WK-VEN-ANT                    PIC X(145) VALUE SPACES.

       01  WB-ELEM-LIS                      PIC X(11).
           EJECT
       PROCEDURE DIVISION.
      *===================
           ENTRY 'DBMSCBL'.
           EJECT
       A-CONTROL SECTION.
      *=================
       AA-INICIALIZACION.
           PERFORM B-INICIALIZAR.
           SKIP1
       AB-PROCESAMIENTO.
           IF WS-PROCESO-OK
              PERFORM C-PROCESAR
           END-IF.
           SKIP1
       AC-TERMINACION.
           PERFORM D-TERMINAR.
           SKIP1
       AZ-FIN-DE-PROCESO.
           GOBACK.
           EJECT
       B-INICIALIZAR SECTION.
      *======================
           PERFORM BB-ABRIR-ARCHIVOS.
           PERFORM BB-CARGA-TB-VIP
           PERFORM BC-CARGA-CALENDAR.
           IF (CALEAREA-COD-RET = 0 OR CALEAREA-FUNCION NOT = 'CANCEL')
               PERFORM BC-VALIDA-PARAME
           END-IF.
           GO BZ-FIN-DE-SECCION.
           SKIP1
       BB-ABRIR-ARCHIVOS.
      *------------------
           OPEN OUTPUT COLVAVI.
           OPEN INPUT ARCVIP.
           IF (WR-FS-COLVAVI NOT = 0)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'COLVAVI'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-COLVAVI           TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1

       BB-CARGA-TB-VIP.
      *----------------
           PERFORM BB-LEER-ARCVIP
           PERFORM BB-LEECARGA-VIP UNTIL FIN-ARCVIP.

       BB-LEER-ARCVIP.
      *---------------
           READ ARCVIP AT END MOVE 1 TO EOF-ARCVIP.

       BB-LEECARGA-VIP.
      *---------------
           ADD 1               TO DO-TB-VIP
           MOVE ARC-RUT-VIP    TO TB-RUT-VIP (DO-TB-VIP)
           MOVE ARC-VRF-VIP    TO TB-VRF-VIP (DO-TB-VIP)
           MOVE ARC-OPE-VIP    TO TB-OPE-VIP (DO-TB-VIP).
           PERFORM BB-LEER-ARCVIP.

       BC-CARGA-CALENDAR.
      *------------------
           MOVE 'CARGAR'                    TO CALEAREA-FUNCION.
           MOVE ALL '0'                     TO CALEAREA-FECHA-1.
           PERFORM BC-CALL-RUTUCALE.
           SKIP1
       BC-VALIDA-PARAME.
      *-----------------
           ACCEPT W-PARAMETROS
           IF WP-NUM-DIA-1 NOT NUMERIC OR
              WP-NUM-DIA-2 NOT NUMERIC OR
              WP-NUM-DIA-3 NOT NUMERIC OR
              WP-NUM-DIA-4 NOT NUMERIC
              MOVE 'B-INICIALIZAR'         TO WR-SECCION
              MOVE 'BC-VALIDA-PARAME'      TO WR-PARRAFO
              MOVE 'PARAM   '              TO WR-ARCHIVO
              MOVE SPACES                  TO WR-OPERACI
              MOVE '*NRO DIAS INVAL*'      TO WR-MENSAJE
              MOVE SPACES                  TO WR-FILE-ST
              PERFORM BD-DISPLAY-ERROR
           END-IF.

           MOVE WP-ANO-PRO                  TO CALEAREA-FECHA-1-A
           MOVE WP-MES-PRO                  TO CALEAREA-FECHA-1-M
           MOVE WP-DIA-PRO                  TO CALEAREA-FECHA-1-D
           MOVE 'INFO'                      TO CALEAREA-FUNCION.
           MOVE ALL '0'                     TO CALEAREA-FECHA-2.
           PERFORM BC-CALL-RUTUCALE.
           IF (WS-PROCESO-OK)
               MOVE WP-NUM-DIA-1               TO CALEAREA-NUM-DIA
               PERFORM BC-BUSCA-FECHA
               IF (CALEAREA-COD-RET = 0)
                   MOVE WR-FECHA-INI           TO WK-FECHA-1
                   MOVE WR-FECHA-FIN           TO WK-FECHA-11
                   MOVE WP-NUM-DIA-2           TO CALEAREA-NUM-DIA
                   PERFORM BC-BUSCA-FECHA
                   IF (CALEAREA-COD-RET = 0)
                       MOVE WR-FECHA-INI       TO WK-FECHA-2
                       MOVE WR-FECHA-FIN       TO WK-FECHA-22
                       MOVE WP-NUM-DIA-3       TO CALEAREA-NUM-DIA
                       PERFORM BC-BUSCA-FECHA
                       IF (CALEAREA-COD-RET = 0)
                          MOVE WR-FECHA-INI        TO WK-FECHA-3
                          MOVE WR-FECHA-FIN        TO WK-FECHA-33
                          MOVE WP-NUM-DIA-4    TO CALEAREA-NUM-DIA
                          PERFORM BC-BUSCA-FECHA
                          IF (CALEAREA-COD-RET = 0)
                             MOVE WR-FECHA-INI TO WK-FECHA-4
                             MOVE WR-FECHA-FIN TO WK-FECHA-44
                          END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF.

       BC-BUSCA-FECHA.
      *---------------
           MOVE WP-ANO-PRO             TO CALEAREA-FECHA-1-A
           MOVE WP-MES-PRO             TO CALEAREA-FECHA-1-M
           MOVE WP-DIA-PRO             TO CALEAREA-FECHA-1-D
           MOVE 'RENDH'                TO CALEAREA-FUNCION
           MOVE ALL '0'                TO CALEAREA-FECHA-2
           PERFORM BC-CALL-RUTUCALE
           IF (CALEAREA-COD-RET = 0)
              MOVE CALEAREA-FECHA-2-A  TO WR-ANO-FIN
              MOVE CALEAREA-FECHA-2-M  TO WR-MES-FIN
              MOVE CALEAREA-FECHA-2-D  TO WR-DIA-FIN
              PERFORM BC-BUSCA-HABIL-ANT
              IF (CALEAREA-COD-RET = 0)
                  PERFORM BC-SUMA-UN-DIA-CALE
                  IF (CALEAREA-COD-RET = 0)
                     MOVE CALEAREA-FECHA-2-A  TO WR-ANO-INI
                     MOVE CALEAREA-FECHA-2-M  TO WR-MES-INI
                     MOVE CALEAREA-FECHA-2-D  TO WR-DIA-INI
                     DISPLAY '****************************'
                     DISPLAY '* FECHA INICIO : ' WR-FECHA-INI  '*'
                     DISPLAY '* FECHA FIN    : ' WR-FECHA-FIN  '*'
                     DISPLAY '****************************'
                  END-IF
              END-IF
           END-IF.

       BC-BUSCA-HABIL-ANT.
      *------------------
           MOVE WR-ANO-FIN                  TO CALEAREA-FECHA-1-A
           MOVE WR-MES-FIN                  TO CALEAREA-FECHA-1-M
           MOVE WR-DIA-FIN                  TO CALEAREA-FECHA-1-D
           MOVE 'BDHA'                  TO CALEAREA-FUNCION
           MOVE ALL '0'                 TO CALEAREA-FECHA-2
           PERFORM BC-CALL-RUTUCALE.

       BC-SUMA-UN-DIA-CALE.
      *------------------
           MOVE 1                       TO CALEAREA-NUM-DIA
           MOVE CALEAREA-FECHA-2-A          TO CALEAREA-FECHA-1-A
           MOVE CALEAREA-FECHA-2-M          TO CALEAREA-FECHA-1-M
           MOVE CALEAREA-FECHA-2-D          TO CALEAREA-FECHA-1-D
           MOVE 'AVNDC'                 TO CALEAREA-FUNCION
           MOVE ALL '0'                 TO CALEAREA-FECHA-2
           PERFORM BC-CALL-RUTUCALE.

       BC-CALL-RUTUCALE.
      *-----------------
           CALL 'RUTUCALE' USING RTNWCALE.
           IF (CALEAREA-COD-RET NOT = 0 OR CALEAREA-FUNCION = 'CANCEL')
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BC-CALL-RUTUCALE'      TO WR-PARRAFO
               MOVE 'RUTUCALE'              TO WR-ARCHIVO
               MOVE CALEAREA-FECHA-1        TO WR-OPERACI
               MOVE '*FECHA INVALIDA*'      TO WR-MENSAJE
               MOVE CALEAREA-COD-RET        TO WR-FILE-ST
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       BD-DISPLAY-ERROR.
      *-----------------
           SET WS-PROCESO-ERROR             TO TRUE.
           DISPLAY ' '
           DISPLAY 'ERROR EN SECCION   : ' WR-SECCION
           DISPLAY '   PARRAFO         : ' WR-PARRAFO
           DISPLAY '   ARCHIVO         : ' WR-ARCHIVO
           DISPLAY '   OPERACION       : ' WR-OPERACI
           DISPLAY '   FILE STATUS     : ' WR-FILE-ST
           DISPLAY '   MENSAJE DE ERROR: ' WR-MENSAJE.
           SKIP1
       BZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       C-PROCESAR SECTION.
      *===================
       CA-PROCESO-GRAL.
      *----------------
      *---- PROCESO PRIMER DIA
           MOVE 'REDKG'                     TO WB-REQ-VEN-CMD
           ADD 1   TO WK-IND-PROC
           MOVE WK-FECHA-1                  TO WB-REQ-VEN-KEY-VALUE
           PERFORM CB-LEER-VEN.
           MOVE 'REDNX'                     TO WB-REQ-VEN-CMD
           PERFORM CC-PROCESA-VENCIMIENTOS
              UNTIL (VEN-FEC-FVEN > WK-FECHA-11  OR
                     WB-REQ-VEN-RC  NOT = '  ' OR WS-PROCESO-ERROR)

      *---- PROCESO SEGUNDO DIA
           MOVE 'REDKG'                     TO WB-REQ-VEN-CMD
           ADD 1   TO WK-IND-PROC
           MOVE WK-FECHA-2                  TO WB-REQ-VEN-KEY-VALUE
           PERFORM CB-LEER-VEN.
           MOVE 'REDNX'                     TO WB-REQ-VEN-CMD
           PERFORM CC-PROCESA-VENCIMIENTOS
              UNTIL (VEN-FEC-FVEN > WK-FECHA-22  OR
                     WB-REQ-VEN-RC  NOT = '  ' OR WS-PROCESO-ERROR)

      *---- PROCESO TERCER DIA
           MOVE 'REDKG'                     TO WB-REQ-VEN-CMD
           ADD 1   TO WK-IND-PROC
           MOVE WK-FECHA-3                  TO WB-REQ-VEN-KEY-VALUE
           PERFORM CB-LEER-VEN.
           MOVE 'REDNX'                     TO WB-REQ-VEN-CMD
           PERFORM CC-PROCESA-VENCIMIENTOS
              UNTIL (VEN-FEC-FVEN > WK-FECHA-33  OR
                     WB-REQ-VEN-RC  NOT = '  ' OR WS-PROCESO-ERROR)

      *---- PROCESO CUARTO DIA
           MOVE 'REDKG'                     TO WB-REQ-VEN-CMD
           ADD 1   TO WK-IND-PROC
           MOVE WK-FECHA-4                  TO WB-REQ-VEN-KEY-VALUE
           PERFORM CB-LEER-VEN.
           MOVE 'REDNX'                     TO WB-REQ-VEN-CMD
           PERFORM CC-PROCESA-VENCIMIENTOS
              UNTIL (VEN-FEC-FVEN > WK-FECHA-44  OR
                     WB-REQ-VEN-RC  NOT = '  ' OR WS-PROCESO-ERROR)
           GO CZ-FIN-DE-SECCION.
           SKIP1
       CB-LEER-VEN.
      *------------
           MOVE SPACES                      TO WB-REQ-VEN-RC
           MOVE 'VEN00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-VEN-AREA VEN WB-ELEM-LIS
           IF (WB-REQ-VEN-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CB-LEER-VEN'           TO WR-PARRAFO
               MOVE 'VEN'                   TO WR-ARCHIVO
               MOVE WB-REQ-VEN-CMD          TO WR-OPERACI
               MOVE WB-REQ-VEN-RC           TO WR-FILE-ST
               MOVE WB-REQ-VEN-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       CC-PROCESA-VENCIMIENTOS.
      *------------------------
           ADD 1                            TO WA-L-VEN
           IF (VEN-COD-TOPC = 'D' AND VEN-VAL-SFIN > 0)
               IF (VEN-CIC-IOPC NOT = WB-REQ-OPC-KEY-VALUE)
                   MOVE VEN-CIC-IOPC        TO WB-REQ-OPC-KEY-VALUE
                   PERFORM CF-LEER-OPC
                   PERFORM CF-LEER-DLC
               END-IF
               IF (WB-REQ-OPC-RC = SPACES AND OPC-MSC-STAT = 'A' AND
                  (DLC-IND-SCTB = '   ' OR DLC-IND-SCTB = 'MUL') AND
                   OPC-COD-COOC NOT = WP-CLASE-1 AND
                   OPC-COD-COOC NOT = WP-CLASE-2 AND
                   OPC-COD-COOC NOT = WP-CLASE-3 AND
                   OPC-COD-COOC NOT = WP-CLASE-4 AND
                   OPC-COD-COOC NOT = WP-CLASE-5)
                   PERFORM CD-GENERAR-MOROSO
               END-IF
           END-IF.

           IF (WS-PROCESO-OK)
               PERFORM CB-LEER-VEN
           END-IF.
           SKIP1
       CD-GENERAR-MOROSO.
      *------------------
      * VERIFICAR SI EXISTE CUOTA ANTERIOR MOROSA
      *           SI EXISTE NO SE PROCESA CUOTA ACTUAL
           IF VEN-NUM-IVEN > 1
              MOVE VEN-CIC-IOPC            TO WB-REQ-VEN-KEY-1
              COMPUTE WB-REQ-VEN-KEY-2 = VEN-NUM-IVEN - 1
              MOVE SPACES                      TO WB-REQ-VEN-RC-R
              MOVE 'VEN00'                     TO WB-ELEM-LIS
              CALL 'DBNTRY' USING WB-UIB WB-REQ-VEN-AREA-R
                                  WK-VEN-ANT WB-ELEM-LIS
              IF (WB-REQ-VEN-RC-R NOT = '  ' AND NOT = '14')
                  MOVE 'C-PROCESAR'            TO WR-SECCION
                  MOVE 'CD-GENERAR-MOROSO'     TO WR-PARRAFO
                  MOVE 'VEN'                   TO WR-ARCHIVO
                  MOVE WB-REQ-VEN-CMD-R        TO WR-OPERACI
                  MOVE WB-REQ-VEN-RC-R         TO WR-FILE-ST
                  MOVE WB-REQ-VEN-KEY-VALUE-R  TO WR-MENSAJE
                  PERFORM BD-DISPLAY-ERROR
              END-IF
           ELSE
              MOVE '14'        TO WB-REQ-VEN-RC-R
           END-IF

           IF (WB-REQ-VEN-RC-R = '14')
               PERFORM CD-GENERAR-MOROSO-OK
           ELSE
               MOVE VEN          TO WK-VEN-ACT
               MOVE WK-VEN-ANT   TO VEN
               IF VEN-VAL-SFIN > 0
                  DISPLAY '** CUOTA ANTERIOR MOROSA: ' VEN-KEY-IVEN
                          ' ** NO SE GENERA CARTA **'
                  MOVE WK-VEN-ACT    TO VEN
               ELSE
                  MOVE WK-VEN-ACT    TO VEN
                  PERFORM CD-GENERAR-MOROSO-OK
               END-IF
           END-IF.

       CD-GENERAR-MOROSO-OK.
      *--------------------
           MOVE VEN-CIC-IOPC            TO WB-REQ-RDC-KEY-OPC
           MOVE ZEROES                  TO WB-REQ-RDC-KEY-REL
           PERFORM CH-LEER-RDC
           IF (WB-REQ-RDC-RC NOT = SPACES)
               MOVE SPACES              TO DBC-GLS-NOMC
               MOVE ZEROES              TO DBC-IDC-ICLI
               MOVE SPACES              TO RCD-GLS-DIRE
           ELSE
               MOVE RDC-CIC-ICLI    TO WB-REQ-DBC-KEY-VALUE
               PERFORM CI-LEER-DBC
               IF (WB-REQ-DBC-RC = SPACES)
                   MOVE DBC-GLS-NOMC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN     TO DBC-GLS-NOMC
                   MOVE DBC-CIC-ICLI TO WB-REQ-RCD-KEY-CLI
      **********   MOVE DBC-NUM-DCOR TO WB-REQ-RCD-KEY-DIR
                   MOVE '01'         TO WB-REQ-RCD-KEY-DIR
                   PERFORM CI-LEER-RCD
                   IF (WB-REQ-RCD-RC NOT = SPACES)
                       MOVE SPACES   TO RCD-GLS-DIRE
                   END-IF
               ELSE
                   MOVE SPACES             TO DBC-GLS-NOMC
                   MOVE ZEROES       TO DBC-IDC-ICLI
                   MOVE SPACES       TO RCD-GLS-DIRE
               END-IF
           END-IF

           MOVE OPC-CIC-IOPC                TO AVI-CIC-IOPC
           MOVE OPC-COD-VCOC                TO AVI-COD-VCOC
           MOVE VEN-FEC-FVEN                TO AVI-FEC-FVEN
           MOVE VEN-NUM-IVCT                TO AVI-NUM-IVCT
           MOVE WP-FECHA-PRO                TO AVI-FEC-FSEL
           MOVE VEN-VAL-SFIN                TO AVI-VAL-SFIN
           MOVE DBC-GLS-NOMC                TO AVI-NOM-DDIR
           MOVE RCD-GLS-DIRE                TO AVI-DIR-DDIR
      *** USAR RCD-COD-LUGA
           IF RCD-GLS-DIRE NOT = SPACES
              PERFORM CC-BUSCAR-COMUNA
              MOVE COM-GLS-COMU    TO AVI-COM-DDIR
           END-IF
           PERFORM CC-BUSCAR-TIPO-BANCA

           MOVE DBC-NUM-ICLI    TO WR-RUT-DD
      *** DATOS DEUDOR INDIRECTO
           PERFORM CC-BUSCAR-DIND
           MOVE DBC-GLS-NOMC                TO AVI-NOM-DIND
           MOVE RCD-GLS-DIRE                TO AVI-DIR-DIND
           IF RCD-GLS-DIRE NOT = SPACES
              PERFORM CC-BUSCAR-COMUNA
              MOVE COM-GLS-COMU    TO AVI-COM-DIND
           END-IF
      **** DETERMINAR SI CORRESPONDE EMITIR CARTA
      **** IF (WK-COD-TBAN = 'N  ' AND (WK-IND-PROC = 1 OR 2))
      ***  PRP. 14-03-98
      **** IF (WK-TIPO = 'N' AND (WK-IND-PROC = 1 OR 2)) OR
           IF (WK-TIPO = 'E' AND (WK-IND-PROC = 1)) OR
              (WK-TIPO = 'P'  AND (WK-IND-PROC = 3 OR 4))
      ***PRP/INI.06.09.96
              SET IB-TB-VIP TO 1
              SEARCH TB-VIP
              AT END
                   PERFORM CL-WRITE-MOR
              WHEN (TB-RUT-VIP (IB-TB-VIP) = WR-RUT-DD    AND
                    TB-OPE-VIP (IB-TB-VIP) = SPACES)      OR
                   (TB-RUT-VIP (IB-TB-VIP) = WR-RUT-DD    AND
                    TB-OPE-VIP (IB-TB-VIP) = OPC-CIC-IOPC)
                   NEXT SENTENCE
      ******  PERFORM CL-WRITE-MOR
      ***PRP/FIN.06.09.96
           END-IF.

       CC-BUSCAR-COMUNA.
      *-----------------
           MOVE RCD-COD-LUGA                    TO WB-REQ-TAB-KEY-COD
           MOVE SPACES                          TO WB-REQ-TAB-RC
           MOVE 'TAB00'                         TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-TAB-AREA COM WB-ELEM-LIS
           IF (WB-REQ-TAB-RC = '  ')
               NEXT SENTENCE
           ELSE
              DISPLAY '** ERROR ACCESO TABLA TAB-COM'
              DISPLAY ' ESTADO : ' WB-REQ-TAB-RC
              DISPLAY ' CLAVE  : ' WB-REQ-TAB-KEY-VALUE
              DISPLAY '** PROCESO CONTINUA **'
              MOVE SPACES                   TO COM-GLS-COMU
           END-IF.

       CC-BUSCAR-DIND.
      *---------------
           MOVE VEN-CIC-IOPC            TO WB-REQ-RDC-KEY-OPC
           MOVE 001                     TO WB-REQ-RDC-KEY-REL
           PERFORM CH-LEER-RDC
           IF (WB-REQ-RDC-RC = '14')
               MOVE SPACES              TO DBC-GLS-NOMC
               MOVE SPACES              TO RCD-GLS-DIRE
           ELSE
               IF (WB-REQ-RDC-RC = '  ')
                  MOVE RDC-CIC-ICLI    TO WB-REQ-DBC-KEY-VALUE
                  PERFORM CI-LEER-DBC
                  IF (WB-REQ-DBC-RC = SPACES)
                     MOVE DBC-GLS-NOMC TO CPT-STRN
                     PERFORM CPT-BLKS
                     MOVE CPT-STRN     TO DBC-GLS-NOMC
                     MOVE DBC-CIC-ICLI TO WB-REQ-RCD-KEY-CLI
      *********      MOVE DBC-NUM-DCOR TO WB-REQ-RCD-KEY-DIR
                     MOVE '01'         TO WB-REQ-RCD-KEY-DIR
                     PERFORM CI-LEER-RCD
                     IF (WB-REQ-RCD-RC NOT = SPACES)
                         MOVE SPACES   TO RCD-GLS-DIRE
                     END-IF
                  ELSE
                      MOVE SPACES             TO DBC-GLS-NOMC
                      MOVE ZEROES       TO DBC-IDC-ICLI
                      MOVE SPACES       TO RCD-GLS-DIRE
                  END-IF
               END-IF
           END-IF.

       CF-LEER-OPC.
      *------------
           MOVE SPACES                      TO WB-REQ-OPC-RC
           MOVE 'OPC00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-OPC-AREA OPC WB-ELEM-LIS
           IF (WB-REQ-OPC-RC = '  ')
               ADD 1                        TO WA-L-OPC
           ELSE
           IF (WB-REQ-OPC-RC NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CF-LEER-OPC'           TO WR-PARRAFO
               MOVE 'OPC'                   TO WR-ARCHIVO
               MOVE WB-REQ-OPC-CMD          TO WR-OPERACI
               MOVE WB-REQ-OPC-RC           TO WR-FILE-ST
               MOVE WB-REQ-OPC-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1

       CF-LEER-DLC.
      *------------
           MOVE VEN-CIC-IOPC        TO WB-REQ-DLC-KEY-VALUE-1
           MOVE 001                 TO WB-REQ-DLC-KEY-VALUE-2
           MOVE SPACES                      TO WB-REQ-DLC-RC
           MOVE 'DLC00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DLC-AREA DLC WB-ELEM-LIS
           IF (WB-REQ-DLC-RC = '  ')
               NEXT SENTENCE
           ELSE
           IF (WB-REQ-DLC-RC NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CF-LEER-DLC'           TO WR-PARRAFO
               MOVE 'DLC'                   TO WR-ARCHIVO
               MOVE WB-REQ-DLC-CMD          TO WR-OPERACI
               MOVE WB-REQ-DLC-RC           TO WR-FILE-ST
               MOVE WB-REQ-DLC-KEY-VALUE-1  TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CH-LEER-RDC.
      *------------
           MOVE SPACES                      TO WB-REQ-RDC-RC
           MOVE 'RDC00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-RDC-AREA RDC WB-ELEM-LIS
           IF (WB-REQ-RDC-RC = '  ')
               ADD 1                        TO WA-L-RDC
           ELSE
           IF (WB-REQ-RDC-RC NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CH-LEER-RDC'           TO WR-PARRAFO
               MOVE 'RDC'                   TO WR-ARCHIVO
               MOVE WB-REQ-RDC-CMD          TO WR-OPERACI
               MOVE WB-REQ-RDC-RC           TO WR-FILE-ST
               MOVE WB-REQ-RDC-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF
           END-IF.
           SKIP1
       CI-LEER-DBC.
      *------------
           MOVE SPACES                      TO WB-REQ-DBC-RC
           MOVE 'DBC00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DBC-AREA DBC WB-ELEM-LIS
           IF (WB-REQ-DBC-RC = '  ')
               ADD 1                        TO WA-L-DBC
           ELSE
           IF (WB-REQ-DBC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CI-LEER-DBC'           TO WR-PARRAFO
               MOVE 'DBC'                   TO WR-ARCHIVO
               MOVE WB-REQ-DBC-CMD          TO WR-OPERACI
               MOVE WB-REQ-DBC-RC           TO WR-FILE-ST
               MOVE WB-REQ-DBC-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF
           END-IF.
           SKIP1
       CC-LEER-DCE.
      *------------
           MOVE SPACES                      TO WB-REQ-DCE-RC
           MOVE 'DCE00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DCE-AREA DCE WB-ELEM-LIS
           IF (WB-REQ-DCE-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CC-LEER-DCE'           TO WR-PARRAFO
               MOVE 'DCE'                   TO WR-ARCHIVO
               MOVE WB-REQ-DCE-CMD          TO WR-OPERACI
               MOVE WB-REQ-DCE-RC           TO WR-FILE-ST
               MOVE WB-REQ-DCE-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       CC-LEER-DCP.
      *------------
           MOVE SPACES                      TO WB-REQ-DCP-RC
           MOVE 'DCP00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DCP-AREA DCP WB-ELEM-LIS
           IF (WB-REQ-DCP-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CC-LEER-DCP'           TO WR-PARRAFO
               MOVE 'DCP'                   TO WR-ARCHIVO
               MOVE WB-REQ-DCP-CMD          TO WR-OPERACI
               MOVE WB-REQ-DCP-RC           TO WR-FILE-ST
               MOVE WB-REQ-DCP-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CC-BUSCAR-TIPO-BANCA.
      *---------------------
           IF (DBC-IND-TICL = 'P')
               MOVE RDC-CIC-ICLI     TO WB-REQ-DCP-KEY-CIC
               PERFORM CC-LEER-DCP
               IF (WB-REQ-DCP-RC = '  ')
                  MOVE DCP-COD-TBAN   TO WK-COD-TBAN
               ELSE
                  DISPLAY 'NO EXISTE CLIENTE ' RDC-CIC-ICLI
                     ' EN DCP PARA OPERACION ' RDC-CIC-IOPC
                     ' ESTADO: ' WB-REQ-DCP-RC
                  MOVE SPACES         TO WK-COD-TBAN
               END-IF
           ELSE
               MOVE RDC-CIC-ICLI     TO WB-REQ-DCE-KEY-CIC
               PERFORM CC-LEER-DCE
               IF (WB-REQ-DCE-RC = '  ')
                  MOVE DCE-COD-TBAN   TO WK-COD-TBAN
               ELSE
                  DISPLAY 'NO EXISTE CLIENTE ' RDC-CIC-ICLI
                     ' EN DCE PARA OPERACION ' RDC-CIC-IOPC
                     ' ESTADO: ' WB-REQ-DCE-RC
                  MOVE SPACES         TO WK-COD-TBAN
               END-IF.

       CI-LEER-RCD.
      *------------
           MOVE SPACES                      TO WB-REQ-RCD-RC
           MOVE 'RCD00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-RCD-AREA RCD WB-ELEM-LIS
           IF (WB-REQ-RCD-RC = '  ')
               ADD 1                        TO WA-L-RCD
               IF RCD-MSC-TDIR NOT = 'D'
                  DISPLAY '** TIPO DIRECCION NO ES D **'
                          '** RUT : ' DBC-NUM-ICLI '-' DBC-VRF-ICLI
               END-IF
           ELSE
           IF (WB-REQ-RCD-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CI-LEER-RCD'           TO WR-PARRAFO
               MOVE 'RCD'                   TO WR-ARCHIVO
               MOVE WB-REQ-RCD-CMD          TO WR-OPERACI
               MOVE WB-REQ-RCD-RC           TO WR-FILE-ST
               MOVE WB-REQ-RCD-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF
           END-IF.
           SKIP1
       CL-WRITE-MOR.
      *-------------
      ***  PRP. 14-03-98
      ***  IF WK-IND-PROC = 1 OR 3
           IF WK-IND-PROC = 1 OR 3 OR 4
              MOVE 1      TO AVI-IND-TCAR
           ELSE
              MOVE 2      TO AVI-IND-TCAR
           END-IF.
           IF AVI-NOM-DDIR NOT = SPACES AND
              AVI-DIR-DDIR NOT = SPACES
              WRITE R-COLVAVI END-WRITE
              IF (WR-FS-COLVAVI  = 0)
                  ADD 1                        TO WA-G-MOR
              ELSE
                  MOVE 'C-PROCESAR'            TO WR-SECCION
                  MOVE 'CL-WRITE-MOR'          TO WR-PARRAFO
                  MOVE 'COLVAVI'               TO WR-ARCHIVO
                  MOVE 'WRITE'                 TO WR-OPERACI
                  MOVE WR-FS-COLVAVI           TO WR-FILE-ST
                  MOVE VEN-CIC-IOPC            TO WR-MENSAJE
                  PERFORM BD-DISPLAY-ERROR
              END-IF
           ELSE
              DISPLAY '** NOMBRE O DIREC. DEUDOR BLANCO, OPERAC: '
                      AVI-CIC-IOPC ' ** NO SE GRABA **'
           END-IF.

       CZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       D-TERMINAR SECTION.
      *===================
       DA-ESTADISTICAS.
      *----------------
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'INFORMES'
           DISPLAY '--------'
           DISPLAY ' '
           DISPLAY 'COLPB876 NO EMITE INFORME'
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           ACCEPT WR-FECHA-HOY FROM DATE.
           DISPLAY 'ESTADISTICAS DE PROCESO PROGRAMA COLPB876 FECHA '
                    WR-FECHA-HOY
           DISPLAY '------------------------------------------------'
           DISPLAY '        GENERA ARCHIVO COLVAVI CON VEN"S'
           DISPLAY ' '
           DISPLAY 'LEIDOS TABLA VIP : ' DO-TB-VIP
           DISPLAY 'LEIDOS VEN       : ' WA-L-VEN
           DISPLAY 'LEIDOS OPC       : ' WA-L-OPC
           DISPLAY 'LEIDOS RDC       : ' WA-L-RDC
           DISPLAY 'LEIDOS DBC       : ' WA-L-DBC
           DISPLAY 'LEIDOS RCD       : ' WA-L-RCD
           DISPLAY ' '
           DISPLAY 'GRABADOS COLVAVI : ' WA-G-MOR
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'TARJETAS DE PARAMETROS'
           DISPLAY '----------------------'
           DISPLAY ' '
           DISPLAY W-PARAMETROS.
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'MENSAJES PARA EL EXPLOTADOR'
           DISPLAY '---------------------------'
           DISPLAY ' '
           IF WS-PROCESO-OK
               DISPLAY 'NO HAY MENSAJES PARA EL EXPLOTADOR'
           ELSE
               DISPLAY 'HAY MENSAJES PARA EL EXPLOTADOR'.
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '.
           SKIP1
       DC-TERMINO.
      *-----------
           CLOSE COLVAVI ARCVIP.
           IF WS-PROCESO-ERROR
              MOVE 100                      TO RETURN-CODE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
              DISPLAY '********                              ********'
              DISPLAY '******** TERMINO ERRONEO DEL PROCESO  ********'
              DISPLAY '********                              ********'
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
           ELSE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*****PROCESO TERMINO EN FORMA NORMAL*****'.
           SKIP1
       DZ-FIN-DE-SECCION.
      *------------------
           EXIT.
      *---------------------------------------------------------------*
      * USO DE RUTINA GENESIS PARA COMPACTAR NOMBRES                  *
      *---------------------------------------------------------------*
           COPY GNSBGCPT.
