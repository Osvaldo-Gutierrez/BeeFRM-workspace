       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLLMC.
       AUTHOR.          BEE.
       DATE-WRITTEN.    10-Jun-98 02:50 PM.

      * Programa Listador de Reporte LMC con Sort.
      *
      * V 1.1.2
      *
      *<<<< CMT_ID
      *>>>>
      *JGM
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            C01 IS SALTO
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTLMC         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTLMC         ASSIGN TO        UT-S-RPTLMC.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT RPTLMC         ASSIGN TO        UT-S-RPTLMC.
      *<<<< IOS
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY COLRRLMC.
      *<<<< RR
      *>>>>
       FD  RPTLMC LABEL RECORDS OMITTED
           RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-LMC     PIC X(132).
      *<<<< FD_RPT
      *>>>>
      *<<<< FLS
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LMC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBRLMC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWLMC.
      *<<<< RW
      *>>>>
       COPY COLRNLMC.
      *<<<< RN
      *>>>>
       COPY COLROLMC.
      *<<<< RO
      *>>>>
       COPY GNSWGSYS.
       01  PGM-HRSR-LMC   VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-LMC  VALUE 'S'.

       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY TABBROFI.
       COPY SGCBRDBC.
       COPY COLBRDPC.

       COPY GNSBRCIC.
       COPY GNSWGCIC.
       COPY GNSWGHOY.
       COPY GNSWGFEC.
       COPY GNSWGCPT.
       COPY GNSWCVRF.
       COPY GNSWVVRF.

       01  WSS-VARI.
           03 WSS-VARI-PRM.
              05 PRM-FEC-FINI.
                 07 PRM-NUM-DINI                     PIC 9(02).
                 07 PRM-NUM-MINI                     PIC 9(02).
                 07 PRM-NUM-SINI                     PIC 9(02).
                 07 PRM-NUM-AINI                     PIC 9(02).
              05 PRM-FEC-FTER.
                 07 PRM-NUM-DTER                     PIC 9(02).
                 07 PRM-NUM-MTER                     PIC 9(02).
                 07 PRM-NUM-STER                     PIC 9(02).
                 07 PRM-NUM-ATER                     PIC 9(02).
              05 PRM-FEC-FAUX.
                 07 PRM-NUM-SAUX                     PIC 9(02).
                 07 PRM-NUM-AAUX                     PIC 9(02).
                 07 PRM-NUM-MAUX                     PIC 9(02).
                 07 PRM-NUM-DAUX                     PIC 9(02).

              05 PRM-COD-OFIC                        PIC X(03).

              05 PRM-TIP-EMIS                        PIC X(01).
                 88 OK-TIP-EMIS       VALUE 'B' 'L' 'R'.
                 88 EMIS-BORRADOR     VALUE 'B'.
                 88 EMIS-LEGAL        VALUE 'L'.
                 88 EMIS-RESUMEN      VALUE 'R'.

           03 WSS-FEC-FINI.
              05 WSS-NUM-SINI                     PIC 9(02).
              05 WSS-NUM-AINI                     PIC 9(02).
              05 WSS-NUM-MINI                     PIC 9(02).
              05 WSS-NUM-DINI                     PIC 9(02).


           03 WSS-FEC-FTER.
              05 WSS-NUM-STER                     PIC 9(02).
              05 WSS-NUM-ATER                     PIC 9(02).
              05 WSS-NUM-MTER                     PIC 9(02).
              05 WSS-NUM-DTER                     PIC 9(02).

           03 WSS-FEC-FEJE.
              05 WSS-NUM-SEJE                     PIC 9(02).
              05 WSS-NUM-AEJE                     PIC 9(02).
              05 WSS-NUM-MEJE                     PIC 9(02).
              05 WSS-NUM-DEJE                     PIC 9(02).

           03 WSS-FEC-FESP.
              05 WSS-NUM-SESP                     PIC 9(02).
              05 WSS-NUM-AESP                     PIC 9(02).
              05 WSS-NUM-MESP                     PIC 9(02).
              05 WSS-NUM-DESP                     PIC 9(02).
           03 WSS-FEC-FCO1.
              05 WSS-NUM-SCO1                     PIC 9(02).
              05 WSS-NUM-ACO1                     PIC 9(02).
              05 WSS-NUM-MCO1                     PIC 9(02).
              05 WSS-NUM-DCO1                     PIC 9(02).

           03 WSS-FEC-FCO2.
              05 WSS-NUM-SCO2                     PIC 9(02).
              05 WSS-NUM-ACO2                     PIC 9(02).
              05 WSS-NUM-MCO2                     PIC 9(02).
              05 WSS-NUM-DCO2                     PIC 9(02).



           03 WSS-FEC-FTO2.
              05 WSS-NUM-STO2                     PIC 9(02).
              05 WSS-NUM-ATO2                     PIC 9(02).
              05 WSS-NUM-MTO2                     PIC 9(02).
              05 WSS-NUM-DTO2                     PIC 9(02).



           03 WSS-FEC-FREG.
              05 WSS-NUM-SREG                     PIC 9(02).
              05 WSS-NUM-AREG                     PIC 9(02).
              05 WSS-NUM-MREG                     PIC 9(02).
              05 WSS-NUM-DREG                     PIC 9(02).

           03 WSS-FEC-FPRX.
              05 WSS-NUM-SPRX                     PIC 9(02).
              05 WSS-NUM-APRX                     PIC 9(02).
              05 WSS-NUM-MPRX                     PIC 9(02).
              05 WSS-NUM-DPRX                     PIC 9(02).
           03 WSS-FEC-FAUX.
              05 WSS-NUM-DAUX                     PIC 9(02).
              05 WSS-NUM-MAUX                     PIC 9(02).
              05 WSS-NUM-SAUX                     PIC 9(02).
              05 WSS-NUM-AAUX                     PIC 9(02).

           03 WSS-HAY-REG          VALUE 'NO'     PIC X(02).
              88 HAY-REG           VALUE 'SI'.

           03 WSS-IND-DIAHABIL                    PIC X(01).
                 88 FECE-NOHABIL      VALUE 'N'.
                 88 FECE-SIHABIL      VALUE 'S'.
           03 WSS-IND-FECH    VALUE 'N'           PIC X(01).
           03 WSS-IND-RESE    VALUE 'N'           PIC X(01).
           03 WSS-NUM-TDIA                        PIC 9(03).
           03 WSS-COD-OFOC                        PIC X(03).
           03 WSS-CIC-CCSB                        PIC X(12).
           03 WSS-FEC-FCTB                        PIC X(08).
      * RRM-INI  7-MAY-1998
           03 WSS-FEC-FPRO                        PIC X(08).
      * RRM-FIN  7-MAY-1998
      * REL-INI
           03 WSS-VAL-TDE2     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-VAL-THA2     VALUE ZEROES  PIC 9(13)V9999.
      * REL-FIN

           03 WSS-VAL-TDEB     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-VAL-THAB     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-SLD-DBAN     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-SLD-HBAN     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-MVO-DEBE     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-MVO-HABE     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-DEB-ANTI     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-HAB-ANTI     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-DEB-MVTO     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-HAB-MVTO     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-DEB-NUEV     VALUE ZEROES  PIC 9(13)V9999.
           03 WSS-HAB-NUEV     VALUE ZEROES  PIC 9(13)V9999.

           03 WSS-FOL-FINA     VALUE ZEROES       PIC 9(06).
           03 WSS-FOL-TERM     VALUE ZEROES       PIC 9(06).
           03 WSS-TAB-DAT3.
              05 POS-58                  PIC X(01).
              05 POS-59                  PIC X(01).
              05 POS-60                  PIC X(01).
           03 WSS-RESET-SALDOS                    PIC X(01).
              88 RESET-SALDOS            VALUE 'S'.
           03 WSS-FST-LMC      VALUE 'S'          PIC X(01).
           03 WSS-IND-SEMA     VALUE 'N'          PIC X(01).
      *RRM-INI 9-JUN-1998. Modif para identificar "cuentas puentes" en
      *        la posicion 60.
           03 WSS-TAB-DANX.
              05 WSS-GLS-DANX    VALUE SPACES      PIC X(59).
              05 WSS-IND-PO60    VALUE SPACES      PIC X(01).
      *RRM-FIN 9-JUN-1998.
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DPC-REQA==.
      *>>>>

      * AQUI EXISTIA LABEL RF INI
      *<<<< RF
      *>>>>
      * AQUI EXISTIA LABEL RF FIN
       COPY COLRTLMC.
      *<<<< RT
      *>>>>

       PROCEDURE DIVISION.
      *==================

      * AQUI EXISTIA LABEL FIN_DEC INI
      *<<<< FIN_DEC
      *>>>>
      * AQUI EXISTIA LABEL FIN_DEC FIN

       MAIN SECTION.
      *------------
       INI-MAIN.
      *<<<< MAX_FILE
      *>>>>
      *    MOVE SYS-MXFL TO SYS-CMND.
      *    PERFORM GNS-PRO-SYS.
       COPY GNSBGEDB.
      *     MOVE 'COL' TO RPT-SIST.
           MOVE 'COLPLLMC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
      *>>>>
           SORT GNSSRT
       COPY COLRSLMC.
      *<<<< RS
      *>>>>
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
      *<<<< FIN
      *>>>>
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP

      *
           DISPLAY '****************************'.
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
           DISPLAY '****************************'.

      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMSSAA ) : '.
           ACCEPT  PRM-FEC-FINI IN WSS-VARI.
           DISPLAY PRM-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMSSAA ) : '
           ACCEPT  PRM-FEC-FTER IN WSS-VARI.
           DISPLAY PRM-FEC-FTER IN WSS-VARI.
      *
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA : '.
           ACCEPT   PRM-COD-OFIC IN WSS-VARI.
           DISPLAY  PRM-COD-OFIC IN WSS-VARI.

      *Captura Tipo de Emision
           DISPLAY 'TIPO EMISION : '.
           ACCEPT  PRM-TIP-EMIS IN WSS-VARI.
           DISPLAY PRM-TIP-EMIS IN WSS-VARI.
           DISPLAY '*******************************'.

      *VAL-OFI Valida codigo de Oficina en TABLAS
           DISPLAY  PRM-COD-OFIC.
           IF  PRM-COD-OFIC IN WSS-VARI NOT > SPACES
               MOVE '*' TO  PRM-COD-OFIC IN WSS-VARI.

           IF  PRM-COD-OFIC IN WSS-VARI NOT = '*'
               DISPLAY  PRM-COD-OFIC IN WSS-VARI
               MOVE  PRM-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.

      *VAL-EMIS Valida tipo de emision
           DISPLAY PRM-TIP-EMIS.
           IF NOT OK-TIP-EMIS
              DISPLAY 'ERROR PARAMETRO TIPO EMISION NO VALIDO'
              DISPLAY 'LOS PARAMETROS VALIDOS SON:'
              DISPLAY 'B - BORRADOR     (NO ACTUALIZA SALDOS Y FOLIOS)'
              DISPLAY 'L - LEGAL        (ACTUALIZA SALDOS Y FOLIOS)'
              DISPLAY 'R - SOLO RESUMEN (NO ACTUALIZA SALDOS Y FOLIOS)'
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO FIN-INP-SRT.

           PERFORM VALIDA-FECHAS.
           IF PGM-STAT-SRT-MAL
               GO TO FIN-INP-SRT.
      *
           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
      *
           IF  EMIS-LEGAL  AND WSS-IND-RESE IN WSS-VARI = 'S'
               PERFORM RESETEO-FOLIOS.
      *
           DISPLAY '**********************************'.
           DISPLAY 'CAPTURA DATOS DEL PROCESO ANTERIOR'.
           DISPLAY '**********************************'.
           PERFORM DATOS-PROCE-CONTAB.
           IF PGM-STAT-SRT-MAL
               GO TO FIN-INP-SRT.

      *RRM-INI 14/04/1998.MODIFICACION PARA ELIMINAR SALDOS DE ARRASTRE
      *    MOVE ZEROES TO WSS-DEB-ANTE IN WSS-LMC.
      *    MOVE ZEROES TO WSS-HAB-ANTE IN WSS-LMC.
      *RRM-FIN 14/04/1998.
      *>>>>
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-LMC.
       FST-INP-SRT.
      *<<<< INI_FST_INP
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-LMC.
      *<<<< FIN_FST_INP
      *>>>>
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           IF EMIS-LEGAL AND ( LMC-IND-LIQU IN LMC = 'L ' OR
                               LMC-IND-LIQU IN LMC = 'P ')
              GO TO NXT-INP-SRT.
      * Procesa segun Oficina ( * = Todas )
           IF  PRM-COD-OFIC IN WSS-VARI = '*'
              NEXT SENTENCE
           ELSE
              IF LMC-COD-OFOC IN LMC NOT =  PRM-COD-OFIC IN WSS-VARI
                 GO TO NXT-INP-SRT
              ELSE
                 NEXT SENTENCE.
      * Selecciona Registros dentro del rango de Fechas Ingresadas
      * RRM-INI 7-MAY-1998 Debe ser por fecha de proceso.
      *    IF WSS-FEC-FREG IN WSS-VARI > LMC-FEC-FCTB IN LMC OR
      *       WSS-FEC-FTER IN WSS-VARI < LMC-FEC-FCTB IN LMC.
           IF WSS-FEC-FREG IN WSS-VARI > LMC-FEC-FPRO IN LMC OR
              WSS-FEC-FTER IN WSS-VARI < LMC-FEC-FPRO IN LMC
               GO TO NXT-INP-SRT.

      * RRM-INI 9-JUN-1998. Identificacion de "cuentas puentes".
      * Buscando en Tabla PCC: Datos Anexos.
           IF LMC-CIC-CCSB IN LMC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE LMC-CIC-CCSB IN LMC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF NOT FIO-STAT-OKS
                  GO TO NXT-INP-SRT
               ELSE
                  MOVE TAB-GLS-DATA IN TAB TO WSS-TAB-DANX IN WSS-VARI
            ELSE
               GO TO NXT-INP-SRT.
      * Se verifica si es "cuenta puente".
           IF WSS-IND-PO60 = 'P'
               GO TO NXT-INP-SRT
           ELSE
               NEXT SENTENCE.
      * RRM-FIN 9-JUN-1998.

      * Llena campo Tipo de Movimiento del sort
           IF LMC-COD-MVTO IN LMC = 'CUR'
              MOVE '1'  TO SRT-COD-MVTO IN SRT
           ELSE
              MOVE '2'  TO SRT-COD-MVTO IN SRT.
      * Llena campo DEBE o HABER del sort segun corresponda
           MOVE LMC-IND-DBHB IN LMC TO SRT-IND-DBHB IN SRT.
           IF LMC-IND-DBHB IN LMC = 'D'
              MOVE LMC-SGV-ICTB IN LMC TO SRT-VAL-DEBE IN SRT
              MOVE ZEROES              TO SRT-VAL-HABE IN SRT
           ELSE
              IF LMC-IND-DBHB IN LMC = 'H'
                 MOVE LMC-SGV-ICTB IN LMC TO SRT-VAL-HABE IN SRT
                 MOVE ZEROES              TO SRT-VAL-DEBE IN SRT.
      * Asigna moneda nacional si moneda del credito es reajustable
           IF LMC-MSC-TVOC IN LMC = '0'
              MOVE '0999  ' TO LMC-COD-VCOC IN SRT.
      *>>>>
       MOV-INP-SRT.
       COPY COLRMLMC.
      *<<<< RM
      *>>>>
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-LMC.
      *<<<< FIN_NXT_INP
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *<<<< FIN_INP
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-LMC.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
      *<<<< INI_OUT
           MOVE 'NO' TO WSS-HAY-REG IN WSS-VARI.
           IF EMIS-LEGAL
              MOVE FIO-UPD TO FIO-CMND
           ELSE
              MOVE FIO-INP TO FIO-CMND.

           PERFORM COL-FIO-DPC.
      *>>>>
           OPEN OUTPUT RPTLMC.
      *     MOVE 'COLPLLMC' TO RPT-NPGM.
           PERFORM CAL-HDR.
           PERFORM INITIATE-RPTLMC.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           MOVE SRT TO SRT-OLD-LMC.
           MOVE SRT TO SRT-CUR-LMC.
      *<<<< FST_OUT
           MOVE 'SI' TO WSS-HAY-REG IN WSS-VARI.

      * Mediante BUS-OFI Obtiene Nombre Oficina de Tabla OFI
           IF LMC-COD-OFOC IN SRT > SPACES
               MOVE LMC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI.

           MOVE LMC-CIC-CCSB IN SRT TO WSS-CIC-CCSB IN WSS-VARI.
           MOVE LMC-COD-OFOC IN SRT TO WSS-COD-OFOC IN WSS-VARI.
      * RRM-INI  7-MAY-1998
      *    MOVE LMC-FEC-FCTB IN SRT TO WSS-FEC-FCTB IN WSS-VARI.
           MOVE LMC-FEC-FPRO IN SRT TO WSS-FEC-FPRO IN WSS-VARI.
      * RRM-FIN  7-MAY-1998
      *RRM     PERFORM BUSCA-GLS-CTA.
           PERFORM BUSCA-FOLIO.
      *RRM-INI 14/04/1998.MODIFICACION PARA ELIMINAR SALDOS DE ARRASTRE
      *    PERFORM BUSCA-SALDOS.
      *    MOVE DPC-VAL-SDNV IN DPC TO WSS-VAL-TDEB IN WSS-VARI.
      *    MOVE DPC-VAL-SHNV IN DPC TO WSS-VAL-THAB IN WSS-VARI.
      *RRM-FIN 14/04/1998.
      *>>>>
      *    PERFORM LMC-FST-PRO-CTL.
       LUP-OUT-SRT.
      *<<<< LUP_OUT

      *RRM-INI 06/04/1998
      *RRM-INI 22/04/1998
      *SE ASTERISQUEARA EL 'IF' PORQUE NO ES PROBLEMA DE PROGRAMA SI
      *NO DE ARCHIVO.
      *    IF LMC-CAI-IOPC IN SRT = LMC-CAI-IOPC-OLD IN SRT-OLD-LMC AND
      *       LMC-IIC-IOPC IN SRT = LMC-IIC-IOPC-OLD IN SRT-OLD-LMC AND
      *       LMC-CIC-CCSB IN SRT = LMC-CIC-CCSB-OLD IN SRT-OLD-LMC AND
      *       LMC-FEC-FCTB IN SRT = LMC-FEC-FCTB-OLD IN SRT-OLD-LMC AND
      *       SRT-COD-MVTO IN SRT = SRT-COD-MVTO-OLD IN SRT-OLD-LMC AND
      *       WSS-IND-1VEZ IN WSS-VARI NOT = 'S'
      *               GO TO NXT-OUT-SRT
      *    ELSE
      *               MOVE 'N' TO WSS-IND-1VEZ IN WSS-VARI.
      *RRN-FIN 22/04/1998
      *RRM-FIN 06/04/1998
           IF LMC-COD-OFOC IN SRT NOT = WSS-COD-OFOC IN WSS-VARI
              ADD 1 TO WSS-FOL-TERM IN WSS-VARI
              PERFORM GRABAR-FOLIOS
      *RRM-INI 14/04/1998.MODIF. ELIM. SALDO ARRASTRE.
      **INI-REL
      *       MOVE WSS-VAL-TDEB IN WSS-VARI TO WSS-VAL-TDE2 IN WSS-VAR
      *       MOVE WSS-VAL-THAB IN WSS-VARI TO WSS-VAL-THA2 IN WSS-VAR
      **REL  MOVE WSS-VAL-TDEB IN WSS-VARI TO WSS-VAL-TDCT IN WSS-LMC
      **REL  MOVE WSS-VAL-THAB IN WSS-VARI TO WSS-VAL-THCT IN WSS-LMC
      **FIN-REL
      **      MOVE WSS-VAL-TDEB IN WSS-VARI TO WSS-VAL-TDEB IN WSS-LMC
      **      MOVE WSS-VAL-THAB IN WSS-VARI TO WSS-VAL-THAB IN WSS-LMC
      *       PERFORM GRABA-NUEVOS-SALDOS
      *RRM-FIN 14/04/1998.MODIF. ELIM. SALDO ARRASTRE.

              MOVE LMC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
              PERFORM BUS-OFI
              MOVE LMC-COD-OFOC IN SRT TO WSS-COD-OFOC IN WSS-VARI
              MOVE LMC-CIC-CCSB IN SRT TO WSS-CIC-CCSB IN WSS-VARI
      *RRM-INI  7-MAY-1998
      *       MOVE LMC-FEC-FCTB IN SRT TO WSS-FEC-FCTB IN WSS-VARI
              MOVE LMC-FEC-FPRO IN SRT TO WSS-FEC-FPRO IN WSS-VARI
      *RRM-FIN  7-MAY-1998
              PERFORM BUSCA-FOLIO
              PERFORM BUSCA-GLS-CTA
      *RRM-INI 14/04/1998. MODIF. ELIM. SALDOS ARRASTRES
      *       PERFORM BUSCA-SALDOS
      *       MOVE DPC-VAL-SDNV IN DPC TO WSS-VAL-TDEB IN WSS-VARI
      *       MOVE DPC-VAL-SHNV IN DPC TO WSS-VAL-THAB IN WSS-VARI
      *RRM-FIN 14/04/1998
                 ELSE
             IF LMC-CIC-CCSB IN SRT NOT = WSS-CIC-CCSB IN WSS-VARI
      *RRM-INI 14/04/1998.MODIF. ELIM. SALDOS ARRASTRE.
      **REL  MOVE WSS-VAL-TDEB IN WSS-VARI TO WSS-VAL-TDCT IN WSS-LMC
      *         MOVE WSS-VAL-TDEB IN WSS-VARI TO WSS-VAL-TDE2 IN WSS-VAR

      **REL  MOVE WSS-VAL-THAB IN WSS-VARI TO WSS-VAL-THCT IN WSS-LMC
      *         MOVE WSS-VAL-THAB IN WSS-VARI TO WSS-VAL-THA2 IN WSS-VAR

      **        MOVE WSS-VAL-TDEB IN WSS-VARI TO WSS-VAL-TDEB IN WSS-LMC
      **        MOVE WSS-VAL-THAB IN WSS-VARI TO WSS-VAL-THAB IN WSS-LMC
      *         PERFORM GRABA-NUEVOS-SALDOS
      *RRM-FIN 14/04/1998
                MOVE LMC-CIC-CCSB IN SRT TO WSS-CIC-CCSB IN WSS-VARI
                MOVE LMC-COD-OFOC IN SRT TO WSS-COD-OFOC IN WSS-VARI
      *RRM-INI  7-MAY-1998
      *         MOVE LMC-FEC-FCTB IN SRT TO WSS-FEC-FCTB IN WSS-VARI
                MOVE LMC-FEC-FPRO IN SRT TO WSS-FEC-FPRO IN WSS-VARI
      *RRM-FIN  7-MAY-1998
                PERFORM BUSCA-GLS-CTA
      *RRM-INI 14/04/1998 MODIFICACION PARA ELIMNAR SALDOS DE ARRASTRE
      *         PERFORM BUSCA-SALDOS
      *         MOVE DPC-VAL-SDNV IN DPC TO WSS-VAL-TDEB IN WSS-VARI
      *         MOVE DPC-VAL-SHNV IN DPC TO WSS-VAL-THAB IN WSS-VARI.
      *RRM-FIN 14/04/1998.

      *RRM-INI  7-MAY-1998
      *    IF LMC-FEC-FCTB IN SRT NOT = WSS-FEC-FCTB IN WSS-VARI.
           IF LMC-FEC-FPRO IN SRT NOT = WSS-FEC-FPRO IN WSS-VARI

      **        MOVE WSS-VAL-TDEB IN WSS-VARI TO WSS-VAL-TDEB IN WSS-LMC
      **        MOVE WSS-VAL-THAB IN WSS-VARI TO WSS-VAL-THAB IN WSS-LMC
      *         MOVE LMC-FEC-FCTB IN SRT TO WSS-FEC-FCTB IN WSS-VARI.
             MOVE LMC-FEC-FPRO IN SRT TO WSS-FEC-FPRO IN WSS-VARI.
      *RRM-FIN  7-MAY-1998
           PERFORM BUS-REG-CLI.
           IF EMIS-RESUMEN
              GO TO FIN-GENE-OUT.
      *>>>>
       GEN-OUT-SRT.
           PERFORM GENERATE-DL-LMC.
      *<<<< FIN_GEN_OUT
      **RRM-INI 17/04/1998
      **ESTA MODIFICACION ES PARA QUE SE IMPRIMA UNA VEZ C/CTA.CTBLE.
      *    IF WSS-IND-1DL IN WSS-VARI = 'S' OR
      *     LMC-FEC-FCTB IN SRT NOT = LMC-FEC-FCTB-OLD IN SRT-OLD-LMC OR
      *     LMC-CIC-CCSB IN SRT NOT = LMC-CIC-CCSB-OLD IN SRT-OLD-LMC OR
      *     SRT-COD-MVTO IN SRT NOT = SRT-COD-MVTO-OLD IN SRT-OLD-LMC
      *          PERFORM GENERATE-DL-LMC
      *         MOVE 'N' TO WSS-IND-1DL IN WSS-VARI.
      *
      *    PERFORM PRO-DET-CTA.
      *RRM-FIN 17/04/1998
       FIN-GENE-OUT.
      *RRM-INI 14/04/1998.MODIFICACION PARA ELIMNAR SALDOS DE ARRASTRE.
      ** Acumula Saldos del Periodo.
      *     DISPLAY ' '.
      *     DISPLAY 'ESTOY ACUMULANDO SALDOS DEL PERIODO'.
      *     DISPLAY '***********************************'.
      *     DISPLAY 'MUESTRO ESTA VARIABLE ANTES DE SUMARLA'.
      *     DISPLAY 'WSS-VAL-TDEB: ' WSS-VAL-TDEB IN WSS-VARI.
      *     DISPLAY 'SRT-VAL-DEBE: ' SRT-VAL-DEBE IN SRT.
      *     DISPLAY ' '.
      *     COMPUTE WSS-VAL-TDEB IN WSS-VARI =
      *             WSS-VAL-TDEB IN WSS-VARI + SRT-VAL-DEBE IN SRT.
      *     DISPLAY 'MUESTRO ESTA VARIABLE DESPUES DE SUMARLA'.
      *     DISPLAY 'WSS-VAL-TDEB: ' WSS-VAL-TDEB IN WSS-VARI.
      *     DISPLAY ' '.
      *     DISPLAY 'MUESTRO ESTA VARIABLE ANTES DE SUMARLA'.
      *     DISPLAY 'WSS-VAL-THAB: ' WSS-VAL-THAB IN WSS-VARI.
      *     DISPLAY 'SRT-VAL-HABE: ' SRT-VAL-HABE IN SRT.
      *     COMPUTE WSS-VAL-THAB IN WSS-VARI =
      *             WSS-VAL-THAB IN WSS-VARI + SRT-VAL-HABE IN SRT.
      *     DISPLAY ' '.
      *     DISPLAY 'MUESTRO ESTA VARIABLE DESPUES DE SUMARLA'.
      *     DISPLAY 'WSS-VAL-THAB: ' WSS-VAL-THAB IN WSS-VARI.
      *RRM-FIN 14/04/1998.
      *RRM-INI 17-APR-1998
      *     MOVE LMC-FEC-FCTB IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
      *     MOVE WSS-NUM-DREG IN WSS-VARI TO WSS-NUM-DMOV IN WSS-LMC.
      *     MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MMOV IN WSS-LMC.
      *     MOVE WSS-NUM-SREG IN WSS-VARI TO WSS-NUM-SMOV IN WSS-LMC.
      *     MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-AMOV IN WSS-LMC.
      *RRM-FIN 17-APR-1998
      *>>>>
       NXT-OUT-SRT.
           MOVE SRT TO SRT-OLD-LMC.
       RET-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
      *>>>>
           IF HAY-REGISTROS-EN-SORT-LMC
                PERFORM TERMINATE-RPTLMC.
      *<<<< FIN_TMT
           IF HAY-REG
             ADD 1 TO WSS-FOL-TERM IN WSS-VARI
             PERFORM GRABAR-FOLIOS
      *RRM-INI 14/04/1998.MODIF. ELIM. SALDOS ARRASTRE
      **REL  MOVE WSS-VAL-TDEB IN WSS-VARI TO WSS-VAL-TDCT IN WSS-LMC
      *      MOVE WSS-VAL-TDEB IN WSS-VARI TO WSS-VAL-TDE2 IN WSS-VARI
      **REL  MOVE WSS-VAL-THAB IN WSS-VARI TO WSS-VAL-THCT IN WSS-LMC
      *      MOVE WSS-VAL-THAB IN WSS-VARI TO WSS-VAL-THA2 IN WSS-VARI
      *      PERFORM GRABA-NUEVOS-SALDOS
      *RRM-FIN 14/04/1998
           ELSE
             DISPLAY '**********************************************'
             DISPLAY '** NO HAY MOVIMIENTOS EN EL RANGO DE FECHAS **'
             DISPLAY '** SELECCIONADO EN PARAMETROS DEL JCL       **'
             DISPLAY '**********************************************'.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-DPC.
      *>>>>
           CLOSE RPTLMC.
       EXT-OUT-SRT.
           EXIT.
       COPY COLBFLMC.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGIRH.
       COPY COLRELMC.
      *    07-MAY-98 06:54 PM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
       D-CF-LMC-LMC-COD-OFOC SECTION.
       INI-CF-LMC-LMC-COD-OFOC.
      *<<<< CF_LMC_LMC_COD_OFOC
      *>>>>
       FIN-CF-LMC-LMC-COD-OFOC.
           EXIT.
       D-CF-LMC-LMC-COD-VCOC SECTION.
       INI-CF-LMC-LMC-COD-VCOC.
      *<<<< CF_LMC_LMC_COD_VCOC
      *>>>>
       FIN-CF-LMC-LMC-COD-VCOC.
           EXIT.
       D-CF-LMC-LMC-FEC-FPRO SECTION.
       INI-CF-LMC-LMC-FEC-FPRO.
      *<<<< CF_LMC_LMC_FEC_FPRO
      *RRM-INI  20-APR-1998
      *RRM-INI   7-MAY-1998
      *    MOVE LMC-FEC-FCTB IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
           MOVE LMC-FEC-FPRO IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
      *RRM-FIN   7-MAY-1998 19:15:43
           MOVE WSS-NUM-DREG IN WSS-VARI TO WSS-NUM-DMOV IN WSS-LMC.
           MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MMOV IN WSS-LMC.
           MOVE WSS-NUM-SREG IN WSS-VARI TO WSS-NUM-SMOV IN WSS-LMC.
           MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-AMOV IN WSS-LMC.
      *RRM-FIN  20-APR-1998
      *>>>>
       FIN-CF-LMC-LMC-FEC-FPRO.
           EXIT.
       D-CH-LMC-LMC-CIC-CCSB SECTION.
       INI-CH-LMC-LMC-CIC-CCSB.
      *<<<<CH_LMC_LMC_CIC_CCSB
           MOVE LMC-CIC-CCSB IN SRT TO WSS-CIC-CCSB IN WSS-VARI.
           MOVE LMC-COD-OFOC IN SRT TO WSS-COD-OFOC IN WSS-VARI.
      * RRM-INI 7-MAY-1998
      *    MOVE LMC-FEC-FCTB IN SRT TO WSS-FEC-FCTB IN WSS-VARI.
           MOVE LMC-FEC-FPRO IN SRT TO WSS-FEC-FPRO IN WSS-VARI.
      * RRM-FIN 7-MAY-1998
           PERFORM BUSCA-GLS-CTA.
      * Mueve subtitulo dependiendo si es CUR o CAN u OTRO.
           IF SRT-COD-MVTO IN SRT = '1'
               MOVE '        NUEVAS COLOCACIONES        ' TO
                                                 WSS-GLS-STIT IN WSS-LMC
           ELSE
               IF SRT-COD-MVTO IN SRT = '2'
                   MOVE '  CANCELACIONES Y RENEGOCIACIONES  ' TO
                                                 WSS-GLS-STIT IN WSS-LMC
               ELSE
                   IF SRT-COD-MVTO IN SRT = '3'
                      MOVE '        TRASPASOS DE CARTERA       ' TO
                                                 WSS-GLS-STIT IN WSS-LMC
                   ELSE
                      MOVE SPACES TO WSS-GLS-STIT IN WSS-LMC.
      *>>>>
       FIN-CH-LMC-LMC-CIC-CCSB.
           EXIT.
       D-CF-LMC-LMC-CIC-CCSB SECTION.
       INI-CF-LMC-LMC-CIC-CCSB.
      *<<<< CF_LMC_LMC_CIC_CCSB
           MOVE 'S' TO WSS-IND-SEMA IN WSS-VARI.
      *>>>>
       FIN-CF-LMC-LMC-CIC-CCSB.
           EXIT.
       D-PH-LMC SECTION.
       INI-PH-LMC.
      *<<<< PH_LMC
      * Mediante BUS-OFI Obtiene Nombre Oficina de Tabla OFI
           IF LMC-COD-OFOC IN SRT > SPACES
               MOVE LMC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI.

      * Mueve Nro. de Folio
            ADD 1 TO WSS-FOL-FINA IN WSS-VARI
            MOVE WSS-FOL-FINA IN WSS-VARI TO WSS-NUM-FOLO IN WSS-LMC.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF LMC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE LMC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCOC IN WSS-LMC
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-LMC.
      *>>>>
       FIN-PH-LMC.
           EXIT.
       D-DL-LMC SECTION.
       INI-DL-LMC.
      *<<<< DL_LMC
      * RRM-INI  17-APR-1998
      ** Mueve subtitulo dependiendo si es CUR o CAN u OTRO.
      *    IF SRT-COD-MVTO IN SRT = '1'
      *        MOVE '        NUEVAS COLOCACIONES        ' TO
      *                                          WSS-GLS-STIT IN WSS-LMC
      *    ELSE
      *        IF SRT-COD-MVTO IN SRT = '2'
      *            MOVE '  CANCELACIONES Y RENEGOCIACIONES  ' TO
      *                                          WSS-GLS-STIT IN WSS-LMC
      *        ELSE
      *            IF SRT-COD-MVTO IN SRT = '3'
      *               MOVE '        TRASPASOS DE CARTERA       ' TO
      *                                          WSS-GLS-STIT IN WSS-LMC
      *            ELSE
      *               MOVE SPACES TO WSS-GLS-STIT IN WSS-LMC.
      *>>>>
       FIN-DL-LMC.
           EXIT.
       COPY GNSBGABT.

      *<<<< EOF
      *INI-JGM ****************************************
       VALIDA-FECHAS SECTION.
       INI-VALIDAD-FECHAS.
      *Captura Fecha de de hoy(Fecha de Ejecucion).
      *
           MOVE 'S' TO WSS-IND-DIAHABIL IN WSS-VARI.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY  TO WSS-NUM-DEJE IN WSS-VARI
                             FEC-ITM1 IN FEC-FECH.
           MOVE HOY-MHOY  TO WSS-NUM-MEJE IN WSS-VARI
                             FEC-ITM2 IN FEC-FECH.
           MOVE HOY-SHOY  TO WSS-NUM-SEJE IN WSS-VARI
                             FEC-ITM3 IN FEC-FECH.
           MOVE HOY-AHOY  TO WSS-NUM-AEJE IN WSS-VARI
                             FEC-ITM4 IN FEC-FECH.
       VAL-FEJE-HABIL.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER OR NOT FEC-STAT-HBL
              MOVE 'N' TO WSS-IND-DIAHABIL IN WSS-VARI
              DISPLAY 'FECHA EJE. NO ES HABIL ..'.

      **************************************************************
      *mover fechas de formato DDMMSSAA a SSAAMMDD
           MOVE PRM-NUM-DINI IN WSS-VARI TO WSS-NUM-DINI IN WSS-VARI.
           MOVE PRM-NUM-MINI IN WSS-VARI TO WSS-NUM-MINI IN WSS-VARI.
           MOVE PRM-NUM-SINI IN WSS-VARI TO WSS-NUM-SINI IN WSS-VARI.
           MOVE PRM-NUM-AINI IN WSS-VARI TO WSS-NUM-AINI IN WSS-VARI.

           MOVE PRM-NUM-DTER IN WSS-VARI TO WSS-NUM-DTER IN WSS-VARI.
           MOVE PRM-NUM-MTER IN WSS-VARI TO WSS-NUM-MTER IN WSS-VARI.
           MOVE PRM-NUM-STER IN WSS-VARI TO WSS-NUM-STER IN WSS-VARI.
           MOVE PRM-NUM-ATER IN WSS-VARI TO WSS-NUM-ATER IN WSS-VARI.
      *
           IF PRM-NUM-SINI IN WSS-VARI NOT = PRM-NUM-STER
                                              IN WSS-VARI  OR
              PRM-NUM-AINI IN WSS-VARI NOT = PRM-NUM-ATER IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               DISPLAY 'ERROR PARAMETROS DISTINTOS ANOS'
               GO TO FIN-VALIDA-FECHAS.
      *
           PERFORM BUS-FECHA-INICIO.
           PERFORM BUS-FECHA-TERMINO.
           PERFORM BUS-DATOS-DPC.
      *
      * Fecha termino sea menor que la fecha de ejecucion.
           MOVE PRM-NUM-DTER IN WSS-VARI TO PRM-NUM-DAUX IN WSS-VARI.
           MOVE PRM-NUM-MTER IN WSS-VARI TO PRM-NUM-MAUX IN WSS-VARI.
           MOVE PRM-NUM-STER IN WSS-VARI TO PRM-NUM-SAUX IN WSS-VARI.
           MOVE PRM-NUM-ATER IN WSS-VARI TO PRM-NUM-AAUX IN WSS-VARI.

           IF FECE-SIHABIL
      *INI-JGM 11-01-2000
      *     IF WSS-FEC-FTER IN WSS-VARI NOT < WSS-FEC-FEJE IN WSS-VARI
            IF WSS-FEC-FTER IN WSS-VARI >   WSS-FEC-FEJE IN WSS-VARI
      *FIN-JGM 11-01-2000
               DISPLAY 'FEC. TERMINO MAYOR QUE EJECUCION :'
                           PRM-FEC-FTER IN WSS-VARI
                           MOVE PGM-SMAL TO PGM-STAT-SRT
                           GO TO FIN-VALIDA-FECHAS.

           IF FECE-NOHABIL
              IF PRM-FEC-FAUX IN WSS-VARI >
                                 WSS-FEC-FTER IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               DISPLAY 'Error en Fecha termino '
               GO TO FIN-VALIDA-FECHAS.
      *
      * Fecha Inicio.
           MOVE 'N' TO WSS-IND-FECH  IN WSS-VARI.
           MOVE PRM-NUM-DINI IN WSS-VARI TO PRM-NUM-DAUX IN WSS-VARI.
           MOVE PRM-NUM-MINI IN WSS-VARI TO PRM-NUM-MAUX IN WSS-VARI.
           MOVE PRM-NUM-SINI IN WSS-VARI TO PRM-NUM-SAUX IN WSS-VARI.
           MOVE PRM-NUM-AINI IN WSS-VARI TO PRM-NUM-AAUX IN WSS-VARI.
           DISPLAY ' '.
           DISPLAY 'PROCESO  ACTUAL :SSAAMMDD '
           DISPLAY '---------------------------'.
           DISPLAY 'INICIO PAR.: ' PRM-FEC-FAUX IN WSS-VARI
                   ' INICIO PROG.: ' WSS-FEC-FINI IN WSS-VARI
                   ' ESPERA DPC .: ' WSS-FEC-FESP IN WSS-VARI.
           DISPLAY 'TERMINO:' WSS-FEC-FTER IN WSS-VARI.
           DISPLAY 'PROCESO:' WSS-FEC-FEJE IN WSS-VARI.

      *
           IF PRM-FEC-FAUX IN WSS-VARI > WSS-FEC-FTER IN WSS-VARI
               DISPLAY '(1) ERROR EN FECHA INICIO '
               MOVE PGM-SMAL TO PGM-STAT-SRT
               MOVE 'S' TO WSS-IND-FECH  IN WSS-VARI
           ELSE
           IF PRM-FEC-FAUX IN WSS-VARI < WSS-FEC-FESP IN WSS-VARI
               MOVE 'S' TO WSS-IND-FECH  IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               DISPLAY '(2) ERROR EN FECHA INICIO '
           ELSE
           IF WSS-FEC-FESP IN WSS-VARI < WSS-FEC-FINI IN WSS-VARI OR
              WSS-FEC-FESP IN WSS-VARI > PRM-FEC-FAUX IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               MOVE 'S' TO WSS-IND-FECH  IN WSS-VARI
               DISPLAY '(3) ERROR EN FECHA INICIO '.
      *
           IF EMIS-LEGAL OR EMIS-RESUMEN
              IF WSS-IND-FECH IN WSS-VARI = 'S'
                 MOVE PGM-SMAL TO PGM-STAT-SRT.
      *
           MOVE WSS-NUM-DESP IN WSS-VARI TO WSS-NUM-DINI IN WSS-LMC
                                            WSS-NUM-DREG IN WSS-VARI.
           MOVE WSS-NUM-MESP IN WSS-VARI TO WSS-NUM-MINI IN WSS-LMC
                                            WSS-NUM-MREG IN WSS-VARI.
           MOVE WSS-NUM-AESP IN WSS-VARI TO WSS-NUM-AINI IN WSS-LMC
                                            WSS-NUM-AREG IN WSS-VARI.
           MOVE WSS-NUM-SESP IN WSS-VARI TO WSS-NUM-SINI IN WSS-LMC
                                            WSS-NUM-SREG IN WSS-VARI.
      *
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DTER IN WSS-LMC.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MTER IN WSS-LMC.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ATER IN WSS-LMC.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-STER IN WSS-LMC.
       FIN-VALIDA-FECHAS.
           EXIT.


       BUS-DATOS-DPC SECTION.
      *---------------------*
       INI-BUS-DATOS-DPC.
           MOVE 'N' TO WSS-IND-RESE IN WSS-VARI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-DPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE ARCHIVO CON DATOS PROC.CONTAB ANT'
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO FIN-BUS-DATOS-DPC.

           MOVE '1'         TO DPC-TIP-REGI IN DPC.
           MOVE 'DATPRO'    TO DPC-COD-PRO1 IN DPC.
           MOVE SPACES      TO DPC-FIL-FIL1 IN DPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL LEER TABLA DPC'
              DISPLAY 'NO EXISTE REGISTRO CON DATOS DEL PROC.ANT'
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO FIN-BUS-DATOS-DPC.
      *
           IF DPC-NUM-ATER IN DPC NOT = WSS-NUM-ATER IN WSS-VARI OR
              DPC-NUM-STER IN DPC NOT = WSS-NUM-STER IN WSS-VARI
              MOVE 'S' TO WSS-IND-RESE IN WSS-VARI.
      *
           MOVE DPC-NUM-DTER TO FEC-ITM1.
           MOVE DPC-NUM-MTER TO FEC-ITM2.
           MOVE DPC-NUM-STER TO FEC-ITM3.
           MOVE DPC-NUM-ATER TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           IF NOT  FEC-STAT-OKS
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO FIN-BUS-DATOS-DPC.

      *
           MOVE FEC-ITM1 IN FEC-FECH TO WSS-NUM-DESP IN WSS-VARI
                                        WSS-NUM-DREG IN WSS-VARI.
           MOVE FEC-ITM2 IN FEC-FECH TO WSS-NUM-MESP IN WSS-VARI
                                        WSS-NUM-MREG IN WSS-VARI.
           MOVE FEC-ITM3 IN FEC-FECH TO WSS-NUM-SESP IN WSS-VARI
                                        WSS-NUM-SREG IN WSS-VARI.
           MOVE FEC-ITM4 IN FEC-FECH TO WSS-NUM-AESP IN WSS-VARI
                                        WSS-NUM-AREG IN WSS-VARI.
           DISPLAY ' '.
           DISPLAY 'PROCESO ANTERIOR :SSAAMMDD '.
           DISPLAY '---------------------------'.
           DISPLAY 'PROCESO ' DPC-FEC-FPRO IN DPC.
           DISPLAY 'INICIO  ' DPC-FEC-FINI IN DPC.
           DISPLAY 'TERMINO ' DPC-FEC-FTER IN DPC.
           DISPLAY 'FECHA ESPERADA (DDMMSSAA)  '
                          WSS-FEC-FESP IN WSS-VARI.
      *
       FIN-BUS-DATOS-DPC.
           EXIT.
      *
       RESETEO-FOLIOS SECTION.
      ***********************
       INI-RESETEO-FOLIOS.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-DPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE ARCHIVO CON DATOS'
              MOVE PGM-SMAL TO PGM-STAT-SRT.
      *
           MOVE '2'        TO DPC-TIP-REGI IN DPC.
           MOVE SPACES     TO DPC-FIL-FIL2 IN DPC.
           IF PRM-COD-OFIC IN WSS-VARI = '*'
              MOVE SPACES TO  DPC-COD-OFI2 IN DPC
           ELSE
              MOVE PRM-COD-OFIC IN WSS-VARI TO
                              DPC-COD-OFI2 IN DPC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DPC.
           IF NOT FIO-STAT-OKS
              GO TO CERRAR-DPC.
       LUP-RESETEO-DPC.
           IF DPC-TIP-REGI IN DPC NOT = '2'
              GO TO NTX-RESETEO-DPC.
      *
           MOVE FIO-GET-KEY-UPD TO FIO-CMND
           PERFORM COL-FIO-DPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR EN RESETEO DE FOLIO X OFICINA '
              GO TO CERRAR-DPC.
      *
           DISPLAY 'OFICINA : ' DPC-COD-OFI2 IN DPC.
           DISPLAY 'FOLIOS  : ' DPC-NUM-FOI2 IN DPC ' AL '
                               DPC-NUM-FOF2 IN DPC.
      *
           MOVE ZEROES TO DPC-NUM-FOI2 IN DPC.
           MOVE ZEROES TO DPC-NUM-FOF2 IN DPC.
           MOVE SPACES TO DPC-GLS-DIS2 IN DPC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE PUEDE MODIFICAR '
              GO TO CERRAR-DPC.
      *
       NTX-RESETEO-DPC.
           IF PRM-COD-OFIC IN WSS-VARI = '*'
              MOVE FIO-GET-NXT TO FIO-CMND
              PERFORM COL-FIO-DPC
              IF FIO-STAT-OKS
                 GO TO LUP-RESETEO-DPC.
      *
       CERRAR-DPC.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-DPC.
       FIN-RESETEO-FOLIOS.
           EXIT.

       BUS-FECHA-TERMINO  SECTION.
      *-------------------------*
       INI-BUS-FECHA-TERMINO.
           MOVE WSS-NUM-DTER IN WSS-VARI TO FEC-ITM1 IN FEC-FECH.
           MOVE WSS-NUM-MTER IN WSS-VARI TO FEC-ITM2 IN FEC-FECH.
           MOVE WSS-NUM-STER IN WSS-VARI TO FEC-ITM3 IN FEC-FECH.
           MOVE WSS-NUM-ATER IN WSS-VARI TO FEC-ITM4 IN FEC-FECH.
           MOVE SPACES       TO MSG-COD-MENS.
        BUSCA-FECHA.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-SIG-HBL  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
              DISPLAY 'Error en calculo de fecha'
                 WSS-FEC-FTER IN WSS-VARI
                 MOVE 'FECDHANNEX'   TO MSG-COD-MENS
                 MOVE PGM-SMAL       TO PGM-STAT-SRT
                 GO TO FIN-BUS-FECHA-TERMINO.
      *
      *Si mismo Mes Y Ano Y Siglo.
           IF WSS-NUM-MTER IN WSS-VARI = FEC-ITM2 IN FEC-FECH AND
              WSS-NUM-STER IN WSS-VARI = FEC-ITM3 IN FEC-FECH AND
              WSS-NUM-ATER IN WSS-VARI = FEC-ITM4 IN FEC-FECH

               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-FBLK-N   TO FEC-FBLK
               MOVE FEC-CHOY-N   TO FEC-CHOY
               MOVE FEC-RST-DIA  TO FEC-CMND
               MOVE 1            TO FEC-NDIA
               PERFORM CAL-FEC
               IF NOT  FEC-STAT-OKS
                  MOVE 'FECDHANNEX'   TO MSG-COD-MENS
                  GO TO  FIN-BUS-FECHA-TERMINO
               ELSE
                  GO TO MOVER-FECHA
           ELSE
              MOVE  1     TO  FEC-ITM1 IN FEC-FECH
              MOVE FEC-FORM-FEC TO FEC-FORM
              MOVE FEC-FBLK-N   TO FEC-FBLK
              MOVE FEC-CHOY-N   TO FEC-CHOY
              MOVE FEC-VHBL-N   TO FEC-VHBL
              MOVE FEC-RST-DIA  TO FEC-CMND
              MOVE 1            TO FEC-NDIA
              PERFORM CAL-FEC
              IF NOT  FEC-STAT-OKS
                 MOVE 'FECDHANNEX'   TO MSG-COD-MENS
                 GO TO  FIN-BUS-FECHA-TERMINO.

       MOVER-FECHA.
            MOVE FEC-ITM1 IN FEC-FECH TO WSS-NUM-DTER IN WSS-VARI.
            MOVE FEC-ITM2 IN FEC-FECH TO WSS-NUM-MTER IN WSS-VARI.
            MOVE FEC-ITM3 IN FEC-FECH TO WSS-NUM-STER IN WSS-VARI.
            MOVE FEC-ITM4 IN FEC-FECH TO WSS-NUM-ATER IN WSS-VARI.
       FIN-BUS-FECHA-TERMINO.
           EXIT.

       BUS-FECHA-INICIO SECTION.
      *--------------------------*
       INI-BUS-FECHA-INICIO.
           MOVE WSS-NUM-DINI IN WSS-VARI TO FEC-ITM1 IN FEC-FECH.
           MOVE WSS-NUM-MINI IN WSS-VARI TO FEC-ITM2 IN FEC-FECH.
           MOVE WSS-NUM-SINI IN WSS-VARI TO FEC-ITM3 IN FEC-FECH.
           MOVE WSS-NUM-AINI IN WSS-VARI TO FEC-ITM4 IN FEC-FECH.
           MOVE SPACES       TO MSG-COD-MENS.
           MOVE ZEROES       TO WSS-NUM-TDIA IN WSS-VARI.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
       VAL-DIA-DHBL.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC
           IF FEC-STAT-FER OR NOT FEC-STAT-HBL
              IF FEC-ITM1 IN FEC-FECH > 1
                     ADD 1 TO WSS-NUM-TDIA IN WSS-VARI
                     MOVE FEC-FORM-FEC TO FEC-FORM
                     MOVE FEC-RST-DIA  TO FEC-CMND
                     MOVE 1            TO FEC-NDIA
                     PERFORM CAL-FEC
                     IF NOT FEC-STAT-OKS
                        MOVE 'FECDHANNEX'   TO MSG-COD-MENS
                        GO TO FIN-BUS-FECHA-INICIO
                     ELSE
                       GO TO VAL-DIA-DHBL
              ELSE
                  NEXT SENTENCE
           ELSE
             IF WSS-NUM-TDIA IN WSS-VARI = ZEROES
                GO TO FIN-BUS-FECHA-INICIO.
      *
           MOVE FEC-ITM1 IN FEC-FECH TO WSS-NUM-DINI IN WSS-VARI.
           MOVE FEC-ITM2 IN FEC-FECH TO WSS-NUM-MINI IN WSS-VARI.
           MOVE FEC-ITM3 IN FEC-FECH TO WSS-NUM-SINI IN WSS-VARI.
           MOVE FEC-ITM4 IN FEC-FECH TO WSS-NUM-AINI IN WSS-VARI.
       FIN-BUS-FECHA-INICIO.
           EXIT.


       DATOS-PROCE-CONTAB SECTION.
      ****************************
       INI-DATOS-PROCE-CONTAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-DPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE ARCHIVO CON DATOS PROC.CONTAB ANTERIOR'
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO FIN-DATOS-PROCE-CONTAB.

           MOVE '1'         TO DPC-TIP-REGI IN DPC.
           MOVE 'DATPRO'    TO DPC-COD-PRO1 IN DPC.
           MOVE SPACES      TO DPC-FIL-FIL1 IN DPC.
           IF EMIS-LEGAL
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
           ELSE
              MOVE FIO-GET-KEY TO FIO-CMND.

           PERFORM COL-FIO-DPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL LEER TABLA DPC'
              DISPLAY 'NO EXISTE REGISTRO CON DATOS DEL PROC.ANTERIOR'
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO FIN-DATOS-PROCE-CONTAB.


           MOVE WSS-FEC-FEJE IN WSS-VARI TO DPC-FEC-FPRO IN DPC.
           MOVE WSS-FEC-FREG IN WSS-VARI TO DPC-FEC-FINI IN DPC.
           MOVE WSS-FEC-FTER IN WSS-VARI TO DPC-FEC-FTER IN DPC.
           MOVE SPACES                   TO DPC-GLS-DISP IN DPC.
      *
           IF EMIS-LEGAL
              MOVE FIO-MOD TO FIO-CMND
              PERFORM COL-FIO-DPC.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-DPC.
       FIN-DATOS-PROCE-CONTAB.
           EXIT.
      *FIN-JGM  ***************************************
      *COPIA-PROCE-CONTAB SECTION.
      ****************************
      *INI-COPIA-PROCE-CONTAB.
      *    MOVE '1'         TO DPC-TIP-REGI IN DPC.
      *    MOVE 'DATPRO'    TO DPC-COD-PRO1 IN DPC.
      *    MOVE SPACES      TO DPC-FIL-FIL1 IN DPC.
      *    MOVE FIO-GET-KEY-UPD TO FIO-CMND
      *   PERFORM COL-FIO-DPC.
      *     IF NOT FIO-STAT-OKS
      *        DISPLAY 'COPIA ERROR AL LEER TABLA DPC'
      *        MOVE PGM-SMAL TO PGM-STAT-SRT
      *        GO TO FIN-DATOS-PROCE-CONTAB.
      *     MOVE 19991210                 TO DPC-FEC-FPRO IN DPC.
      *     MOVE 19981231                 TO DPC-FEC-FINI IN DPC.
      *    MOVE 19981231                 TO DPC-FEC-FTER IN DPC.
      *    MOVE SPACES                   TO DPC-GLS-DISP IN DPC.
      *    MOVE FIO-MOD TO FIO-CMND
      *    PERFORM COL-FIO-DPC.
      *    IF FIO-STAT-OKS
      *       DISPLAY 'GRA.....'.
      *    MOVE FIO-CLO TO FIO-CMND.
      *   PERFORM COL-FIO-DPC.
      *FIN-COPIA-PROCE-CONTAB.
      *    EXIT.


      ******************************************************************
       BUSCA-FOLIO SECTION.
      *********************
       INI-BUSCA-FOLIO.
           MOVE '2'                 TO DPC-TIP-REGI IN DPC.
           MOVE LMC-COD-OFOC IN SRT TO DPC-COD-OFI2 IN DPC.
           MOVE SPACES              TO DPC-FIL-FIL2 IN DPC.
           DISPLAY 'BUSCA-FOLIOS PARA OFICINA : ' DPC-COD-OFI2 IN DPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DPC.
           IF FIO-STAT = '23'
              MOVE ZEROES TO DPC-NUM-FOI2 IN DPC
              MOVE ZEROES TO DPC-NUM-FOF2 IN DPC
              MOVE SPACES TO DPC-GLS-DIS2 IN DPC
              IF EMIS-LEGAL
                 MOVE FIO-PUT TO FIO-CMND
                 PERFORM COL-FIO-DPC.

           DISPLAY 'FOLIOS : ' DPC-NUM-FOI2 IN DPC ' - '
                               DPC-NUM-FOF2 IN DPC.
           MOVE DPC-NUM-FOF2 IN DPC TO WSS-FOL-FINA IN WSS-VARI
                                       WSS-FOL-TERM IN WSS-VARI.
       FIN-BUSCA-FOLIO.
           EXIT.

      ******************************************************************
       GRABAR-FOLIOS SECTION.
      ***********************
       INI-GRABAR-FOLIOS.
           MOVE '2'                      TO DPC-TIP-REGI IN DPC.
           MOVE WSS-COD-OFOC IN WSS-VARI TO DPC-COD-OFI2 IN DPC.
           MOVE SPACES                   TO DPC-FIL-FIL2 IN DPC.
           IF EMIS-LEGAL
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM COL-FIO-DPC.

           MOVE WSS-FOL-TERM IN WSS-VARI TO DPC-NUM-FOI2 IN DPC.
           MOVE WSS-FOL-FINA IN WSS-VARI TO DPC-NUM-FOF2 IN DPC.
           MOVE SPACES                   TO DPC-GLS-DIS2 IN DPC.
           DISPLAY 'GRABA-FOLIOS PARA OFICINA : ' DPC-COD-OFI2 IN DPC.
           IF EMIS-LEGAL
              MOVE FIO-MOD TO FIO-CMND
              PERFORM COL-FIO-DPC.

           DISPLAY 'FOLIOS : ' DPC-NUM-FOI2 IN DPC ' - '
                               DPC-NUM-FOF2 IN DPC.
       FIN-GRABAR-FOLIOS.
           EXIT.
      *

      ******************************************************************
       BUSCA-SALDOS SECTION.
      **********************
      *RRM-INI 14/04/1998.MODIF. ELIM. SALDOS ARRASTRE
      *INI-BUSCA-SALDOS.
      *    PERFORM VE-RESETEO-CUENTA.
      *    MOVE '3'                 TO DPC-TIP-REGI IN DPC.
      *    MOVE LMC-CIC-CCSB IN SRT TO DPC-COD-CCTA IN DPC.
      *    MOVE LMC-COD-OFOC IN SRT TO DPC-COD-OFI3 IN DPC.
      *    MOVE FIO-GET-KEY         TO FIO-CMND.
      *    PERFORM COL-FIO-DPC.
      *    IF FIO-STAT = '23' OR RESET-SALDOS
      *       MOVE ZEROES TO DPC-VAL-SDAN IN DPC
      *       MOVE ZEROES TO DPC-VAL-SHAN IN DPC
      *       MOVE ZEROES TO DPC-VAL-MDPE IN DPC
      *       MOVE ZEROES TO DPC-VAL-MHPE IN DPC
      *       MOVE ZEROES TO DPC-VAL-SDNV IN DPC
      *       MOVE ZEROES TO DPC-VAL-SHNV IN DPC
      *       MOVE SPACES TO DPC-GLS-DIS3 IN DPC
      *       IF EMIS-LEGAL AND FIO-STAT = '23'
      *          MOVE FIO-PUT TO FIO-CMND
      *          PERFORM COL-FIO-DPC.

      **MUEVO LOS NUEVOS SALDOS DEL DEBE Y HABER.
      *    MOVE DPC-VAL-SDNV IN DPC TO WSS-DEB-ANTE IN WSS-LMC.
      *    MOVE DPC-VAL-SHNV IN DPC TO WSS-HAB-ANTE IN WSS-LMC.
      *    MOVE DPC-VAL-SDNV IN DPC TO WSS-SLD-DBAN IN WSS-VARI.
      *    MOVE DPC-VAL-SHNV IN DPC TO WSS-SLD-HBAN IN WSS-VARI.

      **MUEVO LOS ANTERIORES SALDOS DEL DEBE Y HABER.
      *    MOVE DPC-VAL-SDAN IN DPC TO WSS-DEB-ANTI IN WSS-VARI.
      *    MOVE DPC-VAL-SHAN IN DPC TO WSS-HAB-ANTI IN WSS-VARI.

      * Muevo los movimientos del periodo del Debe y Haber.
      *    MOVE DPC-VAL-MDPE IN DPC TO WSS-DEB-MVTO IN WSS-VARI.
      *    MOVE DPC-VAL-MHPE IN DPC TO WSS-HAB-MVTO IN WSS-VARI.

      *    DISPLAY ' '.
      *    DISPLAY 'ESTOY EN SECTION BUSCA-SALDOS'.
      *    DISPLAY '*****************************'.
      *    DISPLAY 'BUSCA-SALDOS PARA OFICINA : ' DPC-COD-OFI3 IN DPC.
      *    DISPLAY 'NUMERO DE CUENTA          : ' DPC-COD-CCTA IN DPC.
      *    DISPLAY 'SALDO ANTERIOR: ' WSS-DEB-ANTI IN WSS-VARI ' - '
      *                               WSS-HAB-ANTI IN WSS-VARI.
      *    DISPLAY 'MOVTO PERIODO : ' WSS-DEB-MVTO IN WSS-VARI ' - '
      *                               WSS-HAB-MVTO IN WSS-VARI.
      *    DISPLAY 'SALDO ACTUAL  : ' WSS-DEB-ANTE IN WSS-LMC  '   - '
      *                               WSS-HAB-ANTE IN WSS-LMC.
      *RRM-FIN 14/04/1998.
       FIN-BUSCA-SALDOS.
           EXIT.

      ******************************************************************
       GRABA-NUEVOS-SALDOS SECTION.
      *****************************
       INI-GRABA-NUEVOS-SALDOS.
      *RRM-INI  27-APR-1998.ELIM. SALDOS ARRASTRE
      *    COMPUTE WSS-MVO-DEBE IN WSS-VARI =
      **REL        WSS-VAL-TDCT IN WSS-LMC - WSS-SLD-DBAN IN WSS-VARI.
      *            WSS-VAL-TDE2 IN WSS-VARI - WSS-SLD-DBAN IN WSS-VARI.
      *    COMPUTE WSS-MVO-HABE IN WSS-VARI =
      **REL        WSS-VAL-THCT IN WSS-LMC - WSS-SLD-HBAN IN WSS-VARI.
      *            WSS-VAL-THA2 IN WSS-VARI  - WSS-SLD-HBAN IN WSS-VARI.

      *    MOVE '3'                      TO DPC-TIP-REGI IN DPC.
      *    MOVE WSS-CIC-CCSB IN WSS-VARI TO DPC-COD-CCTA IN DPC.
      *    MOVE WSS-COD-OFOC IN WSS-VARI TO DPC-COD-OFI3 IN DPC.
      *    IF EMIS-LEGAL
      *       MOVE FIO-GET-KEY-UPD TO FIO-CMND
      *       PERFORM COL-FIO-DPC.

      *    MOVE WSS-SLD-DBAN IN WSS-VARI TO DPC-VAL-SDAN IN DPC.
      *    MOVE WSS-SLD-HBAN IN WSS-VARI TO DPC-VAL-SHAN IN DPC.
      *    MOVE WSS-MVO-DEBE IN WSS-VARI TO DPC-VAL-MDPE IN DPC.
      *    MOVE WSS-MVO-HABE IN WSS-VARI TO DPC-VAL-MHPE IN DPC.
      **REL MOVE WSS-VAL-TDCT IN WSS-LMC  TO DPC-VAL-SDNV IN DPC.
      *    MOVE WSS-VAL-TDE2 IN WSS-VARI TO DPC-VAL-SDNV IN DPC.
      **REL MOVE WSS-VAL-THCT IN WSS-LMC  TO DPC-VAL-SHNV IN DPC.
      *   MOVE WSS-VAL-THA2 IN WSS-VARI TO DPC-VAL-SHNV IN DPC.
      *   MOVE SPACES                   TO DPC-GLS-DIS3 IN DPC.
      *    IF EMIS-LEGAL
      *       MOVE FIO-MOD TO FIO-CMND
      *       PERFORM COL-FIO-DPC.

      *    MOVE DPC-VAL-SDNV IN DPC TO WSS-DEB-NUEV IN WSS-VARI.
      *    MOVE DPC-VAL-SHNV IN DPC TO WSS-HAB-NUEV IN WSS-VARI.
      *    MOVE DPC-VAL-SDAN IN DPC TO WSS-DEB-ANTI IN WSS-VARI.
      *    MOVE DPC-VAL-SHAN IN DPC TO WSS-HAB-ANTI IN WSS-VARI.
      *    MOVE DPC-VAL-MDPE IN DPC TO WSS-DEB-MVTO IN WSS-VARI.
      *    MOVE DPC-VAL-MHPE IN DPC TO WSS-HAB-MVTO IN WSS-VARI.
      *    DISPLAY ' '.
      *    DISPLAY 'ESTOY EN SECTION GRABA-NUEVOS-SALDOS'.
      *    DISPLAY '************************************'.
      *    DISPLAY 'GRABA-SALDOS PARA OFICINA : ' DPC-COD-OFI3 IN DPC.
      *    DISPLAY 'NUMERO DE CUENTA          : ' DPC-COD-CCTA IN DPC.
      *    DISPLAY 'SALDO ANTERIOR: ' WSS-DEB-ANTI IN WSS-VARI ' - '
      *                               WSS-HAB-ANTI IN WSS-VARI.
      *    DISPLAY 'MOVTO PERIODO : ' WSS-DEB-MVTO IN WSS-VARI ' - '
      *                               WSS-HAB-MVTO IN WSS-VARI.
      *    DISPLAY 'SALDO ACTUAL  : ' WSS-DEB-NUEV IN WSS-VARI ' - '
      *                               WSS-HAB-NUEV IN WSS-VARI.
      *RRM-FIN  27-APR-1998
       FIN-GRABA-NUEVOS-SALDOS.
           EXIT.

      ******************************************************************
       BUSCA-GLS-CTA SECTION.
      ***********************
       INI-BUSCA-GLS-CTA.
      * Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
           IF LMC-CIC-CCSB IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE LMC-CIC-CCSB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-COD-DAT3 IN TAB (10) TO WSS-TAB-DAT3
                                                IN WSS-VARI
               MOVE TAB-GLS-DESC IN TAB      TO WSS-GLS-CCSB
                                                IN WSS-LMC
           ELSE
               MOVE SPACES TO WSS-GLS-CCSB IN WSS-LMC.
       FIN-BUSCA-GLS-CTA.
           EXIT.

      ******************************************************************
       BUS-REG-CLI SECTION.
      *********************
       INI-BUS-REG-CLI.
      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE LMC-IDC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROES TO DBC-NUM-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC
                              DBC-IND-ICLI IN DBC
                              DBC-GLS-ICLI IN DBC
                              DBC-GLS-NOMC IN DBC
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
       FIN-BUS-REG-CLI.
           EXIT.

      ******************************************************************
       VE-RESETEO-CUENTA SECTION.
      ***************************
       INI-RESET-CTA.
           MOVE 'N' TO WSS-RESET-SALDOS.
           IF POS-59 = 'A' AND WSS-NUM-DREG = 01 AND WSS-NUM-MREG = 01
                MOVE 'S' TO WSS-RESET-SALDOS.
           IF POS-59 = 'M' AND WSS-NUM-DREG = 01
                MOVE 'S' TO WSS-RESET-SALDOS.
       FIN-RESET-CTA.
           EXIT.

      ******************************************************************
       COPY COLBFDPC.
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY SGCBFDBC.
       COPY SGCBGCLI.
       COPY GNSBFCIC.
       COPY GNSBBCIC.
       COPY GNSBPFEC.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
      *>>>>

