      *
      * COLBQDTT
      * Version 3.0.1 Nov-2005
      * 20-Aug-19 10:35 AM
      *
       SET-TAG-COLBQDTT SECTION.
       INI-SET-TAG-COLBQDTT.
           MOVE
           '<IDNMOD NOM=$COLBQDTT$ VSN=$06.07.25.1$ VGM=$3.0.1$
      -    'GEN=$20-Aug-19 10:35 AM$ FNC=$CNCMSV$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBQDTT.
           EXIT.
           
       PUT-ALL-DTT SECTION.
       INI-PUT-ALL-DTT.
           PERFORM PUT-DTT-DTT.
           PERFORM PUT-PTT-DTT.
       FIN-PUT-ALL-DTT.
           EXIT.
       
       PUT-DTT-DTT SECTION.
       INI-PUT-DTT-DTT.
           IF PGM-STAT-DTT-NUL
               GO TO FIN-PUT-DTT-DTT.
           IF NOT PGM-STAT-DTT-OKS
               PERFORM CLR-DTT-DTT
               GO TO FIN-PUT-DTT-DTT.
           MOVE DTT-CAI-IDTT IN DTT TO DTT-CAI-IDTT IN DTT-FLD.
           MOVE DTT-IIC-IDTT IN DTT TO DTT-IIC-IDTT IN DTT-FLD.
           MOVE DTT-NUM-IDTT IN DTT TO DTT-NUM-IDTT IN DTT-FLD.
           MOVE DTT-NUM-CODI IN DTT TO DTT-NUM-CODI IN DTT-FLD.
           MOVE DTT-NUM-LARG IN DTT TO DTT-NUM-LARG IN DTT-FLD.
      *<<<< FIN_PUT_DTT_DTT
      *BUS-TAB busca glosa de codigo en tabla
           IF DTT-NUM-CODI IN DTT-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CDF ' TO TAB-COD-TTAB IN TAB
               MOVE DTT-NUM-CODI IN DTT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-CODI IN DTT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CODI IN DTT-FLD.
      *>>>> 
       FIN-PUT-DTT-DTT.
           EXIT.
       
       PUT-PTT-DTT SECTION.
       INI-PUT-PTT-DTT.
           IF PGM-STAT-PTT-NUL
               GO TO FIN-PUT-PTT-DTT.
           IF NOT PGM-STAT-PTT-OKS
               PERFORM CLR-PTT-DTT
               GO TO FIN-PUT-PTT-DTT.
           MOVE PTT-CAI-ICVN IN PTT TO PTT-CAI-ICVN IN DTT-FLD.
           MOVE PTT-IIC-ICVN IN PTT TO PTT-IIC-ICVN IN DTT-FLD.
           MOVE PTT-COD-TIPO IN PTT TO PTT-COD-TIPO IN DTT-FLD.
           MOVE PTT-IND-SEPA IN PTT TO PTT-IND-SEPA IN DTT-FLD.
           MOVE PTT-GLS-NOMP IN PTT TO PTT-GLS-NOMP IN DTT-FLD.
       FIN-PUT-PTT-DTT.
           EXIT.
       
       KEY-ALL-DTT SECTION.
       INI-KEY-ALL-DTT.
           PERFORM KEY-DTT-DTT.
           PERFORM KEY-PTT-DTT.
       FIN-KEY-ALL-DTT.
           EXIT.
       
       KEY-DTT-DTT SECTION.
       INI-KEY-DTT-DTT.
           MOVE DTT-CAI-IDTT IN DTT-FLD TO DTT-CAI-IDTT IN DTT.
           MOVE DTT-IIC-IDTT IN DTT-FLD TO DTT-IIC-IDTT IN DTT.
           MOVE DTT-NUM-IDTT IN DTT-FLD TO DTT-NUM-IDTT IN DTT.
       FIN-KEY-DTT-DTT.
           EXIT.
       
       KEY-PTT-DTT SECTION.
       INI-KEY-PTT-DTT.
       FIN-KEY-PTT-DTT.
           EXIT.
       
       SCR-CLRA-DTT SECTION.
       INI-SCR-CLRA-DTT.
           PERFORM CLR-KEY-DTT.
           PERFORM CLR-FLD-DTT.
       FIN-SCR-CLRA-DTT.
           EXIT.
       
       CLR-KEY-DTT SECTION.
       INI-CLR-KEY-DTT.
           MOVE SPACES TO DTT-CAI-IDTT IN DTT-FLD.
           MOVE ZEROES TO DTT-IIC-IDTT IN DTT-FLD.
           MOVE ZEROES TO DTT-NUM-IDTT IN DTT-FLD.
       FIN-CLR-KEY-DTT.
           EXIT.
       
       CLR-FLD-DTT SECTION.
       INI-CLR-FLD-DTT.
           MOVE SPACES TO FRM-GLS-TIPO IN DTT-FLD.
           MOVE SPACES TO FRM-GLS-CODI IN DTT-FLD.
           PERFORM CLR-DTT-DTT.
           PERFORM CLR-PTT-DTT.
       FIN-CLR-FLD-DTT.
           EXIT.
       
       CLR-DTT-DTT SECTION.
       INI-CLR-DTT-DTT.
           MOVE ZEROES TO DTT-NUM-CODI IN DTT-FLD.
           MOVE ZEROES TO DTT-NUM-LARG IN DTT-FLD.
       FIN-CLR-DTT-DTT.
           EXIT.
       
       CLR-PTT-DTT SECTION.
       INI-CLR-PTT-DTT.
           MOVE SPACES TO PTT-CAI-ICVN IN DTT-FLD.
           MOVE ZEROES TO PTT-IIC-ICVN IN DTT-FLD.
           MOVE SPACES TO PTT-COD-TIPO IN DTT-FLD.
           MOVE SPACES TO PTT-IND-SEPA IN DTT-FLD.
           MOVE SPACES TO PTT-GLS-NOMP IN DTT-FLD.
       FIN-CLR-PTT-DTT.
           EXIT.
       
       FST-KEY-DTT SECTION.
       INI-FST-KEY-DTT.
           MOVE -1 TO DTT-CAI-IDTT-LEN IN DTT-FLD.
       FIN-FST-KEY-DTT.
           EXIT.
       
       FST-FLD-DTT SECTION.
       INI-FST-FLD-DTT.
           MOVE -1 TO DTT-NUM-CODI-LEN IN DTT-FLD.
       FIN-FST-FLD-DTT.
           EXIT.
       
       PRO-KEY-DTT SECTION.
       INI-PRO-KEY-DTT.
           PERFORM PRO-IKY-DTT.
           PERFORM PRO-AKY-DTT.
           PERFORM PRO-MKY-DTT.
       FIN-PRO-KEY-DTT.
           EXIT.
       
       PRO-IKY-DTT SECTION.
       INI-PRO-IKY-DTT.
           MOVE FRM-CPIM-AEY TO DTT-CAI-IDTT-ATR IN DTT-FLD.
           MOVE FRM-CPIM-AEY TO DTT-IIC-IDTT-ATR IN DTT-FLD.
           MOVE FRM-CPIM-AEY TO DTT-NUM-IDTT-ATR IN DTT-FLD.
       FIN-PRO-IKY-DTT.
           EXIT.
       
       PRO-MKY-DTT SECTION.
       INI-PRO-MKY-DTT.
       FIN-PRO-MKY-DTT.
           EXIT.
       
       PRO-AKY-DTT SECTION.
       INI-PRO-AKY-DTT.
       FIN-PRO-AKY-DTT.
           EXIT.
       
       UNP-KEY-DTT SECTION.
       INI-UNP-KEY-DTT.
           PERFORM UNP-IKY-DTT.
           PERFORM UNP-AKY-DTT.
           PERFORM UNP-MKY-DTT.
       FIN-UNP-KEY-DTT.
           EXIT.
       
       UNP-IKY-DTT SECTION.
       INI-UNP-IKY-DTT.
           MOVE FRM-CPIM-UBY TO DTT-CAI-IDTT-ATR.
           MOVE FRM-CPIM-UBY TO DTT-IIC-IDTT-ATR.
           MOVE FRM-CPIM-UBY TO DTT-NUM-IDTT-ATR.
       FIN-UNP-IKY-DTT.
           EXIT.
       
       UNP-MKY-DTT SECTION.
       INI-UNP-MKY-DTT.
       FIN-UNP-MKY-DTT.
           EXIT.
       
       UNP-AKY-DTT SECTION.
       INI-UNP-AKY-DTT.
       FIN-UNP-AKY-DTT.
           EXIT.
       
       UNP-FLD-DTT SECTION.
       INI-UNP-FLD-DTT.
           PERFORM UNP-DTT-DTT.
           PERFORM UNP-PTT-DTT.
       FIN-UNP-FLD-DTT.
           EXIT.
       
       UNP-DTT-DTT SECTION.
       INI-UNP-DTT-DTT.
           MOVE FRM-CPIM-UBY TO DTT-NUM-CODI-ATR IN DTT-FLD.
           MOVE FRM-CPIM-UBY TO DTT-NUM-LARG-ATR IN DTT-FLD.
      *<<<< FIN_UNP_DTT_DTT
           IF PTT-COD-TIPO IN DTT-FLD = 'S'                             
               MOVE FRM-CPIM-AEY TO DTT-NUM-LARG-ATR IN DTT-FLD.        
      *>>>>
       FIN-UNP-DTT-DTT.
           EXIT.
       
       UNP-PTT-DTT SECTION.
       INI-UNP-PTT-DTT.
       FIN-UNP-PTT-DTT.
           EXIT.
       
       VAL-KEY-DTT SECTION.
       INI-VAL-KEY-DTT.
           PERFORM VAL-IKY-DTT.
           PERFORM VAL-MKY-DTT.
           PERFORM VAL-AKY-DTT.
       FIN-VAL-KEY-DTT.
           EXIT.
       
       VAL-IKY-DTT SECTION.
       INI-VAL-IKY-DTT.
           PERFORM VAL-DTT-CAI-IDTT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DTT-CAI-IDTT-LEN IN DTT-FLD
                GO TO FIN-VAL-IKY-DTT.
           PERFORM VAL-DTT-IIC-IDTT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DTT-IIC-IDTT-LEN IN DTT-FLD
                GO TO FIN-VAL-IKY-DTT.
           PERFORM VAL-DTT-NUM-IDTT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DTT-NUM-IDTT-LEN IN DTT-FLD
                GO TO FIN-VAL-IKY-DTT.
       FIN-VAL-IKY-DTT.
           EXIT.
       
       VAL-MKY-DTT SECTION.
       INI-VAL-MKY-DTT.
       FIN-VAL-MKY-DTT.
           EXIT.
       
       VAL-AKY-DTT SECTION.
       INI-VAL-AKY-DTT.
       FIN-VAL-AKY-DTT.
           EXIT.
       
       VAL-DTT-CAI-IDTT SECTION.
       INI-VAL-DTT-CAI-IDTT.
           IF DTT-CAI-IDTT IN DTT-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DTT-CAI-IDTT.
      *<<<< FIN_VAL_DTT_CAI_IDTT
           IF DTT-CAI-IDTT IN DTT-FLD > SPACES AND                      
              DTT-CAI-IDTT IN DTT-FLD NOT = 'CPLT'                       
               MOVE 'COL'          TO MSG-COD-SIST                    
               MOVE 'CAI NO VAL'   TO MSG-COD-MENS                     
               PERFORM GET-MSG                                         
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               MOVE FRM-SUAR-MAL TO FRM-SUAR.  
      *>>>>
       FIN-VAL-DTT-CAI-IDTT.
           EXIT.
       
       VAL-DTT-IIC-IDTT SECTION.
       INI-VAL-DTT-IIC-IDTT.
           IF DTT-IIC-IDTT IN DTT-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DTT-IIC-IDTT.
       FIN-VAL-DTT-IIC-IDTT.
           EXIT.
       
       VAL-DTT-NUM-IDTT SECTION.
       INI-VAL-DTT-NUM-IDTT.
           IF DTT-NUM-IDTT IN DTT-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DTT-NUM-IDTT.
       FIN-VAL-DTT-NUM-IDTT.
           EXIT.
       
       VAL-CON-KEY-DTT SECTION.
       INI-VAL-CON-KEY-DTT.
           IF     DTT-CAI-IDTT IN DTT-FLD NOT > SPACES 
              AND DTT-IIC-IDTT IN DTT-FLD NOT > ZEROES 
              AND DTT-NUM-IDTT IN DTT-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-DTT.
       FIN-VAL-CON-KEY-DTT.
           EXIT.
       
       VAL-CON-IKY-DTT SECTION.
       INI-VAL-CON-IKY-DTT.
           IF     DTT-CAI-IDTT IN DTT-FLD NOT > SPACES 
              AND DTT-IIC-IDTT IN DTT-FLD NOT > ZEROES 
              AND DTT-NUM-IDTT IN DTT-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-DTT.
       FIN-VAL-CON-IKY-DTT.
           EXIT.
       
       VAL-NUM-KEY-DTT SECTION.
       INI-VAL-NUM-KEY-DTT.
           PERFORM VAL-NUM-IKY-DTT.
           PERFORM VAL-NUM-MKY-DTT.
           PERFORM VAL-NUM-AKY-DTT.
       FIN-VAL-NUM-KEY-DTT.
           EXIT.
       
       VAL-NUM-IKY-DTT SECTION.
       INI-VAL-NUM-IKY-DTT.
       VAL-NUM-DTT-IIC-IDTT.
           MOVE DTT-IIC-IDTT-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DTT-IIC-IDTT IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DTT-IIC-IDTT-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-IKY-DTT.
       VAL-NUM-DTT-NUM-IDTT.
           MOVE DTT-NUM-IDTT-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DTT-NUM-IDTT IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DTT-NUM-IDTT-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-IKY-DTT.
       FIN-VAL-NUM-IKY-DTT.
           EXIT.
       
       VAL-NUM-MKY-DTT SECTION.
       INI-VAL-NUM-MKY-DTT.
       FIN-VAL-NUM-MKY-DTT.
           EXIT.
       
       VAL-NUM-AKY-DTT SECTION.
       INI-VAL-NUM-AKY-DTT.
       FIN-VAL-NUM-AKY-DTT.
           EXIT.
       
       VAL-NUM-FLD-DTT SECTION.
       INI-VAL-NUM-FLD-DTT.
       VAL-NUM-PTT-IIC-ICVN.
           MOVE PTT-IIC-ICVN-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PTT-IIC-ICVN IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PTT-IIC-ICVN-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-FLD-DTT.
       VAL-NUM-DTT-NUM-CODI.
           MOVE DTT-NUM-CODI-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DTT-NUM-CODI IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DTT-NUM-CODI-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-FLD-DTT.
       VAL-NUM-DTT-NUM-LARG.
           MOVE DTT-NUM-LARG-ALF IN DTT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DTT-NUM-LARG IN DTT-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DTT-NUM-LARG-LEN IN DTT-FLD
                GO TO FIN-VAL-NUM-FLD-DTT.
       FIN-VAL-NUM-FLD-DTT.
           EXIT.
       
       EDT-KEY-DTT SECTION.
       INI-EDT-KEY-DTT.
           PERFORM EDT-IKY-DTT.
           PERFORM EDT-MKY-DTT.
           PERFORM EDT-AKY-DTT.
       FIN-EDT-KEY-DTT.
           EXIT.
       
       EDT-IKY-DTT SECTION.
       INI-EDT-IKY-DTT.
           IF DTT-IIC-IDTT-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DTT-IIC-IDTT-LEN IN DTT-FLD
                GO TO FIN-EDT-IKY-DTT.
           MOVE DTT-IIC-IDTT IN DTT-FLD TO DTT-IIC-IDTT-EDT IN DTT-EDT.
           MOVE DTT-IIC-IDTT-EDT IN DTT-EDT TO 
                DTT-IIC-IDTT-ALF IN DTT-FLD.
           IF DTT-NUM-IDTT-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DTT-NUM-IDTT-LEN IN DTT-FLD
                GO TO FIN-EDT-IKY-DTT.
           MOVE DTT-NUM-IDTT IN DTT-FLD TO DTT-NUM-IDTT-EDT IN DTT-EDT.
           MOVE DTT-NUM-IDTT-EDT IN DTT-EDT TO 
                DTT-NUM-IDTT-ALF IN DTT-FLD.
       FIN-EDT-IKY-DTT.
           EXIT.
       
       EDT-MKY-DTT SECTION.
       INI-EDT-MKY-DTT.
       FIN-EDT-MKY-DTT.
           EXIT.
       
       EDT-AKY-DTT SECTION.
       INI-EDT-AKY-DTT.
       FIN-EDT-AKY-DTT.
           EXIT.
       
       EDT-FLD-DTT SECTION.
       INI-EDT-FLD-DTT.
           IF PTT-IIC-ICVN-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PTT-IIC-ICVN-LEN IN DTT-FLD
                GO TO FIN-EDT-FLD-DTT.
           MOVE PTT-IIC-ICVN IN DTT-FLD TO PTT-IIC-ICVN-EDT IN DTT-EDT.
           MOVE PTT-IIC-ICVN-EDT IN DTT-EDT TO 
                PTT-IIC-ICVN-ALF IN DTT-FLD.
           IF DTT-NUM-CODI-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DTT-NUM-CODI-LEN IN DTT-FLD
                GO TO FIN-EDT-FLD-DTT.
           MOVE DTT-NUM-CODI IN DTT-FLD TO DTT-NUM-CODI-EDT IN DTT-EDT.
           MOVE DTT-NUM-CODI-EDT IN DTT-EDT TO 
                DTT-NUM-CODI-ALF IN DTT-FLD.
           IF DTT-NUM-LARG-LEN IN DTT-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DTT-NUM-LARG-LEN IN DTT-FLD
                GO TO FIN-EDT-FLD-DTT.
           MOVE DTT-NUM-LARG IN DTT-FLD TO DTT-NUM-LARG-EDT IN DTT-EDT.
           MOVE DTT-NUM-LARG-EDT IN DTT-EDT TO 
                DTT-NUM-LARG-ALF IN DTT-FLD.
       FIN-EDT-FLD-DTT.
           EXIT.
