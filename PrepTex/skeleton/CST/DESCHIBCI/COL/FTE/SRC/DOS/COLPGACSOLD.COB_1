       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGACS.
       AUTHOR.          CONSIST.
      * Programa Generador de Archivo CRS.
       ENVIRONMENT DIVISION.
      *====================
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
      *<<<< WSS
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY GNSBRCIC.
       COPY TABBRCAM.
       COPY TABBROFI.
       COPY COLBRTOC.
       COPY COLBROPC.
       COPY COLBRCAN.
       COPY COLBRRCE.
       COPY COLBRICG.
       COPY COLBRVEN.
       COPY COLBRRCV.
       COPY COLBRDLC.
       COPY COLBRCRS.
       COPY COLBRRDC.
       COPY COLBREVC.
       COPY COLWGMUF.
       COPY COLWGVEN.
       COPY GNSWGPES.
       COPY GNSWGINT.
       COPY GNSWGCVI.
       COPY SGCBRDBC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGIFD.
       COPY GNSWGBCD.
       COPY GNSWGCIC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       01  WSS-VARI.
           03  WSS-IND-SELE                       PIC X(01).
           03  WSS-KEY-SAFE.
               05  WSS-COD-TOPC                   PIC X(01).
               05  WSS-ICA-IOPC                   PIC 9(08).
               05  WSS-NUM-IDLC                   PIC 9(03).
           03  WSS-NUM-IDLC                       PIC 9(03).
           03  WSS-COD-OFIC          VALUE SPACES PIC X(03).
           03  WSS-GLS-DAT3.
               05 FILLER                          PIC X(12).
               05 WSS-IND-TCRE                    PIC X(02).
               05 FILLER                          PIC X(16).
           03  WSS-KEY-IEVC                       PIC X(15).
           03  WSS-FEC-FPVC VALUE ZEROES.
               05  WSS-NUM-SPVC                   PIC 9(02).
               05  WSS-NUM-APVC                   PIC 9(02).
               05  WSS-NUM-MPVC                   PIC 9(02).
               05  WSS-NUM-DPVC                   PIC 9(02).
           03  WSS-FEC-FIMV VALUE ZEROES.
               05  WSS-NUM-SIMV                   PIC 9(02).
               05  WSS-NUM-AIMV                   PIC 9(02).
               05  WSS-NUM-MIMV                   PIC 9(02).
               05  WSS-NUM-DIMV                   PIC 9(02).
           03 WSS-COD-PESO                        PIC X(06).
           03 WSS-COD-UFES                        PIC X(06).
           03 WSS-FEC-FINI.
              05 WSS-NUM-DINI                     PIC 9(02).
              05 WSS-NUM-MINI                     PIC 9(02).
              05 WSS-NUM-SINI                     PIC 9(02).
              05 WSS-NUM-AINI                     PIC 9(02).
           03 WSS-FEC-FTER.
              05 WSS-NUM-DTER                     PIC 9(02).
              05 WSS-NUM-MTER                     PIC 9(02).
              05 WSS-NUM-STER                     PIC 9(02).
              05 WSS-NUM-ATER                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-FEC-FFET.
              05 WSS-NUM-SFET                     PIC 9(02).
              05 WSS-NUM-AFET                     PIC 9(02).
              05 WSS-NUM-MFET                     PIC 9(02).
              05 WSS-NUM-DFET                     PIC 9(02).
           03 WSS-FEC-FREG.
              05 WSS-NUM-SREG                     PIC 9(02).
              05 WSS-NUM-AREG                     PIC 9(02).
              05 WSS-NUM-MREG                     PIC 9(02).
              05 WSS-NUM-DREG                     PIC 9(02).
           03 WSS-IND-COPR                        PIC X(01).
           03 WSS-IND-VALI                        PIC X(01).
           03 WSS-IND-PROC                        PIC 9(01).
           03 WSS-IND-NEXT                        PIC 9(01).
           03 WSS-CIC-IOPC.
              05 WSS-CAI-IOPC                     PIC X(04).
              05 WSS-IIC-IOPC                     PIC X(08).
           03 WSS-CIC-OPER.
              05 WSS-CAI-OPER                     PIC X(04).
              05 WSS-IIC-OPER                     PIC X(08).
           03 WSS-CAI-ICIC                        PIC X(04).
           03 WSS-NUM-IVCT                        PIC 9(03).
           03 WSS-IND-ROPC           VALUE 0      PIC 9(05).
           03 WSS-IND-RCAN           VALUE 0      PIC 9(05).
           03 WSS-IND-RPRO           VALUE 0      PIC 9(05).
           03 WSS-IND-RBAD           VALUE 0      PIC 9(05).
           03 WSS-IND-RPUT           VALUE 0      PIC 9(05).
           03 WSS-IND-RUPD           VALUE 0      PIC 9(05).
           03 WSS-IND-RDEL           VALUE 0      PIC 9(05).
           03 WSS-IND-RERR           VALUE 0      PIC 9(05).
           03 WSS-I                  VALUE 0      PIC 9(02).
           03 WSS-AUX                COMP         PIC 9(02).
           03 WSS-AUX-DLIM.
              05  WSS-AUX-DLI1                    PIC X(01).
              05  WSS-AUX-DLI2                    PIC X(01).
       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPGACS' TO FIO-PROG.
           PERFORM BUS-FSIS.
           PERFORM OPEN-FILE.
           PERFORM PARAM-CRS.
           PERFORM LUP-REG-CRS.
           PERFORM CLOSE-FILE.
       FIN-MAIN.
       COPY GNSBGGBK.
       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCE.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-RDC.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-CRS.
       FIN-OPEN-FILE.
           EXIT.
       PARAM-CRS SECTION.
      *-----------------
       INI-PARAM-CRS.
      * Rutina para Capturar y Validar Parametros de Rango de Fechas
           DISPLAY 'Inicio de Captura de Parametros'.
      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
      *     DISPLAY 'FECHA DE TERMINO ( DDMMAAAA ) : '
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *Captura Oficina del credito
           DISPLAY 'OFICINA : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.
      *Captura Centro asignacion Operacion.
           DISPLAY 'CENTRO ASIGNACION : '.
           ACCEPT  WSS-CAI-OPER IN WSS-VARI.
           DISPLAY WSS-CAI-OPER IN WSS-VARI.
      *Captura Identificacion Operacion.
           DISPLAY 'IDENTIFICACION OPERACION : '.
           ACCEPT  WSS-IIC-OPER IN WSS-VARI.
           DISPLAY WSS-IIC-OPER IN WSS-VARI.
           DISPLAY 'Fin    de Captura    de Parametros'.
           DISPLAY 'Inicio de Validacion de Parametros'.
           IF ( WSS-COD-OFIC IN WSS-VARI > SPACES OR
              WSS-FEC-FINI IN WSS-VARI > SPACES OR
              WSS-FEC-FTER IN WSS-VARI > SPACES ) AND
              ( WSS-CAI-OPER IN WSS-VARI > SPACES OR
              WSS-IIC-OPER IN WSS-VARI > SPACES )
               DISPLAY ' COMBINACION DE PARAMETROS INVALIDA'
               PERFORM GNS-PRO-END.
           IF WSS-CIC-OPER IN WSS-VARI > SPACES
               MOVE 'O' TO WSS-IND-SELE IN WSS-VARI
               GO TO NO-VAL-FEC.
           MOVE 'F' TO WSS-IND-SELE IN WSS-VARI.
      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.
      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.
      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               PERFORM GNS-PRO-END.
           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AFEC IN WSS-VARI.
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DFET IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MFET IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-SFET IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-AFET IN WSS-VARI.
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY MSG-GLS-MENS
                   PERFORM GNS-PRO-END.
       NO-VAL-FEC.
           DISPLAY 'Fin de Validacion de Parametros'.
       FIN-PARAM-CRS.
           EXIT.
       LUP-REG-CRS SECTION.
      *-------------------
       INI-LUP-OPC-CRS.
      * Programacion de Ciclo para Registro OPC
           IF WSS-IND-SELE IN WSS-VARI = 'F'
               MOVE WSS-FEC-FFEC IN WSS-VARI TO OPC-FEC-FCOL IN OPC
               MOVE 'OPC-FEC-FCOL'           TO FIO-AKEY
               MOVE FIO-GET-NLS              TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS OR
                  OPC-FEC-FCOL IN OPC > WSS-FEC-FFET IN WSS-VARI
                   DISPLAY 'NO HAY REGISTROS OPC ENTRE : '
                       WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
                   GO TO INI-LUP-CAN-CRS.
           IF WSS-IND-SELE IN WSS-VARI = 'O'
               MOVE WSS-CIC-OPER IN WSS-VARI TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE REGISTRO OPC : '
                            WSS-CIC-OPER IN WSS-VARI
                   GO TO FIN-LUP-REG-CRS.
           MOVE 1 TO WSS-IND-PROC IN WSS-VARI.
       LUP-OPC-CRS.
      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           IF NOT FIO-STAT-OKS
               GO TO INI-LUP-CAN-CRS.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF NOT  FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               GO TO NXT-OPC-CRS.
           MOVE TAB-COD-CTAB TO WSS-COD-PESO IN WSS-VARI.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0998  '       TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF NOT  FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               GO TO NXT-OPC-CRS.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UFES IN WSS-VARI.
           IF OPC-MSC-STAT IN OPC NOT = 'A'  OR
              ( OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI AND
              OPC-COD-VCOC IN OPC NOT = WSS-COD-UFES IN WSS-VARI )
               GO TO NXT-OPC-CRS.
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO NXT-OPC-CRS.
           IF OPC-COD-TOPC IN OPC > SPACES
               IF OPC-COD-TOPC NOT NUMERIC AND
                  OPC-COD-TOPC IN OPC NOT = 'D'
                   GO TO NXT-OPC-CRS.
           IF WSS-COD-OFIC IN WSS-VARI     > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFIC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO NXT-OPC-CRS.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF MSC-CIC-CMSC IN MSC = 'D'
               PERFORM PRO-DLC
               GO TO NXT-OPC-CRS
           ELSE
               MOVE 1  TO WSS-IND-PROC IN WSS-VARI.
           PERFORM SEL-REG-PRO.
           ADD  1  TO WSS-IND-ROPC IN WSS-VARI.
           PERFORM BUS-REG-CRS.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-OPC-CRS.
           PERFORM GEN-REG-CRS.
           IF NOT FIO-STAT-OKS
               PERFORM INI-REG-CRS
               PERFORM PUT-REG-CRS
           ELSE
               IF WSS-IND-SELE IN WSS-VARI = 'O'
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND
                   PERFORM COL-FIO-CRS
                   PERFORM GEN-MOD-REG-CRS
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-CRS.
       NXT-OPC-CRS.
           IF WSS-IND-SELE IN WSS-VARI = 'O'
               GO TO INI-LUP-CAN-CRS.
           MOVE 'OPC-FEC-FCOL' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF ( NOT FIO-STAT-OKS ) OR
              OPC-FEC-FCOL IN OPC > WSS-FEC-FFET IN WSS-VARI
               GO TO INI-LUP-CAN-CRS.
           GO TO LUP-OPC-CRS.
       INI-LUP-CAN-CRS.
      * Programacion de Ciclo para Registro CAN
           IF WSS-IND-SELE IN WSS-VARI = 'F'
               MOVE WSS-FEC-FFEC IN WSS-VARI TO CAN-FEC-FCAN IN CAN
               MOVE 'CAN-FEC-FCAN'           TO FIO-AKEY
               MOVE FIO-GET-NLS              TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF NOT FIO-STAT-OKS OR
                  CAN-FEC-FCAN IN CAN > WSS-FEC-FFET IN WSS-VARI
                   DISPLAY 'NO HAY REGISTROS CAN ENTRE : '
                       WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
                   GO TO INI-LUP-PGS-CRS.
           IF WSS-IND-SELE IN WSS-VARI = 'O'
               MOVE WSS-CIC-OPER IN WSS-VARI TO CAN-CIC-IOPC IN CAN
               MOVE FIO-GET-NLS              TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF NOT FIO-STAT-OKS OR
                  CAN-CIC-IOPC IN CAN NOT = WSS-CIC-OPER IN WSS-VARI
                   DISPLAY 'NO HAY REGISTROS CAN PARA : '
                       WSS-CIC-OPER IN WSS-VARI
                   GO TO INI-LUP-PGS-CRS.
           MOVE 2 TO WSS-IND-PROC IN WSS-VARI.
       LUP-CAN-CRS.
      * Proceso de Seleccion y Clasificacion a Partir del Registro CAN
           IF NOT FIO-STAT-OKS
               GO TO INI-LUP-PGS-CRS.
           IF CAN-MSC-STAT IN CAN NOT = 'A'
               GO TO NXT-CAN-CRS.
           PERFORM SEL-REG-PRO.
           ADD  1  TO WSS-IND-RCAN IN WSS-VARI.
           PERFORM BUS-REG-CRS.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-CAN-CRS.
           PERFORM GEN-REG-CRS.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPCOCANRCENX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RCE-CIC-IOPC IN RCE
               GO TO NXT-CAN-CRS.
           PERFORM VAL-REG-CRS.
           IF WSS-IND-VALI IN WSS-VARI = 'S'
               PERFORM BUS-REG-VEN
               IF FIO-STAT-OKS
                   PERFORM UPD-REG-CRS
               ELSE
                   PERFORM DEL-REG-CRS.
       NXT-CAN-CRS.
           IF WSS-IND-SELE IN WSS-VARI = 'F'
               MOVE 'CAN-FEC-FCAN' TO FIO-AKEY
               MOVE FIO-GET-NXT    TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF ( NOT FIO-STAT-OKS ) OR
                  CAN-FEC-FCAN IN CAN > WSS-FEC-FFET IN WSS-VARI
                   GO TO INI-LUP-PGS-CRS.
           IF WSS-IND-SELE IN WSS-VARI = 'O'
               MOVE FIO-GET-NXT    TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF ( NOT FIO-STAT-OKS ) OR
                  CAN-CIC-IOPC IN CAN NOT = WSS-CIC-OPER IN WSS-VARI
                   GO TO INI-LUP-PGS-CRS.
           GO TO LUP-CAN-CRS.
       INI-LUP-PGS-CRS.
           MOVE 'PGS' TO VEN-IND-SCTB IN VEN.
           MOVE 'VEN-IND-SCTB'  TO FIO-AKEY.
           MOVE FIO-GET-NLS     TO FIO-CMND.
       LOOP-LUP-PGS-CRS.
           PERFORM COL-FIO-VEN.
           IF NOT( FIO-STAT-OKS AND
              VEN-IND-SCTB IN VEN = 'PGS' )
               GO TO FIN-LUP-REG-CRS.
           MOVE ADR-VEN-REQA TO ADR-AUX-REQA.
           PERFORM PRO-CRS-VEN.
           IF MSG-COD-MENS > SPACES
               GO TO NXT-LUP-PGS-CRS.
           MOVE BCD-DAT6-EBCD IN BCD-VARI TO BCD-DAT6-INT IN BCD-VARI.
           MOVE BCD-DAT6 IN BCD-VARI      TO CRS-KEY-ICRS IN CRS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CRS.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'VENPGSCRSNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               GO TO NXT-LUP-PGS-CRS.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               GO TO NXT-LUP-PGS-CRS.
           MOVE SPACES  TO VEN-IND-SCTB IN VEN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
       NXT-LUP-PGS-CRS.
           MOVE ADR-AUX-REQA    TO ADR-VEN-REQA.
           MOVE FIO-KDEF-S      TO FIO-KDEF.
           MOVE 'VEN-IND-SCTB'  TO FIO-AKEY.
           MOVE FIO-GET-NXT     TO FIO-CMND.
           GO TO LOOP-LUP-PGS-CRS.
       FIN-LUP-REG-CRS.
           EXIT.
       PRO-CRS-VEN SECTION.
       INI-PRO-CRS-VEN.
           MOVE SPACES              TO MSG-COD-MENS.
           MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'VEN    OPCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
               GO TO FIN-PRO-CRS-VEN.
           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE VEN-VAL-SFIN IN VEN TO CRS-VAL-VENP IN CRS
           ELSE
               MOVE VEN-VAL-SFIN IN VEN TO CRS-VAL-VENO IN CRS.
           MOVE VEN-VAL-SCAP IN VEN TO CRS-VAL-SCAP IN CRS.
           MOVE VEN-NUM-IVEN IN VEN TO CRS-NUM-IVEN IN CRS.
           MOVE VEN-NUM-AVEN IN VEN TO CRS-NUM-AVEN IN CRS.
           MOVE VEN-NUM-MVEN IN VEN TO CRS-NUM-MVEN IN CRS.
           MOVE VEN-NUM-DVEN IN VEN TO CRS-NUM-DVEN IN CRS.
           MOVE VEN-NUM-AIMV IN VEN TO CRS-NUM-AIMV IN CRS.
           MOVE VEN-NUM-MIMV IN VEN TO CRS-NUM-MIMV IN CRS.
           MOVE VEN-NUM-DIMV IN VEN TO CRS-NUM-DIMV IN CRS.
           IF OPC-COD-VCOC IN OPC = WSS-COD-UFES IN WSS-VARI
               MOVE CRS-VAL-VENO IN CRS TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-VENO IN CRS
               MOVE CRS-VAL-SCAP IN CRS TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-SCAP IN CRS.
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   DLC-KEY-IDLC IN DLC
               GO TO FIN-PRO-CRS-VEN.
           IF OPC-MSC-TTRN IN OPC NOT = 'C'
               MOVE DLC-KEY-IDLC IN DLC TO BCD-DAT6-EBCD IN BCD-VARI
           ELSE
               MOVE DLC-CIC-IOPC IN DLC TO RCE-CIC-IOPC IN RCE
               MOVE DLC-NUM-IDLC IN DLC TO RCE-NUM-IDLC IN RCE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RCE
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE ENTIDAD RCE PARA : ' DLC-CIC-IOPC
                                                                 IN DLC
               ELSE
                   MOVE RCE-KEY-SAFE IN RCE TO BCD-DAT6-EBCD
                                                 IN BCD-VARI.
       FIN-PRO-CRS-VEN.
           EXIT.
       CLOSE-FILE SECTION.
      *------------------
       INI-CLOSE-FILE.
      *     DISPLAY 'REGISTROS OPC LEIDOS  : ' WSS-IND-ROPC IN WSS-VARI.
      *     DISPLAY 'REGISTROS CAN LEIDOS  : ' WSS-IND-RCAN IN WSS-VARI.
      *     DISPLAY 'REGISTROS PROCESADOS  : ' WSS-IND-RPRO IN WSS-VARI.
      *     DISPLAY 'REGISTROS RECHAZADOS  : ' WSS-IND-RBAD IN WSS-VARI.
      *     DISPLAY 'REGISTROS GRABADOS    : ' WSS-IND-RPUT IN WSS-VARI.
      *     DISPLAY 'REGISTROS MODIFICADOS : ' WSS-IND-RUPD IN WSS-VARI.
      *     DISPLAY 'REGISTROS ELIMINADOS  : ' WSS-IND-RDEL IN WSS-VARI.
      *     DISPLAY 'REGISTROS ERRONEOS    : ' WSS-IND-RERR IN WSS-VARI.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCE.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-RDC.
           PERFORM SGC-FIO-DBC.
           PERFORM COL-FIO-CRS.
       FIN-CLOSE-FILE.
           EXIT.
      * Seleccion del Registro para Proceso por Indicador Colocacion Operativa
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           IF WSS-IND-PROC IN WSS-VARI = 1
               MOVE        1            TO WSS-IND-NEXT IN WSS-VARI
               MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI
           ELSE
               IF WSS-IND-PROC IN WSS-VARI = 2
                   MOVE        2            TO WSS-IND-NEXT IN WSS-VARI
                   MOVE CAN-CIC-IOPC IN CAN TO WSS-CIC-IOPC IN WSS-VARI.
      *     MOVE WSS-CAI-IOPC IN WSS-VARI TO WSS-CAI-ICIC IN WSS-VARI.
      *     MOVE ZEROES TO WSS-CAI-IOPC IN WSS-VARI.
      * Busca Creditos SAFE por Claves Externas
      *     MOVE WSS-CIC-IOPC IN WSS-VARI  TO BCD-DAT6-EBCD IN BCD-VARI.
      *     MOVE BCD-DAT6-EBCD IN BCD-VARI TO BCD-DAT6-INT IN BCD-VARI.
      *     MOVE BCD-DAT6 IN BCD-VARI      TO CRS-KEY-ICRS IN CRS.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM COL-FIO-CRS.
      *     MOVE WSS-CAI-ICIC IN WSS-VARI TO WSS-CAI-IOPC IN WSS-VARI.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      * Proceso de Lectura de Varios Registros para Formacion del Registro CRS
       BUS-REG-CRS SECTION.
       INI-BUS-REG-CRS.
           ADD 1 TO WSS-IND-RPRO IN WSS-VARI.
           IF WSS-IND-PROC IN WSS-VARI = 1
               MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI
               IF OPC-IND-VSTR IN OPC NOT = 'S'
                   MOVE OPC-NUM-IVEN IN OPC TO WSS-NUM-IVCT IN WSS-VARI
               ELSE
                   MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
                   MOVE ZEROES TO VEN-NUM-IVEN IN VEN
                   MOVE FIO-GET-NLS TO FIO-CMND
                   PERFORM COL-FIO-VEN
                   IF NOT (FIO-STAT-OKS AND
                      OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
                       MOVE 1 TO WSS-IND-NEXT IN WSS-VARI
                       GO TO FIN-BUS-REG-CRS
                   ELSE
                       MOVE VEN-NUM-IVCT IN VEN TO WSS-NUM-IVCT
                                                    IN WSS-VARI
           ELSE
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               PERFORM BUS-REG-OPC.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO FIN-BUS-REG-CRS.
           PERFORM BUS-REG-ICG.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO FIN-BUS-REG-CRS.
           PERFORM BUS-RDC-DBC.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO FIN-BUS-REG-CRS.
           PERFORM BUS-REG-VEN.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO FIN-BUS-REG-CRS.
       FIN-BUS-REG-CRS.
           EXIT.
       BUS-REG-OPC SECTION.
       INI-BUS-REG-OPC.
      * Busca Operacion de Credito Mediante una Cancelacion Determinada
           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CAN    OPCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               GO TO FIN-BUS-REG-OPC.
           IF OPC-IND-VSTR IN OPC = 'S'
               GO TO BUS-REG-OPC-VSTR.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CAN    VENNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               GO TO FIN-BUS-REG-OPC.
           MOVE OPC-NUM-IVEN TO WSS-NUM-IVCT IN WSS-VARI.
           IF VEN-VAL-SFIN IN VEN NOT > ZEROES
               ADD 1 TO WSS-NUM-IVCT IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI.
           GO TO FIN-BUS-REG-OPC.
       BUS-REG-OPC-VSTR.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CAN    VENNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               GO TO FIN-BUS-REG-OPC.
           MOVE VEN-NUM-IVCT IN VEN TO WSS-NUM-IVCT IN WSS-VARI.
           IF VEN-VAL-SFIN IN VEN NOT > ZEROES
               ADD 1 TO WSS-NUM-IVCT IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI.
       FIN-BUS-REG-OPC.
           EXIT.
      * Obtiene Tasa de Interes al Leer ICG mediante Llave KEY-IICG Formada
       BUS-REG-ICG SECTION.
       INI-BUS-REG-ICG.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
      * Forma Llave KEY-IICG para Leer ICG y Obtener Tasa de Interes
           MOVE SPACES      TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES      TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'       TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES      TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           IF WSS-IND-PROC IN WSS-VARI = 1
               MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG
               MOVE ZEROES              TO ICG-NUM-ICAN IN ICG
               PERFORM COL-FIO-ICG
               IF NOT ( FIO-STAT-OKS AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
                   MOVE '23' TO FIO-STAT
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE CAN-KEY-ICAN IN CAN TO ICG-KEY-ICAN IN ICG
               PERFORM COL-FIO-ICG
               IF NOT ( FIO-STAT-OKS AND
                    ICG-KEY-ICAN IN ICG = CAN-KEY-ICAN IN CAN AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
                   MOVE '23' TO FIO-STAT.
           IF NOT FIO-STAT-OKS
               MOVE    1   TO WSS-IND-NEXT IN WSS-VARI
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               GO TO FIN-BUS-REG-ICG.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG.
       FIN-BUS-REG-ICG.
           EXIT.
      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro RDC
       BUS-RDC-DBC SECTION.
       INI-BUS-RDC-DBC.
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.
      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en RDC
      * RDC-NUM-IDLC = 0 ====> DEU.DIR.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RDC-KEY-IDLC IN RDC
               MOVE SPACES TO DBC-IDC-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC
               MOVE '00' TO FIO-STAT
               GO TO FIN-BUS-RDC-DBC.
      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-IDC-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC
               GO TO FIN-BUS-RDC-DBC.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-BUS-RDC-DBC.
           EXIT.
       BUS-REG-VEN SECTION.
       INI-BUS-REG-VEN.
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.
           IF WSS-IND-PROC IN WSS-VARI = 2
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
           IF OPC-IND-VSTR IN OPC = 'S'
               GO TO BUS-REG-EVC.
      * Busca Operaciones de Creditos Mediante Vencimientos
           MOVE WSS-CIC-IOPC IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVCT IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPCORCVVENNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   VEN-KEY-IVEN IN VEN
               GO TO FIN-BUS-REG-VEN.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
           GO TO FIN-BUS-REG-VEN.
       BUS-REG-EVC.
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVCT IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-OBT-VEN.
           IF NOT VEN-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPCORCVVENNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   VEN-KEY-IVEN IN VEN
               GO TO FIN-BUS-REG-VEN.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-BUS-REG-VEN.
           EXIT.
      * Formacion del Registro CRS al Procesar Varios Registros
       GEN-REG-CRS SECTION.
       INI-GEN-REG-CRS.
           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE VEN-VAL-SFIN IN VEN TO CRS-VAL-VENP IN CRS
           ELSE
               MOVE VEN-VAL-SFIN IN VEN TO CRS-VAL-VENO IN CRS.
           MOVE VEN-VAL-SCAP IN VEN TO CRS-VAL-SCAP IN CRS.
           MOVE VEN-NUM-IVEN IN VEN TO CRS-NUM-IVEN IN CRS.
           MOVE VEN-NUM-AVEN IN VEN TO CRS-NUM-AVEN IN CRS.
           MOVE VEN-NUM-MVEN IN VEN TO CRS-NUM-MVEN IN CRS.
           MOVE VEN-NUM-DVEN IN VEN TO CRS-NUM-DVEN IN CRS.
           MOVE VEN-NUM-AIMV IN VEN TO CRS-NUM-AIMV IN CRS.
           MOVE VEN-NUM-MIMV IN VEN TO CRS-NUM-MIMV IN CRS.
           MOVE VEN-NUM-DIMV IN VEN TO CRS-NUM-DIMV IN CRS.
           MOVE OPC-COD-OFOC IN OPC TO CRS-COD-OFOC IN CRS.
           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE '01' TO CRS-COD-MONS IN CRS
           ELSE
               MOVE '98' TO CRS-COD-MONS IN CRS.
      *
           MOVE OPC-COD-COOC IN OPC TO CRS-COD-AUXI IN CRS.
           IF OPC-COD-COOC IN OPC > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DAT3 TO WSS-GLS-DAT3 IN WSS-VARI
               MOVE WSS-IND-TCRE IN WSS-VARI TO CRS-IND-TCRE IN CRS
           ELSE
               MOVE SPACES TO CRS-IND-TCRE IN CRS.
           MOVE OPC-NUM-ACOL IN OPC TO CRS-NUM-ACOL IN CRS.
           MOVE OPC-NUM-MCOL IN OPC TO CRS-NUM-MCOL IN CRS.
           MOVE OPC-NUM-DCOL IN OPC TO CRS-NUM-DCOL IN CRS.
           MOVE ICG-SGV-TINT IN ICG TO CRS-VAL-TASA IN CRS.
           MOVE DBC-IDC-ICLI IN DBC TO CRS-IDC-IDEU IN CRS.
           MOVE DBC-VRF-ICLI IN DBC TO CRS-VRF-IDEU IN CRS.
           MOVE OPC-CIC-IOPC IN OPC TO CRS-KEY-IOPC IN CRS.
           MOVE '2' TO CRS-IND-TSIS IN CRS.
           IF OPC-COD-TOPC IN OPC > SPACES
               IF OPC-COD-TOPC NOT NUMERIC
                   MOVE '1' TO CRS-IND-TSIS IN CRS.
      * Busca Plazo de Documento Legal de Operacion de Credito con VEN-NUM-IDLC
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   DLC-KEY-IDLC IN DLC
               MOVE SPACES TO DLC-COD-PLZO IN DLC
               MOVE SPACES TO CRS-IND-PLZO IN CRS
               MOVE ZEROES TO DLC-VAL-SDLC IN DLC
               MOVE ZEROES TO CRS-VAL-SDLC IN CRS
               GO TO FIN-GEN-REG-CRS.
      *BUS-TAB busca glosa de codigo en tabla
           IF DLC-COD-PLZO IN DLC > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'PZO' TO TAB-COD-TTAB IN TAB
               MOVE DLC-COD-PLZO IN DLC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-COD-DAT1(1) TO CRS-IND-PLZO IN CRS
           ELSE
               MOVE SPACES TO CRS-IND-PLZO IN CRS.
           MOVE DLC-VAL-SDLC IN DLC TO CRS-VAL-SDLC IN CRS.
           IF OPC-COD-VCOC IN OPC = WSS-COD-UFES IN WSS-VARI
               MOVE CRS-VAL-VENO IN CRS TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-VENO IN CRS
               MOVE CRS-VAL-SCAP IN CRS TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-SCAP IN CRS
               MOVE CRS-VAL-SDLC IN CRS TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-SDLC IN CRS.
           IF OPC-MSC-TTRN IN OPC NOT = 'C'
               MOVE DLC-KEY-IDLC IN DLC TO BCD-DAT6-EBCD IN BCD-VARI
           ELSE
               MOVE DLC-CIC-IOPC IN DLC TO RCE-CIC-IOPC IN RCE
               MOVE DLC-NUM-IDLC IN DLC TO RCE-NUM-IDLC IN RCE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RCE
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE ENTIDAD RCE PARA : ' DLC-CIC-IOPC
                                                                 IN DLC
               ELSE
                   MOVE RCE-KEY-SAFE IN RCE TO BCD-DAT6-EBCD
                                                 IN BCD-VARI.
           MOVE BCD-DAT6-EBCD IN BCD-VARI TO BCD-DAT6-INT IN BCD-VARI.
           MOVE BCD-DAT6 IN BCD-VARI      TO CRS-KEY-ICRS IN CRS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CRS.
       FIN-GEN-REG-CRS.
           EXIT.
      * Genera un Registro CRS
       PUT-REG-CRS SECTION.
       INI-PUT-REG-CRS.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-CRS.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CRS    NOPUT' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'REGISTRO CRS : ' CRS
               ADD 1 TO WSS-IND-RERR IN WSS-VARI
           ELSE
               ADD 1 TO WSS-IND-RPUT IN WSS-VARI.
       FIN-PUT-REG-CRS.
           EXIT.
      * Modifica un Registro CRS
       UPD-REG-CRS SECTION.
       INI-UPD-REG-CRS.
      *ALD/ 17-JUL-1989
           MOVE CAN-MSC-CANC IN CAN TO CRS-MSC-CANC IN CRS.
      *
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CRS.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CRS    NOMOD' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'REGISTRO CRS : ' CRS
               ADD 1 TO WSS-IND-RERR IN WSS-VARI
           ELSE
               ADD 1 TO WSS-IND-RUPD IN WSS-VARI.
       FIN-UPD-REG-CRS.
           EXIT.
      * Elimina un Registro CRS
       DEL-REG-CRS SECTION.
       INI-DEL-REG-CRS.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-CRS.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CRS    NODEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'REGISTRO CRS : ' CRS
               ADD 1 TO WSS-IND-RERR IN WSS-VARI
           ELSE
               ADD 1 TO WSS-IND-RDEL IN WSS-VARI.
       FIN-DEL-REG-CRS.
           EXIT.
       VAL-REG-CRS SECTION.
       INI-VAL-REG-CRS.
           MOVE 'N' TO WSS-IND-VALI IN WSS-VARI.
           IF ( CRS-IND-ACTU IN CRS = '00' OR
              CRS-IND-ACTU IN CRS = '01'   OR
              CRS-IND-ACTU IN CRS = '03' ) AND
              ( CRS-IND-PNEG IN CRS = '00' OR
              CRS-IND-PNEG IN CRS = '01'   OR
              CRS-IND-PNEG IN CRS = '03' )
               MOVE 'S' TO WSS-IND-VALI IN WSS-VARI.
       FIN-VAL-REG-CRS.
           EXIT.
       INI-REG-CRS SECTION.
       INI-INI-REG-CRS.
           MOVE LOW-VALUES TO CRS-COD-ISAF IN CRS.
           MOVE ZEROES TO WSS-AUX IN WSS-VARI.
           ADD 11 TO WSS-AUX IN WSS-VARI.
           MULTIPLY WSS-AUX IN WSS-VARI BY 16 GIVING
                                 WSS-AUX IN WSS-VARI.
           ADD 4 TO WSS-AUX IN WSS-VARI.
           MOVE WSS-AUX IN WSS-VARI TO WSS-AUX-DLIM IN WSS-VARI.
           MOVE WSS-AUX-DLI2 TO CRS-GLS-LREG IN CRS.
           MOVE ZEROES TO WSS-AUX IN WSS-VARI.
           ADD 4 TO WSS-AUX IN WSS-VARI.
           MULTIPLY WSS-AUX IN WSS-VARI BY 16 GIVING
                                 WSS-AUX IN WSS-VARI.
           MOVE WSS-AUX IN WSS-VARI TO WSS-AUX-DLIM IN WSS-VARI.
           MOVE WSS-AUX-DLI2 TO CRS-COD-ARCH IN CRS.
           MOVE LOW-VALUES TO CRS-GLS-UDJN IN CRS.
           MOVE LOW-VALUES TO CRS-GLS-TERM IN CRS.
           MOVE LOW-VALUES TO CRS-COD-EST1 IN CRS.
           MOVE LOW-VALUES TO CRS-COD-EST2 IN CRS.
           MOVE LOW-VALUES TO CRS-COD-MCSL IN CRS.
           MOVE ZEROES     TO CRS-VAL-VCCP IN CRS.
           MOVE ZEROES     TO CRS-VAL-PAGO IN CRS.
           MOVE ZEROES     TO CRS-VAL-PNEG IN CRS.
           MOVE LOW-VALUES TO CRS-COD-MICR IN CRS.
           MOVE SPACES     TO CRS-COD-OFRC IN CRS.
           MOVE LOW-VALUES TO CRS-FEC-FCAN IN CRS.
           MOVE ZEROES     TO CRS-NUM-VNEG IN CRS.
           MOVE ZEROES     TO CRS-VAL-VCNC IN CRS.
           MOVE ZEROES     TO CRS-VAL-MNEG IN CRS.
           MOVE ZEROES     TO CRS-VAL-GNEG IN CRS.
           MOVE ZEROES     TO CRS-VAL-MORA IN CRS.
           MOVE '00'       TO CRS-IND-ACTU IN CRS.
           MOVE '00'       TO CRS-IND-PNEG IN CRS.
           MOVE ZEROES     TO BCD-DAT3-INT IN BCD-VARI.
           MOVE BCD-DAT3 IN BCD-VARI TO CRS-DMA-FUTS IN CRS.
           MOVE ZEROES     TO CRS-DMA-FVCN IN CRS.
       FIN-INI-REG-CRS.
           EXIT.
       PRO-DLC SECTION.
       INI-PRO-DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-DLC.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC )
               GO TO FIN-PRO-DLC.
           IF OPC-MSC-TTRN IN OPC NOT = 'C'
               MOVE DLC-KEY-IDLC IN DLC TO BCD-DAT6-EBCD IN BCD-VARI
           ELSE
               MOVE DLC-CIC-IOPC IN DLC TO RCE-CIC-IOPC IN RCE
               MOVE DLC-NUM-IDLC IN DLC TO RCE-NUM-IDLC IN RCE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RCE
               IF NOT FIO-STAT-OKS
                   MOVE DLC-KEY-IDLC IN DLC TO RCE-KEY-SAFE IN RCE
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM COL-FIO-RCE
                   MOVE RCE-KEY-SAFE IN RCE TO BCD-DAT6-EBCD IN BCD-VARI
               ELSE
                   MOVE RCE-KEY-SAFE IN RCE TO BCD-DAT6-EBCD IN BCD-VARI
.
           MOVE BCD-DAT6-EBCD IN BCD-VARI TO BCD-DAT6-INT IN BCD-VARI.
           MOVE BCD-DAT6 IN BCD-VARI      TO CRS-KEY-ICRS IN CRS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CRS.
           IF FIO-STAT-OKS
               GO TO NXT-PRO-DLC.
           PERFORM BUS-ICG-DLC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-PRO-DLC.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG.
           PERFORM BUS-RDC-DLC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-PRO-DLC.
           PERFORM BUS-VEN-DLC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-PRO-DLC.
           PERFORM GEN-REG-CRS.
           PERFORM INI-REG-CRS.
           PERFORM PUT-REG-CRS.
       NXT-PRO-DLC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-DLC.
       FIN-PRO-DLC.
           EXIT.
       BUS-ICG-DLC SECTION.
       INI-BUS-ICG-DLC.
           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
              ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               GO TO FIN-BUS-ICG-DLC.
           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES       TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
              ICG-NUM-ICAN IN ICG = ZEROES       AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               GO TO FIN-BUS-ICG-DLC.
           MOVE FIO-STAT-NEX TO FIO-STAT.
           MOVE SPACES TO ICG.
       FIN-BUS-ICG-DLC.
           EXIT.
       BUS-RDC-DLC SECTION.
       INI-BUS-RDC-DLC.
           MOVE DLC-CIC-IOPC IN DLC TO RDC-CIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RDC-KEY-IDLC IN RDC
               MOVE SPACES TO DBC-IDC-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC
               MOVE '00' TO FIO-STAT
               GO TO FIN-BUS-RDC-DLC.
      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-IDC-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC
               GO TO FIN-BUS-RDC-DLC.
       FIN-BUS-RDC-DLC.
           EXIT.
       BUS-VEN-DLC SECTION.
       INI-BUS-VEN-DLC.
           IF OPC-IND-VSTR IN OPC = 'S'
               GO TO CON-EVC.
           MOVE DLC-CIC-IOPC IN DLC TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       NXT-BUS-VEN-DLC.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = VEN-CIC-IOPC IN VEN )
              MOVE FIO-STAT-NEX TO FIO-STAT
              GO TO FIN-BUS-VEN-DLC.
           IF VEN-NUM-IDLC IN VEN NOT = DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO NXT-BUS-VEN-DLC.
           IF VEN-VAL-SFIN IN VEN NOT > ZEROES
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO NXT-BUS-VEN-DLC.
           GO TO FIN-BUS-VEN-DLC.
       CON-EVC.
           MOVE SPACES TO WSS-KEY-IEVC IN WSS-VARI.
           MOVE ZEROES TO WSS-FEC-FPVC IN WSS-VARI.
           MOVE OPC-CAI-IOPC IN OPC TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN OPC TO EVC-IIC-IOPC IN EVC.
           MOVE 0                       TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       EVC-CMN-ACC.
           PERFORM COL-FIO-EVC.
           IF FIO-STAT-OKS AND
              EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN OPC AND
              EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN OPC AND
              EVC-NUM-IDLC IN EVC = DLC-NUM-IDLC IN DLC
               IF EVC-FEC-FPVC IN EVC < WSS-FEC-FPVC IN WSS-VARI OR
                  WSS-FEC-FPVC IN WSS-VARI = ZEROES
                   MOVE EVC-KEY-IEVC IN EVC TO WSS-KEY-IEVC IN WSS-VARI
                   MOVE EVC-FEC-FPVC IN EVC TO WSS-FEC-FPVC IN WSS-VARI
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO EVC-CMN-ACC
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO EVC-CMN-ACC.
           MOVE WSS-KEY-IEVC IN WSS-VARI TO EVC-KEY-IEVC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE ESTRUCTURA'
               GO TO FIN-BUS-VEN-DLC.
           IF OPC-IND-AFER IN OPC = 'N'
               GO TO MRA-CMN-ACC.
           MOVE WSS-NUM-DPVC IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MPVC IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SPVC IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-APVC IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-SIG-HBL  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-OKS
                   MOVE FEC-ITM1 TO WSS-NUM-DPVC IN WSS-VARI
                   MOVE FEC-ITM2 TO WSS-NUM-MPVC IN WSS-VARI
                   MOVE FEC-ITM3 TO WSS-NUM-SPVC IN WSS-VARI
                   MOVE FEC-ITM4 TO WSS-NUM-APVC IN WSS-VARI.
       MRA-CMN-ACC.
           MOVE WSS-NUM-DPVC IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MPVC IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SPVC IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-APVC IN WSS-VARI TO FEC-ITM4.
           MOVE EVC-NUM-DESD IN EVC      TO FEC-NDIA.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           IF EVC-NUM-DESD IN EVC NOT > 0
               IF OPC-IND-AFER IN OPC = 'N'
                   MOVE 1 TO FEC-NDIA
                   MOVE FEC-SUM-DIA TO FEC-CMND
               ELSE
                   MOVE FEC-SIG-HBL TO FEC-CMND
           ELSE
               MOVE FEC-SUM-DIA TO FEC-CMND.
           PERFORM PRO-FEC.
           IF EVC-NUM-DESD IN EVC NOT > 0
               GO TO IMV-CMN-ACC.
           IF OPC-IND-AFER IN OPC = 'N'
               GO TO IMV-CMN-ACC.
           MOVE FEC-VHBL-S  TO FEC-VHBL.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               MOVE FEC-SIG-HBL TO FEC-CMND
               PERFORM PRO-FEC.
       IMV-CMN-ACC.
           MOVE FEC-ITM1 TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-AIMV IN WSS-VARI.
           MOVE WSS-FEC-FPVC IN WSS-VARI TO VEN-FEC-FVEN IN VEN.
           MOVE WSS-FEC-FIMV IN WSS-VARI TO VEN-FEC-FIMV IN VEN.
           MOVE 1                        TO VEN-NUM-IVEN IN VEN.
      *????
           MOVE ZEROES TO VEN-VAL-SFIN IN VEN.
      ******
           MOVE DLC-NUM-IDLC IN DLC TO VEN-NUM-IDLC IN VEN.
           MOVE '00' TO FIO-STAT.
      *falta ver estructura ...?
       FIN-BUS-VEN-DLC.
           EXIT.
       GEN-MOD-REG-CRS SECTION.
       INI-GEN-MOD-REG-CRS.
           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE VEN-VAL-SFIN IN VEN TO CRS-VAL-VENP IN CRS
           ELSE
               MOVE VEN-VAL-SFIN IN VEN TO CRS-VAL-VENO IN CRS.
           MOVE VEN-VAL-SCAP IN VEN TO CRS-VAL-SCAP IN CRS.
           MOVE VEN-NUM-IVEN IN VEN TO CRS-NUM-IVEN IN CRS.
           MOVE VEN-NUM-AVEN IN VEN TO CRS-NUM-AVEN IN CRS.
           MOVE VEN-NUM-MVEN IN VEN TO CRS-NUM-MVEN IN CRS.
           MOVE VEN-NUM-DVEN IN VEN TO CRS-NUM-DVEN IN CRS.
           MOVE VEN-NUM-AIMV IN VEN TO CRS-NUM-AIMV IN CRS.
           MOVE VEN-NUM-MIMV IN VEN TO CRS-NUM-MIMV IN CRS.
           MOVE VEN-NUM-DIMV IN VEN TO CRS-NUM-DIMV IN CRS.
           MOVE OPC-COD-OFOC IN OPC TO CRS-COD-OFOC IN CRS.
           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE '01' TO CRS-COD-MONS IN CRS
           ELSE
               MOVE '98' TO CRS-COD-MONS IN CRS.
      *
           MOVE OPC-COD-COOC IN OPC TO CRS-COD-AUXI IN CRS.
           IF OPC-COD-COOC IN OPC > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DAT3 TO WSS-GLS-DAT3 IN WSS-VARI
               MOVE WSS-IND-TCRE IN WSS-VARI TO CRS-IND-TCRE IN CRS
           ELSE
               MOVE SPACES TO CRS-IND-TCRE IN CRS.
           MOVE OPC-NUM-ACOL IN OPC TO CRS-NUM-ACOL IN CRS.
           MOVE OPC-NUM-MCOL IN OPC TO CRS-NUM-MCOL IN CRS.
           MOVE OPC-NUM-DCOL IN OPC TO CRS-NUM-DCOL IN CRS.
           MOVE ICG-SGV-TINT IN ICG TO CRS-VAL-TASA IN CRS.
           MOVE DBC-IDC-ICLI IN DBC TO CRS-IDC-IDEU IN CRS.
           MOVE DBC-VRF-ICLI IN DBC TO CRS-VRF-IDEU IN CRS.
           MOVE OPC-CIC-IOPC IN OPC TO CRS-KEY-IOPC IN CRS.
           MOVE '2' TO CRS-IND-TSIS IN CRS.
           IF OPC-COD-TOPC IN OPC > SPACES
               IF OPC-COD-TOPC NOT NUMERIC
                   MOVE '1' TO CRS-IND-TSIS IN CRS.
      * Busca Plazo de Documento Legal de Operacion de Credito con VEN-NUM-IDLC
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   DLC-KEY-IDLC IN DLC
               MOVE SPACES TO DLC-COD-PLZO IN DLC
               MOVE SPACES TO CRS-IND-PLZO IN CRS
               MOVE ZEROES TO DLC-VAL-SDLC IN DLC
               MOVE ZEROES TO CRS-VAL-SDLC IN CRS
               GO TO FIN-GEN-REG-CRS.
      *BUS-TAB busca glosa de codigo en tabla
           IF DLC-COD-PLZO IN DLC > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'PZO' TO TAB-COD-TTAB IN TAB
               MOVE DLC-COD-PLZO IN DLC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-COD-DAT1(1) TO CRS-IND-PLZO IN CRS
           ELSE
               MOVE SPACES TO CRS-IND-PLZO IN CRS.
           MOVE DLC-VAL-SDLC IN DLC TO CRS-VAL-SDLC IN CRS.
           IF OPC-COD-VCOC IN OPC = WSS-COD-UFES IN WSS-VARI
               MOVE CRS-VAL-VENO IN CRS TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-VENO IN CRS
               MOVE CRS-VAL-SCAP IN CRS TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-SCAP IN CRS
               MOVE CRS-VAL-SDLC IN CRS TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-SDLC IN CRS.
       FIN-GEN-MOD-REG-CRS.
           EXIT.
       COPY TABBFCAM.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY COLBFTOC.
       COPY COLBFOPC.
       COPY COLBFCAN.
       COPY COLBFRCE.
       COPY COLBFICG.
       COPY COLBFVEN.
       COPY COLBFRCV.
       COPY COLBFDLC.
       COPY COLIOCRS.
       COPY COLBFRDC.
       COPY COLBFEVC.
       COPY SGCBFDBC.
       COPY GNSBFCIC.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGCIC.
       COPY SGCBGCLI.
       COPY GNSBGPES.
       COPY GNSBGINT.
       COPY GNSBGCVI.
       COPY COLBGVEN.
       COPY TABBVOFI.
       COPY TABBBOFI.
       COPY TABBFOFI.
       COPY COLBGMUF.
