       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGDPM.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    25-MAR-1996.
      * Elimina OPC no Activadas de Colocaciones

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
       COPY GNSBRMSG.
       COPY GNSBRTAB.
       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBRVEN.
       COPY COLBREVC.
       COPY COLBRRDC.
       COPY COLBRRCE.
       COPY COLBRICG.
       COPY COLBRCYA.

       COPY COLWGECA.
       COPY COLWGEOP.
       COPY COLWGMUF.
       COPY COLWGVEN.
       COPY GNSWGPES.
       COPY COLWGINT.
       COPY GNSWGCVI.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWVIDD.
       COPY GNSWGBCD.
       COPY GNSWCVRF.
       COPY GNSWVVRF.

       01  WSS-VARI.
           03 WSS-OPC-LEID           VALUE ZEROS  PIC 9(09).
           03 WSS-OPC-ELIM           VALUE ZEROS  PIC 9(09).
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MPRO        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-SPRO        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-APRO        VALUE ZEROS  PIC 9(02).
           03 WSS-FEC-FINP.
              05 WSS-NUM-SINP        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AINP        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MINP        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-DINP        VALUE ZEROS  PIC 9(02).

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPGDPM' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM OPEN-FILE.
           PERFORM ACEP-PARAM.
           PERFORM REG-OPC.
           PERFORM CLOSE-FILE.
       FIN-MAIN.
       COPY GNSBGGBK.

       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
           DISPLAY 'INI OPEN FILE'.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-RDC.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-EVC.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-ICG.

           DISPLAY 'FIN OPEN FILE'.
       FIN-OPEN-FILE.
           EXIT.

       CLOSE-FILE SECTION.
      *------------------
       INI-CLOSE-FILE.
           DISPLAY '      ESTADISTICAS DE PROCESO'.
           DISPLAY '      ======================='.
           DISPLAY ' '.
           DISPLAY 'OPC LEIDOS          : ' WSS-OPC-LEID.
           DISPLAY 'OPC ELIMINADAS      : ' WSS-OPC-ELIM.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-RDC.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-EVC.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-VEN.
       FIN-CLOSE-FILE.
           EXIT.

       ACEP-PARAM SECTION.
       INI-ACEP-PARAM.
           ACCEPT WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY 'FECHA PARAMETRO ' WSS-FEC-FPRO IN WSS-VARI.
      *Validacion de parametros
      *VAL-FEC Valida Fecha de Proceso
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
           MOVE WSS-FEC-FPRO TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-ABT.

           DISPLAY 'INICIO VALIDACION FECHA PARAMETRO'.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DINP IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MINP IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SINP IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-AINP IN WSS-VARI.
       FIN-ACEP-PARAM.
           EXIT.

       REG-OPC SECTION.
      *---------------
       INI-REG-OPC.
      * Programacion de Ciclo para Registro OPC
           MOVE WSS-FEC-FINP IN WSS-VARI TO OPC-FEC-FINP IN OPC.
           MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT (FIO-STAT-OKS AND
                   OPC-FEC-FINP IN OPC < WSS-FEC-FINP IN WSS-VARI)
               DISPLAY 'NO HAY REGISTROS OPC '
               GO TO FIN-REG-OPC.
       LUP-REG-OPC.
           ADD 1 TO WSS-OPC-LEID IN WSS-VARI.
      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           IF OPC-MSC-STAT IN OPC = 'I' OR 'L' OR 'M'
               ADD 1 TO WSS-OPC-ELIM IN WSS-VARI
               PERFORM COL-ELI-OPC.

       NXT-LUP-REG-OPC.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
           PERFORM COL-FIO-OPC.
           IF NOT (FIO-STAT-OKS AND
                   OPC-FEC-FINP IN OPC < WSS-FEC-FINP IN WSS-VARI)
               GO TO FIN-REG-OPC.
           GO TO LUP-REG-OPC.
       FIN-REG-OPC.
           EXIT.

       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY COLBFOPC.
       COPY COLBFRCE.
       COPY COLBFICG.
       COPY COLBFVEN.
       COPY COLBFCYA.
       COPY COLBFDLC.
       COPY COLBFRDC.
       COPY COLBFEVC.

       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.
      * COPY COLBGVEN.
       COPY COLBGEOP.
