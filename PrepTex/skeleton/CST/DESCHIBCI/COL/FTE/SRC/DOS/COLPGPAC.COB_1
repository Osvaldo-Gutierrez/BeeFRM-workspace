       IDENTIFICATION DIVISION.
      *-----------------------*
       PROGRAM-ID. COLPGPAC.
       AUTHOR.     DPM.
      ******************************************************************
      *  SISTEMA  : COLOCACIONES.                                      *
      *  OBJETIVO : GENERA ARCHIVO FORMATO PAC CON CARGOS POR          *
      *             HONORARIOS DE COBRANZA PARA FILIAL DEL BCI.        *
      *  ENTRADA  : CAN (DTC)                                          *
      *  SALIDA   : ARCHIVO FORMATO PAC (SAM)                          *
      ******************************************************************
       ENVIRONMENT DIVISION.
      *--------------------*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
           C01 IS CANAL-1
           DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------*
       FILE-CONTROL.
      *------------*
           SELECT SALIDA    ASSIGN TO SALIDA
                            FILE STATUS IS FS-PAC.

       DATA DIVISION.
      *-------------*
       FILE SECTION.
      *------------*
       FD  SALIDA LABEL RECORD IS STANDARD
           BLOCK CONTAINS 0 RECORDS.

       01  PAC.
           02  REG-PAC                PIC X(200).

       WORKING-STORAGE SECTION.
      *-----------------------*
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.

       COPY COLWGINT.
       COPY COLWGVEN.

       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBRRCV.
       COPY COLBRVEN.
       COPY COLBREVC.
       COPY COLBRICG.
       COPY COLBRTOC.
       COPY GNSBRTAB.
       COPY GNSBRMSC.
       COPY GNSBRMSG.
       COPY TABBRCAM.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
       COPY GNSWGSYS.

       77  WL-EVC                     PIC 9(08)          VALUE 0.
       77  WL-CAN                     PIC 9(08)          VALUE 0.
       77  WN-CAN                     PIC 9(08)          VALUE 0.
       77  WD-PAC                     PIC 9(08)          VALUE 0.
       77  FS-PAC                     PIC 9(02)          VALUE 0.
       77  WS-SGV-TCOM                PIC 9(12)V9(02)    VALUE 0.
       77  I                          PIC 9(03)          VALUE 0.
       77  J                          PIC 9(03)          VALUE 0.
       77  WS-CONSUMO                 PIC 9(01)          VALUE 0.
       77  WS-TBAN                    PIC 9(01)          VALUE 0.
       77  WS-PORC                    PIC 9(01)          VALUE 0.
       77  WS-VCD                     PIC 9(01)          VALUE 0.
       77  WS-SGV-VCAM                PIC S9(11)V9(04)   VALUE +0.
       77  WS-VAL-DATOS               PIC 9(01)          VALUE 0.
       77  WL-BCA                     PIC 9(08)          VALUE 0.
       77  WS-PLAN                    PIC 9(01)          VALUE 0.
       77  WS-CTA-CTE                 PIC 9(01)          VALUE 0.
       77  WS-SGV-CALC                PIC S9(11)         VALUE +0.
       77  WS-PORC-MIN                PIC 9(11)          VALUE 0.
       77  WS-PORC-MAX                PIC 9(11)          VALUE 0.
       77  WS-NUM-CTAC                PIC 9(12)          VALUE 0.
       77  WS-NUM-DIA                 PIC 9(03).
       77  WS-GLS-DIA REDEFINES
                      WS-NUM-DIA      PIC X(03).
       77  WS-KEY-IDLC                PIC X(15).
       77  WS-CAL-FECHA-AUX           PIC 9(01)          VALUE 0.
       77  WS-NUM-IVEN                PIC 9(03)          VALUE 0.
       77  WS-CAL-MES-ANT             PIC 9(03)          VALUE 0.
       77  WS-NUM-SEVE                PIC 9(03)          VALUE 0.

      * REGISTRO DE TRABAJO PARA ARCHIVO PAC
      *
      * DATOS DE CABECERA
       01  PAC-CABE.
           02  PAC-NUM-TREG       PIC 9(01) VALUE 1.
           02  PAC-NUM-EMPR       PIC 9(09) VALUE ZEROES.
           02  PAC-VRF-EMPR       PIC X(01).
           02  PAC-GLS-NOME       PIC X(75).
           02  PAC-COD-IDEM       PIC X(07) VALUE '4000   '.
           02  PAC-FEC-FEMI.
               03  PAC-NUM-MEMI   PIC 9(02).
               03  PAC-NUM-DEMI   PIC 9(02).
               03  PAC-NUM-SEMI   PIC 9(02).
               03  PAC-NUM-AEMI   PIC 9(02).
           02  PAC-IND-TARC       PIC 9(01) VALUE 1.
           02  PAC-COD-RECH       PIC 9(04) VALUE ZEROES.
           02  FILLER             PIC X(94) VALUE SPACES.

      * DATOS DE DETALLE
       01  PAC-DETA.
           02  PAC-NUM-TREG       PIC 9(01) VALUE 2.
           02  PAC-NUM-CORR       PIC 9(07) VALUE ZEROES.
           02  PAC-NUM-ICLI       PIC 9(09) VALUE ZEROES.
           02  PAC-VRF-ICLI       PIC X(01) .
           02  PAC-COD-IDCL       PIC X(25).
           02  PAC-NUM-BOFA.
               03  PAC-NUM-ICAN   PIC 9(03) VALUE ZEROES.
               03  FILL1          PIC 9(11) VALUE ZEROES.
               03  FILL2          PIC 9(11) VALUE ZEROES.
           02  PAC-SGV-TPAG       PIC 9(11)V9(02) VALUE ZEROES.
           02  PAC-FEC-FPAG.
               03  PAC-NUM-MPAG   PIC 9(02).
               03  PAC-NUM-DPAG   PIC 9(02).
               03  PAC-NUM-SPAG   PIC 9(02).
               03  PAC-NUM-APAG   PIC 9(02).
           02  PAC-MSC-STAT       PIC 9(03) VALUE 012.
           02  PAC-COD-RECH       PIC 9(04) VALUE ZEROES.
           02  PAC-NUM-CTAC       PIC 9(12) VALUE ZEROES.
           02  FILLER             PIC X(92) VALUE SPACES.

      * DATOS DE FIN DE ARCHIVO
       01  PAC-TRAI.
           02  PAC-NUM-TREG       PIC 9(01) VALUE 3.
           02  PAC-NUM-REGT       PIC 9(06) VALUE ZEROES.
           02  PAC-SGV-PAGT       PIC 9(12)V9(02) VALUE ZEROES.
           02  PAC-NUM-REGA       PIC 9(06) VALUE ZEROES.
           02  PAC-SGV-PAGA       PIC 9(12)V9(02) VALUE ZEROES.
           02  PAC-NUM-REGR       PIC 9(06) VALUE ZEROES.
           02  PAC-SGV-PAGR       PIC 9(12)V9(02) VALUE ZEROES.
           02  FILLER             PIC X(139) VALUE SPACES.

       01  W-PARAMETRO.
           05 W-FECHA-PAR.
              07 W-SIG-PAR            PIC 9(02).
              07 W-ANO-PAR            PIC 9(02).
              07 W-MES-PAR            PIC 9(02).
              07 W-DIA-PAR            PIC 9(02).

       01  W-FECHA-DATOS-PAC.
           05 W-FECHA-PAC.
              07 W-SIG-PAC            PIC 9(02).
              07 W-ANO-PAC            PIC 9(02).
              07 W-MES-PAC            PIC 9(02).
              07 W-DIA-PAC            PIC 9(02).

       01  W-FECHAS.
           05 W-FEC-FVEN.
              07 W-SIG-VEN            PIC 9(02).
              07 W-ANO-VEN            PIC 9(02).
              07 W-MES-VEN            PIC 9(02).
              07 W-DIA-VEN            PIC 9(02).
           05 W-FEC-FAUX.
              07 W-SIG-AUX            PIC 9(02).
              07 W-ANO-AUX            PIC 9(02).
              07 W-MES-AUX            PIC 9(02).
              07 W-DIA-AUX            PIC 9(02).

       01  WS-GLS-DATA-PORC.
              03 WS-SGV-PORC          PIC 9(03)V9(04).

       01  WS-GLS-DATA-TIOS.
           02 WS-GLS-TIO   OCCURS 20  PIC X(03).

       01  WS-GLS-DATA-BANCA.
           02 WS-SGV-MMIN             PIC 9(09)V9(04).
           02 WS-GLS-MONE             PIC X(06).
           02 WS-NUM-DIMC             PIC 9(02).
           02 WS-IND-TDMC             PIC X(01).
           02 WS-NUM-DIME             PIC 9(02).
           02 WS-IND-TDME             PIC X(01).
           02 WS-COD-PLAN  OCCURS 20  PIC X(01).
           02 WS-SGV-MMAX             PIC 9(09)V9(04).

       01  WS-BANCAS.
           02 WS-VEC-BCA OCCURS 100 TIMES.
              03 WS-COD-BANCA            PIC X(06).
              03 WS-GLS-DATA             PIC X(60).

       01  WS-CARGO.
           02 WS-TIPO-CARGO           PIC X(02).

       01  WS-VAL-KEY.
           02 WS-COD-TBAN                PIC X(03).
           02 WS-DIF-DIAS                PIC X(03).

       COPY RTNWCALE.

       01  UIB.
           05 FILLER               PIC X(32) VALUE 'COLPGPAC'.

      ***************************************************************
      * SE DEFINENE TABLAS DATACOM QUE SE UTILIZAN EN EL PROGRAMA
      ***************************************************************
      * TABLAS DATACOM QUE UTILIZA EL PROGRAMA:
      * - CAN
      * - VEN
      * - OPC
      * - DLC
      * - RDC
      * - ROV
      * - RCO
      * - OPE
      * - DBC
      * - DCP
      * - DCE
      * - CYA
      * - CAM
      * - TAB de COL
      * - MSC
      ***************************************************************
       01  REQ-AREA-CAN.
           03 CAN-COMMAND          PIC  X(05).
           03 CAN-TABLE            PIC  X(03) VALUE 'CAN'.
           03 CAN-KEY              PIC  X(05) VALUE 'CAN03'.
           03 CAN-RET-COD          PIC  X(02) VALUE SPACES.
           03 CAN-INT-RC           PIC  X(01).
           03 CAN-DB-ID            PIC S9(04) COMP VALUE +160.
           03 CAN-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 CAN-CONT-MAX         PIC S9(04) COMP.
           03 CAN-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 CAN-VAL-KEY          PIC  X(08).

       01  REG-CAN.
      *    COPYDD COL-R-CAN.COL-E-CAN00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO CAN
           02  COL-E-CAN00.
      *                             CANCELACIONES
               03  CAN.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CAN-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  CAN-KEY-IREG.
      *                             KEY    IDENTIFICACION CANCELACION
                       05  CAN-KEY-ICAN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  CAN-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  CAN-CAI-IOPC.
                       08  CAN-COD-TOPC
                                    PICTURE X(1).
                       08  CAN-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  CAN-IIC-IOPC.
                       08  CAN-COD-OOPC.
                       09  CAN-COD-SOPC
                                    PICTURE X(2).
                       09  CAN-IND-SOPC
                                    PICTURE X(1).
                       08  CAN-GLS-NOPC
                                    PICTURE X(5).
      *                             NUMERO IDENTIFICACION CANCELACION
                       06  CAN-NUM-ICAN
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  CAN-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CAN-FEC-FTRN.
                       07  CAN-NUM-STRN
                                    PICTURE 9(2).
                       07  CAN-NUM-ATRN
                                    PICTURE 9(2).
                       07  CAN-NUM-MTRN
                                    PICTURE 9(2).
                       07  CAN-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CAN-HRA-HRTR.
                       07  CAN-NUM-HHTR
                                    PICTURE 9(2).
                       07  CAN-NUM-MMTR
                                    PICTURE 9(2).
                       07  CAN-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  CAN-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CAN-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  CAN-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CAN-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CAN-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  CAN-COD-ATRN PICTURE X(12).
      *                             REQ OFICINA CANCELACION
                   04  CAN-COD-OFCA PICTURE X(3).
      *                             CODIGO RESPONSABLE CANCELACION
                   04  CAN-COD-RCAN PICTURE X(12).
      *                             REQ CODIGO CANCELACION
                   04  CAN-MSC-CANC.
      *                             TIPO CANCELACION
                       05  CAN-MSC-TCAN
                                    PICTURE X(1).
      *                             FORMA CANCELACION
                       05  CAN-MSC-FCAN
                                    PICTURE X(1).
      *                             ENTIDAD CANCELACION
                       05  CAN-MSC-ECAN
                                    PICTURE X(1).
      *                             REQ FECHA CANCELACION REAL
                   04  CAN-FEC-FCAN.
                       05  CAN-NUM-SCAN
                                    PICTURE 9(2).
                       05  CAN-NUM-ACAN
                                    PICTURE 9(2).
                       05  CAN-NUM-MCAN
                                    PICTURE 9(2).
                       05  CAN-NUM-DCAN
                                    PICTURE 9(2).
      *                             REQ FECHA CANCELACION CONTABLE
                   04  CAN-FEC-FEGR.
                       05  CAN-NUM-SEGR
                                    PICTURE 9(2).
                       05  CAN-NUM-AEGR
                                    PICTURE 9(2).
                       05  CAN-NUM-MEGR
                                    PICTURE 9(2).
                       05  CAN-NUM-DEGR
                                    PICTURE 9(2).
      *                             REQ FECHA CANCELACION COMPUTACIONAL
                   04  CAN-FEC-FOUT.
                       05  CAN-NUM-SOUT
                                    PICTURE 9(2).
                       05  CAN-NUM-AOUT
                                    PICTURE 9(2).
                       05  CAN-NUM-MOUT
                                    PICTURE 9(2).
                       05  CAN-NUM-DOUT
                                    PICTURE 9(2).
      *                             VALOR GASTOS
                   04  CAN-SGV-GAST PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR TOTAL PAGADO
                   04  CAN-SGV-TPAG PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR TOTAL RENOVADO
                   04  CAN-SGV-TREN PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             TOTAL DE VENCIMIENTOS CANCELADOS
                   04  CAN-NUM-TVCC PICTURE S9(3).
      *                             DIFERENCIA, PAGO EFECT - DEBE PAGAR
                   04  CAN-SGV-DIFE PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             FECHA DEVENGO ANTERIOR
                   04  CAN-FEC-FDVA.
                       05  CAN-NUM-SDVA
                                    PICTURE 9(2).
                       05  CAN-NUM-ADVA
                                    PICTURE 9(2).
                       05  CAN-NUM-MDVA
                                    PICTURE 9(2).
                       05  CAN-NUM-DDVA
                                    PICTURE 9(2).
      *                             GLOSA DISPONIBLE
                   04  CAN-GLS-DISP PICTURE X(25).

       01  ELEM-LIST-CAN.
           03 ELEM-1-CAN     PIC X(5) VALUE 'CAN00'.
           03 ELEM-CAN       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************
       01  REQ-AREA-RDC.
           03 RDC-COMMAND          PIC  X(05).
           03 RDC-TABLE            PIC  X(03) VALUE 'RDC'.
           03 RDC-KEY              PIC  X(05) VALUE 'RDC01'.
           03 RDC-RET-COD          PIC  X(02) VALUE SPACES.
           03 RDC-INT-RC           PIC  X(01).
           03 RDC-DB-ID            PIC S9(04) COMP VALUE +160.
           03 RDC-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 RDC-CONT-MAX         PIC S9(04) COMP.
           03 RDC-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 RDC-VAL-KEY          PIC  X(15).
           03 RDC-VAL-KEY-R REDEFINES RDC-VAL-KEY.
              05 RDC-VAL-KEY-1     PIC X(12).
              05 RDC-VAL-KEY-2     PIC X(03).

       01  REG-RDC.
      *    COPYDD COL-R-RDC.COL-E-RDC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RDC
           02  COL-E-RDC00.
      *                             RELACION DEUDOR CREDITO
               03  RDC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RDC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  RDC-KEY-IREG.
      *                             KEY     IDENTIFICACION RELACION DEUD
                       05  RDC-KEY-IRDC.
      *                             COD. INT. COMP. CLIENTE
                       06  RDC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RDC-CAI-ICLI.
                       08  RDC-COD-TCLI
                                    PICTURE X(1).
                       08  RDC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RDC-IIC-ICLI
                                    PICTURE X(8).
      *                             IDENTIFICACION DOCUMENTO LEGAL
                       06  RDC-KEY-IDLC.
      *                             COD. INT. COMP. OPERACION CURSADA
                       07  RDC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  RDC-CAI-IOPC.
                       09  RDC-COD-TOPC
                                    PICTURE X(1).
                       09  RDC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  RDC-IIC-IOPC.
                       09  RDC-COD-OOPC.
                       10  RDC-COD-SOPC
                                    PICTURE X(2).
                       10  RDC-IND-SOPC
                                    PICTURE X(1).
                       09  RDC-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENTIFICACION DOCUMENTO LEGAL
                       07  RDC-NUM-IDLC
                                    PICTURE 9(3).
      *                             CODIGO TIPO RELACION
                       05  RDC-COD-TRDC
                                    PICTURE X(3).
      *                             TIME STAMP TRANSACCION
                       05  RDC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RDC-FEC-FTRN.
                       07  RDC-NUM-STRN
                                    PICTURE 9(2).
                       07  RDC-NUM-ATRN
                                    PICTURE 9(2).
                       07  RDC-NUM-MTRN
                                    PICTURE 9(2).
                       07  RDC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RDC-HRA-HRTR.
                       07  RDC-NUM-HHTR
                                    PICTURE 9(2).
                       07  RDC-NUM-MMTR
                                    PICTURE 9(2).
                       07  RDC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  RDC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RDC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  RDC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RDC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RDC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  RDC-COD-ATRN PICTURE X(12).
      *                             PEN DIRECCION ASOCIADA
                   04  RDC-NUM-DIRE PICTURE X(2).
      *                             REQ MONTO LIMITE DEUDA ( PORCENTAJE
                   04  RDC-VAL-LIMD PICTURE 9(3)V9(6)
                                        COMPUTATIONAL.
      *                             GLOSA DISPONIBLE
                   04  RDC-GLS-DISP PICTURE X(6).

       01  ELEM-LIST-RDC.
           03 ELEM-1-RDC     PIC X(5) VALUE 'RDC00'.
           03 ELEM-RDC       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************
       01  REQ-AREA-ROV.
           03 ROV-COMMAND          PIC  X(05).
           03 ROV-TABLE            PIC  X(03) VALUE 'ROV'.
           03 ROV-KEY              PIC  X(05) VALUE 'ROV01'.
           03 ROV-RET-COD          PIC  X(02) VALUE SPACES.
           03 ROV-INT-RC           PIC  X(01).
           03 ROV-DB-ID            PIC S9(04) COMP VALUE +160.
           03 ROV-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 ROV-CONT-MAX         PIC S9(04) COMP.
           03 ROV-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 ROV-VAL-KEY          PIC  X(15).
           03 ROV-VAL-KEY-R REDEFINES ROV-VAL-KEY.
              05 ROV-VAL-KEY-1     PIC X(12).
              05 ROV-VAL-KEY-2     PIC 9(03).

       01  REG-ROV.
      *    COPYDD COL-R-ROV.COL-E-ROV00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO ROV
           02  COL-E-ROV00.
      *                             RELACION OPERACION VENCIMIENTOS
               03  ROV.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  ROV-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  ROV-KEY-IREG.
      *                             KEY     IDENTIFICACION RELACION OPER
                       05  ROV-KEY-IROV.
      *                             COD. INT. COMP. OPERACION CREDITO (
                       06  ROV-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  ROV-CAI-IOPC.
                       08  ROV-COD-TOPC
                                    PICTURE X(1).
                       08  ROV-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  ROV-IIC-IOPC.
                       08  ROV-COD-OOPC.
                       09  ROV-COD-SOPC
                                    PICTURE X(2).
                       09  ROV-IND-SOPC
                                    PICTURE X(1).
                       08  ROV-GLS-NOPC
                                    PICTURE X(5).
      *                             IDENTIFICACION VENCIMIENTO
                       06  ROV-KEY-IVCT.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  ROV-CIC-IOPV.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  ROV-CAI-IOPV.
                       09  ROV-COD-TOPV
                                    PICTURE X(1).
                       09  ROV-COD-COPV
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  ROV-IIC-IOPV.
                       09  ROV-COD-OOPV.
                       10  ROV-COD-SOPV
                                    PICTURE X(2).
                       10  ROV-IND-SOPV
                                    PICTURE X(1).
                       09  ROV-GLS-NOPV
                                    PICTURE X(5).
      *                             NUM IDENT. VENCIMIENTO
                       07  ROV-NUM-IVCT
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  ROV-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  ROV-FEC-FTRN.
                       07  ROV-NUM-STRN
                                    PICTURE 9(2).
                       07  ROV-NUM-ATRN
                                    PICTURE 9(2).
                       07  ROV-NUM-MTRN
                                    PICTURE 9(2).
                       07  ROV-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  ROV-HRA-HRTR.
                       07  ROV-NUM-HHTR
                                    PICTURE 9(2).
                       07  ROV-NUM-MMTR
                                    PICTURE 9(2).
                       07  ROV-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  ROV-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  ROV-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  ROV-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  ROV-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  ROV-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  ROV-COD-ATRN PICTURE X(12).
      *                             REQ VALOR RENOVADO
                   04  ROV-SGV-RENO PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ CODIGO VALOR DE CAMBIO VALOR REN
                   04  ROV-COD-VCVR.
      *                             MISCELANEO TIPO VALOR
                       05  ROV-MSC-TVVR
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       05  ROV-COD-CVVR
                                    PICTURE X(3).
      *                             CODIGO TIPO CAMBIO
                       05  ROV-COD-TCVR
                                    PICTURE X(2).
      *                             GLOSA DISPONIBLE
                   04  ROV-GLS-DISP PICTURE X(1).

       01  ELEM-LIST-ROV.
           03 ELEM-1-ROV     PIC X(5) VALUE 'ROV00'.
           03 ELEM-ROV       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************
       01  REQ-AREA-RCO.
           03 RCO-COMMAND          PIC  X(05).
           03 RCO-TABLE            PIC  X(03) VALUE 'RCO'.
           03 RCO-KEY              PIC  X(05) VALUE 'RCO00'.
           03 RCO-RET-COD          PIC  X(02) VALUE SPACES.
           03 RCO-INT-RC           PIC  X(01).
           03 RCO-DB-ID            PIC S9(04) COMP VALUE +100.
           03 RCO-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 RCO-CONT-MAX         PIC S9(04) COMP.
           03 RCO-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 RCO-VAL-KEY          PIC  X(24).
           03 RCO-VAL-KEY-R REDEFINES RCO-VAL-KEY.
              05 RCO-VAL-KEY-1     PIC X(12).
              05 RCO-VAL-KEY-2     PIC X(12).


       01  REG-RCO.
      *    COPYDD DGC-R-RCO.DGC-E-RCO00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RCO
           02  DGC-E-RCO00.
      *                             RELACION CLIENTE OPERACION
               03  RCO.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RCO-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  RCO-KEY-IREG.
      *                             IDENTIFICACION RELACION CLIENTE OPER
                       05  RCO-KEY-IRCO.
      *                             COD. INT. COMP. CLIENTE
                       06  RCO-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RCO-CAI-ICLI.
                       08  RCO-COD-TCLI
                                    PICTURE X(1).
                       08  RCO-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RCO-IIC-ICLI
                                    PICTURE X(8).
      *                             IDENTIFICACION OPERACION RELACION
                       06  RCO-KEY-IOPE.
      *                             COD. INT. COMP. OPERACION
                       07  RCO-CIC-IOPE.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  RCO-CAI-IOPE.
                       09  RCO-COD-TOPE
                                    PICTURE X(1).
                       09  RCO-COD-COPE
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  RCO-IIC-IOPE.
                       09  RCO-COD-OOPE.
                       10  RCO-COD-SOPE
                                    PICTURE X(2).
                       10  RCO-IND-SOPE
                                    PICTURE X(1).
                       09  RCO-GLS-NOPE
                                    PICTURE X(5).
      *                             TIME STAMP TRANSACCION
                       05  RCO-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RCO-FEC-FTRN.
                       07  RCO-NUM-STRN
                                    PICTURE 9(2).
                       07  RCO-NUM-ATRN
                                    PICTURE 9(2).
                       07  RCO-NUM-MTRN
                                    PICTURE 9(2).
                       07  RCO-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RCO-HRA-HRTR.
                       07  RCO-NUM-HHTR
                                    PICTURE 9(2).
                       07  RCO-NUM-MMTR
                                    PICTURE 9(2).
                       07  RCO-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  RCO-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RCO-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  RCO-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RCO-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RCO-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  RCO-COD-ATRN PICTURE X(12).
      *                             CODIGO STATUS
                   04  RCO-COD-STAT PICTURE X(3).
      *                             COD RELACION CLIENTE OPERACION
                   04  RCO-COD-RCOP PICTURE X(3).
      *                             NUMERO DE DIRECCION
                   04  RCO-NUM-DIRE PICTURE 9(2).
      *                             PORCENTAJE RELACION
                   04  RCO-VAL-PRCO PICTURE 9(3)V9(6)
                                        COMPUTATIONAL.
      *                             CODIGO CLASE OPERACION
                   04  RCO-COD-COPR.
      *                             CODIGO TIPO OPERACION
                       05  RCO-COD-TOPR
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       05  RCO-COD-AOPR
                                    PICTURE X(3).
      *                             DISPONIBLE
                   04  RCO-GLS-DISP PICTURE X(17).

       01  ELEM-LIST-RCO.
           03 ELEM-1-RCO     PIC X(5) VALUE 'RCO00'.
           03 ELEM-RCO       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************
       01  REQ-AREA-OPE.
           03 OPE-COMMAND          PIC  X(05).
           03 OPE-TABLE            PIC  X(03) VALUE 'OPE'.
           03 OPE-KEY              PIC  X(05) VALUE 'OPE00'.
           03 OPE-RET-COD          PIC  X(02) VALUE SPACES.
           03 OPE-INT-RC           PIC  X(01).
           03 OPE-DB-ID            PIC S9(04) COMP VALUE +100.
           03 OPE-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 OPE-CONT-MAX         PIC S9(04) COMP.
           03 OPE-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 OPE-VAL-KEY          PIC  X(12).

       01  REG-OPE.
      *    COPYDD DGC-R-OPE.DGC-E-OPE00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO OPE
           02  DGC-E-OPE00.
      *                             OPERACIONES
               03  OPE.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  OPE-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  OPE-KEY-IREG.
      *                             IDENTIFICACION OPERACION
                       05  OPE-KEY-IOPE.
      *                             COD. INT. COMP. OPERACION
                       06  OPE-CIC-IOPE.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  OPE-CAI-IOPE.
                       08  OPE-COD-TOPE
                                    PICTURE X(1).
                       08  OPE-COD-COPE
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  OPE-IIC-IOPE.
                       08  OPE-COD-OOPE.
                       09  OPE-COD-SOPE
                                    PICTURE X(2).
                       09  OPE-IND-SOPE
                                    PICTURE X(1).
                       08  OPE-GLS-NOPE
                                    PICTURE X(5).
      *                             TIME STAMP TRANSACCION
                       05  OPE-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  OPE-FEC-FTRN.
                       07  OPE-NUM-STRN
                                    PICTURE 9(2).
                       07  OPE-NUM-ATRN
                                    PICTURE 9(2).
                       07  OPE-NUM-MTRN
                                    PICTURE 9(2).
                       07  OPE-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  OPE-HRA-HRTR.
                       07  OPE-NUM-HHTR
                                    PICTURE 9(2).
                       07  OPE-NUM-MMTR
                                    PICTURE 9(2).
                       07  OPE-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  OPE-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  OPE-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  OPE-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  OPE-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  OPE-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  OPE-COD-ATRN PICTURE X(12).
      *                             CODIGO STATUS
                   04  OPE-COD-STAT PICTURE X(3).
      *                             VALOR DE CAMBIO OPERACION
                   04  OPE-COD-VCOP.
      *                             MISCELANEO TIPO VALOR
                       05  OPE-MSC-TVOP
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       05  OPE-COD-CVOP
                                    PICTURE X(3).
      *                             CODIGO TIPO CAMBIO
                       05  OPE-COD-TCOP
                                    PICTURE X(2).
      *                             CODIGO CLASE OPERACION
                   04  OPE-COD-COPR.
      *                             CODIGO TIPO OPERACION
                       05  OPE-COD-TOPR
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       05  OPE-COD-AOPR
                                    PICTURE X(3).
      *                             CODIGO OFICINA
                   04  OPE-COD-OFOP PICTURE X(3).
      *                             EJECUTIVO
                   04  OPE-COD-EJOP PICTURE X(12).
      *                             FECHA INICIO OPERACION
                   04  OPE-FEC-FIOP.
                       05  OPE-NUM-SIOP
                                    PICTURE 9(2).
                       05  OPE-NUM-AIOP
                                    PICTURE 9(2).
                       05  OPE-NUM-MIOP
                                    PICTURE 9(2).
                       05  OPE-NUM-DIOP
                                    PICTURE 9(2).
      *                             FECHA TERMINO OPERACION
                   04  OPE-FEC-FTOP.
                       05  OPE-NUM-STOP
                                    PICTURE 9(2).
                       05  OPE-NUM-ATOP
                                    PICTURE 9(2).
                       05  OPE-NUM-MTOP
                                    PICTURE 9(2).
                       05  OPE-NUM-DTOP
                                    PICTURE 9(2).
      *                             MOTIVO TERMINO OPERACION
                   04  OPE-COD-MOTT PICTURE X(2).
      *                             FECHA REAPERTURA OPERACION
                   04  OPE-FEC-FROP.
                       05  OPE-NUM-SROP
                                    PICTURE 9(2).
                       05  OPE-NUM-AROP
                                    PICTURE 9(2).
                       05  OPE-NUM-MROP
                                    PICTURE 9(2).
                       05  OPE-NUM-DROP
                                    PICTURE 9(2).
      *                             IND MULTIPLES CLIENTES ( Y, O, ETC)
                   04  OPE-IND-MCLI PICTURE X(2).
      *                             CODIGO TIPO DE COMISION
                   04  OPE-COD-TCOM PICTURE X(2).
      *                             COD. INT. COMP. OPERACION DE CARGO
                   04  OPE-CIC-ICAR.
      *                             CENTRO ASIGNACION OPERACION CARGO
                       05  OPE-CAI-ICAR
                                    PICTURE X(4).
      *                             IDENT. INT. COMP. OPERACION CARGO
                       05  OPE-IIC-ICAR
                                    PICTURE X(8).

       01  ELEM-LIST-OPE.
           03 ELEM-1-OPE     PIC X(5) VALUE 'OPE00'.
           03 ELEM-OPE       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************
       01  REQ-AREA-DBC.
           03 DBC-COMMAND          PIC  X(05).
           03 DBC-TABLE            PIC  X(03) VALUE 'DBC'.
           03 DBC-KEY              PIC  X(05) VALUE 'DBC00'.
           03 DBC-RET-COD          PIC  X(02) VALUE SPACES.
           03 DBC-INT-RC           PIC  X(01).
           03 DBC-DB-ID            PIC S9(04) COMP VALUE +100.
           03 DBC-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 DBC-CONT-MAX         PIC S9(04) COMP.
           03 DBC-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 DBC-VAL-KEY          PIC  X(15).

       01  REG-DBC.
      *    COPYDD DGC-R-DBC.DGC-E-DBC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DBC
           02  DGC-E-DBC00.
      *                             DATOS BASICOS DEL CLIENTE
               03  DBC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DBC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DBC-KEY-IREG.
      *                             IDENTIFICACION DATOS BASICOS CLIENTE
                       05  DBC-KEY-IDBC.
      *                             COD. INT. COMP. CLIENTE
                       06  DBC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DBC-CAI-ICLI.
                       08  DBC-COD-TCLI
                                    PICTURE X(1).
                       08  DBC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DBC-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DBC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DBC-FEC-FTRN.
                       07  DBC-NUM-STRN
                                    PICTURE 9(2).
                       07  DBC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DBC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DBC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DBC-HRA-HRTR.
                       07  DBC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DBC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DBC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DBC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DBC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DBC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DBC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DBC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DBC-COD-ATRN PICTURE X(12).
      *                             KEY RUT CLIENTE + INDICADOR O CALIFI
                   04  DBC-IDC-ICLI.
      *                             RUT CLIENTE
                       05  DBC-NUM-ICLI
                                    PICTURE X(8).
      *                             INDICADOR TIPO RUT
                       05  DBC-IND-ICLI
                                    PICTURE X(1).
      *                             EXTENSION DEL RUT
                       05  DBC-GLS-ICLI
                                    PICTURE X(3).
      *                             KEY DIGITO VERIFICADOR DEL RUT
                   04  DBC-VRF-ICLI PICTURE X(1).
      *                             KEY NOMBRE CLIENTE GENERICO (PERSONA
                   04  DBC-GLS-NOMC.
                       05  DBC-GLS-APAT
                                    PICTURE X(25).
                       05  DBC-GLS-AMAT
                                    PICTURE X(25).
                       05  DBC-GLS-NOMB
                                    PICTURE X(25).
      *                             SOUNDEX DEL NOMBRE DE CLIENTE
                   04  DBC-SNX-NOMC.
                       05  DBC-SNX-APAT
                                    PICTURE X(3).
                       05  DBC-SNX-AMAT
                                    PICTURE X(3).
                       05  DBC-SNX-NOMB
                                    PICTURE X(3).
      *                             NUMERO DE DIRECCION DE ENVIO CORRESP
                   04  DBC-NUM-DCOR PICTURE 9(2).
      *                             OPR IND TIPO CLIENTE ( PERSONA O EMP
                   04  DBC-IND-TICL PICTURE X(1).
      *                             TIPO CLIENTE (POTENCIAL,NO CLIENTE,G
                   04  DBC-COD-TICL PICTURE X(2).
      *                             CODIGO CLASIFICACION COMERCIAL
                   04  DBC-COD-CLCM PICTURE X(2).
      *                             RCM CODIGO DEL EJECUTIVO ENCARGADO D
                   04  DBC-COD-EJEC PICTURE X(12).
      *                             OPR CODIGO DE OFICINA DONDE OPERA EL
                   04  DBC-COD-OFIC PICTURE X(3).
      *                             RCM INDICADOR SI OPERA EN OTRA OFICI
                   04  DBC-IND-OOFI PICTURE X(1).
      *                             EXT CODIGO ACTIVIDAD ECONOMICA
                   04  DBC-COD-ACTI PICTURE X(9).
      *                             EXT ORIGEN Y DESTINO SECT (COMP.INST
                   04  DBC-COD-ODSE PICTURE X(3).
      *                             INF FECHA INGRESO AL PLAN
                   04  DBC-FEC-FPLN.
                       05  DBC-NUM-SPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-APLN
                                    PICTURE 9(2).
                       05  DBC-NUM-MPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-DPLN
                                    PICTURE 9(2).
      *                             CODIGO DE SEGMENTO
                   04  DBC-COD-SETO PICTURE X(5).
      *                             PERIODO DE SEGMENTO (SSAAMM)
                   04  DBC-PDO-SETO PICTURE X(6).
      *                             INF INDICADOR DE MULTAS BANCO CENTRA
                   04  DBC-IND-MUBC PICTURE X(1).
      *                             INF INDICADOR DE JUICIOS BANCO CENTR
                   04  DBC-IND-JUBC PICTURE X(1).
      *                             EXT CODIGO ESTADO CLIENTE ( COMO DEU
                   04  DBC-MSC-SCLI PICTURE X(1).
      *                             FECHA ESTADO CLIENTE
                   04  DBC-FEC-FSCL.
                       05  DBC-NUM-SSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-ASCL
                                    PICTURE 9(2).
                       05  DBC-NUM-MSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-DSCL
                                    PICTURE 9(2).
      *                             CODIGO DE BLOQUEO DEL CLIENTE
                   04  DBC-COD-BLOC PICTURE X(2).
      *                             NUMERO TOTAL DE DIRECCIONES
                   04  DBC-NUM-TDIR PICTURE 9(2).
      *                             NUMERO TOTAL DE COMENTARIOS
                   04  DBC-NUM-TCMT PICTURE 9(3).
      *                             FECHA INICIO OPERACION
                   04  DBC-FEC-FIOP.
                       05  DBC-NUM-SIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-AIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DIOP
                                    PICTURE 9(2).
      *                             FECHA TERMINO OPERACION
                   04  DBC-FEC-FTOP.
                       05  DBC-NUM-STOP
                                    PICTURE 9(2).
                       05  DBC-NUM-ATOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MTOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DTOP
                                    PICTURE 9(2).
      *                             NUMERO OPERACIONES FECHA TERMINO NUL
                   04  DBC-NUM-OFTN PICTURE 9(3).
      *                             FECHA INGRESO DE DATOS A LA BASE DE
                   04  DBC-FEC-FINP.
                       05  DBC-NUM-SINP
                                    PICTURE 9(2).
                       05  DBC-NUM-AINP
                                    PICTURE 9(2).
                       05  DBC-NUM-MINP
                                    PICTURE 9(2).
                       05  DBC-NUM-DINP
                                    PICTURE 9(2).

       01  ELEM-LIST-DBC.
           03 ELEM-1-DBC     PIC X(5) VALUE 'DBC00'.
           03 ELEM-DBC       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************
       01  REQ-AREA-DCP.
           03 DCP-COMMAND          PIC  X(05).
           03 DCP-TABLE            PIC  X(03) VALUE 'DCP'.
           03 DCP-KEY              PIC  X(05) VALUE 'DCP00'.
           03 DCP-RET-COD          PIC  X(02) VALUE SPACES.
           03 DCP-INT-RC           PIC  X(01).
           03 DCP-DB-ID            PIC S9(04) COMP VALUE +100.
           03 DCP-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 DCP-CONT-MAX         PIC S9(04) COMP.
           03 DCP-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 DCP-VAL-KEY          PIC  X(15).

       01  REG-DCP.
      *    COPYDD DGC-R-DCP.DGC-E-DCP00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DCP
           02  DGC-E-DCP00.
      *                             DATOS COMPLEMENTARIOS PERSONAS
               03  DCP.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DCP-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DCP-KEY-IREG.
      *                             ID DATOS COMPLEMENTARIOS PERSONAS
                       05  DCP-KEY-IDCP.
      *                             COD. INT. COMP. CLIENTE
                       06  DCP-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DCP-CAI-ICLI.
                       08  DCP-COD-TCLI
                                    PICTURE X(1).
                       08  DCP-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DCP-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DCP-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DCP-FEC-FTRN.
                       07  DCP-NUM-STRN
                                    PICTURE 9(2).
                       07  DCP-NUM-ATRN
                                    PICTURE 9(2).
                       07  DCP-NUM-MTRN
                                    PICTURE 9(2).
                       07  DCP-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DCP-HRA-HRTR.
                       07  DCP-NUM-HHTR
                                    PICTURE 9(2).
                       07  DCP-NUM-MMTR
                                    PICTURE 9(2).
                       07  DCP-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DCP-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DCP-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DCP-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DCP-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DCP-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DCP-COD-ATRN PICTURE X(12).
      *                             FECHA DE NACIMIENTO
                   04  DCP-FEC-FNAC.
                       05  DCP-NUM-SNAC
                                    PICTURE 9(2).
                       05  DCP-NUM-ANAC
                                    PICTURE 9(2).
                       05  DCP-NUM-MNAC
                                    PICTURE 9(2).
                       05  DCP-NUM-DNAC
                                    PICTURE 9(2).
      *                             CODIGO DEL PAIS DE LA NACIONALIDAD
                   04  DCP-COD-PNAC PICTURE X(3).
      *                             INDICADOR DE SEXO
                   04  DCP-IND-SEXO PICTURE X(1).
      *                             INDICADOR DE ESTADO CIVIL
                   04  DCP-IND-ECIV PICTURE X(3).
      *                             CEDULA DE IDENTIDAD
                   04  DCP-NUM-CIDE PICTURE X(8).
      *                             DIGITO VERIFICADOR CEDULA IDENTIDAD
                   04  DCP-VRF-CIDE PICTURE X(1).
      *                             GABINETE CEDULA DE IDENTIDAD
                   04  DCP-GLS-GABI PICTURE X(12).
      *                             CODIGO TIPO BANCA
                   04  DCP-COD-TBAN PICTURE X(3).
      *                             INDICADOR NIVEL EDUCACIONAL
                   04  DCP-IND-NEDU PICTURE X(3).
      *                             CODIGO DE ACTIVIDAD SECUNDARIA
                   04  DCP-COD-ACTS PICTURE X(9).
      *                             CODIGO DE PROFESION
                   04  DCP-COD-PROF PICTURE X(5).
      *                             INDICADOR DE SITUACION LABORAL
                   04  DCP-IND-SLAB PICTURE X(3).
      *                             CODIGO CATEGORIA SOCIOECONOMICA
                   04  DCP-COD-CSEC PICTURE X(2).
      *                             INDICADOR SITUACION CASA
                   04  DCP-IND-CASA PICTURE X(5).
      *                             # MSJ ASOC A NOMBRE DE PILA (SBT)
                   04  DCP-NUM-NMSG PICTURE 9(4).
      *                             INDICADOR REGIMEN CONYUGAL
                   04  DCP-IND-RCNY PICTURE X(1).
      *                             TIPO PLAN
                   04  DCP-COD-TPLN PICTURE X(1).

       01  ELEM-LIST-DCP.
           03 ELEM-1-DCP     PIC X(5) VALUE 'DCP00'.
           03 ELEM-DCP       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************
       01  REQ-AREA-DCE.
           03 DCE-COMMAND          PIC  X(05).
           03 DCE-TABLE            PIC  X(03) VALUE 'DCE'.
           03 DCE-KEY              PIC  X(05) VALUE 'DCE00'.
           03 DCE-RET-COD          PIC  X(02) VALUE SPACES.
           03 DCE-INT-RC           PIC  X(01).
           03 DCE-DB-ID            PIC S9(04) COMP VALUE +100.
           03 DCE-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 DCE-CONT-MAX         PIC S9(04) COMP.
           03 DCE-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 DCE-VAL-KEY          PIC  X(15).

       01  REG-DCE.
      *    COPYDD DGC-R-DCE.DGC-E-DCE00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DCE
           02  DGC-E-DCE00.
      *                             DATOS COMPLEMENTARIOS EMPRESAS
               03  DCE.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DCE-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DCE-KEY-IREG.
      *                             IDENTIFICACION DATOS COMPLEMENTARIOS
                       05  DCE-KEY-IDCE.
      *                             COD. INT. COMP. CLIENTE
                       06  DCE-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DCE-CAI-ICLI.
                       08  DCE-COD-TCLI
                                    PICTURE X(1).
                       08  DCE-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DCE-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DCE-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DCE-FEC-FTRN.
                       07  DCE-NUM-STRN
                                    PICTURE 9(2).
                       07  DCE-NUM-ATRN
                                    PICTURE 9(2).
                       07  DCE-NUM-MTRN
                                    PICTURE 9(2).
                       07  DCE-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DCE-HRA-HRTR.
                       07  DCE-NUM-HHTR
                                    PICTURE 9(2).
                       07  DCE-NUM-MMTR
                                    PICTURE 9(2).
                       07  DCE-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DCE-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DCE-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DCE-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DCE-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DCE-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DCE-COD-ATRN PICTURE X(12).
      *                             NOMBRE FANTASIA
                   04  DCE-GLS-NFAN PICTURE X(40).
      *                             EXT CODIGO TIPO DE SOCIEDAD
                   04  DCE-COD-TSOC PICTURE X(2).
      *                             FECHA CONSTITUCION EMPRESA
                   04  DCE-FEC-FCTT.
                       05  DCE-NUM-SCTT
                                    PICTURE 9(2).
                       05  DCE-NUM-ACTT
                                    PICTURE 9(2).
                       05  DCE-NUM-MCTT
                                    PICTURE 9(2).
                       05  DCE-NUM-DCTT
                                    PICTURE 9(2).
      *                             FECHA ULTIMA MODIFICACION ESCRITURA
                   04  DCE-FEC-FUME.
                       05  DCE-NUM-SUME
                                    PICTURE 9(2).
                       05  DCE-NUM-AUME
                                    PICTURE 9(2).
                       05  DCE-NUM-MUME
                                    PICTURE 9(2).
                       05  DCE-NUM-DUME
                                    PICTURE 9(2).
      *                             FECHA CADUCIDAD EMPRESA
                   04  DCE-FEC-FCAD.
                       05  DCE-NUM-SCAD
                                    PICTURE 9(2).
                       05  DCE-NUM-ACAD
                                    PICTURE 9(2).
                       05  DCE-NUM-MCAD
                                    PICTURE 9(2).
                       05  DCE-NUM-DCAD
                                    PICTURE 9(2).
      *                             INDICADOR RENOVACION AUTOMATICA ( S/
                   04  DCE-IND-RAUT PICTURE X(1).
      *                             OPR INDICADOR CASA MATRIZ O SUCURSAL
                   04  DCE-IND-CMOS PICTURE X(1).
      *                             EXT INDICADOR CATEGORIA ( COMO DEUDO
                   04  DCE-IND-CATE PICTURE X(3).
      *                             EXT TIPO DE EMPRESA  ( COMO DEUDOR )
                   04  DCE-IND-TEMP PICTURE X(3).
      *                             CODIGO TIPO BANCA
                   04  DCE-COD-TBAN PICTURE X(3).
      *                             TIPO PLAN
                   04  DCE-COD-TPLN PICTURE X(1).
      *                             PAIS DE NACIMIENTO
                   04  DCE-COD-PNAC PICTURE X(3).
      *                             DISPONIBLE
                   04  DCE-GLS-DISP PICTURE X(32).

       01  ELEM-LIST-DCE.
           03 ELEM-1-DCE     PIC X(5) VALUE 'DCE00'.
           03 ELEM-DCE       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************
       01  REQ-AREA-CYA.
           03 CYA-COMMAND          PIC  X(05).
           03 CYA-TABLE            PIC  X(03) VALUE 'CYA'.
           03 CYA-KEY              PIC  X(05) VALUE 'CYA00'.
           03 CYA-RET-COD          PIC  X(02) VALUE SPACES.
           03 CYA-INT-RC           PIC  X(01).
           03 CYA-DB-ID            PIC S9(04) COMP VALUE +160.
           03 CYA-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 CYA-CONT-MAX         PIC S9(04) COMP.
           03 CYA-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 CYA-VAL-KEY.
              05 CYA-VAL-KEY-1     PIC  X(12).
              05 CYA-VAL-KEY-2     PIC  9(03).
              05 CYA-VAL-KEY-3     PIC  9(01).

       01  REG-CYA.
      *    COPYDD COL-R-CYA.COL-E-CYA00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO CYA
           02  COL-E-CYA00.
      *                             CARGOS Y ABONOS
               03  CYA.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CYA-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  CYA-KEY-IREG.
      *                             KEY     IDENTIFICACION CARGOS Y ABON
                       05  CYA-KEY-ICYA.
      *                             IDENTIFICACION CANCELACION
                       06  CYA-KEY-ICAN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  CYA-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  CYA-CAI-IOPC.
                       09  CYA-COD-TOPC
                                    PICTURE X(1).
                       09  CYA-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  CYA-IIC-IOPC.
                       09  CYA-COD-OOPC.
                       10  CYA-COD-SOPC
                                    PICTURE X(2).
                       10  CYA-IND-SOPC
                                    PICTURE X(1).
                       09  CYA-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENT. CANCELACION
                       07  CYA-NUM-ICAN
                                    PICTURE X(3).
      *                             NUMERO IDENTIFICACION CARGO O ABONO
                       06  CYA-NUM-ICYA
                                    PICTURE 9(1).
      *                             TIME STAMP TRANSACCION
                       05  CYA-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CYA-FEC-FTRN.
                       07  CYA-NUM-STRN
                                    PICTURE 9(2).
                       07  CYA-NUM-ATRN
                                    PICTURE 9(2).
                       07  CYA-NUM-MTRN
                                    PICTURE 9(2).
                       07  CYA-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CYA-HRA-HRTR.
                       07  CYA-NUM-HHTR
                                    PICTURE 9(2).
                       07  CYA-NUM-MMTR
                                    PICTURE 9(2).
                       07  CYA-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  CYA-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CYA-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  CYA-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CYA-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CYA-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  CYA-COD-ATRN PICTURE X(12).
      *                             REQ TIPO CARGO Y ABONO
                   04  CYA-IND-TCYA PICTURE X(5).
      *                             REQ COD. INT. COMP. CUENTA CARGO Y A
                   04  CYA-CIC-ICYA.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       05  CYA-CAI-ICYA.
                       06  CYA-COD-TCYA
                                    PICTURE X(1).
                       06  CYA-COD-CCYA
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       05  CYA-IIC-ICYA.
                       06  CYA-COD-OCYA.
                       07  CYA-COD-SCYA
                                    PICTURE X(2).
                       07  CYA-IND-SCYA
                                    PICTURE X(1).
                       06  CYA-GLS-NCYA
                                    PICTURE X(5).
      *                             DIGITO VERIFICADOR CUENTA DE CARGO Y
                   04  CYA-VRF-ICYA PICTURE X(1).
      *                             REQ MONTO CARGO O ABONO
                   04  CYA-SGV-LIQU PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR MOVIMIENTO AUTOMATICO
                   04  CYA-IND-MAUT PICTURE X(1).
      *                             INDICADOR REGISTRO LIBRE
                   04  CYA-IND-FREE PICTURE X(1).
      *                             OFICINA CARGO
                   04  CYA-COD-OFIC PICTURE X(3).
      *                             GLOSA DISPONIBLE
                   04  CYA-GLS-DISP PICTURE X(12).

       01  ELEM-LIST-CYA.
           03 ELEM-1-CYA     PIC X(5) VALUE 'CYA00'.
           03 ELEM-CYA       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************
       01  REQ-AREA-VLR.
           03 VLR-COMMAND          PIC  X(05).
           03 VLR-TABLE            PIC  X(03) VALUE 'TAB'.
           03 VLR-KEY              PIC  X(05) VALUE 'TAB00'.
           03 VLR-RET-COD          PIC  X(02) VALUE SPACES.
           03 VLR-INT-RC           PIC  X(01).
           03 VLR-DB-ID            PIC S9(04) COMP VALUE +150.
           03 VLR-REC-ID           PIC  X(07).
           03 FILLER               PIC  X(25).
           03 VLR-CONT-MAX         PIC S9(04) COMP.
           03 VLR-CONT-IO          PIC S9(04) COMP.
           03 FILLER               PIC  X(22).
           03 VLR-VAL-KEY.
              05 VLR-VAL-KEY-1     PIC  X(03).
              05 VLR-VAL-KEY-2     PIC  X(12).

       01  REG-VLR.
           02  FILLER.
               03  VLR.
                   04  VLR-GLS-FLAG                       PIC X(01).
                   04  VLR-KEY-IREG.
                       05  VLR-COD-TABL.
                           07  VLR-COD-TTAB               PIC X(03).
                           07  VLR-COD-CTAB               PIC X(12).
                       05  VLR-STP-ITRN.
                           07  VLR-FEC-FTRN.
                               09  VLR-NUM-STRN           PIC 9(02).
                               09  VLR-NUM-ATRN           PIC 9(02).
                               09  VLR-NUM-MTRN           PIC 9(02).
                               09  VLR-NUM-DTRN           PIC 9(02).
                           07  VLR-HRA-HRTR.
                               09  VLR-NUM-HHTR           PIC 9(02).
                               09  VLR-NUM-MMTR           PIC 9(02).
                               09  VLR-NUM-SSTR           PIC 9(02).
                   04  VLR-MSC-TACC                       PIC X(01).
                   04  VLR-MSC-STAT                       PIC X(01).
                   04  VLR-IND-VIGE  REDEFINES
                                     VLR-MSC-STAT         PIC X(01).
                   04  VLR-COD-OTRN.
                       05  VLR-MSC-TTRN                   PIC X(01).
                       05  VLR-COD-TTRN                   PIC X(03).
                   04  VLR-COD-ATR                        PIC X(12).
                   04  VLR-CIC-TABL.
                       05  VLR-CIC-TTAB                   PIC X(03).
                       05  VLR-CIC-CTAB                   PIC X(12).
                   04  VLR-EXT-TABL.
                       05  VLR-EXT-TTAB                   PIC X(03).
                       05  VLR-EXT-CTAB                   PIC X(05).
                   04  VLR-GLS-DCOR                       PIC X(12).
                   04  VLR-GLS-ABRV                       PIC X(05).
                   04  VLR-GLS-DESC                       PIC X(40).
                   04  VLR-GLS-DATA.
                       05  VLR-GLS-DAT1.
                           07  VLR-COD-DAT1   OCCURS 10   PIC X(01).
                       05  VLR-GLS-DAT2.
                           07  VLR-COD-DAT2   OCCURS 10   PIC X(02).
                       05  VLR-GLS-DAT3.
                           07  VLR-COD-DAT3   OCCURS 10   PIC X(03).
                   04  VLR-SNX-TABL.
                       05  VLR-SNX-TTAB                   PIC X(03).
                       05  VLR-SNX-CTAB                   PIC X(03).

       01  ELEM-LIST-VLR.
           03 ELEM-1-VLR     PIC X(5) VALUE 'TAB00'.
           03 ELEM-VLR       PIC X(1).
           03 FILLER         PIC X(5) VALUE SPACES.

      ***************************************************************

       PROCEDURE DIVISION.
      *------------------*
           ENTRY 'DBMSCBL'.
           MOVE 'COLPGPAC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM ABRIR-ARCHIVOS.
           PERFORM LEER-PARAMETRO.
           PERFORM CARGA-TABLA-BCA.
           PERFORM GRABA-CABE-PAC.
           MOVE W-FECHA-PAR        TO CAN-VAL-KEY.
           MOVE 'REDKX'            TO CAN-COMMAND.
           PERFORM LEER-CAN.
           IF CAN-RET-COD = SPACES
               PERFORM PROCESO-CAN UNTIL CAN-RET-COD = '14' OR
                             CAN-FEC-FOUT IN CAN NOT = W-PARAMETRO
           END-IF.
           PERFORM GRABA-TRAILER-PAC.
           PERFORM ESTADISTICAS.
           PERFORM CERRAR-ARCHIVOS.
           GOBACK.


       ABRIR-ARCHIVOS.
      *--------------*
           OPEN OUTPUT SALIDA.
           IF FS-PAC NOT = 0
              DISPLAY ' ERROR AL ABRIR SALIDA F.S. : '
                     FS-PAC
              DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
              MOVE 100 TO RETURN-CODE
              GOBACK
           END-IF.


       CERRAR-ARCHIVOS.
      *---------------*
           CLOSE SALIDA.
           IF FS-PAC NOT = 0
              DISPLAY ' ERROR AL CERRAR SALIDA F.S. : '
                     FS-PAC
              DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
              MOVE 100 TO RETURN-CODE
              GOBACK
           END-IF.


       GRABA-CABE-PAC.
      *--------------*
           MOVE 096858050   TO PAC-NUM-EMPR.
           MOVE '7'         TO PAC-VRF-EMPR.
           MOVE 'NORMALIZA' TO PAC-GLS-NOME.
           MOVE W-SIG-PAR   TO PAC-NUM-SEMI.
           MOVE W-ANO-PAR   TO PAC-NUM-AEMI.
           MOVE W-MES-PAR   TO PAC-NUM-MEMI.
           MOVE W-DIA-PAR   TO PAC-NUM-DEMI.

           MOVE SPACES TO REG-PAC.
           MOVE PAC-CABE TO REG-PAC.
           WRITE PAC.
           IF FS-PAC NOT = 0
               DISPLAY 'ERROR AL GRABAR ARCHIVO PAC: ' FS-PAC
               DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
               PERFORM CERRAR-ARCHIVOS
               MOVE 100 TO RETURN-CODE
               GOBACK
           END-IF.


      * ESTA FECHA DE PARAMETRO SE UTILIZA PARA GRABARLA EN EL ARCHIVO
      * PAC COMO FECHA DE PAGO Y PARA CALCULAR VALOR DE CAMBIO
      * SI MONEDA DE COBRO NO ES EN PESOS
       LEER-PARAMETRO.
      *--------------*
           ACCEPT W-PARAMETRO.
           MOVE 'INFO'          TO CALEAREA-FUNCION.
           MOVE  W-SIG-PAR      TO CALEAREA-FECHA-1-AM.
           MOVE  W-ANO-PAR      TO CALEAREA-FECHA-1-AA.
           MOVE  W-MES-PAR      TO CALEAREA-FECHA-1-M.
           MOVE  W-DIA-PAR      TO CALEAREA-FECHA-1-D.
           CALL 'RUTUCALE' USING RTNWCALE.
           IF CALEAREA-COD-RET = 0
              DISPLAY 'PARAMETRO : ' W-PARAMETRO
           ELSE
              DISPLAY 'ERROR EN FECHA DE PARAMETRO : ' W-PARAMETRO
              DISPLAY 'AL LEER RUTINA FECHA, COD-RET. : '
                    CALEAREA-COD-RET
              DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
              MOVE 100 TO RETURN-CODE
              GOBACK
           END-IF.

      * BUSCA DIA HABIL SIGUIENTE PARA GRABAR LOS REGISTROS DE
      * DETALLE EN ARCHIVO PAC
           MOVE 'BDHS' TO CALEAREA-FUNCION.
           PERFORM CALL-RUTUCALE.
           IF CALEAREA-COD-RET NOT = 0
               DISPLAY 'ERROR EN RUTINA RUTUCALE: '
                         CALEAREA-COD-RET ' ' CALEAREA-FUNCION
               DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
               MOVE 100 TO RETURN-CODE
               GOBACK
           END-IF.

           MOVE CALEAREA-FECHA-2-D  TO W-DIA-PAC.
           MOVE CALEAREA-FECHA-2-M  TO W-MES-PAC.
           MOVE CALEAREA-FECHA-2-AM TO W-SIG-PAC.
           MOVE CALEAREA-FECHA-2-AA TO W-ANO-PAC.

           MOVE 'COL'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'PCP'               TO TAB-COD-TTAB IN TAB.
           MOVE 'TIO         '      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DATA IN TAB TO WS-GLS-DATA-TIOS
           ELSE
               DISPLAY 'ERROR LECTURA TABLA COLPCP'
               DISPLAY 'PARA CODIGO TIO'
               DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
               PERFORM CERRAR-ARCHIVOS
               MOVE 100 TO RETURN-CODE
               GOBACK
           END-IF.


       LEER-VLR.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-VLR REG-VLR ELEM-LIST-VLR
           IF VLR-RET-COD = SPACES
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA VLR : ' VLR-RET-COD
              DISPLAY 'LLAVE           : ' VLR-VAL-KEY-2
              DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
              MOVE 100 TO RETURN-CODE
              PERFORM CERRAR-ARCHIVOS
              GOBACK
           END-IF.


       LEER-CAN.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-CAN REG-CAN ELEM-LIST-CAN.
           IF CAN-RET-COD = SPACES OR = '14'
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA CAN : ' CAN-RET-COD
              DISPLAY 'LLAVE           : ' CAN-VAL-KEY
           END-IF.


       LEER-RDC.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-RDC REG-RDC ELEM-LIST-RDC.
           IF RDC-RET-COD = SPACES
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA RDC : ' RDC-RET-COD
              DISPLAY 'LLAVE           : ' CAN-CIC-IOPC IN CAN
           END-IF.


       LEER-ROV.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-ROV REG-ROV ELEM-LIST-ROV.
           IF ROV-RET-COD = SPACES
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA RDC : ' ROV-RET-COD
              DISPLAY 'LLAVE           : ' CAN-CIC-IOPC IN CAN
           END-IF.


       LEER-RCO.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-RCO REG-RCO ELEM-LIST-RCO.
           IF RCO-RET-COD = SPACES
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA RCO : ' RCO-RET-COD
              DISPLAY 'LLAVE           : ' RDC-CIC-ICLI IN RDC
           END-IF.


       LEER-OPE.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-OPE REG-OPE ELEM-LIST-OPE.
           IF OPE-RET-COD = SPACES
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA OPE : ' OPE-RET-COD
              DISPLAY 'LLAVE           : ' RCO-VAL-KEY-2
           END-IF.


       LEER-DBC.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-DBC REG-DBC ELEM-LIST-DBC.
           IF DBC-RET-COD = SPACES
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA DBC : ' DBC-RET-COD
              DISPLAY 'LLAVE           : ' RDC-CIC-ICLI IN RDC
           END-IF.


       LEER-DCP.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-DCP REG-DCP ELEM-LIST-DCP
           IF DCP-RET-COD = SPACES
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA DCP : ' DCP-RET-COD
              DISPLAY 'LLAVE           : ' DBC-CIC-ICLI IN DBC
           END-IF.


       LEER-DCE.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-DCE REG-DCE ELEM-LIST-DCE
           IF DCE-RET-COD = SPACES
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA DCE : ' DCE-RET-COD
              DISPLAY 'LLAVE           : ' DBC-CIC-ICLI IN DBC
           END-IF.


       LEER-CYA.
      *--------*
           CALL 'DBNTRY' USING UIB REQ-AREA-CYA REG-CYA ELEM-LIST-CYA.
           IF CYA-RET-COD = SPACES
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR AL LEER TABLA CYA : ' CYA-RET-COD
              DISPLAY 'LLAVE           : ' CAN-KEY-ICAN IN CAN
           END-IF.


       VAL-ANEXOS-BCA.
      *--------------*
           IF WS-SGV-MMIN IS NOT NUMERIC
               DISPLAY 'PORCENTAJE MINIMO NO NUMERICO: ' WS-SGV-MMIN
               MOVE 1 TO WS-VAL-DATOS
           END-IF.

           IF WS-NUM-DIMC IS NOT NUMERIC
               DISPLAY 'DIAS DE INICIO MORA NO NUMERICO: '
                                                     WS-NUM-DIMC
               MOVE 1 TO WS-VAL-DATOS
           END-IF.

           IF WS-IND-TDMC NOT = 'H' AND 'C'
               DISPLAY 'INDICADOR DIA HABIL O CORRIDO (H/C) INVALIDO: '
                                                         WS-IND-TDMC
               MOVE 1 TO WS-VAL-DATOS
           END-IF.

           IF WS-GLS-MONE NOT > SPACES
               DISPLAY 'MONEDA DEL COBRO INVALIDA: ' WS-GLS-MONE
               MOVE 1 TO WS-VAL-DATOS
           ELSE
               PERFORM VAL-MONEDA-BCA
           END-IF.


       VAL-MONEDA-BCA.
      *--------------*
           MOVE 'VLR' TO VLR-VAL-KEY-1.
           MOVE WS-GLS-MONE TO VLR-VAL-KEY-2.
           MOVE 'REDKX' TO VLR-COMMAND.
           PERFORM LEER-VLR.
           IF VLR-IND-VIGE IN VLR NOT = 'S'
               MOVE 1 TO WS-VAL-DATOS
           END-IF.


       BUSCAR-TIPO-CAMBIO.
      *------------------*
           IF WS-GLS-MONE = '0999  '
              MOVE 1 TO WS-SGV-VCAM
           ELSE
             MOVE W-FECHA-PAR TO CAM-FEC-FCAM IN CAM(1)
                                 CAM-FEC-FCAM IN CAM(2)
             MOVE WS-GLS-MONE TO CAM-COD-VCAM IN CAM(1)
             MOVE '0999  '    TO CAM-COD-VCAM IN CAM(2)
             MOVE FIO-GET-KEY TO FIO-CMND
             PERFORM TAB-FIO-CAM
             IF FIO-STAT-OKS
                MOVE CAM-SGV-VCAM IN CAM TO WS-SGV-VCAM
             ELSE
             IF FIO-STAT = '14'
                DISPLAY 'NO EXISTE REGISTRO EN TABLA CAM : ' FIO-STAT
                DISPLAY 'LLAVE           : ' CAM-KEY-CAMB
                DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
                PERFORM CERRAR-ARCHIVOS
                MOVE 100 TO RETURN-CODE
                GOBACK
             ELSE
                DISPLAY 'ERROR AL LEER TABLA CAM : ' FIO-STAT
                DISPLAY 'LLAVE           : ' CAM-KEY-CAMB
                DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
                PERFORM CERRAR-ARCHIVOS
                MOVE 100 TO RETURN-CODE
                GOBACK
             END-IF
             END-IF
           END-IF.


       CARGA-TABLA-BCA.
      *---------------*
           MOVE 'COL'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'BCA'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              'BCA' = TAB-COD-TTAB IN TAB AND
              TAB-IND-VIGE IN TAB = 'S'
               PERFORM REDNX-BCA UNTIL ('BCA' NOT = TAB-COD-TTAB OR
                                 FIO-STAT = '14' OR WL-BCA = 100)
               DISPLAY 'BANCAS GUARDADAS EN MEMORIA: ' WL-BCA
           ELSE
               DISPLAY 'ERROR LECTURA TABLA COLBCA'
               DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
               PERFORM CERRAR-ARCHIVOS
               MOVE 100 TO RETURN-CODE
               GOBACK
           END-IF.


       REDNX-BCA.
      *---------*
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              'BCA' = TAB-COD-TTAB IN TAB AND TAB-IND-VIGE = 'S'
               ADD 1 TO WL-BCA
               MOVE TAB-COD-CTAB IN TAB TO WS-COD-BANCA(WL-BCA)
               MOVE TAB-GLS-DATA IN TAB TO WS-GLS-DATA(WL-BCA)
           END-IF.


      * NO SE DEBEN PROCESAR LAS CAN NO ACTIVAS NI LAS QUE SE
      * GENERARON POR TRASPASO A VENCIDA, CASTIGO O CASTIGO VISA.
       PROCESO-CAN.
      *-----------*
           IF CAN-RET-COD = SPACES
               ADD 1 TO WL-CAN
           END-IF.

           MOVE CAN-CIC-IOPC IN CAN TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC
                                       WL-EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           PERFORM CAL-NUM-FO-EVC UNTIL
                                    (NOT FIO-STAT-OKS OR
                                     CAN-CIC-IOPC NOT = EVC-CIC-IOPC OR
                                     WL-EVC > 1).

           IF WL-EVC NOT > 1 AND
              CAN-RET-COD = SPACES AND
              CAN-MSC-STAT IN CAN = 'A' AND
              CAN-COD-ATRN IN CAN NOT = 'COLPBVCD' AND
              CAN-COD-ATRN IN CAN NOT = 'COLPBCAS' AND
              CAN-COD-ATRN IN CAN NOT = 'COLPBTCV' AND
             (CAN-SGV-TPAG IN CAN > ZEROES OR
              CAN-SGV-TREN IN CAN > ZEROES)
               MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
                 MOVE CAN-KEY-ICAN IN CAN TO RCV-KEY-ICAN IN RCV
                 MOVE SPACES              TO RCV-KEY-IVCT IN RCV
                 MOVE FIO-GET-NLS TO FIO-CMND
                 PERFORM COL-FIO-RCV
                 IF FIO-STAT-OKS AND
                   RCV-KEY-ICAN IN RCV = CAN-KEY-ICAN IN CAN
                    IF RCV-NUM-IVCT IN RCV NOT = ZEROES
                       MOVE RCV-NUM-IVCT IN RCV TO VEN-NUM-IVEN IN VEN
                    ELSE
                       MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
                    END-IF
                    IF OPC-IND-VSTR IN OPC = 'S'
                       MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM COL-OBT-VEN
                       IF VEN-STAT-OKS
                           MOVE '00' TO FIO-STAT
                       ELSE
                           MOVE '14' TO FIO-STAT
                       END-IF
                    ELSE
                       MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM COL-FIO-VEN
                    END-IF
                    IF FIO-STAT-OKS AND
                      VEN-CIC-IOPC IN VEN = CAN-CIC-IOPC IN CAN AND
                      VEN-FEC-FVEN IN VEN < CAN-FEC-FOUT IN CAN
                       MOVE CAN-CIC-IOPC TO DLC-CIC-IOPC IN DLC
                       MOVE ZEROES       TO DLC-NUM-IDLC IN DLC
                       MOVE FIO-GET-NLS TO FIO-CMND
                       PERFORM COL-FIO-DLC
                       IF NOT (FIO-STAT-OKS AND
                          DLC-CIC-IOPC IN DLC = CAN-CIC-IOPC IN CAN)
                           ADD 1 TO WN-CAN
                       ELSE
                       IF DLC-IND-SCTB IN DLC = 'CAS' OR
                         (DLC-IND-SCTB IN DLC = 'VCD' AND
                          DLC-IND-SCBZ IN DLC = 'JUDIC')
                           ADD 1 TO WN-CAN
                       ELSE
                       IF FIO-STAT-OKS AND
                          DLC-CIC-IOPC IN DLC = CAN-CIC-IOPC AND
                          DLC-IND-SCTB IN DLC = 'VCD' AND
                          DLC-IND-SCBZ IN DLC = SPACES
                           PERFORM LEER-ROV-DLC
                           IF WS-VCD = 1
                               ADD 1 TO WN-CAN
                           ELSE
                               PERFORM VALIDA-COBRO
                           END-IF
                       ELSE
                           PERFORM VALIDA-COBRO
                       END-IF
                       END-IF
                       END-IF
                    ELSE
                    IF NOT FIO-STAT-OKS OR
                      VEN-CIC-IOPC IN VEN NOT = CAN-CIC-IOPC IN CAN
                       DISPLAY 'ERROR AL LEER TABLA VEN : '
                                                  FIO-STAT
                               '  LLAVE : '
                                          CAN-KEY-ICAN IN CAN
                       ADD 1 TO WN-CAN
                    ELSE
                       ADD 1 TO WN-CAN
                    END-IF
                    END-IF
                 ELSE
                   DISPLAY 'ERROR LECTURA TABLA COLRCV: '
                                    CAN-KEY-ICAN IN CAN
                   ADD 1 TO WN-CAN
                 END-IF
               ELSE
                   DISPLAY 'ERROR LECTURA TABLA COLOPC: '
                                      CAN-CIC-IOPC IN CAN
                   ADD 1 TO WN-CAN
               END-IF
           ELSE
               ADD 1 TO WN-CAN
           END-IF.

           MOVE W-FECHA-PAR TO CAN-VAL-KEY.
           MOVE 'REDNX' TO CAN-COMMAND.
           PERFORM LEER-CAN.


       CAL-NUM-FO-EVC.
      *--------------*
           IF EVC-MSC-TCVE = 'FO'
               ADD 1 TO WL-EVC
           END-IF.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-EVC.


       VALIDA-COBRO.
      *------------*
           MOVE 0 TO WS-CONSUMO.

           PERFORM VAL-TIPO-OPC VARYING I FROM 1 BY 1 UNTIL
                               (WS-CONSUMO = 1 OR I > 20 OR
                                    WS-GLS-TIO(I) = SPACES).
           IF WS-CONSUMO = 1
               PERFORM VALIDA-BANCA-CLIENTE
               IF WS-TBAN = 1
                   MOVE 0 TO WS-PLAN
                   PERFORM VAL-TIPO-PLAN VARYING J FROM 1 BY 1
                                 UNTIL (WS-PLAN = 1 OR J = 45 OR
                                        WS-COD-PLAN(J) = SPACES)
                   IF WS-PLAN = 1
                       PERFORM CALCULA-MORA-ESPECIAL
                   ELSE
                       PERFORM CALCULA-MORA
                   END-IF
                   IF W-FEC-FVEN NOT > CAN-FEC-FOUT IN CAN AND
                      CALEAREA-COD-RET = 0
                       PERFORM OBT-CTA-CTE
                       IF WS-CTA-CTE = 1
                           PERFORM CALCULA-PORCENTAJE
                           IF WS-PORC = 1 AND
                              CALEAREA-COD-RET = 0
                               PERFORM GRABA-DETA-PAC
                               MOVE 0 TO WS-TBAN WS-PORC
                           ELSE
                           IF WS-PORC = 0
                               ADD 1 TO WN-CAN
                           END-IF
                           END-IF
                       ELSE
                           ADD 1 TO WN-CAN
                       END-IF
                   ELSE
                   IF CALEAREA-COD-RET = 0
                       ADD 1 TO WN-CAN
                   END-IF
                   END-IF
               ELSE
                   ADD 1 TO WN-CAN
               END-IF
           ELSE
               ADD 1 TO WN-CAN
           END-IF.


       LEER-ROV-DLC.
      *------------*
           MOVE 0 TO WS-VCD.
           MOVE LOW-VALUE           TO ROV-VAL-KEY.
           MOVE CAN-CIC-IOPC IN CAN TO ROV-VAL-KEY-1.
           MOVE CAN-NUM-ICAN IN CAN TO ROV-VAL-KEY-2.
           MOVE 'REDKG' TO ROV-COMMAND.
           PERFORM LEER-ROV.
           IF ROV-RET-COD = SPACES AND
              ROV-VAL-KEY-1 = CAN-CIC-IOPC IN CAN AND
              ROV-VAL-KEY-2 = CAN-NUM-ICAN IN CAN
               MOVE DLC-KEY-IDLC IN DLC TO WS-KEY-IDLC
               MOVE ROV-CIC-IOPC IN ROV TO DLC-CIC-IOPC IN DLC
               MOVE ZEROES              TO DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF NOT (FIO-STAT-OKS AND
                  DLC-CIC-IOPC IN DLC = ROV-CIC-IOPC IN ROV AND
                  DLC-IND-SCTB IN DLC NOT = 'VCD')
                   MOVE 1 TO WS-VCD
               END-IF
           ELSE
               MOVE 1 TO WS-VCD
           END-IF.

           MOVE WS-KEY-IDLC TO DLC-KEY-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WS-VCD.


       CALCULA-PORCENTAJE.
      *------------------*
           MOVE 0 TO WS-PORC.

           MOVE 'CDCEF' TO CALEAREA-FUNCION.

           MOVE VEN-NUM-DVEN IN VEN TO CALEAREA-FECHA-1-D.
           MOVE VEN-NUM-MVEN IN VEN TO CALEAREA-FECHA-1-M.
           MOVE VEN-NUM-SVEN IN VEN TO CALEAREA-FECHA-1-AM.
           MOVE VEN-NUM-AVEN IN VEN TO CALEAREA-FECHA-1-AA.

           MOVE CAN-NUM-DOUT IN CAN TO CALEAREA-FECHA-2-D.
           MOVE CAN-NUM-MOUT IN CAN TO CALEAREA-FECHA-2-M.
           MOVE CAN-NUM-SOUT IN CAN TO CALEAREA-FECHA-2-AM.
           MOVE CAN-NUM-AOUT IN CAN TO CALEAREA-FECHA-2-AA.

           PERFORM CALL-RUTUCALE.
           IF CALEAREA-COD-RET = 0
               MOVE CALEAREA-NUM-DIA TO WS-NUM-DIA
               MOVE WS-NUM-DIA TO WS-DIF-DIAS
               IF DBC-IND-TICL IN DBC = 'P'
                   MOVE DCP-COD-TBAN IN DCP TO WS-COD-TBAN
               ELSE
                   MOVE DCE-COD-TBAN IN DCE TO WS-COD-TBAN
               END-IF

               PERFORM VAL-TRAMO-BANCA VARYING I FROM 1 BY 1 UNTIL
                      (WS-PORC = 1 OR I > WL-BCA)

               IF WS-PORC = 1
                   COMPUTE WS-SGV-CALC ROUNDED = WS-SGV-PORC *
                                         CAN-SGV-TPAG IN CAN / 100
               END-IF
           END-IF.


       VAL-TRAMO-BANCA.
      *---------------*
           IF WS-COD-BANCA(I) > WS-VAL-KEY
               MOVE WS-GLS-DATA(I) TO WS-GLS-DATA-PORC
               MOVE 1 TO WS-PORC
           END-IF.


       BUS-COD-CARGO.
      *-------------*
           MOVE LOW-VALUE           TO CYA-VAL-KEY.
           MOVE CAN-CIC-IOPC IN CAN TO CYA-VAL-KEY-1.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-VAL-KEY-2.
           MOVE ZEROES              TO CYA-VAL-KEY-3.
           MOVE 'REDKG' TO CYA-COMMAND.
           PERFORM LEER-CYA.
           IF CYA-RET-COD = SPACES AND
              CYA-VAL-KEY-1 = CAN-CIC-IOPC IN CAN AND
              CYA-VAL-KEY-2 = CAN-NUM-ICAN IN CAN
               MOVE 'MSC'               TO MSC-COD-TTAB IN MSC
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF FIO-STAT-OKS
                   MOVE MSC-CIC-CMSC IN MSC TO WS-TIPO-CARGO
               ELSE
                   MOVE SPACES TO WS-TIPO-CARGO
               END-IF
           ELSE
               MOVE SPACES TO WS-TIPO-CARGO
           END-IF.


       CALCULA-MORA-ESPECIAL.
      *---------------------*
           IF WS-IND-TDME = 'H'
               MOVE 'AVNDH' TO CALEAREA-FUNCION
           ELSE
               MOVE 'AVNDC' TO CALEAREA-FUNCION
           END-IF.

           MOVE VEN-NUM-DVEN IN VEN TO CALEAREA-FECHA-1-D.
           MOVE VEN-NUM-MVEN IN VEN TO CALEAREA-FECHA-1-M.
           MOVE VEN-NUM-SVEN IN VEN TO CALEAREA-FECHA-1-AM.
           MOVE VEN-NUM-AVEN IN VEN TO CALEAREA-FECHA-1-AA.

           MOVE WS-NUM-DIME         TO CALEAREA-NUM-DIA.

           PERFORM CALL-RUTUCALE.
           IF CALEAREA-COD-RET = 0
               MOVE CALEAREA-FECHA-2-D  TO W-DIA-VEN
               MOVE CALEAREA-FECHA-2-M  TO W-MES-VEN
               MOVE CALEAREA-FECHA-2-AM TO W-SIG-VEN
               MOVE CALEAREA-FECHA-2-AA TO W-ANO-VEN
           END-IF.


       CALCULA-MORA.
      *------------*
           IF WS-IND-TDMC = 'H'
               MOVE 'AVNDH' TO CALEAREA-FUNCION
           ELSE
               MOVE 'AVNDC' TO CALEAREA-FUNCION
           END-IF.

           MOVE VEN-NUM-DVEN IN VEN TO CALEAREA-FECHA-1-D.
           MOVE VEN-NUM-MVEN IN VEN TO CALEAREA-FECHA-1-M.
           MOVE VEN-NUM-SVEN IN VEN TO CALEAREA-FECHA-1-AM.
           MOVE VEN-NUM-AVEN IN VEN TO CALEAREA-FECHA-1-AA.

           MOVE WS-NUM-DIMC         TO CALEAREA-NUM-DIA.

           PERFORM CALL-RUTUCALE.
           IF CALEAREA-COD-RET = 0
               MOVE CALEAREA-FECHA-2-D  TO W-DIA-VEN
               MOVE CALEAREA-FECHA-2-M  TO W-MES-VEN
               MOVE CALEAREA-FECHA-2-AM TO W-SIG-VEN
               MOVE CALEAREA-FECHA-2-AA TO W-ANO-VEN
           END-IF.


       CALL-RUTUCALE.
      *-------------*
           CALL 'RUTUCALE' USING RTNWCALE.
           IF CALEAREA-COD-RET = 0
              NEXT SENTENCE
           ELSE
              DISPLAY 'ERROR EN RUTINA RUTUCALE: '
                       CALEAREA-COD-RET ' ' CALEAREA-FUNCION
                       ' ' CAN-KEY-ICAN IN CAN
           END-IF.


       VAL-TIPO-OPC.
      *------------*
           IF WS-GLS-TIO(I) = OPC-COD-TOOC IN OPC
               MOVE 1 TO WS-CONSUMO
           END-IF.


       OBT-CTA-CTE.
      *-----------*
           MOVE 0 TO WS-CTA-CTE.
           MOVE ZEROES TO WS-NUM-CTAC.

           PERFORM BUS-COD-CARGO.
           IF WS-TIPO-CARGO NOT = 'CC'
               MOVE LOW-VALUE TO RCO-VAL-KEY
               MOVE RDC-CIC-ICLI IN RDC TO RCO-VAL-KEY-1
               MOVE 'REDKG' TO RCO-COMMAND
               PERFORM LEER-RCO
               IF RCO-RET-COD = SPACES AND
                  RCO-VAL-KEY-1 = RDC-CIC-ICLI IN RDC
                   PERFORM REC-RCO UNTIL (RCO-RET-COD NOT = SPACES OR
                           RCO-VAL-KEY-1 NOT = RDC-CIC-ICLI IN RDC OR
                                                      WS-CTA-CTE = 1)
               END-IF
           ELSE
               MOVE CYA-CIC-ICYA IN CYA TO WS-NUM-CTAC
               MOVE 1 TO WS-CTA-CTE
           END-IF.


       REC-RCO.
      *-------*
           MOVE RCO-VAL-KEY-2 TO OPE-VAL-KEY
           MOVE 'REDKX' TO OPE-COMMAND
           PERFORM LEER-OPE
           IF OPE-RET-COD = SPACES AND
              OPE-COD-STAT IN OPE = 'VIG'
               MOVE OPE-VAL-KEY TO WS-NUM-CTAC
               MOVE 1 TO WS-CTA-CTE
           ELSE
               MOVE 0 TO WS-CTA-CTE
           END-IF.

           MOVE 'REDNX' TO RCO-COMMAND.
           PERFORM LEER-RCO.


       VALIDA-BANCA-CLIENTE.
      *--------------------*
           MOVE 0 TO WS-TBAN.
           MOVE 1 TO I.
           MOVE LOW-VALUE TO RDC-VAL-KEY.
           MOVE CAN-CIC-IOPC IN CAN TO RDC-VAL-KEY-1.
           MOVE 'REDKG' TO RDC-COMMAND.
           PERFORM LEER-RDC.
           IF RDC-RET-COD = SPACES AND
              RDC-VAL-KEY-1 = CAN-CIC-IOPC IN CAN
               MOVE RDC-CIC-ICLI IN RDC TO DBC-VAL-KEY
               MOVE 'REDKX' TO DBC-COMMAND
               PERFORM LEER-DBC
               IF DBC-RET-COD = SPACES AND
                  DBC-IND-TICL = 'P'
                   MOVE DBC-CIC-ICLI IN DBC TO DCP-VAL-KEY
                   MOVE 'REDKX' TO DCP-COMMAND
                   PERFORM LEER-DCP
                   MOVE DCP-COD-TBAN IN DCP TO WS-COD-TBAN
                   MOVE SPACES              TO WS-DIF-DIAS
                   PERFORM VAL-TIPO-BANCA VARYING I FROM 1 BY 1 UNTIL
                                        (WS-TBAN = 1 OR I > WL-BCA OR
                                            DCP-RET-COD NOT = SPACES)
                   IF WS-TBAN = 1 AND
                      DCP-RET-COD = SPACES
                       PERFORM VAL-ANEXOS-BCA
                       IF WS-VAL-DATOS = 1
                           DISPLAY '** SE CANCELA PROGRAMA COLPGPAC **'
                           PERFORM CERRAR-ARCHIVOS
                           MOVE 100 TO RETURN-CODE
                           GOBACK
                       ELSE
                           PERFORM BUSCAR-TIPO-CAMBIO
                           COMPUTE WS-PORC-MIN ROUNDED =
                                            WS-SGV-MMIN * WS-SGV-VCAM
                           COMPUTE WS-PORC-MAX ROUNDED =
                                            WS-SGV-MMAX * WS-SGV-VCAM
                       END-IF
                   ELSE
                   IF DCP-RET-COD NOT = SPACES
                       DISPLAY 'ERROR LECTURA SGCDCP: ' DCP-RET-COD
                               ' CANCELACION: '
                                            CAN-KEY-ICAN IN CAN
                       MOVE 0 TO WS-TBAN
                   ELSE
                       MOVE 0 TO WS-TBAN
                   END-IF
                   END-IF
               ELSE
               IF DBC-RET-COD = SPACES AND
                  DBC-IND-TICL IN DBC = 'E'
                   MOVE DBC-CIC-ICLI IN DBC TO DCE-VAL-KEY
                   MOVE 'REDKX' TO DCE-COMMAND
                   PERFORM LEER-DCE
                   MOVE DCE-COD-TBAN IN DCE TO WS-COD-TBAN
                   MOVE SPACES              TO WS-DIF-DIAS
                   PERFORM VAL-TIPO-BANCA VARYING I FROM 1 BY 1 UNTIL
                                        (WS-TBAN = 1 OR I > WL-BCA OR
                                            DCE-RET-COD NOT = SPACES)
                   IF WS-TBAN = 1 AND
                      DCE-RET-COD = SPACES
                       PERFORM VAL-ANEXOS-BCA
                       IF WS-VAL-DATOS = 1
                           DISPLAY '** SE CANCELA PROGRAMA COLPGPAC **'
                           PERFORM CERRAR-ARCHIVOS
                           MOVE 100 TO RETURN-CODE
                           GOBACK
                       ELSE
                           PERFORM BUSCAR-TIPO-CAMBIO
                           COMPUTE WS-PORC-MIN ROUNDED =
                                            WS-SGV-MMIN * WS-SGV-VCAM
                           COMPUTE WS-PORC-MAX ROUNDED =
                                            WS-SGV-MMAX * WS-SGV-VCAM
                       END-IF
                   ELSE
                   IF DCE-RET-COD NOT = SPACES
                       DISPLAY 'ERROR LECTURA SGCDCE: ' DCE-RET-COD
                               ' CANCELACION: '
                                            CAN-KEY-ICAN IN CAN
                       MOVE 0 TO WS-TBAN
                   ELSE
                       MOVE 0 TO WS-TBAN
                   END-IF
                   END-IF
               ELSE
                   MOVE 0 TO WS-TBAN
               END-IF
               END-IF
           ELSE
               DISPLAY 'ERROR AL LEER TABLA RDC : ' RDC-RET-COD
                       ' CANCELACION: ' CAN-KEY-ICAN IN CAN
               MOVE 0 TO WS-TBAN
           END-IF.


       VAL-TIPO-BANCA.
      *--------------*
           IF WS-COD-BANCA(I) = WS-VAL-KEY
               MOVE WS-GLS-DATA(I) TO WS-GLS-DATA-BANCA
               MOVE 1 TO WS-TBAN
           END-IF.


       VAL-TIPO-PLAN.
      *-------------*
           IF DBC-IND-TICL IN DBC = 'P'
               IF DCP-COD-TPLN IN DCP = WS-COD-PLAN(J)
                   MOVE 1 TO WS-PLAN
               END-IF
           ELSE
               IF DCE-COD-TPLN IN DCE = WS-COD-PLAN(J)
                   MOVE 1 TO WS-PLAN
               END-IF
           END-IF.


       GRABA-DETA-PAC.
      *--------------*
           IF WS-SGV-CALC > WS-PORC-MAX
               MOVE WS-PORC-MAX     TO PAC-SGV-TPAG
           ELSE
               MOVE WS-SGV-CALC     TO PAC-SGV-TPAG
           END-IF.

           IF PAC-SGV-TPAG < WS-PORC-MIN
               MOVE WS-PORC-MIN     TO PAC-SGV-TPAG
           END-IF.

           ADD PAC-SGV-TPAG         TO WS-SGV-TCOM.

           ADD 1                    TO PAC-NUM-CORR.
           MOVE DBC-NUM-ICLI IN DBC TO PAC-NUM-ICLI.
           MOVE DBC-VRF-ICLI IN DBC TO PAC-VRF-ICLI.
           MOVE CAN-CIC-IOPC IN CAN TO PAC-COD-IDCL.
           MOVE ZEROES              TO PAC-NUM-BOFA.
           MOVE CAN-NUM-ICAN IN CAN TO PAC-NUM-ICAN.

           MOVE W-SIG-PAC           TO PAC-NUM-SPAG.
           MOVE W-ANO-PAC           TO PAC-NUM-APAG.
           MOVE W-MES-PAC           TO PAC-NUM-MPAG.
           MOVE W-DIA-PAC           TO PAC-NUM-DPAG.
           MOVE WS-NUM-CTAC         TO PAC-NUM-CTAC.

           MOVE PAC-DETA TO REG-PAC.
           WRITE PAC.
           IF FS-PAC = 0
               ADD 1 TO WD-PAC
           ELSE
               DISPLAY 'ERROR AL GRABAR ARCHIVO PAC: ' FS-PAC
               DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
               PERFORM CERRAR-ARCHIVOS
               MOVE 100 TO RETURN-CODE
               GOBACK
           END-IF.


       GRABA-TRAILER-PAC.
      *-----------------*
           MOVE WD-PAC         TO PAC-NUM-REGT.
           MOVE WS-SGV-TCOM    TO PAC-SGV-PAGT.

           MOVE PAC-TRAI TO REG-PAC.
           WRITE PAC.
           IF FS-PAC NOT = 0
               DISPLAY 'ERROR AL GRABAR ARCHIVO PAC: ' FS-PAC
               DISPLAY '*** SE CANCELA PROGRAMA COLPGPAC ***'
               PERFORM CERRAR-ARCHIVOS
               MOVE 100 TO RETURN-CODE
               GOBACK
           END-IF.


       ESTADISTICAS.
      *------------*
           DISPLAY '*************************************************'.
           DISPLAY '*  E S T A D I S T I C A S     C O L P G P A C  *'.
           DISPLAY '*************************************************'.
           DISPLAY '*                                               *'.
           DISPLAY '* REG. LEIDOS DESDE TABLA CAN           : ' WL-CAN.
           DISPLAY '* REG. NO PROCESADOS                    : ' WN-CAN.
           DISPLAY '* REG. GRABADOS EN ARCHIVO PAC          : ' WD-PAC.
           DISPLAY '*                                               *'.
           DISPLAY '*************************************************'.

      *Rutina de expansion de vencimientos
      *JSS LAST MOD. 16-JUN-1997
       COL-OBT-VEN SECTION.
       INI-COL-OBT-VEN.
      *DAD ini  07-JAN-1993
      * Carga variable necesaria para procesar con la variable VEN-INIT
           ADD  1  OPC-NUM-IVEN IN OPC GIVING VEN-OIM1.
      *DAD fin  07-JAN-1993

      *Calcula la cantidad de VENCIMIENTOS TOTAL de la operacion
           IF OPC-NUM-TVCC IN OPC NOT > ZEROES
               ADD OPC-NUM-VCVG IN OPC
                   OPC-NUM-VCCO IN OPC
                   OPC-NUM-VCCM IN OPC
                   OPC-NUM-VCCV IN OPC GIVING VEN-VCTO
           ELSE
               ADD OPC-NUM-VCVG IN OPC
                   OPC-NUM-TVCC IN OPC GIVING VEN-VCTO.
      *
      *Analiza comando ( cual vencimiento desea obtener )
           IF FIO-CMND = FIO-GET-FST
               MOVE 1 TO VEN-NUM-IVEN IN VEN
           ELSE
           IF FIO-CMND = FIO-GET-NLS
               IF VEN-NUM-IVEN IN VEN = ZEROES
                   MOVE 1 TO VEN-NUM-IVEN IN VEN
               ELSE
                   NEXT SENTENCE
           ELSE
           IF FIO-CMND = FIO-GET-NXT
               ADD 1 TO VEN-NUM-IVEN IN VEN
               IF VEN-NUM-IVEN IN VEN > VEN-VCTO
                   MOVE VEN-SEOF TO VEN-STAT
                   GO TO FIN-COL-OBT-VEN.
      *
      *Parrafo que lee vencimiento, estructuras y carga variables de tra
           PERFORM INI-VEN.
           IF VEN-STAT-CUR
      *JSS-INI  13-JUN-1997
               MOVE RCV-IRCV IN RCV-VRBL TO RCV-KEY-IRCV IN RCV
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RCV
               MOVE ICG-IICG IN ICG-VRBL TO ICG-KEY-IICG IN ICG
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-ICG
      *JSS-FIN  13-JUN-1997
               GO TO FIN-COL-OBT-VEN.
      *
      *Si pidio un vencimiento siguiente o un vencimiento anterior
      *el VEN-IEVC parte con la estructura que genero el vencimiento act
      *el VEN-IVCT es el vencimiento pedido
           IF VEN-IVAS-SIG
               PERFORM INC-VEN UNTIL ( NOT VEN-STAT-OKS ) OR
                       VEN-IVCT = EVC-IVCT(VEN-IEVC)
           ELSE
               PERFORM DEC-VEN UNTIL ( NOT VEN-STAT-OKS ) OR
                       VEN-IVCT = EVC-IVCT(VEN-IEVC).
      *
      *Calcula Inicio Mora para el VEN encontrado, y lee su DLC y EVC as
           PERFORM FIN-VEN.
           IF VEN-STAT-OKS
      *carga valores de VEN-VARI para conformar el registro VEN a retorn
               PERFORM LOD-RVEN.
       FIN-COL-OBT-VEN.
           MOVE ZEROES TO VEN-FTBS.
           MOVE 'S'    TO VEN-INIT.
           MOVE 'N'    TO VEN-KEST.
      *DAD ini  07-JAN-1993
      * Carga variables necesarias para procesar con la variable VEN-INI
           MOVE OPC-CIC-IOPC IN OPC TO VEN-OANT.
           MOVE VEN-IVCT            TO VEN-VANT.
      *DAD fin  07-JAN-1993
       EXT-COL-OBT-VEN.
           EXIT.

       LOD-RVEN SECTION.
       INI-LOD-RVEN.
      *carga valores de VEN-VARI para conformar el registro VEN a retorn
      *    MOVE EVC-FPVC(VEN-IEVC) TO VEN-FEC-FVEN IN VEN.
           MOVE EVC-FFVC(VEN-IEVC) TO VEN-FEC-FVEN IN VEN.
           MOVE VEN-FIMV           TO VEN-FEC-FIMV IN VEN.
           MOVE VEN-CAPI           TO VEN-VAL-CAPI IN VEN.
           MOVE VEN-SCAP           TO VEN-VAL-SCAP IN VEN.
           MOVE VEN-IDNI           TO VEN-VAL-IDNI IN VEN.
           MOVE VEN-FINA           TO VEN-VAL-FINA IN VEN.
           MOVE VEN-SFIN           TO VEN-VAL-SFIN IN VEN.
           MOVE VEN-SCTB           TO VEN-IND-SCTB IN VEN
                                      VEN-IND-CTBA IN VEN.
           MOVE VEN-IVCT           TO VEN-NUM-IVCT IN VEN.
           MOVE EVC-IEVC(VEN-IEVC) TO VEN-NUM-IEVC IN VEN.
           MOVE VEN-IDLC           TO VEN-NUM-IDLC IN VEN.
           MOVE EVC-CAUT(VEN-IEVC) TO VEN-IND-CAUT IN VEN.
           MOVE VEN-SCBZ           TO VEN-IND-SCBZ IN VEN.
           MOVE ZEROES             TO VEN-VAL-MTSC IN VEN.
           MOVE ZEROES             TO VEN-IND-MTSC IN VEN.
           MOVE VEN-CALC           TO VEN-IND-CALC IN VEN.
       FIN-LOD-RVEN.
           EXIT.

       INI-VEN SECTION.
       INI-INI-VEN.
      *DAD ini  07-JAN-1993
      * Discrimina la validez de procesar con la variable VEN-INIT
           IF VEN-NUM-IVEN IN VEN > VEN-OIM1 AND
              OPC-CIC-IOPC IN OPC = VEN-OANT AND
              VEN-VANT > OPC-NUM-IVEN IN OPC AND
              VEN-VANT < VEN-NUM-IVEN IN VEN
               MOVE SPACES              TO VEN-SCTB
               MOVE SPACES              TO VEN-SCBZ
               MOVE 'N'                 TO VEN-INIT
               MOVE VEN-NUM-IVEN IN VEN TO VEN-IVCT
               GO TO FIN-INI-VEN
           ELSE
               MOVE 'S' TO VEN-INIT.
      *DAD fin  07-JAN-1993
      *Inicializacion de variables
           MOVE SPACES     TO VEN-VARI EVC-VARI DLC-VARI AYF-VARI.
           MOVE LOW-VALUES TO VEN-VARC                   AYF-VARC.
           MOVE 10         TO VEN-LVCC.
           MOVE RCV-KEY-IRCV IN RCV TO RCV-IRCV IN RCV-VRBL.
           MOVE ICG-KEY-IICG IN ICG TO ICG-IICG IN ICG-VRBL.
      *
      *Lee el vencimiento en la base de datos ( variable VEN-NUM-IVCT co
      *el numero del vencimiento )
           MOVE VEN-SOKS TO VEN-STAT.
           MOVE VEN-NUM-IVEN IN VEN TO VEN-IVCT.
           MOVE 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE VEN-SFAL TO VEN-STAT
               GO TO FIN-INI-VEN.
      *    MOVE VEN-IND-SCTB IN VEN TO VEN-SCTB.
           MOVE SPACES              TO VEN-SCTB.
      *    MOVE VEN-IND-SCBZ IN VEN TO VEN-SCBZ.
           MOVE SPACES              TO VEN-SCBZ.
           MOVE VEN-FEC-FVEN IN VEN TO VEN-FVEN.
           MOVE VEN-FEC-FIMV IN VEN TO VEN-FIMV.
           MOVE VEN-NUM-IDLC IN VEN TO VEN-IDLC.
           MOVE VEN-VAL-CAPI IN VEN TO VEN-CAPI.
           MOVE VEN-VAL-SCAP IN VEN TO VEN-SCAP.
           MOVE VEN-VAL-IDNI IN VEN TO VEN-IDNI.
           MOVE VEN-VAL-FINA IN VEN TO VEN-FINA.
           MOVE VEN-VAL-SFIN IN VEN TO VEN-SFIN.
           MOVE VEN-NUM-IVCT IN VEN TO VEN-NVEN.
           MOVE VEN-IVCT TO VEN-NUM-IVEN IN VEN.
      *Realiza analisis de feriado a la fecha de vencimiento
      *en el caso de que esta sea feriado
           IF OPC-IND-AFER IN OPC = 'N'
               GO TO CON-INI-VEN.
           MOVE VEN-DVEN TO FEC-ITM1.
           MOVE VEN-MVEN TO FEC-ITM2.
           MOVE VEN-SVEN TO FEC-ITM3.
           MOVE VEN-AVEN TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               MOVE FEC-SIG-HBL  TO FEC-CMND
               MOVE FEC-FORM-FEC TO FEC-FORM
      *        PERFORM PRO-FEC
               PERFORM CAL-FEC
               MOVE FEC-ITM1 TO VEN-DVEN
               MOVE FEC-ITM2 TO VEN-MVEN
               MOVE FEC-ITM3 TO VEN-SVEN
               MOVE FEC-ITM4 TO VEN-AVEN.
       CON-INI-VEN.
      *
      *JSS-INI 28-FEB-1994
           IF VEN-IND-CALC IN VEN = 'N' AND VEN-KEST = 'S' AND
              VEN-INIT = 'S' AND VEN-NUM-IVCT IN VEN NOT > VEN-IVCT
               PERFORM COM-REG-VEN
               MOVE VEN-NUM-IVCT IN VEN TO VEN-NVEN
               IF NOT VEN-STAT-OKS
                   GO TO FIN-INI-VEN.
      *JSS-FIN 28-FEB-1994

      *Pregunta para ver si el vencimiento pedido ( VEN-IVCT ) correspon
      *a un vencimiento siguiente, a uno anterior, o al actual
           IF VEN-NUM-IVCT IN VEN < VEN-IVCT
               MOVE 'S' TO VEN-IVAS
           ELSE
           IF VEN-NUM-IVCT IN VEN > VEN-IVCT
               MOVE 'A' TO VEN-IVAS
           ELSE
      *Pidio el 'current'
               MOVE VEN-SCUR TO VEN-STAT
      *        Si el saldo del credito es cero ==> que ya se pago el ult
      *        vencimiento y este no puede ser otro que el 'current', po
      *        tanto :
      *        si el VEN 'current' esta incompleto suma su CAPITAL al SC
      *        porque al estar incompleto no debe rebajarse el SCPA con
      *        CAPITAL
               IF ( OPC-VAL-SCRE IN OPC NOT > ZEROES ) AND
                  ( ( VEN-IND-CALC IN VEN = 'N'    ) AND
                    ( VEN-VAL-FINA IN VEN > ZEROES ) )
                   MOVE VEN-NUM-IDLC IN VEN TO VEN-IDLC
                   PERFORM LOD-RDLC
                   IF VEN-STAT-OKS
                       ADD VEN-VAL-CAPI IN VEN TO DLC-SCPA(VEN-IDLC)
                       GO TO FIN-INI-VEN
                   ELSE
                       GO TO FIN-INI-VEN
               ELSE
                   GO TO FIN-INI-VEN.
      *
      *Calcula numero de vencimientos cancelados
           IF OPC-NUM-TVCC IN OPC NOT > ZEROES
               ADD OPC-NUM-VCCO IN OPC
                   OPC-NUM-VCCM IN OPC
                   OPC-NUM-VCCV IN OPC GIVING VEN-VCAN
           ELSE
               MOVE OPC-NUM-TVCC IN OPC TO VEN-VCAN.
      *
      *Si estan todos los vencimientos cancelados resta 1 al numero de
      *vencimientos cancelados como un 'truco' para no considerarlos
      *posteriormente
           IF OPC-NUM-VCVG IN OPC NOT > ZEROES
               SUBTRACT 1 FROM VEN-VCAN.
      *
      *Parrafo para obtener las estructuras de vencimiento, en VEN-EAUX
      *retorna el numero de la estructura que genero el vencimiento actu
           PERFORM OBT-EVC.
           IF NOT VEN-STAT-OKS
               GO TO FIN-INI-VEN.
           IF VEN-EAUX = 0
               MOVE VEN-SEFL TO VEN-STAT
               GO TO FIN-INI-VEN.
      *
      *Si desea un vencimiento anterior al actual
           IF VEN-IVAS-ANT
      *        llama a parrafo ANT-EVC para
      *        decrementar todas las estructuras salvo aquellas que dan
      *        origen al vencimiento o las que estan totalmente cancelad
               PERFORM ANT-EVC
      *        Si el VEN original esta completo suma su CAPITAL al SCPA,
      *        porque al estar completo se rebajo el SCPA con dicho CAPI
               IF ( VEN-IND-CALC IN VEN NOT = 'N' ) OR
                  ( ( VEN-IND-CALC IN VEN = 'N'    ) AND
                    ( VEN-VAL-FINA IN VEN NOT > ZEROES ) )
                   MOVE VEN-NUM-IDLC IN VEN TO VEN-IDLC
                   PERFORM LOD-RDLC
                   IF VEN-STAT-OKS
                       ADD VEN-VAL-CAPI IN VEN TO DLC-SCPA(VEN-IDLC)
                   ELSE
                       GO TO FIN-INI-VEN.

      **Si desea un vencimiento siguiente al actual
      *     IF VEN-IVAS-SIG
      **    Si el VEN original esta incompleto resta su CAPITAL al SCPA,
      **    porque al estar incompleto no se rebajo el SCPA con dicho CA
      *         IF VEN-IND-CALC IN VEN = 'N'
      *             MOVE VEN-NUM-IDLC IN VEN TO VEN-IDLC
      *             PERFORM LOD-RDLC
      *             IF VEN-STAT-OKS
      *                 SUBTRACT VEN-VAL-CAPI IN VEN FROM
      *                                              DLC-SCPA(VEN-IDLC)
      *             ELSE
      *                 GO TO FIN-INI-VEN.
      *
      *carga indice de trabajo con VEN-EAUX : La estructura o la primera
      *de ellas que genera el vencimiento actual
           MOVE VEN-EAUX TO VEN-IEVC.
      *
      *Busca codigo de tabla asociado a CIC= CAM-COD-MNAC IN CAM-VARI.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR' TO TAB-CIC-TTAB IN TAB.
           MOVE CAM-COD-MNAC IN CAM-VARI TO TAB-CIC-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CICDOC PAGNX' TO VEN-STAT
               GO TO FIN-INI-VEN.
           MOVE TAB-COD-CTAB IN TAB TO CIC-VLR-MNAC.
      *Busca codigo de tabla asociado a CIC='MIPL'
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'MIPL' TO MSC-CIC-TMSC IN MSC.
           MOVE 'P'    TO MSC-CIC-CMSC IN MSC.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'CICMIPLPNX' TO VEN-STAT
               GO TO FIN-INI-VEN.
           MOVE MSC-COD-CMSC IN MSC TO CIC-MIPL-P.
      *Carga Tipo de Tasa de Interes INT-TIPT
           MOVE OPC-CAI-IOPC IN OPC TO ICG-CAI-IOPC IN ICG.
           MOVE OPC-IIC-IOPC IN OPC TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN OPC AND
                    ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN OPC AND
                    ICG-NUM-ICAN IN ICG = ZEROES AND
                    ICG-CIC-IOPV IN ICG = SPACES AND
                    ICG-NUM-IVCT IN ICG = ZEROES AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               MOVE 'ICG    NEX' TO VEN-STAT
               GO TO FIN-INI-VEN.
           MOVE ICG-COD-TINT IN ICG TO INT-TIPT.
           IF INT-CVTI NOT > SPACES
               MOVE ICG-SGV-TINT IN ICG TO INT-TINT
           ELSE
               MOVE ICG-SGV-SPRD IN ICG TO INT-TINT.
      *Busca codigo de como opera
           MOVE SPACES TO CIC-OPEC.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    TOCNX' TO VEN-STAT
               GO TO FIN-INI-VEN
           ELSE
               MOVE 'COL'               TO MSC-COD-SIST FIO-SIST
               MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC
               MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS
                   MOVE 'VEN    OPENX'      TO VEN-STAT
                   GO TO FIN-INI-VEN
               ELSE
                   MOVE MSC-CIC-CMSC IN MSC TO CIC-OPEC.
       FIN-INI-VEN.
           EXIT.

       FIN-VEN SECTION.
       INI-FIN-VEN.
           IF NOT VEN-STAT-OKS
               GO TO FIN-FIN-VEN.
      *INI Obtener Fecha Inicio Mora para  el vencimiento
           MOVE EVC-DFVC(VEN-IEVC) TO FEC-ITM1.
           MOVE EVC-MFVC(VEN-IEVC) TO FEC-ITM2.
           MOVE EVC-SFVC(VEN-IEVC) TO FEC-ITM3.
           MOVE EVC-AFVC(VEN-IEVC) TO FEC-ITM4.
           IF EVC-DESD(VEN-IEVC) > 0
               MOVE EVC-DESD(VEN-IEVC) TO FEC-NDIA
               MOVE FEC-FORM-FEC       TO FEC-FORM
               MOVE FEC-SUM-DIA        TO FEC-CMND
      *        PERFORM PRO-FEC
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   MOVE 'VENFIMVER+' TO VEN-STAT
                   GO TO FIN-FIN-VEN.

      *DAD ini  12-AUG-1991
      * Fecha de MORA sera igual a la Fecha del Vencimiento sin Analisis
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     MOVE FEC-VHBL-S   TO FEC-VHBL.
      *     MOVE FEC-FBLK-N   TO FEC-FBLK.
      *     MOVE FEC-CHOY-N   TO FEC-CHOY.
      *     MOVE FEC-VAL-FEC  TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
      *         MOVE 'VENFIMVERHBL' TO VEN-STAT
      *         GO TO FIN-FIN-VEN.
      *     IF FEC-STAT-FER
      *         MOVE FEC-FORM-FEC TO FEC-FORM
      *         MOVE FEC-SIG-HBL  TO FEC-CMND
      *         PERFORM CAL-FEC
      *         IF NOT FEC-STAT-OKS
      *             MOVE 'VENFIMVERSHB' TO VEN-STAT
      *             GO TO FIN-FIN-VEN.
      *DAD fin  12-AUG-1991
       IMV-FIN-VEN.
           MOVE FEC-ITM1 TO VEN-DIMV.
           MOVE FEC-ITM2 TO VEN-MIMV.
           MOVE FEC-ITM3 TO VEN-SIMV.
           MOVE FEC-ITM4 TO VEN-AIMV.
      *FIN Obtener Fecha Inicio Mora
      *
      *Lee el documento y la estructura de vencimiento asociado al
      *vencimiento encontrado
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           IF EVC-IDLC(VEN-IEVC) NOT > 0
               MOVE EVC-IVCT(VEN-IEVC) TO DLC-NUM-IDLC IN DLC
           ELSE
               MOVE EVC-IDLC(VEN-IEVC) TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE VEN-SDFL TO VEN-STAT
               GO TO FIN-FIN-VEN.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE EVC-IEVC(VEN-IEVC)  TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               MOVE VEN-SEFL TO VEN-STAT
               GO TO FIN-FIN-VEN.
           IF VEN-IVAS-ANT
               PERFORM ANT-CAN
           ELSE
      *        PERFORM SIG-CAN
      *        MOVE VEN-CAPI TO VEN-VKCC
               GO TO CON-FIN-VEN.
      *
      *Si el VEN generado esta incompleto con FINA > 0, suma el capital
      *SCPA, ya que:
      *Caso 1) hacia atras    : al cancelar dicho VEN el CAPI se rebajo
      *                         SCPA, y ahora debe sumarse al SCPA
      *((Caso 2) hacia adelante : para calcular intereses el CAPI se reb
      *                         del SCPA, y ahora debe sumarse al SCPA))
           IF ( VEN-CALC = 'N' ) AND ( VEN-FINA > ZEROES )
               PERFORM OBT-DOC
               IF NOT VEN-STAT-OKS
                   GO TO FIN-VEN
               ELSE
               IF EVC-IDLC(VEN-IEVC) NOT > 0
                   MOVE EVC-IVCT(VEN-IEVC) TO VEN-I
                   ADD VEN-VKCC TO DLC-SCPA(VEN-I)
               ELSE
                   MOVE EVC-IDLC(VEN-IEVC) TO VEN-I
                   ADD VEN-VKCC TO DLC-SCPA(VEN-I).
       CON-FIN-VEN.
      *
      *Si pidio un vencimiento anterior las estructuras que no generan
      *el vencimiento pedido deben ser proyectadas nuevamente, para
      *que la fecha de proximo vencimiento quede siempre adelantada
           IF VEN-IVAS-ANT
               PERFORM RST-FPVC.
      *
       FIN-FIN-VEN.
           MOVE RCV-IRCV IN RCV-VRBL TO RCV-KEY-IRCV IN RCV.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           MOVE ICG-IICG IN ICG-VRBL TO ICG-KEY-IICG IN ICG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-ICG.
       EXT-FIN-VEN.
           EXIT.

       OBT-EVC SECTION.
       INI-OBT-EVC.
      *Pone en 0 indice de estructuras concurrentes
           MOVE 0 TO VEN-IVCC.
      *Lee estructuras de vencimiento
           MOVE 0 TO VEN-IEVC.
           MOVE VEN-CIC-IOPC IN VEN TO EVC-CIC-IOPC IN EVC.
           MOVE 1                   TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CIC-IOPC IN EVC = OPC-CIC-IOPC IN OPC )
               MOVE VEN-SEFL TO VEN-STAT
               GO TO FIN-OBT-EVC.
       LOOP-OBT-EVC.
      *Si pidio un vencimiento anterior y no ha cancelado ningun vencimi
      *de la estructura y el vencimiento actual no pertenece a dicha est
      * o bien si
      *Se pidio un vencimiento siguiente y los vencimientos de la estruc
      *estan todos cancelados entonces
      *la estructura NO se considera
           IF ( VEN-IVAS-ANT AND EVC-NUM-VCAN IN EVC = 0 AND
                EVC-NUM-IEVC IN EVC NOT = VEN-NUM-IEVC IN VEN ) OR
              ( VEN-IVAS-SIG AND
                EVC-NUM-VIGU IN EVC = EVC-NUM-VCAN IN EVC )
               GO TO NXT-OBT-EVC.
      *
      *Suma el contador de estructuras y valida contra el limte
           ADD 1 TO VEN-IEVC.
           IF VEN-IEVC > 10
               MOVE VEN-SEML TO VEN-STAT
               GO TO FIN-OBT-EVC.
      *
      *Guarda los valores de la estructura en EVC-VARI
           MOVE EVC-NUM-IEVC IN EVC TO EVC-IEVC(VEN-IEVC).
      *
      *     marca la estructura que genero el vencimiento actual (grabad
      *     IF EVC-NUM-IEVC IN EVC = VEN-NUM-IEVC IN VEN
      *         MOVE VEN-IEVC TO VEN-EAUX.
      *    marca mas abajo considerando que puede haber sido generado
      *    por varias estructuras
      *
           MOVE EVC-NUM-IVCT IN EVC TO EVC-IVCT(VEN-IEVC).
           MOVE EVC-NUM-VIGU IN EVC TO EVC-VIGU(VEN-IEVC).
           MOVE EVC-NUM-VCAN IN EVC TO EVC-VCAN(VEN-IEVC).
           MOVE EVC-NUM-SEVE IN EVC TO EVC-SEVE(VEN-IEVC).
           MOVE EVC-IND-UTSV IN EVC TO EVC-UTSV(VEN-IEVC).
           MOVE EVC-NUM-DPVC IN EVC TO EVC-DPVC(VEN-IEVC).
           MOVE EVC-NUM-MPVC IN EVC TO EVC-MPVC(VEN-IEVC).
           MOVE EVC-NUM-SPVC IN EVC TO EVC-SPVC(VEN-IEVC).
           MOVE EVC-NUM-APVC IN EVC TO EVC-APVC(VEN-IEVC).
      *
      *La fecha de proximo vencimiento no considera analisis de feriado,
      *por lo tanto ahora calcula EVC-FFVC
           MOVE EVC-DPVC(VEN-IEVC) TO FEC-ITM1.
           MOVE EVC-MPVC(VEN-IEVC) TO FEC-ITM2.
           MOVE EVC-SPVC(VEN-IEVC) TO FEC-ITM3.
           MOVE EVC-APVC(VEN-IEVC) TO FEC-ITM4.
           IF OPC-IND-AFER IN OPC = 'N'
               MOVE EVC-FPVC(VEN-IEVC) TO EVC-FFVC(VEN-IEVC)
               GO TO CON-OBT-EVC.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               MOVE FEC-SIG-HBL  TO FEC-CMND
               MOVE FEC-FORM-FEC TO FEC-FORM
      *       PERFORM PRO-FEC.
              PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO EVC-DFVC(VEN-IEVC).
           MOVE FEC-ITM2 TO EVC-MFVC(VEN-IEVC).
           MOVE FEC-ITM3 TO EVC-SFVC(VEN-IEVC).
           MOVE FEC-ITM4 TO EVC-AFVC(VEN-IEVC).
       CON-OBT-EVC.
      *Carga las estructuras que dieron origen al vencimiento
           IF EVC-FFVC(VEN-IEVC) = VEN-FVEN
               ADD 1 TO VEN-IVCC
               IF VEN-IVCC NOT > VEN-LVCC
                   MOVE VEN-IEVC TO VEN-VVCC(VEN-IVCC)
                   IF VEN-IVCC = 1
                       MOVE VEN-IEVC TO VEN-EAUX
                   ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE 'VEN    CCOVF' TO VEN-STAT
                   GO TO EXT-OBT-EVC.
      *
           MOVE EVC-NUM-DESD IN EVC TO EVC-DESD(VEN-IEVC).
           MOVE EVC-VAL-VENC IN EVC TO EVC-VENC(VEN-IEVC).
           MOVE EVC-IND-CAUT IN EVC TO EVC-CAUT(VEN-IEVC).
           MOVE EVC-VAL-VCVF IN EVC TO EVC-VCVF(VEN-IEVC).
      *
      *Busca CIC en tabla asociado a Codigo=EVC-MSC-TCVE IN EVC
           MOVE 'COL'       TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'CVC'               TO TAB-COD-TTAB IN TAB.
           MOVE EVC-MSC-TCVE IN EVC TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CICCVC NEX' TO VEN-STAT
               GO TO FIN-OBT-EVC.
           MOVE TAB-CIC-CTAB IN TAB TO EVC-TCVE(VEN-IEVC).
           IF EVC-TCVE(VEN-IEVC) = 'IF'
               IF ( AYF-ITCV = 'FI' ) OR ( AYF-ITCV NOT > SPACES )
                   MOVE 'FI' TO AYF-ITCV
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE EVC-TCVE(VEN-IEVC) TO AYF-ITCV.
      *
           MOVE EVC-NUM-DPVE IN EVC TO EVC-DPVE(VEN-IEVC).
           MOVE EVC-NUM-IDLC IN EVC TO EVC-IDLC(VEN-IEVC).
      *
      *INI Obtener Juliano para Fecha FINAL de Vencimiento
           MOVE EVC-DFVC(VEN-IEVC) TO FEC-ITM1.
           MOVE EVC-MFVC(VEN-IEVC) TO FEC-ITM2.
           MOVE EVC-SFVC(VEN-IEVC) TO FEC-ITM3.
           MOVE EVC-AFVC(VEN-IEVC) TO FEC-ITM4.
           MOVE FEC-FORM-FEC       TO FEC-FORM.
           MOVE FEC-RET-JUL        TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE VEN-SEFL TO VEN-STAT
               GO TO FIN-OBT-EVC.
           MOVE FEC-FJUL TO EVC-JPVC(VEN-IEVC).
      *FIN Obtener Juliano para Fecha FINAL de Vencimiento
      *
       NXT-OBT-EVC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF FIO-STAT-OKS AND EVC-CIC-IOPC IN EVC = OPC-CIC-IOPC IN OPC
               GO TO LOOP-OBT-EVC.
       FIN-OBT-EVC.
      *Redundante preguntar por los dos
           IF VEN-IEVC = 0 OR VEN-IVCC = 0
               MOVE VEN-SEFL TO VEN-STAT
           ELSE
               MOVE VEN-IEVC TO VEN-EMAX
               MOVE VEN-IVCC TO VEN-MVCC.
       EXT-OBT-EVC.
           EXIT.

      * ANT-EVC SECTION.
      * INI-ANT-EVC.
      *     MOVE 1 TO VEN-IEVC.
      * LOOP-ANT-EVC.
      *     IF EVC-IVCT(VEN-IEVC) > EVC-IVCT(VEN-EAUX)
      *         PERFORM DEC-STR
      *         ADD 1 TO EVC-VCAN(VEN-IEVC) , VEN-VCAN.
      *     ADD 1 TO VEN-IEVC.
      *     IF VEN-IEVC NOT > VEN-EMAX
      *         GO TO LOOP-ANT-EVC.
      * FIN-ANT-EVC.
      *     EXIT.

       ANT-EVC SECTION.
       INI-ANT-EVC.
           MOVE 1 TO VEN-IEVC.
       LU1-ANT-EVC.
           IF EVC-VIGU(VEN-IEVC) = EVC-VCAN(VEN-IEVC)
               GO TO NXT-ANT-EVC.
           MOVE 1 TO VEN-IVCC.
      *
       LU2-ANT-EVC.
           IF VEN-VVCC(VEN-IVCC) = VEN-IEVC
               GO TO NXT-ANT-EVC.
           ADD 1 TO VEN-IVCC.
           IF VEN-IVCC NOT > VEN-MVCC
               GO TO LU2-ANT-EVC.
      *
           PERFORM OBT-FYJ.
       NXT-ANT-EVC.
           ADD 1 TO VEN-IEVC.
           IF VEN-IEVC NOT > VEN-EMAX
               GO TO LU1-ANT-EVC.
       FIN-ANT-EVC.
           EXIT.

       INC-VEN SECTION.
       INI-INC-VEN.
      *Incrementa estructura nro. VEN-IEVC ( variando segun VEN-VVCC() )
           PERFORM INC-STR.
      *Obtiene la estructura siguiente a vencer ( el minimo juliano )
           PERFORM MIN-STR.
           IF NOT VEN-STAT-OKS
               GO TO FIN-INC-VEN.
      *Realiza un LUP para todos los vencimientos concurrentes guardados
      *en el vector VEN-VVCC usando la variable VEN-IEVC ( toma primero
      *la estructura que tiene FO si existe ).
           MOVE 0 TO VEN-VKCC VEN-SKCC.
           MOVE 0 TO VEN-VFCC VEN-SFCC.
           MOVE 'S' TO AYF-CALCULAR-INTERES.
           MOVE 'S' TO AYF-SZRO.

           IF VEN-IXFO > 1
               MOVE VEN-IXFO TO VEN-IVCC
               PERFORM CAL-VVCC
               IF NOT VEN-STAT-OKS
                   GO TO FIN-INC-VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE 0 TO VEN-IXFO.

           MOVE 1 TO VEN-IVCC.
       LUP-INC-VEN.
           PERFORM CAL-VVCC.
           IF NOT VEN-STAT-OKS
               GO TO FIN-INC-VEN.
           ADD 1 TO VEN-IVCC.
           IF VEN-IVCC = VEN-IXFO
               ADD 1 TO VEN-IVCC.
           IF VEN-IVCC NOT > VEN-MVCC
               GO TO LUP-INC-VEN.
      *Revisa si todos los SCPA estan en 0, eso significa que el
      *credito se pago antes de esta cuota por lo tanto implica STAT=EOF
           IF AYF-SZRO = 'S'
               MOVE VEN-SEOF TO VEN-STAT
               GO TO FIN-INC-VEN.
      *Mueve los valores acumulados para los vencimientos concurrentes
      *a los valores de resultado
           MOVE VEN-VKCC TO VEN-CAPI.
           MOVE VEN-SKCC TO VEN-SCAP.
           MOVE VEN-VFCC TO VEN-FINA.
           MOVE VEN-SFCC TO VEN-SFIN.
      *
      *Actualiza el Juliano de la amortizacion del Documento Y
      *Mueve la fecha del vencimiento a la fecha de amortizacion del
      *documento ( Recordar que existen por cada 'vencimiento' dos fecha
      *la FFVC que es la fecha del vencimiento sin analisis de feriado y
      *la FPVC que es la fecha del vencimiento mas analisis de feriado )
           MOVE 1 TO VEN-IVCC.
       AMT-INC-VEN.
           MOVE VEN-VVCC(VEN-IVCC) TO VEN-IEVC.
           IF EVC-TCVE(VEN-IEVC) = 'IO' OR 'CO' OR 'FO' OR 'CE'
                                    OR 'FP'
               IF EVC-IDLC(VEN-IEVC) = 0
                   MOVE EVC-IVCT(VEN-IEVC) TO VEN-IDLC
                   MOVE AYF-JAMT TO DLC-JAMT(VEN-IDLC)
                   MOVE EVC-DFVC(VEN-IEVC) TO DLC-DAMT(VEN-IDLC)
                   MOVE EVC-MFVC(VEN-IEVC) TO DLC-MAMT(VEN-IDLC)
                   MOVE EVC-SFVC(VEN-IEVC) TO DLC-SAMT(VEN-IDLC)
                   MOVE EVC-AFVC(VEN-IEVC) TO DLC-AAMT(VEN-IDLC)
               ELSE
                   MOVE EVC-IDLC(VEN-IEVC) TO VEN-IDLC
                   MOVE AYF-JAMT TO DLC-JAMT(VEN-IDLC)
                   MOVE EVC-DFVC(VEN-IEVC) TO DLC-DAMT(VEN-IDLC)
                   MOVE EVC-MFVC(VEN-IEVC) TO DLC-MAMT(VEN-IDLC)
                   MOVE EVC-SFVC(VEN-IEVC) TO DLC-SAMT(VEN-IDLC)
                   MOVE EVC-AFVC(VEN-IEVC) TO DLC-AAMT(VEN-IDLC).
           ADD 1 TO VEN-IVCC.
           IF VEN-IVCC NOT > VEN-MVCC
               GO TO AMT-INC-VEN.
      *
           MOVE VEN-VVCC(1) TO VEN-IEVC.
       FIN-INC-VEN.
           EXIT.

       CAL-VVCC SECTION.
       INI-CAL-VVCC.
           MOVE VEN-VVCC(VEN-IVCC) TO VEN-IEVC.
      *Obtiene documento legal credito y calcula juliano para fec.amorti
           PERFORM OBT-DOC.
      *Obtiene el VEN con numero de vencimiento EVC-IVCT(VEN-IEVC)
           PERFORM OBT-AYF.
           IF NOT VEN-STAT-OKS
               GO TO FIN-CAL-VVCC.
      *Suma el valor del capital del vencimiento al valor ya amortizado
           IF AYF-TCVE = 'IO' OR 'CO' OR 'FO' OR 'CE' OR 'FP'
               ADD VEN-CAPI TO AYF-SCYA.
           IF AYF-IULT-YES AND CIC-OPEC = 'B'
               SUBTRACT VEN-CAPI FROM VEN-FINA
               MOVE VEN-FINA TO VEN-SFIN.
      *Acumula los valores de resultado en los valores para vencimientos
      *concurrentes
           ADD VEN-CAPI TO VEN-VKCC.
           ADD VEN-SCAP TO VEN-SKCC.
           ADD VEN-FINA TO VEN-VFCC.
           ADD VEN-SFIN TO VEN-SFCC.
       FIN-CAL-VVCC.
           EXIT.

       DEC-VEN SECTION.
       INI-DEC-VEN.
           PERFORM DEC-STR.
           PERFORM MAX-STR.
       FIN-DEC-VEN.
           EXIT.

       SIG-CAN SECTION.
       INI-SIG-CAN.
           MOVE SPACES TO VEN-SCTB VEN-SCBZ.
           PERFORM SIG-ANT-CAN-FST.
       LUP-SIG-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = RCV-CIC-IOPV IN RCV AND
                    VEN-NUM-IVEN IN VEN = RCV-NUM-IVCT IN RCV )
               GO TO FIN-SIG-CAN.
           SUBTRACT RCV-SGV-CAPI IN RCV FROM VEN-SCAP.
           MOVE     RCV-SGV-INTE IN RCV TO   VEN-IDNI.
           SUBTRACT RCV-SGV-FINA IN RCV FROM VEN-SFIN.
           PERFORM SIG-ANT-CAN-NXT.
           GO TO LUP-SIG-CAN.
       FIN-SIG-CAN.
           EXIT.

       ANT-CAN SECTION.
       INI-ANT-CAN.
           MOVE SPACES TO VEN-SCTB VEN-SCBZ.
           MOVE ZEROES TO VEN-CAPI VEN-SCAP
                          VEN-FINA VEN-SFIN VEN-VKCC.
           PERFORM SIG-ANT-CAN-FST.
       LUP-ANT-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = RCV-CIC-IOPV IN RCV AND
                    VEN-NUM-IVEN IN VEN = RCV-NUM-IVCT IN RCV )
               GO TO FIN-ANT-CAN.
           IF RCV-SGV-CAPI IN RCV < ZEROES OR
              RCV-SGV-FINA IN RCV < ZEROES OR
              RCV-MSC-STAT IN RCV = 'R'
               GO TO NXT-ANT-CAN.
      *Usa VEN-VKCC solo como auxiliar, para usarlo en actualizacion de
           ADD RCV-SGV-CAPI IN RCV TO VEN-VKCC.
           IF RCV-MSC-STAT IN RCV = 'F'
               ADD RCV-SGV-CAPI IN RCV TO VEN-CAPI
               MOVE 'N'                TO VEN-CALC
           ELSE
           IF RCV-MSC-STAT IN RCV = 'C'
               ADD RCV-SGV-FINA IN RCV TO VEN-FINA
               MOVE 'N'                TO VEN-CALC
           ELSE
               ADD RCV-SGV-CAPI IN RCV TO VEN-CAPI
               ADD RCV-SGV-FINA IN RCV TO VEN-FINA
               MOVE SPACES             TO VEN-CALC.
           MOVE RCV-SGV-INTE IN RCV TO VEN-IDNI.
       NXT-ANT-CAN.
           PERFORM SIG-ANT-CAN-NXT.
           GO TO LUP-ANT-CAN.
       FIN-ANT-CAN.
           EXIT.

       SIG-ANT-CAN-FST SECTION.
       INI-SIG-ANT-CAN-FST.
      *Busca primera cancelacion para VEN
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO RCV-CIC-IOPV IN RCV.
           MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RCV.
       FIN-SIG-ANT-CAN-FST.
           EXIT.

       SIG-ANT-CAN-NXT SECTION.
       INI-SIG-ANT-CAN-NXT.
           MOVE RCV-IND-SCTB IN RCV TO VEN-SCTB.
           MOVE RCV-IND-SCBZ IN RCV TO VEN-SCBZ.
      *Busca siguiente cancelacion para VEN
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RCV.
       FIN-SIG-ANT-CAN-NXT.
           EXIT.

       RST-FPVC SECTION.
       INI-RST-FPVC.
           MOVE 1 TO VEN-I.
       LU1-RST-FPVC.
           IF EVC-VCAN(VEN-I) NOT > 0
               GO TO NXT-RST-FPVC.
           IF EVC-VIGU(VEN-I) = EVC-VCAN(VEN-I)
               GO TO NXT-RST-FPVC.
           MOVE 1 TO VEN-IVCC.
      *
       LU2-RST-FPVC.
           IF VEN-VVCC(VEN-IVCC) = VEN-I
               GO TO NXT-RST-FPVC.
           ADD 1 TO VEN-IVCC.
           IF VEN-IVCC NOT > VEN-MVCC
               GO TO LU2-RST-FPVC.
      *Respalda VEN-IEVC
           MOVE VEN-IEVC TO VEN-AUXI.
      *Carga VEN-IEVC y VEN-IVAS ( antes de llamar a OBT-FYJ )
           MOVE VEN-I TO VEN-IEVC.
           MOVE 'S'   TO VEN-IVAS.
           PERFORM OBT-FYJ.
      *Restaura VEN-IEVC y VEN-IVAS
           MOVE VEN-AUXI TO VEN-IEVC.
           MOVE 'A' TO VEN-IVAS.
       NXT-RST-FPVC.
           ADD 1 TO VEN-I.
           IF VEN-I NOT > VEN-EMAX
               GO TO LU1-RST-FPVC.
       FIN-RST-FPVC.
           EXIT.

       INC-STR SECTION.
       INI-INC-STR.
           ADD 1 TO VEN-VCAN.
           MOVE 1 TO VEN-IVCC.
       LUP-INC-STR.
           MOVE VEN-VVCC(VEN-IVCC) TO VEN-IEVC.
      *Va a incrementar estructura: suma 1 al numero de vencimientos
      *cancelados, si no quedan todos cancelados llama a OBT-FYJ
           ADD 1 TO EVC-VCAN(VEN-IEVC).
           IF EVC-VIGU(VEN-IEVC) NOT = EVC-VCAN(VEN-IEVC)
               PERFORM OBT-FYJ.
           ADD 1 TO VEN-IVCC.
           IF VEN-IVCC NOT > VEN-MVCC
               GO TO LUP-INC-STR.
       FIN-INC-STR.
           EXIT.

       MIN-STR SECTION.
       INI-MIN-STR.
           MOVE 0          TO VEN-EAUX.
           MOVE 0          TO VEN-IVCC.
           MOVE 0          TO VEN-IXFO.
           MOVE 0          TO VEN-NEVF VEN-NEVK.
           MOVE 1          TO VEN-IEVC.
           MOVE '99999999' TO VEN-FMIN.
       LOOP-MIN-STR.
      *Si la estructura esta toda cancelada no la considera, esto es
      *porque al ir proyectando existen estructuras que se van terminand
           IF EVC-VIGU(VEN-IEVC) = EVC-VCAN(VEN-IEVC)
               GO TO NXT-MIN-STR.

           IF ( EVC-FFVC(VEN-IEVC) < VEN-FMIN OR
                EVC-FFVC(VEN-IEVC) = VEN-FMIN ) AND
                EVC-TCVE(VEN-IEVC) = ( 'FO' OR 'FP' ) AND
                VEN-IXFO > 0
               GO TO NXT-MIN-STR.

           IF EVC-FFVC(VEN-IEVC) < VEN-FMIN
               MOVE EVC-FFVC(VEN-IEVC) TO VEN-FMIN
               MOVE VEN-IEVC           TO VEN-EAUX
               MOVE 1 TO VEN-IVCC
               MOVE VEN-IEVC TO VEN-VVCC(VEN-IVCC)
               MOVE 0        TO VEN-NEVF VEN-NEVK
               PERFORM ANL-TCV
               IF EVC-TCVE(VEN-IEVC) = ( 'FO' OR 'FP' )
                   MOVE VEN-IVCC TO VEN-IXFO
               ELSE
                   MOVE 0 TO VEN-IXFO
           ELSE
           IF EVC-FFVC(VEN-IEVC) = VEN-FMIN
               ADD 1 TO VEN-IVCC
               IF VEN-IVCC NOT > VEN-LVCC
                   MOVE VEN-IEVC TO VEN-VVCC(VEN-IVCC)
                   PERFORM ANL-TCV
                   IF EVC-TCVE(VEN-IEVC) = ( 'FO' OR 'FP' )
                       MOVE VEN-IVCC TO VEN-IXFO
                   ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE 'VEN    CCOVF' TO VEN-STAT
                   GO TO EXT-MIN-STR.

       NXT-MIN-STR.
           ADD 1 TO VEN-IEVC.
           IF VEN-IEVC NOT > VEN-EMAX
               GO TO LOOP-MIN-STR.
       FIN-MIN-STR.
      *Carga variable con el total de los vencimientos concurrentes
           MOVE VEN-IVCC TO VEN-MVCC.
      *
      *Pregunta si no encontro minima estructura ( todas canceladas ) mu
      *status SENO
      *en caso contrario
      *carga el VEN-IEVC con el numero de la estructura minima y
      *se suma 1 a los cancelados de la operacion para obtener el siguie
      *numero de vencimiento que se carga en la estructura que correspon
           IF VEN-EAUX = 0
               MOVE VEN-SENO TO VEN-STAT
               GO TO EXT-MIN-STR.
      *Suma 1 al numero de vencimiento
           ADD 1 TO VEN-NVEN.
      *Recorre todos los vencimientos concurrentes
           MOVE 1 TO VEN-IVCC.
       CAN-MIN-STR.
           MOVE VEN-VVCC(VEN-IVCC) TO VEN-IEVC.
      *JSS 7-APR-1991 18:02:34
      *    ADD 1 VEN-VCAN GIVING EVC-IVCT(VEN-IEVC).
           MOVE VEN-NVEN TO EVC-IVCT(VEN-IEVC).
           ADD 1 TO VEN-IVCC.
           IF VEN-IVCC NOT > VEN-MVCC
               GO TO CAN-MIN-STR.
      *
           MOVE VEN-EAUX TO VEN-IEVC.
       EXT-MIN-STR.
           EXIT.

       ANL-TCV SECTION.
       INI-ANL-TCV.
           IF EVC-BCCR(VEN-IEVC) = 'F' OR EVC-VICR(VEN-IEVC) = 'F'
               ADD 1 TO VEN-NEVF
           ELSE
               ADD 1 TO VEN-NEVK.
       FIN-ANL-TCV.
           EXIT.

       DEC-STR SECTION.
       INI-DEC-STR.
           SUBTRACT 1 FROM VEN-VCAN.
           MOVE 1 TO VEN-IVCC.
       LUP-DEC-STR.
           MOVE VEN-VVCC(VEN-IVCC) TO VEN-IEVC.
      *     SUBTRACT 1 FROM EVC-VCAN(VEN-IEVC).
      *     IF EVC-VCAN(VEN-IEVC) NOT < 0
           IF EVC-VCAN(VEN-IEVC) > 0
               PERFORM OBT-FYJ.
           ADD 1 TO VEN-IVCC.
           IF VEN-IVCC NOT > VEN-MVCC
               GO TO LUP-DEC-STR.
       FIN-DEC-STR.
           EXIT.

       MAX-STR SECTION.
       INI-MAX-STR.
           MOVE 0 TO VEN-EAUX.
           MOVE 0 TO VEN-IVCC.
           MOVE 0 TO VEN-IXFO.
           MOVE 0 TO VEN-NEVF VEN-NEVK.
           MOVE 1 TO VEN-IEVC.
           MOVE 0 TO VEN-FMAX.
       LOOP-MAX-STR.
           IF EVC-VCAN(VEN-IEVC) NOT > 0
               GO TO NXT-MAX-STR.

           IF ( EVC-FFVC(VEN-IEVC) > VEN-FMAX OR
                EVC-FFVC(VEN-IEVC) = VEN-FMAX ) AND
                EVC-TCVE(VEN-IEVC) = ( 'FO' OR 'FP' ) AND
                VEN-IXFO > 0
               GO TO NXT-MAX-STR.

           IF EVC-FFVC(VEN-IEVC) > VEN-FMAX
               MOVE EVC-FFVC(VEN-IEVC) TO VEN-FMAX
               MOVE VEN-IEVC           TO VEN-EAUX
               MOVE 1 TO VEN-IVCC
               MOVE VEN-IEVC TO VEN-VVCC(VEN-IVCC)
               MOVE 0        TO VEN-NEVF VEN-NEVK
               PERFORM ANL-TCV
               IF EVC-TCVE(VEN-IEVC) = ( 'FO' OR 'FP' )
                   MOVE VEN-IVCC TO VEN-IXFO
               ELSE
                   MOVE 0 TO VEN-IXFO
           ELSE
           IF EVC-FFVC(VEN-IEVC) = VEN-FMAX
               ADD 1 TO VEN-IVCC
               IF VEN-IVCC NOT > VEN-LVCC
                   MOVE VEN-IEVC TO VEN-VVCC(VEN-IVCC)
                   PERFORM ANL-TCV
                   IF EVC-TCVE(VEN-IEVC) = ( 'FO' OR 'FP' )
                       MOVE VEN-IVCC TO VEN-IXFO
                   ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE 'VEN    CCOVF' TO VEN-STAT
                   GO TO EXT-MAX-STR.
       NXT-MAX-STR.
           ADD 1 TO VEN-IEVC.
           IF VEN-IEVC NOT > VEN-EMAX
               GO TO LOOP-MAX-STR.
       FIN-MAX-STR.
      *Carga variable con el total de los vencimientos concurrentes
           MOVE VEN-IVCC TO VEN-MVCC.
      *
      *Pregunta si no encontro maxima estructura ( todas canceladas ) mu
      *status SENO
      *en caso contrario
      *carga el VEN-IEVC con el numero de la estructura maxima y
      *se suma 1 a los cancelados de la operacion para obtener el siguie
      *numero de vencimiento que se carga en la estructura que correspon
           IF VEN-EAUX = 0
               MOVE VEN-SENO TO VEN-STAT
               GO TO EXT-MAX-STR.
      *
      *Recorre toda las etructuras de tipo 1 y actualiza FAMT con la fec
      *de la estructura maxima
           PERFORM ACT-FAMT.
           IF NOT VEN-STAT-OKS
               GO TO EXT-MAX-STR.
      *Resta 1 al numero de vencimiento
           SUBTRACT 1 FROM VEN-NVEN.
      *Recorre todos los vencimientos concurrentes
           MOVE 1 TO VEN-IVCC.
       CAN-MAX-STR.
           MOVE VEN-VVCC(VEN-IVCC) TO VEN-IEVC.
      *JSS 7-APR-1991 18:03:17
      *    ADD 1 VEN-VCAN GIVING EVC-IVCT(VEN-IEVC).
           MOVE VEN-NVEN TO EVC-IVCT(VEN-IEVC).
      *
           SUBTRACT 1 FROM EVC-VCAN(VEN-IEVC).
      *
           ADD 1 TO VEN-IVCC.
           IF VEN-IVCC NOT > VEN-MVCC
               GO TO CAN-MAX-STR.
      *
           MOVE VEN-EAUX TO VEN-IEVC.
       EXT-MAX-STR.
           EXIT.

       ACT-FAMT SECTION.
       INI-ACT-FAMT.
      *Recorre toda las etructuras de tipo 1 y actualiza FAMT con la fec
      *de la estructura maxima
           MOVE 0 TO VEN-FMAX.
           MOVE 1 TO VEN-IEVC.
       LUP-ACT-FAMT.
           IF EVC-VCAN(VEN-IEVC) NOT > 0
               GO TO NXT-ACT-FAMT.
           IF EVC-TCVE(VEN-IEVC) = 'IC' OR 'IF' OR 'FE'
               GO TO NXT-ACT-FAMT.
           IF EVC-FFVC(VEN-IEVC) < VEN-FMAX
               GO TO NXT-ACT-FAMT.
           MOVE EVC-FFVC(VEN-IEVC) TO VEN-FMAX.
           PERFORM OBT-DOC.
           IF NOT VEN-STAT-OKS
               GO TO FIN-ACT-FAMT.
           IF EVC-IDLC(VEN-IEVC) = 0
               MOVE EVC-IVCT(VEN-IEVC) TO VEN-I
           ELSE
               MOVE EVC-IDLC(VEN-IEVC) TO VEN-I.
           MOVE EVC-DFVC(VEN-IEVC) TO DLC-DAMT(VEN-I).
           MOVE EVC-MFVC(VEN-IEVC) TO DLC-MAMT(VEN-I).
           MOVE EVC-SFVC(VEN-IEVC) TO DLC-SAMT(VEN-I).
           MOVE EVC-AFVC(VEN-IEVC) TO DLC-AAMT(VEN-I).
       NXT-ACT-FAMT.
           ADD 1 TO VEN-IEVC.
           IF VEN-IEVC NOT > VEN-EMAX
               GO TO LUP-ACT-FAMT.
       FIN-ACT-FAMT.
           EXIT.

       OBT-FYJ SECTION.
       INI-OBT-FYJ.
      *Suma o resta periodo entre vencimiento para la estructura nro. VE
      *y deja en variable EVC-FPVC(VEN-IEVC)
           IF ( EVC-UTSV(VEN-IEVC) = 'M' OR 'A' ) AND
              EVC-DPVE(VEN-IEVC) > ZEROES
               MOVE EVC-DPVE(VEN-IEVC) TO FEC-ITM1
           ELSE
               MOVE EVC-DPVC(VEN-IEVC) TO FEC-ITM1.
           MOVE EVC-MPVC(VEN-IEVC) TO FEC-ITM2.
           MOVE EVC-SPVC(VEN-IEVC) TO FEC-ITM3.
           MOVE EVC-APVC(VEN-IEVC) TO FEC-ITM4.
           IF EVC-UTSV(VEN-IEVC) = 'D'
               MOVE EVC-SEVE(VEN-IEVC) TO FEC-NDIA
               IF VEN-IVAS-SIG
                   MOVE FEC-SUM-DIA TO FEC-CMND
               ELSE
                   MOVE FEC-RST-DIA TO FEC-CMND
           ELSE
           IF EVC-UTSV(VEN-IEVC) = 'M'
               MOVE EVC-SEVE(VEN-IEVC) TO FEC-NMES
               IF VEN-IVAS-SIG
                   MOVE FEC-SUM-MES TO FEC-CMND
               ELSE
                   MOVE FEC-RST-MES TO FEC-CMND
           ELSE
      *    Asume ano
               MOVE EVC-SEVE(VEN-IEVC) TO FEC-NANO
               IF VEN-IVAS-SIG
                   MOVE FEC-SUM-ANO TO FEC-CMND
               ELSE
                   MOVE FEC-RST-ANO TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO EVC-DPVC(VEN-IEVC).
           MOVE FEC-ITM2 TO EVC-MPVC(VEN-IEVC).
           MOVE FEC-ITM3 TO EVC-SPVC(VEN-IEVC).
           MOVE FEC-ITM4 TO EVC-APVC(VEN-IEVC).
      *
      *Analiza feriado para la fecha del vencimiento
           IF OPC-IND-AFER IN OPC = 'N'
               MOVE EVC-FPVC(VEN-IEVC) TO EVC-FFVC(VEN-IEVC)
               GO TO CON-OBT-FYJ.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               MOVE FEC-SIG-HBL  TO FEC-CMND
               MOVE FEC-FORM-FEC TO FEC-FORM
      *        PERFORM PRO-FEC.
               PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO EVC-DFVC(VEN-IEVC).
           MOVE FEC-ITM2 TO EVC-MFVC(VEN-IEVC).
           MOVE FEC-ITM3 TO EVC-SFVC(VEN-IEVC).
           MOVE FEC-ITM4 TO EVC-AFVC(VEN-IEVC).
       CON-OBT-FYJ.
      *
      *Calcula el juliano para la fecha del vencimiento
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RET-JUL  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-FJUL TO EVC-JPVC(VEN-IEVC).
       FIN-OBT-FYJ.
           EXIT.

       OBT-DOC SECTION.
       INI-OBT-DOC.
           IF NOT VEN-STAT-OKS
               GO TO FIN-OBT-DOC.
      *
      *Si la estructura no esta asociada a ningun documento mueve
      *el numero de la estructura para accesar el DLC en caso contrario
      *mueve el numero del documento que tiene asociado la estructura
           IF EVC-IDLC(VEN-IEVC) = 0
               MOVE EVC-IVCT(VEN-IEVC) TO VEN-IDLC
           ELSE
               MOVE EVC-IDLC(VEN-IEVC) TO VEN-IDLC.
           IF VEN-IDLC > 10
               MOVE VEN-SDML TO VEN-STAT
               GO TO FIN-OBT-DOC.
      *Carga el documento con numero VEN-IDLC
           PERFORM LOD-RDLC.
       FIN-OBT-DOC.
           EXIT.

       LOD-RDLC SECTION.
       INI-LOD-RDLC.
      *Revisa si el documento ya fue cargado anteriormente
           IF DLC-TDOC(VEN-IDLC) NOT = SPACES
               GO TO FIN-LOD-RDLC.
      *
      *Lee el documento y carga en variables DLC-VARI
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-IDLC            TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE VEN-SDFL TO VEN-STAT
               GO TO FIN-LOD-RDLC.
      *Carga codigo computacional del codigo tipo de documento del DLC
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'DOC'               TO TAB-COD-TTAB IN TAB.
           MOVE DLC-COD-TDOC IN DLC TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CICDOC PAGNX' TO VEN-STAT
               GO TO FIN-LOD-RDLC.
           MOVE TAB-CIC-CTAB IN TAB TO DLC-TDOC(VEN-IDLC).
      *
           MOVE DLC-MSC-MIPL IN DLC TO DLC-MIPL(VEN-IDLC).
           MOVE DLC-VAL-SDLC IN DLC TO DLC-SDLC(VEN-IDLC).
           MOVE DLC-VAL-SCPA IN DLC TO DLC-SCPA(VEN-IDLC).
      *Calcula el valor de capital ya amortizado
           SUBTRACT DLC-VAL-SCPA IN DLC FROM OPC-VAL-CRED IN OPC
                    GIVING AYF-SCYA.
           MOVE DLC-VAL-SINT IN DLC TO DLC-SINT(VEN-IDLC).
           MOVE DLC-FEC-FAMT IN DLC TO DLC-FAMT(VEN-IDLC).
      *
           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
              ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               IF INT-CVTI NOT > SPACES
                   MOVE ICG-SGV-TINT IN ICG TO DLC-TINT(VEN-IDLC)
               ELSE
                   MOVE ICG-SGV-SPRD IN ICG TO DLC-TINT(VEN-IDLC)
           ELSE
               MOVE INT-TINT TO DLC-TINT(VEN-IDLC).
       CON-LOD-RDLC.
      *Calcula el juliano para la fecha de amortizacion
           MOVE DLC-DAMT(VEN-IDLC) TO FEC-ITM1.
           MOVE DLC-MAMT(VEN-IDLC) TO FEC-ITM2.
           MOVE DLC-SAMT(VEN-IDLC) TO FEC-ITM3.
           MOVE DLC-AAMT(VEN-IDLC) TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RET-JUL  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-FJUL TO DLC-JAMT(VEN-IDLC).
       FIN-LOD-RDLC.
           EXIT.

       OBT-AYF SECTION.
       INI-OBT-AYF.
           IF NOT VEN-STAT-OKS
               GO TO FIN-OBT-AYF.
      *
      *Mueve tipo de calculo de la estructura a calcular
           MOVE EVC-TCVE(VEN-IEVC) TO AYF-TCVE.
      *
      *Busca si el vencimiento que esta revisando es el ultimo por cance
      *considerando todo el documento ( es decir si esta cancelando con
      *cuota todo el documento : AYF-IULT = 'S' )
           PERFORM ULT-AYF.
      *
      *Si el tipo de calculo es sin intereses
           IF AYF-TCVE = 'IN'
               IF AYF-IULT-YES
      *        Si con el vencimiento actual se cancela todo el documento
      *        Mueve el saldo insoluto al capital total
      *        Suma el saldo insoluto, intereses devengados para obtener
      *        final ademas si el manejo de interes es prorrateado segun
      *        de cada cuota suma al valor final el saldo de los interes
                   ADD DLC-SCPA(VEN-IDLC) , DLC-SINT(VEN-IDLC) ,
                       EVC-VCVF(VEN-IEVC)   GIVING VEN-CAPI
                   MOVE VEN-CAPI TO VEN-SCAP VEN-FINA VEN-SFIN
                   MOVE 0 TO DLC-SCPA(VEN-IDLC)
                   MOVE 0 TO DLC-SINT(VEN-IDLC)
                   GO TO FIN-OBT-AYF
               ELSE
                   MOVE EVC-VCVF(VEN-IEVC) TO VEN-CAPI VEN-SCAP
                                              VEN-FINA VEN-SFIN
                   GO TO FIN-OBT-AYF.
      *
      *Si el tipo de documento asociado a la estructura no es letra
      *calcula en PAG-OBT-AYF
           IF ( DLC-TDOC(VEN-IDLC) NOT = CIC-TDOC-LTR ) AND
              ( NOT (  AYF-TCVE = 'IC' OR 'IF' OR 'FE' ) )
               GO TO PAG-OBT-AYF.
           MOVE 'N' TO AYF-SZRO.
      *
      **     IF AYF-TCVE = 'FE'
      ***Mueve Juliano de la amortizacion del documento ( es la fecha de
      ***vencimiento anterior de la estructura ) y Juliano del vencimien
      ***proyectado ahora
      **         MOVE DLC-JAMT(VEN-IDLC) TO AYF-JANT
      **         MOVE EVC-JPVC(VEN-IEVC) TO AYF-JAMT
      ***Calcula la separacion en dias entre los julianos
      **         SUBTRACT AYF-JANT FROM AYF-JAMT GIVING INT-SEPD
      ***Actualiza el Juliano anterior con el Juliano actual de amortiza
      **         MOVE AYF-JAMT TO AYF-JANT
      ***Actualiza el Juliano de la amortizacion del Documento
      **         MOVE AYF-JAMT TO DLC-JAMT(VEN-IDLC)
      **     ELSE
      *Obtiene separacion en dias ( INT-SEPD ) entre fecha de colocacion
      *y la fecha del vencimiento
           PERFORM OBT-SEDF.
           IF NOT VEN-STAT-OKS
               GO TO FIN-OBT-AYF.

           IF AYF-BCCR = 'F' OR AYF-VICR = 'F'
      *        Si tipo calculo es 'F*' mueve valor final de estructura
      *        a valor final y a saldo valor final del vencimiento
      *        y calcula valor capital
               MOVE EVC-VCVF(VEN-IEVC) TO VEN-FINA
                                          VEN-SFIN
               PERFORM CAL-CAPI
               IF AYF-IULT-YES
      *    Si con el vencimiento actual se cancela todo el documento
      *    Mueve el saldo insoluto al capital total
      *    Suma el saldo insoluto, intereses devengados para obtener val
      *    final ademas si el manejo de interes es prorrateado segun cap
      *    de cada cuota suma al valor final el saldo de los intereses
                   ADD DLC-SCPA(VEN-IDLC) , DLC-SINT(VEN-IDLC) ,
                       VEN-CAPI GIVING VEN-CAPI
                   MOVE VEN-CAPI TO VEN-SCAP
                   PERFORM CAL-FINA
                   MOVE 0 TO DLC-SCPA(VEN-IDLC)
                   MOVE 0 TO DLC-SINT(VEN-IDLC)
               ELSE
                   NEXT SENTENCE
           ELSE
      *        Si tipo calculo NO es 'F*' mueve valor capital de estruct
      *        a valor capital y a saldo valor capital del vencimiento
      *        y calcula valor final
               IF AYF-IULT-YES
                   ADD DLC-SCPA(VEN-IDLC) , DLC-SINT(VEN-IDLC) ,
                       EVC-VCVF(VEN-IEVC)   GIVING VEN-CAPI
                   MOVE VEN-CAPI TO VEN-SCAP
                   PERFORM CAL-FINA
                   MOVE 0 TO DLC-SCPA(VEN-IDLC)
                   MOVE 0 TO DLC-SINT(VEN-IDLC)
               ELSE
                   MOVE EVC-VCVF(VEN-IEVC) TO VEN-CAPI
                                              VEN-SCAP
                   PERFORM CAL-FINA.
           GO TO FIN-OBT-AYF.
       PAG-OBT-AYF.
      *
      *Mueve el Saldo Capital por Amortizar ( Saldo Insoluto )
           MOVE DLC-SCPA(VEN-IDLC) TO AYF-SCPA.
           IF AYF-SCPA > ZEROES
               MOVE 'N' TO AYF-SZRO.
      *
           IF AYF-BCCR = 'F' OR AYF-VICR = 'F'
      *mueve 0 al saldo de interes
      *Mueve saldo de intereses a intereses devengados no incluidos
      *Mueve el valor final de EVC al valor final
               MOVE 0                  TO AYF-SINT
               MOVE DLC-SINT(VEN-IDLC) TO AYF-IDNI
               MOVE EVC-VCVF(VEN-IEVC) TO AYF-FINA
           ELSE
      *mueve saldo de intereses al saldo de interes
      *Mueve 0 a intereses devengados no incluidos
      *Mueve el valor capital de EVC al valor capital
               MOVE DLC-SINT(VEN-IDLC) TO AYF-SINT
               MOVE 0                  TO AYF-IDNI
               MOVE EVC-VCVF(VEN-IEVC) TO AYF-CAPI.
      *
      *Mueve Juliano de la amortizacion del documento ( es la fecha del
      *vencimiento anterior de la estructura ) y Juliano del vencimiento
      *proyectado ahora
           MOVE DLC-JAMT(VEN-IDLC) TO AYF-JANT.
           MOVE EVC-JPVC(VEN-IEVC) TO AYF-JAMT.
      *
      *Busca si el vencimiento que esta revisando es el ultimo por cance
      *considerando todo el documento ( es decir si esta cancelando con
      *cuota todo el documento : AYF-IULT = 'S' )
      *     PERFORM ULT-AYF.
      *
      *Obtiene valor final, valor capital, saldo insoluto, actualiza sal
      *interes
           PERFORM CAL-AYF.
           IF NOT VEN-STAT-OKS
               GO TO FIN-OBT-AYF.
      *     MOVE EVC-DPVC(VEN-IEVC) TO DLC-DAMT(VEN-IDLC).
      *     MOVE EVC-MPVC(VEN-IEVC) TO DLC-MAMT(VEN-IDLC).
      *     MOVE EVC-SPVC(VEN-IEVC) TO DLC-SAMT(VEN-IDLC).
      *     MOVE EVC-APVC(VEN-IEVC) TO DLC-AAMT(VEN-IDLC).
      *Mueve la fecha del vencimiento a la fecha de amortizacion del
      *documento ( Recordar que existen por cada 'vencimiento' dos fecha
      *la FFVC que es la fecha del vencimiento sin analisis de feriado y
      *la FPVC que es la fecha del vencimiento mas analisis de feriado )
      *     MOVE EVC-DFVC(VEN-IEVC) TO DLC-DAMT(VEN-IDLC).
      *     MOVE EVC-MFVC(VEN-IEVC) TO DLC-MAMT(VEN-IDLC).
      *     MOVE EVC-SFVC(VEN-IEVC) TO DLC-SAMT(VEN-IDLC).
      *     MOVE EVC-AFVC(VEN-IEVC) TO DLC-AAMT(VEN-IDLC).
      *Mueve el saldo insoluto al documento
           MOVE AYF-SCPA TO DLC-SCPA(VEN-IDLC).
      *
           IF VEN-CALC = 'N'
      *JSS-INI 20-JUN-1997
               AND VEN-KEST NOT = 'S'
      *JSS-FIN 20-JUN-1997
               GO TO CON-OBT-AYF.
      *
           IF AYF-BCCR = 'F' OR AYF-VICR = 'F'
      *        Si tipo de calculo es 'F*' mueve al saldo de interes del
      *        el valor de los intereses
               IF AYF-CALCULAR-INTERES-SI
                   MOVE AYF-IDNI TO DLC-SINT(VEN-IDLC)
               ELSE
                   NEXT SENTENCE
           ELSE
      *        Si tipo de calculo NO es 'F*' mueve al saldo de interes d
      *        documento el valor del saldo de interes
               MOVE AYF-SINT TO DLC-SINT(VEN-IDLC).
           IF AYF-CALCULAR-INTERES-SI
               MOVE 'N' TO AYF-CALCULAR-INTERES.
      *
      *Actualiza el Juliano de la amortizacion del Documento
      *Al haber vencimientos concurrentes debe hacerlo al final
      *     MOVE AYF-JAMT TO DLC-JAMT(VEN-IDLC).
      *
      *Mueve el valor capital al valor capital del vencimiento y al sald
      *valor capital del vencimiento,
      *mueve el saldo de los intereses al valor de los interes no inclui
      *del vencimiento, y
      *mueve el valor final al valor final del vencimiento y al saldo de
      *valor final del vencimiento
       CON-OBT-AYF.
           MOVE AYF-CAPI TO VEN-CAPI , VEN-SCAP.
           MOVE DLC-SINT(VEN-IDLC) TO VEN-IDNI.
           MOVE AYF-FINA TO VEN-FINA , VEN-SFIN.
       FIN-OBT-AYF.
           EXIT.

       OBT-SEDF SECTION.
       INI-OBT-SEDF.
      *Diferencia en dias entre OPC-FEC-FCOL y EVC-FFVC(VEN-IEVC)
           MOVE OPC-NUM-DCOL IN OPC TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC TO FEC-AEC1.
           MOVE EVC-DFVC(VEN-IEVC)  TO FEC-DEC2.
           MOVE EVC-MFVC(VEN-IEVC)  TO FEC-MEC2.
           MOVE EVC-SFVC(VEN-IEVC)  TO FEC-SEC2.
           MOVE EVC-AFVC(VEN-IEVC)  TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'FCOLPVDFDIA' TO VEN-STAT
               GO TO FIN-OBT-SEDF.
           MOVE FEC-NDIA TO INT-SEPD.
       FIN-OBT-SEDF.
           EXIT.

       CAL-CAPI SECTION.
       INI-CAL-CAPI.
      *Carga parametros para calculo de interes
           PERFORM BUS-PINT.
           PERFORM OBT-VTIN.
           IF INT-CMSG NOT > SPACES
      *Calcula valor capital = valor final / ( 1 + TIPE )
               ADD 1 TO INT-TIPE
               DIVIDE VEN-FINA BY INT-TIPE GIVING VEN-CAPI ROUNDED
               SUBTRACT 1 FROM INT-TIPE
               IF OPC-COD-VCOC IN OPC = CIC-VLR-MNAC
                   MOVE VEN-CAPI TO PES-SGV-DECI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE TO VEN-CAPI
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE INT-CMSG TO VEN-STAT
               MOVE INT-MEN2 TO VEN-MEN2
               GO TO FIN-CAL-CAPI.
           MOVE VEN-CAPI TO VEN-SCAP.
       FIN-CAL-CAPI.
           EXIT.

       CAL-FINA SECTION.
       INI-CAL-FINA.
      *Carga parametros para calculo de interes
           PERFORM BUS-PINT.
           PERFORM OBT-VTIN.
           IF INT-CMSG NOT > SPACES
      *Calcula valor final = valor capital * ( 1 + TIPE )
               ADD 1 TO INT-TIPE
               MULTIPLY VEN-CAPI BY INT-TIPE GIVING VEN-FINA ROUNDED
               SUBTRACT 1 FROM INT-TIPE
               IF OPC-COD-VCOC IN OPC = CIC-VLR-MNAC
                   MOVE VEN-FINA TO PES-SGV-DECI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE TO VEN-FINA
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE INT-CMSG TO VEN-STAT
               MOVE INT-MEN2 TO VEN-MEN2
               GO TO FIN-CAL-FINA.
           MOVE VEN-FINA TO VEN-SFIN.
       FIN-CAL-FINA.
           EXIT.

       ULT-AYF SECTION.
       INI-ULT-AYF.
      *Suma 1 a los cancelados de la estructura para efectos de la pregu
           MOVE VEN-IEVC TO VEN-EAUX.
      *
           MOVE 1 TO VEN-I.
       LU1-ULT-AYF.
           MOVE VEN-VVCC(VEN-I) TO VEN-IEVC.
           ADD 1 TO EVC-VCAN(VEN-IEVC).
           ADD 1 TO VEN-I.
           IF VEN-I NOT > VEN-MVCC
               GO TO LU1-ULT-AYF.
      *
           MOVE 1 TO VEN-IEVC.
           MOVE 'S' TO AYF-IULT.
       LOOP-ULT-AYF.
           IF EVC-IDLC(VEN-IEVC) = VEN-IDLC AND
              EVC-VCAN(VEN-IEVC) < EVC-VIGU(VEN-IEVC)
               MOVE 'N' TO AYF-IULT
           ELSE
               ADD 1 TO VEN-IEVC
               IF VEN-IEVC NOT > VEN-EMAX
                   GO TO LOOP-ULT-AYF.
       FIN-ULT-AYF.
      *
           MOVE 1 TO VEN-I.
       LU2-ULT-AYF.
           MOVE VEN-VVCC(VEN-I) TO VEN-IEVC.
           SUBTRACT 1 FROM EVC-VCAN(VEN-IEVC).
           ADD 1 TO VEN-I.
           IF VEN-I NOT > VEN-MVCC
               GO TO LU2-ULT-AYF.
      *
           MOVE VEN-EAUX TO VEN-IEVC.
       EXT-ULT-AYF.
           EXIT.

       CAL-AYF SECTION.
       INI-CAL-AYF.
      *Calcula la separacion en dias entre los julianos
           SUBTRACT AYF-JANT FROM AYF-JAMT GIVING INT-SEPD.
      *Carga parametros para obtener tasa de interes del periodo
           PERFORM BUS-PINT.
      *Actualiza el Juliano anterior con el Juliano actual de amortizaci
           MOVE AYF-JAMT TO AYF-JANT.
      *Obtiene tasa de interes del periodo TIPE
           IF ( INT-CVTI > SPACES AND VEN-FTBS > ZEROES )
               MOVE VEN-DTBS TO INT-DBTV
               MOVE VEN-MTBS TO INT-MBTV
               MOVE VEN-STBS TO INT-SBTV
               MOVE VEN-ATBS TO INT-ABTV.
      *    PERFORM OBT-VTIN.
      *SMC-INI 07.09.1993
      *    PERFORM GNS-CAL-INT.
           PERFORM COL-CAL-INT.
      *SMC-FIN 07.09.1993
           IF INT-CMSG > SPACES
               MOVE INT-CMSG TO VEN-STAT
               MOVE INT-MEN2 TO VEN-MEN2
               GO TO FIN-CAL-AYF.
           IF INT-IETB > SPACES
               MOVE 'N' TO VEN-CALC.
      *
           ADD 1 TO INT-TIPE.
      *Calcula intereses devengados no incluidos
           IF AYF-CALCULAR-INTERES-SI
               COMPUTE AYF-IDNI ROUNDED =
                      ( AYF-SCPA + AYF-SINT ) * ( INT-TIPE - 1 ) +
                                       AYF-IDNI * INT-TIPE
      *Si la moneda del credito es nacional, redondea sin centavos
               IF OPC-COD-VCOC IN OPC = CIC-VLR-MNAC
                   MOVE AYF-IDNI TO PES-SGV-DECI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE TO AYF-IDNI
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE 0 TO AYF-IDNI.
      *
           IF AYF-IULT-YES
      *        Si con el vencimiento actual se cancela todo el documento
      *        llama a parrafo CAL-AYF-ULT
               PERFORM CAL-AYF-ULT
           ELSE
           IF AYF-BCCR = 'F' OR AYF-VICR = 'F'
      *        Si tipo de calculo es 'F*'
      *        Si la tasa es estimada entonces el valor final es
      *        el conocido ( AYF-FINA ) y el capital = 0 ( AYF-CAPI )
      *        ( KEST es un switch para indicar que devuelva el capital
      *          estimado, esta inicializado siempre en 'N' )
               IF INT-IETB > SPACES AND ( VEN-KEST NOT = 'S' )
                   MOVE 0 TO AYF-CAPI
               ELSE
      *            Analiza como es el interes respecto del valor final
                   IF AYF-IDNI > AYF-FINA
                       SUBTRACT AYF-FINA FROM AYF-IDNI
                       MOVE 0 TO AYF-CAPI
                   ELSE
                       SUBTRACT AYF-IDNI FROM AYF-FINA GIVING AYF-CAPI
      *                El capital calculado puede ser sea mayor que el
      *                resto del documento
                       IF AYF-CAPI > AYF-SCPA
                           PERFORM CAL-AYF-ULT
                       ELSE
                           MOVE 0 TO AYF-IDNI
           ELSE
      *        Si tipo de calculo NO es 'F*'
      *        Si la tasa es estimada
      *JSS-INI 13-JUN-1997
      *        IF INT-IETB > SPACES
               IF INT-IETB > SPACES AND ( VEN-KEST NOT = 'S' )
      *JSS-FIN 13-JUN-1997
      *            Si existe un F* en el vencimiento que se genera
      *            se mueve al final el capital conocido y el capital en
      *            ( ya que el valor final sera el conocido : el final d
      *            f* + los capitales de las otras estructuras )
      *            en caso de no existir ningun f* el capital es el cono
      *            ( AYF-CAPI ) y el final es 0 ( AYF-FINA )
                   IF VEN-NEVF > 0
                       MOVE AYF-CAPI TO AYF-FINA
                       MOVE 0        TO AYF-CAPI
                   ELSE
                       MOVE 0        TO AYF-FINA
               ELSE
      *        Si la tasa es real
      *        El capital calculado puede ser sea mayor que el resto del
      *        documento
               IF AYF-CAPI > AYF-SCPA
                   PERFORM CAL-AYF-ULT
               ELSE
      *        Si el capital calculado no es mayor que el resto del docu
      *        Calcula valor final
      *        En el caso de interes prorrateado segun capital de cada c
      *        saca la proporcion del saldo de interes correspondiente
               ADD AYF-CAPI , AYF-IDNI GIVING AYF-FINA
               MOVE 0 TO AYF-IDNI
               IF DLC-MIPL(VEN-IDLC) = CIC-MIPL-P
                   MULTIPLY AYF-SINT BY AYF-CAPI GIVING AYF-VAUX
                   DIVIDE AYF-SCPA INTO AYF-VAUX
                   IF OPC-COD-VCOC IN OPC = CIC-VLR-MNAC
      *                Si es moneda nacional redondea sin centavos y
      *                suma la proporcion de interes al valor final
      *                y lo resta al saldo de interes
                       MOVE AYF-VAUX TO PES-SGV-DECI
                       PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE TO AYF-VAUX
                       ADD AYF-VAUX TO AYF-FINA
                       SUBTRACT AYF-VAUX FROM AYF-SINT
                   ELSE
      *                suma la proporcion de interes al valor final
      *                y lo resta al saldo de interes
                       ADD AYF-VAUX TO AYF-FINA
                       SUBTRACT AYF-VAUX FROM AYF-SINT
      *
               ELSE
      *            Si el manejo del saldo de interes no es prorrateado
      *            suma el saldo de interes al valor final y
      *            deja el saldo de intereses en 0
                   ADD AYF-SINT TO AYF-FINA
                   MOVE 0 TO AYF-SINT.
       CON-CAL-AYF.
      *Actualiza saldo insoluto restando el valor del capital
           SUBTRACT AYF-CAPI FROM AYF-SCPA.
       FIN-CAL-AYF.
           EXIT.

       CAL-AYF-ULT SECTION.
       INI-CAL-AYF-ULT.
      *Setea que es el ultimo vencimiento
           MOVE 'S' TO AYF-IULT.
      *En este caso con el vencimiento actual se cancela todo el documen
      *Mueve el saldo insoluto al capital total
           MOVE AYF-SCPA TO AYF-CAPI.
      *Si la tasa de interes es estimada el valor final = 0, ya
      *que no se conoce realmente
      *JSS-INI 13-JUN-1997
      *    IF INT-IETB > SPACES
           IF INT-IETB > SPACES AND ( VEN-KEST NOT = 'S' )
      *JSS-FIN 13-JUN-1997
               MOVE 0 TO AYF-FINA
           ELSE
      *    Suma el saldo insoluto, intereses devengados para obtener val
      *    final ademas si el manejo de interes es prorrateado segun cap
      *    de cada cuota suma al valor final el saldo de los intereses
               ADD AYF-CAPI , AYF-IDNI GIVING AYF-FINA
               MOVE 0 TO AYF-IDNI
               IF DLC-MIPL(VEN-IDLC) = CIC-MIPL-P
                   ADD AYF-SINT TO AYF-FINA
                   MOVE 0 TO AYF-SINT.
       FIN-CAL-AYF-ULT.
           EXIT.

      *JSS-INI 28-FEB-1994
       COM-REG-VEN SECTION.
       INI-COM-REG-VEN.
           MOVE 0 TO VEN-AUXI.
           MOVE VEN-NUM-IDLC IN VEN TO VEN-IDLC.
           PERFORM LOD-RDLC.
           IF NOT VEN-STAT-OKS
               GO TO FIN-COM-REG-VEN.
      *Calcula numero de vencimientos cancelados
           IF OPC-NUM-TVCC IN OPC NOT > ZEROES
               ADD OPC-NUM-VCCO IN OPC
                   OPC-NUM-VCCM IN OPC
                   OPC-NUM-VCCV IN OPC GIVING VEN-VCAN
           ELSE
               MOVE OPC-NUM-TVCC IN OPC TO VEN-VCAN.
      *Si estan todos los vencimientos cancelados resta 1 al numero de
      *vencimientos cancelados como un 'truco' para no considerarlos
      *posteriormente
           IF OPC-NUM-VCVG IN OPC NOT > ZEROES
               SUBTRACT 1 FROM VEN-VCAN.
      *
           MOVE 'A' TO VEN-IVAS.
           PERFORM OBT-EVC.
           IF NOT VEN-STAT-OKS
               GO TO FIN-COM-REG-VEN.
      *
           IF OPC-VAL-SCRE IN OPC NOT > 0
               IF VEN-NUM-IVCT IN VEN = OPC-NUM-IVEN IN OPC
                   IF VEN-NUM-IVCT IN VEN = 1
                       MOVE OPC-FEC-FCOL IN OPC TO VEN-FMAX
                       GO TO CON-COM-REG-VEN
                   ELSE
                       PERFORM ANT-EVC
                       PERFORM DEC-VEN
                       IF NOT VEN-STAT-OKS
                           GO TO FIN-COM-REG-VEN
                       ELSE
                           GO TO CON-COM-REG-VEN
               ELSE
                   NEXT SENTENCE
           ELSE
           IF VEN-NUM-IVCT IN VEN = 1
               IF DLC-FEC-FDEV IN DLC > OPC-FEC-FCOL IN OPC
                   MOVE DLC-FEC-FDEV IN DLC TO VEN-FMAX
                   GO TO CON-COM-REG-VEN
               ELSE
                   MOVE OPC-FEC-FCOL IN OPC TO VEN-FMAX
                   GO TO CON-COM-REG-VEN.
      *
           PERFORM ANT-EVC.
           PERFORM DEC-VEN.
           IF NOT VEN-STAT-OKS
               GO TO FIN-COM-REG-VEN.
      *Compara la fecha del DLC con la FMAX del VEN anterior
      *FMAX = MAX(FDEV,FVEN anterior) y continua
           IF DLC-FEC-FDEV IN DLC > VEN-FMAX
               MOVE DLC-FEC-FDEV IN DLC TO VEN-FMAX.
       CON-COM-REG-VEN.
      *FUNO = MIN(CANDIDATO=MAX(FDEV,FCOL o FVEN anterior),FVEN actual)
           IF VEN-FEC-FVEN IN VEN < VEN-FMAX
               MOVE VEN-NUM-DVEN IN VEN TO INT-DUNO
               MOVE VEN-NUM-MVEN IN VEN TO INT-MUNO
               MOVE VEN-NUM-SVEN IN VEN TO INT-SUNO
               MOVE VEN-NUM-AVEN IN VEN TO INT-AUNO
           ELSE
               MOVE VEN-DMAX TO INT-DUNO
               MOVE VEN-MMAX TO INT-MUNO
               MOVE VEN-SMAX TO INT-SUNO
               MOVE VEN-AMAX TO INT-AUNO.
      *Carga FDOS, FCOL, FBTV, VCAM, IOPC, IDLC y llama a rutina GNS-CAL
      *para obtener tasa de periodo
           MOVE VEN-NUM-DVEN IN VEN     TO INT-DDOS.
           MOVE VEN-NUM-MVEN IN VEN     TO INT-MDOS.
           MOVE VEN-NUM-SVEN IN VEN     TO INT-SDOS.
           MOVE VEN-NUM-AVEN IN VEN     TO INT-ADOS.

           MOVE OPC-NUM-DCOL IN OPC     TO INT-DCOL.
           MOVE OPC-NUM-MCOL IN OPC     TO INT-MCOL.
           MOVE OPC-NUM-SCOL IN OPC     TO INT-SCOL.
           MOVE OPC-NUM-ACOL IN OPC     TO INT-ACOL.

           IF VEN-FTBS > ZEROES
               MOVE VEN-DTBS TO INT-DBTV
               MOVE VEN-MTBS TO INT-MBTV
               MOVE VEN-STBS TO INT-SBTV
               MOVE VEN-ATBS TO INT-ABTV
           ELSE
               MOVE OPC-NUM-DCOL IN OPC TO INT-DBTV
               MOVE OPC-NUM-MCOL IN OPC TO INT-MBTV
               MOVE OPC-NUM-SCOL IN OPC TO INT-SBTV
               MOVE OPC-NUM-ACOL IN OPC TO INT-ABTV.

           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           MOVE OPC-CIC-IOPC IN OPC     TO INT-IOPC.
           MOVE VEN-NUM-IDLC IN VEN     TO INT-IDLC.
      *     PERFORM GNS-CAL-INT.
           PERFORM COL-CAL-INT.
      *SMC-FIN 09.09.1993
           IF INT-CMSG > SPACES
               MOVE INT-CMSG TO VEN-STAT
               MOVE INT-MEN2 TO VEN-MEN2
               GO TO FIN-COM-REG-VEN.
      *
      *Por definicion al entrar a esta SECTION el VEN esta incompleto
      *Si esta completo en terminos de final, el capital es 0 y por lo
      *tanto la instruccion ADD no afecta.
      *Si esta completo en terminos de capital, entonces el SCPA
      *ya ha sido rebajado, con lo cual el ADD deja el SCPA con el
      *saldo corregido para el calculo de interes respectivo
           IF OPC-VAL-SCRE IN OPC > 0
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE GIVING
                    AYF-SINT ROUNDED
           ELSE
      *JSS-INI 26-AUG-1994 Se suma el SCAP en vez del CAPI ya que
      *pueden existir pagos parciales a cuotas de capital conocido
      *        ADD VEN-VAL-CAPI IN VEN TO DLC-SCPA(VEN-IDLC)
               ADD VEN-VAL-SCAP IN VEN TO DLC-SCPA(VEN-IDLC)
      *JSS-FIN 26-AUG-1994
               MULTIPLY DLC-SCPA(VEN-IDLC) BY INT-TIPE GIVING
                        AYF-SINT ROUNDED.
      *
           MOVE OPC-COD-VCOC IN OPC TO PES-COD-VCAM.
           MOVE AYF-SINT  TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO AYF-SINT.
      *
      *Si a la cuota le falta el valor final, lo completa con el interes
      *correspondiente
           IF VEN-VAL-FINA IN VEN = 0
      *JSS-INI 26-AUG-1994 Se suma el SCAP en vez del CAPI ya que
      *pueden existir pagos parciales a cuotas de capital conocido
      *        ADD AYF-SINT VEN-VAL-CAPI IN VEN GIVING
               ADD AYF-SINT VEN-VAL-SCAP IN VEN GIVING
                            VEN-VAL-FINA IN VEN
      *JSS-FIN 26-AUG-1994
               MOVE VEN-VAL-FINA IN VEN TO VEN-VAL-SFIN IN VEN
           ELSE
      *Si a la cuota le falta el valor capital, lo completa con el inter
      *correspondiente
               MOVE 1 TO VEN-AUXI
               SUBTRACT AYF-SINT FROM VEN-VAL-FINA IN VEN
                               GIVING VEN-VAL-CAPI IN VEN
               MOVE VEN-VAL-CAPI IN VEN TO VEN-VAL-SCAP IN VEN.

      *Verifica si el capital es mayor que el saldo del credito,
      *asume capital el saldo del credito
           IF OPC-VAL-SCRE IN OPC > 0
               IF VEN-VAL-SCAP IN VEN > OPC-VAL-SCRE IN OPC
                   MOVE OPC-VAL-SCRE IN OPC TO VEN-VAL-CAPI IN VEN
                   MOVE VEN-VAL-CAPI IN VEN TO VEN-VAL-SCAP IN VEN
                   ADD AYF-SINT VEN-VAL-CAPI IN VEN
                         GIVING VEN-VAL-FINA IN VEN
                   MOVE VEN-VAL-FINA IN VEN TO VEN-VAL-SFIN IN VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               IF VEN-VAL-SCAP IN VEN > DLC-SCPA(VEN-IDLC)
                   MOVE DLC-SCPA(VEN-IDLC)  TO VEN-VAL-CAPI IN VEN
                   MOVE VEN-VAL-CAPI IN VEN TO VEN-VAL-SCAP IN VEN
                   ADD AYF-SINT VEN-VAL-CAPI IN VEN
                         GIVING VEN-VAL-FINA IN VEN
                   MOVE VEN-VAL-FINA IN VEN TO VEN-VAL-SFIN IN VEN.

      *Si los intereses son mayores que el valor final ( se considera
      *la diferencia como intereses devengados no incluidos )
           IF AYF-SINT > VEN-VAL-FINA IN VEN
               SUBTRACT VEN-VAL-FINA IN VEN FROM AYF-SINT
                 GIVING VEN-VAL-IDNI IN VEN
               MOVE 0 TO VEN-VAL-CAPI IN VEN
               MOVE 0 TO VEN-VAL-SCAP IN VEN
           ELSE
               MOVE 0 TO VEN-VAL-IDNI IN VEN.
      *Si es la ultima cuota y el valor de capital es menor que el saldo
      *del credito, asume capital el saldo del credito
           IF VEN-FEC-FVEN IN VEN = DLC-FEC-FMAV IN DLC
               IF OPC-VAL-SCRE IN OPC > 0
                   IF VEN-VAL-SCAP IN VEN < OPC-VAL-SCRE IN OPC
                       MOVE OPC-VAL-SCRE IN OPC TO VEN-VAL-CAPI IN VEN
                       MOVE VEN-VAL-CAPI IN VEN TO VEN-VAL-SCAP IN VEN
                       ADD AYF-SINT VEN-VAL-CAPI IN VEN
                             GIVING VEN-VAL-FINA IN VEN
                       MOVE VEN-VAL-FINA IN VEN TO VEN-VAL-SFIN IN VEN
                       MOVE 0                   TO VEN-VAL-IDNI IN VEN
                   ELSE
                       NEXT SENTENCE
               ELSE
                   IF VEN-VAL-SCAP IN VEN < DLC-SCPA(VEN-IDLC)
                       MOVE DLC-SCPA(VEN-IDLC)  TO VEN-VAL-CAPI IN VEN
                       MOVE VEN-VAL-CAPI IN VEN TO VEN-VAL-SCAP IN VEN
                       ADD AYF-SINT VEN-VAL-CAPI IN VEN
                             GIVING VEN-VAL-FINA IN VEN
                       MOVE VEN-VAL-FINA IN VEN TO VEN-VAL-SFIN IN VEN
                       MOVE 0                   TO VEN-VAL-IDNI IN VEN.
      *
           MOVE OPC-COD-VCOC IN OPC TO PES-COD-VCAM.
           MOVE VEN-VAL-CAPI IN VEN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-CAPI IN VEN.
      *
           MOVE OPC-COD-VCOC IN OPC TO PES-COD-VCAM.
           MOVE VEN-VAL-FINA IN VEN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-FINA IN VEN.
      *
      *Solo si la cuota la completo con capital, tengo que restar
      *al SCPA
           IF VEN-AUXI = 1
               SUBTRACT VEN-VAL-SCAP IN VEN FROM
                        DLC-SCPA(VEN-NUM-IDLC IN VEN).
           IF VEN-NUM-IVCT IN VEN = 1
               GO TO FIN-COM-REG-VEN.
           MOVE 'S' TO VEN-IVAS.
           PERFORM OBT-FYJ.
           MOVE EVC-JPVC(VEN-IEVC) TO AYF-JAMT.
           PERFORM ACT-VDLC.
       FIN-COM-REG-VEN.
           EXIT.
      *JSS-FIN 28-FEB-1994

       ACT-VDLC SECTION.
       INI-ACT-VDLC.
      *Actualiza el Juliano de la amortizacion del Documento Y
      *Mueve la fecha del vencimiento a la fecha de amortizacion del
      *documento ( Recordar que existen por cada 'vencimiento' dos fecha
      *la FPVC que es la fecha del vencimiento sin analisis de feriado y
      *la FFVC que es la fecha del vencimiento mas analisis de feriado )
           MOVE 1 TO VEN-IVCC.
       AMT-ACT-VDLC.
           MOVE VEN-VVCC(VEN-IVCC) TO VEN-IEVC.
           IF EVC-TCVE(VEN-IEVC) = 'IO' OR 'CO' OR 'FO' OR 'CE'
               IF EVC-IDLC(VEN-IEVC) = 0
                   MOVE EVC-IVCT(VEN-IEVC) TO VEN-IDLC
                   MOVE AYF-JAMT TO DLC-JAMT(VEN-IDLC)
                   MOVE EVC-DFVC(VEN-IEVC) TO DLC-DAMT(VEN-IDLC)
                   MOVE EVC-MFVC(VEN-IEVC) TO DLC-MAMT(VEN-IDLC)
                   MOVE EVC-SFVC(VEN-IEVC) TO DLC-SAMT(VEN-IDLC)
                   MOVE EVC-AFVC(VEN-IEVC) TO DLC-AAMT(VEN-IDLC)
               ELSE
                   MOVE EVC-IDLC(VEN-IEVC) TO VEN-IDLC
                   MOVE AYF-JAMT TO DLC-JAMT(VEN-IDLC)
                   MOVE EVC-DFVC(VEN-IEVC) TO DLC-DAMT(VEN-IDLC)
                   MOVE EVC-MFVC(VEN-IEVC) TO DLC-MAMT(VEN-IDLC)
                   MOVE EVC-SFVC(VEN-IEVC) TO DLC-SAMT(VEN-IDLC)
                   MOVE EVC-AFVC(VEN-IEVC) TO DLC-AAMT(VEN-IDLC).
           ADD 1 TO VEN-IVCC.
           IF VEN-IVCC NOT > VEN-MVCC
               GO TO AMT-ACT-VDLC.
      *
           MOVE VEN-VVCC(1) TO VEN-IEVC.
       FIN-ACT-VDLC.
           EXIT.

       ANL-FRD-FINT SECTION.
       INI-ANL-FRD-FINT.
           MOVE INT-DDMA TO FEC-ITM1.
           MOVE INT-MDMA TO FEC-ITM2.
           MOVE INT-SDMA TO FEC-ITM3.
           MOVE INT-ADMA TO FEC-ITM4.
       LUP-ANL-FRD-FINT.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-ITM1 TO INT-DDMA
               MOVE FEC-ITM2 TO INT-MDMA
               MOVE FEC-ITM3 TO INT-SDMA
               MOVE FEC-ITM4 TO INT-ADMA
               GO TO FIN-ANL-FRD-FINT.
           IF NOT FEC-STAT-FER
               MOVE MSG-COD-MENS TO VEN-STAT
               GO TO FIN-ANL-FRD-FINT.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE MSG-COD-MENS TO VEN-STAT
           ELSE
               GO TO LUP-ANL-FRD-FINT.
       FIN-ANL-FRD-FINT.
           EXIT.

       BUS-PINT SECTION.
       INI-BUS-PINT.
      *Carga los parametros para obtener tasa de interes
           MOVE DLC-TINT(VEN-IDLC)  TO INT-TINT.
           MOVE OPC-COD-VCOC IN OPC TO INT-VCAM.

           MOVE DLC-DAMT(VEN-IDLC)  TO INT-DUNO.
           MOVE DLC-MAMT(VEN-IDLC)  TO INT-MUNO.
           MOVE DLC-SAMT(VEN-IDLC)  TO INT-SUNO.
           MOVE DLC-AAMT(VEN-IDLC)  TO INT-AUNO.
           MOVE EVC-DFVC(VEN-IEVC)  TO INT-DDOS.
           MOVE EVC-MFVC(VEN-IEVC)  TO INT-MDOS.
           MOVE EVC-SFVC(VEN-IEVC)  TO INT-SDOS.
           MOVE EVC-AFVC(VEN-IEVC)  TO INT-ADOS.

           MOVE OPC-NUM-DCOL IN OPC TO INT-DCOL INT-DBTV.
           MOVE OPC-NUM-MCOL IN OPC TO INT-MCOL INT-MBTV.
           MOVE OPC-NUM-SCOL IN OPC TO INT-SCOL INT-SBTV.
           MOVE OPC-NUM-ACOL IN OPC TO INT-ACOL INT-ABTV.
      *SMC-INI 07.09.1993
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC.
           MOVE 1                   TO INT-IDLC.
      *SMC-FIN 07.09.1993
       FIN-BUS-PINT.
           EXIT.


       COPY COLBGINT.
       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFRCV.
       COPY COLBFVEN.
       COPY COLBFEVC.
      * COPY COLBFDCC.
       COPY COLBFICG.
      * COPY COLBFITR.
       COPY COLBFTOC.
       COPY TABBFCAM.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
      * COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBGDTC.

      * COPY GNSBGIDD.
       COPY GNSB2IDD.

       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGPES.

