       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLCDC.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    24-Jan-96 04:41 PM.

      * Programa Listador de Reporte CDC con Sort.
000000*COMPILED SITE 2000          09.10.98

      ******************************************************************
      *  INTERSOFT                                                     *
      *  MODIFICACION: CONVERTIR REPORT-WRITER A LISTADO, MIGRAR A     *
      *                A COBOL FOR MVS Y CONVERSION 2000               *
      *  FECHA: ABRIL 1998                                             *
      ******************************************************************

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTCDC         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTCDC         ASSIGN TO        UT-S-RPTCDC.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.

      **** CRW-COMIENZO
      *    SELECT RPTCDC         ASSIGN TO        UT-S-RPTCDC.
           SELECT RPTCDC         ASSIGN TO             RPTCDC.
      **** CRW-FINAL

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY COLRRCDC.

      **** CRW-COMIENZO
      *FD  RPTCDC LABEL RECORDS OMITTED
      *    REPORT IS RPT-CDC
      *    .
       FD  RPTCDC
           BLOCK CONTAINS 0 RECORDS
           LABEL RECORD STANDARD.

       01  RPTCDC-REG           PIC X(133).
      ***** CRW-FINAL

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBROPC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWCDC.
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY SGCBRDBC.
      *DAD ini  07-SEP-1993
       COPY COLBRRLQ.
      *DAD fin  07-SEP-1993
      *DAD ini  05-APR-1991
       COPY COLBRCYA.
      *DAD fin  05-APR-1991
       COPY COLBRRCV.
       COPY SGCBRRCD.
       COPY COLBRTOC.
       COPY COLBRRDC.
       COPY COLBRDLC.
       COPY COLBRVEN.
       COPY COLBREVC.
       COPY COLBRICG.
       COPY COLBRPOC.
      *DAD ini  14-AGO-1991
      * COPY COLBRRCE.
      *DAD fin  14-AGO-1991
       COPY COLWGVEN.
       COPY COLWGVIN.
      *DAD ini  06-AGO-1991 / 23-ABR-1991
       COPY TABBRTIO.
       COPY COLWGCTO.
      *DAD fin  06-AGO-1991 / 23-ABR-1991
       COPY TABBROFI.
       COPY TABBRVLR.
       COPY TABBRCAM.
       COPY GNSWGCPT.
       COPY GNSWGPES.

      *SMC-INI 13.09.1993
       COPY COLWGINT.
      *SMC-FIN 13.09.1993
       COPY GNSWGCVI.

       01  WSS-VARI.
           03 WSS-MSG-MENS.
              05 WSS-MSG-COOC.
                 07 WSS-MSG-TOOC                    PIC X(03).
                 07 WSS-MSG-AOOC                    PIC X(03).
              05 WSS-MSG-CUPO                       PIC X(06).
      *ALD-BCI-FIN/07.04.1999
           03  WSS-COD-TVOC.
               05  WSS-MSC-TVAL                      PIC X(01).
               05  WSS-MSC-REST                      PIC X(04).
           03  WSS-CIC-CTAB                          PIC X(01).
           03  WSS-IND-SEL1          VALUE SPACES    PIC X(01).
           03  WSS-IND-SEL2          VALUE SPACES    PIC X(01).
           03  WSS-NUM-NVTV                          PIC 9(03).
           03  WSS-IVEN.
               05  WSS-NUM-IVEN                      PIC 9(03).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-DTER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
      *DAD ini  05-APR-1991
           03  WSS-FEC-FFEC.
               05  WSS-NUM-SFEC                      PIC 9(02).
               05  WSS-NUM-AFEC                      PIC 9(02).
               05  WSS-NUM-MFEC                      PIC 9(02).
               05  WSS-NUM-DFEC                      PIC 9(02).
           03  WSS-FEC-FFET.
               05  WSS-NUM-SFET                      PIC 9(02).
               05  WSS-NUM-AFET                      PIC 9(02).
               05  WSS-NUM-MFET                      PIC 9(02).
               05  WSS-NUM-DFET                      PIC 9(02).
      *DAD fin  05-APR-1991
           03  WSS-COD-TRPT             VALUE SPACES PIC X(01).
           03  WSS-COD-OFIP             VALUE SPACES PIC X(03).
           03  WSS-COD-OFOC         VALUE LOW-VALUES PIC X(03).
           03  WSS-COD-VCOC         VALUE LOW-VALUES PIC X(06).
           03  WSS-CAI-ICLI         VALUE LOW-VALUES PIC X(04).
           03  WSS-IIC-ICLI         VALUE LOW-VALUES PIC X(08).
           03  WSS-CIC-IOPC.
               05 WSS-CAI-IOPC         VALUE SPACES  PIC X(04).
               05 WSS-IIC-IOPC         VALUE SPACES  PIC X(08).
           03  WSS-COD-LUGA.
               05 WSS-IND-LUGA                       PIC X(01).
               05 WSS-COD-PAIS                       PIC X(03).
      * Para creditos antiguos
           03  WSS-KEY-SAFE.
               05 WSS-CAM-CABE                       PIC X(11).
               05 WSS-CAM-FINA                       PIC X(01).
      * Para creditos nuevos
           03  WSS-KEY-IDLC.
               05 WSS-COD-TOPC                       PIC X(01).
               05 WSS-GLS-NOPC                       PIC X(11).
      *RVM-CST-INI 23-JAN-1996
           03  WSS-NUM-PAGI      VALUE ZEROES        PIC 9(05).
      *RVM-CST-FIN 23-JAN-1996
      *>>>>
      *<<<< WSS_DTC
      *DAD ini  05-APR-1991
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
      *DAD fin  05-APR-1991
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
      *DAD ini  14-AGO-1991
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
      *DAD fin  14-AGO-1991
      *>>>>

      ***** CRW-COMIENZO

      *REPORT SECTION.
      *--------------
      *COPY COLRFCDC.
      *    .
      *COPY COLRTCDC.

       01  RPT-VARIABLES.
           02 RPT-VARIABLES-VARIAS.
              03 RPT-VARI-LINEA              PIC 9(03) VALUE 60.
              03 RPT-VARI-PAGE-COUNTER       PIC 9(03).

       01  DL-CDC.

           03  DL-CDC-01.
               05  FILLER                     PIC X(010) VALUE SPACES.
               05  RPT-DETA-GLS-DESC-1        PIC X(40).
               05  FILLER                     PIC X(027) VALUE SPACES.
               05  RPT-DETA-GLS-DATA          PIC X(27).

           03  DL-CDC-02.
               05  RPT-DETA-GLS-DEUD          PIC X(40).
               05  FILLER                     PIC X(027) VALUE SPACES.
               05  RPT-DETA-GLS-PGD2          PIC X(27).

           03  DL-CDC-03.
               05  RPT-DETA-GLS-DIRE          PIC X(40).

           03  DL-CDC-04.
               05  RPT-DETA-GLS-LUGA          PIC X(40).
               05  FILLER                     PIC X(037) VALUE SPACES.
               05  RPT-DETA-COD-OFOC          PIC X(3).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-DESC          PIC X(11).

           03  DL-CDC-05.
               05  FILLER                     PIC X(077) VALUE SPACES.
               05  RPT-DETA-CAI-IOPC-1        PIC X(4).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IIC-IOPC-1        PIC 9(8).

           03  DL-CDC-06.
               05  RPT-DETA-GLS-MSJE          PIC X(40).
               05  FILLER                     PIC X(037) VALUE SPACES.
               05  RPT-DETA-NUM-IVCT-1        PIC ZZZ.
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-IVCT          PIC X(2).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-NUM-VCOR-1        PIC ZZZ.

           03  DL-CDC-07.
               05  RPT-DETA-GLS-DCTT          PIC X(12).
               05  FILLER                     PIC X(065) VALUE SPACES.
               05  RPT-DETA-COD-CSAF          PIC X(12).

           03  DL-CDC-08.
               05  RPT-DETA-GLS-PGD1          PIC X(40).
               05  FILLER                     PIC X(037) VALUE SPACES.
               05  RPT-DETA-IND-TCAM          PIC X.

           03  DL-CDC-09.
               05  FILLER                     PIC X(077) VALUE SPACES.
               05  RPT-DETA-NUM-DVEN-1        PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MVEN-1        PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SVEN-1        PIC 9(2).
               05  RPT-DETA-NUM-AVEN-1        PIC 9(2).

           03  DL-CDC-10.
               05  FILLER                     PIC X(006) VALUE SPACES.
               05  RPT-DETA-CAI-IOPC-2        PIC X(4).
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-IIC-IOPC-2        PIC 9(8).
               05  FILLER                     PIC X(022) VALUE SPACES.
               05  RPT-DETA-NUM-IVCT-2        PIC ZZZ.
               05  RPT-DETA-GLS-SLAS          PIC X.
               05  RPT-DETA-NUM-VCOR-2        PIC ZZZ.

           03  DL-CDC-11.
               05  RPT-DETA-GLS-TINT          PIC X(10).
               05  FILLER                     PIC X(001) VALUE SPACES.
      *CAH-INI 17-ENE-2000
      *        05  RPT-DETA-SGV-TINT          PIC --,---.
               05  RPT-DETA-SGV-TINT          PIC ---,---.
      *CAH-FIN 17-ENE-2000
               05  FILLER                     PIC X(001) VALUE SPACES.
               05  RPT-DETA-GLS-TIPT          PIC X(5).
      *CAH-INI 17-ENE-2000
      *        05  FILLER                     PIC X(018) VALUE SPACES.
               05  FILLER                     PIC X(017) VALUE SPACES.
      *CAH-FIN 17-ENE-2000
               05  RPT-DETA-GLS-MONE-1        PIC X(5).
               05  FILLER                     PIC X(038) VALUE SPACES.
               05  RPT-DETA-GLS-MONE-2        PIC X(5).

           03  DL-CDC-12.
               05  FILLER                     PIC X(009) VALUE SPACES.
               05  RPT-DETA-NUM-DVEN-2        PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-MVEN-2        PIC 9(2).
               05  FILLER                     PIC X(1)
                   VALUE ALL '-'.
               05  RPT-DETA-NUM-SVEN-2        PIC 9(2).
               05  RPT-DETA-NUM-AVEN-2        PIC 9(2).
               05  FILLER                     PIC X(013) VALUE SPACES.
               05  RPT-DETA-VAL-FINA-1        PIC ZZZZZ.ZZZ.ZZ9,9999.
               05  FILLER                     PIC X(027) VALUE SPACES.
               05  RPT-DETA-VAL-FINA-2        PIC ZZZZZ.ZZZ.ZZ9,9999.
               05  RPT-DETA-COD-TINT          PIC X(12).
               05  RPT-DETA-COD-TRPT          PIC X.

      ***** CRW-FINAL

       PROCEDURE DIVISION.
      *==================

      ***** CRW-COMIENZO
      *DECLARATIVES.
      *END DECLARATIVES.
      ***** CRW-FINAL

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPLCDC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      *Captura tipo de Reporte
           DISPLAY 'TIPO DE REPORTE ( Cuponera/Aviso vencimiento ) : '.
           ACCEPT  WSS-COD-TRPT IN WSS-VARI.
           DISPLAY WSS-COD-TRPT IN WSS-VARI.
      *Captura Codigo de Operacion
           DISPLAY 'CENTRO ASIGNACION : '.
           ACCEPT  WSS-CAI-IOPC IN WSS-VARI.
           DISPLAY WSS-CAI-IOPC IN WSS-VARI.
           DISPLAY 'IDENTIFICACION OPERACION : '.
           ACCEPT  WSS-IIC-IOPC IN WSS-VARI.
           DISPLAY WSS-IIC-IOPC IN WSS-VARI.
      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMAAAA ) : '
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA : '.
           ACCEPT  WSS-COD-OFIP IN WSS-VARI.
           DISPLAY WSS-COD-OFIP IN WSS-VARI.
      *Captura Numero del Vencimiento
           DISPLAY 'VENCIMIENTO : '.
           ACCEPT  WSS-IVEN IN WSS-VARI.
           DISPLAY WSS-IVEN IN WSS-VARI.

           DISPLAY 'FIN CAPTURA DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *DAD ini  05-APR-1991
      * Valida Tipo de Reporte ingresado como parametro
           IF WSS-COD-TRPT IN WSS-VARI NOT > SPACES
               DISPLAY 'ERROR : DEBE DIGITAR CODIGO PARA SOLICITAR '
                       'CUPONERA  o  AVISO DE VENCIMIENTO'
               PERFORM GNS-PRO-END
           ELSE
      *DAD fin  05-APR-1991
               MOVE 'COL'                    TO TAB-COD-SIST
               MOVE 'CDC'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-TRPT IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY 'TIPO DE REPORTE INVALIDO : '
                           WSS-COD-TRPT IN WSS-VARI
                   PERFORM GNS-PRO-END
               ELSE
      *DAD ini  05-APR-1991
                   MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI
                   IF WSS-CIC-CTAB IN WSS-VARI NOT = 'C' AND
                      WSS-CIC-CTAB IN WSS-VARI NOT = 'A'
                       DISPLAY 'ERROR : DEBE DIGITAR CODIGO VALIDO PARA'
                               ' CUPONERA  o  AVISO DE VENCIMIENTO'
                       PERFORM GNS-PRO-END.
      *DAD fin  05-APR-1991

      * Chequea Numero de Vencimiento ingresado como parametro
           IF WSS-IVEN IN WSS-VARI > SPACES AND
              WSS-IVEN IN WSS-VARI NOT NUMERIC
               DISPLAY 'NUMERO DE VENCIMENTO INVALIDO : '
                       WSS-IVEN IN WSS-VARI
               PERFORM GNS-PRO-END.
           IF WSS-IVEN IN WSS-VARI NOT > SPACES
               MOVE ZEROES TO WSS-NUM-IVEN IN WSS-VARI.

      * Chequea Codigo Operacion ingresada como parametro
           IF WSS-CIC-IOPC IN WSS-VARI > SPACES
               IF WSS-CIC-IOPC IN WSS-VARI = '*'
                   MOVE '*' TO WSS-IND-SEL1 IN WSS-VARI
                   GO TO NXT-INP
               ELSE
                   MOVE 'O' TO WSS-IND-SEL1 IN WSS-VARI
                   IF WSS-NUM-IVEN IN WSS-VARI > ZEROES
                       MOVE 'V' TO WSS-IND-SEL2 IN WSS-VARI
                       GO TO NXT-INP
                   ELSE
                       GO TO NXT-INP.
      *DAD ini  13-MAY-1991
           MOVE 'F' TO WSS-IND-SEL1 IN WSS-VARI.
      *DAD fin  13-MAY-1991

      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC             TO FEC-FORM.
           MOVE FEC-FBLK-N               TO FEC-FBLK.
      *DAD ini  23-MAY-1991
           MOVE FEC-VHBL-N               TO FEC-VHBL.
           IF WSS-CIC-CTAB IN WSS-VARI = 'A'
               MOVE FEC-CHOY-N TO FEC-CHOY.
      *DAD fin  23-MAY-1991
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.

      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC             TO FEC-FORM.
           MOVE FEC-FBLK-N               TO FEC-FBLK.
      *DAD ini  23-MAY-1991 / 24-ABR-1991
           MOVE FEC-VHBL-N               TO FEC-VHBL.
           IF WSS-CIC-CTAB IN WSS-VARI = 'A'
               MOVE FEC-CHOY-N TO FEC-CHOY.
      *DAD fin  23-MAY-1991 / 24-ABR-1991
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               PERFORM GNS-PRO-END.
      *DAD ini  05-APR-1991
           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AFEC IN WSS-VARI.
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DFET IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MFET IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-SFET IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-AFET IN WSS-VARI.
      *DAD fin  05-APR-1991

      *DAD ini  06-AGO-1991
      * Valida codigo de Oficina ingresada como parametro en TABLAS
           IF WSS-COD-OFIP IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-OFIP IN WSS-VARI.
           IF WSS-COD-OFIP IN WSS-VARI NOT = '*'
      *DAD fin  06-AGO-1991
               DISPLAY WSS-COD-OFIP IN WSS-VARI
               MOVE WSS-COD-OFIP IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY MSG-GLS-MENS
                   PERFORM GNS-PRO-END.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
       NXT-INP.
      * Busca CIC de moneda nacional
           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               MOVE MSC-COD-CMSC IN MSC TO WSS-COD-TVOC IN WSS-VARI
           ELSE
               DISPLAY 'NO EXISTE CODIGO EN MSC TVAL CON CIC = 0 '
               PERFORM GNS-PRO-END.

      *DAD ini  06-AGO-1991
      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
               PERFORM GNS-PRO-END.
      *DAD fin  06-AGO-1991
      *DAD ini  07-SEP-1993
      *    MOVE FIO-INP TO FIO-CMND.
      *    PERFORM COL-FIO-RLQ.
      *DAD fin  07-SEP-1993
      *>>>>
           SORT GNSSRT
       COPY COLRSCDC.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
      *<<<< FIN
           MOVE RPT-VARI-PAGE-COUNTER   TO WSS-NUM-PAGI IN WSS-VARI.
           DISPLAY ' '.
           DISPLAY 'ESTADISTICAS COLPLCDC'.
           DISPLAY '---------------------'.
           DISPLAY 'NUMERO DE PAGINAS A IMPRIMIR : '
                WSS-NUM-PAGI IN WSS-VARI.
      *>>>>
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       FST-INP-SRT.
      *<<<< INI_FST_INP
      *DAD ini  13-MAY-1991
           IF WSS-IND-SEL1 IN WSS-VARI = '*'
               GO TO CON-INP-SRT
           ELSE
      *DAD fin  13-MAY-1991
      * Lee Credito Especifico ingresado como parametro
           IF WSS-IND-SEL1 IN WSS-VARI = 'O'
               MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
                   GO TO LUP-INP-SRT
               ELSE
                   DISPLAY 'OPERACION INEXISTENTE : '
                           OPC-CIC-IOPC IN OPC
      *DAD ini  06-AGO-1991
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.
      *DAD fin  06-AGO-1991

      *DAD ini  13-MAY-1991
      * Lee primer registro OPC con Fecha Inicial del rango de fechas
           IF WSS-CIC-CTAB IN WSS-VARI = 'C'
      *DAD ini  13-MAY-1992
               MOVE WSS-FEC-FFEC IN WSS-VARI TO OPC-FEC-FINP IN OPC
               MOVE 'OPC-FEC-FINP' TO FIO-AKEY
      *DAD fin  13-MAY-1992
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS OR
      *DAD ini  13-MAY-1992
                  OPC-FEC-FINP IN OPC > WSS-FEC-FFET IN WSS-VARI
      *DAD fin  13-MAY-1992
                   DISPLAY 'NO HAY REGISTROS OPC PARA RANGO DE FECHAS :'
                           ' DESDE ' WSS-FEC-FINI IN WSS-VARI ' A '
                                     WSS-FEC-FTER IN WSS-VARI
      *DAD ini  06-AGO-1991
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT
      *DAD fin  06-AGO-1991
               ELSE
                   GO TO LUP-INP-SRT.

      * Lee primer registro VEN con Fecha Inicial del rango de fechas
           IF WSS-CIC-CTAB IN WSS-VARI = 'A'
               MOVE WSS-FEC-FFEC IN WSS-VARI TO VEN-FEC-FVEN IN VEN
               MOVE 'VEN-FEC-FVEN' TO FIO-AKEY
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS OR
                  VEN-FEC-FVEN IN VEN > WSS-FEC-FFET IN WSS-VARI
                   DISPLAY 'NO HAY REGISTROS VEN PARA RANGO DE FECHAS :'
                           ' DESDE ' WSS-FEC-FINI IN WSS-VARI ' A '
                                     WSS-FEC-FTER IN WSS-VARI
      *DAD ini  06-AGO-1991
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT
      *DAD fin  06-AGO-1991
               ELSE
                   MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   IF FIO-STAT-OKS
                       GO TO LUP-INP-SRT
                   ELSE
                       DISPLAY 'OPERACION INEXISTENTE : '
                                OPC-CIC-IOPC IN OPC
      *DAD ini  06-AGO-1991
                       MOVE PGM-SMAL TO PGM-STAT-SRT
                       GO TO FIN-INP-SRT.
      *DAD fin  06-AGO-1991
       CON-INP-SRT.
      *DAD fin  13-MAY-1991
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
      *NO ESTA ACTUALIZADO CAMPO VCOR.
           IF OPC-NUM-TVCC IN OPC NOT > ZEROES
               ADD OPC-NUM-VCVG IN OPC
                   OPC-NUM-VCCO IN OPC
                   OPC-NUM-VCCM IN OPC
                   OPC-NUM-VCCV IN OPC GIVING OPC-NUM-VCOR IN OPC
           ELSE
               ADD OPC-NUM-VCVG IN OPC
                   OPC-NUM-TVCC IN OPC GIVING OPC-NUM-VCOR IN OPC.
      *
      * Selecciona Creditos Otorgados Solo en Moneda Nacional
           IF OPC-MSC-TVOC IN OPC NOT = WSS-MSC-TVAL IN WSS-VARI
               GO TO GET-NXT-OPC.

      * Selecciona Solo Creditos Activados
           IF OPC-MSC-STAT IN OPC NOT = 'A'
               GO TO GET-NXT-OPC.

      *DAD ini  13-MAY-1991
      * Verifica Credito tenga Saldo
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO GET-NXT-OPC.
      *DAD fin  13-MAY-1991

      * Selecciona Oficina del Credito igual a la del Parametro
           IF WSS-CIC-IOPC IN WSS-VARI NOT > SPACES AND
      *DAD ini  06-AGO-1991
              WSS-COD-OFIP IN WSS-VARI NOT = '*'
      *DAD fin  06-AGO-1991
               IF WSS-COD-OFIP IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO GET-NXT-OPC.

      *DAD ini  06-AGO-1991 / 23-ABR-1991
      * Busca con el Codigo Tipo Operacion en la Tabla cargada en Memori
      * 'Sistema que lo Maneja' y 'Opera Como'
           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
                       'CON CODIGO : '     CTO-TOOC IN CTO-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               GO TO GET-NXT-OPC.

      * Valida el 'Sistema que lo Maneja' de la Operacion de Credito
           IF CTO-SIST IN CTO-VARI NOT = 'COL'
               GO TO GET-NXT-OPC.
      *DAD fin  06-AGO-1991 / 23-ABR-1991

      * Lee Plantilla para el Credito
           MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC.
           MOVE ZEROES              TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'INDECDCNPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' : ' OPC-CIC-IOPC IN OPC
               GO TO GET-NXT-OPC
           ELSE
               IF POC-IND-ECDC IN POC NOT > SPACES
                   GO TO GET-NXT-OPC
               ELSE
                   MOVE 'COL'               TO TAB-COD-SIST
                   MOVE 'CDC'               TO TAB-COD-TTAB IN TAB
                   MOVE POC-IND-ECDC IN POC TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
      *DAD ini  05-APR-1991
                   MOVE TAB-CIC-CTAB IN TAB TO POC-IND-ECDC IN POC.
      *             MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI

      * Selecciona Credito con Indicador en Plantilla igual al Parametro
           IF WSS-CIC-CTAB IN WSS-VARI = 'C'
               IF POC-IND-ECDC IN POC = 'C'
                   MOVE WSS-COD-TRPT IN WSS-VARI TO SRT-COD-TRPT IN SRT
               ELSE
                   GO TO GET-NXT-OPC
           ELSE
           IF WSS-CIC-CTAB IN WSS-VARI = 'A'
               IF POC-IND-ECDC IN POC = 'A' OR
                  POC-IND-ECDC IN POC = 'S'
                   MOVE WSS-COD-TRPT IN WSS-VARI TO SRT-COD-TRPT IN SRT
               ELSE
                   GO TO GET-NXT-OPC.

      * Solo para el indicador en plantilla = 'C' o 'A' se omiten credit
      * cargo automatico en cte.cta.
           IF POC-IND-ECDC IN POC = 'C' OR
              POC-IND-ECDC IN POC = 'A'
               MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA
               MOVE 'AUT'               TO CYA-NUM-ICAN IN CYA
               MOVE ZEROES              TO CYA-NUM-ICYA IN CYA
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-CYA
               IF FIO-STAT-OKS AND
                  CYA-CIC-IOPC IN CYA = OPC-CIC-IOPC IN OPC AND
                  CYA-NUM-ICAN IN CYA = 'AUT'
                   DISPLAY 'CON CARGO AUTOMATICO EN CTA. CTE. : '
                           CYA-CIC-IOPC IN CYA
                   GO TO GET-NXT-OPC.
      *DAD fin  05-APR-1991

      *DAD ini  13-MAY-1991
      * Se Salta Lectura de VEN cuando se procesa Aviso Vencimiento por
           IF WSS-IND-SEL1 IN WSS-VARI = 'F' AND
              WSS-CIC-CTAB IN WSS-VARI = 'A'
               GO TO CON-PRO-OPC.
      *DAD fin  13-MAY-1991

      *DAD ini  09-APR-1994   (Memo.26-01-94 Pto.4)
      * Para Cuponera de OPC especifica se lee archivo RLQ
           IF WSS-CIC-CTAB IN WSS-VARI = 'C' AND
              WSS-IND-SEL1 IN WSS-VARI = 'O' AND
              WSS-IND-SEL2 IN WSS-VARI NOT = 'V'
               MOVE OPC-CIC-IOPC IN OPC TO RLQ-CIC-IOPC IN RLQ
               MOVE  1                  TO RLQ-NUM-IDLC IN RLQ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RLQ
               IF FIO-STAT-OKS
                   MOVE RLQ-NUM-IVEN IN RLQ TO WSS-NUM-IVEN IN WSS-VARI
                   MOVE 'W'                 TO WSS-IND-SEL2 IN WSS-VARI.
      *DAD fin  09-APR-1994

      * Lee VEN desde el Primero o del especificado en el Parametro
      * cuando se procesa Cuponera o Todos los Avisos Vencimientos
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
      *DAD ini  07-SEP-1993
           IF WSS-IND-SEL2 IN WSS-VARI = 'V' OR
              WSS-IND-SEL2 IN WSS-VARI = 'W'
      *DAD fin  07-SEP-1993
               MOVE WSS-NUM-IVEN IN WSS-VARI TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE ZEROES TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       GET-NXT-VEN.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM COL-FIO-VEN
               IF NOT ( FIO-STAT-OKS AND
                        OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
                   GO TO GET-NXT-OPC
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-OBT-VEN
               IF NOT VEN-STAT-OKS
                   GO TO GET-NXT-OPC.
       CON-PRO-OPC.
      *DAD ini  06-AGO-1991
      * Obtiene 'Opera Como'
      *    Se elimino la lectura de la tabla TOC por cada operacion
      *    pues ahora se obtiene de tabla en memoria
           IF CTO-OPEC IN CTO-VARI = 'D'
      *DAD fin  06-AGO-1991
               MOVE '/'            TO SRT-GLS-SLAS
               MOVE 'DE'           TO SRT-GLS-IVCT
               MOVE  'DESCONTANTE' TO SRT-GLS-DCTT
               PERFORM BUS-DEU-IND
               MOVE DBC-CAI-ICLI IN DBC TO SRT-CAI-ICLI
               MOVE DBC-IIC-ICLI IN DBC TO SRT-IIC-ICLI
               MOVE DBC-GLS-NOMC IN DBC TO SRT-GLS-DEUD
               MOVE DBC-GLS-NOMC IN DBC TO SRT-GLS-PGD2
               PERFORM BUS-DEU-DIR
               MOVE DBC-GLS-NOMC IN DBC TO SRT-GLS-PGD1
           ELSE
               MOVE '/'  TO SRT-GLS-SLAS
               MOVE 'DE' TO SRT-GLS-IVCT
      *ALD
      *         MOVE SPACES TO SRT-GLS-SLAS
      *         MOVE SPACES TO SRT-GLS-IVCT
               MOVE SPACES TO SRT-GLS-DCTT
               PERFORM BUS-RCE-SAF
               PERFORM BUS-DEU-DIR
               MOVE DBC-CAI-ICLI IN DBC TO SRT-CAI-ICLI
               MOVE DBC-IIC-ICLI IN DBC TO SRT-IIC-ICLI
               MOVE DBC-GLS-NOMC IN DBC TO SRT-GLS-DEUD
               MOVE DBC-GLS-NOMC IN DBC TO SRT-GLS-PGD2
               MOVE SPACES              TO SRT-GLS-PGD1.

      *ALD-BCI-INI/01.10.1996
           IF WSS-CIC-CTAB IN WSS-VARI = 'A' AND
              VEN-VAL-FINA IN VEN = ZEROES
               GO TO GET-NXT-OPC.
      *ALD-BCI-FIN/01.10.1996
      * Obtiene antecedentes de la Tasa de Interes
           MOVE SPACES TO ICG-COD-CVTI IN ICG.
           MOVE VEN-CIC-IOPC IN VEN TO VIN-CIC-IOPC IN VIN-VARI.
           MOVE VEN-NUM-IDLC IN VEN TO VIN-NUM-IDLC IN VIN-VARI.
           PERFORM BUS-VIN.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               MOVE SPACES TO ICG-COD-TIPT IN ICG
               MOVE SPACES TO ICG-COD-TINT IN ICG
               GO TO MOV-INP-SRT.

      * Proceso para Credito con Tasa Variable
           IF ICG-COD-CVTI IN ICG > SPACES
               PERFORM PRO-MSJE
               IF WSS-CIC-CTAB IN WSS-VARI = 'A'
      *DAD ini  11-ABR-1991
                   MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG
      *DAD fin  11-ABR-1991
                   GO TO MOV-INP-SRT.

      *ALD-BCI-INI/07.04.1999
           IF POC-IND-ECDC IN POC = 'C'
               PERFORM PRO-MSJE-CUPON.
      *ALD-BCI-FIN/07.04.1999
           MOVE ZEROES TO ICG-SGV-TINT IN ICG.
           MOVE SPACES TO ICG-COD-TIPT IN ICG.
           MOVE SPACES TO ICG-COD-TINT IN ICG.
      *DAD ini  09-APR-1994   (Memo.30-03-94) / 07-SEP-1993
           IF WSS-CIC-CTAB IN WSS-VARI = 'C' AND
              POC-MSC-TCVE IN POC = 'FP' AND
              VEN-IND-CALC IN VEN = 'N'
               GO TO GET-NXT-OPC.
      *DAD fin  09-APR-1994 / 07-SEP-1993
      *>>>>
       MOV-INP-SRT.
       COPY COLRMCDC.
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
      *DAD ini  13-MAY-1991
      * Se Salta Lectura de VEN cuando se procesa Aviso Vencimiento por
           IF WSS-IND-SEL1 IN WSS-VARI = 'F' AND
              WSS-CIC-CTAB IN WSS-VARI = 'A'
               GO TO SEL-NXT-VEN.
      *DAD fin  13-MAY-1991

           IF WSS-IND-SEL2 IN WSS-VARI = 'V'
               GO TO GET-NXT-OPC.
       LUP-NXT-VEN.
      * Lee siguiente VEN cuando se procesa Cuponera o Todos los Avisos
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM COL-FIO-VEN
               IF NOT ( FIO-STAT-OKS AND
                        OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
                   GO TO GET-NXT-OPC
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   NEXT SENTENCE
               ELSE
                   IF NOT ( VEN-STAT = VEN-SEOF )
                       MOVE 'COL'    TO MSG-COD-SIST
                       MOVE VEN-STAT TO MSG-COD-MENS IN MSG
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC IN MSG '/'
                               VEN-CIC-IOPC IN VEN
                       GO TO GET-NXT-OPC
                   ELSE
                       GO TO GET-NXT-OPC.
       CON-PRO-VEN.
      *DAD ini  06-AGO-1991
           IF CTO-OPEC IN CTO-VARI = 'D'
      *DAD fin  06-AGO-1991
               PERFORM BUS-DEU-IND
               MOVE DBC-CAI-ICLI IN DBC TO SRT-CAI-ICLI
               MOVE DBC-IIC-ICLI IN DBC TO SRT-IIC-ICLI
               MOVE DBC-GLS-NOMC IN DBC TO SRT-GLS-DEUD
               MOVE DBC-GLS-NOMC IN DBC TO SRT-GLS-PGD2.
      *ALD-BCI-INI/01.10.1996
           IF WSS-CIC-CTAB IN WSS-VARI = 'A' AND
              VEN-VAL-FINA IN VEN = ZEROES
               GO TO GET-NXT-OPC.
      *ALD-BCI-FIN/01.10.1996

      * Obtiene antecedentes de la Tasa de Interes
           MOVE SPACES TO ICG-COD-CVTI IN ICG.
           MOVE VEN-CIC-IOPC IN VEN TO VIN-CIC-IOPC IN VIN-VARI.
           MOVE VEN-NUM-IDLC IN VEN TO VIN-NUM-IDLC IN VIN-VARI.
           PERFORM BUS-VIN.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               MOVE SPACES TO ICG-COD-TIPT IN ICG
               MOVE SPACES TO ICG-COD-TINT IN ICG
               GO TO MOV-INP-SRT.

      * Proceso para Credito con Tasa Variable
           IF ICG-COD-CVTI IN ICG > SPACES
               PERFORM PRO-MSJE
               IF WSS-CIC-CTAB IN WSS-VARI = 'A'
      *DAD ini  11-ABR-1991
                   MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG
      *DAD fin  11-ABR-1991
                   GO TO MOV-INP-SRT.

      *ALD-BCI-INI/07.04.1999
           IF POC-IND-ECDC IN POC = 'C'
               PERFORM PRO-MSJE-CUPON.
      *ALD-BCI-FIN/07.04.1999
           MOVE ZEROES TO ICG-SGV-TINT IN ICG.
           MOVE SPACES TO ICG-COD-TIPT IN ICG.
           MOVE SPACES TO ICG-COD-TINT IN ICG.
      *DAD ini  09-APR-1994   (Memo.30-03-94) / 07-SEP-1993
           IF WSS-CIC-CTAB IN WSS-VARI = 'C' AND
              POC-MSC-TCVE IN POC = 'FP' AND
              VEN-IND-CALC IN VEN = 'N'
               GO TO GET-NXT-OPC.
      *DAD fin  09-APR-1994 / 07-SEP-1993
           GO TO MOV-INP-SRT.
       GET-NXT-OPC.
      *DAD ini  07-SEP-1993
           IF WSS-IND-SEL2 IN WSS-VARI = 'W'
               IF WSS-IND-SEL1 IN WSS-VARI = 'O' OR
                  NOT FIO-STAT-OKS
                   GO TO EXT-INP-SRT
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   PERFORM LEE-RLQ-OPC
                   IF NOT FIO-STAT-OKS AND
                      WSS-IND-SEL2 IN WSS-VARI = 'X'
                       GO TO EXT-INP-SRT
                   ELSE
                       GO TO LUP-INP-SRT.
      *DAD fin  07-SEP-1993

      *DAD ini  09-APR-1994   (Memo.26-01-94 Pto.4)
           IF WSS-IND-SEL1 IN WSS-VARI = 'O'
               GO TO FIN-INP-SRT.
      *DAD fin  09-APR-1994

      *DAD ini  13-MAY-1992 / 13-MAY-1991
           IF WSS-IND-SEL1 IN WSS-VARI = 'F' AND
              WSS-CIC-CTAB IN WSS-VARI = 'C'
               MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
      *DAD fin  13-MAY-1992 / 13-MAY-1991
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
      *<<<< FIN_NXT_INP
      *DAD ini  13-MAY-1991
           IF WSS-IND-SEL1 IN WSS-VARI = '*'
               GO TO LUP-INP-SRT.

      * Selecciona Credito Solo en rango de Fechas del Parametro
           IF WSS-IND-SEL1 IN WSS-VARI = 'F' AND
              WSS-CIC-CTAB IN WSS-VARI = 'C'
      *DAD ini  13-MAY-1992
               IF OPC-FEC-FINP IN OPC > WSS-FEC-FFET IN WSS-VARI
      *DAD fin  13-MAY-1992
                   GO TO FIN-INP-SRT.

      * Selecciona Vencimiento Solo en rango de Fechas del Parametro
       SEL-NXT-VEN.
           IF WSS-IND-SEL1 IN WSS-VARI = 'F' AND
              WSS-CIC-CTAB IN WSS-VARI = 'A'
               MOVE 'VEN-FEC-FVEN' TO FIO-AKEY
               MOVE FIO-GET-NXT    TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS OR
                  VEN-FEC-FVEN IN VEN > WSS-FEC-FFET IN WSS-VARI
                   GO TO FIN-INP-SRT
               ELSE
                   MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   IF NOT FIO-STAT-OKS
                       DISPLAY 'OPERACION INEXISTENTE : '
                                OPC-CIC-IOPC IN OPC
                       GO TO SEL-NXT-VEN.
      *DAD fin  13-MAY-1991
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *<<<< FIN_INP
      *DAD ini  07-SEP-1993
           IF ( WSS-CIC-CTAB IN WSS-VARI NOT = 'C' ) OR
              ( PGM-STAT-SRT-MAL AND
                WSS-IND-SEL1 IN WSS-VARI = 'O' )
               GO TO EXT-INP-SRT.

           IF WSS-IND-SEL1 IN WSS-VARI = 'O'
               MOVE WSS-CIC-IOPC IN WSS-VARI TO RLQ-CIC-IOPC IN RLQ
               MOVE 1                        TO RLQ-NUM-IDLC IN RLQ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM LEE-RLQ-OPC
               IF NOT FIO-STAT-OKS
                   GO TO EXT-INP-SRT
               ELSE
                   NEXT SENTENCE
           ELSE
           IF WSS-IND-SEL2 IN WSS-VARI NOT = 'W'
               MOVE FIO-GET-FST TO FIO-CMND
               PERFORM LEE-RLQ-OPC
               IF NOT FIO-STAT-OKS
                   GO TO EXT-INP-SRT.

           MOVE 'W' TO WSS-IND-SEL2 IN WSS-VARI.
           GO TO LUP-INP-SRT.
       EXT-INP-SRT.
      *    MOVE FIO-CLO TO FIO-CMND.
      *    PERFORM COL-FIO-RLQ.
      *DAD fin  07-SEP-1993
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-OPC.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
           OPEN OUTPUT RPTCDC.
      *     MOVE 'COLPLCDC' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.

      ***** CRW-COMIENZO
      *    INITIATE RPT-CDC.
      ***** CRW-FINAL

           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
       LUP-OUT-SRT.
      *<<<< LUP_OUT
      *BUS-TAB busca codigo en tabla
      *Solo busca cuando cambia el codigo
           IF SRT-COD-TRPT IN SRT > SPACES
               MOVE 'COL'        TO TAB-COD-SIST
               MOVE 'CDC'        TO TAB-COD-TTAB IN TAB
               MOVE SRT-COD-TRPT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DESC
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA
           ELSE
               MOVE SPACES TO WSS-GLS-DESC
               MOVE SPACES TO WSS-GLS-DATA.

      *DAD ini  11-APR-1991 / 5-APR-1991
           MOVE ICG-COD-TINT IN SRT TO ICG-COD-TINT IN ICG.
           IF ICG-COD-TINT IN ICG > SPACES
               IF ICG-MSC-PBTI IN ICG > SPACES
                   MOVE 'COL'               TO MSC-COD-SIST
                   MOVE 'PBTI'              TO MSC-COD-TMSC IN MSC
                   MOVE ICG-MSC-PBTI IN ICG TO MSC-COD-CMSC IN MSC
                   PERFORM BUS-MSC
                   MOVE MSC-GLS-ABRV IN MSC TO WSS-GLS-TIPT IN WSS-CDC
                   MOVE 'TASA INT.'         TO WSS-GLS-TINT IN WSS-CDC
               ELSE
                   MOVE SPACES TO WSS-GLS-TIPT IN WSS-CDC
                   MOVE SPACES TO WSS-GLS-TINT IN WSS-CDC.
      *DAD fin  05-APR-1991

      * Obtiene la Tasa Base para Credito con Tasa Variable respecto al
      * y completa la Tasa de Interes
           IF ICG-MSC-TFPR IN ICG = 'F'
               PERFORM PRO-TAS-VAR-FLU
               IF FIO-STAT-OKS
                   ADD CAM-SGV-VCAM IN CAM TO ICG-SGV-TINT IN SRT
               ELSE
                   MOVE 'SPREAD' TO WSS-GLS-TINT IN WSS-CDC
           ELSE
           IF ICG-MSC-TFPR IN ICG = 'C'
               MOVE 'SPREAD' TO WSS-GLS-TINT IN WSS-CDC.
      *DAD fin  11-ABR-1991

           IF OPC-COD-VCOC IN SRT > SPACES
               IF OPC-COD-VCOC IN SRT NOT = WSS-COD-VCOC
                   MOVE OPC-COD-VCOC IN SRT TO WSS-COD-VCOC
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
                   MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MONE IN WSS-CDC
                   MOVE TAB-COD-DAT1(7)     TO WSS-IND-TCAM IN WSS-CDC
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE SPACES TO WSS-GLS-MONE IN WSS-CDC
               MOVE SPACES TO WSS-IND-TCAM IN WSS-CDC.

      *BUS-OFI busca oficina en tablas
      *Solo busca cuando cambia la oficina
           IF OPC-COD-OFOC IN SRT > SPACES
               IF OPC-COD-OFOC IN SRT NOT = WSS-COD-OFOC
                   MOVE OPC-COD-OFOC IN SRT TO WSS-COD-OFOC
                   MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE SPACES TO OFI-GLS-DESC IN OFI.

           IF NOT ( SRT-CAI-ICLI = WSS-CAI-ICLI AND
                    SRT-IIC-ICLI = WSS-IIC-ICLI )
               MOVE SRT-CAI-ICLI TO WSS-CAI-ICLI
               MOVE SRT-IIC-ICLI TO WSS-IIC-ICLI
               MOVE SRT-CAI-ICLI TO DBC-CAI-ICLI
               MOVE SRT-IIC-ICLI TO DBC-IIC-ICLI

               MOVE SRT-CAI-ICLI IN SRT TO RDC-CAI-ICLI IN RDC
               MOVE SRT-IIC-ICLI IN SRT TO RDC-IIC-ICLI IN RDC
               MOVE VEN-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC
               MOVE VEN-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC
               MOVE 999                 TO RDC-NUM-IDLC IN RDC
               MOVE FIO-GET-LEQ TO FIO-CMND
               PERFORM COL-FIO-RDC
               IF FIO-STAT-OKS AND
                  SRT-CAI-ICLI = RDC-CAI-ICLI IN RDC AND
                  SRT-IIC-ICLI = RDC-IIC-ICLI IN RDC AND
                  VEN-CAI-IOPC IN SRT = RDC-CAI-IOPC IN RDC AND
                  VEN-IIC-IOPC IN SRT = RDC-IIC-IOPC IN RDC
                   PERFORM BUS-DIRE
                   PERFORM BUS-LUGA
               ELSE
                   MOVE SPACES TO WSS-GLS-LUGA IN WSS-CDC
                   MOVE SPACES TO RCD-GLS-DIRE IN RCD.
      *>>>>
       GEN-OUT-SRT.

      ***** CRW-COMIENZO
      *    GENERATE DL-CDC.
           PERFORM GENERATE-DL-CDC.
      ***** CRW-FINAL

       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.

      ***** CRW-COMIENZO
      *    TERMINATE RPT-CDC.
      ***** CRW-FINAL

           CLOSE RPTCDC.
           GO TO EXT-OUT-SRT.

      ***** CRW-COMIENZO

       GENERATE-DL-CDC.
      *****************
           MOVE WSS-GLS-DESC IN WSS-CDC        TO RPT-DETA-GLS-DESC-1
           MOVE WSS-GLS-DATA IN WSS-CDC        TO RPT-DETA-GLS-DATA
           MOVE SRT-GLS-DEUD IN SRT            TO RPT-DETA-GLS-DEUD
           MOVE SRT-GLS-PGD2 IN SRT            TO RPT-DETA-GLS-PGD2
           MOVE RCD-GLS-DIRE IN RCD            TO RPT-DETA-GLS-DIRE
           MOVE WSS-GLS-LUGA IN WSS-CDC        TO RPT-DETA-GLS-LUGA
           MOVE OPC-COD-OFOC IN SRT            TO RPT-DETA-COD-OFOC
           MOVE OFI-GLS-DESC IN OFI            TO RPT-DETA-GLS-DESC
           MOVE VEN-CAI-IOPC IN SRT            TO RPT-DETA-CAI-IOPC-1
           MOVE VEN-IIC-IOPC IN SRT            TO RPT-DETA-IIC-IOPC-1
           MOVE WSS-GLS-MSJE IN SRT            TO RPT-DETA-GLS-MSJE
           MOVE VEN-NUM-IVCT IN SRT            TO RPT-DETA-NUM-IVCT-1
           MOVE SRT-GLS-IVCT IN SRT            TO RPT-DETA-GLS-IVCT
           MOVE OPC-NUM-VCOR IN SRT            TO RPT-DETA-NUM-VCOR-1
           MOVE SRT-GLS-DCTT IN SRT            TO RPT-DETA-GLS-DCTT
           MOVE WSS-COD-CSAF IN SRT            TO RPT-DETA-COD-CSAF
           MOVE SRT-GLS-PGD1 IN SRT            TO RPT-DETA-GLS-PGD1
           MOVE WSS-IND-TCAM IN WSS-CDC        TO RPT-DETA-IND-TCAM
           MOVE VEN-NUM-DVEN IN SRT            TO RPT-DETA-NUM-DVEN-1
           MOVE VEN-NUM-MVEN IN SRT            TO RPT-DETA-NUM-MVEN-1
           MOVE VEN-NUM-SVEN IN SRT            TO RPT-DETA-NUM-SVEN-1
           MOVE VEN-NUM-AVEN IN SRT            TO RPT-DETA-NUM-AVEN-1
           MOVE VEN-CAI-IOPC IN SRT            TO RPT-DETA-CAI-IOPC-2
           MOVE VEN-IIC-IOPC IN SRT            TO RPT-DETA-IIC-IOPC-2
           MOVE VEN-NUM-IVCT IN SRT            TO RPT-DETA-NUM-IVCT-2
           MOVE SRT-GLS-SLAS IN SRT            TO RPT-DETA-GLS-SLAS
           MOVE OPC-NUM-VCOR IN SRT            TO RPT-DETA-NUM-VCOR-2
           MOVE WSS-GLS-TINT IN WSS-CDC        TO RPT-DETA-GLS-TINT
           MOVE ICG-SGV-TINT IN SRT            TO RPT-DETA-SGV-TINT
           MOVE WSS-GLS-TIPT IN WSS-CDC        TO RPT-DETA-GLS-TIPT
           MOVE WSS-GLS-MONE IN WSS-CDC        TO RPT-DETA-GLS-MONE-1
           MOVE WSS-GLS-MONE IN WSS-CDC        TO RPT-DETA-GLS-MONE-2
           MOVE VEN-NUM-DVEN IN SRT            TO RPT-DETA-NUM-DVEN-2
           MOVE VEN-NUM-MVEN IN SRT            TO RPT-DETA-NUM-MVEN-2
           MOVE VEN-NUM-SVEN IN SRT            TO RPT-DETA-NUM-SVEN-2
           MOVE VEN-NUM-AVEN IN SRT            TO RPT-DETA-NUM-AVEN-2
           MOVE VEN-VAL-FINA IN SRT            TO RPT-DETA-VAL-FINA-1
           MOVE VEN-VAL-FINA IN SRT            TO RPT-DETA-VAL-FINA-2
           MOVE SPACES                         TO RPT-DETA-COD-TINT
                                                  RPT-DETA-COD-TRPT

           MOVE SPACES TO RPTCDC-REG.
           WRITE RPTCDC-REG AFTER PAGE
           WRITE RPTCDC-REG FROM  DL-CDC-01
           WRITE RPTCDC-REG FROM  DL-CDC-02 AFTER 2
           WRITE RPTCDC-REG FROM  DL-CDC-03
           WRITE RPTCDC-REG FROM  DL-CDC-04
           WRITE RPTCDC-REG FROM  DL-CDC-05
           WRITE RPTCDC-REG FROM  DL-CDC-06
           WRITE RPTCDC-REG FROM  DL-CDC-07
           WRITE RPTCDC-REG FROM  DL-CDC-08
           WRITE RPTCDC-REG FROM  DL-CDC-09
           WRITE RPTCDC-REG FROM  DL-CDC-10 AFTER 2
           WRITE RPTCDC-REG FROM  DL-CDC-11
           WRITE RPTCDC-REG FROM  DL-CDC-12.
      ***** CRW-FINAL

       EXT-OUT-SRT.
      *<<<< EXT_OUT
      *DAD ini  11-AGO-1994   (Memo.08-08-94 Pto.2)
           IF PGM-STAT-SRT-MAL AND
              WSS-IND-SEL1 IN WSS-VARI = 'O'
               MOVE PGM-SOKS TO PGM-STAT-SRT.
       EXT-OUT.
      *DAD fin  11-AGO-1994
      *>>>>
           EXIT.
       COPY COLBFOPC.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF
      ******************************************************************
      * Proceso para obtener Deudor Directo
       BUS-DEU-DIR SECTION.
       INI-BUS-DEU-DIR.
           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               PERFORM GET-RDC-DBC
           ELSE
               PERFORM RST-DBC.
       FIN-BUS-DEU-DIR.
           EXIT.
      *-----------------------------------------------------------------
      * Proceso para obtener Deudor Indirecto
       BUS-DEU-IND SECTION.
       INI-BUS-DEU-IND.
           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE VEN-NUM-IDLC IN VEN TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               PERFORM GET-RDC-DBC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO DBC-GLS-NOMC IN DBC
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM RST-DBC
               MOVE SPACES TO DBC-GLS-NOMC IN DBC.
           PERFORM BUS-RCE-SAF.
       FIN-BUS-DEU-IND.
           EXIT.
      *-----------------------------------------------------------------
       GET-RDC-DBC SECTION.
       INI-GET-RDC-DBC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
           ELSE
               PERFORM RST-DBC.
       FIN-GET-RDC-DBC.
           EXIT.
      *-----------------------------------------------------------------
       RST-DBC SECTION.
       INI-RST-DBC.
           MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.
      ******************************************************************
      * Proceso para generar Codigo Clave SAFE
       BUS-RCE-SAF SECTION.
       INI-BUS-RCE-SAF.
           MOVE OPC-CAI-IOPC IN OPC TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN OPC TO DLC-IIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO WSS-COD-CSAF IN WSS-CDC
               GO TO FIN-BUS-RCE-SAF.

      *DAD ini  14-AGO-1991
      * Para creditos nuevos
      *     IF OPC-MSC-TTRN IN OPC NOT = 'C'
      *         MOVE DLC-KEY-IDLC IN DLC TO WSS-KEY-IDLC IN WSS-VARI
      *     ELSE
      *         MOVE DLC-CIC-IOPC IN DLC TO RCE-CIC-IOPC IN RCE
      *         MOVE DLC-NUM-IDLC IN DLC TO RCE-NUM-IDLC IN RCE
      *         MOVE FIO-GET-KEY TO FIO-CMND
      *         PERFORM COL-FIO-RCE
      *         IF NOT FIO-STAT-OKS
      *             MOVE SPACES TO WSS-COD-CSAF IN WSS-CDC
      *             GO TO FIN-BUS-RCE-SAF
      *         ELSE
      *             MOVE RCE-KEY-SAFE IN RCE TO WSS-KEY-IDLC IN WSS-VARI
      * Para creditos antiguos
      *             MOVE RCE-KEY-SAFE IN RCE      TO WSS-KEY-SAFE
      *             MOVE ZEROS                    TO WSS-CAM-FINA
      *             MOVE WSS-KEY-SAFE IN WSS-VARI TO WSS-COD-CSAF
      *                                                      IN WSS-CDC.
      * Para TODOS los creditos
           MOVE DLC-KEY-IDLC IN DLC      TO WSS-KEY-IDLC IN WSS-VARI.
           IF OPC-COD-TOPC IN OPC = 'D'
               MOVE '4' TO WSS-COD-TOPC IN WSS-VARI.
           MOVE WSS-KEY-IDLC IN WSS-VARI TO WSS-COD-CSAF IN WSS-CDC.
      *DAD fin  14-AGO-1991
       FIN-BUS-RCE-SAF.
           EXIT.
      ******************************************************************
      * Proceso para obtener Direccion del Deudor
       BUS-DIRE SECTION.
       INI-BUS-DIRE.
           MOVE DBC-CAI-ICLI IN DBC TO RCD-CAI-ICLI IN RCD.
           MOVE DBC-IIC-ICLI IN DBC TO RCD-IIC-ICLI IN RCD.
           MOVE RDC-NUM-DIRE IN RDC TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO RCD-GLS-DIRE IN RCD.
       FIN-BUS-DIRE.
           EXIT.
      *-----------------------------------------------------------------
      * Proceso para obtener Comuna o Pais
       BUS-LUGA SECTION.
       INI-BUS-LUGA.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE SPACES TO WSS-GLS-LUGA IN WSS-CDC
               GO TO FIN-BUS-LUGA.
           MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA IN WSS-VARI.
           MOVE 'TAB'               TO TAB-COD-SIST.
           IF WSS-IND-LUGA IN WSS-VARI = 'P'
               MOVE 'PAI'                    TO TAB-COD-TTAB
               MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
           ELSE
               MOVE 'COM'                    TO TAB-COD-TTAB
               MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-LUGA IN WSS-CDC.
       FIN-BUS-LUGA.
           EXIT.
      ******************************************************************
      * Proceso para generar mensaje 'Consulta Saldo'
       PRO-MSJE SECTION.
       INI-PRO-MSJE.
      *DAD ini  24-ABR-1991 / 05-APR-1991
           SUBTRACT VEN-NUM-IVCT IN VEN FROM OPC-NUM-VCOR IN OPC
                                      GIVING WSS-NUM-NVTV IN WSS-VARI.
           IF WSS-NUM-NVTV IN WSS-VARI < 3 AND
              POC-IND-ECDC IN POC = 'A'
      *     IF VEN-VAL-SCAP IN VEN > ZEROES AND
      *DAD fin  24-ABR-1991 / 05-APR-1991
               MOVE 'COL'       TO MSG-COD-SIST
               MOVE 'CDCMAVSTV' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO WSS-GLS-MSJE IN WSS-CDC
           ELSE
               MOVE SPACES TO WSS-GLS-MSJE IN WSS-CDC.
       FIN-PRO-MSJE.
           EXIT.
      *ALD-BCI-INI/07.04.1999
       PRO-MSJE-CUPON SECTION.
       INI-PRO-MSJE-CUPON.
           SUBTRACT VEN-NUM-IVCT IN VEN FROM OPC-NUM-VCOR IN OPC
                                      GIVING WSS-NUM-NVTV IN WSS-VARI.
           IF  WSS-NUM-NVTV IN WSS-VARI NOT < 3
               MOVE SPACES TO WSS-GLS-MSJE IN WSS-CDC
               GO TO FIN-PRO-MSJE-CUPON.
           MOVE 'COL'               TO MSG-COD-SIST.
           MOVE OPC-COD-COOC IN OPC TO WSS-MSG-COOC.
           MOVE 'CUPON'             TO WSS-MSG-CUPO.
           MOVE WSS-MSG-MENS        TO MSG-COD-MENS IN MSG.
           MOVE MSG-COD-SIST        TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSG.
           IF FIO-STAT-OKS AND
              MSG-IND-VIGE  = 'S'
               MOVE MSG-GLS-DESC IN MSG TO WSS-GLS-MSJE IN WSS-CDC
               GO TO FIN-PRO-MSJE-CUPON.
           MOVE 'COL'               TO MSG-COD-SIST.
           MOVE OPC-COD-TOOC IN OPC TO WSS-MSG-TOOC.
           MOVE '*  '               TO WSS-MSG-AOOC.
           MOVE 'CUPON'             TO WSS-MSG-CUPO.
           MOVE WSS-MSG-MENS        TO MSG-COD-MENS IN MSG.
           MOVE MSG-COD-SIST TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSG.
           IF FIO-STAT-OKS AND
              MSG-IND-VIGE  = 'S'
               MOVE MSG-GLS-DESC IN MSG TO WSS-GLS-MSJE IN WSS-CDC
               GO TO FIN-PRO-MSJE-CUPON.
           MOVE SPACES TO WSS-GLS-MSJE IN WSS-CDC.
       FIN-PRO-MSJE-CUPON.
           EXIT.
      *ALD-BCI-FIN/07.04.1999
      ******************************************************************
      *DAD ini  11-ABR-1991
      * Obtiene la Tasa Base para Credito con Tasa Variable respecto al
      * y completa la Tasa de Interes
       PRO-TAS-VAR-FLU SECTION.
       INI-PRO-TAS-VAR-FLU.
      * Determina NUM-IVEN del VEN anterior para obtener FVEN, si NUM-IV
      * resulta ser cero se usara FCOL y no se efectuara lectura de VEN
           MOVE VEN-CAI-IOPC IN SRT TO OPC-CAI-IOPC IN OPC.
           MOVE VEN-IIC-IOPC IN SRT TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE OPC-FEC-FCOL IN OPC TO CAM-FEC-FCAM IN CAM(1)
                                       CAM-FEC-FCAM IN CAM(2).
           SUBTRACT 1 FROM VEN-NUM-IVCT IN SRT GIVING
                                               VEN-NUM-IVEN IN VEN.
           IF VEN-NUM-IVEN IN VEN NOT > ZEROES
               GO TO PAS-PRO-TAS-VAR-FLU.

      * Lee el VEN anterior para obtener FVEN con NUM-IVEN determinado
           MOVE VEN-CAI-IOPC IN SRT TO VEN-CAI-IOPC IN VEN.
           MOVE VEN-IIC-IOPC IN SRT TO VEN-IIC-IOPC IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF NOT VEN-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'VEN    NXT' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ':' VEN-KEY-IVEN IN VEN
                   MOVE '23' TO FIO-STAT
                   GO TO FIN-PRO-TAS-VAR-FLU
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'VEN    NXT' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ':' VEN-KEY-IVEN IN VEN
                   GO TO FIN-PRO-TAS-VAR-FLU.

      * Lee tabla CAM para obtener el TIM base con fecha FVEN
           MOVE VEN-FEC-FVEN IN VEN TO CAM-FEC-FCAM IN CAM(1)
                                       CAM-FEC-FCAM IN CAM(2).
           MOVE ICG-COD-TINT IN SRT TO ICG-COD-TINT IN ICG.
       PAS-PRO-TAS-VAR-FLU.
      * Si NUM-IVEN resulto ser cero se usara FCOL para obtener TIM base
           MOVE 'I'                 TO CAM-MSC-TVAL IN CAM(1).
           MOVE ICG-COD-CVTI IN ICG TO CAM-COD-CVAL IN CAM(1).
           MOVE ICG-MSC-PBTI IN ICG TO CAM-COD-TCAM IN CAM(1).
           MOVE OPC-COD-VCOC IN SRT TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS OR
              CAM-IND-VIGE NOT = 'S'
               DISPLAY 'NO EXISTE VALOR DE TIM PARA OPERACION : '
                        VEN-CAI-IOPC IN SRT '/'
                        VEN-IIC-IOPC IN SRT ' AL '
                        CAM-FEC-FCAM IN CAM(1) ' PARA '
                        CAM-COD-VCAM IN CAM(1) '/'
                        CAM-COD-VCAM IN CAM(2)
               MOVE '23' TO FIO-STAT.
       FIN-PRO-TAS-VAR-FLU.
           EXIT.
      *DAD fin  11-ABR-1991
      ******************************************************************
      *DAD ini  07-SEP-1993
      * Lee archivo RLQ y la OPC asociada al registro leido
       LEE-RLQ-OPC SECTION.
       INI-LEE-RLQ-OPC.
      * Procesa por Operacion Especifica y el registro RLQ ya fue leido
           IF WSS-IND-SEL1 IN WSS-VARI = 'O' AND
              WSS-IND-SEL2 IN WSS-VARI = 'W'
               GO TO FIN-LEE-RLQ-OPC.

      * Lee los registros RLQ
           PERFORM COL-FIO-RLQ.
           IF NOT FIO-STAT-OKS
               IF WSS-IND-SEL1 IN WSS-VARI = 'O'
                   DISPLAY 'NO HAY OPERACION RELIQUIDADA ESPECIFICA : '
                            OPC-CIC-IOPC IN OPC
                   GO TO FIN-LEE-RLQ-OPC
               ELSE
               IF WSS-IND-SEL2 IN WSS-VARI NOT = 'W'
                   DISPLAY 'NO HAY OPERACIONES RELIQUIDADAS : '
                   GO TO FIN-LEE-RLQ-OPC
               ELSE
               IF WSS-IND-SEL2 IN WSS-VARI = 'W'
                   MOVE 'X' TO WSS-IND-SEL2 IN WSS-VARI
                   GO TO FIN-LEE-RLQ-OPC.

      * Setea VENcimiento desde el cual Listar Cuponera
           MOVE RLQ-NUM-IVEN IN RLQ TO WSS-NUM-IVEN IN WSS-VARI.

      * Lee los registros OPC
           MOVE RLQ-CIC-IOPC IN RLQ TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'OPERACION RELIQUIDADA INEXISTENTE : '
                        OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO INI-LEE-RLQ-OPC.
       FIN-LEE-RLQ-OPC.
           EXIT.
      *DAD fin  07-SEP-1993
      ******************************************************************

       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY SGCBFDBC.
      *DAD ini  07-SEP-1993
       COPY COLBFRLQ.
      *DAD fin  07-SEP-1993
      *DAD ini  05-APR-1991
       COPY COLBFCYA.
       COPY GNSBBMSC.
      *DAD fin  05-APR-1991
       COPY COLBFRCV.
       COPY SGCBFRCD.
       COPY COLBFTOC.
       COPY COLBFRDC.
       COPY COLBFDLC.
       COPY COLBFVEN.
       COPY COLBFEVC.
       COPY COLBFICG.
       COPY COLBFPOC.
      *DAD ini  14-AGO-1991
      * COPY COLBFRCE.
      *DAD fin  14-AGO-1991
       COPY COLBGVEN.
       COPY COLBGVIN.
      *DAD ini  06-AGO-1991
       COPY COLBGCTO.
      *DAD fin  06-AGO-1991
       COPY TABBFOFI.
       COPY TABBFVLR.
       COPY TABBFCAM.
       COPY SGCBGCLI.
       COPY SGCBGDOM.
       COPY GNSBGCPT.
       COPY GNSBBTAB.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY GNSBVTAB.
       COPY GNSBGPES.
      *SMC-INI 13.09.1993
       COPY COLBGINT.
      *SMC-FIN 13.09.1993
       COPY GNSBGCVI.
       COPY GNSBBMSG.
       COPY GNSBFMSC.
      *>>>>

