       PUT-ALL-CAN SECTION.
       INI-PUT-ALL-CAN.
           PERFORM PUT-OPC-CAN.
           PERFORM PUT-CAN-CAN.
           PERFORM PUT-DBC-CAN.
           PERFORM PUT-VEN-CAN.
           PERFORM PUT-RCV-CAN.
           PERFORM PUT-ROV-CAN.
           PERFORM PUT-ICG-CAN.
           PERFORM PUT-CYA-CAN.
      *<<<< FIN_PUT_ALL_CAN
      *BUS-TAB busca glosa de codigo en tabla
           IF ITR-COD-TINT IN ITR > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'INT'               TO TAB-COD-TTAB IN TAB
               MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-IITR IN CAN-FLD.
      *>>>>
       FIN-PUT-ALL-CAN.
           EXIT.

       PUT-OPC-CAN SECTION.
       INI-PUT-OPC-CAN.
           IF PGM-STAT-OPC-NUL
               GO TO FIN-PUT-OPC-CAN.
           IF NOT PGM-STAT-OPC-OKS
               PERFORM CLR-OPC-CAN
               GO TO FIN-PUT-OPC-CAN.
           MOVE OPC-MSC-TVOC IN OPC TO OPC-MSC-TVOC IN CAN-FLD.
           MOVE OPC-COD-TOOC IN OPC TO OPC-COD-TOOC IN CAN-FLD.
           MOVE OPC-COD-OFOC IN OPC TO OPC-COD-OFOC IN CAN-FLD.
           MOVE OPC-COD-AOOC IN OPC TO OPC-COD-AOOC IN CAN-FLD.
           MOVE OPC-NUM-VCVG IN OPC TO OPC-NUM-VCVG IN CAN-FLD.
           MOVE OPC-COD-VCOC IN OPC TO OPC-COD-VCOC IN CAN-FLD.
           MOVE OPC-VAL-SCRE IN OPC TO OPC-VAL-SCRE IN CAN-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF OPC-MSC-TVOC IN CAN-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-TVOC IN CAN-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TVOC IN CAN-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-TVOC IN CAN-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-TOOC IN CAN-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOOC IN CAN-FLD.
      *BUS-OFI busca oficina en tablas
           IF OPC-COD-OFOC IN CAN-FLD > SPACES
               MOVE OPC-COD-OFOC IN CAN-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFOC IN CAN-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-VCOC IN CAN-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOC IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOC IN CAN-FLD.
      *<<<< FIN_PUT_OPC_CAN
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-AOOC IN CAN-FLD > SPACES
               MOVE 'COL'                    TO TAB-COD-SIST
               MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN CAN-FLD  TO WSS-COD-TOOC IN WSS-VARI
               MOVE OPC-COD-AOOC IN CAN-FLD  TO WSS-COD-AOOC IN WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN CAN-FLD.
           MOVE OPC-COD-VCOC IN OPC TO SCR-COD-VCOC.
      *>>>>
       FIN-PUT-OPC-CAN.
           EXIT.

       PUT-CAN-CAN SECTION.
       INI-PUT-CAN-CAN.
           IF PGM-STAT-CAN-NUL
               GO TO FIN-PUT-CAN-CAN.
           IF NOT PGM-STAT-CAN-OKS
               PERFORM CLR-CAN-CAN
               GO TO FIN-PUT-CAN-CAN.
           MOVE CAN-CAI-IOPC IN CAN TO CAN-CAI-IOPC IN CAN-FLD.
           MOVE CAN-IIC-IOPC IN CAN TO CAN-IIC-IOPC IN CAN-FLD.
           MOVE CAN-NUM-ICAN IN CAN TO CAN-NUM-ICAN IN CAN-FLD.
           MOVE CAN-COD-RCAN IN CAN TO CAN-COD-RCAN IN CAN-FLD.
           MOVE CAN-MSC-STAT IN CAN TO CAN-MSC-STAT IN CAN-FLD.
           MOVE CAN-MSC-CANC IN CAN TO CAN-MSC-CANC IN CAN-FLD.
           MOVE CAN-NUM-DOUT IN CAN TO CAN-NUM-DOUT IN CAN-FLD.
           MOVE CAN-NUM-MOUT IN CAN TO CAN-NUM-MOUT IN CAN-FLD.
           MOVE CAN-NUM-SOUT IN CAN TO CAN-NUM-SOUT IN CAN-FLD.
           MOVE CAN-NUM-AOUT IN CAN TO CAN-NUM-AOUT IN CAN-FLD.
           MOVE CAN-NUM-DCAN IN CAN TO CAN-NUM-DCAN IN CAN-FLD.
           MOVE CAN-NUM-MCAN IN CAN TO CAN-NUM-MCAN IN CAN-FLD.
           MOVE CAN-NUM-SCAN IN CAN TO CAN-NUM-SCAN IN CAN-FLD.
           MOVE CAN-NUM-ACAN IN CAN TO CAN-NUM-ACAN IN CAN-FLD.
           MOVE CAN-NUM-DEGR IN CAN TO CAN-NUM-DEGR IN CAN-FLD.
           MOVE CAN-NUM-MEGR IN CAN TO CAN-NUM-MEGR IN CAN-FLD.
           MOVE CAN-NUM-SEGR IN CAN TO CAN-NUM-SEGR IN CAN-FLD.
           MOVE CAN-NUM-AEGR IN CAN TO CAN-NUM-AEGR IN CAN-FLD.
           MOVE CAN-COD-OFCA IN CAN TO CAN-COD-OFCA IN CAN-FLD.
           MOVE CAN-SGV-GAST IN CAN TO CAN-SGV-GAST IN CAN-FLD.
           MOVE CAN-SGV-TREN IN CAN TO CAN-SGV-TREN IN CAN-FLD.
           MOVE CAN-SGV-TPAG IN CAN TO CAN-SGV-TPAG IN CAN-FLD.
           MOVE CAN-SGV-DIFE IN CAN TO CAN-SGV-DIFE IN CAN-FLD.
      *BUS-USR busca usuario en tablas
           IF CAN-COD-RCAN IN CAN-FLD > SPACES
               MOVE CAN-COD-RCAN IN CAN-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RCAN IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-RCAN IN CAN-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CAN-MSC-CANC IN CAN-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CNC ' TO TAB-COD-TTAB IN TAB
               MOVE CAN-MSC-CANC IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CANC IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CANC IN CAN-FLD.
      *BUS-OFI busca oficina en tablas
           IF CAN-COD-OFCA IN CAN-FLD > SPACES
               MOVE CAN-COD-OFCA IN CAN-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFCA IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFCA IN CAN-FLD.
      *<<<< FIN_PUT_CAN_CAN
      *BUS-TAB busca glosa de codigo en tabla
           IF CAN-MSC-STAT IN CAN-FLD > SPACES
               MOVE 'GNS'                   TO TAB-COD-SIST
               MOVE 'STT'                   TO TAB-COD-TTAB IN TAB
               MOVE CAN-MSC-STAT IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO FRM-GLS-STAT IN CAN-FLD.
      *>>>>
       FIN-PUT-CAN-CAN.
           EXIT.

       PUT-DBC-CAN SECTION.
       INI-PUT-DBC-CAN.
       FIN-PUT-DBC-CAN.
           EXIT.

       PUT-VEN-CAN SECTION.
       INI-PUT-VEN-CAN.
           IF PGM-STAT-VEN-NUL
               GO TO FIN-PUT-VEN-CAN.
           IF NOT PGM-STAT-VEN-OKS
               PERFORM CLR-VEN-CAN
               GO TO FIN-PUT-VEN-CAN.
           MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVCT IN CAN-FLD.
           MOVE VEN-NUM-IVEN IN VEN TO VEN-NUM-IVEN IN CAN-FLD.
           MOVE VEN-NUM-DVEN IN VEN TO VEN-NUM-DVEN IN CAN-FLD.
           MOVE VEN-NUM-MVEN IN VEN TO VEN-NUM-MVEN IN CAN-FLD.
           MOVE VEN-NUM-SVEN IN VEN TO VEN-NUM-SVEN IN CAN-FLD.
           MOVE VEN-NUM-AVEN IN VEN TO VEN-NUM-AVEN IN CAN-FLD.
           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DIMV IN CAN-FLD.
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MIMV IN CAN-FLD.
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SIMV IN CAN-FLD.
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AIMV IN CAN-FLD.
           MOVE VEN-IND-SCTB IN VEN TO VEN-IND-SCTB IN CAN-FLD.
           MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD.
           MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF VEN-IND-SCTB IN CAN-FLD > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'SCTB' TO MSC-COD-TMSC IN MSC
               MOVE VEN-IND-SCTB IN CAN-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SCTB IN CAN-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-SCTB IN CAN-FLD.
       FIN-PUT-VEN-CAN.
           EXIT.

       PUT-RCV-CAN SECTION.
       INI-PUT-RCV-CAN.
           IF PGM-STAT-RCV-NUL
               GO TO FIN-PUT-RCV-CAN.
           IF NOT PGM-STAT-RCV-OKS
               PERFORM CLR-RCV-CAN
               GO TO FIN-PUT-RCV-CAN.
           MOVE RCV-MSC-MCAN IN RCV TO RCV-MSC-MCAN IN CAN-FLD.
           MOVE RCV-SGV-CAPI IN RCV TO RCV-SGV-CAPI IN CAN-FLD.
           MOVE RCV-SGV-FINA IN RCV TO RCV-SGV-FINA IN CAN-FLD.
       FIN-PUT-RCV-CAN.
           EXIT.

       PUT-ROV-CAN SECTION.
       INI-PUT-ROV-CAN.
       FIN-PUT-ROV-CAN.
           EXIT.

       PUT-ICG-CAN SECTION.
       INI-PUT-ICG-CAN.
           IF PGM-STAT-ICG-NUL
               GO TO FIN-PUT-ICG-CAN.
           IF NOT PGM-STAT-ICG-OKS
               PERFORM CLR-ICG-CAN
               GO TO FIN-PUT-ICG-CAN.
           MOVE ICG-SGV-TINT IN ICG TO ICG-SGV-TINT IN CAN-FLD.
           MOVE 'N' TO WSS-IBLK-TINT IN WSS-VARI.
      *>>>>
       FIN-PUT-ICG-CAN.
           EXIT.

       PUT-CYA-CAN SECTION.
       INI-PUT-CYA-CAN.
      *<<<< INI_PUT_CYA_CAN
           IF SCR-CYA-IND-MCYA = 'M'
               MOVE 'M'         TO CYA-IND-TCYA IN CAN-FLD
               MOVE SPACES      TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES      TO CYA-IIC-ICYA IN CAN-FLD
               MOVE 'MULTIPLES' TO FRM-GLS-TCYA IN CAN-FLD
               GO TO FIN-PUT-CYA-CAN.
      *>>>>
           IF PGM-STAT-CYA-NUL
               GO TO FIN-PUT-CYA-CAN.
           IF NOT PGM-STAT-CYA-OKS
               PERFORM CLR-CYA-CAN
               GO TO FIN-PUT-CYA-CAN.
           MOVE CYA-IND-TCYA IN CYA TO CYA-IND-TCYA IN CAN-FLD.
           MOVE CYA-CAI-ICYA IN CYA TO CYA-CAI-ICYA IN CAN-FLD.
           MOVE CYA-IIC-ICYA IN CYA TO CYA-IIC-ICYA IN CAN-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF CYA-IND-TCYA IN CAN-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TCYA' TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-TCYA IN CAN-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-TCYA IN CAN-FLD.
       FIN-PUT-CYA-CAN.
           EXIT.

       RET-ALL-CAN SECTION.
       INI-RET-ALL-CAN.
           PERFORM KEY-ALL-CAN.
           PERFORM RET-OPC-CAN.
           PERFORM RET-CAN-CAN.
           PERFORM RET-DBC-CAN.
           PERFORM RET-VEN-CAN.
           PERFORM RET-RCV-CAN.
           PERFORM RET-ROV-CAN.
           PERFORM RET-ICG-CAN.
           PERFORM RET-CYA-CAN.
       FIN-RET-ALL-CAN.
           EXIT.

       RET-OPC-CAN SECTION.
       INI-RET-OPC-CAN.
           MOVE OPC-MSC-TVOC IN CAN-FLD TO OPC-MSC-TVOC IN OPC.
           MOVE OPC-COD-TOOC IN CAN-FLD TO OPC-COD-TOOC IN OPC.
           MOVE OPC-COD-OFOC IN CAN-FLD TO OPC-COD-OFOC IN OPC.
           MOVE OPC-COD-AOOC IN CAN-FLD TO OPC-COD-AOOC IN OPC.
           MOVE OPC-NUM-VCVG IN CAN-FLD TO OPC-NUM-VCVG IN OPC.
           MOVE OPC-COD-VCOC IN CAN-FLD TO OPC-COD-VCOC IN OPC.
           MOVE OPC-VAL-SCRE IN CAN-FLD TO OPC-VAL-SCRE IN OPC.
       FIN-RET-OPC-CAN.
           EXIT.

       RET-CAN-CAN SECTION.
       INI-RET-CAN-CAN.
           MOVE CAN-COD-RCAN IN CAN-FLD TO CAN-COD-RCAN IN CAN.
           MOVE CAN-MSC-STAT IN CAN-FLD TO CAN-MSC-STAT IN CAN.
           MOVE CAN-MSC-CANC IN CAN-FLD TO CAN-MSC-CANC IN CAN.
           MOVE CAN-NUM-DOUT IN CAN-FLD TO CAN-NUM-DOUT IN CAN.
           MOVE CAN-NUM-MOUT IN CAN-FLD TO CAN-NUM-MOUT IN CAN.
           MOVE CAN-NUM-SOUT IN CAN-FLD TO CAN-NUM-SOUT IN CAN.
           MOVE CAN-NUM-AOUT IN CAN-FLD TO CAN-NUM-AOUT IN CAN.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE CAN-NUM-DEGR IN CAN-FLD TO CAN-NUM-DEGR IN CAN.
           MOVE CAN-NUM-MEGR IN CAN-FLD TO CAN-NUM-MEGR IN CAN.
           MOVE CAN-NUM-SEGR IN CAN-FLD TO CAN-NUM-SEGR IN CAN.
           MOVE CAN-NUM-AEGR IN CAN-FLD TO CAN-NUM-AEGR IN CAN.
           MOVE CAN-COD-OFCA IN CAN-FLD TO CAN-COD-OFCA IN CAN.
           MOVE CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-GAST IN CAN.
           MOVE CAN-SGV-TREN IN CAN-FLD TO CAN-SGV-TREN IN CAN.
           MOVE CAN-SGV-TPAG IN CAN-FLD TO CAN-SGV-TPAG IN CAN.
           MOVE CAN-SGV-DIFE IN CAN-FLD TO CAN-SGV-DIFE IN CAN.
       FIN-RET-CAN-CAN.
           EXIT.

       RET-DBC-CAN SECTION.
       INI-RET-DBC-CAN.
           MOVE DBC-GLS-NOMC IN CAN-FLD TO DBC-GLS-NOMC IN DBC.
           MOVE DBC-IND-ICLI IN CAN-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN CAN-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE DBC-NUM-ICLI IN CAN-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN CAN-FLD TO DBC-VRF-ICLI IN DBC.
       FIN-RET-DBC-CAN.
           EXIT.

       RET-VEN-CAN SECTION.
       INI-RET-VEN-CAN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-IND-SCTB IN CAN-FLD TO VEN-IND-SCTB IN VEN.
           MOVE VEN-VAL-SCAP IN CAN-FLD TO VEN-VAL-SCAP IN VEN.
           MOVE VEN-VAL-SFIN IN CAN-FLD TO VEN-VAL-SFIN IN VEN.
       FIN-RET-VEN-CAN.
           EXIT.

       RET-RCV-CAN SECTION.
       INI-RET-RCV-CAN.
           MOVE RCV-MSC-MCAN IN CAN-FLD TO RCV-MSC-MCAN IN RCV.
           MOVE RCV-SGV-CAPI IN CAN-FLD TO RCV-SGV-CAPI IN RCV.
           MOVE RCV-SGV-FINA IN CAN-FLD TO RCV-SGV-FINA IN RCV.
       FIN-RET-RCV-CAN.
           EXIT.

       RET-ROV-CAN SECTION.
       INI-RET-ROV-CAN.
       FIN-RET-ROV-CAN.
           EXIT.

       RET-ICG-CAN SECTION.
       INI-RET-ICG-CAN.
           MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT IN ICG.
       FIN-RET-ICG-CAN.
           EXIT.

       RET-CYA-CAN SECTION.
       INI-RET-CYA-CAN.
           MOVE CYA-IND-TCYA IN CAN-FLD TO CYA-IND-TCYA IN CYA.
           MOVE CYA-CAI-ICYA IN CAN-FLD TO CYA-CAI-ICYA IN CYA.
           MOVE CYA-IIC-ICYA IN CAN-FLD TO CYA-IIC-ICYA IN CYA.
       FIN-RET-CYA-CAN.
           EXIT.

       KEY-ALL-CAN SECTION.
       INI-KEY-ALL-CAN.
           PERFORM KEY-OPC-CAN.
           PERFORM KEY-CAN-CAN.
           PERFORM KEY-DBC-CAN.
           PERFORM KEY-VEN-CAN.
           PERFORM KEY-RCV-CAN.
           PERFORM KEY-ROV-CAN.
           PERFORM KEY-ICG-CAN.
           PERFORM KEY-CYA-CAN.
       FIN-KEY-ALL-CAN.
           EXIT.

       KEY-OPC-CAN SECTION.
       INI-KEY-OPC-CAN.
       FIN-KEY-OPC-CAN.
           EXIT.

       KEY-CAN-CAN SECTION.
       INI-KEY-CAN-CAN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN.
       FIN-KEY-CAN-CAN.
           EXIT.

       KEY-DBC-CAN SECTION.
       INI-KEY-DBC-CAN.
       FIN-KEY-DBC-CAN.
           EXIT.

       KEY-VEN-CAN SECTION.
       INI-KEY-VEN-CAN.
           MOVE VEN-NUM-IVCT IN CAN-FLD TO VEN-NUM-IVCT IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
       FIN-KEY-VEN-CAN.
           EXIT.

       KEY-RCV-CAN SECTION.
       INI-KEY-RCV-CAN.
       FIN-KEY-RCV-CAN.
           EXIT.

       KEY-ROV-CAN SECTION.
       INI-KEY-ROV-CAN.
       FIN-KEY-ROV-CAN.
           EXIT.

       KEY-ICG-CAN SECTION.
       INI-KEY-ICG-CAN.
       FIN-KEY-ICG-CAN.
           EXIT.

       KEY-CYA-CAN SECTION.
       INI-KEY-CYA-CAN.
       FIN-KEY-CYA-CAN.
           EXIT.

       SCR-CLRA-CAN SECTION.
       INI-SCR-CLRA-CAN.
           PERFORM CLR-KEY-CAN.
           PERFORM CLR-FLD-CAN.
       FIN-SCR-CLRA-CAN.
           EXIT.

       CLR-KEY-CAN SECTION.
       INI-CLR-KEY-CAN.
           MOVE SPACES TO CAN-CAI-IOPC IN CAN-FLD.
           MOVE ZEROES TO CAN-IIC-IOPC IN CAN-FLD.
           MOVE ZEROES TO CAN-NUM-ICAN IN CAN-FLD.
           MOVE ZEROES TO VEN-NUM-IVCT IN CAN-FLD.
           MOVE ZEROES TO VEN-NUM-IVEN IN CAN-FLD.
       FIN-CLR-KEY-CAN.
           EXIT.

       CLR-FLD-CAN SECTION.
       INI-CLR-FLD-CAN.
           MOVE SPACES TO FRM-GLS-TVOC IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-OFOC IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-RCAN IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-CANC IN CAN-FLD.
           MOVE ZEROES TO FRM-SGV-TINT IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-IITR IN CAN-FLD.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-TINT IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-OFCA IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-SCTB IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-TCYA IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN CAN-FLD.
           PERFORM CLR-OPC-CAN.
           PERFORM CLR-CAN-CAN.
           PERFORM CLR-DBC-CAN.
           PERFORM CLR-VEN-CAN.
           PERFORM CLR-RCV-CAN.
           PERFORM CLR-ROV-CAN.
           PERFORM CLR-ICG-CAN.
           PERFORM CLR-CYA-CAN.
       FIN-CLR-FLD-CAN.
           EXIT.

       CLR-OPC-CAN SECTION.
       INI-CLR-OPC-CAN.
           MOVE SPACES TO OPC-MSC-TVOC IN CAN-FLD.
           MOVE SPACES TO OPC-COD-TOOC IN CAN-FLD.
           MOVE SPACES TO OPC-COD-OFOC IN CAN-FLD.
           MOVE SPACES TO OPC-COD-AOOC IN CAN-FLD.
           MOVE ZEROES TO OPC-NUM-VCVG IN CAN-FLD.
           MOVE SPACES TO OPC-COD-VCOC IN CAN-FLD.
           MOVE ZEROES TO OPC-VAL-SCRE IN CAN-FLD.
       FIN-CLR-OPC-CAN.
           EXIT.

       CLR-CAN-CAN SECTION.
       INI-CLR-CAN-CAN.
           MOVE SPACES TO CAN-COD-RCAN IN CAN-FLD.
           MOVE SPACES TO CAN-MSC-STAT IN CAN-FLD.
           MOVE SPACES TO CAN-MSC-CANC IN CAN-FLD.
           MOVE SPACES TO CAN-FEC-FOUT IN CAN-FLD.
           MOVE SPACES TO CAN-FEC-FCAN IN CAN-FLD.
           MOVE SPACES TO CAN-FEC-FEGR IN CAN-FLD.
           MOVE SPACES TO CAN-COD-OFCA IN CAN-FLD.
           MOVE ZEROES TO CAN-SGV-GAST IN CAN-FLD.
           MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD.
           MOVE ZEROES TO CAN-SGV-TPAG IN CAN-FLD.
           MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.
       FIN-CLR-CAN-CAN.
           EXIT.

       CLR-DBC-CAN SECTION.
       INI-CLR-DBC-CAN.
           MOVE SPACES TO DBC-GLS-NOMC IN CAN-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN CAN-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN CAN-FLD.
           MOVE ZEROES TO DBC-NUM-ICLI IN CAN-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN CAN-FLD.
       FIN-CLR-DBC-CAN.
           EXIT.

       CLR-VEN-CAN SECTION.
       INI-CLR-VEN-CAN.
           MOVE SPACES TO VEN-FEC-FVEN IN CAN-FLD.
           MOVE SPACES TO VEN-FEC-FIMV IN CAN-FLD.
           MOVE SPACES TO VEN-IND-SCTB IN CAN-FLD.
           MOVE ZEROES TO VEN-VAL-SCAP IN CAN-FLD.
           MOVE ZEROES TO VEN-VAL-SFIN IN CAN-FLD.
       FIN-CLR-VEN-CAN.
           EXIT.

       CLR-RCV-CAN SECTION.
       INI-CLR-RCV-CAN.
           MOVE SPACES TO RCV-MSC-MCAN IN CAN-FLD.
           MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD.
           MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD.
       FIN-CLR-RCV-CAN.
           EXIT.

       CLR-ROV-CAN SECTION.
       INI-CLR-ROV-CAN.
           MOVE SPACES TO ROV-CAI-IOPC IN CAN-FLD.
           MOVE ZEROES TO ROV-IIC-IOPC IN CAN-FLD.
       FIN-CLR-ROV-CAN.
           EXIT.

       CLR-ICG-CAN SECTION.
       INI-CLR-ICG-CAN.
           MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD.
       FIN-CLR-ICG-CAN.
           EXIT.

       CLR-CYA-CAN SECTION.
       INI-CLR-CYA-CAN.
           MOVE SPACES TO CYA-IND-TCYA IN CAN-FLD.
           MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD.
           MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD.
       FIN-CLR-CYA-CAN.
           EXIT.

       FST-KEY-CAN SECTION.
       INI-FST-KEY-CAN.
           MOVE -1 TO CAN-CAI-IOPC-LEN IN CAN-FLD.
       FIN-FST-KEY-CAN.
           EXIT.

       FST-FLD-CAN SECTION.
       INI-FST-FLD-CAN.
           MOVE -1 TO CAN-COD-RCAN-LEN IN CAN-FLD.
       FIN-FST-FLD-CAN.
           EXIT.

       PRO-KEY-CAN SECTION.
       INI-PRO-KEY-CAN.
           PERFORM PRO-IKY-CAN.
           PERFORM PRO-AKY-CAN.
           PERFORM PRO-MKY-CAN.
       FIN-PRO-KEY-CAN.
           EXIT.

       PRO-IKY-CAN SECTION.
       INI-PRO-IKY-CAN.
           MOVE FRM-CPIM-AEY TO CAN-CAI-IOPC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-IIC-IOPC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-NUM-IVCT-ATR IN CAN-FLD.
       FIN-PRO-IKY-CAN.
           EXIT.

       PRO-MKY-CAN SECTION.
       INI-PRO-MKY-CAN.
       FIN-PRO-MKY-CAN.
           EXIT.

       PRO-AKY-CAN SECTION.
       INI-PRO-AKY-CAN.
           MOVE FRM-CPIM-AEY TO CAN-NUM-ICAN-ATR IN CAN-FLD.
       FIN-PRO-AKY-CAN.
           EXIT.

       PRO-FLD-CAN SECTION.
       INI-PRO-FLD-CAN.
           PERFORM PRO-OPC-CAN.
           PERFORM PRO-CAN-CAN.
           PERFORM PRO-DBC-CAN.
           PERFORM PRO-VEN-CAN.
           PERFORM PRO-RCV-CAN.
           PERFORM PRO-ROV-CAN.
           PERFORM PRO-ICG-CAN.
           PERFORM PRO-CYA-CAN.
       FIN-PRO-FLD-CAN.
           EXIT.

       PRO-OPC-CAN SECTION.
       INI-PRO-OPC-CAN.
       FIN-PRO-OPC-CAN.
           EXIT.

       PRO-CAN-CAN SECTION.
       INI-PRO-CAN-CAN.
           MOVE FRM-CPIM-AEY TO CAN-COD-RCAN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-MSC-CANC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-FEC-FCAN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-COD-OFCA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-SGV-GAST-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-SGV-TREN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-SGV-TPAG-ATR IN CAN-FLD.
       FIN-PRO-CAN-CAN.
           EXIT.

       PRO-DBC-CAN SECTION.
       INI-PRO-DBC-CAN.
       FIN-PRO-DBC-CAN.
           EXIT.

       PRO-VEN-CAN SECTION.
       INI-PRO-VEN-CAN.
       FIN-PRO-VEN-CAN.
           EXIT.

       PRO-RCV-CAN SECTION.
       INI-PRO-RCV-CAN.
           MOVE FRM-CPIM-AEY TO RCV-SGV-CAPI-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO RCV-SGV-FINA-ATR IN CAN-FLD.
       FIN-PRO-RCV-CAN.
           EXIT.

       PRO-ROV-CAN SECTION.
       INI-PRO-ROV-CAN.
           MOVE FRM-CPIM-AEY TO ROV-CAI-IOPC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO ROV-IIC-IOPC-ATR IN CAN-FLD.
       FIN-PRO-ROV-CAN.
           EXIT.

       PRO-ICG-CAN SECTION.
       INI-PRO-ICG-CAN.
           MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN CAN-FLD.
       FIN-PRO-ICG-CAN.
           EXIT.

       PRO-CYA-CAN SECTION.
       INI-PRO-CYA-CAN.
           MOVE FRM-CPIM-AEY TO CYA-IND-TCYA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CYA-CAI-ICYA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CYA-IIC-ICYA-ATR IN CAN-FLD.
       FIN-PRO-CYA-CAN.
           EXIT.

       UNP-KEY-CAN SECTION.
       INI-UNP-KEY-CAN.
           PERFORM UNP-IKY-CAN.
           PERFORM UNP-AKY-CAN.
           PERFORM UNP-MKY-CAN.
       FIN-UNP-KEY-CAN.
           EXIT.

       UNP-IKY-CAN SECTION.
       INI-UNP-IKY-CAN.
           MOVE FRM-CPIM-UBY TO CAN-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO CAN-IIC-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO VEN-NUM-IVCT-ATR.
       FIN-UNP-IKY-CAN.
           EXIT.

       UNP-MKY-CAN SECTION.
       INI-UNP-MKY-CAN.
       FIN-UNP-MKY-CAN.
           EXIT.

       UNP-AKY-CAN SECTION.
       INI-UNP-AKY-CAN.
           MOVE FRM-CPIM-UBY TO CAN-NUM-ICAN-ATR.
       FIN-UNP-AKY-CAN.
           EXIT.

       UNP-FLD-CAN SECTION.
       INI-UNP-FLD-CAN.
           PERFORM UNP-OPC-CAN.
           PERFORM UNP-CAN-CAN.
           PERFORM UNP-DBC-CAN.
           PERFORM UNP-VEN-CAN.
           PERFORM UNP-RCV-CAN.
           PERFORM UNP-ROV-CAN.
           PERFORM UNP-ICG-CAN.
           PERFORM UNP-CYA-CAN.
       FIN-UNP-FLD-CAN.
           EXIT.

       UNP-OPC-CAN SECTION.
       INI-UNP-OPC-CAN.
       FIN-UNP-OPC-CAN.
           EXIT.

       UNP-CAN-CAN SECTION.
       INI-UNP-CAN-CAN.
           MOVE FRM-CPIM-UBY TO CAN-COD-RCAN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-MSC-CANC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-FEC-FCAN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-COD-OFCA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-SGV-GAST-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-SGV-TREN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-SGV-TPAG-ATR IN CAN-FLD.
       FIN-UNP-CAN-CAN.
           EXIT.

       UNP-DBC-CAN SECTION.
       INI-UNP-DBC-CAN.
       FIN-UNP-DBC-CAN.
           EXIT.

       UNP-VEN-CAN SECTION.
       INI-UNP-VEN-CAN.
       FIN-UNP-VEN-CAN.
           EXIT.

       UNP-RCV-CAN SECTION.
       INI-UNP-RCV-CAN.
           MOVE FRM-CPIM-UBY TO RCV-SGV-CAPI-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO RCV-SGV-FINA-ATR IN CAN-FLD.
       FIN-UNP-RCV-CAN.
           EXIT.

       UNP-ROV-CAN SECTION.
       INI-UNP-ROV-CAN.
           MOVE FRM-CPIM-UBY TO ROV-CAI-IOPC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO ROV-IIC-IOPC-ATR IN CAN-FLD.
       FIN-UNP-ROV-CAN.
           EXIT.

       UNP-ICG-CAN SECTION.
       INI-UNP-ICG-CAN.
           MOVE FRM-CPIM-UBY TO ICG-SGV-TINT-ATR IN CAN-FLD.
       FIN-UNP-ICG-CAN.
           EXIT.

       UNP-CYA-CAN SECTION.
       INI-UNP-CYA-CAN.
           MOVE FRM-CPIM-UBY TO CYA-IND-TCYA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CYA-CAI-ICYA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CYA-IIC-ICYA-ATR IN CAN-FLD.
       FIN-UNP-CYA-CAN.
           EXIT.

       VAL-KEY-CAN SECTION.
       INI-VAL-KEY-CAN.
           PERFORM VAL-IKY-CAN.
           PERFORM VAL-MKY-CAN.
           PERFORM VAL-AKY-CAN.
       FIN-VAL-KEY-CAN.
           EXIT.

       VAL-IKY-CAN SECTION.
       INI-VAL-IKY-CAN.
           PERFORM VAL-CAN-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-CAI-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-IKY-CAN.
           PERFORM VAL-CAN-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-IKY-CAN.
           PERFORM VAL-VEN-NUM-IVCT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VEN-NUM-IVCT-LEN IN CAN-FLD
                GO TO FIN-VAL-IKY-CAN.
           PERFORM VAL-VEN-NUM-IVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VEN-NUM-IVEN-LEN IN CAN-FLD
                GO TO FIN-VAL-IKY-CAN.
       FIN-VAL-IKY-CAN.
           EXIT.

       VAL-MKY-CAN SECTION.
       INI-VAL-MKY-CAN.
       FIN-VAL-MKY-CAN.
           EXIT.

       VAL-AKY-CAN SECTION.
       INI-VAL-AKY-CAN.
           PERFORM VAL-CAN-NUM-ICAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-NUM-ICAN-LEN IN CAN-FLD
                GO TO FIN-VAL-AKY-CAN.
       FIN-VAL-AKY-CAN.
           EXIT.

       VAL-FLD-CAN SECTION.
       INI-VAL-FLD-CAN.
           PERFORM VAL-OPC-MSC-TVOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPC-MSC-TVOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-COD-TOOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPC-COD-TOOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-COD-OFOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPC-COD-OFOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-TVOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TVOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-TOOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TOOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-OFOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-NOMC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IND-ICLI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-ICLI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-NUM-ICLI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-VRF-ICLI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-RCV-MSC-MCAN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO RCV-MSC-MCAN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-COD-RCAN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-COD-RCAN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-MSC-STAT.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-MSC-STAT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-STAT.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-STAT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-RCAN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-RCAN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-MSC-CANC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-MSC-CANC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-ROV-CAI-IOPC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ROV-CAI-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-ROV-IIC-IOPC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ROV-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-CANC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-CANC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-VEN-FEC-FVEN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VEN-FEC-FVEN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-VEN-FEC-FIMV.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VEN-FEC-FIMV-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-FEC-FOUT.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-FEC-FOUT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-FEC-FCAN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-FEC-FCAN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-FEC-FEGR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-FEC-FEGR-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-SGV-TINT.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-ICG-SGV-TINT.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ICG-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-IITR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-IITR-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-IND-TIPE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IND-TIPE-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-TINT.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-COD-OFCA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-COD-OFCA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-OFCA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFCA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-SGV-GAST.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-SGV-GAST-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-COD-AOOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPC-COD-AOOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-AOOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-AOOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-SGV-TREN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-SGV-TREN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-VEN-IND-SCTB.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VEN-IND-SCTB-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-SCTB.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-SCTB-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-SGV-TPAG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-SGV-TPAG-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-NUM-VCVG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPC-NUM-VCVG-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CYA-IND-TCYA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CYA-IND-TCYA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-TCYA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TCYA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-COD-VCOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPC-COD-VCOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-VCOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CYA-CAI-ICYA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CYA-CAI-ICYA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CYA-IIC-ICYA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CYA-IIC-ICYA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-VAL-SCRE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPC-VAL-SCRE-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-SGV-DIFE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAN-SGV-DIFE-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-VEN-VAL-SCAP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VEN-VAL-SCAP-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-RCV-SGV-CAPI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO RCV-SGV-CAPI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-VEN-VAL-SFIN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VEN-VAL-SFIN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-RCV-SGV-FINA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO RCV-SGV-FINA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
       FIN-VAL-FLD-CAN.
           EXIT.

       VAL-OPC-MSC-TVOC SECTION.
       INI-VAL-OPC-MSC-TVOC.
       FIN-VAL-OPC-MSC-TVOC.
           EXIT.

       VAL-OPC-COD-TOOC SECTION.
       INI-VAL-OPC-COD-TOOC.
       FIN-VAL-OPC-COD-TOOC.
           EXIT.

       VAL-OPC-COD-OFOC SECTION.
       INI-VAL-OPC-COD-OFOC.
       FIN-VAL-OPC-COD-OFOC.
           EXIT.

       VAL-CAN-CAI-IOPC SECTION.
       INI-VAL-CAN-CAI-IOPC.
           IF CAN-CAI-IOPC IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CAN-CAI-IOPC IN CAN-FLD.
       FIN-VAL-CAN-CAI-IOPC.
           EXIT.

       VAL-CAN-IIC-IOPC SECTION.
       INI-VAL-CAN-IIC-IOPC.
       FIN-VAL-CAN-IIC-IOPC.
           EXIT.

       VAL-FRM-GLS-TVOC SECTION.
       INI-VAL-FRM-GLS-TVOC.
       FIN-VAL-FRM-GLS-TVOC.
           EXIT.

       VAL-FRM-GLS-TOOC SECTION.
       INI-VAL-FRM-GLS-TOOC.
       FIN-VAL-FRM-GLS-TOOC.
           EXIT.

       VAL-FRM-GLS-OFOC SECTION.
       INI-VAL-FRM-GLS-OFOC.
       FIN-VAL-FRM-GLS-OFOC.
           EXIT.

       VAL-CAN-NUM-ICAN SECTION.
       INI-VAL-CAN-NUM-ICAN.
       FIN-VAL-CAN-NUM-ICAN.
           EXIT.

       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.

       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.

       VAL-VEN-NUM-IVCT SECTION.
       INI-VAL-VEN-NUM-IVCT.
      *<<<< VEN_NUM_IVCT
           MOVE VEN-NUM-IVCT IN CAN-FLD TO VEN-NUM-IVEN IN CAN-FLD.
      *>>>>
       FIN-VAL-VEN-NUM-IVCT.
           EXIT.

       VAL-RCV-MSC-MCAN SECTION.
       INI-VAL-RCV-MSC-MCAN.
       FIN-VAL-RCV-MSC-MCAN.
           EXIT.

       VAL-CAN-COD-RCAN SECTION.
       INI-VAL-CAN-COD-RCAN.
           IF CAN-COD-RCAN IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CAN-COD-RCAN IN CAN-FLD.
      *
           IF  CAN-COD-RCAN IN CAN-FLD NOT > SPACES
                MOVE OPC-COD-RMOC IN OPC TO CAN-COD-RCAN IN CAN-FLD.
      *
           IF SCR-USER = 'COLPGCA1'
               GO TO FIN-VAL-CAN-COD-RCAN.
      *
      *>>>>
       FIN-VAL-CAN-COD-RCAN.
           EXIT.

       VAL-CAN-MSC-STAT SECTION.
       INI-VAL-CAN-MSC-STAT.
       FIN-VAL-CAN-MSC-STAT.
           EXIT.

       VAL-FRM-GLS-STAT SECTION.
       INI-VAL-FRM-GLS-STAT.
       FIN-VAL-FRM-GLS-STAT.
           EXIT.

       VAL-FRM-GLS-RCAN SECTION.
       INI-VAL-FRM-GLS-RCAN.
       FIN-VAL-FRM-GLS-RCAN.
           EXIT.

       VAL-VEN-NUM-IVEN SECTION.
       INI-VAL-VEN-NUM-IVEN.
       FIN-VAL-VEN-NUM-IVEN.
           EXIT.

       VAL-CAN-MSC-CANC SECTION.
       INI-VAL-CAN-MSC-CANC.
      *VAL-COD Valida codigo de tabla
       FIN-VAL-CAN-MSC-CANC.
           EXIT.

       VAL-ROV-CAI-IOPC SECTION.
       INI-VAL-ROV-CAI-IOPC.
       FIN-VAL-ROV-CAI-IOPC.
           EXIT.

       VAL-ROV-IIC-IOPC SECTION.
       INI-VAL-ROV-IIC-IOPC.
      *<<<< ROV_IIC_IOPC
       FIN-VAL-ROV-IIC-IOPC.
           EXIT.

       VAL-FRM-GLS-CANC SECTION.
       INI-VAL-FRM-GLS-CANC.
       FIN-VAL-FRM-GLS-CANC.
           EXIT.

       VAL-VEN-FEC-FVEN SECTION.
       INI-VAL-VEN-FEC-FVEN.
      *<<<< VEN_FEC_FVEN
           IF VEN-FEC-FVEN IN CAN-FLD NOT > SPACES
              MOVE ZEROES TO VEN-FEC-FVEN IN CAN-FLD.
      *>>>>
       FIN-VAL-VEN-FEC-FVEN.
           EXIT.

       VAL-VEN-FEC-FIMV SECTION.
       INI-VAL-VEN-FEC-FIMV.
      *<<<< VEN_FEC_FIMV
           IF VEN-FEC-FIMV IN CAN-FLD NOT > SPACES
              MOVE ZEROES TO VEN-FEC-FIMV IN CAN-FLD.
      *>>>>
       FIN-VAL-VEN-FEC-FIMV.
           EXIT.

       VAL-CAN-FEC-FOUT SECTION.
       INI-VAL-CAN-FEC-FOUT.
      *<<<< CAN_FEC_FOUT
           IF CAN-FEC-FOUT IN CAN-FLD NOT > SPACES
              MOVE ZEROES TO CAN-FEC-FOUT IN CAN-FLD.
      *>>>>
      *<<<< CAN_FEC_FOUT
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO CAN-NUM-DOUT IN CAN-FLD.
           MOVE HOY-MHOY TO CAN-NUM-MOUT IN CAN-FLD.
           MOVE HOY-SHOY TO CAN-NUM-SOUT IN CAN-FLD.
           MOVE HOY-AHOY TO CAN-NUM-AOUT IN CAN-FLD.
           MOVE HOY-DHOY TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE HOY-MHOY TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE HOY-SHOY TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE HOY-AHOY TO WSS-NUM-ACTB IN WSS-VARI.
       BUS-DIA-HBL-PRV.
      *RST-DIA Retrocede 1 dia la Fecha
           MOVE WSS-NUM-DCTB IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MCTB IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SCTB IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ACTB IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CAN-FEC-FOUT.
           MOVE FEC-ITM1 TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-ACTB IN WSS-VARI.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
                GO TO BUS-DIA-HBL-PRV.
      *>>>>
       FIN-VAL-CAN-FEC-FOUT.
           EXIT.

       VAL-CAN-FEC-FCAN SECTION.
       INI-VAL-CAN-FEC-FCAN.
      *VAL-FEC Validar Fecha
           MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CAN_FEC_FCAN
           IF CAN-FEC-FCAN IN CAN-FLD NOT > ZEROES
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FCAN IN CAN-FLD
                                               FEC-FECH.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CAN-FEC-FCAN IN CAN-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CAN-FEC-FCAN.
      *<<<<
           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN.
      *
           MOVE 'NOEXISTECAN' TO MSG-COD-MENS.
      *
       LEE-NXT-CAN.
           SUBTRACT 1 FROM CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
               IF CAN-MSC-STAT IN CAN NOT = 'R' AND
                  CAN-SGV-TPAG IN CAN NOT < ZEROES AND
                  CAN-SGV-TREN IN CAN NOT < ZEROES
                   MOVE CAN-NUM-SCAN IN CAN     TO FEC-SEC1
                   MOVE CAN-NUM-ACAN IN CAN     TO FEC-AEC1
                   MOVE CAN-NUM-MCAN IN CAN     TO FEC-MEC1
                   MOVE CAN-NUM-DCAN IN CAN     TO FEC-DEC1
                   MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC            TO FEC-FORM
                   MOVE FEC-CMP-FEC             TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'COL'         TO MSG-COD-SIST
                       MOVE 'FECFCANANT>' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CAN-FEC-FCAN
                   ELSE
                       MOVE 'EXISTECAN' TO MSG-COD-MENS
               ELSE
                   GO TO LEE-NXT-CAN.

           IF MSG-COD-MENS = 'EXISTECAN'
               MOVE SPACES TO MSG-COD-MENS.
           IF MSG-COD-MENS = 'NOEXISTECAN'
               MOVE SPACES TO MSG-COD-MENS
               MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC
               MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC
               MOVE ZEROES                  TO DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF FIO-STAT-OKS AND
                  CAN-CAI-IOPC IN CAN-FLD = DLC-CAI-IOPC IN DLC AND
                  CAN-IIC-IOPC IN CAN-FLD = DLC-IIC-IOPC IN DLC
                   IF DLC-IND-SCTB IN DLC = 'VCD' OR
                      DLC-IND-SCTB IN DLC = 'CAS'
                       MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC1
                       MOVE VEN-NUM-SIMV IN CAN-FLD TO FEC-SEC2
                       MOVE VEN-NUM-AIMV IN CAN-FLD TO FEC-AEC2
                       MOVE VEN-NUM-MIMV IN CAN-FLD TO FEC-MEC2
                       MOVE VEN-NUM-DIMV IN CAN-FLD TO FEC-DEC2
                       MOVE FEC-FORM-FEC            TO FEC-FORM
                       MOVE FEC-CMP-FEC             TO FEC-CMND
                       PERFORM PRO-FEC
                       IF FEC-STAT-LES
                           MOVE 'COL'          TO MSG-COD-SIST
                           MOVE 'FECFCANFIMV<' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           GO TO FIN-VAL-CAN-FEC-FCAN.


           IF CAN-FEC-FCAN IN CAN-FLD > ZEROES
               MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC1
               MOVE OPC-NUM-SCOL IN OPC     TO FEC-SEC2
               MOVE OPC-NUM-ACOL IN OPC     TO FEC-AEC2
               MOVE OPC-NUM-MCOL IN OPC     TO FEC-MEC2
               MOVE OPC-NUM-DCOL IN OPC     TO FEC-DEC2
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-CMP-FEC             TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-LES
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'FECFCANFCOL<' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CAN-FEC-FCAN.

           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-NUM-DAUX IN WSS-VARI.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-NUM-MAUX IN WSS-VARI.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-NUM-SAUX IN WSS-VARI.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-NUM-AAUX IN WSS-VARI.
      *>>>>
       FIN-VAL-CAN-FEC-FCAN.
           EXIT.

       VAL-CAN-FEC-FEGR SECTION.
       INI-VAL-CAN-FEC-FEGR.
      *<<<< CAN_FEC_FEGR
           IF CAN-FEC-FEGR IN CAN-FLD NOT > SPACES
              MOVE ZEROES TO CAN-FEC-FEGR IN CAN-FLD.
      *>>>>
       FIN-VAL-CAN-FEC-FEGR.
           EXIT.

       VAL-FRM-SGV-TINT SECTION.
       INI-VAL-FRM-SGV-TINT.
       FIN-VAL-FRM-SGV-TINT.
           EXIT.

       VAL-ICG-SGV-TINT SECTION.
       INI-VAL-ICG-SGV-TINT.
      *<<<< ICG_SGV_TINT
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.
       FIN-VAL-ICG-SGV-TINT.
           EXIT.

       VAL-FRM-GLS-IITR SECTION.
       INI-VAL-FRM-GLS-IITR.
       FIN-VAL-FRM-GLS-IITR.
           EXIT.

       VAL-FRM-IND-TIPE SECTION.
       INI-VAL-FRM-IND-TIPE.
       FIN-VAL-FRM-IND-TIPE.
           EXIT.

       VAL-FRM-GLS-TINT SECTION.
       INI-VAL-FRM-GLS-TINT.
       FIN-VAL-FRM-GLS-TINT.
           EXIT.

       VAL-CAN-COD-OFCA SECTION.
       INI-VAL-CAN-COD-OFCA.
           IF CAN-COD-OFCA IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CAN-COD-OFCA IN CAN-FLD.
      *<<<< CAN_COD_OFCA
           IF OPC-COD-OFOC IN CAN-FLD = CAN-COD-OFCA IN CAN-FLD AND
              SCR-CMND = 'COF'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CODOFOCOFCA=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAN-COD-OFCA.
      *
           IF CAN-COD-OFCA IN CAN-FLD = SPACES
               MOVE 'COL'             TO MSG-COD-SIST
               MOVE 'DATNOINGOFCA'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAN-COD-OFCA.
      *>>>>
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE CAN-COD-OFCA IN CAN-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFCA IN CAN-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFCA IN CAN-FLD.
       FIN-VAL-CAN-COD-OFCA.
           EXIT.

       VAL-FRM-GLS-OFCA SECTION.
       INI-VAL-FRM-GLS-OFCA.
       FIN-VAL-FRM-GLS-OFCA.
           EXIT.

       VAL-CAN-SGV-GAST SECTION.
       INI-VAL-CAN-SGV-GAST.
      *<<<< CAN_SGV_GAST
           IF CAN-SGV-GAST IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF WSS-CIC-TVAL = '0'
               MOVE CAN-SGV-GAST IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-GAST
                                                      IN CAN-FLD.
      *>>>>
       FIN-VAL-CAN-SGV-GAST.
           EXIT.

       VAL-OPC-COD-AOOC SECTION.
       INI-VAL-OPC-COD-AOOC.
       FIN-VAL-OPC-COD-AOOC.
           EXIT.

       VAL-FRM-GLS-AOOC SECTION.
       INI-VAL-FRM-GLS-AOOC.
       FIN-VAL-FRM-GLS-AOOC.
           EXIT.

       VAL-CAN-SGV-TREN SECTION.
       INI-VAL-CAN-SGV-TREN.
      *<<<< CAN_SGV_TREN
           IF CAN-SGV-TREN IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF CAN-SGV-TREN IN CAN-FLD > ZEROES
               MOVE CAN-SGV-TREN IN CAN-FLD TO WSS-SGV-TREN.
      *>>>>
       FIN-VAL-CAN-SGV-TREN.
           EXIT.

       VAL-VEN-IND-SCTB SECTION.
       INI-VAL-VEN-IND-SCTB.
       FIN-VAL-VEN-IND-SCTB.
           EXIT.

       VAL-FRM-GLS-SCTB SECTION.
       INI-VAL-FRM-GLS-SCTB.
       FIN-VAL-FRM-GLS-SCTB.
           EXIT.

       VAL-CAN-SGV-TPAG SECTION.
       INI-VAL-CAN-SGV-TPAG.
      *<<<< CAN_SGV_TPAG
           IF CAN-SGV-TPAG IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAN-SGV-TPAG.
           IF WSS-CIC-TVAL = '0'
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG
                                                      IN CAN-FLD.
      *>>>>
       FIN-VAL-CAN-SGV-TPAG.
           EXIT.

       VAL-OPC-NUM-VCVG SECTION.
       INI-VAL-OPC-NUM-VCVG.
       FIN-VAL-OPC-NUM-VCVG.
           EXIT.

       VAL-CYA-IND-TCYA SECTION.
       INI-VAL-CYA-IND-TCYA.
           IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CYA-IND-TCYA IN CAN-FLD.
      *<<<< CYA_IND_TCYA
      *    NO OBLIGATORIO
           IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES
               MOVE SPACES TO CYA-IND-TCYA IN CAN-FLD
               MOVE SPACES TO FRM-GLS-TCYA IN CAN-FLD
               GO TO FIN-VAL-CYA-IND-TCYA.
           IF CYA-IND-TCYA IN CAN-FLD = 'M'
               MOVE 'COL'          TO TAB-COD-SIST
               MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MCYAC' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                   MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
                   MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD
                   MOVE 'MULTIPLES' TO FRM-GLS-TCYA IN CAN-FLD
                   GO TO FIN-VAL-CYA-IND-TCYA
               ELSE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'BCI    MCYAC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CYA-IND-TCYA.
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'TCYA'                  TO MSC-COD-TMSC IN MSC.
           MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = SPACES
               GO TO FIN-VAL-CYA-IND-TCYA.
      *
            IF SCR-USER = 'COLPGCA1'
               GO TO STP-VAL-CYA-IND-TCYA.
      *
           IF WSS-FEC-FAUX IN WSS-VARI = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(8) = 'N'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'TCYANONORCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYA-IND-TCYA.

           IF WSS-FEC-FAUX IN WSS-VARI NOT = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(9) = 'N'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'TCYANORETCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYA-IND-TCYA.
       STP-VAL-CYA-IND-TCYA.
      *>>>>
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'TCYA' TO MSC-COD-TMSC IN MSC.
           MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CYA-IND-TCYA IN CAN-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TCYA IN CAN-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-TCYA IN CAN-FLD.
       FIN-VAL-CYA-IND-TCYA.
           EXIT.

       VAL-FRM-GLS-TCYA SECTION.
       INI-VAL-FRM-GLS-TCYA.
      *<<<< FRM_GLS_TCYA
           MOVE MSC-COD-DAT1 IN MSC(3) TO WSS-GLS-DAT1.
      *ISP WSS-GLS-DAT1 SERA USADO EN VALIDACION DE CONSISTENCIA
      *>>>>
       FIN-VAL-FRM-GLS-TCYA.
           EXIT.

       VAL-OPC-COD-VCOC SECTION.
       INI-VAL-OPC-COD-VCOC.
       FIN-VAL-OPC-COD-VCOC.
           EXIT.

       VAL-FRM-GLS-VCOC SECTION.
       INI-VAL-FRM-GLS-VCOC.
       FIN-VAL-FRM-GLS-VCOC.
           EXIT.

       VAL-CYA-CAI-ICYA SECTION.
       INI-VAL-CYA-CAI-ICYA.
           IF CYA-CAI-ICYA IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD.
      *<<<< CYA_CAI_ICYA
           IF CYA-CAI-ICYA IN CAN-FLD NOT > SPACES
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD.
           IF CYA-IND-TCYA IN CAN-FLD = 'M'
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD
               GO TO FIN-VAL-CYA-CAI-ICYA.
      *>>>>
       FIN-VAL-CYA-CAI-ICYA.
           EXIT.

       VAL-CYA-IIC-ICYA SECTION.
       INI-VAL-CYA-IIC-ICYA.
       FIN-VAL-CYA-IIC-ICYA.
           EXIT.

       VAL-OPC-VAL-SCRE SECTION.
       INI-VAL-OPC-VAL-SCRE.
       FIN-VAL-OPC-VAL-SCRE.
           EXIT.

       VAL-CAN-SGV-DIFE SECTION.
       INI-VAL-CAN-SGV-DIFE.
       FIN-VAL-CAN-SGV-DIFE.
           EXIT.

       VAL-VEN-VAL-SCAP SECTION.
       INI-VAL-VEN-VAL-SCAP.
       FIN-VAL-VEN-VAL-SCAP.
           EXIT.

       VAL-RCV-SGV-CAPI SECTION.
       INI-VAL-RCV-SGV-CAPI.
      *<<<< RCV_SGV_CAPI
           IF RCV-SGV-CAPI IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-RCV-SGV-CAPI.
           EXIT.

       VAL-VEN-VAL-SFIN SECTION.
       INI-VAL-VEN-VAL-SFIN.
       FIN-VAL-VEN-VAL-SFIN.
           EXIT.

       VAL-RCV-SGV-FINA SECTION.
       INI-VAL-RCV-SGV-FINA.
      *<<<< RCV_SGV_FINA
           IF RCV-SGV-FINA IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-RCV-SGV-FINA.
           EXIT.

       VAL-CON-KEY-CAN SECTION.
       INI-VAL-CON-KEY-CAN.
      *<<<< INI_VAL_CON_KEY_CAN
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-CAN.
      *>>>>
           IF     CAN-CAI-IOPC IN CAN-FLD NOT > SPACES
              AND CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES
              AND CAN-NUM-ICAN IN CAN-FLD NOT > ZEROES
              AND VEN-NUM-IVCT IN CAN-FLD NOT > ZEROES
              AND VEN-NUM-IVEN IN CAN-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-CAN.
      *<<<< FIN_VAL_CON_KEY_CAN
           IF CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-KEY-CAN.
           EXIT.

       VAL-CON-IKY-CAN SECTION.
       INI-VAL-CON-IKY-CAN.
           IF     CAN-CAI-IOPC IN CAN-FLD NOT > SPACES
              AND CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES
              AND VEN-NUM-IVCT IN CAN-FLD NOT > ZEROES
              AND VEN-NUM-IVEN IN CAN-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-CAN.
      *<<<< FIN_VAL_CON_IKY_CAN
           IF CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-IKY-CAN.
           EXIT.

       VAL-CON-FLD-CAN SECTION.
       INI-VAL-CON-FLD-CAN.
      *<<<< VAL_CON_FLD_CAN
           MOVE ZEROES TO SCR-SGV-INTN.
           MOVE ZEROES TO SCR-SGV-INTM.
           MOVE ZEROES TO SCR-SGV-INT.
           MOVE ZEROES TO WSS-AUX-INTN
                          WSS-AUX-INTM
                          WSS-AUX-INMO
                          WSS-AUX-IMMO
                          SCR-SGV-INMO
                          SCR-SGV-IMMO.
           MOVE ZEROES TO WSS-SGV-RAFV IN WSS-VARI.
           MOVE ZEROES TO WSS-AUX-CAPI IN WSS-VARI.

           MOVE SPACES TO SCR-RCV-STAT.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'PERMITECIE>1' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF NOT ( FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S' )
               IF CAN-MSC-CANC IN CAN-FLD = 'CIE'
                  AND OPC-NUM-VCOR IN OPC > 1
                   MOVE 'NOPERMITECIE' TO MSG-COD-MENS.

           IF MSG-COD-MENS > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-CAN.
      *
           IF SCR-CMND = 'COF'
               GO TO FIN-VAL-CON-FLD-CAN.

      * BUSCA DATO 'COMO OPERA=WSS-OPEC'
      * NO ACEPTA ABONOS PARCIALES PARA BOLETAS DE GARANTIA
      * ISP NO ACEPTA DIGITACION DE OPERACION PARA PRORROGA O
      * NOVACION PARA INGRESO
      * RBG/INI/15-NOV-1996 Esto es para el cobro de Comision.

           IF MSC-CIC-CMSC IN MSC NOT = 'CAJA'
               GO TO CONT-SIN-COBR.

       CONT-SIN-COBR.
      * RBG/FIN/15-NOV-1996 Esto es para el cobro de Comision.
      * RESTA LOS GASTOS
           IF SCR-MSC-TCAN = 'C'
                SUBTRACT CAN-SGV-GAST IN CAN-FLD FROM
                         CAN-SGV-TPAG IN CAN-FLD
                IF CAN-SGV-TPAG IN CAN-FLD < ZEROES
                     MOVE ZEROES TO CAN-SGV-TPAG IN CAN-FLD.

           IF SCR-MSC-TCAN = 'C'
               MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD.

           MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.

           PERFORM GET-SLD.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO END-VAL-CON-FLD-CAN.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-NUM-DCAN IN WSS-VARI.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-NUM-MCAN IN WSS-VARI.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-NUM-SCAN IN WSS-VARI.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-NUM-ACAN IN WSS-VARI.

           MOVE VEN-NUM-DVEN IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.
      *
      *   Inconsistencia forma de cargar fecha de vencimiento pues
      *   Existe campo WSS_CMP_FVEN.....se debe corregir....
           IF WSS-CMP-FCAN IN WSS-VARI < WSS-CMP-FIMV IN WSS-VARI
              MOVE 'A' TO RCV-MSC-MCAN IN CAN-FLD
           ELSE
              IF WSS-CMP-FCAN IN WSS-VARI > WSS-CMP-FIMV IN WSS-VARI
                 MOVE 'V' TO RCV-MSC-MCAN IN CAN-FLD
              ELSE
                 MOVE 'F' TO RCV-MSC-MCAN IN CAN-FLD.
      *
           PERFORM LEE-REG-TCAN.
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'INT'               TO TAB-COD-TTAB IN TAB.
           MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB.
           MOVE ITR-COD-TINT IN ITR TO SCR-COD-TICG.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAN-FLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           IF WSS-CMP-FCAN < WSS-CMP-FIMV
              IF WSS-IBLK-TINT = 'S'
                  MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD
                  MOVE SPACES TO FRM-GLS-TINT IN CAN-FLD
              ELSE
                  IF ICG-SGV-TINT IN CAN-FLD > FRM-SGV-TINT IN CAN-FLD
                      MOVE 'COL'          TO MSG-COD-SIST
                      MOVE 'CANTASD>TASC' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO END-VAL-CON-FLD-CAN.
      *
           MOVE VEN-NUM-DVEN IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.
           IF WSS-CMP-FCAN = WSS-CMP-FIMV AND
              ( SCR-MSC-ECAN  NOT = 'T'  OR
                OPC-NUM-VCOR IN OPC = 1 )
                MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.
      *
           MOVE 0 TO SCR-SGV-IPFC.
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
      *CANCELACION CTE.
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
               PERFORM PRO-TCAN-CTE.
       PRO-MSG-MAL.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               GO TO END-VAL-CON-FLD-CAN.

      *CONVIERTE A PESOS EL INTERES PAGADO A FCAN
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM
                             GIVING SCR-SGV-IPFC ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE SCR-SGV-IPFC TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-IPFC.
      *
       CON-VLD-FLD-SEC.
      *ISP NO PERMITE MODIFICAR CODIGOS DE CANCELACION,
      *    PARA CANCELACIONES YA CREADAS
           IF SCR-CCPP = 'MOD' OR
              ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD )

               IF SCR-MSC-TCAN = 'C' AND
                  SCR-MSC-TCNC = 'C'
                    GO TO CHG-CAN
               ELSE
               IF SCR-MSC-CANC NOT = SCR-MSC-CCNC
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'MSCCANCNOMOD' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.
       CHG-CAN.
           IF CAN-FEC-FOUT IN CAN-FLD = CAN-FEC-FCAN IN CAN-FLD
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD
           ELSE
           IF WSS-FEC-FCTB IN WSS-VARI = WSS-FEC-FAUX IN WSS-VARI
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD
           ELSE
           IF WSS-FEC-FCTB IN WSS-VARI > WSS-FEC-FAUX IN WSS-VARI
               MOVE CAN-FEC-FCAN IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD.

           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO END-VAL-CON-FLD-CAN.

      *ISP I.- CANCELACIONES
      *ISP PARA UNA CANCELACION : ==> BORRAR VALOR RENOVADO
      *ISP 'CTT' O 'CTE' CON VALOR PAGADO EN CERO
      *ISP CUANTO DEBO PAGAR ?
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'T' AND
              CAN-SGV-TPAG IN CAN-FLD NOT > ZEROES AND
              WSS-IBLK-TPAG  = 'S'
                IF SCR-MSC-ECAN = 'T'
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TPAG IN CAN-FLD
                ELSE
                IF SCR-MSC-ECAN = 'E'
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TPAG IN CAN-FLD.

      *ISP 'CTT' O 'CTE' CON VALOR PAGADO MAYOR QUE CERO
      *ISP PAGO ESA CANTIDAD, POSIBLE DIFERENCIA
           PERFORM ABS-TPAG.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'T'
              IF SCR-MSC-ECAN = 'T' OR 'E'
                 SUBTRACT WSS-VAL-SVEN FROM WSS-SGV-TPAG GIVING
                          CAN-SGV-DIFE IN CAN-FLD.

           IF ( CAN-SGV-DIFE IN CAN-FLD NOT = ZEROS ) AND
              ( SCR-CMND NOT = 'IVP' ) AND ( SCR-CMND NOT = 'MVP' )
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'NODEBEIRTPAG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-CON-FLD-CAN.

           IF WSS-VAL-SVEN < WSS-VAL-SCAP AND
              WSS-OPEC NOT = 'B'
               IF NOT ( SCR-CMND = 'IVP' OR SCR-CMND = 'MVP' )
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CANTIPEDESC>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
                   IF ( SCR-MSC-TCAN = 'C' ) AND
                      ( SCR-MSC-FCAN = 'T' ) AND
                      ( SCR-MSC-ECAN = 'T' OR 'E' )
                       SUBTRACT WSS-VAL-SVEN FROM WSS-VAL-SCAP
                                      GIVING CAN-SGV-DIFE IN CAN-FLD.

      *ISP PARA CANCELACION PARCIAL CON FORMA CANCELACION 'P' O 'I' O 'C
      *ISP EXIGE VALOR PAGADO
      *ISP II.- RENOVACIONES
      *ISP CALCULOS
      *ISP RENOVACION TOTAL ==> V.P. <> 0 ==> CALCULO V.R.
      *                         V.R. <> 0 ==> CALCULO V.P.
      *ISP TIENE PRIORIDAD EL VALOR PAGADO


      *ISP RENOVACIONES CON VALOR RENOVADO EN CERO
      *ISP CUANTO DEBO RENOVAR ?
       CON-VAL-CON-FLD-CAN.
      *ISP PARA UNA RENOVACION PARCIAL CON FORMA RENOVACION 'P' O 'I' O
      *ISP EXIGE VALOR RENOVADO
      *ISP MANEJO CODIGO DE CARGO
      *    DESPUES DEL MANEJO DE VALOR PAGADO
           IF CAN-SGV-TPAG IN CAN-FLD > ZEROES OR
              ( CAN-SGV-TPAG IN CAN-FLD = ZEROES AND
                WSS-IBLK-TPAG = 'N' )
      *
              IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'INDTCYAOBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
                   MOVE CAN-NUM-DOUT IN CAN-FLD TO CAN-NUM-DOUT IN CAN
                   MOVE CAN-NUM-MOUT IN CAN-FLD TO CAN-NUM-MOUT IN CAN
                   MOVE CAN-NUM-SOUT IN CAN-FLD TO CAN-NUM-SOUT IN CAN
                   MOVE CAN-NUM-AOUT IN CAN-FLD TO CAN-NUM-AOUT IN CAN
                   MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN
                   MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN
                   MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN
                   MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN
                   MOVE 'TAB'                   TO MSC-COD-SIST
                   MOVE 'TCYA'                  TO MSC-COD-TMSC IN MSC
                   MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC
                   PERFORM BUS-MSC
                   IF MSC-CIC-CMSC IN MSC = 'CAJA' AND
                      CAN-FEC-FOUT IN CAN NOT = CAN-FEC-FCAN IN CAN
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'CANOUTCANCJI' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO END-VAL-CON-FLD-CAN
                   ELSE
                   IF MSC-CIC-CMSC IN MSC = 'CC' AND
                      ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' )
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'OPCPRGACCTNO' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO END-VAL-CON-FLD-CAN
                   ELSE
                       NEXT SENTENCE
           ELSE
               IF CYA-IND-TCYA IN CAN-FLD > SPACES
                 MOVE 'COL'        TO MSG-COD-SIST
                 MOVE 'INDTCYABLK' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO END-VAL-CON-FLD-CAN.

           IF ( CYA-IND-TCYA IN CAN-FLD NOT > SPACES AND
                 ( CYA-CAI-ICYA IN CAN-FLD > SPACES OR
                   CYA-IIC-ICYA IN CAN-FLD > ZEROES ) )

                   MOVE 'COL'         TO MSG-COD-SIST
                   MOVE 'INDTCYAICYA' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.

           IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES
               GO TO FIN-VAL-ICYA.

           IF WSS-GLS-DAT1 NOT > SPACES
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD
               GO TO FIN-VAL-ICYA.

           IF CYA-IIC-ICYA IN CAN-FLD NOT > ZEROES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'IICICYACCOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-CON-FLD-CAN.
      *
           PERFORM GET-CLI-OPC.
           MOVE RDC-CIC-ICLI IN RDC TO RCO-CIC-ICLI IN RCO.
           MOVE CYA-CAI-ICYA IN CAN-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CYA-IIC-ICYA IN CAN-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               IF RCO-COD-STAT IN RCO = 'ELI'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CICICYACNVIG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
               IF WSS-GLS-DAT1 = 'O'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CICICYACSCLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
                   GO TO CER-VAL-CYA-CAI-ICYA.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE CYA-CAI-ICYA IN CAN-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CYA-IIC-ICYA IN CAN-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICICYACCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-CON-FLD-CAN
           ELSE
               IF RCO-COD-STAT IN RCO = 'ELI'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CICICYACNVIG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
               IF WSS-GLS-DAT1 = 'M'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CICICYACNCLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.
       CER-VAL-CYA-CAI-ICYA.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF OPE-FEC-FTOP IN OPE > ZEROES
               IF OPE-FEC-FTOP IN OPE > OPE-FEC-FROP IN OPE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'FECFTOPICYA>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.
       FIN-VAL-ICYA.

       END-VAL-CON-FLD-CAN.

      * SUMA LOS GASTOS
           IF SCR-MSC-TCAN = 'C'
                ADD CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-TPAG IN CAN-FLD
           ELSE
                ADD CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-TREN IN CAN-FLD.

           IF SCR-MSC-TCAN = 'N' OR
              SCR-MSC-TCAN = 'R'
                MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.

      *JSS 30-JUL-1991 17:03:45 para manejar 'ATT'
      *ISP PARA MONEDA NACIONAL SIEMPRE MUESTRA VALOR RENOVADO,
      *    VALOR PAGADO, DIFERENCIA Y GASTOS SIN DECIMALES
           IF WSS-CIC-TVAL = '0'
      *ALD
               MOVE CAN-SGV-DIFE IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-DIFE
                                                      IN CAN-FLD
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG
                                                      IN CAN-FLD
               MOVE CAN-SGV-TREN IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TREN
                                                      IN CAN-FLD.

           IF WSS-CIC-VCAM = '0999'
              MOVE RCV-SGV-CAPI IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-CAPI
                                                     IN CAN-FLD
              MOVE RCV-SGV-FINA IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-FINA
                                                      IN CAN-FLD
              MOVE VEN-VAL-SCAP IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-SCAP
                                                      IN CAN-FLD
               MOVE VEN-VAL-SFIN IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-SFIN
                                                      IN CAN-FLD.
           IF FRM-GLS-IITR IN CAN-FLD NOT = FRM-GLS-TINT IN CAN-FLD AND
              FRM-SUAR = FRM-SUAR-MAL
               PERFORM BASE-TASA-INI.

      *VALIDA EXISTENCIA DE INF.EN CAMPOS INFORMADOS CON PERDIDA
           IF NOT ( MSG-COD-MENS > SPACES OR
                    FRM-SUAR = FRM-SUAR-MAL )
                    PERFORM VAL-DAT-PREV-ING
                    IF MSG-COD-MENS > SPACES
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-FLD-CAN.
           EXIT.

       VAL-CON-CAN SECTION.
       INI-VAL-CON-CAN.
       FIN-VAL-CON-CAN.
           EXIT.

       VAL-NUM-KEY-CAN SECTION.
       INI-VAL-NUM-KEY-CAN.
           PERFORM VAL-NUM-IKY-CAN.
           PERFORM VAL-NUM-MKY-CAN.
           PERFORM VAL-NUM-AKY-CAN.
       FIN-VAL-NUM-KEY-CAN.
           EXIT.

       VAL-NUM-IKY-CAN SECTION.
       INI-VAL-NUM-IKY-CAN.
       VAL-NUM-CAN-IIC-IOPC.
           MOVE CAN-IIC-IOPC-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO CAN-IIC-IOPC IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CAN-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-IKY-CAN.
       VAL-NUM-VEN-NUM-IVCT.
           MOVE VEN-NUM-IVCT-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO VEN-NUM-IVCT IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO VEN-NUM-IVCT-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-IKY-CAN.
       VAL-NUM-VEN-NUM-IVEN.
           MOVE VEN-NUM-IVEN-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO VEN-NUM-IVEN IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO VEN-NUM-IVEN-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-IKY-CAN.
       FIN-VAL-NUM-IKY-CAN.
           EXIT.

       VAL-NUM-MKY-CAN SECTION.
       INI-VAL-NUM-MKY-CAN.
       FIN-VAL-NUM-MKY-CAN.
           EXIT.

       VAL-NUM-AKY-CAN SECTION.
       INI-VAL-NUM-AKY-CAN.
       VAL-NUM-CAN-NUM-ICAN.
           MOVE CAN-NUM-ICAN-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO CAN-NUM-ICAN IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CAN-NUM-ICAN-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-AKY-CAN.
       FIN-VAL-NUM-AKY-CAN.
           EXIT.

       VAL-NUM-FLD-CAN SECTION.
       INI-VAL-NUM-FLD-CAN.
      *<<<< INI_VAL_NUM_FLD_CAN
           IF CAN-SGV-TPAG-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TPAG
           ELSE
               MOVE 'N' TO WSS-IBLK-TPAG.
           IF ICG-SGV-TINT-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TINT
           ELSE
               MOVE 'N' TO WSS-IBLK-TINT.
      *>>>>
       VAL-NUM-DBC-NUM-ICLI.
       VAL-NUM-ROV-IIC-IOPC.
       VAL-NUM-FRM-SGV-TINT.
           MOVE FRM-SGV-TINT-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO FRM-SGV-TINT IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-ICG-SGV-TINT.
           MOVE ICG-SGV-TINT-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO ICG-SGV-TINT IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO ICG-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-SGV-GAST.
           MOVE CAN-SGV-GAST-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO CAN-SGV-GAST IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CAN-SGV-GAST-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-SGV-TREN.
           MOVE CAN-SGV-TREN-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO CAN-SGV-TREN IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CAN-SGV-TREN-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-SGV-TPAG.
           MOVE CAN-SGV-TPAG-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO CAN-SGV-TPAG IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CAN-SGV-TPAG-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-OPC-NUM-VCVG.
           MOVE OPC-NUM-VCVG-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO OPC-NUM-VCVG IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPC-NUM-VCVG-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CYA-IIC-ICYA.
           MOVE CYA-IIC-ICYA-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO CYA-IIC-ICYA IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CYA-IIC-ICYA-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-OPC-VAL-SCRE.
           MOVE OPC-VAL-SCRE-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO OPC-VAL-SCRE IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPC-VAL-SCRE-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-SGV-DIFE.
           MOVE CAN-SGV-DIFE-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO CAN-SGV-DIFE IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CAN-SGV-DIFE-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-VEN-VAL-SCAP.
           MOVE VEN-VAL-SCAP-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO VEN-VAL-SCAP IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO VEN-VAL-SCAP-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-RCV-SGV-CAPI.
           MOVE RCV-SGV-CAPI-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO RCV-SGV-CAPI IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO RCV-SGV-CAPI-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-VEN-VAL-SFIN.
           MOVE VEN-VAL-SFIN-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO VEN-VAL-SFIN IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO VEN-VAL-SFIN-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-RCV-SGV-FINA.
           MOVE RCV-SGV-FINA-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO RCV-SGV-FINA IN CAN-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO RCV-SGV-FINA-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       FIN-VAL-NUM-FLD-CAN.
           EXIT.

       EDT-KEY-CAN SECTION.
       INI-EDT-KEY-CAN.
           PERFORM EDT-IKY-CAN.
           PERFORM EDT-MKY-CAN.
           PERFORM EDT-AKY-CAN.
       FIN-EDT-KEY-CAN.
           EXIT.

       EDT-IKY-CAN SECTION.
       INI-EDT-IKY-CAN.
           IF CAN-IIC-IOPC-LEN IN CAN-FLD = -9
                MOVE -1 TO CAN-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-EDT-IKY-CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC-EDT IN CAN-EDT.
           MOVE CAN-IIC-IOPC-EDT IN CAN-EDT TO
                CAN-IIC-IOPC-ALF IN CAN-FLD.
           IF VEN-NUM-IVCT-LEN IN CAN-FLD = -9
                MOVE -1 TO VEN-NUM-IVCT-LEN IN CAN-FLD
                GO TO FIN-EDT-IKY-CAN.
           MOVE VEN-NUM-IVCT IN CAN-FLD TO VEN-NUM-IVCT-EDT IN CAN-EDT.
           MOVE VEN-NUM-IVCT-EDT IN CAN-EDT TO
                VEN-NUM-IVCT-ALF IN CAN-FLD.
           IF VEN-NUM-IVEN-LEN IN CAN-FLD = -9
                MOVE -1 TO VEN-NUM-IVEN-LEN IN CAN-FLD
                GO TO FIN-EDT-IKY-CAN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN-EDT IN CAN-EDT.
           MOVE VEN-NUM-IVEN-EDT IN CAN-EDT TO
                VEN-NUM-IVEN-ALF IN CAN-FLD.
       FIN-EDT-IKY-CAN.
           EXIT.

       EDT-MKY-CAN SECTION.
       INI-EDT-MKY-CAN.
       FIN-EDT-MKY-CAN.
           EXIT.

       EDT-AKY-CAN SECTION.
       INI-EDT-AKY-CAN.
           IF CAN-NUM-ICAN-LEN IN CAN-FLD = -9
                MOVE -1 TO CAN-NUM-ICAN-LEN IN CAN-FLD
                GO TO FIN-EDT-AKY-CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN-EDT IN CAN-EDT.
           MOVE CAN-NUM-ICAN-EDT IN CAN-EDT TO
                CAN-NUM-ICAN-ALF IN CAN-FLD.
       FIN-EDT-AKY-CAN.
           EXIT.

       EDT-FLD-CAN SECTION.
       INI-EDT-FLD-CAN.
           IF DBC-NUM-ICLI-LEN IN CAN-FLD = -9
                MOVE -1 TO DBC-NUM-ICLI-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE DBC-NUM-ICLI IN CAN-FLD TO DBC-NUM-ICLI-EDT IN CAN-EDT.
           MOVE DBC-NUM-ICLI-EDT IN CAN-EDT TO
                DBC-NUM-ICLI-ALF IN CAN-FLD.
           IF ROV-IIC-IOPC-LEN IN CAN-FLD = -9
                MOVE -1 TO ROV-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE ROV-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPC-EDT IN CAN-EDT.
           MOVE ROV-IIC-IOPC-EDT IN CAN-EDT TO
                ROV-IIC-IOPC-ALF IN CAN-FLD.
           IF FRM-SGV-TINT-LEN IN CAN-FLD = -9
                MOVE -1 TO FRM-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE FRM-SGV-TINT IN CAN-FLD TO FRM-SGV-TINT-EDT IN CAN-EDT.
           MOVE FRM-SGV-TINT-EDT IN CAN-EDT TO
                FRM-SGV-TINT-ALF IN CAN-FLD.
           IF ICG-SGV-TINT-LEN IN CAN-FLD = -9
                MOVE -1 TO ICG-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           IF WSS-IBLK-TINT = 'N'
           MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT-EDT1 IN CAN-EDT
           MOVE ICG-SGV-TINT-EDT1 IN CAN-EDT TO
                ICG-SGV-TINT-ALF IN CAN-FLD
           ELSE
           MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT-EDT IN CAN-EDT
           MOVE ICG-SGV-TINT-EDT IN CAN-EDT TO
                ICG-SGV-TINT-ALF IN CAN-FLD.
           IF CAN-SGV-GAST-LEN IN CAN-FLD = -9
                MOVE -1 TO CAN-SGV-GAST-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-GAST-EDT IN CAN-EDT.
           MOVE CAN-SGV-GAST-EDT IN CAN-EDT TO
                CAN-SGV-GAST-ALF IN CAN-FLD.
           IF CAN-SGV-TREN-LEN IN CAN-FLD = -9
                MOVE -1 TO CAN-SGV-TREN-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CAN-SGV-TREN IN CAN-FLD TO CAN-SGV-TREN-EDT IN CAN-EDT.
           MOVE CAN-SGV-TREN-EDT IN CAN-EDT TO
                CAN-SGV-TREN-ALF IN CAN-FLD.
           IF CAN-SGV-TPAG-LEN IN CAN-FLD = -9
                MOVE -1 TO CAN-SGV-TPAG-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           IF WSS-IBLK-TPAG = 'N'
           MOVE CAN-SGV-TPAG IN CAN-FLD TO CAN-SGV-TPAG-EDT1 IN CAN-EDT
           MOVE CAN-SGV-TPAG-EDT1 IN CAN-EDT TO
                CAN-SGV-TPAG-ALF IN CAN-FLD
           ELSE
           MOVE CAN-SGV-TPAG IN CAN-FLD TO CAN-SGV-TPAG-EDT IN CAN-EDT
           MOVE CAN-SGV-TPAG-EDT IN CAN-EDT TO
                CAN-SGV-TPAG-ALF IN CAN-FLD.
           IF OPC-NUM-VCVG-LEN IN CAN-FLD = -9
                MOVE -1 TO OPC-NUM-VCVG-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE OPC-NUM-VCVG IN CAN-FLD TO OPC-NUM-VCVG-EDT IN CAN-EDT.
           MOVE OPC-NUM-VCVG-EDT IN CAN-EDT TO
                OPC-NUM-VCVG-ALF IN CAN-FLD.
           IF CYA-IIC-ICYA-LEN IN CAN-FLD = -9
                MOVE -1 TO CYA-IIC-ICYA-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CYA-IIC-ICYA IN CAN-FLD TO CYA-IIC-ICYA-EDT IN CAN-EDT.
           MOVE CYA-IIC-ICYA-EDT IN CAN-EDT TO
                CYA-IIC-ICYA-ALF IN CAN-FLD.
           IF OPC-VAL-SCRE-LEN IN CAN-FLD = -9
                MOVE -1 TO OPC-VAL-SCRE-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE OPC-VAL-SCRE IN CAN-FLD TO OPC-VAL-SCRE-EDT IN CAN-EDT.
           MOVE OPC-VAL-SCRE-EDT IN CAN-EDT TO
                OPC-VAL-SCRE-ALF IN CAN-FLD.
           IF CAN-SGV-DIFE-LEN IN CAN-FLD = -9
                MOVE -1 TO CAN-SGV-DIFE-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CAN-SGV-DIFE IN CAN-FLD TO CAN-SGV-DIFE-EDT IN CAN-EDT.
           MOVE CAN-SGV-DIFE-EDT IN CAN-EDT TO
                CAN-SGV-DIFE-ALF IN CAN-FLD.
           IF VEN-VAL-SCAP-LEN IN CAN-FLD = -9
                MOVE -1 TO VEN-VAL-SCAP-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE VEN-VAL-SCAP IN CAN-FLD TO VEN-VAL-SCAP-EDT IN CAN-EDT.
           MOVE VEN-VAL-SCAP-EDT IN CAN-EDT TO
                VEN-VAL-SCAP-ALF IN CAN-FLD.
           IF RCV-SGV-CAPI-LEN IN CAN-FLD = -9
                MOVE -1 TO RCV-SGV-CAPI-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE RCV-SGV-CAPI IN CAN-FLD TO RCV-SGV-CAPI-EDT IN CAN-EDT.
           MOVE RCV-SGV-CAPI-EDT IN CAN-EDT TO
                RCV-SGV-CAPI-ALF IN CAN-FLD.
           IF VEN-VAL-SFIN-LEN IN CAN-FLD = -9
                MOVE -1 TO VEN-VAL-SFIN-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE VEN-VAL-SFIN IN CAN-FLD TO VEN-VAL-SFIN-EDT IN CAN-EDT.
           MOVE VEN-VAL-SFIN-EDT IN CAN-EDT TO
                VEN-VAL-SFIN-ALF IN CAN-FLD.
           IF RCV-SGV-FINA-LEN IN CAN-FLD = -9
                MOVE -1 TO RCV-SGV-FINA-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE RCV-SGV-FINA IN CAN-FLD TO RCV-SGV-FINA-EDT IN CAN-EDT.
           MOVE RCV-SGV-FINA-EDT IN CAN-EDT TO
                RCV-SGV-FINA-ALF IN CAN-FLD.
       FIN-EDT-FLD-CAN.
           EXIT.
      *<<<< EOF
      *DAD ini  12-NOV-1992
       BASE-TASA-INI SECTION.
       INI-BASE-TASA-INI.
           MOVE ZEROES                  TO ICG-SGV-TINT-ALF IN CAN-FLD.
           MOVE SPACES                  TO FRM-IND-TIPE     IN CAN-FLD
                                           WSS-IBLK-TINT.
           MOVE FRM-GLS-IITR IN CAN-FLD TO FRM-GLS-TINT IN CAN-FLD.
       FIN-BASE-TASA-INI.
           EXIT.
      * ALD-FIN-CST**** RESTAURAR PARA PRUEBAS EN REALIA
        FIN-VAL-CON-ROV.
           EXIT.

       GET-SLD SECTION.
       INI-GET-SLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           IF SCR-MSC-ECAN = 'T' AND
              OPC-NUM-VCOR IN OPC > 1
               MOVE OPC-VAL-SCRE IN CAN-FLD TO WSS-VAL-SCAP
               ADD VEN-VAL-SFIN IN CAN-FLD OPC-VAL-SCRE IN CAN-FLD
                   GIVING WSS-VAL-SVEN
               SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM WSS-VAL-SVEN
           ELSE
               MOVE VEN-VAL-SCAP IN CAN-FLD TO WSS-VAL-SCAP
               MOVE VEN-VAL-SFIN IN CAN-FLD TO WSS-VAL-SVEN.

           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.

           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
                MOVE VEN-VAL-SCAP IN CAN-FLD TO
                     RCV-SGV-CAPI IN CAN-FLD
                MOVE VEN-VAL-SFIN IN CAN-FLD TO
                     RCV-SGV-FINA IN CAN-FLD
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
               IF OPC-NUM-VCOR IN OPC = 1
                   MOVE VEN-VAL-SCAP IN CAN-FLD TO
                        RCV-SGV-CAPI IN CAN-FLD
                   MOVE VEN-VAL-SFIN IN CAN-FLD TO
                     RCV-SGV-FINA IN CAN-FLD
               ELSE
                   MOVE OPC-VAL-SCRE IN CAN-FLD TO
                        RCV-SGV-CAPI IN CAN-FLD
                   MOVE WSS-VAL-SVEN TO
                        RCV-SGV-FINA IN CAN-FLD.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'        TO TAB-COD-SIST.
           MOVE 'VLR'        TO TAB-COD-TTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-GET-SLD.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.

      *ISP SI ES MONEDA REAJUSTABLE ( CHILENA Y NO PESOS ) ENTONCES
      *    CONVIERTE A PESOS

           MOVE 1 TO SCR-SGV-VCAM.
           IF NOT ( WSS-CIC-TVAL = '0' AND
                    WSS-CIC-VCAM NOT = '0999' )
               GO TO VRF-MON-NAC.

           MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TAB-NUM-DTRN IN TAB.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TAB-NUM-MTRN IN TAB.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO TAB-NUM-STRN IN TAB.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MOVE CAM-SGV-VCAM IN CAM TO SCR-SGV-VCAM

               MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                                 GIVING WSS-VAL-SVEN ROUNDED

               MULTIPLY WSS-VAL-SCAP BY SCR-SGV-VCAM
                                 GIVING WSS-VAL-SCAP ROUNDED
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       VRF-MON-NAC.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN
               MOVE WSS-VAL-SCAP TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SCAP.
       FIN-GET-SLD.
           EXIT.

       ABS-TPAG SECTION.
       INI-ABS-TPAG.
           MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-SGV-TPAG.
           IF WSS-SGV-TPAG < ZEROES
               SUBTRACT WSS-SGV-TPAG FROM 0 GIVING WSS-SGV-TPAG.
       FIN-ABS-TPAG.
           EXIT.

       LEE-REG-TCAN SECTION.
       INI-LEE-REG-TCAN.
           IF VEN-NUM-IVEN IN CAN-FLD = 1
               MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DVEN IN WSS-VARI
               MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MVEN IN WSS-VARI
               MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SVEN IN WSS-VARI
               MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AVEN IN WSS-VARI
               GO TO CON-LEE-REG-TCAN.
      *
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           SUBTRACT 1 FROM VEN-NUM-IVEN IN CAN-FLD GIVING
                                           VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-AVEN IN WSS-VARI
               ELSE
                   MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AVEN IN WSS-VARI
           ELSE
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-AVEN IN WSS-VARI
               ELSE
                   MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AVEN IN WSS-VARI.
       CON-LEE-REG-TCAN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
           ELSE
               PERFORM COL-FIO-VEN.

           MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN     TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.

           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           PERFORM GET-CUR-ITR.
           IF PGM-STAT-ITR-OKS
               PERFORM GET-NXT-ITR.
       FIN-LEE-REG-TCAN.
           EXIT.

       PRO-TCAN-CTE SECTION.
       INI-PRO-TCAN-CTE.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.

           IF WSS-OPEC = 'D'
              PERFORM CAL-NUM-DHBL
              IF CAN-FEC-FCAN IN CAN > WSS-FEC-FTOP IN WSS-VARI
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
                  MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI
                  MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI
                  MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI
                  MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal.
                  MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN
                  MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN
                  MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN
                  MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN
                  PERFORM PRO-MORA-CTE
                  MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN
                  MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN
                  MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN
                  MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN
                  GO TO FIN-PRO-TCAN-CTE
              ELSE
                 IF CAN-FEC-FCAN IN CAN NOT > WSS-FEC-FTOP IN WSS-VARI
                    PERFORM PRO-DESC-CTE
                    GO TO FIN-PRO-TCAN-CTE.
           IF OPC-NUM-VCOR IN OPC = 1
               IF CAN-FEC-FCAN IN CAN > VEN-FEC-FIMV IN VEN
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
                  MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI
                  MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI
                  MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI
                  MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal.
                  MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN
                  MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN
                  MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN
                  MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN
                  PERFORM PRO-MORA-CTE
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
                  MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN
                  MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN
                  MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN
                  MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN
                  GO TO FIN-PRO-TCAN-CTE
               ELSE
               IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN
                   PERFORM PRO-DESC-CTE
                   GO TO FIN-PRO-TCAN-CTE.
           IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN
               PERFORM PRO-MORA-CTE
           ELSE
           IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FVEN IN VEN
               PERFORM PRO-DESC-CTE.
       FIN-PRO-TCAN-CTE.
           EXIT.

       PRO-MORA-CTE SECTION.
       INI-PRO-MORA-CTE.
           IF VEN-IND-CALC IN VEN = 'N'
               MOVE 'VENCALCMORAN' TO MSG-COD-MENS
               MOVE VEN-NUM-IVEN IN VEN TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-CTE.
           MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SMON.
           PERFORM PRO-FUPM.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    DPTMC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               PERFORM PRO-MORA-TXC
           ELSE
           IF CAN-FEC-FCAN IN CAN     > VEN-FEC-FVEN IN VEN AND
              CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN
               PERFORM VAL-TMAX-CONV
           ELSE
               PERFORM PRO-MORA-TMC.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CTE.
           IF WSS-IBLK-TINT = 'S'
               GO TO CON-PRO-CTE-TIPE.
           IF ICG-SGV-TINT IN CAN-FLD NOT > ZEROES
               MOVE 0 TO INT-TIPE
               GO TO CON-PRO-CTE-TIPE.
       CON-PRO-MORA-CTE.
           MOVE WSS-DIAM                TO INT-SEPA INT-SEPD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE SPACES TO INT-CVTI.
      *
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-CTE.
       CON-PRO-CTE-TIPE.
           MOVE WSS-VAL-SMON TO WSS-VAL-SCRE.
           MULTIPLY INT-TIPE BY WSS-VAL-SCRE
                         GIVING WSS-VAL-SVEN.
           COMPUTE SCR-SGV-INMO = VEN-VAL-SFIN IN VEN -
                                  VEN-VAL-SCAP IN VEN.
           MOVE WSS-VAL-SVEN TO SCR-SGV-IMMO.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM GIVING SCR-SGV-INTM.
           ADD WSS-VAL-SCRE TO WSS-VAL-SVEN.
      *
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT VEN-VAL-SCAP IN VEN FROM SCR-SGV-IPFC.

           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INT.
           SUBTRACT SCR-SGV-INTM FROM SCR-SGV-INT GIVING SCR-SGV-INTN.
           IF SCR-SGV-INTN > -1 AND
              SCR-SGV-INTN < 1
              MOVE ZEROES TO SCR-SGV-INTN.

           IF WSS-CIC-TVAL = '0'
              MOVE SCR-SGV-INTM TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTM
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN.
      *
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-MORA-CTE.
           EXIT.

       PRO-MORA-TMC SECTION.
       INI-PRO-MORA-TMC.
           PERFORM BUS-CIC-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-TMC.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TMC-NUM-DTMC IN TMC.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TMC-NUM-MTMC IN TMC.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TMC-NUM-ATMC IN TMC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TMC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'TASDNEXFCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           IF WSS-CIC-VCAM = '0998'
               MOVE TMC-SGV-UFAC IN TMC TO WSS-SGV-CANT
           ELSE
           IF WSS-PLZO-B90
               MOVE TMC-SGV-89AC IN TMC TO WSS-SGV-CANT
           ELSE
               MOVE TMC-SGV-PEAC IN TMC TO WSS-SGV-CANT.

           MOVE WSS-NUM-DUPM IN WSS-VARI TO TMC-NUM-DTMC IN TMC.
           MOVE WSS-NUM-MUPM IN WSS-VARI TO TMC-NUM-MTMC IN TMC.
           MOVE WSS-NUM-AUPM IN WSS-VARI TO TMC-NUM-ATMC IN TMC.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TMC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'TASDNEXFVEN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           IF WSS-CIC-VCAM = '0998'
               MOVE TMC-SGV-UFAC IN TMC TO WSS-SGV-VENT
           ELSE
           IF WSS-PLZO-B90
               MOVE TMC-SGV-89AC IN TMC TO WSS-SGV-VENT
           ELSE
               MOVE TMC-SGV-PEAC IN TMC TO WSS-SGV-VENT.
           SUBTRACT WSS-SGV-VENT FROM WSS-SGV-CANT GIVING
                    WSS-SGV-MTMC.
           DIVIDE WSS-SGV-MTMC BY 36000 GIVING
                  WSS-INT-TIPE ROUNDED.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1'          TO FRM-IND-TIPE IN CAN-FLD
               MOVE WSS-INT-TIPE TO INT-TIPE
               MULTIPLY WSS-INT-TIPE BY 100 GIVING ICG-SGV-TINT
                                             IN CAN-FLD
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               PERFORM GLS-INT-TIPE
               GO TO FIN-PRO-MORA-TMC.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               MOVE 'S' TO WSS-IBLK-TINT
               PERFORM GLS-INT-TIPE
               GO TO CMP-INT-TIPE.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE SPACES TO INT-CVTI.
      *
      *DAD ini  27-NOV-1991   (Memo.15-11-91 pto.3.2)
      *    Cambio  OPC-NUM-xCOL IN OPC  x  WSS-NUM-xUPM  --->  INT-xDMA
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
       CMP-INT-TIPE.
           IF INT-TIPE > WSS-INT-TIPE
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'CANTIPE>TMC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR.
       FIN-PRO-MORA-TMC.
           EXIT.

       PRO-DESC-CTE SECTION.
       INI-PRO-DESC-CTE.
           IF OPC-NUM-VCOR IN OPC = 1
               PERFORM PRO-DESC-CTE-1VCTO
               GO TO FIN-PRO-DESC-CTE.
           PERFORM CAL-TFPR-CAN.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CTE.
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
               MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SVEN
               GO TO NXT-PRO-DESC-CTE.
      *
           MOVE VEN-VAL-SFIN IN VEN     TO WSS-VAL-SMON.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           PERFORM CAL-TIPE-DESC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CTE.
           ADD 1 TO INT-TIPE.
           DIVIDE WSS-VAL-SMON BY INT-TIPE
                           GIVING WSS-VAL-SVEN.
           IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD AND
              OPC-NUM-VCVG IN OPC = 1                           AND
              WSS-CMP-FCAN IN WSS-VARI NOT > DLC-FEC-FDEV IN DLC
               IF WSS-OPEC = 'B'
                   MOVE ZEROES TO VEN-VAL-SCAP IN VEN
                                  WSS-VAL-SVEN IN WSS-VARI
               ELSE
                   MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SVEN.
       NXT-PRO-DESC-CTE.
      *
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT VEN-VAL-SCAP IN VEN FROM SCR-SGV-IPFC.

           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.
           IF SCR-SGV-INTN > -1 AND
              SCR-SGV-INTN < 1
              MOVE ZEROES TO SCR-SGV-INTN.

           IF WSS-CIC-TVAL = '0'
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN
              MOVE ZEROES TO SCR-SGV-INTM
              MOVE ZEROES TO SCR-SGV-INT.
      *
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-DESC-CTE.
           EXIT.


      *Obtiene la suma de los SCAP y SFIN desdes VEN actual hasta el ult
      *completando aquellos incompletos
       OBT-RCV-FINA SECTION.
       INI-OBT-RCV-FINA.
           PERFORM LEE-REG-TCAN.
      *
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
           MOVE 0 TO WSS-IVEZ.
       LUP-OBT-RCV-FINA.
           PERFORM CAL-TFPR-CAN.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-OBT-RCV-FINA.
      *Si es la primera vez inicializa acumuladores con dicho VEN,
      *en caso contrario acumula los VEN siguientes en los RCV
           IF WSS-IVEZ = 0
               MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD
               MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD
               MOVE 1 TO WSS-IVEZ
           ELSE
               ADD  VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               ADD  VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD.
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM OPC-VAL-SCRE IN OPC
                    GIVING WSS-VAL-SCRE IN WSS-VARI.
      *
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE CAN-NUM-DCAN IN CAN-FLD TO VEN-DTBS
               MOVE CAN-NUM-MCAN IN CAN-FLD TO VEN-MTBS
               MOVE CAN-NUM-SCAN IN CAN-FLD TO VEN-STBS
               MOVE CAN-NUM-ACAN IN CAN-FLD TO VEN-ATBS
               PERFORM COL-OBT-VEN
               IF VEN-STAT-EOF
                   GO TO FIN-OBT-RCV-FINA
               ELSE
               IF NOT VEN-STAT-OKS
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE VEN-STAT     TO MSG-COD-MENS
                       MOVE VEN-MEN2     TO FRM-MEN2
                       GO TO FIN-OBT-RCV-FINA
                   ELSE
                       GO TO FIN-OBT-RCV-FINA
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-OBT-RCV-FINA.
           GO TO LUP-OBT-RCV-FINA.
       FIN-OBT-RCV-FINA.
           EXIT.

       BUS-IDNI-VEN-ANT SECTION.
       INI-BUS-IDNI-VEN-ANT.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
           IF VEN-NUM-IVEN IN VEN = 1
               MOVE ZEROES TO WSS-VAL-IDNI
               GO TO FIN-BUS-IDNI-VEN-ANT.
      *
           SUBTRACT 1 FROM VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
               ELSE
                   MOVE ZEROES              TO WSS-VAL-IDNI
           ELSE
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
               ELSE
                   MOVE ZEROES              TO WSS-VAL-IDNI.
      *Para restaurar VEN actual
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
           ELSE
               PERFORM COL-FIO-VEN.
       FIN-BUS-IDNI-VEN-ANT.
           EXIT.

       PRO-DESC-CTT-TADI SECTION.
       INI-PRO-DESC-CTT-TADI.
           PERFORM LEE-REG-TCAN.
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
           MOVE 0 TO WSS-IVEZ.
       LUP-PRO-DESC-CTT-TADI.
           PERFORM PRO-DESC-CTE.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-DESC-CTT-TADI.
      *Si es la primera vez, debe mostrar en pantalla el VEN
      *actual, inicializar acumuladores con dicho VEN e inicializar el
      *valor pagado de la cuota, en caso contrario
      *acumula los VEN siguientes en los RCV y el valor pagado
           IF WSS-IVEZ = 0
               MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD
               MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD
               MOVE WSS-VAL-SMON IN WSS-VARI TO
                    WSS-TOT-SVEN IN WSS-VARI
               MOVE 1 TO WSS-IVEZ
           ELSE
               ADD  VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               ADD  VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD
               ADD  WSS-VAL-SMON IN WSS-VARI TO
                    WSS-TOT-SVEN IN WSS-VARI.
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM OPC-VAL-SCRE IN OPC
                    GIVING WSS-VAL-SCRE IN WSS-VARI.
      *
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE CAN-NUM-DCAN IN CAN-FLD TO VEN-DTBS
               MOVE CAN-NUM-MCAN IN CAN-FLD TO VEN-MTBS
               MOVE CAN-NUM-SCAN IN CAN-FLD TO VEN-STBS
               MOVE CAN-NUM-ACAN IN CAN-FLD TO VEN-ATBS
               PERFORM COL-OBT-VEN
               IF VEN-STAT-EOF
                   GO TO NXT-PRO-DESC-CTT-TADI
               ELSE
               IF NOT VEN-STAT-OKS
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE VEN-STAT     TO MSG-COD-MENS
                       MOVE VEN-MEN2     TO FRM-MEN2
                       GO TO FIN-PRO-DESC-CTT-TADI
                   ELSE
                       GO TO NXT-PRO-DESC-CTT-TADI
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO NXT-PRO-DESC-CTT-TADI.
           GO TO LUP-PRO-DESC-CTT-TADI.
       NXT-PRO-DESC-CTT-TADI.
           MOVE WSS-TOT-SVEN IN WSS-VARI TO WSS-VAL-SVEN IN WSS-VARI.
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-DESC-CTT-TADI.
           EXIT.

       CAL-TIPE SECTION.
       INI-CAL-TIPE.
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           MOVE FEC-FEC1                TO INT-FUNO.
           MOVE FEC-FEC2                TO INT-FDOS.
           MOVE OPC-NUM-DCOL IN OPC     TO INT-DCOL.
           MOVE OPC-NUM-MCOL IN OPC     TO INT-MCOL.
           MOVE OPC-NUM-SCOL IN OPC     TO INT-SCOL.
           MOVE OPC-NUM-ACOL IN OPC     TO INT-ACOL.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DBTV.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MBTV.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SBTV.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ABTV.
      *JSS uso de spread para calculo 1ra cuota (Memo.13/05/92)
           IF WSS-IND-SPR2 = 'S' AND
              VEN-NUM-IVCT IN VEN = 1 AND
              INT-CVTI > SPACES AND INT-TFPR = 'C' AND
              SCR-SGV-SPR2 > 0
               MOVE 'COL'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE 'VSNLIQTMXCBCI' TO TAB-COD-TABL IN TAB
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                   MOVE SCR-SGV-SPR2 TO INT-SPR2.
           MOVE SPACES TO WSS-IND-SPR2.
      *
      *SMC-INI 09.09.1993
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC
      *     PERFORM GNS-CAL-INT.
           PERFORM COL-CAL-INT.
      *SMC-FIN 09.09.1993
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR.
       FIN-CAL-TIPE.
           EXIT.

       CAL-TIPE-DESC SECTION.
       INI-CAL-TIPE-DESC.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DDMA INT-DBTV.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MDMA INT-MBTV.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SDMA INT-SBTV.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ADMA INT-ABTV.
           MOVE OPC-COD-VCOC IN OPC TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR.
       FIN-CAL-TIPE-DESC.
           EXIT.




       PRO-FUPM SECTION.
       INI-PRO-FUPM.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC1 WSS-NUM-DUPM.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC1 WSS-NUM-MUPM.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC1 WSS-NUM-SUPM.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC1 WSS-NUM-AUPM.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO RCV-CAI-IOPV IN RCV.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO RCV-IIC-IOPV IN RCV.
           MOVE VEN-NUM-IVCT IN VEN     TO RCV-NUM-IVCT IN RCV.
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT (FIO-STAT-OKS AND
              CAN-CAI-IOPC IN CAN-FLD = RCV-CAI-IOPV IN RCV AND
              CAN-IIC-IOPC IN CAN-FLD = RCV-IIC-IOPV IN RCV AND
              VEN-NUM-IVCT IN VEN     = RCV-NUM-IVCT IN RCV )
               GO TO EXT-PRO-FUPM.
           MOVE 1 TO WSS-NUM-ICAN IN WSS-VARI.
       LUP-PRO-FUPM.
           MOVE RCV-KEY-ICAN TO CAN-KEY-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF CAN-MSC-FCAN IN CAN = 'P'
               GO TO NXT-PRO-FUPM.
           IF CAN-MSC-STAT IN CAN NOT = 'R' AND
              CAN-SGV-TPAG IN CAN NOT < ZEROES AND
              CAN-SGV-TREN IN CAN NOT < ZEROES AND
              CAN-FEC-FCAN IN CAN >     VEN-FEC-FVEN IN VEN      AND
              CAN-FEC-FCAN IN CAN >     WSS-FEC-FUPM IN WSS-VARI AND
              CAN-NUM-ICAN IN CAN NOT = CAN-NUM-ICAN IN CAN-FLD
               MOVE CAN-NUM-DCAN IN CAN TO FEC-DEC1 WSS-NUM-DUPM
               MOVE CAN-NUM-MCAN IN CAN TO FEC-MEC1 WSS-NUM-MUPM
               MOVE CAN-NUM-SCAN IN CAN TO FEC-SEC1 WSS-NUM-SUPM
               MOVE CAN-NUM-ACAN IN CAN TO FEC-AEC1 WSS-NUM-AUPM.
       NXT-PRO-FUPM.
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT (FIO-STAT-OKS AND
              CAN-CAI-IOPC IN CAN-FLD = RCV-CAI-IOPV IN RCV AND
              CAN-IIC-IOPC IN CAN-FLD = RCV-IIC-IOPV IN RCV AND
              VEN-NUM-IVCT IN VEN     = RCV-NUM-IVCT IN RCV )
               GO TO EXT-PRO-FUPM.
           GO TO LUP-PRO-FUPM.
       EXT-PRO-FUPM.
           PERFORM RET-CAN-CAN.
       FIN-PRO-FUPM.
           EXIT.

       BUS-SIG-VEN SECTION.
       INI-BUS-SIG-VEN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
       LUP-BUS-SIG-VEN.
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   NEXT SENTENCE
               ELSE
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE VEN-STAT     TO MSG-COD-MENS
                       MOVE VEN-MEN2     TO FRM-MEN2
                       GO TO FIN-BUS-SIG-VEN
                   ELSE
                       GO TO FIN-BUS-SIG-VEN
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-BUS-SIG-VEN.
           IF VEN-FEC-FVEN IN VEN > CAN-FEC-FCAN IN CAN
               MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD
               MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD
               MOVE 'EXTVENSGNCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-BUS-SIG-VEN.
           GO TO LUP-BUS-SIG-VEN.
       FIN-BUS-SIG-VEN.
           EXIT.

      ******************************************************************

       BUS-ANT-VEN SECTION.
      *********************
       INI-BUS-ANT-VEN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
       LUP-BUS-ANT-VEN.
           SUBTRACT 1 FROM VEN-NUM-IVEN IN VEN.
           IF VEN-NUM-IVEN IN VEN NOT > ZEROES
               GO TO FIN-BUS-ANT-VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE 1 TO VEN-NUM-IVEN IN VEN
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS AND
                  VEN-NUM-IVCT IN VEN NOT < VEN-NUM-IVEN IN CAN-FLD
                   GO TO FIN-BUS-ANT-VEN
               ELSE
                   MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD
                   MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD
                   MOVE 'EXTVENANNCAN' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-BUS-ANT-VEN
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-BUS-ANT-VEN.
           IF VEN-VAL-SFIN IN VEN > ZEROES
               MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD
               MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD
               MOVE 'EXTVENANNCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-BUS-ANT-VEN.
           GO TO LUP-BUS-ANT-VEN.
       FIN-BUS-ANT-VEN.
           EXIT.

      ******************************************************************

       PRO-DESC-CTE-1VCTO SECTION.
      ****************************
       INI-PRO-DESC-CTE-1VCTO.
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI.
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal.
           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN.

           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
           PERFORM CAL-TFPR-CAN.
           IF INT-CMSG > SPACES
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-DESC-CTE-VENCT.
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
      *
               MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SVEN
               GO TO NXT-PRO-DESC-CTE-1VCTO.
           IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD  AND
              OPC-NUM-VCVG IN OPC = 1                            AND
              WSS-CMP-FCAN IN WSS-VARI NOT > DLC-FEC-FDEV IN DLC AND
              WSS-OPEC = 'B'
               MOVE ZEROES TO VEN-VAL-SCAP IN VEN
                              WSS-VAL-SVEN IN WSS-VARI
               GO TO NXT-PRO-DESC-CTE-1VCTO.
           PERFORM PRO-UVCT-DVEG.
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2
               MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2
               MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2
               MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2
           ELSE
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
      *
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CTE-VENCT.
      *( UN CTT DESC, TASAS IGUALES, OPEC='B', N
      *llama a procesar a este parrafo 1 sola vez, por lo tanto ...
           IF WSS-OPEC = 'B'
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE
               GIVING   WSS-VAL-SMO1
           ELSE
               MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE
                 GIVING WSS-VAL-SMO1.
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               GO TO CON-PRO-DESC-CTE-1VCTO.
      *
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           PERFORM CAL-TIPE-DESC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CTE-VENCT.
      *JSS 6-JUN-1991 20:57:09 ( un ctt DESC, tasas iguales, opec='B', n
      *llama a procesar a este parrafo 1 sola vez, por lo tanto ...
           IF WSS-OPEC = 'B'
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE
                 GIVING WSS-VAL-SMO2
           ELSE
               MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE
                 GIVING WSS-VAL-SMO2.
           SUBTRACT WSS-VAL-SMO2 FROM WSS-VAL-SMO1 GIVING WSS-VAL-SMO1.
       CON-PRO-DESC-CTE-1VCTO.
           IF WSS-OPEC = 'B'
               MOVE WSS-VAL-SMO1 TO WSS-VAL-SVEN
           ELSE
               ADD VEN-VAL-SCAP IN CAN-FLD  WSS-VAL-SMO1  GIVING
                                                          WSS-VAL-SVEN.
       NXT-PRO-DESC-CTE-1VCTO.
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT VEN-VAL-SCAP IN VEN FROM SCR-SGV-IPFC.

           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.
           IF SCR-SGV-INTN > -1 AND
              SCR-SGV-INTN < 1
              MOVE ZEROES TO SCR-SGV-INTN.

           IF WSS-CIC-TVAL = '0'
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN
              MOVE ZEROES TO SCR-SGV-INTM
              MOVE ZEROES TO SCR-SGV-INT.
      *
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
      *  ESTE LAVEL PARA EVITAR EL PROBLEMA DEL E
       FIN-PRO-DESC-CTE-VENCT.
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN.
           MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN.
       FIN-PRO-DESC-CTE-1VCTO.
           EXIT.

      ******************************************************************

       PRO-UVCT-DVEG SECTION.
      ***********************
       INI-PRO-UVCT-DVEG.
           MOVE DLC-NUM-DDEV IN DLC TO FEC-DEC1.
           MOVE DLC-NUM-MDEV IN DLC TO FEC-MEC1.
           MOVE DLC-NUM-SDEV IN DLC TO FEC-SEC1.
           MOVE DLC-NUM-ADEV IN DLC TO FEC-AEC1.
       FIN-PRO-UVCT-DVEG.
           EXIT.

      ******************************************************************

       PRO-DESC-CIE-1VCTO SECTION.
      ****************************

       INI-PRO-DESC-CIE-1VCTO.
      * RBG/INI/7-AUG-1996
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI.
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal.
           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN.

           PERFORM PRO-UVCT-DVEG.
           IF ICG-SGV-TINT IN CAN-FLD > ZEROES
              AND DLC-FEC-FDEV IN DLC > CAN-FEC-FCAN IN CAN
                  MOVE 'TASDESC>0'  TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-PRO-DESC-CIE-VENCT.
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2
               MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2
               MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2
               MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2
           ELSE
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
      *
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CIE-VENCT.
           MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE
                                        GIVING WSS-VAL-SMO1.
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               GO TO CON-PRO-DESC-CIE-1VCTO.
      *
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
                  GO TO CON-PRO-DESC-CIE-1VCTO.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           PERFORM CAL-TIPE-DESC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CIE-VENCT.
           MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE
                                        GIVING WSS-VAL-SMO2.
           SUBTRACT WSS-VAL-SMO2 FROM WSS-VAL-SMO1 GIVING WSS-VAL-SMO1.
       CON-PRO-DESC-CIE-1VCTO.
           IF WSS-CIC-VCAM = '0999'
               MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1
           ELSE
               IF WSS-CIC-TVAL = '0'
                   MULTIPLY WSS-VAL-SMO1 BY SCR-SGV-VCAM
                          GIVING WSS-VAL-SMO1
                   MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1
                   DIVIDE WSS-VAL-SMO1 BY SCR-SGV-VCAM
                                             GIVING WSS-VAL-SMO1.
      *
           ADD WSS-VAL-SMO1 TO SCR-SGV-IPFC.

           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.
           IF SCR-SGV-INTN > -1 AND
              SCR-SGV-INTN < 1
              MOVE ZEROES TO SCR-SGV-INTN.

           IF WSS-CIC-TVAL = '0'
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN
              MOVE ZEROES TO SCR-SGV-INTM
              MOVE ZEROES TO SCR-SGV-INT.
      *
           ADD VEN-VAL-SCAP IN CAN-FLD WSS-VAL-SMO1 GIVING WSS-VAL-SMO2.

           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'
               MOVE WSS-VAL-SMO1 TO WSS-VAL-SMO4
               MULTIPLY WSS-VAL-SMO4 BY SCR-SGV-VCAM
                                 GIVING CAN-SGV-TPAG IN CAN-FLD
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG IN CAN-FLD
           ELSE
               MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-CMP2 IN WSS-VARI
               DIVIDE WSS-VAL-CMP2 IN WSS-VARI BY SCR-SGV-VCAM
                                           GIVING WSS-VAL-SMO4.

           IF WSS-VAL-SMO4 NOT < WSS-VAL-SMO2
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CIE-VENCT.

           IF WSS-VAL-SMO4 < WSS-VAL-SMO1
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CIE-VENCT.
           SUBTRACT WSS-VAL-SMO1 FROM WSS-VAL-SMO4 GIVING
                    RCV-SGV-CAPI IN CAN-FLD ROUNDED.
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM VEN-VAL-SCAP IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               NEXT SENTENCE
           ELSE
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                   NEXT SENTENCE
                ELSE
                   IF VEN-VAL-SCAP IN CAN-FLD = VEN-VAL-SFIN IN CAN-FLD
                       MOVE RCV-SGV-CAPI IN CAN-FLD TO
                            RCV-SGV-FINA IN CAN-FLD
                       GO TO FIN-PRO-DESC-CIE-VENCT
                   ELSE
                   SUBTRACT VEN-VAL-SCAP IN CAN-FLD
                   FROM VEN-VAL-SFIN IN CAN-FLD
                   GIVING  RCV-SGV-FINA IN CAN-FLD ROUNDED
                   ADD RCV-SGV-CAPI IN CAN-FLD TO
                       RCV-SGV-FINA IN CAN-FLD
                   GO TO FIN-PRO-DESC-CIE-VENCT.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CIE-VENCT.
           ADD 1 TO INT-TIPE.
           MULTIPLY WSS-VAL-SMO1 BY INT-TIPE GIVING WSS-VAL-SMO1 ROUNDED
           SUBTRACT WSS-VAL-SMO1 FROM VEN-VAL-SFIN IN CAN-FLD GIVING
                    RCV-SGV-FINA IN CAN-FLD ROUNDED.
       FIN-PRO-DESC-CIE-VENCT.
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN.
           MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN.
       FIN-PRO-DESC-CIE-1VCTO.
           EXIT.

      ******************************************************************

       PRO-DESC-CPE-1VCTO SECTION.
      ****************************
       INI-PRO-DESC-CPE-1VCTO.
      * RBG/INI/7-AUG-1996
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI.
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal.
           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN.
      * RBG/FIN/7-AUG-1996

           IF (CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S')
              OR (CAN-SGV-TPAG IN CAN-FLD NOT > ZEROS)
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE.

           PERFORM PRO-UVCT-DVEG.
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2
               MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2
               MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2
               MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2
           ELSE
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
      *
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE-VENCT.
           ADD 1 TO INT-TIPE.
           MOVE INT-TIPE TO WSS-INT-TIPE IN WSS-VARI.
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               GO TO CON-PRO-DESC-CPE-1VCTO.
      *
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
                  GO TO CON-PRO-DESC-CPE-1VCTO.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
      *     PERFORM CAL-TIPE.
           PERFORM CAL-TIPE-DESC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE-VENCT.
           SUBTRACT INT-TIPE FROM WSS-INT-TIPE GIVING WSS-INT-TIPE.
       CON-PRO-DESC-CPE-1VCTO.
           DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
                                      GIVING WSS-VAL-SMO4.
           DIVIDE WSS-VAL-SMO4 BY WSS-INT-TIPE GIVING
                                  RCV-SGV-CAPI IN CAN-FLD.
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.

           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.
           IF SCR-SGV-INTN > -1 AND
              SCR-SGV-INTN < 1
              MOVE ZEROES TO SCR-SGV-INTN.

           IF WSS-CIC-TVAL = '0'
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN
              MOVE ZEROES TO SCR-SGV-INTM
              MOVE ZEROES TO SCR-SGV-INT.
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM VEN-VAL-SCAP IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE-VENCT.
           PERFORM PRO-UVCT-DVEG.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE-VENCT.
           ADD 1 TO INT-TIPE.
           MULTIPLY WSS-VAL-SMO1 BY INT-TIPE GIVING WSS-VAL-SMO1.
           SUBTRACT WSS-VAL-SMO1 FROM VEN-VAL-SFIN IN CAN-FLD GIVING
                                  RCV-SGV-FINA IN CAN-FLD.
           SUBTRACT RCV-SGV-FINA IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE-VENCT.
       FIN-PRO-DESC-CPE-VENCT.
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN.
           MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN.
      * RBG/FIN/7-AUG-1996
       FIN-PRO-DESC-CPE-1VCTO.
           EXIT.

      ******************************************************************

       VAL-TMAX-CONV SECTION.
      ***********************
       INI-VAL-TMAX-CONV.

           MOVE 0 TO WSS-INT-TB90 WSS-INT-TS90 WSS-INT-TMAX.
           MOVE 'TAB'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'  TO TAB-CIC-TTAB IN TAB.
           MOVE '0999' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF OPC-COD-VCOC IN OPC = TAB-COD-CTAB IN TAB
               MOVE 'S' TO WSS-PESO
           ELSE
               MOVE 'N' TO WSS-PESO.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF OPC-MSC-TVOC IN OPC = MSC-COD-CMSC IN MSC
             MOVE WSS-IND-TMMN IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI
           ELSE
             MOVE WSS-IND-TMMX IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI.
           IF WSS-PESO-SI
               PERFORM BUS-CIC-PLZO
               IF WSS-PLZO-B90
                   MOVE FRM-SGV-TINT IN CAN-FLD TO WSS-INT-TB90
               ELSE
                   MOVE FRM-SGV-TINT IN CAN-FLD TO WSS-INT-TS90
           ELSE
               MOVE FRM-SGV-TINT IN CAN-FLD TO WSS-INT-TMAX.
           MOVE ZEROES              TO INT-TIPE.
           MOVE OPC-NUM-DCOL IN OPC TO INT-DDMA.
           MOVE OPC-NUM-MCOL IN OPC TO INT-MDMA.
           MOVE OPC-NUM-SCOL IN OPC TO INT-SDMA.
           MOVE OPC-NUM-ACOL IN OPC TO INT-ADMA.
           MOVE OPC-COD-VCOC IN OPC TO INT-VCAM.
           IF WSS-PESO-SI
               PERFORM VAL-TMXC-PESO
           ELSE
           IF WSS-IND-TMON = WSS-IND-TMMN
               PERFORM VAL-TMXC-MREA
           ELSE
               PERFORM VAL-TMXC-MEXT.
       FIN-VAL-TMAX-CONV.
           EXIT.

       VAL-TMXC-PESO SECTION.
       INI-VAL-TMXC-PESO.
           IF WSS-INT-TB90 NOT > 0
               GO TO TS9-VAL-TMXC-PESO.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE CAM-COD-MNAC           TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TB90'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAM$TB9NEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAM$TB9NVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           MOVE 'VMSS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30   TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-PESO.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CAN$TB9>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-VAL-TMXC-PESO
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-PESO.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE SPACES TO INT-CVTI.
      *
           MOVE 30       TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TB90.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30       TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TB90 > WSS-INT-TMXC
               MOVE 'CAN$TB9>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
      *
       TS9-VAL-TMXC-PESO.
           IF WSS-INT-TS90 NOT > 0
               GO TO FIN-VAL-TMXC-PESO.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE CAM-COD-MNAC           TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TS90'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAM$TS9NEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAM$TS9NVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           MOVE 'VMSS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30  TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-PESO.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CAN$TS9>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-VAL-TMXC-PESO
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-PESO.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE SPACES       TO INT-CVTI.
           MOVE 30           TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TS90.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TS90 > WSS-INT-TMXC
               MOVE 'CAN$TS9>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
       FIN-VAL-TMXC-PESO.
           EXIT.

       VAL-TMXC-MREA SECTION.
       INI-VAL-TMXC-MREA.
           IF WSS-INT-TMAX NOT > 0
               GO TO FIN-VAL-TMXC-MREA.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC    TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TMXC'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAMTMXCNEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAMTMXCNVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE 'VASS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30   TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-MREA.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CAN$TB9>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-VAL-TMXC-MREA
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-MREA.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE SPACES TO INT-CVTI.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE INT-TIPE TO WSS-INT-TMAX.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TMAX > WSS-INT-TMXC
               MOVE 'CANTMRJ>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
       FIN-VAL-TMXC-MREA.
           EXIT.

       VAL-TMXC-MEXT SECTION.
       INI-VAL-TMXC-MEXT.
           IF WSS-INT-TMAX NOT > 0
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE 'TMEX'                 TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TMXC'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAMTMXCNEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAMTMXCNVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           MOVE 'VASS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30     TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-MEXT.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CANTMEX>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-VAL-TMXC-MEXT
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-MEXT.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE SPACES TO INT-CVTI.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE INT-TIPE TO WSS-INT-TMAX.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TMAX > WSS-INT-TMXC
               MOVE 'CANTMEX>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
       FIN-VAL-TMXC-MEXT.
           EXIT.

       BUS-CIC-PLZO SECTION.
       INI-BUS-CIC-PLZO.
           MOVE 'VSN'         TO TAB-COD-TTAB IN TAB.
           MOVE 'CALMORAFMAV' TO TAB-COD-CTAB IN TAB.
           MOVE 'COL' TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FMV-BUS-CIC-PLZO.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NEX'        TO MSG-COD-MENS
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-CIC-PLZO.
           MOVE 'PZO'               TO TAB-COD-TTAB IN TAB.
           MOVE DLC-COD-PLZO IN DLC TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO WSS-PLZO
           ELSE
               MOVE 'TABPZO NEX' TO MSG-COD-MENS
               MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-BUS-CIC-PLZO.
       FMV-BUS-CIC-PLZO.
           MOVE DLC-KEY-IDLC IN DLC TO WSS-DLC-KEY-IDLC.
           MOVE ZEROS               TO WSS-DLC-FEC-FMAV.
           MOVE ZEROS               TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS         TO FIO-CMND.
       LUP-BUS-CIC-PLZO.
           PERFORM COL-FIO-DLC.
           IF NOT (FIO-STAT-OKS AND
                   DLC-CIC-IOPC IN DLC = WSS-DLC-CIC-IOPC)
               GO TO CON-BUS-CIC-PLZO.
           IF DLC-FEC-FMAV IN DLC > WSS-DLC-FEC-FMAV
               MOVE DLC-FEC-FMAV IN DLC TO WSS-DLC-FEC-FMAV.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-CIC-PLZO.
       CON-BUS-CIC-PLZO.
           MOVE OPC-NUM-DCOL IN OPC TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC TO FEC-AEC1.
           MOVE WSS-DLC-NUM-DMAV    TO FEC-DEC2.
           MOVE WSS-DLC-NUM-MMAV    TO FEC-MEC2.
           MOVE WSS-DLC-NUM-SMAV    TO FEC-SEC2.
           MOVE WSS-DLC-NUM-AMAV    TO FEC-AEC2.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-DIF-DIA         TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-NDIA < 90
               MOVE 'C1' TO WSS-PLZO
           ELSE
               MOVE 'S9' TO WSS-PLZO.
           MOVE WSS-DLC-KEY-IDLC TO DLC-KEY-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
       FIN-BUS-CIC-PLZO.
           EXIT.

       GLS-INT-TIPE SECTION.
       INI-GLS-INT-TIPE.
           MOVE 'TIPE'              TO ITR-COD-TINT IN ITR.
           MOVE 'TIPE'              TO SCR-COD-TICG.
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'INT'               TO TAB-COD-TTAB IN TAB.
           MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ITR-COD-TINT IN ITR NOT > SPACES
               MOVE 'TASA PERIODO' TO FRM-GLS-TINT IN CAN-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAN-FLD.
       FIN-GLS-INT-TIPE.
           EXIT.

      ******************************************************************
       LIM-TBAN SECTION.
      ****************
       INI-LIM-TBAN.
           MOVE 1 TO MOV-I.
       LUP-LIM-TBAN.
           IF MOV-I > 20
               GO TO FIN-LIM-TBAN.
           MOVE SPACES TO WSS-TBAN (MOV-I).
       SIG-LIM-TBAN.
           ADD 1 TO MOV-I.
           GO TO LUP-LIM-TBAN.
       FIN-LIM-TBAN.
           EXIT.
      ******************************************************************
       CHK-EXI-TBAN SECTION.
      *********************
       INI-CHK-EXT-TBAN.
           MOVE 1 TO MOV-I.
       LUP-VEC-TBAN.
           IF WSS-COD-BANC IN WSS-VARI = WSS-TBAN (MOV-I) AND
              WSS-COD-BANC IN WSS-VARI > SPACES
               MOVE 'S' TO WSS-IND-EBAN IN WSS-VARI
               GO TO FIN-CHK-EXT-TBAN.
           IF MOV-I = 20
               MOVE 'N' TO WSS-IND-EBAN IN WSS-VARI
               GO TO FIN-CHK-EXT-TBAN
           ELSE
               ADD 1 TO MOV-I
               GO TO LUP-VEC-TBAN.
       FIN-CHK-EXT-TBAN.
           EXIT.
      ******************************************************************
       CAL-NUM-DHBL SECTION.
      **********************
       INI-CAL-NUM-DHBL.
      *VAL-FEC Va sumando un dia habil hasta acumular 2.
           MOVE 1 TO WSS-NUM-1HBL IN WSS-VARI.
           MOVE 1 TO WSS-NUM-CONT IN WSS-VARI.
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DTOP IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MTOP IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-STOP IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-ATOP IN WSS-VARI.
      * Controlo si es Habil o No Habil.
      *VAL-FEC Validar Fecha.
           MOVE VEN-NUM-DVEN IN VEN TO FEC-ITM1.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-ITM2.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-ITM3.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE 'S' TO WSS-IND-FERI IN WSS-VARI
           ELSE
              MOVE 'N' TO WSS-IND-FERI IN WSS-VARI.
      * Ya Controle si es Habil o No Habil.
       SUM-DIA-SHBL.
           MOVE WSS-NUM-DTOP TO FEC-ITM1.
           MOVE WSS-NUM-MTOP TO FEC-ITM2.
           MOVE WSS-NUM-STOP TO FEC-ITM3.
           MOVE WSS-NUM-ATOP TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DTOP.
           MOVE FEC-ITM2 TO WSS-NUM-MTOP.
           MOVE FEC-ITM3 TO WSS-NUM-STOP.
           MOVE FEC-ITM4 TO WSS-NUM-ATOP.
      *VAL-FEC Validar Fecha.
           MOVE WSS-NUM-DTOP TO FEC-ITM1.
           MOVE WSS-NUM-MTOP TO FEC-ITM2.
           MOVE WSS-NUM-STOP TO FEC-ITM3.
           MOVE WSS-NUM-ATOP TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              GO TO SUM-DIA-SHBL.

           IF (WSS-NUM-CONT IN WSS-VARI = 1) AND
              (WSS-IND-FERI IN WSS-VARI = 'N')
                 GO TO FIN-CAL-NUM-DHBL.

           IF (WSS-NUM-CONT IN WSS-VARI = 2) AND
              (WSS-IND-FERI IN WSS-VARI = 'S')
                 GO TO FIN-CAL-NUM-DHBL
           ELSE
               ADD 1 TO WSS-NUM-CONT IN WSS-VARI
               GO TO SUM-DIA-SHBL.

       FIN-CAL-NUM-DHBL.
           EXIT.
      ******************************************************************
       RST-DIA-HBLS SECTION.
      **********************
       INI-RST-DIA-HBLS.
      * Calculo el numero de dias que hay entre la FCAN y FVEN
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC1.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC1.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC1.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC1.
           MOVE CAN-NUM-DOUT IN CAN-FLD TO FEC-DEC2.
           MOVE CAN-NUM-MOUT IN CAN-FLD TO FEC-MEC2.
           MOVE CAN-NUM-SOUT IN CAN-FLD TO FEC-SEC2.
           MOVE CAN-NUM-AOUT IN CAN-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO WSS-NUM-TOP1 IN WSS-VARI.
           IF WSS-NUM-TOP1 IN WSS-VARI > WSS-NUM-TOPE IN WSS-VARI
               MOVE 'N' TO WSS-IND-MORA IN WSS-VARI
               GO TO FIN-RST-DIA-HBLS.

      *VAL-FEC Va restando un dia habil hasta acumular 6.
           MOVE 'N' TO WSS-IND-MORA IN WSS-VARI.
           MOVE 1   TO WSS-NUM-CONT IN WSS-VARI.
           MOVE CAN-NUM-DOUT IN CAN-FLD TO WSS-NUM-DTOP IN WSS-VARI.
           MOVE CAN-NUM-MOUT IN CAN-FLD TO WSS-NUM-MTOP IN WSS-VARI.
           MOVE CAN-NUM-SOUT IN CAN-FLD TO WSS-NUM-STOP IN WSS-VARI.
           MOVE CAN-NUM-AOUT IN CAN-FLD TO WSS-NUM-ATOP IN WSS-VARI.
      * Resta 6 dias habiles y se salta los no habiles.
       REST-DIA-HBLS.
           MOVE WSS-NUM-DTOP TO FEC-ITM1.
           MOVE WSS-NUM-MTOP TO FEC-ITM2.
           MOVE WSS-NUM-STOP TO FEC-ITM3.
           MOVE WSS-NUM-ATOP TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DTOP.
           MOVE FEC-ITM2 TO WSS-NUM-MTOP.
           MOVE FEC-ITM3 TO WSS-NUM-STOP.
           MOVE FEC-ITM4 TO WSS-NUM-ATOP.
      *VAL-FEC Validar Fecha.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              GO TO REST-DIA-HBLS.

           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FTOP IN WSS-VARI
               MOVE 'N' TO WSS-IND-MORA IN WSS-VARI
               GO TO FIN-RST-DIA-HBLS.

           IF (WSS-NUM-CONT IN WSS-VARI = WSS-NUM-DIAS IN WSS-VARI) AND
              (VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FTOP IN WSS-VARI)
                 MOVE 'S' TO WSS-IND-MORA IN WSS-VARI
                 GO TO FIN-RST-DIA-HBLS
           ELSE
               ADD 1 TO WSS-NUM-CONT IN WSS-VARI
               GO TO REST-DIA-HBLS.
       FIN-RST-DIA-HBLS.
           EXIT.
      ******************************************************************
       CAL-TFPR-CAN SECTION.
       INI-CAL-TFPR-CAN.
           MOVE SPACES TO WSS-CMSG WSS-MENS.
      *Si VEN ya esta completo continua en el despliegue
           IF VEN-IND-CALC IN VEN NOT = 'N'
               GO TO DSP-CAL-TFPR-CAN.
      *
      *Debe calcular tasa de interes del periodo entre
      *MIN(MAX(FDEV,FVEN anterior o FCOL),VEN actual) y VEN actual,
      *entonces ...

      *En principio asume 0 para IDNI
           MOVE ZEROES TO WSS-VAL-IDNI IN WSS-VARI.
      *
      *Lee el documento asociado al vencimiento
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NEX' TO MSG-COD-MENS INT-CMSG
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CAL-TFPR-CAN.

      *Si es el primer vencimiento FMAX = MAX(FDEV,FCOL) y continua
           IF VEN-NUM-IVEN IN VEN = 1
               IF DLC-FEC-FDEV IN DLC > OPC-FEC-FCOL IN OPC
                   MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FMAX
                   GO TO CON-CAL-TFPR-CAN
               ELSE
                   MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FMAX
                   GO TO CON-CAL-TFPR-CAN.
      *
      *Lee vencimiento anterior ( pero antes asume FMAX como fecha
      *del actual por si ocurre un error al leer el anterior )
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FMAX.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           SUBTRACT 1             FROM VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FMAX
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
                                               IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FMAX
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
                                               IN WSS-VARI.
      *
      *Compara la fecha del DLC con la FVEN(FMAX) del VEN anterior
      *FMAX = MAX(FDEV,FVEN anterior) y continua
           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FMAX
               MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FMAX.
      *
      *Restaura el VEN actual
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
           ELSE
               PERFORM COL-FIO-VEN.
       CON-CAL-TFPR-CAN.
      *FUNO = MIN(CANDIDATO=MAX(FDEV,FCOL o FVEN anterior),FVEN actual)
           IF VEN-FEC-FVEN IN VEN < WSS-FEC-FMAX
               MOVE VEN-NUM-DVEN IN VEN TO INT-DUNO
               MOVE VEN-NUM-MVEN IN VEN TO INT-MUNO
               MOVE VEN-NUM-SVEN IN VEN TO INT-SUNO
               MOVE VEN-NUM-AVEN IN VEN TO INT-AUNO
           ELSE
               MOVE WSS-NUM-DMAX TO INT-DUNO
               MOVE WSS-NUM-MMAX TO INT-MUNO
               MOVE WSS-NUM-SMAX TO INT-SUNO
               MOVE WSS-NUM-AMAX TO INT-AUNO.
      *Carga FDOS, FCOL, FBTV, TINT, TIPT, VCAM y llama a rutina GNS-CAL
      *para obtener tasa de periodo
           MOVE VEN-NUM-DVEN IN VEN     TO INT-DDOS.
           MOVE VEN-NUM-MVEN IN VEN     TO INT-MDOS.
           MOVE VEN-NUM-SVEN IN VEN     TO INT-SDOS.
           MOVE VEN-NUM-AVEN IN VEN     TO INT-ADOS.

           MOVE OPC-NUM-DCOL IN OPC     TO INT-DCOL.
           MOVE OPC-NUM-MCOL IN OPC     TO INT-MCOL.
           MOVE OPC-NUM-SCOL IN OPC     TO INT-SCOL.
           MOVE OPC-NUM-ACOL IN OPC     TO INT-ACOL.

           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DBTV.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MBTV.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SBTV.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ABTV.

           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS uso de spread para calculo 1ra cuota (Memo.13/05/92)
           IF VEN-NUM-IVCT IN VEN = 1 AND
              INT-CVTI > SPACES AND INT-TFPR = 'C' AND
              SCR-SGV-SPR2 > 0
               MOVE 'COL'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE 'VSNLIQTMXCBCI' TO TAB-COD-TABL IN TAB
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                   MOVE SCR-SGV-SPR2 TO INT-SPR2.
      *
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.

           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC
           PERFORM COL-CAL-INT.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-CAL-TFPR-CAN.
      *
           ADD WSS-VAL-SCRE IN WSS-VARI WSS-VAL-IDNI IN WSS-VARI
               GIVING WSS-VAL-INTE IN WSS-VARI.
           MULTIPLY WSS-VAL-INTE IN WSS-VARI BY INT-TIPE GIVING
                    WSS-VAL-INTE IN WSS-VARI ROUNDED.
           ADD WSS-VAL-IDNI IN WSS-VARI TO WSS-VAL-INTE IN WSS-VARI.
      *
      *Si el credito esta en moneda nacional ( no reajustable ), redonde
      *sin centavos el interes
           IF OPC-COD-VCOC IN OPC = CAM-COD-MNAC IN CAM-VARI
            MOVE WSS-VAL-INTE IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
            PERFORM PES-SCTV
            MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-INTE IN WSS-VARI.
      *
      *Si a la cuota le falta el valor final, lo completa con el interes
      *correspondiente
           IF VEN-VAL-FINA IN VEN = 0
               MOVE 'F' TO SCR-RCV-STAT
               ADD WSS-VAL-INTE IN WSS-VARI
                   VEN-VAL-CAPI IN VEN GIVING  VEN-VAL-FINA IN VEN
               MOVE VEN-VAL-FINA IN VEN     TO VEN-VAL-SFIN IN VEN
           ELSE
      *Si a la cuota le falta el valor capital, lo completa con el inter
      *correspondiente
            MOVE 'C' TO SCR-RCV-STAT
            SUBTRACT WSS-VAL-INTE IN WSS-VARI FROM
                     VEN-VAL-FINA IN VEN GIVING    VEN-VAL-CAPI IN VEN
            MOVE VEN-VAL-CAPI IN VEN          TO   VEN-VAL-SCAP IN VEN.

      *Verifica si el capital es mayor que el saldo del credito,
      *asume capital el saldo del credito
           IF VEN-VAL-SCAP IN VEN > WSS-VAL-SCRE IN WSS-VARI
              MOVE 'F' TO SCR-RCV-STAT
              MOVE WSS-VAL-SCRE IN WSS-VARI TO VEN-VAL-CAPI IN VEN
              MOVE VEN-VAL-CAPI IN VEN      TO VEN-VAL-SCAP IN VEN
              ADD WSS-VAL-INTE IN WSS-VARI
                  VEN-VAL-CAPI IN VEN GIVING  VEN-VAL-FINA IN VEN
              MOVE VEN-VAL-FINA IN VEN     TO VEN-VAL-SFIN IN VEN.

      *Si los intereses son mayores que el valor final ( esta situacion
      *puede dar solo cuando la cuota esta definida con valor final cono
      *por ahora se aborta
           IF WSS-VAL-INTE IN WSS-VARI > VEN-VAL-FINA IN VEN
               MOVE 'CANINTEFINA>' TO INT-CMSG MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-CAL-TFPR-CAN.

      *Si es la ultima cuota y el valor de capital es menor que el saldo
      *del credito, asume capital el saldo del credito
           IF VEN-FEC-FVEN IN VEN = DLC-FEC-FMAV IN DLC AND
              VEN-VAL-SCAP IN VEN < WSS-VAL-SCRE IN WSS-VARI
              AND ( OPC-IND-VSTR IN OPC = 'S' OR
                  ( SCR-MSC-FCAN = 'T' AND SCR-MSC-ECAN = 'T' ) )
      *
               MOVE 'F' TO SCR-RCV-STAT
               MOVE WSS-VAL-SCRE IN WSS-VARI TO VEN-VAL-CAPI IN VEN
               MOVE VEN-VAL-CAPI IN VEN      TO VEN-VAL-SCAP IN VEN
               ADD WSS-VAL-INTE IN WSS-VARI
                   VEN-VAL-CAPI IN VEN GIVING  VEN-VAL-FINA IN VEN
               MOVE VEN-VAL-FINA IN VEN     TO VEN-VAL-SFIN IN VEN.
      *
      *EL CREDITO ESTA EN MONEDA NACIONAL ( NO REAJUSTABLE ), REDONDE
      *sin centavos
           IF OPC-COD-VCOC IN OPC = CAM-COD-MNAC IN CAM-VARI
               MOVE VEN-VAL-CAPI IN VEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-CAPI IN VEN
               MOVE VEN-VAL-FINA IN VEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-FINA IN VEN.
      *
       DSP-CAL-TFPR-CAN.
      *En este punto el VEN esta completo

      *Despliega los datos del vencimiento que esta completando
      *si es CTE ( en caso de CTT se hace en el LUP correspondiente ) o
      *en el caso de ser un vencimiento ( ya que un CTT en este caso es
      *tratado como CTE )
           IF ( SCR-MSC-FCAN = 'T' AND SCR-MSC-ECAN = 'E' ) OR
              OPC-NUM-VCOR IN OPC = 1
               MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD
               MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD.
       FIN-CAL-TFPR-CAN.
       PRO-MORA-TXC SECTION.
       INI-PRO-MORA-TXC.
           PERFORM BUS-CIC-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-TXC.
           PERFORM DET-OPC-PRO-ORIG.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-TXC.
           MOVE WSS-PLZO                TO TXC-PLZO.
           MOVE OPC-COD-VCOC IN OPC     TO TXC-VCOC.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TXC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TXC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO TXC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TXC-AEC2.
           MOVE WSS-NUM-DUPM IN WSS-VARI TO TXC-DEC1.
           MOVE WSS-NUM-MUPM IN WSS-VARI TO TXC-MEC1.
           MOVE WSS-NUM-SUPM IN WSS-VARI TO TXC-SEC1.
           MOVE WSS-NUM-AUPM IN WSS-VARI TO TXC-AEC1.

           PERFORM TAB-BUS-TXC.

           IF TXC-CMSG > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE TXC-CMSG     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE CAM-KEY-CAMB TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-TXC.
           DIVIDE TXC-ATXC       BY 100 GIVING
                                 WSS-INT-TIPE ROUNDED.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1'          TO FRM-IND-TIPE IN CAN-FLD
               MOVE WSS-INT-TIPE TO INT-TIPE
               MULTIPLY WSS-INT-TIPE BY 100 GIVING ICG-SGV-TINT
                                             IN CAN-FLD
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               PERFORM GLS-INT-TIPE
               GO TO FIN-PRO-MORA-TXC.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               MOVE 'S' TO WSS-IBLK-TINT
               PERFORM GLS-INT-TIPE
               GO TO CMP-INT-TIPE-TXC.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE SPACES TO INT-CVTI.
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-TXC.
       CMP-INT-TIPE-TXC.
           IF INT-TIPE > WSS-INT-TIPE
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'CANTIPE>TXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR.
       FIN-PRO-MORA-TXC.
           EXIT.
       DET-OPC-PRO-ORIG SECTION.
       INI-DET-OPC-PRO-ORIG.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           IF OPC-IND-RENO IN OPC NOT = 'PRO'
               GO TO NXT-DET-OPC-PRO-ORIG.
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC.
           MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE CAM-KEY-CAMB TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-DET-OPC-PRO-ORIG.

           MOVE 1                            TO CAM-SGV-VCAM IN CAM.
           IF WSS-CIC-VCAM NOT = '0998'
               MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(2)
               MOVE OPC-NUM-DCOL IN OPC      TO CAM-NUM-DCAM IN CAM(1)
               MOVE OPC-NUM-MCOL IN OPC      TO CAM-NUM-MCAM IN CAM(1)
               MOVE OPC-NUM-SCOL IN OPC      TO CAM-NUM-SCAM IN CAM(1)
               MOVE OPC-NUM-ACOL IN OPC      TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE CAM-KEY-CAMB TO FRM-MEN2
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE WSS-CIC-IOPC TO OPC-CIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   GO TO FIN-DET-OPC-PRO-ORIG.
           DIVIDE OPC-VAL-CRED IN OPC BY CAM-SGV-VCAM IN CAM
                  GIVING                   TXC-MNTO ROUNDED.
           MOVE WSS-CIC-IOPC TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           GO TO FIN-DET-OPC-PRO-ORIG.
       NXT-DET-OPC-PRO-ORIG.
           MOVE 1                            TO CAM-SGV-VCAM IN CAM.
           IF WSS-CIC-VCAM NOT = '0998'
               MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(2)
               MOVE OPC-NUM-DCOL IN OPC      TO CAM-NUM-DCAM IN CAM(1)
               MOVE OPC-NUM-MCOL IN OPC      TO CAM-NUM-MCAM IN CAM(1)
               MOVE OPC-NUM-SCOL IN OPC      TO CAM-NUM-SCAM IN CAM(1)
               MOVE OPC-NUM-ACOL IN OPC      TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE CAM-KEY-CAMB TO FRM-MEN2
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-DET-OPC-PRO-ORIG.
           DIVIDE OPC-VAL-CRED IN OPC BY CAM-SGV-VCAM IN CAM
                  GIVING                   TXC-MNTO ROUNDED.
       FIN-DET-OPC-PRO-ORIG.
           EXIT.
      *>>>>
