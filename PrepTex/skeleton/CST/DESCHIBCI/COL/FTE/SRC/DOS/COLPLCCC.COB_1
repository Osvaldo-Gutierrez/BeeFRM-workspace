       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLCCC.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    27-Jan-94 09:37 PM.

      * Programa Listador de Reporte CCC con Sort.


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTCCC         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTCCC         ASSIGN TO        UT-S-RPTCCC.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT RPTCCC         ASSIGN TO        UT-S-RPTCCC.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY COLRRCCC.
       FD  RPTCCC LABEL RECORDS OMITTED
           REPORT IS RPT-CCC
           .

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBRVEN.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWCCC.
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       01  WSS-VARI.
           03  WSS-NUM-IPAG   VALUE 0 PIC 9(01).
           03  WSS-GLS-LDET-R.
               05 WSS-GLS-LDET-R1                    PIC X(01).
               05 WSS-GLS-LDET-R2                    PIC X(02).
               05 WSS-GLS-LBLK-R2 REDEFINES WSS-GLS-LDET-R2
                                                     PIC 9(02).
               05 WSS-GLS-LDET-R3                    PIC X(77).
           03  WSS-TIPO-CARTA.
               05 WSS-P1   VALUE 'LCCCD'             PIC X(05).
               05 WSS-P2                             PIC 9(02).
           03  WSS-COD-CTAB.
               05 WSS-COD-CTA1                       PIC X(07).
               05 WSS-COD-CTA2                       PIC X(05).
           03  WSS-CONT                              PIC 9(02).
           03  WSS-IMAX                              PIC 9(02).
           03  WSS-I                                 PIC 9(02).
           03  WSS-J                                 PIC 9(02).
           03  WSS-K                                 PIC 9(02).
           03  WSS-FEC-FPRO.
               05 WSS-NUM-DPRO                       PIC 9(02).
               05 WSS-NUM-MPRO                       PIC 9(02).
               05 WSS-NUM-SPRO                       PIC 9(02).
               05 WSS-NUM-APRO                       PIC 9(02).
           03 WSS-FEC-FTRB.
              05 WSS-NUM-DTRB        VALUE ZEROS     PIC 9(02).
              05 WSS-NUM-MTRB        VALUE ZEROS     PIC 9(02).
              05 WSS-NUM-STRB        VALUE ZEROS     PIC 9(02).
              05 WSS-NUM-ATRB        VALUE ZEROS     PIC 9(02).
           03  WSS-FEC-FINI.
               05 WSS-NUM-DINI                       PIC 9(02).
               05 WSS-NUM-MINI                       PIC 9(02).
               05 WSS-NUM-SINI                       PIC 9(02).
               05 WSS-NUM-AINI                       PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-DTER                      PIC 9(02).
               05  WSS-VEC    OCCURS 98.
                   07 WSS-FEC-VECT.
                      09 WSS-NUM-SECT                PIC 9(02).
                      09 WSS-NUM-AECT                PIC 9(02).
                      09 WSS-NUM-MECT                PIC 9(02).
                      09 WSS-NUM-DECT                PIC 9(02).
                   07 WSS-NRO-CART                   PIC 9(02).
           03  WSS-GLOSA-CARTA.
               05 WSS-VEC-CARTA OCCURS 6.
                      07 WSS-NUM-LCAR                      PIC 9(02).
                      07 WSS-LI-CA OCCURS 50.
                         09 WSS-LINEA-CARTA.
                            15 WSS-GLS-DESC                PIC X(40).
                            15 WSS-GLS-DATA                PIC X(60).
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
       COPY GNSWGINT.
       COPY GNSWGCPT.
       COPY GNSWGEPT.
       COPY TABWGLOC.
       COPY COLBROPC.
       COPY SGCBRDBC.
       COPY SGCBRRCD.
       COPY COLBRRDC.
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
      *>>>>

       REPORT SECTION.
      *--------------
       COPY COLRFCCC.
           .
       COPY COLRTCCC.

       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-CF-CCC-SRT-NUM-IPAG SECTION.
           USE BEFORE REPORTING CF-CCC-SRT-NUM-IPAG.
       INI-CF-CCC-SRT-NUM-IPAG.
       FIN-CF-CCC-SRT-NUM-IPAG.
           EXIT.
       DEC-PH-CCC SECTION.
           USE BEFORE REPORTING PH-CCC.
       INI-PH-CCC.
       FIN-PH-CCC.
           EXIT.
       END DECLARATIVES.

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPLCCC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *<<<< INI


           PERFORM GET-FHOY.
           MOVE 'DIA'               TO EPT-VTOK( 1 ).
           MOVE HOY-DHOY            TO EPT-GTOK( 1 ).

           MOVE 'MES'               TO EPT-VTOK( 2 ).
           MOVE HOY-MHOY            TO EPT-GTOK( 2 ).

           MOVE 'SGL'               TO EPT-VTOK( 3 ).
           MOVE HOY-SHOY            TO EPT-GTOK( 3 ).

           MOVE 'ANO'               TO EPT-VTOK( 4 ).
           MOVE HOY-AHOY            TO EPT-GTOK( 4 ).

           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.

      *VAL-FEC Valida Fecha de PROCESO
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-MAIN.
           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
      * Establece Fecha Inicio para busqueda en OPC.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DTER IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MTER IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-STER IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-ATER IN WSS-VARI.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DTRB IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MTRB IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-STRB IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-ATRB IN WSS-VARI.
           PERFORM LIMPIA-VEC VARYING WSS-I FROM 1 BY 1
                                      UNTIL WSS-I > 98.
           MOVE 0 TO WSS-I.
           MOVE 0 TO WSS-CONT.
      * Creo vector de fechas con 6 dias habiles (retrocediendo)
           PERFORM GUARDA-N-DIAS-HABILES UNTIL WSS-CONT NOT < 5.
           MOVE WSS-NUM-DTRB TO WSS-NUM-DINI.
           MOVE WSS-NUM-MTRB TO WSS-NUM-MINI.
           MOVE WSS-NUM-STRB TO WSS-NUM-SINI.
           MOVE WSS-NUM-ATRB TO WSS-NUM-AINI.
           PERFORM LLENA-MAT VARYING WSS-I FROM 1 BY 1 UNTIL WSS-I > 6.
      *>>>>
           SORT GNSSRT
       COPY COLRSCCC.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-VEN.
       FST-INP-SRT.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-VEN.
      *<<<< INI_FST_INP
           MOVE 0 TO SRT-NUM-IPAG.
           MOVE WSS-NUM-DINI IN WSS-VARI TO VEN-NUM-DVEN IN VEN.
           MOVE WSS-NUM-MINI IN WSS-VARI TO VEN-NUM-MVEN IN VEN.
           MOVE WSS-NUM-SINI IN WSS-VARI TO VEN-NUM-SVEN IN VEN.
           MOVE WSS-NUM-AINI IN WSS-VARI TO VEN-NUM-AVEN IN VEN.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS OR
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTER IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT
           ELSE
               GO TO LUP-INP-SRT.
      *>>>>
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           IF NOT FIO-STAT-OKS OR
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-INP-SRT.

           PERFORM BUSCA-NUM-DIAS VARYING WSS-I FROM 1 BY 1
                   UNTIL WSS-I > WSS-IMAX OR
                         VEN-FEC-FVEN IN VEN = WSS-FEC-VECT (WSS-I).
           IF WSS-I > WSS-IMAX
               GO TO NXT-INP-SRT.
           DISPLAY 'FEC-VECT(' WSS-I '):' WSS-FEC-VECT(WSS-I).
           DISPLAY 'PARA ' VEN-KEY-IVEN IN VEN '. VENCE:'
                   VEN-FEC-FVEN IN VEN '.CARTA:'
                   WSS-NRO-CART ( WSS-I ) '.INDICE:' WSS-I.
           MOVE WSS-NRO-CART ( WSS-I ) TO WSS-TIP-CART IN WSS-CCC.

           MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE OPC:' OPC-CIC-IOPC IN OPC
               GO TO NXT-INP-SRT.
           IF NOT ( OPC-VAL-SCRE IN OPC > 0 AND OPC-ACTIVADA )
               GO TO NXT-INP-SRT.

           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE CLIENTE ASOCIADO A OPC:'
               OPC-CIC-IOPC IN OPC
               GO TO NXT-INP-SRT.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC
               MOVE ZEROES TO DBC-NUM-ICLI IN DBC
               MOVE SPACES TO DBC-IND-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC
               MOVE SPACES TO DBC-GLS-ICLI IN DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *>>>>
       MOV-INP-SRT.
       COPY COLRMCCC.
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-VEN.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
           OPEN OUTPUT RPTCCC.
           CALL 'GNSPLHDR' USING RPT-VARI.
           INITIATE RPT-CCC.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           MOVE '%' TO WSS-GLS-BLKS IN WSS-CCC.
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           MOVE 'USER'              TO EPT-VTOK( 5 ).
           MOVE RPT-DUSU            TO EPT-GTOK( 5 ).
           MOVE DBC-CIC-ICLI IN SRT TO RCD-CIC-ICLI IN RCD.
           MOVE RDC-NUM-DIRE IN SRT TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE NRO. DE DIRECCCION:'
                      RDC-NUM-DIRE IN SRT ', PARA CLIENTE:'
                      DBC-GLS-NOMC IN SRT
              GO TO NXT-OUT-SRT.
      * BUSQUEDA LOCALIDAD
           IF RCD-COD-LUGA IN RCD > SPACES
               MOVE RCD-COD-LUGA IN RCD TO LOC-LUGA
               PERFORM TAB-BUS-LOC
           ELSE
               MOVE SPACES TO LOC-DESC.

           MOVE 'NOMCLI'            TO EPT-VTOK( 6 ).
           MOVE DBC-GLS-NOMC IN SRT TO EPT-GTOK( 6 ).

           MOVE 'DIRCLI'            TO EPT-VTOK( 7 ).
           MOVE RCD-GLS-DIRE IN RCD TO EPT-GTOK( 7 ).

           MOVE 'LOCCLI'            TO EPT-VTOK( 8 ).
           MOVE LOC-DESC            TO EPT-GTOK( 8 ).

           MOVE 'OPERAC'            TO EPT-VTOK( 9 ).
           MOVE OPC-CIC-IOPC IN SRT TO EPT-GTOK( 9 ).

           MOVE 'CUOTA'             TO EPT-VTOK( 10 ).
           MOVE VEN-NUM-IVEN IN SRT TO EPT-GTOK( 10 ).

           MOVE 0 TO WSS-J.
           MOVE WSS-TIP-CART IN SRT TO WSS-I.
           IF WSS-NUM-IPAG = 0
               MOVE 1 TO WSS-NUM-IPAG
           ELSE
               MOVE 0 TO WSS-NUM-IPAG.
           MOVE WSS-NUM-IPAG TO SRT-NUM-IPAG.
           DISPLAY 'PARA ' OPC-CIC-IOPC IN SRT ' '
                           VEN-NUM-IVEN IN SRT '. CARTA:' WSS-I.
           IF WSS-NUM-LCAR( WSS-I ) = 0
               DISPLAY 'NO EXISTE CARTA NRO.:' WSS-I ', DEBE'
                       'INGRESARLA EN TABLA CRT DE COL'
               GO TO NXT-OUT-SRT.
       LU1-OUT-SRT.
           ADD 1 TO WSS-J.
           IF WSS-J > WSS-NUM-LCAR( WSS-I )
               GO TO NXT-OUT-SRT.
           MOVE WSS-LINEA-CARTA ( WSS-I , WSS-J )  TO EPT-STRN.
           PERFORM EPT-CARD.
           MOVE EPT-STRN TO WSS-GLS-LDET WSS-GLS-LDET-R.
           IF ( WSS-GLS-LDET-R1 = '\' OR '/' ) AND
              WSS-GLS-LDET-R2 IS NUMERIC AND
              WSS-GLS-LDET-R3 NOT > SPACES
               PERFORM LIN-BLKS VARYING WSS-K FROM 1 BY 1 UNTIL
                  WSS-K > WSS-GLS-LBLK-R2
                  GO TO LU1-OUT-SRT.
      *>>>>
       GEN-OUT-SRT.
           GENERATE DL-CCC.
      *<<<< FIN_GEN_OUT
           GO TO LU1-OUT-SRT.
      *>>>>
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
           TERMINATE RPT-CCC.
           CLOSE RPTCCC.
       EXT-OUT-SRT.
           EXIT.
       COPY COLBFVEN.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF
       COPY COLBFOPC.
       COPY SGCBFDBC.
       COPY COLBFRDC.
       COPY SGCBFRCD.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBGEPT.
       COPY TABBBLOC.

       LIN-BLKS SECTION.
       INI-LIN-BLKS.
           MOVE SPACES TO WSS-GLS-LDET.
           GENERATE DL-CCC.
       FIN-LIN-BLKS.
           EXIT.

       BUSCA-NUM-DIAS SECTION.
       INI-BUSCA-NUM-DIAS.
       FIN-BUSCA-NUM-DIAS.
           EXIT.

       LLENA-MAT SECTION.
       INI-LLENA-MAT.
           MOVE 0 TO WSS-J.
           PERFORM LLEVA-A-VECTOR-TIPO-CARTA.
       FIN-LLENA-MAT.
           EXIT.

       LLEVA-A-VECTOR-TIPO-CARTA SECTION.
       INI-LLEVA-A-VECTOR-TIPO-CARTA.
           MOVE 0 TO WSS-NUM-LCAR(WSS-I).
           MOVE WSS-I TO WSS-P2.
           MOVE 'CRT'          TO TAB-COD-TTAB IN TAB.
           MOVE WSS-TIPO-CARTA TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-LEE-TAB.
           MOVE 'COL' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-COD-TTAB IN TAB = 'CRT' )
              GO TO FIN-LLEVA-A-VECTOR-TIPO-CARTA.
           MOVE TAB-COD-CTAB TO WSS-COD-CTAB.
           IF WSS-COD-CTA1 = WSS-TIPO-CARTA
              IF WSS-COD-CTA2 NOT > SPACES
                 MOVE FIO-GET-NXT TO FIO-CMND
                 GO TO LOOP-LEE-TAB
              ELSE
                 ADD 1 TO WSS-J
                 MOVE WSS-J TO WSS-NUM-LCAR(WSS-I)
                 MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DESC(WSS-I,WSS-J)
                 MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA(WSS-I,WSS-J)
                 MOVE FIO-GET-NXT TO FIO-CMND
                 GO TO LOOP-LEE-TAB.
       FIN-LLEVA-A-VECTOR-TIPO-CARTA.
           EXIT.

       GUARDA-N-DIAS-HABILES SECTION.
       INI-GUARDA-N-DIAS-HABILES.
           MOVE WSS-FEC-FTRB IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC             TO FEC-FORM.
           MOVE FEC-RST-DIA              TO FEC-CMND.
           MOVE 1                        TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH                 TO WSS-FEC-FTRB IN WSS-VARI.

           ADD 1 TO WSS-I.
           MOVE WSS-NUM-DTRB TO WSS-NUM-DECT (WSS-I).
           MOVE WSS-NUM-MTRB TO WSS-NUM-MECT (WSS-I).
           MOVE WSS-NUM-STRB TO WSS-NUM-SECT (WSS-I).
           MOVE WSS-NUM-ATRB TO WSS-NUM-AECT (WSS-I).
      * Valida si Fecha de Trabajo es habil
           MOVE WSS-FEC-FTRB IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC             TO FEC-FORM.
           MOVE FEC-FBLK-N               TO FEC-FBLK.
           MOVE FEC-CHOY-N               TO FEC-CHOY.
           MOVE FEC-VHBL-S               TO FEC-VHBL.
           MOVE FEC-VAL-FEC              TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               IF WSS-CONT = 0
                   MOVE 1 TO WSS-NRO-CART (WSS-I)
               ELSE
                   MOVE WSS-CONT TO WSS-NRO-CART (WSS-I)
           ELSE
               ADD 1 TO WSS-CONT
               MOVE WSS-CONT TO WSS-NRO-CART (WSS-I).
           MOVE WSS-I TO WSS-IMAX.
       FIN-GUARDA-N-DIAS-HABILES.
           EXIT.

       LIMPIA-VEC SECTION.
       INI-LIMPIA-VEC.
           MOVE ZEROS TO WSS-NUM-DECT (WSS-I)
                         WSS-NUM-MECT (WSS-I)
                         WSS-NUM-SECT (WSS-I)
                         WSS-NUM-AECT (WSS-I)
                         WSS-NRO-CART (WSS-I).
       FIN-LIMPIA-VEC.
           EXIT.
      *>>>>
