      *
      * COLBUCNC
      * Version 3.0.1 Nov-2005
      * 24-May-19 04:44 PM
      *
       SET-TAG-COLBUCNC SECTION.
       INI-SET-TAG-COLBUCNC.
           MOVE
           '<IDNMOD NOM=$COLBUCNC$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$24-May-19 04:44 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBUCNC.
           EXIT.
           
       RET-ALL-CNC SECTION.
       INI-RET-ALL-CNC.
           PERFORM KEY-ALL-CNC.
           PERFORM RET-CNC-CNC.
       FIN-RET-ALL-CNC.
           EXIT.
       
       RET-CNC-CNC SECTION.
       INI-RET-CNC-CNC.
           MOVE CNC-CIC-CANC IN CNC-FLD TO CNC-CIC-CANC IN CNC.
           MOVE CNC-EXT-CTAB IN CNC-FLD TO CNC-EXT-CTAB IN CNC.
           MOVE CNC-GLS-DESC IN CNC-FLD TO CNC-GLS-DESC IN CNC.
           MOVE CNC-GLS-ABRV IN CNC-FLD TO CNC-GLS-ABRV IN CNC.
           MOVE CNC-GLS-DCOR IN CNC-FLD TO CNC-GLS-DCOR IN CNC.
           MOVE CNC-IND-VIGE IN CNC-FLD TO CNC-IND-VIGE IN CNC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CNC-NUM-DTRN IN CNC-FLD TO CNC-NUM-DTRN IN CNC.
           MOVE CNC-NUM-MTRN IN CNC-FLD TO CNC-NUM-MTRN IN CNC.
           MOVE CNC-NUM-STRN IN CNC-FLD TO CNC-NUM-STRN IN CNC.
           MOVE CNC-NUM-ATRN IN CNC-FLD TO CNC-NUM-ATRN IN CNC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-RET-CNC-CNC.
           EXIT.
       
       KEY-ALL-CNC SECTION.
       INI-KEY-ALL-CNC.
           PERFORM KEY-CNC-CNC.
       FIN-KEY-ALL-CNC.
           EXIT.
       
       KEY-CNC-CNC SECTION.
       INI-KEY-CNC-CNC.
           MOVE CNC-MSC-TCAN IN CNC-FLD TO CNC-MSC-TCAN IN CNC.
           MOVE CNC-MSC-FCAN IN CNC-FLD TO CNC-MSC-FCAN IN CNC.
           MOVE CNC-MSC-ECAN IN CNC-FLD TO CNC-MSC-ECAN IN CNC.
       FIN-KEY-CNC-CNC.
           EXIT.
       
       SCR-CLRA-CNC SECTION.
       INI-SCR-CLRA-CNC.
           PERFORM CLR-KEY-CNC.
           PERFORM CLR-FLD-CNC.
       FIN-SCR-CLRA-CNC.
           EXIT.
       
       CLR-KEY-CNC SECTION.
       INI-CLR-KEY-CNC.
           MOVE SPACES TO CNC-MSC-TCAN IN CNC-FLD.
           MOVE SPACES TO CNC-MSC-FCAN IN CNC-FLD.
           MOVE SPACES TO CNC-MSC-ECAN IN CNC-FLD.
       FIN-CLR-KEY-CNC.
           EXIT.
       
       CLR-FLD-CNC SECTION.
       INI-CLR-FLD-CNC.
           MOVE SPACES TO FRM-GLS-TCAN IN CNC-FLD.
           MOVE SPACES TO FRM-GLS-FCAN IN CNC-FLD.
           MOVE SPACES TO FRM-GLS-ECAN IN CNC-FLD.
           PERFORM CLR-CNC-CNC.
       FIN-CLR-FLD-CNC.
           EXIT.
       
       CLR-CNC-CNC SECTION.
       INI-CLR-CNC-CNC.
           MOVE SPACES TO CNC-CIC-CANC IN CNC-FLD.
           MOVE SPACES TO CNC-EXT-CTAB IN CNC-FLD.
           MOVE SPACES TO CNC-GLS-DESC IN CNC-FLD.
           MOVE SPACES TO CNC-GLS-ABRV IN CNC-FLD.
           MOVE SPACES TO CNC-GLS-DCOR IN CNC-FLD.
           MOVE SPACES TO CNC-IND-VIGE IN CNC-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CNC-FEC-FTRN IN CNC-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-CNC-CNC.
           EXIT.
       
       FST-KEY-CNC SECTION.
       INI-FST-KEY-CNC.
           MOVE -1 TO CNC-MSC-TCAN-LEN IN CNC-FLD.
       FIN-FST-KEY-CNC.
           EXIT.
       
       FST-FLD-CNC SECTION.
       INI-FST-FLD-CNC.
           MOVE -1 TO CNC-CIC-CANC-LEN IN CNC-FLD.
       FIN-FST-FLD-CNC.
           EXIT.
       
       PRO-KEY-CNC SECTION.
       INI-PRO-KEY-CNC.
           PERFORM PRO-MKY-CNC.
       FIN-PRO-KEY-CNC.
           EXIT.
       
       PRO-MKY-CNC SECTION.
       INI-PRO-MKY-CNC.
       FIN-PRO-MKY-CNC.
           EXIT.
       
       PRO-FLD-CNC SECTION.
       INI-PRO-FLD-CNC.
           PERFORM PRO-CNC-CNC.
       FIN-PRO-FLD-CNC.
           EXIT.
       
       PRO-CNC-CNC SECTION.
       INI-PRO-CNC-CNC.
           MOVE FRM-CPIM-AEY TO CNC-CIC-CANC-ATR IN CNC-FLD.
           MOVE FRM-CPIM-AEY TO CNC-EXT-CTAB-ATR IN CNC-FLD.
           MOVE FRM-CPIM-AEY TO CNC-GLS-DESC-ATR IN CNC-FLD.
           MOVE FRM-CPIM-AEY TO CNC-GLS-ABRV-ATR IN CNC-FLD.
           MOVE FRM-CPIM-AEY TO CNC-GLS-DCOR-ATR IN CNC-FLD.
           MOVE FRM-CPIM-AEY TO CNC-IND-VIGE-ATR IN CNC-FLD.
       FIN-PRO-CNC-CNC.
           EXIT.
       
       UNP-KEY-CNC SECTION.
       INI-UNP-KEY-CNC.
           PERFORM UNP-IKY-CNC.
           PERFORM UNP-AKY-CNC.
           PERFORM UNP-MKY-CNC.
       FIN-UNP-KEY-CNC.
           EXIT.
       
       UNP-IKY-CNC SECTION.
       INI-UNP-IKY-CNC.
           MOVE FRM-CPIM-UBY TO CNC-MSC-TCAN-ATR.
           MOVE FRM-CPIM-UBY TO CNC-MSC-FCAN-ATR.
           MOVE FRM-CPIM-UBY TO CNC-MSC-ECAN-ATR.
       FIN-UNP-IKY-CNC.
           EXIT.
       
       UNP-MKY-CNC SECTION.
       INI-UNP-MKY-CNC.
       FIN-UNP-MKY-CNC.
           EXIT.
       
       UNP-AKY-CNC SECTION.
       INI-UNP-AKY-CNC.
       FIN-UNP-AKY-CNC.
           EXIT.
       
       UNP-FLD-CNC SECTION.
       INI-UNP-FLD-CNC.
           PERFORM UNP-CNC-CNC.
       FIN-UNP-FLD-CNC.
           EXIT.
       
       UNP-CNC-CNC SECTION.
       INI-UNP-CNC-CNC.
           MOVE FRM-CPIM-UBY TO CNC-CIC-CANC-ATR IN CNC-FLD.
           MOVE FRM-CPIM-UBY TO CNC-EXT-CTAB-ATR IN CNC-FLD.
           MOVE FRM-CPIM-UBY TO CNC-GLS-DESC-ATR IN CNC-FLD.
           MOVE FRM-CPIM-UBY TO CNC-GLS-ABRV-ATR IN CNC-FLD.
           MOVE FRM-CPIM-UBY TO CNC-GLS-DCOR-ATR IN CNC-FLD.
           MOVE FRM-CPIM-UBY TO CNC-IND-VIGE-ATR IN CNC-FLD.
       FIN-UNP-CNC-CNC.
           EXIT.
       
       VAL-MKY-CNC SECTION.
       INI-VAL-MKY-CNC.
       FIN-VAL-MKY-CNC.
           EXIT.
       
       VAL-FLD-CNC SECTION.
       INI-VAL-FLD-CNC.
           PERFORM VAL-FRM-GLS-TCAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TCAN-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
           PERFORM VAL-FRM-GLS-FCAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-FCAN-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
           PERFORM VAL-FRM-GLS-ECAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ECAN-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
           PERFORM VAL-CNC-CIC-CANC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CNC-CIC-CANC-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
           PERFORM VAL-CNC-EXT-CTAB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CNC-EXT-CTAB-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
           PERFORM VAL-CNC-GLS-DESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CNC-GLS-DESC-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
           PERFORM VAL-CNC-GLS-ABRV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CNC-GLS-ABRV-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
           PERFORM VAL-CNC-GLS-DCOR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CNC-GLS-DCOR-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
           PERFORM VAL-CNC-IND-VIGE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CNC-IND-VIGE-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CNC-FEC-FTRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CNC-FEC-FTRN-LEN IN CNC-FLD
                GO TO FIN-VAL-FLD-CNC.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-FLD-CNC.
           EXIT.
       
       VAL-FRM-GLS-TCAN SECTION.
       INI-VAL-FRM-GLS-TCAN.
       FIN-VAL-FRM-GLS-TCAN.
           EXIT.
       
       VAL-FRM-GLS-FCAN SECTION.
       INI-VAL-FRM-GLS-FCAN.
       FIN-VAL-FRM-GLS-FCAN.
           EXIT.
       
       VAL-FRM-GLS-ECAN SECTION.
       INI-VAL-FRM-GLS-ECAN.
       FIN-VAL-FRM-GLS-ECAN.
           EXIT.
       
       VAL-CNC-CIC-CANC SECTION.
       INI-VAL-CNC-CIC-CANC.
           IF CNC-CIC-CANC IN CNC-FLD NOT > SPACES
              MOVE SPACES TO CNC-CIC-CANC IN CNC-FLD.
      *<<<<
           IF CNC-CIC-CANC IN CNC-FLD NOT > SPACES
               MOVE CNC-MSC-TCAN IN CNC-FLD TO WSS-CIC-TCAN
               MOVE CNC-MSC-FCAN IN CNC-FLD TO WSS-CIC-FCAN
               MOVE CNC-MSC-ECAN IN CNC-FLD TO WSS-CIC-ECAN
               MOVE WSS-VARI TO CNC-CIC-CANC IN CNC-FLD.
      *>>>>
       FIN-VAL-CNC-CIC-CANC.
           EXIT.
       
       VAL-CNC-EXT-CTAB SECTION.
       INI-VAL-CNC-EXT-CTAB.
           IF CNC-EXT-CTAB IN CNC-FLD NOT > SPACES
              MOVE SPACES TO CNC-EXT-CTAB IN CNC-FLD.
       FIN-VAL-CNC-EXT-CTAB.
           EXIT.
       
       VAL-CNC-GLS-DESC SECTION.
       INI-VAL-CNC-GLS-DESC.
           IF CNC-GLS-DESC IN CNC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CNC-GLS-DESC.
       FIN-VAL-CNC-GLS-DESC.
           EXIT.
       
       VAL-CNC-GLS-ABRV SECTION.
       INI-VAL-CNC-GLS-ABRV.
           IF CNC-GLS-ABRV IN CNC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CNC-GLS-ABRV.
       FIN-VAL-CNC-GLS-ABRV.
           EXIT.
       
       VAL-CNC-GLS-DCOR SECTION.
       INI-VAL-CNC-GLS-DCOR.
           IF CNC-GLS-DCOR IN CNC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CNC-GLS-DCOR.
       FIN-VAL-CNC-GLS-DCOR.
           EXIT.
       
       VAL-CNC-IND-VIGE SECTION.
       INI-VAL-CNC-IND-VIGE.
           IF CNC-IND-VIGE IN CNC-FLD NOT > SPACES
              MOVE SPACES TO CNC-IND-VIGE IN CNC-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'GNS' TO MSC-COD-SIST.
           MOVE 'VIGE' TO MSC-COD-TMSC IN MSC.
           MOVE CNC-IND-VIGE IN CNC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-CNC-IND-VIGE.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CNC-FEC-FTRN SECTION.
       INI-VAL-CNC-FEC-FTRN.
           IF CNC-FEC-FTRN IN CNC-FLD  NOT > ZEROES
              MOVE ZEROES TO CNC-FEC-FTRN IN CNC-FLD.
       FIN-VAL-CNC-FEC-FTRN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CON-FLD-CNC SECTION.
       INI-VAL-CON-FLD-CNC.
       FIN-VAL-CON-FLD-CNC.
           EXIT.
       
       VAL-CON-CNC SECTION.
       INI-VAL-CON-CNC.
       FIN-VAL-CON-CNC.
           EXIT.
       
       VAL-NUM-KEY-CNC SECTION.
       INI-VAL-NUM-KEY-CNC.
           PERFORM VAL-NUM-IKY-CNC.
           PERFORM VAL-NUM-MKY-CNC.
           PERFORM VAL-NUM-AKY-CNC.
       FIN-VAL-NUM-KEY-CNC.
           EXIT.
       
       VAL-NUM-IKY-CNC SECTION.
       INI-VAL-NUM-IKY-CNC.
       FIN-VAL-NUM-IKY-CNC.
           EXIT.
       
       VAL-NUM-MKY-CNC SECTION.
       INI-VAL-NUM-MKY-CNC.
       FIN-VAL-NUM-MKY-CNC.
           EXIT.
       
       VAL-NUM-AKY-CNC SECTION.
       INI-VAL-NUM-AKY-CNC.
       FIN-VAL-NUM-AKY-CNC.
           EXIT.
       
       VAL-NUM-FLD-CNC SECTION.
       INI-VAL-NUM-FLD-CNC.
       FIN-VAL-NUM-FLD-CNC.
           EXIT.
       
       EDT-KEY-CNC SECTION.
       INI-EDT-KEY-CNC.
           PERFORM EDT-IKY-CNC.
           PERFORM EDT-MKY-CNC.
           PERFORM EDT-AKY-CNC.
       FIN-EDT-KEY-CNC.
           EXIT.
       
       EDT-IKY-CNC SECTION.
       INI-EDT-IKY-CNC.
       FIN-EDT-IKY-CNC.
           EXIT.
       
       EDT-MKY-CNC SECTION.
       INI-EDT-MKY-CNC.
       FIN-EDT-MKY-CNC.
           EXIT.
       
       EDT-AKY-CNC SECTION.
       INI-EDT-AKY-CNC.
       FIN-EDT-AKY-CNC.
           EXIT.
       
       EDT-FLD-CNC SECTION.
       INI-EDT-FLD-CNC.
       FIN-EDT-FLD-CNC.
           EXIT.
