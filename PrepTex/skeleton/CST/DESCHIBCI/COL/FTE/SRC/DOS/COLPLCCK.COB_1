       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLCCK.
       AUTHOR.          ADA.
       DATE-WRITTEN.    16-Sep-99 03:41 PM.

      * Programa Listador de Reporte CCK sin Sort.
      *
      * V 1.1.2
      *


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.

            C01 IS SALTO
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT RPTCCK       ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTCCK       ASSIGN TO        UT-S-RPTCCK.
           SELECT RPTCCK       ASSIGN TO        UT-S-RPTCCK.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       FD  RPTCCK LABEL RECORDS OMITTED
           BLOCK CONTAINS 0 RECORDS
           RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-CCK     PIC X(132).

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBRRSC.
       COPY COLRRCCK.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWCCK.
       COPY COLRNCCK.
       COPY COLROCCK.
       COPY GNSWGSYS.
       01  PGM-HRSR-CCK   VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-CCK  VALUE 'S'.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).

      * AQUI EXISTIA LABEL RF INI
      * AQUI EXISTIA LABEL RF FIN
       COPY COLRTCCK.

       PROCEDURE DIVISION.
      *==================

      * AQUI EXISTIA LABEL FIN_DEC INI
      * AQUI EXISTIA LABEL FIN_DEC FIN

       MAIN SECTION.
      *------------
       INI-MAIN.
      *    MOVE SYS-MXFL TO SYS-CMND.
      *    PERFORM GNS-PRO-SYS.
       COPY GNSBGEDB.
      *    MOVE 'COL' TO RPT-SIST.
           MOVE 'COLPLCCK' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
           MOVE 0 TO WSS-TOT-CAPI IN WSS-CCK
                     WSS-TOT-INTE IN WSS-CCK
                     WSS-TOT-REAJ IN WSS-CCK.
           MOVE SPACES TO SRT-COD-TREG IN SRT.
      *>>>>
       INI-INP-SRT.
      *     MOVE 'COLPLCCK' TO RPT-NPGM.
           PERFORM CAL-HDR.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RSC.
       FST-INP-SRT.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-RSC.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
       COPY COLRMCCK.
       INI-OUT-SRT.
           OPEN OUTPUT RPTCCK.
           PERFORM INITIATE-RPTCCK.
           MOVE SRT TO SRT-OLD-CCK.
           MOVE SRT TO SRT-CUR-CCK.
      *    PERFORM CCK-FST-PRO-CTL.
       LUP-MAIN.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
      *<<<< LUP_INP
           IF NOT ( RSC-COD-TREG IN RSC = 0 OR 1 )
               GO TO NXT-INP-SRT.
           IF RSC-COD-TREG IN RSC = 0
               IF WSS-TOT-CAPI IN WSS-CCK > 0 OR
                  WSS-TOT-INTE IN WSS-CCK > 0 OR
                  WSS-TOT-REAJ IN WSS-CCK > 0
                   PERFORM GENERATE-DL-TOT
                   MOVE 0 TO WSS-TOT-CAPI
                             WSS-TOT-INTE
                             WSS-TOT-REAJ.
           IF RSC-COD-TREG IN RSC = 0
               MOVE RSC-GLS-NOMC IN RSC TO SRT-GLS-NOMC IN SRT
               MOVE RSC-NUM-ICLI IN RSC TO SRT-NUM-ICLI IN SRT
               MOVE RSC-VRF-ICLI IN RSC TO SRT-VRF-ICLI IN SRT
               MOVE RSC-IND-ICLI IN RSC TO SRT-IND-ICLI IN SRT
               MOVE RSC-GLS-ICLI IN RSC TO SRT-GLS-ICLI IN SRT
               MOVE RSC-GLS-DIRE IN RSC TO SRT-GLS-DIRE IN SRT
               MOVE RSC-NUM-DINI IN RSC TO SRT-NUM-DINI IN SRT
               MOVE RSC-NUM-MINI IN RSC TO SRT-NUM-MINI IN SRT
               MOVE RSC-NUM-SINI IN RSC TO SRT-NUM-SINI IN SRT
               MOVE RSC-NUM-AINI IN RSC TO SRT-NUM-AINI IN SRT
               MOVE RSC-NUM-DFIN IN RSC TO SRT-NUM-DFIN IN SRT
               MOVE RSC-NUM-MFIN IN RSC TO SRT-NUM-MFIN IN SRT
               MOVE RSC-NUM-SFIN IN RSC TO SRT-NUM-SFIN IN SRT
               MOVE RSC-NUM-AFIN IN RSC TO SRT-NUM-AFIN IN SRT
               MOVE RSC-COD-OFIS IN RSC TO SRT-COD-OFIS IN SRT
               MOVE RSC-GLS-OFIS IN RSC TO SRT-GLS-OFIS IN SRT
               IF SRT-COD-TREG IN SRT =  '1'
                   MOVE '0' TO SRT-COD-TREG IN SRT
                   GO TO NXT-INP-SRT
               ELSE
                   MOVE '1' TO SRT-COD-TREG IN SRT
                   GO TO NXT-INP-SRT.
      *>>>>
       MOV-INP-SRT.
       COPY COLRMCCK.
       LUP-OUT-SRT.
           PERFORM GENERATE-DL-CCK.
      *<<<< FIN_GEN_OUT
           ADD RSC-VAL-CAPI IN SRT TO WSS-TOT-CAPI IN WSS-CCK.
           ADD RSC-VAL-INTE IN SRT TO WSS-TOT-INTE IN WSS-CCK.
           ADD RSC-VAL-REAJ IN SRT TO WSS-TOT-REAJ IN WSS-CCK.
      *>>>>
       NXT-INP-SRT.
       NXT-OUT-SRT.
           MOVE SRT TO SRT-OLD-CCK.
       RET-OUT-SRT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RSC.
           GO TO LUP-MAIN.
       FIN-MAIN.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-RSC.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
           IF WSS-TOT-CAPI IN WSS-CCK > 0 OR
              WSS-TOT-INTE IN WSS-CCK > 0 OR
              WSS-TOT-REAJ IN WSS-CCK > 0
               PERFORM GENERATE-DL-TOT.
      *>>>>
           IF HAY-REGISTROS-EN-SORT-CCK
                PERFORM TERMINATE-RPTCCK.
           CLOSE RPTCCK.
           IF PGM-STAT-SRT-MAL
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       COPY COLIORSC.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGIRH.
       COPY COLRECCK.
      *    16-SEP-99 03:40 PM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
       D-PH-CCK SECTION.
       INI-PH-CCK.
       FIN-PH-CCK.
           EXIT.
       D-DL-CCK SECTION.
       INI-DL-CCK.
       FIN-DL-CCK.
           EXIT.
       D-DL-TOT SECTION.
       INI-DL-TOT.
       FIN-DL-TOT.
           EXIT.
       COPY GNSBGABT.

