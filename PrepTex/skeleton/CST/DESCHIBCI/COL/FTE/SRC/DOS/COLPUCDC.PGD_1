       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   COLPUCDC.
       AUTHOR.       BEE.
       DATE-WRITTEN. 27-Nov-12 02:25 PM.

      * NOMBRE PROGRAMA                   COLPUCDC
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      COLCDC
      * PANTALLA                          COLCDC
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-COLPUCDC-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$COLPUCDC$ SKL=$08.07.21$ VSN=${vsnpu}$        
      -    'GEN=$27-Nov-12 02:25 PM$ FNC=${fncpu}$/>'.    
       COPY GNSWCSCR.
       COPY GNSWVSCR.
      *<<<< FIN_SCR_VARI                                                
       COPY GNSWGRQA REPLACING                                          
                     ==01  ADR-REQA== BY ==02  SCR-RDC-REQA==.          
           02 SCR-KEY-IRDC                     PIC X(03).               
      *>>>>                                                             
      *<<<< FIN_SCR_VARI                                                
       COPY GNSWGRQA REPLACING                                          
                     ==01  ADR-REQA== BY ==02  SCR-RDC-DSC-REQA==.      
       COPY GNSWGRQA REPLACING                                          
                     ==01  ADR-REQA== BY ==02  SCR-RDC-ASC-REQA==.      
      *>>>>                                                             

      *<<<< FIN_SCR_VARI                                                
       COPY GNSWGRQA REPLACING                                          
                     ==01  ADR-REQA== BY ==02  SCR-RDC-REQA==.      
      *>>>>                                                             
       COPY COLWICDC.
       COPY COLBRCDC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.

      *<<<< WSS                                                         
       COPY COLBRRDC.                                                   
       COPY SGCBRDBC.                                                   
       COPY COLBROPC.                                                   
       COPY TABBRVLR.                                                   
       COPY GNSWGCPT.                                                   
       COPY GNSWGPES.                                                   
       01  WSS-VARI.                                                    
           03 WSS-IMAX               VALUE 6          PIC 9(02).        
           03 WSS-NUM-DEUD                            PIC 9(02).        
           03 WSS-KEY-IDLC                            PIC X(15).        
      *>>>>                                                             
      *<<<< WSS_DTC                                                     
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
      *>>>>                                                             
      *<<<<
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).
              05 PGM-STAT-RDC.
                 88 PGM-STAT-RDC-NUL    VALUE '  '.
                 07 PGM-STT1-RDC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RDC-OKS VALUE '0'.
                 07 PGM-STT2-RDC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(1030).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO CDC-FLD.
           MOVE LOW-VALUES TO CDC-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +1030 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'COLPUCDC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *<<<< INI_FIO
           MOVE +1030 TO SCR-TCMA.                                      
           IF SCR-DESDE-CMN                                             
               PERFORM GNS-CLR-RQA.                                     
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-CDC.
           PERFORM EDT-KEY-CDC.
           PERFORM EDT-FLD-CDC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-CDC
               PERFORM EDT-KEY-CDC
               PERFORM EDT-FLD-CDC
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-CDC
               PERFORM EDT-KEY-CDC
           ELSE
               PERFORM CLR-FLD-CDC
               PERFORM EDT-FLD-CDC.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO CDC-FLD.
           MOVE LOW-VALUES TO CDC-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
           PERFORM KEY-ALL-CDC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-ALL-CDC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CDC.
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO CDC.
           PERFORM RET-ALL-CDC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-CDC.
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM KEY-ALL-CDC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-CDC.
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-CDC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-CDC.
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-CDC.
       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE CDC-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO CDC-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-CDC
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CDC-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CDC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CDC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-CDC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CDC
               PERFORM EDT-FLD-CDC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-CDC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-CDC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-CDC.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-CDC.
       ERR-SCR-GFLD.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CDC.
           PERFORM EDT-FLD-CDC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CDC-GLS-MEN2
               MOVE SCR-PRMT     TO CDC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CDC-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-CDC
               PERFORM VAL-NUM-FLD-CDC.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_SCR_GKEY                                 
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>                                                             
      *<<<< PFS_GET_CON                                                 
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )           
      *>>>>                                                             
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CDC-GLS-MEN2
               MOVE SCR-PRMT     TO CDC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CDC-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO CDC-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
           IF SCR-DESDE-CMN
               MOVE CDC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CDC-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-CDC

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CDC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CDC-GLS-MENS.
           PERFORM PRO-FLD-CDC.
           PERFORM PRO-MKY-CDC.
           PERFORM UNP-IKY-CDC.
           PERFORM FST-KEY-CDC.
           MOVE '1' TO FRM-CPIM-AEY.                                    
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
           IF SCR-DESDE-CMN
               MOVE CDC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CDC-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CDC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CDC-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-CDC.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-CDC.
           PERFORM FST-KEY-CDC.
           MOVE '1' TO FRM-CPIM-AEY.                                    
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM UNP-MKY-CDC.
           PERFORM UNP-FLD-CDC.
           PERFORM FST-FLD-CDC.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO CDC-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-CDC.
           PERFORM PRO-FLD-CDC.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CDC
               PERFORM EDT-FLD-CDC
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CDC
               PERFORM EDT-FLD-CDC
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CDC.
           PERFORM EDT-FLD-CDC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-CDC.
           PERFORM PRO-FLD-CDC.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-CDC
               PERFORM EDT-FLD-CDC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CDC-GLS-MEN2
               MOVE SCR-CONF     TO CDC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CDC-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-CDC
               PERFORM VAL-NUM-FLD-CDC
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-CDC
                   PERFORM VAL-NUM-FLD-CDC
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.


       COPY COLBUCDC.
       COPY GNSBVNUM.
       COPY COLBFCDC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
       COPY GNSBGFRM.
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY TABBBOFI.
       COPY TABBFOFI.

      *<<<< EOF                                                         
       RST-STAT SECTION.                                                
       INI-RST-STAT.                                                    
           MOVE SCR-STPP     TO SCR-STAT.                               
           MOVE SCR-MFLD-NOT TO SCR-MFLD.                               
       FIN-RST-STAT.                                                    
           EXIT.                                                        
                                                                        
       GNS-CLR-RQA SECTION.                                             
       INI-GNS-CLR-RQA.                                                 
           MOVE SPACES TO SCR-RDC-REQA.                                 
           MOVE SPACES TO SCR-KEY-IRDC.                                 
       FIN-GNS-CLR-RQA.                                                 
           EXIT.                                                        
      *>>>>                                                             
      *<<<< EOF                                                         
       PUT-TAB-OPE-RDC SECTION.                                         
       INI-PUT-TAB-OPE-RDC.                                             
           MOVE RDC-NUM-DIRE IN RDC TO FRM-NUM-DIRE                     
                                                 IN CDC-FLD(FRM-IFLD).  
           MOVE RDC-VAL-LIMD IN RDC TO FRM-VAL-LIMD                     
                                                 IN CDC-FLD(FRM-IFLD).  
           MOVE WSS-NUM-DEUD        TO FRM-NUM-DEUD                     
                                                 IN CDC-FLD(FRM-IFLD).  
           MOVE RDC-KEY-IRDC IN RDC TO DBC-KEY-IDBC IN DBC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF FIO-STAT-OKS                                              
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI                 
                                                 IN CDC-FLD(FRM-IFLD)   
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI                 
                                                 IN CDC-FLD(FRM-IFLD)   
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI                 
                                                 IN CDC-FLD(FRM-IFLD)   
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI                 
                                                 IN CDC-FLD(FRM-IFLD)   
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                     
               PERFORM CPT-BLKS                                         
               MOVE CPT-STRN TO FRM-GLS-NOMC     IN CDC-FLD(FRM-IFLD)   
           ELSE                                                         
               MOVE ZEROES TO FRM-NUM-ICLI IN CDC-FLD(FRM-IFLD)         
               MOVE SPACES TO FRM-IND-ICLI IN CDC-FLD(FRM-IFLD)         
               MOVE SPACES TO FRM-VRF-ICLI IN CDC-FLD(FRM-IFLD)         
               MOVE SPACES TO FRM-GLS-ICLI IN CDC-FLD(FRM-IFLD)         
               MOVE 'SGC'        TO MSG-COD-SIST                        
               MOVE 'CLI    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC IN MSG TO FRM-GLS-NOMC IN              
                                         CDC-FLD(FRM-IFLD).             
           MOVE RDC-CAI-IOPC IN CDC-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE RDC-IIC-IOPC IN CDC-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM COL-FIO-OPC.                                         
      *DAD  ini 02-MAY-1994                                             
      * Calcula Monto Limite Deuda de Deudor Credito                    
      *     MULTIPLY OPC-VAL-CRED IN OPC BY RDC-VAL-LIMD IN RDC         
      *                       GIVING FRM-VAL-MONL IN CDC-FLD(FRM-IFLD). 
      *     DIVIDE FRM-VAL-MONL IN CDC-FLD(FRM-IFLD) BY 100 GIVING      
      *            FRM-VAL-MONL IN CDC-FLD(FRM-IFLD).                   
           COMPUTE FRM-VAL-MONL IN CDC-FLD(FRM-IFLD) =                  
                   ( OPC-VAL-CRED IN OPC * RDC-VAL-LIMD IN RDC ) / 100. 
      *DAD  fin 02-MAY-1994                                             
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB.                         
           MOVE '0999  '       TO TAB-CIC-CTAB.                         
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT  FIO-STAT-OKS                                         
               MOVE SPACES TO TAB-COD-CTAB IN TAB.                      
           IF TAB-COD-CTAB IN TAB = OPC-COD-VCOC IN CDC-FLD             
               MOVE FRM-VAL-MONL IN CDC-FLD(FRM-IFLD) TO                
                    PES-SGV-DECI IN PES-VARI                            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO                         
                    FRM-VAL-MONL IN CDC-FLD(FRM-IFLD).                  
       FIN-PUT-TAB-OPE-RDC.                                             
           EXIT.                                                        
                                                                        
      * Modulo Programacion Generica para Scroll con PF5(dsc) y PF6(asc)
       SCRL-TAB-RDC SECTION.                                            
       INI-SCRL-TAB-RDC.                                                
           MOVE SPACES TO MSG-COD-MENS.                                 
           IF FRM-FFLD = FRM-FFLD-PF6                                   
               IF FRM-NUM-ICLI IN CDC-FLD(WSS-IMAX) > ZEROES            
                   PERFORM PUT-TAB-ASC                                  
               ELSE                                                     
                   MOVE 'CLI    N+RDC' TO MSG-COD-MENS                  
           ELSE                                                         
      *        IF FRM-FFLD = FRM-FFLD-PF5                               
               IF FRM-NUM-ICLI IN CDC-FLD(1) > ZEROES                   
                   PERFORM PUT-TAB-DSC                                  
               ELSE                                                     
                   MOVE 'CLI    N-RDC' TO MSG-COD-MENS.                 
           IF MSG-COD-MENS > SPACES                                     
               MOVE 'COL'        TO MSG-COD-SIST                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN2.                           
       FIN-SCRL-TAB-RDC.                                                
           EXIT.                                                        
                                                                        
      * Modulo Efectua Llenado de Tabla en Pantalla en Forma Ascendente.
       PUT-TAB-ASC SECTION.                                             
       INI-PUT-TAB-ASC.                                                 
           MOVE FRM-NUM-DEUD IN CDC-FLD(6) TO WSS-NUM-DEUD.             
           MOVE SCR-RDC-ASC-REQA TO ADR-RDC-REQA.                       
           MOVE FIO-KDEF-S TO FIO-KDEF.                                 
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.                             
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM COL-FIO-RDC.                                         
       LUP-PUT-TAB-ASC.                                                 
           IF FIO-STAT-OKS AND                                          
              RDC-CAI-IOPC IN RDC = RDC-CAI-IOPC IN CDC-FLD AND         
              RDC-IIC-IOPC IN RDC = RDC-IIC-IOPC IN CDC-FLD AND         
              RDC-NUM-IDLC IN RDC = RDC-NUM-IDLC IN CDC-FLD             
               MOVE ADR-RDC-REQA TO SCR-RDC-ASC-REQA                    
               IF FRM-IFLD = 0                                          
                   MOVE ADR-RDC-REQA TO SCR-RDC-DSC-REQA                
                   PERFORM CLR-TAB-RDC VARYING FRM-IFLD FROM 1 BY 1     
                                       UNTIL FRM-IFLD > WSS-IMAX        
                   MOVE 1 TO FRM-IFLD                                   
                   ADD 1 TO WSS-NUM-DEUD                                
                   PERFORM PUT-TAB-OPE-RDC                              
               ELSE                                                     
                   ADD 1 TO FRM-IFLD                                    
                   ADD 1 TO WSS-NUM-DEUD                                
                   PERFORM PUT-TAB-OPE-RDC                              
           ELSE                                                         
               IF FRM-IFLD = 0                                          
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'CLI    N+RDC' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MEN2                        
                   GO TO FIN-PUT-TAB-ASC                                
               ELSE                                                     
                   GO TO FIN-PUT-TAB-ASC.                               
           IF FRM-IFLD < WSS-IMAX                                       
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                          
               MOVE FIO-GET-NXT TO FIO-CMND                             
               PERFORM COL-FIO-RDC                                      
               GO TO LUP-PUT-TAB-ASC.                                   
       FIN-PUT-TAB-ASC.                                                 
           EXIT.                                                        
                                                                        
      * Modulo Efectua Llenado de Tabla en Pantalla en Forma Descendente
       PUT-TAB-DSC SECTION.                                             
       INI-PUT-TAB-DSC.                                                 
           MOVE FRM-NUM-DEUD IN CDC-FLD(1) TO WSS-NUM-DEUD.             
           MOVE SCR-RDC-DSC-REQA TO ADR-RDC-REQA.                       
           MOVE FIO-KDEF-S TO FIO-KDEF.                                 
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.                             
           MOVE FIO-GET-PRV TO FIO-CMND.                                
           PERFORM COL-FIO-RDC.                                         
       LUP-PUT-TAB-DSC.                                                 
           IF FIO-STAT-OKS AND                                          
              RDC-CAI-IOPC IN RDC = RDC-CAI-IOPC IN CDC-FLD AND         
              RDC-IIC-IOPC IN RDC = RDC-IIC-IOPC IN CDC-FLD AND         
              RDC-NUM-IDLC IN RDC = RDC-NUM-IDLC IN CDC-FLD             
               MOVE ADR-RDC-REQA TO SCR-RDC-DSC-REQA                    
               IF FRM-IFLD = 0                                          
                   MOVE ADR-RDC-REQA TO SCR-RDC-ASC-REQA                
                   PERFORM CLR-TAB-RDC VARYING FRM-IFLD FROM 1 BY 1     
                                       UNTIL FRM-IFLD > WSS-IMAX        
                   MOVE WSS-IMAX TO FRM-IFLD                            
                   SUBTRACT 1 FROM WSS-NUM-DEUD                         
                   PERFORM PUT-TAB-OPE-RDC                              
               ELSE                                                     
                   SUBTRACT 1 FROM FRM-IFLD                             
                   SUBTRACT 1 FROM WSS-NUM-DEUD                         
                   PERFORM PUT-TAB-OPE-RDC                              
           ELSE                                                         
               IF FRM-IFLD = 0                                          
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'CLI    N-RDC' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MEN2                        
                   GO TO FIN-PUT-TAB-DSC                                
               ELSE                                                     
                   GO TO FIN-PUT-TAB-DSC.                               
           IF FRM-IFLD > 1                                              
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                          
               MOVE FIO-GET-PRV TO FIO-CMND                             
               PERFORM COL-FIO-RDC                                      
               GO TO LUP-PUT-TAB-DSC.                                   
       FIN-PUT-TAB-DSC.                                                 
           EXIT.                                                        
                                                                        
       LEE-NXT-OR-PRV SECTION.                                          
       INI-LEE-NXT-OR-PRV.                                              
           IF RDC-KEY-IDLC IN RDC > SPACES                              
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM COL-FIO-RDC                                      
               IF FIO-STAT-OKS                                          
                   IF FRM-FFLD = FRM-FFLD-PF7                           
                       PERFORM LEE-PRV-RDC                              
                   ELSE                                                 
                       PERFORM LEE-NXT-RDC                              
               ELSE                                                     
                   IF FRM-FFLD = FRM-FFLD-PF7                           
                       MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                  
                       MOVE FIO-GET-LEQ TO FIO-CMND                     
                       MOVE '00'        TO FIO-STAT                     
                   ELSE                                                 
                       MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                  
                       MOVE FIO-GET-NLS TO FIO-CMND                     
                       MOVE '00'        TO FIO-STAT                     
           ELSE                                                         
               IF FRM-FFLD = FRM-FFLD-PF7                               
                   MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                      
                   MOVE FIO-GET-LEQ TO FIO-CMND                         
                   MOVE '00'        TO FIO-STAT                         
               ELSE                                                     
                   MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                      
                   MOVE FIO-GET-NLS TO FIO-CMND                         
                   MOVE '00'        TO FIO-STAT.                        
           IF NOT FIO-STAT-OKS                                          
               MOVE FIO-STAT TO PGM-STAT-RDC                            
               GO TO FIN-LEE-NXT-OR-PRV                                 
           ELSE                                                         
               PERFORM COL-FIO-RDC                                      
               MOVE FIO-STAT TO PGM-STAT-RDC.                           
       FIN-LEE-NXT-OR-PRV.                                              
           EXIT.                                                        
       LEE-PRV-RDC SECTION.                                             
       INI-LEE-PRV-RDC.                                                 
       LUP-LEE-PRV-RDC.                                                 
           IF RDC-CAI-IOPC IN RDC = RDC-CAI-IOPC IN CDC-FLD AND         
              RDC-IIC-IOPC IN RDC = RDC-IIC-IOPC IN CDC-FLD AND         
              RDC-NUM-IDLC IN RDC = RDC-NUM-IDLC IN CDC-FLD AND         
              FIO-STAT-OKS                                              
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                          
               MOVE FIO-GET-PRV TO FIO-CMND                             
               PERFORM COL-FIO-RDC                                      
               GO TO LUP-LEE-PRV-RDC                                    
           ELSE                                                         
               IF NOT FIO-STAT-OKS                                      
                   GO TO FIN-LEE-PRV-RDC                                
               ELSE                                                     
                   MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                      
                   MOVE FIO-GET-KEY TO FIO-CMND.                        
       FIN-LEE-PRV-RDC.                                                 
           EXIT.                                                        
       LEE-NXT-RDC SECTION.                                             
       INI-LEE-NXT-RDC.                                                 
       LUP-LEE-NXT-RDC.                                                 
           IF RDC-CAI-IOPC IN RDC = RDC-CAI-IOPC IN CDC-FLD AND         
              RDC-IIC-IOPC IN RDC = RDC-IIC-IOPC IN CDC-FLD AND         
              RDC-NUM-IDLC IN RDC = RDC-NUM-IDLC IN CDC-FLD AND         
              FIO-STAT-OKS                                              
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                          
               MOVE FIO-GET-NXT TO FIO-CMND                             
               PERFORM COL-FIO-RDC                                      
               GO TO LUP-LEE-NXT-RDC                                    
           ELSE                                                         
               IF NOT FIO-STAT-OKS                                      
                   GO TO FIN-LEE-NXT-RDC                                
               ELSE                                                     
                   MOVE 'RDC-KEY-IDLC' TO FIO-AKEY                      
                   MOVE FIO-GET-KEY TO FIO-CMND.                        
       FIN-LEE-NXT-RDC.                                                 
           EXIT.                                                        
                                                                        
      * Modulo Limpia Campos de Tabla en Pantalla.                      
       CLR-TAB-RDC SECTION.                                             
       INI-CLR-TAB-RDC.                                                 
           MOVE ZEROES TO FRM-NUM-DEUD IN CDC-FLD(FRM-IFLD).            
           MOVE ZEROES TO FRM-NUM-ICLI IN CDC-FLD(FRM-IFLD).            
           MOVE SPACES TO FRM-IND-ICLI IN CDC-FLD(FRM-IFLD).            
           MOVE SPACES TO FRM-VRF-ICLI IN CDC-FLD(FRM-IFLD).            
           MOVE SPACES TO FRM-GLS-ICLI IN CDC-FLD(FRM-IFLD).            
           MOVE ZEROES TO FRM-VAL-LIMD IN CDC-FLD(FRM-IFLD).            
           MOVE ZEROES TO FRM-VAL-MONL IN CDC-FLD(FRM-IFLD).            
           MOVE ZEROES TO FRM-NUM-DIRE IN CDC-FLD(FRM-IFLD).            
           MOVE SPACES TO FRM-GLS-NOMC IN CDC-FLD(FRM-IFLD).            
       FIN-CLR-TAB-RDC.                                                 
           EXIT.                                                        
                                                                        
       COPY SGCBFDBC.                                                   
       COPY COLBFOPC.                                                   
       COPY GNSBGPES.                                                   
       COPY TABBFVLR.                                                   
       COPY GNSBVTAB.                                                   
       COPY TABBVOFI.                                                   
       COPY GNSBVCOD.                                                   
       COPY SGCBGCLI.                                                   
       COPY GNSBGCPT.                                                   
       COPY GNSBEGLS.                                                   
       COPY COLBFRDC.                                                   
      *>>>>                                                             
