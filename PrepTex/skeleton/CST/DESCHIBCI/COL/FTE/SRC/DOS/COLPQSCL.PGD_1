       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   COLPQSCL.
       AUTHOR.       BEE.
       DATE-WRITTEN. 26-Aug-19 03:21 PM.

      * NOMBRE PROGRAMA                   COLPQSCL
      * VERSION PGM                       3.1
      * VERSION SKL                       19.04.15
      * OPCION                            CON
      * ARCHIVO BASE                      COLOPC
      * PANTALLA                          COLSCL
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *------------------------------------------------------------
      *PROYECTO : LIQUIDACION Y DETALLES DE CREDITOS EN LA WED
      *OBJETIVO : CONSULTAR LIQUIDACION DE CURSES Y CANCELACIONES
      *PARAMETROS DE ENTRADA : NRO. OPERACION Y TIPO FORMULARIO
      *ENTIDADES DE COL, SGC Y TAB SOLO CONSULTA
      *FECHA : 18-OCT-2010
      *AUTOR : PAULINA VENEGAS (BEE TEAM)
      *------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: REBAJAR TASAS
      *PROYECTO: REBAJA DE TASAS OPERACIONES CAE
      *FECHA   : JUNIO DE 2012
      *AUTOR   : CHC
      *ETIQUETA: *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/06-2012
      *------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: MONSTRAR COMISION EN CAMPO SEPARADO
      *PROYECTO: COMISIONES CAE
      *FECHA   : MARZO DE 2014
      *AUTOR   : OGB
      *ETIQUETA: *OGB-INI/COMISIONES CAE/OGB/03-2014
      *------------------------------------------------------------
      *  AUTOR           : BEE-TEAM
      *  FECHA           : 23-07-2014
      *  MOTIVO          : TRANSACCIONES LENTAS
      *  CAMBIO          : SE REEMPLAZA RUTINA COL-OBT-VEN
      *  ID              : RGD-INI 23-JUL-2014 TRANSACCIONES LENTAS
      *************************************************************+
      * PROYECTO : COMISION CAE003
      * RESPONSABLE: AFRI-CGC
      * FECHA 29-AGO-2016
      * ETIQUETA : *AFRI-INI 29-AGO-2016 COMISION CAE003
      *-----------------------------------------------------------------

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-COLPQSCL-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$COLPQSCL$ SKL=$19.04.15$ VSN=$10.09.28.1$        
      -    'GEN=$26-Aug-19 03:21 PM$ FNC=$COlOCACION$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< MI_COMMAREA
           03 CMA-VARI.
              05 SCR-IMAX      COMP                   PIC S9(04).
              05 SCR-I         COMP                   PIC S9(04).
      *>>>>
       COPY COLWISCL.

       COPY COLBROPC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGSYS.

      *<<<< WSS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CMT-REQA==.
       COPY GNSBRCMT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.

       COPY COLWGLCA.
       COPY COLWGLCU.
      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/06-2012
       COPY COLWGRT4.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/06-2012
       COPY COLWGLIC.
       COPY SGCBRDCP.
      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/06-2012
       COPY COLBRCXE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CXE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-BDO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTT-REQA==.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/06-2012
       COPY GNSWGCPT.
       COPY COLWXSCL.
       COPY COLBRCAN.
       COPY LDCBRLCC.
       COPY LDCBRRLO.
       COPY SGCBRRCD.
       COPY SGCBRDCE.
       COPY COLRWLC1.
       COPY COLRWLC2.
       COPY COLRWLI1.
       COPY COLRWLI2.
       COPY COLRWC1V.
       COPY COLRWCDP.
       COPY COLRWDDD.
       COPY COLRWLIT.
       COPY COLRNLI1.
       COPY COLROLI1.
       COPY GNSWGRPT.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRRCE.
       COPY GNSWGPES.
       COPY TABBRCAM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSBRCMT.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRROC.
       COPY TABBRVLR.
       COPY COLBRDLC.
       COPY COLBRRDC.
       COPY COLBRICG.
      *COPY COLRRLC1.
      *COPY COLRRLI1.
      *COPY COLRTLC1.
      *COPY COLRTLC2.
      *COPY COLRTLI1.
      *COPY COLRTLI2.
       COPY COLBRITR.
       COPY SGCBRDBC.
       COPY SGCBRAEP.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.

       COPY GNSWGHOY.
       COPY GNSWGFEC.
       COPY GNSWGBAR.
       COPY COLBRCOM.
       COPY COLBREVC.
       COPY COLBRCYA.
       COPY COLBRPCP.
       COPY COLBRRCV.
       COPY COLBRTOC.
       COPY COLBRVEN.
       COPY COLBRROV.
       COPY COLBRPOC.
       COPY COLBRDIC.
       COPY COLWGINT.
       COPY COLWGPCP.
       COPY COLWGVEN.
      * RGD-INI 23-JUL-2014 TRANSACCIONES LENTAS
       COPY COLWGVE3.
      * RGD-FIN 23-JUL-2014
       COPY COLWGCXE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AEP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RLO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CMT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.

       01  SRT.
           05 WSS-GLS-COOC PIC X(40).
           05 DBC-GLS-NOMC PIC X(58).
           05 SRT-IND-MULT PIC X.
           05 RCD-GLS-DIRE PIC X(45).
           05 DBC-NUM-ICLI PIC 9(8).
           05 DBC-VRF-ICLI PIC X.
           05 DBC-IND-ICLI PIC X.
           05 DBC-GLS-ICLI PIC X(3).
           05 WSS-GLS-COMU PIC X(40).
           05 RCD-NUM-FONO PIC X(12).
           05 OPC-CIC-IOPC.
              07 OPC-CAI-IOPC PIC X(04).
              07 OPC-IIC-IOPC PIC X(08).
           05 OPC-VAL-SEGP PIC 99999999999V9999.
           05 OPC-COD-OFOC PIC X(3).
           05 OPC-NUM-DCOL PIC 9(2).
           05 OPC-NUM-MCOL PIC 9(2).
           05 OPC-NUM-SCOL PIC 9(2).
           05 OPC-NUM-ACOL PIC 9(2).
           05 OPC-SGV-VCOM PIC S99999999999V9999.
           05 OPC-VAL-GAST PIC 99999999999V9999.
           05 OPC-VAL-SEGD PIC 99999999999V9999.
           05 OPC-COD-RMOC PIC X(12).
           05 OPC-NUM-VCVG PIC 9(3).
           05 OPC-COD-VCOC PIC X(6).
           05 TOC-MSC-OPEC PIC X.
           05 OPC-VAL-CRED PIC 99999999999V9999.
           05 OPC-SGV-LIQU PIC S99999999999V9999.
           05 SRT-COD-TDIR PIC X(1).
           05 OPC-COD-SEGD PIC X(09).
           05 OPC-VAL-SEGC PIC 99999999999V9999.
           05 OPC-COD-TOOC PIC X(03).
      *----------------------------------------------
           05 SRT-COD-OFOC PIC X(3).
      *    05 DBC-GLS-NOMC PIC X(58).
      *    05 RCD-GLS-DIRE PIC X(60).
      *    05 DBC-NUM-ICLI PIC 9(8).
      *    05 DBC-VRF-ICLI PIC X.
      *    05 DBC-IND-ICLI PIC X.
      *    05 DBC-GLS-ICLI PIC X(3).
           05 WSS-GLS-LUGA PIC X(37).
           05 RCD-GLS-FONO PIC X(12).
           05 CAN-CAI-IOPC PIC X(4) JUSTIFIED RIGHT.
           05 CAN-IIC-IOPC PIC X(8).
           05 CAN-NUM-ICAN PIC 9(3).
           05 SRT-GLS-ICAN PIC X(15).
           05 CAN-NUM-DCAN PIC X(2).
           05 CAN-NUM-MCAN PIC X(2).
           05 CAN-NUM-SCAN PIC X(2).
           05 CAN-NUM-ACAN PIC X(2).
           05 CAN-COD-OFCA PIC X(3).
           05 CAN-COD-RCAN PIC X(12).
           05 CAN-MSC-TCAN PIC X.
           05 CAN-MSC-FCAN PIC X.
           05 CAN-MSC-ECAN PIC X.
      *    05 OPC-NUM-DCOL PIC X(2).
      *    05 OPC-NUM-MCOL PIC X(2).
      *    05 OPC-NUM-SCOL PIC X(2).
      *    05 OPC-NUM-ACOL PIC X(2).
      *    05 OPC-COD-VCOC PIC X(6).
           05 OPC-COD-COOC PIC X(6).
      *    05 TOC-MSC-OPEC PIC X(4).
           05 CAN-SGV-GAST PIC S99999999999V9999.
           05 CAN-SGV-COMI PIC S99999999999V9999.
           05 CAN-SGV-TPAG PIC S99999999999V9999.
           05 CAN-SGV-TREN PIC S99999999999V9999.
           05 CAN-SGV-DIFE PIC S99999999999V9999.
      *    05 SRT-COD-TDIR PIC X.
      *---------------------------------------

       01  WSS-VARI.
      *--------VAR DE LCC --------*
           03  WSS-GLS-DIRE                          PIC X(45).
           03  WSS-GLS-NOMC                          PIC X(75).
           03  WSS-NUM-ICLI                          PIC X(13).
           03  WSS-VRF-ICLI                          PIC X(01).
           03  WSS-NUM-FONO                          PIC X(12).
           03  WSS-VAL-CMFG                          PIC S9(11)V9(04).
           03  WSS-OPEC       VALUE SPACES           PIC X(01).
           03  WSS-SGV-LIQU             COMP-3       PIC 9(11)V9(4).
           03  WSS-SGV-CAPI             COMP-3       PIC S9(11)V9(4).
           03  WSS-SGV-FINA             COMP-3       PIC S9(11)V9(4).
           03  WSS-SGV-FNAL             COMP-3       PIC S9(11)V9(4).
           03  WSS-NUM-IVCT                          PIC 9(03).
           03  WSS-COD-VCOC.
               05  WSS-MSC-TVOC                      PIC X(01).
               05  WSS-COD-CVOC                      PIC X(03).
               05  WSS-COD-TCOC                      PIC X(02).
           03  WSS-CIC-MRXL                          PIC X(12).
           03  WSS-DCO-MRXL                          PIC X(12).
           03  WSS-DES-MRXL                          PIC X(40).
           03  WSS-ABR-MRXL                          PIC X(05).
           03  WSS-CIC-VCOC                          PIC X(06).
           03  WSS-DCO-VCOC                          PIC X(12).
           03  WSS-ABR-VCOC                          PIC X(40).
           03  WSS-COD-TVOC.
               05  WSS-MSC-TVAL                      PIC X(01).
               05  WSS-MSC-REST                      PIC X(04).
           03  WSS-DCO-TCYA                          PIC X(12).
      *    03  WSS-ABR-TCYA                          PIC X(05).
           03  WSS-DES-M6AL                          PIC X(40).
           03  WSS-NUM-ICYA                          PIC 9(06).
           03  WSS-IMAX                VALUE 5       PIC 9(02).
           03  WSS-ABR-MOV                           PIC X(05).
           03  WSS-GLS-SPAC            VALUE SPACES  PIC X(01).

           03  WSS-COD-VCAM.
               05  WSS-COD-TVTI                      PIC X(01).
               05  WSS-COD-CVTI                      PIC X(03).
               05  WSS-COD-TCTI                      PIC X(02).
           03  WSS-GLS-ICAN.
      *        05  WSS-CIC-ICAN                      PIC X(12).
               05  WSS-NUM-ICAN                      PIC 9(03).
           03  WSS-IND-SEL1                          PIC X(01).
           03  RPT-LCA-LINE-COUNTER   VALUE ZEROES   PIC 9(05).
           03  RPT-LCB-LINE-COUNTER   VALUE ZEROES   PIC 9(05).
           03  RPT-LCD-LINE-COUNTER   VALUE ZEROES   PIC 9(05).
           03  WSS-IND-TBUS           VALUE SPACES   PIC X(01).
           03  WSS-AUX-OFOC.
               05  WSS-AUX-OF1        VALUE SPACES   PIC X(01).
               05  WSS-AUX-OF2        VALUE SPACES   PIC X(03).
           03  WSS-FEC-FCMP.
               05  WSS-NUM-SCMP                      PIC 9(02).
               05  WSS-NUM-ACMP                      PIC 9(02).
               05  WSS-NUM-MCMP                      PIC 9(02).
               05  WSS-NUM-DCMP                      PIC 9(02).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-DTER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
           03  WSS-COD-OFIC           VALUE SPACES   PIC X(03).
           03  WSS-COD-OFOC           VALUE SPACES   PIC X(03).
           03  WSS-COD-LUGA.
               05 WSS-COD-COMU                       PIC X(04).
               05 WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
                  07 WSS-IND-PAIS                    PIC X(01).
                  07 WSS-COD-PAIS                    PIC X(03).
           03 WSS-FEC-FBAS.
              05 WSS-NUM-DBAS                        PIC 9(02).
              05 FILLER               VALUE '-'      PIC X(01).
              05 WSS-NUM-MBAS                        PIC 9(02).
              05 FILLER               VALUE '-'      PIC X(01).
              05 WSS-NUM-SBAS                        PIC 9(02).
              05 WSS-NUM-ABAS                        PIC 9(02).
           03 WSS-COD-COOC.
              05 WSS-COD-TOOC                        PIC X(03).
              05 WSS-COD-AOOC                        PIC X(03).
           03 WSS-GLS-DATA.
              05 WSS-GLS-TIO                         PIC X(40).
              05 WSS-GLS-AUX                         PIC X(40).
           03 WSS-COD-TINT                           PIC X(12).
           03 WSS-SGV-MCAN           COMP-3          PIC S9(11)V9(04).
           03 WSS-SGV-MORA           COMP-3          PIC 9(11)V9(04).
           03 WSS-IND-FCYA                           PIC 9(01).
           03 WSS-IND                                PIC 9(02).
           03 WSS-GLS-MAIL.
              05 WSS-GLS-MAI1.
                 07 WSS-IND-MAI1     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI2.
                 07 WSS-IND-MAI2     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI2B.
                 07 WSS-IND-MAI2B    OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI3.
                 07 WSS-IND-MAI3     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI4.
                 07 WSS-IND-MAI4     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI5.
                 07 WSS-IND-MAI5     OCCURS 40       PIC X(01).
           03  WSS-NUM-PAGI           VALUE ZEROES   PIC 9(05).
           03  WSS-GLS-NOMSUC.
               05 WSS-GLS-NOMS        VALUE SPACES   PIC X(37).
               05 WSS-GLS-SUCU        VALUE SPACES   PIC X(03).
      * Variable que permite buscar en estructura
           03   TDD-DAUX                             PIC X(01).
           03   TDD-IAUX                             PIC 9(03).
           03   TDD-IDX                              PIC 9(01).
           03   TDD-VAR-AUX                          PIC X(01).
           03   TDD-VAR-AUX2                         PIC X(01).
      * Estrucura tipo_direccion/tipo_entrega
           03  TDD-DIRE OCCURS 20 INDEXED BY TDD-INTB.
               05  TDD-REL.
                   07  TDD-TDIR                      PIC X(01).
                   07  TDD-ENTR                      PIC X(01).
           03  WSS-NUM-ROFM           VALUE ZEROES   PIC 9(04).
           03  WSS-NUM-ROFC           VALUE ZEROES   PIC 9(04).
           03  WSS-NUM-REGM           VALUE ZEROES   PIC 9(04).
           03  WSS-NUM-REGC           VALUE ZEROES   PIC 9(04).

           03  WSS-NUM-NVTV  VALUE ZEROES     PIC 9(03).
           03  WSS-MSG-MENS.
               05  WSS-MSG-COOC.
                   07 WSS-MSG-TOOC            PIC X(03).
                   07 WSS-MSG-AOOC            PIC X(03).
               05  WSS-MSG-BALL               PIC X(06).
           03  WSS-GLS-MSJT.
               05 WSS-GLS-MSJT1               PIC X(40).
               05 WSS-GLS-MSJT2               PIC X(60).
               05 WSS-GLS-MSJT3               PIC X(40).
               05 WSS-GLS-MSJT4               PIC X(60).
           03  WSS-GLS-MSJB.
               05 WSS-GLS-MSJB1               PIC X(70).
               05 WSS-GLS-MSJB2               PIC X(70).
               05 WSS-GLS-MSJB3               PIC X(70).

          03 WSS-ENTRADA.
             05 WSS-CIC-IOPC.
                07 WSS-CAI-IOPC                        PIC X(04).
                07 WSS-IIC-IOPC                        PIC X(08).
             05 WSS-CIC-ICAN.
                07 WSS-CAI-ICAN                        PIC X(04).
                07 WSS-IIC-ICAN                        PIC X(08).
      *      05 WSS-CIC-IOPC                           PIC X(12).

          03 WSS-VAL-EDT                PIC  ZZ.ZZZ.ZZZ.ZZ9,9999.
          03 WSS-VAL-EDT-SG             PIC   -----.---.--9,99.
          03 WSS-VAL-EDT-SG2            PIC   -----.---.--9,9999.
          03 WSS-VAL-ED2                PIC          ZZ.ZZ9,9999.
          03 WSS-VAL-ED3                PIC          --.--9,9999.
          03 WSS-VAL-ED4                PIC     ZZZZZ.ZZZ.ZZ9,99.
          03 WSS-VAL-ED5                PIC      Z.ZZ9,9999.
          03 WSS-SGV-VAL                        PIC S9(11)V9(04).
          03 WSS-FEC-FFEC.
             05 WSS-NUN-DFEC                           PIC 9(02).
             05 WSS-GLS-DIG1                           PIC X(01).
             05 WSS-NUN-MFEC                           PIC 9(02).
             05 WSS-GLS-DIG2                           PIC X(01).
             05 WSS-NUN-SFEC                           PIC 9(02).
             05 WSS-NUN-AFEC                           PIC 9(02).
          03 WSS-CONT      VALUE ZEROES                PIC 9(06).
          03 WSS-CANT      VALUE ZEROES                PIC 9(06).
          03 WSS-NUMB      VALUE ZEROES                PIC 9(06).
          03 WSS-NUM-REG-4                             PIC 9(06).
          03 WSS-IND-BUS   VALUE SPACES                PIC X(01).
      *   03 WSS-COD-TBAN  VALUE SPACES                PIC X(03).
          03 WSS-COD-AGTA.
             05 WSS-TIP-AGTA                           PIC X(03).
             05 WSS-STP-AGTA                           PIC X(03).

          03 WSS-COD-ABOG.
             05 WSS-COD-TIAB                           PIC X(03).
             05 WSS-COD-VIAB                           PIC X(03).

          03 WSS-COD-TASA                              PIC X(06).
          03 WSS-COD-NOTA                              PIC X(06).
          03 WSS-NUM-L010                              PIC 9(10).
          03 WSS-CIC-ICLI                              PIC X(12).
          03 WSS-CANT-GER    VALUE ZEROES              PIC 9(03).
          03 WSS-GLS-L020                              PIC X(20).
          03 WSS-CON-VEN                 VALUE 0       PIC 9(03).
          03 WSS-IVEN-MAS1               VALUE 0       PIC 9(03).

          03 WSS-NUM-IMPA                VALUE 0       PIC 9(03).
          03 WSS-FEC-FMOR                VALUE 0       PIC 9(08).

      *--------INI-VAR DE LIC --------*
           03  WSS-GLS-SCPT   VALUE SPACES           PIC X(12).
           03  WSS-GLS-DATT.
               05  WSS-COD-DATT     OCCURS 10     PIC X(03).
           03  WSS-IND-FLAG           VALUE 0          PIC 9(01).
           03  WSS-SGV-CACU                            PIC S9(11)V9(4).
           03 WSS-COD-CCM.
              05 WSS-COD-TBAN                         PIC X(03).
              05 WSS-NUM-TRAM                         PIC 9(03).
              05 WSS-VAL-TRAM                         PIC 9(06).
           03 WSS-CXE-VCUR-R     COMP-3         PIC S9(13)V9(04).

           03  WSS-VAL-SMO7                            PIC S9(11)V9(4).
           03  WSS-VAL-SMO8                            PIC S9(11)V9(4).
           03  WSS-VAL-SMO9                            PIC S9(11)V9(4).
           03  WSS-VAL-SM10                            PIC S9(11)V9(4).
           03  WSS-VAL-SVEN                            PIC S9(11)V9(4).
           03  WSS-COD-TCVE                          PIC X(02).
           03  SAL-SGV-SPRD   VALUE 0               PIC S9(03)V9(4).
           03  SAL-SGV-TINT   VALUE 0               PIC S9(03)V9(4).
           03  WSS-FACTOR     VALUE 0               PIC 9(03).
           03  WSS-INT-TIPE               COMP-3     PIC 9(03)V9(08).
           03  WSS-GLS-TBA1   VALUE SPACES           PIC X(01).
           03  WCC-P          VALUE 'P'              PIC X(01).
           03  WSS-NUM-RENO                          PIC 9(03).
      *    03  WSS-GLS-TIAU.
      *        05 WSS-GLS-TIO-LCU                    PIC X(40).
      *        05 WSS-GLS-AUX-LCU                    PIC X(40).
           03  WSS-NUM-PAGE             VALUE 1      PIC 9(03).
           03  WSS-IND-DULT                          PIC X(01).
           03  WSS-COD-OPEC                          PIC X(01).
           03  WSS-VAL-VCAM     VALUE 0 COMP-3       PIC S9(11)V9(04).
           03  WSS-ABR-CVTI                          PIC X(05).

           03  WSS-SGV-TNUM                          PIC S9(04)V9(04).
           03  WSS-RED-TNUM REDEFINES WSS-SGV-TNUM.
               05 WSS-ENT-TNUM                       PIC S9(04).
               05 WSS-DEC-TNUM                       PIC V9(04).
           03  WSS-SGV-TEDT.
               05 WSS-EED-TEDT                       PIC ---9.
               05 WSS-GLS-TEDT                       PIC X(01).
               05 WSS-DED-TEDT                       PIC V9(04).
      *    03  WSS-SGV-LIQU               COMP-3     PIC 9(11)V9(4).
           03  WSS-GLS-BLKS             VALUE SPACES PIC X(01).
           03  WSS-SGV-VCAM               COMP-3     PIC S9(11)V9(4).
           03  WSS-NUM-LIDD             VALUE 64     PIC 9(02).
           03  WSS-NUM-LICD             VALUE 69     PIC 9(02).
      *    03  WSS-GLS-SPAC             VALUE SPACES PIC X(01).
           03  WSS-IND-SEL1                          PIC X(01).
           03  WSS-FEC-FCMP.
               05  WSS-NUM-SCMP                      PIC 9(02).
               05  WSS-NUM-ACMP                      PIC 9(02).
               05  WSS-NUM-MCMP                      PIC 9(02).
               05  WSS-NUM-DCMP                      PIC 9(02).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-DTER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
           03  WSS-COD-OFIC             VALUE SPACES PIC X(03).
           03  WSS-COD-OFOC             VALUE SPACES PIC X(03).
           03  WSS-COD-TDOC                          PIC X(03).
           03  WSS-ABR-TVLI                          PIC X(05).
           03  WSS-DCO-TVLI                          PIC X(12).
           03  WSS-DES-TVLI                          PIC X(40).
           03  WSS-CIC-TVLI                          PIC X(05).
           03  WSS-DAT-TVLI                          PIC X(12).
           03  WSS-DES-M4AL                          PIC X(40).
           03  WSS-COD-DLTR                          PIC X(12).
           03  WSS-TOT-INTE                          PIC 9(11)V9(04).
           03  WSS-COD-BCTI                          PIC X(12).
      *    03  WSS-NUM-ICYA                          PIC 9(03).
      *    03  WSS-IMAX                 VALUE 4      PIC 9(02).
           03  WSS-DCO-TCYA                          PIC X(12).
           03  WSS-ABR-TCYA                          PIC X(05).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC-LCU                  PIC X(03).
               05  WSS-COD-AOOC-LCU                  PIC X(03).
      *    03 WSS-COD-LUGA.
      *        05 WSS-COD-COMU                       PIC X(04).
      *        05 WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
      *           07 WSS-IND-PAIS                    PIC X(01).
      *           07 WSS-COD-PAIS                    PIC X(03).

           03  RPT-LIA-LINE-COUNTER VALUE ZEROES     PIC 9(02).
           03  RPT-LIB-LINE-COUNTER VALUE ZEROES     PIC 9(02).
           03  RPT-LID-LINE-COUNTER VALUE ZEROES     PIC 9(02).
           03  RPT-LI1-LINE-DISP    VALUE ZEROES     PIC 9(02).
           03  RPT-LIA-LINE-DISP    VALUE ZEROES     PIC 9(02).
           03  RPT-LIB-LINE-DISP    VALUE ZEROES     PIC 9(02).
           03  RPT-LID-LINE-DISP    VALUE ZEROES     PIC 9(02).
           03  WSS-IND-MENS   VALUE SPACES           PIC X(01).
           03  WSS-IND-ERROR  VALUE SPACES          PIC X(01).
           03  WSS-IND-EBAN                            PIC X(01).
           03  WSS-COD-BANC                            PIC X(03).
           03 WSS-GLS-CCM.
              05 WSS-GLS-TBAN                          PIC X(03).
              05 WSS-GLS-NTRA                          PIC X(03).
              05 WSS-GLS-VTRA                          PIC X(06).
      *OGB-INI/COMISIONES CAE/OGB/03-2014
            03 WSS-VAL-CAC                        PIC S9(11)V9(4).
            03 WSS-VAL-CORG                       PIC S9(11)V9(4).
            03 WS-CIC-IOPC.
               05 WS-CAI-IOPC                       PIC X(04).
               05 WS-IIC-IOPC                       PIC X(08).
            03 WSS-CTE-CAC           VALUE 'CAC'    PIC X(03).
            03 WSS-CTE-CPTO          VALUE 'CCMCAC' PIC X(06).
            03 WSS-CTE-CAE           VALUE 'CAE'    PIC X(03).
            03 WSS-CTE-F001          VALUE 'F001'   PIC X(04).
            03 WSS-CTE-F002          VALUE 'F002'   PIC X(04).
      *OGB-FIN/COMISIONES CAE/OGB/03-2014
      *AFRI-INI 29-AGO-2016 COMISION CAE003
            03 WSS-IND-PEP           VALUE SPACES   PIC X(01).
      *AFRI-FIN 29-AGO-2016 COMISION CAE003

           03 DL-MENSAJE3.
              05 FILLER   PIC X(1) VALUE  '1'.
              05 C1V-MEN3 PIC X(70) VALUE SPACES.

       01   FGP-VARI.
      *INDICADOR DE COBRO DE COMISION FOGAPE 1
             03 FGP-IND-COMI    VALUE SPACES               PIC X(01).
      *INDICADOR DE COBRO DE COMISION FOGAPE 2
             03 FGP-IND-COB                                PIC X(01).
      *INDICADOR COMO OPERA
             03 FGP-OPEC                                   PIC X(01).
      *INDICADOR DE PESO
             03 FGP-CIC-TVAL                               PIC X(01).
      *SALDO DEL CREDITO 1
             03 FGP-VAL-SCRE                         PIC S9(11)V9(4).
      *SALDO DEL CREDITO 2
             03 FGP-VAL-SCR2                         PIC S9(10)V9(2).
      *CONTADOR
             03 FGP-IFLD                                   PIC 9(08).
      *INDICADOR DE COBRO O NO COBRO DE COMISION FOGAPE
             03 FGP-GLS-NOCO                               PIC X(10).
      *SALDO DEL CREDITO POR EL PORCENTAJE GARANTIZADO
             03 FGP-VAL-SGAR                         PIC S9(11)V9(4).
      *SGAR POR COMICION ORIGEN
             03 FGP-VAL-SCOR                         PIC S9(11)V9(4).
      *PLAZO
             03 FGP-SGV-PLZO                               PIC 9(08).
      *SCOR POR PLAZO
             03 FGP-VAL-SPLZ                         PIC S9(11)V9(4).
      *BASE DE LA TASA COMISION FOGAPE SEGUN LICITACION
             03 FGP-BAS-FGPE                               PIC 9(08).
      *SPLZ POR BASE DE LA TASA COMISION FOGAPE SEGUN LICITACION
             03 FGP-VAL-COMI                         PIC S9(11)V9(4).
      *COMISION FOGAPE
             03 FGP-VAL-MNTO                         PIC S9(11)V9(4).
      *FECHA INICIO PARA CALCULO DE PLAZO
             03 FGP-FEC-FUN.
               05 FGP-NUM-DUN                              PIC 9(02).
               05 FGP-NUM-MUN                              PIC 9(02).
               05 FGP-NUM-SUN                              PIC 9(02).
               05 FGP-NUM-AUN                              PIC 9(02).
      *FECHA FIN PARA CALCULO DE PLAZO
             03 FGP-FEC-FDO.
               05 FGP-NUM-DDO                              PIC 9(02).
               05 FGP-NUM-MDO                              PIC 9(02).
               05 FGP-NUM-SDO                              PIC 9(02).
               05 FGP-NUM-ADO                              PIC 9(02).
      *FECHA CANCELACION REAL
            03 FGP-FEC-FCAN.
              05 FGP-NUM-SCAN                 VALUE ZEROES PIC 9(02).
              05 FGP-NUM-ACAN                 VALUE ZEROES PIC 9(02).
              05 FGP-NUM-MCAN                 VALUE ZEROES PIC 9(02).
              05 FGP-NUM-DCAN                 VALUE ZEROES PIC 9(02).
      *FECHA DE VENCIMIENTO
            03 FGP-CXE-FVEN.
              05 FGP-CXE-SVEN                 VALUE ZEROES PIC 9(02).
              05 FGP-CXE-AVEN                 VALUE ZEROES PIC 9(02).
              05 FGP-CXE-MVEN                 VALUE ZEROES PIC 9(02).
              05 FGP-CXE-DVEN                 VALUE ZEROES PIC 9(02).
      *AFRI-FIN/LOF/CHC/04-2009
      *OGB-INI/COMISIONES CAE/OGB/03-2014
       01 REG-Z002.
          03 Z002-OPERACION.
             05 Z002-CAI-IOPC                 PIC X(04).
             05 Z002-IIC-IOPC                 PIC X(08).
          03 Z002-NUM-CUOTA                   PIC 9(03).
          03 Z002-MONTO-CUOTA                 PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
          03 Z002-MONTO-COMISION              PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
      *OGB-FIN/COMISIONES CAE/OGB/03-2014
      *AFRI-INI 29-AGO-2016 COMISION CAE003
       01 WCC-VARI.
          03 WCC-PEP            VALUE 'PEP'            PIC X(03).
      *AFRI-FIN 29-AGO-2016 COMISION CAE003

       01  CAN-FLD.
           03  CAN-NUM-PLCO                            PIC 9(06).
           03  CAN-CAI-IOPC                            PIC X(04).
           03  CAN-IIC-IOPC                            PIC X(08).
           03  CAN-NUM-ICAN                            PIC 9(03).
           03  CAN-COD-OFCA                            PIC X(03).
           03  CAN-FEC-FCAN                            PIC X(08).
           03  CAN-SGV-TPAG                            PIC 9(11)V9(04).
           03  CAN-SGV-TREN                            PIC 9(11)V9(04).
           03  CAN-SGV-COMI                            PIC S9(11)V9(04).
           03  COM-SGV-TINT                            PIC S9(03)V9(04).
           03  DBC-NUM-ICLI                            PIC X(08).
      *01  SCR-SIST               VALUE SPACES         PIC X(03).
       01  SCR-MSC-FCAN                                PIC X(01).
       01  SCR-MSC-ECAN                                PIC X(01).
       01  SCR-SGV-INTN                                PIC S9(11)V9(04).
      *
      *--------FIN-VAR DE LIC --------*

       01 WSS-TXT.
          03 WSS-TEXT OCCURS 30                        PIC X(70).

       01   LCC-VARI.
      *INDICADOR DE PESO
             03 LCC-COD-PESO     VALUE SPACES              PIC X(06).
      *INDICADOR DE COBRO DE COMISION FOGAPE
             03 LCC-IND-COB      VALUE SPACES              PIC X(01).
      *INDICADOR COMO OPERA
             03 LCC-OPEC         VALUE SPACES              PIC X(01).
      *INDICADOR DE PESO
             03 LCC-CIC-TVAL     VALUE SPACES              PIC X(01).
      *SALDO DEL CREDITO 1
             03 LCC-VAL-SCRE     VALUE ZEROES        PIC S9(11)V9(4).
      *SALDO DEL CREDITO 2
             03 LCC-VAL-SCR2     VALUE ZEROES        PIC S9(10)V9(2).
      *CONTADOR
             03 LCC-IFLD         VALUE ZEROES              PIC 9(08).
      *INDICADOR DE COBRO O NO COBRO DE COMISION FOGAPE
             03 LCC-GLS-NOCO     VALUE SPACES              PIC X(10).
      *SALDO DEL CREDITO POR EL PORCENTAJE GARANTIZADO
             03 LCC-VAL-SGAR     VALUE ZEROES        PIC S9(11)V9(4).
      *SGAR POR COMICION ORIGEN
             03 LCC-VAL-SCOR     VALUE ZEROES        PIC S9(11)V9(4).
      *PLAZO
             03 LCC-SGV-PLZO     VALUE ZEROES              PIC 9(08).
      *SCOR POR PLAZO
             03 LCC-VAL-SPLZ     VALUE ZEROES        PIC S9(11)V9(4).
      *BASE DE LA TASA COMISION FOGAPE SEGUN LICITACION
             03 LCC-BAS-FGPE     VALUE ZEROES              PIC 9(08).
      *SPLZ POR BASE DE LA TASA COMISION FOGAPE SEGUN LICITACION
             03 LCC-VAL-COMI     VALUE ZEROES        PIC S9(11)V9(4).
      *COMISION FOGAPE EN PESOS
             03 LCC-VAL-MNTO     VALUE ZEROES        PIC S9(11)V9(4).
      *COMISION FOGAPE EN LA MONEDA DEL CREDITO
             03 LCC-VAL-MNUF     VALUE ZEROES        PIC S9(11)V9(4).
      *FECHA INICIO PARA CALCULO DE PLAZO
             03 LCC-FEC-FUN.
               05 LCC-NUM-DUN    VALUE ZEROES              PIC 9(02).
               05 LCC-NUM-MUN    VALUE ZEROES              PIC 9(02).
               05 LCC-NUM-SUN    VALUE ZEROES              PIC 9(02).
               05 LCC-NUM-AUN    VALUE ZEROES              PIC 9(02).
      *FECHA FIN PARA CALCULO DE PLAZO
             03 LCC-FEC-FDO.
               05 LCC-NUM-DDO    VALUE ZEROES              PIC 9(02).
               05 LCC-NUM-MDO    VALUE ZEROES              PIC 9(02).
               05 LCC-NUM-SDO    VALUE ZEROES              PIC 9(02).
               05 LCC-NUM-ADO    VALUE ZEROES              PIC 9(02).
      *FECHA CANCELACION REAL
            03 LCC-FEC-FCAN.
              05 LCC-NUM-SCAN                 VALUE ZEROES PIC 9(02).
              05 LCC-NUM-ACAN                 VALUE ZEROES PIC 9(02).
              05 LCC-NUM-MCAN                 VALUE ZEROES PIC 9(02).
              05 LCC-NUM-DCAN                 VALUE ZEROES PIC 9(02).
      *FECHA DE VENCIMIENTO
            03 LCC-CXE-FVEN.
              05 LCC-CXE-SVEN                 VALUE ZEROES PIC 9(02).
              05 LCC-CXE-AVEN                 VALUE ZEROES PIC 9(02).
              05 LCC-CXE-MVEN                 VALUE ZEROES PIC 9(02).
              05 LCC-CXE-DVEN                 VALUE ZEROES PIC 9(02).

      *--------------------
      *
           03  WSS-I                              PIC 9(02).

       01 WSS-VEC-CANC.
           05 WSS-KEY-CANC.
               07 WSS-CIC-ICAN OCCURS 200.
                   09 WSS-CAI-ICAN                      PIC X(04).
                   09 WSS-IIC-ICAN                      PIC X(08).

       01 WSS-J                         COMP            PIC 9(04).
       01 WSS-JMAX                      COMP            PIC 9(04).
       01 WSS-MAX-JMAX VALUE 200        COMP            PIC 9(04).

      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).
              05 PGM-STAT-RRO.
                 88 PGM-STAT-RRO-NUL    VALUE '  '.
                 07 PGM-STT1-RRO        VALUE '2' PIC X(01).
                    88 PGM-STAT-RRO-OKS VALUE '0'.
                 07 PGM-STT2-RRO        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(270).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO SCL-FLD.
           MOVE LOW-VALUES TO SCL-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +270 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'COLPQSCL' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
              MOVE TSK-TERM-ALF TO SCL-COD-TERM
              MOVE TSK-TERM-ALF TO SCL-COD-TERM-MAS

           ELSE
              MOVE EIBTRMID     TO SCL-COD-TERM
              MOVE EIBTRMID     TO SCL-COD-TERM-MAS.
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-SCL.
           PERFORM EDT-KEY-SCL.
           PERFORM EDT-FLD-SCL.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.



       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF6
                    OR   FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-SCL
               PERFORM VAL-NUM-FLD-SCL
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.




       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-SCL
               PERFORM EDT-KEY-SCL
               PERFORM EDT-FLD-SCL
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-SCL
               PERFORM EDT-KEY-SCL
           ELSE
               PERFORM CLR-FLD-SCL
               PERFORM EDT-FLD-SCL.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-SCL.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO SCL-FLD.
           MOVE LOW-VALUES TO SCL-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY
           MOVE SPACES TO FRM-MEN1.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE PGM-SNUL TO PGM-STAT-RRO
               SUBTRACT 1 FROM SCR-I GIVING SCL-I
               IF SCL-I NOT > ZEROES
                   MOVE 'SCO RROPRV' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY
               ELSE
                   GO TO CARGA-SCL
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF6
               MOVE PGM-SNUL TO PGM-STAT-RRO
               ADD 1 SCR-I GIVING SCL-I
               IF SCL-I > SCR-IMAX
                   MOVE 'SCO RRONXT' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY
               ELSE
                   GO TO CARGA-SCL.
           GO TO CON-FND-KEY.

      *>>>>
           PERFORM KEY-ALL-SCL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE OPC-STP-ITRN IN OPC TO SCR-UMOD.
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
       CON-FND-KEY.
      *
           MOVE ZEROES TO SCR-IMAX.
           MOVE 1 TO SCR-I.
           MOVE '00' TO FIO-STAT.
           PERFORM OBT-DAT-TS.
           MOVE 1 TO SCR-I.
           MOVE SCR-I TO SCL-I.
       CARGA-SCL.
           MOVE SPACES TO MSG-COD-MENS.
           IF NOT SCR-OFRM-SRV
           PERFORM PUT-TAB-SCL.
           MOVE '00' TO FIO-STAT.
           GO TO FIN-FND-KEY.
      *
       ERR-FND-KEY.
           MOVE SCR-STAT-CON TO SCR-STAT.

           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE '00' TO FIO-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-OPC-OKS
               MOVE OPC-STP-ITRN IN OPC TO SCR-UMOD.
           PERFORM PUT-ALL-SCL.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE SCL-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO SCL-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-SCL
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCL-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-SCL.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCL
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-SCL.
           PERFORM VAL-IKY-SCL.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-SCL.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-SCL.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-SCL.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-SCL.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-SCL.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-SCL
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCL-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-SCL.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-SCL
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-SCL.
           PERFORM VAL-IKY-SCL.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-SCL.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-SCL.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-SCL.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT (FRM-FFLD = FRM-FFLD-PF6
                         OR   FRM-FFLD-PF5)
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCL-GLS-MEN2
               MOVE SCR-PRMT     TO SCL-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCL-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO SCL-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE SCL-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO SCL-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-SCL

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO SCL-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO SCL-GLS-MENS.
           PERFORM PRO-MKY-SCL.
           PERFORM PRO-AKY-SCL.
           PERFORM UNP-IKY-SCL.
           PERFORM FST-KEY-SCL.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE SCL-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO SCL-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO SCL-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO SCL-GLS-MENS.
           PERFORM UNP-KEY-SCL.
           PERFORM FST-KEY-SCL.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-SCL.
           PERFORM PRO-AKY-SCL.
           PERFORM UNP-MKY-SCL.
           PERFORM UNP-FLD-SCL.
           PERFORM FST-FLD-SCL.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO SCL-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-SCL.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCL
               PERFORM EDT-FLD-SCL
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCL
               PERFORM EDT-FLD-SCL
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-SCL.
           PERFORM EDT-FLD-SCL.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY COLBQSCL.
       COPY GNSBVNUM.
       COPY COLBFOPC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBFTAB.
       COPY GNSBEGLS.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       COPY COLBFCAN.
       COPY COLBFCOM.
       COPY COLBFCYA.
       COPY COLBFDIC.
       COPY COLBFEVC.
       COPY COLBFPOC.
       COPY COLBFRCV.
       COPY COLBFROV.
       COPY COLBFTOC.
       COPY COLBFVEN.
       COPY SGCBFDBC.
       COPY SGCBFDCE.
       COPY SGCBFDCP.
      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/06-2012
       COPY COLBFCXE.
       COPY COLBGRT4.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/06-2012
       COPY SGCBFAEP.
       COPY SGCBFRCD.
       COPY LDCBFLCC.
       COPY LDCBFRLO.

       COPY GNSBGVSM.
       COPY COLBGLCA.
       COPY COLBGLCU.
       COPY COLBGVEN.
      * RGD-INI 23-JUL-2014 TRANSACCIONES LENTAS
       COPY COLBGVE3.
      * RGD-FIN 23-JUL-2014
       COPY COLBGINT.
       COPY COLBGCXE.
       COPY COLBGLIC.
       COPY COLBGPCP.
       COPY COLB6CAN.

       COPY GNSBGCPT.
       COPY GNSBGCAM.

       COPY GNSBFMSC.
       COPY GNSBGPES.
      *COPY GNSBGIDD.
       COPY GNSBBMSC.
       COPY GNSBPFEC.
       COPY GNSBFRCE.
       COPY GNSBBTAB.

       COPY GNSBGEND.
      *COPY GNSBGIRH.
       COPY GNSBGABT.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGABT.
      *COPY GNSBGBAR.
      *COPY GNSBGCAM.
      *COPY GNSBGCVI.
       COPY TABBVOFI.
       COPY TABBVUSR.
       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBFUSR.
       COPY TABBFVLR.
       COPY TABBFROC.
       COPY TABBBUSR.
       COPY TABBBOFI.
       COPY COLBFDLC.
       COPY COLBFRDC.
       COPY COLBFICG.
       COPY COLBFITR.
       COPY COLBFPCP.

       CAR-MOV-SCL SECTION.
       INI-CAR-MOV-SCL.
           PERFORM GET-FHOY.
           IF FRM-COD-FORM IN SCL-FLD = 'CANCELACION'
              PERFORM PRO-LCA.
           IF FRM-COD-FORM IN SCL-FLD = 'CURSE'
              PERFORM PRO-LCU.
      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/06-2012
           IF FRM-COD-FORM IN SCL-FLD = 'CAE'
              PERFORM PRO-RT4.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/06-2012
       FIN-CAR-MOV-SCL.
           EXIT.

       OBT-DAT-TS SECTION.
       INI-OBT-DAT-TS.
           EXEC CICS HANDLE CONDITION QIDERR(CON-OBT-DAT-TS)
                                     ITEMERR(CON-OBT-DAT-TS)
           END-EXEC.
      *<<<<
           MOVE SCL-NOM-TSSCL     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *>>>>
       CON-OBT-DAT-TS.
           MOVE SCL-SI-IMP TO SCL-IMP.
           PERFORM CLR-VEC-TS VARYING SCL-I FROM 1 BY 1 UNTIL
                   SCL-I > SCL-IMAX.
           MOVE 1 TO SCL-I.
           PERFORM CAR-MOV-SCL.

       NXT-OBT-DAT-TS.
           IF SCL-IMP = SCL-SI-IMP
               PERFORM WRT-TS.
       FIN-OBT-DAT-TS.
           EXIT.

       PUT-TAB-SCL SECTION.
       INI-PUT-TAB-SCL.
           PERFORM RED-TS.
           PERFORM LLE-DAT-PNT VARYING SCL-I FROM 1 BY 1
                   UNTIL SCL-I > SCL-IMAX.
       FIN-PUT-TAB-SCL.
           EXIT.

       LLE-DAT-PNT SECTION.
       INI-LLE-DAT-PNT.
           MOVE SCL-COD-IDEN(SCL-I) TO FRM-COD-IDEN IN SCL-FLD(SCL-I).
           MOVE SCL-IND-CONT(SCL-I) TO FRM-IND-CONT IN SCL-FLD(SCL-I).
           MOVE SCL-GLS-TEXT(SCL-I) TO FRM-GLS-TEXT IN SCL-FLD(SCL-I).
       FIN-LLE-DAT-PNT.
           EXIT.

       INC-REG-TS SECTION.
       INI-INC-REG-TS.
            MOVE SCL-SI-IMP TO SCL-IMP.
      *OGB-INI/COMISIONES CAE/OGB/03-2014
           IF FRM-COD-FORM IN SCL-FLD = WSS-CTE-CAE
              IF SCL-COD-IDEN(SCL-I) = WSS-CTE-F001 OR
                 SCL-COD-IDEN(SCL-I) = WSS-CTE-F002
                 MOVE SCL-GLS-TEXT(SCL-I) TO REG-Z002
                 MOVE Z002-CAI-IOPC TO WS-CAI-IOPC
                 MOVE Z002-IIC-IOPC TO WS-IIC-IOPC
                 MOVE Z002-MONTO-CUOTA TO WSS-VAL-CORG
      *AFRI-INI 29-AGO-2016 COMISION CAE003
                 PERFORM PRO-LEE-REBAJA-CAE
      *AFRI-FIN 29-AGO-2016 COMISION CAE003
                 PERFORM PRO-LEE-COMISION-CAE
      *AFRI-INI 29-AGO-2016 COMISION CAE003
      *          MOVE WSS-VAL-CAC  TO Z002-MONTO-COMISION
      *          SUBTRACT WSS-VAL-CAC FROM WSS-VAL-CORG
      *          MOVE WSS-VAL-CORG TO Z002-MONTO-CUOTA
      *          MOVE REG-Z002 TO SCL-GLS-TEXT(SCL-I).
                 IF WSS-IND-PEP IN WSS-VARI = WCC-S
                     IF WSS-VAL-CORG > WSS-VAL-CAC
                         COMPUTE WSS-VAL-CORG = WSS-VAL-CORG -
                                                    WSS-VAL-CAC
                         MOVE WSS-VAL-CORG TO Z002-MONTO-CUOTA
                         MOVE WSS-VAL-CAC  TO Z002-MONTO-COMISION
                         MOVE REG-Z002 TO SCL-GLS-TEXT(SCL-I)
                     ELSE
                         MOVE ZEROES TO Z002-MONTO-COMISION
                         MOVE WSS-VAL-CORG TO Z002-MONTO-CUOTA
                         MOVE REG-Z002 TO SCL-GLS-TEXT(SCL-I)
                 ELSE
                 MOVE WSS-VAL-CAC  TO Z002-MONTO-COMISION
                 SUBTRACT WSS-VAL-CAC FROM WSS-VAL-CORG
                 MOVE WSS-VAL-CORG TO Z002-MONTO-CUOTA
                 MOVE REG-Z002 TO SCL-GLS-TEXT(SCL-I)
           ELSE
               NEXT SENTENCE.
      *AFRI-FIN 29-AGO-2016 COMISION CAE003

      *OGB-FIN/COMISIONES CAE/OGB/03-2014

           ADD 1 TO SCL-I.
           IF SCL-I > SCL-IMAX
               PERFORM WRT-TS
               PERFORM CLR-VEC-TS VARYING SCL-I FROM 1 BY 1
                                     UNTIL SCL-I > SCL-IMAX
               MOVE 1 TO SCL-I
               MOVE SCL-NO-IMP TO SCL-IMP.
       FIN-INC-REG-TS.
           EXIT.

       WRT-TS SECTION.
       INI-WRT-TS.
           ADD 1 TO SCR-IMAX.
      *<<<<
           MOVE SCL-NOM-TSSCL  TO QUE-COLA.
           MOVE SCL-TS         TO QUE-ITEM.
           MOVE SCL-LEN-TSSCL  TO QUE-LITM.
           MOVE QUE-PUT        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *>>>>
       FIN-WRT-TS.
           EXIT.

       RED-TS SECTION.
       INI-RED-TS.
           MOVE SCL-I TO SCR-I.
           EXEC CICS HANDLE CONDITION QIDERR(FIN-RED-TS)
                                     ITEMERR(FIN-RED-TS)
           END-EXEC.
      *<<<<
           MOVE SCL-NOM-TSSCL      TO QUE-COLA.
           MOVE SCL-TS             TO QUE-ITEM.
           MOVE SCL-LEN-TSSCL      TO QUE-LITM.
           MOVE SCL-I              TO QUE-NITM.
           MOVE QUE-GET            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE QUE-ITEM          TO SCL-TS.
      *>>>>
       FIN-RED-TS.
           EXIT.

       CLR-VEC-TS SECTION.
       INI-CLR-VEC-TS.
           MOVE SPACES TO SCL-COD-IDEN(SCL-I).
           MOVE SPACES TO SCL-IND-CONT(SCL-I).
           MOVE SPACES TO SCL-GLS-TEXT(SCL-I).
       FIN-CLR-VEC-TS.
           EXIT.

       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       GRABA-HAYMAS SECTION.
       INI-GRABA-HAYMAS.
           MOVE 'S'                TO SCL-MAS-IND-HMAS.
           MOVE SCL-IMAX-MTX       TO SCL-MAS-NUM-TOCC.
           MOVE SCL-NOM-TSSCL-MAS  TO QUE-COLA.
           MOVE SCL-MAS-ITEM       TO QUE-ITEM.
           MOVE SCL-LEN-TSSCL-MAS  TO QUE-LITM.
           MOVE QUE-PUT            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-GRABA-HAYMAS.
           EXIT.

       GRABA-NOHAYMAS SECTION.
       INI-GRABA-NOHAYMAS.
           MOVE 'N'                TO SCL-MAS-IND-HMAS.
           MOVE WSS-CANT           TO SCL-MAS-NUM-TOCC.
           MOVE SCL-NOM-TSSCL-MAS  TO QUE-COLA.
           MOVE SCL-MAS-ITEM       TO QUE-ITEM.
           MOVE SCL-LEN-TSSCL-MAS  TO QUE-LITM.
           MOVE QUE-PUT            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-GRABA-NOHAYMAS.
           EXIT.

      *OGB-INI/COMISIONES CAE/OGB/03-2014
       PRO-LEE-COMISION-CAE SECTION.
       INI-PRO-LEE-COMISION-CAE.
      *SI NO ENCUENTRA CXE SE DEJA EN CERO
           MOVE ZEROES TO WSS-VAL-CAC.
           MOVE LOW-VALUES               TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE WS-CAI-IOPC              TO CXE-CAI-IOPC IN CXE.
           MOVE WS-IIC-IOPC              TO CXE-IIC-IOPC IN CXE.
           MOVE WSS-CTE-CAC              TO CXE-COD-EVEN IN CXE.
           MOVE ZEROES                   TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE WSS-CTE-CPTO             TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE CXE-SGV-MNTO IN CXE TO WSS-VAL-CAC IN WSS-VARI
           ELSE
               MOVE ZEROES              TO WSS-VAL-CAC IN WSS-VARI.
       FIN-PRO-LEE-COMISION-CAE.
           EXIT.
      *OGB-FIN/COMISIONES CAE/OGB/03-2014
       PRO-LEE-REBAJA-CAE SECTION.
       INI-PRO-LEE-REBAJA-CAE.
           MOVE WCC-N                    TO WSS-IND-PEP IN WSS-VARI.
           MOVE SPACES                   TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE WS-CAI-IOPC              TO CXE-CAI-IOPC IN CXE.
           MOVE WS-IIC-IOPC              TO CXE-IIC-IOPC IN CXE.
           MOVE WCC-PEP                  TO CXE-COD-EVEN IN CXE.
           MOVE Z002-NUM-CUOTA           TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE SPACES                   TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE WCC-S TO WSS-IND-PEP IN WSS-VARI.
       FIN-PRO-LEE-REBAJA-CAE.
           EXIT.
      *>>>>
