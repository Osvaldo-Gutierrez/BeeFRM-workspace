      *
      * COLBQCAN
      * Version 3.0.1 Nov-2005
      * 11-Apr-19 10:16 AM
      *
       SET-TAG-COLBQCAN SECTION.
       INI-SET-TAG-COLBQCAN.
           MOVE
           '<IDNMOD NOM=$COLBQCAN$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$11-Apr-19 10:16 AM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBQCAN.
           EXIT.
           
       PUT-ALL-CAN SECTION.
       INI-PUT-ALL-CAN.
           PERFORM PUT-OPC-CAN.
           PERFORM PUT-CAN-CAN.
           PERFORM PUT-DBC-CAN.
           PERFORM PUT-VEN-CAN.
           PERFORM PUT-RCV-CAN.
           PERFORM PUT-ROV-CAN.
           PERFORM PUT-ICG-CAN.
           PERFORM PUT-COM-CAN.
           PERFORM PUT-CYA-CAN.
      *<<<< FIN_PUT_ALL_CAN
      *BUS-TAB busca glosa de codigo en tabla
           IF ITR-COD-TINT IN ITR > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'INT'               TO TAB-COD-TTAB IN TAB
               MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-IITR IN CAN-FLD.
      *Lee Tasa de Comision                                             
           MOVE CAN-CAI-IOPC IN CAN-FLD TO ICG-CAI-IOPC IN ICG.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO ICG-IIC-IOPC IN ICG.         
           MOVE CAN-NUM-ICAN IN CAN-FLD TO ICG-NUM-ICAN IN ICG.         
           MOVE CAN-CAI-IOPC IN CAN-FLD TO ICG-CAI-IOPV IN ICG.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO ICG-IIC-IOPV IN ICG.         
           IF SCR-MSC-FCAN = 'T' AND                                    
              SCR-MSC-ECAN = 'T'                                        
              MOVE ZEROES                  TO ICG-NUM-IVCT IN ICG       
           ELSE                                                         
              MOVE VEN-NUM-IVEN IN CAN-FLD TO ICG-NUM-IVCT IN ICG.      
           MOVE 'FLV'                   TO ICG-IND-TTAS IN ICG.         
           MOVE CAN-NUM-SCAN IN CAN-FLD TO ICG-NUM-SINI IN ICG.         
           MOVE CAN-NUM-ACAN IN CAN-FLD TO ICG-NUM-AINI IN ICG.         
           MOVE CAN-NUM-MCAN IN CAN-FLD TO ICG-NUM-MINI IN ICG.         
           MOVE CAN-NUM-DCAN IN CAN-FLD TO ICG-NUM-DINI IN ICG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-ICG.                                         
           IF FIO-STAT-OKS                                              
               MOVE ICG-SGV-TINT IN ICG TO COM-SGV-TINT IN CAN-FLD      
               MOVE 'N' TO WSS-IBLK-COMI                                
           ELSE                                                         
              PERFORM LEE-COM-CAN-CUR                                   
              IF FIO-STAT-OKS                                           
                 MOVE ICG-SGV-TINT IN ICG TO COM-SGV-TINT IN CAN-FLD    
                 MOVE 'N' TO WSS-IBLK-COMI                              
              ELSE                                                      
                 MOVE ZEROES TO FIO-STAT                                
                 MOVE ZEROES TO COM-SGV-TINT IN CAN-FLD.                
      *>>>>
       FIN-PUT-ALL-CAN.
           EXIT.
       
       PUT-OPC-CAN SECTION.
       INI-PUT-OPC-CAN.
           IF PGM-STAT-OPC-NUL
               GO TO FIN-PUT-OPC-CAN.
           IF NOT PGM-STAT-OPC-OKS
               PERFORM CLR-OPC-CAN
               GO TO FIN-PUT-OPC-CAN.
           MOVE OPC-MSC-TVOC IN OPC TO OPC-MSC-TVOC IN CAN-FLD.
           MOVE OPC-COD-TOOC IN OPC TO OPC-COD-TOOC IN CAN-FLD.
           MOVE OPC-COD-OFOC IN OPC TO OPC-COD-OFOC IN CAN-FLD.
           MOVE OPC-NUM-VCVG IN OPC TO OPC-NUM-VCVG IN CAN-FLD.
           MOVE OPC-COD-AOOC IN OPC TO OPC-COD-AOOC IN CAN-FLD.
           MOVE OPC-COD-VCOC IN OPC TO OPC-COD-VCOC IN CAN-FLD.
           MOVE OPC-VAL-SCRE IN OPC TO OPC-VAL-SCRE IN CAN-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF OPC-MSC-TVOC IN CAN-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-TVOC IN CAN-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TVOC IN CAN-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-TVOC IN CAN-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-TOOC IN CAN-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOOC IN CAN-FLD.
      *BUS-OFI busca oficina en tablas
           IF OPC-COD-OFOC IN CAN-FLD > SPACES
               MOVE OPC-COD-OFOC IN CAN-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFOC IN CAN-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-VCOC IN CAN-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOC IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOC IN CAN-FLD.
      *<<<< FIN_PUT_OPC_CAN
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-AOOC IN CAN-FLD > SPACES
               MOVE 'COL'                    TO TAB-COD-SIST
               MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN CAN-FLD  TO WSS-COD-TOOC IN WSS-VARI
               MOVE OPC-COD-AOOC IN CAN-FLD  TO WSS-COD-AOOC IN WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN CAN-FLD.
           MOVE OPC-COD-VCOC IN OPC TO SCR-COD-VCOC.
      *>>>>
       FIN-PUT-OPC-CAN.
           EXIT.
       
       PUT-CAN-CAN SECTION.
       INI-PUT-CAN-CAN.
           IF PGM-STAT-CAN-NUL
               GO TO FIN-PUT-CAN-CAN.
           IF NOT PGM-STAT-CAN-OKS
               PERFORM CLR-CAN-CAN
               GO TO FIN-PUT-CAN-CAN.
           MOVE CAN-CAI-IOPC IN CAN TO CAN-CAI-IOPC IN CAN-FLD.
           MOVE CAN-IIC-IOPC IN CAN TO CAN-IIC-IOPC IN CAN-FLD.
           MOVE CAN-NUM-ICAN IN CAN TO CAN-NUM-ICAN IN CAN-FLD.
           MOVE CAN-MSC-CANC IN CAN TO CAN-MSC-CANC IN CAN-FLD.
           MOVE CAN-MSC-STAT IN CAN TO CAN-MSC-STAT IN CAN-FLD.
           MOVE CAN-COD-RCAN IN CAN TO CAN-COD-RCAN IN CAN-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CAN-NUM-DOUT IN CAN TO CAN-NUM-DOUT IN CAN-FLD.
           MOVE CAN-NUM-MOUT IN CAN TO CAN-NUM-MOUT IN CAN-FLD.
           MOVE CAN-NUM-SOUT IN CAN TO CAN-NUM-SOUT IN CAN-FLD.
           MOVE CAN-NUM-AOUT IN CAN TO CAN-NUM-AOUT IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CAN-NUM-DCAN IN CAN TO CAN-NUM-DCAN IN CAN-FLD.
           MOVE CAN-NUM-MCAN IN CAN TO CAN-NUM-MCAN IN CAN-FLD.
           MOVE CAN-NUM-SCAN IN CAN TO CAN-NUM-SCAN IN CAN-FLD.
           MOVE CAN-NUM-ACAN IN CAN TO CAN-NUM-ACAN IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CAN-NUM-DEGR IN CAN TO CAN-NUM-DEGR IN CAN-FLD.
           MOVE CAN-NUM-MEGR IN CAN TO CAN-NUM-MEGR IN CAN-FLD.
           MOVE CAN-NUM-SEGR IN CAN TO CAN-NUM-SEGR IN CAN-FLD.
           MOVE CAN-NUM-AEGR IN CAN TO CAN-NUM-AEGR IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE CAN-SGV-GAST IN CAN TO CAN-SGV-GAST IN CAN-FLD.
           MOVE CAN-NUM-PLCO IN CAN TO CAN-NUM-PLCO IN CAN-FLD.
           MOVE CAN-SGV-COMI IN CAN TO CAN-SGV-COMI IN CAN-FLD.
           MOVE CAN-COD-OFCA IN CAN TO CAN-COD-OFCA IN CAN-FLD.
           MOVE CAN-SGV-TREN IN CAN TO CAN-SGV-TREN IN CAN-FLD.
           MOVE CAN-SGV-TPAG IN CAN TO CAN-SGV-TPAG IN CAN-FLD.
           MOVE CAN-SGV-DIFE IN CAN TO CAN-SGV-DIFE IN CAN-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CAN-MSC-CANC IN CAN-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CNC ' TO TAB-COD-TTAB IN TAB
               MOVE CAN-MSC-CANC IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CANC IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CANC IN CAN-FLD.
      *BUS-USR busca usuario en tablas
           IF CAN-COD-RCAN IN CAN-FLD > SPACES
               MOVE CAN-COD-RCAN IN CAN-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RCAN IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-RCAN IN CAN-FLD.
      *BUS-OFI busca oficina en tablas
           IF CAN-COD-OFCA IN CAN-FLD > SPACES
               MOVE CAN-COD-OFCA IN CAN-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFCA IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFCA IN CAN-FLD.
      *<<<< FIN_PUT_CAN_CAN
      *BUS-TAB busca glosa de codigo en tabla
           IF CAN-MSC-STAT IN CAN-FLD > SPACES
               MOVE 'GNS'                   TO TAB-COD-SIST
               MOVE 'STT'                   TO TAB-COD-TTAB IN TAB
               MOVE CAN-MSC-STAT IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO FRM-GLS-STAT IN CAN-FLD.
      *>>>>
       FIN-PUT-CAN-CAN.
           EXIT.
       
       PUT-DBC-CAN SECTION.
       INI-PUT-DBC-CAN.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-CAN.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-CAN
               GO TO FIN-PUT-DBC-CAN.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN CAN-FLD.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN CAN-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN CAN-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN CAN-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN CAN-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
      *<<<< FIN_PUT_DBC_CAN
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN CAN-FLD.
      *>>>>
       FIN-PUT-DBC-CAN.
           EXIT.
       
       PUT-VEN-CAN SECTION.
       INI-PUT-VEN-CAN.
           IF PGM-STAT-VEN-NUL
               GO TO FIN-PUT-VEN-CAN.
           IF NOT PGM-STAT-VEN-OKS
               PERFORM CLR-VEN-CAN
               GO TO FIN-PUT-VEN-CAN.
           MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVCT IN CAN-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE VEN-NUM-DVEN IN VEN TO VEN-NUM-DVEN IN CAN-FLD.
           MOVE VEN-NUM-MVEN IN VEN TO VEN-NUM-MVEN IN CAN-FLD.
           MOVE VEN-NUM-SVEN IN VEN TO VEN-NUM-SVEN IN CAN-FLD.
           MOVE VEN-NUM-AVEN IN VEN TO VEN-NUM-AVEN IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DIMV IN CAN-FLD.
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MIMV IN CAN-FLD.
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SIMV IN CAN-FLD.
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AIMV IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE VEN-IND-SCTB IN VEN TO VEN-IND-SCTB IN CAN-FLD.
           MOVE VEN-NUM-IVEN IN VEN TO VEN-NUM-IVEN IN CAN-FLD.
           MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD.
           MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF VEN-IND-SCTB IN CAN-FLD > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'SCTB' TO MSC-COD-TMSC IN MSC
               MOVE VEN-IND-SCTB IN CAN-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SCTB IN CAN-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-SCTB IN CAN-FLD.
       FIN-PUT-VEN-CAN.
           EXIT.
       
       PUT-RCV-CAN SECTION.
       INI-PUT-RCV-CAN.
           IF PGM-STAT-RCV-NUL
               GO TO FIN-PUT-RCV-CAN.
           IF NOT PGM-STAT-RCV-OKS
               PERFORM CLR-RCV-CAN
               GO TO FIN-PUT-RCV-CAN.
           MOVE RCV-MSC-MCAN IN RCV TO RCV-MSC-MCAN IN CAN-FLD.
           MOVE RCV-SGV-CAPI IN RCV TO RCV-SGV-CAPI IN CAN-FLD.
           MOVE RCV-SGV-FINA IN RCV TO RCV-SGV-FINA IN CAN-FLD.
       FIN-PUT-RCV-CAN.
           EXIT.
       
       PUT-ROV-CAN SECTION.
       INI-PUT-ROV-CAN.
           IF PGM-STAT-ROV-NUL
               GO TO FIN-PUT-ROV-CAN.
           IF NOT PGM-STAT-ROV-OKS
               PERFORM CLR-ROV-CAN
               GO TO FIN-PUT-ROV-CAN.
           MOVE ROV-CAI-IOPC IN ROV TO ROV-CAI-IOPC IN CAN-FLD.
           MOVE ROV-IIC-IOPC IN ROV TO ROV-IIC-IOPC IN CAN-FLD.
      *<<<< FIN_PUT_ROV_CAN
           MOVE ROV-CAI-IOPC IN ROV TO SCR-ROV-CAI-IOPC.
           MOVE ROV-IIC-IOPC IN ROV TO SCR-ROV-IIC-IOPC.
      *>>>>
       FIN-PUT-ROV-CAN.
           EXIT.
       
       PUT-ICG-CAN SECTION.
       INI-PUT-ICG-CAN.
           IF PGM-STAT-ICG-NUL
               GO TO FIN-PUT-ICG-CAN.
           IF NOT PGM-STAT-ICG-OKS
               PERFORM CLR-ICG-CAN
               GO TO FIN-PUT-ICG-CAN.
           MOVE ICG-SGV-TINT IN ICG TO ICG-SGV-TINT IN CAN-FLD.
      *<<<< FIN_PUT_ICG_CAN
      *DAD ini  10-SEP-1992   (Memo.26-05-92 Pto.3)
           MOVE 'N' TO WSS-IBLK-TINT IN WSS-VARI.
      *DAD fin  10-SEP-1992
      *>>>>
       FIN-PUT-ICG-CAN.
           EXIT.
       
       PUT-COM-CAN SECTION.
       INI-PUT-COM-CAN.
           IF PGM-STAT-COM-NUL
               GO TO FIN-PUT-COM-CAN.
           IF NOT PGM-STAT-COM-OKS
               PERFORM CLR-COM-CAN
               GO TO FIN-PUT-COM-CAN.
           MOVE COM-SGV-TINT IN COM TO COM-SGV-TINT IN CAN-FLD.
       FIN-PUT-COM-CAN.
           EXIT.
       
       PUT-CYA-CAN SECTION.
       INI-PUT-CYA-CAN.
      *<<<< INI_PUT_CYA_CAN
           IF SCR-CYA-IND-MCYA = 'M'
               MOVE 'M'         TO CYA-IND-TCYA IN CAN-FLD
               MOVE SPACES      TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES      TO CYA-IIC-ICYA IN CAN-FLD
               MOVE 'MULTIPLES' TO FRM-GLS-TCYA IN CAN-FLD
               GO TO FIN-PUT-CYA-CAN.
      *>>>>
           IF PGM-STAT-CYA-NUL                                          
               GO TO FIN-PUT-CYA-CAN.                                   
           IF NOT PGM-STAT-CYA-OKS                                      
               PERFORM CLR-CYA-CAN                                      
               GO TO FIN-PUT-CYA-CAN.                                   
           MOVE CYA-IND-TCYA IN CYA TO CYA-IND-TCYA IN CAN-FLD.         
           MOVE CYA-CAI-ICYA IN CYA TO CYA-CAI-ICYA IN CAN-FLD.         
           MOVE CYA-IIC-ICYA IN CYA TO CYA-IIC-ICYA IN CAN-FLD.         
      *BUS-MSC busca glosa de miscelaneo en tabla                       
           IF CYA-IND-TCYA IN CAN-FLD > SPACES                          
      *HZF-INI 04-09-2001                                               
           AND CYA-IND-TCYA IN CAN-FLD NOT = 'XXXXX'                    
      *HZF-FIN 04-09-2001                                               
               MOVE 'TAB' TO MSC-COD-SIST                               
               MOVE 'TCYA' TO MSC-COD-TMSC IN MSC                       
               MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC      
               PERFORM BUS-MSC                                          
               MOVE MSC-GLS-DCOR IN MSC TO                              
                    FRM-GLS-TCYA IN CAN-FLD                             
           ELSE                                                         
               MOVE SPACES TO                                           
                    FRM-GLS-TCYA IN CAN-FLD.                            
           GO TO FIN-PUT-CYA-CAN.
           IF PGM-STAT-CYA-NUL
               GO TO FIN-PUT-CYA-CAN.
           IF NOT PGM-STAT-CYA-OKS
               PERFORM CLR-CYA-CAN
               GO TO FIN-PUT-CYA-CAN.
           MOVE CYA-IND-TCYA IN CYA TO CYA-IND-TCYA IN CAN-FLD.
           MOVE CYA-CAI-ICYA IN CYA TO CYA-CAI-ICYA IN CAN-FLD.
           MOVE CYA-IIC-ICYA IN CYA TO CYA-IIC-ICYA IN CAN-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF CYA-IND-TCYA IN CAN-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TCYA' TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-TCYA IN CAN-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-TCYA IN CAN-FLD.
       FIN-PUT-CYA-CAN.
           EXIT.
      *
      * COLBUCAN
      * Version 3.0.1 Nov-2005
      * 11-Apr-19 10:16 AM
      *
       SET-TAG-COLBUCAN SECTION.
       INI-SET-TAG-COLBUCAN.
           MOVE
           '<IDNMOD NOM=$COLBUCAN$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$11-Apr-19 10:16 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBUCAN.
           EXIT.
           
       RET-ALL-CAN SECTION.
       INI-RET-ALL-CAN.
           PERFORM KEY-ALL-CAN.
           PERFORM RET-OPC-CAN.
           PERFORM RET-CAN-CAN.
           PERFORM RET-DBC-CAN.
           PERFORM RET-VEN-CAN.
           PERFORM RET-RCV-CAN.
           PERFORM RET-ROV-CAN.
           PERFORM RET-ICG-CAN.
           PERFORM RET-COM-CAN.
           PERFORM RET-CYA-CAN.
       FIN-RET-ALL-CAN.
           EXIT.
       
       RET-OPC-CAN SECTION.
       INI-RET-OPC-CAN.
           MOVE OPC-MSC-TVOC IN CAN-FLD TO OPC-MSC-TVOC IN OPC.
           MOVE OPC-COD-TOOC IN CAN-FLD TO OPC-COD-TOOC IN OPC.
           MOVE OPC-COD-OFOC IN CAN-FLD TO OPC-COD-OFOC IN OPC.
           MOVE OPC-NUM-VCVG IN CAN-FLD TO OPC-NUM-VCVG IN OPC.
           MOVE OPC-COD-AOOC IN CAN-FLD TO OPC-COD-AOOC IN OPC.
           MOVE OPC-COD-VCOC IN CAN-FLD TO OPC-COD-VCOC IN OPC.
           MOVE OPC-VAL-SCRE IN CAN-FLD TO OPC-VAL-SCRE IN OPC.
       FIN-RET-OPC-CAN.
           EXIT.
       
       RET-CAN-CAN SECTION.
       INI-RET-CAN-CAN.
           MOVE CAN-MSC-CANC IN CAN-FLD TO CAN-MSC-CANC IN CAN.
           MOVE CAN-MSC-STAT IN CAN-FLD TO CAN-MSC-STAT IN CAN.
           MOVE CAN-COD-RCAN IN CAN-FLD TO CAN-COD-RCAN IN CAN.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CAN-NUM-DOUT IN CAN-FLD TO CAN-NUM-DOUT IN CAN.
           MOVE CAN-NUM-MOUT IN CAN-FLD TO CAN-NUM-MOUT IN CAN.
           MOVE CAN-NUM-SOUT IN CAN-FLD TO CAN-NUM-SOUT IN CAN.
           MOVE CAN-NUM-AOUT IN CAN-FLD TO CAN-NUM-AOUT IN CAN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CAN-NUM-DEGR IN CAN-FLD TO CAN-NUM-DEGR IN CAN.
           MOVE CAN-NUM-MEGR IN CAN-FLD TO CAN-NUM-MEGR IN CAN.
           MOVE CAN-NUM-SEGR IN CAN-FLD TO CAN-NUM-SEGR IN CAN.
           MOVE CAN-NUM-AEGR IN CAN-FLD TO CAN-NUM-AEGR IN CAN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-GAST IN CAN.
           MOVE CAN-NUM-PLCO IN CAN-FLD TO CAN-NUM-PLCO IN CAN.
           MOVE CAN-SGV-COMI IN CAN-FLD TO CAN-SGV-COMI IN CAN.
           MOVE CAN-COD-OFCA IN CAN-FLD TO CAN-COD-OFCA IN CAN.
           MOVE CAN-SGV-TREN IN CAN-FLD TO CAN-SGV-TREN IN CAN.
           MOVE CAN-SGV-TPAG IN CAN-FLD TO CAN-SGV-TPAG IN CAN.
           MOVE CAN-SGV-DIFE IN CAN-FLD TO CAN-SGV-DIFE IN CAN.
       FIN-RET-CAN-CAN.
           EXIT.
       
       RET-DBC-CAN SECTION.
       INI-RET-DBC-CAN.
           MOVE DBC-GLS-NOMC IN CAN-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN CAN-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN CAN-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN CAN-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN CAN-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-RET-DBC-CAN.
           EXIT.
       
       RET-VEN-CAN SECTION.
       INI-RET-VEN-CAN.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE VEN-IND-SCTB IN CAN-FLD TO VEN-IND-SCTB IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
           MOVE VEN-VAL-SCAP IN CAN-FLD TO VEN-VAL-SCAP IN VEN.
           MOVE VEN-VAL-SFIN IN CAN-FLD TO VEN-VAL-SFIN IN VEN.
       FIN-RET-VEN-CAN.
           EXIT.
       
       RET-RCV-CAN SECTION.
       INI-RET-RCV-CAN.
           MOVE RCV-MSC-MCAN IN CAN-FLD TO RCV-MSC-MCAN IN RCV.
           MOVE RCV-SGV-CAPI IN CAN-FLD TO RCV-SGV-CAPI IN RCV.
           MOVE RCV-SGV-FINA IN CAN-FLD TO RCV-SGV-FINA IN RCV.
       FIN-RET-RCV-CAN.
           EXIT.
       
       RET-ROV-CAN SECTION.
       INI-RET-ROV-CAN.
           MOVE ROV-CAI-IOPC IN CAN-FLD TO ROV-CAI-IOPC IN ROV.
           MOVE ROV-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPC IN ROV.
       FIN-RET-ROV-CAN.
           EXIT.
       
       RET-ICG-CAN SECTION.
       INI-RET-ICG-CAN.
           MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT IN ICG.
       FIN-RET-ICG-CAN.
           EXIT.
       
       RET-COM-CAN SECTION.
       INI-RET-COM-CAN.
           MOVE COM-SGV-TINT IN CAN-FLD TO COM-SGV-TINT IN COM.
       FIN-RET-COM-CAN.
           EXIT.
       
       RET-CYA-CAN SECTION.
       INI-RET-CYA-CAN.
           MOVE CYA-IND-TCYA IN CAN-FLD TO CYA-IND-TCYA IN CYA.
           MOVE CYA-CAI-ICYA IN CAN-FLD TO CYA-CAI-ICYA IN CYA.
           MOVE CYA-IIC-ICYA IN CAN-FLD TO CYA-IIC-ICYA IN CYA.
       FIN-RET-CYA-CAN.
           EXIT.
       
       KEY-ALL-CAN SECTION.
       INI-KEY-ALL-CAN.
           PERFORM KEY-OPC-CAN.
           PERFORM KEY-CAN-CAN.
           PERFORM KEY-DBC-CAN.
           PERFORM KEY-VEN-CAN.
           PERFORM KEY-RCV-CAN.
           PERFORM KEY-ROV-CAN.
           PERFORM KEY-ICG-CAN.
           PERFORM KEY-COM-CAN.
           PERFORM KEY-CYA-CAN.
       FIN-KEY-ALL-CAN.
           EXIT.
       
       KEY-OPC-CAN SECTION.
       INI-KEY-OPC-CAN.
       FIN-KEY-OPC-CAN.
           EXIT.
       
       KEY-CAN-CAN SECTION.
       INI-KEY-CAN-CAN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN.
       FIN-KEY-CAN-CAN.
           EXIT.
       
       KEY-DBC-CAN SECTION.
       INI-KEY-DBC-CAN.
       FIN-KEY-DBC-CAN.
           EXIT.
       
       KEY-VEN-CAN SECTION.
       INI-KEY-VEN-CAN.
           MOVE VEN-NUM-IVCT IN CAN-FLD TO VEN-NUM-IVCT IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.         
       FIN-KEY-VEN-CAN.
           EXIT.
       
       KEY-RCV-CAN SECTION.
       INI-KEY-RCV-CAN.
       FIN-KEY-RCV-CAN.
           EXIT.
       
       KEY-ROV-CAN SECTION.
       INI-KEY-ROV-CAN.
       FIN-KEY-ROV-CAN.
           EXIT.
       
       KEY-ICG-CAN SECTION.
       INI-KEY-ICG-CAN.
       FIN-KEY-ICG-CAN.
           EXIT.
       
       KEY-COM-CAN SECTION.
       INI-KEY-COM-CAN.
       FIN-KEY-COM-CAN.
           EXIT.
       
       KEY-CYA-CAN SECTION.
       INI-KEY-CYA-CAN.
       FIN-KEY-CYA-CAN.
           EXIT.
       
       SCR-CLRA-CAN SECTION.
       INI-SCR-CLRA-CAN.
           PERFORM CLR-KEY-CAN.
           PERFORM CLR-FLD-CAN.
       FIN-SCR-CLRA-CAN.
           EXIT.
       
       CLR-KEY-CAN SECTION.
       INI-CLR-KEY-CAN.
           MOVE SPACES TO CAN-CAI-IOPC IN CAN-FLD.
           MOVE ZEROES TO CAN-IIC-IOPC IN CAN-FLD.
           MOVE ZEROES TO CAN-NUM-ICAN IN CAN-FLD.
           MOVE ZEROES TO VEN-NUM-IVCT IN CAN-FLD.
           MOVE ZEROES TO VEN-NUM-IVEN IN CAN-FLD.                      
       FIN-CLR-KEY-CAN.
           EXIT.
       
       CLR-FLD-CAN SECTION.
       INI-CLR-FLD-CAN.
           MOVE SPACES TO FRM-GLS-TVOC IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-OFOC IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-CANC IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-RCAN IN CAN-FLD.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-TINT IN CAN-FLD.
           MOVE ZEROES TO FRM-SGV-TINT IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-IITR IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-OFCA IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-SCTB IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-TCYA IN CAN-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN CAN-FLD.
           PERFORM CLR-OPC-CAN.
           PERFORM CLR-CAN-CAN.
           PERFORM CLR-DBC-CAN.
           PERFORM CLR-VEN-CAN.
           PERFORM CLR-RCV-CAN.
           PERFORM CLR-ROV-CAN.
           PERFORM CLR-ICG-CAN.
           PERFORM CLR-COM-CAN.
           PERFORM CLR-CYA-CAN.
       FIN-CLR-FLD-CAN.
           EXIT.
       
       CLR-OPC-CAN SECTION.
       INI-CLR-OPC-CAN.
           MOVE SPACES TO OPC-MSC-TVOC IN CAN-FLD.
           MOVE SPACES TO OPC-COD-TOOC IN CAN-FLD.
           MOVE SPACES TO OPC-COD-OFOC IN CAN-FLD.
           MOVE ZEROES TO OPC-NUM-VCVG IN CAN-FLD.
           MOVE SPACES TO OPC-COD-AOOC IN CAN-FLD.
           MOVE SPACES TO OPC-COD-VCOC IN CAN-FLD.
           MOVE ZEROES TO OPC-VAL-SCRE IN CAN-FLD.
       FIN-CLR-OPC-CAN.
           EXIT.
       
       CLR-CAN-CAN SECTION.
       INI-CLR-CAN-CAN.
           MOVE SPACES TO CAN-MSC-CANC IN CAN-FLD.
           MOVE SPACES TO CAN-MSC-STAT IN CAN-FLD.
           MOVE SPACES TO CAN-COD-RCAN IN CAN-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CAN-FEC-FOUT IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CAN-FEC-FCAN IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CAN-FEC-FEGR IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CAN-SGV-GAST IN CAN-FLD.
           MOVE ZEROES TO CAN-NUM-PLCO IN CAN-FLD.
           MOVE ZEROES TO CAN-SGV-COMI IN CAN-FLD.
           MOVE SPACES TO CAN-COD-OFCA IN CAN-FLD.
           MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD.
           MOVE ZEROES TO CAN-SGV-TPAG IN CAN-FLD.
           MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.
       FIN-CLR-CAN-CAN.
           EXIT.
       
       CLR-DBC-CAN SECTION.
       INI-CLR-DBC-CAN.
           MOVE SPACES TO DBC-GLS-NOMC IN CAN-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN CAN-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN CAN-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN CAN-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN CAN-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-DBC-CAN.
           EXIT.
       
       CLR-VEN-CAN SECTION.
       INI-CLR-VEN-CAN.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO VEN-FEC-FVEN IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO VEN-FEC-FIMV IN CAN-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO VEN-IND-SCTB IN CAN-FLD.
           MOVE ZEROES TO VEN-NUM-IVEN IN CAN-FLD.
           MOVE ZEROES TO VEN-VAL-SCAP IN CAN-FLD.
           MOVE ZEROES TO VEN-VAL-SFIN IN CAN-FLD.
       FIN-CLR-VEN-CAN.
           EXIT.
       
       CLR-RCV-CAN SECTION.
       INI-CLR-RCV-CAN.
           MOVE SPACES TO RCV-MSC-MCAN IN CAN-FLD.
           MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD.
           MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD.
       FIN-CLR-RCV-CAN.
           EXIT.
       
       CLR-ROV-CAN SECTION.
       INI-CLR-ROV-CAN.
           MOVE SPACES TO ROV-CAI-IOPC IN CAN-FLD.
           MOVE ZEROES TO ROV-IIC-IOPC IN CAN-FLD.
       FIN-CLR-ROV-CAN.
           EXIT.
       
       CLR-ICG-CAN SECTION.
       INI-CLR-ICG-CAN.
           MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD.
       FIN-CLR-ICG-CAN.
           EXIT.
       
       CLR-COM-CAN SECTION.
       INI-CLR-COM-CAN.
           MOVE ZEROES TO COM-SGV-TINT IN CAN-FLD.
       FIN-CLR-COM-CAN.
           EXIT.
       
       CLR-CYA-CAN SECTION.
       INI-CLR-CYA-CAN.
           MOVE SPACES TO CYA-IND-TCYA IN CAN-FLD.
           MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD.
           MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD.
       FIN-CLR-CYA-CAN.
           EXIT.
       
       FST-KEY-CAN SECTION.
       INI-FST-KEY-CAN.
           MOVE -1 TO CAN-CAI-IOPC-LEN IN CAN-FLD.
       FIN-FST-KEY-CAN.
           EXIT.
       
       FST-FLD-CAN SECTION.
       INI-FST-FLD-CAN.
           MOVE -1 TO CAN-MSC-CANC-LEN IN CAN-FLD.
       FIN-FST-FLD-CAN.
           EXIT.
       
       PRO-KEY-CAN SECTION.
       INI-PRO-KEY-CAN.
           PERFORM PRO-IKY-CAN.
           PERFORM PRO-AKY-CAN.
           PERFORM PRO-MKY-CAN.
       FIN-PRO-KEY-CAN.
           EXIT.
       
       PRO-IKY-CAN SECTION.
       INI-PRO-IKY-CAN.
           MOVE FRM-CPIM-AEY TO CAN-CAI-IOPC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-IIC-IOPC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-NUM-IVCT-ATR IN CAN-FLD.
       FIN-PRO-IKY-CAN.
           EXIT.
       
       PRO-MKY-CAN SECTION.
       INI-PRO-MKY-CAN.
       FIN-PRO-MKY-CAN.
           EXIT.
       
       PRO-AKY-CAN SECTION.
       INI-PRO-AKY-CAN.
           MOVE FRM-CPIM-AEY TO CAN-NUM-ICAN-ATR IN CAN-FLD.
       FIN-PRO-AKY-CAN.
           EXIT.
       
       PRO-FLD-CAN SECTION.
       INI-PRO-FLD-CAN.
           PERFORM PRO-OPC-CAN.
           PERFORM PRO-CAN-CAN.
           PERFORM PRO-DBC-CAN.
           PERFORM PRO-VEN-CAN.
           PERFORM PRO-RCV-CAN.
           PERFORM PRO-ROV-CAN.
           PERFORM PRO-ICG-CAN.
           PERFORM PRO-COM-CAN.
           PERFORM PRO-CYA-CAN.
       FIN-PRO-FLD-CAN.
           EXIT.
       
       PRO-OPC-CAN SECTION.
       INI-PRO-OPC-CAN.
       FIN-PRO-OPC-CAN.
           EXIT.
       
       PRO-CAN-CAN SECTION.
       INI-PRO-CAN-CAN.
           MOVE FRM-CPIM-AEY TO CAN-MSC-CANC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-COD-RCAN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-FEC-FCAN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-SGV-GAST-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-SGV-COMI-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-COD-OFCA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-SGV-TREN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CAN-SGV-TPAG-ATR IN CAN-FLD.
       FIN-PRO-CAN-CAN.
           EXIT.
       
       PRO-DBC-CAN SECTION.
       INI-PRO-DBC-CAN.
       FIN-PRO-DBC-CAN.
           EXIT.
       
       PRO-VEN-CAN SECTION.
       INI-PRO-VEN-CAN.
       FIN-PRO-VEN-CAN.
           EXIT.
       
       PRO-RCV-CAN SECTION.
       INI-PRO-RCV-CAN.
           MOVE FRM-CPIM-AEY TO RCV-SGV-CAPI-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO RCV-SGV-FINA-ATR IN CAN-FLD.
       FIN-PRO-RCV-CAN.
           EXIT.
       
       PRO-ROV-CAN SECTION.
       INI-PRO-ROV-CAN.
           MOVE FRM-CPIM-AEY TO ROV-CAI-IOPC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO ROV-IIC-IOPC-ATR IN CAN-FLD.
       FIN-PRO-ROV-CAN.
           EXIT.
       
       PRO-ICG-CAN SECTION.
       INI-PRO-ICG-CAN.
           MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN CAN-FLD.
       FIN-PRO-ICG-CAN.
           EXIT.
       
       PRO-COM-CAN SECTION.
       INI-PRO-COM-CAN.
           MOVE FRM-CPIM-AEY TO COM-SGV-TINT-ATR IN CAN-FLD.
       FIN-PRO-COM-CAN.
           EXIT.
       
       PRO-CYA-CAN SECTION.
       INI-PRO-CYA-CAN.
           MOVE FRM-CPIM-AEY TO CYA-IND-TCYA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CYA-CAI-ICYA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-AEY TO CYA-IIC-ICYA-ATR IN CAN-FLD.
       FIN-PRO-CYA-CAN.
           EXIT.
       
       UNP-KEY-CAN SECTION.
       INI-UNP-KEY-CAN.
           PERFORM UNP-IKY-CAN.
           PERFORM UNP-AKY-CAN.
           PERFORM UNP-MKY-CAN.
       FIN-UNP-KEY-CAN.
           EXIT.
       
       UNP-IKY-CAN SECTION.
       INI-UNP-IKY-CAN.
           MOVE FRM-CPIM-UBY TO CAN-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO CAN-IIC-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO VEN-NUM-IVCT-ATR.
       FIN-UNP-IKY-CAN.
           EXIT.
       
       UNP-MKY-CAN SECTION.
       INI-UNP-MKY-CAN.
       FIN-UNP-MKY-CAN.
           EXIT.
       
       UNP-AKY-CAN SECTION.
       INI-UNP-AKY-CAN.
           MOVE FRM-CPIM-UBY TO CAN-NUM-ICAN-ATR.
       FIN-UNP-AKY-CAN.
           EXIT.
       
       UNP-FLD-CAN SECTION.
       INI-UNP-FLD-CAN.
           PERFORM UNP-OPC-CAN.
           PERFORM UNP-CAN-CAN.
           PERFORM UNP-DBC-CAN.
           PERFORM UNP-VEN-CAN.
           PERFORM UNP-RCV-CAN.
           PERFORM UNP-ROV-CAN.
           PERFORM UNP-ICG-CAN.
           PERFORM UNP-COM-CAN.
           PERFORM UNP-CYA-CAN.
       FIN-UNP-FLD-CAN.
           EXIT.
       
       UNP-OPC-CAN SECTION.
       INI-UNP-OPC-CAN.
       FIN-UNP-OPC-CAN.
           EXIT.
       
       UNP-CAN-CAN SECTION.
       INI-UNP-CAN-CAN.
           MOVE FRM-CPIM-UBY TO CAN-MSC-CANC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-COD-RCAN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-FEC-FCAN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-SGV-GAST-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-SGV-COMI-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-COD-OFCA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-SGV-TREN-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CAN-SGV-TPAG-ATR IN CAN-FLD.
       FIN-UNP-CAN-CAN.
           EXIT.
       
       UNP-DBC-CAN SECTION.
       INI-UNP-DBC-CAN.
       FIN-UNP-DBC-CAN.
           EXIT.
       
       UNP-VEN-CAN SECTION.
       INI-UNP-VEN-CAN.
       FIN-UNP-VEN-CAN.
           EXIT.
       
       UNP-RCV-CAN SECTION.
       INI-UNP-RCV-CAN.
           MOVE FRM-CPIM-UBY TO RCV-SGV-CAPI-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO RCV-SGV-FINA-ATR IN CAN-FLD.
       FIN-UNP-RCV-CAN.
           EXIT.
       
       UNP-ROV-CAN SECTION.
       INI-UNP-ROV-CAN.
           MOVE FRM-CPIM-UBY TO ROV-CAI-IOPC-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO ROV-IIC-IOPC-ATR IN CAN-FLD.
       FIN-UNP-ROV-CAN.
           EXIT.
       
       UNP-ICG-CAN SECTION.
       INI-UNP-ICG-CAN.
           MOVE FRM-CPIM-UBY TO ICG-SGV-TINT-ATR IN CAN-FLD.
       FIN-UNP-ICG-CAN.
           EXIT.
       
       UNP-COM-CAN SECTION.
       INI-UNP-COM-CAN.
           MOVE FRM-CPIM-UBY TO COM-SGV-TINT-ATR IN CAN-FLD.
       FIN-UNP-COM-CAN.
           EXIT.
       
       UNP-CYA-CAN SECTION.
       INI-UNP-CYA-CAN.
           MOVE FRM-CPIM-UBY TO CYA-IND-TCYA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CYA-CAI-ICYA-ATR IN CAN-FLD.
           MOVE FRM-CPIM-UBY TO CYA-IIC-ICYA-ATR IN CAN-FLD.
       FIN-UNP-CYA-CAN.
           EXIT.
       
       VAL-KEY-CAN SECTION.
       INI-VAL-KEY-CAN.
           PERFORM VAL-IKY-CAN.
           PERFORM VAL-MKY-CAN.
           PERFORM VAL-AKY-CAN.
       FIN-VAL-KEY-CAN.
           EXIT.
       
       VAL-IKY-CAN SECTION.
       INI-VAL-IKY-CAN.
           PERFORM VAL-CAN-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-CAI-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-IKY-CAN.
           PERFORM VAL-CAN-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-IKY-CAN.
           PERFORM VAL-VEN-NUM-IVCT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-NUM-IVCT-LEN IN CAN-FLD
                GO TO FIN-VAL-IKY-CAN.
           PERFORM VAL-VEN-NUM-IVEN.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO VEN-NUM-IVEN-LEN IN CAN-FLD                  
                GO TO FIN-VAL-IKY-CAN.                                  
       FIN-VAL-IKY-CAN.
           EXIT.
       
       VAL-MKY-CAN SECTION.
       INI-VAL-MKY-CAN.
       FIN-VAL-MKY-CAN.
           EXIT.
       
       VAL-AKY-CAN SECTION.
       INI-VAL-AKY-CAN.
           PERFORM VAL-CAN-NUM-ICAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-NUM-ICAN-LEN IN CAN-FLD
                GO TO FIN-VAL-AKY-CAN.
       FIN-VAL-AKY-CAN.
           EXIT.
       
       VAL-FLD-CAN SECTION.
       INI-VAL-FLD-CAN.
           PERFORM VAL-OPC-MSC-TVOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-MSC-TVOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-COD-TOOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-COD-OFOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-COD-OFOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-TVOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TVOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-OFOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CAN-MSC-CANC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-MSC-CANC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-MSC-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-MSC-STAT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-STAT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-RCV-MSC-MCAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RCV-MSC-MCAN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-COD-RCAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-COD-RCAN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-CANC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CANC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-RCAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RCAN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-ROV-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ROV-CAI-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-ROV-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ROV-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CAN-FEC-FOUT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CAN-FEC-FOUT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CAN-FEC-FCAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CAN-FEC-FCAN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CAN-FEC-FEGR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CAN-FEC-FEGR-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-VEN-FEC-FVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                VEN-FEC-FVEN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-ICG-SGV-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ICG-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-VEN-FEC-FIMV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                VEN-FEC-FIMV-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-IND-TIPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-TIPE-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-SGV-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-COM-SGV-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO COM-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-IITR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-IITR-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-SGV-GAST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-SGV-GAST-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-NUM-VCVG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-NUM-VCVG-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-NUM-PLCO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-NUM-PLCO-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-SGV-COMI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-SGV-COMI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-COD-OFCA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-COD-OFCA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-OFCA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFCA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-SGV-TREN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-SGV-TREN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-COD-AOOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-SGV-TPAG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-SGV-TPAG-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-VEN-IND-SCTB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-IND-SCTB-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-SCTB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SCTB-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-VEN-NUM-IVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-NUM-IVEN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CYA-IND-TCYA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CYA-IND-TCYA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-TCYA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TCYA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-COD-VCOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-FRM-GLS-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCOC-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CYA-CAI-ICYA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CYA-CAI-ICYA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CYA-IIC-ICYA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CYA-IIC-ICYA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-OPC-VAL-SCRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-VAL-SCRE-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-CAN-SGV-DIFE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CAN-SGV-DIFE-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-VEN-VAL-SCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-SCAP-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-RCV-SGV-CAPI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RCV-SGV-CAPI-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-VEN-VAL-SFIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-SFIN-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
           PERFORM VAL-RCV-SGV-FINA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RCV-SGV-FINA-LEN IN CAN-FLD
                GO TO FIN-VAL-FLD-CAN.
       FIN-VAL-FLD-CAN.
           EXIT.
       
       VAL-OPC-MSC-TVOC SECTION.
       INI-VAL-OPC-MSC-TVOC.
       FIN-VAL-OPC-MSC-TVOC.
           EXIT.
       
       VAL-OPC-COD-TOOC SECTION.
       INI-VAL-OPC-COD-TOOC.
       FIN-VAL-OPC-COD-TOOC.
           EXIT.
       
       VAL-OPC-COD-OFOC SECTION.
       INI-VAL-OPC-COD-OFOC.
       FIN-VAL-OPC-COD-OFOC.
           EXIT.
       
       VAL-CAN-CAI-IOPC SECTION.
       INI-VAL-CAN-CAI-IOPC.
           IF CAN-CAI-IOPC IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CAN-CAI-IOPC IN CAN-FLD.
       FIN-VAL-CAN-CAI-IOPC.
           EXIT.
       
       VAL-CAN-IIC-IOPC SECTION.
       INI-VAL-CAN-IIC-IOPC.
       FIN-VAL-CAN-IIC-IOPC.
           EXIT.
       
       VAL-FRM-GLS-TVOC SECTION.
       INI-VAL-FRM-GLS-TVOC.
       FIN-VAL-FRM-GLS-TVOC.
           EXIT.
       
       VAL-FRM-GLS-TOOC SECTION.
       INI-VAL-FRM-GLS-TOOC.
       FIN-VAL-FRM-GLS-TOOC.
           EXIT.
       
       VAL-FRM-GLS-OFOC SECTION.
       INI-VAL-FRM-GLS-OFOC.
       FIN-VAL-FRM-GLS-OFOC.
           EXIT.
       
       VAL-CAN-NUM-ICAN SECTION.
       INI-VAL-CAN-NUM-ICAN.
       FIN-VAL-CAN-NUM-ICAN.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-VEN-NUM-IVCT SECTION.
       INI-VAL-VEN-NUM-IVCT.
      *<<<< VEN_NUM_IVCT
           MOVE VEN-NUM-IVCT IN CAN-FLD TO VEN-NUM-IVEN IN CAN-FLD.
      *>>>>
       FIN-VAL-VEN-NUM-IVCT.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN CAN-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN CAN-FLD.
      *VAL-RUT Valida Rut para campo IDC                                
           MOVE IDC-ZERO-S TO IDC-ZERO.                                 
           MOVE DBC-NUM-ICLI IN CAN-FLD TO IDC-NUM-RUTV.                
           MOVE DBC-VRF-ICLI IN CAN-FLD TO IDC-VRF-RUTV.                
           PERFORM VAL-RUT.                                             
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN CAN-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN CAN-FLD.
      *VAL-IDC Valida identificador                                     
           MOVE DBC-IND-ICLI IN CAN-FLD TO IDC-IND-RUTV.                
           PERFORM VAL-IDC.                                             
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN CAN-FLD.                
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN CAN-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN CAN-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN CAN-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN CAN-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CAN-MSC-CANC SECTION.
       INI-VAL-CAN-MSC-CANC.
           IF CAN-MSC-CANC IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CAN-MSC-CANC IN CAN-FLD.
      *<<<< CAN_MSC_CANC
      *LRH ini 31-MAR-1994 
           IF CAN-MSC-CANC IN CAN-FLD = 'CIE' OR 'PTT' OR 'KTT'
      *DAD ini  07-JUL-1994   (Memo.07-07-94 Pto.3)
               IF OPC-IND-VSTR IN OPC = 'S' 
      *DAD fin  07-JUL-1994
                   MOVE CAN-CAI-IOPC IN CAN-FLD TO EVC-CAI-IOPC IN EVC
                   MOVE CAN-IIC-IOPC IN CAN-FLD TO EVC-IIC-IOPC IN EVC
                   MOVE 1                       TO EVC-NUM-IEVC IN EVC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-EVC
                   IF NOT FIO-STAT-OKS
                       MOVE 'COL'         TO MSG-COD-SIST
                       MOVE 'EVC    NOEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CAN-MSC-CANC
                   ELSE
                       MOVE 'COL'          TO TAB-COD-SIST FIO-SIST
                       MOVE 'CVC'          TO TAB-CIC-TTAB IN TAB
                       MOVE 'FP'           TO TAB-CIC-CTAB IN TAB
                       MOVE FIO-GET-KEY    TO FIO-CMND
                       MOVE 'TAB-CIC-TABL' TO FIO-AKEY
                       PERFORM GNS-FIO-TAB
                       IF NOT FIO-STAT-OKS
                           MOVE 'COL'          TO MSG-COD-SIST
                           MOVE 'CIC    FPNEX' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           GO TO FIN-VAL-CAN-MSC-CANC
                       ELSE
                           IF EVC-MSC-TCVE IN EVC = TAB-COD-CTAB IN TAB
                               MOVE 'COL'          TO MSG-COD-SIST
                               MOVE 'MSCCANC NOFP' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE FRM-SUAR-MAL TO FRM-SUAR
                               GO TO FIN-VAL-CAN-MSC-CANC.
      *LRH fin 31-MAR-1994 
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'CNC ' TO TAB-COD-TTAB IN TAB.
           MOVE CAN-MSC-CANC IN CAN-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CAN-MSC-CANC IN CAN-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CANC IN CAN-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CANC IN CAN-FLD.
           IF TAB-GLS-DATA IN TAB (1:4) NOT = SPACES                    
              MOVE TAB-GLS-DATA IN TAB (1:4) TO CCO-COD-EVEN-ANT        
           ELSE                                                         
              MOVE 'CAN ' TO CCO-COD-EVEN-ANT                           
           END-IF                                                       
           IF TAB-GLS-DATA IN TAB (5:4) NOT = SPACES                    
              MOVE TAB-GLS-DATA IN TAB (5:3) TO CCO-COD-EVEN-VEN        
           ELSE                                                         
              MOVE 'CAN ' TO CCO-COD-EVEN-VEN                           
           END-IF.                                                      
           MOVE CAN-MSC-CANC IN CAN-FLD (1:1) TO WSS-TIP-VALI.          
           MOVE ROV-CAI-IOPC IN CAN-FLD       TO WSS-GLS-OPEA (1:4).    
           MOVE ROV-IIC-IOPC IN CAN-FLD       TO WSS-GLS-OPEA (5:8).    
           MOVE CAN-CAI-IOPC IN CAN-FLD       TO DLC-CAI-IOPC IN DLC.   
           MOVE CAN-IIC-IOPC IN CAN-FLD       TO DLC-IIC-IOPC IN DLC.   
           MOVE  001                          TO DLC-NUM-IDLC IN DLC.   
           MOVE FIO-GET-KEY                   TO FIO-CMND.              
           PERFORM COL-FIO-DLC.                                         
           IF SCR-CMND  = 'SCA'                                         
               GO TO SALTA-PARA-SCA.                                    
           PERFORM VAL-PAG-VCD.                                         
      *AFRI-INI/JUL2015 ERROR CAE COMISION CUOTA 1                      
           MOVE CAN-CAI-IOPC IN CAN-FLD       TO DLC-CAI-IOPC IN DLC.
           MOVE CAN-IIC-IOPC IN CAN-FLD       TO DLC-IIC-IOPC IN DLC.
           MOVE GAR-CT-1                      TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY                   TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF ( DLC-IND-SCTB IN DLC NOT = GAR-CT-CAS AND
              DLC-IND-SCTB IN DLC NOT = GAR-CT-VCD )
              MOVE CAN-CAI-IOPC IN CAN-FLD TO WSS-CAI-OPCR IN PVE-VARI
              MOVE CAN-IIC-IOPC IN CAN-FLD TO WSS-IIC-OPCR IN PVE-VARI.
      *AFRI-FIN/JUL2015 ERROR CAE COMISION CUOTA 1
           IF MSG-COD-MENS > SPACES                                     
                MOVE 'COL'          TO MSG-COD-SIST                     
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
                GO TO FIN-VAL-CAN-MSC-CANC.                             
       SALTA-PARA-SCA.                                                  
       FIN-VAL-CAN-MSC-CANC.
           EXIT.
       
       VAL-CAN-MSC-STAT SECTION.
       INI-VAL-CAN-MSC-STAT.
       FIN-VAL-CAN-MSC-STAT.
           EXIT.
       
       VAL-FRM-GLS-STAT SECTION.
       INI-VAL-FRM-GLS-STAT.
       FIN-VAL-FRM-GLS-STAT.
           EXIT.
       
       VAL-RCV-MSC-MCAN SECTION.
       INI-VAL-RCV-MSC-MCAN.
       FIN-VAL-RCV-MSC-MCAN.
           EXIT.
       
       VAL-CAN-COD-RCAN SECTION.
       INI-VAL-CAN-COD-RCAN.
           IF CAN-COD-RCAN IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CAN-COD-RCAN IN CAN-FLD.
      *<<<< CAN_COD_RCAN
           IF  CAN-COD-RCAN IN CAN-FLD NOT > SPACES
                MOVE OPC-COD-RMOC IN OPC TO CAN-COD-RCAN IN CAN-FLD.
      * RBG/INI/6-SEP-1996 
      *AFRI-INI                                                         
           IF SCR-HDR-MRCA = 'BCS' OR                                   
              SCR-USER = 'COLPGCA1'                                     
      *    IF SCR-USER = 'COLPGCA1'                                     
      *AFRI-FIN                                                         
               GO TO FIN-VAL-CAN-COD-RCAN.
      * RBG/FIN/6-SEP-1996 
      *>>>>
      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.
           MOVE CAN-COD-RCAN IN CAN-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              CAN-COD-RCAN IN CAN-FLD > SPACES
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RCAN IN CAN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-RCAN IN CAN-FLD.
      *<<<< FIN_CAN_COD_RCAN                                            
      *ALD-BCI-INI/12.01.2000                                           
           IF MSG-COD-MENS > SPACES                                     
               IF SCR-CMND = 'SCA'                                      
                   MOVE SPACES TO FRM-MENS                              
                   MOVE FRM-SUAR-OKS TO FRM-SUAR                        
      *            MOVE SPACES TO FRM-GLS-RCAN IN CAN-FLD               
                   GO TO FIN-VAL-CAN-COD-RCAN.                          
      *ALD-BCI-FIN/12.01.2000                                           
      *>>>>                                                             
      *<<<< FIN_CAN_COD_RCAN                                            
      *ALD-BCI-INI/12.01.2000                                           
           IF MSG-COD-MENS > SPACES                                     
               IF SCR-CMND = 'SCA'                                      
                   MOVE SPACES TO FRM-MENS                              
                   MOVE FRM-SUAR-OKS TO FRM-SUAR                        
      *            MOVE SPACES TO FRM-GLS-RCAN IN CAN-FLD               
                   GO TO FIN-VAL-CAN-COD-RCAN.                          
      *ALD-BCI-FIN/12.01.2000                                           
      *>>>>                                                             
       FIN-VAL-CAN-COD-RCAN.
           EXIT.
       
       VAL-FRM-GLS-CANC SECTION.
       INI-VAL-FRM-GLS-CANC.
       FIN-VAL-FRM-GLS-CANC.
           EXIT.
       
       VAL-FRM-GLS-RCAN SECTION.
       INI-VAL-FRM-GLS-RCAN.
       FIN-VAL-FRM-GLS-RCAN.
           EXIT.
       
       VAL-ROV-CAI-IOPC SECTION.
       INI-VAL-ROV-CAI-IOPC.
           IF ROV-CAI-IOPC IN CAN-FLD NOT > SPACES
              MOVE SPACES TO ROV-CAI-IOPC IN CAN-FLD.
      *<<<< ROV_CAI_IOPC
      *ISP SCR-MSC-TCAN SERA USADO EN VALIDACION DE CONSISTENCIA
           MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-CANC.
      *>>>>
       FIN-VAL-ROV-CAI-IOPC.
           EXIT.
       
       VAL-ROV-IIC-IOPC SECTION.
       INI-VAL-ROV-IIC-IOPC.
      *<<<< ROV_IIC_IOPC
           IF ROV-CAI-IOPC IN CAN-FLD     > SPACES AND
              ROV-IIC-IOPC IN CAN-FLD NOT > ZEROES
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CICIOPCBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-ROV-IIC-IOPC.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CAN-FEC-FOUT SECTION.
       INI-VAL-CAN-FEC-FOUT.
           IF CAN-FEC-FOUT IN CAN-FLD  NOT > ZEROES
              MOVE ZEROES TO CAN-FEC-FOUT IN CAN-FLD.
      *<<<< CAN_FEC_FOUT
           IF CAN-FEC-FOUT IN CAN-FLD NOT > SPACES
              MOVE ZEROES TO CAN-FEC-FOUT IN CAN-FLD.
      *>>>>
      *<<<< CAN_FEC_FOUT
           PERFORM GET-FHOY.
      *JUS ini 16-NOV-1994   Asigno Fecha Computacional a Fecha Contable
      * Anulo asignaciones y Anulo retroceso de Fecha
      *     MOVE HOY-DHOY TO CAN-NUM-DOUT IN CAN-FLD
      *                      CAN-NUM-DEGR IN CAN-FLD.
      *     MOVE HOY-MHOY TO CAN-NUM-MOUT IN CAN-FLD
      *                      CAN-NUM-MEGR IN CAN-FLD.
      *     MOVE HOY-SHOY TO CAN-NUM-SOUT IN CAN-FLD
      *                      CAN-NUM-SEGR IN CAN-FLD.
      *     MOVE HOY-AHOY TO CAN-NUM-AOUT IN CAN-FLD
      *                      CAN-NUM-AEGR IN CAN-FLD.
      *DAD ini  19-FEB-1993   (Memo.14-10-92 Pto.1)
                                                                        
      *AFRI-INI/DIC-2007.                                               
           IF EIBTRNID = 'KDGS'                                         
              MOVE CAN-FEC-FCAN IN CAN-FLD TO CAN-FEC-FOUT IN CAN-FLD   
           ELSE                                                         
              MOVE HOY-DHOY TO CAN-NUM-DOUT IN CAN-FLD                  
              MOVE HOY-MHOY TO CAN-NUM-MOUT IN CAN-FLD                  
              MOVE HOY-SHOY TO CAN-NUM-SOUT IN CAN-FLD                  
           MOVE HOY-AHOY TO CAN-NUM-AOUT IN CAN-FLD.
      *AFRI-FIN/DIC-2007.                                               
                                                                        
           MOVE HOY-DHOY TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE HOY-MHOY TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE HOY-SHOY TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE HOY-AHOY TO WSS-NUM-ACTB IN WSS-VARI.
       BUS-DIA-HBL-PRV.
      *RST-DIA Retrocede 1 dia la Fecha
           MOVE WSS-NUM-DCTB IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MCTB IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SCTB IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ACTB IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CAN-FEC-FOUT.
           MOVE FEC-ITM1 TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-ACTB IN WSS-VARI.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
                GO TO BUS-DIA-HBL-PRV.
      *DAD fin  19-FEB-1993
      *JUS fin 16-NOV-1994
      *>>>>
       FIN-VAL-CAN-FEC-FOUT.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CAN-FEC-FCAN SECTION.
       INI-VAL-CAN-FEC-FCAN.
           IF CAN-FEC-FCAN IN CAN-FLD  NOT > ZEROES
              MOVE ZEROES TO CAN-FEC-FCAN IN CAN-FLD.
      *VAL-FEC Validar Fecha
           MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CAN_FEC_FCAN
           IF CAN-FEC-FCAN IN CAN-FLD NOT > ZEROES
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FCAN IN CAN-FLD
                                               FEC-FECH.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CAN-FEC-FCAN IN CAN-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CAN-FEC-FCAN.
      *<<<< CAN_FEC_FCAN
           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN.
                                                                        
      *AFRI-INI/DIC2005                                                 
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST                 
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB                   
           MOVE 'PERMITEPARCI' TO TAB-COD-CTAB IN TAB                   
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM GNS-FIO-TAB                                          
           IF FIO-STAT-OKS AND                                          
              TAB-IND-VIGE IN TAB = 'S'                                 
               IF CAN-MSC-CANC IN CAN-FLD = 'CIE'                       
                   MOVE CAN-NUM-SCAN IN CAN     TO FEC-SEC1             
                   MOVE CAN-NUM-ACAN IN CAN     TO FEC-AEC1             
                   MOVE CAN-NUM-MCAN IN CAN     TO FEC-MEC1             
                   MOVE CAN-NUM-DCAN IN CAN     TO FEC-DEC1             
                   MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2             
                   MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2             
                   MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2             
                   MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2             
                   IF FEC-FEC1 > FEC-FEC2                               
                       MOVE 'EXISTECAN' TO MSG-COD-MENS                 
                       GO TO CONT-PROCESO-FCAN.                         
      *AFRI-FIN/DIC2005                                                 
      *ALD-BCI-INI/21-08-1998                                           
           MOVE 'NOEXISTECAN' TO MSG-COD-MENS.                          
      *ALD-BCI-FIN/21-08-1998                                           
       LEE-NXT-CAN.
           SUBTRACT 1 FROM CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
               IF CAN-MSC-STAT IN CAN NOT = 'R' AND
                  CAN-SGV-TPAG IN CAN NOT < ZEROES AND
                  CAN-SGV-TREN IN CAN NOT < ZEROES
                   MOVE CAN-NUM-SCAN IN CAN     TO FEC-SEC1
                   MOVE CAN-NUM-ACAN IN CAN     TO FEC-AEC1
                   MOVE CAN-NUM-MCAN IN CAN     TO FEC-MEC1
                   MOVE CAN-NUM-DCAN IN CAN     TO FEC-DEC1
                   MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC            TO FEC-FORM
                   MOVE FEC-CMP-FEC             TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'COL'         TO MSG-COD-SIST
                       MOVE 'FECFCANANT>' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CAN-FEC-FCAN
                   ELSE
      *ALD-BCI-INI/21-08-1998                                           
                       MOVE 'EXISTECAN' TO MSG-COD-MENS                 
      *                NEXT SENTENCE                                    
      *ALD-BCI-FIN/21-08-1998                                           
               ELSE
                   GO TO LEE-NXT-CAN.

      *AFRI-INI/DIC2005                                                 
       CONT-PROCESO-FCAN.                                               
      *AFRI-FIN/DIC2005                                                 
      *ALD-BCI-INI/21-08-1998                                           
           IF MSG-COD-MENS = 'EXISTECAN'                                
               MOVE SPACES TO MSG-COD-MENS.                             
           IF MSG-COD-MENS = 'NOEXISTECAN'                              
               MOVE SPACES TO MSG-COD-MENS                              
               MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC      
               MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC      
               MOVE ZEROES                  TO DLC-NUM-IDLC IN DLC      
               MOVE FIO-GET-NLS TO FIO-CMND                             
               PERFORM COL-FIO-DLC                                      
               IF FIO-STAT-OKS AND                                      
                  CAN-CAI-IOPC IN CAN-FLD = DLC-CAI-IOPC IN DLC AND     
                  CAN-IIC-IOPC IN CAN-FLD = DLC-IIC-IOPC IN DLC         
                   IF DLC-IND-SCTB IN DLC = 'VCD' OR                    
                      DLC-IND-SCTB IN DLC = 'CAS'                       
                       MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC1         
                       MOVE VEN-NUM-SIMV IN CAN-FLD TO FEC-SEC2         
                       MOVE VEN-NUM-AIMV IN CAN-FLD TO FEC-AEC2         
                       MOVE VEN-NUM-MIMV IN CAN-FLD TO FEC-MEC2         
                       MOVE VEN-NUM-DIMV IN CAN-FLD TO FEC-DEC2         
                       MOVE FEC-FORM-FEC            TO FEC-FORM         
                       MOVE FEC-CMP-FEC             TO FEC-CMND         
                       PERFORM PRO-FEC                                  
                       IF FEC-STAT-LES                                  
                           MOVE 'COL'          TO MSG-COD-SIST          
                           MOVE 'FECFCANFIMV<' TO MSG-COD-MENS          
                           PERFORM GET-MSG                              
                           MOVE MSG-GLS-DESC TO FRM-MENS                
                           MOVE FRM-SUAR-MAL TO FRM-SUAR                
                           GO TO FIN-VAL-CAN-FEC-FCAN.                  
      *ALD-BCI-INI/21-08-1998                                           
                                                                        
           IF CAN-FEC-FCAN IN CAN-FLD > ZEROES
               MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC1
               MOVE OPC-NUM-SCOL IN OPC     TO FEC-SEC2
               MOVE OPC-NUM-ACOL IN OPC     TO FEC-AEC2
               MOVE OPC-NUM-MCOL IN OPC     TO FEC-MEC2
               MOVE OPC-NUM-DCOL IN OPC     TO FEC-DEC2
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-CMP-FEC             TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-LES
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'FECFCANFCOL<' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
      *DAD ini  19-FEB-1993   (Memo.14-10-92 Pto.1)
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CAN-FEC-FCAN.

           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-NUM-DAUX IN WSS-VARI.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-NUM-MAUX IN WSS-VARI.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-NUM-SAUX IN WSS-VARI.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-NUM-AAUX IN WSS-VARI.
      *DAD fin  19-FEB-1993
      *PVG INI 17-OCT-2003                                              
           IF SCR-MSC-TCAN = 'P' OR                                     
              VEN-IND-SCTB IN VEN NOT = 'MOR' OR                        
              ( CAN-MSC-CANC IN CAN-FLD = 'PTT' OR 'PTE' )              
              GO TO FIN-VAL-CAN-FEC-FCAN.                               
                                                                        
           MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC.         
           MOVE ZEROES                  TO DLC-NUM-IDLC IN DLC.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-DLC.                                         
           IF DLC-IND-SCTB IN DLC = 'VCD' OR                            
              DLC-IND-SCTB IN DLC = 'CAS'                               
              GO TO FIN-VAL-CAN-FEC-FCAN.                               
                                                                        
           PERFORM GET-FHOY.                                            
      *AFRI-INI-NOV-2005                                                
           IF SCR-USER = 'COLPGCA1'                                     
               GO TO NO-VAL-ICM.                                        
      *AFRI-FIN-NOV-2005                                                
           IF WSS-FEC-FAUX IN WSS-VARI NOT = HOY-FHOY IN HOY-VARI AND   
              SCR-CMND NOT = 'ICM'                                      
              MOVE 'COL'          TO MSG-COD-SIST                       
              MOVE 'FECFCANFHOYN' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-CAN-FEC-FCAN.                               
           IF SCR-CMND = 'ICM' AND                                      
              WSS-FEC-FAUX IN WSS-VARI = HOY-FHOY IN HOY-VARI           
              MOVE 'COL'          TO MSG-COD-SIST                       
              MOVE 'CMNINVCANMOR' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-CAN-FEC-FCAN.                               
      *PVG FIN 17-OCT-2003                                              
      *AFRI-INI-NOV-2005                                                
       NO-VAL-ICM.                                                      
      *AFRI-FIN-NOV-2005                                                
      *>>>>
       FIN-VAL-CAN-FEC-FCAN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CAN-FEC-FEGR SECTION.
       INI-VAL-CAN-FEC-FEGR.
           IF CAN-FEC-FEGR IN CAN-FLD  NOT > ZEROES
              MOVE ZEROES TO CAN-FEC-FEGR IN CAN-FLD.
      *<<<< CAN_FEC_FEGR
           IF CAN-FEC-FEGR IN CAN-FLD NOT > SPACES
              MOVE ZEROES TO CAN-FEC-FEGR IN CAN-FLD.
      *>>>>
       FIN-VAL-CAN-FEC-FEGR.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-VEN-FEC-FVEN SECTION.
       INI-VAL-VEN-FEC-FVEN.
           IF VEN-FEC-FVEN IN CAN-FLD  NOT > ZEROES
              MOVE ZEROES TO VEN-FEC-FVEN IN CAN-FLD.
      *<<<< VEN_FEC_FVEN
           IF VEN-FEC-FVEN IN CAN-FLD NOT > SPACES
              MOVE ZEROES TO VEN-FEC-FVEN IN CAN-FLD.
      *>>>>
       FIN-VAL-VEN-FEC-FVEN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-ICG-SGV-TINT SECTION.
       INI-VAL-ICG-SGV-TINT.
      *<<<< ICG_SGV_TINT
                                                                        
      *PVG INI 17-OCT-2003                                              
           IF ( SCR-MSC-TCAN = 'P'               OR                     
                VEN-IND-SCTB IN VEN NOT = 'MOR'  OR                     
              ( CAN-MSC-CANC IN CAN-FLD = 'PTT' OR 'PTE' ) OR           
               (SCR-CMND NOT = 'ING' AND                                
                SCR-CMND NOT = 'MOD' AND                                
                SCR-CMND NOT = 'ICM'           ) OR                     
                WSS-IBLK-TINT = 'S'                )                    
              GO TO NO-VAL-ICG-SGV-TINT.                                
                                                                        
           MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC.         
           MOVE ZEROES                  TO DLC-NUM-IDLC IN DLC.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-DLC.                                         
           IF DLC-IND-SCTB IN DLC = 'VCD' OR                            
              DLC-IND-SCTB IN DLC = 'CAS'                               
              GO TO NO-VAL-ICG-SGV-TINT.                                
                                                                        
           MOVE OPC-CAI-IOPC IN OPC TO ICG-CAI-IOPC IN ICG.             
           MOVE OPC-IIC-IOPC IN OPC TO ICG-IIC-IOPC IN ICG.             
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.             
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.             
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.             
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.             
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-ICG.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN OPC AND       
                    ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN OPC AND       
                    ICG-NUM-ICAN IN ICG = ZEROES AND                    
                    ICG-CIC-IOPV IN ICG = SPACES AND                    
                    ICG-NUM-IVCT IN ICG = ZEROES AND                    
                    ICG-IND-TTAS IN ICG = 'INT' )                       
              MOVE 'COL'        TO MSG-COD-SIST                         
              MOVE 'ICG    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-ICG-SGV-TINT.                               
                                                                        
           MOVE ICG-COD-TINT IN ICG TO INT-TIPT.                        
           MOVE ZEROES              TO WSS-INT-TMAX IN WSS-VARI.        
           IF INT-CVTI NOT > SPACES                                     
              GO TO CON-VAL-ICG-SGV-TINT.                               
                                                                        
      *LOP-INI 20-01-2004 CREDITO SIN MORA                              
           IF CAN-MSC-CANC IN CAN-FLD = 'CXE'                           
              MOVE 'COL'          TO MSG-COD-SIST                       
              MOVE 'TASVAR   CSM' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              GO TO FIN-VAL-ICG-SGV-TINT.                               
      *LOP-FIN 20-01-2004 CREDITO SIN MORA                              
                                                                        
           MOVE INT-TINT TO INT-TIPE.                                   
           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DDMA.                    
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MDMA.                    
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SDMA.                    
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ADMA.                    
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.                    
                                                                        
           MOVE INT-FINT TO CAM-FEC-FCAM IN CAM(1).                     
           MOVE INT-FINT TO CAM-FEC-FCAM IN CAM(2).                     
           MOVE 'I'      TO CAM-MSC-TVAL IN CAM(1).                     
           MOVE INT-CVTI TO CAM-COD-CVAL IN CAM(1).                     
           MOVE INT-PBTI TO CAM-COD-TCAM IN CAM(1).                     
           MOVE INT-VCAM TO CAM-COD-VCAM IN CAM(2).                     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S'                
              MOVE CAM-SGV-VCAM IN CAM TO WSS-INT-TMAX                  
           ELSE                                                         
              IF NOT FIO-STAT-OKS                                       
                 MOVE 'COL'               TO MSG-COD-SIST               
                 MOVE 'CAMBTSANXABT'      TO MSG-COD-MENS               
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC        TO FRM-MEN1                   
                 MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2                   
                 MOVE FRM-SUAR-MAL        TO FRM-SUAR                   
                 GO TO FIN-VAL-ICG-SGV-TINT                             
              ELSE                                                      
                 IF CAM-MSC-STAT IN CAM NOT = 'S'                       
                    MOVE 'COL'               TO MSG-COD-SIST            
                    MOVE 'CAMBTSANVABT'      TO MSG-COD-MENS            
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC        TO FRM-MEN1                
                    MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2                
                    MOVE FRM-SUAR-MAL        TO FRM-SUAR                
                    GO TO FIN-VAL-ICG-SGV-TINT.                         
                                                                        
       CON-VAL-ICG-SGV-TINT.                                            
           IF ICG-SGV-TINT IN CAN-FLD < FRM-SGV-TINT IN CAN-FLD         
              MOVE 'COL'                    TO MSG-COD-SIST             
              MOVE 'TASACAN<TCRE'           TO MSG-COD-MENS             
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC             TO FRM-MENS                 
              MOVE FRM-SUAR-MAL             TO FRM-SUAR                 
              GO TO FIN-VAL-ICG-SGV-TINT.                               
                                                                        
           ADD WSS-INT-TMAX IN WSS-VARI TO ICG-SGV-TINT IN CAN-FLD.     
                                                                        
       NO-VAL-ICG-SGV-TINT.                                             
      *PVG FIN 17-OCT-2003                                              
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.
      *     IF CAN-FEC-FCAN IN CAN < VEN-FEC-FIMV IN VEN
      *         MOVE 'N' TO WSS-IBLK-TINT.
      *>>>>
       FIN-VAL-ICG-SGV-TINT.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-VEN-FEC-FIMV SECTION.
       INI-VAL-VEN-FEC-FIMV.
           IF VEN-FEC-FIMV IN CAN-FLD  NOT > ZEROES
              MOVE ZEROES TO VEN-FEC-FIMV IN CAN-FLD.
      *<<<< VEN_FEC_FIMV
           IF VEN-FEC-FIMV IN CAN-FLD NOT > SPACES
              MOVE ZEROES TO VEN-FEC-FIMV IN CAN-FLD.
      *>>>>
       FIN-VAL-VEN-FEC-FIMV.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-IND-TIPE SECTION.
       INI-VAL-FRM-IND-TIPE.
       FIN-VAL-FRM-IND-TIPE.
           EXIT.
       
       VAL-FRM-GLS-TINT SECTION.
       INI-VAL-FRM-GLS-TINT.
       FIN-VAL-FRM-GLS-TINT.
           EXIT.
       
       VAL-FRM-SGV-TINT SECTION.
       INI-VAL-FRM-SGV-TINT.
      *<<<< FRM_SGV_TINT
      *     IF FRM-SGV-TINT IN CAN-FLD < ZEROES
      *         MOVE 'GNS' TO MSG-COD-SIST
      *         MOVE 'NUM    >CERO' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-FRM-SGV-TINT.
           EXIT.
       
       VAL-COM-SGV-TINT SECTION.
       INI-VAL-COM-SGV-TINT.
      *<<<< INI_COM_SGV_TINT
           MOVE CAN-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'OPC    NEX'        TO MSG-COD-MENS                  
              MOVE OPC-KEY-IOPC IN OPC TO FRM-MEN2                      
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-COM-SGV-TINT.                               
           MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC          
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC          
           MOVE VEN-NUM-IDLC IN VEN     TO DLC-NUM-IDLC IN DLC          
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM COL-FIO-DLC                                          
           IF NOT FIO-STAT-OKS                                          
                 MOVE 'DLC    NEX'        TO MSG-COD-MENS               
                 MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2                   
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-COM-SGV-TINT.                            
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.         
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.         
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.         
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.         
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.         
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.         
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.         
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.         
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.         
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.         
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.         
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.         
           IF OPC-NUM-VCOR IN OPC = 1                                   
               IF CAN-FEC-FCAN IN CAN > VEN-FEC-FIMV IN VEN             
                  MOVE CCO-COD-EVEN-VEN (1:3) TO CCO-COD-EVEN           
               ELSE                                                     
                  IF   ICG-SGV-TINT IN CAN-FLD > 0                      
                   OR  ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
                   OR  CCO-COD-EVEN-ANT (4:1) NOT = 'S'                 
                       MOVE CCO-COD-EVEN-ANT(1:3) TO CCO-COD-EVEN       
                  ELSE                                                  
                       MOVE 'CAN'            TO CCO-COD-EVEN            
                  END-IF                                                
               END-IF                                                   
           ELSE                                                         
               IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN         
                  IF ( OPC-NUM-IVEN IN OPC = OPC-NUM-VCOR IN OPC AND    
                     (ICG-SGV-TINT IN CAN-FLD > 0 OR                    
                     ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD))
                  OR ( CAN-MSC-CANC IN CAN-FLD (2:2) = 'TT' AND         
                       ICG-SGV-TINT IN CAN-FLD > 0 AND                  
                       OPC-NUM-IVEN IN OPC NOT = OPC-NUM-VCOR IN OPC )  
                  OR  CCO-COD-EVEN-ANT (4:1) NOT = 'S'                  
      *LOP-INI CREDITO SIN MORA                                         
                  OR  CAN-MSC-CANC IN CAN-FLD (2:2) = 'XE'              
      *LOP-FIN CREDITO SIN MORA                                         
                       MOVE CCO-COD-EVEN-ANT (1:3) TO CCO-COD-EVEN      
                  ELSE                                                  
                        MOVE 'CAN'            TO CCO-COD-EVEN           
                  END-IF                                                
               ELSE                                                     
                  MOVE CCO-COD-EVEN-VEN (1:3) TO CCO-COD-EVEN           
               END-IF                                                   
           END-IF.                                                      
      * BUSCA DATO 'COMO OPERA=WSS-OPEC'                                
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.             
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM COL-FIO-TOC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'CANTOOCNEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC        TO FRM-MEN1                     
               MOVE TOC-COD-TOCR IN TOC TO FRM-MEN2                     
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-COM-SGV-TINT.                              
           MOVE TOC-MSC-OPEC IN TOC TO WSS-OPEC.                        
      *    IF CCO-COD-EVEN NOT = 'CAN'                                  
      *       MOVE SPACES TO WSS-IBLK-COMI                              
      *       MOVE 0 TO COM-SGV-TINT IN CAN-FLD.                        
           PERFORM LEE-PLAN-COMI-CAN.                                   
           IF PCP-CMSG > SPACES                                         
              GO TO FIN-VAL-COM-SGV-TINT.                               
           IF PCP NOT > SPACES AND                                      
             ( COM-SGV-TINT IN CAN-FLD NOT = ZEROES OR                  
             ( WSS-IBLK-COMI = 'N' AND COM-SGV-TINT IN CAN-FLD = 0 ))   
                 MOVE 'COL'         TO MSG-COD-SIST                     
                 MOVE 'PCPFLV>0PNO' TO MSG-COD-MENS                     
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-COM-SGV-TINT                             
           END-IF.                                                      
           IF PCP NOT > SPACES                                          
                 GO TO FIN-VAL-COM-SGV-TINT                             
           END-IF.                                                      
           PERFORM OBT-FLA-FLV-INF.                                     
           IF  COM-SGV-TINT IN CAN-FLD NOT = ZEROES OR                  
             ( WSS-IBLK-COMI = 'N' AND COM-SGV-TINT IN CAN-FLD = 0 )    
              IF NOT ( PCP-IFLV = 'S' )                                 
                 MOVE 'COL'         TO MSG-COD-SIST                     
                 MOVE 'CANPCPFLVNO' TO MSG-COD-MENS                     
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-COM-SGV-TINT                             
              ELSE                                                      
              IF  COM-SGV-TINT IN CAN-FLD > PCP-RFLV                    
                   MOVE 'COL'         TO MSG-COD-SIST                   
                   MOVE 'CANPCPCOMI>' TO MSG-COD-MENS                   
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-VAL-COM-SGV-TINT                           
              ELSE                                                      
              IF  COM-SGV-TINT IN CAN-FLD < PCP-MFLV                    
                   MOVE 'COL'         TO MSG-COD-SIST                   
                   MOVE 'CANPCPCOMI<' TO MSG-COD-MENS                   
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-VAL-COM-SGV-TINT.                          
              IF  COM-SGV-TINT IN CAN-FLD = ZEROES AND                  
                  PCP-IFLV ='S' AND                                     
                  WSS-IBLK-COMI NOT = 'N'                               
                     MOVE 'N' TO WSS-IBLK-COMI                          
                     MOVE PCP-RFLV TO COM-SGV-TINT IN CAN-FLD.          
      *>>>>
       FIN-VAL-COM-SGV-TINT.
           EXIT.
       
       VAL-FRM-GLS-IITR SECTION.
       INI-VAL-FRM-GLS-IITR.
       FIN-VAL-FRM-GLS-IITR.
           EXIT.
       
       VAL-CAN-SGV-GAST SECTION.
       INI-VAL-CAN-SGV-GAST.
      *<<<< CAN_SGV_GAST
           IF CAN-SGV-GAST IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF WSS-CIC-TVAL = '0'
               MOVE CAN-SGV-GAST IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-GAST 
                                                      IN CAN-FLD.
      *>>>>
       FIN-VAL-CAN-SGV-GAST.
           EXIT.
       
       VAL-OPC-NUM-VCVG SECTION.
       INI-VAL-OPC-NUM-VCVG.
       FIN-VAL-OPC-NUM-VCVG.
           EXIT.
       
       VAL-CAN-NUM-PLCO SECTION.
       INI-VAL-CAN-NUM-PLCO.
       FIN-VAL-CAN-NUM-PLCO.
           EXIT.
       
       VAL-CAN-SGV-COMI SECTION.
       INI-VAL-CAN-SGV-COMI.
      *<<<< INI_CAN_SGV_COMI
      *LOP-INI 29-06-2006 PREGRADO
           IF CAN-MSC-CANC IN CAN-FLD = 'CXE'
              MOVE 'COL'        TO TAB-COD-SIST FIO-SIST
              MOVE 'OAE '       TO TAB-COD-TTAB IN TAB
      *AFRI-INI/LOF/CHC/07-2009
      *       MOVE OPC-COD-COOC TO TAB-COD-CTAB IN TAB
              MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB
      *AFRI-FIN/LOF/CHC/07-2009
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
                 GO TO FIN-VAL-CAN-SGV-COMI.
      *LOP-FIN 29-06-2006 PREGRADO

      *AFRI-INI/LOF/CHC/07-2009
           IF CAN-SGV-COMI IN CAN-FLD > 0 AND PCP NOT > SPACES
                GO TO FIN-VAL-CAN-SGV-COMI.
      *AFRI-FIN/LOF/CHC/07-2009

           IF CAN-SGV-COMI IN CAN-FLD > 0 AND                           
            PCP NOT > SPACES                                            
                MOVE 'COL'         TO MSG-COD-SIST                      
                MOVE 'PCPINF>0NPL' TO MSG-COD-MENS                      
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
                GO TO FIN-VAL-CAN-SGV-COMI                              
           ELSE                                                         
              IF NOT ( PCP-IINF = 'S' )                                 
               AND  CAN-SGV-COMI IN CAN-FLD > 0                         
                    MOVE 'COL'          TO MSG-COD-SIST                 
                    MOVE 'PCPINF>0NINF' TO MSG-COD-MENS                 
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC TO FRM-MENS                       
                    MOVE FRM-SUAR-MAL TO FRM-SUAR                       
                    GO TO FIN-VAL-CAN-SGV-COMI                          
              END-IF                                                    
           END-IF.                
      *>>>>
       FIN-VAL-CAN-SGV-COMI.
           EXIT.
       
       VAL-CAN-COD-OFCA SECTION.
       INI-VAL-CAN-COD-OFCA.
           IF CAN-COD-OFCA IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CAN-COD-OFCA IN CAN-FLD.
      *<<<< CAN_COD_OFCA
           IF OPC-COD-OFOC IN CAN-FLD = CAN-COD-OFCA IN CAN-FLD AND
              SCR-CMND = 'COF'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CODOFOCOFCA=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAN-COD-OFCA.
      *RBG INI 26/OCT/1995
           IF CAN-COD-OFCA IN CAN-FLD = SPACES
               MOVE 'COL'             TO MSG-COD-SIST
               MOVE 'DATNOINGOFCA'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAN-COD-OFCA.
      *LOP-INI 13-08-2003                                               
      *    IF CAN-MSC-CANC IN CAN-FLD = 'PTT' OR 'PTE' OR 'KTT'         
           IF CAN-MSC-CANC IN CAN-FLD = 'PTT' OR 'PTE' OR 'KTT' OR      
                                        'RTT'                           
      *LOP-FIN 13-08-2003                                               
      *LOP-INI 17-04-2003                                               
               PERFORM VAL-OFCA-PTT                                     
      *LOP-FIN 17-04-2003                                               
               IF OPC-COD-OFOC IN CAN-FLD NOT = CAN-COD-OFCA IN CAN-FLD
                  MOVE 'COL'          TO MSG-COD-SIST
                  MOVE 'PROOFOC=OFCA' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-CAN-COD-OFCA. 
      *RBG FIN 26/OCT/1995
      *>>>>
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE CAN-COD-OFCA IN CAN-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFCA IN CAN-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFCA IN CAN-FLD.
       FIN-VAL-CAN-COD-OFCA.
           EXIT.
       
       VAL-FRM-GLS-OFCA SECTION.
       INI-VAL-FRM-GLS-OFCA.
       FIN-VAL-FRM-GLS-OFCA.
           EXIT.
       
       VAL-CAN-SGV-TREN SECTION.
       INI-VAL-CAN-SGV-TREN.
      *<<<< CAN_SGV_TREN
           IF CAN-SGV-TREN IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF CAN-SGV-TREN IN CAN-FLD > ZEROES
               MOVE CAN-SGV-TREN IN CAN-FLD TO WSS-SGV-TREN.
      *>>>>
       FIN-VAL-CAN-SGV-TREN.
           EXIT.
       
       VAL-OPC-COD-AOOC SECTION.
       INI-VAL-OPC-COD-AOOC.
       FIN-VAL-OPC-COD-AOOC.
           EXIT.
       
       VAL-FRM-GLS-AOOC SECTION.
       INI-VAL-FRM-GLS-AOOC.
       FIN-VAL-FRM-GLS-AOOC.
           EXIT.
       
       VAL-CAN-SGV-TPAG SECTION.
       INI-VAL-CAN-SGV-TPAG.
      *<<<< CAN_SGV_TPAG
           IF CAN-SGV-TPAG IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAN-SGV-TPAG.
           IF WSS-CIC-TVAL = '0'
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG
                                                      IN CAN-FLD.
      *>>>>
       FIN-VAL-CAN-SGV-TPAG.
           EXIT.
       
       VAL-VEN-IND-SCTB SECTION.
       INI-VAL-VEN-IND-SCTB.
       FIN-VAL-VEN-IND-SCTB.
           EXIT.
       
       VAL-FRM-GLS-SCTB SECTION.
       INI-VAL-FRM-GLS-SCTB.
       FIN-VAL-FRM-GLS-SCTB.
           EXIT.
       
       VAL-VEN-NUM-IVEN SECTION.
       INI-VAL-VEN-NUM-IVEN.
       FIN-VAL-VEN-NUM-IVEN.
           EXIT.
       
       VAL-CYA-IND-TCYA SECTION.
       INI-VAL-CYA-IND-TCYA.
           IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CYA-IND-TCYA IN CAN-FLD.
      *<<<< CYA_IND_TCYA
      *    NO OBLIGATORIO
           IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES
               MOVE SPACES TO CYA-IND-TCYA IN CAN-FLD
               MOVE SPACES TO FRM-GLS-TCYA IN CAN-FLD
               GO TO FIN-VAL-CYA-IND-TCYA.
           IF CYA-IND-TCYA IN CAN-FLD = 'M'
               MOVE 'COL'          TO TAB-COD-SIST
               MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MCYAC' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                   MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
                   MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD
                   MOVE 'MULTIPLES' TO FRM-GLS-TCYA IN CAN-FLD
                   GO TO FIN-VAL-CYA-IND-TCYA
               ELSE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'BCI    MCYAC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CYA-IND-TCYA.
      *DAD ini  18-JUN-1993   (Memo.18-06-93)
      *DAD ini  16-JUN-1993   (Memo.08-06-93 Pto.1)
      *HZF-INI 04-09-2001                                               
           IF CYA-IND-TCYA IN CAN-FLD = 'XXXXX'                         
               GO TO FIN-VAL-CYA-IND-TCYA.                              
      *HZF-FIN 04-09-2001                                               
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'TCYA'                  TO MSC-COD-TMSC IN MSC.
           MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = SPACES
               GO TO FIN-VAL-CYA-IND-TCYA.
      *AFRI-INI/0CTUBRE2004                                             
            IF EIBTRNID = 'SAF4' OR                                     
               EIBTRNID = 'KU98'                                        
               GO TO STP-VAL-CYA-IND-TCYA.                              
      *AFRI-FIN/0CTUBRE2004                                             
      *ALD-BCI-INI/27.08.1996
            IF SCR-USER = 'COLPGCA1'
               GO TO STP-VAL-CYA-IND-TCYA.
      *ALD-BCI-FIN/27.08.1996
      *     IF CAN-FEC-FCAN IN CAN-FLD = CAN-FEC-FOUT IN CAN-FLD AND
           IF WSS-FEC-FAUX IN WSS-VARI = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(8) = 'N'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'TCYANONORCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYA-IND-TCYA.

      *     IF CAN-FEC-FCAN IN CAN-FLD NOT = CAN-FEC-FOUT IN CAN-FLD AND
           IF WSS-FEC-FAUX IN WSS-VARI NOT = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(9) = 'N'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'TCYANORETCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYA-IND-TCYA.
      *DAD fin 18-JUN-1993 / 16-JUN-1993
      *ALD-BCI-INI/27.08.1996
       STP-VAL-CYA-IND-TCYA.
      *ALD-BCI-FIN/27.08.1996
      *>>>>
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'TCYA' TO MSC-COD-TMSC IN MSC.
           MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CYA-IND-TCYA IN CAN-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TCYA IN CAN-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-TCYA IN CAN-FLD.
       FIN-VAL-CYA-IND-TCYA.
           EXIT.
       
       VAL-FRM-GLS-TCYA SECTION.
       INI-VAL-FRM-GLS-TCYA.
      *<<<< FRM_GLS_TCYA
           MOVE MSC-COD-DAT1 IN MSC(3) TO WSS-GLS-DAT1.
      *ISP WSS-GLS-DAT1 SERA USADO EN VALIDACION DE CONSISTENCIA
      *>>>>
       FIN-VAL-FRM-GLS-TCYA.
           EXIT.
       
       VAL-OPC-COD-VCOC SECTION.
       INI-VAL-OPC-COD-VCOC.
       FIN-VAL-OPC-COD-VCOC.
           EXIT.
       
       VAL-FRM-GLS-VCOC SECTION.
       INI-VAL-FRM-GLS-VCOC.
       FIN-VAL-FRM-GLS-VCOC.
           EXIT.
       
       VAL-CYA-CAI-ICYA SECTION.
       INI-VAL-CYA-CAI-ICYA.
           IF CYA-CAI-ICYA IN CAN-FLD NOT > SPACES
              MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD.
      *<<<< CYA_CAI_ICYA
           IF CYA-CAI-ICYA IN CAN-FLD NOT > SPACES
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD.
           IF CYA-IND-TCYA IN CAN-FLD = 'M'
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD
               GO TO FIN-VAL-CYA-CAI-ICYA.
      *>>>>
       FIN-VAL-CYA-CAI-ICYA.
           EXIT.
       
       VAL-CYA-IIC-ICYA SECTION.
       INI-VAL-CYA-IIC-ICYA.
       FIN-VAL-CYA-IIC-ICYA.
           EXIT.
       
       VAL-OPC-VAL-SCRE SECTION.
       INI-VAL-OPC-VAL-SCRE.
       FIN-VAL-OPC-VAL-SCRE.
           EXIT.
       
       VAL-CAN-SGV-DIFE SECTION.
       INI-VAL-CAN-SGV-DIFE.
       FIN-VAL-CAN-SGV-DIFE.
           EXIT.
       
       VAL-VEN-VAL-SCAP SECTION.
       INI-VAL-VEN-VAL-SCAP.
       FIN-VAL-VEN-VAL-SCAP.
           EXIT.
       
       VAL-RCV-SGV-CAPI SECTION.
       INI-VAL-RCV-SGV-CAPI.
      *<<<< RCV_SGV_CAPI
           IF RCV-SGV-CAPI IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-RCV-SGV-CAPI.
           EXIT.
       
       VAL-VEN-VAL-SFIN SECTION.
       INI-VAL-VEN-VAL-SFIN.
       FIN-VAL-VEN-VAL-SFIN.
           EXIT.
       
       VAL-RCV-SGV-FINA SECTION.
       INI-VAL-RCV-SGV-FINA.
      *<<<< RCV_SGV_FINA
           IF RCV-SGV-FINA IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-RCV-SGV-FINA.
           EXIT.
       
       VAL-CON-KEY-CAN SECTION.
       INI-VAL-CON-KEY-CAN.
      *<<<< INI_VAL_CON_KEY_CAN
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-CAN.
      *>>>>
           IF     CAN-CAI-IOPC IN CAN-FLD NOT > SPACES                  
              AND CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES                  
              AND CAN-NUM-ICAN IN CAN-FLD NOT > ZEROES                  
              AND VEN-NUM-IVCT IN CAN-FLD NOT > ZEROES                  
              AND VEN-NUM-IVEN IN CAN-FLD NOT > ZEROES                  
                PERFORM ERR-KEY                                         
                PERFORM FST-KEY-CAN.                                    
      *<<<< FIN_VAL_CON_KEY_CAN                                         
           IF CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES                      
               MOVE 'GNS'       TO MSG-COD-SIST                         
               MOVE 'VALCONKEY' TO MSG-COD-MENS                         
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
           GO TO FIN-VAL-CON-KEY-CAN.
      *>>>>                                                             
           IF     CAN-CAI-IOPC IN CAN-FLD NOT > SPACES 
              AND CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES 
              AND CAN-NUM-ICAN IN CAN-FLD NOT > ZEROES 
              AND VEN-NUM-IVCT IN CAN-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CAN.
       FIN-VAL-CON-KEY-CAN.
           EXIT.
       
       VAL-CON-IKY-CAN SECTION.
       INI-VAL-CON-IKY-CAN.
           IF     CAN-CAI-IOPC IN CAN-FLD NOT > SPACES                  
              AND CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES                  
              AND VEN-NUM-IVCT IN CAN-FLD NOT > ZEROES                  
              AND VEN-NUM-IVEN IN CAN-FLD NOT > ZEROES                  
                PERFORM ERR-KEY                                         
                PERFORM FST-KEY-CAN.                                    
      *<<<< FIN_VAL_CON_IKY_CAN
           IF CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-IKY-CAN.
      *>>>>
           IF     CAN-CAI-IOPC IN CAN-FLD NOT > SPACES 
              AND CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES 
              AND VEN-NUM-IVCT IN CAN-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CAN.
       FIN-VAL-CON-IKY-CAN.
           EXIT.
       
       VAL-CON-FLD-CAN SECTION.
       INI-VAL-CON-FLD-CAN.
      *<<<< VAL_CON_FLD_CAN
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
           MOVE ZEROES TO SCR-SGV-CONO.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *AFRI-INI/DEVOLUCION SEGUROS/12-2013
           MOVE DPS-GLS-INSI TO DPS-IND-IVEZ.
           MOVE ZEROES TO SCR-SGV-MDPT.
           MOVE ZEROES TO DPS-VAL-MDPT.
      *AFRI-FIN/DEVOLUCION SEGUROS/12-2013
      *AFRI-INI/DEVOLUCION SEGUROS/12-2013
       CON-DPS-ITT.
      *AFRI-FIN/DEVOLUCION SEGUROS/12-2013

      *AFRI-INI/07-2006
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN CAN-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE 'COL'        TO MSG-COD-SIST
              MOVE 'NOTABTIO'   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-CAN.
           MOVE TAB TO TIO.
           IF NOT TIO-GLS-SIST IN TIO = 'COL'
              MOVE 'COL'        TO MSG-COD-SIST
              MOVE 'SIST!=COL'  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-CAN.
      *AFRI-FIN/07-2006

      *AFRI-INI                                                         
           MOVE 'N'   TO SCR-IND-PGTI.                                  
      *AFRI-FIN                                                         
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
           MOVE ZEROES       TO SCR-SGV-CCAE.
           MOVE SPACES       TO WSS-CXE-ICAE.
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           MOVE ZEROES       TO SCR-SGV-CFIN.
           MOVE ZEROES       TO SCR-SGV-CCMC.
           MOVE ZEROES       TO WSS-TOT-COMI.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-INI/LOF/CHC/07-2009
           MOVE ZEROES TO LOC-CXE-FVEN IN LOC-VARI.
           MOVE ZEROES TO SCR-SGV-CFGP.
           MOVE ZEROES TO SCR-SGV-CMFG.
           MOVE SPACES TO LOC-GLS-NOCO IN LOC-VARI.
           MOVE SPACES TO LOC-GLS-MENS IN LOC-VARI.
      *AFRI-INI 15-SEP-2010 GARANTIAS ESTATALES
           MOVE SPACES TO LOC-GLS-GARE IN LOC-VARI.
      *AFRI-FIN 15-SEP-2010 GARANTIAS ESTATALES
      *AFRI-FIN/LOF/CHC/07-2009
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
           MOVE ZEROES TO SCR-SGV-JUDI.                                 
      *DATO NO ES INGRESABLE Y PUEDE TENER MULTIPLES TIPOS QUE SE
      *VUELVEN A CALCULAR SI SE INGRESARA SE DEBE MODIFICAR CODIGO
           MOVE ZEROES TO CAN-SGV-GAST IN CAN-FLD.                      
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
      *RJZ INI 14-JUNIO-1995                                            
           MOVE ZEROES TO SCR-SGV-INTN.                                 
           MOVE ZEROES TO SCR-SGV-INTM.                                 
           MOVE ZEROES TO SCR-SGV-INT.                                  
      *AFRI/ENERO2005-INI                                               
           MOVE 'N' TO SCR-IND-PGTI.                                    
           MOVE ZEROES TO SCR-FEC-FDEV.                                 
      *AFRI/ENERO2005-FIN                                               
      *DPM ini  14-OCT-1996                                             
      *     MOVE ZEROES TO SCR-AUX-INTN.                                
      *     MOVE ZEROES TO SCR-AUX-INTM.                                
           MOVE ZEROES TO WSS-AUX-INTN                                  
                          WSS-AUX-INTM                                  
                          WSS-AUX-INMO                                  
                          WSS-AUX-IMMO                                  
                          SCR-SGV-INMO                                  
                          SCR-SGV-IMMO.                                 
      *DPM fin  14-OCT-1996                                             
           MOVE ZEROES TO WSS-SGV-RAFV IN WSS-VARI.                     
           MOVE ZEROES TO WSS-AUX-CAPI IN WSS-VARI.                     
      *RJZ FIN 14-JUNIO-1995                                            
                                                                        
           MOVE SPACES TO SCR-RCV-STAT.                                 
           MOVE CAN-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
      *AFRI-INI/LOF/CHC/07-2009
           MOVE OPC-VAL-SCRE IN OPC TO LOC-VAL-SALD IN LOC-VARI.
           MOVE OPC-CAI-IOPC IN OPC TO LOC-CAI-IOPC IN LOC-VARI.
           MOVE OPC-IIC-IOPC IN OPC TO LOC-IIC-IOPC IN LOC-VARI.
      *AFRI-FIN/LOF/CHC/07-2009
      *JSS                                                              
           MOVE SPACES TO MSG-COD-MENS.                                 
           IF CAN-MSC-CANC IN CAN-FLD = 'ATT'                           
      *AFRI-INI                                                         
               IF VEN-NUM-IVCT IN CAN-FLD NOT = 1 OR                    
                  OPC-VAL-CRED IN OPC NOT = OPC-VAL-SCRE IN OPC         
                   MOVE 'CANATTNOVE1' TO MSG-COD-MENS                   
               ELSE                                                     
      *AFRI-FIN                                                         
               IF OPC-IND-RENO IN OPC > SPACES                          
                   MOVE 'CANATT RENO' TO MSG-COD-MENS                   
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
           IF CAN-MSC-CANC IN CAN-FLD = 'QTT'                           
               IF OPC-IND-RENO IN OPC NOT = 'PRO'                       
                   MOVE 'CANQTT PRO<>' TO MSG-COD-MENS                  
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
           IF CAN-MSC-CANC IN CAN-FLD = 'STT'                           
               IF OPC-IND-RENO IN OPC NOT = 'REN'                       
                   MOVE 'CANQTT REN<>' TO MSG-COD-MENS                  
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
           IF CAN-MSC-CANC IN CAN-FLD = 'OTT'                           
               IF OPC-IND-RENO IN OPC NOT = 'NOV'                       
                   MOVE 'CANQTT NOV<>' TO MSG-COD-MENS.                 
                                                                        
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
           PERFORM PRO-LEE-JDLC.
           IF DLC-IND-SCBZ IN DLC = 'JUDIC' AND
            CAN-MSC-CANC IN CAN-FLD = 'CXE'
               MOVE 'CANNOPERPJUD' TO MSG-COD-MENS.
      *AFRI-INI/LOF/ALD/05-2010 ERROR CALCULO VCD
           MOVE ZEROES TO LOC-ORI-FCOL IN LOC-VARI.
      *AFRI-INI/LOF/ALD/05-2010 ERROR CALCULO VCD
      *AFRI-INI/LOF/CHC/07-2009
           MOVE ZEROES TO BDO-SGV-CAPI IN BDO-VARI.
           MOVE OPC-IND-GARA IN OPC TO LOC-IND-GARA IN LOC-VARI.
           MOVE OPC-COD-CDOC IN OPC TO LOC-COD-CDOC IN LOC-VARI.
      *AFRI-INI 15-SEP-2010 GARANTIAS ESTATALES
           PERFORM DET-GAR-OPE.
      *AFRI-FIN 15-SEP-2010 GARANTIAS ESTATALES
           PERFORM LOC-DET-FOG.
           PERFORM LOC-INI-OPC.
           IF DLC-IND-SCTB IN DLC = 'VCD' OR
              DLC-IND-SCTB IN DLC = 'CAS'
               MOVE OPC-CAI-IOPC IN OPC TO LOC-CAI-IOPC IN LOC-VARI
               MOVE OPC-IIC-IOPC IN OPC TO LOC-IIC-IOPC IN LOC-VARI
               PERFORM LOC-OPC-ORI
               IF LOC-GLS-NOCO IN LOC-VARI = 'SICOBRACOM'
                   MOVE OPC-CAI-IOPC IN OPC TO LOC-CAI-IOPC IN LOC-VARI
                   MOVE OPC-IIC-IOPC IN OPC TO LOC-IIC-IOPC IN LOC-VARI
                   PERFORM LOC-BUS-CAPI
                   MOVE BDO-CAI-IOPC IN BDO-VARI TO
                        LOC-CAI-IOPC IN LOC-VARI
                   MOVE BDO-IIC-IOPC IN BDO-VARI TO
                        LOC-IIC-IOPC IN LOC-VARI
                   MOVE BDO-VAL-SCRE IN BDO-VARI TO
                        LOC-VAL-SALD IN LOC-VARI.
      *AFRI-FIN/LOF/CHC/07-2009

      *AFRI-INI/CHC/JUN-2009/HONORARIOS JUDICIALES
      *    IF DLC-IND-SCBZ IN DLC = 'JUDIC' AND
      *     (EIBTRNID = 'SAF4' OR EIBTRNID = 'KU98')
      *        MOVE 'TAB' TO MSC-COD-SIST                               
      *        MOVE 'TCYA' TO MSC-COD-TMSC IN MSC                       
      *        MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC      
      *        PERFORM BUS-MSC                                          
      *        IF MSC-CIC-CMSC IN MSC = 'CAJA'
      *            MOVE 'NOPAGCAJHJUD' TO MSG-COD-MENS.
      *AFRI-FIN/CHC/JUN-2009/HONORARIOS JUDICIALES
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
      * RBG/INI/17-JUL-1996                                             
      *AFRI-INI                                                         
           IF SCR-USER = 'COLPGCA1'                                     
               GO TO NEXT-NO-VAL-CIE.                                   
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST                 
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB                   
           MOVE 'PERMITEPARCI' TO TAB-COD-CTAB IN TAB                   
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM GNS-FIO-TAB                                          
           IF FIO-STAT-OKS AND                                          
              TAB-IND-VIGE IN TAB = 'S'                                 
               GO TO NEXT-NO-VAL-CIE.                                   
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.                
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'PERMITECIE>1' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB                                          
           IF NOT ( FIO-STAT-OKS AND                                    
              TAB-IND-VIGE IN TAB = 'S' )                               
               IF CAN-MSC-CANC IN CAN-FLD = 'CIE'                       
                  AND OPC-NUM-VCOR IN OPC > 1                           
                   MOVE 'NOPERMITECIE' TO MSG-COD-MENS.                 
      *LFZ-INI 18-05-2009
      *VALIDACION PARA CIE ANTICIPADO - CREDITO EN CUOTAS
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-ITM1-RED IN FEC-VARI
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-ITM2-RED IN FEC-VARI
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-ITM3-RED IN FEC-VARI
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-ITM4-RED IN FEC-VARI

           MOVE VEN-NUM-SVEN IN CAN-FLD TO FEC-SVLD     IN FEC-VARI
           MOVE VEN-NUM-AVEN IN CAN-FLD TO FEC-AVLD     IN FEC-VARI
           MOVE VEN-NUM-MVEN IN CAN-FLD TO FEC-MVLD     IN FEC-VARI
           MOVE VEN-NUM-DVEN IN CAN-FLD TO FEC-DVLD     IN FEC-VARI

           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'CIEANTCRECUO' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF NOT ( FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S' )
               IF CAN-MSC-CANC IN CAN-FLD = 'CIE'  AND
                  OPC-NUM-VCOR IN OPC > 1          AND
                  FEC-FECH-RED IN FEC-VARI NOT > FEC-FVLD IN FEC-VARI
                   MOVE 'NOCIEANTCUOT' TO MSG-COD-MENS.
      *LFZ-FIN 18-05-2009
       NEXT-NO-VAL-CIE.                                                 
      *AFRI-FIN                                                         
      * RBG/FIN/17-JUL-1996                                             
                                                                        
           IF MSG-COD-MENS > SPACES                                     
               MOVE 'COL' TO MSG-COD-SIST                               
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-FLD-CAN.                               
      *                                                                 
      *DAD ini  12-NOV-1992                                             
      *     IF SCR-CMND NOT = 'ING'                                     
      *         MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN     
      *         PERFORM GET-CUR-ICG                                     
      *         IF PGM-STAT-ICG-OKS                                     
      *             IF ICG-COD-TINT IN ICG = 'TIPE'                     
      *                 MOVE '1' TO FRM-IND-TIPE IN CAN-FLD.            
      *DAD fin  12-NOV-1992                                             
                                                                        
           IF SCR-CMND = 'COF'                                          
               GO TO FIN-VAL-CON-FLD-CAN.                               
                                                                        
      * BUSCA DATO 'COMO OPERA=WSS-OPEC'                                
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.             
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM COL-FIO-TOC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'CANTOOCNEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC        TO FRM-MEN1                     
               MOVE TOC-COD-TOCR IN TOC TO FRM-MEN2                     
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-FLD-CAN.                               
           MOVE TOC-MSC-OPEC IN TOC TO WSS-OPEC.                        
                                                                        
      * NO ACEPTA ABONOS PARCIALES PARA BOLETAS DE GARANTIA             
           IF ( SCR-MSC-FCAN = 'I' OR 'P' OR 'C' ) AND WSS-OPEC = 'B'   
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'MSCFCANIPCBG' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-FLD-CAN.                               
                                                                        
      *ISP NO ACEPTA DIGITACION DE OPERACION PARA PRORROGA O            
      *    NOVACION PARA INGRESO                                        
           IF SCR-MSC-TCAN = 'C' AND                                    
              ( ROV-CAI-IOPC IN CAN-FLD > SPACES OR                     
                ROV-IIC-IOPC IN CAN-FLD > ZEROES )                      
                   MOVE 'COL'        TO MSG-COD-SIST                    
                   MOVE 'ROVCANCINV' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN.                           
                                                                        
           IF SCR-MSC-TCAN = 'N' AND                                    
              SCR-CMND = 'ING' AND                                      
              ( ROV-CAI-IOPC IN CAN-FLD > SPACES OR                     
                ROV-IIC-IOPC IN CAN-FLD > ZEROES )                      
                   MOVE 'COL'         TO MSG-COD-SIST                   
                   MOVE 'ROVIOPCNOV0' TO MSG-COD-MENS                   
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN.                           
                                                                        
           IF (SCR-MSC-TCAN = 'P' OR 'K') AND                           
              SCR-CMND = 'ING' AND                                      
              ( ROV-CAI-IOPC IN CAN-FLD > SPACES OR                     
                ROV-IIC-IOPC IN CAN-FLD > ZEROES )                      
                   MOVE 'COL'         TO MSG-COD-SIST                   
                   MOVE 'ROVIOPCPRG0' TO MSG-COD-MENS                   
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN.                           
                                                                        
           IF ( SCR-MSC-TCAN = 'R' OR 'P' OR 'K') AND                   
                ROV-IIC-IOPC IN CAN-FLD > ZEROES                        
                 MOVE ROV-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC    
                 MOVE ROV-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC    
                 MOVE FIO-GET-KEY TO FIO-CMND                           
                 PERFORM COL-FIO-OPC                                    
      *ISP LA OPERACION NO PUEDE ESTAR ACTIVADA                         
                 IF FIO-STAT-OKS AND                                    
                    OPC-MSC-STAT IN OPC = 'A'                           
                      MOVE 'COL'          TO MSG-COD-SIST               
                      MOVE 'OPCSTAT INVA' TO MSG-COD-MENS               
                      PERFORM GET-MSG                                   
                      MOVE MSG-GLS-DESC TO FRM-MENS                     
                      MOVE FRM-SUAR-MAL TO FRM-SUAR                     
                      GO TO END-VAL-CON-FLD-CAN                         
                 ELSE                                                   
      *DAD ini  05-NOV-1992   (Memo.09-10-92)                           
                     MOVE CAN-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC
                     MOVE CAN-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC
                     MOVE FIO-GET-KEY TO FIO-CMND                       
                     PERFORM COL-FIO-OPC                                
                     IF NOT FIO-STAT-OKS                                
                         MOVE 'COL'        TO MSG-COD-SIST              
                         MOVE 'OPC    NEX' TO MSG-COD-MENS              
                         PERFORM GET-MSG                                
                         MOVE MSG-GLS-DESC TO FRM-MENS                  
                         MOVE FRM-SUAR-MAL TO FRM-SUAR                  
                         GO TO END-VAL-CON-FLD-CAN                      
                     ELSE                                               
      *DAD fin  05-NOV-1992                                             
      *ISP DEBE EXISTIR AL MENOS UN ROV                                 
                      MOVE ROV-CAI-IOPC IN CAN-FLD TO                   
                           ROV-CAI-IOPC IN ROV                          
                      MOVE ROV-IIC-IOPC IN CAN-FLD TO                   
                           ROV-IIC-IOPC IN ROV                          
                      MOVE LOW-VALUES TO ROV-KEY-IVCT IN ROV            
                      MOVE FIO-GET-NLS TO FIO-CMND                      
                      PERFORM COL-FIO-ROV                               
                      IF NOT ( FIO-STAT-OKS               AND           
                               ROV-CAI-IOPC IN CAN-FLD =                
                               ROV-CAI-IOPC IN ROV        AND           
                               ROV-IIC-IOPC IN CAN-FLD =                
                               ROV-IIC-IOPC IN ROV )                    
                                MOVE 'COL'          TO MSG-COD-SIST     
                                MOVE 'REN    NOROV' TO MSG-COD-MENS     
                                PERFORM GET-MSG                         
                                MOVE MSG-GLS-DESC TO FRM-MENS           
                                MOVE FRM-SUAR-MAL TO FRM-SUAR           
                                GO TO END-VAL-CON-FLD-CAN.              
                                                                        
      *INI-JGM 01-06-2000.                                              
      *-----------------------------------------------------*           
      * Voy a buscar a la tabla Cobro Comision Banca los tipos de Banca.
      *     MOVE 'COL'       TO FIO-SIST.                               
      *    MOVE 'CCB'       TO TAB-COD-TTAB IN TAB.                     
      *    MOVE SPACES      TO TAB-COD-CTAB IN TAB.                     
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM GNS-FIO-TAB.                                         
      *    IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )        
      *        MOVE 'COL'        TO MSG-COD-SIST                        
      *        MOVE 'CCB    NEX' TO MSG-COD-MENS                        
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC TO FRM-MENS                            
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
      *        GO TO END-VAL-CON-FLD-CAN.                               
      *    MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DAT5 IN WSS-VARI.        
      *--------------------------------------------------------*        
      *------------------------------------------------------------*    
      * Voy a buscar el Monto Neto, Moneda, No. de Dias Inicio y Tope.  
      *    MOVE 'COL'       TO FIO-SIST.                                
      *    MOVE 'CMO'       TO TAB-COD-TTAB IN TAB.                     
      *    MOVE SPACES      TO TAB-COD-CTAB IN TAB.                     
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM GNS-FIO-TAB.                                         
      *    IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )        
      *        MOVE 'COL'        TO MSG-COD-SIST                        
      *        MOVE 'CMO    NEX' TO MSG-COD-MENS                        
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC TO FRM-MENS                            
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
      *        GO TO END-VAL-CON-FLD-CAN.                               
                                                                        
      *    MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.        
      *    IF WSS-NUM-DIAS IN WSS-VARI IS NOT NUMERIC                   
      *        MOVE 'COL'          TO MSG-COD-SIST                      
      *        MOVE 'INIDNONUMCMO' TO MSG-COD-MENS                      
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC TO FRM-MENS                            
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
      *        GO TO END-VAL-CON-FLD-CAN.                               
                                                                        
      *    IF WSS-NUM-TOPE IN WSS-VARI IS NOT NUMERIC                   
      *        MOVE 'COL'          TO MSG-COD-SIST                      
      *        MOVE 'TOPDNONUMCMO' TO MSG-COD-MENS                      
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC TO FRM-MENS                            
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
      *        GO TO END-VAL-CON-FLD-CAN.                               
                                                                        
      *    MOVE 'TAB'                    TO TAB-COD-SIST FIO-SIST.      
      *    MOVE 'VLR'                    TO TAB-CIC-TTAB IN TAB.        
      *    MOVE WSS-COD-MONE IN WSS-VARI TO TAB-CIC-CTAB IN TAB.        
      *    MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
      *    MOVE FIO-GET-KEY    TO FIO-CMND.                             
      *    PERFORM GNS-FIO-TAB.                                         
      *    IF NOT FIO-STAT-OKS                                          
      *        MOVE 'TAB'          TO MSG-COD-SIST                      
      *        MOVE 'VLRCICMO NEX' TO MSG-COD-MENS                      
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC             TO FRM-MEN1                
      *        MOVE WSS-COD-MONE IN WSS-VARI TO FRM-MEN2                
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
      *        GO TO END-VAL-CON-FLD-CAN.                               
      *----------------------------------------------------------*      
      * RBG/FIN/15-NOV-1996 Esto es para el cobro de Comision.          
      *----------------------------------------------------*            
      * RESTA LOS GASTOS                                                
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
           IF SCR-MSC-TCAN = 'C' AND                                    
              SCR-MSC-FCAN = 'I' AND                                    
              SCR-MSC-ECAN = 'E' AND                                    
              WSS-IBLK-TPAG = 'N'                                       
               IF DLC-IND-SCBZ IN DLC = 'JUDIC'
      *AFRI-INI/CHC/JUN-2009/HONORARIOS JUDICIALES
      *            IF EIBTRNID = 'KO70' OR
      *               EIBTRNID = 'KQ97'
                   IF NOT (SCR-USER = 'COLPGCA1' OR
                           SCR-USER = 'COLPGCPG')
      *AFRI-FIN/CHC/JUN-2009/HONORARIOS JUDICIALES
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *                PERFORM PRO-HON-JUDI-CIE
                       PERFORM PRO-JUDIC-HONO-CIE
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
                       IF WSS-JUD-ERRO IN JUD-VARI = 'S'
                           MOVE 'COL' TO MSG-COD-SIST
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           PERFORM BCK-OUT
                           GO TO FIN-VAL-CON-FLD-CAN
                       ELSE
                           MOVE WSS-SGV-HCJU IN JUD-VARI TO
                                CAN-SGV-GAST IN CAN-FLD
                           MOVE WSS-SGV-HCJU IN JUD-VARI TO
                                SCR-SGV-JUDI.
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
           IF SCR-MSC-TCAN = 'C'                                        
                SUBTRACT CAN-SGV-GAST IN CAN-FLD FROM                   
                         CAN-SGV-TPAG IN CAN-FLD                        
                IF CAN-SGV-TPAG IN CAN-FLD < ZEROES                     
                     MOVE ZEROES TO CAN-SGV-TPAG IN CAN-FLD.            
                                                                        
           IF SCR-MSC-TCAN NOT = 'C'                                    
                SUBTRACT CAN-SGV-GAST IN CAN-FLD FROM                   
                         CAN-SGV-TREN IN CAN-FLD                        
                IF CAN-SGV-TREN IN CAN-FLD < ZEROES                     
                     MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD.            
                                                                        
           IF SCR-MSC-TCAN = 'C'                                        
               MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD.                  
                                                                        
           MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.                      
                                                                        
           PERFORM GET-SLD.                                             
           IF FRM-SUAR = FRM-SUAR-MAL                                   
               GO TO END-VAL-CON-FLD-CAN.                               
           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-NUM-DCAN IN WSS-VARI.    
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-NUM-MCAN IN WSS-VARI.    
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-NUM-SCAN IN WSS-VARI.    
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-NUM-ACAN IN WSS-VARI.    
                                                                        
           MOVE VEN-NUM-DVEN IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.    
           MOVE VEN-NUM-MVEN IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.    
           MOVE VEN-NUM-SVEN IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.    
           MOVE VEN-NUM-AVEN IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.    
      *ALD/27-SEP-1990                                                  
      *   Inconsistencia forma de cargar fecha de vencimiento pues      
      *   Existe campo WSS_CMP_FVEN.....se debe corregir....            
           IF WSS-CMP-FCAN IN WSS-VARI < WSS-CMP-FIMV IN WSS-VARI       
               MOVE 'A' TO RCV-MSC-MCAN IN CAN-FLD                      
           ELSE                                                         
           IF WSS-CMP-FCAN IN WSS-VARI > WSS-CMP-FIMV IN WSS-VARI       
               MOVE 'V' TO RCV-MSC-MCAN IN CAN-FLD                      
           ELSE                                                         
               MOVE 'F' TO RCV-MSC-MCAN IN CAN-FLD.                     
      *ALD/24-MAY-1990                                                  
      *                                                                 
           PERFORM LEE-REG-TCAN.                                        
      *AFRI-INI/LOF/ALD/03-2011 CONSIDERAR CIE
           COMPUTE LOC-VAL-SALD = LOC-VAL-SALD + VEN-VAL-CAPI IN VEN -
                                                 VEN-VAL-SCAP IN VEN.
      *AFRI-FIN/LOF/ALD/07-2010 CONSIDERAR CIE
           MOVE 'COL'               TO TAB-COD-SIST.                    
           MOVE 'INT'               TO TAB-COD-TTAB IN TAB.             
           MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB.             
           MOVE ITR-COD-TINT IN ITR TO SCR-COD-TICG.                    
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAN-FLD.         
           MOVE FRM-SUAR-OKS TO FRM-SUAR.                               
           IF WSS-CMP-FCAN < WSS-CMP-FIMV                               
              IF WSS-IBLK-TINT = 'S'                                    
                  MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD                
                  MOVE SPACES TO FRM-GLS-TINT IN CAN-FLD                
              ELSE                                                      
                  IF ICG-SGV-TINT IN CAN-FLD > FRM-SGV-TINT IN CAN-FLD  
                      MOVE 'COL'          TO MSG-COD-SIST               
                      MOVE 'CANTASD>TASC' TO MSG-COD-MENS               
                      PERFORM GET-MSG                                   
                      MOVE MSG-GLS-DESC TO FRM-MENS                     
                      MOVE FRM-SUAR-MAL TO FRM-SUAR                     
                      GO TO END-VAL-CON-FLD-CAN.                        
      *ISP 25-JAN-1990                                                  
           MOVE VEN-NUM-DVEN IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.    
           MOVE VEN-NUM-MVEN IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.    
           MOVE VEN-NUM-SVEN IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.    
           MOVE VEN-NUM-AVEN IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.    
           IF WSS-CMP-FCAN = WSS-CMP-FIMV AND                           
              ( SCR-MSC-ECAN  NOT = 'T'  OR                             
                OPC-NUM-VCOR IN OPC = 1 )                               
                MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD.                 
           MOVE VEN-NUM-DIMV IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.    
           MOVE VEN-NUM-MIMV IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.    
           MOVE VEN-NUM-SIMV IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.    
           MOVE VEN-NUM-AIMV IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.    
                                                                        
           IF ITR-COD-CVTI IN ITR > SPACES AND                          
      *DAD ini  27-SEP-1993   (Memo. Producto Nuevo 'FP')               
              SCR-MSC-FCAN    NOT = 'T'    AND                          
              VEN-IND-CALC IN VEN = 'N'                                 
      *DAD fin  27-SEP-1993                                             
               MOVE 'CANPARCINTV' TO MSG-COD-MENS                       
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                           
               GO TO PRO-MSG-MAL.                                       
      *                                                                 
      *LOP-INI CREDITO SIN MORA                                         
           IF ITR-COD-CVTI IN ITR > SPACES     AND                      
              CAN-MSC-CANC IN CAN-FLD = 'CXE'                           
               MOVE 'TASVAR   CSM' TO MSG-COD-MENS                      
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                           
               GO TO PRO-MSG-MAL.                                       
      *LOP-FIN CREDITO SIN MORA                                         
                                                                        
      * Elimina Comisiones y Gastos                                     
           PERFORM ELI-COM-IMP.                                         
           IF MSG-COD-MENS > SPACES                                     
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                           
               GO TO PRO-MSG-MAL.                                       
                                                                        
      *LOP-INI 20-01-2004 CREDITO SIN MORA                              
           PERFORM DEL-IMP-TRA.                                         
           IF MSG-COD-MENS > SPACES                                     
               GO TO PRO-MSG-MAL.                                       
      *LOP-FIN 20-01-2004 CREDITO SIN MORA                              
                                                                        
      *    MOVE ZEROES TO CAN-SGV-COMI IN CAN-FLD                       
           MOVE ZEROES TO WSS-SGV-CACU.                                 
           MOVE 0      TO SCR-SGV-IPFC.                                 
           MOVE ZEROES TO PCP-CACU PCP-SUVP PCP-FANT PCP-FVEN.          
           MOVE ZEROES TO WSS-VAL-SMO8 WSS-VAL-SM10.                    
           MOVE SPACES TO PCP-IINC.                                     
      *JSS-INI 09-OCT-1994                                              
      *                                                                 
           MOVE 0 TO SCR-SGV-IPFC.                                      
           MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-SMO7.                
           MOVE CAN-SGV-TREN IN CAN-FLD TO WSS-VAL-SMO9.                
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.        

      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/04-2012
           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-CAE-DCAN IN CAE-VARI.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-CAE-MCAN IN CAE-VARI.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-CAE-SCAN IN CAE-VARI.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-CAE-ACAN IN CAE-VARI.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO WSS-CAE-DVEN IN CAE-VARI.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO WSS-CAE-MVEN IN CAE-VARI.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO WSS-CAE-SVEN IN CAE-VARI.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO WSS-CAE-AVEN IN CAE-VARI.
           IF WSS-CAE-FCAN IN CAE-VARI NOT > WSS-CAE-FVEN IN CAE-VARI
            AND CAN-MSC-CANC IN CAN-FLD = 'CTE'
            AND OPC-COD-TOOC IN OPC = 'CAE'
              PERFORM LEE-CXE-CAE
              IF WSS-CXE-ICAE IN CAE-VARI = 'S'
                 PERFORM DET-VAL-PAG
                 IF WSS-CAE-MENS IN CAE-VARI > SPACES
                    MOVE 'S' TO SCR-IERR
                    MOVE WSS-CAE-MENS IN CAE-VARI TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MEN1
                    PERFORM BCK-OUT
                    GO TO FIN-VAL-CON-FLD-CAN.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/04-2012
      *AFRI-INI/DEVOLUCION SEGUROS/12-2013
           IF SCR-CMND = DPS-SCR-IG30 AND                               
              SCR-MSC-CANC NOT = DPS-GLS-ICTT                           
               MOVE 'S' TO SCR-IERR
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'TCANINVCMND' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               PERFORM BCK-OUT
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-FLD-CAN.
      *AFRI-FIN/DEVOLUCION SEGUROS/12-2013
                                                                        
      *ALD/ Procesa tipo de cancelacion CTE.                            
           IF SCR-MSC-FCAN = 'T' AND                                    
              SCR-MSC-ECAN = 'E'                                        
               PERFORM PRO-TCAN-CTE.                                    
                                                                        
                                                                        
      *LOP-INI 20-01-2004 CREDITO SIN MORA                              
           IF SCR-MSC-FCAN = 'X' AND                                    
              SCR-MSC-ECAN = 'E'                                        
               PERFORM PRO-TCAN-CXE.                                    
      *LOP-FIN 20-01-2004 CREDITO SIN MORA                              
                                                                        
                                                                        
                                                                        
      *                                                                 
      *ALD/Procesa tipo de cancelacion CTT.                             
           IF SCR-MSC-FCAN = 'T' AND                                    
              SCR-MSC-ECAN = 'T'                                        
               PERFORM PRO-TCAN-CTT.                                    
      *                                                                 
      *AFRI-INI/DEVOLUCION SEGUROS/12-2013
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
           PERFORM ELI-DPS-CXES.
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS
           IF SCR-USER = DPS-SCR-USER                                   
               GO TO CON-LNK-SEG.
           IF DPS-IND-IVEZ = DPS-GLS-INNO
               GO TO CON-LNK-SEG.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO DPS-CAI-IOPC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DPS-IIC-IOPC.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO DPS-NUM-ICAN.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO DPS-NUM-DCAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO DPS-NUM-MCAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO DPS-NUM-SCAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO DPS-NUM-ACAN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO DPS-NUM-DVEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO DPS-NUM-MVEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO DPS-NUM-SVEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO DPS-NUM-AVEN.
           MOVE CAN-MSC-CANC IN CAN-FLD TO DPS-MSC-CANC.
           MOVE FRM-SGV-TINT IN CAN-FLD TO DPS-SGV-TINT.
           MOVE CAN-NUM-DOUT IN CAN-FLD TO DPS-NUM-DOUT.
           MOVE CAN-NUM-MOUT IN CAN-FLD TO DPS-NUM-MOUT.
           MOVE CAN-NUM-SOUT IN CAN-FLD TO DPS-NUM-SOUT.
           MOVE CAN-NUM-AOUT IN CAN-FLD TO DPS-NUM-AOUT.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO DPS-NUM-IVEN.
           MOVE RCV-MSC-MCAN IN CAN-FLD TO DPS-MSC-MCAN.

           MOVE SPACES TO DPS-IND-TIPR.
           MOVE SPACES TO DPS-COD-MENS.
           MOVE ZEROES TO SCR-SGV-MDPT.
           MOVE ZEROES TO DPS-VAL-MDPT.
           MOVE SCR-CMND TO DPS-SCR-CMND.
           COMPUTE DPS-SGV-PREP = CAN-SGV-TPAG IN CAN-FLD -
                                  SCR-SGV-INTN -
                                  SCR-SGV-INTM -
                                  CAN-SGV-COMI IN CAN-FLD.
           IF DPS-SGV-PREP NOT > ZEROES
               MOVE ZEROES TO DPS-SGV-PREP.
           PERFORM COL-LNK-DPS.
           IF DPS-COD-MENS > SPACES
                MOVE ZEROES TO SCR-SGV-MDPT
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
                MOVE ZEROES TO DPS-VAL-MDPT
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS
           ELSE
               IF DPS-VAL-MDPT NOT > ZEROES
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
      *            MOVE ZEROES TO DPS-VAL-MDPT
                   IF DPS-SCR-CMND = DPS-SCR-IG30
                       PERFORM MOVE-DATOS-SCR
                       MOVE ZEROES TO SCR-SGV-MDPT
                   ELSE
                       MOVE ZEROES TO SCR-SGV-MDPT
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS
               ELSE
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
      *            MOVE DPS-VAL-MDPT TO SCR-SGV-MDPT.
                   PERFORM MOVE-DATOS-SCR.
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS
           IF DPS-IND-TIPR = DPS-GLS-PPPP AND
              DPS-IND-IVEZ = DPS-GLS-INSI
               MOVE DPS-GLS-INNO TO DPS-IND-IVEZ
               COMPUTE CAN-SGV-TPAG IN CAN-FLD =
                       CAN-SGV-TPAG IN CAN-FLD +
                       SCR-SGV-MDPT
               GO TO CON-DPS-ITT.
       CON-LNK-SEG.
      *AFRI-FIN/DEVOLUCION SEGUROS/12-2013
      *AFRI-INI                                                         
           IF SCR-USER     = 'COLPGCA1'                                 
               IF SCR-MSC-TCAN = 'C' AND                                
                  SCR-MSC-FCAN = 'N' AND                                
                  SCR-MSC-ECAN = 'E'                                    
                   PERFORM PRO-TCAN-CTE                                 
                   PERFORM PRO-TCAN-CNE                                 
               ELSE                                                     
               IF SCR-MSC-TCAN = 'C' AND                                
                  SCR-MSC-FCAN = 'I' AND                                
                  SCR-MSC-ECAN = 'E' AND                                
                  ( RCV-MSC-MCAN IN CAN-FLD = 'V' OR                    
                  RCV-MSC-MCAN IN CAN-FLD = 'F' )                       
                   PERFORM PRO-TCAN-CTE                                 
                   PERFORM PRO-TCAN-CNE                                 
               ELSE                                                     
                   IF SCR-MSC-TCAN = 'C' AND                            
                      SCR-MSC-FCAN = 'I' AND                            
                      SCR-MSC-ECAN = 'E'                                
                        PERFORM PRO-TCAN-CIE                            
                   ELSE                                                 
                       NEXT SENTENCE                                    
           ELSE                                                         
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST                 
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB                   
           MOVE 'PERMITEPARCI' TO TAB-COD-CTAB IN TAB                   
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM GNS-FIO-TAB                                          
      *AFRI-INI                                                         
           IF  ( FIO-STAT-OKS AND                                       
                 TAB-IND-VIGE IN TAB = 'S' ) AND                        
               ( EIBTRNID = 'SAF4' OR                                   
                 EIBTRNID = 'KU98' )                                    
      *AFRI-FIN                                                         
               IF SCR-MSC-TCAN = 'C' AND                                
                  SCR-MSC-FCAN = 'N' AND                                
                  SCR-MSC-ECAN = 'E'                                    
                   PERFORM PRO-TCAN-CTE                                 
                   PERFORM PRO-TCAN-CNE                                 
               ELSE                                                     
                   IF SCR-MSC-TCAN = 'C' AND                            
                      SCR-MSC-FCAN = 'I' AND                            
                      SCR-MSC-ECAN = 'E' AND                            
                      ( RCV-MSC-MCAN IN CAN-FLD = 'V' OR                
                      RCV-MSC-MCAN IN CAN-FLD = 'F' )                   
                       PERFORM PRO-TCAN-CTE                             
                       PERFORM PRO-TCAN-CNE                             
                   ELSE                                                 
                   IF SCR-MSC-TCAN = 'C' AND                            
                      SCR-MSC-FCAN = 'I' AND                            
                      SCR-MSC-ECAN = 'E'                                
                        PERFORM PRO-TCAN-CIE                            
                   ELSE                                                 
                       NEXT SENTENCE                                    
           ELSE                                                         
      *AFRI-FIN                                                         
      *ALD/Procesa codigo CIE                                           
           IF SCR-MSC-TCAN = 'C' AND                                    
              SCR-MSC-FCAN = 'I' AND                                    
              SCR-MSC-ECAN = 'E'                                        
               PERFORM PRO-TCAN-CIE.                                    
      *                                                                 
      *ALD/Procesa codigo CPE                                           
           IF SCR-MSC-TCAN = 'C' AND                                    
              SCR-MSC-FCAN = 'P' AND                                    
              SCR-MSC-ECAN = 'E'                                        
               PERFORM PRO-TCAN-CPE.                                    
       PRO-MSG-MAL.                                                     
      *                                                                 
           IF FRM-SUAR = FRM-SUAR-MAL                                   
               MOVE 'COL' TO MSG-COD-SIST                               
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN1                            
               GO TO END-VAL-CON-FLD-CAN.                               
                                                                        
      *CONVIERTE A PESOS EL INTERES PAGADO A FCAN                       
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM                        
                             GIVING SCR-SGV-IPFC ROUNDED.               
           IF WSS-CIC-TVAL = '0'                                        
               MOVE SCR-SGV-IPFC TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-IPFC.           
      *                                                                 
       CON-VLD-FLD-SEC.                                                 
      *ISP NO PERMITE MODIFICAR CODIGOS DE CANCELACION,                 
      *    PARA CANCELACIONES YA CREADAS                                
           IF SCR-CCPP = 'MOD' OR                                       
              ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD )          
                                                                        
               IF SCR-MSC-TCAN = 'C' AND                                
                  SCR-MSC-TCNC = 'C'                                    
                    GO TO CHG-CAN                                       
               ELSE                                                     
               IF SCR-MSC-CANC NOT = SCR-MSC-CCNC                       
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'MSCCANCNOMOD' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN.                           
       CHG-CAN.                                                         
      *DAD ini  28-NOV-1994   (Tratamiento de la FECHA CTBL)            
      *DAD ini  19-FEB-1993   (Memo.14-10-92 Pto.1)                     
           IF CAN-FEC-FOUT IN CAN-FLD = CAN-FEC-FCAN IN CAN-FLD         
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD  
           ELSE                                                         
           IF WSS-FEC-FCTB IN WSS-VARI = WSS-FEC-FAUX IN WSS-VARI       
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD  
           ELSE                                                         
           IF WSS-FEC-FCTB IN WSS-VARI > WSS-FEC-FAUX IN WSS-VARI       
      *ALD-AFRI                                                         
      *        MOVE CAN-FEC-FCAN IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD. 
               MOVE CAN-FEC-FCAN IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD  
           ELSE                                                         
           IF SCR-USER = 'COLPGCA1'                                     
      *AFRI-INI/DIC2005                                                 
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD  
           ELSE                                                         
      *AFRI-FIN/DIC2005                                                 
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD. 
      *ALD-AFRI                                                         
      *DAD fin  28-NOV-1994                                             
      *     IF CAN-FEC-FEGR IN CAN-FLD NOT > ZEROES                     
      *         MOVE CAN-FEC-FCAN IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD 
      *     ELSE                                                        
      *         MOVE CAN-FEC-FEGR IN CAN-FLD TO FEC-FEC1                
      *         MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC2                
      *         MOVE FEC-FORM-FEC TO FEC-FORM                           
      *         MOVE FEC-CMP-FEC TO FEC-CMND                            
      *         PERFORM PRO-FEC                                         
      *         IF FEC-STAT-LES                                         
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR                       
      *             MOVE 'COL'          TO MSG-COD-SIST                 
      *             MOVE 'FECFEGRFCAN<' TO MSG-COD-MENS                 
      *             PERFORM GET-MSG                                     
      *             MOVE MSG-GLS-DESC TO FRM-MENS                       
      *             GO TO END-VAL-CON-FLD-CAN.                          
      *DAD fin  19-FEB-1993                                             
                                                                        
           IF ( SCR-MSC-TCAN = 'R' OR '1' )                             
               PERFORM VAL-CON-ROV                                      
               PERFORM RET-CAN-CAN                                      
               PERFORM RET-ROV-CAN.                                     
           IF FRM-SUAR = FRM-SUAR-MAL                                   
               GO TO END-VAL-CON-FLD-CAN.                               
                                                                        
      *ISP I.- CANCELACIONES                                            
      *ISP PARA UNA CANCELACION : ==> BORRAR VALOR RENOVADO             
                                                                        
      *ISP 'CTT' O 'CTE' CON VALOR PAGADO EN CERO                       
      *ISP CUANTO DEBO PAGAR ?                                          
           IF SCR-MSC-TCAN = 'C' AND                                    
              SCR-MSC-FCAN = 'T' AND                                    
              CAN-SGV-TPAG IN CAN-FLD NOT > ZEROES AND                  
              WSS-IBLK-TPAG  = 'S'                                      
                IF SCR-MSC-ECAN = 'T'                                   
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TPAG IN CAN-FLD     
                ELSE                                                    
                IF SCR-MSC-ECAN = 'E'                                   
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TPAG IN CAN-FLD.    
                                                                        
      *ISP 'CTT' O 'CTE' CON VALOR PAGADO MAYOR QUE CERO                
      *ISP PAGO ESA CANTIDAD, POSIBLE DIFERENCIA                        
           PERFORM ABS-TPAG.                                            
           IF SCR-MSC-TCAN = 'C' AND                                    
              SCR-MSC-FCAN = 'T'                                        
      *         IF CAN-SGV-TPAG IN CAN-FLD > ZEROES                     
                   IF SCR-MSC-ECAN = 'T' OR 'E'                         
                       SUBTRACT WSS-VAL-SVEN FROM WSS-SGV-TPAG GIVING   
                                              CAN-SGV-DIFE IN CAN-FLD.  
                                                                        
      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/04-2012
           IF WSS-CXE-ICAE IN CAE-VARI = 'S'
               MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/04-2012
                                                                        
      *LOP-INI 20-01-2004 CREDITO SIN MORA                              
           IF NOT ( SCR-MSC-TCAN = 'C' AND                              
                    SCR-MSC-FCAN = 'X' AND                              
                    SCR-MSC-ECAN = 'E' )                                
      *LOP-FIN 20-01-2004 CREDITO SIN MORA                              
      *AFRI-INI                                                         
           IF WSS-CMSG NOT = 'OFICONO'                                  
      *AFRI-FIN                                                         
           IF ( CAN-SGV-DIFE IN CAN-FLD NOT = ZEROS ) AND               
              ( SCR-CMND NOT = 'IVP' ) AND ( SCR-CMND NOT = 'MVP' )     
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'NODEBEIRTPAG' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO END-VAL-CON-FLD-CAN.                               
                                                                        
      *DAD ini  21-ABR-1993 / 19-FEB-1993   (Memo.05-11-92 Pto.1)       
      *LOP-INI 20-01-2004 CREDITO SIN MORA                              
           IF NOT ( SCR-MSC-TCAN = 'C' AND                              
                    SCR-MSC-FCAN = 'X' AND                              
                    SCR-MSC-ECAN = 'E' )                                
      *LOP-FIN 20-01-2004 CREDITO SIN MORA                              
           IF WSS-VAL-SVEN < WSS-VAL-SCAP AND                           
              WSS-OPEC NOT = 'B'                                        
      *AFRI-INI                                                         
      *        IF NOT ( SCR-CMND = 'IVP' OR SCR-CMND = 'MVP' )          
               IF NOT ( SCR-CMND = 'IVP' OR SCR-CMND = 'MVP' OR         
      *AFRI-FIN                                                         
                   WSS-CMSG NOT = 'OFICONO' )                           
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'CANTIPEDESC>' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN                            
               ELSE                                                     
      *            IF ( SCR-CMND = 'IVP' OR SCR-CMND = 'MVP' )          
                   IF ( SCR-MSC-TCAN = 'C' ) AND                        
                      ( SCR-MSC-FCAN = 'T' ) AND                        
                      ( SCR-MSC-ECAN = 'T' OR 'E' )                     
                       SUBTRACT WSS-VAL-SVEN FROM WSS-VAL-SCAP          
                                      GIVING CAN-SGV-DIFE IN CAN-FLD.   
      *AFRI-FIN                                                         
      *DAD fin  21-ABR-1993 / 19-FEB-1993                               

      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/04-2012
           IF WSS-CXE-ICAE IN CAE-VARI = 'S'
               MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/04-2012
                                                                        
      *ISP PARA CANCELACION PARCIAL CON FORMA CANCELACION 'P' O 'I' O 'C
      *ISP EXIGE VALOR PAGADO                                           
           IF SCR-MSC-TCAN = 'C' AND                                    
              ( SCR-MSC-FCAN = 'P' OR 'I' OR 'C' ) AND                  
                CAN-SGV-TPAG IN CAN-FLD NOT > ZEROES AND                
                WSS-IBLK-TPAG = 'S'                                     
                  MOVE 'COL'          TO MSG-COD-SIST                   
                  MOVE 'MSCFCANTPAGP' TO MSG-COD-MENS                   
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO END-VAL-CON-FLD-CAN.                            
                                                                        
      *ISP II.- RENOVACIONES                                            
      *ISP CALCULOS                                                     
      *ISP RENOVACION TOTAL ==> V.P. <> 0 ==> CALCULO V.R.              
      *                         V.R. <> 0 ==> CALCULO V.P.              
      *ISP TIENE PRIORIDAD EL VALOR PAGADO                              
                                                                        
      *AFRI-INI/LOF/CHC/07-2009
           IF LOC-GLS-NOCO IN LOC-VARI = 'SICOBRACOM' AND
            (CAN-MSC-CANC IN CAN-FLD = 'PTT' OR 'RTT' OR 'NTT')
               MOVE DLC-CIC-IOPC IN DLC TO WSS-DLC-IOPC IN WSS-VARI
               MOVE DLC-NUM-IDLC IN DLC TO WSS-DLC-IDLC IN WSS-VARI
               PERFORM DET-CUO-VCD
               PERFORM RES-VAL-DLC
               IF WSS-GLS-VCD IN WSS-VARI = 'SIVCD'
                   MOVE 'FGPVCDNOPER' TO LOC-GLS-MENS IN LOC-VARI.
      *AFRI-FIN/LOF/CHC/07-2009

      *AFRI-INI/CHC/OCT-2007/PTT-BGT
           IF WSS-OPEC = 'B' AND CAN-MSC-CANC IN CAN-FLD = 'PTT' AND
            SCR-CMND = 'ING'
               MOVE WSS-VAL-SVEN            TO CAN-SGV-TPAG IN CAN-FLD
               PERFORM VAL-COD-CAM
               MOVE ZEROES                  TO WSS-SGV-TREN
           ELSE
      *AFRI-FIN/CHC/OCT-2007/PTT-BGT
           IF ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' OR 'K' ) AND           
                SCR-MSC-FCAN = 'T'                                      
      *HZF-INI 7-FEB-2001                                               
      *         IF CAN-SGV-TPAG IN CAN-FLD > ZEROES                     
                IF CAN-SGV-TPAG IN CAN-FLD > ZEROES AND                 
                   CAN-SGV-TPAG IN CAN-FLD NOT = CAN-SGV-COMI IN CAN-FLD
      *HZF-FIN 7-FEB-2001                                               
                     IF SCR-MSC-ECAN = 'T'                              
      *JSS 20-AUG-1991 17:46:36 PARA MANEJAR ANULACION DE PTT,RTT,NTT   
                         IF (CAN-MSC-CANC IN CAN-FLD = 'QTT' OR 'STT'   
                                                   OR   'OTT') AND      
                            (CAN-FEC-FCAN IN CAN = OPC-FEC-FCOL IN OPC) 
                            IF CAN-SGV-TPAG IN CAN-FLD <                
                               OPC-VAL-SCRE IN OPC                      
                                 SUBTRACT CAN-SGV-TPAG IN CAN-FLD FROM  
                                 OPC-VAL-SCRE IN OPC GIVING             
                                 CAN-SGV-TREN IN CAN-FLD                
                                 MOVE ZEROES TO WSS-SGV-TREN            
                            ELSE                                        
                                 MOVE 'COL'          TO MSG-COD-SIST    
                                 MOVE 'SGVTPAGSCRE>' TO MSG-COD-MENS    
                                 PERFORM GET-MSG                        
                                 MOVE MSG-GLS-DESC TO FRM-MENS          
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR          
                                 GO TO END-VAL-CON-FLD-CAN              
                        ELSE                                            
      *JSS - FIN                                                        
                            IF CAN-SGV-TPAG IN CAN-FLD < WSS-VAL-SVEN   
                                 SUBTRACT CAN-SGV-TPAG IN CAN-FLD FROM  
                                 WSS-VAL-SVEN GIVING                    
                                 CAN-SGV-TREN IN CAN-FLD                
                                 MOVE ZEROES TO WSS-SGV-TREN            
                            ELSE                                        
                            IF CAN-SGV-TPAG IN CAN-FLD = WSS-VAL-SVEN   
                               AND WSS-OPEC = 'B'                       
                                 MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD 
                                 GO TO CON-VAL-CON-FLD-CAN              
                            ELSE                                        
                                 MOVE 'COL'          TO MSG-COD-SIST    
                                 MOVE 'SGVTPAGSCRE>' TO MSG-COD-MENS    
                                 PERFORM GET-MSG                        
                                 MOVE MSG-GLS-DESC TO FRM-MENS          
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR          
                                 GO TO END-VAL-CON-FLD-CAN              
                     ELSE                                               
                     IF SCR-MSC-ECAN = 'E'                              
                            IF CAN-SGV-TPAG IN CAN-FLD < WSS-VAL-SVEN   
                                 SUBTRACT CAN-SGV-TPAG IN CAN-FLD FROM  
                                 WSS-VAL-SVEN GIVING                    
                                 CAN-SGV-TREN IN CAN-FLD                
                                 MOVE ZEROES TO WSS-SGV-TREN            
                            ELSE                                        
                                 MOVE 'COL'          TO MSG-COD-SIST    
                                 MOVE 'SGVTPAGSVEN>' TO MSG-COD-MENS    
                                 PERFORM GET-MSG                        
                                 MOVE MSG-GLS-DESC TO FRM-MENS          
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR          
                                 GO TO END-VAL-CON-FLD-CAN              
                     ELSE                                               
                            NEXT SENTENCE                               
                 ELSE                                                   
                 IF CAN-SGV-TREN IN CAN-FLD > ZEROES                    
                     IF SCR-MSC-ECAN = 'T'                              
      *JSS 20-AUG-1991 17:46:36 PARA MANEJAR ANULACION DE PTT,RTT,NTT   
                         IF (CAN-MSC-CANC IN CAN-FLD = 'QTT' OR 'STT'   
                                                   OR   'OTT') AND      
                            (CAN-FEC-FCAN IN CAN = OPC-FEC-FCOL IN OPC) 
                            IF CAN-SGV-TREN IN CAN-FLD >                
                               OPC-VAL-SCRE IN OPC                      
                                 MOVE 'COL'          TO MSG-COD-SIST    
                                 MOVE 'SGVTRENLIQU>' TO MSG-COD-MENS    
                                 PERFORM GET-MSG                        
                                 MOVE MSG-GLS-DESC TO FRM-MENS          
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR          
                                 GO TO END-VAL-CON-FLD-CAN              
                            ELSE                                        
                                 SUBTRACT CAN-SGV-TREN IN CAN-FLD FROM  
                                 OPC-VAL-SCRE IN OPC GIVING             
                                 CAN-SGV-TPAG IN CAN-FLD                
                         ELSE                                           
      *JSS - FIN                                                        
                            IF CAN-SGV-TREN IN CAN-FLD > WSS-VAL-SVEN   
                                 MOVE 'COL'          TO MSG-COD-SIST    
                                 MOVE 'SGVTRENSCRE>' TO MSG-COD-MENS    
                                 PERFORM GET-MSG                        
                                 MOVE MSG-GLS-DESC TO FRM-MENS          
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR          
                                 GO TO END-VAL-CON-FLD-CAN              
                            ELSE                                        
                                 SUBTRACT CAN-SGV-TREN IN CAN-FLD FROM  
                                 WSS-VAL-SVEN GIVING                    
                                 CAN-SGV-TPAG IN CAN-FLD                
                     ELSE                                               
                     IF SCR-MSC-ECAN = 'E'                              
                            IF CAN-SGV-TREN IN CAN-FLD > WSS-VAL-SVEN   
                                 MOVE 'COL'          TO MSG-COD-SIST    
                                 MOVE 'SGVTRENSVEN>' TO MSG-COD-MENS    
                                 PERFORM GET-MSG                        
                                 MOVE MSG-GLS-DESC TO FRM-MENS          
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR          
                                 GO TO END-VAL-CON-FLD-CAN              
                            ELSE                                        
                                 SUBTRACT CAN-SGV-TREN IN CAN-FLD FROM  
                                 WSS-VAL-SVEN GIVING                    
                                 CAN-SGV-TPAG IN CAN-FLD.               
                                                                        
      *ISP RENOVACIONES CON VALOR RENOVADO EN CERO                      
      *ISP CUANTO DEBO RENOVAR ?                                        
           IF ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' OR 'K' ) AND           
              SCR-MSC-FCAN = 'T' AND                                    
              CAN-SGV-TREN IN CAN-FLD = ZEROES                          
      *HZF-INI 7-FEB-2001                                               
      *         MOVE ZEROES TO CAN-SGV-TPAG IN CAN-FLD                  
                MOVE CAN-SGV-COMI IN CAN-FLD TO CAN-SGV-TPAG IN CAN-FLD 
                IF SCR-MSC-ECAN = 'T'                                   
      *JSS 20-AUG-1991 17:46:36 PARA MANEJAR ANULACION DE PTT,RTT,NTT   
                    IF ( CAN-MSC-CANC IN CAN-FLD = 'QTT' OR 'STT' OR    
                                                            'OTT' ) AND 
                       ( CAN-FEC-FCAN IN CAN = OPC-FEC-FCOL IN OPC )    
                       MOVE OPC-VAL-SCRE IN OPC TO CAN-SGV-TREN         
                                                IN CAN-FLD              
                    ELSE                                                
      *JSS-FIN                                                          
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TREN IN CAN-FLD     
                       SUBTRACT CAN-SGV-COMI IN CAN-FLD FROM            
                                CAN-SGV-TREN IN CAN-FLD                 
                ELSE                                                    
                IF SCR-MSC-ECAN = 'E'                                   
      *AFRI-INI/LOF/CHC/07-2009
      *                MOVE WSS-VAL-SVEN TO CAN-SGV-TREN IN CAN-FLD.
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TREN IN CAN-FLD     
                       SUBTRACT CAN-SGV-COMI IN CAN-FLD FROM            
                                CAN-SGV-TREN IN CAN-FLD.                
      *AFRI-FIN/LOF/CHC/07-2009
                                                                        
       CON-VAL-CON-FLD-CAN.                                             
      *DAD ini  27-JUL-1994   (Minu.05-01-93 Pto.1)                     
      *    IF CAN-MSC-CANC IN CAN-FLD = 'PTT' OR 'PTE'                  
      *        IF WSS-CMP-FCAN IN WSS-VARI > WSS-CMP-FIMV IN WSS-VARI   
      *            MOVE 'COL'          TO MSG-COD-SIST                  
      *            MOVE 'PROFCANNOVAL' TO MSG-COD-MENS                  
      *            PERFORM GET-MSG                                      
      *            MOVE MSG-GLS-DESC TO FRM-MEN1                        
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR                        
      *            GO TO END-VAL-CON-FLD-CAN                            
      *        ELSE                                                     
      *            IF SCR-SGV-IPFC > CAN-SGV-TPAG IN CAN-FLD            
      *                MOVE 'COL'          TO MSG-COD-SIST              
      *                MOVE 'SGVIPFCNOPAG' TO MSG-COD-MENS              
      *                PERFORM GET-MSG                                  
      *                MOVE MSG-GLS-DESC TO FRM-MEN1                    
      *                MOVE FRM-SUAR-MAL TO FRM-SUAR                    
      *                GO TO END-VAL-CON-FLD-CAN.                       
      *DAD fin  27-JUL-1994                                             
                                                                        
      *ISP PARA UNA RENOVACION PARCIAL CON FORMA RENOVACION 'P' O 'I' O 
      *ISP EXIGE VALOR RENOVADO                                         
           IF ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' OR 'K' ) AND           
              ( SCR-MSC-FCAN = 'P' OR 'I' OR 'C') AND                   
                CAN-SGV-TREN IN CAN-FLD = ZEROES                        
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'MSCFCANTRENP' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN.                           
      *HZF-INI 4-SEP-2001                                               
           IF CYA-IND-TCYA IN CAN-FLD = 'XXXXX'                         
              IF CAN-SGV-TPAG IN CAN-FLD NOT = ZEROES                   
                 MOVE 'CTBL ' TO CYA-IND-TCYA IN CAN-FLD                
              ELSE                                                      
                 MOVE SPACES  TO CYA-IND-TCYA IN CAN-FLD.               
      *HZF-FIN 4-SEP-2001                                               
                                                                        
      * ISP-FIN INVOCADO POR COLB3CAN                                   
           PERFORM NO-VAL-MLT.                                          
           IF FRM-SUAR = FRM-SUAR-MAL                                   
               GO TO END-VAL-CON-FLD-CAN.                               
      * ISP-FIN INVOCADO POR COLB3CAN                                   
                                                                        
           IF ( CYA-IND-TCYA IN CAN-FLD NOT > SPACES AND                
                 ( CYA-CAI-ICYA IN CAN-FLD > SPACES OR                  
                   CYA-IIC-ICYA IN CAN-FLD > ZEROES ) )                 
                                                                        
                   MOVE 'COL'         TO MSG-COD-SIST                   
                   MOVE 'INDTCYAICYA' TO MSG-COD-MENS                   
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN.                           
                                                                        
           IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES                      
               GO TO FIN-VAL-ICYA.                                      
                                                                        
           IF WSS-GLS-DAT1 NOT > SPACES                                 
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD                   
               MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD                   
               GO TO FIN-VAL-ICYA.                                      
                                                                        
           IF CYA-IIC-ICYA IN CAN-FLD NOT > ZEROES                      
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'IICICYACCOBL' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO END-VAL-CON-FLD-CAN.                               
      *HZF-INI 2-JUN-2003                                               
           IF SCR-USER = 'COLPGCA1'                                     
              GO TO FIN-VAL-ICYA.                                       
      *HZF-FIN 2-JUN-2003                                               
           PERFORM GET-CLI-OPC.                                         
           MOVE RDC-CIC-ICLI IN RDC TO RCO-CIC-ICLI IN RCO.             
           MOVE CYA-CAI-ICYA IN CAN-FLD TO RCO-CAI-IOPE IN RCO.         
           MOVE CYA-IIC-ICYA IN CAN-FLD TO RCO-IIC-IOPE IN RCO.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-RCO.                                         
           IF FIO-STAT-OKS                                              
               IF RCO-COD-STAT IN RCO = 'ELI'                           
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'CICICYACNVIG' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN                            
               ELSE                                                     
               IF WSS-GLS-DAT1 = 'O'                                    
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'CICICYACSCLI' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN                            
               ELSE                                                     
                   GO TO CER-VAL-CYA-CAI-ICYA.                          
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.                             
           MOVE CYA-CAI-ICYA IN CAN-FLD TO RCO-CAI-IOPE IN RCO.         
           MOVE CYA-IIC-ICYA IN CAN-FLD TO RCO-IIC-IOPE IN RCO.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-RCO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'CICICYACCNEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO END-VAL-CON-FLD-CAN                                
           ELSE                                                         
               IF RCO-COD-STAT IN RCO = 'ELI'                           
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'CICICYACNVIG' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN                            
               ELSE                                                     
               IF WSS-GLS-DAT1 = 'M'                                    
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'CICICYACNCLI' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN.                           
       CER-VAL-CYA-CAI-ICYA.                                            
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-OPE.                                         
           IF OPE-FEC-FTOP IN OPE > ZEROES                              
               IF OPE-FEC-FTOP IN OPE > OPE-FEC-FROP IN OPE             
                   MOVE 'COL'          TO MSG-COD-SIST                  
                   MOVE 'FECFTOPICYA>' TO MSG-COD-MENS                  
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MEN1                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN.                           
       FIN-VAL-ICYA.                                                    
      *----------------------------------------------------*            
      * RBG/INI/15-NOV-1996 Esto es para el cobro de Comision.          
                                                                        
           IF MSC-CIC-CMSC IN MSC NOT = 'CAJA'                          
               GO TO CONT-SIN-COBR.                                     
                                                                        
           IF WSS-OPEC = 'B' OR WSS-OPEC = 'D'                          
               GO TO CONT-SIN-COBR.                                     
                                                                        
      * DPM INI  24.07.2000                                             
           PERFORM VAL-CLASE-CON.                                       
           IF WSS-IND-FLAG IN WSS-VARI = 1                              
               GO TO CONT-SIN-COBR.                                     
      * DPM FIN  24.07.2000                                             
                                                                        
      *ALD-BCI-INI/01.02.1999                                           
           MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC          
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC          
           MOVE ZEROES                  TO DLC-NUM-IDLC IN DLC          
           MOVE FIO-GET-NLS TO FIO-CMND                                 
           PERFORM COL-FIO-DLC                                          
           IF DLC-IND-SCTB IN DLC = 'VCD' OR                            
              DLC-IND-SCTB IN DLC = 'CAS'                               
               GO TO CONT-SIN-COBR.                                     
      *ALD-BCI-FIN/01.02.1999                                           
                                                                        
           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-NUM-DCAN IN WSS-VARI.    
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-NUM-MCAN IN WSS-VARI.    
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-NUM-SCAN IN WSS-VARI.    
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-NUM-ACAN IN WSS-VARI.    
           MOVE VEN-NUM-DVEN IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.    
           MOVE VEN-NUM-MVEN IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.    
           MOVE VEN-NUM-SVEN IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.    
           MOVE VEN-NUM-AVEN IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.    
           IF WSS-CMP-FCAN IN WSS-VARI NOT > WSS-CMP-FIMV IN WSS-VARI   
               GO TO CONT-SIN-COBR.                                     
                                                                        
           PERFORM LIM-TBAN.                                            
      *INI-JGM.                                                         
           MOVE CAN-CIC-IOPC IN CAN TO RDC-CIC-IOPC IN RDC.             
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.                             
           PERFORM COL-FIO-RDC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    CAN-CIC-IOPC IN CAN = RDC-CIC-IOPC IN RDC )         
                     MOVE 'COL'          TO MSG-COD-SIST                
                     MOVE 'CLI    NORDC' TO MSG-COD-MENS                
                     PERFORM GET-MSG                                    
                     MOVE MSG-GLS-DESC TO FRM-MENS                      
                     MOVE FRM-SUAR-MAL TO FRM-SUAR                      
                     GO TO END-VAL-CON-FLD-CAN.                         
                                                                        
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.             
           MOVE FIO-GET-KEY TO FIO-CMND                                 
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'RDC    NOCLI' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO END-VAL-CON-FLD-CAN.                               
                                                                        
           MOVE 'N' TO WSS-IND-SGAS IN WSS-VARI.                        
                                                                        
           IF DBC-IND-TICL IN DBC = 'P'                                 
              MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP           
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM SGC-FIO-DCP                                       
              IF NOT FIO-STAT-OKS                                       
                   MOVE 'SGC'        TO MSG-COD-SIST                    
                   MOVE 'DCP    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO END-VAL-CON-FLD-CAN                            
               ELSE                                                     
                   MOVE DCP-COD-TBAN IN DCP TO WSS-COD-BANC IN WSS-VARI 
                   PERFORM CHK-EXI-TBAN-CCM                             
                   IF WSS-IND-EBAN IN WSS-VARI = 'S'                    
                       GO TO SIG-CON-BANC                               
                   ELSE                                                 
                       GO TO CONT-SIN-COBR                              
           ELSE                                                         
              IF DBC-IND-TICL IN DBC = 'E'                              
                 MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE        
                 MOVE FIO-GET-KEY TO FIO-CMND                           
                 PERFORM SGC-FIO-DCE                                    
                 IF NOT FIO-STAT-OKS                                    
                      MOVE 'SGC'        TO MSG-COD-SIST                 
                      MOVE 'DCE    NEX' TO MSG-COD-MENS                 
                      PERFORM GET-MSG                                   
                      MOVE MSG-GLS-DESC TO FRM-MENS                     
                      MOVE FRM-SUAR-MAL TO FRM-SUAR                     
                      GO TO END-VAL-CON-FLD-CAN                         
                 ELSE                                                   
                      MOVE DCE-COD-TBAN IN DCE TO WSS-COD-BANC          
                                                             IN WSS-VARI
                      PERFORM CHK-EXI-TBAN-CCM                          
                      IF WSS-IND-EBAN IN WSS-VARI = 'S'                 
                          GO TO SIG-CON-BANC                            
                      ELSE                                              
                          GO TO CONT-SIN-COBR.                          
       SIG-CON-BANC.                                                    
      *---------------*                                                 
      *FIN-JGM 01-06-2000.                                              
           PERFORM RST-DIA-HBLS.                                        
      *                                                                 
           IF WSS-IND-MORA IN WSS-VARI NOT = 'S'                        
               GO TO CONT-SIN-COBR.                                     
                                                                        
           IF WSS-COD-MONE IN WSS-VARI = '0999  '                       
               MOVE 1 TO WSS-SGV-VCAM IN WSS-VARI                       
               GO TO CONT-SIN-VCAM.                                     
                                                                        
           MOVE WSS-COD-MONE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE '0999  '                 TO CAM-COD-VCAM IN CAM(2).     
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO CAM-NUM-MCAM IN CAM(1).     
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO CAM-NUM-SCAM IN CAM(1).     
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO CAM-NUM-ACAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')                
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN1                            
               MOVE CAM-KEY-CAMB TO FRM-MEN2                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO END-VAL-CON-FLD-CAN                                
           ELSE                                                         
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM.                
                                                                        
       CONT-SIN-VCAM.                                                   
      *ALD-BCI-INI/17.08.2000                                           
      *    MOVE 'COM-KEY-IICG' TO FIO-AKEY.                             
      *    MOVE OPC-CIC-IOPC IN OPC     TO COM-CIC-IOPC IN COM.         
      *    MOVE ZEROES                  TO COM-NUM-ICAN IN COM.         
      *    MOVE SPACES                  TO COM-CIC-IOPV IN COM.         
      *    MOVE ZEROES                  TO COM-NUM-IVCT IN COM.         
      *    MOVE SPACES                  TO COM-IND-TTAS IN COM.         
      *    MOVE ZEROES                  TO COM-FEC-FINI IN COM.         
      *    MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-FEC-COM.                                                     
      *    PERFORM COL-FIO-COM.                                         
      *    IF NOT ( FIO-STAT-OKS AND                                    
      *        COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC )              
      *         MOVE 'N' TO WSS-IND-HAYA IN WSS-VARI                    
      *    ELSE                                                         
      *        IF COM-IND-TTAS IN COM NOT = 'CMO'                       
      *            MOVE FIO-GET-NXT TO FIO-CMND                         
      *            GO TO LUP-FEC-COM                                    
      *        ELSE                                                     
      *            IF CAN-NUM-SOUT IN CAN-FLD = COM-NUM-SINI IN COM AND 
      *               CAN-NUM-AOUT IN CAN-FLD = COM-NUM-AINI IN COM AND 
      *               CAN-NUM-MOUT IN CAN-FLD = COM-NUM-MINI IN COM AND 
      *               CAN-NUM-DOUT IN CAN-FLD = COM-NUM-DINI IN COM     
      *                 IF COM-MSC-STAT IN COM = 'R' OR                 
      *                    COM-SGV-MNTO IN COM < ZEROES                 
      *                     MOVE 'N' TO WSS-IND-HAYA IN WSS-VARI        
      *                     MOVE FIO-GET-NXT TO FIO-CMND                
      *                     GO TO LUP-FEC-COM                           
      *                 ELSE                                            
      *                     IF CAN-MSC-STAT IN CAN = 'A' AND            
      *                        SCR-CMND = 'MOD'                         
      *                         MOVE 'S' TO WSS-IND-HAYA IN WSS-VARI    
      *                         GO TO CONT-SIN-COBR                     
      *                     ELSE                                        
      *                         NEXT SENTENCE                           
      *            ELSE                                                 
      *                MOVE FIO-GET-NXT TO FIO-CMND                     
      *                GO TO LUP-FEC-COM.                               
      *ALD-BCI-FIN/17.08.2000                                           
                                                                        
      * Verifico la Moneda para luego multiplicarla por el Valor de Camb
           IF WSS-VAL-MOUF IN WSS-VARI NOT NUMERIC                      
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'MONNONUMERIC' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO END-VAL-CON-FLD-CAN                                
           ELSE                                                         
               MULTIPLY WSS-VAL-MOUF IN WSS-VARI BY WSS-SGV-VCAM IN     
                           WSS-VARI GIVING WSS-SGV-NETO IN WSS-VARI.    
      * Voy a buscar el Iva.                                            
           MOVE 'TAB'       TO FIO-SIST.                                
           MOVE 'IVA'       TO TAB-COD-TTAB IN TAB.                     
           MOVE SPACES      TO TAB-COD-CTAB IN TAB.                     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')          
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'IVA    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO END-VAL-CON-FLD-CAN.                               
                                                                        
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DAT2 IN WSS-VARI.        
           IF WSS-NUM-PIVA IN WSS-VARI NOT NUMERIC                      
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'IVANONUMERIC' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO END-VAL-CON-FLD-CAN.                               
                                                                        
           DIVIDE WSS-NUM-PIVA IN WSS-VARI BY 100                       
           GIVING WSS-VAL-IVA  IN WSS-VARI.                             
                                                                        
           MULTIPLY WSS-SGV-NETO IN WSS-VARI BY WSS-VAL-IVA IN WSS-VARI 
             GIVING WSS-SGV-MIVA IN WSS-VARI.                           
                                                                        
           MOVE WSS-SGV-MIVA IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.   
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-MIVA IN WSS-VARI.   
                                                                        
           MOVE WSS-SGV-NETO IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.   
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-NETO IN WSS-VARI.   
                                                                        
           COMPUTE WSS-SGV-TCOM IN WSS-VARI = WSS-SGV-MIVA IN WSS-VARI +
                                               WSS-SGV-NETO IN WSS-VARI.
           MOVE WSS-SGV-TCOM IN WSS-VARI TO CAN-SGV-GAST IN CAN-FLD.    
                                                                        
       CONT-SIN-COBR.                                                   
      *--------------*                                                  
                                                                        
       END-VAL-CON-FLD-CAN.                                             
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
           IF SCR-SGV-JUDI > ZEROES
               GO TO SIG-VAL-CON-FLD-CAN.
           PERFORM PRO-LEE-JDLC.
           IF DLC-IND-SCBZ IN DLC = 'JUDIC'
      *AFRI-INI/CHC/JUN-2009/HONORARIOS JUDICIALES
      *        IF EIBTRNID = 'KO70' OR
      *           EIBTRNID = 'KQ97'
               IF NOT (SCR-USER = 'COLPGCA1' OR
                       SCR-USER = 'COLPGCPG')
      *AFRI-FIN/CHC/JUN-2009/HONORARIOS JUDICIALES
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
                  PERFORM PRO-JUDIC-HONO
      *           PERFORM PRO-HON-JUDI
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
                  IF WSS-JUD-ERRO IN JUD-VARI = 'S'
                      MOVE 'COL' TO MSG-COD-SIST
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      PERFORM BCK-OUT
                      GO TO FIN-VAL-CON-FLD-CAN
                  ELSE
                      MOVE WSS-SGV-HCJU IN JUD-VARI TO SCR-SGV-JUDI
                      ADD WSS-SGV-HCJU IN JUD-VARI TO
                                            CAN-SGV-GAST IN CAN-FLD.
       SIG-VAL-CON-FLD-CAN.
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
                                                                        
                                                                        
      * SUMA LOS GASTOS                                                 
           IF SCR-MSC-TCAN = 'C'                                        
                ADD CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-TPAG IN CAN-FLD  
           ELSE                                                         
                ADD CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-TREN IN CAN-FLD. 
                                                                        
      *AFRI-INI                                                         
      *    IF SCR-MSC-TCAN = 'C'                                        
      *         ADD DLC-VAL-IPEN IN DLC TO CAN-SGV-TPAG IN CAN-FLD      
      *    ELSE                                                         
      *         ADD DLC-VAL-IPEN IN DLC TO CAN-SGV-TREN IN CAN-FLD.     
      *AFRI-FIN                                                         
           IF SCR-MSC-TCAN = 'N' OR                                     
              SCR-MSC-TCAN = 'R'                                        
                MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.                 
                                                                        
      *JSS 30-JUL-1991 17:03:45 para manejar 'ATT'                      
           IF ( CAN-MSC-CANC IN CAN-FLD = 'ATT' ) AND                   
              ( CAN-FEC-FCAN IN CAN = OPC-FEC-FCOL IN OPC )             
               MOVE ZEROES TO CAN-SGV-GAST IN CAN-FLD                   
               MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD                   
               MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD                   
               MOVE OPC-SGV-LIQU IN OPC TO CAN-SGV-TPAG IN CAN-FLD.     
                                                                        
      *ISP PARA MONEDA NACIONAL SIEMPRE MUESTRA VALOR RENOVADO,         
      *    VALOR PAGADO, DIFERENCIA Y GASTOS SIN DECIMALES              
           IF WSS-CIC-TVAL = '0'                                        
      *ALD                                                              
               MOVE CAN-SGV-DIFE IN CAN-FLD TO PES-SGV-DECI             
                                                    IN PES-VARI         
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-DIFE            
                                                      IN CAN-FLD        
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI             
                                                    IN PES-VARI         
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG            
                                                      IN CAN-FLD        
               MOVE CAN-SGV-TREN IN CAN-FLD TO PES-SGV-DECI             
                                                    IN PES-VARI         
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TREN            
                                                      IN CAN-FLD.       
                                                                        
           IF WSS-CIC-VCAM = '0999'                                     
      *ALD                                                              
               MOVE RCV-SGV-CAPI IN CAN-FLD TO PES-SGV-DECI             
                                                    IN PES-VARI         
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-CAPI            
                                                      IN CAN-FLD        
                                                                        
               MOVE RCV-SGV-FINA IN CAN-FLD TO PES-SGV-DECI             
                                                    IN PES-VARI         
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-FINA            
                                                      IN CAN-FLD        
                                                                        
               MOVE VEN-VAL-SCAP IN CAN-FLD TO PES-SGV-DECI             
                                                    IN PES-VARI         
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-SCAP            
                                                      IN CAN-FLD        
                                                                        
               MOVE VEN-VAL-SFIN IN CAN-FLD TO PES-SGV-DECI             
                                                    IN PES-VARI         
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-SFIN            
                                                      IN CAN-FLD.       
      *AFRI-INI/LOF/CHC/07-2009
      *AFRI-INI 15-SEP-2010 GARANTIAS ESTATALES
      *    IF LOC-GLS-NOCO IN LOC-VARI = 'SICOBRACOM'
           IF LOC-GLS-NOCO IN LOC-VARI = 'SICOBRACOM' OR
              LOC-GLS-GARE IN LOC-VARI = 'SIGAREST'
      *AFRI-FIN 15-SEP-2010 GARANTIAS ESTATALES
            IF CAN-MSC-CANC IN CAN-FLD = 'PTT' OR 'KTT' OR 'RTT'
               MOVE CAN-SGV-TREN IN CAN-FLD TO LOC-FLD-TREN IN LOC-VARI
               MOVE RCV-SGV-CAPI IN CAN-FLD TO LOC-RCV-CAPI IN LOC-VARI
               PERFORM LOC-CON-CAP
               IF LOC-GLS-MENS IN LOC-VARI NOT > SPACES
      *AFRI-INI/LOF/ALD/06-2010
                   IF LOC-FLD-TREN IN LOC-VARI NOT < LOC-RCV-CAPI IN
                                                     LOC-VARI
      *AFRI-FIN/LOF/ALD/06-2010
                       COMPUTE LOC-FLD-TREN IN LOC-VARI =
                     LOC-FLD-TREN IN LOC-VARI - LOC-RCV-CAPI IN LOC-VARI
      *AFRI-INI/LOF/ALD/06-2010
      *          IF LOC-FLD-TREN IN LOC-VARI > 10
                 IF LOC-FLD-TREN IN LOC-VARI > 2
                        MOVE 'PAGARINTER' TO LOC-GLS-MENS IN LOC-VARI
                       ELSE
                           NEXT SENTENCE
                   ELSE
            IF CAN-MSC-CANC IN CAN-FLD = 'PTT'
                       COMPUTE LOC-FLD-TREN IN LOC-VARI =
                     LOC-RCV-CAPI IN LOC-VARI - LOC-FLD-TREN IN LOC-VARI
                       IF LOC-FLD-TREN IN LOC-VARI > 2
      *AFRI-FIN/LOF/ALD/06-2010
                        MOVE 'PAGARINTER' TO LOC-GLS-MENS IN LOC-VARI.

           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO CON-PRO-FLD-CAN.

           IF LOC-GLS-MENS IN LOC-VARI NOT = SPACES
            IF MSG-COD-SIST > SPACES
               MOVE LOC-GLS-MENS IN LOC-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
            ELSE
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE LOC-GLS-MENS IN LOC-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

       CON-PRO-FLD-CAN.
      *AFRI-FIN/LOF/CHC/07-2009
      * Graba Comisiones y Gastos                                       
           IF FRM-SUAR NOT = FRM-SUAR-MAL                               
               PERFORM GRA-COM-PCP                                      
               IF MSG-COD-MENS > SPACES                                 
                   GO TO FIN-VAL-CON-FLD-CAN.                           
      *LOP-INI 20-01-2004 CREDITO SIN MORA                              
      * Graba Comisiones y Gastos                                       
           IF FRM-SUAR NOT = FRM-SUAR-MAL                               
               PERFORM PUT-IMP-TRA                                      
               IF MSG-COD-MENS > SPACES                                 
                   GO TO FIN-VAL-CON-FLD-CAN.                           
      *LOP-FIN 20-01-2004 CREDITO SIN MORA                              
      *DAD ini  12-NOV-1992                                             
           IF FRM-GLS-IITR IN CAN-FLD NOT = FRM-GLS-TINT IN CAN-FLD AND 
              FRM-SUAR = FRM-SUAR-MAL                                   
               PERFORM BASE-TASA-INI.                                   
      *DAD fin  12-NOV-1992                                             
                                                                        
      *DAD ini  04-AGO-1993   (Memo.28-06-93)                           
      *AFRI-INI                                                         
           IF WSS-CMSG = 'OFICONO'                                      
               MOVE SPACES TO WSS-CMSG.                                 
      *AFRI-FIN                                                         
      *Valida existencia de informacion en campos informados con perdida
           IF NOT ( MSG-COD-MENS > SPACES OR                            
                    FRM-SUAR = FRM-SUAR-MAL )                           
               PERFORM VAL-DAT-PREV-ING                                 
               IF MSG-COD-MENS > SPACES                                 
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.                       
      *DAD fin  04-AGO-1993                                             
      *AFRI-INI/DEVOLUCION SEGUROS/12-2013
           IF SCR-USER = DPS-SCR-USER                                   
               GO FIN-VAL-CON-FLD-CAN.                                  
           IF SCR-SGV-MDPT > ZEROES
               COMPUTE CAN-SGV-TPAG IN CAN-FLD =
                       CAN-SGV-TPAG IN CAN-FLD -
                       DPS-VAL-MDPT.
           MOVE DPS-VAL-MDPT      TO DPS-SGV-LIQU-EDT
           MOVE DPS-SGV-LIQU-ALF TO DPS-GLS-LIQU
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
      *    MOVE 'DEVOLUCION SEGURO :' TO DPS-GLS-GME2
           MOVE DPS-GLS-INIC          TO DPS-GLS-GME2
           IF DPS-IND-SEL = DPS-GLS-INSI
               MOVE DPS-GLS-SELP TO DPS-GLS-GME21
           ELSE
               MOVE DPS-GLS-BBBP TO DPS-GLS-GME21.
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS
           MOVE DPS-FRM-MEN2          TO FRM-MEN2.
      *AFRI-FIN/DEVOLUCION SEGUROS/12-2013
      *>>>>
       FIN-VAL-CON-FLD-CAN.
           EXIT.
       
       VAL-CON-CAN SECTION.
       INI-VAL-CON-CAN.
       FIN-VAL-CON-CAN.
           EXIT.
       
       VAL-NUM-KEY-CAN SECTION.
       INI-VAL-NUM-KEY-CAN.
           PERFORM VAL-NUM-IKY-CAN.
           PERFORM VAL-NUM-MKY-CAN.
           PERFORM VAL-NUM-AKY-CAN.
       FIN-VAL-NUM-KEY-CAN.
           EXIT.
       
       VAL-NUM-IKY-CAN SECTION.
       INI-VAL-NUM-IKY-CAN.
       VAL-NUM-CAN-IIC-IOPC.
           MOVE CAN-IIC-IOPC-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CAN-IIC-IOPC IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CAN-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-IKY-CAN.
       VAL-NUM-VEN-NUM-IVCT.
           MOVE VEN-NUM-IVCT-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO VEN-NUM-IVCT IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-NUM-IVCT-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-IKY-CAN.
       VAL-NUM-VEN-NUM-IVEN.                                            
           MOVE VEN-NUM-IVEN-ALF IN CAN-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 3 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO VEN-NUM-IVEN IN CAN-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO VEN-NUM-IVEN-LEN IN CAN-FLD                   
                GO TO FIN-VAL-NUM-IKY-CAN.                              
       FIN-VAL-NUM-IKY-CAN.
           EXIT.
       
       VAL-NUM-MKY-CAN SECTION.
       INI-VAL-NUM-MKY-CAN.
       FIN-VAL-NUM-MKY-CAN.
           EXIT.
       
       VAL-NUM-AKY-CAN SECTION.
       INI-VAL-NUM-AKY-CAN.
       VAL-NUM-CAN-NUM-ICAN.
           MOVE CAN-NUM-ICAN-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CAN-NUM-ICAN IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CAN-NUM-ICAN-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-AKY-CAN.
       FIN-VAL-NUM-AKY-CAN.
           EXIT.
       
       VAL-NUM-FLD-CAN SECTION.
       INI-VAL-NUM-FLD-CAN.
      *<<<< INI_VAL_NUM_FLD_CAN
           IF CAN-SGV-TPAG-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TPAG
           ELSE
               MOVE 'N' TO WSS-IBLK-TPAG.
           IF ICG-SGV-TINT-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TINT
           ELSE
               MOVE 'N' TO WSS-IBLK-TINT.
           IF COM-SGV-TINT-ALF > SPACES                                 
               MOVE 'N' TO WSS-IBLK-COMI                                
           ELSE                                                         
               MOVE SPACES TO WSS-IBLK-COMI.                            
      *>>>>
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-ROV-IIC-IOPC.
           MOVE ROV-IIC-IOPC-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ROV-IIC-IOPC IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ROV-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-ICG-SGV-TINT.
           MOVE ICG-SGV-TINT-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO ICG-SGV-TINT IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ICG-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-FRM-SGV-TINT.
           MOVE FRM-SGV-TINT-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-SGV-TINT IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-COM-SGV-TINT.
           MOVE COM-SGV-TINT-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO COM-SGV-TINT IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO COM-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-SGV-GAST.
           MOVE CAN-SGV-GAST-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO CAN-SGV-GAST IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CAN-SGV-GAST-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-OPC-NUM-VCVG.
           MOVE OPC-NUM-VCVG-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO OPC-NUM-VCVG IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OPC-NUM-VCVG-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-NUM-PLCO.
           MOVE CAN-NUM-PLCO-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CAN-NUM-PLCO IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CAN-NUM-PLCO-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-SGV-COMI.
           MOVE CAN-SGV-COMI-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO CAN-SGV-COMI IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CAN-SGV-COMI-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-SGV-TREN.
           MOVE CAN-SGV-TREN-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO CAN-SGV-TREN IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CAN-SGV-TREN-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-SGV-TPAG.
           MOVE CAN-SGV-TPAG-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO CAN-SGV-TPAG IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CAN-SGV-TPAG-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-VEN-NUM-IVEN.
           MOVE VEN-NUM-IVEN-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO VEN-NUM-IVEN IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-NUM-IVEN-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CYA-IIC-ICYA.
           MOVE CYA-IIC-ICYA-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CYA-IIC-ICYA IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CYA-IIC-ICYA-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-OPC-VAL-SCRE.
           MOVE OPC-VAL-SCRE-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO OPC-VAL-SCRE IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OPC-VAL-SCRE-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-CAN-SGV-DIFE.
           MOVE CAN-SGV-DIFE-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO CAN-SGV-DIFE IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CAN-SGV-DIFE-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-VEN-VAL-SCAP.
           MOVE VEN-VAL-SCAP-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO VEN-VAL-SCAP IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-VAL-SCAP-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-RCV-SGV-CAPI.
           MOVE RCV-SGV-CAPI-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO RCV-SGV-CAPI IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RCV-SGV-CAPI-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-VEN-VAL-SFIN.
           MOVE VEN-VAL-SFIN-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO VEN-VAL-SFIN IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-VAL-SFIN-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       VAL-NUM-RCV-SGV-FINA.
           MOVE RCV-SGV-FINA-ALF IN CAN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO RCV-SGV-FINA IN CAN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RCV-SGV-FINA-LEN IN CAN-FLD
                GO TO FIN-VAL-NUM-FLD-CAN.
       FIN-VAL-NUM-FLD-CAN.
           EXIT.
       
       EDT-KEY-CAN SECTION.
       INI-EDT-KEY-CAN.
           PERFORM EDT-IKY-CAN.
           PERFORM EDT-MKY-CAN.
           PERFORM EDT-AKY-CAN.
       FIN-EDT-KEY-CAN.
           EXIT.
       
       EDT-IKY-CAN SECTION.
       INI-EDT-IKY-CAN.
           IF CAN-IIC-IOPC-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAN-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-EDT-IKY-CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC-EDT IN CAN-EDT.
           MOVE CAN-IIC-IOPC-EDT IN CAN-EDT TO 
                CAN-IIC-IOPC-ALF IN CAN-FLD.
           IF VEN-NUM-IVCT-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-NUM-IVCT-LEN IN CAN-FLD
                GO TO FIN-EDT-IKY-CAN.
           MOVE VEN-NUM-IVCT IN CAN-FLD TO VEN-NUM-IVCT-EDT IN CAN-EDT.
           MOVE VEN-NUM-IVCT-EDT IN CAN-EDT TO 
                VEN-NUM-IVCT-ALF IN CAN-FLD.
           IF VEN-NUM-IVEN-LEN IN CAN-FLD = -9                          
                MOVE -1 TO VEN-NUM-IVEN-LEN IN CAN-FLD                  
                GO TO FIN-EDT-IKY-CAN.                                  
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN-EDT IN CAN-EDT. 
           MOVE VEN-NUM-IVEN-EDT IN CAN-EDT TO                          
                VEN-NUM-IVEN-ALF IN CAN-FLD.                            
       FIN-EDT-IKY-CAN.
           EXIT.
       
       EDT-MKY-CAN SECTION.
       INI-EDT-MKY-CAN.
       FIN-EDT-MKY-CAN.
           EXIT.
       
       EDT-AKY-CAN SECTION.
       INI-EDT-AKY-CAN.
           IF CAN-NUM-ICAN-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAN-NUM-ICAN-LEN IN CAN-FLD
                GO TO FIN-EDT-AKY-CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN-EDT IN CAN-EDT.
           MOVE CAN-NUM-ICAN-EDT IN CAN-EDT TO 
                CAN-NUM-ICAN-ALF IN CAN-FLD.
       FIN-EDT-AKY-CAN.
           EXIT.
       
       EDT-FLD-CAN SECTION.
       INI-EDT-FLD-CAN.
           IF DBC-NUM-ICLI-LEN IN CAN-FLD = -9                          
                MOVE -1 TO DBC-NUM-ICLI-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE DBC-NUM-ICLI IN CAN-FLD TO DBC-NUM-ICLI-EDT IN CAN-EDT. 
           MOVE DBC-NUM-ICLI-EDT IN CAN-EDT TO                          
                DBC-NUM-ICLI-ALF IN CAN-FLD.                            
           IF ROV-IIC-IOPC-LEN IN CAN-FLD = -9                          
                MOVE -1 TO ROV-IIC-IOPC-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE ROV-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPC-EDT IN CAN-EDT. 
           MOVE ROV-IIC-IOPC-EDT IN CAN-EDT TO                          
                ROV-IIC-IOPC-ALF IN CAN-FLD.                            
           IF ICG-SGV-TINT-LEN IN CAN-FLD = -9                          
                MOVE -1 TO ICG-SGV-TINT-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
      *DAD ini  10-JUN-1992 - ALD/ 3-MAY-1990                           
      *    MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT-EDT IN CAN-EDT. 
      *    MOVE ICG-SGV-TINT-EDT IN CAN-EDT TO                          
      *         ICG-SGV-TINT-ALF IN CAN-FLD.                            
           IF WSS-IBLK-TINT = 'N'                                       
           MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT-EDT1 IN CAN-EDT 
           MOVE ICG-SGV-TINT-EDT1 IN CAN-EDT TO                         
                ICG-SGV-TINT-ALF IN CAN-FLD                             
           ELSE                                                         
           MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT-EDT IN CAN-EDT  
           MOVE ICG-SGV-TINT-EDT IN CAN-EDT TO                          
                ICG-SGV-TINT-ALF IN CAN-FLD.                            
      *DAD fin  10-JUN-1992 - ALD/ 3-MAY-1990                           
           IF FRM-SGV-TINT-LEN IN CAN-FLD = -9                          
                MOVE -1 TO FRM-SGV-TINT-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE FRM-SGV-TINT IN CAN-FLD TO FRM-SGV-TINT-EDT IN CAN-EDT. 
           MOVE FRM-SGV-TINT-EDT IN CAN-EDT TO                          
                FRM-SGV-TINT-ALF IN CAN-FLD.                            
           IF COM-SGV-TINT-LEN IN CAN-FLD = -9                          
                MOVE -1 TO COM-SGV-TINT-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
      *HZF-INI 15-11-2000                                               
           IF WSS-IBLK-COMI = 'N' AND COM-SGV-TINT IN CAN-FLD = ZEROES  
      *    MOVE COM-SGV-TINT IN CAN-FLD TO COM-SGV-TINT-EDT IN CAN-EDT  
           MOVE '   0,0000'       TO                                    
                COM-SGV-TINT-ALF IN CAN-FLD                             
           ELSE                                                         
      *HZF-FIN 15-11-2000                                               
           MOVE COM-SGV-TINT IN CAN-FLD TO COM-SGV-TINT-EDT IN CAN-EDT  
           MOVE COM-SGV-TINT-EDT IN CAN-EDT TO                          
                COM-SGV-TINT-ALF IN CAN-FLD.                            
           IF CAN-SGV-GAST-LEN IN CAN-FLD = -9                          
                MOVE -1 TO CAN-SGV-GAST-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-GAST-EDT IN CAN-EDT. 
           MOVE CAN-SGV-GAST-EDT IN CAN-EDT TO                          
                CAN-SGV-GAST-ALF IN CAN-FLD.                            
           IF CAN-SGV-COMI-LEN IN CAN-FLD = -9                          
                MOVE -1 TO CAN-SGV-COMI-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE CAN-SGV-COMI IN CAN-FLD TO CAN-SGV-COMI-EDT IN CAN-EDT. 
           MOVE CAN-SGV-COMI-EDT IN CAN-EDT TO                          
                CAN-SGV-COMI-ALF IN CAN-FLD.                            
           IF CAN-SGV-TREN-LEN IN CAN-FLD = -9                          
                MOVE -1 TO CAN-SGV-TREN-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE CAN-SGV-TREN IN CAN-FLD TO CAN-SGV-TREN-EDT IN CAN-EDT. 
           MOVE CAN-SGV-TREN-EDT IN CAN-EDT TO                          
                CAN-SGV-TREN-ALF IN CAN-FLD.                            
           IF CAN-SGV-TPAG-LEN IN CAN-FLD = -9                          
                MOVE -1 TO CAN-SGV-TPAG-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
      *DAD ini  10-JUN-1992 - ALD/ 3-MAY-1990                           
      *    MOVE CAN-SGV-TPAG IN CAN-FLD TO CAN-SGV-TPAG-EDT IN CAN-EDT. 
      *    MOVE CAN-SGV-TPAG-EDT IN CAN-EDT TO                          
      *         CAN-SGV-TPAG-ALF IN CAN-FLD.                            
           IF WSS-IBLK-TPAG = 'N'                                       
           MOVE CAN-SGV-TPAG IN CAN-FLD TO CAN-SGV-TPAG-EDT1 IN CAN-EDT 
           MOVE CAN-SGV-TPAG-EDT1 IN CAN-EDT TO                         
                CAN-SGV-TPAG-ALF IN CAN-FLD                             
           ELSE                                                         
           MOVE CAN-SGV-TPAG IN CAN-FLD TO CAN-SGV-TPAG-EDT IN CAN-EDT  
           MOVE CAN-SGV-TPAG-EDT IN CAN-EDT TO                          
                CAN-SGV-TPAG-ALF IN CAN-FLD.                            
      *DAD fin  10-JUN-1992 - ALD/ 3-MAY-1990                           
           IF OPC-NUM-VCVG-LEN IN CAN-FLD = -9                          
                MOVE -1 TO OPC-NUM-VCVG-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE OPC-NUM-VCVG IN CAN-FLD TO OPC-NUM-VCVG-EDT IN CAN-EDT. 
           MOVE OPC-NUM-VCVG-EDT IN CAN-EDT TO                          
                OPC-NUM-VCVG-ALF IN CAN-FLD.                            
           IF CAN-NUM-PLCO-LEN IN CAN-FLD = -9                          
                MOVE -1 TO CAN-NUM-PLCO-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE CAN-NUM-PLCO IN CAN-FLD TO CAN-NUM-PLCO-EDT IN CAN-EDT. 
           MOVE CAN-NUM-PLCO-EDT IN CAN-EDT TO                          
                CAN-NUM-PLCO-ALF IN CAN-FLD.                            
           IF CYA-IIC-ICYA-LEN IN CAN-FLD = -9                          
                MOVE -1 TO CYA-IIC-ICYA-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE CYA-IIC-ICYA IN CAN-FLD TO CYA-IIC-ICYA-EDT IN CAN-EDT. 
           MOVE CYA-IIC-ICYA-EDT IN CAN-EDT TO                          
                CYA-IIC-ICYA-ALF IN CAN-FLD.                            
           IF OPC-VAL-SCRE-LEN IN CAN-FLD = -9                          
                MOVE -1 TO OPC-VAL-SCRE-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE OPC-VAL-SCRE IN CAN-FLD TO OPC-VAL-SCRE-EDT IN CAN-EDT. 
           MOVE OPC-VAL-SCRE-EDT IN CAN-EDT TO                          
                OPC-VAL-SCRE-ALF IN CAN-FLD.                            
           IF CAN-SGV-DIFE-LEN IN CAN-FLD = -9                          
                MOVE -1 TO CAN-SGV-DIFE-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE CAN-SGV-DIFE IN CAN-FLD TO CAN-SGV-DIFE-EDT IN CAN-EDT. 
           MOVE CAN-SGV-DIFE-EDT IN CAN-EDT TO                          
                CAN-SGV-DIFE-ALF IN CAN-FLD.                            
           IF VEN-VAL-SCAP-LEN IN CAN-FLD = -9                          
                MOVE -1 TO VEN-VAL-SCAP-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE VEN-VAL-SCAP IN CAN-FLD TO VEN-VAL-SCAP-EDT IN CAN-EDT. 
           MOVE VEN-VAL-SCAP-EDT IN CAN-EDT TO                          
                VEN-VAL-SCAP-ALF IN CAN-FLD.                            
           IF RCV-SGV-CAPI-LEN IN CAN-FLD = -9                          
                MOVE -1 TO RCV-SGV-CAPI-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE RCV-SGV-CAPI IN CAN-FLD TO RCV-SGV-CAPI-EDT IN CAN-EDT. 
           MOVE RCV-SGV-CAPI-EDT IN CAN-EDT TO                          
                RCV-SGV-CAPI-ALF IN CAN-FLD.                            
           IF VEN-VAL-SFIN-LEN IN CAN-FLD = -9                          
                MOVE -1 TO VEN-VAL-SFIN-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE VEN-VAL-SFIN IN CAN-FLD TO VEN-VAL-SFIN-EDT IN CAN-EDT. 
           MOVE VEN-VAL-SFIN-EDT IN CAN-EDT TO                          
                VEN-VAL-SFIN-ALF IN CAN-FLD.                            
           IF RCV-SGV-FINA-LEN IN CAN-FLD = -9                          
                MOVE -1 TO RCV-SGV-FINA-LEN IN CAN-FLD                  
                GO TO FIN-EDT-FLD-CAN.                                  
           MOVE RCV-SGV-FINA IN CAN-FLD TO RCV-SGV-FINA-EDT IN CAN-EDT. 
           MOVE RCV-SGV-FINA-EDT IN CAN-EDT TO                          
                RCV-SGV-FINA-ALF IN CAN-FLD.                            
           GO TO FIN-EDT-FLD-CAN.      
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE DBC-NUM-ICLI IN CAN-FLD TO
                DBC-NUM-ICLI-EDT IN CAN-EDT.
           MOVE DBC-NUM-ICLI-EDT IN CAN-EDT TO
                DBC-NUM-ICLI-ALF IN CAN-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF ROV-IIC-IOPC-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ROV-IIC-IOPC-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE ROV-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPC-EDT IN CAN-EDT.
           MOVE ROV-IIC-IOPC-EDT IN CAN-EDT TO 
                ROV-IIC-IOPC-ALF IN CAN-FLD.
           IF ICG-SGV-TINT-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ICG-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT-EDT IN CAN-EDT.
           MOVE ICG-SGV-TINT-EDT IN CAN-EDT TO 
                ICG-SGV-TINT-ALF IN CAN-FLD.
           IF FRM-SGV-TINT-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE FRM-SGV-TINT IN CAN-FLD TO FRM-SGV-TINT-EDT IN CAN-EDT.
           MOVE FRM-SGV-TINT-EDT IN CAN-EDT TO 
                FRM-SGV-TINT-ALF IN CAN-FLD.
           IF COM-SGV-TINT-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO COM-SGV-TINT-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE COM-SGV-TINT IN CAN-FLD TO COM-SGV-TINT-EDT IN CAN-EDT.
           MOVE COM-SGV-TINT-EDT IN CAN-EDT TO 
                COM-SGV-TINT-ALF IN CAN-FLD.
           IF CAN-SGV-GAST-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAN-SGV-GAST-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-GAST-EDT IN CAN-EDT.
           MOVE CAN-SGV-GAST-EDT IN CAN-EDT TO 
                CAN-SGV-GAST-ALF IN CAN-FLD.
           IF OPC-NUM-VCVG-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPC-NUM-VCVG-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE OPC-NUM-VCVG IN CAN-FLD TO OPC-NUM-VCVG-EDT IN CAN-EDT.
           MOVE OPC-NUM-VCVG-EDT IN CAN-EDT TO 
                OPC-NUM-VCVG-ALF IN CAN-FLD.
           IF CAN-NUM-PLCO-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAN-NUM-PLCO-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CAN-NUM-PLCO IN CAN-FLD TO CAN-NUM-PLCO-EDT IN CAN-EDT.
           MOVE CAN-NUM-PLCO-EDT IN CAN-EDT TO 
                CAN-NUM-PLCO-ALF IN CAN-FLD.
           IF CAN-SGV-COMI-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAN-SGV-COMI-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CAN-SGV-COMI IN CAN-FLD TO CAN-SGV-COMI-EDT IN CAN-EDT.
           MOVE CAN-SGV-COMI-EDT IN CAN-EDT TO 
                CAN-SGV-COMI-ALF IN CAN-FLD.
           IF CAN-SGV-TREN-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAN-SGV-TREN-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CAN-SGV-TREN IN CAN-FLD TO CAN-SGV-TREN-EDT IN CAN-EDT.
           MOVE CAN-SGV-TREN-EDT IN CAN-EDT TO 
                CAN-SGV-TREN-ALF IN CAN-FLD.
           IF CAN-SGV-TPAG-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAN-SGV-TPAG-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CAN-SGV-TPAG IN CAN-FLD TO CAN-SGV-TPAG-EDT IN CAN-EDT.
           MOVE CAN-SGV-TPAG-EDT IN CAN-EDT TO 
                CAN-SGV-TPAG-ALF IN CAN-FLD.
           IF VEN-NUM-IVEN-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-NUM-IVEN-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN-EDT IN CAN-EDT.
           MOVE VEN-NUM-IVEN-EDT IN CAN-EDT TO 
                VEN-NUM-IVEN-ALF IN CAN-FLD.
           IF CYA-IIC-ICYA-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CYA-IIC-ICYA-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CYA-IIC-ICYA IN CAN-FLD TO CYA-IIC-ICYA-EDT IN CAN-EDT.
           MOVE CYA-IIC-ICYA-EDT IN CAN-EDT TO 
                CYA-IIC-ICYA-ALF IN CAN-FLD.
           IF OPC-VAL-SCRE-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPC-VAL-SCRE-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE OPC-VAL-SCRE IN CAN-FLD TO OPC-VAL-SCRE-EDT IN CAN-EDT.
           MOVE OPC-VAL-SCRE-EDT IN CAN-EDT TO 
                OPC-VAL-SCRE-ALF IN CAN-FLD.
           IF CAN-SGV-DIFE-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAN-SGV-DIFE-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE CAN-SGV-DIFE IN CAN-FLD TO CAN-SGV-DIFE-EDT IN CAN-EDT.
           MOVE CAN-SGV-DIFE-EDT IN CAN-EDT TO 
                CAN-SGV-DIFE-ALF IN CAN-FLD.
           IF VEN-VAL-SCAP-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-SCAP-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE VEN-VAL-SCAP IN CAN-FLD TO VEN-VAL-SCAP-EDT IN CAN-EDT.
           MOVE VEN-VAL-SCAP-EDT IN CAN-EDT TO 
                VEN-VAL-SCAP-ALF IN CAN-FLD.
           IF RCV-SGV-CAPI-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RCV-SGV-CAPI-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE RCV-SGV-CAPI IN CAN-FLD TO RCV-SGV-CAPI-EDT IN CAN-EDT.
           MOVE RCV-SGV-CAPI-EDT IN CAN-EDT TO 
                RCV-SGV-CAPI-ALF IN CAN-FLD.
           IF VEN-VAL-SFIN-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-SFIN-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE VEN-VAL-SFIN IN CAN-FLD TO VEN-VAL-SFIN-EDT IN CAN-EDT.
           MOVE VEN-VAL-SFIN-EDT IN CAN-EDT TO 
                VEN-VAL-SFIN-ALF IN CAN-FLD.
           IF RCV-SGV-FINA-LEN IN CAN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RCV-SGV-FINA-LEN IN CAN-FLD
                GO TO FIN-EDT-FLD-CAN.
           MOVE RCV-SGV-FINA IN CAN-FLD TO RCV-SGV-FINA-EDT IN CAN-EDT.
           MOVE RCV-SGV-FINA-EDT IN CAN-EDT TO 
                RCV-SGV-FINA-ALF IN CAN-FLD.
       FIN-EDT-FLD-CAN.
           EXIT.
      *DAD ini  12-NOV-1992
       BASE-TASA-INI SECTION.
       INI-BASE-TASA-INI.
      * ALD-INI-CST**** RESTAURAR PARA PRUEBAS EN REALIA
           MOVE ZEROES                  TO ICG-SGV-TINT-ALF IN CAN-FLD.
      *     MOVE SPACES                  TO ICG-SGV-TINT-ALF IN CAN-FLD.
      ****
           MOVE SPACES                  TO FRM-IND-TIPE     IN CAN-FLD
                                           WSS-IBLK-TINT.
           MOVE FRM-GLS-IITR IN CAN-FLD TO FRM-GLS-TINT IN CAN-FLD.
       FIN-BASE-TASA-INI.
           EXIT.
      * ALD-FIN-CST**** RESTAURAR PARA PRUEBAS EN REALIA
      *DAD fin  12-NOV-1992
      *>>>>
      *<<<< EOF_IBM
       VAL-CON-ROV SECTION.
       INI-VAL-CON-ROV.
           MOVE ROV-CAI-IOPC IN CAN-FLD TO ROV-CAI-IOPC IN ROV.
           MOVE ROV-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPC IN ROV.
           MOVE SPACES                  TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROS                   TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-VAL-CON-ROV.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               GO TO FIN-VAL-CON-ROV.
           IF ROV-CAI-IOPC IN CAN-FLD NOT = ROV-CAI-IOPC IN ROV OR
              ROV-IIC-IOPC IN CAN-FLD NOT = ROV-IIC-IOPC IN ROV
               GO TO FIN-VAL-CON-ROV.

           MOVE ROV-CAI-IOPV IN ROV TO CAN-CAI-IOPC IN CAN
           MOVE ROV-IIC-IOPV IN ROV TO CAN-IIC-IOPC IN CAN
           MOVE ROV-NUM-IVCT IN ROV TO CAN-NUM-ICAN IN CAN
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM COL-FIO-CAN
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'EXIROVSINCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-ROV.

           IF CAN-CAI-IOPC IN CAN-FLD = CAN-CAI-IOPC IN CAN AND
              CAN-IIC-IOPC IN CAN-FLD = CAN-IIC-IOPC IN CAN AND
              CAN-NUM-ICAN IN CAN-FLD = CAN-NUM-ICAN IN CAN
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-VAL-CON-ROV.

      *    IF (CAN-NUM-DOUT IN CAN-FLD NOT = CAN-NUM-DOUT IN CAN) OR
      *       (CAN-NUM-MOUT IN CAN-FLD NOT = CAN-NUM-MOUT IN CAN) OR
      *       (CAN-NUM-AOUT IN CAN-FLD NOT = CAN-NUM-AOUT IN CAN) OR
      *       (CAN-NUM-SOUT IN CAN-FLD NOT = CAN-NUM-SOUT IN CAN)
      *         MOVE 'COL' TO MSG-COD-SIST
      *          MOVE 'FECFCOMDFING' TO MSG-COD-MENS
      *          PERFORM GET-MSG
      *          MOVE MSG-GLS-DESC TO FRM-MENS
      *          MOVE FRM-SUAR-MAL TO FRM-SUAR
      *          GO TO FIN-VAL-CON-ROV.

           IF (CAN-NUM-DCAN IN CAN-FLD NOT = CAN-NUM-DCAN IN CAN) OR
              (CAN-NUM-MCAN IN CAN-FLD NOT = CAN-NUM-MCAN IN CAN) OR
              (CAN-NUM-ACAN IN CAN-FLD NOT = CAN-NUM-ACAN IN CAN) OR
              (CAN-NUM-SCAN IN CAN-FLD NOT = CAN-NUM-SCAN IN CAN)
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'FECFCANDFING' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-ROV.

           IF (CAN-NUM-DEGR IN CAN-FLD NOT = CAN-NUM-DEGR IN CAN) OR
              (CAN-NUM-MEGR IN CAN-FLD NOT = CAN-NUM-MEGR IN CAN) OR
              (CAN-NUM-AEGR IN CAN-FLD NOT = CAN-NUM-AEGR IN CAN) OR
              (CAN-NUM-SEGR IN CAN-FLD NOT = CAN-NUM-SEGR IN CAN)
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'FECFCONDFING' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-ROV.

           IF CAN-COD-OFCA IN CAN-FLD NOT = CAN-COD-OFCA IN CAN
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OFICANDOFIIN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
        FIN-VAL-CON-ROV.
           EXIT.

       GET-SLD SECTION.
       INI-GET-SLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           IF SCR-MSC-ECAN = 'T' AND
              OPC-NUM-VCOR IN OPC > 1
               MOVE OPC-VAL-SCRE IN CAN-FLD TO WSS-VAL-SCAP
               ADD VEN-VAL-SFIN IN CAN-FLD OPC-VAL-SCRE IN CAN-FLD
                   GIVING WSS-VAL-SVEN
               SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM WSS-VAL-SVEN
           ELSE
               MOVE VEN-VAL-SCAP IN CAN-FLD TO WSS-VAL-SCAP
               MOVE VEN-VAL-SFIN IN CAN-FLD TO WSS-VAL-SVEN.

           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.

      *LOP-INI 20-01-2004 CREDITO SIN MORA                              
           IF SCR-MSC-FCAN = 'X' AND                                    
              SCR-MSC-ECAN = 'E'                                        
                MOVE VEN-VAL-SCAP IN CAN-FLD TO                         
                     RCV-SGV-CAPI IN CAN-FLD                            
                MOVE VEN-VAL-SFIN IN CAN-FLD TO                         
                     RCV-SGV-FINA IN CAN-FLD                            
           ELSE                                                         
      *LOP-FIN 20-01-2004 CREDITO SIN MORA                              
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
                MOVE VEN-VAL-SCAP IN CAN-FLD TO
                     RCV-SGV-CAPI IN CAN-FLD
                MOVE VEN-VAL-SFIN IN CAN-FLD TO
                     RCV-SGV-FINA IN CAN-FLD
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
               IF OPC-NUM-VCOR IN OPC = 1
                   MOVE VEN-VAL-SCAP IN CAN-FLD TO
                        RCV-SGV-CAPI IN CAN-FLD
                   MOVE VEN-VAL-SFIN IN CAN-FLD TO
                     RCV-SGV-FINA IN CAN-FLD
               ELSE
                   MOVE OPC-VAL-SCRE IN CAN-FLD TO
                        RCV-SGV-CAPI IN CAN-FLD
                   MOVE WSS-VAL-SVEN TO
                        RCV-SGV-FINA IN CAN-FLD.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'        TO TAB-COD-SIST.
           MOVE 'VLR'        TO TAB-COD-TTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-GET-SLD.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.

      *ISP SI ES MONEDA REAJUSTABLE ( CHILENA Y NO PESOS ) ENTONCES
      *    CONVIERTE A PESOS

           MOVE 1 TO SCR-SGV-VCAM.
           IF NOT ( WSS-CIC-TVAL = '0' AND
                    WSS-CIC-VCAM NOT = '0999' )
               GO TO VRF-MON-NAC.

           MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TAB-NUM-DTRN IN TAB.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TAB-NUM-MTRN IN TAB.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO TAB-NUM-STRN IN TAB.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MOVE CAM-SGV-VCAM IN CAM TO SCR-SGV-VCAM

               MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                                 GIVING WSS-VAL-SVEN ROUNDED

               MULTIPLY WSS-VAL-SCAP BY SCR-SGV-VCAM
                                 GIVING WSS-VAL-SCAP ROUNDED
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       VRF-MON-NAC.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN
      *DAD ini  22-ABR-1993
               MOVE WSS-VAL-SCAP TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SCAP.
      *DAD fin  22-ABR-1993
       FIN-GET-SLD.
           EXIT.

       ABS-TPAG SECTION.
       INI-ABS-TPAG.
           MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-SGV-TPAG.
           IF WSS-SGV-TPAG < ZEROES
               SUBTRACT WSS-SGV-TPAG FROM 0 GIVING WSS-SGV-TPAG.
       FIN-ABS-TPAG.
           EXIT.

       LEE-REG-TCAN SECTION.
       INI-LEE-REG-TCAN.
      *AFRI-INI/LOF/ALD/05-2010 ERROR CALCULO VCD
      *    IF LOC-ORI-FCOL IN LOC-VARI > ZEROES
      *        MOVE LOC-ORI-FCOL IN LOC-VARI TO OPC-FEC-FCOL.
           IF LOC-ORI-FCOL IN LOC-VARI > ZEROES
               PERFORM BUS-ANT-VCD.
      *AFRI-FIN/LOF/ALD/05-2010 ERROR CALCULO VCD

           IF VEN-NUM-IVEN IN CAN-FLD = 1
               MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DVEN IN WSS-VARI
               MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MVEN IN WSS-VARI
               MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SVEN IN WSS-VARI
               MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AVEN IN WSS-VARI
               GO TO CON-LEE-REG-TCAN.
      *
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           SUBTRACT 1 FROM VEN-NUM-IVEN IN CAN-FLD GIVING
                                           VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-AVEN IN WSS-VARI
               ELSE
                   MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AVEN IN WSS-VARI
           ELSE
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-AVEN IN WSS-VARI
               ELSE
                   MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AVEN IN WSS-VARI.
       CON-LEE-REG-TCAN.
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
            MOVE WSS-NUM-SVEN IN WSS-VARI TO LOC-CXE-SVEA.
            MOVE WSS-NUM-AVEN IN WSS-VARI TO LOC-CXE-AVEA.
            MOVE WSS-NUM-MVEN IN WSS-VARI TO LOC-CXE-MVEA.
            MOVE WSS-NUM-DVEN IN WSS-VARI TO LOC-CXE-DVEA.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
      *AFRI-INI/LOF/CHC/07-2009
           IF LOC-CXE-FVEN NOT > ZEROES
      *AFRI-INI/LOF/ALD/06-2010
               MOVE CAN-NUM-ICAN IN CAN-FLD TO LOC-NUM-ICAN IN LOC-VARI
      *AFRI-FIN/LOF/ALD/06-2010
               MOVE BDO-CAI-IOPC IN BDO-VARI TO LOC-CAI-IOPC IN LOC-VARI
               MOVE BDO-IIC-IOPC IN BDO-VARI TO LOC-IIC-IOPC IN LOC-VARI
               PERFORM BUS-CXE-FGF
               IF LOC-CXE-FVEN NOT > ZEROES
                   MOVE WSS-NUM-SVEN IN WSS-VARI TO LOC-CXE-SVEN
                   MOVE WSS-NUM-AVEN IN WSS-VARI TO LOC-CXE-AVEN
                   MOVE WSS-NUM-MVEN IN WSS-VARI TO LOC-CXE-MVEN
      *AFRI-INI/LOF/ALD/05-2010 ERROR CALCULO VCD
      *            MOVE WSS-NUM-DVEN IN WSS-VARI TO LOC-CXE-DVEN.
                   MOVE WSS-NUM-DVEN IN WSS-VARI TO LOC-CXE-DVEN
               ELSE
               IF LOC-CXE-FVEN < WSS-CMP-FVEN IN WSS-VARI
      *AFRI-INI/LOF/ALD/07-2010 ERROR CALCULO COMISION
                   PERFORM CAL-DIF-DIA-CXE
                   IF FEC-NDIA > 30
      *AFRI-FIN/LOF/ALD/07-2010 ERROR CALCULO COMISION
                   MOVE WSS-NUM-SVEN IN WSS-VARI TO LOC-CXE-SVEN
                   MOVE WSS-NUM-AVEN IN WSS-VARI TO LOC-CXE-AVEN
                   MOVE WSS-NUM-MVEN IN WSS-VARI TO LOC-CXE-MVEN
                   MOVE WSS-NUM-DVEN IN WSS-VARI TO LOC-CXE-DVEN.
      *AFRI-INI/LOF/ALD/05-2010 ERROR CALCULO VCD
      *AFRI-FIN/LOF/CHC/07-2009
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
           ELSE
               PERFORM COL-FIO-VEN.
      *AFRI-INI/LOF/ALD/07-2010 CONSIDERAR CIE
      *    COMPUTE LOC-VAL-SALD = LOC-VAL-SALD + VEN-VAL-CAPI IN VEN -
      *                                          VEN-VAL-SCAP IN VEN.
      *AFRI-FIN/LOF/ALD/07-2010 CONSIDERAR CIE
           MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN     TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
      *AFRI-INI                                                         
           MOVE SPACES TO WSS-CMSG.                                     
           IF DLC-IND-SCTB IN DLC = 'CAS'                               
               MOVE OPC-COD-OFOC IN OPC TO OFI-COD-OFIC IN OFI          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-OFI                                      
               IF FIO-STAT-OKS AND                                      
                  OFI-COD-MODL IN OFI = '8'                             
                   MOVE 'OFICONO' TO  WSS-CMSG.                         
                                                                        
      *AFRI-FIN                                                         

           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           PERFORM GET-CUR-ITR.
           IF PGM-STAT-ITR-OKS
               PERFORM GET-NXT-ITR.
       FIN-LEE-REG-TCAN.
           EXIT.

       PRO-TCAN-CTE SECTION.                                            
       INI-PRO-TCAN-CTE.                                                
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
           MOVE ZEROES       TO SCR-SGV-CCAE.
           IF SCR-MSC-TCAN = WSS-GLS-ICCC AND                           
              SCR-MSC-FCAN = WSS-GLS-ITTT AND                           
              SCR-MSC-ECAN = WSS-GLS-IEEE                               
               PERFORM LEE-CXE-CAC.
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.         
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.         
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.         
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.         
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.         
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.         
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.         
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.         
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.         
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.         
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.         
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.         
      *AFRI-INI                                                         
           IF WSS-CMSG = 'OFICONO'                                      
                  MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI  
                  MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI  
                  MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI  
                  MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI  
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal. 
                  MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN       
                  MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN       
                  MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN       
                  MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN       
                  PERFORM PRO-MORA-CTE                                  
                  MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN  
                  MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN  
                  MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN  
                  MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN  
                  GO TO FIN-PRO-TCAN-CTE.                               
      *AFRI-FIN                                                         
      * RBG/INI/12-AUG-1996                                             
           IF WSS-OPEC = 'D'                                            
              PERFORM CAL-NUM-DHBL                                      
              IF CAN-FEC-FCAN IN CAN > WSS-FEC-FTOP IN WSS-VARI         
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
                  MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI  
                  MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI  
                  MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI  
                  MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI  
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal. 
                  MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN       
                  MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN       
                  MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN       
                  MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN       
                  PERFORM PRO-MORA-CTE                                  
                  MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN  
                  MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN  
                  MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN  
                  MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN  
                  GO TO FIN-PRO-TCAN-CTE                                
              ELSE                                                      
                 IF CAN-FEC-FCAN IN CAN NOT > WSS-FEC-FTOP IN WSS-VARI  
      *AFRI-INI/LOF/CHC/07-2009
                    MOVE ZEROES TO CAN-SGV-COMI IN CAN-FLD
      *AFRI-FIN/LOF/CHC/07-2009
                    PERFORM PRO-DESC-CTE                                
                    GO TO FIN-PRO-TCAN-CTE.                             
      * RBG/FIN/12-AUG-1996                                             
      *INI-AFRI/07-2006
           IF (CAN-FEC-FCAN IN CAN < VEN-FEC-FVEN IN VEN AND
            OPC-NUM-VCOR IN OPC > 1 AND
            CAN-MSC-CANC IN CAN-FLD = 'CTE' AND
            ICG-SGV-TINT IN CAN-FLD NOT = ZEROES)
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'TINTCAN=0'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-TCAN-CTE
           ELSE
      *FIN-AFRI/07-2006
      * RBG/INI/26-AUG-1996                                             
           IF OPC-NUM-VCOR IN OPC = 1                                   
               IF CAN-FEC-FCAN IN CAN > VEN-FEC-FIMV IN VEN             
      * RBG/INI/7-AUG-1996                                              
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
                  MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI  
                  MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI  
                  MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI  
                  MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI  
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal. 
                  MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN       
                  MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN       
                  MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN       
                  MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN       
      * RBG/FIN/7-AUG-1996                                              
                  PERFORM PRO-MORA-CTE                                  
      * RBG/INI/7-AUG-1996                                              
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
                  MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN  
                  MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN  
                  MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN  
                  MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN  
      * RBG/FIN/7-AUG-1996                                              
                  GO TO FIN-PRO-TCAN-CTE                                
               ELSE                                                     
               IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN         
      *AFRI-INI/LOF/CHC/07-2009
                   MOVE ZEROES TO CAN-SGV-COMI IN CAN-FLD
      *AFRI-FIN/LOF/CHC/07-2009
                   PERFORM PRO-DESC-CTE                                 
                   GO TO FIN-PRO-TCAN-CTE.                              
      * RBG/FIN/26-AUG-1996                                             
           IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN                 
               PERFORM PRO-MORA-CTE                                     
           ELSE                                                         
           IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FVEN IN VEN             
      *AFRI-INI/LOF/CHC/07-2009
               MOVE ZEROES TO CAN-SGV-COMI IN CAN-FLD
      *AFRI-FIN/LOF/CHC/07-2009
               PERFORM PRO-DESC-CTE.                                    
       FIN-PRO-TCAN-CTE.                                                
           EXIT.                                                        
                                                                        
       PRO-MORA-CTE SECTION.                                            
       INI-PRO-MORA-CTE.                                                
           MOVE CCO-COD-EVEN-VEN (1:3)  TO CCO-COD-EVEN.                
           IF VEN-IND-CALC IN VEN = 'N'                                 
               MOVE 'VENCALCMORAN' TO MSG-COD-MENS                      
               MOVE VEN-NUM-IVEN IN VEN TO FRM-MEN2                     
               MOVE FRM-SUAR-MAL        TO FRM-SUAR                     
               GO TO FIN-PRO-MORA-CTE.                                  
           MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SMON.                    
           PERFORM PRO-FUPM.                                            
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.                    
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.                    
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.                    
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.                    
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-DIF-DIA  TO FEC-CMND.                               
      *    PERFORM PRO-FEC.                                             
           PERFORM CAL-FEC.                                             
           IF NOT FEC-STAT-OKS                                          
               MOVE ZEROES TO FEC-NDIA.                                 
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.                 
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.                
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'BCI    DPTMC' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB                                          
           IF FIO-STAT-OKS AND                                          
              TAB-IND-VIGE IN TAB = 'S'                                 
      *ALD-BCI-INI/22.04.1999                                           
      *        PERFORM VAL-TMAX-CONV                                    
               PERFORM PRO-MORA-TXC                                     
      *ALD-BCI-FIN/22.04.1999                                           
           ELSE                                                         
           IF CAN-FEC-FCAN IN CAN     > VEN-FEC-FVEN IN VEN AND         
              CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN             
               PERFORM VAL-TMAX-CONV                                    
           ELSE                                                         
               PERFORM PRO-MORA-TMC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL                                   
               GO TO FIN-PRO-MORA-CTE.                                  
           IF WSS-IBLK-TINT = 'S'                                       
               GO TO CON-PRO-CTE-TIPE.                                  
      *JSS 19-AUG-1991 12:44:52                                         
           IF ICG-SGV-TINT IN CAN-FLD NOT > ZEROES                      
               MOVE 0 TO INT-TIPE                                       
               GO TO CON-PRO-CTE-TIPE.                                  
       CON-PRO-MORA-CTE.                                                
           MOVE WSS-DIAM                TO INT-SEPA INT-SEPD.           
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.                    
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)                            
           MOVE SPACES TO INT-CVTI.                                     
      *                                                                 
      *DAD ini  27-NOV-1991   (Memo.15-11-91 pto.3.2)                   
      *    Cambio  OPC-NUM-xCOL IN OPC  por  WSS-NUM-xUPM  --->  INT-xDM
           MOVE WSS-NUM-DUPM            TO INT-DDMA.                    
           MOVE WSS-NUM-MUPM            TO INT-MDMA.                    
           MOVE WSS-NUM-SUPM            TO INT-SDMA.                    
           MOVE WSS-NUM-AUPM            TO INT-ADMA.                    
      *DAD fin  27-NOV-1991                                             
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.                    
           PERFORM OBT-VTIN.                                            
           IF INT-CMSG > SPACES                                         
               MOVE INT-CMSG            TO MSG-COD-MENS                 
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2                     
               MOVE FRM-SUAR-MAL        TO FRM-SUAR                     
               GO TO FIN-PRO-MORA-CTE.                                  
       CON-PRO-CTE-TIPE.                                                
           MOVE WSS-VAL-SMON TO WSS-VAL-SCRE.                           
           MULTIPLY INT-TIPE BY WSS-VAL-SCRE                            
      *DAD ini  19-FEB-1993   (Memo.16-12-92)                           
      *                  GIVING WSS-VAL-SVEN ROUNDED.                   
                         GIVING WSS-VAL-SVEN.                           
      *DAD fin  19-FEB-1993                                             
      *DPM ini  13-JAN-1997                                             
           COMPUTE SCR-SGV-INMO = VEN-VAL-SFIN IN VEN -                 
                                  VEN-VAL-SCAP IN VEN.                  
           MOVE WSS-VAL-SVEN TO SCR-SGV-IMMO.                           
      *DPM fin  13-JAN-1997                                             
      *RJZ INI  09-JUNIO-1995                                           
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM GIVING SCR-SGV-INTM.   
      *RJZ FIN  09-JUNIO-1995                                           
           ADD WSS-VAL-SCRE TO WSS-VAL-SVEN.                            
      *                                                                 
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.                            
           IF WSS-OPEC NOT = 'B'                                        
               SUBTRACT VEN-VAL-SCAP IN VEN FROM SCR-SGV-IPFC.          
                                                                        
      *RJZ INI  09-JUNIO-1995                                           
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INT.    
           SUBTRACT SCR-SGV-INTM FROM SCR-SGV-INT GIVING SCR-SGV-INTN.  
      *DPM ini  26-MAR-1997                                             
           IF SCR-SGV-INTN > -1 AND                                     
              SCR-SGV-INTN < 1                                          
              MOVE ZEROES TO SCR-SGV-INTN.                              
      *DPM fin  26-MAR-1997                                             
                                                                        
           IF WSS-CIC-TVAL = '0'                                        
              MOVE SCR-SGV-INTM TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTM             
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN.            
      *RJZ FIN  09-JUNIO-1995                                           
      *                                                                 
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                           
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                        
                             GIVING WSS-VAL-SVEN ROUNDED.               
      *HZF-INI 13-10-2000                                               
           PERFORM PRO-COM-IMP-CTE.                                     
      *AFRI-INI/LOF/CHC/07-2009
           PERFORM SET-VAR-LOC.
           PERFORM LOC-COM-FGP.
           IF LOC-GLS-MENS IN LOC-VARI = SPACES AND
            LOC-COM-FGPE IN LOC-VARI > ZEROES
               MOVE SPACES TO PCP-CMSG
               ADD LOC-COM-FGPE IN LOC-VARI TO SCR-SGV-CFGP
               ADD LOC-VAL-MCAN IN LOC-VARI TO SCR-SGV-CMFG
      *AFRI-INI/LOF/ALD/05-2010 POR PTT
      *        ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO.
               ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO
               IF CAN-MSC-CANC IN CAN-FLD = 'PTT' AND PCP-SUVP > ZEROES
                  ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUVP
                   SUBTRACT PCP-SUVP                FROM
                                 CAN-SGV-TPAG IN CAN-FLD.
      *AFRI-FIN/LOF/ALD/05-2010 POR PTT
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
           ADD SCR-SGV-CCAE     TO  PCP-SUCO.
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
      *AFRI-FIN/LOF/CHC/07-2009
           MOVE PCP-SUCO TO CAN-SGV-COMI IN CAN-FLD.                    
           ADD  PCP-SUIM TO CAN-SGV-COMI IN CAN-FLD.                    
           ADD PCP-SUVP TO CAN-SGV-TPAG IN CAN-FLD.                     
           IF WSS-OPEC = 'B' AND PCP-SUCO > ZEROES                      
              PERFORM LEE-VSN-BEX-MORA                                  
              IF ( OPC-FEC-FCOL IN OPC > TAB-GLS-DCOR IN TAB (1:8)      
              AND  TAB-IND-VIGE IN TAB = 'S' )                          
              COMPUTE WSS-VAL-SMON ROUNDED = WSS-VAL-SMON  +            
             (( PCP-SUCO + PCP-SUIM ) / SCR-SGV-VCAM ) * INT-TIPE       
                COMPUTE WSS-VAL-SVEN ROUNDED = WSS-VAL-SVEN  +          
              ( PCP-SUCO + PCP-SUIM ) * INT-TIPE                        
              COMPUTE SCR-SGV-INTM ROUNDED = SCR-SGV-INTM            +  
                                             ( PCP-SUCO + PCP-SUIM ) *  
                                             INT-TIPE                   
              MOVE SCR-SGV-INTM TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTM.            
      *HZF-FIN 13-10-2000                                               
      *AFRI-INI                                                         
           PERFORM DELETE-CXE-CAN-IPEN                                  
           IF WSS-CMSG = 'OFICONO'                                      
                IF DLC-VAL-IPEN IN DLC > ZEROES                         
                    MOVE LOW-VALUES TO CXE                              
                    ADD DLC-VAL-IPEN IN DLC TO WSS-VAL-SVEN             
                    MOVE DLC-VAL-IPEN IN DLC TO CXE-SGV-MCAL IN CXE     
                    PERFORM GRABA-CXE-CAN-IPEN.                         
      *AFRI-FIN                                                         
           ADD PCP-SUCO TO WSS-VAL-SVEN                                 
           ADD PCP-SUIM TO WSS-VAL-SVEN                                 
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
           COMPUTE GCN-TPAG = WSS-VAL-SVEN - SCR-SGV-INTM
           PERFORM PRO-COM-NOR.
           IF GCN-CMSG = SPACES
               ADD GCN-CONO TO CAN-SGV-COMI IN CAN-FLD
               ADD  GCN-CONO TO SCR-SGV-CONO
               ADD GCN-CONO TO WSS-VAL-SVEN.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
           COMPUTE WSS-VAL-SMON ROUNDED = WSS-VAL-SVEN / SCR-SGV-VCAM.  
           IF WSS-CIC-TVAL = '0'                                        
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.           
       FIN-PRO-MORA-CTE.                                                
           EXIT.                                                        
       LEE-VSN-BEX-MORA SECTION.                                        
       INI-LEE-VSN-BEX-MORA.                                            
           MOVE 'COL'       TO FIO-SIST.                                
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           MOVE 'VSNBCIBEXMORA   ' TO TAB-COD-TABL IN TAB.              
           PERFORM GNS-FIO-TAB.                                         
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' AND      
                    TAB-GLS-DCOR IN TAB (1:8) IS NUMERIC )              
               MOVE SPACES  TO TAB                                      
               MOVE ZEROES  TO TAB-GLS-DCOR IN TAB.                     
       FIN-LEE-VSN-BEX-MORA.                                            
           EXIT.                                                        
       PRO-MORA-TMC SECTION.
       INI-PRO-MORA-TMC.
           PERFORM BUS-CIC-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-TMC.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TMC-NUM-DTMC IN TMC.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TMC-NUM-MTMC IN TMC.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TMC-NUM-ATMC IN TMC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TMC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'TASDNEXFCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           IF WSS-CIC-VCAM = '0998'
               MOVE TMC-SGV-UFAC IN TMC TO WSS-SGV-CANT
           ELSE
           IF WSS-PLZO-B90
               MOVE TMC-SGV-89AC IN TMC TO WSS-SGV-CANT
           ELSE
               MOVE TMC-SGV-PEAC IN TMC TO WSS-SGV-CANT.

      *     MOVE VEN-NUM-DVEN IN CAN-FLD TO TMC-NUM-DTMC IN TMC.
      *     MOVE VEN-NUM-MVEN IN CAN-FLD TO TMC-NUM-MTMC IN TMC.
      *     MOVE VEN-NUM-AVEN IN CAN-FLD TO TMC-NUM-ATMC IN TMC.
           MOVE WSS-NUM-DUPM IN WSS-VARI TO TMC-NUM-DTMC IN TMC.
           MOVE WSS-NUM-MUPM IN WSS-VARI TO TMC-NUM-MTMC IN TMC.
           MOVE WSS-NUM-AUPM IN WSS-VARI TO TMC-NUM-ATMC IN TMC.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TMC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'TASDNEXFVEN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           IF WSS-CIC-VCAM = '0998'
               MOVE TMC-SGV-UFAC IN TMC TO WSS-SGV-VENT
           ELSE
           IF WSS-PLZO-B90
               MOVE TMC-SGV-89AC IN TMC TO WSS-SGV-VENT
           ELSE
               MOVE TMC-SGV-PEAC IN TMC TO WSS-SGV-VENT.
           SUBTRACT WSS-SGV-VENT FROM WSS-SGV-CANT GIVING
                    WSS-SGV-MTMC.
           DIVIDE WSS-SGV-MTMC BY 36000 GIVING
                  WSS-INT-TIPE ROUNDED.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1'          TO FRM-IND-TIPE IN CAN-FLD
               MOVE WSS-INT-TIPE TO INT-TIPE
               MULTIPLY WSS-INT-TIPE BY 100 GIVING ICG-SGV-TINT
                                             IN CAN-FLD
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               PERFORM GLS-INT-TIPE
               GO TO FIN-PRO-MORA-TMC.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               MOVE 'S' TO WSS-IBLK-TINT
               PERFORM GLS-INT-TIPE
               GO TO CMP-INT-TIPE.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
      *DAD ini  27-NOV-1991   (Memo.15-11-91 pto.3.2)
      *    Cambio  OPC-NUM-xCOL IN OPC  x  WSS-NUM-xUPM  --->  INT-xDMA
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
      *DAD fin  27-NOV-1991
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
       CMP-INT-TIPE.
           IF INT-TIPE > WSS-INT-TIPE
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'CANTIPE>TMC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR.
       FIN-PRO-MORA-TMC.
           EXIT.

       PRO-DESC-CTE SECTION.                                            
       INI-PRO-DESC-CTE.                                                
           MOVE CCO-COD-EVEN-ANT (1:3) TO CCO-COD-EVEN.                 
           IF OPC-NUM-VCOR IN OPC = 1                                   
               PERFORM PRO-DESC-CTE-1VCTO                               
               GO TO FIN-PRO-DESC-CTE.                                  
           PERFORM CAL-TFPR-CAN.                                        
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-CTE.                                  
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES                          
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)                        
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES   
                  NEXT SENTENCE                                         
              ELSE                                                      
      *                                                                 
               MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SVEN                 
               GO TO NXT-PRO-DESC-CTE.                                  
      *AFRI-INI LEY 19951                                               
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.                
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'NUEVLEY19951' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB                                          
           IF FIO-STAT-OKS AND                                          
              TAB-IND-VIGE IN TAB = 'S'                                 
               IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD     
                   PERFORM PRO-DESC-LEY                                 
                   IF INT-CMSG > SPACES                                 
                       GO TO FIN-PRO-DESC-CTE                           
                   ELSE                                                 
                       GO TO CON-NUEVA-LEY-CTE.                         
      *AFRI-FIN LEY 19951                                               
           MOVE VEN-VAL-SFIN IN VEN     TO WSS-VAL-SMON.                
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1.                    
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1.                    
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1.                    
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1.                    
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.                    
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.                    
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.                    
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.                    
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.                    
           PERFORM CAL-TIPE-DESC.                                       
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-CTE.                                  
           ADD 1 TO INT-TIPE.                                           
           DIVIDE WSS-VAL-SMON BY INT-TIPE                              
      *DAD ini  19-FEB-1993   (Memo.16-12-92)                           
      *                    GIVING WSS-VAL-SVEN ROUNDED.                 
                           GIVING WSS-VAL-SVEN.                         
      *DAD fin  19-FEB-1993                                             
      *DAD ini  22-SEP-1993   (Memo.02-07-92)                           
           IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD AND     
      *DAD ini  07-JUL-1994   (Memo.07-07-94 Pto.2)                     
              OPC-NUM-VCVG IN OPC = 1                           AND     
              WSS-CMP-FCAN IN WSS-VARI NOT > DLC-FEC-FDEV IN DLC        
               IF WSS-OPEC = 'B'                                        
                   MOVE ZEROES TO VEN-VAL-SCAP IN VEN                   
                                  WSS-VAL-SVEN IN WSS-VARI              
               ELSE                                                     
                   MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SVEN.            
      *DAD fin  07-JUL-1994 / 22-SEP-1993                               
       NXT-PRO-DESC-CTE.                                                
      *                                                                 
      *DPM ini  14-OCT-1996                                             
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.                           
      *DPM fin  14-OCT-1996                                             
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.                            
           IF WSS-OPEC NOT = 'B'                                        
               SUBTRACT VEN-VAL-SCAP IN VEN FROM SCR-SGV-IPFC.          
      *AFRI-INI LEY 19951                                               
       CON-NUEVA-LEY-CTE.                                               
      *AFRI-FIN LEY 19951                                               
                                                                        
      *RJZ INI  09-JUNIO-1995                                           
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.   
      *DPM ini  26-MAR-1997                                             
           IF SCR-SGV-INTN > -1 AND                                     
              SCR-SGV-INTN < 1                                          
              MOVE ZEROES TO SCR-SGV-INTN.                              
      *DPM fin  26-MAR-1997                                             
                                                                        
           IF WSS-CIC-TVAL = '0'                                        
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN             
              MOVE ZEROES TO SCR-SGV-INTM                               
              MOVE ZEROES TO SCR-SGV-INT.                               
      *RJZ FIN  09-JUNIO-1995                                           
      *                                                                 
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                           
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                        
                             GIVING WSS-VAL-SVEN ROUNDED.               
      *HZF-INI 13-10-2000                                               
      *     IF CAN-SGV-COMI IN CAN-FLD NOT > ZEROES OR                  
      *      ( CAN-MSC-CANC IN CAN-FLD = 'PTT'  )                       
              PERFORM  PRO-COM-IMP-CTE                                  
              SUBTRACT CAN-SGV-COMI IN CAN-FLD FROM WSS-VAL-SVEN
      *AFRI-INI/LOF/CHC/07-2009
              PERFORM SET-VAR-LOC
              PERFORM LOC-COM-FGP
              IF LOC-GLS-MENS IN LOC-VARI = SPACES AND
               LOC-COM-FGPE IN LOC-VARI > ZEROES
                  MOVE SPACES TO PCP-CMSG
                  MOVE LOC-COM-FGPE IN LOC-VARI TO SCR-SGV-CFGP
                  MOVE LOC-VAL-MCAN IN LOC-VARI TO SCR-SGV-CMFG
      *AFRI-INI/LOF/ALD/05-2010 POR PTT
      *           ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO.
                  ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO
                  IF CAN-MSC-CANC IN CAN-FLD = 'PTT' AND
                   PCP-SUVP > ZEROES
                      ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUVP
                      SUBTRACT PCP-SUVP                FROM
                                 CAN-SGV-TPAG IN CAN-FLD.
      *AFRI-FIN/LOF/ALD/05-2010 POR PTT
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
           ADD SCR-SGV-CCAE     TO  PCP-SUCO.
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
      *AFRI-FIN/LOF/CHC/07-2009
              MOVE  PCP-SUCO TO CAN-SGV-COMI IN CAN-FLD                 
              ADD   PCP-SUIM TO CAN-SGV-COMI IN CAN-FLD                 
              ADD PCP-SUVP TO CAN-SGV-TPAG IN CAN-FLD                   
      *HZF-FIN 13-10-2000                                               
              ADD PCP-SUCO TO WSS-VAL-SVEN                              
              ADD PCP-SUIM TO WSS-VAL-SVEN                              
      *    ELSE                                                         
      *       MOVE ZEROES TO PCP-SUCO PCP-SUIM.                         
           COMPUTE WSS-VAL-SMON ROUNDED = WSS-VAL-SVEN / SCR-SGV-VCAM.  
           IF WSS-CIC-TVAL = '0'                                        
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.           

      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/04-2012
           IF WSS-CXE-ICAE IN CAE-VARI = 'S'
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
      *        MOVE WSS-CAE-MCAL IN CAE-VARI TO WSS-VAL-SVEN.
      *AFRI-INI 29-AGO-2016 COMISION CAE003
      *        MOVE WSS-CAE-MCAL IN CAE-VARI TO WSS-VAL-SVEN
      *        ADD SCR-SGV-CCAE     TO  WSS-VAL-SVEN.
               MOVE WSS-CAE-MCAL IN CAE-VARI TO WSS-VAL-SVEN.
      *AFRI-FIN 29-AGO-2016 COMISION CAE003
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/04-2012

       FIN-PRO-DESC-CTE.                                                
           EXIT.                                                        
                                                                        
       PRO-TCAN-CTT SECTION.                                            
       INI-PRO-TCAN-CTT.                                                
           IF OPC-NUM-VCOR IN OPC = 1 AND                               
              CAN-MSC-CANC IN CAN-FLD = 'KTT'                           
              MOVE FRM-SUAR-MAL       TO FRM-SUAR                       
              MOVE 'CANCMDNOPER1'     TO MSG-COD-MENS                   
              MOVE 'COL' TO MSG-COD-SIST                                
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              GO TO FIN-PRO-TCAN-CTT.                                   
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.         
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.         
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.         
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.         
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.         
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.         
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.         
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.         
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.         
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.         
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.         
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.         
                                                                        
      * RBG/INI/26-AUG-1996                                             
           IF WSS-OPEC = 'D'                                            
              PERFORM CAL-NUM-DHBL                                      
              IF CAN-FEC-FCAN IN CAN > WSS-FEC-FTOP IN WSS-VARI         
                  MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI  
                  MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI  
                  MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI  
                  MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI  
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal. 
                  MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN       
                  MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN       
                  MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN       
                  MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN       
                  PERFORM PRO-MORA-CTT                                  
                  MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN  
                  MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN  
                  MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN  
                  MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN  
                  GO TO FIN-PRO-TCAN-CTT                                
              ELSE                                                      
                 IF CAN-FEC-FCAN IN CAN NOT > WSS-FEC-FTOP IN WSS-VARI  
                    PERFORM PRO-DESC-CTT                                
                    GO TO FIN-PRO-TCAN-CTT.                             
           IF OPC-NUM-VCOR IN OPC = 1                                   
      * RBG/INI/7-AUG-1996                                              
               IF CAN-FEC-FCAN IN CAN > VEN-FEC-FIMV IN VEN             
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
                  MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI  
                  MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI  
                  MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI  
                  MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI  
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal. 
                  MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN       
                  MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN       
                  MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN       
                  MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN       
      * RBG/FIN/7-AUG-1996                                              
                  PERFORM PRO-MORA-CTT                                  
      * RBG/INI/7-AUG-1996                                              
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
                  MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN  
                  MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN  
                  MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN  
                  MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN  
      * RBG/FIN/7-AUG-1996                                              
                  GO TO FIN-PRO-TCAN-CTT                                
               ELSE                                                     
               IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN         
                   PERFORM PRO-DESC-CTT                                 
                   GO TO FIN-PRO-TCAN-CTT.                              
      * RBG/FIN/26-AUG-1996                                             
           IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN                 
               PERFORM PRO-MORA-CTT                                     
           ELSE                                                         
           IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FVEN IN VEN             
               PERFORM PRO-DESC-CTT.                                    
           IF OPC-NUM-VCOR IN OPC > 1 AND                               
              CAN-MSC-CANC IN CAN-FLD = 'KTT'                           
              IF  CAN-SGV-TREN IN CAN-FLD NOT > ZEROES AND              
                  CAN-SGV-TPAG IN CAN-FLD NOT > CAN-SGV-COMI IN CAN-FLD 
                  MOVE FRM-SUAR-MAL       TO FRM-SUAR                   
                  MOVE 'CANKTTSINCAP'     TO MSG-COD-MENS               
                  MOVE 'COL' TO MSG-COD-SIST                            
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  GO TO FIN-PRO-TCAN-CTT                                
              ELSE                                                      
                 IF CAN-SGV-TPAG IN CAN-FLD > CAN-SGV-COMI IN CAN-FLD   
                    IF CAN-SGV-TPAG IN CAN-FLD NOT >                    
                      ( CAN-SGV-COMI IN CAN-FLD  + SCR-SGV-INTN )       
                      MOVE FRM-SUAR-MAL       TO FRM-SUAR               
                      MOVE 'CANKTTSINCAP'     TO MSG-COD-MENS           
                      MOVE 'COL' TO MSG-COD-SIST                        
                      PERFORM GET-MSG                                   
                      MOVE MSG-GLS-DESC TO FRM-MENS                     
                      GO TO FIN-PRO-TCAN-CTT                            
                    END-IF                                              
                 ELSE                                                   
                    IF ( WSS-VAL-SVEN - CAN-SGV-TREN IN CAN-FLD ) NOT > 
                       ( CAN-SGV-COMI IN CAN-FLD  + SCR-SGV-INTN )      
                         MOVE FRM-SUAR-MAL       TO FRM-SUAR            
                         MOVE 'CANKTTSINCAP'     TO MSG-COD-MENS        
                         MOVE 'COL' TO MSG-COD-SIST                     
                         PERFORM GET-MSG                                
                         MOVE MSG-GLS-DESC TO FRM-MENS                  
                         GO TO FIN-PRO-TCAN-CTT                         
                    END-IF                                              
                 END-IF                                                 
              END-IF                                                    
           END-IF.                                                      
           IF OPC-NUM-VCOR IN OPC > 1 AND                               
              CAN-MSC-CANC IN CAN-FLD = 'PTT'                           
              IF  CAN-SGV-TREN IN CAN-FLD NOT > ZEROES AND              
                  CAN-SGV-TPAG IN CAN-FLD NOT > CAN-SGV-COMI IN CAN-FLD 
                  GO TO FIN-PRO-TCAN-CTT                                
              ELSE                                                      
                IF CAN-SGV-TPAG IN CAN-FLD > CAN-SGV-COMI IN CAN-FLD    
                  IF CAN-SGV-TPAG IN CAN-FLD  >                         
                     ( CAN-SGV-COMI IN CAN-FLD  + SCR-SGV-INTN )        
                       MOVE FRM-SUAR-MAL       TO FRM-SUAR              
                       MOVE 'CANPTTCONCAP'     TO MSG-COD-MENS          
                       MOVE 'COL' TO MSG-COD-SIST                       
                       PERFORM GET-MSG                                  
                       MOVE MSG-GLS-DESC TO FRM-MENS                    
                       GO TO FIN-PRO-TCAN-CTT                           
                  END-IF                                                
                ELSE                                                    
                  IF ( WSS-VAL-SVEN - CAN-SGV-TREN IN CAN-FLD ) >       
                     ( CAN-SGV-COMI IN CAN-FLD  + SCR-SGV-INTN )        
                      MOVE FRM-SUAR-MAL       TO FRM-SUAR               
                      MOVE 'CANPTTCONCAP'     TO MSG-COD-MENS           
                      MOVE 'COL' TO MSG-COD-SIST                        
                      PERFORM GET-MSG                                   
                      MOVE MSG-GLS-DESC TO FRM-MENS                     
                      GO TO FIN-PRO-TCAN-CTT                            
                  END-IF                                                
                END-IF                                                  
              END-IF                                                    
           END-IF.                                                      
       FIN-PRO-TCAN-CTT.                                                
           EXIT.                                                        

       PRO-MORA-CTT SECTION.                                            
       INI-MORA-CTT.                                                    
      *LOP-INI 13-08-2003                                               
           IF WSS-OPEC = 'B'                                            
              IF SCR-MSC-TCAN = 'R' AND                                 
                 SCR-MSC-FCAN = 'T' AND                                 
                 SCR-MSC-ECAN = 'T' AND                                 
                 CAN-MSC-CANC IN CAN-FLD = 'PTT'                        
               MOVE 'FCAN PTT>FVEN'     TO MSG-COD-MENS                 
               MOVE FRM-SUAR-MAL        TO FRM-SUAR                     
               GO TO FIN-PRO-MORA-CTT.                                  
      *LOP-FIN 13-08-2003                                               
                                                                        
           MOVE CCO-COD-EVEN-VEN (1:3) TO CCO-COD-EVEN.                 
           PERFORM BUS-SIG-VEN.                                         
           IF FRM-SUAR = FRM-SUAR-MAL                                   
               GO TO FIN-PRO-MORA-CTT.                                  
           PERFORM LEE-REG-TCAN.                                        
      * RBG/INI/7-NOV-1996 Cuando es 1 vencimiento muevo la fecha.      
           IF OPC-NUM-VCOR IN OPC = 1                                   
               MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN          
               MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN          
               MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN          
               MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN.         
      * RBG/FIN/7-NOV-1996                                              
           MOVE ZEROES TO WSS-TOT-SVEN IN WSS-VARI.                     
           MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD.                      
      *RJZ INI 09-JUNIO-1995                                            
      *DPM ini  14-OCT-1996                                             
      *     MOVE ZEROES TO SCR-AUX-INTM.                                
      *     MOVE ZEROES TO SCR-AUX-INTN.                                
           MOVE ZEROES TO WSS-AUX-INTM.                                 
           MOVE ZEROES TO WSS-AUX-INTN.                                 
           MOVE ZEROES TO WSS-AUX-INMO.                                 
           MOVE ZEROES TO WSS-AUX-IMMO.                                 
      *DPM fin  14-OCT-1996                                             
           MOVE ZEROES TO SCR-SGV-INTM.                                 
           MOVE ZEROES TO SCR-SGV-INTN.                                 
      *RJZ FIN 09-JUNIO-1995                                            
      *DPM ini  10-OCT-1996                                             
           MOVE ZEROES TO SCR-SGV-INMO                                  
                          SCR-SGV-IMMO.                                 
           MOVE ZEROES TO WSS-VAL-SMO5.                                 
      *DPM fin  10-OCT-1996                                             
       LUP-PRO-MORA-CTT.                                                
      *RJZ INI 14-JUNIO-1995                                            
           MOVE ZEROES TO SCR-SGV-IPFC.                                 
      *RJZ FIN 14-JUNIO-1995                                            
           PERFORM PRO-MORA-CTE.                                        
           IF FRM-SUAR = FRM-SUAR-MAL                                   
              GO TO FIN-PRO-MORA-CTT                                    
           END-IF.                                                      
      *AFRI-INI/LOF/CHC/07-2009
           MOVE VEN-FEC-FVEN IN VEN TO LOC-CXE-FVEN IN LOC-VARI.
      *AFRI-FIN/LOF/CHC/07-2009
      *RJZ INI 09-JUNIO-1995                                            
      *DPM ini  14-OCT-1996                                             
      *     ADD SCR-SGV-INTN TO SCR-AUX-INTN                            
      *     ADD SCR-SGV-INTM TO SCR-AUX-INTM                            
           ADD CAN-SGV-COMI IN CAN-FLD TO WSS-VAL-SMO5.                 
           ADD SCR-SGV-INTN TO WSS-AUX-INTN.                            
           ADD SCR-SGV-INTM TO WSS-AUX-INTM.                            
           ADD SCR-SGV-INMO TO WSS-AUX-INMO.                            
           ADD SCR-SGV-IMMO TO WSS-AUX-IMMO.                            
      *DPM fin  14-OCT-1996                                             
      *RJZ FIN 09-JUNIO-1995                                            
           IF PCP-CMSG > SPACES                                         
              MOVE PCP-CMSG TO MSG-COD-MENS IN MSG                      
              GO TO FIN-PRO-MORA-CTT.                                   
           ADD VEN-VAL-SCAP IN VEN TO PCP-CACU.                         
           ADD VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD.          
           ADD WSS-VAL-SMON IN WSS-VARI TO WSS-TOT-SVEN IN WSS-VARI.    
           ADD 1 TO VEN-NUM-IVEN IN VEN.                                
           IF VEN-NUM-IVEN IN VEN NOT > ZEROES                          
               GO TO NXT-PRO-MORA-CTT.                                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           IF OPC-IND-VSTR IN OPC = 'S'                                 
               PERFORM COL-OBT-VEN                                      
               IF NOT VEN-STAT-OKS                                      
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)                            
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'       
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                       MOVE VEN-STAT     TO MSG-COD-MENS                
                       MOVE VEN-MEN2     TO FRM-MEN2                    
                       GO TO FIN-PRO-MORA-CTT                           
                   ELSE                                                 
                       GO TO NXT-PRO-MORA-CTT                           
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
               PERFORM COL-FIO-VEN                                      
               IF NOT FIO-STAT-OKS                                      
                   GO TO NXT-PRO-MORA-CTT.                              
      *     IF VEN-VAL-SFIN IN VEN NOT > ZEROES                         
      *         GO TO NXT-PRO-MORA-CTT.                                 
           GO TO LUP-PRO-MORA-CTT.                                      
       NXT-PRO-MORA-CTT.                                                
      *RJZ INI 09-JUNIO-1995                                            
      *DPM ini  14-OCT-1996                                             
      *     MOVE SCR-AUX-INTN TO SCR-SGV-INTN.                          
      *     MOVE SCR-AUX-INTM TO SCR-SGV-INTM.                          
           MOVE WSS-AUX-INTN TO SCR-SGV-INTN.                           
           MOVE WSS-AUX-INTM TO SCR-SGV-INTM.                           
           MOVE WSS-AUX-INMO TO SCR-SGV-INMO.                           
           MOVE WSS-AUX-IMMO TO SCR-SGV-IMMO.                           
           MOVE WSS-VAL-SMO5 TO CAN-SGV-COMI IN CAN-FLD.                
      *DPM fin  14-OCT-1996                                             
           IF WSS-CIC-TVAL = '0'                                        
              MOVE SCR-SGV-INTM TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTM             
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN.            
      *RJZ FIN 09-JUNIO-1995                                            
           MOVE WSS-TOT-SVEN IN WSS-VARI TO WSS-VAL-SVEN IN WSS-VARI.   
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                           
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                        
                             GIVING WSS-VAL-SVEN ROUNDED.               
           IF WSS-CIC-TVAL = '0'                                        
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.           
       FIN-PRO-MORA-CTT.                                                
           EXIT.                                                        

       PRO-DESC-CTT SECTION.                                            
       INI-PRO-DESC-CTT.                                                
           MOVE CCO-COD-EVEN-ANT (1:3) TO CCO-COD-EVEN.                 
           IF OPC-NUM-VCOR IN OPC = 1                                   
               PERFORM PRO-DESC-CTE-1VCTO                               
               GO TO FIN-PRO-DESC-CTT.                                  
      *     IF ITR-COD-CVTI IN ITR > SPACES AND                         
      *        FRM-SGV-TINT IN CAN-FLD NOT = ICG-SGV-TINT IN CAN-FLD    
      *         MOVE 'CANTTTV=TC' TO MSG-COD-MENS                       
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR                           
      *         GO TO FIN-PRO-DESC-CTT.                                 
      *AFRI-INI 20-SEP-2017 TASA ICP
           IF VEN-NUM-IVCT IN CAN-FLD = OPC-NUM-VCOR IN OPC
               GO TO CON-VAL-TAS-ICP.
           MOVE WSS-GLS-INNO   TO WSS-IND-TICP.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST
           MOVE 'TIV'          TO TAB-COD-TTAB IN TAB
           MOVE ITR-COD-CVTI IN ITR TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND
               TAB-IND-VIGE IN TAB = WSS-GLS-INSI
           MOVE WSS-GLS-INSI TO WSS-IND-TICP.
           IF WSS-IND-TICP IN WSS-VARI = WSS-GLS-INSI
               MOVE FRM-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT IN CAN-FLD.
       CON-VAL-TAS-ICP.
      *AFRI-FIN 20-SEP-2017 TASA ICP
           IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD         
                                                                        
      * Se hace una excepcion para documentos descontados; siempre      
      * deben procesarse como si las tasas fuesen distintas.            
               IF WSS-OPEC = 'D'                                        
                  PERFORM PRO-DESC-CTT-TADI                             
               ELSE                                                     
                  PERFORM PRO-DESC-CTT-TAIG                             
           ELSE                                                         
               PERFORM PRO-DESC-CTT-TADI.                               
       FIN-PRO-DESC-CTT.                                                
           EXIT.                                                        
                                                                        
       PRO-DESC-CTT-TAIG SECTION.                                       
       INI-PRO-DESC-CTT-TAIG.                                           
      *AFRI-INI 20-SEP-2017 TASA ICP
      *    PERFORM OBT-RCV-FINA.
           IF WSS-IND-TICP IN WSS-VARI NOT = WSS-GLS-INSI
                PERFORM OBT-RCV-FINA.
      *AFRI-FIN 20-SEP-2017 TASA ICP
           IF FRM-SUAR = FRM-SUAR-MAL                                   
      *DAD ini  25-NOV-1991   (Memo.05-11-91 pto.2)                     
               IF ( MSG-COD-MENS IN MSG = 'CANINTEFINA>' AND            
                    OPC-IND-VSTR IN OPC = 'N' )                         
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)                            
                OR ( MSG-COD-MENS IN MSG = 'CAMBTSANXABT' OR            
                                           'CAMBTSANVABT' )             
                   MOVE OPC-VAL-SCRE IN OPC TO RCV-SGV-CAPI IN CAN-FLD  
                   MOVE ZEROES              TO RCV-SGV-FINA IN CAN-FLD  
                   MOVE FRM-SUAR-OKS TO FRM-SUAR                        
                   MOVE SPACES TO INT-CMSG MSG-COD-MENS IN MSG FRM-MENS 
               ELSE                                                     
      *DAD fin  25-NOV-1991                                             
                   GO TO FIN-PRO-DESC-CTT-TAIG.                         
           PERFORM LEE-REG-TCAN.                                        
      *Se hace una excepcion para boletas de garantia                   
      *siempre deben procesarse igual a un descuento de 1 vcto          
           IF WSS-OPEC = 'B'                                            
               PERFORM PRO-DESC-CTE-1VCTO                               
               GO TO FIN-PRO-DESC-CTT-TAIG.                             
      *                                                                 
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.        
           PERFORM CAL-TFPR-CAN.                                        
           IF FRM-SUAR = FRM-SUAR-MAL                                   
               GO TO FIN-PRO-DESC-CTT-TAIG.                             
           IF WSS-CMP-FVEN IN WSS-VARI NOT < WSS-CMP-FCAN IN WSS-VARI   
               IF WSS-OPEC = 'B'                                        
                   MOVE 0 TO WSS-VAL-SMO1                               
                   GO TO OBT-MON1                                       
               ELSE                                                     
                   PERFORM BUS-IDNI-VEN-ANT                             
                   ADD OPC-VAL-SCRE IN OPC WSS-VAL-IDNI IN WSS-VARI     
                                    GIVING WSS-VAL-SMO1                 
                   GO TO OBT-MON1.                                      
           IF INT-CMSG > SPACES                                         
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2                     
               MOVE INT-CMSG            TO MSG-COD-MENS                 
               MOVE FRM-SUAR-MAL        TO FRM-SUAR                     
               GO TO FIN-PRO-DESC-CTT-TAIG.                             
      *AFRI-INI LEY 19951                                               
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.                
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'NUEVLEY19951' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB                                          
           IF FIO-STAT-OKS AND                                          
              TAB-IND-VIGE IN TAB = 'S'                                 
               IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD     
                   PERFORM PRO-DESC-LEY                                 
                   IF INT-CMSG > SPACES                                 
                       GO TO FIN-PRO-DESC-CTT-TAIG                      
                   ELSE                                                 
                                                                        
      * DPM INI  07.09.2005 SE SACA CODIGO QUE CALCULA MAL LOS          
      * INTERESES NO INCLUIDOS EN PREPAGOS PARCIALES                    
                       MOVE ZEROES              TO                      
                             WSS-VAL-IDNI IN WSS-VARI                   
      * DPM FIN  07.09.2005 SE SACA CODIGO QUE CALCULA MAL LOS          
                                                                        
                       GO TO CON-NUEVA-LEY-CTT.                         
      *AFRI-FIN LEY 19951                                               
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1.                    
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1.                    
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1.                    
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1.                    
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.                    
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.                    
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.                    
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.                    
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.                    
           PERFORM CAL-TIPE-DESC.                                       
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-CTT-TAIG.                             
           ADD 1 TO INT-TIPE.                                           
           MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI IN WSS-VARI.        
           DIVIDE VEN-VAL-SFIN IN VEN BY INT-TIPE                       
      *DAD ini  19-FEB-1993   (Memo.16-12-92)                           
      *                           GIVING WSS-VAL-SMO2 ROUNDED.          
                                  GIVING WSS-VAL-SMO2.                  
      *AFRI-FIN LEY 19951                                               
       CON-NUEVA-LEY-CTT.                                               
      *AFRI-FIN LEY 19951                                               
      *DAD fin  19-FEB-1993                                             
           IF WSS-OPEC = 'B'                                            
               MOVE 0 TO WSS-VAL-SMO1                                   
           ELSE                                                         
               SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM OPC-VAL-SCRE IN OPC
                                              GIVING WSS-VAL-SMO1.      
           ADD WSS-VAL-SMO1 WSS-VAL-IDNI IN WSS-VARI                    
                                         GIVING WSS-VAL-SMO1.           
           ADD WSS-VAL-SMO1 WSS-VAL-SMO2 GIVING WSS-VAL-SMO1.           
       OBT-MON1.                                                        
           MOVE WSS-VAL-SMO1 TO WSS-VAL-SVEN.                           
      *                                                                 
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.                            
                                                                        
           IF WSS-OPEC NOT = 'B'                                        
               SUBTRACT OPC-VAL-SCRE IN OPC FROM SCR-SGV-IPFC.          
      *                                                                 
      *DPM ini  25-FEB-1997                                             
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.                           
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM                        
                             GIVING SCR-SGV-INTN.                       
      *DPM ini  25-MAR-1997                                             
           IF SCR-SGV-INTN > -1 AND                                     
              SCR-SGV-INTN < 1                                          
               MOVE ZEROES TO SCR-SGV-INTN.                             
      *DPM fin  25-MAR-1997                                             
           MOVE ZEROES TO SCR-SGV-INTM.                                 
           IF WSS-CIC-TVAL = '0'                                        
               MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN.           
      *DPM fin  25-FEB-1997                                             
                                                                        
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                           
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                        
                             GIVING WSS-VAL-SVEN ROUNDED.               
           IF NOT ( CAN-SGV-TPAG IN CAN-FLD = ZEROES AND                
                    WSS-IBLK-TPAG = 'S' )                               
                 MOVE 'S' TO PCP-IINC                                   
           END-IF.                                                      
      *HZF-INI 13-10-2000                                               
           PERFORM PRO-COM-IMP-CTE.                                     
           IF PCP-CMSG > SPACES                                         
              GO TO FIN-PRO-DESC-CTT-TAIG.                              
      *AFRI-INI/LOF/CHC/07-2009
           PERFORM SET-VAR-LOC.
           PERFORM LOC-COM-FGP.
           IF LOC-GLS-MENS IN LOC-VARI = SPACES AND
            LOC-COM-FGPE IN LOC-VARI > ZEROES
               MOVE SPACES TO PCP-CMSG
               MOVE LOC-COM-FGPE IN LOC-VARI TO SCR-SGV-CFGP
               MOVE LOC-VAL-MCAN IN LOC-VARI TO SCR-SGV-CMFG
      *AFRI-INI/LOF/ALD/05-2010 POR PTT
      *        ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO.
               ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO
               IF CAN-MSC-CANC IN CAN-FLD = 'PTT' AND PCP-SUVP > ZEROES
                  ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUVP.
      *    IF LOC-GLS-MENS IN LOC-VARI = SPACES AND
      *     LOC-COM-FGPE IN LOC-VARI > ZEROES AND PCP > SPACES
      *       IF ( PCP-IINF = 'S' )
      *        AND CAN-SGV-COMI IN CAN-FLD > 0
      *           SUBTRACT LOC-COM-FGPE IN LOC-VARI
      *                                   FROM CAN-SGV-TPAG IN CAN-FLD.
      *AFRI-FIN/LOF/ALD/05-2010 POR PTT
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           PERFORM OBT-DATOS-CEN.
           IF MSG-COD-MENS > SPACES
              GO TO FIN-PRO-DESC-CTT-TAIG.
           ADD WSS-TOT-COMI     TO  PCP-SUCO.
           IF CAN-MSC-CANC IN CAN-FLD = 'PTT' AND PCP-SUVP > ZEROES
                ADD WSS-TOT-COMI             TO PCP-SUVP.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-FIN/LOF/CHC/07-2009
           MOVE PCP-SUCO TO CAN-SGV-COMI IN CAN-FLD.                    
           ADD  PCP-SUIM TO CAN-SGV-COMI IN CAN-FLD.                    
           ADD PCP-SUVP TO CAN-SGV-TPAG IN CAN-FLD.                     
      *HZF-FIN 13-10-2000                                               
           ADD PCP-SUCO TO WSS-VAL-SVEN                                 
           ADD PCP-SUIM TO WSS-VAL-SVEN                                 
           COMPUTE WSS-VAL-SMON ROUNDED = WSS-VAL-SVEN / SCR-SGV-VCAM.  
           IF WSS-CIC-TVAL = '0'                                        
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.           
       FIN-PRO-DESC-CTT-TAIG.                                           
           EXIT.                                                        

      *Obtiene la suma de los SCAP y SFIN desdes VEN actual hasta el ult
      *completando aquellos incompletos
       OBT-RCV-FINA SECTION.
       INI-OBT-RCV-FINA.
           PERFORM LEE-REG-TCAN.
      *
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
           MOVE 0 TO WSS-IVEZ.
       LUP-OBT-RCV-FINA.
           PERFORM CAL-TFPR-CAN.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-OBT-RCV-FINA.
      *Si es la primera vez inicializa acumuladores con dicho VEN,
      *en caso contrario acumula los VEN siguientes en los RCV
           IF WSS-IVEZ = 0
               MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD
               MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD
               MOVE 1 TO WSS-IVEZ
           ELSE
               ADD  VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               ADD  VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD.
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM OPC-VAL-SCRE IN OPC
                    GIVING WSS-VAL-SCRE IN WSS-VARI.
      *
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE CAN-NUM-DCAN IN CAN-FLD TO VEN-DTBS
               MOVE CAN-NUM-MCAN IN CAN-FLD TO VEN-MTBS
               MOVE CAN-NUM-SCAN IN CAN-FLD TO VEN-STBS
               MOVE CAN-NUM-ACAN IN CAN-FLD TO VEN-ATBS
               PERFORM COL-OBT-VEN
               IF VEN-STAT-EOF
                   GO TO FIN-OBT-RCV-FINA
               ELSE
               IF NOT VEN-STAT-OKS
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'       
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                       MOVE VEN-STAT     TO MSG-COD-MENS                
                       MOVE VEN-MEN2     TO FRM-MEN2                    
                       GO TO FIN-OBT-RCV-FINA                           
                   ELSE                                                 
                       GO TO FIN-OBT-RCV-FINA                           
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-OBT-RCV-FINA.
      *     IF VEN-VAL-SFIN IN VEN NOT > ZEROES
      *         GO TO FIN-OBT-RCV-FINA.
           GO TO LUP-OBT-RCV-FINA.
       FIN-OBT-RCV-FINA.
           EXIT.


       BUS-IDNI-VEN-ANT SECTION.                                        
       INI-BUS-IDNI-VEN-ANT.                                            
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.         
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.         
           IF VEN-NUM-IVEN IN VEN = 1                                   
               MOVE ZEROES TO WSS-VAL-IDNI                              
               GO TO FIN-BUS-IDNI-VEN-ANT.                              
      *                                                                 
           SUBTRACT 1 FROM VEN-NUM-IVEN IN VEN.                         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           IF OPC-IND-VSTR IN OPC = 'S'                                 
               PERFORM COL-OBT-VEN                                      
               IF VEN-STAT-OKS                                          
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI             
               ELSE                                                     
                   MOVE ZEROES              TO WSS-VAL-IDNI             
           ELSE                                                         
               PERFORM COL-FIO-VEN                                      
               IF FIO-STAT-OKS                                          
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI             
               ELSE                                                     
                   MOVE ZEROES              TO WSS-VAL-IDNI.            
      *Para restaurar VEN actual                                        
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.         
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           IF OPC-IND-VSTR IN OPC = 'S'                                 
               PERFORM COL-OBT-VEN                                      
           ELSE                                                         
               PERFORM COL-FIO-VEN.                                     
       FIN-BUS-IDNI-VEN-ANT.                                            
           EXIT.                                                        
                                                                        
       PRO-DESC-CTT-TADI SECTION.                                       
       INI-PRO-DESC-CTT-TADI.                                           
      *ald                                                              
      *     PERFORM BUS-ANT-VEN.                                        
      *     IF FRM-SUAR = FRM-SUAR-MAL                                  
      *         GO TO FIN-PRO-DESC-CTT-TADI.                            
           PERFORM LEE-REG-TCAN.                                        
      *                                                                 
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.        
           MOVE ZEROES TO WSS-VAL-SMO5.                                 
           MOVE 0 TO WSS-IVEZ.                                          
           IF NOT ( CAN-SGV-TPAG IN CAN-FLD = ZEROES AND                
                    WSS-IBLK-TPAG = 'S' )                               
                 MOVE 'S' TO PCP-IINC                                   
           END-IF.                                                      
      *AFRI-INI/LOF/CHC/07-2009
           MOVE ZEROES TO CAN-SGV-COMI IN CAN-FLD.
      *AFRI-FIN/LOF/CHC/07-2009
       LUP-PRO-DESC-CTT-TADI.                                           
           PERFORM PRO-DESC-CTE.                                        
           IF FRM-SUAR = FRM-SUAR-MAL                                   
               GO TO FIN-PRO-DESC-CTT-TADI.                             
      *Si es la primera vez, debe mostrar en pantalla el VEN            
      *actual, inicializar acumuladores con dicho VEN e inicializar el  
      *valor pagado de la cuota, en caso contrario                      
      *acumula los VEN siguientes en los RCV y el valor pagado          
           IF WSS-IVEZ = 0                                              
               MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD      
               MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD      
               MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD      
               MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD      
               MOVE WSS-VAL-SMON IN WSS-VARI TO                         
                    WSS-TOT-SVEN IN WSS-VARI                            
               MOVE CAN-SGV-COMI IN CAN-FLD  TO WSS-VAL-SMO5            
               MOVE 1 TO WSS-IVEZ                                       
           ELSE                                                         
      *        IF ( CAN-MSC-CANC IN CAN-FLD = 'PTT' )                   
      *            ADD  CAN-SGV-COMI IN CAN-FLD  TO WSS-VAL-SMO5        
      *        ELSE                                                     
                   MOVE CAN-SGV-COMI IN CAN-FLD  TO WSS-VAL-SMO5        
      *        END-IF                                                   
               ADD  VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD      
               ADD  VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD      
               ADD  WSS-VAL-SMON IN WSS-VARI TO                         
                    WSS-TOT-SVEN IN WSS-VARI.                           
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM OPC-VAL-SCRE IN OPC    
                    GIVING WSS-VAL-SCRE IN WSS-VARI.                    
      *                                                                 
           ADD 1 TO VEN-NUM-IVEN IN VEN.                                
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           IF OPC-IND-VSTR IN OPC = 'S'                                 
               MOVE CAN-NUM-DCAN IN CAN-FLD TO VEN-DTBS                 
               MOVE CAN-NUM-MCAN IN CAN-FLD TO VEN-MTBS                 
               MOVE CAN-NUM-SCAN IN CAN-FLD TO VEN-STBS                 
               MOVE CAN-NUM-ACAN IN CAN-FLD TO VEN-ATBS                 
               PERFORM COL-OBT-VEN                                      
               IF VEN-STAT-EOF                                          
                   GO TO NXT-PRO-DESC-CTT-TADI                          
               ELSE                                                     
               IF NOT VEN-STAT-OKS                                      
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)                            
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'       
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                       MOVE VEN-STAT     TO MSG-COD-MENS                
                       MOVE VEN-MEN2     TO FRM-MEN2                    
                       GO TO FIN-PRO-DESC-CTT-TADI                      
                   ELSE                                                 
                       GO TO NXT-PRO-DESC-CTT-TADI                      
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
               PERFORM COL-FIO-VEN                                      
               IF NOT FIO-STAT-OKS                                      
                   GO TO NXT-PRO-DESC-CTT-TADI.                         
      *     IF VEN-VAL-SFIN IN VEN NOT > ZEROES                         
      *         GO TO NXT-PRO-DESC-CTT-TADI.                            
           GO TO LUP-PRO-DESC-CTT-TADI.                                 
       NXT-PRO-DESC-CTT-TADI.                                           
           MOVE WSS-VAL-SMO5 TO CAN-SGV-COMI IN CAN-FLD.                
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           PERFORM OBT-DATOS-CEN.
           IF MSG-COD-MENS > SPACES
              GO TO FIN-PRO-DESC-CTT-TADI..
           ADD WSS-TOT-COMI     TO  CAN-SGV-COMI IN CAN-FLD.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           MOVE WSS-TOT-SVEN IN WSS-VARI TO WSS-VAL-SVEN IN WSS-VARI.   
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                           
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                        
                             GIVING WSS-VAL-SVEN ROUNDED.               
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           ADD WSS-TOT-COMI     TO  WSS-VAL-SVEN.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           IF WSS-CIC-TVAL = '0'                                        
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.           
       FIN-PRO-DESC-CTT-TADI.                                           
           EXIT.                                                        

       CAL-TIPE SECTION.
       INI-CAL-TIPE.
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           MOVE FEC-FEC1                TO INT-FUNO.
           MOVE FEC-FEC2                TO INT-FDOS.
           MOVE OPC-NUM-DCOL IN OPC     TO INT-DCOL.
           MOVE OPC-NUM-MCOL IN OPC     TO INT-MCOL.
           MOVE OPC-NUM-SCOL IN OPC     TO INT-SCOL.
           MOVE OPC-NUM-ACOL IN OPC     TO INT-ACOL.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DBTV.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MBTV.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SBTV.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ABTV.
      *JSS uso de spread para calculo 1ra cuota (Memo.13/05/92)
           IF WSS-IND-SPR2 = 'S' AND
              VEN-NUM-IVCT IN VEN = 1 AND
              INT-CVTI > SPACES AND INT-TFPR = 'C' AND
              SCR-SGV-SPR2 > 0
               MOVE 'COL'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE 'VSNLIQTMXCBCI' TO TAB-COD-TABL IN TAB
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                   MOVE SCR-SGV-SPR2 TO INT-SPR2.
           MOVE SPACES TO WSS-IND-SPR2.
      *
      *SMC-INI 09.09.1993
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC
      *     PERFORM GNS-CAL-INT.
           PERFORM COL-CAL-INT.
      *SMC-FIN 09.09.1993
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR.
       FIN-CAL-TIPE.
           EXIT.

       CAL-TIPE-DESC SECTION.
       INI-CAL-TIPE-DESC.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DDMA INT-DBTV.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MDMA INT-MBTV.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SDMA INT-SBTV.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ADMA INT-ABTV.
           MOVE OPC-COD-VCOC IN OPC TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR.
       FIN-CAL-TIPE-DESC.
           EXIT.

       PRO-TCAN-CIE SECTION.                                            
       INI-PRO-TCAN-CIE.                                                
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.         
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.         
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.         
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.         
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.         
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.         
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.         
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.         
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.         
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.         
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.         
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.         
      *AFRI-INI                                                         
           IF WSS-CMSG = 'OFICONO'                                      
               MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS                 
                                            IN WSS-VARI                 
               MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS                 
                                            IN WSS-VARI                 
               MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS                 
                                            IN WSS-VARI                 
               MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS                 
                                            IN WSS-VARI                 
               MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN          
               MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN          
               MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN          
               MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN          
               PERFORM PRO-MORA-CIE                                     
               MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN            
                                                      IN VEN            
               MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN            
                                                      IN VEN            
               MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN            
                                                      IN VEN            
               MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN            
                                                      IN VEN            
               GO TO FIN-PRO-TCAN-CIE.                                  
      *AFRI-FIN                                                         
                                                                        
      * RBG/INI/12-AUG-1996                                             
      * En el caso de Documentos Descontados (D)                        
           IF WSS-OPEC = 'D'                                            
              PERFORM CAL-NUM-DHBL                                      
              IF CAN-FEC-FCAN IN CAN NOT > WSS-FEC-FTOP IN WSS-VARI     
                 PERFORM PRO-DESC-CIE                                   
                 GO TO FIN-PRO-TCAN-CIE                                 
              ELSE                                                      
                  IF CAN-FEC-FCAN IN CAN > WSS-FEC-FTOP IN WSS-VARI     
                      MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS          
                                                             IN WSS-VARI
                      MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS          
                                                             IN WSS-VARI
                      MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS          
                                                             IN WSS-VARI
                      MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS          
                                                             IN WSS-VARI
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal. 
                      MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN   
                      MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN   
                      MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN   
                      MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN   
                      PERFORM PRO-MORA-CIE                              
                      MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN     
                                                                  IN VEN
                      MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN     
                                                                  IN VEN
                      MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN     
                                                                  IN VEN
                      MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN     
                                                                  IN VEN
                      GO TO FIN-PRO-TCAN-CIE.                           
      * RBG/FIN/12-AUG-1996                                             
      *INI-AFRI/07-2006
           IF (CAN-FEC-FCAN IN CAN < VEN-FEC-FVEN IN VEN AND
            (OPC-NUM-VCOR IN OPC > 1) AND
            CAN-MSC-CANC IN CAN-FLD = 'CIE' AND
            ICG-SGV-TINT IN CAN-FLD NOT = ZEROES)
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'TINTCAN=0'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-TCAN-CIE
           ELSE
      *FIN-AFRI/07-2006
      * RBG/INI/26-AUG-1996                                             
           IF OPC-NUM-VCOR IN OPC = 1                                   
               IF CAN-FEC-FCAN IN CAN > VEN-FEC-FIMV IN VEN             
      * RBG/INI/7-AUG-1996                                              
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
                  MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI  
                  MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI  
                  MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI  
                  MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI  
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal. 
                  MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN       
                  MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN       
                  MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN       
                  MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN       
      * RBG/FIN/7-AUG-1996                                              
                  PERFORM PRO-MORA-CIE                                  
      * RBG/INI/7-AUG-1996                                              
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
                  MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN  
                  MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN  
                  MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN  
                  MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN  
      * RBG/FIN/7-AUG-1996                                              
                  GO TO FIN-PRO-TCAN-CIE                                
               ELSE                                                     
               IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN         
                   PERFORM PRO-DESC-CIE                                 
                   GO TO FIN-PRO-TCAN-CIE.                              
      * RBG/FIN/26-AUG-1996                                             
           IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN                 
               PERFORM PRO-MORA-CIE                                     
           ELSE                                                         
           IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FVEN IN VEN             
               PERFORM PRO-DESC-CIE.                                    
       FIN-PRO-TCAN-CIE.                                                
           EXIT.                                                        

       PRO-MORA-CIE SECTION.                                            
       INI-PRO-MORA-CIE.                                                
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
           PERFORM LOC-DET-FOG.
           IF LOC-GLS-NOCO IN LOC-VARI = WSS-GLS-SCOM
               MOVE WSS-GLS-ICTE TO LOC-MSC-CANC IN LOC-VARI
               PERFORM PRO-TCAN-CTE
               IF CAN-SGV-TPAG IN CAN-FLD < SCR-SGV-INTM
                   MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-PRO-MORA-CIE
               ELSE
                   PERFORM PRO-TCAN-CNE
                   GO TO FIN-PRO-MORA-CIE.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
           MOVE CCO-COD-EVEN-VEN (1:3) TO CCO-COD-EVEN.                 
           PERFORM PRO-FUPM.                                            
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.                    
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.                    
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.                    
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.                    
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-DIF-DIA  TO FEC-CMND.                               
      *    PERFORM PRO-FEC.                                             
           PERFORM CAL-FEC.                                             
           IF NOT FEC-STAT-OKS                                          
               MOVE ZEROES TO FEC-NDIA.                                 
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.                 
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.                
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'BCI    DPTMC' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB                                          
           IF FIO-STAT-OKS AND                                          
              TAB-IND-VIGE IN TAB = 'S'                                 
      *ALD-BCI-INI/22.04.1999                                           
      *        PERFORM VAL-TMAX-CONV                                    
               PERFORM PRO-MORA-TXC                                     
      *ALD-BCI-FIN/22.04.1999                                           
           ELSE                                                         
           IF CAN-FEC-FCAN IN CAN     > VEN-FEC-FVEN IN VEN AND         
              CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN             
               PERFORM VAL-TMAX-CONV                                    
           ELSE                                                         
               PERFORM PRO-MORA-TMC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL                                   
               GO TO FIN-PRO-MORA-CIE.                                  
           IF WSS-IBLK-TINT = 'S'                                       
               GO TO CON-PRO-CIE-TIPE.                                  
      *JSS 19-AUG-1991 12:44:52                                         
           IF ICG-SGV-TINT IN CAN-FLD NOT > ZEROES                      
               MOVE 0 TO INT-TIPE                                       
               GO TO CON-PRO-CIE-TIPE.                                  
       CON-PRO-MORA-CIE.                                                
           MOVE WSS-DIAM                TO INT-SEPA INT-SEPD.           
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.                    
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)                            
           MOVE SPACES TO INT-CVTI.                                     
      *DAD ini  27-NOV-1991   (Memo.15-11-91 pto.3.2)                   
      *    Cambio  OPC-NUM-xCOL IN OPC  x  WSS-NUM-xUPM  --->  INT-xDMA 
           MOVE WSS-NUM-DUPM            TO INT-DDMA.                    
           MOVE WSS-NUM-MUPM            TO INT-MDMA.                    
           MOVE WSS-NUM-SUPM            TO INT-SDMA.                    
           MOVE WSS-NUM-AUPM            TO INT-ADMA.                    
      *DAD fin  27-NOV-1991                                             
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.                    
           PERFORM OBT-VTIN.                                            
           IF INT-CMSG > SPACES                                         
               MOVE INT-CMSG            TO MSG-COD-MENS                 
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2                     
               MOVE FRM-SUAR-MAL        TO FRM-SUAR                     
               GO TO FIN-PRO-MORA-CIE.                                  
       CON-PRO-CIE-TIPE.                                                
           MULTIPLY INT-TIPE BY VEN-VAL-SFIN IN CAN-FLD GIVING          
                                      WSS-VAL-SMO1 ROUNDED.             
      *DPM ini  14-OCT-1996                                             
           MOVE WSS-VAL-SMO1 TO SCR-SGV-IMMO.                           
      *DPM fin  14-OCT-1996                                             
      *RJZ INI  09-JUNIO-1995                                           
           MULTIPLY WSS-VAL-SMO1 BY SCR-SGV-VCAM GIVING SCR-SGV-INTM.   
      *RJZ FIN  09-JUNIO-1995                                           
           IF WSS-CIC-VCAM = '0999'                                     
               MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1            
           ELSE                                                         
               IF WSS-CIC-TVAL = '0'                                    
                   MULTIPLY WSS-VAL-SMO1 BY SCR-SGV-VCAM                
                                     GIVING WSS-VAL-SMO1                
                   MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI        
                   PERFORM PES-SCTV                                     
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1        
                   DIVIDE WSS-VAL-SMO1 BY SCR-SGV-VCAM                  
                                   GIVING WSS-VAL-SMO1.                 
      *HZF-INI 13-10-2000                                               
           IF NOT ( CAN-SGV-TPAG IN CAN-FLD = ZEROES AND                
                    WSS-IBLK-TPAG = 'S' )                               
                 MOVE 'S' TO PCP-IINC                                   
           END-IF.                                                      
           PERFORM CAL-COM-PCP.                                         
           IF PCP-CMSG > SPACES                                         
              GO TO FIN-PRO-MORA-CIE.                                   
           MOVE PCP-SUCO TO CAN-SGV-COMI IN CAN-FLD.                    
           ADD  PCP-SUIM TO CAN-SGV-COMI IN CAN-FLD.                    
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
           IF CAN-SGV-TPAG IN CAN-FLD > ZEROES AND
              CAN-SGV-TPAG IN CAN-FLD > SCR-SGV-INTM
               COMPUTE GCN-TPAG = CAN-SGV-TPAG IN CAN-FLD -
                                  SCR-SGV-INTM
               PERFORM PRO-COM-NOR-CIE
               IF GCN-CMSG =  SPACES
                   ADD GCN-CONO TO CAN-SGV-COMI IN CAN-FLD
                   MOVE GCN-CONO TO SCR-SGV-CONO
                   ADD GCN-CONO TO PCP-SUCO.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *    ADD PCP-SUCO TO WSS-VAL-SMO1                                 
      *    ADD PCP-SUIM TO WSS-VAL-SMO1                                 
      *HZF-FIN 13-10-2000                                               
           ADD WSS-VAL-SMO1 VEN-VAL-SFIN IN CAN-FLD GIVING              
                                      WSS-VAL-SMO2 ROUNDED.             
                                                                        
           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'  
               MOVE WSS-VAL-SMO1 TO WSS-VAL-SMO4                        
               MULTIPLY WSS-VAL-SMO4 BY SCR-SGV-VCAM                    
                      GIVING CAN-SGV-TPAG IN CAN-FLD                    
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
               COMPUTE SCR-SGV-CFGP = SCR-SGV-CFGP - SCR-SGV-CMFG
               COMPUTE PCP-SUCO     = PCP-SUCO     - SCR-SGV-CMFG
               MOVE PCP-SUCO TO CAN-SGV-COMI IN CAN-FLD
               MOVE ZEROES TO SCR-SGV-CMFG
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
               ADD PCP-SUCO TO CAN-SGV-TPAG IN CAN-FLD                  
               ADD PCP-SUIM TO CAN-SGV-TPAG IN CAN-FLD                  
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI IN PES-VARI 
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG IN CAN-FLD 
           ELSE                                                         
      *DAD ini  21-ABR-1993                                             
      *         DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM          
                SUBTRACT PCP-SUCO FROM CAN-SGV-TPAG IN CAN-FLD          
                SUBTRACT PCP-SUIM FROM CAN-SGV-TPAG IN CAN-FLD          
                MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-CMP2 IN WSS-VARI
                ADD PCP-SUCO TO   CAN-SGV-TPAG IN CAN-FLD               
                ADD PCP-SUIM TO   CAN-SGV-TPAG IN CAN-FLD               
                DIVIDE WSS-VAL-CMP2 IN WSS-VARI BY SCR-SGV-VCAM         
      *DAD fin  21-ABR-1993                                             
                                       GIVING WSS-VAL-SMO4.             
      *AFRI-INI                                                         
           PERFORM DELETE-CXE-CAN-IPEN.                                 
           IF WSS-CMSG = 'OFICONO'                                      
                IF DLC-VAL-IPEN IN DLC > ZEROES                         
                IF CAN-SGV-TPAG IN CAN-FLD NOT > DLC-VAL-IPEN IN DLC    
                    MOVE LOW-VALUES TO CXE                              
                    MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD              
                    MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD              
                    MOVE ZEROES TO SCR-SGV-INTN                         
                    MOVE ZEROES TO RCV-SGV-INTM                         
                    MOVE ZEROES TO SCR-SGV-IPFC                         
                    MOVE OPC-NUM-DCOL IN OPC TO CAN-NUM-DCAN IN CAN-FLD 
                    MOVE OPC-NUM-MCOL IN OPC TO CAN-NUM-MCAN IN CAN-FLD 
                    MOVE OPC-NUM-SCOL IN OPC TO CAN-NUM-SCAN IN CAN-FLD 
                    MOVE OPC-NUM-ACOL IN OPC TO CAN-NUM-ACAN IN CAN-FLD 
                    MOVE CAN-FEC-FOUT IN CAN-FLD TO                     
                         CAN-FEC-FEGR IN CAN-FLD                        
                    MOVE CAN-SGV-TPAG IN CAN-FLD TO CXE-SGV-MCAL IN CXE 
                    PERFORM GRABA-CXE-CAN-IPEN                          
                    GO TO FIN-PRO-MORA-CIE                              
                 ELSE                                                   
                       SUBTRACT PCP-SUCO FROM CAN-SGV-TPAG IN CAN-FLD   
                       SUBTRACT PCP-SUIM FROM CAN-SGV-TPAG IN CAN-FLD   
                       SUBTRACT DLC-VAL-IPEN IN DLC FROM CAN-SGV-TPAG   
                                                   IN CAN-FLD           
                       MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-CMP2     
                                                  IN WSS-VARI           
                       ADD PCP-SUCO TO   CAN-SGV-TPAG IN CAN-FLD        
                       ADD PCP-SUIM TO   CAN-SGV-TPAG IN CAN-FLD        
                       ADD DLC-VAL-IPEN IN DLC TO CAN-SGV-TPAG          
                                                          IN CAN-FLD    
                       DIVIDE WSS-VAL-CMP2 IN WSS-VARI BY SCR-SGV-VCAM  
                                                    GIVING WSS-VAL-SMO4 
                       MOVE LOW-VALUES TO CXE                           
                       MOVE DLC-VAL-IPEN IN DLC TO CXE-SGV-MCAL IN CXE  
                       PERFORM GRABA-CXE-CAN-IPEN                       
                       IF WSS-VAL-SMO4 < WSS-VAL-SMO1                   
                           MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD       
                           MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD       
                           MOVE ZEROES TO SCR-SGV-INTN                  
                           MOVE WSS-VAL-SMO4 TO RCV-SGV-INTM            
                           MOVE ZEROES TO SCR-SGV-IPFC                  
                           GO TO FIN-PRO-MORA-CIE                       
                       ELSE                                             
                            NEXT SENTENCE                               
                 ELSE                                                   
                     IF WSS-VAL-SMO4 < WSS-VAL-SMO1                     
                         MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD         
                         MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD         
                         MOVE ZEROES TO SCR-SGV-INTN                    
                         MOVE WSS-VAL-SMO4 TO RCV-SGV-INTM              
                         MOVE ZEROES TO SCR-SGV-IPFC                    
                         GO TO FIN-PRO-MORA-CIE.                        
                                                                        
      *AFRI-FIN                                                         
                                                                        
           IF WSS-VAL-SMO4 < WSS-VAL-SMO1                               
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS                      
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-PRO-MORA-CIE.                                  
           IF WSS-VAL-SMO4 NOT < WSS-VAL-SMO2                           
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS                        
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-PRO-MORA-CIE.                                  
           SUBTRACT WSS-VAL-SMO1 FROM WSS-VAL-SMO4 GIVING               
                    RCV-SGV-FINA IN CAN-FLD.                            
           SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                     GIVING WSS-VAL-SMO2.                               
           SUBTRACT WSS-VAL-SMO2 FROM RCV-SGV-FINA IN CAN-FLD GIVING    
                    RCV-SGV-CAPI IN CAN-FLD.                            
           IF RCV-SGV-CAPI IN CAN-FLD < ZEROES                          
               MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD.                  
      *                                                                 
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.                            
           IF WSS-OPEC NOT = 'B'                                        
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.      
                                                                        
      *RJZ INI  09-JUNIO-1995                                           
      *DPM ini  14-OCT-1996                                             
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.                           
      *DPM fin  14-OCT-1996                                             
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INT.    
           SUBTRACT SCR-SGV-INTM FROM SCR-SGV-INT GIVING SCR-SGV-INTN.  
      *DPM ini  26-MAR-1997                                             
           IF SCR-SGV-INTN > -1 AND                                     
              SCR-SGV-INTN < 1                                          
              MOVE ZEROES TO SCR-SGV-INTN.                              
      *DPM fin  26-MAR-1997                                             
                                                                        
           IF WSS-CIC-TVAL = '0'                                        
              MOVE SCR-SGV-INTM TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTM             
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN.            
      *RJZ FIN  09-JUNIO-1995                                           
      *                                                                 
       FIN-PRO-MORA-CIE.                                                
           EXIT.                                                        

       PRO-DESC-CIE SECTION.                                            
       INI-PRO-DESC-CIE.                                                
           MOVE CCO-COD-EVEN-ANT (1:3) TO CCO-COD-EVEN.                 
      * RBG/INI/26-AUG-1996                                             
      *HZF-INI 25-JUN-1994/ALD-BCI-INI/20.08.1996                       
      *     PERFORM CAL-TFPR-CAN.                                       
      *     MOVE VEN-VAL-SFIN IN CAN-FLD TO WSS-VAL-SVEN WSS-VAL-SMON.  
      *HZF-FIN 25-JUN-1994/ALD-BCI-INI/20.08.1996                       
      * RBG/FIN/26-AUG-1996                                             
           IF OPC-NUM-VCOR IN OPC = 1                                   
               PERFORM PRO-DESC-CIE-1VCTO                               
               GO TO FIN-PRO-DESC-CIE.                                  
                                                                        
           IF WSS-IBLK-TPAG = 'S'                                       
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS                      
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-PRO-DESC-CIE.                                  
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)                     
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES                          
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)                        
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES   
                  NEXT SENTENCE                                         
              ELSE                                                      
                  MOVE ZEROES TO INT-TIPE                               
                  GO TO CON-PRO-DESC-CIE.                               
      *ALD-BCI-INI/20.08.1996                                           
           IF VEN-VAL-SFIN IN CAN-FLD = VEN-VAL-SCAP IN CAN-FLD AND     
              ICG-SGV-TINT IN CAN-FLD > ZEROES                          
               MOVE 'TASDSCDEBE=0' TO MSG-COD-MENS                      
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-PRO-DESC-CIE.                                  
      *ALD-BCI-FIN/20.08.1996                                           
      *DAD fin  11-MAY-1994                                             
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1.                    
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1.                    
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1.                    
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1.                    
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.                    
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.                    
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.                    
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.                    
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.                    
           PERFORM CAL-TIPE-DESC.                                       
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-CIE.                                  
       CON-PRO-DESC-CIE.                                                
      *YA QUE EL MONTO ES INFORMADO LA COMISION NORMALIZA DEBE SER PARTE
      *DEL VALOR PAGADO                                                 
      *HZF-INI 13-10-2000                                               
           MOVE 'S' TO PCP-IINC.                                        
           PERFORM CAL-COM-PCP.                                         
           IF PCP-CMSG > SPACES                                         
              GO TO FIN-PRO-DESC-CIE.                                   
      *HZF-FIN 13-10-2000                                               
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
           PERFORM SET-VAR-LOC.
           PERFORM LOC-COM-FGP.
           IF LOC-GLS-MENS IN LOC-VARI = SPACES AND
              LOC-COM-FGPE IN LOC-VARI > ZEROES
               MOVE SPACES TO PCP-CMSG
               MOVE LOC-COM-FGPE IN LOC-VARI TO SCR-SGV-CFGP
               MOVE LOC-VAL-MCAN IN LOC-VARI TO SCR-SGV-CMFG
               ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
           ADD 1 TO INT-TIPE.                                           
           SUBTRACT PCP-SUCO FROM CAN-SGV-TPAG IN CAN-FLD               
           SUBTRACT PCP-SUIM FROM CAN-SGV-TPAG IN CAN-FLD               
           DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM               
      *DAD ini  11-MAY-1994   (Memo.16-12-92)                           
      *                               GIVING WSS-VAL-SMO4 ROUNDED.      
                                      GIVING WSS-VAL-SMO4.              
      *HZF-INI 13-10-2000                                               
      *     SUBTRACT PCP-SUCO FROM WSS-VAL-SMO4                         
      *     SUBTRACT PCP-SUIM FROM WSS-VAL-SMO4.                        
           ADD PCP-SUCO PCP-SUIM GIVING CAN-SGV-COMI IN CAN-FLD.        
           ADD  PCP-SUCO TO   CAN-SGV-TPAG IN CAN-FLD                   
           ADD  PCP-SUIM TO   CAN-SGV-TPAG IN CAN-FLD                   
      *HZF-FIN 13-10-2000                                               
      *DAD fin  11-MAY-1994                                             
           MULTIPLY WSS-VAL-SMO4 BY INT-TIPE GIVING                     
      *DAD ini  11-MAY-1994   (Memo.16-12-92)                           
      *                             WSS-VAL-SMO1 ROUNDED.               
                                    WSS-VAL-SMO1.                       
      *DAD fin  11-MAY-1994                                             
           SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                     GIVING WSS-VAL-SMO2.                               
           MOVE WSS-VAL-SMO1 TO RCV-SGV-FINA IN CAN-FLD.                
           IF WSS-VAL-SMO1 < WSS-VAL-SMO2                               
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS                      
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-PRO-DESC-CIE.                                  
           IF WSS-VAL-SMO1 NOT < VEN-VAL-SFIN IN CAN-FLD                
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS                      
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-PRO-DESC-CIE.                                  
           SUBTRACT WSS-VAL-SMO2 FROM WSS-VAL-SMO1 GIVING               
                          RCV-SGV-CAPI IN CAN-FLD ROUNDED.              
      *                                                                 
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.                            
           IF WSS-OPEC NOT = 'B'                                        
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.      
                                                                        
      *RJZ INI  09-JUNIO-1995                                           
      *DPM ini  14-OCT-1996                                             
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.                           
      *DPM fin  14-OCT-1996                                             
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.   
      *DPM ini  26-MAR-1997                                             
           IF SCR-SGV-INTN > -1 AND                                     
              SCR-SGV-INTN < 1                                          
              MOVE ZEROES TO SCR-SGV-INTN.                              
      *DPM fin  26-MAR-1997                                             
                                                                        
           IF WSS-CIC-TVAL = '0'                                        
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN             
              MOVE ZEROES TO SCR-SGV-INTM                               
              MOVE ZEROES TO SCR-SGV-INT.                               
      *RJZ FIN  09-JUNIO-1995                                           
      *                                                                 
       FIN-PRO-DESC-CIE.                                                
           EXIT.                                                        

       PRO-TCAN-CPE SECTION.
       INI-PRO-TCAN-CPE.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.

      * RBG/INI/12-AUG-1996
      * En el caso de Documentos Descontados (D)
           IF WSS-OPEC = 'D'
              PERFORM CAL-NUM-DHBL
              IF CAN-FEC-FCAN IN CAN NOT > WSS-FEC-FTOP IN WSS-VARI
                 PERFORM PRO-DESC-CPE
                 GO TO FIN-PRO-TCAN-CPE
              ELSE
                  IF CAN-FEC-FCAN IN CAN > WSS-FEC-FTOP IN WSS-VARI
                      MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS
                                                             IN WSS-VARI
                      MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS
                                                             IN WSS-VARI
                      MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS
                                                             IN WSS-VARI
                      MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS
                                                             IN WSS-VARI
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal.
                      MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN
                      MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN
                      MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN
                      MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN
                      PERFORM PRO-MORA-CPE
                      MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN
                                                                  IN VEN
                      MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN
                                                                  IN VEN
                      MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN
                                                                  IN VEN
                      MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN
                                                                  IN VEN
                      GO TO FIN-PRO-TCAN-CPE.
      * RBG/FIN/12-AUG-1996
      * RBG/INI/26-AUG-1996
           IF OPC-NUM-VCOR IN OPC = 1
               IF CAN-FEC-FCAN IN CAN > VEN-FEC-FIMV IN VEN
      * RBG/INI/7-AUG-1996
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
                  MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI
                  MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI
                  MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI
                  MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal.
                  MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN
                  MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN
                  MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN
                  MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN
      * RBG/FIN/7-AUG-1996
                  PERFORM PRO-MORA-CPE
      * RBG/INI/7-AUG-1996
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
                  MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN
                  MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN
                  MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN
                  MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN
      * RBG/FIN/7-AUG-1996
                  GO TO FIN-PRO-TCAN-CPE
               ELSE
               IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN
                   PERFORM PRO-DESC-CPE
                   GO TO FIN-PRO-TCAN-CPE.
      * RBG/FIN/26-AUG-1996
           IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN
               PERFORM PRO-MORA-CPE
           ELSE
           IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FVEN IN VEN
               PERFORM PRO-DESC-CPE.
      * RBG/FIN/26-AUG-1996
       FIN-PRO-TCAN-CPE.
           EXIT.

       PRO-MORA-CPE SECTION.
       INI-MORA-CPE.
           MOVE CCO-COD-EVEN-VEN (1:3) TO CCO-COD-EVEN.                 
           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-MORA-CPE.

           PERFORM PRO-FUPM.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    DPTMC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
      *ALD-BCI-INI/22.04.1999
      *        PERFORM VAL-TMAX-CONV
               PERFORM PRO-MORA-TXC
      *ALD-BCI-FIN/22.04.1999
           ELSE
           IF CAN-FEC-FCAN IN CAN     > VEN-FEC-FVEN IN VEN AND
              CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN
               PERFORM VAL-TMAX-CONV
           ELSE
               PERFORM PRO-MORA-TMC.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CPE.
           IF WSS-IBLK-TINT = 'S'
               GO TO CON-PRO-CPE-TIPE.
      *JSS 19-AUG-1991 12:44:52
           IF ICG-SGV-TINT IN CAN-FLD NOT > ZEROES
               MOVE 0 TO INT-TIPE
               GO TO CON-PRO-CPE-TIPE.
       CON-PRO-MORA-CPE.
           MOVE WSS-DIAM                TO INT-SEPA INT-SEPD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *DAD ini  27-NOV-1991   (Memo.15-11-91 pto.3.2)
      *    Cambio  OPC-NUM-xCOL IN OPC  x  WSS-NUM-xUPM  --->  INT-xDMA
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
      *DAD fin  27-NOV-1991
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-CPE.
       CON-PRO-CPE-TIPE.
           ADD 1 TO INT-TIPE.
           DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
                        GIVING WSS-VAL-SMO4 ROUNDED.
           DIVIDE WSS-VAL-SMO4 BY INT-TIPE GIVING WSS-VAL-SMO1 ROUNDED.
           MOVE WSS-VAL-SMO1 TO RCV-SGV-FINA IN CAN-FLD.
           SUBTRACT RCV-SGV-FINA IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-CPE.
           DIVIDE VEN-VAL-SCAP IN CAN-FLD BY VEN-VAL-SFIN IN CAN-FLD
                  GIVING WSS-VAL-SMO2 ROUNDED.
           MULTIPLY WSS-VAL-SMO2 BY RCV-SGV-FINA IN CAN-FLD GIVING
                    RCV-SGV-CAPI IN CAN-FLD ROUNDED.
      *
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.

      *RJZ INI  09-JUNIO-1995
           MULTIPLY RCV-SGV-FINA IN CAN-FLD BY SCR-SGV-VCAM
                    GIVING RCV-SGV-FINA IN CAN-FLD.
           SUBTRACT RCV-SGV-FINA IN CAN-FLD FROM CAN-SGV-TPAG IN
                         CAN-FLD GIVING SCR-SGV-INTM.
      *DPM ini  14-OCT-1996
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.
      *DPM fin  14-OCT-1996
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INT.
           SUBTRACT SCR-SGV-INTM FROM SCR-SGV-INT GIVING SCR-SGV-INTN.
      *DPM ini  26-MAR-1997
           IF SCR-SGV-INTN > -1 AND
              SCR-SGV-INTN < 1
              MOVE ZEROES TO SCR-SGV-INTN.
      *DPM fin  26-MAR-1997

           IF WSS-CIC-TVAL = '0'
              MOVE SCR-SGV-INTM TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTM
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN.
      *RJZ FIN  09-JUNIO-1995
      *
       FIN-PRO-MORA-CPE.
           EXIT.

       PRO-DESC-CPE SECTION.
       INI-PRO-DESC-CPE.
           MOVE CCO-COD-EVEN-ANT (1:3) TO CCO-COD-EVEN.                 
           IF OPC-NUM-VCOR IN OPC = 1
               PERFORM PRO-DESC-CPE-1VCTO
               GO TO FIN-PRO-DESC-CPE.

           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
                  MOVE ZEROES TO INT-TIPE
                  GO TO CON-PRO-DESC-CPE.
      *DAD fin  11-MAY-1994
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           PERFORM CAL-TIPE-DESC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE.
       CON-PRO-DESC-CPE.
           ADD 1 TO INT-TIPE.
           DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                               GIVING WSS-VAL-SMO4 ROUNDED.
                                      GIVING WSS-VAL-SMO4.
      *DAD fin  31-MAY-1994
           MULTIPLY WSS-VAL-SMO4 BY INT-TIPE GIVING
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                             WSS-VAL-SMO1 ROUNDED.
                                    WSS-VAL-SMO1.
      *DAD fin  31-MAY-1994
           MOVE WSS-VAL-SMO1 TO RCV-SGV-FINA IN CAN-FLD.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.2)
           SUBTRACT RCV-SGV-FINA IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE.
      *DAD fin  11-MAY-1994
           DIVIDE VEN-VAL-SCAP IN CAN-FLD BY VEN-VAL-SFIN IN CAN-FLD
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                               GIVING WSS-VAL-SMO2 ROUNDED.
                                      GIVING WSS-VAL-SMO2.
      *DAD fin  31-MAY-1994
           MULTIPLY WSS-VAL-SMO2 BY RCV-SGV-FINA IN CAN-FLD GIVING
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                             RCV-SGV-CAPI IN CAN-FLD ROUNDED.
                                    RCV-SGV-CAPI IN CAN-FLD.
      *DAD fin  31-MAY-1994
      *
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.

      *RJZ INI  09-JUNIO-1995
      *DPM ini  14-OCT-1996
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.
      *DPM fin  14-OCT-1996
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.
      *DPM ini  26-MAR-1997
           IF SCR-SGV-INTN > -1 AND
              SCR-SGV-INTN < 1
              MOVE ZEROES TO SCR-SGV-INTN.
      *DPM fin  26-MAR-1997

           IF WSS-CIC-TVAL = '0'
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN
              MOVE ZEROES TO SCR-SGV-INTM
              MOVE ZEROES TO SCR-SGV-INT.
      *RJZ FIN  09-JUNIO-1995
      *
       FIN-PRO-DESC-CPE.
           EXIT.

       PRO-FUPM SECTION.                                                
       INI-PRO-FUPM.                                                    
      *OGB-INI 27-AGO-2017 FERIADOS REGIONALES
      *    MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC1 WSS-NUM-DUPM.
      *    MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC1 WSS-NUM-MUPM.
      *    MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC1 WSS-NUM-SUPM.
      *    MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC1 WSS-NUM-AUPM.
           MOVE VEN-NUM-DIMV IN VEN     TO FEC-DEC1 WSS-NUM-DUPM.
           MOVE VEN-NUM-MIMV IN VEN     TO FEC-MEC1 WSS-NUM-MUPM.
           MOVE VEN-NUM-SIMV IN VEN     TO FEC-SEC1 WSS-NUM-SUPM.
           MOVE VEN-NUM-AIMV IN VEN     TO FEC-AEC1 WSS-NUM-AUPM.
      *OGB-FIN 27-AGO-2017 FERIADOS REGIONALES

           MOVE CAN-CAI-IOPC IN CAN-FLD TO RCV-CAI-IOPV IN RCV.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO RCV-IIC-IOPV IN RCV.         
           MOVE VEN-NUM-IVCT IN VEN     TO RCV-NUM-IVCT IN RCV.         
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS    TO FIO-CMND.                             
           PERFORM COL-FIO-RCV.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              CAN-CAI-IOPC IN CAN-FLD = RCV-CAI-IOPV IN RCV AND         
              CAN-IIC-IOPC IN CAN-FLD = RCV-IIC-IOPV IN RCV AND         
              VEN-NUM-IVCT IN VEN     = RCV-NUM-IVCT IN RCV )           
               GO TO EXT-PRO-FUPM.                                      
           MOVE 1 TO WSS-NUM-ICAN IN WSS-VARI.                          
       LUP-PRO-FUPM.                                                    
           MOVE RCV-KEY-ICAN TO CAN-KEY-ICAN IN CAN.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-CAN.                                         
           IF CAN-MSC-FCAN IN CAN = 'P'                                 
               GO TO NXT-PRO-FUPM.                                      
           IF CAN-MSC-STAT IN CAN NOT = 'R' AND                         
              CAN-SGV-TPAG IN CAN NOT < ZEROES AND                      
              CAN-SGV-TREN IN CAN NOT < ZEROES AND                      
              CAN-FEC-FCAN IN CAN >     VEN-FEC-FVEN IN VEN      AND    
      *DAD ini  13-ABR-1993   (Memo.12-04-93)                           
              CAN-FEC-FCAN IN CAN >     WSS-FEC-FUPM IN WSS-VARI AND    
      *DAD fin  193-ABR-1993                                            
              CAN-NUM-ICAN IN CAN NOT = CAN-NUM-ICAN IN CAN-FLD         
               MOVE CAN-NUM-DCAN IN CAN TO FEC-DEC1 WSS-NUM-DUPM        
               MOVE CAN-NUM-MCAN IN CAN TO FEC-MEC1 WSS-NUM-MUPM        
               MOVE CAN-NUM-SCAN IN CAN TO FEC-SEC1 WSS-NUM-SUPM        
               MOVE CAN-NUM-ACAN IN CAN TO FEC-AEC1 WSS-NUM-AUPM.       
       NXT-PRO-FUPM.                                                    
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.                             
           MOVE FIO-GET-NXT    TO FIO-CMND.                             
           PERFORM COL-FIO-RCV.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              CAN-CAI-IOPC IN CAN-FLD = RCV-CAI-IOPV IN RCV AND         
              CAN-IIC-IOPC IN CAN-FLD = RCV-IIC-IOPV IN RCV AND         
              VEN-NUM-IVCT IN VEN     = RCV-NUM-IVCT IN RCV )           
               GO TO EXT-PRO-FUPM.                                      
           GO TO LUP-PRO-FUPM.                                          
       EXT-PRO-FUPM.                                                    
           PERFORM RET-CAN-CAN.                                         
       FIN-PRO-FUPM.                                                    
           EXIT.                                                        

       BUS-SIG-VEN SECTION.
       INI-BUS-SIG-VEN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
       LUP-BUS-SIG-VEN.
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   NEXT SENTENCE
               ELSE
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE VEN-STAT     TO MSG-COD-MENS
                       MOVE VEN-MEN2     TO FRM-MEN2
                       GO TO FIN-BUS-SIG-VEN
                   ELSE
                       GO TO FIN-BUS-SIG-VEN
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-BUS-SIG-VEN.
           IF VEN-FEC-FVEN IN VEN > CAN-FEC-FCAN IN CAN
               MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD
               MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD
               MOVE 'EXTVENSGNCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-BUS-SIG-VEN.
           GO TO LUP-BUS-SIG-VEN.
       FIN-BUS-SIG-VEN.
           EXIT.

      ******************************************************************

       BUS-ANT-VEN SECTION.
      *********************

       INI-BUS-ANT-VEN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
       LUP-BUS-ANT-VEN.
           SUBTRACT 1 FROM VEN-NUM-IVEN IN VEN.
           IF VEN-NUM-IVEN IN VEN NOT > ZEROES
               GO TO FIN-BUS-ANT-VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE 1 TO VEN-NUM-IVEN IN VEN
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS AND
                  VEN-NUM-IVCT IN VEN NOT < VEN-NUM-IVEN IN CAN-FLD
                   GO TO FIN-BUS-ANT-VEN
               ELSE
                   MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD
                   MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD
                   MOVE 'EXTVENANNCAN' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-BUS-ANT-VEN
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-BUS-ANT-VEN.
           IF VEN-VAL-SFIN IN VEN > ZEROES
               MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD
               MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD
               MOVE 'EXTVENANNCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-BUS-ANT-VEN.
           GO TO LUP-BUS-ANT-VEN.
       FIN-BUS-ANT-VEN.
           EXIT.

      ******************************************************************

       PRO-DESC-CTE-1VCTO SECTION.                                      
      ****************************                                      
       INI-PRO-DESC-CTE-1VCTO.                                          
                                                                        
      * RBG/INI/7-AUG-1996                                              
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI.        
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI.        
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI.        
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI.        
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal. 
           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN.             
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN.             
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN.             
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN.             
      * RBG/FIN/7-AUG-1996                                              
                                                                        
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.        
           PERFORM CAL-TFPR-CAN.                                        
           IF INT-CMSG > SPACES                                         
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2                     
               MOVE INT-CMSG            TO MSG-COD-MENS                 
               MOVE FRM-SUAR-MAL        TO FRM-SUAR                     
               GO TO FIN-PRO-DESC-CTE-VENCT.                            
      *LOP-INI 26-05-2003                                               
           IF WSS-OPEC = 'B'                                            
              IF SCR-MSC-TCAN = 'R' AND                                 
                 SCR-MSC-FCAN = 'T' AND                                 
                 SCR-MSC-ECAN = 'T' AND                                 
                 CAN-MSC-CANC IN CAN-FLD = 'PTT'                        
           IF FRM-SGV-TINT IN CAN-FLD NOT = ICG-SGV-TINT IN CAN-FLD     
               MOVE 'BPTTTAS<>ICG'      TO MSG-COD-MENS                 
               MOVE FRM-SUAR-MAL        TO FRM-SUAR                     
               GO TO FIN-PRO-DESC-CTE-VENCT.                            
      *LOP-FIN 26-05-2003                                               
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES                          
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)                        
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES   
                  NEXT SENTENCE                                         
              ELSE                                                      
      *                                                                 
               MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SVEN                 
               GO TO NXT-PRO-DESC-CTE-1VCTO.                            
                                                                        
      *DAD ini  22-SEP-1993   (Memo.02-07-92)                           
           IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD  AND    
              OPC-NUM-VCVG IN OPC = 1                            AND    
      *DAD ini  07-JUL-1994   (Memo.07-07-94 Pto.2)                     
              WSS-CMP-FCAN IN WSS-VARI NOT > DLC-FEC-FDEV IN DLC AND    
      *DAD fin  07-JUL-1994                                             
              WSS-OPEC = 'B'                                            
               MOVE ZEROES TO VEN-VAL-SCAP IN VEN                       
                              WSS-VAL-SVEN IN WSS-VARI                  
               GO TO NXT-PRO-DESC-CTE-1VCTO.                            
      *DAD fin  22-SEP-1993                                             
           PERFORM PRO-UVCT-DVEG.                                       
      *JSS 17-JAN-1992 (Memo.17-12-91)                                  
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD         
               MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2                 
               MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2                 
               MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2                 
               MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2                 
           ELSE                                                         
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2                 
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2                 
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2                 
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.                
      *                                                                 
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.                    
           MOVE 'S' TO WSS-IND-SPR2.                                    
           PERFORM CAL-TIPE.                                            
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-CTE-VENCT.                            
      *JSS 6-JUN-1991 20:57:09 ( un ctt DESC, tasas iguales, opec='B', n
      *llama a procesar a este parrafo 1 sola vez, por lo tanto ...     
           IF WSS-OPEC = 'B'                                            
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE                 
      *DAD ini  19-FEB-1993   (Memo.16-12-92)                           
      *                                 GIVING WSS-VAL-SMO1 ROUNDED     
                                        GIVING WSS-VAL-SMO1             
      *DAD fin  19-FEB-1993                                             
           ELSE                                                         
      *    no afecta a cte DESC,opec='B', 1 venc. ya que en ese caso SCR
      *                                                                 
               MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE             
      *DAD ini  19-FEB-1993   (Memo.16-12-92)                           
      *                                     GIVING WSS-VAL-SMO1 ROUNDED.
                                            GIVING WSS-VAL-SMO1.        
      *DAD fin  19-FEB-1993                                             
      *JSS 17-JAN-1992 (Memo.17-12-91)                                  
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD         
               GO TO CON-PRO-DESC-CTE-1VCTO.                            
      *                                                                 
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1                     
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1                     
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1                     
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1                     
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.                    
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.                    
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.                    
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.                    
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.                    
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)                     
      *     PERFORM CAL-TIPE.                                           
           PERFORM CAL-TIPE-DESC.                                       
      *DAD fin  11-MAY-1994                                             
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-CTE-VENCT.                            
      *JSS 6-JUN-1991 20:57:09 ( un ctt DESC, tasas iguales, opec='B', n
      *llama a procesar a este parrafo 1 sola vez, por lo tanto ...     
           IF WSS-OPEC = 'B'                                            
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE                 
      *DAD ini  19-FEB-1993   (Memo.16-12-92)                           
      *                                 GIVING WSS-VAL-SMO2 ROUNDED     
                                        GIVING WSS-VAL-SMO2             
      *DAD fin  19-FEB-1993                                             
           ELSE                                                         
      *    no afecta a cte DESC,opec='B', 1 venc. ya que en ese caso SCR
      *                                                                 
               MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE             
      *DAD ini  19-FEB-1993   (Memo.16-12-92)                           
      *                                     GIVING WSS-VAL-SMO2 ROUNDED.
                                            GIVING WSS-VAL-SMO2.        
      *DAD fin  19-FEB-1993                                             
           SUBTRACT WSS-VAL-SMO2 FROM WSS-VAL-SMO1 GIVING WSS-VAL-SMO1. 
       CON-PRO-DESC-CTE-1VCTO.                                          
           IF WSS-OPEC = 'B'                                            
               MOVE WSS-VAL-SMO1 TO WSS-VAL-SVEN                        
           ELSE                                                         
               ADD VEN-VAL-SCAP IN CAN-FLD  WSS-VAL-SMO1  GIVING        
                                                          WSS-VAL-SVEN. 
       NXT-PRO-DESC-CTE-1VCTO.                                          
      *                                                                 
      *DPM ini  14-OCT-1996                                             
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.                           
      *DPM fin  14-OCT-1996                                             
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.                            
           IF WSS-OPEC NOT = 'B'                                        
               SUBTRACT VEN-VAL-SCAP IN VEN FROM SCR-SGV-IPFC.          
                                                                        
      *RJZ INI  09-JUNIO-1995                                           
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.   
      *DPM ini  26-MAR-1997                                             
           IF SCR-SGV-INTN > -1 AND                                     
              SCR-SGV-INTN < 1                                          
              MOVE ZEROES TO SCR-SGV-INTN.                              
      *DPM fin  26-MAR-1997                                             
           IF WSS-CIC-TVAL = '0'                                        
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN             
              MOVE ZEROES TO SCR-SGV-INTM                               
              MOVE ZEROES TO SCR-SGV-INT.                               
      *RJZ FIN  09-JUNIO-1995                                           
      *                                                                 
      *    MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                           
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                        
                             GIVING WSS-VAL-SVEN ROUNDED.               
      *HZF-INI 13-10-2000                                               
           PERFORM CAL-COM-PCP                                          
           IF PCP-CMSG > SPACES                                         
              GO TO FIN-PRO-DESC-CTE-1VCTO.                             
                                                                        
      *LOP-INI 26-05-2003                                               
           IF WSS-OPEC = 'B'                                            
              IF SCR-MSC-TCAN = 'R' AND                                 
                 SCR-MSC-FCAN = 'T' AND                                 
                 SCR-MSC-ECAN = 'T' AND                                 
                 CAN-MSC-CANC IN CAN-FLD = 'PTT'                        
                    IF WSS-CIC-TVAL = '0'                               
                       MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI    
                       PERFORM PES-SCTV                                 
                       MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN    
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TPAG IN CAN-FLD     
                    ELSE                                                
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TPAG IN CAN-FLD.    
      *LOP-FIN 26-05-2003                                               
                                                                        
      *AFRI-INI/LOF/CHC/07-2009
           PERFORM SET-VAR-LOC.
           PERFORM LOC-COM-FGP.
           IF LOC-GLS-MENS IN LOC-VARI = SPACES AND
            LOC-COM-FGPE IN LOC-VARI > ZEROES
               MOVE SPACES TO PCP-CMSG
               MOVE LOC-COM-FGPE IN LOC-VARI TO SCR-SGV-CFGP
               MOVE LOC-VAL-MCAN IN LOC-VARI TO SCR-SGV-CMFG
      *AFRI-INI/LOF/ALD/05-2010 POR PTT
      *        ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO.
               ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO
               IF CAN-MSC-CANC IN CAN-FLD = 'PTT' AND PCP-SUVP > ZEROES
                  ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUVP
                   SUBTRACT PCP-SUVP                FROM
                                 CAN-SGV-TPAG IN CAN-FLD.
      *AFRI-FIN/LOF/ALD/05-2010 POR PTT
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
           ADD SCR-SGV-CCAE     TO  PCP-SUCO.
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           PERFORM OBT-DATOS-CEN.
           IF MSG-COD-MENS > SPACES

              GO TO FIN-PRO-DESC-CTE-1VCTO.
           ADD WSS-TOT-COMI     TO  PCP-SUCO.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-FIN/LOF/CHC/07-2009
           MOVE  PCP-SUCO TO CAN-SGV-COMI IN CAN-FLD                    
           ADD   PCP-SUIM TO CAN-SGV-COMI IN CAN-FLD                    
           ADD  PCP-SUVP TO CAN-SGV-TPAG IN CAN-FLD.                    
           ADD   CAN-SGV-COMI IN CAN-FLD TO WSS-VAL-SVEN.               
           COMPUTE WSS-VAL-SMON ROUNDED = WSS-VAL-SVEN / SCR-SGV-VCAM.  
      *HZF-FIN 27-10-2000                                               
           IF WSS-CIC-TVAL = '0'                                        
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.           
      * RBG/INI/7-AUG-1996 Puse este Lavel para evitar el problema del E
       FIN-PRO-DESC-CTE-VENCT.                                          
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
           MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN.        
           MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN.        
           MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN.        
           MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN.        
      * RBG/FIN/7-AUG-1996                                              
       FIN-PRO-DESC-CTE-1VCTO.                                          
           EXIT.                                                        

      ******************************************************************

       PRO-UVCT-DVEG SECTION.
      ***********************

       INI-PRO-UVCT-DVEG.
           MOVE DLC-NUM-DDEV IN DLC TO FEC-DEC1.
           MOVE DLC-NUM-MDEV IN DLC TO FEC-MEC1.
           MOVE DLC-NUM-SDEV IN DLC TO FEC-SEC1.
           MOVE DLC-NUM-ADEV IN DLC TO FEC-AEC1.
       FIN-PRO-UVCT-DVEG.
           EXIT.

      ******************************************************************

       PRO-DESC-CIE-1VCTO SECTION.                                      
      ****************************                                      
                                                                        
       INI-PRO-DESC-CIE-1VCTO.                                          
      * RBG/INI/7-AUG-1996                                              
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI.        
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI.        
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI.        
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI.        
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal. 
           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN.             
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN.             
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN.             
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN.             
      * RBG/FIN/7-AUG-1996                                              
                                                                        
           PERFORM PRO-UVCT-DVEG.                                       
      * RBG INI 8-FEB-1996                                              
           IF ICG-SGV-TINT IN CAN-FLD > ZEROES                          
      *DPM ini  13-FEB-1996                                             
      *        AND DLC-FEC-FDEV IN DLC > HOY-FHOY IN HOY-VARI           
      *DPM ini  01-AGO-1996                                             
      *        AND DLC-FEC-FDEV IN DLC > CAN-FEC-FCAN IN CAN-FLD        
              AND DLC-FEC-FDEV IN DLC > CAN-FEC-FCAN IN CAN             
      *DPM fin  01-AGO-1996                                             
      *DPM fin  13-FEB-1996                                             
                  MOVE 'TASDESC>0'  TO MSG-COD-MENS                     
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-PRO-DESC-CIE-VENCT.                         
      *DPM ini  13-FEB-1996                                             
      *     ELSE                                                        
      *         IF ICG-SGV-TINT IN CAN-FLD = ZEROES                     
      *            AND WSS-IBLK-TINT IN WSS-VARI= 'S'                   
      *            AND DLC-FEC-FDEV IN DLC > HOY-FHOY IN HOY-VARI       
      *               MOVE 'TASDESC>0'  TO MSG-COD-MENS                 
      *               MOVE FRM-SUAR-MAL TO FRM-SUAR                     
      *               GO TO FIN-PRO-DESC-CIE-VENCT.                     
      *DPM fin  13-FEB-1996                                             
      * RBG FIN 8-FEB-1996                                              
      *JSS 17-JAN-1992 (Memo.17-12-91)                                  
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD         
               MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2                 
               MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2                 
               MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2                 
               MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2                 
           ELSE                                                         
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2                 
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2                 
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2                 
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.                
      *                                                                 
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.                    
           MOVE 'S' TO WSS-IND-SPR2.                                    
           PERFORM CAL-TIPE.                                            
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-CIE-VENCT.                            
           MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE                 
      *DAD ini  11-MAY-1994   (Memo.16-12-92)                           
      *                                 GIVING WSS-VAL-SMO1 ROUNDED.    
                                        GIVING WSS-VAL-SMO1.            
      *DAD fin  11-MAY-1994                                             
      *JSS 17-JAN-1992 (Memo.17-12-91)                                  
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD         
               GO TO CON-PRO-DESC-CIE-1VCTO.                            
      *                                                                 
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)                     
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES                          
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)                        
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES   
                  NEXT SENTENCE                                         
              ELSE                                                      
                  GO TO CON-PRO-DESC-CIE-1VCTO.                         
      *DAD fin  11-MAY-1994                                             
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1                     
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1                     
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1                     
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1                     
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.                    
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.                    
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.                    
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.                    
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.                    
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)                     
      *     PERFORM CAL-TIPE.                                           
           PERFORM CAL-TIPE-DESC.                                       
      *DAD fin  11-MAY-1994                                             
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-CIE-VENCT.                            
           MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE                 
      *DAD ini  11-MAY-1994   (Memo.16-12-92)                           
      *                                 GIVING WSS-VAL-SMO2 ROUNDED.    
                                        GIVING WSS-VAL-SMO2.            
      *DAD fin  11-MAY-1994                                             
           SUBTRACT WSS-VAL-SMO2 FROM WSS-VAL-SMO1 GIVING WSS-VAL-SMO1. 
       CON-PRO-DESC-CIE-1VCTO.                                          
           IF WSS-CIC-VCAM = '0999'                                     
               MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI            
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1            
           ELSE                                                         
               IF WSS-CIC-TVAL = '0'                                    
                   MULTIPLY WSS-VAL-SMO1 BY SCR-SGV-VCAM                
                          GIVING WSS-VAL-SMO1                           
                   MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI        
                   PERFORM PES-SCTV                                     
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1        
                   DIVIDE WSS-VAL-SMO1 BY SCR-SGV-VCAM                  
                                             GIVING WSS-VAL-SMO1.       
      *                                                                 
           ADD WSS-VAL-SMO1 TO SCR-SGV-IPFC.                            
      *DPM fin  14-OCT-1996                                             
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.   
      *DPM ini  26-MAR-1997                                             
           IF SCR-SGV-INTN > -1 AND                                     
              SCR-SGV-INTN < 1                                          
              MOVE ZEROES TO SCR-SGV-INTN.                              
      *DPM fin  26-MAR-1997                                             
      *HZF-INI 13-10-2000                                               
           IF NOT ( CAN-SGV-TPAG IN CAN-FLD = ZEROES AND                
                    WSS-IBLK-TPAG = 'S' )                               
              MOVE 'S' TO PCP-IINC                                      
           END-IF                                                       
           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES                          
              MOVE WSS-VAL-SVEN TO WSS-SGV-VCAN                         
              MOVE ZEROES TO WSS-VAL-SVEN                               
              PERFORM CAL-COM-PCP                                       
              MOVE WSS-SGV-VCAN TO WSS-VAL-SVEN                         
           ELSE                                                         
              PERFORM CAL-COM-PCP.                                      
           IF PCP-CMSG > SPACES                                         
              GO TO FIN-PRO-DESC-CIE-1VCTO.
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *    PERFORM OBT-DATOS-CEN.
      *    IF MSG-COD-MENS > SPACES
      *       GO TO FIN-PRO-DESC-CIE-1VCTO.
      *    ADD WSS-TOT-COMI     TO  PCP-SUCO.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
           PERFORM SET-VAR-LOC.
           PERFORM LOC-COM-FGP.
           IF LOC-GLS-MENS IN LOC-VARI = SPACES AND
              LOC-COM-FGPE IN LOC-VARI > ZEROES
               MOVE SPACES TO PCP-CMSG
               MOVE LOC-COM-FGPE IN LOC-VARI TO SCR-SGV-CFGP
               MOVE LOC-VAL-MCAN IN LOC-VARI TO SCR-SGV-CMFG
               ADD LOC-COM-FGPE IN LOC-VARI TO PCP-SUCO.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
           PERFORM OBT-DATOS-CEN.
           IF MSG-COD-MENS > SPACES
              GO TO FIN-PRO-DESC-CIE-1VCTO.
           ADD WSS-TOT-COMI     TO  PCP-SUCO.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
           MOVE  PCP-SUCO TO CAN-SGV-COMI IN CAN-FLD                    
           ADD   PCP-SUIM TO CAN-SGV-COMI IN CAN-FLD                    
      *    ADD   CAN-SGV-COMI IN CAN-FLD TO WSS-VAL-SMO1.               
      *HZF-FIN 13-10-2000                                               
      *RJZ INI  09-JUNIO-1995                                           
      *DPM ini  14-OCT-1996                                             
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.                           
                                                                        
           IF WSS-CIC-TVAL = '0'                                        
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI             
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN             
              MOVE ZEROES TO SCR-SGV-INTM                               
              MOVE ZEROES TO SCR-SGV-INT.                               
      *RJZ FIN  09-JUNIO-1995                                           
      *                                                                 
           ADD VEN-VAL-SCAP IN CAN-FLD WSS-VAL-SMO1 GIVING WSS-VAL-SMO2.
                                                                        
           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'  
               MOVE WSS-VAL-SMO1 TO WSS-VAL-SMO4                        
               MULTIPLY WSS-VAL-SMO4 BY SCR-SGV-VCAM                    
                                 GIVING CAN-SGV-TPAG IN CAN-FLD         
               ADD PCP-SUCO TO CAN-SGV-TPAG IN CAN-FLD                  
               ADD PCP-SUIM TO CAN-SGV-TPAG IN CAN-FLD                  
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI IN PES-VARI 
               PERFORM PES-SCTV                                         
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG IN CAN-FLD 
           ELSE                                                         
      *DAD ini  21-ABR-1993                                             
      *         DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM          
               SUBTRACT PCP-SUCO FROM CAN-SGV-TPAG IN CAN-FLD           
               SUBTRACT PCP-SUIM FROM CAN-SGV-TPAG IN CAN-FLD           
               MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-CMP2 IN WSS-VARI 
               ADD      PCP-SUCO TO   CAN-SGV-TPAG IN CAN-FLD           
               ADD      PCP-SUIM TO   CAN-SGV-TPAG IN CAN-FLD           
               DIVIDE WSS-VAL-CMP2 IN WSS-VARI BY SCR-SGV-VCAM          
      *DAD fin  21-ABR-1993                                             
                                           GIVING WSS-VAL-SMO4.         
                                                                        
           IF WSS-VAL-SMO4 NOT < WSS-VAL-SMO2                           
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS                        
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-PRO-DESC-CIE-VENCT.                            
                                                                        
           IF WSS-VAL-SMO4 < WSS-VAL-SMO1                               
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS                      
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-PRO-DESC-CIE-VENCT.                            
           SUBTRACT WSS-VAL-SMO1 FROM WSS-VAL-SMO4 GIVING               
                    RCV-SGV-CAPI IN CAN-FLD ROUNDED.                    
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM VEN-VAL-SCAP IN CAN-FLD
                    GIVING WSS-VAL-SMO1.                                
      *ALD-BCI-INI/08.11.1995                                           
      *JSS-INI 08-OCT-1994                                              
      *    AL SER LAS TASAS IGUALES, "SIEMPRE", AUN CUANDO EL SPREAD DE 
      *    LA OPC ES 0 Y LA TASA DIGITADA SEA 0 O BLANCO, SE COBRAN LOS 
      *    INTERESES POR DIAS CORRIDOS, POR LO TANTO SE DEBE RECALCULAR 
      *    EL RCV-SGV-FINA CALCULANDO TASA                              
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD         
               NEXT SENTENCE                                            
           ELSE                                                         
      *JSS-FIN 08-OCT-1994                                              
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES                          
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)                        
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES   
                   NEXT SENTENCE                                        
                ELSE                                                    
      *JSS-INI 10-OCT-1994                                              
      *            Si el SCAP es igual al SFIN quiere decir que los     
      *            intereses ya se pagaron completos en un pago anterior
      *            por lo tanto el valor final pagado es igual al       
      *            valor capital pagado                                 
                   IF VEN-VAL-SCAP IN CAN-FLD = VEN-VAL-SFIN IN CAN-FLD 
                       MOVE RCV-SGV-CAPI IN CAN-FLD TO                  
                            RCV-SGV-FINA IN CAN-FLD                     
                       GO TO FIN-PRO-DESC-CIE-VENCT                     
                   ELSE                                                 
      *JSS-FIN 10-OCT-1994                                              
                   SUBTRACT VEN-VAL-SCAP IN CAN-FLD                     
                   FROM VEN-VAL-SFIN IN CAN-FLD                         
                   GIVING  RCV-SGV-FINA IN CAN-FLD ROUNDED              
      *JSS-INI 8-JUN-1995                                               
                   ADD RCV-SGV-CAPI IN CAN-FLD TO                       
                       RCV-SGV-FINA IN CAN-FLD                          
      *JSS-FIN 8-JUN-1995                                               
                   GO TO FIN-PRO-DESC-CIE-VENCT.                        
      *ALD-BCI-FIN/08.11.1995                                           
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1                     
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1                     
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1                     
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1                     
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.                    
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.                    
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.                    
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.                    
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.                    
           MOVE 'S' TO WSS-IND-SPR2.                                    
           PERFORM CAL-TIPE.                                            
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-CIE-VENCT.                            
           ADD 1 TO INT-TIPE.                                           
           MULTIPLY WSS-VAL-SMO1 BY INT-TIPE GIVING WSS-VAL-SMO1 ROUNDED
           SUBTRACT WSS-VAL-SMO1 FROM VEN-VAL-SFIN IN CAN-FLD GIVING    
                    RCV-SGV-FINA IN CAN-FLD ROUNDED.                    
      * RBG/INI/7-AUG-1996 Puse este Lavel para evitar el problema del E
       FIN-PRO-DESC-CIE-VENCT.                                          
      * La fecha FPAS solo es usada para no perder la FVEN inicial.     
           MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN.        
           MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN.        
           MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN.        
           MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN.        
      * RBG/FIN/7-AUG-1996                                              
       FIN-PRO-DESC-CIE-1VCTO.                                          
           EXIT.                                                        

      ******************************************************************

       PRO-DESC-CPE-1VCTO SECTION.
      ****************************

       INI-PRO-DESC-CPE-1VCTO.
      * RBG/INI/7-AUG-1996
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DPAS IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MPAS IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SPAS IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-APAS IN WSS-VARI.
      * Muevo la fecha FIMV a la FVEN para que procese en forma normal.
           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN.
      * RBG/FIN/7-AUG-1996

           IF (CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S')
              OR (CAN-SGV-TPAG IN CAN-FLD NOT > ZEROS)
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE.

           PERFORM PRO-UVCT-DVEG.
      *JSS 17-JAN-1992 (Memo.17-12-91)
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2
               MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2
               MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2
               MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2
           ELSE
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
      *
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE-VENCT.
           ADD 1 TO INT-TIPE.
           MOVE INT-TIPE TO WSS-INT-TIPE IN WSS-VARI.
      *JSS 17-JAN-1992 (Memo.17-12-91)
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               GO TO CON-PRO-DESC-CPE-1VCTO.
      *
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
                  GO TO CON-PRO-DESC-CPE-1VCTO.
      *DAD fin  11-MAY-1994
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
      *     PERFORM CAL-TIPE.
           PERFORM CAL-TIPE-DESC.
      *DAD fin  11-MAY-1994
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE-VENCT.
           SUBTRACT INT-TIPE FROM WSS-INT-TIPE GIVING WSS-INT-TIPE.
       CON-PRO-DESC-CPE-1VCTO.
           DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
                                      GIVING WSS-VAL-SMO4.
           DIVIDE WSS-VAL-SMO4 BY WSS-INT-TIPE GIVING
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                           RCV-SGV-CAPI IN CAN-FLD ROUNDED.
                                  RCV-SGV-CAPI IN CAN-FLD.
      *DAD fin  31-MAY-1994
      *
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.

      *RJZ INI  09-JUNIO-1995
      *DPM ini  14-OCT-1996
           MOVE SCR-SGV-IPFC TO SCR-SGV-INMO.
      *DPM fin  14-OCT-1996
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM GIVING SCR-SGV-INTN.
      *DPM ini  26-MAR-1997
           IF SCR-SGV-INTN > -1 AND
              SCR-SGV-INTN < 1
              MOVE ZEROES TO SCR-SGV-INTN.
      *DPM fin  26-MAR-1997

           IF WSS-CIC-TVAL = '0'
              MOVE SCR-SGV-INTN TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-INTN
              MOVE ZEROES TO SCR-SGV-INTM
              MOVE ZEROES TO SCR-SGV-INT.
      *RJZ FIN  09-JUNIO-1995
      *
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM VEN-VAL-SCAP IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE-VENCT.
           PERFORM PRO-UVCT-DVEG.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE-VENCT.
           ADD 1 TO INT-TIPE.
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *    MULTIPLY WSS-VAL-SMO1 BY INT-TIPE GIVING WSS-VAL-SMO1 ROUNDED
           MULTIPLY WSS-VAL-SMO1 BY INT-TIPE GIVING WSS-VAL-SMO1.
      *DAD fin  31-MAY-1994
           SUBTRACT WSS-VAL-SMO1 FROM VEN-VAL-SFIN IN CAN-FLD GIVING
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                           RCV-SGV-FINA IN CAN-FLD ROUNDED.
                                  RCV-SGV-FINA IN CAN-FLD.
      *DAD fin  31-MAY-1994
      *DAD ini  31-MAY-1994   (Memo.19-04-94 Pto.2)
           SUBTRACT RCV-SGV-FINA IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE-VENCT.
      *DAD fin  31-MAY-1994
      * RBG/INI/7-AUG-1996 Puse este Lavel para evitar el problema del E
       FIN-PRO-DESC-CPE-VENCT.
      * La fecha FPAS solo es usada para no perder la FVEN inicial.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO VEN-NUM-DVEN IN VEN.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO VEN-NUM-MVEN IN VEN.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO VEN-NUM-SVEN IN VEN.
           MOVE WSS-NUM-APAS IN WSS-VARI TO VEN-NUM-AVEN IN VEN.
      * RBG/FIN/7-AUG-1996
       FIN-PRO-DESC-CPE-1VCTO.
           EXIT.

      ******************************************************************

       VAL-TMAX-CONV SECTION.
      ***********************
       INI-VAL-TMAX-CONV.

      *DAD ini  29-JUL-1991
      *     IF CAN-FEC-FCAN IN CAN     > VEN-FEC-FVEN IN VEN AND
      *        CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN
      *         IF WSS-IBLK-TINT = 'S'
      *         MOVE ITR-SGV-TINT IN ITR TO ICG-SGV-TINT IN CAN-FLD
      *         IF ITR-COD-CVTI IN ITR > SPACES
      *             MOVE ITR-SGV-SPRD IN ITR TO ICG-SGV-TINT IN CAN-FLD
      *             GO TO FIN-VAL-TMAX-CONV
      *         ELSE
      *             GO TO FIN-VAL-TMAX-CONV.
      *DAD fin  29-JUL-1991
           MOVE 0 TO WSS-INT-TB90 WSS-INT-TS90 WSS-INT-TMAX.
           MOVE 'TAB'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'  TO TAB-CIC-TTAB IN TAB.
           MOVE '0999' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF OPC-COD-VCOC IN OPC = TAB-COD-CTAB IN TAB
               MOVE 'S' TO WSS-PESO
           ELSE
               MOVE 'N' TO WSS-PESO.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF OPC-MSC-TVOC IN OPC = MSC-COD-CMSC IN MSC
             MOVE WSS-IND-TMMN IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI
           ELSE
             MOVE WSS-IND-TMMX IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI.
           IF WSS-PESO-SI
               PERFORM BUS-CIC-PLZO
               IF WSS-PLZO-B90
                   MOVE FRM-SGV-TINT IN CAN-FLD TO WSS-INT-TB90
               ELSE
                   MOVE FRM-SGV-TINT IN CAN-FLD TO WSS-INT-TS90
           ELSE
               MOVE FRM-SGV-TINT IN CAN-FLD TO WSS-INT-TMAX.
           MOVE ZEROES              TO INT-TIPE.
           MOVE OPC-NUM-DCOL IN OPC TO INT-DDMA.
           MOVE OPC-NUM-MCOL IN OPC TO INT-MDMA.
           MOVE OPC-NUM-SCOL IN OPC TO INT-SDMA.
           MOVE OPC-NUM-ACOL IN OPC TO INT-ADMA.
           MOVE OPC-COD-VCOC IN OPC TO INT-VCAM.
           IF WSS-PESO-SI
               PERFORM VAL-TMXC-PESO
           ELSE
           IF WSS-IND-TMON = WSS-IND-TMMN
               PERFORM VAL-TMXC-MREA
           ELSE
               PERFORM VAL-TMXC-MEXT.
       FIN-VAL-TMAX-CONV.
           EXIT.

       VAL-TMXC-PESO SECTION.
       INI-VAL-TMXC-PESO.
           IF WSS-INT-TB90 NOT > 0
               GO TO TS9-VAL-TMXC-PESO.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE CAM-COD-MNAC           TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TB90'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAM$TB9NEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAM$TB9NVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           MOVE 'VMSS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30   TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-PESO.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CAN$TB9>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-VAL-TMXC-PESO
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-PESO.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
           MOVE 30       TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TB90.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30       TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TB90 > WSS-INT-TMXC
               MOVE 'CAN$TB9>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
      *
       TS9-VAL-TMXC-PESO.
           IF WSS-INT-TS90 NOT > 0
               GO TO FIN-VAL-TMXC-PESO.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE CAM-COD-MNAC           TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TS90'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAM$TS9NEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAM$TS9NVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           MOVE 'VMSS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30  TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-PESO.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CAN$TS9>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-VAL-TMXC-PESO
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-PESO.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
           MOVE 30       TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TS90.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TS90 > WSS-INT-TMXC
               MOVE 'CAN$TS9>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
       FIN-VAL-TMXC-PESO.
           EXIT.

       VAL-TMXC-MREA SECTION.
       INI-VAL-TMXC-MREA.
           IF WSS-INT-TMAX NOT > 0
               GO TO FIN-VAL-TMXC-MREA.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC    TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TMXC'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAMTMXCNEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAMTMXCNVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE 'VASS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30   TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-MREA.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CAN$TB9>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-VAL-TMXC-MREA
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-MREA.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE INT-TIPE TO WSS-INT-TMAX.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TMAX > WSS-INT-TMXC
               MOVE 'CANTMRJ>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
       FIN-VAL-TMXC-MREA.
           EXIT.

       VAL-TMXC-MEXT SECTION.
       INI-VAL-TMXC-MEXT.
           IF WSS-INT-TMAX NOT > 0
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE 'TMEX'                 TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TMXC'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAMTMXCNEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAMTMXCNVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           MOVE 'VASS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30     TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-MEXT.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CANTMEX>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-VAL-TMXC-MEXT
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-MEXT.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE INT-TIPE TO WSS-INT-TMAX.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TMAX > WSS-INT-TMXC
               MOVE 'CANTMEX>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
       FIN-VAL-TMXC-MEXT.
           EXIT.

       BUS-CIC-PLZO SECTION.
       INI-BUS-CIC-PLZO.
           MOVE 'VSN'         TO TAB-COD-TTAB IN TAB.
           MOVE 'CALMORAFMAV' TO TAB-COD-CTAB IN TAB.
           MOVE 'COL' TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FMV-BUS-CIC-PLZO.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NEX'        TO MSG-COD-MENS
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-CIC-PLZO.
           MOVE 'PZO'               TO TAB-COD-TTAB IN TAB.
           MOVE DLC-COD-PLZO IN DLC TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO WSS-PLZO
           ELSE
               MOVE 'TABPZO NEX' TO MSG-COD-MENS
               MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-BUS-CIC-PLZO.
       FMV-BUS-CIC-PLZO.
           MOVE DLC-KEY-IDLC IN DLC TO WSS-DLC-KEY-IDLC.
           MOVE ZEROS               TO WSS-DLC-FEC-FMAV.
           MOVE ZEROS               TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS         TO FIO-CMND.
       LUP-BUS-CIC-PLZO.
           PERFORM COL-FIO-DLC.
           IF NOT (FIO-STAT-OKS AND
                   DLC-CIC-IOPC IN DLC = WSS-DLC-CIC-IOPC)
               GO TO CON-BUS-CIC-PLZO.
           IF DLC-FEC-FMAV IN DLC > WSS-DLC-FEC-FMAV
               MOVE DLC-FEC-FMAV IN DLC TO WSS-DLC-FEC-FMAV.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-CIC-PLZO.
       CON-BUS-CIC-PLZO.
           MOVE OPC-NUM-DCOL IN OPC TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC TO FEC-AEC1.
           MOVE WSS-DLC-NUM-DMAV    TO FEC-DEC2.
           MOVE WSS-DLC-NUM-MMAV    TO FEC-MEC2.
           MOVE WSS-DLC-NUM-SMAV    TO FEC-SEC2.
           MOVE WSS-DLC-NUM-AMAV    TO FEC-AEC2.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-DIF-DIA         TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF FEC-NDIA < 90
               MOVE 'C1' TO WSS-PLZO
           ELSE
               MOVE 'S9' TO WSS-PLZO.
           MOVE WSS-DLC-KEY-IDLC TO DLC-KEY-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
       FIN-BUS-CIC-PLZO.
           EXIT.

       GLS-INT-TIPE SECTION.
       INI-GLS-INT-TIPE.
           MOVE 'TIPE'              TO ITR-COD-TINT IN ITR.
           MOVE 'TIPE'              TO SCR-COD-TICG.
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'INT'               TO TAB-COD-TTAB IN TAB.
           MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ITR-COD-TINT IN ITR NOT > SPACES
               MOVE 'TASA PERIODO' TO FRM-GLS-TINT IN CAN-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAN-FLD.
       FIN-GLS-INT-TIPE.
           EXIT.

      ******************************************************************
      * RBG/INI/20-NOV-1996
       LIM-TBAN SECTION.
      ****************
       INI-LIM-TBAN.
           MOVE 1 TO MOV-I.
       LUP-LIM-TBAN.
           IF MOV-I > 20
               GO TO FIN-LIM-TBAN.
           MOVE SPACES TO WSS-TBAN (MOV-I).
       SIG-LIM-TBAN.
           ADD 1 TO MOV-I.
           GO TO LUP-LIM-TBAN.
       FIN-LIM-TBAN.
           EXIT.
      * RBG/FIN/20-NOV-1996

      ******************************************************************
      * RBG/INI/20-NOV-1996
      * CHK-EXI-TBAN SECTION.
      *********************
      *INI-CHK-EXT-TBAN.
      *    MOVE 1 TO MOV-I.
      *LUP-VEC-TBAN.
      *    IF WSS-COD-BANC IN WSS-VARI = WSS-TBAN (MOV-I) AND
      *       WSS-COD-BANC IN WSS-VARI > SPACES
      *        MOVE 'S' TO WSS-IND-EBAN IN WSS-VARI
      *        GO TO FIN-CHK-EXT-TBAN.
      *    IF MOV-I = 20
      *        MOVE 'N' TO WSS-IND-EBAN IN WSS-VARI
      *        GO TO FIN-CHK-EXT-TBAN
      *    ELSE
      *        ADD 1 TO MOV-I
      *        GO TO LUP-VEC-TBAN.
      *FIN-CHK-EXT-TBAN.
      *    EXIT.
      * RBG/FIN/20-NOV-1996
      *-----------------------------------------------------*
      *INI-JGM 1-JUN-2000.
       CHK-EXI-TBAN-CCM SECTION.
      *********************
       INI-CHK-EXI-TBAN-CCM.
      * Calculo el monto del Total pago tope
      *$(0999 ) ->  UF(0998 )  TOPE DE LA RENTA.
           MOVE 'S' TO WSS-IND-EBAN IN WSS-VARI.

           MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999  '                 TO CAM-COD-VCAM IN CAM(2).
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO CAM-NUM-MCAM IN CAM(1).
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO CAM-NUM-SCAM IN CAM(1).
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE CAM-KEY-CAMB TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CHK-EXI-TBAN-CCM.


            MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM IN WSS-VARI.
      *
           IF  WSS-IND-SGAS IN WSS-VARI = 'N'
               DIVIDE  CAN-SGV-TPAG IN CAN-FLD
                   BY  WSS-SGV-VCAM IN WSS-VARI
               GIVING  WSS-VAL-TPUF IN WSS-VARI ROUNDED
           ELSE
           COMPUTE
           WSS-VAL-TPUF IN WSS-VARI ROUNDED =
           ( CAN-SGV-TPAG IN CAN-FLD - CAN-SGV-GAST IN CAN-FLD ) *
                   WSS-SGV-VCAM  IN WSS-VARI.
      *JGM
           MOVE SPACES       TO FRM-MEN1.
           MOVE SPACES       TO FRM-MEN2.
      *

       CONT-SIN-VCAM-DIF-DIA.
      * Calculo el numero de dias que hay entre la FCAN y FVEN
           MOVE VEN-NUM-DVEN IN CAN-FLD TO FEC-DEC1.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO FEC-MEC1.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO FEC-SEC1.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO FEC-AEC1.
      *
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.
      *
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
      *
           MOVE FEC-NDIA TO WSS-NUM-TOP1 IN WSS-VARI.
      *
           MOVE WSS-COD-BANC IN WSS-VARI TO WSS-GLS-TBAN IN WSS-VARI.
           MOVE WSS-NUM-TOP1 IN WSS-VARI TO WSS-GLS-NTRA IN WSS-VARI.
           MOVE WSS-VAL-TPUF IN WSS-VARI TO WSS-GLS-VTRA IN WSS-VARI.
      *
           MOVE 'COL'       TO TAB-COD-SIST FIO-SIST.
           MOVE 'CCM'       TO TAB-COD-TTAB IN TAB.
           MOVE WSS-GLS-CCM TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
       NXT-SGT-CCM.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO WSS-IND-EBAN IN WSS-VARI
              GO TO FIN-CHK-EXI-TBAN-CCM
           ELSE
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CCM IN WSS-VARI.
           IF  WSS-GLS-TBAN IN WSS-VARI NOT =
                               WSS-COD-TBAN IN WSS-VARI
               MOVE 'N' TO WSS-IND-EBAN IN WSS-VARI
              GO TO FIN-CHK-EXI-TBAN-CCM.
      *
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CCM IN WSS-VARI.
      *
           IF  TAB-COD-TTAB IN TAB = 'CCM' AND
               WSS-GLS-TBAN IN WSS-VARI =
                               WSS-COD-TBAN IN WSS-VARI AND
               WSS-NUM-TOP1 IN WSS-VARI NOT >
                                      WSS-NUM-TRAM IN WSS-VARI AND
               WSS-VAL-TPUF IN WSS-VARI NOT >
                                        WSS-VAL-TRAM IN WSS-VARI
               NEXT SENTENCE
           ELSE
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO NXT-SGT-CCM.
      *
           IF TAB-IND-VIGE IN TAB NOT = 'S'
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO NXT-SGT-CCM.

           MOVE TAB-GLS-DATA IN TAB      TO WSS-GLS-DATA IN WSS-VARI.
           MOVE WSS-NUM-TRAM IN WSS-VARI TO WSS-GLS-TOPE IN WSS-VARI.
      *---------------------------------------------------------*
      *
           IF WSS-NUM-DIAS IN WSS-VARI IS NOT NUMERIC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'INIDNONUMCCM' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CHK-EXI-TBAN-CCM.

           IF WSS-NUM-TOPE IN WSS-VARI IS NOT NUMERIC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'TOPDNONUMCCM' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CHK-EXI-TBAN-CCM.

           MOVE 'TAB'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'                    TO TAB-CIC-TTAB IN TAB.
           MOVE WSS-COD-MONE IN WSS-VARI TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'VLRCICCM NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC             TO FRM-MEN1
               MOVE WSS-COD-MONE IN WSS-VARI TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CHK-EXI-TBAN-CCM.
      *
           IF WSS-VAL-MOUF IN WSS-VARI NOT NUMERIC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'MOUFNONUMCCM' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CHK-EXI-TBAN-CCM.

       FIN-CHK-EXI-TBAN-CCM.
           EXIT.
      ******************************************************************
      * RBG/INI/12-AUG-1996
       CAL-NUM-DHBL SECTION.
      **********************

       INI-CAL-NUM-DHBL.
      *VAL-FEC Va sumando un dia habil hasta acumular 2.
           MOVE 1 TO WSS-NUM-1HBL IN WSS-VARI.
           MOVE 1 TO WSS-NUM-CONT IN WSS-VARI.
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DTOP IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MTOP IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-STOP IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-ATOP IN WSS-VARI.
      * Controlo si es Habil o No Habil.
      *VAL-FEC Validar Fecha.
           MOVE VEN-NUM-DVEN IN VEN TO FEC-ITM1.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-ITM2.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-ITM3.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE 'S' TO WSS-IND-FERI IN WSS-VARI
           ELSE
              MOVE 'N' TO WSS-IND-FERI IN WSS-VARI.
      * Ya Controle si es Habil o No Habil.
       SUM-DIA-SHBL.
           MOVE WSS-NUM-DTOP TO FEC-ITM1.
           MOVE WSS-NUM-MTOP TO FEC-ITM2.
           MOVE WSS-NUM-STOP TO FEC-ITM3.
           MOVE WSS-NUM-ATOP TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DTOP.
           MOVE FEC-ITM2 TO WSS-NUM-MTOP.
           MOVE FEC-ITM3 TO WSS-NUM-STOP.
           MOVE FEC-ITM4 TO WSS-NUM-ATOP.
      *VAL-FEC Validar Fecha.
           MOVE WSS-NUM-DTOP TO FEC-ITM1.
           MOVE WSS-NUM-MTOP TO FEC-ITM2.
           MOVE WSS-NUM-STOP TO FEC-ITM3.
           MOVE WSS-NUM-ATOP TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              GO TO SUM-DIA-SHBL.

           IF (WSS-NUM-CONT IN WSS-VARI = 1) AND
              (WSS-IND-FERI IN WSS-VARI = 'N')
                 GO TO FIN-CAL-NUM-DHBL.

           IF (WSS-NUM-CONT IN WSS-VARI = 2) AND
              (WSS-IND-FERI IN WSS-VARI = 'S')
                 GO TO FIN-CAL-NUM-DHBL
           ELSE
               ADD 1 TO WSS-NUM-CONT IN WSS-VARI
               GO TO SUM-DIA-SHBL.

       FIN-CAL-NUM-DHBL.
           EXIT.
      * RBG/FIN/12-AUG-1996

      ******************************************************************
      * RBG/INI/14-NOV-1996
       RST-DIA-HBLS SECTION.
      **********************
       INI-RST-DIA-HBLS.
      *
      *
           MOVE FEC-NDIA TO WSS-NUM-TOP1 IN WSS-VARI.
           IF WSS-NUM-TOP1 IN WSS-VARI > WSS-NUM-TOPE IN WSS-VARI
               MOVE 'N' TO WSS-IND-MORA IN WSS-VARI
               GO TO FIN-RST-DIA-HBLS.

      *VAL-FEC Va restando un dia habil hasta acumular 6.
           MOVE 'N' TO WSS-IND-MORA IN WSS-VARI.
           MOVE 1   TO WSS-NUM-CONT IN WSS-VARI.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-NUM-DTOP IN WSS-VARI.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-NUM-MTOP IN WSS-VARI.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-NUM-STOP IN WSS-VARI.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-NUM-ATOP IN WSS-VARI.
      * Resta 6 dias habiles y se salta los no habiles.
      *
       REST-DIA-HBLS.
           MOVE WSS-NUM-DTOP TO FEC-ITM1.
           MOVE WSS-NUM-MTOP TO FEC-ITM2.
           MOVE WSS-NUM-STOP TO FEC-ITM3.
           MOVE WSS-NUM-ATOP TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DTOP.
           MOVE FEC-ITM2 TO WSS-NUM-MTOP.
           MOVE FEC-ITM3 TO WSS-NUM-STOP.
           MOVE FEC-ITM4 TO WSS-NUM-ATOP.
      *VAL-FEC Validar Fecha.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              GO TO REST-DIA-HBLS.

           IF VEN-FEC-FVEN IN VEN     > WSS-FEC-FTOP IN WSS-VARI
               MOVE 'N' TO WSS-IND-MORA IN WSS-VARI
               GO TO FIN-RST-DIA-HBLS.

           IF (WSS-NUM-CONT IN WSS-VARI = WSS-NUM-DIAS IN WSS-VARI) AND
              (VEN-FEC-FVEN IN VEN     NOT > WSS-FEC-FTOP IN WSS-VARI)
                 MOVE 'S' TO WSS-IND-MORA IN WSS-VARI
                 GO TO FIN-RST-DIA-HBLS
           ELSE
               ADD 1 TO WSS-NUM-CONT IN WSS-VARI
               GO TO REST-DIA-HBLS.
       FIN-RST-DIA-HBLS.
           EXIT.
      * RBG/FIN/14-NOV-1996

      ******************************************************************

       CAL-TFPR-CAN SECTION.
       INI-CAL-TFPR-CAN.
           MOVE SPACES TO WSS-CMSG WSS-MENS.
      *Si VEN ya esta completo continua en el despliegue
           IF VEN-IND-CALC IN VEN NOT = 'N'
               GO TO DSP-CAL-TFPR-CAN.
      *
      *Debe calcular tasa de interes del periodo entre
      *MIN(MAX(FDEV,FVEN anterior o FCOL),VEN actual) y VEN actual,
      *entonces ...

      *En principio asume 0 para IDNI
           MOVE ZEROES TO WSS-VAL-IDNI IN WSS-VARI.
      *
      *Lee el documento asociado al vencimiento
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NEX' TO MSG-COD-MENS INT-CMSG
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CAL-TFPR-CAN.

      *Si es el primer vencimiento FMAX = MAX(FDEV,FCOL) y continua
           IF VEN-NUM-IVEN IN VEN = 1
               IF DLC-FEC-FDEV IN DLC > OPC-FEC-FCOL IN OPC
                   MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FMAX
                   GO TO CON-CAL-TFPR-CAN
               ELSE
                   MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FMAX
                   GO TO CON-CAL-TFPR-CAN.
      *
      *Lee vencimiento anterior ( pero antes asume FMAX como fecha
      *del actual por si ocurre un error al leer el anterior )
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FMAX.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           SUBTRACT 1             FROM VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FMAX
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
                                               IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FMAX
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
                                               IN WSS-VARI.
      *
      *Compara la fecha del DLC con la FVEN(FMAX) del VEN anterior
      *FMAX = MAX(FDEV,FVEN anterior) y continua
           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FMAX
               MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FMAX.
      *
      *Restaura el VEN actual
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
           ELSE
               PERFORM COL-FIO-VEN.
       CON-CAL-TFPR-CAN.
      *FUNO = MIN(CANDIDATO=MAX(FDEV,FCOL o FVEN anterior),FVEN actual)
           IF VEN-FEC-FVEN IN VEN < WSS-FEC-FMAX
               MOVE VEN-NUM-DVEN IN VEN TO INT-DUNO
               MOVE VEN-NUM-MVEN IN VEN TO INT-MUNO
               MOVE VEN-NUM-SVEN IN VEN TO INT-SUNO
               MOVE VEN-NUM-AVEN IN VEN TO INT-AUNO
           ELSE
               MOVE WSS-NUM-DMAX TO INT-DUNO
               MOVE WSS-NUM-MMAX TO INT-MUNO
               MOVE WSS-NUM-SMAX TO INT-SUNO
               MOVE WSS-NUM-AMAX TO INT-AUNO.
      *Carga FDOS, FCOL, FBTV, TINT, TIPT, VCAM y llama a rutina GNS-CAL
      *para obtener tasa de periodo
           MOVE VEN-NUM-DVEN IN VEN     TO INT-DDOS.
           MOVE VEN-NUM-MVEN IN VEN     TO INT-MDOS.
           MOVE VEN-NUM-SVEN IN VEN     TO INT-SDOS.
           MOVE VEN-NUM-AVEN IN VEN     TO INT-ADOS.

           MOVE OPC-NUM-DCOL IN OPC     TO INT-DCOL.
           MOVE OPC-NUM-MCOL IN OPC     TO INT-MCOL.
           MOVE OPC-NUM-SCOL IN OPC     TO INT-SCOL.
           MOVE OPC-NUM-ACOL IN OPC     TO INT-ACOL.

           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DBTV.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MBTV.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SBTV.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ABTV.

           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS uso de spread para calculo 1ra cuota (Memo.13/05/92)
           IF VEN-NUM-IVCT IN VEN = 1 AND
              INT-CVTI > SPACES AND INT-TFPR = 'C' AND
              SCR-SGV-SPR2 > 0
               MOVE 'COL'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE 'VSNLIQTMXCBCI' TO TAB-COD-TABL IN TAB
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                   MOVE SCR-SGV-SPR2 TO INT-SPR2.
      *
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.

      *SMC-INI 07.09.1993
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC
      *     PERFORM GNS-CAL-INT.
           PERFORM COL-CAL-INT.
      *SMC-FIN 09.09.1993
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-CAL-TFPR-CAN.
      *
           ADD WSS-VAL-SCRE IN WSS-VARI WSS-VAL-IDNI IN WSS-VARI
               GIVING WSS-VAL-INTE IN WSS-VARI.
           MULTIPLY WSS-VAL-INTE IN WSS-VARI BY INT-TIPE GIVING
                    WSS-VAL-INTE IN WSS-VARI ROUNDED.
           ADD WSS-VAL-IDNI IN WSS-VARI TO WSS-VAL-INTE IN WSS-VARI.
      *
      *Si el credito esta en moneda nacional ( no reajustable ), redonde
      *sin centavos el interes
           IF OPC-COD-VCOC IN OPC = CAM-COD-MNAC IN CAM-VARI
            MOVE WSS-VAL-INTE IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
            PERFORM PES-SCTV
            MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-INTE IN WSS-VARI.
      *
      *Si a la cuota le falta el valor final, lo completa con el interes
      *correspondiente
           IF VEN-VAL-FINA IN VEN = 0
               MOVE 'F' TO SCR-RCV-STAT
               ADD WSS-VAL-INTE IN WSS-VARI
                   VEN-VAL-CAPI IN VEN GIVING  VEN-VAL-FINA IN VEN
               MOVE VEN-VAL-FINA IN VEN     TO VEN-VAL-SFIN IN VEN
           ELSE
      *Si a la cuota le falta el valor capital, lo completa con el inter
      *correspondiente
            MOVE 'C' TO SCR-RCV-STAT
            SUBTRACT WSS-VAL-INTE IN WSS-VARI FROM
                     VEN-VAL-FINA IN VEN GIVING    VEN-VAL-CAPI IN VEN
            MOVE VEN-VAL-CAPI IN VEN          TO   VEN-VAL-SCAP IN VEN.

      *Verifica si el capital es mayor que el saldo del credito,
      *asume capital el saldo del credito
           IF VEN-VAL-SCAP IN VEN > WSS-VAL-SCRE IN WSS-VARI
               MOVE 'F' TO SCR-RCV-STAT
               MOVE WSS-VAL-SCRE IN WSS-VARI TO VEN-VAL-CAPI IN VEN
               MOVE VEN-VAL-CAPI IN VEN      TO VEN-VAL-SCAP IN VEN
               ADD WSS-VAL-INTE IN WSS-VARI
                   VEN-VAL-CAPI IN VEN GIVING  VEN-VAL-FINA IN VEN
               MOVE VEN-VAL-FINA IN VEN     TO VEN-VAL-SFIN IN VEN.

      *Si los intereses son mayores que el valor final ( esta situacion
      *puede dar solo cuando la cuota esta definida con valor final cono
      *por ahora se aborta
           IF WSS-VAL-INTE IN WSS-VARI > VEN-VAL-FINA IN VEN
               MOVE 'CANINTEFINA>' TO INT-CMSG MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-CAL-TFPR-CAN.

      *Si es la ultima cuota y el valor de capital es menor que el saldo
      *del credito, asume capital el saldo del credito
           IF VEN-FEC-FVEN IN VEN = DLC-FEC-FMAV IN DLC AND
              VEN-VAL-SCAP IN VEN < WSS-VAL-SCRE IN WSS-VARI
      *JSS 27-JAN-1992 (Memo.06-12-1991/Pto.1)
              AND ( OPC-IND-VSTR IN OPC = 'S' OR
                  ( SCR-MSC-FCAN = 'T' AND SCR-MSC-ECAN = 'T' ) )
      *
               MOVE 'F' TO SCR-RCV-STAT
               MOVE WSS-VAL-SCRE IN WSS-VARI TO VEN-VAL-CAPI IN VEN
               MOVE VEN-VAL-CAPI IN VEN      TO VEN-VAL-SCAP IN VEN
               ADD WSS-VAL-INTE IN WSS-VARI
                   VEN-VAL-CAPI IN VEN GIVING  VEN-VAL-FINA IN VEN
               MOVE VEN-VAL-FINA IN VEN     TO VEN-VAL-SFIN IN VEN.
      *
      *Si el credito esta en moneda nacional ( no reajustable ), redonde
      *sin centavos
           IF OPC-COD-VCOC IN OPC = CAM-COD-MNAC IN CAM-VARI
               MOVE VEN-VAL-CAPI IN VEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-CAPI IN VEN
               MOVE VEN-VAL-FINA IN VEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-FINA IN VEN.
      *
      *JSS 4-APR-1991 17:27:38
       DSP-CAL-TFPR-CAN.
      *En este punto el VEN esta completo

      *Despliega los datos del vencimiento que esta completando
      *si es CTE ( en caso de CTT se hace en el LUP correspondiente ) o
      *en el caso de ser un vencimiento ( ya que un CTT en este caso es
      *tratado como CTE )
           IF ( SCR-MSC-FCAN = 'T' AND SCR-MSC-ECAN = 'E' ) OR
              OPC-NUM-VCOR IN OPC = 1
               MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD
               MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD.
       FIN-CAL-TFPR-CAN.
      *ALD-BCI-INI/22.04.1999
       PRO-MORA-TXC SECTION.
       INI-PRO-MORA-TXC.
           PERFORM BUS-CIC-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-TXC.
           PERFORM DET-OPC-PRO-ORIG.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-TXC.
           MOVE WSS-PLZO                TO TXC-PLZO.
           MOVE OPC-COD-VCOC IN OPC     TO TXC-VCOC.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TXC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TXC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO TXC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TXC-AEC2.
           MOVE WSS-NUM-DUPM IN WSS-VARI TO TXC-DEC1.
           MOVE WSS-NUM-MUPM IN WSS-VARI TO TXC-MEC1.
           MOVE WSS-NUM-SUPM IN WSS-VARI TO TXC-SEC1.
           MOVE WSS-NUM-AUPM IN WSS-VARI TO TXC-AEC1.

           PERFORM TAB-BUS-TXC.

           IF TXC-CMSG > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE TXC-CMSG     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
      *         MOVE CAM-KEY-CAMB TO FRM-MEN2                           
               MOVE TXC-MEN2     TO FRM-MEN2                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-TXC.
           DIVIDE TXC-ATXC       BY 100 GIVING
                                 WSS-INT-TIPE ROUNDED.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1'          TO FRM-IND-TIPE IN CAN-FLD
               MOVE WSS-INT-TIPE TO INT-TIPE
               MULTIPLY WSS-INT-TIPE BY 100 GIVING ICG-SGV-TINT
                                             IN CAN-FLD
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               PERFORM GLS-INT-TIPE
               GO TO FIN-PRO-MORA-TXC.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               MOVE 'S' TO WSS-IBLK-TINT
               PERFORM GLS-INT-TIPE
               GO TO CMP-INT-TIPE-TXC.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE SPACES TO INT-CVTI.
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-TXC.
       CMP-INT-TIPE-TXC.
           IF INT-TIPE > WSS-INT-TIPE
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'CANTIPE>TXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR.
       FIN-PRO-MORA-TXC.
           EXIT.

      *AFRI-INI/06-2006
       OBT-OPE-ORI SECTION.
       INI-OBT-OPE-ORI.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM COL-FIO-OPC
           IF NOT FIO-STAT-OKS
               GO TO FIN-OBT-OPE-ORI.
      *    IF OPC-IND-RENO IN OPC NOT > SPACES
      *        MOVE WSS-CIC-IOPC IN WSS-VARI TO NOP-CIC-ORIG IN WSS-VARI
      *        GO TO FIN-OBT-OPE-ORI.
           MOVE SPACES TO ROV.
           MOVE SPACES TO NOP-CIC-ORIG IN WSS-VARI.
           MOVE SPACES TO NOP-1        IN WSS-VARI.
       NXT-OBT-OPE-ORI.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO ROV-CIC-IOPC IN ROV.
           MOVE ROV-CIC-IOPC IN ROV      TO NOP-COD-OPCR IN WSS-VARI.
       LUP-OBT-OPE-ORI.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    NOP-COD-OPCR  = ROV-CIC-IOPC IN ROV )
              GO TO FIN-OBT-OPE-ORI.
           IF NOP-1 = SPACES
              MOVE ROV-CIC-IOPV IN ROV TO  NOP-CIC-ORIG IN WSS-VARI
              MOVE 'N'                 TO  NOP-1.
           MOVE ROV-CIC-IOPV IN ROV TO DLC-CIC-IOPC IN DLC.
           MOVE ROV-CIC-IOPV IN ROV TO NOP-COD-OPCR IN WSS-VARI.
           MOVE 001                 TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
              GO TO FIN-OBT-OPE-ORI.
           MOVE ROV-CIC-IOPV IN ROV TO NOP-CIC-ORIG IN WSS-VARI.
           IF ( DLC-IND-SCTB IN DLC = SPACES OR 'MUL' )
                 MOVE ROV-CIC-IOPV IN ROV TO  NOP-CIC-ORIG IN WSS-VARI
                 GO TO FIN-OBT-OPE-ORI
           ELSE
              MOVE SPACES TO ROV
              MOVE NOP-COD-OPCR TO ROV-CIC-IOPC IN ROV
              GO TO LUP-OBT-OPE-ORI
           END-IF.
       FIN-OBT-OPE-ORI.
           EXIT.
      *AFRI-FIN/06-2006

       DET-OPC-PRO-ORIG SECTION.                                        
       INI-DET-OPC-PRO-ORIG.                                            
           MOVE FRM-SUAR-OKS TO FRM-SUAR.                               

      *AFRI-INI/06-2006
           IF DLC-IND-SCTB IN DLC = 'VCD' OR
              DLC-IND-SCTB IN DLC = 'CAS'
                 MOVE DLC-CIC-IOCO IN DLC TO WSS-CIC-IOPC
                 PERFORM OBT-OPE-ORI
                 MOVE NOP-CIC-ORIG IN WSS-VARI TO OPC-CIC-IOPC IN OPC
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM COL-FIO-OPC
                 GO TO NXT-DET-OPC-PRO-ORIG.
      *AFRI-FIN/06-2006

           IF OPC-IND-RENO IN OPC NOT = 'PRO'                           
               GO TO NXT-DET-OPC-PRO-ORIG.                              
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC.                    
           MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN1                            
               MOVE CAM-KEY-CAMB TO FRM-MEN2                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-DET-OPC-PRO-ORIG.                              
                                                                        
           MOVE 1                            TO CAM-SGV-VCAM IN CAM.    
           IF (WSS-CIC-VCAM NOT = '0998'
      *AFRI-INI/06-2006
             AND OPC-COD-VCOC IN OPC NOT = '0998')
      *AFRI-FIN/06-2006
               MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1)  
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(2)  
               MOVE OPC-NUM-DCOL IN OPC      TO CAM-NUM-DCAM IN CAM(1)  
               MOVE OPC-NUM-MCOL IN OPC      TO CAM-NUM-MCAM IN CAM(1)  
               MOVE OPC-NUM-SCOL IN OPC      TO CAM-NUM-SCAM IN CAM(1)  
               MOVE OPC-NUM-ACOL IN OPC      TO CAM-NUM-ACAM IN CAM(1)  
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
               IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')            
                   MOVE 'TAB'        TO MSG-COD-SIST                    
                   MOVE 'CAM    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MEN1                        
                   MOVE CAM-KEY-CAMB TO FRM-MEN2                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   MOVE WSS-CIC-IOPC TO OPC-CIC-IOPC IN OPC             
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM COL-FIO-OPC                                  
                   GO TO FIN-DET-OPC-PRO-ORIG.                          
           DIVIDE OPC-VAL-CRED IN OPC BY CAM-SGV-VCAM IN CAM            
                  GIVING                   TXC-MNTO ROUNDED.            
           MOVE WSS-CIC-IOPC TO OPC-CIC-IOPC IN OPC.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           GO TO FIN-DET-OPC-PRO-ORIG.                                  
       NXT-DET-OPC-PRO-ORIG.                                            
           MOVE 1                            TO CAM-SGV-VCAM IN CAM.    
           IF (WSS-CIC-VCAM NOT = '0998'
      *AFRI-INI/06-2006
             AND OPC-COD-VCOC IN OPC NOT = '0998')
      *AFRI-FIN/06-2006
               MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1)  
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(2)  
               MOVE OPC-NUM-DCOL IN OPC      TO CAM-NUM-DCAM IN CAM(1)  
               MOVE OPC-NUM-MCOL IN OPC      TO CAM-NUM-MCAM IN CAM(1)  
               MOVE OPC-NUM-SCOL IN OPC      TO CAM-NUM-SCAM IN CAM(1)  
               MOVE OPC-NUM-ACOL IN OPC      TO CAM-NUM-ACAM IN CAM(1)  
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
               IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')            
                   MOVE 'TAB'        TO MSG-COD-SIST                    
                   MOVE 'CAM    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MEN1                        
                   MOVE CAM-KEY-CAMB TO FRM-MEN2                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-DET-OPC-PRO-ORIG.                          
           DIVIDE OPC-VAL-CRED IN OPC BY CAM-SGV-VCAM IN CAM            
                  GIVING                   TXC-MNTO ROUNDED.            
       FIN-DET-OPC-PRO-ORIG.                                            
           EXIT.                                                        
      *ALD-BCI-FIN/22.04.1999
      * DPM INI  24.07.2000                                             
       VAL-CLASE-CON SECTION.                                           
      *---------------------                                            
       INI-VAL-CLASE-CON.                                               
           MOVE 'COL'               TO TAB-COD-SIST.                    
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.             
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-CAUX IN WSS-VARI.        
           IF WSS-COD-TOOC IN WSS-VARI = 'CON'                          
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI                       
           ELSE                                                         
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI.                      
       FIN-VAL-CLASE-CON.                                               
           EXIT.                                                        
      * DPM FIN  24.07.2000                                             
      *HZF-INI 13-10-2000                                               
       PRO-COM-IMP-CTE SECTION.                                         
       INI-PRO-COM-IMP-CTE.                                             
      * Calcula Comisiones                                              
           PERFORM CAL-COM-PCP.                                         
           IF PCP-CMSG > SPACES                                         
              MOVE PCP-CMSG TO MSG-COD-MENS IN MSG                      
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              MOVE ZEROES TO PCP-SUCO PCP-SUIM PCP-SUVP                 
              GO TO FIN-PRO-COM-IMP-CTE.                                
       FIN-PRO-COM-IMP-CTE.                                             
           EXIT.                                                        
      *HZF-FIN 13-10-2000                                               
                                                                        
      *LOP-INI 17-04-2003                                               
       VAL-OFCA-PTT SECTION.                                            
       INI-VAL-OFCA-PTT.                                                
                                                                        
           IF OPC-COD-OFOC IN CAN-FLD = CAN-COD-OFCA IN CAN-FLD         
              GO TO FIN-VAL-OFCA-PTT.                                   
                                                                        
           MOVE 'COL'                   TO FIO-SIST.                    
           MOVE 'PTT'                   TO TAB-COD-TTAB IN TAB.         
           MOVE '*  '                   TO TAB-COD-CTAB IN TAB.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'                
              MOVE OPC-COD-OFOC IN CAN-FLD TO CAN-COD-OFCA IN CAN-FLD   
              GO TO FIN-VAL-OFCA-PTT.                                   
                                                                        
           MOVE 'COL'                   TO FIO-SIST.                    
           MOVE 'PTT'                   TO TAB-COD-TTAB IN TAB.         
           MOVE CAN-COD-OFCA IN CAN-FLD TO TAB-COD-CTAB IN TAB.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'                
              MOVE OPC-COD-OFOC IN CAN-FLD TO CAN-COD-OFCA IN CAN-FLD   
              GO TO FIN-VAL-OFCA-PTT.                                   
                                                                        
       FIN-VAL-OFCA-PTT.                                                
           EXIT.                                                        
                                                                        
      *LOP-FIN 17-04-2003                                               
      *AFRI-INI LEY 19951                                               
       PRO-DESC-LEY SECTION.                                            
       INI-PRO-DESC-LEY.                                                

      *LOP-INI 23-03-2015 REVERSA DE IDNI
           IF DLC-VAL-IDNI IN DLC IS NOT NUMERIC
               MOVE ZEROES TO DLC-VAL-IDNI IN DLC.
      *LOP-FIN 23-03-2015 REVERSA DE IDNI

           PERFORM PRO-UVCT-DVEG.                                       
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.                    
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.                    
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.                    
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.                    
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.                    
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.                    
           MOVE 'S' TO WSS-IND-SPR2.                                    
           PERFORM CAL-TIPE.                                            
           IF INT-CMSG > SPACES                                         
               GO TO FIN-PRO-DESC-LEY.                                  
           IF SCR-MSC-FCAN = 'T' AND                                    
              SCR-MSC-ECAN = 'E'                                        
                COMPUTE SCR-SGV-IPFC =  ( OPC-VAL-SCRE IN CAN-FLD *     
                                          INT-TIPE)                     
                COMPUTE WSS-VAL-SVEN =    VEN-VAL-SCAP IN CAN-FLD +     
                                          SCR-SGV-IPFC                  
           ELSE                                                         
           IF SCR-MSC-FCAN = 'T' AND                                    
              SCR-MSC-ECAN = 'T'                                        
                COMPUTE WSS-VAL-SMO2 = VEN-VAL-SCAP IN CAN-FLD +        
      *LOP-INI 23-03-2015 REVERSA DE IDNI
                                       DLC-VAL-IDNI IN DLC +
                (( OPC-VAL-SCRE IN CAN-FLD + DLC-VAL-IDNI IN DLC ) *
      *                                ( OPC-VAL-SCRE IN CAN-FLD *
                                         INT-TIPE ).                    
      *LOP-FIN 23-03-2015 REVERSA DE IDNI
       FIN-PRO-DESC-LEY.                                                
           EXIT.                                                        
      *AFRI-INI                                                         
       PRO-TCAN-CNE SECTION.                                            
       INI-PRO-TCAN-CNE.                                                
           IF CAN-SGV-TPAG IN CAN-FLD > WSS-VAL-SVEN                    
               MOVE 'SGVTPAG>SVEN' TO MSG-COD-MENS                      
               MOVE FRM-SUAR-MAL        TO FRM-SUAR                     
               GO TO FIN-PRO-TCAN-CNE.                                  
           IF CAN-SGV-TPAG IN CAN-FLD = WSS-VAL-SVEN                    
               MOVE 'DEBEHACERCTE' TO MSG-COD-MENS                      
               MOVE FRM-SUAR-MAL        TO FRM-SUAR                     
               GO TO FIN-PRO-TCAN-CNE.                                  
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
           IF SCR-SGV-INTN < ZEROES
              MOVE ZEROES TO SCR-SGV-INTN.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
      *AFRI-INI                                                         
           IF WSS-CMSG = 'OFICONO'                                      
           COMPUTE WSS-VAL-CAPP = CAN-SGV-TPAG IN CAN-FLD -             
                                  SCR-SGV-INTM -                        
                                  SCR-SGV-INTN -                        
                                  DLC-VAL-IPEN IN DLC                   
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
                               -  SCR-SGV-CFGP
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
           ELSE                                                         
      *AFRI-FIN                                                         
           COMPUTE WSS-VAL-CAPP = CAN-SGV-TPAG IN CAN-FLD -             
                                  SCR-SGV-INTM -                        
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
      *                           SCR-SGV-INTN.
                                  SCR-SGV-INTN -
                                  SCR-SGV-CFGP.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
      *AFRI-INI                                                         
           IF WSS-CMSG = 'OFICONO'                                      
               MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-SMO1             
               IF WSS-VAL-SMO1 NOT > DLC-VAL-IPEN IN DLC                
                  AND DLC-VAL-IPEN IN DLC > ZEROES                      
                    MOVE LOW-VALUES TO CXE                              
                    MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD              
                    MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD              
                    MOVE ZEROES TO SCR-SGV-INTN                         
                    MOVE ZEROES TO RCV-SGV-INTM                         
                    MOVE ZEROES TO SCR-SGV-IPFC                         
                    MOVE OPC-NUM-DCOL IN OPC TO CAN-NUM-DCAN IN CAN-FLD 
                    MOVE OPC-NUM-MCOL IN OPC TO CAN-NUM-MCAN IN CAN-FLD 
                    MOVE OPC-NUM-SCOL IN OPC TO CAN-NUM-SCAN IN CAN-FLD 
                    MOVE OPC-NUM-ACOL IN OPC TO CAN-NUM-ACAN IN CAN-FLD 
                    MOVE CAN-FEC-FOUT IN CAN-FLD TO                     
                         CAN-FEC-FEGR IN CAN-FLD                        
                    MOVE CAN-SGV-TPAG IN CAN-FLD TO CXE-SGV-MCAL IN CXE 
                    PERFORM GRABA-CXE-CAN-IPEN                          
                    MOVE 'M' TO SCR-IND-PGTI                            
                    GO TO FIN-PRO-TCAN-CNE                              
               ELSE                                                     
                   MOVE LOW-VALUES TO CXE                               
                   SUBTRACT DLC-VAL-IPEN IN DLC FROM WSS-VAL-SMO1       
                   MOVE DLC-VAL-IPEN IN DLC TO CXE-SGV-MCAL IN CXE      
                   PERFORM GRABA-CXE-CAN-IPEN                           
           ELSE                                                         
               MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-SMO1.            
      *AFRI-INI                                                         
           IF WSS-VAL-SMO1 NOT > SCR-SGV-INTM                           
              AND SCR-SGV-INTM > ZEROES                                 
               MOVE 'M' TO SCR-IND-PGTI                                 
               PERFORM NUEVA-FCAN-MOR                                   
               MOVE WSS-VAL-SMO1 TO SCR-SGV-INTM                        
               MOVE ZEROES       TO SCR-SGV-INTN                        
               MOVE ZEROES       TO RCV-SGV-CAPI IN CAN-FLD             
               MOVE ZEROES       TO RCV-SGV-FINA IN CAN-FLD             
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
               MOVE ZEROES       TO SCR-SGV-CFGP
               MOVE ZEROES       TO SCR-SGV-CMFG
               MOVE ZEROES       TO CAN-SGV-COMI IN CAN-FLD
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
               GO TO FIN-PRO-TCAN-CNE.                                  
           SUBTRACT SCR-SGV-INTM FROM WSS-VAL-SMO1.                     
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
           MOVE ZEROES       TO CAN-SGV-COMI IN CAN-FLD.
           MOVE WSS-VAL-SMO1 TO GCN-TPAG.
           PERFORM PRO-COM-NOR-CIE
           IF GCN-CMSG = SPACES
               MOVE GCN-CONO TO SCR-SGV-CONO
               ADD GCN-CONO      TO CAN-SGV-COMI IN CAN-FLD
           ELSE
               MOVE ZEROES  TO SCR-SGV-CONO.
           SUBTRACT SCR-SGV-CONO FROM WSS-VAL-SMO1.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
           IF WSS-VAL-SMO1 NOT > SCR-SGV-INTN                           
              AND SCR-SGV-INTN > ZEROES                                 
               PERFORM DIF-DIA-DVEG                                     
               PERFORM NUEVA-FCAN-DEV                                   
               MOVE WSS-VAL-SMO1 TO SCR-SGV-INTN                        
               MOVE ZEROES       TO RCV-SGV-CAPI IN CAN-FLD             
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
               MOVE ZEROES       TO SCR-SGV-CFGP
               MOVE ZEROES       TO SCR-SGV-CMFG
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *        MOVE ZEROES       TO CAN-SGV-COMI IN CAN-FLD
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
               MOVE WSS-VAL-SMO1 TO RCV-SGV-FINA IN CAN-FLD             
               PERFORM CNV-VALOR                                        
               GO TO FIN-PRO-TCAN-CNE.                                  
           MOVE 'S' TO SCR-IND-PGTI.                                    
           SUBTRACT SCR-SGV-INTN FROM WSS-VAL-SMO1.                     
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
           COMPUTE WSS-SGV-CFGP = SCR-SGV-CFGP - SCR-SGV-CMFG.
           IF WSS-VAL-SMO1 NOT > WSS-SGV-CFGP
               MOVE WSS-VAL-SMO1 TO SCR-SGV-CFGP
               MOVE ZEROES       TO SCR-SGV-CMFG
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *        MOVE WSS-VAL-SMO1 TO CAN-SGV-COMI IN CAN-FLD
               ADD  WSS-VAL-SMO1 TO CAN-SGV-COMI IN CAN-FLD
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
               MOVE ZEROES       TO RCV-SGV-CAPI IN CAN-FLD
               MOVE SCR-SGV-INTN TO RCV-SGV-FINA IN CAN-FLD
               PERFORM CNV-VALOR
               GO TO FIN-PRO-TCAN-CNE.
           SUBTRACT WSS-SGV-CFGP FROM WSS-VAL-SMO1.
      *    IF WSS-VAL-SMO1 NOT > SCR-SGV-CMFG
           IF SCR-SGV-CMFG > ZEROES
               MOVE WSS-VAL-SMO1 TO LOC-VAL-TOTA
               PERFORM LOC-DET-MORA
               MOVE LOC-VAL-MCAN TO SCR-SGV-CMFG
               COMPUTE SCR-SGV-CFGP = WSS-SGV-CFGP + SCR-SGV-CMFG
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *        MOVE SCR-SGV-CFGP TO CAN-SGV-COMI IN CAN-FLD
               ADD  SCR-SGV-CFGP TO CAN-SGV-COMI IN CAN-FLD
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
               SUBTRACT SCR-SGV-CMFG FROM WSS-VAL-SMO1
               COMPUTE WSS-VAL-CAPP = LOC-VAL-TOTA - SCR-SGV-CMFG
               GO TO NXT-PRO-TCAN-CNE.
           SUBTRACT SCR-SGV-CMFG FROM WSS-VAL-SMO1.
       NXT-PRO-TCAN-CNE.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
      *CAPITAL EN PESOS                                                 
           IF WSS-VAL-SMO1 NOT > WSS-VAL-CAPP                           
               MOVE WSS-VAL-SMO1 TO RCV-SGV-CAPI IN CAN-FLD             
               MOVE WSS-VAL-SMO1 TO RCV-SGV-FINA IN CAN-FLD             
               ADD SCR-SGV-INTN  TO RCV-SGV-FINA IN CAN-FLD             
               PERFORM CNV-VALOR                                        
               GO TO FIN-PRO-TCAN-CNE.                                  
       FIN-PRO-TCAN-CNE.                                                
           EXIT.                                                        
       NUEVA-FCAN-MOR SECTION.                                          
       INI-NUEVA-FCAN-MOR.                                              
           COMPUTE WSS-DMOR ROUNDED = ( WSS-VAL-SMO1 * WSS-DIAM ) /     
                               SCR-SGV-INTM.                            
           MOVE WSS-DMOR     TO FEC-NDIA.                               
           MOVE WSS-NUM-DUPM TO FEC-ITM1.                               
           MOVE WSS-NUM-MUPM TO FEC-ITM2.                               
           MOVE WSS-NUM-SUPM TO FEC-ITM3.                               
           MOVE WSS-NUM-AUPM TO FEC-ITM4.                               
       LUP-NUEVA-FCAN-MOR.                                              
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-SUM-DIA  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           MOVE FEC-ITM1 TO WSS-NUM-DTOP.                               
           MOVE FEC-ITM2 TO WSS-NUM-MTOP.                               
           MOVE FEC-ITM3 TO WSS-NUM-STOP.                               
           MOVE FEC-ITM4 TO WSS-NUM-ATOP.                               
      *                                                                 
           MOVE WSS-NUM-DTOP TO FEC-ITM1.                               
           MOVE WSS-NUM-MTOP TO FEC-ITM2.                               
           MOVE WSS-NUM-STOP TO FEC-ITM3.                               
           MOVE WSS-NUM-ATOP TO FEC-ITM4.                               
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-S   TO FEC-FBLK.                               
           MOVE FEC-CHOY-N   TO FEC-CHOY.                               
           MOVE FEC-VHBL-S   TO FEC-VHBL.                               
           MOVE FEC-VAL-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF FEC-STAT-FER                                              
              MOVE 1    TO FEC-NDIA                                     
              MOVE WSS-NUM-DTOP TO FEC-ITM1                             
              MOVE WSS-NUM-MTOP TO FEC-ITM2                             
              MOVE WSS-NUM-STOP TO FEC-ITM3                             
              MOVE WSS-NUM-ATOP TO FEC-ITM4                             
              GO TO LUP-NUEVA-FCAN-MOR.                                 
           MOVE WSS-NUM-DTOP TO CAN-NUM-DCAN IN CAN-FLD.                
           MOVE WSS-NUM-MTOP TO CAN-NUM-MCAN IN CAN-FLD.                
           MOVE WSS-NUM-STOP TO CAN-NUM-SCAN IN CAN-FLD.                
           MOVE WSS-NUM-ATOP TO CAN-NUM-ACAN IN CAN-FLD.                
       FIN-NUEVA-FCAN-MOR.                                              
           EXIT.                                                        
       CNV-VALOR SECTION.                                               
       INI-CNV-VALOR.                                                   
           COMPUTE RCV-SGV-CAPI IN CAN-FLD ROUNDED =                    
                   RCV-SGV-CAPI IN CAN-FLD / SCR-SGV-VCAM.              
           COMPUTE RCV-SGV-FINA IN CAN-FLD ROUNDED =                    
                   RCV-SGV-FINA IN CAN-FLD / SCR-SGV-VCAM.              
       FIN-CNV-VALOR.                                                   
           EXIT.                                                        
       DIF-DIA-DVEG SECTION.                                            
       INI-DIF-DIA-DVEG.                                                
           PERFORM PRO-UVCT-DVEG.                                       
           MOVE VEN-NUM-DVEN IN CAN-FLD TO FEC-DEC2.                    
           MOVE VEN-NUM-MVEN IN CAN-FLD TO FEC-MEC2.                    
           MOVE VEN-NUM-SVEN IN CAN-FLD TO FEC-SEC2.                    
           MOVE VEN-NUM-AVEN IN CAN-FLD TO FEC-AEC2.                    
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-DIF-DIA  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           IF NOT FEC-STAT-OKS                                          
               MOVE ZEROES TO FEC-NDIA.                                 
           MOVE FEC-NDIA TO WSS-DIAM.                                   
       FIN-DIF-DIA-DVEG.                                                
           EXIT.                                                        
       NUEVA-FCAN-DEV SECTION.                                          
       INI-NUEVA-FCAN-DEV.                                              
           COMPUTE WSS-DMOR ROUNDED = ( WSS-VAL-SMO1 * WSS-DIAM ) /     
                                        SCR-SGV-INTN.                   
           MOVE WSS-DMOR     TO FEC-NDIA.                               
      *AFRI/ENERO2005-INI                                               
           MOVE DLC-NUM-DDEV IN DLC TO FEC-ITM1.                        
           MOVE DLC-NUM-MDEV IN DLC TO FEC-ITM2.                        
           MOVE DLC-NUM-SDEV IN DLC TO FEC-ITM3.                        
           MOVE DLC-NUM-ADEV IN DLC TO FEC-ITM4.                        
      *AFRI/ENERO2005-FIN                                               
       LUP-NUEVA-FCAN-DEV.                                              
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-SUM-DIA  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           MOVE FEC-ITM1 TO WSS-NUM-DTOP.                               
           MOVE FEC-ITM2 TO WSS-NUM-MTOP.                               
           MOVE FEC-ITM3 TO WSS-NUM-STOP.                               
           MOVE FEC-ITM4 TO WSS-NUM-ATOP.                               
      *                                                                 
           MOVE WSS-NUM-DTOP TO FEC-ITM1.                               
           MOVE WSS-NUM-MTOP TO FEC-ITM2.                               
           MOVE WSS-NUM-STOP TO FEC-ITM3.                               
           MOVE WSS-NUM-ATOP TO FEC-ITM4.                               
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-S   TO FEC-FBLK.                               
           MOVE FEC-CHOY-N   TO FEC-CHOY.                               
           MOVE FEC-VHBL-S   TO FEC-VHBL.                               
           MOVE FEC-VAL-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF FEC-STAT-FER                                              
              MOVE 1    TO FEC-NDIA                                     
              MOVE WSS-NUM-DTOP TO FEC-ITM1                             
              MOVE WSS-NUM-MTOP TO FEC-ITM2                             
              MOVE WSS-NUM-STOP TO FEC-ITM3                             
              MOVE WSS-NUM-ATOP TO FEC-ITM4                             
              GO TO LUP-NUEVA-FCAN-DEV.                                 
           MOVE WSS-FEC-FTOP TO SCR-FEC-FDEV.                           
       FIN-NUEVA-FCAN-DEV.                                              
           EXIT.                                                        
      *AFRI-INI                                                         
       DELETE-CXE-CAN-IPEN SECTION.                                     
       INI-DELETE-CXE-CAN-IPEN.                                         
           MOVE CAN-CAI-IOPC IN CAN-FLD TO CXE-CAI-IOPC IN CXE.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CXE-IIC-IOPC IN CXE.         
           MOVE 'CAN'                   TO CXE-COD-EVEN IN CXE.         
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CXE-NUM-EVEN IN CXE.         
           MOVE SPACES                  TO CXE-CIC-IOPV IN CXE.         
           MOVE ZEROES                  TO CXE-NUM-IVCT IN CXE.         
           MOVE SPACES                  TO CXE-COD-CPTO IN CXE.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-DELETE-CXE-CAN-IPEN.                                         
           PERFORM COL-FIO-CXE.                                         
           IF FIO-STAT-OKS AND                                          
              CAN-CAI-IOPC IN CAN-FLD = CXE-CAI-IOPC IN CXE AND         
              CAN-IIC-IOPC IN CAN-FLD = CXE-IIC-IOPC IN CXE AND         
              CXE-COD-EVEN IN CXE = 'CAN' AND                           
              CXE-NUM-EVEN IN CXE = CAN-NUM-ICAN IN CAN-FLD             
               IF CXE-COD-CPTO IN CXE = 'INTMOP'                        
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND                     
                   PERFORM COL-FIO-CXE                                  
                   MOVE FIO-DEL TO FIO-CMND                             
                   PERFORM COL-FIO-CXE                                  
                   GO TO FIN-DELETE-CXE-CAN-IPEN                        
               ELSE                                                     
                   MOVE FIO-GET-NXT TO FIO-CMND                         
                   GO TO LUP-DELETE-CXE-CAN-IPEN.                       
       FIN-DELETE-CXE-CAN-IPEN.                                         
           EXIT.                                                        
       GRABA-CXE-CAN-IPEN SECTION.                                      
       INI-GRABA-CXE-CAN-IPEN.                                          
           MOVE SPACES                  TO CXE-GLS-FLAG IN CXE.         
           MOVE CAN-CAI-IOPC IN CAN-FLD TO CXE-CAI-IOPC IN CXE.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CXE-IIC-IOPC IN CXE.         
           MOVE 'CAN'                   TO CXE-COD-EVEN IN CXE.         
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CXE-NUM-EVEN IN CXE.         
           MOVE SPACES                  TO CXE-CIC-IOPV IN CXE.         
           MOVE ZEROES                  TO CXE-NUM-IVCT IN CXE.         
           MOVE 'INTMOP'                TO CXE-COD-CPTO IN CXE.         
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM COL-FIO-CXE.                                         
       FIN-GRABA-CXE-CAN-IPEN.                                          
           EXIT.                                                        

      *AFRI-INI/LOF/CHC/07-2009
      *RESTAURA EL VALOR DE LA DLC
       RES-VAL-DLC SECTION.
       INI-RES-VAL-DLC.
           MOVE WSS-DLC-IOPC IN WSS-VARI TO DLC-CIC-IOPC IN DLC.
           MOVE WSS-DLC-IDLC IN WSS-VARI TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
       FIN-RES-VAL-DLC.
           EXIT.

      *INICIALIZA LAS VARIABLES DE ENTRADA A LA RUTINA LOC-COM-FGP
       SET-VAR-LOC SECTION.
       INI-SET-VAR-LOC.
           IF PCP NOT > SPACES
               MOVE ZEROES TO PCP-SUCO PCP-SUIM PCP-SUVP.
           MOVE ZEROES                  TO LOC-COM-FGPE IN LOC-VARI.
           MOVE ZEROES                  TO LOC-VAL-MCAN IN LOC-VARI.
           MOVE ZEROES                  TO LOC-VAL-MNTO IN LOC-VARI.
      *    MOVE OPC-COD-TOOC IN OPC     TO LOC-COD-TOOC IN LOC-VARI.
      *    MOVE OPC-COD-VCOC IN OPC     TO LOC-COD-VCOC IN LOC-VARI.
           MOVE CAN-SGV-TREN IN CAN-FLD TO LOC-SGV-TREN IN LOC-VARI.


           MOVE CAN-NUM-ICAN IN CAN-FLD TO LOC-NUM-ICAN IN LOC-VARI.
           MOVE VEN-NUM-IVCT IN CAN-FLD TO LOC-NUM-IVCT IN LOC-VARI.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO LOC-NUM-DCAN IN LOC-VARI.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO LOC-NUM-MCAN IN LOC-VARI.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO LOC-NUM-SCAN IN LOC-VARI.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO LOC-NUM-ACAN IN LOC-VARI.
           MOVE RCV-SGV-FINA IN CAN-FLD TO LOC-SGV-FINA IN LOC-VARI.
           MOVE RCV-SGV-CAPI IN CAN-FLD TO LOC-RCV-CAPI IN LOC-VARI.
           PERFORM GET-FHOY.
           MOVE HOY-FHOY IN HOY-VARI    TO LOC-FEC-FHOY IN LOC-VARI.
      *    MOVE OPC-VAL-CRED IN OPC     TO LOC-VAL-CRED IN LOC-VARI.
      *    MOVE OPC-VAL-SCRE IN OPC     TO LOC-VAL-SALD IN LOC-VARI.
      *    MOVE OPC-NUM-VCOR IN OPC     TO LOC-NUM-VCOR IN LOC-VARI.
      *    MOVE OPC-IND-GARA IN OPC     TO LOC-IND-GARA IN LOC-VARI.
      *    MOVE OPC-COD-CDOC IN OPC     TO LOC-COD-CDOC IN LOC-VARI.
           MOVE CAN-MSC-CANC IN CAN-FLD TO LOC-MSC-CANC IN LOC-VARI.
      *    MOVE OPC-FEC-FCOL IN OPC     TO LOC-FEC-FCOL IN LOC-VARI.
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
      *    MOVE VEN-NUM-DVEN IN VEN     TO LOC-NUM-DVEN IN LOC-VARI.
      *    MOVE VEN-NUM-MVEN IN VEN     TO LOC-NUM-MVEN IN LOC-VARI.
      *    MOVE VEN-NUM-SVEN IN VEN     TO LOC-NUM-SVEN IN LOC-VARI.
      *    MOVE VEN-NUM-AVEN IN VEN     TO LOC-NUM-AVEN IN LOC-VARI.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO LOC-NUM-DVEN IN LOC-VARI.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO LOC-NUM-MVEN IN LOC-VARI.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO LOC-NUM-SVEN IN LOC-VARI.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO LOC-NUM-AVEN IN LOC-VARI.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
      *AFRI-INI/LOF/ALD/06-2010
      *AFRI-INI/LOF/ALD/05-2010 ERROR CALCULO VCD
           IF BDO-SGV-CAPI IN BDO-VARI NOT > ZEROES
           MOVE VEN-VAL-CAPI IN VEN      TO LOC-VAL-CAPI IN LOC-VARI
           ELSE
           MOVE BDO-SGV-CAPI IN BDO-VARI TO LOC-VAL-CAPI IN LOC-VARI.
      *AFRI-FIN/LOF/ALD/05-2010 ERROR CALCULO VCD
      *AFRI-FIN/LOF/ALD/06-2010
       FIN-SET-VAR-LOC.
           EXIT.

      *DETERMINA SI EL CREDITO TIENE CUOTAS EN CARTERA VENCIDA
       DET-CUO-VCD SECTION.
       INI-DET-CUO-VCD.
           MOVE 'NOVCD' TO WSS-GLS-VCD IN WSS-VARI.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE ZEROES                  TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
            CAN-CAI-IOPC IN CAN-FLD = DLC-CAI-IOPC IN DLC AND
            CAN-IIC-IOPC IN CAN-FLD = DLC-IIC-IOPC IN DLC
               IF DLC-IND-SCTB IN DLC = 'VCD' OR
                DLC-IND-SCTB IN DLC = 'CAS'
                   MOVE 'SIVCD' TO WSS-GLS-VCD IN WSS-VARI
                   GO TO FIN-DET-CUO-VCD
               ELSE
                   NEXT SENTENCE
           ELSE
              NEXT SENTENCE.
       FIN-DET-CUO-VCD.
           EXIT.
      *AFRI-FIN/LOF/CHC/07-2009
      *AFRI-INI/CHC/OCT-2007/PTT-BGT
       VAL-COD-CAM SECTION.
       INI-VAL-COD-CAM.
           IF OPC-COD-VCOC IN OPC = '0999  '
               MOVE RCV-SGV-CAPI IN CAN-FLD TO CAN-SGV-TREN IN CAN-FLD
           ELSE
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE '0999  '                 TO CAM-COD-VCAM IN CAM(2)
               MOVE CAN-NUM-DCAN IN CAN-FLD  TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAN-NUM-MCAN IN CAN-FLD  TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAN-NUM-SCAN IN CAN-FLD  TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAN-NUM-ACAN IN CAN-FLD  TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE CAM-KEY-CAMB TO FRM-MEN2
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-COD-CAM
               ELSE
                   MULTIPLY RCV-SGV-CAPI IN CAN-FLD
                                                BY CAM-SGV-VCAM IN CAM
                                GIVING CAN-SGV-TREN IN CAN-FLD ROUNDED.
       FIN-VAL-COD-CAM.
           EXIT.
      *AFRI-FIN/CHC/OCT-2007/PTT-BGT

      *AFRI-INI/PSG/DIC-2008/HONORARIOS JUDICIALES
       PRO-HON-JUDI SECTION.
       INI-PRO-HON-JUDI.

           IF CAN-SGV-GAST IN CAN-FLD > ZEROES
               PERFORM JUD-BUS-CXE.

      *INICIALIZA VARIABLES
           PERFORM PRO-JUD-VARI.

      *LEE ENTIDADES DBC Y DLC
           PERFORM PRO-LEE-ENTI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               GO TO END-PRO-HON-JUDI.

      *ALMACENA TIPO DE BANCA
           PERFORM JUD-TIP-BANC.
           IF WSS-JUD-TBAN IN JUD-VARI = SPACES
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               GO TO END-PRO-HON-JUDI.

      *BUSCA CODIGOS MONEDA
           PERFORM OBT-COD-VLR.
           IF WSS-IND-CPES IN JUD-VARI = SPACES OR
            WSS-COD-UEFE IN JUD-VARI = SPACES
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               MOVE 'VLRCICCM NEX' TO MSG-COD-MENS
               GO TO END-PRO-HON-JUDI.

      *ALMACENA MONTO MINIMO HONORARIO, MONEDA, MONTO MAXIMO HONORARIO
           PERFORM JUD-OBT-MNTS.
           IF MSG-COD-MENS NOT = SPACES
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               MOVE 'ERRMNTOHJU' TO MSG-COD-MENS
               GO TO END-PRO-HON-JUDI.

      *LIMPIA VECTOR CON MONTOS Y PORCENTAJES
           PERFORM LIM-VECTOR.

      *TRANSFORMA A UF EL VALOR PAGADO
           IF CAN-MSC-CANC IN CAN-FLD = 'CIE'
             IF CAN-SGV-TPAG IN CAN-FLD > ZEROES
               MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-PAGA IN JUD-VARI
               GO TO CONT-OBT-VPAG
             ELSE
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               MOVE 'ERRVPAGHOJUD' TO MSG-COD-MENS
               GO TO END-PRO-HON-JUDI.
           IF CAN-SGV-TPAG IN CAN-FLD > ZEROES OR
              CAN-SGV-TREN IN CAN-FLD > ZEROES
               COMPUTE WSS-VAL-PAGA IN JUD-VARI =
                  CAN-SGV-TPAG IN CAN-FLD + CAN-SGV-TREN IN CAN-FLD
           ELSE
           IF WSS-VAL-SVEN > ZEROES
               MOVE WSS-VAL-SVEN TO WSS-VAL-PAGA IN JUD-VARI
           ELSE
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               MOVE 'ERRVPAGHOJUD' TO MSG-COD-MENS
               GO TO END-PRO-HON-JUDI.
       CONT-OBT-VPAG.
      *    IF CAN-MSC-CANC IN CAN-FLD = 'KTT'
      *      IF CAN-SGV-TPAG IN CAN-FLD > ZEROES
      *         COMPUTE WSS-VAL-PAGA IN JUD-VARI =
      *                 CAN-SGV-TPAG IN CAN-FLD + WSS-VAL-SVEN.
           MOVE WSS-VAL-PAGA IN JUD-VARI TO WSS-VAL-PAG2 IN JUD-VARI.
           PERFORM PRO-VAL-UEFE.

      *OBTIENE PORCENTAJE HONORARIO
           PERFORM JUD-TAB-BCJ.
      *AFRI/INI-FIN/PSG/DIC-2008/HONORARIOS JUDICIALES
           IF WSS-IND-PORC = 'S'
                MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
                MOVE 'ERRPORCHOJUD' TO MSG-COD-MENS
                GO TO END-PRO-HON-JUDI.

      *APLICA PORCENTAJE HONORARIO
           PERFORM JUD-APL-PORC.

      *AFRI-INI/PSG/DIC-2008/HONORARIOS JUDICIALES
      *TRANSFORMA A PESO
      *    IF WSS-GLS-MONE IN JUD-VARI = WSS-COD-UEFE IN JUD-VARI
               PERFORM PRO-VAL-PESO.
      *AFRI-FIN/PSG/DIC-2008/HONORARIOS JUDICIALES

           GO TO FIN-PRO-HON-JUDI.

       END-PRO-HON-JUDI.
           IF WSS-JUD-ERRO IN JUD-VARI = 'S'
               MOVE 'COL'        TO MSG-COD-SIST                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           

       FIN-PRO-HON-JUDI.
           EXIT.                                                        

       PRO-HON-JUDI-CIE SECTION.
       INI-PRO-HON-JUDI-CIE.

      *INICIALIZA VARIABLES
           PERFORM PRO-JUD-VARI.

      *LEE ENTIDADES DBC Y DLC
           PERFORM PRO-LEE-ENTI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               GO TO END-PRO-HON-JUDI-CIE.

      *ALMACENA TIPO DE BANCA
           PERFORM JUD-TIP-BANC.
           IF WSS-JUD-TBAN IN JUD-VARI = SPACES
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               GO TO END-PRO-HON-JUDI-CIE.

      *BUSCA CODIGOS MONEDA
           PERFORM OBT-COD-VLR.
           IF WSS-IND-CPES IN JUD-VARI = SPACES OR
            WSS-COD-UEFE IN JUD-VARI = SPACES
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               MOVE 'VLRCICCM NEX' TO MSG-COD-MENS
               GO TO END-PRO-HON-JUDI-CIE.

      *ALMACENA MONTO MINIMO HONORARIO, MONEDA, MONTO MAXIMO HONORARIO
           PERFORM JUD-OBT-MNTS.
           IF MSG-COD-MENS NOT = SPACES
               MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
               MOVE 'ERRMNTOHJU' TO MSG-COD-MENS
               GO TO END-PRO-HON-JUDI.

      *LIMPIA VECTOR CON MONTOS Y PORCENTAJES
           PERFORM LIM-VECTOR.

      *TRANSFORMA A UF EL VALOR PAGADO
           MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-PAGA IN JUD-VARI.
           MOVE WSS-VAL-PAGA IN JUD-VARI TO WSS-VAL-PAG2 IN JUD-VARI.
           PERFORM PRO-VAL-UEFE.

      *OBTIENE PORCENTAJE HONORARIO
           PERFORM JUD-TAB-BCJ-CIE.
           IF WSS-IND-PORC = 'S'
                MOVE 'S' TO WSS-JUD-ERRO IN JUD-VARI
                MOVE 'ERRPORCHOJUD' TO MSG-COD-MENS
                GO TO END-PRO-HON-JUDI-CIE.

      *APLICA PORCENTAJE HONORARIO
           PERFORM JUD-APL-PORC-CIE.

      *TRANSFORMA A PESO
           PERFORM PRO-VAL-PESO.

           GO TO FIN-PRO-HON-JUDI-CIE.

       END-PRO-HON-JUDI-CIE.
           IF WSS-JUD-ERRO IN JUD-VARI = 'S'
               MOVE 'COL'        TO MSG-COD-SIST                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           

       FIN-PRO-HON-JUDI-CIE.
           EXIT.                                                        
      *AFRI-FIN/PSG/DIC-2008/HONORARIOS JUDICIALES

       PRO-LEE-ENTI SECTION.                                            
       INI-PRO-LEE-ENTI.                                                
           MOVE SPACES TO MSG-COD-MENS.

           MOVE CAN-CAI-IOPC IN CAN-FLD TO RDC-CAI-IOPC IN RDC.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO RDC-IIC-IOPC IN RDC.         
           MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.                             
           PERFORM COL-FIO-RDC.                                         
           IF NOT (FIO-STAT-OKS AND                                     
            CAN-CAI-IOPC IN CAN-FLD = RDC-CAI-IOPC IN RDC AND           
            CAN-IIC-IOPC IN CAN-FLD = RDC-IIC-IOPC IN RDC)              
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'CLI    NORDC' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-PRO-LEE-ENTI.                                  
                                                                        
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'RDC    NOCLI' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           

       FIN-PRO-LEE-ENTI.
           EXIT.                                                        

       OBT-COD-VLR SECTION.                                             
       INI-OBT-COD-VLR.                                                 
           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.                
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
               MOVE SPACES TO WSS-IND-CPES IN JUD-VARI
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO WSS-IND-CPES IN JUD-VARI.    

           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.                
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
               MOVE SPACES TO WSS-COD-UEFE IN JUD-VARI
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN JUD-VARI.    
       FIN-OBT-COD-VLR.                                                 
           EXIT.                                                        

       PRO-VAL-UEFE SECTION.
       INI-PRO-VAL-UEFE.
           MOVE WSS-COD-UEFE IN JUD-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-IND-CPES IN JUD-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO CAM-NUM-MCAM IN CAM(1).     
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO CAM-NUM-SCAM IN CAM(1).     
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO CAM-NUM-ACAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')                 
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'CAM    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-PRO-VAL-UEFE                                    
           ELSE                                                         
              DIVIDE WSS-VAL-PAGA IN JUD-VARI BY CAM-SGV-VCAM IN CAM    
                                GIVING WSS-VAL-PAGA IN JUD-VARI ROUNDED.
       FIN-PRO-VAL-UEFE.
           EXIT.                                                        

       PRO-VAL-UEF2 SECTION.
       INI-PRO-VAL-UEF2.
           MOVE WSS-COD-UEFE IN JUD-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-IND-CPES IN JUD-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO CAM-NUM-MCAM IN CAM(1).     
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO CAM-NUM-SCAM IN CAM(1).     
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO CAM-NUM-ACAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')                 
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'CAM    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-PRO-VAL-UEF2                                    
           ELSE                                                         
      *AFRI-INI/PSG/DIC-2008/HONORARIOS JUDICIALES
      *       DIVIDE WSS-SGV-HCJU IN JUD-VARI BY CAM-SGV-VCAM IN CAM    
      *                         GIVING WSS-SGV-HCJU IN JUD-VARI ROUNDED.
              COMPUTE WSS-SGV-HCJU IN JUD-VARI ROUNDED =
                    CAM-SGV-VCAM IN CAM  * WSS-SGV-HCJU IN JUD-VARI.
      *AFRI-FIN/PSG/DIC-2008/HONORARIOS JUDICIALES
       FIN-PRO-VAL-UEF2.
           EXIT.                                                        

       PRO-JUD-VARI SECTION.
       INI-PRO-JUD-VARI.
           MOVE 'N'    TO WSS-JUD-ERRO IN JUD-VARI.                     
           MOVE SPACES TO WSS-IND-CPES IN JUD-VARI.                     
           MOVE SPACES TO WSS-COD-UEFE IN JUD-VARI.                     
           MOVE SPACES TO WSS-JUD-TBAN IN JUD-VARI.                     
           MOVE SPACES TO WSS-BCJ-CODI IN JUD-VARI.                     
           MOVE ZEROES TO WSS-SGV-MTRA IN JUD-VARI.                     
           MOVE ZEROES TO WSS-SGV-HCJU IN JUD-VARI.                     
           MOVE ZEROES TO WSS-VAL-PAGA IN JUD-VARI.                     
           MOVE ZEROES TO WSS-VAL-PAG2 IN JUD-VARI.                     
           MOVE SPACES TO WSS-GLS-BCJ2 IN JUD-VARI.                     
           MOVE SPACES TO WSS-GLS-PORC IN JUD-VARI.                     
           MOVE ZEROES TO WSS-TRA-POR1 IN JUD-VARI.                     
           MOVE ZEROES TO WSS-TRA-POR2 IN JUD-VARI.                     
           MOVE SPACES TO WSS-GLS-1MIN IN JUD-VARI.                     
           MOVE ZEROES TO WSS-SGV-MMIN IN JUD-VARI.                     
           MOVE SPACES TO WSS-GLS-1MAX IN JUD-VARI.                     
           MOVE ZEROES TO WSS-SGV-MMAX IN JUD-VARI.                     
           MOVE SPACES TO WSS-GLS-BCJ1 IN JUD-VARI.                     
       FIN-PRO-JUD-VARI.
           EXIT.                                                        

       PRO-VAL-PESO SECTION.
       INI-PRO-VAL-PESO.
           MOVE WSS-COD-UEFE IN JUD-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-IND-CPES IN JUD-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO CAM-NUM-MCAM IN CAM(1).     
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO CAM-NUM-SCAM IN CAM(1).     
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO CAM-NUM-ACAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')                 
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'CAM    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-PRO-VAL-PESO                                    
           ELSE                                                         
              MULTIPLY WSS-SGV-HCJU IN JUD-VARI BY CAM-SGV-VCAM IN CAM  
                                GIVING WSS-SGV-HCJU IN JUD-VARI ROUNDED 
              MOVE WSS-SGV-HCJU IN JUD-VARI TO PES-SGV-DECI IN PES-VARI 
              PERFORM PES-SCTV                                          
              MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-HCJU IN JUD-VARI.
       FIN-PRO-VAL-PESO.
           EXIT.                                                        

      *AFRI-INI/PSG/DIC-2008/HONORARIOS JUDICIALES
       JUD-APL-PORC SECTION.
       INI-JUD-APL-PORC.

           SET WSS-NUM-PORC TO 1.
       LUP-APL-PORC.
           IF (WSS-NUM-PORC > 5)
               GO TO VCAM-TOTAL.

           IF VPOR-NUM-MTRA(WSS-NUM-PORC) NOT > ZEROES                  
               GO TO VCAM-TOTAL.

           MOVE VPOR-NUM-VALP(WSS-NUM-PORC) TO
                                    WSS-TRA-POR2 IN JUD-VARI
           DIVIDE WSS-TRA-POR2 IN JUD-VARI BY 100
                                GIVING WSS-TRA-POR2 IN JUD-VARI

           IF  WSS-VAL-PAGA IN JUD-VARI NOT <
                                    VPOR-NUM-MTRA(WSS-NUM-PORC)

                  COMPUTE WSS-SGV-HCJU IN JUD-VARI =
                          WSS-SGV-HCJU IN JUD-VARI  +
                          (VPOR-NUM-MTRA(WSS-NUM-PORC) -
                           VPOR-NUM-MANT(WSS-NUM-PORC)) *
                           WSS-TRA-POR2 IN JUD-VARI
                  GO TO SALIR.
           IF WSS-VAL-PAGA IN JUD-VARI >
                                    VPOR-NUM-MANT(WSS-NUM-PORC)
              AND WSS-VAL-PAGA IN JUD-VARI <
                                    VPOR-NUM-MTRA(WSS-NUM-PORC)

                  COMPUTE WSS-SGV-HCJU IN JUD-VARI =
                          WSS-SGV-HCJU IN JUD-VARI  +
                          ((WSS-VAL-PAGA IN JUD-VARI -
                           VPOR-NUM-MANT(WSS-NUM-PORC)) *
                           WSS-TRA-POR2 IN JUD-VARI)
                  GO TO SALIR.
       SALIR.
           IF (WSS-NUM-PORC > 5)
               SET WSS-NUM-PORC TO 1
               GO TO VCAM-TOTAL
           ELSE
               SET WSS-NUM-PORC UP BY 1
               GO TO LUP-APL-PORC.
       VCAM-TOTAL.

           IF WSS-SGV-HCJU IN JUD-VARI < WSS-SGV-MMIN IN JUD-VARI
              MOVE WSS-SGV-MMIN IN JUD-VARI TO
                                         WSS-SGV-HCJU IN JUD-VARI.
           IF WSS-SGV-HCJU IN JUD-VARI > WSS-SGV-MMAX IN JUD-VARI
              MOVE WSS-SGV-MMAX IN JUD-VARI TO
                                         WSS-SGV-HCJU IN JUD-VARI.

      *    IF WSS-GLS-MONE IN JUD-VARI = WSS-COD-UEFE IN JUD-VARI
      *    PERFORM PRO-VAL-UEF2.

       FIN-JUD-APL-PORC.
           EXIT.                                                        
       JUD-APL-PORC-CIE SECTION.
       INI-JUD-APL-PORC-CIE.

           SET WSS-NUM-PORC TO 1.
       LUP-APL-PORC-CIE.
           IF (WSS-NUM-PORC > 5)
               GO TO VCAM-TOTAL-CIE.

           IF VPOR-NUM-MTRA(WSS-NUM-PORC) NOT > ZEROES                  
               GO TO VCAM-TOTAL-CIE.

           MOVE VPOR-NUM-VALP(WSS-NUM-PORC) TO
                                    WSS-TRA-POR2 IN JUD-VARI
           DIVIDE WSS-TRA-POR2 IN JUD-VARI BY 100
                                GIVING WSS-TRA-POR2 IN JUD-VARI

           IF  WSS-VAL-PAGA IN JUD-VARI NOT <
                                    VPOR-NUM-MTRA(WSS-NUM-PORC)

                  COMPUTE WSS-SGV-HCJU IN JUD-VARI =
                          WSS-SGV-HCJU IN JUD-VARI  +
                      ((((VPOR-NUM-MTRA(WSS-NUM-PORC) -
                          VPOR-NUM-MANT(WSS-NUM-PORC)) *
                          WSS-TRA-POR2 IN JUD-VARI))/( 1 +
                          WSS-TRA-POR2 IN JUD-VARI))
                  GO TO SALIR-CIE.
           IF WSS-VAL-PAGA IN JUD-VARI >
                                    VPOR-NUM-MANT(WSS-NUM-PORC)
              AND WSS-VAL-PAGA IN JUD-VARI <
                                    VPOR-NUM-MTRA(WSS-NUM-PORC)

                  COMPUTE WSS-SGV-HCJU IN JUD-VARI =
                          WSS-SGV-HCJU IN JUD-VARI  +
                        ((((WSS-VAL-PAGA IN JUD-VARI -
                           VPOR-NUM-MANT(WSS-NUM-PORC)) *
                           WSS-TRA-POR2 IN JUD-VARI)) / ( 1 +
                           WSS-TRA-POR2 IN JUD-VARI))
                  GO TO SALIR-CIE.
       SALIR-CIE.
           IF (WSS-NUM-PORC > 5)
               SET WSS-NUM-PORC TO 1
               GO TO VCAM-TOTAL-CIE
           ELSE
               SET WSS-NUM-PORC UP BY 1
               GO TO LUP-APL-PORC-CIE.
       VCAM-TOTAL-CIE.

           IF WSS-SGV-HCJU IN JUD-VARI < WSS-SGV-MMIN IN JUD-VARI
              MOVE WSS-SGV-MMIN IN JUD-VARI TO
                                         WSS-SGV-HCJU IN JUD-VARI.
           IF WSS-SGV-HCJU IN JUD-VARI > WSS-SGV-MMAX IN JUD-VARI
              MOVE WSS-SGV-MMAX IN JUD-VARI TO
                                         WSS-SGV-HCJU IN JUD-VARI.

      *    IF WSS-GLS-MONE IN JUD-VARI = WSS-COD-UEFE IN JUD-VARI
      *    PERFORM PRO-VAL-UEF2.

       FIN-JUD-APL-PORC-CIE.
           EXIT.                                                        

       JUD-TAB-BCJ SECTION.
       INI-JUD-TAB-BCJ.
           MOVE 'COL'                    TO FIO-SIST.
           MOVE 'BCJ'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-JUD-TBAN IN JUD-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-TAB-BCJ.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' AND
                   TAB-COD-TTAB IN TAB = 'BCJ')
              GO TO FIN-JUD-TAB-BCJ.

           MOVE TAB-COD-CTAB IN TAB TO WSS-BCJ-CODI IN JUD-VARI.
           IF NOT (WSS-JUD-TBAN IN JUD-VARI = WSS-BCJ-TBAN IN JUD-VARI)
              GO TO NXT-TAB-BCJ.

           MOVE TAB-GLS-DATA TO WSS-GLS-PORC IN JUD-VARI.
           IF WSS-BCJ-MTRA IN JUD-VARI IS NUMERIC
              MOVE WSS-BCJ-MTRA IN JUD-VARI TO WSS-SGV-MTRA IN JUD-VARI
              IF WSS-GLS-PORC IN JUD-VARI IS NUMERIC AND
                                 WSS-TRA-POR1 IN JUD-VARI > ZEROES
                 PERFORM GRB-VPOR
                 GO TO NXT-TAB-BCJ
              ELSE
                 MOVE 'S' TO WSS-IND-PORC IN JUD-VARI
                 GO TO NXT-TAB-BCJ.

       NXT-TAB-BCJ.
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-TAB-BCJ.
       FIN-JUD-TAB-BCJ.
           EXIT.                                                        
       JUD-TAB-BCJ-CIE SECTION.
       INI-JUD-TAB-BCJ-CIE.
           MOVE 'COL'                    TO FIO-SIST.
           MOVE 'BCJ'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-JUD-TBAN IN JUD-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-TAB-BCJ-CIE.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' AND
                   TAB-COD-TTAB IN TAB = 'BCJ')
              GO TO FIN-JUD-TAB-BCJ-CIE.

           MOVE TAB-COD-CTAB IN TAB TO WSS-BCJ-CODI IN JUD-VARI.
           IF NOT (WSS-JUD-TBAN IN JUD-VARI = WSS-BCJ-TBAN IN JUD-VARI)
              GO TO NXT-TAB-BCJ-CIE.

           MOVE TAB-GLS-DATA TO WSS-GLS-PORC IN JUD-VARI.
           IF WSS-BCJ-MTRA IN JUD-VARI IS NUMERIC
              MOVE WSS-BCJ-MTRA IN JUD-VARI TO WSS-SGV-MTRA IN JUD-VARI
              IF WSS-GLS-PORC IN JUD-VARI IS NUMERIC AND
                                 WSS-TRA-POR1 IN JUD-VARI > ZEROES
                 PERFORM GRB-VPOR-CIE
                 GO TO NXT-TAB-BCJ-CIE
              ELSE
                 MOVE 'S' TO WSS-IND-PORC IN JUD-VARI
                 GO TO NXT-TAB-BCJ-CIE.

       NXT-TAB-BCJ-CIE.
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-TAB-BCJ-CIE.
       FIN-JUD-TAB-BCJ-CIE.
           EXIT.                                                        
      *AFRI-FIN/PSG/DIC-2008/HONORARIOS JUDICIALES

       JUD-OBT-MNTS SECTION.
       INI-JUD-OBT-MNTS.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE 'COL'                    TO FIO-SIST.
           MOVE 'BCJ'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-JUD-TBAN IN JUD-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' AND
            WSS-JUD-TBAN IN JUD-VARI = TAB-COD-CTAB IN TAB)
             MOVE 'ERR HONOJUDI' TO MSG-COD-MENS
             GO TO FIN-JUD-OBT-MNTS
           ELSE
             MOVE TAB-GLS-DATA TO WSS-GLS-BCJ1 IN JUD-VARI
             MOVE WSS-GLS-MMIN IN JUD-VARI TO WSS-GLS-1MIN IN JUD-VARI
             MOVE WSS-GLS-MMAX IN JUD-VARI TO WSS-GLS-1MAX IN JUD-VARI
             IF WSS-GLS-MMIN IN JUD-VARI IS NOT NUMERIC AND
              WSS-GLS-MMAX IN JUD-VARI IS NOT NUMERIC
                MOVE 'ERR HONOJUDI' TO MSG-COD-MENS
                GO TO FIN-JUD-OBT-MNTS.

      *    IF WSS-GLS-MONE IN JUD-VARI NOT = WSS-COD-UEFE IN JUD-VARI
      *     PERFORM PRO-MOD-MNTO.
       FIN-JUD-OBT-MNTS.
           EXIT.                                                        

       PRO-LEE-JDLC SECTION.
       INI-PRO-LEE-JDLC.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC.         
           MOVE ZEROES                  TO DLC-NUM-IDLC IN DLC.         
           MOVE FIO-GET-NLS             TO FIO-CMND.                    
           PERFORM COL-FIO-DLC.                                         
           IF NOT (FIO-STAT-OKS AND                                     
            CAN-CAI-IOPC IN CAN-FLD = DLC-CAI-IOPC IN DLC AND           
            CAN-IIC-IOPC IN CAN-FLD = DLC-IIC-IOPC IN DLC)              
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'DLC   INEX' TO MSG-COD-MENS
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               PERFORM BCK-OUT.
       FIN-PRO-LEE-JDLC.
           EXIT.                                                        

       PRO-MOD-MNTO SECTION.
       INI-PRO-MOD-MNTO.
           MOVE WSS-COD-UEFE IN JUD-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-IND-CPES IN JUD-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO CAM-NUM-MCAM IN CAM(1).     
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO CAM-NUM-SCAM IN CAM(1).     
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO CAM-NUM-ACAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')                 
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'CAM    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-PRO-MOD-MNTO                                    
           ELSE                                                         
              DIVIDE WSS-SGV-MMIN IN JUD-VARI BY CAM-SGV-VCAM IN CAM    
                                GIVING WSS-SGV-MMIN IN JUD-VARI ROUNDED 
              DIVIDE WSS-SGV-MMAX IN JUD-VARI BY CAM-SGV-VCAM IN CAM    
                                GIVING WSS-SGV-MMAX IN JUD-VARI ROUNDED.
       FIN-PRO-MOD-MNTO.
           EXIT.                                                        

       JUD-TIP-BANC SECTION.
       INI-JUD-TIP-BANC.
           IF DBC-IND-TICL IN DBC = 'P'                                 
             MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
             MOVE FIO-GET-KEY         TO FIO-CMND
             PERFORM SGC-FIO-DCP
             IF NOT FIO-STAT-OKS
                 MOVE 'DCP    NEX' TO MSG-COD-MENS
                 GO TO FIN-JUD-TIP-BANC
             ELSE
                 MOVE DCP-COD-TBAN IN DCP TO WSS-JUD-TBAN IN JUD-VARI
                 GO TO FIN-JUD-TIP-BANC.
                                                                        
           IF DBC-IND-TICL IN DBC = 'E'
             MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE            
             MOVE FIO-GET-KEY         TO FIO-CMND                       
             PERFORM SGC-FIO-DCE                                        
             IF NOT FIO-STAT-OKS
                 MOVE 'DCE    NEX' TO MSG-COD-MENS
                 GO TO FIN-JUD-TIP-BANC
             ELSE
                 MOVE DCE-COD-TBAN IN DCE TO WSS-JUD-TBAN IN JUD-VARI.
       FIN-JUD-TIP-BANC.
           EXIT.                                                        

       JUD-GRA-CXE SECTION.
       INI-JUD-GRA-CXE.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE LOW-VALUES               TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE CAN-CAI-IOPC IN CAN-FLD  TO CXE-CAI-IOPC IN CXE.
           MOVE CAN-IIC-IOPC IN CAN-FLD  TO CXE-IIC-IOPC IN CXE.
           MOVE 'CAN'                    TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN-FLD  TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE 'GSTJUD'                 TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CXE
               MOVE FIO-MOD TO FIO-CMND.
           MOVE ZEROES                   TO CXE-STP-ITRN IN CXE.
           MOVE SPACES                   TO CXE-MSC-TACC IN CXE.
           MOVE SPACES                   TO CXE-MSC-STAT IN CXE.
           MOVE SPACES                   TO CXE-COD-OTRN IN CXE.
           MOVE SPACES                   TO CXE-COD-ATRN IN CXE.
           MOVE SPACES                   TO CXE-COD-TINT IN CXE.
           MOVE ZEROES                   TO CXE-SGV-TINT IN CXE.
           MOVE WSS-SGV-HCJU IN JUD-VARI TO CXE-SGV-MNTO IN CXE.
           MOVE WSS-SGV-HCJU IN JUD-VARI TO CXE-SGV-MCAL IN CXE.
           MOVE SPACES                   TO CXE-IND-DCTO IN CXE.
           MOVE SPACES                   TO CXE-COD-VCOC IN CXE.
           MOVE ZEROES                   TO CXE-SGV-MCAM IN CXE.
           MOVE SPACES                   TO CXE-CIC-IPLA IN CXE.
           MOVE SPACES                   TO CXE-COD-EVEX IN CXE.
           MOVE ZEROES                   TO CXE-FEC-FPLA IN CXE.
           MOVE ZEROES                   TO CXE-HRA-HPLA IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IPLA IN CXE.
           MOVE SPACES                   TO CXE-IND-CBRO IN CXE.
           MOVE ZEROES                   TO CXE-SGV-SALD IN CXE.
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO CXE-NUM-SVEN IN CXE.
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO CXE-NUM-AVEN IN CXE.
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO CXE-NUM-MVEN IN CXE.
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO CXE-NUM-DVEN IN CXE.
           MOVE SPACES                   TO CXE-IND-FOGA IN CXE.
           MOVE SPACES                   TO CXE-GLS-DISP IN CXE.
           PERFORM COL-FIO-CXE.
           IF NOT FIO-STAT-OKS
               MOVE 'ERR HONOJUDI' TO MSG-COD-MENS.
       FIN-JUD-GRA-CXE.
           EXIT.

       JUD-BUS-CXE SECTION.
       INI-JUD-BUS-CXE.
           MOVE LOW-VALUES               TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE CAN-CAI-IOPC IN CAN-FLD  TO CXE-CAI-IOPC IN CXE.
           MOVE CAN-IIC-IOPC IN CAN-FLD  TO CXE-IIC-IOPC IN CXE.
           MOVE 'CAN'                    TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN-FLD  TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE 'GSTJUD'                 TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-JUD-BUS-CXE.

           COMPUTE CAN-SGV-GAST IN CAN-FLD =
                         CAN-SGV-GAST IN CAN-FLD - CXE-SGV-MCAL IN CXE.

       FIN-JUD-BUS-CXE.
           EXIT.

       PRO-ELI-RCXE SECTION.
       INI-PRO-ELI-RCXE.
           MOVE LOW-VALUES               TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE CAN-CAI-IOPC IN CAN-FLD  TO CXE-CAI-IOPC IN CXE.
           MOVE CAN-IIC-IOPC IN CAN-FLD  TO CXE-IIC-IOPC IN CXE.
           MOVE 'CAN'                    TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN-FLD  TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE 'GSTJUD'                 TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CXE
               MOVE FIO-DEL TO FIO-CMND
               PERFORM COL-FIO-CXE.
       FIN-PRO-ELI-RCXE.
           EXIT.

      *AFRI-INI/PSG/DIC-2008/HONORARIOS JUDICIALES
       LIM-VECTOR SECTION.
       INI-LIM-VECTOR.
           SET WSS-NUM-PORC TO 1.
       LUP-LIM-VPORC.
           IF (WSS-NUM-PORC NOT > 5)
                MOVE ZEROES TO VPOR-NUM-VALP(WSS-NUM-PORC)
                MOVE ZEROES TO VPOR-NUM-MTRA(WSS-NUM-PORC)
                MOVE ZEROES TO VPOR-NUM-MANT(WSS-NUM-PORC)
                SET WSS-NUM-PORC UP BY 1
                GO TO LUP-LIM-VPORC.

           IF (WSS-NUM-PORC > 5)
                SET WSS-NUM-PORC TO 1
                GO TO FIN-LIM-VECTOR.

       FIN-LIM-VECTOR.
           EXIT.

       GRB-VPOR SECTION.                                                
       INI-GRB-VPOR.                                                    
           SET WSS-NUM-PORC TO 1.                                       
       LUP-GRB-VPOR.                                                    
           IF (WSS-NUM-PORC > 5)
                GO TO FIN-GRB-VPOR.

           IF (VPOR-NUM-MTRA(WSS-NUM-PORC) NOT > ZEROES )               
               MOVE WSS-VAL-MANT IN JUD-VARI TO
                                 VPOR-NUM-MANT(WSS-NUM-PORC)
               MOVE WSS-TRA-POR1 IN JUD-VARI TO
                                 VPOR-NUM-VALP(WSS-NUM-PORC)
               MOVE WSS-SGV-MTRA IN JUD-VARI TO
                                 VPOR-NUM-MTRA(WSS-NUM-PORC)
              MOVE WSS-SGV-MTRA IN JUD-VARI TO WSS-VAL-MANT IN JUD-VARI
               IF WSS-NUM-PORC = 1
                    MOVE ZEROES TO VPOR-NUM-MANT(WSS-NUM-PORC)
                   GO TO FIN-GRB-VPOR                                   
               ELSE
                   GO TO FIN-GRB-VPOR.                                  

           SET WSS-NUM-PORC UP BY 1.                                    
           GO TO LUP-GRB-VPOR.                                          
                                                                        
       FIN-GRB-VPOR.                                                    
           EXIT.                                                        
       GRB-VPOR-CIE SECTION.                                            
       INI-GRB-VPOR-CIE.                                                
           SET WSS-NUM-PORC TO 1.                                       
       LUP-GRB-VPOR-CIE.                                                
           IF (WSS-NUM-PORC > 5)
                GO TO FIN-GRB-VPOR-CIE.

           IF (VPOR-NUM-MTRA(WSS-NUM-PORC) NOT > ZEROES )               
               MOVE WSS-VAL-MANT IN JUD-VARI TO
                                 VPOR-NUM-MANT(WSS-NUM-PORC)
               MOVE WSS-TRA-POR1 IN JUD-VARI TO
                                 VPOR-NUM-VALP(WSS-NUM-PORC)
               COMPUTE VPOR-NUM-MTRA(WSS-NUM-PORC) ROUNDED =
                           ( WSS-SGV-MTRA IN JUD-VARI +
                 (( WSS-SGV-MTRA IN JUD-VARI * WSS-TRA-POR1) / 100 ))
              MOVE VPOR-NUM-MTRA(WSS-NUM-PORC) TO
                                               WSS-VAL-MANT IN JUD-VARI
               IF WSS-NUM-PORC = 1
                    MOVE ZEROES TO VPOR-NUM-MANT(WSS-NUM-PORC)
                   GO TO FIN-GRB-VPOR-CIE                               
               ELSE
                   GO TO FIN-GRB-VPOR-CIE.                              

           SET WSS-NUM-PORC UP BY 1.                                    
           GO TO LUP-GRB-VPOR-CIE.                                      
                                                                        
       FIN-GRB-VPOR-CIE.                                                
           EXIT.                                                        
      *AFRI-FIN/PSG/DIC-2008/HONORARIOS JUDICIALES
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
      *AFRI-FIN/LOF/ALD/05-2010 ERROR CALCULO VCD
       BUS-ANT-VCD SECTION.
       INI-BUS-ANT-VCD.
           MOVE BDO-CAI-IOPC IN BDO-VARI TO EVC-CAI-IOPC IN EVC.
           MOVE BDO-IIC-IOPC IN BDO-VARI TO EVC-IIC-IOPC IN EVC.
           MOVE 1                        TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-EVC.
      *ALD-NUMERO VENCIMIENTO
           IF EVC-NUM-VIGU IN EVC = 1 OR
              BDO-NUM-IVEN IN BDO-VARI = 1
      *ALD-NUMERO VENCIMIENTO
               MOVE LOC-ORI-DCOL TO LOC-CXE-DVEN                        
               MOVE LOC-ORI-MCOL TO LOC-CXE-MVEN                        
               MOVE LOC-ORI-SCOL TO LOC-CXE-SVEN                        
               MOVE LOC-ORI-ACOL TO LOC-CXE-AVEN                        
               GO TO FIN-BUS-ANT-VCD.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO FEC-ITM1.                    
           MOVE VEN-NUM-MVEN IN CAN-FLD TO FEC-ITM2.                    
           MOVE VEN-NUM-SVEN IN CAN-FLD TO FEC-ITM3.                    
           MOVE VEN-NUM-AVEN IN CAN-FLD TO FEC-ITM4.                    
           MOVE FEC-FORM-FEC TO FEC-FORM                                
           IF EVC-IND-UTSV IN EVC = 'D'
               MOVE EVC-NUM-SEVE IN EVC TO FEC-NDIA
               MOVE FEC-RST-DIA  TO FEC-CMND                            
           ELSE
               IF EVC-IND-UTSV IN EVC = 'M'
                   MOVE EVC-NUM-SEVE IN EVC TO FEC-NMES
                   MOVE FEC-RST-MES  TO FEC-CMND                        
               ELSE
                   MOVE EVC-NUM-SEVE IN EVC TO FEC-NANO
                   MOVE FEC-RST-ANO  TO FEC-CMND.                       
           PERFORM CAL-FEC                                              
           MOVE FEC-ITM1 TO LOC-CXE-DVEN.                               
           MOVE FEC-ITM2 TO LOC-CXE-MVEN.                               
           MOVE FEC-ITM3 TO LOC-CXE-SVEN.                               
           MOVE FEC-ITM4 TO LOC-CXE-AVEN.                               
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
           IF OPC-IND-AFER IN OPC NOT = WSS-GLS-INSI
               GO TO FIN-BUS-ANT-VCD.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               MOVE FEC-SIG-HBL  TO FEC-CMND
               MOVE FEC-FORM-FEC TO FEC-FORM
               PERFORM CAL-FEC
               MOVE FEC-ITM1 TO LOC-CXE-DVEN
               MOVE FEC-ITM2 TO LOC-CXE-MVEN
               MOVE FEC-ITM3 TO LOC-CXE-SVEN
               MOVE FEC-ITM4 TO LOC-CXE-AVEN.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
       FIN-BUS-ANT-VCD.
           EXIT.
      *AFRI-FIN/LOF/ALD/05-2010 ERROR CALCULO VCD
      *AFRI-INI/LOF/ALD/07-2010 ERROR CALCULO COMISION
       CAL-DIF-DIA-CXE SECTION.
       INI-CAL-DIF-DIA-CXE.
           MOVE LOC-CXE-DVEN            TO FEC-DEC1.
           MOVE LOC-CXE-MVEN            TO FEC-MEC1.
           MOVE LOC-CXE-SVEN            TO FEC-SEC1.
           MOVE LOC-CXE-AVEN            TO FEC-AEC1.
           MOVE WSS-NUM-DVEN            TO FEC-DEC2.
           MOVE WSS-NUM-MVEN            TO FEC-MEC2.
           MOVE WSS-NUM-SVEN            TO FEC-SEC2.
           MOVE WSS-NUM-AVEN            TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
       FIN-CAL-DIF-DIA-CXE.
           EXIT.
      *AFRI-FIN/LOF/ALD/07-2010 ERROR CALCULO COMISION
      *AFRI-INI 15-SEP-2010 GARANTIAS ESTATALES
       DET-GAR-OPE SECTION.
       INI-DET-GAR-OPE.
           MOVE SPACES TO LOC-GLS-GARE IN LOC-VARI.
           MOVE 'COL'               TO FIO-SIST.
           MOVE 'CRF'               TO TAB-COD-TTAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
      * ES PRODUCTO CORFO
              MOVE 'SIGAREST' TO LOC-GLS-GARE IN LOC-VARI
              GO TO FIN-DET-GAR-OPE.

           MOVE 'TAB'               TO FIO-SIST.
           MOVE 'CGC'               TO TAB-COD-TTAB.
           MOVE OPC-IND-GARA IN OPC TO TAB-COD-CTAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
      * NO ES PRODUCTO CORFO
                GO TO FIN-DET-GAR-OPE.
           MOVE 'SIGAREST' TO LOC-GLS-GARE IN LOC-VARI.
       FIN-DET-GAR-OPE.
           EXIT.
      *AFRI-FIN 15-SEP-2010 GARANTIAS ESTATALES
      *>>>>                                                             
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
       LEE-CXE-CAC SECTION.
       INI-LEE-CXE-CAC.
           MOVE ZEROES                   TO SCR-SGV-CCAE.
           MOVE LOW-VALUES               TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE CAN-CAI-IOPC IN CAN-FLD  TO CXE-CAI-IOPC IN CXE.
           MOVE CAN-IIC-IOPC IN CAN-FLD  TO CXE-IIC-IOPC IN CXE.
           MOVE WSS-COD-OPCR IN PVE-VARI TO CXE-CIC-IOPC IN CXE.
           MOVE WSS-COD-OPCR IN PVE-VARI TO SCR-CIC-ICAC.
           MOVE WSS-IND-VCAC             TO CXE-COD-EVEN IN CXE.
           MOVE ZEROES                   TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE WSS-GLS-VCAC             TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               PERFORM CAL-COMI-CAE
               GO TO FIN-LEE-CXE-CAC.
       FIN-LEE-CXE-CAC.
           EXIT.
       CAL-COMI-CAE SECTION.
       INI-CAL-COMI-CAE.
           MOVE 'TAB'  TO TAB-COD-SIST FIO-SIST.                        
           MOVE 'VLR'  TO TAB-CIC-TTAB IN TAB.                          
           MOVE '0999' TO TAB-CIC-CTAB IN TAB.                          
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF CXE-COD-VCOC IN CXE = TAB-COD-CTAB IN TAB                 
               MOVE CXE-SGV-MNTO IN CXE TO SCR-SGV-CCAE
               GO TO FIN-CAL-COMI-CAE.

           MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.                    
           MOVE CXE-COD-VCOC IN CXE  TO TAB-COD-CTAB IN TAB.            
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TAB-NUM-DTRN IN TAB.         
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TAB-NUM-MTRN IN TAB.         
           MOVE CAN-NUM-SCAN IN CAN-FLD TO TAB-NUM-STRN IN TAB.         
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TAB-NUM-ATRN IN TAB.         
           PERFORM GET-VCAM.                                            

           MULTIPLY CXE-SGV-MNTO IN CXE BY CAM-SGV-VCAM IN CAM          
                                GIVING SCR-SGV-CCAE.                    

           MOVE SCR-SGV-CCAE             TO PES-SGV-DECI IN PES-VARI.   
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-CCAE.


       FIN-CAL-COMI-CAE.
           EXIT.
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/04-2012
       LEE-CXE-CAE SECTION.
       INI-LEE-CXE-CAE.
           MOVE 'N' TO WSS-CXE-ICAE IN CAE-VARI.
           MOVE LOW-VALUES               TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE CAN-CAI-IOPC IN CAN-FLD  TO CXE-CAI-IOPC IN CXE.
           MOVE CAN-IIC-IOPC IN CAN-FLD  TO CXE-IIC-IOPC IN CXE.
           MOVE 'PEP'                    TO CXE-COD-EVEN IN CXE.
           MOVE VEN-NUM-IVCT IN CAN-FLD  TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE SPACES                   TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE 'S' TO WSS-CXE-ICAE IN CAE-VARI
               MOVE CXE-SGV-MCAL IN CXE TO WSS-CAE-MCAL IN CAE-VARI
               GO TO FIN-LEE-CXE-CAE
           ELSE
               GO TO FIN-LEE-CXE-CAE.
       FIN-LEE-CXE-CAE.
           EXIT.

       DET-VAL-PAG SECTION.
       INI-DET-VAL-TPAG.
           MOVE SPACES TO WSS-CAE-MENS IN CAE-VARI.

           MOVE OPC-COD-VCOC IN OPC     TO CAM-COD-VCAM IN CAM(1).      
           MOVE '0999  '                TO CAM-COD-VCAM IN CAM(2).      
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAM-NUM-DCAM IN CAM(1).      
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAM-NUM-MCAM IN CAM(1).      
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAM-NUM-SCAM IN CAM(1).      
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAM-NUM-ACAM IN CAM(1).      
           MOVE CAM-FEC-FCAM IN CAM(1)  TO CAM-FEC-FCAM IN CAM(2).      
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM                                          
           IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')                 
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'CAM    NEX' TO WSS-CAE-MENS IN CAE-VARI            
               GO TO FIN-DET-VAL-PAG.                                   

           MULTIPLY WSS-CAE-MCAL IN CAE-VARI BY CAM-SGV-VCAM IN CAM     
                                GIVING WSS-CAE-MCAL IN CAE-VARI ROUNDED.
           MOVE WSS-CAE-MCAL IN CAE-VARI TO PES-SGV-DECI IN PES-VARI.   
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-CAE-MCAL IN CAE-VARI.
       FIN-DET-VAL-PAG.
           EXIT.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/04-2012
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
       MOVE-DATOS-SCR SECTION.
       INI-MOVE-DATOS-SCR.
           MOVE DPS-VAL-MDPT TO SCR-SGV-MDPT.
           MOVE DPS-IND-NECU TO SCR-IND-NECU.
           MOVE DPS-FEC-FOUT TO SCR-FEC-FOUT.
           MOVE VEC-DPS-SEG  TO SCR-VEC-SEG.
       FIN-MOVE-DATOS-SCR.
           EXIT.


       ELI-DPS-CXES SECTION.
       INI-ELI-DPS-CXES.
           MOVE LOW-VALUES               TO CXE.
           MOVE CAN-CAI-IOPC IN CAN-FLD  TO CXE-CAI-IOPC IN CXE.
           MOVE CAN-IIC-IOPC IN CAN-FLD  TO CXE-IIC-IOPC IN CXE.
           MOVE DPS-COD-EVPA IN DPS-VARI TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN-FLD  TO CXE-NUM-EVEN IN CXE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF NOT ( FIO-STAT-OKS AND
               CAN-CAI-IOPC IN CAN-FLD  = CXE-CAI-IOPC IN CXE AND
               CAN-IIC-IOPC IN CAN-FLD  = CXE-IIC-IOPC IN CXE AND
               DPS-COD-EVPA IN DPS-VARI = CXE-COD-EVEN IN CXE AND
               CAN-NUM-ICAN IN CAN-FLD  = CXE-NUM-EVEN IN CXE )
                GO TO FIN-ELI-DPS-CXES.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
           GO TO INI-ELI-DPS-CXES.
       FIN-ELI-DPS-CXES.
           EXIT.
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
       OBT-DATOS-CEN SECTION.
       INI-OBT-DATOS-CEN.
           MOVE ZEROES       TO SCR-SGV-CFIN.
           MOVE ZEROES       TO SCR-SGV-CCMC.
           MOVE ZEROES TO WSS-TOT-COMI.
           IF SCR-USER = GAR-CT-PAC1
               GO TO FIN-OBT-DATOS-CEN.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST
           MOVE 'TVP'          TO TAB-COD-TTAB IN TAB
           MOVE CAN-MSC-CANC IN CAN-FLD   TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF NOT ( FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = WSS-GLS-INSI )
               GO TO FIN-OBT-DATOS-CEN.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST
           MOVE 'PCE'          TO TAB-COD-TTAB IN TAB
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = WSS-GLS-INSI
               GO TO FIN-OBT-DATOS-CEN.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST
           MOVE 'PCE'          TO TAB-COD-TTAB IN TAB
           MOVE OPC-COD-TOOC IN OPC TO WSS-COD-TIOO.
           MOVE WSS-GLS-ASTE        TO WSS-COD-TAUX.
           MOVE WSS-COD-TIAU        TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = WSS-GLS-INSI
               GO TO FIN-OBT-DATOS-CEN.
           IF  SCR-MSC-FCAN = WSS-GLS-ITTT AND
               SCR-MSC-ECAN = WSS-GLS-ITTT
                GO TO CON-OBT-DATOS-CEN.
           IF  SCR-MSC-FCAN = WSS-GLS-ITTT AND
               SCR-MSC-ECAN = WSS-GLS-IEEE AND
               OPC-NUM-VCOR IN OPC = WSS-NUM-IUN1
                GO TO CON-OBT-DATOS-CEN.
           IF  SCR-MSC-FCAN = WSS-GLS-IIII AND
               SCR-MSC-ECAN = WSS-GLS-IEEE AND
               OPC-NUM-VCOR IN OPC = WSS-NUM-IUN1
                 IF SCR-USER NOT = GAR-CT-PAC1
                     GO TO CON-OBT-DATOS-CEN.
           GO TO FIN-OBT-DATOS-CEN.
       CON-OBT-DATOS-CEN.
           MOVE WSS-GLS-INNO                TO WSS-IND-ICEN.
           PERFORM VALIDA-MONTO-UF.
           IF WSS-IND-ICEN = WSS-GLS-INNO
               GO TO FIN-OBT-DATOS-CEN.

           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL       TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-OBT-DATOS-CEN.

           PERFORM BUSQUEDA-CEN-CPR.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-OBT-DATOS-CEN.


           PERFORM VALIDA-FECHA-VIG-ESTADO.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL       TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-OBT-DATOS-CEN.

           MOVE CEN-GLS-GLS3 IN CEN        TO WSS-GLS-CFIN.
           IF WSS-GLS-CFIN NOT NUMERIC
               MOVE FRM-SUAR-MAL       TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MNTOCFINXNUM'              TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-OBT-DATOS-CEN.
           MOVE WSS-VAL-CFIN               TO SCR-SGV-CFIN.
           MOVE CEN-GLS-GLS4 IN CEN        TO WSS-GLS-CFIN.
           IF WSS-GLS-CFIN NOT NUMERIC
               MOVE FRM-SUAR-MAL       TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MNTOCCMCXNUM'              TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-OBT-DATOS-CEN.
           MOVE WSS-VAL-CFIN               TO SCR-SGV-CCMC.
           COMPUTE WSS-TOT-COMI = SCR-SGV-CFIN + SCR-SGV-CCMC.
       FIN-OBT-DATOS-CEN.
           EXIT.
       VALIDA-MONTO-UF SECTION.
       INI-VALIDA-MONTO-UF.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
           MOVE 'CPRE  VALMIN' TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF NOT ( FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = WSS-GLS-INSI )
               MOVE WSS-NUM-5000                TO WSS-VAL-MNOR
               GO TO NXT-VALIDA-MONTO-UF.

           MOVE TAB-GLS-DATA TO WSS-GLS-MNUF.
           IF WSS-GLS-MNUF NOT NUMERIC
               MOVE 'MONTOUFNONUM'              TO MSG-COD-MENS
               GO TO FIN-VALIDA-MONTO-UF.
       NXT-VALIDA-MONTO-UF.
           PERFORM BUSCA-MONTO-ORIGINAL.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VALIDA-MONTO-UF.
           IF WSS-VAL-MNOR NOT < WSS-VAL-MNUF
               MOVE WSS-GLS-INSI                TO WSS-IND-ICEN.
       FIN-VALIDA-MONTO-UF.
           EXIT.
       VALIDA-FECHA-VIG-ESTADO SECTION.
       INI-VALIDA-FECHA-VIG-ESTADO.
           MOVE CAN-NUM-DOUT IN CAN-FLD TO WSS-NUM-DCAN IN WSS-VARI.
           MOVE CAN-NUM-MOUT IN CAN-FLD TO WSS-NUM-MCAN IN WSS-VARI.
           MOVE CAN-NUM-SOUT IN CAN-FLD TO WSS-NUM-SCAN IN WSS-VARI.
           MOVE CAN-NUM-AOUT IN CAN-FLD TO WSS-NUM-ACAN IN WSS-VARI.
           IF CEN-FEC-FFE2 IN CEN < WSS-CMP-FCAN IN WSS-VARI
               MOVE 'CENFECFOUTNV' TO MSG-COD-MENS
               GO TO FIN-VALIDA-FECHA-VIG-ESTADO.

           IF NOT ( CEN-MSC-STAT IN CEN = WSS-GLS-INNO  OR
              CEN-MSC-STAT IN CEN = WSS-GLS-ICCC )
               MOVE 'CENSTATNOVAL' TO MSG-COD-MENS
               GO TO FIN-VALIDA-FECHA-VIG-ESTADO.
       FIN-VALIDA-FECHA-VIG-ESTADO.
           EXIT.
       BUSCA-MONTO-ORIGINAL SECTION.
       INI-BUSCA-MONTO-ORIGINAL.
           PERFORM DET-OPC-PRO-ORIG.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-BUSCA-MONTO-ORIGINAL.
           MOVE TXC-MNTO   TO WSS-VAL-MNOR.
           MOVE ZEROES     TO TXC-MNTO.
       FIN-BUSCA-MONTO-ORIGINAL.
           EXIT.
       BUSQUEDA-CEN-CPR SECTION.
       INI-BUSQUEDA-CEN-CPR.
           MOVE WSS-GLS-ICPR                TO CEN-COD-ENTI IN CEN.
           MOVE CAN-CAI-IOPC IN CAN-FLD     TO CEN-CAI-IENT IN CEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD     TO CEN-IIC-IENT IN CEN.
           MOVE ZEROES                      TO CEN-FEC-FENT IN CEN.
           MOVE SPACES                      TO CEN-COD-RENT IN CEN.
           MOVE CAN-NUM-ICAN IN CAN-FLD     TO CEN-NUM-IENT IN CEN.
           MOVE SPACES                      TO CEN-COD-CCSE IN CEN.
           MOVE SPACES                      TO CEN-CAI-ISEN IN CEN.
           MOVE ZEROES                      TO CEN-IIC-ISEN IN CEN.
           MOVE ZEROES                      TO CEN-NUM-ISEN IN CEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF NOT ( FIO-STAT-OKS AND
              CEN-COD-ENTI IN CEN     = WSS-GLS-ICPR AND
              CAN-CAI-IOPC IN CAN-FLD = CEN-CAI-IENT IN CEN AND
              CAN-IIC-IOPC IN CAN-FLD = CEN-IIC-IENT IN CEN AND
              CAN-NUM-ICAN IN CAN-FLD = CEN-NUM-IENT IN CEN )
               MOVE FRM-SUAR-MAL       TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NOEXICENCOMI'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-BUSQUEDA-CEN-CPR.
       LOOP-BUSQUEDA-CEN-CPR.
           MOVE CEN-FEC-FFE2 IN CEN TO WSS-CEN-FEC-FFE2.
           MOVE CEN-MSC-STAT IN CEN TO WSS-CEN-MSC-STAT.
           MOVE CEN-GLS-GLS3 IN CEN TO WSS-CEN-GLS-GLS3.
           MOVE CEN-GLS-GLS4 IN CEN TO WSS-CEN-GLS-GLS4.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF  FIO-STAT-OKS AND
               CEN-COD-ENTI IN CEN     = WSS-GLS-ICPR AND
               CAN-CAI-IOPC IN CAN-FLD = CEN-CAI-IENT IN CEN AND
               CAN-IIC-IOPC IN CAN-FLD = CEN-IIC-IENT IN CEN AND
               CAN-NUM-ICAN IN CAN-FLD = CEN-NUM-IENT IN CEN
                GO TO LOOP-BUSQUEDA-CEN-CPR.
           MOVE WSS-CEN-FEC-FFE2 TO CEN-FEC-FFE2 IN CEN.
           MOVE WSS-CEN-MSC-STAT TO CEN-MSC-STAT IN CEN.
           MOVE WSS-CEN-GLS-GLS3 TO CEN-GLS-GLS3 IN CEN.
           MOVE WSS-CEN-GLS-GLS4 TO CEN-GLS-GLS4 IN CEN.
       FIN-BUSQUEDA-CEN-CPR.
           EXIT.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
       PRO-COM-NOR SECTION.
       INI-PRO-COM-NOR.
           MOVE ZEROES                  TO GCN-CONO.
           MOVE ZEROES                  TO GCN-FVEN.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO GCN-DCAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO GCN-MCAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO GCN-SCAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO GCN-ACAN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO GCN-CAI-IOPC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO GCN-IIC-IOPC.
           MOVE GCN-IND-CPES             TO GCN-VCAM.
           MOVE GCN-ASTE                 TO GCN-IVIG.
           MOVE GCN-ASTE                 TO GCN-ICTA.
           MOVE GCN-N                    TO GCN-IND-ICIE.
           MOVE ZEROES                   TO GCN-CAMB.
           PERFORM COL-LNK-GCN.
           IF GCN-CMSG > SPACES
               MOVE ZEROES   TO GCN-CONO.
       FIN-PRO-COM-NOR.
           EXIT.
       PRO-COM-NOR-CIE SECTION.
       INI-PRO-COM-NOR-CIE.
           MOVE ZEROES                  TO GCN-CONO.
           MOVE ZEROES                  TO GCN-FVEN.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO GCN-DCAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO GCN-MCAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO GCN-SCAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO GCN-ACAN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO GCN-CAI-IOPC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO GCN-IIC-IOPC.
           MOVE GCN-IND-CPES             TO GCN-VCAM.
           MOVE GCN-ASTE                 TO GCN-IVIG.
           MOVE GCN-ASTE                 TO GCN-ICTA.
           MOVE GCN-S                    TO GCN-IND-ICIE.
           MOVE ZEROES                   TO GCN-CAMB.
           PERFORM COL-LNK-GCN.
           IF GCN-CMSG > SPACES
               MOVE ZEROES   TO GCN-CONO.
       FIN-PRO-COM-NOR-CIE.
           EXIT.
       PRO-JUDIC-HONO SECTION.
       INI-PRO-JUDIC-HONO.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO HNJ-CAI-IOPC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO HNJ-IIC-IOPC.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO HNJ-ICAN.
           MOVE CAN-SGV-TPAG IN CAN-FLD TO HNJ-TPAG.
           MOVE CAN-SGV-TREN IN CAN-FLD TO HNJ-TREN.
           MOVE CAN-SGV-GAST IN CAN-FLD TO HNJ-GAST.
           MOVE CAN-MSC-CANC IN CAN-FLD TO HNJ-CANC.
           MOVE WSS-VAL-SVEN IN WSS-VARI TO HNJ-SVEN.
           MOVE HNJ-N                    TO HNJ-ICIE.
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO HNJ-DCAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO HNJ-MCAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO HNJ-SCAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO HNJ-ACAN.
           PERFORM COL-LNK-HNJ.
           IF HNJ-COD-MENS > SPACES
               MOVE HNJ-S TO WSS-JUD-ERRO IN JUD-VARI
               MOVE HNJ-COD-MENS TO MSG-COD-MENS
           ELSE
               MOVE HNJ-SGV-HCJU TO WSS-SGV-HCJU IN JUD-VARI.
       FIN-PRO-JUDIC-HONO.
           EXIT.
       PRO-JUDIC-HONO-CIE SECTION.
       INI-PRO-JUDIC-HONO-CIE.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO HNJ-CAI-IOPC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO HNJ-IIC-IOPC.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO HNJ-ICAN.
           MOVE CAN-SGV-TPAG IN CAN-FLD TO HNJ-TPAG.
           MOVE CAN-SGV-TREN IN CAN-FLD TO HNJ-TREN.
           MOVE CAN-SGV-GAST IN CAN-FLD TO HNJ-GAST.
           MOVE CAN-MSC-CANC IN CAN-FLD TO HNJ-CANC.
           MOVE ZEROES                   TO HNJ-SVEN.
           MOVE HNJ-S                    TO HNJ-ICIE.
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO HNJ-DCAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO HNJ-MCAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO HNJ-SCAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO HNJ-ACAN.
           PERFORM COL-LNK-HNJ.
           IF HNJ-COD-MENS > SPACES
               MOVE HNJ-S TO WSS-JUD-ERRO IN JUD-VARI
               MOVE HNJ-COD-MENS TO MSG-COD-MENS
           ELSE
               MOVE HNJ-SGV-HCJU TO WSS-SGV-HCJU IN JUD-VARI.
       FIN-PRO-JUDIC-HONO-CIE.
           EXIT.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *>>>>
