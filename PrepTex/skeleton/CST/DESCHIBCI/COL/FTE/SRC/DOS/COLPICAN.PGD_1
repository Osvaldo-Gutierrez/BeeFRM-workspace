       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   COLPICAN.
       AUTHOR.       CONSIST.
       DATE-WRITTEN. 11-Apr-19 11:03 AM.

      * NOMBRE PROGRAMA                   COLPICAN
      * VERSION                           3.1
      * OPCION                            CON + UPD
      * ARCHIVO BASE                      COLCAN
      * PANTALLA                          COLCAN
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *-----------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: INCLUIR LA COMISION FOGAPE EN LA PANTALLA CAN
      *PROYECTO: LOF CON CANCELACIONES
      *FECHA   : JULIO DE 2009
      *AUTOR   : CHC
      *ETIQUETA: *AFRI-INI/LOF/CHC/07-2009
      *-----------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: REBAJAR TASAS
      *PROYECTO: REBAJA DE TASAS OPERACIONES CAE
      *FECHA   : ABRIL DE 2012
      *AUTOR   : CHC
      *ETIQUETA: *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/04-2012
      *-----------------------------------------------------------------
      *-----------------------------------------------------------------
      *OBJETIVO: COMISION CAE
      *PROYECTO: COBRO COMISION CAE
      *FECHA   : SEPTIEMBRE 2013
      *AUTOR   : AFRI
      *ETIQUETA: *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
      *-----------------------------------------------------------------
      *OBJETIVO: DEVOLUCION SEGUROS
      *PROYECTO: DEVOLUCION PRIMA DE SEGUROS POR PREPAGO
      *FECHA   : DICIEMBRE 2013
      *AUTOR   : AFRI
      *ETIQUETA: *AFRI-INI/DEVOLUCION SEGUROS/12-2013
      *-----------------------------------------------------------------
      *OBJETIVO: CAMBIAR LECTURA ENTIDAD IMP POR TABLA TIM
      *PROYECTO: ITE - AUMENTO DE DECIMALES
      *FECHA   : ENERO DE 2013
      *AUTOR   : SOP
      *ETIQUETA: *AFRI-INI/ITE/SOP/01-2013
      *-----------------------------------------------------------------
      *-----------------------------------------------------------------
      * PROYECTO : SELECCIONA DE SEGUROS A DEVOLVER
      * OBJETIVO : INCORPORAR LLAMADO A COLPPISC Y MC2 PARA OBTENER
      *            EL MONTO DE LOS SEGUROS A DEVOLVER
      * RESPONSABLE: AFRI-ALD
      * FECHA 10-SEP-2014
      * ETIQUETA : AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
      *-----------------------------------------------------------------
      *-----------------------------------------------------------------
      * PROYECTO : COBRAR COMISION MAYORES A 5.000 UF ( PARAMETRICO )
      * RESPONSABLE: AFRI-ALD
      * FECHA 14-DIC-2015
      * ETIQUETA : AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *-----------------------------------------------------------------
      * PROYECTO: COMISION FOGAPE
      * AUTOR:    AFRI
      * OBJETIVO: NORMALIZAR COBRO COMISION FOGAPE
      * ETIQUETA: *AFRI-INI 13-SEP-2017 COMISION FOGAPE
      *---------------------------------------------------------------*
      * PROYECTO: ASEGURAMIENTO
      * AUTOR:    AFRI
      * OBJETIVO: COBRO COMISION NORMALIZA
      * ETIQUETA: *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *---------------------------------------------------------------*

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       COPY GNSWCSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-COLPICAN-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$COLPICAN$ SKL=$06.02.01.1$ VSN=${vsnpq}$        
      -    'GEN=$11-Apr-19 11:03 AM$ FNC=${fncpq}$/>'.    
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
       COPY COLWGENG.
       COPY COLW1CAN.
      *>>>>
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-CAN-REQA==.
           02 SCR-KEY-ICAN                     PIC X(03).
      *>>>>
       01  PGM-CMMA REDEFINES SCR-VARI.
           03 PGM-CMMA-CHR OCCURS 3000 PIC X(01).
       COPY COLWICAN.
       COPY COLBRCAN.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      *COPY GNSWGFRM.
       COPY GNSWG3CF.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<< WSS
      *AFRI-FIN/09-2006                                                 
      *AFRI-INI/LOF/CHC/07-2009
      *COPY COLWGLOF.
       COPY LDCBRLCC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LCC-REQA==.
       COPY LDCBRRLO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RLO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-BDO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTT-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AXU-REQA==.        
      *AFRI-FIN/LOF/CHC/07-2009
       01 WSS-DEBUG.                                                    
          03 WSS-DEBUG-1   VALUE ZEROES  PIC 9(11)V9(04).               
          03 WSS-DEBUG-2   VALUE SPACES  PIC X(40).                     
       COPY GNSWCSCR.                                                   
       COPY COLWGPMP.
       COPY COLBRDIC.                                                   
                                                                        
      *HZF-INI 19-02-2001                                               
       COPY COLWGPVE.                                                   
      *HZF-FIN 19-02-2001                                               
      *>>>>
      *<<<< WSS
      *DAD ini PTC
       COPY GNSWGQUE.
       COPY GNSWGTSK.                                                   
       COPY COLMXW05.                                                   
      *DAD fin PTC
       COPY COLBRTMC.
       COPY COLBRCYA.
       COPY COLBRICG.
       COPY COLBRITR.
       COPY COLBROPC.
       COPY COLBRRCV.
       COPY COLBRROV.
       COPY COLBRVEN.
       COPY COLBRRDC.
      * RBG/INI/12-NOV-1996
       COPY SGCBRDCE.
       COPY SGCBRDCP.
       COPY COLBRCOM.
      * RBG/FIN/12-NOV-1996
       COPY SGCBRDBC.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY GNSWGCPT.
       COPY GNSWGCIC.
       COPY GNSBRCIC.
       COPY TABBRCAM.
       COPY TABBRVLR.
      *ALD-BCI-INI/22.04.1999
       COPY TABWGTXC.
      *ALD-BCI-FIN/22.04.1999
       COPY COLWGVEN.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
      *ADA-INI 08.07.2008                                               
      *COPY COLWGPCP.                                                   
       COPY COLWGPDC.                                                   
      *ADA-FIN 08.07.2008                                               
       COPY COLBRPCP.                                                   
       COPY GNSWGCVI.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRTOC.
       COPY GNSWGPES.
      *AFRI-INI/07-2006
       COPY TABBRTIO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.
      *AFRI-FIN/07-2006
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DIC-REQA==.        
                                                                        
      *LOP-INI 20-01-2004 CREDITO SIN MORA                              
       COPY COLBRIXT.                                                   
      *AFRI-INI/ITE/SOP/01-2013
       COPY COLWGTIM.
      *COPY COLBRIMP.
      *AFRI-FIN/ITE/SOP/01-2013
       COPY COLWGCXE.                                                   
      *AFRI-INI/ITE/SOP/01-2013
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IMP-REQA==.
      *AFRI-FIN/ITE/SOP/01-2013
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IXT-REQA==.        
      *LOP-FIN 20-01-2004 CREDITO SIN MORA                              
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
       COPY COLBRCEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CEN-REQA==.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-INI                                                         
       COPY COLBRCXE.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CXE-REQA==.        
      *AFRI-FIN                                                         
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
       COPY COLWGGCN.
       COPY COLWGHNJ.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *LOP-INI IFRS
       COPY COLWGIFR.                                                   
      *LOP-FIN IFRS
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
       COPY COLWGDPS.
       01 WCC-C00                   VALUE '00'      PIC X(02).
       01 WCC-1                     VALUE 1         PIC 9(01).
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS
                                                                        
       COPY COLW2CAN.

      * RBG INI 3-APR-1996 **Restaurar para Compilar en Roscoe**
      * DAD ini  21-ABR-1993
      *    03  WSS-VAL-CMP2                COMP-2.
      * DAD fin  21-ABR-1993
           03  WSS-VAL-CMP2                      PIC S9(11)V9(5).
      * RBG FIN 3-APR-1996 **Restaurar para compilar en Roscoe**
           03  WSS-MSG-MENS.
               05  WSS-MSG-PREV                     PIC X(09).
               05  WSS-MSG-TENT                     PIC X(01).
               05  WSS-MSG-FENT                     PIC X(01).
               05  WSS-MSG-SENT                     PIC X(01).
           03  WSS-MSC-CACC                         PIC X(08).
      * RBG/INI/18-NOV-1996 Variable para el cobro de Comision.
           03  WSS-SGV-DELT  COMP-3  VALUE ZEROES   PIC S9(09)V9(04).
      * RBG/FIN/18-NOV-1996 Variable para el cobro de Comision.

      *DAD ini  11-AUG-1992   (Memo.24-07-92 Pto.2)
           COPY USPC113.
      *DAD fin  11-AUG-1992
       01  WSS-AUXI.
           05 WSS-MSJS.
              07 WSS-MSJ0                              PIC X(22).
              07 FILLER                                PIC X(01).
              07 WSS-MSJ1                              PIC X(16).
              07 FILLER                                PIC X(01).
              07 WSS-MSJ2                              PIC X(22).
              07 FILLER                                PIC X(01).
              07 WSS-MSJ3                              PIC X(16).
      *ADA-INI 23.07.2008                                               
      * ARREGLO PCP                                                     
       01 WSS-PCP-VARI.
           03 WS-PCP-GRAC OCCURS  14 TIMES INDEXED BY WS-CCO-Q.         
              05 WS-PCP-CAL    COMP-3   PIC S9(11)V9(04).               
              05 WS-PCP-TAS    COMP-3   PIC  9(02)V9(04).               
              05 WS-PCP-ING    COMP-3   PIC S9(11)V9(04).               
              05 WS-PCP-CPT             PIC  X(06).                     
              05 WS-PCP-FCA             PIC  X(08).                     
              05 WS-PCP-TIP             PIC  X(04).                     
              05 WS-PCP-EFA             PIC  X(01).                     
              05 WS-PCP-PIM   COMP-3    PIC S9(02)V9(03).               
              05 WS-PCP-INC             PIC X(01).                      
      *ADA-FIN 23.07.2008                                               
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
      * RBG/INI/12-NOV-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
      * RBG/FIN/12-NOV-1996
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-STAT.
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).
              05 PGM-STAT-CAN.
                 88 PGM-STAT-CAN-NUL    VALUE '  '.
                 07 PGM-STT1-CAN        VALUE '2' PIC X(01).
                    88 PGM-STAT-CAN-OKS VALUE '0'.
                 07 PGM-STT2-CAN        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
              05 PGM-STAT-VEN.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
                 07 PGM-STT1-VEN        VALUE '2' PIC X(01).
                    88 PGM-STAT-VEN-OKS VALUE '0'.
                 07 PGM-STT2-VEN        VALUE '3' PIC X(01).
              05 PGM-STAT-RCV.
                 88 PGM-STAT-RCV-NUL    VALUE '  '.
                 07 PGM-STT1-RCV        VALUE '2' PIC X(01).
                    88 PGM-STAT-RCV-OKS VALUE '0'.
                 07 PGM-STT2-RCV        VALUE '3' PIC X(01).
              05 PGM-STAT-ROV.
                 88 PGM-STAT-ROV-NUL    VALUE '  '.
                 07 PGM-STT1-ROV        VALUE '2' PIC X(01).
                    88 PGM-STAT-ROV-OKS VALUE '0'.
                 07 PGM-STT2-ROV        VALUE '3' PIC X(01).
              05 PGM-STAT-ICG.
                 88 PGM-STAT-ICG-NUL    VALUE '  '.
                 07 PGM-STT1-ICG        VALUE '2' PIC X(01).
                    88 PGM-STAT-ICG-OKS VALUE '0'.
                 07 PGM-STT2-ICG        VALUE '3' PIC X(01).
              05 PGM-STAT-COM.
                 88 PGM-STAT-COM-NUL    VALUE '  '.
                 07 PGM-STT1-COM        VALUE '2' PIC X(01).
                    88 PGM-STAT-COM-OKS VALUE '0'.
                 07 PGM-STT2-COM        VALUE '3' PIC X(01).
              05 PGM-STAT-CYA.
                 88 PGM-STAT-CYA-NUL    VALUE '  '.
                 07 PGM-STT1-CYA        VALUE '2' PIC X(01).
                    88 PGM-STAT-CYA-OKS VALUE '0'.
                 07 PGM-STT2-CYA        VALUE '3' PIC X(01).
              05 PGM-STAT-ITR.                                          
                 88 PGM-STAT-ITR-NUL    VALUE '  '.                     
                 07 PGM-STT1-ITR        VALUE '2' PIC X(01).            
                    88 PGM-STAT-ITR-OKS VALUE '0'.                      
                 07 PGM-STT2-ITR        VALUE '3' PIC X(01).            
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 DFH-CMMA OCCURS 3000 PIC X(01).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO CAN-FLD.
           MOVE LOW-VALUES TO CAN-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +3000 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'COLPICAN' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *<<<< ( INI_FIO ) AND ( NOT PGM_VSI )
      * PTC ini                                                         
           PERFORM GNS-ERR-QUE.                                         
           PERFORM GET-TSK-TERM.                                        
      * PTC fin                                                         
           PERFORM GNS-HDL-VSM.
      *>>>>
      *<<<< INI_FIO
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               PERFORM GNS-CLR-RQA.
      *>>>>
      *<<<< INI_FIO
           IF SCR-DESDE-CMN
             IF NOT SCR-OFRM-SRV
               MOVE SPACES TO SCR-COD-TICG
                              SCR-COD-TITR
                              SCR-COD-VCOC
                              SCR-CYA-IND-MCYA
                              SCR-CYA-IND-PAUT
                              SCR-CYA-IND-CAJA
                              SCR-ROV-CAI-IOPC
               MOVE ZEROES TO SCR-ROV-IIC-IOPC
               MOVE 1      TO SCR-SGV-VCAM.
           IF SCR-DESDE-CMN
               MOVE 'C'    TO SCR-IND-OOD
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FTER-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FTER-CIC.
       FIN-INI-FIO.
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       GNS-BUS-VCA SECTION.
       INI-GNS-BUS-VCA.
           MOVE 0 TO FRM-IFLD.
       LUP-GNS-BUS-VCA.
           ADD 1 TO FRM-IFLD.
           IF FRM-IFLD NOT > EIBCALEN AND
              FRM-IFLD NOT > 3000
                MOVE DFH-CMMA(FRM-IFLD) TO PGM-CMMA-CHR(FRM-IFLD)
                GO TO LUP-GNS-BUS-VCA.
       FIN-GNS-BUS-VCA.
           EXIT.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-CAN.
           PERFORM EDT-KEY-CAN.
           PERFORM EDT-FLD-CAN.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-CAN
               PERFORM VAL-NUM-FLD-CAN.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           PERFORM GNS-CLR-RQA.
      *>>>>
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-CAN
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE 'S' TO SCR-IERR
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-CAN
               PERFORM VAL-NUM-FLD-CAN
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-CAN
               PERFORM VAL-NUM-FLD-CAN
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           PERFORM GNS-CLR-RQA.
      *>>>>
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.



       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-CAN
               PERFORM EDT-KEY-CAN
               PERFORM EDT-FLD-CAN
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-CAN
               PERFORM EDT-KEY-CAN
           ELSE
               PERFORM CLR-FLD-CAN
               PERFORM EDT-FLD-CAN.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-CAN.
       ERR-SCR-KEY.
           MOVE 'S' TO SCR-IERR.
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO CAN-FLD.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
           PERFORM KEY-ALL-CAN.
      *<<<< FND_KEY
       COPY COLB1CAN.
      *>>>>
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
               MOVE CAN-STP-ITRN IN CAN TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-CAN.
      *<<<< FIN_FND_KEY
       COPY COLB2CAN.
      *>>>>
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.

       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-CAN-OKS
               MOVE CAN-STP-ITRN IN CAN TO SCR-UMOD.
           PERFORM PUT-ALL-CAN.
       FIN-PUT-SCR.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
           PERFORM KEY-ALL-CAN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS AND
              CAN-STP-ITRN IN CAN NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM COL-FIO-CAN
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-CAN
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-ALL-CAN.
      *<<<< CMN_MOD
      *ISP ES NECESARIO TENER LOS DATOS DE LA OPERACION
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO CAN-NUM-DTRN IN CAN.
           MOVE HOY-MHOY IN HOY-VARI TO CAN-NUM-MTRN IN CAN.
           MOVE HOY-AHOY IN HOY-VARI TO CAN-NUM-ATRN IN CAN.
           MOVE HOY-SHOY IN HOY-VARI TO CAN-NUM-STRN IN CAN.
           MOVE HOY-HHOY IN HOY-VARI TO CAN-HRA-HRTR IN CAN.
           PERFORM GET-OPC.

           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
                MOVE 1 TO CAN-NUM-TVCC IN CAN
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
                MOVE OPC-NUM-VCVG IN OPC TO CAN-NUM-TVCC IN CAN
           ELSE
           IF SCR-MSC-FCAN = 'I' OR 'P'
                MOVE ZEROES TO CAN-NUM-TVCC IN CAN
           ELSE
                MOVE 1 TO CAN-NUM-TVCC IN CAN.

      *ISP ASUME CANCELACION NO VERIFICADA
           MOVE 'M' TO CAN-MSC-STAT IN CAN.
           MOVE 'M' TO WSS-MSG-FENT.
           PERFORM VRF-ACT-CYA.
           IF NOT PGM-STAT-CYA-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
           PERFORM CHK-PNR-BGT.
      *>>>>
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : informar
               MOVE FIO-MENS TO FRM-MENS
      *DAD ini  07-JUN-1993   (Memo.03-06-93)
               PERFORM BCK-OUT
      *DAD fin  07-JUN-1993
               GO TO FIN-CMN-MOD.

           PERFORM ACT-ICG.
           IF NOT PGM-STAT-ICG-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.

           PERFORM ACT-COM.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.

           PERFORM ACT-COM-FLV.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE FIO-MENS TO FRM-MENS                                
               PERFORM BCK-OUT                                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
      *DPM ini  11-OCT-1996 Los perform siguientes fueron cambiados
      *de prioridad para calcular CAN-SGV-IMOK
           IF SCR-ROV-CAI-IOPC > SPACES        OR
              SCR-ROV-IIC-IOPC > ZEROES        OR
              ROV-CAI-IOPC IN CAN-FLD > SPACES OR
              ROV-IIC-IOPC IN CAN-FLD > ZEROES
                PERFORM ACT-ROV
                IF NOT FIO-STAT-OKS
                    MOVE FIO-MENS TO FRM-MENS
                    PERFORM BCK-OUT
                    GO TO FIN-CMN-MOD.

           PERFORM ACT-RCV.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *LOP-INI IFRS
           PERFORM ACT-CXE.                                             
           IF NOT FIO-STAT-OKS                                          
               MOVE FIO-MENS TO FRM-MENS                                
               PERFORM BCK-OUT                                          
               GO TO FIN-CMN-MOD.                                       
      *LOP-FIN IFRS
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
           PERFORM ACT-CXE-JUD.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE FIO-MENS TO FRM-MENS                                
               PERFORM BCK-OUT                                          
               GO TO FIN-CMN-MOD.                                       
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
           PERFORM ACT-CXE-CONO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *AFRI-INI/LOF/CHC/07-2009
           PERFORM ACT-CXE-FGP.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *AFRI-FIN/LOF/CHC/07-2009
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           PERFORM ACT-CXE-FIN.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           PERFORM ACT-CXE-FIN.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
           PERFORM ACT-CXE-COM-CAE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
      *DPM fin  11-OCT-1996
      *>>>>
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO CAN.
      *<<<< INI_CMN_ING
           MOVE ZEROES TO CAN-NUM-TVCC IN CAN.
           MOVE ZEROES TO CAN-SGV-IMOK IN CAN.
           MOVE ZEROES TO CAN-FEC-FDVA IN CAN.
           MOVE ZEROES TO CAN-FEC-FTRN IN CAN.
           MOVE ZEROES TO CAN-HRA-HRTR IN CAN.

           MOVE SPACES TO ICG.
           MOVE ZEROES TO ICG-FEC-FTRN IN ICG.
           MOVE ZEROES TO ICG-HRA-HRTR IN ICG.
           MOVE ZEROES TO ICG-SGV-TINT IN ICG.
           MOVE ZEROES TO ICG-SGV-SPRD IN ICG.
           MOVE ZEROES TO ICG-SGV-MNTO IN ICG.
           MOVE ZEROES TO ICG-NUM-PREP IN ICG.
           MOVE ZEROES TO ICG-FEC-FTER IN ICG.

           MOVE SPACES TO COM.
           MOVE ZEROES TO COM-SGV-MIVA IN COM.
           MOVE ZEROES TO COM-FEC-FTRN IN COM.
           MOVE ZEROES TO COM-HRA-HRTR IN COM.
           MOVE ZEROES TO COM-SGV-TINT IN COM.
           MOVE ZEROES TO COM-SGV-SPRD IN COM.
           MOVE ZEROES TO COM-SGV-MNTO IN COM.
           MOVE ZEROES TO COM-NUM-PREP IN COM.
           MOVE ZEROES TO COM-FEC-FTER IN COM.

           MOVE SPACES TO RCV.
           MOVE ZEROES TO RCV-FEC-FCAN IN RCV.
           MOVE ZEROES TO RCV-FEC-FOUT IN RCV.
           MOVE ZEROES TO RCV-FEC-FTRN IN RCV.
           MOVE ZEROES TO RCV-NUM-HHTR IN RCV.
           MOVE ZEROES TO RCV-NUM-IDLC IN RCV.
           MOVE ZEROES TO RCV-NUM-IEVC IN RCV.
           MOVE ZEROES TO RCV-NUM-IVCT IN RCV.
           MOVE ZEROES TO RCV-NUM-MMTR IN RCV.
           MOVE ZEROES TO RCV-NUM-SSTR IN RCV.
           MOVE ZEROES TO RCV-SGV-CAPI IN RCV.
           MOVE ZEROES TO RCV-SGV-FINA IN RCV.
           MOVE ZEROES TO RCV-SGV-INTE IN RCV.
           MOVE ZEROES TO RCV-SGV-INTM IN RCV.
           MOVE ZEROES TO RCV-SGV-INTN IN RCV.
           MOVE ZEROES TO RCV-SGV-REAJ IN RCV.

           MOVE SPACES TO ROV.
           MOVE ZEROES TO ROV-FEC-FTRN IN ROV.
           MOVE ZEROES TO ROV-HRA-HRTR IN ROV.
           MOVE ZEROES TO ROV-SGV-RENO IN ROV.
           MOVE ZEROES TO ROV-NUM-IVCT IN ROV.
      *>>>>
           PERFORM RET-ALL-CAN.
      *<<<< CMN_ING
      *RVM-CST-INI 15-MAY-1997
           IF SCR-CMND = 'SCA'
               MOVE 'COL'      TO MSG-COD-SIST
               MOVE 'SIMULNXT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '23' TO FIO-STAT
               GO TO FIN-CMN-ING.
      *RVM-CST-FIN 15-MAY-1997

           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO CAN-NUM-DTRN IN CAN.
           MOVE HOY-MHOY IN HOY-VARI TO CAN-NUM-MTRN IN CAN.
           MOVE HOY-AHOY IN HOY-VARI TO CAN-NUM-ATRN IN CAN.
           MOVE HOY-SHOY IN HOY-VARI TO CAN-NUM-STRN IN CAN.
           MOVE HOY-HHOY IN HOY-VARI TO CAN-HRA-HRTR IN CAN.

      *ISP ES NECESARIO TENER LOS DATOS DE LA OPERACION
           PERFORM GET-OPC.

           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
                MOVE 1 TO CAN-NUM-TVCC IN CAN
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
                MOVE OPC-NUM-VCVG IN OPC TO CAN-NUM-TVCC IN CAN
           ELSE
           IF SCR-MSC-FCAN = 'I' OR 'P'
                MOVE ZEROES TO CAN-NUM-TVCC IN CAN
           ELSE
                MOVE 1 TO CAN-NUM-TVCC IN CAN.

      *ISP-INI CANAL                                                    
           MOVE SCR-ORIG  TO CAN-COD-OTRN IN CAN.                       
      *ISP-FIN CANAL                                                    
      *AFRI-INI/OCT2004                                                 
           IF EIBTRNID = 'SAF4' OR                                      
              SCR-CNAL = '170'                                          
               MOVE 'SAFE' TO CAN-COD-OTRN IN CAN.                      
      *AFRI-FIN/OCT2004                                                 
      *ISP ASUME CANCELACION NO VERIFICADA
           MOVE 'I' TO WSS-MSG-FENT.
           MOVE 'I' TO CAN-MSC-STAT IN CAN.
           PERFORM VRF-ACT-CYA.
           IF NOT PGM-STAT-CYA-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
           PERFORM CHK-PNR-BGT.

      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/04-2012
           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-CAE-DCAN IN CAE-VARI.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-CAE-MCAN IN CAE-VARI.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-CAE-SCAN IN CAE-VARI.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-CAE-ACAN IN CAE-VARI.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO WSS-CAE-DVEN IN CAE-VARI.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO WSS-CAE-MVEN IN CAE-VARI.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO WSS-CAE-SVEN IN CAE-VARI.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO WSS-CAE-AVEN IN CAE-VARI.
           IF WSS-CAE-FCAN IN CAE-VARI NOT > WSS-CAE-FVEN IN CAE-VARI
            AND CAN-MSC-CANC IN CAN-FLD = 'CTE'
            AND OPC-COD-TOOC IN OPC = 'CAE'
              PERFORM LEE-CXE-RCAE
              IF WSS-CXE-ICAE IN CAE-VARI = 'S'
                 PERFORM DET-VAL-TPAG
                 IF WSS-CAE-MENS IN CAE-VARI > SPACES
                    MOVE 'S' TO SCR-IERR
                    MOVE WSS-CAE-MENS IN CAE-VARI TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MEN1
                    PERFORM BCK-OUT
                    GO TO FIN-CMN-ING.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/04-2012
      *AFRI-INI/DEVOLUCION SEGUROS/12-2013
           IF SCR-SGV-MDPT > ZEROES
                COMPUTE CAN-SGV-TPAG IN CAN = CAN-SGV-TPAG IN CAN +
                                              SCR-SGV-MDPT.
      *AFRI-FIN/DEVOLUCION SEGUROS/12-2013
      *>>>>
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
      *DAD ini  18-JUN-1993 / 07-JUN-1993   (Memo.03-06-93)
               IF FIO-STAT = '02' OR '22'
                   MOVE 'GNS'     TO MSG-COD-SIST
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE CAN-KEY-ICAN IN CAN TO FRM-MEN2
                   PERFORM BCK-OUT
                   GO TO FIN-CMN-ING
               ELSE
                   PERFORM BCK-OUT
      *DAD fin  18-JUN-1993 / 07-JUN-1993
                   GO TO FIN-CMN-ING.

           PERFORM ACT-ICG.
           IF NOT PGM-STAT-ICG-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.

           PERFORM ACT-COM.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.

           PERFORM ACT-COM-FLV.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE FIO-MENS TO FRM-MENS                                
               PERFORM BCK-OUT                                          
               GO TO FIN-CMN-ING.                                       
                                                                        
      *DPM ini  11-OCT-1996 Los perform siguientes fueron cambiados
      *de prioridad para calcular CAN-SGV-IMOK
           IF SCR-MSC-TCAN = 'R' OR 'P' OR 'K'
               PERFORM ASS-OPC-ROV.

           PERFORM ACT-RCV.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *DPM fin  11-OCT-1996

      *LOP-INI IFRS
           PERFORM ACT-CXE.                                             
           IF NOT FIO-STAT-OKS                                          
               MOVE FIO-MENS TO FRM-MENS                                
               PERFORM BCK-OUT                                          
               GO TO FIN-CMN-ING.                                       
      *LOP-FIN IFRS
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
           PERFORM ACT-CXE-JUD.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE FIO-MENS TO FRM-MENS                                
               PERFORM BCK-OUT                                          
               GO TO FIN-CMN-ING.                                       
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
           PERFORM ACT-CXE-CONO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *AFRI-INI/LOF/CHC/07-2009
           PERFORM ACT-CXE-FGP.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *AFRI-FIN/LOF/CHC/07-2009
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
           PERFORM ACT-CXE-FIN.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
           PERFORM ACT-CXE-COM-CAE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
           PERFORM ACT-CXE-DPS.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS

      *AFRI-INI/DEVOLUCION SEGUROS/12-2013
           IF SCR-SGV-MDPT > ZEROES
              PERFORM DPS-ACT-CAN.
      *AFRI-FIN/DEVOLUCION SEGUROS/12-2013

      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/04-2012
           IF WSS-CXE-ICAE IN CAE-VARI = 'S'
              PERFORM CAE-ACT-CAN
              IF WSS-CAE-MENS IN CAE-VARI > SPACES
                 MOVE 'S' TO SCR-IERR
                 MOVE WSS-CAE-MENS IN CAE-VARI TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MEN1
                 PERFORM BCK-OUT
                 GO TO FIN-CMN-ING.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/04-2012

       END-CMN-ING.
           IF CYA-IND-TCYA IN CAN-FLD = 'M'
               MOVE CAN-CAI-IOPC IN CAN-FLD TO SCR-CAI-IOPC
               MOVE CAN-IIC-IOPC IN CAN-FLD TO SCR-IIC-IOPC
               MOVE CAN-NUM-ICAN IN CAN-FLD TO SCR-NUM-IDOC
               MOVE 2 TO WSS-IDX-ICYA
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-ICYA)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-ICYA)
               PERFORM EGR-FPEN-CIC.
      *>>>>
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
      *<<<< INI_CMN_ACC
           IF SCR-CMND NOT = 'VRF'
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'CMDINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM KEY-ALL-CAN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS AND
              CAN-STP-ITRN IN CAN NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM COL-FIO-CAN
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-CAN
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
      *<<<< CMN_ACC_RET
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           IF CAN-SGV-TPAG IN CAN > ZEROES
               PERFORM PRO-CYA.
           IF ROV-IIC-IOPC IN CAN-FLD > ZEROES
               PERFORM PRO-ROV-ACT.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM RET-ALL-CAN.
      *<<<< CMN_ACC
           MOVE 'V' TO CAN-MSC-STAT IN CAN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE 'COL' TO MSG-COD-SIST.
           MOVE 'CAN    VRFOK' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-CAN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS AND
              CAN-STP-ITRN IN CAN NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM COL-FIO-CAN
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-CAN
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-CAN.
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS                                          
      *        Error inconsistencia en la modificacion : informar       
               MOVE FIO-MENS TO FRM-MENS                                
               GO TO FIN-CMN-ELI.                                       
                                                                        
       LUP-ELI-CYA.                                                     
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.             
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.             
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-CYA.                                         
           IF ( FIO-STAT-OKS AND                                        
                CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND           
                CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )             
               MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
               PERFORM COL-FIO-CYA                                      
               MOVE FIO-DEL TO FIO-CMND                                 
               PERFORM COL-FIO-CYA                                      
               GO TO LUP-ELI-CYA.                                       
                                                                        
       LUP-ELI-RCV.                                                     
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV.             
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.             
           MOVE SPACES              TO RCV-CIC-IOPV IN RCV.             
           MOVE ZEROES              TO RCV-NUM-IVCT IN RCV.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-RCV.                                         
           IF FIO-STAT-OKS AND                                          
              CAN-CIC-IOPC IN CAN = RCV-CIC-IOPC IN RCV AND             
              CAN-NUM-ICAN IN CAN = RCV-NUM-ICAN IN RCV                 
               MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
               PERFORM COL-FIO-RCV                                      
               MOVE FIO-DEL TO FIO-CMND                                 
               PERFORM COL-FIO-RCV                                      
               GO TO LUP-ELI-RCV.                                       
                                                                        
       LUP-ELI-RCV-CXE.                                                 
           MOVE CAN-CIC-IOPC IN CAN TO CXE-KEY-IOPC IN CXE.             
           MOVE 'RCV'               TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN TO CXE-NUM-EVEN IN CXE.             
           MOVE SPACES              TO CXE-CIC-IOPV IN CXE.             
           MOVE ZEROES              TO CXE-NUM-IVCT IN CXE.             
           MOVE SPACES              TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-CXE.                                         
           IF FIO-STAT-OKS AND                                          
              CAN-CIC-IOPC IN CAN = CXE-KEY-IOPC IN CXE AND             
              CXE-COD-EVEN IN CXE = 'RCV'               AND             
              CAN-NUM-ICAN IN CAN = CXE-NUM-EVEN IN CXE                 
               MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
               PERFORM COL-FIO-CXE                                      
               MOVE FIO-DEL TO FIO-CMND                                 
               PERFORM COL-FIO-CXE                                      
               GO TO LUP-ELI-RCV-CXE.                                   
                                                                        
       LUP-ELI-RCV-CAN.                                                 
           MOVE CAN-CIC-IOPC IN CAN TO CXE-KEY-IOPC IN CXE.             
           MOVE 'CAN'               TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN TO CXE-NUM-EVEN IN CXE.             
           MOVE SPACES              TO CXE-CIC-IOPV IN CXE.             
           MOVE ZEROES              TO CXE-NUM-IVCT IN CXE.             
           MOVE SPACES              TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-CXE.                                         
           IF FIO-STAT-OKS AND                                          
              CAN-CIC-IOPC IN CAN = CXE-KEY-IOPC IN CXE AND             
              CXE-COD-EVEN IN CXE = 'CAN'               AND             
              CAN-NUM-ICAN IN CAN = CXE-NUM-EVEN IN CXE                 
               MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
               PERFORM COL-FIO-CXE                                      
               MOVE FIO-DEL TO FIO-CMND                                 
               PERFORM COL-FIO-CXE                                      
               GO TO LUP-ELI-RCV-CAN.                                   
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
       LUP-ELI-DPS-CXE.
           MOVE CAN-CIC-IOPC IN CAN TO CXE-KEY-IOPC IN CXE.
           MOVE DPS-COD-EVPA        TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES              TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES              TO CXE-NUM-IVCT IN CXE.
           MOVE SPACES              TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = CXE-KEY-IOPC IN CXE AND
              CXE-COD-EVEN IN CXE = DPS-COD-EVPA        AND
              CAN-NUM-ICAN IN CAN = CXE-NUM-EVEN IN CXE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CXE
               MOVE FIO-DEL TO FIO-CMND
               PERFORM COL-FIO-CXE
               GO TO LUP-ELI-DPS-CXE.
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS
       LUP-ELI-ICG.                                                     
           MOVE CAN-CIC-IOPC IN CAN TO ICG-CIC-IOPC IN ICG.             
           MOVE CAN-NUM-ICAN IN CAN TO ICG-NUM-ICAN IN ICG.             
      * RBG/INI/25-NOV-1996                                             
      *    MOVE CAN-CIC-IOPC IN CAN TO ICG-CIC-IOPV IN ICG.             
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.             
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.             
           MOVE SPACES              TO ICG-IND-TTAS IN ICG.             
      *    MOVE 'INT'               TO ICG-IND-TTAS IN ICG.             
      * RBG/FIN/25-NOV-1996                                             
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-ICG.                                         
           IF FIO-STAT-OKS AND                                          
              CAN-CIC-IOPC IN CAN = ICG-CIC-IOPC IN ICG AND             
              CAN-NUM-ICAN IN CAN = ICG-NUM-ICAN IN ICG                 
                MOVE FIO-GET-KEY-UPD TO FIO-CMND                        
                PERFORM COL-FIO-ICG                                     
                MOVE FIO-DEL TO FIO-CMND                                
                PERFORM COL-FIO-ICG                                     
                IF FIO-STAT-OKS                                         
                    GO TO LUP-ELI-ICG.                                  
      *HZF-INI 29-04-2002                                               
       LUP-ELI-DIC.                                                     
           MOVE CAN-CIC-IOPC IN CAN TO DIC-CIC-IOPC IN DIC.             
           MOVE CAN-NUM-ICAN IN CAN TO DIC-NUM-ICAN IN DIC.             
           MOVE ZEROES              TO DIC-NUM-IDLC IN DIC.             
           MOVE SPACES              TO DIC-IND-TALG IN DIC.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-DIC.                                         
           IF FIO-STAT-OKS AND                                          
              CAN-CIC-IOPC IN CAN = DIC-CIC-IOPC IN DIC AND             
              CAN-NUM-ICAN IN CAN = DIC-NUM-ICAN IN DIC                 
               MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
               PERFORM COL-FIO-DIC                                      
               MOVE FIO-DEL TO FIO-CMND                                 
               PERFORM COL-FIO-DIC                                      
               GO TO LUP-ELI-DIC.                                       
      *HZF-FIN 29-04-2002                                               
           MOVE ROV-CAI-IOPC IN CAN-FLD TO ROV-CAI-IOPC IN ROV.         
           MOVE ROV-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPC IN ROV.         
           MOVE CAN-CAI-IOPC IN CAN-FLD TO ROV-CAI-IOPV IN ROV.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPV IN ROV.         
           MOVE CAN-NUM-ICAN IN CAN-FLD TO ROV-NUM-IVCT IN ROV.         
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM COL-FIO-ROV.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DEL TO FIO-CMND                                 
               PERFORM COL-FIO-ROV                                      
           ELSE                                                         
               MOVE '00' TO FIO-STAT.                                   
           MOVE FIO-STAT TO PGM-STAT-ROV.                               
      *>>>>
       FIN-CMN-ELI.
           EXIT.


       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE CAN-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO CAN-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-CAN
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CAN-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CAN
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-CAN.
           PERFORM VAL-IKY-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-CAN.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM FST-KEY-CAN.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CAN.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-CAN
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CAN-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-CAN
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-CAN.
           PERFORM VAL-IKY-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-CAN.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-CAN.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-CAN.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF8 OR
                            FRM-FFLD = FRM-FFLD-PF7 OR
                            FRM-FFLD = FRM-FFLD-PF5 OR
                            FRM-FFLD = FRM-FFLD-PF6 ) )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-CAN
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CAN-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CAN
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CAN
               PERFORM EDT-FLD-CAN
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
      *<<<< SCR_GFLD_VAL_FLD
      *ISP ES NECESARIO TENER LOS DATOS DE LA OPERACION
      *    PARA LA VALIDACION DE CAMPOS
           MOVE CAN-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO ERR-SCR-GFLD.

      *ISP ES NECESARIO TENER LOS DATOS DEL VENCIMIENTO
      *    PARA LA VALIDACION DE CAMPOS
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE SCR-VEN-NUM-IVEN        TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS OR VEN-STAT-ENO
                   MOVE VEN-NUM-IVEN IN VEN TO
                        VEN-NUM-IVCT IN VEN
                   MOVE '00' TO FIO-STAT
               ELSE
                   MOVE '23' TO FIO-STAT
           ELSE
               PERFORM COL-FIO-VEN.

           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VEN    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO ERR-SCR-GFLD.
      *ISP SI ES CREDITO REAJUSTABLE ==> VALOR PAGADO EN PESOS, CALCULOS
      *    EN LA MONEDA
      *     IF CAN-SGV-TPAG IN CAN-FLD = ZEROES
      *         GO TO NOT-VAL-CAN-SGV-TPAG.
      *
           PERFORM GET-MON.
           PERFORM VAL-FLD-CAN.                                         
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR               
               GO TO ERR-SCR-GFLD.                                      
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
           MOVE ZEROES       TO SCR-SGV-MDPT.
           MOVE SPACES       TO SCR-IND-NECU.
           MOVE ZEROES       TO SCR-FEC-FOUT.
           MOVE SPACES       TO SCR-VEC-SEG.
      *AFRI-FIN 10-SEP-2014 SELECCION DE SEGUROS
           PERFORM VAL-CON-FLD-CAN.                                     
      *BORRAR LOF
      *    MOVE VEN-NUM-IVEN IN VEN TO MSG-COD-MENS
      *    MOVE FRM-SUAR-MAL  TO FRM-SUAR
      *    GO TO FIN-SCR-GFLD
      *BORRAR LOF
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )       
               GO TO FIN-SCR-GFLD.                                      
           IF FRM-UCUR NOT > SPACES                                     
               PERFORM FST-FLD-CAN.                                     
       ERR-SCR-GFLD.                                                    
      *PTC-INI                                                          
           MOVE 'S' TO SCR-IERR.                                        
      *PTC-FIN                                                          
           PERFORM SCR-MSSG.                                            
           PERFORM EDT-KEY-CAN.                                         
           PERFORM EDT-FLD-CAN.                                         
           PERFORM SCR-PUTA.                                            
           PERFORM SCR-EXIT.                                            
           GO TO FIN-SCR-GFLD. 
      *>>>>
           PERFORM VAL-FLD-CAN.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-CAN.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-CAN.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CAN.
           PERFORM EDT-FLD-CAN.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD = FRM-FFLD-PF6 OR
                FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD = FRM-FFLD-PF8 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CAN-GLS-MEN2
               MOVE SCR-PRMT     TO CAN-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CAN-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-CAN
               PERFORM VAL-NUM-FLD-CAN.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD = FRM-FFLD-PF6 OR
                FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD = FRM-FFLD-PF8 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CAN-GLS-MEN2
               MOVE SCR-PRMT     TO CAN-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CAN-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO CAN-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
           IF NOT SCR-OFRM-SRV
           IF SCR-DESDE-CMN
               MOVE CAN-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CAN-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CAN-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CAN-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-CAN.
           PERFORM PRO-MKY-CAN.
           PERFORM PRO-AKY-CAN.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-IKY-CAN.
           PERFORM FST-KEY-CAN.
           MOVE SPACES TO WSS-IBLK-COMI.                                
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
           IF NOT SCR-OFRM-SRV
           IF SCR-DESDE-CMN
               MOVE CAN-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CAN-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CAN-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CAN-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-CAN.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-CAN.
           PERFORM FST-KEY-CAN.
           MOVE SPACES TO WSS-IBLK-COMI.                                
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           IF WSS-IBLK-COMI = 'C'                                       
              MOVE 'N' TO WSS-IBLK-COMI                                 
           ELSE                                                         
              MOVE SPACES TO WSS-IBLK-COMI.                             
           PERFORM PRO-IKY-CAN.
           PERFORM PRO-AKY-CAN.
           PERFORM UNP-MKY-CAN.
           PERFORM UNP-FLD-CAN.
           PERFORM FST-FLD-CAN.
      *<<<< FIN_HBL_FLD
      *ALD-BCI-INI
           MOVE FRM-CPIM-AEY TO CAN-SGV-GAST-ATR IN CAN-FLD.
      *ALD-BCI-FIN
           IF SCR-CYA-IND-MCYA = 'M'
               MOVE FRM-CPIM-AEY TO CYA-IND-TCYA-ATR IN CAN-FLD
               MOVE FRM-CPIM-AEY TO CYA-CAI-ICYA-ATR IN CAN-FLD
               MOVE FRM-CPIM-AEY TO CYA-IIC-ICYA-ATR IN CAN-FLD.
           IF ( SCR-CCPP = 'MOD' ) OR ( SCR-ACTU = SCR-ACTU-MOD )
               MOVE FRM-CPIM-AEY TO CAN-MSC-CANC-ATR IN CAN-FLD.

      *DAD ini  11-AUG-1992   (Memo.24-07-92 Pto.2)
      *DAD ini PTC
      *ISP PTC   EN PLATAFORMA NO ES NECESARIA ESTA VALIDACION
           IF NOT SCR-OFRM-SRV
               MOVE 'COL'          TO FIO-SIST
               MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
               MOVE 'OFIUSPCANING' TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND
                  TAB-MSC-STAT IN TAB = 'S'
                  PERFORM VAL-OFI-USP.
      *DAD fin PTC
      *DAD fin  11-AUG-1992
      *DAD ini  12-NOV-1992
           IF FRM-GLS-IITR IN CAN-FLD NOT = FRM-GLS-TINT IN CAN-FLD
               PERFORM BASE-TASA-INI.
      *DAD fin  12-NOV-1992
      *>>>>
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO CAN-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-CAN.
           PERFORM PRO-FLD-CAN.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CAN
               PERFORM EDT-FLD-CAN
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               IF SCR-STAT NOT = SCR-STPP
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CAN
               PERFORM EDT-FLD-CAN
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               IF SCR-STAT NOT = SCR-STPP
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CAN.
           PERFORM EDT-FLD-CAN.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-CAN.
           PERFORM PRO-FLD-CAN.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-CAN
               PERFORM EDT-FLD-CAN.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CAN-GLS-MEN2
               MOVE SCR-CONF     TO CAN-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CAN-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-CAN
               PERFORM VAL-NUM-FLD-CAN
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-CAN
                   PERFORM VAL-NUM-FLD-CAN
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.


       PGM-EBR-ALL SECTION.
       INI-PGM-EBR-ALL.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM COL-FIO-CAN.
       FIN-PGM-EBR-ALL.
           EXIT.


       COPY COLBMCAN.
       COPY COLBFCAN.
       COPY GNSBVNUM.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      *COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVTDU.
       COPY TABBFUSR.

      *<<<< ( EOF ) AND ( NOT PGM_VSI )
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
      *<<<< EOF
       COPY COLBFDIC.                                                   

       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       GNS-CLR-RQA SECTION.
       INI-GNS-CLR-RQA.
           MOVE SPACES TO SCR-CAN-REQA.
           MOVE SPACES TO SCR-KEY-ICAN.
       FIN-GNS-CLR-RQA.
           EXIT.
      *>>>>
      *<<<< EOF
      *DAD ini  11-AUG-1992   (Memo.24-07-92 Pto.2)
       VAL-OFI-USP SECTION.
       INI-VAL-OFI-USP.
           COPY USPC143.
      *PVG INI 05-DIC-2003 HABILITA OFICINA CANCELACION PARA CMND=ICM   
           IF SCR-CMND = 'ICM'                                          
              GO TO FIN-VAL-OFI-USP.                                    
      *PVG FIN 05-DIC-2003                                              
           MOVE FRM-CPIM-AEY    TO CAN-COD-OFCA-ATR IN CAN-FLD.
           MOVE USP-COD-OFICINA TO CAN-COD-OFCA IN CAN-FLD.
       FIN-VAL-OFI-USP.
           EXIT.
      *DAD fin  11-AUG-1992

       CHK-PNR-BGT SECTION.
       INI-CHK-PNR-BGT.
           MOVE SPACES TO MSG-COD-MENS.
      *Busca dato 'como opera=wss-opec'
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'CANTOOCNEX' TO MSG-COD-MENS
               GO TO FIN-CHK-PNR-BGT.
           MOVE TOC-MSC-OPEC IN TOC TO WSS-OPEC.
      *Si es una prorroga,novacion,renovacion de boleta de garantia
      *debe sumar el RCV-SGV-CAPI (en $ si corresponde) al CAN-SGV-TREN
           IF NOT ( ( CAN-MSC-TCAN = 'N' OR 'R' OR 'P' OR 'K' ) AND
              ( WSS-OPEC = 'B' ) )
               GO TO FIN-CHK-PNR-BGT.
      *Busca cic de moneda para saber si transforma a $
           MOVE 'TAB' TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               GO TO FIN-CHK-PNR-BGT.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.
      *si es moneda reajustable ( chilena y no pesos ) entonces
      *convierte a pesos
           IF NOT ( WSS-CIC-TVAL     = '0' AND
                    WSS-CIC-VCAM NOT = '0999' )
               MOVE RCV-SGV-CAPI IN RCV TO WSS-VAL-SVEN
               GO TO SUM-CHK-PNR-BGT.

           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE '0999  '            TO TAB-CIC-CTAB IN TAB.
           MOVE CAN-FEC-FCAN IN CAN TO TAB-FEC-FTRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MULTIPLY RCV-SGV-CAPI IN RCV BY CAM-SGV-VCAM IN CAM
                        GIVING WSS-VAL-SVEN ROUNDED
           ELSE
               GO TO FIN-CHK-PNR-BGT.
           MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       SUM-CHK-PNR-BGT.
      *    ADD WSS-VAL-SVEN TO CAN-SGV-TREN IN CAN.                     
      *AFRI-INI/CHC/OCT-2007/PTT-BGT                                    
           MOVE WSS-VAL-SVEN TO CAN-SGV-TREN IN CAN.                    
      *AFRI-FIN/CHC/OCT-2007/PTT-BGT                                    
       FIN-CHK-PNR-BGT.
           EXIT.

       COPY GNSBGCAM.
       COPY COLBFTMC.
       COPY COLBFCYA.
       COPY COLBFICG.
       COPY COLBFITR.
       COPY SGCBFDBC.
      * RBG/INI/12-NOV-1996
       COPY SGCBFDCE.
       COPY SGCBFDCP.
       COPY COLBFCOM.
      * RBG/FIN/12-NOV-1996
       COPY COLBFOPC.
       COPY COLBFRCV.
       COPY COLBFROV.
       COPY COLBFVEN.
       COPY COLBFRDC.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY GNSBGCPT.
       COPY COLBGCLI.
       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY TABBFCAM.
       COPY TABBFVLR.
      *AFRI-INI/07-2006
       COPY TABBFTIO.
      *AFRI-FIN/07-2006
      *DPM ini  14-OCT-1996
       COPY COLBGMPC.
      *DPM fin  14-OCT-1996
       COPY COLBGVEN.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY GNSBGCVI.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFTOC.
       COPY GNSBGPES.
       COPY GNSBPFEC.
      *DAD ini PTC
       COPY GNSBGQUE.
       COPY GNSBGTSK.                                                   
      *DAD fin PTC
      *DAD ini  04-AGO-1993   (Memo.28-06-93)
       COPY COLBGVDI.
      *DAD fin  04-AGO-1993

       COPY COLB3CAN.
      *LOP-INI IFRS
       COPY COLB1IFR.                                                   
      *LOP-FIN IFRS

       PRO-CYA SECTION.
       INI-PRO-CYA.
           MOVE SPACES TO WSS-MSC-CACC.
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
                    CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CAN    NOCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-DATA TO FRM-MEN2
               GO TO FIN-PRO-CYA.
       LUP-PRO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
                    CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
               GO TO SIG-PRO-CYA.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               MOVE 'TAB'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF FIO-STAT-OKS
                   IF MSC-CIC-CMSC IN MSC = 'CC'
                       IF ( WSS-MSC-CACC > SPACES ) AND
                          ( WSS-MSC-CACC NOT = 'CC' )
                           MOVE 'CANTCYACC=<>' TO MSG-COD-MENS
                           GO TO MSG-PRO-CYA
                       ELSE
                           MOVE MSC-CIC-CMSC IN MSC TO WSS-MSC-CACC
                   ELSE
                       IF ( WSS-MSC-CACC > SPACES ) AND
                          ( WSS-MSC-CACC = 'CC' )
                           MOVE 'CANTCYACC=<>' TO MSG-COD-MENS
                           GO TO MSG-PRO-CYA
                       ELSE
                           MOVE MSC-CIC-CMSC IN MSC TO WSS-MSC-CACC
               ELSE
                   MOVE 'CYATCYANEX' TO MSG-COD-MENS
                   MOVE CYA-IND-TCYA IN CYA TO FRM-MEN2
                   GO TO MSG-PRO-CYA
           ELSE
               MOVE 'CYATCYABLK' TO MSG-COD-MENS
               MOVE CYA-KEY-ICYA IN CYA TO FRM-MEN2
               GO TO MSG-PRO-CYA.
      *
           ADD CYA-SGV-LIQU IN CYA TO WSS-SGV-TCYA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           GO TO LUP-PRO-CYA.
       SIG-PRO-CYA.
           IF WSS-MSC-CACC = 'CC' AND
              ( SCR-MSC-TCAN = 'P' OR 'N' OR 'R' OR 'K' )
               MOVE 'OPCPRGACCTNO' TO MSG-COD-MENS
               GO TO MSG-PRO-CYA.
           IF WSS-SGV-TCYA NOT = CAN-SGV-TPAG IN CAN
               MOVE WSS-SGV-TCYA TO WSS-NUM-FEDT
               MOVE CAN-SGV-TPAG IN CAN TO WSS-NUM-FALF
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CAN    TCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE SPACES TO WSS-MSJS
               MOVE MSG-GLS-DESC TO WSS-MSJ0
               MOVE WSS-NUM-FEDT TO WSS-MSJ1
               MOVE MSG-GLS-DATA TO WSS-MSJ2
               MOVE WSS-NUM-FALF TO WSS-MSJ3
               MOVE WSS-MSJS TO FRM-MENS.
           GO TO FIN-PRO-CYA.
       MSG-PRO-CYA.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-PRO-CYA.
           EXIT.

       VRF-ACT-CYA SECTION.
       INI-VRF-ACT-CYA.
           MOVE '00' TO PGM-STAT-CYA.
           MOVE 'CAN      '  TO WSS-MSG-PREV.
           MOVE SCR-MSC-TCAN TO WSS-MSG-TENT.
           MOVE 'N'          TO WSS-MSG-SENT.
           IF CYA-IND-TCYA IN CAN-FLD = 'M'
               GO TO MSG-VRF-ACT-CYA.

           PERFORM ACT-CYA.
           IF NOT PGM-STAT-CYA-OKS
                MOVE FIO-STAT TO PGM-STAT-CYA
                GO TO FIN-VRF-ACT-CYA.

      *     IF CAN-SGV-TPAG IN CAN = CYA-SGV-LIQU IN CYA
           MOVE 'V' TO CAN-MSC-STAT IN CAN.
           MOVE 'V' TO WSS-MSG-SENT.

       MSG-VRF-ACT-CYA.
           MOVE 'COL' TO MSG-COD-SIST.
           MOVE WSS-MSG-MENS TO MSG-COD-MENS.
           PERFORM GET-MSG.
           IF WSS-MSG-SENT = 'N'
               MOVE WSS-SGV-TCYA TO WSS-NUM-FEDT
               MOVE CAN-SGV-TPAG IN CAN TO WSS-NUM-FALF
               MOVE SPACES TO WSS-MSJS
               MOVE MSG-GLS-DESC TO WSS-MSJ0
               MOVE WSS-NUM-FEDT TO WSS-MSJ1
               MOVE MSG-GLS-DATA TO WSS-MSJ2
               MOVE WSS-NUM-FALF TO WSS-MSJ3
               MOVE WSS-MSJS TO FRM-MENS
            ELSE
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-DATA TO FRM-MEN2.
       FIN-VRF-ACT-CYA.
           EXIT.

      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-INST-GKY TO SCR-INST.
           PERFORM HBL-KEY.
           PERFORM SCR-CLRA-CAN.
           PERFORM EDT-KEY-CAN.
           PERFORM EDT-FLD-CAN.
      *     MOVE SCR-MENS-EXT TO CAN-GLS-MENS.
      *GET-MSG Busca mensaje en tabla
           MOVE 'GNS' TO MSG-COD-SIST.
           MOVE 'MSGKEY' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO CAN-GLS-MENS.
           MOVE SPACES TO SCR-CIC-IOPC
                          SCR-VEC-ENG
                          SCR-VEC-FST
                          SCR-IND-EOV
                          SCR-INST-EXT
                          SCR-MENS-EXT.
           PERFORM SCR-INIT.
           PERFORM SCR-EXIT.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-FTER-CMN SECTION.
       INI-ING-FTER-CMN.
           PERFORM ING-SETE.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-CAN.
           MOVE SCR-MENS-EXT TO CAN-GLS-MENS.
           PERFORM SCR-INIT.
       FIN-ING-FTER-CMN.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.
       FIN-ING-SETE.
           EXIT.

       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE 1 TO SCR-IPRO.
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CIC.
           EXIT.

       EGR-FTER-CMN SECTION.
       INI-EGR-FTER-CMN.
           PERFORM CRG-TBL-ENG.
           MOVE 1 TO SCR-IPRO.
           MOVE WSS-INST-FTER-CMN TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CMN.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE CAN-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
       COPY COLBGMPT.

       PRO-ROV-ACT SECTION.
       INI-PRO-ROV-ACT.
           MOVE ROV-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE ROV-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS AND
              OPC-MSC-STAT IN OPC = 'A'
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'ROV    YAACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-PRO-ROV-ACT.
           EXIT.
      *
      * PRO-CYA SECTION.
      * INI-PRO-CYA.
      *     MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
      *     MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
      *     MOVE ZEROES TO CYA-NUM-ICYA IN CYA.
      *     MOVE FIO-GET-NLS TO FIO-CMND.
      * LUP-PRO-CYA.
      *     PERFORM COL-FIO-CYA.
      *     IF FIO-STAT-OKS AND
      *        CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
      *        CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA
      *           ADD CYA-SGV-LIQU IN CYA TO WSS-SGV-TCYA
      *           MOVE FIO-GET-NXT TO FIO-CMND
      *           GO TO LUP-PRO-CYA.

      *     IF WSS-SGV-TCYA NOT = CAN-SGV-TPAG IN CAN
      * FIN-PRO-CYA.
      *     EXIT.

      ******************************************************************
       ACT-COM SECTION.
      ****************
       INI-ACT-COM.
           MOVE CAN-CAI-IOPC IN CAN TO ICG-CAI-IOPC IN ICG.
           MOVE CAN-IIC-IOPC IN CAN TO ICG-IIC-IOPC IN ICG.
           MOVE CAN-NUM-ICAN IN CAN TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE SPACES              TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-ACT-COM2.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              CAN-CAI-IOPC IN CAN = ICG-CAI-IOPC IN ICG AND
              CAN-IIC-IOPC IN CAN = ICG-IIC-IOPC IN ICG AND
              CAN-NUM-ICAN IN CAN = ICG-NUM-ICAN IN ICG
                IF ICG-IND-TTAS IN ICG NOT = 'CMO'
                    MOVE FIO-GET-NXT TO FIO-CMND
                    GO TO LUP-ACT-COM2
                ELSE
                    MOVE FIO-GET-KEY-UPD TO FIO-CMND
                    PERFORM COL-FIO-ICG
                    MOVE FIO-DEL TO FIO-CMND
                    PERFORM COL-FIO-ICG.

           IF CAN-SGV-GAST IN CAN NOT > ZEROES
               MOVE '00' TO FIO-STAT
               GO TO FIN-ACT-COM.


           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
                CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
                 MOVE '00' TO FIO-STAT
                 GO TO FIN-ACT-COM.

           MOVE 'TAB'               TO MSC-COD-SIST.
           MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC.
           MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.

           IF MSC-CIC-CMSC IN MSC NOT = 'CAJA'
               GO TO FIN-ACT-COM.
      *-------------------------------------------------*
      *INI-JGM 01-06-2000.
           MOVE CAN-CIC-IOPC IN CAN TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CIC-IOPC IN CAN = RDC-CIC-IOPC IN RDC )
                     GO TO FIN-ACT-COM.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACT-COM.

      *
            MOVE 'S' TO WSS-IND-SGAS IN WSS-VARI.
      *
           IF DBC-IND-TICL IN DBC = 'P'
              MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM SGC-FIO-DCP
              IF NOT FIO-STAT-OKS
                   GO TO FIN-ACT-COM
               ELSE
                   MOVE DCP-COD-TBAN IN DCP TO WSS-COD-BANC IN WSS-VARI
                   PERFORM CHK-EXI-TBAN-CCM
                   IF WSS-IND-EBAN IN WSS-VARI = 'S'
                       GO TO SIG-CON-BANC-CCM
                   ELSE
                   GO TO FIN-ACT-COM
           ELSE
              IF DBC-IND-TICL IN DBC = 'E'
                 MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM SGC-FIO-DCE
                 IF NOT FIO-STAT-OKS
                   GO TO FIN-ACT-COM
                 ELSE
                   MOVE DCE-COD-TBAN IN DCE TO WSS-COD-BANC
                                                    IN WSS-VARI
                      PERFORM CHK-EXI-TBAN-CCM
                      IF WSS-IND-EBAN IN WSS-VARI = 'S'
                          GO TO SIG-CON-BANC-CCM
                      ELSE
                          GO TO FIN-ACT-COM.
      *-----------------------------------------------------*
       SIG-CON-BANC-CCM.
      *    MOVE 'COL'       TO FIO-SIST.
      *    MOVE 'CMO'       TO TAB-COD-TTAB IN TAB.
      *    MOVE SPACES      TO TAB-COD-CTAB IN TAB.
      *    MOVE FIO-GET-KEY TO FIO-CMND.
      *    PERFORM GNS-FIO-TAB.
      *    MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.

           IF WSS-COD-MONE IN WSS-VARI = '0999  '
               MOVE 1 TO WSS-SGV-VCAM IN WSS-VARI
               GO TO CONT-SIN-VCAM.

           MOVE WSS-COD-MONE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999  '                 TO CAM-COD-VCAM IN CAM(2).
           MOVE CAN-NUM-DCAN IN CAN      TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAN-NUM-MCAN IN CAN      TO CAM-NUM-MCAM IN CAM(1).
           MOVE CAN-NUM-SCAN IN CAN      TO CAM-NUM-SCAM IN CAM(1).
           MOVE CAN-NUM-ACAN IN CAN      TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM.
       CONT-SIN-VCAM.
           MULTIPLY WSS-VAL-MOUF IN WSS-VARI BY WSS-SGV-VCAM IN
                              WSS-VARI GIVING WSS-SGV-NETO IN WSS-VARI.
      * Voy a buscar el Iva.
           MOVE 'TAB'       TO FIO-SIST.
           MOVE 'IVA'       TO TAB-COD-TTAB IN TAB.
           MOVE SPACES      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DAT2 IN WSS-VARI.

           DIVIDE WSS-NUM-PIVA IN WSS-VARI BY 100 GIVING WSS-VAL-IVA IN
                                                               WSS-VARI.
           MULTIPLY WSS-SGV-NETO IN WSS-VARI BY WSS-VAL-IVA IN WSS-VARI
                                        GIVING WSS-SGV-MIVA IN WSS-VARI.

           MOVE WSS-SGV-MIVA IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-MIVA IN WSS-VARI.

           MOVE WSS-SGV-NETO IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-NETO IN WSS-VARI.

           SUBTRACT WSS-SGV-MIVA IN WSS-VARI FROM CAN-SGV-GAST IN CAN
                                      GIVING WSS-SGV-DELT IN WSS-VARI.

           IF WSS-SGV-DELT IN WSS-VARI NOT = WSS-SGV-NETO IN WSS-VARI
               GO TO FIN-ACT-COM.

           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE CAN-CIC-IOPC IN CAN     TO COM-CIC-IOPC IN COM.
           MOVE ZEROES                  TO COM-NUM-ICAN IN COM.
           MOVE SPACES                  TO COM-CIC-IOPV IN COM.
           MOVE ZEROES                  TO COM-NUM-IVCT IN COM.
           MOVE SPACES                  TO COM-IND-TTAS IN COM.
           MOVE ZEROES                  TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-FEC-COM.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
               COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC )
                MOVE 'N' TO WSS-IND-HAYA IN WSS-VARI
           ELSE
               IF COM-IND-TTAS IN COM NOT = 'CMO'
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-FEC-COM
               ELSE
                   IF COM-NUM-ICAN IN COM = CAN-NUM-ICAN IN CAN
                       MOVE 'S' TO WSS-IND-HAYA IN WSS-VARI
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-FEC-COM.


           IF WSS-IND-HAYA IN WSS-VARI = 'N'
               IF CAN-SGV-GAST IN CAN NOT > ZEROES
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-ACT-COM
               ELSE
               MOVE WSS-SGV-MIVA IN WSS-VARI TO COM-SGV-MIVA IN COM
               MOVE WSS-SGV-NETO IN WSS-VARI TO COM-SGV-MNTO IN COM
               MOVE CAN-CAI-IOPC IN CAN      TO COM-CAI-IOPC IN COM
               MOVE CAN-IIC-IOPC IN CAN      TO COM-IIC-IOPC IN COM
               MOVE CAN-NUM-SOUT IN CAN      TO COM-NUM-SINI IN COM
               MOVE CAN-NUM-AOUT IN CAN      TO COM-NUM-AINI IN COM
               MOVE CAN-NUM-MOUT IN CAN      TO COM-NUM-MINI IN COM
               MOVE CAN-NUM-DOUT IN CAN      TO COM-NUM-DINI IN COM
               MOVE 'CMO'                    TO COM-IND-TTAS IN COM
               MOVE CAN-NUM-ICAN IN CAN      TO COM-NUM-ICAN IN COM
               MOVE CAN-CIC-IOPC IN CAN      TO COM-CIC-IOPV IN COM
               MOVE VEN-NUM-IVEN IN VEN      TO COM-NUM-IVCT IN COM
               MOVE ZEROES                   TO COM-FEC-FTRN IN COM
               MOVE ZEROES                   TO COM-HRA-HRTR IN COM
               MOVE SPACES                   TO COM-MSC-TACC IN COM
               MOVE SPACES                   TO COM-MSC-STAT IN COM
               MOVE SPACES                   TO COM-COD-OTRN IN COM
               MOVE SPACES                   TO COM-COD-ATRN IN COM
               MOVE SPACES                   TO COM-COD-TINT IN COM
               MOVE ZEROES                   TO COM-FEC-FTER IN COM
               MOVE ZEROES                   TO COM-SGV-SPRD IN COM
               MOVE ZEROES                   TO COM-SGV-TINT IN COM
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-COM
               GO TO FIN-ACT-COM.

           IF WSS-IND-HAYA IN WSS-VARI = 'S'
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-COM
               IF NOT FIO-STAT-OKS
                   GO TO FIN-ACT-COM
               ELSE
                   MOVE WSS-SGV-MIVA IN WSS-VARI TO COM-SGV-MIVA IN COM
                   MOVE WSS-SGV-NETO IN WSS-VARI TO COM-SGV-MNTO IN COM
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-COM
                   GO TO FIN-ACT-COM.
       FIN-ACT-COM.
           EXIT.
       ACT-COM-FLV SECTION.                                             
       INI-ACT-COM-FLV.                                                 
      *ACTUALIZA TASA DE COMISION                                       
           MOVE CAN-CAI-IOPC IN CAN-FLD TO ICG-CAI-IOPC IN ICG.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO ICG-IIC-IOPC IN ICG.         
           MOVE CAN-NUM-ICAN IN CAN-FLD TO ICG-NUM-ICAN IN ICG.         
           MOVE CAN-CAI-IOPC IN CAN-FLD TO ICG-CAI-IOPV IN ICG.         
           MOVE CAN-IIC-IOPC IN CAN-FLD TO ICG-IIC-IOPV IN ICG.         
           IF SCR-MSC-FCAN = 'T' AND                                    
              SCR-MSC-ECAN = 'T'                                        
              MOVE ZEROES                  TO ICG-NUM-IVCT IN ICG       
           ELSE                                                         
              MOVE VEN-NUM-IVEN IN CAN-FLD TO ICG-NUM-IVCT IN ICG.      
           MOVE 'FLV'                   TO ICG-IND-TTAS IN ICG.         
           MOVE CAN-NUM-SCAN IN CAN-FLD TO ICG-NUM-SINI IN ICG.         
           MOVE CAN-NUM-ACAN IN CAN-FLD TO ICG-NUM-AINI IN ICG.         
           MOVE CAN-NUM-MCAN IN CAN-FLD TO ICG-NUM-MINI IN ICG.         
           MOVE CAN-NUM-DCAN IN CAN-FLD TO ICG-NUM-DINI IN ICG.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-ICG.                                         
           IF FIO-STAT-OKS                                              
              MOVE FIO-GET-KEY-UPD TO FIO-CMND                          
              PERFORM COL-FIO-ICG                                       
              MOVE COM-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT IN ICG       
              MOVE FIO-MOD         TO FIO-CMND                          
              PERFORM COL-FIO-ICG                                       
           ELSE                                                         
              PERFORM INI-ICG                                           
              IF COM-SGV-TINT IN CAN-FLD > 0 OR                         
                 WSS-IBLK-COMI = 'N'                                    
                 MOVE COM-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT IN ICG    
                 MOVE FIO-PUT         TO FIO-CMND                       
                 PERFORM COL-FIO-ICG                                    
              ELSE                                                      
                 MOVE ZEROES TO FIO-STAT                                
              END-IF                                                    
           END-IF.                                                      
       FIN-ACT-COM-FLV.                                                 
           EXIT.                                                        
      *ALD-BCI-INI/22.04.1999
       COPY TABBKTXC.
      *ALD-BCI-FIN/22.04.1999
                                                                        
      *LOP-INI 20-01-2004 CREDITO SIN MORA                              
       COPY COLBFIXT.                                                   
      *AFRI-INI/ITE/SOP/01-2013
      *COPY COLBFIMP.
      *AFRI-FIN/ITE/SOP/01-2013
       COPY COLB1CXE.                                                   
       COPY COLBGCXE.                                                   
      *LOP-FIN 20-01-2004 CREDITO SIN MORA                              
      *AFRI-INI                                                         
       COPY COLBFCXE.                                                   
      *AFRI-FIN                                                         
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
       COPY COLBFCEN.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
      *AFRI-INI/LOF/CHC/07-2009
       COPY COLBGLOF.
       COPY LDCBFLCC.
       COPY LDCBFRLO.
      *AFRI-FIN/LOF/CHC/07-2009
                                                                        
      *HZF-INI 19-02-2001                                               
       COPY COLBGPVE.                                                   
      *HZF-FIN 19-02-2001                                               
       COPY COLB6CAN.                                                   
       PROCESA-PCP SECTION.                                             
       INI-PROCESA-PCP.                                                 
      *ADA-INI 08.07.2008                                               
           MOVE SCR-QIDD      TO PCP-QIDD.                              
           MOVE SCR-LIDD      TO PCP-LIDD.                              
           MOVE PCP-DINP      TO SYS-CMMA.                              
      *    MOVE 'COLPPPCP'    TO SYS-PROG.                              
      *    MOVE +1012         TO SYS-TCMA.                              
           MOVE 'COLPPPDC'    TO SYS-PROG.                              
           MOVE QUE-PDC-LITM  TO SYS-TCMA.                              
      *ADA-FIN 08.07.2008                                               
           MOVE SYS-LINK      TO SYS-CMND.                              
           PERFORM GNS-PRO-SYS.                                         
           MOVE SYS-CMMA TO PCP-DOUT.                                   
           IF PCP-RETO = '1'                                            
               MOVE SPACES TO PCP                                       
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'ERROR PCP'    TO PCP-CMSG MSG-COD-MENS             
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               MOVE PCP-MMSG       TO FRM-MEN2                          
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-PROCESA-PCP.                                   
       FIN-PROCESA-PCP.                                                 
           EXIT.                                                        
      *>>>>                                                             
      * ISP-INI INVOCADO POR COLB3CAN                                   
       PUT-TS-OPC SECTION.                                              
       INI-PUT-TS-OPC.                                                  
                                                                        
           IF NOT SCR-OFRM-SRV                                          
               GO TO FIN-PUT-TS-OPC.                                    
                                                                        
           MOVE PTC-OPC-TYPE-ROPC TO QUE-TYPE.                          
           MOVE TSK-TERM-ALF      TO QUE-TERM.                          
           MOVE PTC-OPC-LENG      TO QUE-LITM.                          
           MOVE 1                 TO QUE-NITM.                          
           MOVE QUE-GET           TO QUE-CMND.                          
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
              MOVE PTC-OPC-TYPE-ROPC TO QUE-TYPE                        
              MOVE TSK-TERM-ALF      TO QUE-TERM                        
              MOVE QUE-DEL           TO QUE-CMND                        
              PERFORM GNS-PRO-QUE                                       
              MOVE PTC-OPC-TYPE-ROPC TO QUE-TYPE                        
              MOVE TSK-TERM-ALF      TO QUE-TERM                        
              MOVE PTC-OPC-LENG      TO QUE-LITM                        
              MOVE CIC-CAI-ICIC      TO PTC-OPC-OPC-CAI-IOPC            
              MOVE CIC-IIC-ICIC      TO PTC-OPC-OPC-IIC-IOPC            
              MOVE PTC-OPC-ITEM      TO QUE-ITEM                        
              MOVE QUE-PUT           TO QUE-CMND                        
              PERFORM GNS-PRO-QUE.                                      
       FIN-PUT-TS-OPC.                                                  
           EXIT.                                                        
                                                                        
       NO-VAL-MLT SECTION.                                              
       INI-NO-VAL-MLT.                                                  
      *ISP MANEJO CODIGO DE CARGO                                       
      *    DESPUES DEL MANEJO DE VALOR PAGADO                           
           IF CAN-SGV-TPAG IN CAN-FLD > ZEROES OR                       
              ( CAN-SGV-TPAG IN CAN-FLD = ZEROES AND                    
                WSS-IBLK-TPAG = 'N' )                                   
              IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES                   
                   MOVE 'COL'        TO MSG-COD-SIST                    
                   MOVE 'INDTCYAOBL' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-NO-VAL-MLT                                 
               ELSE                                                     
                   MOVE CAN-NUM-DOUT IN CAN-FLD TO CAN-NUM-DOUT IN CAN  
                   MOVE CAN-NUM-MOUT IN CAN-FLD TO CAN-NUM-MOUT IN CAN  
                   MOVE CAN-NUM-SOUT IN CAN-FLD TO CAN-NUM-SOUT IN CAN  
                   MOVE CAN-NUM-AOUT IN CAN-FLD TO CAN-NUM-AOUT IN CAN  
                   MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN  
                   MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN  
                   MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN  
                   MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN  
                   MOVE 'TAB'                   TO MSC-COD-SIST         
                   MOVE 'TCYA'                  TO MSC-COD-TMSC IN MSC  
                   MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC  
                   PERFORM BUS-MSC                                      
      *AFRI-INI-DIC2005                                                 
      *            IF MSC-CIC-CMSC IN MSC = 'CAJA' AND                  
      *               CAN-FEC-FOUT IN CAN NOT = CAN-FEC-FCAN IN CAN     
      *                MOVE 'COL'          TO MSG-COD-SIST              
      *                MOVE 'CANOUTCANCJI' TO MSG-COD-MENS              
      *                PERFORM GET-MSG                                  
      *                MOVE MSG-GLS-DESC TO FRM-MENS                    
      *                MOVE FRM-SUAR-MAL TO FRM-SUAR                    
      *                GO TO FIN-NO-VAL-MLT                             
      *            ELSE                                                 
      *AFRI-FIN-DIC2005                                                 
      *ISP-INI  4-MAR-2004 21:15:59                                     
                   MOVE PTC-OPC-TYPE-ROPC TO QUE-TYPE                   
                   MOVE TSK-TERM-ALF      TO QUE-TERM                   
                   MOVE PTC-OPC-LENG      TO QUE-LITM                   
                   MOVE 1                 TO QUE-NITM                   
                   MOVE QUE-GET           TO QUE-CMND                   
                   PERFORM GNS-PRO-QUE                                  
                   IF QUE-STAT NOT = QUE-STAT-OKS                       
      *ISP-FIN  4-MAR-2004 21:15:59                                     
                       IF MSC-CIC-CMSC IN MSC = 'CC' AND                
      *HZF-INI 25-09-2001                                               
                         ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' OR 'K' )    
                          AND CAN-MSC-CANC IN CAN-FLD NOT = 'KTT'       
                          AND CAN-MSC-CANC IN CAN-FLD NOT = 'PTT'       
      *HZF-FIN 25-09-2001                                               
                         MOVE 'COL'          TO MSG-COD-SIST            
                         MOVE 'OPCPRGACCTNO' TO MSG-COD-MENS            
                         PERFORM GET-MSG                                
                         MOVE MSG-GLS-DESC TO FRM-MENS                  
                         MOVE FRM-SUAR-MAL TO FRM-SUAR                  
                         GO TO FIN-NO-VAL-MLT                           
                       ELSE                                             
                         NEXT SENTENCE                                  
      *ISP-INI  4-MAR-2004 21:15:59                                     
                   ELSE                                                 
                          NEXT SENTENCE                                 
      *ISP-FIN  4-MAR-2004 21:15:59                                     
           ELSE                                                         
               IF CYA-IND-TCYA IN CAN-FLD > SPACES                      
                 MOVE 'COL'        TO MSG-COD-SIST                      
                 MOVE 'INDTCYABLK' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-NO-VAL-MLT.                                  
                                                                        
       FIN-NO-VAL-MLT.                                                  
           EXIT.                                                        
      * ISP-FIN INVOCADO POR COLB3CAN                                   
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
       ACT-CXE-JUD SECTION.
       INI-ACT-CXE-JUD.
           IF SCR-SGV-JUDI NOT > ZEROES
               GO TO FIN-ACT-CXE-JUD.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE LOW-VALUES               TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE CAN-CAI-IOPC IN CAN-FLD  TO CXE-CAI-IOPC IN CXE.
           MOVE CAN-IIC-IOPC IN CAN-FLD  TO CXE-IIC-IOPC IN CXE.
           MOVE 'CAN'                    TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN-FLD  TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE 'GSTJUD'                 TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CXE
               MOVE FIO-MOD TO FIO-CMND.
           MOVE ZEROES                   TO CXE-STP-ITRN IN CXE.
           MOVE SPACES                   TO CXE-MSC-TACC IN CXE.
           MOVE SPACES                   TO CXE-MSC-STAT IN CXE.
           MOVE SPACES                   TO CXE-COD-OTRN IN CXE.
           MOVE SPACES                   TO CXE-COD-ATRN IN CXE.
           MOVE SPACES                   TO CXE-COD-TINT IN CXE.
           MOVE ZEROES                   TO CXE-SGV-TINT IN CXE.
           MOVE SCR-SGV-JUDI             TO CXE-SGV-MNTO IN CXE.
           MOVE SCR-SGV-JUDI             TO CXE-SGV-MCAL IN CXE.
           MOVE SPACES                   TO CXE-IND-DCTO IN CXE.
           MOVE SPACES                   TO CXE-COD-VCOC IN CXE.
           MOVE ZEROES                   TO CXE-SGV-MCAM IN CXE.
           MOVE SPACES                   TO CXE-CIC-IPLA IN CXE.
           MOVE SPACES                   TO CXE-COD-EVEX IN CXE.
           MOVE ZEROES                   TO CXE-FEC-FPLA IN CXE.
           MOVE ZEROES                   TO CXE-HRA-HPLA IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IPLA IN CXE.
           MOVE SPACES                   TO CXE-IND-CBRO IN CXE.
           MOVE ZEROES                   TO CXE-SGV-SALD IN CXE.
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO CXE-NUM-SVEN IN CXE.
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO CXE-NUM-AVEN IN CXE.
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO CXE-NUM-MVEN IN CXE.
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO CXE-NUM-DVEN IN CXE.
           MOVE SPACES                   TO CXE-IND-FOGA IN CXE.
           MOVE SPACES                   TO CXE-GLS-DISP IN CXE.
           PERFORM COL-FIO-CXE.
       FIN-ACT-CXE-JUD.
           EXIT.
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
       ACT-CXE-CONO SECTION.
       INI-ACT-CXE-CONO.
           IF SCR-SGV-CONO NOT > ZEROES
               GO TO FIN-ACT-CXE-CONO.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE LOW-VALUES               TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE CAN-CAI-IOPC IN CAN-FLD  TO CXE-CAI-IOPC IN CXE.
           MOVE CAN-IIC-IOPC IN CAN-FLD  TO CXE-IIC-IOPC IN CXE.
           MOVE WSS-GLS-EVCA             TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN-FLD  TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE WSS-GLS-CONO             TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CXE
               MOVE FIO-MOD TO FIO-CMND.
           MOVE ZEROES                   TO CXE-STP-ITRN IN CXE.
           MOVE SPACES                   TO CXE-MSC-TACC IN CXE.
           MOVE SPACES                   TO CXE-MSC-STAT IN CXE.
           MOVE SPACES                   TO CXE-COD-OTRN IN CXE.
           MOVE SPACES                   TO CXE-COD-ATRN IN CXE.
           MOVE SPACES                   TO CXE-COD-TINT IN CXE.
           MOVE ZEROES                   TO CXE-SGV-TINT IN CXE.
           MOVE SCR-SGV-CONO             TO CXE-SGV-MNTO IN CXE.
           MOVE SCR-SGV-CONO             TO CXE-SGV-MCAL IN CXE.
           MOVE SPACES                   TO CXE-IND-DCTO IN CXE.
           MOVE SPACES                   TO CXE-COD-VCOC IN CXE.
           MOVE ZEROES                   TO CXE-SGV-MCAM IN CXE.
           MOVE SPACES                   TO CXE-CIC-IPLA IN CXE.
           MOVE SPACES                   TO CXE-COD-EVEX IN CXE.
           MOVE ZEROES                   TO CXE-FEC-FPLA IN CXE.
           MOVE ZEROES                   TO CXE-HRA-HPLA IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IPLA IN CXE.
           MOVE SPACES                   TO CXE-IND-CBRO IN CXE.
           MOVE ZEROES                   TO CXE-SGV-SALD IN CXE.
           MOVE CAN-NUM-SCAN IN CAN-FLD  TO CXE-NUM-SVEN IN CXE.
           MOVE CAN-NUM-ACAN IN CAN-FLD  TO CXE-NUM-AVEN IN CXE.
           MOVE CAN-NUM-MCAN IN CAN-FLD  TO CXE-NUM-MVEN IN CXE.
           MOVE CAN-NUM-DCAN IN CAN-FLD  TO CXE-NUM-DVEN IN CXE.
           MOVE SPACES                   TO CXE-IND-FOGA IN CXE.
           MOVE SPACES                   TO CXE-GLS-DISP IN CXE.
           PERFORM COL-FIO-CXE.
       FIN-ACT-CXE-CONO.
           EXIT.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
      *AFRI-INI/LOF/CHC/07-2009
       ACT-CXE-FGP SECTION.
       INI-ACT-CXE-FGP.
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
      *    IF NOT (( SCR-MSC-FCAN = 'T' AND                             
      *         SCR-MSC-ECAN = 'E' ) OR                                 
      *       (  SCR-MSC-FCAN = 'T' AND                                 
      *          SCR-MSC-ECAN = 'T' ))                                  
      *        GO TO FIN-ACT-CXE-FGP.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
           IF SCR-SGV-CFGP NOT > ZEROES
            IF SCR-SGV-CMFG > ZEROES
               GO TO CON-ACT-CXE
            ELSE
               GO TO FIN-ACT-CXE-FGP.

       CON-ACT-CXE.

      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
           MOVE SPACES TO LOC-MSC-MCAN IN LOC-VARI.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
           MOVE SPACES TO MSG-COD-MENS.

           MOVE CAN-CAI-IOPC IN CAN-FLD TO LOC-CAI-IOPC IN LOC-VARI.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO LOC-IIC-IOPC IN LOC-VARI.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO LOC-NUM-ICAN IN LOC-VARI.
           MOVE SCR-SGV-CFGP            TO LOC-COM-FGPE IN LOC-VARI.
           MOVE SCR-SGV-CMFG            TO LOC-VAL-MCAN IN LOC-VARI.
           IF SCR-MSC-FCAN = 'T' AND                                    
              SCR-MSC-ECAN = 'E'                                        
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
      *        IF RCV-MSC-MCAN IN CAN-FLD = 'V'
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
                   MOVE VEN-NUM-DVEN IN CAN-FLD TO
                        LOC-NUM-DVEN IN LOC-VARI
                   MOVE VEN-NUM-MVEN IN CAN-FLD TO
                        LOC-NUM-MVEN IN LOC-VARI
                   MOVE VEN-NUM-SVEN IN CAN-FLD TO
                        LOC-NUM-SVEN IN LOC-VARI
                   MOVE VEN-NUM-AVEN IN CAN-FLD TO
                         LOC-NUM-AVEN IN LOC-VARI
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
      *        ELSE
      *            MOVE CAN-NUM-DCAN IN CAN-FLD TO
      *                 LOC-NUM-DVEN IN LOC-VARI
      *            MOVE CAN-NUM-MCAN IN CAN-FLD TO
      *                 LOC-NUM-MVEN IN LOC-VARI
      *            MOVE CAN-NUM-SCAN IN CAN-FLD TO
      *                 LOC-NUM-SVEN IN LOC-VARI
      *            MOVE CAN-NUM-ACAN IN CAN-FLD TO
      *                  LOC-NUM-AVEN IN LOC-VARI
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
           ELSE                                                         
           IF SCR-MSC-FCAN = 'T' AND                                    
              SCR-MSC-ECAN = 'T'                                        
               MOVE CAN-CAI-IOPC IN CAN-FLD TO
                    DLC-CAI-IOPC IN DLC
               MOVE CAN-IIC-IOPC IN CAN-FLD TO
                    DLC-IIC-IOPC IN DLC
               MOVE 1 TO DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-DLC
               MOVE DLC-NUM-DMAV IN DLC     TO
                    LOC-NUM-DVEN IN LOC-VARI
               MOVE DLC-NUM-MMAV IN DLC     TO
                    LOC-NUM-MVEN IN LOC-VARI
               MOVE DLC-NUM-SMAV IN DLC     TO
                    LOC-NUM-SVEN IN LOC-VARI
               MOVE DLC-NUM-AMAV IN DLC     TO
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
      *             LOC-NUM-AVEN IN LOC-VARI.
                    LOC-NUM-AVEN IN LOC-VARI
           ELSE
               MOVE CAN-NUM-DCAN IN CAN-FLD TO
                    LOC-NUM-DVEN IN LOC-VARI
               MOVE CAN-NUM-MCAN IN CAN-FLD TO
                    LOC-NUM-MVEN IN LOC-VARI
               MOVE CAN-NUM-SCAN IN CAN-FLD TO
                    LOC-NUM-SVEN IN LOC-VARI
               MOVE CAN-NUM-ACAN IN CAN-FLD TO
      *AFRI-INI 13-SEP-2017 COMISION FOGAPE
      *             LOC-NUM-AVEN IN LOC-VARI.
                    LOC-NUM-AVEN IN LOC-VARI
               MOVE RCV-MSC-MCAN IN CAN-FLD TO
                    LOC-MSC-MCAN IN LOC-VARI.
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
      *AFRI-FIN 13-SEP-2017 COMISION FOGAPE
           PERFORM LOC-GRA-CXE.
       FIN-ACT-CXE-FGP.
           EXIT.
      *AFRI-FIN/LOF/CHC/07-2009
      *AFRI-INI 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF
       ACT-CXE-FIN SECTION.
       INI-ACT-CXE-FIN.
           IF  SCR-MSC-FCAN = WSS-GLS-ITTT AND
               SCR-MSC-ECAN = WSS-GLS-ITTT
                GO TO CON-ACT-CXE-FIN.
           IF  SCR-MSC-FCAN = WSS-GLS-ITTT AND
               SCR-MSC-ECAN = WSS-GLS-IEEE AND
               OPC-NUM-VCOR IN OPC = WSS-NUM-IUN1
                GO TO CON-ACT-CXE-FIN.
           IF  SCR-MSC-FCAN = WSS-GLS-IIII AND
               SCR-MSC-ECAN = WSS-GLS-IEEE AND
               OPC-NUM-VCOR IN OPC = WSS-NUM-IUN1
                GO TO CON-ACT-CXE-FIN.
           GO TO FIN-ACT-CXE-FIN.
       CON-ACT-CXE-FIN.

           IF SCR-SGV-CFIN NOT  > ZEROES
               IF SCR-SGV-CCMC NOT > ZEROES
                   GO TO FIN-ACT-CXE-FIN.


           MOVE SPACES TO MSG-COD-MENS.

           IF SCR-SGV-CFIN NOT > ZEROES
               GO TO GRAB-COM-CCMC.

           MOVE LOW-VALUES                TO CXE.
           MOVE CAN-CIC-IOPC IN CAN       TO CXE-CIC-IOPC IN CXE.
           MOVE WSS-GLS-EVCA              TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN       TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                    TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                    TO CXE-NUM-IVCT IN CXE.
           MOVE WSS-GLS-COFI              TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               MOVE FIO-PUT TO FIO-CMND.
           MOVE ZEROES                    TO CXE-FEC-FVEN IN CXE.
           MOVE SCR-SGV-CFIN              TO CXE-SGV-MCAL IN CXE.
           MOVE SCR-SGV-CFIN              TO CXE-SGV-MNTO IN CXE.
           MOVE SPACES                    TO CXE-MSC-STAT IN CXE.
           MOVE SPACES                    TO CXE-IND-CBRO IN CXE.
           PERFORM COL-FIO-CXE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACT-CXE-FIN.

       GRAB-COM-CCMC.

           IF SCR-SGV-CCMC NOT > ZEROES
               GO TO FIN-ACT-CXE-FIN.

           MOVE LOW-VALUES                TO CXE.
           MOVE CAN-CIC-IOPC IN CAN       TO CXE-CIC-IOPC IN CXE.
           MOVE WSS-GLS-EVCA              TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN       TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                    TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                    TO CXE-NUM-IVCT IN CXE.
           MOVE WSS-GLS-COCO              TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               MOVE FIO-PUT TO FIO-CMND.
           MOVE ZEROES                    TO CXE-FEC-FVEN IN CXE.
           MOVE SCR-SGV-CCMC              TO CXE-SGV-MCAL IN CXE.
           MOVE SCR-SGV-CCMC              TO CXE-SGV-MNTO IN CXE.
           MOVE SPACES                    TO CXE-MSC-STAT IN CXE.
           MOVE SPACES                    TO CXE-IND-CBRO IN CXE.
           PERFORM COL-FIO-CXE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACT-CXE-FIN.
       FIN-ACT-CXE-FIN.
           EXIT.
      *AFRI-FIN 14-DIC-2015 COBRO COMISION SOBRE 5.000 UF

      *AFRI-INI/REBAJA DE TASAS OPC CAE/CHC/04-2012
       LEE-CXE-RCAE SECTION.
       INI-LEE-CXE-RCAE.
           MOVE 'N' TO WSS-CXE-ICAE IN CAE-VARI.
           MOVE LOW-VALUES               TO CXE.
           MOVE SPACES                   TO CXE-GLS-FLAG IN CXE.
           MOVE CAN-CAI-IOPC IN CAN-FLD  TO CXE-CAI-IOPC IN CXE.
           MOVE CAN-IIC-IOPC IN CAN-FLD  TO CXE-IIC-IOPC IN CXE.
           MOVE 'PEP'                    TO CXE-COD-EVEN IN CXE.
           MOVE VEN-NUM-IVCT IN CAN-FLD  TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE SPACES                   TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE 'S' TO WSS-CXE-ICAE IN CAE-VARI
               MOVE CXE-SGV-MCAL IN CXE TO WSS-CAE-MCAL IN CAE-VARI
               GO TO FIN-LEE-CXE-RCAE
           ELSE
               GO TO FIN-LEE-CXE-RCAE.
       FIN-LEE-CXE-RCAE.
           EXIT.

       DET-VAL-TPAG SECTION.
       INI-DET-VAL-TPAG.
           MOVE SPACES TO WSS-CAE-MENS IN CAE-VARI.

           MOVE OPC-COD-VCOC IN OPC     TO CAM-COD-VCAM IN CAM(1).      
           MOVE '0999  '                TO CAM-COD-VCAM IN CAM(2).      
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAM-NUM-DCAM IN CAM(1).      
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAM-NUM-MCAM IN CAM(1).      
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAM-NUM-SCAM IN CAM(1).      
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAM-NUM-ACAM IN CAM(1).      
           MOVE CAM-FEC-FCAM IN CAM(1)  TO CAM-FEC-FCAM IN CAM(2).      
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM                                          
           IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')                 
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'CAM    NEX' TO WSS-CAE-MENS IN CAE-VARI            
               GO TO FIN-DET-VAL-TPAG.                                  

           MULTIPLY RCV-SGV-FINA IN CAN-FLD BY CAM-SGV-VCAM IN CAM      
                               GIVING WSS-CAE-FINA IN CAE-VARI ROUNDED.
           MOVE WSS-CAE-FINA IN CAE-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-CAE-FINA IN CAE-VARI.
           MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-CAE-TPAG IN CAE-VARI.
           MOVE WSS-CAE-FINA IN CAE-VARI TO CAN-SGV-TPAG IN CAN.
      *AFRI-INI/SEPTIEMBRE 2013 COMISION CAE
            COMPUTE CAN-SGV-TPAG IN CAN = CAN-SGV-TPAG IN CAN +
                                          SCR-SGV-CCAE.
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
       FIN-DET-VAL-TPAG.
           EXIT.

       CAE-ACT-CAN SECTION.
       INI-CAE-ACT-CAN.
           MOVE SPACES TO WSS-CAE-MENS IN CAE-VARI.

           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY             TO FIO-CMND
           PERFORM COL-FIO-CAN                                          
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CAN    NEX' TO WSS-CAE-MENS IN CAE-VARI
               GO TO FIN-CAE-ACT-CAN                                    
           ELSE                                                         
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CAN
               MOVE FIO-MOD TO FIO-CMND
               MOVE WSS-CAE-TPAG IN CAE-VARI TO CAN-SGV-TPAG IN CAN     
               PERFORM COL-FIO-CAN.                                     
       FIN-CAE-ACT-CAN.
           EXIT.
      *AFRI-FIN/REBAJA DE TASAS OPC CAE/CHC/04-2012

      *AFRI-INI/DEVOLUCION SEGUROS/12-2013
       DPS-ACT-CAN SECTION.
       INI-DPS-ACT-CAN.

           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY             TO FIO-CMND
           PERFORM COL-FIO-CAN                                          
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-DPS-ACT-CAN                                    
           ELSE                                                         
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CAN
               MOVE FIO-MOD TO FIO-CMND
               COMPUTE CAN-SGV-TPAG IN CAN = CAN-SGV-TPAG IN CAN -
                                             SCR-SGV-MDPT.
               PERFORM COL-FIO-CAN.                                     
       FIN-DPS-ACT-CAN.
           EXIT.
       COPY COLBKDPS.
      *AFRI-FIN/DEVOLUCION SEGUROS/12-2013
      *AFRI-FIN/SEPTIEMBRE 2013 COMISION CAE
       ACT-CXE-DPS SECTION.
       INI-ACT-CXE-DPS.
           MOVE WCC-1 TO DPS-NUM-SEG.
       LUP-ACT-CXE-DPS.
           IF SCR-COD-SEGC(DPS-NUM-SEG) NOT > SPACES
               GO TO LUP-ELI-SEL-CXE.
           MOVE LOW-VALUES                TO CXE.
           MOVE CAN-CIC-IOPC IN CAN       TO CXE-CIC-IOPC IN CXE.
           MOVE DPS-COD-EVPA IN DPS-VARI  TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN       TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                    TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                    TO CXE-NUM-IVCT IN CXE.
           MOVE SCR-COD-SEGC(DPS-NUM-SEG) TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               MOVE FIO-PUT TO FIO-CMND.
           MOVE SCR-FEC-FOUT              TO CXE-FEC-FVEN IN CXE.
           MOVE SCR-VAL-PORS(DPS-NUM-SEG) TO CXE-SGV-MCAL IN CXE.
           MOVE SCR-VAL-PORS(DPS-NUM-SEG) TO CXE-SGV-MNTO IN CXE.
           MOVE SCR-IND-NECU              TO CXE-MSC-STAT IN CXE.
           MOVE SCR-IND-ESCU(DPS-NUM-SEG) TO CXE-IND-CBRO IN CXE.
           PERFORM COL-FIO-CXE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACT-CXE-DPS.
           ADD WCC-1 TO DPS-NUM-SEG.
           GO TO LUP-ACT-CXE-DPS.
       LUP-ELI-SEL-CXE.
           MOVE CAN-CIC-IOPC IN CAN TO CXE-KEY-IOPC IN CXE.
           MOVE DPS-GLS-SEL         TO CXE-COD-EVEN IN CXE.
           MOVE ZEROES              TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES              TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES              TO CXE-NUM-IVCT IN CXE.
           MOVE SPACES              TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = CXE-KEY-IOPC IN CXE AND
              CXE-COD-EVEN IN CXE = DPS-GLS-SEL
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CXE
               MOVE FIO-DEL TO FIO-CMND
               PERFORM COL-FIO-CXE
               GO TO LUP-ELI-SEL-CXE.
           MOVE WCC-C00 TO FIO-STAT.
       FIN-ACT-CXE-DPS.
           EXIT.
      *AFRI-INI 10-SEP-2014 SELECCION DE SEGUROS
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
       COPY COLBKGCN.
       COPY COLBKHNJ.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *>>>>
