      *
      * COLBUVEN
      * Version 3.0.1 Nov-2005
      * 12-Jul-19 04:56 PM
      *
       SET-TAG-COLBUVEN SECTION.
       INI-SET-TAG-COLBUVEN.
           MOVE
           '<IDNMOD NOM=$COLBUVEN$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$12-Jul-19 04:56 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBUVEN.
           EXIT.
           
       RET-ALL-VEN SECTION.
       INI-RET-ALL-VEN.
           PERFORM KEY-ALL-VEN.
           PERFORM RET-OPC-VEN.
           PERFORM RET-VEN-VEN.
       FIN-RET-ALL-VEN.
           EXIT.
       
       RET-OPC-VEN SECTION.
       INI-RET-OPC-VEN.
           MOVE OPC-MSC-TVOC IN VEN-FLD TO OPC-MSC-TVOC IN OPC.
           MOVE OPC-COD-TOOC IN VEN-FLD TO OPC-COD-TOOC IN OPC.
           MOVE OPC-COD-OFOC IN VEN-FLD TO OPC-COD-OFOC IN OPC.
           MOVE OPC-COD-VCOC IN VEN-FLD TO OPC-COD-VCOC IN OPC.
       FIN-RET-OPC-VEN.
           EXIT.
       
       RET-VEN-VEN SECTION.
       INI-RET-VEN-VEN.
           MOVE VEN-NUM-IDLC IN VEN-FLD TO VEN-NUM-IDLC IN VEN.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE VEN-NUM-DVEN IN VEN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN VEN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN VEN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN VEN-FLD TO VEN-NUM-AVEN IN VEN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE VEN-VAL-CAPI IN VEN-FLD TO VEN-VAL-CAPI IN VEN.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE VEN-NUM-DIMV IN VEN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN VEN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN VEN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN VEN-FLD TO VEN-NUM-AIMV IN VEN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE VEN-VAL-SCAP IN VEN-FLD TO VEN-VAL-SCAP IN VEN.
           MOVE VEN-IND-SCTB IN VEN-FLD TO VEN-IND-SCTB IN VEN.
           MOVE VEN-VAL-IDNI IN VEN-FLD TO VEN-VAL-IDNI IN VEN.
           MOVE VEN-IND-SCBZ IN VEN-FLD TO VEN-IND-SCBZ IN VEN.
           MOVE VEN-VAL-FINA IN VEN-FLD TO VEN-VAL-FINA IN VEN.
           MOVE VEN-IND-CAUT IN VEN-FLD TO VEN-IND-CAUT IN VEN.
           MOVE VEN-VAL-SFIN IN VEN-FLD TO VEN-VAL-SFIN IN VEN.
       FIN-RET-VEN-VEN.
           EXIT.
       
       KEY-ALL-VEN SECTION.
       INI-KEY-ALL-VEN.
           PERFORM KEY-OPC-VEN.
           PERFORM KEY-VEN-VEN.
       FIN-KEY-ALL-VEN.
           EXIT.
       
       KEY-OPC-VEN SECTION.
       INI-KEY-OPC-VEN.
       FIN-KEY-OPC-VEN.
           EXIT.
       
       KEY-VEN-VEN SECTION.
       INI-KEY-VEN-VEN.
           MOVE VEN-CAI-IOPC IN VEN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE VEN-IIC-IOPC IN VEN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVCT IN VEN-FLD TO VEN-NUM-IVCT IN VEN.
           MOVE VEN-NUM-IVEN IN VEN-FLD TO VEN-NUM-IVEN IN VEN.
       FIN-KEY-VEN-VEN.
           EXIT.
       
       SCR-CLRA-VEN SECTION.
       INI-SCR-CLRA-VEN.
           PERFORM CLR-KEY-VEN.
           PERFORM CLR-FLD-VEN.
       FIN-SCR-CLRA-VEN.
           EXIT.
       
       CLR-KEY-VEN SECTION.
       INI-CLR-KEY-VEN.
           MOVE SPACES TO VEN-CAI-IOPC IN VEN-FLD.
           MOVE ZEROES TO VEN-IIC-IOPC IN VEN-FLD.
           MOVE ZEROES TO VEN-NUM-IVCT IN VEN-FLD.
           MOVE ZEROES TO VEN-NUM-IVEN IN VEN-FLD.
       FIN-CLR-KEY-VEN.
           EXIT.
       
       CLR-FLD-VEN SECTION.
       INI-CLR-FLD-VEN.
           MOVE SPACES TO FRM-GLS-TVOC IN VEN-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN VEN-FLD.
           MOVE SPACES TO FRM-GLS-OFOC IN VEN-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN VEN-FLD.
           PERFORM CLR-OPC-VEN.
           PERFORM CLR-VEN-VEN.
       FIN-CLR-FLD-VEN.
           EXIT.
       
       CLR-OPC-VEN SECTION.
       INI-CLR-OPC-VEN.
           MOVE SPACES TO OPC-MSC-TVOC IN VEN-FLD.
           MOVE SPACES TO OPC-COD-TOOC IN VEN-FLD.
           MOVE SPACES TO OPC-COD-OFOC IN VEN-FLD.
           MOVE SPACES TO OPC-COD-VCOC IN VEN-FLD.
       FIN-CLR-OPC-VEN.
           EXIT.
       
       CLR-VEN-VEN SECTION.
       INI-CLR-VEN-VEN.
           MOVE ZEROES TO VEN-NUM-IDLC IN VEN-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO VEN-FEC-FVEN IN VEN-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO VEN-VAL-CAPI IN VEN-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO VEN-FEC-FIMV IN VEN-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO VEN-VAL-SCAP IN VEN-FLD.
           MOVE SPACES TO VEN-IND-SCTB IN VEN-FLD.
           MOVE ZEROES TO VEN-VAL-IDNI IN VEN-FLD.
           MOVE SPACES TO VEN-IND-SCBZ IN VEN-FLD.
           MOVE ZEROES TO VEN-VAL-FINA IN VEN-FLD.
           MOVE SPACES TO VEN-IND-CAUT IN VEN-FLD.
           MOVE ZEROES TO VEN-VAL-SFIN IN VEN-FLD.
      *<<<< FIN_CLR_VEN_VEN
      * ICU
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               MOVE SCR-NUM-IDOC IN SCR-VARI TO VEN-NUM-IDLC IN VEN-FLD.
      *>>>>
       FIN-CLR-VEN-VEN.
           EXIT.
       
       FST-KEY-VEN SECTION.
       INI-FST-KEY-VEN.
           MOVE -1 TO VEN-CAI-IOPC-LEN IN VEN-FLD.
       FIN-FST-KEY-VEN.
           EXIT.
       
       FST-FLD-VEN SECTION.
       INI-FST-FLD-VEN.
           MOVE -1 TO VEN-NUM-IDLC-LEN IN VEN-FLD.
       FIN-FST-FLD-VEN.
           EXIT.
       
       PRO-KEY-VEN SECTION.
       INI-PRO-KEY-VEN.
           PERFORM PRO-MKY-VEN.
       FIN-PRO-KEY-VEN.
           EXIT.
       
       PRO-MKY-VEN SECTION.
       INI-PRO-MKY-VEN.
       FIN-PRO-MKY-VEN.
           EXIT.
       
       PRO-FLD-VEN SECTION.
       INI-PRO-FLD-VEN.
           PERFORM PRO-OPC-VEN.
           PERFORM PRO-VEN-VEN.
       FIN-PRO-FLD-VEN.
           EXIT.
       
       PRO-OPC-VEN SECTION.
       INI-PRO-OPC-VEN.
       FIN-PRO-OPC-VEN.
           EXIT.
       
       PRO-VEN-VEN SECTION.
       INI-PRO-VEN-VEN.
           MOVE FRM-CPIM-AEY TO VEN-NUM-IDLC-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-FEC-FVEN-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-CAPI-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-FEC-FIMV-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-IND-SCTB-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-IDNI-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-IND-SCBZ-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-FINA-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-IND-CAUT-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-SFIN-ATR IN VEN-FLD.
       FIN-PRO-VEN-VEN.
           EXIT.
       
       UNP-KEY-VEN SECTION.
       INI-UNP-KEY-VEN.
           PERFORM UNP-IKY-VEN.
           PERFORM UNP-AKY-VEN.
           PERFORM UNP-MKY-VEN.
       FIN-UNP-KEY-VEN.
           EXIT.
       
       UNP-IKY-VEN SECTION.
       INI-UNP-IKY-VEN.
           MOVE FRM-CPIM-UBY TO VEN-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO VEN-IIC-IOPC-ATR.
       FIN-UNP-IKY-VEN.
           EXIT.
       
       UNP-MKY-VEN SECTION.
       INI-UNP-MKY-VEN.
       FIN-UNP-MKY-VEN.
           EXIT.
       
       UNP-AKY-VEN SECTION.
       INI-UNP-AKY-VEN.
           MOVE FRM-CPIM-UBY TO VEN-NUM-IVCT-ATR.
       FIN-UNP-AKY-VEN.
           EXIT.
       
       UNP-FLD-VEN SECTION.
       INI-UNP-FLD-VEN.
           PERFORM UNP-OPC-VEN.
           PERFORM UNP-VEN-VEN.
       FIN-UNP-FLD-VEN.
           EXIT.
       
       UNP-OPC-VEN SECTION.
       INI-UNP-OPC-VEN.
       FIN-UNP-OPC-VEN.
           EXIT.
       
       UNP-VEN-VEN SECTION.
       INI-UNP-VEN-VEN.
           MOVE FRM-CPIM-UBY TO VEN-NUM-IDLC-ATR IN VEN-FLD.
           MOVE FRM-CPIM-UBY TO VEN-FEC-FVEN-ATR IN VEN-FLD.
           MOVE FRM-CPIM-UBY TO VEN-VAL-CAPI-ATR IN VEN-FLD.
           MOVE FRM-CPIM-UBY TO VEN-FEC-FIMV-ATR IN VEN-FLD.
           MOVE FRM-CPIM-UBY TO VEN-IND-SCTB-ATR IN VEN-FLD.
           MOVE FRM-CPIM-UBY TO VEN-VAL-IDNI-ATR IN VEN-FLD.
           MOVE FRM-CPIM-UBY TO VEN-IND-SCBZ-ATR IN VEN-FLD.
           MOVE FRM-CPIM-UBY TO VEN-VAL-FINA-ATR IN VEN-FLD.
           MOVE FRM-CPIM-UBY TO VEN-IND-CAUT-ATR IN VEN-FLD.
           MOVE FRM-CPIM-UBY TO VEN-VAL-SFIN-ATR IN VEN-FLD.
      *<<<< FIN_VEN_VEN
      *     IF SCR-CCPP = 'ING'
      *         MOVE FRM-CPIM-AEY TO VEN-VAL-SCAP-ATR IN VEN-FLD
      *         MOVE FRM-CPIM-AEY TO VEN-VAL-SFIN-ATR IN VEN-FLD.
      *>>>>
       FIN-UNP-VEN-VEN.
           EXIT.
       
       VAL-MKY-VEN SECTION.
       INI-VAL-MKY-VEN.
       FIN-VAL-MKY-VEN.
           EXIT.
       
       VAL-FLD-VEN SECTION.
       INI-VAL-FLD-VEN.
           PERFORM VAL-OPC-MSC-TVOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-MSC-TVOC-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-OPC-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-COD-TOOC-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-OPC-COD-OFOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-COD-OFOC-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-FRM-GLS-TVOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TVOC-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-FRM-GLS-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOOC-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-FRM-GLS-OFOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFOC-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-OPC-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-COD-VCOC-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-VEN-NUM-IDLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-NUM-IDLC-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-FRM-GLS-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCOC-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-VEN-FEC-FVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                VEN-FEC-FVEN-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-VEN-VAL-CAPI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-CAPI-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-VEN-FEC-FIMV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                VEN-FEC-FIMV-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-VEN-VAL-SCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-SCAP-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-VEN-IND-SCTB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-IND-SCTB-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-VEN-VAL-IDNI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-IDNI-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-VEN-IND-SCBZ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-IND-SCBZ-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-VEN-VAL-FINA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-FINA-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-VEN-IND-CAUT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-IND-CAUT-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
           PERFORM VAL-VEN-VAL-SFIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO VEN-VAL-SFIN-LEN IN VEN-FLD
                GO TO FIN-VAL-FLD-VEN.
       FIN-VAL-FLD-VEN.
           EXIT.
       
       VAL-OPC-MSC-TVOC SECTION.
       INI-VAL-OPC-MSC-TVOC.
       FIN-VAL-OPC-MSC-TVOC.
           EXIT.
       
       VAL-OPC-COD-TOOC SECTION.
       INI-VAL-OPC-COD-TOOC.
       FIN-VAL-OPC-COD-TOOC.
           EXIT.
       
       VAL-OPC-COD-OFOC SECTION.
       INI-VAL-OPC-COD-OFOC.
       FIN-VAL-OPC-COD-OFOC.
           EXIT.
       
       VAL-FRM-GLS-TVOC SECTION.
       INI-VAL-FRM-GLS-TVOC.
       FIN-VAL-FRM-GLS-TVOC.
           EXIT.
       
       VAL-FRM-GLS-TOOC SECTION.
       INI-VAL-FRM-GLS-TOOC.
       FIN-VAL-FRM-GLS-TOOC.
           EXIT.
       
       VAL-FRM-GLS-OFOC SECTION.
       INI-VAL-FRM-GLS-OFOC.
       FIN-VAL-FRM-GLS-OFOC.
           EXIT.
       
       VAL-OPC-COD-VCOC SECTION.
       INI-VAL-OPC-COD-VCOC.
       FIN-VAL-OPC-COD-VCOC.
           EXIT.
       
       VAL-VEN-NUM-IDLC SECTION.
       INI-VAL-VEN-NUM-IDLC.
      *<<<< VEN_NUM_IDLC
           IF SCR-CMND = 'MCA' OR
              SCR-CMND = 'CFM'
               GO TO FIN-VAL-VEN-NUM-IDLC.
           IF VEN-NUM-IDLC IN VEN-FLD NOT > ZEROES
               MOVE OPC-COD-TOOC IN VEN-FLD TO TOC-COD-TOCR IN TOC
               PERFORM BUS-TOC
               IF MSG-COD-MENS = 'CODTOC NEX' OR
                                 'INDOPECNEX'
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-VAL-VEN-NUM-IDLC
               ELSE
                   IF MSC-CIC-CMSC IN MSC = 'D'
                       MOVE ZEROES TO VEN-NUM-IDLC IN VEN-FLD
                   ELSE
                       MOVE 1      TO VEN-NUM-IDLC IN VEN-FLD.
           MOVE VEN-CAI-IOPC IN VEN-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE VEN-IIC-IOPC IN VEN-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN-FLD TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMIDLCNEX  ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-VEN-NUM-IDLC.
      *>>>>
       FIN-VAL-VEN-NUM-IDLC.
           EXIT.
       
       VAL-FRM-GLS-VCOC SECTION.
       INI-VAL-FRM-GLS-VCOC.
       FIN-VAL-FRM-GLS-VCOC.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-VEN-FEC-FVEN SECTION.
       INI-VAL-VEN-FEC-FVEN.
           IF VEN-FEC-FVEN IN VEN-FLD  NOT > ZEROES
              MOVE ZEROES TO VEN-FEC-FVEN IN VEN-FLD.
      *VAL-FEC Validar Fecha
           MOVE VEN-FEC-FVEN IN VEN-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_VEN_FEC_FVEN
           IF SCR-CMND = 'MCA' OR
              SCR-CMND = 'CFM'
               GO TO FIN-VAL-VEN-FEC-FVEN.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           IF OPC-IND-AFER IN OPC = 'S'
               MOVE FEC-VHBL-S TO FEC-VHBL
           ELSE
               MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO VEN-FEC-FVEN IN VEN-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-VEN-FEC-FVEN.
       FIN-VAL-VEN-FEC-FVEN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-VEN-VAL-CAPI SECTION.
       INI-VAL-VEN-VAL-CAPI.
      *<<<< VEN_VAL_CAPI
           IF SCR-CMND = 'MCA' OR
              SCR-CMND = 'CFM'
               GO TO FIN-VAL-VEN-VAL-CAPI.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'TCVE' TO MSC-COD-TMSC IN MSC.
           MOVE OPC-MSC-TCVE IN OPC TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSC-CIC-CMSC IN MSC = 'CI'  AND
              VEN-VAL-CAPI IN VEN-FLD NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALCAPIOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-VEN-VAL-CAPI.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-VEN-FEC-FIMV SECTION.
       INI-VAL-VEN-FEC-FIMV.
           IF VEN-FEC-FIMV IN VEN-FLD  NOT > ZEROES
              MOVE ZEROES TO VEN-FEC-FIMV IN VEN-FLD.
      *VAL-FEC Validar Fecha
           MOVE VEN-FEC-FIMV IN VEN-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_VEN_FEC_FIMV
           IF SCR-CMND = 'MCA'
               GO TO FIN-VAL-VEN-FEC-FIMV.
           IF SCR-CMND = 'CFM'
               MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO VEN-FEC-FIMV IN VEN-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-VEN-FEC-FIMV.
      *<<<< VEN_FEC_FIMV
           IF SCR-CMND = 'CFM'
      *CMP-FEC Comparar Fechas
               MOVE VEN-FEC-FVEN IN VEN-FLD TO FEC-FEC1
               MOVE VEN-FEC-FIMV IN VEN-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-CMP-FEC TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'FECFIMVFVEN>' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-VEN-FEC-FIMV.
      *>>>>
       FIN-VAL-VEN-FEC-FIMV.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-VEN-VAL-SCAP SECTION.
       INI-VAL-VEN-VAL-SCAP.
      *<<<< VEN_VAL_SCAP
      *ICU
      *     IF SCR-CCPP = 'ING'
      *         MOVE VEN-VAL-CAPI IN VEN-FLD TO VEN-VAL-SCAP IN VEN-FLD.
           IF SCR-CMND = 'MCA' OR
              SCR-CMND = 'CFM'
               GO TO FIN-VAL-VEN-VAL-SCAP.
           MOVE VEN-VAL-CAPI IN VEN-FLD TO VEN-VAL-SCAP IN VEN-FLD.
      *>>>>
       FIN-VAL-VEN-VAL-SCAP.
           EXIT.
       
       VAL-VEN-IND-SCTB SECTION.
       INI-VAL-VEN-IND-SCTB.
           IF VEN-IND-SCTB IN VEN-FLD NOT > SPACES
              MOVE SPACES TO VEN-IND-SCTB IN VEN-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'SCTB' TO MSC-COD-TMSC IN MSC.
           MOVE VEN-IND-SCTB IN VEN-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-VEN-IND-SCTB.
           EXIT.
       
       VAL-VEN-VAL-IDNI SECTION.
       INI-VAL-VEN-VAL-IDNI.
       FIN-VAL-VEN-VAL-IDNI.
           EXIT.
       
       VAL-VEN-IND-SCBZ SECTION.
       INI-VAL-VEN-IND-SCBZ.
           IF VEN-IND-SCBZ IN VEN-FLD NOT > SPACES
              MOVE SPACES TO VEN-IND-SCBZ IN VEN-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'SCBZ' TO MSC-COD-TMSC IN MSC.
           MOVE VEN-IND-SCBZ IN VEN-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-VEN-IND-SCBZ.
           EXIT.
       
       VAL-VEN-VAL-FINA SECTION.
       INI-VAL-VEN-VAL-FINA.
      *<<<< VEN_VAL_FINA
           IF SCR-CMND = 'MCA' OR
              SCR-CMND = 'CFM'
               GO TO FIN-VAL-VEN-VAL-FINA.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'TCVE' TO MSC-COD-TMSC IN MSC.
           MOVE OPC-MSC-TCVE IN OPC TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSC-CIC-CMSC IN MSC = 'FI'  AND
              VEN-VAL-CAPI IN VEN-FLD NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALFINAOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-VEN-VAL-FINA.
      * AAA Revisa si es tasa variable  26-MAR-1991 12:01:21
           MOVE VEN-CAI-IOPC IN VEN-FLD TO VIN-CAI-IOPC IN VIN-VARI.
           MOVE VEN-IIC-IOPC IN VEN-FLD TO VIN-IIC-IOPC IN VIN-VARI.
           MOVE VEN-NUM-IDLC IN VEN-FLD TO VIN-NUM-IDLC IN VIN-VARI.
           PERFORM BUS-VIN.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO ICG-COD-CVTI IN ICG.
           IF ICG-COD-CVTI IN ICG NOT > SPACES
      *        Si no es tasa variable debe ir valor final vencimiento
               IF VEN-VAL-FINA IN VEN-FLD NOT > ZEROES
                   PERFORM ERR-GLS.
      *AAA Fin
      *>>>>
       FIN-VAL-VEN-VAL-FINA.
           EXIT.
       
       VAL-VEN-IND-CAUT SECTION.
       INI-VAL-VEN-IND-CAUT.
           IF VEN-IND-CAUT IN VEN-FLD NOT > SPACES
              MOVE SPACES TO VEN-IND-CAUT IN VEN-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'CAUT' TO MSC-COD-TMSC IN MSC.
           MOVE VEN-IND-CAUT IN VEN-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-VEN-IND-CAUT.
           EXIT.
       
       VAL-VEN-VAL-SFIN SECTION.
       INI-VAL-VEN-VAL-SFIN.
      *<<<< VEN_VAL_SFIN
      *ALD     IF SCR-CCPP = 'ING'
      *         MOVE VEN-VAL-IDNI IN VEN-FLD TO VEN-VAL-SFIN IN VEN-FLD.
           IF SCR-CMND = 'MCA' OR
              SCR-CMND = 'CFM'
               GO TO FIN-VAL-VEN-VAL-SFIN.
           IF VEN-VAL-SFIN IN VEN-FLD NOT > ZEROES
               MOVE VEN-VAL-FINA IN VEN-FLD TO VEN-VAL-SFIN IN VEN-FLD.
      *>>>>
       FIN-VAL-VEN-VAL-SFIN.
           EXIT.
       
       VAL-CON-FLD-VEN SECTION.
       INI-VAL-CON-FLD-VEN.
      *<<<< VAL_CON_FLD_VEN
           IF SCR-CMND = 'CFM'
               GO TO FIN-VAL-CON-FLD-VEN.
      *ISP SE ESCRIBE ESTE CODIGO AQUI, PUES NO ES POSIBLE AGREGAR
      *    CODIGO ADICIONAL DESPUES DE VALIDACION AUTOMATICA
      *    ESTE CODIGO ES ANALOGO A EVC
           MOVE VEN-CAI-IOPC IN VEN-FLD TO CYA-CAI-IOPC IN CYA.
           MOVE VEN-IIC-IOPC IN VEN-FLD TO CYA-IIC-IOPC IN CYA.
           MOVE 'AUT'                   TO CYA-NUM-ICAN IN CYA.
           MOVE 1                       TO CYA-NUM-ICYA IN CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS
               IF VEN-IND-CAUT IN VEN-FLD NOT > SPACES
                   MOVE 'S' TO VEN-IND-CAUT IN VEN-FLD
               ELSE
               IF NOT ( VEN-IND-CAUT IN VEN-FLD = 'S' OR
                        VEN-IND-CAUT IN VEN-FLD = 'N' )
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'INDCAUTSON' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO CPT-STR1
                   MOVE MSG-GLS-DATA TO CPT-STR2
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN     TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE SPACES TO VEN-IND-CAUT IN VEN-FLD.

           IF SCR-CMND = 'MCA'
               GO TO CON-VAL-CON-FLD-VEN.
      *CMP-FEC Compara Fecha vencimiento vs fecha oeracion
           MOVE VEN-FEC-FVEN IN VEN-FLD TO FEC-FEC1.
           MOVE OPC-NUM-DCOL IN OPC     TO FEC-DEC2.
           MOVE OPC-NUM-MCOL IN OPC     TO FEC-MEC2.
           MOVE OPC-NUM-SCOL IN OPC     TO FEC-SEC2.
           MOVE OPC-NUM-ACOL IN OPC     TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'FECFCOLFVEN<' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-VEN.
       CON-VAL-CON-FLD-VEN.
      *ALD OBTIENE FECHA INICIO MORA COMO PROXIMO DIA HABIL A FECHA
      *    DE VENCIMIENTO
           MOVE VEN-FEC-FVEN IN VEN-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE VEN-FEC-FVEN IN VEN-FLD TO FEC-FECH
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-SIG-HBL  TO FEC-CMND
      *        PERFORM PRO-FEC.
               PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO VEN-NUM-DIMV IN VEN-FLD.
           MOVE FEC-ITM2 TO VEN-NUM-MIMV IN VEN-FLD.
           MOVE FEC-ITM3 TO VEN-NUM-SIMV IN VEN-FLD.
           MOVE FEC-ITM4 TO VEN-NUM-AIMV IN VEN-FLD.
           IF SCR-CMND = 'MCA'
               GO TO FIN-VAL-CON-FLD-VEN.
      *CMP-FEC Compara Fecha vencimiento vs inicio mora
      *     MOVE VEN-FEC-FIMV IN VEN-FLD TO FEC-FEC1.
      *     MOVE VEN-FEC-FVEN IN VEN-FLD TO FEC-FEC2.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     MOVE FEC-CMP-FEC  TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF FEC-STAT-LES
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'FECFIMVFVEN<' TO MSG-COD-MENS IN MSG
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-VEN.
           IF VEN-VAL-SCAP IN VEN-FLD > VEN-VAL-CAPI IN VEN-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'VALSCAPCAPI>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-VEN.

      *AAA Busca clase como opera la OPC 1-APR-1991 18:43:20
           MOVE SPACES              TO WSS-OPEC.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'               TO MSG-COD-SIST
               MOVE 'OPCTOOCNEX'        TO MSG-COD-MENS
               MOVE TOC-COD-TOCR IN TOC TO FRM-MEN2
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO CPT-STR1
               MOVE MSG-GLS-DATA        TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-MENS
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-VEN
           ELSE
               MOVE 'COL'               TO MSC-COD-SIST FIO-SIST
               MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC
               MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY         TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'               TO MSG-COD-SIST
                   MOVE 'TOCOPECNEX'        TO MSG-COD-MENS
                   MOVE MSC-COD-TABL IN MSC TO FRM-MEN2
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO CPT-STR1
                   MOVE MSG-GLS-DATA        TO CPT-STR2
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-MENS
                   MOVE FRM-SUAR-MAL        TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-VEN
               ELSE
                   MOVE MSC-CIC-CMSC IN MSC TO WSS-OPEC.

      *AAA Si no es boleta de garantia y capi y fina tienen valores, valida
      *    que valor final sea mayor o igual a capital
      *    1-APR-1991 18:45:14
           IF (WSS-OPEC IN WSS-VARI NOT = 'B') AND
              (VEN-VAL-CAPI IN VEN-FLD > ZEROES AND
               VEN-VAL-FINA IN VEN-FLD > ZEROES)
      *Fin AAA
               IF VEN-VAL-FINA IN VEN-FLD < VEN-VAL-CAPI IN VEN-FLD
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'VALFINACAPI<' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-VEN.

           IF VEN-VAL-FINA IN VEN-FLD < VEN-VAL-SFIN IN VEN-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'VALFINASFIN<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-VEN.

      *DAD ini 22-MAR-1991 
      * Valida que cuando sea Pesos la moneda no acepte valores con decimales
       INI-VAL-PES-DECI.
           MOVE 'TAB'    TO FIO-SIST.
           MOVE 'VLR'    TO TAB-CIC-TTAB.
           MOVE '0999  ' TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-VEN
           ELSE
               IF OPC-COD-VCOC IN VEN-FLD NOT = TAB-COD-CTAB IN TAB
                   GO TO FIN-VAL-PES-DECI.
           MOVE VEN-VAL-CAPI IN VEN-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF VEN-VAL-CAPI IN VEN-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.

           MOVE VEN-VAL-IDNI IN VEN-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF VEN-VAL-IDNI IN VEN-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.

           MOVE VEN-VAL-FINA IN VEN-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF VEN-VAL-FINA IN VEN-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.

           MOVE VEN-VAL-SFIN IN VEN-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF VEN-VAL-SFIN IN VEN-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.
           GO TO FIN-VAL-PES-DECI.
       MSG-VAL-PES-DECI.
           MOVE 'COL'       TO MSG-COD-SIST.
           MOVE 'VALNODECI' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-FLD-VEN.
       FIN-VAL-PES-DECI.
      *DAD fin 22-MAR-1991 
      *>>>>
       FIN-VAL-CON-FLD-VEN.
           EXIT.
       
       VAL-CON-VEN SECTION.
       INI-VAL-CON-VEN.
       FIN-VAL-CON-VEN.
           EXIT.
       
       VAL-NUM-KEY-VEN SECTION.
       INI-VAL-NUM-KEY-VEN.
           PERFORM VAL-NUM-IKY-VEN.
           PERFORM VAL-NUM-MKY-VEN.
           PERFORM VAL-NUM-AKY-VEN.
       FIN-VAL-NUM-KEY-VEN.
           EXIT.
       
       VAL-NUM-IKY-VEN SECTION.
       INI-VAL-NUM-IKY-VEN.
       VAL-NUM-VEN-IIC-IOPC.
           MOVE VEN-IIC-IOPC-ALF IN VEN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO VEN-IIC-IOPC IN VEN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-IIC-IOPC-LEN IN VEN-FLD
                GO TO FIN-VAL-NUM-IKY-VEN.
       FIN-VAL-NUM-IKY-VEN.
           EXIT.
       
       VAL-NUM-MKY-VEN SECTION.
       INI-VAL-NUM-MKY-VEN.
       FIN-VAL-NUM-MKY-VEN.
           EXIT.
       
       VAL-NUM-AKY-VEN SECTION.
       INI-VAL-NUM-AKY-VEN.
       VAL-NUM-VEN-NUM-IVCT.
           MOVE VEN-NUM-IVCT-ALF IN VEN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO VEN-NUM-IVCT IN VEN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-NUM-IVCT-LEN IN VEN-FLD
                GO TO FIN-VAL-NUM-AKY-VEN.
       VAL-NUM-VEN-NUM-IVEN.
           MOVE VEN-NUM-IVEN-ALF IN VEN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO VEN-NUM-IVEN IN VEN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-NUM-IVEN-LEN IN VEN-FLD
                GO TO FIN-VAL-NUM-AKY-VEN.
       FIN-VAL-NUM-AKY-VEN.
           EXIT.
       
       VAL-NUM-FLD-VEN SECTION.
       INI-VAL-NUM-FLD-VEN.
       VAL-NUM-VEN-NUM-IDLC.
           MOVE VEN-NUM-IDLC-ALF IN VEN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO VEN-NUM-IDLC IN VEN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-NUM-IDLC-LEN IN VEN-FLD
                GO TO FIN-VAL-NUM-FLD-VEN.
       VAL-NUM-VEN-VAL-CAPI.
           MOVE VEN-VAL-CAPI-ALF IN VEN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO VEN-VAL-CAPI IN VEN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-VAL-CAPI-LEN IN VEN-FLD
                GO TO FIN-VAL-NUM-FLD-VEN.
       VAL-NUM-VEN-VAL-SCAP.
           MOVE VEN-VAL-SCAP-ALF IN VEN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO VEN-VAL-SCAP IN VEN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-VAL-SCAP-LEN IN VEN-FLD
                GO TO FIN-VAL-NUM-FLD-VEN.
       VAL-NUM-VEN-VAL-IDNI.
           MOVE VEN-VAL-IDNI-ALF IN VEN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO VEN-VAL-IDNI IN VEN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-VAL-IDNI-LEN IN VEN-FLD
                GO TO FIN-VAL-NUM-FLD-VEN.
       VAL-NUM-VEN-VAL-FINA.
           MOVE VEN-VAL-FINA-ALF IN VEN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO VEN-VAL-FINA IN VEN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-VAL-FINA-LEN IN VEN-FLD
                GO TO FIN-VAL-NUM-FLD-VEN.
       VAL-NUM-VEN-VAL-SFIN.
           MOVE VEN-VAL-SFIN-ALF IN VEN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO VEN-VAL-SFIN IN VEN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-VAL-SFIN-LEN IN VEN-FLD
                GO TO FIN-VAL-NUM-FLD-VEN.
       FIN-VAL-NUM-FLD-VEN.
           EXIT.
       
       EDT-KEY-VEN SECTION.
       INI-EDT-KEY-VEN.
           PERFORM EDT-IKY-VEN.
           PERFORM EDT-MKY-VEN.
           PERFORM EDT-AKY-VEN.
       FIN-EDT-KEY-VEN.
           EXIT.
       
       EDT-IKY-VEN SECTION.
       INI-EDT-IKY-VEN.
           IF VEN-IIC-IOPC-LEN IN VEN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-IIC-IOPC-LEN IN VEN-FLD
                GO TO FIN-EDT-IKY-VEN.
           MOVE VEN-IIC-IOPC IN VEN-FLD TO VEN-IIC-IOPC-EDT IN VEN-EDT.
           MOVE VEN-IIC-IOPC-EDT IN VEN-EDT TO 
                VEN-IIC-IOPC-ALF IN VEN-FLD.
       FIN-EDT-IKY-VEN.
           EXIT.
       
       EDT-MKY-VEN SECTION.
       INI-EDT-MKY-VEN.
       FIN-EDT-MKY-VEN.
           EXIT.
       
       EDT-AKY-VEN SECTION.
       INI-EDT-AKY-VEN.
           IF VEN-NUM-IVCT-LEN IN VEN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-NUM-IVCT-LEN IN VEN-FLD
                GO TO FIN-EDT-AKY-VEN.
           MOVE VEN-NUM-IVCT IN VEN-FLD TO VEN-NUM-IVCT-EDT IN VEN-EDT.
           MOVE VEN-NUM-IVCT-EDT IN VEN-EDT TO 
                VEN-NUM-IVCT-ALF IN VEN-FLD.
           IF VEN-NUM-IVEN-LEN IN VEN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-NUM-IVEN-LEN IN VEN-FLD
                GO TO FIN-EDT-AKY-VEN.
           MOVE VEN-NUM-IVEN IN VEN-FLD TO VEN-NUM-IVEN-EDT IN VEN-EDT.
           MOVE VEN-NUM-IVEN-EDT IN VEN-EDT TO 
                VEN-NUM-IVEN-ALF IN VEN-FLD.
       FIN-EDT-AKY-VEN.
           EXIT.
       
       EDT-FLD-VEN SECTION.
       INI-EDT-FLD-VEN.
           IF VEN-NUM-IDLC-LEN IN VEN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-NUM-IDLC-LEN IN VEN-FLD
                GO TO FIN-EDT-FLD-VEN.
           MOVE VEN-NUM-IDLC IN VEN-FLD TO VEN-NUM-IDLC-EDT IN VEN-EDT.
           MOVE VEN-NUM-IDLC-EDT IN VEN-EDT TO 
                VEN-NUM-IDLC-ALF IN VEN-FLD.
           IF VEN-VAL-CAPI-LEN IN VEN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-CAPI-LEN IN VEN-FLD
                GO TO FIN-EDT-FLD-VEN.
           MOVE VEN-VAL-CAPI IN VEN-FLD TO VEN-VAL-CAPI-EDT IN VEN-EDT.
           MOVE VEN-VAL-CAPI-EDT IN VEN-EDT TO 
                VEN-VAL-CAPI-ALF IN VEN-FLD.
           IF VEN-VAL-SCAP-LEN IN VEN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-SCAP-LEN IN VEN-FLD
                GO TO FIN-EDT-FLD-VEN.
           MOVE VEN-VAL-SCAP IN VEN-FLD TO VEN-VAL-SCAP-EDT IN VEN-EDT.
           MOVE VEN-VAL-SCAP-EDT IN VEN-EDT TO 
                VEN-VAL-SCAP-ALF IN VEN-FLD.
           IF VEN-VAL-IDNI-LEN IN VEN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-IDNI-LEN IN VEN-FLD
                GO TO FIN-EDT-FLD-VEN.
           MOVE VEN-VAL-IDNI IN VEN-FLD TO VEN-VAL-IDNI-EDT IN VEN-EDT.
           MOVE VEN-VAL-IDNI-EDT IN VEN-EDT TO 
                VEN-VAL-IDNI-ALF IN VEN-FLD.
           IF VEN-VAL-FINA-LEN IN VEN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-FINA-LEN IN VEN-FLD
                GO TO FIN-EDT-FLD-VEN.
           MOVE VEN-VAL-FINA IN VEN-FLD TO VEN-VAL-FINA-EDT IN VEN-EDT.
           MOVE VEN-VAL-FINA-EDT IN VEN-EDT TO 
                VEN-VAL-FINA-ALF IN VEN-FLD.
           IF VEN-VAL-SFIN-LEN IN VEN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-VAL-SFIN-LEN IN VEN-FLD
                GO TO FIN-EDT-FLD-VEN.
           MOVE VEN-VAL-SFIN IN VEN-FLD TO VEN-VAL-SFIN-EDT IN VEN-EDT.
           MOVE VEN-VAL-SFIN-EDT IN VEN-EDT TO 
                VEN-VAL-SFIN-ALF IN VEN-FLD.
       FIN-EDT-FLD-VEN.
           EXIT.
