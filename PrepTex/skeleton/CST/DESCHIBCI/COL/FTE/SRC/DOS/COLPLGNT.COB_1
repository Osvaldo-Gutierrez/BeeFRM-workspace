       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLGNT.
       AUTHOR.          BEETEAM (JGM).
       DATE-WRITTEN.    12-Jun-00 04:27 PM.

      * Programa Listador de Reporte GNT sin Sort.
      *
      * V 1.1.2
      *


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.

            C01 IS SALTO
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT RPTGNT       ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTGNT       ASSIGN TO        UT-S-RPTGNT.
           SELECT RPTGNT       ASSIGN TO        RPTGNT.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       FD  RPTGNT LABEL RECORDS OMITTED
           BLOCK CONTAINS 0 RECORDS
           RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-GNT     PIC X(132).

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DNT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBRDNT.
       COPY COLRRGNT.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWGNT.
       COPY COLRNGNT.
       COPY COLROGNT.
       COPY GNSWGSYS.
       01  PGM-HRSR-GNT   VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-GNT  VALUE 'S'.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS

      *


      *<<<< WSS_DTC


      * AQUI EXISTIA LABEL RF INI
      * AQUI EXISTIA LABEL RF FIN
       COPY COLRTGNT.

       PROCEDURE DIVISION.
      *==================

      * AQUI EXISTIA LABEL FIN_DEC INI
      * AQUI EXISTIA LABEL FIN_DEC FIN

       MAIN SECTION.
      *------------
       INI-MAIN.
      *    MOVE SYS-MXFL TO SYS-CMND.
      *    PERFORM GNS-PRO-SYS.
       COPY GNSBGEDB.
      *    MOVE 'COL' TO RPT-SIST.
           MOVE 'COLPLGNT' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
       INI-INP-SRT.
      *     MOVE 'COLPLGNT' TO RPT-NPGM.
           PERFORM CAL-HDR.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-DNT.
       FST-INP-SRT.
      *<<<< INI_FST_INP
      * Fecha de proceso del archivo DNT
      *    MOVE ZERO TO WSS-VAL-STOT IN WSS-VARI.
      *    MOVE ZERO TO WSS-VAL-TTOT IN WSS-VARI.

      *Primer registro a procesar.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-DNT.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.

           MOVE DNT-NUM-SPRO IN DNT TO  WSS-NUM-SPRO IN WSS-GNT.
           MOVE DNT-NUM-APRO IN DNT TO  WSS-NUM-APRO IN WSS-GNT.
           MOVE DNT-NUM-MPRO IN DNT TO  WSS-NUM-MPRO IN WSS-GNT.
           MOVE DNT-NUM-DPRO IN DNT TO  WSS-NUM-DPRO IN WSS-GNT.
      *
      *


       COPY COLRMGNT.
       INI-OUT-SRT.
           OPEN OUTPUT RPTGNT.
           PERFORM INITIATE-RPTGNT.
           MOVE SRT TO SRT-OLD-GNT.
           MOVE SRT TO SRT-CUR-GNT.
      *    PERFORM GNT-FST-PRO-CTL.
       LUP-MAIN.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
       MOV-INP-SRT.
       COPY COLRMGNT.
       LUP-OUT-SRT.
      *
      *
           PERFORM GENERATE-DL-GNT.
       NXT-INP-SRT.
       NXT-OUT-SRT.
           MOVE SRT TO SRT-OLD-GNT.
       RET-OUT-SRT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DNT.
           GO TO LUP-MAIN.
       FIN-MAIN.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-DNT.
       FIN-OUT-SRT.
           IF HAY-REGISTROS-EN-SORT-GNT
                PERFORM TERMINATE-RPTGNT.
           CLOSE RPTGNT.
           IF PGM-STAT-SRT-MAL
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       COPY COLBFDNT.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGIRH.
       COPY COLREGNT.
      *    12-JUN-00 01:03 PM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
       D-CF-GNT-DNT-COD-OFIC SECTION.
       INI-CF-GNT-DNT-COD-OFIC.
      *>>>> CF_GNT_DNT_COD_OFIC

           MOVE ZEROES TO RPT-GNT-PAGE-COUNTER IN RPT-VARI-GNT.
      *<<<<

       FIN-CF-GNT-DNT-COD-OFIC.
           EXIT.
       D-CH-GNT-DNT-COD-OFIC SECTION.
       INI-CH-GNT-DNT-COD-OFIC.
       FIN-CH-GNT-DNT-COD-OFIC.
           EXIT.
      *------------------------------*
       D-CF-GNT-DNT-COD-NOTC SECTION.
       INI-CF-GNT-DNT-COD-NOTC.
       FIN-CF-GNT-DNT-COD-NOTC.
           EXIT.
      *------------------------------*
       D-CF-GNT-DNT-COD-USER SECTION.
       INI-CF-GNT-DNT-COD-USER.
       FIN-CF-GNT-DNT-COD-USER.
           EXIT.
       D-PH-GNT SECTION.
       INI-PH-GNT.
       FIN-PH-GNT.
           EXIT.
       D-DL-GNT SECTION.
       INI-DL-GNT.
       FIN-DL-GNT.
           EXIT.
       COPY GNSBGABT.

