       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPBTXC.
       AUTHOR.          BEE-TEAM.
       DATE-WRITTEN.    14-ABRIL-1999

      * INICIALIZA TABLA TXC A PARTIR DE CAM SECUENCIAL Y ARCHIVO
      * SAFTASD


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------

       WORKING-STORAGE SECTION.
      *-----------------------

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWVIDD.
       COPY GNSBRTAB.
       COPY GNSBRMSG.

       COPY GNSWGSYS.


       COPY TABBRCAM.
       COPY TABBRCAS.
      *COPY TABBRTXC.
       COPY TABBRTXS.
       COPY GNSWGHOY.
       COPY GNSWGFEC.

      *<<<< WSS
        01 WSS-VARI.
           03 WSS-HVAL               VALUE 999999999 PIC 9(09).
           03 WSS-CAM-SGV-VS90       VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-CAM-SGV-VB90       VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-CAM-SGV-VREA       VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-CAM-SGV-VMNX       VALUE ZEROES    PIC 9(11)V9(04).
      *CONTADORES
           03 WSS-NUM-SGV-VS90       VALUE ZEROES    PIC 9(11).
           03 WSS-NUM-SGV-VB90       VALUE ZEROES    PIC 9(11).
           03 WSS-NUM-SGV-VREA       VALUE ZEROES    PIC 9(11).
           03 WSS-NUM-SGV-VMNX       VALUE ZEROES    PIC 9(11).
      *
           03 WSS-ACU-SGV-VS90       VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-ACU-SGV-VB90       VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-ACU-SGV-VREA       VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-ACU-SGV-VMNX       VALUE ZEROES    PIC 9(11)V9(04).

      *INDICADORES
           03 WSS-IND-SGV-VS90       VALUE 'S'       PIC X(01).
           03 WSS-IND-SGV-VB90       VALUE 'S'       PIC X(01).
           03 WSS-IND-SGV-VREA       VALUE 'S'       PIC X(01).
           03 WSS-IND-SGV-VMNX       VALUE 'S'       PIC X(01).

           03 WSS-FEC-FS90.
              05  WSS-NUM-DS90                       PIC 9(02).
              05  WSS-NUM-MS90                       PIC 9(02).
              05  WSS-NUM-SS90                       PIC 9(02).
              05  WSS-NUM-AS90                       PIC 9(02).
           03 WSS-FEC-FB90.
              05  WSS-NUM-DB90                       PIC 9(02).
              05  WSS-NUM-MB90                       PIC 9(02).
              05  WSS-NUM-SB90                       PIC 9(02).
              05  WSS-NUM-AB90                       PIC 9(02).
           03 WSS-FEC-FREA.
              05  WSS-NUM-DREA                       PIC 9(02).
              05  WSS-NUM-MREA                       PIC 9(02).
              05  WSS-NUM-SREA                       PIC 9(02).
              05  WSS-NUM-AREA                       PIC 9(02).
           03 WSS-FEC-FMNX.
              05  WSS-NUM-DMNX                       PIC 9(02).
              05  WSS-NUM-MMNX                       PIC 9(02).
              05  WSS-NUM-SMNX                       PIC 9(02).
              05  WSS-NUM-AMNX                       PIC 9(02).


      *ENTIDADES DE GNS
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPBTXC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-CAS.
           IF NOT FIO-STAT-OKS
              DISPLAY '     '
              DISPLAY 'ERROR AL ABRIR ARCHIVO CAS, PROCESO ABORTADO'
              PERFORM GNS-PRO-ABT.

           MOVE FIO-OUT TO FIO-CMND.
           PERFORM TAB-FIO-TXS.
           IF NOT FIO-STAT-OKS
              DISPLAY '     '
              DISPLAY 'ERROR AL ABRIR ARCHIVO TXS, PROCESO ABORTADO'
              PERFORM GNS-PRO-ABT.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM TAB-FIO-CAS.
           IF NOT FIO-STAT-OKS
              DISPLAY '     '
              DISPLAY 'ERROR NO EXISTEN REGISTROS CAM'
              PERFORM GNS-PRO-ABT.

           PERFORM GET-FHOY.

           MOVE ZEROES TO WSS-CAM-SGV-VS90.
           MOVE ZEROES TO WSS-CAM-SGV-VB90.
           MOVE ZEROES TO WSS-CAM-SGV-VREA.
           MOVE ZEROES TO WSS-CAM-SGV-VMNX.
           MOVE ZEROES TO WSS-FEC-FS90.
           MOVE ZEROES TO WSS-FEC-FB90.
           MOVE ZEROES TO WSS-FEC-FREA.
           MOVE ZEROES TO WSS-FEC-FMNX.
      *

       LUP-MAIN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MAIN.

           MOVE CAS TO CAM.
           IF CAM-MSC-STAT IN CAM NOT = 'S'
               GO TO NXT-MAIN.
           IF CAM-FEC-FCAM IN CAM(1) NOT = CAM-FEC-FCAM IN CAM(2)
               GO TO NXT-MAIN.
           IF CAM-FEC-FCAM IN CAM(1) > HOY-FHOY
               GO TO FIN-MAIN.
           IF CAM-COD-VCAM IN CAM(2) = 'TS90'  AND
              CAM-COD-VCAM IN CAM(1) = '0999  '
               IF CAM-SGV-VCAM IN CAM = WSS-CAM-SGV-VS90
                   MOVE FIO-GET-NXT TO FIO-CMND
                   PERFORM TAB-FIO-CAS
                   GO TO NXT-MAIN
               ELSE
                   ADD 1 TO WSS-NUM-SGV-VS90
                   PERFORM GRABA-TXC-VS90
                   MOVE CAM-SGV-VCAM IN CAM TO  WSS-CAM-SGV-VS90
                   GO TO NXT-MAIN.

           IF CAM-COD-VCAM IN CAM(2) = 'TB90'  AND
              CAM-COD-VCAM IN CAM(1) = '0999  '
               IF CAM-SGV-VCAM IN CAM = WSS-CAM-SGV-VB90
                   MOVE FIO-GET-NXT TO FIO-CMND
                   PERFORM TAB-FIO-CAS
                   GO TO NXT-MAIN
               ELSE
                   ADD 1 TO WSS-NUM-SGV-VB90
                   PERFORM GRABA-TXC-VB90
                   MOVE CAM-SGV-VCAM IN CAM TO  WSS-CAM-SGV-VB90
                   GO TO NXT-MAIN.

           IF CAM-COD-VCAM IN CAM(2) = 'TMXC'  AND
              CAM-COD-VCAM IN CAM(1) = '0998  '
               IF CAM-SGV-VCAM IN CAM = WSS-CAM-SGV-VREA
                   MOVE FIO-GET-NXT TO FIO-CMND
                   PERFORM TAB-FIO-CAS
                   GO TO NXT-MAIN
               ELSE
                   ADD 1 TO WSS-NUM-SGV-VREA
                   PERFORM GRABA-TXC-VREA
                   MOVE CAM-SGV-VCAM IN CAM TO  WSS-CAM-SGV-VREA
                   GO TO NXT-MAIN.

           IF CAM-COD-VCAM IN CAM(2) = 'TMXC'  AND
              CAM-COD-VCAM IN CAM(1) = 'TMEX  '
               IF CAM-SGV-VCAM IN CAM = WSS-CAM-SGV-VMNX
                   MOVE FIO-GET-NXT TO FIO-CMND
                   PERFORM TAB-FIO-CAS
                   GO TO NXT-MAIN
               ELSE
                   ADD 1 TO WSS-NUM-SGV-VMNX
                   PERFORM GRABA-TXC-VMNX
                   MOVE CAM-SGV-VCAM IN CAM TO  WSS-CAM-SGV-VMNX
                   GO TO NXT-MAIN.

       NXT-MAIN.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM TAB-FIO-CAS.
           GO TO LUP-MAIN.

       FIN-MAIN.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM TAB-FIO-CAS.
           PERFORM TAB-FIO-TXS.
           DISPLAY 'TOTAL CAMBIOS TASA TS90 : ' WSS-NUM-SGV-VS90.
           DISPLAY 'TOTAL CAMBIOS TASA TB90 : ' WSS-NUM-SGV-VB90.
           DISPLAY 'TOTAL CAMBIOS TASA TMXC : ' WSS-NUM-SGV-VREA.
           DISPLAY 'TOTAL CAMBIOS TASA ESTR : ' WSS-NUM-SGV-VMNX.
           PERFORM GNS-PRO-END.


       GRABA-TXC-VS90 SECTION.
       INI-GRABA-TXC-VS90.
      *    Tasa Maximas Convencionales
      *    ---------------------------
      *
      *    Filler Compatibilidad VSAM/MVS
           MOVE SPACES                 TO TXS-GLS-FLAG IN TXS.
      *
      *    Clave Primaria Registro
      *        Sinonimo de Plazo
           MOVE  'T$S9'                TO TXS-COD-PLZO IN TXS.
      *
      *        Valor de Cambio
           MOVE  '0999  '              TO  TXS-COD-VCOC IN TXS.
      *
      *        Fecha de Vigencia
           MOVE CAM-NUM-DCAM IN CAM(1) TO TXS-NUM-DTXC IN TXS.
           MOVE CAM-NUM-MCAM IN CAM(1) TO TXS-NUM-MTXC IN TXS.
           MOVE CAM-NUM-SCAM IN CAM(1) TO TXS-NUM-STXC IN TXS.
           MOVE CAM-NUM-ACAM IN CAM(1) TO TXS-NUM-ATXC IN TXS.
      *
      *        Complemento del Monto Superior del Tramo
           MOVE  ZEROES                TO TXS-NUM-CMST IN TXS.
      *
      *    Time Stamp Transaccion
           MOVE HOY-STP-ITRN           TO TXS-STP-ITRN IN TXS.
      *
      *    Indicador Estado (Ingresado, Verificado)
           MOVE  'V'                   TO TXS-MSC-STAT IN TXS.
      *
      *    Indicador Antiguedad (Historico, Ultimo)
           MOVE  'U'                   TO TXS-MSC-ANTI IN TXS.
      *
      *    Codigo Origen Transaccion
           MOVE  'CINI'                TO TXS-COD-OTRN IN TXS.
      *
      *    Autor Transaccion
           MOVE 'COLPBTXC'             TO TXS-COD-ATRN IN TXS.
      *
      *    Monto Superior del Tramo
           MOVE  WSS-HVAL              TO TXS-NUM-MSTR IN TXS.
      *
      *    Valor Acumulado de Tasa Maxima Convencional
           IF WSS-IND-SGV-VS90 = 'S'
               DISPLAY 'TS90 ' CAM-FEC-FCAM IN CAM(1)
               MOVE ZEROES TO WSS-ACU-SGV-VS90
               MOVE ZEROES TO TXS-SGV-ATXC IN TXS
               MOVE 'N'    TO WSS-IND-SGV-VS90
           ELSE
               PERFORM CAL-ACUMULADO-VS90.
           MOVE CAM-NUM-DCAM IN CAM(1) TO WSS-NUM-DS90.
           MOVE CAM-NUM-MCAM IN CAM(1) TO WSS-NUM-MS90.
           MOVE CAM-NUM-SCAM IN CAM(1) TO WSS-NUM-SS90.
           MOVE CAM-NUM-ACAM IN CAM(1) TO WSS-NUM-AS90.

      *
      *    Valor de Tasa Maxima Convencional
           MOVE  CAM-SGV-VCAM IN CAM   TO TXS-SGV-VTXC IN TXS.
      *    Disponible
           MOVE ' '                    TO TXS-COD-BASE IN TXS.
           MOVE  SPACES                TO TXS-GLS-DISP IN TXS.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM TAB-FIO-TXS.
       FIN-GRABA-TXC-VS90.
           EXIT.

       GRABA-TXC-VB90 SECTION.
       INI-GRABA-TXC-VB90.
      *    Tasa Maximas Convencionales
      *    ---------------------------
      *
      *    Filler Compatibilidad VSAM/MVS
           MOVE SPACES                 TO TXS-GLS-FLAG IN TXS.
      *
      *    Clave Primaria Registro
      *        Sinonimo de Plazo
           MOVE  'T$B9'                TO TXS-COD-PLZO IN TXS.
      *
      *        Valor de Cambio
           MOVE  '0999  '              TO  TXS-COD-VCOC IN TXS.
      *
      *        Fecha de Vigencia
           MOVE CAM-NUM-DCAM IN CAM(1) TO TXS-NUM-DTXC IN TXS.
           MOVE CAM-NUM-MCAM IN CAM(1) TO TXS-NUM-MTXC IN TXS.
           MOVE CAM-NUM-SCAM IN CAM(1) TO TXS-NUM-STXC IN TXS.
           MOVE CAM-NUM-ACAM IN CAM(1) TO TXS-NUM-ATXC IN TXS.
      *
      *        Complemento del Monto Superior del Tramo
           MOVE  ZEROES                TO TXS-NUM-CMST IN TXS.
      *
      *    Time Stamp Transaccion
           MOVE HOY-STP-ITRN           TO TXS-STP-ITRN IN TXS.
      *
      *    Indicador Estado (Ingresado, Verificado)
           MOVE  'V'                   TO TXS-MSC-STAT IN TXS.
      *
      *    Indicador Antiguedad (Historico, Ultimo)
           MOVE  'U'                   TO TXS-MSC-ANTI IN TXS.
      *
      *    Codigo Origen Transaccion
           MOVE  'CINI'                TO TXS-COD-OTRN IN TXS.
      *
      *    Autor Transaccion
           MOVE 'COLPBTXC'             TO TXS-COD-ATRN IN TXS.
      *
      *    Monto Superior del Tramo
           MOVE  WSS-HVAL              TO TXS-NUM-MSTR IN TXS.
      *
      *    Valor Acumulado de Tasa Maxima Convencional
           IF WSS-IND-SGV-VB90 = 'S'
               DISPLAY 'TB90 ' CAM-FEC-FCAM IN CAM(1)
               MOVE ZEROES TO WSS-ACU-SGV-VB90
               MOVE ZEROES TO TXS-SGV-ATXC IN TXS
               MOVE 'N'    TO WSS-IND-SGV-VB90
           ELSE
               PERFORM CAL-ACUMULADO-VB90.
           MOVE CAM-NUM-DCAM IN CAM(1) TO WSS-NUM-DB90.
           MOVE CAM-NUM-MCAM IN CAM(1) TO WSS-NUM-MB90.
           MOVE CAM-NUM-SCAM IN CAM(1) TO WSS-NUM-SB90.
           MOVE CAM-NUM-ACAM IN CAM(1) TO WSS-NUM-AB90.
      *
      *    Valor de Tasa Maxima Convencional
           MOVE  CAM-SGV-VCAM IN CAM   TO TXS-SGV-VTXC IN TXS.
      *    Disponible
           MOVE ' '                    TO TXS-COD-BASE IN TXS.
           MOVE  SPACES                TO TXS-GLS-DISP IN TXS.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM TAB-FIO-TXS.
       FIN-GRABA-TXC-VB90.
           EXIT.

       GRABA-TXC-VREA SECTION.
       INI-GRABA-TXC-VREA.
      *    Tasa Maximas Convencionales
      *    ---------------------------
      *
      *    Filler Compatibilidad VSAM/MVS
           MOVE SPACES                 TO TXS-GLS-FLAG IN TXS.
      *
      *    Clave Primaria Registro
      *        Sinonimo de Plazo
           MOVE  '*   '                TO TXS-COD-PLZO IN TXS.
      *
      *        Valor de Cambio
           MOVE  '0998  '              TO  TXS-COD-VCOC IN TXS.
      *
      *        Fecha de Vigencia
           MOVE CAM-NUM-DCAM IN CAM(1) TO TXS-NUM-DTXC IN TXS.
           MOVE CAM-NUM-MCAM IN CAM(1) TO TXS-NUM-MTXC IN TXS.
           MOVE CAM-NUM-SCAM IN CAM(1) TO TXS-NUM-STXC IN TXS.
           MOVE CAM-NUM-ACAM IN CAM(1) TO TXS-NUM-ATXC IN TXS.
      *
      *        Complemento del Monto Superior del Tramo
           MOVE  ZEROES                TO TXS-NUM-CMST IN TXS.
      *
      *    Time Stamp Transaccion
           MOVE HOY-STP-ITRN           TO TXS-STP-ITRN IN TXS.
      *
      *    Indicador Estado (Ingresado, Verificado)
           MOVE  'V'                   TO TXS-MSC-STAT IN TXS.
      *
      *    Indicador Antiguedad (Historico, Ultimo)
           MOVE  'U'                   TO TXS-MSC-ANTI IN TXS.
      *
      *    Codigo Origen Transaccion
           MOVE  'CINI'                TO TXS-COD-OTRN IN TXS.
      *
      *    Autor Transaccion
           MOVE 'COLPBTXC'             TO TXS-COD-ATRN IN TXS.
      *
      *    Monto Superior del Tramo
           MOVE  WSS-HVAL              TO TXS-NUM-MSTR IN TXS.
      *
      *    Valor Acumulado de Tasa Maxima Convencional
           IF WSS-IND-SGV-VREA = 'S'
               DISPLAY 'TMRJ ' CAM-FEC-FCAM IN CAM(1)
               MOVE ZEROES TO WSS-ACU-SGV-VREA
               MOVE ZEROES TO TXS-SGV-ATXC IN TXS
               MOVE 'N'    TO WSS-IND-SGV-VREA
           ELSE
               PERFORM CAL-ACUMULADO-VREA.
           MOVE CAM-NUM-DCAM IN CAM(1) TO WSS-NUM-DREA.
           MOVE CAM-NUM-MCAM IN CAM(1) TO WSS-NUM-MREA.
           MOVE CAM-NUM-SCAM IN CAM(1) TO WSS-NUM-SREA.
           MOVE CAM-NUM-ACAM IN CAM(1) TO WSS-NUM-AREA.
      *
      *    Valor de Tasa Maxima Convencional
           MOVE  CAM-SGV-VCAM IN CAM   TO TXS-SGV-VTXC IN TXS.
      *    Disponible
           MOVE 'A'                    TO TXS-COD-BASE IN TXS.
           MOVE  SPACES                TO TXS-GLS-DISP IN TXS.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM TAB-FIO-TXS.
       FIN-GRABA-TXC-VREA.
           EXIT.

       GRABA-TXC-VMNX SECTION.
       INI-GRABA-TXC-VMNX.
      *    Tasa Maximas Convencionales
      *    ---------------------------
      *
      *    Filler Compatibilidad VSAM/MVS
           MOVE SPACES                 TO TXS-GLS-FLAG IN TXS.
      *
      *    Clave Primaria Registro
      *        Sinonimo de Plazo
           MOVE  '*   '                TO TXS-COD-PLZO IN TXS.
      *
      *        Valor de Cambio
           MOVE  'MEXT  '              TO  TXS-COD-VCOC IN TXS.
      *
      *        Fecha de Vigencia
           MOVE CAM-NUM-DCAM IN CAM(1) TO TXS-NUM-DTXC IN TXS.
           MOVE CAM-NUM-MCAM IN CAM(1) TO TXS-NUM-MTXC IN TXS.
           MOVE CAM-NUM-SCAM IN CAM(1) TO TXS-NUM-STXC IN TXS.
           MOVE CAM-NUM-ACAM IN CAM(1) TO TXS-NUM-ATXC IN TXS.
      *
      *        Complemento del Monto Superior del Tramo
           MOVE  ZEROES                TO TXS-NUM-CMST IN TXS.
      *
      *    Time Stamp Transaccion
           MOVE HOY-STP-ITRN           TO TXS-STP-ITRN IN TXS.
      *
      *    Indicador Estado (Ingresado, Verificado)
           MOVE  'V'                   TO TXS-MSC-STAT IN TXS.
      *
      *    Indicador Antiguedad (Historico, Ultimo)
           MOVE  'U'                   TO TXS-MSC-ANTI IN TXS.
      *
      *    Codigo Origen Transaccion
           MOVE  'CINI'                TO TXS-COD-OTRN IN TXS.
      *
      *    Autor Transaccion
           MOVE 'COLPBTXC'             TO TXS-COD-ATRN IN TXS.
      *
      *    Monto Superior del Tramo
           MOVE  WSS-HVAL              TO TXS-NUM-MSTR IN TXS.
      *
      *    Valor Acumulado de Tasa Maxima Convencional
           IF WSS-IND-SGV-VMNX = 'S'
               DISPLAY 'TMEX ' CAM-FEC-FCAM IN CAM(1)
               MOVE ZEROES TO TXS-SGV-ATXC IN TXS
               MOVE ZEROES TO WSS-ACU-SGV-VMNX
               MOVE 'N'    TO WSS-IND-SGV-VMNX
           ELSE
               PERFORM CAL-ACUMULADO-VMNX.
           MOVE CAM-NUM-DCAM IN CAM(1) TO WSS-NUM-DMNX.
           MOVE CAM-NUM-MCAM IN CAM(1) TO WSS-NUM-MMNX.
           MOVE CAM-NUM-SCAM IN CAM(1) TO WSS-NUM-SMNX.
           MOVE CAM-NUM-ACAM IN CAM(1) TO WSS-NUM-AMNX.
      *
      *    Valor de Tasa Maxima Convencional
           MOVE  CAM-SGV-VCAM IN CAM   TO TXS-SGV-VTXC IN TXS.
      *    Disponible
           MOVE ' '                    TO TXS-COD-BASE IN TXS.
           MOVE  SPACES                TO TXS-GLS-DISP IN TXS.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM TAB-FIO-TXS.
       FIN-GRABA-TXC-VMNX.
           EXIT.

       COPY TABBFTXS.
       COPY TABBFCAS.
       COPY GNSBTABT.
       COPY GNSBGABT.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBGEND.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBBSYS.
       COPY GNSBBMSG.
       COPY GNSBGHOY.
       COPY GNSBPFEC.
       COPY GNSBGFEC.
       CAL-ACUMULADO-VS90 SECTION.
       INI-CAL-ACUMULADO-VS90.
           MOVE WSS-NUM-DS90        TO FEC-DEC1.
           MOVE WSS-NUM-MS90        TO FEC-MEC1.
           MOVE WSS-NUM-SS90        TO FEC-SEC1.
           MOVE WSS-NUM-AS90        TO FEC-AEC1.

           MOVE CAM-NUM-DCAM IN CAM(1) TO FEC-DEC2.
           MOVE CAM-NUM-MCAM IN CAM(1) TO FEC-MEC2.
           MOVE CAM-NUM-SCAM IN CAM(1) TO FEC-SEC2.
           MOVE CAM-NUM-ACAM IN CAM(1) TO FEC-AEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR-DIF-DIA ' FEC-FEC1 '/' FEC-FEC2
               DISPLAY 'CAM : ' CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
               GO TO FIN-CAL-ACUMULADO-VS90.
           DISPLAY 'DIF-DIA ' FEC-FEC1 '/' FEC-FEC2 '/' FEC-NDIA.

           COMPUTE WSS-ACU-SGV-VS90    ROUNDED = WSS-ACU-SGV-VS90  +
                   WSS-CAM-SGV-VS90 * 12 * FEC-NDIA.
           MOVE WSS-ACU-SGV-VS90    TO TXS-SGV-ATXC IN TXS.
       FIN-CAL-ACUMULADO-VS90.
           EXIT.

       CAL-ACUMULADO-VB90 SECTION.
       INI-CAL-ACUMULADO-VB90.
           MOVE WSS-NUM-DB90        TO FEC-DEC1.
           MOVE WSS-NUM-MB90        TO FEC-MEC1.
           MOVE WSS-NUM-SB90        TO FEC-SEC1.
           MOVE WSS-NUM-AB90        TO FEC-AEC1.

           MOVE CAM-NUM-DCAM IN CAM(1) TO FEC-DEC2.
           MOVE CAM-NUM-MCAM IN CAM(1) TO FEC-MEC2.
           MOVE CAM-NUM-SCAM IN CAM(1) TO FEC-SEC2.
           MOVE CAM-NUM-ACAM IN CAM(1) TO FEC-AEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR-DIF-DIA ' FEC-FEC1 '/' FEC-FEC2
               DISPLAY 'CAM : ' CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
               GO TO FIN-CAL-ACUMULADO-VB90.

           COMPUTE WSS-ACU-SGV-VB90    ROUNDED = WSS-ACU-SGV-VB90 +
                   WSS-CAM-SGV-VB90 * 12 * FEC-NDIA.
           MOVE WSS-ACU-SGV-VB90    TO TXS-SGV-ATXC IN TXS.
       FIN-CAL-ACUMULADO-VB90.
           EXIT.

       CAL-ACUMULADO-VREA SECTION.
       INI-CAL-ACUMULADO-VREA.
           MOVE WSS-NUM-DREA        TO FEC-DEC1.
           MOVE WSS-NUM-MREA        TO FEC-MEC1.
           MOVE WSS-NUM-SREA        TO FEC-SEC1.
           MOVE WSS-NUM-AREA        TO FEC-AEC1.

           MOVE CAM-NUM-DCAM IN CAM(1) TO FEC-DEC2.
           MOVE CAM-NUM-MCAM IN CAM(1) TO FEC-MEC2.
           MOVE CAM-NUM-SCAM IN CAM(1) TO FEC-SEC2.
           MOVE CAM-NUM-ACAM IN CAM(1) TO FEC-AEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR-DIF-DIA ' FEC-FEC1 '/' FEC-FEC2
               DISPLAY 'CAM : ' CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
               GO TO FIN-CAL-ACUMULADO-VREA.

           COMPUTE WSS-ACU-SGV-VREA    ROUNDED = WSS-ACU-SGV-VREA +
                   WSS-CAM-SGV-VREA * FEC-NDIA.
           MOVE WSS-ACU-SGV-VREA    TO TXS-SGV-ATXC IN TXS.
       FIN-CAL-ACUMULADO-VREA.
           EXIT.

       CAL-ACUMULADO-VMNX SECTION.
       INI-CAL-ACUMULADO-VMNX.
           MOVE WSS-NUM-DMNX        TO FEC-DEC1.
           MOVE WSS-NUM-MMNX        TO FEC-MEC1.
           MOVE WSS-NUM-SMNX        TO FEC-SEC1.
           MOVE WSS-NUM-AMNX        TO FEC-AEC1.

           MOVE CAM-NUM-DCAM IN CAM(1) TO FEC-DEC2.
           MOVE CAM-NUM-MCAM IN CAM(1) TO FEC-MEC2.
           MOVE CAM-NUM-SCAM IN CAM(1) TO FEC-SEC2.
           MOVE CAM-NUM-ACAM IN CAM(1) TO FEC-AEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR-DIF-DIA ' FEC-FEC1 '/' FEC-FEC2
               DISPLAY 'CAM : ' CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
               GO TO FIN-CAL-ACUMULADO-VMNX.

           COMPUTE WSS-ACU-SGV-VMNX    ROUNDED = WSS-ACU-SGV-VMNX +
                   WSS-CAM-SGV-VMNX * FEC-NDIA.
           MOVE WSS-ACU-SGV-VMNX    TO TXS-SGV-ATXC IN TXS.
       FIN-CAL-ACUMULADO-VMNX.
           EXIT.

