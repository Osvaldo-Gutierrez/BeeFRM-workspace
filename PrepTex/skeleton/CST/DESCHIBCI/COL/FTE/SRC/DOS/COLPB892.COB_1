       IDENTIFICATION DIVISION.
      *************************
       PROGRAM-ID.     COLPB892.
      *AUTHOR.         DONOSO JARA OSVALDO.
      *                DATE-WRITTEN,  30/08/94.
      ******************************************************************
      *  Sistema  : Colocaciones                                       *
      *  Subsist. :                                                    *
      *  Analista : Retamal Pablo                                      *
      *  OBJETIVO : GENERA ARCHIVOS CARTERA VCD Y CAS PARA SER ENVIAD. *
      *             A SISTEMA COBRANZAS DE EXCEL EN UNIX.              *
      *                                                                *
      ******************************************************************
           EJECT
       ENVIRONMENT DIVISION.
      **********************
       CONFIGURATION SECTION.
      *======================
       SPECIAL-NAMES.
      ***** DECIMAL-POINT IS COMMA.
           EJECT
       INPUT-OUTPUT SECTION.
      *=====================
       FILE-CONTROL.
           SELECT CUOTAS  ASSIGN TO CUOTAS
                  FILE STATUS IS WR-FS-CUOTAS.
           SELECT OPERAC  ASSIGN TO OPERAC
                  FILE STATUS IS WR-FS-OPERAC.
           SELECT DEUDOR  ASSIGN TO DEUDOR
                  FILE STATUS IS WR-FS-DEUDOR.
           SELECT RDEUOP  ASSIGN TO RDEUOP
                  FILE STATUS IS WR-FS-RDEUOP.
           SELECT DIRECC  ASSIGN TO DIRECC
                  FILE STATUS IS WR-FS-DIRECC.
           SELECT TELEFO  ASSIGN TO TELEFO
                  FILE STATUS IS WR-FS-TELEFO.
310599*    SELECT SAFTAS  ASSIGN TO SAFTAS
310599*           ORGANIZATION   IS INDEXED
310599*           ACCESS MODE    IS RANDOM
310599*           RECORD KEY     IS TMC-KEY-ITMC
310599*           FILE STATUS IS WR-FS-SAFTAS.
           SELECT FSORT   ASSIGN TO SORTWK1.
           EJECT
       DATA DIVISION.
      *==============
           SKIP3
       FILE SECTION.
      *=============

       SD  FSORT.
       01  REG-FSORT.
           05 SD-CIC-ICLI           PIC X(12).
           05 SD-IND-DEU            PIC X(03).
           05 SD-CIC-IOPC           PIC X(12).
           05 SD-NUM-IVEN           PIC 9(03).
           05 SD-NUM-IVCT           PIC 9(03).
           05 SD-VAL-SFIN           PIC 9(11)V9(04).
           05 SD-FEC-FVEN.
              10 SD-NUM-SVEN        PIC 9(02).
              10 SD-NUM-AVEN        PIC 9(02).
              10 SD-NUM-MVEN        PIC 9(02).
              10 SD-NUM-DVEN        PIC 9(02).
           05 SD-OPC-COD-VCOC           PIC X(06).
           05 SD-OPC-COD-COOC           PIC X(06).
           05 SD-OPC-COD-OFOC           PIC X(03).
           05 SD-OPC-CIC-IOPC           PIC X(12).
           05 SD-OPC-FEC-FCOL           PIC X(08).
           05 SD-OPC-VAL-SCRE           PIC S9(11)V9(04).
           05 SD-OPC-VAL-CRED           PIC S9(11)V9(04).
           05 SD-OPC-NUM-VCOR           PIC 9(03).
           05 SD-OPC-NUM-TVCC           PIC 9(03).
           05 SD-OPC-NUM-IVEN           PIC 9(03).
           05 SD-OPC-NUM-VCVG           PIC 9(03).
           05 SD-OPC-COD-RMOC           PIC X(12).
           05 SD-DLC-COD-PLZO           PIC X(02).
           05 SD-DLC-FEC-FMAV           PIC X(08).
           05 SD-DLC-IND-SCTB           PIC X(03).

       FD  CUOTAS
      **   RECORD CONTAINS 79 CHARACTERS
      **** PRP 26.03.96
      **   RECORD CONTAINS 81 CHARACTERS
      **** NNV 25.05.99
           RECORD CONTAINS 117 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.

       01  REG-CUOTAS.
           05 CCC-NUM-OPE           PIC X(12).
           05 CCC-FILLER1           PIC X(01).
           05 CCC-NUM-CUO           PIC 9(03).
           05 CCC-FILLER2           PIC X(01).
           05 CCC-FILLER3           PIC X(01).
           05 CCC-MON-ORI           PIC 9(11).9(04).
           05 CCC-FILLER4           PIC X(01).
           05 CCC-FEC-VCT           PIC X(08).
           05 CCC-FILLER5           PIC X(01).
           05 CCC-FILLER6           PIC X(01).
           05 CCC-INT-MOR           PIC 9(11).9(04).
           05 CCC-FILLER7           PIC X(01).
           05 CCC-FILLER8           PIC X(01).
           05 CCC-MON-TOT           PIC 9(11).9(04).
      **** PRP 26.03.96
           05 CCC-FILLER9           PIC X(01).
           05 CCC-FILLER10          PIC X(01).
      **** NNV 25.05.99
           05 CCC-FILLER11          PIC X(01).
           05 CCC-TAS-PER           PIC 9(11).9(04).
           05 CCC-FILLER12          PIC X(01).
           05 CCC-FILLER13          PIC X(01).
           05 CCC-TAS-INC           PIC 9(11).9(04).
           05 CCC-FILLER14          PIC X(01).


       FD  OPERAC
      ***  RECORD CONTAINS 180 CHARACTERS
      **** PRP 26.03.96
      **** RECORD CONTAINS 183 CHARACTERS
      **** PRP 10.09.96
      **** RECORD CONTAINS 190 CHARACTERS
      **** NNV 25.05.99
           RECORD CONTAINS 203 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.

       01  REG-OPERAC.
           05 OOO-COD-PRO           PIC X(06).
           05 OOO-FILLER1           PIC X(01).
           05 OOO-COD-SUC           PIC X(03).
           05 OOO-FILLER2           PIC X(01).
           05 OOO-NUM-OPE           PIC X(12).
           05 OOO-FILLER3           PIC X(01).
           05 OOO-COD-MON           PIC X(06).
           05 OOO-FILLER4           PIC X(01).
           05 OOO-FILLER5           PIC X(01).
           05 OOO-MON-CRE           PIC 9(11).9(04).
           05 OOO-FILLER6           PIC X(01).
           05 OOO-FEC-CUR           PIC X(08).
           05 OOO-FILLER7           PIC X(01).
           05 OOO-FILLER8           PIC X(01).
           05 OOO-MON-SAL           PIC 9(11).9(04).
           05 OOO-FILLER9           PIC X(01).
           05 OOO-NUM-CUO           PIC 9(03).
           05 OOO-FILLER10          PIC X(01).
           05 OOO-FEC-VCT           PIC X(08).
           05 OOO-FILLER11          PIC X(01).
           05 OOO-NUM-REN           PIC 9(03).
           05 OOO-FILLER12          PIC X(01).
           05 OOO-TAS-PAC           PIC  9(03).9(4).
           05 OOO-FILLER13          PIC X(01).
           05 OOO-TAS-MOR           PIC  9(03).9(4).
           05 OOO-FILLER14          PIC X(01).
           05 OOO-FILLER15          PIC X(01).
           05 OOO-MON-MOR           PIC 9(11).9(4).
           05 OOO-FILLER16          PIC X(01).
           05 OOO-FILLER17          PIC X(01).
           05 OOO-CUP-NAC           PIC 9(11).9(4).
           05 OOO-FILLER18          PIC X(01).
           05 OOO-FILLER19          PIC X(01).
           05 OOO-CUP-INT           PIC 9(11).9(4).
           05 OOO-FILLER20          PIC X(01).
           05 OOO-PRI-CUO           PIC 9(03).
           05 OOO-FILLER21          PIC X(01).
           05 OOO-CUO-IMP           PIC 9(03).
           05 OOO-FILLER22          PIC X(01).
           05 OOO-CUO-MOR           PIC 9(03).
           05 OOO-FILLER23          PIC X(01).
           05 OOO-COD-EST           PIC X(03).
           05 OOO-FILLER24          PIC X(01).
           05 OOO-COD-TCRE          PIC X(06).
           05 OOO-FILLER25          PIC X(01).
           05 OOO-COD-PLZO          PIC X(02).
      ****NNV 25.05.99
           05 OOO-FILLER26          PIC X(01).
           05 OOO-COD-EJEC          PIC X(12).


       FD  DEUDOR
           RECORD CONTAINS 102 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.

       01  REG-DEUDOR               PIC X(102).

       FD  RDEUOP
           RECORD CONTAINS 28 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.

       01  REG-RDEUOP               PIC X(28).

       FD  DIRECC
           RECORD CONTAINS 274 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.

       01  REG-DIRECC               PIC X(274).

       FD  TELEFO
           RECORD CONTAINS 52 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.

       01  REG-TELEFO               PIC X(52).

310599*FD  SAFTAS.
310599*COPY COLBRTMC.

       WORKING-STORAGE SECTION.
      *========================
       77  WK-SITUACION                 PIC X(03) VALUE SPACES.
       77  WK-PROC-2                    PIC 9(01) VALUE 0.
       77  WS-IND-DEU                   PIC X(03) VALUE SPACES.
       77  WS-RDC-CORR                  PIC 9(03) VALUE        0.
       77  WS-CIC-ICLI                  PIC X(12) VALUE SPACES.
       77  WS-CIC-IOPC                  PIC X(12) VALUE SPACES.
       77  WS-INT-MORA-UF               PIC S9(11)V9(04) VALUE 0.
       77  WS-INT-MORA-PE               PIC S9(11)       VALUE 0.
       77  WS-TOT-CUOTA                 PIC S9(11)V9(04) VALUE 0.
310599*77  WS-TASA-MORA                 PIC S9(03)V9(04) VALUE 0.
      *77  WS-TASA-MORA     COMP-2.
       77  WS-TASA-MORA-PROM            PIC S9(05)V9(10) VALUE 0.
       77  WS-MONTO-TOT-MORA            PIC S9(11)V9(04) VALUE 0.
       77  WS-MONTO-TOT-PE              PIC S9(11)       VALUE 0.
       77  WS-PRIM-CUO-IMPA             PIC  9(03)       VALUE 0.
       77  WS-NUM-CUO-MOR               PIC  9(03)       VALUE 0.
310599 77  WR-CAM-SGV-VCAM              PIC S9(11)V9(04) VALUE +0.
310599 77  WR-MTO-UF                    PIC S9(11)V9(04) VALUE +0.
310599*77  WS-FACTOR-FCALC              PIC S9(11)V9(02) VALUE 0.
310599*77  WS-FACTOR-FVCTO              PIC S9(11)V9(02) VALUE 0.
       77  WK-COD-TBAN                  PIC  X(03) VALUE SPACES.
310599 77  WS-CUO-TAS-PER               PIC S9(11)V9(04) VALUE 0.
310599 77  WS-CUO-TAS-INC               PIC S9(11)V9(04) VALUE 0.

       01  REG-CUOTAS-WORK.
      *** CHAR(16)
           05 CUO-NUM-OPE           PIC X(12).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 CUO-NUM-CUO           PIC 9(03).
           05 FILLER                PIC X(01) VALUE '%'.
      *** MONEY
      **** 05 CUO-MON-ORI           PIC 9(11)V9(04).
           05 FILLER                PIC X(01) VALUE '$'.
           05 CUO-MON-ORI           PIC 9(11).9(04).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(08)
           05 CUO-FEC-VCT           PIC X(08).
           05 FILLER                PIC X(01) VALUE '%'.
      *** MONEY
      **** 05 CUO-INT-MOR           PIC 9(11)V9(04).
           05 FILLER                PIC X(01) VALUE '$'.
           05 CUO-INT-MOR           PIC 9(11).9(04).
           05 FILLER                PIC X(01) VALUE '%'.
      *** MONEY
      **** 05 CUO-MON-TOT           PIC 9(11)V9(04).
           05 FILLER                PIC X(01) VALUE '$'.
           05 CUO-MON-TOT           PIC 9(11).9(04).
      **** PRP 26.03.96
           05 FILLER                PIC X(01) VALUE '%'.
           05 FILLER                PIC X(01) VALUE '%'.
      **** NNV 31.05.99
           05 FILLER                PIC X(01) VALUE '$'.
           05 CUO-TAS-PER           PIC 9(11).9(04).
           05 FILLER                PIC X(01) VALUE '%'.
           05 FILLER                PIC X(01) VALUE '$'.
           05 CUO-TAS-INC           PIC 9(11).9(04).
           05 FILLER                PIC X(01) VALUE '%'.

       01  REG-OPERAC-WORK.
      *** CHAR(25)
           05 OPE-COD-PRO           PIC X(06).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 OPE-COD-SUC           PIC X(03).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(16)
           05 OPE-NUM-OPE           PIC X(12).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 OPE-COD-MON           PIC X(06).
           05 FILLER                PIC X(01) VALUE '%'.
      *** MONEY
      **** 05 OPE-MON-CRE           PIC 9(11)V9(04).
           05 FILLER                PIC X(01) VALUE '$'.
           05 OPE-MON-CRE           PIC 9(11).9(04).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(08)
           05 OPE-FEC-CUR           PIC X(08).
           05 FILLER                PIC X(01) VALUE '%'.
      *** MONEY
      **** 05 OPE-MON-SAL           PIC 9(11)V9(04).
           05 FILLER                PIC X(01) VALUE '$'.
           05 OPE-MON-SAL           PIC 9(11).9(04).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 OPE-NUM-CUO           PIC 9(03).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(08)
           05 OPE-FEC-VCT           PIC X(08).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 OPE-NUM-REN           PIC 9(03).
           05 FILLER                PIC X(01) VALUE '%'.
      *** FLOAT
      **** 05 OPE-TAS-PAC           PIC S9(03)V9(4).
           05 OPE-TAS-PAC           PIC  9(03).9(4).
           05 FILLER                PIC X(01) VALUE '%'.
      *** FLOAT
      **** 05 OPE-TAS-MOR           PIC S9(03)V9(4).
           05 OPE-TAS-MOR           PIC  9(03).9(4).
           05 FILLER                PIC X(01) VALUE '%'.
      *** MONEY
      **** 05 OPE-MON-MOR           PIC 9(11)V9(4).
           05 FILLER                PIC X(01) VALUE '$'.
           05 OPE-MON-MOR           PIC 9(11).9(4).
           05 FILLER                PIC X(01) VALUE '%'.
      *** MONEY
      **** 05 OPE-CUP-NAC           PIC 9(11)V9(4).
           05 FILLER                PIC X(01) VALUE '$'.
           05 OPE-CUP-NAC           PIC 9(11).9(4).
           05 FILLER                PIC X(01) VALUE '%'.
      *** MONEY
      **** 05 OPE-CUP-INT           PIC 9(11)V9(4).
           05 FILLER                PIC X(01) VALUE '$'.
           05 OPE-CUP-INT           PIC 9(11).9(4).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 OPE-PRI-CUO           PIC 9(03).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 OPE-CUO-IMP           PIC 9(03).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 OPE-CUO-MOR           PIC 9(03).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 OPE-COD-EST           PIC X(03).
      **** PRP 10.09.96
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(2)
           05 OPE-COD-TCRE          PIC X(06).
      **** PRP 26.03.96
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(2)
           05 OPE-COD-PLZO          PIC X(02).
      ****NNV 31.05.99
           05 FILLER                PIC X(01) VALUE '%'.
           05 OPE-COD-EJEC          PIC X(12).

       01  REG-DEUDOR-WORK.
      *** CHAR(09)
      ***  05 DEU-NUM-RUT           PIC X(09) JUST RIGHT.
           05 DEU-NUM-RUT           PIC 9(09).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(01)
           05 DEU-DVF-RUT           PIC X(01).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(40)
           05 DEU-NOM-DEU           PIC X(40).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 DEU-IND-BLO           PIC 9(01).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 DEU-MOT-BLO           PIC X(25).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(08)
           05 DEU-FEC-BLO           PIC X(08).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 DEU-COD-ACT           PIC X(09).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(20)
           05 DEU-CAT-DEU           PIC X(02).

       01  REG-RDEUOP-WORK.
      *** CHAR(16)
           05 RDE-NUM-OPE           PIC X(12).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(09)
      ***  05 RDE-NUM-RUT           PIC X(09) JUST RIGHT.
           05 RDE-NUM-RUT           PIC 9(09).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(01)
           05 RDE-DVF-RUT           PIC X(01).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 RDE-COD-REL           PIC X(03).

       01  REG-DIRECC-WORK.
      *** CHAR(09)
      ***  05 DIR-NUM-RUT           PIC X(09) JUST RIGHT.
           05 DIR-NUM-RUT           PIC 9(09).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(01)
           05 DIR-DVF-RUT           PIC X(01).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 DIR-COR-DIR           PIC 9(01).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 DIR-COD-TDI           PIC X(25).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(40)
           05 DIR-NOM-CAL           PIC X(40).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(06)
           05 DIR-NUM-CAL           PIC X(06).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(40)
           05 DIR-NOM-LUG           PIC X(40).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(06)
           05 DIR-NUM-LUG           PIC X(06).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 DIR-IND-CON           PIC 9(01).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(40)
           05 DIR-NOM-CON           PIC X(40).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(40)
           05 DIR-NOM-SEC           PIC X(40).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 DIR-COD-COM           PIC X(25).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 DIR-COD-CIU           PIC X(25).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 DIR-COD-REG           PIC X(02).

       01  REG-TELEFO-WORK.
      *** CHAR(09)
      ***  05 TEL-NUM-RUT           PIC X(09) JUST RIGHT.
           05 TEL-NUM-RUT           PIC 9(09).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(01)
           05 TEL-DVF-RUT           PIC X(01).
           05 FILLER                PIC X(01) VALUE '%'.
      *** INT
           05 TEL-COR-TEL           PIC 9(02).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(25)
           05 TEL-COD-TTE           PIC X(25).
           05 FILLER                PIC X(01) VALUE '%'.
      *** CHAR(11)
           05 TEL-NUM-TEL           PIC X(11).

       01  W-SWITCHES.
           05 WS-EOF-SORT                   PIC 9(01) VALUE 0.
              88 FIN-SORT            VALUE 1.
           05 WS-PROCESO                    PIC 9(01) VALUE 0.
              88 WS-PROCESO-OK       VALUE 0.
              88 WS-PROCESO-ERROR    VALUE 1.
           05 WS-INTERES                    PIC S9(11)V9(4) VALUE 0.
           05 WS-ICG                        PIC X(15) VALUE SPACES.

       01  W-PARAMETROS.
           05 FILLER                        PIC X(20).
           05 WP-FECHA-PRO.
              10 WP-DIA-PRO                 PIC X(02).
              10 WP-MES-PRO                 PIC X(02).
              10 WP-ANO-PRO                 PIC X(04).
310599        10 WP-ANO-PRO-RED REDEFINES WP-ANO-PRO.
310599           15 WP-SIG-PRO-R            PIC X(02).
310599           15 WP-ANO-PRO-R            PIC X(02).
           05 FILLER                        PIC X(50).

       01  W-BANCAS.
           05 FILLER            PIC X(05) VALUE 'OFI: '.
           05 WP-OFI            PIC X(03).
           05 FILLER            PIC X(01).
           05 FILLER            PIC X(12) VALUE 'TIPO BANCA: '.
           05 WP-BANCA-1        PIC X(03).
           05 FILLER            PIC X(01).
           05 WP-BANCA-2        PIC X(03).
           05 FILLER            PIC X(01).
           05 WP-BANCA-3        PIC X(03).
           05 FILLER            PIC X(01).
           05 WP-BANCA-4        PIC X(03).
           05 FILLER            PIC X(01).
           05 WP-BANCA-5        PIC X(03).
           05 FILLER            PIC X(01).
           05 WP-BANCA-6        PIC X(03).
           05 FILLER            PIC X(36).

250599 01  W-SITUACIONES.
           05 FILLER            PIC X(05) VALUE 'SC1: '.
           05 WP-SIT1           PIC X(03).
           05 FILLER            PIC X(01).
           05 FILLER            PIC X(05) VALUE 'SC2: '.
           05 WP-SIT2           PIC X(03).
           05 FILLER            PIC X(01).
           05 FILLER            PIC X(05) VALUE 'SC3: '.
           05 WP-SIT3           PIC X(03).
           05 FILLER            PIC X(54).

       01  W-CONTADORES-Y-ACUMULADORES.
           05 WA-L-RCD                      PIC 9(06) VALUE 0.
           05 WA-L-TAB                      PIC 9(06) VALUE 0.
           05 WA-L-DLC                      PIC 9(06) VALUE 0.
           05 WA-L-RDC                      PIC 9(06) VALUE 0.
           05 WA-L-OPC                      PIC 9(06) VALUE 0.
           05 WA-L-VEN                      PIC 9(06) VALUE 0.
310599     05 WA-L-TXC                      PIC 9(06) VALUE 0.
310599     05 WA-L-CAM                      PIC 9(06) VALUE 0.
           05 WA-L-SOR                      PIC 9(06) VALUE 0.
           05 WA-L-CYA                      PIC 9(06) VALUE 0.
           05 WA-L-DBC                      PIC 9(06) VALUE 0.
           05 WA-L-ICG                      PIC 9(06) VALUE 0.
           05 WA-L-RCO                      PIC 9(06) VALUE 0.
           05 WA-L-OPE                      PIC 9(06) VALUE 0.
           05 WA-G-MOR                      PIC 9(06) VALUE 0.
           05 WA-G-OPE                      PIC 9(06) VALUE 0.
           05 WA-G-DEU                      PIC 9(06) VALUE 0.
           05 WA-G-DIR                      PIC 9(06) VALUE 0.
           05 WA-G-TEL                      PIC 9(06) VALUE 0.
           05 WA-G-RDE                      PIC 9(06) VALUE 0.

       01  W-REGISTROS-DE-TRABAJO.
           05 WR-FS-CUOTAS                 PIC 9(02) VALUE 0.
           05 WR-FS-OPERAC                 PIC 9(02) VALUE 0.
           05 WR-FS-DIRECC                 PIC 9(02) VALUE 0.
           05 WR-FS-TELEFO                 PIC 9(02) VALUE 0.
           05 WR-FS-RDEUOP                 PIC 9(02) VALUE 0.
           05 WR-FS-DEUDOR                 PIC 9(02) VALUE 0.
310599*    05 WR-FS-SAFTAS                 PIC 9(02) VALUE 0.
           05 WR-FECHA-HOY.
              10 WR-HOY-AA                  PIC X(02).
              10 WR-HOY-MM                  PIC X(02).
              10 WR-HOY-DD                  PIC X(02).
           05 WR-FECHA-INI.
              10 WR-ANO-INI                 PIC X(04).
              10 WR-MES-INI                 PIC X(02).
              10 WR-DIA-INI                 PIC X(02).
           05 WR-FECHA-FIN.
              10 WR-ANO-FIN                 PIC X(04).
              10 WR-MES-FIN                 PIC X(02).
              10 WR-DIA-FIN                 PIC X(02).
           05 WR-MENSAJES.
              10 WR-SECCION                 PIC X(15).
              10 WR-PARRAFO                 PIC X(15).
              10 WR-ARCHIVO                 PIC X(10).
              10 WR-OPERACI                 PIC X(10).
              10 WR-FILE-ST                 PIC X(02).
              10 WR-MENSAJE                 PIC X(35).
      ******************************************************************
      *    DEFINICION DE AREAS PARA RUTINA CALENDAR.                   *
      ******************************************************************
       COPY RTNWCALE.
310599 COPY TABWGTXC.
      *---------------------------------------------------------------*
      * VARAIBLES DE RUTINA GENESIS PARA COMPACTAR NOMBRES            *
      *---------------------------------------------------------------*
           COPY GNSWGCPT.
      ******************************************************************
      *      AREAS DE USO PARA DATACOM                                 *
      ******************************************************************
      *
       01  WB-UIB.
           05 FILLER                        PIC X(32) VALUE 'COLPB892'.
      *
       01  WB-REQ-TAB-AREA.
           02 WB-REQ-TAB-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'TAB'.
           02 FILLER                        PIC X(5) VALUE 'TAB00'.
           02 WB-REQ-TAB-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +150.
           02 FILLER                        PIC X(58).
           02 WB-REQ-TAB-KEY-VALUE.
              03 WB-REQ-TAB-KEY-TIP         PIC X(03) VALUE 'COM'.
              03 WB-REQ-TAB-KEY-COD         PIC X(03).
              03 WB-REQ-TAB-KEY-RESTO       PIC X(12) VALUE SPACES.
      *
       01  WB-REQ-CAM-AREA.
           02 WB-REQ-CAM-CMD                PIC X(5) VALUE 'REDKX'.
           02 FILLER                        PIC X(3) VALUE 'CAM'.
           02 FILLER                        PIC X(5) VALUE 'CAM00'.
           02 WB-REQ-CAM-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +150.
           02 FILLER                        PIC X(58).
           02 WB-REQ-CAM-KEY-VALUE.
              03 WB-REQ-CAM-KEY-FE1         PIC 9(08).
              03 WB-REQ-CAM-KEY-FE2         PIC 9(08).
              03 WB-REQ-CAM-KEY-COD1        PIC X(06).
              03 WB-REQ-CAM-KEY-COD2        PIC X(06).

       01  WB-REQ-RDC-AREA.
           02 WB-REQ-RDC-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'RDC'.
           02 FILLER                        PIC X(5) VALUE 'RDC01'.
           02 WB-REQ-RDC-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-RDC-KEY-VALUE.
              03 WB-REQ-RDC-KEY-OPC         PIC X(12).
              03 WB-REQ-RDC-KEY-REL         PIC X(03).

       01  WB-REQ-DLC-AREA.
           02 WB-REQ-DLC-CMD                PIC X(5) VALUE 'REDKG'.
           02 FILLER                        PIC X(3) VALUE 'DLC'.
           02 FILLER                        PIC X(5) VALUE 'DLC01'.
           02 WB-REQ-DLC-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DLC-KEY-VALUE          PIC X(03).

       01  WB-REQ-OPC-AREA.
           02 WB-REQ-OPC-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'OPC'.
           02 FILLER                        PIC X(5) VALUE 'OPC00'.
           02 WB-REQ-OPC-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-OPC-KEY-VALUE          PIC X(12).

       01  WB-REQ-VEN-AREA.
           02 WB-REQ-VEN-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'VEN'.
           02 FILLER                        PIC X(5) VALUE 'VEN00'.
           02 WB-REQ-VEN-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-VEN-KEY-VALUE.
              05 WB-REQ-VEN-KEY-IOPC        PIC X(12).
              05 WB-REQ-VEN-KEY-IVEN        PIC 9(03).

       01  WB-REQ-DBC-AREA.
           02 WB-REQ-DBC-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DBC'.
           02 FILLER                        PIC X(5) VALUE 'DBC00'.
           02 WB-REQ-DBC-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DBC-KEY-VALUE          PIC X(12).

       01  WB-REQ-RCD-AREA.
           02 WB-REQ-RCD-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'RCD'.
           02 FILLER                        PIC X(5) VALUE 'RCD00'.
           02 WB-REQ-RCD-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-RCD-KEY-VALUE.
              03 WB-REQ-RCD-KEY-CLI         PIC X(12).
              03 WB-REQ-RCD-KEY-DIR         PIC X(02).
      *
       01  WB-REQ-ICG-AREA.
           02 WB-REQ-ICG-CMD                PIC X(5) VALUE SPACES.
           02 FILLER                        PIC X(3) VALUE 'ICG'.
           02 FILLER                        PIC X(5) VALUE 'ICG00'.
           02 WB-REQ-ICG-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +160.
           02 FILLER                        PIC X(58).
           02 WB-REQ-ICG-KEY-VALUE          PIC X(45).
      *
       01  WB-REQ-DCP-AREA.
           02 WB-REQ-DCP-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DCP'.
           02 FILLER                        PIC X(5) VALUE 'DCP00'.
           02 WB-REQ-DCP-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DCP-KEY-VALUE.
              03 WB-REQ-DCP-KEY-CIC         PIC X(12).

       01  WB-REQ-DCE-AREA.
           02 WB-REQ-DCE-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DCE'.
           02 FILLER                        PIC X(5) VALUE 'DCE00'.
           02 WB-REQ-DCE-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DCE-KEY-VALUE.
              03 WB-REQ-DCE-KEY-CIC         PIC X(12).

      *
       01  REG-CAM.
      *    COPYDD TAB-R-CAM.TAB-E-CAM00(PROD),01,D.
      *                             EQUIVALENTE AL REGISTRO CAM
           02  TAB-E-CAM00.
      *                             REGISTRO DE VALORES DE CAMBIOS
               03  CAM.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CAM-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  CAM-KEY-IREG.
      *                             KEY     FECHA 1 + FECHA 2 + VALOR 1
                       05  CAM-KEY-CAMB.
      *                             FECHA DE CAMBIO
                       06  CAM-FEC-CAMB.
      *                             FECHA 1 + FECHA 2
                       07  CAM-FEC-FCAM
                                        OCCURS 2 TIMES.
                       08  CAM-NUM-SCAM
                                    PICTURE 9(2).
                       08  CAM-NUM-ACAM
                                    PICTURE 9(2).
                       08  CAM-NUM-MCAM
                                    PICTURE 9(2).
                       08  CAM-NUM-DCAM
                                    PICTURE 9(2).
      *                             CODIGO VALOR DE CAMBIO
                       06  CAM-COD-CAMB.
      *                             VALOR 1 + VALOR 2
                       07  CAM-COD-VCAM
                                        OCCURS 2 TIMES.
      *                             TIPO VALOR                   TAB TVA
                       08  CAM-MSC-TVAL
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       08  CAM-COD-CVAL
                                    PICTURE X(3).
      *                             TIPO CAMBIO
                       08  CAM-COD-TCAM
                                    PICTURE X(2).
      *                             TIME STAMP TRANSACCION
                       05  CAM-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CAM-FEC-FTRN.
                       07  CAM-NUM-STRN
                                    PICTURE 9(2).
                       07  CAM-NUM-ATRN
                                    PICTURE 9(2).
                       07  CAM-NUM-MTRN
                                    PICTURE 9(2).
                       07  CAM-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CAM-HRA-HRTR.
                       07  CAM-NUM-HHTR
                                    PICTURE 9(2).
                       07  CAM-NUM-MMTR
                                    PICTURE 9(2).
                       07  CAM-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  CAM-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CAM-MSC-STAT PICTURE X(1).
      *                             INDICADOR VIGENCIA
                   04  CAM-IND-VIGE
                             REDEFINES CAM-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  CAM-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CAM-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CAM-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  CAM-COD-ATRN PICTURE X(12).
      *                             VALOR DE CAMBIO
                   04  CAM-SGV-VCAM PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             DISPONIBLE
                   04  CAM-GLS-DISP PICTURE X(6).
      *    RELACION DEUDOR CREDITO
      *    -----------------------
      *
      *    NOMBRE REGISTRO : RDC
      *    CLAVE(S)        : RDC-KEY-IRDC(UU), RDC-KEY-IDLC(DU)
      *    LARGO           : 075
      *    BLOQUEO         : 1
      *    OBSERVACIONES   :
      *
      *    01) MODIFICACIONES 06/09/88, LJV
      *        - ELIMINACION CLAVE RDC-KEY-IREG
      *        - ESTANDARIZACION A HEADER TIPO LOG
      *        - MODIFICACION LARGO/BLOQUEO REGISTRO (064/1)
      *        - INCORPORACION CAMPO RDC-COD-TRDC
      *
       01  RDC.
      *
      *    FILLER COMPATIBILIDAD VSAM/MVS
           03  RDC-GLS-FLAG                             PIC X(01).
      *
      *    CLAVE PRIMARIA REGISTRO
           03  RDC-KEY-IREG.
      *
      *KEY     IDENTIFICACION RELACION DEUDOR CREDITO
               05  RDC-KEY-IRDC.
      *
      *            COD. INT. COMP. CLIENTE
                   07  RDC-CIC-ICLI.
      *
      *                CENTRO ASIGNACION IDENTIFICACION
                       09  RDC-CAI-ICLI.
                           11  RDC-COD-TCLI             PIC X(01).
                           11  RDC-COD-CCLI             PIC X(03).
      *
      *                IDENT. INTERNA COMPUTACIONAL
                       09  RDC-IIC-ICLI                 PIC X(08).
      *
      *            IDENTIFICACION DOCUMENTO LEGAL
                   07  RDC-KEY-IDLC.
      *
      *                COD. INT. COMP. OPERACION CURSADA
                       09  RDC-CIC-IOPC.
      *
      *                    CENTRO ASIGNACION IDENTIFICACION
                           11  RDC-CAI-IOPC.
                               13  RDC-COD-TOPC         PIC X(01).
                               13  RDC-COD-COPC         PIC X(03).
      *
      *                    IDENT. INTERNA COMPUTACIONAL
                           11  RDC-IIC-IOPC.
                               13  RDC-COD-OOPC.
                                   15  RDC-COD-SOPC     PIC X(02).
                                   15  RDC-IND-SOPC     PIC X(01).
                               13  RDC-GLS-NOPC         PIC X(05).
      *
      *                NUM IDENTIFICACION DOCUMENTO LEGAL
                       09  RDC-NUM-IDLC                 PIC 9(03).
      *
      *ING-01
      *        CODIGO TIPO RELACION                     COL RDC
               05  RDC-COD-TRDC                         PIC X(03).
      *
      *        TIME STAMP TRANSACCION
               05  RDC-STP-ITRN.
      *
      *            FECHA TRANSACCION
                   07  RDC-FEC-FTRN.
                       09  RDC-NUM-STRN                 PIC 9(02).
                       09  RDC-NUM-ATRN                 PIC 9(02).
                       09  RDC-NUM-MTRN                 PIC 9(02).
                       09  RDC-NUM-DTRN                 PIC 9(02).
      *
      *            HORA TRANSACCION
                   07  RDC-HRA-HRTR.
                       09  RDC-NUM-HHTR                 PIC 9(02).
                       09  RDC-NUM-MMTR                 PIC 9(02).
                       09  RDC-NUM-SSTR                 PIC 9(02).
      *
      *REQ INDICADOR TIPO ACCION
           03  RDC-MSC-TACC                             PIC X(01).
      *
      *    INDICADOR STATUS
           03  RDC-MSC-STAT                             PIC X(01).
      *
      *REQ CODIGO ORIGEN TRANSACCION
           03  RDC-COD-OTRN.
      *
      *        INDICADOR TIPO ORIGEN
               05  RDC-MSC-TTRN                         PIC X(01).
      *
      *        CODIGO TIPO ORIGEN
               05  RDC-COD-TTRN                         PIC X(03).
      *
      *REQ AUTOR TRANSACCION
           03  RDC-COD-ATRN                             PIC X(12).
      *
      *PEN DIRECCION ASOCIADA
           03  RDC-NUM-DIRE                             PIC X(02).
      *
      *REQ MONTO LIMITE DEUDA ( PORCENTAJE )
           03  RDC-VAL-LIMD             COMP            PIC 9(03)V9(06).
      *
      *MOD-01  PIC X(11)
      *    GLOSA DISPONIBLE
           03  RDC-GLS-DISP                             PIC X(06).
      *    Documento Legal Credito
      *    -----------------------
      *
      *    Nombre Registro : DLC
      *    Clave(s)        : DLC-KEY-IDLC(UU), DLC-IND-SCTB(DC)
      *    Largo           : 283
      *    Bloqueo         : 4
      *    Observaciones   :
      *
      *    01) Modificaciones 06/09/88, LJV
      *        - Eliminacion Clave DLC-KEY-IREG
      *        - Modificacion Largo/Bloqueo registro (194/2)
      *        - Estandarizacion a Header tipo Log
      *        - Eliminacion campo DLC-MSC-TCVE
      *        - Incorporacion campo DLC-IND-SCTB
      *        - Incorporacion campo DLC-FEC-FMAV
      *    02) Modificaciones 03/10/89, ISP
      *        - Creacion de llave DLC-IND-SCTB duplicada y modificable
      *        - Ingreso campo DLC-NUM-VSCE
      *        - Modificacion disponible
      *    03) Modificacion  15/12/92,  DAD
      *        - Creacion de campo DLC-DMA-FSDE redefiniendo el Disponib
      *    04) Modificacion  30/06/93,  DAD
      *        - Modificado largo y campo DLC-DMA-FSDE por DLC-FEC-FSDE
      *        - Modificado Largo/Bloqueo del registro, de 218/4 a 283/4
      *          aumentada la Glosa Disponible.
      *    05) Modificacion 25/04/95,  JUS
      *        - Creacion campos: DLC-COD-SUSP
      *                           DLC-FEC-FSDM
      *        - Glosa Disponible queda en 11.
      *
       01  DLC.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  DLC-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  DLC-KEY-IREG.
      *
      *        Identificacion Documento Legal                        KEY
               05  DLC-KEY-IDLC.
      *
      *            Cod. Int. Comp. Operacion Credito
                   07  DLC-CIC-IOPC.
      *
      *                Centro Asignacion Identificacion
                       09  DLC-CAI-IOPC.
                           11  DLC-COD-TOPC             PIC X(01).
                           11  DLC-COD-COPC             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  DLC-IIC-IOPC.
                           11  DLC-COD-OOPC.
                               13  DLC-COD-SOPC         PIC X(02).
                               13  DLC-IND-SOPC         PIC X(01).
                           11  DLC-GLS-NOPC             PIC X(05).
      *
      *            Num Identificacion Documento Legal
                   07  DLC-NUM-IDLC                     PIC 9(03).
      *
      *        Time Stamp Transaccion
               05  DLC-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  DLC-FEC-FTRN.
                       09  DLC-NUM-STRN                 PIC 9(02).
                       09  DLC-NUM-ATRN                 PIC 9(02).
                       09  DLC-NUM-MTRN                 PIC 9(02).
                       09  DLC-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  DLC-HRA-HRTR.
                       09  DLC-NUM-HHTR                 PIC 9(02).
                       09  DLC-NUM-MMTR                 PIC 9(02).
                       09  DLC-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion                                     REQ
           03  DLC-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  DLC-MSC-STAT                             PIC X(01).
      *
      *    Codigo Origen Transaccion                                 REQ
           03  DLC-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  DLC-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  DLC-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion                                         REQ
           03  DLC-COD-ATRN                             PIC X(12).
      *
      *    Valor Nominal Documento Legal                             REQ
           03  DLC-VAL-NDLC             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Saldo Documento Legal                               REQ
           03  DLC-VAL-SDLC             COMP-3          PIC 9(11)V9(04).
      *
      *    Codigo Tipo Documento                        TAB DOC      REQ
           03  DLC-COD-TDOC                             PIC X(03).
      *
      *    Codigo Plazo ( Contable )                    TAB PZO      REQ
           03  DLC-COD-PLZO.
               05  DLC-MSC-TPZO                         PIC X(01).
               05  DLC-MSC-CPZO                         PIC X(01).
      *
      *    Tipo Impuestos                               COL TIMP
           03  DLC-MSC-TIMP                             PIC X(01).
      *
      *    Valor Impuestos
           03  DLC-VAL-IMPU             COMP-3          PIC 9(11)V9(04).
      *
      *    Codigo Notario Credito                       TAB IVB
           03  DLC-COD-NOTC.
               05  DLC-COD-INOT                         PIC X(03).
               05  DLC-COD-CNOT                         PIC X(03).
               05  DLC-COD-SNOT                         PIC X(03).
      *
      *    Valor Gastos Notario
           03  DLC-VAL-GNOT             COMP-3          PIC 9(11)V9(04).
      *
      *    Situacion Cobranza                           COL SCBZ
           03  DLC-IND-SCBZ                             PIC X(05).
      *
      *    Situacion Cartera                            COL SCRT     REQ
           03  DLC-IND-SCRT                             PIC X(03).
      *
      *    Codigo Ubicacion Fisica                      TAB IVB
           03  DLC-COD-UBFD.
               05  DLC-COD-IUBF                         PIC X(03).
               05  DLC-COD-CUBF                         PIC X(03).
               05  DLC-COD-SUBF                         PIC X(03).
      *
      *    Codigo Plaza                                 TAB PZA      REQ
           03  DLC-COD-PLZA                             PIC X(04).
      *
      *    Manejo Intereses Periodos Largos             COL MIPL     REQ
           03  DLC-MSC-MIPL                             PIC X(01).
      *
      *    Tipo Calculo Vencimientos                    COL TCVE
      *    03  DLC-MSC-TCVE.
      *
      *        Base Calculo Credito                     COL BCCR
      *        05  DLC-MSC-BCCR                         PIC X(01).
      *
      *        Valores Informados Credito               COL VICR
      *        05  DLC-MSC-VICR                         PIC X(01).
      *
      *    Clasificacion Riesgo                         DEU RIES     REQ
           03  DLC-IND-RIES                             PIC X(02).
      *
      *    Valor Reajustes Devengados Documento Legal                PEN
           03  DLC-VAL-READ             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Intereses Devengados Documento Legal                PEN
           03  DLC-VAL-INTD             COMP-3          PIC 9(11)V9(04).
      *
      *    Fecha Devengo ( Ultimo Pago Total Intereses )             REQ
           03  DLC-FEC-FDEV.
               05  DLC-NUM-SDEV                         PIC 9(02).
               05  DLC-NUM-ADEV                         PIC 9(02).
               05  DLC-NUM-MDEV                         PIC 9(02).
               05  DLC-NUM-DDEV                         PIC 9(02).
      *
      *    Saldo Intereses
           03  DLC-VAL-SINT             COMP-3          PIC 9(11)V9(04).
      *
      *    Saldo Capital por Amortizar
           03  DLC-VAL-SCPA             COMP-3          PIC 9(11)V9(04).
      *
      *    Fecha Amortizacion
           03  DLC-FEC-FAMT.
               05  DLC-NUM-SAMT                         PIC 9(02).
               05  DLC-NUM-AAMT                         PIC 9(02).
               05  DLC-NUM-MAMT                         PIC 9(02).
               05  DLC-NUM-DAMT                         PIC 9(02).
      *
      *    Identificacion Documento Legal Original
           03  DLC-KEY-IDLO.
      *
      *        Cod. Int. Comp. Operacion Credito Original
               05  DLC-CIC-IOCO.
      *
      *            Centro Asignacion Identificacion
                   07  DLC-CAI-IOCO.
                       09  DLC-COD-TOCO                 PIC X(01).
                       09  DLC-COD-COCO                 PIC X(03).
      *
      *            Ident. Interna Computacional
                   07  DLC-IIC-IOCO.
                       09  DLC-COD-OOCO.
                           11  DLC-COD-SOCO             PIC X(02).
                           11  DLC-IND-SOCO             PIC X(01).
                       09  DLC-GLS-NOCO                 PIC X(05).
      *
      *        Num Ident Documento Legal Original
               05  DLC-NUM-IDLO                         PIC 9(03).
      *
      *    Monto Intereses Pendientes
           03  DLC-VAL-IPEN             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Docto en Pesos (Cuadre Contabilidad)                REQ
           03  DLC-VAL-DPES             COMP-3          PIC 9(11)V9(04).
      *
      *    Indicador Situacion Contable                 COL SCTB
           03  DLC-IND-SCTB                             PIC X(03).
      *
      *    Fecha Maximo Vencimiento
           03  DLC-FEC-FMAV.
               05  DLC-NUM-SMAV                         PIC 9(02).
               05  DLC-NUM-AMAV                         PIC 9(02).
               05  DLC-NUM-MMAV                         PIC 9(02).
               05  DLC-NUM-DMAV                         PIC 9(02).
      *ING-02
      *    Cantidad de venciminetos en situacion contable especial
      *    ( NOT = SPACES )
      *    Cero ==> todos los vencimientos estan en la misma
      *             situacion contable
      *    Distinto de cero ==> Existen vencimientos en distintas
      *                         situaciones contables
      *
           03  DLC-NUM-VSCE                             PIC 9(03).
      *
      *MOD-04
      *MOD-03 ( DLC-DMA-FSDE )
      *    Fecha Suspension Devengo (Por Clasificacion de Riesgo)
           03  DLC-FEC-FSDE.
               05  DLC-NUM-SSDE                         PIC 9(02).
               05  DLC-NUM-ASDE                         PIC 9(02).
               05  DLC-NUM-MSDE                         PIC 9(02).
               05  DLC-NUM-DSDE                         PIC 9(02).
      *
      *MOD-04
           03  DLC-VAL-PIMP                             PIC 9(11).
      *MOD-05 INI
      *    Causal de Suspension de Devengo.
           03  DLC-COD-SUSP                             PIC X(01).
      *
      *    Fecha Suspension Devengo por Mora
           03  DLC-FEC-FSDM.
               05  DLC-NUM-SSDM                         PIC 9(02).
               05  DLC-NUM-ASDM                         PIC 9(02).
               05  DLC-NUM-MSDM                         PIC 9(02).
               05  DLC-NUM-DSDM                         PIC 9(02).
      *
      *    Glosa Disponible baja de (52 - 9) = 43
           03  DLC-GLS-DISP                             PIC X(43).
      *MOD-05 FIN
      *    Operacion Credito
      *    -----------------
      *
      *    Nombre Registro : OPC
      *    Clave(s)        : OPC-KEY-IOPC(UU), OPC-FEC-FCOL(DC),
      *                      OPC-FEC-FING(DC), OPC-FEC-FINP(DC)
      *    Largo           : 245
      *    Bloqueo         : 2
      *    Observaciones   :
      *
      *    01) Modificaciones 06/09/88, LJV
      *        - Eliminacion Clave OPC-STP-ITRN
      *    02) Modificaciones 11/10/89, ALD
      *        - Cambio nombre campo OPC-NUM-IEVC
      *          por  OPC-NUM-IVEN
      *        - Ingreso campo OPC-IND-VSTR
      *    03) Modificacion  30/06/93,  DAD
      *        - Modificado Largo/Bloqueo del registro, de 218/4 a 245/2
      *          aumentando la Glosa Disponible.
      *    04) Modificacion  06/09/95,  ALD
      *        - Ingreso Campo OPC-VAL-SEGP
      *        - Modificado Glosa Disponible de 28 a 20
      *    05) Modificacion  17/05/1999,ALD
      *        - Ingreso Campo OPC-VAL-SEGC
      *        - Modificado Glosa Disponible de 20 a 12
      *
       01  OPC.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  OPC-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  OPC-KEY-IREG.
      *
      *KEY     Identificacion Operacion Credito
               05  OPC-KEY-IOPC.
      *
      *            Cod. Int. Comp. Operacion Credito
                   07  OPC-CIC-IOPC.
      *
      *                Centro Asignacion Identificacion
                       09  OPC-CAI-IOPC.
                           11  OPC-COD-TOPC             PIC X(01).
                           11  OPC-COD-COPC             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  OPC-IIC-IOPC.
                           11  OPC-COD-OOPC.
                               13  OPC-COD-SOPC         PIC X(02).
                               13  OPC-IND-SOPC         PIC X(01).
                           11  OPC-GLS-NOPC             PIC X(05).
      *
      *        Time Stamp Transaccion
               05  OPC-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  OPC-FEC-FTRN.
                       09  OPC-NUM-STRN                 PIC 9(02).
                       09  OPC-NUM-ATRN                 PIC 9(02).
                       09  OPC-NUM-MTRN                 PIC 9(02).
                       09  OPC-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  OPC-HRA-HRTR.
                       09  OPC-NUM-HHTR                 PIC 9(02).
                       09  OPC-NUM-MMTR                 PIC 9(02).
                       09  OPC-NUM-SSTR                 PIC 9(02).
      *
      *REQ Indicador Tipo Accion
           03  OPC-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  OPC-MSC-STAT                             PIC X(01).
               88  OPC-INGRESADA               VALUE 'I'.
               88  OPC-MODIFICADA              VALUE 'M'.
               88  OPC-APROBADA-CTC            VALUE 'F'.
               88  OPC-LIQUIDADA-CTC           VALUE 'K'.
               88  OPC-LIQUIDADA-LIQ           VALUE 'L'.
               88  OPC-ACTIVADA                VALUE 'A'.
               88  OPC-ESPERA-OPC              VALUE 'C'.
               88  OPC-ESPERA-ENVIO-ABONO-DIF  VALUE 'B'.
               88  OPC-ESPERA-ENVIO-ABONO      VALUE 'G'.
               88  OPC-ESPERA-CONF-ABONO       VALUE 'H'.
               88  OPC-ESPERA-ABONO-X          VALUE 'X'.
               88  OPC-SUSPENDIDA              VALUE 'S'.
               88  OPC-DESACTIVADA             VALUE 'D'.
               88  OPC-ACTUALIZADA             VALUE 'I' 'M'.
               88  OPC-PENDIENTE-CTC           VALUE 'F' 'K'.
               88  OPC-LIQUIDADA               VALUE 'L' 'K'.
               88  OPC-ESPERA-ABONO            VALUE 'B' 'G' 'H' 'X'.
      * RBG INI 10-APR-1996
               88  OPC-APROBADA-APR            VALUE 'J'.
      * RBG FIN 10-APR-1996
      *
      *REQ Codigo Origen Transaccion
           03  OPC-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  OPC-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  OPC-COD-TTRN                         PIC X(03).
      *
      *REQ Autor Transaccion
           03  OPC-COD-ATRN                             PIC X(12).
      *
      *REQ Valor de Cambio Operacion Credito            TAB VLR
           03  OPC-COD-VCOC.
      *
      *        Miscelaneo Tipo Valor                    TAB TVAL
               05  OPC-MSC-TVOC                         PIC X(01).
      *
      *        Codigo Valor
               05  OPC-COD-CVOC                         PIC X(03).
      *
      *        Codigo Tipo Cambio
               05  OPC-COD-TCOC                         PIC X(02).
      *
      *REQ Codigo Clase Operacion Credito               COL AUX
           03  OPC-COD-COOC.
      *
      *        Codigo Tipo Operacion                    COL TOC
               05  OPC-COD-TOOC                         PIC X(03).
      *
      *        Codigo Auxiliar Operacion
               05  OPC-COD-AOOC                         PIC X(03).
      *
      *REQ Codigo Oficina Operacion Credito             TAB OFI
           03  OPC-COD-OFOC                             PIC X(03).
      *
      *    Responsable Mantencion Operacion Credito     TAB USR
           03  OPC-COD-RMOC                             PIC X(12).
      *
      *    Codigo Destino Operacion Credito             COL DES
           03  OPC-COD-CDOC                             PIC X(03).
      *
      *    Cod. Int. Comp. Linea de Credito
           03  OPC-CIC-ILDC.
      *
      *        Centro Asignacion Identificacion
               05  OPC-CAI-ILDC.
                   07  OPC-COD-TLDC                     PIC X(01).
                   07  OPC-COD-CLDC                     PIC X(03).
      *
      *        Ident. Interna Computacional
               05  OPC-IIC-ILDC.
                   07  OPC-COD-OLDC.
                       09  OPC-COD-SLDC                 PIC X(02).
                       09  OPC-IND-SLDC                 PIC X(01).
                   07  OPC-GLS-NLDC                     PIC X(05).
      *
      *REQ Fecha Curse o Colocacion
           03  OPC-FEC-FCOL.
               05  OPC-NUM-SCOL                         PIC 9(02).
               05  OPC-NUM-ACOL                         PIC 9(02).
               05  OPC-NUM-MCOL                         PIC 9(02).
               05  OPC-NUM-DCOL                         PIC 9(02).
      *
      *REQ Fecha Curse Contable
           03  OPC-FEC-FING.
               05  OPC-NUM-SING                         PIC 9(02).
               05  OPC-NUM-AING                         PIC 9(02).
               05  OPC-NUM-MING                         PIC 9(02).
               05  OPC-NUM-DING                         PIC 9(02).
      *
      *REQ Fecha Curse Computacional
           03  OPC-FEC-FINP.
               05  OPC-NUM-SINP                         PIC 9(02).
               05  OPC-NUM-AINP                         PIC 9(02).
               05  OPC-NUM-MINP                         PIC 9(02).
               05  OPC-NUM-DINP                         PIC 9(02).
      *
      *REQ Monto Credito
           03  OPC-VAL-CRED             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Saldo Valor Credito K Capital Insoluto
           03  OPC-VAL-SCRE             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Analisis Feriados (S/N)                      COL AFER
           03  OPC-IND-AFER                             PIC X(01).
      *
      *REQ Modalidad Calculo Valores Finales            COL MCVF
           03  OPC-MSC-MCVF                             PIC X(01).
      *
      *REQ Tipo Calculo Vencimientos                    COL TCVE
           03  OPC-MSC-TCVE.
      *
      *        Base Calculo Credito                     COL BCCR
               05  OPC-MSC-BCCR                         PIC X(01).
      *
      *        Valores Informados Credito               COL VICR
               05  OPC-MSC-VICR                         PIC X(01).
      *
      *    Tipo Renovacion                              COL RENO
           03  OPC-IND-RENO                             PIC X(03).
      *
      *    Condicion Garantia                           COL GARA
           03  OPC-IND-GARA                             PIC X(03).
      *
      *    Valor Comision
           03  OPC-SGV-VCOM             COMP-3          PIC S9(11)V9(4).
      *
      *    Valor Gastos
           03  OPC-VAL-GAST             COMP-3          PIC S9(11)V9(4).
      *
      *    Codigo de Seguro Desgravamen                 TAB IVB
           03  OPC-COD-SEGD.
               05  OPC-COD-ISEG                         PIC X(03).
               05  OPC-COD-CSEG                         PIC X(03).
               05  OPC-COD-SSEG                         PIC X(03).
      *
      *    Valor Seguro
           03  OPC-VAL-SEGD             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Liquido
           03  OPC-SGV-LIQU             COMP-3          PIC S9(11)V9(4).
      *
      *MOD-02
      *REQ Numero Proximo Vencimiento
           03  OPC-NUM-IVEN                             PIC 9(03).
      *
      *REQ Numero Vencimientos Originales
           03  OPC-NUM-VCOR                             PIC 9(03).
      *
      *REQ Numero Vencimientos Vigentes
           03  OPC-NUM-VCVG                             PIC 9(03).
      *
      *    Numero Venctos Cancelados en forma Oportuna
           03  OPC-NUM-VCCO                             PIC 9(03).
      *
      *    Numero Vencimientos Cancelados Morosos
           03  OPC-NUM-VCCM                             PIC 9(03).
      *
      *    Numero de Vencimientos Cancelados Vencidos
           03  OPC-NUM-VCCV                             PIC 9(03).
      *
      *REQ Numero Total Vencimientos Cancelados
           03  OPC-NUM-TVCC                             PIC 9(03).
      *
      *ING-02
      *    Indicador Vencimientos Estructurados
           03  OPC-IND-VSTR                             PIC X(01).
      *
      *    Cod. Int. Comp. Credito Enlace
           03  OPC-CIC-ICEN.
      *
      *        Centro Asignacion Identificacion
               05  OPC-CAI-ICEN.
                   07  OPC-COD-TCEN                     PIC X(01).
                   07  OPC-COD-CCEN                     PIC X(03).
      *
      *        Ident. Interna Computacional
               05  OPC-IIC-ICEN.
                   07  OPC-COD-OCEN.
                       09  OPC-COD-SCEN                 PIC X(02).
                       09  OPC-IND-SCEN                 PIC X(01).
                   07  OPC-GLS-NCEN                     PIC X(05).
      *
      *    Codigo Area Gestion                          COL GES
           03  OPC-COD-AGES                             PIC X(02).
      *
      *    Flag para activar sin contabilizar
           03 OPC-IND-CTBL                              PIC X(01).
      *
      *    Indicador Insistencia
           03 OPC-COD-INSI                              PIC X(01).
      *
      *    Canal de Venta
           03 OPC-COD-CVTA                              PIC X(01).
      *
      *MOD-04
      *    Valor Seguro
           03  OPC-VAL-SEGP             COMP-3          PIC 9(11)V9(04).
      *
      *MOD-05
      *    Valor Seguro Cesantia
           03  OPC-VAL-SEGC             COMP-3          PIC 9(11)V9(04).
      *
      *MOD-05
      *    Glosa Disponible
           03  OPC-GLS-DISP                             PIC X(12).
      *    Vencimientos
      *    ------------
      *
      *    Nombre Registro : VEN
      *    Clave(s)        : VEN-KEY-IVEN(UU), VEN-FEC-FVEN(DC),
      *                      VEN-IND-SCTB(DC)
      *    Largo           : 145
      *    Bloqueo         : 3
      *    Observaciones   :
      *
      *    01) Modificaciones 06/09/88, LJV
      *        - Eliminacion Clave VEN-KEY-IREG
      *        - Estandarizacion a Header tipo Log
      *        - Modificacion Largo/Bloqueo registro (117/1)
      *        - Cambio ubicacion campo IND-SCBZ
      *        - Incorporacion campo VAL-MTSC
      *    02) Modificaciones 23/09/88, PGV
      *    03) Modificacion  30/06/93,  DAD
      *        - Modificado Largo/Bloqueo del registro, de 137/2 a 145/3
      *          aumentando la Glosa Disponible.
      *
       01  VEN.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  VEN-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  VEN-KEY-IREG.
      *
      *KEY     Identificacion Vencimientos
               05  VEN-KEY-IVEN.
      *
      *            Cod. Int. Comp. Operac. Credito
                   07  VEN-CIC-IOPC.
      *
      *                Centro Asignac. Identificacion
                       09  VEN-CAI-IOPC.
                           11  VEN-COD-TOPC             PIC X(01).
                           11  VEN-COD-COPC             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  VEN-IIC-IOPC.
                           11  VEN-COD-OOPC.
                               13  VEN-COD-SOPC         PIC X(02).
                               13  VEN-IND-SOPC         PIC X(01).
                           11  VEN-GLS-NOPC             PIC X(05).
      *
      *            Num. Identificacion Vencimiento
                   07  VEN-NUM-IVEN                     PIC 9(03).
      *
      *        Time Stamp Transaccion
               05  VEN-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  VEN-FEC-FTRN.
                       09  VEN-NUM-STRN                 PIC 9(02).
                       09  VEN-NUM-ATRN                 PIC 9(02).
                       09  VEN-NUM-MTRN                 PIC 9(02).
                       09  VEN-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  VEN-HRA-HRTR.
                       09  VEN-NUM-HHTR                 PIC 9(02).
                       09  VEN-NUM-MMTR                 PIC 9(02).
                       09  VEN-NUM-SSTR                 PIC 9(02).
      *
      *REQ Indicador Tipo Accion
           03  VEN-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  VEN-MSC-STAT                             PIC X(01).
      *
      *REQ Codigo Origen Transaccion
           03  VEN-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  VEN-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  VEN-COD-TTRN                         PIC X(03).
      *
      *REQ Autor Transaccion
           03  VEN-COD-ATRN                             PIC X(12).
      *
      *REQ Fecha Vencimiento
           03  VEN-FEC-FVEN.
               05  VEN-NUM-SVEN                         PIC 9(02).
               05  VEN-NUM-AVEN                         PIC 9(02).
               05  VEN-NUM-MVEN                         PIC 9(02).
               05  VEN-NUM-DVEN                         PIC 9(02).
      *
      *REQ Fecha Inicio Mora Vcmto.
           03  VEN-FEC-FIMV.
               05  VEN-NUM-SIMV                         PIC 9(02).
               05  VEN-NUM-AIMV                         PIC 9(02).
               05  VEN-NUM-MIMV                         PIC 9(02).
               05  VEN-NUM-DIMV                         PIC 9(02).
      *
      *REQ Valor Capital Vencimiento
           03  VEN-VAL-CAPI             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Saldo Valor Capital Vcmto.
           03  VEN-VAL-SCAP             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Int Devengados no incluidos
      *    en Valor Final Vcto
           03  VEN-VAL-IDNI             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Valor Final Vencimiento
           03  VEN-VAL-FINA             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Saldo Valor Final Vcmto.
           03  VEN-VAL-SFIN             COMP-3          PIC 9(11)V9(04).
      *
      *    Situacion Contable                           COL SCTB
           03  VEN-IND-SCTB                             PIC X(03).
      *
      *REQ Num. Identificacion Vcmto.
           03  VEN-NUM-IVCT                             PIC 9(03).
      *
      *    Num. Identif. Estructura Vcmto.
           03  VEN-NUM-IEVC                             PIC 9(03).
      *
      *REQ Num Identif Documento Asociado
           03  VEN-NUM-IDLC                             PIC 9(03).
      *
      *    Indicador Cargo Automatico                   GNS VIGE
           03  VEN-IND-CAUT                             PIC X(01).
      *
      *    Situacion Cobranza                           COL SCBZ
           03  VEN-IND-SCBZ                             PIC X(05).
      *
      *ING-01
      *    Monto Trasp Situac Contable
           03  VEN-VAL-MTSC             COMP-3          PIC 9(11)V9(04).
      *
      *ING-02
      *    Ind Trasp Situac Contable
           03  VEN-IND-MTSC                             PIC X(01).
      *
      *MOD-01  PIC X(08)
      *MOD-02  PIC X(07)
      *    Indicador de calculo
           03  VEN-IND-CALC                             PIC X(01).
      *
      *    Situacion Contable Anterior
           03  VEN-IND-CTBA                             PIC X(03).
      *
      *MOD-03
      *    Glosa Disponible
           03  VEN-GLS-DISP                             PIC X(10).
      *    INTERES COMISIONES GASTOS
      *    -------------------------
      *
      *    NOMBRE REGISTRO : ICG
      *    CLAVE(S)        : ICG-KEY-IICG(UU), ICG-KEY-IVCT(DU)
      *    LARGO           : 117
      *    BLOQUEO         : 1
      *    OBSERVACIONES   :
      *
      *    01) MODIFICACIONES 06/09/88, LJV
      *        - ELIMINACION CLAVE ICG-KEY-IREG
      *        - ESTANDARIZACION A HEADER TIPO LOG
      *        - MODIFICACION LARGO/BLOQUEO REGISTRO (105/2)
      *
       01  ICG.
      *
      *    FILLER COMPATIBILIDAD VSAM/MVS
           03  ICG-GLS-FLAG                             PIC X(01).
      *
      *    CLAVE PRIMARIA REGISTRO
           03  ICG-KEY-IREG.
      *
      *KEY     IDENTIFICACION TASAS
               05  ICG-KEY-IICG.
      *
      *            IDENTIFICACION CANCELACION
                   07  ICG-KEY-ICAN.
      *
      *                COD. INT. COMP. OPERACION CREDITO
                       09  ICG-CIC-IOPC.
      *
      *                    CENTRO ASIGNACION IDENTIFICACION
                           11  ICG-CAI-IOPC.
                               13  ICG-COD-TOPC         PIC X(01).
                               13  ICG-COD-COPC         PIC X(03).
      *
      *                    IDENT. INTERNA COMPUTACIONAL
                           11  ICG-IIC-IOPC.
                               13  ICG-COD-OOPC.
                                   15  ICG-COD-SOPC     PIC X(02).
                                   15  ICG-IND-SOPC     PIC X(01).
                               13  ICG-GLS-NOPC         PIC X(05).
      *
      *                NUM IDENT. CANCELACION
                       09  ICG-NUM-ICAN                 PIC 9(03).
      *
      *            IDENTIFICACION VENCIMIENTO
                   07  ICG-KEY-IVCT.
      *
      *                COD. INT. COMP. OPERACION CREDITO
                       09  ICG-CIC-IOPV.
      *
      *                    CENTRO ASIGNACION IDENTIFICACION
                           11  ICG-CAI-IOPV.
                               13  ICG-COD-TOPV         PIC X(01).
                               13  ICG-COD-COPV         PIC X(03).
      *
      *                    IDENT. INTERNA COMPUTACIONAL
                           11  ICG-IIC-IOPV.
                               13  ICG-COD-OOPV.
                                   15  ICG-COD-SOPV     PIC X(02).
                                   15  ICG-IND-SOPV     PIC X(01).
                               13  ICG-GLS-NOPV         PIC X(05).
      *
      *                NUM IDENT. VENCIMIENTO
                       09  ICG-NUM-IVCT                 PIC 9(03).
      *
      *            TIPO TASA                            COL TTAS
                   07  ICG-IND-TTAS                     PIC X(03).
      *
      *    LA TASA ESTA ASOCIADA A UNA FECHA, LO QUE PERMITE QUE ESTA PU
      *    VARIAR SEGUN PERIODOS IRREGULARES Y ARBITRARIOS DE TIEMPO.
      *
      *    ESTA FECHA PUEDE SER LA DE CURSE DEL CREDITO O UNA FECHA ARBI
      *    RIA, A ELECCION DEL USUARIO.
      *
      *            FECHA INICIO VIGENCIA TASA
                   07  ICG-FEC-FINI.
                       09  ICG-NUM-SINI                 PIC 9(02).
                       09  ICG-NUM-AINI                 PIC 9(02).
                       09  ICG-NUM-MINI                 PIC 9(02).
                       09  ICG-NUM-DINI                 PIC 9(02).
      *
      *        TIME STAMP TRANSACCION
               05  ICG-STP-ITRN.
      *
      *            FECHA TRANSACCION
                   07  ICG-FEC-FTRN.
                       09  ICG-NUM-STRN                 PIC 9(02).
                       09  ICG-NUM-ATRN                 PIC 9(02).
                       09  ICG-NUM-MTRN                 PIC 9(02).
                       09  ICG-NUM-DTRN                 PIC 9(02).
      *
      *            HORA TRANSACCION
                   07  ICG-HRA-HRTR.
                       09  ICG-NUM-HHTR                 PIC 9(02).
                       09  ICG-NUM-MMTR                 PIC 9(02).
                       09  ICG-NUM-SSTR                 PIC 9(02).
      *
      *REQ INDICADOR TIPO ACCION
           03  ICG-MSC-TACC                             PIC X(01).
      *
      *    INDICADOR STATUS
           03  ICG-MSC-STAT                             PIC X(01).
      *
      *REQ CODIGO ORIGEN TRANSACCION
           03  ICG-COD-OTRN.
      *
      *        INDICADOR TIPO ORIGEN
               05  ICG-MSC-TTRN                         PIC X(01).
      *
      *        CODIGO TIPO ORIGEN
               05  ICG-COD-TTRN                         PIC X(03).
      *
      *REQ AUTOR TRANSACCION
           03  ICG-COD-ATRN                             PIC X(12).
      *
      *    DEFINICION FISICA DE LA ESTRUCTURA DE LA TASA
      *REQ CODIGO TIPO TASA INTERES
           03  ICG-COD-TINT.
      *
      *        CODIGO TIPO TASA
               05  ICG-COD-TIPT.
      *
      *            BASE CALCULO TASA INTERES            COL BCTI
                   07  ICG-MSC-BCTI                     PIC X(01).
      *
      *            PERIODO BASE TASA INTERES            COL PBTI
                   07  ICG-MSC-PBTI                     PIC X(01).
      *
      *            MODALIDAD CALCULO TASA INTERES
                   07  ICG-MSC-MCTI.
      *
      *                BAJO PERIODO BASE TASA           COL MCTI
                       09  ICG-MSC-BPBT                 PIC X(01).
      *
      *                SOBRE PERIODO BASE TASA          COL MCTI
                       09  ICG-MSC-SPBT                 PIC X(01).
      *
      *        MISCELANEO TIPO VALOR TASA INTERES       TAB TVAL
      *            ICG-MSC-TVTI = "I"                   PIC X(01).
      *
      *        CODIGO VALOR TASA INTERES
               05  ICG-COD-CVTI                         PIC X(03).
      *
      *        CODIGO TIPO CAMBIO TASA INTERES
      *            ICG-COD-TCTI = ICG-MSC-PBTI          PIC X(02).
      *
      *        TIPO FECHA PERIODO REPACTO               COL TFPR
               05  ICG-MSC-TFPR                         PIC X(01).
      *
      *        NUMERO PERIODO REPACTO
               05  ICG-NUM-PREP                         PIC 9(03).
      *
      *        UNIDAD TIEMPO PERIODO REPACTO            TAB IDMA
               05  ICG-MSC-UTPR                         PIC X(01).
      *
      *    FECHA TERMINO VIGENCIA TASA
           03  ICG-FEC-FTER.
               05  ICG-NUM-STER                         PIC 9(02).
               05  ICG-NUM-ATER                         PIC 9(02).
               05  ICG-NUM-MTER                         PIC 9(02).
               05  ICG-NUM-DTER                         PIC 9(02).
      *
      *REQ VALOR SPREAD
           03  ICG-SGV-SPRD             COMP-3          PIC S9(03)V9(4).
      *
      *REQ VALOR TASA
           03  ICG-SGV-TINT             COMP-3          PIC S9(03)V9(4).
      *
      *    VALOR EN MONTO
           03  ICG-SGV-MNTO             COMP-3          PIC S9(11)V9(4).
      *
      *MOD-01  PIC X(08)
      *    GLOSA DISPONIBLE
           03  ICG-GLS-DISP                             PIC X(07).
           COPY SGCBRDBC.
           COPY SGCBRDCE.
           COPY SGCBRDCP.
           COPY SGCBRRCD.
           COPY TABBRCOM.
      *
       01  WB-ELEM-LIS                      PIC X(11).
           EJECT
       PROCEDURE DIVISION.
      *===================
           ENTRY 'DBMSCBL'.
           EJECT

       A-CONTROL SECTION.
      *=================
       AA-INICIALIZACION.
           PERFORM B-INICIALIZAR.
       AB-PROCESAMIENTO.
           IF WS-PROCESO-OK
              PERFORM C-PROCESAR
           END-IF.
       AC-TERMINACION.
           PERFORM D-TERMINAR.
       AZ-FIN-DE-PROCESO.
           GOBACK.
           EJECT

       B-INICIALIZAR SECTION.
      *======================
           PERFORM BB-ABRIR-ARCHIVOS.
           PERFORM BC-VALIDA-PARAME
           GO BZ-FIN-DE-SECCION.

       BB-ABRIR-ARCHIVOS.
      *------------------
           ACCEPT WR-FECHA-HOY FROM DATE.
           OPEN OUTPUT CUOTAS
                       OPERAC
                       DEUDOR
                       RDEUOP
                       DIRECC
                       TELEFO.

           IF (WR-FS-CUOTAS NOT = 0)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'CUOTAS'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-CUOTAS           TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

           IF (WR-FS-OPERAC NOT = 0)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'OPERAC'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-OPERAC           TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

           IF (WR-FS-DEUDOR NOT = 0)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'DEUDOR'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-DEUDOR           TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

           IF (WR-FS-RDEUOP NOT = 0)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'RDEUOP'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-RDEUOP           TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

           IF (WR-FS-DIRECC NOT = 0)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'DIRECC'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-DIRECC           TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

           IF (WR-FS-TELEFO NOT = 0)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'TELEFO'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-TELEFO           TO WR-FILE-ST
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       BC-VALIDA-PARAME.
      *-----------------
           ACCEPT W-PARAMETROS
           ACCEPT W-BANCAS.
250599     ACCEPT W-SITUACIONES.

       BD-DISPLAY-ERROR.
      *-----------------
           SET WS-PROCESO-ERROR             TO TRUE.
           DISPLAY ' '
           DISPLAY 'ERROR EN SECCION   : ' WR-SECCION
           DISPLAY '   PARRAFO         : ' WR-PARRAFO
           DISPLAY '   ARCHIVO         : ' WR-ARCHIVO
           DISPLAY '   OPERACION       : ' WR-OPERACI
           DISPLAY '   FILE STATUS     : ' WR-FILE-ST
           DISPLAY '   MENSAJE DE ERROR: ' WR-MENSAJE.

       BZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT

       C-PROCESAR SECTION.
      *===================
       CA-PROCESO-GRAL.
      *----------------
           SORT FSORT ON ASCENDING KEY SD-IND-DEU
                                       SD-CIC-ICLI
                                       SD-CIC-IOPC
                                       SD-NUM-IVEN
           INPUT PROCEDURE  IS CA-CARGAR-FSORT
           OUTPUT PROCEDURE IS CA-GENERAR-ARCHIVOS.

       CA-CARGAR-FSORT SECTION.
      *------------------------
           MOVE WP-SIT1                     TO WK-SITUACION
           MOVE 'REDKG'                     TO WB-REQ-DLC-CMD
           MOVE WK-SITUACION                TO WB-REQ-DLC-KEY-VALUE
           PERFORM CB-LEER-DLC.
           MOVE 'REDNX'                     TO WB-REQ-DLC-CMD
           PERFORM CC-RECORRE-DLC
              UNTIL (DLC-IND-SCTB NOT = WK-SITUACION OR
                     WB-REQ-DLC-RC  NOT = '  ' OR WS-PROCESO-ERROR).
           IF WP-SIT2 NOT = SPACES
              MOVE WP-SIT2                     TO WK-SITUACION
              MOVE 'REDKG'                     TO WB-REQ-DLC-CMD
              MOVE WK-SITUACION                TO WB-REQ-DLC-KEY-VALUE
              PERFORM CB-LEER-DLC
              MOVE 'REDNX'                     TO WB-REQ-DLC-CMD
              PERFORM CC-RECORRE-DLC
                 UNTIL (DLC-IND-SCTB NOT = WK-SITUACION OR
                       WB-REQ-DLC-RC  NOT = '  ' OR WS-PROCESO-ERROR).
           IF WP-SIT3 NOT = SPACES
              MOVE WP-SIT3                     TO WK-SITUACION
              MOVE 'REDKG'                     TO WB-REQ-DLC-CMD
              MOVE WK-SITUACION                TO WB-REQ-DLC-KEY-VALUE
              PERFORM CB-LEER-DLC
              MOVE 'REDNX'                     TO WB-REQ-DLC-CMD
              PERFORM CC-RECORRE-DLC
                 UNTIL (DLC-IND-SCTB NOT = WK-SITUACION OR
                       WB-REQ-DLC-RC  NOT = '  ' OR WS-PROCESO-ERROR).


       CA-GENERAR-ARCHIVOS SECTION.
      *----------------------------
           PERFORM CA-LEER-FSORT
           MOVE SD-CIC-IOPC    TO WS-CIC-IOPC
           MOVE SD-CIC-ICLI    TO WS-CIC-ICLI
           MOVE 'DIR'          TO WS-IND-DEU
           PERFORM CA-PROCESO-ARCHIVOS UNTIL FIN-SORT OR
                                             SD-IND-DEU NOT = 'DIR'
           IF NOT FIN-SORT
              MOVE SD-CIC-IOPC    TO WS-CIC-IOPC
              MOVE SD-CIC-ICLI    TO WS-CIC-ICLI
              MOVE 'IND'          TO WS-IND-DEU
              PERFORM CA-PROCESO-INDIRECTO UNTIL FIN-SORT
           END-IF.

       CA-PARRAFOS SECTION.
      *-------------------
       CC-RECORRE-DLC.
      *---------------
310599*    IF (DLC-IND-SCT NOT = 'MUL' AND DLC-COD-TOPC = 'D')
310599*    IF DLC-COD-TOPC = 'D' AND DLC-MSC-STAT = 'A' AND
310599     IF DLC-COD-TOPC = 'D' AND
              DLC-VAL-SDLC > 0
              PERFORM CH-LEER-VEN
              IF (VEN-VAL-SFIN > 0)
                  MOVE VEN-CIC-IOPC            TO SD-CIC-IOPC
                  PERFORM CF-LEER-OPC
                  IF (WB-REQ-OPC-RC = SPACES AND OPC-MSC-STAT = 'A')
                      IF OPC-COD-OFOC = WP-OFI OR
                         WP-OFI = '*  '
                         PERFORM CG-GRABAR-FSORT
                      END-IF
                  END-IF
              END-IF
           END-IF

           IF (WS-PROCESO-OK)
               PERFORM CB-LEER-DLC
           END-IF.

       CB-LEER-DLC.
      *------------
           MOVE SPACES                      TO WB-REQ-DLC-RC
           MOVE 'DLC00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DLC-AREA DLC WB-ELEM-LIS
           IF (WB-REQ-DLC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CB-LEER-DLC'           TO WR-PARRAFO
               MOVE 'DLC'                   TO WR-ARCHIVO
               MOVE WB-REQ-DLC-CMD          TO WR-OPERACI
               MOVE WB-REQ-DLC-RC           TO WR-FILE-ST
               MOVE WB-REQ-DLC-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CA-LEER-FSORT.
      *--------------
           RETURN FSORT AT END MOVE 1 TO WS-EOF-SORT.
           IF NOT FIN-SORT
              ADD 1                            TO WA-L-SOR
           END-IF.


310599 CD-LEER-RUTINA-TMC.
310599*------------------*
      *HZF-INI 12-07-2000
310599*    IF SD-DLC-COD-PLZO NOT = 'C1' AND SD-DLC-COD-PLZO NOT = 'C2'
310599*       AND OPC-COD-VCOC = '0999  '
310599     IF OPC-COD-VCOC = '0999  '
      *HZF-FIN 12-07-2000
310599        PERFORM CD-CONVERTIR-A-UF
310599     ELSE
      *HZF-INI 12-07-2000
310599*       MOVE 0                     TO TXC-MNTO
310599        MOVE SD-OPC-VAL-CRED       TO TXC-MNTO
      *HZF-FIN 12-07-2000
310599     END-IF.
310599     MOVE SD-DLC-COD-PLZO          TO TXC-PLZO
310599     MOVE OPC-COD-VCOC             TO TXC-VCOC
310599     MOVE SD-NUM-DVEN              TO TXC-DEC1
310599     MOVE SD-NUM-MVEN              TO TXC-MEC1
310599     MOVE SD-NUM-SVEN              TO TXC-SEC1
310599     MOVE SD-NUM-AVEN              TO TXC-AEC1
310599     MOVE WP-DIA-PRO               TO TXC-DEC2
310599     MOVE WP-MES-PRO               TO TXC-MEC2
310599     MOVE WP-SIG-PRO-R             TO TXC-SEC2
310599     MOVE WP-ANO-PRO-R             TO TXC-AEC2
310599     CALL 'TABPBTXC' USING TXC-CMMA.
310599     IF TXC-CMSG = SPACES
310599        ADD 1 TO WA-L-TXC
310599     ELSE
310599        MOVE 1                        TO TXC-ATXC
310599        MOVE 1                        TO TXC-VTXC
310599        MOVE 'A'                      TO TXC-BASE
310599        DISPLAY '******************************'
310599        DISPLAY '** ERROR AL CALL TABPBTXC **'
310599        DISPLAY ' ESTATUS  : ' TXC-CMSG
310599        DISPLAY ' TXC-PLZO : ' TXC-PLZO
310599        DISPLAY ' TXC-VCOC : ' TXC-VCOC
310599        DISPLAY ' TXC-FEC1 : ' TXC-FEC1
310599        DISPLAY ' TXC-FEC2 : ' TXC-FEC2
310599        DISPLAY 'SE DEJA CAMPO TXC-ATXC = 1 '
310599        DISPLAY '        CAMPO TXC-VTXC = 1 '
310599        DISPLAY '        CAMPO TXC-BASE = A '
310599        DISPLAY 'PARA ARCHIVO CUOTAS : '
310599        DISPLAY 'CUO-NUM-OPE : ' SD-CIC-IOPC
310599        DISPLAY 'CUO-NUM-CUO : ' SD-NUM-IVCT
310599        DISPLAY 'CUO-MON-ORI : ' SD-VAL-SFIN
310599        DISPLAY 'CUO-FEC-VCT : ' SD-FEC-FVEN
310599        DISPLAY '******************************'
310599     END-IF.

310599 CD-CONVERTIR-A-UF.
310599*-----------------*
310599     MOVE OPC-FEC-FCOL  TO WB-REQ-CAM-KEY-FE1
310599     MOVE OPC-FEC-FCOL  TO WB-REQ-CAM-KEY-FE2
310599     MOVE '0998  '      TO WB-REQ-CAM-KEY-COD1
310599     MOVE '0999  '      TO WB-REQ-CAM-KEY-COD2
310599     MOVE 'CAM00'       TO WB-ELEM-LIS
310599     CALL 'DBNTRY' USING WB-UIB WB-REQ-CAM-AREA REG-CAM
310599                         WB-ELEM-LIS
310599     IF WB-REQ-CAM-RC = SPACES
310599        ADD 1 TO WA-L-CAM
310599        MOVE CAM-SGV-VCAM             TO WR-CAM-SGV-VCAM
310599        COMPUTE WR-MTO-UF = SD-OPC-VAL-CRED / WR-CAM-SGV-VCAM
310599        MOVE WR-MTO-UF                TO TXC-MNTO
310599     ELSE
310599        MOVE 1                        TO TXC-MNTO
310599        DISPLAY '******************************'
310599        DISPLAY '** ERROR AL REDKX TABLA CAM **'
310599        DISPLAY ' ESTATUS : ' WB-REQ-CAM-RC
310599        DISPLAY ' CLAVE   : ' WB-REQ-CAM-KEY-VALUE
310599        DISPLAY 'SE LEE RUTINA CON CAMPO TXC-MNTO = 1 '
310599        DISPLAY 'PARA ARCHIVO CUOTAS : '
310599        DISPLAY 'CUO-NUM-OPE : ' SD-CIC-IOPC
310599        DISPLAY 'CUO-NUM-CUO : ' SD-NUM-IVCT
310599        DISPLAY 'CUO-MON-ORI : ' SD-VAL-SFIN
310599        DISPLAY 'CUO-FEC-VCT : ' SD-FEC-FVEN
310599        DISPLAY '******************************'
310599     END-IF.

       CG-GRABAR-FSORT.
      *----------------
           MOVE VEN-CIC-IOPC            TO WB-REQ-RDC-KEY-OPC
           MOVE ZEROES                  TO WB-REQ-RDC-KEY-REL
           PERFORM CH-LEER-RDC
           IF (WB-REQ-RDC-RC NOT = SPACES)
               MOVE 'CA-PARRAFOS'           TO WR-SECCION
               MOVE 'CG-GRABAR-SORT'        TO WR-PARRAFO
               MOVE 'RDC'                  TO WR-ARCHIVO
               MOVE WB-REQ-RDC-CMD          TO WR-OPERACI
               MOVE WB-REQ-RDC-RC           TO WR-FILE-ST
               MOVE WB-REQ-RDC-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
               MOVE ZEROES              TO RDC-CIC-ICLI
           ELSE
             MOVE RDC-CIC-ICLI     TO WB-REQ-DBC-KEY-VALUE
             PERFORM CI-LEER-DBC
             IF (WB-REQ-DBC-RC = '  ')
                PERFORM CG-BUSCAR-BANCA
                IF WK-COD-TBAN = WP-BANCA-1 OR
                   WK-COD-TBAN = WP-BANCA-2 OR
                   WK-COD-TBAN = WP-BANCA-3 OR
                   WK-COD-TBAN = WP-BANCA-4 OR
                   WK-COD-TBAN = WP-BANCA-5 OR
                   WK-COD-TBAN = WP-BANCA-6 OR
                   WP-BANCA-1 = '*  '
                   PERFORM CG-GRABAR-SELEC
                ELSE
                   NEXT SENTENCE
                END-IF
             ELSE
                NEXT SENTENCE
             END-IF
           END-IF.

       CG-BUSCAR-BANCA.
      *---------------
           IF (DBC-IND-TICL = 'P')
               MOVE RDC-CIC-ICLI     TO WB-REQ-DCP-KEY-CIC
               PERFORM CC-LEER-DCP
               IF (WB-REQ-DCP-RC = '  ')
                  MOVE DCP-COD-TBAN   TO WK-COD-TBAN
               ELSE
                  DISPLAY 'NO EXISTE CLIENTE ' RDC-CIC-ICLI
                     ' EN DCP PARA OPERACION ' RDC-CIC-IOPC
                     ' ESTADO: ' WB-REQ-DCP-RC
                  MOVE SPACES         TO WK-COD-TBAN
               END-IF
           ELSE
               MOVE RDC-CIC-ICLI     TO WB-REQ-DCE-KEY-CIC
               PERFORM CC-LEER-DCE
               IF (WB-REQ-DCE-RC = '  ')
                  MOVE DCE-COD-TBAN   TO WK-COD-TBAN
               ELSE
                  DISPLAY 'NO EXISTE CLIENTE ' RDC-CIC-ICLI
                     ' EN DCE PARA OPERACION ' RDC-CIC-IOPC
                     ' ESTADO: ' WB-REQ-DCE-RC
                  MOVE SPACES         TO WK-COD-TBAN
               DISPLAY 'TIPO CLTE : ' DBC-IND-TICL
               END-IF.

       CC-LEER-DCE.
      *------------
           MOVE SPACES                      TO WB-REQ-DCE-RC
           MOVE 'DCE00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DCE-AREA DCE WB-ELEM-LIS
           IF (WB-REQ-DCE-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CC-LEER-DCE'           TO WR-PARRAFO
               MOVE 'DCE'                   TO WR-ARCHIVO
               MOVE WB-REQ-DCE-CMD          TO WR-OPERACI
               MOVE WB-REQ-DCE-RC           TO WR-FILE-ST
               MOVE WB-REQ-DCE-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       CC-LEER-DCP.
      *------------
           MOVE SPACES                      TO WB-REQ-DCP-RC
           MOVE 'DCP00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DCP-AREA DCP WB-ELEM-LIS
           IF (WB-REQ-DCP-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CC-LEER-DCP'           TO WR-PARRAFO
               MOVE 'DCP'                   TO WR-ARCHIVO
               MOVE WB-REQ-DCP-CMD          TO WR-OPERACI
               MOVE WB-REQ-DCP-RC           TO WR-FILE-ST
               MOVE WB-REQ-DCP-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.


       CG-GRABAR-SELEC.
      *---------------
           MOVE RDC-CIC-ICLI            TO SD-CIC-ICLI
           MOVE VEN-CIC-IOPC            TO SD-CIC-IOPC
           MOVE VEN-NUM-IVEN            TO SD-NUM-IVEN
           MOVE VEN-NUM-IVCT            TO SD-NUM-IVCT
           MOVE VEN-VAL-SFIN            TO SD-VAL-SFIN
           MOVE VEN-FEC-FVEN            TO SD-FEC-FVEN
           MOVE 'DIR'                   TO SD-IND-DEU
      *** GRABAR CAMPOS OPC
           MOVE OPC-COD-VCOC TO SD-OPC-COD-VCOC
           MOVE OPC-COD-COOC TO SD-OPC-COD-COOC
           MOVE OPC-COD-OFOC TO SD-OPC-COD-OFOC
           MOVE OPC-CIC-IOPC TO SD-OPC-CIC-IOPC
           MOVE OPC-FEC-FCOL TO SD-OPC-FEC-FCOL
           MOVE OPC-VAL-SCRE TO SD-OPC-VAL-SCRE
           MOVE OPC-VAL-CRED TO SD-OPC-VAL-CRED
           MOVE OPC-NUM-VCOR TO SD-OPC-NUM-VCOR
           MOVE OPC-NUM-TVCC TO SD-OPC-NUM-TVCC
           MOVE OPC-NUM-IVEN TO SD-OPC-NUM-IVEN
           MOVE OPC-NUM-VCVG TO SD-OPC-NUM-VCVG
           MOVE OPC-COD-RMOC TO SD-OPC-COD-RMOC
           MOVE DLC-COD-PLZO TO SD-DLC-COD-PLZO
           MOVE DLC-FEC-FMAV TO SD-DLC-FEC-FMAV
           MOVE DLC-IND-SCTB TO SD-DLC-IND-SCTB

           RELEASE REG-FSORT
           PERFORM CD-GRABAR-DEUDOR-IND.

       CA-PROCESO-ARCHIVOS.
      *------------------------
           PERFORM CI-LEER-DBC-RCD
           PERFORM UNTIL SD-CIC-ICLI NOT = WS-CIC-ICLI
                                      OR FIN-SORT
                                      OR SD-IND-DEU NOT = 'DIR'
             PERFORM CF-MOVER-OPC-DLC
             PERFORM UNTIL SD-CIC-IOPC NOT = WS-CIC-IOPC
                                        OR FIN-SORT
                                        OR SD-IND-DEU NOT = 'DIR'
               PERFORM CD-GENERAR-MOROSO
               PERFORM CA-LEER-FSORT
             END-PERFORM
             PERFORM CD-GRABAR-OPERAC
             PERFORM CD-GRABAR-RDEUOP
             MOVE SD-CIC-IOPC    TO WS-CIC-IOPC
           END-PERFORM
           PERFORM CD-GRABAR-DEUDOR-DIRECC
           MOVE SD-CIC-IOPC    TO WS-CIC-IOPC
           MOVE SD-CIC-ICLI    TO WS-CIC-ICLI.

       CA-PROCESO-INDIRECTO.
      *---------------------
           PERFORM CI-LEER-DBC-RCD
           PERFORM UNTIL SD-CIC-ICLI NOT = WS-CIC-ICLI
                                      OR FIN-SORT
             PERFORM UNTIL SD-CIC-IOPC NOT = WS-CIC-IOPC
                                        OR FIN-SORT
               PERFORM CA-LEER-FSORT
             END-PERFORM
             PERFORM CD-GRABAR-RDEUOP
             MOVE SD-CIC-IOPC    TO WS-CIC-IOPC
           END-PERFORM
           PERFORM CD-GRABAR-DEUDOR-DIRECC
           MOVE SD-CIC-IOPC    TO WS-CIC-IOPC
           MOVE SD-CIC-ICLI    TO WS-CIC-ICLI.

       CD-GENERAR-MOROSO.
      *------------------
           PERFORM CD-GRABAR-CUOTAS
           ADD  1             TO WS-NUM-CUO-MOR
310599*    ADD  WS-TASA-MORA  TO WS-TASA-MORA-PROM
310599     COMPUTE WS-TASA-MORA-PROM = WS-TASA-MORA-PROM + TXC-ATXC
           ADD  WS-TOT-CUOTA  TO WS-MONTO-TOT-MORA.

       CD-GRABAR-DEUDOR-DIRECC.
      *------------------------
           MOVE DBC-NUM-ICLI        TO DEU-NUM-RUT
           MOVE DBC-VRF-ICLI        TO DEU-DVF-RUT
           MOVE DBC-GLS-NOMC        TO DEU-NOM-DEU
           MOVE ZEROES              TO DEU-IND-BLO
           MOVE SPACES              TO DEU-MOT-BLO
           MOVE SPACES              TO DEU-FEC-BLO
           IF DBC-COD-ACTI = SPACES
              MOVE '62459'          TO DBC-COD-ACTI
           END-IF
           MOVE DBC-COD-ACTI        TO DEU-COD-ACT
           MOVE SPACES              TO DEU-CAT-DEU
           PERFORM CL-WRITE-DEUDOR
           MOVE DBC-NUM-ICLI        TO DIR-NUM-RUT
           MOVE DBC-VRF-ICLI        TO DIR-DVF-RUT
           MOVE RCD-NUM-DIRE        TO DIR-COR-DIR
           MOVE RCD-MSC-TDIR        TO DIR-COD-TDI
           MOVE RCD-GLS-DIRE        TO DIR-NOM-CAL
           MOVE SPACES              TO DIR-NUM-CAL
           MOVE SPACES              TO DIR-NOM-LUG
           MOVE SPACES              TO DIR-NUM-LUG
           MOVE ZEROES              TO DIR-IND-CON
           MOVE SPACES              TO DIR-NOM-CON
           MOVE SPACES              TO DIR-NOM-SEC
           MOVE RCD-COD-LUGA        TO DIR-COD-COM
           MOVE RCD-COD-LUGA        TO DIR-COD-CIU
           MOVE RCD-COD-LUGA        TO WB-REQ-TAB-KEY-COD
           PERFORM CD-BUSCAR-REGION
           PERFORM CL-WRITE-DIRECC.
           MOVE DBC-NUM-ICLI        TO TEL-NUM-RUT
           MOVE DBC-VRF-ICLI        TO TEL-DVF-RUT
           MOVE RCD-NUM-DIRE        TO TEL-COR-TEL
           MOVE RCD-MSC-TDIR        TO TEL-COD-TTE
           MOVE RCD-NUM-FONO        TO TEL-NUM-TEL
           PERFORM CL-WRITE-TELEFO.

       CD-BUSCAR-REGION.
      *----------------
           MOVE SPACES                          TO WB-REQ-TAB-RC
           MOVE 'TAB00'                         TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-TAB-AREA COM WB-ELEM-LIS
           IF (WB-REQ-TAB-RC = '  ')
               MOVE COM-COD-REGI            TO DIR-COD-REG
           ELSE
              DISPLAY '** ERROR ACCESO TABLA TAB-COM'
              DISPLAY ' ESTADO : ' WB-REQ-TAB-RC
              DISPLAY ' CLAVE  : ' WB-REQ-TAB-KEY-VALUE
              DISPLAY '** PROCESO CONTINUA **'
              MOVE '13'                TO DIR-COD-REG
           END-IF.

       CD-GRABAR-RDEUOP.
      *----------------
           MOVE WS-CIC-IOPC               TO RDE-NUM-OPE
           MOVE DBC-NUM-ICLI              TO RDE-NUM-RUT
           MOVE DBC-VRF-ICLI              TO RDE-DVF-RUT
           MOVE WS-IND-DEU                TO RDE-COD-REL

           PERFORM CL-WRITE-RDEUOP.

       CD-GRABAR-CUOTAS.
      *----------------
      ******  CUOTAS
310599     MOVE 0                        TO WS-CUO-TAS-PER
310599     MOVE 0                        TO WS-CUO-TAS-INC
           PERFORM CD-CALCULO-MORA
           MOVE SD-CIC-IOPC                     TO CUO-NUM-OPE
           MOVE SD-NUM-IVCT                     TO CUO-NUM-CUO
           MOVE SD-VAL-SFIN                     TO CUO-MON-ORI
           MOVE SD-FEC-FVEN                     TO CUO-FEC-VCT
           IF OPC-COD-VCOC = '0998  '
              MOVE WS-INT-MORA-UF               TO CUO-INT-MOR
           ELSE
              MOVE WS-INT-MORA-PE               TO CUO-INT-MOR
           END-IF
           MOVE WS-TOT-CUOTA                    TO CUO-MON-TOT
310599     MOVE WS-CUO-TAS-PER                  TO CUO-TAS-PER
310599     MOVE WS-CUO-TAS-INC                  TO CUO-TAS-INC
           PERFORM CL-WRITE-CUOTAS.

       CD-GRABAR-OPERAC.
      ******  OPERAC
           COMPUTE WS-TASA-MORA-PROM ROUNDED =
                   (WS-TASA-MORA-PROM / WS-NUM-CUO-MOR)

      **** COMPUTE WS-MONTO-TOT-MORA ROUNDED =
      ****            (WS-MONTO-TOT-MORA / WS-NUM-CUO-MOR)

           IF OPC-COD-VCOC = '0999  '
              COMPUTE WS-MONTO-TOT-PE ROUNDED = WS-MONTO-TOT-MORA * 1
              MOVE WS-MONTO-TOT-PE     TO WS-MONTO-TOT-MORA
            END-IF

           MOVE WS-MONTO-TOT-MORA               TO OPE-MON-MOR

      **** MOVE OPC-COD-COOC                    TO OPE-COD-PRO
           IF DLC-IND-SCTB = 'VCD'
              MOVE '000001'                     TO OPE-COD-PRO
           ELSE
              MOVE '000002'                     TO OPE-COD-PRO
           END-IF
           MOVE OPC-COD-OFOC                    TO OPE-COD-SUC
           MOVE OPC-CIC-IOPC                    TO OPE-NUM-OPE
           MOVE OPC-COD-VCOC                    TO OPE-COD-MON
           MOVE OPC-FEC-FCOL                    TO OPE-FEC-CUR
           MOVE OPC-VAL-SCRE                    TO OPE-MON-SAL
           MOVE OPC-VAL-CRED                    TO OPE-MON-CRE
           MOVE OPC-NUM-VCOR                    TO OPE-NUM-CUO
310599     MOVE OPC-COD-RMOC                    TO OPE-COD-EJEC
           MOVE DLC-FEC-FMAV                    TO OPE-FEC-VCT
           MOVE ZEROES                          TO OPE-NUM-REN
           PERFORM CJ-LEER-ICG.
           IF ICG-COD-CVTI > SPACES
              MOVE ICG-SGV-SPRD                 TO OPE-TAS-PAC
           ELSE
              MOVE ICG-SGV-TINT                 TO OPE-TAS-PAC
           END-IF.
      **** MOVE WS-TASA-MORA-PROM               TO OPE-TAS-MOR
           COMPUTE OPE-TAS-MOR ROUNDED = WS-TASA-MORA-PROM * 1
           MOVE ZEROES                          TO OPE-CUP-NAC
           MOVE ZEROES                          TO OPE-CUP-INT
      **** COMPUTE WS-PRIM-CUO-IMPA = OPC-NUM-TVCC + 1
           MOVE OPC-NUM-IVEN                    TO WS-PRIM-CUO-IMPA
           MOVE WS-PRIM-CUO-IMPA                TO OPE-PRI-CUO
           MOVE OPC-NUM-VCVG                    TO OPE-CUO-IMP
           MOVE WS-NUM-CUO-MOR                  TO OPE-CUO-MOR
           MOVE 'VIG'                           TO OPE-COD-EST
      **** PRP 26.03.96
           MOVE DLC-COD-PLZO                    TO OPE-COD-PLZO
      **** PRP 10.09.96
           MOVE OPC-COD-COOC                    TO OPE-COD-TCRE
           PERFORM CL-WRITE-OPERAC.
           MOVE ZEROES        TO WS-NUM-CUO-MOR
                                 WS-TASA-MORA-PROM
                                 WS-MONTO-TOT-MORA.


       CD-CALCULO-MORA.
      *----------------
310599     PERFORM CD-LEER-RUTINA-TMC
310599     IF SD-OPC-COD-VCOC = '0998  '
310599        COMPUTE WS-INT-MORA-UF ROUNDED =
310599                (SD-VAL-SFIN * TXC-ATXC) / 100
310599        COMPUTE WS-TOT-CUOTA = SD-VAL-SFIN + WS-INT-MORA-UF
310599     ELSE
310599        COMPUTE WS-INT-MORA-PE ROUNDED =
310599                (SD-VAL-SFIN * TXC-ATXC) / 100
310599        COMPUTE WS-TOT-CUOTA = SD-VAL-SFIN + WS-INT-MORA-PE
310599     END-IF.
310599     MOVE TXC-ATXC           TO WS-CUO-TAS-PER
310599     IF TXC-BASE = 'A'
310599        COMPUTE WS-CUO-TAS-INC ROUNDED = TXC-VTXC / 360
310599     ELSE
310599        COMPUTE WS-CUO-TAS-INC ROUNDED = TXC-VTXC / 30
310599     END-IF.

       CD-GRABAR-DEUDOR-IND.
      *---------------------
           MOVE SPACES                  TO WB-REQ-RDC-RC
           MOVE SD-CIC-IOPC             TO WB-REQ-RDC-KEY-OPC
           MOVE 0                       TO WS-RDC-CORR
           PERFORM CD-LEE-GRABA-IND UNTIL WB-REQ-RDC-RC NOT = SPACES.

       CD-LEE-GRABA-IND.
      *-----------------
           ADD  1                       TO WS-RDC-CORR
           MOVE WS-RDC-CORR             TO WB-REQ-RDC-KEY-REL
           PERFORM CH-LEER-RDC
           IF (WB-REQ-RDC-RC = SPACES)
              MOVE RDC-CIC-ICLI            TO SD-CIC-ICLI
              MOVE VEN-CIC-IOPC            TO SD-CIC-IOPC
              MOVE ZEROES                  TO SD-NUM-IVEN
              MOVE ZEROES                  TO SD-NUM-IVCT
              MOVE ZEROES                  TO SD-VAL-SFIN
              MOVE ZEROES                  TO SD-FEC-FVEN
              MOVE 'IND'                   TO SD-IND-DEU
              RELEASE REG-FSORT
           END-IF.

       CF-MOVER-OPC-DLC.
      *------------
           MOVE SD-OPC-COD-VCOC TO OPC-COD-VCOC
           MOVE SD-OPC-COD-COOC TO OPC-COD-COOC
           MOVE SD-OPC-COD-OFOC TO OPC-COD-OFOC
           MOVE SD-OPC-CIC-IOPC TO OPC-CIC-IOPC
           MOVE SD-OPC-FEC-FCOL TO OPC-FEC-FCOL
           MOVE SD-OPC-VAL-SCRE TO OPC-VAL-SCRE
           MOVE SD-OPC-VAL-CRED TO OPC-VAL-CRED
           MOVE SD-OPC-NUM-VCOR TO OPC-NUM-VCOR
           MOVE SD-OPC-NUM-TVCC TO OPC-NUM-TVCC
           MOVE SD-OPC-NUM-IVEN TO OPC-NUM-IVEN
           MOVE SD-OPC-NUM-VCVG TO OPC-NUM-VCVG.
           MOVE SD-OPC-COD-RMOC TO OPC-COD-RMOC.
           MOVE SD-DLC-COD-PLZO TO DLC-COD-PLZO.
           MOVE SD-DLC-FEC-FMAV TO DLC-FEC-FMAV.
           MOVE SD-DLC-IND-SCTB TO DLC-IND-SCTB.

       CF-LEER-OPC.
      *------------
           MOVE SPACES                      TO WB-REQ-OPC-RC
           MOVE SD-CIC-IOPC                 TO WB-REQ-OPC-KEY-VALUE
           MOVE 'OPC00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-OPC-AREA OPC WB-ELEM-LIS
           IF (WB-REQ-OPC-RC = '  ')
               ADD 1                        TO WA-L-OPC
           ELSE
      *****IF (WB-REQ-OPC-RC NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CF-LEER-OPC'           TO WR-PARRAFO
               MOVE 'OPC'                   TO WR-ARCHIVO
               MOVE WB-REQ-OPC-CMD          TO WR-OPERACI
               MOVE WB-REQ-OPC-RC           TO WR-FILE-ST
               MOVE WB-REQ-OPC-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CH-LEER-RDC.
      *------------
           MOVE SPACES                      TO WB-REQ-RDC-RC
           MOVE 'RDC00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-RDC-AREA RDC WB-ELEM-LIS
           IF (WB-REQ-RDC-RC = '  ')
               ADD 1                        TO WA-L-RDC
           ELSE
           IF (WB-REQ-RDC-RC NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CH-LEER-RDC'           TO WR-PARRAFO
               MOVE 'RDC'                   TO WR-ARCHIVO
               MOVE WB-REQ-RDC-CMD          TO WR-OPERACI
               MOVE WB-REQ-RDC-RC           TO WR-FILE-ST
               MOVE WB-REQ-RDC-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF
           END-IF.

       CH-LEER-VEN.
      *------------
           MOVE SPACES                          TO WB-REQ-VEN-RC
           MOVE DLC-CIC-IOPC                    TO WB-REQ-VEN-KEY-IOPC
           MOVE  001                            TO WB-REQ-VEN-KEY-IVEN
           MOVE 'VEN00'                         TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-VEN-AREA VEN WB-ELEM-LIS
           IF (WB-REQ-VEN-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CH-LEER-VEN'           TO WR-PARRAFO
               MOVE 'VEN'                   TO WR-ARCHIVO
               MOVE WB-REQ-VEN-CMD          TO WR-OPERACI
               MOVE WB-REQ-VEN-RC           TO WR-FILE-ST
               MOVE WB-REQ-VEN-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           ELSE
               IF (WB-REQ-VEN-RC = '  ')
                   ADD 1                        TO WA-L-VEN
               ELSE
                  MOVE ZEROES                   TO VEN-VAL-SFIN
               END-IF
           END-IF.

       CI-LEER-DBC-RCD.
      *----------------
           MOVE WS-CIC-ICLI     TO WB-REQ-DBC-KEY-VALUE
           PERFORM CI-LEER-DBC
           IF (WB-REQ-DBC-RC = SPACES)
               MOVE DBC-GLS-NOMC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO DBC-GLS-NOMC
               MOVE DBC-CIC-ICLI TO WB-REQ-RCD-KEY-CLI
      *******  MOVE DBC-NUM-DCOR TO WB-REQ-RCD-KEY-DIR
               MOVE '01'         TO WB-REQ-RCD-KEY-DIR
               PERFORM CI-LEER-RCD
               IF (WB-REQ-RCD-RC NOT = SPACES)
                   DISPLAY 'STATUS RCD: ' WB-REQ-RCD-RC
                   DISPLAY ' RUT: ' DBC-NUM-ICLI
                   DISPLAY 'DBC-CIC-ICLI: ' DBC-CIC-ICLI
                   DISPLAY 'DBC-NUM-DCOR: ' DBC-NUM-DCOR
                   MOVE SPACES   TO RCD-NUM-FONO
                   MOVE ZEROES   TO RCD-NUM-DIRE
                   MOVE SPACES   TO RCD-MSC-TDIR
                   MOVE '** SIN DIRECCION  **' TO  RCD-GLS-DIRE
                   MOVE ZEROES   TO RCD-COD-LUGA
                END-IF
            ELSE
                DISPLAY '** SIN NOMBRE: ' WS-CIC-ICLI
                MOVE '** SIN NOMBRE **' TO DBC-GLS-NOMC
                MOVE ZEROES       TO DBC-IDC-ICLI
                MOVE SPACES       TO RCD-NUM-FONO.

       CI-LEER-DBC.
      *------------
           MOVE SPACES                      TO WB-REQ-DBC-RC
           MOVE 'DBC00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DBC-AREA DBC WB-ELEM-LIS
           IF (WB-REQ-DBC-RC = '  ')
               ADD 1                        TO WA-L-DBC
           ELSE
           IF (WB-REQ-DBC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CI-LEER-DBC'           TO WR-PARRAFO
               MOVE 'DBC'                   TO WR-ARCHIVO
               MOVE WB-REQ-DBC-CMD          TO WR-OPERACI
               MOVE WB-REQ-DBC-RC           TO WR-FILE-ST
               MOVE WB-REQ-DBC-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF
           END-IF.

       CI-LEER-RCD.
      *------------
           MOVE SPACES                      TO WB-REQ-RCD-RC
           MOVE 'RCD00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-RCD-AREA RCD WB-ELEM-LIS
           IF (WB-REQ-RCD-RC = '  ')
               ADD 1                        TO WA-L-RCD
           ELSE
           IF (WB-REQ-RCD-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CI-LEER-RCD'           TO WR-PARRAFO
               MOVE 'RCD'                   TO WR-ARCHIVO
               MOVE WB-REQ-RCD-CMD          TO WR-OPERACI
               MOVE WB-REQ-RCD-RC           TO WR-FILE-ST
               MOVE WB-REQ-RCD-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF
           END-IF.

       CJ-LEER-ICG.
      *------------
           MOVE WS-CIC-IOPC                 TO ICG-CIC-IOPC.
           MOVE 000                         TO ICG-NUM-ICAN.
           MOVE SPACES                      TO ICG-CIC-IOPV
           MOVE 0                           TO ICG-NUM-IVCT
           MOVE 'INT'                       TO ICG-IND-TTAS
           MOVE SPACES                      TO ICG-FEC-FINI
           MOVE ICG-KEY-IICG                TO WB-REQ-ICG-KEY-VALUE
           MOVE ICG-KEY-ICAN                TO WS-ICG.
           MOVE SPACES                      TO WB-REQ-ICG-RC
           MOVE 'LOCKY'                     TO WB-REQ-ICG-CMD
           MOVE 'ICG00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-ICG-AREA ICG WB-ELEM-LIS
           IF (WB-REQ-ICG-RC = '  ')
               MOVE 'REDLE'                 TO WB-REQ-ICG-CMD
               CALL 'DBNTRY' USING WB-UIB WB-REQ-ICG-AREA
                                   ICG WB-ELEM-LIS
               IF (WB-REQ-ICG-RC NOT = '  ' AND NOT = '14')
                  MOVE 'C-PROCESAR'         TO WR-SECCION
                  MOVE 'CJ-LEER-ICG'        TO WR-PARRAFO
                  MOVE 'ICG'                TO WR-ARCHIVO
                  MOVE WB-REQ-ICG-CMD       TO WR-OPERACI
                  MOVE WB-REQ-ICG-RC        TO WR-FILE-ST
                  MOVE WB-REQ-ICG-KEY-VALUE TO WR-MENSAJE
                  PERFORM BD-DISPLAY-ERROR
               ELSE
               IF (ICG-KEY-ICAN = WS-ICG)
                  ADD 1                     TO WA-L-ICG
               ELSE
                  MOVE 'C-PROCESAR'         TO WR-SECCION
                  MOVE 'CJ-LEER-ICG'        TO WR-PARRAFO
                  MOVE 'ICG'                TO WR-ARCHIVO
                  MOVE WB-REQ-ICG-CMD       TO WR-OPERACI
                  MOVE WB-REQ-ICG-RC        TO WR-FILE-ST
                  MOVE 'NO EXISTE ICG V/S OPC' TO WR-MENSAJE
                  PERFORM BD-DISPLAY-ERROR
               END-IF
               END-IF
           ELSE
           IF (WB-REQ-ICG-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CJ-LEER-ICG'           TO WR-PARRAFO
               MOVE 'ICG'                   TO WR-ARCHIVO
               MOVE WB-REQ-ICG-CMD          TO WR-OPERACI
               MOVE WB-REQ-ICG-RC           TO WR-FILE-ST
               MOVE WB-REQ-ICG-KEY-VALUE    TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF
           END-IF.

       CL-WRITE-CUOTAS.
      *----------------
           WRITE REG-CUOTAS FROM REG-CUOTAS-WORK END-WRITE
           IF (WR-FS-CUOTAS  = 0)
               ADD 1                         TO WA-G-MOR
           ELSE
               MOVE 'C-PROCESAR'             TO WR-SECCION
               MOVE 'CL-WRITE-CUOTAS'        TO WR-PARRAFO
               MOVE 'CUOTAS'                 TO WR-ARCHIVO
               MOVE 'WRITE'                  TO WR-OPERACI
               MOVE WR-FS-CUOTAS             TO WR-FILE-ST
               MOVE SD-CIC-IOPC              TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CL-WRITE-OPERAC.
      *----------------
           WRITE REG-OPERAC FROM REG-OPERAC-WORK END-WRITE
           IF (WR-FS-OPERAC  = 0)
               ADD 1                         TO WA-G-OPE
           ELSE
               MOVE 'C-PROCESAR'             TO WR-SECCION
               MOVE 'CL-WRITE-OPERAC'        TO WR-PARRAFO
               MOVE 'OPERAC'                 TO WR-ARCHIVO
               MOVE 'WRITE'                  TO WR-OPERACI
               MOVE WR-FS-OPERAC             TO WR-FILE-ST
               MOVE SD-CIC-IOPC              TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CL-WRITE-DEUDOR.
      *----------------
           WRITE REG-DEUDOR FROM REG-DEUDOR-WORK END-WRITE
           IF (WR-FS-DEUDOR  = 0)
               ADD 1                         TO WA-G-DEU
           ELSE
               MOVE 'C-PROCESAR'             TO WR-SECCION
               MOVE 'CL-WRITE-DEUDOR'        TO WR-PARRAFO
               MOVE 'DEUDOR'                 TO WR-ARCHIVO
               MOVE 'WRITE'                  TO WR-OPERACI
               MOVE WR-FS-DEUDOR             TO WR-FILE-ST
               MOVE SD-CIC-IOPC              TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CL-WRITE-RDEUOP.
      *----------------
           WRITE REG-RDEUOP FROM REG-RDEUOP-WORK END-WRITE
           IF (WR-FS-RDEUOP  = 0)
               ADD 1                         TO WA-G-RDE
           ELSE
               MOVE 'C-PROCESAR'             TO WR-SECCION
               MOVE 'CL-WRITE-RDEUOP'        TO WR-PARRAFO
               MOVE 'RDEUOP'                 TO WR-ARCHIVO
               MOVE 'WRITE'                  TO WR-OPERACI
               MOVE WR-FS-RDEUOP             TO WR-FILE-ST
               MOVE SD-CIC-IOPC              TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CL-WRITE-DIRECC.
      *----------------
           WRITE REG-DIRECC FROM REG-DIRECC-WORK END-WRITE
           IF (WR-FS-DIRECC  = 0)
               ADD 1                         TO WA-G-DIR
           ELSE
               MOVE 'C-PROCESAR'             TO WR-SECCION
               MOVE 'CL-WRITE-DIRECC'        TO WR-PARRAFO
               MOVE 'DIRECC'                 TO WR-ARCHIVO
               MOVE 'WRITE'                  TO WR-OPERACI
               MOVE WR-FS-DIRECC             TO WR-FILE-ST
               MOVE SD-CIC-IOPC              TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CL-WRITE-TELEFO.
      *----------------
           WRITE REG-TELEFO FROM REG-TELEFO-WORK END-WRITE
           IF (WR-FS-TELEFO  = 0)
               ADD 1                         TO WA-G-TEL
           ELSE
               MOVE 'C-PROCESAR'             TO WR-SECCION
               MOVE 'CL-WRITE-DIRECC'        TO WR-PARRAFO
               MOVE 'TELEFO'                 TO WR-ARCHIVO
               MOVE 'WRITE'                  TO WR-OPERACI
               MOVE WR-FS-TELEFO             TO WR-FILE-ST
               MOVE SD-CIC-IOPC              TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

       CZ-FIN-DE-SECCION.
      *------------------
           EXIT.

           EJECT
       D-TERMINAR SECTION.
      *===================
       DA-ESTADISTICAS.
      *----------------
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'INFORMES'
           DISPLAY '--------'
           DISPLAY ' '
           DISPLAY 'COLPB892 NO EMITE INFORME'
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'ESTADISTICAS DE PROCESO PROGRAMA COLPB892 FECHA '
                    WR-FECHA-HOY
           DISPLAY '------------------------------------------------'
           DISPLAY '        GENERA ARCHIVO CUOTAS CON VEN"S'
           DISPLAY ' '
           DISPLAY 'LEIDOS VEN       : ' WA-L-VEN
           DISPLAY 'SELECCIONADOS    : ' WA-L-SOR
           DISPLAY 'LEIDOS OPC       : ' WA-L-OPC
           DISPLAY 'LEIDOS RDC       : ' WA-L-RDC
           DISPLAY 'LEIDOS DBC       : ' WA-L-DBC
           DISPLAY 'LEIDOS RCD       : ' WA-L-RCD
           DISPLAY 'LEIDOS ICG       : ' WA-L-ICG
           DISPLAY ' '
           DISPLAY 'GRABADOS OPERAC : ' WA-G-OPE
           DISPLAY 'GRABADOS CUOTAS : ' WA-G-MOR
           DISPLAY 'GRABADOS DEUDOR : ' WA-G-DEU
           DISPLAY 'GRABADOS RDEUOP : ' WA-G-RDE
           DISPLAY 'GRABADOS DIRECC : ' WA-G-DIR
           DISPLAY 'GRABADOS TELEFO : ' WA-G-TEL
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'TARJETAS DE PARAMETROS'
           DISPLAY '----------------------'
           DISPLAY ' '
           DISPLAY W-PARAMETROS.
           DISPLAY W-BANCAS.
           DISPLAY W-SITUACIONES.
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'MENSAJES PARA EL EXPLOTADOR'
           DISPLAY '---------------------------'
           DISPLAY ' '
           IF WS-PROCESO-OK
               DISPLAY 'NO HAY MENSAJES PARA EL EXPLOTADOR'
           ELSE
               DISPLAY 'HAY MENSAJES PARA EL EXPLOTADOR'.
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '.

       DC-TERMINO.
      *-----------
           CLOSE CUOTAS
310599*           SAFTAS
                  OPERAC
                  DEUDOR
                  RDEUOP
                  DIRECC
                  TELEFO.
           IF WS-PROCESO-ERROR
              MOVE 100                      TO RETURN-CODE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
              DISPLAY '********                              ********'
              DISPLAY '******** TERMINO ERRONEO DEL PROCESO  ********'
              DISPLAY '********                              ********'
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
           ELSE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*****PROCESO TERMINO EN FORMA NORMAL*****'.

       DZ-FIN-DE-SECCION.
      *------------------
           EXIT.
      *---------------------------------------------------------------*
      * USO DE RUTINA GENESIS PARA COMPACTAR NOMBRES                  *
      *---------------------------------------------------------------*
           COPY GNSBGCPT.
