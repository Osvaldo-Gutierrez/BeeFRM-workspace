       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGGCO.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    09-JUN-1995 11:26:24.
      * Programa que acumula saldos de creditos por cta contable y oficina

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRTAB.
       COPY GNSBRMSG.

       COPY COLBRGAC.
       COPY COLBRGCO.

       COPY GNSWCNUM.
       COPY GNSWVNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.

       01  WSS-VARI.
           03  WSS-NUM-RLEI              PIC 9(03) VALUE 0.
           03  WSS-NUM-RING              PIC 9(03) VALUE 0.
           03  WSS-VAL-SCRE              PIC 9(11)V9(04) VALUE 0.
           03  WSS-GLS-CCSB              PIC X(12).
           03  WSS-COD-OFOC              PIC X(03).

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPGGCO' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

      * Apertura de Archivos

           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-GCO.
           IF NOT FIO-STAT-OKS
             DISPLAY 'ARCHIVO GCO MAL ABIERTO'
             GO TO FIN-LUP-MAIN.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-GAC.
           IF NOT FIO-STAT-OKS
             DISPLAY 'ARCHIVO GAC MAL ABIERTO'
             GO TO FIN-LUP-MAIN.

           MOVE 'COL' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
             DISPLAY 'ARCHIVO TAB MAL ABIERTO'
             GO TO FIN-LUP-MAIN.

           DISPLAY ' '.
           DISPLAY 'ACUMULA SALDOS POR CTA CONTABLE Y OFICINA'.
           DISPLAY '-----------------------------------------'.
      * Proceso de lectura

           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-GAC.
           IF NOT FIO-STAT-OKS
             DISPLAY 'ERROR AL LEER REGISTRO DE GAC'
             GO TO FIN-LUP-MAIN.
           MOVE GAC-GLS-CCSB IN GAC TO WSS-GLS-CCSB IN WSS-VARI.
           MOVE GAC-COD-OFOC IN GAC TO WSS-COD-OFOC IN WSS-VARI.
       LUP-MAIN.
           IF NOT FIO-STAT-OKS
             GO TO FIN-LUP-MAIN.

           ADD 1               TO WSS-NUM-RLEI IN WSS-VARI.

           IF (WSS-GLS-CCSB IN WSS-VARI = GAC-GLS-CCSB IN GAC AND
               WSS-COD-OFOC IN WSS-VARI = GAC-COD-OFOC IN GAC)
             ADD GAC-VAL-SCRE IN GAC TO WSS-VAL-SCRE IN WSS-VARI
           ELSE
           IF (WSS-GLS-CCSB IN WSS-VARI = GAC-GLS-CCSB IN GAC)
             MOVE WSS-GLS-CCSB IN WSS-VARI TO GCO-GLS-CCSB IN GCO
             MOVE WSS-COD-OFOC IN WSS-VARI TO GCO-COD-OFOC IN GCO
             MOVE WSS-VAL-SCRE IN WSS-VARI TO GCO-VAL-SCRE IN GCO
             MOVE GAC-COD-OFOC IN GAC TO WSS-COD-OFOC IN WSS-VARI
             MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI
             ADD GAC-VAL-SCRE IN GAC TO WSS-VAL-SCRE IN WSS-VARI
             MOVE FIO-PUT TO FIO-CMND
             PERFORM COL-FIO-GCO
             IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-RING IN WSS-VARI
             ELSE
               DISPLAY 'ERROR AL INGRESAR REGISTRO EN GCO'
               GO TO FIN-LUP-MAIN
           ELSE
             MOVE WSS-GLS-CCSB IN WSS-VARI TO GCO-GLS-CCSB IN GCO
             MOVE WSS-COD-OFOC IN WSS-VARI TO GCO-COD-OFOC IN GCO
             MOVE WSS-VAL-SCRE IN WSS-VARI TO GCO-VAL-SCRE IN GCO
             MOVE GAC-GLS-CCSB IN GAC TO WSS-GLS-CCSB IN WSS-VARI
             MOVE GAC-COD-OFOC IN GAC TO WSS-COD-OFOC IN WSS-VARI
             MOVE ZEROES TO WSS-VAL-SCRE IN WSS-VARI
             ADD GAC-VAL-SCRE  IN GAC TO WSS-VAL-SCRE IN WSS-VARI
             MOVE FIO-PUT TO FIO-CMND
             PERFORM COL-FIO-GCO
             IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-RING IN WSS-VARI
             ELSE
               DISPLAY 'ERROR AL INGRESAR REGISTRO EN GCO'
               GO TO FIN-LUP-MAIN.
             
       LEE-NXT-MAIN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-GAC.
           GO TO LUP-MAIN.

       FIN-LUP-MAIN.
           MOVE WSS-GLS-CCSB IN WSS-VARI TO GCO-GLS-CCSB IN GCO.
           MOVE WSS-COD-OFOC IN WSS-VARI TO GCO-COD-OFOC IN GCO.
           MOVE WSS-VAL-SCRE IN WSS-VARI TO GCO-VAL-SCRE IN GCO.
           MOVE FIO-PUT TO FIO-CMND
           PERFORM COL-FIO-GCO
           IF FIO-STAT-OKS
             ADD 1 TO WSS-NUM-RING IN WSS-VARI
           ELSE
             DISPLAY 'ERROR AL INGRESAR REGISTRO EN GCO'.

           DISPLAY 'FIN PROCESO ACUMULAR SALDOS'.
           DISPLAY ' '.
           DISPLAY 'ESTADISTICAS DEL PROGRAMA '.
           DISPLAY '------------------------- '.
           DISPLAY ' '.
           DISPLAY 'REGISTROS LEIDOS DE GAC: '
                    WSS-NUM-RLEI IN WSS-VARI.
           DISPLAY 'REGISTROS INGRESADOS A GCO: '
                    WSS-NUM-RING IN WSS-VARI.

      * Cerrar archivos
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-GAC.
           PERFORM COL-FIO-GCO.
           PERFORM GNS-FIO-TAB.

           PERFORM GNS-PRO-END.
       FIN-MAIN.
           EXIT.

       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY COLBFGAC.
       COPY COLBFGCO.

       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.

       COPY GNSBGDTC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGEND.
       COPY GNSBGABT.

