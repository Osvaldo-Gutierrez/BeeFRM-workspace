       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGD3E.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    19-ENE-2000    (ULTIMA MODIFICACION).

      * PROGRAMA GENERADOR INTERFAZ D30 SUPER-BANCOS DE COL ESPECIAL
      *|||||||||||||||||||||||||| ATENCION ||||||||||||||||||||||||||
      *AL GENERAR REPORTE SE DEBE MODIFICAR COLRED30, ASTERISQUEANDO
      *USO DE VARIABLE PGM-HRSR-D30. COPYS USADOS :
      * COPY COLRWD30.
      * COPY COLRTD30.
      * COPY COLRND30.
      * COPY COLROD30.
      * COPY COLRRD30.
      * COPY COLRED30.

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            C01 IS SALTO
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
           SELECT RPTD30         ASSIGN TO        UT-S-RPTD30.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       FD  RPTD30 LABEL RECORDS OMITTED
           RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-D30     PIC X(132).

       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
      *>>>>

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.

      *<<<< WSS
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY COLBRRD3.
       COPY SUPBRD30.
       COPY TABBROFI.
       COPY TABBRCAM.
       COPY GNSWGPES.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       01  WSS-VARI.
           03 WSS-CABE-D30.
              05 WSS-COD-BNCO                          PIC X(03).
              05 WSS-IND-AD30                          PIC X(03).
              05 WSS-FEC-FD30.
                 07 WSS-NUM-DD30                       PIC X(02).
                 07 WSS-NUM-MD30                       PIC X(02).
                 07 WSS-NUM-SD30                       PIC X(02).
                 07 WSS-NUM-AD30                       PIC X(02).
              05 WSS-GLS-DISP                          PIC X(150).
           03 WSS-FEC-FINF.
              05 WSS-NUM-DINF                          PIC 9(02).
              05 WSS-NUM-MINF                          PIC 9(02).
              05 WSS-NUM-SINF                          PIC 9(02).
              05 WSS-NUM-AINF                          PIC 9(02).
           03 WSS-FEC-FIN1.
              05 WSS-NUM-SIN1                          PIC 9(02).
              05 WSS-NUM-AIN1                          PIC 9(02).
              05 WSS-NUM-MIN1                          PIC 9(02).
              05 WSS-NUM-DIN1                          PIC 9(02).
           03 WSS-NUM-RRD3         VALUE 0             PIC 9(07).
           03 WSS-NUM-D30G         VALUE 0             PIC 9(07).
           03 WSS-IND-STAT         VALUE 0             PIC 9(03).
           03 WSS-IND              VALUE 0             PIC 9(02).
           03 WSS-SUB              VALUE 0             PIC 9(02).
           03 WSS-COD-GCAB        VALUE SPACES         PIC X(01).
           03 WSS-MNTO                                 PIC S9(14)V9999.
           03 WSS-PPON                                 PIC S9(14)V9999.
           03 WSS-TEQV                                 PIC S9(03)V99.
           03 WSS-TMIN                                 PIC S9(03)V99.
           03 WSS-TMAX                                 PIC S9(03)V99.
           03 WSS-COD-PESO                             PIC X(06).
           03 WSS-COD-UEFE                             PIC X(06).
           03 WSS-SGV-UEFE                             PIC S9(11)V9999.
           03 WSS-VAL-UF01        VALUE ZEROES         PIC 9(14).
           03 WSS-VAL-UF02        VALUE ZEROES         PIC 9(14).
           03 WSS-VAL-UF03        VALUE ZEROES         PIC 9(14).
           03 WSS-VAL-UF04        VALUE ZEROES         PIC 9(14).
           03 WSS-VAL-UF05        VALUE ZEROES         PIC 9(14).
           03 WSS-VAL-UF06        VALUE ZEROES         PIC 9(14).
           03 WSS-VAL-UF07        VALUE ZEROES         PIC 9(14).
           03 WSS-VAL-UF08        VALUE ZEROES         PIC 9(14).
           03 WSS-VAL-UF09        VALUE ZEROES         PIC 9(14).

       01  WSS-TIP-D30.
           03 WSS-TIPO-D30 OCCURS 16.
              05 WSS-MNTO-D30                       PIC 9(18).

       01  WSS-MAT-D30.
           03 WSS-ELE-D30 OCCURS 16.
              05 WSS-CONT-D30                       PIC 9(06).
      *0 A 25 UF
              05 WSS-TM01-D30                       PIC 9(03)V9(02).
              05 WSS-TX01-D30                       PIC 9(03)V9(02).
              05 WSS-TP01-D30                       PIC 9(03)V9(02).
              05 WSS-MT01-D30                       PIC 9(14).
              05 WSS-MP01-D30                       PIC 9(14).
      *> 25 A 50 UF
              05 WSS-TM02-D30                       PIC 9(03)V9(02).
              05 WSS-TX02-D30                       PIC 9(03)V9(02).
              05 WSS-TP02-D30                       PIC 9(03)V9(02).
              05 WSS-MT02-D30                       PIC 9(14).
              05 WSS-MP02-D30                       PIC 9(14).
      *> 50 A 75 UF
              05 WSS-TM03-D30                       PIC 9(03)V9(02).
              05 WSS-TX03-D30                       PIC 9(03)V9(02).
              05 WSS-TP03-D30                       PIC 9(03)V9(02).
              05 WSS-MT03-D30                       PIC 9(14).
              05 WSS-MP03-D30                       PIC 9(14).
      *> 75 A 100 UF
              05 WSS-TM04-D30                       PIC 9(03)V9(02).
              05 WSS-TX04-D30                       PIC 9(03)V9(02).
              05 WSS-TP04-D30                       PIC 9(03)V9(02).
              05 WSS-MT04-D30                       PIC 9(14).
              05 WSS-MP04-D30                       PIC 9(14).
      *> 100 A 150 UF
              05 WSS-TM05-D30                       PIC 9(03)V9(02).
              05 WSS-TX05-D30                       PIC 9(03)V9(02).
              05 WSS-TP05-D30                       PIC 9(03)V9(02).
              05 WSS-MT05-D30                       PIC 9(14).
              05 WSS-MP05-D30                       PIC 9(14).
      *> 150 A 200 UF
              05 WSS-TM06-D30                       PIC 9(03)V9(02).
              05 WSS-TX06-D30                       PIC 9(03)V9(02).
              05 WSS-TP06-D30                       PIC 9(03)V9(02).
              05 WSS-MT06-D30                       PIC 9(14).
              05 WSS-MP06-D30                       PIC 9(14).
      *> 200 A 500 UF
              05 WSS-TM07-D30                       PIC 9(03)V9(02).
              05 WSS-TX07-D30                       PIC 9(03)V9(02).
              05 WSS-TP07-D30                       PIC 9(03)V9(02).
              05 WSS-MT07-D30                       PIC 9(14).
              05 WSS-MP07-D30                       PIC 9(14).
      *> 500 A 1000 UF
              05 WSS-TM08-D30                       PIC 9(03)V9(02).
              05 WSS-TX08-D30                       PIC 9(03)V9(02).
              05 WSS-TP08-D30                       PIC 9(03)V9(02).
              05 WSS-MT08-D30                       PIC 9(14).
              05 WSS-MP08-D30                       PIC 9(14).
      *> 1000
              05 WSS-TM09-D30                       PIC 9(03)V9(02).
              05 WSS-TX09-D30                       PIC 9(03)V9(02).
              05 WSS-TP09-D30                       PIC 9(03)V9(02).
              05 WSS-MT09-D30                       PIC 9(14).
              05 WSS-MP09-D30                       PIC 9(14).

       COPY COLRWD30.
       COPY COLRTD30.
       COPY COLRND30.
       COPY COLROD30.
       COPY COLRRD30.
       COPY GNSWGRPT.
       COPY GNSWGGRC.

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPGD3E' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

           MOVE 'A' TO WSS-GLS-SRT IN SRT.

      * Captura Fecha de Proceso
           DISPLAY 'INGRESE FECHA DEL INFORME (DDMMSSAA) '
           ACCEPT  WSS-FEC-FINF IN WSS-VARI.
           DISPLAY WSS-FEC-FINF IN WSS-VARI.
      *     DISPLAY 'GRABA REGISTRO CABECERA (S/*) : '.
      *     ACCEPT  WSS-COD-GCAB IN WSS-VARI.
      *     DISPLAY WSS-COD-GCAB IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Informe
           DISPLAY 'FECHA DEL INFORME : ' WSS-FEC-FINF IN WSS-VARI.
           MOVE WSS-FEC-FINF IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-ABT.

           MOVE WSS-NUM-DINF IN WSS-VARI TO WSS-NUM-DIN1 IN WSS-VARI.
           MOVE WSS-NUM-MINF IN WSS-VARI TO WSS-NUM-MIN1 IN WSS-VARI.
           MOVE WSS-NUM-SINF IN WSS-VARI TO WSS-NUM-SIN1 IN WSS-VARI.
           MOVE WSS-NUM-AINF IN WSS-VARI TO WSS-NUM-AIN1 IN WSS-VARI.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * Obtiene el Codigo Valor de Cambio de Pesos mediante el CIC de la
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB IN TAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * Obtiene el Codigo Valor de Cambio de la UF mediante el CIC de la
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB IN TAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.

      * Obtiene Valor de Cambio en Pesos para la UF a Fecha del Informe
           MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA INFORME : '
                        WSS-FEC-FINF IN WSS-VARI      ' PARA LA U.F.'
               PERFORM GNS-PRO-ABT
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'IND. VIGENCIA NO VALIDO A FECHA INFORME : '
                        WSS-FEC-FINF IN WSS-VARI    ' PARA LA U.F.'
               PERFORM GNS-PRO-ABT
           ELSE
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-UEFE IN WSS-VARI.

           MULTIPLY 25 BY WSS-SGV-UEFE IN WSS-VARI GIVING
                        WSS-VAL-UF01 IN WSS-VARI ROUNDED.

           MULTIPLY 50 BY WSS-SGV-UEFE IN WSS-VARI GIVING
                        WSS-VAL-UF02 IN WSS-VARI ROUNDED.

           MULTIPLY 75 BY WSS-SGV-UEFE IN WSS-VARI GIVING
                        WSS-VAL-UF03 IN WSS-VARI ROUNDED.

           MULTIPLY 100 BY WSS-SGV-UEFE IN WSS-VARI GIVING
                        WSS-VAL-UF04 IN WSS-VARI ROUNDED.

           MULTIPLY 150 BY WSS-SGV-UEFE IN WSS-VARI GIVING
                        WSS-VAL-UF05 IN WSS-VARI ROUNDED.

           MULTIPLY 200 BY WSS-SGV-UEFE IN WSS-VARI GIVING
                        WSS-VAL-UF06 IN WSS-VARI ROUNDED.

           MULTIPLY 500 BY WSS-SGV-UEFE IN WSS-VARI GIVING
                        WSS-VAL-UF07 IN WSS-VARI ROUNDED.

           MULTIPLY 1000 BY WSS-SGV-UEFE IN WSS-VARI GIVING
                        WSS-VAL-UF08 IN WSS-VARI ROUNDED.

           OPEN OUTPUT RPTD30.

           MOVE FIO-OUT TO FIO-CMND.
           PERFORM SUP-FIO-D30.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR FIO-OUT D30, FIO-STAT : ' FIO-STAT
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RD3.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR FIO-INP RD3, FIO-STAT : ' FIO-STAT
               PERFORM GNS-PRO-ABT.

      * Primera Lectura de Operacion de Credito por Llave Alternativa
           MOVE FIO-GET-FST    TO FIO-CMND.
           PERFORM COL-FIO-RD3.
           IF NOT FIO-STAT-OKS OR
              RD3-FEC-FPRO IN RD3 NOT = WSS-FEC-FIN1 IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS PARA FECHA DE INFORME : '
                       WSS-FEC-FINF IN WSS-VARI
               GO TO EXT-MAIN.

      * Inicializa Tabla de Totales acumulados para grabar D30
           MOVE ZEROES TO WSS-MAT-D30.
       LUP-MAIN.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.

           IF RD3-FEC-FPRO IN RD3 NOT = WSS-FEC-FIN1 IN WSS-VARI
                GO TO FIN-MAIN.

      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           ADD   1  TO WSS-NUM-RRD3 IN WSS-VARI.
           PERFORM DET-TRA-REG-PROC.
           IF WSS-IND-STAT = 1
               GO TO NXT-MAIN.

           ADD 1                    TO WSS-CONT-D30(WSS-IND).
           MOVE RD3-VAL-CAPI IN RD3              TO WSS-MNTO.
           MOVE RD3-VAL-INTE IN RD3              TO WSS-TEQV.
      *ALD-BCI-INI/14.05.19999
           IF RD3-VAL-TRAM IN RD3 > ZEROES AND
              RD3-VAL-TRAM IN RD3 NOT > WSS-VAL-UF01 IN WSS-VARI
      *ALD-BCI-FIN/14.05.19999

               MOVE WSS-TM01-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMIN
               MOVE WSS-TX01-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMAX
               PERFORM ANL-VEC-D30
               ADD RD3-VAL-CAPI IN RD3 TO
                   WSS-MT01-D30 IN WSS-ELE-D30(WSS-IND)
               ADD WSS-PPON IN WSS-VARI TO
                   WSS-MP01-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMIN TO WSS-TM01-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMAX TO WSS-TX01-D30 IN WSS-ELE-D30(WSS-IND)
               GO TO NXT-MAIN.

      *ALD-BCI-INI/14.05.19999
           IF RD3-VAL-TRAM IN RD3 > WSS-VAL-UF01 AND
              RD3-VAL-TRAM IN RD3 NOT > WSS-VAL-UF02 IN WSS-VARI
      *ALD-BCI-FIN/14.05.19999

               MOVE WSS-TM02-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMIN
               MOVE WSS-TX02-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMAX
               PERFORM ANL-VEC-D30
               ADD RD3-VAL-CAPI IN RD3 TO
                   WSS-MT02-D30 IN WSS-ELE-D30(WSS-IND)
               ADD WSS-PPON IN WSS-VARI TO
                   WSS-MP02-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMIN TO WSS-TM02-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMAX TO WSS-TX02-D30 IN WSS-ELE-D30(WSS-IND)
               GO TO NXT-MAIN.


      *ALD-BCI-INI/14.05.19999
           IF RD3-VAL-TRAM IN RD3 > WSS-VAL-UF02 AND
              RD3-VAL-TRAM IN RD3 NOT > WSS-VAL-UF03 IN WSS-VARI
      *ALD-BCI-FIN/14.05.19999

               MOVE WSS-TM03-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMIN
               MOVE WSS-TX03-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMAX
               PERFORM ANL-VEC-D30
               ADD RD3-VAL-CAPI IN RD3 TO
                   WSS-MT03-D30 IN WSS-ELE-D30(WSS-IND)
               ADD WSS-PPON IN WSS-VARI TO
                   WSS-MP03-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMIN TO WSS-TM03-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMAX TO WSS-TX03-D30 IN WSS-ELE-D30(WSS-IND)
               GO TO NXT-MAIN.

      *ALD-BCI-INI/14.05.19999
           IF RD3-VAL-TRAM IN RD3 > WSS-VAL-UF03 AND
              RD3-VAL-TRAM IN RD3 NOT > WSS-VAL-UF04 IN WSS-VARI
      *ALD-BCI-FIN/14.05.19999

               MOVE WSS-TM04-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMIN
               MOVE WSS-TX04-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMAX
               PERFORM ANL-VEC-D30
               ADD RD3-VAL-CAPI IN RD3 TO
                   WSS-MT04-D30 IN WSS-ELE-D30(WSS-IND)
               ADD WSS-PPON IN WSS-VARI TO
                   WSS-MP04-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMIN TO WSS-TM04-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMAX TO WSS-TX04-D30 IN WSS-ELE-D30(WSS-IND)
               GO TO NXT-MAIN.

      *ALD-BCI-INI/14.05.19999
           IF RD3-VAL-TRAM IN RD3 > WSS-VAL-UF04 AND
              RD3-VAL-TRAM IN RD3 NOT > WSS-VAL-UF05 IN WSS-VARI
      *ALD-BCI-FIN/14.05.19999

               MOVE WSS-TM05-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMIN
               MOVE WSS-TX05-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMAX
               PERFORM ANL-VEC-D30
               ADD RD3-VAL-CAPI IN RD3 TO
                   WSS-MT05-D30 IN WSS-ELE-D30(WSS-IND)
               ADD WSS-PPON IN WSS-VARI TO
                   WSS-MP05-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMIN TO WSS-TM05-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMAX TO WSS-TX05-D30 IN WSS-ELE-D30(WSS-IND)
               GO TO NXT-MAIN.

      *ALD-BCI-INI/14.05.19999
           IF RD3-VAL-TRAM IN RD3 > WSS-VAL-UF05 AND
              RD3-VAL-TRAM IN RD3 NOT > WSS-VAL-UF06 IN WSS-VARI
      *ALD-BCI-FIN/14.05.19999

               MOVE WSS-TM06-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMIN
               MOVE WSS-TX06-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMAX
               PERFORM ANL-VEC-D30
               ADD RD3-VAL-CAPI IN RD3 TO
                   WSS-MT06-D30 IN WSS-ELE-D30(WSS-IND)
               ADD WSS-PPON IN WSS-VARI TO
                   WSS-MP06-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMIN TO WSS-TM06-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMAX TO WSS-TX06-D30 IN WSS-ELE-D30(WSS-IND)
               GO TO NXT-MAIN.

      *ALD-BCI-INI/14.05.19999
           IF RD3-VAL-TRAM IN RD3 > WSS-VAL-UF06 AND
              RD3-VAL-TRAM IN RD3 NOT > WSS-VAL-UF07 IN WSS-VARI
      *ALD-BCI-FIN/14.05.19999

               MOVE WSS-TM07-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMIN
               MOVE WSS-TX07-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMAX
               PERFORM ANL-VEC-D30
               ADD RD3-VAL-CAPI IN RD3 TO
                   WSS-MT07-D30 IN WSS-ELE-D30(WSS-IND)
               ADD WSS-PPON IN WSS-VARI TO
                   WSS-MP07-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMIN TO WSS-TM07-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMAX TO WSS-TX07-D30 IN WSS-ELE-D30(WSS-IND)
               GO TO NXT-MAIN.

      *ALD-BCI-INI/14.05.19999
           IF RD3-VAL-TRAM IN RD3 > WSS-VAL-UF07 AND
              RD3-VAL-TRAM IN RD3 NOT > WSS-VAL-UF08 IN WSS-VARI
      *ALD-BCI-FIN/14.05.19999

               MOVE WSS-TM08-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMIN
               MOVE WSS-TX08-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMAX
               PERFORM ANL-VEC-D30
               ADD RD3-VAL-CAPI IN RD3 TO
                   WSS-MT08-D30 IN WSS-ELE-D30(WSS-IND)
               ADD WSS-PPON IN WSS-VARI TO
                   WSS-MP08-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMIN TO WSS-TM08-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMAX TO WSS-TX08-D30 IN WSS-ELE-D30(WSS-IND)
               GO TO NXT-MAIN.

      *ALD-BCI-INI/14.05.19999
           IF RD3-VAL-TRAM IN RD3 > WSS-VAL-UF08
      *ALD-BCI-FIN/14.05.19999

               MOVE WSS-TM09-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMIN
               MOVE WSS-TX09-D30 IN WSS-ELE-D30(WSS-IND) TO WSS-TMAX
               PERFORM ANL-VEC-D30
               ADD RD3-VAL-CAPI IN RD3 TO
                   WSS-MT09-D30 IN WSS-ELE-D30(WSS-IND)
               ADD WSS-PPON IN WSS-VARI TO
                   WSS-MP09-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMIN TO WSS-TM09-D30 IN WSS-ELE-D30(WSS-IND)
               MOVE WSS-TMAX TO WSS-TX09-D30 IN WSS-ELE-D30(WSS-IND)
               GO TO NXT-MAIN.

       NXT-MAIN.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RD3.
           GO TO LUP-MAIN.
       FIN-MAIN.

      * Calculo Final por tramo del Promedio Ponderado
           PERFORM CAL-TAS-PPON-D30 VARYING WSS-SUB FROM 1 BY 1 UNTIL
                                        WSS-SUB > 16.

      *GRABA REGISTRO CABECERA
           PERFORM GEN-REG-CAB-D30.

      * Graba registro de interfaz D30 con informacion generada
           PERFORM GEN-REG-D30 VARYING WSS-SUB FROM 1 BY 1 UNTIL
                                       WSS-SUB > 16.

       EXT-MAIN.
      * Cierre de Registros
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-RD3.
           PERFORM SUP-FIO-D30.

      * Despliega Totales de Control Proceso
           DISPLAY 'TOTAL RD3 LEIDOS             : '
                               WSS-NUM-RRD3 IN WSS-VARI.
           DISPLAY 'TOTAL D30 GRABADOS           : '
                               WSS-NUM-D30G IN WSS-VARI.

           DISPLAY 'TOTAL REGISTROS PROCESADOS : '
                               WSS-NUM-RRD3 IN WSS-VARI.

           MOVE ZEROES TO WSS-TIP-D30.

           PERFORM DIS-TOT-POR-TIPO VARYING WSS-SUB FROM 1 BY 1 UNTIL
                                       WSS-SUB > 16.

           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(01) TO WSS-VAL-TI01.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(02) TO WSS-VAL-TI02.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(03) TO WSS-VAL-TI03.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(04) TO WSS-VAL-TI04.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(05) TO WSS-VAL-TI05.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(06) TO WSS-VAL-TI06.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(07) TO WSS-VAL-TI07.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(08) TO WSS-VAL-TI08.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(09) TO WSS-VAL-TI09.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(10) TO WSS-VAL-TI10.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(11) TO WSS-VAL-TI11.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(12) TO WSS-VAL-TI12.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(13) TO WSS-VAL-TI13.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(14) TO WSS-VAL-TI14.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(15) TO WSS-VAL-TI15.
           MOVE WSS-MNTO-D30 IN WSS-TIPO-D30(16) TO WSS-VAL-TI16.
           MOVE '016'                            TO WSS-COD-BNCO
                                                     IN WSS-D30.
           MOVE 'BANCO DE CREDITO E INVERSIONES' TO WSS-GLS-BNCO.
           IF WSS-NUM-MINF = 01
               MOVE 'ENERO' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 02
               MOVE 'FEBRERO' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 03
               MOVE 'MARZO' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 04
               MOVE 'ABRIL' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 05
               MOVE 'MAYO' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 06
               MOVE 'JUNIO' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 07
               MOVE 'JULIO' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 08
               MOVE 'AGOSTO' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 09
               MOVE 'SEPTIEMBRE' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 10
               MOVE 'OCTUBRE' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 11
               MOVE 'NOVIEMBRE' TO WSS-GLS-MESE
           ELSE
           IF WSS-NUM-MINF = 12
               MOVE 'DICIEMBRE' TO WSS-GLS-MESE.

      *    PERFORM GENERATE-DL-D30.
           PERFORM PRO-DL-D30.
      *
           CLOSE RPTD30.
      * Termino del Proceso
           PERFORM GNS-PRO-END.

      *<<<< EOF
      ******************************************************************
      * Determinacion del Tramo para Distribuir Registro Seleccionado
       DET-TRA-REG-PROC SECTION.
       INI-DET-TRA-REG-PROC.
           MOVE 0 TO WSS-IND      IN WSS-VARI
                     WSS-IND-STAT IN WSS-VARI.

           IF RD3-NUM-LINE IN RD3 = 5
               MOVE 1 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 16
               MOVE 2 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 23
               MOVE 3 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 30
               MOVE 4 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 6
               MOVE 5 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 17
               MOVE 6 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 24
               MOVE 7 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.


           IF RD3-NUM-LINE IN RD3 = 31
               MOVE 8 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.


           IF RD3-NUM-LINE IN RD3 = 3
               MOVE 9 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 18
               MOVE 10 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 25
               MOVE 11 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 32
               MOVE 12 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 8
               MOVE 13 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 19
               MOVE 14 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 26
               MOVE 15 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.

           IF RD3-NUM-LINE IN RD3 = 33
               MOVE 16 TO WSS-IND
               GO TO FIN-DET-TRA-REG-PROC.
           MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
           DISPLAY 'REGISTRO RD3 NO PROCESADO ' RD3-CIC-IOPC IN RD3.
           DISPLAY 'LINEA                     ' RD3-NUM-LINE IN RD3.
       FIN-DET-TRA-REG-PROC.
           EXIT.

       CAL-TAS-PPON-D30 SECTION.
       INI-CAL-TAS-PPON-D30.

           IF WSS-MT01-D30(WSS-SUB) = ZEROES
               MOVE ZEROES TO WSS-TP01-D30 IN WSS-ELE-D30(WSS-SUB)
           ELSE
               DIVIDE WSS-MP01-D30 IN WSS-ELE-D30(WSS-SUB) BY
                      WSS-MT01-D30 IN WSS-ELE-D30(WSS-SUB) GIVING
                      WSS-TP01-D30 IN WSS-ELE-D30(WSS-SUB) ROUNDED.

           IF WSS-MT02-D30(WSS-SUB) = ZEROES
               MOVE ZEROES TO WSS-TP02-D30 IN WSS-ELE-D30(WSS-SUB)
           ELSE
               DIVIDE WSS-MP02-D30 IN WSS-ELE-D30(WSS-SUB) BY
                      WSS-MT02-D30 IN WSS-ELE-D30(WSS-SUB) GIVING
                      WSS-TP02-D30 IN WSS-ELE-D30(WSS-SUB) ROUNDED.

           IF WSS-MT03-D30(WSS-SUB) = ZEROES
               MOVE ZEROES TO WSS-TP03-D30 IN WSS-ELE-D30(WSS-SUB)
           ELSE
               DIVIDE WSS-MP03-D30 IN WSS-ELE-D30(WSS-SUB) BY
                      WSS-MT03-D30 IN WSS-ELE-D30(WSS-SUB) GIVING
                      WSS-TP03-D30 IN WSS-ELE-D30(WSS-SUB) ROUNDED.

           IF WSS-MT04-D30(WSS-SUB) = ZEROES
               MOVE ZEROES TO WSS-TP04-D30 IN WSS-ELE-D30(WSS-SUB)
           ELSE
               DIVIDE WSS-MP04-D30 IN WSS-ELE-D30(WSS-SUB) BY
                      WSS-MT04-D30 IN WSS-ELE-D30(WSS-SUB) GIVING
                      WSS-TP04-D30 IN WSS-ELE-D30(WSS-SUB) ROUNDED.

           IF WSS-MT05-D30(WSS-SUB) = ZEROES
               MOVE ZEROES TO WSS-TP05-D30 IN WSS-ELE-D30(WSS-SUB)
           ELSE
               DIVIDE WSS-MP05-D30 IN WSS-ELE-D30(WSS-SUB) BY
                      WSS-MT05-D30 IN WSS-ELE-D30(WSS-SUB) GIVING
                      WSS-TP05-D30 IN WSS-ELE-D30(WSS-SUB) ROUNDED.

           IF WSS-MT06-D30(WSS-SUB) = ZEROES
               MOVE ZEROES TO WSS-TP06-D30 IN WSS-ELE-D30(WSS-SUB)
           ELSE
               DIVIDE WSS-MP06-D30 IN WSS-ELE-D30(WSS-SUB) BY
                      WSS-MT06-D30 IN WSS-ELE-D30(WSS-SUB) GIVING
                      WSS-TP06-D30 IN WSS-ELE-D30(WSS-SUB) ROUNDED.

           IF WSS-MT07-D30(WSS-SUB) = ZEROES
               MOVE ZEROES TO WSS-TP07-D30 IN WSS-ELE-D30(WSS-SUB)
           ELSE
               DIVIDE WSS-MP07-D30 IN WSS-ELE-D30(WSS-SUB) BY
                      WSS-MT07-D30 IN WSS-ELE-D30(WSS-SUB) GIVING
                      WSS-TP07-D30 IN WSS-ELE-D30(WSS-SUB) ROUNDED.

           IF WSS-MT08-D30(WSS-SUB) = ZEROES
               MOVE ZEROES TO WSS-TP08-D30 IN WSS-ELE-D30(WSS-SUB)
           ELSE
               DIVIDE WSS-MP08-D30 IN WSS-ELE-D30(WSS-SUB) BY
                      WSS-MT08-D30 IN WSS-ELE-D30(WSS-SUB) GIVING
                      WSS-TP08-D30 IN WSS-ELE-D30(WSS-SUB) ROUNDED.

           IF WSS-MT09-D30(WSS-SUB) = ZEROES
               MOVE ZEROES TO WSS-TP09-D30 IN WSS-ELE-D30(WSS-SUB)
           ELSE
               DIVIDE WSS-MP09-D30 IN WSS-ELE-D30(WSS-SUB) BY
                      WSS-MT09-D30 IN WSS-ELE-D30(WSS-SUB) GIVING
                      WSS-TP09-D30 IN WSS-ELE-D30(WSS-SUB) ROUNDED.

       FIN-CAL-TAS-PPON-D30.
           EXIT.

       GEN-REG-CAB-D30 SECTION.
       INI-GEN-REG-CAB-D30.
           MOVE SPACES                   TO WSS-CABE-D30.
           MOVE '016'                    TO WSS-COD-BNCO IN WSS-VARI.
           MOVE 'D30'                    TO WSS-IND-AD30.
           MOVE WSS-NUM-DINF             TO WSS-NUM-DD30.
           MOVE WSS-NUM-MINF             TO WSS-NUM-MD30.
           MOVE WSS-NUM-SINF             TO WSS-NUM-SD30.
           MOVE WSS-NUM-AINF             TO WSS-NUM-AD30.
           MOVE WSS-CABE-D30             TO D30.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SUP-FIO-D30.
           IF NOT FIO-STAT-OKS
               DISPLAY ' ERROR EN INGRESO D30, FIO-STAT : ' FIO-STAT
               DISPLAY ' LLAVE : ' D30
               PERFORM GNS-PRO-ABT
           ELSE
               ADD 1 TO WSS-NUM-D30G.
       FIN-GEN-REG-CAB-D30.
           EXIT.

      * Forma y Graba el Registro Interfaz D30 Super-Bancos - DAP- COL
       GEN-REG-D30 SECTION.
       INI-GEN-REG-D30.

      * Forma el Registro Interfaz D30 Super-Bancos
           MOVE WSS-SUB      IN WSS-VARI TO D30-NUM-LINE IN D30.

           MOVE WSS-TM01-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM01 IN D30.
           MOVE WSS-TX01-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX01 IN D30.
           MOVE WSS-TP01-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP01 IN D30.
           MOVE WSS-MT01-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT01 IN D30.

           MOVE WSS-TM02-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM02 IN D30.
           MOVE WSS-TX02-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX02 IN D30.
           MOVE WSS-TP02-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP02 IN D30.
           MOVE WSS-MT02-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT02 IN D30.

           MOVE WSS-TM03-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM03 IN D30.
           MOVE WSS-TX03-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX03 IN D30.
           MOVE WSS-TP03-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP03 IN D30.
           MOVE WSS-MT03-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT03 IN D30.

           MOVE WSS-TM04-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM04 IN D30.
           MOVE WSS-TX04-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX04 IN D30.
           MOVE WSS-TP04-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP04 IN D30.
           MOVE WSS-MT04-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT04 IN D30.

           MOVE WSS-TM05-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM05 IN D30.
           MOVE WSS-TX05-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX05 IN D30.
           MOVE WSS-TP05-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP05 IN D30.
           MOVE WSS-MT05-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT05 IN D30.

           MOVE WSS-TM06-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM06 IN D30.
           MOVE WSS-TX06-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX06 IN D30.
           MOVE WSS-TP06-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP06 IN D30.
           MOVE WSS-MT06-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT06 IN D30.

           MOVE WSS-TM07-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM07 IN D30.
           MOVE WSS-TX07-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX07 IN D30.
           MOVE WSS-TP07-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP07 IN D30.
           MOVE WSS-MT07-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT07 IN D30.

           MOVE WSS-TM08-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM08 IN D30.
           MOVE WSS-TX08-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX08 IN D30.
           MOVE WSS-TP08-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP08 IN D30.
           MOVE WSS-MT08-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT08 IN D30.

           MOVE WSS-TM09-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM09 IN D30.
           MOVE WSS-TX09-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX09 IN D30.
           MOVE WSS-TP09-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP09 IN D30.
           MOVE WSS-MT09-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT09 IN D30.

           MOVE WSS-TM09-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TM09 IN D30.
           MOVE WSS-TX09-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TX09 IN D30.
           MOVE WSS-TP09-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-TP09 IN D30.
           MOVE WSS-MT09-D30 IN WSS-ELE-D30(WSS-SUB) TO
                D30-VAL-MT09 IN D30.

           MOVE FIO-PUT TO FIO-CMND
           PERFORM SUP-FIO-D30
           IF NOT FIO-STAT-OKS
               DISPLAY ' ERROR EN INGRESO D30, FIO-STAT : ' FIO-STAT
               DISPLAY ' LLAVE : ' D30
               PERFORM GNS-PRO-ABT
           ELSE
               ADD 1 TO WSS-NUM-D30G.
       FIN-GEN-REG-D30.
           EXIT.

       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGEND.
       COPY GNSBGABT.

       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY TABBFOFI.
       COPY TABBFCAM.
       COPY COLBFRD3.
       COPY SUPBFD30.
       COPY GNSBBMSC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGPES.
       COPY COLRED30.
       ANL-VEC-D30 SECTION.
       INI-ANL-VEC-D30.

           IF WSS-TMIN = ZEROES
               MOVE WSS-TEQV IN WSS-VARI TO
                    WSS-TMIN IN WSS-VARI
           ELSE
           IF WSS-TEQV IN WSS-VARI < WSS-TMIN IN WSS-VARI
               MOVE WSS-TEQV IN WSS-VARI TO
                    WSS-TMIN IN WSS-VARI.

           IF WSS-TEQV IN WSS-VARI > WSS-TMAX IN WSS-VARI
               MOVE WSS-TEQV IN WSS-VARI TO
                    WSS-TMAX IN WSS-VARI.


            MULTIPLY WSS-TEQV IN WSS-VARI BY
                     RD3-VAL-CAPI IN RD3 GIVING
                     WSS-PPON IN WSS-VARI.

       FIN-ANL-VEC-D30.
           EXIT.

       DIS-TOT-POR-TIPO SECTION.
       INI-DIS-TOT-POR-TIPO.
           DISPLAY ' TIPO DE OPERACION : ' WSS-SUB ' TOTAL : '
                     WSS-CONT-D30(WSS-SUB).

           ADD WSS-CONT-D30(WSS-SUB) TO WSS-VAL-NUOP.
           ADD WSS-MT01-D30 IN WSS-ELE-D30(WSS-SUB)
               WSS-MT02-D30 IN WSS-ELE-D30(WSS-SUB)
               WSS-MT03-D30 IN WSS-ELE-D30(WSS-SUB)
               WSS-MT04-D30 IN WSS-ELE-D30(WSS-SUB)
               WSS-MT05-D30 IN WSS-ELE-D30(WSS-SUB)
               WSS-MT06-D30 IN WSS-ELE-D30(WSS-SUB)
               WSS-MT07-D30 IN WSS-ELE-D30(WSS-SUB)
               WSS-MT08-D30 IN WSS-ELE-D30(WSS-SUB)
               WSS-MT09-D30 IN WSS-ELE-D30(WSS-SUB) TO
               WSS-MNTO-D30 IN WSS-TIPO-D30(WSS-SUB).

       FIN-DIS-TOT-POR-TIPO.
           EXIT.
       D-PH-D30 SECTION.
       INI-PH-D30.
       FIN-PH-D30.
           EXIT.
       D-DL-D30 SECTION.
       INI-DL-D30.
       FIN-DL-D30.
           EXIT.
      *>>>>
