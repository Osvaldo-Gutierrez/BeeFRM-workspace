       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPBTCV.
       AUTHOR.          BEE TEAM (DPM).
       DATE-WRITTEN.    14-JAN-1998 (ult. modificacion)
      * Programa para pasar VEN que sean VISA a Castigo
      *
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *<<<< WSS
       COPY COLBRERC.
       COPY COLBRVEN.
       COPY COLBROPC.
       COPY COLBRCAN.
       COPY COLBRRCV.
       COPY COLBRCYA.
       COPY COLBRICG.
       COPY COLBRROV.
       COPY COLBRTOC.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRRDC.
       COPY COLBRRDT.
       COPY COLBRPOC.
       COPY COLBRPVC.

       COPY SGCBRDBC.

       COPY COLWGVEN.

       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY TABBRCAM.
       COPY GNSBRTAB.
       COPY TABBROFI.
       COPY GNSBRCIC.
       COPY TABBRUSR.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
       COPY COLWGINT.
       COPY GNSWCNUM.
       COPY GNSWCSCR.
       COPY GNSWCVRF.
       COPY GNSWGCIC.
       COPY GNSWGCPT.
       COPY GNSWGFRM.
       COPY GNSWGIDC.
       COPY GNSWVNUM.
       COPY GNSWVSCR.
       COPY GNSWVVRF.
       COPY COLWICAN.
       COPY COLW1CAN.

       COPY COLBRVEN REPLACING ==VEN== BY ==VEN-BKP==.
      *
      *01  WSS-VARI. *EXISTE  DEFINIDO EN COPY COLW2CAN
       COPY COLW2CAN.

           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-FEC-FMIN.
              05 WSS-NUM-SMIN                     PIC 9(02).
              05 WSS-NUM-AMIN                     PIC 9(02).
              05 WSS-NUM-MMIN                     PIC 9(02).
              05 WSS-NUM-DMIN                     PIC 9(02).
           03 WSS-IND-FLAG        VALUE ZEROES    PIC 9(01).
           03 WSS-NUM-DTAC        VALUE ZEROES    PIC 9(03).
           03 WSS-DIF-DIAS        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-CORR        VALUE ZEROES    PIC 9(06).
           03 WSS-IND-DISP        VALUE SPACES    PIC X(01).
           03 WSS-COD-PESO        VALUE SPACES    PIC X(06).
           03 WSS-SGV-CAP1        VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-SGV-CAP2        VALUE ZEROES    PIC 9(11)V9(04).

      * Variables para estadisticas
           03 WSS-NUM-RLEI        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RNSE        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RGRA        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RACT        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RNIN        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RNAC        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RRCH        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-ROIN        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RONI        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-ROAC        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RONA        VALUE ZEROES    PIC 9(06).
      *
           03  WSS-MAXV              VALUE ZEROS  PIC 9(03).
           03  WSS-MINV              VALUE ZEROS  PIC 9(03).
           03  WSS-MAXD              VALUE ZEROS  PIC 9(03).
           03  WSS-MIND              VALUE ZEROS  PIC 9(03).
           03  WSS-IDLC.
               05  WSS-VEC-IDLC OCCURS 500.
                   07  WSS-SGV-CAPD  COMP-3       PIC S9(11)V9(04).
                   07  WSS-SGV-FINA  COMP-3       PIC S9(11)V9(04).
           03  WSS-LIM-IDLC          VALUE 500    PIC 9(03).
           03  WSS-NUM-IDLC          VALUE ZEROS  PIC 9(04).
           03  WSS-NUM-VCVG          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-VCCM          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-VCCO          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-VCCV          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-IEVC          VALUE ZEROS  PIC 9(03).
           03  WSS-AUX-IVEN          VALUE ZEROS  PIC 9(03).
           03  WSS-IND-SCTB                        PIC X(03).
           03  WSS-IND-SCTZ         VALUE SPACES   PIC X(03).
           03  WSS-IND-SCBZ                        PIC X(05).
           03  WSS-IND-EXIS          VALUE 'N'    PIC X(01).
           03  WSS-VAL-CAPI-GENE     COMP-3       PIC 9(11)V9(04).
           03  WSS-VAL-VENC  COMP-3  VALUE ZEROS  PIC 9(11)V9(04).
           03  WSS-FEC-FAMT.
               05  WSS-NUM-SAMT      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-AAMT      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-MAMT      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-DAMT      VALUE ZEROS  PIC 9(02).
           03  WSS-RCAN-SACT         VALUE ZEROES PIC 9(04).
           03  WSS-RCAN-NACT         VALUE ZEROES PIC 9(04).
           03  WSS-COD-OFOC          VALUE SPACES PIC X(03).
           03  WSS-SGV-LIQU          VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-COD-RMOC          VALUE SPACES PIC X(12).
           03  WSS-MSC-TCVE          VALUE SPACES PIC X(02).
           03  WSS-COD-CTAB.
               05  WSS-COD-CLASE.
                   07  WSS-COD-TIOC  VALUE ZEROES PIC X(03).
                   07  WSS-COD-AUXC  VALUE ZEROES PIC X(03).
               05  WSS-COD-VCDA      VALUE SPACES PIC X(06).
           03  WSS-NUM-DIRE          VALUE ZEROES PIC X(02).
           03  WSS-GLS-FONO          VALUE ZEROES PIC X(12).
           03  WSS-COD-PLZO          VALUE SPACES PIC X(02).
           03  WSS-COD-CDOC          VALUE SPACES PIC X(03).
           03  WSS-IND-GARA          VALUE SPACES PIC X(03).
           03  WSS-IND-VSTR          VALUE SPACES PIC X(01).
      *ALD-BCI-INI/11-11-1998
           03  WSS-IND-AFER          VALUE SPACES PIC X(01).
      *ALD-BCI-FIN/11-11-1998
           03  WSS-CIC-IOPV          VALUE SPACES PIC X(12).
           03  WSS-NUM-IVEN          VALUE ZEROES PIC 9(03).
           03  WSS-CNTD              VALUE ZEROES PIC 9(03).
           03  WSS-TOPE              VALUE ZEROES PIC 9(03).
           03  WSS-CMAX              VALUE 010    PIC 9(03).
           03  WSS-COD-VISA          OCCURS 10    PIC X(06).
      *ALD-BCI-INI/20-08-1998 VALIDA SI TIENE CAN ANTERIORES PARA FIMV
           03  WSS-FEC-FMVE.
               05  WSS-NUM-SMVE      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-AMVE      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-MMVE      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-DMVE      VALUE ZEROS  PIC 9(02).
      *ALD-BCI-FIN/20-08-1998
      *
       01  PGM-STAT.
           03 PGM-STAT-OPC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-OPC-OKS    VALUE '00'.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
           03 PGM-STAT-CYA           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CYA-OKS    VALUE '00'.
                 88 PGM-STAT-CYA-NUL    VALUE '  '.
           03 PGM-STAT-VEN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-VEN-OKS    VALUE '00'.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
           03 PGM-STAT-RCV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RCV-OKS    VALUE '00'.
                 88 PGM-STAT-RCV-NUL    VALUE '  '.
           03 PGM-STAT-ITR           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ITR-OKS    VALUE '00'.
                 88 PGM-STAT-ITR-NUL    VALUE '  '.
           03 PGM-STAT-ICG           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ICG-OKS    VALUE '00'.
                 88 PGM-STAT-ICG-NUL    VALUE '  '.
           03 PGM-STAT-CAN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CAN-OKS    VALUE '00'.
                 88 PGM-STAT-CAN-NUL    VALUE '  '.
           03 PGM-STAT-ROV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ROV-OKS    VALUE '00'.
                 88 PGM-STAT-ROV-NUL    VALUE '  '.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).


       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPBTCV' TO FIO-PROG SCR-USER.
           PERFORM GNS-BUS-IDD.
           PERFORM OPEN-FILE.
           PERFORM LEE-PARAM.
           PERFORM PRO-TRASPASO-CAST.
           PERFORM CLOSE-FILE.
           PERFORM MUESTRA-ESTADISTICAS.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

      ******************************************************************
       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-POC.
           PERFORM COL-FIO-PVC.
           PERFORM SGC-FIO-DBC.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-ROV.

           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-EVC.
           PERFORM COL-FIO-RDC.

           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-ERC.
       FIN-OPEN-FILE.
           EXIT.

      ******************************************************************
       LEE-PARAM SECTION.
      *-----------------
       INI-LEE-PARAM.
           DISPLAY 'CAPTURA PARAMETROS'.
           DISPLAY ' '.

      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO (DDMMSSAA): '.
           ACCEPT WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.

      * Captura Numero de Dias para traspaso a cartera Vcda.
           DISPLAY 'NUMERO DE DIAS PARA TRASPASO (999): '.
           ACCEPT WSS-NUM-DTAC IN WSS-VARI.
           DISPLAY WSS-NUM-DTAC IN WSS-VARI.

      * Captura Clase de creditos VISA
       LUP-ACEPT-COOC.
           ADD 1 TO WSS-CNTD IN WSS-VARI
                    WSS-TOPE IN WSS-VARI.
           ACCEPT WSS-COD-VISA(WSS-CNTD).
           DISPLAY 'CLASE DE OPERACION  : ' WSS-COD-VISA(WSS-CNTD).
           IF WSS-COD-VISA(WSS-CNTD) NOT = 'XXXXXX' AND
              WSS-CNTD IN WSS-VARI NOT > WSS-CMAX IN WSS-VARI
               GO TO LUP-ACEPT-COOC.

           SUBTRACT 1 FROM WSS-CNTD IN WSS-VARI
                           WSS-TOPE IN WSS-VARI.

      * Captura Indicador de Display
           DISPLAY 'INDICADOR DE DISPLAY (S/N): '.
           ACCEPT WSS-IND-DISP IN WSS-VARI.
           DISPLAY WSS-IND-DISP IN WSS-VARI.

      * Validacion de parametros
           DISPLAY  ' '.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.
           DISPLAY  ' '.

           DISPLAY 'VALIDA FECHA DE PROCESO'.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR VALIDACION FECHA DE PROCESO: '
                                                    FEC-MENS
               PERFORM GNS-PRO-ABT.

           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-AFEC IN WSS-VARI.

           DISPLAY 'VALIDA NUMERO DE DIAS'.
           IF WSS-NUM-DTAC IN WSS-VARI IS NOT NUMERIC
               DISPLAY 'NUMERO DE DIAS NO NUMERICO: '
                               WSS-NUM-DTAC IN WSS-VARI
               DISPLAY 'PROGRAMA CANCELADO...'
               PERFORM GNS-PRO-ABT.

      * Obtiene Rango de fechas para seleccionar vencimientos
      * FMIN = (FPRO - DTAC) y FMAX = ((FPRO - DIASFER) - DTAC)
           PERFORM OBT-DIA-HBL.

      * Obtiene fecha y hora actual
           PERFORM GET-FHOY.

      * Valida clase en AUX de COL
           MOVE 1 TO WSS-CNTD IN WSS-VARI.

       LUP-VALIDA-COOC.
           IF WSS-CNTD IN WSS-VARI NOT > WSS-TOPE IN WSS-VARI
      * DPM ini  14-JAN-1998 Se debe aceptar clases genericas en
      * el AUX (solo con TIO), para procesar varios deudores
               MOVE WSS-COD-VISA(WSS-CNTD) TO WSS-COD-CAUX IN WSS-VARI
               IF WSS-COD-AOOC IN WSS-VARI NOT = '*  '
      * DPM fin  14-JAN-1998
                   MOVE 'COL'                    TO TAB-COD-SIST
                   MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-VISA(WSS-CNTD)   TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS > SPACES
                       DISPLAY 'CLASE NO EXISTE EN COLAUX: '
                                                WSS-COD-VISA(WSS-CNTD)
                       DISPLAY 'PROCESO CANCELADO...'
                       PERFORM GNS-PRO-ABT
                   ELSE
                       ADD 1 TO WSS-CNTD IN WSS-VARI
                       GO TO LUP-VALIDA-COOC
               ELSE
                   ADD 1 TO WSS-CNTD IN WSS-VARI
                   GO TO LUP-VALIDA-COOC.

           DISPLAY 'VALIDA INDICADOR DE DISPLAY'.
           IF WSS-IND-DISP IN WSS-VARI NOT = 'S' AND
              WSS-IND-DISP IN WSS-VARI NOT = 'N'
               MOVE 'N' TO WSS-IND-DISP IN WSS-VARI
               DISPLAY 'INDICADOR DE DISPLAY DISTINTO DE S Y N'
               DISPLAY 'ASUME INDICADOR = N'.

      * Obtiene Codigo de Pesos
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICPESONEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CODIGO PESOS: ' WSS-COD-PESO IN WSS-VARI.

      * Valida codigo MSC en TCYA
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'MSC'                TO MSC-COD-TTAB IN MSC.
           MOVE 'TCYA'               TO MSC-COD-TMSC IN MSC.
           MOVE 'PBCAS'              TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY          TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT ( FIO-STAT-OKS AND
              MSC-IND-VIGE IN MSC = 'S' )
               MOVE 'COL'       TO MSG-COD-SIST
               MOVE 'CODTCYANEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   MSC-COD-CMSC
               PERFORM GNS-PRO-ABT
               GO TO FIN-LEE-PARAM.
       FIN-LEE-PARAM.
           EXIT.

      ******************************************************************
      * Se lee la VEN por FVEN que esten en rango
      * y si es VISA, se pasa a CASTIGO.
      *
       PRO-TRASPASO-CAST SECTION.
      *-------------------------
       INI-PRO-TRASPASO-CAST.
           MOVE SPACES                   TO VEN-KEY-IREG IN VEN.
           MOVE WSS-FEC-FMIN IN WSS-VARI TO VEN-FEC-FVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ARCHIVO COLVEN VACIO'
               GO TO FIN-PRO-TRASPASO-CAST.

           MOVE ADR-VEN-REQA TO AUX-VEN-REQA.

       LUP-PRO-TRASPASO-CAST.
           MOVE ZEROES TO WSS-DIF-DIAS IN WSS-VARI.

           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-TRASPASO-CAST.

           PERFORM CHK-PNT.

           ADD 1 TO WSS-NUM-RLEI IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY ' '
               DISPLAY 'VEN LEIDO: ' VEN-KEY-IREG IN VEN
               DISPLAY 'FVEN: ' VEN-FEC-FVEN IN VEN.

      * Verifica que VEN este en rango para pasar a Cartera Vencida
           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FFEC IN WSS-VARI AND
              VEN-FEC-FVEN IN VEN NOT < WSS-FEC-FMIN IN WSS-VARI AND
              VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FMAX IN WSS-VARI
               NEXT SENTENCE
           ELSE
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
               GO TO FIN-PRO-TRASPASO-CAST.

           IF VEN-COD-TOPC IN VEN NOT = 'D' OR
              VEN-VAL-SFIN IN VEN NOT > ZEROES
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
               GO TO NXT-PRO-TRASPASO-CAST.

           PERFORM LEE-OPC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               GO TO NXT-PRO-TRASPASO-CAST.

           IF NOT ( OPC-MSC-STAT IN OPC = 'A' AND
              OPC-VAL-SCRE IN OPC > ZEROES )
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
               GO TO NXT-PRO-TRASPASO-CAST.

           PERFORM BUSCA-CLASE-VISA.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
               GO TO NXT-PRO-TRASPASO-CAST.

           IF OPC-IND-VSTR IN OPC = 'S'
               IF OPC-NUM-IVEN IN OPC NOT = VEN-NUM-IVCT IN VEN
                   DISPLAY 'ERROR, EXISTE VEN ANTERIOR VIGENTE: '
                                     OPC-CIC-IOPC IN OPC ' '
                   ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
                   MOVE 'VEN    VIG'        TO ERC-COD-MSGE IN ERC
                   MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
                   PERFORM GRABAR-ERROR
                   GO TO NXT-PRO-TRASPASO-CAST.

           PERFORM LEE-DLC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               GO TO NXT-PRO-TRASPASO-CAST.

           IF DLC-IND-SCTB IN DLC = 'VCD' OR
      *JUS-INI 22-01-1998
      *     ( DLC-IND-SCTB IN DLC = SPACES AND
            ((DLC-IND-SCTB IN DLC = SPACES OR 'MUL') AND
      *JUS-FIN 22-01-1998
              OPC-COD-TOOC IN OPC = 'VDE' )
               NEXT SENTENCE
           ELSE
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
               GO TO NXT-PRO-TRASPASO-CAST.

      * Guardo el plazo contable para grabar la nueva DLC
            MOVE DLC-COD-PLZO IN DLC TO WSS-COD-PLZO IN WSS-VARI.

      * Guardo la oficina y el valor liquido para grabar la nueva OPC
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI.
           MOVE OPC-COD-OFOC IN OPC TO WSS-COD-OFOC IN WSS-VARI.
           MOVE OPC-SGV-LIQU IN OPC TO WSS-SGV-LIQU IN WSS-VARI.
           MOVE OPC-COD-RMOC IN OPC TO WSS-COD-RMOC IN WSS-VARI.
           MOVE OPC-COD-CDOC IN OPC TO WSS-COD-CDOC IN WSS-VARI.
           MOVE OPC-IND-GARA IN OPC TO WSS-IND-GARA IN WSS-VARI.
           MOVE OPC-IND-VSTR IN OPC TO WSS-IND-VSTR IN WSS-VARI.
      *ALD-BCI-INI/11-11-1998
           MOVE OPC-IND-AFER IN OPC TO WSS-IND-AFER IN WSS-VARI.
      *ALD-BCI-FIN/11-11-1998


      *ALD-BCI-INI/20-08-1998 VALIDA SI TIENE CAN ANTERIORES PARA FIMV
           PERFORM PRO-FMVE.
           IF WSS-FEC-FMVE IN WSS-VARI = ZEROES
               MOVE VEN-NUM-DIMV IN VEN TO WSS-NUM-DMVE
               MOVE VEN-NUM-MIMV IN VEN TO WSS-NUM-MMVE
               MOVE VEN-NUM-SIMV IN VEN TO WSS-NUM-SMVE
               MOVE VEN-NUM-AIMV IN VEN TO WSS-NUM-AMVE.
      *ALD-BCI-FIN/20-08-1998

           IF VEN-FEC-FVEN IN VEN NOT = VEN-FEC-FIMV IN VEN AND
              OPC-NUM-VCVG IN OPC = 1 AND
              OPC-IND-AFER IN OPC = 'N'
               MOVE VEN-FEC-FIMV IN VEN  TO VEN-FEC-FVEN IN VEN.

           PERFORM OBT-CIC-ICLI.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               GO TO NXT-PRO-TRASPASO-CAST.

      * Se guarda tambien el CIC del cliente para grabar la nueva RDC
           MOVE RDC-CIC-ICLI IN RDC TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE RDC-NUM-DIRE IN RDC TO WSS-NUM-DIRE IN WSS-VARI.

           MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN IN WSS-VARI.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
              PERFORM LEE-EVC
              IF WSS-IND-FLAG IN WSS-VARI = 1
                 MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                 ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
                 GO TO NXT-PRO-TRASPASO-CAST
              ELSE
                 MOVE EVC-MSC-TCVE IN EVC TO WSS-MSC-TCVE IN WSS-VARI.

      * Se obtienen los valores de cambio de UF a FCOL y FCAN para
      * calcular los Reajustes y total renovado
           IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
               PERFORM OBT-VALOR-FCOL
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                   ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
                   GO TO NXT-PRO-TRASPASO-CAST
               ELSE
                   PERFORM OBT-VALOR-FCAN
                   IF WSS-IND-FLAG IN WSS-VARI = 1
                       MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                       ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
                       GO TO NXT-PRO-TRASPASO-CAST
                   ELSE
                       NEXT SENTENCE
           ELSE
               MOVE 1 TO WSS-SGV-VCOL IN WSS-VARI
               MOVE 1 TO WSS-SGV-VCAN IN WSS-VARI.

           PERFORM LEE-NUEVA-CLASE-CAS.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA CAS: CAS'
                                      OPC-COD-COOC IN OPC
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               MOVE 'CLACAS NEX' TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO NXT-PRO-TRASPASO-CAST.

           PERFORM LEE-PVC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE SPACES TO PVC
               MOVE WSS-MSC-TCVE IN WSS-VARI TO PVC-MSC-TCVE IN PVC.

           PERFORM INGRESO-CAN.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RNIN IN WSS-VARI
               PERFORM BCK-OUT
               GO TO NXT-PRO-TRASPASO-CAST.
      *INI-JGM 19-MAR-1998.
           MOVE SPACES TO WSS-IND-SCTZ IN WSS-VARI.
           IF OPC-COD-TOOC IN OPC = 'VDE'
               MOVE 'NIS' TO WSS-IND-SCTZ IN WSS-VARI.
      *FIN-JGM 19-MAR-1998.
           PERFORM INGRESO-NUEVA-OPC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RONI IN WSS-VARI
               PERFORM BCK-OUT
               GO TO NXT-PRO-TRASPASO-CAST.

           PERFORM ACTIVO-CAN.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RNAC IN WSS-VARI
               PERFORM BCK-OUT
               GO TO NXT-PRO-TRASPASO-CAST.

      * Ahora que esta activa la CAN se debe activar la OPC
           PERFORM ACTIVO-NUEVA-OPC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RONA IN WSS-VARI
               PERFORM BCK-OUT
               GO TO NXT-PRO-TRASPASO-CAST.

       NXT-PRO-TRASPASO-CAST.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE AUX-VEN-REQA TO ADR-VEN-REQA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           PERFORM COL-FIO-VEN.
           MOVE ADR-VEN-REQA TO AUX-VEN-REQA.
           GO TO LUP-PRO-TRASPASO-CAST.
       FIN-PRO-TRASPASO-CAST.
           EXIT.

      ******************************************************************
       LEE-OPC SECTION.
      *---------------
       INI-LEE-OPC.
           MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLOPC: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'VEN  NOOPC'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LEE-OPC.
       FIN-LEE-OPC.
           EXIT.

      ******************************************************************
       OBT-CIC-ICLI SECTION.
      *--------------------
       INI-OBT-CIC-ICLI.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = RDC-CIC-IOPC IN RDC )
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLRDC: '
                       RDC-KEY-IDLC IN RDC ' ' FIO-STAT
               MOVE 'OPC  NORDC'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-OBT-CIC-ICLI.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA SGCDBC: '
                        RDC-CIC-ICLI IN RDC ' ' FIO-STAT
               MOVE 'RDCNODBC'          TO ERC-COD-MSGE IN ERC
               MOVE RDC-CIC-IOPC IN RDC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-OBT-CIC-ICLI.
       FIN-OBT-CIC-ICLI.
           EXIT.

      ******************************************************************
       LEE-DLC SECTION.
      *---------------
       INI-LEE-DLC.
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = DLC-CIC-IOPC IN DLC )
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLDLC: '
                        VEN-CIC-IOPC IN VEN ' ' FIO-STAT
               MOVE 'VEN  NODLC'        TO ERC-COD-MSGE IN ERC
               MOVE VEN-CIC-IOPC IN VEN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LEE-DLC.
       FIN-LEE-DLC.
           EXIT.

      ******************************************************************
       LEE-EVC SECTION.
      *---------------
       INI-LEE-EVC.
           MOVE VEN-CIC-IOPC IN VEN TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = EVC-CIC-IOPC IN EVC )
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLEVC: '
                        VEN-CIC-IOPC IN VEN ' ' FIO-STAT
               MOVE 'VEN  NOEVC'        TO ERC-COD-MSGE IN ERC
               MOVE VEN-CIC-IOPC IN VEN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LEE-EVC.
       FIN-LEE-EVC.
           EXIT.

      ******************************************************************
       OBT-VALOR-FCOL SECTION.
      *----------------------
       INI-OBT-VALOR-FCOL.
           MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1).
           MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (FIO-STAT-OKS AND
              CAM-IND-VIGE IN CAM = 'S')
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'CAMVCAM NEX : '
                           CAM-KEY-CAMB IN CAM
               MOVE 'CAM    NEX'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-OBT-VALOR-FCOL.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCOL IN WSS-VARI.

           IF WSS-IND-FLAG IN WSS-VARI = 'S'
               DISPLAY 'FCOL: ' OPC-FEC-FCOL IN OPC
               DISPLAY 'UF A FCOL: ' WSS-SGV-VCOL IN WSS-VARI.
       FIN-OBT-VALOR-FCOL.
           EXIT.

      ******************************************************************
       OBT-VALOR-FCAN SECTION.
      *----------------------
       INI-OBT-VALOR-FCAN.
           MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (FIO-STAT-OKS AND
              CAM-IND-VIGE IN CAM = 'S')
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'CAMVCAM NEX : '
                           CAM-KEY-CAMB IN CAM
               MOVE 'CAM    NEX'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-OBT-VALOR-FCAN.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAN IN WSS-VARI.

           IF WSS-IND-FLAG IN WSS-VARI = 'S'
               DISPLAY 'FCAN: ' VEN-FEC-FVEN IN VEN
               DISPLAY 'UF A FCAN: ' WSS-SGV-VCAN IN WSS-VARI.
       FIN-OBT-VALOR-FCAN.
           EXIT.

      ******************************************************************
       BUSCA-CLASE-VISA SECTION.
      *------------------------
       INI-BUSCA-CLASE-VISA.
           MOVE 1 TO WSS-IND-FLAG IN WSS-VARI.
           MOVE 1 TO WSS-CNTD IN WSS-VARI.

       LUP-BUSCA-CLASE-VISA.
           IF WSS-CNTD IN WSS-VARI > WSS-TOPE IN WSS-VARI
               GO TO FIN-BUSCA-CLASE-VISA.

           MOVE WSS-COD-VISA (WSS-CNTD) TO WSS-COD-CAUX IN WSS-VARI.

           IF ( WSS-COD-AOOC IN WSS-VARI NOT = '*  ' AND
                OPC-COD-COOC IN OPC NOT = WSS-COD-VISA (WSS-CNTD) ) OR
              ( WSS-COD-AOOC IN WSS-VARI = '*  ' AND
                OPC-COD-TOOC IN OPC NOT = WSS-COD-TOOC IN WSS-VARI )
               ADD 1 TO WSS-CNTD IN WSS-VARI
               GO TO LUP-BUSCA-CLASE-VISA.

           MOVE 0 TO WSS-IND-FLAG IN WSS-VARI.
       FIN-BUSCA-CLASE-VISA.
           EXIT.

      ******************************************************************
      * Se hace el ingreso de la CAN como RTE y de las entidades anexas
      * segun pgm COLPGCVS
       INGRESO-CAN SECTION.
      *-------------------
       INI-INGRESO-CAN.
           PERFORM LIMPIA-CAN.
           PERFORM LIMPIA-ICG.
           PERFORM LIMPIA-ROV.
           PERFORM LIMPIA-RCV.
           PERFORM LIMPIA-CYA.
      * Lee ultima CAN para saber correlativo de CAN a utilizar
           PERFORM BUS-CORR-CAN.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               DISPLAY 'CANCELACION YA INGRESADA: ' CAN-CIC-IOPC IN CAN
                                   CAN-NUM-ICAN IN CAN
               MOVE 'CAN  YAING'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN
           ELSE
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CORRELATIVO CAN: '
                    VEN-CIC-IOPC IN VEN ' ' WSS-NUM-CORR IN WSS-VARI.

           PERFORM LLE-REG-CAN.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-INGRESO-CAN.

           PERFORM LLE-REG-ROV.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-INGRESO-CAN.

           PERFORM LLE-REG-RCV.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-INGRESO-CAN.

           PERFORM LLE-REG-CYA.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-INGRESO-CAN.

           MOVE FIO-PUT TO FIO-CMND.

           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO CAN: '
                       CAN-KEY-ICAN IN CAN ' ' FIO-STAT
               MOVE 'CANNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN.

           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO ROV: '
                       ROV-KEY-IREG IN ROV ' ' FIO-STAT
               MOVE 'ROVNOGRABA'             TO ERC-COD-MSGE IN ERC
               MOVE WSS-CIC-IOPC IN WSS-VARI TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN.

           PERFORM COL-FIO-RCV.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO RCV: '
                       RCV-KEY-IREG IN RCV ' ' FIO-STAT
               MOVE 'RCVNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE RCV-CIC-IOPC IN RCV TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN.

           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO CYA: '
                       CYA-KEY-ICYA IN CYA ' ' FIO-STAT
               MOVE 'CYANOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE CYA-CIC-IOPC IN CYA TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN.

      *DPM INI SOLO PRUEBAS
      * NXT-INGRESO-CAN.
      *DPM FIN SOLO PRUEBAS
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'REG. CAN INGRESADO: ' CAN-KEY-IREG IN CAN
               DISPLAY 'REG. ROV INGRESADO: ' ROV-KEY-IREG IN ROV
               DISPLAY 'REG. RCV INGRESADO: ' RCV-KEY-IREG IN RCV
               DISPLAY 'REG. CYA INGRESADO: ' CYA-KEY-IREG IN CYA.

           ADD 1 TO WSS-NUM-RGRA IN WSS-VARI.
       FIN-INGRESO-CAN.
           EXIT.

      ******************************************************************
       INGRESO-NUEVA-OPC SECTION.
      *-------------------------
       INI-INGRESO-NUEVA-OPC.
           PERFORM LIMPIA-NUEVA-OPC.
           PERFORM LIMPIA-NUEVA-DLC.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               PERFORM LIMPIA-NUEVA-EVC.

           PERFORM LIMPIA-NUEVA-VEN.
           PERFORM LIMPIA-CYA.
           PERFORM LIMPIA-ICG.
           PERFORM LIMPIA-NUEVA-RDC.

           PERFORM LLE-REG-NUEVA-OPC.
           PERFORM LLE-REG-NUEVA-DLC.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               PERFORM LLE-REG-NUEVA-EVC.

           PERFORM LLE-REG-NUEVA-VEN.
           PERFORM LLE-REG-NUEVA-CYA.
           PERFORM LLE-REG-NUEVA-ICG.

           PERFORM LLE-REG-NUEVA-RDC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               GO TO FIN-INGRESO-NUEVA-OPC.

           MOVE FIO-PUT TO FIO-CMND.

           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA OPC: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'OPCNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA DLC: '
                       DLC-KEY-IREG IN DLC ' ' FIO-STAT
               MOVE 'DLCNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               PERFORM COL-FIO-EVC
               IF NOT FIO-STAT-OKS
                   MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                   DISPLAY 'ERROR INGRESO NUEVA EVC: '
                           EVC-KEY-IREG IN EVC ' ' FIO-STAT
                   MOVE 'EVCNOGRABA'        TO ERC-COD-MSGE IN ERC
                   MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
                   PERFORM GRABAR-ERROR
                   GO TO FIN-INGRESO-NUEVA-OPC.

           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA VEN: '
                       VEN-KEY-IREG IN VEN ' ' FIO-STAT
               MOVE 'VENNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.

           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA CYA: '
                       CYA-KEY-IREG IN CYA ' ' FIO-STAT
               MOVE 'CYANOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.

           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA ICG: '
                       ICG-KEY-IREG IN ICG ' ' FIO-STAT
               MOVE 'ICGNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'NUEVO REG. OPC INGRESADO: '
                                   OPC-KEY-IREG IN OPC
               DISPLAY 'NUEVO REG. DLC INGRESADO: '
                                   DLC-KEY-IREG IN DLC
               DISPLAY 'NUEVO REG. EVC INGRESADO: '
                                   EVC-KEY-IREG IN EVC
               DISPLAY 'NUEVO REG. VEN INGRESADO: '
                                   VEN-KEY-IREG IN VEN
               DISPLAY 'NUEVO REG. CYA INGRESADO: '
                                   CYA-KEY-IREG IN CYA
               DISPLAY 'NUEVO REG. ICG INGRESADO: '
                                   ICG-KEY-IREG IN ICG.

           ADD 1 TO WSS-NUM-ROIN IN WSS-VARI.
       FIN-INGRESO-NUEVA-OPC.
           EXIT.

      ******************************************************************
      * Proceso de activacion de una Cancelacion
      * Despues de tener buffer cargado ( CAN-FLD ) realiza el mismo
      * proceso del programa interactivo ( ver CMN-ACC )
      *
       ACTIVO-CAN SECTION.
      *------------------
       INI-ACTIVO-CAN.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVEN IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.

           MOVE 'CAN' TO SCR-CMND.
           MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD.

           PERFORM INI-CAN.
      *ALD-BCI-INI/04051998
      *     IF CAN-MSC-FCAN IN CAN = 'T' AND
      *        CAN-MSC-ECAN IN CAN = 'T'
           IF ( CAN-MSC-FCAN IN CAN = 'T' AND
                CAN-MSC-ECAN IN CAN = 'T' ) OR
              ( CAN-MSC-FCAN IN CAN = 'T' AND
                CAN-MSC-ECAN IN CAN = 'E' AND
                OPC-NUM-VCOR IN OPC = 1 )
                 PERFORM TOT-CUO
      *ALD-BCI-FIN/04051998
           ELSE
               PERFORM PRO-RCV.

           IF MSG-COD-MENS > SPACES
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY MSG-COD-MENS
               MOVE MSG-COD-MENS        TO ERC-COD-MSGE IN ERC
               MOVE VEN-CIC-IOPC IN VEN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-ACTIVO-CAN.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'CAN    NOUPD: ' CAN-KEY-IREG IN CAN
               MOVE 'CAN  NOUPD'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-ACTIVO-CAN.

           MOVE 'A' TO CAN-MSC-STAT IN CAN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CAN    NOMOD: ' CAN-KEY-IREG IN CAN
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               MOVE 'CAN  NOMOD'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-ACTIVO-CAN.

           ADD 1 TO WSS-NUM-RACT IN WSS-VARI.
           MOVE ZEROES TO WSS-IND-FLAG IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CAN ACTIVADA: ' CAN.
       FIN-ACTIVO-CAN.
           EXIT.

      ******************************************************************
       ACTIVO-NUEVA-OPC SECTION.
      *------------------------
       INI-ACTIVO-NUEVA-OPC.
           MOVE ROV-CIC-IOPC IN ROV TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE 'A' TO OPC-MSC-STAT IN OPC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR ACTUALIZACION COLOPC: '
                                    OPC-CIC-IOPC IN OPC
               MOVE 'OPC  NOMOD'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-ACTIVO-NUEVA-OPC.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'OPC ACTIVADA: ' OPC-CIC-IOPC IN OPC.

           ADD 1 TO WSS-NUM-ROAC IN WSS-VARI.
       FIN-ACTIVO-NUEVA-OPC.
           EXIT.

      ******************************************************************
       INI-CAN SECTION.
      *---------------
       INI-INI-CAN.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE ZEROES TO WSS-NUM-VCVG IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCM IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCO IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCV IN WSS-VARI.
           PERFORM RST-DLC VARYING WSS-NUM-IDLC FROM 1 BY 1
                           UNTIL   WSS-NUM-IDLC > WSS-LIM-IDLC.
       FIN-INI-CAN.
           EXIT.

      ******************************************************************
       RST-DLC SECTION.
      *---------------
       INI-RST-DLC.
           MOVE ZEROES TO WSS-SGV-CAPD(WSS-NUM-IDLC)
                          WSS-SGV-FINA(WSS-NUM-IDLC).
       FIN-RST-DLC.
           EXIT.

      ******************************************************************
       LEE-NUEVA-CLASE-CAS SECTION.
      *---------------------------
       INI-LEE-NUEVA-CLASE-CAS.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'LEE NUEVA CLASE CAS'
               DISPLAY 'CLASE ANTIGUA: ' OPC-COD-COOC IN OPC.

           MOVE SPACES              TO WSS-COD-CTAB IN WSS-VARI.
           MOVE OPC-COD-COOC IN OPC TO WSS-COD-CLASE IN WSS-VARI.

           MOVE 'COL' TO FIO-SIST.
           MOVE 'CAS'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-LEE-NUEVA-CLASE-CAS.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB IN WSS-VARI.

           IF NOT ( FIO-STAT-OKS AND
              TAB-COD-TTAB IN TAB = 'CAS' AND
              TAB-IND-VIGE IN TAB = 'S' AND
              WSS-COD-CLASE IN WSS-VARI = OPC-COD-COOC IN OPC )
               MOVE 'CAS'                    TO TAB-COD-TTAB IN TAB
               MOVE SPACES              TO WSS-COD-CTAB IN WSS-VARI
               MOVE OPC-COD-TOOC IN OPC TO WSS-COD-TIOC IN WSS-VARI
               MOVE '*  '               TO WSS-COD-AUXC IN WSS-VARI
               MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM GNS-FIO-TAB
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB IN WSS-VARI
               IF NOT ( FIO-STAT-OKS AND
                  TAB-COD-TTAB IN TAB = 'CAS' AND
                  TAB-IND-VIGE IN TAB = 'S' AND
                  WSS-COD-TIOC IN WSS-VARI = OPC-COD-TOOC IN OPC AND
                  WSS-COD-AUXC IN WSS-VARI = '*  ' )
                   MOVE 'CAS'                    TO TAB-COD-TTAB IN TAB
                   MOVE SPACES              TO WSS-COD-CTAB IN WSS-VARI
                   MOVE '*  '               TO WSS-COD-TIOC IN WSS-VARI
                   MOVE SPACES              TO WSS-COD-AUXC IN WSS-VARI
                   MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB
                   MOVE FIO-GET-NLS TO FIO-CMND
                   PERFORM GNS-FIO-TAB
                   MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB IN WSS-VARI
                   IF NOT ( FIO-STAT-OKS AND
                      TAB-COD-TTAB IN TAB = 'CAS' AND
                      TAB-IND-VIGE IN TAB = 'S' AND
                      WSS-COD-CLASE IN WSS-VARI = '*     ' )
                       MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                       GO TO FIN-LEE-NUEVA-CLASE-CAS.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB IN WSS-VARI.

           PERFORM LEE-POC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE 'COL' TO FIO-SIST
               MOVE 'CAS' TO TAB-COD-TTAB IN TAB
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-LEE-NUEVA-CLASE-CAS.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CLASE NUEVA OPC: ' WSS-COD-VCDA IN WSS-VARI.
       FIN-LEE-NUEVA-CLASE-CAS.
           EXIT.

      ******************************************************************
       LEE-POC SECTION.
      *---------------
       INI-LEE-POC.
           MOVE OPC-COD-VCOC IN OPC      TO POC-COD-VCOC IN POC.
           MOVE WSS-COD-VCDA IN WSS-VARI TO POC-COD-COOC IN POC.
           MOVE ZEROES                   TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
      *     IF NOT ( FIO-STAT-OKS AND
      *        OPC-COD-VCOC IN OPC = POC-COD-VCOC IN POC AND
      *        OPC-COD-COOC IN OPC = POC-COD-COOC IN POC )
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI.
       FIN-LEE-POC.
           EXIT.

      ******************************************************************
       LEE-PVC SECTION.
      *---------------
       INI-LEE-PVC.
           MOVE POC-COD-IPVC IN POC TO PVC-CIC-IPVC IN PVC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-PVC.
      *     IF NOT ( FIO-STAT-OKS AND
      *        OPC-CIC-IOPC IN OPC = PVC-CIC-IPVC IN PVC )
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI.
       FIN-LEE-PVC.
           EXIT.

      ******************************************************************
       LIMPIA-CAN SECTION.
      *------------------
       INI-LIMPIA-CAN.
           MOVE SPACES TO CAN-CIC-IOPC IN CAN.
           MOVE ZEROES TO CAN-NUM-ICAN IN CAN.
           MOVE SPACES TO CAN-COD-RCAN IN CAN.
           MOVE SPACES TO CAN-MSC-STAT IN CAN.
           MOVE SPACES TO CAN-MSC-CANC IN CAN.
           MOVE ZEROES TO CAN-FEC-FOUT IN CAN.
           MOVE ZEROES TO CAN-FEC-FCAN IN CAN.
           MOVE ZEROES TO CAN-FEC-FEGR IN CAN.
           MOVE SPACES TO CAN-COD-OFCA IN CAN.
           MOVE ZEROES TO CAN-SGV-GAST IN CAN.
           MOVE ZEROES TO CAN-SGV-TREN IN CAN.
           MOVE ZEROES TO CAN-SGV-TPAG IN CAN.
           MOVE ZEROES TO CAN-SGV-DIFE IN CAN.
           MOVE SPACES TO CAN-FEC-FTRN IN CAN.
           MOVE SPACES TO CAN-HRA-HRTR IN CAN.
           MOVE ZEROES TO CAN-NUM-TVCC IN CAN.
           MOVE SPACES TO CAN-COD-ATRN IN CAN.
       FIN-LIMPIA-CAN.
           EXIT.

      ******************************************************************
       LIMPIA-ROV SECTION.
      *------------------
       INI-LIMPIA-ROV.
           MOVE SPACES TO ROV-CIC-IOPC IN ROV.
           MOVE ZEROES TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES TO ROV-NUM-IVCT IN ROV.
           MOVE ZEROES TO ROV-SGV-RENO IN ROV.
       FIN-LIMPIA-ROV.
           EXIT.

      ******************************************************************
       LIMPIA-RCV SECTION.
      *------------------
       INI-LIMPIA-RCV.
           MOVE SPACES TO RCV-CIC-IOPC IN RCV.
           MOVE ZEROES TO RCV-NUM-ICAN IN RCV.
           MOVE SPACES TO RCV-CIC-IOPV IN RCV.
           MOVE ZEROES TO RCV-NUM-IVCT IN RCV.
           MOVE SPACES TO RCV-MSC-MCAN IN RCV.
           MOVE ZEROES TO RCV-SGV-CAPI IN RCV.
           MOVE ZEROES TO RCV-SGV-FINA IN RCV.
           MOVE ZEROES TO RCV-SGV-REAJ IN RCV.
           MOVE SPACES TO RCV-CIC-IOPD IN RCV.
           MOVE ZEROES TO RCV-NUM-IDLC IN RCV.
           MOVE ZEROES TO RCV-NUM-IEVC IN RCV.
           MOVE ZEROES TO RCV-SGV-INTE IN RCV.
           MOVE ZEROES TO RCV-IND-SCTB IN RCV.
           MOVE ZEROES TO RCV-FEC-FCAN IN RCV.
           MOVE ZEROES TO RCV-FEC-FOUT IN RCV.
           MOVE ZEROES TO RCV-SGV-INTN IN RCV.
           MOVE ZEROES TO RCV-SGV-INTM IN RCV.
           MOVE SPACES TO RCV-GLS-DISP IN RCV.
           MOVE ZEROES TO RCV-NUM-IDLC IN RCV.
           MOVE SPACES TO RCV-MSC-STAT IN RCV.
           MOVE SPACES TO RCV-IND-SCBZ IN RCV.
       FIN-LIMPIA-RCV.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-OPC SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-OPC.
           MOVE SPACES              TO OPC-CIC-IOPC IN OPC.
           MOVE SPACES              TO OPC-GLS-FLAG IN OPC.
           MOVE SPACES              TO OPC-MSC-STAT IN OPC.
           MOVE SPACES              TO OPC-COD-OTRN IN OPC.
           MOVE SPACES              TO OPC-COD-ATRN IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCOR IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCVG IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCCO IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCCM IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCCV IN OPC.
           MOVE ZEROES              TO OPC-NUM-TVCC IN OPC.
           MOVE SPACES              TO OPC-MSC-TCVE IN OPC.
           MOVE SPACES              TO OPC-MSC-BCCR IN OPC.
           MOVE SPACES              TO OPC-MSC-VICR IN OPC.
           MOVE SPACES              TO OPC-COD-AGES IN OPC.
           MOVE SPACES              TO OPC-GLS-DISP IN OPC.
           MOVE SPACES              TO OPC-STP-ITRN IN OPC.
           MOVE ZEROES              TO OPC-NUM-IVEN IN OPC.

           MOVE SPACES              TO OPC-MSC-TVOC IN OPC.
           MOVE SPACES              TO OPC-COD-TOOC IN OPC.
           MOVE SPACES              TO OPC-COD-OFOC IN OPC.
           MOVE SPACES              TO OPC-COD-VCOC IN OPC.
           MOVE SPACES              TO OPC-COD-AOOC IN OPC.
           MOVE ZEROES              TO OPC-VAL-CRED IN OPC.
           MOVE ZEROES              TO OPC-VAL-SCRE IN OPC.
           MOVE SPACES              TO OPC-CAI-ILDC IN OPC.
           MOVE SPACES              TO OPC-IIC-ILDC IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCVG IN OPC.
           MOVE SPACES              TO OPC-IND-CTBL IN OPC.
           MOVE SPACES              TO OPC-IND-RENO IN OPC.
           MOVE SPACES              TO OPC-CAI-ICEN IN OPC.
           MOVE SPACES              TO OPC-IIC-ICEN IN OPC.
           MOVE ZEROES              TO OPC-NUM-DINP IN OPC.
           MOVE ZEROES              TO OPC-NUM-MINP IN OPC.
           MOVE ZEROES              TO OPC-NUM-SINP IN OPC.
           MOVE ZEROES              TO OPC-NUM-AINP IN OPC.
           MOVE ZEROES              TO OPC-NUM-DCOL IN OPC.
           MOVE ZEROES              TO OPC-NUM-MCOL IN OPC.
           MOVE ZEROES              TO OPC-NUM-SCOL IN OPC.
           MOVE ZEROES              TO OPC-NUM-ACOL IN OPC.
           MOVE ZEROES              TO OPC-NUM-DING IN OPC.
           MOVE ZEROES              TO OPC-NUM-MING IN OPC.
           MOVE ZEROES              TO OPC-NUM-SING IN OPC.
           MOVE ZEROES              TO OPC-NUM-AING IN OPC.
           MOVE ZEROES              TO OPC-VAL-SEGP IN OPC.
           MOVE SPACES              TO OPC-COD-CVTA IN OPC.
           MOVE SPACES              TO OPC-IND-GARA IN OPC.
           MOVE SPACES              TO OPC-IND-VSTR IN OPC.
           MOVE ZEROES              TO OPC-SGV-VCOM IN OPC.
           MOVE SPACES              TO OPC-MSC-MCVF IN OPC.
           MOVE SPACES              TO OPC-IND-AFER IN OPC.
           MOVE ZEROES              TO OPC-VAL-GAST IN OPC.
           MOVE ZEROES              TO OPC-SGV-LIQU IN OPC.
           MOVE SPACES              TO OPC-COD-RMOC IN OPC.
           MOVE SPACES              TO OPC-COD-INSI IN OPC.
           MOVE SPACES              TO OPC-COD-CDOC IN OPC.
           MOVE ZEROES              TO OPC-VAL-SEGD IN OPC.
           MOVE SPACES              TO OPC-COD-SEGD IN OPC.
       FIN-LIMPIA-NUEVA-OPC.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-DLC SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-DLC.
           MOVE SPACES              TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE SPACES              TO DLC-STP-ITRN IN DLC.
           MOVE ZEROES              TO DLC-FEC-FTRN IN DLC.
           MOVE ZEROES              TO DLC-HRA-HRTR IN DLC.
           MOVE SPACES              TO DLC-MSC-TACC IN DLC.
           MOVE SPACES              TO DLC-MSC-STAT IN DLC.
           MOVE SPACES              TO DLC-COD-OTRN IN DLC.
           MOVE SPACES              TO DLC-COD-ATRN IN DLC.
           MOVE ZEROES              TO DLC-VAL-NDLC IN DLC.
           MOVE ZEROES              TO DLC-VAL-SDLC IN DLC.
           MOVE SPACES              TO DLC-COD-TDOC IN DLC.
           MOVE SPACES              TO DLC-COD-PLZO IN DLC.
           MOVE SPACES              TO DLC-MSC-TIMP IN DLC.
           MOVE ZEROES              TO DLC-VAL-IMPU IN DLC.
           MOVE SPACES              TO DLC-COD-NOTC IN DLC.
           MOVE ZEROES              TO DLC-VAL-GNOT IN DLC.
           MOVE SPACES              TO DLC-IND-SCBZ IN DLC.
           MOVE SPACES              TO DLC-IND-SCRT IN DLC.
           MOVE SPACES              TO DLC-COD-UBFD IN DLC.
           MOVE SPACES              TO DLC-COD-PLZA IN DLC.
           MOVE SPACES              TO DLC-MSC-MIPL IN DLC.
           MOVE SPACES              TO DLC-IND-RIES IN DLC.
           MOVE ZEROES              TO DLC-VAL-READ IN DLC.
           MOVE ZEROES              TO DLC-VAL-INTD IN DLC.
           MOVE ZEROES              TO DLC-FEC-FDEV IN DLC.
           MOVE ZEROES              TO DLC-VAL-SINT IN DLC.
           MOVE ZEROES              TO DLC-VAL-SCPA IN DLC.
           MOVE ZEROES              TO DLC-FEC-FAMT IN DLC.
           MOVE SPACES              TO DLC-CIC-IOCO IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLO IN DLC.
           MOVE ZEROES              TO DLC-VAL-IPEN IN DLC.
           MOVE ZEROES              TO DLC-VAL-DPES IN DLC.
           MOVE SPACES              TO DLC-IND-SCTB IN DLC.
           MOVE ZEROES              TO DLC-FEC-FMAV IN DLC.
           MOVE ZEROES              TO DLC-NUM-VSCE IN DLC.
           MOVE ZEROES              TO DLC-FEC-FSDE IN DLC.
           MOVE ZEROES              TO DLC-VAL-PIMP IN DLC.
           MOVE SPACES              TO DLC-COD-SUSP IN DLC.
           MOVE ZEROES              TO DLC-FEC-FSDM IN DLC.
           MOVE SPACES              TO DLC-GLS-DISP IN DLC.
       FIN-LIMPIA-NUEVA-DLC.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-EVC SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-EVC.
           MOVE SPACES              TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE SPACES              TO EVC-STP-ITRN IN EVC.
           MOVE ZEROES              TO EVC-FEC-FTRN IN EVC.
           MOVE ZEROES              TO EVC-HRA-HRTR IN EVC.
           MOVE SPACES              TO EVC-MSC-TACC IN EVC.
           MOVE SPACES              TO EVC-MSC-STAT IN EVC.
           MOVE SPACES              TO EVC-COD-OTRN IN EVC.
           MOVE SPACES              TO EVC-COD-ATRN IN EVC.
           MOVE ZEROES              TO EVC-NUM-VIGU IN EVC.
           MOVE ZEROES              TO EVC-NUM-VCAN IN EVC.
           MOVE ZEROES              TO EVC-NUM-SEVE IN EVC.
           MOVE SPACES              TO EVC-IND-UTSV IN EVC.
           MOVE ZEROES              TO EVC-FEC-FPVC IN EVC.
           MOVE ZEROES              TO EVC-NUM-DESD IN EVC.
           MOVE ZEROES              TO EVC-SGV-FVAR IN EVC.
           MOVE SPACES              TO EVC-IND-FVAR IN EVC.
           MOVE ZEROES              TO EVC-VAL-VENC IN EVC.
           MOVE SPACES              TO EVC-MSC-TCVE IN EVC.
           MOVE ZEROES              TO EVC-NUM-IVCT IN EVC.
           MOVE ZEROES              TO EVC-NUM-IDLC IN EVC.
           MOVE ZEROES              TO EVC-NUM-DPVE IN EVC.
           MOVE SPACES              TO EVC-IND-CAUT IN EVC.
           MOVE ZEROES              TO EVC-NUM-DURV IN EVC.
           MOVE SPACES              TO EVC-IND-UTDV IN EVC.
           MOVE ZEROES              TO EVC-VAL-VCVF IN EVC.
           MOVE SPACES              TO EVC-GLS-DISP IN EVC.
       FIN-LIMPIA-NUEVA-EVC.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-VEN SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-VEN.
           MOVE SPACES              TO VEN-GLS-FLAG IN VEN.
           MOVE SPACES              TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE SPACES              TO VEN-STP-ITRN IN VEN.
           MOVE ZEROES              TO VEN-NUM-SSTR IN VEN.
           MOVE SPACES              TO VEN-MSC-TACC IN VEN.
           MOVE SPACES              TO VEN-MSC-STAT IN VEN.
           MOVE SPACES              TO VEN-COD-OTRN IN VEN.
           MOVE SPACES              TO VEN-COD-ATRN IN VEN.
           MOVE ZEROES              TO VEN-FEC-FVEN IN VEN.
           MOVE ZEROES              TO VEN-FEC-FIMV IN VEN.
           MOVE ZEROES              TO VEN-VAL-CAPI IN VEN.
           MOVE ZEROES              TO VEN-VAL-SCAP IN VEN.
           MOVE ZEROES              TO VEN-VAL-IDNI IN VEN.
           MOVE ZEROES              TO VEN-VAL-FINA IN VEN.
           MOVE ZEROES              TO VEN-VAL-SFIN IN VEN.
           MOVE SPACES              TO VEN-IND-SCTB IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVCT IN VEN.
           MOVE ZEROES              TO VEN-NUM-IEVC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IDLC IN VEN.
           MOVE SPACES              TO VEN-IND-CAUT IN VEN.
           MOVE SPACES              TO VEN-IND-SCBZ IN VEN.
           MOVE ZEROES              TO VEN-VAL-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-CALC IN VEN.
           MOVE SPACES              TO VEN-IND-CTBA IN VEN.
           MOVE SPACES              TO VEN-GLS-DISP IN VEN.
       FIN-LIMPIA-NUEVA-VEN.
           EXIT.

      ******************************************************************
       LIMPIA-CYA SECTION.
      *------------------
       INI-LIMPIA-CYA.
           MOVE SPACES              TO CYA-GLS-FLAG IN CYA.
           MOVE SPACES              TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE SPACES              TO CYA-STP-ITRN IN CYA.
           MOVE SPACES              TO CYA-MSC-TACC IN CYA.
           MOVE SPACES              TO CYA-MSC-STAT IN CYA.
           MOVE SPACES              TO CYA-COD-OTRN IN CYA.
           MOVE SPACES              TO CYA-COD-ATRN IN CYA.
           MOVE SPACES              TO CYA-IND-TCYA IN CYA.
           MOVE SPACES              TO CYA-CIC-ICYA IN CYA.
           MOVE SPACES              TO CYA-VRF-ICYA IN CYA.
           MOVE ZEROES              TO CYA-SGV-LIQU IN CYA.
           MOVE SPACES              TO CYA-IND-MAUT IN CYA.
           MOVE SPACES              TO CYA-IND-FREE IN CYA.
           MOVE SPACES              TO CYA-COD-OFIC IN CYA.
           MOVE SPACES              TO CYA-GLS-DISP IN CYA.
       FIN-LIMPIA-CYA.
           EXIT.

      ******************************************************************
       LIMPIA-ICG SECTION.
      *------------------
       INI-LIMPIA-ICG.
           MOVE SPACES              TO ICG-GLS-FLAG IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE SPACES              TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE SPACES              TO ICG-STP-ITRN IN ICG.
           MOVE SPACES              TO ICG-MSC-TACC IN ICG.
           MOVE SPACES              TO ICG-MSC-STAT IN ICG.
           MOVE SPACES              TO ICG-COD-OTRN IN ICG.
           MOVE SPACES              TO ICG-COD-ATRN IN ICG.
           MOVE SPACES              TO ICG-COD-TINT IN ICG.
           MOVE ZEROES              TO ICG-FEC-FTER IN ICG.
           MOVE ZEROES              TO ICG-SGV-SPRD IN ICG.
           MOVE ZEROES              TO ICG-SGV-TINT IN ICG.
           MOVE ZEROES              TO ICG-SGV-MNTO IN ICG.
           MOVE SPACES              TO ICG-GLS-DISP IN ICG.
       FIN-LIMPIA-ICG.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-RDC SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-RDC.
           MOVE SPACES              TO RDC-GLS-FLAG IN RDC.
           MOVE SPACES              TO RDC-CIC-ICLI IN RDC.
           MOVE SPACES              TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE SPACES              TO RDC-COD-TRDC IN RDC.
           MOVE SPACES              TO RDC-STP-ITRN IN RDC.
           MOVE SPACES              TO RDC-MSC-TACC IN RDC.
           MOVE SPACES              TO RDC-MSC-STAT IN RDC.
           MOVE SPACES              TO RDC-COD-OTRN IN RDC.
           MOVE SPACES              TO RDC-COD-ATRN IN RDC.
           MOVE ZEROES              TO RDC-NUM-DIRE IN RDC.
           MOVE ZEROES              TO RDC-VAL-LIMD IN RDC.
           MOVE SPACES              TO RDC-GLS-DISP IN RDC.
       FIN-LIMPIA-NUEVA-RDC.
           EXIT.

      ******************************************************************
       BUS-CORR-CAN SECTION.
      *--------------------
       INI-BUS-CORR-CAN.
      * Alternativa 1. Leer Menor o igual (LEQ) a CAN 999. No se puede
      * hacer pruebas en Realia
           MOVE VEN-CIC-IOPC IN VEN TO CAN-CIC-IOPC IN CAN.
           MOVE 999 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = VEN-CIC-IOPC IN VEN AND
              CAN-MSC-STAT IN CAN = 'A'
               ADD 1 TO CAN-NUM-ICAN IN CAN
                        GIVING WSS-NUM-CORR IN WSS-VARI
           ELSE
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = VEN-CIC-IOPC IN VEN
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               GO TO FIN-BUS-CORR-CAN
           ELSE
               MOVE 1 TO WSS-NUM-CORR IN WSS-VARI.

      * Alternativa 2. Buscar ult. CAN y sumarle 1
      *     MOVE 1 TO WSS-NUM-CORR IN WSS-VARI.

      *     MOVE VEN-CIC-IOPC IN VEN TO CAN-CIC-IOPC IN CAN.

      * LUP-BUS-CORR-CAN.
      *     MOVE WSS-NUM-CORR IN WSS-VARI TO CAN-NUM-ICAN IN CAN.
      *     MOVE FIO-GET-NLS TO FIO-CMND.
      *     PERFORM COL-FIO-CAN.

      *     IF NOT (FIO-STAT-OKS AND
      *        VEN-CIC-IOPC IN VEN = CAN-CIC-IOPC IN CAN)
      *         GO TO FIN-BUS-CORR-CAN.

      *     ADD 1 TO WSS-NUM-CORR IN WSS-VARI.
      *     GO TO LUP-BUS-CORR-CAN.
       FIN-BUS-CORR-CAN.
           EXIT.

      ******************************************************************
       LLE-REG-CAN SECTION.
      *-------------------
       INI-LLE-REG-CAN.
           MOVE VEN-CIC-IOPC IN VEN      TO CAN-CIC-IOPC IN CAN.
           MOVE WSS-NUM-CORR IN WSS-VARI TO CAN-NUM-ICAN IN CAN.
           MOVE OPC-COD-RMOC IN OPC      TO CAN-COD-RCAN IN CAN.
           MOVE 'V'                      TO CAN-MSC-STAT IN CAN.

           MOVE 'RTE'                    TO CAN-MSC-CANC IN CAN
           MULTIPLY VEN-VAL-SFIN IN VEN BY WSS-SGV-VCAN IN WSS-VARI
                                         GIVING CAN-SGV-TREN IN CAN.

           MOVE CAN-SGV-TREN IN CAN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TREN IN CAN.

           MOVE WSS-FEC-FFEC IN WSS-VARI TO CAN-FEC-FOUT IN CAN
                                            CAN-FEC-FEGR IN CAN.

           MOVE OPC-COD-OFOC IN OPC      TO CAN-COD-OFCA IN CAN.

           MOVE ZEROES                   TO CAN-SGV-GAST IN CAN
                                            CAN-SGV-TPAG IN CAN
                                            CAN-SGV-DIFE IN CAN
                                            CAN-SGV-IMOK IN CAN.

           MOVE VEN-FEC-FVEN IN VEN      TO CAN-FEC-FCAN IN CAN.

           MOVE HOY-FHOY                 TO CAN-FEC-FTRN IN CAN.
           MOVE HOY-HHOY                 TO CAN-HRA-HRTR IN CAN.
           MOVE 1                        TO CAN-NUM-TVCC IN CAN.
           MOVE 'COLPBTCV'               TO CAN-COD-ATRN IN CAN.
       FIN-LLE-REG-CAN.
           EXIT.

      ******************************************************************
       LLE-REG-ROV SECTION.
      *-------------------
       INI-LLE-REG-ROV.
           PERFORM BUS-NUM-CIC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-LLE-REG-ROV.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CIC NUEVA OPC: ' CIC-CAI-ICIC CIC-IIC-ICIC.

           MOVE CIC-CAI-ICIC        TO ROV-CAI-IOPC IN ROV.
           MOVE CIC-IIC-ICIC        TO ROV-IIC-IOPC IN ROV.

           MOVE CAN-CIC-IOPC IN CAN TO ROV-CIC-IOPV IN ROV.
           MOVE CAN-NUM-ICAN IN CAN TO ROV-NUM-IVCT IN ROV.
           MOVE VEN-VAL-SFIN IN VEN TO ROV-SGV-RENO IN ROV.
           MOVE OPC-COD-VCOC IN OPC TO ROV-COD-VCVR IN ROV.
           MOVE HOY-FHOY            TO ROV-FEC-FTRN IN ROV.
           MOVE HOY-HHOY            TO ROV-HRA-HRTR IN ROV.
       FIN-LLE-REG-ROV.
           EXIT.

      ******************************************************************
       LLE-REG-RCV SECTION.
      *-------------------
       INI-LLE-REG-RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.

           MOVE VEN-NUM-IVCT IN VEN TO RCV-NUM-IVCT IN RCV.
           MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN RCV.
           MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN RCV.

           IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
               MULTIPLY RCV-SGV-CAPI IN RCV BY WSS-SGV-VCOL IN WSS-VARI
                         GIVING WSS-SGV-CAP1 IN WSS-VARI ROUNDED
               MULTIPLY RCV-SGV-CAPI IN RCV BY WSS-SGV-VCAN IN WSS-VARI
                         GIVING WSS-SGV-CAP2 IN WSS-VARI ROUNDED

               MOVE WSS-SGV-CAP1 IN WSS-VARI
                                 TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI
                                 TO WSS-SGV-CAP1 IN WSS-VARI

               MOVE WSS-SGV-CAP2 IN WSS-VARI
                                 TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI
                                 TO WSS-SGV-CAP2 IN WSS-VARI
           ELSE
               MOVE RCV-SGV-CAPI IN RCV TO WSS-SGV-CAP1 IN WSS-VARI
               MOVE RCV-SGV-CAPI IN RCV TO WSS-SGV-CAP2 IN WSS-VARI.

           SUBTRACT WSS-SGV-CAP1 IN WSS-VARI FROM
                   WSS-SGV-CAP2 IN WSS-VARI GIVING RCV-SGV-REAJ IN RCV.

           COMPUTE RCV-SGV-INTN IN RCV = CAN-SGV-TREN IN CAN -
                                         WSS-SGV-CAP1 IN WSS-VARI -
                                         RCV-SGV-REAJ IN RCV.

           MOVE RCV-SGV-INTN IN RCV TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-INTN IN RCV.

           MOVE 'F'                 TO RCV-MSC-MCAN IN RCV.

           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPD IN RCV.
           MOVE VEN-NUM-IDLC IN VEN TO RCV-NUM-IDLC IN RCV.
           MOVE VEN-NUM-IEVC IN VEN TO RCV-NUM-IEVC IN RCV.
           MOVE ZEROES              TO RCV-SGV-INTE IN RCV.
           MOVE ZEROES              TO RCV-SGV-INTM IN RCV.
           MOVE VEN-IND-SCTB IN VEN TO RCV-IND-SCTB IN RCV.
           MOVE CAN-FEC-FCAN IN CAN TO RCV-FEC-FCAN IN RCV.
           MOVE CAN-FEC-FOUT IN CAN TO RCV-FEC-FOUT IN RCV.
           MOVE SPACES              TO RCV-GLS-DISP IN RCV.
           MOVE SPACES              TO RCV-MSC-STAT IN RCV.
           MOVE VEN-IND-SCBZ IN VEN TO RCV-IND-SCBZ IN RCV.
           MOVE HOY-FHOY            TO RCV-FEC-FTRN IN RCV.
           MOVE HOY-HHOY            TO RCV-HRA-HRTR IN RCV.
       FIN-LLE-REG-RCV.
           EXIT.

      ******************************************************************
       LLE-REG-CYA SECTION.
      *-------------------
       INI-LLE-REG-CYA.
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE 'PBCAS'             TO CYA-IND-TCYA IN CYA.
           MOVE SPACES              TO CYA-CIC-ICYA IN CYA.
           MOVE SPACES              TO CYA-IND-MAUT IN CYA.
           MOVE ZEROES              TO CYA-SGV-LIQU IN CYA.
           MOVE SPACES              TO CYA-GLS-FLAG IN CYA.
           MOVE SPACES              TO CYA-VRF-ICYA IN CYA.
           MOVE SPACES              TO CYA-GLS-DISP IN CYA.
           MOVE HOY-FHOY            TO CYA-FEC-FTRN IN CYA.
           MOVE HOY-HHOY            TO CYA-HRA-HRTR IN CYA.
       FIN-LLE-REG-CYA.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-OPC SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-OPC.
           MOVE ROV-CIC-IOPC IN ROV      TO OPC-CIC-IOPC IN OPC.
           MOVE SPACES                   TO OPC-GLS-FLAG IN OPC.
           MOVE 'L'                      TO OPC-MSC-STAT IN OPC.
           MOVE SPACES                   TO OPC-COD-OTRN IN OPC.
           MOVE SPACES                   TO OPC-COD-ATRN IN OPC.
           MOVE 1                        TO OPC-NUM-VCOR IN OPC.
           MOVE 1                        TO OPC-NUM-VCVG IN OPC.
           MOVE ZEROES                   TO OPC-NUM-VCCO IN OPC.
           MOVE ZEROES                   TO OPC-NUM-VCCM IN OPC.
           MOVE ZEROES                   TO OPC-NUM-VCCV IN OPC.
           MOVE ZEROES                   TO OPC-NUM-TVCC IN OPC.
           MOVE PVC-MSC-TCVE IN PVC      TO OPC-MSC-TCVE IN OPC.
           MOVE POC-MSC-BCCR IN POC      TO OPC-MSC-BCCR IN OPC.
           MOVE POC-MSC-VICR IN POC      TO OPC-MSC-VICR IN OPC.
           MOVE SPACES                   TO OPC-COD-AGES IN OPC.
           MOVE SPACES                   TO OPC-GLS-DISP IN OPC.
           MOVE HOY-FHOY                 TO OPC-FEC-FTRN IN OPC.
           MOVE HOY-HHOY                 TO OPC-HRA-HRTR IN OPC.
           MOVE 1                        TO OPC-NUM-IVEN IN OPC.

           MOVE WSS-COD-VCDA IN WSS-VARI TO OPC-COD-COOC IN OPC.
           MOVE WSS-COD-OFOC IN WSS-VARI TO OPC-COD-OFOC IN OPC.
           MOVE POC-COD-VCOC IN POC      TO OPC-COD-VCOC IN OPC.

           MOVE ROV-SGV-RENO IN ROV      TO OPC-VAL-CRED IN OPC
                                            OPC-VAL-SCRE IN OPC.

           MOVE ZEROES                   TO OPC-VAL-SEGP IN OPC
                                            OPC-SGV-VCOM IN OPC
                                            OPC-VAL-GAST IN OPC
                                            OPC-SGV-LIQU IN OPC
                                            OPC-VAL-SEGD IN OPC.

           MOVE SPACES                   TO OPC-CAI-ILDC IN OPC.
           MOVE SPACES                   TO OPC-IIC-ILDC IN OPC.
           MOVE SPACES                   TO OPC-IND-CTBL IN OPC.
           MOVE 'REN'                    TO OPC-IND-RENO IN OPC.
           MOVE SPACES                   TO OPC-CAI-ICEN IN OPC.
           MOVE SPACES                   TO OPC-IIC-ICEN IN OPC.

           MOVE WSS-FEC-FFEC IN WSS-VARI TO OPC-FEC-FINP IN OPC
                                            OPC-FEC-FING IN OPC.

           MOVE CAN-NUM-DCAN IN CAN      TO OPC-NUM-DCOL IN OPC.
           MOVE CAN-NUM-MCAN IN CAN      TO OPC-NUM-MCOL IN OPC.
           MOVE CAN-NUM-SCAN IN CAN      TO OPC-NUM-SCOL IN OPC.
           MOVE CAN-NUM-ACAN IN CAN      TO OPC-NUM-ACOL IN OPC.

           MOVE SPACES                   TO OPC-COD-CVTA IN OPC.
           MOVE WSS-IND-GARA IN WSS-VARI TO OPC-IND-GARA IN OPC.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               MOVE 'S'                  TO OPC-IND-VSTR IN OPC
           ELSE
               MOVE 'N'                  TO OPC-IND-VSTR IN OPC.

           MOVE POC-MSC-MCVF IN POC      TO OPC-MSC-MCVF IN OPC.
      *ALD-BCI-INI/11-11-1998
           IF WSS-IND-AFER IN WSS-VARI = 'S'
               MOVE 'S'                  TO OPC-IND-AFER IN OPC
           ELSE
               MOVE 'N'                  TO OPC-IND-AFER IN OPC.
      *    MOVE 'S'                      TO OPC-IND-AFER IN OPC.
      *ALD-BCI-FIN/11-11-1998
           MOVE WSS-COD-RMOC IN WSS-VARI TO OPC-COD-RMOC IN OPC.
           MOVE SPACES                   TO OPC-COD-INSI IN OPC.
           MOVE WSS-COD-CDOC IN WSS-VARI TO OPC-COD-CDOC IN OPC.
           MOVE POC-COD-SEGD IN POC      TO OPC-COD-SEGD IN OPC.
       FIN-LLE-REG-NUEVA-OPC.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-DLC SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-DLC.
           MOVE OPC-CIC-IOPC IN OPC      TO DLC-CIC-IOPC IN DLC.
           MOVE 1                        TO DLC-NUM-IDLC IN DLC.
           MOVE HOY-FHOY                 TO DLC-FEC-FTRN IN DLC.
           MOVE HOY-HHOY                 TO DLC-HRA-HRTR IN DLC.
           MOVE SPACES                   TO DLC-MSC-TACC IN DLC.
           MOVE SPACES                   TO DLC-MSC-STAT IN DLC.
           MOVE SPACES                   TO DLC-COD-OTRN IN DLC.
           MOVE SPACES                   TO DLC-COD-ATRN IN DLC.

           MOVE OPC-VAL-CRED IN OPC      TO DLC-VAL-NDLC IN DLC
                                            DLC-VAL-SDLC IN DLC.

           MOVE OPC-VAL-SCRE IN OPC      TO DLC-VAL-SCPA IN DLC.

           MOVE ZEROES                   TO DLC-VAL-IMPU IN DLC
                                            DLC-VAL-GNOT IN DLC
                                            DLC-VAL-READ IN DLC
                                            DLC-VAL-INTD IN DLC
                                            DLC-VAL-SINT IN DLC
                                            DLC-VAL-IPEN IN DLC
                                            DLC-VAL-DPES IN DLC
                                            DLC-VAL-PIMP IN DLC.

           MOVE POC-COD-TDOC IN POC      TO DLC-COD-TDOC IN DLC.
           MOVE WSS-COD-PLZO IN WSS-VARI TO DLC-COD-PLZO IN DLC.
           MOVE 'E'                      TO DLC-MSC-TIMP IN DLC.
           MOVE SPACES                   TO DLC-COD-NOTC IN DLC.
           MOVE SPACES                   TO DLC-IND-SCBZ IN DLC.
           MOVE SPACES                   TO DLC-IND-SCRT IN DLC.
           MOVE SPACES                   TO DLC-COD-UBFD IN DLC.
           MOVE SPACES                   TO DLC-COD-PLZA IN DLC.
           MOVE POC-MSC-MIPL IN POC      TO DLC-MSC-MIPL IN DLC.
           MOVE SPACES                   TO DLC-IND-RIES IN DLC.
           MOVE OPC-FEC-FCOL IN OPC      TO DLC-FEC-FDEV IN DLC.

           MOVE OPC-FEC-FCOL IN OPC      TO DLC-FEC-FAMT IN DLC.
           MOVE DLC-CIC-IOPC IN DLC      TO DLC-CIC-IOCO IN DLC.
           MOVE DLC-NUM-IDLC IN DLC      TO DLC-NUM-IDLO IN DLC.
           MOVE 'CAS'                    TO DLC-IND-SCTB IN DLC.
           MOVE OPC-FEC-FCOL IN OPC      TO DLC-FEC-FMAV IN DLC.
           MOVE ZEROES                   TO DLC-NUM-VSCE IN DLC.
           MOVE ZEROES                   TO DLC-FEC-FSDE IN DLC.
           MOVE SPACES                   TO DLC-COD-SUSP IN DLC.
           MOVE ZEROES                   TO DLC-FEC-FSDM IN DLC.
           MOVE SPACES                   TO DLC-GLS-DISP IN DLC.
      *INI-JGM 19-MAR-1998.
           IF WSS-IND-SCTZ IN WSS-VARI = 'NIS'
              MOVE 'NIS' TO  DLC-IND-SCBZ IN DLC.
      *FIN-JGM 19-MAR-1998.
       FIN-LLE-REG-NUEVA-DLC.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-EVC SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-EVC.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE 1                   TO EVC-NUM-IEVC IN EVC.
           MOVE HOY-FHOY            TO EVC-FEC-FTRN IN EVC.
           MOVE HOY-HHOY            TO EVC-HRA-HRTR IN EVC.
           MOVE SPACES              TO EVC-MSC-TACC IN EVC.
           MOVE SPACES              TO EVC-MSC-STAT IN EVC.
           MOVE SPACES              TO EVC-COD-OTRN IN EVC.
           MOVE SPACES              TO EVC-COD-ATRN IN EVC.
           MOVE 1                   TO EVC-NUM-VIGU IN EVC.
           MOVE 0                   TO EVC-NUM-VCAN IN EVC.
           MOVE ZEROES              TO EVC-NUM-SEVE IN EVC.
           MOVE SPACES              TO EVC-IND-UTSV IN EVC.
           MOVE CAN-FEC-FCAN IN CAN TO EVC-FEC-FPVC IN EVC.
           MOVE ZEROES              TO EVC-NUM-DESD IN EVC.
           MOVE ZEROES              TO EVC-SGV-FVAR IN EVC.
           MOVE SPACES              TO EVC-IND-FVAR IN EVC.
           MOVE ZEROES              TO EVC-VAL-VENC IN EVC.
           MOVE PVC-MSC-TCVE IN PVC TO EVC-MSC-TCVE IN EVC.
           MOVE 1                   TO EVC-NUM-IVCT IN EVC.
           MOVE 1                   TO EVC-NUM-IDLC IN EVC.
           MOVE ZEROES              TO EVC-NUM-DPVE IN EVC.
           MOVE POC-IND-CAUT IN POC TO EVC-IND-CAUT IN EVC.
           MOVE ZEROES              TO EVC-NUM-DURV IN EVC.
           MOVE SPACES              TO EVC-IND-UTDV IN EVC.

           MOVE VEN-VAL-CAPI IN VEN TO EVC-VAL-VCVF IN EVC.

           MOVE SPACES              TO EVC-GLS-DISP IN EVC.
       FIN-LLE-REG-NUEVA-EVC.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-VEN SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-VEN.
           MOVE SPACES              TO VEN-GLS-FLAG IN VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.

           MOVE HOY-FHOY            TO VEN-FEC-FTRN IN VEN.
           MOVE HOY-HHOY            TO VEN-HRA-HRTR IN VEN.

           MOVE ZEROES              TO VEN-NUM-SSTR IN VEN.
           MOVE SPACES              TO VEN-MSC-TACC IN VEN.
           MOVE SPACES              TO VEN-MSC-STAT IN VEN.
           MOVE SPACES              TO VEN-COD-OTRN IN VEN.
           MOVE SPACES              TO VEN-COD-ATRN IN VEN.
           MOVE OPC-FEC-FCOL IN OPC TO VEN-FEC-FVEN IN VEN.
           MOVE OPC-FEC-FCOL IN OPC TO VEN-FEC-FIMV IN VEN.

      *ALD-BCI-INI/20-08-1998 VALIDA SI TIENE CAN ANTERIORES PARA FIMV
           IF WSS-FEC-FMVE IN WSS-VARI > ZEROES
               MOVE WSS-NUM-SMVE TO VEN-NUM-SIMV IN VEN
               MOVE WSS-NUM-AMVE TO VEN-NUM-AIMV IN VEN
               MOVE WSS-NUM-MMVE TO VEN-NUM-MIMV IN VEN
               MOVE WSS-NUM-DMVE TO VEN-NUM-DIMV IN VEN.
      *ALD-BCI-FIN/20-08-1998

           MOVE OPC-VAL-CRED IN OPC TO VEN-VAL-CAPI IN VEN.
           MOVE OPC-VAL-CRED IN OPC TO VEN-VAL-SCAP IN VEN.
           MOVE ZEROES              TO VEN-VAL-IDNI IN VEN.
           MOVE OPC-VAL-CRED IN OPC TO VEN-VAL-FINA IN VEN.
           MOVE OPC-VAL-CRED IN OPC TO VEN-VAL-SFIN IN VEN.
           MOVE SPACES              TO VEN-IND-SCTB IN VEN.
           MOVE 1                   TO VEN-NUM-IVCT IN VEN.
           MOVE 1                   TO VEN-NUM-IEVC IN VEN.
           MOVE 1                   TO VEN-NUM-IDLC IN VEN.
           MOVE SPACES              TO VEN-IND-CAUT IN VEN.
           MOVE SPACES              TO VEN-IND-SCBZ IN VEN.
           MOVE ZEROES              TO VEN-VAL-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-CALC IN VEN.
           MOVE SPACES              TO VEN-IND-CTBA IN VEN.
           MOVE SPACES              TO VEN-GLS-DISP IN VEN.
       FIN-LLE-REG-NUEVA-VEN.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-CYA SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-CYA.
           MOVE SPACES                   TO CYA-GLS-FLAG IN CYA.
           MOVE OPC-CIC-IOPC IN OPC      TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES                   TO CYA-NUM-ICAN IN CYA.
           MOVE 1                        TO CYA-NUM-ICYA IN CYA.
           MOVE HOY-FHOY                 TO CYA-FEC-FTRN IN CYA.
           MOVE HOY-HHOY                 TO CYA-HRA-HRTR IN CYA.
           MOVE SPACES                   TO CYA-MSC-TACC IN CYA.
           MOVE SPACES                   TO CYA-MSC-STAT IN CYA.
           MOVE SPACES                   TO CYA-COD-OTRN IN CYA.
           MOVE SPACES                   TO CYA-COD-ATRN IN CYA.
           MOVE 'PBCAS'                  TO CYA-IND-TCYA IN CYA.
           MOVE SPACES                   TO CYA-CIC-ICYA IN CYA.
           MOVE SPACES                   TO CYA-VRF-ICYA IN CYA.
           MOVE ZEROES                   TO CYA-SGV-LIQU IN CYA.
           MOVE SPACES                   TO CYA-IND-MAUT IN CYA.
           MOVE SPACES                   TO CYA-IND-FREE IN CYA.
           MOVE SPACES                   TO CYA-COD-OFIC IN CYA.
           MOVE SPACES                   TO CYA-GLS-DISP IN CYA.
       FIN-LLE-REG-NUEVA-CYA.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-ICG SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-ICG.
           MOVE SPACES              TO ICG-GLS-FLAG IN ICG.
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE HOY-FHOY            TO ICG-FEC-FTRN IN ICG.
           MOVE HOY-HHOY            TO ICG-HRA-HRTR IN ICG.
           MOVE POC-COD-TINT IN POC TO ICG-COD-TINT IN ICG.
           MOVE SPACES              TO ICG-MSC-TACC IN ICG.
           MOVE SPACES              TO ICG-MSC-STAT IN ICG.
           MOVE SPACES              TO ICG-COD-OTRN IN ICG.
           MOVE SPACES              TO ICG-COD-ATRN IN ICG.
           MOVE ZEROES              TO ICG-FEC-FTER IN ICG.
           MOVE ZEROES              TO ICG-SGV-SPRD IN ICG.
           MOVE ZEROES              TO ICG-SGV-TINT IN ICG.
           MOVE ZEROES              TO ICG-SGV-MNTO IN ICG.
           MOVE SPACES              TO ICG-GLS-DISP IN ICG.
       FIN-LLE-REG-NUEVA-ICG.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-RDC SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-RDC.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO RDC-CIC-IOPC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE ZEROES TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              WSS-CIC-IOPC IN WSS-VARI = RDC-CIC-IOPC IN RDC )
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLRDC: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'OPC  NORDC'             TO ERC-COD-MSGE IN ERC
               MOVE WSS-CIC-IOPC IN WSS-VARI TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LLE-REG-NUEVA-RDC.

       LUP-LLE-REG-NUEVA-RDC.
           MOVE OPC-CIC-IOPC IN OPC      TO RDC-CIC-IOPC IN RDC.
           MOVE HOY-FHOY                 TO RDC-FEC-FTRN IN RDC.
           MOVE HOY-HHOY                 TO RDC-HRA-HRTR IN RDC.
           MOVE WSS-NUM-DIRE IN WSS-VARI TO RDC-NUM-DIRE IN RDC.
           MOVE 100                      TO RDC-VAL-LIMD IN RDC.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA RDC: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'RDCNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LLE-REG-NUEVA-RDC.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'NUEVO REG. RDC INGRESADO: '
                                   RDC-KEY-IREG IN RDC.

           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO RDC-CIC-IOPC IN RDC.
           ADD 1 TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              WSS-CIC-IOPC IN WSS-VARI = RDC-CIC-IOPC IN RDC
               GO TO LUP-LLE-REG-NUEVA-RDC.

       FIN-LLE-REG-NUEVA-RDC.
           EXIT.

      ******************************************************************
       OBT-DIA-HBL SECTION.
      *-------------------
       INI-OBT-DIA-HBL.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DMIN IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MMIN IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SMIN IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-AMIN IN WSS-VARI.

           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.

           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-SIG-HBL         TO FEC-CMND.
           PERFORM CAL-FEC.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DMAX IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MMAX IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SMAX IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-AMAX IN WSS-VARI.

       NXT-OBT-DIA-HBL.
           MOVE WSS-NUM-DMAX IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MMAX IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SMAX IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-AMAX IN WSS-VARI TO FEC-ITM4.

           MOVE FEC-FORM-FEC             TO FEC-FORM.
           MOVE FEC-RST-DIA              TO FEC-CMND.
           MOVE WSS-NUM-DTAC IN WSS-VARI TO FEC-NDIA.
           PERFORM CAL-FEC.

           IF WSS-FEC-FMIN IN WSS-VARI = WSS-FEC-FMAX IN WSS-VARI
               MOVE FEC-ITM1 TO WSS-NUM-DMIN IN WSS-VARI
                                WSS-NUM-DMAX IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-NUM-MMIN IN WSS-VARI
                                WSS-NUM-MMAX IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-NUM-SMIN IN WSS-VARI
                                WSS-NUM-SMAX IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-NUM-AMIN IN WSS-VARI
                                WSS-NUM-AMAX IN WSS-VARI
           ELSE
               MOVE FEC-ITM1 TO WSS-NUM-DMAX IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-NUM-MMAX IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-NUM-SMAX IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-NUM-AMAX IN WSS-VARI

               MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH
               MOVE FEC-FORM-FEC             TO FEC-FORM
               MOVE FEC-RST-DIA              TO FEC-CMND
               MOVE WSS-NUM-DTAC IN WSS-VARI TO FEC-NDIA
               PERFORM CAL-FEC
               MOVE FEC-ITM1 TO WSS-NUM-DMIN IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-NUM-MMIN IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-NUM-SMIN IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-NUM-AMIN IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'COTA INFERIOR RANGO: '
                                      WSS-FEC-FMIN IN WSS-VARI
               DISPLAY 'COTA SUPERIOR RANGO: '
                                      WSS-FEC-FMAX IN WSS-VARI.
       FIN-OBT-DIA-HBL.
           EXIT.

      ******************************************************************
       BUS-NUM-CIC SECTION.
      *-------------------
       INI-BUS-NUM-CIC.
      *ALD-BCI-INI/19.01.1999
           MOVE ADR-OPC-REQA        TO ADR-AUX-REQA.
       LUP-BUS-NUM-CIC.
      *ALD-BCI-FIN/19.01.1999
           MOVE 'D'                 TO CIC-COD-TCIC IN CIC.
           MOVE CAN-COD-OFCA IN CAN TO CIC-COD-CCIC IN CIC.
           MOVE CIC-GET             TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               DISPLAY 'NO EXISTE CORRELATIVO EN TABLA CIC: '
                                  CIC-COD-TCIC IN CIC
                                  CIC-COD-CCIC IN CIC
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               MOVE 'CORR   NEX'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-BUS-NUM-CIC
           ELSE
               MOVE CIC-CIC-ICIC IN CIC TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
      *ALD-BCI-INI/19.01.1999
      *            GO TO INI-BUS-NUM-CIC
                   GO TO LUP-BUS-NUM-CIC
      *ALD-BCI-FIN/19.01.1999
               ELSE
                   MOVE ADR-AUX-REQA TO ADR-OPC-REQA
                   MOVE FIO-KDEF-S   TO FIO-KDEF
                   MOVE FIO-GET-KEY  TO FIO-CMND
                   PERFORM COL-FIO-OPC.
       FIN-BUS-NUM-CIC.
           EXIT.

      ******************************************************************
       CLOSE-FILE SECTION.
      *------------------
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-ROV.
           PERFORM COL-FIO-POC.
           PERFORM COL-FIO-PVC.

           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-EVC.
           PERFORM COL-FIO-RDC.
           PERFORM COL-FIO-ERC.
           PERFORM SGC-FIO-DBC.
       FIN-CLOSE-FILE.
           EXIT.

      ******************************************************************
       MUESTRA-ESTADISTICAS SECTION.
      *----------------------------
       INI-MUESTRA-ESTADISTICAS.
           DISPLAY 'ESTADISTICAS.'.
           DISPLAY '-------------'.
           DISPLAY ' '.
           DISPLAY 'REGISTROS VEN LEIDOS           : '
                                 WSS-NUM-RLEI IN WSS-VARI.
           DISPLAY 'REGISTROS VEN ERRONEOS         : '
                                 WSS-NUM-RRCH IN WSS-VARI.
           DISPLAY 'REGISTROS VEN NO SELECCIONADOS : '
                                 WSS-NUM-RNSE IN WSS-VARI.
           DISPLAY 'REGISTROS CAN INGRESADOS       : '
                                 WSS-NUM-RGRA IN WSS-VARI.
           DISPLAY 'REGISTROS CAN NO INGRESADOS    : '
                                 WSS-NUM-RNIN IN WSS-VARI.
           DISPLAY 'REGISTROS OPC INGRESADOS       : '
                                 WSS-NUM-ROIN IN WSS-VARI.
           DISPLAY 'REGISTROS OPC NO INGRESADOS    : '
                                 WSS-NUM-RONI IN WSS-VARI.
           DISPLAY 'REGISTROS CAN ACTIVADOS        : '
                                 WSS-NUM-RACT IN WSS-VARI.
           DISPLAY 'REGISTROS CAN NO ACTIVADOS     : '
                                 WSS-NUM-RNAC IN WSS-VARI.
           DISPLAY 'REGISTROS OPC ACTIVADOS        : '
                                 WSS-NUM-ROAC IN WSS-VARI.
           DISPLAY 'REGISTROS OPC NO ACTIVADOS     : '
                                 WSS-NUM-RONA IN WSS-VARI.
       FIN-MUESTRA-ESTADISTICAS.
           EXIT.

      ******************************************************************
       COPY COLBFERC.
       COPY COLBFVEN.
       COPY COLBFOPC.
       COPY COLBFCAN.
       COPY COLBFRCV.
       COPY COLBFCYA.
       COPY COLBFICG.
       COPY COLBFROV.
       COPY COLBFTOC.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFRDC.
       COPY COLBFRDT.
       COPY COLBFPOC.
       COPY COLBFPVC.

       COPY SGCBFDBC.

       COPY TABBVOFI.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY TABBFCAM.
       COPY GNSBFTAB.
       COPY TABBFOFI.
       COPY GNSBFCIC.
       COPY TABBFUSR.

       COPY COLBGVEN.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBGCAM.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGPES.
       COPY COLBGINT.
       COPY COLB4CAN.

      ******************************************************************
      * COPY COLB5CAN.
      * El COLB5CAN del proyecto tiene cambios en la RDT para el
      * Traspaso a Cartera definitivo y no sirve, por lo que se
      * tuvo que expandir, pero en Desarrollo del BCI sirve el
      * copy que tienen ellos.
      ******************************************************************
       PRO-RCV SECTION.
       INI-PRO-RCV.
           MOVE ZEROES TO WSS-VAL-SMO1.
           MOVE ZEROES TO WSS-VAL-SMO2.
      *LEER RCV.
           MOVE CAN-CAI-IOPC IN CAN TO RCV-CAI-IOPC IN RCV.
           MOVE CAN-IIC-IOPC IN CAN TO RCV-IIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.
      *OJO
           MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV.
      *
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RCV.

           IF RCV-NUM-IVCT IN RCV > ZEROES
               MOVE RCV-KEY-IVCT IN RCV TO VEN-KEY-IVEN IN VEN
               PERFORM PRO-VEN
               MOVE VEN-NUM-IDLC IN VEN TO WSS-NUM-IDLC
      *         MOVE RCV-NUM-IDLC IN RCV TO WSS-NUM-IDLC
               ADD  RCV-SGV-CAPI IN RCV TO WSS-SGV-CAPD(WSS-NUM-IDLC)
               ADD  RCV-SGV-FINA IN RCV TO WSS-SGV-FINA(WSS-NUM-IDLC)
      *DAD ini  28-ABR-1992   (Memo.13-03-92 pto.5) / 22-OCT-1991
               IF SCR-CMND = 'REV' AND
                  ( CAN-MSC-FCAN IN CAN NOT = 'I' AND
                    CAN-MSC-FCAN IN CAN NOT = 'P' )
      *DAD fin  28-ABR-1992
                   SUBTRACT 1 FROM WSS-NUM-VCVG IN WSS-VARI
                   IF RCV-IND-SCTB = 'VCD'
                       SUBTRACT 1 FROM WSS-NUM-VCCV IN WSS-VARI
                   ELSE
                       IF RCV-MSC-MCAN IN RCV = 'V'
                           SUBTRACT 1 FROM WSS-NUM-VCCM IN WSS-VARI
                       ELSE
                           SUBTRACT 1 FROM WSS-NUM-VCCO IN WSS-VARI
               ELSE
      *DAD fin  22-OCT-1991
               IF VEN-VAL-SFIN IN VEN NOT > ZEROES
                   ADD 1 TO WSS-NUM-VCVG IN WSS-VARI
      *             ADD 1 TO CAN-NUM-TVCC IN CAN
                   IF RCV-IND-SCTB = 'VCD'
                       ADD 1 TO WSS-NUM-VCCV IN WSS-VARI
                   ELSE
                       IF RCV-MSC-MCAN IN RCV = 'V'
                           ADD 1 TO WSS-NUM-VCCM IN WSS-VARI
                       ELSE
                           ADD 1 TO WSS-NUM-VCCO IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE ZEROES TO WSS-NUM-IDLC.
           ADD  RCV-SGV-CAPI IN RCV TO WSS-SGV-CAPD(500).
           ADD  RCV-SGV-FINA IN RCV TO WSS-SGV-FINA(500).
           PERFORM PRO-OPE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-RCV.

           IF WSS-NUM-IDLC > ZEROES
               MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC
               PERFORM PRO-DOC VARYING WSS-NUM-IDLC FROM 1 BY 1
                               UNTIL   WSS-NUM-IDLC > 499.
      *
      *Despues de procesar Vencimiento cancelado, Operacion y Documentos
      *genera siguiente vencimiento para creditos con EVC ( si correspon
      *es decir cuando cancelo totalmente el vencimiento, aun queda sald
      *del credito y el comando no es reversa
               IF ( VEN-VAL-SFIN IN VEN NOT > ZEROES ) AND
                  ( OPC-VAL-SCRE IN OPC > ZEROES )     AND
                  ( SCR-CMND NOT = 'REV' )
                   IF OPC-IND-VSTR IN OPC = 'S'
                       PERFORM GEN-SIG-VEN-EVC
                   ELSE
                       PERFORM GEN-SIG-VEN-VEN
               ELSE
      *Si se reversa una morosa se debe generar el vencimiento siguiente
      *con VEN-NUM-IVEN = 2
               IF ( SCR-CMND = 'REV' AND VEN-IND-SCTB IN VEN = 'MOR'
      *DAD ini  23-DEC-1991   (Memo.05-09-91 Pto.1)
                    AND OPC-IND-VSTR IN OPC = 'S' )
      *DAD fin  23-DEC-1991
      *DAD ini  20-OCT-1992   (Memo.08-10-92)
                   MOVE SPACES TO MSG-COD-MENS
                   PERFORM ACT-VEN-SHFT-REV
                   IF MSG-COD-MENS NOT > SPACES
      *DAD fin  20-OCT-1992
                   MOVE  OPC-CIC-IOPC IN OPC TO     VEN-CIC-IOPC IN VEN
                   ADD 1 VEN-NUM-IVCT IN VEN GIVING VEN-NUM-IVEN IN VEN
                   MOVE OPC-NUM-DCOL IN OPC TO VEN-DTBS
                   MOVE OPC-NUM-MCOL IN OPC TO VEN-MTBS
                   MOVE OPC-NUM-SCOL IN OPC TO VEN-STBS
                   MOVE OPC-NUM-ACOL IN OPC TO VEN-ATBS
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-OBT-VEN
                   IF NOT VEN-STAT-OKS
                       MOVE SPACES TO MSG-COD-MENS
                       GO TO FIN-PRO-RCV
                   ELSE
                       MOVE 2 TO VEN-NUM-IVEN IN VEN
                       MOVE VEN TO VEN-BKP
                       MOVE FIO-GET-KEY-UPD TO FIO-CMND
                       PERFORM COL-FIO-VEN
                       IF NOT FIO-STAT-OKS
                           MOVE VEN-BKP TO VEN
      *DAD ini  20-OCT-1992   (Memo.08-10-92)
                           PERFORM PUT-VEN-IND-SCTB
      *DAD fin  20-OCT-1992
                           MOVE FIO-PUT TO FIO-CMND
                           PERFORM COL-FIO-VEN
                           MOVE SPACES TO MSG-COD-MENS
                       ELSE
                           MOVE VEN-BKP TO VEN
      *DAD ini  20-OCT-1992   (Memo.08-10-92)
                           PERFORM PUT-VEN-IND-SCTB
      *DAD fin  20-OCT-1992
                           MOVE FIO-MOD TO FIO-CMND
                           PERFORM COL-FIO-VEN
                           MOVE SPACES TO MSG-COD-MENS.
       FIN-PRO-RCV.
           EXIT.
      *-----------------------------------------------------------------
      *DAD ini  20-OCT-1992   (Memo.08-10-92)
       ACT-VEN-SHFT-REV SECTION.
       INI-ACT-VEN-SHFT-REV.
      * Lee fisicamente el Ultimo VEN
           MOVE 999 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN AND
                    VEN-NUM-IVEN IN VEN NOT = 1 )
               GO TO FIN-ACT-VEN-SHFT-REV.
       LUP-ACT-VEN-SHFT-REV.
      * Elimina el VEN tomado de UPD previamente Respaldado
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENSHFTNOUPD' TO MSG-COD-MENS
               GO TO FIN-ACT-VEN-SHFT-REV.
           MOVE VEN-NUM-IVEN IN VEN TO WSS-AUX-IVEN.
           MOVE VEN TO VEN-BKP.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENSHFTNODEL' TO MSG-COD-MENS
               GO TO FIN-ACT-VEN-SHFT-REV.
      * Graba el VEN Respaldado luego de Actualizar
           MOVE VEN-BKP TO VEN.
           ADD 1 TO WSS-AUX-IVEN
           MOVE WSS-AUX-IVEN TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENSHFTNOPUT' TO MSG-COD-MENS
               GO TO FIN-ACT-VEN-SHFT-REV.
           MOVE VEN-BKP TO VEN.
      * Lee fisicamente el Anterior VEN
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN AND
                    VEN-NUM-IVEN IN VEN NOT = 1 )
               GO TO FIN-ACT-VEN-SHFT-REV.
           GO TO LUP-ACT-VEN-SHFT-REV.
       FIN-ACT-VEN-SHFT-REV.
           EXIT.
      *DAD fin  20-OCT-1992
      *-----------------------------------------------------------------
      ******************************************************************
       PRO-VEN SECTION.
       INI-PRO-VEN.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM PRO-VEN-NSTR
           ELSE
               PERFORM PRO-VEN-SSTR.
       FIN-PRO-VEN.
           EXIT.
      *-----------------------------------------------------------------
       PRO-VEN-NSTR SECTION.
       INI-PRO-VEN-NSTR.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    NEX' TO MSG-COD-MENS
               GO TO FIN-PRO-VEN-NSTR.
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FAMT.
      *
           IF SCR-CMND = 'REV'
               MOVE RCV-SGV-CAPI IN RCV TO WSS-VAL-SMO1
               MOVE RCV-SGV-FINA IN RCV TO WSS-VAL-SMO2
           ELSE
      *DAD ini  29-ABR-1993   (Memo.02-10-92)
      *         MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SMO1
      *         MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SMO2.
               MOVE RCV-SGV-CAPI IN RCV TO WSS-VAL-SMO1
               MOVE RCV-SGV-FINA IN RCV TO WSS-VAL-SMO2.
      *DAD fin  29-ABR-1993
           PERFORM ACT-SFIN-SCAP-VEN.
       FIN-PRO-VEN-NSTR.
           EXIT.
      *-----------------------------------------------------------------
       PRO-VEN-SSTR SECTION.
       INI-PRO-VEN-SSTR.
      *Si el comando es Reversa pide a traves de GET-VEN-REA el vencimie
      *correspondiente a la cancelacion a reversar
           IF SCR-CMND = 'REV'
               PERFORM GET-VEN-REA
               IF NOT FIO-STAT-OKS
                   MOVE VEN-STAT TO MSG-COD-MENS
                   MOVE VEN-MEN2 TO FRM-MENS
                   GO TO FIN-PRO-VEN-SSTR
               ELSE
      *            Respalda el vencimiento que se reversa
                   MOVE VEN TO VEN-BKP
      *            Actualiza Estructuras y Documentos
                   PERFORM ACT-REVC-RDLC.
      *
           MOVE 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    NEX' TO MSG-COD-MENS
               GO TO FIN-PRO-VEN-SSTR.

      *DAD ini  20-OCT-1992   (Memo.08-10-92)
           MOVE SPACES TO WSS-IND-SCTB
                          WSS-IND-SCBZ.
           MOVE VEN-IND-SCTB IN VEN TO WSS-IND-SCTB.
           MOVE VEN-IND-SCBZ IN VEN TO WSS-IND-SCBZ.
      *DAD fin  20-OCT-1992
      *
           IF SCR-CMND = 'REV'
               MOVE VEN-BKP TO VEN
               MOVE 1 TO VEN-NUM-IVEN IN VEN.
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FAMT.
      *
           IF SCR-CMND = 'REV'
               MOVE RCV-SGV-CAPI IN RCV TO WSS-VAL-SMO1
               MOVE RCV-SGV-FINA IN RCV TO WSS-VAL-SMO2
           ELSE
      *DAD ini  29-ABR-1993   (Memo.02-10-92)
      *         MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SMO1
      *         MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SMO2.
               MOVE RCV-SGV-CAPI IN RCV TO WSS-VAL-SMO1
               MOVE RCV-SGV-FINA IN RCV TO WSS-VAL-SMO2.
      *DAD fin  29-ABR-1993
           PERFORM ACT-SFIN-SCAP-VEN.
       FIN-PRO-VEN-SSTR.
           EXIT.
      *-----------------------------------------------------------------
       ACT-SFIN-SCAP-VEN SECTION.
       INI-ACT-SFIN-SCAP-VEN.
      *Rebaja SCAP y SFIN del vencimiento que esta cancelando
      *
           IF RCV-SGV-CAPI IN RCV > VEN-VAL-SCAP IN VEN
               MOVE ZEROES TO VEN-VAL-SCAP IN VEN
           ELSE
               SUBTRACT RCV-SGV-CAPI IN RCV FROM VEN-VAL-SCAP IN VEN.
      *
           IF RCV-SGV-FINA IN RCV > VEN-VAL-SFIN IN VEN
               MOVE ZEROES TO VEN-VAL-SFIN IN VEN
           ELSE
               SUBTRACT RCV-SGV-FINA IN RCV FROM VEN-VAL-SFIN IN VEN.
      *
      *No se pueden pagar parcialidades de VEN que fuerom estimados,
      *por lo tanto :
           IF SCR-CMND NOT = 'REV'
               IF RCV-MSC-STAT IN RCV = 'C' OR 'F'
                   MOVE ZEROES TO VEN-VAL-SCAP IN VEN
                   MOVE ZEROES TO VEN-VAL-SFIN IN VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               IF RCV-MSC-STAT IN RCV = 'C'
                   MOVE ZEROES TO VEN-VAL-SCAP IN VEN
               ELSE
               IF RCV-MSC-STAT IN RCV = 'F'
                   MOVE ZEROES TO VEN-VAL-SFIN IN VEN.
      *
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    BCK' TO MSG-COD-MENS.
       FIN-ACT-SFIN-SCAP-VEN.
           EXIT.
      ******************************************************************
       GEN-SIG-VEN-EVC SECTION.
       INI-GEN-SIG-VEN-EVC.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-VENC.
           MOVE VEN-NUM-IEVC IN VEN TO WSS-NUM-IEVC.
      *Lee fisicamente el VEN=1 ( el que se cancelo )
           MOVE 1 TO VEN-NUM-IVEN IN VEN.
      *LRH ini 9-ABR-1994
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM COL-FIO-VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN AND
                    1                   = VEN-NUM-IVEN IN VEN )
                   MOVE 'VEN    NEX' TO MSG-COD-MENS
                   GO TO FIN-GEN-SIG-VEN-EVC.
      *LRH fin 9-ABR-1994
           ADD 1 VEN-NUM-IVCT IN VEN GIVING WSS-AUX-IVEN.
      *DAD ini  31-MAY-1993
      **DAD ini  20-OCT-1992   (Memo.08-10-92)
      *     MOVE SPACES TO WSS-IND-SCTB
      *                    WSS-IND-SCBZ.
      **DAD fin  20-OCT-1992
      *DAD fin  31-MAY-1993
      *Busca si existe un VEN siguiente para eliminarlo ( ya que el
      *que se cancela puede estar moroso y en ese caso existe uno o mas
      *vencimientos fisicos adicionales )
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-VEN
      *DAD ini  31-MAY-1993
               IF FIO-STAT-OKS
      *Respalda el VEN leido antes de eliminarlo
                   MOVE VEN TO VEN-BKP
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM COL-FIO-VEN
                   IF FIO-STAT-OKS
                       MOVE 'S' TO WSS-IND-EXIS
                   ELSE
                       MOVE 'VEN    NODEL' TO MSG-COD-MENS
                       GO TO FIN-GEN-SIG-VEN-EVC
               ELSE
                   MOVE 'VEN    NOGKU' TO MSG-COD-MENS
                   GO TO FIN-GEN-SIG-VEN-EVC
           ELSE
               MOVE 'N' TO WSS-IND-EXIS.
      **DAD ini  20-OCT-1992   (Memo.08-10-92)
      *         IF VEN-NUM-IVCT IN VEN = WSS-AUX-IVEN
      *             MOVE VEN-IND-SCTB IN VEN TO WSS-IND-SCTB
      *             MOVE VEN-IND-SCBZ IN VEN TO WSS-IND-SCBZ
      *             MOVE FIO-DEL TO FIO-CMND
      *             PERFORM COL-FIO-VEN
      *         ELSE
      **DAD fin  20-OCT-1992
      *             MOVE FIO-DEL TO FIO-CMND
      *             PERFORM COL-FIO-VEN.
      *DAD fin  31-MAY-1993
      *
      *Pide a la rutina de expansion generar el siguiente vencimiento
      *al cancelado ( Asume la FCOL para poder generarlo con mayor
      *probabilidad )
           MOVE OPC-CIC-IOPC IN OPC      TO     VEN-CIC-IOPC IN VEN.
      *JSS ADD 1 VEN-NUM-IVCT IN CAN-FLD GIVING VEN-NUM-IVEN IN VEN.
           MOVE WSS-AUX-IVEN             TO     VEN-NUM-IVEN IN VEN.
           MOVE OPC-NUM-DCOL IN OPC TO VEN-DTBS.
           MOVE OPC-NUM-MCOL IN OPC TO VEN-MTBS.
           MOVE OPC-NUM-SCOL IN OPC TO VEN-STBS.
           MOVE OPC-NUM-ACOL IN OPC TO VEN-ATBS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-OBT-VEN.
           IF NOT VEN-STAT-OKS
               MOVE VEN-STAT TO MSG-COD-MENS
               MOVE VEN-MEN2 TO FRM-MEN2
               GO TO FIN-GEN-SIG-VEN-EVC.
      *
      *DAD ini  31-MAY-1993
      *Respalda el nuevo VEN generado cuando no existia este VEN
           IF WSS-IND-EXIS = 'N'
               MOVE VEN TO VEN-BKP.
           MOVE SPACES              TO MSG-COD-MENS.
           MOVE VEN-VAL-CAPI IN VEN TO WSS-VAL-CAPI-GENE.
      *Lee el 1er VEN fisico ( el cancelado )
           MOVE  1  TO VEN-NUM-IVEN IN VEN
                       VEN-NUM-IVEN IN VEN-BKP.
      *     MOVE VEN TO VEN-BKP.
      *DAD fin  31-MAY-1993
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENIVENNEX=1' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN-EVC.
      *Regraba el VEN respaldado con VEN-NUM-IVEN = 1
           MOVE VEN-BKP TO VEN.
      *DAD ini  31-MAY-1993
      **DAD ini  20-OCT-1992   (Memo.08-10-92)
      *     PERFORM PUT-VEN-IND-SCTB.
      *     MOVE SPACES TO MSG-COD-MENS
      **DAD fin  20-OCT-1992
      *DAD fin  31-MAY-1993
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
      *DAD ini  31-MAY-1993
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    NOMOD' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN-EVC.
      *DAD fin  31-MAY-1993
       CON-GEN-SIG-VEN-EVC.
      *Proyeccion Estructura => actualizar EVC y DLC
           PERFORM ACT-REVC-RDLC.
      *DAD ini  20-OCT-1992   (Memo.08-10-92)
           IF MSG-COD-MENS NOT > SPACES
               PERFORM ACT-VEN-SHFT.
      *DAD fin  20-OCT-1992
       FIN-GEN-SIG-VEN-EVC.
           EXIT.
      *-----------------------------------------------------------------
      *DAD ini  20-OCT-1992   (Memo.08-10-92)
       PUT-VEN-IND-SCTB SECTION.
       INI-PUT-VEN-IND-SCTB.
           IF WSS-IND-SCTB > SPACES
               MOVE WSS-IND-SCTB TO VEN-IND-SCTB IN VEN.
           IF WSS-IND-SCBZ > SPACES
               MOVE WSS-IND-SCBZ TO VEN-IND-SCBZ IN VEN.
       FIN-PUT-VEN-IND-SCTB.
           EXIT.
      *DAD fin  20-OCT-1992
      *-----------------------------------------------------------------
      *DAD ini  20-OCT-1992   (Memo.08-10-92)
       ACT-VEN-SHFT SECTION.
       INI-ACT-VEN-SHFT.
           MOVE 1 TO WSS-AUX-IVEN
                     VEN-NUM-IVEN IN VEN.
      * Lee fisicamente el Primer VEN
      *LRH ini 9-ABR-1994
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM COL-FIO-VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN AND
                    VEN-NUM-IVEN IN VEN = 1 )
               GO TO FIN-ACT-VEN-SHFT.
      *LRH fin 9-ABR-1994
       LUP-ACT-VEN-SHFT.
      * Lee fisicamente el Siguiente VEN
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
               GO TO FIN-ACT-VEN-SHFT.
      * Elimina el VEN tomado de UPD previamente Respaldado
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENSHFTNOUPD' TO MSG-COD-MENS
               GO TO FIN-ACT-VEN-SHFT.
           MOVE VEN TO VEN-BKP.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENSHFTNODEL' TO MSG-COD-MENS
               GO TO FIN-ACT-VEN-SHFT.
      * Graba el VEN Respaldado luego de Actualizar
           MOVE VEN-BKP TO VEN.
           ADD 1 TO WSS-AUX-IVEN.
           MOVE WSS-AUX-IVEN TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VENSHFTNOPUT' TO MSG-COD-MENS
               GO TO FIN-ACT-VEN-SHFT.
           MOVE VEN-BKP TO VEN.
           GO TO LUP-ACT-VEN-SHFT.
       FIN-ACT-VEN-SHFT.
           EXIT.
      *DAD fin  20-OCT-1992
      *-----------------------------------------------------------------
       ACT-REVC-RDLC SECTION.
       INI-ACVT-REVC.
           MOVE 1 TO VEN-I.
      *Primer LUP para actualizar estructuras
       LU1-ACT-REVC-RDLC.
           IF VEN-I > VEN-EMAX
               GO TO CON-ACT-REVC-RDLC.
           MOVE VEN-CIC-IOPC IN VEN TO EVC-CIC-IOPC IN EVC.
           MOVE EVC-IEVC(VEN-I)  TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    EVCNX' TO MSG-COD-MENS VEN-STAT
               GO TO FIN-ACT-REVC-RDLC.
           MOVE EVC-DPVC(VEN-I) TO EVC-NUM-DPVC IN EVC.
           MOVE EVC-MPVC(VEN-I) TO EVC-NUM-MPVC IN EVC.
           MOVE EVC-SPVC(VEN-I) TO EVC-NUM-SPVC IN EVC.
           MOVE EVC-APVC(VEN-I) TO EVC-NUM-APVC IN EVC.
           MOVE EVC-VCAN(VEN-I) TO EVC-NUM-VCAN IN EVC.
           MOVE EVC-IVCT(VEN-I) TO EVC-NUM-IVCT IN EVC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    EVCNX' TO MSG-COD-MENS VEN-STAT
               GO TO FIN-ACT-REVC-RDLC.
           ADD 1 TO VEN-I.
           GO TO LU1-ACT-REVC-RDLC.
       CON-ACT-REVC-RDLC.
      *
           MOVE ZEROES TO VEN-I.
      *Segundo LUP para actualizar documentos
       LUP-ACT-REVC-RDLC.
           ADD 1 TO VEN-I.
           IF VEN-I > 10
               GO TO FIN-ACT-REVC-RDLC.
           IF DLC-TDOC(VEN-I) NOT > SPACES
               GO TO LUP-ACT-REVC-RDLC.
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-I            TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO LUP-ACT-REVC-RDLC.
           MOVE DLC-SINT(VEN-I) TO DLC-VAL-SINT IN DLC.
           MOVE DLC-FAMT(VEN-I) TO DLC-FEC-FAMT IN DLC.
           MOVE DLC-SCPA(VEN-I) TO DLC-VAL-SCPA IN DLC.
      *DAD ini  31-MAY-1993
      *Cuando Exista el VEN y SOLO se genere para proyectar las estructu
           IF WSS-IND-EXIS = 'S'
               ADD WSS-VAL-CAPI-GENE        TO   DLC-VAL-SCPA IN DLC
               SUBTRACT VEN-VAL-CAPI IN VEN FROM DLC-VAL-SCPA IN DLC.
           MOVE 'N' TO WSS-IND-EXIS.
      *DAD fin  31-MAY-1993
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           GO TO LUP-ACT-REVC-RDLC.
       FIN-ACT-REVC-RDLC.
           EXIT.
      *
       GEN-SIG-VEN-VEN SECTION.
       INI-GEN-SIG-VEN-VEN.
           MOVE SPACES TO MSG-COD-MENS.
      *Solo para cancelacion especifica
           IF RCV-NUM-IVCT IN RCV NOT > ZEROES
               GO TO FIN-GEN-SIG-VEN-VEN.
      *lee el vencimiento siguiente si existe
           MOVE RCV-KEY-IVCT IN RCV TO VEN-KEY-IVEN IN VEN.
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS
               GO TO FIN-GEN-SIG-VEN-VEN.
      *Solo para tasa variable
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN OPC AND
                    ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN OPC AND
                    ICG-NUM-ICAN IN ICG = ZEROES AND
                    ICG-CIC-IOPV IN ICG = SPACES AND
                    ICG-NUM-IVCT IN ICG = ZEROES AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               GO TO FIN-GEN-SIG-VEN-VEN.
           IF ICG-COD-CVTI IN ICG NOT > SPACES
               GO TO FIN-GEN-SIG-VEN-VEN.
      *lee el vencimiento anterior para obtener diferencia de dias
           MOVE RCV-KEY-IVCT IN RCV TO VEN-KEY-IVEN IN VEN.
           IF VEN-NUM-IVEN IN VEN > 1
               SUBTRACT 1 FROM VEN-NUM-IVEN IN VEN
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC1
                   MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC1
                   MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC1
                   MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC1
               ELSE
                   MOVE RCV-KEY-IVCT IN RCV TO VEN-KEY-IVEN IN VEN
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-VEN
                   IF FIO-STAT-OKS
                       MOVE 30 TO FEC-NDIA
                       GO TO CON-GEN-SIG-VEN-VEN
                   ELSE
                       MOVE 'GENSVENNORCV' TO MSG-COD-MENS
                       GO TO FIN-GEN-SIG-VEN-VEN
           ELSE
               MOVE OPC-NUM-DCOL IN OPC TO FEC-DEC1
               MOVE OPC-NUM-MCOL IN OPC TO FEC-MEC1
               MOVE OPC-NUM-SCOL IN OPC TO FEC-SEC1
               MOVE OPC-NUM-ACOL IN OPC TO FEC-AEC1.
           MOVE RCV-KEY-IVCT IN RCV TO VEN-KEY-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'GENSVENNORCV' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN-VEN.
           MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'GENSVEN-DIA' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN-VEN.
       CON-GEN-SIG-VEN-VEN.
           MOVE VEN-NUM-DVEN IN VEN TO FEC-ITM1.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-ITM2.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-ITM3.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'GENSVEN+DIA' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN-VEN.
           IF OPC-IND-AFER IN OPC = 'S'
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-FBLK-N   TO FEC-FBLK
               MOVE FEC-CHOY-N   TO FEC-CHOY
               MOVE FEC-VHBL-S   TO FEC-VHBL
               MOVE FEC-VAL-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-FER
                   MOVE FEC-SIG-HBL  TO FEC-CMND
      *            PERFORM PRO-FEC
                   PERFORM CAL-FEC
                   IF FEC-STAT-OKS
                       NEXT SENTENCE
                   ELSE
                       MOVE 'GENSVENSHBL' TO MSG-COD-MENS
                       GO TO FIN-GEN-SIG-VEN-VEN
               ELSE
               IF NOT FEC-STAT-OKS
                   MOVE 'GENSVENVHBL' TO MSG-COD-MENS
                   GO TO FIN-GEN-SIG-VEN-VEN.
           MOVE FEC-ITM1 TO VEN-NUM-DVEN IN VEN.
           MOVE FEC-ITM2 TO VEN-NUM-MVEN IN VEN.
           MOVE FEC-ITM3 TO VEN-NUM-SVEN IN VEN.
           MOVE FEC-ITM4 TO VEN-NUM-AVEN IN VEN.
           MOVE VEN-FEC-FVEN IN VEN TO VEN-FEC-FIMV IN VEN.
           IF VEN-VAL-CAPI IN VEN > OPC-VAL-SCRE IN OPC
               MOVE OPC-VAL-SCRE IN OPC TO VEN-VAL-CAPI IN VEN
               MOVE 0                   TO VEN-VAL-FINA IN VEN
               MOVE 'N'                 TO VEN-IND-CALC IN VEN.
           ADD 1                    TO VEN-NUM-IVEN IN VEN.
           MOVE VEN-VAL-CAPI IN VEN TO VEN-VAL-SCAP IN VEN.
           MOVE VEN-VAL-FINA IN VEN TO VEN-VAL-SFIN IN VEN.
           MOVE ZEROES              TO VEN-VAL-IDNI IN VEN.
           MOVE SPACES              TO VEN-MSC-TACC IN VEN.
           MOVE SPACES              TO VEN-MSC-STAT IN VEN.
           MOVE SPACES              TO VEN-COD-OTRN IN VEN.
           MOVE SPACES              TO VEN-COD-ATRN IN VEN.
           MOVE SPACES              TO VEN-IND-SCTB IN VEN.
           MOVE VEN-NUM-IVEN IN VEN TO VEN-NUM-IVCT IN VEN.
           MOVE SPACES              TO VEN-IND-SCBZ IN VEN.
           MOVE ZEROES              TO VEN-VAL-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-MTSC IN VEN.
           MOVE SPACES              TO VEN-GLS-DISP IN VEN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'GENSVENNOPUT' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN-VEN.
      *
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NOGKU' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN-VEN.
           ADD 1 TO OPC-NUM-VCVG IN OPC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NOMOD' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN-VEN.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NOGKU' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEN-VEN.
           MOVE VEN-FEC-FVEN IN VEN TO DLC-FEC-FMAV IN DLC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NOMOD' TO MSG-COD-MENS.
       FIN-GEN-SIG-VEN-VEN.
           EXIT.
      *-----------------------------------------------------------------
       PRO-OPE SECTION.
       INI-PRO-OPE.
           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-OPE.

      *     SUBTRACT WSS-NUM-VCVG IN WSS-VARI FROM OPC-NUM-VCVG IN OPC.
           SUBTRACT CAN-NUM-TVCC IN CAN FROM OPC-NUM-VCVG IN OPC.
      *DAD ini  22-OCT-1991
           IF OPC-NUM-TVCC IN OPC > ZEROES
               ADD CAN-NUM-TVCC IN CAN TO OPC-NUM-TVCC IN OPC
           ELSE
               ADD WSS-NUM-VCCM IN WSS-VARI TO OPC-NUM-VCCM IN OPC
               ADD WSS-NUM-VCCV IN WSS-VARI TO OPC-NUM-VCCV IN OPC
               ADD WSS-NUM-VCCO IN WSS-VARI TO OPC-NUM-VCCO IN OPC.
      *DAD fin  22-OCT-1991
           MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN.
      *JSS 6-APR-1991 19:58:27
           IF NOT ( CAN-MSC-FCAN IN CAN = 'T' AND
                    CAN-MSC-ECAN IN CAN = 'T' )
              ADD CAN-NUM-TVCC IN CAN TO OPC-NUM-IVEN IN OPC
              IF OPC-NUM-IVEN IN OPC = ZEROES
                  MOVE 1 TO OPC-NUM-IVEN IN OPC.
      *
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'TOC    BCK' TO MSG-COD-MENS
               GO TO FIN-PRO-OPE.
           IF TOC-MSC-OPEC = 'D'
      * Parametrizar ?        ^
               IF WSS-SGV-FINA(500) > OPC-VAL-SCRE IN OPC
                   MOVE ZEROES TO OPC-VAL-SCRE IN OPC
               ELSE
                   SUBTRACT WSS-SGV-FINA(500) FROM OPC-VAL-SCRE IN OPC
           ELSE
      *DAD ini  26-FEB-1993   (Memo.08-01-93)
      * Al Ajustar Valor CAPITAL y FINAL de Cuota Intermedia o Final
      * al Cancelar se debe ajustar el Numero de Vencimientos Vigentes
               IF WSS-SGV-CAPD(500) NOT < OPC-VAL-SCRE IN OPC
                   MOVE ZEROES TO OPC-VAL-SCRE IN OPC
                   MOVE ZEROES TO OPC-NUM-VCVG IN OPC
      *DAD fin  26-FEB-1993
               ELSE
                   SUBTRACT WSS-SGV-CAPD(500) FROM OPC-VAL-SCRE IN OPC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    BCK' TO MSG-COD-MENS.
       FIN-PRO-OPE.
           EXIT.
      ******************************************************************
       PRO-DOC SECTION.
       INI-PRO-DOC.
           IF WSS-SGV-CAPD(WSS-NUM-IDLC) = ZEROES
               PERFORM PRO-DVEG-DLC
               GO TO FIN-PRO-DOC.
           MOVE WSS-NUM-IDLC TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 500 TO WSS-NUM-IDLC
               GO TO FIN-PRO-DOC.
           IF TOC-MSC-OPEC = 'D'
               IF WSS-SGV-FINA(WSS-NUM-IDLC) > DLC-VAL-SDLC IN DLC
                   MOVE ZEROES TO DLC-VAL-SDLC IN DLC
               ELSE
                   SUBTRACT WSS-SGV-FINA(WSS-NUM-IDLC)
                       FROM DLC-VAL-SDLC IN DLC
           ELSE
               IF WSS-SGV-CAPD(WSS-NUM-IDLC) > DLC-VAL-SDLC IN DLC
                   MOVE ZEROES TO DLC-VAL-SDLC IN DLC
               ELSE
                   SUBTRACT WSS-SGV-CAPD(WSS-NUM-IDLC)
                       FROM DLC-VAL-SDLC IN DLC.
      *
      *Para REVersa de EVC SCPA y FAMT se actualizan en ACT-REVC-RDLC
           IF ( OPC-IND-VSTR IN OPC = 'S' ) AND ( SCR-CMND = 'REV' )
               GO TO SIG-PRO-DOC.
      *Para operaciones con EVC donde el valor estimado es el CAPITAL
      *y para creditos con VEN se actualiza SCPA
           IF ( ( OPC-IND-VSTR IN OPC = 'S' ) AND
                ( RCV-MSC-STAT IN RCV = 'C' ) ) OR
                ( OPC-IND-VSTR IN OPC NOT = 'S' )
               IF TOC-MSC-OPEC = 'D'
                   IF WSS-SGV-FINA(WSS-NUM-IDLC) > DLC-VAL-SCPA IN DLC
                       MOVE ZEROES TO DLC-VAL-SCPA IN DLC
                   ELSE
                       SUBTRACT WSS-SGV-FINA(WSS-NUM-IDLC)
                           FROM DLC-VAL-SCPA IN DLC
               ELSE
                   IF WSS-SGV-CAPD(WSS-NUM-IDLC) > DLC-VAL-SCPA IN DLC
                       MOVE ZEROES TO DLC-VAL-SCPA IN DLC
                   ELSE
                       SUBTRACT WSS-SGV-CAPD(WSS-NUM-IDLC)
                           FROM DLC-VAL-SCPA IN DLC.
      *Para operaciones con VEN se actualiza FAMT
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE WSS-FEC-FAMT TO DLC-FEC-FAMT IN DLC.
      *
       SIG-PRO-DOC.
      *
      *JSS 6-APR-1991 22:00:22
      *Si el comando es REVERSA de un *TE y situacion contable no vigent
           IF SCR-CMND = 'REV'
               IF ( CAN-MSC-FCAN IN CAN = 'T' ) AND
                  ( CAN-MSC-ECAN IN CAN = 'E' ) AND
                  ( VEN-IND-SCTB IN VEN > SPACES )
                   PERFORM PRO-REV-RDT-DLC
               ELSE
                   NEXT SENTENCE
           ELSE
      *Si el comando es CAN o CVC y se cancelo totalmente la cuota y
      *situacion contable no vigente
      *DPM ini  19-APR-1996
      *     IF ( SCR-CMND = 'CAN' OR SCR-CMND = 'CVC' ) AND
           IF ( SCR-CMND = 'CAN' OR SCR-CMND = 'CVC' OR 'CAB' ) AND
      *DPM fin  19-APR-1996
              ( VEN-VAL-SFIN IN VEN NOT > ZEROES )     AND
              ( VEN-IND-SCTB IN VEN > SPACES )
               PERFORM PRO-RDT-DLC.
      *
           IF NOT ( SCR-CMND = 'CAN' OR
      *DPM ini  19-APR-1996
      *              SCR-CMND = 'CVC')
                    SCR-CMND = 'CVC' OR
                    SCR-CMND = 'CAB')
      *DPM fin  19-APR-1996
               GO TO CON-PRO-DOC.
      *Respalda fecha de devengo del documento en la cancelacion
           MOVE DLC-FEC-FDEV IN DLC TO CAN-FEC-FDVA IN CAN.
      *ALD/28-FEB-1990
           IF CAN-MSC-CANC IN CAN = 'CTT'
               MOVE DLC-FEC-FMAV IN DLC TO DLC-FEC-FDEV IN DLC
           ELSE
           IF ( CAN-MSC-FCAN IN CAN = 'T' OR
                CAN-MSC-FCAN IN CAN = 'I' ) AND
                OPC-NUM-VCOR IN OPC = 1
      *JPA ini  15-MAY-1995
      *DPM INI  20-FEB-1997
      *        IF FRM-SGV-TINT IN CAN-FLD NOT = ICG-SGV-TINT IN CAN-FLD
               IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *DPM FIN  20-FEB-1997
                  MOVE VEN-FEC-FVEN IN VEN TO DLC-FEC-FDEV IN DLC
               ELSE
                  IF CAN-FEC-FCAN IN CAN NOT > DLC-FEC-FDEV IN DLC
                     NEXT SENTENCE
                  ELSE
      *JPA fin  15-MAY-1995
      *ALD-BCI-INI/13.08.1996
                  IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN
                      IF VEN-VAL-SFIN IN VEN = ZEROES OR
                         VEN-VAL-SFIN IN VEN = VEN-VAL-SCAP IN VEN
                          MOVE VEN-FEC-FVEN IN VEN TO
                               DLC-FEC-FDEV IN DLC
                      ELSE
                          NEXT SENTENCE
                  ELSE
      *ALD-BCI-INI/13.08.1996
               MOVE CAN-FEC-FCAN IN CAN TO DLC-FEC-FDEV IN DLC
           ELSE
      *DAD ini  22-OCT-1991
           IF CAN-MSC-FCAN IN CAN = 'T' OR
              CAN-MSC-FCAN IN CAN = 'I'
               MOVE VEN-NUM-DVEN IN VEN TO DLC-NUM-DDEV IN DLC
               MOVE VEN-NUM-MVEN IN VEN TO DLC-NUM-MDEV IN DLC
               MOVE VEN-NUM-SVEN IN VEN TO DLC-NUM-SDEV IN DLC
               MOVE VEN-NUM-AVEN IN VEN TO DLC-NUM-ADEV IN DLC.
      *DAD fin  22-OCT-1991
       CON-PRO-DOC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 500 TO WSS-NUM-IDLC.
       FIN-PRO-DOC.
           EXIT.
      *-----------------------------------------------------------------
       PRO-DVEG-DLC SECTION.
       INI-PRO-DVEG-DLC.
           MOVE WSS-NUM-IDLC TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 500 TO WSS-NUM-IDLC
               GO TO FIN-PRO-DVEG-DLC.
           IF NOT ( SCR-CMND = 'CAN' OR
      *DPM ini  19-APR-1996
      *              SCR-CMND = 'CVC')
                    SCR-CMND = 'CVC' OR
                    SCR-CMND = 'CAB' )
      *DPM fin  19-APR-1996
               GO TO CON-PRO-DVEG-DLC.
           MOVE DLC-FEC-FDEV IN DLC TO CAN-FEC-FDVA IN CAN.
      *ALD/28-FEB-1990
           IF CAN-MSC-CANC IN CAN = 'CTT'
               MOVE DLC-FEC-FMAV IN DLC TO DLC-FEC-FDEV IN DLC
           ELSE
           IF ( CAN-MSC-FCAN IN CAN = 'T' OR
                CAN-MSC-FCAN IN CAN = 'I' ) AND
                OPC-NUM-VCOR IN OPC = 1
      *JPA ini  15-MAY-1995
      *DPM INI  20-FEB-1997
      *        IF FRM-SGV-TINT IN CAN-FLD NOT = ICG-SGV-TINT IN CAN-FLD
               IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *DPM FIN  20-FEB-1997
                  MOVE VEN-FEC-FVEN IN VEN TO DLC-FEC-FDEV IN DLC
               ELSE
                  IF CAN-FEC-FCAN IN CAN NOT > DLC-FEC-FDEV IN DLC
                     NEXT SENTENCE
                  ELSE
      *JPA fin  15-MAY-1995
      *ALD-BCI-INI/13.08.1996
                  IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN
                      IF VEN-VAL-SFIN IN VEN = ZEROES OR
                         VEN-VAL-SFIN IN VEN = VEN-VAL-SCAP IN VEN
                          MOVE VEN-FEC-FVEN IN VEN TO
                               DLC-FEC-FDEV IN DLC
                      ELSE
                          NEXT SENTENCE
                  ELSE
      *ALD-BCI-INI/13.08.1996
               MOVE CAN-FEC-FCAN IN CAN TO DLC-FEC-FDEV IN DLC
           ELSE
           IF CAN-MSC-FCAN IN CAN = 'T' OR
              CAN-MSC-FCAN IN CAN = 'I'
      *DAD ini  22-OCT-1991
               MOVE VEN-NUM-DVEN IN VEN TO DLC-NUM-DDEV IN DLC
               MOVE VEN-NUM-MVEN IN VEN TO DLC-NUM-MDEV IN DLC
               MOVE VEN-NUM-SVEN IN VEN TO DLC-NUM-SDEV IN DLC
               MOVE VEN-NUM-AVEN IN VEN TO DLC-NUM-ADEV IN DLC.
      *DAD fin  22-OCT-1991
      *DPM ini  19-FEB-1996
           IF ( VEN-VAL-SFIN IN VEN NOT > ZEROES AND
                VEN-IND-SCTB IN VEN > SPACES )
               PERFORM PRO-RDT-DLC.
      *DPM fin  19-FEB-1996
       CON-PRO-DVEG-DLC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
       FIN-PRO-DVEG-DLC.
           EXIT.
      *-----------------------------------------------------------------
       PRO-RDT-DLC SECTION.
       INI-PRO-RDT-DLC.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           MOVE VEN-CIC-IOPC IN VEN TO RDT-CIC-IOPC IN RDT.
           MOVE VEN-NUM-IDLC IN VEN TO RDT-NUM-IDLC IN RDT.
           MOVE VEN-IND-SCTB IN VEN TO RDT-IND-SCTB IN RDT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-RDT-DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-RDT-DLC.
           IF MSC-CIC-CMSC IN MSC = 'D'
               SUBTRACT WSS-VAL-SMO2 FROM RDT-VAL-SRDT IN RDT
           ELSE
               SUBTRACT WSS-VAL-SMO1 FROM RDT-VAL-SRDT IN RDT.
           IF RDT-VAL-SRDT IN RDT NOT > ZEROES
               MOVE FIO-DEL TO FIO-CMND
               PERFORM COL-FIO-RDT
           ELSE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-RDT.
           MOVE VEN-CIC-IOPC IN VEN TO RDT-CIC-IOPC IN RDT.
           MOVE VEN-NUM-IDLC IN VEN TO RDT-NUM-IDLC IN RDT.
           MOVE SPACES              TO RDT-IND-SCTB IN RDT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = RDT-CIC-IOPC IN RDT AND
              VEN-NUM-IDLC IN VEN = RDT-NUM-IDLC IN RDT
               GO TO FIN-PRO-RDT-DLC.
           MOVE SPACES TO DLC-IND-SCTB IN DLC.
       FIN-PRO-RDT-DLC.
           EXIT.
      *-----------------------------------------------------------------
       PRO-REV-RDT-DLC SECTION.
       INI-PRO-REV-RDT-DLC.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           MOVE 'COL' TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC' TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           MOVE VEN-CIC-IOPC IN VEN TO RDT-CIC-IOPC IN RDT.
           MOVE VEN-NUM-IDLC IN VEN TO RDT-NUM-IDLC IN RDT.
           MOVE VEN-IND-SCTB IN VEN TO RDT-IND-SCTB IN RDT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF FIO-STAT-OKS
               GO TO CON-PRO-REV-RDT-DLC.
           IF WSS-VAL-SMO1 < ZEROES
               SUBTRACT WSS-VAL-SMO1 FROM ZEROES GIVING
                        WSS-VAL-SMO1.
           IF WSS-VAL-SMO2 < ZEROES
               SUBTRACT WSS-VAL-SMO2 FROM ZEROES GIVING
                        WSS-VAL-SMO2.
           IF MSC-CIC-CMSC IN MSC = 'D'
               MOVE WSS-VAL-SMO2 TO RDT-VAL-SRDT IN RDT
           ELSE
               MOVE WSS-VAL-SMO1 TO RDT-VAL-SRDT IN RDT.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           MOVE 'MUL' TO DLC-IND-SCTB IN DLC.
           GO TO FIN-PRO-REV-RDT-DLC.
       CON-PRO-REV-RDT-DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-REV-RDT-DLC.
           IF MSC-CIC-CMSC IN MSC = 'D'
               SUBTRACT WSS-VAL-SMO2 FROM RDT-VAL-SRDT IN RDT
           ELSE
               SUBTRACT WSS-VAL-SMO1 FROM RDT-VAL-SRDT IN RDT.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-RDT.
       FIN-PRO-REV-RDT-DLC.
           EXIT.

      ******************************************************************
       BCK-OUT SECTION.
      *---------------
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'BACK-OUT ERRONEO'.
       FIN-BCK-OUT.
           EXIT.

      ******************************************************************
       CHK-PNT SECTION.
      *----------------
       INI-CHK-PNT.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CHECK-PNT ERRONEO'.
       FIN-CHK-PNT.
           EXIT.

      ******************************************************************
       GRABAR-ERROR SECTION.
       INI-GRABAR-ERROR.
           MOVE OPC-COD-OFOC IN OPC TO ERC-COD-OFIC IN ERC.
           MOVE 'CAS'               TO ERC-COD-EVEN IN ERC.
           MOVE 'CAS'               TO ERC-COD-PGRM IN ERC.
           MOVE ZEROES              TO ERC-NUM-CANC IN ERC.
           MOVE ZEROES              TO ERC-VAL-MNTO IN ERC.
           MOVE SPACES              TO ERC-GLS-DISP IN ERC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ERC.
       FIN-GRABAR-ERROR.
           EXIT.

      ******************************************************************

      *ALD-BCI-INI/20-08-1998 VALIDA SI TIENE CAN ANTERIORES PARA FIMV
       PRO-FMVE SECTION.
       INI-PRO-FMVE.
           MOVE ZEROES TO WSS-FEC-FMVE IN WSS-VARI.

           MOVE OPC-CAI-IOPC IN OPC     TO RCV-CAI-IOPV IN RCV.
           MOVE OPC-IIC-IOPC IN OPC     TO RCV-IIC-IOPV IN RCV.
           MOVE VEN-NUM-IVCT IN VEN     TO RCV-NUM-IVCT IN RCV.

           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT (FIO-STAT-OKS AND
              OPC-CAI-IOPC IN OPC = RCV-CAI-IOPV IN RCV AND
              OPC-IIC-IOPC IN OPC = RCV-IIC-IOPV IN RCV AND
              VEN-NUM-IVCT IN VEN = RCV-NUM-IVCT IN RCV )
               GO TO FIN-PRO-FMVE.

       LUP-PRO-FMVE.
           MOVE RCV-KEY-ICAN TO CAN-KEY-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF CAN-MSC-FCAN IN CAN = 'P'
               GO TO NXT-PRO-FMVE.
           IF CAN-MSC-STAT IN CAN NOT = 'R' AND
              CAN-SGV-TPAG IN CAN NOT < ZEROES AND
              CAN-SGV-TREN IN CAN NOT < ZEROES AND
              CAN-FEC-FCAN IN CAN >     VEN-FEC-FVEN IN VEN      AND
              CAN-FEC-FCAN IN CAN >     WSS-FEC-FMVE IN WSS-VARI
               MOVE CAN-NUM-DCAN IN CAN TO WSS-NUM-DMVE
               MOVE CAN-NUM-MCAN IN CAN TO WSS-NUM-MMVE
               MOVE CAN-NUM-SCAN IN CAN TO WSS-NUM-SMVE
               MOVE CAN-NUM-ACAN IN CAN TO WSS-NUM-AMVE.
       NXT-PRO-FMVE.
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT (FIO-STAT-OKS AND
              OPC-CAI-IOPC IN OPC = RCV-CAI-IOPV IN RCV AND
              OPC-IIC-IOPC IN OPC = RCV-IIC-IOPV IN RCV AND
              VEN-NUM-IVCT IN VEN = RCV-NUM-IVCT IN RCV )
               GO TO FIN-PRO-FMVE.
           GO TO LUP-PRO-FMVE.
       FIN-PRO-FMVE.
           EXIT.
      *ALD-BCI-FIN/20-08-1998
       COPY GNSBEKEY.
       COPY GNSBBCIC.
       COPY GNSBGCPT.
       COPY GNSBBVRF.
       COPY GNSBVCOD.
       COPY GNSBVIDC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBBNUM.
       COPY GNSBVTAB.

