       IDENTIFICATION DIVISION.
      *************************
       PROGRAM-ID.     COLPB765.
      *AUTHOR.         DONOSO JARA OSVALDO.
      *                DATE-WRITTEN,  03/04/92.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 30 DE MARZO DE 1998                                    *
      ******************************************************************
      ******************************************************************
      *  Sistema  : Colocaciones                                       *
      *  Subsist. : Interfaz deudores                                  *
      *  Analista : Retamal Pablo                                      *
      *  Objetivo : Generar archivo con informacion de grandes empresas*
      *             el cual sera usado para generar diskette para      *
      *             la Gerencia Grandes Empresas.                      *
      *  Archivos :                                                    *
      *   Entrada : COLVEMP: Archivo acumulacion (SAM)                 *
      *             COLVPAR: Tarjetas con numeros de RUT's             *
      *             TAB 150: Tabla de tablas y parametros              *
      *             DBC 100: Tabla datos basicos de clientes           *
      *             DSF 100: Tabla deuda sistema financiero            *
      *                                                                *
      *   Salida  : COLL765: Listado de RUT's no encontrados           *
      *             COLVRUT: Archivo de datos a diskette               *
      *                                                                *
      *   Ent/Sal :                                                    *
      *                                                                *
      *   Trabajo :                                                    *
      *                                                                *
      *  Mantenciones                                                  *
      *  ============                                                  *
      *            Programador: O.Donoso J.................            *
      *            Fecha      : 20/04/92                               *
      *            Cambio     : Se debe validar RUT en base            *
      *                         de clientes, digito ver y              *
      *                         existencia de operaciones asociadas    *
      *                         Se acepta por parametro usuario del    *
      *                         archivo LOTUS.                         *
      *                                                                *
      *            Programador: O.Donoso J.................            *
      *            Fecha      : 17/08/92                               *
      *            Cambio     : Se incluye en archivo generados nuevos *
      *                         montos de cobranzas, ahorro, DAP y     *
      *                         bancredito                             *
      *                                                                *
      ******************************************************************
           EJECT
       ENVIRONMENT DIVISION.
      **********************
       CONFIGURATION SECTION.
      *======================
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
           EJECT
       INPUT-OUTPUT SECTION.
      *=====================
       FILE-CONTROL.
           SELECT COLL765 ASSIGN TO UT-S-COLL765.
           SELECT COLVEMP ASSIGN TO SYS004-DA-3340-S-COLVEMP
                  FILE STATUS IS WR-FS-COLVEMP.
           SELECT COLVRUT ASSIGN TO SYS004-DA-3340-S-COLVRUT
                  FILE STATUS IS WR-FS-COLVRUT.
           SELECT COLVPAR ASSIGN       TO COLVPAR
                  FILE STATUS          IS WR-FS-COLVPAR.
           EJECT
       DATA DIVISION.
      *==============
           SKIP3
       FILE SECTION.
      *=============
           SKIP1
       FD  COLL765
           LABEL RECORDS OMITTED.
       01  COLR765                     PIC X(80).
       FD  COLVEMP
           BLOCK CONTAINS 0 RECORDS
           RECORD CONTAINS 1055 CHARACTERS.
       01  COLREMP.
           05 EMP-TIP-CLIE             PIC  X(01).
           05 EMP-CIC-ICLI             PIC  X(12).
           05 EMP-RUT-CLTE.
              10 EMP-NUM-CLTE          PIC  9(08).
              10 EMP-DVR-CLTE          PIC  X(01).
           05 EMP-FILLER               PIC  X(39).
           05 EMP-COD-ACTI             PIC  X(09).
           05 EMP-COD-OFIC             PIC  X(03).
           05 EMP-COD-REGI             PIC  X(03).
           05 EMP-COD-EJEC             PIC  X(12).
           05 EMP-NUM-PROT             PIC  9(05)      COMP-3.
           05 EMP-NUM-ACLA             PIC  9(05)      COMP-3.
           05 EMP-FILLER               PIC  X(16).
           05 EMP-TAB-PROD OCCURS 35 TIMES.
              10 EMP-CANT              PIC  S9(05)     COMP-3.
              10 EMP-MONTO1            PIC  S9(12)V999 COMP-3.
              10 EMP-MONTO2            PIC  S9(12)V999 COMP-3.
              10 EMP-MONTO3            PIC  S9(12)V999 COMP-3.
           SKIP1
       FD  COLVRUT
           BLOCK CONTAINS 0 RECORDS
           RECORD CONTAINS 211 CHARACTERS.
       01  COLRRUT.
           05 FILLER              PIC X(01).
           05 RUT-CRM-1           PIC X(01).
           05 RUT-NOM-CLTE        PIC X(54).
           05 RUT-CRM-2           PIC X(01).
           05 FILLER              PIC X(01).
           05 RUT-CRM-3           PIC X(01).
           05 RUT-RUT-CLTE.
              10 RUT-NUM-CLTE     PIC 9(09).
              10 RUT-DVR-CLTE     PIC X(01).
           05 RUT-CRM-4           PIC X(01).
           05 FILLER              PIC X(01).
           05 RUT-CRM-5           PIC X(01).
           05 RUT-COD-ACTI        PIC X(09).
           05 RUT-CRM-6           PIC X(01).
           05 FILLER              PIC X(01).
           05 RUT-CRM-7           PIC X(01).
           05 RUT-GLS-DCOR        PIC X(12).
           05 RUT-CRM-8           PIC X(01).
           05 FILLER              PIC X(01).
           05 RUT-CRM-9           PIC X(01).
           05 RUT-COD-EJEC        PIC X(12).
           05 RUT-CRM-10          PIC X(01).
           05 FILLER              PIC X(01).
           05 RUT-CRM-11          PIC X(01).
           05 RUT-COD-OFIC        PIC X(12).
           05 RUT-CRM-12          PIC X(01).
           05 FILLER              PIC X(01).
           05 RUT-NOM-OPER        PIC 9(05).
           05 FILLER              PIC X(01).
           05 RUT-VAL-SPRO        PIC 9(10).
           05 FILLER              PIC X(01).
           05 RUT-VAL-CMEX        PIC 9(10).
           05 FILLER              PIC X(01).
           05 RUT-VAL-CMNA        PIC 9(10).
           05 FILLER              PIC X(01).
           05 RUT-VAL-VDSF        PIC 9(10).
           05 FILLER              PIC X(01).
           05 RUT-VAL-DAHO        PIC 9(10).
           05 FILLER              PIC X(01).
           05 RUT-VAL-CBZA        PIC 9(10).
           05 FILLER              PIC X(01).
           05 RUT-VAL-BCRE        PIC 9(10).
           05 FILLER              PIC X(01).
           SKIP1
       FD  COLVPAR
           BLOCK CONTAINS 0 RECORDS
           RECORD CONTAINS 80 CHARACTERS.
       01  COLRPAR.
           02 FILLER                 PIC X(18).
           02 PAR-NOM-USR.
              03 PAR-NRO-RUT.
                 04 PAR-NUM-RUT      PIC 9(09).
                 04 PAR-DVR-RUT      PIC X(01).
              03 FILLER              PIC X(03).
           02 FILLER                 PIC X(49).
           SKIP1
       WORKING-STORAGE SECTION.
      *========================
      * Se definen areas 77 para llamar rutina de validacion
      * de rut que son necesarias
      *
       77  WR-RUT-LINK               PIC X(09).
       77  WR-COD-LINK               PIC X(01).

       SKIP1
       01  W-SWITCHES.
           05 WS-PROCESO             PIC 9(01) VALUE 0.
              88 WS-PROCESO-OK       VALUE 0.
              88 WS-PROCESO-NO-OK    VALUE 1.
       SKIP1
       01  W-TABLAS.
           02 WT-TABLA-RUT           OCCURS 0 TO 2000 TIMES
                                     DEPENDING ON WA-L-PAR
                                     INDEXED BY WI-IND.
              03 WT-RUT-CLTE.
                 04 WT-NUM-CLTE      PIC 9(08).
                 04 WT-DVR-CLTE      PIC X(01).
              03 WT-RUT-INEX         PIC X(01).
       SKIP1
       01  W-CONTADORES-Y-ACUMULADORES.
           05 WA-L-EMP               PIC 9(06) VALUE 0.
           05 WA-L-PAR               PIC 9(06) VALUE 0.
           05 WA-L-TAB               PIC 9(06) VALUE 0.
           05 WA-L-DBC               PIC 9(06) VALUE 0.
           05 WA-L-DSF               PIC 9(06) VALUE 0.
           05 WA-G-RUT               PIC 9(06) VALUE 0.
           05 WA-PAGINA              PIC 9(03) VALUE 0.
           05 WA-LINEA               PIC 9(03) VALUE 99.
           SKIP1
       01  W-REGISTROS-DE-TRABAJO.
           05 WR-FECHA-HOY.
              10 WR-HOY-AA           PIC X(02).
              10 WR-HOY-MM           PIC X(02).
              10 WR-HOY-DD           PIC X(02).
           05 WR-MENSAJES.
              10 WR-SECCION          PIC X(15).
              10 WR-PARRAFO          PIC X(15).
              10 WR-ARCHIVO          PIC X(10).
              10 WR-OPERACI          PIC X(10).
              10 WR-FILE-ST          PIC X(02).
              10 WR-MENSAJE          PIC X(35).
           05 WR-FS-COLVPAR          PIC 9(02) VALUE 0.
           05 WR-FS-COLVEMP          PIC 9(02) VALUE 0.
           05 WR-FS-COLVRUT          PIC 9(02) VALUE 0.
           05 WR-LINEA01.
              10 FILLER           PIC X(018) VALUE 'BANCO DE CREDITO E'.
              10 FILLER           PIC X(046) VALUE ' INV.'.
              10 FILLER           PIC X(008) VALUE 'FECHA :'.
              10 WR-LA01-DIA      PIC X(002).
              10 FILLER           PIC X(001) VALUE ALL '/'.
              10 WR-LA01-MES      PIC X(002).
              10 FILLER           PIC X(001) VALUE ALL '/'.
              10 WR-LA01-ANO      PIC X(002).
           05 WR-LINEA02.
              10 FILLER           PIC X(012) VALUE 'COLOCACIONES'.
              10 FILLER           PIC X(018) VALUE '              CLIE'.
              10 FILLER           PIC X(018) VALUE 'NTES GRANDES EMPRE'.
              10 FILLER           PIC X(018) VALUE 'SAS             PA'.
              10 FILLER           PIC X(009) VALUE 'GINA :'.
              10 WR-LA02-PAGINA   PIC Z.ZZ9.
           05 WR-LINEA03.
              10 FILLER           PIC X(010) VALUE 'USUARIO : '.
              10 WR-LA03-USUARIO  PIC X(013) VALUE ALL ' '.
              10 FILLER           PIC X(018) VALUE '(INFORMACION PARA'.
              10 FILLER           PIC X(015) VALUE 'DISKETTE LOTUS)'.
           05 WR-LINEA04.
              10 FILLER           PIC X(079) VALUE ALL '-'.
           05 WR-LINEA05.
              10 FILLER           PIC X(014) VALUE 'NRO. DE R.U.T.'.
              10 FILLER           PIC X(010) VALUE ALL ' '.
              10 FILLER           PIC X(014) VALUE 'MOTIVO RECHAZO'.
           05 WR-LINEA07.
              10 FILLER           PIC X(001) VALUE ALL ' '.
              10 WR-LA07-NUM-CLTE PIC ZZ.ZZZ.ZZ9.
              10 FILLER           PIC X(001) VALUE ALL '-'.
              10 WR-LA07-DVR-CLTE PIC X(001).
              10 FILLER           PIC X(010) VALUE ALL ' '.
              10 WR-LA07-MOTIVO   PIC X(050).
           05 WR-LINEA08.
              10 FILLER           PIC X(009) VALUE ALL ' '.
              10 FILLER           PIC X(018) VALUE '** SIN RECHAZOS **'.
      ******************************************************************
      *      USER INFORMATION BLOCK                                    *
      ******************************************************************
      *
       01  WB-UIB.
           05 FILLER                 PIC X(32) VALUE 'COLPB765'.
      *
      ******************************************************************
      *      REQUEST AREA                                              *
      ******************************************************************
      *
       01  WB-REQ-TAB-AREA.
           02 WB-REQ-TAB-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'TAB'.
           02 FILLER                  PIC X(5) VALUE 'TAB00'.
           02 WB-REQ-TAB-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +150.
           02 FILLER                  PIC X(58).
           02 WB-REQ-TAB-KEY-VALUE.
              03 WB-REQ-TAB-KEY-TAB   PIC X(03).
              03 WB-REQ-TAB-KEY-DAT   PIC X(15).

       01  WB-REQ-DBC-AREA.
           02 WB-REQ-DBC-CMD          PIC X(5) VALUE 'REDKG'.
           02 WB-REQ-DBC-TBL          PIC X(3) VALUE 'DBC'.
           02 WB-REQ-DBC-NKY          PIC X(5) VALUE 'DBC02'.
           02 WB-REQ-DBC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +100.
           02 FILLER                  PIC X(58).
           02 WB-REQ-DBC-KEY-VALUE.
              03 WB-REQ-DBC-KEY1      PIC 9(08).
              03 FILLER               PIC X(42).

       01  WB-REQ-DSF-AREA.
           02 WB-REQ-DSF-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'DSF'.
           02 FILLER                  PIC X(5) VALUE 'DSF02'.
           02 WB-REQ-DSF-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +101.
           02 FILLER                  PIC X(58).
           02 WB-REQ-DSF-KEY-VALUE    PIC X(50).

      ******************************************************************
      *                   WORK AREA                                    *
      ******************************************************************
      *
      *    Registro Generico de Tablas
      *    ---------------------------
      *
      *    Nombre Registro : RES
      *    Clave(s)        : RES-COD-TABL(UU), RES-STP-ITRN(UU),
      *                      RES-CIC-TABL(UU), RES-EXT-TABL(DC)
      *    Largo           : 194
      *    Bloqueo         : 2
      *    Observaciones   :
      *
       01  RES.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  RES-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  RES-KEY-IREG.
      *
      *KEY     Tipo + Codigo ( LLave Primaria )
               05  RES-COD-TABL.
      *
      *            Codigo Tipo Tabla
                   07  RES-COD-TTAB                     PIC X(03).
      *
      *            Codigo Tabla
                   07  RES-COD-CTAB                     PIC X(12).
      *
      *        Time Stamp Transaccion
               05  RES-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  RES-FEC-FTRN.
                       09  RES-NUM-STRN                 PIC 9(02).
                       09  RES-NUM-ATRN                 PIC 9(02).
                       09  RES-NUM-MTRN                 PIC 9(02).
                       09  RES-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  RES-HRA-HRTR.
                       09  RES-NUM-HHTR                 PIC 9(02).
                       09  RES-NUM-MMTR                 PIC 9(02).
                       09  RES-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  RES-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  RES-MSC-STAT                             PIC X(01).
      *
      *    Indicador Vigencia                           GNS VIGE
           03  RES-IND-VIGE  REDEFINES  RES-MSC-STAT    PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  RES-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  RES-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  RES-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  RES-COD-ATRN                             PIC X(12).
      *
      *KEY Tipo + Codigo ( Interno Computacional )
           03  RES-CIC-TABL.
      *
      *        Codigo Tipo Tabla
               05  RES-CIC-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  RES-CIC-CTAB                         PIC X(12).
      *
      *    Codigo Externo
           03  RES-EXT-TABL.
      *
      *        Codigo Tipo Tabla
               05  RES-EXT-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  RES-EXT-CTAB                         PIC X(05).
      *
      *    Descripcion Corta
           03  RES-GLS-DCOR                             PIC X(12).
      *
      *    Abreviacion Descripcion
           03  RES-GLS-ABRV                             PIC X(05).
      *
      *    Descripcion del Codigo
           03  RES-GLS-DESC                             PIC X(40).
      *
      *    Datos Anexos
           03  RES-GLS-DATA.
               05  RES-GLS-DAT1.
                   07  RES-COD-DAT1     OCCURS 10       PIC X(01).
               05  RES-GLS-DAT2.
                   07  RES-COD-DAT2     OCCURS 10       PIC X(02).
               05  RES-GLS-DAT3.
                   07  RES-COD-DAT3     OCCURS 10       PIC X(03).
      *
      *    Clave Soundex
           03  RES-SNX-TABL.
               05  RES-SNX-TTAB                         PIC X(03).
               05  RES-SNX-CTAB                         PIC X(03).
      *
      *    Variables de Tablas
       01  RES-VARI.
      *
      *    Nombre de Programa FIO para TABlas
           03  RES-GLS-FTAB.
      *
      *        Codigo Sistema
               05  RES-COD-SIST                         PIC X(03).
      *
      *        Nombre 'fijo' de FIO TABlas
               05  RES-COD-FTAB           VALUE 'PFTAB' PIC X(05).
      *    Datos Basicos del Cliente
      *    -------------------------
      *
      *    Nombre Registro : DBC
      *    Clave(s)        : DBC-KEY-IDBC(UU), DBC-STP-ITRN(UU),DBC-IDC-
      *                      DBC-GLS-NOMC(DC), DBC-SNX-NOMC(DC)
      *    Largo           : 241
      *    Bloqueo         : 1
      *    Observaciones   :
      *
       01  DBC.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  DBC-GLS-FLAG                             PIC X(01).
      *
      *KEY Clave Primaria Registro
           03  DBC-KEY-IREG.
      *
      *        Identificacion Datos Basicos Clientes
               05  DBC-KEY-IDBC.
      *
      *            Cod. Int. Comp. Cliente
                   07  DBC-CIC-ICLI.
      *
      *                Centro Asignacion Identificacion
                       09  DBC-CAI-ICLI.
                           11  DBC-COD-TCLI             PIC X(01).
                           11  DBC-COD-CCLI             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  DBC-IIC-ICLI                 PIC X(08).
      *
      *        Time Stamp Transaccion
               05  DBC-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  DBC-FEC-FTRN.
                       09  DBC-NUM-STRN                 PIC 9(02).
                       09  DBC-NUM-ATRN                 PIC 9(02).
                       09  DBC-NUM-MTRN                 PIC 9(02).
                       09  DBC-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  DBC-HRA-HRTR.
                       09  DBC-NUM-HHTR                 PIC 9(02).
                       09  DBC-NUM-MMTR                 PIC 9(02).
                       09  DBC-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  DBC-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  DBC-MSC-STAT                             PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  DBC-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  DBC-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  DBC-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  DBC-COD-ATRN                             PIC X(12).
      *
      *KEY Rut Cliente + Indicador o Calificador + Extension
           03  DBC-IDC-ICLI.
      *
      *        RUT Cliente
               05  DBC-NUM-ICLI                         PIC X(08).
      *
      *        Indicador Tipo RUT
               05  DBC-IND-ICLI                         PIC X(01).
      *
      *        Extension del RUT
               05  DBC-GLS-ICLI                         PIC X(03).
      *
      *KEY Digito Verificador del Rut
           03  DBC-VRF-ICLI                             PIC X(01).
      *
      *KEY Nombre Cliente Generico (Persona o Empresa)
           03  DBC-GLS-NOMC.
               05  DBC-GLS-APAT                         PIC X(25).
               05  DBC-GLS-AMAT                         PIC X(25).
               05  DBC-GLS-NOMB                         PIC X(25).
      *
      *    Soundex del Nombre de Cliente
           03  DBC-SNX-NOMC.
               05  DBC-SNX-APAT                         PIC X(03).
               05  DBC-SNX-AMAT                         PIC X(03).
               05  DBC-SNX-NOMB                         PIC X(03).
      *
      *    Numero de Direccion de Envio Correspondencia
           03  DBC-NUM-DCOR                             PIC 9(02).
      *
      *OPR Ind Tipo Cliente ( Persona o Empresa )       SGC TICL
           03  DBC-IND-TICL                             PIC X(01).
      *
      *    Tipo Cliente (Potencial,No Cliente,Grupo)    SGC TCL
           03  DBC-COD-TICL                             PIC X(02).
      *
      *    Codigo Clasificacion Comercial               SGC CLC
           03  DBC-COD-CLCM                             PIC X(02).
      *
      *RCM Codigo del Ejecutivo Encargado del Cliente   TAB USR
           03  DBC-COD-EJEC                             PIC X(12).
      *
      *OPR Codigo de Oficina donde opera el Cliente     TAB OFI
           03  DBC-COD-OFIC                             PIC X(03).
      *
      *RCM Indicador si opera en otra Oficina           SGC OOFI
           03  DBC-IND-OOFI                             PIC X(01).
      *
      *EXT Codigo Actividad Economica                   TAB ACT
           03  DBC-COD-ACTI                             PIC X(09).
      *
      *EXT Origen y Destino Sect (Comp.Inst)            TAB ODS
           03  DBC-COD-ODSE                             PIC X(03).
      *
      *INF Fecha Ultima Declaracion Articulo 85
           03  DBC-FEC-FA85.
               05  DBC-NUM-SA85                         PIC 9(02).
               05  DBC-NUM-AA85                         PIC 9(02).
               05  DBC-NUM-MA85                         PIC 9(02).
               05  DBC-NUM-DA85                         PIC 9(02).
      *
      *    Tipo Ultimo Pago Impuesto a la Renta         SGC UPIR
           03  DBC-IND-UPIR                             PIC X(03).
      *
      *    Fecha Ultimo Pago Impuesto a la Renta
           03  DBC-FEC-FUPI.
               05  DBC-NUM-SUPI                         PIC 9(02).
               05  DBC-NUM-AUPI                         PIC 9(02).
               05  DBC-NUM-MUPI                         PIC 9(02).
               05  DBC-NUM-DUPI                         PIC 9(02).
      *
      *INF Indicador de Multas Banco Central            SGC MUBC
           03  DBC-IND-MUBC                             PIC X(01).
      *
      *INF Indicador de Juicios Banco Central           SGC JUBC
           03  DBC-IND-JUBC                             PIC X(01).
      *
      *EXT Codigo Estado Cliente ( como Deudor )        SGC SCLI
           03  DBC-MSC-SCLI                             PIC X(01).
      *
      *    Fecha Estado Cliente
           03  DBC-FEC-FSCL.
               05  DBC-NUM-SSCL                         PIC 9(02).
               05  DBC-NUM-ASCL                         PIC 9(02).
               05  DBC-NUM-MSCL                         PIC 9(02).
               05  DBC-NUM-DSCL                         PIC 9(02).
      *
      *    Codigo de Bloqueo del Cliente                SGC BLO
           03  DBC-COD-BLOC                             PIC X(02).
      *
      *    Numero Total de Direcciones
           03  DBC-NUM-TDIR                             PIC 9(02).
      *
      *    Numero Total de Comentarios
           03  DBC-NUM-TCMT                             PIC 9(03).
      *
      *    Fecha Inicio Operacion
           03  DBC-FEC-FIOP.
               05  DBC-NUM-SIOP                         PIC 9(02).
               05  DBC-NUM-AIOP                         PIC 9(02).
               05  DBC-NUM-MIOP                         PIC 9(02).
               05  DBC-NUM-DIOP                         PIC 9(02).
      *
      *    Fecha Termino Operacion
           03  DBC-FEC-FTOP.
               05  DBC-NUM-STOP                         PIC 9(02).
               05  DBC-NUM-ATOP                         PIC 9(02).
               05  DBC-NUM-MTOP                         PIC 9(02).
               05  DBC-NUM-DTOP                         PIC 9(02).
      *
      *    Numero Operaciones Fecha Termino Nula
           03  DBC-NUM-OFTN                             PIC 9(03).
      *
      *    Fecha Ingreso de Datos a la Base de Datos
           03  DBC-FEC-FINP.
               05  DBC-NUM-SINP                         PIC 9(02).
               05  DBC-NUM-AINP                         PIC 9(02).
               05  DBC-NUM-MINP                         PIC 9(02).
               05  DBC-NUM-DINP                         PIC 9(02).
      *
      *    Disponible
      *    03  DBC-GLS-DISP                             PIC X(00).
      *    Deuda Sistema Financiero
      *    ------------------------
      *
      *    Nombre Registro : DSF
      *    Clave(s)        : DSF-KEY-IDSF(UU), DSF-STP-ITRN(UU)
      *                      DSF-CIC-ICLI(DC)
      *    Largo           : 162
      *    Bloqueo         : 3
      *    Observaciones   :
      *
      *    01) Modificacion 23/09/92 por req BCI, DAD.
      *        - Ingreso Campos DSF-VAL-CDIR y DSF-VAL-CIND.
      *        - Eliminado Campo DSF-VAL-PVDT.
      *        - Modifico Largo Campo DSF-GLS-DISP.
      *    02) Modificacion 10/03/94, DAD  (por req Super).
      *        - Ingreso campos DSF-VAL-DCOM, DSF-VAL-DCON, DSF-VAL-DHIP
      *                         DSF-VAL-DMOR, DSF-NUM-ICRC.
      *        - Modifico largo campos DSF-VAL-DVGN, DSF-VAL-DVGX,
      *                                DSF-VAL-DVCN, DSF-VAL-DVCX,
      *                                DSF-VAL-IVGT, DSF-VAL-IVCT,
      *                                DSF-GLS-DISP.
      *        - Modificado Largo/Bloqueo del registro, de 92/1 a 183/3,
      *          aumentada la Glosa Disponible.
      *    03) Modificacion 04/04/94 por req BCI, DAD.
      *        - Modifico largo campos DSF-VAL-xxxx, de COMP a COMP-3.
      *        - Modifico Largo Campo DSF-GLS-DISP.
      *        - Modificado Largo/Bloqueo del registro, de 183/3 a 162/3
      *    04) Modificacion 04/11/94 por req BCI, JPA.
      *        - Agrego campo DSF-VAL-LDCD.
      *        - Modifico Largo Campo DSF-GLS-DISP.
      *    05) Modificacion 16/3/95 por req BCI, JPA.
      *        - Agrego campo DSF-VAL-DDIF.
      *        - Agrego campo DSF-VAL-DDOP.
      *        - Modifico Largo Campo DSF-GLS-DISP.
      *
       01  DSF.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  DSF-GLS-FLAG                             PIC X(01).
      *
      *KEY Clave Primaria Registro
           03  DSF-KEY-IREG.
      *
      *        Identificacion Deuda Sistema Financiero
               05  DSF-KEY-IDSF.
      *
      *            Cod. Int. Comp. Deudor
                   07  DSF-CIC-IDEU.
      *
      *                Centro Asignacion Identificacion
                       09  DSF-CAI-IDEU.
                           11  DSF-COD-TDEU             PIC X(01).
                           11  DSF-COD-CDEU             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  DSF-IIC-IDEU                 PIC X(08).
      *
      *        Time Stamp Transaccion
               05  DSF-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  DSF-FEC-FTRN.
                       09  DSF-NUM-STRN                 PIC 9(02).
                       09  DSF-NUM-ATRN                 PIC 9(02).
                       09  DSF-NUM-MTRN                 PIC 9(02).
                       09  DSF-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  DSF-HRA-HRTR.
                       09  DSF-NUM-HHTR                 PIC 9(02).
                       09  DSF-NUM-MMTR                 PIC 9(02).
                       09  DSF-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  DSF-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  DSF-MSC-STAT                             PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  DSF-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  DSF-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  DSF-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  DSF-COD-ATRN                             PIC X(12).
      *
      *    Cod. Int. Comp. Cliente
           03  DSF-CIC-ICLI.
      *
      *        Centro Asignacion Identificacion
               05  DSF-CAI-ICLI.
                   07  DSF-COD-TCLI                     PIC X(01).
                   07  DSF-COD-CCLI                     PIC X(03).
      *
      *        Ident. Interna Computacional
               05  DSF-IIC-ICLI                         PIC X(08).
      *
      *MOD-02 9(09).
      *    Directa Vigente M/N
           03  DSF-VAL-DVGN              COMP-3         PIC 9(11).
      *
      *MOD-02 9(09).
      *    Directa Vigente M/X
           03  DSF-VAL-DVGX              COMP-3         PIC 9(11).
      *
      *MOD-02 9(09).
      *    Directa Vencida M/N
           03  DSF-VAL-DVCN              COMP-3         PIC 9(11).
      *
      *MOD-02 9(09).
      *    Directa Vencida M/X
           03  DSF-VAL-DVCX              COMP-3         PIC 9(11).
      *
      *MOD-02 9(09).
      *    Indirecta Vigente Total
           03  DSF-VAL-IVGT              COMP-3         PIC 9(11).
      *
      *MOD-02 9(09).
      *    Indirecta Vencida Total
           03  DSF-VAL-IVCT              COMP-3         PIC 9(11).
      *
      *ELI-01
      *    Porcentaje Vendida Total
      *    03  DSF-VAL-PVDT              COMP-3         PIC 9(03)V9(02).
      *
      *MOD-02 9(09).
      *ING-01
      *    Monto Castigos Directos
           03  DSF-VAL-CDIR              COMP-3         PIC 9(11).
      *
      *MOD-02 9(09).
      *ING-01
      *    Monto Castigos Indirectos
           03  DSF-VAL-CIND              COMP-3         PIC 9(11).
      *
      *ING-02
      *    Deuda Comercial
           03  DSF-VAL-DCOM              COMP-3         PIC 9(11).
      *
      *ING-02
      *    Deuda Creditos de Consumo
           03  DSF-VAL-DCON              COMP-3         PIC 9(11).
      *
      *ING-02
      *    Deuda de Credito Hipotecario
           03  DSF-VAL-DHIP              COMP-3         PIC 9(11).
      *
      *ING-02
      *    Deuda Morosa entre 60 y 90 dias
           03  DSF-VAL-DMOR              COMP-3         PIC 9(11).
      *
      *ING-02
      *    Num. de Inst. en que el deudor registra creditos de consumo
           03  DSF-NUM-ICRC                             PIC 9(02).
      *
      *MOD-02 X(03).
      *MOD-01 X(08).
      *MOD-04
      *    Monto de linea de credito disponible
           03  DSF-VAL-LDCD              COMP-3         PIC 9(11).
      *MOD-05
      *    Monto de la deuda directa en inversiones financieras
           03  DSF-VAL-DDIF              COMP-3         PIC 9(11).
      *    Monto de la deuda directa en operaciones con pacto
           03  DSF-VAL-DDOP              COMP-3         PIC 9(11).
      *    Disponible
           03  DSF-GLS-DISP                             PIC X(13).
      ******************************************************************
      *                 ELEMENT LIST                                   *
      ******************************************************************
      *
       01  WB-ELEM-LIS        PIC X(11).
           EJECT
       PROCEDURE DIVISION.
      *===================
           ENTRY 'DBMSCBL'.
           EJECT
       A-CONTROL SECTION.
      *=================
       AA-INICIALIZACION.
           PERFORM B-INICIALIZAR.
           SKIP1
       AB-PROCESAMIENTO.
           IF WS-PROCESO-OK
              PERFORM C-PROCESAR
           END-IF.
           SKIP1
       AC-TERMINACION.
           PERFORM D-TERMINAR.
           SKIP1
       AZ-FIN-DE-PROCESO.
           GOBACK.
           EJECT
       B-INICIALIZAR SECTION.
      *======================
           PERFORM BB-ABRIR-ARCHIVOS.
           IF (NOT WS-PROCESO-NO-OK)
               PERFORM BC-FECHA-LISTADO
               PERFORM BE-CARGA-PARAMETROS
           END-IF.
           GO BZ-FIN-DE-SECCION.
           SKIP1
       BB-ABRIR-ARCHIVOS.
      *------------------
           OPEN INPUT  COLVEMP COLVPAR
                OUTPUT COLL765 COLVRUT.
           IF (WR-FS-COLVPAR NOT = 0 AND NOT = 97)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS' TO WR-PARRAFO
               MOVE 'COLVPAR    '       TO WR-ARCHIVO
               MOVE 'OPEN'              TO WR-OPERACI
               MOVE WR-FS-COLVPAR       TO WR-FILE-ST
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-COLVEMP NOT = 0 AND NOT = 97)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS' TO WR-PARRAFO
               MOVE 'COLVEMP    '       TO WR-ARCHIVO
               MOVE 'OPEN'              TO WR-OPERACI
               MOVE WR-FS-COLVEMP       TO WR-FILE-ST
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-COLVRUT NOT = 0 AND NOT = 97)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS' TO WR-PARRAFO
               MOVE 'COLVRUT    '       TO WR-ARCHIVO
               MOVE 'OPEN'              TO WR-OPERACI
               MOVE WR-FS-COLVRUT       TO WR-FILE-ST
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       BC-FECHA-LISTADO.
      *-----------------
           ACCEPT WR-FECHA-HOY FROM DATE.
           MOVE WR-HOY-MM               TO WR-LA01-MES
           MOVE WR-HOY-DD               TO WR-LA01-DIA
           MOVE WR-HOY-AA               TO WR-LA01-ANO.
           SKIP1
       BD-DISPLAY-ERROR.
      *-----------------
           SET WS-PROCESO-NO-OK        TO TRUE.
           DISPLAY ' '
           DISPLAY 'ERROR EN SECCION   : ' WR-SECCION
           DISPLAY '   PARRAFO         : ' WR-PARRAFO
           DISPLAY '   ARCHIVO         : ' WR-ARCHIVO
           DISPLAY '   OPERACION       : ' WR-OPERACI
           DISPLAY '   FILE STATUS     : ' WR-FILE-ST
           DISPLAY '   MENSAJE DE ERROR: ' WR-MENSAJE.
           SKIP1
       BE-CARGA-PARAMETROS.
      *--------------------
           READ COLVPAR END-READ.
           ADD 1                       TO WA-L-PAR
           MOVE PAR-NOM-USR            TO WR-LA03-USUARIO
           IF (PAR-NOM-USR = SPACES)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BE-CARGA-PARAMETR' TO WR-PARRAFO
               MOVE 'COLVPAR    '       TO WR-ARCHIVO
               MOVE '    '              TO WR-OPERACI
               MOVE '    '              TO WR-FILE-ST
               MOVE '** NOMBRE USUARIO INVALIDO **' TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.

           READ COLVPAR END-READ.
           SET WI-IND                  TO 1
           PERFORM UNTIL (WR-FS-COLVPAR NOT = 0 OR WI-IND > 2000 OR
                          WS-PROCESO-NO-OK)
                   MOVE PAR-NRO-RUT    TO WT-RUT-CLTE(WI-IND)
                   MOVE '0'            TO WT-RUT-INEX(WI-IND)
                   ADD 1               TO WA-L-PAR
                   SET WI-IND          UP BY 1
                   READ COLVPAR END-READ
           END-PERFORM
           IF (WR-FS-COLVPAR NOT = 0 AND NOT = 10)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BE-CARGA-PARAMETR' TO WR-PARRAFO
               MOVE 'COLVPAR    '       TO WR-ARCHIVO
               MOVE 'READ'              TO WR-OPERACI
               MOVE WR-FS-COLVPAR       TO WR-FILE-ST
               MOVE COLRPAR             TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           IF (WI-IND > 2000)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BE-CARGA-PARAMETR' TO WR-PARRAFO
               MOVE 'TABLA      '       TO WR-ARCHIVO
               MOVE ' '                 TO WR-OPERACI
               MOVE ' '                 TO WR-FILE-ST
               MOVE '** SE LLENO TABLA INTERNA * ' TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       BZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       C-PROCESAR SECTION.
      *===================
       CA-PROCESO-GRAL.
      *----------------
           PERFORM CB-LEER-COLVEMP
           PERFORM CC-PROCESA-MOVIMIENTOS
              UNTIL (WR-FS-COLVEMP NOT = 0 OR WS-PROCESO-NO-OK)
           IF (NOT WS-PROCESO-NO-OK)
               PERFORM CJ-LISTA-RUT-INEX
           END-IF
           GO CZ-FIN-DE-SECCION.
           SKIP1
       CB-LEER-COLVEMP.
      *----------------
           READ COLVEMP END-READ.
           IF (WR-FS-COLVEMP NOT = 0 AND NOT = 10)
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CB-LEER-COLVEMP'   TO WR-PARRAFO
               MOVE 'COLVEMP    '       TO WR-ARCHIVO
               MOVE 'READ'              TO WR-OPERACI
               MOVE WR-FS-COLVEMP       TO WR-FILE-ST
               MOVE COLREMP             TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       CC-PROCESA-MOVIMIENTOS.
      *-----------------------
           SET WI-IND                  TO 1
           SEARCH WT-TABLA-RUT
             AT END
                   CONTINUE
             WHEN (WT-RUT-CLTE(WI-IND) = EMP-RUT-CLTE)
                   MOVE ' '            TO WT-RUT-INEX(WI-IND)
                   PERFORM CD-GRABAR-CLTE
           END-SEARCH
           PERFORM CB-LEER-COLVEMP.
           SKIP1
       CD-GRABAR-CLTE.
      *---------------
           ADD 1                       TO WA-L-EMP
           MOVE SPACES                 TO COLRRUT.

           MOVE EMP-NUM-CLTE           TO WB-REQ-DBC-KEY-VALUE
           PERFORM CE-LEER-DBC
           IF (WB-REQ-DBC-RC       = '14' OR
               WB-REQ-DBC-KEY1 NOT = EMP-NUM-CLTE)
               MOVE '**S/NOMBRE**'     TO DBC-GLS-NOMC
               MOVE '0'                TO WT-RUT-INEX(WI-IND)
           ELSE
               ADD  1                  TO WA-L-DBC
           END-IF
           MOVE DBC-GLS-NOMC           TO RUT-NOM-CLTE

           MOVE EMP-NUM-CLTE           TO RUT-NUM-CLTE
           MOVE EMP-DVR-CLTE           TO RUT-DVR-CLTE
           MOVE EMP-COD-ACTI           TO RUT-COD-ACTI

           MOVE 'ACT'                  TO WB-REQ-TAB-KEY-TAB
           MOVE  EMP-COD-ACTI          TO WB-REQ-TAB-KEY-DAT
           PERFORM CE-LEER-TAB
           MOVE RES-GLS-DCOR           TO RUT-GLS-DCOR

           MOVE EMP-COD-EJEC           TO RUT-COD-EJEC

           MOVE 'OFI'                  TO WB-REQ-TAB-KEY-TAB
           MOVE  EMP-COD-OFIC          TO WB-REQ-TAB-KEY-DAT
           PERFORM CE-LEER-TAB
           MOVE RES-GLS-DCOR           TO RUT-COD-OFIC

           MOVE EMP-CANT(1)            TO RUT-NOM-OPER
           COMPUTE RUT-VAL-SPRO =  EMP-MONTO1(1)  / 1000
           COMPUTE RUT-VAL-CMEX =  EMP-MONTO1(10) / 1000
           COMPUTE RUT-VAL-CMNA = (EMP-MONTO1(4)  +  EMP-MONTO1(5)  +
                                   EMP-MONTO1(6)  +  EMP-MONTO1(7)  +
                                   EMP-MONTO1(8)  +  EMP-MONTO1(9)  +
                                   EMP-MONTO1(21) +  EMP-MONTO1(22) +
                                   EMP-MONTO1(23) ) / 1000
           COMPUTE RUT-VAL-DAHO = (EMP-MONTO1(11) +  EMP-MONTO1(25))
                                   / 1000
           COMPUTE RUT-VAL-CBZA =  EMP-MONTO1(13) / 1000
           COMPUTE RUT-VAL-BCRE =  EMP-MONTO1(24) / 1000

           MOVE EMP-CIC-ICLI           TO WB-REQ-DSF-KEY-VALUE
           PERFORM CE-LEER-DSF
           IF (WB-REQ-DSF-RC = '  ')
               COMPUTE RUT-VAL-VDSF = DSF-VAL-DVGN + DSF-VAL-DVGX +
                                      DSF-VAL-DVCN + DSF-VAL-DVCX
           ELSE
               MOVE 0                  TO RUT-VAL-VDSF
           END-IF
           MOVE '"'                    TO RUT-CRM-1  RUT-CRM-2
                                          RUT-CRM-3  RUT-CRM-4
                                          RUT-CRM-5  RUT-CRM-6
                                          RUT-CRM-7  RUT-CRM-8
                                          RUT-CRM-9  RUT-CRM-10
                                          RUT-CRM-11 RUT-CRM-12
           WRITE COLRRUT END-WRITE.
           IF (WR-FS-COLVRUT = 0)
               ADD 1                     TO WA-G-RUT
           ELSE
               MOVE 'C-PROCESAR'         TO WR-SECCION
               MOVE 'CD-GRABAR-CLTE'     TO WR-PARRAFO
               MOVE 'COLVRUT'            TO WR-ARCHIVO
               MOVE 'WRITE'              TO WR-OPERACI
               MOVE WR-FS-COLVRUT        TO WR-FILE-ST
               MOVE COLRRUT              TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       CE-LEER-DBC.
      *------------
           MOVE 'DBC00'                  TO WB-ELEM-LIS
           MOVE SPACES                   TO WB-REQ-DBC-RC
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DBC-AREA DBC WB-ELEM-LIS
           IF (WB-REQ-DBC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'         TO WR-SECCION
               MOVE 'CE-LEER-DBC'        TO WR-PARRAFO
               MOVE 'DBC'                TO WR-ARCHIVO
               MOVE 'REDKY'              TO WR-OPERACI
               MOVE WB-REQ-DBC-RC        TO WR-FILE-ST
               MOVE WB-REQ-DBC-KEY-VALUE TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       CE-LEER-TAB.
      *------------
           MOVE 'TAB00'                  TO WB-ELEM-LIS
           MOVE SPACES                   TO WB-REQ-TAB-RC
           CALL 'DBNTRY' USING WB-UIB WB-REQ-TAB-AREA RES WB-ELEM-LIS
           IF (WB-REQ-TAB-RC = '  ')
               ADD  1                    TO WA-L-TAB
           ELSE
           IF (WB-REQ-TAB-RC = '14')
               MOVE '**S/DESCRI**'       TO RES-GLS-DCOR
           ELSE
               MOVE 'C-PROCESAR'         TO WR-SECCION
               MOVE 'CE-LEER-TAB'        TO WR-PARRAFO
               MOVE 'TAB'                TO WR-ARCHIVO
               MOVE 'REDKY'              TO WR-OPERACI
               MOVE WB-REQ-TAB-RC        TO WR-FILE-ST
               MOVE WB-REQ-TAB-KEY-VALUE TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF
           END-IF.
           SKIP1
       CE-LEER-DSF.
      *------------
           MOVE 'DSF00'                  TO WB-ELEM-LIS
           MOVE SPACES                   TO WB-REQ-DSF-RC
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DSF-AREA DSF WB-ELEM-LIS
           IF (WB-REQ-DSF-RC = '  ')
               ADD  1                    TO WA-L-DSF
           ELSE
           IF (WB-REQ-DSF-RC NOT = '14')
               MOVE 'C-PROCESAR'         TO WR-SECCION
               MOVE 'CE-LEER-DSF'        TO WR-PARRAFO
               MOVE 'DSF'                TO WR-ARCHIVO
               MOVE 'REDKY'              TO WR-OPERACI
               MOVE WB-REQ-DSF-RC        TO WR-FILE-ST
               MOVE WB-REQ-DSF-KEY-VALUE TO WR-MENSAJE
               PERFORM BD-DISPLAY-ERROR
           END-IF.
           SKIP1
       CJ-LISTA-RUT-INEX.
      *------------------
           MOVE 'LOCKY'                TO WB-REQ-DBC-CMD
           SET WI-IND                  TO 1
           PERFORM UNTIL (WI-IND = WA-L-PAR)
             IF (WT-RUT-INEX(WI-IND) = '0')
                 MOVE WT-NUM-CLTE(WI-IND) TO WR-LA07-NUM-CLTE
                 MOVE WT-DVR-CLTE(WI-IND) TO WR-LA07-DVR-CLTE
                 PERFORM CI-VALIDA-RUT
                 IF (WA-LINEA > 50)
                     PERFORM CH-TITULOS
                 END-IF
                 WRITE COLR765 FROM WR-LINEA07 AFTER 1
                 ADD  1                TO WA-LINEA
             END-IF
             SET WI-IND                UP BY 1
           END-PERFORM.
           IF (WA-PAGINA = 0)
               PERFORM CH-TITULOS
               WRITE COLR765 FROM WR-LINEA08 AFTER 1
           END-IF.
           SKIP1
       CH-TITULOS.
      *-----------
           ADD 1                       TO WA-PAGINA
           MOVE WA-PAGINA              TO WR-LA02-PAGINA
           WRITE COLR765 FROM WR-LINEA01 AFTER PAGE
           WRITE COLR765 FROM WR-LINEA02 AFTER 1
           WRITE COLR765 FROM WR-LINEA03 AFTER 2
           WRITE COLR765 FROM WR-LINEA04 AFTER 1
           WRITE COLR765 FROM WR-LINEA05 AFTER 1
           WRITE COLR765 FROM WR-LINEA04 AFTER 1
           MOVE 0                      TO WA-LINEA.
           SKIP1
       CI-VALIDA-RUT.
      *--------------
           MOVE WT-RUT-CLTE(WI-IND)        TO WR-RUT-LINK
           MOVE '0'                        TO WR-COD-LINK
           CALL 'RUTURUTV' USING WR-RUT-LINK WR-COD-LINK
           IF (WR-COD-LINK = '0')
               MOVE WT-NUM-CLTE(WI-IND)    TO WB-REQ-DBC-KEY-VALUE
               PERFORM CE-LEER-DBC
               IF (WB-REQ-DBC-RC       = '14' OR
                   WB-REQ-DBC-KEY1 NOT = WT-NUM-CLTE(WI-IND))
                   MOVE 'NO EXISTE CLIENTE EN DBC'          TO
                   WR-LA07-MOTIVO
               ELSE
                   MOVE 'RUT NO POSEE OPERACIONES VIGENTES' TO
                   WR-LA07-MOTIVO
               END-IF
           ELSE
               MOVE 'DIGITO VERIFICADOR ERRONEO'        TO
               WR-LA07-MOTIVO
           END-IF.
           SKIP1
       CZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       D-TERMINAR SECTION.
      *===================
       DA-ESTADISTICAS.
      *----------------
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'INFORMES'
           DISPLAY '--------'
           DISPLAY ' '
           IF NOT WS-PROCESO-NO-OK
               DISPLAY 'COLL765 EMITIDO EN FORMA LOCAL'
           ELSE
               DISPLAY 'COLL765 NO EMITIDO O INCOMPLETO'
           END-IF
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'ESTADISTICAS DE PROCESO PROGRAMA COLPB765 FECHA '
                    WR-FECHA-HOY
           DISPLAY '------------------------------------------------'
           DISPLAY '            INF. GRANDES EMPRESAS'
           DISPLAY ' '
           DISPLAY 'Leidos COLVPAR    : ' WA-L-PAR
           DISPLAY 'Leidos COLVEMP    : ' WA-L-EMP
           DISPLAY 'Leidos DBC 100    : ' WA-L-DBC
           DISPLAY 'Leidos DSF 100    : ' WA-L-DSF
           DISPLAY 'Leidos TAB 100    : ' WA-L-TAB
           DISPLAY ' '
           DISPLAY 'Grabad COLVRUT    : ' WA-G-RUT
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'TARJETAS DE PARAMETROS'
           DISPLAY '----------------------'
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'MENSAJES PARA EL EXPLOTADOR'
           DISPLAY '---------------------------'
           DISPLAY ' '
           IF WS-PROCESO-OK
               DISPLAY 'NO HAY MENSAJES PARA EL EXPLOTADOR'
           ELSE
               DISPLAY 'HAY MENSAJES PARA EL EXPLOTADOR'
           END-IF
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '.
           SKIP1
       DC-TERMINO.
      *-----------
           CLOSE COLVEMP COLL765 COLVPAR COLVRUT.
           IF WS-PROCESO-NO-OK
              MOVE 100 TO RETURN-CODE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
              DISPLAY '********                              ********'
              DISPLAY '******** TERMINO ERRONEO DEL PROCESO  ********'
              DISPLAY '********                              ********'
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
           ELSE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*****PROCESO TERMINO EN FORMA NORMAL*****'.
           SKIP1
       DZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
