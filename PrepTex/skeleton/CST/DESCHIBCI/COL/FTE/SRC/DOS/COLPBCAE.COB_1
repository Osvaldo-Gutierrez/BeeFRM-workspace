       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPBCAE.
       AUTHOR.          BEE TEAM.
       DATE-WRITTEN.     15-FEB-2000.
      * Programa para pasar OPC de Castigo Activo a Castigo Excluible
      *
      * ARCHIVOS DE ENTRADA                                          *
      * -------------------                                          *
      * FILE-OPC     ARCHIVO DATOS OPERACIONES        (OPC-CIC-IOPC) *
      * FILE-DLC     ARCHIVO DATOS LEGALES DE CREDITO (DLC-CIC-IOPC) *
      *
      * ARCHIVOS DE SALIDA                                           *
      * -------------------                                          *
      * FILE-CAE     ARCHIVO DE DATOS DE LAS OPERACIONES             *

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-ERC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AU1-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AU2-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==SCR-CAN-REQA==.
      * 01  SCR-KEY-ICAN                     PIC X(03).
      *<<<< WSS
       COPY COLBRERC.
       COPY COLBRVEN.
       COPY COLBROPC.
       COPY COLBRCAN.
       COPY COLBRRCV.
       COPY COLBRCYA.
       COPY COLBRICG.
       COPY COLBRROV.
       COPY COLBRTOC.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRRDC.
       COPY COLBRRDT.
       COPY COLBRPOC.
       COPY COLBRPVC.

       COPY SGCBRDBC.

       COPY COLBROPS.
       COPY COLBRDLS.
       COPY COLBRCAE.


       COPY COLWGVEN.

       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY TABBRCAM.
       COPY GNSBRTAB.
       COPY TABBROFI.
       COPY GNSBRCIC.
       COPY TABBRUSR.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
       COPY COLWGINT.
       COPY GNSWCNUM.
       COPY GNSWCSCR.
       COPY GNSWCVRF.
       COPY GNSWGCIC.
       COPY GNSWGCPT.
       COPY GNSWGFRM.
       COPY GNSWGIDC.
       COPY GNSWVNUM.
       COPY GNSWVSCR.
       COPY GNSWVVRF.
       COPY COLWICAN.
       COPY COLW1CAN.

       COPY COLBRVEN REPLACING ==VEN== BY ==VEN-BKP==.
      *
      *01  WSS-VARI. *EXISTE  DEFINIDO EN COPY COLW2CAN
       COPY COLW2CAN.

           03 WSS-FEC-FDP1.
              05 WSS-NUM-DDP1                     PIC 9(02).
              05 WSS-NUM-MDP1                     PIC 9(02).
              05 WSS-NUM-SDP1                     PIC 9(02).
              05 WSS-NUM-ADP1                     PIC 9(02).

           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-FEC-FCAE.
              05 WSS-NUM-SCAE                     PIC 9(02).
              05 WSS-NUM-ACAE                     PIC 9(02).
              05 WSS-NUM-MCAE                     PIC 9(02).
              05 WSS-NUM-DCAE                     PIC 9(02).

           03 WSS-IND-FLAG        VALUE ZEROES    PIC 9(01).
           03 WSS-NUM-DTAC        VALUE ZEROES    PIC 9(03).
           03 WSS-DIF-DIAS        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-CORR        VALUE ZEROES    PIC 9(06).
           03 WSS-IND-DISP        VALUE SPACES    PIC X(01).
           03 WSS-COD-PESO        VALUE SPACES    PIC X(06).
           03 WSS-SGV-CAP1        VALUE ZEROES    PIC 9(11)V9(04).
           03 WSS-SGV-CAP2        VALUE ZEROES    PIC 9(11)V9(04).

      * Variables para estadisticas
           03 WSS-NUM-RLEI        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RNSE        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RGRA        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RACT        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RNIN        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RNAC        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RRCH        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-ROIN        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RONI        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-ROAC        VALUE ZEROES    PIC 9(06).
           03 WSS-NUM-RONA        VALUE ZEROES    PIC 9(06).
      *
           03  WSS-MAXV              VALUE ZEROS  PIC 9(03).
           03  WSS-MINV              VALUE ZEROS  PIC 9(03).
           03  WSS-MAXD              VALUE ZEROS  PIC 9(03).
           03  WSS-MIND              VALUE ZEROS  PIC 9(03).
           03  WSS-IDLC.
               05  WSS-VEC-IDLC OCCURS 500.
                   07  WSS-SGV-CAPD  COMP-3       PIC S9(11)V9(04).
                   07  WSS-SGV-FINA  COMP-3       PIC S9(11)V9(04).
           03  WSS-LIM-IDLC          VALUE 500    PIC 9(03).
           03  WSS-NUM-IDLC          VALUE ZEROS  PIC 9(04).
           03  WSS-NUM-VCVG          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-VCCM          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-VCCO          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-VCCV          VALUE ZEROS  PIC S9(03).
           03  WSS-NUM-IEVC          VALUE ZEROS  PIC 9(03).
           03  WSS-AUX-IVEN          VALUE ZEROS  PIC 9(03).
           03  WSS-IND-SCTB                        PIC X(03).
           03  WSS-IND-SCBZ                        PIC X(05).
           03  WSS-IND-EXIS          VALUE 'N'    PIC X(01).
           03  WSS-VAL-CAPI-GENE     COMP-3       PIC 9(11)V9(04).
           03  WSS-VAL-VENC  COMP-3  VALUE ZEROS  PIC 9(11)V9(04).
           03  WSS-FEC-FAMT.
               05  WSS-NUM-SAMT      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-AAMT      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-MAMT      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-DAMT      VALUE ZEROS  PIC 9(02).
           03  WSS-RCAN-SACT         VALUE ZEROES PIC 9(04).
           03  WSS-RCAN-NACT         VALUE ZEROES PIC 9(04).
           03  WSS-COD-OFOC          VALUE SPACES PIC X(03).
           03  WSS-SGV-LIQU          VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-COD-RMOC          VALUE SPACES PIC X(12).
           03  WSS-MSC-TCVE          VALUE SPACES PIC X(02).
           03  WSS-COD-CTAB.
               05  WSS-COD-CLASE.
                   07  WSS-COD-TIOC  VALUE ZEROES PIC X(03).
                   07  WSS-COD-AUXC  VALUE ZEROES PIC X(03).
               05  WSS-COD-VCDA      VALUE SPACES PIC X(06).
           03  WSS-NUM-DIRE          VALUE ZEROES PIC X(02).
           03  WSS-GLS-FONO          VALUE ZEROES PIC X(12).
           03  WSS-COD-PLZO          VALUE SPACES PIC X(02).
           03  WSS-COD-CDOC          VALUE SPACES PIC X(03).
           03  WSS-IND-GARA          VALUE SPACES PIC X(03).
           03  WSS-IND-VSTR          VALUE SPACES PIC X(01).
           03  WSS-IND-AFER          VALUE SPACES PIC X(01).
           03  WSS-CIC-IOPV          VALUE SPACES PIC X(12).
           03  WSS-NUM-IVEN          VALUE ZEROES PIC 9(03).
           03  WSS-FEC-FMVE.
               05  WSS-NUM-SMVE      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-AMVE      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-MMVE      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-DMVE      VALUE ZEROS  PIC 9(02).

           03  WSS-NUM-LDLC          PIC 9(09)  VALUE ZEROS.
           03  WSS-NUM-LOPC          PIC 9(09)  VALUE ZEROS.
           03  WSS-NUM-GCAE          PIC 9(09)  VALUE ZEROS.
           03  WSS-NUM-ERRO          PIC 9(09)  VALUE ZEROS.
           03  WSS-NUM-NFEC          PIC 9(09)  VALUE ZEROS.
           03  WSS-REG-IGUALES       PIC X(01)  VALUE SPACES.
           03  WSS-STAT-CAE          PIC X(01)  VALUE SPACES.
           03  WSS-CIC-IOPN          VALUE SPACES PIC X(12).

           03  SWITCHES.
               05 SW-OPC           PIC X(01) VALUE  '0'.
                  88  OPC-FST                VALUE  '1'.
                  88  OPC-NXT                VALUE  '2'.
                  88  OPC-FIN                VALUE  '3'.

               05 SW-DLC           PIC X(01) VALUE  '0'.
                  88  DLC-FST                VALUE  '1'.
                  88  DLC-NXT                VALUE  '2'.
                  88  DLC-FIN                VALUE  '3'.
      *
       01  PGM-STAT.
           03 PGM-STAT-OPC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-OPC-OKS    VALUE '00'.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
           03 PGM-STAT-CYA           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CYA-OKS    VALUE '00'.
                 88 PGM-STAT-CYA-NUL    VALUE '  '.
           03 PGM-STAT-VEN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-VEN-OKS    VALUE '00'.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
           03 PGM-STAT-RCV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RCV-OKS    VALUE '00'.
                 88 PGM-STAT-RCV-NUL    VALUE '  '.
           03 PGM-STAT-ITR           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ITR-OKS    VALUE '00'.
                 88 PGM-STAT-ITR-NUL    VALUE '  '.
           03 PGM-STAT-ICG           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ICG-OKS    VALUE '00'.
                 88 PGM-STAT-ICG-NUL    VALUE '  '.
           03 PGM-STAT-CAN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CAN-OKS    VALUE '00'.
                 88 PGM-STAT-CAN-NUL    VALUE '  '.
           03 PGM-STAT-ROV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ROV-OKS    VALUE '00'.
                 88 PGM-STAT-ROV-NUL    VALUE '  '.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).


       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           COPY GNSBGEDB.
           DISPLAY 'EMPIEZA EL PROGRAMA'.
           MOVE 'COLPBCAE' TO FIO-PROG SCR-USER.
           PERFORM GNS-BUS-IDD.
           PERFORM OPEN-FILE.
           PERFORM LEE-PARAM.
           PERFORM PROCESO.
           PERFORM CLOSE-FILE.
           PERFORM MUESTRA-ESTADISTICAS.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

      ******************************************************************
       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
            MOVE FIO-INP TO FIO-CMND.
            PERFORM COL-FIO-OPS.
            IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR FIO-INP OPS: ' FIO-STAT.
      *
            MOVE FIO-INP TO FIO-CMND.
            PERFORM COL-FIO-DLS.
            IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR FIO-INO DLS: ' FIO-STAT.
      *
            MOVE FIO-OUT TO FIO-CMND.
            PERFORM COL-FIO-CAE.
            IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR FIO-OUT CAE: ' FIO-STAT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-POC.
           PERFORM COL-FIO-PVC.
           PERFORM SGC-FIO-DBC.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-ROV.

           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-EVC.
           PERFORM COL-FIO-RDC.

           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-ERC.
       FIN-OPEN-FILE.
           EXIT.

      ******************************************************************
       LEE-PARAM SECTION.
      *-----------------
       INI-LEE-PARAM.
           DISPLAY 'CAPTURA PARAMETROS'.
           DISPLAY ' '.

      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO (DDMMSSAA): '.
           ACCEPT WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.

      * Validacion de parametros
           DISPLAY  ' '.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.
           DISPLAY  ' '.

      *VAL-FEC Valida Fecha de Proceso
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-ABT.

           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-AFEC IN WSS-VARI.


           MOVE 31 TO WSS-NUM-DDP1 IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MDP1 IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SDP1 IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-ADP1 IN WSS-VARI.

       LUP-LEE-PARAM.
           MOVE WSS-FEC-FDP1 IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               SUBTRACT 1 FROM WSS-NUM-DDP1 IN WSS-VARI
               IF WSS-NUM-DDP1 IN WSS-VARI > ZEROES
                  GO TO LUP-LEE-PARAM
               ELSE
                  DISPLAY 'ERROR VALIDACION FECHA DE PROCESO: '
                                                    FEC-MENS
                  PERFORM GNS-PRO-ABT.

           DISPLAY 'FECHA DE CALCULO :' WSS-FEC-FDP1 IN WSS-VARI.

           PERFORM GET-FHOY.

      * Obtiene Codigo de Pesos
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICPESONEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * Valida codigo MSC en TCYA
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'MSC'                TO MSC-COD-TTAB IN MSC.
           MOVE 'TCYA'               TO MSC-COD-TMSC IN MSC.
           MOVE 'PBCAE'              TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY          TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT ( FIO-STAT-OKS AND
              MSC-IND-VIGE IN MSC = 'S' )
               MOVE 'COL'       TO MSG-COD-SIST
               MOVE 'CODTCYANEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   MSC-COD-CMSC
               PERFORM GNS-PRO-ABT
               GO TO FIN-LEE-PARAM.
       FIN-LEE-PARAM.
           EXIT.

      ******************************************************************
       PROCESO SECTION.
       INI-PROCESO.
      * RESTA 6 ANOS A FECHA DE PROCESO
           MOVE WSS-NUM-DDP1 IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MDP1 IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SDP1 IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ADP1 IN WSS-VARI TO FEC-ITM4.
           MOVE 6                        TO FEC-NANO.
           MOVE FEC-RST-ANO              TO FEC-CMND.
           MOVE FEC-FORM-FEC             TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1    TO WSS-NUM-DCAE IN WSS-VARI.
           MOVE FEC-ITM2    TO WSS-NUM-MCAE IN WSS-VARI.
           MOVE FEC-ITM3    TO WSS-NUM-SCAE IN WSS-VARI.
           MOVE FEC-ITM4    TO WSS-NUM-ACAE IN WSS-VARI.
           DISPLAY 'FECHA DE CORTE :' WSS-NUM-DCAE IN WSS-VARI
                   WSS-NUM-MCAE IN WSS-VARI WSS-NUM-SCAE IN WSS-VARI
                   WSS-NUM-ACAE IN WSS-VARI.

      *EMPIEZA A PROCESAR LOS ARCHIVOS
           MOVE '1'  TO  SW-OPC  IN WSS-VARI.

           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-DLS.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL LEER PRIMER REG.DLS: ' FIO-STAT
              GO TO FIN-PROCESO.

       LUP-PROCESO.
           ADD 1                   TO WSS-NUM-LDLC.
           PERFORM BUS-REG-OPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE REG  OPC : ' FIO-STAT
                       DLC-CIC-IOPC IN DLS.

           IF  WSS-REG-IGUALES IN WSS-VARI = 'N'
               ADD 1 TO WSS-NUM-ERRO
               GO TO NXT-PROCESO.

           IF OPC-FEC-FINP IN OPS > WSS-FEC-FCAE IN WSS-VARI
              ADD 1 TO WSS-NUM-NFEC
              GO TO NXT-PROCESO.
      *
           PERFORM PRO-TRASPASO-CAST.

           IF WSS-STAT-CAE = 'N'
              GO TO NXT-PROCESO.

           PERFORM LLENA-CAE.
           MOVE FIO-PUT TO FIO-CMND
           PERFORM COL-FIO-CAE
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.CAE : ' FIO-STAT
              GO TO FIN-PROCESO
           ELSE
             ADD 1    TO WSS-NUM-GCAE.

       NXT-PROCESO.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLS.
           IF NOT FIO-STAT-OKS
              DISPLAY 'EOF DLC    : ' FIO-STAT
              GO TO FIN-PROCESO
           ELSE
              GO TO LUP-PROCESO.

       FIN-PROCESO.
           EXIT.
      ******************************************************************
       BUS-REG-OPC SECTION.
      *-------------------*
       INI-BUS-REG-OPC.
           MOVE 'N' TO WSS-REG-IGUALES IN WSS-VARI.

           IF OPC-FIN
              GO TO FIN-BUS-REG-OPC.

           IF OPC-FST
              MOVE FIO-GET-FST TO FIO-CMND
              PERFORM COL-FIO-OPS
              IF NOT FIO-STAT-OKS
                 DISPLAY 'ERROR AL LEER PRIMER REG.OPC: ' FIO-STAT
                 GO TO FIN-BUS-REG-OPC.

       LUP-BUS-REG-OPC.
           ADD   1            TO  WSS-NUM-LOPC IN WSS-VARI.
           MOVE '2'           TO  SW-OPC  IN WSS-VARI.
      *
           IF  DLC-CIC-IOPC IN DLS =  OPC-CIC-IOPC IN OPS
               MOVE 'S' TO WSS-REG-IGUALES IN WSS-VARI
               GO TO FIN-BUS-REG-OPC.
      *
           IF  OPC-CIC-IOPC IN OPS >  DLC-CIC-IOPC IN DLS
               MOVE 'N' TO WSS-REG-IGUALES IN WSS-VARI
               GO TO FIN-BUS-REG-OPC.


       NXT-BUS-REG-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-OPS.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR NXT REG.OPC: ' FIO-STAT
              MOVE '3'    TO   SW-OPC  IN WSS-VARI
              GO TO FIN-BUS-REG-OPC
           ELSE
              GO TO LUP-BUS-REG-OPC.

       FIN-BUS-REG-OPC.
           EXIT.


      ******************************************************************
      * Se deben pasar tambien todas las OPCs relacionadas por la ROV
      * a Castigo. Se asume que todas las OPCs relacionads estan en
      * Cartera Vencida.
      *
       PRO-TRASPASO-CAST SECTION.
      *-------------------------
       INI-PRO-TRASPASO-CAST.
           DISPLAY 'NUEVO EJECUTABLE'.
           MOVE 'N' TO WSS-STAT-CAE.
           PERFORM CHK-PNT.

           PERFORM LEE-OPC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               GO TO FIN-PRO-TRASPASO-CAST.

           IF OPC-COD-TOPC IN OPC NOT = 'D' OR
              OPC-VAL-SCRE IN OPC NOT > ZEROES
               DISPLAY 'OPC(1):' OPC-CIC-IOPC IN OPC
               DISPLAY 'SCRE:' OPC-VAL-SCRE IN OPC
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
               GO TO FIN-PRO-TRASPASO-CAST.

           IF NOT ( OPC-MSC-STAT IN OPC = 'A' AND
              OPC-VAL-SCRE IN OPC > ZEROES )
               DISPLAY 'OPC(2):' OPC-CIC-IOPC IN OPC
               DISPLAY 'SCRE:' OPC-VAL-SCRE IN OPC
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
               GO TO FIN-PRO-TRASPASO-CAST.


           PERFORM LEE-DLC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               GO TO FIN-PRO-TRASPASO-CAST.

            IF NOT ( DLC-IND-SCTB IN DLC = 'CAS' AND
                     DLC-IND-SCBZ IN DLC = SPACES )
               DISPLAY 'DLC(3)-SCTB:' DLC-IND-SCTB IN DLC
               DISPLAY 'SCBZ:' DLC-IND-SCBZ IN DLC
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
               GO TO FIN-PRO-TRASPASO-CAST.

      * Guardo el plazo contable para grabar la nueva DLC
            MOVE DLC-COD-PLZO IN DLC TO WSS-COD-PLZO IN WSS-VARI.

      *CAH-INI 24-FEB-2000 PROCESA CREDITOS COMERCIALES Y DE CONSUMO
      *    PERFORM VAL-CLASE-CON.
      *    IF WSS-IND-FLAG IN WSS-VARI = 1
      *        MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
      *        DISPLAY 'CASO(4) CREDITO EN CONSUMO'
      *        DISPLAY 'OPC:' OPC-CIC-IOPC IN OPC
      *        ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
      *        GO TO FIN-PRO-TRASPASO-CAST.
      *CAH-FIN 24-FEB-2000 PROCESA CREDITOS COMERCIALES Y DE CONSUMO

      * Guardo la oficina y el valor liquido para grabar la nueva OPC
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI.
           MOVE OPC-COD-OFOC IN OPC TO WSS-COD-OFOC IN WSS-VARI.
           MOVE OPC-SGV-LIQU IN OPC TO WSS-SGV-LIQU IN WSS-VARI.
           MOVE OPC-COD-RMOC IN OPC TO WSS-COD-RMOC IN WSS-VARI.
           MOVE OPC-COD-CDOC IN OPC TO WSS-COD-CDOC IN WSS-VARI.
           MOVE OPC-IND-GARA IN OPC TO WSS-IND-GARA IN WSS-VARI.
           MOVE OPC-IND-VSTR IN OPC TO WSS-IND-VSTR IN WSS-VARI.
           MOVE OPC-IND-AFER IN OPC TO WSS-IND-AFER IN WSS-VARI.

           PERFORM LEE-VEN.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               GO TO FIN-PRO-TRASPASO-CAST.

           PERFORM PRO-FMVE.
           IF WSS-FEC-FMVE IN WSS-VARI = ZEROES
               MOVE VEN-NUM-DIMV IN VEN TO WSS-NUM-DMVE
               MOVE VEN-NUM-MIMV IN VEN TO WSS-NUM-MMVE
               MOVE VEN-NUM-SIMV IN VEN TO WSS-NUM-SMVE
               MOVE VEN-NUM-AIMV IN VEN TO WSS-NUM-AMVE.

           IF VEN-FEC-FVEN IN VEN NOT = VEN-FEC-FIMV IN VEN AND
              OPC-NUM-VCVG IN OPC = 1 AND
              OPC-IND-AFER IN OPC = 'N'
               MOVE VEN-FEC-FIMV IN VEN  TO VEN-FEC-FVEN IN VEN.

           PERFORM OBT-CIC-ICLI.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               GO TO FIN-PRO-TRASPASO-CAST.

      * Se guarda tambien el CIC del cliente para grabar la nueva RDC
           MOVE RDC-CIC-ICLI IN RDC TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE RDC-NUM-DIRE IN RDC TO WSS-NUM-DIRE IN WSS-VARI.

           MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVEN IN WSS-VARI.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
              PERFORM LEE-EVC
              IF WSS-IND-FLAG IN WSS-VARI = 1
                 MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                 ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
                 GO TO FIN-PRO-TRASPASO-CAST
              ELSE
                 MOVE EVC-MSC-TCVE IN EVC TO WSS-MSC-TCVE IN WSS-VARI.

      * Se obtienen los valores de cambio de UF a FCOL y FCAN para
      * calcular los Reajustes y total renovado
           IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
               PERFORM OBT-VALOR-FCOL
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                   ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
                   GO TO FIN-PRO-TRASPASO-CAST
               ELSE
                   PERFORM OBT-VALOR-FCAN
                   IF WSS-IND-FLAG IN WSS-VARI = 1
                       MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                       ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
                       GO TO FIN-PRO-TRASPASO-CAST
                   ELSE
                       NEXT SENTENCE
           ELSE
               MOVE 1 TO WSS-SGV-VCOL IN WSS-VARI
               MOVE 1 TO WSS-SGV-VCAN IN WSS-VARI.

           PERFORM LEE-NUEVA-CLASE-CAS.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA CAS: CAS'
                                      OPC-COD-COOC IN OPC
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               MOVE 'CLACAS NEX' TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-PRO-TRASPASO-CAST.

           PERFORM LEE-PVC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE SPACES TO PVC
               MOVE WSS-MSC-TCVE IN WSS-VARI TO PVC-MSC-TCVE IN PVC.

           PERFORM INGRESO-CAN.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RNIN IN WSS-VARI
               PERFORM BCK-OUT
               GO TO FIN-PRO-TRASPASO-CAST.

           PERFORM INGRESO-NUEVA-OPC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RONI IN WSS-VARI
               PERFORM BCK-OUT
               GO TO FIN-PRO-TRASPASO-CAST.

           PERFORM ACTIVO-CAN.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RNAC IN WSS-VARI
               PERFORM BCK-OUT
               GO TO FIN-PRO-TRASPASO-CAST.

      * Ahora que esta activa la CAN se debe activar la OPC
           PERFORM ACTIVO-NUEVA-OPC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               ADD 1 TO WSS-NUM-RONA IN WSS-VARI
               PERFORM BCK-OUT
               GO TO FIN-PRO-TRASPASO-CAST.

           MOVE SPACES TO WSS-STAT-CAE.
       FIN-PRO-TRASPASO-CAST.
           EXIT.

      ******************************************************************
       LEE-OPC SECTION.
      *---------------
       INI-LEE-OPC.
           MOVE OPC-CIC-IOPC IN OPS TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLOPC: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'OPS  NOOPC'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
      *POR MIENTRAS
               MOVE OPS TO OPC
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
      *POR MIENTRAS
               GO TO FIN-LEE-OPC.
       FIN-LEE-OPC.
           EXIT.

      ******************************************************************
       OBT-CIC-ICLI SECTION.
      *--------------------
       INI-OBT-CIC-ICLI.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = RDC-CIC-IOPC IN RDC )
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLRDC: '
                       RDC-KEY-IDLC IN RDC ' ' FIO-STAT
               MOVE 'OPC  NORDC'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-OBT-CIC-ICLI.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA SGCDBC: '
                        RDC-CIC-ICLI IN RDC ' ' FIO-STAT
               MOVE 'RDCNODBC'          TO ERC-COD-MSGE IN ERC
               MOVE RDC-CIC-IOPC IN RDC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-OBT-CIC-ICLI.
       FIN-OBT-CIC-ICLI.
           EXIT.

      ******************************************************************
       LEE-DLC SECTION.
      *---------------
       INI-LEE-DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC )
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLDLC: '
                        OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               DISPLAY 'DLC-CIC-IOPC:' DLC-CIC-IOPC IN DLC
               MOVE 'OPC  NODLC'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LEE-DLC.
       FIN-LEE-DLC.
           EXIT.

      ******************************************************************
       LEE-EVC SECTION.
      *---------------
       INI-LEE-EVC.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = EVC-CIC-IOPC IN EVC )
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLEVC: '
                        OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'OPC  NOEVC'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LEE-EVC.
       FIN-LEE-EVC.
           EXIT.

      ******************************************************************
       LEE-VEN SECTION.
      *---------------
       INI-LEE-VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLVEN: '
                        OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'OPC  NOVEN'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LEE-VEN.
       FIN-LEE-VEN.
           EXIT.

      ******************************************************************
       OBT-VALOR-FCOL SECTION.
      *----------------------
       INI-OBT-VALOR-FCOL.
           MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1).
           MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (FIO-STAT-OKS AND
              CAM-IND-VIGE IN CAM = 'S')
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'CAMVCAM NEX : '
                           CAM-KEY-CAMB IN CAM
               MOVE 'CAM    NEX'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-OBT-VALOR-FCOL.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCOL IN WSS-VARI.

           IF WSS-IND-FLAG IN WSS-VARI = 'S'
               DISPLAY 'FCOL: ' OPC-FEC-FCOL IN OPC
               DISPLAY 'UF A FCOL: ' WSS-SGV-VCOL IN WSS-VARI.
       FIN-OBT-VALOR-FCOL.
           EXIT.

      ******************************************************************
       OBT-VALOR-FCAN SECTION.
      *----------------------
       INI-OBT-VALOR-FCAN.
           MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (FIO-STAT-OKS AND
              CAM-IND-VIGE IN CAM = 'S')
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'CAMVCAM NEX : '
                           CAM-KEY-CAMB IN CAM
               MOVE 'CAM    NEX'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-OBT-VALOR-FCAN.

           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAN IN WSS-VARI.

           IF WSS-IND-FLAG IN WSS-VARI = 'S'
               DISPLAY 'FCAN: ' VEN-FEC-FVEN IN VEN
               DISPLAY 'UF A FCAN: ' WSS-SGV-VCAN IN WSS-VARI.
       FIN-OBT-VALOR-FCAN.
           EXIT.

      ******************************************************************
      * Se hace el ingreso de la CAN como RTE y de las entidades anexas
      * segun pgm COLPGCVS
       INGRESO-CAN SECTION.
      *-------------------
       INI-INGRESO-CAN.
           PERFORM LIMPIA-CAN.
           PERFORM LIMPIA-ICG.
           PERFORM LIMPIA-ROV.
           PERFORM LIMPIA-RCV.
           PERFORM LIMPIA-CYA.
      * Lee ultima CAN para saber correlativo de CAN a utilizar
           PERFORM BUS-CORR-CAN.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               DISPLAY 'CANCELACION YA INGRESADA: ' CAN-CIC-IOPC IN CAN
                                  CAN-NUM-ICAN IN CAN
               MOVE 'CAN  YAING'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN
           ELSE
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CORRELATIVO CAN: '
                    VEN-CIC-IOPC IN VEN ' ' WSS-NUM-CORR IN WSS-VARI.

           PERFORM LLE-REG-CAN.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-INGRESO-CAN.

           PERFORM LLE-REG-ROV.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-INGRESO-CAN.

           PERFORM LLE-REG-RCV.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-INGRESO-CAN.

           PERFORM LLE-REG-CYA.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-INGRESO-CAN.

           MOVE FIO-PUT TO FIO-CMND.

           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO CAN: '
                       CAN-KEY-ICAN IN CAN ' ' FIO-STAT
               MOVE 'CANNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN.

           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO ROV: '
                       ROV-KEY-IREG IN ROV ' ' FIO-STAT
               MOVE 'ROVNOGRABA'             TO ERC-COD-MSGE IN ERC
               MOVE WSS-CIC-IOPC IN WSS-VARI TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN.

           PERFORM COL-FIO-RCV.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO RCV: '
                       RCV-KEY-IREG IN RCV ' ' FIO-STAT
               MOVE 'RCVNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE RCV-CIC-IOPC IN RCV TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN.

           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO CYA: '
                       CYA-KEY-ICYA IN CYA ' ' FIO-STAT
               MOVE 'CYANOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE CYA-CIC-IOPC IN CYA TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-CAN.

           ADD 1 TO WSS-NUM-RGRA IN WSS-VARI.
       FIN-INGRESO-CAN.
           EXIT.

      ******************************************************************
       INGRESO-NUEVA-OPC SECTION.
      *-------------------------
       INI-INGRESO-NUEVA-OPC.
           PERFORM LIMPIA-NUEVA-OPC.
           PERFORM LIMPIA-NUEVA-DLC.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               PERFORM LIMPIA-NUEVA-EVC.

           PERFORM LIMPIA-NUEVA-VEN.
           PERFORM LIMPIA-CYA.
           PERFORM LIMPIA-ICG.
           PERFORM LIMPIA-NUEVA-RDC.

           PERFORM LLE-REG-NUEVA-OPC.
           PERFORM LLE-REG-NUEVA-DLC.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               PERFORM LLE-REG-NUEVA-EVC.

           PERFORM LLE-REG-NUEVA-VEN.
           PERFORM LLE-REG-NUEVA-CYA.
           PERFORM LLE-REG-NUEVA-ICG.

           PERFORM LLE-REG-NUEVA-RDC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               GO TO FIN-INGRESO-NUEVA-OPC.

           MOVE FIO-PUT TO FIO-CMND.

           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA OPC: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'OPCNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.

           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA DLC: '
                       DLC-KEY-IREG IN DLC ' ' FIO-STAT
               MOVE 'DLCNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               PERFORM COL-FIO-EVC
               IF NOT FIO-STAT-OKS
                   MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                   DISPLAY 'ERROR INGRESO NUEVA EVC: '
                           EVC-KEY-IREG IN EVC ' ' FIO-STAT
                   MOVE 'EVCNOGRABA'        TO ERC-COD-MSGE IN ERC
                   MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
                   PERFORM GRABAR-ERROR
                   GO TO FIN-INGRESO-NUEVA-OPC.

           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA VEN: '
                       VEN-KEY-IREG IN VEN ' ' FIO-STAT
               MOVE 'VENNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.

           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA CYA: '
                       CYA-KEY-IREG IN CYA ' ' FIO-STAT
               MOVE 'CYANOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.

           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA ICG: '
                       ICG-KEY-IREG IN ICG ' ' FIO-STAT
               MOVE 'ICGNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-INGRESO-NUEVA-OPC.

           ADD 1 TO WSS-NUM-ROIN IN WSS-VARI.
       FIN-INGRESO-NUEVA-OPC.
           EXIT.

      ******************************************************************
      * Proceso de activacion de una Cancelacion
      * Despues de tener buffer cargado ( CAN-FLD ) realiza el mismo
      * proceso del programa interactivo ( ver CMN-ACC )
      *
       ACTIVO-CAN SECTION.
      *------------------
       INI-ACTIVO-CAN.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVEN IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.

           MOVE 'CAN' TO SCR-CMND.
           MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD.

           PERFORM INI-CAN.
           IF ( CAN-MSC-FCAN IN CAN = 'T' AND
                CAN-MSC-ECAN IN CAN = 'T' ) OR
              ( CAN-MSC-FCAN IN CAN = 'T' AND
                CAN-MSC-ECAN IN CAN = 'E' AND
                OPC-NUM-VCOR IN OPC = 1 )
                 PERFORM TOT-CUO
           ELSE
               PERFORM PRO-RCV.

           IF MSG-COD-MENS > SPACES
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY MSG-COD-MENS
               MOVE MSG-COD-MENS        TO ERC-COD-MSGE IN ERC
               MOVE VEN-CIC-IOPC IN VEN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-ACTIVO-CAN.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'CAN    NOUPD: ' CAN-KEY-IREG IN CAN
               MOVE 'CAN  NOUPD'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-ACTIVO-CAN.

           MOVE 'A' TO CAN-MSC-STAT IN CAN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CAN    NOMOD: ' CAN-KEY-IREG IN CAN
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               MOVE 'CAN  NOMOD'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-ACTIVO-CAN.

           ADD 1 TO WSS-NUM-RACT IN WSS-VARI.
           MOVE ZEROES TO WSS-IND-FLAG IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CAN ACTIVADA: ' CAN.
       FIN-ACTIVO-CAN.
           EXIT.

      ******************************************************************
       ACTIVO-NUEVA-OPC SECTION.
      *------------------------
       INI-ACTIVO-NUEVA-OPC.
           MOVE ROV-CIC-IOPC IN ROV TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE 'A' TO OPC-MSC-STAT IN OPC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR ACTUALIZACION COLOPC: '
                                    OPC-CIC-IOPC IN OPC
               MOVE 'OPC  NOMOD'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-ACTIVO-NUEVA-OPC.

           ADD 1 TO WSS-NUM-ROAC IN WSS-VARI.
       FIN-ACTIVO-NUEVA-OPC.
           EXIT.

      ******************************************************************
       INI-CAN SECTION.
      *---------------
       INI-INI-CAN.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE ZEROES TO WSS-NUM-VCVG IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCM IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCO IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCV IN WSS-VARI.
           PERFORM RST-DLC VARYING WSS-NUM-IDLC FROM 1 BY 1
                           UNTIL   WSS-NUM-IDLC > WSS-LIM-IDLC.
       FIN-INI-CAN.
           EXIT.

      ******************************************************************
       RST-DLC SECTION.
      *---------------
       INI-RST-DLC.
           MOVE ZEROES TO WSS-SGV-CAPD(WSS-NUM-IDLC)
                          WSS-SGV-FINA(WSS-NUM-IDLC).
       FIN-RST-DLC.
           EXIT.

      ******************************************************************
       LEE-NUEVA-CLASE-CAS SECTION.
      *---------------------------
       INI-LEE-NUEVA-CLASE-CAS.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'LEE NUEVA CLASE CAS'
               DISPLAY 'CLASE ANTIGUA: ' OPC-COD-COOC IN OPC.

           MOVE SPACES              TO WSS-COD-CTAB IN WSS-VARI.
           MOVE OPC-COD-COOC IN OPC TO WSS-COD-CLASE IN WSS-VARI.

           MOVE 'COL' TO FIO-SIST.
           MOVE 'CAS'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-LEE-NUEVA-CLASE-CAS.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB IN WSS-VARI.

           IF NOT ( FIO-STAT-OKS AND
              TAB-COD-TTAB IN TAB = 'CAS' AND
              TAB-IND-VIGE IN TAB = 'S' AND
              WSS-COD-CLASE IN WSS-VARI = OPC-COD-COOC IN OPC )
               MOVE 'CAS'                    TO TAB-COD-TTAB IN TAB
               MOVE SPACES              TO WSS-COD-CTAB IN WSS-VARI
               MOVE OPC-COD-TOOC IN OPC TO WSS-COD-TIOC IN WSS-VARI
               MOVE '*  '               TO WSS-COD-AUXC IN WSS-VARI
               MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM GNS-FIO-TAB
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB IN WSS-VARI
               IF NOT ( FIO-STAT-OKS AND
                  TAB-COD-TTAB IN TAB = 'CAS' AND
                  TAB-IND-VIGE IN TAB = 'S' AND
                  WSS-COD-TIOC IN WSS-VARI = OPC-COD-TOOC IN OPC AND
                  WSS-COD-AUXC IN WSS-VARI = '*  ' )
                   MOVE 'CAS'                    TO TAB-COD-TTAB IN TAB
                   MOVE SPACES              TO WSS-COD-CTAB IN WSS-VARI
                   MOVE '*  '               TO WSS-COD-TIOC IN WSS-VARI
                   MOVE SPACES              TO WSS-COD-AUXC IN WSS-VARI
                   MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB
                   MOVE FIO-GET-NLS TO FIO-CMND
                   PERFORM GNS-FIO-TAB
                   MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB IN WSS-VARI
                   IF NOT ( FIO-STAT-OKS AND
                      TAB-COD-TTAB IN TAB = 'CAS' AND
                      TAB-IND-VIGE IN TAB = 'S' AND
                      WSS-COD-CLASE IN WSS-VARI = '*     ' )
                       MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
                       GO TO FIN-LEE-NUEVA-CLASE-CAS.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB IN WSS-VARI.

           PERFORM LEE-POC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE 'COL' TO FIO-SIST
               MOVE 'CAS' TO TAB-COD-TTAB IN TAB
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-LEE-NUEVA-CLASE-CAS.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CLASE NUEVA OPC: ' WSS-COD-VCDA IN WSS-VARI.
       FIN-LEE-NUEVA-CLASE-CAS.
           EXIT.

      ******************************************************************
       LEE-POC SECTION.
      *---------------
       INI-LEE-POC.
      *ALD-BCI-INI/10032000
      *    MOVE OPC-COD-VCOC IN OPC      TO POC-COD-VCOC IN POC.
           MOVE '0999  '                 TO POC-COD-VCOC IN POC.
      *ALD-BCI-FIN/10032000
           MOVE WSS-COD-VCDA IN WSS-VARI TO POC-COD-COOC IN POC.
           MOVE ZEROES                   TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI.
       FIN-LEE-POC.
           EXIT.

      ******************************************************************
       LEE-PVC SECTION.
      *---------------
       INI-LEE-PVC.
           MOVE POC-COD-IPVC IN POC TO PVC-CIC-IPVC IN PVC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-PVC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI.
       FIN-LEE-PVC.
           EXIT.

      ******************************************************************
       LIMPIA-CAN SECTION.
      *------------------
       INI-LIMPIA-CAN.
           MOVE SPACES TO CAN-CIC-IOPC IN CAN.
           MOVE ZEROES TO CAN-NUM-ICAN IN CAN.
           MOVE SPACES TO CAN-COD-RCAN IN CAN.
           MOVE SPACES TO CAN-MSC-STAT IN CAN.
           MOVE SPACES TO CAN-MSC-CANC IN CAN.
           MOVE ZEROES TO CAN-FEC-FOUT IN CAN.
           MOVE ZEROES TO CAN-FEC-FCAN IN CAN.
           MOVE ZEROES TO CAN-FEC-FEGR IN CAN.
           MOVE SPACES TO CAN-COD-OFCA IN CAN.
           MOVE ZEROES TO CAN-SGV-GAST IN CAN.
           MOVE ZEROES TO CAN-SGV-TREN IN CAN.
           MOVE ZEROES TO CAN-SGV-TPAG IN CAN.
           MOVE ZEROES TO CAN-SGV-DIFE IN CAN.
           MOVE SPACES TO CAN-FEC-FTRN IN CAN.
           MOVE SPACES TO CAN-HRA-HRTR IN CAN.
           MOVE ZEROES TO CAN-NUM-TVCC IN CAN.
           MOVE SPACES TO CAN-COD-ATRN IN CAN.
       FIN-LIMPIA-CAN.
           EXIT.

      ******************************************************************
       LIMPIA-ROV SECTION.
      *------------------
       INI-LIMPIA-ROV.
           MOVE SPACES TO ROV-CIC-IOPC IN ROV.
           MOVE ZEROES TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES TO ROV-NUM-IVCT IN ROV.
           MOVE ZEROES TO ROV-SGV-RENO IN ROV.
       FIN-LIMPIA-ROV.
           EXIT.

      ******************************************************************
       LIMPIA-RCV SECTION.
      *------------------
       INI-LIMPIA-RCV.
           MOVE SPACES TO RCV-CIC-IOPC IN RCV.
           MOVE ZEROES TO RCV-NUM-ICAN IN RCV.
           MOVE SPACES TO RCV-CIC-IOPV IN RCV.
           MOVE ZEROES TO RCV-NUM-IVCT IN RCV.
           MOVE SPACES TO RCV-MSC-MCAN IN RCV.
           MOVE ZEROES TO RCV-SGV-CAPI IN RCV.
           MOVE ZEROES TO RCV-SGV-FINA IN RCV.
           MOVE ZEROES TO RCV-SGV-REAJ IN RCV.
           MOVE SPACES TO RCV-CIC-IOPD IN RCV.
           MOVE ZEROES TO RCV-NUM-IDLC IN RCV.
           MOVE ZEROES TO RCV-NUM-IEVC IN RCV.
           MOVE ZEROES TO RCV-SGV-INTE IN RCV.
           MOVE ZEROES TO RCV-IND-SCTB IN RCV.
           MOVE ZEROES TO RCV-FEC-FCAN IN RCV.
           MOVE ZEROES TO RCV-FEC-FOUT IN RCV.
           MOVE ZEROES TO RCV-SGV-INTN IN RCV.
           MOVE ZEROES TO RCV-SGV-INTM IN RCV.
           MOVE SPACES TO RCV-GLS-DISP IN RCV.
           MOVE ZEROES TO RCV-NUM-IDLC IN RCV.
           MOVE SPACES TO RCV-MSC-STAT IN RCV.
           MOVE SPACES TO RCV-IND-SCBZ IN RCV.
       FIN-LIMPIA-RCV.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-OPC SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-OPC.
           MOVE SPACES              TO OPC-CIC-IOPC IN OPC.
           MOVE SPACES              TO OPC-GLS-FLAG IN OPC.
           MOVE SPACES              TO OPC-MSC-STAT IN OPC.
           MOVE SPACES              TO OPC-COD-OTRN IN OPC.
           MOVE SPACES              TO OPC-COD-ATRN IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCOR IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCVG IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCCO IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCCM IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCCV IN OPC.
           MOVE ZEROES              TO OPC-NUM-TVCC IN OPC.
           MOVE SPACES              TO OPC-MSC-TCVE IN OPC.
           MOVE SPACES              TO OPC-MSC-BCCR IN OPC.
           MOVE SPACES              TO OPC-MSC-VICR IN OPC.
           MOVE SPACES              TO OPC-COD-AGES IN OPC.
           MOVE SPACES              TO OPC-GLS-DISP IN OPC.
           MOVE SPACES              TO OPC-STP-ITRN IN OPC.
           MOVE ZEROES              TO OPC-NUM-IVEN IN OPC.

           MOVE SPACES              TO OPC-MSC-TVOC IN OPC.
           MOVE SPACES              TO OPC-COD-TOOC IN OPC.
           MOVE SPACES              TO OPC-COD-OFOC IN OPC.
           MOVE SPACES              TO OPC-COD-VCOC IN OPC.
           MOVE SPACES              TO OPC-COD-AOOC IN OPC.
           MOVE ZEROES              TO OPC-VAL-CRED IN OPC.
           MOVE ZEROES              TO OPC-VAL-SCRE IN OPC.
           MOVE SPACES              TO OPC-CAI-ILDC IN OPC.
           MOVE SPACES              TO OPC-IIC-ILDC IN OPC.
           MOVE ZEROES              TO OPC-NUM-VCVG IN OPC.
           MOVE SPACES              TO OPC-IND-CTBL IN OPC.
           MOVE SPACES              TO OPC-IND-RENO IN OPC.
           MOVE SPACES              TO OPC-CAI-ICEN IN OPC.
           MOVE SPACES              TO OPC-IIC-ICEN IN OPC.
           MOVE ZEROES              TO OPC-NUM-DINP IN OPC.
           MOVE ZEROES              TO OPC-NUM-MINP IN OPC.
           MOVE ZEROES              TO OPC-NUM-SINP IN OPC.
           MOVE ZEROES              TO OPC-NUM-AINP IN OPC.
           MOVE ZEROES              TO OPC-NUM-DCOL IN OPC.
           MOVE ZEROES              TO OPC-NUM-MCOL IN OPC.
           MOVE ZEROES              TO OPC-NUM-SCOL IN OPC.
           MOVE ZEROES              TO OPC-NUM-ACOL IN OPC.
           MOVE ZEROES              TO OPC-NUM-DING IN OPC.
           MOVE ZEROES              TO OPC-NUM-MING IN OPC.
           MOVE ZEROES              TO OPC-NUM-SING IN OPC.
           MOVE ZEROES              TO OPC-NUM-AING IN OPC.
           MOVE ZEROES              TO OPC-VAL-SEGP IN OPC.
           MOVE SPACES              TO OPC-COD-CVTA IN OPC.
           MOVE SPACES              TO OPC-IND-GARA IN OPC.
           MOVE SPACES              TO OPC-IND-VSTR IN OPC.
           MOVE ZEROES              TO OPC-SGV-VCOM IN OPC.
           MOVE SPACES              TO OPC-MSC-MCVF IN OPC.
           MOVE SPACES              TO OPC-IND-AFER IN OPC.
           MOVE ZEROES              TO OPC-VAL-GAST IN OPC.
           MOVE ZEROES              TO OPC-SGV-LIQU IN OPC.
           MOVE SPACES              TO OPC-COD-RMOC IN OPC.
           MOVE SPACES              TO OPC-COD-INSI IN OPC.
           MOVE SPACES              TO OPC-COD-CDOC IN OPC.
           MOVE ZEROES              TO OPC-VAL-SEGD IN OPC.
           MOVE SPACES              TO OPC-COD-SEGD IN OPC.
       FIN-LIMPIA-NUEVA-OPC.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-DLC SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-DLC.
           MOVE SPACES              TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE SPACES              TO DLC-STP-ITRN IN DLC.
           MOVE ZEROES              TO DLC-FEC-FTRN IN DLC.
           MOVE ZEROES              TO DLC-HRA-HRTR IN DLC.
           MOVE SPACES              TO DLC-MSC-TACC IN DLC.
           MOVE SPACES              TO DLC-MSC-STAT IN DLC.
           MOVE SPACES              TO DLC-COD-OTRN IN DLC.
           MOVE SPACES              TO DLC-COD-ATRN IN DLC.
           MOVE ZEROES              TO DLC-VAL-NDLC IN DLC.
           MOVE ZEROES              TO DLC-VAL-SDLC IN DLC.
           MOVE SPACES              TO DLC-COD-TDOC IN DLC.
           MOVE SPACES              TO DLC-COD-PLZO IN DLC.
           MOVE SPACES              TO DLC-MSC-TIMP IN DLC.
           MOVE ZEROES              TO DLC-VAL-IMPU IN DLC.
           MOVE SPACES              TO DLC-COD-NOTC IN DLC.
           MOVE ZEROES              TO DLC-VAL-GNOT IN DLC.
           MOVE SPACES              TO DLC-IND-SCBZ IN DLC.
           MOVE SPACES              TO DLC-IND-SCRT IN DLC.
           MOVE SPACES              TO DLC-COD-UBFD IN DLC.
           MOVE SPACES              TO DLC-COD-PLZA IN DLC.
           MOVE SPACES              TO DLC-MSC-MIPL IN DLC.
           MOVE SPACES              TO DLC-IND-RIES IN DLC.
           MOVE ZEROES              TO DLC-VAL-READ IN DLC.
           MOVE ZEROES              TO DLC-VAL-INTD IN DLC.
           MOVE ZEROES              TO DLC-FEC-FDEV IN DLC.
           MOVE ZEROES              TO DLC-VAL-SINT IN DLC.
           MOVE ZEROES              TO DLC-VAL-SCPA IN DLC.
           MOVE ZEROES              TO DLC-FEC-FAMT IN DLC.
           MOVE SPACES              TO DLC-CIC-IOCO IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLO IN DLC.
           MOVE ZEROES              TO DLC-VAL-IPEN IN DLC.
           MOVE ZEROES              TO DLC-VAL-DPES IN DLC.
           MOVE SPACES              TO DLC-IND-SCTB IN DLC.
           MOVE ZEROES              TO DLC-FEC-FMAV IN DLC.
           MOVE ZEROES              TO DLC-NUM-VSCE IN DLC.
           MOVE ZEROES              TO DLC-FEC-FSDE IN DLC.
           MOVE ZEROES              TO DLC-VAL-PIMP IN DLC.
           MOVE SPACES              TO DLC-COD-SUSP IN DLC.
           MOVE ZEROES              TO DLC-FEC-FSDM IN DLC.
           MOVE SPACES              TO DLC-GLS-DISP IN DLC.
       FIN-LIMPIA-NUEVA-DLC.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-EVC SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-EVC.
           MOVE SPACES              TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE SPACES              TO EVC-STP-ITRN IN EVC.
           MOVE ZEROES              TO EVC-FEC-FTRN IN EVC.
           MOVE ZEROES              TO EVC-HRA-HRTR IN EVC.
           MOVE SPACES              TO EVC-MSC-TACC IN EVC.
           MOVE SPACES              TO EVC-MSC-STAT IN EVC.
           MOVE SPACES              TO EVC-COD-OTRN IN EVC.
           MOVE SPACES              TO EVC-COD-ATRN IN EVC.
           MOVE ZEROES              TO EVC-NUM-VIGU IN EVC.
           MOVE ZEROES              TO EVC-NUM-VCAN IN EVC.
           MOVE ZEROES              TO EVC-NUM-SEVE IN EVC.
           MOVE SPACES              TO EVC-IND-UTSV IN EVC.
           MOVE ZEROES              TO EVC-FEC-FPVC IN EVC.
           MOVE ZEROES              TO EVC-NUM-DESD IN EVC.
           MOVE ZEROES              TO EVC-SGV-FVAR IN EVC.
           MOVE SPACES              TO EVC-IND-FVAR IN EVC.
           MOVE ZEROES              TO EVC-VAL-VENC IN EVC.
           MOVE SPACES              TO EVC-MSC-TCVE IN EVC.
           MOVE ZEROES              TO EVC-NUM-IVCT IN EVC.
           MOVE ZEROES              TO EVC-NUM-IDLC IN EVC.
           MOVE ZEROES              TO EVC-NUM-DPVE IN EVC.
           MOVE SPACES              TO EVC-IND-CAUT IN EVC.
           MOVE ZEROES              TO EVC-NUM-DURV IN EVC.
           MOVE SPACES              TO EVC-IND-UTDV IN EVC.
           MOVE ZEROES              TO EVC-VAL-VCVF IN EVC.
           MOVE SPACES              TO EVC-GLS-DISP IN EVC.
       FIN-LIMPIA-NUEVA-EVC.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-VEN SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-VEN.
           MOVE SPACES              TO VEN-GLS-FLAG IN VEN.
           MOVE SPACES              TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE SPACES              TO VEN-STP-ITRN IN VEN.
           MOVE ZEROES              TO VEN-NUM-SSTR IN VEN.
           MOVE SPACES              TO VEN-MSC-TACC IN VEN.
           MOVE SPACES              TO VEN-MSC-STAT IN VEN.
           MOVE SPACES              TO VEN-COD-OTRN IN VEN.
           MOVE SPACES              TO VEN-COD-ATRN IN VEN.
           MOVE ZEROES              TO VEN-FEC-FVEN IN VEN.
           MOVE ZEROES              TO VEN-FEC-FIMV IN VEN.
           MOVE ZEROES              TO VEN-VAL-CAPI IN VEN.
           MOVE ZEROES              TO VEN-VAL-SCAP IN VEN.
           MOVE ZEROES              TO VEN-VAL-IDNI IN VEN.
           MOVE ZEROES              TO VEN-VAL-FINA IN VEN.
           MOVE ZEROES              TO VEN-VAL-SFIN IN VEN.
           MOVE SPACES              TO VEN-IND-SCTB IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVCT IN VEN.
           MOVE ZEROES              TO VEN-NUM-IEVC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IDLC IN VEN.
           MOVE SPACES              TO VEN-IND-CAUT IN VEN.
           MOVE SPACES              TO VEN-IND-SCBZ IN VEN.
           MOVE ZEROES              TO VEN-VAL-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-CALC IN VEN.
           MOVE SPACES              TO VEN-IND-CTBA IN VEN.
           MOVE SPACES              TO VEN-GLS-DISP IN VEN.
       FIN-LIMPIA-NUEVA-VEN.
           EXIT.

      ******************************************************************
       LIMPIA-CYA SECTION.
      *------------------
       INI-LIMPIA-CYA.
           MOVE SPACES              TO CYA-GLS-FLAG IN CYA.
           MOVE SPACES              TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE SPACES              TO CYA-STP-ITRN IN CYA.
           MOVE SPACES              TO CYA-MSC-TACC IN CYA.
           MOVE SPACES              TO CYA-MSC-STAT IN CYA.
           MOVE SPACES              TO CYA-COD-OTRN IN CYA.
           MOVE SPACES              TO CYA-COD-ATRN IN CYA.
           MOVE SPACES              TO CYA-IND-TCYA IN CYA.
           MOVE SPACES              TO CYA-CIC-ICYA IN CYA.
           MOVE SPACES              TO CYA-VRF-ICYA IN CYA.
           MOVE ZEROES              TO CYA-SGV-LIQU IN CYA.
           MOVE SPACES              TO CYA-IND-MAUT IN CYA.
           MOVE SPACES              TO CYA-IND-FREE IN CYA.
           MOVE SPACES              TO CYA-COD-OFIC IN CYA.
           MOVE SPACES              TO CYA-GLS-DISP IN CYA.
       FIN-LIMPIA-CYA.
           EXIT.

      ******************************************************************
       LIMPIA-ICG SECTION.
      *------------------
       INI-LIMPIA-ICG.
           MOVE SPACES              TO ICG-GLS-FLAG IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE SPACES              TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE SPACES              TO ICG-STP-ITRN IN ICG.
           MOVE SPACES              TO ICG-MSC-TACC IN ICG.
           MOVE SPACES              TO ICG-MSC-STAT IN ICG.
           MOVE SPACES              TO ICG-COD-OTRN IN ICG.
           MOVE SPACES              TO ICG-COD-ATRN IN ICG.
           MOVE SPACES              TO ICG-COD-TINT IN ICG.
           MOVE ZEROES              TO ICG-FEC-FTER IN ICG.
           MOVE ZEROES              TO ICG-SGV-SPRD IN ICG.
           MOVE ZEROES              TO ICG-SGV-TINT IN ICG.
           MOVE ZEROES              TO ICG-SGV-MNTO IN ICG.
           MOVE SPACES              TO ICG-GLS-DISP IN ICG.
       FIN-LIMPIA-ICG.
           EXIT.

      ******************************************************************
       LIMPIA-NUEVA-RDC SECTION.
      *------------------------
       INI-LIMPIA-NUEVA-RDC.
           MOVE SPACES              TO RDC-GLS-FLAG IN RDC.
           MOVE SPACES              TO RDC-CIC-ICLI IN RDC.
           MOVE SPACES              TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE SPACES              TO RDC-COD-TRDC IN RDC.
           MOVE SPACES              TO RDC-STP-ITRN IN RDC.
           MOVE SPACES              TO RDC-MSC-TACC IN RDC.
           MOVE SPACES              TO RDC-MSC-STAT IN RDC.
           MOVE SPACES              TO RDC-COD-OTRN IN RDC.
           MOVE SPACES              TO RDC-COD-ATRN IN RDC.
           MOVE ZEROES              TO RDC-NUM-DIRE IN RDC.
           MOVE ZEROES              TO RDC-VAL-LIMD IN RDC.
           MOVE SPACES              TO RDC-GLS-DISP IN RDC.
       FIN-LIMPIA-NUEVA-RDC.
           EXIT.

      ******************************************************************
       BUS-CORR-CAN SECTION.
      *--------------------
       INI-BUS-CORR-CAN.
      * Alternativa 1. Leer Menor o igual (LEQ) a CAN 999. No se puede
      * hacer pruebas en Realia
           MOVE VEN-CIC-IOPC IN VEN TO CAN-CIC-IOPC IN CAN.
           MOVE 999 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = VEN-CIC-IOPC IN VEN AND
              CAN-MSC-STAT IN CAN = 'A'
               ADD 1 TO CAN-NUM-ICAN IN CAN
                        GIVING WSS-NUM-CORR IN WSS-VARI
           ELSE
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = VEN-CIC-IOPC IN VEN
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               GO TO FIN-BUS-CORR-CAN
           ELSE
               MOVE 1 TO WSS-NUM-CORR IN WSS-VARI.

       FIN-BUS-CORR-CAN.
           EXIT.

      ******************************************************************
       LLE-REG-CAN SECTION.
      *-------------------
       INI-LLE-REG-CAN.
           MOVE VEN-CIC-IOPC IN VEN      TO CAN-CIC-IOPC IN CAN.
           MOVE WSS-NUM-CORR IN WSS-VARI TO CAN-NUM-ICAN IN CAN.
           MOVE OPC-COD-RMOC IN OPC      TO CAN-COD-RCAN IN CAN.
           MOVE 'V'                      TO CAN-MSC-STAT IN CAN.

           MOVE 'RTE'                    TO CAN-MSC-CANC IN CAN
           MULTIPLY VEN-VAL-SFIN IN VEN BY WSS-SGV-VCAN IN WSS-VARI
                                         GIVING CAN-SGV-TREN IN CAN.

           MOVE CAN-SGV-TREN IN CAN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TREN IN CAN.

           MOVE WSS-FEC-FFEC IN WSS-VARI TO CAN-FEC-FOUT IN CAN
                                            CAN-FEC-FEGR IN CAN.

           MOVE OPC-COD-OFOC IN OPC      TO CAN-COD-OFCA IN CAN.

           MOVE ZEROES                   TO CAN-SGV-GAST IN CAN
                                            CAN-SGV-TPAG IN CAN
                                            CAN-SGV-DIFE IN CAN
                                            CAN-SGV-IMOK IN CAN.

           MOVE VEN-FEC-FVEN IN VEN      TO CAN-FEC-FCAN IN CAN.

           MOVE HOY-FHOY                 TO CAN-FEC-FTRN IN CAN.
           MOVE HOY-HHOY                 TO CAN-HRA-HRTR IN CAN.
           MOVE 1                        TO CAN-NUM-TVCC IN CAN.
           MOVE 'COLPBCAE'               TO CAN-COD-ATRN IN CAN.
       FIN-LLE-REG-CAN.
           EXIT.

      ******************************************************************
       LLE-REG-ROV SECTION.
      *-------------------
       INI-LLE-REG-ROV.
           PERFORM BUS-NUM-CIC.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               GO TO FIN-LLE-REG-ROV.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CIC NUEVA OPC: ' CIC-CAI-ICIC CIC-IIC-ICIC.

           MOVE CIC-CAI-ICIC        TO ROV-CAI-IOPC IN ROV.
           MOVE CIC-IIC-ICIC        TO ROV-IIC-IOPC IN ROV.

           MOVE CAN-CIC-IOPC IN CAN TO ROV-CIC-IOPV IN ROV.
           MOVE CAN-NUM-ICAN IN CAN TO ROV-NUM-IVCT IN ROV.
           MOVE VEN-VAL-SFIN IN VEN TO ROV-SGV-RENO IN ROV.
           MOVE OPC-COD-VCOC IN OPC TO ROV-COD-VCVR IN ROV.
       FIN-LLE-REG-ROV.
           EXIT.

      ******************************************************************
       LLE-REG-RCV SECTION.
      *-------------------
       INI-LLE-REG-RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.

           MOVE VEN-NUM-IVCT IN VEN TO RCV-NUM-IVCT IN RCV.
           MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN RCV.
           MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN RCV.

           IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
               MULTIPLY RCV-SGV-CAPI IN RCV BY WSS-SGV-VCOL IN WSS-VARI
                         GIVING WSS-SGV-CAP1 IN WSS-VARI ROUNDED
               MULTIPLY RCV-SGV-CAPI IN RCV BY WSS-SGV-VCAN IN WSS-VARI
                         GIVING WSS-SGV-CAP2 IN WSS-VARI ROUNDED

               MOVE WSS-SGV-CAP1 IN WSS-VARI
                                 TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI
                                 TO WSS-SGV-CAP1 IN WSS-VARI

               MOVE WSS-SGV-CAP2 IN WSS-VARI
                                 TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI
                                 TO WSS-SGV-CAP2 IN WSS-VARI
           ELSE
               MOVE RCV-SGV-CAPI IN RCV TO WSS-SGV-CAP1 IN WSS-VARI
               MOVE RCV-SGV-CAPI IN RCV TO WSS-SGV-CAP2 IN WSS-VARI.

           SUBTRACT WSS-SGV-CAP1 IN WSS-VARI FROM
                   WSS-SGV-CAP2 IN WSS-VARI GIVING RCV-SGV-REAJ IN RCV.

           COMPUTE RCV-SGV-INTN IN RCV = CAN-SGV-TREN IN CAN -
                                         WSS-SGV-CAP1 IN WSS-VARI -
                                         RCV-SGV-REAJ IN RCV.

           MOVE RCV-SGV-INTN IN RCV TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-INTN IN RCV.

           MOVE 'F'                 TO RCV-MSC-MCAN IN RCV.

           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPD IN RCV.
           MOVE VEN-NUM-IDLC IN VEN TO RCV-NUM-IDLC IN RCV.
           MOVE VEN-NUM-IEVC IN VEN TO RCV-NUM-IEVC IN RCV.
           MOVE ZEROES              TO RCV-SGV-INTE IN RCV.
           MOVE ZEROES              TO RCV-SGV-INTM IN RCV.
           MOVE VEN-IND-SCTB IN VEN TO RCV-IND-SCTB IN RCV.
           MOVE CAN-FEC-FCAN IN CAN TO RCV-FEC-FCAN IN RCV.
           MOVE CAN-FEC-FOUT IN CAN TO RCV-FEC-FOUT IN RCV.
           MOVE SPACES              TO RCV-GLS-DISP IN RCV.
           MOVE SPACES              TO RCV-MSC-STAT IN RCV.
           MOVE VEN-IND-SCBZ IN VEN TO RCV-IND-SCBZ IN RCV.
           MOVE HOY-FHOY            TO RCV-FEC-FTRN IN RCV.
           MOVE HOY-HHOY            TO RCV-HRA-HRTR IN RCV.
       FIN-LLE-REG-RCV.
           EXIT.

      ******************************************************************
       LLE-REG-CYA SECTION.
      *-------------------
       INI-LLE-REG-CYA.
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE 'PBCAE'             TO CYA-IND-TCYA IN CYA.
           MOVE SPACES              TO CYA-CIC-ICYA IN CYA.
           MOVE SPACES              TO CYA-IND-MAUT IN CYA.
           MOVE ZEROES              TO CYA-SGV-LIQU IN CYA.
           MOVE SPACES              TO CYA-GLS-FLAG IN CYA.
           MOVE SPACES              TO CYA-VRF-ICYA IN CYA.
           MOVE SPACES              TO CYA-GLS-DISP IN CYA.
       FIN-LLE-REG-CYA.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-OPC SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-OPC.
           MOVE ROV-CIC-IOPC IN ROV      TO OPC-CIC-IOPC IN OPC.
           MOVE ROV-CIC-IOPC IN ROV      TO WSS-CIC-IOPN IN WSS-VARI.
           MOVE SPACES                   TO OPC-GLS-FLAG IN OPC.
           MOVE 'L'                      TO OPC-MSC-STAT IN OPC.
           MOVE SPACES                   TO OPC-COD-OTRN IN OPC.
           MOVE 'COLPBCAE'               TO OPC-COD-ATRN IN OPC.
           MOVE 1                        TO OPC-NUM-VCOR IN OPC.
           MOVE 1                        TO OPC-NUM-VCVG IN OPC.
           MOVE ZEROES                   TO OPC-NUM-VCCO IN OPC.
           MOVE ZEROES                   TO OPC-NUM-VCCM IN OPC.
           MOVE ZEROES                   TO OPC-NUM-VCCV IN OPC.
           MOVE ZEROES                   TO OPC-NUM-TVCC IN OPC.
           MOVE PVC-MSC-TCVE IN PVC      TO OPC-MSC-TCVE IN OPC.
           MOVE POC-MSC-BCCR IN POC      TO OPC-MSC-BCCR IN OPC.
           MOVE POC-MSC-VICR IN POC      TO OPC-MSC-VICR IN OPC.
           MOVE SPACES                   TO OPC-COD-AGES IN OPC.
           MOVE SPACES                   TO OPC-GLS-DISP IN OPC.
           MOVE HOY-FHOY                 TO OPC-FEC-FTRN IN OPC.
           MOVE HOY-HHOY                 TO OPC-HRA-HRTR IN OPC.
           MOVE 1                        TO OPC-NUM-IVEN IN OPC.

           MOVE WSS-COD-VCDA IN WSS-VARI TO OPC-COD-COOC IN OPC.
           MOVE WSS-COD-OFOC IN WSS-VARI TO OPC-COD-OFOC IN OPC.
           MOVE POC-COD-VCOC IN POC      TO OPC-COD-VCOC IN OPC.

      *ALD-BCI-INI/10032000
      *    MOVE ROV-SGV-RENO IN ROV      TO OPC-VAL-CRED IN OPC
      *                                     OPC-VAL-SCRE IN OPC.
           MOVE CAN-SGV-TREN IN CAN      TO OPC-VAL-CRED IN OPC
                                            OPC-VAL-SCRE IN OPC.
      *ALD-BCI-FIN/10032000

           MOVE ZEROES                   TO OPC-VAL-SEGP IN OPC
                                            OPC-SGV-VCOM IN OPC
                                            OPC-VAL-GAST IN OPC
                                            OPC-SGV-LIQU IN OPC
                                            OPC-VAL-SEGD IN OPC.

           MOVE SPACES                   TO OPC-CAI-ILDC IN OPC.
           MOVE SPACES                   TO OPC-IIC-ILDC IN OPC.
           MOVE SPACES                   TO OPC-IND-CTBL IN OPC.
           MOVE 'REN'                    TO OPC-IND-RENO IN OPC.
           MOVE SPACES                   TO OPC-CAI-ICEN IN OPC.
           MOVE SPACES                   TO OPC-IIC-ICEN IN OPC.

           MOVE WSS-FEC-FFEC IN WSS-VARI TO OPC-FEC-FINP IN OPC
                                            OPC-FEC-FING IN OPC.

           MOVE CAN-NUM-DCAN IN CAN      TO OPC-NUM-DCOL IN OPC.
           MOVE CAN-NUM-MCAN IN CAN      TO OPC-NUM-MCOL IN OPC.
           MOVE CAN-NUM-SCAN IN CAN      TO OPC-NUM-SCOL IN OPC.
           MOVE CAN-NUM-ACAN IN CAN      TO OPC-NUM-ACOL IN OPC.

           MOVE SPACES                   TO OPC-COD-CVTA IN OPC.
           MOVE WSS-IND-GARA IN WSS-VARI TO OPC-IND-GARA IN OPC.

           IF WSS-IND-VSTR IN WSS-VARI = 'S'
               MOVE 'S'                  TO OPC-IND-VSTR IN OPC
           ELSE
               MOVE 'N'                  TO OPC-IND-VSTR IN OPC.

           MOVE POC-MSC-MCVF IN POC      TO OPC-MSC-MCVF IN OPC.
           IF WSS-IND-AFER IN WSS-VARI = 'S'
               MOVE 'S'                  TO OPC-IND-AFER IN OPC
           ELSE
               MOVE 'N'                  TO OPC-IND-AFER IN OPC.
           MOVE WSS-COD-RMOC IN WSS-VARI TO OPC-COD-RMOC IN OPC.
           MOVE SPACES                   TO OPC-COD-INSI IN OPC.
           MOVE WSS-COD-CDOC IN WSS-VARI TO OPC-COD-CDOC IN OPC.
           MOVE POC-COD-SEGD IN POC      TO OPC-COD-SEGD IN OPC.
       FIN-LLE-REG-NUEVA-OPC.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-DLC SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-DLC.
           MOVE OPC-CIC-IOPC IN OPC      TO DLC-CIC-IOPC IN DLC.
           MOVE 1                        TO DLC-NUM-IDLC IN DLC.
           MOVE HOY-FHOY                 TO DLC-FEC-FTRN IN DLC.
           MOVE HOY-HHOY                 TO DLC-HRA-HRTR IN DLC.
           MOVE SPACES                   TO DLC-MSC-TACC IN DLC.
           MOVE SPACES                   TO DLC-MSC-STAT IN DLC.
           MOVE SPACES                   TO DLC-COD-OTRN IN DLC.
           MOVE SPACES                   TO DLC-COD-ATRN IN DLC.

           MOVE OPC-VAL-CRED IN OPC      TO DLC-VAL-NDLC IN DLC
                                            DLC-VAL-SDLC IN DLC.

           MOVE OPC-VAL-SCRE IN OPC      TO DLC-VAL-SCPA IN DLC.

           MOVE ZEROES                   TO DLC-VAL-IMPU IN DLC
                                            DLC-VAL-GNOT IN DLC
                                            DLC-VAL-READ IN DLC
                                            DLC-VAL-INTD IN DLC
                                            DLC-VAL-SINT IN DLC
                                            DLC-VAL-IPEN IN DLC
                                            DLC-VAL-DPES IN DLC
                                            DLC-VAL-PIMP IN DLC.

           MOVE POC-COD-TDOC IN POC      TO DLC-COD-TDOC IN DLC.
           MOVE WSS-COD-PLZO IN WSS-VARI TO DLC-COD-PLZO IN DLC.
           MOVE 'E'                      TO DLC-MSC-TIMP IN DLC.
           MOVE SPACES                   TO DLC-COD-NOTC IN DLC.
           MOVE 'NIS'                    TO DLC-IND-SCBZ IN DLC.
           MOVE SPACES                   TO DLC-IND-SCRT IN DLC.
           MOVE SPACES                   TO DLC-COD-UBFD IN DLC.
           MOVE SPACES                   TO DLC-COD-PLZA IN DLC.
           MOVE POC-MSC-MIPL IN POC      TO DLC-MSC-MIPL IN DLC.
           MOVE SPACES                   TO DLC-IND-RIES IN DLC.
           MOVE OPC-FEC-FCOL IN OPC      TO DLC-FEC-FDEV IN DLC.

           MOVE OPC-FEC-FCOL IN OPC      TO DLC-FEC-FAMT IN DLC.
           MOVE DLC-CIC-IOPC IN DLC      TO DLC-CIC-IOCO IN DLC.
           MOVE DLC-NUM-IDLC IN DLC      TO DLC-NUM-IDLO IN DLC.
           MOVE 'CAS'                    TO DLC-IND-SCTB IN DLC.
           MOVE OPC-FEC-FCOL IN OPC      TO DLC-FEC-FMAV IN DLC.
           MOVE ZEROES                   TO DLC-NUM-VSCE IN DLC.
           MOVE ZEROES                   TO DLC-FEC-FSDE IN DLC.
           MOVE SPACES                   TO DLC-COD-SUSP IN DLC.
           MOVE ZEROES                   TO DLC-FEC-FSDM IN DLC.
           MOVE SPACES                   TO DLC-GLS-DISP IN DLC.
       FIN-LLE-REG-NUEVA-DLC.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-EVC SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-EVC.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE 1                   TO EVC-NUM-IEVC IN EVC.
           MOVE HOY-FHOY            TO EVC-FEC-FTRN IN EVC.
           MOVE HOY-HHOY            TO EVC-HRA-HRTR IN EVC.
           MOVE SPACES              TO EVC-MSC-TACC IN EVC.
           MOVE SPACES              TO EVC-MSC-STAT IN EVC.
           MOVE SPACES              TO EVC-COD-OTRN IN EVC.
           MOVE SPACES              TO EVC-COD-ATRN IN EVC.
           MOVE 1                   TO EVC-NUM-VIGU IN EVC.
           MOVE 0                   TO EVC-NUM-VCAN IN EVC.
           MOVE ZEROES              TO EVC-NUM-SEVE IN EVC.
           MOVE SPACES              TO EVC-IND-UTSV IN EVC.
           MOVE CAN-FEC-FCAN IN CAN TO EVC-FEC-FPVC IN EVC.
           MOVE ZEROES              TO EVC-NUM-DESD IN EVC.
           MOVE ZEROES              TO EVC-SGV-FVAR IN EVC.
           MOVE SPACES              TO EVC-IND-FVAR IN EVC.
           MOVE ZEROES              TO EVC-VAL-VENC IN EVC.
           MOVE PVC-MSC-TCVE IN PVC TO EVC-MSC-TCVE IN EVC.
           MOVE 1                   TO EVC-NUM-IVCT IN EVC.
           MOVE 1                   TO EVC-NUM-IDLC IN EVC.
           MOVE ZEROES              TO EVC-NUM-DPVE IN EVC.
           MOVE POC-IND-CAUT IN POC TO EVC-IND-CAUT IN EVC.
           MOVE ZEROES              TO EVC-NUM-DURV IN EVC.
           MOVE SPACES              TO EVC-IND-UTDV IN EVC.

           MOVE VEN-VAL-CAPI IN VEN TO EVC-VAL-VCVF IN EVC.

           MOVE SPACES              TO EVC-GLS-DISP IN EVC.
       FIN-LLE-REG-NUEVA-EVC.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-VEN SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-VEN.
           MOVE SPACES              TO VEN-GLS-FLAG IN VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.

           MOVE HOY-FHOY            TO VEN-FEC-FTRN IN VEN.
           MOVE HOY-HHOY            TO VEN-HRA-HRTR IN VEN.

           MOVE ZEROES              TO VEN-NUM-SSTR IN VEN.
           MOVE SPACES              TO VEN-MSC-TACC IN VEN.
           MOVE SPACES              TO VEN-MSC-STAT IN VEN.
           MOVE SPACES              TO VEN-COD-OTRN IN VEN.
           MOVE SPACES              TO VEN-COD-ATRN IN VEN.
           MOVE OPC-FEC-FCOL IN OPC TO VEN-FEC-FVEN IN VEN.
           MOVE OPC-FEC-FCOL IN OPC TO VEN-FEC-FIMV IN VEN.
           IF WSS-FEC-FMVE IN WSS-VARI > ZEROES
               MOVE WSS-NUM-SMVE TO VEN-NUM-SIMV IN VEN
               MOVE WSS-NUM-AMVE TO VEN-NUM-AIMV IN VEN
               MOVE WSS-NUM-MMVE TO VEN-NUM-MIMV IN VEN
               MOVE WSS-NUM-DMVE TO VEN-NUM-DIMV IN VEN.

           MOVE OPC-VAL-CRED IN OPC TO VEN-VAL-CAPI IN VEN.
           MOVE OPC-VAL-CRED IN OPC TO VEN-VAL-SCAP IN VEN.
           MOVE ZEROES              TO VEN-VAL-IDNI IN VEN.
           MOVE OPC-VAL-CRED IN OPC TO VEN-VAL-FINA IN VEN.
           MOVE OPC-VAL-CRED IN OPC TO VEN-VAL-SFIN IN VEN.
           MOVE SPACES              TO VEN-IND-SCTB IN VEN.
           MOVE 1                   TO VEN-NUM-IVCT IN VEN.
           MOVE 1                   TO VEN-NUM-IEVC IN VEN.
           MOVE 1                   TO VEN-NUM-IDLC IN VEN.
           MOVE SPACES              TO VEN-IND-CAUT IN VEN.
           MOVE SPACES              TO VEN-IND-SCBZ IN VEN.
           MOVE ZEROES              TO VEN-VAL-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-CALC IN VEN.
           MOVE SPACES              TO VEN-IND-CTBA IN VEN.
           MOVE SPACES              TO VEN-GLS-DISP IN VEN.
       FIN-LLE-REG-NUEVA-VEN.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-CYA SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-CYA.
           MOVE SPACES                   TO CYA-GLS-FLAG IN CYA.
           MOVE OPC-CIC-IOPC IN OPC      TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES                   TO CYA-NUM-ICAN IN CYA.
           MOVE 1                        TO CYA-NUM-ICYA IN CYA.
           MOVE HOY-FHOY                 TO CYA-FEC-FTRN IN CYA.
           MOVE HOY-HHOY                 TO CYA-HRA-HRTR IN CYA.
           MOVE SPACES                   TO CYA-MSC-TACC IN CYA.
           MOVE SPACES                   TO CYA-MSC-STAT IN CYA.
           MOVE SPACES                   TO CYA-COD-OTRN IN CYA.
           MOVE SPACES                   TO CYA-COD-ATRN IN CYA.
           MOVE 'PBCAE'                  TO CYA-IND-TCYA IN CYA.
           MOVE SPACES                   TO CYA-CIC-ICYA IN CYA.
           MOVE SPACES                   TO CYA-VRF-ICYA IN CYA.
           MOVE ZEROES                   TO CYA-SGV-LIQU IN CYA.
           MOVE SPACES                   TO CYA-IND-MAUT IN CYA.
           MOVE SPACES                   TO CYA-IND-FREE IN CYA.
           MOVE SPACES                   TO CYA-COD-OFIC IN CYA.
           MOVE SPACES                   TO CYA-GLS-DISP IN CYA.
       FIN-LLE-REG-NUEVA-CYA.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-ICG SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-ICG.
           MOVE SPACES              TO ICG-GLS-FLAG IN ICG.
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE HOY-FHOY            TO ICG-FEC-FTRN IN ICG.
           MOVE HOY-HHOY            TO ICG-HRA-HRTR IN ICG.
           MOVE POC-COD-TINT IN POC TO ICG-COD-TINT IN ICG.
           MOVE SPACES              TO ICG-MSC-TACC IN ICG.
           MOVE SPACES              TO ICG-MSC-STAT IN ICG.
           MOVE SPACES              TO ICG-COD-OTRN IN ICG.
           MOVE SPACES              TO ICG-COD-ATRN IN ICG.
           MOVE ZEROES              TO ICG-FEC-FTER IN ICG.
           MOVE ZEROES              TO ICG-SGV-SPRD IN ICG.
           MOVE ZEROES              TO ICG-SGV-TINT IN ICG.
           MOVE ZEROES              TO ICG-SGV-MNTO IN ICG.
           MOVE SPACES              TO ICG-GLS-DISP IN ICG.
       FIN-LLE-REG-NUEVA-ICG.
           EXIT.

      ******************************************************************
       LLE-REG-NUEVA-RDC SECTION.
      *-------------------------
       INI-LLE-REG-NUEVA-RDC.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO RDC-CIC-IOPC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE ZEROES TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              WSS-CIC-IOPC IN WSS-VARI = RDC-CIC-IOPC IN RDC )
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA COLRDC: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'OPC  NORDC'             TO ERC-COD-MSGE IN ERC
               MOVE WSS-CIC-IOPC IN WSS-VARI TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LLE-REG-NUEVA-RDC.

       LUP-LLE-REG-NUEVA-RDC.
           MOVE OPC-CIC-IOPC IN OPC      TO RDC-CIC-IOPC IN RDC.
           MOVE HOY-FHOY                 TO RDC-FEC-FTRN IN RDC.
           MOVE HOY-HHOY                 TO RDC-HRA-HRTR IN RDC.
           MOVE WSS-NUM-DIRE IN WSS-VARI TO RDC-NUM-DIRE IN RDC.
           MOVE 100                      TO RDC-VAL-LIMD IN RDC.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR INGRESO NUEVA RDC: '
                       OPC-CIC-IOPC IN OPC ' ' FIO-STAT
               MOVE 'RDCNOGRABA'        TO ERC-COD-MSGE IN ERC
               MOVE OPC-CIC-IOPC IN OPC TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-LLE-REG-NUEVA-RDC.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'NUEVO REG. RDC INGRESADO: '
                                   RDC-KEY-IREG IN RDC.

           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE WSS-CIC-IOPC IN WSS-VARI TO RDC-CIC-IOPC IN RDC.
           ADD 1 TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              WSS-CIC-IOPC IN WSS-VARI = RDC-CIC-IOPC IN RDC
               GO TO LUP-LLE-REG-NUEVA-RDC.

       FIN-LLE-REG-NUEVA-RDC.
           EXIT.

      ******************************************************************
       BUS-NUM-CIC SECTION.
      *-------------------
       INI-BUS-NUM-CIC.
           MOVE 'D'                 TO CIC-COD-TCIC IN CIC.
           MOVE CAN-COD-OFCA IN CAN TO CIC-COD-CCIC IN CIC.
           MOVE CIC-GET             TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               DISPLAY 'NO EXISTE CORRELATIVO EN TABLA CIC: '
                                  CIC-COD-TCIC IN CIC
                                  CIC-COD-CCIC IN CIC
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               MOVE 'CORR   NEX'        TO ERC-COD-MSGE IN ERC
               MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC
               PERFORM GRABAR-ERROR
               GO TO FIN-BUS-NUM-CIC
           ELSE
               MOVE ADR-OPC-REQA TO ADR-AUX-REQA
               MOVE CIC-CIC-ICIC IN CIC TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
                   GO TO INI-BUS-NUM-CIC
               ELSE
                   MOVE ADR-AUX-REQA TO ADR-OPC-REQA
                   MOVE FIO-KDEF-S   TO FIO-KDEF
                   MOVE FIO-GET-KEY  TO FIO-CMND
                   PERFORM COL-FIO-OPC.
       FIN-BUS-NUM-CIC.
           EXIT.

      ******************************************************************
       CLOSE-FILE SECTION.
      *------------------
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-ROV.
           PERFORM COL-FIO-POC.
           PERFORM COL-FIO-PVC.

           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-EVC.
           PERFORM COL-FIO-RDC.
           PERFORM COL-FIO-ERC.
           PERFORM SGC-FIO-DBC.
       FIN-CLOSE-FILE.
           EXIT.

      ******************************************************************
       LLENA-CAE SECTION.
       INI-LLENA-CAE.
           IF WSS-NUM-GCAE = ZEROES
              MOVE SPACES TO CAE-CAI-IOPC IN CAE
              MOVE ZEROES TO CAE-IIC-IOPC IN CAE
              MOVE SPACES TO CAE-CAI-IOPO IN CAE
              MOVE ZEROES TO CAE-IIC-IOPO IN CAE
              MOVE ZEROES TO CAE-NUM-ICLI IN CAE
              MOVE ZEROES TO CAE-VRF-ICLI IN CAE
              MOVE 'HEADER' TO CAE-GLS-NOMC IN CAE
              MOVE WSS-NUM-DPRO IN WSS-VARI TO CAE-NUM-DPRO IN CAE
              MOVE WSS-NUM-MPRO IN WSS-VARI TO CAE-NUM-MPRO IN CAE
              MOVE WSS-NUM-SPRO IN WSS-VARI TO CAE-NUM-SPRO IN CAE
              MOVE WSS-NUM-APRO IN WSS-VARI TO CAE-NUM-APRO IN CAE
              MOVE ZEROES                   TO CAE-VAL-CRED IN CAE
              MOVE ZEROES                   TO CAE-COD-OFOC IN CAE
              MOVE FIO-PUT TO FIO-CMND
              PERFORM COL-FIO-CAE
              IF NOT FIO-STAT-OKS
                 DISPLAY 'ERROR AL GRABAR REG.CAE : ' FIO-STAT
                 PERFORM GNS-PRO-ABT
              ELSE
                 ADD 1    TO WSS-NUM-GCAE.

           MOVE WSS-CIC-IOPN IN WSS-VARI TO CAE-CIC-IOPC IN CAE.
           MOVE OPC-CIC-IOPC IN OPS TO CAE-CIC-IOPO IN CAE.
           MOVE DBC-NUM-ICLI IN DBC TO CAE-NUM-ICLI IN CAE.
           MOVE DBC-VRF-ICLI IN DBC TO CAE-VRF-ICLI IN CAE.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO CAE-GLS-NOMC IN CAE.
           MOVE OPC-NUM-DCOL IN OPS TO CAE-NUM-DPRO IN CAE.
           MOVE OPC-NUM-MCOL IN OPS TO CAE-NUM-MPRO IN CAE.
           MOVE OPC-NUM-SCOL IN OPS TO CAE-NUM-SPRO IN CAE.
           MOVE OPC-NUM-ACOL IN OPS TO CAE-NUM-APRO IN CAE.
           MOVE OPC-VAL-CRED IN OPC TO CAE-VAL-CRED IN CAE.
           MOVE WSS-COD-OFOC IN WSS-VARI TO CAE-COD-OFOC IN CAE.
       FIN-LLENA-CAE.
           EXIT.
      ******************************************************************
       MUESTRA-ESTADISTICAS SECTION.
      *----------------------------
       INI-MUESTRA-ESTADISTICAS.
           DISPLAY 'ESTADISTICAS.'.
           DISPLAY '-------------'.
           DISPLAY ' '.
           DISPLAY 'REGISTROS DLC LEIDOS                 : '
                                 WSS-NUM-LDLC IN WSS-VARI.
           DISPLAY 'REGISTROS OPC LEIDOS                 : '
                                 WSS-NUM-LOPC IN WSS-VARI.
           DISPLAY 'REGS.DLC SIN PAREJA OPC (CANCELADOS) : '
                                 WSS-NUM-ERRO IN WSS-VARI.
           DISPLAY 'REGISTROS DLC ERRONEOS               : '
                                 WSS-NUM-RRCH IN WSS-VARI.
           DISPLAY 'REGISTROS DLC NO SELECCIONADOS       : '
                                 WSS-NUM-RNSE IN WSS-VARI.
           DISPLAY 'REGISTROS CAN INGRESADOS             : '
                                 WSS-NUM-RGRA IN WSS-VARI.
           DISPLAY 'REGISTROS CAN NO INGRESADOS          : '
                                 WSS-NUM-RNIN IN WSS-VARI.
           DISPLAY 'REGISTROS OPC INGRESADOS             : '
                                 WSS-NUM-ROIN IN WSS-VARI.
           DISPLAY 'REGISTROS OPC NO INGRESADOS          : '
                                 WSS-NUM-RONI IN WSS-VARI.
           DISPLAY 'REGISTROS CAN ACTIVADOS              : '
                                 WSS-NUM-RACT IN WSS-VARI.
           DISPLAY 'REGISTROS CAN NO ACTIVADOS           : '
                                 WSS-NUM-RNAC IN WSS-VARI.
           DISPLAY 'REGISTROS OPC ACTIVADOS              : '
                                 WSS-NUM-ROAC IN WSS-VARI.
           DISPLAY 'REGISTROS OPC NO ACTIVADOS           : '
                                 WSS-NUM-RONA IN WSS-VARI.
           DISPLAY 'REGISTROS CAE GRABADOS               : '
                                 WSS-NUM-GCAE IN WSS-VARI.
           DISPLAY 'REGISTROS DLC FUERA DE FECHA         : '
                                 WSS-NUM-NFEC IN WSS-VARI.
       FIN-MUESTRA-ESTADISTICAS.
           EXIT.

      ******************************************************************
       COPY COLBFERC.
       COPY COLBFVEN.
       COPY COLBFOPC.
       COPY COLBFCAN.
       COPY COLBFRCV.
       COPY COLBFCYA.
       COPY COLBFICG.
       COPY COLBFROV.
       COPY COLBFTOC.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFRDC.
       COPY COLBFRDT.
       COPY COLBFPOC.
       COPY COLBFPVC.

       COPY SGCBFDBC.

      * COPY COLBGCTO.
       COPY TABBVOFI.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY TABBFCAM.
       COPY GNSBFTAB.
       COPY TABBFOFI.
       COPY GNSBFCIC.
       COPY TABBFUSR.

       COPY COLBGVEN.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBGCAM.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGPES.
       COPY COLBGINT.
      * COPY GNSBGCVI.
      * COPY COLB3CAN.
       COPY COLB4CAE.

       COPY COLB5CAN.
      ******************************************************************
       BCK-OUT SECTION.
      *---------------
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'BACK-OUT ERRONEO'.
       FIN-BCK-OUT.
           EXIT.

      ******************************************************************
       CHK-PNT SECTION.
      *----------------
       INI-CHK-PNT.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CHECK-PNT ERRONEO'.
       FIN-CHK-PNT.
           EXIT.

      ******************************************************************
       VAL-CLASE-CON SECTION.
      *---------------------
       INI-VAL-CLASE-CON.
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-CAUX IN WSS-VARI.
           IF WSS-COD-TOOC IN WSS-VARI = 'CON'
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
           ELSE
               DISPLAY 'CREDITO NO EN CONSUMO--> NO PROCESA:'
                        OPC-CIC-IOPC IN OPC
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI.
       FIN-VAL-CLASE-CON.
           EXIT.

      ******************************************************************
       GRABAR-ERROR SECTION.
       INI-GRABAR-ERROR.
           MOVE OPC-COD-OFOC IN OPC TO ERC-COD-OFIC IN ERC.
           MOVE 'CAS'               TO ERC-COD-EVEN IN ERC.
           MOVE 'CAE'               TO ERC-COD-PGRM IN ERC.
           MOVE ZEROES              TO ERC-NUM-CANC IN ERC.
           MOVE ZEROES              TO ERC-VAL-MNTO IN ERC.
           MOVE SPACES              TO ERC-GLS-DISP IN ERC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ERC.
       FIN-GRABAR-ERROR.
           EXIT.


      *ALD-BCI-INI/20-08-1998 VALIDA SI TIENE CAN ANTERIORES PARA FIMV
       PRO-FMVE SECTION.
       INI-PRO-FMVE.

           MOVE ZEROES TO WSS-FEC-FMVE IN WSS-VARI.

           MOVE OPC-CAI-IOPC IN OPC     TO RCV-CAI-IOPV IN RCV.
           MOVE OPC-IIC-IOPC IN OPC     TO RCV-IIC-IOPV IN RCV.
           MOVE VEN-NUM-IVCT IN VEN     TO RCV-NUM-IVCT IN RCV.

           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT (FIO-STAT-OKS AND
              OPC-CAI-IOPC IN OPC = RCV-CAI-IOPV IN RCV AND
              OPC-IIC-IOPC IN OPC = RCV-IIC-IOPV IN RCV AND
              VEN-NUM-IVCT IN VEN = RCV-NUM-IVCT IN RCV )
               GO TO FIN-PRO-FMVE.

       LUP-PRO-FMVE.
           MOVE RCV-KEY-ICAN TO CAN-KEY-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF CAN-MSC-FCAN IN CAN = 'P'
               GO TO NXT-PRO-FMVE.
           IF CAN-MSC-STAT IN CAN NOT = 'R' AND
              CAN-SGV-TPAG IN CAN NOT < ZEROES AND
              CAN-SGV-TREN IN CAN NOT < ZEROES AND
              CAN-FEC-FCAN IN CAN >     VEN-FEC-FVEN IN VEN      AND
              CAN-FEC-FCAN IN CAN >     WSS-FEC-FMVE IN WSS-VARI
               MOVE CAN-NUM-DCAN IN CAN TO WSS-NUM-DMVE
               MOVE CAN-NUM-MCAN IN CAN TO WSS-NUM-MMVE
               MOVE CAN-NUM-SCAN IN CAN TO WSS-NUM-SMVE
               MOVE CAN-NUM-ACAN IN CAN TO WSS-NUM-AMVE.
       NXT-PRO-FMVE.
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT (FIO-STAT-OKS AND
              OPC-CAI-IOPC IN OPC = RCV-CAI-IOPV IN RCV AND
              OPC-IIC-IOPC IN OPC = RCV-IIC-IOPV IN RCV AND
              VEN-NUM-IVCT IN VEN = RCV-NUM-IVCT IN RCV )
               GO TO FIN-PRO-FMVE.
           GO TO LUP-PRO-FMVE.
       FIN-PRO-FMVE.
           EXIT.
       COPY GNSBEKEY.
       COPY GNSBBCIC.
       COPY GNSBGCPT.
       COPY GNSBBVRF.
       COPY GNSBVCOD.
       COPY GNSBVIDC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBBNUM.
       COPY GNSBVTAB.

       COPY COLBFOPS.
       COPY COLBFDLS.
       COPY COLBFCAE.
