       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPPREV.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    28-AUG-1992     ( Ultima Modificacion ).

      * Programa que llama a rutina expansion de vencimientos

       ENVIRONMENT DIVISION.
      *====================

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGIFD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY GNSWGPES.
       COPY GNSBRTAB.
       COPY GNSBRMSC.
       COPY GNSBRMSG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.

       COPY COLWGVEN.
       COPY COLBRRCV.
       COPY COLBRVEN.
       COPY COLBROPC.
       COPY COLBRICG.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRTOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.

       COPY TABBRCAM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.

       01  WSS-VARI.
           03 WSS-IOPC                 PIC X(12).

       PROCEDURE DIVISION.
      *==================

       MAIN SECTION.
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPPREV' TO FIO-PROG.
           PERFORM BUS-FSIS.
           PERFORM PROCESO.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

       PROCESO SECTION.
       INI-PROCESO.
           ACCEPT WSS-IOPC.
           IF WSS-IOPC NOT > SPACES OR WSS-IOPC = '*'
               GO TO FIN-PROCESO.
           DISPLAY '--------- OPERACION A PROCESAR: ' WSS-IOPC.
      *DAD ini  28-AUG-1992
           DISPLAY '------------ / --- / ---------- / ----CAPI---..../'
                   ' ----FINA---..../ ----SCAP---..../'
                   ' ----SFIN---..../ ----IDNI---....'.
      *DAD fin  28-AUG-1992
           MOVE WSS-IOPC TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO EXISTE OPERACION : '
                       OPC-CIC-IOPC IN OPC
               GO TO INI-PROCESO.
           IF OPC-MSC-STAT IN OPC NOT = 'A'
               DISPLAY 'OPERACION NO ACTIVADA'
               GO TO INI-PROCESO.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM LISTAR-VEN-EVC
           ELSE
               DISPLAY 'OPERACION NO ESTRUCTURADA'.
           GO TO INI-PROCESO.
       FIN-PROCESO.
           EXIT.

       LISTAR-VEN-EVC SECTION.
       INI-LISTAR-VEN-EVC.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.
       LUP-LISTAR-VEN-EVC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE OPC-FEC-FCOL IN OPC TO VEN-FTBS.
           MOVE 'S'                 TO VEN-KEST.
           PERFORM COL-OBT-VEN.
           IF NOT VEN-STAT-OKS
               GO TO FIN-LISTAR-VEN-EVC.
           DISPLAY VEN-CIC-IOPC IN VEN ' / '
                   VEN-NUM-IVEN IN VEN ' / '
                   VEN-NUM-DVEN IN VEN '-'
                   VEN-NUM-MVEN IN VEN '-'
                   VEN-NUM-SVEN IN VEN
                   VEN-NUM-AVEN IN VEN ' / '
                   VEN-VAL-CAPI IN VEN '/ '
                   VEN-VAL-FINA IN VEN '/ '
      *DAD ini  28-AUG-1992
                   VEN-VAL-SCAP IN VEN '/ '
                   VEN-VAL-SFIN IN VEN '/ '
                   VEN-VAL-IDNI IN VEN.
      *DAD fin  28-AUG-1992
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           GO TO LUP-LISTAR-VEN-EVC.
       FIN-LISTAR-VEN-EVC.
           EXIT.

       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY GNSBFMSC.
       COPY GNSBBMSG.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY GNSBGPES.
       COPY GNSBGEND.

       COPY COLBGVEN.
       COPY COLBFRCV.
       COPY COLBFVEN.
       COPY COLBFOPC.
       COPY COLBFICG.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFTOC.

       COPY TABBFCAM.
