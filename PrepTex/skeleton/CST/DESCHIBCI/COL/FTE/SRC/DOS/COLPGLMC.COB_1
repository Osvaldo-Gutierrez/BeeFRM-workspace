       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGLMC.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.
      * Genera Interfaz para Contabilidad
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
           DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
      *DPM ini  21-NOV-1995
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
      *DPM fin  21-NOV-1995
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CPP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LMC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ERC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *<<<< WSS
      *RRM-INI 11-MAY-1999
       COPY COLBRRCA.
       COPY COLBRRCU.
      *RRM-FIN 11-MAY-1999
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY GNSBRERR.
       COPY COLBRMCD.
       COPY COLBRLMC.
       COPY COLBRERC.
       COPY COLBRCPP.
       COPY COLBRDCC.
       COPY COLBRRDC.
      * COPY SGCBRDBC.
       COPY TABBROFI.
       COPY TABBRCAM.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
      *DPM ini  21-NOV-1995
       COPY GNSWGCIC.
       COPY GNSBRCIC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
      *DPM fin  21-NOV-1995
       01  WSS-VARI.
      *DPM ini  19-JUN-1996
      *     03 WSS-NUM-CCON.
      *        05  WSS-NUM-CCON-3                      PIC X(03).
      *        05  WSS-NUM-CCON-9                      PIC X(09).
           03 WSS-NUM-CCON.
              05  WSS-NUM-CCON-4                      PIC X(04).
              05  WSS-NUM-CCON-8                      PIC X(08).
           03 WSS-TOT-CCON.
              05  WSS-NUM-TCON                        PIC X(08).
              05  WSS-VRF-CCON                        PIC X(01).
           03 WSS-IND-ERR                             PIC X(01).
      *DPM fin  19-JUN-1996
           03 WSS-COD-TAB.
              05  WSS-COD-TVOC                        PIC X(01).
              05  WSS-COD-COOC.
                  07  WSS-COD-TOOC                    PIC X(03).
                  07  WSS-COD-AOOC                    PIC X(03).
              05  WSS-COD-OFOC                        PIC X(03).
           03 WSS-EXT-CTAB.
              05  WSS-OFI-CTAB                        PIC 9(03).
              05  WSS-FIL-CTAB                        PIC X(02).
           03 VEC-MOV OCCURS 100 TIMES INDEXED BY MOV-I.
              05  VEC-COD-CPTO                        PIC X(06).
              05  VEC-SGV-MNTO             COMP-3     PIC S9(11)V9(4).
              05  VEC-IND-LIQU                        PIC X(02).
           03 VECT-OOF OCCURS 20  TIMES INDEXED BY VEC-OOF.
              05  VEC-SGV-MONT                        PIC S9(11)V9(04).
              05  VEC-NUM-CTAD                        PIC X(12).
              05  VEC-NUM-CTAH                        PIC X(12).
      * RBG/INI/ 28-JAN-1998
      * Este cambio se debe a la centralizacion de castigos.
              05  VEC-IND-DEHA                        PIC X(01).
      * RBG/FIN/ 28-JAN-1998
      *DPM INI  28-JUN-1996
      *       05  VEC-NUM-NVIG                        PIC 9(03).
              05  VEC-NUM-NVIG                        PIC 9(08).
      *DPM FIN  28-JUN-1996
              05  VEC-GLS-TCCT                        PIC X(03).
              05  VEC-IND-LIQUI                       PIC X(02).
           03 VEC-ASIENTO OCCURS 100 TIMES INDEXED BY ASIENTO-I.
              05  VEC-CUENTA                          PIC X(12).
              05  VEC-IND                             PIC X(01).
              05  VEC-MONTO                COMP-3     PIC S9(11)V9(4).
              05  VEC-TCCT                            PIC X(03).
              05  VEC-IND-LIQ                         PIC X(02).
      *DPM INI  28-JUN-1996
      *       05  VEC-NUM-VIGE                        PIC 9(03).
              05  VEC-NUM-VIGE                        PIC 9(08).
      *DPM FIN  28-JUN-1996
      *RRM-INI 10-MAY-1999
           03 VEC-RCX OCCURS 100 TIMES INDEXED BY RCX-I.
              05  VEC-RCX-CPTO                       PIC  X(06).
              05  VEC-RCX-MNTO             COMP-3    PIC S9(11)V9(4).
           03 WSS-SUM-INTE                           PIC S9(13).
           03 WSS-SUM-COMI                           PIC S9(13).
           03 WSS-CUENTA                             PIC  X(12).
           03 WSS-IND-GRCX     VALUE 'N'             PIC  X(01).
      *RRM-FIN 10-MAY-1999
      *DPM ini  20-NOV-1995
      *     03 VEC-OFIC OCCURS 300 TIMES INDEXED BY VEC-I.
      *        05  VEC-COD-OFIC                        PIC X(03).
      *        05  VEC-SGV-MONTO       COMP-3          PIC S9(13)V9(4).
      *        05  VEC-COD-MVTO                        PIC X(03).
      *        05  VEC-IND-TIFZ                        PIC 9(01).
      *        05  VEC-FEC-FPRO                        PIC 9(08).
      *        05  VEC-FEC-FCTB                        PIC 9(08).
      *        05  VEC-COD-VCOC                        PIC X(06).
      *        05  VEC-COD-OGEN                        PIC X(03).
      *        05  VEC-IND-CANC                        PIC X(03).
      *        05  VEC-COD-OFCR                        PIC X(03).
      *        05  VEC-FEC-FREA                        PIC 9(08).
      *        05  VEC-COD-COOC                        PIC X(06).
      *        05  VEC-CIC-IOPC                        PIC X(12).
      *        05  VEC-NUM-IDLC                        PIC 9(03).
      *        05  VEC-NUM-IVCT                        PIC 9(03).
      *        05  VEC-NUM-ICAN                        PIC 9(03).
      *        05  VEC-SGV-SCRE              COMP-3    PIC S9(13)V9(02).
      *        05  VEC-IDC-ICLI                        PIC X(14).
           03 WSS-SGV-MNTO                            PIC S9(12)V9(4).
           03 WSS-IIC-ICIC                            PIC X(03).
           03 WSS-IIC-ICIC-RED REDEFINES
                           WSS-IIC-ICIC               PIC 9(03).
           03 VEC-TOPE                                PIC 9(03).
           03 VEC-TOPE-OOF                            PIC 9(03).
      *DPM fin  20-NOV-1995
           03 WSS-COD-MNAC                            PIC X(06).
           03 MOV-TOPE                                PIC 9(03).
           03 CPP-I            VALUE 0                PIC 9(03).
           03 WSS-SUM-DEBE                            PIC 9(11)V9(4).
           03 WSS-SUM-HABER                           PIC 9(11)V9(4).
           03 WSS-COD-CPTO                            PIC X(06).
           03 WSS-PVEZ         VALUE 'S'              PIC X(01).
           03 WSS-KEY-ERR                             PIC X(36).
           03 WSS-KEY-ANT.
              05  WSS-KEY-CPP-ANT                     PIC X(21).
              05  WSS-CIC-OPC-ANT                     PIC X(12).
              05  WSS-NUM-ICAN-ANT                    PIC 9(03).
           03 WSS-COD-MVTO                            PIC X(03).
           03 WSS-COD-VCAM                            PIC X(06).
           03 WSS-FEC-FCTB                            PIC X(08).
      *RRM-INI 10-MAY-1999
      *    03 WSS-COD-COCR                            PIC X(06).
           03 WSS-COD-COCR.
              05 WSS-COD-TOCR                         PIC X(03).
              05 WSS-COD-AOCR                         PIC X(03).
           03 MCDBAK            VALUE SPACES         PIC X(128).
           03 MCDOLD            VALUE SPACES         PIC X(128).
      *RRM-FIN 10-MAY-1999
           03 WSS-COD-PLZO                            PIC X(02).
           03 WSS-IND-SCRT                            PIC X(03).
           03 WSS-IND-SCTB                            PIC X(03).
      *DPM INI  15-OCT-1996
           03 WSS-IND-LIQU                            PIC X(02).
      *DPM FIN  15-OCT-1996
           03 WSS-IND-SCBZ                            PIC X(05).
      * RJZ INI 21-JUNIO-1995
           03 WSS-COD-OFCA                            PIC X(03).
      * RJZ FIN 21-JUNIO-1995
           03 WSS-COD-OFIC                            PIC X(03).
           03 WSS-COD-OFIC-ANT VALUE SPACES           PIC X(03).
           03 WSS-NUM-IVCT                            PIC 9(03).
           03 WSS-NUM-IDLC                            PIC 9(03).
           03 WSS-NUM-ICAN                            PIC 9(03).
           03 WSS-SGV-SCRE                            PIC S9(15)V9(02).
      * jpa ini
           03 WSS-IND-CANC                            PIC X(03).
           03 WSS-COD-OFCR                            PIC X(03).
           03 WSS-FEC-FREA                            PIC X(08).
      * jpa fin
           03 WSS-CNT-AST                             PIC 9(03).
           03 WSS-KEY-LEC.
              05  WSS-KEY-CPP-LEC                     PIC X(21).
              05  WSS-CIC-OPC-LEC                     PIC X(12).
              05  WSS-NUM-ICAN-LEC                    PIC 9(03).
      *DPM ini  2-APR-1997 Se cambia formato de fecha de *DD/MM//AA
      * por DDMMSSAA
      *     03  WSS-FEC-FTAR.
      *         05  WSS-FIL-1                      PIC X(01).
      *         05  WSS-FEC-FTA1.
      *             07  WSS-NUM-DTAR               PIC 9(02).
      *             07  WSS-FIL-SLA1               PIC X(01).
      *             07  WSS-NUM-MTAR               PIC 9(02).
      *             07  WSS-FIL-SLA2               PIC X(01).
      *             07  WSS-NUM-ATAR               PIC 9(02).
      *DPM fin  2-APR-1997
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MPRO        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-SPRO        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-APRO        VALUE ZEROS  PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AFEC        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MFEC        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-DFEC        VALUE ZEROS  PIC 9(02).
           03 CNT-REG-GRA            VALUE 0      PIC 9(06).
           03 CNT-REG-LEI            VALUE 0      PIC 9(06).
           03 CNT-REG-ASI            VALUE 0      PIC 9(06).
           03 WSS-STAT-PGM           VALUE 0      PIC 9(01).
              88 PGM-STAT-OKS        VALUE 0.
              88 PGM-STAT-INF        VALUE 1.
              88 PGM-STAT-MAL        VALUE 2.
       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPGLMC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM OPEN-FILE.
           PERFORM INI-VAR.
           PERFORM LEE-PARAM.
           PERFORM PRO-CONTAB.
      *HZF INI
      *DPM ini  21-NOV-1995
      *     PERFORM GRABA-VECTOR-OFIC.
      *DPM fin  21-NOV-1995
      *HZF FIN
           PERFORM CLOSE-FILE.
       FIN-MAIN.
           DISPLAY 'REG. GRABADOS EN LMC...:  ' CNT-REG-GRA IN WSS-VARI.
           DISPLAY 'MOVIMIENTOS LEIDOS.....:  ' CNT-REG-LEI IN WSS-VARI.
           DISPLAY 'CPP PROCESADAS.........:  ' CNT-REG-ASI IN WSS-VARI.
           PERFORM GNS-PRO-END.

       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-CPP.
           PERFORM COL-FIO-DCC.
           PERFORM TAB-FIO-CAM.
           PERFORM TAB-FIO-OFI.
           PERFORM COL-FIO-MCD.
           PERFORM COL-FIO-RDC.
      *     PERFORM SGC-FIO-DBC.
           MOVE 'COL' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-OUT TO FIO-CMND.
      *DPM ini  22-NOV-1995
           PERFORM GNS-FIO-CIC.
      *DPM fin  22-NOV-1995
           PERFORM COL-FIO-LMC.
      * RRM-INI 11-MAY-1999
           PERFORM COL-FIO-RCU.
           PERFORM COL-FIO-RCA.
      * RRM-FIN 11-MAY-1999
           MOVE FIO-EXT TO FIO-CMND.
           PERFORM COL-FIO-ERC.
      *    MOVE FIO-EXT TO FIO-CMND.
      *    PERFORM GNS-FIO-ERR.
       FIN-OPEN-FILE.
           EXIT.
       INI-VAR SECTION.
      *-----------------
       INI-INI-VAR.
      * Se obtiene por unica vez COD_PESO, para chequear si la
      * Operacion es en peso u otra, de la siguiente forma :
           MOVE 'TAB'                     TO FIO-SIST.
           MOVE 'VLR'                     TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '                  TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL'            TO FIO-AKEY.
           MOVE  FIO-GET-KEY              TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB = 'N'
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE 'CICMNACINEX'        TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG '  0999  '
               PERFORM GNS-PRO-ABT
               GO TO FIN-INI-VAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-MNAC IN WSS-VARI.
           MOVE SPACES  TO LMC.
      *DPM ini  22-NOV-1995
           MOVE ZEROES TO VEC-TOPE.
           MOVE ZEROES TO VEC-TOPE-OOF.
           MOVE 'N' TO WSS-IND-ERR IN WSS-VARI.
      *DPM fin  22-NOV-1995
       FIN-INI-VAR.
           EXIT.
       LEE-PARAM SECTION.
      *-----------------
       INI-LEE-PARAM.
      * Rutina para Capturar y Validar Parametros de Rango de Fechas
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *CAPTURA FECHA PROCESO
      *DPM ini  2-APR-1997
      *     DISPLAY 'FECHA DESDE DESDE TARJETA (*DD/MM/AA) : '.
      *     ACCEPT  WSS-FEC-FTAR IN WSS-VARI.
      *     DISPLAY WSS-FEC-FTA1 IN WSS-VARI.
      *     MOVE WSS-NUM-DTAR IN WSS-VARI TO WSS-NUM-DPRO IN WSS-VARI.
      *     MOVE WSS-NUM-MTAR IN WSS-VARI TO WSS-NUM-MPRO IN WSS-VARI.
      *     MOVE WSS-NUM-ATAR IN WSS-VARI TO WSS-NUM-APRO IN WSS-VARI.
      *     IF WSS-NUM-APRO IN WSS-VARI < 50
      *        MOVE 20                    TO WSS-NUM-SPRO IN WSS-VARI
      *     ELSE
      *        MOVE 19                    TO WSS-NUM-SPRO IN WSS-VARI.
           DISPLAY 'FECHA DESDE DESDE TARJETA (DDMMSSAA) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      *DPM fin  2-APR-1997
      *VAL-FEC Valida Fecha de Proceso
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-AFEC IN WSS-VARI.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
       FIN-LEE-PARAM.
           EXIT.

       PRO-CONTAB SECTION.
      *-------------------
       INI-PRO-CONTAB.
           MOVE FIO-GET-NXT     TO FIO-CMND.
           MOVE SPACES          TO MCD-KEY-IMCD.
       LUP-PRO-CONTAB.
           PERFORM COL-FIO-MCD.
           IF NOT (FIO-STAT-OKS)
              IF  WSS-PVEZ = 'S'
                   MOVE 'MCDMOVINEX'             TO ERR-COD-MENS IN ERR
                   MOVE 'REG.MCD'                TO ERR-COD-CMPO IN ERR
                   MOVE ADR-MCD-REQA             TO ADR-REQA
                   MOVE 2                        TO WSS-STAT-PGM
                   MOVE WSS-KEY-ANT IN WSS-VARI
                                    TO WSS-KEY-ERR IN WSS-VARI
                   GO TO ERR-PRO-CONTAB
              ELSE
                  PERFORM PRO-CON-PARAM
                  MOVE MCDBAK TO MCDOLD
                  IF NOT PGM-STAT-OKS
                     PERFORM ERR-PRO-CONTAB
                     GO TO FIN-PRO-CONTAB
                  ELSE
                     GO TO FIN-PRO-CONTAB.
           ADD 1 TO CNT-REG-LEI IN WSS-VARI.
           IF  WSS-PVEZ = 'S'
               IF NOT (WSS-FEC-FFEC IN WSS-VARI = MCD-FEC-FMOV IN MCD)
                   MOVE 'MCDFECNOPROC'           TO ERR-COD-MENS IN ERR
                   MOVE 'MCD-FEC-FMOV'           TO ERR-COD-CMPO IN ERR
                   MOVE ADR-MCD-REQA             TO ADR-REQA
                   MOVE 1                        TO WSS-STAT-PGM
                   MOVE WSS-KEY-ANT IN WSS-VARI
                                       TO WSS-KEY-ERR IN WSS-VARI
                   GO TO ERR-PRO-CONTAB
               ELSE
                  MOVE 'N' TO  WSS-PVEZ
                  PERFORM LIM-ARREGLO
                  PERFORM INI-VAR-ANT
                  PERFORM AGR-A-VEC
           ELSE
              MOVE MCD-KEY-ICPP IN MCD TO WSS-KEY-CPP-LEC
              MOVE MCD-CIC-IOPC IN MCD TO WSS-CIC-OPC-LEC
              MOVE MCD-NUM-ICAN IN MCD TO WSS-NUM-ICAN-LEC
      *DPM INI  12-AUG-1996
      *       IF WSS-KEY-ANT NOT = WSS-KEY-LEC
              IF WSS-KEY-ANT NOT = WSS-KEY-LEC OR
                 WSS-COD-OFIC IN WSS-VARI NOT = MCD-COD-OFOC IN MCD
      *DPM FIN  12-AUG-1996
                 PERFORM PRO-CON-PARAM
                 MOVE MCDBAK TO MCDOLD
                 PERFORM LIM-ARREGLO
                 PERFORM INI-VAR-ANT
                 PERFORM AGR-A-VEC
              ELSE
                 PERFORM AGR-A-VEC.
           IF PGM-STAT-OKS
              GO TO NXT-PRO-CONTAB.
       ERR-PRO-CONTAB.
           DISPLAY '** CLAVE  ' WSS-KEY-ERR IN WSS-VARI.
           MOVE SPACES TO WSS-KEY-ERR IN WSS-VARI.
           IF PGM-STAT-MAL
              MOVE ERR-SVRT-FAT IN ERR-VARI TO ERR-IND-SVRT IN ERR
           ELSE
              MOVE ERR-SVRT-ADV IN ERR-VARI TO ERR-IND-SVRT IN ERR.
           MOVE ERR-TERR-VLD IN ERR-VARI TO ERR-COD-TERR IN ERR.
           PERFORM PRO-ERR.
      * RRM-INI 13-MAY-1999
           IF WSS-IND-GRCX IN WSS-VARI = 'S'
              MOVE MCDOLD TO MCD
              PERFORM  LEER-DCC-CAP
      *       PERFORM DISPL-VEC-RCX
              PERFORM GRABAR-RCA-RCU
              MOVE 'N' TO WSS-IND-GRCX IN WSS-VARI.
      * RRM-FIN 13-MAY-1999
           IF PGM-STAT-MAL
              DISPLAY ' '
              DISPLAY '***        PROGRAMA CANCELADO'
              PERFORM GNS-PRO-ABT.
           MOVE 0 TO WSS-STAT-PGM.
       NXT-PRO-CONTAB.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-CONTAB.
       FIN-PRO-CONTAB.
           EXIT.
       PRO-CON-PARAM SECTION.
       INI-PRO-CON-PARAM.
           MOVE ZEROES TO WSS-CNT-AST IN WSS-VARI.
           PERFORM GEN-ASIENTO.
           IF NOT PGM-STAT-OKS
              GO TO FIN-PRO-CON-PARAM.
           PERFORM VAL-ASIENTO.
      *DPM ini  17-MAR-1997
           IF NOT PGM-STAT-OKS AND
              WSS-SUM-DEBE IN WSS-VARI = WSS-SUM-HABER IN WSS-VARI AND
              WSS-SUM-DEBE IN WSS-VARI = ZEROES AND
              WSS-IND-ERR IN WSS-VARI = 'N'
               MOVE 0 TO WSS-STAT-PGM
               GO TO FIN-PRO-CON-PARAM
           ELSE
      *DPM fin  17-MAR-1997
           IF NOT PGM-STAT-OKS
               GO TO FIN-PRO-CON-PARAM.

           PERFORM GRA-INTERFAZ.
      *DPM ini  21-NOV-1995
      *     IF WSS-SGV-MNTO IN WSS-VARI > ZEROES
      *         DISPLAY 'GUARDAR EN VECTOR'
      *         PERFORM GUARDAR-EN-VECTOR.
      *DPM fin  21-NOV-1995
      *HZF INI
               PERFORM GRABA-VECTOR-OFIC.
      *HZF FIN
       FIN-PRO-CON-PARAM.
           EXIT.
       GEN-ASIENTO SECTION.
       INI-GEN-ASIENTO.
           MOVE WSS-KEY-CPP-ANT TO CPP-KEY-ICPP IN CPP.
           PERFORM REV-INT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CPP.
           IF NOT FIO-STAT-OKS
              IF WSS-CNT-AST IN WSS-VARI > 3
                 MOVE 'CPP     NEX'            TO ERR-COD-MENS IN ERR
                                                  ERC-COD-MSGE IN ERC
                 MOVE CPP-COD-MVTO IN CPP      TO ERC-COD-EVEN IN ERC
                 PERFORM GRABAR-ERROR
      * RRM-INI 13-MAY-1999
                 PERFORM MOV-VEC-A-VEC
                 MOVE 'S' TO WSS-IND-GRCX IN WSS-VARI
      * RRM-FIN 13-MAY-1999
                 MOVE 'CPP-KEY-ICPP'           TO ERR-COD-CMPO IN ERR
                 MOVE ADR-CPP-REQA             TO ADR-REQA
                 MOVE 1                        TO WSS-STAT-PGM
                 MOVE WSS-KEY-ANT IN WSS-VARI
                                    TO WSS-KEY-ERR IN WSS-VARI
                 GO TO FIN-GEN-ASIENTO
               ELSE
                 GO TO INI-GEN-ASIENTO.
           ADD  1 TO CNT-REG-ASI IN WSS-VARI.
           MOVE 1 TO CPP-I.
           SET ASIENTO-I TO 1.
       LUP-GEN-ASIENTO.
           IF (( CPP-I > 39) OR
               ( CPP-MSC-TCCT (CPP-I) = SPACES AND
                 CPP-IND-DBHB (CPP-I) = SPACES AND
                 CPP-IND-TALG (CPP-I) = SPACES ))
               GO TO FIN-GEN-ASIENTO.
      *OBTIENE MONTO A CONTABILIZAR DESDE ALGORITMO
            PERFORM OBT-CPTO-ALG.
            IF NOT PGM-STAT-OKS
              GO TO FIN-GEN-ASIENTO.
            SET MOV-I TO 1
            SEARCH VEC-MOV AT END GO TO SIG-GEN-ASIENTO
            WHEN VEC-COD-CPTO (MOV-I) = WSS-COD-CPTO IN WSS-VARI
                 MOVE VEC-SGV-MNTO (MOV-I) TO VEC-MONTO   (ASIENTO-I)
                 MOVE VEC-IND-LIQU (MOV-I) TO VEC-IND-LIQ (ASIENTO-I).


      *MUEVE INDICADOR DE DEBE-HABER
            MOVE CPP-IND-DBHB (CPP-I) TO VEC-IND (ASIENTO-I).
            MOVE CPP-MSC-TCCT (CPP-I) TO VEC-TCCT (ASIENTO-I).
            IF VEC-MONTO (ASIENTO-I) < 0
               COMPUTE VEC-MONTO (ASIENTO-I) = VEC-MONTO (ASIENTO-I) *
                       -1
               IF CPP-IND-DBHB (CPP-I) = 'D'
                  MOVE 'H' TO VEC-IND (ASIENTO-I)
               ELSE
                  MOVE 'D' TO VEC-IND (ASIENTO-I).

      *OBTIENE CUENTA DESDE DCC.
            PERFORM OBT-CUENTA-DCC.
            IF NOT PGM-STAT-OKS
              GO TO FIN-GEN-ASIENTO.
            MOVE DCC-GLS-CCSB IN DCC TO  VEC-CUENTA  (ASIENTO-I).

      *SUMA AL DEBE O HABER SEGUN CORRESPONDA
           IF VEC-IND (ASIENTO-I) = 'D'
              ADD VEC-MONTO (ASIENTO-I) TO WSS-SUM-DEBE
           ELSE
              ADD VEC-MONTO (ASIENTO-I) TO WSS-SUM-HABER.
      *DPM ini  20-NOV-1995
           MOVE 'COL'                TO MSC-COD-SIST FIO-SIST.
           MOVE 'TCCT'               TO MSC-COD-TMSC IN MSC.
           MOVE CPP-MSC-TCCT (CPP-I) TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY          TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'CPPTCCTNEX' TO MSG-COD-MENS
               GO TO FIN-GEN-ASIENTO.
           IF MSC-COD-DAT1 (1) = 'S' AND
      *DPM INI  02-JUL-1996
      *       WSS-COD-OFIC IN WSS-VARI NOT = '090' AND
      * RBG/INI/ 28-JAN-1998
      * Este cambio se debe a la centralizacion de castigos.
      *        WSS-COD-OFIC IN WSS-VARI NOT = '150' AND
              WSS-COD-OFIC IN WSS-VARI NOT = '150'
      * RBG/FIN/ 28-JAN-1998
      *DPM FIN  02-JUL-1996
      * RBG/INI/ 28-JAN-1998
      * Este cambio se debe a la centralizacion de castigos.
      *        VEC-IND (ASIENTO-I) = 'H'
      * RBG/FIN/ 28-JAN-1998
      *HZF-INI
              MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
              PERFORM BUS-OFI
              IF MSG-COD-MENS IN MSG > SPACES
                 MOVE 'S' TO WSS-IND-ERR IN WSS-VARI
                 DISPLAY 'NO EXISTE OFICINA '
                          WSS-COD-OFIC IN WSS-VARI
                          ' EN TABLA OFI.'
                 GO TO FIN-GEN-ASIENTO
              ELSE
              IF OFI-NUM-CCON IN OFI NOT > ZEROES
                 MOVE 'S' TO WSS-IND-ERR IN WSS-VARI
                 DISPLAY 'NO EXISTE CUENTA CONTABLE PARA OFICINA '
                          WSS-COD-OFIC IN WSS-VARI
                 GO TO FIN-GEN-ASIENTO
              ELSE
              IF MSG-COD-MENS IN MSG NOT > SPACES
               MOVE 'N' TO WSS-IND-ERR IN WSS-VARI
               ADD 1 TO VEC-TOPE-OOF
               SET VEC-OOF TO VEC-TOPE-OOF
      * RBG/INI/ 28-JAN-1998
      * Este cambio se debe a la centralizacion de castigos.
              MOVE VEC-IND (ASIENTO-I) TO VEC-IND-DEHA (VEC-OOF)
      * RBG/FIN/ 28-JAN-1998
               MOVE VEC-TCCT (ASIENTO-I)  TO VEC-GLS-TCCT (VEC-OOF)
               MOVE VEC-MONTO (ASIENTO-I) TO VEC-SGV-MONT (VEC-OOF)
               MOVE VEC-CUENTA (ASIENTO-I) TO VEC-NUM-CTAH (VEC-OOF)
               MOVE VEC-IND-LIQ (ASIENTO-I) TO VEC-IND-LIQUI (VEC-OOF)
               MOVE OFI-NUM-CCON IN OFI TO WSS-NUM-CCON IN WSS-VARI
      *DPM ini  19-JUN-1996
      *        MOVE WSS-NUM-CCON-9 IN WSS-VARI TO VEC-NUM-CTAD (VEC-OOF)
               MOVE WSS-NUM-CCON-8 IN WSS-VARI TO WSS-NUM-TCON
               MOVE OFI-VRF-CCON IN OFI TO WSS-VRF-CCON IN WSS-VARI
               MOVE WSS-TOT-CCON IN WSS-VARI TO VEC-NUM-CTAD (VEC-OOF)
      *DPM fin  19-JUN-1996
               PERFORM OBT-CIC-NVIG
               IF WSS-IND-ERR = 'S'
                   GO TO FIN-GEN-ASIENTO
               ELSE
                  MOVE CIC-NUM-ICIC        TO VEC-NUM-VIGE (ASIENTO-I)
                  MOVE CIC-NUM-ICIC        TO VEC-NUM-NVIG (VEC-OOF)
      *CONTB NORMAL CON CTA DE OFI CENTRAL Y NO DEL MOVIMIENTO
      *DPM INI  02-JUL-1996
      *        MOVE '090'               TO OFI-COD-OFIC IN OFI
               MOVE '150'               TO OFI-COD-OFIC IN OFI
      *DPM FIN  02-JUL-1996
               PERFORM BUS-OFI
               IF MSG-COD-MENS IN MSG > SPACES
                 MOVE 'S' TO WSS-IND-ERR IN WSS-VARI
                 DISPLAY 'NO EXISTE OFICINA CENTRAL EN TABLA OFI'
                 GO TO FIN-GEN-ASIENTO
               ELSE
               IF OFI-NUM-CCON IN OFI NOT > ZEROES
                 MOVE 'S' TO WSS-IND-ERR IN WSS-VARI
                 DISPLAY 'NO EXISTE CUENTA CONTABLE PARA OFICINA 150'
                 GO TO FIN-GEN-ASIENTO
               ELSE
               IF MSG-COD-MENS IN MSG NOT > SPACES
                MOVE 'N' TO WSS-IND-ERR IN WSS-VARI
               MOVE OFI-NUM-CCON IN OFI TO WSS-NUM-CCON IN WSS-VARI
      *DPM ini  19-JUN-1996
      *        MOVE WSS-NUM-CCON-9 IN WSS-VARI TO VEC-CUENTA (ASIENTO-I)
               MOVE WSS-NUM-CCON-8 IN WSS-VARI TO WSS-NUM-TCON
               MOVE OFI-VRF-CCON IN OFI TO WSS-VRF-CCON IN WSS-VARI
               MOVE WSS-TOT-CCON IN WSS-VARI TO VEC-CUENTA (ASIENTO-I).
      *DPM fin  19-JUN-1996
      *        ADD VEC-MONTO (ASIENTO-I) TO WSS-SGV-MNTO IN WSS-VARI.
      *HZF-FIN
      *DPM fin  20-NOV-1995
      *AVANZA PUNTERO DEL ASIENTO
           SET ASIENTO-I UP BY 1.
       SIG-GEN-ASIENTO.
           ADD 1 TO CPP-I.
           GO TO LUP-GEN-ASIENTO.
       FIN-GEN-ASIENTO.
           EXIT.
       OBT-CIC-NVIG SECTION.
       INI-OBT-CIC-NVIG.
           IF WSS-COD-OFIC IN WSS-VARI = WSS-COD-OFIC-ANT IN WSS-VARI
              GO TO FIN-OBT-CIC-NVIG.
           MOVE ZEROES TO CIC-NUM-ICIC.
      *DPM INI 20-JUN-1996
      *    MOVE 'Z'                      TO CIC-COD-TCIC IN CIC.
           MOVE 'W'                      TO CIC-COD-TCIC IN CIC.
      *    MOVE WSS-COD-OFIC IN WSS-VARI TO CIC-COD-CCIC IN CIC.
      *    MOVE '090'                    TO CIC-COD-CCIC IN CIC.
      *DPM INI 02-JUL-1996
           MOVE '150'                    TO CIC-COD-CCIC IN CIC.
      *DPM FIN 02-JUL-1996
      *DPM FIN 20-JUN-1996
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE 'OFICCICINEX'        TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE 'S' TO WSS-IND-ERR
               GO TO FIN-OBT-CIC-NVIG
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM GNS-FIO-CIC
               IF FIO-STAT-OKS
      *             ADD 1                    TO CIC-NUM-ICIC
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM GNS-FIO-CIC.
           MOVE WSS-COD-OFIC IN WSS-VARI TO WSS-COD-OFIC-ANT
                                              IN WSS-VARI.
       FIN-OBT-CIC-NVIG.
           EXIT.
       REV-INT SECTION.
       INI-REV-INT.
           IF WSS-CNT-AST IN WSS-VARI = 0
              GO TO AVA-REV-INT.
           IF WSS-CNT-AST IN WSS-VARI = 1
              MOVE '*  ' TO CPP-COD-AOOC IN CPP
              GO TO AVA-REV-INT.
           IF WSS-CNT-AST IN WSS-VARI = 2
              MOVE '*  ' TO CPP-COD-VCOC IN CPP
              GO TO AVA-REV-INT.
           IF WSS-CNT-AST IN WSS-VARI = 3
              MOVE '*  ' TO CPP-COD-AOOC IN CPP
              MOVE '*  ' TO CPP-COD-VCOC IN CPP
              GO TO AVA-REV-INT.
       AVA-REV-INT.
           ADD 1 TO WSS-CNT-AST IN WSS-VARI.
       FIN-REV-INT.
           EXIT.
       VAL-ASIENTO SECTION.
       INI-VAL-ASIENTO.
      *DPM ini  17-MAR-1997 Cuando ambo son cero no es error
           IF (WSS-SUM-DEBE IN WSS-VARI = WSS-SUM-HABER IN WSS-VARI AND
      *JPA INI SE VALIDA DEBE = HABER, CUANDO AMBOS SON CERO ES UN ERROR
      *DPM INI
      *       WSS-SUM-DEBE IN WSS-VARI NOT = ZEROES
              WSS-SUM-DEBE IN WSS-VARI NOT = ZEROES) AND
              WSS-IND-ERR IN WSS-VARI = 'N'
              GO TO FIN-VAL-ASIENTO
      *JPA FIN
           ELSE
           IF WSS-SUM-DEBE IN WSS-VARI = WSS-SUM-HABER IN WSS-VARI AND
              WSS-IND-ERR IN WSS-VARI = 'N'
              MOVE 1 TO WSS-STAT-PGM
              GO TO FIN-VAL-ASIENTO.
      *DPM fin  17-MAR-1997
           DISPLAY ' '.
           DISPLAY ' '.
           DISPLAY 'ASIENTO ERRONEO  ' WSS-KEY-ANT IN WSS-VARI.
           DISPLAY ' '.
           SET ASIENTO-I TO 1.
       LUP-VAL-ASIENTO.
           IF (( ASIENTO-I > 100 ) OR
               ( VEC-IND (ASIENTO-I) = SPACES AND
                 VEC-CUENTA (ASIENTO-I) = SPACES AND
                 VEC-MONTO (ASIENTO-I) = ZEROES ))
              GO TO CAN-VAL-ASIENTO.
           DISPLAY '  -IND: ' VEC-IND (ASIENTO-I)
                   '  -CTA: ' VEC-CUENTA (ASIENTO-I)
                   '  -MTO: ' VEC-MONTO (ASIENTO-I).
       SIG-VAL-ASIENTO.
           SET ASIENTO-I UP BY 1.
           GO TO LUP-VAL-ASIENTO.
       CAN-VAL-ASIENTO.
           SET MOV-I TO 1.
           DISPLAY ' '.
           DISPLAY ' '.
           DISPLAY 'MOVIMIENTOS QUE SE CONSIDERARON PARA EL ASIENTO'
           DISPLAY ' '.
       LER-VAL-ASIENTO.
           IF MOV-I > MOV-TOPE
              MOVE 'CPPASTODESC'            TO ERR-COD-MENS IN ERR
                                               ERC-COD-MSGE IN ERC
              MOVE CPP-COD-MVTO IN CPP      TO ERC-COD-EVEN IN ERC
              PERFORM GRABAR-ERROR
      * RRM-INI 13-MAY-1999
              PERFORM MOV-VEC-A-VEC
              MOVE 'S' TO WSS-IND-GRCX IN WSS-VARI
      * RRM-FIN 13-MAY-1999
              MOVE 'CPP-KEY-ICPP'           TO ERR-COD-CMPO IN ERR
              MOVE ADR-CPP-REQA             TO ADR-REQA
              MOVE 1                        TO WSS-STAT-PGM
              MOVE WSS-KEY-ANT IN WSS-VARI
                                    TO WSS-KEY-ERR IN WSS-VARI
              GO TO FIN-VAL-ASIENTO.
           DISPLAY 'CONCEPTO   ' VEC-COD-CPTO  (MOV-I)
                   '   MONTO   ' VEC-SGV-MNTO  (MOV-I).
           SET MOV-I UP BY 1.
           GO TO LER-VAL-ASIENTO.
       FIN-VAL-ASIENTO.
           EXIT.
       GRA-INTERFAZ SECTION.
       INI-GRA-INTERFAZ.
           MOVE WSS-COD-MVTO IN WSS-VARI TO LMC-COD-MVTO IN LMC.
           MOVE ZEROES                   TO LMC-IND-TCYA IN LMC.
           IF WSS-COD-VCAM IN WSS-VARI NOT = WSS-COD-MNAC
              MOVE 0                     TO LMC-IND-TIFZ IN LMC
           ELSE
              MOVE 1                     TO LMC-IND-TIFZ IN LMC.
           MOVE WSS-FEC-FFEC IN WSS-VARI TO LMC-FEC-FPRO IN LMC.
           MOVE WSS-FEC-FCTB IN WSS-VARI TO LMC-FEC-FCTB IN LMC
           MOVE WSS-COD-VCAM IN WSS-VARI TO LMC-COD-VCOC IN LMC.
      *RJZ INI 21-JUNIO-1995
      *    MOVE WSS-COD-OFIC IN WSS-VARI TO LMC-COD-OGEN IN LMC
      *                                     LMC-COD-OFOC IN LMC.
           MOVE WSS-COD-OFIC IN WSS-VARI TO LMC-COD-OFOC IN LMC.
           MOVE WSS-COD-OFCA IN WSS-VARI TO LMC-COD-OGEN IN LMC.
      *RJZ FIN 21-JUNIO-1995
      *jpa ini
           MOVE WSS-IND-CANC IN WSS-VARI TO LMC-IND-CANC IN LMC.
           MOVE WSS-COD-OFCR IN WSS-VARI TO LMC-COD-OFCR IN LMC.
           MOVE WSS-FEC-FREA IN WSS-VARI TO LMC-FEC-FREA IN LMC.
      *jpa fin
      *BUS-OFI busca oficina en tablas
      * jpa inhibe busqueda de oficina centralizadora para moneda
      *     nacional. En BCI existen ofic.cabezera solo para moneda
      *     extranjera.
           IF LMC-MSC-TVOC IN LMC NOT = '0'
              IF  WSS-COD-OFIC IN WSS-VARI > SPACES
                  MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
                  PERFORM BUS-OFI
                  IF OFI-COD-OFCO IN OFI NOT = OFI-COD-OFIC IN OFI AND
                     OFI-COD-OFCO IN OFI NOT = SPACES
                     MOVE OFI-COD-OFCO IN OFI TO LMC-COD-OFOC IN LMC.
      *
      *Busca Centro de Costo
           MOVE ZEROES TO WSS-CNT-AST IN WSS-VARI.
           MOVE 'COL'                   TO FIO-SIST.
           MOVE 'OCC'                   TO TAB-COD-TTAB.
           MOVE LMC-IND-TIFZ IN LMC  TO WSS-COD-TVOC IN WSS-VARI.
       OCC-GRA-INTERFAZ.
           MOVE WSS-COD-COCR IN WSS-VARI
                                     TO WSS-COD-COOC IN WSS-VARI.
           MOVE LMC-COD-OGEN IN LMC  TO WSS-COD-OFOC IN WSS-VARI.
           PERFORM REV-LEC-OCC.
           MOVE WSS-COD-TAB IN WSS-VARI TO TAB-COD-CTAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S')
              IF WSS-CNT-AST IN WSS-VARI < 4
                 GO TO OCC-GRA-INTERFAZ
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE TAB-EXT-CTAB IN TAB TO WSS-EXT-CTAB IN WSS-VARI
              MOVE WSS-OFI-CTAB IN WSS-VARI TO LMC-COD-OFOC IN LMC.

           MOVE ZEROES                     TO LMC-COD-CCST IN LMC.
           MOVE WSS-COD-COCR IN WSS-VARI   TO LMC-COD-COOC IN LMC.
           MOVE 0                          TO LMC-IND-RVDB IN LMC.
           MOVE WSS-CIC-OPC-ANT            TO LMC-CIC-IOPC IN LMC.
           MOVE WSS-NUM-IDLC IN WSS-VARI   TO LMC-NUM-IDLC IN LMC.
           MOVE WSS-NUM-IVCT IN WSS-VARI   TO LMC-NUM-IVCT IN LMC.
           MOVE WSS-NUM-ICAN IN WSS-VARI   TO LMC-NUM-ICAN IN LMC.
           MOVE WSS-SGV-SCRE IN WSS-VARI   TO LMC-SGV-SCRE IN LMC.
      *    NUMERO DE DOCUMENTO DEL CLIENTE
           MOVE WSS-CIC-OPC-ANT  IN WSS-VARI TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES                       TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
              MOVE 'RDC   INEX'             TO ERR-COD-MENS IN ERR
                                               ERC-COD-MSGE IN ERC
              MOVE LMC-COD-MVTO IN LMC      TO ERC-COD-EVEN IN ERC
              PERFORM GRABAR-ERROR
      * RRM-INI 13-MAY-1999
              PERFORM MOV-VEC-A-VEC
              MOVE 'S' TO WSS-IND-GRCX IN WSS-VARI
      * RRM-FIN 13-MAY-1999
              MOVE 'RDC-CIC-ICLI'           TO ERR-COD-CMPO IN ERR
              MOVE ADR-RDC-REQA             TO ADR-REQA
              MOVE 1                        TO WSS-STAT-PGM
              MOVE WSS-KEY-ANT IN WSS-VARI
                                    TO WSS-KEY-ERR IN WSS-VARI
              GO TO FIN-GRA-INTERFAZ.
      *     jpa INI
      *     MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
      *     MOVE FIO-GET-KEY         TO FIO-CMND.
      *     PERFORM SGC-FIO-DBC.
      *     IF NOT FIO-STAT-OKS
      *        MOVE 'DBC   INEX'             TO ERR-COD-MENS IN ERR
      *        MOVE 'DBC-CIC-ICLI'           TO ERR-COD-CMPO IN ERR
      *        MOVE ADR-DBC-REQA             TO ADR-REQA
      *        MOVE 1                        TO WSS-STAT-PGM
      *        MOVE WSS-KEY-ANT IN WSS-VARI
      *                              TO WSS-KEY-ERR IN WSS-VARI
      *        GO TO FIN-GRA-INTERFAZ.
      *
      *     MOVE DBC-IDC-ICLI IN DBC TO LMC-IDC-ICLI IN LMC.
           MOVE RDC-CIC-ICLI IN RDC TO LMC-IDC-ICLI IN LMC.
      * jpa FIN
      *JPA-INI CAMPOS NO USADOS EN CHILE
           MOVE SPACES TO LMC-MSC-MCAN IN LMC.
           MOVE SPACES TO LMC-KEY-IDLO IN LMC.
           MOVE ZEROES TO LMC-NUM-IDLO IN LMC.
           MOVE ZEROES TO LMC-COD-ODES IN LMC.
           MOVE ZEROES TO LMC-NUM-CCAP IN LMC.
           MOVE SPACES TO LMC-COD-CATE IN LMC.
           MOVE SPACES TO LMC-CIC-TCDC IN LMC.
           MOVE ZEROES TO LMC-VAL-AIVA IN LMC.
           MOVE ZEROES TO LMC-VAL-TIMP IN LMC.
           MOVE ZEROES TO LMC-VAL-MCAL IN LMC.
           MOVE ZEROES TO LMC-VAL-VREN IN LMC.
           MOVE ZEROES TO LMC-NUM-ADIC IN LMC.
           MOVE ZEROES TO LMC-COD-OORE IN LMC.
           MOVE ZEROES TO LMC-COD-ODRE IN LMC.
           MOVE SPACES TO LMC-COD-MPPI IN LMC.
           MOVE ZEROES TO LMC-COD-OPPI IN LMC.
           MOVE SPACES TO LMC-GLS-DISP IN LMC.
      *JPA-FIN CAMPOS NO USADOS EN CHILE
           SET ASIENTO-I TO 1.
       LUP-GRA-INTERFAZ.
           IF (( ASIENTO-I > 100 ) OR
               ( VEC-IND (ASIENTO-I) = SPACES AND
                 VEC-CUENTA (ASIENTO-I) = SPACES AND
                 VEC-MONTO (ASIENTO-I) = ZEROES ))
              GO TO FIN-GRA-INTERFAZ.
           MOVE VEC-CUENTA (ASIENTO-I)   TO LMC-CIC-CCSB IN LMC.
           MOVE VEC-NUM-VIGE (ASIENTO-I)  TO LMC-NUM-NVIG IN LMC.
           MOVE VEC-IND (ASIENTO-I)      TO LMC-IND-DBHB IN LMC.
           MOVE VEC-MONTO (ASIENTO-I)    TO LMC-SGV-ICTB IN LMC.
           MOVE VEC-TCCT (ASIENTO-I)     TO LMC-MSC-TCCT IN LMC.
           MOVE VEC-IND-LIQ (ASIENTO-I)  TO LMC-IND-LIQU IN LMC.
      *DPM ini  21-NOV-1995
           MOVE SPACES                   TO LMC-IND-CORR IN LMC.
      *DPM fin  21-NOV-1995
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LMC.
           ADD 1 TO CNT-REG-GRA IN WSS-VARI.
       SIG-GRA-INTERFAZ.
           SET ASIENTO-I UP BY 1.
           GO TO LUP-GRA-INTERFAZ.
       FIN-GRA-INTERFAZ.
           EXIT.

      *DPM ini  21-NOV-1995
      *GUARDAR-EN-VECTOR SECTION.
      *INI-GUARDAR-EN-VECTOR.
      *     SET VEC-I TO 1.
      *     SEARCH VEC-OFIC AT END GO TO SIG-GUARDAR
      *     WHEN VEC-COD-OFIC (VEC-I) = WSS-COD-OFIC IN WSS-VARI AND
      *         VEC-CIC-IOPC (VEC-I) = WSS-CIC-OPC-ANT IN WSS-VARI
      *         DISPLAY 'WSS CIC OPC ANT ' WSS-CIC-OPC-ANT IN WSS-VARI
      *         DISPLAY 'WSS COD OFIC ' WSS-COD-OFIC IN WSS-VARI
      *         DISPLAY 'WSS MONTO ' WSS-SGV-MNTO IN WSS-VARI
      *         ADD WSS-SGV-MNTO IN WSS-VARI TO VEC-SGV-MONTO (VEC-I)
      *         MOVE ZEROES TO WSS-SGV-MNTO IN WSS-VARI.
      *SIG-GUARDAR.
      *     ADD 1 TO VEC-TOPE.
      *     SET VEC-I TO VEC-TOPE.
      *     MOVE WSS-COD-OFIC IN WSS-VARI TO VEC-COD-OFIC (VEC-I).
      *     MOVE WSS-SGV-MNTO IN WSS-VARI TO VEC-SGV-MONTO (VEC-I).
      *     MOVE WSS-COD-MVTO IN WSS-VARI TO VEC-COD-MVTO (VEC-I).
      *     IF WSS-COD-VCAM IN WSS-VARI NOT = WSS-COD-MNAC
      *        MOVE 0                     TO VEC-IND-TIFZ (VEC-I)
      *     ELSE
      *        MOVE 1                     TO VEC-IND-TIFZ (VEC-I).
      *     MOVE WSS-FEC-FFEC IN WSS-VARI TO VEC-FEC-FPRO (VEC-I).
      *     MOVE WSS-FEC-FCTB IN WSS-VARI TO VEC-FEC-FCTB (VEC-I).
      *     MOVE WSS-COD-VCAM IN WSS-VARI TO VEC-COD-VCOC (VEC-I).
      *     MOVE WSS-COD-OFIC IN WSS-VARI TO VEC-COD-OGEN (VEC-I).
      *
      *     MOVE WSS-IND-CANC IN WSS-VARI TO VEC-IND-CANC (VEC-I).
      *     MOVE WSS-COD-OFCR IN WSS-VARI TO VEC-COD-OFCR (VEC-I).
      *     MOVE WSS-FEC-FREA IN WSS-VARI TO VEC-FEC-FREA (VEC-I).
      *
      *     MOVE WSS-COD-COCR IN WSS-VARI   TO VEC-COD-COOC (VEC-I).
      *     MOVE WSS-CIC-OPC-ANT            TO VEC-CIC-IOPC (VEC-I).
      *     MOVE WSS-NUM-IDLC IN WSS-VARI   TO VEC-NUM-IDLC (VEC-I).
      *     MOVE WSS-NUM-IVCT IN WSS-VARI   TO VEC-NUM-IVCT (VEC-I).
      *     MOVE WSS-NUM-ICAN IN WSS-VARI   TO VEC-NUM-ICAN (VEC-I).
      *     MOVE WSS-SGV-SCRE IN WSS-VARI   TO VEC-SGV-SCRE (VEC-I).
      *     NUMERO DE DOCUMENTO DEL CLIENTE
      *     MOVE WSS-CIC-OPC-ANT  IN WSS-VARI TO RDC-CIC-IOPC IN RDC.
      *     MOVE ZEROES                       TO RDC-NUM-IDLC IN RDC.
      *     MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
      *     MOVE FIO-GET-KEY         TO FIO-CMND.
      *     PERFORM COL-FIO-RDC.
      *     IF NOT FIO-STAT-OKS
      *        MOVE 'RDC   INEX'             TO ERR-COD-MENS IN ERR
      *                                         ERC-COD-MSGE IN ERC
      *        PERFORM GRABAR-ERROR
      *        MOVE 'RDC-CIC-ICLI'           TO ERR-COD-CMPO IN ERR
      *        MOVE ADR-RDC-REQA             TO ADR-REQA
      *        MOVE 1                        TO WSS-STAT-PGM
      *        MOVE WSS-KEY-ANT IN WSS-VARI
      *                              TO WSS-KEY-ERR IN WSS-VARI
      *        GO TO FIN-GUARDAR-EN-VECTOR.
      *     MOVE RDC-CIC-ICLI IN RDC TO VEC-IDC-ICLI (VEC-I).
      *
      *     ADD 1 TO CNT-REG-GRA IN WSS-VARI.
      *FIN-GUARDAR-EN-VECTOR.
      *     EXIT.

       GRABA-VECTOR-OFIC SECTION.
       INI-GRABA-VECTOR-OFIC.
      *DPM INI  02-JUL-1996
      *    MOVE 090                      TO LMC-COD-OFOC IN LMC
           MOVE 150                      TO LMC-COD-OFOC IN LMC
                                            LMC-COD-OGEN IN LMC.
      *DPM FIN  02-JUL-1996
      *BUS-OFI busca oficina en tablas
      * jpa inhibe busqueda de oficina centralizadora para moneda
      *     nacional. En BCI existen ofic.cabezera solo para moneda
      *     extranjera.
           IF LMC-MSC-TVOC IN LMC NOT = '0'
              IF  LMC-COD-OFOC IN LMC      > SPACES
                  MOVE LMC-COD-OFOC IN LMC      TO OFI-COD-OFIC IN OFI
                  PERFORM BUS-OFI
                  IF OFI-COD-OFCO IN OFI NOT = OFI-COD-OFIC IN OFI AND
                     OFI-COD-OFCO IN OFI NOT = SPACES
                     MOVE OFI-COD-OFCO IN OFI TO LMC-COD-OFOC IN LMC.
      *
      *Busca Centro de Costo
           MOVE ZEROES TO WSS-CNT-AST IN WSS-VARI.
           MOVE 'COL'                   TO FIO-SIST.
           MOVE 'OCC'                   TO TAB-COD-TTAB.
           MOVE LMC-IND-TIFZ IN LMC  TO WSS-COD-TVOC IN WSS-VARI.
       OCC-GRA-INTERFAZ1.
           MOVE WSS-COD-COCR IN WSS-VARI
                                     TO WSS-COD-COOC IN WSS-VARI.
           MOVE LMC-COD-OGEN IN LMC  TO WSS-COD-OFOC IN WSS-VARI.
           PERFORM REV-LEC-OCC.
           MOVE WSS-COD-TAB IN WSS-VARI TO TAB-COD-CTAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S')
              IF WSS-CNT-AST IN WSS-VARI < 4
                 GO TO OCC-GRA-INTERFAZ1
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE TAB-EXT-CTAB IN TAB TO WSS-EXT-CTAB IN WSS-VARI
              MOVE WSS-OFI-CTAB IN WSS-VARI TO LMC-COD-OFOC IN LMC.

           MOVE ZEROES                   TO LMC-COD-CCST IN LMC.
           SET VEC-OOF TO 1.
       LUP-VEC-OFIC.
           IF VEC-OOF  > VEC-TOPE-OOF
               GO TO FIN-GRABA-VECTOR-OFIC.
      * RBG/INI/ 28-JAN-1998
      * Este cambio se debe a la centralizacion de castigos.
           IF VEC-IND-DEHA (VEC-OOF) = 'H'
               MOVE 'D'                      TO LMC-IND-DBHB IN LMC
               MOVE VEC-NUM-CTAD (VEC-OOF)   TO LMC-CIC-CCSB IN LMC
           ELSE
               MOVE 'H'                      TO LMC-IND-DBHB IN LMC
               MOVE VEC-NUM-CTAD (VEC-OOF)   TO LMC-CIC-CCSB IN LMC.
      * RBG/FIN/ 28-JAN-1998

           MOVE VEC-NUM-NVIG (VEC-OOF)   TO LMC-NUM-NVIG IN LMC.
           MOVE VEC-SGV-MONT (VEC-OOF)   TO LMC-SGV-ICTB IN LMC.
           MOVE VEC-GLS-TCCT (VEC-OOF)   TO LMC-MSC-TCCT IN LMC.
           MOVE VEC-IND-LIQUI (VEC-OOF)  TO LMC-IND-LIQU IN LMC.
           MOVE 'S'                      TO LMC-IND-CORR IN LMC.
           MOVE FIO-PUT                  TO FIO-CMND.
           PERFORM COL-FIO-LMC.
           ADD 1                         TO CNT-REG-GRA IN WSS-VARI.


      * RBG/INI/ 28-JAN-1998
      * Este cambio se debe a la centralizacion de castigos.
           IF LMC-IND-DBHB IN LMC = 'H'
               MOVE 'D'                      TO LMC-IND-DBHB IN LMC
               MOVE VEC-NUM-CTAH (VEC-OOF)   TO LMC-CIC-CCSB IN LMC
           ELSE
               MOVE 'H'                      TO LMC-IND-DBHB IN LMC
               MOVE VEC-NUM-CTAH (VEC-OOF)   TO LMC-CIC-CCSB IN LMC.
      * RBG/FIN/ 28-JAN-1998

      ***     MOVE 'H'                      TO LMC-IND-DBHB IN LMC.
           MOVE ZEROES                   TO LMC-NUM-NVIG IN LMC
      ***     MOVE VEC-NUM-CTAH (VEC-OOF)   TO LMC-CIC-CCSB IN LMC.
           MOVE FIO-PUT                  TO FIO-CMND.
           PERFORM COL-FIO-LMC.
           ADD 1                         TO CNT-REG-GRA IN WSS-VARI.
           SET VEC-OOF UP BY 1.
           GO TO LUP-VEC-OFIC.
       FIN-GRABA-VECTOR-OFIC.
           EXIT.
      *DPM fin  21-NOV-1995
       REV-LEC-OCC SECTION.
       INI-REV-LEC-OCC.
           IF WSS-CNT-AST IN WSS-VARI = 0
              GO TO AVA-REV-LEC-OCC.
           IF WSS-CNT-AST IN WSS-VARI = 1
              MOVE '*  ' TO WSS-COD-OFOC IN WSS-VARI
              GO TO AVA-REV-LEC-OCC.
           IF WSS-CNT-AST IN WSS-VARI = 2
              MOVE '*  ' TO WSS-COD-AOOC IN WSS-VARI
              GO TO AVA-REV-LEC-OCC.
           IF WSS-CNT-AST IN WSS-VARI = 3
              MOVE '*  ' TO WSS-COD-AOOC IN WSS-VARI
              MOVE '*  ' TO WSS-COD-OFOC IN WSS-VARI
              GO TO AVA-REV-LEC-OCC.
       AVA-REV-LEC-OCC.
           ADD 1 TO WSS-CNT-AST IN WSS-VARI.
       FIN-REV-LEC-OCC.
           EXIT.
       OBT-CPTO-ALG SECTION.
       INI-OBT-CPTO-ALG.
            MOVE 'COL'                TO FIO-SIST.
            MOVE 'ALG'                TO TAB-COD-TTAB.
            MOVE CPP-IND-TALG (CPP-I) TO TAB-COD-CTAB.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF NOT (FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S')
               MOVE 'ALGCICINEX'             TO ERR-COD-MENS IN ERR
                                                ERC-COD-MSGE IN ERC
               MOVE CPP-COD-MVTO IN CPP      TO ERC-COD-EVEN IN ERC
               PERFORM GRABAR-ERROR
      * RRM-INI 13-MAY-1999
               PERFORM MOV-VEC-A-VEC
               MOVE 'S' TO WSS-IND-GRCX IN WSS-VARI
      * RRM-FIN 13-MAY-1999
               MOVE 'CPP-IND-TALG'           TO ERR-COD-CMPO IN ERR
               MOVE ADR-TAB-REQA             TO ADR-REQA
               MOVE 1                        TO WSS-STAT-PGM
               MOVE WSS-KEY-ANT IN WSS-VARI
                                    TO WSS-KEY-ERR IN WSS-VARI
               GO TO FIN-OBT-CPTO-ALG.
            MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-CPTO IN WSS-VARI.
       FIN-OBT-CPTO-ALG.
           EXIT.
       OBT-CUENTA-DCC SECTION.
       INI-OBT-CUENTA-DCC.
      *DPM INI  21-FEB-1997 Se incluyo la sit. cobranza para dejar
      * generica la busqueda en dcc
           IF VEC-IND-LIQ (ASIENTO-I) = 'L '
               MOVE SPACES TO DCC-IND-SCTB IN DCC
                              DCC-IND-SCBZ IN DCC
      *                        DCC-IND-SCRT IN DCC
           ELSE
               MOVE WSS-IND-SCTB IN WSS-VARI TO DCC-IND-SCTB IN DCC
               MOVE WSS-IND-SCBZ IN WSS-VARI TO DCC-IND-SCBZ IN DCC.
      *         MOVE WSS-IND-SCRT IN WSS-VARI TO DCC-IND-SCRT IN DCC.
      *DPM FIN  21-FEB-1997
           MOVE 'DCC'                    TO DCC-COD-TTAB IN DCC.
           MOVE CPP-MSC-TCCT (CPP-I)     TO DCC-MSC-TCCT IN DCC.
           MOVE WSS-COD-VCAM IN WSS-VARI TO DCC-COD-VCAM IN DCC.
           MOVE WSS-COD-COCR IN WSS-VARI TO DCC-COD-COCR IN DCC.
           MOVE WSS-COD-PLZO IN WSS-VARI TO DCC-COD-PLZO IN DCC.
      *DPM INI  21-FEB-1997
      *     MOVE WSS-IND-SCTB IN WSS-VARI TO DCC-IND-SCTB IN DCC.
      *     MOVE WSS-IND-SCBZ IN WSS-VARI TO DCC-IND-SCBZ IN DCC.
           MOVE WSS-IND-SCRT IN WSS-VARI TO DCC-IND-SCRT IN DCC.
      *DPM FIN  21-FEB-1997
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DCC.
           IF NOT FIO-STAT-OKS
              MOVE '* ' TO DCC-COD-PLZO IN DCC
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-DCC
              IF NOT FIO-STAT-OKS
                 MOVE '*     ' TO DCC-COD-COCR IN DCC
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM COL-FIO-DCC
                 IF NOT FIO-STAT-OKS
                    MOVE 'DCC   INEX'       TO ERR-COD-MENS IN ERR
                                               ERC-COD-MSGE IN ERC
                    MOVE CPP-COD-MVTO IN CPP TO ERC-COD-EVEN IN ERC
                    PERFORM GRABAR-ERROR
      *RRM-INI 13-MAY-1999
                    PERFORM MOV-VEC-A-VEC
                    MOVE 'S' TO WSS-IND-GRCX IN WSS-VARI
      *RRM-FIN 13-MAY-1999
                    MOVE 'DCC-KEY-IREG'     TO ERR-COD-CMPO IN ERR
                    MOVE ADR-DCC-REQA       TO ADR-REQA
                    MOVE 1                  TO WSS-STAT-PGM
                    MOVE WSS-KEY-ANT IN WSS-VARI
                                            TO WSS-KEY-ERR IN WSS-VARI
                    GO TO FIN-OBT-CUENTA-DCC.
       FIN-OBT-CUENTA-DCC.
           EXIT.

       GRABAR-ERROR SECTION.
       INI-GRA-ERR.
           MOVE WSS-CIC-OPC-ANT IN WSS-VARI TO ERC-CIC-IOPC IN ERC.
           MOVE WSS-COD-OFIC IN WSS-VARI    TO ERC-COD-OFIC IN ERC.
      *     MOVE 'CUR'                       TO ERC-COD-EVEN IN ERC.
           MOVE 'LMC'                       TO ERC-COD-PGRM IN ERC.
      *DPM ini  22-APR-1997
      *     MOVE ZEROES                      TO ERC-NUM-CANC IN ERC.
      *DPM fin  22-APR-1997
           MOVE SPACES                      TO ERC-GLS-DISP IN ERC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ERC.
       FIN-GRA-ERR.
           EXIT.

       LIM-ARREGLO SECTION.
       INI-LIM-ARREGLO.
           MOVE  ZEROES TO MOV-TOPE.
           MOVE  ZEROES TO WSS-SUM-DEBE  IN WSS-VARI.
           MOVE  ZEROES TO WSS-SUM-HABER IN WSS-VARI.
           SET MOV-I TO 1.
           SET ASIENTO-I TO 1.
       LUP-LIM-ARREGLO.
           IF MOV-I > 100
              GO TO SI1-LIM-ARREGLO.
           MOVE SPACES TO  VEC-COD-CPTO (MOV-I).
           MOVE ZEROES TO  VEC-SGV-MNTO (MOV-I).
           MOVE SPACES TO  VEC-IND-LIQU (MOV-I).
           MOVE SPACES TO  VEC-CUENTA (ASIENTO-I).
           MOVE SPACES TO  VEC-IND (ASIENTO-I).
           MOVE ZEROES TO  VEC-MONTO (ASIENTO-I).
           MOVE ZEROES TO  VEC-NUM-VIGE (ASIENTO-I).
           MOVE SPACES TO  VEC-TCCT (ASIENTO-I).
           MOVE SPACES TO  VEC-IND-LIQ (ASIENTO-I).
       NXT-LIM-ARREGLO.
           SET MOV-I UP BY 1.
           SET ASIENTO-I UP BY 1.
           GO TO LUP-LIM-ARREGLO.
       SI1-LIM-ARREGLO.
           SET VEC-OOF   TO 1.
       LUP-LIM-ARREGLO1.
           IF VEC-OOF > 20
              GO TO FIN-LIM-ARREGLO.
           MOVE ZEROES TO  VEC-SGV-MONT (VEC-OOF).
           MOVE SPACES TO  VEC-NUM-CTAD (VEC-OOF).
           MOVE SPACES TO  VEC-GLS-TCCT (VEC-OOF).
           MOVE SPACES TO  VEC-NUM-CTAH (VEC-OOF).
           MOVE SPACES TO  VEC-IND-LIQUI (VEC-OOF).
           MOVE ZEROES TO  VEC-NUM-NVIG (VEC-OOF).
       NXT-LIM-ARREGLO1.
           SET VEC-OOF UP BY 1.
           GO TO LUP-LIM-ARREGLO1.
       FIN-LIM-ARREGLO.
           EXIT.
       INI-VAR-ANT SECTION.
       INI-INI-VAR-ANT.
      *RRM-INI 17-MAY-1999
           MOVE MCD TO MCDBAK.
      *RRM-FIN 17-MAY-1999
      *DPM ini  21-NOV-1995
           MOVE ZEROES               TO WSS-SGV-MNTO IN WSS-VARI.
      *DPM fin  21-NOV-1995
           MOVE MCD-KEY-ICPP IN MCD  TO WSS-KEY-CPP-ANT.
           MOVE MCD-CIC-IOPC IN MCD  TO WSS-CIC-OPC-ANT.
           MOVE MCD-NUM-ICAN IN MCD  TO WSS-NUM-ICAN-ANT.
           MOVE MCD-COD-VCOC IN MCD  TO WSS-COD-VCAM IN WSS-VARI.
           MOVE MCD-COD-COOC IN MCD  TO WSS-COD-COCR IN WSS-VARI.
           MOVE MCD-COD-PLZO IN MCD  TO WSS-COD-PLZO IN WSS-VARI.
           MOVE MCD-IND-SCRT IN MCD  TO WSS-IND-SCRT IN WSS-VARI.
           MOVE MCD-IND-SCTB IN MCD  TO WSS-IND-SCTB IN WSS-VARI.
      *DPM INI  15-OCT-1996
           MOVE MCD-IND-LIQU IN MCD  TO WSS-IND-LIQU IN WSS-VARI.
      *DPM FIN  15-OCT-1996
           MOVE MCD-IND-SCBZ IN MCD  TO WSS-IND-SCBZ IN WSS-VARI.
           MOVE MCD-COD-OFOC IN MCD  TO WSS-COD-OFIC IN WSS-VARI.
      *RJZ INI 21-JUNIO-1995
           MOVE MCD-COD-OFCA IN MCD  TO WSS-COD-OFCA IN WSS-VARI.
      *RJZ FIN 21-JUNIO-1995
           MOVE MCD-NUM-IVCT IN MCD  TO WSS-NUM-IVCT IN WSS-VARI.
           MOVE MCD-NUM-IDLC IN MCD  TO WSS-NUM-IDLC IN WSS-VARI.
           MOVE MCD-NUM-ICAN IN MCD  TO WSS-NUM-ICAN IN WSS-VARI.
           MOVE MCD-SGV-SCRE IN MCD  TO WSS-SGV-SCRE IN WSS-VARI.
           MOVE MCD-COD-MVTO IN MCD  TO WSS-COD-MVTO IN WSS-VARI.
           MOVE MCD-FEC-FCTB IN MCD  TO WSS-FEC-FCTB IN WSS-VARI.
      *
           MOVE MCD-IND-CANC IN MCD  TO WSS-IND-CANC IN WSS-VARI.
      *RJZ INI 02-06-95
      *    MOVE MCD-COD-OFOC IN MCD  TO WSS-COD-OFCR IN WSS-VARI.
           MOVE MCD-COD-OFMV IN MCD  TO WSS-COD-OFCR IN WSS-VARI.
      *RJZ FIN 02-06-95
           MOVE MCD-FEC-FREA IN MCD  TO WSS-FEC-FREA IN WSS-VARI.
      *DPM ini  22-NOV-1995
           MOVE ZEROES TO VEC-TOPE.
           MOVE ZEROES TO VEC-TOPE-OOF.
      *DPM fin  22-NOV-1995
       FIN-INI-VAR-ANT.
           EXIT.
       AGR-A-VEC SECTION.
       INI-AGR-A-VEC.
           ADD 1 TO MOV-TOPE.
           SET MOV-I TO MOV-TOPE.
           MOVE MCD-SGV-CPTO IN MCD TO  VEC-COD-CPTO  (MOV-I).
           MOVE MCD-SGV-MNTO IN MCD TO  VEC-SGV-MNTO  (MOV-I).
           MOVE MCD-IND-LIQU IN MCD TO  VEC-IND-LIQU  (MOV-I).
           IF MCD-SGV-CPTO IN MCD = 'CAP   '
               MOVE MCD-SGV-MNTO IN MCD TO  ERC-VAL-MNTO IN ERC
      *DPM ini  21-APR-1997
               MOVE ZEROES              TO  ERC-NUM-CANC IN ERC
           ELSE
           IF MCD-COD-MVTO IN MCD = 'CAN' AND
              MCD-IND-LIQU IN MCD = 'L'
               MOVE MCD-SGV-MNTO IN MCD TO  ERC-VAL-MNTO IN ERC
               MOVE MCD-NUM-ICAN IN MCD TO  ERC-NUM-CANC IN ERC.
      *DPM fin  21-APR-1997
       FIN-AGR-A-VEC.
           EXIT.

       CLOSE-FILE SECTION.
      *------------------
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
      *DPM ini  22-NOV-1995
           PERFORM GNS-FIO-CIC.
      *DPM fin  22-NOV-1995
           PERFORM COL-FIO-CPP.
           PERFORM COL-FIO-DCC.
           PERFORM COL-FIO-MCD.
           PERFORM COL-FIO-LMC.
           PERFORM COL-FIO-ERC.
           PERFORM TAB-FIO-OFI.
           PERFORM TAB-FIO-CAM.
           PERFORM COL-FIO-RDC.
      * RRM-INI 11-MAY-1999
           PERFORM COL-FIO-RCA.
           PERFORM COL-FIO-RCU.
      * RRM-FIN 11-MAY-1999
      *     PERFORM SGC-FIO-DBC.
      *    PERFORM GNS-FIO-ERR.
           MOVE 'COL' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
       FIN-CLOSE-FILE.
           EXIT.


      *RRM-INI 10-MAY-1999
       GRABAR-RCA-RCU SECTION.
      *----------------------
       INI-GRABAR-RCA-RCU.
           IF MCD-COD-TOOC IN MCD = 'CCP'    OR
              MCD-COD-COOC IN MCD = 'COM123' OR
              MCD-COD-COOC IN MCD = 'COM323'
               GO TO FIN-GRABAR-RCA-RCU.

      *RRM-INI 10-JUN-1999
           PERFORM INI-REG-RCA-RCU.
      *RRM-FIN 10-JUN-1999

           IF MCD-COD-MVTO IN MCD = 'CAN'
               MOVE MCD-CIC-IOPC     IN MCD      TO RCA-CIC-IOPC IN RCA
               MOVE MCD-NUM-ICAN     IN MCD      TO RCA-NUM-CANC IN RCA
               MOVE MCD-COD-VCOC     IN MCD      TO RCA-COD-MONE IN RCA
               MOVE MCD-IND-CANC     IN MCD      TO RCA-IND-TCAN IN RCA
               MOVE MCD-COD-OFOC     IN MCD      TO RCA-COD-OFIC IN RCA
               MOVE MCD-COD-COOC     IN MCD      TO RCA-COD-COOC IN RCA
               MOVE MCD-FEC-FCTB     IN MCD      TO RCA-FEC-FCAC IN RCA
               MOVE WSS-CUENTA       IN WSS-VARI TO RCA-NUM-CCAP IN RCA
               MOVE SPACES                       TO RCA-GLS-DISP IN RCA
               PERFORM VECTOR-A-RCA
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-RCA
               GO TO FIN-GRABAR-RCA-RCU.

           IF MCD-COD-MVTO IN MCD = 'CUR'
               MOVE MCD-CIC-IOPC     IN MCD      TO RCU-CIC-IOPC IN RCU
               MOVE MCD-COD-VCOC     IN MCD      TO RCU-COD-MONE IN RCU
               MOVE MCD-COD-OFOC     IN MCD      TO RCU-COD-OFIC IN RCU
               MOVE MCD-COD-COOC     IN MCD      TO RCU-COD-COOC IN RCU
               MOVE MCD-FEC-FCTB     IN MCD      TO RCU-FEC-FCUC IN RCU
               MOVE WSS-CUENTA       IN WSS-VARI TO RCU-NUM-CCAP IN RCU
               MOVE SPACES                       TO RCU-GLS-DISP IN RCU
               PERFORM VECTOR-A-RCU
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-RCU
               GO TO FIN-GRABAR-RCA-RCU.
       FIN-GRABAR-RCA-RCU.
           EXIT.

       VECTOR-A-RCU SECTION.
      *--------------------
       INI-VECTOR-A-RCU.
           SET RCX-I TO 1.
       LEE-VECTOR.
           IF RCX-I > 100
              GO TO FIN-VECTOR-A-RCU.
           IF VEC-RCX-CPTO (RCX-I) = 'CAP   '
              COMPUTE RCU-VAL-CAPC IN RCU ROUNDED =
                                         VEC-RCX-MNTO (RCX-I)
              GO TO FIN-VECTOR-A-RCU.
           SET RCX-I UP BY 1.
           GO TO LEE-VECTOR.
       FIN-VECTOR-A-RCU.
           EXIT.

       VECTOR-A-RCA SECTION.
      *--------------------
       INI-VECTOR-A-RCA.
           MOVE ZEROES    TO WSS-SUM-INTE    IN WSS-VARI.
           MOVE ZEROES    TO WSS-SUM-COMI    IN WSS-VARI.
           SET RCX-I TO 1.
       LEE-VECTOR.
           IF RCX-I > 100
              GO TO FIN-VECTOR-A-RCA.

           IF VEC-RCX-CPTO (RCX-I) = 'CPA   '
              COMPUTE RCA-VAL-CAPC IN RCA ROUNDED =
                                              VEC-RCX-MNTO (RCX-I).

           IF VEC-RCX-CPTO (RCX-I) = 'INT   ' OR
                                        VEC-RCX-CPTO (RCX-I) = 'INTMOR'
              COMPUTE WSS-SUM-INTE IN WSS-VARI ROUNDED =
                      WSS-SUM-INTE IN WSS-VARI + VEC-RCX-MNTO (RCX-I).

           IF VEC-RCX-CPTO (RCX-I) = 'RJS   '
              COMPUTE RCA-VAL-REAC IN RCA ROUNDED =
                                                 VEC-RCX-MNTO (RCX-I).

           IF VEC-RCX-CPTO (RCX-I) = 'CONONO' OR
                                        VEC-RCX-CPTO (RCX-I) = 'IVACOM'
              COMPUTE WSS-SUM-COMI IN WSS-VARI ROUNDED =
                      WSS-SUM-COMI IN WSS-VARI + VEC-RCX-MNTO (RCX-I).

           SET RCX-I UP BY 1.
           GO TO LEE-VECTOR.
       FIN-VECTOR-A-RCA.
           MOVE WSS-SUM-INTE IN WSS-VARI TO RCA-VAL-INTC IN RCA.
           MOVE WSS-SUM-COMI IN WSS-VARI TO RCA-VAL-CMSC IN RCA.
           EXIT.

       LEER-DCC-CAP SECTION.
       INI-LEER-DCC-CAP.
           MOVE 'DCC'                    TO DCC-COD-TTAB IN DCC.
           MOVE 'CAP   '                 TO DCC-MSC-TCCT IN DCC.
           MOVE MCD-COD-VCOC IN MCD      TO DCC-COD-VCAM IN DCC.
           MOVE MCD-COD-COOC IN MCD      TO DCC-COD-COCR IN DCC.
           MOVE MCD-COD-PLZO IN MCD      TO DCC-COD-PLZO IN DCC.
           MOVE MCD-IND-SCRT IN MCD      TO DCC-IND-SCRT IN DCC.
           MOVE MCD-IND-SCTB IN MCD      TO DCC-IND-SCTB IN DCC.
           MOVE MCD-IND-SCBZ IN MCD      TO DCC-IND-SCBZ IN DCC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DCC.
           IF NOT FIO-STAT-OKS
              MOVE '* ' TO DCC-COD-PLZO IN DCC
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-DCC
              IF NOT FIO-STAT-OKS
                 MOVE '*     ' TO DCC-COD-COCR IN DCC
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM COL-FIO-DCC.

           IF FIO-STAT-OKS
              MOVE DCC-GLS-CCSB IN DCC TO WSS-CUENTA IN WSS-VARI
           ELSE
              MOVE SPACES              TO WSS-CUENTA IN WSS-VARI.
       FIN-LEER-DCC-CAP.
           EXIT.

       MOV-VEC-A-VEC SECTION.
      *--------------------
       INI-MOV-VEC-A-VEC.
           SET MOV-I TO 1.
           SET RCX-I TO 1.
       LEE-VECTORES-VEC.
           IF MOV-I > 100
              GO TO FIN-MOV-VEC-A-VEC.
           MOVE VEC-COD-CPTO (MOV-I) TO VEC-RCX-CPTO (RCX-I).
           MOVE VEC-SGV-MNTO (MOV-I) TO VEC-RCX-MNTO (RCX-I).
           SET MOV-I UP BY 1.
           SET RCX-I UP BY 1.
           GO TO LEE-VECTORES-VEC.
       FIN-MOV-VEC-A-VEC.
           EXIT.
       DISPL-VEC-RCX SECTION.
      *--------------------
       INI-DISPL-VEC-RCX.
           DISPLAY '   '.
           DISPLAY 'VECTOR PARA LLENAR RCA/RCU'.
           SET RCX-I TO 1.
       LEE-VECTOR-RCX.
           IF RCX-I > 100
              GO TO FIN-DISPL-VEC-RCX.
           DISPLAY VEC-RCX-CPTO (RCX-I) ' = '
                                          VEC-RCX-MNTO (RCX-I).
           SET RCX-I UP BY 1.
           GO TO LEE-VECTOR-RCX.
       FIN-DISPL-VEC-RCX.
           EXIT.

      *RRM-INI 10-JUN-1999
       INI-REG-RCA-RCU SECTION.
      *------------------------
       INI-INI-REG-RCA-RCU.
           MOVE SPACES TO RCA.
           MOVE SPACES TO RCU.
           MOVE ZEROES TO RCA-VAL-CAPC IN RCA.
           MOVE ZEROES TO RCA-VAL-INTC IN RCA.
           MOVE ZEROES TO RCA-VAL-REAC IN RCA.
           MOVE ZEROES TO RCA-VAL-CMSC IN RCA.
           MOVE ZEROES TO RCU-VAL-CAPC IN RCU.
       FIN-INI-REG-RCA-RCU.
           EXIT.
      *RRM-FIN 10-JUN-1999

       COPY COLBFRCA.
       COPY COLBFRCU.
      *RRM-FIN 10-MAY-1999
      *DPM ini  21-NOV-1995
       COPY GNSBFCIC.
       COPY GNSBBCIC.
      *COPY GNSBPVRF.
      *DPM fin  21-NOV-1995
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
      *COPY GNSBFERR.
       COPY GNSBGERR.
       COPY COLBFMCD.
       COPY COLBFCPP.
       COPY COLBFDCC.
       COPY COLBFERC.
       COPY COLBFLMC.
       COPY COLBFRDC.
      *COPY SGCBFDBC.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGPES.
       COPY GNSBGABT.
       COPY TABBBOFI.
       COPY TABBFOFI.
      *COPY TABBBCVG.
       COPY TABBFCAM.




