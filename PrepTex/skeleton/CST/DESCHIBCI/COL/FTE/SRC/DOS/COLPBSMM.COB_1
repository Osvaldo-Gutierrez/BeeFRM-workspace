       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPBSMM.
       AUTHOR.          BEE TEAM (JGM).
       DATE-WRITTEN.    27-JUL-1999
      *
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.


       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
      *<<<< WSS
       COPY COLBRVEN.
       COPY COLBROPC.
       COPY COLBRICG.
       COPY COLBRDLC.
       COPY COLBRRDC.
      *
       COPY COLBRSMM.

       COPY SGCBRDBC.


       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY GNSBRCIC.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGCIC.
       COPY GNSWGFRM.
      *
       01  WSS-VARI.
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 SMM-NUM-LSMM       VALUE ZEROES     PIC 9(08).
           03 SMM-NUM-GSMM       VALUE ZEROES     PIC 9(08).

           03 SMM-NUM-GOPC       VALUE ZEROES     PIC 9(08).
           03 SMM-NUM-EOPC       VALUE ZEROES     PIC 9(08).
           03 SMM-NUM-AOPC       VALUE ZEROES     PIC 9(08).
           03 SMM-NUM-MOPC       VALUE ZEROES     PIC 9(08).


           03 SMM-NUM-GVEN       VALUE ZEROES     PIC 9(08).
           03 SMM-NUM-EVEN       VALUE ZEROES     PIC 9(08).

           03 SMM-NUM-GICG       VALUE ZEROES     PIC 9(08).
           03 SMM-NUM-EICG       VALUE ZEROES     PIC 9(08).

           03 SMM-NUM-GDLC       VALUE ZEROES     PIC 9(08).
           03 SMM-NUM-EDLC       VALUE ZEROES     PIC 9(08).

           03 SMM-NUM-GRDC       VALUE ZEROES     PIC 9(08).
           03 SMM-NUM-ERDC       VALUE ZEROES     PIC 9(08).

           03 SMM-NUM-GDBC       VALUE ZEROES     PIC 9(08).
           03 SMM-NUM-EDBC       VALUE ZEROES     PIC 9(08).
           03 SMM-COD-MENS       VALUE SPACES     PIC X(20).
           03 SMM-COD-MEN2       VALUE SPACES     PIC X(15).


       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPBSMM' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           PERFORM OPEN-FILE.
           PERFORM LEE-PARAM.
           PERFORM PRO-REG-SMIAMI.
           PERFORM CLOSE-FILE.
           PERFORM MUESTRA-ESTADISTICAS.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

      ******************************************************************
       MUESTRA-ESTADISTICAS SECTION.
       INI-MUESTRA-ESTADISTICAS.
           DISPLAY 'ESTADISTICAS PROCESO : COLPBSMM '.
           DISPLAY '==============================='.
           DISPLAY ' REGISTROS LEIDOS      : ' SMM-NUM-LSMM.
           DISPLAY ' REGISTROS GRABADOS    : ' SMM-NUM-GSMM.
           DISPLAY '==============================='.
           DISPLAY ' CREDITOS ACTUALIZADOS : ' SMM-NUM-MOPC.
           DISPLAY ' CREDITOS GENERADO     : ' SMM-NUM-AOPC.
           DISPLAY '==============================='.
       FIN-MUESTRA-ESTADISTICAS.
           EXIT.

       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-SMM.
       FIN-OPEN-FILE.
           EXIT.

       CLOSE-FILE SECTION.
      *-----------------
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-SMM.
       FIN-CLOSE-FILE.
           EXIT.


      ******************************************************************
       LEE-PARAM SECTION.
      *-----------------
       INI-LEE-PARAM.
           DISPLAY 'CAPTURA PARAMETROS'.
           DISPLAY ' '.

      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO (DDMMSSAA): '.
           ACCEPT WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.

      * Validacion de parametros
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR VALIDACION FECHA DE PROCESO: '
                                                    FEC-MENS
               PERFORM GNS-PRO-ABT.
       FIN-LEE-PARAM.
           EXIT.
       COPY COLBFSMM.
       COPY COLBFVEN.
       COPY COLBFOPC.
       COPY COLBFICG.
       COPY COLBFDLC.
       COPY COLBFRDC.

       COPY SGCBFDBC.

       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY GNSBFCIC.

       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.

       COPY GNSBBCIC.
       COPY GNSBBVRF.
       COPY GNSBBMSG.


       PRO-REG-SMIAMI SECTION.
       INI-PRO-REG-SMIAMI.
           MOVE LOW-VALUES  TO SMM.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-SMM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTEN REGISTROS EN SMM'
               GO TO FIN-PRO-REG-SMIAMI.

       LUP-PRO-REG-SMIAMI.
           MOVE SPACES TO SMM-COD-MENS.
           MOVE SPACES TO SMM-COD-MEN2.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-REG-SMIAMI.
      **
           ADD  1      TO SMM-NUM-LSMM IN WSS-VARI.
      **
           PERFORM BUS-DBC-SMM.
           IF SMM-COD-MENS > SPACES
               ADD 1 TO SMM-NUM-EDBC
               GO TO NXT-GRABA-SMIAMI.
      **
           PERFORM GRAB-OPC-SMM.
           IF NOT FIO-STAT-OKS
               ADD 1 TO SMM-NUM-EOPC
               MOVE 'UPDOPCSMMERR' TO SMM-COD-MENS
               MOVE SMM-CIC-IOPC   TO SMM-COD-MEN2
               GO TO NXT-GRABA-SMIAMI.
      **
           PERFORM GRAB-DLC-SMM.
           IF NOT FIO-STAT-OKS
               ADD 1 TO SMM-NUM-EDLC
               MOVE 'UPDDLCSMMERR' TO SMM-COD-MENS
               MOVE SMM-CIC-IOPC   TO SMM-COD-MEN2
               GO TO NXT-GRABA-SMIAMI.
      **
           PERFORM GRAB-VEN-SMM.
           IF NOT FIO-STAT-OKS
               ADD 1 TO SMM-NUM-EVEN
               MOVE 'UPDVENSMMERR' TO SMM-COD-MENS
               GO TO NXT-GRABA-SMIAMI.
      **
           PERFORM GRAB-ICG-SMM.
           IF NOT FIO-STAT-OKS
               ADD 1 TO SMM-NUM-EICG
               MOVE 'UPDOPCSMMERR' TO SMM-COD-MENS
               GO TO NXT-GRABA-SMIAMI.
     **
           PERFORM GRAB-RDC-SMM.
           IF NOT FIO-STAT-OKS
               ADD 1 TO SMM-NUM-ERDC
               MOVE 'UPDOPCSMMERR' TO SMM-COD-MENS
               GO TO NXT-GRABA-SMIAMI.
      *
           ADD  1      TO SMM-NUM-GSMM IN WSS-VARI.

       NXT-GRABA-SMIAMI.
           IF SMM-COD-MENS NOT > SPACES
               PERFORM CHK-PNT
           ELSE
              DISPLAY 'ERROR : '   SMM-COD-MENS ' '
                                   SMM-COD-MEN2
               PERFORM BCK-OUT.
      *
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-SMM.
           GO TO LUP-PRO-REG-SMIAMI.
       FIN-PRO-REG-SMIAMI.
           EXIT.


       GRAB-OPC-SMM SECTION.
       INI-GRAB-OPC-SMM.
           MOVE  SMM-KEY-IOPC IN SMM TO OPC-KEY-IREG IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               ADD 1 TO SMM-NUM-AOPC IN WSS-VARI
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               ADD 1 TO SMM-NUM-MOPC IN WSS-VARI
               PERFORM COL-FIO-OPC
               MOVE FIO-MOD TO FIO-CMND.

       INI-OPC-SMM.
      * Operacion Credito REG :OPC.
      * ----------------------------
           MOVE  SPACES              TO OPC-GLS-FLAG IN OPC.
           MOVE  SMM-KEY-IOPC IN SMM TO OPC-KEY-IREG IN OPC.
           MOVE  HOY-STP-ITRN        TO OPC-STP-ITRN IN OPC.

           MOVE  'I'                 TO OPC-MSC-TACC IN OPC.
           MOVE  'A'                 TO OPC-MSC-STAT IN OPC.
           MOVE  'C'                 TO OPC-MSC-TTRN IN OPC.

           MOVE 'BAT'                TO OPC-COD-TTRN IN OPC.

           MOVE  'COLPBSMM'          TO OPC-COD-ATRN IN OPC.
      *
           MOVE  SMM-COD-VCOC IN SMM TO OPC-COD-VCOC IN OPC.
           MOVE  SMM-COD-COOC IN SMM TO OPC-COD-COOC IN OPC.

           MOVE  SMM-COD-OFOC IN SMM TO OPC-COD-OFOC IN OPC.
           MOVE  SMM-COD-RMOC IN SMM TO OPC-COD-RMOC IN OPC.

           MOVE SPACES               TO OPC-COD-CDOC IN OPC.
           MOVE SPACES               TO OPC-CIC-ILDC IN OPC.
      *
           MOVE SMM-NUM-DCOL IN SMM  TO OPC-NUM-DCOL IN OPC.
           MOVE SMM-NUM-MCOL IN SMM  TO OPC-NUM-MCOL IN OPC.
           MOVE SMM-NUM-SCOL IN SMM  TO OPC-NUM-SCOL IN OPC.
           MOVE SMM-NUM-ACOL IN SMM  TO OPC-NUM-ACOL IN OPC.

           MOVE HOY-DHOY             TO OPC-NUM-DING IN OPC.
           MOVE HOY-MHOY             TO OPC-NUM-MING IN OPC.
           MOVE HOY-SHOY             TO OPC-NUM-SING IN OPC.
           MOVE HOY-AHOY             TO OPC-NUM-AING IN OPC.

           MOVE HOY-DHOY             TO OPC-NUM-DINP IN OPC.
           MOVE HOY-MHOY             TO OPC-NUM-MINP IN OPC.
           MOVE HOY-SHOY             TO OPC-NUM-SINP IN OPC.
           MOVE HOY-AHOY             TO OPC-NUM-AINP IN OPC.

           MOVE SMM-VAL-CRED IN SMM  TO OPC-VAL-CRED IN OPC.
           MOVE SMM-VAL-SCRE IN SMM  TO OPC-VAL-SCRE IN OPC.

           MOVE 'N'                  TO OPC-IND-AFER IN OPC.
           MOVE  SPACES              TO OPC-MSC-MCVF IN OPC.

           MOVE  SPACES              TO OPC-MSC-TCVE IN OPC.

           MOVE  SPACES              TO OPC-IND-RENO IN OPC.
           MOVE  SPACES              TO OPC-IND-GARA IN OPC.

           MOVE  ZEROES              TO OPC-SGV-VCOM IN OPC.

           MOVE  ZEROES              TO OPC-VAL-GAST IN OPC.

           MOVE  SPACES              TO OPC-COD-SEGD IN OPC.

           MOVE  ZEROES              TO OPC-VAL-SEGD IN OPC.
           MOVE  ZEROES              TO OPC-SGV-LIQU IN OPC.

           MOVE  1                   TO OPC-NUM-IVEN IN OPC.
           MOVE  1                   TO OPC-NUM-VCOR IN OPC.
           MOVE  1                   TO OPC-NUM-VCVG IN OPC.

           MOVE  ZEROES              TO OPC-NUM-VCCO IN OPC.
           MOVE  ZEROES              TO OPC-NUM-VCCM IN OPC.
           MOVE  ZEROES              TO OPC-NUM-VCCV IN OPC.
           MOVE  ZEROES              TO OPC-NUM-TVCC IN OPC.
           MOVE  'N'                 TO OPC-IND-VSTR IN OPC.
           MOVE  SPACES              TO OPC-CIC-ICEN IN OPC.

           MOVE  SPACES              TO OPC-COD-AGES IN OPC.
           MOVE  SPACES              TO OPC-IND-CTBL IN OPC.
           MOVE  SPACES              TO OPC-COD-INSI IN OPC.
           MOVE  SPACES              TO OPC-COD-CVTA IN OPC.
           MOVE  ZEROES              TO OPC-VAL-SEGP IN OPC.
           MOVE  SPACES              TO OPC-GLS-DISP IN OPC.
      ********************************
           PERFORM COL-FIO-OPC.
           IF  FIO-STAT-OKS
               ADD 1 TO SMM-NUM-GOPC IN WSS-VARI.
      ********************************
       FIN-GRAB-OPC-SMM.
           EXIT.


       GRAB-DLC-SMM SECTION.
       INI-GRAB-DLC-SMM.

           MOVE  SMM-CIC-IOPC IN SMM TO DLC-CIC-IOPC IN DLC.
           MOVE  1                   TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-DLC
               MOVE FIO-MOD TO FIO-CMND.
      *
       INI-DLC-SMM.
      * Documento Legal Credito: REG : DLC
      * -----------------------------------
           MOVE  SPACES              TO DLC-GLS-FLAG IN DLC.

           MOVE  SMM-CIC-IOPC IN SMM TO DLC-CIC-IOPC IN DLC.
           MOVE  1                   TO DLC-NUM-IDLC IN DLC.
           MOVE HOY-STP-ITRN         TO DLC-STP-ITRN IN DLC.

           MOVE  SPACES              TO DLC-MSC-TACC IN DLC.
           MOVE  SPACES              TO DLC-MSC-STAT IN DLC.
           MOVE  SPACES              TO DLC-COD-OTRN IN DLC.
           MOVE  SPACES              TO DLC-COD-ATRN IN DLC.

           MOVE  SMM-VAL-CRED IN SMM TO DLC-VAL-NDLC IN DLC.
           MOVE  SMM-VAL-SCRE IN SMM TO DLC-VAL-SDLC IN DLC.
      *
           MOVE  SPACES              TO DLC-COD-TDOC IN DLC.
           MOVE  SPACES              TO DLC-COD-PLZO IN DLC.
           MOVE  SPACES              TO DLC-MSC-TIMP IN DLC.
           MOVE  ZEROES              TO DLC-VAL-IMPU IN DLC.
           MOVE  SPACES              TO DLC-COD-NOTC IN DLC.
           MOVE  ZEROES              TO DLC-VAL-GNOT IN DLC.
           MOVE  SPACES              TO DLC-IND-SCBZ IN DLC.
           MOVE  SPACES              TO DLC-IND-SCRT IN DLC.
           MOVE  SPACES              TO DLC-COD-UBFD IN DLC.
           MOVE  SPACES              TO DLC-COD-PLZA IN DLC.
           MOVE  SPACES              TO DLC-MSC-MIPL IN DLC.
           MOVE  SPACES              TO DLC-IND-RIES IN DLC.
           MOVE  ZEROES              TO DLC-VAL-READ IN DLC.
           MOVE  ZEROES              TO DLC-VAL-INTD IN DLC.
      *
           MOVE OPC-NUM-DCOL IN OPC  TO DLC-NUM-DDEV IN DLC.
           MOVE OPC-NUM-MCOL IN OPC  TO DLC-NUM-MDEV IN DLC.
           MOVE OPC-NUM-SCOL IN OPC  TO DLC-NUM-SDEV IN DLC.
           MOVE OPC-NUM-ACOL IN OPC  TO DLC-NUM-ADEV IN DLC.

           MOVE ZEROES               TO DLC-VAL-SINT IN DLC.
           MOVE ZEROES               TO DLC-VAL-SCPA IN DLC.

           MOVE ZEROES               TO DLC-FEC-FAMT IN DLC.
           MOVE SPACES               TO DLC-KEY-IDLO IN DLC.

           MOVE ZEROES               TO DLC-NUM-IDLO IN DLC.
           MOVE ZEROES               TO DLC-VAL-IPEN IN DLC.
           MOVE ZEROES               TO DLC-VAL-DPES IN DLC.

           MOVE SMM-NUM-DMAV IN SMM  TO DLC-NUM-DMAV IN DLC.
           MOVE SMM-NUM-MMAV IN SMM  TO DLC-NUM-MMAV IN DLC.
           MOVE SMM-NUM-SMAV IN SMM  TO DLC-NUM-SMAV IN DLC.
           MOVE SMM-NUM-AMAV IN SMM  TO DLC-NUM-AMAV IN DLC.

           MOVE  ZEROES              TO DLC-NUM-VSCE IN DLC.
           MOVE  ZEROES              TO DLC-FEC-FSDE IN DLC.
           MOVE  ZEROES              TO DLC-VAL-PIMP IN DLC.
           MOVE  SPACES              TO DLC-COD-SUSP IN DLC.
           MOVE  ZEROES              TO DLC-FEC-FSDM IN DLC.
           MOVE  SPACES              TO DLC-GLS-DISP IN DLC.
      *************************
           PERFORM COL-FIO-DLC.
           IF  FIO-STAT-OKS
               ADD 1 TO SMM-NUM-GDLC IN WSS-VARI.
      *************************
       FIN-GRAB-DLC-SMM.
           EXIT.

       GRAB-VEN-SMM SECTION.
       INI-GRAB-VEN-SMM.

           MOVE SMM-CIC-IOPC IN SMM TO VEN-CIC-IOPC IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-VEN
               MOVE FIO-MOD TO FIO-CMND.

       INI-VEN-SMM.
      * Vencimientos del credito REG : VEN
      *------------------------------------
           MOVE  SPACES              TO VEN-GLS-FLAG IN VEN.

           MOVE  SMM-CIC-IOPC IN SMM TO VEN-CIC-IOPC IN VEN.
           MOVE 1                    TO VEN-NUM-IVEN IN VEN.

           MOVE HOY-STP-ITRN         TO VEN-STP-ITRN IN VEN.

           MOVE  SPACES              TO VEN-MSC-TACC IN VEN.
           MOVE  SPACES              TO VEN-MSC-STAT IN VEN.
           MOVE  SPACES              TO VEN-COD-OTRN IN VEN.
           MOVE  SPACES              TO VEN-COD-ATRN IN VEN.

           MOVE SMM-NUM-DMAV IN SMM  TO VEN-NUM-DVEN IN VEN.
           MOVE SMM-NUM-MMAV IN SMM  TO VEN-NUM-MVEN IN VEN.
           MOVE SMM-NUM-SMAV IN SMM  TO VEN-NUM-SVEN IN VEN.
           MOVE SMM-NUM-AMAV IN SMM  TO VEN-NUM-AVEN IN VEN.

           MOVE VEN-FEC-FVEN IN VEN  TO VEN-FEC-FIMV IN VEN.

           MOVE  SMM-VAL-SCRE IN SMM TO VEN-VAL-CAPI IN VEN.
           MOVE  SMM-VAL-SCRE IN SMM TO VEN-VAL-SCAP IN VEN.
           MOVE  ZEROES              TO VEN-VAL-IDNI IN VEN.
      *
           MOVE  SMM-VAL-SCRE IN SMM TO VEN-VAL-FINA IN VEN.
           MOVE  SMM-VAL-SCRE IN SMM TO VEN-VAL-SFIN IN VEN.
      *
           MOVE  SPACES              TO VEN-IND-SCTB IN VEN.
           MOVE  1                   TO VEN-NUM-IVCT IN VEN.
           MOVE  ZEROES              TO VEN-NUM-IEVC IN VEN.
           MOVE  1                   TO VEN-NUM-IDLC IN VEN.
           MOVE  SPACES              TO VEN-IND-CAUT IN VEN.
           MOVE  SPACES              TO VEN-IND-SCBZ IN VEN.
           MOVE  ZEROES              TO VEN-VAL-MTSC IN VEN.
           MOVE  SPACES              TO VEN-IND-MTSC IN VEN.
           MOVE  SPACES              TO VEN-IND-CALC IN VEN.
           MOVE  SPACES              TO VEN-IND-CTBA IN VEN.
           MOVE  SPACES              TO VEN-GLS-DISP IN VEN.
      *************************
           PERFORM COL-FIO-VEN.
           IF  FIO-STAT-OKS
               ADD 1 TO SMM-NUM-GVEN IN WSS-VARI.
      *************************
       FIN-GRAB-VEN-SMM.
           EXIT.


       GRAB-ICG-SMM SECTION.
       INI-GRAB-ICG-SMM.

           MOVE SMM-CIC-IOPC IN SMM  TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES               TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES               TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES               TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'                TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES               TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-ICG
               MOVE FIO-MOD TO FIO-CMND.

       INI-ICG-SMM.
      * Interes Comisiones Gastos REG : ICG
      * -------------------------
           MOVE  SPACES              TO ICG-GLS-FLAG IN ICG.
           MOVE  SMM-CIC-IOPC IN SMM TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES               TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES               TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES               TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'                TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES               TO ICG-FEC-FINI IN ICG.
           MOVE HOY-STP-ITRN         TO ICG-STP-ITRN IN ICG.
           MOVE  SPACES              TO ICG-MSC-TACC IN ICG.
           MOVE  SPACES              TO ICG-MSC-STAT IN ICG.
           MOVE  SPACES              TO ICG-COD-OTRN IN ICG.
           MOVE  SPACES              TO ICG-COD-ATRN IN ICG.
           MOVE  SPACES              TO ICG-COD-TINT IN ICG.
           MOVE ZEROES               TO ICG-NUM-PREP IN ICG.
           MOVE SPACES               TO ICG-MSC-UTPR IN ICG.

           MOVE  ZEROES              TO ICG-FEC-FTER IN ICG.
           MOVE  ZEROES              TO ICG-SGV-SPRD IN ICG.

           MOVE  ZEROES              TO ICG-SGV-TINT IN ICG.
           MOVE  ZEROES              TO ICG-SGV-MNTO IN ICG.
           MOVE  SPACES              TO ICG-GLS-DISP IN ICG.

      *************************
           PERFORM COL-FIO-ICG.
           IF  FIO-STAT-OKS
               ADD 1 TO SMM-NUM-GICG IN WSS-VARI.
      *************************
       FIN-GRAB-ICG-SMM.
           EXIT.


       BUS-DBC-SMM SECTION.
       INI-BUS-DBC-SMM.

           MOVE SMM-NUM-ICLI IN SMM TO DBC-NUM-ICLI IN DBC.
           MOVE SMM-VRF-ICLI IN SMM TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES              TO DBC-IND-ICLI IN DBC.
           MOVE SPACES              TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'      TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'NO EXISTE DBC RUT:' TO  SMM-COD-MENS
              MOVE SMM-RUT-ICLI IN SMM  TO  SMM-COD-MEN2
               GO TO FIN-BUS-DBC-SMM.
       FIN-BUS-DBC-SMM.
           EXIT.


       GRAB-RDC-SMM SECTION.
       INI-GRAB-RDC-SMM.
      *
           MOVE DBC-CIC-ICLI IN DBC       TO RDC-CIC-ICLI IN RDC.
           MOVE SMM-CIC-IOPC IN SMM       TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES                    TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-RDC
               MOVE FIO-MOD TO FIO-CMND.

       INI-RDC-SMM.
      * Relacion Deudor Credito  REG : RDC
      * -----------------------
           MOVE  SPACES                   TO RDC-GLS-FLAG IN RDC.
           MOVE DBC-CIC-ICLI IN DBC       TO RDC-CIC-ICLI IN RDC.
           MOVE SMM-CIC-IOPC IN SMM       TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES                    TO RDC-NUM-IDLC IN RDC.

           MOVE SPACES                    TO RDC-COD-TRDC IN RDC.
           MOVE HOY-STP-ITRN              TO RDC-STP-ITRN IN RDC.
           MOVE  ' '                      TO RDC-MSC-TACC IN RDC.
           MOVE  ' '                      TO RDC-MSC-STAT IN RDC.
           MOVE  '     '                  TO RDC-COD-OTRN IN RDC.
           MOVE  SPACES                   TO RDC-COD-ATRN IN RDC.
           MOVE  '01'                     TO RDC-NUM-DIRE IN RDC.
           MOVE  100                      TO RDC-VAL-LIMD IN RDC.
           MOVE  SPACES                   TO RDC-GLS-DISP IN RDC.
      **************************
           PERFORM COL-FIO-RDC.
           IF  FIO-STAT-OKS
               ADD 1 TO SMM-NUM-GRDC IN WSS-VARI.
      **************************
       FIN-GRAB-RDC-SMM.
           EXIT.

      ********************************************
       BCK-OUT SECTION.
      *---------------
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'BACK-OUT ERRONEO'.
       FIN-BCK-OUT.
           EXIT.

       CHK-PNT SECTION.
      *----------------
       INI-CHK-PNT.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CHECK-PNT ERRONEO'.
       FIN-CHK-PNT.
           EXIT.
      ********************************************


