      *
      * COLBUTOC
      * Version 3.0.1 Nov-2005
      * 27-Aug-19 07:38 PM
      *
       SET-TAG-COLBUTOC SECTION.
       INI-SET-TAG-COLBUTOC.
           MOVE
           '<IDNMOD NOM=$COLBUTOC$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$27-Aug-19 07:38 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBUTOC.
           EXIT.
           
       RET-ALL-TOC SECTION.
       INI-RET-ALL-TOC.
           PERFORM KEY-ALL-TOC.
           PERFORM RET-TOC-TOC.
           PERFORM RET-TIO-TOC.
       FIN-RET-ALL-TOC.
           EXIT.
       
       RET-TOC-TOC SECTION.
       INI-RET-TOC-TOC.
           MOVE TOC-MSC-STAT IN TOC-FLD TO TOC-MSC-STAT IN TOC.
           MOVE TOC-MSC-OPEC IN TOC-FLD TO TOC-MSC-OPEC IN TOC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE TOC-NUM-DTRN IN TOC-FLD TO TOC-NUM-DTRN IN TOC.
           MOVE TOC-NUM-MTRN IN TOC-FLD TO TOC-NUM-MTRN IN TOC.
           MOVE TOC-NUM-STRN IN TOC-FLD TO TOC-NUM-STRN IN TOC.
           MOVE TOC-NUM-ATRN IN TOC-FLD TO TOC-NUM-ATRN IN TOC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE TOC-MSC-TCOL IN TOC-FLD TO TOC-MSC-TCOL IN TOC.
           MOVE TOC-COD-RECU IN TOC-FLD TO TOC-COD-RECU IN TOC.
       FIN-RET-TOC-TOC.
           EXIT.
       
       RET-TIO-TOC SECTION.
       INI-RET-TIO-TOC.
           MOVE TIO-CIC-TIOP IN TOC-FLD TO TIO-CIC-TIOP IN TIO.
           MOVE TIO-EXT-CTAB IN TOC-FLD TO TIO-EXT-CTAB IN TIO.
           MOVE TIO-GLS-DESC IN TOC-FLD TO TIO-GLS-DESC IN TIO.
           MOVE TIO-GLS-DCOR IN TOC-FLD TO TIO-GLS-DCOR IN TIO.
           MOVE TIO-GLS-ABRV IN TOC-FLD TO TIO-GLS-ABRV IN TIO.
       FIN-RET-TIO-TOC.
           EXIT.
       
       KEY-ALL-TOC SECTION.
       INI-KEY-ALL-TOC.
           PERFORM KEY-TOC-TOC.
           PERFORM KEY-TIO-TOC.
       FIN-KEY-ALL-TOC.
           EXIT.
       
       KEY-TOC-TOC SECTION.
       INI-KEY-TOC-TOC.
           MOVE TOC-COD-TOCR IN TOC-FLD TO TOC-COD-TOCR IN TOC.
       FIN-KEY-TOC-TOC.
           EXIT.
       
       KEY-TIO-TOC SECTION.
       INI-KEY-TIO-TOC.
       FIN-KEY-TIO-TOC.
           EXIT.
       
       SCR-CLRA-TOC SECTION.
       INI-SCR-CLRA-TOC.
           PERFORM CLR-KEY-TOC.
           PERFORM CLR-FLD-TOC.
       FIN-SCR-CLRA-TOC.
           EXIT.
       
       CLR-KEY-TOC SECTION.
       INI-CLR-KEY-TOC.
           MOVE SPACES TO TOC-COD-TOCR IN TOC-FLD.
       FIN-CLR-KEY-TOC.
           EXIT.
       
       CLR-FLD-TOC SECTION.
       INI-CLR-FLD-TOC.
           MOVE SPACES TO FRM-GLS-OPEC IN TOC-FLD.
           MOVE SPACES TO FRM-GLS-TCOL IN TOC-FLD.
           MOVE SPACES TO FRM-GLS-RECU IN TOC-FLD.
           PERFORM CLR-TOC-TOC.
           PERFORM CLR-TIO-TOC.
       FIN-CLR-FLD-TOC.
           EXIT.
       
       CLR-TOC-TOC SECTION.
       INI-CLR-TOC-TOC.
           MOVE SPACES TO TOC-MSC-STAT IN TOC-FLD.
           MOVE SPACES TO TOC-MSC-OPEC IN TOC-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO TOC-FEC-FTRN IN TOC-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO TOC-MSC-TCOL IN TOC-FLD.
           MOVE SPACES TO TOC-COD-RECU IN TOC-FLD.
      *<<<<
           MOVE SPACES TO TOC-FEC-FTRN IN TOC-FLD.
      *>>>>
       FIN-CLR-TOC-TOC.
           EXIT.
       
       CLR-TIO-TOC SECTION.
       INI-CLR-TIO-TOC.
           MOVE SPACES TO TIO-CIC-TIOP IN TOC-FLD.
           MOVE SPACES TO TIO-EXT-CTAB IN TOC-FLD.
           MOVE SPACES TO TIO-GLS-DESC IN TOC-FLD.
           MOVE SPACES TO TIO-GLS-DCOR IN TOC-FLD.
           MOVE SPACES TO TIO-GLS-ABRV IN TOC-FLD.
       FIN-CLR-TIO-TOC.
           EXIT.
       
       FST-KEY-TOC SECTION.
       INI-FST-KEY-TOC.
           MOVE -1 TO TOC-COD-TOCR-LEN IN TOC-FLD.
       FIN-FST-KEY-TOC.
           EXIT.
       
       FST-FLD-TOC SECTION.
       INI-FST-FLD-TOC.
           MOVE -1 TO TOC-MSC-STAT-LEN IN TOC-FLD.
       FIN-FST-FLD-TOC.
           EXIT.
       
       PRO-KEY-TOC SECTION.
       INI-PRO-KEY-TOC.
           PERFORM PRO-MKY-TOC.
       FIN-PRO-KEY-TOC.
           EXIT.
       
       PRO-MKY-TOC SECTION.
       INI-PRO-MKY-TOC.
       FIN-PRO-MKY-TOC.
           EXIT.
       
       PRO-FLD-TOC SECTION.
       INI-PRO-FLD-TOC.
           PERFORM PRO-TOC-TOC.
           PERFORM PRO-TIO-TOC.
       FIN-PRO-FLD-TOC.
           EXIT.
       
       PRO-TOC-TOC SECTION.
       INI-PRO-TOC-TOC.
           MOVE FRM-CPIM-AEY TO TOC-MSC-STAT-ATR IN TOC-FLD.
           MOVE FRM-CPIM-AEY TO TOC-MSC-OPEC-ATR IN TOC-FLD.
           MOVE FRM-CPIM-AEY TO TOC-MSC-TCOL-ATR IN TOC-FLD.
           MOVE FRM-CPIM-AEY TO TOC-COD-RECU-ATR IN TOC-FLD.
       FIN-PRO-TOC-TOC.
           EXIT.
       
       PRO-TIO-TOC SECTION.
       INI-PRO-TIO-TOC.
       FIN-PRO-TIO-TOC.
           EXIT.
       
       UNP-KEY-TOC SECTION.
       INI-UNP-KEY-TOC.
           PERFORM UNP-IKY-TOC.
           PERFORM UNP-AKY-TOC.
           PERFORM UNP-MKY-TOC.
       FIN-UNP-KEY-TOC.
           EXIT.
       
       UNP-IKY-TOC SECTION.
       INI-UNP-IKY-TOC.
           MOVE FRM-CPIM-UBY TO TOC-COD-TOCR-ATR.
       FIN-UNP-IKY-TOC.
           EXIT.
       
       UNP-MKY-TOC SECTION.
       INI-UNP-MKY-TOC.
       FIN-UNP-MKY-TOC.
           EXIT.
       
       UNP-AKY-TOC SECTION.
       INI-UNP-AKY-TOC.
       FIN-UNP-AKY-TOC.
           EXIT.
       
       UNP-FLD-TOC SECTION.
       INI-UNP-FLD-TOC.
           PERFORM UNP-TOC-TOC.
           PERFORM UNP-TIO-TOC.
       FIN-UNP-FLD-TOC.
           EXIT.
       
       UNP-TOC-TOC SECTION.
       INI-UNP-TOC-TOC.
           MOVE FRM-CPIM-UBY TO TOC-MSC-STAT-ATR IN TOC-FLD.
           MOVE FRM-CPIM-UBY TO TOC-MSC-OPEC-ATR IN TOC-FLD.
           MOVE FRM-CPIM-UBY TO TOC-MSC-TCOL-ATR IN TOC-FLD.
           MOVE FRM-CPIM-UBY TO TOC-COD-RECU-ATR IN TOC-FLD.
       FIN-UNP-TOC-TOC.
           EXIT.
       
       UNP-TIO-TOC SECTION.
       INI-UNP-TIO-TOC.
       FIN-UNP-TIO-TOC.
           EXIT.
       
       VAL-MKY-TOC SECTION.
       INI-VAL-MKY-TOC.
       FIN-VAL-MKY-TOC.
           EXIT.
       
       VAL-FLD-TOC SECTION.
       INI-VAL-FLD-TOC.
           PERFORM VAL-TIO-CIC-TIOP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TIO-CIC-TIOP-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-TIO-EXT-CTAB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TIO-EXT-CTAB-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-TIO-GLS-DESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TIO-GLS-DESC-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-TIO-GLS-DCOR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TIO-GLS-DCOR-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-TIO-GLS-ABRV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TIO-GLS-ABRV-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-TOC-MSC-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TOC-MSC-STAT-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-TOC-MSC-OPEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TOC-MSC-OPEC-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-TOC-FEC-FTRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                TOC-FEC-FTRN-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-OPEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OPEC-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-TOC-MSC-TCOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TOC-MSC-TCOL-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-TOC-COD-RECU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TOC-COD-RECU-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-FRM-GLS-TCOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TCOL-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
           PERFORM VAL-FRM-GLS-RECU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RECU-LEN IN TOC-FLD
                GO TO FIN-VAL-FLD-TOC.
       FIN-VAL-FLD-TOC.
           EXIT.
       
       VAL-TIO-CIC-TIOP SECTION.
       INI-VAL-TIO-CIC-TIOP.
       FIN-VAL-TIO-CIC-TIOP.
           EXIT.
       
       VAL-TIO-EXT-CTAB SECTION.
       INI-VAL-TIO-EXT-CTAB.
       FIN-VAL-TIO-EXT-CTAB.
           EXIT.
       
       VAL-TIO-GLS-DESC SECTION.
       INI-VAL-TIO-GLS-DESC.
       FIN-VAL-TIO-GLS-DESC.
           EXIT.
       
       VAL-TIO-GLS-DCOR SECTION.
       INI-VAL-TIO-GLS-DCOR.
       FIN-VAL-TIO-GLS-DCOR.
           EXIT.
       
       VAL-TIO-GLS-ABRV SECTION.
       INI-VAL-TIO-GLS-ABRV.
       FIN-VAL-TIO-GLS-ABRV.
           EXIT.
       
       VAL-TOC-MSC-STAT SECTION.
       INI-VAL-TOC-MSC-STAT.
           IF TOC-MSC-STAT IN TOC-FLD NOT > SPACES
              MOVE SPACES TO TOC-MSC-STAT IN TOC-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'GNS' TO MSC-COD-SIST.
           MOVE 'VIGE' TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-STAT IN TOC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-TOC-MSC-STAT.
           EXIT.
       
       VAL-TOC-MSC-OPEC SECTION.
       INI-VAL-TOC-MSC-OPEC.
           IF TOC-MSC-OPEC IN TOC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-TOC-MSC-OPEC.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'OPEC' TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              TOC-MSC-OPEC IN TOC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-OPEC IN TOC-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-OPEC IN TOC-FLD.
       FIN-VAL-TOC-MSC-OPEC.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-TOC-FEC-FTRN SECTION.
       INI-VAL-TOC-FEC-FTRN.
           IF TOC-FEC-FTRN IN TOC-FLD  NOT > ZEROES
              MOVE ZEROES TO TOC-FEC-FTRN IN TOC-FLD.
       FIN-VAL-TOC-FEC-FTRN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-OPEC SECTION.
       INI-VAL-FRM-GLS-OPEC.
       FIN-VAL-FRM-GLS-OPEC.
           EXIT.
       
       VAL-TOC-MSC-TCOL SECTION.
       INI-VAL-TOC-MSC-TCOL.
           IF TOC-MSC-TCOL IN TOC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-TOC-MSC-TCOL.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'TCOL' TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-TCOL IN TOC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              TOC-MSC-TCOL IN TOC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TCOL IN TOC-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TCOL IN TOC-FLD.
       FIN-VAL-TOC-MSC-TCOL.
           EXIT.
       
       VAL-TOC-COD-RECU SECTION.
       INI-VAL-TOC-COD-RECU.
           IF TOC-COD-RECU IN TOC-FLD NOT > SPACES
              MOVE SPACES TO TOC-COD-RECU IN TOC-FLD.
      *<<<<
      *VAL-COD Valida codigo de tabla
           IF TOC-COD-RECU IN TOC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-RECU IN TOC-FLD
               GO TO FIN-VAL-TOC-COD-RECU.
           MOVE TOC-COD-RECU IN TOC-FLD TO WSS-COD-TABL.
           IF WSS-COD-TTAB = 'BCO'
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'BCO' TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-CTAB TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX' AND
                  TAB-CIC-CTAB IN TAB = '018' OR '012'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-RECU IN TOC-FLD
               ELSE
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'COD    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'IVB' TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-CTAB TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX' AND
                  TAB-CIC-CTAB IN TAB = '001'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-RECU IN TOC-FLD
               ELSE
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'COD    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-TOC-COD-RECU.
           EXIT.
       
       VAL-FRM-GLS-TCOL SECTION.
       INI-VAL-FRM-GLS-TCOL.
       FIN-VAL-FRM-GLS-TCOL.
           EXIT.
       
       VAL-FRM-GLS-RECU SECTION.
       INI-VAL-FRM-GLS-RECU.
       FIN-VAL-FRM-GLS-RECU.
           EXIT.
       
       VAL-CON-FLD-TOC SECTION.
       INI-VAL-CON-FLD-TOC.
       FIN-VAL-CON-FLD-TOC.
           EXIT.
       
       VAL-CON-TOC SECTION.
       INI-VAL-CON-TOC.
       FIN-VAL-CON-TOC.
           EXIT.
       
       VAL-NUM-KEY-TOC SECTION.
       INI-VAL-NUM-KEY-TOC.
           PERFORM VAL-NUM-IKY-TOC.
           PERFORM VAL-NUM-MKY-TOC.
           PERFORM VAL-NUM-AKY-TOC.
       FIN-VAL-NUM-KEY-TOC.
           EXIT.
       
       VAL-NUM-IKY-TOC SECTION.
       INI-VAL-NUM-IKY-TOC.
       FIN-VAL-NUM-IKY-TOC.
           EXIT.
       
       VAL-NUM-MKY-TOC SECTION.
       INI-VAL-NUM-MKY-TOC.
       FIN-VAL-NUM-MKY-TOC.
           EXIT.
       
       VAL-NUM-AKY-TOC SECTION.
       INI-VAL-NUM-AKY-TOC.
       FIN-VAL-NUM-AKY-TOC.
           EXIT.
       
       VAL-NUM-FLD-TOC SECTION.
       INI-VAL-NUM-FLD-TOC.
       FIN-VAL-NUM-FLD-TOC.
           EXIT.
       
       EDT-KEY-TOC SECTION.
       INI-EDT-KEY-TOC.
           PERFORM EDT-IKY-TOC.
           PERFORM EDT-MKY-TOC.
           PERFORM EDT-AKY-TOC.
       FIN-EDT-KEY-TOC.
           EXIT.
       
       EDT-IKY-TOC SECTION.
       INI-EDT-IKY-TOC.
       FIN-EDT-IKY-TOC.
           EXIT.
       
       EDT-MKY-TOC SECTION.
       INI-EDT-MKY-TOC.
       FIN-EDT-MKY-TOC.
           EXIT.
       
       EDT-AKY-TOC SECTION.
       INI-EDT-AKY-TOC.
       FIN-EDT-AKY-TOC.
           EXIT.
       
       EDT-FLD-TOC SECTION.
       INI-EDT-FLD-TOC.
       FIN-EDT-FLD-TOC.
           EXIT.
