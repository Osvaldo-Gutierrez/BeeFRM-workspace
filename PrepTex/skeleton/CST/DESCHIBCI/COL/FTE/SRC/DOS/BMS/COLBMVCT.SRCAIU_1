      * 11-Feb-94 06:24 PM
       PUT-ALL-VCT SECTION.
       INI-PUT-ALL-VCT.
           PERFORM PUT-VCT-VCT.
       FIN-PUT-ALL-VCT.
           EXIT.

       PUT-VCT-VCT SECTION.
       INI-PUT-VCT-VCT.
           IF PGM-STAT-VCT-NUL
               GO TO FIN-PUT-VCT-VCT.
           IF NOT PGM-STAT-VCT-OKS
               PERFORM CLR-VCT-VCT
               GO TO FIN-PUT-VCT-VCT.
           MOVE VCT-FD-VTO IN VCT TO VCT-FD-VTO IN VCT-FLD.
           MOVE VCT-FM-VTO IN VCT TO VCT-FM-VTO IN VCT-FLD.
           MOVE VCT-FA-VTO IN VCT TO VCT-FA-VTO IN VCT-FLD.
           MOVE VCT-COD-OFI IN VCT TO VCT-COD-OFI IN VCT-FLD.
           MOVE VCT-COD-EJE IN VCT TO VCT-COD-EJE IN VCT-FLD.
      *BUS-OFI busca oficina en tablas
           IF VCT-COD-OFI IN VCT-FLD > SPACES
               MOVE VCT-COD-OFI IN VCT-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN VCT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFI IN VCT-FLD.
       FIN-PUT-VCT-VCT.
           EXIT.
      * 11-Feb-94 06:24 PM
       RET-ALL-VCT SECTION.
       INI-RET-ALL-VCT.
           PERFORM KEY-ALL-VCT.
           PERFORM RET-VCT-VCT.
       FIN-RET-ALL-VCT.
           EXIT.

       RET-VCT-VCT SECTION.
       INI-RET-VCT-VCT.
       FIN-RET-VCT-VCT.
           EXIT.

       KEY-ALL-VCT SECTION.
       INI-KEY-ALL-VCT.
           PERFORM KEY-VCT-VCT.
       FIN-KEY-ALL-VCT.
           EXIT.

       KEY-VCT-VCT SECTION.
       INI-KEY-VCT-VCT.
           MOVE VCT-FD-VTO IN VCT-FLD TO VCT-FD-VTO IN VCT.
           MOVE VCT-FM-VTO IN VCT-FLD TO VCT-FM-VTO IN VCT.
           MOVE VCT-FA-VTO IN VCT-FLD TO VCT-FA-VTO IN VCT.
           MOVE VCT-COD-OFI IN VCT-FLD TO VCT-COD-OFI IN VCT.
           MOVE VCT-COD-EJE IN VCT-FLD TO VCT-COD-EJE IN VCT.
       FIN-KEY-VCT-VCT.
           EXIT.

       SCR-CLRA-VCT SECTION.
       INI-SCR-CLRA-VCT.
           PERFORM CLR-KEY-VCT.
           PERFORM CLR-FLD-VCT.
       FIN-SCR-CLRA-VCT.
           EXIT.

       CLR-KEY-VCT SECTION.
       INI-CLR-KEY-VCT.
           MOVE SPACES TO VCT-FEC-VTO IN VCT-FLD.
           MOVE ZEROES TO VCT-COD-OFI IN VCT-FLD.
           MOVE SPACES TO VCT-COD-EJE IN VCT-FLD.
       FIN-CLR-KEY-VCT.
           EXIT.

       CLR-FLD-VCT SECTION.
       INI-CLR-FLD-VCT.
           MOVE SPACES TO FRM-GLS-OFI IN VCT-FLD.
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(1).
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(2).
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(3).
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(4).
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(5).
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(6).
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(7).
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(8).
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(9).
           MOVE SPACES TO FRM-LIN-DET IN VCT-FLD(10).
           MOVE SPACES TO FRM-GLS-TOTA IN VCT-FLD.
           PERFORM CLR-VCT-VCT.
       FIN-CLR-FLD-VCT.
           EXIT.

       CLR-VCT-VCT SECTION.
       INI-CLR-VCT-VCT.
       FIN-CLR-VCT-VCT.
           EXIT.

       FST-KEY-VCT SECTION.
       INI-FST-KEY-VCT.
           MOVE -1 TO VCT-FEC-VTO-LEN IN VCT-FLD.
       FIN-FST-KEY-VCT.
           EXIT.

       FST-FLD-VCT SECTION.
       INI-FST-FLD-VCT.
       FIN-FST-FLD-VCT.
           EXIT.

       PRO-KEY-VCT SECTION.
       INI-PRO-KEY-VCT.
           PERFORM PRO-IKY-VCT.
           PERFORM PRO-AKY-VCT.
           PERFORM PRO-MKY-VCT.
      *<<<
           PERFORM PON-TOT-FRM.
      *>>>
       FIN-PRO-KEY-VCT.
           EXIT.

       PRO-IKY-VCT SECTION.
       INI-PRO-IKY-VCT.
           MOVE FRM-CPIM-AEY TO VCT-FEC-VTO-ATR IN VCT-FLD.
           MOVE FRM-CPIM-AEY TO VCT-COD-OFI-ATR IN VCT-FLD.
           MOVE FRM-CPIM-AEY TO VCT-COD-EJE-ATR IN VCT-FLD.
       FIN-PRO-IKY-VCT.
           EXIT.

       PRO-MKY-VCT SECTION.
       INI-PRO-MKY-VCT.
       FIN-PRO-MKY-VCT.
           EXIT.

       PRO-AKY-VCT SECTION.
       INI-PRO-AKY-VCT.
       FIN-PRO-AKY-VCT.
           EXIT.

       PRO-FLD-VCT SECTION.
       INI-PRO-FLD-VCT.
           PERFORM PRO-VCT-VCT.
       FIN-PRO-FLD-VCT.
           EXIT.

       PRO-VCT-VCT SECTION.
       INI-PRO-VCT-VCT.
       FIN-PRO-VCT-VCT.
           EXIT.

       UNP-KEY-VCT SECTION.
       INI-UNP-KEY-VCT.
           PERFORM UNP-IKY-VCT.
           PERFORM UNP-AKY-VCT.
           PERFORM UNP-MKY-VCT.
       FIN-UNP-KEY-VCT.
           EXIT.

       UNP-IKY-VCT SECTION.
       INI-UNP-IKY-VCT.
           MOVE FRM-CPIM-UBY TO VCT-FEC-VTO-ATR.
           MOVE FRM-CPIM-UBY TO VCT-COD-OFI-ATR.
           MOVE FRM-CPIM-UBY TO VCT-COD-EJE-ATR.
       FIN-UNP-IKY-VCT.
           EXIT.

       UNP-MKY-VCT SECTION.
       INI-UNP-MKY-VCT.
       FIN-UNP-MKY-VCT.
           EXIT.

       UNP-AKY-VCT SECTION.
       INI-UNP-AKY-VCT.
       FIN-UNP-AKY-VCT.
           EXIT.

       UNP-FLD-VCT SECTION.
       INI-UNP-FLD-VCT.
           PERFORM UNP-VCT-VCT.
       FIN-UNP-FLD-VCT.
           EXIT.

       UNP-VCT-VCT SECTION.
       INI-UNP-VCT-VCT.
       FIN-UNP-VCT-VCT.
           EXIT.

       VAL-KEY-VCT SECTION.
       INI-VAL-KEY-VCT.
           PERFORM VAL-IKY-VCT.
           PERFORM VAL-MKY-VCT.
           PERFORM VAL-AKY-VCT.
       FIN-VAL-KEY-VCT.
           EXIT.

       VAL-IKY-VCT SECTION.
       INI-VAL-IKY-VCT.
           PERFORM VAL-VCT-FEC-VTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VCT-FEC-VTO-LEN IN VCT-FLD
                GO TO FIN-VAL-IKY-VCT.
           PERFORM VAL-VCT-COD-OFI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VCT-COD-OFI-LEN IN VCT-FLD
                GO TO FIN-VAL-IKY-VCT.
           PERFORM VAL-VCT-COD-EJE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO VCT-COD-EJE-LEN IN VCT-FLD
                GO TO FIN-VAL-IKY-VCT.
       FIN-VAL-IKY-VCT.
           EXIT.

       VAL-MKY-VCT SECTION.
       INI-VAL-MKY-VCT.
       FIN-VAL-MKY-VCT.
           EXIT.

       VAL-AKY-VCT SECTION.
       INI-VAL-AKY-VCT.
       FIN-VAL-AKY-VCT.
           EXIT.

       VAL-FLD-VCT SECTION.
       INI-VAL-FLD-VCT.
           PERFORM VAL-FRM-GLS-OFI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFI-LEN IN VCT-FLD
                GO TO FIN-VAL-FLD-VCT.
           PERFORM VAL-FRM-LIN-DET
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 10
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-LIN-DET-LEN IN VCT-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-VCT.
           PERFORM VAL-FRM-GLS-TOTA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TOTA-LEN IN VCT-FLD
                GO TO FIN-VAL-FLD-VCT.
       FIN-VAL-FLD-VCT.
           EXIT.

       VAL-VCT-FEC-VTO SECTION.
       INI-VAL-VCT-FEC-VTO.
      *VAL-FEC Validar Fecha
           MOVE VCT-FEC-VTO IN VCT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<<
           MOVE FEC-CHOY-N  TO FEC-CHOY
           MOVE FEC-VHBL-N  TO FEC-VHBL
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO VCT-FEC-VTO IN VCT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-VCT-FEC-VTO.
       FIN-VAL-VCT-FEC-VTO.
           EXIT.

       VAL-VCT-COD-OFI SECTION.
       INI-VAL-VCT-COD-OFI.
           IF VCT-COD-OFI IN VCT-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-VCT-COD-OFI.
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE VCT-COD-OFI IN VCT-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFI IN VCT-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN VCT-FLD.
       FIN-VAL-VCT-COD-OFI.
           EXIT.

       VAL-FRM-GLS-OFI SECTION.
       INI-VAL-FRM-GLS-OFI.
       FIN-VAL-FRM-GLS-OFI.
           EXIT.

       VAL-VCT-COD-EJE SECTION.
       INI-VAL-VCT-COD-EJE.
           IF VCT-COD-EJE IN VCT-FLD NOT > SPACES
              MOVE SPACES TO VCT-COD-EJE IN VCT-FLD.
       FIN-VAL-VCT-COD-EJE.
           EXIT.

       VAL-FRM-LIN-DET SECTION.
       INI-VAL-FRM-LIN-DET.
       FIN-VAL-FRM-LIN-DET.
           EXIT.

       VAL-FRM-GLS-TOTA SECTION.
       INI-VAL-FRM-GLS-TOTA.
       FIN-VAL-FRM-GLS-TOTA.
           EXIT.

       VAL-CON-KEY-VCT SECTION.
       INI-VAL-CON-KEY-VCT.
           IF     VCT-FEC-VTO IN VCT-FLD NOT > SPACES
              AND VCT-FD-VTO IN VCT-FLD NOT > SPACES
              AND VCT-FM-VTO IN VCT-FLD NOT > SPACES
              AND VCT-FA-VTO IN VCT-FLD NOT > SPACES
              AND VCT-COD-OFI IN VCT-FLD NOT > ZEROES
              AND VCT-COD-EJE IN VCT-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-VCT.
       FIN-VAL-CON-KEY-VCT.
           EXIT.

       VAL-CON-IKY-VCT SECTION.
       INI-VAL-CON-IKY-VCT.
           IF     VCT-FEC-VTO IN VCT-FLD NOT > SPACES
              AND VCT-COD-OFI IN VCT-FLD NOT > ZEROES
              AND VCT-COD-EJE IN VCT-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-VCT.
       FIN-VAL-CON-IKY-VCT.
           EXIT.

       VAL-CON-FLD-VCT SECTION.
       INI-VAL-CON-FLD-VCT.
       FIN-VAL-CON-FLD-VCT.
           EXIT.

       VAL-CON-VCT SECTION.
       INI-VAL-CON-VCT.
       FIN-VAL-CON-VCT.
           EXIT.

       VAL-NUM-KEY-VCT SECTION.
       INI-VAL-NUM-KEY-VCT.
           PERFORM VAL-NUM-IKY-VCT.
           PERFORM VAL-NUM-MKY-VCT.
           PERFORM VAL-NUM-AKY-VCT.
       FIN-VAL-NUM-KEY-VCT.
           EXIT.

       VAL-NUM-IKY-VCT SECTION.
       INI-VAL-NUM-IKY-VCT.
       VAL-NUM-VCT-COD-OFI.
           MOVE VCT-COD-OFI-ALF IN VCT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO VCT-COD-OFI IN VCT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO VCT-COD-OFI-LEN IN VCT-FLD
                GO TO FIN-VAL-NUM-IKY-VCT.
       FIN-VAL-NUM-IKY-VCT.
           EXIT.

       VAL-NUM-MKY-VCT SECTION.
       INI-VAL-NUM-MKY-VCT.
       FIN-VAL-NUM-MKY-VCT.
           EXIT.

       VAL-NUM-AKY-VCT SECTION.
       INI-VAL-NUM-AKY-VCT.
       FIN-VAL-NUM-AKY-VCT.
           EXIT.

       VAL-NUM-FLD-VCT SECTION.
       INI-VAL-NUM-FLD-VCT.
       FIN-VAL-NUM-FLD-VCT.
           EXIT.

       EDT-KEY-VCT SECTION.
       INI-EDT-KEY-VCT.
           PERFORM EDT-IKY-VCT.
           PERFORM EDT-MKY-VCT.
           PERFORM EDT-AKY-VCT.
       FIN-EDT-KEY-VCT.
           EXIT.

       EDT-IKY-VCT SECTION.
       INI-EDT-IKY-VCT.
           IF VCT-COD-OFI-LEN IN VCT-FLD = -9
                MOVE -1 TO VCT-COD-OFI-LEN IN VCT-FLD
                GO TO FIN-EDT-IKY-VCT.
           MOVE VCT-COD-OFI IN VCT-FLD TO VCT-COD-OFI-EDT IN VCT-EDT.
           MOVE VCT-COD-OFI-EDT IN VCT-EDT TO
                VCT-COD-OFI-ALF IN VCT-FLD.
       FIN-EDT-IKY-VCT.
           EXIT.

       EDT-MKY-VCT SECTION.
       INI-EDT-MKY-VCT.
       FIN-EDT-MKY-VCT.
           EXIT.

       EDT-AKY-VCT SECTION.
       INI-EDT-AKY-VCT.
       FIN-EDT-AKY-VCT.
           EXIT.

       EDT-FLD-VCT SECTION.
       INI-EDT-FLD-VCT.
       FIN-EDT-FLD-VCT.
           EXIT.
