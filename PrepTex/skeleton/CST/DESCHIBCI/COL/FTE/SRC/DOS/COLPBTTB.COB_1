       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. COLPBTTB.
       AUTHOR.     CONSIST.
      * TRASPASA TABLAS EN FORMA BACH.
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *------------------------
       COPY GNSBRTAB.
       COPY GNSWVFIO.
       COPY GNSWCFIO.
       COPY GNSWGIFD.
       COPY GNSWGHOY.
       COPY GNSWGSYS.
       COPY GNSWGRQA.
       COPY GNSWGELS.
       COPY GNSWGUIB.
       COPY GNSBRMSG.
       COPY GNSBRERR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  ADR-MVS-REQA==.
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  ADR-TBL-REQA==.
       01  WSS-VARI.
           03  WSS-NUM-DBIN                     PIC 9(03).
           03  WSS-NUM-DBOU                     PIC 9(03).
           03  WSS-COD-TTAB                     PIC X(03).
           03  WSS-TAB                          PIC X(194).
       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       COPY GNSBGEDB.
       INI-MAIN.
           PERFORM INI.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(1).
           MOVE 'GNS' TO FIO-SIST.
           MOVE 'MVS' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-INI-MAIN.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               GO TO FIN-MAIN.
           IF TAB-COD-TTAB IN TAB NOT = 'MVS'
               MOVE 'NO+TABLAS' TO ERR-COD-MENS IN ERR
               PERFORM PRO-ERR
               GO TO FIN-MAIN.
           MOVE ADR-TAB-REQA TO ADR-MVS-REQA.
           IF TAB-COD-CTAB IN TAB NOT > SPACES
               GO TO LUP-INI-MAIN.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-TTAB IN WSS-VARI.
           PERFORM UPD-TOUT.
           MOVE ADR-MVS-REQA TO ADR-TAB-REQA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           GO TO LUP-INI-MAIN.
       FIN-MAIN.
           PERFORM CLO-FIL.
           GOBACK.
       UPD-TOUT SECTION.
       INI-UPD-TOUT.
           MOVE TAB-COD-CTAB IN TAB TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-UPD-TOUT.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS OR
              TAB-COD-TTAB IN TAB = WSS-COD-TTAB IN WSS-VARI )
               GO TO FIN-UPD-TOUT.
           MOVE ADR-TAB-REQA TO ADR-TBL-REQA.
           MOVE TAB TO WSS-TAB IN WSS-VARI.
           PERFORM OUT-TABLA.
           MOVE ADR-TBL-REQA TO ADR-TAB-REQA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           GO TO LUP-UPD-TOUT.
       FIN-UPD-TOUT.
           EXIT.
       INI SECTION.
       INI-INI.
           ACCEPT WSS-NUM-DBIN.
           DISPLAY 'NUMERO BASE DATOS ENTRADA'.
           ACCEPT WSS-NUM-DBOU.
           DISPLAY 'NUMERO BASE DATOS SALIDA'.
           MOVE WSS-NUM-DBIN TO IFD-GSIS(1).
           MOVE 'GNS' TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               PERFORM PRG-ABT.
           MOVE WSS-NUM-DBOU TO IFD-GSIS(1).
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               PERFORM PRG-ABT.
       FIN-INI.
           EXIT.
       OUT-TABLA.
       INI-OUT-TABLA.
           MOVE 'GNS' TO FIO-SIST.
           MOVE WSS-NUM-DBOU IN WSS-VARI TO IFD-GSIS(1).
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               PERFORM PRG-ABT.
           MOVE WSS-TAB IN WSS-VARI TO TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GNS-FIO-TAB
           ELSE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GNS-FIO-TAB.
           MOVE 'GNS' TO FIO-SIST.
           MOVE WSS-NUM-DBIN IN WSS-VARI TO IFD-GSIS(1).
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-ERR
               PERFORM PRG-ABT.
       FIN-OUT-TABLA.
           EXIT.
       CLO-FIL SECTION.
       INI-CLO-FIL.
           MOVE WSS-NUM-DBIN TO IFD-GSIS(1).
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE WSS-NUM-DBOU TO IFD-GSIS(1).
           PERFORM GNS-FIO-TAB.
       FIN-CLO-FIL.
           EXIT.
       COPY GNSBFTAB.
       COPY GNSBBMSG.
       COPY GNSBFMSG.
       COPY GNSBGERR.
       COPY GNSBGDTC.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGIFD.
       COPY GNSBGHOY.
