       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. COLPPSC1.
       AUTHOR. ADA.
       DATE-WRITTEN. 1-SEP-1999 15:26:36
      *
      * PROGRAMA QUE INGRESA, CONSULTA O ELIMINA UN REGISTRO
      * DETERMINADO DEL ARCHIVO DE SELECCION DE CERTIFICADOS
      *
       ENVIRONMENT DIVISION.
       DATA DIVISION.

       WORKING-STORAGE SECTION.
      *========================
       COPY GNSWGHOY.
       COPY GNSWGSYS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY COLBRSCO.
       01  WSS-VARI.
           03  WSS-CMMA.
               05 WSS-CMND                  PIC X(03).
               05 WSS-RSCO                  PIC X(92).
               05 WSS-SIST                  PIC X(03).
               05 WSS-CMSG.
                  07 WSS-TMSG               PIC X(07).
                  07 WSS-XMSG               PIC X(05).
               05 WSS-MENS                  PIC X(40).
      *
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                     PIC X(150).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           MOVE DFHCOMMAREA(1:EIBCALEN) TO WSS-CMMA IN WSS-VARI.
           PERFORM GNS-HDL-VSM.
           MOVE SPACES TO WSS-SIST WSS-CMSG WSS-MENS.
           IF WSS-CMND = 'ING'
               PERFORM PRO-ING
           ELSE
           IF WSS-CMND = 'ELI'
               PERFORM PRO-ELI
           ELSE
               PERFORM PRO-CON.

           MOVE WSS-CMMA IN WSS-VARI TO DFHCOMMAREA.
           MOVE +0 TO EIBRESP.
       FIN-MAIN.
       COPY GNSBGGBK.
       EXT-MAIN.
           EXIT.

       PRO-ING SECTION.
       INI-PRO-ING.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               MOVE 'GNS'    TO WSS-SIST
               MOVE 'REGEXI' TO WSS-CMSG
               GO TO FIN-PRO-ING.

           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO SCO-STP-ITRN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-SCO.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'     TO WSS-SIST
               MOVE 'FIOSTAT' TO WSS-TMSG
               MOVE FIO-STAT  TO WSS-XMSG.
       FIN-PRO-ING.
           EXIT.

       PRO-ELI SECTION.
       INI-PRO-ELI.
           PERFORM FND-KEY.
           IF NOT FIO-STAT-OKS
               GO TO ERR-PRO-ELI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-SCO.
           IF NOT FIO-STAT-OKS
               GO TO ERR-PRO-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-SCO.
           IF FIO-STAT-OKS
               GO TO FIN-PRO-ELI.
       ERR-PRO-ELI.
           MOVE 'GNS'     TO WSS-SIST.
           MOVE 'FIOSTAT' TO WSS-TMSG.
           MOVE FIO-STAT  TO WSS-XMSG.
       FIN-PRO-ELI.
           EXIT.

       PRO-CON SECTION.
       INI-PRO-CON.
           PERFORM FND-KEY.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'     TO WSS-SIST
               MOVE 'FIOSTAT' TO WSS-TMSG
               MOVE FIO-STAT  TO WSS-XMSG
           ELSE
               MOVE SCO TO WSS-RSCO.
       FIN-PRO-CON.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
           MOVE WSS-RSCO    TO SCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-SCO.
       FIN-FND-KEY.
           EXIT.

       COPY GNSBGHOY.
       COPY GNSBHVSM.
       COPY GNSBGVSM.
       COPY GNSBGSYS.
       COPY GNSBIABT.
       COPY COLBFSCO.
