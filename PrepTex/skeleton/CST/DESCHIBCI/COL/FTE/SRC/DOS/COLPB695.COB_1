       IDENTIFICATION DIVISION.
      *************************
       PROGRAM-ID.     COLPB695.
      *AUTHOR.         DONOSO JARA OSVALDO.
      *                DATE-WRITTEN,  20/11/91.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 30 DE MARZO DE 1998                                    *
      ******************************************************************
      ******************************************************************
      *  Sistema  : Colocaciones                                       *
      *  Subsist. :                                                    *
      *  Analista : Donoso Jara Osvaldo                                *
      *  Objetivo : Actualizacion de operaciones en el sistema de      *
      *             creditos desde el sistema de colocaciones          *
      *  Archivos :                                                    *
      *   Entrada : OPC 160: Operaciones del sistema colocaciones      *
      *             DLC 160: Documentos legales credito                *
      *             DCC 210: Tabla con cod operacion antigua           *
      *                                                                *
      *   SALIDA  : COLL695: LISTADO                                   *
      *                                                                *
      *   ENT/SAL : CREM002: Maestro de creditos                       *
      *                                                                *
      *  Mantenciones                                                  *
      *  ============                                                  *
      *            Programador: Osvaldo Donoso Jara........            *
      *            Fecha      : 29/11/91                               *
      *            Cambio     : Para creditos con situacion            *
      *                         contable 'mul' en DLC se asume         *
      *                         espacios                               *
      *                                                                *
      ******************************************************************
           EJECT
       ENVIRONMENT DIVISION.
      **********************
       CONFIGURATION SECTION.
      *======================
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
           EJECT
       INPUT-OUTPUT SECTION.
      *=====================
       FILE-CONTROL.
           SELECT CREM002 ASSIGN       TO CREM002
                  ORGANIZATION         IS INDEXED
                  ACCESS               IS DYNAMIC
                  RECORD KEY           IS CRE-CLAVE
                  FILE STATUS          IS WR-FS-CREM002.

           SELECT COLVTAR ASSIGN       TO COLVTAR
                  FILE STATUS          IS WR-FS-COLVTAR.

           SELECT COLL695 ASSIGN       TO UT-S-COLL695.
           EJECT
       DATA DIVISION.
      *==============
           SKIP3
       FILE SECTION.
      *=============
       FD  CREM002
           LABEL RECORD IS STANDARD.
      ******************************************************************
      *             DESCRIPCION DE REGISTRO (CREM002)
      *             ----------------------------------
      *
      *    ARCHIVO   : BCVO.MAESTRO.CREDITOS
      *              : MAESTRO DE CREDITOS
      *    FD        : CREM002
      *    PREFIJO   : 'CRE'
      *    LARGO REG.: 377
      *    ORGANIZAC.: VSAM-KSDS
      *    BLOQUEO   : NO
      *    CLAVE PRIM: CRE-CLAVE
      *    LARGO CL.1: 21
      *    CLAVE SEC.: CRE-RUT-DD
      *    LARGO CL.1: 10
      *
      ******************************************************************
      *
       01  CRE-CREDITOS-REG.

           05  CRE-CLAVE.
               10  CRE-SUCURSAL                PIC  9(03).
               10  CRE-CODIGO-OPER.
                   20  CRE-COD-OPER            PIC  9(03).
                       88 CRE-CREDITO-AL-PERSONAL VALUE
                       109 125 610 611 614 620 712 713 722 725.
                   20  CRE-SERIAL-OPER         PIC  9(05).
               10  CRE-RUT-DD.
                   20  CRE-RUT-DD-NUM          PIC  9(09).
                   20  CRE-RUT-DD-VER          PIC  X(01).

           05  CRE-RUT-DI.
               10  CRE-RUT-DI-DIG              PIC  9(09).
               10  CRE-RUT-DI-VER              PIC  X(01).
           05  CRE-RUT-EMP.
               10  CRE-RUT-EMP-DIG             PIC  9(09).
               10  CRE-RUT-EMP-VER             PIC  X(01).
           05  CRE-CTA-CTE                     PIC  X(10).

           05  CRE-TOTAL-CUOTAS                PIC  9(03).
           05  CRE-NUM-CUOT-PAGADAS            PIC  9(03).
           05  CRE-NUM-CUOT-MOROSAS            PIC  9(03).
           05  CRE-NUM-CUOT-PENDIENTES         PIC  9(03).

           05  CRE-FECH-CURSE.
               10  CRE-FECH-CURSE-AA           PIC  9(02).
               10  CRE-FECH-CURSE-MM           PIC  9(02).
               10  CRE-FECH-CURSE-DD           PIC  9(02).

           05  CRE-FECH-PAGARE.
               10  CRE-FECH-PAGARE-AA          PIC  9(02).
               10  CRE-FECH-PAGARE-MM          PIC  9(02).
               10  CRE-FECH-PAGARE-DD          PIC  9(02).
           05  CRE-FECH-PRIMER-VENC.
               10  CRE-FECH-PRIMER-VENC-AA     PIC  9(02).
               10  CRE-FECH-PRIMER-VENC-MM     PIC  9(02).
               10  CRE-FECH-PRIMER-VENC-DD     PIC  9(02).
           05  CRE-FECH-VENC-ANTERIOR.
               10  CRE-FECH-VENC-ANTERIOR-DD   PIC  9(02).
               10  CRE-FECH-VENC-ANTERIOR-MM   PIC  9(02).
               10  CRE-FECH-VENC-ANTERIOR-AA   PIC  9(02).

           05  CRE-FECH-PROX-VENC.
               10  CRE-FECH-PROX-VENC-AA       PIC  9(02).
               10  CRE-FECH-PROX-VENC-MM       PIC  9(02).
               10  CRE-FECH-PROX-VENC-DD       PIC  9(02).

           05  CRE-FECH-ULTIMO-MOV.
               10  CRE-FECH-ULTIMO-MOV-DD      PIC  9(02).
               10  CRE-FILLER-1                PIC  X(01).
               10  CRE-FECH-ULTIMO-MOV-MM      PIC  9(02).
               10  CRE-FILLER-2                PIC  X(01).
               10  CRE-FECH-ULTIMO-MOV-AA      PIC  9(02).

           05  CRE-TIPO-OPER                   PIC  X(03).
           05  CRE-TIPO-GARANTIA               PIC  X(01).
           05  CRE-TIPO-INTERES                PIC  X(01).
           05  CRE-TIPO-CLIENTE                PIC  9(03).
           05  CRE-PERIODICIDAD                PIC  9(01).
           05  CRE-REAJUSTABILIDAD             PIC  X(01).
           05  CRE-DIAS-PLAZO                  PIC  9(03).
           05  CRE-MESES-DIFERIDOS             PIC  X(03).
           05  CRE-TIEMPO-GRACIA               PIC  9(02).
           05  CRE-COD-DISTRIBUIDOR            PIC  X(02).
           05  CRE-AGENTE                      PIC  9(03).
           05  CRE-LINEA-CRED                  PIC  9(02).
           05  CRE-DESTINO                     PIC  X(02).
           05  CRE-TIPO-COBRANZA               PIC  9(01).
           05  CRE-INDIC-MONEDA                PIC  9(01).
           05  CRE-VIGENCIA                    PIC  X(01).
           05  CRE-OTRO-DD                     PIC  X(01).
           05  CRE-OTRO-DI                     PIC  X(01).

           05  CRE-MONTO-COLOC                 PIC S9(12)V9(03)  COMP-3.
           05  CRE-INTERES-COLOC               PIC S9(12)V9(03)  COMP-3.
           05  CRE-CUOTA-BASE                  PIC S9(10)V9(03)  COMP-3.
           05  CRE-TASA-VIGENTE                PIC S9(02)V9(02)  COMP-3.

           05  CRE-MONTO-PAGADO                PIC S9(12)V9(03)  COMP-3.
           05  CRE-INTERES-PAGADO              PIC S9(12)V9(03)  COMP-3.

           05  CRE-ULT-MONTO-CANC              PIC S9(10)V9(03)  COMP-3.
           05  CRE-ULT-INTERES-CANC            PIC S9(10)V9(03)  COMP-3.

           05  CRE-CUOTA-PROX-VENC             PIC S9(10)V9(03)  COMP-3.
           05  CRE-INTERES-PROX-VENC           PIC S9(10)V9(03)  COMP-3.

           05  CRE-SALDO-COLOCAC               PIC S9(12)V9(03)  COMP-3.
           05  CRE-TOT-INT-PAG-MES             PIC S9(12)V9(03)  COMP-3.

           05  CRE-REAJUSTES-PAG               PIC S9(10)V9(03)  COMP-3.
           05  CRE-VAL-IMPU                    PIC S9(11)V9(04)  COMP-3.
           05  CRE-HABER                       PIC S9(11)V9(04)  COMP-3.

           05  CRE-AJUSTE                      PIC S9(06)V9(02)  COMP-3.
           05  CRE-GASTO-NOTARIAL              PIC S9(06)V9(02)  COMP-3.
           05  CRE-OPERAC-ANTERIOR             PIC  X(08).
           05  CRE-COD-HIPOTECARIO             PIC  X(08).
           05  CRE-CLAVE-LINEA                 PIC  X(11).
           05  CRE-TASA-SPREAD-COLOC           PIC S9(02)V9(02).
           05  CRE-SALDO-CAPIT-REAJ            PIC S9(12)V9(03)  COMP-3.
           05  CRE-CUOTAS-ORIGINALES           PIC  9(03).
           05  CRE-NUM-OPERATIVAS              PIC  9(03).
           05  CRE-CONT-CAPITALIZ              PIC  9(02).
           05  CRE-CUOTAS-CURSE                PIC  9(03).
           05  CRE-PERIODICIDAD-INTERES        PIC  9(01).
           05  CRE-FECHA-CANCELACION.
               10  CRE-FECHA-CANCELACION-AA    PIC  9(02).
               10  CRE-FECHA-CANCELACION-MM    PIC  9(02).
               10  CRE-FECHA-CANCELACION-DD    PIC  9(02).
           05  CRE-FECH-PROX-VCTO-INT.
               10  CRE-FECH-PROX-VENC-INT-AA   PIC  9(02).
               10  CRE-FECH-PROX-VENC-INT-MM   PIC  9(02).
               10  CRE-FECH-PROX-VENC-INT-DD   PIC  9(02).
           05  CRE-FECH-ULT-PAGO-INT.
               10  CRE-FECH-ULT-PAGO-INT-AA    PIC  9(02).
               10  CRE-FECH-ULT-PAGO-INT-MM    PIC  9(02).
               10  CRE-FECH-ULT-PAGO-INT-DD    PIC  9(02).
           05  CRE-MTO-INTERES-CAPITALIZADO    PIC S9(08)V9(02)  COMP-3.
           05  CRE-TASA-INTERES-2              PIC S9(02)V9(02)  COMP-3.
           05  CRE-TASA-INTERES-3              PIC S9(02)V9(02)  COMP-3.
           05  CRE-TIPO-CUOTA                  PIC  9(01).
           05  CRE-IND-I8                      PIC  9(01).
           05  CRE-IND-I9                      PIC  9(01).
           05  CRE-IND-I11                     PIC  9(01).
           05  CRE-IND-I14                     PIC  9(02).
           05  CRE-IND-I16                     PIC  9(02).
           05  CRE-IND-I17                     PIC  9(01).
           05  CRE-IND-I18                     PIC  9(01).
           05  CRE-FECHA-SUSPEN.
               10  CRE-FECHA-SUSPEN-AA         PIC  9(02).
               10  CRE-FECHA-SUSPEN-MM         PIC  9(02).
               10  CRE-FECHA-SUSPEN-DD         PIC  9(02).
           05  CRE-VCTOS-EN-MES                PIC S9(12)V9(03)  COMP-3.
           05  CRE-VCTOS-PAG-MES               PIC S9(12)V9(03)  COMP-3.
           05  CRE-TASA-MAX-CONV               PIC  X(1).
           05  CRE-ESTADO-PRO                  PIC  X(1).
           05  CRE-NRO-PREPAGOS                PIC  9(03).
           05  CRE-CLASIF-RIESGO               PIC  X(02).
           05  CRE-IND-RENO                    PIC  X(01).
           05  CRE-IND-SUS-COB                 PIC  X(01).
           05  CRE-FILLER                      PIC  X(03).
           SKIP1
       FD  COLVTAR
           RECORD CONTAINS 080 CHARACTERS
           LABEL RECORD IS STANDARD.
       01  COLRTAR.
           02 FILLER            PIC X(13).
           02 TAR-COD-ACT       PIC X(02).
              88 TAR-ACT-NO     VALUE 'NO'.
              88 TAR-ACT-SI     VALUE 'SI'.
           02 FILLER            PIC X(12).
           02 TAR-COD-TIP       PIC X(01).
              88 TAR-TIP-OK     VALUE 'D'.
           02 TAR-COD-OFI       PIC X(03).
              88 TAR-OFI-OK     VALUE '   '.
           02 TAR-COD-NUM       PIC X(08).
              88 TAR-NUM-OK     VALUE '        '.
           02 FILLER            PIC X(11).
           02 TAR-CAM-1         PIC X(01).
              88 TAR-CAM-1-OK   VALUE '*'.
           02 FILLER            PIC X(02).
           02 TAR-CAM-2         PIC X(01).
              88 TAR-CAM-2-OK   VALUE '*'.
           02 FILLER            PIC X(02).
           02 TAR-CAM-3         PIC X(01).
              88 TAR-CAM-3-OK   VALUE '*'.
           02 FILLER            PIC X(02).
           02 TAR-CAM-4         PIC X(01).
              88 TAR-CAM-4-OK   VALUE '*'.
           02 FILLER            PIC X(02).
           02 TAR-CAM-5         PIC X(01).
              88 TAR-CAM-5-OK   VALUE '*'.
           02 FILLER            PIC X(02).
           02 TAR-CAM-6         PIC X(01).
              88 TAR-CAM-6-OK   VALUE '*'.
           02 FILLER            PIC X(02).
           02 TAR-CAM-7         PIC X(01).
              88 TAR-CAM-7-OK   VALUE '*'.
           02 FILLER            PIC X(02).
           02 TAR-CAM-8         PIC X(01).
              88 TAR-CAM-8-OK   VALUE '*'.
           02 FILLER            PIC X(08).
           SKIP1
       FD  COLL695
           LABEL RECORD  OMITTED.
       01  COLR695                   PIC X(132).
           SKIP1
       WORKING-STORAGE SECTION.
      *========================
       01  W-SWITCHES.
           05 WS-PROCESO             PIC 9(01) VALUE 0.
              88 WS-PROCESO-OK       VALUE 0.
              88 WS-PROCESO-NO-OK    VALUE 1.
              88 WS-PROCESO-WARNING  VALUE 2.
           05 WS-VALIDA              PIC 9(01) VALUE 0.
              88 WS-VALIDA-OK        VALUE 0.
              88 WS-VALIDA-NO-OK     VALUE 1.
           05 WS-DIFERENCIA          PIC 9(01) VALUE 0.
              88 WS-EXISTE-DIF       VALUE 0.
              88 WS-NO-EXISTE-DIF    VALUE 1.
           SKIP1
       01  W-CONTADORES-Y-ACUMULADORES.
           05 WA-L-TAR               PIC 9(06) VALUE 0.
           05 WA-L-OPC               PIC 9(06) VALUE 0.
           05 WA-DLCDCC              PIC 9(06) VALUE 0.
           05 WA-LEIDOS              PIC 9(06) VALUE 0.
           05 WA-IGUALE              PIC 9(06) VALUE 0.
           05 WA-DIFERE              PIC 9(06) VALUE 0.
           05 WA-NOEXIS              PIC 9(06) VALUE 0.
           05 WA-LINEA               PIC 9(03) VALUE 99.
           05 WA-PAGINA              PIC 9(04) VALUE 0.
           SKIP1
       01  W-REGISTROS-DE-TRABAJO.
           05 WR-FECHA-HOY.
              10 WR-HOY-AA           PIC X(02).
              10 WR-HOY-MM           PIC X(02).
              10 WR-HOY-DD           PIC X(02).
           05 WR-MENSAJES.
              10 WR-SECCION          PIC X(15).
              10 WR-PARRAFO          PIC X(15).
              10 WR-ARCHIVO          PIC X(10).
              10 WR-OPERACI          PIC X(10).
              10 WR-FILE-ST          PIC X(02).
              10 WR-MENSAJE          PIC X(35).
           05 WR-FS-COLVTAR          PIC 9(02) VALUE 0.
           05 WR-FS-CREM002          PIC 9(02) VALUE 0.
           05 WR-RAYA                PIC X(80) VALUE ALL '-'.
           05 WR-CIC-IOPE.
              10 FILLER              PIC X(01).
              10 WR-CIC-IOPE-D.
                 15 FILLER           PIC X(03).
                 15 WR-CIC-OOPE      PIC X(03).
                 15 FILLER           PIC X(05).
           05 WR-CIC-IOPE-X.
              10 WR-CIC-SUCU-X       PIC X(03).
              10 WR-CIC-CODI-X       PIC X(08).
           05 WR-DESTINO             PIC X(02) JUST.
           05 WR-LINEA01.
              10 FILLER           PIC X(018) VALUE 'BANCO DE CREDITOS'.
              10 FILLER           PIC X(005) VALUE 'E INV'.
              10 FILLER           PIC X(026) VALUE ALL ' '.
              10 FILLER           PIC X(018) VALUE 'ACTUALIZACION AL M'.
              10 FILLER           PIC X(018) VALUE 'AESTRO DE CREDITOS'.
              10 FILLER           PIC X(029) VALUE ALL ' '.
              10 FILLER           PIC X(009) VALUE 'FECHA  :'.
              10 WR-LA01-DIA      PIC X(002).
              10 FILLER           PIC X(001) VALUE ALL '/'.
              10 WR-LA01-MES      PIC X(002).
              10 FILLER           PIC X(001) VALUE ALL '/'.
              10 WR-LA01-ANO      PIC X(002).
           05 WR-LINEA02.
              10 FILLER           PIC X(012) VALUE 'COLOCACIONES'.
              10 FILLER           PIC X(102) VALUE ALL ' '.
              10 FILLER           PIC X(011) VALUE 'PAGINA :'.
              10 WR-LA02-PAGINA   PIC ZZ.ZZ9.
           05 WR-LINEA03.
              10 FILLER           PIC X(131) VALUE ALL '-'.
           05 WR-LINEA04.
              10 FILLER           PIC X(018) VALUE '   NUMERO        D'.
              10 FILLER           PIC X(006) VALUE 'ESTINO'.
           05 WR-LINEA05.
              10 FILLER           PIC X(018) VALUE '     DE        DEL'.
              10 FILLER           PIC X(008) VALUE ' CREDITO'.
           05 WR-LINEA06.
              10 FILLER           PIC X(018) VALUE '  OPERACION    ANT'.
              10 FILLER           PIC X(008) VALUE 'ES/DPUES'.
           05 WR-LINEA07.
              10 WR-LA07-NUM-OPE  PIC X(011).
              10 FILLER           PIC X(006).
              10 WR-LA07-DES-ANT  PIC X(002).
              10 WR-LA07-DES-GUI  PIC X(001).
              10 WR-LA07-DES-DPS  PIC X(002).
           SKIP1
      ******************************************************************
      *      USER INFORMATION BLOCK                                    *
      ******************************************************************
      *
       01  WB-UIB.
           05 FILLER                 PIC X(32) VALUE 'COLPB695'.
      *
      ******************************************************************
      *      REQUEST AREA                                              *
      ******************************************************************
      *
       01  WB-REQ-OPC-AREA.
           02 WB-REQ-OPC-CMD          PIC X(5) VALUE 'REDKG'.
           02 FILLER                  PIC X(3) VALUE 'OPC'.
           02 FILLER                  PIC X(5) VALUE 'OPC00'.
           02 WB-REQ-OPC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +160.
           02 FILLER                  PIC X(58).
           02 WB-REQ-OPC-KEY-VALUE.
              03 WB-REQ-OPC-KEY-1     PIC X(01).
              03 WB-REQ-OPC-KEY-2     PIC X(03).
              03 WB-REQ-OPC-KEY-3     PIC X(08).

       01  WB-REQ-DLC-AREA.
           02 WB-REQ-DLC-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'DLC'.
           02 FILLER                  PIC X(5) VALUE 'DLC00'.
           02 WB-REQ-DLC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +160.
           02 FILLER                  PIC X(58).
           02 WB-REQ-DLC-KEY-VALUE.
              03 WB-REQ-DLC-KEY-1     PIC X(12).
              03 WB-REQ-DLC-KEY-2     PIC X(03).

       01  WB-REQ-DCC-AREA.
           02 WB-REQ-DCC-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'DCC'.
           02 FILLER                  PIC X(5) VALUE 'DCC00'.
           02 WB-REQ-DCC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +210.
           02 FILLER                  PIC X(58).
           02 WB-REQ-DCC-KEY-VALUE    PIC X(50).

      ******************************************************************
      *                   WORK AREA                                    *
      ******************************************************************
      *
      *    Operacion Credito
      *    -----------------
      *
      *    Nombre Registro : OPC
      *    Clave(s)        : OPC-KEY-IOPC(UU), OPC-FEC-FCOL(DC),
      *                      OPC-FEC-FING(DC), OPC-FEC-FINP(DC)
      *    Largo           : 245
      *    Bloqueo         : 2
      *    Observaciones   :
      *
      *    01) Modificaciones 06/09/88, LJV
      *        - Eliminacion Clave OPC-STP-ITRN
      *    02) Modificaciones 11/10/89, ALD
      *        - Cambio nombre campo OPC-NUM-IEVC
      *          por  OPC-NUM-IVEN
      *        - Ingreso campo OPC-IND-VSTR
      *    03) Modificacion  30/06/93,  DAD
      *        - Modificado Largo/Bloqueo del registro, de 218/4 a 245/2
      *          aumentando la Glosa Disponible.
      *    04) Modificacion  06/09/95,  ALD
      *        - Ingreso Campo OPC-VAL-SEGP
      *        - Modificado Glosa Disponible de 28 a 20
      *
       01  OPC.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  OPC-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  OPC-KEY-IREG.
      *
      *KEY     Identificacion Operacion Credito
               05  OPC-KEY-IOPC.
      *
      *            Cod. Int. Comp. Operacion Credito
                   07  OPC-CIC-IOPC.
      *
      *                Centro Asignacion Identificacion
                       09  OPC-CAI-IOPC.
                           11  OPC-COD-TOPC             PIC X(01).
                           11  OPC-COD-COPC             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  OPC-IIC-IOPC.
                           11  OPC-COD-OOPC.
                               13  OPC-COD-SOPC         PIC X(02).
                               13  OPC-IND-SOPC         PIC X(01).
                           11  OPC-GLS-NOPC             PIC X(05).
      *
      *        Time Stamp Transaccion
               05  OPC-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  OPC-FEC-FTRN.
                       09  OPC-NUM-STRN                 PIC 9(02).
                       09  OPC-NUM-ATRN                 PIC 9(02).
                       09  OPC-NUM-MTRN                 PIC 9(02).
                       09  OPC-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  OPC-HRA-HRTR.
                       09  OPC-NUM-HHTR                 PIC 9(02).
                       09  OPC-NUM-MMTR                 PIC 9(02).
                       09  OPC-NUM-SSTR                 PIC 9(02).
      *
      *REQ Indicador Tipo Accion
           03  OPC-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  OPC-MSC-STAT                             PIC X(01).
               88  OPC-INGRESADA               VALUE 'I'.
               88  OPC-MODIFICADA              VALUE 'M'.
               88  OPC-APROBADA-CTC            VALUE 'F'.
               88  OPC-LIQUIDADA-CTC           VALUE 'K'.
               88  OPC-LIQUIDADA-LIQ           VALUE 'L'.
               88  OPC-ACTIVADA                VALUE 'A'.
               88  OPC-ESPERA-OPC              VALUE 'C'.
               88  OPC-ESPERA-ENVIO-ABONO-DIF  VALUE 'B'.
               88  OPC-ESPERA-ENVIO-ABONO      VALUE 'G'.
               88  OPC-ESPERA-CONF-ABONO       VALUE 'H'.
               88  OPC-ESPERA-ABONO-X          VALUE 'X'.
               88  OPC-SUSPENDIDA              VALUE 'S'.
               88  OPC-DESACTIVADA             VALUE 'D'.
               88  OPC-ACTUALIZADA             VALUE 'I' 'M'.
               88  OPC-PENDIENTE-CTC           VALUE 'F' 'K'.
               88  OPC-LIQUIDADA               VALUE 'L' 'K'.
               88  OPC-ESPERA-ABONO            VALUE 'B' 'G' 'H' 'X'.
      * RBG INI 10-APR-1996
               88  OPC-APROBADA-APR            VALUE 'J'.
      * RBG FIN 10-APR-1996
      *
      *REQ Codigo Origen Transaccion
           03  OPC-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  OPC-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  OPC-COD-TTRN                         PIC X(03).
      *
      *REQ Autor Transaccion
           03  OPC-COD-ATRN                             PIC X(12).
      *
      *REQ Valor de Cambio Operacion Credito            TAB VLR
           03  OPC-COD-VCOC.
      *
      *        Miscelaneo Tipo Valor                    TAB TVAL
               05  OPC-MSC-TVOC                         PIC X(01).
      *
      *        Codigo Valor
               05  OPC-COD-CVOC                         PIC X(03).
      *
      *        Codigo Tipo Cambio
               05  OPC-COD-TCOC                         PIC X(02).
      *
      *REQ Codigo Clase Operacion Credito               COL AUX
           03  OPC-COD-COOC.
      *
      *        Codigo Tipo Operacion                    COL TOC
               05  OPC-COD-TOOC                         PIC X(03).
      *
      *        Codigo Auxiliar Operacion
               05  OPC-COD-AOOC                         PIC X(03).
      *
      *REQ Codigo Oficina Operacion Credito             TAB OFI
           03  OPC-COD-OFOC                             PIC X(03).
      *
      *    Responsable Mantencion Operacion Credito     TAB USR
           03  OPC-COD-RMOC                             PIC X(12).
      *
      *    Codigo Destino Operacion Credito             COL DES
           03  OPC-COD-CDOC                             PIC X(03).
      *
      *    Cod. Int. Comp. Linea de Credito
           03  OPC-CIC-ILDC.
      *
      *        Centro Asignacion Identificacion
               05  OPC-CAI-ILDC.
                   07  OPC-COD-TLDC                     PIC X(01).
                   07  OPC-COD-CLDC                     PIC X(03).
      *
      *        Ident. Interna Computacional
               05  OPC-IIC-ILDC.
                   07  OPC-COD-OLDC.
                       09  OPC-COD-SLDC                 PIC X(02).
                       09  OPC-IND-SLDC                 PIC X(01).
                   07  OPC-GLS-NLDC                     PIC X(05).
      *
      *REQ Fecha Curse o Colocacion
           03  OPC-FEC-FCOL.
               05  OPC-NUM-SCOL                         PIC 9(02).
               05  OPC-NUM-ACOL                         PIC 9(02).
               05  OPC-NUM-MCOL                         PIC 9(02).
               05  OPC-NUM-DCOL                         PIC 9(02).
      *
      *REQ Fecha Curse Contable
           03  OPC-FEC-FING.
               05  OPC-NUM-SING                         PIC 9(02).
               05  OPC-NUM-AING                         PIC 9(02).
               05  OPC-NUM-MING                         PIC 9(02).
               05  OPC-NUM-DING                         PIC 9(02).
      *
      *REQ Fecha Curse Computacional
           03  OPC-FEC-FINP.
               05  OPC-NUM-SINP                         PIC 9(02).
               05  OPC-NUM-AINP                         PIC 9(02).
               05  OPC-NUM-MINP                         PIC 9(02).
               05  OPC-NUM-DINP                         PIC 9(02).
      *
      *REQ Monto Credito
           03  OPC-VAL-CRED             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Saldo Valor Credito K Capital Insoluto
           03  OPC-VAL-SCRE             COMP-3          PIC 9(11)V9(04).
      *
      *REQ Analisis Feriados (S/N)                      COL AFER
           03  OPC-IND-AFER                             PIC X(01).
      *
      *REQ Modalidad Calculo Valores Finales            COL MCVF
           03  OPC-MSC-MCVF                             PIC X(01).
      *
      *REQ Tipo Calculo Vencimientos                    COL TCVE
           03  OPC-MSC-TCVE.
      *
      *        Base Calculo Credito                     COL BCCR
               05  OPC-MSC-BCCR                         PIC X(01).
      *
      *        Valores Informados Credito               COL VICR
               05  OPC-MSC-VICR                         PIC X(01).
      *
      *    Tipo Renovacion                              COL RENO
           03  OPC-IND-RENO                             PIC X(03).
      *
      *    Condicion Garantia                           COL GARA
           03  OPC-IND-GARA                             PIC X(03).
      *
      *    Valor Comision
           03  OPC-SGV-VCOM             COMP-3          PIC S9(11)V9(4).
      *
      *    Valor Gastos
           03  OPC-VAL-GAST             COMP-3          PIC S9(11)V9(4).
      *
      *    Codigo de Seguro Desgravamen                 TAB IVB
           03  OPC-COD-SEGD.
               05  OPC-COD-ISEG                         PIC X(03).
               05  OPC-COD-CSEG                         PIC X(03).
               05  OPC-COD-SSEG                         PIC X(03).
      *
      *    Valor Seguro
           03  OPC-VAL-SEGD             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Liquido
           03  OPC-SGV-LIQU             COMP-3          PIC S9(11)V9(4).
      *
      *MOD-02
      *REQ Numero Proximo Vencimiento
           03  OPC-NUM-IVEN                             PIC 9(03).
      *
      *REQ Numero Vencimientos Originales
           03  OPC-NUM-VCOR                             PIC 9(03).
      *
      *REQ Numero Vencimientos Vigentes
           03  OPC-NUM-VCVG                             PIC 9(03).
      *
      *    Numero Venctos Cancelados en forma Oportuna
           03  OPC-NUM-VCCO                             PIC 9(03).
      *
      *    Numero Vencimientos Cancelados Morosos
           03  OPC-NUM-VCCM                             PIC 9(03).
      *
      *    Numero de Vencimientos Cancelados Vencidos
           03  OPC-NUM-VCCV                             PIC 9(03).
      *
      *REQ Numero Total Vencimientos Cancelados
           03  OPC-NUM-TVCC                             PIC 9(03).
      *
      *ING-02
      *    Indicador Vencimientos Estructurados
           03  OPC-IND-VSTR                             PIC X(01).
      *
      *    Cod. Int. Comp. Credito Enlace
           03  OPC-CIC-ICEN.
      *
      *        Centro Asignacion Identificacion
               05  OPC-CAI-ICEN.
                   07  OPC-COD-TCEN                     PIC X(01).
                   07  OPC-COD-CCEN                     PIC X(03).
      *
      *        Ident. Interna Computacional
               05  OPC-IIC-ICEN.
                   07  OPC-COD-OCEN.
                       09  OPC-COD-SCEN                 PIC X(02).
                       09  OPC-IND-SCEN                 PIC X(01).
                   07  OPC-GLS-NCEN                     PIC X(05).
      *
      *    Codigo Area Gestion                          COL GES
           03  OPC-COD-AGES                             PIC X(02).
      *
      *    Flag para activar sin contabilizar
           03 OPC-IND-CTBL                              PIC X(01).
      *
      *    Indicador Insistencia
           03 OPC-COD-INSI                              PIC X(01).
      *
      *    Canal de Venta
           03 OPC-COD-CVTA                              PIC X(01).
      *
      *MOD-04
      *    Valor Seguro
           03  OPC-VAL-SEGP             COMP-3          PIC 9(11)V9(04).
      *
      *MOD-04
      *    Glosa Disponible
           03  OPC-GLS-DISP                             PIC X(20).
      *    Documento Legal Credito
      *    -----------------------
      *
      *    Nombre Registro : DLC
      *    Clave(s)        : DLC-KEY-IDLC(UU), DLC-IND-SCTB(DC)
      *    Largo           : 283
      *    Bloqueo         : 4
      *    Observaciones   :
      *
      *    01) Modificaciones 06/09/88, LJV
      *        - Eliminacion Clave DLC-KEY-IREG
      *        - Modificacion Largo/Bloqueo registro (194/2)
      *        - Estandarizacion a Header tipo Log
      *        - Eliminacion campo DLC-MSC-TCVE
      *        - Incorporacion campo DLC-IND-SCTB
      *        - Incorporacion campo DLC-FEC-FMAV
      *    02) Modificaciones 03/10/89, ISP
      *        - Creacion de llave DLC-IND-SCTB duplicada y modificable
      *        - Ingreso campo DLC-NUM-VSCE
      *        - Modificacion disponible
      *    03) Modificacion  15/12/92,  DAD
      *        - Creacion de campo DLC-DMA-FSDE redefiniendo el Disponib
      *    04) Modificacion  30/06/93,  DAD
      *        - Modificado largo y campo DLC-DMA-FSDE por DLC-FEC-FSDE
      *        - Modificado Largo/Bloqueo del registro, de 218/4 a 283/4
      *          aumentada la Glosa Disponible.
      *    05) Modificacion 25/04/95,  JUS
      *        - Creacion campos: DLC-COD-SUSP
      *                           DLC-FEC-FSDM
      *        - Glosa Disponible queda en 11.
      *
       01  DLC.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  DLC-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  DLC-KEY-IREG.
      *
      *        Identificacion Documento Legal                        KEY
               05  DLC-KEY-IDLC.
      *
      *            Cod. Int. Comp. Operacion Credito
                   07  DLC-CIC-IOPC.
      *
      *                Centro Asignacion Identificacion
                       09  DLC-CAI-IOPC.
                           11  DLC-COD-TOPC             PIC X(01).
                           11  DLC-COD-COPC             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  DLC-IIC-IOPC.
                           11  DLC-COD-OOPC.
                               13  DLC-COD-SOPC         PIC X(02).
                               13  DLC-IND-SOPC         PIC X(01).
                           11  DLC-GLS-NOPC             PIC X(05).
      *
      *            Num Identificacion Documento Legal
                   07  DLC-NUM-IDLC                     PIC 9(03).
      *
      *        Time Stamp Transaccion
               05  DLC-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  DLC-FEC-FTRN.
                       09  DLC-NUM-STRN                 PIC 9(02).
                       09  DLC-NUM-ATRN                 PIC 9(02).
                       09  DLC-NUM-MTRN                 PIC 9(02).
                       09  DLC-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  DLC-HRA-HRTR.
                       09  DLC-NUM-HHTR                 PIC 9(02).
                       09  DLC-NUM-MMTR                 PIC 9(02).
                       09  DLC-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion                                     REQ
           03  DLC-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  DLC-MSC-STAT                             PIC X(01).
      *
      *    Codigo Origen Transaccion                                 REQ
           03  DLC-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  DLC-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  DLC-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion                                         REQ
           03  DLC-COD-ATRN                             PIC X(12).
      *
      *    Valor Nominal Documento Legal                             REQ
           03  DLC-VAL-NDLC             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Saldo Documento Legal                               REQ
           03  DLC-VAL-SDLC             COMP-3          PIC 9(11)V9(04).
      *
      *    Codigo Tipo Documento                        TAB DOC      REQ
           03  DLC-COD-TDOC                             PIC X(03).
      *
      *    Codigo Plazo ( Contable )                    TAB PZO      REQ
           03  DLC-COD-PLZO.
               05  DLC-MSC-TPZO                         PIC X(01).
               05  DLC-MSC-CPZO                         PIC X(01).
      *
      *    Tipo Impuestos                               COL TIMP
           03  DLC-MSC-TIMP                             PIC X(01).
      *
      *    Valor Impuestos
           03  DLC-VAL-IMPU             COMP-3          PIC 9(11)V9(04).
      *
      *    Codigo Notario Credito                       TAB IVB
           03  DLC-COD-NOTC.
               05  DLC-COD-INOT                         PIC X(03).
               05  DLC-COD-CNOT                         PIC X(03).
               05  DLC-COD-SNOT                         PIC X(03).
      *
      *    Valor Gastos Notario
           03  DLC-VAL-GNOT             COMP-3          PIC 9(11)V9(04).
      *
      *    Situacion Cobranza                           COL SCBZ
           03  DLC-IND-SCBZ                             PIC X(05).
      *
      *    Situacion Cartera                            COL SCRT     REQ
           03  DLC-IND-SCRT                             PIC X(03).
      *
      *    Codigo Ubicacion Fisica                      TAB IVB
           03  DLC-COD-UBFD.
               05  DLC-COD-IUBF                         PIC X(03).
               05  DLC-COD-CUBF                         PIC X(03).
               05  DLC-COD-SUBF                         PIC X(03).
      *
      *    Codigo Plaza                                 TAB PZA      REQ
           03  DLC-COD-PLZA                             PIC X(04).
      *
      *    Manejo Intereses Periodos Largos             COL MIPL     REQ
           03  DLC-MSC-MIPL                             PIC X(01).
      *
      *    Tipo Calculo Vencimientos                    COL TCVE
      *    03  DLC-MSC-TCVE.
      *
      *        Base Calculo Credito                     COL BCCR
      *        05  DLC-MSC-BCCR                         PIC X(01).
      *
      *        Valores Informados Credito               COL VICR
      *        05  DLC-MSC-VICR                         PIC X(01).
      *
      *    Clasificacion Riesgo                         DEU RIES     REQ
           03  DLC-IND-RIES                             PIC X(02).
      *
      *    Valor Reajustes Devengados Documento Legal                PEN
           03  DLC-VAL-READ             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Intereses Devengados Documento Legal                PEN
           03  DLC-VAL-INTD             COMP-3          PIC 9(11)V9(04).
      *
      *    Fecha Devengo ( Ultimo Pago Total Intereses )             REQ
           03  DLC-FEC-FDEV.
               05  DLC-NUM-SDEV                         PIC 9(02).
               05  DLC-NUM-ADEV                         PIC 9(02).
               05  DLC-NUM-MDEV                         PIC 9(02).
               05  DLC-NUM-DDEV                         PIC 9(02).
      *
      *    Saldo Intereses
           03  DLC-VAL-SINT             COMP-3          PIC 9(11)V9(04).
      *
      *    Saldo Capital por Amortizar
           03  DLC-VAL-SCPA             COMP-3          PIC 9(11)V9(04).
      *
      *    Fecha Amortizacion
           03  DLC-FEC-FAMT.
               05  DLC-NUM-SAMT                         PIC 9(02).
               05  DLC-NUM-AAMT                         PIC 9(02).
               05  DLC-NUM-MAMT                         PIC 9(02).
               05  DLC-NUM-DAMT                         PIC 9(02).
      *
      *    Identificacion Documento Legal Original
           03  DLC-KEY-IDLO.
      *
      *        Cod. Int. Comp. Operacion Credito Original
               05  DLC-CIC-IOCO.
      *
      *            Centro Asignacion Identificacion
                   07  DLC-CAI-IOCO.
                       09  DLC-COD-TOCO                 PIC X(01).
                       09  DLC-COD-COCO                 PIC X(03).
      *
      *            Ident. Interna Computacional
                   07  DLC-IIC-IOCO.
                       09  DLC-COD-OOCO.
                           11  DLC-COD-SOCO             PIC X(02).
                           11  DLC-IND-SOCO             PIC X(01).
                       09  DLC-GLS-NOCO                 PIC X(05).
      *
      *        Num Ident Documento Legal Original
               05  DLC-NUM-IDLO                         PIC 9(03).
      *
      *    Monto Intereses Pendientes
           03  DLC-VAL-IPEN             COMP-3          PIC 9(11)V9(04).
      *
      *    Valor Docto en Pesos (Cuadre Contabilidad)                REQ
           03  DLC-VAL-DPES             COMP-3          PIC 9(11)V9(04).
      *
      *    Indicador Situacion Contable                 COL SCTB
           03  DLC-IND-SCTB                             PIC X(03).
      *
      *    Fecha Maximo Vencimiento
           03  DLC-FEC-FMAV.
               05  DLC-NUM-SMAV                         PIC 9(02).
               05  DLC-NUM-AMAV                         PIC 9(02).
               05  DLC-NUM-MMAV                         PIC 9(02).
               05  DLC-NUM-DMAV                         PIC 9(02).
      *ING-02
      *    Cantidad de venciminetos en situacion contable especial
      *    ( NOT = SPACES )
      *    Cero ==> todos los vencimientos estan en la misma
      *             situacion contable
      *    Distinto de cero ==> Existen vencimientos en distintas
      *                         situaciones contables
      *
           03  DLC-NUM-VSCE                             PIC 9(03).
      *
      *MOD-04
      *MOD-03 ( DLC-DMA-FSDE )
      *    Fecha Suspension Devengo (Por Clasificacion de Riesgo)
           03  DLC-FEC-FSDE.
               05  DLC-NUM-SSDE                         PIC 9(02).
               05  DLC-NUM-ASDE                         PIC 9(02).
               05  DLC-NUM-MSDE                         PIC 9(02).
               05  DLC-NUM-DSDE                         PIC 9(02).
      *
      *MOD-04
           03  DLC-VAL-PIMP                             PIC 9(11).
      *MOD-05 INI
      *    Causal de Suspension de Devengo.
           03  DLC-COD-SUSP                             PIC X(01).
      *
      *    Fecha Suspension Devengo por Mora
           03  DLC-FEC-FSDM.
               05  DLC-NUM-SSDM                         PIC 9(02).
               05  DLC-NUM-ASDM                         PIC 9(02).
               05  DLC-NUM-MSDM                         PIC 9(02).
               05  DLC-NUM-DSDM                         PIC 9(02).
      *
      *    Glosa Disponible baja de (52 - 9) = 43
           03  DLC-GLS-DISP                             PIC X(43).
      *MOD-05 FIN
      *    DICCIONARIO CUENTAS CONTABLES
      *    -----------------------------
      *
      *    NOMBRE REGISTRO : DCC
      *    CLAVE(S)        : DCC-COD-TABL(UU), DCC-CIC-TABL(UU)
      *                      DCC-EXT-TABL(UC)
      *    LARGO           : 117
      *    BLOQUEO         : 1
      *    OBSERVACIONES   :
      *
       01  DCC.
      *
      *    FILLER COMPATIBILIDAD VSAM/MVS
           03  DCC-GLS-FLAG                             PIC X(01).
      *
      *    CLAVE PRIMARIA REGISTRO
           03  DCC-KEY-IREG.
      *
      *KEY     TIPO + CODIGO ( LLAVE PRIMARIA )
               05  DCC-COD-TABL.
      *
      *            CODIGO TIPO TABLA
                   07  DCC-COD-TTAB                     PIC X(03).
      *
      *            IDENTIFICACION CUENTA CONTABLE
                   07  DCC-COD-CCTB.
      *
      *                IDENTIFICA TIPO CUENTA CONTABLE  COL TCCT
                       09  DCC-MSC-TCCT                 PIC X(03).
      *
      *                CODIGO VALOR DE CAMBIO           TAB VLR
                       09  DCC-COD-VCAM.
      *
      *                    MISCELANEO TIPO VALOR        TAB TVAL
                           11  DCC-MSC-TVAL             PIC X(01).
      *
      *                    CODIGO VALOR
                           11  DCC-COD-CVAL             PIC X(03).
      *
      *                    CODIGO TIPO CAMBIO
                           11  DCC-COD-TCAM             PIC X(02).
      *
      *                CODIGO CLASE OPERACION CREDITO   COL AUX
                       09  DCC-COD-COCR.
      *
      *                    CODIGO TIPO OPERACION        TAB TIO
                           11  DCC-COD-TOCR             PIC X(03).
      *
      *                    CODIGO AUXILIAR
                           11  DCC-COD-AOCR             PIC X(03).
      *
      *                CODIGO PLAZO                     TAB PZO
                       09  DCC-COD-PLZO                 PIC X(02).
      *
      *                SITUACION CARTERA                COL SCRT
                       09  DCC-IND-SCRT                 PIC X(03).
      *
      *                SITUACION CONTABLE               COL SCTB
                       09  DCC-IND-SCTB                 PIC X(03).
      *
      *                SITUACION COBRANZA               COL SCBZ
                       09  DCC-IND-SCBZ                 PIC X(05).
      *
      *        TIME STAMP TRANSACCION
               05  DCC-STP-ITRN.
      *
      *            FECHA TRANSACCION
                   07  DCC-FEC-FTRN.
                       09  DCC-NUM-STRN                 PIC 9(02).
                       09  DCC-NUM-ATRN                 PIC 9(02).
                       09  DCC-NUM-MTRN                 PIC 9(02).
                       09  DCC-NUM-DTRN                 PIC 9(02).
      *
      *            HORA TRANSACCION
                   07  DCC-HRA-HRTR.
                       09  DCC-NUM-HHTR                 PIC 9(02).
                       09  DCC-NUM-MMTR                 PIC 9(02).
                       09  DCC-NUM-SSTR                 PIC 9(02).
      *
      *    INDICADOR TIPO ACCION
           03  DCC-MSC-TACC                             PIC X(01).
      *
      *    INDICADOR STATUS
           03  DCC-MSC-STAT                             PIC X(01).
      *
      *    INDICADOR VIGENCIA                           GNS VIGE
           03  DCC-IND-VIGE  REDEFINES  DCC-MSC-STAT    PIC X(01).
      *
      *    CODIGO ORIGEN TRANSACCION
           03  DCC-COD-OTRN.
      *
      *        INDICADOR TIPO ORIGEN
               05  DCC-MSC-TTRN                         PIC X(01).
      *
      *        CODIGO TIPO ORIGEN
               05  DCC-COD-TTRN                         PIC X(03).
      *
      *    AUTOR TRANSACCION
           03  DCC-COD-ATRN                             PIC X(12).
      *
      *KEY TIPO + CODIGO ( INTERNO COMPUTACIONAL )
           03  DCC-CIC-TABL.
      *
      *        CODIGO TIPO TABLA
               05  DCC-CIC-TTAB                         PIC X(03).
      *
      *        IDENTIFICACION CUENTA CONTABLE
               05  DCC-CIC-CCTB.
      *
      *            IDENTIFICA TIPO CUENTA CONTABLE
                   07  DCC-CIC-TCCT                     PIC X(03).
      *
      *            CODIGO VALOR DE CAMBIO
                   07  DCC-CIC-VCAM.
      *
      *                MISCELANEO TIPO VALOR
                       09  DCC-CIC-TVAL                 PIC X(01).
      *
      *                CODIGO VALOR
                       09  DCC-CIC-CVAL                 PIC X(03).
      *
      *                CODIGO TIPO CAMBIO
                       09  DCC-CIC-TCAM                 PIC X(02).
      *
      *            CODIGO CLASE OPERACION CREDITO
                   07  DCC-CIC-COCR.
      *
      *                CODIGO TIPO OPERACION
                       09  DCC-CIC-TOCR                 PIC X(03).
      *
      *                CODIGO AUXILIAR
                       09  DCC-CIC-AOCR                 PIC X(03).
      *
      *            CODIGO PLAZO
                   07  DCC-CIC-PLZO                     PIC X(02).
      *
      *            SITUACION CARTERA
                   07  DCC-CIC-SCRT                     PIC X(03).
      *
      *            SITUACION CONTABLE
                   07  DCC-CIC-SCTB                     PIC X(03).
      *
      *            SITUACION COBRANZA
                   07  DCC-CIC-SCBZ                     PIC X(05).
      *
      *    CODIGO EXTERNO
           03  DCC-EXT-TABL.
      *
      *        CODIGO TIPO TABLA
               05  DCC-EXT-TTAB                         PIC X(03).
      *
      *        CODIGO TABLA
               05  DCC-EXT-CTAB                         PIC X(05).
      *
      *    DESCRIPCION CORTA
      *    03  DCC-GLS-DCOR                             PIC X(12).
      *
      *    ABREVIACION DE LA CUENTA
      *    03  DCC-GLS-ABRV                             PIC X(05).
      *
      *    DESCRIPCION DE LA CUENTA
      *    03  DCC-GLS-DESC                             PIC X(60).
      *
      *    TIPO DE OPERACION SEGUN BANCO
      *    03  DCC-GLS-TOSB                             PIC X(05).
      *
      *    CODIGO CUENTA SEGUN BANCO
           03  DCC-GLS-CCSB                             PIC X(12).
      *
      *    CODIGO CUENTA SEGUN SUPERINTENDENCIA BANCOS
      *    03  DCC-GLS-CCSS                             PIC X(12).
      *
      *    DISPONIBLE
           03  DCC-GLS-DISP                             PIC X(02).
      *
      *    CLAVE SOUNDEX
      *    03  DCC-SNX-TABL.
      *        05  DCC-SNX-TTAB                         PIC X(03).
      *        05  DCC-SNX-CCTB                         PIC X(03).
      ******************************************************************
      *                 ELEMENT LIST                                   *
      ******************************************************************
      *
       01  WB-ELEM-LIS        PIC X(11).
           EJECT
       PROCEDURE DIVISION.
      *===================
           ENTRY 'DBMSCBL'.
           EJECT
       A-CONTROL SECTION.
      *=================
       AA-INICIALIZACION.
           PERFORM B-INICIALIZAR.
           SKIP1
       AB-PROCESAMIENTO.
           IF (WS-PROCESO-OK)
               PERFORM C-PROCESAR
           END-IF.
           SKIP1
       AC-TERMINACION.
           PERFORM D-TERMINAR.
           SKIP1
       AZ-FIN-DE-PROCESO.
           GOBACK.
           EJECT
       B-INICIALIZAR SECTION.
      *======================
       BA-PROCESO-INICIAL.
      *-------------------
           PERFORM BB-ABRIR-ARCHIVOS
           PERFORM BD-FECHAS-LISTADO.
           GO BZ-FIN-DE-SECCION.
           SKIP1
       BB-ABRIR-ARCHIVOS.
      *------------------
           OPEN INPUT  COLVTAR
                I-O    CREM002
                OUTPUT COLL695.
           IF (WR-FS-COLVTAR NOT = 0 AND NOT = 97)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS' TO WR-PARRAFO
               MOVE 'COLVTAR    '       TO WR-ARCHIVO
               MOVE 'OPEN       '       TO WR-OPERACI
               MOVE WR-FS-COLVTAR       TO WR-FILE-ST
               PERFORM BC-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-CREM002 NOT = 0 AND NOT = 97)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS' TO WR-PARRAFO
               MOVE 'CREM002    '       TO WR-ARCHIVO
               MOVE 'OPEN       '       TO WR-OPERACI
               MOVE WR-FS-CREM002       TO WR-FILE-ST
               PERFORM BC-DISPLAY-ERROR
           END-IF.
           SKIP1
       BC-DISPLAY-ERROR.
      *-----------------
           SET WS-PROCESO-NO-OK        TO TRUE.
           DISPLAY ' '
           DISPLAY 'ERROR EN SECCION  : ' WR-SECCION
           DISPLAY ' PARRAFO          : ' WR-PARRAFO
           DISPLAY ' ARCHIVO          : ' WR-ARCHIVO
           DISPLAY ' OPERACION        : ' WR-OPERACI
           DISPLAY ' FILE STATUS      : ' WR-FILE-ST
           DISPLAY ' MENSAJE DE ERROR : ' WR-MENSAJE.
           SKIP1
       BD-FECHAS-LISTADO.
      *------------------
           ACCEPT WR-FECHA-HOY FROM DATE.
           MOVE WR-HOY-AA               TO WR-LA01-ANO
           MOVE WR-HOY-MM               TO WR-LA01-MES
           MOVE WR-HOY-DD               TO WR-LA01-DIA.
           SKIP1
       BZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       C-PROCESAR SECTION.
      *===================
       CA-PROCESO-GRAL.
      *----------------
           PERFORM CB-LEER-COLVTAR
           PERFORM CC-PROCESA-PARAMET
             UNTIL (WR-FS-COLVTAR NOT = 0  OR WS-PROCESO-NO-OK)
           GO CZ-FIN-DE-SECCION.
           SKIP1
       CB-LEER-COLVTAR.
      *----------------
           READ COLVTAR END-READ
           IF (WR-FS-COLVTAR = 0)
               ADD  1                   TO WA-L-TAR
           ELSE
           IF (WR-FS-COLVTAR NOT = 10)
               MOVE 'C-PROCESAR   '     TO WR-SECCION
               MOVE 'CB-LEER-COLVTAR'   TO WR-PARRAFO
               MOVE 'COLVTAR    '       TO WR-ARCHIVO
               MOVE 'READ       '       TO WR-OPERACI
               MOVE WR-FS-COLVTAR       TO WR-FILE-ST
               PERFORM BC-DISPLAY-ERROR
           END-IF
           END-IF.
           SKIP1
       CC-PROCESA-PARAMET.
      *-------------------
           PERFORM CD-VALIDA-COLVTAR
           IF (WS-VALIDA-OK)
               PERFORM CE-PROCESO-SEGUN-PARAMETRO
           END-IF.
           PERFORM CB-LEER-COLVTAR.
           SKIP1
       CD-VALIDA-COLVTAR.
      *------------------
           SET WS-VALIDA-OK            TO TRUE.
           DISPLAY WR-RAYA.
           DISPLAY COLRTAR.
           IF (NOT TAR-ACT-SI AND NOT TAR-ACT-NO)
               SET WS-VALIDA-NO-OK     TO TRUE
               SET WS-PROCESO-WARNING  TO TRUE
               DISPLAY '** PARAMETRO DE ACTUALIZACION INVALIDO **'
           END-IF.
           IF (NOT TAR-TIP-OK                                 OR
              (NOT TAR-OFI-OK AND TAR-COD-OFI IS NOT NUMERIC) OR
              (NOT TAR-NUM-OK AND TAR-COD-NUM IS NOT NUMERIC) OR
              (TAR-OFI-OK     AND TAR-COD-NUM IS NUMERIC))
               SET WS-VALIDA-NO-OK     TO TRUE
               SET WS-PROCESO-WARNING  TO TRUE
               DISPLAY '** CODIGO INVALIDO **'
           END-IF.

           IF NOT (TAR-CAM-1-OK OR TAR-CAM-2-OK OR TAR-CAM-3-OK OR
                   TAR-CAM-4-OK OR TAR-CAM-5-OK OR TAR-CAM-6-OK OR
                   TAR-CAM-7-OK OR TAR-CAM-8-OK)
               SET WS-VALIDA-NO-OK     TO TRUE
               SET WS-PROCESO-WARNING  TO TRUE
               DISPLAY '** SIN CAMPOS DE ACTUALIZACION **'
           END-IF.
           SKIP1
       CE-PROCESO-SEGUN-PARAMETRO.
      *---------------------------
           MOVE TAR-COD-TIP            TO WB-REQ-OPC-KEY-1
           MOVE TAR-COD-OFI            TO WB-REQ-OPC-KEY-2
           MOVE TAR-COD-NUM            TO WB-REQ-OPC-KEY-3
           MOVE 'REDKG'                TO WB-REQ-OPC-CMD
           PERFORM CH-LEER-OPC
           MOVE 'REDNX'                TO WB-REQ-OPC-CMD

           IF (WB-REQ-OPC-RC = '  ')
               EVALUATE TRUE
                 WHEN TAR-OFI-OK
                      PERFORM CF-ACTUALIZA-MAESTRO
                        UNTIL (OPC-COD-TOPC  NOT = TAR-COD-TIP OR
                               WB-REQ-OPC-RC NOT = '  '        OR
                               WS-PROCESO-NO-OK)
                 WHEN TAR-NUM-OK
                      PERFORM CF-ACTUALIZA-MAESTRO
                        UNTIL (OPC-COD-TOPC  NOT = TAR-COD-TIP OR
                               OPC-COD-COPC  NOT = TAR-COD-OFI OR
                               WB-REQ-OPC-RC NOT = '  '        OR
                               WS-PROCESO-NO-OK)
                 WHEN OTHER
                      PERFORM CF-ACTUALIZA-MAESTRO
                        UNTIL (OPC-COD-TOPC  NOT = TAR-COD-TIP OR
                               OPC-COD-COPC  NOT = TAR-COD-OFI OR
                               OPC-IIC-IOPC  NOT = TAR-COD-NUM OR
                               WB-REQ-OPC-RC NOT = '  '        OR
                               WS-PROCESO-NO-OK)
                 END-EVALUATE
           END-IF.
           SKIP1
       CF-ACTUALIZA-MAESTRO.
      *---------------------
           ADD 1                       TO WA-L-OPC
           SET WS-NO-EXISTE-DIF        TO TRUE

           IF (OPC-MSC-STAT = 'A' AND OPC-VAL-SCRE > 0)
           PERFORM CL-LEER-DLC
           IF (WB-REQ-DLC-RC = '  ')
               PERFORM CM-LEER-DCC
               IF (WB-REQ-DLC-RC = '  ')
                   PERFORM CG-POS-Y-LEER-CREM002
                   IF (WR-FS-CREM002 = 0)
                       ADD 1           TO WA-LEIDOS
                       PERFORM CJ-LLENA-CAMPOS
                       IF (WS-EXISTE-DIF)
                           ADD 1       TO WA-DIFERE
                           IF (TAR-ACT-SI)
                               PERFORM CK-REGRABA-CREM002
                           END-IF
                       ELSE
                           ADD 1       TO WA-IGUALE
                       END-IF
                   ELSE
                       DISPLAY '** NO EXISTE EN CREDITO : ' OPC-CIC-IOPC
                       ADD 1           TO WA-NOEXIS
                   END-IF
               ELSE
                   DISPLAY '** NO EXISTE EN DCC KEY-OPC : ' OPC-CIC-IOPC
                   '   KEY-DCC : ' WB-REQ-DCC-KEY-VALUE
                   ADD 1               TO WA-DLCDCC
               END-IF
           ELSE
               ADD 1                   TO WA-DLCDCC
               DISPLAY '** NO EXISTE EN DCC KEY-OPC : ' OPC-CIC-IOPC
               '   KEY-DLC : ' WB-REQ-DLC-KEY-VALUE
           END-IF
           END-IF

           IF (WS-EXISTE-DIF)
               IF (WA-LINEA > 50)
                   ADD 1               TO WA-PAGINA
                   MOVE WA-PAGINA      TO WR-LA02-PAGINA
                   WRITE COLR695 FROM WR-LINEA01 AFTER PAGE
                   WRITE COLR695 FROM WR-LINEA02 AFTER 1
                   WRITE COLR695 FROM WR-LINEA03 AFTER 2
                   WRITE COLR695 FROM WR-LINEA04 AFTER 1
                   WRITE COLR695 FROM WR-LINEA05 AFTER 1
                   WRITE COLR695 FROM WR-LINEA06 AFTER 1
                   WRITE COLR695 FROM WR-LINEA03 AFTER 1
                   MOVE 0              TO WA-LINEA
               END-IF
               WRITE COLR695 FROM WR-LINEA07 AFTER 1
               ADD 1                   TO WA-LINEA
           END-IF.

           PERFORM CH-LEER-OPC.
           SKIP1
       CG-POS-Y-LEER-CREM002.
      *----------------------
           MOVE OPC-CIC-IOPC           TO WR-CIC-IOPE
           MOVE DCC-CIC-TCCT IN DCC    TO WR-CIC-OOPE
           MOVE WR-CIC-IOPE-D          TO CRE-CLAVE
           START CREM002 KEY IS > CRE-CLAVE
             INVALID KEY MOVE 23       TO WR-FS-CREM002.
           IF (WR-FS-CREM002 = 0)
               PERFORM CI-LEER-CREM002
               MOVE CRE-SUCURSAL       TO WR-CIC-SUCU-X
               MOVE CRE-CODIGO-OPER    TO WR-CIC-CODI-X
               IF (WR-FS-CREM002 = 0 AND WR-CIC-IOPE-D = WR-CIC-IOPE-X)
                  NEXT SENTENCE
               ELSE
                  MOVE 23 TO WR-FS-CREM002
               END-IF
           END-IF.
           SKIP1
       CH-LEER-OPC.
      *------------
           MOVE SPACES                 TO WB-REQ-OPC-RC
           MOVE 'OPC00'                TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-OPC-AREA OPC WB-ELEM-LIS
           IF (WB-REQ-OPC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'         TO WR-SECCION
               MOVE 'CH-LEER-OPC'        TO WR-PARRAFO
               MOVE 'OPC'                TO WR-ARCHIVO
               MOVE WB-REQ-OPC-CMD       TO WR-OPERACI
               MOVE WB-REQ-OPC-RC        TO WR-FILE-ST
               MOVE WB-REQ-OPC-KEY-VALUE TO WR-MENSAJE
               PERFORM BC-DISPLAY-ERROR
           END-IF.
           SKIP1
       CI-LEER-CREM002.
      *----------------
           READ CREM002 NEXT END-READ
           IF WR-FS-CREM002 NOT = 0 AND NOT = 10 AND NOT = 23
              MOVE 'C-PROCESAR'        TO WR-SECCION
              MOVE 'CI-LEER-CREM002'   TO WR-PARRAFO
              MOVE 'CREM002    '       TO WR-ARCHIVO
              MOVE 'READ       '       TO WR-OPERACI
              MOVE WR-FS-CREM002       TO WR-FILE-ST
              PERFORM BC-DISPLAY-ERROR
           END-IF.
           SKIP1
       CJ-LLENA-CAMPOS.
      *----------------
           MOVE SPACES                 TO WR-LINEA07
           MOVE CRE-CLAVE              TO WR-LA07-NUM-OPE
           MOVE OPC-COD-CDOC           TO WR-DESTINO
           IF (TAR-CAM-1-OK  AND CRE-DESTINO NOT = WR-DESTINO)
               MOVE '/'                TO WR-LA07-DES-GUI
               MOVE CRE-DESTINO        TO WR-LA07-DES-ANT
               MOVE WR-DESTINO         TO WR-LA07-DES-DPS
                                          CRE-DESTINO
               SET WS-EXISTE-DIF       TO TRUE
           END-IF.
           SKIP1
       CK-REGRABA-CREM002.
      *-------------------
           REWRITE CRE-CREDITOS-REG END-REWRITE
           IF WR-FS-CREM002 NOT = 0
              MOVE 'C-PROCESAR'         TO WR-SECCION
              MOVE 'CK-REGRABA-CREM002' TO WR-PARRAFO
              MOVE 'CREM002    '        TO WR-ARCHIVO
              MOVE 'REWRITE    '        TO WR-OPERACI
              MOVE WR-FS-CREM002        TO WR-FILE-ST
              PERFORM BC-DISPLAY-ERROR
           END-IF.
           SKIP1
       CL-LEER-DLC.
      *------------
           MOVE  OPC-CIC-IOPC          TO WB-REQ-DLC-KEY-1
           MOVE  '001'                 TO WB-REQ-DLC-KEY-2
           MOVE SPACES                 TO WB-REQ-DLC-RC
           MOVE 'DLC00'                TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DLC-AREA DLC WB-ELEM-LIS
           IF (WB-REQ-DLC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'         TO WR-SECCION
               MOVE 'CH-LEER-DLC'        TO WR-PARRAFO
               MOVE 'DLC'                TO WR-ARCHIVO
               MOVE WB-REQ-DLC-CMD       TO WR-OPERACI
               MOVE WB-REQ-DLC-RC        TO WR-FILE-ST
               MOVE WB-REQ-DLC-KEY-VALUE TO WR-MENSAJE
               PERFORM BC-DISPLAY-ERROR
           END-IF.
           SKIP1
       CM-LEER-DCC.
      *------------
           MOVE 'DCC'                  TO DCC-COD-TTAB IN DCC
           MOVE 'CAP'                  TO DCC-MSC-TCCT IN DCC
           MOVE  OPC-COD-VCOC IN OPC   TO DCC-COD-VCAM IN DCC
           MOVE  OPC-COD-TOOC IN OPC   TO DCC-COD-TOCR IN DCC
           MOVE  OPC-COD-AOOC IN OPC   TO DCC-COD-AOCR IN DCC
           MOVE  DLC-COD-PLZO IN DLC   TO DCC-COD-PLZO IN DCC
           MOVE  DLC-IND-SCRT IN DLC   TO DCC-IND-SCRT IN DCC
           IF (DLC-IND-SCTB IN DLC = 'MUL')
               MOVE SPACES              TO DCC-IND-SCTB IN DCC
           ELSE
               MOVE DLC-IND-SCTB IN DLC TO DCC-IND-SCTB IN DCC
           END-IF
           MOVE  DLC-IND-SCBZ IN DLC   TO DCC-IND-SCBZ IN DCC
           MOVE  DCC-COD-TABL IN DCC   TO WB-REQ-DCC-KEY-VALUE
           MOVE SPACES                 TO WB-REQ-DCC-RC
           MOVE 'DCC00'                TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DCC-AREA DCC WB-ELEM-LIS
           IF (WB-REQ-DCC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'         TO WR-SECCION
               MOVE 'CH-LEER-DCC'        TO WR-PARRAFO
               MOVE 'DCC'                TO WR-ARCHIVO
               MOVE WB-REQ-DCC-CMD       TO WR-OPERACI
               MOVE WB-REQ-DCC-RC        TO WR-FILE-ST
               MOVE WB-REQ-DCC-KEY-VALUE TO WR-MENSAJE
               PERFORM BC-DISPLAY-ERROR
           END-IF.
           SKIP1
       CZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       D-TERMINAR SECTION.
      *===================
       DA-ESTADISTICAS.
      *----------------
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'INFORMES'
           DISPLAY '--------'
           DISPLAY ' '
           IF WS-PROCESO-OK
               DISPLAY 'COLL695, EMITIDO EN FORMA LOCAL PARA OFICINA'
               DISPLAY '090 L'
           ELSE
               DISPLAY 'COLL695 NO EMITIDO O INCOMPLETO'
           END-IF
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'ESTADISTICAS DE PROCESO PROGRAMA COLPB695 FECHA '
                    WR-FECHA-HOY
           DISPLAY '-----------------------------------------------'
           DISPLAY '      ACTUALIZACION MAESTRO CREDITOS'
           DISPLAY ' '
           DISPLAY 'TARJETAS PARAMETROS LEIDOS     : ' WA-L-TAR
           DISPLAY 'REG LEIDOS OPC                 : ' WA-L-OPC
           DISPLAY 'NO EXISTEN REL OPC --> DLC/DCC : ' WA-DLCDCC
           DISPLAY 'NO EXISTEN EN MAESTRO CREDITOS : ' WA-NOEXIS
           DISPLAY 'LEIDOS DEL MAESTRO CREDITOS    : ' WA-LEIDOS
           DISPLAY 'REG IGUALES OPC/CREDITOS       : ' WA-IGUALE
           DISPLAY 'REG DIFERENTES OPC/CREDITOS    : ' WA-DIFERE
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'TARJETAS DE PARAMETROS'
           DISPLAY '----------------------'
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'MENSAJES PARA EL EXPLOTADOR'
           DISPLAY '---------------------------'
           DISPLAY ' '
           IF WS-PROCESO-OK
               DISPLAY 'NO HAY MENSAJES PARA EL EXPLOTADOR'
           ELSE
               DISPLAY 'HAY MENSAJES PARA EL EXPLOTADOR'
           END-IF
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '.
           SKIP1
       DC-TERMINO.
      *-----------
           CLOSE CREM002 COLL695 COLVTAR.
           IF WS-PROCESO-NO-OK
              MOVE 100 TO RETURN-CODE
              DISPLAY ' '
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
              DISPLAY '********                              ********'
              DISPLAY '******** TERMINO ERRONEO DEL PROCESO  ********'
              DISPLAY '********                              ********'
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
           ELSE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*****PROCESO TERMINO EN FORMA NORMAL*****'
           END-IF.
           SKIP1
       DZ-FIN-DE-SECCION.
      *------------------
           EXIT.
