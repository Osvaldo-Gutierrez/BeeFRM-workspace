       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGDEO.
       AUTHOR.          BEE (JGM).
       DATE-WRITTEN.    09-SEP-1998.

      * Programa Generador de Archivo DSQ con OPC del dia.
      * DEUDOR OPERACION
      * OPTIMIZA EL PROGRAMA COLPGDCO.
       ENVIRONMENT DIVISION.
      *====================

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ESC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-FIA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-FIA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AMF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
      *>>>>
      *<<<< WSS
       COPY COLBRDSQ.
       COPY COLBRCRC.
      *COPY SGCBRDBC.
      *
       COPY COLBROPC.
       COPY COLBRRDC.
       COPY COLBRDLC.
       COPY COLBRRDT.
       COPY COLBRRDE.
      *
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
      *
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGELS.
       COPY GNSWGHOY.
       COPY GNSWGPES.
      *
       COPY GNSWVIDD.
       COPY GNSWVFIO.
      *
       COPY GNSWCFIO.
       COPY TABBRCAM.
       COPY SGCBRREC.
      *
       COPY DEUBRESC.
       COPY DEUBRFIA.
       COPY DEUBRAMF.
       COPY DEUWGDEU.

       01  WSS-VARI.
      * Variables para estadisticas
           03  WSS-NUM-RLEI       VALUE ZEROES      PIC 9(06).
           03  WSS-NUM-RGRA       VALUE ZEROES      PIC 9(06).
           03  WSS-NUM-RRCH       VALUE ZEROES      PIC 9(06).
           03  WSS-NUM-RORC       VALUE ZEROES      PIC 9(06).
           03  WSS-NUM-REXI       VALUE ZEROES      PIC 9(06).

      * Monto parametro
           03  WSS-VAL-MPAR       VALUE ZEROES      PIC 9(14).
           03  WSS-VAL-DEUT       VALUE ZEROES      PIC 9(14).
           03  WSS-VAL-DEDI       VALUE ZEROES      PIC 9(14)V9(02).
           03  WSS-VAL-DEIN       VALUE ZEROES      PIC 9(14)V9(02).
           03  WSS-VAL-DECO       VALUE ZEROES      PIC 9(14)V9(02).
           03  WSS-VAL-DEFI       VALUE ZEROES      PIC 9(14)V9(02).
      *
           03  WSS-FEC-FINI.
               05  WSS-NUM-SINI                     PIC 9(02).
               05  WSS-NUM-AINI                     PIC 9(02).
               05  WSS-NUM-MINI                     PIC 9(02).
               05  WSS-NUM-DINI                     PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                     PIC 9(02).
               05  WSS-NUM-ATER                     PIC 9(02).
               05  WSS-NUM-MTER                     PIC 9(02).
               05  WSS-NUM-DTER                     PIC 9(02).

      *
           03  WSS-CIC-IOPC       VALUE SPACES      PIC X(12).
           03  WSS-CIC-DEUD       VALUE SPACES      PIC X(12).
           03  WSS-CIC-ICLI       VALUE SPACES      PIC X(12).
           03  WSS-VAL-TPES       VALUE ZEROES      PIC 9(13)V9(02).
           03  WSS-IND-FLAG       VALUE ZEROES      PIC 9(01).
           03  WSS-IND-DISP       VALUE SPACES      PIC X(01).
           03  WSS-IND-EDSQ       VALUE SPACES      PIC X(01).
           03  WSS-IND-PROC       VALUE SPACES      PIC X(01).
           03  WSS-NUM-IDLC       VALUE ZEROES      PIC 9(03).
           03  WSS-NUM-TREC       VALUE ZEROES      PIC 9(02).
      *CONTADORES
           03  WSS-NUM-LCRC       VALUE ZEROES      PIC 9(05).
           03  WSS-NUM-TREC       VALUE ZEROES      PIC 9(02).

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPGDEO' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM OPEN-FILE.
           PERFORM OBT-PARAM.
           PERFORM PROCESA-CRC.
           PERFORM CLOSE-FILE.
           PERFORM MUESTRA-ESTADISTICAS.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

      ******************************************************************
       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-CRC.

           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-RDC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-DSQ.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR ABRIENDO COLDSQ: ' FIO-STAT
               PERFORM GNS-PRO-ABT.
       FIN-OPEN-FILE.
           EXIT.


      ******************************************************************
       OBT-PARAM SECTION.
      *-----------------
       INI-OBT-PARAM.
           PERFORM GET-FHOY.
           DISPLAY 'ACEPTA PARAMETROS.'
           DISPLAY '------------------'
           DISPLAY ' '.
           ACCEPT   WSS-VAL-MPAR IN WSS-VARI.
           DISPLAY 'MONTO PARAMETRO: ' WSS-VAL-MPAR IN WSS-VARI.
           DISPLAY ' '.
      *
           ACCEPT   WSS-FEC-FINI IN WSS-VARI.
           DISPLAY 'FECHA DE INICIO: ' WSS-FEC-FINI IN WSS-VARI.
           DISPLAY ' '.
      *
           ACCEPT   WSS-FEC-FTER IN WSS-VARI.
           DISPLAY 'FECHA DE TERMINO: ' WSS-FEC-FTER IN WSS-VARI.
           DISPLAY ' '.
      *
           ACCEPT WSS-IND-DISP IN WSS-VARI.
           DISPLAY 'IND. DISPLAY (S/N): ' WSS-IND-DISP IN WSS-VARI.
           DISPLAY ' '.
      *
           IF NOT (WSS-IND-DISP IN WSS-VARI  = 'S' OR  'N' )
               DISPLAY 'ASUME IND. DE DISPLAY = N'
               MOVE 'N' TO WSS-IND-DISP IN WSS-VARI.
      *
      *
           ACCEPT WSS-IND-PROC IN WSS-VARI.
           DISPLAY 'IND. PROCESO/REPROCESO: ' WSS-IND-PROC IN WSS-VARI.
           IF WSS-IND-PROC IN WSS-VARI NOT = 'P' OR 'R'
               MOVE 'P' TO WSS-IND-PROC IN WSS-VARI
               DISPLAY 'ASUME INDICADOR DE PROCESO: '
                                       WSS-IND-PROC IN WSS-VARI.
       FIN-OBT-PARAM.
           EXIT.


      ******************************************************************
       PROCESA-CRC SECTION.
      *-------------------
       INI-PROCESA-CRC.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-CRC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO HAY CLINETES EN CRC '
               MOVE 0 TO RETURN-CODE
               GOBACK.

           MOVE SPACES              TO WSS-CIC-ICLI IN WSS-VARI.
       LUP-PROCESA-CRC.
           IF NOT  FIO-STAT-OKS
              GO TO FIN-PROCESA-CRC.
      *
           IF CRC-CIC-ICLI IN CRC = WSS-CIC-ICLI IN WSS-VARI
               GO TO NXT-PROCESA-CRC
      *
           ADD  1                   TO WSS-NUM-LCRC IN WSS-VARI.
           MOVE ZEROES              TO WSS-IND-FLAG IN WSS-VARI.
           MOVE CRC-CIC-ICLI IN CRC TO WSS-CIC-ICLI IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'REG.CRC LEIDO: ' CRC-CIC-ICLI IN CRC.

           MOVE ZEROES TO WSS-VAL-DEUT IN WSS-VARI
                          WSS-VAL-DEDI IN WSS-VARI
                          WSS-VAL-DEIN IN WSS-VARI
                          WSS-VAL-DECO IN WSS-VARI
                          WSS-VAL-DEFI IN WSS-VARI.

           PERFORM BUS-CLIENTE-DSQ.
           IF WSS-IND-EDSQ IN WSS-VARI = 'S'
              GO TO  NXT-PROCESA-CRC.

       CAL-DEU-CLI.
      * Calcula Deuda total del cliente con rutina de choque de deudas
           MOVE WSS-CIC-ICLI IN WSS-VARI TO WSS-CIC-DEUD IN WSS-VARI.
           PERFORM CAL-DEUDA-TOTAL.
      *
           IF WSS-IND-FLAG IN WSS-VARI = 1
              ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
              GO TO NXT-PROCESA-CRC.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CLIENTE: '    WSS-CIC-ICLI IN WSS-VARI
               DISPLAY ' D-TOTAL '    WSS-VAL-DEUT IN WSS-VARI
                       ' D-DIRECTA: ' WSS-VAL-DEDI IN WSS-VARI.

           IF WSS-VAL-DEUT IN WSS-VARI     < WSS-VAL-MPAR OR
              WSS-VAL-DEDI IN WSS-VARI NOT > ZEROES
                 ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
                 GO TO NXT-PROCESA-CRC.

      * GRABA  EN ARCHIVO DSQ, MAS LA FECHA DE PROCESO
           PERFORM GRABA-OPC-DSQ.

       NXT-PROCESA-CRC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CRC.
           IF FIO-STAT-OKS
               GO TO LUP-PROCESA-CRC.
       FIN-PROCESA-CRC.
           EXIT.

       BUS-CLIENTE-DSQ SECTION.
       INI-BUS-CLIENTE-DSQ.
      * SI REGI. EXISTE EN DSQ, NO CALCULA DEUDA Y LEE SIG. REG
           MOVE 'N'             TO WSS-IND-EDSQ IN WSS-VARI.
           MOVE WSS-CIC-ICLI IN WSS-VARI TO DSQ-CIC-DEUD IN DSQ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DSQ.
           IF NOT FIO-STAT-OKS
              GO TO  FIN-BUS-CLIENTE-DSQ.
      *
           MOVE 'S'  TO  WSS-IND-EDSQ IN WSS-VARI.
      *
           ADD 1 TO WSS-NUM-REXI IN WSS-VARI
           IF WSS-IND-DISP IN WSS-VARI NOT = 'S'
               GO TO FIN-BUS-CLIENTE-DSQ.

           DISPLAY 'REG. EXISTE EN DSQ (NO SE GRABA): '
                    DSQ-CIC-DEUD IN DSQ.
       FIN-BUS-CLIENTE-DSQ.
           EXIT.
      ******************************************************************
       CAL-DEUDA-TOTAL SECTION.
      *------------------------
       INI-CAL-DEUDA-TOTAL.
      * Llama a rutina de choque de deudas
      *    MOVE WSS-CIC-DEUD IN WSS-VARI TO DBC-CIC-ICLI IN DBC.
      *    MOVE FIO-GET-KEY TO FIO-CMND.
      *    PERFORM SGC-FIO-DBC.
      *    IF FIO-STAT-OKS AND
      *       DEU-CIC-ICLI IN DEU = DBC-CIC-ICLI IN DBC
      *       DISPLAY ' '
      *       DBC-IDC-ICLI IN DBC 'DIGITO : '
      *       DBC-VRF-ICLI IN DBC .
      *
           PERFORM PRO-INI-WGDEU.
           MOVE 'R'                      TO DEU-FPRO IN DEU.
           MOVE WSS-CIC-DEUD IN WSS-VARI TO DEU-CIC-ICLI IN DEU.
           MOVE HOY-FHOY                 TO DEU-FEC-FPRO.
           PERFORM INI-CAM.
           PERFORM CAL-DEU.
      *
           IF DEU-STAT NOT = DEU-STAT-OKS
              MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
              IF WSS-IND-DISP IN WSS-VARI NOT = 'S'
                 GO TO FIN-CAL-DEUDA-TOTAL
              ELSE
                 DISPLAY 'ERROR RUT.CHOQUE DEUDA: ' DEU-STAT
                 GO TO FIN-CAL-DEUDA-TOTAL.

      * Obtiene valores de rutina de choque mediante registro RDE
           MOVE ZERO        TO DEU-R.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DEU-FIO-RDE.
           IF NOT  FIO-STAT-OKS
              MOVE ZEROES TO WSS-VAL-DEUT IN WSS-VARI
              MOVE 1      TO WSS-IND-FLAG IN WSS-VARI
              DISPLAY 'ERROR LECTURA DEURDE: ' FIO-STAT
              GO TO FIN-CAL-DEUDA-TOTAL.
      *
           IF NOT( RDE-CIC-ICLI IN RDE = WSS-CIC-DEUD IN WSS-VARI)
               MOVE ZEROES TO WSS-VAL-DEUT IN WSS-VARI
               MOVE 1      TO WSS-IND-FLAG IN WSS-VARI

               IF WSS-IND-DISP IN WSS-VARI NOT = 'S'
                   GO TO FIN-CAL-DEUDA-TOTAL
               ELSE
                   DISPLAY 'ERROR CIC-ICLI: '
                           ' ' WSS-CIC-DEUD IN WSS-VARI
                           ' ' RDE-CIC-ICLI IN RDE
                   GO TO FIN-CAL-DEUDA-TOTAL.

       LUP-CAL-DEUDA-TOTAL.
           IF RDE-COD-VCCR IN RDE NOT > SPACES OR
              RDE-COD-VCCR IN RDE = CAM-COD-MNAC
               MOVE RDE-VAL-DEUD IN RDE TO WSS-VAL-TPES IN WSS-VARI
               GO TO SUM-DEUDAD-DEU.
      *
            MOVE ZEROES              TO WSS-VAL-TPES IN WSS-VARI.
            MOVE RDE-COD-VCCR IN RDE TO CAM-COD-VCAM IN CAM(1).
            PERFORM GET-CAM.
            IF FIO-STAT-OKS
               IF CAM-IND-VIGE IN CAM = 'S'
                   MULTIPLY RDE-VAL-DEUD IN RDE BY
                            CAM-SGV-VCAM IN CAM
                   GIVING   WSS-VAL-TPES IN WSS-VARI.
      *
       SUM-DEUDAD-DEU.
           IF RDE-IND-TIPD IN RDE = 'DIR'
               ADD WSS-VAL-TPES IN WSS-VARI TO WSS-VAL-DEDI IN WSS-VARI
           ELSE
           IF RDE-IND-TIPD IN RDE = 'IND'
               ADD WSS-VAL-TPES IN WSS-VARI TO WSS-VAL-DEIN IN WSS-VARI
           ELSE
           IF RDE-IND-TIPD IN RDE = 'COM'
               ADD WSS-VAL-TPES IN WSS-VARI TO WSS-VAL-DECO IN WSS-VARI
           ELSE
           IF RDE-IND-TIPD IN RDE = 'FIA'
              ADD WSS-VAL-TPES IN WSS-VARI TO WSS-VAL-DEFI IN WSS-VARI.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-RDE.
           IF FIO-STAT-OKS AND
              RDE-CIC-ICLI IN RDE = WSS-CIC-DEUD IN WSS-VARI
              GO TO LUP-CAL-DEUDA-TOTAL.

      *        Calcula Deuda Total = D. Dir + D. Ind + (D. Com + D. Fia)
      * La deuda se maneja en pesos para estandarizarla
           COMPUTE WSS-VAL-DEUT IN WSS-VARI ROUNDED =
                              ( WSS-VAL-DEDI IN WSS-VARI +
                                WSS-VAL-DEIN IN WSS-VARI +
                                WSS-VAL-DECO IN WSS-VARI +
                                WSS-VAL-DEFI IN WSS-VARI ).
      *
       FIN-CAL-DEUDA-TOTAL.
           EXIT.


      ******************************************************************
       GRABA-OPC-DSQ SECTION.
      *---------------------
       INI-GRABA-OPC-DSQ.
           MOVE WSS-CIC-DEUD IN WSS-VARI TO DSQ-CIC-DEUD IN DSQ.
           MOVE SPACES                   TO DSQ-GLS-DISP IN DSQ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-DSQ.
           IF  FIO-STAT-OKS
               ADD 1 TO WSS-NUM-RGRA IN WSS-VARI
               GO TO FIN-GRABA-OPC-DSQ.

           IF  WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'ERROR DSQ :' FIO-STAT
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI.

           IF FIO-STAT = 48  AND WSS-NUM-RGRA IN WSS-VARI = ZERO
              MOVE FIO-CLO TO FIO-CMND
              PERFORM COL-FIO-DSQ
      *
              MOVE FIO-OUT TO FIO-CMND
              PERFORM COL-FIO-DSQ
              MOVE WSS-CIC-DEUD IN WSS-VARI TO DSQ-CIC-DEUD IN DSQ
              MOVE SPACES                   TO DSQ-GLS-DISP IN DSQ
              MOVE FIO-PUT TO FIO-CMND
              PERFORM COL-FIO-DSQ
              IF NOT FIO-STAT-OKS
                 DISPLAY 'ERROR GRABAR COLDSQ: ' FIO-STAT
                 PERFORM GNS-PRO-ABT
              ELSE
                 MOVE FIO-CLO TO FIO-CMND
                 PERFORM COL-FIO-DSQ
      *
                 MOVE FIO-UPD TO FIO-CMND
                 PERFORM COL-FIO-DSQ
                 IF NOT FIO-STAT-OKS
                    DISPLAY 'ERROR ABRIENDO COLDSQ: ' FIO-STAT
                    PERFORM GNS-PRO-ABT.
       FIN-GRABA-OPC-DSQ.
           EXIT.


      ******************************************************************


      ******************************************************************
       CLOSE-FILE SECTION.
      *------------------
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-CRC.

           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-RDC.
           PERFORM COL-FIO-DSQ.
       FIN-CLOSE-FILE.
           EXIT.


      ******************************************************************
       MUESTRA-ESTADISTICAS SECTION.
      *----------------------------
       INI-MUESTRA-ESTADISTICAS.
           DISPLAY 'ESTADISTICAS DEL PROCESO.'.
           DISPLAY '-------------------------'.
           DISPLAY ' '.
           DISPLAY 'REGISTROS (CLIENTES) GRABADOS DSQ      : '
                                  WSS-NUM-RGRA IN WSS-VARI.
           DISPLAY 'REGISTROS (CLIENTES) EXISTENTES EN DSQ : '
                                  WSS-NUM-REXI IN WSS-VARI.
           DISPLAY 'OPERACIONES RECHAZADOS                 : '
                                  WSS-NUM-RORC IN WSS-VARI.
           DISPLAY 'CLIENTES RECHAZADOS                    : '
                                  WSS-NUM-RRCH IN WSS-VARI.
      *                            WSS-NUM-REXI IN WSS-VARI.
       FIN-MUESTRA-ESTADISTICAS.
           EXIT.


       COPY COLBFDSQ.
       COPY COLBFCRC.
      *COPY SGCBFDBC.
      *
       COPY COLBFRDC.
       COPY COLBFRDT.

       COPY DEUWGIDE.
       COPY DEUBCDEU.

       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
      *
       COPY GNSBPFEC.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBBSYS.
      *
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGPES.
       COPY GNSBGEND.
       COPY GNSBGABT.
      *
       COPY GNSBTABT.
       COPY TABBFCAM.
       COPY TABBGCAM.
       COPY SGCBFREC.
      *
       COPY DEUBFESC.
       COPY DEUBFFIA.
       COPY DEUBFAMF.


      * COPY DEUBFRDE.
       DEU-FIO-RDE SECTION.
       INI-DEU-FIO-RDE.
           PERFORM GET-RDE.
       FIN-DEU-FIO-RDE.
           EXIT.

       GET-RDE SECTION.
       INI-GET-RDE.
           MOVE '00' TO FIO-STAT.
           IF FIO-CMND = FIO-GET-PRV  OR
              FIO-CMND = FIO-GET-LEQ
               SUBTRACT 1 FROM DEU-R
               IF DEU-R NOT > ZEROES
                   MOVE '10' TO FIO-STAT
                   GO TO FIN-GET-RDE
               ELSE
                   NEXT SENTENCE
           ELSE
               ADD 1 TO DEU-R
               IF DEU-R > DEU-RMAX
                  IF  DEU-RMAX = ZEROES
                      MOVE '11' TO FIO-STAT
                      GO TO FIN-GET-RDE
                  ELSE
                      MOVE '12' TO FIO-STAT
                      GO TO FIN-GET-RDE.
           IF DEU-R > 50
               MOVE '14' TO FIO-STAT
               GO TO FIN-GET-RDE.
           MOVE DEU-CIC-ICLI IN DEU        TO RDE-CIC-ICLI IN RDE.
           MOVE RDE-IND-TIPD IN DEU(DEU-R) TO RDE-IND-TIPD IN RDE.
           MOVE RDE-IND-SCRT IN DEU(DEU-R) TO RDE-IND-SCRT IN RDE.
           MOVE RDE-IND-SCTB IN DEU(DEU-R) TO RDE-IND-SCTB IN RDE.
           MOVE RDE-IND-SCBZ IN DEU(DEU-R) TO RDE-IND-SCBZ IN RDE.
           MOVE RDE-COD-COCR IN DEU(DEU-R) TO RDE-COD-COCR IN RDE.
           MOVE RDE-COD-VCCR IN DEU(DEU-R) TO RDE-COD-VCCR IN RDE.
           MOVE RDE-COD-OFCR IN DEU(DEU-R) TO RDE-COD-OFCR IN RDE.
           MOVE RDE-VAL-DEUD IN DEU(DEU-R) TO RDE-VAL-DEUD IN RDE.
      *    MOVE RDE-VAL-DPES IN DEU(DEU-R) TO RDE-VAL-DPES IN RDE.
       FIN-GET-RDE.
           EXIT.

      *
      *COPY COLBFOPC.
      * Modulo FIO para registro OPC en DATACOM, 25-MAR-1993 10:00:37.98
       COL-FIO-OPC SECTION.
       INI-COL-FIO-OPC.
           MOVE ADR-OPC-REQA TO ADR-REQA.
           MOVE 'OPC' TO ADR-TABL IN ADR-REQA.
      *
      * DPM ini  1-JUL-1998 10:01:57
           IF WSS-IND-PROC IN WSS-VARI = 'R'
               MOVE +162 TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-OPC.
      * DPM fin  1-JUL-1998

           MOVE 'COL'  TO IDD-SAUX.
           MOVE 'M'    TO IDD-GAUX.
           MOVE SPACES TO IDD-RAUX.
           MOVE 1 TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               GO TO GRP-COL-FIO-OPC
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-OPC.
       GRP-COL-FIO-OPC.
           MOVE SPACES TO IDD-GAUX.
           MOVE 1      TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               MOVE 'En COL-FIO-OPC, NO existe en IDD:' TO FIO-MEN1
               MOVE IDD-DAUX                            TO FIO-MEN2
               PERFORM PRG-ABT
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA.
       FSR-COL-FIO-OPC.
      *
           MOVE 'OPC00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           IF FIO-KDEF = FIO-KDEF-S
               GO TO CON-COL-FIO-OPC.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'OPC-KEY-IOPC' OR FIO-AKEY NOT > SPACES )
               MOVE OPC-KEY-IOPC IN OPC TO ADR-VKEY IN ADR-REQA
               MOVE 'OPC00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'OPC-FEC-FCOL'
               MOVE OPC-FEC-FCOL IN OPC TO ADR-VKEY IN ADR-REQA
               MOVE 'OPC01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'OPC-FEC-FING'
               MOVE OPC-FEC-FING IN OPC TO ADR-VKEY IN ADR-REQA
               MOVE 'OPC02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'OPC-FEC-FINP'
               MOVE OPC-FEC-FINP IN OPC TO ADR-VKEY IN ADR-REQA
               MOVE 'OPC03' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En COL-FIO-OPC, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.
       CON-COL-FIO-OPC.
           MOVE OPC TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO OPC
           ELSE
               MOVE 'COLOPC' TO FIO-MEN2
               IF FIO-STAT-FTL
                   PERFORM PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE FIO-KDEF-N TO FIO-KDEF.
           MOVE ADR-REQA TO ADR-OPC-REQA.
       FIN-COL-FIO-OPC.
           EXIT.


      *COPY COLBFDLC.
      * Modulo FIO para registro DLC en DATACOM, 25-MAR-1993 09:59:30.49
       COL-FIO-DLC SECTION.
       INI-COL-FIO-DLC.
           MOVE ADR-DLC-REQA TO ADR-REQA.
           MOVE 'DLC' TO ADR-TABL IN ADR-REQA.
      *
      * DPM ini  1-JUL-1998 10:01:57
           IF WSS-IND-PROC IN WSS-VARI = 'R'
               MOVE +162 TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-DLC.
      * DPM fin  1-JUL-1998

           MOVE 'COL'  TO IDD-SAUX.
           MOVE 'M'    TO IDD-GAUX.
           MOVE SPACES TO IDD-RAUX.
           MOVE 1 TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               GO TO GRP-COL-FIO-DLC
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA
               GO TO FSR-COL-FIO-DLC.
       GRP-COL-FIO-DLC.
           MOVE SPACES TO IDD-GAUX.
           MOVE 1      TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               MOVE 'En COL-FIO-DLC, NO existe en IDD:' TO FIO-MEN1
               MOVE IDD-DAUX                            TO FIO-MEN2
               PERFORM PRG-ABT
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA.
       FSR-COL-FIO-DLC.
      *
           MOVE 'DLC00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           IF FIO-KDEF = FIO-KDEF-S
               GO TO CON-COL-FIO-DLC.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'DLC-KEY-IDLC' OR FIO-AKEY NOT > SPACES )
               MOVE DLC-KEY-IDLC IN DLC TO ADR-VKEY IN ADR-REQA
               MOVE 'DLC00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'DLC-IND-SCTB'
               MOVE DLC-IND-SCTB IN DLC TO ADR-VKEY IN ADR-REQA
               MOVE 'DLC01' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En COL-FIO-DLC, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.
       CON-COL-FIO-DLC.
           MOVE DLC TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO DLC
           ELSE
               MOVE 'COLDLC' TO FIO-MEN2
               IF FIO-STAT-FTL
                   PERFORM PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE FIO-KDEF-N TO FIO-KDEF.
           MOVE ADR-REQA TO ADR-DLC-REQA.
       FIN-COL-FIO-DLC.
           EXIT.



