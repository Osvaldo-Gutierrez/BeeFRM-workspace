       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPPRFO.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    8-JAN-1992 20:16:57.

      * Programa que prueba la rutina de reliquidacion
      * de credito con estructuras de calculo FO

       ENVIRONMENT DIVISION.
      *====================

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSBRMSG.
       COPY GNSBRTAB.
       COPY GNSBRMSC.
       COPY GNSWGPES.

       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRVEN.
       COPY COLBRICG.
       COPY TABBRCAM.

       COPY COLWGRFO.
       COPY COLWGINT.

       01  WSS-VARI.
           03 WSS-FPRO.
              05 WSS-DPRO                      PIC 9(02).
              05 WSS-MPRO                      PIC 9(02).
              05 WSS-SPRO                      PIC 9(02).
              05 WSS-APRO                      PIC 9(02).

       PROCEDURE DIVISION.
      *==================

       MAIN SECTION.
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPPRFO' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM PROCESO.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

       PROCESO SECTION.
       INI-PROCESO.
           ACCEPT WSS-FPRO.
           MOVE WSS-DPRO TO RFO-DPRO.
           MOVE WSS-MPRO TO RFO-MPRO.
           MOVE WSS-SPRO TO RFO-SPRO.
           MOVE WSS-APRO TO RFO-APRO.
           DISPLAY 'FECHA DE PROCESO : ' WSS-FPRO.
       LUP-PROCESO.
           ACCEPT OPC-CIC-IOPC.
           IF OPC-CIC-IOPC NOT > SPACES OR
              OPC-CIC-IOPC = '*'
               GO TO FIN-PROCESO.
      *Lee Operacion
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO EXISTE OPERACION : '
                       OPC-CIC-IOPC IN OPC
               GO TO LUP-PROCESO.
           DISPLAY 'OPERACION : ' OPC-CIC-IOPC.
      *Llama a la rutina que reliquida y revisa el codigo de mensaje
      *de retorno. La rutina solo recibe como INPUT el registro OPC,
      *revisa internamente que todas las estructuras sean FO ( si
      *el RFO-CMSG > SPACES significa que ocurrio un error )
           PERFORM COL-PRO-RFO.
           IF RFO-CMSG > SPACES
               MOVE 'COL'    TO MSG-COD-SIST
               MOVE RFO-CMSG TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC RFO-MENS.
      *
           GO TO LUP-PROCESO.
       FIN-PROCESO.
           EXIT.

       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY GNSBFMSC.
       COPY GNSBBMSG.
       COPY GNSBPFEC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGPES.

       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFVEN.
       COPY COLBFICG.
       COPY TABBFCAM.

       COPY COLBGRFO.
       COPY COLBGINT.
