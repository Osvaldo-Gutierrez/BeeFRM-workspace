       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPBLSG.
       AUTHOR.          BEE TEAM (ALD).
       DATE-WRITTEN.    25-DEC-1998
      *
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.


       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
      *<<<< WSS
       COPY COLBRVEN.
       COPY COLBROPC.
       COPY COLBRICG.
       COPY COLBRDLC.
       COPY COLBRRDC.
       COPY COLBRLSG.

       COPY SGCBRDBC.
       COPY SGCBRDCP.
       COPY SGCBRDCE.
       COPY SGCBRRCD.


       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY GNSBRCIC.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGCIC.
       COPY GNSWGFRM.
       01  WSS-VARI.
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 LSG-NUM-OPER       VALUE ZEROES     PIC 9(08).
           03 LSG-NUM-OPOK       VALUE ZEROES     PIC 9(08).

           03 LSG-NUM-DLER       VALUE ZEROES     PIC 9(08).
           03 LSG-NUM-DLOK       VALUE ZEROES     PIC 9(08).

           03 LSG-NUM-VEER       VALUE ZEROES     PIC 9(08).
           03 LSG-NUM-VEOK       VALUE ZEROES     PIC 9(08).

           03 LSG-NUM-ICER       VALUE ZEROES     PIC 9(08).
           03 LSG-NUM-ICOK       VALUE ZEROES     PIC 9(08).

           03 LSG-NUM-DBER       VALUE ZEROES     PIC 9(08).
           03 LSG-NUM-DBOK       VALUE ZEROES     PIC 9(08).

           03 LSG-NUM-RDER       VALUE ZEROES     PIC 9(08).
           03 LSG-NUM-RDOK       VALUE ZEROES     PIC 9(08).

           03 LSG-COD-MENS       VALUE SPACES     PIC X(12).

           03 LSG-REG-LEI        VALUE ZEROES     PIC 9(08).
           03 LSG-REG-DBCR       VALUE ZEROES     PIC 9(08).


       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPBLSG' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           PERFORM OPEN-FILE.
           PERFORM LEE-PARAM.
           PERFORM GRABA-LEASING.
           PERFORM CLOSE-FILE.
           PERFORM MUESTRA-ESTADISTICAS.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

      ******************************************************************
       MUESTRA-ESTADISTICAS SECTION.
       INI-MUESTRA-ESTADISTICAS.
           DISPLAY ' REGISTROS LEIDOS   : ' LSG-REG-LEI.
           DISPLAY ' OPC PROCESADAS OK  : ' LSG-NUM-OPOK.
           DISPLAY ' OPC ERRONEAS       : ' LSG-NUM-OPER.

           DISPLAY ' DLC PROCESADAS OK  : ' LSG-NUM-DLOK.
           DISPLAY ' DLC ERRONEAS       : ' LSG-NUM-DLER.

           DISPLAY ' VEN PROCESADAS OK  : ' LSG-NUM-VEOK.
           DISPLAY ' VEN ERRONEAS       : ' LSG-NUM-VEER.

           DISPLAY ' ICG PROCESADAS OK  : ' LSG-NUM-ICOK.
           DISPLAY ' ICG ERRONEAS       : ' LSG-NUM-ICER.

           DISPLAY ' RDC PROCESADAS OK  : ' LSG-NUM-RDOK.
           DISPLAY ' RDC ERRONEAS       : ' LSG-NUM-RDER.

           DISPLAY ' CLI PROCESADOS OK  : ' LSG-NUM-DBOK.
           DISPLAY ' CLI ERRONEOS       : ' LSG-NUM-DBER.
           DISPLAY ' CLI ACTUALIZADOS   : ' LSG-REG-DBCR.


       FIN-MUESTRA-ESTADISTICAS.
           EXIT.

       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-LSG.
       FIN-OPEN-FILE.
           EXIT.

       CLOSE-FILE SECTION.
      *-----------------
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-LSG.
       FIN-CLOSE-FILE.
           EXIT.


      ******************************************************************
       LEE-PARAM SECTION.
      *-----------------
       INI-LEE-PARAM.
           DISPLAY 'CAPTURA PARAMETROS'.
           DISPLAY ' '.

      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO (DDMMSSAA): '.
           ACCEPT WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.

      * Validacion de parametros
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR VALIDACION FECHA DE PROCESO: '
                                                    FEC-MENS
               PERFORM GNS-PRO-ABT.
       FIN-LEE-PARAM.
           EXIT.
       COPY COLBFLSG.
       COPY COLBFVEN.
       COPY COLBFOPC.
       COPY COLBFICG.
       COPY COLBFDLC.
       COPY COLBFRDC.

       COPY SGCBFDBC.
       COPY SGCBFDCP.
       COPY SGCBFDCE.
       COPY SGCBFRCD.

       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY GNSBFCIC.

       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.

       COPY GNSBBCIC.
       COPY GNSBBVRF.
       COPY GNSBBMSG.


       GRABA-LEASING SECTION.
       INI-GRABA-LEASING.
           MOVE LOW-VALUES TO LSG.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-LSG.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTEN REGISTROS EN LSG'
               GO TO FIN-GRABA-LEASING.

       LUP-GRABA-LEASING.

           IF NOT FIO-STAT-OKS
               GO TO OUT-GRABA-LEASING.

           PERFORM CHK-PNT.

           MOVE SPACES TO LSG-COD-MENS.

           PERFORM GRB-OPC-LSG.
           IF NOT FIO-STAT-OKS
               ADD 1 TO LSG-NUM-OPER
               MOVE 'UPDOPCLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRABA-LEASING.

           ADD 1 TO LSG-NUM-OPOK.

           PERFORM GRB-DLC-LSG.
           IF NOT FIO-STAT-OKS
               ADD 1 TO LSG-NUM-DLER
               MOVE 'UPDDLCLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRABA-LEASING.

           ADD 1 TO LSG-NUM-DLOK.

           PERFORM GRB-VEN-LSG.
           IF NOT FIO-STAT-OKS
               ADD 1 TO LSG-NUM-VEER
               MOVE 'UPDVENLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRABA-LEASING.

           ADD 1 TO LSG-NUM-VEOK.


           PERFORM GRB-ICG-LSG.
           IF NOT FIO-STAT-OKS
               ADD 1 TO LSG-NUM-ICER
               MOVE 'UPDOPCLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRABA-LEASING.

           ADD 1 TO LSG-NUM-ICOK.

      *graba DEUDOR DIRECTO.
           PERFORM GRB-DBC-LSG.
           IF LSG-COD-MENS > SPACES
               ADD 1 TO LSG-NUM-DBER
               GO TO FIN-GRABA-LEASING.

           ADD 1 TO LSG-NUM-DBOK.

           PERFORM GRB-RDC-LSG.
           IF NOT FIO-STAT-OKS
               ADD 1 TO LSG-NUM-RDER
               MOVE 'UPDOPCLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRABA-LEASING.

           ADD 1 TO LSG-NUM-RDOK.

           IF LSG-NUM-ICAV IN LSG NOT > ZEROES
               GO TO FIN-GRABA-LEASING.

      *ALD-BCI-INI/04.04.1999
      *graba DEUDOR INDIRECTO.

           PERFORM GRB-DBC-LSG-AVA.
           IF LSG-COD-MENS > SPACES
               ADD 1 TO LSG-NUM-DBER
               GO TO FIN-GRABA-LEASING.

           ADD 1 TO LSG-NUM-DBOK.

           PERFORM GRB-RDC-LSG-AVA.
           IF NOT FIO-STAT-OKS
               ADD 1 TO LSG-NUM-RDER
               MOVE 'UPDOPCLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRABA-LEASING.

           ADD 1 TO LSG-NUM-RDOK.
      *ALD-BCI-FIN/04.04.1999

       FIN-GRABA-LEASING.
           IF LSG-COD-MENS > SPACES
               DISPLAY 'ERROR ====== > ' LSG-COD-MENS
               PERFORM BCK-OUT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-LSG.
           GO TO LUP-GRABA-LEASING.
       OUT-GRABA-LEASING.
           EXIT.


       GRB-OPC-LSG SECTION.
       INI-GRB-OPC-LSG.

           MOVE  LSG-KEY-IOPC IN LSG TO OPC-KEY-IREG IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-OPC
               MOVE FIO-MOD TO FIO-CMND.

           PERFORM INI-OPC-LSG.
           PERFORM COL-FIO-OPC.


       FIN-GRB-OPC-LSG.
           EXIT.

       INI-OPC-LSG SECTION.
       INI-INI-OPC-LSG.
      *    Operacion Credito
      *    -----------------
      *
      *    Nombre Registro : OPC
           MOVE  SPACES              TO OPC-GLS-FLAG IN OPC.
           MOVE  LSG-KEY-IOPC IN LSG TO OPC-KEY-IREG IN OPC.
           MOVE  HOY-STP-ITRN        TO OPC-STP-ITRN IN OPC.

           MOVE  'I'                 TO OPC-MSC-TACC IN OPC.
           MOVE  'A'                 TO OPC-MSC-STAT IN OPC.
           MOVE  'C'                 TO OPC-MSC-TTRN IN OPC.

           MOVE 'BAT'                TO OPC-COD-TTRN IN OPC.

           MOVE  'COLPBLSG'          TO OPC-COD-ATRN IN OPC.
           MOVE  LSG-COD-VCOC IN LSG TO OPC-COD-VCOC IN OPC.
           MOVE  LSG-COD-COOC IN LSG TO OPC-COD-COOC IN OPC.

           MOVE  LSG-COD-OFOC IN LSG TO OPC-COD-OFOC IN OPC.
           MOVE  LSG-COD-RMOC IN LSG TO OPC-COD-RMOC IN OPC.

           MOVE  SPACES              TO OPC-COD-CDOC IN OPC.
           MOVE  SPACES              TO OPC-CIC-ILDC IN OPC.
           MOVE LSG-NUM-DCOL IN LSG  TO OPC-NUM-DCOL IN OPC.
           MOVE LSG-NUM-MCOL IN LSG  TO OPC-NUM-MCOL IN OPC.
           MOVE LSG-NUM-SCOL IN LSG  TO OPC-NUM-SCOL IN OPC.
           MOVE LSG-NUM-ACOL IN LSG  TO OPC-NUM-ACOL IN OPC.

           MOVE HOY-DHOY             TO OPC-NUM-DING IN OPC.
           MOVE HOY-MHOY             TO OPC-NUM-MING IN OPC.
           MOVE HOY-SHOY             TO OPC-NUM-SING IN OPC.
           MOVE HOY-AHOY             TO OPC-NUM-AING IN OPC.

           MOVE HOY-DHOY             TO OPC-NUM-DINP IN OPC.
           MOVE HOY-MHOY             TO OPC-NUM-MINP IN OPC.
           MOVE HOY-SHOY             TO OPC-NUM-SINP IN OPC.
           MOVE HOY-AHOY             TO OPC-NUM-AINP IN OPC.

           MOVE LSG-VAL-CRED IN LSG  TO OPC-VAL-CRED IN OPC.
           MOVE LSG-VAL-SCRE IN LSG  TO OPC-VAL-SCRE IN OPC.

           MOVE 'N'                  TO OPC-IND-AFER IN OPC.
           MOVE  SPACES              TO OPC-MSC-MCVF IN OPC.

           MOVE  SPACES              TO OPC-MSC-TCVE IN OPC.

           MOVE  SPACES              TO OPC-IND-RENO IN OPC.
           MOVE  SPACES              TO OPC-IND-GARA IN OPC.

           MOVE  ZEROES              TO OPC-SGV-VCOM IN OPC.

           MOVE  ZEROES              TO OPC-VAL-GAST IN OPC.

           MOVE  SPACES              TO OPC-COD-SEGD IN OPC.

           MOVE  ZEROES              TO OPC-VAL-SEGD IN OPC.
           MOVE  ZEROES              TO OPC-SGV-LIQU IN OPC.

           MOVE  1                   TO OPC-NUM-IVEN IN OPC.
           MOVE  1                   TO OPC-NUM-VCOR IN OPC.
           MOVE  1                   TO OPC-NUM-VCVG IN OPC.

           MOVE  ZEROES              TO OPC-NUM-VCCO IN OPC.
           MOVE  ZEROES              TO OPC-NUM-VCCM IN OPC.
           MOVE  ZEROES              TO OPC-NUM-VCCV IN OPC.
           MOVE  ZEROES              TO OPC-NUM-TVCC IN OPC.
           MOVE  'N'                 TO OPC-IND-VSTR IN OPC.
           MOVE  SPACES              TO OPC-CIC-ICEN IN OPC.

           MOVE  SPACES              TO OPC-COD-AGES IN OPC.
           MOVE  SPACES              TO OPC-IND-CTBL IN OPC.
           MOVE  SPACES              TO OPC-COD-INSI IN OPC.
           MOVE  SPACES              TO OPC-COD-CVTA IN OPC.
           MOVE  ZEROES              TO OPC-VAL-SEGP IN OPC.
           MOVE  SPACES              TO OPC-GLS-DISP IN OPC.

       FIN-INI-OPC-LSG.
           EXIT.


       GRB-DLC-LSG SECTION.
       INI-GRB-DLC-LSG.

           MOVE  LSG-CIC-IOPC IN LSG TO DLC-CIC-IOPC IN DLC.
           MOVE 1                    TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-DLC
               MOVE FIO-MOD TO FIO-CMND.

           PERFORM INI-DLC-LSG.
           PERFORM COL-FIO-DLC.

       FIN-GRB-DLC-LSG.
           EXIT.

       INI-DLC-LSG SECTION.
       INI-INI-DLC-LSG.
      *    Documento Legal Credito
      *    -----------------------
      *
      *    Nombre Registro : DLC
           MOVE  SPACES              TO DLC-GLS-FLAG IN DLC.

           MOVE  LSG-CIC-IOPC IN LSG TO DLC-CIC-IOPC IN DLC.
           MOVE 1                    TO DLC-NUM-IDLC IN DLC.
           MOVE HOY-STP-ITRN         TO DLC-STP-ITRN IN DLC.

           MOVE  SPACES              TO DLC-MSC-TACC IN DLC.
           MOVE  SPACES              TO DLC-MSC-STAT IN DLC.
           MOVE  SPACES              TO DLC-COD-OTRN IN DLC.
           MOVE  SPACES              TO DLC-COD-ATRN IN DLC.

           MOVE  LSG-VAL-CRED IN LSG TO DLC-VAL-NDLC IN DLC.
           MOVE  LSG-VAL-SCRE IN LSG TO DLC-VAL-SDLC IN DLC.
           MOVE  SPACES              TO DLC-COD-TDOC IN DLC.
           MOVE  SPACES              TO DLC-COD-PLZO IN DLC.
           MOVE  SPACES              TO DLC-MSC-TIMP IN DLC.
           MOVE  ZEROES              TO DLC-VAL-IMPU IN DLC.
           MOVE  SPACES              TO DLC-COD-NOTC IN DLC.
           MOVE  ZEROES              TO DLC-VAL-GNOT IN DLC.
           MOVE  SPACES              TO DLC-IND-SCBZ IN DLC.
           MOVE  SPACES              TO DLC-IND-SCRT IN DLC.
           MOVE  SPACES              TO DLC-COD-UBFD IN DLC.
           MOVE  SPACES              TO DLC-COD-PLZA IN DLC.
           MOVE  SPACES              TO DLC-MSC-MIPL IN DLC.
           MOVE  SPACES              TO DLC-IND-RIES IN DLC.
           MOVE  ZEROES              TO DLC-VAL-READ IN DLC.
           MOVE  ZEROES              TO DLC-VAL-INTD IN DLC.
           MOVE OPC-NUM-DCOL IN OPC  TO DLC-NUM-DDEV IN DLC.
           MOVE OPC-NUM-MCOL IN OPC  TO DLC-NUM-MDEV IN DLC.
           MOVE OPC-NUM-SCOL IN OPC  TO DLC-NUM-SDEV IN DLC.
           MOVE OPC-NUM-ACOL IN OPC  TO DLC-NUM-ADEV IN DLC.

           MOVE  ZEROES              TO DLC-VAL-SINT IN DLC.
           MOVE  ZEROES              TO DLC-VAL-SCPA IN DLC.

           MOVE  ZEROES              TO DLC-FEC-FAMT IN DLC.
           MOVE  SPACES              TO DLC-KEY-IDLO IN DLC.

           MOVE ZEROES               TO DLC-NUM-IDLO IN DLC.
           MOVE  ZEROES              TO DLC-VAL-IPEN IN DLC.
           MOVE  ZEROES              TO DLC-VAL-DPES IN DLC.
           MOVE LSG-IND-SCTB IN LSG  TO DLC-IND-SCTB IN DLC.

           MOVE LSG-NUM-DMAV IN LSG  TO DLC-NUM-DMAV IN DLC.
           MOVE LSG-NUM-MMAV IN LSG  TO DLC-NUM-MMAV IN DLC.
           MOVE LSG-NUM-SMAV IN LSG  TO DLC-NUM-SMAV IN DLC.
           MOVE LSG-NUM-AMAV IN LSG  TO DLC-NUM-AMAV IN DLC.

           MOVE  ZEROES              TO DLC-NUM-VSCE IN DLC.
           MOVE  ZEROES              TO DLC-FEC-FSDE IN DLC.
           MOVE  ZEROES              TO DLC-VAL-PIMP IN DLC.
           MOVE  SPACES              TO DLC-COD-SUSP IN DLC.
           MOVE  ZEROES              TO DLC-FEC-FSDM IN DLC.
           MOVE  SPACES              TO DLC-GLS-DISP IN DLC.
       FIN-INI-DLC-LSG.
           EXIT.


       GRB-VEN-LSG SECTION.
       INI-GRB-VEN-LSG.

           MOVE  LSG-CIC-IOPC IN LSG TO VEN-CIC-IOPC IN VEN.
           MOVE 1                    TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-VEN
               MOVE FIO-MOD TO FIO-CMND.

           PERFORM INI-VEN-LSG.
           PERFORM COL-FIO-VEN.

       FIN-GRB-VEN-LSG.
           EXIT.

       INI-VEN-LSG SECTION.
       INI-INI-VEN-LSG.
      *    Vencimientos
      *    ------------
      *
      *    Nombre Registro : VEN
           MOVE  SPACES              TO VEN-GLS-FLAG IN VEN.

           MOVE  LSG-CIC-IOPC IN LSG TO VEN-CIC-IOPC IN VEN.
           MOVE 1                    TO VEN-NUM-IVEN IN VEN.

           MOVE HOY-STP-ITRN         TO VEN-STP-ITRN IN VEN.

           MOVE  SPACES              TO VEN-MSC-TACC IN VEN.
           MOVE  SPACES              TO VEN-MSC-STAT IN VEN.
           MOVE  SPACES              TO VEN-COD-OTRN IN VEN.
           MOVE  SPACES              TO VEN-COD-ATRN IN VEN.

           MOVE LSG-NUM-DMAV IN LSG  TO VEN-NUM-DVEN IN VEN.
           MOVE LSG-NUM-MMAV IN LSG  TO VEN-NUM-MVEN IN VEN.
           MOVE LSG-NUM-SMAV IN LSG  TO VEN-NUM-SVEN IN VEN.
           MOVE LSG-NUM-AMAV IN LSG  TO VEN-NUM-AVEN IN VEN.

           MOVE VEN-FEC-FVEN IN VEN  TO VEN-FEC-FIMV IN VEN.

           MOVE  LSG-VAL-SCRE IN LSG TO VEN-VAL-CAPI IN VEN.
           MOVE  LSG-VAL-SCRE IN LSG TO VEN-VAL-SCAP IN VEN.
           MOVE  ZEROES              TO VEN-VAL-IDNI IN VEN.
           MOVE  LSG-VAL-SCRE IN LSG TO VEN-VAL-FINA IN VEN.
           MOVE  LSG-VAL-SCRE IN LSG TO VEN-VAL-SFIN IN VEN.
           MOVE  SPACES              TO VEN-IND-SCTB IN VEN.
           MOVE  1                   TO VEN-NUM-IVCT IN VEN.
           MOVE  ZEROES              TO VEN-NUM-IEVC IN VEN.
           MOVE  1                   TO VEN-NUM-IDLC IN VEN.
           MOVE  SPACES              TO VEN-IND-CAUT IN VEN.
           MOVE  SPACES              TO VEN-IND-SCBZ IN VEN.
           MOVE  ZEROES              TO VEN-VAL-MTSC IN VEN.
           MOVE  SPACES              TO VEN-IND-MTSC IN VEN.
           MOVE  SPACES              TO VEN-IND-CALC IN VEN.
           MOVE  SPACES              TO VEN-IND-CTBA IN VEN.
           MOVE  SPACES              TO VEN-GLS-DISP IN VEN.
       FIN-INI-VEN-LSG.
           EXIT.

       GRB-ICG-LSG SECTION.
       INI-GRB-ICG-LSG.

           MOVE  LSG-CIC-IOPC IN LSG TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES               TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES               TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES               TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'                TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES               TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-ICG
               MOVE FIO-MOD TO FIO-CMND.

           PERFORM INI-ICG-LSG.
           PERFORM COL-FIO-ICG.

       FIN-GRB-ICG-LSG.
           EXIT.

       INI-ICG-LSG SECTION.
       INI-INI-ICG-LSG.
      *    Interes Comisiones Gastos
      *    -------------------------
      *
      *    Nombre Registro : ICG
           MOVE  SPACES              TO ICG-GLS-FLAG IN ICG.
           MOVE  LSG-CIC-IOPC IN LSG TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES               TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES               TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES               TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'                TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES               TO ICG-FEC-FINI IN ICG.
           MOVE HOY-STP-ITRN         TO ICG-STP-ITRN IN ICG.
           MOVE  SPACES              TO ICG-MSC-TACC IN ICG.
           MOVE  SPACES              TO ICG-MSC-STAT IN ICG.
           MOVE  SPACES              TO ICG-COD-OTRN IN ICG.
           MOVE  SPACES              TO ICG-COD-ATRN IN ICG.
           MOVE  SPACES              TO ICG-COD-TINT IN ICG.
           MOVE ZEROES               TO ICG-NUM-PREP IN ICG.
           MOVE SPACES               TO ICG-MSC-UTPR IN ICG.

           MOVE  ZEROES              TO ICG-FEC-FTER IN ICG.
           MOVE  ZEROES              TO ICG-SGV-SPRD IN ICG.

           MOVE  ZEROES              TO ICG-SGV-TINT IN ICG.
           MOVE  ZEROES              TO ICG-SGV-MNTO IN ICG.
           MOVE  SPACES              TO ICG-GLS-DISP IN ICG.

       FIN-INI-ICG-LSG.
           EXIT.


       GRB-DBC-LSG SECTION.
       INI-GRB-DBC-LSG.

           MOVE LSG-NUM-ICLI IN LSG TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES              TO DBC-IND-ICLI IN DBC.
           MOVE SPACES              TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'      TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
      *ALD-BCI-INI/01.02.1999
               PERFORM MOD-REG-CLI
      *ALD-BCI-INI/01.02.1999
               GO TO FIN-GRB-DBC-LSG.

      *OBTIENE SEMILLA DE CLIENTE

           MOVE SPACES TO CIC-CAI-ICIC IN CIC
           MOVE CIC-GET TO CIC-CMND
           PERFORM PRO-CIC
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE CIC-MENS TO LSG-COD-MENS
               GO TO FIN-GRB-DBC-LSG.

      *    Datos Basicos del Cliente
      *    -------------------------
      *
      *    Nombre Registro : DBC
           MOVE  SPACES                TO DBC-GLS-FLAG IN DBC.
           MOVE  CIC-CIC-ICIC          TO DBC-CIC-ICLI IN DBC.
           MOVE HOY-STP-ITRN           TO DBC-STP-ITRN IN DBC.
           MOVE  'I'                   TO DBC-MSC-TACC IN DBC.
           MOVE  'V'                   TO DBC-MSC-STAT IN DBC.
           MOVE  'B   '                TO DBC-COD-OTRN IN DBC.
           MOVE  'DEUDORES'            TO DBC-COD-ATRN IN DBC.
           MOVE LSG-NUM-ICLI IN LSG    TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES                 TO DBC-IND-ICLI IN DBC.
           MOVE SPACES                 TO DBC-GLS-ICLI IN DBC.
           MOVE  LSG-VRF-ICLI IN LSG   TO DBC-VRF-ICLI IN DBC.
           MOVE LSG-GLS-NOMC IN LSG    TO DBC-GLS-NOMC IN DBC.
           MOVE  SPACES                TO DBC-SNX-NOMC IN DBC.
           MOVE  1                     TO DBC-NUM-DCOR IN DBC.

           MOVE  LSG-IND-TICL IN LSG   TO DBC-IND-TICL IN DBC.

           IF LSG-NUM-ICLI IN LSG > 50000000
               MOVE 'E'                TO DBC-IND-TICL IN DBC.

           MOVE  SPACES                TO DBC-COD-CLCM IN DBC.
           MOVE  LSG-COD-CLCM IN LSG   TO DBC-COD-TICL IN DBC.
           MOVE  LSG-COD-RMOC IN LSG   TO DBC-COD-EJEC IN DBC.
           MOVE  LSG-COD-OFOC IN LSG   TO DBC-COD-OFIC IN DBC.
           MOVE  SPACES                TO DBC-IND-OOFI IN DBC.
           MOVE  LSG-COD-ACTI IN LSG   TO DBC-COD-ACTI IN DBC.
           MOVE  SPACES                TO DBC-COD-ODSE IN DBC.
           MOVE  ZEROES                TO DBC-FEC-FA85 IN DBC.
      *ALD-BCI-INI/15111999
           MOVE SPACES                 TO DBC-COD-SETO IN DBC.
           MOVE SPACES                 TO DBC-PDO-SETO IN DBC.
      *    MOVE  SPACES                TO DBC-IND-UPIR IN DBC.
      *    MOVE  ZEROES                TO DBC-FEC-FUPI IN DBC.
      *ALD-BCI-FIN/15111999
           MOVE  SPACES                TO DBC-IND-MUBC IN DBC.
           MOVE  SPACES                TO DBC-IND-JUBC IN DBC.
           MOVE  '4'                   TO DBC-MSC-SCLI IN DBC.
           MOVE  HOY-DHOY              TO DBC-NUM-DSCL IN DBC.
           MOVE  HOY-MHOY              TO DBC-NUM-MSCL IN DBC.
           MOVE  HOY-SHOY              TO DBC-NUM-SSCL IN DBC.
           MOVE  HOY-AHOY              TO DBC-NUM-ASCL IN DBC.
           MOVE  SPACES                TO DBC-COD-BLOC IN DBC.
           MOVE  1                     TO DBC-NUM-TDIR IN DBC.
           MOVE  ZEROES                TO DBC-NUM-TCMT IN DBC.
           MOVE  ZEROES                TO DBC-FEC-FIOP IN DBC.
           MOVE  ZEROES                TO DBC-FEC-FTOP IN DBC.
           MOVE  ZEROES                TO DBC-NUM-OFTN IN DBC.
           MOVE  HOY-DHOY              TO DBC-NUM-DINP IN DBC.
           MOVE  HOY-MHOY              TO DBC-NUM-MINP IN DBC.
           MOVE  HOY-SHOY              TO DBC-NUM-SINP IN DBC.
           MOVE  HOY-AHOY              TO DBC-NUM-AINP IN DBC.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDBCLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRB-DBC-LSG.

           ADD 1 TO LSG-REG-DBCR.

      *    Relacion Cliente Direcciones
      *    ----------------------------
      *
      *    Nombre Registro : RCD
           MOVE  SPACES              TO RCD-GLS-FLAG IN RCD.
           MOVE  DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE 1                    TO RCD-NUM-DIRE IN RCD.
           MOVE HOY-STP-ITRN         TO RCD-STP-ITRN IN RCD.
           MOVE  'I'                 TO RCD-MSC-TACC IN RCD.
           MOVE  'V'                 TO RCD-MSC-STAT IN RCD.
           MOVE  'B   '              TO RCD-COD-OTRN IN RCD.
           MOVE  'DEUDORES'          TO RCD-COD-ATRN IN RCD.
           MOVE  'D'                 TO RCD-MSC-TDIR IN RCD.
           MOVE  SPACES              TO RCD-MSC-SDIR IN RCD.
           MOVE  ZEROES              TO RCD-FEC-FVRF IN RCD.
           MOVE  SPACES              TO RCD-GLS-DIRE IN RCD.
           MOVE  SPACES              TO RCD-COD-LUGA IN RCD.
           MOVE  SPACES              TO RCD-GLS-FONO IN RCD.
           MOVE  SPACES              TO RCD-GLS-DISP IN RCD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDRCDLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRB-DBC-LSG.
           IF DBC-IND-TICL IN DBC = 'E'
               GO TO GRB-DBC-DCE.


      *    Datos Complementarios Personas
      *    ------------------------------
      *
      *    Nombre Registro : DCP
           MOVE  SPACES              TO DCP-GLS-FLAG IN DCP.
           MOVE DBC-CIC-ICLI IN DBC  TO DCP-CIC-ICLI IN DCP.
           MOVE HOY-STP-ITRN         TO DCP-STP-ITRN IN DCP.
           MOVE  'I'                 TO DCP-MSC-TACC IN DCP.
           MOVE  'V'                 TO DCP-MSC-STAT IN DCP.
           MOVE  'B   '              TO DCP-COD-OTRN IN DCP.
           MOVE  'DEUDORES'          TO DCP-COD-ATRN IN DCP.
           MOVE  ZEROES              TO DCP-FEC-FNAC IN DCP.
           MOVE  SPACES              TO DCP-COD-PNAC IN DCP.
           MOVE  SPACES              TO DCP-IND-SEXO IN DCP.
           MOVE  SPACES              TO DCP-IND-ECIV IN DCP.
           MOVE  SPACES              TO DCP-NUM-CIDE IN DCP.
           MOVE  SPACES              TO DCP-VRF-CIDE IN DCP.
           MOVE  SPACES              TO DCP-GLS-GABI IN DCP.
           MOVE LSG-COD-TBAN IN LSG  TO DCP-COD-TBAN IN DCP.
           MOVE  SPACES              TO DCP-IND-NEDU IN DCP.
           MOVE  SPACES              TO DCP-COD-ACTS IN DCP.
           MOVE  SPACES              TO DCP-COD-PROF IN DCP.
           MOVE  SPACES              TO DCP-IND-SLAB IN DCP.
           MOVE  SPACES              TO DCP-COD-CSEC IN DCP.
           MOVE  SPACES              TO DCP-IND-CASA IN DCP.
           MOVE  ZEROES              TO DCP-NUM-NMSG IN DCP.
           MOVE  SPACES              TO DCP-IND-RCNY IN DCP.
           MOVE  SPACES              TO DCP-COD-TPLN IN DCP.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDCPLSGERR' TO LSG-COD-MENS

           GO TO FIN-GRB-DBC-LSG.

       GRB-DBC-DCE.
      *    Datos Complementarios Empresas
      *    ------------------------------
      *
      *    Nombre Registro : DCE
           MOVE  SPACES                TO DCE-GLS-FLAG IN DCE.
           MOVE DBC-CIC-ICLI IN DBC    TO DCE-CIC-ICLI IN DCE.
           MOVE HOY-STP-ITRN           TO DCE-STP-ITRN IN DCE.
           MOVE  'I'                   TO DCE-MSC-TACC IN DCE.
           MOVE  'V'                   TO DCE-MSC-STAT IN DCE.
           MOVE  'B   '                TO DCE-COD-OTRN IN DCE.
           MOVE  'DEUDORES'            TO DCE-COD-ATRN IN DCE.

           MOVE  SPACES                TO DCE-GLS-NFAN IN DCE.
           MOVE  SPACES                TO DCE-COD-TSOC IN DCE.
           MOVE  ZEROES                TO DCE-FEC-FCTT IN DCE.
           MOVE  ZEROES                TO DCE-FEC-FUME IN DCE.
           MOVE  ZEROES                TO DCE-FEC-FCAD IN DCE.
           MOVE  SPACES                TO DCE-IND-RAUT IN DCE.
           IF LSG-COD-OFOC IN LSG = '090'
               MOVE 'M'       TO DCE-IND-CMOS IN DCE
           ELSE
               MOVE 'S'       TO DCE-IND-CMOS IN DCE.

           MOVE  SPACES                TO DCE-IND-CATE IN DCE.
           MOVE  SPACES                TO DCE-IND-TEMP IN DCE.
           MOVE LSG-COD-TBAN IN LSG    TO DCE-COD-TBAN IN DCE.
           MOVE  SPACES                TO DCE-COD-TPLN IN DCE.
           MOVE  SPACES                TO DCE-GLS-DISP IN DCE.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDCELSGERR' TO LSG-COD-MENS.

       FIN-GRB-DBC-LSG.
           EXIT.


       GRB-RDC-LSG SECTION.
       INI-GRB-RDC-LSG.

           MOVE DBC-CIC-ICLI IN DBC       TO RDC-CIC-ICLI IN RDC.
           MOVE LSG-CIC-IOPC IN LSG       TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES                    TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-RDC
               MOVE FIO-MOD TO FIO-CMND.

           PERFORM INI-RDC-LSG.
           PERFORM COL-FIO-RDC.

       FIN-GRB-RDC-LSG.
           EXIT.

       INI-RDC-LSG SECTION.
       INI-INI-OPC-LSG.
      *    Relacion Deudor Credito
      *    -----------------------
      *
      *    Nombre Registro : RDC
      *
           MOVE  SPACES                   TO RDC-GLS-FLAG IN RDC.
           MOVE DBC-CIC-ICLI IN DBC       TO RDC-CIC-ICLI IN RDC.
           MOVE LSG-CIC-IOPC IN LSG       TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES                    TO RDC-NUM-IDLC IN RDC.

           MOVE SPACES                    TO RDC-COD-TRDC IN RDC.
           MOVE HOY-STP-ITRN              TO RDC-STP-ITRN IN RDC.
           MOVE  ' '                      TO RDC-MSC-TACC IN RDC.
           MOVE  ' '                      TO RDC-MSC-STAT IN RDC.
           MOVE  '     '                  TO RDC-COD-OTRN IN RDC.
           MOVE  SPACES                   TO RDC-COD-ATRN IN RDC.
           MOVE  '01'                     TO RDC-NUM-DIRE IN RDC.
           MOVE  100                      TO RDC-VAL-LIMD IN RDC.
           MOVE  SPACES                   TO RDC-GLS-DISP IN RDC.
       FIN-INI-RDC-LSG.
           EXIT.

      ******************************************************************
       BCK-OUT SECTION.
      *---------------
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'BACK-OUT ERRONEO'.
       FIN-BCK-OUT.
           EXIT.

      ******************************************************************
       CHK-PNT SECTION.
      *----------------
       INI-CHK-PNT.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CHECK-PNT ERRONEO'.
       FIN-CHK-PNT.
           EXIT.

      *ALD-BCI-INI/01.02.1999
       MOD-REG-CLI SECTION.
       INI-MOD-REG-CLI.

      *RRM-INI 22-FEB-1999
      *    IF LSG-COD-OFOC IN LSG NOT = '154'
           IF DBC-COD-OFIC IN DBC NOT = '154'
      *RRM-FIN 22-FEB-1999
               GO TO FIN-MOD-REG-CLI.

           IF LSG-COD-ACTI IN LSG = DBC-COD-ACTI IN DBC AND
              LSG-COD-CLCM IN LSG = DBC-COD-TICL IN DBC
               GO TO CON-MOD-REG-CLI.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.

           MOVE  LSG-COD-ACTI IN LSG   TO DBC-COD-ACTI IN DBC.
           MOVE  LSG-COD-CLCM IN LSG   TO DBC-COD-TICL IN DBC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'MODDBCLSGERR' TO LSG-COD-MENS
               GO TO FIN-MOD-REG-CLI.

       CON-MOD-REG-CLI.

           IF DBC-IND-TICL IN DBC = 'P'
               GO TO ACT-REG-DCP.

           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDCELSGERR' TO LSG-COD-MENS
               GO TO FIN-MOD-REG-CLI.

           MOVE LSG-COD-TBAN IN LSG    TO DCE-COD-TBAN IN DCE.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE 'MODDCELSGERR' TO LSG-COD-MENS
               GO TO FIN-MOD-REG-CLI.

           ADD 1 TO LSG-REG-DBCR.

           GO TO FIN-MOD-REG-CLI.

       ACT-REG-DCP.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDCPLSGERR' TO LSG-COD-MENS
               GO TO FIN-MOD-REG-CLI.

           MOVE LSG-COD-TBAN IN LSG    TO DCP-COD-TBAN IN DCP.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE 'MODDCPLSGERR' TO LSG-COD-MENS
               GO TO FIN-MOD-REG-CLI.

           ADD 1 TO LSG-REG-DBCR.

       FIN-MOD-REG-CLI.
           EXIT.


       GRB-DBC-LSG-AVA SECTION.
       INI-GRB-DBC-LSG-AVA.

           MOVE LSG-NUM-ICAV IN LSG TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES              TO DBC-IND-ICLI IN DBC.
           MOVE SPACES              TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'      TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               PERFORM MOD-REG-CLI-AVA
               GO TO FIN-GRB-DBC-LSG-AVA.

      *OBTIENE SEMILLA DE CLIENTE

           MOVE SPACES TO CIC-CAI-ICIC IN CIC
           MOVE CIC-GET TO CIC-CMND
           PERFORM PRO-CIC
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE CIC-MENS TO LSG-COD-MENS
               GO TO FIN-GRB-DBC-LSG-AVA.

      *    Datos Basicos del Cliente
      *    -------------------------
      *
      *    Nombre Registro : DBC
           MOVE  SPACES                TO DBC-GLS-FLAG IN DBC.
           MOVE  CIC-CIC-ICIC          TO DBC-CIC-ICLI IN DBC.
           MOVE HOY-STP-ITRN           TO DBC-STP-ITRN IN DBC.
           MOVE  'I'                   TO DBC-MSC-TACC IN DBC.
           MOVE  'V'                   TO DBC-MSC-STAT IN DBC.
           MOVE  'B   '                TO DBC-COD-OTRN IN DBC.
           MOVE  'DEUDORES'            TO DBC-COD-ATRN IN DBC.
           MOVE LSG-NUM-ICAV IN LSG    TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES                 TO DBC-IND-ICLI IN DBC.
           MOVE SPACES                 TO DBC-GLS-ICLI IN DBC.
           MOVE  LSG-VRF-ICAV IN LSG   TO DBC-VRF-ICLI IN DBC.
           MOVE LSG-GLS-NAVA IN LSG    TO DBC-GLS-NOMC IN DBC.
           MOVE  SPACES                TO DBC-SNX-NOMC IN DBC.
           MOVE  1                     TO DBC-NUM-DCOR IN DBC.

           MOVE  LSG-IND-TIAV IN LSG   TO DBC-IND-TICL IN DBC.

           IF LSG-NUM-ICAV IN LSG > 50000000
               MOVE 'E'                TO DBC-IND-TICL IN DBC.

           MOVE  SPACES                TO DBC-COD-CLCM IN DBC.
           MOVE  LSG-COD-CLAV IN LSG   TO DBC-COD-TICL IN DBC.
           MOVE  LSG-COD-RMOC IN LSG   TO DBC-COD-EJEC IN DBC.
           MOVE  LSG-COD-OFOC IN LSG   TO DBC-COD-OFIC IN DBC.
           MOVE  SPACES                TO DBC-IND-OOFI IN DBC.
           MOVE  LSG-COD-ACAV IN LSG   TO DBC-COD-ACTI IN DBC.
           MOVE  SPACES                TO DBC-COD-ODSE IN DBC.
           MOVE  ZEROES                TO DBC-FEC-FA85 IN DBC.
      *ALD-BCI-INI/15111999
           MOVE SPACES                 TO DBC-COD-SETO IN DBC.
           MOVE SPACES                 TO DBC-PDO-SETO IN DBC.
      *    MOVE  SPACES                TO DBC-IND-UPIR IN DBC.
      *    MOVE  ZEROES                TO DBC-FEC-FUPI IN DBC.
      *ALD-BCI-FIN/15111999
           MOVE  SPACES                TO DBC-IND-MUBC IN DBC.
           MOVE  SPACES                TO DBC-IND-JUBC IN DBC.
           MOVE  '4'                   TO DBC-MSC-SCLI IN DBC.
           MOVE  HOY-DHOY              TO DBC-NUM-DSCL IN DBC.
           MOVE  HOY-MHOY              TO DBC-NUM-MSCL IN DBC.
           MOVE  HOY-SHOY              TO DBC-NUM-SSCL IN DBC.
           MOVE  HOY-AHOY              TO DBC-NUM-ASCL IN DBC.
           MOVE  SPACES                TO DBC-COD-BLOC IN DBC.
           MOVE  1                     TO DBC-NUM-TDIR IN DBC.
           MOVE  ZEROES                TO DBC-NUM-TCMT IN DBC.
           MOVE  ZEROES                TO DBC-FEC-FIOP IN DBC.
           MOVE  ZEROES                TO DBC-FEC-FTOP IN DBC.
           MOVE  ZEROES                TO DBC-NUM-OFTN IN DBC.
           MOVE  HOY-DHOY              TO DBC-NUM-DINP IN DBC.
           MOVE  HOY-MHOY              TO DBC-NUM-MINP IN DBC.
           MOVE  HOY-SHOY              TO DBC-NUM-SINP IN DBC.
           MOVE  HOY-AHOY              TO DBC-NUM-AINP IN DBC.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDBCLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRB-DBC-LSG-AVA.

           ADD 1 TO LSG-REG-DBCR.

      *    Relacion Cliente Direcciones
      *    ----------------------------
      *
      *    Nombre Registro : RCD
           MOVE  SPACES              TO RCD-GLS-FLAG IN RCD.
           MOVE  DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE 1                    TO RCD-NUM-DIRE IN RCD.
           MOVE HOY-STP-ITRN         TO RCD-STP-ITRN IN RCD.
           MOVE  'I'                 TO RCD-MSC-TACC IN RCD.
           MOVE  'V'                 TO RCD-MSC-STAT IN RCD.
           MOVE  'B   '              TO RCD-COD-OTRN IN RCD.
           MOVE  'DEUDORES'          TO RCD-COD-ATRN IN RCD.
           MOVE  'D'                 TO RCD-MSC-TDIR IN RCD.
           MOVE  SPACES              TO RCD-MSC-SDIR IN RCD.
           MOVE  ZEROES              TO RCD-FEC-FVRF IN RCD.
           MOVE  SPACES              TO RCD-GLS-DIRE IN RCD.
           MOVE  SPACES              TO RCD-COD-LUGA IN RCD.
           MOVE  SPACES              TO RCD-GLS-FONO IN RCD.
           MOVE  SPACES              TO RCD-GLS-DISP IN RCD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDRCDLSGERR' TO LSG-COD-MENS
               GO TO FIN-GRB-DBC-LSG.
           IF DBC-IND-TICL IN DBC = 'E'
               GO TO GRB-DBC-DCE-AVA.


      *    Datos Complementarios Personas
      *    ------------------------------
      *
      *    Nombre Registro : DCP
           MOVE  SPACES              TO DCP-GLS-FLAG IN DCP.
           MOVE DBC-CIC-ICLI IN DBC  TO DCP-CIC-ICLI IN DCP.
           MOVE HOY-STP-ITRN         TO DCP-STP-ITRN IN DCP.
           MOVE  'I'                 TO DCP-MSC-TACC IN DCP.
           MOVE  'V'                 TO DCP-MSC-STAT IN DCP.
           MOVE  'B   '              TO DCP-COD-OTRN IN DCP.
           MOVE  'DEUDORES'          TO DCP-COD-ATRN IN DCP.
           MOVE  ZEROES              TO DCP-FEC-FNAC IN DCP.
           MOVE  SPACES              TO DCP-COD-PNAC IN DCP.
           MOVE  SPACES              TO DCP-IND-SEXO IN DCP.
           MOVE  SPACES              TO DCP-IND-ECIV IN DCP.
           MOVE  SPACES              TO DCP-NUM-CIDE IN DCP.
           MOVE  SPACES              TO DCP-VRF-CIDE IN DCP.
           MOVE  SPACES              TO DCP-GLS-GABI IN DCP.
           MOVE LSG-COD-TBAV IN LSG  TO DCP-COD-TBAN IN DCP.
           MOVE  SPACES              TO DCP-IND-NEDU IN DCP.
           MOVE  SPACES              TO DCP-COD-ACTS IN DCP.
           MOVE  SPACES              TO DCP-COD-PROF IN DCP.
           MOVE  SPACES              TO DCP-IND-SLAB IN DCP.
           MOVE  SPACES              TO DCP-COD-CSEC IN DCP.
           MOVE  SPACES              TO DCP-IND-CASA IN DCP.
           MOVE  ZEROES              TO DCP-NUM-NMSG IN DCP.
           MOVE  SPACES              TO DCP-IND-RCNY IN DCP.
           MOVE  SPACES              TO DCP-COD-TPLN IN DCP.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDCPLSGERR' TO LSG-COD-MENS

           GO TO FIN-GRB-DBC-LSG-AVA.

       GRB-DBC-DCE-AVA.
      *    Datos Complementarios Empresas
      *    ------------------------------
      *
      *    Nombre Registro : DCE
           MOVE  SPACES                TO DCE-GLS-FLAG IN DCE.
           MOVE DBC-CIC-ICLI IN DBC    TO DCE-CIC-ICLI IN DCE.
           MOVE HOY-STP-ITRN           TO DCE-STP-ITRN IN DCE.
           MOVE  'I'                   TO DCE-MSC-TACC IN DCE.
           MOVE  'V'                   TO DCE-MSC-STAT IN DCE.
           MOVE  'B   '                TO DCE-COD-OTRN IN DCE.
           MOVE  'DEUDORES'            TO DCE-COD-ATRN IN DCE.

           MOVE  SPACES                TO DCE-GLS-NFAN IN DCE.
           MOVE  SPACES                TO DCE-COD-TSOC IN DCE.
           MOVE  ZEROES                TO DCE-FEC-FCTT IN DCE.
           MOVE  ZEROES                TO DCE-FEC-FUME IN DCE.
           MOVE  ZEROES                TO DCE-FEC-FCAD IN DCE.
           MOVE  SPACES                TO DCE-IND-RAUT IN DCE.
           IF LSG-COD-OFOC IN LSG = '090'
               MOVE 'M'       TO DCE-IND-CMOS IN DCE
           ELSE
               MOVE 'S'       TO DCE-IND-CMOS IN DCE.

           MOVE  SPACES                TO DCE-IND-CATE IN DCE.
           MOVE  SPACES                TO DCE-IND-TEMP IN DCE.
           MOVE LSG-COD-TBAV IN LSG    TO DCE-COD-TBAN IN DCE.
           MOVE  SPACES                TO DCE-COD-TPLN IN DCE.
           MOVE  SPACES                TO DCE-GLS-DISP IN DCE.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDCELSGERR' TO LSG-COD-MENS.

       FIN-GRB-DBC-LSG-AVA.
           EXIT.

       GRB-RDC-LSG-AVA SECTION.
       INI-GRB-RDC-LSG-AVA.

           MOVE DBC-CIC-ICLI IN DBC       TO RDC-CIC-ICLI IN RDC.
           MOVE LSG-CIC-IOPC IN LSG       TO RDC-CIC-IOPC IN RDC.
           MOVE 1                         TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-RDC
               MOVE FIO-MOD TO FIO-CMND.

           PERFORM INI-RDC-LSG.
           MOVE 1               TO RDC-NUM-IDLC IN RDC.
           PERFORM COL-FIO-RDC.

       FIN-GRB-RDC-LSG-AVA.
           EXIT.

       MOD-REG-CLI-AVA SECTION.
       INI-MOD-REG-CLI-AVA.

      *RRM-INI 22-FEB-1999
      *    IF LSG-COD-OFOC IN LSG NOT = '154'
           IF DBC-COD-OFIC IN DBC NOT = '154'
      *RRM-FIN 22-FEB-1999
               GO TO FIN-MOD-REG-CLI-AVA.

           IF LSG-COD-ACAV IN LSG = DBC-COD-ACTI IN DBC AND
              LSG-COD-CLAV IN LSG = DBC-COD-TICL IN DBC
               GO TO CON-MOD-REG-CLI-AVA.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.

           MOVE  LSG-COD-ACAV IN LSG   TO DBC-COD-ACTI IN DBC.
           MOVE  LSG-COD-CLAV IN LSG   TO DBC-COD-TICL IN DBC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'MODDBCLSGERR' TO LSG-COD-MENS
               GO TO FIN-MOD-REG-CLI-AVA.

       CON-MOD-REG-CLI-AVA.

           IF DBC-IND-TICL IN DBC = 'P'
               GO TO ACT-REG-DCP-AVA.

           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDCELSGERR' TO LSG-COD-MENS
               GO TO FIN-MOD-REG-CLI-AVA.

           MOVE LSG-COD-TBAV IN LSG    TO DCE-COD-TBAN IN DCE.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE 'MODDCELSGERR' TO LSG-COD-MENS.
               GO TO FIN-MOD-REG-CLI-AVA.

           ADD 1 TO LSG-REG-DBCR.

           GO TO FIN-MOD-REG-CLI-AVA.

       ACT-REG-DCP-AVA.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE 'UPDDCPLSGERR' TO LSG-COD-MENS
               GO TO FIN-MOD-REG-CLI-AVA.

           MOVE LSG-COD-TBAV IN LSG    TO DCP-COD-TBAN IN DCP.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE 'MODDCPLSGERR' TO LSG-COD-MENS
               GO TO FIN-MOD-REG-CLI-AVA.

           ADD 1 TO LSG-REG-DBCR.

       FIN-MOD-REG-CLI-AVA.
           EXIT.
      *ALD-BCI-FIN/01.02.1999
