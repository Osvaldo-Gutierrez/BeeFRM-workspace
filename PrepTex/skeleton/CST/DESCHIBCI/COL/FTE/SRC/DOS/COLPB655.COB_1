       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID. COLPB655.
       AUTHOR.     P.JELDRES.
       DATE-WRITTEN. 04/09/1991.
       DATE-COMPILED.
      *REMARKS.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 30 DE MARZO DE 1998                                    *
      ******************************************************************
      ******************************************************************
      *  SISTEMA  : COLOCACIONES                                       *
      *  OBJETIVO : EMITIR UN INFORME DE CANCELACIONES DE CREDITOS     *
      *             DE 'LOS PARQUES' S.A.                              *
      *                                                                *
      *  ARCHIVOS :                                                    *
      *   ENTRADA :TABLAS DE BASE DE DATOS : OPC,CAN,RCV,DBC,RDC       *
      *   SALIDA  :LISTADO DE PLANILLA DE DESCUENTO AL PERSONAL        *
      *                                                                *
      *                                                                *
      *  MANTENCIONES                                                  *
      *  ============                                                  *
      *            PROGRAMADOR:                                        *
      *            FECHA      : DD/MM/AA                               *
      *            CAMBIO     :                                        *
      *                                                                *
      *                                                                *
      *                                                                *
      *                                                                *
      ******************************************************************
      ******************************************************************
      *      MANTENCIONES.
      *      ==============
      *
      *      PROGRAMADOR : FORMAT 2000 INC.
      *      FECHA       : 20.02.1998
      *      CAMBIO      : SE APLICA TECNICA WINDOWING PARA CONVERSION
      *                      2000 COMPLIANT.
      ******************************************************************
           EJECT
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
                     C01 IS CANAL-1
                     DECIMAL-POINT IS COMMA.
      *
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
           SELECT LISTADO     ASSIGN TO UR-S-LISTADO.
           SELECT SORTWK      ASSIGN TO SYS001-DA-3340-S-SORTWK1.
           EJECT
       DATA DIVISION.
      *=============
       FILE SECTION.
      *
      *
       FD  LISTADO
           LABEL RECORD OMITTED
           RECORD CONTAINS 133 CHARACTERS.

       01  LINEA PIC X(133).
       SD  SORTWK
           LABEL RECORD STANDARD
           RECORD CONTAINS 120 CHARACTERS.
       01  REG-SORT.
           05 SOR-NOMBRE                    PIC  X(39).
           05 SOR-CLAVE.
              10 SOR-COD-01.
                 14 SOR-COD                 PIC  X.
                 14 SOR-SUCURSAL            PIC  9(03).
              10 SOR-CODIGO-OPER.
                 14 SOR-COD-OPER            PIC  9(03).
                 14 SOR-SERIAL-OPER         PIC  9(05).
              10 SOR-CAN                    PIC  999.
           05 SOR-RUT-DD.
              10 SOR-RUT-DD-DIG             PIC  9(09).
              10 SOR-RUT-DD-VER             PIC  X(01).
           05 SOR-FECHA-VEN                 PIC  X(8).
           05 SOR-VALOR-CUOTA               PIC  S9(11)V9(4) COMP-3.
           05 SOR-TOTAL-PAGADO              PIC  S9(11)V9(4) COMP-3.
           05 SOR-CAPITAL                   PIC  S9(11)V9(4) COMP-3.
           05 SOR-REAJUSTES                 PIC  S9(11)V9(4) COMP-3.
           05 SOR-INTERESES                 PIC  S9(11)V9(4) COMP-3.
           05 SOR-INT-MORA                  PIC  S9(11)V9(4) COMP-3.
           EJECT
       WORKING-STORAGE SECTION.
      *-----------------------
       01  F-FILE-STATUS.
           05 FS-CREDIT                   PIC 99      VALUE 0.
           05 FS-CREDIT-AUX               PIC 99      VALUE 0.
           05 FS-CUOTAS                   PIC 99      VALUE 0.
           05 FS-TABOPE                   PIC 99      VALUE 0.
       01  W-REGISTROS-DE-TRABAJO.
           05 WR-EST-MOROSO               PIC XX          VALUE SPACES.
           05 WR-VALOR-WS                 PIC S9(12)V9999 VALUE 0.
           05 WR-VALOR-COMPAR             PIC S9(12)V9999 VALUE 0.
           05 WR-VALOR-WS1                PIC S9(12)V9999 VALUE 0.
           05 WR-VALOR-WS3                PIC S9(12)V999  VALUE 0.
           05 WR-VALOR-WSS                PIC S9(12)      VALUE 0.
           05 WR-VALOR-WSS2               PIC S9(12)      VALUE 0.
           05 WR-VALOR-WSS1               PIC S9(12)V9999 VALUE 0.
           05 WR-VALOR-WSS3               PIC S9(12)V9999 VALUE 0.
           05 WR-TOT-PAGADO               PIC S9(12)V9999 VALUE 0.
           05 WR-VEN-AUX-WS               PIC 999         VALUE 0.
           05 WR-CP                       PIC 9(5)        VALUE 0.
           05 WR-CL                       PIC 99          VALUE 0.
           05 WR-COD-ANT                  PIC X(10)       VALUE SPACES.
           05 WR-MENSAJE                  PIC X(40)       VALUE SPACES.
           05 WR-SECCION                  PIC X(40)       VALUE SPACES.
           05 WR-PARRAFO                  PIC X(40)       VALUE SPACES.
           05 WR-OPERACION                PIC X(40)       VALUE SPACES.
           05 WR-ICG-WS                   PIC X(15)       VALUE SPACES.
           05 WR-STATUS                   PIC 99          VALUE 0.
           05 WR-CLAVE                    PIC X(20)       VALUE SPACES.
           05 WR-NRO-CUOTA                PIC 999         VALUE 0.
           05 WR-TOTAL-CUOTAS             PIC 999         VALUE 0.
           05 WR-RUT-DD                   PIC 9(8)        VALUE 0.
           05 WR-DV-DD                    PIC X           VALUE SPACES.
           05 WR-COD-CAN-WS.
              10 WR-CAN-1                 PIC X           VALUE SPACES.
              10 WR-CAN-2                 PIC XX          VALUE SPACES.
           05 WR-RDC-WS.
              10 WR-RDC-A                 PIC X(12)       VALUE SPACES.
              10 WR-RDC-B                 PIC 999         VALUE 0.
           05 WR-COLOCACION-WS.
              10 WR-OPERAC-WS             PIC XXX         VALUE SPACES.
              10 WR-SERIAL-WS             PIC X(5)        VALUE SPACES.
           05 WR-SERIAL-ANT               PIC 9(5)        VALUE 0.
           05 WR-PRIMER-CRED.
              10 WR-PRIMER-CRED1          PIC X(3)        VALUE SPACES.
              10 WR-PRIMER-CRED2          PIC X(3)        VALUE SPACES.
              10 WR-PRIMER-CRED3          PIC X(5)        VALUE SPACES.
           05 WR-MONEDA.
              10 WR-MONEDA-1              PIC X           VALUE SPACE.
              10 WR-MONEDA-2              PIC X(3)        VALUE SPACES.
           05 WR-FECHA.
              10 WR-ANO                   PIC X(02)       VALUE SPACES.
              10 WR-MES                   PIC X(02)       VALUE SPACES.
              10 WR-DIA                   PIC X(02)       VALUE SPACES.
           05 WR-FECHA-VEN.
              10 WR-ANO-VEN1              PIC X(02)       VALUE SPACES.
              10 WR-ANO-VEN2              PIC X(02)       VALUE SPACES.
              10 WR-MES-VEN               PIC X(02)       VALUE SPACES.
              10 WR-DIA-VEN               PIC X(02)       VALUE SPACES.
           05 WR-RUT-A                    PIC 9(8)        VALUE 0.
           05 WR-DV-A                     PIC X           VALUE SPACE.
           05 WR-NOMBRE-A.
              10 WR-APAT-A                PIC X(13)       VALUE SPACES.
              10 WR-AMAT-A                PIC X(13)       VALUE SPACES.
              10 WR-NOMBR-A               PIC X(13)       VALUE SPACES.
           05 WR-RNOMBRE-A REDEFINES WR-NOMBRE-A.
              10 WR-NOMBRE1-A             PIC X(25).
              10 WR-NOMBRE2-A             PIC X(14).
           05 WR-D02-NOMBRE.
              10 WR-D02-NOM1              PIC X(25)       VALUE SPACES.
              10 WR-D02-NOM2              PIC X(15)       VALUE SPACES.
           05 WR-D02-NOMBRE25.
              10 WR-D02-APAT25            PIC X(25)       VALUE SPACES.
              10 WR-D02-AMAT25            PIC X(25)       VALUE SPACES.
              10 WR-D02-NOMB25            PIC X(25)       VALUE SPACES.
           05 WR-D02-N1                  REDEFINES WR-D02-NOMBRE25.
              10 WR-D02-N1A               PIC X(01) OCCURS 75 TIMES.
           05 WR-D02-N2.
              10 WR-D02-N2A               PIC X(01) OCCURS 40 TIMES.
           05 WR-W-NOM.
              10 WR-INDN                  PIC X(01)       VALUE SPACES.
              10 WR-IND1                  PIC 9(03)       VALUE 0.
              10 WR-IND2                  PIC 9(03)       VALUE 0.
           05 WR-CAN-WS.
              10 WR-CAN-WS1               PIC X(4)        VALUE SPACES.
              10 WR-CAN-WS2               PIC X(12)       VALUE SPACES.
           SKIP2
       01  W-ACUMULADORES.
           05 WA-OPC-LEIDOS               PIC 9(07)       VALUE 0.
           05 WA-CAN-LEIDOS               PIC 9(07)       VALUE 0.
           05 WA-DLC-LEIDOS               PIC 9(07)       VALUE 0.
           05 WA-RCV-LEIDOS               PIC 9(07)       VALUE 0.
           05 WA-DCC-LEIDOS               PIC 9(07)       VALUE 0.
           05 WA-OPC-SELECCIONADOS        PIC 9(07)       VALUE 0.
           05 WA-RDC-LEIDOS               PIC 9(07)       VALUE 0.
           05 WA-DBC-LEIDOS               PIC 9(07)       VALUE 0.
           05 WA-LEIDOS-999               PIC 9(07)       VALUE 0.
           05 WA-CRED-LEIDOS              PIC 9(07)       VALUE 0.
           05 WA-CRED-CREADOS             PIC 9(07)       VALUE 0.
           05 WA-CRED-BORRADOS            PIC 9(07)       VALUE 0.
           05 WA-CUOT-LEIDAS              PIC 9(07)       VALUE 0.
           05 WA-REG-SORT-GRA             PIC 9(07)       VALUE 0.
           05 WA-REG-SORT-LEI             PIC 9(07)       VALUE 0.
           03 WA-CUOT-CREADAS              PIC 9(07)      VALUE 0.
           03 WA-CUOT-BORRADAS             PIC 9(07)      VALUE 0.
           03 WA-ACUM-CINTA                PIC 9(07)      VALUE 0.
           03 WA-ACUM-AUX                  PIC 9(07)      VALUE 0.
           03 WA-ACUM-CAN                  PIC 9(07)      VALUE 0.
           03 WA-TAR-LEIDAS                PIC 9(07)      VALUE 0.
           SKIP2
       01  W-PARAMETRO.
           05 FILLER                       PIC X(01).
           05 WP-FECHA-PROCESO.
              10 WP-FECHA-PROCESO-SS       PIC 99.
              10 WP-FECHA-PROCESO-AA       PIC 99.
              10 WP-FECHA-PROCESO-MM       PIC 99.
              10 WP-FECHA-PROCESO-DD       PIC 99.
           05 FILLER                       PIC X(71).
           SKIP2
       01  W-SWITCHES.
           03 WS-RETURN-CODE               PIC 9(03)      VALUE 0.
           03 WS-SW-OPC                    PIC 9          VALUE 0.
           03 WS-SW-CAN                    PIC X(03)      VALUE SPACES.
           03 WS-SW-CAN-RCV                PIC 9          VALUE 0.
           03 WS-SW-PASO                   PIC 9          VALUE 0.
           03 WS-SW-DLC                    PIC 9          VALUE 0.
           03 WS-SW-RCV                    PIC 9          VALUE 0.
           03 WS-SW-RDC                    PIC 9          VALUE 0.
           03 WS-SW-TAB                    PIC 9          VALUE 0.
           03 WS-SW-CRED                   PIC 9          VALUE 0.
           03 WS-SW-MODIF                  PIC 9          VALUE 0.
           03 WS-SW-DCC                    PIC 9          VALUE 0.
           03 WS-SW-1                      PIC 9          VALUE 0.
           03 WS-ERROR                     PIC X(02)      VALUE SPACES.
           03 WS-SW-ERROR                  PIC 9(01)      VALUE 0.
           03 WS-FIN-SORT                  PIC X(03)      VALUE SPACES.
           SKIP2
       01  W-TABLAS.
           03 WT-FIN-DATOS                 PIC X(02) VALUE SPACES.
           03 WT-PIL-CONT                  PIC 9(6) COMP-3 VALUE 0.
           03 WT-PILOTO OCCURS 50 TIMES INDEXED BY TCX.
              05 WT-OPERAC                 PIC 9(03).
           SKIP2
      *01  W-CONSTANTES-REFERENCIALES.
      *    03 CC-XXXXXXXXX                 PIC X(03) VALUE 'GGGGGG'.
           SKIP2
      * FECHA DE SISTEMA.
       01  FECHA-PROCESO.
           03 DD-CURRENT                   PIC 9(02).
           03 FILLER                       PIC X(01) VALUE '/'.
           03 MM-CURRENT                   PIC 9(02).
           03 FILLER                       PIC X(01) VALUE '/'.
           03 AA-CURRENT                   PIC 9(02).
       01  FECHA-PROCESO2.
           03 MM-CURRENT2                  PIC 9(02).
           03 FILLER                       PIC X(01) VALUE '/'.
           03 DD-CURRENT2                  PIC 9(02).
           03 FILLER                       PIC X(01) VALUE '/'.
           03 AA-CURRENT2                  PIC 9(02).
      * PARAMETROS RUTINA RUTUVALF
       01  PARAM-RUTUVALF.
           05 RTNWVALF-FECHA.
              10 RTNWVALF-FECHA-DD PIC X(2).
              10 RTNWVALF-FECHA-MM PIC X(2).
              10 RTNWVALF-FECHA-AM PIC X(2).
              10 RTNWVALF-FECHA-AA PIC X(2).
           05 RTNWVALF-COD-RET     PIC 9.
       01  TIT-1.
           05 FILLER PIC X(46) VALUE 'BANCO DE CREDITO E INVERSIONES'.
           05 FILLER    PIC X(70) VALUE
           'CANCELACIONES CREDITOS LOS PARQUES S.A.'.
           05 FILLER    PIC X(7) VALUE 'FECHA:'.
           05 T1-FECHA  PIC X(8).
       01  TIT-2.
           05 FILLER PIC X(45) VALUE 'COLOCACIONES'.
           05 FILLER PIC X(71) VALUE
           '---------------------------------------'.
           05 FILLER PIC X(7) VALUE 'PAG  :'.
           05 PAG-T1 PIC ZZZ9.
       01  TIT-2A.
           05 FILLER PIC X(50)  VALUE SPACES.
           05 FILLER PIC X(20)   VALUE 'FECHA CANCELACION :'.
           05 DD-2A  PIC 99.
           05 FILLER PIC X      VALUE '/'.
           05 MM-2A  PIC 99.
           05 FILLER PIC X      VALUE '/'.
           05 AA-2A1 PIC 99.
           05 AA-2A2 PIC 99B(36).
      *    05 FILLER PIC X(9)  VALUE 'SUCURSAL:'.
      *    05 SUC-SALIDA PIC X(25)B(32).
           05 FILLER PIC X(14)  VALUE 'PROGR:COLPB655'.
       01  TIT-2B.
           05 FILLER    PIC X(6) VALUE 'CLASE:'.
           05 MONEDA-2B PIC X(4)B.
           05 CLASE-2B  PIC X(6)B.
           05 GLOSA-2B  PIC X(40).
       01  RAYA PIC X(132) VALUE ALL '-'.
       01  ESPA PIC X(132) VALUE ALL SPACES.
      *
       01  TIT-3.
           05 FILLER          PIC X(42)  VALUE
           '           N O M B R E'.
           05 FILLER          PIC X(36)  VALUE
           'R U T       OPERACION       F.VENC.'.
           05 FILLER          PIC X(50)  VALUE
           ' VALOR CUOTA(UF)  VALOR TOT.PAG.($)       CAPITAL'.
      *
       01  TIT-4.
           05 FILLER          PIC X(52)  VALUE SPACES.
           05 FILLER          PIC X(18)  VALUE
           'C.A.  NUM.    VEN'.
           05 FILLER          PIC X(30)  VALUE
           '            REAJUSTES($)'.
           05 FILLER          PIC X(30)  VALUE
           '  INTERESES      INT. DE MORA'.
      *
       01  DETA-01.
           05 NOMBRE-01        PIC X(39)B.
           05 RUT-01           PIC 9(9).
           05 FILLER           PIC X       VALUE '-'.
           05 DV-01            PIC XB.
           05 OPERAC-01        PIC XXXXB.
           05 OPERAC-02        PIC X(8)B.
           05 OPERAC-03        PIC XXXB.
           05 DIA-01           PIC XX.
           05 FILLER           PIC X VALUE '/'.
           05 MES-01           PIC XX.
           05 FILLER           PIC X VALUE '/'.
           05 ANO-01           PIC XX.
           05 VALOR-CUOTA-01   PIC ZZZZ.ZZZ.ZZ9,9999.
           05 VALOR-TOT-PAG-01 PIC ZZZZZ.ZZZ.ZZ9,9999.
           05 CAPITAL-01       PIC ZZZZZ.ZZZ.ZZ9,9999BB.
      *
      *
      *
       01  DETA-02.
           05 FILLER           PIC X(77) VALUE SPACES.
           05 REAJUSTES-01     PIC ZZZZZ.ZZZ.ZZ9,9999.
           05 INTERESES-01     PIC ZZZZZ.ZZZ.ZZ9,9999.
           05 INT-DE-MORA-01   PIC ZZZZZ.ZZZ.ZZ9,9999.
       01  LTOTAL-01.
           05 FILLER              PIC X(72) VALUE SPACES.
           05 FILLER              PIC X(23) VALUE
           'VALOR TOTAL PAGADO :'.
           05 TOT-PAGA-01        PIC ZZZZZ.ZZZ.ZZ9,9999.
       01  LTOTAL-02.
           05 FILLER              PIC X(65) VALUE SPACES.
           05 TOT-SALDO-ACTUAL-01 PIC ZZZZZ.ZZZ.ZZ9,9999B(47).



           EJECT
      ******************************************************************
      *      USER INFORMATION BLOCK                                    *
      ******************************************************************
      *
       01  UIB.
           03 FILLER               PIC X(32) VALUE 'COLPB655'.
      *
      ******************************************************************
      *      REQUEST AREA                                              *
      ******************************************************************
      *
       01  REQ-AREA-OPC.
           03 OPC-COMMAND          PIC X(5).
           03 OPC-TABLE            PIC X(3) VALUE 'OPC'.
           03 OPC-KEY              PIC X(5).
           03 OPC-RET-COD          PIC X(2) VALUE SPACES.
           03 REQ-INT-RTN-CD       PIC X(1).
           03 OPC-DB-ID            PIC S9(4) COMP VALUE +160.
           03 OPC-REC-ID           PIC X(7).
           03 FILLER               PIC X(25).
           03 OPC-CONT-MAX         PIC S9(4) COMP.
           03 OPC-IO-COUNT         PIC S9(4) COMP.
           03 FILLER               PIC X(22).
           03 OPC-VALUE            PIC X(50).
       01  REQ-AREA-DLC.
           03 DLC-COMMAND          PIC X(5).
           03 DLC-TABLE            PIC X(3) VALUE 'DLC'.
           03 DLC-KEY              PIC X(5).
           03 DLC-RET-COD          PIC X(2) VALUE SPACES.
           03 REQ-INT-RTN-CD       PIC X(1).
           03 DLC-DB-ID            PIC S9(4) COMP VALUE +160.
           03 DLC-REC-ID           PIC X(7).
           03 FILLER               PIC X(25).
           03 DLC-CONT-MAX         PIC S9(4) COMP.
           03 DLC-IO-COUNT         PIC S9(4) COMP.
           03 FILLER               PIC X(22).
           03 DLC-VALUE            PIC X(50).
       01  REQ-AREA-VEN.
           03 VEN-COMMAND          PIC X(5).
           03 VEN-TABLE            PIC X(3) VALUE 'VEN'.
           03 VEN-KEY              PIC X(5).
           03 VEN-RET-COD          PIC X(2) VALUE SPACES.
           03 REQ-INT-RTN-CD       PIC X(1).
           03 VEN-DB-ID            PIC S9(4) COMP VALUE +160.
           03 VEN-REC-ID           PIC X(7).
           03 FILLER               PIC X(25).
           03 VEN-CONT-MAX         PIC S9(4) COMP.
           03 VEN-IO-COUNT         PIC S9(4) COMP.
           03 FILLER               PIC X(22).
           03 VEN-VALUE            PIC X(50).
       01  REQ-AREA-CAN.
           03 CAN-COMMAND          PIC X(5).
           03 CAN-TABLE            PIC X(3) VALUE 'CAN'.
           03 CAN-KEY              PIC X(5).
           03 CAN-RET-COD          PIC X(2) VALUE SPACES.
           03 CAN-INT-RTN-CD       PIC X(1).
           03 CAN-DB-ID            PIC S9(4) COMP VALUE +160.
           03 CAN-REC-ID           PIC X(7).
           03 FILLER               PIC X(25).
           03 CAN-CONT-MAX         PIC S9(4) COMP.
           03 CAN-IO-COUNT         PIC S9(4) COMP.
           03 FILLER               PIC X(22).
           03 CAN-VALUE            PIC X(50).
       01  REQ-AREA-RCV.
           03 RCV-COMMAND          PIC X(5).
           03 RCV-TABLE            PIC X(3) VALUE 'RCV'.
           03 RCV-KEY              PIC X(5).
           03 RCV-RET-COD          PIC X(2) VALUE SPACES.
           03 RCV-INT-RTN-CD       PIC X(1).
           03 RCV-DB-ID            PIC S9(4) COMP VALUE +160.
           03 RCV-REC-ID           PIC X(7).
           03 FILLER               PIC X(25).
           03 RCV-CONT-MAX         PIC S9(4) COMP.
           03 RCV-IO-COUNT         PIC S9(4) COMP.
           03 FILLER               PIC X(22).
           03 RCV-VALUE            PIC X(50).
       01  REQ-AREA-RDC.
           03 RDC-COMMAND         PIC X(5).
           03 RDC-TABLE           PIC X(3)     VALUE 'RDC'.
           03 RDC-KEY             PIC X(5).
           03 RDC-RET-COD         PIC X(2)     VALUE SPACES.
           03 RDC-INT-RC          PIC X(1).
           03 RDC-DB-ID           PIC S9(4)    COMP VALUE +160.
           03 RDC-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 RDC-CONT-MAX        PIC S9(4)    COMP.
           03 RDC-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 RDC-VALUE           PIC X(40).

       01  REQ-AREA-DCC.
           03 DCC-COMMAND         PIC X(5).
           03 DCC-TABLE           PIC X(3)     VALUE 'DCC'.
           03 DCC-KEY             PIC X(5).
           03 DCC-RET-COD         PIC X(2)     VALUE SPACES.
           03 DCC-INT-RC          PIC X(1).
           03 DCC-DB-ID           PIC S9(4)    COMP VALUE +210.
           03 DCC-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 DCC-CONT-MAX        PIC S9(4)    COMP.
           03 DCC-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 DCC-VALUE           PIC X(40).
       01  REQ-AREA-DBC.
           03 DBC-COMMAND         PIC X(5).
           03 DBC-TABLE           PIC X(3)     VALUE 'DBC'.
           03 DBC-KEY             PIC X(5).
           03 DBC-RET-COD         PIC X(2)     VALUE SPACES.
           03 DBC-INT-RC          PIC X(1).
           03 DBC-DB-ID           PIC S9(4)    COMP VALUE +100.
           03 DBC-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 DBC-CONT-MAX        PIC S9(4)    COMP.
           03 DBC-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 DBC-VALUE           PIC X(40).
       01  REQ-AREA-TAB.
           03 TAB-COMMAND         PIC X(5).
           03 TAB-TABLE           PIC X(3)     VALUE 'TAB'.
           03 TAB-KEY             PIC X(5).
           03 TAB-RET-COD         PIC X(2)     VALUE SPACES.
           03 TAB-INT-RC          PIC X(1).
           03 TAB-DB-ID           PIC S9(4)    COMP VALUE +210.
           03 TAB-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 TAB-CONT-MAX        PIC S9(4)    COMP.
           03 TAB-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 TAB-VALUE           PIC X(40).
       01  REQ-AREA-CAM.
           03 CAM-COMMAND         PIC X(5).
           03 CAM-TABLE           PIC X(3)     VALUE 'CAM'.
           03 CAM-KEY             PIC X(5).
           03 CAM-RET-COD         PIC X(2)     VALUE SPACES.
           03 CAM-INT-RC          PIC X(1).
           03 CAM-DB-ID           PIC S9(4)    COMP VALUE +150.
           03 CAM-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 CAM-CONT-MAX        PIC S9(4)    COMP.
           03 CAM-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 CAM-VALUE           PIC X(40).
           EJECT
      *
      ******************************************************************
      *                   WORK AREA                                    *
      ******************************************************************
      *
      *
       77  LIT-50            PIC 9(2) VALUE 50.


       COPY COLWGVEN.
      *COPY GNSWGIFD.
       COPY GNSWVIDD.
       COPY GNSBRMSG.
       COPY COLBROPC.
       COPY COLBRCAN.
       COPY COLBRDCC.
       COPY COLBRRDC.
       COPY COLBRCYA.
       COPY SGCBRDBC.
       COPY TABBRCAM.
      * **************************************************************
       COPY COLBRVEN.
       COPY GNSBRTAB.
       COPY GNSBRMSC.
       COPY COLBRICG.
       COPY COLBRTOC.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRRCV.
      * ** COPY COLBRRCE.
      * *********************************************************
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
      * *********************************************************
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
      * ** COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
      * *************************************************************
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGSYS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRQA.
       COPY GNSWGELS.
       COPY GNSWGUIB.
      *COPY GNSWGINT.
       COPY COLWGINT.
       COPY GNSWGCVI.
       COPY GNSWGPES.
      *01  R-OPC.
      *    COPYDD COL-R-OPC.COL-E-OPC00(PROD),01,D
      *01  R-CAN.
      *    COPYDD COL-R-CAN.COL-E-CAN00(PROD),01,D
      *01  R-RCV.
      *    COPYDD COL-R-RCV.COL-E-RCV00(PROD),01,D
      *01  REG-RDC.
      *    COPYDD COL-R-RDC.COL-E-RDC00(PROD),01,D
      *01  REG-DBC.
      *    COPYDD DGC-R-DBC.DGC-E-DBC00(PROD),01,D
      *01  REG-TAB.
      *    COPYDD TAB-R-TAB.TAB-E-TAB00(PROD),01,D
      ******************************************************************
      *                 ELEMENT LIST                                   *
      ******************************************************************
      *
       01  ELEM-LIST-OPC.
           03 ELEM-1         PIC X(05) VALUE 'OPC00'.
           03 ELEM-SEC       PIC X(01).
           03 FILLER         PIC X(05) VALUE SPACES.
       01  ELEM-LIST-DLC.
           03 ELEM-1         PIC X(05) VALUE 'DLC00'.
           03 ELEM-SEC       PIC X(01).
           03 FILLER         PIC X(05) VALUE SPACES.
       01  ELEM-LIST-VEN.
           03 ELEM-1         PIC X(05) VALUE 'VEN00'.
           03 ELEM-SEC       PIC X(01).
           03 FILLER         PIC X(05) VALUE SPACES.
       01  ELEM-LIST-CAN.
           03 ELEM-1         PIC X(05) VALUE 'CAN00'.
           03 ELEM-SEC       PIC X(01).
           03 FILLER         PIC X(05) VALUE SPACES.
       01  ELEM-LIST-RCV.
           03 ELEM-1         PIC X(05) VALUE 'RCV00'.
           03 ELEM-SEC       PIC X(01).
           03 FILLER         PIC X(05) VALUE SPACES.
       01  ELEM-LIST-RDC.
           05 ELEM-1          PIC X(5) VALUE 'RDC00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-DBC.
           05 ELEM-1          PIC X(5) VALUE 'DBC00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-TAB.
           05 ELEM-1          PIC X(5) VALUE 'TAB00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-DCC.
           05 ELEM-1          PIC X(5) VALUE 'DCC00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-CAM.
           05 ELEM-1          PIC X(5) VALUE 'CAM00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  LEGA-DATE-BLOCK.
           05 COBOL-II-DATE.
              10 COBOL-II-YEAR
                              PIC XX.
              10 COBOL-II-MONTH
                              PIC XX.
              10 COBOL-II-DAY PIC XX.
           05 OSVS-CURRENT-DATE.
              10 CURRENT-DATE-MONTH
                              PIC XX.
              10 FILLER       PIC X    VALUE '/'.
              10 CURRENT-DATE-DAY
                              PIC XX.
              10 FILLER       PIC X    VALUE '/'.
              10 CURRENT-DATE-YEAR
                              PIC XX.

           COPY RLOVR001.
       77  Y2K-FEC-AVLD       PIC 9(2).
       77  Y2K-LIT-50         PIC 9(2).
       77  Y2K-FEC-AEC1       PIC 9(2).
       77  Y2K-FEC-AEC2       PIC 9(2).
           EJECT
       PROCEDURE DIVISION.
      *==================
       A-CONTROL SECTION.
      *=================
           ENTRY 'DBMSCBL'.
           MOVE 'COLPB655' TO FIO-PROG.
      *    PERFORM BUS-FSIS.
           PERFORM GNS-BUS-IDD.
       AA-INICIALIZACION.
           PERFORM B-INICIALIZAR.
       AB-PROCESAMIENTO.
           SORT SORTWK ON ASCENDING KEY SOR-NOMBRE
           INPUT PROCEDURE C-ENTRADA
           OUTPUT PROCEDURE D-SALIDA.
       AC-TERMINO.
           PERFORM E-TERMINAR.
       AZ-FIN-DE-PROCESO.
           GOBACK.
           EJECT
       B-INICIALIZAR SECTION.
      *=====================
       BA-CONTROL.
      *----------
           PERFORM BC-ACEPTAR-PARAMETROS.
           PERFORM BD-VALIDAR-PARAMETROS.
           IF WS-RETURN-CODE = 100
              GO TO BZ-FIN-DE-SECCION.
           PERFORM BE-ABRIR-ARCHIVOS.
           GO TO BZ-FIN-DE-SECCION.
           SKIP1
       BC-ACEPTAR-PARAMETROS.
      *---------------------

      *    ACCEPT WR-FECHA FROM DATE.
      *    MOVE WR-DIA       TO DD-CURRENT.
      *    MOVE WR-MES       TO MM-CURRENT.
      *    MOVE WR-ANO       TO AA-CURRENT.
           ACCEPT W-PARAMETRO
           DISPLAY 'PARAMETRO INGRESADO :' W-PARAMETRO.
           SKIP1
       BD-VALIDAR-PARAMETROS.
      *----------------------
           MOVE WP-FECHA-PROCESO-SS TO RTNWVALF-FECHA-AM
           MOVE WP-FECHA-PROCESO-AA TO RTNWVALF-FECHA-AA
           MOVE WP-FECHA-PROCESO-MM TO RTNWVALF-FECHA-MM
           MOVE WP-FECHA-PROCESO-DD TO RTNWVALF-FECHA-DD
           CALL 'RTNUVALF' USING RTNWVALF-FECHA RTNWVALF-COD-RET
           IF RTNWVALF-COD-RET > 0
              MOVE 100 TO WS-RETURN-CODE
              MOVE 'B-INICIALIZAR'        TO WR-SECCION
              MOVE 'BD-VALIDAR-PARAMETRO' TO WR-PARRAFO
              MOVE 'VALIDA FECHA'         TO WR-OPERACION
              MOVE RTNWVALF-COD-RET       TO WR-STATUS
              MOVE WP-FECHA-PROCESO       TO WR-CLAVE.
      ****    GO TO BZ-FIN-DE-SECCION.

              MOVE 70 TO WR-CL
              ACCEPT COBOL-II-DATE FROM DATE
              MOVE COBOL-II-YEAR TO CURRENT-DATE-YEAR
              MOVE COBOL-II-MONTH TO CURRENT-DATE-MONTH
              MOVE COBOL-II-DAY TO CURRENT-DATE-DAY
              MOVE OSVS-CURRENT-DATE TO FECHA-PROCESO2
              MOVE DD-CURRENT2            TO DD-CURRENT
              MOVE MM-CURRENT2            TO MM-CURRENT
              MOVE AA-CURRENT2            TO AA-CURRENT
              MOVE FECHA-PROCESO          TO T1-FECHA
              MOVE WP-FECHA-PROCESO-SS    TO AA-2A1
              MOVE WP-FECHA-PROCESO-AA    TO AA-2A2
              MOVE WP-FECHA-PROCESO-MM    TO MM-2A
              MOVE WP-FECHA-PROCESO-DD    TO DD-2A.
       BE-ABRIR-ARCHIVOS.
      *-----------------
           OPEN OUTPUT LISTADO.
           SKIP1
       BZ-FIN-DE-SECCION.
      *-----------------
           EXIT.
           EJECT
       C-ENTRADA SECTION.
      *==================
       CA-PROCESO-ENTRADA.
      *-----------------
           PERFORM CB-LEER-CAN-INI
           PERFORM CC-PROCESO-CAN UNTIL WS-SW-CAN = 'FIN' OR
                                        WS-RETURN-CODE = 100.
       D-SALIDA SECTION.
      *=================
       DA-PROC-SALIDA.
      *-------------
             IF WS-RETURN-CODE = 100
                GO TO DY-FIN-SECCION.
             RETURN SORTWK AT END MOVE 'FIN' TO WS-FIN-SORT.
             PERFORM DB-IMPRIMIR UNTIL WS-FIN-SORT =  'FIN'.
             MOVE WR-TOT-PAGADO    TO TOT-PAGA-01
             WRITE LINEA FROM LTOTAL-01  AFTER 2.
      *      WRITE LINEA FROM LTOTAL-02  AFTER 1.
       DY-FIN-SECCION.
      *----------------
       DZ-FIN-SALIDA SECTION.
      *======================
       CB-LEER-CAN-INI.
      *-----------------
           MOVE SPACES  TO CAN-VALUE
           MOVE WP-FECHA-PROCESO           TO CAN-VALUE
           MOVE 'CAN03'                    TO CAN-KEY
           MOVE SPACES                     TO WS-SW-CAN.

           MOVE 'LOCKY'                   TO CAN-COMMAND
           CALL 'DBNTRY' USING UIB REQ-AREA-CAN CAN ELEM-LIST-CAN
           IF CAN-RET-COD = SPACES
               MOVE 'CAN03'                   TO CAN-KEY
               MOVE 'REDLE'                   TO CAN-COMMAND
               CALL 'DBNTRY' USING UIB REQ-AREA-CAN CAN ELEM-LIST-CAN
               IF CAN-RET-COD NOT = SPACES
                   MOVE 'C-ENTRADA'       TO WR-SECCION
                   MOVE 'CD-LEER-CAN-INI' TO WR-PARRAFO
                   MOVE 'REDLE CAN03    ' TO WR-OPERACION
                   MOVE CAN-RET-COD       TO WR-STATUS
                   MOVE CAN-VALUE         TO WR-CLAVE
                   MOVE 100               TO WS-RETURN-CODE
               ELSE
                   ADD 1 TO WA-CAN-LEIDOS
           ELSE
              MOVE 'C-ENTRADA'       TO WR-SECCION
              MOVE 'CD-LEER-CAN-INI' TO WR-PARRAFO
              MOVE 'LOCKY CAN03    ' TO WR-OPERACION
              MOVE CAN-RET-COD       TO WR-STATUS
              MOVE CAN-VALUE         TO WR-CLAVE
              MOVE 100               TO WS-RETURN-CODE.



       CC-PROCESO-CAN.
      *----------------
      *    DISPLAY '*******************************************'
      *    DISPLAY 'CLAVE 1:' OPC-KEY-IOPC
           MOVE ZEROS TO REG-SORT
           MOVE 0     TO WS-SW-ERROR
           MOVE CAN-COD-OTRN TO WR-CAN-WS1
           MOVE CAN-COD-ATRN TO WR-CAN-WS2
           IF CAN-FEC-FOUT = WP-FECHA-PROCESO AND
              CAN-COD-TOPC = 'D'
              IF CAN-MSC-STAT = 'A'
                 MOVE 0 TO WS-SW-OPC
                 PERFORM CD-LEER-OPC
                 IF WS-SW-OPC = 0
                    IF OPC-COD-VCOC = '0998  '
                        IF OPC-COD-TOOC = 'ECA'
                           IF (OPC-COD-AOOC = '101' OR
                               OPC-COD-AOOC = '103')
                               ADD 1 TO WA-OPC-SELECCIONADOS
                               PERFORM CF-LEER-DLC.

                 PERFORM CE-LEER-CAN.
       CD-LEER-OPC.
      *-------------
           MOVE SPACES                        TO OPC-VALUE
           MOVE CAN-CIC-IOPC                  TO OPC-CIC-IOPC
           MOVE CAN-CIC-IOPC                  TO OPC-VALUE
           MOVE 'OPC00'                       TO OPC-KEY
           MOVE 'REDKY'                       TO OPC-COMMAND
           CALL 'DBNTRY' USING UIB REQ-AREA-OPC OPC ELEM-LIST-OPC
           IF OPC-RET-COD NOT = SPACES
              MOVE 'C-PROCESAR'     TO WR-SECCION
              MOVE 'CX-LEER-OPC'    TO WR-PARRAFO
              MOVE 'REDKY OPC00   ' TO WR-OPERACION
              MOVE OPC-RET-COD      TO WR-STATUS
              MOVE OPC-VALUE        TO WR-CLAVE
              PERFORM CX-DESPLEGAR-MENSAJES
              MOVE 1 TO WS-SW-OPC
           ELSE
              ADD 1 TO WA-OPC-LEIDOS.

       CE-LEER-CAN.
      *-------------
           MOVE 'REDNX'                  TO CAN-COMMAND
           MOVE 'CAN03'                  TO CAN-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-CAN CAN ELEM-LIST-CAN.
           IF CAN-RET-COD NOT = SPACES AND NOT = '14'
              MOVE 'C-ENTRADA'       TO WR-SECCION
              MOVE 'CD-LEER-CAN'     TO WR-PARRAFO
              MOVE 'REDNX CAN03    ' TO WR-OPERACION
              MOVE CAN-RET-COD       TO WR-STATUS
              MOVE CAN-VALUE         TO WR-CLAVE
              MOVE 'FIN'             TO WS-SW-CAN
              MOVE 100               TO WS-RETURN-CODE
           ELSE
              IF CAN-RET-COD = '14' OR
                 CAN-FEC-FOUT NOT = WP-FECHA-PROCESO
                 MOVE 'FIN' TO WS-SW-CAN
      *****   ELSE
      *****      IF CAN-COD-TOPC NOT = 'D'
      *****         MOVE 'FIN' TO WS-SW-CAN
                 ELSE
                    ADD 1 TO WA-CAN-LEIDOS.
       CF-LEER-DLC.
      *-------------
           MOVE SPACES                        TO DLC-VALUE
           MOVE OPC-KEY-IOPC                  TO DLC-CIC-IOPC
           MOVE 001                           TO DLC-NUM-IDLC
           MOVE DLC-KEY-IDLC                  TO DLC-VALUE
           MOVE 'DLC00'                       TO DLC-KEY
           MOVE 'REDKY'                       TO DLC-COMMAND
           CALL 'DBNTRY' USING UIB REQ-AREA-DLC DLC ELEM-LIST-DLC
           IF DLC-RET-COD NOT = SPACES
              MOVE 'C-PROCESAR'     TO WR-SECCION
              MOVE 'CF-LEER-DLC'    TO WR-PARRAFO
              MOVE 'REDKY DLC00   ' TO WR-OPERACION
              MOVE DLC-RET-COD      TO WR-STATUS
              MOVE DLC-VALUE        TO WR-CLAVE
              PERFORM CX-DESPLEGAR-MENSAJES
              MOVE 1 TO WS-SW-ERROR
           ELSE
              ADD 1 TO WA-DLC-LEIDOS
              MOVE CAN-IIC-IOPC       TO WR-COLOCACION-WS
              IF OPC-COD-OOPC = '999'
                 ADD 1 TO WA-LEIDOS-999
                 MOVE 0 TO WS-SW-DCC
                 PERFORM CG-LEER-DCC
                 IF WS-SW-DCC = 0
                    PERFORM CH-LEER-RUT-DD
                 ELSE
                  NEXT SENTENCE
              ELSE
               PERFORM CH-LEER-RUT-DD.

       CG-LEER-DCC.
      *-------------
              MOVE ZEROES          TO WR-COLOCACION-WS
              MOVE 'DCC'           TO DCC-COD-TTAB.
              MOVE 'CAP'           TO DCC-MSC-TCCT.
              MOVE SPACES          TO DCC-VALUE
              MOVE OPC-COD-VCOC    TO DCC-COD-VCAM
              MOVE OPC-COD-TOOC    TO DCC-COD-TOCR
              MOVE OPC-COD-AOOC    TO DCC-COD-AOCR
              MOVE DLC-COD-PLZO    TO DCC-COD-PLZO
              MOVE DLC-IND-SCRT    TO DCC-IND-SCRT
              MOVE DLC-IND-SCTB    TO DCC-IND-SCTB
              MOVE DLC-IND-SCBZ    TO DCC-IND-SCBZ
              MOVE DCC-COD-TABL    TO DCC-VALUE
      ****    DISPLAY 'DCC-COD-TABL:' DCC-COD-TABL
              MOVE 'REDKY'         TO DCC-COMMAND
              MOVE 'DCC00'         TO DCC-KEY
              CALL 'DBNTRY' USING UIB REQ-AREA-DCC DCC ELEM-LIST-DCC.
              IF DCC-RET-COD = SPACES
                  MOVE DCC-CIC-TCCT TO WR-OPERAC-WS
                  MOVE OPC-GLS-NOPC TO WR-SERIAL-WS
                  ADD 1 TO WA-DCC-LEIDOS
              ELSE
                   MOVE 'C-PROCESAR'           TO WR-SECCION
                   MOVE 'CE-LEER-DCC'          TO WR-PARRAFO
                   MOVE 'REDKY DCC00   '       TO WR-OPERACION
                   MOVE DCC-RET-COD            TO WR-STATUS
                   MOVE DCC-VALUE              TO WR-CLAVE
                   PERFORM CX-DESPLEGAR-MENSAJES
                   MOVE 1 TO WS-SW-ERROR
                   MOVE 1 TO WS-SW-DCC.
       CH-LEER-RUT-DD.
      *----------------
           MOVE 0                              TO WS-SW-RDC
           MOVE SPACES                         TO RDC-VALUE
           MOVE OPC-KEY-IOPC                   TO WR-RDC-A
           MOVE 000                            TO WR-RDC-B
           MOVE WR-RDC-WS                      TO RDC-VALUE
           MOVE 'LOCKY'                        TO RDC-COMMAND
           MOVE 'RDC01'                        TO RDC-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-RDC RDC ELEM-LIST-RDC.
           IF RDC-RET-COD = SPACES
               MOVE 'REDLE'                    TO RDC-COMMAND
               MOVE 'RDC01'                    TO RDC-KEY
               CALL 'DBNTRY' USING UIB REQ-AREA-RDC RDC ELEM-LIST-RDC
               IF RDC-RET-COD NOT = SPACES
                   MOVE 'C-PROCESAR'           TO WR-SECCION
                   MOVE 'CE-LEER-RUT-DD'       TO WR-PARRAFO
                   MOVE 'REDLE RDC01   '       TO WR-OPERACION
                   MOVE RDC-RET-COD            TO WR-STATUS
                   MOVE RDC-VALUE              TO WR-CLAVE
                   PERFORM CX-DESPLEGAR-MENSAJES
                   MOVE 1 TO WS-SW-ERROR
                  ELSE
                   IF WR-RDC-WS = RDC-KEY-IDLC
                      ADD 1 TO WA-RDC-LEIDOS
                      MOVE SPACES              TO DBC-VALUE
                      MOVE RDC-CIC-ICLI        TO DBC-VALUE
                      MOVE 'REDKY'             TO DBC-COMMAND
                      MOVE 'DBC00'             TO DBC-KEY
                      CALL 'DBNTRY' USING UIB REQ-AREA-DBC DBC
                                  ELEM-LIST-DBC
                      IF DBC-RET-COD NOT = SPACES
                         MOVE 'C-PROCESAR'     TO WR-SECCION
                         MOVE 'CE-LEER-RUT-DD' TO WR-PARRAFO
                         MOVE 'REDKY DBC     ' TO WR-OPERACION
                         MOVE DBC-RET-COD      TO WR-STATUS
                         MOVE DBC-VALUE        TO WR-CLAVE
                         PERFORM CX-DESPLEGAR-MENSAJES
                         MOVE 1 TO WS-SW-ERROR
                      ELSE
                         MOVE 1                TO WS-SW-RDC
                         ADD 1                 TO WA-DBC-LEIDOS
                         MOVE DBC-NUM-ICLI     TO WR-RUT-DD
                         MOVE DBC-VRF-ICLI     TO WR-DV-DD
                         PERFORM CI-LEER-RCV
      ****               DISPLAY 'RUT' DBC-NUM-ICLI ' ' DBC-VRF-ICLI
                     ELSE
                      MOVE 'C-PROCESAR'        TO WR-SECCION
                      MOVE 'CE-LEER-RUT-DD'    TO WR-PARRAFO
                      MOVE 'RDC NO ENCONTRADO' TO WR-OPERACION
                      MOVE RDC-RET-COD         TO WR-STATUS
                      MOVE DBC-VALUE           TO WR-RDC-WS
                      PERFORM CX-DESPLEGAR-MENSAJES
                      MOVE 1 TO WS-SW-ERROR
           ELSE
             MOVE 'C-PROCESAR'                 TO WR-SECCION
             MOVE 'CE-LEER-RUT-DD'             TO WR-PARRAFO
             MOVE 'LOCKY RDC01   '             TO WR-OPERACION
             MOVE RDC-RET-COD                  TO WR-STATUS
             MOVE RDC-VALUE                    TO WR-CLAVE
             PERFORM CX-DESPLEGAR-MENSAJES
             MOVE 1 TO WS-SW-ERROR.
       CI-LEER-RCV.
      *-------------
           MOVE SPACES                        TO RCV-VALUE
           MOVE CAN-KEY-ICAN                  TO RCV-VALUE
           MOVE 'RCV00'                       TO RCV-KEY

           MOVE 'LOCKY'                       TO RCV-COMMAND
           CALL 'DBNTRY' USING UIB REQ-AREA-RCV RCV ELEM-LIST-RCV
           IF RCV-RET-COD = SPACES
               MOVE 'RCV00'                   TO RCV-KEY
               MOVE 'REDLE'                   TO RCV-COMMAND
               CALL 'DBNTRY' USING UIB REQ-AREA-RCV RCV ELEM-LIST-RCV
               IF RCV-RET-COD NOT = SPACES
                   MOVE 'C-PROCESAR'     TO WR-SECCION
                   MOVE 'CI-LEER-RCV'    TO WR-PARRAFO
                   MOVE 'REDLE RCV00   ' TO WR-OPERACION
                   MOVE RCV-RET-COD      TO WR-STATUS
                   MOVE RCV-VALUE        TO WR-CLAVE
                   PERFORM CX-DESPLEGAR-MENSAJES
                   MOVE 1 TO WS-SW-ERROR
               ELSE
                   IF CAN-KEY-ICAN  = RCV-KEY-ICAN
                      ADD 1 TO WA-RCV-LEIDOS
                      PERFORM CJ-ARMAR-SORT
                   ELSE
                      MOVE 'C-PROCESAR'     TO WR-SECCION
                      MOVE 'CI-LEER-RCV'    TO WR-PARRAFO
                      MOVE 'COMPRA CLAVES ' TO WR-OPERACION
                      MOVE RCV-RET-COD      TO WR-STATUS
                      MOVE RCV-VALUE        TO WR-CLAVE
                      PERFORM CX-DESPLEGAR-MENSAJES
                      MOVE 1 TO WS-SW-ERROR
           ELSE
                MOVE 'C-PROCESAR'     TO WR-SECCION
                MOVE 'CI-LEER-RCV'    TO WR-PARRAFO
                MOVE 'LOCKY RCV00   ' TO WR-OPERACION
                MOVE RCV-RET-COD      TO WR-STATUS
                MOVE RCV-VALUE        TO WR-CLAVE
                PERFORM CX-DESPLEGAR-MENSAJES
                MOVE 1 TO WS-SW-ERROR.
           SKIP1
       CJ-ARMAR-SORT.
      *---------------
      *     MOVE DBC-GLS-NOMC TO SOR-NOMBRE
             IF DBC-IND-TICL = 'P'
                MOVE DBC-GLS-APAT    TO WR-D02-APAT25
                MOVE DBC-GLS-AMAT    TO WR-D02-AMAT25
                MOVE DBC-GLS-NOMB    TO WR-D02-NOMB25
                MOVE SPACES          TO WR-D02-N2
                PERFORM CK-SACA-BLANCOS
                MOVE WR-D02-N2       TO WR-D02-NOMBRE
                MOVE WR-D02-NOMBRE   TO SOR-NOMBRE
             ELSE
                MOVE DBC-GLS-APAT    TO WR-D02-NOM1
                MOVE DBC-GLS-AMAT    TO WR-D02-NOM2
                MOVE WR-D02-NOMBRE   TO SOR-NOMBRE.
             MOVE WR-RUT-DD          TO SOR-RUT-DD-DIG
             MOVE WR-DV-DD           TO SOR-RUT-DD-VER
             MOVE CAN-COD-TOPC       TO SOR-COD
             MOVE CAN-COD-COPC       TO SOR-SUCURSAL
             MOVE WR-COLOCACION-WS   TO SOR-CODIGO-OPER
             MOVE CAN-NUM-ICAN       TO SOR-CAN
             MOVE CAN-MSC-CANC       TO WR-COD-CAN-WS

               IF RCV-SGV-FINA IS NOT NUMERIC
                  MOVE 'C-PROCESAR'        TO WR-SECCION
                  MOVE 'CJ-ARMAR-SORT'     TO WR-PARRAFO
                  MOVE 'RCV-SGV-FINA INV.' TO WR-OPERACION
                  MOVE 0                   TO WR-STATUS
                  MOVE 0                   TO RCV-SGV-FINA
                  MOVE CAN-KEY-ICAN        TO WR-CLAVE
                  PERFORM CX-DESPLEGAR-MENSAJES
                  MOVE 1 TO WS-SW-ERROR.
               IF RCV-SGV-CAPI IS NOT NUMERIC
                  MOVE 'C-PROCESAR'        TO WR-SECCION
                  MOVE 'CJ-ARMAR-SORT'     TO WR-PARRAFO
                  MOVE 'RCV-SGV-CAPI INV.' TO WR-OPERACION
                  MOVE 0                   TO WR-STATUS
                  MOVE 0                   TO RCV-SGV-CAPI
                  MOVE CAN-KEY-ICAN        TO WR-CLAVE
                  PERFORM CX-DESPLEGAR-MENSAJES
                  MOVE 1 TO WS-SW-ERROR.
           MOVE RCV-SGV-FINA TO WR-VALOR-WSS
           MOVE RCV-SGV-CAPI TO WR-VALOR-WSS2


      *    IF WS-SW-ERROR = 0
      *       IF OPESC-I9 = 1 OR 2
                 PERFORM CO-LEER-UF
      *          MOVE RCV-SGV-FINA TO  WR-VALOR-WSS
      ****  DISPLAY 'U.F.:' WR-VALOR-WSS1 '  ' SOR-CODIGO-OPER
                 COMPUTE WR-VALOR-WSS ROUNDED = RCV-SGV-FINA
                                             * WR-VALOR-WSS1
                 COMPUTE WR-VALOR-WSS2 ROUNDED = RCV-SGV-CAPI
                                             * WR-VALOR-WSS1.
            MOVE RCV-SGV-FINA  TO SOR-VALOR-CUOTA
      ****  MOVE WR-VALOR-WSS  TO SOR-VALOR-CUOTA
            MOVE WR-VALOR-WSS2 TO SOR-CAPITAL
            MOVE CAN-SGV-TPAG TO SOR-TOTAL-PAGADO
           MOVE SPACES TO WR-EST-MOROSO.
           IF RCV-MSC-MCAN = 'V'
              THEN
               MOVE 'SI' TO WR-EST-MOROSO
              ELSE
               MOVE 'NO' TO WR-EST-MOROSO.



           COMPUTE WR-VALOR-COMPAR = CAN-SGV-TPAG + CAN-SGV-TREN
            - CAN-SGV-GAST.

           IF WR-EST-MOROSO = 'NO' OR WR-VALOR-WSS > WR-VALOR-COMPAR
              THEN
               MOVE ZEROES TO WR-VALOR-WS
              ELSE
               COMPUTE WR-VALOR-WS ROUNDED = WR-VALOR-COMPAR
                                           - WR-VALOR-WSS.
               MOVE WR-VALOR-WS       TO SOR-INT-MORA



             COMPUTE WR-VALOR-WS1 ROUNDED = CAN-SGV-TREN + CAN-SGV-TPAG
               - WR-VALOR-WSS2 - (WR-VALOR-WS) - CAN-SGV-GAST.
               MOVE WR-VALOR-WS1      TO SOR-INTERESES


      *    IF OPESC-I9 = 1 OR 2
      ****    IF SOR-INTERESES NOT = 0 OR SOR-INTERESES NOT < 0
      ****       COMPUTE SOR-INTERESES ROUNDED = SOR-INTERESES
      ****                                     / WR-VALOR-WSS1.


           COMPUTE WR-VALOR-WS ROUNDED = CAN-SGV-TREN + CAN-SGV-TPAG
             - CAN-SGV-GAST.



           MOVE RCV-SGV-REAJ TO SOR-REAJUSTES


      *        IF SOR-INTERESES < 0
      *           MOVE ZEROES TO SOR-INTERESES
      *           MOVE 'C-PROCESAR'     TO WR-SECCION
      *           MOVE 'CJ-ARMAR-SORT'  TO WR-PARRAFO
      *           MOVE 'INT. NEGATIVO ' TO WR-OPERACION
      *           MOVE 0                TO WR-STATUS
      *           MOVE SPACES           TO WR-CLAVE
      *           PERFORM CX-DESPLEGAR-MENSAJES
      *           MOVE 1 TO WS-SW-ERROR.
               IF RCV-SGV-FINA < 0
                  MOVE 'C-PROCESAR'        TO WR-SECCION
                  MOVE 'CJ-ARMAR-SORT'     TO WR-PARRAFO
                  MOVE 'RCV-SGV-FINA < 0 ' TO WR-OPERACION
                  MOVE 0                   TO WR-STATUS
                  MOVE SPACES              TO WR-CLAVE
                  PERFORM CX-DESPLEGAR-MENSAJES
                  MOVE 1 TO WS-SW-ERROR.
               IF RCV-SGV-CAPI < 0
                  MOVE 'C-PROCESAR'        TO WR-SECCION
                  MOVE 'CJ-ARMAR-SORT'     TO WR-PARRAFO
                  MOVE 'RCV-SGV-CAPI < 0 ' TO WR-OPERACION
                  MOVE 0                   TO WR-STATUS
                  MOVE SPACES              TO WR-CLAVE
                  PERFORM CX-DESPLEGAR-MENSAJES
                  MOVE 1 TO WS-SW-ERROR.
               IF CAN-SGV-TPAG < 0
                  MOVE 'C-PROCESAR'        TO WR-SECCION
                  MOVE 'CJ-ARMAR-SORT'     TO WR-PARRAFO
                  MOVE 'CAN-SGV-TPAG < 0 ' TO WR-OPERACION
                  MOVE 0                   TO WR-STATUS
                  MOVE SPACES              TO WR-CLAVE
                  PERFORM CX-DESPLEGAR-MENSAJES
                  MOVE 1 TO WS-SW-ERROR.
               IF CAN-SGV-TREN < 0
                  MOVE 'C-PROCESAR'        TO WR-SECCION
                  MOVE 'CJ-ARMAR-SORT'     TO WR-PARRAFO
                  MOVE 'CAN-SGV-TREN < 0 ' TO WR-OPERACION
                  MOVE 0                   TO WR-STATUS
                  MOVE SPACES              TO WR-CLAVE
                  PERFORM CX-DESPLEGAR-MENSAJES
                  MOVE 1 TO WS-SW-ERROR.
             PERFORM GET-VEN
             MOVE WR-FECHA-VEN       TO SOR-FECHA-VEN
             IF WS-SW-ERROR = 0
                ADD 1 TO WA-REG-SORT-GRA
                RELEASE REG-SORT.

       CK-SACA-BLANCOS.
      *----------------
           MOVE    1 TO WR-IND2.
           MOVE    'N' TO WR-INDN.
           PERFORM CM-MUEVE-NOMBRE VARYING WR-IND1 FROM 1 BY 1 UNTIL
                                WR-IND1 > 75 OR WR-IND2 > 40.
       CL-FIN-SACA-BLANCOS.
      *-----------------
            EXIT.

       CM-MUEVE-NOMBRE.
      *-------------
           IF WR-D02-N1A (WR-IND1) NOT = ' '
              MOVE WR-D02-N1A (WR-IND1) TO WR-D02-N2A (WR-IND2)
              MOVE 'S' TO WR-INDN
              ADD  1 TO WR-IND2
           ELSE
              IF WR-INDN = 'S'
                 MOVE WR-D02-N1A (WR-IND1) TO WR-D02-N2A (WR-IND2)
                 MOVE 'N' TO WR-INDN
                 ADD  1 TO WR-IND2.
       CO-LEER-UF.
      *---------
           MOVE 0 TO WR-VALOR-WSS1
           MOVE CAN-FEC-FCAN TO CAM-FEC-FCAM (1)
           MOVE CAN-FEC-FCAN TO CAM-FEC-FCAM (2)
           MOVE 0            TO CAM-MSC-TVAL (1)
           MOVE 0            TO CAM-MSC-TVAL (2)
           MOVE SPACES       TO CAM-VALUE
           MOVE SPACES       TO CAM-COD-TCAM (1)
           MOVE SPACES       TO CAM-COD-TCAM (2)
           MOVE '998'        TO CAM-COD-CVAL (1)
           MOVE '999'        TO CAM-COD-CVAL (2)
           MOVE CAM-KEY-CAMB TO CAM-VALUE
           MOVE 'REDKY'      TO CAM-COMMAND
           MOVE 'CAM00'      TO CAM-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-CAM CAM ELEM-LIST-CAM.
           IF CAM-RET-COD NOT = SPACES
               MOVE 'C-PROCESAR'     TO WR-SECCION
               MOVE 'CO-LEER-UF '    TO WR-PARRAFO
               MOVE 'LEER UF       ' TO WR-OPERACION
               MOVE CAM-RET-COD      TO WR-STATUS
               MOVE CAM-VALUE        TO WR-CLAVE
               PERFORM CX-DESPLEGAR-MENSAJES
               MOVE 1 TO WS-SW-ERROR
              ELSE
               MOVE CAM-SGV-VCAM IN CAM TO WR-VALOR-WSS1.

       CX-DESPLEGAR-MENSAJES.
      *----------------------
              DISPLAY 'ERROR EN LA SECCION  :' WR-SECCION
              DISPLAY '            PARRAFO  :' WR-PARRAFO
              DISPLAY '            OPERACION:' WR-OPERACION
              DISPLAY '            STATUS   :' WR-STATUS
              DISPLAY '            CLAVE    :' WR-CLAVE.
              DISPLAY 'PROCESO CONTINUA'.

       CZ-FIN-DE-SECCION.
      *-----------------
           EXIT.
       DB-IMPRIMIR.
      *----------
           IF SOR-VALOR-CUOTA IS NUMERIC AND SOR-TOTAL-PAGADO IS NUMERIC
              PERFORM DC-RTN-IMPRESION.
           RETURN SORTWK AT END MOVE 'FIN' TO WS-FIN-SORT.
       DC-RTN-IMPRESION.
      *---------------
           PERFORM DF-IMPRIME-LINEA-BASE-DATOS
           MOVE SPACES      TO LINEA
           WRITE LINEA      AFTER 1
           ADD 1 TO WR-CL.

       DD-ENCABEZADO.
      *--------------
      **   PERFORM DE-LEER-SUCURSAL.
           ADD 1   TO WR-CP.
           MOVE WR-CP TO PAG-T1
      *    MOVE SOR-MONEDA TO MONEDA-2B
      *    MOVE SOR-CLASE  TO CLASE-2B
      *    MOVE SOR-GLOSA  TO GLOSA-2A
           WRITE LINEA FROM TIT-1 AFTER CANAL-1
           WRITE LINEA FROM TIT-2 AFTER 1
           WRITE LINEA FROM TIT-2A AFTER 1
           WRITE LINEA FROM RAYA  AFTER 2
           WRITE LINEA FROM TIT-3 AFTER 1
           WRITE LINEA FROM RAYA  AFTER 1
           WRITE LINEA FROM TIT-4 AFTER 1
           WRITE LINEA FROM RAYA  AFTER 1
           MOVE 11 TO WR-CL.

      *DE-LEER-SUCURSAL.
      *---------------
      *      MOVE SOR-SUCURSAL TO SUC-CLAVE
      *      READ SUC-SUCURSAL
      *      IF FS-SUCURSAL NOT = 0
      *         THEN
      *          DISPLAY 'ERROR AL LEER SUCURSAL:' FS-SUCURSAL
      *          DISPLAY 'CLAVE:' SUC-CLAVE
      *          MOVE SPACES TO SUC-SALIDA
      *         ELSE
      *          MOVE SUC-NOMBRE TO SUC-SALIDA.
       DF-IMPRIME-LINEA-BASE-DATOS.
      *-----------------------------
              DISPLAY '*****CLAVE SORT:' SOR-CLAVE
              DISPLAY 'REG:' REG-SORT
           ADD 1 TO WA-REG-SORT-LEI
           IF WR-CL > 60
              PERFORM DD-ENCABEZADO.
              MOVE SOR-NOMBRE        TO NOMBRE-01
              MOVE SOR-RUT-DD-DIG    TO RUT-01
              MOVE SOR-RUT-DD-VER    TO DV-01
              MOVE SOR-COD-01        TO OPERAC-01
              MOVE SOR-CODIGO-OPER   TO OPERAC-02
              MOVE SOR-CAN           TO OPERAC-03
              MOVE SOR-FECHA-VEN     TO WR-FECHA-VEN
              MOVE WR-ANO-VEN2       TO ANO-01
              MOVE WR-MES-VEN        TO MES-01
              MOVE WR-DIA-VEN        TO DIA-01
              IF SOR-VALOR-CUOTA IS NOT NUMERIC
                 MOVE 0 TO VALOR-CUOTA-01
                 DISPLAY 'SOR-VALOR-CUOTA:' SOR-VALOR-CUOTA
              ELSE
              MOVE SOR-VALOR-CUOTA   TO VALOR-CUOTA-01.
              MOVE SOR-TOTAL-PAGADO  TO VALOR-TOT-PAG-01
              MOVE SOR-CAPITAL       TO CAPITAL-01
              MOVE SOR-REAJUSTES     TO REAJUSTES-01
              MOVE SOR-INTERESES     TO INTERESES-01
              MOVE SOR-INT-MORA      TO INT-DE-MORA-01
              ADD SOR-TOTAL-PAGADO   TO WR-TOT-PAGADO
      *    IF WS-SW-1 = 0
      *       MOVE 1 TO WS-SW-1
      *       MOVE SOR-CLAVE-2  TO WR-COD-ANT.
      *
      *    IF SOR-CLAVE-2 NOT = WR-COD-ANT
      *      MOVE WA-TOT-CREDITOS  TO TOT-CRED-01
      *      MOVE WA-TOT-SALDO-ANT TO TOT-SALDO-ANT-01
      *      MOVE WA-TOT-SALDO-ACT TO TOT-SALDO-ACTUAL-01
      *      MOVE WA-TOT-ABONO-CAP TO TOT-ABONO-01
      *      MOVE WA-TOT-INTERES   TO TOT-INTERES-01
      *      WRITE LINEA FROM LTOTAL-01  AFTER 2
      *      WRITE LINEA FROM LTOTAL-02  AFTER 1
      *      PERFORM DD-ENCABEZADO
      *      MOVE 0 TO WA-TOT-CREDITOS
      *      MOVE 0 TO WA-TOT-SALDO-ANT
      *      MOVE 0 TO WA-TOT-SALDO-ACT
      *      MOVE 0 TO WA-TOT-ABONO-CAP.
      *      MOVE 0 TO WA-TOT-INTERES.

               WRITE LINEA FROM DETA-01   AFTER 1
               ADD 1 TO WR-CL
               WRITE LINEA FROM DETA-02   AFTER 1
               ADD 1 TO WR-CL.
      *       ADD SOR-SALDO-ANTER    TO WA-TOT-SALDO-ANT
      *       ADD SOR-ABONO-CAPIT    TO WA-TOT-ABONO-CAP
      *       ADD SOR-SALDO-ACTUAL   TO WA-TOT-SALDO-ACT
      *       ADD SOR-INTERESES      TO WA-TOT-INTERES
      *       ADD 1 TO WA-TOT-CREDITOS.
      *       MOVE SOR-CLAVE-2 TO WR-COD-ANT.


           EJECT
       E-TERMINAR SECTION.
      *==================
       EA-CONTROL.
      *----------
           PERFORM EB-TOTALES.
      *    IF WS-RETURN-CODE NOT = 100
              PERFORM EC-CERRAR-ARCHIVOS
      *    END-IF
           PERFORM ED-FIN-PROGRAMA.
           GO TO EZ-FIN-DE-SECCION.
           SKIP1
       EB-TOTALES.
      *----------
           DISPLAY ' '
           DISPLAY '+---------------------------------------------+'
           DISPLAY '+ ESTADISTICAS DE PROCESO.  PROGRAMA COLPB655 +'
           DISPLAY '+---------------------------------------------+'
           DISPLAY '          FECHA : ' FECHA-PROCESO.
           DISPLAY '+---------------------------------------------+'
           DISPLAY 'REG. OPC LEIDOS.........  : ' WA-OPC-LEIDOS
           DISPLAY 'REG. OPC SELECCIONADOS..  : ' WA-OPC-SELECCIONADOS
           DISPLAY 'REG. CAN LEIDOS.........  : ' WA-CAN-LEIDOS
           DISPLAY 'REG. RCV LEIDOS.........  : ' WA-RCV-LEIDOS
           DISPLAY 'REG. RDC LEIDOS.........  : ' WA-RDC-LEIDOS
           DISPLAY 'REG. DBC LEIDOS.........  : ' WA-DBC-LEIDOS
           DISPLAY 'REG. DCC LEIDOS.........  : ' WA-DCC-LEIDOS
           DISPLAY 'REG. GRABADOS AL SORT...  : ' WA-REG-SORT-GRA.
           DISPLAY 'REG. LEIDOS DEL SORT....  : ' WA-REG-SORT-LEI.
           SKIP1
       EC-CERRAR-ARCHIVOS.
      *------------------
           CLOSE LISTADO.
           SKIP1
       ED-FIN-PROGRAMA.
      *---------------
           DISPLAY ' '
           DISPLAY '+-------------------------------------------+'
           DISPLAY '+ MENSAJES PARA EL EXPLOTADOR               +'
           DISPLAY '+-------------------------------------------+'
           IF WS-RETURN-CODE = 100
              MOVE 100 TO RETURN-CODE
              DISPLAY ' HAY MENSAJES PARA EL EXPLOTADOR'
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '************************************************'
              DISPLAY '************************************************'
              DISPLAY '****                                        ****'
              DISPLAY '****      TERMINO ERRONEO DEL PROCESO       ****'
              DISPLAY '****                                        ****'
              DISPLAY '************************************************'
              DISPLAY '************************************************'
              DISPLAY 'EL ERROR FUE EN LA SECCION   ' WR-SECCION
              DISPLAY '                   PARRAFO   ' WR-PARRAFO
              DISPLAY '                   OPERACION ' WR-OPERACION
              DISPLAY '                   STATUS    ' WR-STATUS
              DISPLAY '                   CLAVE     ' WR-CLAVE
           ELSE
              DISPLAY ' NO HAY MENSAJES PARA EL EXPLOTADOR'
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*** PROCESO TERMINO EN FORMA NORMAL ***'.
           SKIP1
       EZ-FIN-DE-SECCION.
      *-----------------
      *COPY GNSBGIFD.
       COPY GNSBGIDD.
       COPY COLBFVEN.
       COPY GNSBFTAB.
       COPY GNSBFMSC.
       COPY COLBFICG.
       COPY COLBFTOC.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFRCV.
      *********************************************************
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBBSYS.
      *COPY GNSBGINT.
       COPY COLBGINT.
       COPY GNSBGCVI.
       COPY GNSBGDTC.
       COPY GNSBTABT.
       COPY GNSBGABT.
       COPY COLBGVEN.
       COPY GNSBBMSG.
       COPY TABBFCAM.
       COPY GNSBFMSG.
       COPY GNSBGPES.
       GET-VEN-01 SECTION.
       GET-VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
           IF OPC-NUM-IVEN > 1
              SUBTRACT 1 FROM OPC-NUM-IVEN
              GIVING VEN-NUM-IVEN IN VEN
           ELSE
              MOVE 1 TO VEN-NUM-IVEN IN VEN.

           MOVE FIO-GET-KEY         TO FIO-CMND.

           IF OPC-IND-VSTR = 'S'
              PERFORM COL-OBT-VEN
              IF VEN-STAT-OKS
                 MOVE VEN-FEC-FVEN TO WR-FECHA-VEN
              ELSE
                 DISPLAY 'ERROR EN RTN OBT-VEN:' OPC-KEY-IOPC
                 MOVE 1 TO WS-SW-ERROR
           ELSE
              PERFORM COL-FIO-VEN
              IF FIO-STAT-OKS
                 MOVE VEN-FEC-FVEN TO WR-FECHA-VEN
               ELSE
                 DISPLAY 'ERROR EN RTN FIO-VEN:' OPC-KEY-IOPC
                 MOVE 1 TO WS-SW-ERROR.
       FIN-GET-VEN.
      *VARIOS2 SECTION.
      *----------------

