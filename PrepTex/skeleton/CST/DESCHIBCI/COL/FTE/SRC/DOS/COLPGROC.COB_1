       IDENTIFICATION DIVISION.
      *=======================*
       PROGRAM-ID.      COLPGROC.
       AUTHOR.          BEE(JGM).
       DATE-WRITTEN.     09-ABRIL-1999.
      * Programa de actualizacion de la rov.
      *
       ENVIRONMENT DIVISION.
      *====================*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------*
       FILE-CONTROL.
      *     SELECT COLBCI ASSIGN TO COLBCI.

       DATA DIVISION.
      *=============*
       WORKING-STORAGE SECTION.
      *-----------------------*
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IDD-REQA==.
      *<<<< WSS

       COPY COLBROPC.
       COPY COLBRROV.
       COPY COLBRCAN.
       COPY COLBRROC.
       COPY COLBRROS.
      *
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRIDD.
       COPY GNSWVIDD.
      *
       COPY GNSBRTAB.
      *
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.

      *
       01  WSS-VARI.
           03 PGM-STAT.
              05 PGM-STAT-ROC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-OPC-OKS    VALUE '00'.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.


      * FECHAS

           03  WSS-FEC-FEJE.
               05  WSS-NUM-DEJE                   PIC 9(02).
               05  WSS-NUM-MEJE                   PIC 9(02).
               05  WSS-NUM-SEJE                   PIC 9(02).
               05  WSS-NUM-AEJE                   PIC 9(02).

           03  WSS-STP-IPRO.
               05 WSS-FEC-FPRO.
                  07 WSS-NUM-SPRO                 PIC 9(02).
                  07 WSS-NUM-APRO                 PIC 9(02).
                  07 WSS-NUM-MPRO                 PIC 9(02).
                  07 WSS-NUM-DPRO                 PIC 9(02).
               05 WSS-HRA-HPRO.
                  07 WSS-NUM-HHRO                 PIC 9(02).
                  07 WSS-NUM-MHRO                 PIC 9(02).
                  07 WSS-NUM-SSRO                 PIC 9(02).

           03  WSS-STP-IREN.
               05 WSS-FEC-FREN.
                  07 WSS-NUM-SREN                 PIC 9(02).
                  07 WSS-NUM-AREN                 PIC 9(02).
                  07 WSS-NUM-MREN                 PIC 9(02).
                  07 WSS-NUM-DREN                 PIC 9(02).

               05 WSS-HRA-HREN.
                  07 WSS-NUM-HHEN                 PIC 9(02).
                  07 WSS-NUM-MMEN                 PIC 9(02).
                  07 WSS-NUM-SSEN                 PIC 9(02).

           03  WSS-FEC-FTRN.
               05  WSS-NUM-STRN                   PIC 9(02).
               05  WSS-NUM-ATRN                   PIC 9(02).
               05  WSS-NUM-MTRN                   PIC 9(02).
               05  WSS-NUM-DTRN                   PIC 9(02).
      *
           03 WSS-OPC-IMOD.
               05 WSS-CIC-IMOD                    PIC X(12).
               05 WSS-NUM-IMOD                    PIC 9(03).
           03 WSS-ANT-IMOD.
               05 WSS-CIC-AMOD                    PIC X(12).
               05 WSS-NUM-AMOD                    PIC 9(03).

           03 WSS-ROC.
               05 WSS-KEY-IROC.
                  07 WSS-CIC-IOPC                 PIC X(12).
                  07 WSS-KEY-IVCT.
                     11 WSS-CIC-IVCT              PIC X(12).
                     11 WSS-NUM-IVCT              PIC 9(03).

      * Contadores
           03 WSS-NUM-TERR      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-TRAN      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-LOPC      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-LROV      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-LROC      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-EROV      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-MROV      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-GROV      VALUE ZEROES      PIC 9(07).
           03 WSS-NUM-TPTT      VALUE ZEROES      PIC 9(03).

      *Indicadores.
           03 WSS-CIC-IOPV      VALUE SPACES      PIC X(12).
           03 WSS-IND-IRTE      VALUE SPACES      PIC X(01).
           03 WSS-IND-FPRO      VALUE SPACES      PIC X(01).
           03 WSS-IND-PROC      VALUE 'S'         PIC X(01).
           03 WSS-IND-MASA      VALUE SPACES      PIC X(01).
           03 WSS-IND-IROC      VALUE SPACES      PIC X(01).
           03 WSS-IND-IVCT      VALUE SPACES      PIC X(01).

       PROCEDURE DIVISION.
      *==================*
       MAIN SECTION.
      *------------*
       INI-MAIN.
      *--------*
           COPY GNSBGEDB.
           MOVE 'COLPGROC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *
           PERFORM PRO-ROC.
      *
      *    PERFORM ABRE-ARCHIVOS.
      *    PERFORM PRO-ROS.
      *
      *    MOVE FIO-CLO TO FIO-CMND.
      *    PERFORM COL-FIO-ROV.
      *    PERFORM COL-FIO-ROC.
      *    PERFORM COL-FIO-ROS.
      *    PERFORM COL-FIO-OPC.
      *
      *
      *
       FIN-MAIN.
      *--------*
           DISPLAY 'ESTADISTICAS.'.
           DISPLAY '-------------'.
           DISPLAY ' '.
           DISPLAY 'ROV LEIDAS           : ' WSS-NUM-LROV IN WSS-VARI.
           DISPLAY 'ROV NO ENCONTRADAS   : ' WSS-NUM-EROV IN WSS-VARI.
           DISPLAY 'REG ROV GRABADAS     : ' WSS-NUM-GROV IN WSS-VARI.
           DISPLAY '--------------------------------------'.
           DISPLAY 'ROC LEIDAS           : ' WSS-NUM-LROC IN WSS-VARI.
           DISPLAY 'ROV MODIFICADAS      : ' WSS-NUM-MROV IN WSS-VARI.
           DISPLAY 'ROV ELIMINADAS       : ' WSS-NUM-EROV IN WSS-VARI.
           PERFORM GNS-PRO-END.
      *
       ABRE-ARCHIVOS SECTION.
      *---------------------*
       INI-ABRE-ARCHIVOS.
      *Archivo secuencial ROV
      *    MOVE FIO-INP TO FIO-CMND.
      *    PERFORM COL-FIO-ROS.
      *
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
      *
      *
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-ROV.

      *Archivo que se grabaran todas las operaciones a
      *modifica ROV.
      *    DISPLAY 'ABRI ARCHIVOS OUT-ROC'.
      *    MOVE FIO-OUT TO FIO-CMND.
      *    PERFORM COL-FIO-ROC.
      *    DISPLAY 'ABRI ARCHIVOS'.
       FIN-ABRE-ARCHIVOS.
           EXIT.

       PRO-ROS SECTION.
      *---------------*
       INI-PRO-ROS.
      * Se Lee el Primer Registro OPC.
           MOVE ZEROES TO  WSS-NUM-TERR IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-LOPC IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-LROV IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-EROV IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-MROV IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-GROV IN WSS-VARI.
      *
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ROS.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL LEER PRIMER REG.ROS: ' FIO-STAT
              GO TO FIN-PRO-ROS.

           MOVE SPACES TO WSS-CIC-IOPC IN WSS-VARI.
           MOVE SPACES TO WSS-CIC-IVCT IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-IVCT IN WSS-VARI.
           MOVE ZEROES TO WSS-FEC-FTRN IN WSS-VARI.
      *
       LUP-PRO-ROS.
      *Contador de OPC Leidas
           ADD 1 TO WSS-NUM-LROV IN WSS-VARI.
      *
           PERFORM BUS-LLAVE-IROV.
      *
       LEE-SIGUIENTE-ROS.
           MOVE FIO-GET-NXT   TO  FIO-CMND.
           PERFORM COL-FIO-ROS.
           IF NOT FIO-STAT-OKS
              IF FIO-STAT = '10'
                 DISPLAY 'FIN DE ARCHIVO ROS'
                 GO TO FIN-PRO-ROS
              ELSE
                 DISPLAY 'ERROR LECTURA ROS: '
                 ROS-CIC-IOPC IN ROS ' ' FIO-STAT
                 GO TO FIN-PRO-ROS
           ELSE
              GO TO LUP-PRO-ROS.
       FIN-PRO-ROS.
           EXIT.


       BUS-LLAVE-IROV SECTION.
       INI-BUS-LLAVE-IROV.
      *    DISPLAY 'ROS-IOPC : ' ROS-CIC-IOPC IN ROS ' '
      *            'ROS-IOPV : ' ROS-CIC-IOPV IN ROS.
           MOVE 'N'    TO WSS-IND-IROC IN WSS-VARI.
           MOVE SPACES TO WSS-STP-IPRO IN WSS-VARI.
           MOVE ZEROES TO WSS-FEC-FPRO IN WSS-VARI.
           MOVE ZEROES TO WSS-FEC-FREN IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-TRAN IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-TPTT IN WSS-VARI.
           MOVE SPACES TO WSS-OPC-IMOD IN WSS-VARI.
           MOVE SPACES TO WSS-IND-MASA IN WSS-VARI.
           MOVE SPACES TO WSS-ANT-IMOD IN WSS-VARI.
           MOVE SPACES TO ROC-CIC-IMOD IN ROC.
           MOVE ZEROES TO WSS-STP-IREN IN WSS-VARI.
      *BUSCA RECION (BUSCANDO PTT DEL CREDITO)
       LEE-REG-OPC.
           MOVE ROS-CIC-IOPC IN ROS TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS AND
              ROS-CIC-IOPC IN ROS = OPC-CIC-IOPC IN OPC
              MOVE OPC-FEC-FINP IN OPC TO WSS-FEC-FREN IN WSS-VARI.
      *    DISPLAY 'FECHA : ' WSS-FEC-FREN IN WSS-VARI.
      *
       LEE-ROV-PRO.
           MOVE ROS-CIC-IOPV IN ROS TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-IROC.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    ROV-CIC-IOPC IN ROV = ROS-CIC-IOPV IN ROS )
                    GO TO FIN-BUS-LLAVE-IROV.
      *
       LEE-CAN-BUS-PRO.
           MOVE ROV-CIC-IOPV IN ROV TO CAN-CIC-IOPC IN CAN.
           MOVE ROV-NUM-IVCT IN ROV TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT (FIO-STAT-OKS AND
                   ROV-CIC-IOPV IN ROV = CAN-CIC-IOPC IN CAN AND
                   ROV-NUM-IVCT IN ROV = CAN-NUM-ICAN IN CAN AND
                   CAN-MSC-TCAN IN CAN  = 'P' )
                    MOVE FIO-GET-NXT   TO  FIO-CMND
                    GO TO LUP-IROC.


      *FECHA PTT.
           MOVE CAN-FEC-FOUT IN CAN TO  WSS-FEC-FPRO IN WSS-VARI.
      *
      *(BUSCANDO RTE DEL CREDITO EN CAN)
           MOVE 'N' TO WSS-IND-IRTE IN WSS-VARI.
           MOVE 'N' TO WSS-IND-FPRO IN WSS-VARI.
           MOVE ROS-CIC-IOPV IN ROS TO WSS-CIC-IOPV IN WSS-VARI.
       LEE-CAN-RTE.
           IF WSS-IND-FPRO IN WSS-VARI = 'S'
              GO TO FIN-BUS-LLAVE-IROV.
      *
           MOVE WSS-CIC-IOPV IN WSS-VARI TO CAN-CIC-IOPC IN CAN.
           MOVE ROS-NUM-IVCT IN ROS      TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS AND
              WSS-CIC-IOPV IN WSS-VARI = CAN-CIC-IOPC IN CAN AND
              ROS-NUM-IVCT IN ROS     = CAN-NUM-ICAN IN CAN
              GO TO VALIDA-TIPO-CAN.
      *
           IF WSS-IND-IRTE IN WSS-VARI = 'N'
              MOVE ROV-CIC-IOPV IN ROV TO
                                     WSS-CIC-IOPV IN WSS-VARI
              MOVE 'S' TO WSS-IND-IRTE IN WSS-VARI
              GO TO LEE-CAN-RTE.

           PERFORM BUS-SIG-PRO-ROV.
           GO TO LEE-CAN-RTE.

      *
        VALIDA-TIPO-CAN.
           IF CAN-MSC-TCAN IN CAN NOT = 'R'  AND
              WSS-IND-IRTE IN WSS-VARI = 'N'
              MOVE ROV-CIC-IOPV IN ROV TO WSS-CIC-IOPV IN WSS-VARI
              MOVE 'S' TO WSS-IND-IRTE IN WSS-VARI
              GO TO LEE-CAN-RTE
           ELSE
           IF CAN-MSC-TCAN IN CAN NOT = 'R'  AND
              WSS-IND-IRTE IN WSS-VARI = 'S'
              PERFORM BUS-SIG-PRO-ROV
              GO TO LEE-CAN-RTE
           ELSE
           IF CAN-MSC-CANC IN CAN = 'RTT'
              PERFORM BUS-SIG-PRO-ROV
              GO TO LEE-CAN-RTE.

      * FECHA (RTE) < FECHA (PTT)
      *    DISPLAY 'ROV-IOPC: ' ROV-CIC-IOPC IN ROV  ' '
      *            'ROV-IOPV: ' ROV-CIC-IOPV IN ROV  ' '
      *            'FECHA   : '
      *                     WSS-STP-IPRO IN WSS-VARI.
      *    DISPLAY 'CAN-IOPC : ' CAN-CIC-IOPC IN CAN
      *            'CAN-NUM  : ' CAN-NUM-ICAN IN CAN
      *            'FECHA    : ' CAN-STP-ITRN IN CAN.
      *
           IF CAN-FEC-FOUT IN CAN = WSS-FEC-FREN  IN WSS-VARI
              IF CAN-FEC-FOUT IN CAN NOT > WSS-FEC-FPRO IN WSS-VARI
                GO TO GUARDA-MOD-I.

           PERFORM BUS-SIG-PRO-ROV.
           GO TO LEE-CAN-RTE.
      *
       GUARDA-MOD-I.
           MOVE ROV-CIC-IOPV IN ROV TO ROC-CIC-IMOD IN ROC.
           MOVE ROS-KEY-IROV IN ROS TO WSS-KEY-IROC IN WSS-VARI.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO
                                       WSS-FEC-FTRN IN WSS-VARI.
           PERFORM GUARDA-MODI-ROV .
       FIN-BUS-LLAVE-IROV.
           EXIT.

       GUARDA-MODI-ROV SECTION.
       INI-GUARDA-MODI-ROV.
      *    DISPLAY 'MOD : ' ROC-CIC-IMOD IN ROC.
           MOVE ROS-KEY-IREG IN ROS  TO ROC-KEY-IREG IN ROC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ROC.
           IF FIO-STAT-OKS
              ADD 1 TO WSS-NUM-GROV IN WSS-VARI.
        FIN-GUARDA-MODI-ROV.
           EXIT.
      *
       BUS-SIG-PRO-ROV SECTION.
       INI-BUS-SIG-PRO-ROV.
           MOVE FIO-GET-NXT   TO  FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
              ROV-CIC-IOPC IN ROV = ROS-CIC-IOPV IN ROS)
              MOVE 'S' TO WSS-IND-FPRO IN WSS-VARI.
      *
           IF WSS-IND-FPRO IN WSS-VARI = 'S'
              GO TO FIN-BUS-SIG-PRO-ROV.
      *
           MOVE ROV-CIC-IOPV IN ROV TO CAN-CIC-IOPC IN CAN.
           MOVE ROV-NUM-IVCT IN ROV TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT (FIO-STAT-OKS AND
                   ROV-CIC-IOPV IN ROV = CAN-CIC-IOPC IN CAN AND
                   ROV-NUM-IVCT IN ROV = CAN-NUM-ICAN IN CAN AND
                   CAN-MSC-TCAN IN CAN  = 'P' )
                   GO TO INI-BUS-SIG-PRO-ROV.
      *
             MOVE CAN-STP-ITRN IN CAN TO WSS-STP-IPRO IN WSS-VARI.
             MOVE ROS-CIC-IOPV IN ROS TO WSS-CIC-IOPV IN WSS-VARI.
             MOVE 'N' TO WSS-IND-IRTE IN WSS-VARI.
       FIN-BUS-SIG-PRO-ROV.
           EXIT.
      *
       PRO-ROC SECTION.
      *---------------*
       INI-PRO-ROC.
      * Se Lee el Primer Registro OPC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-ROC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR APERTURA DE ROC: ' FIO-STAT
              GO TO FIN-PRO-ROC.
      *
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-ROV.
      *
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-ROC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL LEER PRIMER REG.ROC: ' FIO-STAT
              GO TO FIN-PRO-ROC.

           MOVE ZEROES TO  WSS-NUM-LROC IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-MROV IN WSS-VARI.
           MOVE ZEROES TO  WSS-NUM-EROV IN WSS-VARI.
      *
       LUP-PRO-ROC.
      *Contador de OPC Leidas
           ADD 1 TO WSS-NUM-LROC IN WSS-VARI.
      *
           PERFORM CHK-PNT.
           MOVE ROC-CIC-IOPC IN ROC TO ROV-CIC-IOPC IN ROV.
           MOVE ROC-KEY-IVCT IN ROC TO ROV-KEY-IVCT IN ROV.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-ROV.
      *
           IF  NOT FIO-STAT-OKS
               DISPLAY 'REG. NO ENCONTRADO : '
               ROC-CIC-IOPC IN ROC
               ROC-KEY-IVCT IN ROC
               ' MODIFICAR X : '  ROC-CIC-IMOD IN ROC
               PERFORM BCK-OUT
               GO TO LEE-SIGUIENTE-ROC.

      *AGREGAR REGISTRO MODIFICADO.
           MOVE ROC-CIC-IMOD IN ROC TO ROV-CIC-IOPV IN ROV.
           MOVE FIO-PUT             TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT  FIO-STAT-OKS
              DISPLAY 'NO SE AGREGA REG '
              PERFORM BCK-OUT
              GO TO LEE-SIGUIENTE-ROC.
      *
           ADD 1 TO WSS-NUM-MROV IN WSS-VARI.
      * SE AGREGO Y SE ELIMINA ANTIGUO.
           DISPLAY 'REG. AGREGADO : '
                    ROV-CIC-IOPC IN ROV
                    ROV-KEY-IVCT IN ROV.
      *
           MOVE ROC-CIC-IOPC IN ROC TO ROV-CIC-IOPC IN ROV.
           MOVE ROC-KEY-IVCT IN ROC TO ROV-KEY-IVCT IN ROV.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE PUDO ELININAR : '
              PERFORM BCK-OUT
              GO TO LEE-SIGUIENTE-ROC.
      *
      *ELIMINA
           MOVE FIO-DEL    TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF  FIO-STAT-OKS
               DISPLAY 'REG. ELIMINADO  '.
           ADD 1 TO WSS-NUM-EROV IN WSS-VARI.
      *
       LEE-SIGUIENTE-ROC.
           MOVE FIO-GET-NXT   TO  FIO-CMND.
           PERFORM COL-FIO-ROC.
           IF NOT FIO-STAT-OKS
              IF FIO-STAT = '10'
                 DISPLAY 'FIN DE ARCHIVO ROC'
                 GO TO FIN-PRO-ROC
              ELSE
                 DISPLAY 'ERROR LECTURA ROC: '
                 ' ' FIO-STAT
                 PERFORM BCK-OUT
                 GO TO FIN-PRO-ROC
           ELSE
              GO TO LUP-PRO-ROC.
       FIN-PRO-ROC.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           PERFORM COL-FIO-ROC.
       CERRAR-ARCH.
           EXIT.

       CHK-PNT SECTION.
      *---------------*
       INI-CHK-PNT.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CHK-PNT ERRONEO: ' FIO-STAT.
       FIN-CHK-PNT.
           EXIT.

       BCK-OUT SECTION.
      *---------------*
       INI-BCK-PNT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               DISPLAY 'BCK-OUT ERRONEO: ' FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGPES.
      *
       COPY COLBFOPC.
       COPY COLBFCAN.
       COPY COLBFROC.
       COPY COLBFROS.
       COPY COLBFROV.

