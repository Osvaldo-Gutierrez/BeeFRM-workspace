       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGT13.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    28-DIC-94    (Ultima Modificacion).

      * Programa Generador Interfaz T13 Super-Bancos de COL.

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.

       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABBRCAM.
       COPY TABBRTIO.
       COPY COLBROPC.
       COPY COLBRRDC.
       COPY COLBRDLC.
       COPY COLBRVEN.
       COPY COLBRCAN.
       COPY COLBRRCV.
       COPY COLBREVC.
       COPY COLBRICG.
       COPY COLBRTOC.
       COPY COLBRRDT.
       COPY COLBRR13.
       COPY SUPBRT13.
       COPY COLWGVEN.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY COLWGCAU.
       COPY COLWGCTO.

       01  WSS-VARI.
           03 WSS-FEC-FINF.
              05 WSS-NUM-DINF                          PIC 9(02).
              05 WSS-NUM-MINF                          PIC 9(02).
              05 WSS-NUM-SINF                          PIC 9(02).
              05 WSS-NUM-AINF                          PIC 9(02).
           03 WSS-FEC-FIN1.
              05 WSS-NUM-SIN1                          PIC 9(02).
              05 WSS-NUM-AIN1                          PIC 9(02).
              05 WSS-NUM-MIN1                          PIC 9(02).
              05 WSS-NUM-DIN1                          PIC 9(02).
           03 WSS-COD-OFOC                             PIC X(03).
           03 WSS-COD-COOC                             PIC X(06).
           03 WSS-COD-PESO                             PIC X(06).
           03 WSS-COD-UEFE                             PIC X(06).
           03 WSS-SGV-UEFE                             PIC S9(11)V9999.

           03 WSS-IND-STAT         VALUE 0             PIC 9(01).
           03 WSS-IND-ERRO         VALUE 0             PIC 9(01).
           03 WSS-VAL-DPES                             PIC 9(11).
           03 WSS-GLS-DAT3.
              05 FILLER                                PIC X(16).
              05 WSS-IND-OMIT                          PIC X(01).
              05 FILLER                                PIC X(13).
           03 WSS-FEC-FVEA.
              05 WSS-NUM-SVEA                          PIC 9(02).
              05 WSS-NUM-AVEA                          PIC 9(02).
              05 WSS-NUM-MVEA                          PIC 9(02).
              05 WSS-NUM-DVEA                          PIC 9(02).
           03 WSS-FEC-FANT.
              05 WSS-NUM-SANT                          PIC 9(02).
              05 WSS-NUM-AANT                          PIC 9(02).
              05 WSS-NUM-MANT                          PIC 9(02).
              05 WSS-NUM-DANT                          PIC 9(02).
           03 WSS-MSC-TCOL                             PIC X(04).
           03 WSS-SGV-FINF                             PIC S9(11)V9999.
           03 WSS-SGV-FVEN                             PIC S9(11)V9999.
           03 WSS-NUM-PLAZ                             PIC S9(04).
           03 WSS-NUM-IVEN                             PIC 9(03).
           03 WSS-NUM-DVEN                             PIC 9(03).
           03 WSS-NUM-DDEV                             PIC 9(03).
           03 WSS-VAL-CMOR                             PIC 9(11)V9(04).
           03 WSS-VAL-SCRE                             PIC 9(11)V9(04).
           03 WSS-VAL-SCAP                             PIC 9(11)V9(04).
           03 WSS-VAL-INTS                             PIC 9(11)V9(04).
           03 WSS-VAL-FINA                             PIC 9(11)V9(04).
           03 WSS-VAL-MONT                             PIC S9(15).
           03 WSS-IND-VEN1         VALUE ZEROES        PIC 9(01).
           03 WSS-IND-INTE         VALUE ZEROES        PIC 9(01).
           03 WSS-IND-FSDE         VALUE ZEROES        PIC 9(01).
           03 WSS-IND-SCTB         VALUE ZEROES        PIC 9(01).
           03 WSS-IND-MNAC         VALUE ZEROES        PIC 9(01).
           03 WSS-VAL-MNAC         VALUE ZEROES        PIC 9(15).
           03 WSS-VAL-DSP1         VALUE ZEROES        PIC 9(15).
           03 WSS-VAL-DSP2         VALUE ZEROES        PIC 9(15).
           03 WSS-VAL-DSP3         VALUE ZEROES        PIC 9(15).
           03 WSS-IND                                  PIC 9(02).
           03 WSS-SUB                                  PIC 9(03).
           03 WSS-NUM-OPCL         VALUE 0             PIC 9(07).
           03 WSS-NUM-OPCS         VALUE 0             PIC 9(07).
           03 WSS-NUM-OPCP         VALUE 0             PIC 9(07).
           03 WSS-NUM-OPCR         VALUE 0             PIC 9(07).
           03 WSS-NUM-VENL         VALUE 0             PIC 9(07).
           03 WSS-NUM-VENS         VALUE 0             PIC 9(07).
           03 WSS-NUM-VENP         VALUE 0             PIC 9(07).
           03 WSS-NUM-VENR         VALUE 0             PIC 9(07).
           03 WSS-NUM-T13G         VALUE 0             PIC 9(07).
           03 WSS-NUM-R13G         VALUE 0             PIC 9(07).
           03 WSS-COD-IKEY.
              05 WSS-T13-VCOC                          PIC X(06).
              05 WSS-T13-LINE                          PIC 9(03).
           03 T13-INDX             VALUE 0             PIC 9(03).
           03 T13-TABL.
              05 VALORES.
                07 FILLER VALUE '0998  001000000000000000000' PIC X(27).
                07 FILLER VALUE '0998  002000000000000000000' PIC X(27).
                07 FILLER VALUE '0998  003000000000000000000' PIC X(27).
                07 FILLER VALUE '0998  004000000000000000000' PIC X(27).
                07 FILLER VALUE '0998  005000000000000000000' PIC X(27).
                07 FILLER VALUE '0998  006000000000000000000' PIC X(27).
                07 FILLER VALUE '0998  007000000000000000000' PIC X(27).
                07 FILLER VALUE '0998  008000000000000000000' PIC X(27).
                07 FILLER VALUE '0998  009000000000000000000' PIC X(27).
                07 FILLER VALUE '0998  010000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  001000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  002000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  003000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  004000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  005000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  006000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  007000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  008000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  009000000000000000000' PIC X(27).
                07 FILLER VALUE '0999  010000000000000000000' PIC X(27).
              05 T13-VECT      REDEFINES   VALORES    OCCURS 20
                               INDEXED BY  T13-NUME.
      *                             DEPENDING ON T13-INDX.
                 07 T13-IKEY.
                    09 T13-VCOC                        PIC X(06).
                    09 T13-LINE                        PIC 9(03).
                 07 T13-MONT                           PIC S9(14)V9(04).


       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPGT13' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      * Captura Fecha de Proceso
           DISPLAY 'INGRESE FECHA DEL INFORME (DDMMSSAA) '.
           ACCEPT WSS-FEC-FINF IN WSS-VARI.
           DISPLAY WSS-FEC-FINF IN WSS-VARI.
      * Captura Codigo de Oficina
           DISPLAY 'OFICINA (*=BANCO): '.
           ACCEPT  WSS-COD-OFOC IN WSS-VARI.
           DISPLAY WSS-COD-OFOC IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Informe
           DISPLAY 'FECHA DEL INFORME : ' WSS-FEC-FINF IN WSS-VARI.
           MOVE WSS-FEC-FINF    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-ABT.

           MOVE WSS-NUM-DINF IN WSS-VARI TO WSS-NUM-DIN1 IN WSS-VARI.
           MOVE WSS-NUM-MINF IN WSS-VARI TO WSS-NUM-MIN1 IN WSS-VARI.
           MOVE WSS-NUM-SINF IN WSS-VARI TO WSS-NUM-SIN1 IN WSS-VARI.
           MOVE WSS-NUM-AINF IN WSS-VARI TO WSS-NUM-AIN1 IN WSS-VARI.

      *VAL-OFI Valida codigo de Oficina en TABLAS
           IF WSS-COD-OFOC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-OFOC IN WSS-VARI.
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*'
               DISPLAY 'OFICINA : ' WSS-COD-OFOC IN WSS-VARI
               MOVE WSS-COD-OFOC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-ABT.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * Obtiene el Codigo Valor de Cambio de Pesos mediante el CIC de la
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB IN TAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * Obtiene el Codigo Valor de Cambio de la UF mediante el CIC de la
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB IN TAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.

      * Obtiene Valor de Cambio en Pesos para la UF a Fecha del Informe
           MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA INFORME : '
                        WSS-FEC-FINF IN WSS-VARI      ' PARA LA U.F.'
               PERFORM GNS-PRO-ABT
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'IND. VIGENCIA NO VALIDO A FECHA INFORME : '
                        WSS-FEC-FINF IN WSS-VARI    ' PARA LA U.F.'
               PERFORM GNS-PRO-ABT
           ELSE
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-UEFE IN WSS-VARI.

      * Proceso para Cargar la tabla  COL/AUX  en Memoria
           PERFORM COL-CRG-CAU.
           IF CAU-CMSG IN CAU-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CAU-CMSG IN CAU-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CAU-MEN2 IN CAU-VARI
               PERFORM GNS-PRO-ABT.

      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
               PERFORM GNS-PRO-ABT.

      * Apertura de Registros
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-VEN.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SUP-FIO-T13.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR FIO-UPD T13, FIO-STAT : ' FIO-STAT
               PERFORM GNS-PRO-ABT.

           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-R13.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR FIO-OUT R13, FIO-STAT : ' FIO-STAT
               PERFORM GNS-PRO-ABT.

      * Primera Lectura de Operacion de Credito por Llave Primaria
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR : NO HAY REGISTROS OPC '
               GO TO FIN-MAIN.

      * Inicializa Tabla de Totales acumulados para grabar T13
      *     MOVE SPACES TO T13-TABL IN WSS-VARI.
      *     MOVE ZEROES TO T13-TABL IN WSS-VARI.
       LUP-MAIN.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
      ******************************************************************
      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           ADD   1  TO WSS-NUM-OPCL IN WSS-VARI.
           MOVE  0  TO WSS-VAL-FINA IN WSS-VARI.

      * Seleccion de los Registros OPC Leidos para ser Procesados
           PERFORM SEL-REG-PRO.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-MAIN.
           ADD 1 TO WSS-NUM-OPCS IN WSS-VARI.

      * Lectura de la DLC para obtener la Situacion SCTB del Credito
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE  1                  TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CIC-IOPC IN DLC = OPC-CIC-IOPC IN OPC )
               ADD 1 TO WSS-NUM-OPCR IN WSS-VARI
               GO TO NXT-MAIN.

      *     IF DLC-IND-SCTB IN DLC = ' ' OR
      *        DLC-IND-SCTB IN DLC = 'VIG'
      *         MOVE  0  TO WSS-IND-SCTB IN WSS-VARI
      *     ELSE
      *     IF DLC-IND-SCTB IN DLC = 'MUL' OR
      *        DLC-IND-SCTB IN DLC = 'MOR'
      *         MOVE  1  TO WSS-IND-SCTB IN WSS-VARI
      *     ELSE
      *         GO TO NXT-MAIN.

      * Distribucion de la Operacion para Sistemas lo Manejan >< de 'COL
      * SALDO CAPITAL DE OPC VIGENTES E INTERES DEVENGADO DE DLC
           IF ( CTO-SIST IN CTO-VARI = 'CES' OR
                CTO-SIST IN CTO-VARI = 'TCR' OR
                CTO-SIST IN CTO-VARI = 'SCC' OR
                CTO-SIST IN CTO-VARI = 'SGE' )
               PERFORM DIS-OPC-DIF-SIST
               IF WSS-IND-STAT IN WSS-VARI = 1
                   ADD 1 TO WSS-NUM-OPCR IN WSS-VARI
                   GO TO NXT-MAIN
               ELSE
                   GO TO NXT-MAIN.

      * Determina la Existencia de Fecha Suspencion Devengo del Credito
           IF DLC-FEC-FSDE IN DLC NUMERIC AND
              DLC-FEC-FSDE IN DLC > ZEROES
               MOVE  1  TO WSS-IND-FSDE IN WSS-VARI
           ELSE
               MOVE  0  TO WSS-IND-FSDE IN WSS-VARI.

           IF DLC-FEC-FSDE IN DLC > WSS-FEC-FIN1 IN WSS-VARI
               MOVE  0  TO WSS-IND-FSDE IN WSS-VARI.

      * Obtiene Valor de Cambio de Operacion Credito en Pesos a Fecha In
      * o Fecha Suspencion Devengo del Credito
           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE  0  TO WSS-IND-MNAC IN WSS-VARI
           ELSE
           IF WSS-IND-FSDE IN WSS-VARI = 0
               PERFORM DET-VAL-CAMB-FINF
               IF WSS-IND-STAT IN WSS-VARI = 1
                   ADD 1 TO WSS-NUM-OPCR IN WSS-VARI
                   GO TO NXT-MAIN
               ELSE
                   NEXT SENTENCE
           ELSE
           IF WSS-IND-FSDE IN WSS-VARI = 1
               PERFORM DET-VAL-CAMB-FSDE
               IF WSS-IND-STAT IN WSS-VARI = 1
                   ADD 1 TO WSS-NUM-OPCR IN WSS-VARI
                   GO TO NXT-MAIN.

      * SMC-INI 13.09.1993
      * Lectura de la ICG para obtener la Tasa de Interes del Credito
      *     MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
      *     MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
      *     MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
      *     MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
      *     MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
      *     MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
      *     MOVE FIO-GET-NLS TO FIO-CMND.
      *     PERFORM COL-FIO-ICG.
      *     IF NOT ( FIO-STAT-OKS AND
      *              ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
      *              ICG-NUM-ICAN IN ICG = ZEROES              AND
      *              ICG-CIC-IOPV IN ICG = SPACES              AND
      *              ICG-NUM-IVCT IN ICG = ZEROES              AND
      *              ICG-IND-TTAS IN ICG = 'INT' )
      *         ADD 1 TO WSS-NUM-OPCR IN WSS-VARI
      *         GO TO NXT-MAIN.
      * SMC-FIN 13.09.1993
      *-----------------------------------------------------------------
      * Proceso para los Vencimientos de la Operacion de Credito selecci
       INI-PRO-OPC-VEN.
      * Lectura Inicial de Vencimientos de la Operacion de Credito
           MOVE  0  TO WSS-IND-VEN1 IN WSS-VARI
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE  1  TO VEN-NUM-IVEN IN VEN.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    VENNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC '/KEY : ' VEN-KEY-IVEN IN VEN
               GO TO FIN-PRO-OPC-VEN.

           MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN IN VEN
                                       WSS-NUM-IVEN IN WSS-VARI.
           MOVE  1  TO WSS-IND-VEN1 IN WSS-VARI.
           MOVE  0  TO WSS-IND-INTE IN WSS-VARI.
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
           ADD 1 TO WSS-NUM-OPCP IN WSS-VARI.

      * Con Fecha Suspencion Devengo del Credito se procesan vencimiento
      * en forma especial para obtener informacion para calcular interes
           IF WSS-IND-FSDE IN WSS-VARI = 1
               IF DLC-FEC-FSDE IN DLC NOT < VEN-FEC-FVEN IN VEN
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FVEA IN WSS-VARI
                   GO TO DIS-PRO-OPC-VEN
               ELSE
                   PERFORM SDEV-VEN-ANT-INI
                   IF WSS-IND-STAT IN WSS-VARI = 1
                       ADD 1 TO WSS-NUM-OPCR IN WSS-VARI
                       GO TO FIN-PRO-OPC-VEN
                   ELSE
                       GO TO DIS-PRO-OPC-VEN.

      * Si la Fecha Devengo del Credito es mayor a la fecha de proceso n
      * se calculan intereses para cuotas vigentes
      *     IF VEN-FEC-FVEN IN VEN > WSS-FEC-FIN1 IN WSS-VARI
           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FIN1 IN WSS-VARI
               MOVE  9  TO WSS-IND-INTE IN WSS-VARI
               GO TO DIS-PRO-OPC-VEN.

      * Se guarda el capital del vencimiento cuanto esta moroso
      *     IF VEN-IND-SCTB IN VEN = 'MOR' AND
           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FIN1 IN WSS-VARI
               MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-CMOR IN WSS-VARI
           ELSE
               MOVE ZEROES TO WSS-VAL-CMOR IN WSS-VARI.

      * Con 1er vencimiento leido se determina situacion para calcular
      * intereses de cuotas vigentes
           IF VEN-NUM-IVEN IN VEN = 1
               IF VEN-FEC-FVEN IN VEN > WSS-FEC-FIN1 IN WSS-VARI
                   MOVE  1  TO WSS-IND-INTE IN WSS-VARI
                   IF DLC-FEC-FDEV IN DLC > OPC-FEC-FCOL IN OPC
                       MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FANT
                                                             IN WSS-VARI
                       GO TO DIS-PRO-OPC-VEN
                   ELSE
                       MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FANT
                                                             IN WSS-VARI
                       GO TO DIS-PRO-OPC-VEN
               ELSE
                   IF DLC-FEC-FDEV IN DLC > VEN-FEC-FVEN IN VEN
                       MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FANT
                                                             IN WSS-VARI
                       GO TO DIS-PRO-OPC-VEN
                   ELSE
                       MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FANT
                                                             IN WSS-VARI
                       GO TO DIS-PRO-OPC-VEN
           ELSE
               IF VEN-FEC-FVEN IN VEN > WSS-FEC-FIN1 IN WSS-VARI
                   MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FANT IN WSS-VARI
                   MOVE  1                  TO WSS-IND-INTE IN WSS-VARI
                   GO TO DIS-PRO-OPC-VEN
               ELSE
                   IF DLC-FEC-FDEV IN DLC > VEN-FEC-FVEN IN VEN
                       MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FANT
                                                             IN WSS-VARI
                       GO TO DIS-PRO-OPC-VEN
                   ELSE
                       MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FANT
                                                             IN WSS-VARI
                       GO TO DIS-PRO-OPC-VEN.
       LUP-PRO-OPC-VEN.
      * Ciclo de Proceso del Vencimiento de la Operacion de Credito sele

      * Con Fecha Suspencion Devengo del Credito se procesan vencimiento
      * en forma especial para obtener informacion para calcular interes
           IF WSS-IND-FSDE IN WSS-VARI > 0
               IF WSS-IND-FSDE IN WSS-VARI > 1
                   GO TO DIS-PRO-OPC-VEN
               ELSE
               IF DLC-FEC-FSDE IN DLC NOT < VEN-FEC-FVEN IN VEN
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FVEA IN WSS-VARI
                   GO TO DIS-PRO-OPC-VEN
               ELSE
                   PERFORM SDEV-VEN-ANT-LUP
                   IF WSS-IND-STAT IN WSS-VARI = 1
      *                 ADD 1 TO WSS-NUM-OPCR IN WSS-VARI
                       ADD 1 TO WSS-NUM-VENR IN WSS-VARI
                       GO TO FIN-PRO-OPC-VEN
                   ELSE
                       GO TO DIS-PRO-OPC-VEN.

      * NO se calculan intereses para siguientes cuotas vigentes
           IF WSS-IND-INTE IN WSS-VARI = 9
               GO TO DIS-PRO-OPC-VEN.

      * Se calcula intereses devengados para la 1era cuota vigente
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FIN1 IN WSS-VARI
               MOVE  1  TO WSS-IND-INTE IN WSS-VARI
               GO TO DIS-PRO-OPC-VEN.

      * Se guarda el capital del vencimiento cuanto esta moroso
      *     IF VEN-IND-SCTB IN VEN = 'MOR' AND
           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FIN1 IN WSS-VARI
               ADD VEN-VAL-SCAP IN VEN TO WSS-VAL-CMOR IN WSS-VARI.

      * Con vencimiento moroso leido se determina situacion para calcula
      * intereses de cuotas vigentes
           IF DLC-FEC-FDEV IN DLC > VEN-FEC-FVEN IN VEN
               MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FANT IN WSS-VARI
               GO TO DIS-PRO-OPC-VEN
           ELSE
               MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FANT IN WSS-VARI
               GO TO DIS-PRO-OPC-VEN.
       DIS-PRO-OPC-VEN.
      * Distribucion del Vencimiento segun Situacion Contable
           ADD   1  TO WSS-NUM-VENL IN WSS-VARI.

      * SALDO CAPITAL E INTERES DE VEN VIGENTES
      *     IF WSS-IND-SCTB IN WSS-VARI = 0 AND
           IF ( VEN-IND-SCTB IN VEN = ' ' OR
                VEN-IND-SCTB IN VEN = 'VIG' ) AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FIN1 IN WSS-VARI
               PERFORM DIS-OPC-VEN-1
           ELSE
      * SALDO CAPITAL E INTERES DE VEN MOROSAS
      *     IF VEN-IND-SCTB IN VEN = 'MOR' AND
           IF VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FIN1 IN WSS-VARI
               PERFORM DIS-OPC-VEN-2
           ELSE
           IF VEN-IND-SCTB IN VEN = 'VCD' OR 'CAS'
               GO TO NXT-PRO-OPC-VEN
           ELSE
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI
               DISPLAY 'VEN EN OTRA CLASIFICACION ??? '
                       ' /KEY : ' VEN-KEY-IVEN IN VEN
                       ' /SCTB : ' VEN-IND-SCTB IN VEN.

           IF WSS-IND-STAT IN WSS-VARI = 1
      *         ADD 1 TO WSS-NUM-OPCR IN WSS-VARI
               ADD 1 TO WSS-NUM-VENR IN WSS-VARI
               GO TO FIN-PRO-OPC-VEN.

           MOVE  0  TO WSS-VAL-FINA IN WSS-VARI.
       NXT-PRO-OPC-VEN.
      * Lectura de Siguiente Vencimiento de la Operacion de Credito
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS OR
                  OPC-CIC-IOPC IN OPC NOT = VEN-CIC-IOPC IN VEN
                   GO TO FIN-PRO-OPC-VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE WSS-FEC-FIN1 IN WSS-VARI TO VEN-FTBS
               MOVE 'S'                      TO VEN-KEST
               MOVE 'N'                      TO VEN-INIT
               PERFORM COL-OBT-VEN
               IF VEN-STAT-EOF
                   GO TO FIN-PRO-OPC-VEN
               ELSE
               IF NOT VEN-STAT-OKS
                   MOVE 'COL'    TO MSG-COD-SIST
                   MOVE VEN-STAT TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC   VEN-KEY-IVEN IN VEN
                   GO TO FIN-PRO-OPC-VEN.
           GO TO LUP-PRO-OPC-VEN.
       FIN-PRO-OPC-VEN.
      ******************************************************************
       NXT-MAIN.
      * Siguiente lectura de Operacion de Credito por Llave Primaria
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           GO TO LUP-MAIN.
       FIN-MAIN.
      * Graba registro de interfaz T13 con informacion generada
           PERFORM GEN-REG-T13 VARYING WSS-SUB FROM 1 BY 1 UNTIL
                                       WSS-SUB > 20.
      *                                 T13-VCOC(WSS-SUB) = SPACES OR
      *                                 T13-LINE(WSS-SUB) = SPACES OR
      *                                 WSS-SUB > T13-INDX.

      * Cierre de Registros
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-VEN.
           PERFORM SUP-FIO-T13.

      * Despliega Totales de Control Proceso
           DISPLAY 'TOTAL OPC LEIDOS             : '
                               WSS-NUM-OPCL IN WSS-VARI.
           DISPLAY 'TOTAL OPC SELECCIONADOS      : '
                               WSS-NUM-OPCS IN WSS-VARI.
           DISPLAY 'TOTAL OPC PARA PROCESO       : '
                               WSS-NUM-OPCP IN WSS-VARI.
           DISPLAY 'TOTAL OPC RECHAZADOS         : '
                               WSS-NUM-OPCR IN WSS-VARI.
           DISPLAY 'TOTAL VEN LEIDOS             : '
                               WSS-NUM-VENL IN WSS-VARI.
           DISPLAY 'TOTAL VEN SELECCIONADOS      : '
                               WSS-NUM-VENS IN WSS-VARI.
           DISPLAY 'TOTAL VEN PROCESADOS         : '
                               WSS-NUM-VENP IN WSS-VARI.
           DISPLAY 'TOTAL VEN RECHAZADOS         : '
                               WSS-NUM-VENR IN WSS-VARI.
           DISPLAY 'TOTAL T13 GRABADOS           : '
                               WSS-NUM-T13G IN WSS-VARI.
           DISPLAY 'TOTAL R13 GRABADOS           : '
                               WSS-NUM-R13G IN WSS-VARI.

      * Termino del Proceso
           PERFORM GNS-PRO-END.

      *<<<< EOF
      ******************************************************************
      * Seleccion del Registro OPC Leido para ser Procesado
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           MOVE  1  TO WSS-IND-STAT IN WSS-VARI.

      * Seleccion de Operacion de Credito con Estado 'ACA'
           IF OPC-MSC-STAT IN OPC NOT = 'A'
               GO TO FIN-SEL-REG-PRO.

      * Verifica que Registro Leido pertenesca al Periodo de Proceso
           IF OPC-FEC-FCOL IN OPC > WSS-FEC-FIN1 IN WSS-VARI
               GO TO FIN-SEL-REG-PRO.

      * Seleccion de Oficina de Operacion de Credito
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFOC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO FIN-SEL-REG-PRO.

      * Se omite la Operacion de Credito en Moneda Extranjera
           IF OPC-MSC-TVOC IN OPC = '1'
               GO TO FIN-SEL-REG-PRO.

      * Seleccion de Operacion de Credito que tenga Saldo a fecha Inform
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO FIN-SEL-REG-PRO.
      * ------------------ Para manejo Historico ------------
      *     IF OPC-VAL-SCRE IN OPC NOT > ZEROES
      *         PERFORM BUS-ULT-CAN
      *         IF WSS-IND-ERRO IN WSS-VARI = 1
      *            GO TO FIN-SEL-REG-PRO.

      * Busca con el Codigo Tipo Operacion en la Tabla cargada en Memori
      * 'Sistema que lo Maneja' y 'Opera Como'
           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
                       'CON CODIGO : '     CTO-TOOC IN CTO-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               GO TO FIN-SEL-REG-PRO.

      * Valida el 'Sistema que lo Maneja' de la Operacion de Credito sea
      * COL - CES - TCR - SCC - SGE
           IF NOT ( CTO-SIST IN CTO-VARI = 'COL' OR
                    CTO-SIST IN CTO-VARI = 'CES' OR
                    CTO-SIST IN CTO-VARI = 'TCR' OR
                    CTO-SIST IN CTO-VARI = 'SCC' OR
                    CTO-SIST IN CTO-VARI = 'SGE' )
               GO TO FIN-SEL-REG-PRO.

      * Valida el 'Opera Como' de la Operacion de Credito omite Hipoteca
      * Tarjeta Visa y Boleta Garantia
           IF CTO-OPEC IN CTO-VARI = 'H' OR
              CTO-OPEC IN CTO-VARI = 'T' OR
              CTO-OPEC IN CTO-VARI = 'B'
               GO TO FIN-SEL-REG-PRO.

      * Obtiene 'Opera Como'
           MOVE SPACES               TO TOC.
           MOVE CTO-OPEC IN CTO-VARI TO TOC-MSC-OPEC IN TOC.

      * Busca con el Codigo Clase Operacion en la Tabla cargada en Memor
      * el Indicador de Exclusion o Inclusion segun programa
           MOVE OPC-COD-COOC IN OPC TO CAU-COOC IN CAU-VARI.
           PERFORM COL-BUS-CAU.
           IF CAU-CMSG IN CAU-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CAU-CMSG IN CAU-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CAU-MEN2 IN CAU-VARI
                       'CON CODIGO : '     CAU-COOC IN CAU-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               GO TO FIN-SEL-REG-PRO.

      * Excluye Tipos de Operaciones segun Indicador en Pos. 47 Datos An
           MOVE CAU-DAT3 IN CAU-VARI TO WSS-GLS-DAT3 IN WSS-VARI.
           IF WSS-IND-OMIT IN WSS-VARI = 'X'
               GO TO FIN-SEL-REG-PRO.

           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      ******************************************************************
      * Distribucion de la Operacion para Sistemas lo Manejan >< de 'COL
       DIS-OPC-DIF-SIST SECTION.
       INI-DIS-OPC-DIF-SIST.
           MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
           MOVE  0  TO WSS-IND-MNAC IN WSS-VARI.

      * Monto Saldo del Credito de la Operacion en Pesos a Fecha Informe
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY OPC-VAL-SCRE IN OPC BY WSS-SGV-FINF IN WSS-VARI
                                GIVING WSS-VAL-SCAP IN WSS-VARI ROUNDED
           ELSE
               MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCAP IN WSS-VARI.

      * Monto Interes Devengado del Credito en Pesos a Fecha Informe
           MOVE DLC-VAL-INTD IN DLC TO WSS-VAL-INTS IN WSS-VARI.
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY WSS-VAL-INTS IN WSS-VARI BY
                        WSS-SGV-FINF IN WSS-VARI GIVING
                        WSS-VAL-INTS IN WSS-VARI ROUNDED.

      * Distribucion de Valores del Credito segun Plazo, Moneda
           MOVE  2  TO WSS-IND IN WSS-VARI.
           ADD WSS-VAL-SCAP IN WSS-VARI
               WSS-VAL-INTS IN WSS-VARI TO WSS-VAL-FINA IN WSS-VARI.
           ADD  1  TO WSS-NUM-OPCP IN WSS-VARI.

      * Acumula montos segun Codigos de Clase y Moneda de la Operacion
      * en la Tabla en Memoria para Grabacion de Totales del T13
           PERFORM COL-BUS-T13.

      * Actualiza montos segun Codigos de Clase y Moneda de la Operacion
      * en la Tabla en Memoria para display's de Totales
           PERFORM COL-BUS-DIS.

           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
       FIN-DIS-OPC-DIF-SIST.
           EXIT.
      ******************************************************************
      * Obtiene Valor de Cambio de Operacion Credito en Pesos a Fecha In
       DET-VAL-CAMB-FINF SECTION.
       INI-DET-VAL-CAMB-FINF.
           MOVE  1  TO WSS-IND-STAT IN WSS-VARI.

           IF OPC-COD-VCOC IN OPC = WSS-COD-UEFE IN WSS-VARI
               MOVE  1                       TO WSS-IND-MNAC IN WSS-VARI
               MOVE WSS-SGV-UEFE IN WSS-VARI TO WSS-SGV-FINF IN WSS-VARI
           ELSE
               MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
               MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA'
                           ' INFORME : '      WSS-FEC-FINF IN WSS-VARI
                           ' PARA : '         OPC-COD-VCOC IN OPC
                           ' EN OPERACION : ' OPC-CIC-IOPC IN OPC
                   GO TO FIN-DET-VAL-CAMB-FINF
               ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   DISPLAY 'IND. VIGENCIA NO VALIDO A FECHA'
                           ' INFORME : '      WSS-FEC-FINF IN WSS-VARI
                           ' PARA : '         OPC-COD-VCOC IN OPC
                           ' EN OPERACION : ' OPC-CIC-IOPC IN OPC
                   GO TO FIN-DET-VAL-CAMB-FINF
               ELSE
                   MOVE  1                  TO WSS-IND-MNAC IN WSS-VARI
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FINF IN WSS-VARI.

           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
       FIN-DET-VAL-CAMB-FINF.
           EXIT.
      *-----------------------------------------------------------------
      * Obtiene Valor de Cambio de Operacion Credito en Pesos a Fecha
      * Suspencion Devengo del Credito
       DET-VAL-CAMB-FSDE SECTION.
       INI-DET-VAL-CAMB-FSDE.
           MOVE  1  TO WSS-IND-STAT IN WSS-VARI.

           MOVE DLC-FEC-FSDE IN DLC      TO CAM-FEC-FCAM IN CAM(1).
           MOVE DLC-FEC-FSDE IN DLC      TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA'
                       ' SUSP. DEVENG.: ' DLC-FEC-FSDE IN DLC
                       ' PARA : '         OPC-COD-VCOC IN OPC
                       ' EN OPERACION : ' OPC-CIC-IOPC IN OPC
               GO TO FIN-DET-VAL-CAMB-FSDE
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'IND. VIGENCIA NO VALIDO A FECHA'
                       ' SUSP. DEVENG.: ' DLC-FEC-FSDE IN DLC
                       ' PARA : '         OPC-COD-VCOC IN OPC
                       ' EN OPERACION : ' OPC-CIC-IOPC IN OPC
               GO TO FIN-DET-VAL-CAMB-FSDE
           ELSE
               MOVE  1                  TO WSS-IND-MNAC IN WSS-VARI
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FINF IN WSS-VARI.

           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
       FIN-DET-VAL-CAMB-FSDE.
           EXIT.
      ******************************************************************
      * Obtiene informacion de Vencimiento anterior para calcular intere
      * a Fecha Suspencion Devengo del Credito
       SDEV-VEN-ANT-INI SECTION.
       INI-SDEV-VEN-ANT-INI.
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.

           PERFORM LEE-VEN-ANT.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO FIN-SDEV-VEN-ANT-INI.
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FVEA IN WSS-VARI.

           IF DLC-FEC-FSDE IN DLC < VEN-FEC-FVEN IN VEN
               MOVE  9  TO WSS-IND-FSDE IN WSS-VARI
               GO TO FIN-SDEV-VEN-ANT-INI.

           PERFORM DIF-DIA-FVEA-FSDE
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO FIN-SDEV-VEN-ANT-INI.
           MOVE FEC-NDIA IN FEC-VARI TO WSS-NUM-DDEV IN WSS-VARI.

           PERFORM LEE-VEN-OKS.
      *     IF WSS-IND-STAT IN WSS-VARI = 1
      *         GO TO FIN-SDEV-VEN-ANT-INI.

           PERFORM DIF-DIA-FVEA-FVEN.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO FIN-SDEV-VEN-ANT-INI.
           MOVE FEC-NDIA IN FEC-VARI TO WSS-NUM-DVEN IN WSS-VARI.

           MOVE  5  TO WSS-IND-FSDE IN WSS-VARI.
       FIN-SDEV-VEN-ANT-INI.
           EXIT.
      *-----------------------------------------------------------------
      * Obtiene con informacion de Vencimiento anterior diferencias de d
      * para calcular intereses a Fecha Suspencion Devengo del Credito
       SDEV-VEN-ANT-LUP SECTION.
       INI-SDEV-VEN-ANT-LUP.
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.

           PERFORM DIF-DIA-FVEA-FSDE
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO FIN-SDEV-VEN-ANT-LUP.
           MOVE FEC-NDIA IN FEC-VARI TO WSS-NUM-DDEV IN WSS-VARI.

           PERFORM DIF-DIA-FVEA-FVEN.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO FIN-SDEV-VEN-ANT-LUP.
           MOVE FEC-NDIA IN FEC-VARI TO WSS-NUM-DVEN IN WSS-VARI.

           MOVE  5  TO WSS-IND-FSDE IN WSS-VARI.
       FIN-SDEV-VEN-ANT-LUP.
           EXIT.
      *-----------------------------------------------------------------
       LEE-VEN-ANT SECTION.
       INI-LEE-VEN-ANT.
      *Lee vencimiento anterior
           MOVE  1  TO WSS-IND-STAT IN WSS-VARI.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           SUBTRACT 1             FROM VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   NEXT SENTENCE
               ELSE
                   DISPLAY 'ERROR : NO EXISTE VEN ANTERIOR '
                           '/KEY : ' VEN-KEY-IVEN IN VEN
                   GO TO FIN-LEE-VEN-ANT
           ELSE
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   NEXT SENTENCE
               ELSE
                   DISPLAY 'ERROR : NO EXISTE VEN ANTERIOR '
                           '/KEY : ' VEN-KEY-IVEN IN VEN
                   GO TO FIN-LEE-VEN-ANT.

           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
       FIN-LEE-VEN-ANT.
           EXIT.
      *-----------------------------------------------------------------
       DIF-DIA-FVEA-FSDE SECTION.
       INI-DIF-DIA-FVEA-FSDE.
      * Calcula Diferencia en Dias entre Fecha Vencimiento ANTERIOR y
      * Fecha Suspenso Devengo
           MOVE  0                       TO WSS-IND-STAT IN WSS-VARI.
           MOVE WSS-NUM-DVEA IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MVEA IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SVEA IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-AVEA IN WSS-VARI TO FEC-AEC1.
           MOVE DLC-NUM-DSDE IN DLC      TO FEC-DEC2.
           MOVE DLC-NUM-MSDE IN DLC      TO FEC-MEC2.
           MOVE DLC-NUM-SSDE IN DLC      TO FEC-SEC2.
           MOVE DLC-NUM-ASDE IN DLC      TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
       FIN-DIF-DIA-FVEA-FSDE.
           EXIT.
      *-----------------------------------------------------------------
       LEE-VEN-OKS SECTION.
       INI-LEE-VEN-OKS.
      *Restaura el VEN actual
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
           ELSE
               PERFORM COL-FIO-VEN.
       FIN-LEE-VEN-OKS.
           EXIT.
      *-----------------------------------------------------------------
       DIF-DIA-FVEA-FVEN SECTION.
       INI-DIF-DIA-FVEA-FVEN.
      * Calcula Diferencia en Dias entre Fecha Vencimiento ANTERIOR y
      * Fecha Vencimiento Actual
           MOVE  0                       TO WSS-IND-STAT IN WSS-VARI.
           MOVE WSS-NUM-DVEA IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MVEA IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SVEA IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-AVEA IN WSS-VARI TO FEC-AEC1.
           MOVE VEN-NUM-DVEN IN VEN      TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN      TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN      TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN      TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
       FIN-DIF-DIA-FVEA-FVEN.
           EXIT.
      ******************************************************************
      * Distribucion del Vencimiento Vigente
       DIS-OPC-VEN-1 SECTION.
       INI-DIS-OPC-VEN-1.
      * Determinacion de los Plazos del Vencimiento segun Fecha Vencimie
           ADD 1 TO WSS-NUM-VENS IN WSS-VARI.
           PERFORM DIF-MES-FINF-FVEN.
           IF WSS-IND-STAT IN WSS-VARI = 1
               DISPLAY 'ERROR AL CALCULAR PLAZO VENCIMIENTO VIGENTE : '
                        VEN-KEY-IVEN
               GO TO FIN-DIS-OPC-VEN-1.
           MOVE FEC-NMES IN FEC-VARI TO WSS-NUM-PLAZ IN WSS-VARI.
           PERFORM DIS-REG-PROC.

      * Monto Saldo Capital del Vencimiento en Pesos a Fecha Informe
      * para Doctos. Desc.
           IF TOC-MSC-OPEC IN TOC = 'D'
               MOVE ZEROES TO WSS-VAL-INTS IN WSS-VARI
               IF WSS-IND-MNAC IN WSS-VARI = 1
                   MULTIPLY VEN-VAL-SFIN IN VEN      BY
                            WSS-SGV-FINF IN WSS-VARI GIVING
                            WSS-VAL-SCAP IN WSS-VARI ROUNDED
                   GO TO CON-DIS-OPC-VEN-1
               ELSE
                   MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SCAP IN WSS-VARI
                   GO TO CON-DIS-OPC-VEN-1.

      *-----------------------------------------------------------------
      *Si a la cuota le falta el valor capital, lo completa con el inter
      *correspondiente
      *     IF VEN-VAL-CAPI IN VEN = 0
      *         SUBTRACT WSS-VAL-INTS IN WSS-VARI FROM
      *                  VEN-VAL-FINA IN VEN GIVING VEN-VAL-CAPI IN VEN
      *         MOVE VEN-VAL-CAPI IN VEN  TO   VEN-VAL-SCAP IN VEN.
      *-----------------------------------------------------------------
      * Monto Saldo Capital del Vencimiento en Pesos a Fecha Informe
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-SGV-FINF IN WSS-VARI
                                GIVING WSS-VAL-SCAP IN WSS-VARI ROUNDED
           ELSE
               MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SCAP IN WSS-VARI.

      * Sin Interes los Vencimientos Vigentes o cuando hay Suspencion De
           IF WSS-IND-FSDE IN WSS-VARI = 9 OR
              WSS-IND-INTE IN WSS-VARI = 9
               MOVE ZEROES TO WSS-VAL-INTS IN WSS-VARI
               GO TO CON-DIS-OPC-VEN-1.

      * Interes del Vencimiento Vigente devengado solo hasta Fecha Infor
           IF WSS-IND-INTE IN WSS-VARI = 1
               PERFORM DET-VAL-INTE
               IF WSS-IND-STAT IN WSS-VARI = 1
                   DISPLAY 'ERROR AL CALCULAR INTERES DEVENGADO : '
                           ' /KEY : ' VEN-KEY-IVEN IN VEN
                   GO TO FIN-DIS-OPC-VEN-1
               ELSE
                   MOVE  9  TO WSS-IND-INTE IN WSS-VARI
                   GO TO INT-DIS-OPC-VEN-1.

      * Monto Interes del Vencimiento Vigente
           SUBTRACT VEN-VAL-SCAP IN VEN FROM
                    VEN-VAL-SFIN IN VEN GIVING
                    WSS-VAL-INTS IN WSS-VARI.

      * Interes del Vencimiento Vigente cuando hay Suspencion del Deveng
           IF WSS-IND-FSDE IN WSS-VARI > 1
               COMPUTE WSS-VAL-INTS IN WSS-VARI =
                                     ( WSS-VAL-INTS IN WSS-VARI /
                                       WSS-NUM-DVEN IN WSS-VARI ) *
                                       WSS-NUM-DDEV IN WSS-VARI
               MOVE  9  TO WSS-IND-FSDE IN WSS-VARI.
       INT-DIS-OPC-VEN-1.
      * Monto Interes del Vencimiento Vigente en Pesos a Fecha Informe
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY WSS-VAL-INTS IN WSS-VARI BY
                        WSS-SGV-FINF IN WSS-VARI GIVING
                        WSS-VAL-INTS IN WSS-VARI ROUNDED.
       CON-DIS-OPC-VEN-1.
      * Distribucion de Valores del Vencimiento segun Plazo y Moneda
           ADD WSS-VAL-SCAP IN WSS-VARI
               WSS-VAL-INTS IN WSS-VARI TO WSS-VAL-FINA IN WSS-VARI.
           ADD 1 TO WSS-NUM-VENP IN WSS-VARI.

      * Acumula montos segun Codigos de Clase y Moneda de la Operacion
      * en la Tabla en Memoria para Grabacion de Totales del T13
           PERFORM COL-BUS-T13.

      * Actualiza montos segun Codigos de Clase y Moneda de la Operacion
      * en la Tabla en Memoria para display's de Totales
           PERFORM COL-BUS-DIS.
       FIN-DIS-OPC-VEN-1.
           EXIT.
      *-----------------------------------------------------------------
      * Calcula Diferencia en Meses entre Fecha Informe y Fecha Vencimie
       DIF-MES-FINF-FVEN SECTION.
       INI-DIF-MES-FINF-FVEN.
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
           MOVE WSS-FEC-FINF IN WSS-VARI TO FEC-FEC1.
           MOVE VEN-NUM-DVEN IN VEN      TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN      TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN      TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN      TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-MES  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
           IF FEC-NDIA IN FEC-VARI > 0
               ADD  1  TO FEC-NMES IN FEC-VARI.
       FIN-DIF-MES-FINF-FVEN.
           EXIT.
      *-----------------------------------------------------------------
      * Distribucion de Registros Seleccionados para Tramo Correspondien
       DIS-REG-PROC SECTION.
       INI-DIS-REG-PROC.
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 1
               MOVE 2 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 3
               MOVE 3 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 6
               MOVE 4 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 12
               MOVE 5 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 36
               MOVE 6 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 120
               MOVE 7 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI > 120
               MOVE 8 TO WSS-IND IN WSS-VARI.
       FIN-DIS-REG-PROC.
           EXIT.
      *-----------------------------------------------------------------
      * Obtiene Interes devengado del Vencimiento Vigente solo hasta Fec
      * Informe (tasa de periodo)
       DET-VAL-INTE SECTION.
       INI-DET-VAL-INTE.
           MOVE  1  TO WSS-IND-STAT IN WSS-VARI.

      * SMC-INI 13.09.1993
      *Carga FUNO, FDOS, FCOL, FBTV, TINT, TIPT, VCAM y llama a rutina
      * COL-CAL-INT para Obtener Tasa de Periodo
      *     MOVE ICG-COD-TINT IN ICG     TO INT-TIPT.
      *     IF ICG-COD-CVTI IN ICG NOT > SPACES
      *         MOVE ICG-SGV-TINT IN ICG TO INT-TINT
      *     ELSE
      *         MOVE ICG-SGV-SPRD IN ICG TO INT-TINT.
      * SMC-FIN 13.09.1993
      *FUNO = Fecha devengo o VEN anterior
           MOVE WSS-NUM-DANT IN WSS-VARI TO INT-DUNO.
           MOVE WSS-NUM-MANT IN WSS-VARI TO INT-MUNO.
           MOVE WSS-NUM-SANT IN WSS-VARI TO INT-SUNO.
           MOVE WSS-NUM-AANT IN WSS-VARI TO INT-AUNO.
      *FDOS = Fecha proceso (T13)
           MOVE WSS-NUM-DIN1 IN WSS-VARI TO INT-DDOS.
           MOVE WSS-NUM-MIN1 IN WSS-VARI TO INT-MDOS.
           MOVE WSS-NUM-SIN1 IN WSS-VARI TO INT-SDOS.
           MOVE WSS-NUM-AIN1 IN WSS-VARI TO INT-ADOS.
           MOVE OPC-NUM-DCOL IN OPC      TO INT-DCOL.
           MOVE OPC-NUM-MCOL IN OPC      TO INT-MCOL.
           MOVE OPC-NUM-SCOL IN OPC      TO INT-SCOL.
           MOVE OPC-NUM-ACOL IN OPC      TO INT-ACOL.
      *FBTV = Fecha devengo o VEN anterior
           MOVE WSS-NUM-DANT IN WSS-VARI TO INT-DBTV.
           MOVE WSS-NUM-MANT IN WSS-VARI TO INT-MBTV.
           MOVE WSS-NUM-SANT IN WSS-VARI TO INT-SBTV.
           MOVE WSS-NUM-AANT IN WSS-VARI TO INT-ABTV.
           MOVE OPC-COD-VCOC IN OPC      TO INT-VCAM.
      *SMC-INI 09.09.1993
           MOVE OPC-CIC-IOPC IN OPC      TO INT-IOPC.
      *DAD INI  14-OCT-1994
      *    MOVE VEN-NUM-IDLC IN VEN      TO INT-IOPC.
           MOVE VEN-NUM-IDLC IN VEN      TO INT-IDLC.
      *DAD FIN  14-OCT-1994
      *    PERFORM GNS-CAL-INT.
           PERFORM COL-CAL-INT.
      *SMC-FIN 09.09.1993
           IF INT-CMSG > SPACES
               MOVE 'COL'    TO MSG-COD-SIST
               MOVE INT-CMSG TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' ' INT-MENS ' ' CAM-KEY-CAMB IN CAM
               MOVE 0 TO INT-TIPE
               GO TO FIN-DET-VAL-INTE.

      * CALCULA EL INTERES DEL PERIODO COMO
      *       WSS-VAL-INTS = TIPE * ( SCRE - CMOR )
      *
           COMPUTE WSS-VAL-INTS IN WSS-VARI = INT-TIPE *
                     ( OPC-VAL-SCRE IN OPC - WSS-VAL-CMOR IN WSS-VARI ).

           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
       FIN-DET-VAL-INTE.
           EXIT.
      ******************************************************************
      * Distribucion del Vencimiento Moroso
       DIS-OPC-VEN-2 SECTION.
       INI-DIS-OPC-VEN-2.
      * Determinacion de los Plazos del Vencimiento segun Fecha Vencimie
           ADD 1 TO WSS-NUM-VENS IN WSS-VARI.
           PERFORM DIF-MES-FVEN-FINF.
           IF WSS-IND-STAT IN WSS-VARI = 1
               DISPLAY 'ERROR AL CALCULAR PLAZO VENCIMIENTO MOROSO : '
                        VEN-KEY-IVEN
               GO TO FIN-DIS-OPC-VEN-2.

      * Monto Saldo Capital del Vencimiento en Pesos a Fecha Informe
      * para Doctos. Desc.
           IF TOC-MSC-OPEC IN TOC = 'D'
               MOVE ZEROES TO WSS-VAL-INTS IN WSS-VARI
               IF WSS-IND-MNAC IN WSS-VARI = 1
                   MULTIPLY VEN-VAL-SFIN IN VEN      BY
                            WSS-SGV-FINF IN WSS-VARI GIVING
                            WSS-VAL-SCAP IN WSS-VARI ROUNDED
                   GO TO CON-DIS-OPC-VEN-2
               ELSE
                   MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SCAP IN WSS-VARI
                   GO TO CON-DIS-OPC-VEN-2.

      * Monto Saldo Capital del Vencimiento Moroso en Pesos a Fecha Info
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-SGV-FINF IN WSS-VARI
                                GIVING WSS-VAL-SCAP IN WSS-VARI ROUNDED
           ELSE
               MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SCAP IN WSS-VARI.

      * Sin Interes el Vencimiento Moroso cuando hay Suspencion del Deve
           IF WSS-IND-FSDE IN WSS-VARI = 9
               MOVE ZEROES TO WSS-VAL-INTS IN WSS-VARI
               GO TO CON-DIS-OPC-VEN-2.

      * Monto Interes del Vencimiento Moroso
           SUBTRACT VEN-VAL-SCAP IN VEN FROM
                    VEN-VAL-SFIN IN VEN GIVING
                    WSS-VAL-INTS IN WSS-VARI.

      * Interes del Vencimiento Moroso cuando hay Suspencion del Devengo
           IF WSS-IND-FSDE IN WSS-VARI > 1
               COMPUTE WSS-VAL-INTS IN WSS-VARI =
                                     ( WSS-VAL-INTS IN WSS-VARI /
                                       WSS-NUM-DVEN IN WSS-VARI ) *
                                       WSS-NUM-DDEV IN WSS-VARI
               MOVE  9  TO WSS-IND-FSDE IN WSS-VARI.

      * Monto Interes del Vencimiento Moroso en Pesos a Fecha Informe
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY WSS-VAL-INTS IN WSS-VARI BY
                        WSS-SGV-FINF IN WSS-VARI GIVING
                        WSS-VAL-INTS IN WSS-VARI ROUNDED.
       CON-DIS-OPC-VEN-2.
      * Distribucion de Valores del Vencimiento segun Plazo, Moneda y Es
           IF FEC-NMES IN FEC-VARI NOT > 1
               MOVE 2 TO WSS-IND IN WSS-VARI
           ELSE
               MOVE 9 TO WSS-IND IN WSS-VARI.
           ADD WSS-VAL-SCAP IN WSS-VARI
               WSS-VAL-INTS IN WSS-VARI TO WSS-VAL-FINA IN WSS-VARI.
           ADD 1 TO WSS-NUM-VENP IN WSS-VARI.

      * Acumula montos segun Codigos de Clase y Moneda de la Operacion
      * en la Tabla en Memoria para Grabacion de Totales del T13
           PERFORM COL-BUS-T13.

      * Actualiza montos segun Codigos de Clase y Moneda de la Operacion
      * en la Tabla en Memoria para display's de Totales
           PERFORM COL-BUS-DIS.
       FIN-DIS-OPC-VEN-2.
           EXIT.
      *-----------------------------------------------------------------
      * Calcula Diferencia en Meses entre Fecha Vencimiento y Fecha Info
       DIF-MES-FVEN-FINF SECTION.
       INI-DIF-MES-FVEN-FINF.
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
           MOVE VEN-NUM-DVEN IN VEN      TO FEC-DEC1.
           MOVE VEN-NUM-MVEN IN VEN      TO FEC-MEC1.
           MOVE VEN-NUM-SVEN IN VEN      TO FEC-SEC1.
           MOVE VEN-NUM-AVEN IN VEN      TO FEC-AEC1.
           MOVE WSS-FEC-FINF IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-MES  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
           IF FEC-NDIA IN FEC-VARI > 0
               ADD  1  TO FEC-NMES IN FEC-VARI.
       FIN-DIF-MES-FVEN-FINF.
           EXIT.
      ******************************************************************
      * Acumula montos segun Codigos de Clase y Moneda de la Operacion
      * en la Tabla en Memoria para Grabacion de Totales del T13
       COL-BUS-T13 SECTION.
       INI-COL-BUS-T13.
           MOVE OPC-COD-VCOC IN OPC TO WSS-T13-VCOC IN WSS-VARI.
           MOVE WSS-IND IN WSS-VARI TO WSS-T13-LINE IN WSS-VARI.
           SET T13-NUME TO 1.
           SEARCH T13-VECT VARYING T13-NUME
                  WHEN T13-IKEY(T13-NUME) = WSS-COD-IKEY IN WSS-VARI
                       GO TO FND-COL-BUS-T13.
      *    'CLASE DE OPERACIONES Y MONEDA NO ENCONTRADOS'
      *     ADD  1                        TO T13-INDX IN WSS-VARI.
           MOVE OPC-COD-VCOC IN OPC      TO T13-VCOC(T13-INDX).
           MOVE WSS-IND IN WSS-VARI      TO T13-LINE(T13-INDX).
           MOVE WSS-VAL-FINA IN WSS-VARI TO T13-MONT(T13-INDX).
           DISPLAY 'NO DEBI PASAR POR AQUI AL CARGAR TABLA T-13'.
           GO TO FIN-COL-BUS-T13.
       FND-COL-BUS-T13.
           ADD WSS-VAL-FINA IN WSS-VARI TO T13-MONT(T13-NUME).
       FIN-COL-BUS-T13.
           EXIT.
      *-----------------------------------------------------------------
      * Forma y Graba el Registro Interfaz T13 Super-Bancos - DAP- COL
       GEN-REG-T13 SECTION.
       INI-GEN-REG-T13.
           IF T13-MONT(WSS-SUB) NOT > ZEROES
               GO TO FIN-GEN-REG-T13.

      * Redondea el Monto sin centavos para pesos
           MOVE T13-MONT(WSS-SUB) TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-MNAC IN WSS-VARI.

      * Forma el Registro Interfaz T13 Super-Bancos - DAP- COL
           MOVE 'A'               TO T13-COD-TIPO IN T13.
           MOVE '01'              TO T13-COD-CORR IN T13.
           MOVE T13-VCOC(WSS-SUB) TO T13-CIC-VCAM IN T13.
           MOVE T13-LINE(WSS-SUB) TO T13-NUM-LINE IN T13.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SUP-FIO-T13.
           IF NOT FIO-STAT-OKS
               MOVE SPACES                   TO T13-GLS-FLAG IN T13
               MOVE 'COL'                    TO T13-COD-SIST IN T13
               MOVE SPACES                   TO T13-GLS-DISP IN T13
               MOVE WSS-VAL-MNAC IN WSS-VARI TO T13-VAL-MONT IN T13
               MOVE FIO-PUT TO FIO-CMND
               PERFORM SUP-FIO-T13
               IF NOT FIO-STAT-OKS
                   DISPLAY ' ERROR EN INGRESO T13, FIO-STAT : ' FIO-STAT
                   DISPLAY ' LLAVE : ' T13-KEY-IT13
                   PERFORM GNS-PRO-ABT
               ELSE
                   ADD 1 TO WSS-NUM-T13G
           ELSE
               ADD WSS-VAL-MNAC IN WSS-VARI TO T13-VAL-MONT IN T13
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SUP-FIO-T13
               IF NOT FIO-STAT-OKS
                   DISPLAY 'ERROR EN MODIFICACION T13, FIO-STAT : '
                            FIO-STAT
                   DISPLAY ' LLAVE : ' T13-KEY-IT13
                   PERFORM GNS-PRO-ABT.
       FIN-GEN-REG-T13.
           EXIT.
      *-----------------------------------------------------------------
      * Graba montos para Control de Proceso segun Codigos de Oficina,
      * Clase y Moneda del Credito por vencimiento en registro R13
       COL-BUS-DIS SECTION.
       INI-COL-BUS-DIS.
           MOVE OPC-COD-OFOC IN OPC      TO R13-COD-OFOC IN R13.
           MOVE OPC-COD-COOC IN OPC      TO R13-COD-COOC IN R13.
           MOVE OPC-COD-VCOC IN OPC      TO R13-COD-VCOC IN R13.
           MOVE WSS-VAL-SCAP IN WSS-VARI TO R13-VAL-CAPI IN R13.
           MOVE WSS-VAL-INTS IN WSS-VARI TO R13-VAL-INTE IN R13.
           MOVE WSS-VAL-FINA IN WSS-VARI TO R13-VAL-FINA IN R13.
      * JUS INI  28-DEC-1994
           MOVE VEN-CIC-IOPC IN VEN      TO R13-CIC-IOPC IN R13.
           MOVE VEN-NUM-IVCT IN VEN      TO R13-NUM-IVCT IN R13.
           MOVE VEN-FEC-FVEN IN VEN      TO R13-FEC-FVEN IN R13.
           MOVE DLC-COD-PLZO IN DLC      TO R13-COD-PLZO IN R13.
      * JUS FIN  28-DEC-1994
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-R13.
           IF NOT FIO-STAT-OKS
               DISPLAY ' ERROR AL GRABAR R13, FIO-STAT : ' FIO-STAT
               DISPLAY ' EN VEN : ' VEN-KEY-IVEN IN VEN
               PERFORM GNS-PRO-ABT
           ELSE
               ADD 1 TO WSS-NUM-R13G.
       FIN-COL-BUS-DIS.
           EXIT.
      ******************************************************************
      ******************************************************************
      * Busca Ultima Cancelacion del Credito sin Saldo a fecha Informe
       BUS-ULT-CAN SECTION.
       INI-BUS-ULT-CAN.
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO CAN-CIC-IOPC IN CAN.
           MOVE 999                 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-ULT-CAN.
           PERFORM COL-FIO-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CIC-IOPC IN CAN = OPC-CIC-IOPC IN OPC )
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-BUS-ULT-CAN.

      * Verifica que Cancelacion leida este con Estado 'ACA' y sea poste
      * al Periodo de Proceso
           IF CAN-MSC-STAT IN CAN = 'A' AND
              CAN-FEC-FCAN IN CAN > WSS-FEC-FIN1 IN WSS-VARI
               GO TO FIN-BUS-ULT-CAN.

           MOVE  1  TO WSS-IND-ERRO IN WSS-VARI.
       FIN-BUS-ULT-CAN.
           EXIT.
      ******************************************************************

       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGEND.
       COPY GNSBGABT.

       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY TABBFCAM.
       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY COLBFDLC.
       COPY COLBFVEN.
       COPY COLBFCAN.
       COPY COLBFRCV.
       COPY COLBFEVC.
       COPY COLBFICG.
       COPY COLBFTOC.
       COPY COLBFRDT.
       COPY COLBFR13.
       COPY SUPBFT13.
       COPY GNSBBMSC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY TABBBUSR.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBGCAM.
       COPY COLBGVEN.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGPES.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY COLBGCAU.
       COPY COLBGCTO.
      *>>>>

