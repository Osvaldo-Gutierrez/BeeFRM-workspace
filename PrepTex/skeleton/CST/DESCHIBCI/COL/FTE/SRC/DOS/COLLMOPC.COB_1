       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.    COLLMOPC.
       AUTHOR.        CONSIST.
       DATE-WRITTEN.  13-MAY-1993.

      * LIMPIA TABLA OPC.

       ENVIRONMENT DIVISION.
      *=====================

       DATA DIVISION.
      *==============
       WORKING-STORAGE SECTION.
      *------------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA.
       COPY COLBROPC.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGUIB.
       COPY GNSWGELS.

       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
           PERFORM OPN-FIL.
           PERFORM PRO-FIL.
           PERFORM CLO-FIL.
       FIN-MAIN.
           STOP RUN.

       OPN-FIL SECTION.
       INI-OPN-FIL.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO OPC'
               DISPLAY 'ABORTO'
               PERFORM PRG-ABT.
       FIN-OPN-FIL.
           EXIT.

       CLO-FIL SECTION.
       INI-CLO-FIL.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       FIN-CLO-FIL.
           EXIT.

       PRO-FIL SECTION.
       INI-PRO-FIL.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM PRO-DEL UNTIL NOT FIO-STAT-OKS.
       FIN-PRO-FIL.
           EXIT.

       PRO-DEL SECTION.
       INI-PRO-DEL.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       FIN-PRO-DEL.
           EXIT.

       COPY COLBFOPC.
       COPY GNSBGDTC.
       COPY GNSBTABT.
      *
