       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLBIC.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    04-May-95 08:12 PM.

      * Programa Listador de Reporte BIC con Sort.


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTBIC         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTBIC         ASSIGN TO        UT-S-RPTBIC.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT RPTBIC         ASSIGN TO        UT-S-RPTBIC.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY COLRRBIC.
       FD  RPTBIC LABEL RECORDS OMITTED
           REPORT IS RPT-BIC
           .

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DVG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBRDVG.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWBIC.
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY GNSBRMSC.
       COPY TABBROFI.
       COPY COLBRDCC.
       COPY COLBRCPP.
       COPY COLBRRDC.
       COPY COLBRDVI.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY SGCBRDBC.
       COPY GNSWGCPT.
      * COPY GNSWGCVI.
       01  WSS-VARI.
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 WSS-COD-TABL                        PIC X(31).
           03 WSS-CIC-CCSB.
              05 WSS-CAI-CCSB                     PIC X(04).
              05 WSS-IIC-CCSB                     PIC X(08).
           03 WSS-CTA-GAME.
              05 WSS-CTA-INH                      PIC X(12).
              05 WSS-CTA-RNH                      PIC X(12).
              05 WSS-CTA-IND                      PIC X(12).
              05 WSS-CTA-RND                      PIC X(12).

              05 WSS-CTA-IOH                      PIC X(12).
              05 WSS-CTA-ROH                      PIC X(12).
              05 WSS-CTA-IOD                      PIC X(12).
              05 WSS-CTA-ROD                      PIC X(12).

              05 WSS-CTA-IMH                      PIC X(12).
              05 WSS-CTA-RMH                      PIC X(12).
              05 WSS-CTA-IMD                      PIC X(12).
              05 WSS-CTA-RMD                      PIC X(12).
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>

       REPORT SECTION.
      *--------------
       COPY COLRFBIC.
           .
       COPY COLRTBIC.

       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-CF-BIC-DVG-COD-OFOC SECTION.
           USE BEFORE REPORTING CF-BIC-DVG-COD-OFOC.
       INI-CF-BIC-DVG-COD-OFOC.
      *<<<< CF_BIC_DVG_COD_OFOC
      *>>>>
       FIN-CF-BIC-DVG-COD-OFOC.
           EXIT.
       DEC-CF-BIC-DVG-COD-VCOC SECTION.
           USE BEFORE REPORTING CF-BIC-DVG-COD-VCOC.
       INI-CF-BIC-DVG-COD-VCOC.
      *<<<< CF_BIC_DVG_COD_VCOC
      *>>>>
       FIN-CF-BIC-DVG-COD-VCOC.
           EXIT.
       DEC-CH-BIC-DCC-GLS-CCSB SECTION.
           USE BEFORE REPORTING CH-BIC-DCC-GLS-CCSB.
       INI-CH-BIC-DCC-GLS-CCSB.
      *<<<< CH_BIC_DCC_GLS_CCSB
      *>>>>
       FIN-CH-BIC-DCC-GLS-CCSB.
           EXIT.
       DEC-PH-BIC SECTION.
           USE BEFORE REPORTING PH-BIC.
       INI-PH-BIC.
      *<<<< PH_BIC
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           DISPLAY 'PH POR OFI'.
           IF DVG-COD-OFOC IN SRT > SPACES
               MOVE DVG-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
      *         MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-BIC
           ELSE
      *         MOVE SPACES TO WSS-GLS-OFOC IN WSS-BIC.
               MOVE SPACES TO OFI-GLS-DESC IN OFI.

           DISPLAY 'BUS-TAB'.
      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF DVG-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE DVG-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
      *         MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCOC IN WSS-BIC
           ELSE
      *         MOVE SPACES TO WSS-GLS-VCOC IN WSS-BIC.
               MOVE SPACES TO TAB-GLS-DCOR IN TAB.
      *>>>>
       FIN-PH-BIC.
           EXIT.
       DEC-FF-BIC SECTION.
           USE BEFORE REPORTING FF-BIC.
       INI-FF-BIC.
      *<<<< FF_BIC
      *>>>>
       FIN-FF-BIC.
           EXIT.
      *<<<< FIN_DEC
      *>>>>
       END DECLARATIVES.

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPLBIC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Proceso
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
           MOVE WSS-FEC-FPRO    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.

           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN WSS-BIC.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN WSS-BIC.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN WSS-BIC.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN WSS-BIC.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
      *>>>>
           SORT GNSSRT
       COPY COLRSBIC.
      *<<<< RS
      *>>>>
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
      *<<<< FIN
      *>>>>
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP
           DISPLAY 'INI-INP'.
      *>>>>
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-DVG.
           DISPLAY 'ABRI DVG'.
       FST-INP-SRT.
      *<<<< INI_FST_INP
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-DVG.
      *<<<< FIN_FST_INP
           DISPLAY 'LEI PRIMER REG. DVG'.
           DISPLAY 'DVG: ' DVG.
      *    Inicializo Codigo Auxiliar para controlar cambio de Cta.
           MOVE SPACES TO WSS-COD-TABL IN WSS-VARI.
      *>>>>
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           IF DVG-COD-TABL IN DVG NOT = WSS-COD-TABL IN WSS-VARI
      *       Va a buscar Cždigos Ctas. segžn Banco
              MOVE DVG-COD-TABL IN DVG TO DCC-COD-TABL IN DCC
                                          WSS-COD-TABL IN WSS-VARI
              MOVE FIO-INP TO FIO-CMND
              DISPLAY 'VOY A ARMAR JUEGO DE CTAS'
              PERFORM ARMA-JUEGO-CTAS
              DISPLAY 'SALIENDO DE ARMAR JUEGO DE CTAS.'.

      *>>>>
       MOV-INP-SRT.
      *COPY COLRMBIC.
      *<<<< RM
      *>>>>
      *    RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DVG.
      *<<<< FIN_NXT_INP
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *<<<< FIN_INP
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-DVG.
           DISPLAY 'LEI SIGUIENTE REG. DVG'.
           DISPLAY 'DVG: ' DVG.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
      *<<<< INI_OUT
      *>>>>
           OPEN OUTPUT RPTBIC.
      *     MOVE 'COLPLBIC' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.
           INITIATE RPT-BIC.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
      *<<<< FST_OUT
      *    Inicializo Cod.Aux. para controlar cambio de Cta.
           MOVE SPACES TO WSS-CIC-CCSB IN WSS-VARI.
      *    Apertura de archivo SAM Organizado por Cuentas de Interes
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-DVI.
      *>>>>
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           DISPLAY 'SRT-OUT: ' SRT.
           IF DCC-GLS-CCSB IN SRT NOT = WSS-CIC-CCSB IN WSS-VARI
      *       Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
              MOVE DCC-GLS-CCSB IN SRT TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB      TO WSS-GLS-CCSB IN WSS-BIC
              MOVE TAB-COD-CTAB IN TAB      TO WSS-CIC-CCSB IN WSS-VARI
              MOVE WSS-CAI-CCSB IN WSS-VARI TO WSS-CAI-CCSB IN WSS-BIC
              MOVE WSS-IIC-CCSB IN WSS-VARI TO WSS-IIC-CCSB IN WSS-BIC
           ELSE
              MOVE 'ERROR: NO HAY CTA' TO WSS-GLS-CCSB IN WSS-BIC
              MOVE SPACES TO WSS-CAI-CCSB IN WSS-BIC
                             WSS-IIC-CCSB IN WSS-BIC.

           PERFORM BUS-REG-CLI.
      *>>>>
       GEN-OUT-SRT.
           GENERATE DL-BIC.
      *<<<< FIN_GEN_OUT
      *
      *    Genera Registros Organizados por Ctas. de Interes
      *
           MOVE FIO-PUT TO FIO-CMND.

           IF DVG-VAL-INTD IN DVG = ZEROES
              GO TO SIGUE-1.

           MOVE WSS-CTA-INH  IN WSS-VARI TO DVI-COD-CCSB IN DVI.
           MOVE DVG-VAL-INTD IN DVG      TO DVI-VAL-MCTB IN DVI.
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
                 DISPLAY 'ERROR AL GRABAR REG.DVI (INH)'.

           MOVE WSS-CTA-IND IN WSS-VARI TO DVI-COD-CCSB IN DVI
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.DVI (IND)'.

       SIGUE-1.
           IF DVG-VAL-READ IN DVG = ZEROES
              GO TO SIGUE-2.

           MOVE WSS-CTA-RNH  IN WSS-VARI TO DVI-COD-CCSB IN DVI.
           MOVE DVG-VAL-READ IN DVG      TO DVI-VAL-MCTB IN DVI.
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.DVI (RNH)'.

           MOVE WSS-CTA-RND IN WSS-VARI TO DVI-COD-CCSB IN DVI.
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.DVI (RND)'.

       SIGUE-2.
           IF DVG-VAL-INTO IN DVG = ZEROES
              GO TO SIGUE-3.

           MOVE WSS-CTA-IOH  IN WSS-VARI TO DVI-COD-CCSB IN DVI.
           MOVE DVG-VAL-INTO IN DVG      TO DVI-VAL-MCTB IN DVI.
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
                 DISPLAY 'ERROR AL GRABAR REG.DVI (IOH)'.

           MOVE WSS-CTA-IOD  IN WSS-VARI TO DVI-COD-CCSB IN DVI
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.DVI (IOD)'.

       SIGUE-3.
           IF DVG-VAL-REAO IN DVG = ZEROES
              GO TO SIGUE-4.

           MOVE WSS-CTA-ROH  IN WSS-VARI TO DVI-COD-CCSB IN DVI.
           MOVE DVG-VAL-REAO IN DVG      TO DVI-VAL-MCTB IN DVI.
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
                 DISPLAY 'ERROR AL GRABAR REG.DVI (ROH)'.

           MOVE WSS-CTA-ROD  IN WSS-VARI TO DVI-COD-CCSB IN DVI
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.DVI (ROD)'.

       SIGUE-4.
           IF DVG-VAL-INTM IN DVG = ZEROES
              GO TO SIGUE-5.

           MOVE WSS-CTA-IMH  IN WSS-VARI TO DVI-COD-CCSB IN DVI.
           MOVE DVG-VAL-INTM IN DVG      TO DVI-VAL-MCTB IN DVI.
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
                 DISPLAY 'ERROR AL GRABAR REG.DVI (IMH)'.

           MOVE WSS-CTA-IMD IN WSS-VARI TO DVI-COD-CCSB IN DVI
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.DVI (IMD)'.

       SIGUE-5.
           IF DVG-VAL-REAM IN DVG = ZEROES
              GO TO NXT-OUT-SRT.

           MOVE WSS-CTA-RMH  IN WSS-VARI TO DVI-COD-CCSB IN DVI.
           MOVE DVG-VAL-REAM IN DVG      TO DVI-VAL-MCTB IN DVI.
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.DVI (RMH)'.

           MOVE WSS-CTA-RMD IN WSS-VARI TO DVI-COD-CCSB IN DVI.
           PERFORM COL-FIO-DVI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.DVI (RMD)'.
      *>>>>
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
      *>>>>
           TERMINATE RPT-BIC.
      *<<<< FIN_TMT
      *>>>>
           CLOSE RPTBIC.
       EXT-OUT-SRT.
           EXIT.
       COPY COLBFDVG.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF
      *****************************************************************
       ARMA-JUEGO-CTAS SECTION.
       INI-ARMA-JUEGO-CTAS.
      *   Cuentas para Interes y Reajustes Normales
            MOVE 'INH' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (INH)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               DISPLAY 'DCC-GLS-CCSB: ' DCC-GLS-CCSB IN DCC
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-INH IN WSS-VARI
               PERFORM MUEVE-GRABA-SRT.

            MOVE 'RNH' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (RNH)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-RNH IN WSS-VARI.

            MOVE 'IND' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (IND)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-IND IN WSS-VARI.

            MOVE 'RND' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (RND)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-RND IN WSS-VARI.

      *   Cuentas para Interes y Reajustes de Orden
            MOVE 'IOH' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (IOH)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-IOH IN WSS-VARI.

            MOVE 'ROH' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (ROH)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-ROH IN WSS-VARI.

            MOVE 'IOD' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (IOD)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-IOD IN WSS-VARI.

            MOVE 'ROD' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (ROD)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-ROD IN WSS-VARI.

      *   Cuentas para Interes y Reajustes de Mora
            MOVE 'IMH' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (IMH)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-IMH IN WSS-VARI.

            MOVE 'RMH' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (RMH)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-RMH IN WSS-VARI.

            MOVE 'IMD' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (IMD)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-IMD IN WSS-VARI.

            MOVE 'RMD' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (RMD)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG
            ELSE
               MOVE DCC-GLS-CCSB IN DCC TO WSS-CTA-RMD IN WSS-VARI.

      * Busca Cta. Capital asociada al Producto.
            MOVE 'CAP' TO DCC-MSC-TCCT IN DCC.
            PERFORM COL-FIO-DCC.
            IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO HAY COD.CTA. (CAP)EN DCC OPC: '
                                                   DVG-CIC-IOPC IN DVG.
            GO TO FIN-ARMA-JUEGO-CTAS.
       MUEVE-GRABA-SRT.
       COPY COLRMBIC.
            RELEASE SRT.
       FIN-ARMA-JUEGO-CTAS.
           EXIT.

      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro
       BUS-REG-CLI SECTION.
       INI-BUS-REG-CLI.
      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en R
           MOVE DVG-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE DVG-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RDC-KEY-IDLC IN RDC
               GO TO FIN-BUS-REG-CLI.

      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-NUM-ICLI IN DBC
                              DBC-VRF-ICLI IN DBC
                              DBC-IND-ICLI IN DBC
      *                        WSS-GLS-AUXI IN WSS-BIC
                              DBC-GLS-ICLI IN DBC
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *         IF DBC-GLS-ICLI IN DBC > SPACES
      *             MOVE '-'    TO WSS-GLS-AUXI IN WSS-BIC
      *         ELSE
      *             MOVE SPACES TO WSS-GLS-AUXI IN WSS-BIC.
       FIN-BUS-REG-CLI.
           EXIT.
      ******************************************************************

       COPY GNSBFMSC.
       COPY TABBFOFI.
       COPY COLBFDCC.
       COPY COLBFRDC.
       COPY COLBFDVI.
       COPY SGCBFDBC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY TABBBOFI.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY SGCBGCLI.
       COPY GNSBGCPT.
      * COPY GNSBGCVI.
      *>>>>

