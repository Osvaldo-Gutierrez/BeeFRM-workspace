       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLCC4.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    20-Jan-93 01:10 PM.

      * Programa Listador de Reporte DOI con Sort.


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTDOI         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTDOI         ASSIGN TO        UT-S-RPTDOI.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT RPTDOI         ASSIGN TO        UT-S-RPTDOI.
      *<<<< IOS
      *DOS SELECT RPTTOI         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTTOI         ASSIGN TO        UT-S-RPTTOI.
           SELECT RPTTOI         ASSIGN TO        UT-S-RPTTOI.
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY COLRRDOI.
       FD  RPTDOI LABEL RECORDS OMITTED
           REPORT IS RPT-DOI
           .
      *<<<< FLS
       FD  RPTTOI LABEL RECORDS OMITTED
           REPORT IS RPT-TOI.
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RC4-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBRRC4.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGIFD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWDOI.
      *<<<< RW
       COPY COLRWTOI.
      *>>>>
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY TABBROFI.
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.

       01  WSS-VARI.
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                          PIC 9(02).
              05 WSS-NUM-MPRO                          PIC 9(02).
              05 WSS-NUM-SPRO                          PIC 9(02).
              05 WSS-NUM-APRO                          PIC 9(02).
           03 WSS-IND-TOFI                             PIC X(01).
           03 WSS-I                                    PIC 9(02).
           03 WSS-COD-OFOC.
              05 WSS-IND-OFOC      OCCURS 10           PIC X(03).
           03 WSS-IND-NEXT                             PIC 9(01).
           03 WSS-NUM-RC4L         VALUE 0             PIC 9(07).
           03 WSS-NUM-RC4S         VALUE 0             PIC 9(07).
           03 WSS-NUM-RC4P         VALUE 0             PIC 9(07).
           03 WSS-NUM-RC4R         VALUE 0             PIC 9(07).
           03 WSS-NUM-RDCR         VALUE 0             PIC 9(07).
           03 WSS-COD-OFIC                             PIC X(03).
           03 WSS-IND-TCLA                             PIC X(02).
           03 WSS-GLO1                                 PIC X(30)
                        VALUE 'CUOTAS AL DIA'.
           03 WSS-GLO2                                 PIC X(30)
                        VALUE 'ATRASO HASTA 30 DIAS'.
           03 WSS-GLO3                                 PIC X(30)
                        VALUE 'ATRASO DE 31 A 90 DIAS'.
           03 WSS-GLO4                                 PIC X(30)
                        VALUE 'ATRASO DE 91 A 150 DIAS'.
           03 WSS-GLO5                                 PIC X(30)
                        VALUE 'ATRASO DE MAS DE 150 DIAS'.
           03 WSS-GLO6                                 PIC X(30)
                        VALUE 'CUALQUIER ATRASO REG. MALO'.

      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>

       REPORT SECTION.
      *--------------
       COPY COLRFDOI.
           .
       COPY COLRTDOI.
      *<<<< RT
       COPY COLRFTOI.
           .
       COPY COLRTTOI.
      *>>>>

       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-CF-DOI-RC4-COD-OFOC SECTION.
           USE BEFORE REPORTING CF-DOI-RC4-COD-OFOC.
       INI-CF-DOI-RC4-COD-OFOC.
      *<<<< CF_DOI_RC4_COD_OFOC
      *>>>>
       FIN-CF-DOI-RC4-COD-OFOC.
           EXIT.
       DEC-CF-DOI-RC4-IND-TCLA SECTION.
           USE BEFORE REPORTING CF-DOI-RC4-IND-TCLA.
       INI-CF-DOI-RC4-IND-TCLA.
      *<<<< CF_DOI_RC4_IND_TCLA
      *>>>>
       FIN-CF-DOI-RC4-IND-TCLA.
           EXIT.
       DEC-PH-DOI SECTION.
           USE BEFORE REPORTING PH-DOI.
       INI-PH-DOI.
      *<<<< PH_DOI
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF RC4-COD-OFOC IN SRT > SPACES
               MOVE RC4-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI.

           IF RC4-IND-TCLA IN SRT = '1'
               MOVE 'A' TO WSS-IND-TCLA IN WSS-DOI
           ELSE
           IF RC4-IND-TCLA IN SRT = '2'
               MOVE 'B' TO WSS-IND-TCLA IN WSS-DOI
           ELSE
           IF RC4-IND-TCLA IN SRT = '3'
               MOVE 'B-' TO WSS-IND-TCLA IN WSS-DOI
           ELSE
           IF RC4-IND-TCLA IN SRT = '4'
               MOVE 'C' TO WSS-IND-TCLA IN WSS-DOI
           ELSE
           IF RC4-IND-TCLA IN SRT = '5'
               MOVE 'D' TO WSS-IND-TCLA IN WSS-DOI
           ELSE
               MOVE 'X' TO WSS-IND-TCLA IN WSS-DOI.
      *>>>>
       FIN-PH-DOI.
           EXIT.
      *<<<< FIN_DEC
       DEC-CH-TOI-SRT-COD-OFOC SECTION.
           USE BEFORE REPORTING CH-TOI-SRT-COD-OFOC.
       INI-CH-TOI-SRT-COD-OFOC.
      *<<<< CH_TOI_SRT_COD_OFOC
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
      *     MOVE WSS-COD-OFIC IN WSS-VARI TO SRT-COD-OFOC IN SRT
      *     MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
           IF SRT-COD-OFOC IN SRT > SPACES
               MOVE SRT-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI.
      *         MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-TOI
      *     ELSE
      *         MOVE SPACES TO WSS-GLS-OFOC IN WSS-TOI.
      *>>>>
       FIN-CH-TOI-SRT-COD-OFOC.
           EXIT.
       DEC-CF-TOI-RC4-COD-OFOC SECTION.
           USE BEFORE REPORTING CF-TOI-RC4-COD-OFOC.
       INI-CF-TOI-RC4-COD-OFOC.
      *<<<< CF_TOI_RC4_COD_OFOC
      *>>>>
       FIN-CF-TOI-RC4-COD-OFOC.
           EXIT.
       DEC-PH-TOI SECTION.
           USE BEFORE REPORTING PH-TOI.
       INI-PH-TOI.
      *<<<< PH_TOI
      *>>>>
       FIN-PH-TOI.
           EXIT.
      *>>>>
       END DECLARATIVES.

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPLCC4' TO FIO-PROG.
           PERFORM BUS-FSIS.
      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      * Captura Indicador Totales por Oficina
           DISPLAY 'TOTALES POR OFICINA ( S / N ) : '.
           ACCEPT  WSS-IND-TOFI IN WSS-VARI.
           DISPLAY WSS-IND-TOFI IN WSS-VARI.
      * Captura Indicador Detalle por Oficina(x10)
           DISPLAY 'OFICINA (N=NO,*=TODAS,NRO.OFICINA): '.
           MOVE SPACES TO WSS-COD-OFOC IN WSS-VARI.
           ACCEPT  WSS-COD-OFOC IN WSS-VARI.
           DISPLAY WSS-COD-OFOC IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Proceso
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
           MOVE WSS-FEC-FPRO    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-ABT.

      * Carga Fecha de Proceso en los Reportes
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN WSS-DOI
                                            WSS-NUM-DPRO IN WSS-TOI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN WSS-DOI
                                            WSS-NUM-MPRO IN WSS-TOI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN WSS-DOI
                                            WSS-NUM-SPRO IN WSS-TOI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN WSS-DOI
                                            WSS-NUM-APRO IN WSS-TOI.

      * Valida Indicador de Totales por Oficina
           IF WSS-IND-TOFI IN WSS-VARI NOT = 'S' AND
              WSS-IND-TOFI IN WSS-VARI NOT = 'N'
               DISPLAY WSS-IND-TOFI IN WSS-VARI ' : '
                       'PARAMETRO NO VALIDO, DEBE DIGITAR "N" O "S"'
               PERFORM GNS-PRO-ABT.

      * Valida Indicador de Detalle por Oficina(x10)
      *VAL-OFI Valida codigo de Oficina en TABLAS
           IF WSS-COD-OFOC IN WSS-VARI NOT > SPACES
               MOVE 'N' TO WSS-COD-OFOC IN WSS-VARI.
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*' AND
              WSS-COD-OFOC IN WSS-VARI NOT = 'N'
               MOVE 1 TO WSS-I IN WSS-VARI
               PERFORM VAL-PAR-OFOC UNTIL WSS-I IN WSS-VARI > 10
               DISPLAY WSS-COD-OFOC IN WSS-VARI
               IF WSS-COD-OFOC IN WSS-VARI NOT > SPACES
                   DISPLAY 'NO EXISTE NINGUNA OFICINA INGRESADA VALIDA'
                   PERFORM GNS-PRO-ABT.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * Informes NO se emiten
           IF WSS-IND-TOFI IN WSS-VARI = 'N'
               DISPLAY '*** NO SE EMITE LISTADO DE TOTALES ***'.

           IF WSS-COD-OFOC IN WSS-VARI = 'N'
               DISPLAY '*** NO SE EMITE LISTADO DE DETALLES ***'.

           IF WSS-IND-TOFI IN WSS-VARI = 'N' AND
              WSS-COD-OFOC IN WSS-VARI = 'N'
               DISPLAY 'NO SE EMITEN LISTADOS DE DETALLE Y TOTALES'
               GO TO FIN-MAIN.
      *>>>>
           SORT GNSSRT
       COPY COLRSDOI.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
      *<<<< FIN
      *>>>>
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP
      * Apertura de Registros
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           PERFORM SGC-FIO-DBC.
      *>>>>
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RC4.
       FST-INP-SRT.
      *<<<< INI_FST_INP
      * Para Saltarce el Comando FIO_GET_FST No Disponible para SAM por
           GO TO NXT-INP-SRT.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-RC4.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
      * Proceso de Seleccion y Clasificacion a Partir del Registro RC4
           ADD 1 TO WSS-NUM-RC4L IN WSS-VARI.
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               ADD 1 TO WSS-NUM-RC4R IN WSS-VARI
               GO TO NXT-INP-SRT.

           ADD 1 TO WSS-NUM-RC4S IN WSS-VARI.
           MOVE SPACES TO SRT-COD-OFOC IN SRT.
           IF WSS-COD-OFOC IN WSS-VARI NOT = 'N'
               PERFORM BUS-REG-CLI
               IF WSS-IND-NEXT IN WSS-VARI = 1
                   ADD 1 TO WSS-NUM-RDCR IN WSS-VARI
                   GO TO NXT-INP-SRT.
           ADD 1 TO WSS-NUM-RC4P IN WSS-VARI.
      *>>>>
       MOV-INP-SRT.
       COPY COLRMDOI.
           RELEASE SRT.
       NXT-INP-SRT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RC4.
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *<<<< FIN_INP
      * Cierre de Registros
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           PERFORM SGC-FIO-DBC.
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-RC4.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
      *<<<< INI_OUT
      * Despliega Totales de Control Proceso
           DISPLAY 'TOTAL RC4 LEIDOS             : '
                               WSS-NUM-RC4L IN WSS-VARI.
           DISPLAY 'TOTAL RC4 SELECCIONADOS      : '
                               WSS-NUM-RC4S IN WSS-VARI.
           DISPLAY 'TOTAL RC4 PROCESADOS         : '
                               WSS-NUM-RC4P IN WSS-VARI.
           DISPLAY 'TOTAL RC4 RECHAZADOS         : '
                               WSS-NUM-RC4R IN WSS-VARI.
           DISPLAY 'TOTAL RDC RECHAZADOS         : '
                               WSS-NUM-RDCR IN WSS-VARI.
      *>>>>
           OPEN OUTPUT RPTDOI.
           CALL 'GNSPLHDR' USING RPT-VARI.
           INITIATE RPT-DOI.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
      *<<<< FST_OUT
           IF WSS-IND-TOFI IN WSS-VARI = 'N'
               GO TO LUP-OUT-SRT.

           OPEN OUTPUT RPTTOI.
           INITIATE RPT-TOI.
           MOVE RC4-COD-OFOC IN SRT TO WSS-COD-OFIC IN WSS-VARI.
           MOVE RC4-IND-TCLA IN SRT TO WSS-IND-TCLA IN WSS-VARI.
           IF RC4-IND-TCLA IN SRT = '1'
               MOVE 'A'                  TO WSS-IND-TCLA IN WSS-TOI
               MOVE WSS-GLO1 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
           ELSE
           IF RC4-IND-TCLA IN SRT = '2'
               MOVE 'B'                  TO WSS-IND-TCLA IN WSS-TOI
               MOVE WSS-GLO2 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
           ELSE
           IF RC4-IND-TCLA IN SRT = '3'
               MOVE 'B-'                 TO WSS-IND-TCLA IN WSS-TOI
               MOVE WSS-GLO3 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
           ELSE
           IF RC4-IND-TCLA IN SRT = '4'
               MOVE 'C'                  TO WSS-IND-TCLA IN WSS-TOI
               MOVE WSS-GLO4 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
           ELSE
           IF RC4-IND-TCLA IN SRT = '5'
               MOVE 'D'                  TO WSS-IND-TCLA IN WSS-TOI
               MOVE WSS-GLO5 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
           ELSE
               MOVE 'X'                  TO WSS-IND-TCLA IN WSS-TOI
               MOVE WSS-GLO6 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI.
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
           PERFORM BUS-OFI.
      *>>>>
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           IF WSS-COD-OFOC IN WSS-VARI = 'N'
               GO TO GEN-OUT-TOI.
      *>>>>
       GEN-OUT-SRT.
           GENERATE DL-DOI.
      *<<<< FIN_GEN_OUT
       GEN-OUT-TOI.
           IF WSS-IND-TOFI IN WSS-VARI = 'N'
               GO TO NXT-OUT-SRT.

           IF RC4-COD-OFOC IN SRT NOT = WSS-COD-OFIC IN WSS-VARI OR
              RC4-IND-TCLA IN SRT NOT = WSS-IND-TCLA IN WSS-VARI
               MOVE WSS-COD-OFIC IN WSS-VARI TO SRT-COD-OFOC IN SRT
               GENERATE DL-TOI
               MOVE RC4-COD-OFOC IN SRT TO WSS-COD-OFIC IN WSS-VARI
               MOVE RC4-IND-TCLA IN SRT TO WSS-IND-TCLA IN WSS-VARI
               MOVE ZEROES              TO WSS-NUM-OPER IN WSS-TOI
                                           WSS-VAL-SCRE IN WSS-TOI
                                           WSS-VAL-REAJ IN WSS-TOI
                                           WSS-VAL-INTE IN WSS-TOI
               ADD 1                   TO WSS-NUM-OPER IN WSS-TOI
               ADD RC4-VAL-SCRE IN SRT TO WSS-VAL-SCRE IN WSS-TOI
               ADD RC4-VAL-REAJ IN SRT TO WSS-VAL-REAJ IN WSS-TOI
               ADD RC4-VAL-INTE IN SRT TO WSS-VAL-INTE IN WSS-TOI
               IF RC4-IND-TCLA IN SRT = '1'
                   MOVE 'A'                  TO WSS-IND-TCLA IN WSS-TOI
                   MOVE WSS-GLO1 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
               ELSE
               IF RC4-IND-TCLA IN SRT = '2'
                   MOVE 'B'                  TO WSS-IND-TCLA IN WSS-TOI
                   MOVE WSS-GLO2 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
               ELSE
               IF RC4-IND-TCLA IN SRT = '3'
                   MOVE 'B-'                 TO WSS-IND-TCLA IN WSS-TOI
                   MOVE WSS-GLO3 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
               ELSE
               IF RC4-IND-TCLA IN SRT = '4'
                   MOVE 'C'                  TO WSS-IND-TCLA IN WSS-TOI
                   MOVE WSS-GLO4 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
               ELSE
               IF RC4-IND-TCLA IN SRT = '5'
                   MOVE 'D'                  TO WSS-IND-TCLA IN WSS-TOI
                   MOVE WSS-GLO5 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
               ELSE
                   MOVE 'X'                  TO WSS-IND-TCLA IN WSS-TOI
                   MOVE WSS-GLO6 IN WSS-VARI TO WSS-GLS-TCLA IN WSS-TOI
           ELSE
               ADD 1                   TO WSS-NUM-OPER IN WSS-TOI
               ADD RC4-VAL-SCRE IN SRT TO WSS-VAL-SCRE IN WSS-TOI
               ADD RC4-VAL-REAJ IN SRT TO WSS-VAL-REAJ IN WSS-TOI
               ADD RC4-VAL-INTE IN SRT TO WSS-VAL-INTE IN WSS-TOI.
      *>>>>
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
           IF WSS-IND-TOFI IN WSS-VARI = 'S'
               MOVE WSS-COD-OFIC IN WSS-VARI TO SRT-COD-OFOC IN SRT
               GENERATE DL-TOI.
      *>>>>
           TERMINATE RPT-DOI.
      *<<<< FIN_TMT
           IF WSS-IND-TOFI IN WSS-VARI = 'S'
               TERMINATE RPT-TOI
               CLOSE RPTTOI.
      *>>>>
           CLOSE RPTDOI.
       EXT-OUT-SRT.
           EXIT.
       COPY COLBFRC4.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF
      ******************************************************************
      * Valida que la Oficina del parametro Exista
       VAL-PAR-OFOC SECTION.
       INI-VAL-PAR-OFOC.
           IF WSS-IND-OFOC IN WSS-VARI(WSS-I) > SPACES
               MOVE WSS-IND-OFOC IN WSS-VARI(WSS-I) TO
                                                    OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS IN MSG > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                           ' OFICINA : ' WSS-IND-OFOC IN WSS-VARI(WSS-I)
                   MOVE SPACES TO WSS-IND-OFOC IN WSS-VARI(WSS-I).
           ADD 1 TO WSS-I IN WSS-VARI.
       FIN-VAL-PAR-OFOC.
           EXIT.
      ******************************************************************
      * Seleccion del Registro para Proceso Mediante Fecha y Oficina del
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

      * Valida que pertenezca a Oficina del parametro
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*' AND
              WSS-COD-OFOC IN WSS-VARI NOT = 'N'
               MOVE 1 TO WSS-I IN WSS-VARI
               PERFORM VAL-SEL-OFOC UNTIL WSS-I IN WSS-VARI > 10 OR
                                   WSS-IND-OFOC IN WSS-VARI(WSS-I) =
                                                RC4-COD-OFOC IN RC4
               IF WSS-I IN WSS-VARI > 10
                   GO TO FIN-SEL-REG-PRO.

           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      ******************************************************************
      * Valida que pertenezca a Oficina del parametro
       VAL-SEL-OFOC SECTION.
       INI-VAL-SEL-OFOC.
           ADD 1 TO WSS-I IN WSS-VARI.
       FIN-VAL-SEL-OFOC.
           EXIT.
      ******************************************************************
      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro
       BUS-REG-CLI SECTION.
       INI-BUS-REG-CLI.
      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en R
      * RDC-NUM-IDLC = 0 ====> DEU.DIR.
           MOVE  0                  TO WSS-IND-NEXT IN WSS-VARI.
           MOVE RC4-CIC-IOPC IN RC4 TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RDC-KEY-IDLC IN RDC
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               GO TO FIN-BUS-REG-CLI.

      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-NUM-ICLI IN DBC
                              DBC-VRF-ICLI IN DBC
                              DBC-IND-ICLI IN DBC
                              WSS-GLS-AUXI IN WSS-DOI
                              DBC-GLS-ICLI IN DBC
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
               IF DBC-GLS-ICLI IN DBC > SPACES
                   MOVE '-'    TO WSS-GLS-AUXI IN WSS-DOI
               ELSE
                   MOVE SPACES TO WSS-GLS-AUXI IN WSS-DOI.
       FIN-BUS-REG-CLI.
           EXIT.
      ******************************************************************

       COPY TABBFOFI.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY SGCBGCLI.
      *>>>>
