       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGACS.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    29-MAY-1992  ( Ultima Modificacion ).
      *DAD ini  15-APR-1991
      * Elimine parametro del Codigo Operacion y todo el codigo asociado
      *DAD fin  15-APR-1991

      * Programa Generador de Archivo CRS.

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
      *DAD ini  28-NOV-1991
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
      *DAD fin  28-NOV-1991
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *RVM-CST-INI 26-NOV-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
      *RVM-CST-FIN 26-NOV-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY GNSBRCIC.
       COPY TABBRCAM.
       COPY TABBROFI.
       COPY COLBRTOC.
       COPY COLBROPC.
       COPY COLBRCAN.
       COPY COLBRRCE.
       COPY COLBRICG.
       COPY COLBRVEN.
       COPY COLBRRCV.
       COPY COLBRCYA.
       COPY COLBRDLC.
       COPY COLBRCRS.
       COPY COLBRRDC.
       COPY COLBREVC.
      *DAD ini  28-NOV-1991
       COPY COLBRROV.
       COPY COLWGECA.
      *DAD fin  28-NOV-1991
      *DAD ini  14-ABR-1992   (Memo.09-12-91 Pto.2)
       COPY COLWGEOP.
      *DAD fin  14-ABR-1992
       COPY COLWGMUF.
       COPY COLWGVEN.
       COPY GNSWGPES.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY GNSWGCVI.
       COPY SGCBRDBC.
      *RVM-CST-INI 26-NOV-1996
       COPY SGCBRDCP.
       COPY SGCBRDCE.
      *RVM-CST-FIN 26-NOV-1996
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWVIDD.
       COPY GNSWGBCD.
       COPY GNSWGCIC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.

       01  WSS-VARI.
           03  WSS-KEY-SAFE.
               05  WSS-COD-TOPC      VALUE SPACES PIC X(01).
               05  WSS-ICA-IOPC      VALUE ZEROS  PIC 9(08).
               05  WSS-NUM-IDLC      VALUE ZEROS  PIC 9(03).
           03  WSS-IND-FUTU          VALUE SPACES PIC X(01).
           03  WSS-NUM-IDLC          VALUE ZEROS  PIC 9(03).
           03  WSS-COD-OFIC          VALUE SPACES PIC X(03).
           03  WSS-GLS-DAT3.
               05 FILLER                          PIC X(12).
               05 WSS-IND-TCRE       VALUE SPACES PIC X(02).
               05 FILLER                          PIC X(16).
           03  WSS-KEY-IEVC          VALUE SPACES PIC X(15).
           03  WSS-FEC-FPVC.
               05  WSS-NUM-SPVC      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-APVC      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-MPVC      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-DPVC      VALUE ZEROS  PIC 9(02).
           03  WSS-FEC-FIMV.
               05  WSS-NUM-SIMV      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-AIMV      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-MIMV      VALUE ZEROS  PIC 9(02).
               05  WSS-NUM-DIMV      VALUE ZEROS  PIC 9(02).
           03 WSS-COD-PESO           VALUE SPACES PIC X(06).
           03 WSS-COD-UFES           VALUE SPACES PIC X(06).
           03 WSS-FEC-FINI.
              05 WSS-NUM-DINI        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MINI        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-SINI        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AINI        VALUE ZEROS  PIC 9(02).
           03 WSS-FEC-FTER.
              05 WSS-NUM-DTER        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MTER        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-STER        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-ATER        VALUE ZEROS  PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AFEC        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MFEC        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-DFEC        VALUE ZEROS  PIC 9(02).
           03 WSS-FEC-FFET.
              05 WSS-NUM-SFET        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AFET        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MFET        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-DFET        VALUE ZEROS  PIC 9(02).
           03 WSS-IND-COPR           VALUE SPACES PIC X(01).
           03 WSS-IND-VALI           VALUE SPACES PIC X(01).
           03 WSS-IND-PROC           VALUE ZEROS  PIC 9(01).
           03 WSS-IND-STAT           VALUE ZEROS  PIC 9(01).
           03 WSS-CIC-IOPC.
              05 WSS-CAI-IOPC        VALUE SPACES PIC X(04).
              05 WSS-IIC-IOPC        VALUE SPACES PIC X(08).
           03 WSS-CAI-ICIC           VALUE SPACES PIC X(04).
           03 WSS-NUM-IVAC           VALUE ZEROS  PIC 9(03).
           03 WSS-NUM-IVCT           VALUE ZEROS  PIC 9(03).
           03 WSS-IND-ROPC           VALUE ZEROS  PIC 9(05).
           03 WSS-IND-RCAN           VALUE ZEROS  PIC 9(05).
           03 WSS-IND-RPRO           VALUE ZEROS  PIC 9(05).
           03 WSS-IND-RBAD           VALUE ZEROS  PIC 9(05).
           03 WSS-IND-RPUT           VALUE ZEROS  PIC 9(05).
           03 WSS-IND-RUPD           VALUE ZEROS  PIC 9(05).
           03 WSS-IND-RDEL           VALUE ZEROS  PIC 9(05).
           03 WSS-IND-RERR           VALUE ZEROS  PIC 9(05).
           03 WSS-I                  VALUE ZEROS  PIC 9(02).
           03 WSS-AUX          COMP  VALUE ZEROS  PIC 9(02).
           03 WSS-AUX-DLIM.
              05  WSS-AUX-DLI1       VALUE SPACES PIC X(01).
              05  WSS-AUX-DLI2       VALUE SPACES PIC X(01).
           03 WSS-RCV-CIC-IOPV       VALUE SPACES PIC X(12).
           03 WSS-RCV-NUM-IVCT       VALUE ZEROS  PIC 9(03).
           03 WSS-CRS-SELE           VALUE ZEROS  PIC 9(09).
           03 WSS-CRS-ACTU           VALUE ZEROS  PIC 9(09).
           03 WSS-CRS-INGR           VALUE ZEROS  PIC 9(09).
           03 WSS-CRS-RECH           VALUE ZEROS  PIC 9(09).
           03 WSS-OPC-LEID           VALUE ZEROS  PIC 9(09).
           03 WSS-OPC-SELE           VALUE ZEROS  PIC 9(09).
           03 WSS-OPC-SELE-ACT       VALUE ZEROS  PIC 9(09).
           03 WSS-OPC-SELE-DDD       VALUE ZEROS  PIC 9(09).
           03 WSS-OPC-ACTU           VALUE ZEROS  PIC 9(09).
           03 WSS-OPC-RECH           VALUE ZEROS  PIC 9(09).
           03 WSS-CAN-LEID           VALUE ZEROS  PIC 9(09).
           03 WSS-CAN-SELE           VALUE ZEROS  PIC 9(09).
           03 WSS-CAN-SELE-ELI       VALUE ZEROS  PIC 9(09).
           03 WSS-CAN-ELIM           VALUE ZEROS  PIC 9(09).
           03 WSS-CAN-RECH           VALUE ZEROS  PIC 9(09).
           03 WSS-VEN-LEID           VALUE ZEROS  PIC 9(09).
           03 WSS-VEN-SELE           VALUE ZEROS  PIC 9(09).
           03 WSS-VEN-ACTU           VALUE ZEROS  PIC 9(09).
           03 WSS-VEN-RECH           VALUE ZEROS  PIC 9(09).
           03 WSS-DLC-LEID           VALUE ZEROS  PIC 9(09).
           03 WSS-DLC-SELE           VALUE ZEROS  PIC 9(09).
      *RVM-CST-INI 26-NOV-1996
           03 WSS-Y                  VALUE ZEROS  PIC 9(02).
           03 WSS-COD-TBAN           VALUE SPACES PIC X(03).
           03 WSS-GLS-DATA.
              05 WSS-COD-DAT3    OCCURS 20        PIC X(03).
      *RVM-CST-FIN 26-NOV-1996

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPGACS' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM OPEN-FILE.
           PERFORM PARAM-CRS.
           PERFORM LUP-REG-CRS.
           PERFORM CLOSE-FILE.
       FIN-MAIN.
       COPY GNSBGGBK.

       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-RDC.
           PERFORM SGC-FIO-DBC.
      *RVM-CST-INI 26-NOV-1996
           PERFORM SGC-FIO-DCP.
           PERFORM SGC-FIO-DCE.
      *RVM-CST-FIN 26-NOV-1996
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-CRS.
      *DAD ini  28-NOV-1991
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-ROV.
      *DAD fin  28-NOV-1991
       FIN-OPEN-FILE.
           EXIT.

       PARAM-CRS SECTION.
      *-----------------
       INI-PARAM-CRS.
      * Rutina para Capturar y Validar Parametros de Rango de Fechas
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *Captura Oficina del credito
           DISPLAY 'OFICINA                       : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992

      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992
           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AFEC IN WSS-VARI.
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DFET IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MFET IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-SFET IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-AFET IN WSS-VARI.

           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY MSG-GLS-MENS
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
                   PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992
       NO-VAL-FEC.
           MOVE 'TAB'    TO FIO-SIST.
           MOVE 'VLR'    TO TAB-CIC-TTAB.
           MOVE '0999  ' TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992
           MOVE TAB-COD-CTAB TO WSS-COD-PESO IN WSS-VARI.

           MOVE 'TAB'    TO FIO-SIST.
           MOVE 'VLR'    TO TAB-CIC-TTAB.
           MOVE '0998  ' TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992
            MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UFES IN WSS-VARI.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
       FIN-PARAM-CRS.
           EXIT.

       CLOSE-FILE SECTION.
      *------------------
       INI-CLOSE-FILE.
           DISPLAY '      ESTADISTICAS DE PROCESO'.
           DISPLAY '      ======================='.
           DISPLAY ' '.
           DISPLAY 'OPC LEIDOS          : ' WSS-OPC-LEID.
           DISPLAY 'OPC SELEC.REF.SAFE  : ' WSS-OPC-SELE.
           DISPLAY 'OPC SELEC.MARCA CCT : ' WSS-OPC-SELE-ACT.
           DISPLAY 'OPC MARCADOS        : ' WSS-OPC-ACTU.
           DISPLAY 'OPC SELEC.=DDD      : ' WSS-OPC-SELE-DDD.
           DISPLAY 'OPC RECHAZADOS      : ' WSS-OPC-RECH.
           DISPLAY 'CAN LEIDOS          : ' WSS-CAN-LEID.
           DISPLAY 'CAN SELECCIONADOS   : ' WSS-CAN-SELE.
           DISPLAY 'CAN SELEC.ELIMI CCT : ' WSS-CAN-SELE-ELI.
           DISPLAY 'CAN ELIMINADOS      : ' WSS-CAN-ELIM.
           DISPLAY 'CAN RECHAZADOS      : ' WSS-CAN-RECH.
           DISPLAY 'VEN LEIDOS          : ' WSS-VEN-LEID.
           DISPLAY 'VEN SELECCIONADOS   : ' WSS-VEN-SELE.
           DISPLAY 'VEN ACTUALIZADOS    : ' WSS-VEN-ACTU.
           DISPLAY 'VEN RECHAZADOS      : ' WSS-VEN-RECH.
           DISPLAY 'CRS SELECCIONADOS   : ' WSS-CRS-SELE.
           DISPLAY 'CRS ACTUALIZADOS    : ' WSS-CRS-ACTU.
           DISPLAY 'CRS INGRESADOS      : ' WSS-CRS-INGR.
           DISPLAY 'CRS RECHAZADOS      : ' WSS-CRS-RECH.
           DISPLAY 'DLC LEIDOS          : ' WSS-DLC-LEID.
           DISPLAY 'DLC SELECCIONADOS   : ' WSS-DLC-SELE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-RCE.
           PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-RDC.
           PERFORM SGC-FIO-DBC.
      *RVM-CST-INI 26-NOV-1996
           PERFORM SGC-FIO-DCP.
           PERFORM SGC-FIO-DCE.
      *RVM-CST-FIN 26-NOV-1996
           PERFORM COL-FIO-CRS.
      *DAD ini  28-NOV-1991
           PERFORM COL-FIO-ROV.
      *DAD fin  28-NOV-1991
       FIN-CLOSE-FILE.
           EXIT.
      ******************************************************************
      ******************************************************************
       LUP-REG-CRS SECTION.
      *-------------------
       INI-LUP-OPC-CRS.
      * Programacion de Ciclo para Registro OPC
           MOVE WSS-FEC-FFEC IN WSS-VARI TO OPC-FEC-FINP IN OPC.
           MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FINP IN OPC > WSS-FEC-FFET IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS OPC ENTRE : '
                       WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
               GO TO INI-LUP-CAN-CRS.
           MOVE 1 TO WSS-IND-PROC IN WSS-VARI.
       LUP-OPC-CRS.
           ADD 1 TO WSS-OPC-LEID IN WSS-VARI.
      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           IF OPC-MSC-STAT IN OPC = 'G' OR 'H'
               IF ( WSS-COD-OFIC IN WSS-VARI > SPACES  ) AND
                  ( WSS-COD-OFIC IN WSS-VARI NOT = '*' ) AND
                  ( WSS-COD-OFIC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC )
                     GO TO NXT-LUP-OPC-CRS
               ELSE
                   ADD 1 TO WSS-OPC-SELE-ACT IN WSS-VARI
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   IF NOT FIO-STAT-OKS
                       DISPLAY 'ERROR AL LEER UPDATE OPC : '
                                         OPC-KEY-IOPC IN OPC
                       ADD 1 TO WSS-OPC-RECH IN WSS-VARI
                       GO TO NXT-LUP-OPC-CRS
                   ELSE
                       MOVE 'X' TO OPC-MSC-STAT IN OPC
                       MOVE FIO-MOD TO FIO-CMND
                       PERFORM COL-FIO-OPC
                       IF NOT FIO-STAT-OKS
                           DISPLAY 'ERROR AL REGRABAR OPC : '
                                          OPC-KEY-IOPC IN OPC
                           ADD 1 TO WSS-OPC-RECH IN WSS-VARI
                           PERFORM BCK-OUT
                           GO TO NXT-LUP-OPC-CRS
                       ELSE
                           ADD 1 TO WSS-OPC-ACTU IN WSS-VARI
                           PERFORM CHK-PNT
                           GO TO NXT-LUP-OPC-CRS.

           PERFORM SEL-REG-PROC.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-OPC-CRS.

           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF MSC-CIC-CMSC IN MSC = 'D'
               ADD 1 TO WSS-OPC-SELE-DDD IN WSS-VARI
               PERFORM PRO-DLC
               GO TO NXT-LUP-OPC-CRS.

           PERFORM BUS-ENT-ANEX.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-OPC-CRS.

           IF ( VEN-IND-CALC IN VEN = 'N' ) OR
              ( VEN-VAL-SFIN IN VEN NOT > ZEROS )
               GO TO NXT-LUP-OPC-CRS.

           PERFORM LEE-REG-SAFE.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-OPC-CRS.
           ADD 1 TO WSS-OPC-SELE IN WSS-VARI.
           IF FIO-STAT-OKS
               PERFORM VAL-REG-CRS
               IF WSS-IND-VALI IN WSS-VARI = 'S'
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND
                   PERFORM COL-FIO-CRS
                   PERFORM INI-REG-CRS
                   PERFORM LLE-REG-CRS
                   ADD 1 TO WSS-CRS-SELE IN WSS-VARI
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-CRS
                   IF FIO-STAT-OKS
                       ADD 1 TO WSS-CRS-ACTU IN WSS-VARI
                   ELSE
                       ADD 1 TO WSS-CRS-RECH IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM INI-REG-CRS
               PERFORM LLE-REG-CRS
               ADD 1 TO WSS-CRS-SELE IN WSS-VARI
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-CRS
               IF FIO-STAT-OKS
                   ADD 1 TO WSS-CRS-INGR IN WSS-VARI
               ELSE
                   ADD 1 TO WSS-CRS-RECH IN WSS-VARI.
       NXT-LUP-OPC-CRS.
           MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FINP IN OPC > WSS-FEC-FFET IN WSS-VARI
               GO TO INI-LUP-CAN-CRS.
           GO TO LUP-OPC-CRS.
      *-----------------------------------------------------------------
       INI-LUP-CAN-CRS.
      * Programacion de Ciclo para Registro CAN
           MOVE WSS-FEC-FFEC IN WSS-VARI TO CAN-FEC-FOUT IN CAN.
           MOVE 'CAN-FEC-FOUT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS OR
              CAN-FEC-FOUT IN CAN > WSS-FEC-FFET IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS CAN ENTRE : '
                       WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
               GO TO INI-LUP-PGS-CRS.
       LUP-CAN-CRS.
           ADD 1 TO WSS-CAN-LEID IN WSS-VARI.
      * Proceso de Seleccion y Clasificacion a Partir del Registro CAN
      *DAD ini  14-ABR-1992   (Memo.09-12-91 Pto.2)
           IF CAN-MSC-STAT IN CAN NOT = 'A' AND
              CAN-MSC-STAT IN CAN NOT = 'R'
      *DAD fin  14-ABR-1992
               MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF ( NOT FIO-STAT-OKS ) OR
                  ((WSS-COD-OFIC IN WSS-VARI > SPACES  ) AND
                   (WSS-COD-OFIC IN WSS-VARI NOT = '*' ) AND
                   (WSS-COD-OFIC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC))
                     GO TO NXT-LUP-CAN-CRS
               ELSE
                   ADD 1 TO WSS-CAN-SELE-ELI IN WSS-VARI
      *DAD ini  14-ABR-1992   (Memo.09-12-91 Pto.2)
                   DISPLAY 'SE BORRARA CAN : ' CAN-KEY-ICAN IN CAN
                           ' CON STATUS : ' CAN-MSC-STAT IN CAN
      *DAD fin  14-ABR-1992
                   PERFORM BORRA-ENT-ANEX
                   IF WSS-IND-STAT IN WSS-VARI = 1
                       ADD 1 TO WSS-CAN-RECH IN WSS-VARI
                       PERFORM BCK-OUT
                       GO TO NXT-LUP-CAN-CRS
                   ELSE
                       MOVE FIO-GET-KEY-UPD TO FIO-CMND
                       PERFORM COL-FIO-CAN
                       IF NOT FIO-STAT-OKS
                           DISPLAY 'ERROR AL LEER UPDATE CAN : '
                                         CAN-KEY-ICAN IN CAN
                           ADD 1 TO WSS-CAN-RECH IN WSS-VARI
                           PERFORM BCK-OUT
                           GO TO NXT-LUP-CAN-CRS
                       ELSE
      *                    MOVE 'X' TO CAN-MSC-STAT IN CAN
      *                    MOVE FIO-MOD TO FIO-CMND
                           MOVE FIO-DEL TO FIO-CMND
                           PERFORM COL-FIO-CAN
                           IF NOT FIO-STAT-OKS
                               DISPLAY 'ERROR AL ELIMINAR CAN : '
                                          CAN-KEY-ICAN IN CAN
                               ADD 1 TO WSS-CAN-RECH IN WSS-VARI
                               PERFORM BCK-OUT
                               GO TO NXT-LUP-CAN-CRS
                           ELSE
                               ADD 1 TO WSS-CAN-ELIM IN WSS-VARI
                               PERFORM CHK-PNT
                               IF RCV-MSC-STAT IN RCV = 'F' OR 'C'
                                   PERFORM ELI-CRS
                                   GO TO NXT-LUP-CAN-CRS
                               ELSE
                                   GO TO CON-LUP-CAN-CRS.

           IF CAN-MSC-STAT IN CAN NOT = 'A'
               GO TO NXT-LUP-CAN-CRS.

           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC.
           PERFORM BUS-REG-OPC.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-CAN-CRS.
       CON-LUP-CAN-CRS.
           PERFORM SEL-REG-PROC.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-CAN-CRS.
           PERFORM BUS-ENT-ANEX.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-CAN-CRS.

           IF ( VEN-IND-CALC IN VEN = 'N' ) OR
              ( VEN-VAL-SFIN IN VEN NOT > ZEROS )
               GO TO NXT-LUP-CAN-CRS.

           PERFORM LEE-REG-SAFE.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-CAN-CRS.
           ADD 1 TO WSS-CAN-SELE IN WSS-VARI.
           IF FIO-STAT-OKS
               PERFORM VAL-REG-CRS
               IF WSS-IND-VALI IN WSS-VARI = 'S'
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND
                   PERFORM COL-FIO-CRS
                   PERFORM INI-REG-CRS
                   PERFORM LLE-REG-CRS
                   ADD 1 TO WSS-CRS-SELE IN WSS-VARI
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-CRS
                   IF FIO-STAT-OKS
                       ADD 1 TO WSS-CRS-ACTU IN WSS-VARI
                   ELSE
                       ADD 1 TO WSS-CRS-RECH IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM INI-REG-CRS
               PERFORM LLE-REG-CRS
               ADD 1 TO WSS-CRS-SELE IN WSS-VARI
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-CRS
               IF FIO-STAT-OKS
                   ADD 1 TO WSS-CRS-ACTU IN WSS-VARI
               ELSE
                   ADD 1 TO WSS-CRS-RECH IN WSS-VARI.
       NXT-LUP-CAN-CRS.
           MOVE 'CAN-FEC-FOUT' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS OR
              CAN-FEC-FOUT IN CAN > WSS-FEC-FFET IN WSS-VARI
               GO TO INI-LUP-PGS-CRS.
           GO TO LUP-CAN-CRS.
      *-----------------------------------------------------------------
       INI-LUP-PGS-CRS.
           MOVE 'PGS' TO VEN-IND-SCTB IN VEN.
           MOVE 'VEN-IND-SCTB' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
       LUP-PGS-CRS.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-VEN-LEID IN WSS-VARI.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-IND-SCTB IN VEN = 'PGS' )
               GO TO FIN-LUP-REG-CRS.

           MOVE ADR-VEN-REQA TO ADR-AUX-REQA.
           MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC.

           PERFORM BUS-REG-OPC.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-PGS-CRS.

           PERFORM SEL-REG-PROC.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-PGS-CRS.

           PERFORM BUS-ENT-ANEX.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-PGS-CRS.

           IF ( VEN-IND-CALC IN VEN = 'N' ) OR
              ( VEN-VAL-SFIN IN VEN NOT > ZEROS )
                 GO TO NXT-LUP-PGS-CRS.

           PERFORM LEE-REG-SAFE.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-LUP-PGS-CRS.
           ADD 1 TO WSS-VEN-SELE IN WSS-VARI.
           IF FIO-STAT-OKS
               PERFORM VAL-REG-CRS
               IF WSS-IND-VALI IN WSS-VARI = 'S'
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND
                   PERFORM COL-FIO-CRS
                   PERFORM INI-REG-CRS
                   PERFORM LLE-REG-CRS
                   ADD 1 TO WSS-CRS-SELE IN WSS-VARI
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-CRS
                   IF FIO-STAT-OKS
                       ADD 1 TO WSS-CRS-ACTU IN WSS-VARI
                       PERFORM ACT-REG-VEN
                   ELSE
                       ADD 1 TO WSS-CRS-RECH IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM INI-REG-CRS
               PERFORM LLE-REG-CRS
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-CRS
               IF FIO-STAT-OKS
                   ADD 1 TO WSS-CRS-INGR IN WSS-VARI
                   PERFORM ACT-REG-VEN
               ELSE
                   ADD 1 TO WSS-CRS-RECH IN WSS-VARI.
       NXT-LUP-PGS-CRS.
           MOVE ADR-AUX-REQA   TO ADR-VEN-REQA.
           MOVE FIO-KDEF-S     TO FIO-KDEF.
           MOVE 'VEN-IND-SCTB' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           GO TO LUP-PGS-CRS.
       FIN-LUP-REG-CRS.
           EXIT.
      ******************************************************************
      ******************************************************************
       BUS-REG-OPC SECTION.
       INI-BUS-REG-OPC.
      * Busca Operacion de Credito Mediante una Cancelacion Determinada
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' ' OPC-CIC-IOPC IN OPC
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
       FIN-BUS-REG-OPC.
           EXIT.
      ******************************************************************
       SEL-REG-PROC SECTION.
       INI-SEL-REG-PROC.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.

           IF OPC-MSC-STAT IN OPC NOT = 'A'  OR
              ( OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI AND
                OPC-COD-VCOC IN OPC NOT = WSS-COD-UFES IN WSS-VARI )
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-SEL-REG-PROC.

           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-SEL-REG-PROC.

           IF OPC-COD-TOPC IN OPC > SPACES
               IF OPC-COD-TOPC NOT NUMERIC AND
                  OPC-COD-TOPC IN OPC NOT = 'D'
                   MOVE 1 TO WSS-IND-STAT IN WSS-VARI
                   GO TO FIN-SEL-REG-PROC.

           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFIC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   MOVE 1 TO WSS-IND-STAT IN WSS-VARI.
       FIN-SEL-REG-PROC.
           EXIT.
      ******************************************************************
       BUS-ENT-ANEX SECTION.
       INI-BUS-ENT-ANEX.
           MOVE SPACES TO WSS-IND-FUTU IN WSS-VARI.
           MOVE ZEROES TO WSS-IND-STAT IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE OPC-NUM-IVEN IN OPC TO WSS-NUM-IVCT IN WSS-VARI
               MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-VEN
           ELSE
               MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
               MOVE ZEROES              TO VEN-NUM-IVEN IN VEN
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF NOT (FIO-STAT-OKS AND
                   OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
                   MOVE 1 TO WSS-IND-STAT IN WSS-VARI
                   GO TO FIN-BUS-ENT-ANEX
               ELSE
                   MOVE VEN-NUM-IVCT IN VEN TO WSS-NUM-IVCT
                                                    IN WSS-VARI.

           PERFORM BUS-REG-ICG.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO FIN-BUS-ENT-ANEX.

           IF ICG-COD-CVTI IN ICG > SPACES
               IF VEN-IND-CALC IN VEN = 'N'
                   MOVE WSS-NUM-IVCT IN WSS-VARI TO WSS-NUM-IVAC
                                                     IN WSS-VARI
                   SUBTRACT 1 FROM WSS-NUM-IVCT IN WSS-VARI GIVING
                                               VEN-NUM-IVEN IN VEN
                   IF OPC-IND-VSTR IN OPC NOT = 'S'
                       MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
                       MOVE OPC-IIC-IOPC IN OPC TO VEN-IIC-IOPC IN VEN
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM COL-FIO-VEN
                       IF FIO-STAT-OKS
                           MOVE VEN-NUM-IVEN IN VEN TO WSS-NUM-IVCT
                                                        IN WSS-VARI
                           MOVE 'F' TO WSS-IND-FUTU IN WSS-VARI
      *DAD ini  13-SEP-1991
                           GO TO CON-BUS-ENT-ANEX
      *DAD fin  13-SEP-1991
                       ELSE
                           MOVE 1 TO WSS-IND-STAT IN WSS-VARI
                           GO TO FIN-BUS-ENT-ANEX
                   ELSE
                       MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM COL-OBT-VEN
                       IF VEN-STAT-OKS
                           MOVE VEN-NUM-IVCT IN VEN TO WSS-NUM-IVCT
                                                        IN WSS-VARI
                           MOVE 'F' TO WSS-IND-FUTU IN WSS-VARI
      *DAD ini  13-SEP-1991
                           GO TO CON-BUS-ENT-ANEX
      *DAD fin  13-SEP-1991
                       ELSE
                           MOVE 1 TO WSS-IND-STAT IN WSS-VARI
                           GO TO FIN-BUS-ENT-ANEX.

      *DAD ini  13-SEP-1991
           IF OPC-NUM-IVEN IN OPC NOT = VEN-NUM-IVCT IN VEN
               DISPLAY 'EL VEN A REFRESCAR : ' VEN-KEY-IVEN IN VEN
                       ' NO CORRESPONDE AL VENCIMIENTO QUE INDICA LA '
                       'OPERACION : ' OPC-NUM-IVEN IN OPC
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-BUS-ENT-ANEX.
       CON-BUS-ENT-ANEX.
      *DAD fin  13-SEP-1991
           PERFORM BUS-RDC-DBC.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO FIN-BUS-ENT-ANEX.

           PERFORM BUS-REG-VEN.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO FIN-BUS-ENT-ANEX.

           PERFORM BUS-REG-DLC.
       FIN-BUS-ENT-ANEX.
           EXIT.
      *-----------------------------------------------------------------
      * Obtiene Tasa de Interes al Leer ICG mediante Llave KEY-IICG Form
       BUS-REG-ICG SECTION.
       INI-BUS-REG-ICG.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
      * Forma Llave KEY-IICG para Leer ICG y Obtener Tasa de Interes
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               MOVE '23' TO FIO-STAT.
           IF NOT FIO-STAT-OKS
               MOVE    1   TO WSS-IND-STAT IN WSS-VARI
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               GO TO FIN-BUS-REG-ICG.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG.
       FIN-BUS-REG-ICG.
           EXIT.
      *-----------------------------------------------------------------
       BUS-RDC-DBC SECTION.
       INI-BUS-RDC-DBC.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en R
      * RDC-NUM-IDLC = 0 ====> DEU.DIR.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' ' RDC-KEY-IDLC IN RDC
               MOVE SPACES TO DBC-IDC-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC
               MOVE '00' TO FIO-STAT
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-BUS-RDC-DBC.
      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-IDC-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC.
       FIN-BUS-RDC-DBC.
           EXIT.
      *-----------------------------------------------------------------
       BUS-REG-VEN SECTION.
       INI-BUS-REG-VEN.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
           IF OPC-IND-VSTR IN OPC = 'S'
               GO TO BUS-REG-EVC.
      * Busca Operaciones de Creditos Mediante Vencimientos
           MOVE OPC-CIC-IOPC IN OPC      TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVCT IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPCORCVVENNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' ' VEN-KEY-IVEN IN VEN
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI.
           GO TO FIN-BUS-REG-VEN.
       BUS-REG-EVC.
           MOVE OPC-CIC-IOPC IN OPC      TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVCT IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-OBT-VEN.
           IF NOT VEN-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPCORCVVENNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' ' VEN-KEY-IVEN IN VEN
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI.
       FIN-BUS-REG-VEN.
           EXIT.
      *-----------------------------------------------------------------
       BUS-REG-DLC SECTION.
       INI-BUS-REG-DLC.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' ' DLC-KEY-IDLC IN DLC
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI.
       FIN-BUS-REG-DLC.
           EXIT.
      ******************************************************************
       PRO-DLC SECTION.
       INI-PRO-DLC.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE OPC-NUM-IVEN IN OPC TO WSS-NUM-IVCT IN WSS-VARI
           ELSE
               MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
               MOVE ZEROES              TO VEN-NUM-IVEN IN VEN
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF NOT ( FIO-STAT-OKS AND
                        OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
                   MOVE 1 TO WSS-IND-STAT IN WSS-VARI
                   GO TO FIN-PRO-DLC
               ELSE
                   MOVE VEN-NUM-IVCT IN VEN TO WSS-NUM-IVCT IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-DLC.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC )
               GO TO FIN-PRO-DLC.
           ADD 1 TO WSS-DLC-LEID IN WSS-VARI.
           MOVE ADR-DLC-REQA TO ADR-AUX-REQA.
           PERFORM BUS-ICG-DLC.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-PRO-DLC.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG.

           PERFORM BUS-RDC-DLC.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-PRO-DLC.

           PERFORM BUS-VEN-DLC.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-PRO-DLC.

           PERFORM LEE-REG-SAFE.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-PRO-DLC.
           ADD 1 TO WSS-DLC-SELE IN WSS-VARI.
           IF FIO-STAT-OKS
               PERFORM VAL-REG-CRS
               IF WSS-IND-VALI IN WSS-VARI = 'S'
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND
                   PERFORM COL-FIO-CRS
                   PERFORM INI-REG-CRS
                   PERFORM LLE-REG-CRS
                   ADD 1 TO WSS-CRS-SELE IN WSS-VARI
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-CRS
                   IF FIO-STAT-OKS
                       ADD 1 TO WSS-CRS-ACTU IN WSS-VARI
                   ELSE
                       ADD 1 TO WSS-CRS-RECH IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM INI-REG-CRS
               PERFORM LLE-REG-CRS
               ADD 1 TO WSS-CRS-SELE IN WSS-VARI
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-CRS
               IF FIO-STAT-OKS
                   ADD 1 TO WSS-CRS-INGR IN WSS-VARI
               ELSE
                   ADD 1 TO WSS-CRS-RECH IN WSS-VARI.
       NXT-PRO-DLC.
           MOVE ADR-AUX-REQA TO ADR-DLC-REQA.
           MOVE FIO-KDEF-S   TO FIO-KDEF.
           MOVE FIO-GET-NXT  TO FIO-CMND.
           GO TO LUP-PRO-DLC.
       FIN-PRO-DLC.
           EXIT.
      *-----------------------------------------------------------------
       BUS-ICG-DLC SECTION.
       INI-BUS-ICG-DLC.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS     TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
              ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
              ICG-CIC-IOPV IN ICG = SPACES              AND
              ICG-NUM-IVCT IN ICG = ZEROES              AND
              ICG-IND-TTAS IN ICG = 'INT'
               GO TO FIN-BUS-ICG-DLC.

           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS     TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
              ICG-NUM-ICAN IN ICG = ZEROES              AND
              ICG-CIC-IOPV IN ICG = SPACES              AND
              ICG-NUM-IVCT IN ICG = ZEROES              AND
              ICG-IND-TTAS IN ICG = 'INT'
               GO TO FIN-BUS-ICG-DLC.
           MOVE 1 TO WSS-IND-STAT IN WSS-VARI.
           MOVE SPACES TO ICG.
       FIN-BUS-ICG-DLC.
           EXIT.
      *-----------------------------------------------------------------
       BUS-RDC-DLC SECTION.
       INI-BUS-RDC-DLC.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
           MOVE DLC-CIC-IOPC IN DLC TO RDC-CIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' ' RDC-KEY-IDLC IN RDC
               MOVE SPACES TO DBC-IDC-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC
               MOVE '00' TO FIO-STAT
               GO TO FIN-BUS-RDC-DLC.
      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-IDC-ICLI IN DBC
               MOVE SPACES TO DBC-VRF-ICLI IN DBC.
       FIN-BUS-RDC-DLC.
           EXIT.
      *-----------------------------------------------------------------
       BUS-VEN-DLC SECTION.
       INI-BUS-VEN-DLC.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
           IF OPC-IND-VSTR IN OPC = 'S'
               GO TO CON-EVC.
           MOVE DLC-CIC-IOPC IN DLC      TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVCT IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       NXT-BUS-VEN-DLC.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CIC-IOPC IN DLC = VEN-CIC-IOPC IN VEN )
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-BUS-VEN-DLC.
           IF VEN-NUM-IDLC IN VEN NOT = DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO NXT-BUS-VEN-DLC.
           GO TO FIN-BUS-VEN-DLC.
       CON-EVC.
           MOVE DLC-CIC-IOPC IN DLC      TO VEN-CIC-IOPC IN VEN.
           MOVE WSS-NUM-IVCT IN WSS-VARI TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       NXT-BUS-VEN-EVC-DLC.
           PERFORM COL-OBT-VEN.
           IF NOT ( VEN-STAT-OKS AND
                    DLC-CIC-IOPC IN DLC = VEN-CIC-IOPC IN VEN )
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-BUS-VEN-DLC.
           IF VEN-NUM-IDLC IN VEN NOT = DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO NXT-BUS-VEN-EVC-DLC.
       FIN-BUS-VEN-DLC.
           EXIT.
      ******************************************************************
       BORRA-ENT-ANEX SECTION.
       INI-BORRA-ENT-ANEX.
      *DAD ini  28-NOV-1991   (Razon Similar (Memo.05-11-91 Pto.8) x CST
           MOVE 1 TO ECA-ECAN     IN ECA-VARI.
           MOVE 0 TO WSS-IND-STAT IN WSS-VARI.
           PERFORM COL-ELI-CAN.
           IF ECA-CMSG IN ECA-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE ECA-CMSG IN ECA-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ': ' ECA-MEN2 IN ECA-VARI
      *DAD ini  14-ABR-1992   (Memo.09-12-91 Pto.2)
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-BORRA-ENT-ANEX.
           IF ECA-VOPC IN ECA-VARI > SPACES
               MOVE 0 TO ECA-INDI IN ECA-VARI
                         EOP-EOPE IN EOP-VARI
               PERFORM BORRA-ENT-ANEX-OPC.
      *DAD fin  14-ABR-1992 / 28-NOV-1991
       FIN-BORRA-ENT-ANEX.
           EXIT.
      ******************************************************************
      *DAD ini  14-ABR-1992   (Memo.09-12-91 Pto.2)
       BORRA-ENT-ANEX-OPC SECTION.
       INI-BORRA-ENT-ANEX-OPC.
           ADD 1 TO ECA-INDI IN ECA-VARI.
           IF ECA-IOPC IN ECA-VARI(ECA-INDI) NOT > SPACES
               GO TO FIN-BORRA-ENT-ANEX-OPC.
           MOVE ECA-IOPC IN ECA-VARI(ECA-INDI) TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES                         TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES                         TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF FIO-STAT-OKS AND
              ROV-CIC-IOPC IN ROV = ECA-IOPC IN ECA-VARI(ECA-INDI)
      * Existe otra CAN que esta asociada a una misma OPC, pues existe R
               GO TO FIN-BORRA-ENT-ANEX-OPC.

           MOVE ECA-IOPC IN ECA-VARI(ECA-INDI) TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
      *         DISPLAY 'NO EXISTE OPC, ASOCIADA A LA CAN, RELACIONADA '
      *                 'POR LA ROV / KEY : ' CAN-KEY-ICAN IN CAN
      *                 ' CON STATUS : '      CAN-MSC-STAT IN CAN
      *         MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-BORRA-ENT-ANEX-OPC.

           IF FIO-STAT-OKS AND
              OPC-MSC-STAT IN OPC = 'A'
               DISPLAY 'NO SE BORRO OPC, POR ESTAR ACTIVADA Y CON LA '
                       'CAN EN ESTADO DE ESPERA / KEY : '
                        CAN-KEY-ICAN IN CAN ' STAT : '
                        CAN-MSC-STAT IN CAN
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-BORRA-ENT-ANEX-OPC.

           PERFORM COL-ELI-OPC.
           IF EOP-CMSG IN EOP-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE EOP-CMSG IN EOP-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ': ' EOP-MEN2 IN EOP-VARI
               MOVE 1 TO WSS-IND-STAT IN WSS-VARI
               GO TO FIN-BORRA-ENT-ANEX-OPC.

           DISPLAY 'BORRADA OPC : ' OPC-CIC-IOPC IN OPC
                   ' CON STATUS : ' OPC-MSC-STAT IN OPC
                   ' ASOCIADA A CAN : ' CAN-KEY-ICAN IN CAN.
           GO TO INI-BORRA-ENT-ANEX-OPC.
       FIN-BORRA-ENT-ANEX-OPC.
           EXIT.
      *DAD fin  14-ABR-1992
      ******************************************************************
      *ESTE PARRAFO ES PARA ELIMINAR CRS, POR EJEMPLO, CUANDO LA CANCELA
      *QUE HA QUEDADO EN ESPERA TIENE UN VALOR ESTIMADO
       ELI-CRS SECTION.
       INI-ELI-CRS.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE 0                   TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CIC-IOPC IN DLC = OPC-CIC-IOPC IN OPC )
               GO TO FIN-ELI-CRS.
           PERFORM LEE-REG-SAFE.
           IF ( WSS-IND-STAT IN WSS-VARI NOT = 1 ) AND ( FIO-STAT-OKS )
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CRS
               IF FIO-STAT-OKS
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM COL-FIO-CRS.
       FIN-ELI-CRS.
           EXIT.
     *******************************************************************
       ACT-REG-VEN SECTION.
       INI-ACT-REG-VEN.
           MOVE ADR-AUX-REQA    TO ADR-VEN-REQA.
           MOVE FIO-KDEF-S      TO FIO-KDEF.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE EN VEN : ' VEN-KEY-IVEN IN VEN
               ADD 1 TO WSS-VEN-RECH IN WSS-VARI
               GO TO FIN-ACT-REG-VEN.
      *DAD ini  11-JUN-1993   (Memo.25-05-93)
      *     MOVE SPACES TO VEN-IND-SCTB IN VEN.
           MOVE VEN-IND-CTBA IN VEN TO VEN-IND-SCTB IN VEN.
           MOVE SPACES              TO VEN-IND-CTBA IN VEN.
      *DAD fin  11-JUN-1993
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ACTUALIZAR VEN : ' VEN-KEY-IVEN IN VEN
               ADD 1 TO WSS-VEN-RECH IN WSS-VARI
           ELSE
               ADD 1 TO WSS-VEN-ACTU IN WSS-VARI.
       FIN-ACT-REG-VEN.
           EXIT.
      ******************************************************************
       LEE-REG-SAFE SECTION.
       INI-LEE-REG-SAFE.
           MOVE ZEROS TO WSS-IND-STAT IN WSS-VARI.
           IF OPC-MSC-TTRN IN OPC NOT = 'C'
               MOVE DLC-KEY-IDLC IN DLC TO BCD-DAT6-EBCD IN BCD-VARI
           ELSE
               MOVE DLC-CIC-IOPC IN DLC TO RCE-CIC-IOPC IN RCE
               MOVE DLC-NUM-IDLC IN DLC TO RCE-NUM-IDLC IN RCE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RCE
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE ENTIDAD RCE PARA : '
                           DLC-CIC-IOPC IN DLC
                   MOVE 1 TO WSS-IND-STAT IN WSS-VARI
                   GO TO FIN-LEE-REG-SAFE
               ELSE
                   MOVE RCE-KEY-SAFE IN RCE TO BCD-DAT6-EBCD
                                                          IN BCD-VARI.
           MOVE BCD-DAT6-EBCD IN BCD-VARI TO BCD-DAT6-INT IN BCD-VARI.
           MOVE BCD-DAT6      IN BCD-VARI TO CRS-KEY-ICRS IN CRS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CRS.
       FIN-LEE-REG-SAFE.
           EXIT.
      *-----------------------------------------------------------------
       VAL-REG-CRS SECTION.
       INI-VAL-REG-CRS.
      *DAD ini  13-SEP-1991
      *     MOVE 'N' TO WSS-IND-VALI IN WSS-VARI.
      *     IF ( CRS-IND-ACTU IN CRS = '00' OR
      *          CRS-IND-ACTU IN CRS = '01' OR
      *          CRS-IND-ACTU IN CRS = '03' OR
      *          CRS-IND-ACTU IN CRS = '04' ) AND
      *        ( CRS-IND-PNEG IN CRS = '00' OR
      *          CRS-IND-PNEG IN CRS = '01' OR
      *          CRS-IND-PNEG IN CRS = '03' OR
      *          CRS-IND-PNEG IN CRS = '04' )
      *DAD fin  13-SEP-1991
               MOVE 'S' TO WSS-IND-VALI IN WSS-VARI.
       FIN-VAL-REG-CRS.
           EXIT.
      *-----------------------------------------------------------------
       INI-REG-CRS SECTION.
       INI-INI-REG-CRS.
           MOVE LOW-VALUES TO CRS-COD-ISAF IN CRS.
           MOVE ZEROES TO WSS-AUX IN WSS-VARI.
           ADD 11 TO WSS-AUX IN WSS-VARI.
           MULTIPLY WSS-AUX IN WSS-VARI BY 16 GIVING
                    WSS-AUX IN WSS-VARI.
           ADD 4 TO WSS-AUX IN WSS-VARI.
           MOVE WSS-AUX IN WSS-VARI TO WSS-AUX-DLIM IN WSS-VARI.
           MOVE WSS-AUX-DLI2 TO CRS-GLS-LREG IN CRS.
           MOVE ZEROES TO WSS-AUX IN WSS-VARI.
           ADD 4 TO WSS-AUX IN WSS-VARI.
           MULTIPLY WSS-AUX IN WSS-VARI BY 16 GIVING
                    WSS-AUX IN WSS-VARI.
           MOVE WSS-AUX IN WSS-VARI  TO WSS-AUX-DLIM IN WSS-VARI.
           MOVE WSS-AUX-DLI2         TO CRS-COD-ARCH IN CRS.
           MOVE LOW-VALUES           TO CRS-GLS-UDJN IN CRS.
           MOVE LOW-VALUES           TO CRS-GLS-TERM IN CRS.
           MOVE LOW-VALUES           TO CRS-COD-EST1 IN CRS.
           MOVE LOW-VALUES           TO CRS-COD-EST2 IN CRS.
           MOVE LOW-VALUES           TO CRS-COD-MCSL IN CRS.
           MOVE ZEROES               TO CRS-VAL-VCCP IN CRS.
           MOVE ZEROES               TO CRS-VAL-PAGO IN CRS.
           MOVE ZEROES               TO CRS-VAL-PNEG IN CRS.
           MOVE LOW-VALUES           TO CRS-COD-MICR IN CRS.
           MOVE SPACES               TO CRS-COD-OFRC IN CRS.
           MOVE LOW-VALUES           TO CRS-FEC-FCAN IN CRS.
           MOVE ZEROES               TO CRS-NUM-VNEG IN CRS.
           MOVE ZEROES               TO CRS-VAL-VCNC IN CRS.
           MOVE ZEROES               TO CRS-VAL-MNEG IN CRS.
           MOVE ZEROES               TO CRS-VAL-GNEG IN CRS.
           MOVE ZEROES               TO CRS-VAL-MORA IN CRS.
           MOVE SPACES               TO CRS-MSC-CANC IN CRS.
           MOVE '00'                 TO CRS-IND-ACTU IN CRS.
           MOVE '00'                 TO CRS-IND-PNEG IN CRS.
           MOVE ZEROES               TO BCD-DAT3-INT IN BCD-VARI.
           MOVE BCD-DAT3 IN BCD-VARI TO CRS-DMA-FUTS IN CRS.
           MOVE ZEROES               TO CRS-DMA-FVCN IN CRS.
       FIN-INI-REG-CRS.
           EXIT.
      *-----------------------------------------------------------------
       LLE-REG-CRS SECTION.
       INI-LLE-REG-CRS.
           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE VEN-VAL-SFIN IN VEN TO CRS-VAL-VENP IN CRS
           ELSE
      *DAD ini  31-OCT-1991
           IF OPC-COD-VCOC IN OPC = WSS-COD-UFES IN WSS-VARI
               MOVE VEN-VAL-SFIN IN VEN TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-VENO IN CRS
           ELSE
               MOVE VEN-VAL-SFIN IN VEN TO CRS-VAL-VENO IN CRS.

           IF OPC-COD-VCOC IN OPC = WSS-COD-UFES IN WSS-VARI
               MOVE VEN-VAL-SCAP IN VEN TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-SCAP IN CRS
           ELSE
               MOVE VEN-VAL-SCAP IN VEN TO CRS-VAL-SCAP IN CRS.

           IF OPC-COD-VCOC IN OPC = WSS-COD-UFES IN WSS-VARI
               MOVE DLC-VAL-SDLC IN DLC TO MUF-SGV-VAUF IN MUF-VARI
               PERFORM MUL-VAUF
               MOVE MUF-SGV-VAUF IN MUF-VARI TO CRS-VAL-SDLC IN CRS
           ELSE
               MOVE DLC-VAL-SDLC IN DLC TO CRS-VAL-SDLC IN CRS.
      *DAD fin  31-OCT-1991

           MOVE VEN-NUM-IVEN IN VEN TO CRS-NUM-IVEN IN CRS.
           MOVE VEN-NUM-AVEN IN VEN TO CRS-NUM-AVEN IN CRS.
           MOVE VEN-NUM-MVEN IN VEN TO CRS-NUM-MVEN IN CRS.
           MOVE VEN-NUM-DVEN IN VEN TO CRS-NUM-DVEN IN CRS.
           MOVE VEN-NUM-AIMV IN VEN TO CRS-NUM-AIMV IN CRS.
           MOVE VEN-NUM-MIMV IN VEN TO CRS-NUM-MIMV IN CRS.
           MOVE VEN-NUM-DIMV IN VEN TO CRS-NUM-DIMV IN CRS.
           MOVE OPC-COD-OFOC IN OPC TO CRS-COD-OFOC IN CRS.

           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE '01' TO CRS-COD-MONS IN CRS
           ELSE
               MOVE '98' TO CRS-COD-MONS IN CRS.

           MOVE OPC-COD-COOC IN OPC TO CRS-COD-AUXI IN CRS.
           IF OPC-COD-COOC IN OPC > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DAT3 TO WSS-GLS-DAT3 IN WSS-VARI
               MOVE WSS-IND-TCRE IN WSS-VARI TO CRS-IND-TCRE IN CRS
           ELSE
               MOVE SPACES TO CRS-IND-TCRE IN CRS.

           MOVE OPC-NUM-ACOL IN OPC TO CRS-NUM-ACOL IN CRS.
           MOVE OPC-NUM-MCOL IN OPC TO CRS-NUM-MCOL IN CRS.
           MOVE OPC-NUM-DCOL IN OPC TO CRS-NUM-DCOL IN CRS.
           MOVE ICG-SGV-TINT IN ICG TO CRS-VAL-TASA IN CRS.
           MOVE DBC-IDC-ICLI IN DBC TO CRS-IDC-IDEU IN CRS.
           MOVE DBC-VRF-ICLI IN DBC TO CRS-VRF-IDEU IN CRS.
      *RVM-CST-INI 26-NOV-1996
           MOVE SPACES              TO CRS-IND-CCOM IN CRS.

      * NO DEBE MODIF. CUANDO SEA BOLETA DE GARANTIA O DOC. DESCONTADO
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF MSC-CIC-CMSC IN MSC = 'D' OR 'B'
               GO TO NO-IND-CRS.

           IF DBC-IND-TICL IN DBC = 'P'
               MOVE DBC-KEY-IDBC IN DBC TO DCP-KEY-IDCP IN DCP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCP
               IF NOT FIO-STAT-OKS
                   NEXT SENTENCE
               ELSE
                   MOVE DCP-COD-TBAN IN DCP TO
                        WSS-COD-TBAN IN WSS-VARI
                   PERFORM BUS-TBL-CCB
           ELSE
           IF DBC-IND-TICL IN DBC = 'E'
               MOVE DBC-KEY-IDBC IN DBC TO DCE-KEY-IDCE IN DCE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCE
               IF NOT FIO-STAT-OKS
                   NEXT SENTENCE
               ELSE
                   MOVE DCE-COD-TBAN IN DCE TO
                        WSS-COD-TBAN IN WSS-VARI
                   PERFORM BUS-TBL-CCB.

       NO-IND-CRS.
      *RVM-CST-FIN 26-NOV-1996
           MOVE OPC-CIC-IOPC IN OPC TO CRS-KEY-IOPC IN CRS.
           MOVE '2'                 TO CRS-IND-TSIS IN CRS.
           IF OPC-COD-TOPC IN OPC > SPACES
               IF OPC-COD-TOPC NOT NUMERIC
                   MOVE '1' TO CRS-IND-TSIS IN CRS.
      * Busca Plazo de Documento Legal de Operacion de Credito con VEN-N
           IF DLC-COD-PLZO IN DLC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PZO'               TO TAB-COD-TTAB IN TAB
               MOVE DLC-COD-PLZO IN DLC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-COD-DAT1(1) TO CRS-IND-PLZO IN CRS
           ELSE
               MOVE SPACES TO CRS-IND-PLZO IN CRS.

           IF WSS-IND-FUTU IN WSS-VARI = 'F'
               MOVE '01'                     TO CRS-IND-ACTU IN CRS
               MOVE '04'                     TO CRS-IND-PNEG IN CRS
               MOVE WSS-NUM-IVAC IN WSS-VARI TO CRS-NUM-IVEN IN CRS.
       FIN-LLE-REG-CRS.
           EXIT.
      ******************************************************************
      *RVM-CST-INI 26-NOV-1996
       BUS-TBL-CCB SECTION.
       INI-BUS-TBL-CCB.
           MOVE 'COL'  TO FIO-SIST.
           MOVE 'CCB'  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-BUS-TBL-CCB.

           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.

           MOVE 1 TO WSS-Y.

       LUP-BUS-TBL-CCB.
           IF WSS-COD-DAT3 IN WSS-VARI(WSS-Y) = WSS-COD-TBAN IN WSS-VARI
               MOVE 'S' TO CRS-IND-CCOM IN CRS
               GO TO FIN-BUS-TBL-CCB.

           ADD 1 TO WSS-Y.
           IF WSS-Y > 20
               GO TO FIN-BUS-TBL-CCB.

           GO TO LUP-BUS-TBL-CCB.
       FIN-BUS-TBL-CCB.
           EXIT.
      *RVM-CST-FIN 26-NOV-1996

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'BACK-OUT ERRONEO'.
       FIN-BCK-OUT.
           EXIT.
      *-----------------------------------------------------------------
       CHK-PNT SECTION.
       INI-CHK-PNT.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CHECK-PNT ERRONEO'.
       FIN-CHK-PNT.
           EXIT.
      ******************************************************************

       COPY TABBFCAM.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY COLBFTOC.
       COPY COLBFOPC.
       COPY COLBFCAN.
       COPY COLBFRCE.
       COPY COLBFICG.
       COPY COLBFVEN.
       COPY COLBFRCV.
       COPY COLBFCYA.
       COPY COLBFDLC.
       COPY COLIOCRS.
       COPY COLBFRDC.
       COPY COLBFEVC.
       COPY SGCBFDBC.
      *RVM-CST-INI 26-NOV-1996
       COPY SGCBFDCP.
       COPY SGCBFDCE.
      *RVM-CST-FIN 26-NOV-1996
       COPY GNSBFCIC.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
       COPY GNSBGABT.
      *DAD fin  29-MAY-1992
       COPY GNSBGCIC.
       COPY SGCBGCLI.
       COPY GNSBGPES.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY COLBGVEN.
       COPY COLBGMUF.
      *DAD ini  28-NOV-1991
       COPY COLBFROV.
       COPY COLBGECA.
      *DAD fin  28-NOV-1991
      *DAD ini  14-ABR-1992   (Memo.09-12-91 Pto.2)
       COPY COLBGEOP.
      *DAD fin  14-ABR-1992
       COPY TABBVOFI.
       COPY TABBBOFI.
       COPY TABBFOFI.
