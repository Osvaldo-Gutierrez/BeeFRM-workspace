       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLPYG.
       AUTHOR.          BEE-TEAM (DPM).
       DATE-WRITTEN.    14-Nov-97 03:48 PM.

      * Programa Listador de Reporte PYG con Sort.
      *
      * V 1.1.2
      *
      *<<<< CMT_ID
      *>>>>

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            C01 IS SALTO
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTPYG         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTPYG         ASSIGN TO        UT-S-RPTPYG.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT RPTPYG         ASSIGN TO        UT-S-RPTPYG.
      *<<<< IOS
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY COLRRPYG.
      *<<<< RR
      *>>>>
       FD  RPTPYG LABEL RECORDS OMITTED
           RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-PYG     PIC X(132).
      *<<<< FD_RPT
      *>>>>
      *<<<< FLS
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PYG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY COLBRPYG.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWPYG.
      *<<<< RW
      *>>>>
       COPY COLRNPYG.
      *<<<< RN
      *>>>>
       COPY COLROPYG.
      *<<<< RO
      *>>>>
       COPY GNSWGSYS.
       01  PGM-HRSR-PYG   VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-PYG  VALUE 'S'.

       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY GNSWGCPT.
       COPY GNSWGHOY.

       COPY SGCBRDBC.
       COPY TABBRCAM.
       COPY TABBROFI.
       COPY GARBRGDD.
       COPY GARBRGDG.
       COPY GARBRTAG.
       COPY GARBRGVT.

       01  WSS-VARI.
           03  WSS-IND-FLAG        VALUE SPACES      PIC X(01).
           03  WSS-COD-PESO        VALUE SPACES      PIC X(06).
           03  WSS-VAL-SCRE        VALUE ZEROES      PIC 9(11).
           03  WSS-VAL-AJT-SUP     VALUE ZEROES      PIC 9(11).
           03  WSS-IND-DISP        VALUE SPACES      PIC X(01).
           03  WSS-CIC-ICLI        VALUE SPACES      PIC X(12).

      * Variables para estadisticas
           03  WSS-NUM-RLEI        VALUE ZEROES      PIC 9(06).
           03  WSS-NUM-RRCH        VALUE ZEROES      PIC 9(06).
           03  WSS-NUM-RSEL        VALUE ZEROES      PIC 9(06).
           03  WSS-NUM-RNSE        VALUE ZEROES      PIC 9(06).
           03  WSS-NUM-RLIS        VALUE ZEROES      PIC 9(06).
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
      *>>>>

      * AQUI EXISTIA LABEL RF INI
      *<<<< RF
      *>>>>
      * AQUI EXISTIA LABEL RF FIN
       COPY COLRTPYG.
      *<<<< RT
      *>>>>

       PROCEDURE DIVISION.
      *==================

      * AQUI EXISTIA LABEL FIN_DEC INI
      *<<<< FIN_DEC
      *>>>>
      * AQUI EXISTIA LABEL FIN_DEC FIN

       MAIN SECTION.
      *------------
       INI-MAIN.
      *<<<< MAX_FILE
      *>>>>
      *    MOVE SYS-MXFL TO SYS-CMND.
      *    PERFORM GNS-PRO-SYS.
       COPY GNSBGEDB.
      *    MOVE 'COL' TO RPT-SIST.
           MOVE 'COLPLPYG' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
      *>>>>
           SORT GNSSRT
       COPY COLRSPYG.
      *<<<< RS
      *>>>>
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
      *<<<< FIN
      *>>>>
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP
      * Captura de Parametros
           DISPLAY 'INICIO CAPTURA DE PARAMETROS.'.
           DISPLAY ' '.
           DISPLAY 'CAPTURA INDICADOR DE DISPLAY (S/N): '.
           ACCEPT WSS-IND-DISP IN WSS-VARI.
           DISPLAY WSS-IND-DISP IN WSS-VARI.

           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO WSS-NUM-DPRO IN WSS-PYG.
           MOVE HOY-MHOY TO WSS-NUM-MPRO IN WSS-PYG.
           MOVE HOY-SHOY TO WSS-NUM-SPRO IN WSS-PYG.
           MOVE HOY-AHOY TO WSS-NUM-APRO IN WSS-PYG.

      * Validacion de Parametros
           IF WSS-IND-DISP IN WSS-VARI NOT = 'S' AND
              WSS-IND-DISP IN WSS-VARI NOT = 'N'
               DISPLAY 'ASUME INDICADOR DE DISPLAY N'.
      *>>>>
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-PYG.
       FST-INP-SRT.
      *<<<< INI_FST_INP
      * Apertura de archivos
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GVT.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-TAG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GDD.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

      * Obtiene codigo valor de cambio de pesos mediante CIC de la moned
           MOVE 'TAB'               TO FIO-SIST.
           MOVE 'VLR'               TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '            TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'           TO MSG-COD-SIST FIO-SIST
               MOVE 'CIC0999  NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC  TAB-CIC-CTAB
               PERFORM GNS-PRO-END.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-PYG.
      *<<<< FIN_FST_INP
      *>>>>
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           MOVE ZEROES TO WSS-VAL-AJT-SUP IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY ' '
               DISPLAY 'PYG-IOPC LEIDO: ' PYG-CIC-IOPC IN PYG
               DISPLAY 'PYG-ICLI LEIDO: ' PYG-CIC-ICLI IN PYG.

           ADD 1 TO WSS-NUM-RLEI IN WSS-VARI.

           IF PYG-CIC-ICLI IN PYG = WSS-CIC-ICLI IN WSS-VARI
               GO TO MOV-INP-SRT.

           MOVE PYG-CIC-ICLI IN PYG TO WSS-CIC-ICLI IN WSS-VARI.

           PERFORM OBT-NOMBRE-ICLI.
           IF WSS-IND-FLAG IN WSS-VARI = 1
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
               MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
               MOVE SPACES TO WSS-CIC-ICLI IN WSS-VARI
               GO TO NXT-INP-SRT.

           MOVE PYG-CIC-ICLI IN PYG TO GDD-CIC-ICLI IN GDD.
           MOVE SPACES              TO GAR-CLV-GDD-2 IN GDD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GDD.

       LUP-GDD-INP-SRT.
           IF NOT ( FIO-STAT-OKS AND
              PYG-CIC-ICLI IN PYG = GDD-CIC-ICLI IN GDD )
               DISPLAY 'ERROR LECTURA GARGDD: '
                              PYG-CIC-ICLI IN PYG
      *         ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
      *         MOVE SPACES TO WSS-CIC-ICLI IN WSS-VARI
               MOVE ZEROES TO SRT-VAL-AJT-SUP IN SRT
               GO TO MOV-INP-SRT.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY ' '
               DISPLAY 'GDD LEIDO: ' GAR-CLV-GDD-1 IN GDD.

           MOVE GAR-ID IN GDD TO GAR-CLV-GDG-1 IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR LECTURA GARGDG: '
                              GAR-ID IN GDD
               GO TO NXT-GDD-INP-SRT.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'GDG LEIDO: ' GAR-CLV-GDG-1 IN GDG.

      * Se deben procesar solo las garantias completas y no alzadas
           IF NOT ( GAR-IND-CPL IN GDG = 'S' AND
              GAR-ES1 IN GDG > '09' AND
              GAR-ES1 IN GDG < '20' )
               GO TO NXT-GDD-INP-SRT.

           MOVE GAR-CLA-OPE IN GDG TO GAR-CLV-TAG-1 IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR LECTURA GARTAG: '
                              GAR-CLA-OPE IN GDG
               GO TO NXT-GDD-INP-SRT.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'TAG LEIDO: ' GAR-CLV-TAG-1 IN TAG.

           IF GAR-TIP-REA-NRE IN TAG NOT = 'R'
               DISPLAY 'GARANTIA NO REAL: '
                      GAR-CLV-GDG-1 IN GDG ' '
                      GAR-CLV-TAG-1 IN TAG
               GO TO NXT-GDD-INP-SRT.

           MOVE GAR-ID IN GDD TO GAR-ID IN GVT.
           MOVE ZEROES TO GAR-COD-TSN IN GVT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           IF NOT ( FIO-STAT-OKS AND
              GAR-ID IN GDD = GAR-ID IN GVT )
               DISPLAY 'ERROR LECTURA GARGVT: '
                              GAR-ID IN GDD
               GO TO NXT-GDD-INP-SRT.

           IF GAR-VCB IN GDG NOT = WSS-COD-PESO IN WSS-VARI
               PERFORM CONVERTIR-A-PESOS-GARA
               IF WSS-IND-FLAG IN WSS-VARI = 1
                   MOVE 0 TO WSS-IND-FLAG IN WSS-VARI
                   GO TO NXT-GDD-INP-SRT
               ELSE
                   NEXT SENTENCE
           ELSE
               ADD GAR-VAL-AJT-SUP IN GVT TO
                                     WSS-VAL-AJT-SUP IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'GVT LEIDO: ' GAR-CLV-GVT-1 IN GVT
               DISPLAY 'MONTO GVT: ' GAR-VAL-AJT-SUP IN GVT
               DISPLAY 'MONEDA GAR: ' GAR-VCB IN GDG
               DISPLAY 'MONTO GVT ACUMULADO: '
                                  WSS-VAL-AJT-SUP IN WSS-VARI.

       NXT-GDD-INP-SRT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF ( FIO-STAT-OKS AND
              PYG-CIC-ICLI IN PYG = GDD-CIC-ICLI IN GDD )
               GO TO LUP-GDD-INP-SRT.

           MOVE WSS-VAL-AJT-SUP IN WSS-VARI TO SRT-VAL-AJT-SUP IN SRT.
      *>>>>
       MOV-INP-SRT.
       COPY COLRMPYG.
      *<<<< RM
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'REG. SELECCIONADO'.

           ADD 1 TO WSS-NUM-RSEL IN WSS-VARI.
      *>>>>
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-PYG.
      *<<<< FIN_NXT_INP
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *<<<< FIN_INP
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-PYG.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
      *<<<< INI_OUT
      *>>>>
           OPEN OUTPUT RPTPYG.
      *     MOVE 'COLPLPYG' TO RPT-NPGM.
           PERFORM CAL-HDR.
           PERFORM INITIATE-RPTPYG.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           MOVE SRT TO SRT-OLD-PYG.
           MOVE SRT TO SRT-CUR-PYG.
      *<<<< FST_OUT
           MOVE 'OFICINA :' TO WSS-GLS-TITU IN WSS-PYG.
      *>>>>
      *    PERFORM PYG-FST-PRO-CTL.
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           ADD 1 TO WSS-NUM-RLIS IN WSS-VARI.

      *Obtiene glosa de oficina
           IF DBC-COD-OFIC IN SRT > SPACES
               MOVE DBC-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-PYG
           ELSE
               MOVE SPACES TO WSS-GLS-OFIC IN WSS-PYG.
      *>>>>
       GEN-OUT-SRT.
           PERFORM GENERATE-DL-PYG.
      *<<<< FIN_GEN_OUT
      *>>>>
       NXT-OUT-SRT.
           MOVE SRT TO SRT-OLD-PYG.
       RET-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
           DISPLAY 'ESTADISTICAS.'.
           DISPLAY '-------------'.
           DISPLAY ' '.
           DISPLAY 'REGISTROS PYG LEIDOS       : '
                              WSS-NUM-RLEI IN WSS-VARI.
           DISPLAY 'REGISTROS PYG RECHAZADOS   : '
                              WSS-NUM-RRCH IN WSS-VARI.
           DISPLAY 'REGISTROS SELECCIONADOS    : '
                              WSS-NUM-RSEL IN WSS-VARI.
           DISPLAY 'REGISTROS NO SELECCIONADOS : '
                              WSS-NUM-RNSE IN WSS-VARI.
           DISPLAY 'REGISTROS LISTADOS         : '
                              WSS-NUM-RLIS IN WSS-VARI.

           IF HAY-REGISTROS-EN-SORT-PYG
                MOVE SPACES TO WSS-GLS-TITU IN WSS-PYG
                               DBC-COD-OFIC IN SRT
                               WSS-GLS-OFIC IN WSS-PYG
                PERFORM TERMINATE-RPTPYG.

           CLOSE RPTPYG.
           GO TO EXT-OUT-SRT.
      *>>>>
           IF HAY-REGISTROS-EN-SORT-PYG
                PERFORM TERMINATE-RPTPYG.
      *<<<< FIN_TMT
      *>>>>
           CLOSE RPTPYG.
       EXT-OUT-SRT.
           EXIT.
       COPY COLBFPYG.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGIRH.
       COPY COLREPYG.
      *    14-NOV-97 03:45 PM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
       D-CF-PYG-DBC-GLS-NOMC SECTION.
       INI-CF-PYG-DBC-GLS-NOMC.
      *<<<< CF_PYG_DBC_GLS_NOMC
           MOVE SRT-VAL-AJT-SUP IN SRT TO WSS-VAL-AJT-SUP IN WSS-PYG.

           IF WSS-VAL-AJT-SUP IN WSS-PYG > SUM-VAL-SCLI IN WSS-SUM-PYG
               MOVE ZEROES TO WSS-VAL-PCLI IN WSS-PYG
           ELSE
               SUBTRACT WSS-VAL-AJT-SUP IN WSS-PYG FROM
                        SUM-VAL-SCLI IN WSS-SUM-PYG GIVING
                        WSS-VAL-PCLI IN WSS-PYG.
      *>>>>
       FIN-CF-PYG-DBC-GLS-NOMC.
           EXIT.
       D-CH-PYG-DBC-GLS-NOMC SECTION.
       INI-CH-PYG-DBC-GLS-NOMC.
      *<<<< CH_PYG_DBC_GLS_NOMC
      *>>>>
       FIN-CH-PYG-DBC-GLS-NOMC.
           EXIT.
       D-CF-PYG-DBC-COD-OFIC SECTION.
       INI-CF-PYG-DBC-COD-OFIC.
      *<<<< CF_PYG_DBC_COD_OFIC
      *>>>>
       FIN-CF-PYG-DBC-COD-OFIC.
           EXIT.
       D-PH-PYG SECTION.
       INI-PH-PYG.
      *<<<< PH_PYG
      *>>>>
       FIN-PH-PYG.
           EXIT.
       D-FF-PYG SECTION.
       INI-FF-PYG.
      *<<<< FF_PYG
      *>>>>
       FIN-FF-PYG.
           EXIT.
       D-DL-PYG SECTION.
       INI-DL-PYG.
      *<<<< DL_PYG
      *>>>>
       FIN-DL-PYG.
           EXIT.
       COPY GNSBGABT.

      *<<<< EOF
       COPY GNSBGCPT.
       COPY GNSBGHOY.
       COPY GNSBBMSG.

       COPY SGCBFDBC.
       COPY GARBFGDD.
       COPY GARBFGDG.
       COPY GARBFTAG.
       COPY GARBFGVT.
       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBBOFI.

      ******************************************************************
       OBT-NOMBRE-ICLI SECTION.
      *--------------------
       INI-OBT-NOMBRE-ICLI.
           MOVE PYG-CIC-ICLI IN PYG TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               DISPLAY 'ERROR LECTURA SGCDBC: '
                       DBC-CIC-ICLI IN DBC ' ' FIO-STAT
               GO TO FIN-OBT-NOMBRE-ICLI.

            MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
            PERFORM CPT-BLKS.
            MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
       FIN-OBT-NOMBRE-ICLI.
           EXIT.

      ******************************************************************
       CONVERTIR-A-PESOS-GARA SECTION.
      *------------------------------
       INI-CONVERTIR-A-PESOS-GARA.
           MOVE GAR-FEC-RVL IN GVT       TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE GAR-VCB IN GDG           TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR LECTURA TABCAM: '
                                         CAM-KEY-CAMB IN CAM
               MOVE 1 TO WSS-IND-FLAG IN WSS-VARI
               GO TO FIN-CONVERTIR-A-PESOS-GARA.

           COMPUTE WSS-VAL-AJT-SUP IN WSS-VARI ROUNDED =
                                        WSS-VAL-AJT-SUP IN WSS-VARI +
                                     ( GAR-VAL-AJT-SUP IN GVT *
                                       CAM-SGV-VCAM IN CAM ).
       FIN-CONVERTIR-A-PESOS-GARA.
           EXIT.
      *>>>>
