       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPLCVC.
       AUTHOR.          BEE (VLB). - NNV.
       DATE-WRITTEN.    10-OCT-97 05:39 PM.- 24-ABRIL-98

      * PROGRAMA LISTADOR DE REPORTE CVC
      *

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            C01 IS SALTO
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
           SELECT RPTCVC         ASSIGN TO        UT-S-RPTCVC.
           SELECT COLISC         ASSIGN TO COLISC
                                 FILE STATUS IS STAT-ISC.
           SELECT COLSCD         ASSIGN TO COLSCD
                                 FILE STATUS IS STAT-SCD.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       FD  RPTCVC LABEL RECORDS OMITTED
           RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-CVC     PIC X(132).
       FD  COLISC LABEL RECORD IS STANDARD
           BLOCK CONTAINS 0 RECORDS.
       COPY COLBRISC.
       FD  COLSCD LABEL RECORD IS STANDARD
           BLOCK CONTAINS 0 RECORDS.
       COPY GARBRSCD.

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY COLRRCVC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ISC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY COLRWCVC.
      *<<<< RW
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SCD-REQA==.

       COPY TABBROFI.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
      *ALD-BCI-INI/13.01.1999
       COPY GNSWGFEC.
      *ALD-BCI-FIN/13.01.1999
      *>>>>
       COPY COLRNCVC.
      *<<<< RN
      *>>>>
       COPY COLROCVC.
      *<<<< RO
      *>>>>
       COPY GNSWGSYS.
       01  FILE-STATUS.
           03  STAT-ISC   PIC 9(02)  VALUE 0.
           03  STAT-SCD   PIC 9(02)  VALUE 0.
           03  END-ISC    PIC 9(01)  VALUE 0.
               88 EOF-ISC            VALUE 1.
           03  END-SCD    PIC 9(01)  VALUE 0.
               88 EOF-SCD            VALUE 1.
       01  CLAVES-ORDEN.
           03  ISC-CLA.
               05 ISC-CL1            PIC X(3)  VALUE SPACES.
               05 ISC-CL2            PIC X(12) VALUE SPACES.
           03  SCD-CLA.
               05 SCD-CL1            PIC X(3)  VALUE SPACES.
               05 SCD-CL2            PIC X(12) VALUE SPACES.
           03  ISC-CLAV              PIC X(15) VALUE SPACES.
           03  SCD-CLAV              PIC X(15) VALUE SPACES.
       01  PGM-HRSR-CVC   VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-CVC  VALUE 'S'.

       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       01  WSS-VARI.
      *ALD-BCI-INI/13.01.1999
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO              PIC 9(02).
              05 WSS-NUM-MPRO              PIC 9(02).
              05 WSS-NUM-SPRO              PIC 9(02).
              05 WSS-NUM-APRO              PIC 9(02).
      *ALD-BCI-FIN/13.01.1999
           03 WSS-ISC-LEID   VALUE ZEROES  PIC 9(06).
           03 WSS-SCD-LEID   VALUE ZEROES  PIC 9(06).
           03 WSS-REG-PAR    VALUE ZEROES  PIC 9(06).
           03 WSS-CTA-ISC    VALUE ZEROES  PIC 9(06).
           03 WSS-OPCION     VALUE SPACES  PIC X(01).
           03 WSS-OFOC-AUX   VALUE SPACES  PIC X(03).
           03 WSS-OFOC-AUX1  VALUE SPACES  PIC X(03).
           03 WSS-OFOC-AUX2  VALUE SPACES  PIC X(03).
           03 WSS-CTA-AUX    VALUE SPACES  PIC X(09).
           03 WSS-CTA-AUX1   VALUE SPACES  PIC X(09).
           03 WSS-DIF        VALUE ZEROES  PIC S9(14).
           03 WSS-VALOR-SCD.
              05 WSS-VAL-SALD             PIC 9(13).
              05 WSS-IND-SIGN             PIC X(01).
           03 WSS-IND-IMPR  VALUE 'N'     PIC X(01).
           03 WSS-GLS-DATA.
              05 WSS-GLS-TIO              PIC X(40).
              05 WSS-GLS-AUX              PIC X(40).

       01  PH-CVC.
           03 PH-CVC-L1.
              05 RT-RPT-DUSU
                 PIC X(30).
              05 FILLER PIC X(10)
              VALUE SPACES.
              05 FILLER
                 PIC X(39)
                 VALUE 'INFORME DE CUADRATURA DIARIA COLOCACION'.
              05 FILLER
                 PIC X(19)
                 VALUE 'ES V/S CONTABILIDAD'.
              05 FILLER PIC X(16)
              VALUE SPACES.
              05 RT-RPT-FDMA
                 PIC 99B99B9999.
           03 PH-CVC-L2.
              05 RT-RPT-DSIS
                 PIC X(30).
              05 FILLER PIC X(26)
              VALUE SPACES.
              05 FILLER
                 PIC X(10)
                 VALUE 'SALDOS AL:'.
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 RT-WSS-NUM-DPRO
                 PIC 9(2).
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 FILLER
                 PIC X(1)
                 VALUE ALL '/'.
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 RT-WSS-NUM-MPRO
                 PIC 9(2).
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 FILLER
                 PIC X(1)
                 VALUE ALL '/'.
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 RT-WSS-NUM-SPRO
                 PIC 9(2).
              05 RT-WSS-NUM-APRO
                 PIC 9(2).
              05 FILLER PIC X(31)
              VALUE SPACES.
              05 FILLER
                 PIC X(6)
                 VALUE 'PAGINA'.
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 RT-RPT-CVC-PAGE-COUNTER
                 PIC ZZZZZ.
           03 PH-CVC-L3.
              05 FILLER PIC X(132)
              VALUE SPACES.
           03 PH-CVC-L4.
              05 FILLER PIC X(116)
              VALUE SPACES.
              05 RT-WSS-GLS-PGM
                 PIC X(8)
              VALUE SPACES.
           03 PH-CVC-L5.
              05 FILLER
                 PIC X(9)
                 VALUE 'OFICINA :'.
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 RT-ISC-COD-OFOC
                 PIC X(3).
              05 FILLER PIC X(3)
              VALUE SPACES.
              05 RT-WSS-GLS-OFIC
                 PIC X(25).
           03 PH-CVC-L6.
              05 FILLER
                 PIC X(132)
                 VALUE ALL '-'.
           03 PH-CVC-L7.
              05 FILLER PIC X(4)
              VALUE SPACES.
              05 FILLER
                 PIC X(39)
                 VALUE 'CUENTA               GLOSA CUENTA      '.
              05 FILLER
                 PIC X(39)
                 VALUE '                           SALDO       '.
              05 FILLER
                 PIC X(39)
                 VALUE '        SALDO                   DIFEREN'.
              05 FILLER
                 PIC X(3)
                 VALUE 'CIA'.
           03 PH-CVC-L8.
              05 FILLER PIC X(3)
              VALUE SPACES.
              05 FILLER
                 PIC X(39)
                 VALUE 'CONTABLE                CONTABLE       '.
              05 FILLER
                 PIC X(39)
                 VALUE '                         COLOCACIONES  '.
              05 FILLER
                 PIC X(18)
                 VALUE '      CONTABILIDAD'.
           03 PH-CVC-L9.
              05 FILLER
                 PIC X(132)
                 VALUE ALL '-'.
       01  CF-CVC-ISC-GLS-CCSB.
           03 CF-CVC-ISC-GLS-CCSB-L1.
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 RT-ISC-GLS-CCSB
                 PIC X(12).
              05 FILLER PIC X(8)
              VALUE SPACES.
              05 RT-WSS-GLS-CCBL
                 PIC X(40).
              05 RT-SUM-TOT-CTA-COL
                 PIC ZZ.ZZZ.ZZZ.ZZZ.ZZ9.
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 RT-SUM-TOT-CTA-CON
                 PIC ----.---.---.---.--9.
              05 FILLER PIC X(4)
              VALUE SPACES.
              05 RT-WSS-TOT-CTA-DIF
                 PIC -----.---.---.---.--9.
           03 CF-CVC-ISC-GLS-CCSB-L2.
              05 FILLER PIC X(132)
              VALUE SPACES.
       01  CF-CVC-ISC-COD-OFOC.
           03 CF-CVC-ISC-COD-OFOC-L1.
              05 FILLER PIC X(17)
              VALUE SPACES.
              05 FILLER
                 PIC X(115)
                 VALUE ALL '-'.
           03 CF-CVC-ISC-COD-OFOC-L2.
              05 FILLER PIC X(22)
              VALUE SPACES.
              05 FILLER
                 PIC X(15)
                 VALUE 'TOTAL OFICINA :'.
              05 FILLER PIC X(24)
              VALUE SPACES.
              05 RT-SUM-VAL-SCOL
                 PIC ZZ.ZZZ.ZZZ.ZZZ.ZZ9.
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 RT-SUM-VAL-SCON
                 PIC ----.---.---.---.--9.
              05 FILLER PIC X(4)
              VALUE SPACES.
              05 RT-SUM-SGV-DIFC
                 PIC -----.---.---.---.--9.

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'COLPLCVC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

      *ALD-BCI-INI/13.01.1999
      *Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      *
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'FECHA PROCESO INVALIDA '
               PERFORM GNS-PRO-ABT.
      *ALD-BCI-FIN/13.01.1999
      *
           ACCEPT WSS-OPCION IN WSS-VARI.
           PERFORM OBT-FECHA.
           PERFORM ABRIR-ARCHIVOS.
           PERFORM PAREO-IMPRESION UNTIL EOF-ISC AND EOF-SCD.
           PERFORM CERRAR-ARCHIVOS.
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       ABRIR-ARCHIVOS SECTION.
       ABRE-LEE-PRIMERO-IMP-TITULO.
           OPEN INPUT COLISC.
           IF STAT-ISC NOT = 0
              DISPLAY 'ERROR APERTURA COLISC : ' STAT-ISC
              PERFORM GNS-PRO-ABT.
           PERFORM LEER-COLISC.
           OPEN INPUT COLSCD.
           IF STAT-SCD NOT = 0
              DISPLAY 'ERROR APERTURA COLSCD : ' STAT-SCD
              PERFORM GNS-PRO-ABT.
           PERFORM LEER-COLSCD.
           OPEN OUTPUT RPTCVC.
           MOVE ISC-COD-OFOC IN ISC TO ISC-CL1.
           MOVE ISC-GLS-CCSB IN ISC TO ISC-CL2.
           MOVE SCD-COD-OFIC IN SCD TO SCD-CL1.
           MOVE SCD-CIC-CCSB IN SCD TO SCD-CL2.
           IF ISC-CLA < SCD-CLA
              MOVE ISC-CLA TO SRT
           ELSE
              MOVE SCD-CLA TO SRT.
           PERFORM CAL-HDR.
           MOVE RPT-PAGE-LIMIT TO RPT-CVC-PAGE-LIMIT.
           MOVE SRT TO SRT-CUR-CVC.
           MOVE SPACES TO SRT-OLD-CVC.

       PAREO-IMPRESION SECTION.
       LOOP-PROCESO.
           MOVE ISC-COD-OFOC IN ISC TO ISC-CL1.
           MOVE ISC-GLS-CCSB IN ISC TO ISC-CL2.
           MOVE SCD-COD-OFIC IN SCD TO SCD-CL1.
           MOVE SCD-CIC-CCSB IN SCD TO SCD-CL2.
           IF ISC-CLA < SCD-CLA
              PERFORM IMPRESION-DE-ISC
           ELSE
              IF ISC-CLA > SCD-CLA
                 PERFORM IMPRESION-DE-SCD
              ELSE
                 PERFORM IMPRESION-DE-ISC-Y-SCD.

       TIPO-IMPRESION SECTION.
       IMPRESION-DE-ISC.
           MOVE ISC-GLS-CCSB IN ISC TO ISC-GLS-CCSB IN SRT.
           MOVE ISC-COD-OFOC IN ISC TO ISC-COD-OFOC IN SRT.
           MOVE ISC-COD-COOC IN ISC TO ISC-COD-COOC IN SRT.
           MOVE ISC-VAL-SCRE IN ISC TO ISC-VAL-SCRE IN SRT.
           MOVE 0                   TO WSS-SGV-SALD IN SRT.
           MOVE SPACES              TO WSS-GLS-CCBL IN SRT.
           PERFORM IMPRIME-LINEA.
           PERFORM LEER-COLISC.
           MOVE ISC-COD-OFOC IN ISC TO ISC-CL1.
           MOVE ISC-GLS-CCSB IN ISC TO ISC-CL2.

       IMPRESION-DE-SCD.
           MOVE SCD-CIC-CCSB IN SCD TO ISC-GLS-CCSB IN SRT.
           MOVE SCD-COD-OFIC IN SCD TO ISC-COD-OFOC IN SRT.
           MOVE 0                   TO ISC-VAL-SCRE IN SRT.
           MOVE SPACES              TO ISC-COD-COOC IN SRT.
           MOVE SCD-SGV-SALD IN SCD TO WSS-VALOR-SCD IN WSS-VARI
           MOVE WSS-VAL-SALD IN WSS-VARI TO WSS-SGV-SALD IN SRT.
           IF WSS-IND-SIGN IN WSS-VARI = '-'
              MOVE SPACES TO WSS-VALOR-SCD IN WSS-VARI
              MULTIPLY WSS-SGV-SALD IN SRT   BY -1
              GIVING WSS-SGV-SALD IN SRT.
           MOVE SCD-GLS-CCSB IN SCD TO WSS-GLS-CCBL IN SRT.
           PERFORM IMPRIME-LINEA.
           PERFORM LEER-COLSCD.
           MOVE SCD-COD-OFIC IN SCD TO SCD-CL1.
           MOVE SCD-CIC-CCSB IN SCD TO SCD-CL2.

       IMPRESION-DE-ISC-Y-SCD.
           ADD 1 TO WSS-REG-PAR IN WSS-VARI.
           MOVE ISC-GLS-CCSB IN ISC TO ISC-GLS-CCSB IN SRT.
           MOVE ISC-COD-OFOC IN ISC TO ISC-COD-OFOC IN SRT.
           MOVE ISC-COD-COOC IN ISC TO ISC-COD-COOC IN SRT.
           MOVE ISC-VAL-SCRE IN ISC TO ISC-VAL-SCRE IN SRT.
           MOVE SCD-SGV-SALD IN SCD TO WSS-VALOR-SCD IN WSS-VARI
           MOVE WSS-VAL-SALD IN WSS-VARI TO WSS-SGV-SALD IN SRT.
           IF WSS-IND-SIGN IN WSS-VARI = '-'
              MOVE SPACES TO WSS-VALOR-SCD IN WSS-VARI
              MULTIPLY WSS-SGV-SALD IN SRT   BY -1
              GIVING WSS-SGV-SALD IN SRT.
           MOVE SCD-GLS-CCSB IN SCD TO WSS-GLS-CCBL IN SRT.
           PERFORM IMPRIME-LINEA.
           PERFORM LEER-COLISC.
           MOVE ISC-COD-OFOC IN ISC TO ISC-CL1.
           MOVE ISC-GLS-CCSB IN ISC TO ISC-CL2.
           PERFORM LEER-COLSCD.
           MOVE SCD-COD-OFIC IN SCD TO SCD-CL1.
           MOVE SCD-CIC-CCSB IN SCD TO SCD-CL2.

       LECTURAS SECTION.
       LEER-COLISC.
           READ COLISC AT END MOVE 1 TO END-ISC.
           IF EOF-ISC
              MOVE 1 TO END-ISC
              MOVE '999' TO ISC-COD-OFOC IN ISC
              MOVE '999999999999' TO ISC-GLS-CCSB IN ISC
           ELSE
              ADD 1 TO WSS-ISC-LEID IN WSS-VARI.
       LEER-COLSCD.
           READ COLSCD AT END MOVE 1 TO END-SCD.
           IF EOF-SCD
              MOVE '999' TO SCD-COD-OFIC IN SCD
              MOVE '999999999999' TO SCD-CIC-CCSB IN SCD
           ELSE
              ADD 1 TO WSS-SCD-LEID IN WSS-VARI.

       IMPRIME-LINEA SECTION.
       DETERMINA-POR-OPCION.
           IF WSS-OPCION IN WSS-VARI = 'S' OR
            ((ISC-VAL-SCRE IN SRT NOT = 0  OR
              WSS-SGV-SALD IN SRT NOT = 0) AND
              ISC-VAL-SCRE IN SRT NOT = WSS-SGV-SALD IN SRT)
              MOVE 'S' TO PGM-HRSR-CVC
           ELSE
              GO TO EXIT-IMPRIME.
       GENERA-LINEA.
      * Obtiene Nombre de Sucursal mediante Bus-Ofi
           IF ISC-COD-OFOC IN SRT NOT = ISC-COD-OFOC-OLD IN SRT-OLD-CVC
           IF ISC-COD-OFOC IN SRT > SPACES
              MOVE ISC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
              PERFORM BUS-OFI
              IF MSG-COD-MENS NOT > SPACES
                 MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-CVC
              ELSE
                 MOVE SPACES TO WSS-GLS-OFIC IN WSS-CVC
           ELSE
              MOVE SPACES TO WSS-GLS-OFIC IN WSS-CVC.

      * Mediante BUS-TAB Busca tipo de Operacion Credito de Tabla TIO
           IF ISC-COD-TOOC IN SRT > SPACES
              MOVE 'TAB'         TO TAB-COD-SIST
              MOVE 'TIO'         TO TAB-COD-TTAB IN TAB
              MOVE ISC-COD-TOOC IN SRT TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TIO IN WSS-VARI
           ELSE
              MOVE SPACES TO WSS-GLS-TIO IN WSS-VARI.
      * Mediante BUS-TAB Busca Clase de Operacion Credito de Tabla AUX
           PERFORM GENERATE-DL-CVC.
           MOVE SRT TO SRT-OLD-CVC.
       EXIT-IMPRIME.
           EXIT.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGIRH.
       WRT-SEC-PH-CVC SECTION.
       I-WRT-SEC-PH-CVC.
           MOVE 'N' TO WSS-CTL-LIN-ESC IN WSS-CTL-CVC
           MOVE PH-CVC-L1 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-RLL-NWP.
           MOVE PH-CVC-L2 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
           MOVE PH-CVC-L3 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
           MOVE PH-CVC-L4 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
           MOVE PH-CVC-L5 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
           MOVE PH-CVC-L6 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
           MOVE PH-CVC-L7 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
           MOVE PH-CVC-L8 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
           MOVE PH-CVC-L9 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
       F-WRT-SEC-PH-CVC.
           EXIT.

       WRT-SEC-CF-CVC-ISC-GLS-CCSB SECTION.
       I-WRT-SEC-CF-CVC-ISC-GLS-CCSB.
           MOVE 'S' TO WSS-CTL-LIN-ESC IN WSS-CTL-CVC
           MOVE CF-CVC-ISC-GLS-CCSB-L1 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
           MOVE CF-CVC-ISC-GLS-CCSB-L2 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
       F-WRT-SEC-CF-CVC-ISC-GLS-CCSB.
           EXIT.

       WRT-SEC-CF-CVC-ISC-COD-OFOC SECTION.
       I-WRT-SEC-CF-CVC-ISC-COD-OFOC.
           MOVE CF-CVC-ISC-COD-OFOC-L1 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
           MOVE CF-CVC-ISC-COD-OFOC-L2 TO GRC-LINEA-CVC.
           PERFORM CVC-WRT-LIN-REP.
041198     MOVE 'S' TO WSS-CVC-SEM-NP IN WSS-SEM-CVC
041198     MOVE 'S' TO WSS-CVC-NO-CABE.
       F-WRT-SEC-CF-CVC-ISC-COD-OFOC.
           EXIT.

       CVC-PRO-RLL-TAM-CF SECTION.
       I-CVC-PRO-RLL-TAM-CF.
           PERFORM CVC-CLR-SEM-NWP.
           PERFORM CVC-CLR-CTL-SIZ.
           PERFORM CVC-SUM-SIZ-CTL-CF.
           PERFORM CVC-CHK-SIZ-DIS.
           PERFORM CVC-SET-SMF-NWP-CF.
           IF WSS-CVC-NO-CABE = 'S'
              PERFORM CVC-WRT-RLL-YPH.
       F-CVC-PRO-RLL-TAM-CF.
           EXIT.

       CVC-WRT-RLL-YPH SECTION.
       I-CVC-WRT-RLL-YPH.
           PERFORM CVC-WRT-PH-SRE.
           PERFORM CVC-CLR-CTL-SIZ.
       F-CVC-WRT-RLL-YPH.
           EXIT.

       CVC-WRT-PH-SRE SECTION.
       I-CVC-WRT-PH-SRE.
           MOVE RPT-CVC-PAGE-LIMIT TO RPT-CVC-TOT-LDIS.
           MOVE  ZEROES TO RPT-CVC-LINE-COUNTER.
           ADD 1 TO RPT-CVC-PAGE-COUNTER IN RPT-VARI-CVC.
           PERFORM M-PH-CVC.
           PERFORM WRT-SEC-PH-CVC.
       F-CVC-WRT-PH-SRE.
           EXIT.

       TERMINATE-RPTCVC SECTION.
       I-TERMINATE-RPTCVC.
           MOVE 'S' TO WSS-CTL-ISC-COD-OFOC IN WSS-CTL-CVC.
           MOVE 'S' TO WSS-CTL-ISC-GLS-CCSB IN WSS-CTL-CVC.
           PERFORM CVC-CLR-CTL-SIZ.
           PERFORM CVC-CLR-SEM-NWP.
           PERFORM CVC-SUM-SIZ-CTL-CF.
           PERFORM CVC-CHK-SIZ-DIS.
           PERFORM CVC-SET-SMF-NWP-CF.
           IF WSS-CVC-NO-CABE = 'S'
           PERFORM CVC-WRT-RLL-YPH.
           PERFORM CVC-PRO-VAR-CTL-CF.
       F-TERMINATE-RPTCVC.
           EXIT.

       CVC-WRT-LIN-REP SECTION.
       I-CVC-WRT-LIN-REP.
           WRITE GRC-LINEA-CVC.
           ADD 1 TO RPT-CVC-LINE-COUNTER.
       F-CVC-WRT-LIN-REP.
           EXIT.

       CVC-WRT-RLL-NWP SECTION.
       I-CVC-WRT-RLL-NWP.
           IF GRC-1WRT = 'S'
           WRITE GRC-LINEA-CVC AFTER SALTO
           MOVE 'N' TO GRC-1WRT
           ELSE
           WRITE GRC-LINEA-CVC AFTER SALTO.
           ADD 1 TO RPT-CVC-LINE-COUNTER.
       F-CVC-WRT-RLL-NWP.
           EXIT.

       CVC-WRT-RLL-YPF SECTION.
       I-CVC-WRT-RLL-YPF.
           ADD 1 TO RPT-CVC-TOT-LDIS.
           WRITE GRC-LINEA-CVC AFTER RPT-CVC-TOT-LDIS.
           ADD 1 TO RPT-CVC-LINE-COUNTER.
       F-CVC-WRT-RLL-YPF.
           EXIT.

       CVC-SET-SMF-NWP-CF SECTION.
       I-CVC-SET-SMF-NWP-CF.
           IF SI-CTL-ISC-COD-OFOC IN WSS-CTL-CVC AND
           SI-CTL-LIN-ESC IN  WSS-CTL-CVC
               MOVE 'S' TO WSS-CVC-SEM-NP IN WSS-SEM-CVC.
       F-CVC-SET-SMF-NWP-CF.
           EXIT.

       GENERATE-DL-CVC SECTION.
       INI-GENERATE-DL-CVC.
           IF GRC-1WRT = 'S'
              PERFORM M-PH-CVC
              PERFORM WRT-SEC-PH-CVC
              PERFORM M-CH-CVC-ISC-GLS-CCSB
              MOVE SRT TO SRT-OLD-CVC.
           MOVE 'N' TO WSS-CTL-ISC-COD-OFOC IN WSS-CTL-CVC.
           MOVE 'N' TO WSS-CTL-ISC-GLS-CCSB IN WSS-CTL-CVC.
           IF ISC-COD-OFOC     IN SRT NOT =
              ISC-COD-OFOC-OLD IN SRT-OLD-CVC
                 MOVE 'S' TO WSS-CTL-ISC-COD-OFOC IN WSS-CTL-CVC
                 MOVE 'S' TO WSS-CTL-ISC-GLS-CCSB IN WSS-CTL-CVC.
           IF ISC-GLS-CCSB     IN SRT NOT =
              ISC-GLS-CCSB-OLD IN SRT-OLD-CVC
                 MOVE 'S' TO WSS-CTL-ISC-GLS-CCSB IN WSS-CTL-CVC.
           MOVE SRT TO SRT-CUR-CVC.
           MOVE SRT-OLD-CVC TO SRT.
           PERFORM CVC-PRO-VAR-CTL-CF.
           MOVE SRT-CUR-CVC TO SRT.
           PERFORM CVC-PRO-VAR-CTL-CH.
           COMPUTE RPT-CVC-TOT-LDIS =
                RPT-CVC-PAGE-LIMIT - RPT-CVC-LINE-COUNTER.
           IF RPT-CVC-TOT-LDIS < WSS-SIZ-DL-CVC
               MOVE 'S' TO WSS-CVC-NO-CABE IN WSS-NCAE-CVC.
           IF SI-CVC-SEM-NP OR SI-CVC-NO-CABE
              PERFORM CVC-WRT-RLL-YPH
              MOVE 'N' TO WSS-CVC-SEM-NP IN WSS-SEM-CVC.
           ADD ISC-VAL-SCRE IN SRT TO SUM-TOT-CTA-COL.
           ADD ISC-VAL-SCRE IN SRT TO SUM-VAL-SCOL.
           ADD WSS-SGV-SALD IN SRT TO SUM-TOT-CTA-CON.
           ADD WSS-SGV-SALD IN SRT TO SUM-VAL-SCON.
           IF GRC-PRLD = GRC-PRLD-NOT
              MOVE GRC-PRLD-YES TO GRC-PRLD.
       FIN-GENERATE-DL-CVC.
           EXIT.


       CVC-CLR-CTL-SIZ SECTION.
       I-CVC-CLR-CTL-SIZ.
           MOVE 'N' TO WSS-CVC-NO-CABE IN WSS-NCAE-CVC.
           MOVE ZEROES TO RPT-CVC-TOT-LCTL.
       F-CVC-CLR-CTL-SIZ.
           EXIT.


       CVC-CLR-SEM-NWP SECTION.
       I-CVC-CLR-SEM-NWP.
           MOVE 'N' TO WSS-CVC-SEM-NP IN WSS-SEM-CVC.
       F-CVC-CLR-SEM-NWP.
           EXIT.


       CVC-PRO-VAR-CTL-CF SECTION.
       I-CVC-PRO-VAR-CTL-CF.
           PERFORM CVC-PRO-RLL-TAM-CF.
           IF SI-CTL-ISC-GLS-CCSB IN WSS-CTL-CVC
              PERFORM D-CF-CVC-ISC-GLS-CCSB
              PERFORM M-CF-CVC-ISC-GLS-CCSB
              PERFORM WRT-SEC-CF-CVC-ISC-GLS-CCSB.
           IF SI-CTL-ISC-COD-OFOC IN WSS-CTL-CVC
              PERFORM D-CF-CVC-ISC-COD-OFOC
              PERFORM M-CF-CVC-ISC-COD-OFOC
              PERFORM WRT-SEC-CF-CVC-ISC-COD-OFOC.
       F-CVC-PRO-VAR-CTL-CF.
           EXIT.


       CVC-SUM-SIZ-CTL-CF SECTION.
       I-CVC-SUM-SIZ-CTL-CF.
           IF SI-CTL-ISC-GLS-CCSB IN WSS-CTL-CVC
              ADD WSS-SIZ-CF-CVC-ISC-GLS-CCSB TO RPT-CVC-TOT-LCTL.
           IF SI-CTL-ISC-COD-OFOC IN WSS-CTL-CVC
              ADD WSS-SIZ-CF-CVC-ISC-COD-OFOC TO RPT-CVC-TOT-LCTL.
       F-CVC-SUM-SIZ-CTL-CF.
           EXIT.

       CVC-SUM-SIZ-CTL-CH SECTION.
       I-CVC-SUM-SIZ-CTL-CH.
           IF SI-CTL-ISC-GLS-CCSB IN WSS-CTL-CVC
              ADD WSS-SIZ-CH-CVC-ISC-GLS-CCSB TO RPT-CVC-TOT-LCTL
           GO TO F-CVC-SUM-SIZ-CTL-CH.
       F-CVC-SUM-SIZ-CTL-CH.
           EXIT.

       CVC-PRO-RLL-NWP-CH SECTION.
       I-CVC-PRO-RLL-NWP-CH.
           IF SI-CVC-SEM-NP
              GO TO CAM-PAG.
           PERFORM CVC-CLR-SEM-NWP.
           PERFORM CVC-SUM-SIZ-CTL-CH.
           PERFORM CVC-CHK-SIZ-DIS.
       CAM-PAG.
       F-CVC-PRO-RLL-NWP-CH.
           EXIT.

       CVC-CHK-SIZ-DIS SECTION.
       I-CVC-CHK-SIZ-DIS.
           COMPUTE RPT-CVC-TOT-LDIS =
               RPT-CVC-PAGE-LIMIT - RPT-CVC-LINE-COUNTER.
           IF RPT-CVC-TOT-LDIS < RPT-CVC-TOT-LCTL
               MOVE 'S' TO WSS-CVC-NO-CABE IN WSS-NCAE-CVC.
           MOVE ZEROES TO RPT-CVC-TOT-LCTL.
       F-CVC-CHK-SIZ-DIS.
           EXIT.


       CVC-PRO-VAR-CTL-CH SECTION.
       I-CVC-PRO-VAR-CTL-CH.
           PERFORM CVC-PRO-RLL-NWP-CH.
           IF WSS-CVC-NO-CABE = 'S' OR WSS-CVC-SEM-NP = 'S'
              PERFORM CVC-WRT-RLL-YPH
              MOVE 'N' TO WSS-CVC-SEM-NP
              MOVE 'N' TO WSS-CVC-NO-CABE.
           IF SI-CTL-ISC-GLS-CCSB IN WSS-CTL-CVC
              PERFORM M-CH-CVC-ISC-GLS-CCSB.
       F-CVC-PRO-VAR-CTL-CH.
           EXIT.

       M-PH-CVC SECTION.
       I-M-PH-CVC.
           MOVE RPT-DUSU IN RPT-VARI TO
                RT-RPT-DUSU IN PH-CVC.
           MOVE RPT-DSIS IN RPT-VARI TO
                RT-RPT-DSIS IN PH-CVC.
           MOVE ISC-COD-OFOC IN SRT TO
                RT-ISC-COD-OFOC IN PH-CVC.
           MOVE WSS-GLS-OFIC IN WSS-CVC TO
                RT-WSS-GLS-OFIC IN PH-CVC.
           MOVE WSS-NUM-DPRO IN WSS-CVC TO
                RT-WSS-NUM-DPRO IN PH-CVC.
           MOVE WSS-NUM-MPRO IN WSS-CVC TO
                RT-WSS-NUM-MPRO IN PH-CVC.
           MOVE WSS-NUM-SPRO IN WSS-CVC TO
                RT-WSS-NUM-SPRO IN PH-CVC.
           MOVE WSS-NUM-APRO IN WSS-CVC TO
                RT-WSS-NUM-APRO IN PH-CVC.
           MOVE 'COLPLCVC' TO
                RT-WSS-GLS-PGM IN PH-CVC.
           MOVE RPT-CVC-PAGE-COUNTER IN RPT-VARI-CVC TO
                RT-RPT-CVC-PAGE-COUNTER IN PH-CVC.
           MOVE RPT-FDMA IN RPT-VARI TO
                RT-RPT-FDMA IN PH-CVC.
       F-M-PH-CVC.
           EXIT.

       M-CH-CVC-ISC-GLS-CCSB SECTION.
       I-M-CH-CVC-ISC-GLS-CCSB.
           MOVE ISC-GLS-CCSB IN SRT TO
                RT-ISC-GLS-CCSB IN CF-CVC-ISC-GLS-CCSB.
           MOVE WSS-GLS-CCBL IN SRT TO
                RT-WSS-GLS-CCBL IN CF-CVC-ISC-GLS-CCSB.
       F-M-CH-CVC-ISC-GLS-CCSB.
           EXIT.

       M-CF-CVC-ISC-GLS-CCSB SECTION.
       I-M-CF-CVC-ISC-GLS-CCSB.
           MOVE SUM-TOT-CTA-COL TO
                RT-SUM-TOT-CTA-COL IN CF-CVC-ISC-GLS-CCSB.
           MOVE ZEROES TO  SUM-TOT-CTA-COL.
           MOVE SUM-TOT-CTA-CON TO
                RT-SUM-TOT-CTA-CON IN CF-CVC-ISC-GLS-CCSB.
           MOVE ZEROES TO  SUM-TOT-CTA-CON.
           MOVE WSS-TOT-CTA-DIF IN WSS-CVC TO
                RT-WSS-TOT-CTA-DIF IN CF-CVC-ISC-GLS-CCSB.
           ADD WSS-TOT-CTA-DIF IN WSS-CVC TO SUM-SGV-DIFC.
       F-M-CF-CVC-ISC-GLS-CCSB.
           EXIT.

       M-CF-CVC-ISC-COD-OFOC SECTION.
       I-M-CF-CVC-ISC-COD-OFOC.
           MOVE SUM-VAL-SCOL TO
                RT-SUM-VAL-SCOL IN CF-CVC-ISC-COD-OFOC.
           MOVE ZEROES TO  SUM-VAL-SCOL.
           MOVE SUM-VAL-SCON TO
                RT-SUM-VAL-SCON IN CF-CVC-ISC-COD-OFOC.
           MOVE ZEROES TO  SUM-VAL-SCON.
           MOVE SUM-SGV-DIFC TO
                RT-SUM-SGV-DIFC IN CF-CVC-ISC-COD-OFOC.
           MOVE ZEROES TO  SUM-SGV-DIFC.
       F-M-CF-CVC-ISC-COD-OFOC.
           EXIT.
      *    10-OCT-97 05:38 PM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
       D-CF-CVC-ISC-COD-OFOC SECTION.
       INI-CF-CVC-ISC-COD-OFOC.
      *<<<< CF_CVC_ISC_COD_OFOC
           MOVE 'S' TO WSS-IND-IMPR IN WSS-VARI.
      *>>>>
       FIN-CF-CVC-ISC-COD-OFOC.
           EXIT.
       D-CF-CVC-ISC-GLS-CCSB SECTION.
       INI-CF-CVC-ISC-GLS-CCSB.

           SUBTRACT SUM-TOT-CTA-CON IN WSS-SUM-CVC FROM
                    SUM-TOT-CTA-COL IN WSS-SUM-CVC
                    GIVING WSS-DIF  IN WSS-VARI

           MOVE WSS-DIF      IN WSS-VARI TO
           WSS-TOT-CTA-DIF   IN WSS-CVC.


       FIN-CF-CVC-ISC-GLS-CCSB.
           EXIT.
       COPY GNSBGABT.

      *<<<< EOF
       CERRAR-ARCHIVOS SECTION.
      *------------------
       INI-CLOSE-FILE.
           DISPLAY ' '.
           DISPLAY '      ESTADISTICAS DE PROCESO'.
           DISPLAY '      ======================='.
           DISPLAY ' '.
           DISPLAY 'ISC LEIDAS         : ' WSS-ISC-LEID IN WSS-VARI.
           DISPLAY 'SCD LEIDAS         : ' WSS-SCD-LEID IN WSS-VARI.
           DISPLAY 'REG. PAREADOS      : ' WSS-REG-PAR  IN WSS-VARI.
           DISPLAY 'CUENTAS ISC LEIDAS : ' WSS-CTA-ISC  IN WSS-VARI.
           DISPLAY ' '.
           DISPLAY 'INDICADOR DE DIFERENCIA : ' WSS-OPCION IN WSS-VARI.
           CLOSE COLISC COLSCD.
           IF HAY-REGISTROS-EN-SORT-CVC
                PERFORM TERMINATE-RPTCVC.
           CLOSE RPTCVC.
       FIN-CLOSE-FILE.
           EXIT.

       OBT-FECHA SECTION.
      *-----------------
       INI-OBT-FECHA.
      *ALD-BCI-INI/13.01.1999
      *     PERFORM GET-FHOY.
      *     MOVE HOY-DHOY TO WSS-NUM-DPRO IN WSS-CVC.
      *     MOVE HOY-MHOY TO WSS-NUM-MPRO IN WSS-CVC.
      *     MOVE HOY-AHOY TO WSS-NUM-APRO IN WSS-CVC.
      *     MOVE HOY-SHOY TO WSS-NUM-SPRO IN WSS-CVC.

            MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN WSS-CVC.
            MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN WSS-CVC.
            MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN WSS-CVC.
            MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN WSS-CVC.
      *ALD-BCI-FIN/13.01.1999
       FIN-OBT-FECHA.
           EXIT.

       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY GNSBBMSG.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBBTAB.
      *ALD-BCI-INI/13.01.1999
       COPY GNSBGFEC.
       COPY GNSBPFEC.
      *ALD-BCI-FIN/13.01.1999
      *>>>>

