       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPCICG.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.     29-JAN-1992 16:10:59

      * Programa que carga ICG

       ENVIRONMENT DIVISION.
      *====================

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGIFD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSBRMSG.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.

       COPY COLBRICG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.

       01  WSS-VARI.
           05 WSS-RICG.
              07 WSS-IOPC                    PIC X(12).
              07 WSS-TINT                    PIC X(12).
              07 WSS-GTAS                    PIC X(06).
              07 WSS-TASA REDEFINES WSS-GTAS PIC 9(02)V9(04).


       PROCEDURE DIVISION.
      *==================

       MAIN SECTION.
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPCICG' TO FIO-PROG.
           PERFORM BUS-FSIS.
           PERFORM PROCESO.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

       PROCESO SECTION.
       INI-PROCESO.
           ACCEPT WSS-RICG.
           IF WSS-RICG NOT > SPACES OR WSS-RICG = '*'
               GO TO FIN-PROCESO.
           DISPLAY 'OPERACION : ' WSS-IOPC.
           MOVE SPACES   TO ICG.
           MOVE WSS-IOPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES   TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES   TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES   TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'    TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES   TO ICG-FEC-FINI IN ICG.

           MOVE ZEROES   TO ICG-FEC-FTRN IN ICG.
           MOVE ZEROES   TO ICG-HRA-HRTR IN ICG.

           MOVE WSS-TINT TO ICG-COD-TINT IN ICG.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE WSS-TASA TO ICG-SGV-SPRD IN ICG
               MOVE 0        TO ICG-SGV-TINT IN ICG
           ELSE
               MOVE WSS-TASA TO ICG-SGV-TINT IN ICG
               MOVE 0        TO ICG-SGV-SPRD IN ICG.

           MOVE ZEROES   TO ICG-FEC-FTER IN ICG.
           MOVE 0        TO ICG-SGV-MNTO IN ICG.

           IF ICG-COD-CVTI IN ICG > SPACES
               IF NOT ( ICG-MSC-TFPR IN ICG = 'C' OR 'F' )
                   DISPLAY 'PARA TASA VARIABLE, TIPO DEBE SER F O C'
                   GO TO INI-PROCESO
               ELSE
                   NEXT SENTENCE
           ELSE
               IF ICG-MSC-TFPR IN ICG > SPACES
                   DISPLAY 'PARA TASA FIJA, TIPO DEBE SER BLANCO'
                   GO TO INI-PROCESO.

           IF ICG-MSC-TFPR = 'C'
               IF NOT ( ICG-NUM-PREP > ZEROES AND
                        ( ICG-MSC-UTPR = 'D' OR 'M' OR 'A' ) )
                   DISPLAY 'DEBE INGRESAR PERIODO DE REPACTO'
                   GO TO INI-PROCESO.
           IF ICG-MSC-TFPR = 'F'
               IF ICG-NUM-PREP > ZEROES OR
                  ICG-MSC-UTPR > SPACES
                   DISPLAY 'NO DEBE INGRESAR PERIODO DE REPACTO'
                   GO TO INI-PROCESO.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL INGRESAR REGISTRO ICG, CON LLAVE:'
               ICG-KEY-IICG IN ICG.
           GO TO INI-PROCESO.
       FIN-PROCESO.
           EXIT.

       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY GNSBBMSG.
       COPY GNSBGEND.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.

       COPY COLBFICG.
