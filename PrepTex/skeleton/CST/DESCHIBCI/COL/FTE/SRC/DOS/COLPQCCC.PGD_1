       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   COLPQCCC.
       AUTHOR.       BEETEAM 2005.
       DATE-WRITTEN. 20-Jun-19 05:49 PM.

      * NOMBRE PROGRAMA                   COLPQCCC
      * VERSION PGM                       3.1
      * VERSION SKL                       19.04.15
      * OPCION                            CON
      * ARCHIVO BASE                      COLRDC
      * PANTALLA                          COLCCC
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      * VERSION SKL                        V07                          
      *   V03 13-JUN-2003 CORRIGE ERROR DE UBICACION DE GNSWGTSK        
      *   V04 15-JAN-2004 INGRESA LABEL EXIT_SCR                        
      *   V05 18-FEB-2004 PFS_SCR_GKEY_PREV                             
      *   V06  9-MAR-2004 INCLUYE LABEL USA_PFSCONQUE                   
      *   V07  1-MAY-2004 INCORPORA DOCUMENTACION VERSION DE PROGRAMA   
      *JCT-INI 07-ABR-2010 COL: NUB.30058 CORRECCION CONSUMO ONLINE
      *   V08  7-ABR-2010 INCORPORACION RUTINA CAL-FEC CON EL OBJETO
      *                   DE AGREGAR 1 DIA HABIL A LA FECHA DE PROCESO
      *                   Y CONSIDERAR OPERACIONES CURSADAS CON FECHA
      *                   DEL DIA HABIL SIGUIENTE.
      *JCT-FIN 07-ABR-2010
      **************************************************************
      *JCT-INI 07-07-2011 COL-CORRECCION CONSULTA CCC
      * MODIFICACION : 07-07-2011 JTORRES
      * PROYECTO     : CORRECCION CONSULTA CCC
      * OBJETIVO     : CONSIDERAR CREDITOS NO ESTRUCTURADOS EN LA
      *                CONSULTA, ADEMAS, SE DEBE INDICAR ERROR A LA
      *                WEB CUANDO CLIENTE NO TIENE CREDITOS VIGENTES
      *                O ACTIVOS
      * ETIQUETA     : JCT-INI 07-07-2011 COL-CORRECCION CONSULTA CCC
      *JCT-FIN 07-07-2011
      * OPCION                            CON                           
      * ARCHIVO BASE                      COLRDC                        
      * PANTALLA                          COLCCC                        
      * INP/OUT                           DATACOM                       
      * TAMANO COMMAREA                   250                           
      ***************************************************************

      ***************************************************************
      *                                                             *
      *  AUTOR : BEE-TEAM  JCD                                      *
      *  ID.   : JCD-INI 23-OCT-2012 TXN LENTAS                     *
      *  FECHA : 23 DE OCTUBRE DEL 2012                             *
      *  MOTIVO: RESPUESTA LENTA                                    *
      *  CAMBIO: SE CAMBIA LA LLAVE DE ACCESO A LA RDC Y SE DISMINU-*
      *          YE LA CANTIDAD DE LECTURAS                         *
      *                                                             *
      *                                                             *
      *                                                             *
      ***************************************************************


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-COLPQCCC-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$COLPQCCC$ SKL=$19.04.15$ VSN=${vsnpq}$        
      -    'GEN=$20-Jun-19 05:49 PM$ FNC=${fncpq}$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
       COPY COLWICCC.

       COPY COLBRRDC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<< WSS
      *MVG-INI 28-MAY-2019 IGUALACION COL 
       COPY COLWXCCC.

       01 WSS-VARI-PFS-QUE.
          03 WSS-HAY-ERRO     VALUE 'N'            PIC X(01).
          03 WSS-FRM-FFLD     VALUE SPACES       PIC X(01).
          03 WSS-MAX-PANT     VALUE 1            PIC 9(05).
          03 WSS-IND-PANT     VALUE 1            PIC 9(05).
          03 WSS-IND-HMAS     VALUE 'N'          PIC X(01).
      *MVG-FIN 28-MAY-2019 IGUALACION COL
       01  WSS-HAY-RDC-EN-BDT VALUE 'SI' PIC X(02).
       01  WSS-QUE-ITEM.
           03 WSS-QUE-ITEM-IDEN         PIC X(25).
           03 WSS-QUE-ITEM-ITEM         PIC X(75).
       01  WSS-PUT-KCCC    VALUE 'N'    PIC X(01).
       01  WSS-STP-ITRN    VALUE SPACES PIC X(14).
       01  WSS-FEC-FDSP.
           05 WSS-NUM-DDSP                       PIC 9(02).
           05 WSS-NUM-MDSP                       PIC 9(02).
           05 WSS-NUM-SDSP                       PIC 9(02).
           05 WSS-NUM-ADSP                       PIC 9(02).

       01  WSS-CAI-IOPC.
           03  WSS-COD-TOPC                      PIC X(01).
           03  WSS-COD-COPC                      PIC X(03).
 
       77 WSS-MAX-OCC        VALUE 50            PIC 9(02).             
       77 WSS-TOT-OCC-FRM    VALUE 1             PIC 9(02).
       77 WSS-DBNM           VALUE ZEROES        PIC 9(03).
       77 WSS-DBIM           VALUE ZEROES        PIC 9(02).
       77 WSS-DBNP           VALUE ZEROES        PIC 9(03).
       77 WSS-DBIP           VALUE ZEROES        PIC 9(02).
       77 WSS-BUS-BDP        VALUE 'N'           PIC X(01).
       77 WSS-ENC-IOPE       VALUE 'N'           PIC X(01).

       COPY TABBROFI.
       01 FRM-IFLD-PTC       VALUE ZEROES        PIC 9(04).
       01 PFS-VARI.
          03 PFS-IDLC-SEL    VALUE 'S'           PIC X(01).
          03 PFS-IVEZ-TOT    VALUE 'S'           PIC X(01).

       01 PGM-STAT-DLC-01.
          03 PGM-STAT-DLC.
             88 PGM-STAT-DLC-NUL    VALUE '  '.
             05 PGM-STT1-DLC        VALUE '2'    PIC X(01).
                88 PGM-STAT-DLC-OKS VALUE '0'.
             05 PGM-STT2-DLC        VALUE '3'    PIC X(01).
      *>>>>
      *<<<< WSS AND PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
      *>>>>
      *<<<< WSS
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGPES.
       COPY COLBRDLC.
       COPY COLBROPC.
       COPY COLBRRCE.
       COPY TABBRCAM.
       COPY TABWGTVC.
       COPY SGCBRDBC.
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
       COPY COLBRCAN.
      *MHM-INI 23-JUL-2012 PENTA
       COPY COLWGVEN.
       COPY COLBREVC.
       COPY COLBRRCV.
       COPY COLBRTOC.
       COPY COLWGINT.
      *MHM-FIN 23-JUL-2012 PENTA
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES        *


       01 WSS-VARI.
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
          03 WSS-COD-STAT-AUX                    PIC X(01).
          03 WSS-NUM-DMNX                        PIC 9(03).
          03 WSS-GLS-MNDR.
              05 WSS-NUM-DREV                    PIC 9(03).
              05 WSS-GLS-RREV                    PIC X(57).
          03 WSS-FEC-FMIN.
              05 WSS-NUM-DMIN                    PIC 9(02).
              05 WSS-NUM-MMIN                    PIC 9(02).
              05 WSS-NUM-SMIN                    PIC 9(02).
              05 WSS-NUM-AMIN                    PIC 9(02).
          03 WSS-FEC-FINI.
              05 WSS-NUM-DINI                    PIC 9(02).
              05 WSS-NUM-MINI                    PIC 9(02).
              05 WSS-NUM-SINI                    PIC 9(02).
              05 WSS-NUM-AINI                    PIC 9(02).
          03 WSS-FEC-FCMP.
              05 WSS-NUM-SCMP                    PIC 9(02).
              05 WSS-NUM-ACMP                    PIC 9(02).
              05 WSS-NUM-MCMP                    PIC 9(02).
              05 WSS-NUM-DCMP                    PIC 9(02).
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
          03 WSS-TAB-GLS-PASO2                   PIC X(12).             
          03 WSS-TAB-GLS-PASO  REDEFINES WSS-TAB-GLS-PASO2.             
             05 WSS-TSS-GLS-PART1                PIC X(10).             
             05 WSS-TSS-GLS-PART2                PIC X(02).             
          03 WSS-TAB-GLS-DCOR.                                          
             05 WSS-TSS-COD-STAT                 PIC X(01).             
             05 WSS-FILLER-STAT                  PIC X(01) VALUE ':'.   
             05 WSS-TSS-GLS-STAT                 PIC X(10).             
          03 WSS-FEC-FRTO.
             05 WSS-NUM-DFTO                     PIC 9(02).
             05 WSS-NUM-MFTO                     PIC 9(02).
             05 WSS-NUM-SFTO                     PIC 9(02).
             05 WSS-NUM-AFTO                     PIC 9(02).
          03 WSS-FEC-FCM1.
             05 WSS-NUM-SCM1                     PIC 9(02).
             05 WSS-NUM-ACM1                     PIC 9(02).
             05 WSS-NUM-MCM1                     PIC 9(02).
             05 WSS-NUM-DCM1                     PIC 9(02).
          03 WSS-FEC-FCM2.
             05 WSS-NUM-SCM2                     PIC 9(02).
             05 WSS-NUM-ACM2                     PIC 9(02).
             05 WSS-NUM-MCM2                     PIC 9(02).
             05 WSS-NUM-DCM2                     PIC 9(02).
          03 WSS-COD-COOC.
             05 WSS-COD-TOOC                     PIC X(03).
             05 WSS-COD-AOOC                     PIC X(03).
          03 WSS-KEY-IRDC                        PIC X(27).
          03 WSS-VAL-NDLC.
             05 WSS-VAL-NDLC-EDT                 PIC ZZZZZZZZZ9,9999.
          03 WSS-COD-CANA                        PIC 9(03).
          03 WSS-CIC-IOPE.
             05 WSS-CAI-IOPE                     PIC X(04).
             05 WSS-IIC-IOPE                     PIC X(08).
      *Variables Extras para edicion de campos numericos
          03 WSS-CCC-EDT.
             05 WSS-SGV-TINT-N.
                07 WSS-SGV-TINT-EDT      PIC ZZZ9,9999.
                07 WSS-SGV-TINT          PIC X(09).
                07 WSS-SGV-R REDEFINES
                   WSS-SGV-TINT          PIC S9(3)V9(4).
             05 WSS-VAL-SFIN-N.
                07 WSS-VAL-SFIN-EDT      PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
                07 WSS-VAL-SFIN   VALUE SPACES  PIC X(19).
                07 WSS-VAL-SFIN-R REDEFINES WSS-VAL-SFIN.
                   09 WSS-VAL-SFIN-CPL   PIC X(04).
                   09 WSS-VAL-SFIN-NUM   PIC 9(11)V9(04).
             05 WSS-VAL-SCAP-N.
                07 WSS-VAL-SCAP-EDT      PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
                07 WSS-VAL-SCAP   VALUE SPACES  PIC X(19).
                07 WSS-VAL-SCAP-R REDEFINES WSS-VAL-SCAP.
                   09 WSS-VAL-SCAP-CPL   PIC X(04).
                   09 WSS-VAL-SCAP-NUM   PIC 9(11)V9(04).
             05 WSS-VAL-INTV-N.
                07 WSS-VAL-INTV-EDT      PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
                07 WSS-VAL-INTV   VALUE SPACES  PIC X(19).
                07 WSS-VAL-INTV-R REDEFINES WSS-VAL-INTV.
                   09 WSS-VAL-INTV-CPL   PIC X(04).
                   09 WSS-VAL-INTV-NUM   PIC 9(11)V9(04).
             05 WSS-VAL-CRED-N.
                07 WSS-VAL-CRED-EDT      PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
                07 WSS-VAL-CRED   VALUE SPACES  PIC X(19).
                07 WSS-VAL-CRED-R REDEFINES WSS-VAL-CRED.
                   09 WSS-VAL-CRED-CPL   PIC X(04).
                   09 WSS-VAL-CRED-NUM   PIC 9(11)V9(04).
             05 WSS-VAL-SCRE-N.
                07 WSS-VAL-SCRE-EDT      PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
                07 WSS-VAL-SCRE   VALUE SPACES  PIC X(19).
                07 WSS-VAL-SCRE-R REDEFINES WSS-VAL-SCRE.
                   09 WSS-VAL-SCRE-CPL   PIC X(04).
                   09 WSS-VAL-SCRE-NUM   PIC 9(11)V9(04).
          03 WSS-FEC-FMAV.
             05 WSS-NUM-DMAV                    PIC 9(02).
             05 WSS-NUM-MMAV                    PIC 9(02).
             05 WSS-NUM-SMAV                    PIC 9(02).
             05 WSS-NUM-AMAV                    PIC 9(02).
             
      *COPY COLMXW10.
       COPY COLBRICG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY COLBRVEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
      *PVG FIN 27-AGO-2003
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
              05 PGM-STAT-RDC.
                 88 PGM-STAT-RDC-NUL    VALUE '  '.
                 07 PGM-STT1-RDC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RDC-OKS VALUE '0'.
                 07 PGM-STT2-RDC        VALUE '3' PIC X(01).
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).
           03 PGM-CMMA.
              05 PGM-CMMA-CHR OCCURS 358 PIC X(01).
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 DFH-CMMA OCCURS 358 PIC X(01).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO CCC-FLD.
           MOVE LOW-VALUES TO CCC-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +358 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'COLPQCCC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO
      *MVG-INI 28-MAY-2019 IGUALACION COL
           IF SCR-OFRM-SRV
              MOVE TSK-TERM-ALF TO CCC-COD-TERM
              MOVE TSK-TERM-ALF TO CCC-COD-TERM-MAS
           ELSE
              MOVE EIBTRMID     TO CCC-COD-TERM
              MOVE EIBTRMID     TO CCC-COD-TERM-MAS.

           IF FRM-FFLD = FRM-FFLD-PF5 AND
              SCR-INST = SCR-INST-GAB
              MOVE FRM-FFLD-PF5 TO WSS-FRM-FFLD
              MOVE FRM-FFLD-RET TO FRM-FFLD
              MOVE SCR-INST-GKY TO SCR-INST
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF6 AND
              SCR-INST = SCR-INST-GAB
              MOVE FRM-FFLD-PF6 TO WSS-FRM-FFLD
              MOVE FRM-FFLD-RET TO FRM-FFLD
              MOVE SCR-INST-GKY TO SCR-INST
           ELSE
              MOVE FRM-FFLD-RET TO WSS-FRM-FFLD.
      *MVG-FIN 28-MAY-2019 IGUALACION COL

           MOVE 'COL' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'PUTKCCC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
                MOVE 'S' TO WSS-PUT-KCCC.

           MOVE SPACES TO WSS-STP-ITRN.
           MOVE 'COL' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'HOYCCC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
                MOVE TAB-GLS-DESC TO WSS-STP-ITRN.
      * FORMATO 'SSAAMMDDHHMMSS'
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       GNS-BUS-VCA SECTION.
       INI-GNS-BUS-VCA.
           MOVE 0 TO FRM-IFLD.
       LUP-GNS-BUS-VCA.
           ADD 1 TO FRM-IFLD.
           IF FRM-IFLD NOT > EIBCALEN AND
              FRM-IFLD NOT > 358
                MOVE DFH-CMMA(FRM-IFLD) TO PGM-CMMA-CHR(FRM-IFLD)
                GO TO LUP-GNS-BUS-VCA.
           MOVE PGM-CMMA TO SCR-VARI.
       FIN-GNS-BUS-VCA.
           EXIT.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-CCC.
           PERFORM EDT-KEY-CCC.
           PERFORM EDT-FLD-CCC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.



       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.




       SCR-DMSG SECTION.
       INI-SCR-DMSG.
      *<<<< INI_SCR_DMSG
           MOVE ZEROES TO SCR-TOT-OCCU                                  
      *>>>>
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-CCC
               PERFORM EDT-KEY-CCC
               PERFORM EDT-FLD-CCC
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-CCC
               PERFORM EDT-KEY-CCC
           ELSE
               PERFORM CLR-FLD-CCC
               PERFORM EDT-FLD-CCC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-CCC.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO CCC-FLD.
           MOVE LOW-VALUES TO CCC-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY
      *MVG-INI 28-MAY-2019 IGUALACION COL
      *    IF SCR-OFRM-SRV
      * JCD-INI 23-OCT-2012 TXN LENTAS
      *    PERFORM BUSCA-DBIM-DBIP.
      * JCD-FIN 23-OCT-2012 TXN LENTAS
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
              MOVE '00' TO FIO-STAT
              GO TO FIN-FND-KEY.
      * JCD-INI 23-OCT-2012 TXN LENTAS
           PERFORM BUSCA-DBIM-DBIP.
      * JCD-FIN 23-OCT-2012 TXN LENTAS
           PERFORM DEL-QUE-CCC.
           PERFORM CCC-ANL-KEY.
           MOVE 1 TO SCR-NUM-PANT.
           GO TO FIN-FND-KEY.
           MOVE ZEROES TO SCR-TOT-OCCU.
           PERFORM KEY-ALL-CCC.
           GO TO CON-FND.
      *MVG-FIN 28-MAY-2019 IGUALACION COL
      *>>>> INI_FND_KEY
           PERFORM KEY-ALL-CCC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE RDC-STP-ITRN IN RDC TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-RDC.
      *<<<< FIN_FND_KEY
      *MVG-INI 28-MAY-2019 IGUALACION COL
       CON-FND.
      *MVG-FIN 28-MAY-2019 IGUALACION COL
           MOVE 'EN FIO-RDC 01-A' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-RDC.                                         
           IF FIO-STAT-OKS                                              
               MOVE RDC-STP-ITRN IN RDC TO SCR-UMOD.                    
           MOVE FIO-STAT TO PGM-STAT-RDC.                               

           MOVE 'EN FIO-RDC 01-D' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.
      *>>>>
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-RDC-OKS
               MOVE RDC-STP-ITRN IN RDC TO SCR-UMOD.
      *<<<< PUT_SCR
      *MVG-INI 28-MAY-2019 IGUALACION COL

           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
              GO TO EXT-PUT-SCR.

           PERFORM CCC-PUT-SCR.
       EXT-PUT-SCR.

           IF PGM-STAT-RDC-OKS
              PERFORM INIT-VARI
              PERFORM SET-DLC-1
              IF FIO-STAT-OKS AND
                 DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
                 PERFORM LLENAR-TABLA                                   
              ELSE
                 MOVE 'COL' TO MSG-COD-SIST
                 MOVE 'DLC    NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC        TO FRM-MEN1
                 MOVE RDC-CIC-IOPC IN RDC TO FRM-MEN2.
      *MVG-FIN 28-MAY-2019 IGUALACION COL
      *>>>>
      *<<<< PUT_SCR
           MOVE DBC-CAI-ICLI IN CCC-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN CCC-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.

           MOVE 'EN EXT-PUT-SCR' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   DBC-CIC-ICLI' TO WSS-QUE-ITEM-IDEN.
           MOVE  DBC-CIC-ICLI IN DBC    TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   DBC-IDC-ICLI' TO WSS-QUE-ITEM-IDEN.
           MOVE  DBC-IDC-ICLI IN DBC    TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   DBC-GLS-NOMC' TO WSS-QUE-ITEM-IDEN.
           MOVE  DBC-GLS-NOMC IN DBC    TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           IF FIO-STAT-OKS
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *>>>>
           PERFORM PUT-ALL-CCC.
      *<<<< FIN_PUT_SCR
      *MVG-INI 28-MAY-2019 IGUALACION COL
      * AQUI MOVER LOS DATOS DE TS-CCC A PANTALLA
           MOVE SCR-TOT-OCCU TO CCC-MAS-NUM-TOCC.
           MOVE WSS-IND-HMAS TO CCC-MAS-IND-HMAS.

           IF WSS-FRM-FFLD = FRM-FFLD-RET
              MOVE ZEROES TO QUE-NITM
           ELSE
           IF WSS-FRM-FFLD = FRM-FFLD-PF6
              COMPUTE QUE-NITM = (SCR-NUM-PANT * WSS-MAX-PANT)
              IF QUE-NITM NOT < SCR-TOT-OCCU
                  MOVE 'S'   TO WSS-HAY-ERRO
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'DLC    NONXT' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  COMPUTE QUE-NITM =
                     (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT
              ELSE
                  ADD 1 TO SCR-NUM-PANT
           ELSE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5
              COMPUTE QUE-NITM =
                 (SCR-NUM-PANT * WSS-MAX-PANT) - (2 * WSS-MAX-PANT - 1)
              IF QUE-NITM < 1
                 MOVE 'S'   TO WSS-HAY-ERRO
                 MOVE 'COL' TO MSG-COD-SIST
                 MOVE 'DLC    NOPRV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 COMPUTE QUE-NITM =
                    (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT
              ELSE
                 SUBTRACT 1 FROM QUE-NITM
                 SUBTRACT 1 FROM SCR-NUM-PANT.
           MOVE CCC-NOM-TSCCC TO QUE-COLA.
           MOVE CCC-LEN-TSCCC TO QUE-LITM.
       CCC-CIC-LEE-TS.
           ADD 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE QUE-ITEM TO CCC-ITEM
              PERFORM CCC-MOV-TS-FRM
              GO TO CCC-CIC-LEE-TS
           ELSE
           IF QUE-NITM = 1
              MOVE 'COL' TO MSG-COD-SIST
              MOVE 'CCC    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
      *JCT-INI 07-07-2011 COL-CORRECCION CONSULTA CCC
              MOVE MSG-GLS-DESC TO FRM-MENS.
      *->     MOVE MSG-GLS-DESC TO FRM-MENS
      *->     IF SCR-OFRM-SRV
      *->        MOVE 'S' TO SCR-IERR
      *->        PERFORM SCR-MSSG
      *->        PERFORM EDT-KEY-CCC
      *->        PERFORM SCR-PUTA
      *->        PERFORM SCR-EXIT.
      *JCT-FIN 07-07-2011
      *MVG-FIN 28-MAY-2019 IGUALACION COL
      *>>>> FIN_PUT_SCR
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE CCC-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO CCC-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
      *<<<< PFS_SCR_GKEY_PREV
      *MVG-INI 28-MAY-2019 IGUALACION COL
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
              IF FRM-FFLD = FRM-FFLD-PF5
                 MOVE FRM-FFLD-RET TO FRM-FFLD
              ELSE
                 IF FRM-FFLD = FRM-FFLD-PF6
                    MOVE FRM-FFLD-RET TO FRM-FFLD.
      *MVG-FIN 28-MAY-2019 IGUALACION COL
      *>>>> PFS_SCR_GKEY_PREV
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-CCC
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CCC-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CCC.
           PERFORM VAL-NUM-FLD-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CCC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-CCC.
      *<<<< SCR_GKEY_VAL_IKY
      *MVG-INI 28-MAY-2019 IGUALACION COL
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
           IF FRM-COD-STAT IN CCC-FLD = 'B'
              PERFORM BUS-FEC-FNDR
              MOVE FRM-COD-STAT IN CCC-FLD TO WSS-COD-STAT-AUX
              MOVE 'A'                     TO FRM-COD-STAT IN CCC-FLD.

      *MHM-INI 24-AGO-2012
           IF FRM-COD-STAT IN CCC-FLD = 'K'
              MOVE FRM-COD-STAT IN CCC-FLD TO WSS-COD-STAT-AUX
              MOVE 'A'                     TO FRM-COD-STAT IN CCC-FLD.

           IF FRM-COD-STAT IN CCC-FLD = 'U'
              MOVE FRM-COD-STAT IN CCC-FLD TO WSS-COD-STAT-AUX
              MOVE 'A'                     TO FRM-COD-STAT IN CCC-FLD.
      *MHM-FIN 24-AGO-2012
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES 
      *MVG-FIN 28-MAY-2019 IGUALACION COL
      *>>>> SCR_GKEY_VAL_IKY
           PERFORM VAL-IKY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-CCC.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-CCC.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
      *>>>> ERR_SCR_GKEY
           PERFORM EDT-FLD-CCC.
      *>>>> ERR_SCR_GKEY
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CCC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-CCC
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CCC-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-CCC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-CCC.
           PERFORM VAL-IKY-CCC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-CCC.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-CCC.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-CCC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON
           IF NOT (FRM-FFLD = FRM-FFLD-PF5)
           IF NOT (FRM-FFLD = FRM-FFLD-PF6)
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CCC-GLS-MEN2
               MOVE SCR-PRMT     TO CCC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CCC-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO CCC-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE CCC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CCC-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-CCC

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CCC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CCC-GLS-MENS.
           PERFORM PRO-MKY-CCC.
           PERFORM PRO-AKY-CCC.
           PERFORM UNP-IKY-CCC.
           PERFORM FST-KEY-CCC.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE CCC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CCC-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CCC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CCC-GLS-MENS.
           PERFORM UNP-KEY-CCC.
           PERFORM FST-KEY-CCC.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-CCC.
           PERFORM PRO-AKY-CCC.
           PERFORM UNP-MKY-CCC.
           PERFORM UNP-FLD-CCC.
           PERFORM FST-FLD-CCC.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO CCC-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-CCC.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CCC
               PERFORM EDT-FLD-CCC
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CCC
               PERFORM EDT-FLD-CCC
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CCC.
           PERFORM EDT-FLD-CCC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY COLBQCCC.
       COPY GNSBVNUM.
       COPY COLBFRDC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBUSR.
       COPY TABBFUSR.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       CCC-PUT-SCR SECTION.                                             
       INI-CCC-PUT-SCR.                                                 
       FIN-CCC-PUT-SCR.                                                 
           EXIT.                                                        
                                                                        
       CCC-ANL-KEY SECTION.                                             
       INI-CCC-ANL-KEY.                                                 
           IF DBC-NUM-ICLI IN CCC-FLD NOT = ZEROES                      
      *IDC-CLI Busca Cliente por medio de IdC                           
              MOVE DBC-NUM-ICLI IN CCC-FLD TO DBC-NUM-ICLI IN DBC       
              MOVE DBC-IND-ICLI IN CCC-FLD TO DBC-IND-ICLI IN DBC       
              MOVE DBC-GLS-ICLI IN CCC-FLD TO DBC-GLS-ICLI IN DBC       
              MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                          
              MOVE FIO-GET-KEY     TO FIO-CMND                          
              PERFORM GET-CLI                                           

              MOVE 'EN CCC-ANL-KEY ' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES           TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE

              MOVE '   DBC-CIC-ICLI' TO WSS-QUE-ITEM-IDEN
              MOVE  DBC-CIC-ICLI IN DBC    TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE

              MOVE '   DBC-IDC-ICLI' TO WSS-QUE-ITEM-IDEN
              MOVE  DBC-IDC-ICLI IN DBC    TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE

              MOVE '   DBC-GLS-NOMC' TO WSS-QUE-ITEM-IDEN
              MOVE  DBC-GLS-NOMC IN DBC    TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE

              IF MSG-COD-MENS > SPACES                                  
                 MOVE FIO-STAT-NEX TO FIO-STAT                          
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 GO TO FIN-FND-KEY                                      
              ELSE                                                      
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                   
                 PERFORM CPT-BLKS                                       
                 MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC                   
                 MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN CCC-FLD    
                 MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN CCC-FLD    
           ELSE                                                         
           IF DBC-GLS-NOMC IN CCC-FLD > SPACES                          
      *NOM-CLI Busca Cliente por medio del Nombre                       
              MOVE SPACES TO DBC-GLS-NOMC IN DBC                        
                                                                        
              MOVE DBC-GLS-NOMC IN CCC-FLD TO STR-GLS-GSTR              
              PERFORM STR-UNS                                           
              MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC   
              MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC   
              MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC   
                                                                        
              MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY                          
              MOVE FIO-GET-NLS TO FIO-CMND                              
              PERFORM GET-CLI                                           
              IF MSG-COD-MENS > SPACES                                  
                 MOVE ZEROES TO DBC-NUM-ICLI IN CCC-FLD                 
                 MOVE SPACES TO DBC-VRF-ICLI IN CCC-FLD                 
                 MOVE SPACES TO DBC-IND-ICLI IN CCC-FLD                 
                 MOVE SPACES TO DBC-GLS-ICLI IN CCC-FLD                 
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FIO-STAT-NEX TO FIO-STAT                          
                 GO TO FIN-FND-KEY                                      
              ELSE                                                      
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                   
                 PERFORM CPT-BLKS                                       
                 MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC                   
                 MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN CCC-FLD    
                 MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN CCC-FLD    
                 MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN CCC-FLD    
                 MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN CCC-FLD    
                 MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN CCC-FLD    
                 MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN CCC-FLD.   
           MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN CCC-FLD.         
           MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN CCC-FLD.         
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN CCC-FLD.         
       FST-FND-KEY.                                                     
           PERFORM SET-RDC-1.                                           
       LUP-FND-KEY.                                                     
           IF NOT (FIO-STAT-OKS AND                                     
                   RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC)           
              IF WSS-BUS-BDP = 'N'                                      
                 MOVE 'S' TO WSS-BUS-BDP                                
                 IF WSS-DBIM > ZEROES AND                               
                    WSS-DBIP > ZEROES                                   

                    MOVE 'EN INV-BD-1' TO WSS-QUE-ITEM-IDEN
                    MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
                    PERFORM GNX-PRO-QUE

                    PERFORM INV-BD                                      
                    GO TO FST-FND-KEY.                                  
                                                                        
           IF NOT (FIO-STAT-OKS AND                                     
                   RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC)           
              MOVE FIO-STAT-NEX TO FIO-STAT                             
              GO TO FIN-FND-KEY.                                        
      *>>>>                                                             

           MOVE 'EN FIO-RDC 02-A' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-RDC.                                         
           IF FIO-STAT-OKS                                              
               MOVE RDC-STP-ITRN IN RDC TO SCR-UMOD.                    
           MOVE FIO-STAT TO PGM-STAT-RDC.                               

           MOVE 'EN FIO-RDC 02-D' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.
       FIN-CCC-ANL-KEY.                                                 
           EXIT.    

       CCC-MOV-TS-FRM-ELM SECTION.                                      
       INI-CCC-MOV-TS-FRM-ELM.                                          
           MOVE TSS-CAI-IOPC TO FRM-CAI-IOPC IN CCC-FLD.                
           MOVE TSS-IIC-IOPC TO FRM-IIC-IOPC IN CCC-FLD.                
           MOVE TSS-NUM-IDLC TO FRM-NUM-IDLC IN CCC-FLD.                
           MOVE TSS-COD-COOC TO FRM-COD-COOC IN CCC-FLD.                
           MOVE TSS-NUM-ACEP TO FRM-NUM-ACEP IN CCC-FLD.                
           MOVE TSS-VRF-ACEP TO FRM-VRF-ACEP IN CCC-FLD.                
           MOVE TSS-IND-ACEP TO FRM-IND-ACEP IN CCC-FLD.                
           MOVE TSS-GLS-ACEP TO FRM-GLS-ACEP IN CCC-FLD.                
           MOVE TSS-VAL-NDLC TO FRM-VAL-NDLC IN CCC-FLD.                
           MOVE TSS-FEC-FMAV TO FRM-FEC-FMAV IN CCC-FLD.                
           MOVE TSS-COD-OFOC TO FRM-COD-OFOC IN CCC-FLD.                
           MOVE TSS-GLS-STAT TO FRM-GLS-STAT IN CCC-FLD.                
           MOVE TSS-COD-NUNI TO FRM-COD-NUNI IN CCC-FLD.                
           MOVE TSS-GLS-NOMC TO FRM-GLS-NOMC IN CCC-FLD.                
           MOVE TSS-GLS-COOC TO FRM-GLS-COOC IN CCC-FLD.                
           MOVE TSS-GLS-VCOC TO FRM-GLS-VCOC IN CCC-FLD.                
           MOVE TSS-GLS-OFOC TO FRM-GLS-OFOC IN CCC-FLD.                
           MOVE TSS-COD-TDEU TO FRM-COD-TDEU IN CCC-FLD.                
           MOVE TSS-VAL-CRED-NUM TO FRM-VAL-CRED IN CCC-FLD.            
           MOVE TSS-VAL-SCRE-NUM TO FRM-VAL-SCRE IN CCC-FLD.            
           MOVE TSS-IND-RENO TO FRM-IND-RENO IN CCC-FLD.                
           MOVE TSS-FEC-FTRN TO FRM-FEC-FTRN IN CCC-FLD.                
           MOVE TSS-HRA-HRTR TO FRM-HRA-HRTR IN CCC-FLD.                
           MOVE TSS-FEC-FCOL TO FRM-FEC-FCOL IN CCC-FLD.                
           MOVE TSS-SGV-TINT-NUM TO FRM-SGV-TINT IN CCC-FLD.            
           MOVE TSS-NUM-VCOR TO FRM-NUM-VCOR IN CCC-FLD.                
           MOVE TSS-NUM-VCAN TO FRM-NUM-VCAN IN CCC-FLD.                
           MOVE TSS-COD-CANL TO FRM-COD-CANL IN CCC-FLD.                
           MOVE TSS-GLS-CANL TO FRM-GLS-CANL IN CCC-FLD.                
           MOVE TSS-FEC-FVEN TO FRM-FEC-FVEN IN CCC-FLD.                
           MOVE TSS-VAL-SFIN-NUM TO FRM-VAL-SFIN IN CCC-FLD.            
           MOVE TSS-VAL-SCAP-NUM TO FRM-VAL-SCAP IN CCC-FLD.            
           MOVE TSS-VAL-INTV-NUM TO FRM-VAL-INTV IN CCC-FLD.            
           MOVE TSS-COD-MONE TO FRM-COD-MONE IN CCC-FLD.                
       FIN-CCC-MOV-TS-FRM-ELM.                                          
           EXIT.                                                        

       GET-FHOY SECTION.
       INI-GET-FHOY.
           MOVE SYS-GET-DATE TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-DHOY TO HOY-DHOY.
           MOVE SYS-MHOY TO HOY-MHOY.
           MOVE SYS-SHOY TO HOY-SHOY.
           MOVE SYS-AHOY TO HOY-AHOY.
           MOVE SYS-HHHY TO HOY-HHHY.
           MOVE SYS-MMHY TO HOY-MMHY.
           MOVE SYS-SSHY TO HOY-SSHY.

           IF WSS-STP-ITRN > SPACES
              MOVE WSS-STP-ITRN TO HOY-STP-ITRN.
      * FORMATO 'SSAAMMDDHHMMSS'
       FIN-GET-FHOY.
           EXIT.

       LLENAR-TABLA SECTION.
       INI-LLENAR-TABLA.
           MOVE 1 TO FRM-IFLD-PTC.
           MOVE 1 TO FRM-IFLD.
       LUP-LLENAR-TABLA.
           MOVE 'EN LUP-LLENAR-TABLA' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE 'S' TO PFS-IDLC-SEL.
           IF PFS-IVEZ-TOT = 'S'
              PERFORM PROCESO-CADA-HIJO
              IF PFS-IDLC-SEL NOT = 'S'
                 SUBTRACT 1 FROM FRM-IFLD
                 GO TO NXT-LLENAR-TABLA.
              PERFORM CARGAR-TABLA
      *MVG-INI 28-MAY-2019 IGUALACION COL
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
      *MHM-INI 05-OCT-2012 PENTA
           IF DBC-IND-ICLI IN CCC-FLD = 'Y'
               GO TO FIN-LLENAR-TABLA.
      *MHM-FIN 05-OCT-2012 PENTA
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES 
      *MVG-FIN 28-MAY-2019 IGUALACION COL
              IF PFS-IDLC-SEL NOT = 'S'
                 SUBTRACT 1 FROM FRM-IFLD
                 GO TO NXT-LLENAR-TABLA.
       NXT-LLENAR-TABLA.
           ADD 1 TO FRM-IFLD.
           IF PFS-IVEZ-TOT = 'N'
              IF FRM-IFLD > WSS-TOT-OCC-FRM
                 GO TO FIN-LLENAR-TABLA.
           IF PGM-STAT-DLC-OKS
              MOVE 'DLC-KEY-IDLC' TO FIO-AKEY
              MOVE FIO-GET-NXT TO FIO-CMND
              PERFORM COL-FIO-DLC

              MOVE 'EN NXT-LLENAR-TABLA' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE

              MOVE '   DLC-KEY-IDLC' TO WSS-QUE-ITEM-IDEN
              MOVE  DLC-KEY-IDLC    TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE

              IF FIO-STAT-OKS AND
                 DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
                 GO TO LUP-LLENAR-TABLA.

           MOVE 'EN FIO-RDC 03-A' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.

           MOVE 'EN FIO-RDC 03-D' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           IF NOT FIO-STAT-OKS
              GO TO CON-LLENAR-TABLA.
       LU1-LLENAR-TABLA.
           MOVE 'EN FIO-RDC 04-A' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

      * JCD-INI 23-OCT-2012 TXN LENTAS
      * LEER SIGUIENTE RDC HASTA QUE ESTADO SEA VALIDO
      *    MOVE FIO-GET-NXT TO FIO-CMND.                                
      *    PERFORM COL-FIO-RDC.                                         

           PERFORM RDC-SIG-ESTADO-1
      *
      *-
      * JCD-FIN 23-OCT-2012 TXN LENTAS

           MOVE 'EN FIO-RDC 04-D' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE 'EN LU1-LLENAR-TABLA-1' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-CIC-ICLI' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-CIC-ICLI IN RDC TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           IF NOT FIO-STAT-OKS
              GO TO CON-LLENAR-TABLA.
           IF RDC-CIC-ICLI IN RDC NOT = DBC-CIC-ICLI IN DBC
              GO TO CON-LLENAR-TABLA.

           IF FRM-IND-TDEU IN CCC-FLD > SPACES
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                 GO TO LU1-LLENAR-TABLA
              ELSE
                 NEXT SENTENCE
           ELSE
              IF RDC-NUM-IDLC IN RDC = ZEROES
                 GO TO LU1-LLENAR-TABLA.
           MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC.
           MOVE RDC-CIC-IOPC IN RDC TO DLC-CIC-IOPC IN DLC.
           MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-DLC.

           MOVE 'EN LU1-LLENAR-TABLA-2' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   DLC-KEY-IDLC'    TO WSS-QUE-ITEM-IDEN.
           MOVE DLC-KEY-IDLC IN DLC  TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
              GO TO LUP-LLENAR-TABLA.
           GO TO LU1-LLENAR-TABLA.
       CON-LLENAR-TABLA.
           IF WSS-BUS-BDP = 'N'
              MOVE 'S' TO WSS-BUS-BDP
              IF WSS-DBIM > ZEROES AND WSS-DBIP > ZEROES
                 MOVE 'EN INV-BD-2' TO WSS-QUE-ITEM-IDEN
                 MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
                 PERFORM GNX-PRO-QUE

                 PERFORM INV-BD
                 PERFORM SET-RDC-1
                 PERFORM SET-DLC-1
                 IF WSS-HAY-RDC-EN-BDT = 'NO'
                    GO TO FIN-LLENAR-TABLA
                 ELSE
                 GO TO LUP-LLENAR-TABLA.
 
           IF FRM-IFLD = 1
              MOVE 'COL' TO MSG-COD-SIST
              MOVE 'DLC    NONXT' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-LLENAR-TABLA.
           MOVE FIO-END-BRW TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT SCR-OFRM-SRV
              GO TO EXT-LLENAR-TABLA.
 
           MOVE WSS-IND-HMAS TO CCC-MAS-IND-HMAS.                       
           IF WSS-IND-HMAS = 'S'                                        
               MOVE WSS-MAX-OCC TO CCC-MAS-NUM-TOCC                     
           ELSE                                                         
               SUBTRACT 1 FROM FRM-IFLD-PTC                             
                        GIVING CCC-MAS-NUM-TOCC.                        
       EXT-LLENAR-TABLA.
           EXIT.

       PROCESO-CADA-HIJO SECTION.
       INI-PROCESO-CADA-HIJO.
           PERFORM SEL-REG-CAR.
           IF PFS-IDLC-SEL = 'N'
              GO TO FIN-PROCESO-CADA-HIJO.
           IF FRM-COD-VCOC IN CCC-FLD > SPACES
              ADD DLC-VAL-SDLC IN DLC TO FRM-VAL-TDLC IN CCC-FLD
              GO TO FIN-PROCESO-CADA-HIJO.
           IF FRM-IFLD = 1
              PERFORM GET-FHOY
              MOVE 'TAB'  TO FIO-SIST
              MOVE 'VLR'  TO TAB-CIC-TTAB IN TAB
              MOVE '0999' TO TAB-CIC-CTAB IN TAB
              MOVE 'TAB-CIC-TABL' TO FIO-AKEY
              MOVE FIO-GET-KEY    TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 MOVE SPACES TO TVC-MNAC
              ELSE
                 MOVE TAB-COD-CTAB IN TAB TO TVC-MNAC.
           MOVE DLC-VAL-SDLC IN DLC TO TVC-VALO IN TVC-VARI.
           MOVE OPC-COD-VCOC IN OPC TO TVC-MON1 IN TVC-VARI.
           MOVE TVC-MNAC            TO TVC-MON2 IN TVC-VARI.
           MOVE HOY-DHOY            TO TVC-DCAM IN TVC-VARI.
           MOVE HOY-MHOY            TO TVC-MCAM IN TVC-VARI.
           MOVE HOY-SHOY            TO TVC-SCAM IN TVC-VARI.
           MOVE HOY-AHOY            TO TVC-ACAM IN TVC-VARI.
           IF FRM-FEC-FTER  IN CCC-FLD = ZEROES                         
              MOVE HOY-SHOY TO FRM-NUM-STER IN CCC-FLD                  
              MOVE HOY-AHOY TO FRM-NUM-ATER IN CCC-FLD                  
              MOVE HOY-MHOY TO FRM-NUM-MTER IN CCC-FLD                  
              MOVE HOY-DHOY TO FRM-NUM-DTER IN CCC-FLD.                 
                                                                        
           PERFORM TAB-PRO-TVC.
           IF TVC-CMSG NOT > SPACES
              ADD TVC-VALO TO FRM-VAL-TDLC IN CCC-FLD.
       FIN-PROCESO-CADA-HIJO.
           EXIT.

       CARGAR-TABLA SECTION.
       INI-CARGAR-TABLA.
           MOVE 'EN CARGAR-TABLA-1' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   OPC-CIC-IOPC'    TO WSS-QUE-ITEM-IDEN.
           MOVE OPC-CIC-IOPC IN OPC  TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE SPACES TO CCC-ITEM.
           IF NOT SCR-TOT-OCCU < WSS-MAX-OCC AND SCR-OFRM-SRV           
              MOVE 'S' TO WSS-IND-HMAS                                  
              MOVE '   GOTOFIN-CARGAR-TABLA-0' TO WSS-QUE-ITEM-IDEN
              MOVE SPACES TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-CARGAR-TABLA.                                   
              MOVE 1 TO FRM-IFLD.
              PERFORM SEL-REG-CAR.
              IF PFS-IDLC-SEL = 'N'
                 MOVE '   GOTOFIN-CARGAR-TABLA-1' TO WSS-QUE-ITEM-IDEN
                 MOVE SPACES TO WSS-QUE-ITEM-ITEM
                 PERFORM GNX-PRO-QUE
                 GO TO FIN-CARGAR-TABLA.
           MOVE OPC-COD-COOC IN OPC TO TSS-COD-COOC.
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE TSS-COD-COOC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR IN TAB TO TSS-GLS-COOC.

           IF OPC-COD-VCOC IN OPC > SPACES
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'VLR' TO TAB-COD-TTAB IN TAB
              MOVE OPC-COD-VCOC IN OPC TO
                   TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB TO TSS-GLS-VCOC.
           MOVE OPC-COD-OFOC IN OPC TO TSS-COD-OFOC.
           MOVE OPC-COD-VCOC IN OPC TO TSS-COD-MONE.                    
      *BUS-OFI busca oficina en tablas
           IF TSS-COD-OFOC > SPACES
              MOVE TSS-COD-OFOC TO OFI-COD-OFIC IN OFI
              PERFORM BUS-OFI
              MOVE OFI-GLS-ABRV IN OFI TO TSS-GLS-OFOC.

           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE-NUM.
           MOVE OPC-VAL-CRED IN OPC TO WSS-VAL-CRED-NUM.
           IF SCR-OFRM-SRV
              MOVE WSS-VAL-SCRE-NUM TO WSS-VAL-SCRE-EDT
              MOVE WSS-VAL-SCRE-EDT TO TSS-VAL-SCRE
              MOVE WSS-VAL-CRED-NUM TO WSS-VAL-CRED-EDT
              MOVE WSS-VAL-CRED-EDT TO TSS-VAL-CRED
           ELSE
              MOVE WSS-VAL-SCRE-NUM TO TSS-VAL-SCRE-NUM
              MOVE WSS-VAL-CRED-NUM TO TSS-VAL-CRED-NUM.

           MOVE OPC-IND-RENO IN OPC TO TSS-IND-RENO.
           MOVE OPC-NUM-DTRN IN OPC TO WSS-NUM-DDSP.
           MOVE OPC-NUM-MTRN IN OPC TO WSS-NUM-MDSP.
           MOVE OPC-NUM-STRN IN OPC TO WSS-NUM-SDSP.
           MOVE OPC-NUM-ATRN IN OPC TO WSS-NUM-ADSP.
           MOVE WSS-FEC-FDSP TO TSS-FEC-FTRN.
           MOVE OPC-HRA-HRTR IN OPC TO TSS-HRA-HRTR.
      *FECHA DE OTORGAMIENTO COL-FEC-FCOL
           MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DFTO IN WSS-VARI.
           MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MFTO IN WSS-VARI.
           MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SFTO IN WSS-VARI.
           MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AFTO IN WSS-VARI.
           MOVE WSS-FEC-FRTO IN WSS-VARI TO TSS-FEC-FCOL.
      *Lee Tasa de ICG
           MOVE 'ICG-KEY-IICG'      TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE ZEROES              TO ICG-SGV-TINT IN ICG.             
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT (FIO-STAT-OKS AND
                   ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                   ICG-NUM-ICAN IN ICG = ZEROES AND
                   ICG-CIC-IOPV IN ICG = SPACES AND
                   ICG-NUM-IVCT IN ICG = ZEROES AND
                   ICG-IND-TTAS IN ICG = 'INT')
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '   GOTOFIN-CARGAR-TABLA-2' TO WSS-QUE-ITEM-IDEN
              MOVE SPACES TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-CARGAR-TABLA.
      *     MOVE ICG-SGV-TINT IN ICG TO WSS-SGV-TINT-EDT IN WSS-VARI.   
      *     MOVE WSS-SGV-TINT-EDT IN WSS-VARI TO TSS-SGV-TINT.          
           IF ICG-COD-CVTI IN ICG > SPACES                              
              MOVE ICG-SGV-SPRD IN ICG TO TSS-SGV-TINT-NUM              
           ELSE                                                         
              MOVE ICG-SGV-TINT IN ICG TO TSS-SGV-TINT-NUM.             
      *Numero de Cuotas
           MOVE OPC-NUM-VCOR IN OPC TO TSS-NUM-VCOR.
      *Cuotas Pagadas
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
      *JCT-INI 07-07-2011 COL-CORRECCION CONSULTA CCC
      *--  MOVE 1                   TO VEN-NUM-IVEN IN VEN.             
           IF OPC-IND-VSTR IN OPC = 'S'
              MOVE 1                     TO VEN-NUM-IVEN IN VEN
           ELSE
              MOVE OPC-NUM-IVEN IN OPC   TO VEN-NUM-IVEN IN VEN.
      *JCT-FIN 07-07-2011
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '   GOTOFIN-CARGAR-TABLA-3' TO WSS-QUE-ITEM-IDEN
              MOVE SPACES TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-CARGAR-TABLA.
           SUBTRACT 1 FROM VEN-NUM-IVCT  IN VEN
                    GIVING WSS-COD-CANA  IN WSS-VARI.
           MOVE WSS-COD-CANA IN WSS-VARI TO TSS-NUM-VCAN.
      *Canal
           IF OPC-COD-TTRN IN OPC IS NOT NUMERIC
              MOVE ZEROES  TO WSS-COD-CANA IN WSS-VARI
           ELSE
              MOVE OPC-COD-TTRN IN OPC TO WSS-COD-CANA IN WSS-VARI.
       CRG-CANAL.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'CNL' TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-CANA IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY              TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              IF WSS-COD-CANA IN WSS-VARI = 000
                 MOVE WSS-COD-CANA IN WSS-VARI TO TSS-COD-CANL
                 MOVE 'OFIC' TO TSS-GLS-CANL
              ELSE
                 MOVE ZEROES TO WSS-COD-CANA IN WSS-VARI
                 GO TO CRG-CANAL
           ELSE
              MOVE WSS-COD-CANA IN WSS-VARI TO TSS-COD-CANL
              MOVE TAB-GLS-DCOR TO TSS-GLS-CANL.
      *FECHA PROXIMO VENCIMIENTO VEN-FEC-FVEN
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DFTO IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MFTO IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SFTO IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-AFTO IN WSS-VARI.
           MOVE WSS-FEC-FRTO IN WSS-VARI TO TSS-FEC-FVEN.
      *Valor de la Cuota
           MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SFIN-NUM.
           IF SCR-OFRM-SRV
              MOVE WSS-VAL-SFIN-NUM TO WSS-VAL-SFIN-EDT
              MOVE WSS-VAL-SFIN-EDT TO TSS-VAL-SFIN
           ELSE
              MOVE WSS-VAL-SFIN-NUM TO TSS-VAL-SFIN-NUM.
      *Capital de la Cuota
           MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SCAP-NUM.
           IF SCR-OFRM-SRV
              MOVE WSS-VAL-SCAP-NUM TO WSS-VAL-SCAP-EDT
              MOVE WSS-VAL-SCAP-EDT TO TSS-VAL-SCAP
           ELSE
              MOVE WSS-VAL-SCAP-NUM TO TSS-VAL-SCAP-NUM.
      *Interes de la Cuota
           SUBTRACT VEN-VAL-SCAP IN VEN FROM
                    VEN-VAL-SFIN IN VEN GIVING 
                    WSS-VAL-INTV-NUM IN WSS-VARI.

           IF SCR-OFRM-SRV
              MOVE WSS-VAL-INTV-NUM TO WSS-VAL-INTV-EDT
              MOVE WSS-VAL-INTV-EDT TO TSS-VAL-INTV
           ELSE
              MOVE WSS-VAL-INTV-NUM TO TSS-VAL-INTV-NUM.
 
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'STT' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-MSC-STAT IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
                                                                        
           MOVE OPC-MSC-STAT IN OPC       TO WSS-TSS-COD-STAT.          
           MOVE TAB-GLS-DCOR IN TAB       TO WSS-TAB-GLS-PASO2.         
           MOVE WSS-TSS-GLS-PART1         TO WSS-TSS-GLS-STAT.          
                                                                        
           MOVE WSS-TAB-GLS-DCOR          TO TSS-GLS-STAT.              
                                                                        
           MOVE DLC-KEY-IDLC IN DLC TO RCE-KEY-IDLC IN RCE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           IF FIO-STAT-OKS
               MOVE RCE-KEY-CNJE IN RCE TO TSS-COD-NUNI
           ELSE
               MOVE SPACES TO TSS-COD-NUNI.

           MOVE DLC-CAI-IOPC IN DLC TO TSS-CAI-IOPC.
           MOVE DLC-IIC-IOPC IN DLC TO TSS-IIC-IOPC.
           MOVE DLC-NUM-IDLC IN DLC TO TSS-NUM-IDLC.
           MOVE DLC-VAL-SDLC IN DLC TO WSS-VAL-NDLC-EDT.
           MOVE WSS-VAL-NDLC TO TSS-VAL-NDLC.
           MOVE DLC-NUM-DMAV IN DLC TO WSS-NUM-DMAV.
           MOVE DLC-NUM-MMAV IN DLC TO WSS-NUM-MMAV.
           MOVE DLC-NUM-SMAV IN DLC TO WSS-NUM-SMAV.
           MOVE DLC-NUM-AMAV IN DLC TO WSS-NUM-AMAV.
           MOVE WSS-FEC-FMAV TO TSS-FEC-FMAV.

           MOVE RDC-KEY-IRDC IN RDC TO WSS-KEY-IRDC IN WSS-VARI.
           IF RDC-NUM-IDLC IN RDC = ZEROES
              MOVE 'DIR' TO TSS-COD-TDEU
           ELSE
              MOVE 'IND' TO TSS-COD-TDEU.

           MOVE DLC-CIC-IOPC IN DLC TO RDC-CIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.

           MOVE 'EN FIO-RDC 05-A' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.
           PERFORM COL-FIO-RDC.
           MOVE 'EN FIO-RDC 05-D' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           IF FIO-STAT-OKS
              MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC

              MOVE 'EN CARGAR-TABLA-2' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE

              MOVE '   DBC-CIC-ICLI'    TO WSS-QUE-ITEM-IDEN
              MOVE DBC-CIC-ICLI  TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE

              MOVE FIO-GET-KEY  TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF NOT FIO-STAT-OKS
                 MOVE ZEROES TO TSS-NUM-ACEP
                 MOVE SPACES TO TSS-VRF-ACEP
                 MOVE SPACES TO TSS-IND-ACEP
                 MOVE SPACES TO TSS-GLS-ACEP
                 MOVE 'CLIENTE INEXISTENTE' TO TSS-GLS-NOMC
              ELSE
                 MOVE DBC-NUM-ICLI IN DBC TO TSS-NUM-ACEP
                 MOVE DBC-VRF-ICLI IN DBC TO TSS-VRF-ACEP
                 MOVE DBC-IND-ICLI IN DBC TO TSS-IND-ACEP
                 MOVE DBC-GLS-ICLI IN DBC TO TSS-GLS-ACEP
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                 PERFORM CPT-BLKS
                 MOVE CPT-STRN TO TSS-GLS-NOMC
           ELSE
              MOVE ZEROES TO TSS-NUM-ACEP
              MOVE SPACES TO TSS-VRF-ACEP
              MOVE SPACES TO TSS-IND-ACEP
              MOVE SPACES TO TSS-GLS-ACEP
              MOVE SPACES TO TSS-GLS-NOMC.

           MOVE WSS-KEY-IRDC IN WSS-VARI TO RDC-KEY-IRDC IN RDC.
           MOVE DBC-CAI-ICLI IN CCC-FLD  TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN CCC-FLD  TO DBC-IIC-ICLI IN DBC.
           PERFORM PUT-QUE-CCC.
           MOVE SCR-TOT-OCCU TO FRM-NUM-TDLC IN CCC-FLD.

           MOVE 'EN PUT-QUE-CCC' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   DLC-CIC-IOPC' TO WSS-QUE-ITEM-IDEN.
           MOVE  DLC-CIC-IOPC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.
       FIN-CARGAR-TABLA.
           EXIT.

       SEL-REG-CAR SECTION.
       INI-SEL-REG-CAR.
           MOVE 'EN SEL-REG-CAR' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   DLC-CIC-IOPC'    TO WSS-QUE-ITEM-IDEN.
           MOVE DLC-CIC-IOPC IN DLC  TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE DLC-CIC-IOPC IN DLC TO OPC-KEY-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 01' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR.

           IF FRM-COD-STAT IN CCC-FLD NOT = '*'
           IF FRM-COD-STAT IN CCC-FLD > SPACES AND
              FRM-COD-STAT IN CCC-FLD NOT = OPC-MSC-STAT IN OPC
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 02' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR
           ELSE
           IF OPC-MSC-STAT IN OPC NOT = 'A' AND
              FRM-COD-STAT IN CCC-FLD = SPACES
              MOVE '  RCHZO 03' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              MOVE 'N' TO PFS-IDLC-SEL
              GO TO FIN-SEL-REG-CAR.
 
           IF FRM-COD-ICNL IN CCC-FLD > SPACES AND
              FRM-COD-ICNL IN CCC-FLD NOT = OPC-COD-TTRN IN OPC
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 04' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR.
              
           IF OPC-IND-RENO IN CCC-FLD > SPACES AND
              OPC-IND-RENO IN CCC-FLD NOT = OPC-IND-RENO IN OPC
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 05' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR.
 
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 06' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR.
 
           MOVE OPC-CAI-IOPC IN OPC TO WSS-CAI-IOPC
           IF FRM-IND-IOPC IN CCC-FLD NOT = '*'
           IF FRM-IND-IOPC IN CCC-FLD  > SPACES AND
              FRM-IND-IOPC IN CCC-FLD NOT = WSS-COD-TOPC
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 07' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR
           ELSE
           IF WSS-COD-TOPC NOT = 'D' AND
              FRM-IND-IOPC IN CCC-FLD = SPACES
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 08' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR.
 
           IF FRM-COD-TOOC IN CCC-FLD > SPACES AND
              FRM-COD-TOOC IN CCC-FLD NOT = OPC-COD-TOOC IN OPC
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 09' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR.
              
           IF FRM-COD-AOOC IN CCC-FLD > SPACES AND
              FRM-COD-AOOC IN CCC-FLD NOT = OPC-COD-AOOC IN OPC
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 09' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR.
              
           IF FRM-COD-VCOC IN CCC-FLD > SPACES AND
              FRM-COD-VCOC IN CCC-FLD NOT = OPC-COD-VCOC IN OPC
              MOVE 'N' TO PFS-IDLC-SEL
              MOVE '  RCHZO 10' TO WSS-QUE-ITEM-IDEN
              MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              GO TO FIN-SEL-REG-CAR.
              
           IF FRM-FEC-FINI IN CCC-FLD > ZEROES
              MOVE FRM-NUM-DINI IN CCC-FLD TO WSS-NUM-DCM1
              MOVE FRM-NUM-MINI IN CCC-FLD TO WSS-NUM-MCM1
              MOVE FRM-NUM-SINI IN CCC-FLD TO WSS-NUM-SCM1
              MOVE FRM-NUM-AINI IN CCC-FLD TO WSS-NUM-ACM1
              IF OPC-FEC-FCOL IN OPC < WSS-FEC-FCM1
                 MOVE 'N' TO PFS-IDLC-SEL
                 GO TO FIN-SEL-REG-CAR.
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
           IF WSS-COD-STAT-AUX NOT = 'B'
      *MHM-INI 24-AGO-2012
            AND DBC-IND-ICLI IN CCC-FLD NOT = 'Y'
      *MHM-INI 24-AGO-2012
              IF OPC-VAL-SCRE IN OPC NOT > ZEROES
                 MOVE 'N' TO PFS-IDLC-SEL
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
                 GO TO FIN-SEL-REG-CAR.
                 
           IF FRM-FEC-FTER IN CCC-FLD > ZEROES
              MOVE FRM-NUM-DTER IN CCC-FLD TO WSS-NUM-DCM1
              MOVE FRM-NUM-MTER IN CCC-FLD TO WSS-NUM-MCM1
              MOVE FRM-NUM-STER IN CCC-FLD TO WSS-NUM-SCM1
              MOVE FRM-NUM-ATER IN CCC-FLD TO WSS-NUM-ACM1

              MOVE '   WSS-FEC-FCM1-1' TO WSS-QUE-ITEM-IDEN
              MOVE WSS-FEC-FCM1 TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE

      *JCT-INI 07-ABR-2010 COL: NUB.30058 CORRECCION CONSUMO ONLINE
              PERFORM OBT-SIG-DHBL
      *JCT-FIN 07-ABR-2010

              MOVE '   WSS-FEC-FCM1-2' TO WSS-QUE-ITEM-IDEN
              MOVE WSS-FEC-FCM1 TO WSS-QUE-ITEM-ITEM
              PERFORM GNX-PRO-QUE
              IF OPC-FEC-FCOL IN OPC > WSS-FEC-FCM1                     
                 MOVE 'N' TO PFS-IDLC-SEL                               
                 MOVE '  RCHZO 12' TO WSS-QUE-ITEM-IDEN
                 MOVE  SPACES          TO WSS-QUE-ITEM-ITEM
                 PERFORM GNX-PRO-QUE
                 GO TO FIN-SEL-REG-CAR.
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
           IF WSS-COD-STAT-AUX = 'B'
              PERFORM ANALIZA-CAN
              IF CAN-NUM-ICAN IN CAN = ZEROES
                 MOVE 'N' TO PFS-IDLC-SEL
                 GO TO FIN-SEL-REG-CAR.

      *MHM-INI 24-AGO-2012
           IF WSS-COD-STAT-AUX = 'K'
              PERFORM ANALIZA-CAN-ING
              IF CAN-NUM-ICAN IN CAN = ZEROES
                 MOVE 'N' TO PFS-IDLC-SEL
                 GO TO FIN-SEL-REG-CAR.

           IF WSS-COD-STAT-AUX = 'U'
              PERFORM ANALIZA-CAN-V
              IF CAN-NUM-ICAN IN CAN = ZEROES
                 MOVE 'N' TO PFS-IDLC-SEL
                 GO TO FIN-SEL-REG-CAR.
      *MHM-FIN 24-AGO-2012
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
       FIN-SEL-REG-CAR.
           EXIT.

       INIT-VARI SECTION.
       INI-INIT-VARI.
           MOVE 0 TO FRM-NUM-TDLC IN CCC-FLD.
           MOVE 0 TO FRM-VAL-TDLC IN CCC-FLD.
       FIN-INIT-VARI.
           EXIT.

       COPY COLBFDLC.
       COPY COLBFOPC.
       COPY COLBFRCE.
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
       COPY COLBFCAN.
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
       COPY TABBFCAM.
       COPY TABBGTVC.
       COPY SGCBGCLI.
       COPY SGCBFDBC.
       COPY GNSBGSTR.
       COPY GNSBGCPT.
       COPY GNSBGPES.
       COPY GNSBBTAB.
       COPY GNSBPFEC.
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY COLBFICG.
       COPY COLBFVEN.
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
      *MHM-INI 23-JUL-2012 PENTA
       COPY COLBGVEN.
       COPY COLBFEVC.
       COPY COLBFRCV.
       COPY COLBFTOC.
       COPY COLBGINT.
      *MHM-FIN 23-JUL-2012 PENTA
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
 
       INV-BD SECTION.
       INI-INV-BD.
           MOVE 'EN INI-INV-BD' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   WSS-DBNM'    TO WSS-QUE-ITEM-IDEN.
           MOVE WSS-DBNM  TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   WSS-DBNP'    TO WSS-QUE-ITEM-IDEN.
           MOVE WSS-DBNP  TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE WSS-DBNM TO IDD-IENT(WSS-DBIP).
           MOVE WSS-DBNP TO IDD-IENT(WSS-DBIM).
       FIN-INV-BD.
           EXIT.
 
       LEER-DESDE SECTION.                                              
       INI-LEER-DESDE.                                                  
           IF NOT SCR-OFRM-SRV                                          
              GO TO FIN-LEER-DESDE.                                     
                                                                        
           PERFORM GET-TSK-TERM.                                        
           MOVE TSK-TERM-ALF   TO QUE-TERM.                             
           MOVE CCC-TSMAS-TYPE TO QUE-TYPE.                             
           MOVE CCC-TSMAS-LENG TO QUE-LITM.                             
           MOVE +1             TO QUE-NITM.                             
           MOVE QUE-GET        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
              MOVE QUE-ITEM           TO CCC-TSMAS-ITEM                 
              MOVE CCC-TSMAS-CAI-IOPC TO WSS-CAI-IOPE IN WSS-VARI       
              MOVE CCC-TSMAS-IIC-IOPC TO WSS-IIC-IOPE IN WSS-VARI       
              MOVE QUE-DEL TO QUE-CMND                                  
              PERFORM GNS-PRO-QUE                                       
           ELSE                                                         
              MOVE SPACES TO WSS-CIC-IOPE IN WSS-VARI.                  
           MOVE 'N' TO WSS-IND-HMAS.                                    
       FIN-LEER-DESDE.                                                  
           EXIT.                                                        
                                                                        
       SET-RDC-1 SECTION.
       INI-SET-RDC-1.
           MOVE 'EN SET-RDC-1' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   DBC-CIC-ICLI'    TO WSS-QUE-ITEM-IDEN.
           MOVE DBC-CIC-ICLI IN DBC  TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           PERFORM LEER-DESDE.                                          
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.
           MOVE SPACES              TO RDC-KEY-IDLC IN RDC.
           IF WSS-CIC-IOPE IN WSS-VARI > SPACES
              IF WSS-ENC-IOPE = 'N'
                  MOVE WSS-CIC-IOPE IN WSS-VARI TO RDC-CIC-IOPC IN RDC
                  MOVE ZEROES                   TO RDC-NUM-IDLC IN RDC.
            MOVE FIO-GET-NLS TO FIO-CMND.
       LEE-NEXT-RDC.
           MOVE 'EN FIO-RDC 06-A' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

      * JCD-INI 23-OCT-2012 TXN LENTAS
           IF FIO-CMND =  FIO-GET-NLS
              PERFORM COL-FIO-RDC                                       
           ELSE
              PERFORM RDC-SIG-ESTADO-1.

      *    PERFORM COL-FIO-RDC.                                         
      * JCD-FIN 23-OCT-2012 TXN LENTAS

           MOVE 'EN FIO-RDC 06-D' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE '   RDC-KEY-IRDC' TO WSS-QUE-ITEM-IDEN.
           MOVE  RDC-KEY-IRDC     TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE 'SI' TO WSS-HAY-RDC-EN-BDT.
           IF NOT (FIO-STAT-OKS AND
                   DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDC)
              MOVE 'NO' TO WSS-HAY-RDC-EN-BDT.

           IF FIO-STAT-OKS AND
              DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDC                 
              IF FRM-IND-TDEU IN CCC-FLD > SPACES                       
                 IF FRM-IND-TDEU IN CCC-FLD = 'D'                       
                    IF RDC-NUM-IDLC IN RDC NOT = ZEROES                 
                       MOVE FIO-GET-NXT TO FIO-CMND                     
                       GO TO LEE-NEXT-RDC                               
                    ELSE                                                
                       NEXT SENTENCE                                    
                 ELSE                                                   
                    IF RDC-NUM-IDLC IN RDC = ZEROES                     
                       MOVE FIO-GET-NXT TO FIO-CMND                     
                       GO TO LEE-NEXT-RDC.                              
           MOVE FIO-STAT  TO PGM-STAT-RDC.                              
           IF FIO-STAT-OKS AND                                          
              DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDC AND
              WSS-CIC-IOPE IN WSS-VARI > SPACES AND
              WSS-ENC-IOPE = 'N' AND
              WSS-CIC-IOPE IN WSS-VARI = RDC-CIC-IOPC IN RDC
              MOVE 'S' TO WSS-ENC-IOPE.
       FIN-SET-RDC-1.
           EXIT.

       SET-DLC-1 SECTION.
       INI-SET-DLC-1.
           MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC.
           MOVE RDC-CIC-IOPC IN RDC TO DLC-CIC-IOPC IN DLC.
           MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           MOVE FIO-STAT TO PGM-STAT-DLC.
       FIN-SET-DLC-1.
           EXIT.

       BUSCA-DBIM-DBIP SECTION.                                         
       INI-BUSCA-DBIM-DBIP.                                             
           MOVE 'EN BUSCA-DBIM-DBIP' TO WSS-QUE-ITEM-IDEN.
           MOVE  SPACES          TO WSS-QUE-ITEM-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE 'COL'  TO IDD-SAUX.                                     
           MOVE 'M'    TO IDD-GAUX.                                     
           MOVE SPACES TO IDD-RAUX.                                     
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             AT END                                                     
                GO TO DBM-BUSCA-DBIM-DBIP                               
             WHEN IDD-DENT(IDD-ITBL) = IDD-DAUX                         
                MOVE IDD-IENT(IDD-ITBL) TO WSS-DBNM                     
                 MOVE IDD-IAUX          TO WSS-DBIM                     
                 GO TO CON-BUSCA-DBIM-DBIP.                             
       DBM-BUSCA-DBIM-DBIP.                                             
           MOVE 0 TO WSS-DBNM.                                          
           MOVE 0 TO WSS-DBIM.                                          
       CON-BUSCA-DBIM-DBIP.                                             
           MOVE 'COL'  TO IDD-SAUX.                                     
           MOVE 'P'    TO IDD-GAUX.                                     
           MOVE SPACES TO IDD-RAUX.                                     
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             AT END                                                     
                GO TO DBP-BUSCA-DBIM-DBIP                               
             WHEN IDD-DENT(IDD-ITBL) = IDD-DAUX                         
                MOVE IDD-IENT(IDD-ITBL) TO WSS-DBNP                     
                MOVE IDD-IAUX           TO WSS-DBIP                     
                GO TO FIN-BUSCA-DBIM-DBIP.                              
       DBP-BUSCA-DBIM-DBIP.                                             
           MOVE 0 TO WSS-DBNP.                                          
           MOVE 0 TO WSS-DBIP.                                          
       FIN-BUSCA-DBIM-DBIP.                                             
           EXIT.                                                        

      *MVG-INI 28-MAY-2019 IGUALACION COL
       DEL-QUE-CCC SECTION.
       INI-DEL-QUE-CCC.
           MOVE CCC-NOM-TSCCC TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-DEL-QUE-CCC.
           EXIT.
      *MVG-FIN 28-MAY-2019 IGUALACION COL
                                                                        
       PUT-QUE-CCC SECTION.
       INI-PUT-QUE-CCC.
      *     DISPLAY '<<< TSS-OPER-CCC >>> ' TSS-CAI-IOPC TSS-IIC-IOPC.
           ADD 1               TO SCR-TOT-OCCU.
           MOVE CCC-NOM-TSCCC  TO QUE-COLA.
           MOVE CCC-LEN-TSCCC  TO QUE-LITM.
           MOVE CCC-ITEM       TO QUE-ITEM.
           MOVE QUE-PUT        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PUT-QUE-CCC.
           EXIT.

       PUT-QUE-CCC-MAS SECTION.
       INI-PUT-QUE-CCC-MAS.
           MOVE CCC-LEN-TSCCC-MAS TO QUE-LITM.
           MOVE CCC-NOM-TSCCC-MAS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE CCC-MAS-ITEM      TO QUE-ITEM.
           MOVE QUE-PUT           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PUT-QUE-CCC-MAS.
           EXIT.

      *MVG-INI 28-MAY-2019 IGUALACION COL
       CCC-MOV-TS-FRM SECTION.
       INI-CCC-MOV-TS-FRM.
           IF SCR-OFRM-SRV
              GO TO FIN-CCC-MOV-TS-FRM
           ELSE
              IF WSS-IND-PANT > WSS-MAX-PANT
                 GO TO FIN-CCC-MOV-TS-FRM.
           PERFORM CCC-MOV-TS-FRM-ELM.
           ADD 1 TO WSS-IND-PANT.
       FIN-CCC-MOV-TS-FRM.
           EXIT.

       CCC-MOV-TS-FRM-ELM SECTION.
       INI-CCC-MOV-TS-FRM-ELM.
           MOVE TSS-CAI-IOPC TO FRM-CAI-IOPC IN CCC-FLD.
           MOVE TSS-IIC-IOPC TO FRM-IIC-IOPC IN CCC-FLD.
           MOVE TSS-NUM-IDLC TO FRM-NUM-IDLC IN CCC-FLD.
           MOVE TSS-COD-COOC TO FRM-COD-COOC IN CCC-FLD.
           MOVE TSS-NUM-ACEP TO FRM-NUM-ACEP IN CCC-FLD.
           MOVE TSS-VRF-ACEP TO FRM-VRF-ACEP IN CCC-FLD.
           MOVE TSS-IND-ACEP TO FRM-IND-ACEP IN CCC-FLD.
           MOVE TSS-GLS-ACEP TO FRM-GLS-ACEP IN CCC-FLD.
           MOVE TSS-VAL-NDLC TO FRM-VAL-NDLC IN CCC-FLD.
           MOVE TSS-FEC-FMAV TO FRM-FEC-FMAV IN CCC-FLD.
           MOVE TSS-COD-OFOC TO FRM-COD-OFOC IN CCC-FLD.
           MOVE TSS-GLS-STAT TO FRM-GLS-STAT IN CCC-FLD.
           MOVE TSS-COD-NUNI TO FRM-COD-NUNI IN CCC-FLD.
           MOVE TSS-GLS-NOMC TO FRM-GLS-NOMC IN CCC-FLD.
           MOVE TSS-GLS-COOC TO FRM-GLS-COOC IN CCC-FLD.
           MOVE TSS-GLS-VCOC TO FRM-GLS-VCOC IN CCC-FLD.
           MOVE TSS-GLS-OFOC TO FRM-GLS-OFOC IN CCC-FLD.
           MOVE TSS-COD-TDEU TO FRM-COD-TDEU IN CCC-FLD.
           MOVE TSS-VAL-CRED-NUM TO FRM-VAL-CRED IN CCC-FLD.
           MOVE TSS-VAL-SCRE-NUM TO FRM-VAL-SCRE IN CCC-FLD.
           MOVE TSS-IND-RENO TO FRM-IND-RENO IN CCC-FLD.
           MOVE TSS-FEC-FTRN TO FRM-FEC-FTRN IN CCC-FLD.
           MOVE TSS-HRA-HRTR TO FRM-HRA-HRTR IN CCC-FLD.
           MOVE TSS-FEC-FCOL TO FRM-FEC-FCOL IN CCC-FLD.
           MOVE TSS-SGV-TINT-NUM TO FRM-SGV-TINT IN CCC-FLD.
           MOVE TSS-NUM-VCOR TO FRM-NUM-VCOR IN CCC-FLD.
           MOVE TSS-NUM-VCAN TO FRM-NUM-VCAN IN CCC-FLD.
           MOVE TSS-COD-CANL TO FRM-COD-CANL IN CCC-FLD.
           MOVE TSS-GLS-CANL TO FRM-GLS-CANL IN CCC-FLD.
           MOVE TSS-FEC-FVEN TO FRM-FEC-FVEN IN CCC-FLD.
           MOVE TSS-VAL-SFIN-NUM TO FRM-VAL-SFIN IN CCC-FLD.
           MOVE TSS-VAL-SCAP-NUM TO FRM-VAL-SCAP IN CCC-FLD.
           MOVE TSS-VAL-INTV-NUM TO FRM-VAL-INTV IN CCC-FLD.
           MOVE TSS-COD-MONE TO FRM-COD-MONE IN CCC-FLD.
       FIN-CCC-MOV-TS-FRM-ELM.
           EXIT.
      *MVG-FIN 28-MAY-2019 IGUALACION COL

      *JCT-INI 07-ABR-2010 COL: NUB.30058 CORRECCION CONSUMO ONLINE
       OBT-SIG-DHBL SECTION.
       INI-OBT-SIG-DHBL.
           MOVE WSS-NUM-DCM1 TO FEC-ITM1.
           MOVE WSS-NUM-MCM1 TO FEC-ITM2.
           MOVE WSS-NUM-SCM1 TO FEC-ITM3.
           MOVE WSS-NUM-ACM1 TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.

           MOVE FEC-SIG-HBL  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
              MOVE FEC-ITM1 TO WSS-NUM-DCM1
              MOVE FEC-ITM2 TO WSS-NUM-MCM1
              MOVE FEC-ITM3 TO WSS-NUM-SCM1
              MOVE FEC-ITM4 TO WSS-NUM-ACM1.
       FIN-OBT-SIG-DHBL.
           EXIT.
      *JCT-FIN 07-ABR-2010

       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.
           IF WSS-PUT-KCCC = 'S'
              MOVE 'KCCC'       TO QUE-COLA
              MOVE WSS-QUE-ITEM TO QUE-ITEM
              MOVE +100         TO QUE-LITM
              MOVE QUE-PUT      TO QUE-CMND
              PERFORM GNS-PRO-QUE.
       FIN-GNX-PRO-QUE.
           EXIT.

      * JCD-INI 23-OCT-2012 TXN LENTAS
       RDC-SIG-ESTADO-1 SECTION.
      *=======================
       INI-RDC-SIG-ESTADO-1.
      *-------------------
      * VE SI SE DEBE SALTAR LA RDC
      *
           MOVE FIO-GET-NXT TO FIO-CMND.                                
       LUP-RDC-SIG-ESTADO-1.
      *-------------------
           PERFORM COL-FIO-RDC.                                         

           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-RDC-SIG-ESTADO-1.
                                                                        
           IF RDC-CIC-ICLI IN RDC NOT = DBC-CIC-ICLI IN DBC             
              GO TO FIN-RDC-SIG-ESTADO-1.

      * SI ESTADO = SPACES BUSCA OPERACIONES ACTIVAS
           IF FRM-COD-STAT IN CCC-FLD  = SPACES                         
      *MVG-INI 28-MAY-2019 IGUALACION COL    
      *       IF RDC-IND-EOPC IN RDC   =  SPACES
              IF RDC-IND-EOPC IN RDC  NOT >  SPACES
      *MVG-FIN 28-MAY-2019 IGUALACION COL
                 GO TO FIN-RDC-SIG-ESTADO-1
              ELSE
                 GO TO LUP-RDC-SIG-ESTADO-1.

           GO TO FIN-RDC-SIG-ESTADO-1.

       FIN-RDC-SIG-ESTADO-1.
      *-------------------
              EXIT.
      * JCD-FIN 23-OCT-2012 TXN LENTAS
      * JCD-FIN 23-OCT-2012 TXN LENTAS
      *AFRI-INI 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
       ANALIZA-CAN SECTION.
       INI-ANALIZA-CAN.

           MOVE OPC-CAI-IOPC IN OPC TO CAN-CAI-IOPC IN CAN.
           MOVE OPC-IIC-IOPC IN OPC TO CAN-IIC-IOPC IN CAN
           MOVE 999                 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-ANALIZA-CAN.
           PERFORM COL-FIO-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN OPC = CAN-CAI-IOPC IN CAN AND
                    OPC-IIC-IOPC IN OPC = CAN-IIC-IOPC IN CAN )
              MOVE ZEROES TO CAN-NUM-ICAN IN CAN
              GO TO FIN-ANALIZA-CAN.

           IF NOT ( CAN-MSC-STAT IN CAN = 'R'  OR
                    CAN-MSC-STAT IN CAN = 'A' )
              MOVE ZEROES TO CAN-NUM-ICAN IN CAN
              GO TO FIN-ANALIZA-CAN.

           IF CAN-MSC-CANC IN CAN = 'RTT' OR
              CAN-MSC-CANC IN CAN = 'KTT' OR
              CAN-MSC-CANC IN CAN = 'NTT' OR
              CAN-MSC-CANC IN CAN = 'PTT'
              MOVE ZEROES TO CAN-NUM-ICAN IN CAN
              GO TO FIN-ANALIZA-CAN.

           IF CAN-MSC-STAT IN CAN = 'R'     OR
              CAN-SGV-TPAG IN CAN < ZEROES  OR
              CAN-SGV-DIFE IN CAN < ZEROES  OR
              CAN-SGV-TREN IN CAN < ZEROES
              MOVE FIO-GET-PRV TO FIO-CMND
              GO TO LUP-ANALIZA-CAN.

           IF CAN-FEC-FOUT IN CAN < WSS-FEC-FCMP IN WSS-VARI
              MOVE ZEROES TO CAN-NUM-ICAN IN CAN
              GO TO FIN-ANALIZA-CAN.

       FIN-ANALIZA-CAN.
           EXIT.

      *MHM-INI 24-AGO-2012
       ANALIZA-CAN-ING SECTION.
       INI-ANALIZA-CAN-ING.

           MOVE OPC-CAI-IOPC IN OPC TO CAN-CAI-IOPC IN CAN.
           MOVE OPC-IIC-IOPC IN OPC TO CAN-IIC-IOPC IN CAN
           MOVE 999                 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-ANALIZA-CAN-ING.
           PERFORM COL-FIO-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN OPC = CAN-CAI-IOPC IN CAN AND
                    OPC-IIC-IOPC IN OPC = CAN-IIC-IOPC IN CAN )
              MOVE ZEROES TO CAN-NUM-ICAN IN CAN
              GO TO FIN-ANALIZA-CAN-ING.

      *     IF NOT CAN-MSC-STAT IN CAN = 'V' OR
      *        CAN-MSC-CANC IN CAN = 'RTT'
      *        MOVE ZEROES TO CAN-NUM-ICAN IN CAN
           IF NOT CAN-MSC-STAT IN CAN = 'V'
              MOVE ZEROES TO CAN-NUM-ICAN IN CAN
              GO TO FIN-ANALIZA-CAN-ING.

       FIN-ANALIZA-CAN-ING.
           EXIT.

       ANALIZA-CAN-V SECTION.
       INI-ANALIZA-CAN-V.

           MOVE OPC-CAI-IOPC IN OPC TO CAN-CAI-IOPC IN CAN.
           MOVE OPC-IIC-IOPC IN OPC TO CAN-IIC-IOPC IN CAN
           MOVE 999                 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-ANALIZA-CAN-V.
           PERFORM COL-FIO-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN OPC = CAN-CAI-IOPC IN CAN AND
                    OPC-IIC-IOPC IN OPC = CAN-IIC-IOPC IN CAN )
              MOVE ZEROES TO CAN-NUM-ICAN IN CAN
              GO TO FIN-ANALIZA-CAN-V.

      *     IF NOT (CAN-MSC-STAT IN CAN = 'C' AND
      *              CAN-MSC-CANC IN CAN = 'RTT' )
      *        MOVE ZEROES TO CAN-NUM-ICAN IN CAN
           IF NOT CAN-MSC-STAT IN CAN = 'C'
              MOVE ZEROES TO CAN-NUM-ICAN IN CAN
              GO TO FIN-ANALIZA-CAN-V.

       FIN-ANALIZA-CAN-V.
           EXIT.
      *MHM-FIN 24-AGO-2012


       BUS-FEC-FNDR SECTION.
       INI-BUS-FEC-FNDR.

           PERFORM GET-FHOY.
           MOVE HOY-DHOY       TO WSS-NUM-DCMP IN WSS-VARI.
           MOVE HOY-MHOY       TO WSS-NUM-MCMP IN WSS-VARI.
           MOVE HOY-SHOY       TO WSS-NUM-SCMP IN WSS-VARI.
           MOVE HOY-AHOY       TO WSS-NUM-ACMP IN WSS-VARI.

           MOVE ZEROES         TO WSS-NUM-DMNX IN WSS-VARI.
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'NDR'          TO TAB-COD-TTAB IN TAB.
           MOVE SPACES         TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
              TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-BUS-FEC-FNDR.

           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-MNDR IN WSS-VARI.

           IF WSS-NUM-DREV IN WSS-VARI NOT NUMERIC
              GO TO FIN-BUS-FEC-FNDR.

           IF WSS-NUM-DREV IN WSS-VARI = ZEROES
              GO TO FIN-BUS-FEC-FNDR.

           MOVE HOY-DHOY                 TO WSS-NUM-DMIN IN WSS-VARI.
           MOVE HOY-MHOY                 TO WSS-NUM-MMIN IN WSS-VARI.
           MOVE HOY-SHOY                 TO WSS-NUM-SMIN IN WSS-VARI.
           MOVE HOY-AHOY                 TO WSS-NUM-AMIN IN WSS-VARI.
       LUP-BUS-FEC-FNDR.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FINI.
           MOVE WSS-FEC-FINI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE WSS-FEC-FINI IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              GO TO LUP-BUS-FEC-FNDR.

           MOVE WSS-FEC-FINI IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI

           ADD 1 TO WSS-NUM-DMNX IN WSS-VARI.

           IF WSS-NUM-DMNX IN WSS-VARI NOT = WSS-NUM-DREV IN WSS-VARI
              GO TO LUP-BUS-FEC-FNDR.

           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DCMP IN WSS-VARI.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MCMP IN WSS-VARI.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SCMP IN WSS-VARI.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-ACMP IN WSS-VARI.

       FIN-BUS-FEC-FNDR.
           EXIT.
      *AFRI-FIN 06-NOV-2014 NUEVAS FUNCIONALIDADES        *
      *>>>>
