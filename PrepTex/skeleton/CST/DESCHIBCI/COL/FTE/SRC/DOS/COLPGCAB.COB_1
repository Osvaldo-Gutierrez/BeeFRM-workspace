       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGCAB.
       AUTHOR.          BEE TEAM (EX-CONSIST).
       DATE-WRITTEN.
      * Programa Seleccionador de Cancelaciones para el Archivo CAB.
      * Autor: RBG / 02-DIC-1996.
      *
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *=====================
       SPECIAL-NAMES.
           DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *====================
       FILE-CONTROL.
           SELECT GNSSRT         ASSIGN TO DA-S-SORTWK1.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD GNSSRT.
       01  SRT.
           03 SRT-CIC-IOPC                             PIC X(12).
           03 SRT-NUM-ICAN                             PIC 9(03).
           03 SRT-MSC-STAT                             PIC X(01).
           03 SRT-FEC-FOUT.
              05 SRT-NUM-SOUT                          PIC 9(02).
              05 SRT-NUM-AOUT                          PIC 9(02).
              05 SRT-NUM-MOUT                          PIC 9(02).
              05 SRT-NUM-DOUT                          PIC 9(02).
           03 SRT-SGV-TPAG                             PIC S9(11)V9(04).
           03 SRT-SGV-TREN                             PIC S9(11)V9(04).
           03 SRT-COD-OFCA                             PIC X(03).
           03 SRT-IIC-ICYA                             PIC X(08).
           03 SRT-SGV-TCOM                             PIC S9(11)V9(05).
           03  SRT-GLS-ANO.
               05 SRT-GLS-ANO1                         PIC X(01).
               05 SRT-GLS-ANO2                         PIC X(01).

       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
      *VFP-INI  17-MAR-1998
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-CAN-REQA==.
      *VFP-FIN  17-MAR-1998
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAB-REQA==.
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
      *ALD-BCI-INI/16041998
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
      *ALD-BCI-FIN/16041998
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.

      *<<<< WSS
       COPY COLWGINT.
       COPY COLWGVEN.
       COPY COLBRCOM.
       COPY COLBRICG.
       COPY SGCBRDBC.
       COPY COLBRDLC.
       COPY COLBRRCV.
       COPY COLBRRDC.
       COPY COLBRCYA.
       COPY SGCBRDCP.
       COPY SGCBRDCE.
      *ALD-BCI-INI/16041998
       COPY SGCBROPE.
      *ALD-BCI-FIN/16041998
       COPY COLBROPC.
       COPY COLBRVEN.
       COPY COLBRCAN.
       COPY COLBRCAB.
      * COPY COLBRCAV.
       COPY COLBRTOC.
       COPY TABBRTIO.
       COPY TABBRCAM.
       COPY COLBREVC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.

       01  WSS-VARI.
           03  WSS-NUM-RLEI           VALUE ZEROES     PIC 9(06).
      *VFP-INI 20-03-1998
           03  WSS-NUM-RCAN           VALUE ZEROES     PIC 9(06).
           03  WSS-NUM-RICG           VALUE ZEROES     PIC 9(06).
           03  WSS-NUM-RCYA           VALUE ZEROES     PIC 9(06).
      *VFP-FIN 20-03-1998
           03  WSS-NUM-RGRA           VALUE ZEROES     PIC 9(06).
           03  WSS-OPEC                                PIC X(01).
           03  WSS-FEC-FPRO.
               05  WSS-NUM-DPRO                        PIC 9(02).
               05  WSS-NUM-MPRO                        PIC 9(02).
               05  WSS-NUM-SPRO                        PIC 9(02).
               05  WSS-NUM-APRO                        PIC 9(02).
           03  WSS-FEC-FPRI.
               05  WSS-NUM-SPRI                        PIC 9(02).
               05  WSS-NUM-APRI                        PIC 9(02).
               05  WSS-NUM-MPRI                        PIC 9(02).
               05  WSS-NUM-DPRI                        PIC 9(02).
           03  WSS-FEC-FTOP.
               05  WSS-NUM-STOP       VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-ATOP       VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-MTOP       VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-DTOP       VALUE ZEROES     PIC 9(02).
      * Variable para desplegar o no los Display del Programa.
           03  WSS-IND-DISP           VALUE 'S'        PIC X(01).
      *
           03  WSS-MSC-TVOC                            PIC X(06).
           03  WSS-COD-PESO                            PIC X(06).
           03  WSS-GLS-ANO.
               05  WSS-GLS-ANO1                        PIC X(01).
               05  WSS-GLS-ANO2                        PIC X(01).
           03  WSS-GLS-DATA.
               05 WSS-GLS-DIAS                         PIC X(03).
               05  WSS-NUM-DIAS       REDEFINES
                   WSS-GLS-DIAS                        PIC 9(03).
               05 WSS-COD-MONE                         PIC X(06).
               05 WSS-GLS-MOUF                         PIC X(07).
               05  WSS-VAL-MOUF       REDEFINES
                   WSS-GLS-MOUF                        PIC 9(03)V9(04).
               05 WSS-GLS-TOPE                         PIC X(03).
               05  WSS-NUM-TOPE       REDEFINES
                   WSS-GLS-TOPE                        PIC 9(03).
               05 WSS-COD-CCOD        OCCURS 08        PIC X(05).
           03  WSS-GLS-DAT3           VALUE SPACES     PIC X(60).

           03  WSS-TBAN               REDEFINES
                   WSS-GLS-DAT3       OCCURS 20        PIC X(03).
           03  MOV-I                                   PIC 9(02).
           03  WSS-GLS-CMO.
               05 WSS-GLS-CMO1        VALUE SPACES     PIC X(16).
               05 WSS-GLS-CMO2        VALUE SPACES     PIC X(03).
               05 FILLER              VALUE SPACES     PIC X(41).
           03  WSS-COD-BANC                            PIC X(03).
           03  WSS-IND-MORA                            PIC X(01).
           03  WSS-IND-EBAN                            PIC X(01).
           03  WSS-IND-EXIS                            PIC X(01).
           03  WSS-SGV-VCAM                            PIC S9(11)V9(04).
           03  WSS-GLS-DAT2.
               05 WSS-GLS-PIVA                         PIC X(10).
               05 WSS-NUM-PIVA        REDEFINES
                  WSS-GLS-PIVA                         PIC  9(06)V9(04).
           03  WSS-VAL-IVA    COMP-3  VALUE ZEROES     PIC  9(02)V9(04).
           03  WSS-SGV-TCOM   COMP-3  VALUE ZEROES     PIC S9(11)V9(05).
           03  WSS-SGV-NETO   COMP-3  VALUE ZEROES     PIC S9(11)V9(04).
           03  WSS-SGV-MIVA   COMP-3  VALUE ZEROES     PIC S9(09)V9(04).
      *VFP-INI 18-MAR-1998
           03  WSS-SGV-VECO   COMP-3  VALUE ZEROES     PIC S9(11)V9(05).
      *VFP-FIN 18-MAR-1998
           03  WSS-NUM-TOP1                            PIC  9(03).
           03  WSS-NUM-1HBL           VALUE ZEROES     PIC 9(02).
           03  WSS-IND-FERI                            PIC X(01).
           03  WSS-NUM-CONT           VALUE ZEROES     PIC 9(02).
           03  WSS-NUM-CON1           VALUE ZEROES     PIC 9(06).
           03  WSS-COD-CAN                             PIC X(03).
           03  WSS-COD-SVCD           VALUE LOW-VALUES PIC X(08).
           03  WSS-COD-CCCC           VALUE SPACES     PIC X(02).
           03  WSS-IND-CHEK           VALUE 'N'        PIC X(01).
           03  WSS-CIC-IOPC           VALUE SPACES     PIC X(12).
      *ALD-BCI-INI/20041998
           03  WSS-CYA-CIC-ICYA.
               05  WSS-CYA-CAI-ICYA                    PIC X(04).
               05  WSS-CYA-IIC-ICYA                    PIC X(08).
      *ALD-BCI-FIN/20041998
      *
      *INI-JGM 24-05-200.
           03 WSS-COD-CCM.
               05 WSS-COD-TBAN                         PIC X(03).
               05 WSS-NUM-TRAM                         PIC 9(03).
               05 WSS-VAL-TRAM                         PIC 9(06).
      *
           03 WSS-GLS-CCM.
              05 WSS-GLS-TBAN                          PIC X(03).
              05 WSS-GLS-NTRA                          PIC X(03).
              05 WSS-GLS-VTRA                          PIC X(06).
      *
           03 WSS-VAL-TPUF                             PIC 9(06).
      *FIN-JGM 24-05-2000.
      *


       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPGCAB' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           SORT GNSSRT
           ON ASCENDING KEY SRT-FEC-FOUT IN SRT
           ON ASCENDING KEY SRT-CIC-IOPC IN SRT
           ON ASCENDING KEY SRT-NUM-ICAN IN SRT
           INPUT PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
      *     PERFORM OPEN-FILE.
      *     PERFORM INI-VAR.
      *     PERFORM PRO-CAN.
      *     PERFORM CLOSE-FILE.
      *     PERFORM MUESTRA-ESTADISTICAS.

       FIN-MAIN.
           PERFORM GNS-PRO-END.
      ******************************************************************
       INP-SRT SECTION.
      ****************
       INI-INP-SRT.
           PERFORM OPEN-FILE.
           PERFORM INI-VAR.
           PERFORM PRO-CAN.
       FIN-INP-SRT.
           EXIT.

      ******************************************************************
       OUT-SRT SECTION.
      ****************
       INI-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO EXT-OUT-SRT.
       LUP-OUT-SRT.
           PERFORM GRA-REG-CAB.
           RETURN GNSSRT AT END
                GO TO EXT-OUT-SRT.
           GO TO LUP-OUT-SRT.
       EXT-OUT-SRT.
           PERFORM CLOSE-FILE.
           PERFORM MUESTRA-ESTADISTICAS.
       FIN-OUT-SRT.
           EXIT.
      ******************************************************************
       OPEN-FILE SECTION.
      *******************
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
      *     PERFORM COL-FIO-CAV.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-VEN.
           MOVE 'COL' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-CAB.
       FIN-OPEN-FILE.
           EXIT.

      ******************************************************************
       INI-VAR SECTION.
      *****************
       INI-INI-VAR.
           DISPLAY 'INICIO CAPTURA DE PARAMETROS '.
           DISPLAY '============================ '.
      * Captura Fecha de Proceso.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY ' '.
           DISPLAY 'FECHA DE PROCESO (*DDMMSSAA): ' WSS-FEC-FPRO
                                                         IN WSS-VARI.
      * Captura Indicador para desplegar los Display en el programa.
           ACCEPT WSS-IND-DISP IN WSS-VARI.
           DISPLAY 'INDICADOR DE DISPLAY (S/N)  : ' WSS-IND-DISP
                                                            IN WSS-VARI.
      * Valida codigo de display (S/N).
           IF WSS-IND-DISP IN WSS-VARI NOT = ('S' AND 'N')
               DISPLAY 'Lo siento, codigo de Display no es valido, '
               DISPLAY 'Debe Ingresar S o N '
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.

      * VAL-FEC VALIDA FECHA PROCESO.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'FECPROCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.
      *
      * Muevo Fechas DD-MM-SSAA a Formato SSAA-MM-DD.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRI IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRI IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRI IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRI IN WSS-VARI.
           DISPLAY 'FECHA DE PROCESO            : 'WSS-FEC-FPRO IN
                                                            WSS-VARI.
           DISPLAY ' '.
      *
      * Obtiene COD movimiento mediante el CIC.
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'MVT'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'CAN'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'       TO MSG-COD-SIST
               MOVE 'CICCANNEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CAN IN WSS-VARI.
      *
      * Busco el CIC de la moneda.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICPESONEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'CICTVAL0NEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.
           MOVE MSC-COD-CMSC IN MSC TO WSS-MSC-TVOC IN WSS-VARI.
      *
      * Busco codigo de situacion contable "VENCIDA".
           MOVE 'COL'          TO MSC-COD-SIST.
           MOVE 'SCTB'         TO MSC-CIC-TMSC IN MSC.
           MOVE 'VCD'          TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = SPACES
               MOVE MSC-COD-CMSC IN MSC TO WSS-COD-SVCD
           ELSE
               DISPLAY 'ABORTO : SIS = COL, MSC = SCTB, '
                       'MSC-CIC-CMSC = VCD'
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.

      *----------------------------------------------------------*
      *INI-JGM 25-05-2000.
      * Voy a buscar a la tabla COBRO COMISION BANCA los tipos de Banca.
      *    MOVE 'COL'       TO FIO-SIST.
      *    MOVE 'CCB'       TO TAB-COD-TTAB IN TAB.
      *    MOVE SPACES      TO TAB-COD-CTAB IN TAB.
      *    MOVE FIO-GET-KEY TO FIO-CMND.
      *    PERFORM GNS-FIO-TAB.
      *    IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
      *        DISPLAY 'ERROR: NO EXISTE O NO VIGENTE TABLA CCB'
      *        DISPLAY 'PROCESO CANCELADO...'
      *        PERFORM GNS-PRO-ABT.
      *
      *    MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DAT3 IN WSS-VARI.
      *
      *    IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'TABLA CCB: 'WSS-GLS-DAT3 IN WSS-VARI.
      *
      * Voy a buscar el Monto Neto, Moneda, No. de Dias Inicio y Tope.
      *    MOVE 'COL'       TO FIO-SIST.
      *    MOVE 'CMO'       TO TAB-COD-TTAB IN TAB.
      *    MOVE SPACES      TO TAB-COD-CTAB IN TAB.
      *    MOVE FIO-GET-KEY TO FIO-CMND.
      *    PERFORM GNS-FIO-TAB.
      *    IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
      *        DISPLAY 'ERROR: NO EXISTE O NO VIGENTE TABLA CMO'
      *        DISPLAY 'PROCESO CANCELADO...'
      *        PERFORM GNS-PRO-ABT.
      *
      *    MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.
      *    MOVE WSS-GLS-DATA IN WSS-VARI TO WSS-GLS-CMO IN WSS-VARI.
      *    IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'TABLA CMO: 'WSS-GLS-DATA IN WSS-VARI.
      *        DISPLAY 'TABLA CMO: 'WSS-GLS-CMO1 IN WSS-VARI.
      *
      *    IF WSS-NUM-DIAS IN WSS-VARI IS NOT NUMERIC
      *        DISPLAY 'ERROR: INICIO DE RANGO TABLA CMO NO NUMERICO'
      *        DISPLAY 'PROCESO CANCELADO...'
      *        PERFORM GNS-PRO-ABT.
      *
      *    IF WSS-NUM-TOPE IN WSS-VARI IS NOT NUMERIC
      *        DISPLAY 'ERROR: TOPE DE RANGO TABLA CMO NO NUMERICO'
      *        DISPLAY 'PROCESO CANCELADO...'
      *        PERFORM GNS-PRO-ABT.
      *
      *    IF WSS-VAL-MOUF IN WSS-VARI NOT NUMERIC
      *        DISPLAY 'ERROR: MONTO MONEDA TABLA CMO NO NUMERICO'
      *        DISPLAY 'PROCESO CANCELADO...'
      *        PERFORM GNS-PRO-ABT.
      *FIN-JGM 35-05-2000.
      *----------------------------------------------------------*
      * Voy a buscar el Iva.
           MOVE 'TAB'       TO FIO-SIST.
           MOVE 'IVA'       TO TAB-COD-TTAB IN TAB.
           MOVE SPACES      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
               DISPLAY 'ERROR: NO EXISTE TABLA IVA'
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.

           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DAT2 IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'TABLA IVA: 'WSS-GLS-DAT2 IN WSS-VARI.

           IF WSS-NUM-PIVA IN WSS-VARI NOT NUMERIC
               DISPLAY 'ERROR: PORCENTAJE NO NUMERICO EN TABLA IVA'
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.

      *INICIALIZO CAB
           MOVE SPACES TO CAB.
           MOVE ZEROES TO CAB-SGV-MNTO IN CAB.
           MOVE ZEROES TO CAB-FEC-FMVO IN CAB.
       FIN-INI-VAR.
           EXIT.

      ******************************************************************
       PRO-CAN SECTION.
      *****************
       INI-PRO-CAN.
           MOVE SPACES TO WSS-CIC-IOPC IN WSS-VARI.
           MOVE 'N' TO WSS-IND-CHEK IN WSS-VARI.
           MOVE WSS-NUM-DPRI IN WSS-VARI TO CAN-NUM-DOUT IN CAN.
           MOVE WSS-NUM-MPRI IN WSS-VARI TO CAN-NUM-MOUT IN CAN.
           MOVE WSS-NUM-SPRI IN WSS-VARI TO CAN-NUM-SOUT IN CAN.
           MOVE WSS-NUM-APRI IN WSS-VARI TO CAN-NUM-AOUT IN CAN.
           MOVE 'CAN-FEC-FOUT' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CAN.
       LUP-BUS-CAN.

           IF CAN-FEC-FOUT IN CAN NOT = WSS-FEC-FPRI IN WSS-VARI
               GO TO NXT-PRO-CAN.

           IF CAN-CIC-IOPC IN CAN = WSS-CIC-IOPC IN WSS-VARI AND
              WSS-IND-CHEK IN WSS-VARI = 'S'
               GO TO NXT-PRO-CAN
           ELSE
               MOVE 'N' TO WSS-IND-CHEK IN WSS-VARI.

      * Esto es para las estadisticas.
           ADD 1 TO WSS-NUM-RLEI IN WSS-VARI.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CANCELACION LEIDA       : 'CAN-CIC-IOPC IN CAN
               '  NUMERO: 'CAN-NUM-ICAN IN CAN.

      * La primera posicion del CAI debe ser solo 'D'.
           IF CAN-COD-TOPC IN CAN NOT = 'D'
               GO TO NXT-PRO-CAN.

      * Verifica estado de las Cancelaciones.
           IF CAN-MSC-STAT IN CAN NOT = 'A'
               GO TO NXT-PRO-CAN.

      * Esto lo puse para chequear que la can no haya sido reversada.
           IF (CAN-SGV-TPAG IN CAN < ZEROES) OR
              (CAN-SGV-TREN IN CAN < ZEROES)
               GO TO NXT-PRO-CAN.

      * Verifico si es con Cargo en Cuenta Corriente.
           PERFORM BUS-CIC-CTA.
           IF MSG-COD-MENS IN MSG > SPACES
               GO TO NXT-PRO-CAN.

      *ALD-BCI-INI/20041998
           MOVE CYA-CIC-ICYA IN CYA TO WSS-CYA-CIC-ICYA IN WSS-VARI.
      *ALD-BCI-FIN/20041998

      *ALD-BCI-INI/16041998
           PERFORM LEE-OPE.
           IF MSG-COD-MENS IN MSG > SPACES
               GO TO NXT-PRO-CAN.
      *ALD-BCI-FIN/16041998

      * Acceso a la OPC.
           PERFORM LEE-OPC.
           IF MSG-COD-MENS IN MSG > SPACES
               DISPLAY 'FALLO LECTURA OPC: '
               GO TO NXT-PRO-CAN.

      *ALD-BCI-INI/01.02.1999
      * Leo el DLC.
           PERFORM LEE-DLC.
           IF MSG-COD-MENS IN MSG > SPACES
               DISPLAY 'FALLO LECTURA DLC: '
               GO TO NXT-PRO-CAN.
           IF DLC-IND-SCTB IN DLC = 'VCD' OR
              DLC-IND-SCTB IN DLC = 'CAS'
               GO TO NXT-PRO-CAN.
      *ALD-BCI-FIN/01.02.1999


      * Busca Dato Opera Como 'COMO OPERA = WSS-OPEC'.
           PERFORM BUS-DAT-OPEC.
           IF MSG-COD-MENS IN MSG > SPACES
               DISPLAY 'FALLO LECTURA TOC'
               GO TO NXT-PRO-CAN.
           IF WSS-OPEC = 'B' OR 'D'
               GO TO NXT-PRO-CAN.

      * Leo el VEN.
           PERFORM LEE-VEN.
           IF MSG-COD-MENS IN MSG > SPACES
               DISPLAY 'FALLO LECTURA VEN: '
               GO TO NXT-PRO-CAN.

      * Verifica si se le cobra Comision para grabarlo en el archivo CAB
           PERFORM CHK-EXI-COMI.

           IF WSS-IND-MORA IN WSS-VARI NOT = 'S'
               GO TO NXT-PRO-CAN.

      * Esto es para las Estadisticas.
           ADD 1 TO WSS-NUM-CON1 IN WSS-VARI.

      * Muestra las Cancelaciones segun indicador DISPLAY.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'CANCELACION SELECCIONADA: 'CAN-CIC-IOPC IN CAN
               '  NUMERO: 'CAN-NUM-ICAN IN CAN.
      * Graba Registros en Archivo CAB.
           MOVE CAN-NUM-AOUT IN CAN TO WSS-GLS-ANO IN WSS-VARI.
      *     PERFORM GRA-REG-CAB.
            PERFORM GRA-REG-SORT.
       NXT-PRO-CAN.
           MOVE 'CAN-FEC-FOUT' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
               GO TO LUP-BUS-CAN.
       FIN-PRO-CAN.
           EXIT.

      ******************************************************************
       BUS-DAT-OPEC SECTION.
      *********************
       INI-BUS-DAT-OPEC.
      * BUSCA DATO 'COMO OPERA=WSS-OPEC'
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CANTOOCNEX'
               MOVE 'ERROR' TO MSG-COD-MENS IN MSG
               GO TO FIN-BUS-DAT-OPEC.
           MOVE TOC-MSC-OPEC IN TOC TO WSS-OPEC.
       FIN-BUS-DAT-OPEC.
           EXIT.

      ******************************************************************
       CHK-EXI-COMI SECTION.
      *********************
       INI-CHK-EXI-COMI.
           MOVE 'N'    TO WSS-IND-MORA IN WSS-VARI.
           MOVE SPACES TO WSS-IND-EBAN IN WSS-VARI.

           MOVE CAN-CIC-IOPC IN CAN TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CIC-IOPC IN CAN = RDC-CIC-IOPC IN RDC )
                     DISPLAY 'ERROR: NO EXISTE RDC ASOCIADA A CAN : '
                            CAN-CIC-IOPC IN CAN
                     GO TO END-CHK-EXI-COMI.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO EXISTE DBC ASOCIADA A RDC : '
                      RDC-CIC-ICLI IN RDC
               GO TO END-CHK-EXI-COMI.
      *    IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'TIPO DE CLIENTE         : ' DBC-IND-TICL IN DBC.

           IF DBC-IND-TICL IN DBC = 'P'
               MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCP
               IF NOT FIO-STAT-OKS
                   DISPLAY 'ERROR: NO EXISTE DCP ASOCIADA A DBC : '
                          DBC-CIC-ICLI IN DBC
                   GO TO END-CHK-EXI-COMI
               ELSE
                   MOVE DCP-COD-TBAN IN DCP TO WSS-COD-BANC IN WSS-VARI
                   PERFORM CHK-EXI-TBAN-CCM
                   IF WSS-IND-EBAN IN WSS-VARI = 'S'
                       GO TO SIG-CON-BANC
                   ELSE
                       GO TO END-CHK-EXI-COMI
           ELSE
              IF DBC-IND-TICL IN DBC = 'E'
                 MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM SGC-FIO-DCE
                 IF NOT FIO-STAT-OKS
                      DISPLAY 'ERROR: NO EXISTE DCE ASOCIADA A DBC : '
                              DBC-CIC-ICLI IN DBC
                      GO TO END-CHK-EXI-COMI
                 ELSE
                      MOVE DCE-COD-TBAN IN DCE TO WSS-COD-BANC
                                                             IN WSS-VARI
                      PERFORM CHK-EXI-TBAN-CCM
                      IF WSS-IND-EBAN IN WSS-VARI = 'S'
                          GO TO SIG-CON-BANC
                      ELSE
                          GO TO END-CHK-EXI-COMI.

       SIG-CON-BANC.
           PERFORM RST-DIA-HBLS.

      *    IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'AL SALIR RST-DIA-HBLS   : '
      *            WSS-IND-MORA IN WSS-VARI.

           IF WSS-IND-MORA IN WSS-VARI NOT = 'S'
               GO TO END-CHK-EXI-COMI.

           IF WSS-COD-MONE IN WSS-VARI = '0999  '
               MOVE 1 TO WSS-SGV-VCAM IN WSS-VARI
               GO TO CONT-SIN-VCAM.

           MOVE WSS-COD-MONE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999  '                 TO CAM-COD-VCAM IN CAM(2).
           MOVE CAN-NUM-DCAN IN CAN      TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAN-NUM-MCAN IN CAN      TO CAM-NUM-MCAM IN CAM(1).
           MOVE CAN-NUM-SCAN IN CAN      TO CAM-NUM-SCAM IN CAM(1).
           MOVE CAN-NUM-ACAN IN CAN      TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO : '
                   CAM-KEY-CAMB IN CAM
               MOVE ZEROES TO WSS-SGV-VCAM
               MOVE 'N'    TO WSS-IND-MORA IN WSS-VARI
               GO TO END-CHK-EXI-COMI
           ELSE
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM.

       CONT-SIN-VCAM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC     TO COM-CIC-IOPC IN COM.
           MOVE ZEROES                  TO COM-NUM-ICAN IN COM.
           MOVE SPACES                  TO COM-CIC-IOPV IN COM.
           MOVE ZEROES                  TO COM-NUM-IVCT IN COM.
           MOVE SPACES                  TO COM-IND-TTAS IN COM.
           MOVE ZEROES                  TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-FEC-COM.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
               COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC )
               NEXT SENTENCE
           ELSE
               IF COM-IND-TTAS IN COM NOT = 'CMO'
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-FEC-COM
               ELSE
                   IF CAN-NUM-SOUT IN CAN = COM-NUM-SINI IN COM AND
                      CAN-NUM-AOUT IN CAN = COM-NUM-AINI IN COM AND
                      CAN-NUM-MOUT IN CAN = COM-NUM-MINI IN COM AND
                      CAN-NUM-DOUT IN CAN = COM-NUM-DINI IN COM
                      IF COM-MSC-STAT IN COM = 'R' OR
                         COM-SGV-MNTO IN COM < ZEROES
                          MOVE FIO-GET-NXT TO FIO-CMND
                          GO TO LUP-FEC-COM
                       ELSE
                           MOVE 'N' TO WSS-IND-MORA IN WSS-VARI
                           GO TO END-CHK-EXI-COMI
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-FEC-COM.

      * Multiplico por el Valor de Cambio
           MULTIPLY WSS-VAL-MOUF IN WSS-VARI
                 BY WSS-SGV-VCAM IN WSS-VARI
             GIVING WSS-SGV-NETO IN WSS-VARI.

           DIVIDE WSS-NUM-PIVA IN WSS-VARI BY 100
           GIVING WSS-VAL-IVA  IN WSS-VARI.

           MULTIPLY WSS-SGV-NETO IN WSS-VARI
                 BY WSS-VAL-IVA  IN WSS-VARI
             GIVING WSS-SGV-MIVA IN WSS-VARI.

           MOVE WSS-SGV-MIVA IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-MIVA IN WSS-VARI.

           MOVE WSS-SGV-NETO IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-NETO IN WSS-VARI.

           COMPUTE WSS-SGV-TCOM IN WSS-VARI = WSS-SGV-MIVA IN WSS-VARI +
                                               WSS-SGV-NETO IN WSS-VARI.
      *VFP-INI  17-MAR-1998
      *VERIFICA QUE LOS GASTOS SEAN ZEROES, EN CASO DE QUE EL
      *PROGRAMA SE ESTE REPROCESANDO.
           IF CAN-SGV-GAST IN CAN > ZEROES
                GO TO END-CHK-EXI-COMI.
      *RESPALDA REQA DE LA ACTUAL CAN
           MOVE ADR-CAN-REQA TO AUX-CAN-REQA.
      *LEE POR LLAVE PRIMARIA POR LLAVE PRIMARIA
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
      *ACTUALIZA VALOR PAGADO
           MOVE ZEROES TO WSS-SGV-VECO IN WSS-VARI.
           ADD CAN-SGV-TPAG IN CAN TO WSS-SGV-VECO IN WSS-VARI.
           ADD WSS-SGV-TCOM IN WSS-VARI TO WSS-SGV-VECO IN WSS-VARI.
           MOVE WSS-SGV-VECO IN WSS-VARI TO CAN-SGV-TPAG IN CAN.
      *ACTUALIZA VALOR GASTOS
           MOVE WSS-SGV-TCOM IN WSS-VARI TO CAN-SGV-GAST.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
             ADD 1 TO WSS-NUM-RCAN IN WSS-VARI
           ELSE
             DISPLAY 'ERROR: NO SE ACTUALIZO CAN, STATUS: ' FIO-STAT.
      *ACTUALIZA VALOR LIQUIDO
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
                CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
                    DISPLAY 'ERROR: NO EXISTE CYA PARA  '
                            CAN-CIC-IOPC IN CAN
                    GO TO END-CHK-EXI-COMI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           MOVE WSS-SGV-VECO IN WSS-VARI TO CYA-SGV-LIQU IN CYA.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS
             ADD 1 TO WSS-NUM-RCYA IN WSS-VARI
           ELSE
             DISPLAY 'ERROR: NO SE ACTUALIZO CYA, STATUS: ' FIO-STAT.
      *GRABA REGISTRO ICG CON TIPO DE "CMO"
           PERFORM GRA-REG-COM.
      *RECURA REQA DE LA CAN ANTERIOR PARA HACER EL NEXT
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE AUX-CAN-REQA TO ADR-CAN-REQA.
      *VFP-FIN  17-MAR-1998
       END-CHK-EXI-COMI.
           EXIT.

      ******************************************************************
      *VFP-INI  18-MAR-1998
       GRA-REG-COM SECTION.
      *********************
       INI-GRA-REG-COM.
           MOVE WSS-SGV-MIVA IN WSS-VARI TO COM-SGV-MIVA IN COM.
           MOVE WSS-SGV-NETO IN WSS-VARI TO COM-SGV-MNTO IN COM.
           MOVE CAN-CAI-IOPC IN CAN      TO COM-CAI-IOPC IN COM.
           MOVE CAN-IIC-IOPC IN CAN      TO COM-IIC-IOPC IN COM.
           MOVE CAN-NUM-SOUT IN CAN      TO COM-NUM-SINI IN COM.
           MOVE CAN-NUM-AOUT IN CAN      TO COM-NUM-AINI IN COM.
           MOVE CAN-NUM-MOUT IN CAN      TO COM-NUM-MINI IN COM.
           MOVE CAN-NUM-DOUT IN CAN      TO COM-NUM-DINI IN COM.
           MOVE 'CMO'                    TO COM-IND-TTAS IN COM.
           MOVE CAN-NUM-ICAN IN CAN      TO COM-NUM-ICAN IN COM.
           MOVE CAN-CIC-IOPC IN CAN      TO COM-CIC-IOPV IN COM.
           MOVE VEN-NUM-IVEN IN VEN      TO COM-NUM-IVCT IN COM.
           MOVE ZEROES                   TO COM-FEC-FTRN IN COM.
           MOVE ZEROES                   TO COM-HRA-HRTR IN COM.
           MOVE SPACES                   TO COM-MSC-TACC IN COM.
           MOVE SPACES                   TO COM-MSC-STAT IN COM.
           MOVE SPACES                   TO COM-COD-OTRN IN COM.
           MOVE SPACES                   TO COM-COD-ATRN IN COM.
           MOVE SPACES                   TO COM-COD-TINT IN COM.
           MOVE ZEROES                   TO COM-FEC-FTER IN COM.
           MOVE ZEROES                   TO COM-SGV-SPRD IN COM.
           MOVE ZEROES                   TO COM-SGV-TINT IN COM.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-RICG IN WSS-VARI
           ELSE
               DISPLAY 'ERROR: NO SE GRABO ICG, STATUS: ' FIO-STAT.
       FIN-GRA-REG-COM.
           EXIT.
      *
      *VFP-FIN  18-MAR-1998
      ******************************************************************
      *LIM-TBAN SECTION.
      ****************
      *INI-LIM-TBAN.
      *    MOVE 1 TO MOV-I.
      *LUP-LIM-TBAN.
      *    IF MOV-I > 20
      *        GO TO FIN-LIM-TBAN.
      *    MOVE SPACES TO WSS-TBAN (MOV-I).
      *SIG-LIM-TBAN.
      *    ADD 1 TO MOV-I.
      *    GO TO LUP-LIM-TBAN.
      *FIN-LIM-TBAN.
      *    EXIT.

      *INI-JGM 24-05-2000.
       CHK-EXI-TBAN-CCM SECTION.
      *********************
       INI-CHK-EXI-TBAN-CCM.
      * Calculo el monto del Total pago tope
      *$(0999 ) ->  UF(0998 )  TOPE DE LA RENTA.
           MOVE 'S' TO WSS-IND-EBAN IN WSS-VARI.

           MOVE '0998  '                 TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999  '                 TO CAM-COD-VCAM IN CAM(2).
           MOVE CAN-NUM-DCAN IN CAN      TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAN-NUM-MCAN IN CAN      TO CAM-NUM-MCAM IN CAM(1).
           MOVE CAN-NUM-SCAN IN CAN      TO CAM-NUM-SCAM IN CAM(1).
           MOVE CAN-NUM-ACAN IN CAN      TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
               DISPLAY 'ERROR: NO EXISTE V.CAMBIO : '
                        CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT.


            MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM.
    *
           DIVIDE  CAN-SGV-TPAG IN CAN
               BY  WSS-SGV-VCAM IN WSS-VARI
           GIVING  WSS-VAL-TPUF IN WSS-VARI ROUNDED.

       CONT-SIN-VCAM-DIF-DIA.
      * Calculo el numero de dias que hay entre la FCAN y FVEN
           MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC1.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC1.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC1.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC1.
      *
           MOVE CAN-NUM-DCAN IN CAN TO FEC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN TO FEC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN TO FEC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN TO FEC-AEC2.
      *
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
      *
           MOVE FEC-NDIA TO WSS-NUM-TOP1 IN WSS-VARI.
      *
           MOVE WSS-COD-BANC IN WSS-VARI TO WSS-GLS-TBAN IN WSS-VARI.
           MOVE WSS-NUM-TOP1 IN WSS-VARI TO WSS-GLS-NTRA IN WSS-VARI.
           MOVE WSS-VAL-TPUF IN WSS-VARI TO WSS-GLS-VTRA IN WSS-VARI.
      *
           MOVE 'COL'       TO TAB-COD-SIST FIO-SIST.
           MOVE 'CCM'       TO TAB-COD-TTAB IN TAB.
           MOVE WSS-GLS-CCM TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
       NXT-SGT-CCM.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-COD-TTAB IN TAB NOT = 'CCM'
               IF WSS-IND-DISP IN WSS-VARI = 'S'
                   DISPLAY 'ERROR: NO TRAMO O MONTO PARA CCM: '
                           ' BANCA : ' WSS-GLS-TBAN IN WSS-VARI
                           ' TRAMO : ' WSS-NUM-TOP1 IN WSS-VARI
                           ' MONTO : ' WSS-VAL-TPUF IN WSS-VARI
      *
                   MOVE 'N' TO WSS-IND-EBAN IN WSS-VARI
                   GO TO FIN-CHK-EXI-TBAN-CCM
               ELSE
                   MOVE 'N' TO WSS-IND-EBAN IN WSS-VARI
                   GO TO FIN-CHK-EXI-TBAN-CCM.
      *
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CCM IN WSS-VARI.
      *
           IF  TAB-COD-TTAB IN TAB = 'CCM' AND
               WSS-GLS-TBAN IN WSS-VARI =
                               WSS-COD-TBAN IN WSS-VARI AND
               WSS-NUM-TOP1 IN WSS-VARI NOT >
                                      WSS-NUM-TRAM IN WSS-VARI AND
               WSS-VAL-TPUF IN WSS-VARI NOT >
                                        WSS-VAL-TRAM IN WSS-VARI
               NEXT SENTENCE
           ELSE
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO NXT-SGT-CCM.
      *
           IF TAB-IND-VIGE IN TAB NOT = 'S'
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO NXT-SGT-CCM.


           MOVE TAB-GLS-DATA IN TAB      TO WSS-GLS-DATA IN WSS-VARI.
           MOVE WSS-GLS-DATA IN WSS-VARI TO WSS-GLS-CMO  IN WSS-VARI.
      *
           MOVE WSS-NUM-TRAM IN WSS-VARI TO WSS-GLS-TOPE IN WSS-VARI.
           MOVE WSS-NUM-TRAM IN WSS-VARI TO WSS-GLS-CMO2 IN WSS-VARI.
      *
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'TAB CCM: '
                       ' INICIO-> ' WSS-GLS-DIAS IN WSS-VARI
                       ' MONEDA-> ' WSS-COD-MONE IN WSS-VARI
                       ' MNTO -> '  WSS-GLS-MOUF IN WSS-VARI
      *                ' TOPE-> '   WSS-GLS-TOPE IN WSS-VARI
      *
               DISPLAY 'TABLA CCM: 'WSS-GLS-CMO1 IN WSS-VARI
                                    WSS-GLS-CMO2 IN WSS-VARI.

           IF WSS-NUM-DIAS IN WSS-VARI IS NOT NUMERIC
               DISPLAY 'ERROR: INICIO DE RANGO TABLA CCM NO NUMERICO'
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.
      *
           IF WSS-VAL-MOUF IN WSS-VARI NOT NUMERIC
               DISPLAY 'ERROR: MONTO MONEDA TABLA CMO NO NUMERICO'
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.

           MOVE 'TAB'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'                    TO TAB-CIC-TTAB IN TAB.
           MOVE WSS-COD-MONE IN WSS-VARI TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: CODIGO MONEDA NO EXISTE EN TABLA VLR : '
                   WSS-COD-MONE IN WSS-VARI
               DISPLAY 'PROCESO CANCELADO...'
               PERFORM GNS-PRO-ABT.

       FIN-CHK-EXI-TBAN-CCM.
           EXIT.
      *FIN-JGM 24-05-2000.
      ******************************************************************
      *CHK-EXI-TBAN SECTION.
      *********************
      *INI-CHK-EXT-TBAN.
      *    MOVE 1 TO MOV-I.
      *    IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'EXI-TBAN                : ' WSS-COD-BANC
      *                                             IN WSS-VARI.
      *LUP-VEC-TBAN.
      *    IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'TBAN-SUB                : ' WSS-TBAN (MOV-I).
      *    IF WSS-COD-BANC IN WSS-VARI = WSS-TBAN (MOV-I) AND
      *       WSS-COD-BANC IN WSS-VARI > SPACES
      *        MOVE 'S' TO WSS-IND-EBAN IN WSS-VARI
      *        GO TO FIN-CHK-EXT-TBAN.
      *    IF MOV-I = 20
      *        MOVE 'N' TO WSS-IND-EBAN IN WSS-VARI
      *        GO TO FIN-CHK-EXT-TBAN
      *    ELSE
      *        ADD 1 TO MOV-I
      *        GO TO LUP-VEC-TBAN.
      *FIN-CHK-EXT-TBAN.
      *    EXIT.

      ******************************************************************
       RST-DIA-HBLS SECTION.
      **********************
       INI-RST-DIA-HBLS.
      *
           IF WSS-NUM-TOP1 IN WSS-VARI > WSS-NUM-TOPE IN WSS-VARI
               MOVE 'N' TO WSS-IND-MORA IN WSS-VARI
               GO TO FIN-RST-DIA-HBLS.
      *
      *VAL-FEC Va restando un dia habil hasta acumular TOPE.
           MOVE 'N' TO WSS-IND-MORA IN WSS-VARI.
           MOVE 1   TO WSS-NUM-CONT IN WSS-VARI.
      *
           MOVE CAN-NUM-DCAN IN CAN TO WSS-NUM-DTOP IN WSS-VARI.
           MOVE CAN-NUM-MCAN IN CAN TO WSS-NUM-MTOP IN WSS-VARI.
           MOVE CAN-NUM-SCAN IN CAN TO WSS-NUM-STOP IN WSS-VARI.
           MOVE CAN-NUM-ACAN IN CAN TO WSS-NUM-ATOP IN WSS-VARI.
      * Resta  dias habiles y se salta los no habiles.
       REST-DIA-HBLS.
           MOVE WSS-NUM-DTOP TO FEC-ITM1.
           MOVE WSS-NUM-MTOP TO FEC-ITM2.
           MOVE WSS-NUM-STOP TO FEC-ITM3.
           MOVE WSS-NUM-ATOP TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DTOP.
           MOVE FEC-ITM2 TO WSS-NUM-MTOP.
           MOVE FEC-ITM3 TO WSS-NUM-STOP.
           MOVE FEC-ITM4 TO WSS-NUM-ATOP.
      *VAL-FEC Validar Fecha.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              GO TO REST-DIA-HBLS.

      *------------------------------------------------------*
      *    IF WSS-IND-DISP IN WSS-VARI = 'S'
      *        DISPLAY 'RST-DIA VEN-FEC-FVEN    : 'VEN-FEC-FVEN IN VEN
      *        DISPLAY 'RST-DIA WSS-FEC-FTOP    : 'WSS-FEC-FTOP IN
      *                                                   WSS-VARI.
      *------------------------------------------------------*
      *
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FTOP IN WSS-VARI
               MOVE 'N' TO WSS-IND-MORA IN WSS-VARI
               GO TO FIN-RST-DIA-HBLS.

           IF (WSS-NUM-CONT IN WSS-VARI = WSS-NUM-DIAS IN WSS-VARI) AND
              (VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FTOP IN WSS-VARI)
                 MOVE 'S' TO WSS-IND-MORA IN WSS-VARI
                 GO TO FIN-RST-DIA-HBLS-D
           ELSE
               ADD 1 TO WSS-NUM-CONT IN WSS-VARI
               GO TO REST-DIA-HBLS.
      *------------------------------------------------------*
       FIN-RST-DIA-HBLS-D.
           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'RST-DIA WSS-NUM-CONT    : 'WSS-NUM-CONT IN
                                                            WSS-VARI
               DISPLAY 'RST-DIA WSS-NUM-DIAS    : 'WSS-NUM-DIAS IN
                                                          WSS-VARI.
               DISPLAY 'INDICADOR MORA          : 'WSS-IND-MORA IN
                                                          WSS-VARI.
      *------------------------------------------------------*
       FIN-RST-DIA-HBLS.
           EXIT.

      ******************************************************************
       BUS-CIC-CTA SECTION.
      ********************
       INI-BUS-CIC-CTA.
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
                CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
                 IF CYA-IND-TCYA IN CYA NOT = 'C'
                     MOVE 'NOEXISTECYA' TO MSG-COD-MENS IN MSG
                     GO TO FIN-BUS-CIC-CTA.

           MOVE 'TAB'               TO MSC-COD-SIST.
           MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC.
           MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.

           IF FIO-STAT-OKS
               MOVE MSC-CIC-CMSC IN MSC TO WSS-COD-CCCC IN WSS-VARI.

           IF FIO-STAT-OKS AND MSC-IND-VIGE IN MSC = 'S' AND
              WSS-COD-CCCC IN WSS-VARI = 'CC'
               IF WSS-IND-DISP IN WSS-VARI = 'S'
                   DISPLAY 'CUENTA CC: 'CYA-IIC-ICYA IN CYA
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE SPACES TO WSS-COD-CCCC IN WSS-VARI
               IF FIO-STAT-OKS AND MSC-IND-VIGE IN MSC = 'S' AND
                  MSC-CIC-CMSC IN MSC = 'CTBL'
                   MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA
                   MOVE ZEROES              TO CYA-NUM-ICAN IN CYA
                   MOVE ZEROES              TO CYA-NUM-ICYA IN CYA
                   MOVE FIO-GET-NLS TO FIO-CMND
                   PERFORM COL-FIO-CYA
                   IF NOT ( FIO-STAT-OKS AND
                      CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
                      ZEROES = CYA-NUM-ICAN IN CYA )
                       MOVE 'CTACTBL  NEX' TO MSG-COD-MENS IN MSG
                   ELSE
                       MOVE 'TAB'               TO MSC-COD-SIST
                       MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
                       MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
                       PERFORM BUS-MSC
                       IF FIO-STAT-OKS
                           MOVE MSC-CIC-CMSC IN MSC TO WSS-COD-CCCC
                                                             IN WSS-VARI
                           IF WSS-COD-CCCC IN WSS-VARI = 'CC'
                               IF CYA-IIC-ICYA IN CYA > SPACES
                                   IF WSS-IND-DISP IN WSS-VARI = 'S'
                                       DISPLAY 'CUENTA CTBL: '
                                       CYA-IIC-ICYA IN CYA
                                   ELSE
                                       NEXT SENTENCE
                               ELSE
                                   MOVE 'NOEXISTECYA' TO MSG-COD-MENS IN
                                                                     MSG
                           ELSE
                               MOVE 'NOEXISTECYA' TO MSG-COD-MENS IN MSG
                       ELSE
                           MOVE 'NOEXISTECYA' TO MSG-COD-MENS IN MSG
               ELSE
                   MOVE 'NOEXISTECYA' TO MSG-COD-MENS IN MSG.
       FIN-BUS-CIC-CTA.
           EXIT.

      ******************************************************************
      *ALD-BCI-INI/16041998
       LEE-OPE SECTION.
       INI-LEE-OPE.
           MOVE SPACES              TO MSG-COD-MENS IN MSG.
           MOVE CYA-CIC-ICYA IN CYA TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF NOT FIO-STAT-OKS
               DISPLAY ' CUENTA INEXISTENTE : '
                                       CYA-CIC-ICYA IN CYA
               MOVE 'OPE    NEX'    TO MSG-COD-MENS IN MSG
               GO TO FIN-LEE-OPE.

           IF OPE-FEC-FTOP IN OPE > ZEROES AND
              OPE-FEC-FTOP IN OPE > OPE-FEC-FROP IN OPE
               DISPLAY ' CUENTA CERRADA : '
                                       CYA-CIC-ICYA IN CYA
               MOVE 'FECFTOPCCCER'  TO MSG-COD-MENS
               GO TO FIN-LEE-OPE.

       FIN-LEE-OPE.
           EXIT.
      *ALD-BCI-FIN/16041998

       LEE-OPC SECTION.
       INI-LEE-OPC.
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
              DISPLAY ' NO ENCONTRE OPERACION: '
                        OPC-CIC-IOPC IN OPC
              MOVE 'ERROR' TO MSG-COD-MENS IN MSG
              GO TO FIN-LEE-OPC.
       FIN-LEE-OPC.
           EXIT.

      *ALD-BCI-INI/01.02.1999
       LEE-DLC SECTION.
       INI-LEE-DLC.
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CIC-IOPC IN CAN = DLC-CIC-IOPC IN DLC )
              DISPLAY ' NO ENCONTRE DLC DE OPERACION : '
                        CAN-CIC-IOPC IN CAN
              MOVE 'ERROR' TO MSG-COD-MENS IN MSG
              GO TO FIN-LEE-DLC.
       FIN-LEE-DLC.
           EXIT.
      *ALD-BCI-FIN/01.02.1999

      ******************************************************************
       LEE-VEN SECTION.
      ****************
       INI-LEE-VEN.
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE SPACES              TO RCV-CIC-IOPV IN RCV.
           MOVE ZEROES              TO RCV-NUM-IVCT IN RCV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT ( FIO-STAT-OKS
                AND CAN-CIC-IOPC IN CAN = RCV-CIC-IOPC IN RCV
                AND CAN-NUM-ICAN IN CAN = RCV-NUM-ICAN IN RCV )
                 DISPLAY ' NO EXISTE RCV PARA CAN '
                 MOVE 'ERROR' TO MSG-COD-MENS IN MSG
                 GO TO FIN-LEE-VEN.

           IF RCV-NUM-IVCT IN RCV = ZEROES
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE RCV-NUM-IVCT IN RCV TO VEN-NUM-IVEN IN VEN.

           MOVE RCV-CIC-IOPC IN RCV TO VEN-CIC-IOPC IN VEN.

           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-OBT-VEN
               IF NOT VEN-STAT-OKS
                   DISPLAY 'ERROR NO EXISTE VEN PARA RCV EN OBTVEN '
                   MOVE 'OBTVENERR'         TO MSG-COD-MENS IN MSG
               ELSE
                   GO TO FIN-LEE-VEN
           ELSE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   MOVE 'OBTVENERR'         TO MSG-COD-MENS IN MSG
                   DISPLAY 'ERROR NO EXISTE VEN PARA RCV EN FIOVEN '.
       FIN-LEE-VEN.
           EXIT.

      ******************************************************************
      * Graba archivo CAB.
       GRA-REG-CAB SECTION.
      ********************
       INI-GRA-REG-CAB.
           MOVE 8                        TO CAB-NUM-TREG IN CAB.
           MOVE SRT-IIC-ICYA IN SRT      TO CAB-NUM-NCTA IN CAB.
           MOVE 9                        TO CAB-NUM-IMPU IN CAB.
           MOVE SPACES                   TO CAB-COD-SCHE IN CAB.
           MOVE SRT-SGV-TCOM IN SRT      TO CAB-SGV-MNTO IN CAB.
           MOVE 9                        TO CAB-COD-TMVO IN CAB.
           MOVE ZEROES                   TO CAB-NUM-CBAN IN CAB.
           MOVE SPACES                   TO CAB-COD-DIS1 IN CAB.
           MOVE SRT-NUM-DOUT IN SRT      TO CAB-NUM-DMVO IN CAB.
           MOVE SRT-NUM-MOUT IN SRT      TO CAB-NUM-MMVO IN CAB.
           MOVE SRT-GLS-ANO2 IN SRT      TO CAB-NUM-AMVO IN CAB.
           MOVE ZEROES                   TO CAB-IND-TATM IN CAB.
           MOVE SPACES                   TO CAB-GLS-DIS2 IN CAB.
           MOVE SRT-COD-OFCA IN SRT      TO CAB-COD-SORI IN CAB.
           MOVE SPACES                   TO CAB-GLS-DIS3 IN CAB.
           MOVE SRT-COD-OFCA IN SRT      TO CAB-COD-SREC IN CAB.
           MOVE SPACES                   TO CAB-GLS-DIS4 IN CAB.
           ADD 1 TO WSS-NUM-RGRA IN WSS-VARI.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-CAB.
           IF FIO-STAT-OKS
               IF WSS-IND-DISP IN WSS-VARI = 'S'
                   DISPLAY 'CANCELACION GRABADA OK  : 'SRT-CIC-IOPC
                                                             IN SRT
                   '  NUMERO: 'SRT-NUM-ICAN IN SRT
                   DISPLAY '-------------------------------------------'
                           '--------'
                   DISPLAY '                                           '
                           '        '
               ELSE
                   NEXT SENTENCE
           ELSE
               DISPLAY 'ERROR AL GRABAR REGISTRO AL ARCHIVO CAB'
               DISPLAY 'CANCELACION NO GRABADA  : 'SRT-CIC-IOPC IN SRT
               GO TO FIN-GRA-REG-CAB.
      *     MOVE 'S'                 TO WSS-IND-CHEK IN WSS-VARI.
      *     MOVE CAN-CIC-IOPC IN CAN TO WSS-CIC-IOPC IN WSS-VARI.
       FIN-GRA-REG-CAB.
           EXIT.

      ******************************************************************
      * Graba archivo SORT.
       GRA-REG-SORT SECTION.
      *********************
       INI-GRA-REG-SORT.
           MOVE CAN-CIC-IOPC IN CAN      TO SRT-CIC-IOPC IN SRT.
           MOVE CAN-NUM-ICAN IN CAN      TO SRT-NUM-ICAN IN SRT.
      *ALD-BCI-INI/20041998
           MOVE WSS-CYA-IIC-ICYA IN WSS-VARI
                                         TO SRT-IIC-ICYA IN SRT.
      *    MOVE CYA-IIC-ICYA IN CYA      TO SRT-IIC-ICYA IN SRT.
      *ALD-BCI-FIN/20041998
           MOVE WSS-SGV-TCOM IN WSS-VARI TO SRT-SGV-TCOM IN SRT.
           MOVE CAN-NUM-DOUT IN CAN      TO SRT-NUM-DOUT IN SRT.
           MOVE CAN-NUM-MOUT IN CAN      TO SRT-NUM-MOUT IN SRT.
           MOVE CAN-NUM-SOUT IN CAN      TO SRT-NUM-SOUT IN SRT.
           MOVE CAN-NUM-AOUT IN CAN      TO SRT-NUM-AOUT IN SRT.
           MOVE WSS-GLS-ANO2 IN WSS-VARI TO SRT-GLS-ANO2 IN SRT.
           MOVE CAN-COD-OFCA IN CAN      TO SRT-COD-OFCA IN SRT.
           MOVE CAN-MSC-STAT IN CAN      TO SRT-MSC-STAT IN SRT.
           MOVE CAN-SGV-TPAG IN CAN      TO SRT-SGV-TPAG IN SRT.
           MOVE CAN-SGV-TREN IN CAN      TO SRT-SGV-TREN IN SRT.
           RELEASE SRT.
           MOVE 'S'                 TO WSS-IND-CHEK IN WSS-VARI.
           MOVE CAN-CIC-IOPC IN CAN TO WSS-CIC-IOPC IN WSS-VARI.
       FIN-GRA-REG-SORT.
           EXIT.

      ******************************************************************
       MUESTRA-ESTADISTICAS SECTION.
      *****************************
       INI-MUESTRA-ESTADISTICAS.
           DISPLAY ' '.
           DISPLAY ' ESTADISTICAS DEL PROCESO.'.
           DISPLAY ' -------------------------'.
           DISPLAY ' '.
           DISPLAY 'REGISTROS LEIDOS DE TABLA CAN       : '
                                        WSS-NUM-RLEI IN WSS-VARI.
           DISPLAY 'CANCELACIONES CON MORA              : '
                                        WSS-NUM-CON1 IN WSS-VARI.
           DISPLAY 'REGISTROS GRABADOS EN TABLA CAB     : '
                                        WSS-NUM-RGRA IN WSS-VARI.
           DISPLAY 'REGISTROS GRABADOS EN TABLA ICG     : '
                                        WSS-NUM-RICG IN WSS-VARI.
           DISPLAY 'REGISTROS ACTUALIZADOS EN TABLA CAN : '
                                        WSS-NUM-RCAN IN WSS-VARI.
           DISPLAY 'REGISTROS ACTUALIZADOS EN TABLA CYA : '
                                        WSS-NUM-RCYA IN WSS-VARI.
           DISPLAY ' '.
       FIN-MUESTRA-ESTADISTICAS.
           EXIT.

      ******************************************************************
       CLOSE-FILE SECTION.
      ********************
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-CYA.
           PERFORM COL-FIO-CAB.
      *     PERFORM COL-FIO-CAV.
           MOVE 'COL' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
       FIN-CLOSE-FILE.
           EXIT.

      ******************************************************************
      * Copys necesarios para la ejecucion del programa.

       COPY COLBFDLC.
       COPY COLBFOPC.
       COPY COLBFICG.
       COPY COLBFVEN.
       COPY COLBFRCV.
       COPY COLBFRDC.
       COPY COLBFCAN.
       COPY COLBFCOM.
       COPY COLBFCYA.
       COPY COLBFCAB.
      * COPY COLBFCAV.
       COPY COLBFEVC.
       COPY COLBGINT.
       COPY COLBGVEN.
       COPY COLBFTOC.
       COPY SGCBFDBC.
       COPY SGCBFDCP.
       COPY SGCBFDCE.
      *ALD-BCI-INI/16041998
       COPY SGCBFOPE.
      *ALD-BCI-FIN/16041998
       COPY TABBFCAM.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGPES.


