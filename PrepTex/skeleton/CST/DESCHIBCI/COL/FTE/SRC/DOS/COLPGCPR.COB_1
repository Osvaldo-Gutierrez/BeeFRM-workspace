       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      COLPGCPR.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.
      * Programa Generador de Cancelaciones a Archivo MCD.
      * Mantenciones
      * Nov.1994    Adaptacion para Chile    JPA.
      *             Principales cambios.
      *             - Incorpora CYA.
      *             - Moneda reajustable.
      *             - Conversion a pesos.
      *             - Elimina uso de la ICG.
      *
       ENVIRONMENT DIVISION.
      *====================
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS_DTC
      *RJZ INI 3-MAY-1995 19:07:40
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ERC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REV-REQA==.
      *RJZ FIN 3-MAY-1995 19:07:48
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
      *DPM ini  15-OCT-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
      *DPM fin  15-OCT-1996
      * RBG/INI/19-JUL-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
      * RBG/FIN/19-JUL-1996

      *<<<< WSS
      *RJZ INI 3-MAY-1995 16:16:32
       COPY COLBRCYA.
       COPY COLBRERC.
      *COPY COLBRREV.
       COPY COLBRREV.
      *RJZ FIN 3-MAY-1995 16:16:32
       COPY COLBRCOM.
       COPY COLBRCAN.
       COPY COLBROPC.
       COPY COLBRRCV.
       COPY COLBRVEN.
       COPY COLBRDLC.
       COPY COLBRMCD.
       COPY COLBRTOC.
      *DPM ini  15-OCT-1996
       COPY COLBREVC.
       COPY COLBRROV.
      *DPM fin  15-OCT-1996
      * RBG/INI/19-JUL-1996
       COPY TABBRCAM.
      * RBG/FIN/19-JUL-1996
       COPY TABBRTIO.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
      *RJZ INI 3-MAY-1995 16:16:32
      * COPY GNSBRCYA.
      *RJZ INI 3-MAY-1995 16:16:32
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
       01  PAR-VARI.
      *DPM ini  20-FEB-1997 Se cambia formato de fecha a DDMMSSAA
      * FECHA DEL PROCESO
      *     03  PAR-FEC-FTAR.
      *         05  PAR-FIL-1                      PIC X(01).
      *         05  PAR-FEC-FTA1.
      *             07  PAR-NUM-DTAR               PIC 9(02).
      *             07  PAR-FIL-SLA1               PIC X(01).
      *             07  PAR-NUM-MTAR               PIC 9(02).
      *             07  PAR-FIL-SLA2               PIC X(01).
      *             07  PAR-NUM-ATAR               PIC 9(02).
      *DPM fin  20-FEB-1997
           03  PAR-FEC-FDES.
               05  PAR-NUM-DDES                   PIC 9(02).
               05  PAR-NUM-MDES                   PIC 9(02).
               05  PAR-NUM-SDES                   PIC 9(02).
               05  PAR-NUM-ADES                   PIC 9(02).
      * INDICE PARA ANALISIS DE VECTOR
           03  PAR-NUM-IVEC                       PIC 9(02).
      * VECTOR DE OPERACIONES O CANCELACIONES
           03  PAR-VEC-ICAN.
               05  PAR-COL-ICAN      OCCURS 6.
      *
      *           IDENTIFICACION CANCELACION / OPERACION
                  07  PAR-KEY-ICAN.
      *
      *               COD. INT. COMP. OPERACION CREDITO
                      09  PAR-CIC-IOPC.
      *
      *                   CENTRO ASIGNACION IDENTIFICACION
                          11  PAR-CAI-IOPC.
                              13  PAR-COD-TOPC    PIC X(01).
                              13  PAR-COD-COPC    PIC X(03).
      *
      *                   IDENT. INTERNA COMPUTACIONAL
                          11 PAR-IIC-IOPC.
                             13 PAR-COD-OOPC.
                                15  PAR-COD-SOPC  PIC X(02).
                                15  PAR-IND-SOPC  PIC X(01).
                             13 PAR-GLS-NOPC      PIC X(05).
                      09 PAR-FIL-IOPC             PIC X(01).
      * Vector de Monedas
           03  PAR-VEC-VCOC.
               05  PAR-COL-VCOC      OCCURS 10.
                   07 PAR-COD-VCOC                PIC X(06).
                   07 PAR-FIL-VCOC                PIC X(01).
      * Vector de Sucursales
           03  PAR-VEC-OFOC.
               05 PAR-COL-OFOC      OCCURS 10.
                  07  PAR-COD-OFOC                PIC X(03).
                  07  PAR-FIL-VCOC                PIC X(01).
      * Vector de Lineas
           03 PAR-VEC-COOC.
              05 PAR-COL-COOC      OCCURS 10.
                 07  PAR-COD-COOC                 PIC X(06).
                 07  PAR-FIL-COOC                 PIC X(01).
      * INDICADOR DE REGISTRO SELECCIONADO
           03  PAR-IND-RSEL                       PIC 9(01).
               88  REG-NO-SELECCIONADO        VALUE 0.
               88  REG-SELECCIONADO           VALUE 1.
       01  WSS-VARI.
      *ALD-BCI-INI/05031999
           03  WSS-FEC-FSA1.
               05 WSS-NUM-SSA1                    PIC 9(02).
               05 WSS-NUM-ASA1                    PIC 9(02).
           03  WSS-FEC-FSA2.
               05 WSS-NUM-SSA2                    PIC 9(02).
               05 WSS-NUM-ASA2                    PIC 9(02).
      *ALD-BCI-FIN/05031999
      *ALD-BCI-INI/05051998
           03  WSS-IND-SWCOM                      PIC X(01).
           03  WSS-SGV-MIVA             COMP-3    PIC S9(11)V9(4).
           03  WSS-SGV-MNTO             COMP-3    PIC S9(11)V9(4).
      *ALD-BCI-FIN/05051998

      *DPM ini  15-OCT-1996
           03  WSS-IND-SLFI  VALUE 'N'            PIC X(01).
           03  WSS-SGV-CAPI  VALUE ZEROES         PIC 9(11)V9(04).
      *DPM fin  15-OCT-1996
      *DPM ini  27-MAR-1997
           03  WSS-SGV-RENO  VALUE ZEROES         PIC 9(11)V9(04).
      *DPM fin  27-MAR-1997
      * DPM ini  7-JAN-1998
           03  WSS-SGV-TREN  VALUE ZEROES         PIC 9(11)V9(04).
      * DPM fin  7-JAN-1998
      *RJZ INI 3-MAY-1995 14:56:57
           03  WSS-SGV-INTN  VALUE 30000          PIC S9(11)V9(04).
           03  WSS-SGV       VALUE 1       COMP   PIC 9(1).
      *     03  WSS-SGV-INTN  VALUE 30000          PIC 9(11)V9(04).
           03  WSS-SGV-CAPP  VALUE 61250          PIC 9(11)V9(04).
           03  WSS-SGV-CONO  VALUE ZEROES         PIC 9(01).
           03  WSS-SGV-CONM  VALUE ZEROES         PIC 9(01).
           03  WSS-SGV-COEO  VALUE ZEROES         PIC 9(01).
           03  WSS-SGV-COEM  VALUE ZEROES         PIC 9(01).
           03  WSS-SGV-SEGV  VALUE ZEROES         PIC 9(01).
           03  WSS-SGV-SEGP  VALUE ZEROES         PIC 9(01).
           03  WSS-SGV-INTM  VALUE ZEROES  COMP-3 PIC S9(11)V9(04).
           03  WSS-SGV-REAM  VALUE ZEROES  COMP-3 PIC S9(11)V9(04).
           03  WSS-EXISTE                         PIC X(01) VALUE 'N'.
               88  EXISTE                         VALUE 'S'.
           03  WSS-FIN-LOOP                       PIC X(01) VALUE 'N'.
               88  FIN-LOOP                       VALUE 'S'.
           03  WSS-IND1      VALUE ZEROES         PIC 9(04).
           03  WSS-IND2      VALUE ZEROES         PIC 9(04).
      *RJZ FIN 3-MAY-1995 14:56:57
           03  WSS-OPEC                           PIC X(01).
           03  WSS-COD-MNAC                       PIC X(06).
           03  WSS-FEC-FFEC.
               05  WSS-NUM-SFEC VALUE ZEROES      PIC 9(02).
               05  WSS-NUM-AFEC VALUE ZEROES      PIC 9(02).
               05  WSS-NUM-MFEC VALUE ZEROES      PIC 9(02).
               05  WSS-NUM-DFEC VALUE ZEROES      PIC 9(02).
           03  WSS-FEC-FINI.
               05  WSS-NUM-SINI VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-AINI VALUE ZEROES      PIC 9(02).
               05  WSS-NUM-MINI VALUE ZEROES      PIC 9(02).
               05  WSS-NUM-DINI VALUE ZEROES      PIC 9(02).
           03  WSS-ES-VEN-IOPC  VALUE 'NO'        PIC X(02).
           03  WSS-SW-OK        VALUE 1           PIC 9(01).
           03  WSS-VAL-INT-SUS  VALUE ZEROES      PIC S9(11)V9(04).
           03  WSS-COD-CAN                        PIC X(03).
           03  WSS-COD-TCJ                        PIC X(03).
           03  WSS-COD-SVCD      VALUE LOW-VALUES PIC X(08).
           03  WSS-ANT-NTAS                       PIC X(03).
           03  WSS-IND-TTAS.
               05  WSS-GLS-NTAS                   PIC X(03).
               05  WSS-GLS-STAS                   PIC X(03).
           03  WSS-VEC-MOV OCCURS 100 TIMES INDEXED BY
               MOV-I MOV-TOPE MOV-MON.
               05  VEC-CPTO                       PIC X(06).
               05  VEC-MONTO                      PIC S9(11)V9(04).
      *RJZ INI  3-MAY-1995 11:47:49
               05  VEC-ES-LIQ                     PIC X(02).
           03  WSS-VEC-CYA OCCURS 100 TIMES INDEXED BY CYA-I CYA-TOPE
                                                       EXI-I EXI-TOPE.
               05  VEC-CPTO-CYA                   PIC X(06).
               05  VEC-MONTO-CYA                  PIC S9(13)V9(02).
      *RJZ FIN  3-MAY-1995 11:48:12
      * MONTOS
           03  WSS-NUM-CERO      VALUE 0          PIC 9(05).
           03  WSS-SGV-ICPN      VALUE ZEROES     PIC S9(11)V9(04).
           03  WSS-SGV-ACUM      VALUE ZEROES     PIC S9(11)V9(04).
      *DPM ini  26-AUG-1996
           03  WSS-SGV-REST      VALUE ZEROES     PIC S9(11)V9(04).
           03  WSS-SGV-AUXI      VALUE ZEROES     PIC S9(11)V9(04).
      *DPM fin  26-AUG-1996
      *DPM ini  11-SEP-1996
           03  AUX-CIC-IOPC      VALUE SPACES     PIC X(12).
      *DPM fin  11-SEP-1996
      * CONTADORES
           03  WSS-NUM-ROPC      VALUE 0          PIC 9(06).
           03  WSS-NUM-RGRA      VALUE 0          PIC 9(06).
           03  WSS-IND-ERRO                       PIC 9(01).
               88 ERROR-EN-PROCESO           VALUE 1.
           03  WSS-CAN       VALUE SPACES         PIC X(50).
           03  WSS-RCV       VALUE SPACES         PIC X(50).
      * RBG/INI/19-JUL-1996
           03  WSS-MSC-TVOC                       PIC X(06).
           03  WSS-COD-PESO                       PIC X(06).
           03  WSS-SGV-VCAM  VALUE ZEROES         PIC S9(11)V9(04).
      *VFP-INI 11-MAR-1998 SE AGREGA SIGNO PARA SOLUCIONAR
      * EL PROBLEMA DE CONTABILIZACION DE LOS REAJUSTES NEGATIVOS
      *    03  WSS-SGV-REAJ  VALUE ZEROES         PIC  9(11)V9(04).
           03  WSS-SGV-REAJ  VALUE ZEROES         PIC S9(11)V9(04).
      *VFP-FIN 11-MAR-1998
      * DPM ini  6-JAN-1998 Se dejo largo de variable de 5 para
      * igualar a variable utilizada en calculo linea
      *     03  WSS-SGV-PASO  VALUE ZEROES         PIC  9(11)V9(04).
      *VFP-INI 11-MAR-1998 SE AGREGA SIGNO PARA SOLUCIONAR
      * EL PROBLEMA DE CONTABILIZACION DE LOS REAJUSTES NEGATIVOS
      *    03  WSS-SGV-PASO  VALUE ZEROES         PIC  9(11)V9(05).
           03  WSS-SGV-PASO  VALUE ZEROES         PIC S9(11)V9(05).
      *VFP-FIN 11-MAR-1998
      * DPM fin  6-JAN-1998

      * RBG/FIN/19-JUL-1996
      *DPM ini  18-MAR-1997
           03  WSS-VAL-DIFE          COMP-3        PIC S9(11)V9(4).
      *DPM fin  18-MAR-1997

      *DPM ini  18-APR-1997 Se guarda RJS o INTM o IMOK si es > 0
      *para cuadrar con INTN si son < 0
      *VFP-INI 11-MAR-1998 SE AGREGA SIGNO PARA SOLUCIONAR
      * EL PROBLEMA DE CONTABILIZACION DE LOS REAJUSTES NEGATIVOS
      *    03  WSS-SGV-MONTO  VALUE ZEROES        PIC  9(11)V9(04).
           03  WSS-SGV-MONTO  VALUE ZEROES        PIC S9(11)V9(04).
      *VFP-FIN 11-MAR-1998
      *DPM fin  18-APR-1997


       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
       INI-MAIN.
           COPY GNSBGEDB.
           MOVE 'COLPGCPR' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM OPEN-FILE.
           PERFORM INI-VAR.
           PERFORM PRO-CAN.
           PERFORM CLOSE-FILE.
       FIN-MAIN.
           DISPLAY 'CANCELACIONES SELECIONADAS '
                                        WSS-NUM-ROPC IN WSS-VARI.
           DISPLAY 'REGISTROS GRABADOS      '
                                        WSS-NUM-RGRA IN WSS-VARI.
           PERFORM GNS-PRO-END.

       OPEN-FILE SECTION.
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-CYA.
           MOVE 'COL' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *DPM ini  15-OCT-1996 Apertura de archivos de Output
      *RJZ INI 8-MAY-1995 15:51:40
      *      MOVE FIO-EXT TO FIO-CMND.
            MOVE FIO-OUT TO FIO-CMND.
      *DPM fin  15-OCT-1996
           PERFORM COL-FIO-MCD.
           PERFORM COL-FIO-ERC.
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-REV.
      *RJZ FIN 8-MAY-1995 15:51:40
       FIN-OPEN-FILE.
           EXIT.
       INI-VAR SECTION.
       INI-INI-VAR.
      *<<<< INI_INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *
           MOVE 1  TO PAR-NUM-IVEC IN PAR-VARI.
      *CAPTURA FECHA PROCESO
      *DPM ini  20-FEB-1997
      *     DISPLAY 'FECHA DESDE DESDE TARJETA (*DD/MM/AA) : '.
      *     ACCEPT  PAR-FEC-FTAR IN PAR-VARI.
      *     DISPLAY PAR-FEC-FTA1 IN PAR-VARI.
      *     MOVE PAR-NUM-DTAR IN PAR-VARI TO PAR-NUM-DDES IN PAR-VARI.
      *     MOVE PAR-NUM-MTAR IN PAR-VARI TO PAR-NUM-MDES IN PAR-VARI.
      *     MOVE PAR-NUM-ATAR IN PAR-VARI TO PAR-NUM-ADES IN PAR-VARI.
      *     IF PAR-NUM-ADES IN PAR-VARI < 50
      *        MOVE 20                    TO PAR-NUM-SDES IN PAR-VARI
      *     ELSE
      *        MOVE 19                    TO PAR-NUM-SDES IN PAR-VARI.
           DISPLAY 'FECHA DESDE DESDE TARJETA (DDMMSSAA) : '.
           ACCEPT  PAR-FEC-FDES IN PAR-VARI.
           DISPLAY PAR-FEC-FDES IN PAR-VARI.
      *DPM fin  20-FEB-1997
      *CAPTURA SUCURSAL
           DISPLAY 'SUCURSAL (*/XXX ) hasta 10        : '.
           MOVE SPACES TO
               PAR-VEC-OFOC IN PAR-VARI.
           ACCEPT  PAR-VEC-OFOC IN PAR-VARI.
           DISPLAY PAR-VEC-OFOC IN PAR-VARI.
      *CAPTURA MONEDA
           DISPLAY 'MONEDA (*/XXXXXX ) hasta 10   : '.
           MOVE SPACES TO
                PAR-VEC-VCOC IN PAR-VARI.
           ACCEPT  PAR-VEC-VCOC IN PAR-VARI.
           DISPLAY PAR-VEC-VCOC IN PAR-VARI.
      *CAPTURA LINEA (TIPO OPERACION Y CODIGO AUXILIAR)
           DISPLAY 'LINEA  (*/XXXXXX ) hasta 10: '.
           MOVE SPACES TO
                PAR-VEC-COOC IN PAR-VARI.
           ACCEPT  PAR-VEC-COOC IN PAR-VARI.
           DISPLAY PAR-VEC-COOC IN PAR-VARI.
      *CAPTURA NUMERO OPERACION O CANCELACION
           DISPLAY 'NRO OPE/CAN (*/XXXXXXXXXXXX )  hasta 6 :'.
           MOVE SPACES TO PAR-VEC-ICAN IN PAR-VARI.
           ACCEPT  PAR-VEC-ICAN IN PAR-VARI.
           DISPLAY PAR-VEC-ICAN IN PAR-VARI.
      *VAL-FEC VALIDA FECHA DESDE
           DISPLAY PAR-FEC-FDES IN PAR-VARI.
           MOVE PAR-FEC-FDES    IN PAR-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'FECPROCNEX'   TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT
               GO TO FIN-INI-VAR.
      *
      * MUEVE FECHAS DD-MM-SSAA A FORMATO SSAA-MM-DD
           MOVE PAR-NUM-DDES IN PAR-VARI TO WSS-NUM-DFEC IN WSS-VARI.
           MOVE PAR-NUM-MDES IN PAR-VARI TO WSS-NUM-MFEC IN WSS-VARI
           MOVE PAR-NUM-SDES IN PAR-VARI TO WSS-NUM-SFEC IN WSS-VARI.
           MOVE PAR-NUM-ADES IN PAR-VARI TO WSS-NUM-AFEC IN WSS-VARI.
      * OBTIENE DIA HABIL ANTERIOR PARA PROCESAR DESDE ESE DIA
      * INCLUSIVE, ESTO EN EL CASO DE CONTABILIDAD AL VENCIMIENTO
           MOVE PAR-NUM-DDES IN PAR-VARI TO FEC-ITM1 IN FEC-FECH.
           MOVE PAR-NUM-MDES IN PAR-VARI TO FEC-ITM2 IN FEC-FECH.
           MOVE PAR-NUM-SDES IN PAR-VARI TO FEC-ITM3 IN FEC-FECH.
           MOVE PAR-NUM-ADES IN PAR-VARI TO FEC-ITM4 IN FEC-FECH.
       VAL-DIA-DHBL.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER OR NOT FEC-STAT-HBL
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-RST-DIA  TO FEC-CMND
               MOVE 1 TO FEC-NDIA
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'FECDHANNEX'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
                   PERFORM GNS-PRO-ABT
                   GO TO FIN-INI-VAR
               ELSE
                   GO TO VAL-DIA-DHBL.
      *
      * MUEVE FECHAS DD-MM-SSAA A FORMATO SSAA-MM-DD
           MOVE FEC-ITM1 IN FEC-FECH TO WSS-NUM-DINI IN WSS-VARI.
           MOVE FEC-ITM2 IN FEC-FECH TO WSS-NUM-MINI IN WSS-VARI.
           MOVE FEC-ITM3 IN FEC-FECH TO WSS-NUM-SINI IN WSS-VARI.
           MOVE FEC-ITM4 IN FEC-FECH TO WSS-NUM-AINI IN WSS-VARI.
      *
      * OBTIENE COD MOVIMIENTO MEDIANTE CIC
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'MVT'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'CAN'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'       TO MSG-COD-SIST
               MOVE 'CICCANNEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT
               GO TO FIN-INI-VAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CAN IN WSS-VARI.

      * RBG/INI/19-JUL-1996
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICPESONEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT
               GO TO FIN-INI-VAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICTVAL0NEX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT
               GO TO FIN-INI-VAR.
           MOVE MSC-COD-CMSC IN MSC TO WSS-MSC-TVOC IN WSS-VARI.
      * RBG/FIN/19-JUL-1996

      *
      * BUSCA CODIGO DE SITUACION CONTABLE "VENCIDA"

           MOVE 'COL'  TO MSC-COD-SIST.
           MOVE 'SCTB' TO MSC-CIC-TMSC IN MSC.
           MOVE 'VCD'  TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = SPACES
               MOVE MSC-COD-CMSC IN MSC TO WSS-COD-SVCD
           ELSE
               DISPLAY 'ABORTO : SIS = COL, MSC = SCTB, '
                       'MSC-CIC-CMSC = VCD'
               PERFORM GNS-PRO-ABT
               GO TO FIN-INI-VAR.
           MOVE SPACES TO MCD.
       FIN-INI-VAR.
           EXIT.
       PRO-CAN SECTION.
       INI-PRO-CAN.
      *     MOVE WSS-FEC-FINI IN WSS-VARI TO CAN-FEC-FEGR IN CAN
           MOVE WSS-FEC-FINI IN WSS-VARI TO CAN-FEC-FOUT IN CAN
      *     MOVE 'CAN-FEC-FEGR' TO FIO-AKEY
           MOVE 'CAN-FEC-FOUT' TO FIO-AKEY
           MOVE FIO-GET-NLS    TO FIO-CMND
           PERFORM COL-FIO-CAN
      *RJZ INI  20-JUN-1995
           IF FIO-STAT-OKS
              IF CAN-SGV-TPAG IN CAN < ZEROES OR
                 CAN-SGV-TREN IN CAN < ZEROES OR
                 CAN-MSC-STAT IN CAN = 'R'
                 PERFORM  GRABA-REV
                 GO TO NXT-PRO-CAN.
      *RJZ FIN  20-JUN-1995
           IF NOT FIO-STAT-OKS OR
      *        CAN-FEC-FEGR IN CAN >  WSS-FEC-FFEC IN WSS-VARI
             CAN-FEC-FOUT IN CAN >  WSS-FEC-FFEC IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS OPC EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI ' A '
                                WSS-FEC-FFEC IN WSS-VARI
               GO TO FIN-PRO-CAN.
       LUP-PRO-CAN.
      *DPM ini  10-OCT-1996
           MOVE SPACES TO MSG-COD-MENS.
      *DPM fin  10-OCT-1996
           ADD 1 TO WSS-IND1 IN WSS-VARI.
      *RJZ INI  20-JUN-1995
           IF FIO-STAT-OKS
              IF CAN-SGV-TPAG IN CAN < ZEROES OR
                 CAN-SGV-TREN IN CAN < ZEROES OR
                 CAN-MSC-STAT IN CAN = 'R'
                 PERFORM GRABA-REV
                 GO TO NXT-PRO-CAN.
      *RJZ FIN  20-JUN-1995
           IF NOT FIO-STAT-OKS OR
      *        CAN-FEC-FEGR IN CAN >  WSS-FEC-FFEC IN WSS-VARI
              CAN-FEC-FOUT IN CAN >  WSS-FEC-FFEC IN WSS-VARI
              GO TO FIN-PRO-CAN.
      *DPM ini  31-OCT-1996
      *ALD-BCI-INI/30.01.1997
           IF CAN-SGV-IMOK IN CAN IS NOT NUMERIC
               DISPLAY 'IMOK NO ES NUMERICO ==> ' CAN-CIC-IOPC IN CAN
               GO TO NXT-PRO-CAN.
      *ALD-BCI-FIN/30.01.1997
      *Se cambiaron de lugar las dos secciones siguientes
      * PROCESA REGISTRO RCV
           PERFORM LEE-RCV.
           IF MSG-COD-MENS IN MSG > SPACES
             DISPLAY 'FALLO LEE-RCV :' WSS-IND1 IN WSS-VARI
              GO TO ERR-PRO-CAN.
      *ALD-BCI-INI/10.08.1999
           IF  RCV-SGV-CAPI IN RCV < ZEROES OR
               RCV-SGV-FINA IN RCV < ZEROES
                 PERFORM GRABA-REV
                 GO TO NXT-PRO-CAN.
      *ALD-BCI-FIN/10.08.1999
      *ALD-BCI-INI/30.01.1997
           IF RCV-SGV-INTN IN RCV IS NOT NUMERIC
               DISPLAY 'INTN NO ES NUMERICO ==> ' CAN-CIC-IOPC IN CAN
               GO TO NXT-PRO-CAN.
           IF RCV-SGV-INTM IN RCV IS NOT NUMERIC
               DISPLAY 'INTM NO ES NUMERICO ==> ' CAN-CIC-IOPC IN CAN
               GO TO NXT-PRO-CAN.
      *ALD-BCI-FIN/30.01.1997
      * ACCESO DE LA DLC
           PERFORM LEE-DLC.
           IF MSG-COD-MENS IN MSG > SPACES
              DISPLAY 'FALLO LEE-DLC:' WSS-IND1 IN WSS-VARI
              GO TO ERR-PRO-CAN.
      *DPM fin  31-OCT-1996
      * ACCESO DE LA OPC
           PERFORM LEE-OPC.
           IF MSG-COD-MENS IN MSG > SPACES
              DISPLAY 'FALLO LECTURA OPC :' OPC-CIC-IOPC IN OPC
              GO TO ERR-PRO-CAN.
      * PROCESO DE SELECCION Y CLASIFICACION A PARTIR DEL REGISTRO CAN
           PERFORM SEL-REG-CAN.
           IF REG-NO-SELECCIONADO
               DISPLAY 'NO SE SELECCIONO :' CAN-CIC-IOPC IN CAN
               GO TO NXT-PRO-CAN.
      *
      * BUSCA SISTEMA EN DONDE OPERA
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
           DISPLAY 'FALLO BUS-TAB :' WSS-IND1 IN WSS-VARI
      *RJZ INI 4-MAY-1995 10:59:01
      *        MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'COL'          TO MSG-COD-SIST
      *RJZ FIN 4-MAY-1995 10:59:39
               MOVE 'TIO    NEX'   TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' ' OPC-KEY-IOPC IN OPC
                       ' ' TAB-COD-CTAB IN TAB
      *RJZ INI 3-MAY-1995 19:16:22
           PERFORM GRABAR-ERROR
      *RJZ FIN 3-MAY-1995 19:16:30
               GO TO NXT-PRO-CAN.
           MOVE TAB TO TIO.
           IF TIO-GLS-SIST IN TIO NOT = 'COL'
              DISPLAY 'FALLO TIO-GLS-SIST:' TIO-GLS-SIST IN TIO
               GO TO NXT-PRO-CAN.
      *Lee TOC
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
      *Obtiene Como Opera
           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           MOVE MSC-CIC-CMSC IN MSC TO WSS-OPEC IN WSS-VARI.

      *DPM INI  15-OCT-1996
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'N' TO WSS-IND-SLFI IN WSS-VARI.
       LUP-LEE-EVC.
           PERFORM COL-FIO-EVC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = EVC-CIC-IOPC IN EVC
               IF EVC-MSC-TCVE IN EVC = 'FI'
                 MOVE 'S' TO WSS-IND-SLFI IN WSS-VARI
                 MOVE FIO-GET-NXT TO FIO-CMND
                 GO TO LUP-LEE-EVC
               ELSE
                 MOVE 'N' TO WSS-IND-SLFI IN WSS-VARI.
      *DPM FIN  15-OCT-1996

      * AUMENTA CONTADOR DE OPERACIONES LEIDAS OK
           ADD  1  TO WSS-NUM-ROPC IN WSS-VARI.
      * LIMPIA VECTORES PARA GUARDAR DATOS
           PERFORM LIM-VEC.
      *DPM ini  23-OCT-1996 Lee ROV para procesar Prorrogas
           PERFORM PRO-ROV.
           IF MSG-COD-MENS IN MSG > SPACES
              DISPLAY 'FALLO PRO-ROV:' WSS-IND1 IN WSS-VARI
              GO TO ERR-PRO-CAN.
      *DPM fin  23-OCT-1996
      * GUARDA EN VECTORES DATOS DEL REGISTRO RCV
      * ( EL ORDEN DE LAS SECCIONES ES IMPORTENTE )

      *ALD-BCI-INI/05051998
           PERFORM LEE-REG-COM.
      *ALD-BCI-FIN/05051998

           PERFORM CAR-MOV-RCV.
      * GUARDA EN VECTORES DATOS DEL REGISTRO CAN
           PERFORM CAR-MOV-CAN.
      *RJZ INI 3-MAY-1995 12:14:03
           PERFORM PRO-CYA.
      *RJZ INI 3-MAY-1995 12:14:03
      * GRABA REGISTROS EN  ARCHIVO MCD DESDE VECTORES
           PERFORM GRA-MOV.
           GO TO NXT-PRO-CAN.
       ERR-PRO-CAN.
      *RJZ INI 4-MAY-1995 10:31:34
      *    MOVE 'TAB'          TO MSG-COD-SIST
           MOVE 'COL'          TO MSG-COD-SIST
      *RJZ FIN 4-MAY-1995 10:31:48
           PERFORM GET-MSG
           DISPLAY MSG-GLS-DESC ' ' CAN-KEY-ICAN IN CAN
      *RJZ INI 3-MAY-1995 19:18:30
           PERFORM GRABAR-ERROR.
      *RJZ FIN 3-MAY-1995 19:18:37
      *    PERFORM GNS-PRO-ABT.
           MOVE SPACES TO MSG-COD-SIST MSG-GLS-DESC.
       NXT-PRO-CAN.
      *     MOVE 'CAN-FEC-FEGR' TO FIO-AKEY.
           MOVE 'CAN-FEC-FOUT' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           GO TO LUP-PRO-CAN.
       FIN-PRO-CAN.
           EXIT.
      *RJZ INI 3-MAY-1995 19:01:15
       GRABAR-ERROR SECTION.
       INI-GRA-ERR.
      *     MOVE CAN-KEY-ICAN IN CAN TO ERC-CIC-IOPC IN ERC.
           MOVE CAN-CIC-IOPC IN CAN TO ERC-CIC-IOPC IN ERC.
           MOVE CAN-COD-OFCA IN CAN TO ERC-COD-OFIC IN ERC.
           MOVE 'CAN'               TO ERC-COD-EVEN IN ERC.
           MOVE 'CPR'               TO ERC-COD-PGRM IN ERC.
           MOVE CAN-NUM-ICAN IN CAN TO ERC-NUM-CANC IN ERC.
           MOVE CAN-SGV-TPAG IN CAN TO ERC-VAL-MNTO IN ERC.
           MOVE MSG-COD-MENS IN MSG TO ERC-COD-MSGE IN ERC.
           MOVE SPACES              TO ERC-GLS-DISP IN ERC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ERC.
       FIN-GRA-ERR.
           EXIT.
      *RJZ FIN 3-MAY-1995 19:01:29

      *DPM ini  23-OCT-1996
       PRO-ROV SECTION.
       INI-PRO-ROV.
      * OBTIENE VALOR RENOVADO SI OPC ES INGRESO DE PRO
      *DPM INI  5-MAY-1997
      *     IF CAN-MSC-TCAN IN CAN = 'P'
           IF CAN-MSC-TCAN IN CAN = 'P' OR 'R'
      *DPM FIN  5-MAY-1997
              MOVE SPACES              TO ROV-CIC-IOPC IN ROV
              MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPV IN ROV
      *ALD-BCI-INI/21.12.1998
      *       MOVE ZEROES              TO ROV-NUM-IVCT IN ROV
              MOVE CAN-NUM-ICAN IN CAN TO ROV-NUM-IVCT IN ROV
      *ALD-BCI-FIN/21.12.1998
              MOVE FIO-GET-NLS         TO FIO-CMND
              MOVE 'ROV-KEY-IVCT'      TO FIO-AKEY
              PERFORM COL-FIO-ROV
              IF NOT ( FIO-STAT-OKS AND
      *ALD-BCI-INI/21.12.1998
      *                OPC-CIC-IOPC IN OPC = ROV-CIC-IOPV IN ROV )
                   OPC-CIC-IOPC IN OPC = ROV-CIC-IOPV IN ROV AND
                   CAN-NUM-ICAN IN CAN = ROV-NUM-IVCT IN ROV )
      *ALD-BCI-FIN/21.12.1998
                  MOVE 'COL'          TO MSG-COD-SIST
                  MOVE 'OPC  ROVNL' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  DISPLAY MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
                  GO TO FIN-PRO-ROV.
       FIN-PRO-ROV.
           EXIT.
      *DPM fin  23-OCT-1996

       SEL-REG-CAN SECTION.
       INI-SEL-REG-CAN.
      * ASUME REGISTRO NO SELECCIONADO
           MOVE 0 TO PAR-IND-RSEL IN PAR-VARI.
           IF CAN-MSC-STAT IN CAN NOT = 'A'
      *                            OR CAN-IND-CTBL IN CAN = 'N'
                   GO TO FIN-SEL-REG-CAN.
           IF OPC-MSC-STAT IN OPC NOT = 'A'
                   GO TO FIN-SEL-REG-CAN.
      *
      * NO SELECCIONA REGISTROS CUYA OFICINA NO ESTE COMO PARAMETRO
           IF PAR-COD-OFOC IN PAR-VARI(1) NOT = '*  '
               MOVE 1 TO PAR-NUM-IVEC IN PAR-VARI
               PERFORM REV-COD-OFOC
               IF REG-NO-SELECCIONADO
                   GO TO FIN-SEL-REG-CAN
               ELSE
                   MOVE 0 TO PAR-IND-RSEL IN PAR-VARI.
      *
      * NO SELECCIONA REGISTROS CUYA MONEDA NO ESTE COMO PARAMETRO
           IF PAR-COD-VCOC IN PAR-VARI(1) NOT = '*     '
               MOVE 1 TO PAR-NUM-IVEC IN PAR-VARI
               PERFORM REV-COD-VCOC
               IF REG-NO-SELECCIONADO
                   GO TO FIN-SEL-REG-CAN
               ELSE
                   MOVE 0 TO PAR-IND-RSEL IN PAR-VARI.
      *
      * NO SELECCIONA REGISTROS CUYA LINEA NO ESTE EN PARAMETRO
           IF PAR-COD-COOC IN PAR-VARI(1) NOT = '*  '
               MOVE 1 TO PAR-NUM-IVEC IN PAR-VARI
               PERFORM REV-COD-COOC
               IF REG-NO-SELECCIONADO
                   GO TO FIN-SEL-REG-CAN
               ELSE
                   MOVE 0 TO PAR-IND-RSEL IN PAR-VARI.
      *
      * NO SELECCIONA REGISTROS CUYAS OPERACIONES  NO ESTAN EN PARAMETRO
           IF PAR-CIC-IOPC IN PAR-VARI(1) NOT = '*  '
               MOVE 1 TO PAR-NUM-IVEC IN PAR-VARI
               PERFORM REV-COD-OPER
               IF REG-NO-SELECCIONADO
                   GO TO FIN-SEL-REG-CAN
               ELSE
                   MOVE 0 TO PAR-IND-RSEL IN PAR-VARI.
      *
      * SELECCIONA REGISTRO
           MOVE 1 TO PAR-IND-RSEL IN PAR-VARI.

       FIN-SEL-REG-CAN.
           EXIT.
      ******************************************************************
      *RJZ INI 3-MAY-1995 11:56:50
       PRO-CYA SECTION.
      *===============
      * Los montos del abono liquido deben contabilizarse en cuentas
      * distintas dependiendo del Concepto del tipo de abono ( ctacte,
      * vvista, etc ).
      * Genera 'n' conceptos dependiendo de la cantidad de Conceptos
      * distintos correspondientes a los TCYA de las CYA's asociadas
      * al curse de la operacion.
      * Asigna a VEC-CPTO(i) el Concepto del(los) TCYA
      * Asigna a VEV-MONTO(i) la suma de montos de las CYA's cuyos
      * TCYA posean igual Concepto.
      * El concepto esta almacenado en las posiciones 31,32,33 de los
      * datos adicionales de la tabla MSC.TCYA
       INI-PRO-CYA.
      *-----------
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
              OR CYA-KEY-ICAN IN CYA  NOT = CAN-KEY-ICAN IN CAN
      *       OR CYA-CIC-IOPC IN CYA  NOT = OPC-CIC-IOPC IN OPC
      *       OR CYA-NUM-ICAN IN CYA  NOT = ZEROES SOLO CURSE
              DISPLAY 'ERROR LECTURA CYA PARA LLAVE: '
                                   CAN-KEY-ICAN IN CAN
              DISPLAY 'FIO-STAT DEL CYA :' FIO-STAT
              MOVE 'CYACURINEX' TO  MSG-COD-MENS IN MSG
           ELSE
              MOVE 'N' TO WSS-FIN-LOOP
              SET CYA-I TO 1
              PERFORM LOOP-CYA UNTIL FIN-LOOP
              SET CYA-TOPE TO CYA-I
              SET CYA-I TO 1
              PERFORM LOOP-VEC-CYA UNTIL CYA-I NOT < CYA-TOPE.
           GO TO FIN-PRO-CYA.
      *
       LOOP-CYA.
      *--------
      * Obtiene el Concepto para el TCYA
      * Chequea si el Concepto se repite en otro CYA ( cargado en matriz
      * Carga matriz con los Conceptos y sus montos ( del CYA ) y
      * acumula en caso de repetirse el Concepto.
           PERFORM OBT-CPTO-TCYA.
           PERFORM CHK-CPTO-EXIS.
           IF NOT EXISTE
              MOVE MSC-COD-DAT3 IN MSC (1) TO VEC-CPTO-CYA
                                          IN WSS-VARI (CYA-I)
              MOVE CYA-SGV-LIQU IN CYA TO VEC-MONTO-CYA
                                          IN WSS-VARI (CYA-I)
              SET CYA-I UP BY 1
           ELSE
              ADD CYA-SGV-LIQU IN CYA  TO VEC-MONTO-CYA
                                          IN WSS-VARI (EXI-I).

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
              OR CYA-KEY-ICAN IN CYA  NOT = CAN-KEY-ICAN IN CAN
      *       OR CYA-CIC-IOPC IN CYA  NOT = OPC-CIC-IOPC IN OPC
      *        OR CYA-NUM-ICAN IN CYA  NOT = ZEROES SOLO CURSE
              MOVE 'S' TO WSS-FIN-LOOP.
      *
       OBT-CPTO-TCYA.
      *-------------
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'MSC'                TO MSC-COD-TTAB IN MSC.
           MOVE 'TCYA'               TO MSC-COD-TMSC IN MSC.
           MOVE CYA-IND-TCYA IN CYA  TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY          TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
              MOVE 'COL'       TO MSG-COD-SIST
              MOVE 'CODTCYANEX' TO MSG-COD-MENS IN MSG
              PERFORM GET-MSG
              DISPLAY MSG-GLS-DESC   MSC-COD-CMSC
              PERFORM GNS-PRO-ABT
              GO TO FIN-PRO-CYA.
      *
       LOOP-VEC-CYA.
      *------------
      * Recorre matriz con acumulados por CIC
      * Graba en matriz definitiva los CIC y sus montos
           SET MOV-I UP BY 1.
           MOVE VEC-CPTO-CYA  IN WSS-VARI (CYA-I) TO
                VEC-CPTO      IN WSS-VARI (MOV-I).
           MOVE VEC-MONTO-CYA IN WSS-VARI (CYA-I) TO
                VEC-MONTO     IN WSS-VARI (MOV-I).
           MOVE 'L '                              TO
                VEC-ES-LIQ    IN WSS-VARI (MOV-I).

           SET CYA-I UP BY 1.
      *
       FIN-PRO-CYA.
      *-----------
           EXIT.
      *
       CHK-CPTO-EXIS SECTION.
      *=====================
       INI-CHK-EXI.
      *-----------
           MOVE 'N'     TO WSS-EXISTE
           SET EXI-TOPE TO CYA-I.
           SET EXI-I    TO 1.
           IF EXI-TOPE = EXI-I
              GO TO FIN-CHK-EXI.
       LUP-CHK-EXI.
      *-----------
           IF EXI-I NOT < EXI-TOPE
              GO TO FIN-CHK-EXI.
           IF MSC-COD-DAT3 IN MSC (1) = VEC-CPTO-CYA
                                        IN WSS-VARI (EXI-I)
              MOVE 'S' TO WSS-EXISTE
           ELSE
              SET EXI-I UP BY 1
              GO TO LUP-CHK-EXI.
       FIN-CHK-EXI.
      *-----------
           EXIT.
      *RJZ FIN 3-MAY-1995 11:57:01
      ********************************************************
      * ACCESA A LA OPERACION
       LEE-OPC SECTION.
       INI-LEE-OPC.
           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM COL-FIO-OPC
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO ENCONTRE OPERACION : '
                       OPC-CIC-IOPC IN OPC
              GO TO FIN-LEE-OPC.
      * RBG/INI/19-JUL-1996
           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
              MOVE 1 TO WSS-SGV-VCAM IN WSS-VARI
              GO TO FIN-LEE-OPC.
           MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
      *DPM ini  11-SEP-1996
      *Obtiene valor de cambio con Fecha de Colocacion de OPC original
           IF OPC-IND-RENO IN OPC = 'PRO'
      * Guarda el CIC de la OPC de la prorroga
               MOVE OPC-CIC-IOPC IN OPC TO AUX-CIC-IOPC IN WSS-VARI
      * Lee OPC original para rescatar la fecha de origen
               MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
      * Mueve fecha de OPC original para la conversion a valor origen
      *     MOVE OPC-FEC-FCOL IN OPC TO CAM-FEC-FCAM IN CAM(1).
                   MOVE OPC-FEC-FCOL IN OPC TO CAM-FEC-FCAM IN CAM(1)
      *     MOVE OPC-FEC-FCOL IN OPC TO CAM-FEC-FCAM IN CAM(2).
                   MOVE OPC-FEC-FCOL IN OPC TO CAM-FEC-FCAM IN CAM(2)
      * Vuelve a leer la OPC de la prorroga
                   MOVE AUX-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
               ELSE
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPCORIGNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
           ELSE
               MOVE OPC-FEC-FCOL IN OPC TO CAM-FEC-FCAM IN CAM(1)
               MOVE OPC-FEC-FCOL IN OPC TO CAM-FEC-FCAM IN CAM(2).
      *DPM fin  11-SEP-1996
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS AND CAM-IND-VIGE NOT = 'S'
              MOVE 'COL'        TO MSG-COD-SIST
              MOVE 'CAMVCAMNEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              DISPLAY MSG-GLS-DESC    CAM-KEY-CAMB IN CAM
              GO TO FIN-LEE-OPC.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM.
      * RBG/FIN/19-JUL-1996
       FIN-LEE-OPC.
           EXIT.
      ******************************************************************
      * REVISA SI OFICINA CORRESPONDE A PARAMETROS
       REV-COD-OFOC SECTION.
       INI-REV-COD-OFOC.
           IF CAN-COD-OFCA IN CAN =
              PAR-COD-OFOC IN PAR-VARI(PAR-NUM-IVEC IN PAR-VARI)
               MOVE 1 TO PAR-IND-RSEL IN PAR-VARI
               GO TO FIN-REV-COD-OFOC.
           ADD 1 TO PAR-NUM-IVEC IN PAR-VARI.
           IF PAR-NUM-IVEC IN PAR-VARI NOT > 10
               GO TO INI-REV-COD-OFOC.
       FIN-REV-COD-OFOC.
           EXIT.
      *
      ******************************************************************
      * REVISA SI MONEDA CORRESPONDE A PARAMETROS
       REV-COD-VCOC SECTION.
       INI-REV-COD-VCOC.
           IF OPC-COD-VCOC IN OPC =
              PAR-COD-VCOC IN PAR-VARI(PAR-NUM-IVEC IN PAR-VARI)
               MOVE 1 TO PAR-IND-RSEL IN PAR-VARI
               GO TO FIN-REV-COD-VCOC.
           ADD 1 TO PAR-NUM-IVEC IN PAR-VARI.
           IF PAR-NUM-IVEC IN PAR-VARI NOT > 10
               GO TO INI-REV-COD-VCOC.
       FIN-REV-COD-VCOC.
           EXIT.
      *
      ******************************************************************
      * REVISA SI LINEA CORRESPONDE A PARAMETROS
       REV-COD-COOC SECTION.
       INI-REV-COD-COOC.
           IF OPC-COD-COOC IN OPC =
              PAR-COD-COOC IN PAR-VARI(PAR-NUM-IVEC IN PAR-VARI)
               MOVE 1 TO PAR-IND-RSEL IN PAR-VARI
               GO TO FIN-REV-COD-COOC.
           ADD 1 TO PAR-NUM-IVEC IN PAR-VARI.
           IF PAR-NUM-IVEC IN PAR-VARI NOT > 10
               GO TO INI-REV-COD-COOC.
       FIN-REV-COD-COOC.
           EXIT.
      ******************************************************************
      * REVISA SI NRO. DE OPERACION CORRESPONDE A PARAMETROS
       REV-COD-OPER SECTION.
       INI-REV-COD-OPER.
           IF CAN-CIC-IOPC IN CAN =
              PAR-CIC-IOPC IN PAR-VARI(PAR-NUM-IVEC IN PAR-VARI)
               MOVE 1 TO PAR-IND-RSEL IN PAR-VARI
               GO TO FIN-REV-COD-OPER.
           ADD 1 TO PAR-NUM-IVEC IN PAR-VARI.
           IF PAR-NUM-IVEC IN PAR-VARI NOT > 6
               GO TO INI-REV-COD-OPER.
       FIN-REV-COD-OPER.
           EXIT.
      *
      ******************************************************************
      * LIMPIA VECTORES
       LIM-VEC SECTION.
       INI-LIM-VEC.
           MOVE ZEROES TO WSS-SGV-ICPN IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-ACUM IN WSS-VARI.
           SET MOV-I TO 1.
       LUP-LIM-VEC.
           IF MOV-I > 100
              GO TO FIN-LIM-VEC.
           MOVE SPACES TO  VEC-CPTO  (MOV-I).
           MOVE ZEROES TO  VEC-MONTO (MOV-I).
           MOVE SPACES TO  VEC-ES-LIQ (MOV-I).
       SIG-LIM-VEC.
           SET MOV-I UP BY 1.
           GO TO LUP-LIM-VEC.
       FIN-LIM-VEC.
           EXIT.

      *ALD-BCI-INI/05051998
       LEE-REG-COM SECTION.
       INI-LEE-REG-COM.

           MOVE ZEROES              TO WSS-SGV-MIVA.
           MOVE ZEROES              TO WSS-SGV-MNTO.

           MOVE 'N'                 TO WSS-IND-SWCOM.

           MOVE 'COM-KEY-IICG'      TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO COM-CIC-IOPC IN COM.
           MOVE CAN-NUM-ICAN IN CAN TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE SPACES              TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-REG-COM.
      *     DISPLAY 'ALD==> LEO COM ' COM-KEY-IICG IN COM.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
               COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
               CAN-NUM-ICAN IN CAN = COM-NUM-ICAN IN COM )
      *    DISPLAY 'ALD==> LEO COM NO OK ' COM-KEY-IICG IN COM
                 GO TO FIN-LEE-REG-COM
           ELSE
      *    DISPLAY 'ALD==> LEO COM OK (IND-TTAS) ' COM-IND-TTAS IN COM
               IF COM-IND-TTAS IN COM NOT = 'CMO'
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-REG-COM
               ELSE
      *    DISPLAY 'ALD==> LEO COM OK FECFINI :  ' COM-FEC-FINI IN COM
      *    DISPLAY 'ALD==> LEO COM OK FECFOUT :  ' CAN-FEC-FOUT IN CAN
                   IF COM-FEC-FINI IN COM NOT = CAN-FEC-FOUT IN CAN
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-LEE-REG-COM.

      *    DISPLAY 'ALD ==> ENCONTRE COM ' COM-KEY-IICG IN COM.

           MOVE 'S'                 TO WSS-IND-SWCOM.
           MOVE COM-SGV-MIVA IN COM TO WSS-SGV-MIVA.
           MOVE COM-SGV-MNTO IN COM TO WSS-SGV-MNTO.

       FIN-LEE-REG-COM.
           EXIT.
      *ALD-BCI-FIN/05051998
      *
      ******************************************************************
      * GUARDA EN VECTORES POR REGISTRO DE CANCELACION
       CAR-MOV-CAN SECTION.
      ********************
       INI-CAR-MOV-CAN.
      * RBG/FIN 19-NOV-1996

      *ALD-BCI-INI/05051998
           IF WSS-IND-SWCOM = 'N'
               GO TO CONT-PROC-NORM.
      *ALD-BCI-FIN/05051998

           IF COM-SGV-MIVA IN COM NOT = 0
              SET MOV-I UP BY 1
              MOVE 'IVACOM'            TO VEC-CPTO  IN WSS-VARI (MOV-I)
              MOVE COM-SGV-MIVA IN COM TO VEC-MONTO
                                            IN WSS-VARI (MOV-I).

           IF COM-SGV-MNTO IN COM NOT = 0
              SET MOV-I UP BY 1
              MOVE 'CONONO'            TO VEC-CPTO  IN WSS-VARI (MOV-I)
              MOVE COM-SGV-MNTO IN COM TO VEC-MONTO IN WSS-VARI (MOV-I)
              GO TO CONT-SIN-GTP.

      * RBG/FIN 19-NOV-1996
      * RBG/INI/19-NOV-1996
       CONT-PROC-NORM.
      * RBG/FIN/19-NOV-1996
      *RJZ INI 3-MAY-1995 14:41:29 Modificado solo lo que esta con *
      *    IF RCV-SGV-GAST IN RCV NOT = 0
           IF CAN-SGV-GAST IN CAN NOT = 0
               SET MOV-I UP BY 1
      *        ADD  RCV-SGV-GAST IN RCV TO WSS-SGV-ACUM IN WSS-VARI
               ADD  CAN-SGV-GAST IN CAN TO WSS-SGV-ACUM IN WSS-VARI
               MOVE 'GTP   '            TO VEC-CPTO  IN WSS-VARI (MOV-I)
      *        MOVE RCV-SGV-GAST IN RCV TO VEC-MONTO IN WSS-VARI (MOV-I)
               MOVE CAN-SGV-GAST IN CAN TO VEC-MONTO
                                           IN WSS-VARI (MOV-I).
      * RBG/INI/19-NOV-1996
       CONT-SIN-GTP.
      * RBG/FIN/19-NOV-1996
           IF CAN-SGV-DIFE IN CAN NOT = 0
               SET MOV-I UP BY 1
               ADD  CAN-SGV-DIFE IN CAN TO WSS-SGV-ACUM IN WSS-VARI
               MOVE 'VALDIF'            TO VEC-CPTO  IN WSS-VARI (MOV-I)
               MOVE CAN-SGV-DIFE IN CAN TO VEC-MONTO
                                              IN WSS-VARI (MOV-I).
      *RJZ FIN 3-MAY-1995 14:41:29
           IF CAN-SGV-TPAG IN CAN NOT = 0
              IF CAN-COD-OFCA IN CAN = OPC-COD-OFOC IN OPC
      *HZF INI  09-AUG-1996
                  NEXT SENTENCE
      *           SET MOV-I UP BY 1
      *           MOVE 'PAG   ' TO VEC-CPTO IN WSS-VARI (MOV-I)
      *           MOVE CAN-SGV-TPAG IN CAN TO VEC-MONTO
      *                                       IN WSS-VARI (MOV-I)
              ELSE
                  SET MOV-I UP BY 1
                  MOVE 'PAG   ' TO VEC-CPTO IN WSS-VARI (MOV-I)
                  MOVE CAN-SGV-TPAG IN CAN TO VEC-MONTO
                                              IN WSS-VARI (MOV-I)
      *DPM ini  26-AUG-1996
                  SUBTRACT VEC-MONTO IN WSS-VARI (MOV-I) FROM
                             WSS-SGV-REST IN WSS-VARI GIVING
                                    WSS-SGV-AUXI IN WSS-VARI
      *DPM fin  26-AUG-1996
      *HZF FIN  09-AUG-1996
                  SET MOV-I UP BY 1
                  MOVE 'PAGOOF' TO VEC-CPTO IN WSS-VARI (MOV-I)
                  MOVE CAN-SGV-TPAG IN CAN TO VEC-MONTO
                                              IN WSS-VARI (MOV-I).

      *RJZ INI 20-JUN-1995
      *            SET MOV-I UP BY 1
      *            MOVE 'PAG   ' TO VEC-CPTO IN WSS-VARI (MOV-I)
      *            MOVE CAN-SGV-TPAG IN CAN TO VEC-MONTO
      *                                        IN WSS-VARI (MOV-I).
      *RJZ FIN 20-JUN-1995
      *DPM ini  15-MAY-1997
      *     IF CAN-SGV-TREN IN CAN NOT = 0
           IF WSS-SGV-RENO IN WSS-VARI NOT = 0
      *DPM fin  15-MAY-1997
                  SET MOV-I UP BY 1
                  MOVE 'NEG   ' TO VEC-CPTO IN WSS-VARI (MOV-I)
      *DPM ini  15-MAY-1997
      *            MOVE CAN-SGV-TREN IN CAN TO VEC-MONTO
      *                                        IN WSS-VARI (MOV-I)
                  MOVE WSS-SGV-RENO IN WSS-VARI
                               TO VEC-MONTO IN WSS-VARI (MOV-I)
      *DPM fin  15-MAY-1997
                  IF CAN-MSC-TCAN IN CAN = 'P'
                      MOVE ZEROES TO WSS-SGV-REST IN WSS-VARI
                                     WSS-SGV-AUXI IN WSS-VARI
                      IF OPC-MSC-TVOC IN OPC = WSS-MSC-TVOC
                          MOVE VEC-MONTO IN WSS-VARI (MOV-I) TO
                          PES-SGV-DECI IN PES-VARI
                          PERFORM PES-SCTV
                          MOVE PES-SGV-ENTE IN PES-VARI TO
                          VEC-MONTO IN WSS-VARI (MOV-I).
      *RJZ INI 3-MAY-1995 18:48:40
      *Interes Punitorio
      *     IF CAN-SGV-IPUN IN CAN NOT = 0
      *        SET MOV-I UP BY 1
      *        ADD CAN-SGV-IPUN IN CAN
      *                          TO WSS-SGV-ACUM IN WSS-VARI
      *        MOVE 'INTMOR' TO VEC-CPTO IN WSS-VARI (MOV-I)
      *        MOVE CAN-SGV-IPUN IN CAN TO VEC-MONTO IN WSS-VARI (MOV-I)
      *Interes compensatorio en cuentas de suspenso
      *     IF CAN-MSC-FCAN IN CAN = 'T' AND
      *        CAN-MSC-ECAN IN CAN = 'T' AND
      *        RCV-IND-SCTB IN RCV = WSS-COD-SVCD IN WSS-VARI
      *           PERFORM LEE-VEN-SUS
      *           SET MOV-I UP BY 1
      *           MOVE 'INTSUS' TO VEC-CPTO IN WSS-VARI (MOV-I)
      *           MOVE WSS-VAL-INT-SUS TO VEC-MONTO IN WSS-VARI (MOV-I).
      *Interes compensatorio mora
      *     IF CAN-SGV-ICOM IN CAN NOT = 0
      *        SET MOV-I UP BY 1
      *        MOVE 'INTCMO' TO VEC-CPTO IN WSS-VARI (MOV-I)
      *        MOVE CAN-SGV-ICOM IN CAN TO VEC-MONTO IN WSS-VARI (MOV-I)
      *Interes compensatorio total
      *     IF WSS-OPEC = 'D'
      *        MOVE CAN-SGV-ICOM IN CAN TO WSS-SGV-ICPN
      *     ELSE
      *     IF WSS-OPEC = 'B'
      *        COMPUTE WSS-SGV-ICPN IN WSS-VARI = (CAN-SGV-TREN IN CAN +
      *                CAN-SGV-TPAG IN CAN - WSS-SGV-ACUM IN WSS-VARI)
      *     ELSE
      *        COMPUTE WSS-SGV-ICPN IN WSS-VARI = (CAN-SGV-TREN IN CAN +
      *                CAN-SGV-TPAG IN CAN - RCV-SGV-CAPI IN RCV -
      *                WSS-SGV-ACUM IN WSS-VARI).
      *     IF WSS-SGV-ICPN IN WSS-VARI NOT = 0
      *        SET MOV-I UP BY 1
      *        MOVE 'INTCPN'            TO VEC-CPTO IN WSS-VARI (MOV-I)
      *        MOVE WSS-SGV-ICPN IN WSS-VARI TO
      *                                 VEC-MONTO IN WSS-VARI (MOV-I)
      *Interes compensatorio sin incluir la mora
      *        SET MOV-I UP BY 1
      *        MOVE 'INT   '            TO VEC-CPTO IN WSS-VARI (MOV-I)
      *        MOVE WSS-SGV-ICPN IN WSS-VARI TO
      *                                 VEC-MONTO IN WSS-VARI (MOV-I)
      *        SUBTRACT CAN-SGV-ICOM IN CAN FROM
      *                                     VEC-MONTO IN WSS-VARI (MOV-I

      *RJZ FIN 3-MAY-1995 14:34:58
       FIN-CAR-MOV-CAN.
           EXIT.
      *RJZ INI 3-MAY-1995 14:36:45
      * LEE-VEN-SUS SECTION.
      * INI-LEE-VEN-SUS.
      *     MOVE 'SI' TO WSS-ES-VEN-IOPC.
      *     MOVE ZEROES TO WSS-VAL-INT-SUS.
      *     MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN.
      *     MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
      *     MOVE FIO-GET-NLS    TO FIO-CMND.
      * LUP-LEE-VEN-SUS.
      *     PERFORM COL-FIO-VEN.
      *     IF NOT ( FIO-STAT-OKS AND
      *              CAN-CIC-IOPC IN CAN =  VEN-CIC-IOPC IN VEN AND
      *              VEN-FEC-FVEN IN VEN < CAN-FEC-FEGR IN CAN)
      *        GO TO FIN-LEE-VEN-SUS.
      *     IF WSS-ES-VEN-IOPC = 'SI'
      *        MOVE 'NO' TO WSS-ES-VEN-IOPC
      *        MOVE CAN-KEY-ICAN IN CAN TO WSS-CAN IN WSS-VARI
      *        MOVE RCV-KEY-IRCV IN RCV TO WSS-RCV IN WSS-VARI
      *        PERFORM LEE-CAN-RCV-ANT
      *        MOVE FIO-GET-KEY    TO FIO-CMND
      *        MOVE WSS-CAN TO CAN-KEY-ICAN IN CAN
      *        MOVE WSS-RCV TO RCV-KEY-IRCV IN RCV
      *        IF WSS-SW-OK = 0
      *           IF RCV-NUM-IVCT IN RCV = VEN-NUM-IVCT IN VEN
      *              PERFORM COL-FIO-CAN
      *              PERFORM COL-FIO-RCV
      *              GO TO NXT-LEE-VEN-SUS
      *           ELSE
      *              PERFORM COL-FIO-CAN
      *              PERFORM COL-FIO-RCV
      *        ELSE
      *           PERFORM COL-FIO-CAN
      *           PERFORM COL-FIO-RCV.
      *     ADD VEN-VAL-FINA IN VEN TO WSS-VAL-INT-SUS.
      *     SUBTRACT VEN-VAL-FINA IN VEN FROM WSS-VAL-INT-SUS.
      * NXT-LEE-VEN-SUS.
      *     MOVE FIO-GET-NXT    TO FIO-CMND.
      *     GO TO LUP-LEE-VEN-SUS.
      * FIN-LEE-VEN-SUS.
      *     EXIT.
      ************************************************
      * LEE-CAN-RCV-ANT SECTION.
      * INI-LEE-CAN-RCV-ANT.
      *     MOVE 1 TO WSS-SW-OK.
      * LUP-LEE-CAN-RCV-ANT.
      *     SUBTRACT 1 FROM  CAN-NUM-ICAN IN CAN.
      *     IF CAN-NUM-ICAN  IN CAN < 1
      *        GO TO FIN-LEE-CAN-RCV-ANT.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM COL-FIO-CAN.
      *     IF NOT FIO-STAT-OKS
      *        GO TO LUP-LEE-CAN-RCV-ANT.
      *     IF NOT OPC-CIC-IOPC IN OPC = CAN-CIC-IOPC IN CAN
      *        GO TO FIN-LEE-CAN-RCV-ANT.
      *     IF NOT ( CAN-MSC-STAT IN CAN  = 'A' AND
      *              CAN-SGV-TPAG IN CAN NOT < 0 AND
      *              CAN-SGV-TREN IN CAN NOT < 0 )
      *        GO TO LUP-LEE-CAN-RCV-ANT.
      *     MOVE CAN-KEY-ICAN     IN CAN   TO  RCV-KEY-ICAN   IN RCV
      *     MOVE CAN-CIC-IOPC     IN CAN   TO  RCV-CIC-IOPC   IN RCV
      *     MOVE ZEROES                    TO  RCV-NUM-IVCT   IN RCV
      *     MOVE FIO-GET-NLS               TO  FIO-CMND.
      *     PERFORM COL-FIO-RCV.
      *     IF NOT (FIO-STAT-OKS AND
      *             CAN-KEY-ICAN IN CAN = RCV-KEY-ICAN IN RCV)
      *        GO TO FIN-LEE-CAN-RCV-ANT.
      *     MOVE 0 TO WSS-SW-OK.
      * FIN-LEE-CAN-RCV-ANT.
      *     EXIT.
      *
      *RJZ FIN 3-MAY-1995 14:37:57
      ******************************************************************
      * GUARDA EN VECTORES POR REGISTRO DE RCV
       CAR-MOV-RCV SECTION.
       INI-CAR-MOV-RCV.
      *RJZ INI 3-MAY-1995 14:37:57
            SET MOV-I TO  1.
            SET MOV-I DOWN BY 1.
      *      IF RCV-SGV-REAO IN RCV NOT = 0
      *         SET MOV-I UP BY 1
      *         ADD RCV-SGV-REAO IN RCV TO WSS-SGV-ACUM IN WSS-VARI
      *         MOVE 'RJSORD'           TO VEC-CPTO  IN WSS-VARI (MOV-I)
      *         MOVE RCV-SGV-REAO IN RCV TO VEC-MONTO
      *                                     IN WSS-VARI (MOV-I).
      *      IF RCV-SGV-INTO IN RCV NOT = 0
      *         SET MOV-I UP BY 1
      *         ADD  RCV-SGV-INTO IN RCV TO WSS-SGV-ACUM IN WSS-VARI
      *         MOVE 'INTORD'            TO VEC-CPTO  IN WSS-VARI (MOV-I
      *         MOVE RCV-SGV-INTO IN RCV TO VEC-MONTO
      *                                     IN WSS-VARI (MOV-I).
      * RJZ FIN 3-MAY-1995 14:37:57

      * RBG/INI/19-JUL-1996

      *DPM ini  11-OCT-1996
           IF WSS-OPEC NOT = 'D' AND
              WSS-IND-SLFI IN WSS-VARI NOT = 'S'
             MULTIPLY RCV-SGV-CAPI IN RCV BY WSS-SGV-VCAM IN WSS-VARI
             GIVING WSS-SGV-PASO IN WSS-VARI ROUNDED
           ELSE
           IF RCV-MSC-MCAN IN RCV NOT = 'V'
             MULTIPLY RCV-SGV-CAPI IN RCV BY WSS-SGV-VCAM IN WSS-VARI
             GIVING WSS-SGV-PASO IN WSS-VARI ROUNDED
           ELSE
             MULTIPLY RCV-SGV-FINA IN RCV BY WSS-SGV-VCAM IN WSS-VARI
             GIVING WSS-SGV-PASO IN WSS-VARI ROUNDED.
      *DPM fin  11-OCT-1996

           IF OPC-MSC-TVOC IN OPC = WSS-MSC-TVOC IN WSS-VARI
              MOVE WSS-SGV-PASO IN WSS-VARI TO
                   PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO
                   WSS-SGV-PASO IN WSS-VARI.

      *DPM ini  10-OCT-1996 Los intereses ahora vienen directo de la RCV
      *DPM ini  9-OCT-1996 Hay trato especial si hay boletas de garantia
      *     IF WSS-OPEC NOT = 'B'
      *DPM fin  9-OCT-1996
      *       COMPUTE WSS-SGV-INTN IN WSS-VARI = (CAN-SGV-TREN IN CAN  +
      *                                           CAN-SGV-TPAG IN CAN) -
      *                                           WSS-SGV-PASO         -
      *                                           RCV-SGV-INTM IN RCV  -
      *DPM ini  26-AUG-1996
      *                                           CAN-SGV-GAST IN CAN -
      *DPM fin  26-AUG-1996
      *DPM ini  9-OCT-1996 Se incluyo el ELSE
      *                                           RCV-SGV-REAJ IN RCV.
      *                                           RCV-SGV-REAJ IN RCV
      *     ELSE
      *       COMPUTE WSS-SGV-INTN IN WSS-VARI = (CAN-SGV-TPAG IN CAN  -
      *                                           RCV-SGV-INTM IN RCV).
      *DPM fin  9-OCT-1996

      * RJZ INI 3-MAY-1995 14:37:57
           IF RCV-SGV-INTM IN RCV NOT = 0 OR
              CAN-SGV-IMOK IN CAN NOT = 0
              SET MOV-I UP BY 1
              ADD  RCV-SGV-INTM IN RCV TO WSS-SGV-ACUM IN WSS-VARI
              MOVE 'INTMOR'            TO VEC-CPTO  IN WSS-VARI (MOV-I)
              MOVE RCV-SGV-INTM IN RCV TO VEC-MONTO
                                                    IN WSS-VARI (MOV-I)
              ADD CAN-SGV-IMOK IN CAN TO VEC-MONTO
                                                    IN WSS-VARI (MOV-I)
              ADD CAN-SGV-IMOK IN CAN TO WSS-SGV-ACUM IN WSS-VARI
      *DPM ini  18-APR-1997 Se guarda RJS o INTM o IMOK si es > 0
      *para cuadrar con INTN si son < 0
              IF RCV-SGV-INTM IN RCV > 0
                  MOVE RCV-SGV-INTM IN RCV TO
                              WSS-SGV-MONTO IN WSS-VARI
                  SET MOV-MON TO MOV-I
              ELSE
              IF CAN-SGV-IMOK IN CAN > 0
                  MOVE CAN-SGV-IMOK IN CAN TO
                              WSS-SGV-MONTO IN WSS-VARI
                  SET MOV-MON TO MOV-I.
      *DPM fin  18-APR-1997

      *DPM fin  22-OCT-1996

      * RBG/INI/19-JUL-1996
           COMPUTE WSS-SGV-REAJ IN WSS-VARI =
      *DPM ini  10-OCT-1996
      *                       RCV-SGV-REAJ IN RCV - RCV-SGV-REAM IN RCV.
                             RCV-SGV-REAJ IN RCV.
      *DPM fin  10-OCT-1996
           IF WSS-SGV-REAJ IN WSS-VARI NOT = 0
              SET MOV-I UP BY 1
              MOVE 'RJS   '            TO VEC-CPTO  IN WSS-VARI (MOV-I)
              IF OPC-MSC-TVOC IN OPC = WSS-MSC-TVOC IN WSS-VARI
                 MOVE WSS-SGV-REAJ IN WSS-VARI TO
                      PES-SGV-DECI IN PES-VARI
                 PERFORM PES-SCTV
                 MOVE PES-SGV-ENTE IN PES-VARI TO
                      WSS-SGV-REAJ IN WSS-VARI
                 MOVE WSS-SGV-REAJ IN WSS-VARI TO VEC-MONTO IN
                                                      WSS-VARI (MOV-I)
                 ADD  WSS-SGV-REAJ IN WSS-VARI TO
                                    WSS-SGV-ACUM IN WSS-VARI
      *DPM ini  26-AUG-1996
                 ADD VEC-MONTO IN WSS-VARI (MOV-I) TO
                                      WSS-SGV-REST IN WSS-VARI
      *DPM fin  26-AUG-1996
      *DPM ini  18-APR-1997 Se guarda RJS o INTM o IMOK si es > 0
      *para cuadrar con INTN si son < 0
                 MOVE VEC-MONTO IN WSS-VARI (MOV-I) TO
                                       WSS-SGV-MONTO IN WSS-VARI
                 SET MOV-MON TO MOV-I
      *DPM fin  18-APR-1997
              ELSE
                 MOVE WSS-SGV-REAJ IN WSS-VARI TO VEC-MONTO IN
                                                      WSS-VARI (MOV-I)
      *DPM ini  26-AUG-1996
                 ADD VEC-MONTO IN WSS-VARI (MOV-I) TO
                                      WSS-SGV-REST IN WSS-VARI
      *DPM fin  26-AUG-1996
                 ADD  WSS-SGV-REAJ IN WSS-VARI TO
                                      WSS-SGV-ACUM IN WSS-VARI
      *DPM ini  18-APR-1997 Se guarda RJS o INTM o IMOK si es > 0
      *para cuadrar con INTN si son < 0
                 MOVE VEC-MONTO IN WSS-VARI (MOV-I) TO
                                       WSS-SGV-MONTO IN WSS-VARI
                 SET MOV-MON TO MOV-I.
      *DPM fin  18-APR-1997


      *DPM ini  10-OCT-1996
      *     IF RCV-SGV-REAM IN RCV NOT = 0
      *        SET MOV-I UP BY 1
      *        ADD  RCV-SGV-REAM IN RCV TO WSS-SGV-ACUM IN WSS-VARI
      *        MOVE 'RJSMOR'            TO VEC-CPTO  IN WSS-VARI (MOV-I)
      *        MOVE RCV-SGV-REAM IN RCV TO VEC-MONTO
      *                                    IN WSS-VARI (MOV-I).
      *DPM fin  10-OCT-1996
      * RJZ FIN 3-MAY-1995 15:27:28
      * RBG/INI/19-JUL-1996
      *DPM ini  17-MAR-1997 Considerar solo RCV-SGV-CAPI para CPA
      *DPM ini  8-OCT-1996 Modificado cuando opera como D
      *     IF WSS-OPEC NOT = 'D' AND
      *       WSS-IND-SLFI IN WSS-VARI = 'S'
      *DPM fin  8-OCT-1996
      *       IF RCV-SGV-FINA IN RCV NOT = 0
      *         SET MOV-I UP BY 1
      *         MOVE 'CPA   '         TO VEC-CPTO IN WSS-VARI (MOV-I)
      *         MULTIPLY RCV-SGV-FINA IN RCV BY WSS-SGV-VCAM IN WSS-VARI
      *         GIVING WSS-SGV-PASO IN WSS-VARI ROUNDED
      *         IF OPC-MSC-TVOC IN OPC = WSS-MSC-TVOC IN WSS-VARI
      *           MOVE WSS-SGV-PASO IN WSS-VARI TO
      *              PES-SGV-DECI IN PES-VARI
      *           PERFORM PES-SCTV
      *           MOVE PES-SGV-ENTE IN PES-VARI TO
      *              WSS-SGV-PASO IN WSS-VARI
      *           MOVE WSS-SGV-PASO IN WSS-VARI TO VEC-MONTO IN
      *                                              WSS-VARI (MOV-I)
      *           ADD VEC-MONTO IN WSS-VARI (MOV-I) TO
      *                              WSS-SGV-REST IN WSS-VARI
      *         ELSE
      *           MOVE WSS-SGV-PASO IN WSS-VARI TO VEC-MONTO IN
      *                                              WSS-VARI (MOV-I)
      *           ADD VEC-MONTO IN WSS-VARI (MOV-I) TO
      *                              WSS-SGV-REST IN WSS-VARI
      *       ELSE
      *         NEXT SENTENCE
      *     ELSE
      *DPM fin  17-MAR-1997
           IF RCV-SGV-CAPI IN RCV NOT = 0
             SET MOV-I UP BY 1
             MOVE 'CPA   '         TO VEC-CPTO IN WSS-VARI (MOV-I)
             MULTIPLY RCV-SGV-CAPI IN RCV BY WSS-SGV-VCAM IN WSS-VARI
                              GIVING WSS-SGV-PASO IN WSS-VARI ROUNDED
             IF OPC-MSC-TVOC IN OPC = WSS-MSC-TVOC IN WSS-VARI
               MOVE WSS-SGV-PASO IN WSS-VARI TO
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    WSS-SGV-PASO IN WSS-VARI
      *ALD-BCI-INI/12051998
               PERFORM AJU-SOL-CAPI
      *ALD-BCI-FIN/12051998
               MOVE WSS-SGV-PASO IN WSS-VARI TO VEC-MONTO IN
                                                    WSS-VARI (MOV-I)
      *DPM ini  26-AUG-1996
               ADD VEC-MONTO IN WSS-VARI (MOV-I) TO
                                    WSS-SGV-REST IN WSS-VARI
      *DPM fin  26-AUG-1996
             ELSE
               MOVE WSS-SGV-PASO IN WSS-VARI TO VEC-MONTO IN
      *DPM ini  26-AUG-1996
                                                    WSS-VARI (MOV-I)
               ADD VEC-MONTO IN WSS-VARI (MOV-I) TO
                                    WSS-SGV-REST IN WSS-VARI.
      *DPM fin  26-AUG-1996
      *DPM ini  8-OCT-1996
      *DPM fin  8-OCT-1996
      *           COMPUTE VEC-MONTO IN WSS-VARI (MOV-I) =
      *                  RCV-SGV-CAPI IN RCV * WSS-SGV-VCAM IN WSS-VARI.
      * RBG/FIN/19-JUL-1996

           MOVE RCV-SGV-INTN IN RCV TO WSS-SGV-INTN IN WSS-VARI.

      *DPM ini  21-OCT-1996
           IF VEC-CPTO IN WSS-VARI (MOV-I) = 'CPA   '
               MOVE VEC-MONTO IN WSS-VARI (MOV-I) TO WSS-SGV-CAPI
           ELSE
               MOVE ZEROES TO WSS-SGV-CAPI IN WSS-VARI.

      *DPM ini  27-MAR-1997 Se cuadra CAP con NEG para tener dif. cero
      * solo si es PRO. Si no es PRO se cuadra en interactivo
           IF CAN-MSC-TCAN IN CAN = 'P' AND
              OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
               MULTIPLY ROV-SGV-RENO IN ROV BY
                        WSS-SGV-VCAM IN WSS-VARI GIVING
                        WSS-SGV-RENO IN WSS-VARI
           ELSE
           IF CAN-MSC-TCAN IN CAN = 'P'
               MOVE ROV-SGV-RENO IN ROV TO WSS-SGV-RENO IN WSS-VARI
           ELSE
               MOVE CAN-SGV-TREN IN CAN TO WSS-SGV-RENO IN WSS-VARI.

      * DPM ini  7-JAN-1998 Si la dif. entre el tot. renovado de la CAN
      * y el valor renovado calculado segun ROV es +-10, se debe dejar
      * el valor de la CAN, para no provocar valores negativos en los
      * calculos
           SUBTRACT WSS-SGV-RENO IN WSS-VARI FROM CAN-SGV-TREN IN CAN
                    GIVING WSS-SGV-TREN IN WSS-VARI.

           IF WSS-SGV-TREN IN WSS-VARI NOT < -10 AND
              WSS-SGV-TREN IN WSS-VARI NOT > 10
               MOVE CAN-SGV-TREN IN CAN TO WSS-SGV-RENO IN WSS-VARI.
      * DPM fin  7-JAN-1998

           IF VEC-CPTO IN WSS-VARI (MOV-I) = 'CPA   ' AND
              (CAN-MSC-TCAN IN CAN = 'P' OR
              CAN-MSC-TCAN IN CAN = 'R')
               IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
                   COMPUTE WSS-VAL-DIFE IN WSS-VARI =
                                    WSS-SGV-CAPI IN WSS-VARI -
                                    WSS-SGV-RENO IN WSS-VARI
                   MOVE WSS-VAL-DIFE IN WSS-VARI
                                  TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-DIFE
                   IF WSS-VAL-DIFE IN WSS-VARI > -10 AND
                      WSS-VAL-DIFE IN WSS-VARI < 10
                       MOVE WSS-SGV-RENO IN WSS-VARI
                                     TO VEC-MONTO IN WSS-VARI (MOV-I)
                       MOVE VEC-MONTO IN WSS-VARI (MOV-I)
                                     TO PES-SGV-DECI IN PES-VARI
                       PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE IN PES-VARI
                                     TO VEC-MONTO IN WSS-VARI (MOV-I)
                       MOVE VEC-MONTO IN WSS-VARI (MOV-I)
                                     TO WSS-SGV-CAPI IN WSS-VARI
                       MOVE WSS-SGV-RENO IN WSS-VARI
                                     TO PES-SGV-DECI IN PES-VARI
                       PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE IN PES-VARI
                                     TO WSS-SGV-RENO IN WSS-VARI.
      *DPM fin  27-MAR-1997
      *ALD-BCI-INI/05031999
           MOVE OPC-NUM-SINP IN OPC TO WSS-NUM-SSA1.
           MOVE OPC-NUM-AINP IN OPC TO WSS-NUM-ASA1.
           MOVE CAN-NUM-SOUT IN CAN TO WSS-NUM-SSA2.
           MOVE CAN-NUM-AOUT IN CAN TO WSS-NUM-ASA2.
           IF DLC-IND-SCTB IN DLC = 'CAS' AND
              WSS-FEC-FSA1        = WSS-FEC-FSA2 AND
              RCV-SGV-CAPI IN RCV NOT = 0 AND
              VEC-CPTO IN WSS-VARI (MOV-I) = 'CPA   '
               MOVE VEC-MONTO IN WSS-VARI (MOV-I) TO WSS-SGV-PASO
               SET MOV-I UP BY 1
               MOVE WSS-SGV-PASO TO VEC-MONTO IN WSS-VARI (MOV-I)
               MOVE 'KPA   '     TO VEC-CPTO IN WSS-VARI  (MOV-I).
      *ALD-BCI-FIN/05031999

           IF OPC-MSC-TVOC IN OPC = WSS-MSC-TVOC IN WSS-VARI
              MOVE WSS-SGV-REAJ IN WSS-VARI TO
                   PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO
                   WSS-SGV-REAJ IN WSS-VARI.

           IF CAN-MSC-TCAN IN CAN = 'P'
             COMPUTE WSS-SGV-INTN IN WSS-VARI =
                                      WSS-SGV-RENO IN WSS-VARI +
                                      CAN-SGV-TPAG IN CAN -
                                      WSS-SGV-CAPI IN WSS-VARI -
                                      WSS-SGV-REAJ IN WSS-VARI -
      *ALD-BCI-INI/05051998
                                      WSS-SGV-MNTO IN WSS-VARI -
                                      WSS-SGV-MIVA IN WSS-VARI -

      *ALD-BCI-FIN/05051998
                                    ( RCV-SGV-INTM IN RCV +
                                      CAN-SGV-IMOK IN CAN ).
      *DPM fin  21-OCT-1996

           IF WSS-SGV-INTN IN WSS-VARI NOT = 0
               IF OPC-MSC-TVOC IN OPC = WSS-MSC-TVOC IN WSS-VARI
                  MOVE WSS-SGV-INTN IN WSS-VARI TO
                       PES-SGV-DECI IN PES-VARI
                  PERFORM PES-SCTV
                  MOVE PES-SGV-ENTE IN PES-VARI TO
                       WSS-SGV-INTN IN WSS-VARI.

           IF WSS-SGV-INTN IN WSS-VARI NOT = 0
      *DPM ini  18-APR-1997 Se guarda RJS o INTM o IMOK si es > 0
      *para cuadrar con INTN si son < 0
              IF WSS-SGV-INTN IN WSS-VARI < 0
                 ADD WSS-SGV-INTN IN WSS-VARI
                                  TO WSS-SGV-MONTO IN WSS-VARI
                 MOVE WSS-SGV-MONTO IN WSS-VARI TO
                              VEC-MONTO IN WSS-VARI (MOV-MON)
                 MOVE ZEROES TO WSS-SGV-INTN IN WSS-VARI
              ELSE
      *DPM fin  18-APR-1997
                 SET MOV-I UP BY 1
                 MOVE 'INT   ' TO VEC-CPTO  IN WSS-VARI (MOV-I)
                 MOVE WSS-SGV-INTN IN WSS-VARI TO VEC-MONTO IN
                                               WSS-VARI (MOV-I)
                 ADD WSS-SGV-INTN IN WSS-VARI TO
                                       WSS-SGV-ACUM IN WSS-VARI
      *DPM ini  26-AUG-1996
                 ADD VEC-MONTO IN WSS-VARI (MOV-I) TO
                                       WSS-SGV-REST IN WSS-VARI.
      *DPM fin  26-AUG-1996

      *DPM ini  16-JAN-1997 Si es Doc Dsctdo no considerar INTPNG
      *DPM ini  10-OCT-1996
      *     IF WSS-SGV-INTN IN WSS-VARI NOT = 0 AND
      *        (WSS-OPEC = 'D' OR
      *        WSS-IND-SLFI IN WSS-VARI = 'S') AND
      *        RCV-MSC-MCAN IN RCV NOT = 'V'
           IF WSS-OPEC NOT = 'D' AND
              WSS-IND-SLFI IN WSS-VARI = 'S' AND
              WSS-SGV-INTN IN WSS-VARI NOT = 0
      *DPM fin  16-JAN-1997
               SET MOV-I UP BY 1
               MOVE 'INTPNG'           TO VEC-CPTO IN WSS-VARI (MOV-I)
               IF OPC-MSC-TVOC IN OPC = WSS-MSC-TVOC IN WSS-VARI
                  MOVE WSS-SGV-INTN IN WSS-VARI TO
                       PES-SGV-DECI IN PES-VARI
                  PERFORM PES-SCTV
                  MOVE PES-SGV-ENTE IN PES-VARI TO
                       WSS-SGV-INTN IN WSS-VARI
                  MOVE WSS-SGV-INTN IN WSS-VARI TO VEC-MONTO IN
                                                       WSS-VARI (MOV-I)
                  ADD WSS-SGV-INTN IN WSS-VARI TO
                                       WSS-SGV-ACUM IN WSS-VARI
                  ADD VEC-MONTO IN WSS-VARI (MOV-I) TO
                                       WSS-SGV-REST IN WSS-VARI
               ELSE
                  MOVE WSS-SGV-INTN IN WSS-VARI TO VEC-MONTO IN
                                                       WSS-VARI (MOV-I)
                  ADD VEC-MONTO IN WSS-VARI (MOV-I) TO
                                       WSS-SGV-REST IN WSS-VARI
                  ADD WSS-SGV-INTN IN WSS-VARI TO
                              WSS-SGV-ACUM IN WSS-VARI.

      *         SET MOV-I UP BY 1
      *         ADD RCV-SGV-INTN IN RCV TO WSS-SGV-ACUM IN WSS-VARI
      *         MOVE 'INT   '           TO VEC-CPTO  IN WSS-VARI (MOV-I)
      *         MOVE RCV-SGV-INTN IN RCV TO VEC-MONTO IN
      *                                               WSS-VARI (MOV-I).
      *DPM fin  10-OCT-1996

      * RBG/FIN/19-JUL-1996

      *DPM ini  18-APR-1997
           MOVE ZEROES TO WSS-SGV-MONTO IN WSS-VARI.
           SET MOV-MON TO 1.
      *DPM fin  18-APR-1997
        FIN-CAR-MOV-RCV.
           EXIT.
      *
      ******************************************************************
      *RJZ INI 3-MAY-1995 14:39:18
      * GUARDA EN VECTORES POR REGISTROS ICG
      * CAR-MOV-ICG SECTION.
      * INI-CAR-MOV-ICG.
      *     IF ICG-IND-TTAS IN ICG = 'GASGEN' AND
      *        RCV-IND-SCTB IN RCV = WSS-COD-SVCD IN WSS-VARI
      *        IF CAN-COD-OFCA IN CAN = OPC-COD-OFOC IN OPC
      *           MOVE 'GASNOT' TO ICG-IND-TTAS IN ICG
      *        ELSE
      *           MOVE 'GASNOF' TO ICG-IND-TTAS IN ICG.
      *     IF ICG-SGV-MNTO IN ICG > 0
      *        IF WSS-GLS-NTAS IN WSS-VARI = 'IMP' AND
      *           ICG-IND-TTAS IN ICG NOT = 'IMPINT'
      *           IF WSS-ANT-NTAS IN WSS-VARI NOT = ICG-GLS-NTAS IN ICG
      *              MOVE ICG-GLS-NTAS IN ICG TO WSS-ANT-NTAS IN WSS-VAR
      *              SET MOV-I UP BY 1
      *              MOVE 'IMPCOM' TO VEC-CPTO IN WSS-VARI (MOV-I)
      *              ADD ICG-SGV-MNTO IN ICG
      *                                TO WSS-SGV-ACUM IN WSS-VARI
      *              MOVE ICG-SGV-MNTO IN ICG
      *                             TO VEC-MONTO IN WSS-VARI (MOV-I)
      *           ELSE
      *              ADD ICG-SGV-MNTO IN ICG
      *                                TO WSS-SGV-ACUM IN WSS-VARI
      *              ADD ICG-SGV-MNTO IN ICG
      *                             TO VEC-MONTO IN WSS-VARI (MOV-I)
      *        ELSE
      *           SET MOV-I UP BY 1
      *           ADD ICG-SGV-MNTO IN ICG
      *                             TO WSS-SGV-ACUM IN WSS-VARI
      *           MOVE ICG-IND-TTAS IN ICG
      *                             TO VEC-CPTO IN WSS-VARI (MOV-I)
      *           MOVE ICG-SGV-MNTO IN ICG
      *                             TO VEC-MONTO IN WSS-VARI (MOV-I).
      * FIN-CAR-MOV-ICG.
      *     EXIT.
      *RJZ FIN 3-MAY-1995 14:39:52
      ******************************************************************
      * CERRAR ARCHIVOS
       CLOSE-FILE SECTION.
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-DLC.
      *RJZ INI 8-MAY-1995 15:35:23
      *     PERFORM COL-FIO-ICG.
           PERFORM COL-FIO-ERC.
           PERFORM COL-FIO-REV.
      *RJZ FIN 8-MAY-1995 15:35:23
           PERFORM COL-FIO-MCD.
           MOVE 'COL' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
       FIN-CLOSE-FILE.
           EXIT.
      *
      ******************************************************************
      * OBTIENE LA DLC
       LEE-DLC SECTION.
       INI-LEE-DLC.
           MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC.
           MOVE RCV-NUM-IDLC IN RCV TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLC    INEX' TO  MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RCV-KEY-IRCV IN RCV
               GO TO FIN-LEE-DLC.
       FIN-LEE-DLC.
           EXIT.
      *
      ******************************************************************
      * LEE LA RCV (OBTIENE CAPITAL PAGADO O TRASPASADO, NRO. VENC.)
       LEE-RCV SECTION.
       INI-LEE-RCV.
           MOVE CAN-KEY-ICAN IN CAN TO RCV-KEY-ICAN IN RCV
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV
           MOVE ZEROES              TO RCV-NUM-IVCT IN RCV
           MOVE FIO-GET-NLS TO FIO-CMND
           PERFORM COL-FIO-RCV
           IF NOT ( FIO-STAT-OKS AND
                    CAN-KEY-ICAN IN CAN = RCV-KEY-ICAN IN RCV )
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RCVNL' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RCV-KEY-IRCV IN RCV
               GO TO FIN-LEE-RCV.
      * RBG/INI/22-JUL-1996
      *DPM ini  10-OCT-1996
      *     IF RCV-SGV-REAM IN RCV IS NOT NUMERIC
      *        MOVE ZEROES TO RCV-SGV-REAM IN RCV.
      *DPM ini  10-OCT-1996
      *     IF RCV-SGV-INTM IN RCV IS NOT NUMERIC
      *        MOVE ZEROES TO RCV-SGV-INTM IN RCV.
      * RBG/FIN/22-JUL-1996
       FIN-LEE-RCV.
           EXIT.
      *****************************************************************
      *RJZ INI 20-JUN-1995
       GRABA-REV SECTION.
       INI-GRABA-REV.
           MOVE CAN TO REV.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-REV.
       FIN-GRABA-REV.
           EXIT.
      *RJZ FIN 20-JUN-1995
      ******************************************************************
      * GRABA MOVIMIENTO EN ARCHIVO MCD DESDE VECTORES
       GRA-MOV SECTION.
       INI-GRA-MOV.
           SET MOV-TOPE TO MOV-I.
           SET MOV-I TO 1.
       LUP-GRA-MOV.
           IF MOV-I > MOV-TOPE
              GO TO FIN-GRA-MOV.
           MOVE SPACES                        TO MCD-GLS-FLAG IN MCD.
           MOVE WSS-COD-CAN IN WSS-VARI    TO MCD-COD-MVTO IN MCD.
           MOVE OPC-COD-VCOC IN OPC           TO MCD-COD-VCOC IN MCD.
           MOVE OPC-COD-COOC IN OPC           TO MCD-COD-COOC IN MCD.
           MOVE CAN-FEC-FEGR IN CAN           TO MCD-FEC-FCTB IN MCD.
           MOVE DLC-IND-SCRT IN DLC           TO MCD-IND-SCRT IN MCD.
      *DPM ini  13-JAN-1997 Modificado para contemplar sit. vencida
           IF RCV-IND-SCTB IN RCV = 'MOR' OR '   '
             IF  DLC-IND-SCTB IN DLC = 'MUL'
               MOVE SPACES                    TO MCD-IND-SCTB IN MCD
             ELSE
               MOVE DLC-IND-SCTB IN DLC       TO MCD-IND-SCTB IN MCD
           ELSE
             MOVE RCV-IND-SCTB IN RCV       TO MCD-IND-SCTB IN MCD.
      *DPM fin  13-JAN-1997
           MOVE CAN-CIC-IOPC IN CAN           TO MCD-CIC-IOPC IN MCD.
           MOVE CAN-NUM-ICAN IN CAN           TO MCD-NUM-ICAN IN MCD.
           MOVE VEC-CPTO IN WSS-VARI (MOV-I)  TO MCD-SGV-CPTO IN MCD.
           MOVE VEC-MONTO IN WSS-VARI (MOV-I) TO MCD-SGV-MNTO IN MCD.
      *RJZ INI 24-MAYO-95
           MOVE VEC-ES-LIQ IN WSS-VARI (MOV-I) TO MCD-IND-LIQU IN MCD.
           MOVE CAN-FEC-FCAN IN CAN           TO MCD-FEC-FREA IN MCD.
           MOVE CAN-MSC-CANC IN CAN           TO MCD-IND-CANC IN MCD.
           IF CAN-COD-OFCA IN CAN NOT = OPC-COD-OFOC IN OPC
              IF VEC-ES-LIQ IN WSS-VARI (MOV-I) = 'L ' OR
                 VEC-CPTO IN WSS-VARI (MOV-I) = 'PAG   '
                 MOVE CAN-COD-OFCA IN CAN TO MCD-COD-OFOC IN MCD
              ELSE
                 MOVE OPC-COD-OFOC IN OPC TO MCD-COD-OFOC IN MCD
           ELSE
              MOVE OPC-COD-OFOC IN OPC TO MCD-COD-OFOC IN MCD.
           MOVE OPC-COD-OFOC IN OPC   TO MCD-COD-OFMV IN MCD.
           MOVE CAN-COD-OFCA IN CAN   TO MCD-COD-OFCA IN MCD.
      *RJZ FIN 24-MAYO-95

      * RBG/INI/29-JUL-1996
      *    MOVE RCV-IND-SCBZ IN RCV           TO MCD-IND-SCBZ IN MCD.
           IF DLC-IND-SCBZ IN DLC < SPACES
              MOVE SPACES TO MCD-IND-SCBZ IN MCD
           ELSE
              MOVE DLC-IND-SCBZ IN DLC        TO MCD-IND-SCBZ IN MCD.
      * RBG/FIN/29-JUL-1996
           MOVE DLC-COD-PLZO IN DLC           TO MCD-COD-PLZO IN MCD.
           MOVE WSS-FEC-FFEC IN WSS-VARI      TO MCD-FEC-FMOV IN MCD.
      * RRM-INI 14-DIC-1998
           IF RCV-NUM-IVCT IN RCV > ZEROES
              MOVE RCV-NUM-IVCT IN RCV        TO MCD-NUM-IVCT IN MCD
           ELSE
      * RRM-FIN 14-DIC-1998
           MOVE OPC-NUM-IVEN IN OPC           TO MCD-NUM-IVCT IN MCD.
           MOVE RCV-NUM-IDLC IN RCV           TO MCD-NUM-IDLC IN MCD.
           MOVE OPC-VAL-SCRE IN OPC           TO MCD-SGV-SCRE IN MCD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-MCD.
           ADD 1 TO WSS-NUM-RGRA IN WSS-VARI.
       SIG-GRA-MOV.
           SET MOV-I UP BY 1.
           GO TO LUP-GRA-MOV.
       FIN-GRA-MOV.
           EXIT.
      *
      *ALD-BCI-INI/12051998
       AJU-SOL-CAPI SECTION.
       INI-AJU-SOL-CAPI.

           IF CAN-MSC-TCAN IN CAN = 'P' OR
              CAN-MSC-TCAN IN CAN = 'R'
               GO TO FIN-AJU-SOL-CAPI.

           IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
               COMPUTE WSS-VAL-DIFE IN WSS-VARI =
                                    WSS-SGV-PASO IN WSS-VARI -
                                    CAN-SGV-TPAG IN CAN
               MOVE WSS-VAL-DIFE IN WSS-VARI
                                 TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-DIFE
               IF WSS-VAL-DIFE IN WSS-VARI > -2 AND
                  WSS-VAL-DIFE IN WSS-VARI < 2
                   MOVE CAN-SGV-TPAG IN CAN TO WSS-SGV-PASO.
       FIN-AJU-SOL-CAPI.
           EXIT.
      *ALD-BCI-FIN/12051998
      *RJZ INI 3-MAY-1995 16:17:45
       COPY COLBFCYA.
       COPY COLBFERC.
      *COPY COLBFREV.
       COPY COLBFREV.
      *RJZ FIN 3-MAY-1995 16:17:45
       COPY COLBFCAN.
       COPY COLBFCOM.
       COPY COLBFOPC.
       COPY COLBFRCV.
       COPY COLBFVEN.
      *RJZ INI 3-MAY-1995 16:17:45
      * COPY COLBFICG.
      *RJZ INI 3-MAY-1995 16:17:45
       COPY COLBFDLC.
       COPY COLBFMCD.
       COPY COLBFTOC.
      *DPM INI  15-OCT-1996
       COPY COLBFEVC.
       COPY COLBFROV.
      *DPM FIN  15-OCT-1996
      * RBG/INI/19-JUL-1996
       COPY TABBFCAM.
      * RBG/FIN/19-JUL-1996
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
      *DAD  ini 24-ABR-1991
       COPY GNSBBTAB.
      *DAD  fin 24-ABR-1991
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGEND.
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
       COPY GNSBGABT.
       COPY GNSBGPES.

