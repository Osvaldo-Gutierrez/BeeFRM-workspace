       IDENTIFICATION DIVISION.
      *************************
       PROGRAM-ID.     COLPB850.
      *AUTHOR.         DONOSO JARA OSVALDO.
      *                DATE-WRITTEN,  29/09/92.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 30 DE MARZO DE 1998                                    *
      ******************************************************************
      ******************************************************************
      *  Sistema  : Colocaciones                                       *
      *  Subsist. :                                                    *
      *  Analista : Retamal Pablo.                                     *
      *  Objetivo : Emitir informe de analisis de spread por tipo de   *
      *             banca                                              *
      *  Archivos :                                                    *
      *   Entrada : TAB 150: Tabla de tablas miscelaneas TAB           *
      *             TAB 190: Tabla de tablas miscelaneas SGC           *
      *             OFI 150: Tabla oficinas                            *
      *             DBC 100: Datos basicos de clientes                 *
      *             DCP 100: Datos complementarios de personas         *
      *             DCE 100: Datos complementarios de empresas         *
      *             COLVIDC: Informacion de creditos p/calculo spread  *
      *             COLVPAR: Fechas por parametros                     *
      *             COLVEXC: Clases que se excluyen                    *
      *                                                                *
      *   SALIDA  : COLL850: "Informe de Spread por Banca"             *
      *             COLVGRA: Informacion para graficar via PC          *
      *                                                                *
      *   ENT/SAL :                                                    *
      *                                                                *
      *  Mantenciones                                                  *
      *  ============                                                  *
      *            Programador: Osvaldo Donoso J...........            *
      *            Fecha      : 07/10/94                               *
      *            Cambio     : Se emiten listados ajustados a la      *
      *                         nueva Organizacion area comercial      *
      *                                                                *
      ******************************************************************
      ******************************************************************
      *      MANTENCIONES.
      *      ==============
      *
      *      PROGRAMADOR : FORMAT 2000 INC.
      *      FECHA       : 20.02.1998
      *      CAMBIO      : SE APLICA TECNICA WINDOWING PARA CONVERSION
      *                      2000 COMPLIANT.
      ******************************************************************
           EJECT
       ENVIRONMENT DIVISION.
      **********************
       CONFIGURATION SECTION.
      *======================
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
           EJECT
       INPUT-OUTPUT SECTION.
      *=====================
       FILE-CONTROL.
           SELECT COLVIDC ASSIGN TO COLVIDC
                  ORGANIZATION         IS INDEXED
                  ACCESS MODE          IS SEQUENTIAL
                  RECORD KEY           IS IDC-KEY-IDC
                  FILE STATUS          IS WR-FS-COLVIDC WR-FS-COLVIDC2.
           SELECT COLVPAR  ASSIGN TO COLVPAR
                  FILE STATUS IS WR-FS-COLVPAR.
           SELECT COLVGRA  ASSIGN TO COLVGRA
                  FILE STATUS IS WR-FS-COLVGRA.
           SELECT COLVEXC  ASSIGN TO COLVEXC
                  FILE STATUS IS WR-FS-COLVEXC.
           SELECT COLL850A ASSIGN TO UT-S-COLL850A.
           SELECT COLL850B ASSIGN TO UT-S-COLL850B.
           SELECT COLL850C ASSIGN TO UT-S-COLL850C.
           SELECT COLL850D ASSIGN TO UT-S-COLL850D.
           SELECT COLVSOR ASSIGN TO SYS010-DA-3340-S-SYSWK1.
           EJECT
       DATA DIVISION.
      *==============
           SKIP3
       FILE SECTION.
      *=============
       FD  COLVIDC.
       COPY COLBRIDC.
           SKIP1
       FD  COLVPAR
           RECORD CONTAINS 80 CHARACTERS
           LABEL RECORD STANDARD.
       01  COLRPAR.
           05 FILLER                        PIC X(18).
           05 WP-LEE-BANCA                  PIC X(02).
           05 WP-FECHAS.
              10 WP-FECHA-INI.
                 15 WP-DIA                  PIC X(02).
                 15 FILLER                  PIC X(01).
                 15 WP-MES                  PIC X(02).
                 15 FILLER                  PIC X(01).
                 15 WP-ANO                  PIC X(04).
              10 FILLER                     PIC X(20).
              10 WP-FECHA-FIN.
                 15 WP-DIA                  PIC X(02).
                 15 FILLER                  PIC X(01).
                 15 WP-MES                  PIC X(02).
                 15 FILLER                  PIC X(01).
                 15 WP-ANO                  PIC X(04).
           05 FILLER                        PIC X(20).
       SKIP1
       FD  COLVEXC
           RECORD CONTAINS 80 CHARACTERS
           LABEL RECORD STANDARD.
       01  COLREXC.
           05 FILLER                        PIC X(20).
           05 EXC-TIO-AUX.
              10 EXC-COD-TIO                PIC X(03).
              10 EXC-COD-AUX                PIC X(03).
           05 FILLER                        PIC X(54).
       SKIP1
       FD  COLVGRA
           RECORD CONTAINS 200 CHARACTERS
           BLOCK  CONTAINS 0  RECORDS
           LABEL RECORD STANDARD.
       01  COLRGRA                          PIC  X(200).
       SKIP1
       SD  COLVSOR.
       01  COLRSOR.
           05 SOR-KEY-SOR.
              10 SOR-COD-REG                PIC X(03).
              10 SOR-COD-OFI                PIC X(03).
              10 SOR-COD-EJE                PIC X(12).
              10 SOR-COD-MON                PIC X(06).
              10 SOR-COD-BCA                PIC X(03).
           05 SOR-FEC-FINP                  PIC X(08).
           05 SOR-VAL-CPND                  PIC S9(14)V9(04) COMP-3.
           05 SOR-VAL-CRED                  PIC S9(11)V9(04) COMP-3.
       SKIP1
       FD  COLL850A
           LABEL RECORD IS OMITTED.
       01  COLR850A                         PIC X(132).
       SKIP1
       FD  COLL850B
           LABEL RECORD IS OMITTED.
       01  COLR850B                         PIC X(132).
       SKIP1
       FD  COLL850C
           LABEL RECORD IS OMITTED.
       01  COLR850C                         PIC X(132).
       SKIP1
       FD  COLL850D
           LABEL RECORD IS OMITTED.
       01  COLR850D                         PIC X(132).
       SKIP1
       WORKING-STORAGE SECTION.
      *========================
       01  W-INDICES.
           05 WI-I                          PIC 9(03) VALUE 0.
           05 WI-J                          PIC 9(03) VALUE 0.
           05 WI-K                          PIC 9(03) VALUE 0.
       01  W-SWITCHES.
           05 WS-PROCESO                    PIC 9(01) VALUE 0.
              88 WS-PROCESO-OK              VALUE 0.
              88 WS-PROCESO-ERROR           VALUE 1.
              88 WS-PROCESO-WARNING         VALUE 2.
           SKIP1
       01  W-TABLAS.
           05 WT-ACUMULA OCCURS 4 TIMES
              INDEXED BY WI-BCO WI-REG WI-OFI WI-EJE WI-AUX.
              10 WT-MONEDA OCCURS 20 TIMES INDEXED BY WI-MON.
                 15 WT-BANCA OCCURS 20 TIMES INDEXED BY WI-BCA.
                    20 WT-VAL-CPND-SEM      COMP-2.
                    20 WT-VAL-CRED-SEM      COMP-2.
                    20 WT-VAL-CPND-ACU      COMP-2.
                    20 WT-VAL-CRED-ACU      COMP-2.
           05 WT-MONEDAS OCCURS 20 TIMES INDEXED BY WI-GLS-MON.
              10 WT-COD-MON                 PIC  X(06).
              10 WT-GLS-MON                 PIC  X(30).
           05 WT-BANCAS  OCCURS 20 TIMES INDEXED BY WI-GLS-BCA.
              10 WT-COD-BCA                 PIC  X(03).
              10 WT-GLS-BCA                 PIC  X(30).
           05 WT-OFICINA OCCURS 200 TIMES INDEXED BY WI-GLS-OFI.
              10 WT-COD-OFI                 PIC  X(03).
              10 WT-COD-REG                 PIC  X(03).
              10 WT-GLS-OFI                 PIC  X(30).
           05 WT-TIO-AUX OCCURS 30 TIMES INDEXED BY WI-EXC.
              10 WT-COD-TIO                 PIC  X(03).
              10 WT-COD-AUX                 PIC  X(03).
      *---------------------------------------------------------------*
      * Codigo adicional para manejar sucursales con + de una regional*
      *---------------------------------------------------------------*
           05 WT-TPL-RE1 OCCURS 30 TIMES INDEXED BY WI-RE1.
              10 WT-TPL-REG                 PIC  X(03).
              10 WT-FILLER                  PIC  X(01).
              10 WT-TPL-GLS                 PIC  X(40).
           05 WT-TPL-RE2 OCCURS 30 TIMES INDEXED BY WI-RE2.
              10 WT-TPL-OF1 OCCURS 18 TIMES INDEXED BY WI-OF1.
                 15 WT-COD-OF1              PIC  X(03).
                 15 WT-FILLER               PIC  X(01).
           05 WT-OFI-EMX OCCURS 200 TIMES INDEXED BY WI-OFI-EMI.
              10 WT-OFI-EMI                 PIC  X(03).
           SKIP1
       01  W-CONTADORES-Y-ACUMULADORES.
           05 WA-L-IDC                      PIC 9(06) VALUE 0.
           05 WA-S-IDC                      PIC 9(06) VALUE 0.
           05 WA-L-SOR                      PIC 9(06) VALUE 0.
           05 WA-G-SOR                      PIC 9(06) VALUE 0.
           05 WA-PAG-BCO                    PIC 9(04) VALUE 0.
           05 WA-PAG-REG                    PIC 9(04) VALUE 0.
           05 WA-PAG-OFI                    PIC 9(04) VALUE 0.
           05 WA-PAG-EJE                    PIC 9(04) VALUE 0.
           05 WA-LINEA                      PIC 9(03).
           05 WA-LINEA-EJE                  PIC 9(03) VALUE 99.
           SKIP1
       01  W-REGISTROS-DE-TRABAJO.
           05 WR-FECHA-HOY.
              10 WR-HOY-AA                  PIC X(02).
              10 WR-HOY-MM                  PIC X(02).
              10 WR-HOY-DD                  PIC X(02).
           05 WR-MENSAJES.
              10 WR-SECCION                 PIC X(15).
              10 WR-PARRAFO                 PIC X(15).
              10 WR-ARCHIVO                 PIC X(10).
              10 WR-OPERACI                 PIC X(10).
              10 WR-FILE-ST                 PIC X(06).
              10 WR-FILE-RC                 PIC 9(03) VALUE 0.
              10 WR-FILE-FC                 PIC 9(03) VALUE 0.
              10 WR-FILE-KC                 PIC 9(03) VALUE 0.
              10 WR-MENSAJE                 PIC X(35).
           05 WR-FS-COLVPAR                 PIC 9(02).
           05 WR-FS-COLVEXC                 PIC 9(02).
           05 WR-FS-COLVSOR                 PIC 9(02) VALUE 0.
           05 WR-FS-COLVGRA                 PIC 9(02) VALUE 0.
           05 WR-FS-COLVIDC                 PIC 9(02) VALUE 0.
           05 WR-FS-COLVIDC2.
              10 WR-FS-COLVIDC2-RC          PIC 9(04) COMP-4 VALUE 0.
              10 WR-FS-COLVIDC2-FC          PIC 9(04) COMP-4 VALUE 0.
              10 WR-FS-COLVIDC2-KC          PIC 9(04) COMP-4 VALUE 0.
           05 WR-COD-CLV.
              10 WR-REG-ANT                 PIC X(03).
              10 WR-OFI-ANT                 PIC X(03).
              10 WR-EJE-ANT                 PIC X(12).
              10 WR-MON-ANT                 PIC X(06).
              10 WR-BCA-ANT                 PIC X(03).
           05 WR-FEC-AUX.
              10 WP-ANO                     PIC X(04).
              10 WP-MES                     PIC X(02).
              10 WP-DIA                     PIC X(02).
           05 WR-EXCLUYE                    PIC X(02).
           05 WR-TIPO-LINEA-TIT             PIC X(01).
           05 WR-TIPO-LINEA                 PIC X(01).
           05 WR-ENCONTRE                   PIC X(02).
           05 WR-COLRSOR                    PIC X(99).
           05 WR-FEC-INI-SEM                PIC X(08).
           05 WR-FEC-FIN-SEM                PIC X(08).
           05 WR-FEC-INI-ACU                PIC X(08).
           05 WR-FEC-FIN-ACU                PIC X(08).
           05 WR-TASA-SEM                   PIC S9(03)V9(04) VALUE +0.
           05 WR-TASA-ACU                   PIC S9(03)V9(04) VALUE +0.
           05 WR-PARAM-RUTUFECH.
              10 WR-RUTU-FECHA.
                 15 WR-RUTU-ANO             PIC X(04).
                 15 WR-RUTU-MES             PIC X(02).
                 15 WR-RUTU-DIA             PIC X(02).
              10 WR-RUTU-SN                 PIC X.
              10 WR-RUTU-HABANT             PIC 9(08) VALUE 0.
              10 WR-RUTU-HABPOS             PIC 9(08) VALUE 0.
              10 WR-RUTU-CODRET             PIC 9     VALUE 0.
           05 WR-LINEA00          PIC X(001) VALUE SPACES.
           05 WR-LINEA01.
              10 FILLER           PIC X(021) VALUE ALL ' '.
              10 FILLER           PIC X(018) VALUE 'INFORME DE SPREAD'.
              10 FILLER           PIC X(009) VALUE 'POR BANCA'.
              10 FILLER           PIC X(018) VALUE '          F.PROCES'.
              10 FILLER           PIC X(004) VALUE 'O : '.
              10 WR-LA01-DIA-PRO  PIC X(002).
              10 FILLER           PIC X(001) VALUE ALL '/'.
              10 WR-LA01-MES-PRO  PIC X(002).
      ********10 FILLER           PIC X(003) VALUE ALL '/19'.
              10 FILLER           PIC X(001) VALUE ALL '/'.
              10 WR-LA01-SIG-PRO  PIC X(002).
              10 WR-LA01-ANO-PRO  PIC X(002).
           05 WR-LINEA02.
              10 FILLER           PIC X(021) VALUE ALL ' '.
              10 FILLER           PIC X(027) VALUE ALL '-'.
              10 FILLER           PIC X(018) VALUE '             PAGIN'.
              10 FILLER           PIC X(004) VALUE 'A : '.
              10 WR-LA02-NUM-PAG  PIC ZZZ9.
           05 WR-LINEA03.
              10 FILLER           PIC X(022) VALUE ALL ' '.
              10 WR-LA03-GLS-LIS.
                 15 FILLER        PIC X(028).
                 15 WR-LA03-OFI   PIC X(004).
                 15 WR-LA03-GLS   PIC X(026).
           05 WR-LINEA04.
              10 FILLER           PIC X(010) VALUE ALL ' '.
              10 WR-LA04-TIT-COR  PIC X(013).
              10 FILLER           PIC X(003) VALUE ' : '.
              10 WR-LA04-COD-GLS.
                 15 WR-LA04-COD-COR  PIC X(003).
                 15 FILLER           PIC X(001) VALUE ' '.
                 15 WR-LA04-GLS-COR  PIC X(050).
           05 WR-LINEA05.
              10 FILLER           PIC X(010) VALUE ALL ' '.
              10 WR-LA05-TIT-COR  PIC X(013).
              10 FILLER           PIC X(003) VALUE ' : '.
              10 WR-LA05-GLS-COR.
                 15 WR-LA05-COD-COR  PIC X(003).
                 15 FILLER           PIC X(001) VALUE ' '.
                 15 WR-LA05-COR-GLS  PIC X(050).
           05 WR-LINEA07.
              10 FILLER           PIC X(016) VALUE '          SEMANA'.
              10 FILLER           PIC X(010) VALUE '        :'.
              10 WR-LA07-FEC-SEM1 PIC X(010).
              10 FILLER           PIC X(006) VALUE '  AL'.
              10 WR-LA07-FEC-SEM2 PIC X(010).
           05 WR-LINEA08.
              10 FILLER           PIC X(018) VALUE '          ACUMULAD'.
              10 FILLER           PIC X(008) VALUE 'O     :'.
              10 WR-LA08-FEC-ACU1 PIC X(010).
              10 FILLER           PIC X(006) VALUE '  AL'.
              10 WR-LA08-FEC-ACU2 PIC X(010).
           05 WR-LINEA09.
              10 FILLER           PIC X(018) VALUE '               BAN'.
              10 FILLER           PIC X(002) VALUE 'CA'.
              10 FILLER           PIC X(018) VALUE '                 S'.
              10 FILLER           PIC X(020) VALUE 'PREAD PROM.'.
              10 FILLER           PIC X(012) VALUE 'SPREAD PROM.'.
           05 WR-LINEA10.
              10 FILLER           PIC X(035) VALUE ALL ' '.
              10 FILLER           PIC X(018) VALUE 'SEMANAL (BASE 360)'.
              10 FILLER           PIC X(018) VALUE '   ACUMULADO (BASE'.
              10 FILLER           PIC X(005) VALUE ' 360)'.
           05 WR-LINEA11.
              10 FILLER           PIC X(010) VALUE ALL ' '.
              10 FILLER           PIC X(068) VALUE ALL '-'.
           05 WR-LINEA12.
              10 FILLER           PIC X(016) VALUE '          MONEDA'.
              10 FILLER           PIC X(006) VALUE '    :'.
              10 WR-LA12-GLS-MON  PIC X(030).
           05 WR-LINEA13.
              10 FILLER           PIC X(011) VALUE ALL ' '.
              10 WR-LA13-TIP-BCA  PIC X(004).
              10 WR-LA13-GLS-BCA  PIC X(020).
              10 FILLER           PIC X(003) VALUE ALL ' '.
              10 WR-LA13-SPR-SEM  PIC ---9,9999.
              10 FILLER           PIC X(010) VALUE ALL ' '.
              10 WR-LA13-SPR-ACU  PIC ---9,9999.
           05 WR-LINEA14.
              10 FILLER           PIC X(012) VALUE ALL ' '.
              10 WR-LA14-COD-OFI  PIC X(003).
              10 FILLER           PIC X(002) VALUE ALL ' '.
              10 WR-LA14-GLS-OFI  PIC X(030).
      *---------------------------------------------------------------*
      *  Lineas de archivo para graficar en excell (PC)               *
      *---------------------------------------------------------------*
           05 WR-LINEB01.
              10 WR-LB01-TIP      PIC X(003).
              10 FILLER           PIC X(018) VALUE '$$Informe de Sprea'.
              10 FILLER           PIC X(011) VALUE 'd por Banca'.
           05 WR-LINEB02.
              10 WR-LB02-TIP      PIC X(003).
              10 FILLER           PIC X(002) VALUE ALL '$'.
              10 WR-LB02-GLS-TIT  PIC X(036).
           05 WR-LINEB03.
              10 WR-LB03-TIP      PIC X(003).
              10 FILLER           PIC X(001) VALUE ALL '$'.
           05 WR-LINEB04.
              10 WR-LB04-TIP      PIC X(003).
              10 FILLER           PIC X(001) VALUE ALL '$'.
              10 WR-LB04-TIP-GLS  PIC X(012).
              10 FILLER           PIC X(002) VALUE ALL '$'.
              10 WR-LB04-COR-COD  PIC X(003).
              10 FILLER           PIC X(001) VALUE ALL '$'.
              10 WR-LB04-COR-GLS  PIC X(037).
           05 WR-LINEB05.
              10 WR-LB05-TIP      PIC X(003).
              10 FILLER           PIC X(001) VALUE ALL '$'.
              10 WR-LB05-TIP-PER  PIC X(012).
              10 FILLER           PIC X(002) VALUE ALL '$'.
              10 WR-LB05-FEC-DES  PIC X(010).
              10 FILLER           PIC X(006) VALUE '  al'.
              10 WR-LB05-FEC-HAS  PIC X(010).
           05 WR-LINEB06.
              10 WR-LB06-TIP      PIC X(003).
              10 FILLER           PIC X(014) VALUE '$Moneda    :$$'.
              10 WR-LB06-GLS-MON  PIC X(025).
           05 WR-LINEB07.
              10 WR-LB07-TIP      PIC X(003).
              10 FILLER           PIC X(018) VALUE '$$$$$Spread Prom.'.
              10 FILLER           PIC X(010) VALUE '(base 360)'.
           05 WR-LINEB08.
              10 WR-LB08-TIP      PIC X(003).
              10 FILLER           PIC X(007) VALUE '$$Banca'.
              10 FILLER           PIC X(016) VALUE ALL ' '.
              10 FILLER           PIC X(018) VALUE '$$$Semanal$Acumula'.
              10 FILLER           PIC X(002) VALUE 'do'.
           05 WR-LINEB09.
              10 WR-LB09-TIP      PIC X(003).
              10 FILLER           PIC X(002) VALUE ALL '$'.
              10 WR-LB09-GLS-BCA  PIC X(021).
              10 FILLER           PIC X(002) VALUE ALL '$'.
              10 WR-LB09-COD-BCA  PIC X(003).
              10 FILLER           PIC X(001) VALUE ALL '$'.
              10 WR-LB09-SPR-SEM  PIC ---9,9999.
              10 FILLER           PIC X(001) VALUE ALL '$'.
              10 WR-LB09-SPR-ACU  PIC ---9,9999.
           SKIP1
      ******************************************************************
      *     AREAS DE DATACOM                                           *
      ******************************************************************
      *
       01  WB-UIB.
           05 FILLER                        PIC X(32) VALUE 'COLPB850'.
      *
       01  WB-REQ-TAB-AREA.
           02 WB-REQ-TAB-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'TAB'.
           02 FILLER                        PIC X(5) VALUE 'TAB00'.
           02 WB-REQ-TAB-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 WB-REQ-TAB-BDID               PIC S9(4) COMP.
           02 FILLER                        PIC X(58).
           02 WB-REQ-TAB-KEY-VALUE.
              03 WB-REQ-TAB-KEY-TAB         PIC X(03).
              03 WB-REQ-TAB-KEY-COD         PIC X(15).
      *
       01  WB-REQ-OFI-AREA.
           02 WB-REQ-OFI-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'OFI'.
           02 FILLER                        PIC X(5) VALUE 'OFI00'.
           02 WB-REQ-OFI-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +150.
           02 FILLER                        PIC X(58).
           02 WB-REQ-OFI-KEY-VALUE.
              03 WB-REQ-OFI-KEY-OFI         PIC X(15).
      *
       01  WB-REQ-DBC-AREA.
           02 WB-REQ-DBC-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DBC'.
           02 FILLER                        PIC X(5) VALUE 'DBC02'.
           02 WB-REQ-DBC-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DBC-KEY-VALUE          PIC X(12).
      *
       01  WB-REQ-DCP-AREA.
           02 WB-REQ-DCP-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DCP'.
           02 FILLER                        PIC X(5) VALUE 'DCP00'.
           02 WB-REQ-DCP-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DCP-KEY-VALUE          PIC X(12).
      *
       01  WB-REQ-DCE-AREA.
           02 WB-REQ-DCE-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DCE'.
           02 FILLER                        PIC X(5) VALUE 'DCE00'.
           02 WB-REQ-DCE-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DCE-KEY-VALUE          PIC X(12).
      *
      *    Datos Basicos del Cliente
      *    -------------------------
      *
      *    Nombre Registro : DBC
      *    Clave(s)        : DBC-KEY-IDBC(UU), DBC-STP-ITRN(UU),DBC-IDC-
      *                      DBC-GLS-NOMC(DC), DBC-SNX-NOMC(DC)
      *    Largo           : 241
      *    Bloqueo         : 1
      *    Observaciones   :
      *
       01  DBC.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  DBC-GLS-FLAG                             PIC X(01).
      *
      *KEY Clave Primaria Registro
           03  DBC-KEY-IREG.
      *
      *        Identificacion Datos Basicos Clientes
               05  DBC-KEY-IDBC.
      *
      *            Cod. Int. Comp. Cliente
                   07  DBC-CIC-ICLI.
      *
      *                Centro Asignacion Identificacion
                       09  DBC-CAI-ICLI.
                           11  DBC-COD-TCLI             PIC X(01).
                           11  DBC-COD-CCLI             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  DBC-IIC-ICLI                 PIC X(08).
      *
      *        Time Stamp Transaccion
               05  DBC-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  DBC-FEC-FTRN.
                       09  DBC-NUM-STRN                 PIC 9(02).
                       09  DBC-NUM-ATRN                 PIC 9(02).
                       09  DBC-NUM-MTRN                 PIC 9(02).
                       09  DBC-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  DBC-HRA-HRTR.
                       09  DBC-NUM-HHTR                 PIC 9(02).
                       09  DBC-NUM-MMTR                 PIC 9(02).
                       09  DBC-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  DBC-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  DBC-MSC-STAT                             PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  DBC-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  DBC-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  DBC-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  DBC-COD-ATRN                             PIC X(12).
      *
      *KEY Rut Cliente + Indicador o Calificador + Extension
           03  DBC-IDC-ICLI.
      *
      *        RUT Cliente
               05  DBC-NUM-ICLI                         PIC X(08).
      *
      *        Indicador Tipo RUT
               05  DBC-IND-ICLI                         PIC X(01).
      *
      *        Extension del RUT
               05  DBC-GLS-ICLI                         PIC X(03).
      *
      *KEY Digito Verificador del Rut
           03  DBC-VRF-ICLI                             PIC X(01).
      *
      *KEY Nombre Cliente Generico (Persona o Empresa)
           03  DBC-GLS-NOMC.
               05  DBC-GLS-APAT                         PIC X(25).
               05  DBC-GLS-AMAT                         PIC X(25).
               05  DBC-GLS-NOMB                         PIC X(25).
      *
      *    Soundex del Nombre de Cliente
           03  DBC-SNX-NOMC.
               05  DBC-SNX-APAT                         PIC X(03).
               05  DBC-SNX-AMAT                         PIC X(03).
               05  DBC-SNX-NOMB                         PIC X(03).
      *
      *    Numero de Direccion de Envio Correspondencia
           03  DBC-NUM-DCOR                             PIC 9(02).
      *
      *OPR Ind Tipo Cliente ( Persona o Empresa )       SGC TICL
           03  DBC-IND-TICL                             PIC X(01).
      *
      *    Tipo Cliente (Potencial,No Cliente,Grupo)    SGC TCL
           03  DBC-COD-TICL                             PIC X(02).
      *
      *    Codigo Clasificacion Comercial               SGC CLC
           03  DBC-COD-CLCM                             PIC X(02).
      *
      *RCM Codigo del Ejecutivo Encargado del Cliente   TAB USR
           03  DBC-COD-EJEC                             PIC X(12).
      *
      *OPR Codigo de Oficina donde opera el Cliente     TAB OFI
           03  DBC-COD-OFIC                             PIC X(03).
      *
      *RCM Indicador si opera en otra Oficina           SGC OOFI
           03  DBC-IND-OOFI                             PIC X(01).
      *
      *EXT Codigo Actividad Economica                   TAB ACT
           03  DBC-COD-ACTI                             PIC X(09).
      *
      *EXT Origen y Destino Sect (Comp.Inst)            TAB ODS
           03  DBC-COD-ODSE                             PIC X(03).
      *
      *INF Fecha Ultima Declaracion Articulo 85
           03  DBC-FEC-FA85.
               05  DBC-NUM-SA85                         PIC 9(02).
               05  DBC-NUM-AA85                         PIC 9(02).
               05  DBC-NUM-MA85                         PIC 9(02).
               05  DBC-NUM-DA85                         PIC 9(02).
      *
      *    Tipo Ultimo Pago Impuesto a la Renta         SGC UPIR
           03  DBC-IND-UPIR                             PIC X(03).
      *
      *    Fecha Ultimo Pago Impuesto a la Renta
           03  DBC-FEC-FUPI.
               05  DBC-NUM-SUPI                         PIC 9(02).
               05  DBC-NUM-AUPI                         PIC 9(02).
               05  DBC-NUM-MUPI                         PIC 9(02).
               05  DBC-NUM-DUPI                         PIC 9(02).
      *
      *INF Indicador de Multas Banco Central            SGC MUBC
           03  DBC-IND-MUBC                             PIC X(01).
      *
      *INF Indicador de Juicios Banco Central           SGC JUBC
           03  DBC-IND-JUBC                             PIC X(01).
      *
      *EXT Codigo Estado Cliente ( como Deudor )        SGC SCLI
           03  DBC-MSC-SCLI                             PIC X(01).
      *
      *    Fecha Estado Cliente
           03  DBC-FEC-FSCL.
               05  DBC-NUM-SSCL                         PIC 9(02).
               05  DBC-NUM-ASCL                         PIC 9(02).
               05  DBC-NUM-MSCL                         PIC 9(02).
               05  DBC-NUM-DSCL                         PIC 9(02).
      *
      *    Codigo de Bloqueo del Cliente                SGC BLO
           03  DBC-COD-BLOC                             PIC X(02).
      *
      *    Numero Total de Direcciones
           03  DBC-NUM-TDIR                             PIC 9(02).
      *
      *    Numero Total de Comentarios
           03  DBC-NUM-TCMT                             PIC 9(03).
      *
      *    Fecha Inicio Operacion
           03  DBC-FEC-FIOP.
               05  DBC-NUM-SIOP                         PIC 9(02).
               05  DBC-NUM-AIOP                         PIC 9(02).
               05  DBC-NUM-MIOP                         PIC 9(02).
               05  DBC-NUM-DIOP                         PIC 9(02).
      *
      *    Fecha Termino Operacion
           03  DBC-FEC-FTOP.
               05  DBC-NUM-STOP                         PIC 9(02).
               05  DBC-NUM-ATOP                         PIC 9(02).
               05  DBC-NUM-MTOP                         PIC 9(02).
               05  DBC-NUM-DTOP                         PIC 9(02).
      *
      *    Numero Operaciones Fecha Termino Nula
           03  DBC-NUM-OFTN                             PIC 9(03).
      *
      *    Fecha Ingreso de Datos a la Base de Datos
           03  DBC-FEC-FINP.
               05  DBC-NUM-SINP                         PIC 9(02).
               05  DBC-NUM-AINP                         PIC 9(02).
               05  DBC-NUM-MINP                         PIC 9(02).
               05  DBC-NUM-DINP                         PIC 9(02).
      *
      *    Disponible
      *    03  DBC-GLS-DISP                             PIC X(00).
      *    Datos Complementarios Personas
      *    ------------------------------
      *
      *    Nombre Registro : DCP
      *    Clave(s)        : DCP-KEY-IDCP(UU)
      *    Largo           : 117
      *    Bloqueo         : 1
      *    Observaciones   :
      *
      *    01) Modificacion 13/05/92, DAD
      *        - Ingreso campos DCP-COD-TBAN y DCP-IND-RCNY por req BCI.
      *        - Modifico largo campos DCP-GLS-GABI y DCP-GLS-DISP.
      *    02) Modificacion 18/02/94, DAD
      *        - Ingreso campo DCP-COD-TPLN por req BCI.
      *        - Modifico largo campo DCP-GLS-DISP.
      *
       01  DCP.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  DCP-GLS-FLAG                             PIC X(01).
      *
      *KEY Clave Primaria Registro
           03  DCP-KEY-IREG.
      *
      *        Id Datos Complementarios Personas
               05  DCP-KEY-IDCP.
      *
      *            Cod. Int. Comp. Cliente
                   07  DCP-CIC-ICLI.
      *
      *                Centro Asignacion Identificacion
                       09  DCP-CAI-ICLI.
                           11  DCP-COD-TCLI             PIC X(01).
                           11  DCP-COD-CCLI             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  DCP-IIC-ICLI                 PIC X(08).
      *
      *        Time Stamp Transaccion
               05  DCP-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  DCP-FEC-FTRN.
                       09  DCP-NUM-STRN                 PIC 9(02).
                       09  DCP-NUM-ATRN                 PIC 9(02).
                       09  DCP-NUM-MTRN                 PIC 9(02).
                       09  DCP-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  DCP-HRA-HRTR.
                       09  DCP-NUM-HHTR                 PIC 9(02).
                       09  DCP-NUM-MMTR                 PIC 9(02).
                       09  DCP-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  DCP-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  DCP-MSC-STAT                             PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  DCP-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  DCP-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  DCP-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  DCP-COD-ATRN                             PIC X(12).
      *
      *    Fecha de Nacimiento
           03  DCP-FEC-FNAC.
               05  DCP-NUM-SNAC                         PIC 9(02).
               05  DCP-NUM-ANAC                         PIC 9(02).
               05  DCP-NUM-MNAC                         PIC 9(02).
               05  DCP-NUM-DNAC                         PIC 9(02).
      *
      *    Codigo del Pais de la Nacionalidad           TAB PAI
           03  DCP-COD-PNAC                             PIC X(03).
      *
      *    Indicador de Sexo                            TAB SEXO
           03  DCP-IND-SEXO                             PIC X(01).
      *
      *    Indicador de Estado Civil                    TAB ECIV
           03  DCP-IND-ECIV                             PIC X(03).
      *
      *    Cedula de Identidad
           03  DCP-NUM-CIDE                             PIC X(08).
      *
      *    Digito Verificador Cedula Identidad
           03  DCP-VRF-CIDE                             PIC X(01).
      *
      *MOD-01 X(15).
      *    Gabinete Cedula de Identidad
           03  DCP-GLS-GABI                             PIC X(12).
      *
      *ING-01
      *    Codigo Tipo Banca                            SGC BAN
           03  DCP-COD-TBAN                             PIC X(03).
      *
      *    Indicador Nivel Educacional                  SGC NEDU
           03  DCP-IND-NEDU                             PIC X(03).
      *
      *    Codigo de Actividad Secundaria               TAB ACT
           03  DCP-COD-ACTS                             PIC X(09).
      *
      *    Codigo de Profesion                          SGC PRF
           03  DCP-COD-PROF                             PIC X(05).
      *
      *    Indicador de Situacion Laboral               SGC SLAB
           03  DCP-IND-SLAB                             PIC X(03).
      *
      *    Codigo Categoria Socioeconomica              SGC CSE
           03  DCP-COD-CSEC                             PIC X(02).
      *
      *    Indicador Situacion Casa                     SGC CASA
           03  DCP-IND-CASA                             PIC X(05).
      *
      *    # Msj Asoc a Nombre de Pila (SBT)
           03  DCP-NUM-NMSG                             PIC 9(04).
      *
      *ING-01
      *    Indicador Regimen Conyugal                   SGC RCNY
           03  DCP-IND-RCNY                             PIC X(01).
      *
      *ING-02
      *    Codigo Tipo Plan                             SGC PLN
           03  DCP-COD-TPLN                             PIC X(01).
      *
      *MOD-02 X(01).
      *MOD-01 X(02).
      *    Disponible
      *     03  DCP-GLS-DISP                             PIC X(00).
      *
       01  DCP-VARI.
           03  DCP-IND-SLDE             VALUE 'DEP'     PIC X(03).
           03  DCP-IND-CASA             VALUE 'CAS'     PIC X(03).
           03  DCP-IND-SEPA             VALUE 'SEP'     PIC X(03).
           03  DCP-IND-SOLT             VALUE 'SOL'     PIC X(03).
           03  DCP-IND-VIUD             VALUE 'VIU'     PIC X(03).
      *    Datos Complementarios Empresas
      *    ------------------------------
      *
      *    Nombre Registro : DCE
      *    Clave(s)        : DCE-KEY-IDCE(UU)
      *    Largo           : 158
      *    Bloqueo         : 1
      *    Observaciones   :
      *
      *    01) Modificacion 13/05/92, DAD
      *        - Ingreso campo DCE-COD-TBAN por req BCI.
      *        - Modifico largo campo DCE-GLS-DISP.
      *    02) Modificacion 18/02/94, DAD
      *        - Ingreso campo DCE-COD-TPLN por req BCI.
      *        - Modifico largo campo DCE-GLS-DISP.
      *
       01  DCE.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  DCE-GLS-FLAG                             PIC X(01).
      *
      *KEY Clave Primaria Registro
           03  DCE-KEY-IREG.
      *
      *        Identificacion Datos Complementarios Empresas
               05  DCE-KEY-IDCE.
      *
      *            Cod. Int. Comp. Cliente
                   07  DCE-CIC-ICLI.
      *
      *                Centro Asignacion Identificacion
                       09  DCE-CAI-ICLI.
                           11  DCE-COD-TCLI             PIC X(01).
                           11  DCE-COD-CCLI             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  DCE-IIC-ICLI                 PIC X(08).
      *
      *        Time Stamp Transaccion
               05  DCE-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  DCE-FEC-FTRN.
                       09  DCE-NUM-STRN                 PIC 9(02).
                       09  DCE-NUM-ATRN                 PIC 9(02).
                       09  DCE-NUM-MTRN                 PIC 9(02).
                       09  DCE-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  DCE-HRA-HRTR.
                       09  DCE-NUM-HHTR                 PIC 9(02).
                       09  DCE-NUM-MMTR                 PIC 9(02).
                       09  DCE-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  DCE-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  DCE-MSC-STAT                             PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  DCE-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  DCE-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  DCE-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  DCE-COD-ATRN                             PIC X(12).
      *
      *    Nombre Fantasia
           03  DCE-GLS-NFAN                             PIC X(40).
      *
      *EXT Codigo Tipo de Sociedad                      SGC SOC
           03  DCE-COD-TSOC                             PIC X(02).
      *
      *    Fecha Constitucion Empresa
           03  DCE-FEC-FCTT.
               05  DCE-NUM-SCTT                         PIC 9(02).
               05  DCE-NUM-ACTT                         PIC 9(02).
               05  DCE-NUM-MCTT                         PIC 9(02).
               05  DCE-NUM-DCTT                         PIC 9(02).
      *
      *    Fecha Ultima Modificacion Escritura
           03  DCE-FEC-FUME.
               05  DCE-NUM-SUME                         PIC 9(02).
               05  DCE-NUM-AUME                         PIC 9(02).
               05  DCE-NUM-MUME                         PIC 9(02).
               05  DCE-NUM-DUME                         PIC 9(02).
      *
      *    Fecha Caducidad Empresa
           03  DCE-FEC-FCAD.
               05  DCE-NUM-SCAD                         PIC 9(02).
               05  DCE-NUM-ACAD                         PIC 9(02).
               05  DCE-NUM-MCAD                         PIC 9(02).
               05  DCE-NUM-DCAD                         PIC 9(02).
      *
      *    Indicador Renovacion Automatica ( S/N )      SGC RAUT
           03  DCE-IND-RAUT                             PIC X(01).
      *
      *OPR Indicador Casa Matriz o Sucursal             SGC CMOS
           03  DCE-IND-CMOS                             PIC X(01).
      *
      *EXT Indicador Categoria ( como Deudor )          SGC CATE
           03  DCE-IND-CATE                             PIC X(03).
      *
      *EXT Tipo de Empresa  ( como Deudor )             SGC TEMP
           03  DCE-IND-TEMP                             PIC X(03).
      *
      *ING-01
      *    Codigo Tipo Banca                            SGC BAN
           03  DCE-COD-TBAN                             PIC X(03).
      *
      *ING-02
      *    Codigo Tipo Plan                             SGC PLN
           03  DCE-COD-TPLN                             PIC X(01).
      *
      *MOD-02 X(36).
      *MOD-01 X(39).
      *    Disponible
           03  DCE-GLS-DISP                             PIC X(35).
      *    Registro Generico de Tablas
      *    ---------------------------
      *
      *    Nombre Registro : TAB
      *    Clave(s)        : TAB-COD-TABL(UU), TAB-STP-ITRN(UU),
      *                      TAB-CIC-TABL(UU), TAB-EXT-TABL(DC)
      *    Largo           : 194
      *    Bloqueo         : 2
      *    Observaciones   :
      *
       01  TAB.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  TAB-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  TAB-KEY-IREG.
      *
      *KEY     Tipo + Codigo ( LLave Primaria )
               05  TAB-COD-TABL.
      *
      *            Codigo Tipo Tabla
                   07  TAB-COD-TTAB                     PIC X(03).
      *
      *            Codigo Tabla
                   07  TAB-COD-CTAB                     PIC X(12).
      *
      *        Time Stamp Transaccion
               05  TAB-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  TAB-FEC-FTRN.
                       09  TAB-NUM-STRN                 PIC 9(02).
                       09  TAB-NUM-ATRN                 PIC 9(02).
                       09  TAB-NUM-MTRN                 PIC 9(02).
                       09  TAB-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  TAB-HRA-HRTR.
                       09  TAB-NUM-HHTR                 PIC 9(02).
                       09  TAB-NUM-MMTR                 PIC 9(02).
                       09  TAB-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  TAB-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  TAB-MSC-STAT                             PIC X(01).
      *
      *    Indicador Vigencia                           GNS VIGE
           03  TAB-IND-VIGE  REDEFINES  TAB-MSC-STAT    PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  TAB-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  TAB-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  TAB-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  TAB-COD-ATRN                             PIC X(12).
      *
      *KEY Tipo + Codigo ( Interno Computacional )
           03  TAB-CIC-TABL.
      *
      *        Codigo Tipo Tabla
               05  TAB-CIC-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  TAB-CIC-CTAB                         PIC X(12).
      *
      *    Codigo Externo
           03  TAB-EXT-TABL.
      *
      *        Codigo Tipo Tabla
               05  TAB-EXT-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  TAB-EXT-CTAB                         PIC X(05).
      *
      *    Descripcion Corta
           03  TAB-GLS-DCOR                             PIC X(12).
      *
      *    Abreviacion Descripcion
           03  TAB-GLS-ABRV                             PIC X(05).
      *
      *    Descripcion del Codigo
           03  TAB-GLS-DESC                             PIC X(40).
      *
      *    Datos Anexos
           03  TAB-GLS-DATA.
               05  TAB-GLS-DAT1.
                   07  TAB-COD-DAT1     OCCURS 10       PIC X(01).
               05  TAB-GLS-DAT2.
                   07  TAB-COD-DAT2     OCCURS 10       PIC X(02).
               05  TAB-GLS-DAT3.
                   07  TAB-COD-DAT3     OCCURS 10       PIC X(03).
      *
      *    Clave Soundex
           03  TAB-SNX-TABL.
               05  TAB-SNX-TTAB                         PIC X(03).
               05  TAB-SNX-CTAB                         PIC X(03).
      *
      *    Variables de Tablas
       01  TAB-VARI.
      *
      *    Codigo Sistema
           03  TAB-COD-SIST                             PIC X(03).
      *    Registro de Oficinas
      *    --------------------
      *
      *    Nombre Registro : OFI
      *    Clave(s)        : OFI-COD-OFIC(UU), OFI-CIC-OFIC(UU),
      *                      OFI-EXT-TABL(DC)
      *    Largo           : 297
      *    Bloqueo         : 3
      *    Observaciones   :
      *
      *    01) Modificacion  04/10/94,  DAD
      *        - Se Elimina campo  OFI-GLS-TLEX.
      *        - Se Incorporan campos OFI-NUM-NFAX, OFI-COD-MODE,
      *                               OFI-COD-ZONA, OFI-COD-JPOP,
      *                               OFI-COD-JEOP, OFI-COD-REGP,
      *                               OFI-COD-REGE.
      *        - Se Modifica Tamao del Disponible.
      *
       01  OFI.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  OFI-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  OFI-KEY-IREG.
      *
      *KEY     Codigo Oficina ( LLave Primaria )
               05  OFI-COD-OFIC                         PIC X(03).
      *
      *        Time Stamp Transaccion
               05  OFI-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  OFI-FEC-FTRN.
                       09  OFI-NUM-STRN                 PIC 9(02).
                       09  OFI-NUM-ATRN                 PIC 9(02).
                       09  OFI-NUM-MTRN                 PIC 9(02).
                       09  OFI-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  OFI-HRA-HRTR.
                       09  OFI-NUM-HHTR                 PIC 9(02).
                       09  OFI-NUM-MMTR                 PIC 9(02).
                       09  OFI-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  OFI-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  OFI-MSC-STAT                             PIC X(01).
      *
      *    Indicador Vigencia                           GNS VIGE
           03  OFI-IND-VIGE  REDEFINES  OFI-MSC-STAT    PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  OFI-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  OFI-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  OFI-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  OFI-COD-ATRN                             PIC X(12).
      *
      *KEY Codigo Oficina ( Interno Computacional )
           03  OFI-CIC-OFIC                             PIC X(03).
      *
      *    Codigo Oficina Externo
           03  OFI-EXT-TABL.
      *
      *        Codigo Tipo Tabla
               05  OFI-EXT-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  OFI-EXT-CTAB                         PIC X(05).
      *
      *    Abreviacion Oficina
           03  OFI-GLS-ABRV                             PIC X(05).
      *
      *    Descripcion Oficina
           03  OFI-GLS-DESC                             PIC X(38).
      *
      *    Direccion Oficina
           03  OFI-GLS-DIRE                             PIC X(38).
      *
      *    Codigo Comuna Oficina                        TAB COM
           03  OFI-COD-COMU                             PIC X(04).
      *
      *ELI-01
      *    Telex Oficina
      *     03  OFI-GLS-TLEX                             PIC X(38).
      *
      *ING-01
      *    Numero Fax Oficina
           03  OFI-NUM-NFAX                             PIC X(09).
      *
      *ING-01
      *    Codigo Modelo                                TAB MDL
           03  OFI-COD-MODL                             PIC X(01).
      *
      *ING-01
      *    Codigo Zonal                                 TAB ZNL
           03  OFI-COD-ZONL                             PIC X(01).
      *
      *ING-01
      *    Codigo USR jefe banca personas               TAB USR
           03  OFI-COD-JPOP                             PIC X(12).
      *
      *ING-01
      *    Codigo USR jefe banca empresas               TAB USR
           03  OFI-COD-JEOP                             PIC X(12).
      *
      *ING-01
      *    Codigo regional en banca personas            TAB RGN
           03  OFI-COD-REGP                             PIC X(03).
      *
      *    Codigo Plaza Oficina                         TAB PZA
           03  OFI-COD-PLZA                             PIC X(04).
      *
      *    Fonos Oficina
           03  OFI-GLS-FONO.
      *
      *        Fono 1 Oficina
               05  OFI-GLS-FON1                         PIC X(10).
      *
      *        Fono 2 Oficina
               05  OFI-GLS-FON2                         PIC X(10).
      *
      *    Anexos Oficina
           03  OFI-GLS-ANXO.
      *
      *        Anexo 1 Oficina
               05  OFI-GLS-ANX1                         PIC X(04).
      *
      *        Anexo 2 Oficina
               05  OFI-GLS-ANX2                         PIC X(04).
      *
      *    Oficina Regional                             TAB OFI
           03  OFI-COD-OREG                             PIC X(03).
      *
      *    Oficina Centralizacion Operativa             TAB OFI
           03  OFI-COD-OFCO                             PIC X(03).
      *
      *    Clasificacion Operativa Oficina              TAB COPE
           03  OFI-IND-COPE                             PIC X(01).
      *
      *    Clasificacion Comercial Oficina              TAB CCOM
           03  OFI-IND-CCOM                             PIC X(01).
      *
      *    Cuenta Contable Oficina
           03  OFI-NUM-CCON                             PIC X(12).
      *
      *    Digito Verificador Cuenta Contable
           03  OFI-VRF-CCON                             PIC X(01).
      *
      *    Cuenta Corriente Oficina
           03  OFI-NUM-CCTE                             PIC X(12).
      *
      *    Digito Verificador Cuenta Corriente
           03  OFI-VRF-CCTE                             PIC X(01).
      *
      *    Codigo Jefe Oficina                          TAB USR
           03  OFI-COD-JFOF                             PIC X(12).
      *
      *    Fecha desde Jefe Oficina (SSAAMMDD)
           03  OFI-FEC-FJFO.
               05  OFI-NUM-SJFO                         PIC 9(02).
               05  OFI-NUM-AJFO                         PIC 9(02).
               05  OFI-NUM-MJFO                         PIC 9(02).
               05  OFI-NUM-DJFO                         PIC 9(02).
      *
      *    Codigo Jefe Operaciones Oficina              TAB USR
           03  OFI-COD-JOOF                             PIC X(12).
      *
      *    Fecha desde Jefe Operaciones Oficina (SSAAMMDD)
           03  OFI-FEC-FJOO.
               05  OFI-NUM-SJOO                         PIC 9(02).
               05  OFI-NUM-AJOO                         PIC 9(02).
               05  OFI-NUM-MJOO                         PIC 9(02).
               05  OFI-NUM-DJOO                         PIC 9(02).
      *
      *    Fecha Apertura Oficina (SSAAMMDD)
           03  OFI-FEC-FAPE.
               05  OFI-NUM-SAPE                         PIC 9(02).
               05  OFI-NUM-AAPE                         PIC 9(02).
               05  OFI-NUM-MAPE                         PIC 9(02).
               05  OFI-NUM-DAPE                         PIC 9(02).
      *
      *    Fecha Cierre Oficina (SSAAMMDD)
           03  OFI-FEC-FCIE.
               05  OFI-NUM-SCIE                         PIC 9(02).
               05  OFI-NUM-ACIE                         PIC 9(02).
               05  OFI-NUM-MCIE                         PIC 9(02).
               05  OFI-NUM-DCIE                         PIC 9(02).
      *ING-01
      *    Codigo regional en banca empresas            TAB RGN
           03  OFI-COD-REGE                             PIC X(03).
      *
      *MOD-01 X(05).
      *    Disponible
           03  OFI-GLS-DISP                             PIC X(02).
      *
       01  WB-ELEM-LIS                      PIC X(11).
      *
           COPY RLOVR001.
           EJECT
       PROCEDURE DIVISION.
      *===================
           ENTRY 'DBMSCBL'.
           EJECT
       A-CONTROL SECTION.
      *=================
       AA-INICIALIZACION.
           PERFORM B-INICIALIZAR.
           SKIP1
       AB-PROCESAMIENTO.
           IF (NOT WS-PROCESO-ERROR)
               PERFORM C-PROCESAR
           END-IF.
           SKIP1
       AC-TERMINACION.
           PERFORM D-TERMINAR.
           SKIP1
       AZ-FIN-DE-SECCION.
           GOBACK.
           EJECT
       B-INICIALIZAR SECTION.
      *======================
       BA-PROCESO-INICIAL.
      *-------------------
           PERFORM BB-ABRIR-ARCHIVOS
           PERFORM BC-VALIDA-PARAMETROS.
           PERFORM BE-INICIALIZA-CAMPOS.
           PERFORM BE-CARGA-TIOAUX.
           PERFORM BE-CARGA-REGIONAL-TEMPORAL
           GO BZ-FIN-DE-SECCION.
           SKIP1
       BB-ABRIR-ARCHIVOS.
      *------------------
           OPEN INPUT COLVPAR COLVIDC COLVEXC
               OUTPUT COLL850A COLL850B COLL850C COLL850D COLVGRA
           IF (WR-FS-COLVPAR NOT = 00 AND NOT = 97)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'COLVPAR'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-MENSAJE
               MOVE WR-FS-COLVPAR           TO WR-FILE-ST
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-COLVEXC NOT = 00 AND NOT = 97)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'COLVEXC'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-MENSAJE
               MOVE WR-FS-COLVEXC           TO WR-FILE-ST
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-COLVGRA NOT = 00 AND NOT = 97)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BB-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'COLVGRA'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-MENSAJE
               MOVE WR-FS-COLVGRA           TO WR-FILE-ST
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           IF (WR-FS-COLVIDC NOT = 0)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BA-ABRIR-ARCHIVOS'     TO WR-PARRAFO
               MOVE 'COLVIDC'               TO WR-ARCHIVO
               MOVE 'OPEN'                  TO WR-OPERACI
               MOVE WR-FS-COLVIDC           TO WR-FILE-ST
               MOVE WR-FS-COLVIDC2-RC       TO WR-FILE-RC
               MOVE WR-FS-COLVIDC2-FC       TO WR-FILE-FC
               MOVE WR-FS-COLVIDC2-KC       TO WR-FILE-KC
               MOVE '**ERROR EN OPEN**'     TO WR-MENSAJE
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       BC-VALIDA-PARAMETROS.
      *---------------------
           ACCEPT WR-FECHA-HOY FROM DATE.
           MOVE WR-HOY-DD                   TO WR-LA01-DIA-PRO
           MOVE WR-HOY-MM                   TO WR-LA01-MES-PRO
           MOVE WR-HOY-AA                   TO WR-LA01-ANO-PRO.
           IF WR-LA01-ANO-PRO < ROLL-YY
              MOVE 20 TO WR-LA01-SIG-PRO
           ELSE
              MOVE 19 TO WR-LA01-SIG-PRO
           END-IF.

           PERFORM BF-LEER-COLVPAR.
           IF (WR-FS-COLVPAR = 0)
               DISPLAY COLRPAR
               MOVE WP-FECHA-INI            TO WR-LA07-FEC-SEM1
               MOVE WP-FECHA-FIN            TO WR-LA07-FEC-SEM2
               MOVE CORR WP-FECHA-INI       TO WR-FEC-AUX
               MOVE WR-FEC-AUX              TO WR-FEC-INI-SEM
               PERFORM BD-VALIDA-FECHAS
               MOVE CORR WP-FECHA-FIN       TO WR-FEC-AUX
               PERFORM BD-VALIDA-FECHAS
               MOVE WR-FEC-AUX              TO WR-FEC-FIN-SEM
               IF (WR-FEC-INI-SEM > WR-FEC-FIN-SEM)
                   MOVE 'B-INICIALIZAR'     TO WR-SECCION
                   MOVE 'BD-VALIDA-FECHAS'  TO WR-PARRAFO
                   MOVE 'SYSIN      '       TO WR-ARCHIVO
                   MOVE '*RANGO SEMANAL INV*' TO WR-MENSAJE
                   PERFORM BG-DISPLAY-ERROR
               END-IF
           END-IF.

           IF (WR-FS-COLVPAR = 0)
               PERFORM BF-LEER-COLVPAR
           END-IF.
           IF (WR-FS-COLVPAR = 0)
               DISPLAY COLRPAR
               MOVE WP-FECHA-INI            TO WR-LA08-FEC-ACU1
               MOVE WP-FECHA-FIN            TO WR-LA08-FEC-ACU2
               MOVE CORR WP-FECHA-INI       TO WR-FEC-AUX
               MOVE WR-FEC-AUX              TO WR-FEC-INI-ACU
               PERFORM BD-VALIDA-FECHAS
               MOVE CORR WP-FECHA-FIN       TO WR-FEC-AUX
               PERFORM BD-VALIDA-FECHAS
               MOVE WR-FEC-AUX              TO WR-FEC-FIN-ACU
               IF (WR-FEC-INI-ACU > WR-FEC-FIN-ACU)
                   MOVE 'B-INICIALIZAR'     TO WR-SECCION
                   MOVE 'BD-VALIDA-FECHAS'  TO WR-PARRAFO
                   MOVE 'SYSIN      '       TO WR-ARCHIVO
                   MOVE '*RANGO ACUMUL. INV*' TO WR-MENSAJE
                   PERFORM BG-DISPLAY-ERROR
               END-IF
           END-IF.

           IF (WR-FS-COLVPAR = 0)
               PERFORM BF-LEER-COLVPAR
               IF (WR-FS-COLVPAR = 0 AND WP-LEE-BANCA = 'NO')
                   DISPLAY '***********************************'
                   DISPLAY '*** ESTE PROCESO NO LEERA BANCA ***'
                   DISPLAY '***      DEL SISTEMA SGC        ***'
                   DISPLAY '***********************************'
               END-IF
           END-IF.
           SKIP1
       BD-VALIDA-FECHAS.
      *-----------------
           MOVE WR-FEC-AUX                  TO WR-RUTU-FECHA
           MOVE ZEROS                       TO WR-RUTU-HABANT
                                               WR-RUTU-HABPOS
                                               WR-RUTU-CODRET
           MOVE ' '                         TO WR-RUTU-SN
           CALL 'RUTUFECH' USING  WR-RUTU-FECHA  WR-RUTU-SN
                                  WR-RUTU-HABANT WR-RUTU-HABPOS
                                  WR-RUTU-CODRET
           IF (WR-RUTU-CODRET NOT = 0)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BD-VALIDA-FECHAS'      TO WR-PARRAFO
               MOVE 'SYSIN      '           TO WR-ARCHIVO
               MOVE WR-RUTU-FECHA           TO WR-OPERACI
               MOVE '*FECHA INVALIDA*'      TO WR-MENSAJE
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       BE-INICIALIZA-CAMPOS.
      *---------------------
           INITIALIZE W-TABLAS.
           SET WI-BCO                       TO 1
           SET WI-REG                       TO 2
           SET WI-OFI                       TO 3
           SET WI-EJE                       TO 4.
           MOVE 'SIN DESCRIPCION'           TO WT-GLS-BCA(1).
           SKIP1
       BE-CARGA-TIOAUX.
      *----------------
           PERFORM BF-LEER-COLVEXC.
           SET WI-EXC                       TO 1
           PERFORM UNTIL (WR-FS-COLVEXC NOT = 0 OR WS-PROCESO-ERROR)
              MOVE EXC-TIO-AUX              TO WT-TIO-AUX(WI-EXC)
              SET WI-EXC                    UP BY 1
              PERFORM BF-LEER-COLVEXC
           END-PERFORM.
           SKIP1
       BF-LEER-COLVPAR.
      *----------------
           READ COLVPAR END-READ.
           IF (WR-FS-COLVPAR NOT = 00 AND NOT = 10)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BF-LEER-COLVPAR'       TO WR-PARRAFO
               MOVE 'COLVPAR'               TO WR-ARCHIVO
               MOVE 'READ'                  TO WR-MENSAJE
               MOVE WR-FS-COLVPAR           TO WR-FILE-ST
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       BF-LEER-COLVEXC.
      *----------------
           READ COLVEXC END-READ.
           IF (WR-FS-COLVEXC NOT = 00 AND NOT = 10)
               MOVE 'B-INICIALIZAR'         TO WR-SECCION
               MOVE 'BF-LEER-COLVEXC'       TO WR-PARRAFO
               MOVE 'COLVEXC'               TO WR-ARCHIVO
               MOVE 'READ'                  TO WR-MENSAJE
               MOVE WR-FS-COLVEXC           TO WR-FILE-ST
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       BE-CARGA-REGIONAL-TEMPORAL.
      *---------------------------
      *---------------------------------------------------------------*
      * Codigo adicional para manejar sucursales con + de una regional*
      *---------------------------------------------------------------*
           SET WI-RE1                       TO 1
           SET WI-RE2                       TO 1
           ACCEPT WT-TPL-RE1(WI-RE1)
           ACCEPT WT-TPL-RE2(WI-RE2)
           PERFORM UNTIL (WT-TPL-REG(WI-RE1) = '999')
              DISPLAY 'REGIONAL : ' WT-TPL-RE1(WI-RE1)
              DISPLAY 'OFICINAS : ' WT-TPL-RE2(WI-RE2)
              SET WI-RE1                    UP BY 1
              SET WI-RE2                    UP BY 1
              ACCEPT WT-TPL-RE1(WI-RE1)
              ACCEPT WT-TPL-RE2(WI-RE2)
           END-PERFORM.
           SKIP1
       BG-DISPLAY-ERROR.
      *-----------------
           SET WS-PROCESO-ERROR             TO TRUE.
           DISPLAY ' '
           DISPLAY 'ERROR EN SECCION  : ' WR-SECCION
           DISPLAY ' PARRAFO          : ' WR-PARRAFO
           DISPLAY ' ARCHIVO          : ' WR-ARCHIVO
           DISPLAY ' OPERACION        : ' WR-OPERACI
           DISPLAY ' FILE STATUS      : ' WR-FILE-ST
           DISPLAY ' RETURN CODE      : ' WR-FILE-RC
           DISPLAY ' FUNTION CODE     : ' WR-FILE-FC
           DISPLAY ' FEEDBACK CODE    : ' WR-FILE-KC
           DISPLAY ' MENSAJE DE ERROR : ' WR-MENSAJE.
           SKIP1
       BZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       C-PROCESAR SECTION.
      *===================
       CA-PROCESO-GRAL.
      *----------------
           SORT COLVSOR ON  ASCENDING KEY SOR-KEY-SOR
              INPUT  PROCEDURE IS E-SELECCION
              OUTPUT PROCEDURE IS F-LISTADO.
           GO CZ-FIN-DE-SECCION.
           SKIP1
       CZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       D-TERMINAR SECTION.
      *===================
       DA-ESTADISTICAS.
      *----------------
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'INFORMES'
           DISPLAY '--------'
           DISPLAY ' '
           DISPLAY 'LISTADO EMITIDO EN FORMA LOCAL'
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'ESTADISTICAS DE PROCESO PROGRAMA COLPB850 FECHA '
                    WR-FECHA-HOY
           DISPLAY '-----------------------------------------------'
           DISPLAY '   INFORME DE ANALISIS DE SPREAD'
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'Leidos de COLVIDC       '  WA-L-IDC
           DISPLAY 'Selecc de COLVIDC       '  WA-S-IDC
           DISPLAY 'Grabados al sort        '  WA-G-SOR
           DISPLAY 'Leidos del sort         '  WA-L-SOR
           DISPLAY ' '
           DISPLAY 'TARJETAS DE PARAMETROS'
           DISPLAY '----------------------'
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'MENSAJES PARA EL EXPLOTADOR'
           DISPLAY '---------------------------'
           DISPLAY ' '
           IF WS-PROCESO-OK
               DISPLAY 'NO HAY MENSAJES PARA EL EXPLOTADOR'
           ELSE
               DISPLAY 'HAY MENSAJES PARA EL EXPLOTADOR'
           END-IF
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '.
           SKIP1
       DB-TERMINO.
      *-----------
           CLOSE COLVPAR COLVIDC COLL850A COLL850B COLL850C COLL850D
                 COLVEXC COLVGRA.
           IF WS-PROCESO-ERROR
              MOVE 100                      TO RETURN-CODE
              DISPLAY ' '
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
              DISPLAY '********                              ********'
              DISPLAY '******** TERMINO ERRONEO DEL PROCESO  ********'
              DISPLAY '********                              ********'
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
           ELSE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*****PROCESO TERMINO EN FORMA NORMAL*****'
           END-IF.
           SKIP1
       DZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       E-SELECCION SECTION.
      *--------------------
           PERFORM EC-START-Y-LEER-COLVIDC.
           PERFORM EA-SELECCIONA-OPERACIONES
              UNTIL (WR-FS-COLVIDC NOT = 0 OR WS-PROCESO-ERROR OR
                    (IDC-FEC-FINP > WR-FEC-FIN-SEM AND
                     IDC-FEC-FINP > WR-FEC-FIN-ACU))
           GO EZ-FIN-DE-SECCION.
           SKIP1
       EA-SELECCIONA-OPERACIONES.
      *--------------------------
           ADD  1                           TO WA-L-IDC
           SET WI-EXC                       TO 1
           SEARCH WT-TIO-AUX
             AT END
                   MOVE 'NO'                TO WR-EXCLUYE
             WHEN (WT-TIO-AUX(WI-EXC) = IDC-COD-COOC)
                   MOVE 'SI'                TO WR-EXCLUYE
             WHEN (WT-COD-TIO(WI-EXC) = IDC-COD-TOOC AND
                   WT-COD-AUX(WI-EXC) = SPACES)
                   MOVE 'SI'                TO WR-EXCLUYE
           END-SEARCH
           IF (WR-EXCLUYE = 'NO' AND IDC-PLZ-DIAS > 24)
               PERFORM EA-OPERACION-SELECC
           END-IF.
           PERFORM ED-LEER-COLVIDC.
           SKIP1
       EA-OPERACION-SELECC.
      *--------------------
           ADD  1                           TO WA-S-IDC

           MOVE SPACES                      TO WB-REQ-DBC-RC
                                               WB-REQ-DCP-RC
                                               WB-REQ-DCE-RC
           IF (WP-LEE-BANCA = 'NO')
               MOVE 'P'                     TO DBC-IND-TICL
               MOVE IDC-COD-TBAN            TO DCP-COD-TBAN
           ELSE
               PERFORM EB-BUSCA-NVA-BCA
           END-IF.

           IF (WB-REQ-DCP-RC = '  ' AND WB-REQ-DCE-RC = '  ' AND
               WB-REQ-DCP-RC = '  ')
               PERFORM EB-GRABA-AL-SORT
           END-IF.
           SKIP1
       EB-BUSCA-NVA-BCA.
      *-----------------
           MOVE IDC-IDC-ICLI                TO WB-REQ-DBC-KEY-VALUE
           PERFORM EE-LEER-DBC
           IF (WB-REQ-DBC-RC = '14')
               DISPLAY 'No existe cliente : ' IDC-IDC-ICLI
           ELSE
           IF (WB-REQ-DBC-RC = '  ' AND NOT WS-PROCESO-ERROR)
               IF (DBC-IND-TICL = 'P')
                   MOVE DBC-CIC-ICLI        TO WB-REQ-DCP-KEY-VALUE
                   PERFORM EF-LEER-DCP
               ELSE
                   MOVE DBC-CIC-ICLI        TO WB-REQ-DCE-KEY-VALUE
                   PERFORM EG-LEER-DCE
               END-IF
               IF NOT (WB-REQ-DCP-RC = '  ' AND WB-REQ-DCE-RC = '  ')
                   DISPLAY 'No existe DCP/DCE cliente : ' IDC-IDC-ICLI
               END-IF
           END-IF.
           SKIP1
       EB-GRABA-AL-SORT.
      *-----------------
           SET WI-GLS-OFI                   TO 1
           SEARCH WT-OFICINA
            AT END
                  MOVE 'SE LLENO TABLA OFICINA' TO WR-MENSAJE
                  PERFORM BG-DISPLAY-ERROR
            WHEN (WT-COD-OFI(WI-GLS-OFI) = IDC-COD-OFOC)
                  NEXT SENTENCE
            WHEN (WT-COD-OFI(WI-GLS-OFI) = SPACES)
                  MOVE IDC-COD-OFOC         TO WB-REQ-OFI-KEY-VALUE
                  PERFORM EH-LEER-OFI
                  MOVE IDC-COD-OFOC         TO WT-COD-OFI(WI-GLS-OFI)
                  MOVE OFI-COD-OREG         TO WT-COD-REG(WI-GLS-OFI)
                  MOVE OFI-GLS-DESC         TO WT-GLS-OFI(WI-GLS-OFI)
           END-SEARCH.

           MOVE WT-COD-REG(WI-GLS-OFI)      TO SOR-COD-REG
           MOVE IDC-COD-OFOC                TO SOR-COD-OFI
           MOVE IDC-COD-EJEC                TO SOR-COD-EJE
           MOVE IDC-COD-VCOC                TO SOR-COD-MON
           IF (DBC-IND-TICL = 'P')
               MOVE DCP-COD-TBAN            TO SOR-COD-BCA
           ELSE
               MOVE DCE-COD-TBAN            TO SOR-COD-BCA
           END-IF.

           EVALUATE SOR-COD-BCA
              WHEN 'A'   MOVE 'Q'           TO SOR-COD-BCA
              WHEN 'B'   MOVE 'Q'           TO SOR-COD-BCA
              WHEN 'I'   MOVE 'Q'           TO SOR-COD-BCA
              WHEN 'G'   MOVE 'C'           TO SOR-COD-BCA
           END-EVALUATE.

           MOVE IDC-FEC-FINP                TO SOR-FEC-FINP
           MOVE IDC-VAL-CPND                TO SOR-VAL-CPND
           MOVE IDC-VAL-CRED                TO SOR-VAL-CRED.
           MOVE COLRSOR                     TO WR-COLRSOR.
      *---------------------------------------------------------------*
      * Codigo adicional para manejar sucursales con + de una regional*
      *---------------------------------------------------------------*
           MOVE 'NO'                        TO WR-ENCONTRE
           PERFORM VARYING WI-RE2 FROM 1 BY 1 UNTIL (WI-RE2 > 30)
             PERFORM VARYING WI-OF1 FROM 1 BY 1 UNTIL (WI-OF1 > 18)
      *        DISPLAY 'OFICINA...' WT-COD-OF1(WI-RE2 WI-OF1)
               IF (WT-COD-OF1(WI-RE2 WI-OF1) = IDC-COD-OFOC)
                   SET WI-RE1               TO WI-RE2
                   MOVE WR-COLRSOR          TO COLRSOR
                   MOVE WT-TPL-REG(WI-RE1)  TO SOR-COD-REG
                   RELEASE COLRSOR
                   ADD 1                    TO WA-G-SOR
                   MOVE 'SI'                TO WR-ENCONTRE
               END-IF
             END-PERFORM
           END-PERFORM.

           IF (WR-ENCONTRE = 'NO')
               MOVE 'NO EXISTE OFICINA'     TO WR-MENSAJE
               MOVE IDC-COD-OFOC            TO WR-OPERACI
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       EC-START-Y-LEER-COLVIDC.
      *------------------------
           IF (WR-FEC-INI-SEM < WR-FEC-INI-ACU)
               MOVE WR-FEC-INI-SEM          TO IDC-KEY-IDC
           ELSE
               MOVE WR-FEC-INI-ACU          TO IDC-KEY-IDC
           END-IF.
           START COLVIDC KEY IS > IDC-KEY-IDC END-START
           IF (WR-FS-COLVIDC = 0)
               PERFORM ED-LEER-COLVIDC
           ELSE
           IF (WR-FS-COLVIDC NOT = 23 AND NOT = 94)
               MOVE 'E-SELECCION'           TO WR-SECCION
               MOVE 'ED-LEER-COLVIDC'       TO WR-PARRAFO
               MOVE 'COLVIDC'               TO WR-ARCHIVO
               MOVE 'READ'                  TO WR-OPERACI
               MOVE WR-FS-COLVIDC           TO WR-FILE-ST
               MOVE WR-FS-COLVIDC2-RC       TO WR-FILE-RC
               MOVE WR-FS-COLVIDC2-FC       TO WR-FILE-FC
               MOVE WR-FS-COLVIDC2-KC       TO WR-FILE-KC
               MOVE '**ERROR EN START**'    TO WR-MENSAJE
               PERFORM BG-DISPLAY-ERROR
           END-IF
           END-IF.
           SKIP1
       ED-LEER-COLVIDC.
      *----------------
           READ COLVIDC NEXT END-READ.
           IF (WR-FS-COLVIDC NOT = 0 AND NOT = 10)
               MOVE 'E-SELECCION'           TO WR-SECCION
               MOVE 'ED-LEER-COLVIDC'       TO WR-PARRAFO
               MOVE 'COLVIDC'               TO WR-ARCHIVO
               MOVE 'READ'                  TO WR-OPERACI
               MOVE WR-FS-COLVIDC           TO WR-FILE-ST
               MOVE WR-FS-COLVIDC2-RC       TO WR-FILE-RC
               MOVE WR-FS-COLVIDC2-FC       TO WR-FILE-FC
               MOVE WR-FS-COLVIDC2-KC       TO WR-FILE-KC
               MOVE '**ERROR EN READ**'     TO WR-MENSAJE
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       EE-LEER-DBC.
      *------------
           MOVE SPACES                      TO WB-REQ-DBC-RC
           MOVE 'DBC00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DBC-AREA DBC WB-ELEM-LIS
           IF (WB-REQ-DBC-RC NOT = '  ' AND NOT = '14')
               DISPLAY 'REQ : ' WB-REQ-DBC-AREA
               MOVE 'E-SELECCION'           TO WR-SECCION
               MOVE 'EE-LEER-DBC'           TO WR-PARRAFO
               MOVE 'DBC'                   TO WR-ARCHIVO
               MOVE WB-REQ-DBC-CMD          TO WR-OPERACI
               MOVE WB-REQ-DBC-RC           TO WR-FILE-ST
               MOVE WB-REQ-DBC-KEY-VALUE    TO WR-MENSAJE
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       EF-LEER-DCP.
      *------------
           MOVE SPACES                      TO WB-REQ-DCP-RC
           MOVE 'DCP00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DCP-AREA DCP WB-ELEM-LIS
           IF (WB-REQ-DCP-RC NOT = '  ' AND NOT = '14')
               DISPLAY 'REQ : ' WB-REQ-DCP-AREA
               MOVE 'E-SELECCION'           TO WR-SECCION
               MOVE 'EF-LEER-DCP'           TO WR-PARRAFO
               MOVE 'DCP'                   TO WR-ARCHIVO
               MOVE WB-REQ-DCP-CMD          TO WR-OPERACI
               MOVE WB-REQ-DCP-RC           TO WR-FILE-ST
               MOVE WB-REQ-DCP-KEY-VALUE    TO WR-MENSAJE
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       EG-LEER-DCE.
      *------------
           MOVE SPACES                      TO WB-REQ-DCE-RC
           MOVE 'DCE00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DCE-AREA DCE WB-ELEM-LIS
           IF (WB-REQ-DCE-RC NOT = '  ' AND NOT = '14')
               DISPLAY 'REQ : ' WB-REQ-DCE-AREA
               MOVE 'E-SELECCION'           TO WR-SECCION
               MOVE 'EG-LEER-DCE'           TO WR-PARRAFO
               MOVE 'DCE'                   TO WR-ARCHIVO
               MOVE WB-REQ-DCE-CMD          TO WR-OPERACI
               MOVE WB-REQ-DCE-RC           TO WR-FILE-ST
               MOVE WB-REQ-DCE-KEY-VALUE    TO WR-MENSAJE
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       EH-LEER-OFI.
      *------------
           MOVE SPACES                      TO WB-REQ-OFI-RC
           MOVE 'OFI00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-OFI-AREA OFI WB-ELEM-LIS
           IF (WB-REQ-OFI-RC = '14')
               MOVE 'XXX'                   TO OFI-COD-OREG
               MOVE 'NO EXISTE OFICINA'     TO OFI-GLS-DESC
           ELSE
           IF (WB-REQ-OFI-RC NOT = '  ')
               DISPLAY 'REQ : ' WB-REQ-OFI-AREA
               MOVE 'E-SELECCION'           TO WR-SECCION
               MOVE 'EH-LEER-OFI'           TO WR-PARRAFO
               MOVE 'OFI'                   TO WR-ARCHIVO
               MOVE WB-REQ-OFI-CMD          TO WR-OPERACI
               MOVE WB-REQ-OFI-RC           TO WR-FILE-ST
               MOVE WB-REQ-OFI-KEY-VALUE    TO WR-MENSAJE
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       EZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT
       F-LISTADO SECTION.
      *==================
       FA-PROCESO-GRAL.
      *----------------
           IF (WS-PROCESO-ERROR)
               GO FZ-FIN-DE-SECCION
           END-IF.
           IF (SORT-RETURN NOT = ZEROES)
               MOVE 'PROBLEMAS CON EL SORT' TO WR-MENSAJE
               MOVE SORT-RETURN             TO WR-FILE-ST
               PERFORM BG-DISPLAY-ERROR
               GO FZ-FIN-DE-SECCION
           END-IF.

           RETURN COLVSOR AT END MOVE 10    TO WR-FS-COLVSOR END-RETURN
           PERFORM FB-LISTA-POR-REGIONAL
                UNTIL (WR-FS-COLVSOR NOT = 0 OR WS-PROCESO-ERROR)
           PERFORM FJ-RESUMEN-BANCO.
           GO FZ-FIN-DE-SECCION.
           SKIP1
       FB-LISTA-POR-REGIONAL.
      *----------------------
           MOVE SOR-COD-REG                 TO WR-REG-ANT
           MOVE  WR-REG-ANT                 TO WR-LA04-COD-COR
      *    MOVE WR-REG-ANT                  TO WB-REQ-OFI-KEY-VALUE
      *    PERFORM EH-LEER-OFI
      *    MOVE OFI-GLS-DESC                TO WR-LA04-GLS-COR

      *---------------------------------------------------------------*
      * Codigo adicional para manejar sucursales con + de una regional*
      *---------------------------------------------------------------*
           SET WI-RE1                       TO 1
           SEARCH WT-TPL-RE1
            AT END
                  MOVE 'SIN DESCRIPCION '   TO WR-LA04-GLS-COR
            WHEN (WT-TPL-REG(WI-RE1) = WR-REG-ANT)
                  MOVE WT-TPL-GLS(WI-RE1)   TO WR-LA04-GLS-COR
           END-SEARCH.

           WRITE COLR850D FROM WR-LINEA00  AFTER PAGE.
           WRITE COLR850D FROM WR-LINEA00  AFTER 15
           PERFORM 30 TIMES
               WRITE COLR850D FROM WR-LINEA04  AFTER 1
           END-PERFORM

           INITIALIZE WT-ACUMULA(WI-REG)
           PERFORM FC-LISTA-OFICINA
              UNTIL (SOR-COD-REG   NOT = WR-REG-ANT OR
                     WR-FS-COLVSOR NOT = 0 OR WS-PROCESO-ERROR).
           MOVE WR-REG-ANT                  TO WB-REQ-OFI-KEY-VALUE
           PERFORM EH-LEER-OFI
           PERFORM FI-RESUMEN-REGIONAL.
           SKIP1
       FC-LISTA-OFICINA.
      *-----------------
           MOVE SOR-COD-OFI                 TO WR-OFI-ANT

      *---------------------------------------------------------------*
      * Codigo adicional para manejar sucursales con + de una regional*
      *---------------------------------------------------------------*
           SET WI-OFI-EMI                   TO 1
           SEARCH WT-OFI-EMX
            AT END
                  MOVE 'SE LLENO TABLA OFICINA 2' TO WR-MENSAJE
                  PERFORM BG-DISPLAY-ERROR
            WHEN (WT-OFI-EMI(WI-OFI-EMI) = WR-OFI-ANT)
                  MOVE 'SI'                 TO WR-ENCONTRE
            WHEN (WT-OFI-EMI(WI-OFI-EMI) = SPACES)
                  MOVE WR-OFI-ANT           TO WT-OFI-EMI(WI-OFI-EMI)
                  MOVE 'NO'                 TO WR-ENCONTRE
           END-SEARCH.

           INITIALIZE WT-ACUMULA(WI-OFI)
           PERFORM FD-LISTA-EJECUTIVO
              UNTIL (SOR-COD-REG   NOT = WR-REG-ANT OR
                     SOR-COD-OFI   NOT = WR-OFI-ANT OR
                     WR-FS-COLVSOR NOT = 0 OR WS-PROCESO-ERROR).
           PERFORM FH-RESUMEN-OFICINA.
           SKIP1
       FD-LISTA-EJECUTIVO.
      *-------------------
           MOVE SOR-COD-EJE                 TO WR-EJE-ANT
           INITIALIZE WT-ACUMULA(WI-EJE)
           PERFORM FE-SUMA-BANCA
              UNTIL (SOR-COD-REG   NOT = WR-REG-ANT OR
                     SOR-COD-OFI   NOT = WR-OFI-ANT OR
                     SOR-COD-EJE   NOT = WR-EJE-ANT OR
                     WR-FS-COLVSOR NOT = 0 OR WS-PROCESO-ERROR).
           PERFORM FG-RESUMEN-EJECUTIVO.
           SKIP1
       FE-SUMA-BANCA.
      *--------------
           SET WI-GLS-BCA                   TO 1
           SEARCH WT-BANCAS
            AT END
                  MOVE 'SE LLENO TABLA BANCAS' TO WR-MENSAJE
                  PERFORM BG-DISPLAY-ERROR
            WHEN (WT-COD-BCA(WI-GLS-BCA) = SOR-COD-BCA)
                  NEXT SENTENCE
            WHEN (WT-COD-BCA(WI-GLS-BCA) = SPACES AND
                  WT-GLS-BCA(WI-GLS-BCA) = SPACES)
                  MOVE 'BAN'                TO WB-REQ-TAB-KEY-TAB
                  MOVE SOR-COD-BCA          TO WB-REQ-TAB-KEY-COD
                  MOVE +190                 TO WB-REQ-TAB-BDID
                  PERFORM FQ-LEER-TAB
                  MOVE SOR-COD-BCA          TO WT-COD-BCA(WI-GLS-BCA)
                  MOVE TAB-GLS-DESC         TO WT-GLS-BCA(WI-GLS-BCA)
           END-SEARCH.

           SET WI-GLS-MON                   TO 1
           SEARCH WT-MONEDAS
            AT END
                  MOVE 'SE LLENO TABLA MONEDAS' TO WR-MENSAJE
                  PERFORM BG-DISPLAY-ERROR
            WHEN (WT-COD-MON(WI-GLS-MON) = SOR-COD-MON)
                  NEXT SENTENCE
            WHEN (WT-COD-MON(WI-GLS-MON) = SPACES)
                  MOVE 'VLR'                TO WB-REQ-TAB-KEY-TAB
                  MOVE SOR-COD-MON          TO WB-REQ-TAB-KEY-COD
                  MOVE +150                 TO WB-REQ-TAB-BDID
                  PERFORM FQ-LEER-TAB
                  MOVE SOR-COD-MON          TO WT-COD-MON(WI-GLS-MON)
                  MOVE TAB-GLS-DESC         TO WT-GLS-MON(WI-GLS-MON)
           END-SEARCH.

           SET WI-MON                       TO WI-GLS-MON
           SET WI-BCA                       TO WI-GLS-BCA

           MOVE SOR-COD-BCA                 TO WR-BCA-ANT
           MOVE SOR-COD-MON                 TO WR-MON-ANT
           PERFORM FF-SUMA-BANCA-MONEDA
              UNTIL (SOR-COD-REG   NOT = WR-REG-ANT OR
                     SOR-COD-OFI   NOT = WR-OFI-ANT OR
                     SOR-COD-EJE   NOT = WR-EJE-ANT OR
                     SOR-COD-MON   NOT = WR-MON-ANT OR
                     SOR-COD-BCA   NOT = WR-BCA-ANT OR
                     WR-FS-COLVSOR NOT = 0 OR WS-PROCESO-ERROR).
           SKIP1
       FF-SUMA-BANCA-MONEDA.
      *---------------------
           ADD 1                            TO WA-L-SOR
           IF (SOR-FEC-FINP NOT < WR-FEC-INI-SEM AND
               SOR-FEC-FINP NOT > WR-FEC-FIN-SEM)
             IF (WR-ENCONTRE = 'NO')
               ADD SOR-VAL-CPND TO WT-VAL-CPND-SEM(WI-BCO WI-MON WI-BCA)
               ADD SOR-VAL-CRED TO WT-VAL-CRED-SEM(WI-BCO WI-MON WI-BCA)
             END-IF
               ADD SOR-VAL-CPND TO WT-VAL-CPND-SEM(WI-REG WI-MON WI-BCA)
               ADD SOR-VAL-CRED TO WT-VAL-CRED-SEM(WI-REG WI-MON WI-BCA)
               ADD SOR-VAL-CPND TO WT-VAL-CPND-SEM(WI-OFI WI-MON WI-BCA)
               ADD SOR-VAL-CRED TO WT-VAL-CRED-SEM(WI-OFI WI-MON WI-BCA)
               ADD SOR-VAL-CPND TO WT-VAL-CPND-SEM(WI-EJE WI-MON WI-BCA)
               ADD SOR-VAL-CRED TO WT-VAL-CRED-SEM(WI-EJE WI-MON WI-BCA)
           END-IF
           IF (SOR-FEC-FINP NOT < WR-FEC-INI-ACU AND
               SOR-FEC-FINP NOT > WR-FEC-FIN-ACU)
               ADD SOR-VAL-CPND TO WT-VAL-CPND-ACU(WI-BCO WI-MON WI-BCA)
               ADD SOR-VAL-CRED TO WT-VAL-CRED-ACU(WI-BCO WI-MON WI-BCA)
               ADD SOR-VAL-CPND TO WT-VAL-CPND-ACU(WI-REG WI-MON WI-BCA)
               ADD SOR-VAL-CRED TO WT-VAL-CRED-ACU(WI-REG WI-MON WI-BCA)
               ADD SOR-VAL-CPND TO WT-VAL-CPND-ACU(WI-OFI WI-MON WI-BCA)
               ADD SOR-VAL-CRED TO WT-VAL-CRED-ACU(WI-OFI WI-MON WI-BCA)
               ADD SOR-VAL-CPND TO WT-VAL-CPND-ACU(WI-EJE WI-MON WI-BCA)
               ADD SOR-VAL-CRED TO WT-VAL-CRED-ACU(WI-EJE WI-MON WI-BCA)
           END-IF.
           RETURN COLVSOR AT END MOVE 10  TO WR-FS-COLVSOR END-RETURN.
           SKIP1
       FG-RESUMEN-EJECUTIVO.
      *---------------------
           MOVE 'T O T A L  S U C U R S A L' TO WR-LA03-GLS-LIS
           SET WI-GLS-OFI                    TO 1
           SEARCH WT-OFICINA
            WHEN (WT-COD-OFI(WI-GLS-OFI) = WR-OFI-ANT)
                  MOVE WT-GLS-OFI(WI-GLS-OFI) TO WR-LA04-GLS-COR
                                                 WR-LA03-GLS
           END-SEARCH.

           MOVE 'SUCURSAL '                  TO WR-LA04-TIT-COR
           MOVE  WR-OFI-ANT                  TO WR-LA04-COD-COR
                                                WR-LA03-OFI
           MOVE 'EJECUTIVO'                  TO WR-LA05-TIT-COR
           MOVE WR-EJE-ANT                   TO WR-LA05-GLS-COR
           SET WI-AUX                        TO WI-EJE
           IF (WR-ENCONTRE = 'NO')
               PERFORM FK-LISTA-DETALLE
           END-IF.
           SKIP1
       FH-RESUMEN-OFICINA.
      *--------------------
      *    MOVE WR-REG-ANT                   TO WB-REQ-OFI-KEY-VALUE
      *    PERFORM EH-LEER-OFI

           MOVE 'T O T A L  R E G I O N A L' TO WR-LA03-GLS-LIS
           MOVE 'SUCURSAL  '                 TO WR-LA05-TIT-COR
           MOVE WR-LA04-COD-GLS              TO WR-LA05-GLS-COR
           MOVE 'REGIONAL '                  TO WR-LA04-TIT-COR
           MOVE  WR-REG-ANT                  TO WR-LA04-COD-COR
      *    MOVE OFI-GLS-DESC                 TO WR-LA04-GLS-COR
      *---------------------------------------------------------------*
      * Codigo adicional para manejar sucursales con + de una regional*
      *---------------------------------------------------------------*
           SET WI-RE1                       TO 1
           SEARCH WT-TPL-RE1
            AT END
                  MOVE 'SIN DESCRIPCION '   TO WR-LA04-GLS-COR
            WHEN (WT-TPL-REG(WI-RE1) = WR-REG-ANT)
                  MOVE WT-TPL-GLS(WI-RE1)   TO WR-LA04-GLS-COR
           END-SEARCH.

           MOVE 99                           TO WA-LINEA WA-LINEA-EJE
           MOVE 0                            TO WA-PAG-EJE
           SET WI-AUX                        TO WI-OFI
           PERFORM FK-LISTA-DETALLE.
           SKIP1
       FI-RESUMEN-REGIONAL.
      *--------------------
           MOVE 'T O T A L  C O M E R C I A L' TO WR-LA03-GLS-LIS
           MOVE 99                           TO WA-LINEA
           MOVE 0                            TO WA-PAG-OFI
           SET WI-AUX                        TO WI-REG
           PERFORM FK-LISTA-DETALLE.
      *---------------------------------------------------------------*
      * Codigo adicional para manejar sucursales con + de una regional*
      *---------------------------------------------------------------*
           MOVE 'INCLUYE OFICINAS : '       TO COLR850B
           WRITE COLR850B AFTER 4.
           SET WI-RE1                       TO 1
           SEARCH WT-TPL-RE1
            WHEN (WT-TPL-REG(WI-RE1) = WR-REG-ANT)
                  SET WI-RE2                TO WI-RE1
           END-SEARCH.

           PERFORM VARYING WI-OF1 FROM 1 BY 1 UNTIL(WI-OF1 > 18 OR
                   WT-COD-OF1(WI-RE2 WI-OF1) NOT > SPACES)
             SET WI-GLS-OFI                TO 1
             SEARCH WT-OFICINA
               AT END
                     MOVE WT-COD-OF1(WI-RE2 WI-OF1) TO WR-LA14-COD-OFI
                                                    WB-REQ-OFI-KEY-VALUE
                     PERFORM EH-LEER-OFI
                     MOVE OFI-GLS-DESC           TO WR-LA14-GLS-OFI
                     WRITE COLR850B FROM WR-LINEA14 AFTER 1
               WHEN (WT-COD-OFI(WI-GLS-OFI) = WT-COD-OF1(WI-RE2 WI-OF1))
                     MOVE WT-COD-OFI(WI-GLS-OFI) TO WR-LA14-COD-OFI
                     MOVE WT-GLS-OFI(WI-GLS-OFI) TO WR-LA14-GLS-OFI
                     WRITE COLR850B FROM WR-LINEA14 AFTER 1
              END-SEARCH
           END-PERFORM.
           SKIP1
       FJ-RESUMEN-BANCO.
      *-----------------
           MOVE 'T O T A L     B A N C O'    TO WR-LA03-GLS-LIS
           MOVE 99                           TO WA-LINEA
           MOVE 0                            TO WA-PAG-REG
           SET WI-AUX                        TO WI-BCO
           PERFORM FK-LISTA-DETALLE.
           SKIP1
       FK-LISTA-DETALLE.
      *-----------------
           EVALUATE TRUE
              WHEN WI-AUX = WI-BCO MOVE 'BCO' TO WR-LB01-TIP
              WHEN WI-AUX = WI-REG MOVE 'COM' TO WR-LB01-TIP
              WHEN WI-AUX = WI-OFI MOVE 'REG' TO WR-LB01-TIP
           END-EVALUATE.
           MOVE WR-LB01-TIP                 TO WR-LB02-TIP WR-LB03-TIP
                                               WR-LB04-TIP WR-LB05-TIP
                                               WR-LB06-TIP WR-LB07-TIP
                                               WR-LB08-TIP WR-LB09-TIP

           MOVE 'T'                         TO WR-TIPO-LINEA-TIT
           PERFORM VARYING WI-I FROM 1 BY 1 UNTIL (WI-I > 20)
              MOVE 0                         TO WI-K
              PERFORM VARYING WI-J FROM 1 BY 1 UNTIL (WI-J > 20)
                 MOVE 0                     TO WR-TASA-ACU WR-TASA-SEM
                 IF (WT-VAL-CRED-SEM(WI-AUX WI-I WI-J) NOT = 0)
                     COMPUTE WR-TASA-SEM ROUNDED =
                                   WT-VAL-CPND-SEM(WI-AUX WI-I WI-J)
                                 / WT-VAL-CRED-SEM(WI-AUX WI-I WI-J)
                 END-IF
                 IF (WT-VAL-CRED-ACU(WI-AUX WI-I WI-J) NOT = 0)
                     COMPUTE WR-TASA-ACU ROUNDED =
                                   WT-VAL-CPND-ACU(WI-AUX WI-I WI-J)
                                 / WT-VAL-CRED-ACU(WI-AUX WI-I WI-J)
                 END-IF
                 IF (WR-TASA-ACU NOT = 0  OR WR-TASA-SEM NOT = 0)
                     IF (WI-K = 0)
                         MOVE 'M'           TO WR-TIPO-LINEA
                         MOVE WT-GLS-MON(WI-I) TO WR-LA12-GLS-MON
                     END-IF
                     MOVE WR-TASA-SEM       TO WR-LA13-SPR-SEM
                     MOVE WR-TASA-ACU       TO WR-LA13-SPR-ACU
                     MOVE WT-COD-BCA(WI-J)  TO WR-LA13-TIP-BCA
                     MOVE WT-GLS-BCA(WI-J)  TO WR-LA13-GLS-BCA
                     PERFORM FL-LINEA-DETALLE
                 END-IF
              END-PERFORM
           END-PERFORM.
           SKIP1
       FL-LINEA-DETALLE.
      *-----------------
           IF (WA-LINEA > 55)
               EVALUATE TRUE
                  WHEN WI-AUX = WI-BCO PERFORM FM-TITULO-BCO
                  WHEN WI-AUX = WI-REG PERFORM FN-TITULO-REG
                  WHEN WI-AUX = WI-OFI PERFORM FO-TITULO-OFI
               END-EVALUATE
               MOVE 15                      TO WA-LINEA
           END-IF.

           IF (WI-AUX = WI-EJE)
               IF (WA-LINEA-EJE > 55)
                   PERFORM FP-TITULO-EJE
                   MOVE 11                  TO WA-LINEA-EJE
               END-IF
               IF (WR-LA05-TIT-COR = 'EJECUTIVO')
                   WRITE COLR850D FROM WR-LINEA05  AFTER 2
                   MOVE SPACES              TO WR-LA05-TIT-COR
                   ADD  2                   TO WA-LINEA-EJE
               END-IF
           END-IF.

           IF (WI-K = 0)
               MOVE 1                       TO WI-K
               EVALUATE TRUE
                  WHEN WI-AUX = WI-BCO WRITE COLR850A FROM WR-LINEA00
                                       WRITE COLR850A FROM WR-LINEA12
                                       ADD   2 TO WA-LINEA
                  WHEN WI-AUX = WI-REG WRITE COLR850B FROM WR-LINEA00
                                       WRITE COLR850B FROM WR-LINEA12
                                       ADD   2 TO WA-LINEA
                  WHEN WI-AUX = WI-OFI WRITE COLR850C FROM WR-LINEA00
                                       WRITE COLR850C FROM WR-LINEA12
                                       ADD   2 TO WA-LINEA
                  WHEN WI-AUX = WI-EJE WRITE COLR850D FROM WR-LINEA00
                                       WRITE COLR850D FROM WR-LINEA12
                                       ADD   2 TO WA-LINEA-EJE
               END-EVALUATE
           END-IF.

           EVALUATE TRUE
              WHEN WI-AUX = WI-BCO WRITE COLR850A FROM WR-LINEA13
                                   PERFORM XX-INF-SPRD-GRAFICO
                                   ADD  1   TO WA-LINEA
              WHEN WI-AUX = WI-REG WRITE COLR850B FROM WR-LINEA13
                                   PERFORM XX-INF-SPRD-GRAFICO
                                   ADD  1   TO WA-LINEA
              WHEN WI-AUX = WI-OFI WRITE COLR850C FROM WR-LINEA13
                                   PERFORM XX-INF-SPRD-GRAFICO
                                   ADD  1   TO WA-LINEA
              WHEN WI-AUX = WI-EJE WRITE COLR850D FROM WR-LINEA13
                                   ADD  1   TO WA-LINEA-EJE
           END-EVALUATE.
           SKIP1
       XX-INF-SPRD-GRAFICO.
      *--------------------
           IF (WR-TIPO-LINEA-TIT = 'T')
               MOVE ' '                     TO WR-TIPO-LINEA-TIT
               MOVE WR-LA03-GLS-LIS         TO WR-LB02-GLS-TIT
               WRITE COLRGRA FROM WR-LINEB03
               WRITE COLRGRA FROM WR-LINEB03
               WRITE COLRGRA FROM WR-LINEB01
               WRITE COLRGRA FROM WR-LINEB02
               WRITE COLRGRA FROM WR-LINEB03
               IF (WI-AUX = WI-REG OR = WI-OFI)
                  MOVE 'Regional   :'       TO WR-LB04-TIP-GLS
                  MOVE WR-LA04-COD-COR      TO WR-LB04-COR-COD
                  MOVE WR-LA04-GLS-COR      TO WR-LB04-COR-GLS
                  WRITE COLRGRA FROM WR-LINEB04
               END-IF
               IF (WI-AUX = WI-OFI)
                  MOVE 'Sucursal   :'       TO WR-LB04-TIP-GLS
                  MOVE WR-LA05-COD-COR      TO WR-LB04-COR-COD
                  MOVE WR-LA05-COR-GLS      TO WR-LB04-COR-GLS
                  WRITE COLRGRA FROM WR-LINEB04
               END-IF
               MOVE 'Semana      :'         TO WR-LB05-TIP-PER
               MOVE WR-LA07-FEC-SEM1        TO WR-LB05-FEC-DES
               MOVE WR-LA07-FEC-SEM2        TO WR-LB05-FEC-HAS
               WRITE COLRGRA FROM WR-LINEB05
               MOVE 'Acumulado   :'         TO WR-LB05-TIP-PER
               MOVE WR-LA08-FEC-ACU1        TO WR-LB05-FEC-DES
               MOVE WR-LA08-FEC-ACU2        TO WR-LB05-FEC-HAS
               WRITE COLRGRA FROM WR-LINEB05
           END-IF

           IF (WR-TIPO-LINEA = 'M')
               MOVE ' '                     TO WR-TIPO-LINEA
               WRITE COLRGRA FROM WR-LINEB03
               MOVE WT-GLS-MON(WI-I)        TO WR-LB06-GLS-MON
               WRITE COLRGRA FROM WR-LINEB06
               WRITE COLRGRA FROM WR-LINEB07
               WRITE COLRGRA FROM WR-LINEB08
           END-IF.

           MOVE WT-GLS-BCA(WI-J)            TO WR-LB09-GLS-BCA
           MOVE WT-COD-BCA(WI-J)            TO WR-LB09-COD-BCA
           MOVE WR-TASA-SEM                 TO WR-LB09-SPR-SEM
           MOVE WR-TASA-ACU                 TO WR-LB09-SPR-ACU
           WRITE COLRGRA FROM WR-LINEB09.

           IF (WR-FS-COLVGRA NOT = 00)
               MOVE 'F-LISTADO'             TO WR-SECCION
               MOVE 'XX-INF-SPRD-GRAFICO'   TO WR-PARRAFO
               MOVE 'COLVGRA'               TO WR-ARCHIVO
               MOVE 'WRITE'                 TO WR-MENSAJE
               MOVE WR-FS-COLVGRA           TO WR-FILE-ST
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       FM-TITULO-BCO.
      *--------------
           ADD 1                            TO WA-PAG-BCO
           MOVE WA-PAG-BCO                  TO WR-LA02-NUM-PAG
           WRITE COLR850A FROM WR-LINEA01  AFTER PAGE.
           WRITE COLR850A FROM WR-LINEA02  AFTER 1.
           WRITE COLR850A FROM WR-LINEA03  AFTER 2.
           WRITE COLR850A FROM WR-LINEA00  AFTER 2.
           WRITE COLR850A FROM WR-LINEA00  AFTER 1.
           WRITE COLR850A FROM WR-LINEA07  AFTER 2.
           WRITE COLR850A FROM WR-LINEA08  AFTER 1.
           WRITE COLR850A FROM WR-LINEA09  AFTER 2.
           WRITE COLR850A FROM WR-LINEA10  AFTER 1.
           WRITE COLR850A FROM WR-LINEA11  AFTER 1.
           SKIP1
       FN-TITULO-REG.
      *--------------
           ADD 1                            TO WA-PAG-REG
           MOVE WA-PAG-REG                  TO WR-LA02-NUM-PAG
           WRITE COLR850B FROM WR-LINEA01  AFTER PAGE.
           WRITE COLR850B FROM WR-LINEA02  AFTER 1.
           WRITE COLR850B FROM WR-LINEA03  AFTER 2.
           WRITE COLR850B FROM WR-LINEA04  AFTER 2.
           WRITE COLR850B FROM WR-LINEA00  AFTER 1.
           WRITE COLR850B FROM WR-LINEA07  AFTER 2.
           WRITE COLR850B FROM WR-LINEA08  AFTER 1.
           WRITE COLR850B FROM WR-LINEA09  AFTER 2.
           WRITE COLR850B FROM WR-LINEA10  AFTER 1.
           WRITE COLR850B FROM WR-LINEA11  AFTER 1.
           SKIP1
       FO-TITULO-OFI.
      *--------------
           ADD 1                            TO WA-PAG-OFI
           MOVE WA-PAG-OFI                  TO WR-LA02-NUM-PAG
           WRITE COLR850C FROM WR-LINEA01  AFTER PAGE.
           WRITE COLR850C FROM WR-LINEA02  AFTER 1.
           WRITE COLR850C FROM WR-LINEA03  AFTER 2.
           WRITE COLR850C FROM WR-LINEA04  AFTER 2.
           WRITE COLR850C FROM WR-LINEA05  AFTER 1.
           WRITE COLR850C FROM WR-LINEA07  AFTER 2.
           WRITE COLR850C FROM WR-LINEA08  AFTER 1.
           WRITE COLR850C FROM WR-LINEA09  AFTER 2.
           WRITE COLR850C FROM WR-LINEA10  AFTER 1.
           WRITE COLR850C FROM WR-LINEA11  AFTER 1.
           SKIP1
       FP-TITULO-EJE.
      *--------------
           ADD 1                            TO WA-PAG-EJE
           MOVE WA-PAG-EJE                  TO WR-LA02-NUM-PAG
           WRITE COLR850D FROM WR-LINEA01  AFTER PAGE.
           WRITE COLR850D FROM WR-LINEA02  AFTER 1.
           WRITE COLR850D FROM WR-LINEA03  AFTER 2.
           WRITE COLR850D FROM WR-LINEA07  AFTER 2.
           WRITE COLR850D FROM WR-LINEA08  AFTER 1.
           WRITE COLR850D FROM WR-LINEA09  AFTER 2.
           WRITE COLR850D FROM WR-LINEA10  AFTER 1.
           WRITE COLR850D FROM WR-LINEA11  AFTER 1.
           SKIP1
       FQ-LEER-TAB.
      *------------
           MOVE SPACES                      TO WB-REQ-TAB-RC
           MOVE 'TAB00'                     TO WB-ELEM-LIS
           CALL 'DBNTRY' USING WB-UIB WB-REQ-TAB-AREA TAB WB-ELEM-LIS
           IF (WB-REQ-TAB-RC = '14')
               MOVE 'SIN DESCRIPCION'       TO TAB-GLS-DESC
           ELSE
           IF (WB-REQ-TAB-RC NOT = '  ')
               DISPLAY 'REQ : ' WB-REQ-TAB-AREA
               MOVE 'F-LISTADO'             TO WR-SECCION
               MOVE 'FQ-LEER-TAB'           TO WR-PARRAFO
               MOVE 'TAB'                   TO WR-ARCHIVO
               MOVE WB-REQ-TAB-CMD          TO WR-OPERACI
               MOVE WB-REQ-TAB-RC           TO WR-FILE-ST
               MOVE WB-REQ-TAB-KEY-VALUE    TO WR-MENSAJE
               PERFORM BG-DISPLAY-ERROR
           END-IF.
           SKIP1
       FZ-FIN-DE-SECCION.
      *------------------
           EXIT.
           EJECT

