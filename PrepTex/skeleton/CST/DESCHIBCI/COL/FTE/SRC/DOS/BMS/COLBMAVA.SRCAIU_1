      * 14-Feb-94 09:32 AM
       PUT-ALL-AVA SECTION.
       INI-PUT-ALL-AVA.
           PERFORM PUT-LDA-AVA.
       FIN-PUT-ALL-AVA.
           EXIT.

       PUT-LDA-AVA SECTION.
       INI-PUT-LDA-AVA.
           IF PGM-STAT-LDA-NUL
               GO TO FIN-PUT-LDA-AVA.
           IF NOT PGM-STAT-LDA-OKS
               PERFORM CLR-LDA-AVA
               GO TO FIN-PUT-LDA-AVA.
           MOVE LDA-NUM-SIS IN LDA TO LDA-NUM-SIS IN AVA-FLD.
           MOVE LDA-COD-CRR IN LDA TO LDA-COD-CRR IN AVA-FLD.
           MOVE LDA-FD-VTO-LIN IN LDA TO LDA-FD-VTO-LIN IN AVA-FLD.
           MOVE LDA-FM-VTO-LIN IN LDA TO LDA-FM-VTO-LIN IN AVA-FLD.
           MOVE LDA-FA-VTO-LIN IN LDA TO LDA-FA-VTO-LIN IN AVA-FLD.
           MOVE LDA-VAL-AUT IN LDA TO LDA-VAL-AUT IN AVA-FLD.
           MOVE LDA-COD-EST IN LDA TO LDA-COD-EST IN AVA-FLD.
           MOVE 'DBC-KEY-IDBC'           TO FIO-AKEY
           PERFORM BUS-CLIENTE.
           MOVE CCT-COD-CRR IN LDA       TO FRM-COD-CRR IN AVA-FLD.
      *>>>
       FIN-PUT-LDA-AVA.
           EXIT.
      * 14-Feb-94 09:32 AM
       RET-ALL-AVA SECTION.
       INI-RET-ALL-AVA.
           PERFORM KEY-ALL-AVA.
           PERFORM RET-LDA-AVA.
       FIN-RET-ALL-AVA.
           EXIT.

       RET-LDA-AVA SECTION.
       INI-RET-LDA-AVA.
           MOVE LDA-FD-VTO-LIN IN AVA-FLD TO LDA-FD-VTO-LIN IN LDA.
           MOVE LDA-FM-VTO-LIN IN AVA-FLD TO LDA-FM-VTO-LIN IN LDA.
           MOVE LDA-FA-VTO-LIN IN AVA-FLD TO LDA-FA-VTO-LIN IN LDA.
           MOVE LDA-VAL-AUT IN AVA-FLD TO LDA-VAL-AUT IN LDA.
           MOVE LDA-COD-EST IN AVA-FLD TO LDA-COD-EST IN LDA.
       FIN-RET-LDA-AVA.
           EXIT.

       KEY-ALL-AVA SECTION.
       INI-KEY-ALL-AVA.
           PERFORM KEY-LDA-AVA.
       FIN-KEY-ALL-AVA.
           EXIT.

       KEY-LDA-AVA SECTION.
       INI-KEY-LDA-AVA.
           MOVE LDA-NUM-SIS IN AVA-FLD TO LDA-NUM-SIS IN LDA.
           MOVE LDA-COD-CRR IN AVA-FLD TO LDA-COD-CRR IN LDA.
       FIN-KEY-LDA-AVA.
           EXIT.

       SCR-CLRA-AVA SECTION.
       INI-SCR-CLRA-AVA.
           PERFORM CLR-KEY-AVA.
           PERFORM CLR-FLD-AVA.
       FIN-SCR-CLRA-AVA.
           EXIT.

       CLR-KEY-AVA SECTION.
       INI-CLR-KEY-AVA.
           MOVE SPACES TO LDA-NUM-SIS IN AVA-FLD.
           MOVE ZEROES TO LDA-COD-CRR IN AVA-FLD.
           MOVE ZEROES TO FRM-NUM-ICLI IN AVA-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN AVA-FLD.
       FIN-CLR-KEY-AVA.
           EXIT.

       CLR-FLD-AVA SECTION.
       INI-CLR-FLD-AVA.
           MOVE SPACES TO FRM-GLS-NOMC IN AVA-FLD.
           MOVE SPACES TO FRM-COD-CRR IN AVA-FLD.
           MOVE SPACES TO FRM-LIN-DET IN AVA-FLD(1).
           MOVE SPACES TO FRM-LIN-DET IN AVA-FLD(2).
           MOVE SPACES TO FRM-LIN-DET IN AVA-FLD(3).
           MOVE SPACES TO FRM-LIN-DET IN AVA-FLD(4).
           MOVE SPACES TO FRM-LIN-DET IN AVA-FLD(5).
           MOVE SPACES TO FRM-LIN-DET IN AVA-FLD(6).
           MOVE SPACES TO FRM-LIN-DET IN AVA-FLD(7).
           MOVE SPACES TO FRM-LIN-DET IN AVA-FLD(8).
           MOVE SPACES TO FRM-GLS-UTLZ IN AVA-FLD.
           MOVE SPACES TO FRM-GLS-DISP IN AVA-FLD.
           PERFORM CLR-LDA-AVA.
       FIN-CLR-FLD-AVA.
           EXIT.

       CLR-LDA-AVA SECTION.
       INI-CLR-LDA-AVA.
           MOVE SPACES TO LDA-FEC-VTO-LIN IN AVA-FLD.
           MOVE ZEROES TO LDA-VAL-AUT IN AVA-FLD.
           MOVE SPACES TO LDA-COD-EST IN AVA-FLD.
       FIN-CLR-LDA-AVA.
           EXIT.

       FST-KEY-AVA SECTION.
       INI-FST-KEY-AVA.
           MOVE -1 TO LDA-NUM-SIS-LEN IN AVA-FLD.
       FIN-FST-KEY-AVA.
           EXIT.

       FST-FLD-AVA SECTION.
       INI-FST-FLD-AVA.
           MOVE -1 TO FRM-NUM-ICLI-LEN IN AVA-FLD.
       FIN-FST-FLD-AVA.
           EXIT.

       PRO-KEY-AVA SECTION.
       INI-PRO-KEY-AVA.
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN AVA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN AVA-FLD.
           PERFORM PRO-IKY-AVA.
           PERFORM PRO-AKY-AVA.
           PERFORM PRO-MKY-AVA.
      *<<<
           PERFORM PON-TOT-FRM.
      *>>>
       FIN-PRO-KEY-AVA.
           EXIT.

       PRO-IKY-AVA SECTION.
       INI-PRO-IKY-AVA.
           MOVE FRM-CPIM-AEY TO LDA-NUM-SIS-ATR IN AVA-FLD.
           MOVE FRM-CPIM-AEY TO LDA-COD-CRR-ATR IN AVA-FLD.
       FIN-PRO-IKY-AVA.
           EXIT.

       PRO-MKY-AVA SECTION.
       INI-PRO-MKY-AVA.
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN AVA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN AVA-FLD.
       FIN-PRO-MKY-AVA.
           EXIT.

       PRO-AKY-AVA SECTION.
       INI-PRO-AKY-AVA.
       FIN-PRO-AKY-AVA.
           EXIT.

       PRO-FLD-AVA SECTION.
       INI-PRO-FLD-AVA.
           PERFORM PRO-LDA-AVA.
       FIN-PRO-FLD-AVA.
           EXIT.

       PRO-LDA-AVA SECTION.
       INI-PRO-LDA-AVA.
       FIN-PRO-LDA-AVA.
           EXIT.

       UNP-KEY-AVA SECTION.
       INI-UNP-KEY-AVA.
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN AVA-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN AVA-FLD.
           PERFORM UNP-IKY-AVA.
           PERFORM UNP-AKY-AVA.
           PERFORM UNP-MKY-AVA.
       FIN-UNP-KEY-AVA.
           EXIT.

       UNP-IKY-AVA SECTION.
       INI-UNP-IKY-AVA.
           MOVE FRM-CPIM-UBY TO LDA-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO LDA-COD-CRR-ATR.
       FIN-UNP-IKY-AVA.
           EXIT.

       UNP-MKY-AVA SECTION.
       INI-UNP-MKY-AVA.
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR.
       FIN-UNP-MKY-AVA.
           EXIT.

       UNP-AKY-AVA SECTION.
       INI-UNP-AKY-AVA.
       FIN-UNP-AKY-AVA.
           EXIT.

       UNP-FLD-AVA SECTION.
       INI-UNP-FLD-AVA.
           PERFORM UNP-LDA-AVA.
       FIN-UNP-FLD-AVA.
           EXIT.

       UNP-LDA-AVA SECTION.
       INI-UNP-LDA-AVA.
       FIN-UNP-LDA-AVA.
           EXIT.

       VAL-KEY-AVA SECTION.
       INI-VAL-KEY-AVA.
           PERFORM VAL-IKY-AVA.
           PERFORM VAL-MKY-AVA.
           PERFORM VAL-AKY-AVA.
       FIN-VAL-KEY-AVA.
           EXIT.

       VAL-IKY-AVA SECTION.
       INI-VAL-IKY-AVA.
           PERFORM VAL-LDA-NUM-SIS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDA-NUM-SIS-LEN IN AVA-FLD
                GO TO FIN-VAL-IKY-AVA.
           PERFORM VAL-LDA-COD-CRR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDA-COD-CRR-LEN IN AVA-FLD
                GO TO FIN-VAL-IKY-AVA.
       FIN-VAL-IKY-AVA.
           EXIT.

       VAL-MKY-AVA SECTION.
       INI-VAL-MKY-AVA.
           PERFORM VAL-FRM-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-NUM-ICLI-LEN IN AVA-FLD
                GO TO FIN-VAL-MKY-AVA.
           PERFORM VAL-FRM-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-VRF-ICLI-LEN IN AVA-FLD
                GO TO FIN-VAL-MKY-AVA.
       FIN-VAL-MKY-AVA.
           EXIT.

       VAL-AKY-AVA SECTION.
       INI-VAL-AKY-AVA.
       FIN-VAL-AKY-AVA.
           EXIT.

       VAL-FLD-AVA SECTION.
       INI-VAL-FLD-AVA.
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-NOMC-LEN IN AVA-FLD
                GO TO FIN-VAL-FLD-AVA.
           PERFORM VAL-FRM-COD-CRR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-COD-CRR-LEN IN AVA-FLD
                GO TO FIN-VAL-FLD-AVA.
           PERFORM VAL-LDA-FEC-VTO-LIN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDA-FEC-VTO-LIN-LEN IN AVA-FLD
                GO TO FIN-VAL-FLD-AVA.
           PERFORM VAL-LDA-VAL-AUT.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDA-VAL-AUT-LEN IN AVA-FLD
                GO TO FIN-VAL-FLD-AVA.
           PERFORM VAL-LDA-COD-EST.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDA-COD-EST-LEN IN AVA-FLD
                GO TO FIN-VAL-FLD-AVA.
           PERFORM VAL-FRM-LIN-DET
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 8
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-LIN-DET-LEN IN AVA-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-AVA.
           PERFORM VAL-FRM-GLS-UTLZ.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-UTLZ-LEN IN AVA-FLD
                GO TO FIN-VAL-FLD-AVA.
           PERFORM VAL-FRM-GLS-DISP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-DISP-LEN IN AVA-FLD
                GO TO FIN-VAL-FLD-AVA.
       FIN-VAL-FLD-AVA.
           EXIT.

       VAL-LDA-NUM-SIS SECTION.
       INI-VAL-LDA-NUM-SIS.
           IF LDA-NUM-SIS IN AVA-FLD NOT > SPACES
              MOVE SPACES TO LDA-NUM-SIS IN AVA-FLD.
      *<<<
           IF (LDA-NUM-SIS IN AVA-FLD > SPACES)
               MOVE LDA-NUM-SIS IN AVA-FLD  TO WR-NUM-SIS
               IF (WR-NUM-SIS-L NOT = 'L')
                   MOVE FRM-SUAR-MAL        TO FRM-SUAR
                   MOVE 'COL'               TO MSG-COD-SIST
                   MOVE 'LDASISINV'         TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MENS
                   MOVE -1                  TO LDA-NUM-SIS-LEN
                   GO TO FIN-VAL-LDA-NUM-SIS.
      *>>>
       FIN-VAL-LDA-NUM-SIS.
           EXIT.

       VAL-LDA-COD-CRR SECTION.
       INI-VAL-LDA-COD-CRR.
       FIN-VAL-LDA-COD-CRR.
           EXIT.

       VAL-FRM-NUM-ICLI SECTION.
       INI-VAL-FRM-NUM-ICLI.
       FIN-VAL-FRM-NUM-ICLI.
           EXIT.

       VAL-FRM-VRF-ICLI SECTION.
       INI-VAL-FRM-VRF-ICLI.
           IF FRM-VRF-ICLI IN AVA-FLD NOT > SPACES
              MOVE SPACES TO FRM-VRF-ICLI IN AVA-FLD.
      *VAL-VRF Valida Verificador
           MOVE VRF-VAL TO VRF-CMND.
           MOVE VRF-SVRF-K TO VRF-SVRF.
           MOVE VRF-ZERO-S TO VRF-ZERO.
           MOVE FRM-NUM-ICLI IN AVA-FLD TO VRF-NUME.
           MOVE FRM-VRF-ICLI IN AVA-FLD TO VRF-DVRF.
           MOVE 7 TO VRF-LMAX.
           PERFORM PRO-VRF.
      *<<< valida existencia cliente por rut
           IF (FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR OR
               FRM-VRF-ICLI IN AVA-FLD NOT > SPACES)
               GO TO FIN-VAL-FRM-VRF-ICLI.

           MOVE 'DBC-IDC-ICLI'           TO FIO-AKEY
           PERFORM BUS-CLIENTE
           IF (NOT ADR-STAT-OKS IN ADR-DBC-REQA)
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VRF-ICLI.
      *>>>
       FIN-VAL-FRM-VRF-ICLI.
           EXIT.

       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.

       VAL-FRM-COD-CRR SECTION.
       INI-VAL-FRM-COD-CRR.
       FIN-VAL-FRM-COD-CRR.
           EXIT.

       VAL-LDA-FEC-VTO-LIN SECTION.
       INI-VAL-LDA-FEC-VTO-LIN.
       FIN-VAL-LDA-FEC-VTO-LIN.
           EXIT.

       VAL-LDA-VAL-AUT SECTION.
       INI-VAL-LDA-VAL-AUT.
       FIN-VAL-LDA-VAL-AUT.
           EXIT.

       VAL-LDA-COD-EST SECTION.
       INI-VAL-LDA-COD-EST.
       FIN-VAL-LDA-COD-EST.
           EXIT.

       VAL-FRM-LIN-DET SECTION.
       INI-VAL-FRM-LIN-DET.
       FIN-VAL-FRM-LIN-DET.
           EXIT.

       VAL-FRM-GLS-UTLZ SECTION.
       INI-VAL-FRM-GLS-UTLZ.
       FIN-VAL-FRM-GLS-UTLZ.
           EXIT.

       VAL-FRM-GLS-DISP SECTION.
       INI-VAL-FRM-GLS-DISP.
       FIN-VAL-FRM-GLS-DISP.
           EXIT.

       VAL-CON-KEY-AVA SECTION.
       INI-VAL-CON-KEY-AVA.
           IF     LDA-NUM-SIS IN AVA-FLD NOT > SPACES
              AND LDA-COD-CRR IN AVA-FLD NOT > ZEROES
              AND FRM-NUM-ICLI IN AVA-FLD NOT > ZEROES
              AND FRM-VRF-ICLI IN AVA-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-AVA.
       FIN-VAL-CON-KEY-AVA.
           EXIT.

       VAL-CON-IKY-AVA SECTION.
       INI-VAL-CON-IKY-AVA.
           IF     LDA-NUM-SIS IN AVA-FLD NOT > SPACES
              AND LDA-COD-CRR IN AVA-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-AVA.
       FIN-VAL-CON-IKY-AVA.
           EXIT.

       VAL-CON-FLD-AVA SECTION.
       INI-VAL-CON-FLD-AVA.
       FIN-VAL-CON-FLD-AVA.
           EXIT.

       VAL-CON-AVA SECTION.
       INI-VAL-CON-AVA.
       FIN-VAL-CON-AVA.
           EXIT.

       VAL-NUM-KEY-AVA SECTION.
       INI-VAL-NUM-KEY-AVA.
           PERFORM VAL-NUM-IKY-AVA.
           PERFORM VAL-NUM-MKY-AVA.
           PERFORM VAL-NUM-AKY-AVA.
       FIN-VAL-NUM-KEY-AVA.
           EXIT.

       VAL-NUM-IKY-AVA SECTION.
       INI-VAL-NUM-IKY-AVA.
       VAL-NUM-LDA-COD-CRR.
           MOVE LDA-COD-CRR-ALF IN AVA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO LDA-COD-CRR IN AVA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LDA-COD-CRR-LEN IN AVA-FLD
                GO TO FIN-VAL-NUM-IKY-AVA.
       FIN-VAL-NUM-IKY-AVA.
           EXIT.

       VAL-NUM-MKY-AVA SECTION.
       INI-VAL-NUM-MKY-AVA.
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN AVA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-ICLI IN AVA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-ICLI-LEN IN AVA-FLD
                GO TO FIN-VAL-NUM-MKY-AVA.
       FIN-VAL-NUM-MKY-AVA.
           EXIT.

       VAL-NUM-AKY-AVA SECTION.
       INI-VAL-NUM-AKY-AVA.
       FIN-VAL-NUM-AKY-AVA.
           EXIT.

       VAL-NUM-FLD-AVA SECTION.
       INI-VAL-NUM-FLD-AVA.
       VAL-NUM-LDA-VAL-AUT.
           MOVE LDA-VAL-AUT-ALF IN AVA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO LDA-VAL-AUT IN AVA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LDA-VAL-AUT-LEN IN AVA-FLD
                GO TO FIN-VAL-NUM-FLD-AVA.
       FIN-VAL-NUM-FLD-AVA.
           EXIT.

       EDT-KEY-AVA SECTION.
       INI-EDT-KEY-AVA.
           PERFORM EDT-IKY-AVA.
           PERFORM EDT-MKY-AVA.
           PERFORM EDT-AKY-AVA.
       FIN-EDT-KEY-AVA.
           EXIT.

       EDT-IKY-AVA SECTION.
       INI-EDT-IKY-AVA.
           IF LDA-COD-CRR-LEN IN AVA-FLD = -9
                MOVE -1 TO LDA-COD-CRR-LEN IN AVA-FLD
                GO TO FIN-EDT-IKY-AVA.
           MOVE LDA-COD-CRR IN AVA-FLD TO LDA-COD-CRR-EDT IN AVA-EDT.
           MOVE LDA-COD-CRR-EDT IN AVA-EDT TO
                LDA-COD-CRR-ALF IN AVA-FLD.
       FIN-EDT-IKY-AVA.
           EXIT.

       EDT-MKY-AVA SECTION.
       INI-EDT-MKY-AVA.
           IF FRM-NUM-ICLI-LEN IN AVA-FLD = -9
                MOVE -1 TO FRM-NUM-ICLI-LEN IN AVA-FLD
                GO TO FIN-EDT-MKY-AVA.
           MOVE FRM-NUM-ICLI IN AVA-FLD TO FRM-NUM-ICLI-EDT IN AVA-EDT.
           MOVE FRM-NUM-ICLI-EDT IN AVA-EDT TO
                FRM-NUM-ICLI-ALF IN AVA-FLD.
       FIN-EDT-MKY-AVA.
           EXIT.

       EDT-AKY-AVA SECTION.
       INI-EDT-AKY-AVA.
       FIN-EDT-AKY-AVA.
           EXIT.

       EDT-FLD-AVA SECTION.
       INI-EDT-FLD-AVA.
           IF LDA-VAL-AUT-LEN IN AVA-FLD = -9
                MOVE -1 TO LDA-VAL-AUT-LEN IN AVA-FLD
                GO TO FIN-EDT-FLD-AVA.
           MOVE LDA-VAL-AUT IN AVA-FLD TO LDA-VAL-AUT-EDT IN AVA-EDT.
           MOVE LDA-VAL-AUT-EDT IN AVA-EDT TO
                LDA-VAL-AUT-ALF IN AVA-FLD.
       FIN-EDT-FLD-AVA.
           EXIT.
      *<<<
       BUS-CLIENTE SECTION.
       INI-BUS-CLTE.
      *Lee DBC y puebla datos pantalla
           IF (FIO-AKEY = 'DBC-IDC-ICLI')
               MOVE FRM-NUM-ICLI IN AVA-FLD TO DBC-NUM-ICLI IN DBC
               MOVE SPACES                  TO DBC-IND-ICLI IN DBC
               MOVE SPACES                  TO DBC-GLS-ICLI IN DBC
               MOVE FIO-GET-NLS             TO FIO-CMND
           ELSE
               MOVE CLI-CIC IN LDA          TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY             TO FIO-CMND.

           PERFORM SGC-FIO-DBC.

           IF NOT FIO-STAT-OKS OR
                 (FIO-STAT-OKS AND FRM-NUM-ICLI NOT = DBC-NUM-ICLI AND
                  CLI-CIC IN LDA NOT = DBC-CIC-ICLI IN DBC)
                  MOVE '23'                  TO ADR-STAT IN ADR-DBC-REQA
                  MOVE 'SGC'                 TO MSG-COD-SIST
                  MOVE 'CLI    NEX'          TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC          TO FRM-MENS
                  MOVE '00'                  TO FIO-STAT
                  MOVE SPACES                TO FRM-GLS-NOMC IN AVA-FLD
                  MOVE FRM-SUAR-MAL          TO FRM-SUAR
                  MOVE -1                    TO FRM-NUM-ICLI-LEN
              ELSE
                  MOVE SPACES                TO FRM-MENS
                  MOVE DBC-NUM-ICLI IN DBC   TO FRM-NUM-ICLI IN AVA-FLD
                  MOVE DBC-VRF-ICLI IN DBC   TO FRM-VRF-ICLI IN AVA-FLD
                  MOVE DBC-GLS-NOMC IN DBC   TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN             TO FRM-GLS-NOMC IN AVA-FLD.
       FIN-BUS-CLTE.
           EXIT.
      *>>>
