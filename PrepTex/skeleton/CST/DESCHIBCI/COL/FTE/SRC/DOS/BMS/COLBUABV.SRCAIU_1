      *
      * COLBUABV
      * Version 3.0.1 Nov-2005
      * 01-Jul-19 11:10 AM
      *
       SET-TAG-COLBUABV SECTION.
       INI-SET-TAG-COLBUABV.
           MOVE
           '<IDNMOD NOM=$COLBUABV$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$01-Jul-19 11:10 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-COLBUABV.
           EXIT.
           
       RET-ALL-ABV SECTION.
       INI-RET-ALL-ABV.
           PERFORM KEY-ALL-ABV.
           PERFORM RET-OIA-ABV.
       FIN-RET-ALL-ABV.
           EXIT.
       
       RET-OIA-ABV SECTION.
       INI-RET-OIA-ABV.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE OIA-NUM-DLIQ IN ABV-FLD TO OIA-NUM-DLIQ IN OIA.
           MOVE OIA-NUM-MLIQ IN ABV-FLD TO OIA-NUM-MLIQ IN OIA.
           MOVE OIA-NUM-SLIQ IN ABV-FLD TO OIA-NUM-SLIQ IN OIA.
           MOVE OIA-NUM-ALIQ IN ABV-FLD TO OIA-NUM-ALIQ IN OIA.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE OIA-COD-OLIQ IN ABV-FLD TO OIA-COD-OLIQ IN OIA.
           MOVE OIA-COD-UAPR IN ABV-FLD TO OIA-COD-UAPR IN OIA.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE OIA-NUM-DAPR IN ABV-FLD TO OIA-NUM-DAPR IN OIA.
           MOVE OIA-NUM-MAPR IN ABV-FLD TO OIA-NUM-MAPR IN OIA.
           MOVE OIA-NUM-SAPR IN ABV-FLD TO OIA-NUM-SAPR IN OIA.
           MOVE OIA-NUM-AAPR IN ABV-FLD TO OIA-NUM-AAPR IN OIA.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE OIA-HRA-HAPR IN ABV-FLD TO OIA-HRA-HAPR IN OIA.
       FIN-RET-OIA-ABV.
           EXIT.
       
       KEY-ALL-ABV SECTION.
       INI-KEY-ALL-ABV.
           PERFORM KEY-OIA-ABV.
       FIN-KEY-ALL-ABV.
           EXIT.
       
       KEY-OIA-ABV SECTION.
       INI-KEY-OIA-ABV.
      *<<<< INI_KEY_OIA_ABV
           MOVE WSS-CT-ABV              TO OIA-COD-CPTO IN OIA.
      *>>>>
           MOVE OIA-CAI-IOPC IN ABV-FLD TO OIA-CAI-IOPC IN OIA.
           MOVE OIA-IIC-IOPC IN ABV-FLD TO OIA-IIC-IOPC IN OIA.
       FIN-KEY-OIA-ABV.
           EXIT.
       
       SCR-CLRA-ABV SECTION.
       INI-SCR-CLRA-ABV.
           PERFORM CLR-KEY-ABV.
           PERFORM CLR-FLD-ABV.
       FIN-SCR-CLRA-ABV.
           EXIT.
       
       CLR-KEY-ABV SECTION.
       INI-CLR-KEY-ABV.
           MOVE SPACES TO OIA-CAI-IOPC IN ABV-FLD.
           MOVE ZEROES TO OIA-IIC-IOPC IN ABV-FLD.
       FIN-CLR-KEY-ABV.
           EXIT.
       
       CLR-FLD-ABV SECTION.
       INI-CLR-FLD-ABV.
           MOVE SPACES TO FRM-COD-VCOC IN ABV-FLD.
           MOVE SPACES TO FRM-COD-TOOC IN ABV-FLD.
           MOVE SPACES TO FRM-COD-AOOC IN ABV-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN ABV-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN ABV-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN ABV-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-ICLI IN ABV-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN ABV-FLD.
           MOVE SPACES TO FRM-IND-ICLI IN ABV-FLD.
           MOVE SPACES TO FRM-GLS-ICLI IN ABV-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-NOMC IN ABV-FLD.
           MOVE ZEROES TO FRM-VAL-CRED IN ABV-FLD.
           MOVE SPACES TO FRM-GLS-VCO2 IN ABV-FLD.
           MOVE ZEROES TO FRM-VAL-DINT IN ABV-FLD.
           MOVE SPACES TO FRM-GLS-TAUT IN ABV-FLD.
           MOVE SPACES TO FRM-GLS-NOME IN ABV-FLD.
           MOVE ZEROES TO FRM-VAL-PLZO IN ABV-FLD.
           PERFORM CLR-OIA-ABV.
       FIN-CLR-FLD-ABV.
           EXIT.
       
       CLR-OIA-ABV SECTION.
       INI-CLR-OIA-ABV.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OIA-FEC-FLIQ IN ABV-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO OIA-COD-OLIQ IN ABV-FLD.
           MOVE SPACES TO OIA-COD-UAPR IN ABV-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OIA-FEC-FAPR IN ABV-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OIA-HRA-HAPR IN ABV-FLD.
       FIN-CLR-OIA-ABV.
           EXIT.
       
       FST-KEY-ABV SECTION.
       INI-FST-KEY-ABV.
           MOVE -1 TO OIA-CAI-IOPC-LEN IN ABV-FLD.
       FIN-FST-KEY-ABV.
           EXIT.
       
       FST-FLD-ABV SECTION.
       INI-FST-FLD-ABV.
      *<<<< INI_FST_FLD_ABV
           MOVE FRM-POS-CURS TO OIA-COD-OLIQ-LEN IN ABV-FLD.
           GO TO FIN-FST-FLD-ABV.
      *>>>>
           MOVE FRM-POS-CURS TO OIA-FEC-FLIQ-LEN IN ABV-FLD.
       FIN-FST-FLD-ABV.
           EXIT.
       
       PRO-KEY-ABV SECTION.
       INI-PRO-KEY-ABV.
           PERFORM PRO-MKY-ABV.
       FIN-PRO-KEY-ABV.
           EXIT.
       
       PRO-MKY-ABV SECTION.
       INI-PRO-MKY-ABV.
       FIN-PRO-MKY-ABV.
           EXIT.
       
       PRO-FLD-ABV SECTION.
       INI-PRO-FLD-ABV.
           PERFORM PRO-OIA-ABV.
       FIN-PRO-FLD-ABV.
           EXIT.
       
       PRO-OIA-ABV SECTION.
       INI-PRO-OIA-ABV.
           MOVE FRM-CPIM-AEY TO OIA-FEC-FLIQ-ATR IN ABV-FLD.
           MOVE FRM-CPIM-AEY TO OIA-COD-OLIQ-ATR IN ABV-FLD.
           MOVE FRM-CPIM-AEY TO OIA-COD-UAPR-ATR IN ABV-FLD.
           MOVE FRM-CPIM-AEY TO OIA-FEC-FAPR-ATR IN ABV-FLD.
           MOVE FRM-CPIM-AEY TO OIA-HRA-HAPR-ATR IN ABV-FLD.
       FIN-PRO-OIA-ABV.
           EXIT.
       
       UNP-KEY-ABV SECTION.
       INI-UNP-KEY-ABV.
           PERFORM UNP-IKY-ABV.
           PERFORM UNP-AKY-ABV.
           PERFORM UNP-MKY-ABV.
       FIN-UNP-KEY-ABV.
           EXIT.
       
       UNP-IKY-ABV SECTION.
       INI-UNP-IKY-ABV.
           MOVE FRM-CPIM-UBY TO OIA-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO OIA-IIC-IOPC-ATR.
       FIN-UNP-IKY-ABV.
           EXIT.
       
       UNP-MKY-ABV SECTION.
       INI-UNP-MKY-ABV.
       FIN-UNP-MKY-ABV.
           EXIT.
       
       UNP-AKY-ABV SECTION.
       INI-UNP-AKY-ABV.
       FIN-UNP-AKY-ABV.
           EXIT.
       
       UNP-FLD-ABV SECTION.
       INI-UNP-FLD-ABV.
           PERFORM UNP-OIA-ABV.
       FIN-UNP-FLD-ABV.
           EXIT.
       
       UNP-OIA-ABV SECTION.
       INI-UNP-OIA-ABV.
           MOVE FRM-CPIM-UBY TO OIA-FEC-FLIQ-ATR IN ABV-FLD.
           MOVE FRM-CPIM-UBY TO OIA-COD-OLIQ-ATR IN ABV-FLD.
           MOVE FRM-CPIM-UBY TO OIA-COD-UAPR-ATR IN ABV-FLD.
           MOVE FRM-CPIM-UBY TO OIA-FEC-FAPR-ATR IN ABV-FLD.
           MOVE FRM-CPIM-UBY TO OIA-HRA-HAPR-ATR IN ABV-FLD.
      *<<<< FIN_UNP_OIA_ABV
           MOVE FRM-CPIM-AEY TO OIA-FEC-FLIQ-ATR IN ABV-FLD.
           MOVE FRM-CPIM-AEY TO OIA-COD-UAPR-ATR IN ABV-FLD.
           MOVE FRM-CPIM-AEY TO OIA-FEC-FAPR-ATR IN ABV-FLD.
           MOVE FRM-CPIM-AEY TO OIA-HRA-HAPR-ATR IN ABV-FLD.
      *>>>>
       FIN-UNP-OIA-ABV.
           EXIT.
       
       VAL-MKY-ABV SECTION.
       INI-VAL-MKY-ABV.
       FIN-VAL-MKY-ABV.
           EXIT.
       
       VAL-FLD-ABV SECTION.
       INI-VAL-FLD-ABV.
           PERFORM VAL-FRM-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-VCOC-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-TOOC-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-AOOC-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-GLS-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCOC-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-GLS-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOOC-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-GLS-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOOC-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-IND-ICLI-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-GLS-ICLI-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-NUM-ICLI-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-VRF-ICLI-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMC-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-VAL-CRED.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-CRED-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-GLS-VCO2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCO2-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OIA-FEC-FLIQ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                OIA-FEC-FLIQ-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-VAL-DINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-DINT-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-OIA-COD-OLIQ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OIA-COD-OLIQ-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-GLS-TAUT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TAUT-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-OIA-COD-UAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OIA-COD-UAPR-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-GLS-NOME.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOME-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OIA-FEC-FAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                OIA-FEC-FAPR-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OIA-HRA-HAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OIA-HRA-HAPR-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
           PERFORM VAL-FRM-VAL-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-PLZO-LEN IN ABV-FLD
                GO TO FIN-VAL-FLD-ABV.
       FIN-VAL-FLD-ABV.
           EXIT.
       
       VAL-FRM-COD-VCOC SECTION.
       INI-VAL-FRM-COD-VCOC.
       FIN-VAL-FRM-COD-VCOC.
           EXIT.
       
       VAL-FRM-COD-TOOC SECTION.
       INI-VAL-FRM-COD-TOOC.
       FIN-VAL-FRM-COD-TOOC.
           EXIT.
       
       VAL-FRM-COD-AOOC SECTION.
       INI-VAL-FRM-COD-AOOC.
       FIN-VAL-FRM-COD-AOOC.
           EXIT.
       
       VAL-FRM-GLS-VCOC SECTION.
       INI-VAL-FRM-GLS-VCOC.
       FIN-VAL-FRM-GLS-VCOC.
           EXIT.
       
       VAL-FRM-GLS-TOOC SECTION.
       INI-VAL-FRM-GLS-TOOC.
       FIN-VAL-FRM-GLS-TOOC.
           EXIT.
       
       VAL-FRM-GLS-AOOC SECTION.
       INI-VAL-FRM-GLS-AOOC.
       FIN-VAL-FRM-GLS-AOOC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-FRM-NUM-ICLI SECTION.
       INI-VAL-FRM-NUM-ICLI.
       FIN-VAL-FRM-NUM-ICLI.
           EXIT.

       VAL-FRM-VRF-ICLI SECTION.
       INI-VAL-FRM-VRF-ICLI.
           IF FRM-VRF-ICLI IN ABV-FLD NOT > SPACES
              MOVE SPACES TO FRM-VRF-ICLI IN ABV-FLD.
       FIN-VAL-FRM-VRF-ICLI.
           EXIT.
       VAL-FRM-IND-ICLI SECTION.
       INI-VAL-FRM-IND-ICLI.
           IF FRM-IND-ICLI IN ABV-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-ICLI IN ABV-FLD.
       FIN-VAL-FRM-IND-ICLI.
           EXIT.

       VAL-FRM-GLS-ICLI SECTION.
       INI-VAL-FRM-GLS-ICLI.
      *<<<< INI_FRM_GLS_ICLI
           GO TO FIN-VAL-FRM-GLS-ICLI.
      *>>>>
           IF FRM-GLS-ICLI IN ABV-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO FRM-GLS-ICLI IN ABV-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE FRM-GLS-ICLI IN ABV-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO FRM-GLS-ICLI IN ABV-FLD.
       FIN-VAL-FRM-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-FRM-VAL-CRED SECTION.
       INI-VAL-FRM-VAL-CRED.
       FIN-VAL-FRM-VAL-CRED.
           EXIT.
       
       VAL-FRM-GLS-VCO2 SECTION.
       INI-VAL-FRM-GLS-VCO2.
       FIN-VAL-FRM-GLS-VCO2.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-OIA-FEC-FLIQ SECTION.
       INI-VAL-OIA-FEC-FLIQ.
           IF OIA-FEC-FLIQ IN ABV-FLD  NOT > ZEROES
              MOVE ZEROES TO OIA-FEC-FLIQ IN ABV-FLD.
      *VAL-FEC Validar Fecha
           MOVE OIA-FEC-FLIQ IN ABV-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO OIA-FEC-FLIQ IN ABV-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-OIA-FEC-FLIQ.
      *<<<< FIN_OIA_FEC_FLIQ
           IF SCR-CMND = WSS-CT-MOD AND
              OIA-FEC-FLIQ IN ABV-FLD > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-DHOY TO OIA-NUM-DLIQ IN ABV-FLD
              MOVE HOY-MHOY TO OIA-NUM-MLIQ IN ABV-FLD
              MOVE HOY-SHOY TO OIA-NUM-SLIQ IN ABV-FLD
              MOVE HOY-AHOY TO OIA-NUM-ALIQ IN ABV-FLD
              PERFORM CAL-BACKVALUE
              IF MSG-COD-MENS > SPACES
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-OIA-FEC-FLIQ.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-VAL-DINT SECTION.
       INI-VAL-FRM-VAL-DINT.
       FIN-VAL-FRM-VAL-DINT.
           EXIT.
       
       VAL-OIA-COD-OLIQ SECTION.
       INI-VAL-OIA-COD-OLIQ.
           IF OIA-COD-OLIQ IN ABV-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OIA-COD-OLIQ.
      *<<<< OIA_COD_OLIQ
           MOVE WSS-CT-COL   TO TAB-COD-SIST.
           MOVE WSS-CT-ABV   TO TAB-COD-TTAB IN TAB.
           MOVE OIA-COD-OLIQ IN ABV-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
              GO TO FIN-VAL-OIA-COD-OLIQ.
              
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TAUT IN ABV-FLD. 
      *>>>>
       FIN-VAL-OIA-COD-OLIQ.
           EXIT.
       
       VAL-FRM-GLS-TAUT SECTION.
       INI-VAL-FRM-GLS-TAUT.
       FIN-VAL-FRM-GLS-TAUT.
           EXIT.
       
       VAL-OIA-COD-UAPR SECTION.
       INI-VAL-OIA-COD-UAPR.
           IF OIA-COD-UAPR IN ABV-FLD NOT > SPACES
              MOVE SPACES TO OIA-COD-UAPR IN ABV-FLD.
      *<<<< OIA_COD_UAPR
           IF OIA-COD-UAPR IN ABV-FLD NOT > SPACES
              MOVE SCR-USER TO OIA-COD-UAPR IN ABV-FLD.
      *>>>>
       FIN-VAL-OIA-COD-UAPR.
           EXIT.
       
       VAL-FRM-GLS-NOME SECTION.
       INI-VAL-FRM-GLS-NOME.
       FIN-VAL-FRM-GLS-NOME.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-OIA-FEC-FAPR SECTION.
       INI-VAL-OIA-FEC-FAPR.
           IF OIA-FEC-FAPR IN ABV-FLD  NOT > ZEROES
              MOVE ZEROES TO OIA-FEC-FAPR IN ABV-FLD.
      *VAL-FEC Validar Fecha
           MOVE OIA-FEC-FAPR IN ABV-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO OIA-FEC-FAPR IN ABV-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-OIA-FEC-FAPR.
      *<<<< FIN_OIA_FEC_FAPR
           IF SCR-CMND = WSS-CT-ING OR WSS-CT-MOD
              PERFORM GET-FHOY
              MOVE HOY-DHOY IN HOY-VARI TO OIA-NUM-DAPR IN ABV-FLD
              MOVE HOY-MHOY IN HOY-VARI TO OIA-NUM-MAPR IN ABV-FLD
              MOVE HOY-SHOY IN HOY-VARI TO OIA-NUM-SAPR IN ABV-FLD
              MOVE HOY-AHOY IN HOY-VARI TO OIA-NUM-AAPR IN ABV-FLD
              MOVE HOY-HHOY IN HOY-VARI TO OIA-HRA-HAPR IN ABV-FLD.
      *>>>>
       FIN-VAL-OIA-FEC-FAPR.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-OIA-HRA-HAPR SECTION.
       INI-VAL-OIA-HRA-HAPR.
       FIN-VAL-OIA-HRA-HAPR.
           EXIT.
       
       VAL-FRM-VAL-PLZO SECTION.
       INI-VAL-FRM-VAL-PLZO.
       FIN-VAL-FRM-VAL-PLZO.
           EXIT.
       
       VAL-CON-FLD-ABV SECTION.
       INI-VAL-CON-FLD-ABV.
       FIN-VAL-CON-FLD-ABV.
           EXIT.
       
       VAL-CON-ABV SECTION.
       INI-VAL-CON-ABV.
       FIN-VAL-CON-ABV.
           EXIT.
       
       VAL-NUM-KEY-ABV SECTION.
       INI-VAL-NUM-KEY-ABV.
           PERFORM VAL-NUM-IKY-ABV.
           PERFORM VAL-NUM-MKY-ABV.
           PERFORM VAL-NUM-AKY-ABV.
       FIN-VAL-NUM-KEY-ABV.
           EXIT.
       
       VAL-NUM-IKY-ABV SECTION.
       INI-VAL-NUM-IKY-ABV.
       VAL-NUM-OIA-IIC-IOPC.
           MOVE OIA-IIC-IOPC-ALF IN ABV-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO OIA-IIC-IOPC IN ABV-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OIA-IIC-IOPC-LEN IN ABV-FLD
                GO TO FIN-VAL-NUM-IKY-ABV.
       FIN-VAL-NUM-IKY-ABV.
           EXIT.
       
       VAL-NUM-MKY-ABV SECTION.
       INI-VAL-NUM-MKY-ABV.
       FIN-VAL-NUM-MKY-ABV.
           EXIT.
       
       VAL-NUM-AKY-ABV SECTION.
       INI-VAL-NUM-AKY-ABV.
       FIN-VAL-NUM-AKY-ABV.
           EXIT.
       
       VAL-NUM-FLD-ABV SECTION.
       INI-VAL-NUM-FLD-ABV.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN ABV-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN ABV-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN ABV-FLD
                GO TO FIN-VAL-NUM-FLD-ABV.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-VAL-CRED.
           MOVE FRM-VAL-CRED-ALF IN ABV-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-CRED IN ABV-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-CRED-LEN IN ABV-FLD
                GO TO FIN-VAL-NUM-FLD-ABV.
       VAL-NUM-FRM-VAL-DINT.
           MOVE FRM-VAL-DINT-ALF IN ABV-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-DINT IN ABV-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-DINT-LEN IN ABV-FLD
                GO TO FIN-VAL-NUM-FLD-ABV.
       VAL-NUM-OIA-HRA-HAPR.
           MOVE OIA-HRA-HAPR-ALF IN ABV-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO OIA-HRA-HAPR IN ABV-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OIA-HRA-HAPR-LEN IN ABV-FLD
                GO TO FIN-VAL-NUM-FLD-ABV.
       VAL-NUM-FRM-VAL-PLZO.
           MOVE FRM-VAL-PLZO-ALF IN ABV-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-VAL-PLZO IN ABV-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-PLZO-LEN IN ABV-FLD
                GO TO FIN-VAL-NUM-FLD-ABV.
       FIN-VAL-NUM-FLD-ABV.
           EXIT.
       
       EDT-KEY-ABV SECTION.
       INI-EDT-KEY-ABV.
           PERFORM EDT-IKY-ABV.
           PERFORM EDT-MKY-ABV.
           PERFORM EDT-AKY-ABV.
       FIN-EDT-KEY-ABV.
           EXIT.
       
       EDT-IKY-ABV SECTION.
       INI-EDT-IKY-ABV.
           IF OIA-IIC-IOPC-LEN IN ABV-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OIA-IIC-IOPC-LEN IN ABV-FLD
                GO TO FIN-EDT-IKY-ABV.
           MOVE OIA-IIC-IOPC IN ABV-FLD TO OIA-IIC-IOPC-EDT IN ABV-EDT.
           MOVE OIA-IIC-IOPC-EDT IN ABV-EDT TO 
                OIA-IIC-IOPC-ALF IN ABV-FLD.
       FIN-EDT-IKY-ABV.
           EXIT.
       
       EDT-MKY-ABV SECTION.
       INI-EDT-MKY-ABV.
       FIN-EDT-MKY-ABV.
           EXIT.
       
       EDT-AKY-ABV SECTION.
       INI-EDT-AKY-ABV.
       FIN-EDT-AKY-ABV.
           EXIT.
       
       EDT-FLD-ABV SECTION.
       INI-EDT-FLD-ABV.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-ICLI-LEN IN ABV-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN ABV-FLD
                GO TO FIN-EDT-FLD-ABV.
           MOVE FRM-NUM-ICLI IN ABV-FLD TO
                FRM-NUM-ICLI-EDT IN ABV-EDT.
           MOVE FRM-NUM-ICLI-EDT IN ABV-EDT TO
                FRM-NUM-ICLI-ALF IN ABV-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-VAL-CRED-LEN IN ABV-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-CRED-LEN IN ABV-FLD
                GO TO FIN-EDT-FLD-ABV.
           MOVE FRM-VAL-CRED IN ABV-FLD TO FRM-VAL-CRED-EDT IN ABV-EDT.
           MOVE FRM-VAL-CRED-EDT IN ABV-EDT TO 
                FRM-VAL-CRED-ALF IN ABV-FLD.
           IF FRM-VAL-DINT-LEN IN ABV-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-DINT-LEN IN ABV-FLD
                GO TO FIN-EDT-FLD-ABV.
           MOVE FRM-VAL-DINT IN ABV-FLD TO FRM-VAL-DINT-EDT IN ABV-EDT.
           MOVE FRM-VAL-DINT-EDT IN ABV-EDT TO 
                FRM-VAL-DINT-ALF IN ABV-FLD.
           IF OIA-HRA-HAPR-LEN IN ABV-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OIA-HRA-HAPR-LEN IN ABV-FLD
                GO TO FIN-EDT-FLD-ABV.
           MOVE OIA-HRA-HAPR IN ABV-FLD TO OIA-HRA-HAPR-EDT IN ABV-EDT.
           MOVE OIA-HRA-HAPR-EDT IN ABV-EDT TO 
                OIA-HRA-HAPR-ALF IN ABV-FLD.
           IF FRM-VAL-PLZO-LEN IN ABV-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-PLZO-LEN IN ABV-FLD
                GO TO FIN-EDT-FLD-ABV.
           MOVE FRM-VAL-PLZO IN ABV-FLD TO FRM-VAL-PLZO-EDT IN ABV-EDT.
           MOVE FRM-VAL-PLZO-EDT IN ABV-EDT TO 
                FRM-VAL-PLZO-ALF IN ABV-FLD.
       FIN-EDT-FLD-ABV.
           EXIT.
      *<<<< EOF_BU
      *-----------------------------------------------
      *-----------------------------------------------
       CAL-BACKVALUE SECTION.
       INI-CAL-BACKVALUE.
           MOVE OIA-CAI-IOPC IN ABV-FLD TO OPC-CAI-IOPC IN OPC
           MOVE OIA-IIC-IOPC IN ABV-FLD TO OPC-IIC-IOPC IN OPC
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
              MOVE WSS-CT-COL      TO MSG-COD-SIST
              MOVE WSS-CT-OPCNEX   TO MSG-COD-MENS
              GO TO FIN-CAL-BACKVALUE.
              
      *OBTENEMOS TASA PERIODO
           PERFORM GET-FHOY.
           MOVE OPC-CIC-IOPC IN OPC         TO INT-IOPC
           MOVE OPC-COD-VCOC IN OPC         TO INT-VCAM.
           MOVE OPC-NUM-DCOL IN OPC         TO INT-DCOL.
           MOVE OPC-NUM-MCOL IN OPC         TO INT-MCOL.
           MOVE OPC-NUM-SCOL IN OPC         TO INT-SCOL.
           MOVE OPC-NUM-ACOL IN OPC         TO INT-ACOL.
           MOVE WSS-CT-1                    TO INT-IDLC.
           MOVE OPC-NUM-DCOL IN OPC         TO INT-DUNO
           MOVE OPC-NUM-MCOL IN OPC         TO INT-MUNO
           MOVE OPC-NUM-SCOL IN OPC         TO INT-SUNO
           MOVE OPC-NUM-ACOL IN OPC         TO INT-AUNO
           MOVE HOY-DHOY                    TO INT-DDOS
           MOVE HOY-MHOY                    TO INT-MDOS
           MOVE HOY-SHOY                    TO INT-SDOS
           MOVE HOY-AHOY                    TO INT-ADOS.
           MOVE HOY-DHOY                    TO INT-DBTV.
           MOVE HOY-MHOY                    TO INT-MBTV.
           MOVE HOY-SHOY                    TO INT-SBTV.
           MOVE HOY-AHOY                    TO INT-ABTV.

           PERFORM COL-CAL-INT.
           IF INT-CMSG > SPACES
              MOVE INT-CMSG    TO MSG-COD-MENS
              MOVE WSS-CT-COL  TO MSG-COD-SIST
              GO TO FIN-CAL-BACKVALUE.
           
           MULTIPLY INT-TIPE BY OPC-VAL-CRED IN OPC
                    GIVING WSS-SGV-VINT.
           MOVE WSS-SGV-VINT TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-VINT.
           
      *VALIDA QUE DIFERENCIA DE INTERESES NO SEA MAYOR A INT 1ER VEN
           MOVE OPC-CAI-IOPC IN OPC       TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN OPC       TO VEN-IIC-IOPC IN VEN.
           MOVE WSS-CT-1                  TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY               TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              MOVE WSS-CT-NO1VEN  TO MSG-COD-MENS
              MOVE WSS-CT-COL     TO MSG-COD-SIST
              GO TO FIN-CAL-BACKVALUE.
              
           COMPUTE WSS-VAL-INT1 =   VEN-VAL-FINA IN VEN
                                  - VEN-VAL-CAPI IN VEN.
                                  
           IF WSS-SGV-VINT > WSS-VAL-INT1
              MOVE WSS-CT-DIN1VN  TO MSG-COD-MENS
              MOVE WSS-CT-COL     TO MSG-COD-SIST
              GO TO FIN-CAL-BACKVALUE.
           
           MOVE WSS-SGV-VINT TO FRM-VAL-DINT IN ABV-FLD.
       FIN-CAL-BACKVALUE.
           EXIT.
      *>>>>
