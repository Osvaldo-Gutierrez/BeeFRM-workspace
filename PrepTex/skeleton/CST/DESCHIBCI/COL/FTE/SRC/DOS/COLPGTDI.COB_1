       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. COLPGTDI.
       AUTHOR. CONSIST.
       DATE-WRITTEN. 13-APR-1992
      *
      * GENERA TRANSIENT DATA DE INPUT (TDI) DESDE INTERFACE COLI01 Y
      * EFECTUA LINK A PROGRAMA COLPPMTD.
      *
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       COPY GNSWVSCR.
       COPY GNSWGSYS.
       COPY GNSBRTDI.
       COPY GNSWGTDI.

       COPY GNSWCFIO.
       COPY GNSWVFIO.

       COPY GNSWGFRM.

       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.

       COPY GNSBRIDD.
       COPY GNSWVIDD.
       COPY GNSWGQUE.

       COPY GNSBRTAB.
       COPY COLBRI01.


      * JVM: VARIABLES DE MENSAJES PARA GENERAR TDI
       01  WSS-TDI.
           03 WSS-TDI-OPC-ING.
              05 WSS-TDI-OPC-ING-IKY.
                 07 WSS-SIS1-OPC                PIC X(03).
                 07 WSS-OPC1-OPC                PIC X(12).
                 07 WSS-FIN1-OPC                PIC X(03).
                 07 WSS-FOU1-OPC                PIC X(03).
                 07 WSS-TOOC-OPC                PIC X(03).
                 07 WSS-CAI1-OPC                PIC X(04).
                 07 WSS-IIC1-OPC                PIC X(08).
                 07 WSS-CAIC-OPC                PIC X(04).
                 07 WSS-IICC-OPC                PIC X(08).
                 07 WSS-NUMC-OPC                PIC 9(03).
                 07 WSS-VCAM-OPC                PIC X(06).
                 07 WSS-CAUX-OPC                PIC X(03).
              05 WSS-TDI-OPC-ING-GFL.
                 07 WSS-SIS3-OPC                PIC X(03).
                 07 WSS-OPC3-OPC                PIC X(12).
                 07 WSS-FIN3-OPC                PIC X(03).
                 07 WSS-FOU3-OPC                PIC X(03).
                 07 WSS-OFIC-OPC                PIC X(03).
                 07 WSS-NCLI-OPC                PIC X(08).
                 07 WSS-VCLI-OPC                PIC X(01).
                 07 WSS-ICLI-OPC                PIC X(01).
                 07 WSS-GCLI-OPC                PIC X(03).
                 07 WSS-NDIR-OPC                PIC 9(02).
                 07 WSS-MCRE-OPC                PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
                 07 WSS-FCUR-OPC                PIC X(08).
                 07 WSS-FCTB-OPC                PIC X(08).
                 07 WSS-TASA-OPC                PIC ZZZZ,ZZZZ.
                 07 WSS-CGAR-OPC                PIC X(03).
                 07 WSS-EJEC-OPC                PIC X(12).
                 07 WSS-ABON-OPC                PIC X(05).
                 07 WSS-CAIO-OPC                PIC X(04).
                 07 WSS-IICO-OPC                PIC X(08).
                 07 WSS-DEST-OPC                PIC X(03).
                 07 WSS-CAIG-OPC                PIC X(04).
                 07 WSS-IICG-OPC                PIC X(08).
              05 WSS-TDI-OPC-LIQ-GKY.
                 07 WSS-SIS5-OPC                PIC X(03).
                 07 WSS-OPC5-OPC                PIC X(12).
                 07 WSS-FIN5-OPC                PIC X(03).
                 07 WSS-FOU5-OPC                PIC X(03).
                 07 WSS-CAI5-OPC                PIC X(04).
                 07 WSS-IIC5-OPC                PIC X(08).
              05 WSS-TDI-OPC-LIQ-GCS.
                 07 WSS-SIS7-OPC                PIC X(03).
                 07 WSS-OPC7-OPC                PIC X(12).
                 07 WSS-FIN7-OPC                PIC X(03).
                 07 WSS-FOU7-OPC                PIC X(03).
              05 WSS-TDI-OPC-ACA-GKY.
                 07 WSS-SISA-OPC                PIC X(03).
                 07 WSS-OPCA-OPC                PIC X(12).
                 07 WSS-FINA-OPC                PIC X(03).
                 07 WSS-FOUA-OPC                PIC X(03).
                 07 WSS-CAIA-OPC                PIC X(04).
                 07 WSS-IICA-OPC                PIC X(08).
              05 WSS-TDI-OPC-ACA-GCS.
                 07 WSS-SISB-OPC                PIC X(03).
                 07 WSS-OPCB-OPC                PIC X(12).
                 07 WSS-FINB-OPC                PIC X(03).
                 07 WSS-FOUB-OPC                PIC X(03).
           03 WSS-TDI-DLC-ING.
              05 WSS-TDI-DLC-ING-IKY.
                 07 WSS-SIS1-DLC                PIC X(03).
                 07 WSS-OPC1-DLC                PIC X(12).
                 07 WSS-FIN1-DLC                PIC X(03).
                 07 WSS-FOU1-DLC                PIC X(03).
                 07 WSS-CAI1-DLC                PIC X(04).
                 07 WSS-IIC1-DLC                PIC X(08).
              05 WSS-TDI-DLC-ING-GFL.
                 07 WSS-SIS3-DLC                PIC X(03).
                 07 WSS-OPC3-DLC                PIC X(12).
                 07 WSS-FIN3-DLC                PIC X(03).
                 07 WSS-FOU3-DLC                PIC X(03).
                 07 WSS-NAVL-DLC                PIC X(08).
                 07 WSS-VAVL-DLC                PIC X(01).
                 07 WSS-IAVL-DLC                PIC X(01).
                 07 WSS-GAVL-DLC                PIC X(03).
                 07 WSS-RIES-DLC                PIC X(02).
                 07 WSS-TDOC-DLC                PIC X(03).
                 07 WSS-UFIS-DLC                PIC X(09).
                 07 WSS-TIMP-DLC                PIC X(01).
                 07 WSS-VIMP-DLC                PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
                 07 WSS-PZAC-DLC                PIC X(04).
                 07 WSS-PZOC-DLC                PIC X(02).
                 07 WSS-IPER-DLC                PIC X(01).
                 07 WSS-SCAR-DLC                PIC X(03).
                 07 WSS-SCTB-DLC                PIC X(03).
                 07 WSS-SCBZ-DLC                PIC X(05).
                 07 WSS-TOPA-DLC                PIC X(03).
           03 WSS-TDI-EVC-ING.
              05 WSS-TDI-EVC-ING-IKY.
                 07 WSS-SIS1-EVC                PIC X(03).
                 07 WSS-OPC1-EVC                PIC X(12).
                 07 WSS-FIN1-EVC                PIC X(03).
                 07 WSS-FOU1-EVC                PIC X(03).
                 07 WSS-CAI1-EVC                PIC X(04).
                 07 WSS-IIC1-EVC                PIC X(08).
                 07 WSS-NUME-EVC                PIC 9(03).
              05 WSS-TDI-EVC-ING-GFL.
                 07 WSS-SIS3-EVC                PIC X(03).
                 07 WSS-OPC3-EVC                PIC X(12).
                 07 WSS-FIN3-EVC                PIC X(03).
                 07 WSS-FOU3-EVC                PIC X(03).
                 07 WSS-TVTO-EVC                PIC 9(03).
                 07 WSS-IUTV-EVC                PIC X(01).
                 07 WSS-VCAL-EVC                PIC X(02).
                 07 WSS-VVTO-EVC                PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
                 07 WSS-PSEV-EVC                PIC 9(03).
                 07 WSS-CUTV-EVC                PIC X(01).


       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                             PIC X(01).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 1 TO TDI-NUM-RECO.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-VSM.
           PERFORM GNS-ERR-QUE.
      *
           PERFORM GNS-GET-IDD.

           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-I01.
           PERFORM PRO-ITF-I01 UNTIL NOT FIO-STAT-OKS.

           PERFORM FIN.
       FIN-MAIN.
           EXIT.

       PRO-ITF-I01 SECTION.
       INI-PRO-ITF-01.
      * ELIMINA COLA TDI
           PERFORM DEL-TDI.
      * MOVER DATOS DE INTERFAZ A TDI
           PERFORM PUT-I01-TDI.
      * REALIZA LINK A PGM COLPPMTD
           PERFORM LNK-MTD.
      *
      *LEE SGTE REGISTRO I01
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-I01.
       FIN-PRO-ITF-01.
           EXIT.
      *
       DEL-TDI SECTION.
       INI-DEL-TDI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TDI.
       FIN-DEL-TDI.
           EXIT.

       PUT-I01-TDI SECTION.
       INI-PUT-I01-TDI.
           MOVE 'COL'               TO WSS-SIS1-OPC IN WSS-TDI.
           MOVE 'COLOPCINGGKY'      TO WSS-OPC1-OPC IN WSS-TDI.
           MOVE '001'               TO WSS-FIN1-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOU1-OPC IN WSS-TDI.
           MOVE I01-COD-TOOC IN I01 TO WSS-TOOC-OPC IN WSS-TDI.
           MOVE I01-CAI-IOPC IN I01 TO WSS-CAI1-OPC IN WSS-TDI.
           MOVE I01-IIC-IOPC IN I01 TO WSS-IIC1-OPC IN WSS-TDI.
           MOVE SPACES                     TO WSS-CAIC-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-IICC-OPC IN WSS-TDI.
           MOVE ZEROES             TO WSS-NUMC-OPC IN WSS-TDI.
           MOVE I01-COD-VCOC IN I01 TO WSS-VCAM-OPC IN WSS-TDI.
           MOVE I01-COD-AOOC IN I01 TO WSS-CAUX-OPC IN WSS-TDI.
           MOVE 'COL'              TO WSS-SIS3-OPC IN WSS-TDI.
           MOVE 'COLOPCINGGFL'     TO WSS-OPC3-OPC IN WSS-TDI.
           MOVE '003'              TO WSS-FIN3-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOU3-OPC IN WSS-TDI.
           MOVE I01-COD-OFOC IN I01 TO WSS-OFIC-OPC IN WSS-TDI.
           MOVE I01-NUM-ICLI IN I01 TO WSS-NCLI-OPC IN WSS-TDI.
           MOVE I01-VRF-ICLI IN I01 TO WSS-VCLI-OPC IN WSS-TDI.
           MOVE I01-IND-ICLI IN I01 TO WSS-ICLI-OPC IN WSS-TDI.
           MOVE I01-GLS-ICLI IN I01 TO WSS-GCLI-OPC IN WSS-TDI.
           MOVE ZEROES              TO WSS-NDIR-OPC IN WSS-TDI.
           MOVE I01-VAL-CRED IN I01 TO WSS-MCRE-OPC IN WSS-TDI.
           MOVE I01-FEC-FCOL IN I01 TO WSS-FCUR-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-FCTB-OPC IN WSS-TDI.
           MOVE ZEROES              TO WSS-TASA-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-CGAR-OPC IN WSS-TDI.
           MOVE 'RJUNCO'            TO WSS-EJEC-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-ABON-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-CAIO-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-IICO-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-DEST-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-CAIG-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-IICG-OPC IN WSS-TDI.
           MOVE 'COL'               TO WSS-SIS5-OPC IN WSS-TDI.
           MOVE 'COLOPCLIQGKY'      TO WSS-OPC5-OPC IN WSS-TDI.
           MOVE '005'               TO WSS-FIN5-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOU5-OPC IN WSS-TDI.
           MOVE I01-CAI-IOPC IN I01 TO WSS-CAI5-OPC IN WSS-TDI.
           MOVE I01-IIC-IOPC IN I01 TO WSS-IIC5-OPC IN WSS-TDI.
           MOVE 'COL'               TO WSS-SIS7-OPC IN WSS-TDI.
           MOVE 'COLOPCLIQGCS'      TO WSS-OPC7-OPC IN WSS-TDI.
           MOVE '007'               TO WSS-FIN7-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOU7-OPC IN WSS-TDI.
           MOVE 'COL'               TO WSS-SISA-OPC IN WSS-TDI.
           MOVE 'COLOPCACAGKY'      TO WSS-OPCA-OPC IN WSS-TDI.
           MOVE '005'               TO WSS-FINA-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOUA-OPC IN WSS-TDI.
           MOVE I01-CAI-IOPC IN I01 TO WSS-CAIA-OPC IN WSS-TDI.
           MOVE I01-IIC-IOPC IN I01 TO WSS-IICA-OPC IN WSS-TDI.
           MOVE 'COL'               TO WSS-SISB-OPC IN WSS-TDI.
           MOVE 'COLOPCACAGCS'      TO WSS-OPCB-OPC IN WSS-TDI.
           MOVE '007'               TO WSS-FINB-OPC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOUB-OPC IN WSS-TDI.
      *
           MOVE 'COL'              TO WSS-SIS1-DLC IN WSS-TDI.
           MOVE 'COLDLCINGGKY'      TO WSS-OPC1-DLC IN WSS-TDI.
           MOVE '001'               TO WSS-FIN1-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOU1-DLC IN WSS-TDI.
           MOVE I01-CAI-IOPC IN I01 TO WSS-CAI1-DLC IN WSS-TDI.
           MOVE I01-IIC-IOPC IN I01 TO WSS-IIC1-DLC IN WSS-TDI.
           MOVE 'COL'               TO WSS-SIS3-DLC IN WSS-TDI.
           MOVE 'COLDLCINGGFL'      TO WSS-OPC3-DLC IN WSS-TDI.
           MOVE '003'               TO WSS-FIN3-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOU3-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-NAVL-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-VAVL-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-IAVL-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-GAVL-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-RIES-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-TDOC-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-UFIS-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-TIMP-DLC IN WSS-TDI.
           MOVE ZEROES              TO WSS-VIMP-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-PZAC-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-PZOC-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-IPER-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-SCAR-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-SCTB-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-SCBZ-DLC IN WSS-TDI.
           MOVE SPACES              TO WSS-TOPA-DLC IN WSS-TDI.
      *
           MOVE 'COL'               TO WSS-SIS1-EVC IN WSS-TDI.
           MOVE 'COLEVCINGGKY'      TO WSS-OPC1-EVC IN WSS-TDI.
           MOVE '001'               TO WSS-FIN1-EVC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOU1-EVC IN WSS-TDI.
           MOVE I01-CAI-IOPC IN I01 TO WSS-CAI1-EVC IN WSS-TDI.
           MOVE I01-IIC-IOPC IN I01 TO WSS-IIC1-EVC IN WSS-TDI.
           MOVE ZEROES              TO WSS-NUME-EVC IN WSS-TDI.
           MOVE 'COL'               TO WSS-SIS3-EVC IN WSS-TDI.
           MOVE 'COLEVCINGGFL'      TO WSS-OPC3-EVC IN WSS-TDI.
           MOVE '003'               TO WSS-FIN3-EVC IN WSS-TDI.
           MOVE SPACES              TO WSS-FOU3-EVC IN WSS-TDI.
           MOVE ZEROES              TO WSS-TVTO-EVC IN WSS-TDI.
           MOVE SPACES              TO WSS-IUTV-EVC IN WSS-TDI.
           MOVE SPACES              TO WSS-VCAL-EVC IN WSS-TDI.
           MOVE ZEROES              TO WSS-VVTO-EVC IN WSS-TDI.
           MOVE ZEROES              TO WSS-PSEV-EVC IN WSS-TDI.
           MOVE SPACES              TO WSS-CUTV-EVC IN WSS-TDI.
      *
           MOVE WSS-TDI TO TDI-GLS-DESC.
           MOVE 'XXXX' TO TDI-COD-ULOG IN TDI.
           MOVE 'PTCQ' TO TDI-FIO-TERM.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-TDI.
       FIN-PUT-I01-TDI.
           EXIT.

       LNK-MTD SECTION.
       INI-LNK-MTD.
           MOVE 'COLPPMTD' TO SYS-PROG.
           MOVE +0 TO SYS-TCMA.
           MOVE SPACES TO SYS-CMMA.
           MOVE SYS-LINK TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-LNK-MTD.
           EXIT.

      * ENTIDADES DE COL
       COPY COLBFI01.
      * ENTIDADES DE GNS
       COPY GNSBFIDD.
       COPY GNSBGDTC.
       COPY GNSBGQUE.
       COPY GNSBFTDI.
       COPY GNSBGVSM.
       COPY GNSBHVSM.

       COPY GNSBGEND.
       COPY GNSBFTAB.

       COPY GNSBHSYS.
       COPY GNSBGSYS.
       COPY GNSBIABT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       GNS-GET-IDD SECTION.
       INI-GNS-GET-IDD.
      *La independencia de datos es IDD EN TEMPORARY STORAGE ( VERSION 3
           MOVE 'COLPGTDI'  TO IDD-COD-CIDD IN IDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-IDD.
           IF FIO-STAT-OKS
               MOVE IDD TO IDD-REGI
               GO TO FIN-GNS-GET-IDD.
           MOVE 'DEFAULT' TO IDD-COD-CIDD IN IDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-IDD.
           IF NOT FIO-STAT-OKS
               MOVE 'NO EXISTE REGISTRO IDD CON LLAVE : ' TO SYS-MEN1
               MOVE IDD-COD-CIDD IN IDD                   TO SYS-MEN2
               MOVE SYS-ABOR TO SYS-CMND
               PERFORM GNS-PRO-SYS
           ELSE
               MOVE IDD TO IDD-REGI.
       FIN-GNS-GET-IDD.
           EXIT.

       FIN SECTION.
       INI-FIN.
           EXEC CICS
                 RETURN
           END-EXEC.
       FIN-FIN.
           EXIT.

