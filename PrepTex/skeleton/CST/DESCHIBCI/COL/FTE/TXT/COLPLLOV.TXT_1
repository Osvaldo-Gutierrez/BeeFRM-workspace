*%! Codigo adicional para archivo
*% IF WSS
      *<<<< WSS
       COPY TABBROFI.
       COPY TABBRCAM.
       COPY TABBRTIO.
       COPY COLBRDLC.
       COPY COLBRTOC.
       COPY COLBRICG.
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY COLWGCTO.
       01  WSS-VARI.
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                          PIC 9(02).
              05 WSS-NUM-MPRO                          PIC 9(02).
              05 WSS-NUM-SPRO                          PIC 9(02).
              05 WSS-NUM-APRO                          PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                          PIC 9(02).
              05 WSS-NUM-AFEC                          PIC 9(02).
              05 WSS-NUM-MFEC                          PIC 9(02).
              05 WSS-NUM-DFEC                          PIC 9(02).
           03 WSS-COD-OFOC                             PIC X(03).
           03 WSS-I                                    PIC 9(02).
           03 WSS-COD-COOC.
              05 WSS-IND-COOC      OCCURS 10           PIC X(06).
           03 WSS-COD-PESO                             PIC X(06).
           03 WSS-IND-NEXT                             PIC 9(01). 
           03 WSS-VAL-MNAC         VALUE ZEROES        PIC 9(11).
           03 WSS-GLS-DATA.
              05 WSS-GLS-TIO                           PIC X(40).
              05 WSS-GLS-AUX                           PIC X(40).
      *DPM ini  23-SEP-1997
           03 AUX-CIC-IOPC         VALUE SPACES        PIC X(12).
           03 WSS-FEC-FCOL.
              05 WSS-NUM-SCOL                          PIC 9(02).
              05 WSS-NUM-ACOL                          PIC 9(02).
              05 WSS-NUM-MCOL                          PIC 9(02).
              05 WSS-NUM-DCOL                          PIC 9(02).
           03 WSS-IND-DISP            VALUE SPACES     PIC X(01).
           03 WSS-NUM-RLEI            VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-RSEL            VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-RNSE            VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-RRCH            VALUE ZEROES     PIC 9(06).
      *DPM fin  23-SEP-1997
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
*% IF CF_LOV_OPC_COD_OFOC
      *<<<< CF_LOV_OPC_COD_OFOC
           MOVE ZEROES TO RPT-LOV-PAGE-COUNTER.
      *>>>>
*% END
*% IF PH_LOV
      *<<<< PH_LOV
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-LOV
           ELSE
               MOVE SPACES TO WSS-GLS-OFIC IN WSS-LOV.

      * Mediante BUS-TAB Busca Tipo de Operacion Credito de Tabla TIO
           IF OPC-COD-TOOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TIO IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TIO IN WSS-VARI.

      * Mediante BUS-TAB Busca Clase de Operacion Credito de Tabla AUX
           IF OPC-COD-COOC IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-COOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AUX IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-AUX IN WSS-VARI.

      * Se concatenan las glosas de TIO y de AUX
           MOVE WSS-GLS-DATA IN WSS-VARI TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO WSS-GLS-DATA IN WSS-LOV.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCOC IN WSS-LOV
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-LOV.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      * Captura Codigo de Oficina
           DISPLAY 'OFICINA (*=TODAS) : '.
           ACCEPT  WSS-COD-OFOC IN WSS-VARI.
           DISPLAY WSS-COD-OFOC IN WSS-VARI.
      * Captura Codigo Clase Operacion
           DISPLAY 'CLASE OPERACION (*=TODAS) : '.
           MOVE SPACES TO WSS-COD-COOC IN WSS-VARI.
           ACCEPT  WSS-COD-COOC IN WSS-VARI.
           DISPLAY WSS-COD-COOC IN WSS-VARI.
      *Captura Indicdor de Display
           DISPLAY 'INDICADOR DE DISPLAY (S/N) : '.
           ACCEPT WSS-IND-DISP IN WSS-VARI.
           DISPLAY WSS-IND-DISP IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Proceso
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
           MOVE WSS-FEC-FPRO    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.
 
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN WSS-LOV
                                            WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN WSS-LOV
                                            WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN WSS-LOV
                                            WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN WSS-LOV
                                            WSS-NUM-AFEC IN WSS-VARI.

      *VAL-OFI Valida codigo de Oficina en TABLAS
           IF WSS-COD-OFOC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-OFOC IN WSS-VARI.
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*'
               DISPLAY WSS-COD-OFOC IN WSS-VARI
               MOVE WSS-COD-OFOC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-END.

      *VAL-TAB Valida Clase de Operacion en TABLAS
           IF WSS-COD-COOC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-COOC IN WSS-VARI.
           IF WSS-COD-COOC IN WSS-VARI NOT = '*'
               MOVE 1 TO WSS-I IN WSS-VARI
               PERFORM VAL-PAR-COOC UNTIL WSS-I IN WSS-VARI > 10
               DISPLAY WSS-COD-COOC IN WSS-VARI
               IF WSS-COD-COOC IN WSS-VARI NOT > SPACES
                   DISPLAY 'NO EXISTE NINGUNA CLASE INGRESADA VALIDA'
                   PERFORM GNS-PRO-END.

      *Valida Indicador de Display
           IF WSS-IND-DISP IN WSS-VARI NOT = 'S' AND
              WSS-IND-DISP IN WSS-VARI NOT = 'N'
               DISPLAY 'ASUME INDICADOR DE DISPLAY = N'
               MOVE SPACES TO WSS-IND-DISP IN WSS-VARI.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * Obtiene Codigo Valor de Cambio Mediante CIC de Moneda Nacional
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
               PERFORM GNS-PRO-END.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           MOVE ZEROES         TO OPC-FEC-FCOL IN OPC.
           MOVE 'OPC-FEC-FCOL' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FCOL IN OPC > WSS-FEC-FFEC IN WSS-VARI
               DISPLAY 'NO HAY REGISTRO HASTA FECHA DE PROCESO : '
                       WSS-FEC-FPRO IN WSS-VARI
               GO TO FIN-INP-SRT.
           GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * DPM ini  29-SEP-1997 
           ADD 1 TO WSS-NUM-RLEI IN WSS-VARI.
      * DPM fin  29-SEP-1997 

           MOVE ADR-OPC-REQA TO AUX-OPC-REQA.

      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
      * DPM ini  29-SEP-1997 
               ADD 1 TO WSS-NUM-RNSE IN WSS-VARI
      * DPM fin  29-SEP-1997 
               GO TO NXT-INP-SRT.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'OPC LEIDA: ' OPC-CIC-IOPC IN OPC.

      * DPM ini  29-SEP-1997 
           ADD 1 TO WSS-NUM-RSEL IN WSS-VARI.
      * DPM fin  29-SEP-1997 

      * DPM ini  23-SEP-1997 
           PERFORM LEE-DLC.
           IF NOT FIO-STAT-OKS
      * DPM ini  29-SEP-1997 
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
      * DPM fin  29-SEP-1997 
               GO TO NXT-INP-SRT.

      *Obtiene valor de cambio con Fecha de Colocacion de OPC original
           IF OPC-IND-RENO IN OPC = 'PRO' AND
              OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI AND
              OPC-MSC-TVOC IN OPC = 0
      * Guarda el CIC de la OPC de la prorroga
               MOVE OPC-CIC-IOPC IN OPC TO AUX-CIC-IOPC IN WSS-VARI
      * Lee OPC original para rescatar la fecha de origen
               MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
                 IF WSS-IND-DISP IN WSS-VARI = 'S'
                   DISPLAY 'PRORROGA: ' OPC-CIC-IOPC IN OPC
      * Mueve fecha de OPC original para la conversion a valor origen
                   MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FCOL IN WSS-VARI
      * Vuelve a leer la OPC de la prorroga
                   MOVE AUX-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                 ELSE
      * Mueve fecha de OPC original para la conversion a valor origen
                   MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FCOL IN WSS-VARI
      * Vuelve a leer la OPC de la prorroga
                   MOVE AUX-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
               ELSE
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPCORIGNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY 'OPC ORIGINAL: '
                                  MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
                   DISPLAY 'OPC PRORROGA: ' AUX-CIC-IOPC IN WSS-VARI
      * DPM ini  29-SEP-1997 
                   ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
      * DPM fin  29-SEP-1997 
                   GO TO NXT-INP-SRT
           ELSE
               MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FCOL IN WSS-VARI.
      * DPM fin  23-SEP-1997 

      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada
           IF TOC-MSC-OPEC IN TOC NOT = 'D'
               PERFORM GET-ICG-OPC
           ELSE
               PERFORM GET-ICG-DLC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'REGISTRO OPC NO TIENE INTERESES ' 
                                     OPC-KEY-IOPC IN OPC
      * DPM ini  29-SEP-1997 
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
      * DPM fin  29-SEP-1997 
               GO TO NXT-INP-SRT.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO SRT-SGV-TINT IN SRT
           ELSE
               MOVE ICG-SGV-TINT IN ICG TO SRT-SGV-TINT IN SRT.

      *DPM ini  5-SEP-1997 Se cambio aca esta seccion de la OUT-SRT para
      * agregar Nombre de Cliente en SORT
           PERFORM GEN-LIN-OUT.
           IF WSS-IND-NEXT IN WSS-VARI = 1
      * DPM ini  29-SEP-1997 
               ADD 1 TO WSS-NUM-RRCH IN WSS-VARI
      * DPM fin  29-SEP-1997 
               GO TO NXT-INP-SRT.

           IF WSS-IND-DISP IN WSS-VARI = 'S'
               DISPLAY 'REGISTRO GRABADO'.
      *DPM fin  5-SEP-1997
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           MOVE 'OPC-FEC-FCOL' TO FIO-AKEY.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE AUX-OPC-REQA TO ADR-OPC-REQA.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FCOL IN OPC > WSS-FEC-FFEC IN WSS-VARI
               GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      * DPM ini  5-SEP-1997 Se cambio a INP-SRT para agregar en SORT el
      * ordenamiento por Nombre de Cliente
      *     PERFORM GEN-LIN-OUT.
      *     IF WSS-IND-NEXT IN WSS-VARI = 1
      *         GO TO NXT-OUT-SRT.
      * DPM fin  5-SEP-1997

      * DPM ini  5-SEP-1997 Se coloco aqui esta seccion por separado
      * Mediante BUS-TAB Busca Tipo de Tasa de Interes de Tabla INT
           IF ICG-COD-TINT IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'INT'               TO TAB-COD-TTAB IN TAB
               MOVE ICG-COD-TINT IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TINT IN WSS-LOV
           ELSE
               MOVE SPACES TO WSS-GLS-TINT IN WSS-LOV.

           IF DBC-GLS-ICLI IN SRT > SPACES
               MOVE '-'    TO WSS-GLS-AUXI IN WSS-LOV
           ELSE
               MOVE SPACES TO WSS-GLS-AUXI IN WSS-LOV.
      *DPM fin  5-SEP-1997
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
      *>>>>
*% END
*% IF FIN_OUT
      *<<<< FIN_OUT
           DISPLAY 'ESTADISTICAS'.
           DISPLAY '------------'.
           DISPLAY ' '.
           DISPLAY 'REGISTROS OPC LEIDOS           : '
                                  WSS-NUM-RLEI IN WSS-VARI.
           DISPLAY 'REGISTROS OPC SELECCIONADOS    : '
                                  WSS-NUM-RSEL IN WSS-VARI.
           DISPLAY 'REGISTROS OPC NO SELECCIONADOS : '
                                  WSS-NUM-RNSE IN WSS-VARI.
           DISPLAY 'REGISTROS RECHAZADOS           : '
                                  WSS-NUM-RRCH IN WSS-VARI.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      **************************************************************************
      * Valida que la Clase del parametro Exista
       VAL-PAR-COOC SECTION.
       INI-VAL-PAR-COOC.
           IF WSS-IND-COOC IN WSS-VARI(WSS-I) > SPACES
               MOVE 'COL'           TO TAB-COD-SIST
               MOVE 'AUX'           TO TAB-COD-TTAB IN TAB
               MOVE WSS-IND-COOC IN WSS-VARI(WSS-I)
                                    TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS IN MSG > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                           ' CLASE : ' WSS-IND-COOC IN WSS-VARI(WSS-I)
                   MOVE SPACES TO WSS-IND-COOC IN WSS-VARI(WSS-I).
           ADD 1 TO WSS-I IN WSS-VARI.
       FIN-VAL-PAR-COOC.
           EXIT.

      **************************************************************************
      * Seleccion del Registro para Proceso Mediante Fecha y Oficina del Listado
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF OPC-MSC-STAT IN OPC NOT = 'A'
               GO TO FIN-SEL-REG-PRO.

           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO FIN-SEL-REG-PRO.

           IF WSS-COD-OFOC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFOC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO FIN-SEL-REG-PRO.

      * Valida que pertenezca a Clase del parametro
           IF WSS-COD-COOC IN WSS-VARI NOT = '*'
               MOVE 1 TO WSS-I IN WSS-VARI
               PERFORM VAL-SEL-COOC UNTIL WSS-I IN WSS-VARI > 10 OR
                                   WSS-IND-COOC IN WSS-VARI(WSS-I) =
                                                OPC-COD-COOC IN OPC
               IF WSS-I IN WSS-VARI > 10
                   GO TO FIN-SEL-REG-PRO.

      * Busca con el Codigo Tipo Operacion en la Tabla cargada en Memoria el
      * 'Sistema que lo Maneja' y 'Opera Como'
           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
                       'CON CODIGO : '     CTO-TOOC IN CTO-VARI
                       ' OPC: ' OPC-CIC-IOPC IN OPC
               GO TO FIN-SEL-REG-PRO.

      * Valida el 'Sistema que lo Maneja' de la Operacion de Credito
           IF CTO-SIST IN CTO-VARI NOT = 'COL'
               GO TO FIN-SEL-REG-PRO.

      * Obtiene 'Opera Como'
           MOVE SPACES               TO TOC.
           MOVE CTO-OPEC IN CTO-VARI TO TOC-MSC-OPEC IN TOC.

           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      **************************************************************************
      * Valida que pertenezca a Clase del parametro
       VAL-SEL-COOC SECTION.
       INI-VAL-SEL-COOC.
           ADD 1 TO WSS-I IN WSS-VARI.
       FIN-VAL-SEL-COOC.
           EXIT.
      **************************************************************************
      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada por OPC
       GET-ICG-OPC SECTION.
       INI-GET-ICG-OPC.
           MOVE ZEROES TO ICG-NUM-ICAN IN ICG.
           PERFORM GET-KEY-IICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-ICG-OPC.
           EXIT.
      **************************************************************************
      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada por DLC
       GET-ICG-DLC SECTION.
       INI-GET-ICG-DLC.
      * DPM ini  23-SEP-1997 Se lee DLC en programa para leer OPC original
      * en caso de prorroga 
      * Busca Documentos de Credito para Operacion Determinada
      *     MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
      *     MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
      *     MOVE FIO-GET-NLS  TO FIO-CMND.
      *     PERFORM COL-FIO-DLC.
      *     IF NOT FIO-STAT-OKS OR
      *        DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'OPC    DLCNX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         DISPLAY MSG-GLS-DESC   OPC-KEY-IOPC IN OPC
      *         MOVE '23' TO FIO-STAT
      *         GO TO FIN-GET-ICG-DLC.
      * DPM fin  23-SEP-1997

           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           PERFORM GET-KEY-IICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               PERFORM GET-ICG-OPC.
       FIN-GET-ICG-DLC.
           EXIT.
      **************************************************************************
       GET-KEY-IICG SECTION.
       INI-GET-KEY-IICG.
      * Forma Llave KEY-IICG y Lee ICG para Obtener Tasa de Interes
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS  TO FIO-CMND.
           PERFORM COL-FIO-ICG.
       FIN-GET-KEY-IICG.
           EXIT.

      **************************************************************************
      * Genera Lineas de Detalle a Partir de Registro SRT Ordenado
       GEN-LIN-OUT SECTION.
       INI-GEN-LIN-OUT.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.

      * Expresa en Pesos Saldo del Credito segun Valor de Cambio de Moneda a
      * la Fecha de Curse Contable
      *DPM ini  5-SEP-1997
      *     IF OPC-COD-VCOC IN SRT NOT = WSS-COD-PESO IN WSS-VARI
      *         MOVE OPC-FEC-FING IN       TO CAM-FEC-FCAM IN CAM(1)
      *         MOVE OPC-FEC-FING IN SRT      TO CAM-FEC-FCAM IN CAM(2)
      *         MOVE OPC-COD-VCOC IN SRT      TO CAM-COD-VCAM IN CAM(1)
      *DPM ini  23-SEP-1997
      *     IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
      *         MOVE OPC-FEC-FING IN OPC      TO CAM-FEC-FCAM IN CAM(1)
      *         MOVE OPC-FEC-FING IN OPC      TO CAM-FEC-FCAM IN CAM(2)
      *         MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
           IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI AND
              OPC-MSC-TVOC IN OPC = 0
               MOVE WSS-FEC-FCOL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
               MOVE WSS-FEC-FCOL IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
      *DPM fin  23-SEP-1997
      *DPM fin  5-SEP-1997
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
      *DPM ini  5-SEP-1997
      *             DISPLAY 'NO EXISTE VALOR DE CAMBIO PARA MONEDA : '
      *                      OPC-COD-VCOC IN SRT ' AL '
      *                      OPC-FEC-FING IN SRT ' DE OPERACION '
      *                      OPC-CAI-IOPC IN SRT OPC-IIC-IOPC IN SRT
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO PARA MONEDA : '
                            OPC-COD-VCOC IN OPC ' AL '
      *                      OPC-FEC-FING IN OPC ' DE OPERACION '
                            WSS-FEC-FCOL IN WSS-VARI ' DE OPERACION '
                            OPC-CAI-IOPC IN OPC OPC-IIC-IOPC IN OPC
      *DPM fin  5-SEP-1997
                   MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
                   GO TO FIN-GEN-LIN-OUT
               ELSE
                   IF CAM-IND-VIGE NOT = 'S'
                       DISPLAY 'IND. VIGENCIA NO VALIDO PARA MONEDA : '
      *DPM ini  5-SEP-1997
      *                          OPC-COD-VCOC IN SRT ' AL '
      *                          OPC-FEC-FING IN SRT ' DE OPERACION '
      *                          OPC-CAI-IOPC IN SRT OPC-IIC-IOPC IN SRT
                                OPC-COD-VCOC IN OPC ' AL '
      *                          OPC-FEC-FING IN OPC ' DE OPERACION '
                              WSS-FEC-FCOL IN WSS-VARI ' DE OPERACION '
                                OPC-CAI-IOPC IN OPC OPC-IIC-IOPC IN SRT
      *DPM fin  5-SEP-1997
                       MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
                       GO TO FIN-GEN-LIN-OUT
                   ELSE
      *DPM ini  5-SEP-1997
      *               MULTIPLY OPC-VAL-SCRE IN SRT BY CAM-SGV-VCAM IN CAM
                     MULTIPLY OPC-VAL-SCRE IN OPC BY CAM-SGV-VCAM IN CAM
      *DPM fin  5-SEP-1997
                                 GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
                   MOVE WSS-VAL-MNAC IN WSS-VARI TO OPC-VAL-SCRE IN OPC.

      * DPM ini  5-SEP-1997 Se coloco esta seccion sola en LUP OUT
      * Mediante BUS-TAB Busca Tipo de Tasa de Interes de Tabla INT
      *     IF ICG-COD-TINT IN SRT > SPACES
      *         MOVE 'COL'               TO TAB-COD-SIST
      *         MOVE 'INT'               TO TAB-COD-TTAB IN TAB
      *         MOVE ICG-COD-TINT IN SRT TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TINT IN WSS-LOV
      *     ELSE
      *         MOVE SPACES TO WSS-GLS-TINT IN WSS-LOV.
      * DPM fin  5-SEP-1997

           PERFORM BUS-REG-CLI.
       FIN-GEN-LIN-OUT.
           EXIT.
      **************************************************************************
      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro RDC
       BUS-REG-CLI SECTION.
       INI-BUS-REG-CLI.
      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en RDC
      * RDC-NUM-IDLC = 0 ====> DEU.DIR.
           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RDC-KEY-IDLC IN RDC
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               GO TO FIN-BUS-REG-CLI.

      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-NUM-ICLI IN DBC
                              DBC-VRF-ICLI IN DBC
                              DBC-IND-ICLI IN DBC
                              WSS-GLS-AUXI IN WSS-LOV
                              DBC-GLS-ICLI IN DBC
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.

           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS OR
              RDC-CAI-IOPC IN RDC NOT = OPC-CAI-IOPC IN OPC OR
              RDC-IIC-IOPC IN RDC NOT = OPC-IIC-IOPC IN OPC OR
              RDC-NUM-IDLC IN RDC NOT = ZEROES
               MOVE SPACES TO WSS-IND-MULD IN SRT
           ELSE
               MOVE 'M'    TO WSS-IND-MULD IN SRT.
       FIN-BUS-REG-CLI.
           EXIT.
      **************************************************************************
       LEE-DLC SECTION.
       INI-LEE-DLC.
      * Busca Documentos de Credito para Operacion Determinada
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS  TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS OR
              DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   OPC-KEY-IOPC IN OPC
               MOVE '23' TO FIO-STAT.
       FIN-LEE-DLC.
           EXIT.

       COPY TABBFOFI.
       COPY TABBFCAM.
       COPY COLBFDLC.
       COPY COLBFTOC.
       COPY COLBFICG.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY SGCBGCLI.
       COPY COLBGCTO.
      *>>>>
*% END
