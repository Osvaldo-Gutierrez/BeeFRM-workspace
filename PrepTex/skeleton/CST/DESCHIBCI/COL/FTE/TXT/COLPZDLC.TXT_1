*%! Codigo adicional para programa
*% IF PGM_CHI AND PGM_BCI
*%     PGM_PTC = TRUE
*% END
*% IF PGM_CHI AND PGM_BCI
*%     PRV_BCI = TRUE
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
      *ISP DEBE QUEDAR PRIMERO QUE EL OTRO LABEL FIN_SCR_VARI
       COPY COLWGENG.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.
      *DAD ini 22-MAR-1991 
           03  WSS-VAL-PESO                            PIC 9(11).
      *DAD fin 22-MAR-1991 
*% IF PGM_PER
           03  WSS-VAL-FINA                    COMP-3  PIC 9(11)V9(04).
           03  WSS-VAL-CAPI                    COMP-3  PIC 9(11)V9(04).
*% END
           03  WSS-COD-PLAZ                            PIC X(04).
*% IF PGM_PTC
      *PTC ini
           03  WSS-COD-AUXI                            PIC X(24).
      *PTC fin
*% END
      *ALD
           03  WSS-PTA-STR.
               05  WSS-PRGM                            PIC X(03).
               05  FILLER                VALUE '/'     PIC X(01).
               05  WSS-RIES                            PIC X(04).
               05  FILLER                VALUE '/'     PIC X(01).
               05  WSS-TOOC                            PIC X(03).
           03  PGM-STAT-POC             VALUE '23'     PIC X(02).              
                 88 PGM-STAT-POC-OKS    VALUE '00'.                             
                 88 PGM-STAT-POC-NUL    VALUE '  '.                             
           03  BUS-POR-KEYS             VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE             VALUE 'C'    PIC X(01).
           03  WSS-ICOR                 VALUE 0      PIC 9(01).
               88 NO-ASIGNE-CORRELATIVO VALUE 0.
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-CIC-IOPC                       PIC X(12).
           03  WSS-UBFD.
               05  WSS-TAB-UBFD                   PIC X(03).
               05  WSS-COD-UBFD                   PIC X(12).
           03  WSS-FRDC              VALUE 0      PIC 9(01).
               88  WSS-HAY-RDC-FRM   VALUE 1.
           03  WSS-RRDC              VALUE 0      PIC 9(01).
               88  WSS-HAY-RDC-REG   VALUE 1.
           03  WSS-SRDC              VALUE 0      PIC 9(01).
               88  WSS-MISMO-RDC     VALUE 0.
               88  WSS-OTRO-RDC      VALUE 1.
           03  WSS-HAY               VALUE 1      PIC 9(01).
           03  WSS-OTRO              VALUE 1      PIC 9(01).
           03  PGM-STAT-NTR          VALUE '23'   PIC X(02).
               88 PGM-STAT-NTR-OKS   VALUE '00'.
               88 PGM-STAT-NTR-NUL   VALUE '  '.
           03  WSS-NUM-ICAN                       PIC 9(03).
           03  WSS-COD-PLZA.
               05 WSS-IND-OFIC                    PIC X(01).
               05 WSS-COD-OFIC                    PIC X(03).
*% IF PGM_PER
           03  WSS-FEC-FGIR.
               05 WSS-NUM-SGIR                    PIC 9(02).
               05 WSS-NUM-AGIR                    PIC 9(02).
               05 WSS-NUM-MGIR                    PIC 9(02).
               05 WSS-NUM-DGIR                    PIC 9(02).
           03  WSS-FEC-FMAV.
               05 WSS-NUM-SMAV                    PIC 9(02).
               05 WSS-NUM-AMAV                    PIC 9(02).
               05 WSS-NUM-MMAV                    PIC 9(02).
               05 WSS-NUM-DMAV                    PIC 9(02).
           03  WSS-FEC-FAUX.
               05 WSS-NUM-DAUX                    PIC 9(02).
               05 WSS-NUM-MAUX                    PIC 9(02).
               05 WSS-NUM-SAUX                    PIC 9(02).
               05 WSS-NUM-AAUX                    PIC 9(02).
*% END
       01  DLC-BKP                                PIC X(218).
       COPY SGCBRDBC.
       COPY COLBROPC.
       COPY COLBRROV.
       COPY COLBRCAN.
       COPY COLBRNTR.
       COPY COLBRRDC.
       COPY COLBRICG.
       COPY COLBRVEN.
       COPY SGCBRRCD.
       COPY TABBRTIO.
       COPY TABBRCAM.

       COPY COLWGSTO.

*% IF PGM_PTC
      *PTC ini
       COPY GNSWGQUE.
      *PTC fin
*% END
       COPY GNSWGCPT.
       COPY GNSWGCVI.
       COPY GNSWGINT.
       COPY GNSWGPES.
       COPY GNSWGSTR.
       COPY COLBRTOC.
      *ALD
       COPY COLBRPOC.
       COPY COLBRDCC.
*% IF PRV_BCI
           COPY USPC113.
*% END
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-NTR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
      *>>>>
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA3==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MICG                         PIC X(01).
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF PFS_SCR_GFLD
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF6 OR
                            FRM-FFLD = FRM-FFLD-PF5 ) )
      *>>>>
*% END
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-DLC
               PERFORM VAL-NUM-FLD-DLC.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE                                                             
                   MOVE SPACES TO SCR-RQA1                                      
                   MOVE SPACES TO SCR-RQA2                                      
                   MOVE SPACES TO SCR-RQA3                                      
                   PERFORM DESSCRTRL                                            
                   GO TO FIN-SCR-MOD.                                           
           MOVE SPACES TO SCR-RQA1.                                             
           MOVE SPACES TO SCR-RQA2.
           MOVE SPACES TO SCR-RQA3.
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-DLC
               PERFORM VAL-NUM-FLD-DLC
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE                                                             
                   MOVE SPACES TO SCR-RQA1                                      
                   MOVE SPACES TO SCR-RQA2
                   MOVE SPACES TO SCR-RQA3
                   PERFORM DESSCRTRL                                            
                   GO TO FIN-SCR-ELI.                                           
           MOVE SPACES TO SCR-RQA1.                                             
           MOVE SPACES TO SCR-RQA2.
           MOVE SPACES TO SCR-RQA3.
      *>>>>
*% END
*% IF PFS_SCR_ACT
      *<<<< PFS_SCR_ACT
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-DLC
               PERFORM VAL-NUM-FLD-DLC.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE                                                             
                   MOVE SPACES TO SCR-RQA1                                      
                   MOVE SPACES TO SCR-RQA2
                   MOVE SPACES TO SCR-RQA3
                   PERFORM DESSCRTRL                                            
                   GO TO FIN-SCR-ACT.                                           
           MOVE SPACES TO SCR-RQA1.                                             
           MOVE SPACES TO SCR-RQA2.
           MOVE SPACES TO SCR-RQA3.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-DLC
               PERFORM VAL-NUM-FLD-DLC
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE                                                             
                   MOVE SPACES TO SCR-RQA1                                      
                   MOVE SPACES TO SCR-RQA2
                   MOVE SPACES TO SCR-RQA3
                   PERFORM DESSCRTRL                                            
                   GO TO FIN-SCR-ACC.                                           
           MOVE SPACES TO SCR-RQA1.                                             
           MOVE SPACES TO SCR-RQA2.
           MOVE SPACES TO SCR-RQA3.
      *>>>>
*% END
*% IF INI_HBL_FLD
      *<<<< INI_HBL_FLD
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NEX  ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE SCR-STAT-CON   TO SCR-STAT
               GO TO FIN-HBL-FLD.
           MOVE OPC-IND-VSTR IN OPC TO FRM-IND-VSTR IN DLC-FLD.
           MOVE DLC-COD-TDOC IN DLC-FLD TO FRM-CIC-TDOC IN DLC-FLD
           IF ( SCR-CCPP = 'ING' ) OR
              ( SCR-CCPP = 'ACT' AND ( NOT PGM-STAT-DLC-OKS ) )
               PERFORM BUS-POC
               IF FIO-STAT-OKS
                   MOVE POC-COD-TDOC IN POC TO FRM-CIC-TDOC IN DLC-FLD
               ELSE
                   GO TO FIN-HBL-FLD.
           PERFORM BUS-CIC-TDOC
           IF NOT FIO-STAT-OKS
               GO TO FIN-HBL-FLD.
           PERFORM BUS-CIC-OPEC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-HBL-FLD.
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF DBC-IND-ICLI IN DLC-FLD = 'M' AND
              SCR-IND-MRDC = 'M'
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD.
*% IF PGM_PER
           MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD.
*% ELSE
           IF FRM-GLS-TINT IN DLC-FLD = 'M' AND
              SCR-IND-MICG NOT = SPACES
               MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD.
           IF FRM-CIC-OPEC IN DLC-FLD NOT = 'D'
               MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD.
*% END
      *ISP PROTEGE CAMPOS EN FORMA PARAMETRICA.
           MOVE SPACES TO TAB-IND-VIGE IN TAB.
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    PCDLC' TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
                  TAB-IND-VIGE IN TAB = 'N'
      *DAD ini  08-JAN-1993   (Memo.16-10-92)
               MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD
      *DAD fin  08-JAN-1993
      *ISP  28-MAR-1991 DESPROTEGE CAMPO SOL. BCI DEL 27/03/1991
      *         MOVE FRM-CPIM-AEY TO DLC-COD-NOTC-ATR IN DLC-FLD
      *         MOVE FRM-CPIM-AEY TO DLC-VAL-GNOT-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-COD-UBFD-ATR IN DLC-FLD.
      *ALD
           IF SCR-CMND NOT = 'MCA'
               GO TO CON-HBL-MCA.
           PERFORM PRO-FLD-DLC.
           PERFORM PRO-MKY-DLC.
           MOVE FRM-CPIM-UBY TO DLC-IND-RIES-ATR IN DLC-FLD.
           MOVE FRM-CPIM-UBY TO RDC-NUM-DIRE-ATR IN DLC-FLD.
*% IF PRV_BCI
           MOVE OPC-COD-TOOC IN OPC TO TIO-COD-TIOP IN TIO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-TIO.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO TIO-GLS-SIST IN TIO.
           MOVE 'DLC'               TO WSS-PRGM IN WSS-VARI.
           MOVE 'RIES'              TO WSS-RIES IN WSS-VARI.
           MOVE TIO-GLS-SIST IN TIO TO WSS-TOOC IN WSS-VARI.
           MOVE WSS-PTA-STR IN WSS-VARI TO USP-PTA-STR.
           COPY USPC103.
           IF USP-PERMISO NOT = 'P'
               MOVE FRM-CPIM-AEY TO DLC-IND-RIES-ATR IN DLC-FLD
               IF DBC-IND-ICLI IN DLC-FLD = 'M' AND
                  SCR-IND-MRDC = 'M'
                   MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD
                   MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
                   MOVE -1           TO DLC-IND-RIES-LEN IN DLC-FLD
               ELSE
                   MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
                   MOVE -1           TO RDC-NUM-DIRE-LEN IN DLC-FLD
           ELSE
               IF DBC-IND-ICLI IN DLC-FLD = 'M' AND
                  SCR-IND-MRDC = 'M'
                   MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD
                   MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
                   MOVE -1           TO DLC-IND-RIES-LEN IN DLC-FLD
               ELSE
                   MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
                   MOVE -1           TO RDC-NUM-DIRE-LEN IN DLC-FLD.
*% END
       CON-HBL-MCA.
           IF ( SCR-CCPP = 'ING' ) OR
              ( SCR-CCPP = 'ACT' AND ( NOT PGM-STAT-DLC-OKS ) )
               NEXT SENTENCE
           ELSE
               GO TO FIN-HBL-FLD.
           PERFORM PRO-DLC-ROV.
           IF POC-COD-TDOC IN POC > SPACES
               MOVE POC-COD-TDOC IN POC TO DLC-COD-TDOC IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-COD-TDOC-ATR IN DLC-FLD.
           IF POC-MSC-MIPL IN POC > SPACES
               MOVE POC-MSC-MIPL IN POC TO DLC-MSC-MIPL IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-MSC-MIPL-ATR IN DLC-FLD.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
               PERFORM BUS-COR-DLC
               GO TO CON-FND-KEY.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   IF SCR-RQA3 > SPACES
                       PERFORM SCR-CLRA-DLC
                       MOVE DLC-CAI-IOPC IN DLC TO DLC-CAI-IOPC IN
                                                           DLC-FLD
                       MOVE DLC-IIC-IOPC IN DLC TO DLC-IIC-IOPC IN
                                                           DLC-FLD
                       MOVE DLC-NUM-IDLC IN DLC TO DLC-NUM-IDLC IN
                                                           DLC-FLD
                       GO TO CON-FND-KEY
                   ELSE
                   IF MSG-COD-MENS = 'RDCSI'
                       PERFORM SCR-CLRA-DLC
                       PERFORM PUT-DBC
                       MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM COL-FIO-OPC
                       IF NOT FIO-STAT-OKS
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'RDC    NOOPC' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY
                       ELSE
                           PERFORM BUS-POC
                           MOVE '00'  TO PGM-STAT-OPC
                           MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                           MOVE RDC-CIC-IOPC IN RDC TO DLC-CIC-IOPC
                                                             IN DLC
                           MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC
                                                             IN DLC
                           MOVE RDC-CAI-IOPC IN RDC TO DLC-CAI-IOPC
                                                         IN DLC-FLD
                           MOVE RDC-IIC-IOPC IN RDC TO DLC-IIC-IOPC
                                                         IN DLC-FLD
                           MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC
                                                         IN DLC-FLD
                           GO TO CON-FND-KEY
                   ELSE
                       PERFORM SCR-CLRA-DLC
                       PERFORM PUT-DBC
                       PERFORM BUS-DEU-IND
                       IF NOT FIO-STAT-OKS
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'CLI    NOIND' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MEN2
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC
                                                             IN OPC
                           MOVE FIO-GET-KEY TO FIO-CMND
                           PERFORM COL-FIO-OPC
                           IF NOT FIO-STAT-OKS
                               MOVE 'COL' TO MSG-COD-SIST
                               MOVE 'RDC    NOOPC' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               PERFORM BUS-POC
                               MOVE '00' TO PGM-STAT-OPC
                               MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                               MOVE RDC-CIC-IOPC IN RDC TO
                                             DLC-CIC-IOPC IN DLC
                               MOVE RDC-NUM-IDLC IN RDC TO
                                             DLC-NUM-IDLC IN DLC
                               MOVE RDC-CAI-IOPC IN RDC TO
                                          DLC-CAI-IOPC IN DLC-FLD
                               MOVE RDC-IIC-IOPC IN RDC TO
                                          DLC-IIC-IOPC IN DLC-FLD
                               MOVE RDC-NUM-IDLC IN RDC TO
                                          DLC-NUM-IDLC IN DLC-FLD
                               GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF SCR-RQA3 NOT > SPACES   
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'SGC' TO MSG-COD-SIST
                           MOVE 'DBC    NOPRV' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'SGC' TO MSG-COD-SIST
                           MOVE 'DBC    NONXT' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY
                   ELSE
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'SGC' TO MSG-COD-SIST
                           MOVE 'DLC    NOPRV' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'SGC' TO MSG-COD-SIST
                           MOVE 'DLC    NONXT' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY
           ELSE
           IF DLC-IIC-IOPC IN DLC-FLD > ZEROES
               IF DLC-NUM-IDLC IN DLC-FLD NOT > ZEROES
                   PERFORM BUS-COR-DLC
                   GO TO CON-FND-KEY
               ELSE
                   GO TO CON-FND-KEY.
           IF DBC-NUM-ICLI IN DLC-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN DLC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN DLC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN DLC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM ANL-KEY-DLC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   NEXT SENTENCE
           ELSE
           IF DBC-GLS-NOMC IN DLC-FLD > SPACES

               MOVE DBC-GLS-NOMC IN DLC-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS     TO FIO-CMND
               PERFORM ANL-KEY-DLC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY.

           IF DLC-NUM-IDLC IN DLC NOT > ZEROES
               PERFORM BUS-COR-DLC.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF SCR-CCPP = 'ACT' AND NO-ASIGNE-CORRELATIVO AND
              NOT FIO-STAT-OKS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.
           IF NOT BUS-POR-KEYS = BUS-POR-CLTE
               MOVE SPACES TO SCR-RQA1
               MOVE SPACES TO SCR-RQA2
               IF FIO-STAT-OKS 
                   MOVE ADR-DLC-REQA TO SCR-RQA3
                   GO TO KEY-BUS-OPC
               ELSE
                   GO TO KEY-BUS-OPC.
           MOVE SPACES TO SCR-RQA3.
           PERFORM GET-CUR-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RDC    INCKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM PUT-OPC-DLC.
           GO TO KEY-BUS-ICG.
       KEY-BUS-OPC.

      *ISP BUSQUEDA POR OPC
           PERFORM GET-CUR-OPC.
           IF FIO-STAT-OKS
               PERFORM PUT-OPC-DLC
               PERFORM BUS-POC
           ELSE
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'DLC    NOOPC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           IF SCR-CCPP = 'ING'
               GO TO KEY-BUS-ICG.

       KEY-BUS-RDC.
           PERFORM GET-CUR-RDC.
           IF NOT FIO-STAT-OKS
               GO TO KEY-BUS-ICG
           ELSE
               PERFORM PUT-RDC-DLC.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE 'M'          TO DBC-IND-ICLI IN DLC-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               GO TO KEY-BUS-ICG.

       KEY-BUS-DBC.
           IF RDC-CAI-ICLI IN RDC NOT > SPACES AND
              RDC-IIC-ICLI IN RDC NOT > ZEROES
               GO TO KEY-BUS-ICG.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-DBC
               PERFORM PUT-DBC-DLC
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN DLC-FLD
           ELSE
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'RDC    NOCLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

       KEY-BUS-ICG.
           PERFORM GET-CUR-ICG.
           IF FIO-STAT-OKS
                PERFORM GET-NXT-ICG
                IF SCR-IND-MICG = 'M'
                    MOVE 'M'          TO FRM-GLS-TINT IN DLC-FLD
                    MOVE MSG-GLS-DESC TO FRM-MEN2
                    MOVE SPACES TO MSG-COD-SIST
                    MOVE SPACES TO MSG-COD-MENS
                ELSE
                    PERFORM PUT-ICG-DLC
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE ZEROES TO ICG-SGV-TINT IN DLC-FLD
                MOVE SPACES TO ICG-COD-TINT IN DLC-FLD.
           IF PGM-STAT-ICG-OKS AND
              SCR-CCPP = 'ING'
               PERFORM PUT-ICG-DLC.
*% IF PGM_PER
      *HPM ini
      *    IF OPC-MSC-STAT IN OPC = 'F'
           IF OPC-APROBADA-CTC
               MOVE 'OPC    APDYA' TO MSG-COD-MENS
               GO TO SIG-FND-KEY.
      *HPM fin
*% END
      *ALD
      *    IF NOT ( OPC-MSC-STAT IN OPC = 'L' OR 'A' )

      *    IF OPC-MSC-STAT IN OPC NOT = 'A' AND
      *       OPC-MSC-STAT IN OPC NOT = 'D'
           IF ( NOT OPC-ACTIVADA ) AND ( NOT OPC-DESACTIVADA ) 
               IF SCR-CMND = 'MCA'
                   MOVE 'OPC    ACANO' TO MSG-COD-MENS
                   GO TO SIG-FND-KEY
               ELSE                
                   GO TO REC-DLC-STAT.
      *     IF OPC-MSC-STAT IN OPC = 'L'
      *         MOVE 'OPC    LIQYA' TO MSG-COD-MENS.

      *    IF OPC-MSC-STAT IN OPC = 'A'
           IF OPC-ACTIVADA
               IF SCR-CMND = 'MCA'
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE 'OPC    ACAYA' TO MSG-COD-MENS.
      *    IF OPC-MSC-STAT IN OPC = 'D'
           IF OPC-DESACTIVADA
               MOVE 'OPC    DESYA' TO MSG-COD-MENS.
       SIG-FND-KEY.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.

           MOVE MSG-GLS-DESC TO CPT-STR1
           MOVE MSG-GLS-DATA TO CPT-STR2
           PERFORM CPT-BLKS
           MOVE CPT-STRN     TO FRM-MENS

           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
       REC-DLC-STAT.
           MOVE PGM-STAT-DLC TO FIO-STAT.
      *>>>>
*% END
*% IF SCR_GFLD_VAL_FLD
      *<<<< SCR_GFLD_VAL_FLD
      *ISP ES NECESARIO TENER LOS DATOS DE LA OPERACION
      *    PARA LA VALIDACION DE CAMPOS
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO ERR-SCR-GFLD.
      *>>>>
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
           PERFORM GET-UPD-RDC.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           PERFORM MOD-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           IF SCR-CMND = 'MCA'
               GO TO FIN-CMN-MOD.
           PERFORM MOD-ICG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
*% IF PGM_PER
           IF FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
              FRM-IND-VSTR IN DLC-FLD = 'N'
               MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC
               MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               PERFORM MOD-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-CMN-MOD.
*% END
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM VAL-VCAM.
           MOVE SPACES              TO DLC-GLS-FLAG IN DLC.
           MOVE ZEROES              TO DLC-VAL-SINT IN DLC.
           MOVE OPC-FEC-FCOL IN OPC TO DLC-FEC-FAMT IN DLC.
           MOVE DLC-VAL-SDLC IN DLC TO DLC-VAL-SCPA IN DLC.
      *    MOVE DLC-KEY-IDLC IN DLC TO DLC-KEY-IDLO IN DLC.
           MOVE SPACES              TO DLC-GLS-DISP IN DLC.
      *>>>>
*% END
*% IF INI_CMN_ING OR INI_CMN_MOD
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           MOVE SYS-GET-DATE TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
      *    MOVE SYS-TSTP TO DLC-STP-IINV IN DLC.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

           PERFORM PUT-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.

           PERFORM PUT-ICG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.

*% IF PGM_PER 
           IF FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
              FRM-IND-VSTR IN DLC-FLD = 'N'
               PERFORM PUT-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-CMN-ING.
*% END
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           MOVE DLC-CAI-IOPC IN DLC TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
      *        MOVE 'M' TO OPC-MSC-STAT IN OPC
               MOVE STO-MODIFICADA IN STO-VARI TO OPC-MSC-STAT IN OPC
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-OPC.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'
               MOVE DLC-CAI-IOPC IN DLC TO OPC-CAI-IOPC IN OPC
               MOVE DLC-IIC-IOPC IN DLC TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
      *            MOVE 'M' TO OPC-MSC-STAT IN OPC
                   MOVE STO-MODIFICADA IN STO-VARI
                                       TO OPC-MSC-STAT IN OPC
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-OPC.
*% IF PGM_PER 
           IF FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
              FRM-IND-VSTR IN DLC-FLD = 'N'
               IF FRM-FFLD = FRM-FFLD-PF10 AND
                  SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
                   PERFORM EGR-FTER-CIC
               ELSE
                   GO TO FIN-CMN-ING.
*% END
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
           PERFORM GET-UPD-RDC.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           PERFORM DEL-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
*% IF PGM_PER 
           IF FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
              FRM-IND-VSTR IN DLC-FLD = 'N'
               PERFORM DEL-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-CMN-ELI.
*% END
      *DAD ini  08-JAN-1993
           MOVE DLC-CAI-IOPC IN DLC TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
      *        MOVE 'M' TO OPC-MSC-STAT IN OPC
               MOVE STO-MODIFICADA IN STO-VARI TO OPC-MSC-STAT IN OPC
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-OPC.
      *DAD fin  08-JAN-1993
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY COLWGPMP.
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
*% END
*% IF FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
           IF FRM-FFLD = FRM-FFLD-PF3 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S' AND
              SCR-IND-OOD = 'O'
               PERFORM EGR-FTER-CIC.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
      * ESTE PROGRAMA PUEDE SER UN PUNTO DE ENTRADA AL ENGANCHE
      * ADEMAS ENGANCHA SIEMPRE HACIA ADELANTE
           PERFORM SET-ENG.
           PERFORM EGR-FPEN-CIC.
      *>>>>
*% END
*% IF SCR_GFLD_VAL_MKY
      *<<<< SCR_GFLD_VAL_MKY
      * ESTE PROGRAMA PUEDE SER UN PUNTO DE ENTRADA AL ENGANCHE
           IF FRM-FFLD = FRM-FFLD-PF10 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
      *HPM ini
               IF FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
                  FRM-IND-VSTR IN DLC-FLD = 'N'
                   PERFORM EGR-FTER-CIC
               ELSE
      *HPM fin
                   MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC
                   MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   PERFORM SET-ENG
                   PERFORM EGR-FPEN-CIC.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
*% IF PGM_PTC
      *PTC ini
           PERFORM GNS-ERR-QUE.
      *PTC fin
*% END
      *DAD ini  28-OCT-1992
           IF SCR-CMND NOT = 'MCA'
               GO TO CON-INI-FIO.
*% IF PRV_BCI
           COPY USPC143.
*% END
       CON-INI-FIO.
      *DAD fin  28-OCT-1992
           MOVE +3000 TO SCR-TCMA.

*% IF PGM_PTC
      *PTC ini
           IF SCR-OFRM-SRV
               MOVE WSS-IDX-IDLC TO SCR-IPRO
               GO TO FIN-INI-FIO.
      *PTC fin
*% END

           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
                              SCR-RQA2
                              SCR-RQA3
                              SCR-VEC-ENG
               MOVE 'D'    TO SCR-IND-OOD
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'FLDING' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCR-MENS-EXT
               PERFORM ING-FPEN-CIC.
       FIN-INI-FIO.
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM HBL-KEY-DLC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-CIC-OPEC SECTION.
       INI-BUS-CIC-OPEC.
           MOVE SPACES              TO FRM-CIC-OPEC IN DLC-FLD.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'               TO MSG-COD-SIST
               MOVE 'OPCTOOCNEX  '      TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE OPC-COD-TOOC IN OPC TO FRM-MEN2
               MOVE SCR-STAT-CON        TO SCR-STAT
               GO TO FIN-BUS-CIC-OPEC.
           MOVE 'COL'               TO FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'               TO MSG-COD-SIST
               MOVE 'OPCOPECNEX  '      TO MSG-COD-MENS
               PERFORM GET-MSG  
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE TOC-MSC-OPEC IN TOC TO FRM-MEN2
               MOVE SCR-STAT-CON        TO SCR-STAT
               GO TO FIN-BUS-CIC-OPEC.
           MOVE MSC-CIC-CMSC IN MSC TO FRM-CIC-OPEC IN DLC-FLD.
       FIN-BUS-CIC-OPEC.
           EXIT.
       BUS-CIC-TDOC SECTION.
       INI-BUS-CIC-TDOC.
      *Busca codigo computacional del codigo tipo de documento del DLC
           MOVE 'TAB'                   TO FIO-SIST.
           MOVE 'DOC'                   TO TAB-COD-TTAB IN TAB.
           MOVE FRM-CIC-TDOC IN DLC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'               TO MSG-COD-SIST
               MOVE 'CICDOC PAGNX'      TO MSG-COD-MENS
               PERFORM GET-MSG  
               MOVE MSG-GLS-DESC            TO FRM-MEN1
               MOVE FRM-CIC-TDOC IN DLC-FLD TO FRM-MEN2
               MOVE SCR-STAT-CON            TO SCR-STAT
               GO TO FIN-BUS-CIC-TDOC.
           MOVE TAB-CIC-CTAB IN TAB TO FRM-CIC-TDOC IN DLC-FLD.
       FIN-BUS-CIC-TDOC.
           EXIT.
       PRO-DLC-ROV SECTION.
       INI-PRO-DLC-ROV.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO DLC-CAI-IOCO IN DLC-FLD.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO DLC-IIC-IOCO IN DLC-FLD.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO DLC-NUM-IDLO IN DLC-FLD.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ROV-CAI-IOPC IN ROV.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ROV-IIC-IOPC IN ROV.
           MOVE SPACES                  TO ROV-CAI-IOPV IN ROV.
           MOVE SPACES                  TO ROV-IIC-IOPV IN ROV.
           MOVE ZEROES                  TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
              ROV-CAI-IOPC IN ROV = DLC-CAI-IOPC IN DLC-FLD AND
              ROV-IIC-IOPC IN ROV = DLC-IIC-IOPC IN DLC-FLD )
               GO TO FIN-PRO-DLC-ROV.
           MOVE ROV-CAI-IOPV IN ROV TO CAN-CAI-IOPC IN CAN.
           MOVE ROV-IIC-IOPV IN ROV TO CAN-IIC-IOPC IN CAN.
           MOVE ROV-NUM-IVCT IN ROV TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-ROV.
           IF CAN-MSC-TCAN IN CAN NOT = 'P'
               GO TO FIN-PRO-DLC-ROV.
           MOVE ROV-CAI-IOPV IN ROV     TO DLC-CAI-IOPC IN DLC.
           MOVE ROV-IIC-IOPV IN ROV     TO DLC-IIC-IOPC IN DLC.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-ROV.
      *     MOVE DLC-CAI-IOCO IN DLC TO DLC-CAI-IOCO IN DLC-FLD.
      *     MOVE DLC-IIC-IOCO IN DLC TO DLC-IIC-IOCO IN DLC-FLD.
      *     MOVE DLC-NUM-IDLO IN DLC TO DLC-NUM-IDLO IN DLC-FLD.
           MOVE SPACES               TO DLC-CAI-IOCO IN DLC-FLD.
           MOVE SPACES               TO DLC-IIC-IOCO IN DLC-FLD.
           MOVE ZEROS                TO DLC-NUM-IDLO IN DLC-FLD.
      *
           MOVE DLC-MSC-TIMP IN DLC TO DLC-MSC-TIMP IN DLC-FLD.
           MOVE DLC-COD-NOTC IN DLC TO DLC-COD-NOTC IN DLC-FLD.
           MOVE DLC-VAL-GNOT IN DLC TO DLC-VAL-GNOT IN DLC-FLD.
           MOVE DLC-VAL-IPEN IN DLC TO DLC-VAL-IPEN IN DLC-FLD.
           MOVE DLC-COD-UBFD IN DLC TO DLC-COD-UBFD IN DLC-FLD.
           MOVE DLC-COD-PLZA IN DLC TO DLC-COD-PLZA IN DLC-FLD.

           MOVE DLC-CAI-IOPC IN DLC TO RDC-CAI-IOPC IN RDC.
           MOVE DLC-IIC-IOPC IN DLC TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *HPM ini Compatibilidad VSAM DATACOM
      *    MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *HPM fin
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-ROV.
      *HPM ini
           IF NOT ( RDC-CAI-IOPC IN RDC = DLC-CAI-IOPC IN DLC AND
                    RDC-IIC-IOPC IN RDC = DLC-IIC-IOPC IN DLC AND
                    RDC-NUM-IDLC IN RDC = DLC-NUM-IDLC IN DLC )
               MOVE '23' TO FIO-STAT
               GO TO FIN-PRO-DLC-ROV.
      *HPM fin
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              DLC-CAI-IOPC IN DLC = RDC-CAI-IOPC IN RDC AND
              DLC-IIC-IOPC IN DLC = RDC-IIC-IOPC IN RDC AND
              DLC-NUM-IDLC IN DLC = RDC-NUM-IDLC IN RDC
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'DLC    MDIND' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE 'M'          TO DBC-IND-ICLI IN DLC-FLD
                MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
                GO TO AEY-PRO-DLC-ROV
           ELSE
               MOVE DLC-CAI-IOPC IN DLC TO RDC-CAI-IOPC IN RDC
               MOVE DLC-IIC-IOPC IN DLC TO RDC-IIC-IOPC IN RDC
               MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RDC.
           MOVE RDC-NUM-DIRE IN RDC TO RDC-NUM-DIRE IN DLC-FLD.
           MOVE RDC-CAI-ICLI IN RDC TO RDC-CAI-ICLI IN DLC-FLD.
           MOVE RDC-IIC-ICLI IN RDC TO RDC-IIC-ICLI IN DLC-FLD.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-ROV.
           MOVE '00' TO PGM-STAT-DBC.
           PERFORM PUT-DBC-DLC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN DLC-FLD.
       AEY-PRO-DLC-ROV.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD.
           MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD.
           MOVE -1           TO DLC-IND-RIES-LEN IN DLC-FLD.
       FIN-PRO-DLC-ROV.
           EXIT.
       VAL-VCAM SECTION.
       INI-VAL-VCAM.
           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPCTVALCICNX' TO MSG-COD-MENS
               MOVE MSC-CIC-TABL   TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-VCAM.
      *Si es moneda extranjera ...
           IF OPC-MSC-TVOC IN OPC NOT = MSC-COD-CMSC IN MSC
               MOVE DLC-VAL-NDLC IN DLC-FLD TO DLC-VAL-DPES IN DLC
               GO TO FIN-VAL-VCAM.
      *Si es moneda nacional ...
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-COD-CTAB NOT = OPC-COD-VCOC IN OPC
                   PERFORM BUS-FVAL-CAM
                   IF MSG-COD-MENS > SPACES
                       GO TO FIN-VAL-VCAM
                   ELSE
                       MOVE OPC-COD-VCOC TO CAM-COD-VCAM IN CAM(1)
                       MOVE TAB-COD-CTAB TO CAM-COD-VCAM IN CAM(2)
                       MOVE FIO-GET-KEY  TO FIO-CMND
                       PERFORM TAB-FIO-CAM
                       IF NOT FIO-STAT-OKS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'CODVCAMNEX' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                       ELSE
                       IF CAM-IND-VIGE IN CAM = 'N'
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'CODVCAMNVG' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                       ELSE
                           MULTIPLY CAM-SGV-VCAM IN CAM
                           BY       DLC-VAL-NDLC IN DLC-FLD
                           GIVING   DLC-VAL-DPES IN DLC
               ELSE
                   MOVE DLC-VAL-NDLC IN DLC-FLD TO
                        DLC-VAL-DPES IN DLC
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS.
       FIN-VAL-VCAM.
           EXIT.

       BUS-FVAL-CAM SECTION.
       INI-BUS-FVAL-CAM.
           MOVE SPACES TO MSG-COD-MENS.
           IF OPC-IND-RENO NOT = 'PRO'
               MOVE OPC-FEC-FCOL TO CAM-FEC-FCAM IN CAM(1)
               MOVE OPC-FEC-FCOL TO CAM-FEC-FCAM IN CAM(2)
               GO TO FIN-BUS-FVAL-CAM.
      *
           MOVE OPC-CIC-IOPC TO WSS-CIC-IOPC.
           MOVE SPACES       TO ROV-KEY-IROV IN ROV.
           MOVE OPC-CIC-IOPC TO ROV-CIC-IOPC IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    ROV-CIC-IOPC IN ROV = OPC-CIC-IOPC IN OPC )
               MOVE 'ROVINEXOPC' TO MSG-COD-MENS
               MOVE OPC-CIC-IOPC TO FRM-MEN2
               GO TO MSG-BUS-FVAL-CAM.
      *Accesa documento que esta prorrogando ( antes respalda DLC )
           MOVE DLC TO DLC-BKP.
           MOVE ROV-CIC-IOPV IN ROV TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CIC-IOPC IN DLC = ROV-CIC-IOPV IN ROV )
               MOVE 'DLC    NEX' TO MSG-COD-MENS
               MOVE ROV-CIC-IOPV IN ROV TO FRM-MEN2
               GO TO MSG-BUS-FVAL-CAM.
      *El IOCO indica la operacion original ( si es que esta lleno )
           IF DLC-CIC-IOCO IN DLC > SPACES
               MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC
           ELSE
               MOVE DLC-CIC-IOPC IN DLC TO OPC-CIC-IOPC IN OPC.
      *Se recuperan nuevamente los datos originales del DLC
           MOVE DLC-BKP TO DLC.
      *
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               MOVE OPC-CIC-IOPC TO FRM-MEN2
               GO TO MSG-BUS-FVAL-CAM.
           MOVE OPC-FEC-FCOL TO CAM-FEC-FCAM IN CAM(1).
           MOVE OPC-FEC-FCOL TO CAM-FEC-FCAM IN CAM(2).
      *Restaura OPC
           MOVE WSS-CIC-IOPC TO OPC-CIC-IOPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               MOVE OPC-CIC-IOPC TO FRM-MEN2.
       MSG-BUS-FVAL-CAM.
           IF MSG-COD-MENS > SPACES
               MOVE 'SGV' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1.
       FIN-BUS-FVAL-CAM.
           EXIT.

       HBL-KEY-DLC SECTION.
       INI-HBL-KEY-DLC.
           PERFORM SCR-CLRA-DLC.
           MOVE +4 TO DLC-CAI-IOPC-LEN IN DLC-FLD.
           MOVE SCR-CAI-IOPC IN SCR-VARI TO DLC-CAI-IOPC IN DLC-FLD.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO DLC-IIC-IOPC IN DLC-FLD.
      *ISP  7-FEB-1990 DEBE SER REEMPLAZADO POR VARIABLE
      *     INHIBE MOVE FRM-CPSF TO FRM-CPIM-AEY
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM HBL-FLD.
           MOVE SCR-INST-GFL TO SCR-INST.
           MOVE SCR-CAI-IOPC IN SCR-VARI TO DLC-CAI-IOPC IN DLC-FLD.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO DLC-IIC-IOPC IN DLC-FLD.
      *ISP SE REQUIEREN PARA BUS-COR-DLC
           MOVE SCR-CAI-IOPC IN SCR-VARI TO DLC-CAI-IOPC IN DLC.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO DLC-IIC-IOPC IN DLC.
           PERFORM BUS-COR-DLC.

           PERFORM GET-CUR-OPC.
           IF NOT PGM-STAT-OPC-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               PERFORM CLR-OPC-DLC
           ELSE
               PERFORM PUT-OPC-DLC
               PERFORM PRO-DLC-ROV.

           PERFORM GET-CUR-ICG.
           IF PGM-STAT-ICG-OKS
               PERFORM PUT-ICG-DLC.

           PERFORM EDT-KEY-DLC.
           PERFORM EDT-FLD-DLC.
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)
               PERFORM SCR-INIT
               PERFORM STP-EXIT
           ELSE
               PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-HBL-KEY-DLC.
           EXIT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-RQA3 > SPACES
               PERFORM LEE-NXT-PRV-DLC
           ELSE
           IF SCR-RQA2 > SPACES
               PERFORM LEE-NXT-PRV-RDC
           ELSE
           IF SCR-RQA1 > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               MOVE SPACES TO SCR-KEY-IRDC
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-RDC SECTION.
       INI-LEE-NXT-PRV-RDC.
           MOVE SCR-RQA2 TO ADR-RDC-REQA.
           MOVE ADR-VKEY IN ADR-RDC-REQA TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-RDC
               IF RDC-CIC-ICLI IN RDC = WSS-CIC-ICLI IN WSS-VARI
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   IF RDC-NUM-IDLC IN RDC = ZEROES
                       GO TO INI-LEE-NXT-PRV-RDC
                   ELSE
                       MOVE '00' TO PGM-STAT-DBC
                       MOVE 'RDCSI' TO MSG-COD-MENS
                       GO TO FIN-LEE-NXT-PRV-RDC.
           MOVE 'RDCNO' TO MSG-COD-MENS.
           MOVE SPACES TO SCR-RQA2.
           IF SCR-RQA1 > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV-RDC.
           EXIT.

       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-RQA1 TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE 'DBCSI' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.
       LEE-NXT-PRV-DLC SECTION.
       INI-LEE-NXT-PRV-DLC.
           MOVE SCR-RQA3 TO ADR-DLC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-DLC
               MOVE ADR-DLC-REQA TO SCR-RQA3.
       FIN-LEE-NXT-PRV-DLC.
           EXIT.

       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF5
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE 'DBCSI' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.

       BUS-DEU-IND SECTION.
       INI-BUS-DEU-IND.
           MOVE SPACES              TO RDC-KEY-IRDC IN RDC.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN RDC.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE '999999999999' TO RDC-KEY-IDLC IN RDC
               MOVE 999 TO RDC-NUM-IDLC IN RDC
               MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-DEU-IND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC
               IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                   MOVE '00' TO PGM-STAT-RDC
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   MOVE 'IRDC' TO SCR-KEY-IRDC
                   GO TO FIN-BUS-DEU-IND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE FIO-GET-PRV TO FIO-CMND
                       GO TO LUP-BUS-DEU-IND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-BUS-DEU-IND
            ELSE
               MOVE SPACES TO SCR-RQA2
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-DEU-IND.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       BUS-COR-DLC SECTION.
       INI-BUS-COR-DLC.
           MOVE 99 TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC-FLD = DLC-CAI-IOPC IN DLC AND
                    DLC-IIC-IOPC IN DLC-FLD = DLC-IIC-IOPC IN DLC )
               PERFORM KEY-ALL-DLC
               MOVE ZEROES TO DLC-NUM-IDLC IN DLC.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO DLC-NUM-IDLC IN DLC
               MOVE DLC-NUM-IDLC IN DLC TO DLC-NUM-IDLC IN DLC-FLD
           ELSE
               MOVE DLC-NUM-IDLC IN DLC TO DLC-NUM-IDLC IN DLC-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-DLC.
           EXIT.

      * INIT
      * ====

       INI-REG-RDC SECTION.
       INI-INI-REG-RDC.
           MOVE SPACES TO RDC-GLS-FLAG IN RDC.
      *     MOVE SPACES TO RDC-COD-OINV IN RDC.
           MOVE SPACES TO RDC-GLS-DISP IN RDC.
       FIN-INI-REG-RDC.
           EXIT.

      * GET-UPD
      * =======

       GET-UPD-RDC SECTION.
       INI-GET-UPD-RDC.
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               GO TO FIN-GET-UPD-RDC.
           IF RDC-CAI-ICLI IN DLC-FLD > SPACES OR
              RDC-IIC-ICLI IN DLC-FLD > ZEROES
               MOVE WSS-HAY TO WSS-FRDC.

           MOVE DLC-CAI-IOPC IN DLC-FLD TO RDC-CIC-IOPC IN RDC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE WSS-HAY TO WSS-RRDC
               IF WSS-HAY-RDC-FRM AND
                  ( RDC-CAI-ICLI IN DLC-FLD NOT = RDC-CAI-ICLI IN RDC OR
                    RDC-IIC-ICLI IN DLC-FLD NOT = RDC-IIC-ICLI IN RDC )
                   MOVE WSS-OTRO TO WSS-SRDC.
       FIN-GET-UPD-RDC.
           EXIT.


      * MOD
      * ===

       MOD-ICG SECTION.
       INI-MOD-ICG.
           IF FRM-CIC-OPEC IN DLC-FLD NOT = 'D'
               MOVE '00' TO FIO-STAT
               GO TO FIN-MOD-ICG.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD AND
              ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC-FLD AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-ICG
               MOVE ICG-SGV-TINT IN DLC-FLD TO ICG-SGV-TINT IN ICG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-ICG
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-MOD-ICG
               ELSE
                   GO TO FIN-MOD-ICG.
           PERFORM PUT-ICG.
       FIN-MOD-ICG.
           EXIT.

       MOD-RDC SECTION.
       INI-MOD-RDC.
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               GO TO FIN-MOD-RDC.
           IF NOT WSS-HAY-RDC-REG
               IF NOT WSS-HAY-RDC-FRM
                   GO TO FIN-MOD-RDC
               ELSE
                   PERFORM PUT-RDC
                   GO TO FIN-MOD-RDC.

      *ISP
           IF WSS-HAY-RDC-FRM AND
              WSS-MISMO-RDC
      *         MOVE SYS-TSTP TO RDC-STP-IINV IN RDC
                MOVE FIO-MOD TO FIO-CMND
                PERFORM COL-FIO-RDC
                GO TO FIN-MOD-RDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-MOD-RDC.
           IF WSS-HAY-RDC-FRM
               PERFORM PUT-RDC.
       FIN-MOD-RDC.
           EXIT.

      * PUT
      * ===

       PUT-ICG SECTION.
       INI-PUT-ICG.
           IF FRM-CIC-OPEC IN DLC-FLD NOT = 'D'
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-ICG.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES       TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT (FIO-STAT-OKS AND
                   ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD AND
                   ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD AND
                   ICG-NUM-ICAN IN ICG = ZEROES       AND
                   ICG-CIC-IOPV IN ICG = SPACES       AND
                   ICG-NUM-IVCT IN ICG = ZEROES       AND
                   ICG-IND-TTAS IN ICG = 'INT' )
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-ICG.
           IF ICG-SGV-TINT IN ICG = ICG-SGV-TINT IN DLC-FLD
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE ICG-SGV-TINT IN DLC-FLD TO ICG-SGV-TINT IN ICG.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO ICG-NUM-ICAN IN ICG.
           MOVE FIO-PUT TO FIO-CMND
           PERFORM COL-FIO-ICG
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-ICG.
           EXIT.

       PUT-RDC SECTION.
       INI-PUT-RDC.
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               GO TO FIN-PUT-RDC.
           IF RDC-CAI-ICLI IN DLC-FLD > SPACES OR
              RDC-IIC-ICLI IN DLC-FLD > ZEROES
      *          MOVE SYS-TSTP TO RDC-STP-IINV IN RDC
                PERFORM INI-REG-RDC
                MOVE DLC-CAI-IOPC IN DLC-FLD TO RDC-CAI-IOPC IN RDC
                MOVE DLC-IIC-IOPC IN DLC-FLD TO RDC-IIC-IOPC IN RDC
                MOVE DLC-NUM-IDLC IN DLC-FLD TO RDC-NUM-IDLC IN RDC
                MOVE 100 TO RDC-VAL-LIMD IN RDC
                MOVE FIO-PUT TO FIO-CMND
                PERFORM COL-FIO-RDC
                IF NOT FIO-STAT-OKS
      *    Error inconsistencia en el ingreso : hacer LOGTB e informar
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-RDC.
           EXIT.

      *DELETE
      *======

       DEL-RDC SECTION.
       INI-DEL-RDC.
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               GO TO FIN-DEL-RDC.
           IF NOT WSS-HAY-RDC-REG
               GO TO FIN-DEL-RDC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-DEL-RDC.
           EXIT.

       ANL-KEY-DLC SECTION.
       INI-ANL-KEY-DLC.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ANL-KEY-DLC
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN DLC-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLC-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLC-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLC-FLD
               PERFORM BUS-DEU-IND
               IF FIO-STAT-OKS
                   MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   IF NOT FIO-STAT-OKS
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'RDC    NOOPC' TO MSG-COD-MENS
                       MOVE FIO-STAT-NEX TO FIO-STAT
                   ELSE
                       MOVE '00' TO PGM-STAT-OPC
                       MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                       MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC
                       MOVE OPC-CAI-IOPC IN OPC TO DLC-CAI-IOPC
                                                     IN DLC-FLD
                       MOVE OPC-IIC-IOPC IN OPC TO DLC-IIC-IOPC
                                                     IN DLC-FLD
                       MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC
               ELSE
                   MOVE ZEROES TO RDC-NUM-DIRE IN RDC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'CLI    NOIND' TO MSG-COD-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-KEY-DLC.
           EXIT.

       PUT-DBC SECTION.
       INI-PUT-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DLC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLC-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN DLC-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN DLC-FLD.
       FIN-PUT-DBC.
           EXIT.

       GET-CUR-OPC SECTION.
       INI-GET-CUR-OPC.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-STAT TO PGM-STAT-OPC.
       FIN-GET-CUR-OPC.
           EXIT.

       GET-CUR-ICG SECTION.
       INI-GET-CUR-ICG.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD AND
              ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC-FLD AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               MOVE '00' TO PGM-STAT-ICG
               GO TO FIN-GET-CUR-ICG.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES       TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD AND
              ICG-NUM-ICAN IN ICG = ZEROES       AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               MOVE '00' TO PGM-STAT-ICG.
       FIN-GET-CUR-ICG.
           EXIT.

       GET-NXT-ICG SECTION.
       INI-GET-NXT-ICG.
           MOVE ICG-NUM-ICAN IN ICG TO WSS-NUM-ICAN IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD  AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD  AND
              ICG-NUM-ICAN IN ICG = WSS-NUM-ICAN IN WSS-VARI AND
              ICG-CIC-IOPV IN ICG = SPACES                   AND
              ICG-NUM-IVCT IN ICG = ZEROES                   AND
              ICG-IND-TTAS IN ICG = 'INT'
                MOVE 'M' TO SCR-IND-MICG
                MOVE 'COL'         TO MSG-COD-SIST
                MOVE 'OPC    MICG' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO SCR-IND-MICG
                PERFORM GET-CUR-ICG.
       FIN-GET-NXT-ICG.
           EXIT.

       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO RDC-CAI-IOPC IN RDC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *JSS COMPATIBILIDAD VSAM DATACOM
      *    MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-RDC.
      *JSS COMPATIBILIDAD VSAM DATACOM
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CAI-IOPC IN RDC = DLC-CAI-IOPC IN DLC-FLD AND
                    RDC-IIC-IOPC IN RDC = DLC-IIC-IOPC IN DLC-FLD AND
                    RDC-NUM-IDLC IN RDC = DLC-NUM-IDLC IN DLC-FLD )
               MOVE '23' TO FIO-STAT.
      *
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-RDC.
       FIN-GET-CUR-RDC.
           EXIT.

       GET-NXT-RDC SECTION.
       INI-GET-NXT-RDC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              DLC-CAI-IOPC IN DLC-FLD = RDC-CAI-IOPC IN RDC AND
              DLC-IIC-IOPC IN DLC-FLD = RDC-IIC-IOPC IN RDC AND
              DLC-NUM-IDLC IN DLC-FLD = RDC-NUM-IDLC IN RDC
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'DLC    MDIND' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
              MOVE SPACES TO SCR-IND-MRDC
              PERFORM GET-CUR-RDC.
       FIN-GET-NXT-RDC.
           EXIT.

       BUS-POC SECTION.
       INI-BUS-POC.
      *ALD
           MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC.
           MOVE ZEROES              TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-STAT TO PGM-STAT-POC.
      *
       FIN-BUS-POC.
           EXIT.

       COPY SGCBFDBC.
       COPY COLBFOPC.
       COPY COLBFROV.
       COPY COLBFCAN.
       COPY COLBFRDC.
       COPY COLBFICG.
       COPY COLBFVEN.
       COPY SGCBFRCD.
*% IF PGM_PTC
      *PTC ini
       COPY GNSBGQUE.
      *PTC fin
*% END
       COPY TABBFTIO.
       COPY TABBFCAM.
       COPY COLBFNTR.
       COPY SGCBGCLI.
       COPY GNSBPFEC.
       COPY GNSBGCPT.
       COPY GNSBGPES.
       COPY GNSBGINT.
       COPY GNSBGSTR.
       COPY SGCBGDOM.
       COPY COLBFTOC.
       COPY COLBFPOC.
       COPY COLBFDCC.
       COPY TABBVOFI.
      *>>>>
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       ING-FPEN-CIC SECTION.
       INI-ING-FPEN-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO DLC-GLS-MENS.
           PERFORM HBL-IKY.
*% IF PGM_PTC
      *PTC ini
           IF SCR-OFRM-SRV
               EXEC CICS
               RETURN
           END-EXEC.
      *PTC fin
*% END
       FIN-ING-FPEN-CIC.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.

           MOVE WSS-NTRV(SCR-IPRO) TO SCR-NTRV.
           MOVE WSS-PROV(SCR-IPRO) TO SCR-PROV.
       FIN-ING-SETE.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
*% IF PGM_PTC
      *PTC ini
           IF SCR-OFRM-SRV
               MOVE WSS-IDX-IDLC TO SCR-IPRO
           ELSE
      *PTC fin
*% END
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CIC.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE DLC-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
       COPY COLBGMPT.

      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       PRO-FLD-DLC SECTION.
       INI-PRO-FLD-DLC.
           PERFORM PRO-ICG-DLC.
           PERFORM PRO-RDC-DLC.
           PERFORM PRO-OPC-DLC.
           PERFORM PRO-DLC-DLC.
           PERFORM PRO-DBC-DLC.
       FIN-PRO-FLD-DLC.
           EXIT.
       
       PRO-ICG-DLC SECTION.
       INI-PRO-ICG-DLC.
           MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD.
       FIN-PRO-ICG-DLC.
           EXIT.
       
       PRO-RDC-DLC SECTION.
       INI-PRO-RDC-DLC.
           MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD.
       FIN-PRO-RDC-DLC.
           EXIT.
       
       PRO-OPC-DLC SECTION.
       INI-PRO-OPC-DLC.
       FIN-PRO-OPC-DLC.
           EXIT.
       
       PRO-DLC-DLC SECTION.
       INI-PRO-DLC-DLC.
           MOVE FRM-CPIM-AEY TO DLC-VAL-NDLC-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-IND-RIES-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-COD-TDOC-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-COD-UBFD-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-MSC-TIMP-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-VAL-IMPU-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-COD-PLZA-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-COD-NOTC-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-VAL-GNOT-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-COD-PLZO-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-MSC-MIPL-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-IND-SCRT-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-IND-SCTB-ATR IN DLC-FLD.
           MOVE FRM-CPIM-AEY TO DLC-IND-SCBZ-ATR IN DLC-FLD.
       FIN-PRO-DLC-DLC.
           EXIT.
       
       PRO-DBC-DLC SECTION.
       INI-PRO-DBC-DLC.
       FIN-PRO-DBC-DLC.
           EXIT.
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       PUT-DBC-DLC SECTION.
       INI-PUT-DBC-DLC.
      *<<<< INI_PUT_DBC_DLC
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLC    MDIND' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DLC-FLD
               GO TO FIN-PUT-DBC-DLC.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-DLC.
           IF NOT PGM-STAT-DBC-OKS
               MOVE SPACES TO DBC-GLS-NOMC IN DLC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               GO TO FIN-PUT-DBC-DLC.
      *>>>>

           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-DLC.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-DLC
               GO TO FIN-PUT-DBC-DLC.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN DLC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLC-FLD.

      *<<<< FIN_PUT_DBC_DLC
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DLC-FLD.
      *>>>>
       FIN-PUT-DBC-DLC.
           EXIT.

       PUT-OPC-DLC SECTION.
       INI-PUT-OPC-DLC.

           IF PGM-STAT-OPC-NUL
               GO TO FIN-PUT-OPC-DLC.
           IF NOT PGM-STAT-OPC-OKS
               PERFORM CLR-OPC-DLC
               GO TO FIN-PUT-OPC-DLC.
           MOVE OPC-MSC-TVOC IN OPC TO OPC-MSC-TVOC IN DLC-FLD.
           MOVE OPC-COD-TOOC IN OPC TO OPC-COD-TOOC IN DLC-FLD.
           MOVE OPC-COD-OFOC IN OPC TO OPC-COD-OFOC IN DLC-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF OPC-MSC-TVOC IN DLC-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-TVOC IN DLC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TVOC IN DLC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-TOOC IN DLC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN DLC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN DLC-FLD.
      *BUS-OFI busca oficina en tablas
           IF OPC-COD-OFOC IN DLC-FLD > SPACES
               MOVE OPC-COD-OFOC IN DLC-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN DLC-FLD.

      *<<<< FIN_PUT_OPC_DLC
      *BUS-TAB busca glosa de codigo en tabla
      * NO EXISTE OPC-COD-VCOC IN DLC-FLD
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCOC IN DLC-FLD.
      *>>>>
       FIN-PUT-OPC-DLC.
           EXIT.
       PUT-ICG-DLC SECTION.
       INI-PUT-ICG-DLC.

           IF PGM-STAT-ICG-NUL
               GO TO FIN-PUT-ICG-DLC.
           IF NOT PGM-STAT-ICG-OKS
               PERFORM CLR-ICG-DLC
               GO TO FIN-PUT-ICG-DLC.
           MOVE ICG-COD-TINT IN ICG TO ICG-COD-TINT IN DLC-FLD.
           MOVE ICG-SGV-TINT IN ICG TO ICG-SGV-TINT IN DLC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF ICG-COD-TINT IN DLC-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'INT' TO TAB-COD-TTAB IN TAB
               MOVE ICG-COD-TINT IN DLC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TINT IN DLC-FLD.

      *<<<< FIN_PUT_ICG_DLC
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN DLC-FLD.
      *>>>>
       FIN-PUT-ICG-DLC.
           EXIT.

       SET-ENG SECTION.
       INI-SET-ENG.
           MOVE WSS-IDX-IDLC TO SCR-IPRO.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO SCR-CAI-IOPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO SCR-IIC-IOPC.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO SCR-NUM-IDOC.
      *ISP ENGANCHE INCONDICIONAL A (E)VC (O) (V)EN
           MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IEOV).
           MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IEOV).

      *ISP NO ES NECESARIO LEER OPC,PUES SE LEYO ANTE DE VAL-VCAM
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE 'S' TO SCR-IND-EOV IN SCR-VARI
           ELSE
               MOVE 'N' TO SCR-IND-EOV IN SCR-VARI.

      * ISP SI TIENE MULTIPLES DEUDORES INDIRECTOS EL PROGRAMA RDC CARGA LA
      * TABLA CON LA CUAL SE DECIDE A QUE PROGRAMA AVANZAR EVC O VEN
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IIND)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IIND)
           ELSE
               MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IIND)
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IIND)
               IF SCR-IND-EOV IN SCR-VARI = 'S'
                   MOVE 'KQ13COLPQEVCCOLFEVCCOLAEVC' TO
                         WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
                   MOVE 'KU13COLPUEVC'               TO
                         WSS-VEC-PPRV IN WSS-PPRO(WSS-IDX-IEOV)
               ELSE
                   MOVE 'KQ33COLPQVENCOLFVENCOLAVEN' TO
                         WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
                   MOVE 'KU33COLPUVEN'               TO
                         WSS-VEC-PPRV IN WSS-PPRO(WSS-IDX-IEOV).
      *         IF SCR-IND-EOV IN SCR-VARI = 'S'
      *             MOVE 'KO13COLPAEVCCOLFEVCCOLAEVC' TO
      *                  WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
      *         ELSE
      *             MOVE 'KO33COLPAVENCOLFVENCOLAVEN' TO
      *                  WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV).
       FIN-SET-ENG.
           EXIT.

       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IPRO > WSS-TOT-IIDX
                  PERFORM EGR-FTER-CIC
                  GO TO FIN-EGR-FPEN-CIC.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
*% IF PGM_PTC
      *PTC ini
           IF SCR-OFRM-SRV
               MOVE WSS-IDX-IDLC TO SCR-IPRO
           ELSE
      *PTC fin
*% END
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.

       EGR-FTER-CMN SECTION.
       INI-EGR-FTER-CMN.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CMN TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
*% IF PGM_PTC
      *PTC ini
           IF SCR-OFRM-SRV
               MOVE WSS-IDX-IDLC TO SCR-IPRO
           ELSE
      *PTC fin
*% END
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CMN.
           EXIT.

       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO DLC-GLS-MENS.
           PERFORM HBL-IKY.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-FTER-CMN SECTION.
       INI-ING-FTER-CMN.
           PERFORM ING-SETE.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-DLC.
           MOVE SCR-MENS-EXT TO DLC-GLS-MENS.
           PERFORM SCR-INIT.
       FIN-ING-FTER-CMN.
           EXIT.

*% IF PGM_PER
       PUT-VEN SECTION.
       INI-PUT-VEN.
           MOVE SPACES              TO VEN-GLS-FLAG IN VEN.
           MOVE DLC-CAI-IOPC IN DLC TO VEN-CAI-IOPC IN VEN.
           MOVE DLC-IIC-IOPC IN DLC TO VEN-IIC-IOPC IN VEN.
           MOVE DLC-NUM-IDLC IN DLC TO VEN-NUM-IVEN IN VEN.
           PERFORM RET-HDR-VEN.
           MOVE DLC-NUM-SMAV IN DLC TO VEN-NUM-SVEN IN VEN.
           MOVE DLC-NUM-AMAV IN DLC TO VEN-NUM-AVEN IN VEN.
           MOVE DLC-NUM-MMAV IN DLC TO VEN-NUM-MVEN IN VEN.
           MOVE DLC-NUM-DMAV IN DLC TO VEN-NUM-DVEN IN VEN.
           MOVE DLC-NUM-SMAV IN DLC TO VEN-NUM-SIMV IN VEN.
           MOVE DLC-NUM-AMAV IN DLC TO VEN-NUM-AIMV IN VEN.
           MOVE DLC-NUM-MMAV IN DLC TO VEN-NUM-MIMV IN VEN.
           MOVE DLC-NUM-DMAV IN DLC TO VEN-NUM-DIMV IN VEN.
           MOVE ZEROES              TO VEN-VAL-CAPI IN VEN.
           MOVE ZEROES              TO VEN-VAL-SCAP IN VEN.
           MOVE ZEROES              TO VEN-VAL-IDNI IN VEN.
           MOVE DLC-VAL-NDLC IN DLC TO VEN-VAL-FINA IN VEN.
           MOVE DLC-VAL-NDLC IN DLC TO VEN-VAL-SFIN IN VEN.
           MOVE SPACES              TO VEN-IND-SCTB IN VEN.
           MOVE DLC-NUM-IDLC IN DLC TO VEN-NUM-IVCT IN VEN.
           MOVE ZEROES              TO VEN-NUM-IEVC IN VEN.
           MOVE DLC-NUM-IDLC IN DLC TO VEN-NUM-IDLC IN VEN.
           MOVE SPACES              TO VEN-IND-CAUT IN VEN.
           MOVE SPACES              TO VEN-IND-SCBZ IN VEN.
           MOVE ZEROES              TO VEN-VAL-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-MTSC IN VEN.
           MOVE SPACES              TO VEN-IND-CALC IN VEN.
           MOVE SPACES              TO VEN-IND-CTBA IN VEN.
           MOVE SPACES              TO VEN-GLS-DISP IN VEN.

           MOVE DLC-VAL-NDLC IN DLC TO WSS-VAL-FINA IN WSS-VARI.
           MOVE ZEROES              TO WSS-VAL-CAPI IN WSS-VARI.
           PERFORM CAL-CAPI.
           MOVE WSS-VAL-CAPI IN WSS-VARI TO VEN-VAL-CAPI IN VEN.
           MOVE WSS-VAL-CAPI IN WSS-VARI TO VEN-VAL-SCAP IN VEN.
           IF INT-IETB > SPACES
               MOVE 'N'    TO VEN-IND-CALC IN VEN
               MOVE ZEROES TO VEN-VAL-CAPI IN VEN
               MOVE ZEROES TO VEN-VAL-SCAP IN VEN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              MOVE FIO-MENS TO FRM-MENS
              PERFORM BCK-OUT.
       FIN-PUT-VEN.
           EXIT.
*% RGT = "VEN"
*% INCLUDE 'RETHDR'
       MOD-VEN SECTION.
       INI-MOD-VEN.
           MOVE DLC-CAI-IOPC IN DLC TO VEN-CAI-IOPC IN VEN.
           MOVE DLC-IIC-IOPC IN DLC TO VEN-IIC-IOPC IN VEN.
           MOVE DLC-NUM-IDLC IN DLC TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              GO TO FIN-MOD-VEN.
           PERFORM RET-HDR-VEN.
           MOVE DLC-NUM-SMAV IN DLC TO VEN-NUM-SVEN IN VEN.
           MOVE DLC-NUM-AMAV IN DLC TO VEN-NUM-AVEN IN VEN.
           MOVE DLC-NUM-MMAV IN DLC TO VEN-NUM-MVEN IN VEN.
           MOVE DLC-NUM-DMAV IN DLC TO VEN-NUM-DVEN IN VEN.
           MOVE DLC-NUM-SMAV IN DLC TO VEN-NUM-SIMV IN VEN.
           MOVE DLC-NUM-AMAV IN DLC TO VEN-NUM-AIMV IN VEN.
           MOVE DLC-NUM-MMAV IN DLC TO VEN-NUM-MIMV IN VEN.
           MOVE DLC-NUM-DMAV IN DLC TO VEN-NUM-DIMV IN VEN.
           MOVE ZEROES              TO VEN-VAL-CAPI IN VEN.
           MOVE ZEROES              TO VEN-VAL-SCAP IN VEN.
           MOVE DLC-VAL-NDLC IN DLC TO VEN-VAL-FINA IN VEN.
           MOVE DLC-VAL-NDLC IN DLC TO VEN-VAL-SFIN IN VEN.
           MOVE SPACES              TO VEN-IND-CALC IN VEN.

           MOVE DLC-VAL-NDLC IN DLC TO WSS-VAL-FINA IN WSS-VARI.
           MOVE ZEROES              TO WSS-VAL-CAPI IN WSS-VARI.
           PERFORM CAL-CAPI.
           MOVE WSS-VAL-CAPI IN WSS-VARI TO VEN-VAL-CAPI IN VEN.
           MOVE WSS-VAL-CAPI IN WSS-VARI TO VEN-VAL-SCAP IN VEN.
           IF INT-IETB > SPACES
               MOVE 'N'    TO VEN-IND-CALC IN VEN
               MOVE ZEROES TO VEN-VAL-CAPI IN VEN
               MOVE ZEROES TO VEN-VAL-SCAP IN VEN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-MOD-VEN.
           EXIT.
       DEL-VEN SECTION.
       INI-DEL-VEN.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              GO TO FIN-DEL-VEN.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-DEL-VEN.
           EXIT.
       CAL-CAPI SECTION.
       INI-CAL-CAPI.
      * Llamado a rutina de calculo tasa de interes
           MOVE OPC-NUM-DCOL IN OPC     TO INT-DUNO.
           MOVE OPC-NUM-MCOL IN OPC     TO INT-MUNO.
           MOVE OPC-NUM-SCOL IN OPC     TO INT-SUNO.
           MOVE OPC-NUM-ACOL IN OPC     TO INT-AUNO.

           MOVE DLC-NUM-DMAV IN DLC     TO INT-DDOS.
           MOVE DLC-NUM-MMAV IN DLC     TO INT-MDOS.
           MOVE DLC-NUM-SMAV IN DLC     TO INT-SDOS.
           MOVE DLC-NUM-AMAV IN DLC     TO INT-ADOS.

           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.

           MOVE OPC-NUM-DCOL IN OPC     TO INT-DBTV.
           MOVE OPC-NUM-MCOL IN OPC     TO INT-MBTV.
           MOVE OPC-NUM-SCOL IN OPC     TO INT-SBTV.
           MOVE OPC-NUM-ACOL IN OPC     TO INT-ABTV.

           MOVE ICG-SGV-TINT IN DLC-FLD TO INT-TINT.
           MOVE ICG-COD-TINT IN DLC-FLD TO INT-TIPT.

           PERFORM GNS-CAL-INT
           IF INT-CMSG > SPACES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLCTINTERR  ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MEN1
               MOVE INT-CMSG       TO FRM-MEN2
               PERFORM BCK-OUT
               GO TO FIN-CAL-CAPI.
      * Calculo de Capital
           ADD 1 INT-TIPE GIVING CVI-TIPE. 
           DIVIDE WSS-VAL-FINA IN WSS-VARI BY CVI-TIPE
                                       GIVING WSS-VAL-CAPI IN WSS-VARI.
      * Ajuste de decimales
           MOVE WSS-VAL-CAPI IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           MOVE OPC-COD-VCOC IN OPC      TO PES-COD-VCAM IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-CAPI IN WSS-VARI.
       FIN-CAL-CAPI.
           EXIT.
*% END
      *>>>>
*% END
