*%! Codigo adicional para archivo COLPQPDD
*%! LARGO_MI_COMMAREA = 250
*% GNSTCA = 250
*%! PGM_PTC = TRUE
*% IF MI_COMMAREA
       COPY GNSWVNUM.
       COPY GNSWCNUM.
*% END
*% IF WSS
      *<<<<
       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSBRPTK.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTK-REQA==.
       COPY GNSBRCIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGCIC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       01  WSS-VARI.
           03 WSS-IND-ERRO              VALUE SPACES    PIC X(01).
           03 WSS-NUM-CORP              VALUE ZEROES    PIC 9(02).
           03 WSS-GLS-DATA.
              05 WSS-IND-GLS1           VALUE SPACES    PIC X(04).
              05 WSS-IND-GLS2           VALUE SPACES    PIC X(06).
              05 WSS-IND-GLS3           VALUE SPACES    PIC X(02).
       01  WSS-FRM-MEN2.
           03 WSS-CAI-MEN2                  PIC X(04).
           03 WSS-BLK1       VALUE SPACES   PIC X(03).
           03 WSS-NUM-MEN2                  PIC 9(08).
           03 WSS-BLK2       VALUE SPACES   PIC X(24).

       01  FRM-VARI.                                                    00000090
           03  FRM-I     VALUE ZEROES                  PIC 9(02).       00000120
           03  FRM-GLS-DATA.                                            00000130
               05  FRM-VEC-IFRM OCCURS 20 TIMES.                        00000140
                   07 FRM-COD-IFRM                     PIC X(02).       00000150
      *>>>>
*% END
*% IF PGM_INI
           MOVE LOW-VALUES TO PDD-EDT.
*% END
*% IF SCR_RST
           MOVE LOW-VALUES TO PDD-EDT.
*% END
*% IF FND_KEY
           IF ITK-CAI-IITK IN PDD-FLD NOT > SPACES AND
              ITK-IIC-IITK IN PDD-FLD NOT > ZEROES
              MOVE SCR-SIST                TO ITK-COD-SIST IN ITK
              MOVE ZEROES                  TO ITK-HRA-HRPR IN ITK
              MOVE 1                       TO ITK-NUM-UNIC IN ITK
              MOVE 'ITK-KEY-AITK' TO FIO-AKEY
           ELSE
              MOVE ITK-CAI-IITK IN PDD-FLD TO ITK-CAI-IITK IN ITK
              MOVE ITK-IIC-IITK IN PDD-FLD TO ITK-IIC-IITK IN ITK.
*% END
*% IF FIN_FND_KEY
      *<<<<
           IF SCR-CMND NOT = 'CON'
               GO TO FIN-FND-KEY.

           MOVE ITK-CAI-IITK IN ITK TO PTK-CAI-IITK IN PTK.
           MOVE ITK-IIC-IITK IN ITK TO PTK-IIC-IITK IN PTK.
           MOVE 1                   TO PTK-NUM-SECU IN PTK.
           MOVE ZEROES              TO PTK-NUM-CORP IN PTK.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-FND-KEY.
           PERFORM GNS-FIO-PTK.
           IF NOT (FIO-STAT-OKS AND
               ITK-CAI-IITK IN ITK = PTK-CAI-IITK IN PTK AND
               ITK-IIC-IITK IN ITK = PTK-IIC-IITK IN PTK AND
               PTK-NUM-SECU IN PTK = 1)
               MOVE PGM-STAT-ITK TO FIO-STAT
               GO TO FIN-FND-KEY.
           MOVE ZEROES TO WSS-NUM-CORP IN WSS-VARI.
           MOVE PTK-NUM-CORP IN PTK TO WSS-NUM-CORP IN WSS-VARI.
           MOVE PTK-GLS-PARA IN PTK TO
                   FRM-GLS-DATA IN PDD-FLD(WSS-NUM-CORP).
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-FND-KEY.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<<

           IF ITK-IIC-IITK IN PDD-FLD NOT > ZEROES
               MOVE 'ITCK'                  TO CIC-CAI-ICIC IN CIC
               MOVE CIC-GET TO CIC-CMND
               PERFORM PRO-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE CIC-MENS TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-CMN-ING
               ELSE
                   MOVE CIC-CAI-ICIC TO ITK-CAI-IITK IN PDD-FLD
                   MOVE CIC-IIC-ICIC TO ITK-IIC-IITK IN PDD-FLD
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'INGYES' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE CIC-CAI-ICIC TO WSS-CAI-MEN2
                   MOVE CIC-NUM-ICIC TO WSS-NUM-MEN2 IN WSS-FRM-MEN2
                   MOVE WSS-FRM-MEN2 TO FRM-MEN2.
      *>>>>
*% END
*% IF CMN_ING
      *<<<<
           MOVE SPACES                  TO ITK-GLS-FLAG IN ITK.
           MOVE SCR-SIST                TO ITK-COD-SIST IN ITK.
           MOVE HOY-HHOY                TO ITK-HRA-HRPR IN ITK.
           MOVE SPACES                  TO ITK-COD-FILL IN ITK.
           MOVE 1                       TO ITK-NUM-UNIC IN ITK.
           MOVE ZEROES                  TO ITK-VAL-OITE IN ITK.
           MOVE ZEROES                  TO ITK-VAL-TITE IN ITK.
           MOVE ZEROES                  TO ITK-VAL-TPRO IN ITK.
           MOVE SPACES                  TO ITK-COD-ETAP IN ITK.
           MOVE SPACES                  TO ITK-IND-RESP IN ITK.
           MOVE SPACES                  TO ITK-COD-RESP IN ITK.
           MOVE SPACES                  TO ITK-GLS-RESP IN ITK.
           MOVE HOY-FHOY                TO ITK-FEC-FGRA IN ITK.
           MOVE HOY-HHOY                TO ITK-HRA-HRGR IN ITK.
           MOVE ZEROES                  TO ITK-FEC-FINI IN ITK.
           MOVE ZEROES                  TO ITK-HRA-HRIN IN ITK.
           MOVE ZEROES                  TO ITK-FEC-FTER IN ITK.
           MOVE ZEROES                  TO ITK-HRA-HRTE IN ITK.
           MOVE SPACES                  TO ITK-GLS-DISP IN ITK.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *>>>>
           IF NOT (FIO-STAT-OKS)
               GO TO FIN-CMN-ING.

           MOVE 1 TO WSS-NUM-CORP IN WSS-VARI.
       LOOP-GRAB-PTK.
           IF FRM-GLS-DATA IN PDD-FLD(WSS-NUM-CORP) > SPACES
               MOVE WSS-NUM-CORP IN WSS-VARI    TO
                    PTK-NUM-CORP IN PTK
               MOVE FRM-GLS-DATA IN PDD-FLD(WSS-NUM-CORP) TO
                    PTK-GLS-PARA IN PTK
               PERFORM GRA-ENT-PTK
               IF WSS-NUM-CORP IN WSS-VARI > 20
                  GO TO FIN-CMN-ING
               ELSE
                  ADD 1 TO WSS-NUM-CORP IN WSS-VARI
                  GO TO LOOP-GRAB-PTK.
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<<
           IF SCR-CMND = 'ING'
               MOVE FRM-CPIM-AEY TO ITK-CAI-IITK-ATR IN PDD-FLD
               MOVE FRM-CPIM-AEY TO ITK-IIC-IITK-ATR IN PDD-FLD.
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<<
           IF SCR-CMND = 'ING'
               MOVE FRM-CPIM-AEY TO ITK-FEC-FPRO-ATR IN PDD-FLD.
      *>>>>
*% END
*% IF EOF
       COPY GNSBVNUM.
       COPY GNSBEGLS.
      *<<<<
       COPY GNSBFPTK.
       COPY GNSBFCIC.
       COPY GNSBGCIC.
       COPY GNSBPVRF.
       COPY COLBFOPC.
      *>>>>
*% END
*% IF EOF_PU
      *<<<<
       GRA-ENT-PTK SECTION.
       INI-GRA-ENT-PTK.
           MOVE ITK-CAI-IITK IN PDD-FLD TO PTK-CAI-IITK IN PTK.
           MOVE ITK-IIC-IITK IN PDD-FLD TO PTK-IIC-IITK IN PTK.

           MOVE SPACES                  TO PTK-GLS-FLAG IN PTK.
           MOVE 1                       TO PTK-NUM-SECU IN PTK.
           MOVE HOY-FHOY                TO PTK-FEC-FTRN IN PTK.
           MOVE HOY-HHOY                TO PTK-HRA-HRTR IN PTK.
           MOVE 'I'                     TO PTK-MSC-TACC IN PTK.
           MOVE 'I'                     TO PTK-MSC-STAT IN PTK.
           MOVE SCR-OTRN                TO PTK-COD-OTRN IN PTK.
           MOVE SCR-USER                TO PTK-COD-ATRN IN PTK.
           MOVE SPACES                  TO PTK-GLS-DISP IN PTK.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-PTK.
       FIN-GRA-ENT-PTK.
           EXIT.
      *>>>>
*% END
