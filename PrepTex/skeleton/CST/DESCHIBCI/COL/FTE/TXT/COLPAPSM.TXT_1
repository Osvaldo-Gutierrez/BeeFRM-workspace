*%! Codigo adicional para archivo
*% HDR_CST = FALSE
*% IF WSS
      *<<<< WSS
       COPY COLWGPSM.
       COPY COLBRPOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       01  WSS-VARI.
           03  WSS-I                                    PIC 9(01).
           03  WSS-J                                    PIC 9(01).
           03  WSS-IMAX               VALUE 6           PIC 9(01).
           03  WSS-IOFL               VALUE 7           PIC 9(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                         PIC X(03).
               05  WSS-COD-AOOC                         PIC X(03).
           03  WSS-COD-VCAM.
               05  WSS-COD-TVTI                         PIC X(01).
               05  WSS-COD-CVTI                         PIC X(03).
               05  WSS-COD-TCTI                         PIC X(02).
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CMND = 'CON'
               PERFORM ANL-BUS-PSM
               MOVE PSM-STAT TO PGM-STAT-PSM
           ELSE
               PERFORM ANL-KEY-PSM.
           GO TO CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CON-FND-KEY.
           MOVE PSM-COD-VCOC IN PSM-FLD TO POC-COD-VCOC IN POC.
           MOVE PSM-COD-TOOC IN PSM-FLD TO POC-COD-TOOC IN POC.
           MOVE PSM-COD-AOOC IN PSM-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           MOVE FIO-STAT TO PGM-STAT-POC.
           IF FIO-STAT-OKS
               PERFORM PUT-POC-PSM.
           MOVE PGM-STAT-PSM TO FIO-STAT.
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
           IF SCR-CMND = 'OFC' OR 'DFC'
               MOVE FRM-CPIM-AEY TO PSM-FEC-FTRN-ATR IN PSM-FLD
               MOVE FRM-CPIM-AEY TO PSM-HRA-HRTR-ATR IN PSM-FLD.
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           IF SCR-CMND = 'OFC' OR 'DFC'
               MOVE FRM-CPIM-AEY TO PSM-FEC-FTRN-ATR IN PSM-FLD
               MOVE FRM-CPIM-AEY TO PSM-HRA-HRTR-ATR IN PSM-FLD.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'OFC'
               PERFORM PRO-FLD-PSM
               MOVE FRM-CPIM-UBY TO PSM-COD-OFCB-ATR IN PSM-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO PSM-COD-OFCB-ATR IN PSM-FLD.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       COPY COLBFPOC.

       ANL-BUS-PSM SECTION.
       INI-ANL-BUS-PSM.
           MOVE SPACES                  TO PSM-COD-MENS IN PSM-VARI.
           MOVE PSM-COD-OFOC IN PSM-FLD TO PSM-COD-OFOC IN PSM-VARI.
           MOVE PSM-COD-VCOC IN PSM-FLD TO PSM-COD-VCOC IN PSM-VARI.
           MOVE PSM-COD-TOOC IN PSM-FLD TO PSM-COD-TOOC IN PSM-VARI.
           MOVE PSM-COD-AOOC IN PSM-FLD TO PSM-COD-AOOC IN PSM-VARI.
           MOVE PSM-COD-TBAN IN PSM-FLD TO PSM-COD-TBAN IN PSM-VARI.
           MOVE PSM-COD-CLCM IN PSM-FLD TO PSM-COD-CLCM IN PSM-VARI.
           MOVE PSM-NUM-DTRN IN PSM-FLD TO PSM-NUM-DTRN IN PSM-VARI.
           MOVE PSM-NUM-MTRN IN PSM-FLD TO PSM-NUM-MTRN IN PSM-VARI.
           MOVE PSM-NUM-STRN IN PSM-FLD TO PSM-NUM-STRN IN PSM-VARI.
           MOVE PSM-NUM-ATRN IN PSM-FLD TO PSM-NUM-ATRN IN PSM-VARI.
           IF PSM-HRA-HRTR IN PSM-FLD > ZEROES
               MOVE PSM-HRA-HRTR IN PSM-FLD TO PSM-HRA-HRTR IN PSM-VARI
           ELSE
               PERFORM GET-FHOY
               IF PSM-FEC-FTRN IN PSM-VARI = HOY-FHOY IN HOY-VARI
                  MOVE HOY-HHHY IN HOY-VARI TO PSM-NUM-HHTR IN PSM-VARI
                  MOVE HOY-MMHY IN HOY-VARI TO PSM-NUM-MMTR IN PSM-VARI
               ELSE
                  MOVE '2400'               TO PSM-HRA-HRTR IN PSM-VARI.
      *BUSCAR CON OFICINA,AUXILIAR,BANCA,CLASIFICACION
           PERFORM PRO-ARC-PSM.
           IF FIO-STAT-OKS
               GO TO FIN-ANL-BUS-PSM.
           MOVE PSM-COD-OFOC IN PSM-VARI TO PSM-COD-OFIX IN PSM-VARI.
      *BUSCAR CON OFICINA=*,AUXILIAR,BANCA,CLASIFICACION
           MOVE '*  '                    TO PSM-COD-OFOC IN PSM-VARI.
           PERFORM PRO-ARC-PSM.
           IF FIO-STAT-OKS
               GO TO FIN-ANL-BUS-PSM.
      *BUSCAR CON OFICINA=*,AUXILIAR=*,BANCA.CLASIFICACION
           MOVE '*  '                    TO PSM-COD-OFOC IN PSM-VARI.
           MOVE '*  '                    TO PSM-COD-AOOC IN PSM-VARI.
           PERFORM PRO-ARC-PSM.
           IF FIO-STAT-OKS
               GO TO FIN-ANL-BUS-PSM.
      *BUSCAR CON OFICINA=*,AUXILIAR=*,BANCA,CLASIFICACION=*
           MOVE '*  '               TO PSM-COD-OFOC IN PSM-VARI.
           MOVE '*  '               TO PSM-COD-AOOC IN PSM-VARI.
           MOVE '*  '               TO PSM-COD-CLCM IN PSM-VARI.
           PERFORM PRO-ARC-PSM.
           IF FIO-STAT-OKS
               GO TO FIN-ANL-BUS-PSM.
      *BUSCAR CON OFICINA=*,AUXILIAR=*,BANCA=*,CLASIFICACION=*
           MOVE '*  '               TO PSM-COD-OFOC IN PSM-VARI.
           MOVE '*  '               TO PSM-COD-AOOC IN PSM-VARI.
           MOVE '*  '               TO PSM-COD-TBAN IN PSM-VARI.
           MOVE '*  '               TO PSM-COD-CLCM IN PSM-VARI.
           PERFORM PRO-ARC-PSM.
           IF NOT FIO-STAT-OKS
               MOVE 'PSM    NEX' TO PSM-COD-MENS IN PSM-VARI.
       FIN-ANL-BUS-PSM.
           EXIT.

       PRO-ARC-PSM SECTION.
       INI-PRO-ARC-PSM.
           MOVE PSM-COD-OFOC IN PSM-VARI TO PSM-COD-OFOC IN PSM.
           MOVE PSM-COD-VCOC IN PSM-VARI TO PSM-COD-VCOC IN PSM.
           MOVE PSM-COD-TOOC IN PSM-VARI TO PSM-COD-TOOC IN PSM.
           MOVE PSM-COD-AOOC IN PSM-VARI TO PSM-COD-AOOC IN PSM.
           MOVE PSM-COD-TBAN IN PSM-VARI TO PSM-COD-TBAN IN PSM.
           MOVE PSM-COD-CLCM IN PSM-VARI TO PSM-COD-CLCM IN PSM.
           MOVE PSM-NUM-DTRN IN PSM-VARI TO PSM-NUM-DTRN IN PSM.
           MOVE PSM-NUM-MTRN IN PSM-VARI TO PSM-NUM-MTRN IN PSM.
           MOVE PSM-NUM-STRN IN PSM-VARI TO PSM-NUM-STRN IN PSM.
           MOVE PSM-NUM-ATRN IN PSM-VARI TO PSM-NUM-ATRN IN PSM.
           MOVE PSM-HRA-HRTR IN PSM-VARI TO PSM-HRA-HRTR IN PSM.
      *
           MOVE 9999 TO PSM-NUM-IPSM IN PSM.
       LUP-PRO-ARC-PSM.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-PSM
           IF FIO-STAT-OKS AND
              PSM-COD-OFOC IN PSM-VARI = PSM-COD-OFOC IN PSM AND
              PSM-COD-VCOC IN PSM-VARI = PSM-COD-VCOC IN PSM AND
              PSM-COD-TOOC IN PSM-VARI = PSM-COD-TOOC IN PSM AND
              PSM-COD-AOOC IN PSM-VARI = PSM-COD-AOOC IN PSM AND
              PSM-COD-TBAN IN PSM-VARI = PSM-COD-TBAN IN PSM AND
              PSM-COD-CLCM IN PSM-VARI = PSM-COD-CLCM IN PSM
               IF PSM-MSC-STAT IN PSM NOT = 'S'
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM COL-FIO-PSM
                   MOVE 0 TO PSM-NUM-IPSM IN PSM
                   GO TO LUP-PRO-ARC-PSM
               ELSE
               MOVE 0 TO PSM-NUM-IPSM IN PSM
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-PSM
               MOVE FIO-STAT TO PSM-STAT
               PERFORM LLE-TAB-PSM
           ELSE
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM COL-FIO-PSM
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PSM-STAT
                   GO TO SETEA-PSM-STAT
               ELSE
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PSM-STAT
                   GO TO SETEA-PSM-STAT.
       SETEA-PSM-STAT.
           MOVE PSM-STAT TO FIO-STAT.
       FIN-PRO-ARC-PSM.
           EXIT.

       ANL-KEY-PSM SECTION.
       INI-ANL-KEY-PSM.
      *    HORA DE INGRESO COMPLETA
           IF PSM-HRA-HRTR IN PSM-FLD > ZEROES
               MOVE 0 TO PSM-NUM-IPSM IN PSM
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-PSM
               IF FIO-STAT-OKS AND
                  PSM-COD-OFOC IN PSM-FLD = PSM-COD-OFOC IN PSM AND
                  PSM-COD-VCOC IN PSM-FLD = PSM-COD-VCOC IN PSM AND
                  PSM-COD-TOOC IN PSM-FLD = PSM-COD-TOOC IN PSM AND
                  PSM-COD-AOOC IN PSM-FLD = PSM-COD-AOOC IN PSM AND
                  PSM-COD-TBAN IN PSM-FLD = PSM-COD-TBAN IN PSM AND
                  PSM-COD-CLCM IN PSM-FLD = PSM-COD-CLCM IN PSM AND
                  PSM-NUM-STRN IN PSM-FLD = PSM-NUM-STRN IN PSM AND
                  PSM-NUM-ATRN IN PSM-FLD = PSM-NUM-ATRN IN PSM AND
                  PSM-NUM-MTRN IN PSM-FLD = PSM-NUM-MTRN IN PSM AND
                  PSM-NUM-DTRN IN PSM-FLD = PSM-NUM-DTRN IN PSM AND
                  PSM-NUM-IPSM IN PSM     = 1
                   MOVE FIO-STAT TO PGM-STAT-PSM
                   PERFORM LLE-TAB-PSM
               ELSE
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PGM-STAT-PSM
                   GO TO SET-PSM-STAT
           ELSE
      *        OBTENER PRIMER REGISTRO DE ESA FECHA
               MOVE ZEROES TO PSM-HRA-HRTR IN PSM
               MOVE ZEROES TO PSM-NUM-IPSM IN PSM
               IF SCR-CMND = 'OFC' OR 'DFC'
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-PSM
                   MOVE FIO-STAT TO PGM-STAT-PSM
                   GO TO SET-PSM-STAT
               ELSE
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-PSM
               IF FIO-STAT-OKS AND
                  PSM-COD-OFOC IN PSM-FLD = PSM-COD-OFOC IN PSM AND
                  PSM-COD-VCOC IN PSM-FLD = PSM-COD-VCOC IN PSM AND
                  PSM-COD-TOOC IN PSM-FLD = PSM-COD-TOOC IN PSM AND
                  PSM-COD-AOOC IN PSM-FLD = PSM-COD-AOOC IN PSM AND
                  PSM-COD-TBAN IN PSM-FLD = PSM-COD-TBAN IN PSM AND
                  PSM-COD-CLCM IN PSM-FLD = PSM-COD-CLCM IN PSM AND
                  PSM-NUM-STRN IN PSM-FLD = PSM-NUM-STRN IN PSM AND
                  PSM-NUM-ATRN IN PSM-FLD = PSM-NUM-ATRN IN PSM AND
                  PSM-NUM-MTRN IN PSM-FLD = PSM-NUM-MTRN IN PSM AND
                  PSM-NUM-DTRN IN PSM-FLD = PSM-NUM-DTRN IN PSM
                   MOVE FIO-STAT TO PGM-STAT-PSM
                   PERFORM LLE-TAB-PSM
               ELSE
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PGM-STAT-PSM.
       SET-PSM-STAT.
           MOVE PGM-STAT-PSM TO FIO-STAT.
       FIN-ANL-KEY-PSM.
           EXIT.
       LLE-TAB-PSM SECTION.
       INI-LLE-TAB-PSM.
      *
      * MUEVE MONTOS DE PRIMERA PSM (CORRELATIVO 1)
      *
           MOVE PSM-SGV-MTO1 IN PSM TO FRM-SGV-MTO1 IN PSM-FLD.
           MOVE PSM-SGV-MTO2 IN PSM TO FRM-SGV-MTO2 IN PSM-FLD.
           MOVE PSM-SGV-MTO3 IN PSM TO FRM-SGV-MTO3 IN PSM-FLD.
           MOVE PSM-SGV-MTO4 IN PSM TO FRM-SGV-MTO4 IN PSM-FLD.
           PERFORM LEE-TAB-PSM VARYING WSS-I FROM 1 BY 1
                   UNTIL (NOT FIO-STAT-OKS) OR WSS-I > WSS-IMAX.
       FIN-LLE-TAB-PSM.
           EXIT.
       LEE-TAB-PSM SECTION.
       INI-LEE-TAB-PSM.
      *
      * MUEVE VALORES A TABLA EN PANTALLA DESPUES DE LEER PSM(N)
      *
           MOVE PSM-NUM-NDIA IN PSM TO FRM-NUM-NDIA IN PSM-FLD(WSS-I).
           MOVE PSM-SGV-INT1 IN PSM TO FRM-SGV-INT1 IN PSM-FLD(WSS-I).
           MOVE PSM-SGV-INT2 IN PSM TO FRM-SGV-INT2 IN PSM-FLD(WSS-I).
           MOVE PSM-SGV-INT3 IN PSM TO FRM-SGV-INT3 IN PSM-FLD(WSS-I).
           MOVE PSM-SGV-INT4 IN PSM TO FRM-SGV-INT4 IN PSM-FLD(WSS-I).
      *     MOVE PSM-SGV-INTM IN PSM TO FRM-SGV-INTM IN PSM-FLD(WSS-I).
           MOVE PSM-NUM-DTRN IN PSM TO PSM-NUM-DTRN IN PSM-FLD.
           MOVE PSM-NUM-MTRN IN PSM TO PSM-NUM-MTRN IN PSM-FLD.
           MOVE PSM-NUM-STRN IN PSM TO PSM-NUM-STRN IN PSM-FLD.
           MOVE PSM-NUM-ATRN IN PSM TO PSM-NUM-ATRN IN PSM-FLD.
           MOVE PSM-HRA-HRTR IN PSM TO PSM-HRA-HRTR IN PSM-FLD.
           MOVE PSM-COD-OFOC IN PSM TO PSM-COD-OFOC IN PSM-FLD.
           MOVE PSM-COD-AOOC IN PSM TO PSM-COD-AOOC IN PSM-FLD.
           MOVE PSM-COD-TBAN IN PSM TO PSM-COD-TBAN IN PSM-FLD.
           MOVE PSM-COD-CLCM IN PSM TO PSM-COD-CLCM IN PSM-FLD.
           MOVE PSM-MSC-STAT IN PSM TO PSM-MSC-STAT IN PSM-FLD.
           MOVE PSM-COD-OFCB IN PSM TO PSM-COD-OFCB IN PSM-FLD.
      *HPM ini 3-MAY-1994
           MOVE PSM-NUM-DACT IN PSM TO PSM-NUM-DACT IN PSM-FLD.
           MOVE PSM-NUM-MACT IN PSM TO PSM-NUM-MACT IN PSM-FLD.
           MOVE PSM-NUM-SACT IN PSM TO PSM-NUM-SACT IN PSM-FLD.
           MOVE PSM-NUM-AACT IN PSM TO PSM-NUM-AACT IN PSM-FLD.
      *HPM fin 3-MAY-1994
           MOVE PSM-COD-ATRN IN PSM TO PSM-COD-ATRN IN PSM-FLD.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-PSM.
           IF NOT FIO-STAT-OKS
               MOVE PSM-COD-OFOC IN PSM-FLD TO PSM-COD-OFOC IN PSM
               MOVE PSM-COD-VCOC IN PSM-FLD TO PSM-COD-VCOC IN PSM
               MOVE PSM-COD-TOOC IN PSM-FLD TO PSM-COD-TOOC IN PSM
               MOVE PSM-COD-AOOC IN PSM-FLD TO PSM-COD-AOOC IN PSM
               MOVE PSM-COD-TBAN IN PSM-FLD TO PSM-COD-TBAN IN PSM
               MOVE PSM-COD-CLCM IN PSM-FLD TO PSM-COD-CLCM IN PSM
               MOVE PSM-NUM-DTRN IN PSM-FLD TO PSM-NUM-DTRN IN PSM
               MOVE PSM-NUM-MTRN IN PSM-FLD TO PSM-NUM-MTRN IN PSM
               MOVE PSM-NUM-STRN IN PSM-FLD TO PSM-NUM-STRN IN PSM
               MOVE PSM-NUM-ATRN IN PSM-FLD TO PSM-NUM-ATRN IN PSM
               MOVE PSM-HRA-HRTR IN PSM-FLD TO PSM-HRA-HRTR IN PSM
               MOVE PSM-MSC-STAT IN PSM-FLD TO PSM-MSC-STAT IN PSM
               MOVE PSM-COD-OFCB IN PSM-FLD TO PSM-COD-OFCB IN PSM
      *HPM ini 3-MAY-1994
               MOVE PSM-NUM-DACT IN PSM-FLD TO PSM-NUM-DACT IN PSM
               MOVE PSM-NUM-MACT IN PSM-FLD TO PSM-NUM-MACT IN PSM
               MOVE PSM-NUM-SACT IN PSM-FLD TO PSM-NUM-SACT IN PSM
               MOVE PSM-NUM-AACT IN PSM-FLD TO PSM-NUM-AACT IN PSM
      *HPM fin 3-MAY-1994
               MOVE PSM-COD-ATRN IN PSM-FLD TO PSM-COD-ATRN IN PSM
           ELSE
           IF NOT (PSM-COD-OFOC IN PSM-FLD = PSM-COD-OFOC IN PSM AND
                   PSM-COD-VCOC IN PSM-FLD = PSM-COD-VCOC IN PSM AND
                   PSM-COD-TOOC IN PSM-FLD = PSM-COD-TOOC IN PSM AND
                   PSM-COD-AOOC IN PSM-FLD = PSM-COD-AOOC IN PSM AND
                   PSM-COD-TBAN IN PSM-FLD = PSM-COD-TBAN IN PSM AND
                   PSM-COD-CLCM IN PSM-FLD = PSM-COD-CLCM IN PSM AND
                   PSM-NUM-STRN IN PSM-FLD = PSM-NUM-STRN IN PSM AND
                   PSM-NUM-ATRN IN PSM-FLD = PSM-NUM-ATRN IN PSM AND
                   PSM-NUM-MTRN IN PSM-FLD = PSM-NUM-MTRN IN PSM AND
                   PSM-NUM-DTRN IN PSM-FLD = PSM-NUM-DTRN IN PSM AND
                   PSM-HRA-HRTR IN PSM-FLD = PSM-HRA-HRTR IN PSM)
               MOVE PSM-COD-OFOC IN PSM-FLD TO PSM-COD-OFOC IN PSM
               MOVE PSM-COD-VCOC IN PSM-FLD TO PSM-COD-VCOC IN PSM
               MOVE PSM-COD-TOOC IN PSM-FLD TO PSM-COD-TOOC IN PSM
               MOVE PSM-COD-AOOC IN PSM-FLD TO PSM-COD-AOOC IN PSM
               MOVE PSM-COD-TBAN IN PSM-FLD TO PSM-COD-TBAN IN PSM
               MOVE PSM-COD-CLCM IN PSM-FLD TO PSM-COD-CLCM IN PSM
               MOVE PSM-NUM-DTRN IN PSM-FLD TO PSM-NUM-DTRN IN PSM
               MOVE PSM-NUM-MTRN IN PSM-FLD TO PSM-NUM-MTRN IN PSM
               MOVE PSM-NUM-STRN IN PSM-FLD TO PSM-NUM-STRN IN PSM
               MOVE PSM-NUM-ATRN IN PSM-FLD TO PSM-NUM-ATRN IN PSM
               MOVE PSM-HRA-HRTR IN PSM-FLD TO PSM-HRA-HRTR IN PSM
               MOVE PSM-MSC-STAT IN PSM-FLD TO PSM-MSC-STAT IN PSM
               MOVE PSM-COD-OFCB IN PSM-FLD TO PSM-COD-OFCB IN PSM
      *HPM ini 3-MAY-1994
               MOVE PSM-NUM-DACT IN PSM-FLD TO PSM-NUM-DACT IN PSM
               MOVE PSM-NUM-MACT IN PSM-FLD TO PSM-NUM-MACT IN PSM
               MOVE PSM-NUM-SACT IN PSM-FLD TO PSM-NUM-SACT IN PSM
               MOVE PSM-NUM-AACT IN PSM-FLD TO PSM-NUM-AACT IN PSM
      *HPM fin 3-MAY-1994
               MOVE PSM-COD-ATRN IN PSM-FLD TO PSM-COD-ATRN IN PSM
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM COL-FIO-PSM
               MOVE '23' TO FIO-STAT.
       FIN-LEE-TAB-PSM.
           EXIT.
       CLR-TAB-PSM SECTION.
       INI-CLR-TAB-PSM.
      *
      * LIMPIA VALORES DE TABLA EN PANTALLA
      *
           MOVE ZEROES              TO FRM-NUM-NDIA IN PSM-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-INT1 IN PSM-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-INT2 IN PSM-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-INT3 IN PSM-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-INT4 IN PSM-FLD(WSS-I).
      *     MOVE ZEROES              TO FRM-SGV-INTM IN PSM-FLD(WSS-I).
      *
       FIN-CLR-TAB-PSM.
           EXIT.
       PRO-FLD-PSM SECTION.
       INI-PRO-FLD-PSM.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MTO1-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MTO2-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MTO3-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MTO4-ATR IN PSM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PSM-FLD(1).
      *     MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PSM-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PSM-FLD(2).
      *      MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PSM-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PSM-FLD(3).
      *      MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PSM-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PSM-FLD(4).
      *      MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PSM-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PSM-FLD(5).
      *      MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PSM-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PSM-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PSM-FLD(6).
      *      MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PSM-FLD(6).
           PERFORM PRO-PSM-PSM.
           PERFORM PRO-POC-PSM.
       FIN-PRO-FLD-PSM.
           EXIT.
       PRO-PSM-PSM SECTION.
       INI-PRO-PSM-PSM.
           MOVE FRM-CPIM-AEY TO PSM-COD-OFCB-ATR IN PSM-FLD.
      *HPM ini 3-MAY-1994
      *    MOVE FRM-CPIM-AEY TO PSM-FEC-FACT-ATR IN PSM-FLD.
      *    MOVE FRM-CPIM-AEY TO PSM-COD-ATRN-ATR IN PSM-FLD.
      *HPM fin 3-MAY-1994
           MOVE FRM-CPIM-AEY TO PSM-MSC-STAT-ATR IN PSM-FLD.
       FIN-PRO-PSM-PSM.
           EXIT.

       PRO-POC-PSM SECTION.
       INI-PRO-POC-PSM.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-BCTI-ATR IN PSM-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-PBTI-ATR IN PSM-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-BPBT-ATR IN PSM-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-COD-CVTI-ATR IN PSM-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-TFPR-ATR IN PSM-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-NUM-PREP-ATR IN PSM-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-UTPR-ATR IN PSM-FLD.
       FIN-PRO-POC-PSM.
           EXIT.
      *>>>>
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
           PERFORM KEY-ALL-PSM.
           PERFORM MOD-REG-PSM VARYING WSS-I FROM 1 BY 1
                   UNTIL WSS-I > WSS-IMAX.
           GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           PERFORM RET-ALL-PSM.
           PERFORM RET-HDR-PSM.
           PERFORM PUT-REG-PSM VARYING WSS-I FROM 1 BY 1
                   UNTIL WSS-I > WSS-IMAX.
           GO TO FIN-CMN-ING.
      *>>>>
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI
           PERFORM KEY-ALL-PSM.
           PERFORM DEL-REG-PSM VARYING WSS-I FROM 1 BY 1
                   UNTIL WSS-I > WSS-IMAX.
           GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       COPY COLBFPOC.

       DEL-REG-PSM SECTION.
       INI-DEL-REG-PSM.
           IF SCR-CMND = 'DFC'
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               MOVE ZEROES TO PSM-NUM-IPSM IN PSM
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-PSM
               IF NOT FIO-STAT-OKS
                   GO TO FIN-DEL-REG-PSM
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM COL-FIO-PSM
                   GO TO FIN-DEL-REG-PSM.
           MOVE WSS-I IN WSS-VARI TO PSM-NUM-IPSM IN PSM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-PSM.
           IF NOT FIO-STAT-OKS
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               GO TO FIN-DEL-REG-PSM.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-PSM.
       FIN-DEL-REG-PSM.
           EXIT.

       RET-HDR-PSM SECTION.
       INI-RET-HDR-PSM.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
      *    MOVE HOY-FHOY TO PSM-FEC-FTRN IN PSM.
      *    Hora Transaccion
      *    MOVE HOY-HHOY TO PSM-HRA-HRTR IN PSM.
      *    Codigo Origen transaccion
      *
           MOVE SCR-OTRN TO PSM-COD-OTRN IN PSM.
      *    Autor Transaccion
           MOVE SCR-USER TO PSM-COD-ATRN IN PSM.
      *
           IF SCR-CCPP = 'ING'
      *        MOVE 'I' TO PSM-MSC-STAT IN PSM
               MOVE 'I' TO PSM-MSC-TACC IN PSM
           ELSE
           IF SCR-CCPP = 'MOD'
      *        MOVE 'M' TO PSM-MSC-STAT IN PSM
               MOVE 'M' TO PSM-MSC-TACC IN PSM.
       FIN-RET-HDR-PSM.
           EXIT.

       PUT-REG-PSM SECTION.
       INI-PUT-REG-PSM.
           IF SCR-CMND = 'OFC'
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               MOVE ZEROES TO PSM-NUM-IPSM IN PSM
               MOVE ZEROES TO PSM-SGV-MTO1 IN PSM
               MOVE ZEROES TO PSM-SGV-MTO2 IN PSM
               MOVE ZEROES TO PSM-SGV-MTO3 IN PSM
               MOVE ZEROES TO PSM-SGV-MTO4 IN PSM
               MOVE ZEROES TO PSM-NUM-NDIA IN PSM
               MOVE ZEROES TO PSM-SGV-INT1 IN PSM
               MOVE ZEROES TO PSM-SGV-INT2 IN PSM
               MOVE ZEROES TO PSM-SGV-INT3 IN PSM
               MOVE ZEROES TO PSM-SGV-INT4 IN PSM
               MOVE ZEROES TO PSM-SGV-INTM IN PSM
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-PSM
               GO TO FIN-PUT-REG-PSM.
           MOVE WSS-I IN WSS-VARI              TO PSM-NUM-IPSM IN PSM.
           MOVE FRM-SGV-MTO1 IN PSM-FLD        TO PSM-SGV-MTO1 IN PSM.
           MOVE FRM-SGV-MTO2 IN PSM-FLD        TO PSM-SGV-MTO2 IN PSM.
           MOVE FRM-SGV-MTO3 IN PSM-FLD        TO PSM-SGV-MTO3 IN PSM.
           MOVE FRM-SGV-MTO4 IN PSM-FLD        TO PSM-SGV-MTO4 IN PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(WSS-I) TO PSM-NUM-NDIA IN PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(WSS-I) TO PSM-SGV-INT1 IN PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(WSS-I) TO PSM-SGV-INT2 IN PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(WSS-I) TO PSM-SGV-INT3 IN PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(WSS-I) TO PSM-SGV-INT4 IN PSM.
      *    MOVE FRM-SGV-INTM IN PSM-FLD(WSS-I) TO PSM-SGV-INTM IN PSM.
           MOVE ZEROES                         TO PSM-SGV-INTM IN PSM.
      *HPM ini 3-MAY-1994
           MOVE HOY-FHOY TO PSM-FEC-FACT IN PSM.
      *HPM fin 3-MAY-1994
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-PSM.
       FIN-PUT-REG-PSM.
           EXIT.
       MOD-REG-PSM SECTION.
       INI-MOD-REG-PSM.
           IF SCR-CMND = 'OFC'
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               MOVE ZEROES TO PSM-NUM-IPSM IN PSM
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-PSM
               IF NOT FIO-STAT-OKS
                   GO TO FIN-MOD-REG-PSM
               ELSE
                   PERFORM RET-ALL-PSM
                   PERFORM RET-HDR-PSM
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-PSM
                   GO TO FIN-MOD-REG-PSM.
           MOVE WSS-I IN WSS-VARI TO PSM-NUM-IPSM IN PSM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-PSM.
           IF NOT FIO-STAT-OKS
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               GO TO FIN-MOD-REG-PSM.
           PERFORM RET-ALL-PSM.
           PERFORM RET-HDR-PSM.
           MOVE FRM-SGV-MTO1 IN PSM-FLD        TO PSM-SGV-MTO1 IN PSM.
           MOVE FRM-SGV-MTO2 IN PSM-FLD        TO PSM-SGV-MTO2 IN PSM.
           MOVE FRM-SGV-MTO3 IN PSM-FLD        TO PSM-SGV-MTO3 IN PSM.
           MOVE FRM-SGV-MTO4 IN PSM-FLD        TO PSM-SGV-MTO4 IN PSM.
           MOVE FRM-NUM-NDIA IN PSM-FLD(WSS-I) TO PSM-NUM-NDIA IN PSM.
           MOVE FRM-SGV-INT1 IN PSM-FLD(WSS-I) TO PSM-SGV-INT1 IN PSM.
           MOVE FRM-SGV-INT2 IN PSM-FLD(WSS-I) TO PSM-SGV-INT2 IN PSM.
           MOVE FRM-SGV-INT3 IN PSM-FLD(WSS-I) TO PSM-SGV-INT3 IN PSM.
           MOVE FRM-SGV-INT4 IN PSM-FLD(WSS-I) TO PSM-SGV-INT4 IN PSM.
      *     MOVE FRM-SGV-INTM IN PSM-FLD(WSS-I) TO PSM-SGV-INTM IN PSM.
           MOVE ZEROES                         TO PSM-SGV-INTM IN PSM.
      *HPM ini 3-MAY-1994
           MOVE HOY-FHOY TO PSM-FEC-FACT IN PSM.
      *HPM fin 3-MAY-1994
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-PSM.
       FIN-MOD-REG-PSM.
           EXIT.
      *>>>>
*% END
