*%! Codigo adicional
*% PGM_PTC = TRUE
*% LARGO_TOTAL_COMMAREA = 1869
*%! INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*% INCLUDE 'GNSTXT:GNSPPPTC.TXT'
*% IF FIN_SCR_VARI
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSWGTSK.
       COPY GNSBRMSC.
       COPY GNSWGPES.
       COPY COLWGINT.
       COPY COLWGVEN.
       COPY COLWGVIN.
       COPY COLBRCOM.
       COPY SGCBRDBC.
       COPY SGCBRDCP.
       COPY COLBRVEN.
       COPY COLBRCCT.
       COPY COLBRDLC.
       COPY COLBRRDC.
       COPY COLBREVC.
       COPY COLBRICG.
       COPY COLBRITR.
       COPY COLBRRCV.
       COPY TABBRCAM.
       COPY TABWGCAM.
       COPY SGCWGGRP.
       COPY TABBRUSR.
       COPY SGCBRREC.
       COPY TABBROFI.
       COPY COLBRTOC.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       77  WSS-IFLD           PIC 9(04).
       01   WSS-VARI.
            03  WSS-CAM-SGV-VCAM                   PIC S9(06)V9(09).
            03  WSS-GLS-COCR.
                05 WSS-GLS-TOCR                          PIC X(05).
                05 WSS-GLS-FILL             VALUE SPACES PIC X(01).
                05 WSS-GLS-AOCR                          PIC X(05).
            03  WSS-VAL-TPES                             PIC 9(11).
            03  WSS-CON-VEN                              PIC 9(04).
            03  WSS-GLS-NULL                             PIC X(30).
            03  WSS-IND-VCCR                VALUE SPACES PIC X(02).
                 88  MONEDA-NO-VIGENTE      VALUE 'N '.
                 88  MONEDA-NO-EXISTENTE    VALUE ' X'.
                 88  MONEDA-NEX-NVG         VALUE 'NX'.
            03  WSS-IND-VCCR-RED REDEFINES WSS-IND-VCCR.
                 05  WSS-IND-NVIG                        PIC X(01).
                 05  WSS-IND-NEXI                        PIC X(01).
            03  WSS-I                                    PIC 9(04).
            03  WSS-IMAX                    VALUE 9      PIC 9(04).
            03  WSS-IVEN-MAS1               VALUE 0      PIC 9(03).
            03  WSS-NITM                    VALUE 0      PIC 9(03).
            03  WSS-CIC-LET                              PIC X(12).
                88  ES-LETRA                VALUE 'LTR'.
           03 WSS-LENG        VALUE 94 COMP PIC S9(04).
           03 WSS-VAL-TEMP                  PIC  S999999999999V99.
           03 WSS-VAL-SFIN                  PIC  S999999999999V99.
           03 FRM-NUM-IVCT-IDX.
              05 FRM-NUM-IVCT-LEN    COMP   PIC S9(04).
              05 FRM-NUM-IVCT-ATR           PIC  X(01).
              05 FRM-NUM-IVCT-ALF           PIC  X(3).
              05 FRM-NUM-IVCT      REDEFINES
                 FRM-NUM-IVCT-ALF           PIC  999.
              05 FRM-IND-CANC-LEN    COMP   PIC S9(04).
              05 FRM-IND-CANC-ATR           PIC  X(01).
              05 FRM-IND-CANC               PIC  X.
              05 FRM-FEC-FVEN-LEN    COMP   PIC S9(04).
              05 FRM-FEC-FVEN-ATR           PIC  X(01).
              05 FRM-FEC-FVEN.
                 07 FRM-NUM-DVEN           PIC 9(02).
                 07 FRM-NUM-MVEN           PIC 9(02).
                 07 FRM-NUM-SVEN           PIC 9(02).
                 07 FRM-NUM-AVEN           PIC 9(02).
              05 FRM-VAL-IMPC-LEN    COMP   PIC S9(04).
              05 FRM-VAL-IMPC-ATR           PIC  X(01).
              05 FRM-VAL-IMPC-ALF           PIC  X(8).
              05 FRM-VAL-IMPC      REDEFINES
                 FRM-VAL-IMPC-ALF           PIC  S9999V99.
              05 FRM-VAL-COMC-LEN    COMP   PIC S9(04).
              05 FRM-VAL-COMC-ATR           PIC  X(01).
              05 FRM-VAL-COMC-ALF           PIC  X(9).
              05 FRM-VAL-COMC      REDEFINES
                 FRM-VAL-COMC-ALF           PIC  S99999V99.
              05 FRM-VAL-INTC-LEN    COMP   PIC S9(04).
              05 FRM-VAL-INTC-ATR           PIC  X(01).
              05 FRM-VAL-INTC-ALF           PIC  X(10).
              05 FRM-VAL-INTC      REDEFINES
                 FRM-VAL-INTC-ALF           PIC  S999999V99.
              05 FRM-VAL-SCAP-LEN    COMP   PIC S9(04).
              05 FRM-VAL-SCAP-ATR           PIC  X(01).
              05 FRM-VAL-SCAP-ALF           PIC  X(12).
              05 FRM-VAL-SCAP      REDEFINES
                 FRM-VAL-SCAP-ALF           PIC  S99999999V99.
              05 FRM-VAL-TOTA-LEN    COMP   PIC S9(04).
              05 FRM-VAL-TOTA-ATR           PIC  X(01).
              05 FRM-VAL-TOTA-ALF           PIC  X(12).
              05 FRM-VAL-TOTA      REDEFINES
                 FRM-VAL-TOTA-ALF           PIC  999999999V99.
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
      *>>>>
*% END
*% IF INI_SCR_COM
      *<<<< INI_SCR_COM
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE 'GQBC'   TO QUE-TYPE.
           MOVE QUE-DEL  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE SPACES TO FRM-MENS.
           MOVE SPACES TO QBC-GLS-MENS IN QBC-FLD.
      *>>>>
*% END
*% IF SCR_GKEY_VAL_IKY
      *<<<< SCR_GKEY_VAL_IKY
           IF SCR-OFRM-SRV
              MOVE PTC-OPC-TYPE TO QUE-TYPE
              MOVE TSK-TERM-ALF TO QUE-TERM
              MOVE PTC-OPC-LENG TO QUE-LITM
              MOVE 1            TO  QUE-NITM
              MOVE QUE-GET        TO QUE-CMND
              PERFORM GNS-PRO-QUE
              IF QUE-STAT = QUE-STAT-OKS
                  MOVE QUE-ITEM TO PTC-OPC-ITEM
                  MOVE PTC-OPC-OPC-CAI-IOPC TO OPC-CAI-IOPC IN QBC-FLD
                  MOVE PTC-OPC-OPC-IIC-IOPC TO OPC-IIC-IOPC IN QBC-FLD.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
       LUP-OPC.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-QBC
               PERFORM VAL-NUM-FLD-QBC
               PERFORM SCRL-TAB-QBC
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               MOVE 'OPCIDLCNORDC' TO MSG-COD-MENS IN MSG
               GO TO MSG-FND-KEY.
           IF OPC-LIQUIDADA OR OPC-ACTIVADA
              NEXT SENTENCE
           ELSE
               MOVE 'OPCSTATINVAL' TO MSG-COD-MENS IN MSG
               GO TO MSG-FND-KEY.

           MOVE OPC-CAI-IOPC IN OPC     TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC     TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              (OPC-CAI-IOPC IN OPC = RDC-CAI-IOPC IN RDC) AND
              (OPC-IIC-IOPC IN OPC = RDC-IIC-IOPC IN RDC) AND
              (RDC-NUM-IDLC IN RDC = ZEROES)
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.           

           IF FIO-STAT-OKS AND
              (OPC-CAI-IOPC IN OPC = RDC-CAI-IOPC IN RDC) AND
              (OPC-IIC-IOPC IN OPC = RDC-IIC-IOPC IN RDC) AND
              (RDC-NUM-IDLC IN RDC = ZEROES)
              MOVE RDC-CIC-ICLI IN RDC  TO DBC-CIC-ICLI IN DBC
              MOVE FIO-GET-KEY          TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF FIO-STAT-OKS
                  NEXT SENTENCE
              ELSE
                  MOVE 'CLI    NEX' TO MSG-COD-MENS
                  GO TO MSG-FND-KEY
           ELSE
               MOVE 'CLI    NODIR' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.

           PERFORM LEE-DLC.
           IF MSG-COD-MENS > SPACES
                GO TO MSG-FND-KEY.

           PERFORM PUT-QBC.
           PERFORM PUT-TAB.

           PERFORM REC-CLI.
           PERFORM PUT-HDR-CMA.
           MOVE '00' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-OPC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
       MSG-FND-KEY.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       LEE-DLC SECTION.
       INI-LEE-DLC.
           MOVE OPC-CAI-IOPC IN OPC     TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN OPC     TO DLC-IIC-IOPC IN DLC.
           MOVE ZEROES                  TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC )
                MOVE 'DLCIDLCNEX' TO MSG-COD-MENS
                GO TO FIN-LEE-DLC.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'DOC' TO TAB-COD-TTAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE DLC-COD-TDOC IN DLC TO TAB-COD-CTAB
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE SPACES      TO  TAB-CIC-CTAB
                                    WSS-CIC-LET
           ELSE
               MOVE TAB-CIC-CTAB TO WSS-CIC-LET.
       FIN-LEE-DLC.
           EXIT.
       COPY GNSBFMSC.

       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE 'GQBC'   TO QUE-TYPE.
           MOVE QUE-DEL  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           ADD 1 OPC-NUM-IVEN IN OPC GIVING WSS-IVEN-MAS1.
           MOVE 1 TO FRM-NUM-PANT.
           MOVE LOW-VALUES TO QBC-WSS-NUM-IVCT-IDX.
           PERFORM GET-FHOY.

           MOVE 1            TO FRM-IFLD.
           MOVE ZEROES       TO VEN-NUM-IVEN IN VEN.
           MOVE OPC-CIC-IOPC TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-NLS  TO FIO-CMND.
       LUP-PUT-TAB.
           IF OPC-IND-VSTR IN OPC = 'N'
              PERFORM COL-FIO-VEN
              IF FIO-STAT-OKS AND
                 OPC-CIC-IOPC = VEN-CIC-IOPC IN VEN
                 PERFORM VAL-DLC-LET
                 IF (DLC-MSC-STAT IN DLC = 'R' OR 'C')
                    NEXT SENTENCE
                 ELSE
                    PERFORM PUT-TAB-QBC
                    PERFORM PUT-QBC-QUE
                    ADD 1 TO WSS-CON-VEN
                    ADD 1 TO FRM-IFLD
              ELSE
                    MOVE '00' TO FIO-STAT
                    GO TO FIN-PUT-TAB
           ELSE
              MOVE HOY-DHOY TO VEN-DTBS
              MOVE HOY-MHOY TO VEN-MTBS
              MOVE HOY-SHOY TO VEN-STBS
              MOVE HOY-AHOY TO VEN-ATBS
              MOVE 'S'      TO VEN-KEST
              PERFORM COL-OBT-VEN
              IF VEN-STAT-OKS AND
                 OPC-CIC-IOPC = VEN-CIC-IOPC IN VEN
                 PERFORM VAL-DLC-LET
                 IF (DLC-MSC-STAT IN DLC = 'R' OR 'C')
                    NEXT SENTENCE
                 ELSE
                    PERFORM PUT-TAB-QBC
                    PERFORM PUT-QBC-QUE
                    ADD 1 TO WSS-CON-VEN
                    ADD 1 TO FRM-IFLD
              ELSE
                    MOVE '00' TO FIO-STAT
                    GO TO FIN-PUT-TAB.

           MOVE FIO-GET-NXT  TO FIO-CMND.
           IF WSS-CON-VEN NOT < WSS-IVEN-MAS1
                MOVE 'N' TO VEN-INIT
                GO TO LUP-PUT-TAB
           ELSE
              GO TO LUP-PUT-TAB.
       FIN-PUT-TAB.
           IF WSS-NITM > WSS-IMAX
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'QBCVENDMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.

       VAL-DLC-LET SECTION.
       INI-VAL-DLC-LET.
           IF NOT ES-LETRA
                GO TO FIN-VAL-DLC-LET.
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
                  MOVE 'QBCDLCNOEXI' TO MSG-COD-MENS
                  GO TO FIN-VAL-DLC-LET.
       FIN-VAL-DLC-LET.
           EXIT.

       SCRL-TAB-QBC SECTION.
       INI-SCRL-TAB-QBC.
           MOVE SPACES TO MSG-COD-MENS.
           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-QBC.
           EXIT.

       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY FRM-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1         TO QUE-NITM.
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE 'GQBC'   TO QUE-TYPE.
           MOVE QBC-WSS-LENG TO QUE-LITM.
           MOVE QUE-GET  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MOVE 'QBCVENNONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
           MOVE QUE-ITEM TO FRM-NUM-IVCT-IDX(FRM-IFLD).
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO FRM-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1         TO QUE-NITM
               MOVE TSK-TERM-ALF TO QUE-TERM
               MOVE 'GQBC'   TO QUE-TYPE
               MOVE QBC-WSS-LENG TO QUE-LITM
               MOVE QUE-GET  TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'QBCVENDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.

       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF FRM-NUM-PANT = 1
               MOVE 'QBCVENNOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE 'GQBC'   TO QUE-TYPE.
           MOVE QBC-WSS-LENG TO QUE-LITM.
           MOVE QUE-GET  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'QBCVENNOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           MOVE QUE-ITEM TO FRM-NUM-IVCT-IDX(FRM-IFLD).
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.
           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.
           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM FRM-NUM-PANT
               MOVE 'QBCVENDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.

       PUT-TAB-QBC SECTION.
       INI-PUT-TAB-QBC.

           MOVE VEN-NUM-IVCT IN VEN TO QBC-WSS-NUM-IVCT.
           MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DVEN.
           MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MVEN.
           MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SVEN.
           MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-AVEN.
           MOVE VEN-VAL-CAPI IN VEN TO WSS-VAL-CAPI.
           MOVE VEN-VAL-FINA IN VEN TO WSS-VAL-FINA.
           IF FRM-IFLD NOT > WSS-IMAX
               MOVE QBC-WSS-NUM-IVCT-IDX TO FRM-NUM-IVCT-IDX(FRM-IFLD).

       FIN-PUT-TAB-QBC.
           EXIT.

       PUT-QBC-QUE SECTION.
       INI-PUT-QBC-QUE.
           ADD 1 TO WSS-NITM.
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE 'GQBC'   TO QUE-TYPE.
           MOVE WSS-NITM TO QUE-NITM.
           MOVE QBC-WSS-NUM-IVCT-IDX TO QUE-ITEM.
           MOVE QBC-WSS-LENG TO QUE-LITM.
           MOVE QUE-PUT  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           ADD QBC-WSS-VAL-INTC TO FRM-VAL-INTE IN QBC-FLD.
       FIN-PUT-QBC-QUE.
           EXIT.

       PUT-QBC SECTION.
       INI-PUT-QBC.

           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN QBC-FLD.
           IF OPC-COD-VCOC IN OPC > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VEXP IN QBC-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-VEXP IN QBC-FLD.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO MSC-COD-CMSC IN MSC.
           MOVE 1 TO CAM-SGV-VCAM IN CAM.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO TAB-COD-CTAB IN TAB.
           IF TAB-COD-CTAB  NOT   = OPC-COD-VCOC IN OPC AND
              MSC-COD-CMSC IN MSC = OPC-MSC-TVOC IN OPC
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VEXP IN QBC-FLD
               MOVE OPC-NUM-DCOL IN OPC TO CAM-NUM-DCAM IN CAM(1)
               MOVE OPC-NUM-MCOL IN OPC TO CAM-NUM-MCAM IN CAM(1)
               MOVE OPC-NUM-SCOL IN OPC TO CAM-NUM-SCAM IN CAM(1)
               MOVE OPC-NUM-ACOL IN OPC TO CAM-NUM-ACAM IN CAM(1)
               MOVE OPC-NUM-DCOL IN OPC TO CAM-NUM-DCAM IN CAM(2)
               MOVE OPC-NUM-MCOL IN OPC TO CAM-NUM-MCAM IN CAM(2)
               MOVE OPC-NUM-SCOL IN OPC TO CAM-NUM-SCAM IN CAM(2)
               MOVE OPC-NUM-ACOL IN OPC TO CAM-NUM-ACAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC TO CAM-COD-VCAM IN CAM(1)
               MOVE TAB-COD-CTAB IN TAB TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 1 TO CAM-SGV-VCAM IN CAM.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-CAM-SGV-VCAM IN WSS-VARI.
           MOVE OPC-NUM-DCOL IN OPC TO OPC-NUM-DCOL IN QBC-FLD.
           MOVE OPC-NUM-MCOL IN OPC TO OPC-NUM-MCOL IN QBC-FLD.
           MOVE OPC-NUM-SCOL IN OPC TO OPC-NUM-SCOL IN QBC-FLD.
           MOVE OPC-NUM-ACOL IN OPC TO OPC-NUM-ACOL IN QBC-FLD.
           MULTIPLY OPC-VAL-CRED IN OPC BY WSS-CAM-SGV-VCAM IN
                       WSS-VARI GIVING FRM-VAL-CRED IN QBC-FLD.
           MOVE OPC-COD-VCOC IN OPC     TO PES-COD-VCAM IN PES-VARI.
           MOVE FRM-VAL-CRED IN QBC-FLD TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV
           MOVE PES-SGV-ENTE IN PES-VARI TO FRM-VAL-CRED IN QBC-FLD.
           MOVE ZEROES              TO FRM-VAL-INTE IN QBC-FLD.
           PERFORM OBT-IMP-GNOT.
           PERFORM OBT-PORTES.
           MOVE OPC-VAL-GAST IN OPC TO OPC-VAL-GAST IN QBC-FLD.
           MOVE OPC-SGV-VCOM IN OPC TO OPC-SGV-VCOM IN QBC-FLD.
           MOVE OPC-VAL-SEGD IN OPC TO OPC-VAL-SEGD IN QBC-FLD.
           MOVE OPC-SGV-LIQU IN OPC TO OPC-SGV-LIQU IN QBC-FLD.

       FIN-PUT-QBC.
           EXIT.

       CAL-DPES SECTION.
       INI-CAL-DPES.
       FIN-CAL-DPES.
           EXIT.
      *------------------------------------------------------
       GET-RDE SECTION.
       INI-GET-RDE.
       FIN-GET-RDE.
           EXIT.
      *---------------------------------------------------
       CLR-FRM SECTION.
       INI-CLR-FRM.
           MOVE ZEROES              TO FRM-NUM-IVCT IN
                                           QBC-FLD(WSS-I).
           MOVE ZEROES              TO FRM-NUM-DVEN IN
                                           QBC-FLD(WSS-I).
           MOVE ZEROES              TO FRM-NUM-MVEN IN
                                           QBC-FLD(WSS-I).
           MOVE ZEROES              TO FRM-NUM-SVEN IN
                                           QBC-FLD(WSS-I).
           MOVE ZEROES              TO FRM-NUM-AVEN IN
                                           QBC-FLD(WSS-I).
           MOVE ZEROES              TO FRM-VAL-CAPI IN
                                           QBC-FLD(WSS-I).
           MOVE ZEROES              TO FRM-VAL-FINA IN
                                           QBC-FLD(WSS-I).
           MOVE ZEROES              TO FRM-VAL-SSEG IN
                                           QBC-FLD(WSS-I).
       FIN-CLR-FRM.
           EXIT.
      *------------------------------------------------------
       CLR-SCR-RDE SECTION.
       INI-CLR-SCR-RDE.
       FIN-CLR-SCR-RDE.
           EXIT.
      *-----------------------------------------------------------
       PUT-TOT-QBC SECTION.
       INI-PUT-TOT-QBC.
       FIN-PUT-TOT-QBC.
           EXIT.
      *-------------------------------------------------------
       CAL-TPES SECTION.
       INI-CAL-TPES.
       FIN-CAL-TPES.
           EXIT.

       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBBCVG.
       COPY COLBFTOC.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY COLBGVCD.
       COPY COLBGCOM.
       COPY GNSBGHOY.
       COPY SGCBGCLI.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY TABBGCAM.
       COPY GNSBGPES.
       COPY COLBGINT.
       COPY COLBGVEN.
       COPY SGCBFDBC.
       COPY COLBFDLC.
       COPY COLBFCOM.
       COPY COLBFRDC.
       COPY COLBFPIP.
       COPY COLBFVEN.
       COPY COLBFCCT.
       COPY COLBFEVC.
       COPY COLBFICG.
       COPY COLBFITR.
       COPY COLBFRCV.
       COPY GNSBGTSK.
      *>>>> EOF
*% END
