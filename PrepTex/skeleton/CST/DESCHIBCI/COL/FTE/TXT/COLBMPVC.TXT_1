*%! Codigo adicional para archivo
*% IF SETTAG
*% FNCBQ = "111002"
*% VSNBQ = "11.10.11"
*% FNCBU = "111002"
*% VSNBU = "11.10.11"
*% END
*% IF VAL_CON_FLD_PVC
      *<<<< VAL_CON_FLD_PVC
      * Valida Consistencias entre Campos.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO FRM-NUM-DHOY IN PVC-FLD.
           MOVE HOY-MHOY TO FRM-NUM-MHOY IN PVC-FLD.
           MOVE HOY-SHOY TO FRM-NUM-SHOY IN PVC-FLD.
           MOVE HOY-AHOY TO FRM-NUM-AHOY IN PVC-FLD.
      * Valida Consistencias entre Periodos.
           IF ( PVC-IND-SVMI IN PVC-FLD NOT = SPACES AND
                PVC-NUM-SVMI IN PVC-FLD = ZEROES ) OR
              ( PVC-IND-SVMI IN PVC-FLD = SPACES AND
                PVC-NUM-SVMI IN PVC-FLD NOT = ZEROES )
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'INDSVMISVMI' TO MSG-COD-MENS
                  PERFORM GET-MSG
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS

                  MOVE MSG-GLS-DESC TO CPT-STR1
                  MOVE MSG-GLS-DATA TO CPT-STR2
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO FRM-MENS

                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-CON-FLD-PVC.
           IF ( PVC-IND-SVMA IN PVC-FLD NOT = SPACES AND
                PVC-NUM-SVMA IN PVC-FLD = ZEROES ) OR
              ( PVC-IND-SVMA IN PVC-FLD = SPACES AND
                PVC-NUM-SVMA IN PVC-FLD NOT = ZEROES )
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'INDSVMASVMA' TO MSG-COD-MENS
                  PERFORM GET-MSG
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS

                  MOVE MSG-GLS-DESC TO CPT-STR1
                  MOVE MSG-GLS-DATA TO CPT-STR2
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO FRM-MENS

                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-CON-FLD-PVC.
           IF ( PVC-NUM-SVMI IN PVC-FLD > ZEROES AND
                PVC-NUM-SVMA IN PVC-FLD > ZEROES )
               MOVE PVC-IND-SVMI IN PVC-FLD TO MSC-COD-CMSC IN MSC
               MOVE PVC-NUM-SVMI IN PVC-FLD TO WSS-NUM-NFEC IN WSS-VARI
               PERFORM SUM-FEC-NFEC
               MOVE FEC-FECH TO WSS-FEC-NFE1
               MOVE PVC-IND-SVMA IN PVC-FLD TO MSC-COD-CMSC IN MSC
               MOVE PVC-NUM-SVMA IN PVC-FLD TO WSS-NUM-NFEC IN WSS-VARI
               PERFORM SUM-FEC-NFEC
               MOVE FEC-FECH TO WSS-FEC-NFE2
               PERFORM CMP-FEC-NFEC
               IF FRM-SUAR = FRM-SUAR-MAL
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'NUMSVMINORG' TO MSG-COD-MENS
                   PERFORM GET-MSG
      *             STRING MSG-GLS-DESC
      *                    MSG-GLS-DATA DELIMITED BY SIZE
      *             INTO FRM-MENS

                  MOVE MSG-GLS-DESC TO CPT-STR1
                  MOVE MSG-GLS-DATA TO CPT-STR2
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO FRM-MENS

                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   GO TO FIN-VAL-CON-FLD-PVC.
           IF ( PVC-IND-DVMI IN PVC-FLD NOT = SPACES AND
                PVC-NUM-DVMI IN PVC-FLD = ZEROES ) OR
              ( PVC-IND-DVMI IN PVC-FLD = SPACES AND
                PVC-NUM-DVMI IN PVC-FLD NOT = ZEROES )
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'INDDVMIDVMI' TO MSG-COD-MENS
                  PERFORM GET-MSG
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS

                  MOVE MSG-GLS-DESC TO CPT-STR1
                  MOVE MSG-GLS-DATA TO CPT-STR2
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO FRM-MENS

                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-CON-FLD-PVC.
           IF ( PVC-IND-DVMA IN PVC-FLD NOT = SPACES AND
                PVC-NUM-DVMA IN PVC-FLD = ZEROES ) OR
              ( PVC-IND-DVMA IN PVC-FLD = SPACES AND
                PVC-NUM-DVMA IN PVC-FLD NOT = ZEROES )
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'INDDVMADVMA' TO MSG-COD-MENS
                  PERFORM GET-MSG
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS

                  MOVE MSG-GLS-DESC TO CPT-STR1
                  MOVE MSG-GLS-DATA TO CPT-STR2
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO FRM-MENS

                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-CON-FLD-PVC.
           IF ( PVC-NUM-DVMI IN PVC-FLD > ZEROES AND
                PVC-NUM-DVMA IN PVC-FLD > ZEROES )
               MOVE PVC-IND-DVMI IN PVC-FLD TO MSC-COD-CMSC IN MSC
               MOVE PVC-NUM-DVMI IN PVC-FLD TO WSS-NUM-NFEC IN WSS-VARI
               PERFORM SUM-FEC-NFEC
               MOVE FEC-FECH TO WSS-FEC-NFE1
               MOVE PVC-IND-DVMA IN PVC-FLD TO MSC-COD-CMSC IN MSC
               MOVE PVC-NUM-DVMA IN PVC-FLD TO WSS-NUM-NFEC IN WSS-VARI
               PERFORM SUM-FEC-NFEC
               MOVE FEC-FECH TO WSS-FEC-NFE2
               PERFORM CMP-FEC-NFEC
               IF FRM-SUAR = FRM-SUAR-MAL
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'NUMDVMINORG' TO MSG-COD-MENS
                   PERFORM GET-MSG
      *             STRING MSG-GLS-DESC
      *                    MSG-GLS-DATA DELIMITED BY SIZE
      *             INTO FRM-MENS

                   MOVE MSG-GLS-DESC TO CPT-STR1
                   MOVE MSG-GLS-DATA TO CPT-STR2
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-MENS

                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   GO TO FIN-VAL-CON-FLD-PVC.
           IF ( PVC-IND-SPMI IN PVC-FLD NOT = SPACES AND
                PVC-NUM-SPMI IN PVC-FLD = ZEROES ) OR
              ( PVC-IND-SPMI IN PVC-FLD = SPACES AND
                PVC-NUM-SPMI IN PVC-FLD NOT = ZEROES )
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'INDSPMISPMI' TO MSG-COD-MENS
                  PERFORM GET-MSG
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS

                  MOVE MSG-GLS-DESC TO CPT-STR1
                  MOVE MSG-GLS-DATA TO CPT-STR2
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO FRM-MENS

                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-CON-FLD-PVC.
           IF ( PVC-IND-SPMA IN PVC-FLD NOT = SPACES AND
                PVC-NUM-SPMA IN PVC-FLD = ZEROES ) OR
              ( PVC-IND-SPMA IN PVC-FLD = SPACES AND
                PVC-NUM-SPMA IN PVC-FLD NOT = ZEROES )
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'INDSPMASPMA' TO MSG-COD-MENS
                  PERFORM GET-MSG
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS

                  MOVE MSG-GLS-DESC TO CPT-STR1
                  MOVE MSG-GLS-DATA TO CPT-STR2
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO FRM-MENS

                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-CON-FLD-PVC.
           IF ( PVC-NUM-SPMI IN PVC-FLD > ZEROES AND
                PVC-NUM-SPMA IN PVC-FLD > ZEROES )
               MOVE PVC-IND-SPMI IN PVC-FLD TO MSC-COD-CMSC IN MSC
               MOVE PVC-NUM-SPMI IN PVC-FLD TO WSS-NUM-NFEC IN WSS-VARI
               PERFORM SUM-FEC-NFEC
               MOVE FEC-FECH TO WSS-FEC-NFE1
               MOVE PVC-IND-SPMA IN PVC-FLD TO MSC-COD-CMSC IN MSC
               MOVE PVC-NUM-SPMA IN PVC-FLD TO WSS-NUM-NFEC IN WSS-VARI
               PERFORM SUM-FEC-NFEC
               MOVE FEC-FECH TO WSS-FEC-NFE2
               PERFORM CMP-FEC-NFEC
               IF FRM-SUAR = FRM-SUAR-MAL
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'NUMSPMINORG' TO MSG-COD-MENS
                   PERFORM GET-MSG
      *             STRING MSG-GLS-DESC
      *                    MSG-GLS-DATA DELIMITED BY SIZE
      *             INTO FRM-MENS

                  MOVE MSG-GLS-DESC TO CPT-STR1
                  MOVE MSG-GLS-DATA TO CPT-STR2
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN TO FRM-MENS

                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   GO TO FIN-VAL-CON-FLD-PVC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       CMP-FEC-NFEC SECTION.
       INI-CMP-FEC-NFEC.
           MOVE WSS-FEC-NFE1 IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-NFE2 IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-CMP-FEC-NFEC.
           EXIT.

       SUM-FEC-NFEC SECTION.
       INI-SUM-FEC-NFEC.
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           PERFORM BUS-MSC.
           IF ( MSC-CIC-CMSC = 'D' OR
                MSC-CIC-CMSC = 'M' OR
                MSC-CIC-CMSC = 'A' )
               MOVE FEC-FORM-FEC TO FEC-FORM
               PERFORM SUM-FEC-FCOL
      *        PERFORM PRO-FEC
               PERFORM CAL-FEC
           ELSE
               MOVE ZEROES TO FEC-FECH.               
       FIN-SUM-FEC-NFEC.
           EXIT.

       SUM-FEC-FCOL SECTION.
       INI-SUM-FEC-FCOL.
           MOVE FRM-NUM-DHOY IN PVC-FLD TO FEC-ITM1.
           MOVE FRM-NUM-MHOY IN PVC-FLD TO FEC-ITM2.
           MOVE FRM-NUM-SHOY IN PVC-FLD TO FEC-ITM3.
           MOVE FRM-NUM-AHOY IN PVC-FLD TO FEC-ITM4.
           IF MSC-CIC-CMSC = 'D'
               MOVE FEC-SUM-DIA              TO FEC-CMND
               MOVE WSS-NUM-NFEC IN WSS-VARI TO FEC-NDIA
           ELSE
               IF MSC-CIC-CMSC = 'M'
                   MOVE FEC-SUM-MES              TO FEC-CMND
                   MOVE WSS-NUM-NFEC IN WSS-VARI TO FEC-NMES
               ELSE
                   IF MSC-CIC-CMSC = 'A'
                       MOVE FEC-SUM-ANO             TO FEC-CMND
                       MOVE WSS-NUM-NFEC IN WSS-VARI TO FEC-NANO.
       FIN-SUM-FEC-FCOL.
           EXIT.
      *>>>>
*% END
