*%! Codigo Adicional
*% IF PIP_COD_VCOC
      *<<<< PIP_COD_VCOC
           IF PIP-COD-VCOC IN PIP-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-GLS-VCOC IN PIP-FLD(FRM-IFLD)
              GO TO FIN-VAL-PIP-COD-VCOC.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                         TO TAB-COD-SIST.
           MOVE 'VLR '                        TO TAB-COD-TTAB IN TAB.
           MOVE PIP-COD-VCOC IN PIP-FLD(FRM-IFLD) TO 
                                                 TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PIP-COD-VCOC IN PIP-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN PIP-FLD(FRM-IFLD)
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                              FRM-GLS-VCOC IN PIP-FLD(FRM-IFLD).
*% END
*% IF INI_PIP_COD_OFIC
      *<<<< INI_PIP_COD_OFIC
           IF PIP-COD-OFIC IN PIP-FLD = '*  '
              GO TO FIN-VAL-PIP-COD-OFIC.
           IF PIP-COD-OFIC IN PIP-FLD = '   '
           AND SCR-CMND = 'CON'
              GO TO FIN-VAL-PIP-COD-OFIC.
      *>>>>
*% END
*% IF INI_PIP_FEC_FPLA
      *<<<< INI_PIP_FEC_FPLA
           IF  PIP-FEC-FPLA IN PIP-FLD = ZEROES
           AND SCR-CMND = 'CON' 
              GO TO FIN-VAL-PIP-FEC-FPLA.
           IF PIP-FEC-FPLA IN PIP-FLD = 99999999
           AND SCR-CMND = 'CON' 
              GO TO FIN-VAL-PIP-FEC-FPLA.
      *>>>>
*% END
*% IF INI_PIP_COD_IMPU
      *<<<< INI_PIP_COD_IMPU
           IF PIP-COD-IMPU IN PIP-FLD(1) NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-PIP-COD-IMPU.

           IF PIP-COD-IMPU IN PIP-FLD(FRM-IFLD) NOT > SPACES
              GO TO FIN-VAL-PIP-COD-IMPU.
      *>>>>
*% END
*% IF INI_PIP_COD_CONC
      *<<<< INI_PIP_COD_CONC
           IF PIP-COD-CONC IN PIP-FLD(FRM-IFLD) NOT > SPACES AND
              PIP-COD-IMPU IN PIP-FLD(FRM-IFLD) > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-PIP-COD-CONC.

           IF PIP-COD-CONC IN PIP-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO PIP-COD-CONC IN PIP-FLD(FRM-IFLD)
              GO TO FIN-VAL-PIP-COD-CONC.
      *>>>>
*% END
*% IF INI_PIP_COD_SUBC
      *<<<< INI_PIP_COD_SUBC
           IF PIP-COD-SUBC IN PIP-FLD(FRM-IFLD) NOT > SPACES
              GO TO FIN-VAL-PIP-COD-SUBC.
      *>>>>
*% END
*% IF VAL_CON_FLD_PIP
      *<<<< VAL_CON_FLD_PIP
           MOVE 'COL'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'IPT ' TO TAB-CIC-TTAB IN TAB.
           MOVE 'IMP'  TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
               ELSE
                   MOVE SPACES  TO MSG-COD-MENS 
                   MOVE TAB-COD-CTAB 
                                TO WSS-COM-TIP-IMP IN WSS-VARI
           ELSE
               MOVE 'COD    NEX' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG.

           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PIP.

      *RAA INI 12-ENE-1995
           MOVE ZEROES         TO  WSS-VAL-MANT IN WSS-VARI.
      *RAA FIN 12-ENE-1995
           MOVE SPACES         TO  WSS-COM-ANT  IN WSS-VARI.
           PERFORM VAL-CON-PIP-COD-IMPU
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > WSS-FRM-TOP
                OR FRM-SUAR = FRM-SUAR-MAL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO PIP-COD-IMPU-LEN IN PIP-FLD(FRM-IFLD)
                GO TO FIN-VAL-CON-FLD-PIP.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF DBC-IND-ICLI IN PIP-FLD = 'M'
      *ISP NO ACEPTA MULTIPLES DEUDORES INDIRECTOS PARA VERSION BCI
               MOVE 'COL'          TO TAB-COD-SIST
               MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MDIND' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                   MOVE ZEROES TO DBC-NUM-ICLI IN PIP-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN PIP-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN PIP-FLD
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'DLC    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN PIP-FLD
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'BCI    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.

      *VAL-RUT Valida Rut
           IF DBC-NUM-ICLI IN PIP-FLD NOT > ZEROES
               MOVE SPACES TO DBC-VRF-ICLI IN PIP-FLD
                              DBC-IND-ICLI IN PIP-FLD
                              DBC-GLS-ICLI IN PIP-FLD
                              PIP-CAI-ICLI IN PIP-FLD
                              PIP-IIC-ICLI IN PIP-FLD
                              GO TO FIN-VAL-DBC-VRF-ICLI.
           MOVE DBC-NUM-ICLI IN PIP-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN PIP-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           IF MSG-COD-MENS = SPACES AND
              DBC-NUM-ICLI IN PIP-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN PIP-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN PIP-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN PIP-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO DBC-GLS-NOMC IN PIP-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN PIP-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO PIP-CAI-ICLI IN PIP-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO PIP-IIC-ICLI IN PIP-FLD

                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN PIP-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN PIP-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN PIP-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN PIP-FLD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VAL-CON-PIP-COD-IMPU SECTION.
       INI-VAL-CON-PIP-COD-IMPU.
           IF PIP-COD-IMPU IN PIP-FLD(FRM-IFLD) = SPACES
                GO TO ANT-VAL-CON-PIP-COD-IMPU.
           IF   FRM-IFLD = 1 
                  GO TO ANT-VAL-CON-PIP-COD-IMPU.
           IF   WSS-COM-ANT  IN WSS-VARI = SPACES
            AND PIP-COD-IMPU IN PIP-FLD(FRM-IFLD) NOT = SPACES
                MOVE 'COD    SPA'  TO MSG-COD-MENS
                MOVE 'COL'         TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE  FRM-SUAR-MAL TO FRM-SUAR
                MOVE MSG-GLS-DESC  TO FRM-MENS
                GO TO FIN-VAL-CON-PIP-COD-IMPU.
           IF WSS-COM-ANT IN WSS-VARI =
              PIP-COD-IMPU IN PIP-FLD(FRM-IFLD) AND
              WSS-VCOC-ANT IN WSS-VARI =
              PIP-COD-VCOC IN PIP-FLD(FRM-IFLD)
                IF PIP-VAL-MTOP IN PIP-FLD(FRM-IFLD) NOT >
                   WSS-VAL-MANT IN WSS-VARI AND
                   PIP-VAL-MTOP IN PIP-FLD(FRM-IFLD) NOT = ZEROES
                     MOVE 'MTOAPLI<ANT' TO MSG-COD-MENS
                     MOVE 'COL'         TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE FRM-SUAR-MAL  TO FRM-SUAR
                     MOVE MSG-GLS-DESC  TO FRM-MENS
                     GO TO FIN-VAL-CON-PIP-COD-IMPU.
           IF PIP-COD-IMPU IN PIP-FLD(FRM-IFLD) > SPACES AND
              PIP-COD-CONC IN PIP-FLD(FRM-IFLD) = SPACES
                     MOVE 'CPT    SPA'  TO MSG-COD-MENS
                     MOVE 'COL'         TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE FRM-SUAR-MAL  TO FRM-SUAR
                     MOVE MSG-GLS-DESC  TO FRM-MENS
                     GO TO FIN-VAL-CON-PIP-COD-IMPU.

       ANT-VAL-CON-PIP-COD-IMPU.
           MOVE PIP-COD-VCOC IN PIP-FLD(FRM-IFLD) TO
                                WSS-VCOC-ANT IN WSS-VARI.
           MOVE PIP-COD-IMPU IN PIP-FLD(FRM-IFLD) TO
                                WSS-COM-ANT  IN WSS-VARI.
           MOVE PIP-VAL-MTOP IN PIP-FLD(FRM-IFLD) TO
                                WSS-VAL-MANT IN WSS-VARI.
       FIN-VAL-CON-PIP-COD-IMPU.
           EXIT.
      *>>>>
*% END
