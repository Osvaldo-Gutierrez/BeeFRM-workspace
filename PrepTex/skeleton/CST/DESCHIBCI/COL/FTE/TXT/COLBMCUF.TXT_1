*%! Codigo adicional para archivo
*% IF FIN_CLR_KEY_CUF AND PGM_CHI AND PGM_BCI
*%! IF PGM_BU
      *<<<< FIN_CLR_KEY_CUF 
      *LRH ini 15-MAR-1994 (Memo.23-NOV-1993, punto 2)
           MOVE 1            TO CUF-NUM-IDLC IN CUF-FLD.
           MOVE FRM-CPIM-AEY TO CUF-NUM-IDLC-ATR IN CUF-FLD.
      *LRH fin 15-MAR-1994
      *>>>>
*%! END
*% END
*% IF FIN_FST_FLD_CUF AND PGM_CHI AND PGM_BCI
      *<<<< FIN_FST_FLD_CUF AND PGM_CHI AND PGM_BCI
      *LRH ini 15-MAR-1994 (Memo.23-NOV-1993, punto 2)
           MOVE  0 TO CUF-FEC-FCUF-LEN IN CUF-FLD.
           MOVE -1 TO CUF-COD-UBFD-LEN IN CUF-FLD.
      *LRH fin 15-MAR-1994
      *>>>>
*% END
*% IF FIN_PUT_DLC_CUF
      *<<<< FIN_PUT_DLC_CUF
            IF CUF-NUM-ICUF IN CUF-FLD = 1 AND
              (SCR-CCPP = 'ING' OR (SCR-CCPP = 'ACT' AND
               SCR-ACTU = SCR-ACTU-ING))
                MOVE DLC-COD-UBFD IN CUF-FLD TO CUF-COD-UFAD IN CUF-FLD
                IF CUF-COD-UFAD IN CUF-FLD > SPACES
                    PERFORM BUS-GLS-UFAD.
      *>>>>
*% END
*% IF INI_CUF_FEC_FCUF
      *<<<< INI_CUF_FEC_FCUF
           IF CUF-FEC-FCUF IN CUF-FLD NOT > ZEROES
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO CUF-NUM-DCUF IN CUF-FLD
               MOVE HOY-MHOY TO CUF-NUM-MCUF IN CUF-FLD
               MOVE HOY-SHOY TO CUF-NUM-SCUF IN CUF-FLD
               MOVE HOY-AHOY TO CUF-NUM-ACUF IN CUF-FLD
               MOVE CUF-FEC-FCUF IN CUF-FLD TO FEC-FECH.
      *AAA Valida fecha cambio ubicacion fisica sea igual a fecha de
      *    hoy 12-02-1991
           MOVE FEC-CHOY-E TO FEC-CHOY.
      *>>>>
*% END
*% IF CUF_FEC_FCUF
      *<<<< CUF_FEC_FCUF
           IF CUF-NUM-ICUF IN CUF-FLD > 1
               GO TO FCUF-VAR-CMBS.
      *    leer OPC y comparar las fechas
           MOVE CUF-CAI-IOPC IN CUF-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE CUF-IIC-IOPC IN CUF-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPE    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CUF-FEC-FCUF.
           MOVE CUF-NUM-DCUF IN CUF-FLD  TO WSS-NUM-DCOM IN WSS-VARI.
           MOVE CUF-NUM-MCUF IN CUF-FLD  TO WSS-NUM-MCOM IN WSS-VARI.
           MOVE CUF-NUM-SCUF IN CUF-FLD  TO WSS-NUM-SCOM IN WSS-VARI.
           MOVE CUF-NUM-ACUF IN CUF-FLD  TO WSS-NUM-ACOM IN WSS-VARI.
           IF WSS-FEC-FCOM IN WSS-VARI < OPC-FEC-FCOL IN OPC
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'FECFCUFFCOL<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CUF-FEC-FCUF.
       FCUF-VAR-CMBS.
      *    restar 1 al NRO-CAMBIO-ACTUAL y comparar las fechas
           SUBTRACT 1 FROM   CUF-NUM-ICUF IN CUF-FLD
                      GIVING CUF-NUM-ICUF IN CUF.
           MOVE CUF-CAI-IOPC IN CUF-FLD TO CUF-CAI-IOPC IN CUF.
           MOVE CUF-IIC-IOPC IN CUF-FLD TO CUF-IIC-IOPC IN CUF.
           MOVE CUF-NUM-IDLC IN CUF-FLD TO CUF-NUM-IDLC IN CUF.
      *     MOVE CUF-NUM-ICUF IN CUF-FLD TO CUF-NUM-ICUF IN CUF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CUF.
      *     ADD 1 TO CUF-NUM-ICUF IN CUF-FLD.
           IF FIO-STAT-OKS
               MOVE CUF-NUM-DCUF IN CUF-FLD  TO WSS-NUM-DCOM IN WSS-VARI
               MOVE CUF-NUM-MCUF IN CUF-FLD  TO WSS-NUM-MCOM IN WSS-VARI
               MOVE CUF-NUM-SCUF IN CUF-FLD  TO WSS-NUM-SCOM IN WSS-VARI
               MOVE CUF-NUM-ACUF IN CUF-FLD  TO WSS-NUM-ACOM IN WSS-VARI
               IF WSS-FEC-FCOM IN WSS-VARI < CUF-FEC-FCUF IN CUF
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'FCUFFCUFANT<' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CUF-FEC-FCUF
               ELSE
                   GO TO FIN-VAL-CUF-FEC-FCUF.
      *>>>>
*% END
*% IF INI_CUF_FEC_FING
      *<<<< INI_CUF_FEC_FING
           IF CUF-FEC-FING IN CUF-FLD NOT > ZEROES
                MOVE CUF-FEC-FCUF IN CUF-FLD TO CUF-FEC-FING IN CUF-FLD
                                                FEC-FECH.
      *AAA Valida fecha cambio contable sea igual a fecha de hoy
      *    12-02-1991
           MOVE FEC-CHOY-E TO FEC-CHOY.
      *>>>>
*% END
*% IF CUF_FEC_FING
      *<<<< CUF_FEC_FING

      *     MOVE CUF-FEC-FCUF IN CUF-FLD TO WSS-FEC-FEC1 IN WSS-VARI.
           MOVE CUF-NUM-SCUF IN CUF-FLD TO WSS-NUM-SEC1 IN WSS-VARI.
           MOVE CUF-NUM-ACUF IN CUF-FLD TO WSS-NUM-AEC1 IN WSS-VARI.
           MOVE CUF-NUM-MCUF IN CUF-FLD TO WSS-NUM-MEC1 IN WSS-VARI.
           MOVE CUF-NUM-DCUF IN CUF-FLD TO WSS-NUM-DEC1 IN WSS-VARI.
           
      *     MOVE CUF-FEC-FING IN CUF-FLD TO WSS-FEC-FEC2 IN WSS-VARI.
           MOVE CUF-NUM-SING IN CUF-FLD TO WSS-NUM-SEC2 IN WSS-VARI.
           MOVE CUF-NUM-AING IN CUF-FLD TO WSS-NUM-AEC2 IN WSS-VARI.
           MOVE CUF-NUM-MING IN CUF-FLD TO WSS-NUM-MEC2 IN WSS-VARI.
           MOVE CUF-NUM-DING IN CUF-FLD TO WSS-NUM-DEC2 IN WSS-VARI.

           IF WSS-FEC-FEC2 IN WSS-VARI < WSS-FEC-FEC1 IN WSS-VARI
      *GET-MSG Busca mensaje en tabla
      *        fecha nueva ubicacion < fecha ubicacion anterior
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'FECFINGFCUF<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CUF-FEC-FING.
      *>>>>
*% END
*% IF VAL_CON_FLD_CUF
      *<<<< VAL_CON_FLD_CUF
*% IF ( NOT PGM_CHI ) OR ( NOT PGM_BCI )
           IF CUF-FEC-FCUF IN CUF-FLD     > ZEROES AND
              CUF-FEC-FING IN CUF-FLD     > ZEROES
               MOVE CUF-FEC-FCUF IN CUF-FLD TO FEC-FEC1
               MOVE CUF-FEC-FING IN CUF-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'FECFCUFFING>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-CUF.
*% END
           IF CUF-COD-RCUF IN CUF-FLD > SPACES AND
              WSS-TAB-UBFD = 'OFI'
               PERFORM GNS-ERR-QUE
               MOVE EIBTRMID     TO QUE-TERM
               PERFORM GNS-BUS-OPID
               MOVE OPI-OPID     TO QUE-TYPE
               MOVE 1            TO QUE-NITM
               MOVE QUE-GET      TO QUE-CMND
               MOVE +150         TO QUE-LITM
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'NOEXISTQUEUE' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-CUF
               ELSE
                   MOVE QUE-ITEM TO WSS-ITEM IN WSS-VARI
                   IF WSS-OFIC IN WSS-VARI NOT = WSS-GLS-UFD3
                                                  IN WSS-VARI
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'OFINUBINERES' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-FLD-CUF.
      *>>>>
*% END
*% IF FIN_PUT_CUF_CUF
      *<<<< FIN_PUT_CUF_CUF
           PERFORM BUS-GLS-UFAD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE CUF-COD-UBFD IN CUF-FLD TO WSS-UBFD.
           IF WSS-TAB-UBFD NOT > SPACES
               MOVE SPACES TO FRM-GLS-UBFD IN CUF-FLD
           ELSE
           IF WSS-TAB-UBFD = 'OFI'
               MOVE WSS-COD-UBFD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE SPACES TO FRM-GLS-UBFD IN CUF-FLD
               ELSE
                   MOVE OFI-GLS-DESC IN OFI TO
                        FRM-GLS-UBFD IN CUF-FLD
            ELSE
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE WSS-TAB-UBFD TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-UBFD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBFD IN CUF-FLD.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_CUF
      *<<<< FIN_VAL_CON_IKY_CUF
           IF CUF-IIC-IOPC  IN CUF-FLD NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'IICIOPCBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               IF CUF-NUM-IDLC IN CUF-FLD NOT > ZEROES
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'VALCONKEY' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_CUF
      *<<<< INI_VAL_CON_KEY_CUF
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-CUF.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_CUF
      *<<<< FIN_VAL_CON_KEY_CUF
           IF NOT ( ( CUF-IIC-IOPC IN CUF-FLD > ZEROES   AND
                      CUF-NUM-IDLC IN CUF-FLD > ZEROES   AND
                      CUF-NUM-ICUF IN CUF-FLD > ZEROES ) OR

                    ( CUF-IIC-IOPC IN CUF-FLD     > ZEROES   AND
                      CUF-NUM-IDLC IN CUF-FLD     > ZEROES   AND
                      CUF-NUM-ICUF IN CUF-FLD NOT > ZEROES ) OR

                    ( FRM-NUM-ICLI IN CUF-FLD > ZEROES   AND 
                      FRM-NUM-IAVA IN CUF-FLD > ZEROES ) OR

                    ( FRM-NUM-ICLI IN CUF-FLD > ZEROES ) OR

                    ( FRM-NUM-IAVA IN CUF-FLD > ZEROES ) OR

                    ( FRM-GLS-NOMC IN CUF-FLD > SPACES   AND
                      FRM-GLS-NOMA IN CUF-FLD > SPACES ) OR

                    ( FRM-GLS-NOMC IN CUF-FLD > SPACES ) OR

                    ( FRM-GLS-NOMA IN CUF-FLD > SPACES ) )
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
*% END
*% IF CUF_COD_UBFD
      *<<<< CUF_COD_UBFD
           MOVE CUF-COD-UBFD IN CUF-FLD TO WSS-UBFD IN WSS-VARI.
           IF WSS-GLS-UFD9 IN WSS-VARI > SPACES
      *       AND  WSS-TAB-UBFD IN WSS-VARI = 'OFI'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'COD    INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CUF-COD-UBFD.
      * AAA Elimina validacion de cambio de ubicacion fisica a oficina
      *     original 12-02-1991.
      *     IF WSS-GLS-UFD3 IN WSS-VARI = OPC-COD-OFOC IN CUF-FLD
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'CODUBFDOFOC=' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CUF-COD-UBFD.
           IF CUF-COD-UBFD IN CUF-FLD = CUF-COD-UFAD IN CUF-FLD
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODUFADUBFD=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CUF-COD-UBFD.

       OFI-VAL-CUF-COD-UBFD.
           IF WSS-TAB-UBFD NOT = 'OFI'
               GO TO BCO-VAL-CUF-COD-UBFD.
           IF WSS-COD-UBFD IN WSS-UBFD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-CUF-COD-UBFD.
           MOVE WSS-COD-UBFD IN WSS-UBFD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-UBFD IN CUF-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-UBFD IN CUF-FLD.
           GO TO FIN-VAL-CUF-COD-UBFD.
       BCO-VAL-CUF-COD-UBFD.
           IF WSS-TAB-UBFD NOT = 'BCO'
               GO TO IVB-VAL-CUF-COD-UBFD.
           IF WSS-COD-UBFD IN WSS-UBFD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-CUF-COD-UBFD.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'BCO'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-UBFD IN WSS-UBFD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              WSS-COD-UBFD IN WSS-UBFD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBFD IN CUF-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UBFD IN CUF-FLD.
           GO TO FIN-VAL-CUF-COD-UBFD.
       IVB-VAL-CUF-COD-UBFD.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'IVB' TO TAB-COD-TTAB IN TAB.
           MOVE WSS-TAB-UBFD IN WSS-UBFD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              CUF-COD-UBFD IN CUF-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBFD IN CUF-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UBFD IN CUF-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'CODUBFDIVB<>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CUF-COD-UBFD
               ELSE
                   GO TO FIN-VAL-CUF-COD-UBFD.
           IF WSS-COD-UBFD IN WSS-UBFD NOT > SPACES
               PERFORM ERR-GLS                    
               GO TO FIN-VAL-CUF-COD-UBFD.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE WSS-TAB-UBFD IN WSS-UBFD TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-UBFD IN WSS-UBFD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-TAB.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              WSS-COD-UBFD IN WSS-UBFD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBFD IN CUF-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UBFD IN CUF-FLD.
      *>>>>
*% END
