           IF PGM-STAT-CAN-OKS
      *BUS-TAB busca glosa de codigo en tabla
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'CNC'               TO TAB-COD-TTAB IN TAB
               MOVE CAN-MSC-CANC IN CAN TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-CCNC
               MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-CANC
           ELSE
               IF NOT (( SCR-CCPP = 'ACT' AND
                  SCR-ACTU = SCR-ACTU-ING ) OR
                  ( SCR-CCPP = 'ING' ))
                   GO TO FIN-FND-KEY.
           IF SCR-MSC-TCAN = 'C'
               GO TO NOT-FND-ROV.
           MOVE CAN-CIC-IOPC IN CAN TO ROV-CIC-IOPV IN ROV.
           MOVE CAN-NUM-ICAN IN CAN TO ROV-NUM-IVCT IN ROV.
           MOVE 'ROV-KEY-IVCT' TO FIO-AKEY.
      *LRH ini  09-JUN-1994   (Compatibilidad VSAM)
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT (FIO-STAT-OKS AND
                   CAN-CIC-IOPC IN CAN = ROV-CIC-IOPV IN ROV AND
                   CAN-NUM-ICAN IN CAN = ROV-NUM-IVCT IN ROV)
               MOVE '23' TO FIO-STAT.
      *LRH fin  09-JUN-1994
           MOVE FIO-STAT TO PGM-STAT-ROV.
           IF PGM-STAT-ROV-OKS
                MOVE ROV-CAI-IOPC IN ROV TO SCR-ROV-CAI-IOPC
                MOVE ROV-IIC-IOPC IN ROV TO SCR-ROV-IIC-IOPC
           ELSE
               GO TO NOT-FND-ROV.
           MOVE 'ROV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = ROV-CIC-IOPV IN ROV AND
              CAN-NUM-ICAN IN CAN = ROV-NUM-IVCT IN ROV
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'EXMULOPCXCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
           MOVE CAN-CIC-IOPC IN CAN TO ROV-CIC-IOPV IN ROV.
           MOVE CAN-NUM-ICAN IN CAN TO ROV-NUM-IVCT IN ROV.
           MOVE 'ROV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           MOVE FIO-STAT TO PGM-STAT-ROV.
           IF PGM-STAT-ROV-OKS
                MOVE ROV-CAI-IOPC IN ROV TO SCR-ROV-CAI-IOPC
                MOVE ROV-IIC-IOPC IN ROV TO SCR-ROV-IIC-IOPC.
       NOT-FND-ROV.
           IF SCR-CCPP = 'ACT' AND NO-ASIGNE-CORRELATIVO AND
              NOT PGM-STAT-CAN-OKS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.
           IF PGM-STAT-CAN-OKS
               IF NOT PGM-STAT-RCV-OKS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY.
           IF NOT PGM-STAT-CAN-OKS AND
              ( SCR-CCPP = 'ACT' OR SCR-CCPP = 'ING' )
               PERFORM PUT-OPC-CAN
               PERFORM PUT-DBC-CAN
               PERFORM PUT-VEN-CAN
               PERFORM PUT-ROV-CAN
               PERFORM PUT-CYA-CAN
               PERFORM PUT-RCV-CAN.
       FND-RST-STAT.
           MOVE PGM-STAT-CAN TO FIO-STAT.
      *ALD/27-OCT-1988
      *DAD ini  28-NOV-1991   (Memo.25-11-91 Pto.1)
      *     IF OPC-NUM-VCVG IN OPC NOT > ZEROES AND
           IF ( OPC-NUM-VCVG IN OPC NOT > ZEROES OR
                OPC-VAL-SCRE IN OPC NOT > ZEROES ) AND
      *DAD fin  28-NOV-1991
              SCR-CMND NOT = 'REV'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    YACAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
      *
           MOVE SPACES TO MSG-COD-MENS.

           IF PGM-STAT-CAN-OKS
               IF ( CAN-MSC-STAT IN CAN = 'R' OR 'X' ) OR
                  ( ( CAN-MSC-STAT IN CAN = 'S' OR 'C' OR 'W' OR
      *JSS 7-FEB-1992, OR 'H' por (Memo.03-DIC-1991)
                      'G' OR 'H' OR 'P' ) AND SCR-CMND NOT = 'REV' )
                   IF CAN-MSC-STAT IN CAN = 'R'
                      MOVE 'CAN    REVYA' TO MSG-COD-MENS
                   ELSE
                   IF CAN-MSC-STAT IN CAN = 'X'
                      MOVE 'CAN    NCCYA' TO MSG-COD-MENS
                   ELSE
                   IF CAN-MSC-STAT IN CAN = 'S'
                      MOVE 'CAN    SAFYA' TO MSG-COD-MENS
                   ELSE
      *JSS 7-FEB-1992, OR 'H' por (Memo.03-DIC-1991)
                   IF CAN-MSC-STAT IN CAN = 'G' OR 'H'
                      MOVE 'CAN    CCTYA' TO MSG-COD-MENS
                   ELSE
                   IF CAN-MSC-STAT IN CAN = 'C'
                      IF CAN-MSC-TCAN IN CAN = 'N'
                          MOVE 'CAN    NOVYA' TO MSG-COD-MENS
                      ELSE
                          IF CAN-MSC-TCAN IN CAN = 'R'
                              MOVE 'CAN    RENYA' TO MSG-COD-MENS
                          ELSE
                              MOVE 'CAN    PROYA' TO MSG-COD-MENS
                   ELSE
                   IF CAN-MSC-STAT IN CAN = 'W' OR 'P'
                      MOVE 'CAN    ALLYA' TO MSG-COD-MENS.

           IF MSG-COD-MENS > SPACES
              GO TO VRF-STAT-CANC.

           IF ( SCR-CCPP = 'ING' OR 'MOD' OR 'ACT' OR 'ELI' ) OR
              ( SCR-CMND = 'CON' )
              IF PGM-STAT-CAN-OKS
                 IF CAN-MSC-STAT IN CAN = 'A'
                     MOVE 'CAN    ACAYA' TO MSG-COD-MENS
                 ELSE
                 IF CAN-MSC-STAT IN CAN = 'E'
                     MOVE 'CAN    ACAOB' TO MSG-COD-MENS
                 ELSE
                 IF NOT ( CAN-MSC-STAT IN CAN = 'I' OR 'M' OR 'V' )
                     MOVE 'CAN    STTNN' TO MSG-COD-MENS.

           IF SCR-CMND = 'VRF'
              IF PGM-STAT-CAN-OKS
                 IF CAN-MSC-STAT IN CAN = 'V'
                     MOVE 'CAN    VRFYA' TO MSG-COD-MENS
                 ELSE
                 IF CAN-MSC-STAT IN CAN = 'L'
                     MOVE 'CAN    LIQYA' TO MSG-COD-MENS
                 ELSE
                 IF CAN-MSC-STAT IN CAN = 'A'
                     MOVE 'CAN    ACAYA' TO MSG-COD-MENS
                 ELSE
                 IF CAN-MSC-STAT IN CAN = 'E'
                     MOVE 'CAN    ACAOB' TO MSG-COD-MENS.

           IF SCR-CMND = 'REV'
              IF PGM-STAT-CAN-OKS
      *JSS 25-JUL-1991 18:16:13 PARA INHIBIR REVERSAS DE CAN EN CTA CTE.
                 IF CAN-MSC-STAT IN CAN = 'A' AND
                    SCR-CYA-IND-CCTE = 'S'
                     MOVE 'CANCCTENOREV' TO MSG-COD-MENS
                 ELSE
      *
                 IF CAN-MSC-STAT IN CAN = 'E'
                     MOVE 'CAN    ACAOB' TO MSG-COD-MENS
                 ELSE
                 IF NOT ( CAN-MSC-STAT IN CAN = 'A' OR 'S' OR
      *JSS PARA INHIBIR REV CON G        'C' OR 'W' OR 'G' OR 'P' )
                                         'C' OR 'W'        OR 'P' )
                     MOVE 'CAN    ACANO' TO MSG-COD-MENS
                 ELSE
                 IF CAN-SGV-TPAG IN CAN < ZEROES OR
                    CAN-SGV-TREN IN CAN < ZEROES
                     MOVE 'COL'          TO TAB-COD-SIST
                     MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
                     MOVE 'BCI    REVER' TO TAB-COD-CTAB IN TAB
                     PERFORM VAL-COD
                     IF MSG-COD-MENS > SPACES
                         MOVE 'CAN    REVER' TO MSG-COD-MENS.

      *DPM ini  19-APR-1996
      *     IF SCR-CMND = 'CAN' OR 'CVC'
           IF SCR-CMND = 'CAN' OR 'CVC' OR 'CAB'
      *DPM fin  19-APR-1996
              IF PGM-STAT-CAN-OKS
                 IF CAN-MSC-STAT IN CAN = 'A'
                     MOVE 'CAN    ACAYA' TO MSG-COD-MENS
                 ELSE
                 IF CAN-MSC-STAT IN CAN = 'M' OR 'I'
                     MOVE 'CAN    VRFNO' TO MSG-COD-MENS.
       VRF-STAT-CANC.
           IF MSG-COD-MENS > SPACES
                MOVE 'COL' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MEN1
                MOVE '00' TO FIO-STAT
                MOVE SCR-STAT-CON TO SCR-STAT
                GO TO FIN-FND-KEY.

