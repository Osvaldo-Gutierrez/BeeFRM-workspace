*%! Codigo adicional para archivo
*% IF FIN_PUT_PSM_PSM
      *<<<< FIN_PUT_PSM_PSM
           IF SCR-CMND = 'CON' AND PSM-COD-OFOC IN PSM-FLD = '*  '
               MOVE SPACES TO FRM-GLS-OFOC IN PSM-FLD.
           IF SCR-CMND = 'CON' AND PSM-COD-AOOC IN PSM-FLD = '*  '
               MOVE SPACES TO FRM-GLS-AOOC IN PSM-FLD.
           IF SCR-CMND = 'CON' AND PSM-COD-TBAN IN PSM-FLD = '*  '
               MOVE SPACES TO FRM-GLS-TBAN IN PSM-FLD.
           IF SCR-CMND = 'CON' AND PSM-COD-CLCM IN PSM-FLD = '*  '
               MOVE SPACES TO FRM-GLS-CLCM IN PSM-FLD.
      *>>>>
*% END
*% IF FIN_PUT_POC_PSM
      *<<<< FIN_PUT_POC_PSM
      *BUSCA GLOSA EN TABLAS
           IF POC-COD-CVTI IN PSM-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE 'I' TO WSS-COD-TVTI
               MOVE POC-COD-CVTI IN PSM-FLD TO WSS-COD-CVTI
               MOVE POC-MSC-PBTI IN PSM-FLD TO WSS-COD-TCTI
               MOVE WSS-COD-VCAM TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF POC-COD-CVTI IN PSM-FLD > SPACES
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CVTI IN PSM-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-CVTI IN PSM-FLD.
      *BUS-MSC BUSCA GLOSA DE MISCELANEO EN TABLA
           IF POC-MSC-UTPR IN PSM-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'IPER' TO MSC-COD-TMSC IN MSC
               MOVE POC-MSC-UTPR IN PSM-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-UTPR IN PSM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UTPR IN PSM-FLD.
      *>>>>
*% END
*% IF FIN_FST_KEY_PSM
      *<<<< FIN_FST_KEY_PSM
           IF SCR-CMND = 'OFC' OR 'DFC'
               MOVE 0  TO PSM-FEC-FTRN-LEN IN PSM-FLD
               MOVE -1 TO PSM-COD-OFOC-LEN IN PSM-FLD.
      *>>>>
*% END
*% IF FIN_FST_FLD_PSM
      *<<<< FIN_FST_FLD_PSM
           IF SCR-CMND = 'OFC' OR 'DFC'
               MOVE 0  TO FRM-SGV-MTO1-LEN IN PSM-FLD
               MOVE -1 TO PSM-COD-OFCB-LEN IN PSM-FLD.
      *>>>>
*% END
*% IF INI_PSM_FEC_FTRN
      *<<<< INI_PSM_FEC_FTRN
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF PSM_FEC_FTRN
      *<<<< PSM_FEC_FTRN
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-PSM-FEC-FTRN.
           IF PSM-FEC-FTRN IN PSM-FLD NOT > ZEROES AND
              ( SCR-CMND NOT = 'OFC' AND SCR-CMND NOT = 'DFC' )
               PERFORM GET-FHOY
               MOVE HOY-DHOY IN HOY-VARI TO PSM-NUM-DTRN IN PSM-FLD
               MOVE HOY-MHOY IN HOY-VARI TO PSM-NUM-MTRN IN PSM-FLD
               MOVE HOY-SHOY IN HOY-VARI TO PSM-NUM-STRN IN PSM-FLD
               MOVE HOY-AHOY IN HOY-VARI TO PSM-NUM-ATRN IN PSM-FLD.
      *>>>>
*% END
*% IF PSM_HRA_HRTR
      *<<<< PSM_HRA_HRTR
           MOVE PSM-HRA-HRTR IN PSM-FLD TO PSM-HRA-HRTR IN PSM.
           IF PSM-NUM-HHTR IN PSM < ZEROES OR
              PSM-NUM-HHTR IN PSM > 24
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PSM-HRA-HRTR.
           IF PSM-NUM-MMTR IN PSM < ZEROES OR
              PSM-NUM-MMTR IN PSM > 60
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMMMTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PSM-HRA-HRTR.
      *>>>>
*% END
*% IF INI_PSM_COD_OFOC
      *<<<< INI_PSM_COD_OFOC
           IF ( SCR-CMND NOT = 'CON' ) AND
              ( PSM-COD-OFOC IN PSM-FLD = '*  ' )
               GO TO FIN-VAL-PSM-COD-OFOC.
      *>>>>
*% END
*% IF INI_PSM_COD_TBAN
      *<<<< INI_PSM_COD_TBAN
           IF ( SCR-CMND NOT = 'CON' ) AND
              ( PSM-COD-TBAN IN PSM-FLD = '*  ' )
               GO TO FIN-VAL-PSM-COD-TBAN.
      *>>>>
*% END
*% IF INI_PSM_COD_CLCM
      *<<<< INI_PSM_COD_CLCM
           IF ( SCR-CMND NOT = 'CON' ) AND
              ( PSM-COD-CLCM IN PSM-FLD = '*  ' )
               GO TO FIN-VAL-PSM-COD-CLCM.
      *>>>>
*% END
*% IF INI_PSM_COD_TOOC
      *<<<< INI_PSM_COD_TOOC
      * RBG/INI/31-OCT-1996
           IF PSM-COD-TOOC IN PSM-FLD = '*  '
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'NPERMITE*TIO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-PSM-COD-TOOC.
      * RBG/FIN/31-OCT-1996 
      *>>>>
*% END
*% IF PSM_COD_AOOC
      *<<<< PSM_COD_AOOC
           IF ( SCR-CMND NOT = 'CON' ) AND
              ( PSM-COD-AOOC IN PSM-FLD = '*  ' )
               GO TO FIN-VAL-PSM-COD-AOOC.
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE PSM-COD-TOOC IN PSM-FLD TO WSS-COD-TOOC IN WSS-VARI.
           MOVE PSM-COD-AOOC IN PSM-FLD TO WSS-COD-AOOC IN WSS-VARI.
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              PSM-COD-AOOC IN PSM-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN PSM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOOC IN PSM-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-PSM-COD-AOOC.
           MOVE PSM-COD-VCOC IN PSM-FLD TO POC-COD-VCOC IN POC.
           MOVE PSM-COD-TOOC IN PSM-FLD TO POC-COD-TOOC IN POC.
           MOVE PSM-COD-AOOC IN PSM-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'POC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               PERFORM EDT-FLD-PSM
               GO TO FIN-VAL-PSM-COD-AOOC.
           IF POC-MSC-STAT IN POC = 'N'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'POC    NVG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               PERFORM EDT-FLD-PSM
               GO TO FIN-VAL-PSM-COD-AOOC.
           GO TO FIN-VAL-PSM-COD-AOOC.
      *>>>>
*% END
*% IF FRM_SGV_MTO2
      *<<<< FRM_SGV_MTO2
           IF FRM-SGV-MTO2 IN PSM-FLD NOT > FRM-SGV-MTO1 IN PSM-FLD
              AND SCR-CMND NOT = 'OFC'
              AND FRM-SGV-MTO2 IN PSM-FLD > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MTOMENORANT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-MTO2.
      *>>>>
*% END
*% IF FRM_SGV_MTO3
      *<<<< FRM_SGV_MTO3
           IF FRM-SGV-MTO3 IN PSM-FLD NOT > FRM-SGV-MTO2 IN PSM-FLD
              AND SCR-CMND NOT = 'OFC'
              AND FRM-SGV-MTO3 IN PSM-FLD > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MTOMENORANT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-MTO3.
           IF FRM-SGV-MTO3 IN PSM-FLD > ZEROES
              AND SCR-CMND NOT = 'OFC'
              AND FRM-SGV-MTO2 IN PSM-FLD NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MONTOINVALI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-MTO3.
      *>>>>
*% END
*% IF FRM_SGV_MTO4
      *<<<< FRM_SGV_MTO4
           IF FRM-SGV-MTO4 IN PSM-FLD NOT > FRM-SGV-MTO3 IN PSM-FLD
              AND SCR-CMND NOT = 'OFC'
              AND FRM-SGV-MTO4 IN PSM-FLD > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MTOMENORANT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-MTO4.
           IF FRM-SGV-MTO4 IN PSM-FLD > ZEROES
              AND SCR-CMND NOT = 'OFC'
              AND FRM-SGV-MTO3 IN PSM-FLD NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MONTOINVALI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-MTO4.
      *>>>>
*% END
*% IF FRM_NUM_NDIA
      *<<<< FRM_NUM_NDIA
           IF FRM-IFLD = 1 OR
              SCR-CMND = 'OFC'
              IF FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) = ZEROES AND
                 FRM-IFLD = 1
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'DIA1NOCERO' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-NUM-NDIA
              ELSE
                  GO TO FIN-VAL-FRM-NUM-NDIA.

           SUBTRACT 1 FROM FRM-IFLD GIVING WSS-J IN WSS-VARI.
           IF FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) < FRM-NUM-NDIA IN
              PSM-FLD(WSS-J IN WSS-VARI) AND
              FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'DIAMENORANT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-NDIA.
           IF FRM-IFLD > 2 AND
              FRM-NUM-NDIA IN PSM-FLD(WSS-J IN WSS-VARI) NOT > ZEROES
              AND FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'DIAINVALIDO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-NDIA.
           IF FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) = FRM-NUM-NDIA IN
              PSM-FLD(WSS-J IN WSS-VARI) AND
              FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) NOT = ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'DIAINVALIDO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-NDIA.
      *>>>>
*% END
*% IF FRM_SGV_INT1
      *<<<< FRM_SGV_INT1
           IF FRM-IFLD = 1 OR
              SCR-CMND = 'OFC'
               GO TO FIN-VAL-FRM-SGV-INT1.
           IF FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) NOT > ZEROES
              AND FRM-SGV-INT1 IN PSM-FLD(FRM-IFLD) > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'TASAINVALID' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-INT1.
      *>>>>
*% END
*% IF FRM_SGV_INT2
      *<<<< FRM_SGV_INT2
           IF SCR-CMND = 'OFC'
               GO TO FIN-VAL-FRM-SGV-INT2.
           IF FRM-IFLD = 1
              IF FRM-SGV-MTO2 IN PSM-FLD NOT > ZEROES
                 AND FRM-SGV-INT2 IN PSM-FLD(FRM-IFLD) > ZEROES
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'TASAINVALID' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-SGV-INT2
               ELSE
                   GO TO FIN-VAL-FRM-SGV-INT2.
           IF (FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) NOT > ZEROES
              OR FRM-SGV-MTO2 IN PSM-FLD NOT > ZEROES )
              AND FRM-SGV-INT2 IN PSM-FLD(FRM-IFLD) > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'TASAINVALID' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-INT2.
      *>>>>
*% END
*% IF FRM_SGV_INT3
      *<<<< FRM_SGV_INT3
           IF SCR-CMND = 'OFC'
               GO TO FIN-VAL-FRM-SGV-INT3.
           IF FRM-IFLD = 1
              IF FRM-SGV-MTO3 IN PSM-FLD NOT > ZEROES
                 AND FRM-SGV-INT3 IN PSM-FLD(FRM-IFLD) > ZEROES
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'TASAINVALID' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-SGV-INT3
              ELSE
                  GO TO FIN-VAL-FRM-SGV-INT3.
           IF (FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) NOT > ZEROES
              OR FRM-SGV-MTO3 IN PSM-FLD NOT > ZEROES )
              AND FRM-SGV-INT3 IN PSM-FLD(FRM-IFLD) > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'TASAINVALID' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-INT3.
      *>>>>
*% END
*% IF FRM_SGV_INT4
      *<<<< FRM_SGV_INT4
           IF SCR-CMND = 'OFC'
               GO TO FIN-VAL-FRM-SGV-INT4.
           IF FRM-IFLD = 1
              IF FRM-SGV-MTO4 IN PSM-FLD NOT > ZEROES
                 AND FRM-SGV-INT4 IN PSM-FLD(FRM-IFLD) > ZEROES
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'TASAINVALID' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-SGV-INT4
              ELSE
                  GO TO FIN-VAL-FRM-SGV-INT4.
           IF (FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) NOT > ZEROES
              OR FRM-SGV-MTO4 IN PSM-FLD NOT > ZEROES )
              AND FRM-SGV-INT4 IN PSM-FLD(FRM-IFLD) > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'TASAINVALID' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-INT4.
      *>>>>
*% END
*% IF FRM_SGV_INTM
      *<<<< FRM_SGV_INTM
           IF SCR-CMND = 'OFC'
               GO TO FIN-VAL-FRM-SGV-INTM.
           IF FRM-IFLD = 1
               GO TO FIN-VAL-FRM-SGV-INTM.
           IF FRM-NUM-NDIA IN PSM-FLD(FRM-IFLD) NOT > ZEROES
              AND FRM-SGV-INTM IN PSM-FLD(FRM-IFLD) > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'TASAINVALID' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-SGV-INTM.
      *>>>>
*% END
*% IF PSM_MSC_STAT
      *<<<< PSM_MSC_STAT
           IF SCR-CMND = 'OFC'
               GO TO FIN-VAL-PSM-MSC-STAT.
      *>>>>
*% END
*% IF VAL_CON_FLD_PSM
      *<<<< VAL_CON_FLD_PSM
           IF SCR-CMND = 'OFC'
               GO TO FIN-VAL-CON-FLD-PSM.
           IF PSM-COD-AOOC IN PSM-FLD = '*  '
               GO TO FIN-VAL-CON-FLD-PSM.
           MOVE PSM-COD-VCOC IN PSM-FLD TO POC-COD-VCOC IN POC.
           MOVE PSM-COD-TOOC IN PSM-FLD TO POC-COD-TOOC IN POC.
           MOVE PSM-COD-AOOC IN PSM-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF FRM-SGV-MTO4 IN PSM-FLD > ZEROES
               IF FRM-SGV-MTO4 IN PSM-FLD < POC-VAL-CMAX IN POC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'MTO4<POCCMAX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-PSM
               ELSE
                   GO TO END-VAL-CON-FLD-PSM.
           IF FRM-SGV-MTO3 IN PSM-FLD > ZEROES
               IF FRM-SGV-MTO3 IN PSM-FLD < POC-VAL-CMAX IN POC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'MTO3<POCCMAX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-PSM
               ELSE
                   GO TO END-VAL-CON-FLD-PSM.
           IF FRM-SGV-MTO2 IN PSM-FLD > ZEROES
               IF FRM-SGV-MTO2 IN PSM-FLD < POC-VAL-CMAX IN POC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'MTO2<POCCMAX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-PSM
               ELSE
                   GO TO END-VAL-CON-FLD-PSM.
           IF FRM-SGV-MTO1 IN PSM-FLD < POC-VAL-CMAX IN POC
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MTO1<POCCMAX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PSM.
       END-VAL-CON-FLD-PSM.
           MOVE WSS-IMAX IN WSS-VARI TO WSS-I IN WSS-VARI.
       LOOP-VAL-NDIA.
           IF FRM-NUM-NDIA IN PSM-FLD(WSS-I) > ZEROES
               IF FRM-NUM-NDIA IN PSM-FLD(WSS-I) < POC-NUM-PMAX IN POC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'ULTPZO<PMAX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-PSM
               ELSE
                   GO TO FIN-VAL-CON-FLD-PSM.
           SUBTRACT 1 FROM WSS-I IN WSS-VARI.
           IF WSS-I IN WSS-VARI = 1
              IF FRM-NUM-NDIA IN PSM-FLD(WSS-I) < POC-NUM-PMAX IN POC
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'ULTPZO<PMAX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-CON-FLD-PSM
              ELSE
                  GO TO FIN-VAL-CON-FLD-PSM.
           GO TO LOOP-VAL-NDIA.
      *>>>>
*% END
