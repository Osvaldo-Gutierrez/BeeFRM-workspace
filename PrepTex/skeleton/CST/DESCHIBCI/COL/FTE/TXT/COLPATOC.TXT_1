*%! Codigo Adicional para programa
*% HDR_CST = FALSE
*% NO_TIENE_TIMESTAMP = TRUE
*% PGM_PTC = TRUE
*% IF CMT_ID
      *<<<< CMT_ID
      * ACTUALIZA ARCHIVO COLTOC EN FORMA INTERACTIVA.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY TABBRTIO.
       01  WSS-COD-TABL.
           03  WSS-COD-TTAB                      PIC X(03).
           03  WSS-COD-CTAB                      PIC X(09).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<<  WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.
      *>>>>
*% END
*% IF INI_SCR_MOD AND PGM_PU
      *<<<<
           GO TO CONT-SCR-MOD.
      *>>>>
*% END
*% IF PFS_SCR_MOD AND PGM_PU
      *<<<<
       CONT-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           PERFORM DESSCRTRL.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-INST = SCR-INST-HKY
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'TOC' TO TAB-COD-TTAB IN TAB
               PERFORM ERR-TAB.
      *>>>>
*% END
*% IF SCR_GIKY_VAL_IKY
      *<<<<
           PERFORM VAL-NUM-IKY-TOC.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
      * Busca datos en registro TIO.
           MOVE 'TIO' TO TIO-COD-TTAB IN TIO.
           MOVE TOC-COD-TOCR IN TOC-FLD TO TIO-COD-TIOP IN TIO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-TIO.
           MOVE FIO-STAT TO PGM-STAT-TIO.
           IF FIO-STAT-OKS
               IF TIO-GLS-SIST IN TIO NOT = 'COL'
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'GLSSISTNOCOL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   PERFORM PUT-TIO-TOC.
      *>>>>
*% END
*% IF PGM_PU
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING                                                 
           MOVE ZEROES TO TOC-FEC-FTRN IN TOC.                          
           MOVE ZEROES TO TOC-HRA-HRTR IN TOC.                          
      *>>>>                                                             
*% END
*% END
*% IF CMN_ING OR CMN_MOD
      *>>>>
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO TOC-NUM-DTRN IN TOC.
           MOVE HOY-MHOY TO TOC-NUM-MTRN IN TOC.
           MOVE HOY-SHOY TO TOC-NUM-STRN IN TOC.
           MOVE HOY-AHOY TO TOC-NUM-ATRN IN TOC.
      *<<<< 
*% END
*% IF FIN_HBL_IKY
      *>>>>
           MOVE '1' TO FRM-CPIM-AEY.
      *<<<< 
*% END
*% IF PGM_PQ
*% IF FIN_HBL_KEY
      *>>>>
           MOVE '1' TO FRM-CPIM-AEY.
      *<<<< 
*% END
*% END
*% IF EOF
      *<<<< EOF
       COPY TABBFTIO.
       COPY GNSBBTAB.
       COPY GNSBETAB.
      *>>>>
*% END
*% IF FIN_HBL_IKY
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
      *>>>>
*% END
*% IF FIN_HBL_KEY AND PGM_PQ
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
      *>>>>
*% END
