       ANL-CIC-IOPC SECTION.
       INI-ANL-CIC-IOPC.
           MOVE CCB-CAI-IOPC IN CCB TO OPC-CAI-IOPC IN OPC.
           MOVE CCB-IIC-IOPC IN CCB TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPCIOPCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-ANL-CIC-IOPC.
           MOVE '00' TO PGM-STAT-OPC.
           PERFORM PUT-OPC-CCB.
           MOVE CCB-CAI-IOPC IN CCB TO DLC-CAI-IOPC IN DLC.
           MOVE CCB-IIC-IOPC IN CCB TO DLC-IIC-IOPC IN DLC.
           MOVE CCB-NUM-IDLC IN CCB TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'DLCIDLCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-ANL-CIC-IOPC.
           MOVE '00' TO PGM-STAT-DLC.
           PERFORM PUT-DLC-CCB.
           PERFORM BUS-DEU-INDI.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'RDC    NOIND' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FIO-STAT-NEX TO FIO-STAT
      *         GO TO FIN-ANL-CIC-IOPC.
           PERFORM BUS-DEU-DIRE.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'RDC    NODIR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-CIC-IOPC.
           EXIT.
       BUS-DEU-INDI SECTION.
       INI-BUS-DEU-INDI.
           MOVE CCB-CIC-IOPC IN CCB TO RDC-CIC-IOPC IN RDC.
           MOVE CCB-NUM-IDLC IN CCB TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = CCB-CIC-IOPC IN CCB AND
              RDC-NUM-IDLC IN RDC = CCB-NUM-IDLC IN CCB )
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-BUS-DEU-INDI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = CCB-CIC-IOPC IN CCB AND
              RDC-NUM-IDLC IN RDC = CCB-NUM-IDLC IN CCB
               MOVE 'M'     TO FRM-IND-IAVA IN CCB-FLD
               MOVE SPACES  TO FRM-GLS-IAVA IN CCB-FLD
               MOVE ZEROES  TO FRM-NUM-IAVA IN CCB-FLD
               MOVE SPACES  TO FRM-VRF-IAVA IN CCB-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    MDIND' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-GLS-NOMC IN CCB-FLD
               GO TO FIN-BUS-DEU-INDI.
           IF FIO-STAT-OKS
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NOMA IN CCB-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-IAVA IN CCB-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-IAVA IN CCB-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-IAVA IN CCB-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-IAVA IN CCB-FLD.
      *         GO TO FIN-BUS-DEU-INDI.
       FIN-BUS-DEU-INDI.
           EXIT.
       BUS-DEU-DIRE SECTION.
       INI-BUS-DEU-DIRE.
           MOVE CCB-CIC-IOPC IN CCB TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = CCB-CIC-IOPC IN CCB AND
              RDC-NUM-IDLC IN RDC = ZEROES )
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-BUS-DEU-DIRE.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = CCB-CIC-IOPC IN CCB AND
              RDC-NUM-IDLC IN RDC = ZEROES
               MOVE 'M'     TO FRM-IND-ICLI IN CCB-FLD
               MOVE SPACES  TO FRM-GLS-ICLI IN CCB-FLD
               MOVE ZEROES  TO FRM-NUM-ICLI IN CCB-FLD
               MOVE SPACES  TO FRM-VRF-ICLI IN CCB-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    MDDIR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-GLS-NOMC IN CCB-FLD
               GO TO FIN-BUS-DEU-DIRE.
           IF FIO-STAT-OKS
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NOMC IN CCB-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN CCB-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN CCB-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN CCB-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN CCB-FLD.
      *         GO TO FIN-BUS-DEU-DIRE.
       FIN-BUS-DEU-DIRE.
           EXIT.
       BUS-COR-CCB SECTION.
       INI-BUS-COR-CCB.
           MOVE 99 TO CCB-NUM-ICCB IN CCB.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-CCB.
           IF NOT ( FIO-STAT-OKS AND
                    CCB-CAI-IOPC IN CCB-FLD = CCB-CAI-IOPC IN CCB AND
                    CCB-IIC-IOPC IN CCB-FLD = CCB-IIC-IOPC IN CCB AND
                    CCB-NUM-IDLC IN CCB-FLD = CCB-NUM-IDLC IN CCB )
               PERFORM RET-ALL-CCB
               MOVE ZEROES TO CCB-NUM-ICCB IN CCB.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO CCB-NUM-ICCB IN CCB
               MOVE CCB-NUM-ICCB IN CCB TO CCB-NUM-ICCB IN CCB-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-CCB.
           EXIT.
