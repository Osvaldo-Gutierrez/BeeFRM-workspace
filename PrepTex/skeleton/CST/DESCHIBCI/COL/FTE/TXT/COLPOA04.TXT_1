       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. COLPOA04.
       AUTHOR. BEE (RRM).
       DATE-WRITTEN. 04-03-2019 15:05:08.
      * PROGRAMA TRADUCTOR
      *
      *
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.

       WORKING-STORAGE SECTION.
      *------------------------
       77 WSS-TAG-COLPOA04           PIC X(0125) VALUE
           '<IDNPGM NOM=$COLPOA04$ VSN=$01-00$ GEN=$16-01-2019$
      -    'TMS=$E01$ FNC=$1901_05$/>'.


       01  WSS-VARI-CTE.
           03 WSS-A                 VALUE 'A'            PIC X(01).
           03 WSS-C                 VALUE 'C'            PIC X(01).
           03 WSS-L                 VALUE 'L'            PIC X(01).
           03 WSS-P                 VALUE 'P'            PIC X(01).
           03 WSS-E                 VALUE 'E'            PIC X(01).
           03 WSS-R                 VALUE 'R'            PIC X(01).
           03 WSS-S                 VALUE 'S'            PIC X(01).
           03 WSS-N                 VALUE 'N'            PIC X(01).
           03 WSS-M                 VALUE 'M'            PIC X(01).
           03 WCC-TR                VALUE 'TR'           PIC X(02).
           03 WCC-110               VALUE '110'          PIC X(03).
           03 WCC-729               VALUE '729'          PIC X(03).
           03 WSS-BNF               VALUE 'BNF'          PIC X(03).
           03 WSS-DCB               VALUE 'DCB'          PIC X(03).
           03 WSS-RET               VALUE 'RET'          PIC X(03).
           03 WSS-TER               VALUE 'TER'          PIC X(03).
           03 WSS-INT               VALUE 'INT'          PIC X(03).
           03 WSS-FLV               VALUE 'FLV'          PIC X(03).
           03 WSS-COM               VALUE 'COM'          PIC X(03).
           03 WSS-AUT               VALUE 'AUT'          PIC X(03).
           03 WSS-PAT               VALUE 'PAT'          PIC X(03).
           03 WSS-COB               VALUE 'COB'          PIC X(03).
           03 WSS-GNS               VALUE 'GNS'          PIC X(03).
           03 WSS-GIDD              VALUE 'GIDD'         PIC X(04).
           03 WSS-00                VALUE '00'           PIC X(02).
           03 WSS-23                VALUE '23'           PIC X(02).
           03 WSS-MILES-PESOS       VALUE '0991  '       PIC X(06).
           03 WSS-1                 VALUE 1              PIC 9(01).
           03 WCC-0                 VALUE '0'            PIC X(01).
           03 WCC-1                 VALUE '1'            PIC X(01).
           03 WSS-4                 VALUE 4              PIC 9(01).
           03 WSS-19                VALUE 19             PIC 9(02).
           03 WSS-999               VALUE 999            PIC 9(03).
           03 WNN-MAS3000           VALUE +3000    COMP PIC S9(04).
           03 WNN-MAS490            VALUE +490     COMP PIC S9(04).
           03 WNN-MAS507            VALUE +507     COMP PIC S9(04).
           03 WNN-MAS1025           VALUE +1025    COMP PIC S9(04).
           03 WNN-MAS1000           VALUE +1000    COMP PIC S9(04).

           03 WSS-COD-TBAN          VALUE SPACES         PIC X(03).
           03 WSS-TAB-GLS-DATA      VALUE SPACES         PIC X(60).
           03 WSS-GLS-NOMB.
              05 WSS-GLS-NOMB1      VALUE SPACES         PIC X(64).
              05 WSS-GLS-NOMB2      VALUE SPACES         PIC X(64).
           03 WSS-GLS-DCB.
              05 WSS-GLS-DCB1                            PIC X(64).
              05 WSS-GLS-DCB2                            PIC X(64).
              05 WSS-GLS-DCB3                            PIC X(64).
              05 WSS-GLS-DCB4                            PIC X(64).
           03 WSS-SGV-TCOM                         PIC 9(02)V9(04).
           03 WSS-FIO-STAT-FLV      VALUE SPACES         PIC X(02).
           03 WSS-SCR-IND-MCOM                           PIC X(01).
           03 WSS-FRM-IND-PVEZ-CAN  VALUE SPACES         PIC X(01).
           03 WSS-FRM-IND-PVEZ-OPC  VALUE SPACES         PIC X(01).
           03 WSS-MON-PESO          VALUE SPACES         PIC X(06).

           03 WCC-PT-A04            VALUE 'PT-A04'       PIC X(06).
           03 WCC-PO-A04            VALUE 'PO-A04'       PIC X(06).
           03 WCC-A04INP            VALUE 'A04INP'       PIC X(06).
           03 WCC-COLPOA04          VALUE 'COLPOA04'     PIC X(08).
           03 WCC-GNSPPIDD          VALUE 'GNSPPIDD'     PIC X(08).
           03 WCC-TP-110            VALUE 'TP-110'       PIC X(06).
           03 WCC-TP-729            VALUE 'TP-729'       PIC X(06).


       77  WSS-LOGPMA04        VALUE 'N'                 PIC X(01).
       77  WSS-IDX-TR   VALUE  ZEROES                    PIC 9(03).
       77  WSS-IDX-A04  VALUE  ZEROES                    PIC 9(03).
       77  WSS-MAX-IDX  VALUE  15                        PIC 9(03).
       77  WSS-ITEM-SEGM      VALUE ZEROES               PIC 9(03).
       77  WSS-TOT-RESP       VALUE ZEROES               PIC 9(05).


       77  WSS-ULT-REG             VALUE ZEROES          PIC 9(02).
       77  WSS-EDT-PIC-S911-V4     PIC   -99999999999999,9999.
       77  WSS-EDT-PIC-909-V4      PIC       99999999999,9999.
       77  WSS-EDT-PIC-908-V4      PIC        9999999999,9999.
       77  WSS-EDT-PIC-S908-V4     PIC       -9999999999,9999.
       77  WSS-EDT-PIC-903-V4      PIC              9999,9999.
       77  WSS-EDT-PIC-911-V4      PIC    99999999999999,9999.

       01  WSS-QUE-TR-COLA VALUE SPACES.
           03 WSS-QUE-TR-COLA-02                         PIC X(02).
           03 WSS-QUE-TR-COLA-06                         PIC X(06).

       01  WSS-TR.
           03  WSS-TR-COD-SGMT                           PIC X(00001).
           03  WSS-TR-COD-DATA                           PIC X(01024).

       01  WTS-PO.
           03  WTS-PO-COD-SGMT                           PIC X(00001).
           03  WTS-PO-COD-DATA.
               05 WTS-PO-COD-DATA-03                     PIC X(00003).
               05 WTS-QUE-TR-COLA VALUE SPACES.
                  07 WTS-QUE-TR-COLA-02                  PIC X(00002).
                  07 WTS-QUE-TR-COLA-06                  PIC X(00006).
               05 WTS-PO-COD-DATA-DISP                   PIC X(00478).

       COPY GNSWGMCS.

       COPY GNSWGSEG.
       COPY GNSWGHOY.
       COPY GNSWGTSK.
       COPY GNSWGPFG.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGSYS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGQUE.
       COPY GNSWGFRM.
       COPY GNSWVSCR.
       COPY GNSWGMX1.
       COPY GNSWGRQA.
       COPY GNSBRTAB.
       COPY GNSWVIDD.
       COPY GNSBRMSG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGELS.
       COPY GNSWGUIB.

       COPY GNSWGAMB.
       COPY GNSWGCVT.
       COPY GNSWCSXI.
       COPY GNSWGMXX.
       COPY GNSWGFEC.
       COPY GNSWINVC.
       COPY TABWGRCC.

       COPY COLBRAUT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY COLBRCYA.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY COLBRCOM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY COLBRITR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY COLBRCEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CEN-REQA==.
       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY COLBRVEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY COLBRDLC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY COLBRRDC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY SGCBRDCE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY SGCBRDCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.

       COPY COLMWA04.

      *CMB,CON
       COPY COLMW110.

      *OPC,CON
       COPY COLMW729.

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                                  PIC X(3000).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.

           MOVE SPACES TO WSS-SND.

      * RECIBO IDENTIFICACION DEL PC QUE ENVIO EL MSG.

           MOVE DFHCOMMAREA(1:EIBCALEN) TO MCS-CMA-COD-SREQ.

           MOVE MCS-CMA-COD-PT-MCS      TO PT-A04.

           PERFORM GNS-ERR-QUE.

           PERFORM GET-FHOY.


           MOVE WCC-A04INP       TO QUE-COLA.
           MOVE QUE-DEL          TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE WCC-A04INP       TO QUE-COLA.
           MOVE QUE-PUT          TO QUE-CMND.
           MOVE WNN-MAS3000      TO QUE-LITM.
           MOVE MCS-CMA-COD-SREQ TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE WCC-PT-A04       TO QUE-COLA.
           MOVE QUE-DEL          TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE WCC-PT-A04       TO QUE-COLA.
           MOVE QUE-PUT          TO QUE-CMND.
           MOVE WNN-MAS3000      TO QUE-LITM.
           MOVE PT-A04           TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           PERFORM GET-TSK-TERM.

           PERFORM CRG-IDD.

           MOVE WSS-GIDD     TO RCC-QUEU.
           MOVE TSK-TERM-ALF TO RCC-TERM.

           MOVE RCC-QIDD   TO QUE-COLA.
           MOVE RCC-QIDD   TO SCR-QIDD.
           MOVE WNN-MAS490 TO QUE-LITM.
           MOVE WNN-MAS490 TO SCR-LIDD.
           MOVE WSS-1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
                 MOVE RCC-QIDD   TO QUE-COLA
                 MOVE WNN-MAS490 TO QUE-LITM
                 MOVE IDD-REGI   TO QUE-ITEM
                 MOVE QUE-PUT    TO QUE-CMND
                 PERFORM GNS-PRO-QUE.

           PERFORM GNS-ERR-QUE.

           MOVE SCR-NOM-TCPIP TO  WSS-PTR-GLS-COLA.

           MOVE SCR-NOM-TCPIP TO WSS-PTR-COD-TYPE.

           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'COL' TO FIO-SIST.
           MOVE 'VSN'      TO TAB-COD-TTAB IN TAB.
           MOVE 'LOGPOA04' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-MSC-STAT IN TAB TO WSS-LOGPMA04.

       FIN-CRG-SGS.

           PERFORM FORM-REQS.

       FIN-MAIN.

           EXEC CICS RETURN END-EXEC.

       EXT-MAIN.
           EXIT.


       FORM-REQS SECTION.
       INI-FORM-REQS.
           MOVE ZEROES TO WSS-ITEM-SEGM.

       CIC-FORM-REQS.

           ADD  WSS-1  TO WSS-ITEM-SEGM.
           MOVE SPACES TO WTS-PO.

      *Leer TS: Contexto para COLPOA04
           MOVE WCC-PO-A04      TO QUE-COLA.
           MOVE WNN-MAS490      TO QUE-LITM.
           MOVE WSS-1           TO QUE-NITM.
           MOVE QUE-GET         TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM        TO WTS-PO
                MOVE WTS-QUE-TR-COLA TO WSS-QUE-TR-COLA.

      *Borrar TS: Contexto (ya esta cargado WTS-PO)
           MOVE WCC-PO-A04      TO QUE-COLA.
           MOVE QUE-DEL         TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *Identifica consulta OPC
           IF WTS-PO-COD-DATA-03 = WCC-729
               GO TO TS-OPC-CON.

      *Identifica consulta CMB
           IF WTS-PO-COD-DATA-03 = WCC-110
               GO TO TS-CMB-CON
           ELSE
               GO TO FIN-FORM-REQS.


      *<<<<<<<<<<<<<<<<<<    110  CMB.CON INI  <<<<<<<<<<<<<<<<<<<<<<<<

       TS-CMB-CON.

           MOVE ZEROES TO QUE-NITM.

           MOVE ZEROES TO WSS-NITM-TSPT.

       CIC-GET-TR-110.

           ADD WSS-1 TO QUE-NITM.

           MOVE QUE-NITM TO WSS-NITM-TSPT.

           MOVE WCC-TR   TO WSS-QUE-TR-COLA-02.
           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WNN-MAS1025 TO QUE-LITM.
           MOVE QUE-GET     TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                ADD WSS-1 TO WSS-TOT-RESP
                MOVE QUE-ITEM TO WSS-TR
                MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)
                GO TO CIC-GET-TR-110.


           MOVE WSS-SND TO TP-110.

           MOVE WCC-TP-110            TO QUE-COLA.
           MOVE QUE-DEL               TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE WCC-TP-110            TO QUE-COLA.
           MOVE QUE-PUT               TO QUE-CMND.
           MOVE WNN-MAS1000           TO QUE-LITM.
           MOVE TP-110                TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF TP-110-STAT = WCC-1
                GO TO FIN-FORM-REQS.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *AQUI YA TENEMOS CARGADO TP-110

      *Llenar TP-A04 con TP-110
           PERFORM LLENA-TPA04-110.

       CON-FORM-REQS-CMB.

           PERFORM BUS-ULT-ELEM.

           IF WSS-TOT-RESP < WSS-19
               ADD WSS-1 TO WSS-ULT-REG
               MOVE WSS-ULT-REG TO WSS-TOT-RESP.


           PERFORM PUT-TR-RESP VARYING WSS-IDX-TR FROM WSS-1 BY WSS-1
                               UNTIL WSS-IDX-TR > WSS-TOT-RESP.

       EXT-FORM-REQS-CMB.

           GO TO FIN-FORM-REQS.
      *
      *>>>>>>>>>>>>>>>>>>    110  CMB.CON FIN  >>>>>>>>>>>>>>>>>>>>>>>>



      *<<<<<<<<<<<<<<<<<<    729  OPC.CON INI  <<<<<<<<<<<<<<<<<<<<<<<<
      *
       TS-OPC-CON.

           MOVE ZEROES TO QUE-NITM.

           MOVE ZEROES TO WSS-NITM-TSPT.

           MOVE ZEROES TO WSS-TOT-RESP.


       CIC-GET-TR-729.

           ADD WSS-1 TO QUE-NITM.

           MOVE QUE-NITM TO WSS-NITM-TSPT.

           MOVE WCC-TR          TO WSS-QUE-TR-COLA-02.
           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE WNN-MAS1025     TO QUE-LITM.
           MOVE QUE-GET         TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                ADD WSS-1 TO WSS-TOT-RESP
                MOVE QUE-ITEM TO WSS-TR
                MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)
                GO TO CIC-GET-TR-729.


           MOVE WSS-SND TO TP-729.

           MOVE WCC-TP-729             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE WCC-TP-110             TO QUE-COLA.
           MOVE QUE-PUT                TO QUE-CMND.
           MOVE WNN-MAS1000            TO QUE-LITM.
           MOVE TP-729                 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           IF TP-729-STAT = WCC-1
                GO TO FIN-FORM-REQS.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *AQUI YA TENEMOS CARGADO TP-729

      *Llenar TP-A04 con TP-729
            PERFORM LLENA-TPA04-729.

            PERFORM BUS-ULT-ELEM.

       CON-FORM-REQS-OPC.

           IF WSS-ULT-REG < WSS-19
               ADD WSS-1 TO WSS-TOT-RESP.

           PERFORM PUT-TR-RESP VARYING WSS-IDX-TR FROM WSS-1 BY WSS-1
                               UNTIL WSS-IDX-TR > WSS-TOT-RESP.

       EXT-FORM-REQS-OPC.
      *
      *>>>>>>>>>>>>>>>>>>    729  OPC.CON FIN  >>>>>>>>>>>>>>>>>>>>>>>>

       FIN-FORM-REQS.
           EXIT.


       PUT-TR-RESP SECTION.
       INI-PUT-TR-RESP.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WNN-MAS1025 TO QUE-LITM.
           MOVE QUE-PUT     TO QUE-CMND.

           MOVE WSS-ELE-SEGS(WSS-IDX-TR) TO WSS-DATA-TSPT.
           IF WSS-IDX-TR < WSS-TOT-RESP
               MOVE WCC-0 TO WSS-INDICA-TSPT
           ELSE
               MOVE WCC-1 TO WSS-INDICA-TSPT.

           MOVE WSS-ITEM-TSPT TO QUE-ITEM.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-TR-RESP.
           EXIT.

       LLENA-TPA04-729 SECTION.
       INI-LLENA-TPA04-729.

           MOVE SPACES TO TP-A04.

           MOVE TP-729-STAT IN TP-729 TO TP-A04-STAT IN TP-A04.
           MOVE TP-729-MENS IN TP-729 TO TP-A04-MENS IN TP-A04.

           MOVE TP-729-01-OPC-MSC-TVOC IN TP-729 TO
                TP-A04-02-OPC-MSC-TVOC IN TP-A04.
           MOVE TP-729-01-OPC-COD-TOOC IN TP-729 TO
                TP-A04-02-OPC-COD-TOOC IN TP-A04.
           MOVE TP-729-01-OPC-COD-OFOC IN TP-729 TO
                TP-A04-02-OPC-COD-OFOC IN TP-A04.
           MOVE TP-729-01-OPC-CAI-IOPC IN TP-729 TO
                TP-A04-01-OPC-CAI-IOPC IN TP-A04.
           MOVE TP-729-01-OPC-IIC-IOPC IN TP-729 TO
                TP-A04-01-OPC-IIC-IOPC IN TP-A04.
           MOVE TP-729-01-FRM-GLS-TVOC IN TP-729 TO
                TP-A04-02-FRM-GLS-TVOC IN TP-A04.
           MOVE TP-729-01-FRM-GLS-TOOC IN TP-729 TO
                TP-A04-02-FRM-GLS-TOOC IN TP-A04.
           MOVE TP-729-01-FRM-GLS-OFOC IN TP-729 TO
                TP-A04-02-FRM-GLS-OFOC IN TP-A04.
           MOVE TP-729-01-CAN-CAI-IOPC IN TP-729 TO
                TP-A04-02-CAN-CAI-IOPC IN TP-A04.
           MOVE TP-729-01-CAN-IIC-IOPC IN TP-729 TO
                TP-A04-02-CAN-IIC-IOPC IN TP-A04.
           MOVE TP-729-01-DBC-GLS-NOMC IN TP-729 TO
                TP-A04-02-DBC-GLS-NOMC IN TP-A04.
           MOVE TP-729-01-RDC-IIC-ICLI IN TP-729 TO
                TP-A04-02-RDC-IIC-ICLI IN TP-A04.
           MOVE TP-729-01-CAN-NUM-ICAN IN TP-729 TO
                TP-A04-02-CAN-NUM-ICAN IN TP-A04.
           MOVE TP-729-01-DBC-NUM-ICLI IN TP-729 TO
                TP-A04-02-DBC-NUM-ICLI IN TP-A04.
           MOVE TP-729-01-DBC-VRF-ICLI IN TP-729 TO
                TP-A04-02-DBC-VRF-ICLI IN TP-A04.
           MOVE TP-729-01-DBC-IND-ICLI IN TP-729 TO
                TP-A04-02-DBC-IND-ICLI IN TP-A04.
           MOVE TP-729-01-DBC-GLS-ICLI IN TP-729 TO
                TP-A04-02-DBC-GLS-ICLI IN TP-A04.
           MOVE TP-729-01-RDC-NUM-DIRE IN TP-729 TO
                TP-A04-02-RDC-NUM-DIRE IN TP-A04.
           MOVE TP-729-01-FRM-GLS-STAT IN TP-729 TO
                TP-A04-02-FRM-GLS-STAT IN TP-A04.
           MOVE TP-729-01-OPC-COD-VCOC IN TP-729 TO
                TP-A04-02-OPC-COD-VCOC IN TP-A04.
           MOVE TP-729-01-FRM-GLS-VCOC IN TP-729 TO
                TP-A04-02-FRM-GLS-VCOC IN TP-A04.
           MOVE TP-729-01-OPC-COD-AOOC IN TP-729 TO
                TP-A04-02-OPC-COD-AOOC IN TP-A04.
           MOVE TP-729-01-FRM-GLS-AOOC IN TP-729 TO
                TP-A04-02-FRM-GLS-AOOC IN TP-A04.

           MOVE TP-729-01-OPC-VAL-CRED IN TP-729 TO
                TP-A04-02-OPC-VAL-CRED IN TP-A04.
           IF TP-A04-02-OPC-VAL-CRED IN TP-A04 > SPACES
                MOVE TP-729-01-OPC-VAL-CRED-NUM IN TP-729 TO
                     WSS-EDT-PIC-911-V4
                MOVE WSS-EDT-PIC-911-V4 TO
                     TP-A04-02-OPC-VAL-CRED IN TP-A04.

           MOVE TP-729-01-OPC-CAI-ILDC IN TP-729 TO
                TP-A04-02-OPC-CAI-ILDC IN TP-A04.
           MOVE TP-729-01-OPC-IIC-ILDC IN TP-729 TO
                TP-A04-02-OPC-IIC-ILDC IN TP-A04.
           MOVE TP-729-01-RDC-CAI-ICLI IN TP-729 TO
                TP-A04-02-RDC-CAI-ICLI IN TP-A04.

           MOVE TP-729-01-OPC-VAL-SCRE IN TP-729 TO
                TP-A04-02-OPC-VAL-SCRE IN TP-A04.
           IF TP-A04-02-OPC-VAL-SCRE IN TP-A04 > SPACES
                MOVE TP-729-01-OPC-VAL-SCRE-NUM IN TP-729 TO
                     WSS-EDT-PIC-911-V4
                MOVE WSS-EDT-PIC-911-V4 TO
                     TP-A04-02-OPC-VAL-SCRE IN TP-A04.

           MOVE TP-729-01-ROV-SGV-RENO IN TP-729 TO
                TP-A04-02-ROV-SGV-RENO IN TP-A04.
           IF TP-A04-02-ROV-SGV-RENO IN TP-A04 > SPACES
                MOVE TP-729-01-ROV-SGV-RENO-NUM IN TP-729 TO
                     WSS-EDT-PIC-911-V4
                MOVE WSS-EDT-PIC-911-V4 TO
                     TP-A04-02-ROV-SGV-RENO IN TP-A04.

           MOVE TP-729-01-OPC-NUM-VCVG IN TP-729 TO
                TP-A04-02-OPC-NUM-VCVG IN TP-A04.
           MOVE TP-729-01-OPC-IND-CTBL IN TP-729 TO
                TP-A04-02-OPC-IND-CTBL IN TP-A04.
           MOVE TP-729-01-OPC-IND-RENO IN TP-729 TO
                TP-A04-02-OPC-IND-RENO IN TP-A04.
           MOVE TP-729-01-OPC-COD-SEGD IN TP-729 TO
                TP-A04-02-OPC-COD-SEGD IN TP-A04.
           MOVE TP-729-01-OPC-CAI-ICEN IN TP-729 TO
                TP-A04-02-OPC-CAI-ICEN IN TP-A04.
           MOVE TP-729-01-OPC-IIC-ICEN IN TP-729 TO
                TP-A04-02-OPC-IIC-ICEN IN TP-A04.

           MOVE TP-729-01-OPC-VAL-SEGD IN TP-729 TO
                TP-A04-02-OPC-VAL-SEGD IN TP-A04.
           IF TP-A04-02-OPC-VAL-SEGD IN TP-A04 > SPACES
                MOVE TP-729-01-OPC-VAL-SEGD-NUM IN TP-729 TO
                     WSS-EDT-PIC-908-V4
                MOVE WSS-EDT-PIC-908-V4 TO
                     TP-A04-02-OPC-VAL-SEGD IN TP-A04.

           MOVE TP-729-01-OPC-VAL-SEGC IN TP-729 TO
                TP-A04-02-OPC-VAL-SEGC IN TP-A04.
           IF TP-A04-02-OPC-VAL-SEGC IN TP-A04 > SPACES
                MOVE TP-729-01-OPC-VAL-SEGC-NUM IN TP-729 TO
                     WSS-EDT-PIC-908-V4
                MOVE WSS-EDT-PIC-908-V4 TO
                     TP-A04-02-OPC-VAL-SEGC IN TP-A04.

           MOVE TP-729-01-OPC-FEC-FINP IN TP-729 TO
                TP-A04-02-OPC-FEC-FINP IN TP-A04.
           MOVE TP-729-01-OPC-FEC-FCOL IN TP-729 TO
                TP-A04-02-OPC-FEC-FCOL IN TP-A04.
           MOVE TP-729-01-OPC-FEC-FING IN TP-729 TO
                TP-A04-02-OPC-FEC-FING IN TP-A04.
           MOVE TP-729-01-FRM-GLS-SEGT IN TP-729 TO
                TP-A04-02-FRM-GLS-SEGT IN TP-A04.

           MOVE TP-729-01-OPC-VAL-SEGP IN TP-729 TO
                TP-A04-02-OPC-VAL-SEGP IN TP-A04.
           IF TP-A04-02-OPC-VAL-SEGP IN TP-A04 > SPACES
                MOVE TP-729-01-OPC-VAL-SEGP-NUM IN TP-729 TO
                     WSS-EDT-PIC-909-V4
                MOVE WSS-EDT-PIC-909-V4 TO
                     TP-A04-02-OPC-VAL-SEGP IN TP-A04.

           MOVE TP-729-01-ITR-SGV-TINT IN TP-729 TO
                TP-A04-02-ITR-SGV-TINT IN TP-A04.
           IF TP-A04-02-ITR-SGV-TINT IN TP-A04 > SPACES
                MOVE TP-729-01-ITR-SGV-TINT-NUM IN TP-729 TO
                     WSS-EDT-PIC-903-V4
                MOVE WSS-EDT-PIC-903-V4 TO
                     TP-A04-02-ITR-SGV-TINT IN TP-A04.

           MOVE TP-729-01-OPC-COD-CVTA IN TP-729 TO
                TP-A04-02-OPC-COD-CVTA IN TP-A04.

           MOVE TP-729-01-COM-SGV-TINT IN TP-729 TO
                TP-A04-02-COM-SGV-TINT IN TP-A04.
           IF TP-A04-02-COM-SGV-TINT IN TP-A04 > SPACES
                MOVE TP-729-01-COM-SGV-TINT-NUM IN TP-729 TO
                     WSS-EDT-PIC-903-V4
                MOVE WSS-EDT-PIC-903-V4 TO
                     TP-A04-02-COM-SGV-TINT IN TP-A04.

           MOVE TP-729-01-ITR-COD-TINT IN TP-729 TO
                TP-A04-02-ITR-COD-TINT IN TP-A04.

           MOVE TP-729-01-COM-SGV-TCAN IN TP-729 TO
                TP-A04-02-COM-SGV-TCAN IN TP-A04.
           IF TP-A04-02-COM-SGV-TCAN IN TP-A04 > SPACES
                MOVE TP-729-01-COM-SGV-TCAN-NUM IN TP-729 TO
                     WSS-EDT-PIC-903-V4
                MOVE WSS-EDT-PIC-903-V4 TO
                     TP-A04-02-COM-SGV-TCAN IN TP-A04.

           MOVE TP-729-01-OPC-IND-GARA IN TP-729 TO
                TP-A04-02-OPC-IND-GARA IN TP-A04.
           MOVE TP-729-01-OPC-NUM-PLCO IN TP-729 TO
                TP-A04-02-OPC-NUM-PLCO IN TP-A04.

           MOVE TP-729-01-OPC-SGV-VCOM IN TP-729 TO
                TP-A04-02-OPC-SGV-VCOM IN TP-A04.
           IF TP-A04-02-OPC-SGV-VCOM IN TP-A04 > SPACES
                MOVE TP-729-01-OPC-SGV-VCOM-NUM IN TP-729 TO
                     WSS-EDT-PIC-S908-V4
                MOVE WSS-EDT-PIC-S908-V4 TO
                     TP-A04-02-OPC-SGV-VCOM IN TP-A04.

           MOVE TP-729-01-OPC-MSC-MCVF IN TP-729 TO
                TP-A04-02-OPC-MSC-MCVF IN TP-A04.
           MOVE TP-729-01-FRM-IND-PVEZ-CAN IN TP-729 TO
                TP-A04-02-FRM-IND-PCAN     IN TP-A04.
           MOVE TP-729-01-OPC-IND-VSTR IN TP-729 TO
                TP-A04-03-OPC-IND-VSTR IN TP-A04.

           MOVE TP-729-01-OPC-VAL-GAST IN TP-729 TO
                TP-A04-03-OPC-VAL-GAST IN TP-A04.
           IF TP-A04-03-OPC-VAL-GAST IN TP-A04 > SPACES
                MOVE TP-729-01-OPC-VAL-GAST-NUM IN TP-729 TO
                     WSS-EDT-PIC-909-V4
                MOVE WSS-EDT-PIC-909-V4 TO
                     TP-A04-03-OPC-VAL-GAST IN TP-A04.

           MOVE TP-729-01-FRM-GLS-MCVF IN TP-729 TO
                TP-A04-03-FRM-GLS-MCVF IN TP-A04.
           MOVE TP-729-01-FRM-IND-PVEZ-OPC IN TP-729 TO
                TP-A04-03-FRM-IND-POPC     IN TP-A04.
           MOVE TP-729-01-OPC-IND-AFER IN TP-729 TO
                TP-A04-03-OPC-IND-AFER IN TP-A04.

           MOVE TP-729-01-OPC-SGV-LIQU IN TP-729 TO
                TP-A04-03-OPC-SGV-LIQU IN TP-A04.
           IF TP-A04-03-OPC-SGV-LIQU IN TP-A04 > SPACES
                MOVE TP-729-01-OPC-SGV-LIQU-NUM IN TP-729 TO
                     WSS-EDT-PIC-S911-V4
                MOVE WSS-EDT-PIC-S911-V4 TO
                     TP-A04-03-OPC-SGV-LIQU IN TP-A04.

           MOVE TP-729-01-OPC-COD-RMOC IN TP-729 TO
                TP-A04-03-OPC-COD-RMOC IN TP-A04.
           MOVE TP-729-01-OPC-COD-INSI IN TP-729 TO
                TP-A04-03-OPC-COD-INSI IN TP-A04.
           MOVE TP-729-01-CYA-IND-TCYA IN TP-729 TO
                TP-A04-03-CYA-IND-TCYA IN TP-A04.
           MOVE TP-729-01-AUT-NUM-ICAN IN TP-729 TO
                TP-A04-03-AUT-NUM-ICAN IN TP-A04.
           MOVE TP-729-01-FRM-GLS-RMOC IN TP-729 TO
                TP-A04-03-FRM-GLS-RMOC IN TP-A04.
           MOVE TP-729-01-FRM-GLS-INSI IN TP-729 TO
                TP-A04-03-FRM-GLS-INSI IN TP-A04.
           MOVE TP-729-01-CYA-CAI-ICYA IN TP-729 TO
                TP-A04-03-CYA-CAI-ICYA IN TP-A04.
           MOVE TP-729-01-CYA-IIC-ICYA IN TP-729 TO
                TP-A04-03-CYA-IIC-ICYA IN TP-A04.
           MOVE TP-729-01-OPC-COD-CDOC IN TP-729 TO
                TP-A04-03-OPC-COD-CDOC IN TP-A04.
           MOVE TP-729-01-FRM-GLS-CDOC IN TP-729 TO
                TP-A04-03-FRM-GLS-CDOC IN TP-A04.
           MOVE TP-729-01-AUT-MSC-STAT IN TP-729 TO
                TP-A04-03-AUT-MSC-STAT IN TP-A04.
           MOVE TP-729-01-AUT-CAI-ICYA IN TP-729 TO
                TP-A04-03-AUT-CAI-ICYA IN TP-A04.
           MOVE TP-729-01-AUT-IIC-ICYA IN TP-729 TO
                TP-A04-03-AUT-IIC-ICYA IN TP-A04.

      *Complementar TP-A04 con Entidades
           PERFORM COMPL-TPA04-729.
       FIN-LLENA-TPA04-729.
           EXIT.

       COMPL-TPA04-729 SECTION.
       INI-COMPL-TPA04-729.
      *Lee entidad OPC
           MOVE SPACES TO OPC.
           IF TP-729-01-OPC-CAI-IOPC IN TP-729 NOT > SPACES OR
              TP-729-01-OPC-IIC-IOPC IN TP-729 NOT > SPACES
                 GO TO FIN-COMPL-TPA04-729.

           MOVE TP-729-01-OPC-CAI-IOPC IN TP-729 TO OPC-CAI-IOPC IN OPC.
           MOVE TP-729-01-OPC-IIC-IOPC IN TP-729 TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-COMPL-TPA04-729.

           MOVE OPC-NUM-IVEN TO TP-A04-03-OPC-NUM-IVEN-NUM IN TP-A04.

           IF OPC-MSC-STAT IN OPC = WSS-A
               MOVE OPC-COD-ATRN IN OPC TO
                    TP-A04-03-FRM-COD-ATRA IN TP-A04
               MOVE OPC-FEC-FTRN IN OPC TO
                    TP-A04-03-FRM-FEC-FACT IN TP-A04
               MOVE OPC-HRA-HRTR IN OPC TO
                    TP-A04-03-FRM-HRA-ACTI IN TP-A04.

           IF OPC-MSC-STAT IN OPC = WSS-L
               MOVE OPC-COD-ATRN IN OPC TO
                    TP-A04-03-FRM-COD-ATRL IN TP-A04
               MOVE OPC-FEC-FTRN IN OPC TO
                    TP-A04-03-FRM-FEC-FLIQ IN TP-A04
               MOVE OPC-HRA-HRTR IN OPC TO
                    TP-A04-03-FRM-HRA-LIQU IN TP-A04.

      *Lee entidad VEN
           MOVE SPACES TO VEN.
           IF OPC-IND-VSTR IN OPC = WSS-S
                MOVE WSS-1               TO VEN-NUM-IVEN IN VEN
           ELSE
                MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.

      *Obtiene fecha y Monto proximo Vencimiento
           IF FIO-STAT-OKS
               MOVE VEN-FEC-FVEN IN VEN TO
                    TP-A04-03-FRM-FEC-PVEN IN TP-A04
               MOVE VEN-VAL-FINA IN VEN TO
                    TP-A04-03-FRM-VAL-PVEN-NUM IN TP-A04.
           IF TP-A04-03-FRM-VAL-PVEN IN TP-A04 > SPACES
                MOVE TP-A04-03-FRM-VAL-PVEN-NUM IN TP-A04 TO
                     WSS-EDT-PIC-911-V4
                MOVE WSS-EDT-PIC-911-V4 TO
                     TP-A04-03-FRM-VAL-PVEN IN TP-A04.


      *Lee entidad DLC
           MOVE SPACES TO DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC
               MOVE DLC-IND-ESTA IN DLC TO
                    TP-A04-03-DLC-IND-ESTA IN TP-A04
               MOVE DLC-FEC-FMAV IN DLC TO
                    TP-A04-03-FRM-FEC-FMAV IN TP-A04
               MOVE DLC-COD-NOTC IN DLC TO
                    TP-A04-03-DLC-COD-NOTC IN TP-A04
               MOVE DLC-VAL-GNOT IN DLC TO
                    TP-A04-03-DLC-VAL-GNOT-NUM IN TP-A04.
           IF TP-A04-03-DLC-VAL-GNOT IN TP-A04 > SPACES
                MOVE TP-A04-03-DLC-VAL-GNOT-NUM IN TP-A04 TO
                     WSS-EDT-PIC-911-V4
                MOVE WSS-EDT-PIC-911-V4 TO
                     TP-A04-03-DLC-VAL-GNOT IN TP-A04.

      *Obtener Banca
           PERFORM LEE-SGC-DBC.
           MOVE WSS-COD-TBAN TO TP-A04-03-FRM-COD-TBAN IN TP-A04.

      *Obtener Valor en pesos
           MOVE WSS-GIDD     TO RCC-QUEU.
           MOVE TSK-TERM-ALF TO RCC-TERM.

           MOVE RCC-QIDD    TO QUE-COLA.
           MOVE RCC-QIDD    TO SCR-QIDD.
           MOVE WNN-MAS490  TO QUE-LITM.
           MOVE WNN-MAS490  TO SCR-LIDD.
           MOVE WSS-1    TO QUE-NITM.
           MOVE QUE-GET  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
                 MOVE RCC-QIDD   TO QUE-COLA
                 MOVE WNN-MAS490 TO QUE-LITM
                 MOVE IDD-REGI   TO QUE-ITEM
                 MOVE QUE-PUT    TO QUE-CMND
                 PERFORM GNS-PRO-QUE.

           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S
              IF OPC-COD-VCOC IN OPC = TAB-COD-CTAB IN TAB OR
                 OPC-COD-VCOC IN OPC = WSS-MILES-PESOS
                  MOVE OPC-VAL-CRED IN OPC TO
                       TP-A04-03-FRM-VAL-MOPP-NUM IN TP-A04
              ELSE
               PERFORM GET-FHOY
               MOVE HOY-FHOY                         TO NVC-FCAM
               MOVE OPC-VAL-CRED IN OPC              TO NVC-VALO
               MOVE OPC-COD-VCOC IN OPC              TO NVC-MON1
               MOVE TAB-COD-CTAB IN TAB              TO NVC-MON2
               MOVE WSS-4                            TO NVC-NUM-DECI
               MOVE WSS-C                            TO NVC-IND-ACCI
               PERFORM PRO-NVC-NCD
               IF NVC-CMSG NOT > SPACES
                   MOVE NVC-RESU TO
                        TP-A04-03-FRM-VAL-MOPP-NUM IN TP-A04.

           IF TP-A04-03-FRM-VAL-MOPP IN TP-A04 > SPACES
                MOVE TP-A04-03-FRM-VAL-MOPP-NUM IN TP-A04 TO
                     WSS-EDT-PIC-911-V4
                MOVE WSS-EDT-PIC-911-V4 TO
                     TP-A04-03-FRM-VAL-MOPP IN TP-A04.

      *Obtener Beneficiario
           MOVE SPACES TO CEN.
           MOVE WSS-BNF                          TO CEN-COD-ENTI IN CEN.
           MOVE TP-729-01-OPC-CAI-IOPC IN TP-729 TO CEN-CAI-IENT IN CEN.
           MOVE TP-729-01-OPC-IIC-IOPC IN TP-729 TO CEN-IIC-IENT IN CEN.
           MOVE ZEROES                           TO CEN-FEC-FENT IN CEN.
           MOVE SPACES                           TO CEN-COD-RENT IN CEN.
           MOVE WSS-999                          TO CEN-NUM-IENT IN CEN.
           MOVE FIO-GET-LEQ                      TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF FIO-STAT-OKS  AND
              CEN-COD-ENTI IN CEN = WSS-BNF  AND
              CEN-CAI-IENT IN CEN = TP-729-01-OPC-CAI-IOPC IN TP-729 AND
              CEN-IIC-IENT IN CEN = TP-729-01-OPC-IIC-IOPC IN TP-729
               MOVE CEN-GLS-GLS1 IN CEN TO WSS-GLS-NOMB1
               MOVE CEN-GLS-GLS2 IN CEN TO WSS-GLS-NOMB2
               MOVE WSS-GLS-NOMB TO
                        TP-A04-03-FRM-NOM-BNEF IN TP-A04
               MOVE CEN-IND-IND1 IN CEN TO
                        TP-A04-03-FRM-IND-TBNF IN TP-A04
               MOVE CEN-COD-COD2 IN CEN TO
                        TP-A04-03-FRM-COD-ORGB IN TP-A04
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CEN' TO TAB-COD-TTAB IN TAB
               MOVE CEN-COD-ENTI IN CEN TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DATA IN TAB TO WSS-TAB-GLS-DATA
               IF  WSS-TAB-GLS-DATA(50:1) = WSS-R
                    MOVE  CEN-CAI-ISEN IN CEN  TO DBC-CAI-ICLI IN DBC
                    MOVE  CEN-IIC-ISEN IN CEN  TO DBC-IIC-ICLI IN DBC
                    MOVE    FIO-GET-KEY        TO FIO-CMND
                    PERFORM SGC-FIO-DBC
                    IF FIO-STAT-OKS
                        MOVE DBC-NUM-ICLI IN DBC TO
                             TP-A04-03-FRM-NUM-BNEF IN TP-A04
                        MOVE DBC-VRF-ICLI IN DBC TO
                             TP-A04-03-FRM-VRF-BNEF IN TP-A04
                        MOVE DBC-IND-ICLI IN DBC TO
                             TP-A04-03-FRM-IND-BNEF IN TP-A04
                        MOVE DBC-GLS-ICLI IN DBC TO
                             TP-A04-03-FRM-GLS-BNEF IN TP-A04.

      *Obtener Glosa Boleta
           MOVE SPACES TO CEN.
           MOVE WSS-DCB                          TO CEN-COD-ENTI IN CEN.
           MOVE TP-729-01-OPC-CAI-IOPC IN TP-729 TO CEN-CAI-IENT IN CEN.
           MOVE TP-729-01-OPC-IIC-IOPC IN TP-729 TO CEN-IIC-IENT IN CEN.
           MOVE ZEROES                           TO CEN-FEC-FENT IN CEN.
           MOVE SPACES                           TO CEN-COD-RENT IN CEN.
           MOVE WSS-999                          TO CEN-NUM-IENT IN CEN.
           MOVE FIO-GET-LEQ                      TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF FIO-STAT-OKS  AND
              CEN-COD-ENTI IN CEN = WSS-DCB  AND
              CEN-CAI-IENT IN CEN = TP-729-01-OPC-CAI-IOPC IN TP-729 AND
              CEN-IIC-IENT IN CEN = TP-729-01-OPC-IIC-IOPC IN TP-729
               MOVE SPACES              TO WSS-GLS-DCB
               MOVE CEN-GLS-GLS1 IN CEN TO WSS-GLS-DCB1
               MOVE CEN-GLS-GLS2 IN CEN TO WSS-GLS-DCB2
               MOVE CEN-GLS-GLS3 IN CEN TO WSS-GLS-DCB3
               MOVE CEN-GLS-GLS4 IN CEN TO WSS-GLS-DCB4
               MOVE WSS-GLS-DCB TO
                        TP-A04-03-FRM-GLS-GLSB IN TP-A04.

      *Obtener Retirante
           MOVE SPACES TO CEN.
           MOVE WSS-RET                          TO CEN-COD-ENTI IN CEN.
           MOVE TP-729-01-OPC-CAI-IOPC IN TP-729 TO CEN-CAI-IENT IN CEN.
           MOVE TP-729-01-OPC-IIC-IOPC IN TP-729 TO CEN-IIC-IENT IN CEN.
           MOVE ZEROES                           TO CEN-FEC-FENT IN CEN.
           MOVE SPACES                           TO CEN-COD-RENT IN CEN.
           MOVE WSS-999                          TO CEN-NUM-IENT IN CEN.
           MOVE FIO-GET-LEQ                      TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF FIO-STAT-OKS  AND
              CEN-COD-ENTI IN CEN = WSS-RET  AND
              CEN-CAI-IENT IN CEN = TP-729-01-OPC-CAI-IOPC IN TP-729 AND
              CEN-IIC-IENT IN CEN = TP-729-01-OPC-IIC-IOPC IN TP-729
               MOVE CEN-GLS-GLS1 IN CEN TO WSS-GLS-NOMB1
               MOVE CEN-GLS-GLS2 IN CEN TO WSS-GLS-NOMB2
               MOVE WSS-GLS-NOMB TO
                        TP-A04-03-FRM-NOM-RETI IN TP-A04
               MOVE CEN-GLS-GLS3 IN CEN TO
                        TP-A04-03-FRM-DIR-RETI IN TP-A04
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CEN' TO TAB-COD-TTAB IN TAB
               MOVE CEN-COD-ENTI IN CEN TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DATA IN TAB TO WSS-TAB-GLS-DATA
               IF  WSS-TAB-GLS-DATA(50:1) = WSS-R
                    MOVE  CEN-CAI-ISEN IN CEN  TO DBC-CAI-ICLI IN DBC
                    MOVE  CEN-IIC-ISEN IN CEN  TO DBC-IIC-ICLI IN DBC
                    MOVE  FIO-GET-KEY          TO FIO-CMND
                    PERFORM SGC-FIO-DBC
                    IF FIO-STAT-OKS
                        MOVE DBC-NUM-ICLI IN DBC TO
                             TP-A04-03-FRM-NUM-RETI IN TP-A04
                        MOVE DBC-VRF-ICLI IN DBC TO
                             TP-A04-03-FRM-VRF-RETI IN TP-A04
                        MOVE DBC-IND-ICLI IN DBC TO
                             TP-A04-03-FRM-IND-RETI IN TP-A04
                        MOVE DBC-GLS-ICLI IN DBC TO
                             TP-A04-03-FRM-GLS-RETI IN TP-A04.

      *Obtener Tercero
           MOVE SPACES TO CEN.
           MOVE WSS-TER                          TO CEN-COD-ENTI IN CEN.
           MOVE TP-729-01-OPC-CAI-IOPC IN TP-729 TO CEN-CAI-IENT IN CEN.
           MOVE TP-729-01-OPC-IIC-IOPC IN TP-729 TO CEN-IIC-IENT IN CEN.
           MOVE ZEROES                           TO CEN-FEC-FENT IN CEN.
           MOVE SPACES                           TO CEN-COD-RENT IN CEN.
           MOVE WSS-999                          TO CEN-NUM-IENT IN CEN.
           MOVE FIO-GET-LEQ                      TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF FIO-STAT-OKS  AND
              CEN-COD-ENTI IN CEN = WSS-TER  AND
              CEN-CAI-IENT IN CEN = TP-729-01-OPC-CAI-IOPC IN TP-729 AND
              CEN-IIC-IENT IN CEN = TP-729-01-OPC-IIC-IOPC IN TP-729
               MOVE CEN-GLS-GLS1 IN CEN TO WSS-GLS-NOMB1
               MOVE CEN-GLS-GLS2 IN CEN TO WSS-GLS-NOMB2
               MOVE WSS-GLS-NOMB TO
                        TP-A04-03-FRM-NOM-TERC IN TP-A04
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CEN' TO TAB-COD-TTAB IN TAB
               MOVE CEN-COD-ENTI IN CEN TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DATA IN TAB TO WSS-TAB-GLS-DATA
               IF  WSS-TAB-GLS-DATA(50:1) = WSS-R
                    MOVE  CEN-CAI-ISEN IN CEN  TO DBC-CAI-ICLI IN DBC
                    MOVE  CEN-IIC-ISEN IN CEN  TO DBC-IIC-ICLI IN DBC
                    MOVE  FIO-GET-KEY          TO FIO-CMND
                    PERFORM SGC-FIO-DBC
                    IF FIO-STAT-OKS
                        MOVE DBC-NUM-ICLI IN DBC TO
                             TP-A04-03-FRM-NUM-TERC IN TP-A04
                        MOVE DBC-VRF-ICLI IN DBC TO
                             TP-A04-03-FRM-VRF-TERC IN TP-A04
                        MOVE DBC-IND-ICLI IN DBC TO
                             TP-A04-03-FRM-IND-TERC IN TP-A04
                        MOVE DBC-GLS-ICLI IN DBC TO
                             TP-A04-03-FRM-GLS-TERC IN TP-A04.
       FIN-COMPL-TPA04-729.
           EXIT.

       LEE-SGC-DBC SECTION.
       INI-LEE-SGC-DBC.
           MOVE SPACES TO WSS-COD-TBAN.
           PERFORM GET-CUR-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-LEE-SGC-DBC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-LEE-SGC-DBC.

           IF DBC-IND-TICL = WSS-P
               MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
               MOVE FIO-GET-KEY         TO FIO-CMND
               MOVE 'DCP-KEY-IDCP'      TO FIO-AKEY
               PERFORM SGC-FIO-DCP
               IF FIO-STAT-OKS
                  MOVE DCP-COD-TBAN IN DCP TO WSS-COD-TBAN.

           IF DBC-IND-TICL = WSS-E
               MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
               MOVE FIO-GET-KEY         TO FIO-CMND
               MOVE 'DCE-KEY-IDCE'      TO FIO-AKEY
               PERFORM SGC-FIO-DCE
               IF FIO-STAT-OKS
                  MOVE DCE-COD-TBAN IN DCE TO WSS-COD-TBAN.
       FIN-LEE-SGC-DBC.
           EXIT.


       LLENA-TPA04-110 SECTION.
       INI-LLENA-TPA04-110.
           MOVE SPACES TO TP-A04.

           MOVE TP-110-STAT IN TP-110 TO TP-A04-STAT IN TP-A04.
           MOVE TP-110-MENS IN TP-110 TO TP-A04-MENS IN TP-A04.

           MOVE TP-110-01-FRM-COD-TIPO IN TP-110 TO
                TP-A04-01-FRM-COD-TIPO IN TP-A04.
           MOVE TP-110-01-FRM-NUM-EMIS IN TP-110 TO
                TP-A04-01-FRM-NUM-EMIS IN TP-A04.
           MOVE TP-110-01-FRM-VRF-EMIS IN TP-110 TO
                TP-A04-01-FRM-VRF-EMIS IN TP-A04.
           MOVE TP-110-01-FRM-IND-EMIS IN TP-110 TO
                TP-A04-01-FRM-IND-EMIS IN TP-A04.
           MOVE TP-110-01-FRM-GLS-EMIS IN TP-110 TO
                TP-A04-01-FRM-GLS-EMIS IN TP-A04.
           MOVE TP-110-01-FRM-NUM-BENF IN TP-110 TO
                TP-A04-01-FRM-NUM-BENF IN TP-A04.
           MOVE TP-110-01-FRM-VRF-BENF IN TP-110 TO
                TP-A04-01-FRM-VRF-BENF IN TP-A04.
           MOVE TP-110-01-FRM-IND-BENF IN TP-110 TO
                TP-A04-01-FRM-IND-BENF IN TP-A04.
           MOVE TP-110-01-FRM-GLS-BENF IN TP-110 TO
                TP-A04-01-FRM-GLS-BENF IN TP-A04.
           MOVE TP-110-01-FRM-GLS-NEMI IN TP-110 TO
                TP-A04-03-FRM-GLS-NEMI IN TP-A04.
           MOVE TP-110-01-FRM-GLS-NBEN IN TP-110 TO
                TP-A04-03-FRM-GLS-NBEN IN TP-A04.
           MOVE TP-110-01-FRM-COD-STAT IN TP-110 TO
                TP-A04-01-FRM-COD-STAT IN TP-A04.
           MOVE TP-110-01-FRM-GLS-STUS IN TP-110 TO
                TP-A04-03-FRM-GLS-STUS IN TP-A04.
           MOVE TP-110-01-OPC-COD-TOOC IN TP-110 TO
                TP-A04-01-CMB-COD-TOOC IN TP-A04.
           MOVE TP-110-01-OPC-COD-AOOC IN TP-110 TO
                TP-A04-01-CMB-COD-AOOC IN TP-A04.
           MOVE TP-110-01-DLC-IND-ESTA IN TP-110 TO
                TP-A04-03-DLC-IND-ESTA IN TP-A04.
           MOVE TP-110-01-FRM-GLS-ETAD IN TP-110 TO
                TP-A04-03-FRM-GLS-ETAD IN TP-A04.
           MOVE TP-110-01-DLC-IND-ETAP IN TP-110 TO
                TP-A04-01-DLC-IND-ETAP IN TP-A04.
           MOVE TP-110-01-FRM-GLS-ETPA IN TP-110 TO
                TP-A04-03-FRM-GLS-ETPA IN TP-A04.
           MOVE TP-110-01-FRM-COD-TFEC IN TP-110 TO
                TP-A04-01-FRM-COD-TFEC IN TP-A04.
           MOVE TP-110-01-FRM-FEC-FINI IN TP-110 TO
                TP-A04-01-FRM-FEC-FINI IN TP-A04.
           MOVE TP-110-01-FRM-FEC-FFIN IN TP-110 TO
                TP-A04-01-FRM-FEC-FFIN IN TP-A04.
           MOVE TP-110-01-FRM-COD-MONE IN TP-110 TO
                TP-A04-01-FRM-COD-MONE IN TP-A04.
           MOVE TP-110-01-FRM-GLS-MONE IN TP-110 TO
                TP-A04-03-FRM-GLS-MONE IN TP-A04.
           MOVE TP-110-01-FRM-COD-CNAL IN TP-110 TO
                TP-A04-01-FRM-COD-CNAL IN TP-A04.
           MOVE TP-110-01-FRM-GLS-CANA IN TP-110 TO
                TP-A04-03-FRM-GLS-CANA IN TP-A04.
           MOVE TP-110-01-FRM-IND-SGTE IN TP-110 TO
                TP-A04-01-FRM-IND-SGTE IN TP-A04.
           MOVE TP-110-01-FRM-CAI-IOPE IN TP-110 TO
                TP-A04-01-FRM-CAI-IOPE IN TP-A04.
           MOVE TP-110-01-FRM-IIC-IOPE IN TP-110 TO
                TP-A04-01-FRM-IIC-IOPE IN TP-A04.
           MOVE TP-110-02-DAS-IND-HMAS IN TP-110 TO
                TP-A04-01-DAS-IND-HMAS IN TP-A04.
           MOVE TP-110-02-DAS-NUM-TOCC IN TP-110 TO
                TP-A04-01-DAS-NUM-TOCC IN TP-A04.

           PERFORM LLENA-OCCURS-TPA04 VARYING WSS-IDX-A04
                 FROM WSS-1 BY WSS-1
                 UNTIL (WSS-IDX-A04 > WSS-MAX-IDX OR
                        TP-110-DMSG-IDX-1-03(WSS-IDX-A04) NOT > SPACES).

       FIN-LLENA-TPA04-110.
           EXIT.

       LLENA-OCCURS-TPA04 SECTION.
       INI-LLENA-OCCURS-TPA04.
           MOVE TP-110-03-FRM-CAI-IOPC(WSS-IDX-A04) TO
                TP-A04-04-FRM-CAI-IOPC(WSS-IDX-A04).
           MOVE TP-110-03-FRM-IIC-IOPC(WSS-IDX-A04) TO
                TP-A04-04-FRM-IIC-IOPC(WSS-IDX-A04).
           MOVE TP-110-03-FRM-NUM-ICLI(WSS-IDX-A04) TO
                TP-A04-04-FRM-NUM-ICLI(WSS-IDX-A04).
           MOVE TP-110-03-FRM-VRF-ICLI(WSS-IDX-A04) TO
                TP-A04-04-FRM-VRF-ICLI(WSS-IDX-A04).
           MOVE TP-110-03-FRM-IND-ICLI(WSS-IDX-A04) TO
                TP-A04-04-FRM-IND-ICLI(WSS-IDX-A04).
           MOVE TP-110-03-FRM-GLS-ICLI(WSS-IDX-A04) TO
                TP-A04-04-FRM-GLS-ICLI(WSS-IDX-A04).
           MOVE TP-110-03-FRM-GLS-NOMC(WSS-IDX-A04) TO
                TP-A04-04-FRM-GLS-NOMC(WSS-IDX-A04).
           MOVE TP-110-03-FRM-FEC-FEMI(WSS-IDX-A04) TO
                TP-A04-04-FRM-FEC-FEMI(WSS-IDX-A04).
           MOVE TP-110-03-FRM-FEC-FVEN(WSS-IDX-A04) TO
                TP-A04-04-FRM-FEC-FVEN(WSS-IDX-A04).
           MOVE TP-110-03-FRM-COD-VCOC(WSS-IDX-A04) TO
                TP-A04-04-FRM-COD-VCOC(WSS-IDX-A04).
           MOVE TP-110-03-FRM-GLS-VCOC(WSS-IDX-A04) TO
                TP-A04-04-FRM-GLS-MNDA(WSS-IDX-A04).
           MOVE TP-110-03-FRM-VAL-MOPE(WSS-IDX-A04) TO
                TP-A04-04-FRM-VAL-MOPE(WSS-IDX-A04).
           IF TP-A04-04-FRM-VAL-MOPE(WSS-IDX-A04) > SPACES
               MOVE TP-A04-04-FRM-VAL-MOPE-NUM(WSS-IDX-A04) TO
                    WSS-EDT-PIC-911-V4
               MOVE WSS-EDT-PIC-911-V4 TO
                    TP-A04-04-FRM-VAL-MOPE(WSS-IDX-A04).
           MOVE TP-110-03-FRM-COD-TOOC(WSS-IDX-A04) TO
                TP-A04-04-FRM-COD-TOOC(WSS-IDX-A04).
           MOVE TP-110-03-FRM-COD-AOOC(WSS-IDX-A04) TO
                TP-A04-04-FRM-COD-AOOC(WSS-IDX-A04).
           MOVE TP-110-03-FRM-IND-STAT(WSS-IDX-A04) TO
                TP-A04-04-FRM-IND-STAT(WSS-IDX-A04).
           MOVE TP-110-03-FRM-GLS-STAT(WSS-IDX-A04) TO
                TP-A04-04-FRM-GLS-STTS(WSS-IDX-A04).
           MOVE TP-110-03-FRM-COD-ESTA(WSS-IDX-A04) TO
                TP-A04-04-FRM-IND-ESTA(WSS-IDX-A04).
           MOVE TP-110-03-FRM-GLS-ESTA(WSS-IDX-A04) TO
                TP-A04-04-FRM-GLS-ESTA(WSS-IDX-A04).
           MOVE TP-110-03-FRM-COD-ETAP(WSS-IDX-A04) TO
                TP-A04-04-FRM-IND-ETAP(WSS-IDX-A04).
           MOVE TP-110-03-FRM-GLS-ETAP(WSS-IDX-A04) TO
                TP-A04-04-FRM-GLS-ETAP(WSS-IDX-A04).
           MOVE TP-110-03-FRM-COD-CNAO(WSS-IDX-A04) TO
                TP-A04-04-FRM-COD-CNAO(WSS-IDX-A04).
           MOVE TP-110-03-FRM-GLS-CNAO(WSS-IDX-A04) TO
                TP-A04-04-FRM-GLS-CNAO(WSS-IDX-A04).

           MOVE TP-110-03-FRM-CAI-IOPC(WSS-IDX-A04) TO
                                                    OPC-CAI-IOPC IN OPC.
           MOVE TP-110-03-FRM-IIC-IOPC(WSS-IDX-A04) TO
                                                    OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-LLENA-OCCURS-TPA04.

      *Complementar TP-A04 con Entidades
           PERFORM COMPL-TPA04-110.
       FIN-LLENA-OCCURS-TPA04.
           EXIT.

       COMPL-TPA04-110 SECTION.
       INI-COMPL-TPA04-110.
      *Datos desde OPC
           MOVE OPC-COD-OFOC IN OPC TO
                                   TP-A04-04-CMB-COD-OFOC(WSS-IDX-A04).
           MOVE OPC-FEC-FCOL IN OPC TO
                                   TP-A04-04-CMB-FEC-FCOL(WSS-IDX-A04).
           MOVE OPC-FEC-FINP IN OPC TO
                                   TP-A04-04-CMB-FEC-FINP(WSS-IDX-A04).
           MOVE OPC-IND-GARA IN OPC TO
                                   TP-A04-04-CMB-IND-GARA(WSS-IDX-A04).
           MOVE OPC-COD-RMOC IN OPC TO
                                   TP-A04-04-CMB-COD-RMOC(WSS-IDX-A04).

           IF OPC-MSC-STAT IN OPC = WSS-A
               MOVE OPC-COD-ATRN IN OPC TO
                    TP-A04-04-CMB-COD-ATRA(WSS-IDX-A04)
               MOVE OPC-FEC-FTRN IN OPC TO
                    TP-A04-04-CMB-FEC-FACT(WSS-IDX-A04)
               MOVE OPC-HRA-HRTR IN OPC TO
                    TP-A04-04-CMB-HRA-ACTI(WSS-IDX-A04).

           IF OPC-MSC-STAT IN OPC = WSS-L
               MOVE OPC-COD-ATRN IN OPC TO
                    TP-A04-04-CMB-COD-ATRL(WSS-IDX-A04)
               MOVE OPC-FEC-FTRN IN OPC TO
                    TP-A04-04-CMB-FEC-FLIQ(WSS-IDX-A04)
               MOVE OPC-HRA-HRTR IN OPC TO
                    TP-A04-04-CMB-HRA-LIQU(WSS-IDX-A04).

           MOVE OPC-COD-CDOC IN OPC TO
                     TP-A04-04-CMB-COD-CDOC(WSS-IDX-A04).
           MOVE OPC-COD-CVTA IN OPC TO
                     TP-A04-04-CMB-COD-CVTA(WSS-IDX-A04).

           IF OPC-MSC-STAT IN OPC > SPACES
               MOVE 'GNS' TO TAB-COD-SIST
               MOVE 'STT' TO TAB-COD-TTAB IN TAB
               MOVE OPC-MSC-STAT IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO
                                    TP-A04-04-CMB-GLS-STAT(WSS-IDX-A04).

           MOVE OPC-SGV-VCOM IN OPC TO
                TP-A04-04-CMB-SGV-VCOM-NUM(WSS-IDX-A04).
           IF TP-A04-04-CMB-SGV-VCOM(WSS-IDX-A04) > SPACES
               MOVE TP-A04-04-CMB-SGV-VCOM-NUM(WSS-IDX-A04) TO
                    WSS-EDT-PIC-909-V4
               MOVE WSS-EDT-PIC-909-V4 TO
                    TP-A04-04-CMB-SGV-VCOM(WSS-IDX-A04).

           MOVE OPC-NUM-IVEN IN OPC TO
                TP-A04-04-CMB-NUM-IVEN-NUM(WSS-IDX-A04).




      *Obtener Valor en pesos
           MOVE WSS-GIDD     TO RCC-QUEU.
           MOVE TSK-TERM-ALF TO RCC-TERM.

           MOVE RCC-QIDD   TO QUE-COLA.
           MOVE RCC-QIDD   TO SCR-QIDD.
           MOVE WNN-MAS490 TO QUE-LITM.
           MOVE WNN-MAS490 TO SCR-LIDD.
           MOVE WSS-1      TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
                 MOVE RCC-QIDD   TO QUE-COLA
                 MOVE WNN-MAS490 TO QUE-LITM
                 MOVE IDD-REGI   TO QUE-ITEM
                 MOVE QUE-PUT    TO QUE-CMND
                 PERFORM GNS-PRO-QUE.

           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WSS-S
              IF OPC-COD-VCOC IN OPC = TAB-COD-CTAB IN TAB OR
                 OPC-COD-VCOC IN OPC = WSS-MILES-PESOS
                  MOVE OPC-VAL-CRED IN OPC TO
                       TP-A04-04-CMB-VAL-MOPP-NUM(WSS-IDX-A04)
              ELSE
                  PERFORM GET-FHOY
                  MOVE HOY-FHOY            TO NVC-FCAM
                  MOVE OPC-VAL-CRED IN OPC TO NVC-VALO
                  MOVE OPC-COD-VCOC IN OPC TO NVC-MON1
                  MOVE TAB-COD-CTAB IN TAB TO NVC-MON2
                  MOVE WSS-4               TO NVC-NUM-DECI
                  MOVE WSS-C               TO NVC-IND-ACCI
                  PERFORM PRO-NVC-NCD
                  IF NVC-CMSG NOT > SPACES
                      MOVE NVC-RESU TO
                                TP-A04-04-CMB-VAL-MOPP-NUM(WSS-IDX-A04).

           IF TP-A04-04-CMB-VAL-MOPP(WSS-IDX-A04) > SPACES
               MOVE TP-A04-04-CMB-VAL-MOPP-NUM(WSS-IDX-A04) TO
                    WSS-EDT-PIC-911-V4
               MOVE WSS-EDT-PIC-911-V4 TO
                    TP-A04-04-CMB-VAL-MOPP(WSS-IDX-A04).

      *Datos desde ITR
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR.
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR.
           MOVE WSS-INT             TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = WSS-INT)
               MOVE WSS-23 TO FIO-STAT.
           IF FIO-STAT-OKS
               MOVE ITR-COD-TINT IN ITR TO
                    TP-A04-04-CMB-COD-TINT(WSS-IDX-A04)
               MOVE 'ITR-KEY-IICG' TO FIO-AKEY
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM COL-FIO-ITR
               IF FIO-STAT-OKS                              AND
                  ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
                  ITR-NUM-ICAN IN ITR = ZEROES              AND
                  ITR-CIC-IOPV IN ITR = SPACES              AND
                  ITR-NUM-IVCT IN ITR = ZEROES              AND
                  ITR-IND-TTAS IN ITR = WSS-INT
                   MOVE SPACES TO TP-A04-04-CMB-COD-TINT(WSS-IDX-A04)
                   MOVE WSS-M  TO TP-A04-04-CMB-COD-TINT(WSS-IDX-A04).


      *Datos desde SGC (Banca)
           PERFORM LEE-SGC-DBC.
           MOVE WSS-COD-TBAN TO TP-A04-04-CMB-COD-TBAN(WSS-IDX-A04).

      *Datos desde VEN
           MOVE SPACES TO VEN.
           IF OPC-IND-VSTR IN OPC = WSS-S
                MOVE WSS-1               TO VEN-NUM-IVEN IN VEN
           ELSE
                MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
      *Obtiene fecha y Monto proximo Vencimiento
           IF FIO-STAT-OKS
               MOVE VEN-FEC-FVEN IN VEN TO
                    TP-A04-04-CMB-FEC-PVEN(WSS-IDX-A04)
               MOVE VEN-VAL-FINA IN VEN TO
                    TP-A04-04-CMB-VAL-PVEN-NUM(WSS-IDX-A04).
           IF TP-A04-04-CMB-VAL-PVEN(WSS-IDX-A04) > SPACES
               MOVE TP-A04-04-CMB-VAL-PVEN-NUM(WSS-IDX-A04) TO
                    WSS-EDT-PIC-911-V4
               MOVE WSS-EDT-PIC-911-V4 TO
                    TP-A04-04-CMB-VAL-PVEN(WSS-IDX-A04).

      *Datos desde DLC
           MOVE SPACES TO DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC
               MOVE DLC-FEC-FMAV IN DLC TO
                    TP-A04-04-CMB-FEC-FMAV(WSS-IDX-A04)
               MOVE DLC-COD-NOTC IN DLC TO
                    TP-A04-04-CMB-COD-NOTC(WSS-IDX-A04)
               MOVE DLC-VAL-GNOT IN DLC TO
                    TP-A04-04-CMB-VAL-GNOT-NUM(WSS-IDX-A04).
           IF TP-A04-04-CMB-VAL-GNOT(WSS-IDX-A04) > SPACES
               MOVE TP-A04-04-CMB-VAL-GNOT-NUM(WSS-IDX-A04) TO
                    WSS-EDT-PIC-911-V4
               MOVE WSS-EDT-PIC-911-V4 TO
                    TP-A04-04-CMB-VAL-GNOT(WSS-IDX-A04).

      *Datos desde AUT
           MOVE OPC-CIC-IOPC IN OPC TO AUT-CIC-IOPC IN AUT.
           MOVE WSS-AUT             TO AUT-NUM-ICAN IN AUT.
           MOVE WSS-1               TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF FIO-STAT-OKS
               MOVE AUT-NUM-ICAN IN AUT TO
                        TP-A04-04-CMB-NUM-ICAN(WSS-IDX-A04)
           ELSE
               MOVE WSS-PAT TO AUT-NUM-ICAN IN AUT
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-AUT
               IF FIO-STAT-OKS
               MOVE AUT-NUM-ICAN IN AUT TO
                        TP-A04-04-CMB-NUM-ICAN(WSS-IDX-A04)
               ELSE
      *          DEBITO MULTIBANCO
                   MOVE WSS-COB TO AUT-NUM-ICAN IN AUT
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-AUT
                   IF FIO-STAT-OKS
                       MOVE AUT-NUM-ICAN IN AUT TO
                        TP-A04-04-CMB-NUM-ICAN(WSS-IDX-A04).

      *Datos desde CYA
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE WSS-1               TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-CYA.
           IF NOT (FIO-STAT-OKS AND
                   CYA-CIC-IOPC IN CYA = OPC-CIC-IOPC IN OPC AND
                   CYA-NUM-ICAN IN CYA = ZEROES AND
                   CYA-NUM-ICYA IN CYA = WSS-1 )
               MOVE WSS-23 TO FIO-STAT.
           IF FIO-STAT-OKS
               MOVE CYA-CAI-ICYA IN CYA TO
                    TP-A04-04-CMB-CAI-ICYA(WSS-IDX-A04)
               MOVE CYA-IIC-ICYA IN CYA TO
                    TP-A04-04-CMB-IIC-ICYA(WSS-IDX-A04).

      *Datos desde COM
           PERFORM GET-CUR-COM.
           IF FIO-STAT-OKS OR WSS-FIO-STAT-FLV = WSS-00
               MOVE WSS-SGV-TCOM TO
                     TP-A04-04-CMB-SGV-TCAN-NUM(WSS-IDX-A04).
           IF TP-A04-04-CMB-SGV-TCAN(WSS-IDX-A04) > SPACES
               MOVE TP-A04-04-CMB-SGV-TCAN-NUM(WSS-IDX-A04) TO
                    WSS-EDT-PIC-903-V4
               MOVE WSS-EDT-PIC-903-V4 TO
                    TP-A04-04-CMB-SGV-TCAN(WSS-IDX-A04).

      *Obtener Beneficiario (CEN)
           MOVE SPACES TO CEN.
           MOVE WSS-BNF             TO CEN-COD-ENTI IN CEN.
           MOVE OPC-CAI-IOPC IN OPC TO CEN-CAI-IENT IN CEN.
           MOVE OPC-IIC-IOPC IN OPC TO CEN-IIC-IENT IN CEN.
           MOVE ZEROES              TO CEN-FEC-FENT IN CEN.
           MOVE SPACES              TO CEN-COD-RENT IN CEN.
           MOVE WSS-999             TO CEN-NUM-IENT IN CEN.
           MOVE FIO-GET-LEQ         TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF FIO-STAT-OKS  AND
              CEN-COD-ENTI IN CEN = WSS-BNF  AND
              CEN-CAI-IENT IN CEN = OPC-CAI-IOPC IN OPC AND
              CEN-IIC-IENT IN CEN = OPC-IIC-IOPC IN OPC
               MOVE CEN-GLS-GLS1 IN CEN TO WSS-GLS-NOMB1
               MOVE CEN-GLS-GLS2 IN CEN TO WSS-GLS-NOMB2
               MOVE WSS-GLS-NOMB TO
                        TP-A04-04-CMB-NOM-BNEF(WSS-IDX-A04)
               MOVE CEN-IND-IND1 IN CEN TO
                        TP-A04-04-CMB-IND-TBNF(WSS-IDX-A04)
               MOVE CEN-COD-COD2 IN CEN TO
                        TP-A04-04-CMB-COD-ORGB(WSS-IDX-A04)

               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CEN' TO TAB-COD-TTAB IN TAB
               MOVE CEN-COD-ENTI IN CEN TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DATA IN TAB TO WSS-TAB-GLS-DATA
               IF  WSS-TAB-GLS-DATA(50:1) = WSS-R
                    MOVE  CEN-CAI-ISEN IN CEN  TO DBC-CAI-ICLI IN DBC
                    MOVE  CEN-IIC-ISEN IN CEN  TO DBC-IIC-ICLI IN DBC
                    MOVE    FIO-GET-KEY        TO FIO-CMND
                    PERFORM SGC-FIO-DBC
                    IF FIO-STAT-OKS
                        MOVE DBC-NUM-ICLI IN DBC TO
                             TP-A04-04-CMB-NUM-BNEF-NUM(WSS-IDX-A04)
                        MOVE DBC-VRF-ICLI IN DBC TO
                             TP-A04-04-CMB-VRF-BNEF(WSS-IDX-A04)
                        MOVE DBC-IND-ICLI IN DBC TO
                             TP-A04-04-CMB-IND-BNEF(WSS-IDX-A04)
                        MOVE DBC-GLS-ICLI IN DBC TO
                             TP-A04-04-CMB-GLS-BNEF(WSS-IDX-A04).

      *Obtener Glosa Boleta (CEN)
           MOVE SPACES TO CEN.
           MOVE WSS-DCB             TO CEN-COD-ENTI IN CEN.
           MOVE OPC-CAI-IOPC IN OPC TO CEN-CAI-IENT IN CEN.
           MOVE OPC-IIC-IOPC IN OPC TO CEN-IIC-IENT IN CEN.
           MOVE ZEROES              TO CEN-FEC-FENT IN CEN.
           MOVE SPACES              TO CEN-COD-RENT IN CEN.
           MOVE WSS-999             TO CEN-NUM-IENT IN CEN.
           MOVE FIO-GET-LEQ         TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF FIO-STAT-OKS  AND
              CEN-COD-ENTI IN CEN = WSS-DCB AND
              CEN-CAI-IENT IN CEN = OPC-CAI-IOPC IN OPC AND
              CEN-IIC-IENT IN CEN = OPC-IIC-IOPC IN OPC
               MOVE SPACES              TO WSS-GLS-DCB
               MOVE CEN-GLS-GLS1 IN CEN TO WSS-GLS-DCB1
               MOVE CEN-GLS-GLS2 IN CEN TO WSS-GLS-DCB2
               MOVE CEN-GLS-GLS3 IN CEN TO WSS-GLS-DCB3
               MOVE CEN-GLS-GLS4 IN CEN TO WSS-GLS-DCB4
               MOVE WSS-GLS-DCB TO
                        TP-A04-04-CMB-GLS-GLSB(WSS-IDX-A04).

      *Obtener Retirante (CEN)
           MOVE SPACES TO CEN.
           MOVE WSS-RET             TO CEN-COD-ENTI IN CEN.
           MOVE OPC-CAI-IOPC IN OPC TO CEN-CAI-IENT IN CEN.
           MOVE OPC-IIC-IOPC IN OPC TO CEN-IIC-IENT IN CEN.
           MOVE ZEROES              TO CEN-FEC-FENT IN CEN.
           MOVE SPACES              TO CEN-COD-RENT IN CEN.
           MOVE WSS-999             TO CEN-NUM-IENT IN CEN.
           MOVE FIO-GET-LEQ         TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF FIO-STAT-OKS  AND
              CEN-COD-ENTI IN CEN = WSS-RET  AND
              CEN-CAI-IENT IN CEN = OPC-CAI-IOPC IN OPC AND
              CEN-IIC-IENT IN CEN = OPC-IIC-IOPC IN OPC
               MOVE CEN-GLS-GLS1 IN CEN TO WSS-GLS-NOMB1
               MOVE CEN-GLS-GLS2 IN CEN TO WSS-GLS-NOMB2
               MOVE WSS-GLS-NOMB TO
                        TP-A04-04-CMB-NOM-RETI(WSS-IDX-A04)
               MOVE CEN-GLS-GLS3 IN CEN TO
                        TP-A04-04-CMB-DIR-RETI(WSS-IDX-A04)
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CEN' TO TAB-COD-TTAB IN TAB
               MOVE CEN-COD-ENTI IN CEN TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DATA IN TAB TO WSS-TAB-GLS-DATA
               IF  WSS-TAB-GLS-DATA(50:1) = WSS-R
                    MOVE  CEN-CAI-ISEN IN CEN  TO DBC-CAI-ICLI IN DBC
                    MOVE  CEN-IIC-ISEN IN CEN  TO DBC-IIC-ICLI IN DBC
                    MOVE  FIO-GET-KEY          TO FIO-CMND
                    PERFORM SGC-FIO-DBC
                    IF FIO-STAT-OKS
                        MOVE DBC-NUM-ICLI IN DBC TO
                             TP-A04-04-CMB-NUM-RETI-NUM(WSS-IDX-A04)
                        MOVE DBC-VRF-ICLI IN DBC TO
                             TP-A04-04-CMB-VRF-RETI(WSS-IDX-A04)
                        MOVE DBC-IND-ICLI IN DBC TO
                             TP-A04-04-CMB-IND-RETI(WSS-IDX-A04)
                        MOVE DBC-GLS-ICLI IN DBC TO
                             TP-A04-04-CMB-GLS-RETI(WSS-IDX-A04).

      *Obtener Tercero (CEN)
           MOVE SPACES TO CEN.
           MOVE WSS-TER             TO CEN-COD-ENTI IN CEN.
           MOVE OPC-CAI-IOPC IN OPC TO CEN-CAI-IENT IN CEN.
           MOVE OPC-IIC-IOPC IN OPC TO CEN-IIC-IENT IN CEN.
           MOVE ZEROES              TO CEN-FEC-FENT IN CEN.
           MOVE SPACES              TO CEN-COD-RENT IN CEN.
           MOVE WSS-999             TO CEN-NUM-IENT IN CEN.
           MOVE FIO-GET-LEQ         TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF FIO-STAT-OKS  AND
              CEN-COD-ENTI IN CEN = WSS-TER  AND
              CEN-CAI-IENT IN CEN = OPC-CAI-IOPC IN OPC AND
              CEN-IIC-IENT IN CEN = OPC-IIC-IOPC IN OPC
               MOVE CEN-GLS-GLS1 IN CEN TO WSS-GLS-NOMB1
               MOVE CEN-GLS-GLS2 IN CEN TO WSS-GLS-NOMB2
               MOVE WSS-GLS-NOMB TO
                        TP-A04-04-CMB-NOM-TERC(WSS-IDX-A04)
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CEN' TO TAB-COD-TTAB IN TAB
               MOVE CEN-COD-ENTI IN CEN TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DATA IN TAB TO WSS-TAB-GLS-DATA
               IF  WSS-TAB-GLS-DATA(50:1) = WSS-R
                    MOVE  CEN-CAI-ISEN IN CEN  TO DBC-CAI-ICLI IN DBC
                    MOVE  CEN-IIC-ISEN IN CEN  TO DBC-IIC-ICLI IN DBC
                    MOVE  FIO-GET-KEY          TO FIO-CMND
                    PERFORM SGC-FIO-DBC
                    IF FIO-STAT-OKS
                        MOVE DBC-NUM-ICLI IN DBC TO
                             TP-A04-04-CMB-NUM-TERC-NUM(WSS-IDX-A04)
                        MOVE DBC-VRF-ICLI IN DBC TO
                             TP-A04-04-CMB-VRF-TERC(WSS-IDX-A04)
                        MOVE DBC-IND-ICLI IN DBC TO
                             TP-A04-04-CMB-IND-TERC(WSS-IDX-A04)
                        MOVE DBC-GLS-ICLI IN DBC TO
                             TP-A04-04-CMB-GLS-TERC(WSS-IDX-A04).

       FIN-COMPL-TPA04-110.
           EXIT.

       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC AND
              RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC AND
              RDC-NUM-IDLC IN RDC = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE WSS-23 TO FIO-STAT.
      *
       FIN-GET-CUR-RDC.
           EXIT.

       GET-CUR-COM SECTION.
       INI-GET-CUR-COM.
      *LEE TASA DE COMISION FLV PARA USAR EN LA CANCELACION
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO COM-CIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE WSS-FLV             TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = WSS-FLV )
               MOVE WSS-23 TO WSS-FIO-STAT-FLV
               MOVE ZEROES TO WSS-SGV-TCOM
           ELSE
               MOVE WSS-00 TO WSS-FIO-STAT-FLV
               MOVE COM-SGV-TINT IN COM TO WSS-SGV-TCOM
               MOVE WSS-N TO WSS-FRM-IND-PVEZ-CAN.

           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO COM-CIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE WSS-COM             TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = WSS-COM )
               MOVE ZEROES           TO COM-SGV-TINT IN COM
               MOVE WSS-23 TO FIO-STAT
           ELSE
               MOVE WSS-N TO WSS-FRM-IND-PVEZ-OPC.
       FIN-GET-CUR-COM.
           EXIT.

       COPY GNSBVNUM.
       COPY GNSBGHOY.
       COPY GNSBHSYS.
       COPY GNSBGSYS.
       COPY GNSBIABT.
       COPY GNSBGTSK.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY GNSBGDTC.
       COPY GNSBGMSG.
       COPY GNSBVTAB.
       COPY GNSBBTAB.
      *COPY TABBFUSR.

       COPY COLBFAUT.
       COPY COLBFCYA.
       COPY COLBFCOM.
       COPY COLBFITR.
       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFVEN.
       COPY COLBFCEN.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY SGCBFDCE.
       COPY SGCBFDCP.
       COPY GNSBINVC.

       COPY GNSBGEND.

      *Modulo Generico Manejo de TSs
       COPY GNSBGQUE.

       CRG-IDD SECTION.
       INI-CRG-IDD.
           MOVE WSS-GNS      TO SCR-SIST.
           MOVE WCC-COLPOA04 TO IDD-PROG FIO-PROG.
           MOVE IDD-VARI     TO SYS-CMMA.
           MOVE WNN-MAS507   TO SYS-TCMA.
           MOVE WCC-GNSPPIDD TO SYS-PROG.
           MOVE SYS-LINK     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA     TO IDD-VARI.

       FIN-IDD-CRG.
           EXIT.

      *COPY SGCBFOPE.

       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.

           IF WSS-LOGPMA04 = WSS-S
                PERFORM GNS-PRO-QUE.

       FIN-GNX-PRO-QUE.
           EXIT.

       BUS-ULT-ELEM SECTION.
       INI-BUS-ULT-ELEM.
           MOVE WSS-19 TO SEG-NUM-ITEM.
           MOVE WSS-1  TO WSS-ULT-REG.
       LUP-BUS-ULT-ELEM.
           IF SEG-NUM-ITEM NOT > ZEROES
              GO TO FIN-BUS-ULT-ELEM.
           IF WSS-ELE-SEGS(SEG-NUM-ITEM) > SPACES
              MOVE SEG-NUM-ITEM TO WSS-ULT-REG
           ELSE
              SUBTRACT WSS-1 FROM SEG-NUM-ITEM
              GO TO LUP-BUS-ULT-ELEM.
       FIN-BUS-ULT-ELEM.
           EXIT.
