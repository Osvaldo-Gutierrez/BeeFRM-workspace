*%! Codigo adicional para archivo
*% IF CMT_ID
      *<<<< CMT_ID
      **********************************************
      *     LISTADO DE CLIENTES SIN CLASIFICAR     *
      **********************************************
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSBRMSC.
       COPY GNSWCNUM.
       COPY GNSWVNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY TABBROFI.
       COPY TABBRCAM.

       01  WSS-VARI.
           03  WSS-IND-SUMA                          PIC X(03).
           03  WSS-IDC-ICLI-ANT.
               05  WSS-NUM-ICLI-ANT                  PIC X(08).
               05  WSS-IND-ICLI-ANT                  PIC X(01).
               05  WSS-GLS-ICLI-ANT                  PIC X(03).
           03  WSS-COD-PESO                          PIC X(06).
           03  WSS-COD-UF                            PIC X(06).
           03  WSS-VAL-UF                            PIC 9(11)V9(04).
           03  WSS-COD-DOLA                          PIC X(06).
           03  WSS-VAL-DOLA                          PIC 9(11)V9(04).
           03  WSS-COD-DOLO                          PIC X(06).
           03  WSS-VAL-DOLO                          PIC 9(11)V9(04).
           03  WSS-ALF-SELE      VALUE SPACES        PIC X(11).
           03  WSS-VAL-SELE      VALUE ZEROES        PIC 9(11).
           03  WSS-IND-SCTB                          PIC X(03).
           03  WSS-IND-MNAC      VALUE ZEROES        PIC 9(01).
           03  WSS-VAL-MNAC      VALUE ZEROES        PIC 9(11).
           03  WSS-COD-VCOC                          PIC X(06).
           03  WSS-COD-TOOC                          PIC X(03).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *>>>>
*% END
*% IF INI
      *<<<< INI
      *OBTIENE FECHA Y HORA DE PROCESO
           PERFORM GET-FHOY.

           PERFORM ABRE-ARCHIVOS.
           IF NOT FIO-STAT-OKS
               PERFORM GNS-PRO-ABT.

      * Obtiene Codigo Valor de Cambio Mediante CIC de Moneda
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * Obtiene Codigo de Moneda Dolar Mediante CIC '1013'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '101301'       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC101301NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLA IN WSS-VARI.

      * Obtiene Codigo de Moneda Dolar OBSERVADO Mediante CIC '101307'
      *     MOVE 'TAB'          TO FIO-SIST.
      *     MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
      *     MOVE '101307'       TO TAB-CIC-CTAB IN TAB.
      *     MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'TAB'          TO MSG-COD-SIST
      *         MOVE 'CIC101307NEX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
      *         PERFORM GNS-PRO-ABT.
      *     MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLO IN WSS-VARI.

      * Obtiene Codigo de Moneda U.F.Mediante CIC '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI.

      *BUSCA VALOR DE CAMBIO DE DOLARES USA A PESOS
           MOVE HOY-FHOY     IN HOY-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE HOY-FHOY     IN HOY-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-DOLA IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO : '
                  CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   DISPLAY 'IND. VIGENCIA NO VALIDO EN CAM : '
                           CAM-KEY-CAMB IN CAM
                   PERFORM GNS-PRO-ABT
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-DOLA IN WSS-VARI
                   DISPLAY 'VALOR DE CAMBIO  : '
                           CAM-KEY-CAMB IN CAM  '   ES DE    : ' 
                           WSS-VAL-DOLA IN WSS-VARI.

      *BUSCA VALOR DE CAMBIO DE DOLAR OBSERVADO A PESOS
      *     MOVE HOY-FHOY     IN HOY-VARI TO CAM-FEC-FCAM IN CAM(1).
      *     MOVE HOY-FHOY     IN HOY-VARI TO CAM-FEC-FCAM IN CAM(2).
      *     MOVE WSS-COD-DOLO IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
      *     MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
      *     MOVE FIO-GET-KEY  TO FIO-CMND.
      *     PERFORM TAB-FIO-CAM.
      *     IF NOT FIO-STAT-OKS
      *         DISPLAY 'NO EXISTE VALOR DE CAMBIO : '
      *            CAM-KEY-CAMB IN CAM
      *         PERFORM GNS-PRO-ABT
      *     ELSE
      *         IF CAM-IND-VIGE NOT = 'S'
      *             DISPLAY 'IND. VIGENCIA NO VALIDO EN CAM : '
      *                     CAM-KEY-CAMB IN CAM
      *             PERFORM GNS-PRO-ABT
      *         ELSE
      *             MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-DOLO IN WSS-VARI
      *             DISPLAY 'VALOR DE CAMBIO  : '
      *                     CAM-KEY-CAMB IN CAM  '   ES DE    : ' 
      *                     WSS-VAL-DOLO IN WSS-VARI.

      *BUSCA VALOR DE CAMBIO DE UF A PESOS
           MOVE HOY-FHOY     IN HOY-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE HOY-FHOY     IN HOY-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UF   IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO : '
                  CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   DISPLAY 'IND. VIGENCIA NO VALIDO EN CAM : '
                           CAM-KEY-CAMB IN CAM
                   PERFORM GNS-PRO-ABT
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF IN WSS-VARI
                   DISPLAY 'VALOR DE CAMBIO  : '
                           CAM-KEY-CAMB IN CAM  '   ES DE    : ' 
                           WSS-VAL-UF IN WSS-VARI.

      * Obtiene Ind. con CIC Situacion Contable Vencida en Tabla MSC
           MOVE 'COL'          TO MSC-COD-SIST.
           MOVE 'SCTB'         TO MSC-CIC-TMSC IN MSC.
           MOVE 'VCD'          TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC  MSC-CIC-TABL IN MSC
               PERFORM GNS-PRO-ABT.
           MOVE MSC-COD-CMSC IN MSC TO WSS-IND-SCTB IN WSS-VARI.

      *>>>>
*% END
*% IF FIN
      *<<<< FIN
           PERFORM CIERRA-ARCHIVOS.
           IF NOT FIO-STAT-OKS
               PERFORM CIERRA-ARCHIVOS
               MOVE PGM-SMAL TO PGM-STAT-SRT.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *Captura Monto Minimo
           DISPLAY 'MONTO MINIMO SELECCION EN PESOS ( 99999999999 ) : '
           ACCEPT  WSS-ALF-SELE IN WSS-VARI.
           DISPLAY WSS-ALF-SELE IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-NUM Validacion numerica Monto Minimo Seleccion
           MOVE WSS-ALF-SELE IN WSS-VARI TO NUM-NUME.
           MOVE NUM-ZERO-S               TO NUM-ZERO.
           MOVE NUM-SGNO-N               TO NUM-SGNO.
           MOVE 11                       TO NUM-NENT.
           MOVE 0                        TO NUM-NDCM.
           CALL 'GNSPVNUM' USING NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO WSS-VAL-SELE IN WSS-VARI
           ELSE
               MOVE ZEROES TO WSS-VAL-SELE IN WSS-VARI.
           DISPLAY WSS-VAL-SELE IN WSS-VARI.
           IF WSS-VAL-SELE IN WSS-VARI NOT > ZEROES
               PERFORM GNS-PRO-ABT.

      *EN EL TITULO DEL LISTADO SE MUESTRA EL PARAMETRO EXPRESADO EN
      *MILES DE PESOS
           DIVIDE WSS-VAL-SELE IN WSS-VARI BY 1000
                   GIVING WSS-VAL-SELE IN WSS-CSC.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      *>>>>
*% END
*% IF FIN_FST_INP
      *<<<< FIN_FST_INP
      *GUARDO CLIENTE LEIDO
           MOVE CSC-IDC-ICLI IN CSC TO WSS-IDC-ICLI-ANT IN WSS-VARI.
      *
           MOVE CSC-NUM-ICLI IN CSC TO SRT-NUM-ICLI IN SRT.
           MOVE CSC-VRF-ICLI IN CSC TO SRT-VRF-ICLI IN SRT.
           MOVE CSC-GLS-NOMC IN CSC TO SRT-GLS-NOMC IN SRT.
           MOVE CSC-COD-OFOC IN CSC TO SRT-COD-OFOC IN SRT.
           MOVE CSC-COD-OFOC IN CSC TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO SRT-GLS-OFOC IN SRT.

      *INICIALIZO CAMPOS
           MOVE ZEROES TO SRT-VAL-VCDA IN SRT.
           MOVE ZEROES TO SRT-VAL-VIGE IN SRT.
           MOVE ZEROES TO SRT-VAL-TOTA IN SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           IF CSC-IDC-ICLI IN CSC = WSS-IDC-ICLI-ANT IN WSS-VARI
      *ACUMULAR
               PERFORM SUM-VAL-DEU
               IF CSC-IND-SCTB IN CSC = 'VCD'
                   ADD WSS-VAL-MNAC IN WSS-VARI TO
                       SRT-VAL-VCDA IN SRT
                       SRT-VAL-TOTA IN SRT
                   GO TO NXT-INP-SRT
               ELSE
      *         IF CSC-IND-SCTB IN CSC = 'VIG' OR '   '
                  ADD WSS-VAL-MNAC IN WSS-VARI TO
                      SRT-VAL-VIGE IN SRT
                      SRT-VAL-TOTA IN SRT
                   GO TO NXT-INP-SRT
           ELSE
               IF SRT-VAL-TOTA IN SRT > WSS-VAL-SELE IN WSS-VARI
      *IMPRIME
                   PERFORM GRABA-SRT
      *MUEVE CSC LEIDO
                   MOVE CSC-IDC-ICLI IN CSC TO
                        WSS-IDC-ICLI-ANT IN WSS-VARI
                   MOVE CSC-NUM-ICLI IN CSC TO SRT-NUM-ICLI IN SRT
                   MOVE CSC-VRF-ICLI IN CSC TO SRT-VRF-ICLI IN SRT
                   MOVE CSC-GLS-NOMC IN CSC TO SRT-GLS-NOMC IN SRT
                   MOVE CSC-COD-OFOC IN CSC TO SRT-COD-OFOC IN SRT
                   MOVE CSC-COD-OFOC IN CSC TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   MOVE OFI-GLS-DESC IN OFI TO SRT-GLS-OFOC IN SRT
      *INICIALIZO CAMPOS
                   MOVE ZEROES TO SRT-VAL-VCDA IN SRT
                   MOVE ZEROES TO SRT-VAL-VIGE IN SRT
                   MOVE ZEROES TO SRT-VAL-TOTA IN SRT
                   GO TO LUP-INP-SRT
               ELSE
      *MUEVE CSC LEIDO
                   MOVE CSC-IDC-ICLI IN CSC TO
                        WSS-IDC-ICLI-ANT IN WSS-VARI
                   MOVE CSC-NUM-ICLI IN CSC TO SRT-NUM-ICLI IN SRT
                   MOVE CSC-VRF-ICLI IN CSC TO SRT-VRF-ICLI IN SRT
                   MOVE CSC-GLS-NOMC IN CSC TO SRT-GLS-NOMC IN SRT
                   MOVE CSC-COD-OFOC IN CSC TO SRT-COD-OFOC IN SRT
                   MOVE CSC-COD-OFOC IN CSC TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   MOVE OFI-GLS-DESC IN OFI TO SRT-GLS-OFOC IN SRT
      *INICIALIZO CAMPOS
                   MOVE ZEROES TO SRT-VAL-VCDA IN SRT
                   MOVE ZEROES TO SRT-VAL-VIGE IN SRT
                   MOVE ZEROES TO SRT-VAL-TOTA IN SRT
                   GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
      *>>>>
*% END
*% IF FIN_INP
      *<<<< FIN_INP
      *VERIFICA EL ULTIMO CLIENTE LEIDO
           IF SRT-VAL-TOTA IN SRT > WSS-VAL-SELE IN WSS-VARI
      *IMPRIME
               PERFORM GRABA-SRT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *****************************************************************
       GRABA-SRT SECTION.
       INI-GRABA-SRT.
      *DIVIDE VALORES POR MIL, PARA SER EXPRESADOS EN MILES DE PESOS
      *     DIVIDE SRT-VAL-VCDA IN SRT BY 1000
      *             GIVING SRT-VAL-VCDA IN SRT.
      *     DIVIDE SRT-VAL-VIGE IN SRT BY 1000
      *             GIVING SRT-VAL-VIGE IN SRT.
      *     MOVE ZEROES TO SRT-VAL-TOTA IN SRT.
      *     ADD SRT-VAL-VCDA IN SRT SRT-VAL-VIGE IN SRT
      *             TO SRT-VAL-TOTA IN SRT.
           MOVE ZEROES TO SRT-VAL-TOTA IN SRT.
           ADD SRT-VAL-VCDA IN SRT SRT-VAL-VIGE IN SRT
                    TO SRT-VAL-TOTA IN SRT.
           DIVIDE SRT-VAL-TOTA IN SRT BY 1000
                   GIVING SRT-VAL-TOTA IN SRT ROUNDED.
           DIVIDE SRT-VAL-VIGE IN SRT BY 1000
                   GIVING SRT-VAL-VIGE IN SRT ROUNDED.
           SUBTRACT SRT-VAL-VIGE IN SRT FROM SRT-VAL-TOTA IN SRT
                 GIVING SRT-VAL-VCDA IN SRT.
           RELEASE SRT.
       FIN-GRABA-SRT.
           EXIT.
      *****************************************************************
      * Seleccion del Registro para Proceso Mediante Oficina del Listado
       SUM-VAL-DEU SECTION.
       INI-SUM-VAL-DEU.

           MOVE 0      TO WSS-IND-MNAC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-MNAC IN WSS-VARI.

      *OPC ES U.F., TOMA VALOR DE CAMBIO YA BUSCADO
           IF WSS-COD-UF IN WSS-VARI = CSC-COD-VCOC IN CSC
               MULTIPLY CSC-VAL-SCRE IN CSC BY WSS-VAL-UF IN WSS-VARI
                        GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
               GO TO FIN-SUM-VAL-DEU.

      *OPC ES DOLAR U.S.A, TOMA VALOR DE CAMBIO YA BUSCADO
           IF WSS-COD-DOLA IN WSS-VARI = CSC-COD-VCOC IN CSC
               MULTIPLY CSC-VAL-SCRE IN CSC BY WSS-VAL-DOLA IN WSS-VARI
                        GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
               GO TO FIN-SUM-VAL-DEU.

      *OPC ES DOLAR OBSERVADO, TOMA VALOR DE CAMBIO YA BUSCADO
      *     IF WSS-COD-DOLO IN WSS-VARI = CSC-COD-VCOC IN CSC
      *         MULTIPLY CSC-VAL-SCRE IN CSC BY WSS-VAL-DOLO IN WSS-VARI
      *                  GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
      *         GO TO FIN-SUM-VAL-DEU.

           IF WSS-COD-PESO IN WSS-VARI NOT = CSC-COD-VCOC IN CSC
               PERFORM BUS-VAL-CAM.

           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY CSC-VAL-SCRE IN CSC BY CAM-SGV-VCAM IN CAM
                              GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
           ELSE
               MOVE CSC-VAL-SCRE IN CSC TO WSS-VAL-MNAC IN WSS-VARI.

       FIN-SUM-VAL-DEU.
           EXIT.
      *****************************************************************
      * Obtiene Valor de Cambio de Oper. de Credito en Moneda Nacional
      * al DIA DE HOY
       BUS-VAL-CAM SECTION.
       INI-BUS-VAL-CAM.
           MOVE HOY-FHOY IN HOY-VARI     TO CAM-FEC-FCAM IN CAM(1).
           MOVE HOY-FHOY IN HOY-VARI     TO CAM-FEC-FCAM IN CAM(2).
           MOVE CSC-COD-VCOC IN CSC      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO : '
                  CAM-KEY-CAMB IN CAM
               '    PARA OPC : ' CSC-CIC-IOPC IN CSC
               PERFORM GNS-PRO-ABT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   DISPLAY 'IND. VIGENCIA NO VALIDO EN CAM : '
                           CAM-KEY-CAMB IN CAM
                   PERFORM GNS-PRO-ABT
               ELSE
                   MOVE  1  TO WSS-IND-MNAC IN WSS-VARI.
       FIN-BUS-VAL-CAM.
           EXIT.
      *****************************************************************
       ABRE-ARCHIVOS SECTION.
       INI-ABRE-ARCHIVOS.

      *EFECTUA APERTURA DE ARCHIVOS
           MOVE 'TAB'   TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           DISPLAY 'STATUS DE APERTURA FIO-INP TABTAB : ' FIO-STAT.

           MOVE 'COL'   TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           DISPLAY 'STATUS DE APERTURA FIO-INP COLTAB : ' FIO-STAT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           DISPLAY 'STATUS DE APERTURA FIO-INP TABCAM : ' FIO-STAT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.
           DISPLAY 'STATUS DE APERTURA FIO-INP TABOFI : ' FIO-STAT.

       FIN-ABRE-ARCHIVOS.
           EXIT.

       CIERRA-ARCHIVOS SECTION.
       INI-CIERRA-ARCHIVOS.

      *CIERRA ARCHIVOS
           MOVE 'TAB'   TO FIO-SIST.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE 'COL'   TO FIO-SIST.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM TAB-FIO-OFI.
           PERFORM TAB-FIO-CAM.
       FIN-CIERRA-ARCHIVOS.
           EXIT.
      *****************************************************************
       COPY GNSBFMSC.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBFOFI.
       COPY TABBFCAM.
       COPY TABBBOFI.
       COPY TABBVOFI.
      *>>>>
*% END
