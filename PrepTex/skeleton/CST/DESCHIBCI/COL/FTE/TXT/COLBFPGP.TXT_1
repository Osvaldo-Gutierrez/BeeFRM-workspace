      *Modulo FIO interactivo para registro PGP de VSAM, 03-Apr-95 04:43 PM

       COL-FIO-PGP SECTION.
       INI-COL-FIO-PGP.
           MOVE 320    TO FIO-RLEN.
           MOVE FIO-CMND TO FIO-IAKY FIO-IGET.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'PGP-KEY-IPGP' OR FIO-AKEY NOT > SPACES )
               MOVE PGP-KEY-IPGP IN PGP TO FIO-VKEY
               MOVE 'COL0PGP' TO FIO-VOID
               MOVE 44     TO FIO-KLEN
           ELSE
               MOVE 'En COL-FIO-PGP, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.

           IF FIO-CMND = FIO-PUT OR FIO-MOD
               MOVE PGP TO FIO-DFLD.
           PERFORM FIO.
           IF FIO-STAT-OKS AND FIO-IGET-YES
               MOVE FIO-BUF0 TO PGP.
           MOVE SPACES TO FIO-AKEY.
       FIN-COL-FIO-PGP.
           EXIT.
