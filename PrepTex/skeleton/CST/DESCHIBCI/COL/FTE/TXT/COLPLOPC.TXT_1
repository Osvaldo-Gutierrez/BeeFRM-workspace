*%! Codigo adicional para archivo
*% IF WSS
      *<<<< WSS
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRCAM.
       COPY TABBRTIO.
       COPY GNSBRMSC.
       COPY COLBRDLC.
       COPY COLBRTOC.
       COPY COLBRICG.
       COPY COLBRCYA.
       COPY COLBRAUT.
       COPY COLBRITR.
       COPY COLBRCOM.
       COPY COLBRRDC.
       COPY COLBRROV.
       COPY SGCBRDBC.
       COPY SGCBRRCD.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       01  WSS-VARI.
      * FECHA INICIO DE PROCESO
           03 WSS-FEC-FINI.
              05 WSS-NUM-DINI                          PIC 9(02).
              05 WSS-NUM-MINI                          PIC 9(02).
              05 WSS-NUM-SINI                          PIC 9(02).
              05 WSS-NUM-AINI                          PIC 9(02).
      * FECHA TERMINO DE PROCESO
           03 WSS-FEC-FTER.
              05 WSS-NUM-DTER                          PIC 9(02).
              05 WSS-NUM-MTER                          PIC 9(02).
              05 WSS-NUM-STER                          PIC 9(02).
              05 WSS-NUM-ATER                          PIC 9(02).
      * ESTADO DE OPERACION
           03 WSS-COD-STAT                             PIC X(01).
           03 WSS-FEC-FFIN.
              05 WSS-NUM-SFIN                          PIC 9(02).
              05 WSS-NUM-AFIN                          PIC 9(02).
              05 WSS-NUM-MFIN                          PIC 9(02).
              05 WSS-NUM-DFIN                          PIC 9(02).
           03 WSS-FEC-FFTR.
              05 WSS-NUM-SFTR                          PIC 9(02).
              05 WSS-NUM-AFTR                          PIC 9(02).
              05 WSS-NUM-MFTR                          PIC 9(02).
              05 WSS-NUM-DFTR                          PIC 9(02).
           03 WSS-COD-OFOC                             PIC X(03).
           03 WSS-IND-NEXT                             PIC 9(01). 
           03 WSS-IND-MCYA                             PIC X(01).
           03 WSS-IND-MITR                             PIC X(01).
           03 WSS-IND-MCOM                             PIC X(01).
           03 WSS-COD-COOC.
              05 WSS-COD-TOOC                          PIC X(03).
              05 WSS-COD-AOOC                          PIC X(03).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *>>>>
*% END
*% IF CF_OPC_OPC_COD_OFOC
      *<<<< CF_OPC_OPC_COD_OFOC
           MOVE ZEROES TO PAGE-COUNTER.
      *>>>>
*% END
*% IF PH_OPC
      *<<<< PH_OPC
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'STT' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-MSC-STAT IN SRT TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR IN TAB TO WSS-MSC-STAT IN WSS-OPC.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      * Captura Fecha Inicio de Proceso
           DISPLAY 'FECHA INICIO DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      * Captura Fecha Termino de Proceso
           DISPLAY 'FECHA TERMINO DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      * Captura Estado de Operacion
            DISPLAY 'ESTADO DE OPERACION (*=TODAS) : '.
            MOVE SPACES TO WSS-COD-STAT IN WSS-VARI.
            ACCEPT  WSS-COD-STAT IN WSS-VARI.
            DISPLAY WSS-COD-STAT IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha Inicio de Proceso
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.
 
           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DINI IN WSS-OPC
                                            WSS-NUM-DFIN IN WSS-VARI.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MINI IN WSS-OPC
                                            WSS-NUM-MFIN IN WSS-VARI.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SINI IN WSS-OPC
                                            WSS-NUM-SFIN IN WSS-VARI.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AINI IN WSS-OPC
                                            WSS-NUM-AFIN IN WSS-VARI.

      *VAL-FEC Valida Fecha Termino de Proceso
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.
 
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DTER IN WSS-OPC
                                            WSS-NUM-DFTR IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MTER IN WSS-OPC
                                            WSS-NUM-MFTR IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-STER IN WSS-OPC
                                            WSS-NUM-SFTR IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ATER IN WSS-OPC
                                            WSS-NUM-AFTR IN WSS-VARI.

      *VAL-TAB Valida Estado de Operacion
           IF WSS-COD-STAT IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-STAT IN WSS-VARI.
           IF WSS-COD-STAT IN WSS-VARI NOT = '*'
               MOVE 'GNS' TO TAB-COD-SIST
               MOVE 'STT' TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-STAT IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS > SPACES
                   DISPLAY 'ESTADO DE OPERACION NO VALIDO'
                   PERFORM GNS-PRO-END.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           MOVE WSS-FEC-FFIN IN WSS-VARI TO OPC-FEC-FCOL IN OPC.
           MOVE 'OPC-FEC-FCOL' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FCOL IN OPC > WSS-FEC-FFTR IN WSS-VARI
               DISPLAY 'NO HAY REGISTRO PARA ESTE RANGO DE FECHAS : '
                WSS-FEC-FFIN IN WSS-VARI ' ' WSS-FEC-FFTR IN WSS-VARI
               GO TO FIN-INP-SRT.
           GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT.

      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           MOVE 'OPC-FEC-FCOL' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF OPC-FEC-FCOL IN OPC > WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           PERFORM GEN-LIN-OUT.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-OUT-SRT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      **************************************************************************
      * Seleccion del Registro para Proceso Mediante Fecha y Estado
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF OPC-MSC-STAT IN OPC NOT = WSS-COD-STAT IN WSS-VARI AND 
              WSS-COD-STAT IN WSS-VARI NOT = '*'
               GO TO FIN-SEL-REG-PRO.

           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      **************************************************************************
      * Genera Lineas de Detalle a Partir de Registro SRT Ordenado
       GEN-LIN-OUT SECTION.
       INI-GEN-LIN-OUT.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.

           PERFORM BUS-REG-CLI.

      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-OPC.

      * Mediante BUS-MSC Busca Tipo de Moneda
           IF OPC-MSC-TVOC IN SRT > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-TVOC IN SRT TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TVOC IN WSS-OPC
           ELSE
               MOVE SPACES TO WSS-GLS-TVOC IN WSS-OPC.

      * Mediante BUS-TAB Busca Tipo de Operacion Credito de Tabla TIO
           IF OPC-COD-TOOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOOC IN WSS-OPC
           ELSE
               MOVE SPACES TO WSS-GLS-TOOC IN WSS-OPC.

      * Mediante BUS-TAB Busca Clase de Operacion Credito de Tabla AUX
           MOVE OPC-COD-AOOC IN SRT TO WSS-COD-AOOC IN WSS-VARI.
           MOVE OPC-COD-TOOC IN SRT TO WSS-COD-TOOC IN WSS-VARI.
           IF WSS-COD-COOC IN WSS-VARI > SPACES
               MOVE 'COL'                    TO TAB-COD-SIST
               MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-COOC IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AOOC IN WSS-OPC
           ELSE
               MOVE SPACES TO WSS-GLS-AOOC IN WSS-OPC.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCOC IN WSS-OPC
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-OPC.

      * Busca Datos de CYA
           PERFORM GET-CUR-CYA.
           IF FIO-STAT-OKS
                PERFORM GET-NXT-CYA
                IF WSS-IND-MCYA = 'M'
                    MOVE 'M'    TO CYA-IND-TCYA IN CYA
                    MOVE SPACES TO CYA-CAI-ICYA IN CYA
                    MOVE ZEROES TO CYA-IIC-ICYA IN CYA
                ELSE
                    NEXT SENTENCE
           ELSE
                MOVE SPACES TO CYA-IND-TCYA IN CYA
                MOVE SPACES TO CYA-CAI-ICYA IN CYA
                MOVE ZEROES TO CYA-IIC-ICYA IN CYA.

      * Busca Datos de AUT
           MOVE OPC-CAI-IOPC IN SRT TO AUT-CAI-IOPC IN AUT.
           MOVE OPC-IIC-IOPC IN SRT TO AUT-IIC-IOPC IN AUT.
           MOVE 'AUT'               TO AUT-NUM-ICAN IN AUT.
           MOVE 1                   TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO AUT-CAI-ICYA IN AUT
               MOVE ZEROES TO AUT-IIC-ICYA IN AUT.

      * Busca Datos de ITR
           PERFORM GET-CUR-ITR.
           IF FIO-STAT-OKS
               PERFORM GET-NXT-ITR
               IF WSS-IND-MITR = 'M'
                  MOVE 'MULTIPLES'  TO ITR-COD-TINT IN ITR
                  MOVE ZEROES       TO ITR-SGV-TINT IN ITR
               ELSE
                  NEXT SENTENCE
           ELSE
               MOVE ZEROES TO ITR-SGV-TINT IN ITR
               MOVE SPACES TO ITR-COD-TINT IN ITR.

      * Busca Datos de COM
           PERFORM GET-CUR-COM.
           IF FIO-STAT-OKS
               PERFORM GET-NXT-COM
               IF WSS-IND-MCOM = 'M'
                  MOVE 'MULTIPLES'  TO COM-COD-TINT IN COM
                  MOVE ZEROES       TO COM-SGV-TINT IN COM
               ELSE
                  NEXT SENTENCE
           ELSE
               MOVE ZEROES TO COM-SGV-TINT IN COM
               MOVE SPACES TO COM-COD-TINT IN COM.

      *BUS-MSC busca glosa de miscelaneo en tabla
           IF OPC-MSC-MCVF IN SRT > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'MCVF' TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-MCVF IN SRT TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-MCVF IN WSS-OPC
           ELSE
               MOVE SPACES TO WSS-GLS-MCVF IN WSS-OPC.

      *BUS-TAB busca glosa de Tabla
           IF OPC-MSC-STAT IN SRT > SPACES
               MOVE 'GNS' TO TAB-COD-SIST
               MOVE 'STT' TO TAB-COD-TTAB IN TAB
               MOVE OPC-MSC-STAT IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-STAT IN WSS-OPC
           ELSE
               MOVE SPACES TO WSS-GLS-STAT IN WSS-OPC.

      *BUS-USR busca usuario en tablas
           IF OPC-COD-RMOC IN SRT > SPACES
               MOVE OPC-COD-RMOC IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-OPC
           ELSE
               MOVE SPACES TO WSS-GLS-RMOC IN WSS-OPC.

      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-CDOC IN SRT > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'DES ' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-CDOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CDOC IN WSS-OPC
           ELSE
               MOVE SPACES TO WSS-GLS-CDOC IN WSS-OPC.

       FIN-GEN-LIN-OUT.
           EXIT.
      **************************************************************************
      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro RDC
       BUS-REG-CLI SECTION.
       INI-BUS-REG-CLI.
      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en RDC
      * RDC-NUM-IDLC = 0 ====> DEU.DIR.
           MOVE OPC-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RDC-KEY-IDLC IN RDC
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               GO TO FIN-BUS-REG-CLI.

      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-NUM-ICLI IN DBC
                              DBC-VRF-ICLI IN DBC
                              DBC-IND-ICLI IN DBC
                              WSS-IND-SCLI IN WSS-OPC
                              DBC-GLS-ICLI IN DBC
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
               IF DBC-GLS-ICLI IN DBC > SPACES
                   MOVE '-'    TO WSS-IND-SCLI IN WSS-OPC
               ELSE
                   MOVE SPACES TO WSS-IND-SCLI IN WSS-OPC.

           MOVE DBC-CAI-ICLI IN DBC TO RCD-CAI-ICLI IN RCD.
           MOVE DBC-IIC-ICLI IN DBC TO RCD-IIC-ICLI IN RCD.
           MOVE RDC-NUM-DIRE IN RDC TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO RCD-NUM-DIRE IN RCD
           ELSE
               MOVE RCD-NUM-DIRE IN RCD TO RCD-NUM-DIRE IN RCD.

           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS OR
              RDC-CAI-IOPC IN RDC NOT = OPC-CAI-IOPC IN SRT OR
              RDC-IIC-IOPC IN RDC NOT = OPC-IIC-IOPC IN SRT OR
              RDC-NUM-IDLC IN RDC NOT = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE 'MULTIPLES'    TO DBC-GLS-NOMC IN DBC.
       FIN-BUS-REG-CLI.
           EXIT.
      **************************************************************************
      * Busca Datos de CYA.
       GET-CUR-CYA SECTION.
       INI-GET-CUR-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE OPC-CAI-IOPC IN SRT TO CYA-CAI-IOPC IN CYA.
           MOVE OPC-IIC-IOPC IN SRT TO CYA-IIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS AND
              CYA-CAI-IOPC IN CYA = OPC-CAI-IOPC IN SRT AND
              CYA-IIC-IOPC IN CYA = OPC-IIC-IOPC IN SRT AND
              CYA-NUM-ICAN IN CYA = ZEROES AND
              CYA-NUM-ICYA IN CYA = 1
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-CYA.
           EXIT.

       GET-NXT-CYA SECTION.
       INI-GET-NXT-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS                              AND
              OPC-CAI-IOPC IN SRT = CYA-CAI-IOPC IN CYA AND
              OPC-IIC-IOPC IN SRT = CYA-IIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES
               MOVE 'M' TO WSS-IND-MCYA
           ELSE
               MOVE SPACES TO WSS-IND-MCYA
               PERFORM GET-CUR-CYA.
       FIN-GET-NXT-CYA.
           EXIT.
      **************************************************************************
      * Busca Datos de ITR.
       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CAI-IOPC IN SRT TO ITR-CAI-IOPC IN ITR.
           MOVE OPC-IIC-IOPC IN SRT TO ITR-IIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CAI-IOPC IN ITR = OPC-CAI-IOPC IN SRT AND
                    ITR-IIC-IOPC IN ITR = OPC-IIC-IOPC IN SRT AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-ITR.
           EXIT.

       GET-NXT-ITR SECTION.
       INI-GET-NXT-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS                              AND
              ITR-CAI-IOPC IN ITR = OPC-CAI-IOPC IN SRT AND
              ITR-IIC-IOPC IN ITR = OPC-IIC-IOPC IN SRT AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
                MOVE 'M' TO WSS-IND-MITR
           ELSE
                MOVE SPACES TO WSS-IND-MITR
                PERFORM GET-CUR-ITR.
       FIN-GET-NXT-ITR.
           EXIT.
      **************************************************************************
      * Busca Datos de COM.
       GET-CUR-COM SECTION.
       INI-GET-CUR-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CAI-IOPC IN SRT TO COM-CAI-IOPC IN COM.
           MOVE OPC-IIC-IOPC IN SRT TO COM-IIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE 'COM'               TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CAI-IOPC IN COM = OPC-CAI-IOPC IN SRT AND
                    COM-IIC-IOPC IN COM = OPC-IIC-IOPC IN SRT AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = 'COM' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COM.
           EXIT.

       GET-NXT-COM SECTION.
       INI-GET-NXT-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF FIO-STAT-OKS                              AND
              COM-CAI-IOPC IN COM = OPC-CAI-IOPC IN SRT AND
              COM-IIC-IOPC IN COM = OPC-IIC-IOPC IN SRT AND
              COM-NUM-ICAN IN COM = ZEROES              AND
              COM-CIC-IOPV IN COM = SPACES              AND
              COM-NUM-IVCT IN COM = ZEROES              AND
              COM-IND-TTAS IN COM = 'COM'
                MOVE 'M' TO WSS-IND-MCOM
           ELSE
                MOVE SPACES TO WSS-IND-MCOM
                PERFORM GET-CUR-COM.
       FIN-GET-NXT-COM.
           EXIT.
      **************************************************************************
       COPY TABBFOFI.
       COPY TABBFCAM.
       COPY TABBFUSR.
       COPY COLBFDLC.
       COPY COLBFTOC.
       COPY COLBFICG.
       COPY COLBFCYA.
       COPY COLBFAUT.
       COPY COLBFITR.
       COPY COLBFCOM.
       COPY COLBFROV.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY SGCBFRCD.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY GNSBBMSC.
       COPY GNSBFMSC.
       COPY TABBVOFI.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY SGCBGCLI.
      *>>>>
*% END
