*%! Codigo adicional para programa
*% IF SETTAG
*% FNCPQ = "111002"
*% VSNPQ = "11.10.11"
*% FNCPU = "111002"
*% VSNPU = "11.10.11"
*% END
*% IF PGM_PQ
*%   HDR_CST = FALSE
*% END
*% NO_TIENE_TIMESTAMP = TRUE
*% IF CMT_ID
      *<<<< CMT_ID
      * ISP-INI 07/11/2011 POR PROYECTO
      * Proyecto     : 06-11-2011 1110_02 BCI CGM Log tablas POC y PVC
      * Modificacion : 06/11/2011 Ivan Silva P.
      * Objetivos    : Implementar log de administrador
      * Etiqueta de  : ISP-INI 06-11-2011 1110_02 BCI 
      *                CGM Log para tablas POC y PVC
      * ISP-FIN
      *-------------------------------------------------------------------
      *JCT-INI 11-01-2012 Validacion y Generacion Automatizada de Productos
      * Proyecto     : Validacion y Generacion Automatizada de Productos
      * Modificacion : Jtorres
      * Objetivos    : Incorporacion nuevos campos en pantalla PO2
      *                y validaciones adicionales, Pantalla PO1
      *                asociada se debe recompilar
      * Etiqueta     :JCT-INI 11-01-2012
      *               Validacion y Generacion Automatizada de Productos 
      *JCT-FIN 11-01-2012
      *>>>> CMT_ID
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY COLWIPO1 REPLACING ==01  PO1-FLD== BY ==03  PO1-FLD==
      *PVG INI 14-MAY-2002
                               ==01  PO1-STP== BY ==03  PO1-STP==
      *PVG FIN 14-MAY-2002
                               ==01  PO1-EDT== BY ==03  PO1-EDT==.  
       COPY COLWIPO2 REPLACING ==01  PO2-FLD== BY ==03  PO2-FLD==
      *PVG INI 14-MAY-2002
                               ==01  PO2-STP== BY ==03  PO2-STP==
      *PVG FIN 14-MAY-2002
                               ==01  PO2-EDT== BY ==03  PO2-EDT==.  
       COPY COLWGPOC.
       77  WSS-COD-ENTI         VALUE 'POC'        PIC X(03).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
*% IF PGM_PU
      *AFRI-INI 13-MAY-2014 PLATAFORMA UNICA
       COPY MC2WGPPC.
       COPY GNSWGQUE.
       COPY GNSWGTSK.
      *AFRI-FIN 13-MAY-2014 PLATAFORMA UNICA
*% END
      *JCT-INI 11-01-2012 Validacion y Generacion Automatizada de Productos
       COPY COLBRPVC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PVC-REQA==.
      *JCT-FIN 11-01-2012
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
*% IF PGM_PU
      *AFRI-INI 13-MAY-2014 PLATAFORMA UNICA
       01 MPC-ACT          VALUE 'ACT'      PIC X(03).
       01 MPC-VARI.
          03 SYS-CMMA-AUX.
             05 SYS-SCR-MENS-AUX                  PIC X(79).
             05 SYS-SCR-VARI-AUX                  PIC X(3421).
          03 SYS-CMND-AUX             VALUE 0     PIC 9(02).
      *    PROGRAMA
          03 SYS-PROG-AUX                         PIC X(08).
          03 SYS-PROG-RED-AUX REDEFINES SYS-PROG-AUX
                                                  OCCURS 8 PIC X(01).
          03 SYS-TCMA-AUX  COMP                   PIC S9(4).
      *AFRI-FIN 13-MAY-2014 PLATAFORMA UNICA
*% END
       01  WSS-FEC-VARI.
           03  WSS-NUM-NFEC             VALUE 0      PIC 9(03).
           03  WSS-FEC-NFE1.
               05  WSS-NUM-DFE1         VALUE 0      PIC 9(02).
               05  WSS-NUM-MFE1         VALUE 0      PIC 9(02).
               05  WSS-NUM-SFE1         VALUE 0      PIC 9(02).
               05  WSS-NUM-AFE1         VALUE 0      PIC 9(02).
           03  WSS-FEC-NFE2.
               05  WSS-NUM-DFE2         VALUE 0      PIC 9(02).
               05  WSS-NUM-MFE2         VALUE 0      PIC 9(02).
               05  WSS-NUM-SFE2         VALUE 0      PIC 9(02).
               05  WSS-NUM-AFE2         VALUE 0      PIC 9(02).
       01  WSS-COD-VCAM.
           03  WSS-COD-TVTI                      PIC X(01).
           03  WSS-COD-CVTI                      PIC X(03).
           03  WSS-COD-TCTI                      PIC X(02).
       01  WSS-COD-COOC.
           03  WSS-COD-TOOC                      PIC X(03).
           03  WSS-COD-AOOC                      PIC X(03).
       01  WSS-GLS-PCMI.
           03  WSS-NUM-MCMI                      PIC 9(02).
           03  WSS-NUM-DCMI                      PIC 9(02).
       01  WSS-GLS-PCMA.
           03  WSS-NUM-MCMA                      PIC 9(02).
           03  WSS-NUM-DCMA                      PIC 9(02).
       01  WSS-FEC-RANG.
           03  WSS-NUM-MRAN                      PIC 9(02).
           03  WSS-NUM-DRAN                      PIC 9(02).
       01  WSS-NUM-DIGT                          PIC 9(02).
       COPY GNSBRLOG.
           03 LOG-GLS-DATA                       PIC X(695).
      *>>>>
*% END
*% WIG_USR = TRUE
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
      * Common Area para manejo de programa COLPAPO1 PO2.
           02 FILLER                        PIC X(3010).
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *>>>>
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO POC-NUM-DTRN IN POC.
           MOVE HOY-MHOY TO POC-NUM-MTRN IN POC.
           MOVE HOY-SHOY TO POC-NUM-STRN IN POC.
           MOVE HOY-AHOY TO POC-NUM-ATRN IN POC.
      *<<<< 
*% END 
*% IF FIN_LUP_MAIN
      *<<<< FIN_LUP_MAIN
           MOVE FRM-MENS TO SCR-MENS-EXT.
           IF SCR-INST = SCR-INST-HCM
               PERFORM EGR-FTER-CMN
           ELSE
               PERFORM EGR-FTER-CIC.
      *>>>>
*% END
*% IF INI_PRO_ALL
      *<<<< INI_PRO_ALL
           MOVE '1'    TO FRM-CPIM-AEY.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      *JSS MOVE PO1-FLD-EXT TO PO1-FLD.
           MOVE WSS-TCMA TO SCR-TCMA.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
                 MOVE WSS-INST-NULL TO SCR-INST-EXT
                 PERFORM ING-FPEN-CIC.
      *>>>>
*% END
*% IF PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
      *<<<< PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
*% END
*% IF SCR_GFLD_VAL_CON_FLD
      *<<<< SCR_GFLD_VAL_CON_FLD
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM EGR-FPEN-BCK.
      *>>>>
*% END
*% IF FIN_GET_ACC
      *<<<< FIN_GET_ACC
           IF FRM-FFLD = FRM-FFLD-PF7
               IF SCR-CONF > SPACES
                   PERFORM VAL-NUM-KEY-PO2
                   PERFORM VAL-NUM-FLD-PO2
                   PERFORM EGR-FPEN-BCK
               ELSE
                   PERFORM EGR-FPEN-BCK.

           IF SCR-CCPP = 'ELI'
           IF FRM-FFLD = FRM-FFLD-RET OR
              FRM-FFLD = FRM-FFLD-PF10
           IF LAP-COD-COME IN PO2-FLD NOT > SPACES
               MOVE 'COMEPO2OBL' TO MSG-COD-MENS
               MOVE 'COL'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC
                    TO FRM-MENS
                       PO2-GLS-MENS
               PERFORM UNP-LAP-PO2
               PERFORM FST-FLD-PO2
               PERFORM SCR-PUTA
               MOVE SCR-NTRN TO SYS-NTRN
               MOVE SCR-INST-GCS TO SCR-INST
               MOVE SCR-VARI TO SYS-CMMA
               MOVE SCR-TCMA TO SYS-TCMA
               MOVE SYS-RTRN TO SYS-CMND
               PERFORM GNS-PRO-SYS.

      *>>>>
*% END
*% IF FIN_GET_CON OR FIN_SCR_GCNF
      *<<<< FIN_GET_CON OR FIN_SCR_GCNF
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-PO2
               PERFORM VAL-NUM-FLD-PO2
               PERFORM EGR-FPEN-BCK.
      *>>>>
*% END
*% IF INI_XCT_PRGP
      *<<<< INI_XCT_PRGP
           GO TO FIN-XCT-PRGP.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
*% FRM = "PO2"
*% INCLUDE '[CST.DES.COL.FTE.TXT]COLMPPOC.TXT'
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBPVRF.
       COPY GNSBGCPT.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       COPY COLBQPO1.
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       COPY COLBUPO1.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LAP-REQA==.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY COLBRLAP.
      *>>>>
*% END
*% IF INI_FIO_IBM
      *<<<< INI_FIO
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
           PERFORM GET-FHOY.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
      *>>>> INI_FIO
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING LAP POC
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
            PERFORM PRO-ING-REG-LAP.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
      *>>>> FIN_CMN_ING LAP POC
*% END
*% IF FIN_CMN_ELI 
      *<<<< FIN_CMN_ELI
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
            PERFORM PRO-ELI-REG-LAP.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
      *>>>> FIN_CMN_ELI
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
            PERFORM PRO-MOD-ANT-REG-LAP.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
      *>>>> CMN_MOD_RET
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD LAP POC ISP-INI
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
*% IF PGM_PU
      *AFRI-INI 13-MAY-2014 PLATAFORMA UNICA
            IF FIO-STAT-OKS
                MOVE MPC-ACT TO MC2POC-IND-CMND
                PERFORM POC-PPC.
      *AFRI-FIN 13-MAY-2014 PLATAFORMA UNICA
*% END
            PERFORM PRO-MOD-DES-REG-LAP.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
      *>>>> FIN_CMN_MOD
*% END 
*% IF EOF
      *<<<< EOF
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
       COPY COLBFLAP.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$

      *JCT-INI 11-01-2012 Validacion y Generacion Automatizada de Productos
       COPY COLBFPVC.
      *JCT-FIN 11-01-2012
       
*% IF PGM_PU
      *AFRI-INI 13-MAY-2014 PLATAFORMA UNICA
       COPY MC2BKPPC.
       COPY GNSBGQUE.
       COPY GNSBGTSK.

       POC-PPC SECTION.
       INI-POC-PPC.

           MOVE SYS-CMMA TO SYS-CMMA-AUX.
           MOVE SYS-CMND TO SYS-CMND-AUX.
           MOVE SYS-PROG TO SYS-PROG-AUX.
           MOVE SYS-TCMA TO SYS-TCMA-AUX.
           MOVE POC TO MC2POC.
           PERFORM MC2-LNK-PPC.
           MOVE SYS-CMMA-AUX TO SYS-CMMA.
           MOVE SYS-CMND-AUX TO SYS-CMND.
           MOVE SYS-PROG-AUX TO SYS-PROG.
           MOVE SYS-TCMA-AUX TO SYS-TCMA.
      *PVG INI 11-SEP-2014
           MOVE MC2POC-GLS-MEN2 TO FRM-MEN2.
      *PVG FIN 11-SEP-2014
       FIN-POC-PPC.
           EXIT.
      *AFRI-FIN 13-MAY-2014 PLATAFORMA UNICA

      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
       PRO-MOD-ANT-REG-LAP  SECTION.
       INI-MOD-ANT-REG-LAP.
      *-----------------------------
           MOVE   SPACES                  TO  LAP.
           MOVE   'MOD'                   TO  LAP-COD-EVEN IN LAP.
           MOVE   'M'                     TO  LAP-COD-TACC IN LAP
                                              LAP-COD-STAT IN LAP.
           MOVE   'ANT'                   TO  LAP-COD-INST IN LAP.
           MOVE     1                     TO  LAP-NUM-CLAP IN LAP
                                              LAP-NUM-CPOC IN LAP
                                              LAP-NUM-CAUT IN LAP.
           PERFORM PRO-GRABA-REG-LAP.
       FIN-MOD-ANT-REG-LAP.
            EXIT.
       
       PRO-MOD-DES-REG-LAP  SECTION.
       INI-MOD-DES-REG-LAP.
      *-----------------------------
           MOVE   SPACES                  TO  LAP.
           MOVE   'MOD'                   TO  LAP-COD-EVEN IN LAP.
           MOVE   'M'                     TO  LAP-COD-TACC IN LAP
                                              LAP-COD-STAT IN LAP.
           MOVE   'DES'                   TO  LAP-COD-INST IN LAP.
           MOVE     2                     TO  LAP-NUM-CLAP IN LAP
                                              LAP-NUM-CPOC IN LAP
                                              LAP-NUM-CAUT IN LAP.
           PERFORM PRO-GRABA-REG-LAP.
       FIN-MOD-DES-REG-LAP.
           EXIT.
      *
       PRO-ING-REG-LAP  SECTION.                                                
       INI-ING-REG-LAP.                                                         
      *-------------------------                                                
           MOVE   SPACES                  TO  LAP.                              
           MOVE   'ING'                   TO  LAP-COD-EVEN IN LAP.              
           MOVE   'I'                     TO  LAP-COD-TACC IN LAP               
                                              LAP-COD-STAT IN LAP.              
           MOVE   'N/A'                   TO  LAP-COD-INST IN LAP.              
                                                                                
           MOVE     1                     TO  LAP-NUM-CLAP IN LAP               
                                              LAP-NUM-CPOC IN LAP               
                                              LAP-NUM-CAUT IN LAP.              
                                                                                
           PERFORM PRO-GRABA-REG-LAP.                                           
       FIN-ING-REG-LAP.                                                         
           EXIT.                                                                
      *                                                                         
       PRO-ELI-REG-LAP  SECTION.                                                
       INI-ELI-REG-LAP.                                                         
      *-------------------------                                                
           MOVE   SPACES                  TO  LAP.                              
           MOVE   'ELI'                   TO  LAP-COD-EVEN IN LAP.              
           MOVE   'E'                     TO  LAP-COD-TACC IN LAP               
                                              LAP-COD-STAT IN LAP.              
           MOVE   'N/A'                   TO  LAP-COD-INST IN LAP.              
                                                                                
           MOVE     1                     TO  LAP-NUM-CLAP IN LAP               
                                              LAP-NUM-CPOC IN LAP               
                                              LAP-NUM-CAUT IN LAP.              
           PERFORM PRO-GRABA-REG-LAP.                                           
       FIN-ELI-REG-LAP.                                                         
           EXIT.       
      *
       PRO-GRABA-REG-LAP  SECTION.
      *---------------------------
       INI-GRABA-REG-LAP.
           MOVE   '1.0'                   TO  LAP-COD-VERS IN LAP.
           MOVE   'POC'                   TO  LAP-COD-ENTF IN LAP
                                              LAP-COD-ENTO IN LAP
                                              LAP-COD-ENTA IN LAP
                                              LAP-COD-ENTI IN LAP.

           MOVE    HOY-FHOY               TO  LAP-FEC-FTRN IN LAP
                                              LAP-FEC-FLAP IN LAP
                                              LAP-FEC-FPOC IN LAP
                                              LAP-FEC-FAUT IN LAP.

           MOVE    HOY-HHOY               TO  LAP-HRA-HRTR IN LAP
                                              LAP-HRA-HLAP IN LAP
                                              LAP-HRA-HPOC IN LAP
                                              LAP-HRA-HAUT IN LAP.

           MOVE  POC-COD-VCOC IN POC      TO  LAP-COD-VCOC IN LAP.
           MOVE  POC-COD-TOOC IN POC      TO  LAP-COD-TOOC IN LAP.
           MOVE  POC-COD-AOOC IN POC      TO  LAP-COD-AOOC IN LAP.

           MOVE  EIBTRMID                 TO  LAP-COD-OTRN IN LAP.
           MOVE  SCR-USER                 TO  LAP-COD-ATRN IN LAP
                                              LAP-COD-AUTO IN LAP.
           MOVE  EIBTRNID                 TO  LAP-COD-TCIC IN LAP.
           MOVE  SCR-CMND                 TO  LAP-COD-CMND IN LAP.
           MOVE  LAP-COD-COME IN PO2-FLD  TO  LAP-COD-COME IN LAP.
           MOVE  POC                      TO  LAP-COD-CONT IN LAP.

           MOVE    FIO-PUT                TO  FIO-CMND.
           PERFORM COL-FIO-LAP.

       FIN-GRABA-REG-LAP.
           EXIT.  
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *         VSN=$11.10.11$
*% END
      *>>>>
*% END
*% IF FIN_PRO_ALL
*% IF PGM_PU
      *<<<< FIN_PRO_ALL
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
           IF SCR-CCPP = 'ELI'
               PERFORM UNP-LAP-PO2
               PERFORM FST-FLD-PO2.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *>>>>
*% END
*% END
*% IF FIN_SCR_TRL
*% IF PGM_PU
      *<<<< FIN_PRO_ALL
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
           IF SCR-CCPP = 'ELI'
               PERFORM UNP-LAP-PO2
               PERFORM FST-FLD-PO2.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
*% END
*% END
