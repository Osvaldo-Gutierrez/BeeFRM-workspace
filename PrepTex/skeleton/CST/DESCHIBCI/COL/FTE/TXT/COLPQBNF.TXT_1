*%! Codigo adicional para archivo
*% PGM_PTC = TRUE
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY COLMXW01.                                                   
       COPY COLMXW05.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY SGCBRRCD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY COLBRRDC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSBRCMT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CMT-REQA==.
       COPY GNSBRRCE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
       COPY SGCBRDCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY SGCBRDCE.  
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSBRCIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGCIC.
       COPY GNSWGCPT.

      *EVA-AFRI/JUN2006                                                 
       01  PTL-VARI.                                                    
           03  PTL-COD-PANT                            PIC X(03).       
           03  PTL-EXT-PANT   VALUE 'NO'               PIC X(02).       
           03  PTL-I     VALUE ZEROES                  PIC 9(02).       
           03  PTL-GLS-DATA.                                            
               05  PTL-VEC-PANT OCCURS 20 TIMES.                        
                   07 PTL-COD-PNTL                     PIC X(03).       
           03  BNF-COD-PANT                            PIC X(03).       
           03  BNF-EXT-PANT   VALUE 'NO'               PIC X(02).       
           03  BNF-I     VALUE ZEROES                  PIC 9(02).       
           03  BNF-GLS-DATA.                                            
               05  BNF-VEC-PANT OCCURS 20 TIMES.                        
                   07 BNF-COD-PNTL                     PIC X(03).       
           03  DIR-COD-PANT                            PIC X(03).       
           03  DIR-EXT-PANT   VALUE 'NO'               PIC X(02).       
           03  DIR-I     VALUE ZEROES                  PIC 9(02).       
           03  DIR-GLS-DATA.                                            
               05  DIR-VEC-PANT OCCURS 20 TIMES.                        
                   07 DIR-COD-PNTL                     PIC X(03).       
           03  IND-COD-PANT                            PIC X(03).       
           03  IND-EXT-PANT   VALUE 'NO'               PIC X(02).       
           03  IND-I     VALUE ZEROES                  PIC 9(02).       
           03  IND-GLS-DATA.                                            
               05  IND-VEC-PANT OCCURS 20 TIMES.                        
                   07 IND-COD-PNTL                     PIC X(03).       
           03  TIP-COD-PANT                            PIC X(01).       
           03  TIP-EXT-PANT   VALUE 'NO'               PIC X(02).       
           03  TIP-I     VALUE ZEROES                  PIC 9(02).       
           03  TIP-GLS-DATA.                                            
               05  TIP-VEC-PANT OCCURS 60 TIMES.                        
                   07 TIP-COD-PNTL                     PIC X(01).       
      *FIN-AFRI/JUN2006                                                 
                                                                              
       01  WSS-VARI.                                                    
           03  WSS-TOT     VALUE ZEROES           PIC 9(04).            
           03  WSS-IND-EXIS                       PIC X(01).            
           03  WSS-CAI-IOPE                       PIC X(04).            
           03  WSS-IIC-IOPE                       PIC 9(08).            
      
       01  WSS-GLOSAS.                                                  
           03 WSS-GLS-GLSA.                                             
             05 WSS-GLS-GLS1         VALUE SPACES    PIC X(30).      
             05 WSS-GLS-GLS2         VALUE SPACES    PIC X(30).      
             05 WSS-NUM-DOCU         VALUE ZEROES    PIC 9(12).        
             05 WSS-GLS-FILL         VALUE SPACES    PIC X(28).        

       01  WSS-GLOSA1.                                                  
           03 WSS-GLS-GLS1.                                             
             05 WSS-GLS-GL1         VALUE SPACES    PIC X(30).      
             05 WSS-GLS-GL2         VALUE SPACES    PIC X(30).      
             05 WSS-NUM-DOC         VALUE ZEROES    PIC 9(12).        
             05 WSS-GLS-FIL         VALUE SPACES    PIC X(28).        

       01  WSS-GLS-NOMC.                                                
           03 WSS-GLS-APAT           PIC X(15).                         
           03 WSS-GLS-AMAT           PIC X(15).                         
           03 WSS-GLS-NOMB           PIC X(10). 
                                                                        
       01  WSS-GLS-IENT.                                                
           03 WSS-CIC-IOPE.                                             
              05 WSS-CAI-IOPE        PIC X(04).                         
              05 WSS-IIC-IOPE        PIC X(08).                         
           03 WSS-CIC-ICLI           PIC X(12).                         

       01  WSS-IIC-IENT              PIC X(08).                         
       01  WSS-NUM-DIRE              PIC 9(02).                         
       01  WSS-NUM-TDIR VALUE ZEROES PIC 9(02).                         
       01  WSS-COD-TDIR VALUE ZEROES PIC 9(02).                         
       01  WSS-GLS-NDIR              PIC X(69).                         
       01  WSS-COD-CTAB              PIC X(06).                         
       01  WSS-COD-TREL              PIC X(03).                         
       01  WSS-GLS-TREL              PIC X(02).                         
       01  WSS-EXI-TDIR              PIC X(02).                         
      *>>>>
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD                                                 
           MOVE FRM-GLS-NDIR IN BNF-FLD TO WSS-GLS-NDIR.                
           PERFORM MOD-CONT.                                            
           GO TO FIN-CMN-MOD.                                           
      *>>>>                                                             
*% END
*% IF INI_CMN_ELI
      *<<<< INI-CMN-ELI                                                 
           PERFORM ELIMINA-BNF.                                         
            GO TO FIN-CMN-ELI.                                          
      *>>>>                                                             
*% END
*% IF EOF_PU
      *<<<< EOF_PU                                                      
      *Graba Comentario                                                 
       GRAB-COMN SECTION.                                               
       INI-GRAB-COMN.                                                   
           PERFORM BUS-NUM-CORRELATIVO.                                 
           MOVE RCO-CAI-IOPE IN BNF-FLD TO WSS-CAI-IOPE.                
           MOVE RCO-IIC-IOPE IN BNF-FLD TO WSS-IIC-IOPE.                
           MOVE RCO-CIC-ICLI IN RCO  TO WSS-CIC-ICLI.                   
           MOVE 'CROR'               TO RCE-CAI-IENT IN RCE.            
           MOVE WSS-IIC-IENT         TO RCE-IIC-IENT IN RCE.            
           MOVE 'COL'                TO RCE-COD-SIST IN RCE.            
           MOVE 'ROR'                TO RCE-COD-ENTI IN RCE.            
           MOVE WSS-GLS-IENT         TO RCE-GLS-IENT IN RCE.            
           MOVE SPACES               TO RCE-COD-SENT IN RCE.            
           MOVE FIO-PUT              TO FIO-CMND.                       
           PERFORM GNS-FIO-RCE.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-GRAB-COMN                                      
           ELSE                                                         
               PERFORM GRAB-GLOSA.                                      
       FIN-GRAB-COMN.                                                   
           EXIT.                                                        
                                                                        
       GRAB-GLOSA SECTION.                                              
       INI-GRAB-GLOSA.                                                  
           MOVE SPACES                  TO CMT-GLS-FLAG IN CMT.         
           MOVE 'CROR'                  TO CMT-CAI-IENT IN CMT.         
           MOVE WSS-IIC-IENT            TO CMT-IIC-IENT IN CMT.         
           MOVE ZEROES                  TO CMT-FEC-FCMT IN CMT.         
           MOVE ZEROES                  TO CMT-NUM-ICMT IN CMT.         
           MOVE ZEROES                  TO CMT-FEC-FTRN IN CMT.         
           MOVE ZEROES                  TO CMT-HRA-HRTR IN CMT.         
           MOVE SPACES                  TO CMT-MSC-TACC IN CMT.         
           MOVE SPACES                  TO CMT-MSC-STAT IN CMT.         
           MOVE SPACES                  TO CMT-COD-OTRN IN CMT.         
           MOVE SPACES                  TO CMT-COD-ATRN IN CMT.         
           MOVE SPACES                  TO CMT-COD-AUTC IN CMT.         
           MOVE SPACES                  TO CMT-COD-UBIC IN CMT.         
           MOVE SPACES                  TO CMT-VEC-CMTR IN CMT.         
           MOVE FRM-GLS-GLS1 IN BNF-FLD TO WSS-GLS-GL1.                 
           MOVE FRM-GLS-GLS2 IN BNF-FLD TO WSS-GLS-GL2.                 
           MOVE FRM-NUM-DOCU IN BNF-FLD TO WSS-NUM-DOC.                
           MOVE FRM-GLS-CONT IN BNF-FLD TO CMT-GLS-REFE IN CMT.         
           MOVE WSS-GLS-GLS1            TO CMT-GLS-FILL IN CMT.         
           MOVE SPACES                  TO CMT-GLS-DISP IN CMT.         
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM GNS-FIO-CMT.                                         
       FIN-GRAB-GLOSA.                                                  
           EXIT.                                                        
                                                                        
       GRAB-DBC SECTION.                                                
       INI-GRAB-DBC.                                                    
           MOVE SPACES  TO CIC-CAI-ICIC IN CIC.                         
           MOVE CIC-GET TO CIC-CMND.                                    
           PERFORM PRO-CIC.                                             
           IF CIC-STAT NOT = CIC-STAT-OKS                               
               MOVE CIC-MENS TO FRM-MENS                                
               GO TO FIN-GRAB-DBC.                                      
           MOVE SPACES        TO DBC-GLS-FLAG IN DBC.                   
           MOVE CIC-CIC-ICIC  TO DBC-CIC-ICLI IN DBC.                   
      *MHM-INI 08-JUL-2008                                              
           PERFORM GET-FHOY.                                            
      *    MOVE ZEROES        TO DBC-FEC-FTRN IN DBC.                   
           MOVE HOY-FHOY      TO DBC-FEC-FTRN IN DBC.                   
      *MHM-FIN 08-JUL-2008                                              
           MOVE ZEROES        TO DBC-HRA-HRTR IN DBC.                   
           MOVE SPACES        TO DBC-MSC-TACC IN DBC.                   
           MOVE SPACES        TO DBC-MSC-STAT IN DBC.                   
           MOVE SPACES        TO DBC-COD-OTRN IN DBC.                   
           MOVE SPACES        TO DBC-COD-ATRN IN DBC.                   
           MOVE SPACES        TO DBC-SNX-NOMC IN DBC.                   
           MOVE ZEROES        TO DBC-NUM-DCOR IN DBC.                   
           MOVE DBC-IND-TICL IN BNF-FLD TO DBC-IND-TICL IN DBC.         
           IF DBC-IND-TICL IN BNF-FLD = 'P'                             
              MOVE DBC-GLS-APAT IN BNF-FLD TO DBC-GLS-APAT IN DBC       
              MOVE DBC-GLS-AMAT IN BNF-FLD TO DBC-GLS-AMAT IN DBC       
              MOVE DBC-GLS-NOMB IN BNF-FLD TO DBC-GLS-NOMB IN DBC       
           ELSE                                                         
              MOVE DBC-GLS-NOMB IN BNF-FLD TO DBC-GLS-NOMC.             
      *MHM-INI 08-JUL-2008                                              
      *    MOVE 'NC'          TO DBC-COD-TICL IN DBC.                   
           MOVE 'PV'          TO DBC-COD-TICL IN DBC.                   
      *MHM-FIN 08-JUL-2008                                              
           MOVE SPACES        TO DBC-COD-CLCM IN DBC.                   
           MOVE SPACES        TO DBC-COD-EJEC IN DBC.                   
      *MHM-INI 08-JUL-2008                                              
      *    MOVE SPACES        TO DBC-COD-OFIC IN DBC.                   
           MOVE RCO-CAI-IOPE IN BNF-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE RCO-IIC-IOPE IN BNF-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE SPACES        TO DBC-COD-OFIC IN DBC                
           ELSE                                                         
               MOVE OPC-COD-OFOC IN OPC TO DBC-COD-OFIC IN DBC.         
      *MHM-FIN 08-JUL-2008                                              
           MOVE SPACES        TO DBC-IND-OOFI IN DBC.                   
           MOVE SPACES        TO DBC-COD-ACTI IN DBC.                   
           MOVE SPACES        TO DBC-COD-ODSE IN DBC.                   
           MOVE ZEROES        TO DBC-FEC-FA85 IN DBC.                   
           MOVE SPACES        TO DBC-COD-SETO IN DBC.                   
           MOVE SPACES        TO DBC-PDO-SETO IN DBC.                   
           MOVE SPACES        TO DBC-IND-MUBC IN DBC.                   
           MOVE SPACES        TO DBC-IND-JUBC IN DBC.                   
           MOVE SPACES        TO DBC-MSC-SCLI IN DBC.                   
           MOVE ZEROES        TO DBC-FEC-FSCL IN DBC.                   
           MOVE SPACES        TO DBC-COD-BLOC IN DBC.                   
           MOVE ZEROES        TO DBC-NUM-TDIR IN DBC.                   
           MOVE ZEROES        TO DBC-NUM-TCMT IN DBC.                   
           MOVE ZEROES        TO DBC-FEC-FIOP IN DBC.                   
           MOVE ZEROES        TO DBC-FEC-FTOP IN DBC.                   
           MOVE ZEROES        TO DBC-NUM-OFTN IN DBC.                   
      *MHM-INI 08-JUL-2008                                              
      *    MOVE ZEROES        TO DBC-FEC-FINP IN DBC.                   
           MOVE HOY-FHOY      TO DBC-FEC-FINP IN DBC.                   
      *MHM-FNI 08-JUL-2008                                              
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM SGC-FIO-DBC.                                         
       FIN-GRAB-DBC.                                                    
           EXIT.                                                        
                                                                        
       GRAB-RCD SECTION.                                                
       INI-GRAB-RCD.                                                    
           MOVE SPACES               TO RCD-GLS-FLAG IN RCD.            
           MOVE DBC-CIC-ICLI IN DBC  TO RCD-CIC-ICLI IN RCD.            
           MOVE '1'                  TO RCD-NUM-DIRE IN RCD.            
           MOVE 'D'                  TO RCD-MSC-TDIR IN RCD.            
           MOVE RCD-GLS-DIRE IN BNF-FLD TO RCD-GLS-DIRE IN RCD.         
           MOVE ZEROES               TO RCD-FEC-FTRN IN RCD.            
           MOVE ZEROES               TO RCD-HRA-HRTR IN RCD.            
           MOVE SPACES               TO RCD-MSC-TACC IN RCD.            
           MOVE SPACES               TO RCD-MSC-STAT IN RCD.            
           MOVE SPACES               TO RCD-COD-TTRN IN RCD.            
           MOVE SPACES               TO RCD-COD-ATRN IN RCD.            
           MOVE SPACES               TO RCD-MSC-SDIR IN RCD.            
           MOVE SPACES               TO RCD-GLS-DISP IN RCD.            
           PERFORM RET-RCD-BNF.                                         
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM SGC-FIO-RCD.                                         
           IF FIO-STAT-OKS                                              
              ADD 1 TO WSS-NUM-TDIR.                                    
       FIN-GRAB-RCD.                                                    
           EXIT.                                                        
                                                                        
       GRAB-TDIR SECTION.                                               
       INI-GRAB-TDIR.                                                   
           IF (SCR-CMND = 'ING' AND                                     
               FRM-GLS-NDIR IN BNF-FLD NOT > SPACES)                    
               GO TO FIN-GRAB-TDIR.                                     
           PERFORM BUS-NUM-RCD.                                         
           MOVE SPACES                  TO RCD-GLS-FLAG IN RCD.         
           MOVE DBC-CIC-ICLI IN DBC     TO RCD-CIC-ICLI IN RCD.         
           MOVE WSS-NUM-DIRE            TO RCD-NUM-DIRE IN RCD.         
           MOVE FRM-GLS-DIRC IN BNF-FLD TO RCD-MSC-TDIR IN RCD.         
           MOVE FRM-GLS-NDIR IN BNF-FLD TO RCD-GLS-DIRE IN RCD.         
           MOVE ZEROES                  TO RCD-FEC-FTRN IN RCD.         
           MOVE ZEROES                  TO RCD-HRA-HRTR IN RCD.         
           MOVE SPACES                  TO RCD-MSC-TACC IN RCD.         
           MOVE SPACES                  TO RCD-MSC-STAT IN RCD.         
           MOVE SPACES                  TO RCD-COD-TTRN IN RCD.         
           MOVE SPACES                  TO RCD-COD-ATRN IN RCD.         
           MOVE SPACES                  TO RCD-MSC-SDIR IN RCD.         
           MOVE SPACES                  TO RCD-GLS-DISP IN RCD.         
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM SGC-FIO-RCD.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-GRAB-TDIR                                       
           ELSE                                                         
              ADD 1 TO WSS-COD-TDIR                                     
              ADD 1 TO WSS-NUM-TDIR.                                    
           IF WSS-NUM-TDIR > ZEROES                                     
              MOVE FIO-GET-KEY-UPD TO FIO-CMND                          
              PERFORM SGC-FIO-DBC                                       
              MOVE WSS-NUM-TDIR TO DBC-NUM-TDIR IN DBC                  
              MOVE FIO-MOD TO FIO-CMND                                  
              PERFORM SGC-FIO-DBC.                                      
       FIN-GRAB-TDIR.                                                   
           EXIT.                                                        
                                                                        
       GRAB-DCP SECTION.                                                
       INI-GRAB-DCP.                                                    
           MOVE SPACES              TO DCP-GLS-FLAG IN DCP.             
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.             
           MOVE DBC-FEC-FTRN IN DBC TO DCP-FEC-FTRN IN DCP.             
           MOVE DBC-HRA-HRTR IN DBC TO DCP-HRA-HRTR IN DCP.             
           MOVE DBC-MSC-TACC IN DBC TO DCP-MSC-TACC IN DCP.             
           MOVE DBC-MSC-STAT IN DBC TO DCP-MSC-STAT IN DCP.             
           MOVE DBC-COD-OTRN IN DBC TO DCP-COD-OTRN IN DCP.             
           MOVE DBC-COD-ATRN IN DBC TO DCP-COD-ATRN IN DCP.             
           MOVE ZEROES              TO DCP-FEC-FNAC IN DCP.             
           MOVE SPACES              TO DCP-COD-PNAC IN DCP.             
           MOVE SPACES              TO DCP-IND-SEXO IN DCP.             
           MOVE SPACES              TO DCP-IND-ECIV IN DCP.             
           MOVE DBC-NUM-ICLI IN DBC TO DCP-NUM-CIDE IN DCP.             
           MOVE DBC-VRF-ICLI IN DBC TO DCP-VRF-CIDE IN DCP.             
           MOVE SPACES              TO DCP-GLS-GABI IN DCP.             
           MOVE SPACES              TO DCP-COD-TBAN IN DCP.             
           MOVE SPACES              TO DCP-IND-NEDU IN DCP.             
           MOVE SPACES              TO DCP-COD-ACTS IN DCP.             
           MOVE SPACES              TO DCP-COD-PROF IN DCP.             
           MOVE SPACES              TO DCP-IND-SLAB IN DCP.             
           MOVE SPACES              TO DCP-COD-CSEC IN DCP.             
           MOVE SPACES              TO DCP-IND-CASA IN DCP.             
           MOVE ZEROES              TO DCP-NUM-NMSG IN DCP.             
           MOVE SPACES              TO DCP-IND-RCNY IN DCP.             
           MOVE SPACES              TO DCP-COD-TPLN IN DCP.             
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM SGC-FIO-DCP.                                         
       FIN-GRAB-DCP.                                                    
           EXIT.                                                        
                                                                        
       GRAB-DCE SECTION.                                                
       INI-GRAB-DCE.                                                    
           MOVE SPACES              TO DCE-GLS-FLAG IN DCE.             
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.             
           MOVE DBC-FEC-FTRN IN DBC TO DCE-FEC-FTRN IN DCE.             
           MOVE DBC-HRA-HRTR IN DBC TO DCE-HRA-HRTR IN DCE.             
           MOVE DBC-MSC-TACC IN DBC TO DCE-MSC-TACC IN DCE.             
           MOVE DBC-MSC-STAT IN DBC TO DCE-MSC-STAT IN DCE.             
           MOVE DBC-COD-OTRN IN DBC TO DCE-COD-OTRN IN DCE.             
           MOVE DBC-COD-ATRN IN DBC TO DCE-COD-ATRN IN DCE.             
           MOVE SPACES              TO DCE-GLS-NFAN IN DCE.             
           MOVE SPACES              TO DCE-COD-TSOC IN DCE.             
           MOVE ZEROES              TO DCE-FEC-FCTT IN DCE.             
           MOVE ZEROES              TO DCE-FEC-FUME IN DCE.             
           MOVE ZEROES              TO DCE-FEC-FCAD IN DCE.             
           MOVE SPACES              TO DCE-IND-RAUT IN DCE.             
           MOVE SPACES              TO DCE-IND-CMOS IN DCE.             
           MOVE SPACES              TO DCE-IND-CATE IN DCE.             
           MOVE SPACES              TO DCE-IND-TEMP IN DCE.             
           MOVE SPACES              TO DCE-COD-TBAN IN DCE.             
           MOVE SPACES              TO DCE-COD-TPLN IN DCE.             
           MOVE SPACES              TO DCE-GLS-DISP IN DCE.             
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM SGC-FIO-DCE.                                         
       FIN-GRAB-DCE.                                                    
           EXIT.                                                        
                                                                        
       MOD-CONT SECTION.                                                
       INI-MOD-CONT.                                                    
           MOVE RCO-CAI-IOPE IN BNF-FLD TO WSS-CAI-IOPE.                
           MOVE RCO-IIC-IOPE IN BNF-FLD TO WSS-IIC-IOPE.                
           MOVE DBC-NUM-ICLI IN BNF-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE DBC-VRF-ICLI IN BNF-FLD TO DBC-VRF-ICLI IN DBC.         
           MOVE SPACES                  TO DBC-IND-ICLI IN DBC.         
           MOVE SPACES                  TO DBC-GLS-ICLI IN DBC.         
           MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY.                    
           MOVE FIO-GET-KEY             TO FIO-CMND.                    
           PERFORM SGC-FIO-DBC.                                         
           MOVE DBC-CIC-ICLI IN DBC TO RCO-CIC-ICLI IN RCO.             
           MOVE RCO-CIC-ICLI IN RCO     TO WSS-CIC-ICLI.                
           MOVE 'COL'                   TO RCE-COD-SIST IN RCE.         
           MOVE 'ROR'                   TO RCE-COD-ENTI IN RCE.         
           MOVE WSS-GLS-IENT            TO RCE-GLS-IENT IN RCE.         
           MOVE SPACES                  TO RCE-COD-SENT IN RCE.         
           MOVE 'RCE-KEY-IENT'          TO FIO-AKEY.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-RCE.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-MOD-CONT.                                      
           PERFORM MOD-CMT.                                             
       FIN-MOD-CONT.                                                    
           EXIT.                                                        
                                                                        
       MOD-CMT SECTION.                                                 
       INI-MOD-CMT.                                                     
           MOVE RCE-CIC-IENT IN RCE     TO CMT-CIC-IENT IN CMT.         
           MOVE ZEROES                  TO CMT-FEC-FCMT IN CMT.         
           MOVE ZEROES                  TO CMT-NUM-ICMT IN CMT.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM GNS-FIO-CMT.                                         
           IF NOT FIO-STAT-OKS AND                                      
              (RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT)               
                GO TO FIN-MOD-CMT.                                      
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM GNS-FIO-CMT.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-MOD-CMT.                                       
           MOVE FRM-GLS-GLS1 IN BNF-FLD TO WSS-GLS-GL1.                 
           MOVE FRM-GLS-GLS2 IN BNF-FLD TO WSS-GLS-GL2.                 
           MOVE FRM-NUM-DOCU IN BNF-FLD TO WSS-NUM-DOC.                
           MOVE FRM-GLS-CONT IN BNF-FLD TO CMT-GLS-REFE IN CMT.         
           MOVE WSS-GLS-GLS1            TO CMT-GLS-FILL IN CMT.         
           MOVE SPACES                  TO CMT-GLS-DISP IN CMT.         
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM GNS-FIO-CMT.                                         
       FIN-MOD-CMT.                                                     
           EXIT.                                                        
                                                                        
       DEL-CONT SECTION.                                                
       INI-DEL-CONT.                                                    
           MOVE 'COL'                   TO RCE-COD-SIST IN RCE.         
           MOVE 'ROR'                   TO RCE-COD-ENTI IN RCE.         
           MOVE RCO-CAI-IOPE IN BNF-FLD TO WSS-CAI-IOPE.                
           MOVE RCO-IIC-IOPE IN BNF-FLD TO WSS-IIC-IOPE.                
           MOVE RCO-CIC-ICLI IN RCO     TO WSS-CIC-ICLI.                
           MOVE WSS-GLS-IENT            TO RCE-GLS-IENT IN RCE.         
           MOVE SPACES                  TO RCE-COD-SENT IN RCE.         
           MOVE 'RCE-KEY-IENT'          TO FIO-AKEY.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-RCE.                                         
           IF NOT FIO-STAT-OKS                                          
                GO TO FIN-DEL-CONT.                                     
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM GNS-FIO-RCE.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-DEL-CONT.                                      
           MOVE FIO-DEL TO FIO-CMND.                                    
           PERFORM GNS-FIO-RCE.                                         
           PERFORM DEL-CMT.                                             
       FIN-DEL-CONT.                                                    
           EXIT.                                                        
                                                                        
       DEL-CMT SECTION.                                                 
       INI-DEL-CMT.                                                     
           MOVE RCE-CIC-IENT IN RCE TO CMT-CIC-IENT IN CMT.             
           MOVE ZEROES              TO CMT-FEC-FCMT IN CMT.             
           MOVE ZEROES              TO CMT-NUM-ICMT IN CMT.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM GNS-FIO-CMT.                                         
           IF NOT FIO-STAT-OKS AND                                      
              (RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT)               
                GO TO FIN-DEL-CMT.                                      
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM GNS-FIO-CMT.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-DEL-CMT.                                       
           MOVE FIO-DEL TO FIO-CMND.                                    
           PERFORM GNS-FIO-CMT.                                         
       FIN-DEL-CMT.                                                     
           EXIT.                                                        
                                                                        
       ELIMINA-BNF SECTION.                                             
       INI-ELIMINA-BNF.                                                 
           PERFORM KEY-ALL-BNF.                                         
           MOVE DBC-NUM-ICLI IN BNF-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE DBC-VRF-ICLI IN BNF-FLD TO DBC-VRF-ICLI IN DBC.         
           MOVE SPACES                  TO DBC-IND-ICLI IN DBC.         
           MOVE SPACES                  TO DBC-GLS-ICLI IN DBC.         
           MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY.                    
           MOVE FIO-GET-KEY             TO FIO-CMND.                    
           PERFORM SGC-FIO-DBC.                                         
           MOVE DBC-CIC-ICLI IN DBC TO RCO-CIC-ICLI IN RCO.             
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM SGC-FIO-RCO.                                         
           IF FIO-STAT-OKS AND                                          
              RCO-STP-ITRN IN RCO NOT = SCR-UMOD                        
               PERFORM DEL-CONT                                         
               GO TO FIN-CMN-ELI                                        
               MOVE FIO-ULK-REC TO FIO-CMND                             
               PERFORM SGC-FIO-RCO                                      
               MOVE FIO-BCK-OUT TO FIO-CMND                             
               PERFORM SGC-FIO-RCO                                      
               MOVE 'GNS' TO MSG-COD-SIST                               
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-ELI.                                       
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-ELI.                                       
           MOVE FIO-DEL TO FIO-CMND.                                    
           PERFORM SGC-FIO-RCO.                                         
           PERFORM DEL-CONT.                                            
       FIN-ELIMINA-BNF.                                                 
           EXIT.                                                        
                                                                        
       BUS-NUM-CORRELATIVO SECTION.                                     
       INI-BUS-NUM-CORRETIVO.                                           
           MOVE 'CROR' TO CIC-CAI-ICIC IN CIC.                          
           MOVE CIC-GET TO CIC-CMND.                                    
           PERFORM PRO-CIC.                                             
           IF CIC-STAT NOT = CIC-STAT-OKS                               
              MOVE 'S' TO SCR-IERR                                      
              MOVE CIC-MENS TO FRM-MENS                                 
              MOVE FIO-STAT-NEX TO FIO-STAT                             
              GO TO FIN-BUS-NUM-CORRELATIVO                             
           ELSE                                                         
              MOVE CIC-IIC-ICIC TO WSS-IIC-IENT.                        
       FIN-BUS-NUM-CORRELATIVO.                                         
           EXIT.                                                        
                                                                        
       BUS-NUM-RCD SECTION.                                             
       INI-BUS-NUM-RCD.                                                 
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.             
           MOVE 99                  TO RCD-NUM-DIRE IN RCD.             
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
       LUP-SIG-NUM-RCD.                                                 
           PERFORM SGC-FIO-RCD.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE FIO-GET-NXT TO FIO-CMND                              
              GO TO LUP-SIG-NUM-RCD.                                    
           MOVE RCD-NUM-DIRE IN RCD TO WSS-NUM-DIRE                     
           ADD 1 TO WSS-NUM-DIRE.                                       
       FIN-BUS-NUM-RCD.                                                 
           EXIT.                                                        
                                                                        
       BUS-DIRE SECTION.                                                
       INI-BUS-DIRE.                                                    
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.             
           MOVE ZEROES              TO RCD-NUM-DIRE IN RCD.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-SIG-BUS-RCD.                                                 
           PERFORM SGC-FIO-RCD.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              DBC-CIC-ICLI IN DBC = RCD-CIC-ICLI IN RCD)                
              GO TO FIN-BUS-DIRE.                                       
           IF NOT (RCD-MSC-TDIR IN RCD = FRM-GLS-DIRC IN BNF-FLD AND    
                   RCD-GLS-DIRE IN RCD = FRM-GLS-NDIR IN BNF-FLD)       
                   MOVE FIO-GET-NXT TO FIO-CMND                         
                   GO TO LUP-SIG-BUS-RCD                                
           ELSE                                                         
               MOVE 'SI' TO WSS-EXI-TDIR                                
               GO TO FIN-BUS-DIRE.                                      
           MOVE 'NO' TO WSS-EXI-TDIR.                                   
       FIN-BUS-DIRE.                                                    
           EXIT.                                                        
      *>>>>
*% END                                                             
*% IF INI_CMN_ING
           MOVE ZEROES TO WSS-NUM-TDIR.                                 
           MOVE 'NO' TO WSS-EXI-TDIR.                                   
      *<<<< INI_CMN_ING                                                 
           MOVE DBC-NUM-ICLI IN BNF-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE DBC-VRF-ICLI IN BNF-FLD TO DBC-VRF-ICLI IN DBC.         
           MOVE SPACES                  TO DBC-IND-ICLI IN DBC.         
           MOVE SPACES                  TO DBC-GLS-ICLI IN DBC.         
           MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY.                    
           MOVE FIO-GET-KEY             TO FIO-CMND.                    
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
               PERFORM GRAB-DBC                                         
               PERFORM GRAB-RCD                                         
               PERFORM GRAB-TDIR                                        
               IF DBC-IND-TICL IN BNF-FLD = 'P'                         
                   PERFORM GRAB-DCP                                     
               ELSE                                                     
                   PERFORM GRAB-DCE.                                    
           MOVE DBC-CIC-ICLI IN DBC TO RCO-CIC-ICLI IN RCO.             
           MOVE DBC-NUM-TDIR IN DBC TO WSS-COD-TDIR.                    
           PERFORM GRAB-COMN.                                           
           PERFORM BUS-DIRE.                                            
           IF WSS-EXI-TDIR = 'NO'                                       
              PERFORM GRAB-TDIR.                                        
           IF WSS-COD-TDIR > ZEROES                                     
              MOVE FIO-GET-KEY-UPD TO FIO-CMND                          
              PERFORM SGC-FIO-DBC                                       
              MOVE WSS-COD-TDIR TO DBC-NUM-TDIR IN DBC                  
              MOVE FIO-MOD TO FIO-CMND                                  
              PERFORM SGC-FIO-DBC.                                      
                                                                        
      *>>>>
*% END
*% IF SCR_GIKY_VAL_IKY
      *<<<<
           IF SCR-OFRM-SRV AND                                          
              RCO-CAI-IOPE IN BNF-FLD = SPACES AND                      
              SCR-CCPP = 'ING'                                          
              MOVE PTC-OPC-TYPE TO QUE-TYPE                             
              MOVE TSK-TERM-ALF TO QUE-TERM                             
              MOVE PTC-OPC-LENG TO QUE-LITM                             
              MOVE 1            TO QUE-NITM                             
              MOVE QUE-GET      TO QUE-CMND                             
              PERFORM GNS-PRO-QUE                                       
              IF QUE-STAT = QUE-STAT-OKS                                
                 MOVE QUE-ITEM TO PTC-OPC-ITEM                          
                 MOVE PTC-OPC-OPC-CAI-IOPC TO RCO-CAI-IOPE IN BNF-FLD   
                 MOVE PTC-OPC-OPC-IIC-IOPC TO RCO-IIC-IOPE IN BNF-FLD.  
      *>>>>      
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF SCR-CMND NOT = 'ING' 
              GO TO NO-ING.                                             
      * EVA                                                             
           MOVE RCO-CAI-IOPE IN BNF-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE RCO-IIC-IOPE IN BNF-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'OPC NOEXIREG' TO MSG-COD-MENS                       
              GO TO ERR-FND-KEY.                                        
           PERFORM LEE-TABLA.                                           
           IF BNF-EXT-PANT = 'SI'                                       
              GO TO SIG-FND-KEY.                                        
           MOVE SPACES                  TO RCO-CIC-ICLI IN RCO.   
           MOVE RCO-CAI-IOPE IN BNF-FLD TO RCO-CAI-IOPE IN RCO.   
           MOVE RCO-IIC-IOPE IN BNF-FLD TO RCO-IIC-IOPE IN RCO.   
           MOVE FIO-GET-NLS TO FIO-CMND.                          
       LUP-RCO-RCOP.                                              
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.                       
           PERFORM SGC-FIO-RCO.                                   
           IF ( FIO-STAT-OKS AND                                  
               RCO-CAI-IOPE IN BNF-FLD = RCO-CAI-IOPE IN RCO AND 
               RCO-IIC-IOPE IN BNF-FLD = RCO-IIC-IOPE IN RCO)    
               IF RCO-COD-TREL IN RCO = RCO-COD-TREL IN BNF-FLD         
                    MOVE 'EXI BNF OPER' TO MSG-COD-MENS           
                    GO TO ERR-FND-KEY                             
               ELSE                                              
                    MOVE FIO-GET-NXT TO FIO-CMND                 
                    GO TO LUP-RCO-RCOP.                          
                                                               
         GO TO SIG-FND-KEY.                        
       NO-ING.                                                          
           MOVE SPACES                  TO RCO-CIC-ICLI IN RCO.   
           MOVE RCO-CAI-IOPE IN BNF-FLD TO RCO-CAI-IOPE IN RCO.   
           MOVE RCO-IIC-IOPE IN BNF-FLD TO RCO-IIC-IOPE IN RCO.   
           MOVE FIO-GET-NLS TO FIO-CMND.                          
       LUP-BUS-DATO.                                              
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.                       
           PERFORM SGC-FIO-RCO.                                   
           IF (FIO-STAT-OKS AND                                         
               RCO-CAI-IOPE IN BNF-FLD = RCO-CAI-IOPE IN RCO AND        
               RCO-IIC-IOPE IN BNF-FLD = RCO-IIC-IOPE IN RCO)           
               IF RCO-COD-TREL IN RCO = RCO-COD-TREL IN BNF-FLD         
                  MOVE RCO-CIC-ICLI IN RCO TO                     
                  DBC-CIC-ICLI IN DBC                             
                  MOVE FIO-GET-KEY TO FIO-CMND                    
                  PERFORM SGC-FIO-DBC                             
                  IF FIO-STAT-OKS                                 
                     MOVE DBC-NUM-ICLI IN DBC TO                 
                     DBC-NUM-ICLI IN BNF-FLD                     
                     MOVE DBC-VRF-ICLI IN DBC TO                 
                     DBC-VRF-ICLI IN BNF-FLD                     
                       GO TO SIG-FND-KEY                           
                  ELSE                                                   
                     MOVE FIO-GET-NXT TO FIO-CMND                    
                     GO TO LUP-BUS-DATO                                 
           ELSE                                                         
               MOVE FIO-GET-NXT TO FIO-CMND                             
               GO TO LUP-BUS-DATO.                                      
       SIG-FND-KEY.                                               
           MOVE DBC-NUM-ICLI IN BNF-FLD TO DBC-NUM-ICLI IN DBC.   
           MOVE DBC-VRF-ICLI IN BNF-FLD TO DBC-VRF-ICLI IN DBC.   
           MOVE SPACES                  TO DBC-IND-ICLI IN DBC.   
           MOVE SPACES                  TO DBC-GLS-ICLI IN DBC.   
           MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY.              
           MOVE FIO-GET-KEY             TO FIO-CMND.              
           PERFORM SGC-FIO-DBC.                                   
           MOVE FIO-STAT TO PGM-STAT-DBC.                         
           IF FIO-STAT-OKS                                        
             MOVE DBC-CIC-ICLI IN DBC TO RCO-CIC-ICLI IN RCO     
             PERFORM PUT-DBC-BNF                                 
           ELSE                                                   
             MOVE FIO-STAT TO PGM-STAT-RCO                       
             GO TO CON-FND-KEY.                                  
      *>>>>
*% END
*% IF FIN_FND_KEY                                                 
      *<<<< FIN_FND_KEY                                                 
       CON-FND-KEY.                                               
           MOVE RCO-CAI-IOPE IN BNF-FLD TO OPC-CAI-IOPC IN OPC. 
           MOVE RCO-IIC-IOPE IN BNF-FLD TO OPC-IIC-IOPC IN OPC. 
           MOVE FIO-GET-KEY TO FIO-CMND.                        
           PERFORM COL-FIO-OPC.                                 
           MOVE FIO-STAT TO PGM-STAT-OPC.                       
           IF NOT FIO-STAT-OKS                                  
              MOVE 'NOT RCO OPC' TO MSG-COD-MENS                 
                  GO TO ERR-FND-KEY.                           
      * EVA                                                             
      *MHM-INI 09-AGO-2007                                              
      *    IF OPC-MSC-STAT IN OPC = 'A' AND                             
      *       (SCR-CMND = 'ING' OR SCR-CMND = 'ELI')                    
      *        MOVE 'MSCOPCNOPER' TO MSG-COD-MENS                       
      *        GO TO ERR-FND-KEY.                                       
      *MHM-FIN 09-AGO-2007                                              
                                                                        
           MOVE OPC-COD-TOOC IN OPC TO PTL-COD-PANT.                    
           MOVE 'NO'         TO PTL-EXT-PANT.                           
           MOVE 'COL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'BNFCOD'     TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               TAB-IND-VIGE IN TAB = 'S')                               
               MOVE 'TABLA NOVIG' TO MSG-COD-MENS                       
               GO TO ERR-FND-KEY.                                       
           MOVE TAB-GLS-DATA IN TAB TO PTL-GLS-DATA.                    
           MOVE 'SI'         TO PTL-EXT-PANT.                           
           PERFORM BUS-PANT.                                            
           IF PTL-EXT-PANT = 'SI'                                       
              GO TO CNT-FND-KEY                                         
           ELSE                                                         
              MOVE 'TIONOPERBNF' TO MSG-COD-MENS                        
              GO TO ERR-FND-KEY.                                        
       CNT-FND-KEY.                                                     
           PERFORM PUT-OPC-BNF.                                   
                                                               
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.       
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.       
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.       
           MOVE FIO-GET-NLS TO FIO-CMND.                          
           PERFORM COL-FIO-RDC.                                   
           IF (FIO-STAT-OKS AND                                         
               DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDC AND            
               OPC-CIC-IOPC IN OPC = RDC-CIC-IOPC IN RDC)               
                IF RDC-NUM-IDLC IN RDC = ZEROES AND                     
                   SCR-CMND = 'ING'                                     
                   PERFORM LEE-DDIR                                     
                   IF DIR-EXT-PANT = 'NO'                               
                      MOVE 'NOENCTIODDIR' TO MSG-COD-MENS               
                      GO TO ERR-FND-KEY                                 
                   ELSE                                                 
                      NEXT SENTENCE                                     
                ELSE                                                    
                IF RDC-NUM-IDLC IN RDC > ZEROES AND                     
                   SCR-CMND = 'ING'                                     
                   PERFORM LEE-DIND                                     
                   IF IND-EXT-PANT = 'NO'                               
                      MOVE 'NOENCTIODEUD' TO MSG-COD-MENS               
                  GO TO ERR-FND-KEY.                           
                                                               
           IF PGM-STAT-DBC-OKS                                    
             PERFORM BUS-DBC-RCD                                 
             MOVE FIO-STAT TO PGM-STAT-RCD                       
             PERFORM PUT-RCD-BNF.                                
                                                               
           IF SCR-CMND NOT = 'ING'                                
              PERFORM BUS-CMT.                                    
                                                               
           MOVE PGM-STAT-RCO TO FIO-STAT                          
              GO TO FIN-FND-KEY.                                     
                                                               
       ERR-FND-KEY.                                               
           MOVE 'COL' TO MSG-COD-SIST.                            
           PERFORM GET-MSG.                                       
           MOVE MSG-GLS-DESC IN MSG TO FRM-MENS.                  
           MOVE SCR-STAT-CON TO SCR-STAT.                         
           MOVE '00' TO FIO-STAT.                                 
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'ING'                                          
               MOVE DBC-NUM-ICLI IN BNF-FLD TO DBC-NUM-ICLI IN DBC      
               MOVE DBC-VRF-ICLI IN BNF-FLD TO DBC-VRF-ICLI IN DBC      
               MOVE SPACES                  TO DBC-IND-ICLI IN DBC      
               MOVE SPACES                  TO DBC-GLS-ICLI IN DBC      
               MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY                 
               MOVE FIO-GET-KEY             TO FIO-CMND                 
               PERFORM SGC-FIO-DBC                                      
               IF FIO-STAT-OKS                                          
                 MOVE FRM-CPIM-AEY TO DBC-IND-TICL-ATR IN BNF-FLD       
                 MOVE FRM-CPIM-AEY TO RCO-TIP-BENF-ATR IN BNF-FLD       
                 MOVE FRM-CPIM-AEY TO DBC-GLS-APAT-ATR IN BNF-FLD       
                 MOVE FRM-CPIM-AEY TO DBC-GLS-AMAT-ATR IN BNF-FLD       
                 MOVE FRM-CPIM-AEY TO DBC-GLS-NOMB-ATR IN BNF-FLD       
                 MOVE FRM-CPIM-AEY TO RCD-GLS-DIRE-ATR IN BNF-FLD       
                 MOVE FRM-CPIM-AEY TO RCD-COD-LUGA-ATR IN BNF-FLD       
                 MOVE FRM-CPIM-AEY TO RCD-GLS-FONO-ATR IN BNF-FLD       
                 IF FRM-GLS-DIRC IN BNF-FLD > SPACES                    
                    MOVE FRM-CPIM-AEY TO FRM-GLS-DIRC-ATR IN BNF-FLD    
                    MOVE FRM-CPIM-AEY TO FRM-GLS-NDIR-ATR IN BNF-FLD    
                    MOVE  0           TO DBC-IND-TICL-LEN IN BNF-FLD    
                    MOVE -1           TO FRM-GLS-CONT-LEN IN BNF-FLD    
                 ELSE                                                   
                    MOVE  0           TO DBC-IND-TICL-LEN IN BNF-FLD    
                    MOVE -1           TO FRM-GLS-DIRC-LEN IN BNF-FLD.   
                 IF DBC-IND-TICL IN BNF-FLD = 'E'                       
                   MOVE FRM-CPIM-UBY TO RCO-TIP-BENF-ATR IN BNF-FLD     
                   MOVE FRM-CPIM-AEY TO DBC-GLS-APAT-ATR IN BNF-FLD     
                   MOVE FRM-CPIM-AEY TO DBC-GLS-AMAT-ATR IN BNF-FLD     
                   MOVE  0           TO DBC-IND-TICL-LEN IN BNF-FLD     
                   MOVE -1           TO RCO-TIP-BENF-LEN IN BNF-FLD.    
                                                                        
           IF SCR-CMND = 'MOD'                                          
                MOVE FRM-CPIM-AEY TO DBC-IND-TICL-ATR IN BNF-FLD        
                MOVE FRM-CPIM-AEY TO RCO-TIP-BENF-ATR IN BNF-FLD        
                MOVE FRM-CPIM-AEY TO DBC-GLS-APAT-ATR IN BNF-FLD        
                MOVE FRM-CPIM-AEY TO DBC-GLS-AMAT-ATR IN BNF-FLD        
                MOVE FRM-CPIM-AEY TO DBC-GLS-NOMB-ATR IN BNF-FLD        
                MOVE FRM-CPIM-AEY TO RCD-GLS-DIRE-ATR IN BNF-FLD        
                MOVE FRM-CPIM-AEY TO RCD-COD-LUGA-ATR IN BNF-FLD        
                MOVE FRM-CPIM-AEY TO RCD-GLS-FONO-ATR IN BNF-FLD        
                MOVE FRM-CPIM-AEY TO FRM-GLS-DIRC-ATR IN BNF-FLD        
                MOVE FRM-CPIM-AEY TO FRM-GLS-NDIR-ATR IN BNF-FLD        
                MOVE  0           TO DBC-IND-TICL-LEN IN BNF-FLD        
                MOVE -1           TO FRM-GLS-CONT-LEN IN BNF-FLD.       
                IF DBC-IND-TICL IN BNF-FLD = 'E'                        
                   MOVE FRM-CPIM-UBY TO RCO-TIP-BENF-ATR IN BNF-FLD     
                   MOVE FRM-CPIM-AEY TO DBC-GLS-APAT-ATR IN BNF-FLD     
                   MOVE FRM-CPIM-AEY TO DBC-GLS-AMAT-ATR IN BNF-FLD     
                   MOVE  0           TO DBC-IND-TICL-LEN IN BNF-FLD     
                   MOVE -1           TO RCO-TIP-BENF-LEN IN BNF-FLD.    
                                                                        
           IF SCR-CMND = 'CON'                                          
                  MOVE FRM-CPIM-AEY TO DBC-IND-TICL-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO RCO-TIP-BENF-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO DBC-GLS-APAT-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO DBC-GLS-AMAT-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO DBC-GLS-NOMB-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO RCD-GLS-DIRE-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO RCD-COD-LUGA-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-DIRC-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-NDIR-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-CONT-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-GLS1-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-GLS2-ATR IN BNF-FLD.     
                                                                        
           IF SCR-CMND = 'ELI'                                          
                  MOVE FRM-CPIM-AEY TO DBC-IND-TICL-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO RCO-TIP-BENF-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO DBC-GLS-APAT-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO DBC-GLS-AMAT-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO DBC-GLS-NOMB-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO RCD-GLS-DIRE-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO RCD-COD-LUGA-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO RCD-GLS-DIRE-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-DIRC-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-NDIR-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-CONT-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-GLS1-ATR IN BNF-FLD      
                  MOVE FRM-CPIM-AEY TO FRM-GLS-GLS2-ATR IN BNF-FLD.     
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBBMSC.                                                   
       COPY GNSBFCMT.                                                   
       COPY GNSBFRCE.                                                   
       COPY SGCBFDCP.                                                   
       COPY SGCBFDCE.                                                   
       COPY SGCBFDBC.                                                   
       COPY SGCBFRCD.                                                   
       COPY GNSBBTAB.
       COPY GNSBVTAB. 
       COPY COLBFRDC.                                                   
       COPY COLBFOPC.
       COPY GNSBGCPT.
       COPY GNSBVCOD.
       COPY GNSBGCIC.
       COPY GNSBFCIC.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       BUS-DBC-RCD SECTION.                                             
       INI-BUS-DBC-RCD.                                                 
           PERFORM RCD-TDIR.                                            
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.             
           MOVE ZEROES              TO RCD-NUM-DIRE IN RCD.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-SIG-REG-RCD.                                                 
           PERFORM SGC-FIO-RCD.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              DBC-CIC-ICLI IN DBC = RCD-CIC-ICLI IN RCD)                
                   GO TO FIN-BUS-DBC-RCD.                               
                                                                        
           IF NOT (RCD-MSC-TDIR IN RCD = 'D')                           
                   MOVE FIO-GET-NXT TO FIO-CMND                         
                   GO TO LUP-SIG-REG-RCD.                               
       FIN-BUS-DBC-RCD.                                                 
           EXIT.

       RCD-TDIR SECTION.                                                
       INI-RCD-TDIR.                                                    
           MOVE 1 TO TIP-I.                                             
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.             
           MOVE ZEROES              TO RCD-NUM-DIRE IN RCD.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-SIG-DIR-RCD.                                                 
           PERFORM SGC-FIO-RCD.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              DBC-CIC-ICLI IN DBC = RCD-CIC-ICLI IN RCD)                
              GO TO FIN-RCD-TDIR.                                       
           PERFORM LEE-TDIR.                                            
           IF TIP-EXT-PANT = 'NO'                                       
              MOVE FIO-GET-NXT TO FIO-CMND                              
              GO TO LUP-SIG-DIR-RCD.                                    
           MOVE RCD-MSC-TDIR IN RCD TO FRM-GLS-DIRC IN BNF-FLD.         
           MOVE RCD-GLS-DIRE IN RCD TO FRM-GLS-NDIR IN BNF-FLD.         
       FIN-RCD-TDIR.                                                    
           EXIT.                                                        
                                     
       BUS-CMT SECTION.                                                 
       INI-BUS-CMT.                                                     
           MOVE 'COL'               TO RCE-COD-SIST IN RCE.             
           MOVE 'ROR'               TO RCE-COD-ENTI IN RCE.             
           MOVE RCO-CIC-IOPE IN RCO TO WSS-CIC-IOPE.                    
           MOVE RCO-CIC-ICLI IN RCO TO WSS-CIC-ICLI.                    
           MOVE WSS-GLS-IENT        TO RCE-GLS-IENT IN RCE.             
           MOVE SPACES              TO RCE-COD-SENT IN RCE.             
           MOVE 'RCE-KEY-IENT'      TO FIO-AKEY.                        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-RCE.                                         
           IF  NOT  FIO-STAT-OKS                                        
                GO TO FIN-BUS-CMT.                                      
           MOVE RCE-CIC-IENT IN RCE TO CMT-CIC-IENT IN CMT.             
           MOVE ZEROES              TO CMT-FEC-FCMT IN CMT.             
           MOVE ZEROES              TO CMT-NUM-ICMT IN CMT.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM GNS-FIO-CMT.                                         
           IF NOT FIO-STAT-OKS AND                                      
              (RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT)               
                MOVE 'RCE NO CMT' TO MSG-COD-MENS                       
                GO TO FIN-BUS-CMT.                                      
           MOVE CMT-GLS-REFE IN CMT TO FRM-GLS-CONT IN BNF-FLD.         
           MOVE CMT-GLS-FILL IN CMT TO WSS-GLS-GLSA                     
           MOVE WSS-GLS-GLS1        TO FRM-GLS-GLS1 IN BNF-FLD.         
           MOVE WSS-GLS-GLS2        TO FRM-GLS-GLS2 IN BNF-FLD.         
           MOVE WSS-NUM-DOCU        TO FRM-NUM-DOCU IN BNF-FLD.         
       FIN-BUS-CMT.                                                     
           EXIT.                                                        
                                                                        
      *EVA-AFRI/JUN2006                                                 
       LEE-TABLA SECTION.                                               
       INI-LEE-TABLA.                                                   
           MOVE RCO-CAI-IOPE IN BNF-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE RCO-IIC-IOPE IN BNF-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-LEE-TABLA.                                      
           MOVE OPC-COD-TOOC IN OPC TO BNF-COD-PANT.                    
           MOVE 'NO'         TO BNF-EXT-PANT.                           
           MOVE 'COL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'EXIBNF'     TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               TAB-IND-VIGE IN TAB = 'S')                               
               GO TO FIN-LEE-TABLA.                                     
           MOVE TAB-GLS-DATA IN TAB TO BNF-GLS-DATA.                    
           MOVE 'SI'         TO BNF-EXT-PANT.                           
           PERFORM BUS-PBNF.                                            
       FIN-LEE-TABLA.                                                   
           EXIT.                                                        
                                                                        
       LEE-DIND SECTION.                                                
       INI-LEE-DIND.                                                    
           MOVE OPC-COD-TOOC IN OPC TO IND-COD-PANT.                    
           MOVE 'NO'         TO IND-EXT-PANT.                           
           MOVE 'COL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'DINDBNF'    TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               TAB-IND-VIGE IN TAB = 'S')                               
               GO TO FIN-LEE-DIND.                                      
           MOVE TAB-GLS-DATA IN TAB TO IND-GLS-DATA.                    
           MOVE 'SI'         TO IND-EXT-PANT.                           
           PERFORM BUS-DIND.                                            
       FIN-LEE-DIND.                                                    
           EXIT.                                                        
                                                                        
       LEE-DDIR SECTION.                                                
       INI-LEE-DDIR.                                                    
           MOVE OPC-COD-TOOC IN OPC TO DIR-COD-PANT.                    
           MOVE 'NO'         TO DIR-EXT-PANT.                           
           MOVE 'COL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.                    
           MOVE 'DDIRBNF'    TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               TAB-IND-VIGE IN TAB = 'S')                               
               GO TO FIN-LEE-DDIR.                                      
           MOVE TAB-GLS-DATA IN TAB TO DIR-GLS-DATA.                    
           MOVE 'SI'         TO DIR-EXT-PANT.                           
           PERFORM BUS-DDIR.                                            
       FIN-LEE-DDIR.                                                    
           EXIT.                                                        
                                                                        
       BUS-PANT SECTION.                                                
       INI-BUS-PANT.                                                    
           MOVE 'NO'         TO PTL-EXT-PANT.                           
           MOVE 1 TO PTL-I.                                             
       LUP-SIG-PNTL.                                                    
           IF PTL-COD-PNTL(PTL-I) = PTL-COD-PANT                        
              MOVE 'SI' TO PTL-EXT-PANT                                 
              GO TO FIN-BUS-PANT.                                       
       NXT-SIG-PNTL.                                                    
           ADD 1 TO PTL-I.                                              
           IF PTL-I > 20                                                
               GO TO FIN-BUS-PANT                                       
           ELSE                                                         
               GO TO LUP-SIG-PNTL.                                      
       FIN-BUS-PANT.                                                    
           EXIT.                                                        
                                                                        
       BUS-PBNF SECTION.                                                
       INI-BUS-PBNF.                                                    
           MOVE 'NO'  TO BNF-EXT-PANT.                                  
           MOVE 1 TO BNF-I.                                             
       LUP-SIG-PBNF.                                                    
           IF BNF-COD-PNTL(BNF-I) = BNF-COD-PANT                        
              MOVE 'SI' TO BNF-EXT-PANT                                 
              GO TO FIN-BUS-PBNF.                                       
       NXT-SIG-PBNF.                                                    
           ADD 1 TO BNF-I.                                              
           IF BNF-I > 20                                                
               GO TO FIN-BUS-PBNF                                       
           ELSE                                                         
               GO TO LUP-SIG-PBNF.                                      
       FIN-BUS-PBNF.                                                    
           EXIT.                                                        
                                                                        
       BUS-DDIR SECTION.                                                
       INI-BUS-DDIR.                                                    
           MOVE 'NO'  TO DIR-EXT-PANT.                                  
           MOVE 1 TO DIR-I.                                             
       LUP-SIG-DDIR.                                                    
           IF DIR-COD-PNTL(DIR-I) = DIR-COD-PANT                        
              MOVE 'SI' TO DIR-EXT-PANT                                 
              GO TO FIN-BUS-DDIR.                                       
       NXT-SIG-DDIR.                                                    
           ADD 1 TO DIR-I.                                              
           IF DIR-I > 20                                                
               GO TO FIN-BUS-DDIR                                       
           ELSE                                                         
               GO TO LUP-SIG-DDIR.                                      
       FIN-BUS-DDIR.                                                    
           EXIT.                                                        
                                                                        
       BUS-DIND SECTION.                                                
       INI-BUS-DIND.                                                    
           MOVE 'NO'  TO IND-EXT-PANT.                                  
           MOVE 1 TO IND-I.                                             
       LUP-SIG-DIND.                                                    
           IF IND-COD-PNTL(IND-I) = IND-COD-PANT                        
              MOVE 'SI' TO IND-EXT-PANT                                 
              GO TO FIN-BUS-DIND.                                       
       NXT-SIG-DIND.                                                    
           ADD 1 TO IND-I.                                              
           IF IND-I > 20                                                
               GO TO FIN-BUS-DIND                                       
           ELSE                                                         
               GO TO LUP-SIG-DIND.                                      
       FIN-BUS-DIND.                                                    
           EXIT.                                                        
      * FIN-INI/JUN2006                                                 
                                                                        
       LEE-TDIR SECTION.                                                
       INI-LEE-TDIR.                                                    
           MOVE RCO-COD-TREL IN BNF-FLD TO WSS-COD-TREL.                
           MOVE RCD-MSC-TDIR IN RCD TO TIP-COD-PANT.                    
           MOVE 'NO'         TO TIP-EXT-PANT.                           
           MOVE 'COL'        TO TAB-COD-SIST FIO-SIST.                  
           MOVE 'TDD'        TO TAB-COD-TTAB IN TAB.                    
           MOVE WSS-COD-TREL TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')          
               GO TO FIN-LEE-TDIR.                                      
           MOVE TAB-GLS-DATA IN TAB TO TIP-GLS-DATA.                    
           MOVE 1 TO TIP-I.                                             
       LUP-SIG-TDIR.                                                    
           IF TIP-COD-PNTL(TIP-I) = TIP-COD-PANT                        
              MOVE 'SI' TO TIP-EXT-PANT                                 
              GO TO FIN-LEE-TDIR.                                       
       NXT-SIG-TDIR.                                                    
           ADD 1 TO TIP-I.                                              
           IF TIP-I > 60                                                
               GO TO FIN-LEE-TDIR                                       
           ELSE                                                         
               GO TO LUP-SIG-TDIR.                                      
       FIN-LEE-TDIR.                                                    
           EXIT.                                                        
      *>>>>
*% END
