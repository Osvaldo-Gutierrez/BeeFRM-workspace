      * RUTINA QUE OBTIENE VALOR DE TASA
      *
      * PARAMETROS DE SALIDA :
      *  SI PROCESO SALIO MAL :
      *     PSM-COD-MENS IN PSM-VARI > SPACES
      *  EN OTRO CASO :
      *     VALOR TASA             : PSM-VAL-TASA IN PSM-VARI.
      *     VALOR TASA MAXIMA      : PSM-VAL-TMAX IN PSM-VARI.
      *
       BUS-PSM SECTION.
       INI-BUS-PSM.
           MOVE SPACES TO PSM-COD-MENS IN PSM-VARI.
           PERFORM CLR-1 VARYING PSM-I FROM 1 BY 1
                         UNTIL PSM-I > PSM-IMAX.
           MOVE PSM-COD-OFOC IN PSM-VARI TO PSM-COD-OFOC IN PSM.
           MOVE PSM-COD-VCOC IN PSM-VARI TO PSM-COD-VCOC IN PSM.
           MOVE PSM-COD-TOOC IN PSM-VARI TO PSM-COD-TOOC IN PSM.
           MOVE PSM-COD-AOOC IN PSM-VARI TO PSM-COD-AOOC IN PSM.
           MOVE PSM-COD-TBAN IN PSM-VARI TO PSM-COD-TBAN IN PSM.
           MOVE PSM-COD-CLCM IN PSM-VARI TO PSM-COD-CLCM IN PSM.
           MOVE PSM-NUM-DTRN IN PSM-VARI TO PSM-NUM-DTRN IN PSM.
           MOVE PSM-NUM-MTRN IN PSM-VARI TO PSM-NUM-MTRN IN PSM.
           MOVE PSM-NUM-STRN IN PSM-VARI TO PSM-NUM-STRN IN PSM.
           MOVE PSM-NUM-ATRN IN PSM-VARI TO PSM-NUM-ATRN IN PSM.
           MOVE PSM-HRA-HRTR IN PSM-VARI TO PSM-HRA-HRTR IN PSM.
           PERFORM PRO-ARC-PSM.
           IF NOT FIO-STAT-OKS
               MOVE 'PSM    NEX' TO PSM-COD-MENS IN PSM-VARI
               GO TO FIN-BUS-PSM.
           PERFORM PRO-VAL-PSM.
       FIN-BUS-PSM.
           EXIT.

       CLR-1 SECTION.
       INI-CLR-1.
           PERFORM CLR-2 VARYING PSM-J FROM 1 BY 1
                         UNTIL PSM-J > PSM-JMAX.
       FIN-CLR-1.
           EXIT.
       CLR-2 SECTION.
       INI-CLR-2.
           MOVE ZEROES TO PSM-SGV-TASA IN PSM-VARI( PSM-I, PSM-J).
       FIN-CLR-2.
           EXIT.
       PRO-ARC-PSM SECTION.
       INI-PRO-ARC-PSM.
           MOVE 9999 TO PSM-NUM-IPSM IN PSM.
       LUP-PRO-ARC-PSM.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-PSM.
           IF FIO-STAT-OKS AND
              PSM-COD-OFOC IN PSM-VARI = PSM-COD-OFOC IN PSM AND
              PSM-COD-VCOC IN PSM-VARI = PSM-COD-VCOC IN PSM AND
              PSM-COD-TOOC IN PSM-VARI = PSM-COD-TOOC IN PSM AND
              PSM-COD-AOOC IN PSM-VARI = PSM-COD-AOOC IN PSM AND
              PSM-COD-TBAN IN PSM-VARI = PSM-COD-TBAN IN PSM AND
              PSM-COD-CLCM IN PSM-VARI = PSM-COD-CLCM IN PSM
               IF PSM-MSC-STAT IN PSM NOT = 'S'
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM COL-FIO-PSM
                   MOVE 0 TO PSM-NUM-IPSM IN PSM
                   GO TO LUP-PRO-ARC-PSM
               ELSE
               MOVE 0 TO PSM-NUM-IPSM IN PSM
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-PSM
               MOVE FIO-STAT TO PSM-STAT
               PERFORM LLE-TAB-PSM
           ELSE
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM COL-FIO-PSM
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PSM-STAT
                   GO TO SET-PSM-STAT
               ELSE
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PSM-STAT
                   GO TO SET-PSM-STAT.
       SET-PSM-STAT.
           MOVE PSM-STAT TO FIO-STAT.
       FIN-PRO-ARC-PSM.
           EXIT.

       PRO-MNTO-PSM SECTION.
       INI-PRO-MNTO-PSM.
           MOVE 1 TO PSM-J.
       LOOP-PRO-MNTO-PSM.
           IF PSM-VEC-MNTO IN PSM-VARI (PSM-J) NOT > ZEROES AND
              PSM-J > 1
               MOVE 'PSMMTO NEX' TO PSM-COD-MENS IN PSM-VARI
               SUBTRACT 1 FROM PSM-J
               GO TO FIN-PRO-MNTO-PSM.
           IF PSM-SGV-MNTO IN PSM-VARI NOT > PSM-VEC-MNTO
                                              IN PSM-VARI (PSM-J)
               GO TO FIN-PRO-MNTO-PSM.
           ADD 1 TO PSM-J.
           IF PSM-J > PSM-JMAX
               MOVE 'PSMMTO NEX' TO PSM-COD-MENS IN PSM-VARI
               MOVE PSM-JMAX TO PSM-J
               GO TO FIN-PRO-MNTO-PSM.
           GO TO LOOP-PRO-MNTO-PSM.
       FIN-PRO-MNTO-PSM.
           EXIT.
       PRO-NDIA-PSM SECTION.
       INI-PRO-NDIA-PSM.
           MOVE 1 TO PSM-I.
       LOOP-PRO-NDIA-PSM.
           IF PSM-VEC-NDIA IN PSM-VARI (PSM-I) NOT > ZEROES AND
              PSM-I > 1
               MOVE 'PSMMTO NEX' TO PSM-COD-MENS IN PSM-VARI
               SUBTRACT 1 FROM PSM-I
               GO TO FIN-PRO-NDIA-PSM.
           IF PSM-NUM-NDIA IN PSM-VARI NOT > PSM-VEC-NDIA
                                              IN PSM-VARI (PSM-I)
               GO TO FIN-PRO-NDIA-PSM.
           ADD 1 TO PSM-I.
           IF PSM-I > PSM-IMAX
               MOVE 'PSMMTO NEX' TO PSM-COD-MENS IN PSM-VARI
               MOVE PSM-IMAX TO PSM-I
               GO TO FIN-PRO-NDIA-PSM.
           GO TO LOOP-PRO-NDIA-PSM.
       FIN-PRO-NDIA-PSM.
           EXIT.
       LLE-TAB-PSM SECTION.
       INI-LLE-TAB-PSM.
      *
      * MUEVE MONTOS DE PRIMERA PSM (CORRELATIVO 1)
      *
           MOVE PSM-SGV-MTO1 IN PSM TO PSM-VEC-MNTO IN PSM-VARI(1)
           MOVE PSM-SGV-MTO2 IN PSM TO PSM-VEC-MNTO IN PSM-VARI(2)
           MOVE PSM-SGV-MTO3 IN PSM TO PSM-VEC-MNTO IN PSM-VARI(3)
           MOVE PSM-SGV-MTO4 IN PSM TO PSM-VEC-MNTO IN PSM-VARI(4)
           PERFORM LEE-TAB-PSM VARYING PSM-I FROM 1 BY 1
                   UNTIL PSM-I > PSM-IMAX.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM COL-FIO-PSM.
       FIN-LLE-TAB-PSM.
           EXIT.
       LEE-TAB-PSM SECTION.
       INI-LEE-TAB-PSM.
      *
      * MUEVE VALORES A TABLA EN PANTALLA DESPUES DE LEER PSM(N)
      *
           MOVE PSM-NUM-NDIA IN PSM TO PSM-VEC-NDIA
                                            IN PSM-VARI(PSM-I).
           MOVE PSM-SGV-INT1 IN PSM TO PSM-SGV-TASA
                                          IN PSM-VARI(PSM-I, 1).
           MOVE PSM-SGV-INT2 IN PSM TO PSM-SGV-TASA
                                          IN PSM-VARI(PSM-I, 2).
           MOVE PSM-SGV-INT3 IN PSM TO PSM-SGV-TASA
                                          IN PSM-VARI(PSM-I, 3).
           MOVE PSM-SGV-INT4 IN PSM TO PSM-SGV-TASA
                                          IN PSM-VARI(PSM-I, 4).
           MOVE PSM-SGV-INTM IN PSM TO PSM-VEC-INTM IN PSM-VARI(PSM-I).
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-PSM.
      *    IF NOT (FIO-STAT-OKS AND
      *       PSM-COD-OFOC IN PSM-VARI = PSM-COD-OFOC IN PSM AND
      *       PSM-COD-VCOC IN PSM-VARI = PSM-COD-VCOC IN PSM AND
      *       PSM-COD-TOOC IN PSM-VARI = PSM-COD-TOOC IN PSM AND
      *       PSM-COD-AOOC IN PSM-VARI = PSM-COD-AOOC IN PSM AND
      *       PSM-COD-TBAN IN PSM-VARI = PSM-COD-TBAN IN PSM AND
      *       PSM-COD-CLCM IN PSM-VARI = PSM-COD-CLCM IN PSM AND
      *       PSM-NUM-STRN IN PSM-VARI = PSM-NUM-STRN IN PSM AND
      *       PSM-NUM-ATRN IN PSM-VARI = PSM-NUM-ATRN IN PSM AND
      *       PSM-NUM-MTRN IN PSM-VARI = PSM-NUM-MTRN IN PSM AND
      *       PSM-NUM-DTRN IN PSM-VARI = PSM-NUM-DTRN IN PSM AND
      *       PSM-HRA-HRTR IN PSM-VARI = PSM-HRA-HRTR IN PSM )
      *        MOVE '23' TO FIO-STAT.
       FIN-LEE-TAB-PSM.
           EXIT.
       PRO-VAL-PSM SECTION.
       INI-PRO-VAL-PSM.
           IF PSM-FEC-FTRN IN PSM-VARI NOT > ZEROES
               MOVE PSM-COD-OFCB IN PSM TO PSM-COD-OFCB IN PSM-VARI
               GO TO FIN-PRO-VAL-PSM.
           IF PSM-NUM-NDIA IN PSM-VARI NOT > ZEROES AND
              PSM-SGV-MNTO IN PSM-VARI NOT > ZEROES
               MOVE PSM-SGV-TASA IN PSM-VARI (1, 1) TO PSM-VAL-TASA
                                                    IN PSM-VARI
               MOVE PSM-VEC-INTM IN PSM-VARI (1)    TO PSM-VAL-TMAX
                                                    IN PSM-VARI
               GO TO FIN-PRO-VAL-PSM.
           IF PSM-NUM-NDIA IN PSM-VARI NOT > ZEROES
               PERFORM PRO-MNTO-PSM
               MOVE PSM-SGV-TASA IN PSM-VARI (1, PSM-J) TO PSM-VAL-TASA
                                                    IN PSM-VARI
               MOVE PSM-VEC-INTM IN PSM-VARI (1)        TO PSM-VAL-TMAX
                                                    IN PSM-VARI
               GO TO FIN-PRO-VAL-PSM.
           IF PSM-SGV-MNTO IN PSM-VARI NOT > ZEROES
               PERFORM PRO-NDIA-PSM
               MOVE PSM-SGV-TASA IN PSM-VARI (PSM-I, 1) TO PSM-VAL-TASA
                                                    IN PSM-VARI
               MOVE PSM-VEC-INTM IN PSM-VARI (PSM-I)    TO PSM-VAL-TMAX
                                                    IN PSM-VARI
               GO TO FIN-PRO-VAL-PSM.
           PERFORM PRO-MNTO-PSM.
           PERFORM PRO-NDIA-PSM.
           MOVE PSM-SGV-TASA IN PSM-VARI (PSM-I, PSM-J) TO PSM-VAL-TASA
                                                    IN PSM-VARI.
           MOVE PSM-VEC-INTM IN PSM-VARI (PSM-I)        TO PSM-VAL-TMAX
                                                    IN PSM-VARI.
       FIN-PRO-VAL-PSM.
           EXIT.
       OBT-ULT-FTRN SECTION.
       INI-OBT-ULT-FTRN.
           MOVE PSM-HRA-HRTR IN PSM-VARI TO PSM-HRA-HRAU IN PSM-VARI.
           MOVE ZEROES TO PSM-HRA-HRTR IN PSM.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-ULT-FTRN.
           PERFORM COL-FIO-PSM.
           IF FIO-STAT-OKS AND
               PSM-COD-OFOC IN PSM-VARI = PSM-COD-OFOC IN PSM AND
               PSM-COD-VCOC IN PSM-VARI = PSM-COD-VCOC IN PSM AND
               PSM-COD-TOOC IN PSM-VARI = PSM-COD-TOOC IN PSM AND
               PSM-COD-AOOC IN PSM-VARI = PSM-COD-AOOC IN PSM AND
               PSM-COD-TBAN IN PSM-VARI = PSM-COD-TBAN IN PSM AND
               PSM-COD-CLCM IN PSM-VARI = PSM-COD-CLCM IN PSM AND
               PSM-NUM-STRN IN PSM-VARI = PSM-NUM-STRN IN PSM AND
               PSM-NUM-ATRN IN PSM-VARI = PSM-NUM-ATRN IN PSM AND
               PSM-NUM-MTRN IN PSM-VARI = PSM-NUM-MTRN IN PSM AND
               PSM-NUM-DTRN IN PSM-VARI = PSM-NUM-DTRN IN PSM 
                IF PSM-HRA-HRTR IN PSM > PSM-HRA-HRTR IN PSM-VARI
                    MOVE PSM-HRA-HRAU IN PSM-VARI TO PSM-HRA-HRTR
                                                     IN PSM
                    MOVE FIO-END-BRW TO FIO-CMND
                    PERFORM COL-FIO-PSM
                    GO TO FIN-OBT-ULT-FTRN
                ELSE
                    MOVE PSM-HRA-HRTR IN PSM TO
                                         PSM-HRA-HRAU IN PSM-VARI
                    MOVE FIO-GET-NXT TO FIO-CMND
                    GO TO LUP-OBT-ULT-FTRN.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM COL-FIO-PSM.
           MOVE PSM-COD-OFOC IN PSM-VARI TO PSM-COD-OFOC IN PSM.
           MOVE PSM-COD-VCOC IN PSM-VARI TO PSM-COD-VCOC IN PSM.
           MOVE PSM-COD-TOOC IN PSM-VARI TO PSM-COD-TOOC IN PSM.
           MOVE PSM-COD-AOOC IN PSM-VARI TO PSM-COD-AOOC IN PSM.
           MOVE PSM-COD-TBAN IN PSM-VARI TO PSM-COD-TBAN IN PSM.
           MOVE PSM-COD-CLCM IN PSM-VARI TO PSM-COD-CLCM IN PSM.
           MOVE PSM-NUM-STRN IN PSM-VARI TO PSM-NUM-STRN IN PSM.
           MOVE PSM-NUM-ATRN IN PSM-VARI TO PSM-NUM-ATRN IN PSM.
           MOVE PSM-NUM-MTRN IN PSM-VARI TO PSM-NUM-MTRN IN PSM.
           MOVE PSM-NUM-DTRN IN PSM-VARI TO PSM-NUM-DTRN IN PSM.
           MOVE PSM-HRA-HRAU IN PSM-VARI TO PSM-HRA-HRTR IN PSM.
       FIN-OBT-ULT-FTRN.
           EXIT.
